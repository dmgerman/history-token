multiline_comment|/*&n; *  Copyright (C) 2000 Takashi Iwai &lt;tiwai@suse.de&gt;&n; *&n; *  Routines for control of EMU WaveTable chip&n; *&n; *   This program is free software; you can redistribute it and/or modify&n; *   it under the terms of the GNU General Public License as published by&n; *   the Free Software Foundation; either version 2 of the License, or&n; *   (at your option) any later version.&n; *&n; *   This program is distributed in the hope that it will be useful,&n; *   but WITHOUT ANY WARRANTY; without even the implied warranty of&n; *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; *   GNU General Public License for more details.&n; *&n; *   You should have received a copy of the GNU General Public License&n; *   along with this program; if not, write to the Free Software&n; *   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA&n; */
macro_line|#include &lt;sound/driver.h&gt;
macro_line|#include &lt;linux/wait.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;sound/core.h&gt;
macro_line|#include &lt;sound/emux_synth.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &quot;emux_voice.h&quot;
id|MODULE_AUTHOR
c_func
(paren
l_string|&quot;Takashi Iwai&quot;
)paren
suffix:semicolon
id|MODULE_DESCRIPTION
c_func
(paren
l_string|&quot;Routines for control of EMU WaveTable chip&quot;
)paren
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
multiline_comment|/*&n; * create a new hardware dependent device for Emu8000/Emu10k1&n; */
DECL|function|snd_emux_new
r_int
id|snd_emux_new
c_func
(paren
id|snd_emux_t
op_star
op_star
id|remu
)paren
(brace
id|snd_emux_t
op_star
id|emu
suffix:semicolon
op_star
id|remu
op_assign
l_int|NULL
suffix:semicolon
id|emu
op_assign
id|snd_magic_kcalloc
c_func
(paren
id|snd_emux_t
comma
l_int|0
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|emu
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|spin_lock_init
c_func
(paren
op_amp
id|emu-&gt;voice_lock
)paren
suffix:semicolon
id|init_MUTEX
c_func
(paren
op_amp
id|emu-&gt;register_mutex
)paren
suffix:semicolon
id|emu-&gt;client
op_assign
op_minus
l_int|1
suffix:semicolon
macro_line|#ifdef CONFIG_SND_SEQUENCER_OSS
id|emu-&gt;oss_synth
op_assign
l_int|NULL
suffix:semicolon
macro_line|#endif
id|emu-&gt;max_voices
op_assign
l_int|0
suffix:semicolon
id|emu-&gt;use_time
op_assign
l_int|0
suffix:semicolon
id|init_timer
c_func
(paren
op_amp
id|emu-&gt;tlist
)paren
suffix:semicolon
id|emu-&gt;tlist.function
op_assign
id|snd_emux_timer_callback
suffix:semicolon
id|emu-&gt;tlist.data
op_assign
(paren
r_int
r_int
)paren
id|emu
suffix:semicolon
id|emu-&gt;timer_active
op_assign
l_int|0
suffix:semicolon
op_star
id|remu
op_assign
id|emu
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; */
DECL|function|snd_emux_register
r_int
id|snd_emux_register
c_func
(paren
id|snd_emux_t
op_star
id|emu
comma
id|snd_card_t
op_star
id|card
comma
r_int
id|index
comma
r_char
op_star
id|name
)paren
(brace
id|snd_sf_callback_t
id|sf_cb
suffix:semicolon
id|snd_assert
c_func
(paren
id|emu-&gt;hw
op_ne
l_int|NULL
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|emu-&gt;max_voices
OG
l_int|0
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|card
op_ne
l_int|NULL
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|name
op_ne
l_int|NULL
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|emu-&gt;card
op_assign
id|card
suffix:semicolon
id|emu-&gt;name
op_assign
id|snd_kmalloc_strdup
c_func
(paren
id|name
comma
id|GFP_KERNEL
)paren
suffix:semicolon
id|emu-&gt;voices
op_assign
id|snd_kcalloc
c_func
(paren
r_sizeof
(paren
id|snd_emux_voice_t
)paren
op_star
id|emu-&gt;max_voices
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|emu-&gt;voices
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
multiline_comment|/* create soundfont list */
id|memset
c_func
(paren
op_amp
id|sf_cb
comma
l_int|0
comma
r_sizeof
(paren
id|sf_cb
)paren
)paren
suffix:semicolon
id|sf_cb.private_data
op_assign
id|emu
suffix:semicolon
id|sf_cb.sample_new
op_assign
(paren
id|snd_sf_sample_new_t
)paren
id|emu-&gt;ops.sample_new
suffix:semicolon
id|sf_cb.sample_free
op_assign
(paren
id|snd_sf_sample_free_t
)paren
id|emu-&gt;ops.sample_free
suffix:semicolon
id|sf_cb.sample_reset
op_assign
(paren
id|snd_sf_sample_reset_t
)paren
id|emu-&gt;ops.sample_reset
suffix:semicolon
id|emu-&gt;sflist
op_assign
id|snd_sf_new
c_func
(paren
op_amp
id|sf_cb
comma
id|emu-&gt;memhdr
)paren
suffix:semicolon
r_if
c_cond
(paren
id|emu-&gt;sflist
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|snd_emux_init_voices
c_func
(paren
id|emu
)paren
suffix:semicolon
id|snd_emux_init_seq
c_func
(paren
id|emu
comma
id|card
comma
id|index
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_SND_SEQUENCER_OSS
id|snd_emux_init_seq_oss
c_func
(paren
id|emu
)paren
suffix:semicolon
macro_line|#endif
id|snd_emux_init_virmidi
c_func
(paren
id|emu
comma
id|card
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_PROC_FS
id|snd_emux_proc_init
c_func
(paren
id|emu
comma
id|card
comma
id|index
)paren
suffix:semicolon
macro_line|#endif
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; */
DECL|function|snd_emux_free
r_int
id|snd_emux_free
c_func
(paren
id|snd_emux_t
op_star
id|emu
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|emu
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|emu-&gt;voice_lock
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|emu-&gt;timer_active
)paren
id|del_timer
c_func
(paren
op_amp
id|emu-&gt;tlist
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|emu-&gt;voice_lock
comma
id|flags
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_PROC_FS
id|snd_emux_proc_free
c_func
(paren
id|emu
)paren
suffix:semicolon
macro_line|#endif
id|snd_emux_delete_virmidi
c_func
(paren
id|emu
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_SND_SEQUENCER_OSS
id|snd_emux_detach_seq_oss
c_func
(paren
id|emu
)paren
suffix:semicolon
macro_line|#endif
id|snd_emux_detach_seq
c_func
(paren
id|emu
)paren
suffix:semicolon
r_if
c_cond
(paren
id|emu-&gt;sflist
)paren
id|snd_sf_free
c_func
(paren
id|emu-&gt;sflist
)paren
suffix:semicolon
r_if
c_cond
(paren
id|emu-&gt;voices
)paren
id|kfree
c_func
(paren
id|emu-&gt;voices
)paren
suffix:semicolon
r_if
c_cond
(paren
id|emu-&gt;name
)paren
id|kfree
c_func
(paren
id|emu-&gt;name
)paren
suffix:semicolon
id|snd_magic_kfree
c_func
(paren
id|emu
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|snd_emux_new
id|EXPORT_SYMBOL
c_func
(paren
id|snd_emux_new
)paren
suffix:semicolon
DECL|variable|snd_emux_register
id|EXPORT_SYMBOL
c_func
(paren
id|snd_emux_register
)paren
suffix:semicolon
DECL|variable|snd_emux_free
id|EXPORT_SYMBOL
c_func
(paren
id|snd_emux_free
)paren
suffix:semicolon
DECL|variable|snd_emux_terminate_all
id|EXPORT_SYMBOL
c_func
(paren
id|snd_emux_terminate_all
)paren
suffix:semicolon
DECL|variable|snd_emux_lock_voice
id|EXPORT_SYMBOL
c_func
(paren
id|snd_emux_lock_voice
)paren
suffix:semicolon
DECL|variable|snd_emux_unlock_voice
id|EXPORT_SYMBOL
c_func
(paren
id|snd_emux_unlock_voice
)paren
suffix:semicolon
multiline_comment|/* soundfont.c */
DECL|variable|snd_sf_linear_to_log
id|EXPORT_SYMBOL
c_func
(paren
id|snd_sf_linear_to_log
)paren
suffix:semicolon
multiline_comment|/*&n; *  INIT part&n; */
DECL|function|alsa_emux_init
r_static
r_int
id|__init
id|alsa_emux_init
c_func
(paren
r_void
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|alsa_emux_exit
r_static
r_void
id|__exit
id|alsa_emux_exit
c_func
(paren
r_void
)paren
(brace
)brace
id|module_init
c_func
(paren
id|alsa_emux_init
)paren
id|module_exit
c_func
(paren
id|alsa_emux_exit
)paren
eof
