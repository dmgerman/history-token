multiline_comment|/*&n; *  This program is free software; you can redistribute it and/or modify&n; *  it under the terms of the GNU General Public License as published by&n; *  the Free Software Foundation; either version 2 of the License, or&n; *  (at your option) any later version.&n; *&n; *  This program is distributed in the hope that it will be useful,&n; *  but WITHOUT ANY WARRANTY; without even the implied warranty of&n; *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; *  GNU Library General Public License for more details.&n; *&n; *  You should have received a copy of the GNU General Public License&n; *  along with this program; if not, write to the Free Software&n; *  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.&n; */
multiline_comment|/*&n; * Someday its supposed to make use of the WT DMA engine&n; * for a Wavetable synthesizer.&n; */
macro_line|#include &quot;au88x0.h&quot;
macro_line|#include &quot;au88x0_wt.h&quot;
r_static
r_void
id|vortex_fifo_setwtvalid
c_func
(paren
id|vortex_t
op_star
id|vortex
comma
r_int
id|fifo
comma
r_int
id|en
)paren
suffix:semicolon
r_static
r_void
id|vortex_connection_adb_mixin
c_func
(paren
id|vortex_t
op_star
id|vortex
comma
r_int
id|en
comma
r_int
r_char
id|channel
comma
r_int
r_char
id|source
comma
r_int
r_char
id|mixin
)paren
suffix:semicolon
r_static
r_void
id|vortex_connection_mixin_mix
c_func
(paren
id|vortex_t
op_star
id|vortex
comma
r_int
id|en
comma
r_int
r_char
id|mixin
comma
r_int
r_char
id|mix
comma
r_int
id|a
)paren
suffix:semicolon
r_static
r_void
id|vortex_fifo_wtinitialize
c_func
(paren
id|vortex_t
op_star
id|vortex
comma
r_int
id|fifo
comma
r_int
id|j
)paren
suffix:semicolon
r_static
r_int
id|vortex_wt_SetReg
c_func
(paren
id|vortex_t
op_star
id|vortex
comma
r_int
r_char
id|reg
comma
r_int
id|wt
comma
r_int
r_int
id|val
)paren
suffix:semicolon
multiline_comment|/* WT */
multiline_comment|/* Put 2 WT channels together for one stereo interlaced channel. */
DECL|function|vortex_wt_setstereo
r_static
r_void
id|vortex_wt_setstereo
c_func
(paren
id|vortex_t
op_star
id|vortex
comma
id|u32
id|wt
comma
id|u32
id|stereo
)paren
(brace
r_int
id|temp
suffix:semicolon
singleline_comment|//temp = hwread(vortex-&gt;mmio, 0x80 + ((wt &gt;&gt; 0x5)&lt;&lt; 0xf) + (((wt &amp; 0x1f) &gt;&gt; 1) &lt;&lt; 2));
id|temp
op_assign
id|hwread
c_func
(paren
id|vortex-&gt;mmio
comma
id|WT_STEREO
c_func
(paren
id|wt
)paren
)paren
suffix:semicolon
id|temp
op_assign
(paren
id|temp
op_amp
l_int|0xfe
)paren
op_or
(paren
id|stereo
op_amp
l_int|1
)paren
suffix:semicolon
singleline_comment|//hwwrite(vortex-&gt;mmio, 0x80 + ((wt &gt;&gt; 0x5)&lt;&lt; 0xf) + (((wt &amp; 0x1f) &gt;&gt; 1) &lt;&lt; 2), temp);
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|WT_STEREO
c_func
(paren
id|wt
)paren
comma
id|temp
)paren
suffix:semicolon
)brace
multiline_comment|/* Join to mixdown route. */
DECL|function|vortex_wt_setdsout
r_static
r_void
id|vortex_wt_setdsout
c_func
(paren
id|vortex_t
op_star
id|vortex
comma
id|u32
id|wt
comma
r_int
id|en
)paren
(brace
r_int
id|temp
suffix:semicolon
multiline_comment|/* There is one DSREG register for each bank (32 voices each). */
id|temp
op_assign
id|hwread
c_func
(paren
id|vortex-&gt;mmio
comma
id|WT_DSREG
c_func
(paren
(paren
id|wt
op_ge
l_int|0x20
)paren
ques
c_cond
l_int|1
suffix:colon
l_int|0
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|en
)paren
id|temp
op_or_assign
(paren
l_int|1
op_lshift
(paren
id|wt
op_amp
l_int|0x1f
)paren
)paren
suffix:semicolon
r_else
id|temp
op_and_assign
(paren
l_int|1
op_lshift
op_complement
(paren
id|wt
op_amp
l_int|0x1f
)paren
)paren
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|WT_DSREG
c_func
(paren
(paren
id|wt
op_ge
l_int|0x20
)paren
ques
c_cond
l_int|1
suffix:colon
l_int|0
)paren
comma
id|temp
)paren
suffix:semicolon
)brace
multiline_comment|/* Setup WT route. */
DECL|function|vortex_wt_allocroute
r_static
r_int
id|vortex_wt_allocroute
c_func
(paren
id|vortex_t
op_star
id|vortex
comma
r_int
id|wt
comma
r_int
id|nr_ch
)paren
(brace
id|wt_voice_t
op_star
id|voice
op_assign
op_amp
(paren
id|vortex-&gt;wt_voice
(braket
id|wt
)braket
)paren
suffix:semicolon
r_int
id|temp
suffix:semicolon
singleline_comment|//FIXME: WT audio routing.
r_if
c_cond
(paren
id|nr_ch
)paren
(brace
id|vortex_fifo_wtinitialize
c_func
(paren
id|vortex
comma
id|wt
comma
l_int|1
)paren
suffix:semicolon
id|vortex_fifo_setwtvalid
c_func
(paren
id|vortex
comma
id|wt
comma
l_int|1
)paren
suffix:semicolon
id|vortex_wt_setstereo
c_func
(paren
id|vortex
comma
id|wt
comma
id|nr_ch
op_minus
l_int|1
)paren
suffix:semicolon
)brace
r_else
id|vortex_fifo_setwtvalid
c_func
(paren
id|vortex
comma
id|wt
comma
l_int|0
)paren
suffix:semicolon
multiline_comment|/* Set mixdown mode. */
id|vortex_wt_setdsout
c_func
(paren
id|vortex
comma
id|wt
comma
l_int|1
)paren
suffix:semicolon
multiline_comment|/* Set other parameter registers. */
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|WT_SRAMP
c_func
(paren
l_int|0
)paren
comma
l_int|0x880000
)paren
suffix:semicolon
singleline_comment|//hwwrite(vortex-&gt;mmio, WT_GMODE(0), 0xffffffff);
macro_line|#ifdef CHIP_AU8830
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|WT_SRAMP
c_func
(paren
l_int|1
)paren
comma
l_int|0x880000
)paren
suffix:semicolon
singleline_comment|//hwwrite(vortex-&gt;mmio, WT_GMODE(1), 0xffffffff);
macro_line|#endif
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|WT_PARM
c_func
(paren
id|wt
comma
l_int|0
)paren
comma
l_int|0
)paren
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|WT_PARM
c_func
(paren
id|wt
comma
l_int|1
)paren
comma
l_int|0
)paren
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|WT_PARM
c_func
(paren
id|wt
comma
l_int|2
)paren
comma
l_int|0
)paren
suffix:semicolon
id|temp
op_assign
id|hwread
c_func
(paren
id|vortex-&gt;mmio
comma
id|WT_PARM
c_func
(paren
id|wt
comma
l_int|3
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;vortex: WT PARM3: %x&bslash;n&quot;
comma
id|temp
)paren
suffix:semicolon
singleline_comment|//hwwrite(vortex-&gt;mmio, WT_PARM(wt, 3), temp);
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|WT_DELAY
c_func
(paren
id|wt
comma
l_int|0
)paren
comma
l_int|0
)paren
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|WT_DELAY
c_func
(paren
id|wt
comma
l_int|1
)paren
comma
l_int|0
)paren
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|WT_DELAY
c_func
(paren
id|wt
comma
l_int|2
)paren
comma
l_int|0
)paren
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|WT_DELAY
c_func
(paren
id|wt
comma
l_int|3
)paren
comma
l_int|0
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;vortex: WT GMODE: %x&bslash;n&quot;
comma
id|hwread
c_func
(paren
id|vortex-&gt;mmio
comma
id|WT_GMODE
c_func
(paren
id|wt
)paren
)paren
)paren
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|WT_PARM
c_func
(paren
id|wt
comma
l_int|2
)paren
comma
l_int|0xffffffff
)paren
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|WT_PARM
c_func
(paren
id|wt
comma
l_int|3
)paren
comma
l_int|0xcff1c810
)paren
suffix:semicolon
id|voice-&gt;parm0
op_assign
id|voice-&gt;parm1
op_assign
l_int|0xcfb23e2f
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|WT_PARM
c_func
(paren
id|wt
comma
l_int|0
)paren
comma
id|voice-&gt;parm0
)paren
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|WT_PARM
c_func
(paren
id|wt
comma
l_int|1
)paren
comma
id|voice-&gt;parm1
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;vortex: WT GMODE 2 : %x&bslash;n&quot;
comma
id|hwread
c_func
(paren
id|vortex-&gt;mmio
comma
id|WT_GMODE
c_func
(paren
id|wt
)paren
)paren
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|vortex_wt_connect
r_static
r_void
id|vortex_wt_connect
c_func
(paren
id|vortex_t
op_star
id|vortex
comma
r_int
id|en
)paren
(brace
r_int
id|i
comma
id|ii
comma
id|mix
suffix:semicolon
DECL|macro|NR_WTROUTES
mdefine_line|#define NR_WTROUTES 6
macro_line|#ifdef CHIP_AU8830
DECL|macro|NR_WTBLOCKS
mdefine_line|#define NR_WTBLOCKS 2
macro_line|#else
mdefine_line|#define NR_WTBLOCKS 1
macro_line|#endif
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|NR_WTBLOCKS
suffix:semicolon
id|i
op_increment
)paren
(brace
r_for
c_loop
(paren
id|ii
op_assign
l_int|0
suffix:semicolon
id|ii
OL
id|NR_WTROUTES
suffix:semicolon
id|ii
op_increment
)paren
(brace
id|mix
op_assign
id|vortex_adb_checkinout
c_func
(paren
id|vortex
comma
id|vortex-&gt;fixed_res
comma
id|en
comma
id|VORTEX_RESOURCE_MIXIN
)paren
suffix:semicolon
id|vortex-&gt;mixwt
(braket
(paren
id|i
op_star
id|NR_WTROUTES
)paren
op_plus
id|ii
)braket
op_assign
id|mix
suffix:semicolon
id|vortex_route
c_func
(paren
id|vortex
comma
id|en
comma
l_int|0x11
comma
id|ADB_WTOUT
c_func
(paren
id|i
comma
id|ii
op_plus
l_int|0x20
)paren
comma
id|ADB_MIXIN
c_func
(paren
id|mix
)paren
)paren
suffix:semicolon
id|vortex_connection_mixin_mix
c_func
(paren
id|vortex
comma
id|en
comma
id|mix
comma
id|vortex-&gt;mixplayb
(braket
id|ii
op_mod
l_int|2
)braket
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|VORTEX_IS_QUAD
c_func
(paren
id|vortex
)paren
)paren
id|vortex_connection_mixin_mix
c_func
(paren
id|vortex
comma
id|en
comma
id|mix
comma
id|vortex-&gt;mixplayb
(braket
l_int|2
op_plus
(paren
id|ii
op_mod
l_int|2
)paren
)braket
comma
l_int|0
)paren
suffix:semicolon
)brace
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|NR_WT
suffix:semicolon
id|i
op_increment
)paren
(brace
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|WT_RUN
c_func
(paren
id|i
)paren
comma
l_int|1
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/* Read WT Register */
macro_line|#if 0
r_static
r_int
id|vortex_wt_GetReg
c_func
(paren
id|vortex_t
op_star
id|vortex
comma
r_char
id|reg
comma
r_int
id|wt
)paren
(brace
singleline_comment|//int eax, esi;
r_if
c_cond
(paren
id|reg
op_eq
l_int|4
)paren
(brace
r_return
id|hwread
c_func
(paren
id|vortex-&gt;mmio
comma
id|WT_PARM
c_func
(paren
id|wt
comma
l_int|3
)paren
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|reg
op_eq
l_int|7
)paren
(brace
r_return
id|hwread
c_func
(paren
id|vortex-&gt;mmio
comma
id|WT_GMODE
c_func
(paren
id|wt
)paren
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* WT hardware abstraction layer generic register interface. */
r_static
r_int
id|vortex_wt_SetReg2
c_func
(paren
id|vortex_t
op_star
id|vortex
comma
r_int
r_char
id|reg
comma
r_int
id|wt
comma
r_int
r_int
id|val
)paren
(brace
multiline_comment|/*&n;&t;   int eax, edx;&n;&n;&t;   if (wt &gt;= NR_WT)  // 0x40 -&gt; NR_WT&n;&t;   return 0;&n;&n;&t;   if ((reg - 0x20) &gt; 0) {&n;&t;   if ((reg - 0x21) != 0) &n;&t;   return 0;&n;&t;   eax = ((((b &amp; 0xff) &lt;&lt; 0xb) + (edx &amp; 0xff)) &lt;&lt; 4) + 0x208; // param 2&n;&t;   } else {&n;&t;   eax = ((((b &amp; 0xff) &lt;&lt; 0xb) + (edx &amp; 0xff)) &lt;&lt; 4) + 0x20a; // param 3&n;&t;   }&n;&t;   hwwrite(vortex-&gt;mmio, eax, c);&n;&t; */
r_return
l_int|1
suffix:semicolon
)brace
multiline_comment|/*public: static void __thiscall CWTHal::SetReg(unsigned char,int,unsigned long) */
macro_line|#endif
r_static
r_int
DECL|function|vortex_wt_SetReg
id|vortex_wt_SetReg
c_func
(paren
id|vortex_t
op_star
id|vortex
comma
r_int
r_char
id|reg
comma
r_int
id|wt
comma
r_int
r_int
id|val
)paren
(brace
r_int
id|ecx
suffix:semicolon
r_if
c_cond
(paren
(paren
id|reg
op_eq
l_int|5
)paren
op_logical_or
(paren
(paren
id|reg
op_ge
l_int|7
)paren
op_logical_and
(paren
id|reg
op_le
l_int|10
)paren
)paren
op_logical_or
(paren
id|reg
op_eq
l_int|0xc
)paren
)paren
(brace
r_if
c_cond
(paren
id|wt
op_ge
(paren
id|NR_WT
op_div
id|NR_WT_PB
)paren
)paren
(brace
id|printk
(paren
l_string|&quot;vortex: WT SetReg: bank out of range. reg=0x%x, wt=%d&bslash;n&quot;
comma
id|reg
comma
id|wt
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|wt
op_ge
id|NR_WT
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;vortex: WT SetReg: voice out of range&bslash;n&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|reg
OG
l_int|0xc
)paren
r_return
l_int|0
suffix:semicolon
r_switch
c_cond
(paren
id|reg
)paren
(brace
multiline_comment|/* Voice specific parameters */
r_case
l_int|0
suffix:colon
multiline_comment|/* running */
singleline_comment|//printk(&quot;vortex: WT SetReg(0x%x) = 0x%08x&bslash;n&quot;, WT_RUN(wt), (int)val);
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|WT_RUN
c_func
(paren
id|wt
)paren
comma
id|val
)paren
suffix:semicolon
r_return
l_int|0xc
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
multiline_comment|/* param 0 */
singleline_comment|//printk(&quot;vortex: WT SetReg(0x%x) = 0x%08x&bslash;n&quot;, WT_PARM(wt,0), (int)val);
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|WT_PARM
c_func
(paren
id|wt
comma
l_int|0
)paren
comma
id|val
)paren
suffix:semicolon
r_return
l_int|0xc
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
multiline_comment|/* param 1 */
singleline_comment|//printk(&quot;vortex: WT SetReg(0x%x) = 0x%08x&bslash;n&quot;, WT_PARM(wt,1), (int)val);
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|WT_PARM
c_func
(paren
id|wt
comma
l_int|1
)paren
comma
id|val
)paren
suffix:semicolon
r_return
l_int|0xc
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
multiline_comment|/* param 2 */
singleline_comment|//printk(&quot;vortex: WT SetReg(0x%x) = 0x%08x&bslash;n&quot;, WT_PARM(wt,2), (int)val);
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|WT_PARM
c_func
(paren
id|wt
comma
l_int|2
)paren
comma
id|val
)paren
suffix:semicolon
r_return
l_int|0xc
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|4
suffix:colon
multiline_comment|/* param 3 */
singleline_comment|//printk(&quot;vortex: WT SetReg(0x%x) = 0x%08x&bslash;n&quot;, WT_PARM(wt,3), (int)val);
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|WT_PARM
c_func
(paren
id|wt
comma
l_int|3
)paren
comma
id|val
)paren
suffix:semicolon
r_return
l_int|0xc
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|6
suffix:colon
multiline_comment|/* mute */
singleline_comment|//printk(&quot;vortex: WT SetReg(0x%x) = 0x%08x&bslash;n&quot;, WT_MUTE(wt), (int)val);
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|WT_MUTE
c_func
(paren
id|wt
)paren
comma
id|val
)paren
suffix:semicolon
r_return
l_int|0xc
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0xb
suffix:colon
(brace
multiline_comment|/* delay */
singleline_comment|//printk(&quot;vortex: WT SetReg(0x%x) = 0x%08x&bslash;n&quot;, WT_DELAY(wt,0), (int)val);
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|WT_DELAY
c_func
(paren
id|wt
comma
l_int|3
)paren
comma
id|val
)paren
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|WT_DELAY
c_func
(paren
id|wt
comma
l_int|2
)paren
comma
id|val
)paren
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|WT_DELAY
c_func
(paren
id|wt
comma
l_int|1
)paren
comma
id|val
)paren
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|WT_DELAY
c_func
(paren
id|wt
comma
l_int|0
)paren
comma
id|val
)paren
suffix:semicolon
r_return
l_int|0xc
suffix:semicolon
)brace
r_break
suffix:semicolon
multiline_comment|/* Global WT block parameters */
r_case
l_int|5
suffix:colon
multiline_comment|/* sramp */
id|ecx
op_assign
id|WT_SRAMP
c_func
(paren
id|wt
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|8
suffix:colon
multiline_comment|/* aramp */
id|ecx
op_assign
id|WT_ARAMP
c_func
(paren
id|wt
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|9
suffix:colon
multiline_comment|/* mramp */
id|ecx
op_assign
id|WT_MRAMP
c_func
(paren
id|wt
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0xa
suffix:colon
multiline_comment|/* ctrl */
id|ecx
op_assign
id|WT_CTRL
c_func
(paren
id|wt
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0xc
suffix:colon
multiline_comment|/* ds_reg */
id|ecx
op_assign
id|WT_DSREG
c_func
(paren
id|wt
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_return
l_int|0
suffix:semicolon
r_break
suffix:semicolon
)brace
singleline_comment|//printk(&quot;vortex: WT SetReg(0x%x) = 0x%08x&bslash;n&quot;, ecx, (int)val);
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|ecx
comma
id|val
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|vortex_wt_init
r_static
r_void
id|vortex_wt_init
c_func
(paren
id|vortex_t
op_star
id|vortex
)paren
(brace
r_int
id|var4
comma
id|var8
comma
id|varc
comma
id|var10
op_assign
l_int|0
comma
id|edi
suffix:semicolon
id|var10
op_and_assign
l_int|0xFFFFFFE3
suffix:semicolon
id|var10
op_or_assign
l_int|0x22
suffix:semicolon
id|var10
op_and_assign
l_int|0xFFFFFEBF
suffix:semicolon
id|var10
op_or_assign
l_int|0x80
suffix:semicolon
id|var10
op_or_assign
l_int|0x200
suffix:semicolon
id|var10
op_and_assign
l_int|0xfffffffe
suffix:semicolon
id|var10
op_and_assign
l_int|0xfffffbff
suffix:semicolon
id|var10
op_or_assign
l_int|0x1800
suffix:semicolon
singleline_comment|// var10 = 0x1AA2
id|var4
op_assign
l_int|0x10000000
suffix:semicolon
id|varc
op_assign
l_int|0x00830000
suffix:semicolon
id|var8
op_assign
l_int|0x00830000
suffix:semicolon
multiline_comment|/* Init Bank registers. */
r_for
c_loop
(paren
id|edi
op_assign
l_int|0
suffix:semicolon
id|edi
OL
(paren
id|NR_WT
op_div
id|NR_WT_PB
)paren
suffix:semicolon
id|edi
op_increment
)paren
(brace
id|vortex_wt_SetReg
c_func
(paren
id|vortex
comma
l_int|0xc
comma
id|edi
comma
l_int|0
)paren
suffix:semicolon
multiline_comment|/* ds_reg */
id|vortex_wt_SetReg
c_func
(paren
id|vortex
comma
l_int|0xa
comma
id|edi
comma
id|var10
)paren
suffix:semicolon
multiline_comment|/* ctrl  */
id|vortex_wt_SetReg
c_func
(paren
id|vortex
comma
l_int|0x9
comma
id|edi
comma
id|var4
)paren
suffix:semicolon
multiline_comment|/* mramp */
id|vortex_wt_SetReg
c_func
(paren
id|vortex
comma
l_int|0x8
comma
id|edi
comma
id|varc
)paren
suffix:semicolon
multiline_comment|/* aramp */
id|vortex_wt_SetReg
c_func
(paren
id|vortex
comma
l_int|0x5
comma
id|edi
comma
id|var8
)paren
suffix:semicolon
multiline_comment|/* sramp */
)brace
multiline_comment|/* Init Voice registers. */
r_for
c_loop
(paren
id|edi
op_assign
l_int|0
suffix:semicolon
id|edi
OL
id|NR_WT
suffix:semicolon
id|edi
op_increment
)paren
(brace
id|vortex_wt_SetReg
c_func
(paren
id|vortex
comma
l_int|0x4
comma
id|edi
comma
l_int|0
)paren
suffix:semicolon
multiline_comment|/* param 3 0x20c */
id|vortex_wt_SetReg
c_func
(paren
id|vortex
comma
l_int|0x3
comma
id|edi
comma
l_int|0
)paren
suffix:semicolon
multiline_comment|/* param 2 0x208 */
id|vortex_wt_SetReg
c_func
(paren
id|vortex
comma
l_int|0x2
comma
id|edi
comma
l_int|0
)paren
suffix:semicolon
multiline_comment|/* param 1 0x204 */
id|vortex_wt_SetReg
c_func
(paren
id|vortex
comma
l_int|0x1
comma
id|edi
comma
l_int|0
)paren
suffix:semicolon
multiline_comment|/* param 0 0x200 */
id|vortex_wt_SetReg
c_func
(paren
id|vortex
comma
l_int|0xb
comma
id|edi
comma
l_int|0
)paren
suffix:semicolon
multiline_comment|/* delay 0x400 - 0x40c */
)brace
id|var10
op_or_assign
l_int|1
suffix:semicolon
r_for
c_loop
(paren
id|edi
op_assign
l_int|0
suffix:semicolon
id|edi
OL
(paren
id|NR_WT
op_div
id|NR_WT_PB
)paren
suffix:semicolon
id|edi
op_increment
)paren
id|vortex_wt_SetReg
c_func
(paren
id|vortex
comma
l_int|0xa
comma
id|edi
comma
id|var10
)paren
suffix:semicolon
multiline_comment|/* ctrl */
)brace
multiline_comment|/* Extract of CAdbTopology::SetVolume(struct _ASPVOLUME *) */
macro_line|#if 0
r_static
r_void
id|vortex_wt_SetVolume
c_func
(paren
id|vortex_t
op_star
id|vortex
comma
r_int
id|wt
comma
r_int
id|vol
(braket
)braket
)paren
(brace
id|wt_voice_t
op_star
id|voice
op_assign
op_amp
(paren
id|vortex-&gt;wt_voice
(braket
id|wt
)braket
)paren
suffix:semicolon
r_int
id|ecx
op_assign
id|vol
(braket
l_int|1
)braket
comma
id|eax
op_assign
id|vol
(braket
l_int|0
)braket
suffix:semicolon
multiline_comment|/* This is pure guess */
id|voice-&gt;parm0
op_and_assign
l_int|0xff00ffff
suffix:semicolon
id|voice-&gt;parm0
op_or_assign
(paren
id|vol
(braket
l_int|0
)braket
op_amp
l_int|0xff
)paren
op_lshift
l_int|0x10
suffix:semicolon
id|voice-&gt;parm1
op_and_assign
l_int|0xff00ffff
suffix:semicolon
id|voice-&gt;parm1
op_or_assign
(paren
id|vol
(braket
l_int|1
)braket
op_amp
l_int|0xff
)paren
op_lshift
l_int|0x10
suffix:semicolon
multiline_comment|/* This is real */
id|hwwrite
c_func
(paren
id|vortex
comma
id|WT_PARM
c_func
(paren
id|wt
comma
l_int|0
)paren
comma
id|voice-&gt;parm0
)paren
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex
comma
id|WT_PARM
c_func
(paren
id|wt
comma
l_int|1
)paren
comma
id|voice-&gt;parm0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|voice-&gt;this_1D0
op_amp
l_int|4
)paren
(brace
id|eax
op_rshift_assign
l_int|8
suffix:semicolon
id|ecx
op_assign
id|eax
suffix:semicolon
r_if
c_cond
(paren
id|ecx
OL
l_int|0x80
)paren
id|ecx
op_assign
l_int|0x7f
suffix:semicolon
id|voice-&gt;parm3
op_and_assign
l_int|0xFFFFC07F
suffix:semicolon
id|voice-&gt;parm3
op_or_assign
(paren
id|ecx
op_amp
l_int|0x7f
)paren
op_lshift
l_int|7
suffix:semicolon
id|voice-&gt;parm3
op_and_assign
l_int|0xFFFFFF80
suffix:semicolon
id|voice-&gt;parm3
op_or_assign
(paren
id|eax
op_amp
l_int|0x7f
)paren
suffix:semicolon
)brace
r_else
(brace
id|voice-&gt;parm3
op_and_assign
l_int|0xFFE03FFF
suffix:semicolon
id|voice-&gt;parm3
op_or_assign
(paren
id|eax
op_amp
l_int|0xFE00
)paren
op_lshift
l_int|5
suffix:semicolon
)brace
id|hwwrite
c_func
(paren
id|vortex
comma
id|WT_PARM
c_func
(paren
id|wt
comma
l_int|3
)paren
comma
id|voice-&gt;parm3
)paren
suffix:semicolon
)brace
multiline_comment|/* Extract of CAdbTopology::SetFrequency(unsigned long arg_0) */
r_static
r_void
id|vortex_wt_SetFrequency
c_func
(paren
id|vortex_t
op_star
id|vortex
comma
r_int
id|wt
comma
r_int
r_int
id|sr
)paren
(brace
id|wt_voice_t
op_star
id|voice
op_assign
op_amp
(paren
id|vortex-&gt;wt_voice
(braket
id|wt
)braket
)paren
suffix:semicolon
r_int
r_int
id|eax
comma
id|edx
suffix:semicolon
singleline_comment|//FIXME: 64 bit operation.
id|eax
op_assign
(paren
(paren
id|sr
op_lshift
l_int|0xf
)paren
op_star
l_int|0x57619F1
)paren
op_amp
l_int|0xffffffff
suffix:semicolon
id|edx
op_assign
(paren
(paren
(paren
id|sr
op_lshift
l_int|0xf
)paren
op_star
l_int|0x57619F1
)paren
)paren
op_rshift
l_int|0x20
suffix:semicolon
id|edx
op_rshift_assign
l_int|0xa
suffix:semicolon
id|edx
op_lshift_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|edx
)paren
(brace
r_if
c_cond
(paren
id|edx
op_amp
l_int|0x0FFF80000
)paren
id|eax
op_assign
l_int|0x7fff
suffix:semicolon
r_else
(brace
id|edx
op_lshift_assign
l_int|0xd
suffix:semicolon
id|eax
op_assign
l_int|7
suffix:semicolon
r_while
c_loop
(paren
(paren
id|edx
op_amp
l_int|0x80000000
)paren
op_eq
l_int|0
)paren
(brace
id|edx
op_lshift_assign
l_int|1
suffix:semicolon
id|eax
op_decrement
suffix:semicolon
r_if
c_cond
(paren
id|eax
op_eq
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|eax
)paren
id|edx
op_lshift_assign
l_int|1
suffix:semicolon
id|eax
op_lshift_assign
l_int|0xc
suffix:semicolon
id|edx
op_rshift_assign
l_int|0x14
suffix:semicolon
id|eax
op_or_assign
id|edx
suffix:semicolon
)brace
)brace
r_else
id|eax
op_assign
l_int|0
suffix:semicolon
id|voice-&gt;parm0
op_and_assign
l_int|0xffff0001
suffix:semicolon
id|voice-&gt;parm0
op_or_assign
(paren
id|eax
op_amp
l_int|0x7fff
)paren
op_lshift
l_int|1
suffix:semicolon
id|voice-&gt;parm1
op_assign
id|voice-&gt;parm0
op_or
l_int|1
suffix:semicolon
singleline_comment|// Wt: this_1D4
singleline_comment|//AuWt::WriteReg((ulong)(this_1DC&lt;&lt;4)+0x200, (ulong)this_1E4);
singleline_comment|//AuWt::WriteReg((ulong)(this_1DC&lt;&lt;4)+0x204, (ulong)this_1E8);
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|WT_PARM
c_func
(paren
id|wt
comma
l_int|0
)paren
comma
id|voice-&gt;parm0
)paren
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|WT_PARM
c_func
(paren
id|wt
comma
l_int|1
)paren
comma
id|voice-&gt;parm1
)paren
suffix:semicolon
)brace
macro_line|#endif
multiline_comment|/* End of File */
eof
