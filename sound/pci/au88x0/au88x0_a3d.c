multiline_comment|/***************************************************************************&n; *            au88x0_a3d.c&n; *&n; *  Fri Jul 18 14:16:22 2003&n; *  Copyright  2003  mjander&n; *  mjander@users.sourceforge.net&n; *&n; * A3D. You may think i&squot;m crazy, but this may work someday. Who knows...&n; ****************************************************************************/
multiline_comment|/*&n; *  This program is free software; you can redistribute it and/or modify&n; *  it under the terms of the GNU General Public License as published by&n; *  the Free Software Foundation; either version 2 of the License, or&n; *  (at your option) any later version.&n; *&n; *  This program is distributed in the hope that it will be useful,&n; *  but WITHOUT ANY WARRANTY; without even the implied warranty of&n; *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; *  GNU Library General Public License for more details.&n; *&n; *  You should have received a copy of the GNU General Public License&n; *  along with this program; if not, write to the Free Software&n; *  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.&n; */
macro_line|#include &quot;au88x0_a3d.h&quot;
macro_line|#include &quot;au88x0_a3ddata.c&quot;
macro_line|#include &quot;au88x0_xtalk.h&quot;
macro_line|#include &quot;au88x0.h&quot;
r_static
r_void
DECL|function|a3dsrc_SetTimeConsts
id|a3dsrc_SetTimeConsts
c_func
(paren
id|a3dsrc_t
op_star
id|a
comma
r_int
id|HrtfTrack
comma
r_int
id|ItdTrack
comma
r_int
id|GTrack
comma
r_int
id|CTrack
)paren
(brace
id|vortex_t
op_star
id|vortex
op_assign
(paren
id|vortex_t
op_star
)paren
(paren
id|a-&gt;vortex
)paren
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrA
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_A_HrtfTrackTC
)paren
comma
id|HrtfTrack
)paren
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrA
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_A_ITDTrackTC
)paren
comma
id|ItdTrack
)paren
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrA
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_A_GainTrackTC
)paren
comma
id|GTrack
)paren
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrA
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_A_CoeffTrackTC
)paren
comma
id|CTrack
)paren
suffix:semicolon
)brace
macro_line|#if 0
r_static
r_void
id|a3dsrc_GetTimeConsts
c_func
(paren
id|a3dsrc_t
op_star
id|a
comma
r_int
op_star
id|HrtfTrack
comma
r_int
op_star
id|ItdTrack
comma
r_int
op_star
id|GTrack
comma
r_int
op_star
id|CTrack
)paren
(brace
singleline_comment|// stub!
)brace
macro_line|#endif
multiline_comment|/* Atmospheric absorbtion. */
r_static
r_void
DECL|function|a3dsrc_SetAtmosTarget
id|a3dsrc_SetAtmosTarget
c_func
(paren
id|a3dsrc_t
op_star
id|a
comma
r_int
id|aa
comma
r_int
id|b
comma
r_int
id|c
comma
r_int
id|d
comma
r_int
id|e
)paren
(brace
id|vortex_t
op_star
id|vortex
op_assign
(paren
id|vortex_t
op_star
)paren
(paren
id|a-&gt;vortex
)paren
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrB
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_B_A21Target
)paren
comma
(paren
id|e
op_lshift
l_int|0x10
)paren
op_or
id|d
)paren
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrB
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_B_B10Target
)paren
comma
(paren
id|b
op_lshift
l_int|0x10
)paren
op_or
id|aa
)paren
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrB
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_B_B2Target
)paren
comma
id|c
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|a3dsrc_SetAtmosCurrent
id|a3dsrc_SetAtmosCurrent
c_func
(paren
id|a3dsrc_t
op_star
id|a
comma
r_int
id|aa
comma
r_int
id|b
comma
r_int
id|c
comma
r_int
id|d
comma
r_int
id|e
)paren
(brace
id|vortex_t
op_star
id|vortex
op_assign
(paren
id|vortex_t
op_star
)paren
(paren
id|a-&gt;vortex
)paren
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrB
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_B_A12Current
)paren
comma
(paren
id|e
op_lshift
l_int|0x10
)paren
op_or
id|d
)paren
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrB
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_B_B01Current
)paren
comma
(paren
id|b
op_lshift
l_int|0x10
)paren
op_or
id|aa
)paren
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrB
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_B_B2Current
)paren
comma
id|c
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|a3dsrc_SetAtmosState
id|a3dsrc_SetAtmosState
c_func
(paren
id|a3dsrc_t
op_star
id|a
comma
r_int
id|x1
comma
r_int
id|x2
comma
r_int
id|y1
comma
r_int
id|y2
)paren
(brace
id|vortex_t
op_star
id|vortex
op_assign
(paren
id|vortex_t
op_star
)paren
(paren
id|a-&gt;vortex
)paren
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrA
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_A_x1
)paren
comma
id|x1
)paren
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrA
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_A_x2
)paren
comma
id|x2
)paren
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrA
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_A_y1
)paren
comma
id|y1
)paren
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrA
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_A_y2
)paren
comma
id|y2
)paren
suffix:semicolon
)brace
macro_line|#if 0
r_static
r_void
id|a3dsrc_GetAtmosTarget
c_func
(paren
id|a3dsrc_t
op_star
id|a
comma
r_int
op_star
id|aa
comma
r_int
op_star
id|b
comma
r_int
op_star
id|c
comma
r_int
op_star
id|d
comma
r_int
op_star
id|e
)paren
(brace
)brace
r_static
r_void
id|a3dsrc_GetAtmosCurrent
c_func
(paren
id|a3dsrc_t
op_star
id|a
comma
r_int
op_star
id|bb01
comma
r_int
op_star
id|ab01
comma
r_int
op_star
id|b2
comma
r_int
op_star
id|aa12
comma
r_int
op_star
id|ba12
)paren
(brace
id|vortex_t
op_star
id|vortex
op_assign
(paren
id|vortex_t
op_star
)paren
(paren
id|a-&gt;vortex
)paren
suffix:semicolon
op_star
id|aa12
op_assign
id|hwread
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrA
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_A_A12Current
)paren
)paren
suffix:semicolon
op_star
id|ba12
op_assign
id|hwread
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrB
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_B_A12Current
)paren
)paren
suffix:semicolon
op_star
id|ab01
op_assign
id|hwread
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrA
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_A_B01Current
)paren
)paren
suffix:semicolon
op_star
id|bb01
op_assign
id|hwread
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrB
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_B_B01Current
)paren
)paren
suffix:semicolon
op_star
id|b2
op_assign
id|hwread
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrA
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_A_B2Current
)paren
)paren
suffix:semicolon
)brace
r_static
r_void
id|a3dsrc_GetAtmosState
c_func
(paren
id|a3dsrc_t
op_star
id|a
comma
r_int
op_star
id|x1
comma
r_int
op_star
id|x2
comma
r_int
op_star
id|y1
comma
r_int
op_star
id|y2
)paren
(brace
)brace
macro_line|#endif
multiline_comment|/* HRTF */
r_static
r_void
DECL|function|a3dsrc_SetHrtfTarget
id|a3dsrc_SetHrtfTarget
c_func
(paren
id|a3dsrc_t
op_star
id|a
comma
id|a3d_Hrtf_t
r_const
id|aa
comma
id|a3d_Hrtf_t
r_const
id|b
)paren
(brace
id|vortex_t
op_star
id|vortex
op_assign
(paren
id|vortex_t
op_star
)paren
(paren
id|a-&gt;vortex
)paren
suffix:semicolon
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|HRTF_SZ
suffix:semicolon
id|i
op_increment
)paren
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrB
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_B_HrtfTarget
)paren
op_plus
(paren
id|i
op_lshift
l_int|2
)paren
comma
(paren
id|b
(braket
id|i
)braket
op_lshift
l_int|0x10
)paren
op_or
id|aa
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|a3dsrc_SetHrtfCurrent
id|a3dsrc_SetHrtfCurrent
c_func
(paren
id|a3dsrc_t
op_star
id|a
comma
id|a3d_Hrtf_t
r_const
id|aa
comma
id|a3d_Hrtf_t
r_const
id|b
)paren
(brace
id|vortex_t
op_star
id|vortex
op_assign
(paren
id|vortex_t
op_star
)paren
(paren
id|a-&gt;vortex
)paren
suffix:semicolon
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|HRTF_SZ
suffix:semicolon
id|i
op_increment
)paren
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrB
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_B_HrtfCurrent
)paren
op_plus
(paren
id|i
op_lshift
l_int|2
)paren
comma
(paren
id|b
(braket
id|i
)braket
op_lshift
l_int|0x10
)paren
op_or
id|aa
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|a3dsrc_SetHrtfState
id|a3dsrc_SetHrtfState
c_func
(paren
id|a3dsrc_t
op_star
id|a
comma
id|a3d_Hrtf_t
r_const
id|aa
comma
id|a3d_Hrtf_t
r_const
id|b
)paren
(brace
id|vortex_t
op_star
id|vortex
op_assign
(paren
id|vortex_t
op_star
)paren
(paren
id|a-&gt;vortex
)paren
suffix:semicolon
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|HRTF_SZ
suffix:semicolon
id|i
op_increment
)paren
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrB
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_B_HrtfDelayLine
)paren
op_plus
(paren
id|i
op_lshift
l_int|2
)paren
comma
(paren
id|b
(braket
id|i
)braket
op_lshift
l_int|0x10
)paren
op_or
id|aa
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
DECL|function|a3dsrc_SetHrtfOutput
r_static
r_void
id|a3dsrc_SetHrtfOutput
c_func
(paren
id|a3dsrc_t
op_star
id|a
comma
r_int
id|left
comma
r_int
id|right
)paren
(brace
id|vortex_t
op_star
id|vortex
op_assign
(paren
id|vortex_t
op_star
)paren
(paren
id|a-&gt;vortex
)paren
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrA
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_A_HrtfOutL
)paren
comma
id|left
)paren
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrA
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_A_HrtfOutR
)paren
comma
id|right
)paren
suffix:semicolon
)brace
macro_line|#if 0
r_static
r_void
id|a3dsrc_GetHrtfTarget
c_func
(paren
id|a3dsrc_t
op_star
id|a
comma
id|a3d_Hrtf_t
id|aa
comma
id|a3d_Hrtf_t
id|b
)paren
(brace
id|vortex_t
op_star
id|vortex
op_assign
(paren
id|vortex_t
op_star
)paren
(paren
id|a-&gt;vortex
)paren
suffix:semicolon
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|HRTF_SZ
suffix:semicolon
id|i
op_increment
)paren
id|aa
(braket
id|i
)braket
op_assign
id|hwread
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrA
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_A_HrtfTarget
op_plus
(paren
id|i
op_lshift
l_int|2
)paren
)paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|HRTF_SZ
suffix:semicolon
id|i
op_increment
)paren
id|b
(braket
id|i
)braket
op_assign
id|hwread
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrB
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_B_HrtfTarget
op_plus
(paren
id|i
op_lshift
l_int|2
)paren
)paren
)paren
suffix:semicolon
)brace
r_static
r_void
id|a3dsrc_GetHrtfCurrent
c_func
(paren
id|a3dsrc_t
op_star
id|a
comma
id|a3d_Hrtf_t
id|aa
comma
id|a3d_Hrtf_t
id|b
)paren
(brace
id|vortex_t
op_star
id|vortex
op_assign
(paren
id|vortex_t
op_star
)paren
(paren
id|a-&gt;vortex
)paren
suffix:semicolon
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|HRTF_SZ
suffix:semicolon
id|i
op_increment
)paren
id|aa
(braket
id|i
)braket
op_assign
id|hwread
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrA
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_A_HrtfCurrent
op_plus
(paren
id|i
op_lshift
l_int|2
)paren
)paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|HRTF_SZ
suffix:semicolon
id|i
op_increment
)paren
id|b
(braket
id|i
)braket
op_assign
id|hwread
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrB
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_B_HrtfCurrent
op_plus
(paren
id|i
op_lshift
l_int|2
)paren
)paren
)paren
suffix:semicolon
)brace
r_static
r_void
id|a3dsrc_GetHrtfState
c_func
(paren
id|a3dsrc_t
op_star
id|a
comma
id|a3d_Hrtf_t
id|aa
comma
id|a3d_Hrtf_t
id|b
)paren
(brace
id|vortex_t
op_star
id|vortex
op_assign
(paren
id|vortex_t
op_star
)paren
(paren
id|a-&gt;vortex
)paren
suffix:semicolon
r_int
id|i
suffix:semicolon
singleline_comment|// FIXME: verify this!
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|HRTF_SZ
suffix:semicolon
id|i
op_increment
)paren
id|aa
(braket
id|i
)braket
op_assign
id|hwread
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrA
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_A_HrtfDelayLine
op_plus
(paren
id|i
op_lshift
l_int|2
)paren
)paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|HRTF_SZ
suffix:semicolon
id|i
op_increment
)paren
id|b
(braket
id|i
)braket
op_assign
id|hwread
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrB
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_B_HrtfDelayLine
op_plus
(paren
id|i
op_lshift
l_int|2
)paren
)paren
)paren
suffix:semicolon
)brace
r_static
r_void
id|a3dsrc_GetHrtfOutput
c_func
(paren
id|a3dsrc_t
op_star
id|a
comma
r_int
op_star
id|left
comma
r_int
op_star
id|right
)paren
(brace
id|vortex_t
op_star
id|vortex
op_assign
(paren
id|vortex_t
op_star
)paren
(paren
id|a-&gt;vortex
)paren
suffix:semicolon
op_star
id|left
op_assign
id|hwread
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrA
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_A_HrtfOutL
)paren
)paren
suffix:semicolon
op_star
id|right
op_assign
id|hwread
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrA
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_A_HrtfOutR
)paren
)paren
suffix:semicolon
)brace
macro_line|#endif
multiline_comment|/* Interaural Time Difference. &n; * &quot;The other main clue that humans use to locate sounds, is called &n; * Interaural Time Difference (ITD). The differences in distance from &n; * the sound source to a listeners ears means  that the sound will &n; * reach one ear slightly before the other....&quot;, found somewhere with google.*/
DECL|function|a3dsrc_SetItdTarget
r_static
r_void
id|a3dsrc_SetItdTarget
c_func
(paren
id|a3dsrc_t
op_star
id|a
comma
r_int
id|litd
comma
r_int
id|ritd
)paren
(brace
id|vortex_t
op_star
id|vortex
op_assign
(paren
id|vortex_t
op_star
)paren
(paren
id|a-&gt;vortex
)paren
suffix:semicolon
r_if
c_cond
(paren
id|litd
OL
l_int|0
)paren
id|litd
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|litd
OG
l_int|0x57FF
)paren
id|litd
op_assign
l_int|0x57FF
suffix:semicolon
r_if
c_cond
(paren
id|ritd
OL
l_int|0
)paren
id|ritd
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|ritd
OG
l_int|0x57FF
)paren
id|ritd
op_assign
l_int|0x57FF
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrB
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_B_ITDTarget
)paren
comma
(paren
id|ritd
op_lshift
l_int|0x10
)paren
op_or
id|litd
)paren
suffix:semicolon
singleline_comment|//hwwrite(vortex-&gt;mmio, addr(0x191DF+5, this04, this08), (ritd&lt;&lt;0x10)|litd);
)brace
DECL|function|a3dsrc_SetItdCurrent
r_static
r_void
id|a3dsrc_SetItdCurrent
c_func
(paren
id|a3dsrc_t
op_star
id|a
comma
r_int
id|litd
comma
r_int
id|ritd
)paren
(brace
id|vortex_t
op_star
id|vortex
op_assign
(paren
id|vortex_t
op_star
)paren
(paren
id|a-&gt;vortex
)paren
suffix:semicolon
r_if
c_cond
(paren
id|litd
OL
l_int|0
)paren
id|litd
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|litd
OG
l_int|0x57FF
)paren
id|litd
op_assign
l_int|0x57FF
suffix:semicolon
r_if
c_cond
(paren
id|ritd
OL
l_int|0
)paren
id|ritd
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|ritd
OG
l_int|0x57FF
)paren
id|ritd
op_assign
l_int|0x57FF
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrB
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_B_ITDCurrent
)paren
comma
(paren
id|ritd
op_lshift
l_int|0x10
)paren
op_or
id|litd
)paren
suffix:semicolon
singleline_comment|//hwwrite(vortex-&gt;mmio, addr(0x191DF+1, this04, this08), (ritd&lt;&lt;0x10)|litd);
)brace
DECL|function|a3dsrc_SetItdDline
r_static
r_void
id|a3dsrc_SetItdDline
c_func
(paren
id|a3dsrc_t
op_star
id|a
comma
id|a3d_ItdDline_t
r_const
id|dline
)paren
(brace
id|vortex_t
op_star
id|vortex
op_assign
(paren
id|vortex_t
op_star
)paren
(paren
id|a-&gt;vortex
)paren
suffix:semicolon
r_int
id|i
suffix:semicolon
multiline_comment|/* 45 != 40 -&gt; Check this ! */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|DLINE_SZ
suffix:semicolon
id|i
op_increment
)paren
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrA
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_A_ITDDelayLine
)paren
op_plus
(paren
id|i
op_lshift
l_int|2
)paren
comma
id|dline
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
macro_line|#if 0
r_static
r_void
id|a3dsrc_GetItdTarget
c_func
(paren
id|a3dsrc_t
op_star
id|a
comma
r_int
op_star
id|litd
comma
r_int
op_star
id|ritd
)paren
(brace
id|vortex_t
op_star
id|vortex
op_assign
(paren
id|vortex_t
op_star
)paren
(paren
id|a-&gt;vortex
)paren
suffix:semicolon
op_star
id|ritd
op_assign
id|hwread
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrA
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_A_ITDTarget
)paren
)paren
suffix:semicolon
op_star
id|litd
op_assign
id|hwread
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrB
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_B_ITDTarget
)paren
)paren
suffix:semicolon
)brace
r_static
r_void
id|a3dsrc_GetItdCurrent
c_func
(paren
id|a3dsrc_t
op_star
id|a
comma
r_int
op_star
id|litd
comma
r_int
op_star
id|ritd
)paren
(brace
id|vortex_t
op_star
id|vortex
op_assign
(paren
id|vortex_t
op_star
)paren
(paren
id|a-&gt;vortex
)paren
suffix:semicolon
op_star
id|ritd
op_assign
id|hwread
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrA
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_A_ITDCurrent
)paren
)paren
suffix:semicolon
op_star
id|litd
op_assign
id|hwread
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrB
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_B_ITDCurrent
)paren
)paren
suffix:semicolon
)brace
r_static
r_void
id|a3dsrc_GetItdDline
c_func
(paren
id|a3dsrc_t
op_star
id|a
comma
id|a3d_ItdDline_t
id|dline
)paren
(brace
id|vortex_t
op_star
id|vortex
op_assign
(paren
id|vortex_t
op_star
)paren
(paren
id|a-&gt;vortex
)paren
suffix:semicolon
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|DLINE_SZ
suffix:semicolon
id|i
op_increment
)paren
id|dline
(braket
id|i
)braket
op_assign
id|hwread
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrA
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_A_ITDDelayLine
op_plus
(paren
id|i
op_lshift
l_int|2
)paren
)paren
)paren
suffix:semicolon
)brace
macro_line|#endif
multiline_comment|/* This is may be used for ILD Interaural Level Difference. */
DECL|function|a3dsrc_SetGainTarget
r_static
r_void
id|a3dsrc_SetGainTarget
c_func
(paren
id|a3dsrc_t
op_star
id|a
comma
r_int
id|left
comma
r_int
id|right
)paren
(brace
id|vortex_t
op_star
id|vortex
op_assign
(paren
id|vortex_t
op_star
)paren
(paren
id|a-&gt;vortex
)paren
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrB
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_B_GainTarget
)paren
comma
(paren
id|right
op_lshift
l_int|0x10
)paren
op_or
id|left
)paren
suffix:semicolon
)brace
DECL|function|a3dsrc_SetGainCurrent
r_static
r_void
id|a3dsrc_SetGainCurrent
c_func
(paren
id|a3dsrc_t
op_star
id|a
comma
r_int
id|left
comma
r_int
id|right
)paren
(brace
id|vortex_t
op_star
id|vortex
op_assign
(paren
id|vortex_t
op_star
)paren
(paren
id|a-&gt;vortex
)paren
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrB
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_B_GainCurrent
)paren
comma
(paren
id|right
op_lshift
l_int|0x10
)paren
op_or
id|left
)paren
suffix:semicolon
)brace
macro_line|#if 0
r_static
r_void
id|a3dsrc_GetGainTarget
c_func
(paren
id|a3dsrc_t
op_star
id|a
comma
r_int
op_star
id|left
comma
r_int
op_star
id|right
)paren
(brace
id|vortex_t
op_star
id|vortex
op_assign
(paren
id|vortex_t
op_star
)paren
(paren
id|a-&gt;vortex
)paren
suffix:semicolon
op_star
id|right
op_assign
id|hwread
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrA
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_A_GainTarget
)paren
)paren
suffix:semicolon
op_star
id|left
op_assign
id|hwread
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrB
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_B_GainTarget
)paren
)paren
suffix:semicolon
)brace
r_static
r_void
id|a3dsrc_GetGainCurrent
c_func
(paren
id|a3dsrc_t
op_star
id|a
comma
r_int
op_star
id|left
comma
r_int
op_star
id|right
)paren
(brace
id|vortex_t
op_star
id|vortex
op_assign
(paren
id|vortex_t
op_star
)paren
(paren
id|a-&gt;vortex
)paren
suffix:semicolon
op_star
id|right
op_assign
id|hwread
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrA
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_A_GainCurrent
)paren
)paren
suffix:semicolon
op_star
id|left
op_assign
id|hwread
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrB
c_func
(paren
id|a-&gt;slice
comma
id|a-&gt;source
comma
id|A3D_B_GainCurrent
)paren
)paren
suffix:semicolon
)brace
multiline_comment|/* CA3dIO this func seems to be inlined all over this place. */
r_static
r_void
id|CA3dIO_WriteReg
c_func
(paren
id|a3dsrc_t
op_star
id|a
comma
r_int
r_int
id|addr
comma
r_int
id|aa
comma
r_int
id|b
)paren
(brace
id|vortex_t
op_star
id|vortex
op_assign
(paren
id|vortex_t
op_star
)paren
(paren
id|a-&gt;vortex
)paren
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|addr
comma
(paren
id|aa
op_lshift
l_int|0x10
)paren
op_or
id|b
)paren
suffix:semicolon
)brace
macro_line|#endif
multiline_comment|/* Generic A3D stuff */
DECL|function|a3dsrc_SetA3DSampleRate
r_static
r_void
id|a3dsrc_SetA3DSampleRate
c_func
(paren
id|a3dsrc_t
op_star
id|a
comma
r_int
id|sr
)paren
(brace
id|vortex_t
op_star
id|vortex
op_assign
(paren
id|vortex_t
op_star
)paren
(paren
id|a-&gt;vortex
)paren
suffix:semicolon
r_int
id|esp0
op_assign
l_int|0
suffix:semicolon
id|esp0
op_assign
(paren
(paren
(paren
id|esp0
op_amp
l_int|0x7fffffff
)paren
op_or
l_int|0xB8000000
)paren
op_amp
l_int|0x7
)paren
op_or
(paren
(paren
id|sr
op_amp
l_int|0x1f
)paren
op_lshift
l_int|3
)paren
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|A3D_SLICE_Control
op_plus
(paren
(paren
id|a-&gt;slice
)paren
op_lshift
l_int|0xd
)paren
comma
id|esp0
)paren
suffix:semicolon
singleline_comment|//hwwrite(vortex-&gt;mmio, 0x19C38 + (this08&lt;&lt;0xd), esp0);
)brace
DECL|function|a3dsrc_EnableA3D
r_static
r_void
id|a3dsrc_EnableA3D
c_func
(paren
id|a3dsrc_t
op_star
id|a
)paren
(brace
id|vortex_t
op_star
id|vortex
op_assign
(paren
id|vortex_t
op_star
)paren
(paren
id|a-&gt;vortex
)paren
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|A3D_SLICE_Control
op_plus
(paren
(paren
id|a-&gt;slice
)paren
op_lshift
l_int|0xd
)paren
comma
l_int|0xF0000001
)paren
suffix:semicolon
singleline_comment|//hwwrite(vortex-&gt;mmio, 0x19C38 + (this08&lt;&lt;0xd), 0xF0000001);
)brace
DECL|function|a3dsrc_DisableA3D
r_static
r_void
id|a3dsrc_DisableA3D
c_func
(paren
id|a3dsrc_t
op_star
id|a
)paren
(brace
id|vortex_t
op_star
id|vortex
op_assign
(paren
id|vortex_t
op_star
)paren
(paren
id|a-&gt;vortex
)paren
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|A3D_SLICE_Control
op_plus
(paren
(paren
id|a-&gt;slice
)paren
op_lshift
l_int|0xd
)paren
comma
l_int|0xF0000000
)paren
suffix:semicolon
)brace
DECL|function|a3dsrc_SetA3DControlReg
r_static
r_void
id|a3dsrc_SetA3DControlReg
c_func
(paren
id|a3dsrc_t
op_star
id|a
comma
r_int
r_int
id|ctrl
)paren
(brace
id|vortex_t
op_star
id|vortex
op_assign
(paren
id|vortex_t
op_star
)paren
(paren
id|a-&gt;vortex
)paren
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|A3D_SLICE_Control
op_plus
(paren
(paren
id|a-&gt;slice
)paren
op_lshift
l_int|0xd
)paren
comma
id|ctrl
)paren
suffix:semicolon
)brace
DECL|function|a3dsrc_SetA3DPointerReg
r_static
r_void
id|a3dsrc_SetA3DPointerReg
c_func
(paren
id|a3dsrc_t
op_star
id|a
comma
r_int
r_int
id|ptr
)paren
(brace
id|vortex_t
op_star
id|vortex
op_assign
(paren
id|vortex_t
op_star
)paren
(paren
id|a-&gt;vortex
)paren
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|A3D_SLICE_Pointers
op_plus
(paren
(paren
id|a-&gt;slice
)paren
op_lshift
l_int|0xd
)paren
comma
id|ptr
)paren
suffix:semicolon
)brace
macro_line|#if 0
r_static
r_void
id|a3dsrc_GetA3DSampleRate
c_func
(paren
id|a3dsrc_t
op_star
id|a
comma
r_int
op_star
id|sr
)paren
(brace
id|vortex_t
op_star
id|vortex
op_assign
(paren
id|vortex_t
op_star
)paren
(paren
id|a-&gt;vortex
)paren
suffix:semicolon
op_star
id|sr
op_assign
(paren
(paren
id|hwread
c_func
(paren
id|vortex-&gt;mmio
comma
id|A3D_SLICE_Control
op_plus
(paren
id|a-&gt;slice
op_lshift
l_int|0xd
)paren
)paren
op_rshift
l_int|3
)paren
op_amp
l_int|0x1f
)paren
suffix:semicolon
singleline_comment|//*sr = ((hwread(vortex-&gt;mmio, 0x19C38 + (this08&lt;&lt;0xd))&gt;&gt;3)&amp;0x1f);
)brace
r_static
r_void
id|a3dsrc_GetA3DControlReg
c_func
(paren
id|a3dsrc_t
op_star
id|a
comma
r_int
r_int
op_star
id|ctrl
)paren
(brace
id|vortex_t
op_star
id|vortex
op_assign
(paren
id|vortex_t
op_star
)paren
(paren
id|a-&gt;vortex
)paren
suffix:semicolon
op_star
id|ctrl
op_assign
id|hwread
c_func
(paren
id|vortex-&gt;mmio
comma
id|A3D_SLICE_Control
op_plus
(paren
(paren
id|a-&gt;slice
)paren
op_lshift
l_int|0xd
)paren
)paren
suffix:semicolon
)brace
r_static
r_void
id|a3dsrc_GetA3DPointerReg
c_func
(paren
id|a3dsrc_t
op_star
id|a
comma
r_int
r_int
op_star
id|ptr
)paren
(brace
id|vortex_t
op_star
id|vortex
op_assign
(paren
id|vortex_t
op_star
)paren
(paren
id|a-&gt;vortex
)paren
suffix:semicolon
op_star
id|ptr
op_assign
id|hwread
c_func
(paren
id|vortex-&gt;mmio
comma
id|A3D_SLICE_Pointers
op_plus
(paren
(paren
id|a-&gt;slice
)paren
op_lshift
l_int|0xd
)paren
)paren
suffix:semicolon
)brace
macro_line|#endif
DECL|function|a3dsrc_ZeroSliceIO
r_static
r_void
id|a3dsrc_ZeroSliceIO
c_func
(paren
id|a3dsrc_t
op_star
id|a
)paren
(brace
id|vortex_t
op_star
id|vortex
op_assign
(paren
id|vortex_t
op_star
)paren
(paren
id|a-&gt;vortex
)paren
suffix:semicolon
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|8
suffix:semicolon
id|i
op_increment
)paren
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|A3D_SLICE_VDBDest
op_plus
(paren
(paren
(paren
(paren
id|a-&gt;slice
)paren
op_lshift
l_int|0xb
)paren
op_plus
id|i
)paren
op_lshift
l_int|2
)paren
comma
l_int|0
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|4
suffix:semicolon
id|i
op_increment
)paren
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|A3D_SLICE_VDBSource
op_plus
(paren
(paren
(paren
(paren
id|a-&gt;slice
)paren
op_lshift
l_int|0xb
)paren
op_plus
id|i
)paren
op_lshift
l_int|2
)paren
comma
l_int|0
)paren
suffix:semicolon
)brace
multiline_comment|/* Reset Single A3D source. */
DECL|function|a3dsrc_ZeroState
r_static
r_void
id|a3dsrc_ZeroState
c_func
(paren
id|a3dsrc_t
op_star
id|a
)paren
(brace
singleline_comment|//printk(&quot;vortex: ZeroState slice: %d, source %d&bslash;n&quot;, a-&gt;slice, a-&gt;source);
id|a3dsrc_SetAtmosState
c_func
(paren
id|a
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
id|a3dsrc_SetHrtfState
c_func
(paren
id|a
comma
id|A3dHrirZeros
comma
id|A3dHrirZeros
)paren
suffix:semicolon
id|a3dsrc_SetItdDline
c_func
(paren
id|a
comma
id|A3dItdDlineZeros
)paren
suffix:semicolon
id|a3dsrc_SetHrtfOutput
c_func
(paren
id|a
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
id|a3dsrc_SetTimeConsts
c_func
(paren
id|a
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
id|a3dsrc_SetAtmosCurrent
c_func
(paren
id|a
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
id|a3dsrc_SetAtmosTarget
c_func
(paren
id|a
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
id|a3dsrc_SetItdCurrent
c_func
(paren
id|a
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
id|a3dsrc_SetItdTarget
c_func
(paren
id|a
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
id|a3dsrc_SetGainCurrent
c_func
(paren
id|a
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
id|a3dsrc_SetGainTarget
c_func
(paren
id|a
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
id|a3dsrc_SetHrtfCurrent
c_func
(paren
id|a
comma
id|A3dHrirZeros
comma
id|A3dHrirZeros
)paren
suffix:semicolon
id|a3dsrc_SetHrtfTarget
c_func
(paren
id|a
comma
id|A3dHrirZeros
comma
id|A3dHrirZeros
)paren
suffix:semicolon
)brace
multiline_comment|/* Reset entire A3D engine */
DECL|function|a3dsrc_ZeroStateA3D
r_static
r_void
id|a3dsrc_ZeroStateA3D
c_func
(paren
id|a3dsrc_t
op_star
id|a
)paren
(brace
r_int
id|i
comma
id|var
comma
id|var2
suffix:semicolon
r_if
c_cond
(paren
(paren
id|a-&gt;vortex
)paren
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;vortex: ZeroStateA3D: ERROR: a-&gt;vortex is NULL&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|a3dsrc_SetA3DControlReg
c_func
(paren
id|a
comma
l_int|0
)paren
suffix:semicolon
id|a3dsrc_SetA3DPointerReg
c_func
(paren
id|a
comma
l_int|0
)paren
suffix:semicolon
id|var
op_assign
id|a-&gt;slice
suffix:semicolon
id|var2
op_assign
id|a-&gt;source
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|4
suffix:semicolon
id|i
op_increment
)paren
(brace
id|a-&gt;slice
op_assign
id|i
suffix:semicolon
id|a3dsrc_ZeroSliceIO
c_func
(paren
id|a
)paren
suffix:semicolon
singleline_comment|//a3dsrc_ZeroState(a);
)brace
id|a-&gt;source
op_assign
id|var2
suffix:semicolon
id|a-&gt;slice
op_assign
id|var
suffix:semicolon
)brace
multiline_comment|/* Program A3D block as pass through */
DECL|function|a3dsrc_ProgramPipe
r_static
r_void
id|a3dsrc_ProgramPipe
c_func
(paren
id|a3dsrc_t
op_star
id|a
)paren
(brace
id|a3dsrc_SetTimeConsts
c_func
(paren
id|a
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
id|a3dsrc_SetAtmosCurrent
c_func
(paren
id|a
comma
l_int|0
comma
l_int|0x4000
comma
l_int|0
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
id|a3dsrc_SetAtmosTarget
c_func
(paren
id|a
comma
l_int|0x4000
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
id|a3dsrc_SetItdCurrent
c_func
(paren
id|a
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
id|a3dsrc_SetItdTarget
c_func
(paren
id|a
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
id|a3dsrc_SetGainCurrent
c_func
(paren
id|a
comma
l_int|0x7fff
comma
l_int|0x7fff
)paren
suffix:semicolon
id|a3dsrc_SetGainTarget
c_func
(paren
id|a
comma
l_int|0x7fff
comma
l_int|0x7fff
)paren
suffix:semicolon
multiline_comment|/* SET HRTF HERE */
multiline_comment|/* Single spike leads to identity transfer function. */
id|a3dsrc_SetHrtfCurrent
c_func
(paren
id|a
comma
id|A3dHrirImpulse
comma
id|A3dHrirImpulse
)paren
suffix:semicolon
id|a3dsrc_SetHrtfTarget
c_func
(paren
id|a
comma
id|A3dHrirImpulse
comma
id|A3dHrirImpulse
)paren
suffix:semicolon
multiline_comment|/* Test: Sounds saturated. */
singleline_comment|//a3dsrc_SetHrtfCurrent(a, A3dHrirSatTest, A3dHrirSatTest);
singleline_comment|//a3dsrc_SetHrtfTarget(a, A3dHrirSatTest, A3dHrirSatTest);      
)brace
multiline_comment|/* VDB = Vortex audio Dataflow Bus */
macro_line|#if 0
r_static
r_void
id|a3dsrc_ClearVDBData
c_func
(paren
id|a3dsrc_t
op_star
id|a
comma
r_int
r_int
id|aa
)paren
(brace
id|vortex_t
op_star
id|vortex
op_assign
(paren
id|vortex_t
op_star
)paren
(paren
id|a-&gt;vortex
)paren
suffix:semicolon
singleline_comment|// ((aa &gt;&gt; 2) &lt;&lt; 8) - (aa &gt;&gt; 2)
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrS
c_func
(paren
id|a-&gt;slice
comma
id|A3D_SLICE_VDBDest
)paren
op_plus
(paren
id|a-&gt;source
op_lshift
l_int|2
)paren
comma
l_int|0
)paren
suffix:semicolon
id|hwwrite
c_func
(paren
id|vortex-&gt;mmio
comma
id|a3d_addrS
c_func
(paren
id|a-&gt;slice
comma
id|A3D_SLICE_VDBDest
op_plus
l_int|4
)paren
op_plus
(paren
id|a-&gt;source
op_lshift
l_int|2
)paren
comma
l_int|0
)paren
suffix:semicolon
multiline_comment|/*&n;&t;   hwwrite(vortex-&gt;mmio, 0x19c00 + (((aa&gt;&gt;2)*255*4)+aa)*8, 0);&n;&t;   hwwrite(vortex-&gt;mmio, 0x19c04 + (((aa&gt;&gt;2)*255*4)+aa)*8, 0);&n;&t; */
)brace
macro_line|#endif
multiline_comment|/* A3D HwSource stuff. */
DECL|function|vortex_A3dSourceHw_Initialize
r_static
r_void
id|vortex_A3dSourceHw_Initialize
c_func
(paren
id|vortex_t
op_star
id|v
comma
r_int
id|source
comma
r_int
id|slice
)paren
(brace
id|a3dsrc_t
op_star
id|a3dsrc
op_assign
op_amp
(paren
id|v-&gt;a3d
(braket
id|source
op_plus
(paren
id|slice
op_star
l_int|4
)paren
)braket
)paren
suffix:semicolon
singleline_comment|//a3dsrc_t *a3dsrc = &amp;(v-&gt;a3d[source + (slice*4)]);
id|a3dsrc-&gt;vortex
op_assign
(paren
r_void
op_star
)paren
id|v
suffix:semicolon
id|a3dsrc-&gt;source
op_assign
id|source
suffix:semicolon
multiline_comment|/* source */
id|a3dsrc-&gt;slice
op_assign
id|slice
suffix:semicolon
multiline_comment|/* slice */
id|a3dsrc_ZeroState
c_func
(paren
id|a3dsrc
)paren
suffix:semicolon
multiline_comment|/* Added by me. */
id|a3dsrc_SetA3DSampleRate
c_func
(paren
id|a3dsrc
comma
l_int|0x11
)paren
suffix:semicolon
)brace
DECL|function|Vort3DRend_Initialize
r_static
r_int
id|Vort3DRend_Initialize
c_func
(paren
id|vortex_t
op_star
id|v
comma
r_int
r_int
id|mode
)paren
(brace
id|v-&gt;xt_mode
op_assign
id|mode
suffix:semicolon
multiline_comment|/* this_14 */
id|vortex_XtalkHw_init
c_func
(paren
id|v
)paren
suffix:semicolon
id|vortex_XtalkHw_SetGains
c_func
(paren
id|v
comma
id|asXtalkGainsAllChan
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|v-&gt;xt_mode
)paren
(brace
r_case
id|XT_SPEAKER0
suffix:colon
id|vortex_XtalkHw_ProgramXtalkNarrow
c_func
(paren
id|v
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|XT_SPEAKER1
suffix:colon
id|vortex_XtalkHw_ProgramXtalkWide
c_func
(paren
id|v
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_case
id|XT_HEADPHONE
suffix:colon
id|vortex_XtalkHw_ProgramPipe
c_func
(paren
id|v
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|XT_DIAMOND
suffix:colon
id|vortex_XtalkHw_ProgramDiamondXtalk
c_func
(paren
id|v
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|vortex_XtalkHw_SetSampleRate
c_func
(paren
id|v
comma
l_int|0x11
)paren
suffix:semicolon
id|vortex_XtalkHw_Enable
c_func
(paren
id|v
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* 3D Sound entry points. */
r_static
r_int
id|vortex_a3d_register_controls
c_func
(paren
id|vortex_t
op_star
id|vortex
)paren
suffix:semicolon
r_static
r_void
id|vortex_a3d_unregister_controls
c_func
(paren
id|vortex_t
op_star
id|vortex
)paren
suffix:semicolon
multiline_comment|/* A3D base support init/shudown */
DECL|function|vortex_Vort3D
r_static
r_void
id|vortex_Vort3D
c_func
(paren
id|vortex_t
op_star
id|v
comma
r_int
id|en
)paren
(brace
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
id|en
)paren
(brace
id|Vort3DRend_Initialize
c_func
(paren
id|v
comma
id|XT_HEADPHONE
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|NR_A3D
suffix:semicolon
id|i
op_increment
)paren
(brace
id|vortex_A3dSourceHw_Initialize
c_func
(paren
id|v
comma
id|i
op_mod
l_int|4
comma
id|i
op_rshift
l_int|2
)paren
suffix:semicolon
id|a3dsrc_ZeroStateA3D
c_func
(paren
op_amp
(paren
id|v-&gt;a3d
(braket
l_int|0
)braket
)paren
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
id|vortex_XtalkHw_Disable
c_func
(paren
id|v
)paren
suffix:semicolon
)brace
multiline_comment|/* Register ALSA controls */
r_if
c_cond
(paren
id|en
)paren
(brace
id|vortex_a3d_register_controls
c_func
(paren
id|v
)paren
suffix:semicolon
)brace
r_else
(brace
id|vortex_a3d_unregister_controls
c_func
(paren
id|v
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/* Make A3D subsystem connections. */
DECL|function|vortex_Vort3D_connect
r_static
r_void
id|vortex_Vort3D_connect
c_func
(paren
id|vortex_t
op_star
id|v
comma
r_int
id|en
)paren
(brace
r_int
id|i
suffix:semicolon
singleline_comment|// Disable AU8810 routes, since they seem to be wrong (in au8810.h).
macro_line|#ifdef CHIP_AU8810
r_return
suffix:semicolon
macro_line|#endif
macro_line|#if 1
multiline_comment|/* Alloc Xtalk mixin resources */
id|v-&gt;mixxtlk
(braket
l_int|0
)braket
op_assign
id|vortex_adb_checkinout
c_func
(paren
id|v
comma
id|v-&gt;fixed_res
comma
id|en
comma
id|VORTEX_RESOURCE_MIXIN
)paren
suffix:semicolon
r_if
c_cond
(paren
id|v-&gt;mixxtlk
(braket
l_int|0
)braket
OL
l_int|0
)paren
(brace
id|printk
(paren
l_string|&quot;vortex: vortex_Vort3D: ERROR: not enough free mixer resources.&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|v-&gt;mixxtlk
(braket
l_int|1
)braket
op_assign
id|vortex_adb_checkinout
c_func
(paren
id|v
comma
id|v-&gt;fixed_res
comma
id|en
comma
id|VORTEX_RESOURCE_MIXIN
)paren
suffix:semicolon
r_if
c_cond
(paren
id|v-&gt;mixxtlk
(braket
l_int|1
)braket
OL
l_int|0
)paren
(brace
id|printk
(paren
l_string|&quot;vortex: vortex_Vort3D: ERROR: not enough free mixer resources.&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
macro_line|#endif
multiline_comment|/* Connect A3D -&gt; XTALK */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|4
suffix:semicolon
id|i
op_increment
)paren
(brace
singleline_comment|// 2 outputs per each A3D slice. 
id|vortex_route
c_func
(paren
id|v
comma
id|en
comma
l_int|0x11
comma
id|ADB_A3DOUT
c_func
(paren
id|i
op_star
l_int|2
)paren
comma
id|ADB_XTALKIN
c_func
(paren
id|i
)paren
)paren
suffix:semicolon
id|vortex_route
c_func
(paren
id|v
comma
id|en
comma
l_int|0x11
comma
id|ADB_A3DOUT
c_func
(paren
id|i
op_star
l_int|2
)paren
op_plus
l_int|1
comma
id|ADB_XTALKIN
c_func
(paren
l_int|5
op_plus
id|i
)paren
)paren
suffix:semicolon
)brace
macro_line|#if 0
id|vortex_route
c_func
(paren
id|v
comma
id|en
comma
l_int|0x11
comma
id|ADB_XTALKOUT
c_func
(paren
l_int|0
)paren
comma
id|ADB_EQIN
c_func
(paren
l_int|2
)paren
)paren
suffix:semicolon
id|vortex_route
c_func
(paren
id|v
comma
id|en
comma
l_int|0x11
comma
id|ADB_XTALKOUT
c_func
(paren
l_int|1
)paren
comma
id|ADB_EQIN
c_func
(paren
l_int|3
)paren
)paren
suffix:semicolon
macro_line|#else
multiline_comment|/* Connect XTalk -&gt; mixer */
id|vortex_route
c_func
(paren
id|v
comma
id|en
comma
l_int|0x11
comma
id|ADB_XTALKOUT
c_func
(paren
l_int|0
)paren
comma
id|ADB_MIXIN
c_func
(paren
id|v-&gt;mixxtlk
(braket
l_int|0
)braket
)paren
)paren
suffix:semicolon
id|vortex_route
c_func
(paren
id|v
comma
id|en
comma
l_int|0x11
comma
id|ADB_XTALKOUT
c_func
(paren
l_int|1
)paren
comma
id|ADB_MIXIN
c_func
(paren
id|v-&gt;mixxtlk
(braket
l_int|1
)braket
)paren
)paren
suffix:semicolon
id|vortex_connection_mixin_mix
c_func
(paren
id|v
comma
id|en
comma
id|v-&gt;mixxtlk
(braket
l_int|0
)braket
comma
id|v-&gt;mixplayb
(braket
l_int|0
)braket
comma
l_int|0
)paren
suffix:semicolon
id|vortex_connection_mixin_mix
c_func
(paren
id|v
comma
id|en
comma
id|v-&gt;mixxtlk
(braket
l_int|1
)braket
comma
id|v-&gt;mixplayb
(braket
l_int|1
)braket
comma
l_int|0
)paren
suffix:semicolon
id|vortex_mix_setinputvolumebyte
c_func
(paren
id|v
comma
id|v-&gt;mixplayb
(braket
l_int|0
)braket
comma
id|v-&gt;mixxtlk
(braket
l_int|0
)braket
comma
id|en
ques
c_cond
id|MIX_DEFIGAIN
suffix:colon
id|VOL_MIN
)paren
suffix:semicolon
id|vortex_mix_setinputvolumebyte
c_func
(paren
id|v
comma
id|v-&gt;mixplayb
(braket
l_int|1
)braket
comma
id|v-&gt;mixxtlk
(braket
l_int|1
)braket
comma
id|en
ques
c_cond
id|MIX_DEFIGAIN
suffix:colon
id|VOL_MIN
)paren
suffix:semicolon
r_if
c_cond
(paren
id|VORTEX_IS_QUAD
c_func
(paren
id|v
)paren
)paren
(brace
id|vortex_connection_mixin_mix
c_func
(paren
id|v
comma
id|en
comma
id|v-&gt;mixxtlk
(braket
l_int|0
)braket
comma
id|v-&gt;mixplayb
(braket
l_int|2
)braket
comma
l_int|0
)paren
suffix:semicolon
id|vortex_connection_mixin_mix
c_func
(paren
id|v
comma
id|en
comma
id|v-&gt;mixxtlk
(braket
l_int|1
)braket
comma
id|v-&gt;mixplayb
(braket
l_int|3
)braket
comma
l_int|0
)paren
suffix:semicolon
id|vortex_mix_setinputvolumebyte
c_func
(paren
id|v
comma
id|v-&gt;mixplayb
(braket
l_int|2
)braket
comma
id|v-&gt;mixxtlk
(braket
l_int|0
)braket
comma
id|en
ques
c_cond
id|MIX_DEFIGAIN
suffix:colon
id|VOL_MIN
)paren
suffix:semicolon
id|vortex_mix_setinputvolumebyte
c_func
(paren
id|v
comma
id|v-&gt;mixplayb
(braket
l_int|3
)braket
comma
id|v-&gt;mixxtlk
(braket
l_int|1
)braket
comma
id|en
ques
c_cond
id|MIX_DEFIGAIN
suffix:colon
id|VOL_MIN
)paren
suffix:semicolon
)brace
macro_line|#endif
)brace
multiline_comment|/* Initialize one single A3D source. */
DECL|function|vortex_Vort3D_InitializeSource
r_static
r_void
id|vortex_Vort3D_InitializeSource
c_func
(paren
id|a3dsrc_t
op_star
id|a
comma
r_int
id|en
)paren
(brace
r_if
c_cond
(paren
id|a-&gt;vortex
op_eq
l_int|NULL
)paren
(brace
id|printk
(paren
l_string|&quot;vortex: Vort3D_InitializeSource: A3D source not initialized&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|en
)paren
(brace
id|a3dsrc_ProgramPipe
c_func
(paren
id|a
)paren
suffix:semicolon
id|a3dsrc_SetA3DSampleRate
c_func
(paren
id|a
comma
l_int|0x11
)paren
suffix:semicolon
id|a3dsrc_SetTimeConsts
c_func
(paren
id|a
comma
id|HrtfTCDefault
comma
id|ItdTCDefault
comma
id|GainTCDefault
comma
id|CoefTCDefault
)paren
suffix:semicolon
multiline_comment|/* Remark: zero gain is muted. */
singleline_comment|//a3dsrc_SetGainTarget(a,0,0);
singleline_comment|//a3dsrc_SetGainCurrent(a,0,0);
id|a3dsrc_EnableA3D
c_func
(paren
id|a
)paren
suffix:semicolon
)brace
r_else
(brace
id|a3dsrc_DisableA3D
c_func
(paren
id|a
)paren
suffix:semicolon
id|a3dsrc_ZeroState
c_func
(paren
id|a
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/* Conversion of coordinates into 3D parameters. */
DECL|function|vortex_a3d_coord2hrtf
r_static
r_void
id|vortex_a3d_coord2hrtf
c_func
(paren
id|a3d_Hrtf_t
id|hrtf
comma
r_int
op_star
id|coord
)paren
(brace
multiline_comment|/* FIXME: implement this. */
)brace
DECL|function|vortex_a3d_coord2itd
r_static
r_void
id|vortex_a3d_coord2itd
c_func
(paren
id|a3d_Itd_t
id|itd
comma
r_int
op_star
id|coord
)paren
(brace
multiline_comment|/* FIXME: implement this. */
)brace
DECL|function|vortex_a3d_coord2ild
r_static
r_void
id|vortex_a3d_coord2ild
c_func
(paren
id|a3d_LRGains_t
id|ild
comma
r_int
id|left
comma
r_int
id|right
)paren
(brace
multiline_comment|/* FIXME: implement this. */
)brace
DECL|function|vortex_a3d_translate_filter
r_static
r_void
id|vortex_a3d_translate_filter
c_func
(paren
id|a3d_atmos_t
id|filter
comma
r_int
op_star
id|params
)paren
(brace
multiline_comment|/* FIXME: implement this. */
)brace
multiline_comment|/* ALSA control interface.  */
r_static
r_int
DECL|function|snd_vortex_a3d_hrtf_info
id|snd_vortex_a3d_hrtf_info
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_INTEGER
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|6
suffix:semicolon
id|uinfo-&gt;value.integer.min
op_assign
l_int|0x00000000
suffix:semicolon
id|uinfo-&gt;value.integer.max
op_assign
l_int|0xffffffff
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|snd_vortex_a3d_itd_info
id|snd_vortex_a3d_itd_info
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_INTEGER
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|2
suffix:semicolon
id|uinfo-&gt;value.integer.min
op_assign
l_int|0x00000000
suffix:semicolon
id|uinfo-&gt;value.integer.max
op_assign
l_int|0xffffffff
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|snd_vortex_a3d_ild_info
id|snd_vortex_a3d_ild_info
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_INTEGER
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|2
suffix:semicolon
id|uinfo-&gt;value.integer.min
op_assign
l_int|0x00000000
suffix:semicolon
id|uinfo-&gt;value.integer.max
op_assign
l_int|0xffffffff
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|snd_vortex_a3d_filter_info
id|snd_vortex_a3d_filter_info
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_INTEGER
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|4
suffix:semicolon
id|uinfo-&gt;value.integer.min
op_assign
l_int|0x00000000
suffix:semicolon
id|uinfo-&gt;value.integer.max
op_assign
l_int|0xffffffff
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|snd_vortex_a3d_get
id|snd_vortex_a3d_get
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
singleline_comment|//a3dsrc_t *a = (a3dsrc_t*)(kcontrol-&gt;private_value);
multiline_comment|/* No read yet. Would this be really useable/needed ? */
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|snd_vortex_a3d_hrtf_put
id|snd_vortex_a3d_hrtf_put
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|a3dsrc_t
op_star
id|a
op_assign
(paren
id|a3dsrc_t
op_star
)paren
(paren
id|kcontrol-&gt;private_value
)paren
suffix:semicolon
r_int
id|changed
op_assign
l_int|1
comma
id|i
suffix:semicolon
r_int
id|coord
(braket
l_int|6
)braket
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|6
suffix:semicolon
id|i
op_increment
)paren
id|coord
(braket
id|i
)braket
op_assign
id|ucontrol-&gt;value.integer.value
(braket
id|i
)braket
suffix:semicolon
multiline_comment|/* Translate orientation coordinates to a3d params. */
id|vortex_a3d_coord2hrtf
c_func
(paren
id|a-&gt;hrtf
(braket
l_int|0
)braket
comma
id|coord
)paren
suffix:semicolon
id|vortex_a3d_coord2hrtf
c_func
(paren
id|a-&gt;hrtf
(braket
l_int|1
)braket
comma
id|coord
)paren
suffix:semicolon
id|a3dsrc_SetHrtfTarget
c_func
(paren
id|a
comma
id|a-&gt;hrtf
(braket
l_int|0
)braket
comma
id|a-&gt;hrtf
(braket
l_int|1
)braket
)paren
suffix:semicolon
id|a3dsrc_SetHrtfCurrent
c_func
(paren
id|a
comma
id|a-&gt;hrtf
(braket
l_int|0
)braket
comma
id|a-&gt;hrtf
(braket
l_int|1
)braket
)paren
suffix:semicolon
r_return
id|changed
suffix:semicolon
)brace
r_static
r_int
DECL|function|snd_vortex_a3d_itd_put
id|snd_vortex_a3d_itd_put
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|a3dsrc_t
op_star
id|a
op_assign
(paren
id|a3dsrc_t
op_star
)paren
(paren
id|kcontrol-&gt;private_value
)paren
suffix:semicolon
r_int
id|coord
(braket
l_int|6
)braket
suffix:semicolon
r_int
id|i
comma
id|changed
op_assign
l_int|1
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|6
suffix:semicolon
id|i
op_increment
)paren
id|coord
(braket
id|i
)braket
op_assign
id|ucontrol-&gt;value.integer.value
(braket
id|i
)braket
suffix:semicolon
multiline_comment|/* Translate orientation coordinates to a3d params. */
id|vortex_a3d_coord2itd
c_func
(paren
id|a-&gt;hrtf
(braket
l_int|0
)braket
comma
id|coord
)paren
suffix:semicolon
id|vortex_a3d_coord2itd
c_func
(paren
id|a-&gt;hrtf
(braket
l_int|1
)braket
comma
id|coord
)paren
suffix:semicolon
multiline_comment|/* Inter aural time difference. */
id|a3dsrc_SetItdTarget
c_func
(paren
id|a
comma
id|a-&gt;itd
(braket
l_int|0
)braket
comma
id|a-&gt;itd
(braket
l_int|1
)braket
)paren
suffix:semicolon
id|a3dsrc_SetItdCurrent
c_func
(paren
id|a
comma
id|a-&gt;itd
(braket
l_int|0
)braket
comma
id|a-&gt;itd
(braket
l_int|1
)braket
)paren
suffix:semicolon
id|a3dsrc_SetItdDline
c_func
(paren
id|a
comma
id|a-&gt;dline
)paren
suffix:semicolon
r_return
id|changed
suffix:semicolon
)brace
r_static
r_int
DECL|function|snd_vortex_a3d_ild_put
id|snd_vortex_a3d_ild_put
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|a3dsrc_t
op_star
id|a
op_assign
(paren
id|a3dsrc_t
op_star
)paren
(paren
id|kcontrol-&gt;private_value
)paren
suffix:semicolon
r_int
id|changed
op_assign
l_int|1
suffix:semicolon
r_int
id|l
comma
id|r
suffix:semicolon
multiline_comment|/* There may be some scale tranlation needed here. */
id|l
op_assign
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
suffix:semicolon
id|r
op_assign
id|ucontrol-&gt;value.integer.value
(braket
l_int|1
)braket
suffix:semicolon
id|vortex_a3d_coord2ild
c_func
(paren
id|a-&gt;ild
comma
id|l
comma
id|r
)paren
suffix:semicolon
multiline_comment|/* Left Right panning. */
id|a3dsrc_SetGainTarget
c_func
(paren
id|a
comma
id|l
comma
id|r
)paren
suffix:semicolon
id|a3dsrc_SetGainCurrent
c_func
(paren
id|a
comma
id|l
comma
id|r
)paren
suffix:semicolon
r_return
id|changed
suffix:semicolon
)brace
r_static
r_int
DECL|function|snd_vortex_a3d_filter_put
id|snd_vortex_a3d_filter_put
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|a3dsrc_t
op_star
id|a
op_assign
(paren
id|a3dsrc_t
op_star
)paren
(paren
id|kcontrol-&gt;private_value
)paren
suffix:semicolon
r_int
id|i
comma
id|changed
op_assign
l_int|1
suffix:semicolon
r_int
id|params
(braket
l_int|6
)braket
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|6
suffix:semicolon
id|i
op_increment
)paren
id|params
(braket
id|i
)braket
op_assign
id|ucontrol-&gt;value.integer.value
(braket
id|i
)braket
suffix:semicolon
multiline_comment|/* Translate generic filter params to a3d filter params. */
id|vortex_a3d_translate_filter
c_func
(paren
id|a-&gt;filter
comma
id|params
)paren
suffix:semicolon
multiline_comment|/* Atmospheric absorbtion and filtering. */
id|a3dsrc_SetAtmosTarget
c_func
(paren
id|a
comma
id|a-&gt;filter
(braket
l_int|0
)braket
comma
id|a-&gt;filter
(braket
l_int|1
)braket
comma
id|a-&gt;filter
(braket
l_int|2
)braket
comma
id|a-&gt;filter
(braket
l_int|3
)braket
comma
id|a-&gt;filter
(braket
l_int|4
)braket
)paren
suffix:semicolon
id|a3dsrc_SetAtmosCurrent
c_func
(paren
id|a
comma
id|a-&gt;filter
(braket
l_int|0
)braket
comma
id|a-&gt;filter
(braket
l_int|1
)braket
comma
id|a-&gt;filter
(braket
l_int|2
)braket
comma
id|a-&gt;filter
(braket
l_int|3
)braket
comma
id|a-&gt;filter
(braket
l_int|4
)braket
)paren
suffix:semicolon
r_return
id|changed
suffix:semicolon
)brace
DECL|variable|__devinitdata
r_static
id|snd_kcontrol_new_t
id|vortex_a3d_kcontrol
id|__devinitdata
op_assign
(brace
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_PCM
comma
dot
id|name
op_assign
l_string|&quot;Playback PCM advanced processing&quot;
comma
dot
id|index
op_assign
l_int|0
comma
dot
id|access
op_assign
id|SNDRV_CTL_ELEM_ACCESS_READWRITE
comma
dot
id|private_value
op_assign
l_int|0
comma
dot
id|info
op_assign
id|snd_vortex_a3d_hrtf_info
comma
dot
id|get
op_assign
id|snd_vortex_a3d_get
comma
dot
id|put
op_assign
id|snd_vortex_a3d_hrtf_put
)brace
suffix:semicolon
multiline_comment|/* Control (un)registration. */
DECL|function|vortex_a3d_register_controls
r_static
r_int
id|vortex_a3d_register_controls
c_func
(paren
id|vortex_t
op_star
id|vortex
)paren
(brace
id|snd_kcontrol_t
op_star
id|kcontrol
suffix:semicolon
r_int
id|err
comma
id|i
suffix:semicolon
multiline_comment|/* HRTF controls. */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|NR_A3D
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
(paren
id|kcontrol
op_assign
id|snd_ctl_new1
c_func
(paren
op_amp
id|vortex_a3d_kcontrol
comma
id|vortex
)paren
)paren
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|kcontrol-&gt;private_value
op_assign
(paren
r_int
)paren
op_amp
(paren
id|vortex-&gt;a3d
(braket
id|i
)braket
)paren
suffix:semicolon
id|kcontrol-&gt;id.numid
op_assign
id|CTRLID_HRTF
suffix:semicolon
id|kcontrol-&gt;info
op_assign
id|snd_vortex_a3d_hrtf_info
suffix:semicolon
id|kcontrol-&gt;put
op_assign
id|snd_vortex_a3d_hrtf_put
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|vortex-&gt;card
comma
id|kcontrol
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
multiline_comment|/* ITD controls. */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|NR_A3D
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
(paren
id|kcontrol
op_assign
id|snd_ctl_new1
c_func
(paren
op_amp
id|vortex_a3d_kcontrol
comma
id|vortex
)paren
)paren
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|kcontrol-&gt;private_value
op_assign
(paren
r_int
)paren
op_amp
(paren
id|vortex-&gt;a3d
(braket
id|i
)braket
)paren
suffix:semicolon
id|kcontrol-&gt;id.numid
op_assign
id|CTRLID_ITD
suffix:semicolon
id|kcontrol-&gt;info
op_assign
id|snd_vortex_a3d_itd_info
suffix:semicolon
id|kcontrol-&gt;put
op_assign
id|snd_vortex_a3d_itd_put
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|vortex-&gt;card
comma
id|kcontrol
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
multiline_comment|/* ILD (gains) controls. */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|NR_A3D
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
(paren
id|kcontrol
op_assign
id|snd_ctl_new1
c_func
(paren
op_amp
id|vortex_a3d_kcontrol
comma
id|vortex
)paren
)paren
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|kcontrol-&gt;private_value
op_assign
(paren
r_int
)paren
op_amp
(paren
id|vortex-&gt;a3d
(braket
id|i
)braket
)paren
suffix:semicolon
id|kcontrol-&gt;id.numid
op_assign
id|CTRLID_GAINS
suffix:semicolon
id|kcontrol-&gt;info
op_assign
id|snd_vortex_a3d_ild_info
suffix:semicolon
id|kcontrol-&gt;put
op_assign
id|snd_vortex_a3d_ild_put
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|vortex-&gt;card
comma
id|kcontrol
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
multiline_comment|/* Filter controls. */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|NR_A3D
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
(paren
id|kcontrol
op_assign
id|snd_ctl_new1
c_func
(paren
op_amp
id|vortex_a3d_kcontrol
comma
id|vortex
)paren
)paren
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|kcontrol-&gt;private_value
op_assign
(paren
r_int
)paren
op_amp
(paren
id|vortex-&gt;a3d
(braket
id|i
)braket
)paren
suffix:semicolon
id|kcontrol-&gt;id.numid
op_assign
id|CTRLID_FILTER
suffix:semicolon
id|kcontrol-&gt;info
op_assign
id|snd_vortex_a3d_filter_info
suffix:semicolon
id|kcontrol-&gt;put
op_assign
id|snd_vortex_a3d_filter_put
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|vortex-&gt;card
comma
id|kcontrol
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|vortex_a3d_unregister_controls
r_static
r_void
id|vortex_a3d_unregister_controls
c_func
(paren
id|vortex_t
op_star
id|vortex
)paren
(brace
)brace
multiline_comment|/* End of File*/
eof
