DECL|macro|__NO_VERSION__
mdefine_line|#define __NO_VERSION__
multiline_comment|/*&n; *  Copyright (c) 2004 James Courtier-Dutton &lt;James@superbug.demon.co.uk&gt;&n; *  Driver CA0106 chips. e.g. Sound Blaster Audigy LS and Live 24bit&n; *  Version: 0.0.17&n; *&n; *  FEATURES currently supported:&n; *    See ca0106_main.c for features.&n; * &n; *  Changelog:&n; *    Support interrupts per period.&n; *    Removed noise from Center/LFE channel when in Analog mode.&n; *    Rename and remove mixer controls.&n; *  0.0.6&n; *    Use separate card based DMA buffer for periods table list.&n; *  0.0.7&n; *    Change remove and rename ctrls into lists.&n; *  0.0.8&n; *    Try to fix capture sources.&n; *  0.0.9&n; *    Fix AC3 output.&n; *    Enable S32_LE format support.&n; *  0.0.10&n; *    Enable playback 48000 and 96000 rates. (Rates other that these do not work, even with &quot;plug:front&quot;.)&n; *  0.0.11&n; *    Add Model name recognition.&n; *  0.0.12&n; *    Correct interrupt timing. interrupt at end of period, instead of in the middle of a playback period.&n; *    Remove redundent &quot;voice&quot; handling.&n; *  0.0.13&n; *    Single trigger call for multi channels.&n; *  0.0.14&n; *    Set limits based on what the sound card hardware can do.&n; *    playback periods_min=2, periods_max=8&n; *    capture hw constraints require period_size = n * 64 bytes.&n; *    playback hw constraints require period_size = n * 64 bytes.&n; *  0.0.15&n; *    Separate ca0106.c into separate functional .c files.&n; *  0.0.16&n; *    Modified Copyright message.&n; *  0.0.17&n; *    Add iec958 file in proc file system to show status of SPDIF in.&n; *    &n; *  This code was initally based on code from ALSA&squot;s emu10k1x.c which is:&n; *  Copyright (c) by Francisco Moraes &lt;fmoraes@nc.rr.com&gt;&n; *&n; *   This program is free software; you can redistribute it and/or modify&n; *   it under the terms of the GNU General Public License as published by&n; *   the Free Software Foundation; either version 2 of the License, or&n; *   (at your option) any later version.&n; *&n; *   This program is distributed in the hope that it will be useful,&n; *   but WITHOUT ANY WARRANTY; without even the implied warranty of&n; *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; *   GNU General Public License for more details.&n; *&n; *   You should have received a copy of the GNU General Public License&n; *   along with this program; if not, write to the Free Software&n; *   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA&n; *&n; */
macro_line|#include &lt;sound/driver.h&gt;
macro_line|#include &lt;linux/delay.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/interrupt.h&gt;
macro_line|#include &lt;linux/pci.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;linux/moduleparam.h&gt;
macro_line|#include &lt;sound/core.h&gt;
macro_line|#include &lt;sound/initval.h&gt;
macro_line|#include &lt;sound/pcm.h&gt;
macro_line|#include &lt;sound/ac97_codec.h&gt;
macro_line|#include &lt;sound/info.h&gt;
macro_line|#include &lt;sound/asoundef.h&gt;
macro_line|#include &quot;ca0106.h&quot;
DECL|struct|snd_ca0106_category_str
r_struct
id|snd_ca0106_category_str
(brace
DECL|member|val
r_int
id|val
suffix:semicolon
DECL|member|name
r_const
r_char
op_star
id|name
suffix:semicolon
)brace
suffix:semicolon
DECL|variable|snd_ca0106_con_category
r_static
r_struct
id|snd_ca0106_category_str
id|snd_ca0106_con_category
(braket
)braket
op_assign
(brace
(brace
id|IEC958_AES1_CON_DAT
comma
l_string|&quot;DAT&quot;
)brace
comma
(brace
id|IEC958_AES1_CON_VCR
comma
l_string|&quot;VCR&quot;
)brace
comma
(brace
id|IEC958_AES1_CON_MICROPHONE
comma
l_string|&quot;microphone&quot;
)brace
comma
(brace
id|IEC958_AES1_CON_SYNTHESIZER
comma
l_string|&quot;synthesizer&quot;
)brace
comma
(brace
id|IEC958_AES1_CON_RATE_CONVERTER
comma
l_string|&quot;rate converter&quot;
)brace
comma
(brace
id|IEC958_AES1_CON_MIXER
comma
l_string|&quot;mixer&quot;
)brace
comma
(brace
id|IEC958_AES1_CON_SAMPLER
comma
l_string|&quot;sampler&quot;
)brace
comma
(brace
id|IEC958_AES1_CON_PCM_CODER
comma
l_string|&quot;PCM coder&quot;
)brace
comma
(brace
id|IEC958_AES1_CON_IEC908_CD
comma
l_string|&quot;CD&quot;
)brace
comma
(brace
id|IEC958_AES1_CON_NON_IEC908_CD
comma
l_string|&quot;non-IEC908 CD&quot;
)brace
comma
(brace
id|IEC958_AES1_CON_GENERAL
comma
l_string|&quot;general&quot;
)brace
comma
)brace
suffix:semicolon
DECL|function|snd_ca0106_proc_dump_iec958
r_void
id|snd_ca0106_proc_dump_iec958
c_func
(paren
id|snd_info_buffer_t
op_star
id|buffer
comma
id|u32
id|value
)paren
(brace
r_int
id|i
suffix:semicolon
id|u32
id|status
(braket
l_int|4
)braket
suffix:semicolon
id|status
(braket
l_int|0
)braket
op_assign
id|value
op_amp
l_int|0xff
suffix:semicolon
id|status
(braket
l_int|1
)braket
op_assign
(paren
id|value
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
suffix:semicolon
id|status
(braket
l_int|2
)braket
op_assign
(paren
id|value
op_rshift
l_int|16
)paren
op_amp
l_int|0xff
suffix:semicolon
id|status
(braket
l_int|3
)braket
op_assign
(paren
id|value
op_rshift
l_int|24
)paren
op_amp
l_int|0xff
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|status
(braket
l_int|0
)braket
op_amp
id|IEC958_AES0_PROFESSIONAL
)paren
)paren
(brace
multiline_comment|/* consumer */
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Mode: consumer&bslash;n&quot;
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Data: &quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|status
(braket
l_int|0
)braket
op_amp
id|IEC958_AES0_NONAUDIO
)paren
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;audio&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;non-audio&bslash;n&quot;
)paren
suffix:semicolon
)brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Rate: &quot;
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|status
(braket
l_int|3
)braket
op_amp
id|IEC958_AES3_CON_FS
)paren
(brace
r_case
id|IEC958_AES3_CON_FS_44100
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;44100 Hz&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|IEC958_AES3_CON_FS_48000
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;48000 Hz&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|IEC958_AES3_CON_FS_32000
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;32000 Hz&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;unknown&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Copyright: &quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|status
(braket
l_int|0
)braket
op_amp
id|IEC958_AES0_CON_NOT_COPYRIGHT
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;permitted&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;protected&bslash;n&quot;
)paren
suffix:semicolon
)brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Emphasis: &quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|status
(braket
l_int|0
)braket
op_amp
id|IEC958_AES0_CON_EMPHASIS
)paren
op_ne
id|IEC958_AES0_CON_EMPHASIS_5015
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;none&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;50/15us&bslash;n&quot;
)paren
suffix:semicolon
)brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Category: &quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|ARRAY_SIZE
c_func
(paren
id|snd_ca0106_con_category
)paren
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
(paren
id|status
(braket
l_int|1
)braket
op_amp
id|IEC958_AES1_CON_CATEGORY
)paren
op_eq
id|snd_ca0106_con_category
(braket
id|i
)braket
dot
id|val
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;%s&bslash;n&quot;
comma
id|snd_ca0106_con_category
(braket
id|i
)braket
dot
id|name
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|i
op_ge
id|ARRAY_SIZE
c_func
(paren
id|snd_ca0106_con_category
)paren
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;unknown 0x%x&bslash;n&quot;
comma
id|status
(braket
l_int|1
)braket
op_amp
id|IEC958_AES1_CON_CATEGORY
)paren
suffix:semicolon
)brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Original: &quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|status
(braket
l_int|1
)braket
op_amp
id|IEC958_AES1_CON_ORIGINAL
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;original&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;1st generation&bslash;n&quot;
)paren
suffix:semicolon
)brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Clock: &quot;
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|status
(braket
l_int|3
)braket
op_amp
id|IEC958_AES3_CON_CLOCK
)paren
(brace
r_case
id|IEC958_AES3_CON_CLOCK_1000PPM
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;1000 ppm&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|IEC958_AES3_CON_CLOCK_50PPM
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;50 ppm&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|IEC958_AES3_CON_CLOCK_VARIABLE
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;variable pitch&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;unknown&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_else
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Mode: professional&bslash;n&quot;
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Data: &quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|status
(braket
l_int|0
)braket
op_amp
id|IEC958_AES0_NONAUDIO
)paren
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;audio&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;non-audio&bslash;n&quot;
)paren
suffix:semicolon
)brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Rate: &quot;
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|status
(braket
l_int|0
)braket
op_amp
id|IEC958_AES0_PRO_FS
)paren
(brace
r_case
id|IEC958_AES0_PRO_FS_44100
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;44100 Hz&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|IEC958_AES0_PRO_FS_48000
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;48000 Hz&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|IEC958_AES0_PRO_FS_32000
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;32000 Hz&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;unknown&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Rate Locked: &quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|status
(braket
l_int|0
)braket
op_amp
id|IEC958_AES0_PRO_FREQ_UNLOCKED
)paren
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;no&bslash;n&quot;
)paren
suffix:semicolon
r_else
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;yes&bslash;n&quot;
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Emphasis: &quot;
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|status
(braket
l_int|0
)braket
op_amp
id|IEC958_AES0_PRO_EMPHASIS
)paren
(brace
r_case
id|IEC958_AES0_PRO_EMPHASIS_CCITT
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;CCITT J.17&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|IEC958_AES0_PRO_EMPHASIS_NONE
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;none&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|IEC958_AES0_PRO_EMPHASIS_5015
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;50/15us&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|IEC958_AES0_PRO_EMPHASIS_NOTID
suffix:colon
r_default
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;unknown&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Stereophonic: &quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|status
(braket
l_int|1
)braket
op_amp
id|IEC958_AES1_PRO_MODE
)paren
op_eq
id|IEC958_AES1_PRO_MODE_STEREOPHONIC
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;stereo&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;not indicated&bslash;n&quot;
)paren
suffix:semicolon
)brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Userbits: &quot;
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|status
(braket
l_int|1
)braket
op_amp
id|IEC958_AES1_PRO_USERBITS
)paren
(brace
r_case
id|IEC958_AES1_PRO_USERBITS_192
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;192bit&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|IEC958_AES1_PRO_USERBITS_UDEF
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;user-defined&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;unkown&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Sample Bits: &quot;
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|status
(braket
l_int|2
)braket
op_amp
id|IEC958_AES2_PRO_SBITS
)paren
(brace
r_case
id|IEC958_AES2_PRO_SBITS_20
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;20 bit&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|IEC958_AES2_PRO_SBITS_24
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;24 bit&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|IEC958_AES2_PRO_SBITS_UDEF
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;user defined&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;unknown&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Word Length: &quot;
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|status
(braket
l_int|2
)braket
op_amp
id|IEC958_AES2_PRO_WORDLEN
)paren
(brace
r_case
id|IEC958_AES2_PRO_WORDLEN_22_18
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;22 bit or 18 bit&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|IEC958_AES2_PRO_WORDLEN_23_19
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;23 bit or 19 bit&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|IEC958_AES2_PRO_WORDLEN_24_20
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;24 bit or 20 bit&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|IEC958_AES2_PRO_WORDLEN_20_16
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;20 bit or 16 bit&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;unknown&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
)brace
DECL|function|snd_ca0106_proc_iec958
r_static
r_void
id|snd_ca0106_proc_iec958
c_func
(paren
id|snd_info_entry_t
op_star
id|entry
comma
id|snd_info_buffer_t
op_star
id|buffer
)paren
(brace
id|ca0106_t
op_star
id|emu
op_assign
id|entry-&gt;private_data
suffix:semicolon
id|u32
id|value
suffix:semicolon
id|value
op_assign
id|snd_ca0106_ptr_read
c_func
(paren
id|emu
comma
id|SAMPLE_RATE_TRACKER_STATUS
comma
l_int|0
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Status: %s, %s, %s&bslash;n&quot;
comma
(paren
id|value
op_amp
l_int|0x100000
)paren
ques
c_cond
l_string|&quot;Rate Locked&quot;
suffix:colon
l_string|&quot;Not Rate Locked&quot;
comma
(paren
id|value
op_amp
l_int|0x200000
)paren
ques
c_cond
l_string|&quot;SPDIF Locked&quot;
suffix:colon
l_string|&quot;No SPDIF Lock&quot;
comma
(paren
id|value
op_amp
l_int|0x400000
)paren
ques
c_cond
l_string|&quot;Audio Valid&quot;
suffix:colon
l_string|&quot;No valid audio&quot;
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Estimated sample rate: %u&bslash;n&quot;
comma
(paren
(paren
id|value
op_amp
l_int|0xfffff
)paren
op_star
l_int|48000
)paren
op_div
l_int|0x8000
)paren
suffix:semicolon
r_if
c_cond
(paren
id|value
op_amp
l_int|0x200000
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;IEC958/SPDIF input status:&bslash;n&quot;
)paren
suffix:semicolon
id|value
op_assign
id|snd_ca0106_ptr_read
c_func
(paren
id|emu
comma
id|SPDIF_INPUT_STATUS
comma
l_int|0
)paren
suffix:semicolon
id|snd_ca0106_proc_dump_iec958
c_func
(paren
id|buffer
comma
id|value
)paren
suffix:semicolon
)brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
)brace
DECL|function|snd_ca0106_proc_reg_write32
r_static
r_void
id|snd_ca0106_proc_reg_write32
c_func
(paren
id|snd_info_entry_t
op_star
id|entry
comma
id|snd_info_buffer_t
op_star
id|buffer
)paren
(brace
id|ca0106_t
op_star
id|emu
op_assign
id|entry-&gt;private_data
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_char
id|line
(braket
l_int|64
)braket
suffix:semicolon
id|u32
id|reg
comma
id|val
suffix:semicolon
r_while
c_loop
(paren
op_logical_neg
id|snd_info_get_line
c_func
(paren
id|buffer
comma
id|line
comma
r_sizeof
(paren
id|line
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
id|sscanf
c_func
(paren
id|line
comma
l_string|&quot;%x %x&quot;
comma
op_amp
id|reg
comma
op_amp
id|val
)paren
op_ne
l_int|2
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
(paren
id|reg
OL
l_int|0x40
)paren
op_logical_and
(paren
id|reg
op_ge
l_int|0
)paren
op_logical_and
(paren
id|val
op_le
l_int|0xffffffff
)paren
)paren
(brace
id|spin_lock_irqsave
c_func
(paren
op_amp
id|emu-&gt;emu_lock
comma
id|flags
)paren
suffix:semicolon
id|outl
c_func
(paren
id|val
comma
id|emu-&gt;port
op_plus
(paren
id|reg
op_amp
l_int|0xfffffffc
)paren
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|emu-&gt;emu_lock
comma
id|flags
)paren
suffix:semicolon
)brace
)brace
)brace
DECL|function|snd_ca0106_proc_reg_read32
r_static
r_void
id|snd_ca0106_proc_reg_read32
c_func
(paren
id|snd_info_entry_t
op_star
id|entry
comma
id|snd_info_buffer_t
op_star
id|buffer
)paren
(brace
id|ca0106_t
op_star
id|emu
op_assign
id|entry-&gt;private_data
suffix:semicolon
r_int
r_int
id|value
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
id|i
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Registers:&bslash;n&bslash;n&quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|0x20
suffix:semicolon
id|i
op_add_assign
l_int|4
)paren
(brace
id|spin_lock_irqsave
c_func
(paren
op_amp
id|emu-&gt;emu_lock
comma
id|flags
)paren
suffix:semicolon
id|value
op_assign
id|inl
c_func
(paren
id|emu-&gt;port
op_plus
id|i
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|emu-&gt;emu_lock
comma
id|flags
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Register %02X: %08lX&bslash;n&quot;
comma
id|i
comma
id|value
)paren
suffix:semicolon
)brace
)brace
DECL|function|snd_ca0106_proc_reg_read16
r_static
r_void
id|snd_ca0106_proc_reg_read16
c_func
(paren
id|snd_info_entry_t
op_star
id|entry
comma
id|snd_info_buffer_t
op_star
id|buffer
)paren
(brace
id|ca0106_t
op_star
id|emu
op_assign
id|entry-&gt;private_data
suffix:semicolon
r_int
r_int
id|value
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
id|i
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Registers:&bslash;n&bslash;n&quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|0x20
suffix:semicolon
id|i
op_add_assign
l_int|2
)paren
(brace
id|spin_lock_irqsave
c_func
(paren
op_amp
id|emu-&gt;emu_lock
comma
id|flags
)paren
suffix:semicolon
id|value
op_assign
id|inw
c_func
(paren
id|emu-&gt;port
op_plus
id|i
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|emu-&gt;emu_lock
comma
id|flags
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Register %02X: %04X&bslash;n&quot;
comma
id|i
comma
id|value
)paren
suffix:semicolon
)brace
)brace
DECL|function|snd_ca0106_proc_reg_read8
r_static
r_void
id|snd_ca0106_proc_reg_read8
c_func
(paren
id|snd_info_entry_t
op_star
id|entry
comma
id|snd_info_buffer_t
op_star
id|buffer
)paren
(brace
id|ca0106_t
op_star
id|emu
op_assign
id|entry-&gt;private_data
suffix:semicolon
r_int
r_int
id|value
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
id|i
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Registers:&bslash;n&bslash;n&quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|0x20
suffix:semicolon
id|i
op_add_assign
l_int|1
)paren
(brace
id|spin_lock_irqsave
c_func
(paren
op_amp
id|emu-&gt;emu_lock
comma
id|flags
)paren
suffix:semicolon
id|value
op_assign
id|inb
c_func
(paren
id|emu-&gt;port
op_plus
id|i
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|emu-&gt;emu_lock
comma
id|flags
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Register %02X: %02X&bslash;n&quot;
comma
id|i
comma
id|value
)paren
suffix:semicolon
)brace
)brace
DECL|function|snd_ca0106_proc_reg_read1
r_static
r_void
id|snd_ca0106_proc_reg_read1
c_func
(paren
id|snd_info_entry_t
op_star
id|entry
comma
id|snd_info_buffer_t
op_star
id|buffer
)paren
(brace
id|ca0106_t
op_star
id|emu
op_assign
id|entry-&gt;private_data
suffix:semicolon
r_int
r_int
id|value
suffix:semicolon
r_int
id|i
comma
id|j
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Registers&bslash;n&quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|0x40
suffix:semicolon
id|i
op_increment
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;%02X: &quot;
comma
id|i
)paren
suffix:semicolon
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
l_int|4
suffix:semicolon
id|j
op_increment
)paren
(brace
id|value
op_assign
id|snd_ca0106_ptr_read
c_func
(paren
id|emu
comma
id|i
comma
id|j
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;%08lX &quot;
comma
id|value
)paren
suffix:semicolon
)brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
)brace
)brace
DECL|function|snd_ca0106_proc_reg_read2
r_static
r_void
id|snd_ca0106_proc_reg_read2
c_func
(paren
id|snd_info_entry_t
op_star
id|entry
comma
id|snd_info_buffer_t
op_star
id|buffer
)paren
(brace
id|ca0106_t
op_star
id|emu
op_assign
id|entry-&gt;private_data
suffix:semicolon
r_int
r_int
id|value
suffix:semicolon
r_int
id|i
comma
id|j
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Registers&bslash;n&quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0x40
suffix:semicolon
id|i
OL
l_int|0x80
suffix:semicolon
id|i
op_increment
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;%02X: &quot;
comma
id|i
)paren
suffix:semicolon
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
l_int|4
suffix:semicolon
id|j
op_increment
)paren
(brace
id|value
op_assign
id|snd_ca0106_ptr_read
c_func
(paren
id|emu
comma
id|i
comma
id|j
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;%08lX &quot;
comma
id|value
)paren
suffix:semicolon
)brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
)brace
)brace
DECL|function|snd_ca0106_proc_reg_write
r_static
r_void
id|snd_ca0106_proc_reg_write
c_func
(paren
id|snd_info_entry_t
op_star
id|entry
comma
id|snd_info_buffer_t
op_star
id|buffer
)paren
(brace
id|ca0106_t
op_star
id|emu
op_assign
id|entry-&gt;private_data
suffix:semicolon
r_char
id|line
(braket
l_int|64
)braket
suffix:semicolon
r_int
r_int
id|reg
comma
id|channel_id
comma
id|val
suffix:semicolon
r_while
c_loop
(paren
op_logical_neg
id|snd_info_get_line
c_func
(paren
id|buffer
comma
id|line
comma
r_sizeof
(paren
id|line
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
id|sscanf
c_func
(paren
id|line
comma
l_string|&quot;%x %x %x&quot;
comma
op_amp
id|reg
comma
op_amp
id|channel_id
comma
op_amp
id|val
)paren
op_ne
l_int|3
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
(paren
id|reg
OL
l_int|0x80
)paren
op_logical_and
(paren
id|reg
op_ge
l_int|0
)paren
op_logical_and
(paren
id|val
op_le
l_int|0xffffffff
)paren
op_logical_and
(paren
id|channel_id
op_ge
l_int|0
)paren
op_logical_and
(paren
id|channel_id
op_le
l_int|3
)paren
)paren
id|snd_ca0106_ptr_write
c_func
(paren
id|emu
comma
id|reg
comma
id|channel_id
comma
id|val
)paren
suffix:semicolon
)brace
)brace
DECL|function|snd_ca0106_proc_init
r_int
id|__devinit
id|snd_ca0106_proc_init
c_func
(paren
id|ca0106_t
op_star
id|emu
)paren
(brace
id|snd_info_entry_t
op_star
id|entry
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snd_card_proc_new
c_func
(paren
id|emu-&gt;card
comma
l_string|&quot;iec958&quot;
comma
op_amp
id|entry
)paren
)paren
(brace
id|snd_info_set_text_ops
c_func
(paren
id|entry
comma
id|emu
comma
l_int|1024
comma
id|snd_ca0106_proc_iec958
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|snd_card_proc_new
c_func
(paren
id|emu-&gt;card
comma
l_string|&quot;ca0106_reg32&quot;
comma
op_amp
id|entry
)paren
)paren
(brace
id|snd_info_set_text_ops
c_func
(paren
id|entry
comma
id|emu
comma
l_int|1024
comma
id|snd_ca0106_proc_reg_read32
)paren
suffix:semicolon
id|entry-&gt;c.text.write_size
op_assign
l_int|64
suffix:semicolon
id|entry-&gt;c.text.write
op_assign
id|snd_ca0106_proc_reg_write32
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|snd_card_proc_new
c_func
(paren
id|emu-&gt;card
comma
l_string|&quot;ca0106_reg16&quot;
comma
op_amp
id|entry
)paren
)paren
(brace
id|snd_info_set_text_ops
c_func
(paren
id|entry
comma
id|emu
comma
l_int|1024
comma
id|snd_ca0106_proc_reg_read16
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|snd_card_proc_new
c_func
(paren
id|emu-&gt;card
comma
l_string|&quot;ca0106_reg8&quot;
comma
op_amp
id|entry
)paren
)paren
(brace
id|snd_info_set_text_ops
c_func
(paren
id|entry
comma
id|emu
comma
l_int|1024
comma
id|snd_ca0106_proc_reg_read8
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|snd_card_proc_new
c_func
(paren
id|emu-&gt;card
comma
l_string|&quot;ca0106_regs1&quot;
comma
op_amp
id|entry
)paren
)paren
(brace
id|snd_info_set_text_ops
c_func
(paren
id|entry
comma
id|emu
comma
l_int|1024
comma
id|snd_ca0106_proc_reg_read1
)paren
suffix:semicolon
id|entry-&gt;c.text.write_size
op_assign
l_int|64
suffix:semicolon
id|entry-&gt;c.text.write
op_assign
id|snd_ca0106_proc_reg_write
suffix:semicolon
singleline_comment|//&t;&t;entry-&gt;private_data = emu;
)brace
r_if
c_cond
(paren
op_logical_neg
id|snd_card_proc_new
c_func
(paren
id|emu-&gt;card
comma
l_string|&quot;ca0106_regs2&quot;
comma
op_amp
id|entry
)paren
)paren
(brace
id|snd_info_set_text_ops
c_func
(paren
id|entry
comma
id|emu
comma
l_int|1024
comma
id|snd_ca0106_proc_reg_read2
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
eof
