multiline_comment|/*&n; *  Copyright (c) by James Courtier-Dutton &lt;James@superbug.demon.co.uk&gt;&n; *  Driver p16v chips&n; *  Version: 0.22&n; *&n; *  FEATURES currently supported:&n; *    Output fixed at S32_LE, 2 channel to hw:0,0&n; *    Rates: 44.1, 48, 96, 192.&n; *&n; *  Changelog:&n; *  0.8&n; *    Use separate card based buffer for periods table.&n; *  0.9&n; *    Use 2 channel output streams instead of 8 channel.&n; *       (8 channel output streams might be good for ASIO type output)&n; *    Corrected speaker output, so Front -&gt; Front etc.&n; *  0.10&n; *    Fixed missed interrupts.&n; *  0.11&n; *    Add Sound card model number and names.&n; *    Add Analog volume controls.&n; *  0.12&n; *    Corrected playback interrupts. Now interrupt per period, instead of half period.&n; *  0.13&n; *    Use single trigger for multichannel.&n; *  0.14&n; *    Mic capture now works at fixed: S32_LE, 96000Hz, Stereo.&n; *  0.15&n; *    Force buffer_size / period_size == INTEGER.&n; *  0.16&n; *    Update p16v.c to work with changed alsa api.&n; *  0.17&n; *    Update p16v.c to work with changed alsa api. Removed boot_devs.&n; *  0.18&n; *    Merging with snd-emu10k1 driver.&n; *  0.19&n; *    One stereo channel at 24bit now works.&n; *  0.20&n; *    Added better register defines.&n; *  0.21&n; *    Integrated with snd-emu10k1 driver.&n; *  0.22&n; *    Removed #if 0 ... #endif&n; *&n; *&n; *  BUGS:&n; *    Some stability problems when unloading the snd-p16v kernel module.&n; *    --&n; *&n; *  TODO:&n; *    SPDIF out.&n; *    Find out how to change capture sample rates. E.g. To record SPDIF at 48000Hz.&n; *    Currently capture fixed at 48000Hz.&n; *&n; *    --&n; *  GENERAL INFO:&n; *    Model: SB0240&n; *    P16V Chip: CA0151-DBS&n; *    Audigy 2 Chip: CA0102-IAT&n; *    AC97 Codec: STAC 9721&n; *    ADC: Philips 1361T (Stereo 24bit)&n; *    DAC: CS4382-K (8-channel, 24bit, 192Khz)&n; *&n; *  This code was initally based on code from ALSA&squot;s emu10k1x.c which is:&n; *  Copyright (c) by Francisco Moraes &lt;fmoraes@nc.rr.com&gt;&n; *&n; *   This program is free software; you can redistribute it and/or modify&n; *   it under the terms of the GNU General Public License as published by&n; *   the Free Software Foundation; either version 2 of the License, or&n; *   (at your option) any later version.&n; *&n; *   This program is distributed in the hope that it will be useful,&n; *   but WITHOUT ANY WARRANTY; without even the implied warranty of&n; *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; *   GNU General Public License for more details.&n; *&n; *   You should have received a copy of the GNU General Public License&n; *   along with this program; if not, write to the Free Software&n; *   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA&n; *&n; */
macro_line|#include &lt;sound/driver.h&gt;
macro_line|#include &lt;linux/delay.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/interrupt.h&gt;
macro_line|#include &lt;linux/pci.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;linux/moduleparam.h&gt;
macro_line|#include &lt;sound/core.h&gt;
macro_line|#include &lt;sound/initval.h&gt;
macro_line|#include &lt;sound/pcm.h&gt;
macro_line|#include &lt;sound/ac97_codec.h&gt;
macro_line|#include &lt;sound/info.h&gt;
macro_line|#include &lt;sound/emu10k1.h&gt;
macro_line|#include &quot;p16v.h&quot;
DECL|macro|SET_CHANNEL
mdefine_line|#define SET_CHANNEL 0  /* Testing channel outputs 0=Front, 1=Center/LFE, 2=Unknown, 3=Rear */
DECL|macro|PCM_FRONT_CHANNEL
mdefine_line|#define PCM_FRONT_CHANNEL 0
DECL|macro|PCM_REAR_CHANNEL
mdefine_line|#define PCM_REAR_CHANNEL 1
DECL|macro|PCM_CENTER_LFE_CHANNEL
mdefine_line|#define PCM_CENTER_LFE_CHANNEL 2
DECL|macro|PCM_UNKNOWN_CHANNEL
mdefine_line|#define PCM_UNKNOWN_CHANNEL 3
DECL|macro|CONTROL_FRONT_CHANNEL
mdefine_line|#define CONTROL_FRONT_CHANNEL 0
DECL|macro|CONTROL_REAR_CHANNEL
mdefine_line|#define CONTROL_REAR_CHANNEL 3
DECL|macro|CONTROL_CENTER_LFE_CHANNEL
mdefine_line|#define CONTROL_CENTER_LFE_CHANNEL 1
DECL|macro|CONTROL_UNKNOWN_CHANNEL
mdefine_line|#define CONTROL_UNKNOWN_CHANNEL 2
multiline_comment|/* Card IDs:&n; * Class 0401: 1102:0004 (rev 04) Subsystem: 1102:2002 -&gt; Audigy2 ZS 7.1 Model:SB0350&n; * Class 0401: 1102:0004 (rev 04) Subsystem: 1102:1007 -&gt; Audigy2 6.1    Model:SB0240&n; * Class 0401: 1102:0004 (rev 04) Subsystem: 1102:1002 -&gt; Audigy2 Platinum  Model:SB msb0240230009266&n; * Class 0401: 1102:0004 (rev 04) Subsystem: 1102:2007 -&gt; Audigy4 Pro Model:SB0380 M1SB0380472001901E&n; *&n; */
multiline_comment|/* hardware definition */
DECL|variable|snd_p16v_playback_hw
r_static
id|snd_pcm_hardware_t
id|snd_p16v_playback_hw
op_assign
(brace
dot
id|info
op_assign
(paren
id|SNDRV_PCM_INFO_MMAP
op_or
id|SNDRV_PCM_INFO_INTERLEAVED
op_or
id|SNDRV_PCM_INFO_BLOCK_TRANSFER
op_or
id|SNDRV_PCM_INFO_MMAP_VALID
)paren
comma
dot
id|formats
op_assign
id|SNDRV_PCM_FMTBIT_S32_LE
comma
multiline_comment|/* Only supports 24-bit samples padded to 32 bits. */
dot
id|rates
op_assign
id|SNDRV_PCM_RATE_192000
op_or
id|SNDRV_PCM_RATE_96000
op_or
id|SNDRV_PCM_RATE_48000
comma
dot
id|rate_min
op_assign
l_int|48000
comma
dot
id|rate_max
op_assign
l_int|192000
comma
dot
id|channels_min
op_assign
l_int|8
comma
dot
id|channels_max
op_assign
l_int|8
comma
dot
id|buffer_bytes_max
op_assign
(paren
l_int|32
op_star
l_int|1024
)paren
comma
dot
id|period_bytes_min
op_assign
l_int|64
comma
dot
id|period_bytes_max
op_assign
(paren
l_int|16
op_star
l_int|1024
)paren
comma
dot
id|periods_min
op_assign
l_int|2
comma
dot
id|periods_max
op_assign
l_int|8
comma
dot
id|fifo_size
op_assign
l_int|0
comma
)brace
suffix:semicolon
DECL|function|snd_p16v_pcm_free_substream
r_static
r_void
id|snd_p16v_pcm_free_substream
c_func
(paren
id|snd_pcm_runtime_t
op_star
id|runtime
)paren
(brace
id|snd_pcm_t
op_star
id|epcm
op_assign
id|runtime-&gt;private_data
suffix:semicolon
r_if
c_cond
(paren
id|epcm
)paren
(brace
singleline_comment|//snd_printk(&quot;epcm free: %p&bslash;n&quot;, epcm);
id|kfree
c_func
(paren
id|epcm
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/* open_playback callback */
DECL|function|snd_p16v_pcm_open_playback_channel
r_static
r_int
id|snd_p16v_pcm_open_playback_channel
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|channel_id
)paren
(brace
id|emu10k1_t
op_star
id|emu
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|emu10k1_voice_t
op_star
id|channel
op_assign
op_amp
(paren
id|emu-&gt;p16v_voices
(braket
id|channel_id
)braket
)paren
suffix:semicolon
id|emu10k1_pcm_t
op_star
id|epcm
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_int
id|err
suffix:semicolon
id|epcm
op_assign
id|kcalloc
c_func
(paren
l_int|1
comma
r_sizeof
(paren
op_star
id|epcm
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
singleline_comment|//snd_printk(&quot;epcm kcalloc: %p&bslash;n&quot;, epcm);
r_if
c_cond
(paren
id|epcm
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|epcm-&gt;emu
op_assign
id|emu
suffix:semicolon
id|epcm-&gt;substream
op_assign
id|substream
suffix:semicolon
singleline_comment|//snd_printk(&quot;epcm device=%d, channel_id=%d&bslash;n&quot;, substream-&gt;pcm-&gt;device, channel_id);
id|runtime-&gt;private_data
op_assign
id|epcm
suffix:semicolon
id|runtime-&gt;private_free
op_assign
id|snd_p16v_pcm_free_substream
suffix:semicolon
id|runtime-&gt;hw
op_assign
id|snd_p16v_playback_hw
suffix:semicolon
id|channel-&gt;emu
op_assign
id|emu
suffix:semicolon
id|channel-&gt;number
op_assign
id|channel_id
suffix:semicolon
id|channel-&gt;use
op_assign
l_int|1
suffix:semicolon
singleline_comment|//snd_printk(&quot;p16v: open channel_id=%d, channel=%p, use=0x%x&bslash;n&quot;, channel_id, channel, channel-&gt;use);
singleline_comment|//printk(&quot;open:channel_id=%d, chip=%p, channel=%p&bslash;n&quot;,channel_id, chip, channel);
singleline_comment|//channel-&gt;interrupt = snd_p16v_pcm_channel_interrupt;
id|channel-&gt;epcm
op_assign
id|epcm
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_pcm_hw_constraint_integer
c_func
(paren
id|runtime
comma
id|SNDRV_PCM_HW_PARAM_PERIODS
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* close callback */
DECL|function|snd_p16v_pcm_close_playback
r_static
r_int
id|snd_p16v_pcm_close_playback
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|emu10k1_t
op_star
id|emu
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
singleline_comment|//snd_pcm_runtime_t *runtime = substream-&gt;runtime;
singleline_comment|//emu10k1_pcm_t *epcm = runtime-&gt;private_data;
id|emu-&gt;p16v_voices
(braket
id|substream-&gt;pcm-&gt;device
op_minus
id|emu-&gt;p16v_device_offset
)braket
dot
id|use
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* FIXME: maybe zero others */
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_p16v_pcm_open_playback_front
r_static
r_int
id|snd_p16v_pcm_open_playback_front
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
r_return
id|snd_p16v_pcm_open_playback_channel
c_func
(paren
id|substream
comma
id|PCM_FRONT_CHANNEL
)paren
suffix:semicolon
)brace
multiline_comment|/* hw_params callback */
DECL|function|snd_p16v_pcm_hw_params_playback
r_static
r_int
id|snd_p16v_pcm_hw_params_playback
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_hw_params_t
op_star
id|hw_params
)paren
(brace
r_int
id|result
suffix:semicolon
singleline_comment|//snd_printk(&quot;hw_params alloc: substream=%p&bslash;n&quot;, substream);
id|result
op_assign
id|snd_pcm_lib_malloc_pages
c_func
(paren
id|substream
comma
id|params_buffer_bytes
c_func
(paren
id|hw_params
)paren
)paren
suffix:semicolon
singleline_comment|//snd_printk(&quot;hw_params alloc: result=%d&bslash;n&quot;, result);
singleline_comment|//dump_stack();
r_return
id|result
suffix:semicolon
)brace
multiline_comment|/* hw_free callback */
DECL|function|snd_p16v_pcm_hw_free_playback
r_static
r_int
id|snd_p16v_pcm_hw_free_playback
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
r_int
id|result
suffix:semicolon
singleline_comment|//snd_printk(&quot;hw_params free: substream=%p&bslash;n&quot;, substream);
id|result
op_assign
id|snd_pcm_lib_free_pages
c_func
(paren
id|substream
)paren
suffix:semicolon
singleline_comment|//snd_printk(&quot;hw_params free: result=%d&bslash;n&quot;, result);
singleline_comment|//dump_stack();
r_return
id|result
suffix:semicolon
)brace
multiline_comment|/* prepare playback callback */
DECL|function|snd_p16v_pcm_prepare_playback
r_static
r_int
id|snd_p16v_pcm_prepare_playback
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|emu10k1_t
op_star
id|emu
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
singleline_comment|//emu10k1_pcm_t *epcm = runtime-&gt;private_data;
r_int
id|channel
op_assign
id|substream-&gt;pcm-&gt;device
op_minus
id|emu-&gt;p16v_device_offset
suffix:semicolon
id|u32
op_star
id|table_base
op_assign
(paren
id|u32
op_star
)paren
(paren
id|emu-&gt;p16v_buffer.area
op_plus
(paren
l_int|8
op_star
l_int|16
op_star
id|channel
)paren
)paren
suffix:semicolon
id|u32
id|period_size_bytes
op_assign
id|frames_to_bytes
c_func
(paren
id|runtime
comma
id|runtime-&gt;period_size
)paren
suffix:semicolon
r_int
id|i
suffix:semicolon
id|u32
id|tmp
suffix:semicolon
singleline_comment|//snd_printk(&quot;prepare:channel_number=%d, rate=%d, format=0x%x, channels=%d, buffer_size=%ld, period_size=%ld, periods=%u, frames_to_bytes=%d&bslash;n&quot;,channel, runtime-&gt;rate, runtime-&gt;format, runtime-&gt;channels, runtime-&gt;buffer_size, runtime-&gt;period_size, runtime-&gt;periods, frames_to_bytes(runtime, 1));
singleline_comment|//snd_printk(&quot;dma_addr=%x, dma_area=%p, table_base=%p&bslash;n&quot;,runtime-&gt;dma_addr, runtime-&gt;dma_area, table_base);
singleline_comment|//snd_printk(&quot;dma_addr=%x, dma_area=%p, dma_bytes(size)=%x&bslash;n&quot;,emu-&gt;p16v_buffer.addr, emu-&gt;p16v_buffer.area, emu-&gt;p16v_buffer.bytes);
id|tmp
op_assign
id|snd_emu10k1_ptr_read
c_func
(paren
id|emu
comma
id|A_SPDIF_SAMPLERATE
comma
id|channel
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|runtime-&gt;rate
)paren
(brace
r_case
l_int|44100
suffix:colon
id|snd_emu10k1_ptr_write
c_func
(paren
id|emu
comma
id|A_SPDIF_SAMPLERATE
comma
id|channel
comma
(paren
id|tmp
op_amp
op_complement
l_int|0xe000
)paren
op_or
l_int|0x8000
)paren
suffix:semicolon
multiline_comment|/* FIXME: This will change the capture rate as well! */
r_break
suffix:semicolon
r_case
l_int|48000
suffix:colon
id|snd_emu10k1_ptr_write
c_func
(paren
id|emu
comma
id|A_SPDIF_SAMPLERATE
comma
id|channel
comma
(paren
id|tmp
op_amp
op_complement
l_int|0xe000
)paren
op_or
l_int|0x0000
)paren
suffix:semicolon
multiline_comment|/* FIXME: This will change the capture rate as well! */
r_break
suffix:semicolon
r_case
l_int|96000
suffix:colon
id|snd_emu10k1_ptr_write
c_func
(paren
id|emu
comma
id|A_SPDIF_SAMPLERATE
comma
id|channel
comma
(paren
id|tmp
op_amp
op_complement
l_int|0xe000
)paren
op_or
l_int|0x4000
)paren
suffix:semicolon
multiline_comment|/* FIXME: This will change the capture rate as well! */
r_break
suffix:semicolon
r_case
l_int|192000
suffix:colon
id|snd_emu10k1_ptr_write
c_func
(paren
id|emu
comma
id|A_SPDIF_SAMPLERATE
comma
id|channel
comma
(paren
id|tmp
op_amp
op_complement
l_int|0xe000
)paren
op_or
l_int|0x2000
)paren
suffix:semicolon
multiline_comment|/* FIXME: This will change the capture rate as well! */
r_break
suffix:semicolon
r_default
suffix:colon
id|snd_emu10k1_ptr_write
c_func
(paren
id|emu
comma
id|A_SPDIF_SAMPLERATE
comma
id|channel
comma
l_int|0x0000
)paren
suffix:semicolon
multiline_comment|/* FIXME: This will change the capture rate as well! */
r_break
suffix:semicolon
)brace
multiline_comment|/* FIXME: Check emu-&gt;buffer.size before actually writing to it. */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|runtime-&gt;periods
suffix:semicolon
id|i
op_increment
)paren
(brace
id|table_base
(braket
id|i
op_star
l_int|2
)braket
op_assign
id|runtime-&gt;dma_addr
op_plus
(paren
id|i
op_star
id|period_size_bytes
)paren
suffix:semicolon
id|table_base
(braket
(paren
id|i
op_star
l_int|2
)paren
op_plus
l_int|1
)braket
op_assign
id|period_size_bytes
op_lshift
l_int|16
suffix:semicolon
)brace
id|snd_emu10k1_ptr20_write
c_func
(paren
id|emu
comma
id|PLAYBACK_LIST_ADDR
comma
id|channel
comma
id|emu-&gt;p16v_buffer.addr
op_plus
(paren
l_int|8
op_star
l_int|16
op_star
id|channel
)paren
)paren
suffix:semicolon
id|snd_emu10k1_ptr20_write
c_func
(paren
id|emu
comma
id|PLAYBACK_LIST_SIZE
comma
id|channel
comma
(paren
id|runtime-&gt;periods
op_minus
l_int|1
)paren
op_lshift
l_int|19
)paren
suffix:semicolon
id|snd_emu10k1_ptr20_write
c_func
(paren
id|emu
comma
id|PLAYBACK_LIST_PTR
comma
id|channel
comma
l_int|0
)paren
suffix:semicolon
id|snd_emu10k1_ptr20_write
c_func
(paren
id|emu
comma
id|PLAYBACK_DMA_ADDR
comma
id|channel
comma
id|runtime-&gt;dma_addr
)paren
suffix:semicolon
id|snd_emu10k1_ptr20_write
c_func
(paren
id|emu
comma
id|PLAYBACK_PERIOD_SIZE
comma
id|channel
comma
id|frames_to_bytes
c_func
(paren
id|runtime
comma
id|runtime-&gt;period_size
)paren
op_lshift
l_int|16
)paren
suffix:semicolon
singleline_comment|// buffer size in bytes
id|snd_emu10k1_ptr20_write
c_func
(paren
id|emu
comma
id|PLAYBACK_POINTER
comma
id|channel
comma
l_int|0
)paren
suffix:semicolon
id|snd_emu10k1_ptr20_write
c_func
(paren
id|emu
comma
l_int|0x07
comma
id|channel
comma
l_int|0x0
)paren
suffix:semicolon
id|snd_emu10k1_ptr20_write
c_func
(paren
id|emu
comma
l_int|0x08
comma
id|channel
comma
l_int|0
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_p16v_intr_enable
r_static
r_void
id|snd_p16v_intr_enable
c_func
(paren
id|emu10k1_t
op_star
id|emu
comma
r_int
r_int
id|intrenb
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
r_int
r_int
id|enable
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|emu-&gt;emu_lock
comma
id|flags
)paren
suffix:semicolon
id|enable
op_assign
id|inl
c_func
(paren
id|emu-&gt;port
op_plus
id|INTE2
)paren
op_or
id|intrenb
suffix:semicolon
id|outl
c_func
(paren
id|enable
comma
id|emu-&gt;port
op_plus
id|INTE2
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|emu-&gt;emu_lock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|snd_p16v_intr_disable
r_static
r_void
id|snd_p16v_intr_disable
c_func
(paren
id|emu10k1_t
op_star
id|emu
comma
r_int
r_int
id|intrenb
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
r_int
r_int
id|disable
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|emu-&gt;emu_lock
comma
id|flags
)paren
suffix:semicolon
id|disable
op_assign
id|inl
c_func
(paren
id|emu-&gt;port
op_plus
id|INTE2
)paren
op_amp
(paren
op_complement
id|intrenb
)paren
suffix:semicolon
id|outl
c_func
(paren
id|disable
comma
id|emu-&gt;port
op_plus
id|INTE2
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|emu-&gt;emu_lock
comma
id|flags
)paren
suffix:semicolon
)brace
multiline_comment|/* trigger_playback callback */
DECL|function|snd_p16v_pcm_trigger_playback
r_static
r_int
id|snd_p16v_pcm_trigger_playback
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|cmd
)paren
(brace
id|emu10k1_t
op_star
id|emu
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
id|emu10k1_pcm_t
op_star
id|epcm
suffix:semicolon
r_int
id|channel
suffix:semicolon
r_int
id|result
op_assign
l_int|0
suffix:semicolon
r_struct
id|list_head
op_star
id|pos
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|s
suffix:semicolon
id|u32
id|basic
op_assign
l_int|0
suffix:semicolon
id|u32
id|inte
op_assign
l_int|0
suffix:semicolon
r_int
id|running
op_assign
l_int|0
suffix:semicolon
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|SNDRV_PCM_TRIGGER_START
suffix:colon
id|running
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_TRIGGER_STOP
suffix:colon
r_default
suffix:colon
id|running
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
)brace
id|snd_pcm_group_for_each
c_func
(paren
id|pos
comma
id|substream
)paren
(brace
id|s
op_assign
id|snd_pcm_group_substream_entry
c_func
(paren
id|pos
)paren
suffix:semicolon
id|runtime
op_assign
id|s-&gt;runtime
suffix:semicolon
id|epcm
op_assign
id|runtime-&gt;private_data
suffix:semicolon
id|channel
op_assign
id|substream-&gt;pcm-&gt;device
op_minus
id|emu-&gt;p16v_device_offset
suffix:semicolon
singleline_comment|//snd_printk(&quot;p16v channel=%d&bslash;n&quot;,channel);
id|epcm-&gt;running
op_assign
id|running
suffix:semicolon
id|basic
op_or_assign
(paren
l_int|0x1
op_lshift
id|channel
)paren
suffix:semicolon
id|inte
op_or_assign
(paren
id|INTE2_PLAYBACK_CH_0_LOOP
op_lshift
id|channel
)paren
suffix:semicolon
id|snd_pcm_trigger_done
c_func
(paren
id|s
comma
id|substream
)paren
suffix:semicolon
)brace
singleline_comment|//snd_printk(&quot;basic=0x%x, inte=0x%x&bslash;n&quot;,basic, inte);
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|SNDRV_PCM_TRIGGER_START
suffix:colon
id|snd_p16v_intr_enable
c_func
(paren
id|emu
comma
id|inte
)paren
suffix:semicolon
id|snd_emu10k1_ptr20_write
c_func
(paren
id|emu
comma
id|BASIC_INTERRUPT
comma
l_int|0
comma
id|snd_emu10k1_ptr20_read
c_func
(paren
id|emu
comma
id|BASIC_INTERRUPT
comma
l_int|0
)paren
op_or
(paren
id|basic
)paren
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_TRIGGER_STOP
suffix:colon
id|snd_emu10k1_ptr20_write
c_func
(paren
id|emu
comma
id|BASIC_INTERRUPT
comma
l_int|0
comma
id|snd_emu10k1_ptr20_read
c_func
(paren
id|emu
comma
id|BASIC_INTERRUPT
comma
l_int|0
)paren
op_amp
op_complement
(paren
id|basic
)paren
)paren
suffix:semicolon
id|snd_p16v_intr_disable
c_func
(paren
id|emu
comma
id|inte
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|result
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_break
suffix:semicolon
)brace
r_return
id|result
suffix:semicolon
)brace
multiline_comment|/* pointer_playback callback */
r_static
id|snd_pcm_uframes_t
DECL|function|snd_p16v_pcm_pointer_playback
id|snd_p16v_pcm_pointer_playback
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|emu10k1_t
op_star
id|emu
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|emu10k1_pcm_t
op_star
id|epcm
op_assign
id|runtime-&gt;private_data
suffix:semicolon
id|snd_pcm_uframes_t
id|ptr
comma
id|ptr1
comma
id|ptr2
comma
id|ptr3
comma
id|ptr4
op_assign
l_int|0
suffix:semicolon
r_int
id|channel
op_assign
id|substream-&gt;pcm-&gt;device
op_minus
id|emu-&gt;p16v_device_offset
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|epcm-&gt;running
)paren
r_return
l_int|0
suffix:semicolon
id|ptr3
op_assign
id|snd_emu10k1_ptr20_read
c_func
(paren
id|emu
comma
id|PLAYBACK_LIST_PTR
comma
id|channel
)paren
suffix:semicolon
id|ptr1
op_assign
id|snd_emu10k1_ptr20_read
c_func
(paren
id|emu
comma
id|PLAYBACK_POINTER
comma
id|channel
)paren
suffix:semicolon
id|ptr4
op_assign
id|snd_emu10k1_ptr20_read
c_func
(paren
id|emu
comma
id|PLAYBACK_LIST_PTR
comma
id|channel
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ptr3
op_ne
id|ptr4
)paren
id|ptr1
op_assign
id|snd_emu10k1_ptr20_read
c_func
(paren
id|emu
comma
id|PLAYBACK_POINTER
comma
id|channel
)paren
suffix:semicolon
id|ptr2
op_assign
id|bytes_to_frames
c_func
(paren
id|runtime
comma
id|ptr1
)paren
suffix:semicolon
id|ptr2
op_add_assign
(paren
id|ptr4
op_rshift
l_int|3
)paren
op_star
id|runtime-&gt;period_size
suffix:semicolon
id|ptr
op_assign
id|ptr2
suffix:semicolon
r_if
c_cond
(paren
id|ptr
op_ge
id|runtime-&gt;buffer_size
)paren
id|ptr
op_sub_assign
id|runtime-&gt;buffer_size
suffix:semicolon
r_return
id|ptr
suffix:semicolon
)brace
multiline_comment|/* operators */
DECL|variable|snd_p16v_playback_front_ops
r_static
id|snd_pcm_ops_t
id|snd_p16v_playback_front_ops
op_assign
(brace
dot
id|open
op_assign
id|snd_p16v_pcm_open_playback_front
comma
dot
id|close
op_assign
id|snd_p16v_pcm_close_playback
comma
dot
id|ioctl
op_assign
id|snd_pcm_lib_ioctl
comma
dot
id|hw_params
op_assign
id|snd_p16v_pcm_hw_params_playback
comma
dot
id|hw_free
op_assign
id|snd_p16v_pcm_hw_free_playback
comma
dot
id|prepare
op_assign
id|snd_p16v_pcm_prepare_playback
comma
dot
id|trigger
op_assign
id|snd_p16v_pcm_trigger_playback
comma
dot
id|pointer
op_assign
id|snd_p16v_pcm_pointer_playback
comma
)brace
suffix:semicolon
DECL|function|snd_p16v_free
r_int
id|snd_p16v_free
c_func
(paren
id|emu10k1_t
op_star
id|chip
)paren
(brace
singleline_comment|// release the data
r_if
c_cond
(paren
id|chip-&gt;p16v_buffer.area
)paren
(brace
id|snd_dma_free_pages
c_func
(paren
op_amp
id|chip-&gt;p16v_buffer
)paren
suffix:semicolon
singleline_comment|//snd_printk(&quot;period lables free: %p&bslash;n&quot;, &amp;chip-&gt;p16v_buffer);
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_p16v_pcm_free
r_static
r_void
id|snd_p16v_pcm_free
c_func
(paren
id|snd_pcm_t
op_star
id|pcm
)paren
(brace
id|emu10k1_t
op_star
id|emu
op_assign
id|pcm-&gt;private_data
suffix:semicolon
singleline_comment|//snd_printk(&quot;snd_p16v_pcm_free pcm: called&bslash;n&quot;);
id|snd_pcm_lib_preallocate_free_for_all
c_func
(paren
id|pcm
)paren
suffix:semicolon
id|emu-&gt;pcm
op_assign
l_int|NULL
suffix:semicolon
)brace
DECL|function|snd_p16v_pcm
r_int
id|snd_p16v_pcm
c_func
(paren
id|emu10k1_t
op_star
id|emu
comma
r_int
id|device
comma
id|snd_pcm_t
op_star
op_star
id|rpcm
)paren
(brace
id|snd_pcm_t
op_star
id|pcm
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
r_int
id|err
suffix:semicolon
r_int
id|capture
op_assign
l_int|0
suffix:semicolon
singleline_comment|//snd_printk(&quot;snd_p16v_pcm called. device=%d&bslash;n&quot;, device);
id|emu-&gt;p16v_device_offset
op_assign
id|device
suffix:semicolon
r_if
c_cond
(paren
id|rpcm
)paren
op_star
id|rpcm
op_assign
l_int|NULL
suffix:semicolon
singleline_comment|//if (device == 0) capture=1; 
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_pcm_new
c_func
(paren
id|emu-&gt;card
comma
l_string|&quot;p16v&quot;
comma
id|device
comma
l_int|1
comma
id|capture
comma
op_amp
id|pcm
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|pcm-&gt;private_data
op_assign
id|emu
suffix:semicolon
id|pcm-&gt;private_free
op_assign
id|snd_p16v_pcm_free
suffix:semicolon
id|snd_pcm_set_ops
c_func
(paren
id|pcm
comma
id|SNDRV_PCM_STREAM_PLAYBACK
comma
op_amp
id|snd_p16v_playback_front_ops
)paren
suffix:semicolon
id|pcm-&gt;info_flags
op_assign
l_int|0
suffix:semicolon
id|pcm-&gt;dev_subclass
op_assign
id|SNDRV_PCM_SUBCLASS_GENERIC_MIX
suffix:semicolon
id|strcpy
c_func
(paren
id|pcm-&gt;name
comma
l_string|&quot;p16v&quot;
)paren
suffix:semicolon
id|emu-&gt;pcm
op_assign
id|pcm
suffix:semicolon
r_for
c_loop
(paren
id|substream
op_assign
id|pcm-&gt;streams
(braket
id|SNDRV_PCM_STREAM_PLAYBACK
)braket
dot
id|substream
suffix:semicolon
id|substream
suffix:semicolon
id|substream
op_assign
id|substream-&gt;next
)paren
(brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_pcm_lib_preallocate_pages
c_func
(paren
id|substream
comma
id|SNDRV_DMA_TYPE_DEV
comma
id|snd_dma_pci_data
c_func
(paren
id|emu-&gt;pci
)paren
comma
l_int|64
op_star
l_int|1024
comma
l_int|64
op_star
l_int|1024
)paren
)paren
OL
l_int|0
)paren
multiline_comment|/* FIXME: 32*1024 for sound buffer, between 32and64 for Periods table. */
r_return
id|err
suffix:semicolon
singleline_comment|//snd_printk(&quot;preallocate playback substream: err=%d&bslash;n&quot;, err);
)brace
r_for
c_loop
(paren
id|substream
op_assign
id|pcm-&gt;streams
(braket
id|SNDRV_PCM_STREAM_CAPTURE
)braket
dot
id|substream
suffix:semicolon
id|substream
suffix:semicolon
id|substream
op_assign
id|substream-&gt;next
)paren
(brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_pcm_lib_preallocate_pages
c_func
(paren
id|substream
comma
id|SNDRV_DMA_TYPE_DEV
comma
id|snd_dma_pci_data
c_func
(paren
id|emu-&gt;pci
)paren
comma
l_int|64
op_star
l_int|1024
comma
l_int|64
op_star
l_int|1024
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
singleline_comment|//snd_printk(&quot;preallocate capture substream: err=%d&bslash;n&quot;, err);
)brace
r_if
c_cond
(paren
id|rpcm
)paren
op_star
id|rpcm
op_assign
id|pcm
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_p16v_volume_info
r_static
r_int
id|snd_p16v_volume_info
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_INTEGER
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|2
suffix:semicolon
id|uinfo-&gt;value.integer.min
op_assign
l_int|0
suffix:semicolon
id|uinfo-&gt;value.integer.max
op_assign
l_int|255
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_p16v_volume_get
r_static
r_int
id|snd_p16v_volume_get
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
comma
r_int
id|reg
comma
r_int
id|high_low
)paren
(brace
id|emu10k1_t
op_star
id|emu
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|u32
id|value
suffix:semicolon
id|value
op_assign
id|snd_emu10k1_ptr20_read
c_func
(paren
id|emu
comma
id|reg
comma
id|high_low
)paren
suffix:semicolon
r_if
c_cond
(paren
id|high_low
op_eq
l_int|1
)paren
(brace
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
l_int|0xff
op_minus
(paren
(paren
id|value
op_rshift
l_int|24
)paren
op_amp
l_int|0xff
)paren
suffix:semicolon
multiline_comment|/* Left */
id|ucontrol-&gt;value.integer.value
(braket
l_int|1
)braket
op_assign
l_int|0xff
op_minus
(paren
(paren
id|value
op_rshift
l_int|16
)paren
op_amp
l_int|0xff
)paren
suffix:semicolon
multiline_comment|/* Right */
)brace
r_else
(brace
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
l_int|0xff
op_minus
(paren
(paren
id|value
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
)paren
suffix:semicolon
multiline_comment|/* Left */
id|ucontrol-&gt;value.integer.value
(braket
l_int|1
)braket
op_assign
l_int|0xff
op_minus
(paren
(paren
id|value
op_rshift
l_int|0
)paren
op_amp
l_int|0xff
)paren
suffix:semicolon
multiline_comment|/* Right */
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_p16v_volume_get_spdif_front
r_static
r_int
id|snd_p16v_volume_get_spdif_front
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
r_int
id|high_low
op_assign
l_int|0
suffix:semicolon
r_int
id|reg
op_assign
id|PLAYBACK_VOLUME_MIXER7
suffix:semicolon
r_return
id|snd_p16v_volume_get
c_func
(paren
id|kcontrol
comma
id|ucontrol
comma
id|reg
comma
id|high_low
)paren
suffix:semicolon
)brace
DECL|function|snd_p16v_volume_get_spdif_center_lfe
r_static
r_int
id|snd_p16v_volume_get_spdif_center_lfe
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
r_int
id|high_low
op_assign
l_int|1
suffix:semicolon
r_int
id|reg
op_assign
id|PLAYBACK_VOLUME_MIXER7
suffix:semicolon
r_return
id|snd_p16v_volume_get
c_func
(paren
id|kcontrol
comma
id|ucontrol
comma
id|reg
comma
id|high_low
)paren
suffix:semicolon
)brace
DECL|function|snd_p16v_volume_get_spdif_unknown
r_static
r_int
id|snd_p16v_volume_get_spdif_unknown
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
r_int
id|high_low
op_assign
l_int|0
suffix:semicolon
r_int
id|reg
op_assign
id|PLAYBACK_VOLUME_MIXER8
suffix:semicolon
r_return
id|snd_p16v_volume_get
c_func
(paren
id|kcontrol
comma
id|ucontrol
comma
id|reg
comma
id|high_low
)paren
suffix:semicolon
)brace
DECL|function|snd_p16v_volume_get_spdif_rear
r_static
r_int
id|snd_p16v_volume_get_spdif_rear
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
r_int
id|high_low
op_assign
l_int|1
suffix:semicolon
r_int
id|reg
op_assign
id|PLAYBACK_VOLUME_MIXER8
suffix:semicolon
r_return
id|snd_p16v_volume_get
c_func
(paren
id|kcontrol
comma
id|ucontrol
comma
id|reg
comma
id|high_low
)paren
suffix:semicolon
)brace
DECL|function|snd_p16v_volume_get_analog_front
r_static
r_int
id|snd_p16v_volume_get_analog_front
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
r_int
id|high_low
op_assign
l_int|0
suffix:semicolon
r_int
id|reg
op_assign
id|PLAYBACK_VOLUME_MIXER9
suffix:semicolon
r_return
id|snd_p16v_volume_get
c_func
(paren
id|kcontrol
comma
id|ucontrol
comma
id|reg
comma
id|high_low
)paren
suffix:semicolon
)brace
DECL|function|snd_p16v_volume_get_analog_center_lfe
r_static
r_int
id|snd_p16v_volume_get_analog_center_lfe
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
r_int
id|high_low
op_assign
l_int|1
suffix:semicolon
r_int
id|reg
op_assign
id|PLAYBACK_VOLUME_MIXER9
suffix:semicolon
r_return
id|snd_p16v_volume_get
c_func
(paren
id|kcontrol
comma
id|ucontrol
comma
id|reg
comma
id|high_low
)paren
suffix:semicolon
)brace
DECL|function|snd_p16v_volume_get_analog_rear
r_static
r_int
id|snd_p16v_volume_get_analog_rear
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
r_int
id|high_low
op_assign
l_int|1
suffix:semicolon
r_int
id|reg
op_assign
id|PLAYBACK_VOLUME_MIXER10
suffix:semicolon
r_return
id|snd_p16v_volume_get
c_func
(paren
id|kcontrol
comma
id|ucontrol
comma
id|reg
comma
id|high_low
)paren
suffix:semicolon
)brace
DECL|function|snd_p16v_volume_get_analog_unknown
r_static
r_int
id|snd_p16v_volume_get_analog_unknown
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
r_int
id|high_low
op_assign
l_int|0
suffix:semicolon
r_int
id|reg
op_assign
id|PLAYBACK_VOLUME_MIXER10
suffix:semicolon
r_return
id|snd_p16v_volume_get
c_func
(paren
id|kcontrol
comma
id|ucontrol
comma
id|reg
comma
id|high_low
)paren
suffix:semicolon
)brace
DECL|function|snd_p16v_volume_put
r_static
r_int
id|snd_p16v_volume_put
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
comma
r_int
id|reg
comma
r_int
id|high_low
)paren
(brace
id|emu10k1_t
op_star
id|emu
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|u32
id|value
suffix:semicolon
id|value
op_assign
id|snd_emu10k1_ptr20_read
c_func
(paren
id|emu
comma
id|reg
comma
l_int|0
)paren
suffix:semicolon
singleline_comment|//value = value &amp; 0xffff;
r_if
c_cond
(paren
id|high_low
op_eq
l_int|1
)paren
(brace
id|value
op_and_assign
l_int|0xffff
suffix:semicolon
id|value
op_assign
id|value
op_or
(paren
(paren
l_int|0xff
op_minus
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
)paren
op_lshift
l_int|24
)paren
op_or
(paren
(paren
l_int|0xff
op_minus
id|ucontrol-&gt;value.integer.value
(braket
l_int|1
)braket
)paren
op_lshift
l_int|16
)paren
suffix:semicolon
)brace
r_else
(brace
id|value
op_and_assign
l_int|0xffff0000
suffix:semicolon
id|value
op_assign
id|value
op_or
(paren
(paren
l_int|0xff
op_minus
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
)paren
op_lshift
l_int|8
)paren
op_or
(paren
(paren
l_int|0xff
op_minus
id|ucontrol-&gt;value.integer.value
(braket
l_int|1
)braket
)paren
)paren
suffix:semicolon
)brace
id|snd_emu10k1_ptr20_write
c_func
(paren
id|emu
comma
id|reg
comma
l_int|0
comma
id|value
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|snd_p16v_volume_put_spdif_front
r_static
r_int
id|snd_p16v_volume_put_spdif_front
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
r_int
id|high_low
op_assign
l_int|0
suffix:semicolon
r_int
id|reg
op_assign
id|PLAYBACK_VOLUME_MIXER7
suffix:semicolon
r_return
id|snd_p16v_volume_put
c_func
(paren
id|kcontrol
comma
id|ucontrol
comma
id|reg
comma
id|high_low
)paren
suffix:semicolon
)brace
DECL|function|snd_p16v_volume_put_spdif_center_lfe
r_static
r_int
id|snd_p16v_volume_put_spdif_center_lfe
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
r_int
id|high_low
op_assign
l_int|1
suffix:semicolon
r_int
id|reg
op_assign
id|PLAYBACK_VOLUME_MIXER7
suffix:semicolon
r_return
id|snd_p16v_volume_put
c_func
(paren
id|kcontrol
comma
id|ucontrol
comma
id|reg
comma
id|high_low
)paren
suffix:semicolon
)brace
DECL|function|snd_p16v_volume_put_spdif_unknown
r_static
r_int
id|snd_p16v_volume_put_spdif_unknown
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
r_int
id|high_low
op_assign
l_int|0
suffix:semicolon
r_int
id|reg
op_assign
id|PLAYBACK_VOLUME_MIXER8
suffix:semicolon
r_return
id|snd_p16v_volume_put
c_func
(paren
id|kcontrol
comma
id|ucontrol
comma
id|reg
comma
id|high_low
)paren
suffix:semicolon
)brace
DECL|function|snd_p16v_volume_put_spdif_rear
r_static
r_int
id|snd_p16v_volume_put_spdif_rear
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
r_int
id|high_low
op_assign
l_int|1
suffix:semicolon
r_int
id|reg
op_assign
id|PLAYBACK_VOLUME_MIXER8
suffix:semicolon
r_return
id|snd_p16v_volume_put
c_func
(paren
id|kcontrol
comma
id|ucontrol
comma
id|reg
comma
id|high_low
)paren
suffix:semicolon
)brace
DECL|function|snd_p16v_volume_put_analog_front
r_static
r_int
id|snd_p16v_volume_put_analog_front
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
r_int
id|high_low
op_assign
l_int|0
suffix:semicolon
r_int
id|reg
op_assign
id|PLAYBACK_VOLUME_MIXER9
suffix:semicolon
r_return
id|snd_p16v_volume_put
c_func
(paren
id|kcontrol
comma
id|ucontrol
comma
id|reg
comma
id|high_low
)paren
suffix:semicolon
)brace
DECL|function|snd_p16v_volume_put_analog_center_lfe
r_static
r_int
id|snd_p16v_volume_put_analog_center_lfe
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
r_int
id|high_low
op_assign
l_int|1
suffix:semicolon
r_int
id|reg
op_assign
id|PLAYBACK_VOLUME_MIXER9
suffix:semicolon
r_return
id|snd_p16v_volume_put
c_func
(paren
id|kcontrol
comma
id|ucontrol
comma
id|reg
comma
id|high_low
)paren
suffix:semicolon
)brace
DECL|function|snd_p16v_volume_put_analog_rear
r_static
r_int
id|snd_p16v_volume_put_analog_rear
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
r_int
id|high_low
op_assign
l_int|1
suffix:semicolon
r_int
id|reg
op_assign
id|PLAYBACK_VOLUME_MIXER10
suffix:semicolon
r_return
id|snd_p16v_volume_put
c_func
(paren
id|kcontrol
comma
id|ucontrol
comma
id|reg
comma
id|high_low
)paren
suffix:semicolon
)brace
DECL|function|snd_p16v_volume_put_analog_unknown
r_static
r_int
id|snd_p16v_volume_put_analog_unknown
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
r_int
id|high_low
op_assign
l_int|0
suffix:semicolon
r_int
id|reg
op_assign
id|PLAYBACK_VOLUME_MIXER10
suffix:semicolon
r_return
id|snd_p16v_volume_put
c_func
(paren
id|kcontrol
comma
id|ucontrol
comma
id|reg
comma
id|high_low
)paren
suffix:semicolon
)brace
DECL|variable|snd_p16v_volume_control_analog_front
r_static
id|snd_kcontrol_new_t
id|snd_p16v_volume_control_analog_front
op_assign
(brace
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_MIXER
comma
dot
id|name
op_assign
l_string|&quot;HD Analog Front Volume&quot;
comma
dot
id|info
op_assign
id|snd_p16v_volume_info
comma
dot
id|get
op_assign
id|snd_p16v_volume_get_analog_front
comma
dot
id|put
op_assign
id|snd_p16v_volume_put_analog_front
)brace
suffix:semicolon
DECL|variable|snd_p16v_volume_control_analog_center_lfe
r_static
id|snd_kcontrol_new_t
id|snd_p16v_volume_control_analog_center_lfe
op_assign
(brace
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_MIXER
comma
dot
id|name
op_assign
l_string|&quot;HD Analog Center/LFE Volume&quot;
comma
dot
id|info
op_assign
id|snd_p16v_volume_info
comma
dot
id|get
op_assign
id|snd_p16v_volume_get_analog_center_lfe
comma
dot
id|put
op_assign
id|snd_p16v_volume_put_analog_center_lfe
)brace
suffix:semicolon
DECL|variable|snd_p16v_volume_control_analog_unknown
r_static
id|snd_kcontrol_new_t
id|snd_p16v_volume_control_analog_unknown
op_assign
(brace
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_MIXER
comma
dot
id|name
op_assign
l_string|&quot;HD Analog Unknown Volume&quot;
comma
dot
id|info
op_assign
id|snd_p16v_volume_info
comma
dot
id|get
op_assign
id|snd_p16v_volume_get_analog_unknown
comma
dot
id|put
op_assign
id|snd_p16v_volume_put_analog_unknown
)brace
suffix:semicolon
DECL|variable|snd_p16v_volume_control_analog_rear
r_static
id|snd_kcontrol_new_t
id|snd_p16v_volume_control_analog_rear
op_assign
(brace
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_MIXER
comma
dot
id|name
op_assign
l_string|&quot;HD Analog Rear Volume&quot;
comma
dot
id|info
op_assign
id|snd_p16v_volume_info
comma
dot
id|get
op_assign
id|snd_p16v_volume_get_analog_rear
comma
dot
id|put
op_assign
id|snd_p16v_volume_put_analog_rear
)brace
suffix:semicolon
DECL|variable|snd_p16v_volume_control_spdif_front
r_static
id|snd_kcontrol_new_t
id|snd_p16v_volume_control_spdif_front
op_assign
(brace
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_MIXER
comma
dot
id|name
op_assign
l_string|&quot;HD SPDIF Front Volume&quot;
comma
dot
id|info
op_assign
id|snd_p16v_volume_info
comma
dot
id|get
op_assign
id|snd_p16v_volume_get_spdif_front
comma
dot
id|put
op_assign
id|snd_p16v_volume_put_spdif_front
)brace
suffix:semicolon
DECL|variable|snd_p16v_volume_control_spdif_center_lfe
r_static
id|snd_kcontrol_new_t
id|snd_p16v_volume_control_spdif_center_lfe
op_assign
(brace
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_MIXER
comma
dot
id|name
op_assign
l_string|&quot;HD SPDIF Center/LFE Volume&quot;
comma
dot
id|info
op_assign
id|snd_p16v_volume_info
comma
dot
id|get
op_assign
id|snd_p16v_volume_get_spdif_center_lfe
comma
dot
id|put
op_assign
id|snd_p16v_volume_put_spdif_center_lfe
)brace
suffix:semicolon
DECL|variable|snd_p16v_volume_control_spdif_unknown
r_static
id|snd_kcontrol_new_t
id|snd_p16v_volume_control_spdif_unknown
op_assign
(brace
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_MIXER
comma
dot
id|name
op_assign
l_string|&quot;HD SPDIF Unknown Volume&quot;
comma
dot
id|info
op_assign
id|snd_p16v_volume_info
comma
dot
id|get
op_assign
id|snd_p16v_volume_get_spdif_unknown
comma
dot
id|put
op_assign
id|snd_p16v_volume_put_spdif_unknown
)brace
suffix:semicolon
DECL|variable|snd_p16v_volume_control_spdif_rear
r_static
id|snd_kcontrol_new_t
id|snd_p16v_volume_control_spdif_rear
op_assign
(brace
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_MIXER
comma
dot
id|name
op_assign
l_string|&quot;HD SPDIF Rear Volume&quot;
comma
dot
id|info
op_assign
id|snd_p16v_volume_info
comma
dot
id|get
op_assign
id|snd_p16v_volume_get_spdif_rear
comma
dot
id|put
op_assign
id|snd_p16v_volume_put_spdif_rear
)brace
suffix:semicolon
DECL|function|snd_p16v_mixer
r_int
id|snd_p16v_mixer
c_func
(paren
id|emu10k1_t
op_star
id|emu
)paren
(brace
r_int
id|err
suffix:semicolon
id|snd_kcontrol_t
op_star
id|kctl
suffix:semicolon
id|snd_card_t
op_star
id|card
op_assign
id|emu-&gt;card
suffix:semicolon
r_if
c_cond
(paren
(paren
id|kctl
op_assign
id|snd_ctl_new1
c_func
(paren
op_amp
id|snd_p16v_volume_control_analog_front
comma
id|emu
)paren
)paren
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|card
comma
id|kctl
)paren
)paren
)paren
r_return
id|err
suffix:semicolon
r_if
c_cond
(paren
(paren
id|kctl
op_assign
id|snd_ctl_new1
c_func
(paren
op_amp
id|snd_p16v_volume_control_analog_rear
comma
id|emu
)paren
)paren
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|card
comma
id|kctl
)paren
)paren
)paren
r_return
id|err
suffix:semicolon
r_if
c_cond
(paren
(paren
id|kctl
op_assign
id|snd_ctl_new1
c_func
(paren
op_amp
id|snd_p16v_volume_control_analog_center_lfe
comma
id|emu
)paren
)paren
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|card
comma
id|kctl
)paren
)paren
)paren
r_return
id|err
suffix:semicolon
r_if
c_cond
(paren
(paren
id|kctl
op_assign
id|snd_ctl_new1
c_func
(paren
op_amp
id|snd_p16v_volume_control_analog_unknown
comma
id|emu
)paren
)paren
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|card
comma
id|kctl
)paren
)paren
)paren
r_return
id|err
suffix:semicolon
r_if
c_cond
(paren
(paren
id|kctl
op_assign
id|snd_ctl_new1
c_func
(paren
op_amp
id|snd_p16v_volume_control_spdif_front
comma
id|emu
)paren
)paren
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|card
comma
id|kctl
)paren
)paren
)paren
r_return
id|err
suffix:semicolon
r_if
c_cond
(paren
(paren
id|kctl
op_assign
id|snd_ctl_new1
c_func
(paren
op_amp
id|snd_p16v_volume_control_spdif_rear
comma
id|emu
)paren
)paren
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|card
comma
id|kctl
)paren
)paren
)paren
r_return
id|err
suffix:semicolon
r_if
c_cond
(paren
(paren
id|kctl
op_assign
id|snd_ctl_new1
c_func
(paren
op_amp
id|snd_p16v_volume_control_spdif_center_lfe
comma
id|emu
)paren
)paren
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|card
comma
id|kctl
)paren
)paren
)paren
r_return
id|err
suffix:semicolon
r_if
c_cond
(paren
(paren
id|kctl
op_assign
id|snd_ctl_new1
c_func
(paren
op_amp
id|snd_p16v_volume_control_spdif_unknown
comma
id|emu
)paren
)paren
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|card
comma
id|kctl
)paren
)paren
)paren
r_return
id|err
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
eof
