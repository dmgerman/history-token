multiline_comment|/*&n; *   ALSA driver for Intel ICH (i8x0) chipsets&n; *&n; *&t;Copyright (c) 2000 Jaroslav Kysela &lt;perex@suse.cz&gt;&n; *&n; *&n; *   This code also contains alpha support for SiS 735 chipsets provided&n; *   by Mike Pieper &lt;mptei@users.sourceforge.net&gt;. We have no datasheet&n; *   for SiS735, so the code is not fully functional.&n; *&n; *&n; *   This program is free software; you can redistribute it and/or modify&n; *   it under the terms of the GNU General Public License as published by&n; *   the Free Software Foundation; either version 2 of the License, or&n; *   (at your option) any later version.&n; *&n; *   This program is distributed in the hope that it will be useful,&n; *   but WITHOUT ANY WARRANTY; without even the implied warranty of&n; *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; *   GNU General Public License for more details.&n; *&n; *   You should have received a copy of the GNU General Public License&n; *   along with this program; if not, write to the Free Software&n; *   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA&n;&n; *&n; */
macro_line|#include &lt;sound/driver.h&gt;
macro_line|#include &lt;asm/io.h&gt;
macro_line|#include &lt;linux/delay.h&gt;
macro_line|#include &lt;linux/interrupt.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/pci.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;linux/moduleparam.h&gt;
macro_line|#include &lt;sound/core.h&gt;
macro_line|#include &lt;sound/pcm.h&gt;
macro_line|#include &lt;sound/ac97_codec.h&gt;
macro_line|#include &lt;sound/info.h&gt;
macro_line|#include &lt;sound/initval.h&gt;
multiline_comment|/* for 440MX workaround */
macro_line|#include &lt;asm/pgtable.h&gt;
macro_line|#include &lt;asm/cacheflush.h&gt;
id|MODULE_AUTHOR
c_func
(paren
l_string|&quot;Jaroslav Kysela &lt;perex@suse.cz&gt;&quot;
)paren
suffix:semicolon
id|MODULE_DESCRIPTION
c_func
(paren
l_string|&quot;Intel 82801AA,82901AB,i810,i820,i830,i840,i845,MX440; SiS 7012; Ali 5455&quot;
)paren
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
id|MODULE_SUPPORTED_DEVICE
c_func
(paren
l_string|&quot;{{Intel,82801AA-ICH},&quot;
l_string|&quot;{Intel,82901AB-ICH0},&quot;
l_string|&quot;{Intel,82801BA-ICH2},&quot;
l_string|&quot;{Intel,82801CA-ICH3},&quot;
l_string|&quot;{Intel,82801DB-ICH4},&quot;
l_string|&quot;{Intel,ICH5},&quot;
l_string|&quot;{Intel,ICH6},&quot;
l_string|&quot;{Intel,6300ESB},&quot;
l_string|&quot;{Intel,MX440},&quot;
l_string|&quot;{SiS,SI7012},&quot;
l_string|&quot;{NVidia,nForce Audio},&quot;
l_string|&quot;{NVidia,nForce2 Audio},&quot;
l_string|&quot;{AMD,AMD768},&quot;
l_string|&quot;{AMD,AMD8111},&quot;
l_string|&quot;{ALI,M5455}}&quot;
)paren
suffix:semicolon
DECL|variable|index
r_static
r_int
id|index
(braket
id|SNDRV_CARDS
)braket
op_assign
id|SNDRV_DEFAULT_IDX
suffix:semicolon
multiline_comment|/* Index 0-MAX */
DECL|variable|id
r_static
r_char
op_star
id|id
(braket
id|SNDRV_CARDS
)braket
op_assign
id|SNDRV_DEFAULT_STR
suffix:semicolon
multiline_comment|/* ID for this card */
DECL|variable|enable
r_static
r_int
id|enable
(braket
id|SNDRV_CARDS
)braket
op_assign
id|SNDRV_DEFAULT_ENABLE_PNP
suffix:semicolon
multiline_comment|/* Enable this card */
DECL|variable|ac97_clock
r_static
r_int
id|ac97_clock
(braket
id|SNDRV_CARDS
)braket
op_assign
(brace
(braket
l_int|0
dot
dot
dot
(paren
id|SNDRV_CARDS
op_minus
l_int|1
)paren
)braket
op_assign
l_int|0
)brace
suffix:semicolon
DECL|variable|ac97_quirk
r_static
r_int
id|ac97_quirk
(braket
id|SNDRV_CARDS
)braket
op_assign
(brace
(braket
l_int|0
dot
dot
dot
(paren
id|SNDRV_CARDS
op_minus
l_int|1
)paren
)braket
op_assign
id|AC97_TUNE_DEFAULT
)brace
suffix:semicolon
DECL|variable|buggy_irq
r_static
r_int
id|buggy_irq
(braket
id|SNDRV_CARDS
)braket
suffix:semicolon
DECL|variable|xbox
r_static
r_int
id|xbox
(braket
id|SNDRV_CARDS
)braket
suffix:semicolon
macro_line|#ifdef SUPPORT_MIDI
DECL|variable|mpu_port
r_static
r_int
id|mpu_port
(braket
id|SNDRV_CARDS
)braket
suffix:semicolon
multiline_comment|/* disabled */
macro_line|#endif
id|module_param_array
c_func
(paren
id|index
comma
r_int
comma
l_int|NULL
comma
l_int|0444
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|index
comma
l_string|&quot;Index value for Intel i8x0 soundcard.&quot;
)paren
suffix:semicolon
id|module_param_array
c_func
(paren
id|id
comma
id|charp
comma
l_int|NULL
comma
l_int|0444
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|id
comma
l_string|&quot;ID string for Intel i8x0 soundcard.&quot;
)paren
suffix:semicolon
id|module_param_array
c_func
(paren
id|enable
comma
r_bool
comma
l_int|NULL
comma
l_int|0444
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|enable
comma
l_string|&quot;Enable Intel i8x0 soundcard.&quot;
)paren
suffix:semicolon
id|module_param_array
c_func
(paren
id|ac97_clock
comma
r_int
comma
l_int|NULL
comma
l_int|0444
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|ac97_clock
comma
l_string|&quot;AC&squot;97 codec clock (0 = auto-detect).&quot;
)paren
suffix:semicolon
id|module_param_array
c_func
(paren
id|ac97_quirk
comma
r_int
comma
l_int|NULL
comma
l_int|0444
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|ac97_quirk
comma
l_string|&quot;AC&squot;97 workaround for strange hardware.&quot;
)paren
suffix:semicolon
id|module_param_array
c_func
(paren
id|buggy_irq
comma
r_bool
comma
l_int|NULL
comma
l_int|0444
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|buggy_irq
comma
l_string|&quot;Enable workaround for buggy interrupts on some motherboards.&quot;
)paren
suffix:semicolon
id|module_param_array
c_func
(paren
id|xbox
comma
r_bool
comma
l_int|NULL
comma
l_int|0444
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|xbox
comma
l_string|&quot;Set to 1 for Xbox, if you have problems with the AC&squot;97 codec detection.&quot;
)paren
suffix:semicolon
multiline_comment|/*&n; *  Direct registers&n; */
macro_line|#ifndef PCI_DEVICE_ID_INTEL_82801
DECL|macro|PCI_DEVICE_ID_INTEL_82801
mdefine_line|#define PCI_DEVICE_ID_INTEL_82801       0x2415
macro_line|#endif
macro_line|#ifndef PCI_DEVICE_ID_INTEL_82901
DECL|macro|PCI_DEVICE_ID_INTEL_82901
mdefine_line|#define PCI_DEVICE_ID_INTEL_82901       0x2425
macro_line|#endif
macro_line|#ifndef PCI_DEVICE_ID_INTEL_82801BA
DECL|macro|PCI_DEVICE_ID_INTEL_82801BA
mdefine_line|#define PCI_DEVICE_ID_INTEL_82801BA     0x2445
macro_line|#endif
macro_line|#ifndef PCI_DEVICE_ID_INTEL_440MX
DECL|macro|PCI_DEVICE_ID_INTEL_440MX
mdefine_line|#define PCI_DEVICE_ID_INTEL_440MX       0x7195
macro_line|#endif
macro_line|#ifndef PCI_DEVICE_ID_INTEL_ICH3
DECL|macro|PCI_DEVICE_ID_INTEL_ICH3
mdefine_line|#define PCI_DEVICE_ID_INTEL_ICH3&t;0x2485
macro_line|#endif
macro_line|#ifndef PCI_DEVICE_ID_INTEL_ICH4
DECL|macro|PCI_DEVICE_ID_INTEL_ICH4
mdefine_line|#define PCI_DEVICE_ID_INTEL_ICH4&t;0x24c5
macro_line|#endif
macro_line|#ifndef PCI_DEVICE_ID_INTEL_ICH5
DECL|macro|PCI_DEVICE_ID_INTEL_ICH5
mdefine_line|#define PCI_DEVICE_ID_INTEL_ICH5&t;0x24d5
macro_line|#endif
macro_line|#ifndef PCI_DEVICE_ID_INTEL_ESB_5
DECL|macro|PCI_DEVICE_ID_INTEL_ESB_5
mdefine_line|#define PCI_DEVICE_ID_INTEL_ESB_5&t;0x25a6
macro_line|#endif
macro_line|#ifndef PCI_DEVICE_ID_INTEL_ICH6_3
DECL|macro|PCI_DEVICE_ID_INTEL_ICH6_3
mdefine_line|#define PCI_DEVICE_ID_INTEL_ICH6_3&t;0x266e
macro_line|#endif
macro_line|#ifndef PCI_DEVICE_ID_SI_7012
DECL|macro|PCI_DEVICE_ID_SI_7012
mdefine_line|#define PCI_DEVICE_ID_SI_7012&t;&t;0x7012
macro_line|#endif
macro_line|#ifndef PCI_DEVICE_ID_NVIDIA_MCP_AUDIO
DECL|macro|PCI_DEVICE_ID_NVIDIA_MCP_AUDIO
mdefine_line|#define PCI_DEVICE_ID_NVIDIA_MCP_AUDIO&t;0x01b1
macro_line|#endif
macro_line|#ifndef PCI_DEVICE_ID_NVIDIA_CK804_AUDIO
DECL|macro|PCI_DEVICE_ID_NVIDIA_CK804_AUDIO
mdefine_line|#define PCI_DEVICE_ID_NVIDIA_CK804_AUDIO 0x0059
macro_line|#endif
macro_line|#ifndef PCI_DEVICE_ID_NVIDIA_MCP2_AUDIO
DECL|macro|PCI_DEVICE_ID_NVIDIA_MCP2_AUDIO
mdefine_line|#define PCI_DEVICE_ID_NVIDIA_MCP2_AUDIO&t;0x006a
macro_line|#endif
macro_line|#ifndef PCI_DEVICE_ID_NVIDIA_CK8_AUDIO
DECL|macro|PCI_DEVICE_ID_NVIDIA_CK8_AUDIO
mdefine_line|#define PCI_DEVICE_ID_NVIDIA_CK8_AUDIO&t;0x008a
macro_line|#endif
macro_line|#ifndef PCI_DEVICE_ID_NVIDIA_MCP3_AUDIO
DECL|macro|PCI_DEVICE_ID_NVIDIA_MCP3_AUDIO
mdefine_line|#define PCI_DEVICE_ID_NVIDIA_MCP3_AUDIO&t;0x00da
macro_line|#endif
macro_line|#ifndef PCI_DEVICE_ID_NVIDIA_CK8S_AUDIO
DECL|macro|PCI_DEVICE_ID_NVIDIA_CK8S_AUDIO
mdefine_line|#define PCI_DEVICE_ID_NVIDIA_CK8S_AUDIO&t;0x00ea
macro_line|#endif
DECL|enumerator|DEVICE_INTEL
DECL|enumerator|DEVICE_INTEL_ICH4
DECL|enumerator|DEVICE_SIS
DECL|enumerator|DEVICE_ALI
DECL|enumerator|DEVICE_NFORCE
r_enum
(brace
id|DEVICE_INTEL
comma
id|DEVICE_INTEL_ICH4
comma
id|DEVICE_SIS
comma
id|DEVICE_ALI
comma
id|DEVICE_NFORCE
)brace
suffix:semicolon
DECL|macro|ICHREG
mdefine_line|#define ICHREG(x) ICH_REG_##x
DECL|macro|DEFINE_REGSET
mdefine_line|#define DEFINE_REGSET(name,base) &bslash;&n;enum { &bslash;&n;&t;ICH_REG_##name##_BDBAR&t;= base + 0x0,&t;/* dword - buffer descriptor list base address */ &bslash;&n;&t;ICH_REG_##name##_CIV&t;= base + 0x04,&t;/* byte - current index value */ &bslash;&n;&t;ICH_REG_##name##_LVI&t;= base + 0x05,&t;/* byte - last valid index */ &bslash;&n;&t;ICH_REG_##name##_SR&t;= base + 0x06,&t;/* byte - status register */ &bslash;&n;&t;ICH_REG_##name##_PICB&t;= base + 0x08,&t;/* word - position in current buffer */ &bslash;&n;&t;ICH_REG_##name##_PIV&t;= base + 0x0a,&t;/* byte - prefetched index value */ &bslash;&n;&t;ICH_REG_##name##_CR&t;= base + 0x0b,&t;/* byte - control register */ &bslash;&n;};
multiline_comment|/* busmaster blocks */
id|DEFINE_REGSET
c_func
(paren
id|OFF
comma
l_int|0
)paren
suffix:semicolon
multiline_comment|/* offset */
id|DEFINE_REGSET
c_func
(paren
id|PI
comma
l_int|0x00
)paren
suffix:semicolon
multiline_comment|/* PCM in */
id|DEFINE_REGSET
c_func
(paren
id|PO
comma
l_int|0x10
)paren
suffix:semicolon
multiline_comment|/* PCM out */
id|DEFINE_REGSET
c_func
(paren
id|MC
comma
l_int|0x20
)paren
suffix:semicolon
multiline_comment|/* Mic in */
multiline_comment|/* ICH4 busmaster blocks */
id|DEFINE_REGSET
c_func
(paren
id|MC2
comma
l_int|0x40
)paren
suffix:semicolon
multiline_comment|/* Mic in 2 */
id|DEFINE_REGSET
c_func
(paren
id|PI2
comma
l_int|0x50
)paren
suffix:semicolon
multiline_comment|/* PCM in 2 */
id|DEFINE_REGSET
c_func
(paren
id|SP
comma
l_int|0x60
)paren
suffix:semicolon
multiline_comment|/* SPDIF out */
multiline_comment|/* values for each busmaster block */
multiline_comment|/* LVI */
DECL|macro|ICH_REG_LVI_MASK
mdefine_line|#define ICH_REG_LVI_MASK&t;&t;0x1f
multiline_comment|/* SR */
DECL|macro|ICH_FIFOE
mdefine_line|#define ICH_FIFOE&t;&t;&t;0x10&t;/* FIFO error */
DECL|macro|ICH_BCIS
mdefine_line|#define ICH_BCIS&t;&t;&t;0x08&t;/* buffer completion interrupt status */
DECL|macro|ICH_LVBCI
mdefine_line|#define ICH_LVBCI&t;&t;&t;0x04&t;/* last valid buffer completion interrupt */
DECL|macro|ICH_CELV
mdefine_line|#define ICH_CELV&t;&t;&t;0x02&t;/* current equals last valid */
DECL|macro|ICH_DCH
mdefine_line|#define ICH_DCH&t;&t;&t;&t;0x01&t;/* DMA controller halted */
multiline_comment|/* PIV */
DECL|macro|ICH_REG_PIV_MASK
mdefine_line|#define ICH_REG_PIV_MASK&t;&t;0x1f&t;/* mask */
multiline_comment|/* CR */
DECL|macro|ICH_IOCE
mdefine_line|#define ICH_IOCE&t;&t;&t;0x10&t;/* interrupt on completion enable */
DECL|macro|ICH_FEIE
mdefine_line|#define ICH_FEIE&t;&t;&t;0x08&t;/* fifo error interrupt enable */
DECL|macro|ICH_LVBIE
mdefine_line|#define ICH_LVBIE&t;&t;&t;0x04&t;/* last valid buffer interrupt enable */
DECL|macro|ICH_RESETREGS
mdefine_line|#define ICH_RESETREGS&t;&t;&t;0x02&t;/* reset busmaster registers */
DECL|macro|ICH_STARTBM
mdefine_line|#define ICH_STARTBM&t;&t;&t;0x01&t;/* start busmaster operation */
multiline_comment|/* global block */
DECL|macro|ICH_REG_GLOB_CNT
mdefine_line|#define ICH_REG_GLOB_CNT&t;&t;0x2c&t;/* dword - global control */
DECL|macro|ICH_PCM_SPDIF_MASK
mdefine_line|#define   ICH_PCM_SPDIF_MASK&t;0xc0000000&t;/* s/pdif pcm slot mask (ICH4) */
DECL|macro|ICH_PCM_SPDIF_NONE
mdefine_line|#define   ICH_PCM_SPDIF_NONE&t;0x00000000&t;/* reserved - undefined */
DECL|macro|ICH_PCM_SPDIF_78
mdefine_line|#define   ICH_PCM_SPDIF_78&t;0x40000000&t;/* s/pdif pcm on slots 7&amp;8 */
DECL|macro|ICH_PCM_SPDIF_69
mdefine_line|#define   ICH_PCM_SPDIF_69&t;0x80000000&t;/* s/pdif pcm on slots 6&amp;9 */
DECL|macro|ICH_PCM_SPDIF_1011
mdefine_line|#define   ICH_PCM_SPDIF_1011&t;0xc0000000&t;/* s/pdif pcm on slots 10&amp;11 */
DECL|macro|ICH_PCM_20BIT
mdefine_line|#define   ICH_PCM_20BIT&t;&t;0x00400000&t;/* 20-bit samples (ICH4) */
DECL|macro|ICH_PCM_246_MASK
mdefine_line|#define   ICH_PCM_246_MASK&t;0x00300000&t;/* 6 channels (not all chips) */
DECL|macro|ICH_PCM_6
mdefine_line|#define   ICH_PCM_6&t;&t;0x00200000&t;/* 6 channels (not all chips) */
DECL|macro|ICH_PCM_4
mdefine_line|#define   ICH_PCM_4&t;&t;0x00100000&t;/* 4 channels (not all chips) */
DECL|macro|ICH_PCM_2
mdefine_line|#define   ICH_PCM_2&t;&t;0x00000000&t;/* 2 channels (stereo) */
DECL|macro|ICH_SIS_PCM_246_MASK
mdefine_line|#define   ICH_SIS_PCM_246_MASK&t;0x000000c0&t;/* 6 channels (SIS7012) */
DECL|macro|ICH_SIS_PCM_6
mdefine_line|#define   ICH_SIS_PCM_6&t;&t;0x00000080&t;/* 6 channels (SIS7012) */
DECL|macro|ICH_SIS_PCM_4
mdefine_line|#define   ICH_SIS_PCM_4&t;&t;0x00000040&t;/* 4 channels (SIS7012) */
DECL|macro|ICH_SIS_PCM_2
mdefine_line|#define   ICH_SIS_PCM_2&t;&t;0x00000000&t;/* 2 channels (SIS7012) */
DECL|macro|ICH_TRIE
mdefine_line|#define   ICH_TRIE&t;&t;0x00000040&t;/* tertiary resume interrupt enable */
DECL|macro|ICH_SRIE
mdefine_line|#define   ICH_SRIE&t;&t;0x00000020&t;/* secondary resume interrupt enable */
DECL|macro|ICH_PRIE
mdefine_line|#define   ICH_PRIE&t;&t;0x00000010&t;/* primary resume interrupt enable */
DECL|macro|ICH_ACLINK
mdefine_line|#define   ICH_ACLINK&t;&t;0x00000008&t;/* AClink shut off */
DECL|macro|ICH_AC97WARM
mdefine_line|#define   ICH_AC97WARM&t;&t;0x00000004&t;/* AC&squot;97 warm reset */
DECL|macro|ICH_AC97COLD
mdefine_line|#define   ICH_AC97COLD&t;&t;0x00000002&t;/* AC&squot;97 cold reset */
DECL|macro|ICH_GIE
mdefine_line|#define   ICH_GIE&t;&t;0x00000001&t;/* GPI interrupt enable */
DECL|macro|ICH_REG_GLOB_STA
mdefine_line|#define ICH_REG_GLOB_STA&t;&t;0x30&t;/* dword - global status */
DECL|macro|ICH_TRI
mdefine_line|#define   ICH_TRI&t;&t;0x20000000&t;/* ICH4: tertiary (AC_SDIN2) resume interrupt */
DECL|macro|ICH_TCR
mdefine_line|#define   ICH_TCR&t;&t;0x10000000&t;/* ICH4: tertiary (AC_SDIN2) codec ready */
DECL|macro|ICH_BCS
mdefine_line|#define   ICH_BCS&t;&t;0x08000000&t;/* ICH4: bit clock stopped */
DECL|macro|ICH_SPINT
mdefine_line|#define   ICH_SPINT&t;&t;0x04000000&t;/* ICH4: S/PDIF interrupt */
DECL|macro|ICH_P2INT
mdefine_line|#define   ICH_P2INT&t;&t;0x02000000&t;/* ICH4: PCM2-In interrupt */
DECL|macro|ICH_M2INT
mdefine_line|#define   ICH_M2INT&t;&t;0x01000000&t;/* ICH4: Mic2-In interrupt */
DECL|macro|ICH_SAMPLE_CAP
mdefine_line|#define   ICH_SAMPLE_CAP&t;0x00c00000&t;/* ICH4: sample capability bits (RO) */
DECL|macro|ICH_SAMPLE_16_20
mdefine_line|#define   ICH_SAMPLE_16_20&t;0x00400000&t;/* ICH4: 16- and 20-bit samples */
DECL|macro|ICH_MULTICHAN_CAP
mdefine_line|#define   ICH_MULTICHAN_CAP&t;0x00300000&t;/* ICH4: multi-channel capability bits (RO) */
DECL|macro|ICH_MD3
mdefine_line|#define   ICH_MD3&t;&t;0x00020000&t;/* modem power down semaphore */
DECL|macro|ICH_AD3
mdefine_line|#define   ICH_AD3&t;&t;0x00010000&t;/* audio power down semaphore */
DECL|macro|ICH_RCS
mdefine_line|#define   ICH_RCS&t;&t;0x00008000&t;/* read completion status */
DECL|macro|ICH_BIT3
mdefine_line|#define   ICH_BIT3&t;&t;0x00004000&t;/* bit 3 slot 12 */
DECL|macro|ICH_BIT2
mdefine_line|#define   ICH_BIT2&t;&t;0x00002000&t;/* bit 2 slot 12 */
DECL|macro|ICH_BIT1
mdefine_line|#define   ICH_BIT1&t;&t;0x00001000&t;/* bit 1 slot 12 */
DECL|macro|ICH_SRI
mdefine_line|#define   ICH_SRI&t;&t;0x00000800&t;/* secondary (AC_SDIN1) resume interrupt */
DECL|macro|ICH_PRI
mdefine_line|#define   ICH_PRI&t;&t;0x00000400&t;/* primary (AC_SDIN0) resume interrupt */
DECL|macro|ICH_SCR
mdefine_line|#define   ICH_SCR&t;&t;0x00000200&t;/* secondary (AC_SDIN1) codec ready */
DECL|macro|ICH_PCR
mdefine_line|#define   ICH_PCR&t;&t;0x00000100&t;/* primary (AC_SDIN0) codec ready */
DECL|macro|ICH_MCINT
mdefine_line|#define   ICH_MCINT&t;&t;0x00000080&t;/* MIC capture interrupt */
DECL|macro|ICH_POINT
mdefine_line|#define   ICH_POINT&t;&t;0x00000040&t;/* playback interrupt */
DECL|macro|ICH_PIINT
mdefine_line|#define   ICH_PIINT&t;&t;0x00000020&t;/* capture interrupt */
DECL|macro|ICH_NVSPINT
mdefine_line|#define   ICH_NVSPINT&t;&t;0x00000010&t;/* nforce spdif interrupt */
DECL|macro|ICH_MOINT
mdefine_line|#define   ICH_MOINT&t;&t;0x00000004&t;/* modem playback interrupt */
DECL|macro|ICH_MIINT
mdefine_line|#define   ICH_MIINT&t;&t;0x00000002&t;/* modem capture interrupt */
DECL|macro|ICH_GSCI
mdefine_line|#define   ICH_GSCI&t;&t;0x00000001&t;/* GPI status change interrupt */
DECL|macro|ICH_REG_ACC_SEMA
mdefine_line|#define ICH_REG_ACC_SEMA&t;&t;0x34&t;/* byte - codec write semaphore */
DECL|macro|ICH_CAS
mdefine_line|#define   ICH_CAS&t;&t;0x01&t;&t;/* codec access semaphore */
DECL|macro|ICH_REG_SDM
mdefine_line|#define ICH_REG_SDM&t;&t;0x80
DECL|macro|ICH_DI2L_MASK
mdefine_line|#define   ICH_DI2L_MASK&t;&t;0x000000c0&t;/* PCM In 2, Mic In 2 data in line */
DECL|macro|ICH_DI2L_SHIFT
mdefine_line|#define   ICH_DI2L_SHIFT&t;6
DECL|macro|ICH_DI1L_MASK
mdefine_line|#define   ICH_DI1L_MASK&t;&t;0x00000030&t;/* PCM In 1, Mic In 1 data in line */
DECL|macro|ICH_DI1L_SHIFT
mdefine_line|#define   ICH_DI1L_SHIFT&t;4
DECL|macro|ICH_SE
mdefine_line|#define   ICH_SE&t;&t;0x00000008&t;/* steer enable */
DECL|macro|ICH_LDI_MASK
mdefine_line|#define   ICH_LDI_MASK&t;&t;0x00000003&t;/* last codec read data input */
DECL|macro|ICH_MAX_FRAGS
mdefine_line|#define ICH_MAX_FRAGS&t;&t;32&t;&t;/* max hw frags */
multiline_comment|/*&n; * registers for Ali5455&n; */
multiline_comment|/* ALi 5455 busmaster blocks */
id|DEFINE_REGSET
c_func
(paren
id|AL_PI
comma
l_int|0x40
)paren
suffix:semicolon
multiline_comment|/* ALi PCM in */
id|DEFINE_REGSET
c_func
(paren
id|AL_PO
comma
l_int|0x50
)paren
suffix:semicolon
multiline_comment|/* Ali PCM out */
id|DEFINE_REGSET
c_func
(paren
id|AL_MC
comma
l_int|0x60
)paren
suffix:semicolon
multiline_comment|/* Ali Mic in */
id|DEFINE_REGSET
c_func
(paren
id|AL_CDC_SPO
comma
l_int|0x70
)paren
suffix:semicolon
multiline_comment|/* Ali Codec SPDIF out */
id|DEFINE_REGSET
c_func
(paren
id|AL_CENTER
comma
l_int|0x80
)paren
suffix:semicolon
multiline_comment|/* Ali center out */
id|DEFINE_REGSET
c_func
(paren
id|AL_LFE
comma
l_int|0x90
)paren
suffix:semicolon
multiline_comment|/* Ali center out */
id|DEFINE_REGSET
c_func
(paren
id|AL_CLR_SPI
comma
l_int|0xa0
)paren
suffix:semicolon
multiline_comment|/* Ali Controller SPDIF in */
id|DEFINE_REGSET
c_func
(paren
id|AL_CLR_SPO
comma
l_int|0xb0
)paren
suffix:semicolon
multiline_comment|/* Ali Controller SPDIF out */
id|DEFINE_REGSET
c_func
(paren
id|AL_I2S
comma
l_int|0xc0
)paren
suffix:semicolon
multiline_comment|/* Ali I2S in */
id|DEFINE_REGSET
c_func
(paren
id|AL_PI2
comma
l_int|0xd0
)paren
suffix:semicolon
multiline_comment|/* Ali PCM2 in */
id|DEFINE_REGSET
c_func
(paren
id|AL_MC2
comma
l_int|0xe0
)paren
suffix:semicolon
multiline_comment|/* Ali Mic2 in */
r_enum
(brace
DECL|enumerator|ICH_REG_ALI_SCR
id|ICH_REG_ALI_SCR
op_assign
l_int|0x00
comma
multiline_comment|/* System Control Register */
DECL|enumerator|ICH_REG_ALI_SSR
id|ICH_REG_ALI_SSR
op_assign
l_int|0x04
comma
multiline_comment|/* System Status Register  */
DECL|enumerator|ICH_REG_ALI_DMACR
id|ICH_REG_ALI_DMACR
op_assign
l_int|0x08
comma
multiline_comment|/* DMA Control Register    */
DECL|enumerator|ICH_REG_ALI_FIFOCR1
id|ICH_REG_ALI_FIFOCR1
op_assign
l_int|0x0c
comma
multiline_comment|/* FIFO Control Register 1  */
DECL|enumerator|ICH_REG_ALI_INTERFACECR
id|ICH_REG_ALI_INTERFACECR
op_assign
l_int|0x10
comma
multiline_comment|/* Interface Control Register */
DECL|enumerator|ICH_REG_ALI_INTERRUPTCR
id|ICH_REG_ALI_INTERRUPTCR
op_assign
l_int|0x14
comma
multiline_comment|/* Interrupt control Register */
DECL|enumerator|ICH_REG_ALI_INTERRUPTSR
id|ICH_REG_ALI_INTERRUPTSR
op_assign
l_int|0x18
comma
multiline_comment|/* Interrupt  Status Register */
DECL|enumerator|ICH_REG_ALI_FIFOCR2
id|ICH_REG_ALI_FIFOCR2
op_assign
l_int|0x1c
comma
multiline_comment|/* FIFO Control Register 2   */
DECL|enumerator|ICH_REG_ALI_CPR
id|ICH_REG_ALI_CPR
op_assign
l_int|0x20
comma
multiline_comment|/* Command Port Register     */
DECL|enumerator|ICH_REG_ALI_CPR_ADDR
id|ICH_REG_ALI_CPR_ADDR
op_assign
l_int|0x22
comma
multiline_comment|/* ac97 addr write */
DECL|enumerator|ICH_REG_ALI_SPR
id|ICH_REG_ALI_SPR
op_assign
l_int|0x24
comma
multiline_comment|/* Status Port Register      */
DECL|enumerator|ICH_REG_ALI_SPR_ADDR
id|ICH_REG_ALI_SPR_ADDR
op_assign
l_int|0x26
comma
multiline_comment|/* ac97 addr read */
DECL|enumerator|ICH_REG_ALI_FIFOCR3
id|ICH_REG_ALI_FIFOCR3
op_assign
l_int|0x2c
comma
multiline_comment|/* FIFO Control Register 3  */
DECL|enumerator|ICH_REG_ALI_TTSR
id|ICH_REG_ALI_TTSR
op_assign
l_int|0x30
comma
multiline_comment|/* Transmit Tag Slot Register */
DECL|enumerator|ICH_REG_ALI_RTSR
id|ICH_REG_ALI_RTSR
op_assign
l_int|0x34
comma
multiline_comment|/* Receive Tag Slot  Register */
DECL|enumerator|ICH_REG_ALI_CSPSR
id|ICH_REG_ALI_CSPSR
op_assign
l_int|0x38
comma
multiline_comment|/* Command/Status Port Status Register */
DECL|enumerator|ICH_REG_ALI_CAS
id|ICH_REG_ALI_CAS
op_assign
l_int|0x3c
comma
multiline_comment|/* Codec Write Semaphore Register */
DECL|enumerator|ICH_REG_ALI_HWVOL
id|ICH_REG_ALI_HWVOL
op_assign
l_int|0xf0
comma
multiline_comment|/* hardware volume control/status */
DECL|enumerator|ICH_REG_ALI_I2SCR
id|ICH_REG_ALI_I2SCR
op_assign
l_int|0xf4
comma
multiline_comment|/* I2S control/status */
DECL|enumerator|ICH_REG_ALI_SPDIFCSR
id|ICH_REG_ALI_SPDIFCSR
op_assign
l_int|0xf8
comma
multiline_comment|/* spdif channel status register  */
DECL|enumerator|ICH_REG_ALI_SPDIFICS
id|ICH_REG_ALI_SPDIFICS
op_assign
l_int|0xfc
comma
multiline_comment|/* spdif interface control/status  */
)brace
suffix:semicolon
DECL|macro|ALI_CAS_SEM_BUSY
mdefine_line|#define ALI_CAS_SEM_BUSY&t;0x80000000
DECL|macro|ALI_CPR_ADDR_SECONDARY
mdefine_line|#define ALI_CPR_ADDR_SECONDARY&t;0x100
DECL|macro|ALI_CPR_ADDR_READ
mdefine_line|#define ALI_CPR_ADDR_READ&t;0x80
DECL|macro|ALI_CSPSR_CODEC_READY
mdefine_line|#define ALI_CSPSR_CODEC_READY&t;0x08
DECL|macro|ALI_CSPSR_READ_OK
mdefine_line|#define ALI_CSPSR_READ_OK&t;0x02
DECL|macro|ALI_CSPSR_WRITE_OK
mdefine_line|#define ALI_CSPSR_WRITE_OK&t;0x01
multiline_comment|/* interrupts for the whole chip by interrupt status register finish */
DECL|macro|ALI_INT_MICIN2
mdefine_line|#define ALI_INT_MICIN2&t;&t;(1&lt;&lt;26)
DECL|macro|ALI_INT_PCMIN2
mdefine_line|#define ALI_INT_PCMIN2&t;&t;(1&lt;&lt;25)
DECL|macro|ALI_INT_I2SIN
mdefine_line|#define ALI_INT_I2SIN&t;&t;(1&lt;&lt;24)
DECL|macro|ALI_INT_SPDIFOUT
mdefine_line|#define ALI_INT_SPDIFOUT&t;(1&lt;&lt;23)&t;/* controller spdif out INTERRUPT */
DECL|macro|ALI_INT_SPDIFIN
mdefine_line|#define ALI_INT_SPDIFIN&t;&t;(1&lt;&lt;22)
DECL|macro|ALI_INT_LFEOUT
mdefine_line|#define ALI_INT_LFEOUT&t;&t;(1&lt;&lt;21)
DECL|macro|ALI_INT_CENTEROUT
mdefine_line|#define ALI_INT_CENTEROUT&t;(1&lt;&lt;20)
DECL|macro|ALI_INT_CODECSPDIFOUT
mdefine_line|#define ALI_INT_CODECSPDIFOUT&t;(1&lt;&lt;19)
DECL|macro|ALI_INT_MICIN
mdefine_line|#define ALI_INT_MICIN&t;&t;(1&lt;&lt;18)
DECL|macro|ALI_INT_PCMOUT
mdefine_line|#define ALI_INT_PCMOUT&t;&t;(1&lt;&lt;17)
DECL|macro|ALI_INT_PCMIN
mdefine_line|#define ALI_INT_PCMIN&t;&t;(1&lt;&lt;16)
DECL|macro|ALI_INT_CPRAIS
mdefine_line|#define ALI_INT_CPRAIS&t;&t;(1&lt;&lt;7)&t;/* command port available */
DECL|macro|ALI_INT_SPRAIS
mdefine_line|#define ALI_INT_SPRAIS&t;&t;(1&lt;&lt;5)&t;/* status port available */
DECL|macro|ALI_INT_GPIO
mdefine_line|#define ALI_INT_GPIO&t;&t;(1&lt;&lt;1)
DECL|macro|ALI_INT_MASK
mdefine_line|#define ALI_INT_MASK&t;&t;(ALI_INT_SPDIFOUT|ALI_INT_CODECSPDIFOUT|ALI_INT_MICIN|ALI_INT_PCMOUT|ALI_INT_PCMIN)
DECL|macro|ICH_ALI_SC_RESET
mdefine_line|#define ICH_ALI_SC_RESET&t;(1&lt;&lt;31)&t;/* master reset */
DECL|macro|ICH_ALI_SC_AC97_DBL
mdefine_line|#define ICH_ALI_SC_AC97_DBL&t;(1&lt;&lt;30)
DECL|macro|ICH_ALI_SC_CODEC_SPDF
mdefine_line|#define ICH_ALI_SC_CODEC_SPDF&t;(3&lt;&lt;20)&t;/* 1=7/8, 2=6/9, 3=10/11 */
DECL|macro|ICH_ALI_SC_IN_BITS
mdefine_line|#define ICH_ALI_SC_IN_BITS&t;(3&lt;&lt;18)
DECL|macro|ICH_ALI_SC_OUT_BITS
mdefine_line|#define ICH_ALI_SC_OUT_BITS&t;(3&lt;&lt;16)
DECL|macro|ICH_ALI_SC_6CH_CFG
mdefine_line|#define ICH_ALI_SC_6CH_CFG&t;(3&lt;&lt;14)
DECL|macro|ICH_ALI_SC_PCM_4
mdefine_line|#define ICH_ALI_SC_PCM_4&t;(1&lt;&lt;8)
DECL|macro|ICH_ALI_SC_PCM_6
mdefine_line|#define ICH_ALI_SC_PCM_6&t;(2&lt;&lt;8)
DECL|macro|ICH_ALI_SC_PCM_246_MASK
mdefine_line|#define ICH_ALI_SC_PCM_246_MASK&t;(3&lt;&lt;8)
DECL|macro|ICH_ALI_SS_SEC_ID
mdefine_line|#define ICH_ALI_SS_SEC_ID&t;(3&lt;&lt;5)
DECL|macro|ICH_ALI_SS_PRI_ID
mdefine_line|#define ICH_ALI_SS_PRI_ID&t;(3&lt;&lt;3)
DECL|macro|ICH_ALI_IF_AC97SP
mdefine_line|#define ICH_ALI_IF_AC97SP&t;(1&lt;&lt;21)
DECL|macro|ICH_ALI_IF_MC
mdefine_line|#define ICH_ALI_IF_MC&t;&t;(1&lt;&lt;20)
DECL|macro|ICH_ALI_IF_PI
mdefine_line|#define ICH_ALI_IF_PI&t;&t;(1&lt;&lt;19)
DECL|macro|ICH_ALI_IF_MC2
mdefine_line|#define ICH_ALI_IF_MC2&t;&t;(1&lt;&lt;18)
DECL|macro|ICH_ALI_IF_PI2
mdefine_line|#define ICH_ALI_IF_PI2&t;&t;(1&lt;&lt;17)
DECL|macro|ICH_ALI_IF_LINE_SRC
mdefine_line|#define ICH_ALI_IF_LINE_SRC&t;(1&lt;&lt;15)&t;/* 0/1 = slot 3/6 */
DECL|macro|ICH_ALI_IF_MIC_SRC
mdefine_line|#define ICH_ALI_IF_MIC_SRC&t;(1&lt;&lt;14)&t;/* 0/1 = slot 3/6 */
DECL|macro|ICH_ALI_IF_SPDF_SRC
mdefine_line|#define ICH_ALI_IF_SPDF_SRC&t;(3&lt;&lt;12)&t;/* 00 = PCM, 01 = AC97-in, 10 = spdif-in, 11 = i2s */
DECL|macro|ICH_ALI_IF_AC97_OUT
mdefine_line|#define ICH_ALI_IF_AC97_OUT&t;(3&lt;&lt;8)&t;/* 00 = PCM, 10 = spdif-in, 11 = i2s */
DECL|macro|ICH_ALI_IF_PO_SPDF
mdefine_line|#define ICH_ALI_IF_PO_SPDF&t;(1&lt;&lt;3)
DECL|macro|ICH_ALI_IF_PO
mdefine_line|#define ICH_ALI_IF_PO&t;&t;(1&lt;&lt;1)
multiline_comment|/*&n; *  &n; */
DECL|enumerator|ICHD_PCMIN
DECL|enumerator|ICHD_PCMOUT
DECL|enumerator|ICHD_MIC
DECL|enumerator|ICHD_MIC2
DECL|enumerator|ICHD_PCM2IN
DECL|enumerator|ICHD_SPBAR
DECL|enumerator|ICHD_LAST
r_enum
(brace
id|ICHD_PCMIN
comma
id|ICHD_PCMOUT
comma
id|ICHD_MIC
comma
id|ICHD_MIC2
comma
id|ICHD_PCM2IN
comma
id|ICHD_SPBAR
comma
id|ICHD_LAST
op_assign
id|ICHD_SPBAR
)brace
suffix:semicolon
DECL|enumerator|NVD_PCMIN
DECL|enumerator|NVD_PCMOUT
DECL|enumerator|NVD_MIC
DECL|enumerator|NVD_SPBAR
DECL|enumerator|NVD_LAST
r_enum
(brace
id|NVD_PCMIN
comma
id|NVD_PCMOUT
comma
id|NVD_MIC
comma
id|NVD_SPBAR
comma
id|NVD_LAST
op_assign
id|NVD_SPBAR
)brace
suffix:semicolon
DECL|enumerator|ALID_PCMIN
DECL|enumerator|ALID_PCMOUT
DECL|enumerator|ALID_MIC
DECL|enumerator|ALID_AC97SPDIFOUT
DECL|enumerator|ALID_SPDIFIN
DECL|enumerator|ALID_SPDIFOUT
DECL|enumerator|ALID_LAST
r_enum
(brace
id|ALID_PCMIN
comma
id|ALID_PCMOUT
comma
id|ALID_MIC
comma
id|ALID_AC97SPDIFOUT
comma
id|ALID_SPDIFIN
comma
id|ALID_SPDIFOUT
comma
id|ALID_LAST
op_assign
id|ALID_SPDIFOUT
)brace
suffix:semicolon
DECL|macro|get_ichdev
mdefine_line|#define get_ichdev(substream) (ichdev_t *)(substream-&gt;runtime-&gt;private_data)
r_typedef
r_struct
(brace
DECL|member|ichd
r_int
r_int
id|ichd
suffix:semicolon
multiline_comment|/* ich device number */
DECL|member|reg_offset
r_int
r_int
id|reg_offset
suffix:semicolon
multiline_comment|/* offset to bmaddr */
DECL|member|bdbar
id|u32
op_star
id|bdbar
suffix:semicolon
multiline_comment|/* CPU address (32bit) */
DECL|member|bdbar_addr
r_int
r_int
id|bdbar_addr
suffix:semicolon
multiline_comment|/* PCI bus address (32bit) */
DECL|member|substream
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
DECL|member|physbuf
r_int
r_int
id|physbuf
suffix:semicolon
multiline_comment|/* physical address (32bit) */
DECL|member|size
r_int
r_int
id|size
suffix:semicolon
DECL|member|fragsize
r_int
r_int
id|fragsize
suffix:semicolon
DECL|member|fragsize1
r_int
r_int
id|fragsize1
suffix:semicolon
DECL|member|position
r_int
r_int
id|position
suffix:semicolon
DECL|member|pos_shift
r_int
r_int
id|pos_shift
suffix:semicolon
DECL|member|frags
r_int
id|frags
suffix:semicolon
DECL|member|lvi
r_int
id|lvi
suffix:semicolon
DECL|member|lvi_frag
r_int
id|lvi_frag
suffix:semicolon
DECL|member|civ
r_int
id|civ
suffix:semicolon
DECL|member|ack
r_int
id|ack
suffix:semicolon
DECL|member|ack_reload
r_int
id|ack_reload
suffix:semicolon
DECL|member|ack_bit
r_int
r_int
id|ack_bit
suffix:semicolon
DECL|member|roff_sr
r_int
r_int
id|roff_sr
suffix:semicolon
DECL|member|roff_picb
r_int
r_int
id|roff_picb
suffix:semicolon
DECL|member|int_sta_mask
r_int
r_int
id|int_sta_mask
suffix:semicolon
multiline_comment|/* interrupt status mask */
DECL|member|ali_slot
r_int
r_int
id|ali_slot
suffix:semicolon
multiline_comment|/* ALI DMA slot */
DECL|member|pcm
r_struct
id|ac97_pcm
op_star
id|pcm
suffix:semicolon
DECL|member|pcm_open_flag
r_int
id|pcm_open_flag
suffix:semicolon
DECL|member|page_attr_changed
r_int
r_int
id|page_attr_changed
suffix:colon
l_int|1
suffix:semicolon
DECL|typedef|ichdev_t
)brace
id|ichdev_t
suffix:semicolon
DECL|typedef|intel8x0_t
r_typedef
r_struct
id|_snd_intel8x0
id|intel8x0_t
suffix:semicolon
DECL|struct|_snd_intel8x0
r_struct
id|_snd_intel8x0
(brace
DECL|member|device_type
r_int
r_int
id|device_type
suffix:semicolon
DECL|member|irq
r_int
id|irq
suffix:semicolon
DECL|member|mmio
r_int
r_int
id|mmio
suffix:semicolon
DECL|member|addr
r_int
r_int
id|addr
suffix:semicolon
DECL|member|remap_addr
r_void
id|__iomem
op_star
id|remap_addr
suffix:semicolon
DECL|member|bm_mmio
r_int
r_int
id|bm_mmio
suffix:semicolon
DECL|member|bmaddr
r_int
r_int
id|bmaddr
suffix:semicolon
DECL|member|remap_bmaddr
r_void
id|__iomem
op_star
id|remap_bmaddr
suffix:semicolon
DECL|member|pci
r_struct
id|pci_dev
op_star
id|pci
suffix:semicolon
DECL|member|card
id|snd_card_t
op_star
id|card
suffix:semicolon
DECL|member|pcm_devs
r_int
id|pcm_devs
suffix:semicolon
DECL|member|pcm
id|snd_pcm_t
op_star
id|pcm
(braket
l_int|6
)braket
suffix:semicolon
DECL|member|ichd
id|ichdev_t
id|ichd
(braket
l_int|6
)braket
suffix:semicolon
DECL|member|multi4
r_int
id|multi4
suffix:colon
l_int|1
comma
DECL|member|multi6
id|multi6
suffix:colon
l_int|1
comma
DECL|member|dra
id|dra
suffix:colon
l_int|1
comma
DECL|member|smp20bit
id|smp20bit
suffix:colon
l_int|1
suffix:semicolon
DECL|member|in_ac97_init
r_int
id|in_ac97_init
suffix:colon
l_int|1
comma
DECL|member|in_sdin_init
id|in_sdin_init
suffix:colon
l_int|1
suffix:semicolon
DECL|member|in_measurement
r_int
id|in_measurement
suffix:colon
l_int|1
suffix:semicolon
multiline_comment|/* during ac97 clock measurement */
DECL|member|fix_nocache
r_int
id|fix_nocache
suffix:colon
l_int|1
suffix:semicolon
multiline_comment|/* workaround for 440MX */
DECL|member|buggy_irq
r_int
id|buggy_irq
suffix:colon
l_int|1
suffix:semicolon
multiline_comment|/* workaround for buggy mobos */
DECL|member|xbox
r_int
id|xbox
suffix:colon
l_int|1
suffix:semicolon
multiline_comment|/* workaround for Xbox AC&squot;97 detection */
DECL|member|spdif_idx
r_int
id|spdif_idx
suffix:semicolon
multiline_comment|/* SPDIF BAR index; *_SPBAR or -1 if use PCMOUT */
DECL|member|ac97_bus
id|ac97_bus_t
op_star
id|ac97_bus
suffix:semicolon
DECL|member|ac97
id|ac97_t
op_star
id|ac97
(braket
l_int|3
)braket
suffix:semicolon
DECL|member|ac97_sdin
r_int
r_int
id|ac97_sdin
(braket
l_int|3
)braket
suffix:semicolon
DECL|member|reg_lock
id|spinlock_t
id|reg_lock
suffix:semicolon
DECL|member|ac97_lock
id|spinlock_t
id|ac97_lock
suffix:semicolon
DECL|member|bdbars_count
id|u32
id|bdbars_count
suffix:semicolon
DECL|member|bdbars
r_struct
id|snd_dma_buffer
id|bdbars
suffix:semicolon
DECL|member|int_sta_reg
id|u32
id|int_sta_reg
suffix:semicolon
multiline_comment|/* interrupt status register */
DECL|member|int_sta_mask
id|u32
id|int_sta_mask
suffix:semicolon
multiline_comment|/* interrupt status mask */
)brace
suffix:semicolon
DECL|variable|snd_intel8x0_ids
r_static
r_struct
id|pci_device_id
id|snd_intel8x0_ids
(braket
)braket
op_assign
(brace
(brace
l_int|0x8086
comma
l_int|0x2415
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|DEVICE_INTEL
)brace
comma
multiline_comment|/* 82801AA */
(brace
l_int|0x8086
comma
l_int|0x2425
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|DEVICE_INTEL
)brace
comma
multiline_comment|/* 82901AB */
(brace
l_int|0x8086
comma
l_int|0x2445
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|DEVICE_INTEL
)brace
comma
multiline_comment|/* 82801BA */
(brace
l_int|0x8086
comma
l_int|0x2485
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|DEVICE_INTEL
)brace
comma
multiline_comment|/* ICH3 */
(brace
l_int|0x8086
comma
l_int|0x24c5
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|DEVICE_INTEL_ICH4
)brace
comma
multiline_comment|/* ICH4 */
(brace
l_int|0x8086
comma
l_int|0x24d5
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|DEVICE_INTEL_ICH4
)brace
comma
multiline_comment|/* ICH5 */
(brace
l_int|0x8086
comma
l_int|0x25a6
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|DEVICE_INTEL_ICH4
)brace
comma
multiline_comment|/* ESB */
(brace
l_int|0x8086
comma
l_int|0x266e
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|DEVICE_INTEL_ICH4
)brace
comma
multiline_comment|/* ICH6 */
(brace
l_int|0x8086
comma
l_int|0x7195
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|DEVICE_INTEL
)brace
comma
multiline_comment|/* 440MX */
(brace
l_int|0x1039
comma
l_int|0x7012
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|DEVICE_SIS
)brace
comma
multiline_comment|/* SI7012 */
(brace
l_int|0x10de
comma
l_int|0x01b1
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|DEVICE_NFORCE
)brace
comma
multiline_comment|/* NFORCE */
(brace
l_int|0x10de
comma
l_int|0x003a
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|DEVICE_NFORCE
)brace
comma
multiline_comment|/* MCP04 */
(brace
l_int|0x10de
comma
l_int|0x006a
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|DEVICE_NFORCE
)brace
comma
multiline_comment|/* NFORCE2 */
(brace
l_int|0x10de
comma
l_int|0x0059
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|DEVICE_NFORCE
)brace
comma
multiline_comment|/* CK804 */
(brace
l_int|0x10de
comma
l_int|0x008a
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|DEVICE_NFORCE
)brace
comma
multiline_comment|/* CK8 */
(brace
l_int|0x10de
comma
l_int|0x00da
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|DEVICE_NFORCE
)brace
comma
multiline_comment|/* NFORCE3 */
(brace
l_int|0x10de
comma
l_int|0x00ea
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|DEVICE_NFORCE
)brace
comma
multiline_comment|/* CK8S */
(brace
l_int|0x1022
comma
l_int|0x746d
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|DEVICE_INTEL
)brace
comma
multiline_comment|/* AMD8111 */
(brace
l_int|0x1022
comma
l_int|0x7445
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|DEVICE_INTEL
)brace
comma
multiline_comment|/* AMD768 */
(brace
l_int|0x10b9
comma
l_int|0x5455
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|DEVICE_ALI
)brace
comma
multiline_comment|/* Ali5455 */
(brace
l_int|0
comma
)brace
)brace
suffix:semicolon
id|MODULE_DEVICE_TABLE
c_func
(paren
id|pci
comma
id|snd_intel8x0_ids
)paren
suffix:semicolon
multiline_comment|/*&n; *  Lowlevel I/O - busmaster&n; */
DECL|function|igetbyte
r_static
id|u8
id|igetbyte
c_func
(paren
id|intel8x0_t
op_star
id|chip
comma
id|u32
id|offset
)paren
(brace
r_if
c_cond
(paren
id|chip-&gt;bm_mmio
)paren
r_return
id|readb
c_func
(paren
id|chip-&gt;remap_bmaddr
op_plus
id|offset
)paren
suffix:semicolon
r_else
r_return
id|inb
c_func
(paren
id|chip-&gt;bmaddr
op_plus
id|offset
)paren
suffix:semicolon
)brace
DECL|function|igetword
r_static
id|u16
id|igetword
c_func
(paren
id|intel8x0_t
op_star
id|chip
comma
id|u32
id|offset
)paren
(brace
r_if
c_cond
(paren
id|chip-&gt;bm_mmio
)paren
r_return
id|readw
c_func
(paren
id|chip-&gt;remap_bmaddr
op_plus
id|offset
)paren
suffix:semicolon
r_else
r_return
id|inw
c_func
(paren
id|chip-&gt;bmaddr
op_plus
id|offset
)paren
suffix:semicolon
)brace
DECL|function|igetdword
r_static
id|u32
id|igetdword
c_func
(paren
id|intel8x0_t
op_star
id|chip
comma
id|u32
id|offset
)paren
(brace
r_if
c_cond
(paren
id|chip-&gt;bm_mmio
)paren
r_return
id|readl
c_func
(paren
id|chip-&gt;remap_bmaddr
op_plus
id|offset
)paren
suffix:semicolon
r_else
r_return
id|inl
c_func
(paren
id|chip-&gt;bmaddr
op_plus
id|offset
)paren
suffix:semicolon
)brace
DECL|function|iputbyte
r_static
r_void
id|iputbyte
c_func
(paren
id|intel8x0_t
op_star
id|chip
comma
id|u32
id|offset
comma
id|u8
id|val
)paren
(brace
r_if
c_cond
(paren
id|chip-&gt;bm_mmio
)paren
id|writeb
c_func
(paren
id|val
comma
id|chip-&gt;remap_bmaddr
op_plus
id|offset
)paren
suffix:semicolon
r_else
id|outb
c_func
(paren
id|val
comma
id|chip-&gt;bmaddr
op_plus
id|offset
)paren
suffix:semicolon
)brace
DECL|function|iputword
r_static
r_void
id|iputword
c_func
(paren
id|intel8x0_t
op_star
id|chip
comma
id|u32
id|offset
comma
id|u16
id|val
)paren
(brace
r_if
c_cond
(paren
id|chip-&gt;bm_mmio
)paren
id|writew
c_func
(paren
id|val
comma
id|chip-&gt;remap_bmaddr
op_plus
id|offset
)paren
suffix:semicolon
r_else
id|outw
c_func
(paren
id|val
comma
id|chip-&gt;bmaddr
op_plus
id|offset
)paren
suffix:semicolon
)brace
DECL|function|iputdword
r_static
r_void
id|iputdword
c_func
(paren
id|intel8x0_t
op_star
id|chip
comma
id|u32
id|offset
comma
id|u32
id|val
)paren
(brace
r_if
c_cond
(paren
id|chip-&gt;bm_mmio
)paren
id|writel
c_func
(paren
id|val
comma
id|chip-&gt;remap_bmaddr
op_plus
id|offset
)paren
suffix:semicolon
r_else
id|outl
c_func
(paren
id|val
comma
id|chip-&gt;bmaddr
op_plus
id|offset
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; *  Lowlevel I/O - AC&squot;97 registers&n; */
DECL|function|iagetword
r_static
id|u16
id|iagetword
c_func
(paren
id|intel8x0_t
op_star
id|chip
comma
id|u32
id|offset
)paren
(brace
r_if
c_cond
(paren
id|chip-&gt;mmio
)paren
r_return
id|readw
c_func
(paren
id|chip-&gt;remap_addr
op_plus
id|offset
)paren
suffix:semicolon
r_else
r_return
id|inw
c_func
(paren
id|chip-&gt;addr
op_plus
id|offset
)paren
suffix:semicolon
)brace
DECL|function|iaputword
r_static
r_void
id|iaputword
c_func
(paren
id|intel8x0_t
op_star
id|chip
comma
id|u32
id|offset
comma
id|u16
id|val
)paren
(brace
r_if
c_cond
(paren
id|chip-&gt;mmio
)paren
id|writew
c_func
(paren
id|val
comma
id|chip-&gt;remap_addr
op_plus
id|offset
)paren
suffix:semicolon
r_else
id|outw
c_func
(paren
id|val
comma
id|chip-&gt;addr
op_plus
id|offset
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; *  Basic I/O&n; */
multiline_comment|/*&n; * access to AC97 codec via normal i/o (for ICH and SIS7012)&n; */
multiline_comment|/* return the GLOB_STA bit for the corresponding codec */
DECL|function|get_ich_codec_bit
r_static
r_int
r_int
id|get_ich_codec_bit
c_func
(paren
id|intel8x0_t
op_star
id|chip
comma
r_int
r_int
id|codec
)paren
(brace
r_static
r_int
r_int
id|codec_bit
(braket
l_int|3
)braket
op_assign
(brace
id|ICH_PCR
comma
id|ICH_SCR
comma
id|ICH_TCR
)brace
suffix:semicolon
id|snd_assert
c_func
(paren
id|codec
OL
l_int|3
comma
r_return
id|ICH_PCR
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;device_type
op_eq
id|DEVICE_INTEL_ICH4
)paren
id|codec
op_assign
id|chip-&gt;ac97_sdin
(braket
id|codec
)braket
suffix:semicolon
r_return
id|codec_bit
(braket
id|codec
)braket
suffix:semicolon
)brace
DECL|function|snd_intel8x0_codec_semaphore
r_static
r_int
id|snd_intel8x0_codec_semaphore
c_func
(paren
id|intel8x0_t
op_star
id|chip
comma
r_int
r_int
id|codec
)paren
(brace
r_int
id|time
suffix:semicolon
r_if
c_cond
(paren
id|codec
OG
l_int|2
)paren
r_return
op_minus
id|EIO
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;in_sdin_init
)paren
(brace
multiline_comment|/* we don&squot;t know the ready bit assignment at the moment */
multiline_comment|/* so we check any */
id|codec
op_assign
id|ICH_PCR
op_or
id|ICH_SCR
op_or
id|ICH_TCR
suffix:semicolon
)brace
r_else
(brace
id|codec
op_assign
id|get_ich_codec_bit
c_func
(paren
id|chip
comma
id|codec
)paren
suffix:semicolon
)brace
multiline_comment|/* codec ready ? */
r_if
c_cond
(paren
(paren
id|igetdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|GLOB_STA
)paren
)paren
op_amp
id|codec
)paren
op_eq
l_int|0
)paren
r_return
op_minus
id|EIO
suffix:semicolon
multiline_comment|/* Anyone holding a semaphore for 1 msec should be shot... */
id|time
op_assign
l_int|100
suffix:semicolon
r_do
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|igetbyte
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|ACC_SEMA
)paren
)paren
op_amp
id|ICH_CAS
)paren
)paren
r_return
l_int|0
suffix:semicolon
id|udelay
c_func
(paren
l_int|10
)paren
suffix:semicolon
)brace
r_while
c_loop
(paren
id|time
op_decrement
)paren
suffix:semicolon
multiline_comment|/* access to some forbidden (non existant) ac97 registers will not&n;&t; * reset the semaphore. So even if you don&squot;t get the semaphore, still&n;&t; * continue the access. We don&squot;t need the semaphore anyway. */
id|snd_printk
c_func
(paren
l_string|&quot;codec_semaphore: semaphore is not ready [0x%x][0x%x]&bslash;n&quot;
comma
id|igetbyte
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|ACC_SEMA
)paren
)paren
comma
id|igetdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|GLOB_STA
)paren
)paren
)paren
suffix:semicolon
id|iagetword
c_func
(paren
id|chip
comma
l_int|0
)paren
suffix:semicolon
multiline_comment|/* clear semaphore flag */
multiline_comment|/* I don&squot;t care about the semaphore */
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
DECL|function|snd_intel8x0_codec_write
r_static
r_void
id|snd_intel8x0_codec_write
c_func
(paren
id|ac97_t
op_star
id|ac97
comma
r_int
r_int
id|reg
comma
r_int
r_int
id|val
)paren
(brace
id|intel8x0_t
op_star
id|chip
op_assign
id|ac97-&gt;private_data
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|chip-&gt;ac97_lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|snd_intel8x0_codec_semaphore
c_func
(paren
id|chip
comma
id|ac97-&gt;num
)paren
OL
l_int|0
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|chip-&gt;in_ac97_init
)paren
id|snd_printk
c_func
(paren
l_string|&quot;codec_write %d: semaphore is not ready for register 0x%x&bslash;n&quot;
comma
id|ac97-&gt;num
comma
id|reg
)paren
suffix:semicolon
)brace
id|iaputword
c_func
(paren
id|chip
comma
id|reg
op_plus
id|ac97-&gt;num
op_star
l_int|0x80
comma
id|val
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|chip-&gt;ac97_lock
)paren
suffix:semicolon
)brace
DECL|function|snd_intel8x0_codec_read
r_static
r_int
r_int
id|snd_intel8x0_codec_read
c_func
(paren
id|ac97_t
op_star
id|ac97
comma
r_int
r_int
id|reg
)paren
(brace
id|intel8x0_t
op_star
id|chip
op_assign
id|ac97-&gt;private_data
suffix:semicolon
r_int
r_int
id|res
suffix:semicolon
r_int
r_int
id|tmp
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|chip-&gt;ac97_lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|snd_intel8x0_codec_semaphore
c_func
(paren
id|chip
comma
id|ac97-&gt;num
)paren
OL
l_int|0
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|chip-&gt;in_ac97_init
)paren
id|snd_printk
c_func
(paren
l_string|&quot;codec_read %d: semaphore is not ready for register 0x%x&bslash;n&quot;
comma
id|ac97-&gt;num
comma
id|reg
)paren
suffix:semicolon
id|res
op_assign
l_int|0xffff
suffix:semicolon
)brace
r_else
(brace
id|res
op_assign
id|iagetword
c_func
(paren
id|chip
comma
id|reg
op_plus
id|ac97-&gt;num
op_star
l_int|0x80
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|tmp
op_assign
id|igetdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|GLOB_STA
)paren
)paren
)paren
op_amp
id|ICH_RCS
)paren
(brace
multiline_comment|/* reset RCS and preserve other R/WC bits */
id|iputdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|GLOB_STA
)paren
comma
id|tmp
op_amp
op_complement
(paren
id|ICH_SRI
op_or
id|ICH_PRI
op_or
id|ICH_TRI
op_or
id|ICH_GSCI
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|chip-&gt;in_ac97_init
)paren
id|snd_printk
c_func
(paren
l_string|&quot;codec_read %d: read timeout for register 0x%x&bslash;n&quot;
comma
id|ac97-&gt;num
comma
id|reg
)paren
suffix:semicolon
id|res
op_assign
l_int|0xffff
suffix:semicolon
)brace
)brace
id|spin_unlock
c_func
(paren
op_amp
id|chip-&gt;ac97_lock
)paren
suffix:semicolon
r_return
id|res
suffix:semicolon
)brace
DECL|function|snd_intel8x0_codec_read_test
r_static
r_void
id|snd_intel8x0_codec_read_test
c_func
(paren
id|intel8x0_t
op_star
id|chip
comma
r_int
r_int
id|codec
)paren
(brace
r_int
r_int
id|tmp
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|chip-&gt;ac97_lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|snd_intel8x0_codec_semaphore
c_func
(paren
id|chip
comma
id|codec
)paren
op_ge
l_int|0
)paren
(brace
id|iagetword
c_func
(paren
id|chip
comma
id|codec
op_star
l_int|0x80
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|tmp
op_assign
id|igetdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|GLOB_STA
)paren
)paren
)paren
op_amp
id|ICH_RCS
)paren
(brace
multiline_comment|/* reset RCS and preserve other R/WC bits */
id|iputdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|GLOB_STA
)paren
comma
id|tmp
op_amp
op_complement
(paren
id|ICH_SRI
op_or
id|ICH_PRI
op_or
id|ICH_TRI
op_or
id|ICH_GSCI
)paren
)paren
suffix:semicolon
)brace
)brace
id|spin_unlock
c_func
(paren
op_amp
id|chip-&gt;ac97_lock
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * access to AC97 for Ali5455&n; */
DECL|function|snd_intel8x0_ali_codec_ready
r_static
r_int
id|snd_intel8x0_ali_codec_ready
c_func
(paren
id|intel8x0_t
op_star
id|chip
comma
r_int
id|mask
)paren
(brace
r_int
id|count
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|count
op_assign
l_int|0
suffix:semicolon
id|count
OL
l_int|0x7f
suffix:semicolon
id|count
op_increment
)paren
(brace
r_int
id|val
op_assign
id|igetbyte
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|ALI_CSPSR
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|val
op_amp
id|mask
)paren
r_return
l_int|0
suffix:semicolon
)brace
id|snd_printd
c_func
(paren
id|KERN_WARNING
l_string|&quot;intel8x0: AC97 codec ready timeout.&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
DECL|function|snd_intel8x0_ali_codec_semaphore
r_static
r_int
id|snd_intel8x0_ali_codec_semaphore
c_func
(paren
id|intel8x0_t
op_star
id|chip
)paren
(brace
r_int
id|time
op_assign
l_int|100
suffix:semicolon
r_while
c_loop
(paren
id|time
op_decrement
op_logical_and
(paren
id|igetdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|ALI_CAS
)paren
)paren
op_amp
id|ALI_CAS_SEM_BUSY
)paren
)paren
id|udelay
c_func
(paren
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|time
)paren
id|snd_printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;ali_codec_semaphore timeout&bslash;n&quot;
)paren
suffix:semicolon
r_return
id|snd_intel8x0_ali_codec_ready
c_func
(paren
id|chip
comma
id|ALI_CSPSR_CODEC_READY
)paren
suffix:semicolon
)brace
DECL|function|snd_intel8x0_ali_codec_read
r_static
r_int
r_int
id|snd_intel8x0_ali_codec_read
c_func
(paren
id|ac97_t
op_star
id|ac97
comma
r_int
r_int
id|reg
)paren
(brace
id|intel8x0_t
op_star
id|chip
op_assign
id|ac97-&gt;private_data
suffix:semicolon
r_int
r_int
id|data
op_assign
l_int|0xffff
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|chip-&gt;ac97_lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|snd_intel8x0_ali_codec_semaphore
c_func
(paren
id|chip
)paren
)paren
r_goto
id|__err
suffix:semicolon
id|reg
op_or_assign
id|ALI_CPR_ADDR_READ
suffix:semicolon
r_if
c_cond
(paren
id|ac97-&gt;num
)paren
id|reg
op_or_assign
id|ALI_CPR_ADDR_SECONDARY
suffix:semicolon
id|iputword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|ALI_CPR_ADDR
)paren
comma
id|reg
)paren
suffix:semicolon
r_if
c_cond
(paren
id|snd_intel8x0_ali_codec_ready
c_func
(paren
id|chip
comma
id|ALI_CSPSR_READ_OK
)paren
)paren
r_goto
id|__err
suffix:semicolon
id|data
op_assign
id|igetword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|ALI_SPR
)paren
)paren
suffix:semicolon
id|__err
suffix:colon
id|spin_unlock
c_func
(paren
op_amp
id|chip-&gt;ac97_lock
)paren
suffix:semicolon
r_return
id|data
suffix:semicolon
)brace
DECL|function|snd_intel8x0_ali_codec_write
r_static
r_void
id|snd_intel8x0_ali_codec_write
c_func
(paren
id|ac97_t
op_star
id|ac97
comma
r_int
r_int
id|reg
comma
r_int
r_int
id|val
)paren
(brace
id|intel8x0_t
op_star
id|chip
op_assign
id|ac97-&gt;private_data
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|chip-&gt;ac97_lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|snd_intel8x0_ali_codec_semaphore
c_func
(paren
id|chip
)paren
)paren
(brace
id|spin_unlock
c_func
(paren
op_amp
id|chip-&gt;ac97_lock
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|iputword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|ALI_CPR
)paren
comma
id|val
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ac97-&gt;num
)paren
id|reg
op_or_assign
id|ALI_CPR_ADDR_SECONDARY
suffix:semicolon
id|iputword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|ALI_CPR_ADDR
)paren
comma
id|reg
)paren
suffix:semicolon
id|snd_intel8x0_ali_codec_ready
c_func
(paren
id|chip
comma
id|ALI_CSPSR_WRITE_OK
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|chip-&gt;ac97_lock
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * DMA I/O&n; */
DECL|function|snd_intel8x0_setup_periods
r_static
r_void
id|snd_intel8x0_setup_periods
c_func
(paren
id|intel8x0_t
op_star
id|chip
comma
id|ichdev_t
op_star
id|ichdev
)paren
(brace
r_int
id|idx
suffix:semicolon
id|u32
op_star
id|bdbar
op_assign
id|ichdev-&gt;bdbar
suffix:semicolon
r_int
r_int
id|port
op_assign
id|ichdev-&gt;reg_offset
suffix:semicolon
id|iputdword
c_func
(paren
id|chip
comma
id|port
op_plus
id|ICH_REG_OFF_BDBAR
comma
id|ichdev-&gt;bdbar_addr
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ichdev-&gt;size
op_eq
id|ichdev-&gt;fragsize
)paren
(brace
id|ichdev-&gt;ack_reload
op_assign
id|ichdev-&gt;ack
op_assign
l_int|2
suffix:semicolon
id|ichdev-&gt;fragsize1
op_assign
id|ichdev-&gt;fragsize
op_rshift
l_int|1
suffix:semicolon
r_for
c_loop
(paren
id|idx
op_assign
l_int|0
suffix:semicolon
id|idx
OL
(paren
id|ICH_REG_LVI_MASK
op_plus
l_int|1
)paren
op_star
l_int|2
suffix:semicolon
id|idx
op_add_assign
l_int|4
)paren
(brace
id|bdbar
(braket
id|idx
op_plus
l_int|0
)braket
op_assign
id|cpu_to_le32
c_func
(paren
id|ichdev-&gt;physbuf
)paren
suffix:semicolon
id|bdbar
(braket
id|idx
op_plus
l_int|1
)braket
op_assign
id|cpu_to_le32
c_func
(paren
l_int|0x80000000
op_or
multiline_comment|/* interrupt on completion */
id|ichdev-&gt;fragsize1
op_rshift
id|ichdev-&gt;pos_shift
)paren
suffix:semicolon
id|bdbar
(braket
id|idx
op_plus
l_int|2
)braket
op_assign
id|cpu_to_le32
c_func
(paren
id|ichdev-&gt;physbuf
op_plus
(paren
id|ichdev-&gt;size
op_rshift
l_int|1
)paren
)paren
suffix:semicolon
id|bdbar
(braket
id|idx
op_plus
l_int|3
)braket
op_assign
id|cpu_to_le32
c_func
(paren
l_int|0x80000000
op_or
multiline_comment|/* interrupt on completion */
id|ichdev-&gt;fragsize1
op_rshift
id|ichdev-&gt;pos_shift
)paren
suffix:semicolon
)brace
id|ichdev-&gt;frags
op_assign
l_int|2
suffix:semicolon
)brace
r_else
(brace
id|ichdev-&gt;ack_reload
op_assign
id|ichdev-&gt;ack
op_assign
l_int|1
suffix:semicolon
id|ichdev-&gt;fragsize1
op_assign
id|ichdev-&gt;fragsize
suffix:semicolon
r_for
c_loop
(paren
id|idx
op_assign
l_int|0
suffix:semicolon
id|idx
OL
(paren
id|ICH_REG_LVI_MASK
op_plus
l_int|1
)paren
op_star
l_int|2
suffix:semicolon
id|idx
op_add_assign
l_int|2
)paren
(brace
id|bdbar
(braket
id|idx
op_plus
l_int|0
)braket
op_assign
id|cpu_to_le32
c_func
(paren
id|ichdev-&gt;physbuf
op_plus
(paren
(paren
(paren
id|idx
op_rshift
l_int|1
)paren
op_star
id|ichdev-&gt;fragsize
)paren
op_mod
id|ichdev-&gt;size
)paren
)paren
suffix:semicolon
id|bdbar
(braket
id|idx
op_plus
l_int|1
)braket
op_assign
id|cpu_to_le32
c_func
(paren
l_int|0x80000000
op_or
multiline_comment|/* interrupt on completion */
id|ichdev-&gt;fragsize
op_rshift
id|ichdev-&gt;pos_shift
)paren
suffix:semicolon
singleline_comment|// printk(&quot;bdbar[%i] = 0x%x [0x%x]&bslash;n&quot;, idx + 0, bdbar[idx + 0], bdbar[idx + 1]);
)brace
id|ichdev-&gt;frags
op_assign
id|ichdev-&gt;size
op_div
id|ichdev-&gt;fragsize
suffix:semicolon
)brace
id|iputbyte
c_func
(paren
id|chip
comma
id|port
op_plus
id|ICH_REG_OFF_LVI
comma
id|ichdev-&gt;lvi
op_assign
id|ICH_REG_LVI_MASK
)paren
suffix:semicolon
id|ichdev-&gt;civ
op_assign
l_int|0
suffix:semicolon
id|iputbyte
c_func
(paren
id|chip
comma
id|port
op_plus
id|ICH_REG_OFF_CIV
comma
l_int|0
)paren
suffix:semicolon
id|ichdev-&gt;lvi_frag
op_assign
id|ICH_REG_LVI_MASK
op_mod
id|ichdev-&gt;frags
suffix:semicolon
id|ichdev-&gt;position
op_assign
l_int|0
suffix:semicolon
macro_line|#if 0
id|printk
c_func
(paren
l_string|&quot;lvi_frag = %i, frags = %i, period_size = 0x%x, period_size1 = 0x%x&bslash;n&quot;
comma
id|ichdev-&gt;lvi_frag
comma
id|ichdev-&gt;frags
comma
id|ichdev-&gt;fragsize
comma
id|ichdev-&gt;fragsize1
)paren
suffix:semicolon
macro_line|#endif
multiline_comment|/* clear interrupts */
id|iputbyte
c_func
(paren
id|chip
comma
id|port
op_plus
id|ichdev-&gt;roff_sr
comma
id|ICH_FIFOE
op_or
id|ICH_BCIS
op_or
id|ICH_LVBCI
)paren
suffix:semicolon
)brace
macro_line|#ifdef __i386__
multiline_comment|/*&n; * Intel 82443MX running a 100MHz processor system bus has a hardware bug,&n; * which aborts PCI busmaster for audio transfer.  A workaround is to set&n; * the pages as non-cached.  For details, see the errata in&n; *&t;http://www.intel.com/design/chipsets/specupdt/245051.htm&n; */
DECL|function|fill_nocache
r_static
r_void
id|fill_nocache
c_func
(paren
r_void
op_star
id|buf
comma
r_int
id|size
comma
r_int
id|nocache
)paren
(brace
id|size
op_assign
(paren
id|size
op_plus
id|PAGE_SIZE
op_minus
l_int|1
)paren
op_rshift
id|PAGE_SHIFT
suffix:semicolon
id|change_page_attr
c_func
(paren
id|virt_to_page
c_func
(paren
id|buf
)paren
comma
id|size
comma
id|nocache
ques
c_cond
id|PAGE_KERNEL_NOCACHE
suffix:colon
id|PAGE_KERNEL
)paren
suffix:semicolon
id|global_flush_tlb
c_func
(paren
)paren
suffix:semicolon
)brace
macro_line|#else
DECL|macro|fill_nocache
mdefine_line|#define fill_nocache(buf,size,nocache)
macro_line|#endif
multiline_comment|/*&n; *  Interrupt handler&n; */
DECL|function|snd_intel8x0_update
r_static
r_inline
r_void
id|snd_intel8x0_update
c_func
(paren
id|intel8x0_t
op_star
id|chip
comma
id|ichdev_t
op_star
id|ichdev
)paren
(brace
r_int
r_int
id|port
op_assign
id|ichdev-&gt;reg_offset
suffix:semicolon
r_int
id|status
comma
id|civ
comma
id|i
comma
id|step
suffix:semicolon
r_int
id|ack
op_assign
l_int|0
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
id|status
op_assign
id|igetbyte
c_func
(paren
id|chip
comma
id|port
op_plus
id|ichdev-&gt;roff_sr
)paren
suffix:semicolon
id|civ
op_assign
id|igetbyte
c_func
(paren
id|chip
comma
id|port
op_plus
id|ICH_REG_OFF_CIV
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|status
op_amp
id|ICH_BCIS
)paren
)paren
(brace
id|step
op_assign
l_int|0
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|civ
op_eq
id|ichdev-&gt;civ
)paren
(brace
singleline_comment|// snd_printd(&quot;civ same %d&bslash;n&quot;, civ);
id|step
op_assign
l_int|1
suffix:semicolon
id|ichdev-&gt;civ
op_increment
suffix:semicolon
id|ichdev-&gt;civ
op_and_assign
id|ICH_REG_LVI_MASK
suffix:semicolon
)brace
r_else
(brace
id|step
op_assign
id|civ
op_minus
id|ichdev-&gt;civ
suffix:semicolon
r_if
c_cond
(paren
id|step
OL
l_int|0
)paren
id|step
op_add_assign
id|ICH_REG_LVI_MASK
op_plus
l_int|1
suffix:semicolon
singleline_comment|// if (step != 1)
singleline_comment|//&t;snd_printd(&quot;step = %d, %d -&gt; %d&bslash;n&quot;, step, ichdev-&gt;civ, civ);
id|ichdev-&gt;civ
op_assign
id|civ
suffix:semicolon
)brace
id|ichdev-&gt;position
op_add_assign
id|step
op_star
id|ichdev-&gt;fragsize1
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|chip-&gt;in_measurement
)paren
id|ichdev-&gt;position
op_mod_assign
id|ichdev-&gt;size
suffix:semicolon
id|ichdev-&gt;lvi
op_add_assign
id|step
suffix:semicolon
id|ichdev-&gt;lvi
op_and_assign
id|ICH_REG_LVI_MASK
suffix:semicolon
id|iputbyte
c_func
(paren
id|chip
comma
id|port
op_plus
id|ICH_REG_OFF_LVI
comma
id|ichdev-&gt;lvi
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|step
suffix:semicolon
id|i
op_increment
)paren
(brace
id|ichdev-&gt;lvi_frag
op_increment
suffix:semicolon
id|ichdev-&gt;lvi_frag
op_mod_assign
id|ichdev-&gt;frags
suffix:semicolon
id|ichdev-&gt;bdbar
(braket
id|ichdev-&gt;lvi
op_star
l_int|2
)braket
op_assign
id|cpu_to_le32
c_func
(paren
id|ichdev-&gt;physbuf
op_plus
id|ichdev-&gt;lvi_frag
op_star
id|ichdev-&gt;fragsize1
)paren
suffix:semicolon
singleline_comment|// printk(&quot;new: bdbar[%i] = 0x%x [0x%x], prefetch = %i, all = 0x%x, 0x%x&bslash;n&quot;, ichdev-&gt;lvi * 2, ichdev-&gt;bdbar[ichdev-&gt;lvi * 2], ichdev-&gt;bdbar[ichdev-&gt;lvi * 2 + 1], inb(ICH_REG_OFF_PIV + port), inl(port + 4), inb(port + ICH_REG_OFF_CR));
r_if
c_cond
(paren
op_decrement
id|ichdev-&gt;ack
op_eq
l_int|0
)paren
(brace
id|ichdev-&gt;ack
op_assign
id|ichdev-&gt;ack_reload
suffix:semicolon
id|ack
op_assign
l_int|1
suffix:semicolon
)brace
)brace
id|spin_unlock
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ack
op_logical_and
id|ichdev-&gt;substream
)paren
(brace
id|snd_pcm_period_elapsed
c_func
(paren
id|ichdev-&gt;substream
)paren
suffix:semicolon
)brace
id|iputbyte
c_func
(paren
id|chip
comma
id|port
op_plus
id|ichdev-&gt;roff_sr
comma
id|status
op_amp
(paren
id|ICH_FIFOE
op_or
id|ICH_BCIS
op_or
id|ICH_LVBCI
)paren
)paren
suffix:semicolon
)brace
DECL|function|snd_intel8x0_interrupt
r_static
id|irqreturn_t
id|snd_intel8x0_interrupt
c_func
(paren
r_int
id|irq
comma
r_void
op_star
id|dev_id
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|intel8x0_t
op_star
id|chip
op_assign
id|dev_id
suffix:semicolon
id|ichdev_t
op_star
id|ichdev
suffix:semicolon
r_int
r_int
id|status
suffix:semicolon
r_int
r_int
id|i
suffix:semicolon
id|status
op_assign
id|igetdword
c_func
(paren
id|chip
comma
id|chip-&gt;int_sta_reg
)paren
suffix:semicolon
r_if
c_cond
(paren
id|status
op_eq
l_int|0xffffffff
)paren
multiline_comment|/* we are not yet resumed */
r_return
id|IRQ_NONE
suffix:semicolon
r_if
c_cond
(paren
(paren
id|status
op_amp
id|chip-&gt;int_sta_mask
)paren
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|status
)paren
(brace
multiline_comment|/* ack */
id|iputdword
c_func
(paren
id|chip
comma
id|chip-&gt;int_sta_reg
comma
id|status
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|chip-&gt;buggy_irq
)paren
id|status
op_assign
l_int|0
suffix:semicolon
)brace
r_return
id|IRQ_RETVAL
c_func
(paren
id|status
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|chip-&gt;bdbars_count
suffix:semicolon
id|i
op_increment
)paren
(brace
id|ichdev
op_assign
op_amp
id|chip-&gt;ichd
(braket
id|i
)braket
suffix:semicolon
r_if
c_cond
(paren
id|status
op_amp
id|ichdev-&gt;int_sta_mask
)paren
id|snd_intel8x0_update
c_func
(paren
id|chip
comma
id|ichdev
)paren
suffix:semicolon
)brace
multiline_comment|/* ack them */
id|iputdword
c_func
(paren
id|chip
comma
id|chip-&gt;int_sta_reg
comma
id|status
op_amp
id|chip-&gt;int_sta_mask
)paren
suffix:semicolon
r_return
id|IRQ_HANDLED
suffix:semicolon
)brace
multiline_comment|/*&n; *  PCM part&n; */
DECL|function|snd_intel8x0_pcm_trigger
r_static
r_int
id|snd_intel8x0_pcm_trigger
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|cmd
)paren
(brace
id|intel8x0_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|ichdev_t
op_star
id|ichdev
op_assign
id|get_ichdev
c_func
(paren
id|substream
)paren
suffix:semicolon
r_int
r_char
id|val
op_assign
l_int|0
suffix:semicolon
r_int
r_int
id|port
op_assign
id|ichdev-&gt;reg_offset
suffix:semicolon
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|SNDRV_PCM_TRIGGER_START
suffix:colon
r_case
id|SNDRV_PCM_TRIGGER_RESUME
suffix:colon
id|val
op_assign
id|ICH_IOCE
op_or
id|ICH_STARTBM
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_TRIGGER_STOP
suffix:colon
r_case
id|SNDRV_PCM_TRIGGER_SUSPEND
suffix:colon
id|val
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_TRIGGER_PAUSE_PUSH
suffix:colon
id|val
op_assign
id|ICH_IOCE
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_TRIGGER_PAUSE_RELEASE
suffix:colon
id|val
op_assign
id|ICH_IOCE
op_or
id|ICH_STARTBM
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|iputbyte
c_func
(paren
id|chip
comma
id|port
op_plus
id|ICH_REG_OFF_CR
comma
id|val
)paren
suffix:semicolon
r_if
c_cond
(paren
id|cmd
op_eq
id|SNDRV_PCM_TRIGGER_STOP
)paren
(brace
multiline_comment|/* wait until DMA stopped */
r_while
c_loop
(paren
op_logical_neg
(paren
id|igetbyte
c_func
(paren
id|chip
comma
id|port
op_plus
id|ichdev-&gt;roff_sr
)paren
op_amp
id|ICH_DCH
)paren
)paren
suffix:semicolon
multiline_comment|/* reset whole DMA things */
id|iputbyte
c_func
(paren
id|chip
comma
id|port
op_plus
id|ICH_REG_OFF_CR
comma
id|ICH_RESETREGS
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_intel8x0_ali_trigger
r_static
r_int
id|snd_intel8x0_ali_trigger
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|cmd
)paren
(brace
id|intel8x0_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|ichdev_t
op_star
id|ichdev
op_assign
id|get_ichdev
c_func
(paren
id|substream
)paren
suffix:semicolon
r_int
r_int
id|port
op_assign
id|ichdev-&gt;reg_offset
suffix:semicolon
r_static
r_int
id|fiforeg
(braket
)braket
op_assign
(brace
id|ICHREG
c_func
(paren
id|ALI_FIFOCR1
)paren
comma
id|ICHREG
c_func
(paren
id|ALI_FIFOCR2
)paren
comma
id|ICHREG
c_func
(paren
id|ALI_FIFOCR3
)paren
)brace
suffix:semicolon
r_int
r_int
id|val
comma
id|fifo
suffix:semicolon
id|val
op_assign
id|igetdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|ALI_DMACR
)paren
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|SNDRV_PCM_TRIGGER_START
suffix:colon
r_case
id|SNDRV_PCM_TRIGGER_PAUSE_RELEASE
suffix:colon
r_case
id|SNDRV_PCM_TRIGGER_RESUME
suffix:colon
r_if
c_cond
(paren
id|substream-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_PLAYBACK
)paren
(brace
multiline_comment|/* clear FIFO for synchronization of channels */
id|fifo
op_assign
id|igetdword
c_func
(paren
id|chip
comma
id|fiforeg
(braket
id|ichdev-&gt;ali_slot
op_div
l_int|4
)braket
)paren
suffix:semicolon
id|fifo
op_and_assign
op_complement
(paren
l_int|0xff
op_lshift
(paren
id|ichdev-&gt;ali_slot
op_mod
l_int|4
)paren
)paren
suffix:semicolon
id|fifo
op_or_assign
l_int|0x83
op_lshift
(paren
id|ichdev-&gt;ali_slot
op_mod
l_int|4
)paren
suffix:semicolon
id|iputdword
c_func
(paren
id|chip
comma
id|fiforeg
(braket
id|ichdev-&gt;ali_slot
op_div
l_int|4
)braket
comma
id|fifo
)paren
suffix:semicolon
)brace
id|iputbyte
c_func
(paren
id|chip
comma
id|port
op_plus
id|ICH_REG_OFF_CR
comma
id|ICH_IOCE
)paren
suffix:semicolon
id|val
op_and_assign
op_complement
(paren
l_int|1
op_lshift
(paren
id|ichdev-&gt;ali_slot
op_plus
l_int|16
)paren
)paren
suffix:semicolon
multiline_comment|/* clear PAUSE flag */
id|iputdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|ALI_DMACR
)paren
comma
id|val
op_or
(paren
l_int|1
op_lshift
id|ichdev-&gt;ali_slot
)paren
)paren
suffix:semicolon
multiline_comment|/* start DMA */
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_TRIGGER_STOP
suffix:colon
r_case
id|SNDRV_PCM_TRIGGER_PAUSE_PUSH
suffix:colon
r_case
id|SNDRV_PCM_TRIGGER_SUSPEND
suffix:colon
id|iputdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|ALI_DMACR
)paren
comma
id|val
op_or
(paren
l_int|1
op_lshift
(paren
id|ichdev-&gt;ali_slot
op_plus
l_int|16
)paren
)paren
)paren
suffix:semicolon
multiline_comment|/* pause */
id|iputbyte
c_func
(paren
id|chip
comma
id|port
op_plus
id|ICH_REG_OFF_CR
comma
l_int|0
)paren
suffix:semicolon
r_while
c_loop
(paren
id|igetbyte
c_func
(paren
id|chip
comma
id|port
op_plus
id|ICH_REG_OFF_CR
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|cmd
op_eq
id|SNDRV_PCM_TRIGGER_PAUSE_PUSH
)paren
r_break
suffix:semicolon
multiline_comment|/* reset whole DMA things */
id|iputbyte
c_func
(paren
id|chip
comma
id|port
op_plus
id|ICH_REG_OFF_CR
comma
id|ICH_RESETREGS
)paren
suffix:semicolon
multiline_comment|/* clear interrupts */
id|iputbyte
c_func
(paren
id|chip
comma
id|port
op_plus
id|ICH_REG_OFF_SR
comma
id|igetbyte
c_func
(paren
id|chip
comma
id|port
op_plus
id|ICH_REG_OFF_SR
)paren
op_or
l_int|0x1e
)paren
suffix:semicolon
id|iputdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|ALI_INTERRUPTSR
)paren
comma
id|igetdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|ALI_INTERRUPTSR
)paren
)paren
op_amp
id|ichdev-&gt;int_sta_mask
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_intel8x0_hw_params
r_static
r_int
id|snd_intel8x0_hw_params
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_hw_params_t
op_star
id|hw_params
)paren
(brace
id|intel8x0_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|ichdev_t
op_star
id|ichdev
op_assign
id|get_ichdev
c_func
(paren
id|substream
)paren
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_int
id|dbl
op_assign
id|params_rate
c_func
(paren
id|hw_params
)paren
OG
l_int|48000
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;fix_nocache
op_logical_and
id|ichdev-&gt;page_attr_changed
)paren
(brace
id|fill_nocache
c_func
(paren
id|runtime-&gt;dma_area
comma
id|runtime-&gt;dma_bytes
comma
l_int|0
)paren
suffix:semicolon
multiline_comment|/* clear */
id|ichdev-&gt;page_attr_changed
op_assign
l_int|0
suffix:semicolon
)brace
id|err
op_assign
id|snd_pcm_lib_malloc_pages
c_func
(paren
id|substream
comma
id|params_buffer_bytes
c_func
(paren
id|hw_params
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;fix_nocache
)paren
(brace
r_if
c_cond
(paren
id|runtime-&gt;dma_area
op_logical_and
op_logical_neg
id|ichdev-&gt;page_attr_changed
)paren
(brace
id|fill_nocache
c_func
(paren
id|runtime-&gt;dma_area
comma
id|runtime-&gt;dma_bytes
comma
l_int|1
)paren
suffix:semicolon
id|ichdev-&gt;page_attr_changed
op_assign
l_int|1
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|ichdev-&gt;pcm_open_flag
)paren
(brace
id|snd_ac97_pcm_close
c_func
(paren
id|ichdev-&gt;pcm
)paren
suffix:semicolon
id|ichdev-&gt;pcm_open_flag
op_assign
l_int|0
suffix:semicolon
)brace
id|err
op_assign
id|snd_ac97_pcm_open
c_func
(paren
id|ichdev-&gt;pcm
comma
id|params_rate
c_func
(paren
id|hw_params
)paren
comma
id|params_channels
c_func
(paren
id|hw_params
)paren
comma
id|ichdev-&gt;pcm-&gt;r
(braket
id|dbl
)braket
dot
id|slots
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
op_ge
l_int|0
)paren
(brace
id|ichdev-&gt;pcm_open_flag
op_assign
l_int|1
suffix:semicolon
multiline_comment|/* Force SPDIF setting */
r_if
c_cond
(paren
id|ichdev-&gt;ichd
op_eq
id|ICHD_PCMOUT
op_logical_and
id|chip-&gt;spdif_idx
OL
l_int|0
)paren
id|snd_ac97_set_rate
c_func
(paren
id|ichdev-&gt;pcm-&gt;r
(braket
l_int|0
)braket
dot
id|codec
(braket
l_int|0
)braket
comma
id|AC97_SPDIF
comma
id|params_rate
c_func
(paren
id|hw_params
)paren
)paren
suffix:semicolon
)brace
r_return
id|err
suffix:semicolon
)brace
DECL|function|snd_intel8x0_hw_free
r_static
r_int
id|snd_intel8x0_hw_free
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|intel8x0_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|ichdev_t
op_star
id|ichdev
op_assign
id|get_ichdev
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ichdev-&gt;pcm_open_flag
)paren
(brace
id|snd_ac97_pcm_close
c_func
(paren
id|ichdev-&gt;pcm
)paren
suffix:semicolon
id|ichdev-&gt;pcm_open_flag
op_assign
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|chip-&gt;fix_nocache
op_logical_and
id|ichdev-&gt;page_attr_changed
)paren
(brace
id|fill_nocache
c_func
(paren
id|substream-&gt;runtime-&gt;dma_area
comma
id|substream-&gt;runtime-&gt;dma_bytes
comma
l_int|0
)paren
suffix:semicolon
id|ichdev-&gt;page_attr_changed
op_assign
l_int|0
suffix:semicolon
)brace
r_return
id|snd_pcm_lib_free_pages
c_func
(paren
id|substream
)paren
suffix:semicolon
)brace
DECL|function|snd_intel8x0_setup_pcm_out
r_static
r_void
id|snd_intel8x0_setup_pcm_out
c_func
(paren
id|intel8x0_t
op_star
id|chip
comma
id|snd_pcm_runtime_t
op_star
id|runtime
)paren
(brace
r_int
r_int
id|cnt
suffix:semicolon
r_int
id|dbl
op_assign
id|runtime-&gt;rate
OG
l_int|48000
suffix:semicolon
r_switch
c_cond
(paren
id|chip-&gt;device_type
)paren
(brace
r_case
id|DEVICE_ALI
suffix:colon
id|cnt
op_assign
id|igetdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|ALI_SCR
)paren
)paren
suffix:semicolon
id|cnt
op_and_assign
op_complement
id|ICH_ALI_SC_PCM_246_MASK
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;channels
op_eq
l_int|4
op_logical_or
id|dbl
)paren
id|cnt
op_or_assign
id|ICH_ALI_SC_PCM_4
suffix:semicolon
r_else
r_if
c_cond
(paren
id|runtime-&gt;channels
op_eq
l_int|6
)paren
id|cnt
op_or_assign
id|ICH_ALI_SC_PCM_6
suffix:semicolon
id|iputdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|ALI_SCR
)paren
comma
id|cnt
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|DEVICE_SIS
suffix:colon
id|cnt
op_assign
id|igetdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|GLOB_CNT
)paren
)paren
suffix:semicolon
id|cnt
op_and_assign
op_complement
id|ICH_SIS_PCM_246_MASK
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;channels
op_eq
l_int|4
op_logical_or
id|dbl
)paren
id|cnt
op_or_assign
id|ICH_SIS_PCM_4
suffix:semicolon
r_else
r_if
c_cond
(paren
id|runtime-&gt;channels
op_eq
l_int|6
)paren
id|cnt
op_or_assign
id|ICH_SIS_PCM_6
suffix:semicolon
id|iputdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|GLOB_CNT
)paren
comma
id|cnt
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|cnt
op_assign
id|igetdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|GLOB_CNT
)paren
)paren
suffix:semicolon
id|cnt
op_and_assign
op_complement
(paren
id|ICH_PCM_246_MASK
op_or
id|ICH_PCM_20BIT
)paren
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;channels
op_eq
l_int|4
op_logical_or
id|dbl
)paren
id|cnt
op_or_assign
id|ICH_PCM_4
suffix:semicolon
r_else
r_if
c_cond
(paren
id|runtime-&gt;channels
op_eq
l_int|6
)paren
id|cnt
op_or_assign
id|ICH_PCM_6
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;device_type
op_eq
id|DEVICE_NFORCE
)paren
(brace
multiline_comment|/* reset to 2ch once to keep the 6 channel data in alignment,&n;&t;&t;&t; * to start from Front Left always&n;&t;&t;&t; */
r_if
c_cond
(paren
id|cnt
op_amp
id|ICH_PCM_246_MASK
)paren
(brace
id|iputdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|GLOB_CNT
)paren
comma
id|cnt
op_amp
op_complement
id|ICH_PCM_246_MASK
)paren
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
id|msleep
c_func
(paren
l_int|50
)paren
suffix:semicolon
multiline_comment|/* grrr... */
id|spin_lock_irq
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|chip-&gt;device_type
op_eq
id|DEVICE_INTEL_ICH4
)paren
(brace
r_if
c_cond
(paren
id|runtime-&gt;sample_bits
OG
l_int|16
)paren
id|cnt
op_or_assign
id|ICH_PCM_20BIT
suffix:semicolon
)brace
id|iputdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|GLOB_CNT
)paren
comma
id|cnt
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
DECL|function|snd_intel8x0_pcm_prepare
r_static
r_int
id|snd_intel8x0_pcm_prepare
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|intel8x0_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|ichdev_t
op_star
id|ichdev
op_assign
id|get_ichdev
c_func
(paren
id|substream
)paren
suffix:semicolon
id|ichdev-&gt;physbuf
op_assign
id|runtime-&gt;dma_addr
suffix:semicolon
id|ichdev-&gt;size
op_assign
id|snd_pcm_lib_buffer_bytes
c_func
(paren
id|substream
)paren
suffix:semicolon
id|ichdev-&gt;fragsize
op_assign
id|snd_pcm_lib_period_bytes
c_func
(paren
id|substream
)paren
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ichdev-&gt;ichd
op_eq
id|ICHD_PCMOUT
)paren
(brace
id|snd_intel8x0_setup_pcm_out
c_func
(paren
id|chip
comma
id|runtime
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;device_type
op_eq
id|DEVICE_INTEL_ICH4
)paren
(brace
id|ichdev-&gt;pos_shift
op_assign
(paren
id|runtime-&gt;sample_bits
OG
l_int|16
)paren
ques
c_cond
l_int|2
suffix:colon
l_int|1
suffix:semicolon
)brace
)brace
id|snd_intel8x0_setup_periods
c_func
(paren
id|chip
comma
id|ichdev
)paren
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_intel8x0_pcm_pointer
r_static
id|snd_pcm_uframes_t
id|snd_intel8x0_pcm_pointer
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|intel8x0_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|ichdev_t
op_star
id|ichdev
op_assign
id|get_ichdev
c_func
(paren
id|substream
)paren
suffix:semicolon
r_int
id|ptr1
comma
id|ptr
suffix:semicolon
r_int
id|civ
comma
id|timeout
op_assign
l_int|10
suffix:semicolon
r_int
r_int
id|position
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
r_do
(brace
id|civ
op_assign
id|igetbyte
c_func
(paren
id|chip
comma
id|ichdev-&gt;reg_offset
op_plus
id|ICH_REG_OFF_CIV
)paren
suffix:semicolon
id|ptr1
op_assign
id|igetword
c_func
(paren
id|chip
comma
id|ichdev-&gt;reg_offset
op_plus
id|ichdev-&gt;roff_picb
)paren
suffix:semicolon
id|position
op_assign
id|ichdev-&gt;position
suffix:semicolon
r_if
c_cond
(paren
id|ptr1
op_eq
l_int|0
)paren
id|udelay
c_func
(paren
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|civ
op_eq
id|igetbyte
c_func
(paren
id|chip
comma
id|ichdev-&gt;reg_offset
op_plus
id|ICH_REG_OFF_CIV
)paren
op_logical_and
id|ptr1
op_eq
id|igetword
c_func
(paren
id|chip
comma
id|ichdev-&gt;reg_offset
op_plus
id|ichdev-&gt;roff_picb
)paren
)paren
r_break
suffix:semicolon
)brace
r_while
c_loop
(paren
id|timeout
op_decrement
)paren
suffix:semicolon
id|ptr1
op_lshift_assign
id|ichdev-&gt;pos_shift
suffix:semicolon
id|ptr
op_assign
id|ichdev-&gt;fragsize1
op_minus
id|ptr1
suffix:semicolon
id|ptr
op_add_assign
id|position
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ptr
op_ge
id|ichdev-&gt;size
)paren
r_return
l_int|0
suffix:semicolon
r_return
id|bytes_to_frames
c_func
(paren
id|substream-&gt;runtime
comma
id|ptr
)paren
suffix:semicolon
)brace
DECL|variable|snd_intel8x0_stream
r_static
id|snd_pcm_hardware_t
id|snd_intel8x0_stream
op_assign
(brace
dot
id|info
op_assign
(paren
id|SNDRV_PCM_INFO_MMAP
op_or
id|SNDRV_PCM_INFO_INTERLEAVED
op_or
id|SNDRV_PCM_INFO_BLOCK_TRANSFER
op_or
id|SNDRV_PCM_INFO_MMAP_VALID
op_or
id|SNDRV_PCM_INFO_PAUSE
op_or
id|SNDRV_PCM_INFO_RESUME
)paren
comma
dot
id|formats
op_assign
id|SNDRV_PCM_FMTBIT_S16_LE
comma
dot
id|rates
op_assign
id|SNDRV_PCM_RATE_48000
comma
dot
id|rate_min
op_assign
l_int|48000
comma
dot
id|rate_max
op_assign
l_int|48000
comma
dot
id|channels_min
op_assign
l_int|2
comma
dot
id|channels_max
op_assign
l_int|2
comma
dot
id|buffer_bytes_max
op_assign
l_int|128
op_star
l_int|1024
comma
dot
id|period_bytes_min
op_assign
l_int|32
comma
dot
id|period_bytes_max
op_assign
l_int|128
op_star
l_int|1024
comma
dot
id|periods_min
op_assign
l_int|1
comma
dot
id|periods_max
op_assign
l_int|1024
comma
dot
id|fifo_size
op_assign
l_int|0
comma
)brace
suffix:semicolon
DECL|variable|channels4
r_static
r_int
r_int
id|channels4
(braket
)braket
op_assign
(brace
l_int|2
comma
l_int|4
comma
)brace
suffix:semicolon
DECL|variable|hw_constraints_channels4
r_static
id|snd_pcm_hw_constraint_list_t
id|hw_constraints_channels4
op_assign
(brace
dot
id|count
op_assign
id|ARRAY_SIZE
c_func
(paren
id|channels4
)paren
comma
dot
id|list
op_assign
id|channels4
comma
dot
id|mask
op_assign
l_int|0
comma
)brace
suffix:semicolon
DECL|variable|channels6
r_static
r_int
r_int
id|channels6
(braket
)braket
op_assign
(brace
l_int|2
comma
l_int|4
comma
l_int|6
comma
)brace
suffix:semicolon
DECL|variable|hw_constraints_channels6
r_static
id|snd_pcm_hw_constraint_list_t
id|hw_constraints_channels6
op_assign
(brace
dot
id|count
op_assign
id|ARRAY_SIZE
c_func
(paren
id|channels6
)paren
comma
dot
id|list
op_assign
id|channels6
comma
dot
id|mask
op_assign
l_int|0
comma
)brace
suffix:semicolon
DECL|function|snd_intel8x0_pcm_open
r_static
r_int
id|snd_intel8x0_pcm_open
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|ichdev_t
op_star
id|ichdev
)paren
(brace
id|intel8x0_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_int
id|err
suffix:semicolon
id|ichdev-&gt;substream
op_assign
id|substream
suffix:semicolon
id|runtime-&gt;hw
op_assign
id|snd_intel8x0_stream
suffix:semicolon
id|runtime-&gt;hw.rates
op_assign
id|ichdev-&gt;pcm-&gt;rates
suffix:semicolon
id|snd_pcm_limit_hw_rates
c_func
(paren
id|runtime
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;device_type
op_eq
id|DEVICE_SIS
)paren
(brace
id|runtime-&gt;hw.buffer_bytes_max
op_assign
l_int|64
op_star
l_int|1024
suffix:semicolon
id|runtime-&gt;hw.period_bytes_max
op_assign
l_int|64
op_star
l_int|1024
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_pcm_hw_constraint_integer
c_func
(paren
id|runtime
comma
id|SNDRV_PCM_HW_PARAM_PERIODS
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|runtime-&gt;private_data
op_assign
id|ichdev
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_intel8x0_playback_open
r_static
r_int
id|snd_intel8x0_playback_open
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|intel8x0_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_int
id|err
suffix:semicolon
id|err
op_assign
id|snd_intel8x0_pcm_open
c_func
(paren
id|substream
comma
op_amp
id|chip-&gt;ichd
(braket
id|ICHD_PCMOUT
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;multi6
)paren
(brace
id|runtime-&gt;hw.channels_max
op_assign
l_int|6
suffix:semicolon
id|snd_pcm_hw_constraint_list
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
comma
op_amp
id|hw_constraints_channels6
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|chip-&gt;multi4
)paren
(brace
id|runtime-&gt;hw.channels_max
op_assign
l_int|4
suffix:semicolon
id|snd_pcm_hw_constraint_list
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
comma
op_amp
id|hw_constraints_channels4
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|chip-&gt;dra
)paren
(brace
id|snd_ac97_pcm_double_rate_rules
c_func
(paren
id|runtime
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|chip-&gt;smp20bit
)paren
(brace
id|runtime-&gt;hw.formats
op_or_assign
id|SNDRV_PCM_FMTBIT_S32_LE
suffix:semicolon
id|snd_pcm_hw_constraint_msbits
c_func
(paren
id|runtime
comma
l_int|0
comma
l_int|32
comma
l_int|20
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_intel8x0_playback_close
r_static
r_int
id|snd_intel8x0_playback_close
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|intel8x0_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|chip-&gt;ichd
(braket
id|ICHD_PCMOUT
)braket
dot
id|substream
op_assign
l_int|NULL
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_intel8x0_capture_open
r_static
r_int
id|snd_intel8x0_capture_open
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|intel8x0_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
r_return
id|snd_intel8x0_pcm_open
c_func
(paren
id|substream
comma
op_amp
id|chip-&gt;ichd
(braket
id|ICHD_PCMIN
)braket
)paren
suffix:semicolon
)brace
DECL|function|snd_intel8x0_capture_close
r_static
r_int
id|snd_intel8x0_capture_close
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|intel8x0_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|chip-&gt;ichd
(braket
id|ICHD_PCMIN
)braket
dot
id|substream
op_assign
l_int|NULL
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_intel8x0_mic_open
r_static
r_int
id|snd_intel8x0_mic_open
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|intel8x0_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
r_return
id|snd_intel8x0_pcm_open
c_func
(paren
id|substream
comma
op_amp
id|chip-&gt;ichd
(braket
id|ICHD_MIC
)braket
)paren
suffix:semicolon
)brace
DECL|function|snd_intel8x0_mic_close
r_static
r_int
id|snd_intel8x0_mic_close
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|intel8x0_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|chip-&gt;ichd
(braket
id|ICHD_MIC
)braket
dot
id|substream
op_assign
l_int|NULL
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_intel8x0_mic2_open
r_static
r_int
id|snd_intel8x0_mic2_open
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|intel8x0_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
r_return
id|snd_intel8x0_pcm_open
c_func
(paren
id|substream
comma
op_amp
id|chip-&gt;ichd
(braket
id|ICHD_MIC2
)braket
)paren
suffix:semicolon
)brace
DECL|function|snd_intel8x0_mic2_close
r_static
r_int
id|snd_intel8x0_mic2_close
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|intel8x0_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|chip-&gt;ichd
(braket
id|ICHD_MIC2
)braket
dot
id|substream
op_assign
l_int|NULL
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_intel8x0_capture2_open
r_static
r_int
id|snd_intel8x0_capture2_open
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|intel8x0_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
r_return
id|snd_intel8x0_pcm_open
c_func
(paren
id|substream
comma
op_amp
id|chip-&gt;ichd
(braket
id|ICHD_PCM2IN
)braket
)paren
suffix:semicolon
)brace
DECL|function|snd_intel8x0_capture2_close
r_static
r_int
id|snd_intel8x0_capture2_close
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|intel8x0_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|chip-&gt;ichd
(braket
id|ICHD_PCM2IN
)braket
dot
id|substream
op_assign
l_int|NULL
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_intel8x0_spdif_open
r_static
r_int
id|snd_intel8x0_spdif_open
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|intel8x0_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
r_int
id|idx
op_assign
id|chip-&gt;device_type
op_eq
id|DEVICE_NFORCE
ques
c_cond
id|NVD_SPBAR
suffix:colon
id|ICHD_SPBAR
suffix:semicolon
r_return
id|snd_intel8x0_pcm_open
c_func
(paren
id|substream
comma
op_amp
id|chip-&gt;ichd
(braket
id|idx
)braket
)paren
suffix:semicolon
)brace
DECL|function|snd_intel8x0_spdif_close
r_static
r_int
id|snd_intel8x0_spdif_close
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|intel8x0_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
r_int
id|idx
op_assign
id|chip-&gt;device_type
op_eq
id|DEVICE_NFORCE
ques
c_cond
id|NVD_SPBAR
suffix:colon
id|ICHD_SPBAR
suffix:semicolon
id|chip-&gt;ichd
(braket
id|idx
)braket
dot
id|substream
op_assign
l_int|NULL
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_intel8x0_ali_ac97spdifout_open
r_static
r_int
id|snd_intel8x0_ali_ac97spdifout_open
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|intel8x0_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
r_int
r_int
id|val
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
id|val
op_assign
id|igetdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|ALI_INTERFACECR
)paren
)paren
suffix:semicolon
id|val
op_or_assign
id|ICH_ALI_IF_AC97SP
suffix:semicolon
id|iputdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|ALI_INTERFACECR
)paren
comma
id|val
)paren
suffix:semicolon
multiline_comment|/* also needs to set ALI_SC_CODEC_SPDF correctly */
id|spin_unlock_irq
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
r_return
id|snd_intel8x0_pcm_open
c_func
(paren
id|substream
comma
op_amp
id|chip-&gt;ichd
(braket
id|ALID_AC97SPDIFOUT
)braket
)paren
suffix:semicolon
)brace
DECL|function|snd_intel8x0_ali_ac97spdifout_close
r_static
r_int
id|snd_intel8x0_ali_ac97spdifout_close
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|intel8x0_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
r_int
r_int
id|val
suffix:semicolon
id|chip-&gt;ichd
(braket
id|ALID_AC97SPDIFOUT
)braket
dot
id|substream
op_assign
l_int|NULL
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
id|val
op_assign
id|igetdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|ALI_INTERFACECR
)paren
)paren
suffix:semicolon
id|val
op_and_assign
op_complement
id|ICH_ALI_IF_AC97SP
suffix:semicolon
id|iputdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|ALI_INTERFACECR
)paren
comma
id|val
)paren
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_intel8x0_ali_spdifin_open
r_static
r_int
id|snd_intel8x0_ali_spdifin_open
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|intel8x0_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
r_return
id|snd_intel8x0_pcm_open
c_func
(paren
id|substream
comma
op_amp
id|chip-&gt;ichd
(braket
id|ALID_SPDIFIN
)braket
)paren
suffix:semicolon
)brace
DECL|function|snd_intel8x0_ali_spdifin_close
r_static
r_int
id|snd_intel8x0_ali_spdifin_close
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|intel8x0_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|chip-&gt;ichd
(braket
id|ALID_SPDIFIN
)braket
dot
id|substream
op_assign
l_int|NULL
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#if 0 
singleline_comment|// NYI
r_static
r_int
id|snd_intel8x0_ali_spdifout_open
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|intel8x0_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
r_return
id|snd_intel8x0_pcm_open
c_func
(paren
id|substream
comma
op_amp
id|chip-&gt;ichd
(braket
id|ALID_SPDIFOUT
)braket
)paren
suffix:semicolon
)brace
r_static
r_int
id|snd_intel8x0_ali_spdifout_close
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|intel8x0_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|chip-&gt;ichd
(braket
id|ALID_SPDIFOUT
)braket
dot
id|substream
op_assign
l_int|NULL
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#endif
DECL|variable|snd_intel8x0_playback_ops
r_static
id|snd_pcm_ops_t
id|snd_intel8x0_playback_ops
op_assign
(brace
dot
id|open
op_assign
id|snd_intel8x0_playback_open
comma
dot
id|close
op_assign
id|snd_intel8x0_playback_close
comma
dot
id|ioctl
op_assign
id|snd_pcm_lib_ioctl
comma
dot
id|hw_params
op_assign
id|snd_intel8x0_hw_params
comma
dot
id|hw_free
op_assign
id|snd_intel8x0_hw_free
comma
dot
id|prepare
op_assign
id|snd_intel8x0_pcm_prepare
comma
dot
id|trigger
op_assign
id|snd_intel8x0_pcm_trigger
comma
dot
id|pointer
op_assign
id|snd_intel8x0_pcm_pointer
comma
)brace
suffix:semicolon
DECL|variable|snd_intel8x0_capture_ops
r_static
id|snd_pcm_ops_t
id|snd_intel8x0_capture_ops
op_assign
(brace
dot
id|open
op_assign
id|snd_intel8x0_capture_open
comma
dot
id|close
op_assign
id|snd_intel8x0_capture_close
comma
dot
id|ioctl
op_assign
id|snd_pcm_lib_ioctl
comma
dot
id|hw_params
op_assign
id|snd_intel8x0_hw_params
comma
dot
id|hw_free
op_assign
id|snd_intel8x0_hw_free
comma
dot
id|prepare
op_assign
id|snd_intel8x0_pcm_prepare
comma
dot
id|trigger
op_assign
id|snd_intel8x0_pcm_trigger
comma
dot
id|pointer
op_assign
id|snd_intel8x0_pcm_pointer
comma
)brace
suffix:semicolon
DECL|variable|snd_intel8x0_capture_mic_ops
r_static
id|snd_pcm_ops_t
id|snd_intel8x0_capture_mic_ops
op_assign
(brace
dot
id|open
op_assign
id|snd_intel8x0_mic_open
comma
dot
id|close
op_assign
id|snd_intel8x0_mic_close
comma
dot
id|ioctl
op_assign
id|snd_pcm_lib_ioctl
comma
dot
id|hw_params
op_assign
id|snd_intel8x0_hw_params
comma
dot
id|hw_free
op_assign
id|snd_intel8x0_hw_free
comma
dot
id|prepare
op_assign
id|snd_intel8x0_pcm_prepare
comma
dot
id|trigger
op_assign
id|snd_intel8x0_pcm_trigger
comma
dot
id|pointer
op_assign
id|snd_intel8x0_pcm_pointer
comma
)brace
suffix:semicolon
DECL|variable|snd_intel8x0_capture_mic2_ops
r_static
id|snd_pcm_ops_t
id|snd_intel8x0_capture_mic2_ops
op_assign
(brace
dot
id|open
op_assign
id|snd_intel8x0_mic2_open
comma
dot
id|close
op_assign
id|snd_intel8x0_mic2_close
comma
dot
id|ioctl
op_assign
id|snd_pcm_lib_ioctl
comma
dot
id|hw_params
op_assign
id|snd_intel8x0_hw_params
comma
dot
id|hw_free
op_assign
id|snd_intel8x0_hw_free
comma
dot
id|prepare
op_assign
id|snd_intel8x0_pcm_prepare
comma
dot
id|trigger
op_assign
id|snd_intel8x0_pcm_trigger
comma
dot
id|pointer
op_assign
id|snd_intel8x0_pcm_pointer
comma
)brace
suffix:semicolon
DECL|variable|snd_intel8x0_capture2_ops
r_static
id|snd_pcm_ops_t
id|snd_intel8x0_capture2_ops
op_assign
(brace
dot
id|open
op_assign
id|snd_intel8x0_capture2_open
comma
dot
id|close
op_assign
id|snd_intel8x0_capture2_close
comma
dot
id|ioctl
op_assign
id|snd_pcm_lib_ioctl
comma
dot
id|hw_params
op_assign
id|snd_intel8x0_hw_params
comma
dot
id|hw_free
op_assign
id|snd_intel8x0_hw_free
comma
dot
id|prepare
op_assign
id|snd_intel8x0_pcm_prepare
comma
dot
id|trigger
op_assign
id|snd_intel8x0_pcm_trigger
comma
dot
id|pointer
op_assign
id|snd_intel8x0_pcm_pointer
comma
)brace
suffix:semicolon
DECL|variable|snd_intel8x0_spdif_ops
r_static
id|snd_pcm_ops_t
id|snd_intel8x0_spdif_ops
op_assign
(brace
dot
id|open
op_assign
id|snd_intel8x0_spdif_open
comma
dot
id|close
op_assign
id|snd_intel8x0_spdif_close
comma
dot
id|ioctl
op_assign
id|snd_pcm_lib_ioctl
comma
dot
id|hw_params
op_assign
id|snd_intel8x0_hw_params
comma
dot
id|hw_free
op_assign
id|snd_intel8x0_hw_free
comma
dot
id|prepare
op_assign
id|snd_intel8x0_pcm_prepare
comma
dot
id|trigger
op_assign
id|snd_intel8x0_pcm_trigger
comma
dot
id|pointer
op_assign
id|snd_intel8x0_pcm_pointer
comma
)brace
suffix:semicolon
DECL|variable|snd_intel8x0_ali_playback_ops
r_static
id|snd_pcm_ops_t
id|snd_intel8x0_ali_playback_ops
op_assign
(brace
dot
id|open
op_assign
id|snd_intel8x0_playback_open
comma
dot
id|close
op_assign
id|snd_intel8x0_playback_close
comma
dot
id|ioctl
op_assign
id|snd_pcm_lib_ioctl
comma
dot
id|hw_params
op_assign
id|snd_intel8x0_hw_params
comma
dot
id|hw_free
op_assign
id|snd_intel8x0_hw_free
comma
dot
id|prepare
op_assign
id|snd_intel8x0_pcm_prepare
comma
dot
id|trigger
op_assign
id|snd_intel8x0_ali_trigger
comma
dot
id|pointer
op_assign
id|snd_intel8x0_pcm_pointer
comma
)brace
suffix:semicolon
DECL|variable|snd_intel8x0_ali_capture_ops
r_static
id|snd_pcm_ops_t
id|snd_intel8x0_ali_capture_ops
op_assign
(brace
dot
id|open
op_assign
id|snd_intel8x0_capture_open
comma
dot
id|close
op_assign
id|snd_intel8x0_capture_close
comma
dot
id|ioctl
op_assign
id|snd_pcm_lib_ioctl
comma
dot
id|hw_params
op_assign
id|snd_intel8x0_hw_params
comma
dot
id|hw_free
op_assign
id|snd_intel8x0_hw_free
comma
dot
id|prepare
op_assign
id|snd_intel8x0_pcm_prepare
comma
dot
id|trigger
op_assign
id|snd_intel8x0_ali_trigger
comma
dot
id|pointer
op_assign
id|snd_intel8x0_pcm_pointer
comma
)brace
suffix:semicolon
DECL|variable|snd_intel8x0_ali_capture_mic_ops
r_static
id|snd_pcm_ops_t
id|snd_intel8x0_ali_capture_mic_ops
op_assign
(brace
dot
id|open
op_assign
id|snd_intel8x0_mic_open
comma
dot
id|close
op_assign
id|snd_intel8x0_mic_close
comma
dot
id|ioctl
op_assign
id|snd_pcm_lib_ioctl
comma
dot
id|hw_params
op_assign
id|snd_intel8x0_hw_params
comma
dot
id|hw_free
op_assign
id|snd_intel8x0_hw_free
comma
dot
id|prepare
op_assign
id|snd_intel8x0_pcm_prepare
comma
dot
id|trigger
op_assign
id|snd_intel8x0_ali_trigger
comma
dot
id|pointer
op_assign
id|snd_intel8x0_pcm_pointer
comma
)brace
suffix:semicolon
DECL|variable|snd_intel8x0_ali_ac97spdifout_ops
r_static
id|snd_pcm_ops_t
id|snd_intel8x0_ali_ac97spdifout_ops
op_assign
(brace
dot
id|open
op_assign
id|snd_intel8x0_ali_ac97spdifout_open
comma
dot
id|close
op_assign
id|snd_intel8x0_ali_ac97spdifout_close
comma
dot
id|ioctl
op_assign
id|snd_pcm_lib_ioctl
comma
dot
id|hw_params
op_assign
id|snd_intel8x0_hw_params
comma
dot
id|hw_free
op_assign
id|snd_intel8x0_hw_free
comma
dot
id|prepare
op_assign
id|snd_intel8x0_pcm_prepare
comma
dot
id|trigger
op_assign
id|snd_intel8x0_ali_trigger
comma
dot
id|pointer
op_assign
id|snd_intel8x0_pcm_pointer
comma
)brace
suffix:semicolon
DECL|variable|snd_intel8x0_ali_spdifin_ops
r_static
id|snd_pcm_ops_t
id|snd_intel8x0_ali_spdifin_ops
op_assign
(brace
dot
id|open
op_assign
id|snd_intel8x0_ali_spdifin_open
comma
dot
id|close
op_assign
id|snd_intel8x0_ali_spdifin_close
comma
dot
id|ioctl
op_assign
id|snd_pcm_lib_ioctl
comma
dot
id|hw_params
op_assign
id|snd_intel8x0_hw_params
comma
dot
id|hw_free
op_assign
id|snd_intel8x0_hw_free
comma
dot
id|prepare
op_assign
id|snd_intel8x0_pcm_prepare
comma
dot
id|trigger
op_assign
id|snd_intel8x0_pcm_trigger
comma
dot
id|pointer
op_assign
id|snd_intel8x0_pcm_pointer
comma
)brace
suffix:semicolon
macro_line|#if 0 
singleline_comment|// NYI
r_static
id|snd_pcm_ops_t
id|snd_intel8x0_ali_spdifout_ops
op_assign
(brace
dot
id|open
op_assign
id|snd_intel8x0_ali_spdifout_open
comma
dot
id|close
op_assign
id|snd_intel8x0_ali_spdifout_close
comma
dot
id|ioctl
op_assign
id|snd_pcm_lib_ioctl
comma
dot
id|hw_params
op_assign
id|snd_intel8x0_hw_params
comma
dot
id|hw_free
op_assign
id|snd_intel8x0_hw_free
comma
dot
id|prepare
op_assign
id|snd_intel8x0_pcm_prepare
comma
dot
id|trigger
op_assign
id|snd_intel8x0_pcm_trigger
comma
dot
id|pointer
op_assign
id|snd_intel8x0_pcm_pointer
comma
)brace
suffix:semicolon
macro_line|#endif 
singleline_comment|// NYI
DECL|struct|ich_pcm_table
r_struct
id|ich_pcm_table
(brace
DECL|member|suffix
r_char
op_star
id|suffix
suffix:semicolon
DECL|member|playback_ops
id|snd_pcm_ops_t
op_star
id|playback_ops
suffix:semicolon
DECL|member|capture_ops
id|snd_pcm_ops_t
op_star
id|capture_ops
suffix:semicolon
DECL|member|prealloc_size
r_int
id|prealloc_size
suffix:semicolon
DECL|member|prealloc_max_size
r_int
id|prealloc_max_size
suffix:semicolon
DECL|member|ac97_idx
r_int
id|ac97_idx
suffix:semicolon
)brace
suffix:semicolon
DECL|function|snd_intel8x0_pcm1
r_static
r_int
id|__devinit
id|snd_intel8x0_pcm1
c_func
(paren
id|intel8x0_t
op_star
id|chip
comma
r_int
id|device
comma
r_struct
id|ich_pcm_table
op_star
id|rec
)paren
(brace
id|snd_pcm_t
op_star
id|pcm
suffix:semicolon
r_int
id|err
suffix:semicolon
r_char
id|name
(braket
l_int|32
)braket
suffix:semicolon
r_if
c_cond
(paren
id|rec-&gt;suffix
)paren
id|sprintf
c_func
(paren
id|name
comma
l_string|&quot;Intel ICH - %s&quot;
comma
id|rec-&gt;suffix
)paren
suffix:semicolon
r_else
id|strcpy
c_func
(paren
id|name
comma
l_string|&quot;Intel ICH&quot;
)paren
suffix:semicolon
id|err
op_assign
id|snd_pcm_new
c_func
(paren
id|chip-&gt;card
comma
id|name
comma
id|device
comma
id|rec-&gt;playback_ops
ques
c_cond
l_int|1
suffix:colon
l_int|0
comma
id|rec-&gt;capture_ops
ques
c_cond
l_int|1
suffix:colon
l_int|0
comma
op_amp
id|pcm
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_if
c_cond
(paren
id|rec-&gt;playback_ops
)paren
id|snd_pcm_set_ops
c_func
(paren
id|pcm
comma
id|SNDRV_PCM_STREAM_PLAYBACK
comma
id|rec-&gt;playback_ops
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rec-&gt;capture_ops
)paren
id|snd_pcm_set_ops
c_func
(paren
id|pcm
comma
id|SNDRV_PCM_STREAM_CAPTURE
comma
id|rec-&gt;capture_ops
)paren
suffix:semicolon
id|pcm-&gt;private_data
op_assign
id|chip
suffix:semicolon
id|pcm-&gt;info_flags
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|rec-&gt;suffix
)paren
id|sprintf
c_func
(paren
id|pcm-&gt;name
comma
l_string|&quot;%s - %s&quot;
comma
id|chip-&gt;card-&gt;shortname
comma
id|rec-&gt;suffix
)paren
suffix:semicolon
r_else
id|strcpy
c_func
(paren
id|pcm-&gt;name
comma
id|chip-&gt;card-&gt;shortname
)paren
suffix:semicolon
id|chip-&gt;pcm
(braket
id|device
)braket
op_assign
id|pcm
suffix:semicolon
id|snd_pcm_lib_preallocate_pages_for_all
c_func
(paren
id|pcm
comma
id|SNDRV_DMA_TYPE_DEV
comma
id|snd_dma_pci_data
c_func
(paren
id|chip-&gt;pci
)paren
comma
id|rec-&gt;prealloc_size
comma
id|rec-&gt;prealloc_max_size
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|__devinitdata
r_static
r_struct
id|ich_pcm_table
id|intel_pcms
(braket
)braket
id|__devinitdata
op_assign
(brace
(brace
dot
id|playback_ops
op_assign
op_amp
id|snd_intel8x0_playback_ops
comma
dot
id|capture_ops
op_assign
op_amp
id|snd_intel8x0_capture_ops
comma
dot
id|prealloc_size
op_assign
l_int|64
op_star
l_int|1024
comma
dot
id|prealloc_max_size
op_assign
l_int|128
op_star
l_int|1024
comma
)brace
comma
(brace
dot
id|suffix
op_assign
l_string|&quot;MIC ADC&quot;
comma
dot
id|capture_ops
op_assign
op_amp
id|snd_intel8x0_capture_mic_ops
comma
dot
id|prealloc_size
op_assign
l_int|0
comma
dot
id|prealloc_max_size
op_assign
l_int|128
op_star
l_int|1024
comma
dot
id|ac97_idx
op_assign
id|ICHD_MIC
comma
)brace
comma
(brace
dot
id|suffix
op_assign
l_string|&quot;MIC2 ADC&quot;
comma
dot
id|capture_ops
op_assign
op_amp
id|snd_intel8x0_capture_mic2_ops
comma
dot
id|prealloc_size
op_assign
l_int|0
comma
dot
id|prealloc_max_size
op_assign
l_int|128
op_star
l_int|1024
comma
dot
id|ac97_idx
op_assign
id|ICHD_MIC2
comma
)brace
comma
(brace
dot
id|suffix
op_assign
l_string|&quot;ADC2&quot;
comma
dot
id|capture_ops
op_assign
op_amp
id|snd_intel8x0_capture2_ops
comma
dot
id|prealloc_size
op_assign
l_int|0
comma
dot
id|prealloc_max_size
op_assign
l_int|128
op_star
l_int|1024
comma
dot
id|ac97_idx
op_assign
id|ICHD_PCM2IN
comma
)brace
comma
(brace
dot
id|suffix
op_assign
l_string|&quot;IEC958&quot;
comma
dot
id|playback_ops
op_assign
op_amp
id|snd_intel8x0_spdif_ops
comma
dot
id|prealloc_size
op_assign
l_int|64
op_star
l_int|1024
comma
dot
id|prealloc_max_size
op_assign
l_int|128
op_star
l_int|1024
comma
dot
id|ac97_idx
op_assign
id|ICHD_SPBAR
comma
)brace
comma
)brace
suffix:semicolon
DECL|variable|__devinitdata
r_static
r_struct
id|ich_pcm_table
id|nforce_pcms
(braket
)braket
id|__devinitdata
op_assign
(brace
(brace
dot
id|playback_ops
op_assign
op_amp
id|snd_intel8x0_playback_ops
comma
dot
id|capture_ops
op_assign
op_amp
id|snd_intel8x0_capture_ops
comma
dot
id|prealloc_size
op_assign
l_int|64
op_star
l_int|1024
comma
dot
id|prealloc_max_size
op_assign
l_int|128
op_star
l_int|1024
comma
)brace
comma
(brace
dot
id|suffix
op_assign
l_string|&quot;MIC ADC&quot;
comma
dot
id|capture_ops
op_assign
op_amp
id|snd_intel8x0_capture_mic_ops
comma
dot
id|prealloc_size
op_assign
l_int|0
comma
dot
id|prealloc_max_size
op_assign
l_int|128
op_star
l_int|1024
comma
dot
id|ac97_idx
op_assign
id|NVD_MIC
comma
)brace
comma
(brace
dot
id|suffix
op_assign
l_string|&quot;IEC958&quot;
comma
dot
id|playback_ops
op_assign
op_amp
id|snd_intel8x0_spdif_ops
comma
dot
id|prealloc_size
op_assign
l_int|64
op_star
l_int|1024
comma
dot
id|prealloc_max_size
op_assign
l_int|128
op_star
l_int|1024
comma
dot
id|ac97_idx
op_assign
id|NVD_SPBAR
comma
)brace
comma
)brace
suffix:semicolon
DECL|variable|__devinitdata
r_static
r_struct
id|ich_pcm_table
id|ali_pcms
(braket
)braket
id|__devinitdata
op_assign
(brace
(brace
dot
id|playback_ops
op_assign
op_amp
id|snd_intel8x0_ali_playback_ops
comma
dot
id|capture_ops
op_assign
op_amp
id|snd_intel8x0_ali_capture_ops
comma
dot
id|prealloc_size
op_assign
l_int|64
op_star
l_int|1024
comma
dot
id|prealloc_max_size
op_assign
l_int|128
op_star
l_int|1024
comma
)brace
comma
(brace
dot
id|suffix
op_assign
l_string|&quot;MIC ADC&quot;
comma
dot
id|capture_ops
op_assign
op_amp
id|snd_intel8x0_ali_capture_mic_ops
comma
dot
id|prealloc_size
op_assign
l_int|0
comma
dot
id|prealloc_max_size
op_assign
l_int|128
op_star
l_int|1024
comma
dot
id|ac97_idx
op_assign
id|ALID_MIC
comma
)brace
comma
(brace
dot
id|suffix
op_assign
l_string|&quot;IEC958&quot;
comma
dot
id|playback_ops
op_assign
op_amp
id|snd_intel8x0_ali_ac97spdifout_ops
comma
dot
id|capture_ops
op_assign
op_amp
id|snd_intel8x0_ali_spdifin_ops
comma
dot
id|prealloc_size
op_assign
l_int|64
op_star
l_int|1024
comma
dot
id|prealloc_max_size
op_assign
l_int|128
op_star
l_int|1024
comma
dot
id|ac97_idx
op_assign
id|ALID_AC97SPDIFOUT
comma
)brace
comma
macro_line|#if 0 
singleline_comment|// NYI
(brace
dot
id|suffix
op_assign
l_string|&quot;HW IEC958&quot;
comma
dot
id|playback_ops
op_assign
op_amp
id|snd_intel8x0_ali_spdifout_ops
comma
dot
id|prealloc_size
op_assign
l_int|64
op_star
l_int|1024
comma
dot
id|prealloc_max_size
op_assign
l_int|128
op_star
l_int|1024
comma
)brace
comma
macro_line|#endif
)brace
suffix:semicolon
DECL|function|snd_intel8x0_pcm
r_static
r_int
id|__devinit
id|snd_intel8x0_pcm
c_func
(paren
id|intel8x0_t
op_star
id|chip
)paren
(brace
r_int
id|i
comma
id|tblsize
comma
id|device
comma
id|err
suffix:semicolon
r_struct
id|ich_pcm_table
op_star
id|tbl
comma
op_star
id|rec
suffix:semicolon
r_switch
c_cond
(paren
id|chip-&gt;device_type
)paren
(brace
r_case
id|DEVICE_INTEL_ICH4
suffix:colon
id|tbl
op_assign
id|intel_pcms
suffix:semicolon
id|tblsize
op_assign
id|ARRAY_SIZE
c_func
(paren
id|intel_pcms
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|DEVICE_NFORCE
suffix:colon
id|tbl
op_assign
id|nforce_pcms
suffix:semicolon
id|tblsize
op_assign
id|ARRAY_SIZE
c_func
(paren
id|nforce_pcms
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|DEVICE_ALI
suffix:colon
id|tbl
op_assign
id|ali_pcms
suffix:semicolon
id|tblsize
op_assign
id|ARRAY_SIZE
c_func
(paren
id|ali_pcms
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|tbl
op_assign
id|intel_pcms
suffix:semicolon
id|tblsize
op_assign
l_int|2
suffix:semicolon
r_break
suffix:semicolon
)brace
id|device
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|tblsize
suffix:semicolon
id|i
op_increment
)paren
(brace
id|rec
op_assign
id|tbl
op_plus
id|i
suffix:semicolon
r_if
c_cond
(paren
id|i
OG
l_int|0
op_logical_and
id|rec-&gt;ac97_idx
)paren
(brace
multiline_comment|/* activate PCM only when associated AC&squot;97 codec */
r_if
c_cond
(paren
op_logical_neg
id|chip-&gt;ichd
(braket
id|rec-&gt;ac97_idx
)braket
dot
id|pcm
)paren
r_continue
suffix:semicolon
)brace
id|err
op_assign
id|snd_intel8x0_pcm1
c_func
(paren
id|chip
comma
id|device
comma
id|rec
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|device
op_increment
suffix:semicolon
)brace
id|chip-&gt;pcm_devs
op_assign
id|device
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; *  Mixer part&n; */
DECL|function|snd_intel8x0_mixer_free_ac97_bus
r_static
r_void
id|snd_intel8x0_mixer_free_ac97_bus
c_func
(paren
id|ac97_bus_t
op_star
id|bus
)paren
(brace
id|intel8x0_t
op_star
id|chip
op_assign
id|bus-&gt;private_data
suffix:semicolon
id|chip-&gt;ac97_bus
op_assign
l_int|NULL
suffix:semicolon
)brace
DECL|function|snd_intel8x0_mixer_free_ac97
r_static
r_void
id|snd_intel8x0_mixer_free_ac97
c_func
(paren
id|ac97_t
op_star
id|ac97
)paren
(brace
id|intel8x0_t
op_star
id|chip
op_assign
id|ac97-&gt;private_data
suffix:semicolon
id|chip-&gt;ac97
(braket
id|ac97-&gt;num
)braket
op_assign
l_int|NULL
suffix:semicolon
)brace
DECL|variable|__devinitdata
r_static
r_struct
id|ac97_pcm
id|ac97_pcm_defs
(braket
)braket
id|__devinitdata
op_assign
(brace
multiline_comment|/* front PCM */
(brace
dot
id|exclusive
op_assign
l_int|1
comma
dot
id|r
op_assign
(brace
(brace
dot
id|slots
op_assign
(paren
l_int|1
op_lshift
id|AC97_SLOT_PCM_LEFT
)paren
op_or
(paren
l_int|1
op_lshift
id|AC97_SLOT_PCM_RIGHT
)paren
op_or
(paren
l_int|1
op_lshift
id|AC97_SLOT_PCM_CENTER
)paren
op_or
(paren
l_int|1
op_lshift
id|AC97_SLOT_PCM_SLEFT
)paren
op_or
(paren
l_int|1
op_lshift
id|AC97_SLOT_PCM_SRIGHT
)paren
op_or
(paren
l_int|1
op_lshift
id|AC97_SLOT_LFE
)paren
)brace
comma
(brace
dot
id|slots
op_assign
(paren
l_int|1
op_lshift
id|AC97_SLOT_PCM_LEFT
)paren
op_or
(paren
l_int|1
op_lshift
id|AC97_SLOT_PCM_RIGHT
)paren
op_or
(paren
l_int|1
op_lshift
id|AC97_SLOT_PCM_LEFT_0
)paren
op_or
(paren
l_int|1
op_lshift
id|AC97_SLOT_PCM_RIGHT_0
)paren
)brace
)brace
)brace
comma
multiline_comment|/* PCM IN #1 */
(brace
dot
id|stream
op_assign
l_int|1
comma
dot
id|exclusive
op_assign
l_int|1
comma
dot
id|r
op_assign
(brace
(brace
dot
id|slots
op_assign
(paren
l_int|1
op_lshift
id|AC97_SLOT_PCM_LEFT
)paren
op_or
(paren
l_int|1
op_lshift
id|AC97_SLOT_PCM_RIGHT
)paren
)brace
)brace
)brace
comma
multiline_comment|/* MIC IN #1 */
(brace
dot
id|stream
op_assign
l_int|1
comma
dot
id|exclusive
op_assign
l_int|1
comma
dot
id|r
op_assign
(brace
(brace
dot
id|slots
op_assign
(paren
l_int|1
op_lshift
id|AC97_SLOT_MIC
)paren
)brace
)brace
)brace
comma
multiline_comment|/* S/PDIF PCM */
(brace
dot
id|exclusive
op_assign
l_int|1
comma
dot
id|spdif
op_assign
l_int|1
comma
dot
id|r
op_assign
(brace
(brace
dot
id|slots
op_assign
(paren
l_int|1
op_lshift
id|AC97_SLOT_SPDIF_LEFT2
)paren
op_or
(paren
l_int|1
op_lshift
id|AC97_SLOT_SPDIF_RIGHT2
)paren
)brace
)brace
)brace
comma
multiline_comment|/* PCM IN #2 */
(brace
dot
id|stream
op_assign
l_int|1
comma
dot
id|exclusive
op_assign
l_int|1
comma
dot
id|r
op_assign
(brace
(brace
dot
id|slots
op_assign
(paren
l_int|1
op_lshift
id|AC97_SLOT_PCM_LEFT
)paren
op_or
(paren
l_int|1
op_lshift
id|AC97_SLOT_PCM_RIGHT
)paren
)brace
)brace
)brace
comma
multiline_comment|/* MIC IN #2 */
(brace
dot
id|stream
op_assign
l_int|1
comma
dot
id|exclusive
op_assign
l_int|1
comma
dot
id|r
op_assign
(brace
(brace
dot
id|slots
op_assign
(paren
l_int|1
op_lshift
id|AC97_SLOT_MIC
)paren
)brace
)brace
)brace
comma
)brace
suffix:semicolon
DECL|variable|__devinitdata
r_static
r_struct
id|ac97_quirk
id|ac97_quirks
(braket
)braket
id|__devinitdata
op_assign
(brace
(brace
dot
id|vendor
op_assign
l_int|0x0e11
comma
dot
id|device
op_assign
l_int|0x008a
comma
dot
id|name
op_assign
l_string|&quot;Compaq Evo W4000&quot;
comma
multiline_comment|/* AD1885 */
dot
id|type
op_assign
id|AC97_TUNE_HP_ONLY
)brace
comma
(brace
dot
id|vendor
op_assign
l_int|0x0e11
comma
dot
id|device
op_assign
l_int|0x00b8
comma
dot
id|name
op_assign
l_string|&quot;Compaq Evo D510C&quot;
comma
dot
id|type
op_assign
id|AC97_TUNE_HP_ONLY
)brace
comma
(brace
dot
id|vendor
op_assign
l_int|0x1014
comma
dot
id|device
op_assign
l_int|0x1f00
comma
dot
id|name
op_assign
l_string|&quot;MS-9128&quot;
comma
dot
id|type
op_assign
id|AC97_TUNE_ALC_JACK
)brace
comma
(brace
dot
id|vendor
op_assign
l_int|0x1028
comma
dot
id|device
op_assign
l_int|0x00d8
comma
dot
id|name
op_assign
l_string|&quot;Dell Precision 530&quot;
comma
multiline_comment|/* AD1885 */
dot
id|type
op_assign
id|AC97_TUNE_HP_ONLY
)brace
comma
(brace
dot
id|vendor
op_assign
l_int|0x1028
comma
dot
id|device
op_assign
l_int|0x010d
comma
dot
id|name
op_assign
l_string|&quot;Dell&quot;
comma
multiline_comment|/* which model?  AD1885 */
dot
id|type
op_assign
id|AC97_TUNE_HP_ONLY
)brace
comma
(brace
dot
id|vendor
op_assign
l_int|0x1028
comma
dot
id|device
op_assign
l_int|0x0126
comma
dot
id|name
op_assign
l_string|&quot;Dell Optiplex GX260&quot;
comma
multiline_comment|/* AD1981A */
dot
id|type
op_assign
id|AC97_TUNE_HP_ONLY
)brace
comma
(brace
dot
id|vendor
op_assign
l_int|0x1028
comma
dot
id|device
op_assign
l_int|0x012d
comma
dot
id|name
op_assign
l_string|&quot;Dell Precision 450&quot;
comma
multiline_comment|/* AD1981B*/
dot
id|type
op_assign
id|AC97_TUNE_HP_ONLY
)brace
comma
(brace
dot
id|vendor
op_assign
l_int|0x1028
comma
dot
id|device
op_assign
l_int|0x0147
comma
dot
id|name
op_assign
l_string|&quot;Dell&quot;
comma
multiline_comment|/* which model?  AD1981B*/
dot
id|type
op_assign
id|AC97_TUNE_HP_ONLY
)brace
comma
(brace
multiline_comment|/* FIXME: which codec? */
dot
id|vendor
op_assign
l_int|0x103c
comma
dot
id|device
op_assign
l_int|0x00c3
comma
dot
id|name
op_assign
l_string|&quot;Hewlett-Packard onboard&quot;
comma
dot
id|type
op_assign
id|AC97_TUNE_HP_ONLY
)brace
comma
(brace
dot
id|vendor
op_assign
l_int|0x103c
comma
dot
id|device
op_assign
l_int|0x12f1
comma
dot
id|name
op_assign
l_string|&quot;HP xw8200&quot;
comma
multiline_comment|/* AD1981B*/
dot
id|type
op_assign
id|AC97_TUNE_HP_ONLY
)brace
comma
(brace
dot
id|vendor
op_assign
l_int|0x103c
comma
dot
id|device
op_assign
l_int|0x3008
comma
dot
id|name
op_assign
l_string|&quot;HP xw4200&quot;
comma
multiline_comment|/* AD1981B*/
dot
id|type
op_assign
id|AC97_TUNE_HP_ONLY
)brace
comma
(brace
dot
id|vendor
op_assign
l_int|0x104d
comma
dot
id|device
op_assign
l_int|0x8197
comma
dot
id|name
op_assign
l_string|&quot;Sony S1XP&quot;
comma
dot
id|type
op_assign
id|AC97_TUNE_INV_EAPD
)brace
comma
(brace
dot
id|vendor
op_assign
l_int|0x1043
comma
dot
id|device
op_assign
l_int|0x80f3
comma
dot
id|name
op_assign
l_string|&quot;ASUS ICH5/AD1985&quot;
comma
dot
id|type
op_assign
id|AC97_TUNE_AD_SHARING
)brace
comma
(brace
dot
id|vendor
op_assign
l_int|0x10cf
comma
dot
id|device
op_assign
l_int|0x11c3
comma
dot
id|name
op_assign
l_string|&quot;Fujitsu-Siemens E4010&quot;
comma
dot
id|type
op_assign
id|AC97_TUNE_HP_ONLY
)brace
comma
(brace
dot
id|vendor
op_assign
l_int|0x10f1
comma
dot
id|device
op_assign
l_int|0x2665
comma
dot
id|name
op_assign
l_string|&quot;Fujitsu-Siemens Celsius&quot;
comma
multiline_comment|/* AD1981? */
dot
id|type
op_assign
id|AC97_TUNE_HP_ONLY
)brace
comma
(brace
dot
id|vendor
op_assign
l_int|0x10f1
comma
dot
id|device
op_assign
l_int|0x2885
comma
dot
id|name
op_assign
l_string|&quot;AMD64 Mobo&quot;
comma
multiline_comment|/* ALC650 */
dot
id|type
op_assign
id|AC97_TUNE_HP_ONLY
)brace
comma
(brace
dot
id|vendor
op_assign
l_int|0x110a
comma
dot
id|device
op_assign
l_int|0x0056
comma
dot
id|name
op_assign
l_string|&quot;Fujitsu-Siemens Scenic&quot;
comma
multiline_comment|/* AD1981? */
dot
id|type
op_assign
id|AC97_TUNE_HP_ONLY
)brace
comma
(brace
dot
id|vendor
op_assign
l_int|0x11d4
comma
dot
id|device
op_assign
l_int|0x5375
comma
dot
id|name
op_assign
l_string|&quot;ADI AD1985 (discrete)&quot;
comma
dot
id|type
op_assign
id|AC97_TUNE_HP_ONLY
)brace
comma
(brace
dot
id|vendor
op_assign
l_int|0x1462
comma
dot
id|device
op_assign
l_int|0x5470
comma
dot
id|name
op_assign
l_string|&quot;MSI P4 ATX 645 Ultra&quot;
comma
dot
id|type
op_assign
id|AC97_TUNE_HP_ONLY
)brace
comma
(brace
dot
id|vendor
op_assign
l_int|0x1734
comma
dot
id|device
op_assign
l_int|0x0088
comma
dot
id|name
op_assign
l_string|&quot;Fujitsu-Siemens D1522&quot;
comma
multiline_comment|/* AD1981 */
dot
id|type
op_assign
id|AC97_TUNE_HP_ONLY
)brace
comma
(brace
dot
id|vendor
op_assign
l_int|0x8086
comma
dot
id|device
op_assign
l_int|0x2000
comma
dot
id|mask
op_assign
l_int|0xfff0
comma
dot
id|name
op_assign
l_string|&quot;Intel ICH5/AD1985&quot;
comma
dot
id|type
op_assign
id|AC97_TUNE_AD_SHARING
)brace
comma
(brace
dot
id|vendor
op_assign
l_int|0x8086
comma
dot
id|device
op_assign
l_int|0x4000
comma
dot
id|mask
op_assign
l_int|0xfff0
comma
dot
id|name
op_assign
l_string|&quot;Intel ICH5/AD1985&quot;
comma
dot
id|type
op_assign
id|AC97_TUNE_AD_SHARING
)brace
comma
(brace
dot
id|vendor
op_assign
l_int|0x8086
comma
dot
id|device
op_assign
l_int|0x4856
comma
dot
id|name
op_assign
l_string|&quot;Intel D845WN (82801BA)&quot;
comma
dot
id|type
op_assign
id|AC97_TUNE_SWAP_HP
)brace
comma
(brace
dot
id|vendor
op_assign
l_int|0x8086
comma
dot
id|device
op_assign
l_int|0x4d44
comma
dot
id|name
op_assign
l_string|&quot;Intel D850EMV2&quot;
comma
multiline_comment|/* AD1885 */
dot
id|type
op_assign
id|AC97_TUNE_HP_ONLY
)brace
comma
(brace
dot
id|vendor
op_assign
l_int|0x8086
comma
dot
id|device
op_assign
l_int|0x4d56
comma
dot
id|name
op_assign
l_string|&quot;Intel ICH/AD1885&quot;
comma
dot
id|type
op_assign
id|AC97_TUNE_HP_ONLY
)brace
comma
(brace
dot
id|vendor
op_assign
l_int|0x8086
comma
dot
id|device
op_assign
l_int|0x6000
comma
dot
id|mask
op_assign
l_int|0xfff0
comma
dot
id|name
op_assign
l_string|&quot;Intel ICH5/AD1985&quot;
comma
dot
id|type
op_assign
id|AC97_TUNE_AD_SHARING
)brace
comma
(brace
dot
id|vendor
op_assign
l_int|0x8086
comma
dot
id|device
op_assign
l_int|0xe000
comma
dot
id|mask
op_assign
l_int|0xfff0
comma
dot
id|name
op_assign
l_string|&quot;Intel ICH5/AD1985&quot;
comma
dot
id|type
op_assign
id|AC97_TUNE_AD_SHARING
)brace
comma
macro_line|#if 0 /* FIXME: this seems wrong on most boards */
(brace
dot
id|vendor
op_assign
l_int|0x8086
comma
dot
id|device
op_assign
l_int|0xa000
comma
dot
id|mask
op_assign
l_int|0xfff0
comma
dot
id|name
op_assign
l_string|&quot;Intel ICH5/AD1985&quot;
comma
dot
id|type
op_assign
id|AC97_TUNE_HP_ONLY
)brace
comma
macro_line|#endif
(brace
)brace
multiline_comment|/* terminator */
)brace
suffix:semicolon
DECL|function|snd_intel8x0_mixer
r_static
r_int
id|__devinit
id|snd_intel8x0_mixer
c_func
(paren
id|intel8x0_t
op_star
id|chip
comma
r_int
id|ac97_clock
comma
r_int
id|ac97_quirk
)paren
(brace
id|ac97_bus_t
op_star
id|pbus
suffix:semicolon
id|ac97_template_t
id|ac97
suffix:semicolon
r_int
id|err
suffix:semicolon
r_int
r_int
id|i
comma
id|codecs
suffix:semicolon
r_int
r_int
id|glob_sta
op_assign
l_int|0
suffix:semicolon
id|ac97_bus_ops_t
op_star
id|ops
suffix:semicolon
r_static
id|ac97_bus_ops_t
id|standard_bus_ops
op_assign
(brace
dot
id|write
op_assign
id|snd_intel8x0_codec_write
comma
dot
id|read
op_assign
id|snd_intel8x0_codec_read
comma
)brace
suffix:semicolon
r_static
id|ac97_bus_ops_t
id|ali_bus_ops
op_assign
(brace
dot
id|write
op_assign
id|snd_intel8x0_ali_codec_write
comma
dot
id|read
op_assign
id|snd_intel8x0_ali_codec_read
comma
)brace
suffix:semicolon
id|chip-&gt;spdif_idx
op_assign
op_minus
l_int|1
suffix:semicolon
multiline_comment|/* use PCMOUT (or disabled) */
r_switch
c_cond
(paren
id|chip-&gt;device_type
)paren
(brace
r_case
id|DEVICE_NFORCE
suffix:colon
id|chip-&gt;spdif_idx
op_assign
id|NVD_SPBAR
suffix:semicolon
r_break
suffix:semicolon
r_case
id|DEVICE_ALI
suffix:colon
id|chip-&gt;spdif_idx
op_assign
id|ALID_AC97SPDIFOUT
suffix:semicolon
r_break
suffix:semicolon
r_case
id|DEVICE_INTEL_ICH4
suffix:colon
id|chip-&gt;spdif_idx
op_assign
id|ICHD_SPBAR
suffix:semicolon
r_break
suffix:semicolon
)brace
suffix:semicolon
id|chip-&gt;in_ac97_init
op_assign
l_int|1
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|ac97
comma
l_int|0
comma
r_sizeof
(paren
id|ac97
)paren
)paren
suffix:semicolon
id|ac97.private_data
op_assign
id|chip
suffix:semicolon
id|ac97.private_free
op_assign
id|snd_intel8x0_mixer_free_ac97
suffix:semicolon
id|ac97.scaps
op_assign
id|AC97_SCAP_SKIP_MODEM
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;xbox
)paren
id|ac97.scaps
op_or_assign
id|AC97_SCAP_DETECT_BY_VENDOR
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;device_type
op_ne
id|DEVICE_ALI
)paren
(brace
id|glob_sta
op_assign
id|igetdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|GLOB_STA
)paren
)paren
suffix:semicolon
id|ops
op_assign
op_amp
id|standard_bus_ops
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;device_type
op_eq
id|DEVICE_INTEL_ICH4
)paren
(brace
id|codecs
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|glob_sta
op_amp
id|ICH_PCR
)paren
id|codecs
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|glob_sta
op_amp
id|ICH_SCR
)paren
id|codecs
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|glob_sta
op_amp
id|ICH_TCR
)paren
id|codecs
op_increment
suffix:semicolon
id|chip-&gt;in_sdin_init
op_assign
l_int|1
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|codecs
suffix:semicolon
id|i
op_increment
)paren
(brace
id|snd_intel8x0_codec_read_test
c_func
(paren
id|chip
comma
id|i
)paren
suffix:semicolon
id|chip-&gt;ac97_sdin
(braket
id|i
)braket
op_assign
id|igetbyte
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|SDM
)paren
)paren
op_amp
id|ICH_LDI_MASK
suffix:semicolon
)brace
id|chip-&gt;in_sdin_init
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|codecs
op_assign
id|glob_sta
op_amp
id|ICH_SCR
ques
c_cond
l_int|2
suffix:colon
l_int|1
suffix:semicolon
)brace
)brace
r_else
(brace
id|ops
op_assign
op_amp
id|ali_bus_ops
suffix:semicolon
id|codecs
op_assign
l_int|1
suffix:semicolon
multiline_comment|/* detect the secondary codec */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|100
suffix:semicolon
id|i
op_increment
)paren
(brace
r_int
r_int
id|reg
op_assign
id|igetdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|ALI_RTSR
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|reg
op_amp
l_int|0x40
)paren
(brace
id|codecs
op_assign
l_int|2
suffix:semicolon
r_break
suffix:semicolon
)brace
id|iputdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|ALI_RTSR
)paren
comma
id|reg
op_or
l_int|0x40
)paren
suffix:semicolon
id|udelay
c_func
(paren
l_int|1
)paren
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ac97_bus
c_func
(paren
id|chip-&gt;card
comma
l_int|0
comma
id|ops
comma
id|chip
comma
op_amp
id|pbus
)paren
)paren
OL
l_int|0
)paren
r_goto
id|__err
suffix:semicolon
id|pbus-&gt;private_free
op_assign
id|snd_intel8x0_mixer_free_ac97_bus
suffix:semicolon
id|pbus-&gt;shared_type
op_assign
id|AC97_SHARED_TYPE_ICH
suffix:semicolon
multiline_comment|/* shared with modem driver */
r_if
c_cond
(paren
id|ac97_clock
op_ge
l_int|8000
op_logical_and
id|ac97_clock
op_le
l_int|48000
)paren
id|pbus-&gt;clock
op_assign
id|ac97_clock
suffix:semicolon
multiline_comment|/* FIXME: my test board doesn&squot;t work well with VRA... */
r_if
c_cond
(paren
id|chip-&gt;device_type
op_eq
id|DEVICE_ALI
)paren
id|pbus-&gt;no_vra
op_assign
l_int|1
suffix:semicolon
id|pbus-&gt;dra
op_assign
l_int|1
suffix:semicolon
id|chip-&gt;ac97_bus
op_assign
id|pbus
suffix:semicolon
id|ac97.pci
op_assign
id|chip-&gt;pci
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|codecs
suffix:semicolon
id|i
op_increment
)paren
(brace
id|ac97.num
op_assign
id|i
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ac97_mixer
c_func
(paren
id|pbus
comma
op_amp
id|ac97
comma
op_amp
id|chip-&gt;ac97
(braket
id|i
)braket
)paren
)paren
OL
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|err
op_ne
op_minus
id|EACCES
)paren
id|snd_printk
c_func
(paren
id|KERN_ERR
l_string|&quot;Unable to initialize codec #%d&bslash;n&quot;
comma
id|i
)paren
suffix:semicolon
r_if
c_cond
(paren
id|i
op_eq
l_int|0
)paren
r_goto
id|__err
suffix:semicolon
r_continue
suffix:semicolon
)brace
)brace
multiline_comment|/* tune up the primary codec */
id|snd_ac97_tune_hardware
c_func
(paren
id|chip-&gt;ac97
(braket
l_int|0
)braket
comma
id|ac97_quirks
comma
id|ac97_quirk
)paren
suffix:semicolon
multiline_comment|/* enable separate SDINs for ICH4 */
r_if
c_cond
(paren
id|chip-&gt;device_type
op_eq
id|DEVICE_INTEL_ICH4
)paren
id|pbus-&gt;isdin
op_assign
l_int|1
suffix:semicolon
multiline_comment|/* find the available PCM streams */
id|i
op_assign
id|ARRAY_SIZE
c_func
(paren
id|ac97_pcm_defs
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;device_type
op_ne
id|DEVICE_INTEL_ICH4
)paren
id|i
op_sub_assign
l_int|2
suffix:semicolon
multiline_comment|/* do not allocate PCM2IN and MIC2 */
r_if
c_cond
(paren
id|chip-&gt;spdif_idx
OL
l_int|0
)paren
id|i
op_decrement
suffix:semicolon
multiline_comment|/* do not allocate S/PDIF */
id|err
op_assign
id|snd_ac97_pcm_assign
c_func
(paren
id|pbus
comma
id|i
comma
id|ac97_pcm_defs
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_goto
id|__err
suffix:semicolon
id|chip-&gt;ichd
(braket
id|ICHD_PCMOUT
)braket
dot
id|pcm
op_assign
op_amp
id|pbus-&gt;pcms
(braket
l_int|0
)braket
suffix:semicolon
id|chip-&gt;ichd
(braket
id|ICHD_PCMIN
)braket
dot
id|pcm
op_assign
op_amp
id|pbus-&gt;pcms
(braket
l_int|1
)braket
suffix:semicolon
id|chip-&gt;ichd
(braket
id|ICHD_MIC
)braket
dot
id|pcm
op_assign
op_amp
id|pbus-&gt;pcms
(braket
l_int|2
)braket
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;spdif_idx
op_ge
l_int|0
)paren
id|chip-&gt;ichd
(braket
id|chip-&gt;spdif_idx
)braket
dot
id|pcm
op_assign
op_amp
id|pbus-&gt;pcms
(braket
l_int|3
)braket
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;device_type
op_eq
id|DEVICE_INTEL_ICH4
)paren
(brace
id|chip-&gt;ichd
(braket
id|ICHD_PCM2IN
)braket
dot
id|pcm
op_assign
op_amp
id|pbus-&gt;pcms
(braket
l_int|4
)braket
suffix:semicolon
id|chip-&gt;ichd
(braket
id|ICHD_MIC2
)braket
dot
id|pcm
op_assign
op_amp
id|pbus-&gt;pcms
(braket
l_int|5
)braket
suffix:semicolon
)brace
multiline_comment|/* enable separate SDINs for ICH4 */
r_if
c_cond
(paren
id|chip-&gt;device_type
op_eq
id|DEVICE_INTEL_ICH4
)paren
(brace
r_struct
id|ac97_pcm
op_star
id|pcm
op_assign
id|chip-&gt;ichd
(braket
id|ICHD_PCM2IN
)braket
dot
id|pcm
suffix:semicolon
id|u8
id|tmp
op_assign
id|igetbyte
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|SDM
)paren
)paren
suffix:semicolon
id|tmp
op_and_assign
op_complement
(paren
id|ICH_DI2L_MASK
op_or
id|ICH_DI1L_MASK
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pcm
)paren
(brace
id|tmp
op_or_assign
id|ICH_SE
suffix:semicolon
multiline_comment|/* steer enable for multiple SDINs */
id|tmp
op_or_assign
id|chip-&gt;ac97_sdin
(braket
l_int|0
)braket
op_lshift
id|ICH_DI1L_SHIFT
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|1
suffix:semicolon
id|i
OL
l_int|4
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|pcm-&gt;r
(braket
l_int|0
)braket
dot
id|codec
(braket
id|i
)braket
)paren
(brace
id|tmp
op_or_assign
id|chip-&gt;ac97_sdin
(braket
id|pcm-&gt;r
(braket
l_int|0
)braket
dot
id|codec
(braket
l_int|1
)braket
op_member_access_from_pointer
id|num
)braket
op_lshift
id|ICH_DI2L_SHIFT
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
)brace
r_else
(brace
id|tmp
op_and_assign
op_complement
id|ICH_SE
suffix:semicolon
multiline_comment|/* steer disable */
)brace
id|iputbyte
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|SDM
)paren
comma
id|tmp
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|pbus-&gt;pcms
(braket
l_int|0
)braket
dot
id|r
(braket
l_int|0
)braket
dot
id|slots
op_amp
(paren
l_int|1
op_lshift
id|AC97_SLOT_PCM_SLEFT
)paren
)paren
(brace
id|chip-&gt;multi4
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|pbus-&gt;pcms
(braket
l_int|0
)braket
dot
id|r
(braket
l_int|0
)braket
dot
id|slots
op_amp
(paren
l_int|1
op_lshift
id|AC97_SLOT_LFE
)paren
)paren
id|chip-&gt;multi6
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|pbus-&gt;pcms
(braket
l_int|0
)braket
dot
id|r
(braket
l_int|1
)braket
dot
id|rslots
(braket
l_int|0
)braket
)paren
(brace
id|chip-&gt;dra
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|chip-&gt;device_type
op_eq
id|DEVICE_INTEL_ICH4
)paren
(brace
r_if
c_cond
(paren
(paren
id|igetdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|GLOB_STA
)paren
)paren
op_amp
id|ICH_SAMPLE_CAP
)paren
op_eq
id|ICH_SAMPLE_16_20
)paren
id|chip-&gt;smp20bit
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|chip-&gt;device_type
op_eq
id|DEVICE_NFORCE
)paren
(brace
multiline_comment|/* 48kHz only */
id|chip-&gt;ichd
(braket
id|chip-&gt;spdif_idx
)braket
dot
id|pcm-&gt;rates
op_assign
id|SNDRV_PCM_RATE_48000
suffix:semicolon
)brace
r_if
c_cond
(paren
id|chip-&gt;device_type
op_eq
id|DEVICE_INTEL_ICH4
)paren
(brace
multiline_comment|/* use slot 10/11 for SPDIF */
id|u32
id|val
suffix:semicolon
id|val
op_assign
id|igetdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|GLOB_CNT
)paren
)paren
op_amp
op_complement
id|ICH_PCM_SPDIF_MASK
suffix:semicolon
id|val
op_or_assign
id|ICH_PCM_SPDIF_1011
suffix:semicolon
id|iputdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|GLOB_CNT
)paren
comma
id|val
)paren
suffix:semicolon
id|snd_ac97_update_bits
c_func
(paren
id|chip-&gt;ac97
(braket
l_int|0
)braket
comma
id|AC97_EXTENDED_STATUS
comma
l_int|0x03
op_lshift
l_int|4
comma
l_int|0x03
op_lshift
l_int|4
)paren
suffix:semicolon
)brace
id|chip-&gt;in_ac97_init
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
id|__err
suffix:colon
multiline_comment|/* clear the cold-reset bit for the next chance */
r_if
c_cond
(paren
id|chip-&gt;device_type
op_ne
id|DEVICE_ALI
)paren
id|iputdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|GLOB_CNT
)paren
comma
id|igetdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|GLOB_CNT
)paren
)paren
op_amp
op_complement
id|ICH_AC97COLD
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
multiline_comment|/*&n; *&n; */
DECL|function|do_ali_reset
r_static
r_void
id|do_ali_reset
c_func
(paren
id|intel8x0_t
op_star
id|chip
)paren
(brace
id|iputdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|ALI_SCR
)paren
comma
id|ICH_ALI_SC_RESET
)paren
suffix:semicolon
id|iputdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|ALI_FIFOCR1
)paren
comma
l_int|0x83838383
)paren
suffix:semicolon
id|iputdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|ALI_FIFOCR2
)paren
comma
l_int|0x83838383
)paren
suffix:semicolon
id|iputdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|ALI_FIFOCR3
)paren
comma
l_int|0x83838383
)paren
suffix:semicolon
id|iputdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|ALI_INTERFACECR
)paren
comma
id|ICH_ALI_IF_MC
op_or
id|ICH_ALI_IF_PI
op_or
id|ICH_ALI_IF_PO
)paren
suffix:semicolon
id|iputdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|ALI_INTERRUPTCR
)paren
comma
l_int|0x00000000
)paren
suffix:semicolon
id|iputdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|ALI_INTERRUPTSR
)paren
comma
l_int|0x00000000
)paren
suffix:semicolon
)brace
DECL|macro|do_delay
mdefine_line|#define do_delay(chip) do {&bslash;&n;&t;set_current_state(TASK_UNINTERRUPTIBLE);&bslash;&n;&t;schedule_timeout(1);&bslash;&n;} while (0)
DECL|function|snd_intel8x0_ich_chip_init
r_static
r_int
id|snd_intel8x0_ich_chip_init
c_func
(paren
id|intel8x0_t
op_star
id|chip
comma
r_int
id|probing
)paren
(brace
r_int
r_int
id|end_time
suffix:semicolon
r_int
r_int
id|cnt
comma
id|status
comma
id|nstatus
suffix:semicolon
multiline_comment|/* put logic to right state */
multiline_comment|/* first clear status bits */
id|status
op_assign
id|ICH_RCS
op_or
id|ICH_MCINT
op_or
id|ICH_POINT
op_or
id|ICH_PIINT
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;device_type
op_eq
id|DEVICE_NFORCE
)paren
id|status
op_or_assign
id|ICH_NVSPINT
suffix:semicolon
id|cnt
op_assign
id|igetdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|GLOB_STA
)paren
)paren
suffix:semicolon
id|iputdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|GLOB_STA
)paren
comma
id|cnt
op_amp
id|status
)paren
suffix:semicolon
multiline_comment|/* ACLink on, 2 channels */
id|cnt
op_assign
id|igetdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|GLOB_CNT
)paren
)paren
suffix:semicolon
id|cnt
op_and_assign
op_complement
(paren
id|ICH_ACLINK
op_or
id|ICH_PCM_246_MASK
)paren
suffix:semicolon
multiline_comment|/* finish cold or do warm reset */
id|cnt
op_or_assign
(paren
id|cnt
op_amp
id|ICH_AC97COLD
)paren
op_eq
l_int|0
ques
c_cond
id|ICH_AC97COLD
suffix:colon
id|ICH_AC97WARM
suffix:semicolon
id|iputdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|GLOB_CNT
)paren
comma
id|cnt
)paren
suffix:semicolon
id|end_time
op_assign
(paren
id|jiffies
op_plus
(paren
id|HZ
op_div
l_int|4
)paren
)paren
op_plus
l_int|1
suffix:semicolon
r_do
(brace
r_if
c_cond
(paren
(paren
id|igetdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|GLOB_CNT
)paren
)paren
op_amp
id|ICH_AC97WARM
)paren
op_eq
l_int|0
)paren
r_goto
id|__ok
suffix:semicolon
id|do_delay
c_func
(paren
id|chip
)paren
suffix:semicolon
)brace
r_while
c_loop
(paren
id|time_after_eq
c_func
(paren
id|end_time
comma
id|jiffies
)paren
)paren
suffix:semicolon
id|snd_printk
c_func
(paren
l_string|&quot;AC&squot;97 warm reset still in progress? [0x%x]&bslash;n&quot;
comma
id|igetdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|GLOB_CNT
)paren
)paren
)paren
suffix:semicolon
r_return
op_minus
id|EIO
suffix:semicolon
id|__ok
suffix:colon
r_if
c_cond
(paren
id|probing
)paren
(brace
multiline_comment|/* wait for any codec ready status.&n;&t;&t; * Once it becomes ready it should remain ready&n;&t;&t; * as long as we do not disable the ac97 link.&n;&t;&t; */
id|end_time
op_assign
id|jiffies
op_plus
id|HZ
suffix:semicolon
r_do
(brace
id|status
op_assign
id|igetdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|GLOB_STA
)paren
)paren
op_amp
(paren
id|ICH_PCR
op_or
id|ICH_SCR
op_or
id|ICH_TCR
)paren
suffix:semicolon
r_if
c_cond
(paren
id|status
)paren
r_break
suffix:semicolon
id|do_delay
c_func
(paren
id|chip
)paren
suffix:semicolon
)brace
r_while
c_loop
(paren
id|time_after_eq
c_func
(paren
id|end_time
comma
id|jiffies
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|status
)paren
(brace
multiline_comment|/* no codec is found */
id|snd_printk
c_func
(paren
id|KERN_ERR
l_string|&quot;codec_ready: codec is not ready [0x%x]&bslash;n&quot;
comma
id|igetdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|GLOB_STA
)paren
)paren
)paren
suffix:semicolon
r_return
op_minus
id|EIO
suffix:semicolon
)brace
r_if
c_cond
(paren
id|chip-&gt;device_type
op_eq
id|DEVICE_INTEL_ICH4
)paren
multiline_comment|/* ICH4 can have three codecs */
id|nstatus
op_assign
id|ICH_PCR
op_or
id|ICH_SCR
op_or
id|ICH_TCR
suffix:semicolon
r_else
multiline_comment|/* others up to two codecs */
id|nstatus
op_assign
id|ICH_PCR
op_or
id|ICH_SCR
suffix:semicolon
multiline_comment|/* wait for other codecs ready status. */
id|end_time
op_assign
id|jiffies
op_plus
id|HZ
op_div
l_int|4
suffix:semicolon
r_while
c_loop
(paren
id|status
op_ne
id|nstatus
op_logical_and
id|time_after_eq
c_func
(paren
id|end_time
comma
id|jiffies
)paren
)paren
(brace
id|do_delay
c_func
(paren
id|chip
)paren
suffix:semicolon
id|status
op_or_assign
id|igetdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|GLOB_STA
)paren
)paren
op_amp
id|nstatus
suffix:semicolon
)brace
)brace
r_else
(brace
multiline_comment|/* resume phase */
r_int
id|i
suffix:semicolon
id|status
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|3
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|chip-&gt;ac97
(braket
id|i
)braket
)paren
id|status
op_or_assign
id|get_ich_codec_bit
c_func
(paren
id|chip
comma
id|i
)paren
suffix:semicolon
multiline_comment|/* wait until all the probed codecs are ready */
id|end_time
op_assign
id|jiffies
op_plus
id|HZ
suffix:semicolon
r_do
(brace
id|nstatus
op_assign
id|igetdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|GLOB_STA
)paren
)paren
op_amp
(paren
id|ICH_PCR
op_or
id|ICH_SCR
op_or
id|ICH_TCR
)paren
suffix:semicolon
r_if
c_cond
(paren
id|status
op_eq
id|nstatus
)paren
r_break
suffix:semicolon
id|do_delay
c_func
(paren
id|chip
)paren
suffix:semicolon
)brace
r_while
c_loop
(paren
id|time_after_eq
c_func
(paren
id|end_time
comma
id|jiffies
)paren
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|chip-&gt;device_type
op_eq
id|DEVICE_SIS
)paren
(brace
multiline_comment|/* unmute the output on SIS7012 */
id|iputword
c_func
(paren
id|chip
comma
l_int|0x4c
comma
id|igetword
c_func
(paren
id|chip
comma
l_int|0x4c
)paren
op_or
l_int|1
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|chip-&gt;device_type
op_eq
id|DEVICE_NFORCE
)paren
(brace
multiline_comment|/* enable SPDIF interrupt */
r_int
r_int
id|val
suffix:semicolon
id|pci_read_config_dword
c_func
(paren
id|chip-&gt;pci
comma
l_int|0x4c
comma
op_amp
id|val
)paren
suffix:semicolon
id|val
op_or_assign
l_int|0x1000000
suffix:semicolon
id|pci_write_config_dword
c_func
(paren
id|chip-&gt;pci
comma
l_int|0x4c
comma
id|val
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_intel8x0_ali_chip_init
r_static
r_int
id|snd_intel8x0_ali_chip_init
c_func
(paren
id|intel8x0_t
op_star
id|chip
comma
r_int
id|probing
)paren
(brace
id|u32
id|reg
suffix:semicolon
r_int
id|i
op_assign
l_int|0
suffix:semicolon
id|reg
op_assign
id|igetdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|ALI_SCR
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|reg
op_amp
l_int|2
)paren
op_eq
l_int|0
)paren
multiline_comment|/* Cold required */
id|reg
op_or_assign
l_int|2
suffix:semicolon
r_else
id|reg
op_or_assign
l_int|1
suffix:semicolon
multiline_comment|/* Warm */
id|reg
op_and_assign
op_complement
l_int|0x80000000
suffix:semicolon
multiline_comment|/* ACLink on */
id|iputdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|ALI_SCR
)paren
comma
id|reg
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|HZ
op_div
l_int|2
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|igetdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|ALI_INTERRUPTSR
)paren
)paren
op_amp
id|ALI_INT_GPIO
)paren
)paren
r_goto
id|__ok
suffix:semicolon
id|do_delay
c_func
(paren
id|chip
)paren
suffix:semicolon
)brace
id|snd_printk
c_func
(paren
id|KERN_ERR
l_string|&quot;AC&squot;97 reset failed.&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|probing
)paren
r_return
op_minus
id|EIO
suffix:semicolon
id|__ok
suffix:colon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|HZ
op_div
l_int|2
suffix:semicolon
id|i
op_increment
)paren
(brace
id|reg
op_assign
id|igetdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|ALI_RTSR
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|reg
op_amp
l_int|0x80
)paren
multiline_comment|/* primary codec */
r_break
suffix:semicolon
id|iputdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|ALI_RTSR
)paren
comma
id|reg
op_or
l_int|0x80
)paren
suffix:semicolon
id|do_delay
c_func
(paren
id|chip
)paren
suffix:semicolon
)brace
id|do_ali_reset
c_func
(paren
id|chip
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_intel8x0_chip_init
r_static
r_int
id|snd_intel8x0_chip_init
c_func
(paren
id|intel8x0_t
op_star
id|chip
comma
r_int
id|probing
)paren
(brace
r_int
r_int
id|i
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;device_type
op_ne
id|DEVICE_ALI
)paren
(brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_intel8x0_ich_chip_init
c_func
(paren
id|chip
comma
id|probing
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|iagetword
c_func
(paren
id|chip
comma
l_int|0
)paren
suffix:semicolon
multiline_comment|/* clear semaphore flag */
)brace
r_else
(brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_intel8x0_ali_chip_init
c_func
(paren
id|chip
comma
id|probing
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
multiline_comment|/* disable interrupts */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|chip-&gt;bdbars_count
suffix:semicolon
id|i
op_increment
)paren
id|iputbyte
c_func
(paren
id|chip
comma
id|ICH_REG_OFF_CR
op_plus
id|chip-&gt;ichd
(braket
id|i
)braket
dot
id|reg_offset
comma
l_int|0x00
)paren
suffix:semicolon
multiline_comment|/* reset channels */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|chip-&gt;bdbars_count
suffix:semicolon
id|i
op_increment
)paren
id|iputbyte
c_func
(paren
id|chip
comma
id|ICH_REG_OFF_CR
op_plus
id|chip-&gt;ichd
(braket
id|i
)braket
dot
id|reg_offset
comma
id|ICH_RESETREGS
)paren
suffix:semicolon
multiline_comment|/* initialize Buffer Descriptor Lists */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|chip-&gt;bdbars_count
suffix:semicolon
id|i
op_increment
)paren
id|iputdword
c_func
(paren
id|chip
comma
id|ICH_REG_OFF_BDBAR
op_plus
id|chip-&gt;ichd
(braket
id|i
)braket
dot
id|reg_offset
comma
id|chip-&gt;ichd
(braket
id|i
)braket
dot
id|bdbar_addr
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_intel8x0_free
r_static
r_int
id|snd_intel8x0_free
c_func
(paren
id|intel8x0_t
op_star
id|chip
)paren
(brace
r_int
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;irq
OL
l_int|0
)paren
r_goto
id|__hw_end
suffix:semicolon
multiline_comment|/* disable interrupts */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|chip-&gt;bdbars_count
suffix:semicolon
id|i
op_increment
)paren
id|iputbyte
c_func
(paren
id|chip
comma
id|ICH_REG_OFF_CR
op_plus
id|chip-&gt;ichd
(braket
id|i
)braket
dot
id|reg_offset
comma
l_int|0x00
)paren
suffix:semicolon
multiline_comment|/* reset channels */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|chip-&gt;bdbars_count
suffix:semicolon
id|i
op_increment
)paren
id|iputbyte
c_func
(paren
id|chip
comma
id|ICH_REG_OFF_CR
op_plus
id|chip-&gt;ichd
(braket
id|i
)braket
dot
id|reg_offset
comma
id|ICH_RESETREGS
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;device_type
op_eq
id|DEVICE_NFORCE
)paren
(brace
multiline_comment|/* stop the spdif interrupt */
r_int
r_int
id|val
suffix:semicolon
id|pci_read_config_dword
c_func
(paren
id|chip-&gt;pci
comma
l_int|0x4c
comma
op_amp
id|val
)paren
suffix:semicolon
id|val
op_and_assign
op_complement
l_int|0x1000000
suffix:semicolon
id|pci_write_config_dword
c_func
(paren
id|chip-&gt;pci
comma
l_int|0x4c
comma
id|val
)paren
suffix:semicolon
)brace
multiline_comment|/* --- */
id|synchronize_irq
c_func
(paren
id|chip-&gt;irq
)paren
suffix:semicolon
id|__hw_end
suffix:colon
r_if
c_cond
(paren
id|chip-&gt;irq
op_ge
l_int|0
)paren
id|free_irq
c_func
(paren
id|chip-&gt;irq
comma
(paren
r_void
op_star
)paren
id|chip
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;bdbars.area
)paren
(brace
r_if
c_cond
(paren
id|chip-&gt;fix_nocache
)paren
id|fill_nocache
c_func
(paren
id|chip-&gt;bdbars.area
comma
id|chip-&gt;bdbars.bytes
comma
l_int|0
)paren
suffix:semicolon
id|snd_dma_free_pages
c_func
(paren
op_amp
id|chip-&gt;bdbars
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|chip-&gt;remap_addr
)paren
id|iounmap
c_func
(paren
id|chip-&gt;remap_addr
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;remap_bmaddr
)paren
id|iounmap
c_func
(paren
id|chip-&gt;remap_bmaddr
)paren
suffix:semicolon
id|pci_release_regions
c_func
(paren
id|chip-&gt;pci
)paren
suffix:semicolon
id|pci_disable_device
c_func
(paren
id|chip-&gt;pci
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|chip
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_PM
multiline_comment|/*&n; * power management&n; */
DECL|function|intel8x0_suspend
r_static
r_int
id|intel8x0_suspend
c_func
(paren
id|snd_card_t
op_star
id|card
comma
r_int
r_int
id|state
)paren
(brace
id|intel8x0_t
op_star
id|chip
op_assign
id|card-&gt;pm_private_data
suffix:semicolon
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|chip-&gt;pcm_devs
suffix:semicolon
id|i
op_increment
)paren
id|snd_pcm_suspend_all
c_func
(paren
id|chip-&gt;pcm
(braket
id|i
)braket
)paren
suffix:semicolon
multiline_comment|/* clear nocache */
r_if
c_cond
(paren
id|chip-&gt;fix_nocache
)paren
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|chip-&gt;bdbars_count
suffix:semicolon
id|i
op_increment
)paren
(brace
id|ichdev_t
op_star
id|ichdev
op_assign
op_amp
id|chip-&gt;ichd
(braket
id|i
)braket
suffix:semicolon
r_if
c_cond
(paren
id|ichdev-&gt;substream
op_logical_and
id|ichdev-&gt;page_attr_changed
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|ichdev-&gt;substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;dma_area
)paren
id|fill_nocache
c_func
(paren
id|runtime-&gt;dma_area
comma
id|runtime-&gt;dma_bytes
comma
l_int|0
)paren
suffix:semicolon
)brace
)brace
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|3
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|chip-&gt;ac97
(braket
id|i
)braket
)paren
id|snd_ac97_suspend
c_func
(paren
id|chip-&gt;ac97
(braket
id|i
)braket
)paren
suffix:semicolon
id|pci_disable_device
c_func
(paren
id|chip-&gt;pci
)paren
suffix:semicolon
id|snd_power_change_state
c_func
(paren
id|card
comma
id|SNDRV_CTL_POWER_D3hot
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|intel8x0_resume
r_static
r_int
id|intel8x0_resume
c_func
(paren
id|snd_card_t
op_star
id|card
comma
r_int
r_int
id|state
)paren
(brace
id|intel8x0_t
op_star
id|chip
op_assign
id|card-&gt;pm_private_data
suffix:semicolon
r_int
id|i
suffix:semicolon
id|pci_enable_device
c_func
(paren
id|chip-&gt;pci
)paren
suffix:semicolon
id|pci_set_master
c_func
(paren
id|chip-&gt;pci
)paren
suffix:semicolon
id|snd_intel8x0_chip_init
c_func
(paren
id|chip
comma
l_int|0
)paren
suffix:semicolon
multiline_comment|/* refill nocache */
r_if
c_cond
(paren
id|chip-&gt;fix_nocache
)paren
id|fill_nocache
c_func
(paren
id|chip-&gt;bdbars.area
comma
id|chip-&gt;bdbars.bytes
comma
l_int|1
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|3
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|chip-&gt;ac97
(braket
id|i
)braket
)paren
id|snd_ac97_resume
c_func
(paren
id|chip-&gt;ac97
(braket
id|i
)braket
)paren
suffix:semicolon
multiline_comment|/* refill nocache */
r_if
c_cond
(paren
id|chip-&gt;fix_nocache
)paren
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|chip-&gt;bdbars_count
suffix:semicolon
id|i
op_increment
)paren
(brace
id|ichdev_t
op_star
id|ichdev
op_assign
op_amp
id|chip-&gt;ichd
(braket
id|i
)braket
suffix:semicolon
r_if
c_cond
(paren
id|ichdev-&gt;substream
op_logical_and
id|ichdev-&gt;page_attr_changed
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|ichdev-&gt;substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;dma_area
)paren
id|fill_nocache
c_func
(paren
id|runtime-&gt;dma_area
comma
id|runtime-&gt;dma_bytes
comma
l_int|1
)paren
suffix:semicolon
)brace
)brace
)brace
id|snd_power_change_state
c_func
(paren
id|card
comma
id|SNDRV_CTL_POWER_D0
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#endif /* CONFIG_PM */
DECL|macro|INTEL8X0_TESTBUF_SIZE
mdefine_line|#define INTEL8X0_TESTBUF_SIZE&t;32768&t;/* enough large for one shot */
DECL|function|intel8x0_measure_ac97_clock
r_static
r_void
id|__devinit
id|intel8x0_measure_ac97_clock
c_func
(paren
id|intel8x0_t
op_star
id|chip
)paren
(brace
id|snd_pcm_substream_t
op_star
id|subs
suffix:semicolon
id|ichdev_t
op_star
id|ichdev
suffix:semicolon
r_int
r_int
id|port
suffix:semicolon
r_int
r_int
id|pos
comma
id|t
suffix:semicolon
r_struct
id|timeval
id|start_time
comma
id|stop_time
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;ac97_bus-&gt;clock
op_ne
l_int|48000
)paren
r_return
suffix:semicolon
multiline_comment|/* specified in module option */
id|subs
op_assign
id|chip-&gt;pcm
(braket
l_int|0
)braket
op_member_access_from_pointer
id|streams
(braket
l_int|0
)braket
dot
id|substream
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|subs
op_logical_or
id|subs-&gt;dma_buffer.bytes
OL
id|INTEL8X0_TESTBUF_SIZE
)paren
(brace
id|snd_printk
c_func
(paren
l_string|&quot;no playback buffer allocated - aborting measure ac97 clock&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|ichdev
op_assign
op_amp
id|chip-&gt;ichd
(braket
id|ICHD_PCMOUT
)braket
suffix:semicolon
id|ichdev-&gt;physbuf
op_assign
id|subs-&gt;dma_buffer.addr
suffix:semicolon
id|ichdev-&gt;size
op_assign
id|chip-&gt;ichd
(braket
id|ICHD_PCMOUT
)braket
dot
id|fragsize
op_assign
id|INTEL8X0_TESTBUF_SIZE
suffix:semicolon
id|ichdev-&gt;substream
op_assign
l_int|NULL
suffix:semicolon
multiline_comment|/* don&squot;t process interrupts */
multiline_comment|/* set rate */
r_if
c_cond
(paren
id|snd_ac97_set_rate
c_func
(paren
id|chip-&gt;ac97
(braket
l_int|0
)braket
comma
id|AC97_PCM_FRONT_DAC_RATE
comma
l_int|48000
)paren
OL
l_int|0
)paren
(brace
id|snd_printk
c_func
(paren
id|KERN_ERR
l_string|&quot;cannot set ac97 rate: clock = %d&bslash;n&quot;
comma
id|chip-&gt;ac97_bus-&gt;clock
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|snd_intel8x0_setup_periods
c_func
(paren
id|chip
comma
id|ichdev
)paren
suffix:semicolon
id|port
op_assign
id|ichdev-&gt;reg_offset
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
id|chip-&gt;in_measurement
op_assign
l_int|1
suffix:semicolon
multiline_comment|/* trigger */
r_if
c_cond
(paren
id|chip-&gt;device_type
op_ne
id|DEVICE_ALI
)paren
id|iputbyte
c_func
(paren
id|chip
comma
id|port
op_plus
id|ICH_REG_OFF_CR
comma
id|ICH_IOCE
op_or
id|ICH_STARTBM
)paren
suffix:semicolon
r_else
(brace
id|iputbyte
c_func
(paren
id|chip
comma
id|port
op_plus
id|ICH_REG_OFF_CR
comma
id|ICH_IOCE
)paren
suffix:semicolon
id|iputdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|ALI_DMACR
)paren
comma
l_int|1
op_lshift
id|ichdev-&gt;ali_slot
)paren
suffix:semicolon
)brace
id|do_gettimeofday
c_func
(paren
op_amp
id|start_time
)paren
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
id|set_current_state
c_func
(paren
id|TASK_UNINTERRUPTIBLE
)paren
suffix:semicolon
id|schedule_timeout
c_func
(paren
id|HZ
op_div
l_int|20
)paren
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
multiline_comment|/* check the position */
id|pos
op_assign
id|ichdev-&gt;fragsize1
suffix:semicolon
id|pos
op_sub_assign
id|igetword
c_func
(paren
id|chip
comma
id|ichdev-&gt;reg_offset
op_plus
id|ichdev-&gt;roff_picb
)paren
op_lshift
id|ichdev-&gt;pos_shift
suffix:semicolon
id|pos
op_add_assign
id|ichdev-&gt;position
suffix:semicolon
id|chip-&gt;in_measurement
op_assign
l_int|0
suffix:semicolon
id|do_gettimeofday
c_func
(paren
op_amp
id|stop_time
)paren
suffix:semicolon
multiline_comment|/* stop */
r_if
c_cond
(paren
id|chip-&gt;device_type
op_eq
id|DEVICE_ALI
)paren
(brace
id|iputdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|ALI_DMACR
)paren
comma
l_int|1
op_lshift
(paren
id|ichdev-&gt;ali_slot
op_plus
l_int|8
)paren
)paren
suffix:semicolon
id|iputbyte
c_func
(paren
id|chip
comma
id|port
op_plus
id|ICH_REG_OFF_CR
comma
l_int|0
)paren
suffix:semicolon
r_while
c_loop
(paren
id|igetbyte
c_func
(paren
id|chip
comma
id|port
op_plus
id|ICH_REG_OFF_CR
)paren
)paren
suffix:semicolon
)brace
r_else
(brace
id|iputbyte
c_func
(paren
id|chip
comma
id|port
op_plus
id|ICH_REG_OFF_CR
comma
l_int|0
)paren
suffix:semicolon
r_while
c_loop
(paren
op_logical_neg
(paren
id|igetbyte
c_func
(paren
id|chip
comma
id|port
op_plus
id|ichdev-&gt;roff_sr
)paren
op_amp
id|ICH_DCH
)paren
)paren
suffix:semicolon
)brace
id|iputbyte
c_func
(paren
id|chip
comma
id|port
op_plus
id|ICH_REG_OFF_CR
comma
id|ICH_RESETREGS
)paren
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
id|t
op_assign
id|stop_time.tv_sec
op_minus
id|start_time.tv_sec
suffix:semicolon
id|t
op_mul_assign
l_int|1000000
suffix:semicolon
id|t
op_add_assign
id|stop_time.tv_usec
op_minus
id|start_time.tv_usec
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;%s: measured %lu usecs&bslash;n&quot;
comma
id|__FUNCTION__
comma
id|t
)paren
suffix:semicolon
r_if
c_cond
(paren
id|t
op_eq
l_int|0
)paren
(brace
id|snd_printk
c_func
(paren
id|KERN_ERR
l_string|&quot;?? calculation error..&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|pos
op_assign
(paren
id|pos
op_div
l_int|4
)paren
op_star
l_int|1000
suffix:semicolon
id|pos
op_assign
(paren
id|pos
op_div
id|t
)paren
op_star
l_int|1000
op_plus
(paren
(paren
id|pos
op_mod
id|t
)paren
op_star
l_int|1000
)paren
op_div
id|t
suffix:semicolon
r_if
c_cond
(paren
id|pos
OL
l_int|40000
op_logical_or
id|pos
op_ge
l_int|60000
)paren
multiline_comment|/* abnormal value. hw problem? */
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;intel8x0: measured clock %ld rejected&bslash;n&quot;
comma
id|pos
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|pos
template_param
l_int|48500
)paren
multiline_comment|/* not 48000Hz, tuning the clock.. */
id|chip-&gt;ac97_bus-&gt;clock
op_assign
(paren
id|chip-&gt;ac97_bus-&gt;clock
op_star
l_int|48000
)paren
op_div
id|pos
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;intel8x0: clocking to %d&bslash;n&quot;
comma
id|chip-&gt;ac97_bus-&gt;clock
)paren
suffix:semicolon
)brace
DECL|function|snd_intel8x0_proc_read
r_static
r_void
id|snd_intel8x0_proc_read
c_func
(paren
id|snd_info_entry_t
op_star
id|entry
comma
id|snd_info_buffer_t
op_star
id|buffer
)paren
(brace
id|intel8x0_t
op_star
id|chip
op_assign
id|entry-&gt;private_data
suffix:semicolon
r_int
r_int
id|tmp
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Intel8x0&bslash;n&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;device_type
op_eq
id|DEVICE_ALI
)paren
r_return
suffix:semicolon
id|tmp
op_assign
id|igetdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|GLOB_STA
)paren
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Global control        : 0x%08x&bslash;n&quot;
comma
id|igetdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|GLOB_CNT
)paren
)paren
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Global status         : 0x%08x&bslash;n&quot;
comma
id|tmp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;device_type
op_eq
id|DEVICE_INTEL_ICH4
)paren
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;SDM                   : 0x%08x&bslash;n&quot;
comma
id|igetdword
c_func
(paren
id|chip
comma
id|ICHREG
c_func
(paren
id|SDM
)paren
)paren
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;AC&squot;97 codecs ready    :%s%s%s%s&bslash;n&quot;
comma
id|tmp
op_amp
id|ICH_PCR
ques
c_cond
l_string|&quot; primary&quot;
suffix:colon
l_string|&quot;&quot;
comma
id|tmp
op_amp
id|ICH_SCR
ques
c_cond
l_string|&quot; secondary&quot;
suffix:colon
l_string|&quot;&quot;
comma
id|tmp
op_amp
id|ICH_TCR
ques
c_cond
l_string|&quot; tertiary&quot;
suffix:colon
l_string|&quot;&quot;
comma
(paren
id|tmp
op_amp
(paren
id|ICH_PCR
op_or
id|ICH_SCR
op_or
id|ICH_TCR
)paren
)paren
op_eq
l_int|0
ques
c_cond
l_string|&quot; none&quot;
suffix:colon
l_string|&quot;&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;device_type
op_eq
id|DEVICE_INTEL_ICH4
)paren
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;AC&squot;97 codecs SDIN     : %i %i %i&bslash;n&quot;
comma
id|chip-&gt;ac97_sdin
(braket
l_int|0
)braket
comma
id|chip-&gt;ac97_sdin
(braket
l_int|1
)braket
comma
id|chip-&gt;ac97_sdin
(braket
l_int|2
)braket
)paren
suffix:semicolon
)brace
DECL|function|snd_intel8x0_proc_init
r_static
r_void
id|__devinit
id|snd_intel8x0_proc_init
c_func
(paren
id|intel8x0_t
op_star
id|chip
)paren
(brace
id|snd_info_entry_t
op_star
id|entry
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snd_card_proc_new
c_func
(paren
id|chip-&gt;card
comma
l_string|&quot;intel8x0&quot;
comma
op_amp
id|entry
)paren
)paren
id|snd_info_set_text_ops
c_func
(paren
id|entry
comma
id|chip
comma
l_int|1024
comma
id|snd_intel8x0_proc_read
)paren
suffix:semicolon
)brace
DECL|function|snd_intel8x0_dev_free
r_static
r_int
id|snd_intel8x0_dev_free
c_func
(paren
id|snd_device_t
op_star
id|device
)paren
(brace
id|intel8x0_t
op_star
id|chip
op_assign
id|device-&gt;device_data
suffix:semicolon
r_return
id|snd_intel8x0_free
c_func
(paren
id|chip
)paren
suffix:semicolon
)brace
DECL|struct|ich_reg_info
r_struct
id|ich_reg_info
(brace
DECL|member|int_sta_mask
r_int
r_int
id|int_sta_mask
suffix:semicolon
DECL|member|offset
r_int
r_int
id|offset
suffix:semicolon
)brace
suffix:semicolon
DECL|function|snd_intel8x0_create
r_static
r_int
id|__devinit
id|snd_intel8x0_create
c_func
(paren
id|snd_card_t
op_star
id|card
comma
r_struct
id|pci_dev
op_star
id|pci
comma
r_int
r_int
id|device_type
comma
id|intel8x0_t
op_star
op_star
id|r_intel8x0
)paren
(brace
id|intel8x0_t
op_star
id|chip
suffix:semicolon
r_int
id|err
suffix:semicolon
r_int
r_int
id|i
suffix:semicolon
r_int
r_int
id|int_sta_masks
suffix:semicolon
id|ichdev_t
op_star
id|ichdev
suffix:semicolon
r_static
id|snd_device_ops_t
id|ops
op_assign
(brace
dot
id|dev_free
op_assign
id|snd_intel8x0_dev_free
comma
)brace
suffix:semicolon
r_static
r_int
r_int
id|bdbars
(braket
)braket
op_assign
(brace
l_int|3
comma
multiline_comment|/* DEVICE_INTEL */
l_int|6
comma
multiline_comment|/* DEVICE_INTEL_ICH4 */
l_int|3
comma
multiline_comment|/* DEVICE_SIS */
l_int|6
comma
multiline_comment|/* DEVICE_ALI */
l_int|4
comma
multiline_comment|/* DEVICE_NFORCE */
)brace
suffix:semicolon
r_static
r_struct
id|ich_reg_info
id|intel_regs
(braket
l_int|6
)braket
op_assign
(brace
(brace
id|ICH_PIINT
comma
l_int|0
)brace
comma
(brace
id|ICH_POINT
comma
l_int|0x10
)brace
comma
(brace
id|ICH_MCINT
comma
l_int|0x20
)brace
comma
(brace
id|ICH_M2INT
comma
l_int|0x40
)brace
comma
(brace
id|ICH_P2INT
comma
l_int|0x50
)brace
comma
(brace
id|ICH_SPINT
comma
l_int|0x60
)brace
comma
)brace
suffix:semicolon
r_static
r_struct
id|ich_reg_info
id|nforce_regs
(braket
l_int|4
)braket
op_assign
(brace
(brace
id|ICH_PIINT
comma
l_int|0
)brace
comma
(brace
id|ICH_POINT
comma
l_int|0x10
)brace
comma
(brace
id|ICH_MCINT
comma
l_int|0x20
)brace
comma
(brace
id|ICH_NVSPINT
comma
l_int|0x70
)brace
comma
)brace
suffix:semicolon
r_static
r_struct
id|ich_reg_info
id|ali_regs
(braket
l_int|6
)braket
op_assign
(brace
(brace
id|ALI_INT_PCMIN
comma
l_int|0x40
)brace
comma
(brace
id|ALI_INT_PCMOUT
comma
l_int|0x50
)brace
comma
(brace
id|ALI_INT_MICIN
comma
l_int|0x60
)brace
comma
(brace
id|ALI_INT_CODECSPDIFOUT
comma
l_int|0x70
)brace
comma
(brace
id|ALI_INT_SPDIFIN
comma
l_int|0xa0
)brace
comma
(brace
id|ALI_INT_SPDIFOUT
comma
l_int|0xb0
)brace
comma
)brace
suffix:semicolon
r_struct
id|ich_reg_info
op_star
id|tbl
suffix:semicolon
op_star
id|r_intel8x0
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|pci_enable_device
c_func
(paren
id|pci
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|chip
op_assign
id|kcalloc
c_func
(paren
l_int|1
comma
r_sizeof
(paren
op_star
id|chip
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chip
op_eq
l_int|NULL
)paren
(brace
id|pci_disable_device
c_func
(paren
id|pci
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|spin_lock_init
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
id|spin_lock_init
c_func
(paren
op_amp
id|chip-&gt;ac97_lock
)paren
suffix:semicolon
id|chip-&gt;device_type
op_assign
id|device_type
suffix:semicolon
id|chip-&gt;card
op_assign
id|card
suffix:semicolon
id|chip-&gt;pci
op_assign
id|pci
suffix:semicolon
id|chip-&gt;irq
op_assign
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|pci-&gt;vendor
op_eq
id|PCI_VENDOR_ID_INTEL
op_logical_and
id|pci-&gt;device
op_eq
id|PCI_DEVICE_ID_INTEL_440MX
)paren
id|chip-&gt;fix_nocache
op_assign
l_int|1
suffix:semicolon
multiline_comment|/* enable workaround */
multiline_comment|/* some Nforce[2] and ICH boards have problems with IRQ handling.&n;&t; * Needs to return IRQ_HANDLED for unknown irqs.&n;&t; */
r_if
c_cond
(paren
id|device_type
op_eq
id|DEVICE_NFORCE
)paren
id|chip-&gt;buggy_irq
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|pci_request_regions
c_func
(paren
id|pci
comma
id|card-&gt;shortname
)paren
)paren
OL
l_int|0
)paren
(brace
id|kfree
c_func
(paren
id|chip
)paren
suffix:semicolon
id|pci_disable_device
c_func
(paren
id|pci
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
r_if
c_cond
(paren
id|device_type
op_eq
id|DEVICE_ALI
)paren
(brace
multiline_comment|/* ALI5455 has no ac97 region */
id|chip-&gt;bmaddr
op_assign
id|pci_resource_start
c_func
(paren
id|pci
comma
l_int|0
)paren
suffix:semicolon
r_goto
id|port_inited
suffix:semicolon
)brace
r_if
c_cond
(paren
id|pci_resource_flags
c_func
(paren
id|pci
comma
l_int|2
)paren
op_amp
id|IORESOURCE_MEM
)paren
(brace
multiline_comment|/* ICH4 and Nforce */
id|chip-&gt;mmio
op_assign
l_int|1
suffix:semicolon
id|chip-&gt;addr
op_assign
id|pci_resource_start
c_func
(paren
id|pci
comma
l_int|2
)paren
suffix:semicolon
id|chip-&gt;remap_addr
op_assign
id|ioremap_nocache
c_func
(paren
id|chip-&gt;addr
comma
id|pci_resource_len
c_func
(paren
id|pci
comma
l_int|2
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;remap_addr
op_eq
l_int|NULL
)paren
(brace
id|snd_printk
c_func
(paren
l_string|&quot;AC&squot;97 space ioremap problem&bslash;n&quot;
)paren
suffix:semicolon
id|snd_intel8x0_free
c_func
(paren
id|chip
)paren
suffix:semicolon
r_return
op_minus
id|EIO
suffix:semicolon
)brace
)brace
r_else
(brace
id|chip-&gt;addr
op_assign
id|pci_resource_start
c_func
(paren
id|pci
comma
l_int|0
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|pci_resource_flags
c_func
(paren
id|pci
comma
l_int|3
)paren
op_amp
id|IORESOURCE_MEM
)paren
(brace
multiline_comment|/* ICH4 */
id|chip-&gt;bm_mmio
op_assign
l_int|1
suffix:semicolon
id|chip-&gt;bmaddr
op_assign
id|pci_resource_start
c_func
(paren
id|pci
comma
l_int|3
)paren
suffix:semicolon
id|chip-&gt;remap_bmaddr
op_assign
id|ioremap_nocache
c_func
(paren
id|chip-&gt;bmaddr
comma
id|pci_resource_len
c_func
(paren
id|pci
comma
l_int|3
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;remap_bmaddr
op_eq
l_int|NULL
)paren
(brace
id|snd_printk
c_func
(paren
l_string|&quot;Controller space ioremap problem&bslash;n&quot;
)paren
suffix:semicolon
id|snd_intel8x0_free
c_func
(paren
id|chip
)paren
suffix:semicolon
r_return
op_minus
id|EIO
suffix:semicolon
)brace
)brace
r_else
(brace
id|chip-&gt;bmaddr
op_assign
id|pci_resource_start
c_func
(paren
id|pci
comma
l_int|1
)paren
suffix:semicolon
)brace
id|port_inited
suffix:colon
r_if
c_cond
(paren
id|request_irq
c_func
(paren
id|pci-&gt;irq
comma
id|snd_intel8x0_interrupt
comma
id|SA_INTERRUPT
op_or
id|SA_SHIRQ
comma
id|card-&gt;shortname
comma
(paren
r_void
op_star
)paren
id|chip
)paren
)paren
(brace
id|snd_printk
c_func
(paren
l_string|&quot;unable to grab IRQ %d&bslash;n&quot;
comma
id|pci-&gt;irq
)paren
suffix:semicolon
id|snd_intel8x0_free
c_func
(paren
id|chip
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
id|chip-&gt;irq
op_assign
id|pci-&gt;irq
suffix:semicolon
id|pci_set_master
c_func
(paren
id|pci
)paren
suffix:semicolon
id|synchronize_irq
c_func
(paren
id|chip-&gt;irq
)paren
suffix:semicolon
id|chip-&gt;bdbars_count
op_assign
id|bdbars
(braket
id|device_type
)braket
suffix:semicolon
multiline_comment|/* initialize offsets */
r_switch
c_cond
(paren
id|device_type
)paren
(brace
r_case
id|DEVICE_NFORCE
suffix:colon
id|tbl
op_assign
id|nforce_regs
suffix:semicolon
r_break
suffix:semicolon
r_case
id|DEVICE_ALI
suffix:colon
id|tbl
op_assign
id|ali_regs
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|tbl
op_assign
id|intel_regs
suffix:semicolon
r_break
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|chip-&gt;bdbars_count
suffix:semicolon
id|i
op_increment
)paren
(brace
id|ichdev
op_assign
op_amp
id|chip-&gt;ichd
(braket
id|i
)braket
suffix:semicolon
id|ichdev-&gt;ichd
op_assign
id|i
suffix:semicolon
id|ichdev-&gt;reg_offset
op_assign
id|tbl
(braket
id|i
)braket
dot
id|offset
suffix:semicolon
id|ichdev-&gt;int_sta_mask
op_assign
id|tbl
(braket
id|i
)braket
dot
id|int_sta_mask
suffix:semicolon
r_if
c_cond
(paren
id|device_type
op_eq
id|DEVICE_SIS
)paren
(brace
multiline_comment|/* SiS 7012 swaps the registers */
id|ichdev-&gt;roff_sr
op_assign
id|ICH_REG_OFF_PICB
suffix:semicolon
id|ichdev-&gt;roff_picb
op_assign
id|ICH_REG_OFF_SR
suffix:semicolon
)brace
r_else
(brace
id|ichdev-&gt;roff_sr
op_assign
id|ICH_REG_OFF_SR
suffix:semicolon
id|ichdev-&gt;roff_picb
op_assign
id|ICH_REG_OFF_PICB
suffix:semicolon
)brace
r_if
c_cond
(paren
id|device_type
op_eq
id|DEVICE_ALI
)paren
id|ichdev-&gt;ali_slot
op_assign
(paren
id|ichdev-&gt;reg_offset
op_minus
l_int|0x40
)paren
op_div
l_int|0x10
suffix:semicolon
multiline_comment|/* SIS7012 handles the pcm data in bytes, others are in samples */
id|ichdev-&gt;pos_shift
op_assign
(paren
id|device_type
op_eq
id|DEVICE_SIS
)paren
ques
c_cond
l_int|0
suffix:colon
l_int|1
suffix:semicolon
)brace
multiline_comment|/* allocate buffer descriptor lists */
multiline_comment|/* the start of each lists must be aligned to 8 bytes */
r_if
c_cond
(paren
id|snd_dma_alloc_pages
c_func
(paren
id|SNDRV_DMA_TYPE_DEV
comma
id|snd_dma_pci_data
c_func
(paren
id|pci
)paren
comma
id|chip-&gt;bdbars_count
op_star
r_sizeof
(paren
id|u32
)paren
op_star
id|ICH_MAX_FRAGS
op_star
l_int|2
comma
op_amp
id|chip-&gt;bdbars
)paren
OL
l_int|0
)paren
(brace
id|snd_intel8x0_free
c_func
(paren
id|chip
)paren
suffix:semicolon
id|snd_printk
c_func
(paren
id|KERN_ERR
l_string|&quot;intel8x0: cannot allocate buffer descriptors&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
multiline_comment|/* tables must be aligned to 8 bytes here, but the kernel pages&n;&t;   are much bigger, so we don&squot;t care (on i386) */
multiline_comment|/* workaround for 440MX */
r_if
c_cond
(paren
id|chip-&gt;fix_nocache
)paren
id|fill_nocache
c_func
(paren
id|chip-&gt;bdbars.area
comma
id|chip-&gt;bdbars.bytes
comma
l_int|1
)paren
suffix:semicolon
id|int_sta_masks
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|chip-&gt;bdbars_count
suffix:semicolon
id|i
op_increment
)paren
(brace
id|ichdev
op_assign
op_amp
id|chip-&gt;ichd
(braket
id|i
)braket
suffix:semicolon
id|ichdev-&gt;bdbar
op_assign
(paren
(paren
id|u32
op_star
)paren
id|chip-&gt;bdbars.area
)paren
op_plus
(paren
id|i
op_star
id|ICH_MAX_FRAGS
op_star
l_int|2
)paren
suffix:semicolon
id|ichdev-&gt;bdbar_addr
op_assign
id|chip-&gt;bdbars.addr
op_plus
(paren
id|i
op_star
r_sizeof
(paren
id|u32
)paren
op_star
id|ICH_MAX_FRAGS
op_star
l_int|2
)paren
suffix:semicolon
id|int_sta_masks
op_or_assign
id|ichdev-&gt;int_sta_mask
suffix:semicolon
)brace
id|chip-&gt;int_sta_reg
op_assign
id|device_type
op_eq
id|DEVICE_ALI
ques
c_cond
id|ICH_REG_ALI_INTERRUPTSR
suffix:colon
id|ICH_REG_GLOB_STA
suffix:semicolon
id|chip-&gt;int_sta_mask
op_assign
id|int_sta_masks
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_intel8x0_chip_init
c_func
(paren
id|chip
comma
l_int|1
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_intel8x0_free
c_func
(paren
id|chip
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
id|snd_card_set_pm_callback
c_func
(paren
id|card
comma
id|intel8x0_suspend
comma
id|intel8x0_resume
comma
id|chip
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_device_new
c_func
(paren
id|card
comma
id|SNDRV_DEV_LOWLEVEL
comma
id|chip
comma
op_amp
id|ops
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_intel8x0_free
c_func
(paren
id|chip
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
id|snd_card_set_dev
c_func
(paren
id|card
comma
op_amp
id|pci-&gt;dev
)paren
suffix:semicolon
op_star
id|r_intel8x0
op_assign
id|chip
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|struct|shortname_table
r_static
r_struct
id|shortname_table
(brace
DECL|member|id
r_int
r_int
id|id
suffix:semicolon
DECL|member|s
r_const
r_char
op_star
id|s
suffix:semicolon
DECL|variable|__devinitdata
)brace
id|shortnames
(braket
)braket
id|__devinitdata
op_assign
(brace
(brace
id|PCI_DEVICE_ID_INTEL_82801
comma
l_string|&quot;Intel 82801AA-ICH&quot;
)brace
comma
(brace
id|PCI_DEVICE_ID_INTEL_82901
comma
l_string|&quot;Intel 82901AB-ICH0&quot;
)brace
comma
(brace
id|PCI_DEVICE_ID_INTEL_82801BA
comma
l_string|&quot;Intel 82801BA-ICH2&quot;
)brace
comma
(brace
id|PCI_DEVICE_ID_INTEL_440MX
comma
l_string|&quot;Intel 440MX&quot;
)brace
comma
(brace
id|PCI_DEVICE_ID_INTEL_ICH3
comma
l_string|&quot;Intel 82801CA-ICH3&quot;
)brace
comma
(brace
id|PCI_DEVICE_ID_INTEL_ICH4
comma
l_string|&quot;Intel 82801DB-ICH4&quot;
)brace
comma
(brace
id|PCI_DEVICE_ID_INTEL_ICH5
comma
l_string|&quot;Intel ICH5&quot;
)brace
comma
(brace
id|PCI_DEVICE_ID_INTEL_ESB_5
comma
l_string|&quot;Intel 6300ESB&quot;
)brace
comma
(brace
id|PCI_DEVICE_ID_INTEL_ICH6_3
comma
l_string|&quot;Intel ICH6&quot;
)brace
comma
(brace
id|PCI_DEVICE_ID_SI_7012
comma
l_string|&quot;SiS SI7012&quot;
)brace
comma
(brace
id|PCI_DEVICE_ID_NVIDIA_MCP_AUDIO
comma
l_string|&quot;NVidia nForce&quot;
)brace
comma
(brace
id|PCI_DEVICE_ID_NVIDIA_MCP2_AUDIO
comma
l_string|&quot;NVidia nForce2&quot;
)brace
comma
(brace
id|PCI_DEVICE_ID_NVIDIA_MCP3_AUDIO
comma
l_string|&quot;NVidia nForce3&quot;
)brace
comma
(brace
id|PCI_DEVICE_ID_NVIDIA_CK8S_AUDIO
comma
l_string|&quot;NVidia CK8S&quot;
)brace
comma
(brace
id|PCI_DEVICE_ID_NVIDIA_CK804_AUDIO
comma
l_string|&quot;NVidia CK804&quot;
)brace
comma
(brace
id|PCI_DEVICE_ID_NVIDIA_CK8_AUDIO
comma
l_string|&quot;NVidia CK8&quot;
)brace
comma
(brace
l_int|0x003a
comma
l_string|&quot;NVidia MCP04&quot;
)brace
comma
(brace
l_int|0x746d
comma
l_string|&quot;AMD AMD8111&quot;
)brace
comma
(brace
l_int|0x7445
comma
l_string|&quot;AMD AMD768&quot;
)brace
comma
(brace
l_int|0x5455
comma
l_string|&quot;ALi M5455&quot;
)brace
comma
(brace
l_int|0
comma
l_int|NULL
)brace
comma
)brace
suffix:semicolon
DECL|function|snd_intel8x0_probe
r_static
r_int
id|__devinit
id|snd_intel8x0_probe
c_func
(paren
r_struct
id|pci_dev
op_star
id|pci
comma
r_const
r_struct
id|pci_device_id
op_star
id|pci_id
)paren
(brace
r_static
r_int
id|dev
suffix:semicolon
id|snd_card_t
op_star
id|card
suffix:semicolon
id|intel8x0_t
op_star
id|chip
suffix:semicolon
r_int
id|err
suffix:semicolon
r_struct
id|shortname_table
op_star
id|name
suffix:semicolon
r_if
c_cond
(paren
id|dev
op_ge
id|SNDRV_CARDS
)paren
r_return
op_minus
id|ENODEV
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|enable
(braket
id|dev
)braket
)paren
(brace
id|dev
op_increment
suffix:semicolon
r_return
op_minus
id|ENOENT
suffix:semicolon
)brace
id|card
op_assign
id|snd_card_new
c_func
(paren
id|index
(braket
id|dev
)braket
comma
id|id
(braket
id|dev
)braket
comma
id|THIS_MODULE
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|card
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
r_switch
c_cond
(paren
id|pci_id-&gt;driver_data
)paren
(brace
r_case
id|DEVICE_NFORCE
suffix:colon
id|strcpy
c_func
(paren
id|card-&gt;driver
comma
l_string|&quot;NFORCE&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|DEVICE_INTEL_ICH4
suffix:colon
id|strcpy
c_func
(paren
id|card-&gt;driver
comma
l_string|&quot;ICH4&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|strcpy
c_func
(paren
id|card-&gt;driver
comma
l_string|&quot;ICH&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|strcpy
c_func
(paren
id|card-&gt;shortname
comma
l_string|&quot;Intel ICH&quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|name
op_assign
id|shortnames
suffix:semicolon
id|name-&gt;id
suffix:semicolon
id|name
op_increment
)paren
(brace
r_if
c_cond
(paren
id|pci-&gt;device
op_eq
id|name-&gt;id
)paren
(brace
id|strcpy
c_func
(paren
id|card-&gt;shortname
comma
id|name-&gt;s
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_intel8x0_create
c_func
(paren
id|card
comma
id|pci
comma
id|pci_id-&gt;driver_data
comma
op_amp
id|chip
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_card_free
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
r_if
c_cond
(paren
id|buggy_irq
(braket
id|dev
)braket
)paren
id|chip-&gt;buggy_irq
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|xbox
(braket
id|dev
)braket
)paren
id|chip-&gt;xbox
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_intel8x0_mixer
c_func
(paren
id|chip
comma
id|ac97_clock
(braket
id|dev
)braket
comma
id|ac97_quirk
(braket
id|dev
)braket
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_card_free
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_intel8x0_pcm
c_func
(paren
id|chip
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_card_free
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
id|snd_intel8x0_proc_init
c_func
(paren
id|chip
)paren
suffix:semicolon
id|snprintf
c_func
(paren
id|card-&gt;longname
comma
r_sizeof
(paren
id|card-&gt;longname
)paren
comma
l_string|&quot;%s with %s at %#lx, irq %i&quot;
comma
id|card-&gt;shortname
comma
id|snd_ac97_get_short_name
c_func
(paren
id|chip-&gt;ac97
(braket
l_int|0
)braket
)paren
comma
id|chip-&gt;addr
comma
id|chip-&gt;irq
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ac97_clock
(braket
id|dev
)braket
)paren
id|intel8x0_measure_ac97_clock
c_func
(paren
id|chip
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_card_register
c_func
(paren
id|card
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_card_free
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
id|pci_set_drvdata
c_func
(paren
id|pci
comma
id|card
)paren
suffix:semicolon
id|dev
op_increment
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_intel8x0_remove
r_static
r_void
id|__devexit
id|snd_intel8x0_remove
c_func
(paren
r_struct
id|pci_dev
op_star
id|pci
)paren
(brace
id|snd_card_free
c_func
(paren
id|pci_get_drvdata
c_func
(paren
id|pci
)paren
)paren
suffix:semicolon
id|pci_set_drvdata
c_func
(paren
id|pci
comma
l_int|NULL
)paren
suffix:semicolon
)brace
DECL|variable|driver
r_static
r_struct
id|pci_driver
id|driver
op_assign
(brace
dot
id|name
op_assign
l_string|&quot;Intel ICH&quot;
comma
dot
id|id_table
op_assign
id|snd_intel8x0_ids
comma
dot
id|probe
op_assign
id|snd_intel8x0_probe
comma
dot
id|remove
op_assign
id|__devexit_p
c_func
(paren
id|snd_intel8x0_remove
)paren
comma
id|SND_PCI_PM_CALLBACKS
)brace
suffix:semicolon
DECL|function|alsa_card_intel8x0_init
r_static
r_int
id|__init
id|alsa_card_intel8x0_init
c_func
(paren
r_void
)paren
(brace
r_return
id|pci_module_init
c_func
(paren
op_amp
id|driver
)paren
suffix:semicolon
)brace
DECL|function|alsa_card_intel8x0_exit
r_static
r_void
id|__exit
id|alsa_card_intel8x0_exit
c_func
(paren
r_void
)paren
(brace
id|pci_unregister_driver
c_func
(paren
op_amp
id|driver
)paren
suffix:semicolon
)brace
id|module_init
c_func
(paren
id|alsa_card_intel8x0_init
)paren
id|module_exit
c_func
(paren
id|alsa_card_intel8x0_exit
)paren
eof
