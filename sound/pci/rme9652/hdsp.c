multiline_comment|/*&n; *   ALSA driver for RME Hammerfall DSP audio interface(s)&n; *&n; *      Copyright (c) 2002  Paul Davis&n; *                          Marcus Andersson&n; *                          Thomas Charbonnel&n; *&n; *   This program is free software; you can redistribute it and/or modify&n; *   it under the terms of the GNU General Public License as published by&n; *   the Free Software Foundation; either version 2 of the License, or&n; *   (at your option) any later version.&n; *&n; *   This program is distributed in the hope that it will be useful,&n; *   but WITHOUT ANY WARRANTY; without even the implied warranty of&n; *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; *   GNU General Public License for more details.&n; *&n; *   You should have received a copy of the GNU General Public License&n; *   along with this program; if not, write to the Free Software&n; *   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA&n; *&n; */
macro_line|#include &lt;sound/driver.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/delay.h&gt;
macro_line|#include &lt;linux/interrupt.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;linux/pci.h&gt;
macro_line|#include &lt;linux/firmware.h&gt;
macro_line|#include &lt;linux/moduleparam.h&gt;
macro_line|#include &lt;sound/core.h&gt;
macro_line|#include &lt;sound/control.h&gt;
macro_line|#include &lt;sound/pcm.h&gt;
macro_line|#include &lt;sound/info.h&gt;
macro_line|#include &lt;sound/asoundef.h&gt;
macro_line|#include &lt;sound/rawmidi.h&gt;
macro_line|#include &lt;sound/hwdep.h&gt;
macro_line|#include &lt;sound/initval.h&gt;
macro_line|#include &lt;sound/hdsp.h&gt;
macro_line|#include &lt;asm/byteorder.h&gt;
macro_line|#include &lt;asm/current.h&gt;
macro_line|#include &lt;asm/io.h&gt;
DECL|variable|index
r_static
r_int
id|index
(braket
id|SNDRV_CARDS
)braket
op_assign
id|SNDRV_DEFAULT_IDX
suffix:semicolon
multiline_comment|/* Index 0-MAX */
DECL|variable|id
r_static
r_char
op_star
id|id
(braket
id|SNDRV_CARDS
)braket
op_assign
id|SNDRV_DEFAULT_STR
suffix:semicolon
multiline_comment|/* ID for this card */
DECL|variable|enable
r_static
r_int
id|enable
(braket
id|SNDRV_CARDS
)braket
op_assign
id|SNDRV_DEFAULT_ENABLE_PNP
suffix:semicolon
multiline_comment|/* Enable this card */
DECL|variable|precise_ptr
r_static
r_int
id|precise_ptr
(braket
id|SNDRV_CARDS
)braket
op_assign
(brace
(braket
l_int|0
dot
dot
dot
(paren
id|SNDRV_CARDS
op_minus
l_int|1
)paren
)braket
op_assign
l_int|0
)brace
suffix:semicolon
multiline_comment|/* Enable precise pointer */
DECL|variable|line_outs_monitor
r_static
r_int
id|line_outs_monitor
(braket
id|SNDRV_CARDS
)braket
op_assign
(brace
(braket
l_int|0
dot
dot
dot
(paren
id|SNDRV_CARDS
op_minus
l_int|1
)paren
)braket
op_assign
l_int|0
)brace
suffix:semicolon
multiline_comment|/* Send all inputs/playback to line outs */
id|module_param_array
c_func
(paren
id|index
comma
r_int
comma
l_int|NULL
comma
l_int|0444
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|index
comma
l_string|&quot;Index value for RME Hammerfall DSP interface.&quot;
)paren
suffix:semicolon
id|module_param_array
c_func
(paren
id|id
comma
id|charp
comma
l_int|NULL
comma
l_int|0444
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|id
comma
l_string|&quot;ID string for RME Hammerfall DSP interface.&quot;
)paren
suffix:semicolon
id|module_param_array
c_func
(paren
id|enable
comma
r_bool
comma
l_int|NULL
comma
l_int|0444
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|enable
comma
l_string|&quot;Enable/disable specific Hammerfall DSP soundcards.&quot;
)paren
suffix:semicolon
id|module_param_array
c_func
(paren
id|precise_ptr
comma
r_bool
comma
l_int|NULL
comma
l_int|0444
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|precise_ptr
comma
l_string|&quot;Enable precise pointer (doesn&squot;t work reliably).&quot;
)paren
suffix:semicolon
id|module_param_array
c_func
(paren
id|line_outs_monitor
comma
r_bool
comma
l_int|NULL
comma
l_int|0444
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|line_outs_monitor
comma
l_string|&quot;Send all input and playback streams to line outs by default.&quot;
)paren
suffix:semicolon
id|MODULE_AUTHOR
c_func
(paren
l_string|&quot;Paul Davis &lt;paul@linuxaudiosystems.com&gt;, Marcus Andersson, Thomas Charbonnel &lt;thomas@undata.org&gt;&quot;
)paren
suffix:semicolon
id|MODULE_DESCRIPTION
c_func
(paren
l_string|&quot;RME Hammerfall DSP&quot;
)paren
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
id|MODULE_SUPPORTED_DEVICE
c_func
(paren
l_string|&quot;{{RME Hammerfall-DSP},&quot;
l_string|&quot;{RME HDSP-9652},&quot;
l_string|&quot;{RME HDSP-9632}}&quot;
)paren
suffix:semicolon
DECL|macro|HDSP_MAX_CHANNELS
mdefine_line|#define HDSP_MAX_CHANNELS        26
DECL|macro|HDSP_MAX_DS_CHANNELS
mdefine_line|#define HDSP_MAX_DS_CHANNELS     14
DECL|macro|HDSP_MAX_QS_CHANNELS
mdefine_line|#define HDSP_MAX_QS_CHANNELS     8
DECL|macro|DIGIFACE_SS_CHANNELS
mdefine_line|#define DIGIFACE_SS_CHANNELS     26
DECL|macro|DIGIFACE_DS_CHANNELS
mdefine_line|#define DIGIFACE_DS_CHANNELS     14
DECL|macro|MULTIFACE_SS_CHANNELS
mdefine_line|#define MULTIFACE_SS_CHANNELS    18
DECL|macro|MULTIFACE_DS_CHANNELS
mdefine_line|#define MULTIFACE_DS_CHANNELS    14
DECL|macro|H9652_SS_CHANNELS
mdefine_line|#define H9652_SS_CHANNELS        26
DECL|macro|H9652_DS_CHANNELS
mdefine_line|#define H9652_DS_CHANNELS        14
multiline_comment|/* This does not include possible Analog Extension Boards&n;   AEBs are detected at card initialization&n;*/
DECL|macro|H9632_SS_CHANNELS
mdefine_line|#define H9632_SS_CHANNELS&t; 12
DECL|macro|H9632_DS_CHANNELS
mdefine_line|#define H9632_DS_CHANNELS&t; 8
DECL|macro|H9632_QS_CHANNELS
mdefine_line|#define H9632_QS_CHANNELS&t; 4
multiline_comment|/* Write registers. These are defined as byte-offsets from the iobase value.&n; */
DECL|macro|HDSP_resetPointer
mdefine_line|#define HDSP_resetPointer               0
DECL|macro|HDSP_outputBufferAddress
mdefine_line|#define HDSP_outputBufferAddress&t;32
DECL|macro|HDSP_inputBufferAddress
mdefine_line|#define HDSP_inputBufferAddress&t;&t;36
DECL|macro|HDSP_controlRegister
mdefine_line|#define HDSP_controlRegister&t;&t;64
DECL|macro|HDSP_interruptConfirmation
mdefine_line|#define HDSP_interruptConfirmation&t;96
DECL|macro|HDSP_outputEnable
mdefine_line|#define HDSP_outputEnable&t;  &t;128
DECL|macro|HDSP_control2Reg
mdefine_line|#define HDSP_control2Reg&t;&t;256
DECL|macro|HDSP_midiDataOut0
mdefine_line|#define HDSP_midiDataOut0  &t;&t;352
DECL|macro|HDSP_midiDataOut1
mdefine_line|#define HDSP_midiDataOut1  &t;&t;356
DECL|macro|HDSP_fifoData
mdefine_line|#define HDSP_fifoData  &t;&t;&t;368
DECL|macro|HDSP_inputEnable
mdefine_line|#define HDSP_inputEnable&t; &t;384
multiline_comment|/* Read registers. These are defined as byte-offsets from the iobase value&n; */
DECL|macro|HDSP_statusRegister
mdefine_line|#define HDSP_statusRegister    0
DECL|macro|HDSP_timecode
mdefine_line|#define HDSP_timecode        128
DECL|macro|HDSP_status2Register
mdefine_line|#define HDSP_status2Register 192
DECL|macro|HDSP_midiDataOut0
mdefine_line|#define HDSP_midiDataOut0    352
DECL|macro|HDSP_midiDataOut1
mdefine_line|#define HDSP_midiDataOut1    356
DECL|macro|HDSP_midiDataIn0
mdefine_line|#define HDSP_midiDataIn0     360
DECL|macro|HDSP_midiDataIn1
mdefine_line|#define HDSP_midiDataIn1     364
DECL|macro|HDSP_midiStatusOut0
mdefine_line|#define HDSP_midiStatusOut0  384
DECL|macro|HDSP_midiStatusOut1
mdefine_line|#define HDSP_midiStatusOut1  388
DECL|macro|HDSP_midiStatusIn0
mdefine_line|#define HDSP_midiStatusIn0   392
DECL|macro|HDSP_midiStatusIn1
mdefine_line|#define HDSP_midiStatusIn1   396
DECL|macro|HDSP_fifoStatus
mdefine_line|#define HDSP_fifoStatus      400
multiline_comment|/* the meters are regular i/o-mapped registers, but offset&n;   considerably from the rest. the peak registers are reset&n;   when read; the least-significant 4 bits are full-scale counters; &n;   the actual peak value is in the most-significant 24 bits.&n;*/
DECL|macro|HDSP_playbackPeakLevel
mdefine_line|#define HDSP_playbackPeakLevel  4096  /* 26 * 32 bit values */
DECL|macro|HDSP_inputPeakLevel
mdefine_line|#define HDSP_inputPeakLevel     4224  /* 26 * 32 bit values */
DECL|macro|HDSP_outputPeakLevel
mdefine_line|#define HDSP_outputPeakLevel    4352  /* (26+2) * 32 bit values */
DECL|macro|HDSP_playbackRmsLevel
mdefine_line|#define HDSP_playbackRmsLevel   4612  /* 26 * 64 bit values */
DECL|macro|HDSP_inputRmsLevel
mdefine_line|#define HDSP_inputRmsLevel      4868  /* 26 * 64 bit values */
multiline_comment|/* This is for H9652 cards&n;   Peak values are read downward from the base&n;   Rms values are read upward&n;   There are rms values for the outputs too&n;   26*3 values are read in ss mode&n;   14*3 in ds mode, with no gap between values&n;*/
DECL|macro|HDSP_9652_peakBase
mdefine_line|#define HDSP_9652_peakBase&t;7164&t;
DECL|macro|HDSP_9652_rmsBase
mdefine_line|#define HDSP_9652_rmsBase&t;4096
multiline_comment|/* c.f. the hdsp_9632_meters_t struct */
DECL|macro|HDSP_9632_metersBase
mdefine_line|#define HDSP_9632_metersBase&t;4096
DECL|macro|HDSP_IO_EXTENT
mdefine_line|#define HDSP_IO_EXTENT     7168
multiline_comment|/* control2 register bits */
DECL|macro|HDSP_TMS
mdefine_line|#define HDSP_TMS                0x01
DECL|macro|HDSP_TCK
mdefine_line|#define HDSP_TCK                0x02
DECL|macro|HDSP_TDI
mdefine_line|#define HDSP_TDI                0x04
DECL|macro|HDSP_JTAG
mdefine_line|#define HDSP_JTAG               0x08
DECL|macro|HDSP_PWDN
mdefine_line|#define HDSP_PWDN               0x10
DECL|macro|HDSP_PROGRAM
mdefine_line|#define HDSP_PROGRAM&t;        0x020
DECL|macro|HDSP_CONFIG_MODE_0
mdefine_line|#define HDSP_CONFIG_MODE_0&t;0x040
DECL|macro|HDSP_CONFIG_MODE_1
mdefine_line|#define HDSP_CONFIG_MODE_1&t;0x080
DECL|macro|HDSP_VERSION_BIT
mdefine_line|#define HDSP_VERSION_BIT&t;0x100
DECL|macro|HDSP_BIGENDIAN_MODE
mdefine_line|#define HDSP_BIGENDIAN_MODE     0x200
DECL|macro|HDSP_RD_MULTIPLE
mdefine_line|#define HDSP_RD_MULTIPLE        0x400
DECL|macro|HDSP_9652_ENABLE_MIXER
mdefine_line|#define HDSP_9652_ENABLE_MIXER  0x800
DECL|macro|HDSP_TDO
mdefine_line|#define HDSP_TDO                0x10000000
DECL|macro|HDSP_S_PROGRAM
mdefine_line|#define HDSP_S_PROGRAM     &t;(HDSP_PROGRAM|HDSP_CONFIG_MODE_0)
DECL|macro|HDSP_S_LOAD
mdefine_line|#define HDSP_S_LOAD&t;&t;(HDSP_PROGRAM|HDSP_CONFIG_MODE_1)
multiline_comment|/* Control Register bits */
DECL|macro|HDSP_Start
mdefine_line|#define HDSP_Start                (1&lt;&lt;0)  /* start engine */
DECL|macro|HDSP_Latency0
mdefine_line|#define HDSP_Latency0             (1&lt;&lt;1)  /* buffer size = 2^n where n is defined by Latency{2,1,0} */
DECL|macro|HDSP_Latency1
mdefine_line|#define HDSP_Latency1             (1&lt;&lt;2)  /* [ see above ] */
DECL|macro|HDSP_Latency2
mdefine_line|#define HDSP_Latency2             (1&lt;&lt;3)  /* [ see above ] */
DECL|macro|HDSP_ClockModeMaster
mdefine_line|#define HDSP_ClockModeMaster      (1&lt;&lt;4)  /* 1=Master, 0=Slave/Autosync */
DECL|macro|HDSP_AudioInterruptEnable
mdefine_line|#define HDSP_AudioInterruptEnable (1&lt;&lt;5)  /* what do you think ? */
DECL|macro|HDSP_Frequency0
mdefine_line|#define HDSP_Frequency0           (1&lt;&lt;6)  /* 0=44.1kHz/88.2kHz/176.4kHz 1=48kHz/96kHz/192kHz */
DECL|macro|HDSP_Frequency1
mdefine_line|#define HDSP_Frequency1           (1&lt;&lt;7)  /* 0=32kHz/64kHz/128kHz */
DECL|macro|HDSP_DoubleSpeed
mdefine_line|#define HDSP_DoubleSpeed          (1&lt;&lt;8)  /* 0=normal speed, 1=double speed */
DECL|macro|HDSP_SPDIFProfessional
mdefine_line|#define HDSP_SPDIFProfessional    (1&lt;&lt;9)  /* 0=consumer, 1=professional */
DECL|macro|HDSP_SPDIFEmphasis
mdefine_line|#define HDSP_SPDIFEmphasis        (1&lt;&lt;10) /* 0=none, 1=on */
DECL|macro|HDSP_SPDIFNonAudio
mdefine_line|#define HDSP_SPDIFNonAudio        (1&lt;&lt;11) /* 0=off, 1=on */
DECL|macro|HDSP_SPDIFOpticalOut
mdefine_line|#define HDSP_SPDIFOpticalOut      (1&lt;&lt;12) /* 1=use 1st ADAT connector for SPDIF, 0=do not */
DECL|macro|HDSP_SyncRef2
mdefine_line|#define HDSP_SyncRef2             (1&lt;&lt;13) 
DECL|macro|HDSP_SPDIFInputSelect0
mdefine_line|#define HDSP_SPDIFInputSelect0    (1&lt;&lt;14) 
DECL|macro|HDSP_SPDIFInputSelect1
mdefine_line|#define HDSP_SPDIFInputSelect1    (1&lt;&lt;15) 
DECL|macro|HDSP_SyncRef0
mdefine_line|#define HDSP_SyncRef0             (1&lt;&lt;16) 
DECL|macro|HDSP_SyncRef1
mdefine_line|#define HDSP_SyncRef1             (1&lt;&lt;17)
DECL|macro|HDSP_AnalogExtensionBoard
mdefine_line|#define HDSP_AnalogExtensionBoard (1&lt;&lt;18) /* For H9632 cards */ 
DECL|macro|HDSP_XLRBreakoutCable
mdefine_line|#define HDSP_XLRBreakoutCable     (1&lt;&lt;20) /* For H9632 cards */
DECL|macro|HDSP_Midi0InterruptEnable
mdefine_line|#define HDSP_Midi0InterruptEnable (1&lt;&lt;22)
DECL|macro|HDSP_Midi1InterruptEnable
mdefine_line|#define HDSP_Midi1InterruptEnable (1&lt;&lt;23)
DECL|macro|HDSP_LineOut
mdefine_line|#define HDSP_LineOut              (1&lt;&lt;24)
DECL|macro|HDSP_ADGain0
mdefine_line|#define HDSP_ADGain0&t;&t;  (1&lt;&lt;25) /* From here : H9632 specific */
DECL|macro|HDSP_ADGain1
mdefine_line|#define HDSP_ADGain1&t;&t;  (1&lt;&lt;26)
DECL|macro|HDSP_DAGain0
mdefine_line|#define HDSP_DAGain0&t;&t;  (1&lt;&lt;27)
DECL|macro|HDSP_DAGain1
mdefine_line|#define HDSP_DAGain1&t;&t;  (1&lt;&lt;28)
DECL|macro|HDSP_PhoneGain0
mdefine_line|#define HDSP_PhoneGain0&t;&t;  (1&lt;&lt;29)
DECL|macro|HDSP_PhoneGain1
mdefine_line|#define HDSP_PhoneGain1&t;&t;  (1&lt;&lt;30)
DECL|macro|HDSP_QuadSpeed
mdefine_line|#define HDSP_QuadSpeed&t;  &t;  (1&lt;&lt;31)
DECL|macro|HDSP_ADGainMask
mdefine_line|#define HDSP_ADGainMask       (HDSP_ADGain0|HDSP_ADGain1)
DECL|macro|HDSP_ADGainMinus10dBV
mdefine_line|#define HDSP_ADGainMinus10dBV  HDSP_ADGainMask
DECL|macro|HDSP_ADGainPlus4dBu
mdefine_line|#define HDSP_ADGainPlus4dBu   (HDSP_ADGain0)
DECL|macro|HDSP_ADGainLowGain
mdefine_line|#define HDSP_ADGainLowGain     0
DECL|macro|HDSP_DAGainMask
mdefine_line|#define HDSP_DAGainMask         (HDSP_DAGain0|HDSP_DAGain1)
DECL|macro|HDSP_DAGainHighGain
mdefine_line|#define HDSP_DAGainHighGain      HDSP_DAGainMask
DECL|macro|HDSP_DAGainPlus4dBu
mdefine_line|#define HDSP_DAGainPlus4dBu     (HDSP_DAGain0)
DECL|macro|HDSP_DAGainMinus10dBV
mdefine_line|#define HDSP_DAGainMinus10dBV    0
DECL|macro|HDSP_PhoneGainMask
mdefine_line|#define HDSP_PhoneGainMask      (HDSP_PhoneGain0|HDSP_PhoneGain1)
DECL|macro|HDSP_PhoneGain0dB
mdefine_line|#define HDSP_PhoneGain0dB        HDSP_PhoneGainMask
DECL|macro|HDSP_PhoneGainMinus6dB
mdefine_line|#define HDSP_PhoneGainMinus6dB  (HDSP_PhoneGain0)
DECL|macro|HDSP_PhoneGainMinus12dB
mdefine_line|#define HDSP_PhoneGainMinus12dB  0
DECL|macro|HDSP_LatencyMask
mdefine_line|#define HDSP_LatencyMask    (HDSP_Latency0|HDSP_Latency1|HDSP_Latency2)
DECL|macro|HDSP_FrequencyMask
mdefine_line|#define HDSP_FrequencyMask  (HDSP_Frequency0|HDSP_Frequency1|HDSP_DoubleSpeed|HDSP_QuadSpeed)
DECL|macro|HDSP_SPDIFInputMask
mdefine_line|#define HDSP_SPDIFInputMask    (HDSP_SPDIFInputSelect0|HDSP_SPDIFInputSelect1)
DECL|macro|HDSP_SPDIFInputADAT1
mdefine_line|#define HDSP_SPDIFInputADAT1    0
DECL|macro|HDSP_SPDIFInputCoaxial
mdefine_line|#define HDSP_SPDIFInputCoaxial (HDSP_SPDIFInputSelect0)
DECL|macro|HDSP_SPDIFInputCdrom
mdefine_line|#define HDSP_SPDIFInputCdrom   (HDSP_SPDIFInputSelect1)
DECL|macro|HDSP_SPDIFInputAES
mdefine_line|#define HDSP_SPDIFInputAES     (HDSP_SPDIFInputSelect0|HDSP_SPDIFInputSelect1)
DECL|macro|HDSP_SyncRefMask
mdefine_line|#define HDSP_SyncRefMask        (HDSP_SyncRef0|HDSP_SyncRef1|HDSP_SyncRef2)
DECL|macro|HDSP_SyncRef_ADAT1
mdefine_line|#define HDSP_SyncRef_ADAT1       0
DECL|macro|HDSP_SyncRef_ADAT2
mdefine_line|#define HDSP_SyncRef_ADAT2      (HDSP_SyncRef0)
DECL|macro|HDSP_SyncRef_ADAT3
mdefine_line|#define HDSP_SyncRef_ADAT3      (HDSP_SyncRef1)
DECL|macro|HDSP_SyncRef_SPDIF
mdefine_line|#define HDSP_SyncRef_SPDIF      (HDSP_SyncRef0|HDSP_SyncRef1)
DECL|macro|HDSP_SyncRef_WORD
mdefine_line|#define HDSP_SyncRef_WORD       (HDSP_SyncRef2)
DECL|macro|HDSP_SyncRef_ADAT_SYNC
mdefine_line|#define HDSP_SyncRef_ADAT_SYNC  (HDSP_SyncRef0|HDSP_SyncRef2)
multiline_comment|/* Sample Clock Sources */
DECL|macro|HDSP_CLOCK_SOURCE_AUTOSYNC
mdefine_line|#define HDSP_CLOCK_SOURCE_AUTOSYNC           0
DECL|macro|HDSP_CLOCK_SOURCE_INTERNAL_32KHZ
mdefine_line|#define HDSP_CLOCK_SOURCE_INTERNAL_32KHZ     1
DECL|macro|HDSP_CLOCK_SOURCE_INTERNAL_44_1KHZ
mdefine_line|#define HDSP_CLOCK_SOURCE_INTERNAL_44_1KHZ   2
DECL|macro|HDSP_CLOCK_SOURCE_INTERNAL_48KHZ
mdefine_line|#define HDSP_CLOCK_SOURCE_INTERNAL_48KHZ     3
DECL|macro|HDSP_CLOCK_SOURCE_INTERNAL_64KHZ
mdefine_line|#define HDSP_CLOCK_SOURCE_INTERNAL_64KHZ     4
DECL|macro|HDSP_CLOCK_SOURCE_INTERNAL_88_2KHZ
mdefine_line|#define HDSP_CLOCK_SOURCE_INTERNAL_88_2KHZ   5
DECL|macro|HDSP_CLOCK_SOURCE_INTERNAL_96KHZ
mdefine_line|#define HDSP_CLOCK_SOURCE_INTERNAL_96KHZ     6
DECL|macro|HDSP_CLOCK_SOURCE_INTERNAL_128KHZ
mdefine_line|#define HDSP_CLOCK_SOURCE_INTERNAL_128KHZ    7
DECL|macro|HDSP_CLOCK_SOURCE_INTERNAL_176_4KHZ
mdefine_line|#define HDSP_CLOCK_SOURCE_INTERNAL_176_4KHZ  8
DECL|macro|HDSP_CLOCK_SOURCE_INTERNAL_192KHZ
mdefine_line|#define HDSP_CLOCK_SOURCE_INTERNAL_192KHZ    9
multiline_comment|/* Preferred sync reference choices - used by &quot;pref_sync_ref&quot; control switch */
DECL|macro|HDSP_SYNC_FROM_WORD
mdefine_line|#define HDSP_SYNC_FROM_WORD      0
DECL|macro|HDSP_SYNC_FROM_SPDIF
mdefine_line|#define HDSP_SYNC_FROM_SPDIF     1
DECL|macro|HDSP_SYNC_FROM_ADAT1
mdefine_line|#define HDSP_SYNC_FROM_ADAT1     2
DECL|macro|HDSP_SYNC_FROM_ADAT_SYNC
mdefine_line|#define HDSP_SYNC_FROM_ADAT_SYNC 3
DECL|macro|HDSP_SYNC_FROM_ADAT2
mdefine_line|#define HDSP_SYNC_FROM_ADAT2     4
DECL|macro|HDSP_SYNC_FROM_ADAT3
mdefine_line|#define HDSP_SYNC_FROM_ADAT3     5
multiline_comment|/* SyncCheck status */
DECL|macro|HDSP_SYNC_CHECK_NO_LOCK
mdefine_line|#define HDSP_SYNC_CHECK_NO_LOCK 0
DECL|macro|HDSP_SYNC_CHECK_LOCK
mdefine_line|#define HDSP_SYNC_CHECK_LOCK    1
DECL|macro|HDSP_SYNC_CHECK_SYNC
mdefine_line|#define HDSP_SYNC_CHECK_SYNC&t;2
multiline_comment|/* AutoSync references - used by &quot;autosync_ref&quot; control switch */
DECL|macro|HDSP_AUTOSYNC_FROM_WORD
mdefine_line|#define HDSP_AUTOSYNC_FROM_WORD      0
DECL|macro|HDSP_AUTOSYNC_FROM_ADAT_SYNC
mdefine_line|#define HDSP_AUTOSYNC_FROM_ADAT_SYNC 1
DECL|macro|HDSP_AUTOSYNC_FROM_SPDIF
mdefine_line|#define HDSP_AUTOSYNC_FROM_SPDIF     2
DECL|macro|HDSP_AUTOSYNC_FROM_NONE
mdefine_line|#define HDSP_AUTOSYNC_FROM_NONE&t;     3
DECL|macro|HDSP_AUTOSYNC_FROM_ADAT1
mdefine_line|#define HDSP_AUTOSYNC_FROM_ADAT1     4
DECL|macro|HDSP_AUTOSYNC_FROM_ADAT2
mdefine_line|#define HDSP_AUTOSYNC_FROM_ADAT2     5
DECL|macro|HDSP_AUTOSYNC_FROM_ADAT3
mdefine_line|#define HDSP_AUTOSYNC_FROM_ADAT3     6
multiline_comment|/* Possible sources of S/PDIF input */
DECL|macro|HDSP_SPDIFIN_OPTICAL
mdefine_line|#define HDSP_SPDIFIN_OPTICAL  0&t;/* optical  (ADAT1) */
DECL|macro|HDSP_SPDIFIN_COAXIAL
mdefine_line|#define HDSP_SPDIFIN_COAXIAL  1&t;/* coaxial (RCA) */
DECL|macro|HDSP_SPDIFIN_INTERNAL
mdefine_line|#define HDSP_SPDIFIN_INTERNAL 2&t;/* internal (CDROM) */
DECL|macro|HDSP_SPDIFIN_AES
mdefine_line|#define HDSP_SPDIFIN_AES      3 /* xlr for H9632 (AES)*/
DECL|macro|HDSP_Frequency32KHz
mdefine_line|#define HDSP_Frequency32KHz    HDSP_Frequency0
DECL|macro|HDSP_Frequency44_1KHz
mdefine_line|#define HDSP_Frequency44_1KHz  HDSP_Frequency1
DECL|macro|HDSP_Frequency48KHz
mdefine_line|#define HDSP_Frequency48KHz    (HDSP_Frequency1|HDSP_Frequency0)
DECL|macro|HDSP_Frequency64KHz
mdefine_line|#define HDSP_Frequency64KHz    (HDSP_DoubleSpeed|HDSP_Frequency0)
DECL|macro|HDSP_Frequency88_2KHz
mdefine_line|#define HDSP_Frequency88_2KHz  (HDSP_DoubleSpeed|HDSP_Frequency1)
DECL|macro|HDSP_Frequency96KHz
mdefine_line|#define HDSP_Frequency96KHz    (HDSP_DoubleSpeed|HDSP_Frequency1|HDSP_Frequency0)
multiline_comment|/* For H9632 cards */
DECL|macro|HDSP_Frequency128KHz
mdefine_line|#define HDSP_Frequency128KHz   (HDSP_QuadSpeed|HDSP_DoubleSpeed|HDSP_Frequency0)
DECL|macro|HDSP_Frequency176_4KHz
mdefine_line|#define HDSP_Frequency176_4KHz (HDSP_QuadSpeed|HDSP_DoubleSpeed|HDSP_Frequency1)
DECL|macro|HDSP_Frequency192KHz
mdefine_line|#define HDSP_Frequency192KHz   (HDSP_QuadSpeed|HDSP_DoubleSpeed|HDSP_Frequency1|HDSP_Frequency0)
DECL|macro|hdsp_encode_latency
mdefine_line|#define hdsp_encode_latency(x)       (((x)&lt;&lt;1) &amp; HDSP_LatencyMask)
DECL|macro|hdsp_decode_latency
mdefine_line|#define hdsp_decode_latency(x)       (((x) &amp; HDSP_LatencyMask)&gt;&gt;1)
DECL|macro|hdsp_encode_spdif_in
mdefine_line|#define hdsp_encode_spdif_in(x) (((x)&amp;0x3)&lt;&lt;14)
DECL|macro|hdsp_decode_spdif_in
mdefine_line|#define hdsp_decode_spdif_in(x) (((x)&gt;&gt;14)&amp;0x3)
multiline_comment|/* Status Register bits */
DECL|macro|HDSP_audioIRQPending
mdefine_line|#define HDSP_audioIRQPending    (1&lt;&lt;0)
DECL|macro|HDSP_Lock2
mdefine_line|#define HDSP_Lock2              (1&lt;&lt;1)     /* this is for Digiface and H9652 */
DECL|macro|HDSP_spdifFrequency3
mdefine_line|#define HDSP_spdifFrequency3&t;HDSP_Lock2 /* this is for H9632 only */
DECL|macro|HDSP_Lock1
mdefine_line|#define HDSP_Lock1              (1&lt;&lt;2)
DECL|macro|HDSP_Lock0
mdefine_line|#define HDSP_Lock0              (1&lt;&lt;3)
DECL|macro|HDSP_SPDIFSync
mdefine_line|#define HDSP_SPDIFSync          (1&lt;&lt;4)
DECL|macro|HDSP_TimecodeLock
mdefine_line|#define HDSP_TimecodeLock       (1&lt;&lt;5)
DECL|macro|HDSP_BufferPositionMask
mdefine_line|#define HDSP_BufferPositionMask 0x000FFC0 /* Bit 6..15 : h/w buffer pointer */
DECL|macro|HDSP_Sync2
mdefine_line|#define HDSP_Sync2              (1&lt;&lt;16)
DECL|macro|HDSP_Sync1
mdefine_line|#define HDSP_Sync1              (1&lt;&lt;17)
DECL|macro|HDSP_Sync0
mdefine_line|#define HDSP_Sync0              (1&lt;&lt;18)
DECL|macro|HDSP_DoubleSpeedStatus
mdefine_line|#define HDSP_DoubleSpeedStatus  (1&lt;&lt;19)
DECL|macro|HDSP_ConfigError
mdefine_line|#define HDSP_ConfigError        (1&lt;&lt;20)
DECL|macro|HDSP_DllError
mdefine_line|#define HDSP_DllError           (1&lt;&lt;21)
DECL|macro|HDSP_spdifFrequency0
mdefine_line|#define HDSP_spdifFrequency0    (1&lt;&lt;22)
DECL|macro|HDSP_spdifFrequency1
mdefine_line|#define HDSP_spdifFrequency1    (1&lt;&lt;23)
DECL|macro|HDSP_spdifFrequency2
mdefine_line|#define HDSP_spdifFrequency2    (1&lt;&lt;24)
DECL|macro|HDSP_SPDIFErrorFlag
mdefine_line|#define HDSP_SPDIFErrorFlag     (1&lt;&lt;25)
DECL|macro|HDSP_BufferID
mdefine_line|#define HDSP_BufferID           (1&lt;&lt;26)
DECL|macro|HDSP_TimecodeSync
mdefine_line|#define HDSP_TimecodeSync       (1&lt;&lt;27)
DECL|macro|HDSP_AEBO
mdefine_line|#define HDSP_AEBO          &t;(1&lt;&lt;28) /* H9632 specific Analog Extension Boards */
DECL|macro|HDSP_AEBI
mdefine_line|#define HDSP_AEBI&t;&t;(1&lt;&lt;29) /* 0 = present, 1 = absent */
DECL|macro|HDSP_midi0IRQPending
mdefine_line|#define HDSP_midi0IRQPending    (1&lt;&lt;30) 
DECL|macro|HDSP_midi1IRQPending
mdefine_line|#define HDSP_midi1IRQPending    (1&lt;&lt;31)
DECL|macro|HDSP_spdifFrequencyMask
mdefine_line|#define HDSP_spdifFrequencyMask    (HDSP_spdifFrequency0|HDSP_spdifFrequency1|HDSP_spdifFrequency2)
DECL|macro|HDSP_spdifFrequency32KHz
mdefine_line|#define HDSP_spdifFrequency32KHz   (HDSP_spdifFrequency0)
DECL|macro|HDSP_spdifFrequency44_1KHz
mdefine_line|#define HDSP_spdifFrequency44_1KHz (HDSP_spdifFrequency1)
DECL|macro|HDSP_spdifFrequency48KHz
mdefine_line|#define HDSP_spdifFrequency48KHz   (HDSP_spdifFrequency0|HDSP_spdifFrequency1)
DECL|macro|HDSP_spdifFrequency64KHz
mdefine_line|#define HDSP_spdifFrequency64KHz   (HDSP_spdifFrequency2)
DECL|macro|HDSP_spdifFrequency88_2KHz
mdefine_line|#define HDSP_spdifFrequency88_2KHz (HDSP_spdifFrequency0|HDSP_spdifFrequency2)
DECL|macro|HDSP_spdifFrequency96KHz
mdefine_line|#define HDSP_spdifFrequency96KHz   (HDSP_spdifFrequency2|HDSP_spdifFrequency1)
multiline_comment|/* This is for H9632 cards */
DECL|macro|HDSP_spdifFrequency128KHz
mdefine_line|#define HDSP_spdifFrequency128KHz   HDSP_spdifFrequencyMask
DECL|macro|HDSP_spdifFrequency176_4KHz
mdefine_line|#define HDSP_spdifFrequency176_4KHz HDSP_spdifFrequency3
DECL|macro|HDSP_spdifFrequency192KHz
mdefine_line|#define HDSP_spdifFrequency192KHz   (HDSP_spdifFrequency3|HDSP_spdifFrequency0)
multiline_comment|/* Status2 Register bits */
DECL|macro|HDSP_version0
mdefine_line|#define HDSP_version0     (1&lt;&lt;0)
DECL|macro|HDSP_version1
mdefine_line|#define HDSP_version1     (1&lt;&lt;1)
DECL|macro|HDSP_version2
mdefine_line|#define HDSP_version2     (1&lt;&lt;2)
DECL|macro|HDSP_wc_lock
mdefine_line|#define HDSP_wc_lock      (1&lt;&lt;3)
DECL|macro|HDSP_wc_sync
mdefine_line|#define HDSP_wc_sync      (1&lt;&lt;4)
DECL|macro|HDSP_inp_freq0
mdefine_line|#define HDSP_inp_freq0    (1&lt;&lt;5)
DECL|macro|HDSP_inp_freq1
mdefine_line|#define HDSP_inp_freq1    (1&lt;&lt;6)
DECL|macro|HDSP_inp_freq2
mdefine_line|#define HDSP_inp_freq2    (1&lt;&lt;7)
DECL|macro|HDSP_SelSyncRef0
mdefine_line|#define HDSP_SelSyncRef0  (1&lt;&lt;8)
DECL|macro|HDSP_SelSyncRef1
mdefine_line|#define HDSP_SelSyncRef1  (1&lt;&lt;9)
DECL|macro|HDSP_SelSyncRef2
mdefine_line|#define HDSP_SelSyncRef2  (1&lt;&lt;10)
DECL|macro|HDSP_wc_valid
mdefine_line|#define HDSP_wc_valid (HDSP_wc_lock|HDSP_wc_sync)
DECL|macro|HDSP_systemFrequencyMask
mdefine_line|#define HDSP_systemFrequencyMask (HDSP_inp_freq0|HDSP_inp_freq1|HDSP_inp_freq2)
DECL|macro|HDSP_systemFrequency32
mdefine_line|#define HDSP_systemFrequency32   (HDSP_inp_freq0)
DECL|macro|HDSP_systemFrequency44_1
mdefine_line|#define HDSP_systemFrequency44_1 (HDSP_inp_freq1)
DECL|macro|HDSP_systemFrequency48
mdefine_line|#define HDSP_systemFrequency48   (HDSP_inp_freq0|HDSP_inp_freq1)
DECL|macro|HDSP_systemFrequency64
mdefine_line|#define HDSP_systemFrequency64   (HDSP_inp_freq2)
DECL|macro|HDSP_systemFrequency88_2
mdefine_line|#define HDSP_systemFrequency88_2 (HDSP_inp_freq0|HDSP_inp_freq2)
DECL|macro|HDSP_systemFrequency96
mdefine_line|#define HDSP_systemFrequency96   (HDSP_inp_freq1|HDSP_inp_freq2)
multiline_comment|/* FIXME : more values for 9632 cards ? */
DECL|macro|HDSP_SelSyncRefMask
mdefine_line|#define HDSP_SelSyncRefMask        (HDSP_SelSyncRef0|HDSP_SelSyncRef1|HDSP_SelSyncRef2)
DECL|macro|HDSP_SelSyncRef_ADAT1
mdefine_line|#define HDSP_SelSyncRef_ADAT1      0
DECL|macro|HDSP_SelSyncRef_ADAT2
mdefine_line|#define HDSP_SelSyncRef_ADAT2      (HDSP_SelSyncRef0)
DECL|macro|HDSP_SelSyncRef_ADAT3
mdefine_line|#define HDSP_SelSyncRef_ADAT3      (HDSP_SelSyncRef1)
DECL|macro|HDSP_SelSyncRef_SPDIF
mdefine_line|#define HDSP_SelSyncRef_SPDIF      (HDSP_SelSyncRef0|HDSP_SelSyncRef1)
DECL|macro|HDSP_SelSyncRef_WORD
mdefine_line|#define HDSP_SelSyncRef_WORD       (HDSP_SelSyncRef2)
DECL|macro|HDSP_SelSyncRef_ADAT_SYNC
mdefine_line|#define HDSP_SelSyncRef_ADAT_SYNC  (HDSP_SelSyncRef0|HDSP_SelSyncRef2)
multiline_comment|/* Card state flags */
DECL|macro|HDSP_InitializationComplete
mdefine_line|#define HDSP_InitializationComplete  (1&lt;&lt;0)
DECL|macro|HDSP_FirmwareLoaded
mdefine_line|#define HDSP_FirmwareLoaded&t;     (1&lt;&lt;1)
DECL|macro|HDSP_FirmwareCached
mdefine_line|#define HDSP_FirmwareCached&t;     (1&lt;&lt;2)
multiline_comment|/* FIFO wait times, defined in terms of 1/10ths of msecs */
DECL|macro|HDSP_LONG_WAIT
mdefine_line|#define HDSP_LONG_WAIT&t; 5000
DECL|macro|HDSP_SHORT_WAIT
mdefine_line|#define HDSP_SHORT_WAIT  30
DECL|macro|UNITY_GAIN
mdefine_line|#define UNITY_GAIN                       32768
DECL|macro|MINUS_INFINITY_GAIN
mdefine_line|#define MINUS_INFINITY_GAIN              0
macro_line|#ifndef PCI_VENDOR_ID_XILINX
DECL|macro|PCI_VENDOR_ID_XILINX
mdefine_line|#define PCI_VENDOR_ID_XILINX&t;&t;0x10ee
macro_line|#endif
macro_line|#ifndef PCI_DEVICE_ID_XILINX_HAMMERFALL_DSP
DECL|macro|PCI_DEVICE_ID_XILINX_HAMMERFALL_DSP
mdefine_line|#define PCI_DEVICE_ID_XILINX_HAMMERFALL_DSP 0x3fc5
macro_line|#endif
multiline_comment|/* the size of a substream (1 mono data stream) */
DECL|macro|HDSP_CHANNEL_BUFFER_SAMPLES
mdefine_line|#define HDSP_CHANNEL_BUFFER_SAMPLES  (16*1024)
DECL|macro|HDSP_CHANNEL_BUFFER_BYTES
mdefine_line|#define HDSP_CHANNEL_BUFFER_BYTES    (4*HDSP_CHANNEL_BUFFER_SAMPLES)
multiline_comment|/* the size of the area we need to allocate for DMA transfers. the&n;   size is the same regardless of the number of channels - the &n;   Multiface still uses the same memory area.&n;&n;   Note that we allocate 1 more channel than is apparently needed&n;   because the h/w seems to write 1 byte beyond the end of the last&n;   page. Sigh.&n;*/
DECL|macro|HDSP_DMA_AREA_BYTES
mdefine_line|#define HDSP_DMA_AREA_BYTES ((HDSP_MAX_CHANNELS+1) * HDSP_CHANNEL_BUFFER_BYTES)
DECL|macro|HDSP_DMA_AREA_KILOBYTES
mdefine_line|#define HDSP_DMA_AREA_KILOBYTES (HDSP_DMA_AREA_BYTES/1024)
multiline_comment|/* use hotplug firmeare loader? */
macro_line|#if defined(CONFIG_FW_LOADER) || defined(CONFIG_FW_LOADER_MODULE)
macro_line|#ifndef HDSP_USE_HWDEP_LOADER
DECL|macro|HDSP_FW_LOADER
mdefine_line|#define HDSP_FW_LOADER
macro_line|#endif
macro_line|#endif
DECL|typedef|hdsp_t
r_typedef
r_struct
id|_hdsp
id|hdsp_t
suffix:semicolon
DECL|typedef|hdsp_midi_t
r_typedef
r_struct
id|_hdsp_midi
id|hdsp_midi_t
suffix:semicolon
DECL|typedef|hdsp_9632_meters_t
r_typedef
r_struct
id|_hdsp_9632_meters
id|hdsp_9632_meters_t
suffix:semicolon
DECL|struct|_hdsp_9632_meters
r_struct
id|_hdsp_9632_meters
(brace
DECL|member|input_peak
id|u32
id|input_peak
(braket
l_int|16
)braket
suffix:semicolon
DECL|member|playback_peak
id|u32
id|playback_peak
(braket
l_int|16
)braket
suffix:semicolon
DECL|member|output_peak
id|u32
id|output_peak
(braket
l_int|16
)braket
suffix:semicolon
DECL|member|xxx_peak
id|u32
id|xxx_peak
(braket
l_int|16
)braket
suffix:semicolon
DECL|member|padding
id|u32
id|padding
(braket
l_int|64
)braket
suffix:semicolon
DECL|member|input_rms_low
id|u32
id|input_rms_low
(braket
l_int|16
)braket
suffix:semicolon
DECL|member|playback_rms_low
id|u32
id|playback_rms_low
(braket
l_int|16
)braket
suffix:semicolon
DECL|member|output_rms_low
id|u32
id|output_rms_low
(braket
l_int|16
)braket
suffix:semicolon
DECL|member|xxx_rms_low
id|u32
id|xxx_rms_low
(braket
l_int|16
)braket
suffix:semicolon
DECL|member|input_rms_high
id|u32
id|input_rms_high
(braket
l_int|16
)braket
suffix:semicolon
DECL|member|playback_rms_high
id|u32
id|playback_rms_high
(braket
l_int|16
)braket
suffix:semicolon
DECL|member|output_rms_high
id|u32
id|output_rms_high
(braket
l_int|16
)braket
suffix:semicolon
DECL|member|xxx_rms_high
id|u32
id|xxx_rms_high
(braket
l_int|16
)braket
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|_hdsp_midi
r_struct
id|_hdsp_midi
(brace
DECL|member|hdsp
id|hdsp_t
op_star
id|hdsp
suffix:semicolon
DECL|member|id
r_int
id|id
suffix:semicolon
DECL|member|rmidi
id|snd_rawmidi_t
op_star
id|rmidi
suffix:semicolon
DECL|member|input
id|snd_rawmidi_substream_t
op_star
id|input
suffix:semicolon
DECL|member|output
id|snd_rawmidi_substream_t
op_star
id|output
suffix:semicolon
DECL|member|istimer
r_char
id|istimer
suffix:semicolon
multiline_comment|/* timer in use */
DECL|member|timer
r_struct
id|timer_list
id|timer
suffix:semicolon
DECL|member|lock
id|spinlock_t
id|lock
suffix:semicolon
DECL|member|pending
r_int
id|pending
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|_hdsp
r_struct
id|_hdsp
(brace
DECL|member|lock
id|spinlock_t
id|lock
suffix:semicolon
DECL|member|capture_substream
id|snd_pcm_substream_t
op_star
id|capture_substream
suffix:semicolon
DECL|member|playback_substream
id|snd_pcm_substream_t
op_star
id|playback_substream
suffix:semicolon
DECL|member|midi
id|hdsp_midi_t
id|midi
(braket
l_int|2
)braket
suffix:semicolon
DECL|member|midi_tasklet
r_struct
id|tasklet_struct
id|midi_tasklet
suffix:semicolon
DECL|member|precise_ptr
r_int
id|precise_ptr
suffix:semicolon
DECL|member|control_register
id|u32
id|control_register
suffix:semicolon
multiline_comment|/* cached value */
DECL|member|control2_register
id|u32
id|control2_register
suffix:semicolon
multiline_comment|/* cached value */
DECL|member|creg_spdif
id|u32
id|creg_spdif
suffix:semicolon
DECL|member|creg_spdif_stream
id|u32
id|creg_spdif_stream
suffix:semicolon
DECL|member|card_name
r_char
op_star
id|card_name
suffix:semicolon
multiline_comment|/* digiface/multiface */
DECL|member|io_type
id|HDSP_IO_Type
id|io_type
suffix:semicolon
multiline_comment|/* ditto, but for code use */
DECL|member|firmware_rev
r_int
r_int
id|firmware_rev
suffix:semicolon
DECL|member|state
r_int
r_int
id|state
suffix:semicolon
multiline_comment|/* stores state bits */
DECL|member|firmware_cache
id|u32
id|firmware_cache
(braket
l_int|24413
)braket
suffix:semicolon
multiline_comment|/* this helps recover from accidental iobox power failure */
DECL|member|period_bytes
r_int
id|period_bytes
suffix:semicolon
multiline_comment|/* guess what this is */
DECL|member|max_channels
r_int
r_char
id|max_channels
suffix:semicolon
DECL|member|qs_in_channels
r_int
r_char
id|qs_in_channels
suffix:semicolon
multiline_comment|/* quad speed mode for H9632 */
DECL|member|ds_in_channels
r_int
r_char
id|ds_in_channels
suffix:semicolon
DECL|member|ss_in_channels
r_int
r_char
id|ss_in_channels
suffix:semicolon
multiline_comment|/* different for multiface/digiface */
DECL|member|qs_out_channels
r_int
r_char
id|qs_out_channels
suffix:semicolon
DECL|member|ds_out_channels
r_int
r_char
id|ds_out_channels
suffix:semicolon
DECL|member|ss_out_channels
r_int
r_char
id|ss_out_channels
suffix:semicolon
DECL|member|capture_dma_buf
r_struct
id|snd_dma_buffer
id|capture_dma_buf
suffix:semicolon
DECL|member|playback_dma_buf
r_struct
id|snd_dma_buffer
id|playback_dma_buf
suffix:semicolon
DECL|member|capture_buffer
r_int
r_char
op_star
id|capture_buffer
suffix:semicolon
multiline_comment|/* suitably aligned address */
DECL|member|playback_buffer
r_int
r_char
op_star
id|playback_buffer
suffix:semicolon
multiline_comment|/* suitably aligned address */
DECL|member|capture_pid
id|pid_t
id|capture_pid
suffix:semicolon
DECL|member|playback_pid
id|pid_t
id|playback_pid
suffix:semicolon
DECL|member|running
r_int
id|running
suffix:semicolon
DECL|member|passthru
r_int
id|passthru
suffix:semicolon
multiline_comment|/* non-zero if doing pass-thru */
DECL|member|system_sample_rate
r_int
id|system_sample_rate
suffix:semicolon
DECL|member|channel_map
r_char
op_star
id|channel_map
suffix:semicolon
DECL|member|dev
r_int
id|dev
suffix:semicolon
DECL|member|irq
r_int
id|irq
suffix:semicolon
DECL|member|port
r_int
r_int
id|port
suffix:semicolon
DECL|member|iobase
r_void
id|__iomem
op_star
id|iobase
suffix:semicolon
DECL|member|card
id|snd_card_t
op_star
id|card
suffix:semicolon
DECL|member|pcm
id|snd_pcm_t
op_star
id|pcm
suffix:semicolon
DECL|member|hwdep
id|snd_hwdep_t
op_star
id|hwdep
suffix:semicolon
DECL|member|pci
r_struct
id|pci_dev
op_star
id|pci
suffix:semicolon
DECL|member|spdif_ctl
id|snd_kcontrol_t
op_star
id|spdif_ctl
suffix:semicolon
DECL|member|mixer_matrix
r_int
r_int
id|mixer_matrix
(braket
id|HDSP_MATRIX_MIXER_SIZE
)braket
suffix:semicolon
)brace
suffix:semicolon
multiline_comment|/* These tables map the ALSA channels 1..N to the channels that we&n;   need to use in order to find the relevant channel buffer. RME&n;   refer to this kind of mapping as between &quot;the ADAT channel and&n;   the DMA channel.&quot; We index it using the logical audio channel,&n;   and the value is the DMA channel (i.e. channel buffer number)&n;   where the data for that channel can be read/written from/to.&n;*/
DECL|variable|channel_map_df_ss
r_static
r_char
id|channel_map_df_ss
(braket
id|HDSP_MAX_CHANNELS
)braket
op_assign
(brace
l_int|0
comma
l_int|1
comma
l_int|2
comma
l_int|3
comma
l_int|4
comma
l_int|5
comma
l_int|6
comma
l_int|7
comma
l_int|8
comma
l_int|9
comma
l_int|10
comma
l_int|11
comma
l_int|12
comma
l_int|13
comma
l_int|14
comma
l_int|15
comma
l_int|16
comma
l_int|17
comma
l_int|18
comma
l_int|19
comma
l_int|20
comma
l_int|21
comma
l_int|22
comma
l_int|23
comma
l_int|24
comma
l_int|25
)brace
suffix:semicolon
DECL|variable|channel_map_mf_ss
r_static
r_char
id|channel_map_mf_ss
(braket
id|HDSP_MAX_CHANNELS
)braket
op_assign
(brace
multiline_comment|/* Multiface */
multiline_comment|/* Analog */
l_int|0
comma
l_int|1
comma
l_int|2
comma
l_int|3
comma
l_int|4
comma
l_int|5
comma
l_int|6
comma
l_int|7
comma
multiline_comment|/* ADAT 2 */
l_int|16
comma
l_int|17
comma
l_int|18
comma
l_int|19
comma
l_int|20
comma
l_int|21
comma
l_int|22
comma
l_int|23
comma
multiline_comment|/* SPDIF */
l_int|24
comma
l_int|25
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
)brace
suffix:semicolon
DECL|variable|channel_map_ds
r_static
r_char
id|channel_map_ds
(braket
id|HDSP_MAX_CHANNELS
)braket
op_assign
(brace
multiline_comment|/* ADAT channels are remapped */
l_int|1
comma
l_int|3
comma
l_int|5
comma
l_int|7
comma
l_int|9
comma
l_int|11
comma
l_int|13
comma
l_int|15
comma
l_int|17
comma
l_int|19
comma
l_int|21
comma
l_int|23
comma
multiline_comment|/* channels 12 and 13 are S/PDIF */
l_int|24
comma
l_int|25
comma
multiline_comment|/* others don&squot;t exist */
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
)brace
suffix:semicolon
DECL|variable|channel_map_H9632_ss
r_static
r_char
id|channel_map_H9632_ss
(braket
id|HDSP_MAX_CHANNELS
)braket
op_assign
(brace
multiline_comment|/* ADAT channels */
l_int|0
comma
l_int|1
comma
l_int|2
comma
l_int|3
comma
l_int|4
comma
l_int|5
comma
l_int|6
comma
l_int|7
comma
multiline_comment|/* SPDIF */
l_int|8
comma
l_int|9
comma
multiline_comment|/* Analog */
l_int|10
comma
l_int|11
comma
multiline_comment|/* AO4S-192 and AI4S-192 extension boards */
l_int|12
comma
l_int|13
comma
l_int|14
comma
l_int|15
comma
multiline_comment|/* others don&squot;t exist */
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
)brace
suffix:semicolon
DECL|variable|channel_map_H9632_ds
r_static
r_char
id|channel_map_H9632_ds
(braket
id|HDSP_MAX_CHANNELS
)braket
op_assign
(brace
multiline_comment|/* ADAT */
l_int|1
comma
l_int|3
comma
l_int|5
comma
l_int|7
comma
multiline_comment|/* SPDIF */
l_int|8
comma
l_int|9
comma
multiline_comment|/* Analog */
l_int|10
comma
l_int|11
comma
multiline_comment|/* AO4S-192 and AI4S-192 extension boards */
l_int|12
comma
l_int|13
comma
l_int|14
comma
l_int|15
comma
multiline_comment|/* others don&squot;t exist */
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
)brace
suffix:semicolon
DECL|variable|channel_map_H9632_qs
r_static
r_char
id|channel_map_H9632_qs
(braket
id|HDSP_MAX_CHANNELS
)braket
op_assign
(brace
multiline_comment|/* ADAT is disabled in this mode */
multiline_comment|/* SPDIF */
l_int|8
comma
l_int|9
comma
multiline_comment|/* Analog */
l_int|10
comma
l_int|11
comma
multiline_comment|/* AO4S-192 and AI4S-192 extension boards */
l_int|12
comma
l_int|13
comma
l_int|14
comma
l_int|15
comma
multiline_comment|/* others don&squot;t exist */
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
)brace
suffix:semicolon
DECL|function|snd_hammerfall_get_buffer
r_static
r_int
id|snd_hammerfall_get_buffer
c_func
(paren
r_struct
id|pci_dev
op_star
id|pci
comma
r_struct
id|snd_dma_buffer
op_star
id|dmab
comma
r_int
id|size
)paren
(brace
id|dmab-&gt;dev.type
op_assign
id|SNDRV_DMA_TYPE_DEV
suffix:semicolon
id|dmab-&gt;dev.dev
op_assign
id|snd_dma_pci_data
c_func
(paren
id|pci
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snd_dma_get_reserved_buf
c_func
(paren
id|dmab
comma
id|snd_dma_pci_buf_id
c_func
(paren
id|pci
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
id|snd_dma_alloc_pages
c_func
(paren
id|SNDRV_DMA_TYPE_DEV
comma
id|snd_dma_pci_data
c_func
(paren
id|pci
)paren
comma
id|size
comma
id|dmab
)paren
OL
l_int|0
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hammerfall_free_buffer
r_static
r_void
id|snd_hammerfall_free_buffer
c_func
(paren
r_struct
id|snd_dma_buffer
op_star
id|dmab
comma
r_struct
id|pci_dev
op_star
id|pci
)paren
(brace
r_if
c_cond
(paren
id|dmab-&gt;area
)paren
id|snd_dma_reserve_buf
c_func
(paren
id|dmab
comma
id|snd_dma_pci_buf_id
c_func
(paren
id|pci
)paren
)paren
suffix:semicolon
)brace
DECL|variable|snd_hdsp_ids
r_static
r_struct
id|pci_device_id
id|snd_hdsp_ids
(braket
)braket
op_assign
(brace
(brace
dot
id|vendor
op_assign
id|PCI_VENDOR_ID_XILINX
comma
dot
id|device
op_assign
id|PCI_DEVICE_ID_XILINX_HAMMERFALL_DSP
comma
dot
id|subvendor
op_assign
id|PCI_ANY_ID
comma
dot
id|subdevice
op_assign
id|PCI_ANY_ID
comma
)brace
comma
multiline_comment|/* RME Hammerfall-DSP */
(brace
l_int|0
comma
)brace
comma
)brace
suffix:semicolon
id|MODULE_DEVICE_TABLE
c_func
(paren
id|pci
comma
id|snd_hdsp_ids
)paren
suffix:semicolon
multiline_comment|/* prototypes */
r_static
r_int
id|snd_hdsp_create_alsa_devices
c_func
(paren
id|snd_card_t
op_star
id|card
comma
id|hdsp_t
op_star
id|hdsp
)paren
suffix:semicolon
r_static
r_int
id|snd_hdsp_create_pcm
c_func
(paren
id|snd_card_t
op_star
id|card
comma
id|hdsp_t
op_star
id|hdsp
)paren
suffix:semicolon
r_static
r_int
id|snd_hdsp_enable_io
(paren
id|hdsp_t
op_star
id|hdsp
)paren
suffix:semicolon
r_static
r_void
id|snd_hdsp_initialize_midi_flush
(paren
id|hdsp_t
op_star
id|hdsp
)paren
suffix:semicolon
r_static
r_void
id|snd_hdsp_initialize_channels
(paren
id|hdsp_t
op_star
id|hdsp
)paren
suffix:semicolon
r_static
r_int
id|hdsp_fifo_wait
c_func
(paren
id|hdsp_t
op_star
id|hdsp
comma
r_int
id|count
comma
r_int
id|timeout
)paren
suffix:semicolon
r_static
r_int
id|hdsp_autosync_ref
c_func
(paren
id|hdsp_t
op_star
id|hdsp
)paren
suffix:semicolon
r_static
r_int
id|snd_hdsp_set_defaults
c_func
(paren
id|hdsp_t
op_star
id|hdsp
)paren
suffix:semicolon
r_static
r_void
id|snd_hdsp_9652_enable_mixer
(paren
id|hdsp_t
op_star
id|hdsp
)paren
suffix:semicolon
DECL|function|hdsp_playback_to_output_key
r_static
r_int
id|hdsp_playback_to_output_key
(paren
id|hdsp_t
op_star
id|hdsp
comma
r_int
id|in
comma
r_int
id|out
)paren
(brace
r_switch
c_cond
(paren
id|hdsp-&gt;firmware_rev
)paren
(brace
r_case
l_int|0xa
suffix:colon
r_return
(paren
l_int|64
op_star
id|out
)paren
op_plus
(paren
l_int|32
op_plus
(paren
id|in
)paren
)paren
suffix:semicolon
r_case
l_int|0x96
suffix:colon
r_case
l_int|0x97
suffix:colon
r_return
(paren
l_int|32
op_star
id|out
)paren
op_plus
(paren
l_int|16
op_plus
(paren
id|in
)paren
)paren
suffix:semicolon
r_default
suffix:colon
r_return
(paren
l_int|52
op_star
id|out
)paren
op_plus
(paren
l_int|26
op_plus
(paren
id|in
)paren
)paren
suffix:semicolon
)brace
)brace
DECL|function|hdsp_input_to_output_key
r_static
r_int
id|hdsp_input_to_output_key
(paren
id|hdsp_t
op_star
id|hdsp
comma
r_int
id|in
comma
r_int
id|out
)paren
(brace
r_switch
c_cond
(paren
id|hdsp-&gt;firmware_rev
)paren
(brace
r_case
l_int|0xa
suffix:colon
r_return
(paren
l_int|64
op_star
id|out
)paren
op_plus
id|in
suffix:semicolon
r_case
l_int|0x96
suffix:colon
r_case
l_int|0x97
suffix:colon
r_return
(paren
l_int|32
op_star
id|out
)paren
op_plus
id|in
suffix:semicolon
r_default
suffix:colon
r_return
(paren
l_int|52
op_star
id|out
)paren
op_plus
id|in
suffix:semicolon
)brace
)brace
DECL|function|hdsp_write
r_static
r_void
id|hdsp_write
c_func
(paren
id|hdsp_t
op_star
id|hdsp
comma
r_int
id|reg
comma
r_int
id|val
)paren
(brace
id|writel
c_func
(paren
id|val
comma
id|hdsp-&gt;iobase
op_plus
id|reg
)paren
suffix:semicolon
)brace
DECL|function|hdsp_read
r_static
r_int
r_int
id|hdsp_read
c_func
(paren
id|hdsp_t
op_star
id|hdsp
comma
r_int
id|reg
)paren
(brace
r_return
id|readl
(paren
id|hdsp-&gt;iobase
op_plus
id|reg
)paren
suffix:semicolon
)brace
DECL|function|hdsp_check_for_iobox
r_static
r_int
id|hdsp_check_for_iobox
(paren
id|hdsp_t
op_star
id|hdsp
)paren
(brace
r_if
c_cond
(paren
id|hdsp-&gt;io_type
op_eq
id|H9652
op_logical_or
id|hdsp-&gt;io_type
op_eq
id|H9632
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|hdsp_read
(paren
id|hdsp
comma
id|HDSP_statusRegister
)paren
op_amp
id|HDSP_ConfigError
)paren
(brace
id|snd_printk
(paren
l_string|&quot;Hammerfall-DSP: no Digiface or Multiface connected!&bslash;n&quot;
)paren
suffix:semicolon
id|hdsp-&gt;state
op_and_assign
op_complement
id|HDSP_FirmwareLoaded
suffix:semicolon
r_return
op_minus
id|EIO
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_load_firmware_from_cache
r_static
r_int
id|snd_hdsp_load_firmware_from_cache
c_func
(paren
id|hdsp_t
op_star
id|hdsp
)paren
(brace
r_int
id|i
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_if
c_cond
(paren
(paren
id|hdsp_read
(paren
id|hdsp
comma
id|HDSP_statusRegister
)paren
op_amp
id|HDSP_DllError
)paren
op_ne
l_int|0
)paren
(brace
id|snd_printk
(paren
l_string|&quot;loading firmware&bslash;n&quot;
)paren
suffix:semicolon
id|hdsp_write
(paren
id|hdsp
comma
id|HDSP_control2Reg
comma
id|HDSP_S_PROGRAM
)paren
suffix:semicolon
id|hdsp_write
(paren
id|hdsp
comma
id|HDSP_fifoData
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hdsp_fifo_wait
(paren
id|hdsp
comma
l_int|0
comma
id|HDSP_LONG_WAIT
)paren
)paren
(brace
id|snd_printk
(paren
l_string|&quot;timeout waiting for download preparation&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EIO
suffix:semicolon
)brace
id|hdsp_write
(paren
id|hdsp
comma
id|HDSP_control2Reg
comma
id|HDSP_S_LOAD
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|24413
suffix:semicolon
op_increment
id|i
)paren
(brace
id|hdsp_write
c_func
(paren
id|hdsp
comma
id|HDSP_fifoData
comma
id|hdsp-&gt;firmware_cache
(braket
id|i
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hdsp_fifo_wait
(paren
id|hdsp
comma
l_int|127
comma
id|HDSP_LONG_WAIT
)paren
)paren
(brace
id|snd_printk
(paren
l_string|&quot;timeout during firmware loading&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EIO
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
(paren
l_int|1000
op_div
id|HZ
)paren
OL
l_int|3000
)paren
(brace
id|set_current_state
c_func
(paren
id|TASK_UNINTERRUPTIBLE
)paren
suffix:semicolon
id|schedule_timeout
c_func
(paren
(paren
l_int|3000
op_star
id|HZ
op_plus
l_int|999
)paren
op_div
l_int|1000
)paren
suffix:semicolon
)brace
r_else
(brace
id|mdelay
c_func
(paren
l_int|3000
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|hdsp_fifo_wait
(paren
id|hdsp
comma
l_int|0
comma
id|HDSP_LONG_WAIT
)paren
)paren
(brace
id|snd_printk
(paren
l_string|&quot;timeout at end of firmware loading&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EIO
suffix:semicolon
)brace
macro_line|#ifdef SNDRV_BIG_ENDIAN
id|hdsp-&gt;control2_register
op_assign
id|HDSP_BIGENDIAN_MODE
suffix:semicolon
macro_line|#else
id|hdsp-&gt;control2_register
op_assign
l_int|0
suffix:semicolon
macro_line|#endif
id|hdsp_write
(paren
id|hdsp
comma
id|HDSP_control2Reg
comma
id|hdsp-&gt;control2_register
)paren
suffix:semicolon
id|snd_printk
(paren
l_string|&quot;finished firmware loading&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|hdsp-&gt;state
op_amp
id|HDSP_InitializationComplete
)paren
(brace
id|snd_printk
c_func
(paren
l_string|&quot;firmware loaded from cache, restoring defaults&bslash;n&quot;
)paren
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|hdsp-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|snd_hdsp_set_defaults
c_func
(paren
id|hdsp
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|hdsp-&gt;lock
comma
id|flags
)paren
suffix:semicolon
)brace
id|hdsp-&gt;state
op_or_assign
id|HDSP_FirmwareLoaded
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|hdsp_get_iobox_version
r_static
r_int
id|hdsp_get_iobox_version
(paren
id|hdsp_t
op_star
id|hdsp
)paren
(brace
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
id|hdsp_check_for_iobox
(paren
id|hdsp
)paren
)paren
(brace
r_return
op_minus
id|EIO
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_hdsp_enable_io
c_func
(paren
id|hdsp
)paren
)paren
OL
l_int|0
)paren
(brace
r_return
id|err
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|hdsp_read
(paren
id|hdsp
comma
id|HDSP_statusRegister
)paren
op_amp
id|HDSP_DllError
)paren
op_ne
l_int|0
)paren
(brace
id|hdsp_write
(paren
id|hdsp
comma
id|HDSP_control2Reg
comma
id|HDSP_PROGRAM
)paren
suffix:semicolon
id|hdsp_write
(paren
id|hdsp
comma
id|HDSP_fifoData
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hdsp_fifo_wait
(paren
id|hdsp
comma
l_int|0
comma
id|HDSP_SHORT_WAIT
)paren
OL
l_int|0
)paren
(brace
r_return
op_minus
id|EIO
suffix:semicolon
)brace
id|hdsp_write
(paren
id|hdsp
comma
id|HDSP_control2Reg
comma
id|HDSP_S_LOAD
)paren
suffix:semicolon
id|hdsp_write
(paren
id|hdsp
comma
id|HDSP_fifoData
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hdsp_fifo_wait
(paren
id|hdsp
comma
l_int|0
comma
id|HDSP_SHORT_WAIT
)paren
)paren
(brace
id|hdsp-&gt;io_type
op_assign
id|Multiface
suffix:semicolon
id|hdsp_write
(paren
id|hdsp
comma
id|HDSP_control2Reg
comma
id|HDSP_VERSION_BIT
)paren
suffix:semicolon
id|hdsp_write
(paren
id|hdsp
comma
id|HDSP_control2Reg
comma
id|HDSP_S_LOAD
)paren
suffix:semicolon
id|hdsp_fifo_wait
(paren
id|hdsp
comma
l_int|0
comma
id|HDSP_SHORT_WAIT
)paren
suffix:semicolon
)brace
r_else
(brace
id|hdsp-&gt;io_type
op_assign
id|Digiface
suffix:semicolon
)brace
)brace
r_else
(brace
multiline_comment|/* firmware was already loaded, get iobox type */
r_if
c_cond
(paren
id|hdsp_read
c_func
(paren
id|hdsp
comma
id|HDSP_status2Register
)paren
op_amp
id|HDSP_version1
)paren
(brace
id|hdsp-&gt;io_type
op_assign
id|Multiface
suffix:semicolon
)brace
r_else
(brace
id|hdsp-&gt;io_type
op_assign
id|Digiface
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|hdsp_check_for_firmware
r_static
r_int
id|hdsp_check_for_firmware
(paren
id|hdsp_t
op_star
id|hdsp
)paren
(brace
r_if
c_cond
(paren
id|hdsp-&gt;io_type
op_eq
id|H9652
op_logical_or
id|hdsp-&gt;io_type
op_eq
id|H9632
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
(paren
id|hdsp_read
(paren
id|hdsp
comma
id|HDSP_statusRegister
)paren
op_amp
id|HDSP_DllError
)paren
op_ne
l_int|0
)paren
(brace
id|snd_printk
c_func
(paren
l_string|&quot;firmware not present.&bslash;n&quot;
)paren
suffix:semicolon
id|hdsp-&gt;state
op_and_assign
op_complement
id|HDSP_FirmwareLoaded
suffix:semicolon
r_return
op_minus
id|EIO
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|hdsp_fifo_wait
r_static
r_int
id|hdsp_fifo_wait
c_func
(paren
id|hdsp_t
op_star
id|hdsp
comma
r_int
id|count
comma
r_int
id|timeout
)paren
(brace
r_int
id|i
suffix:semicolon
multiline_comment|/* the fifoStatus registers reports on how many words&n;&t;   are available in the command FIFO.&n;&t;*/
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|timeout
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
(paren
r_int
)paren
(paren
id|hdsp_read
(paren
id|hdsp
comma
id|HDSP_fifoStatus
)paren
op_amp
l_int|0xff
)paren
op_le
id|count
)paren
r_return
l_int|0
suffix:semicolon
multiline_comment|/* not very friendly, but we only do this during a firmware&n;&t;&t;   load and changing the mixer, so we just put up with it.&n;&t;&t;*/
id|udelay
(paren
l_int|100
)paren
suffix:semicolon
)brace
id|snd_printk
(paren
l_string|&quot;wait for FIFO status &lt;= %d failed after %d iterations&bslash;n&quot;
comma
id|count
comma
id|timeout
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
DECL|function|hdsp_read_gain
r_static
r_int
id|hdsp_read_gain
(paren
id|hdsp_t
op_star
id|hdsp
comma
r_int
r_int
id|addr
)paren
(brace
r_if
c_cond
(paren
id|addr
op_ge
id|HDSP_MATRIX_MIXER_SIZE
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
r_return
id|hdsp-&gt;mixer_matrix
(braket
id|addr
)braket
suffix:semicolon
)brace
DECL|function|hdsp_write_gain
r_static
r_int
id|hdsp_write_gain
c_func
(paren
id|hdsp_t
op_star
id|hdsp
comma
r_int
r_int
id|addr
comma
r_int
r_int
id|data
)paren
(brace
r_int
r_int
id|ad
suffix:semicolon
r_if
c_cond
(paren
id|addr
op_ge
id|HDSP_MATRIX_MIXER_SIZE
)paren
r_return
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|hdsp-&gt;io_type
op_eq
id|H9652
op_logical_or
id|hdsp-&gt;io_type
op_eq
id|H9632
)paren
(brace
multiline_comment|/* from martin bj&ouml;rnsen:&n;&t;&t;   &n;&t;&t;   &quot;You can only write dwords to the&n;&t;&t;   mixer memory which contain two&n;&t;&t;   mixer values in the low and high&n;&t;&t;   word. So if you want to change&n;&t;&t;   value 0 you have to read value 1&n;&t;&t;   from the cache and write both to&n;&t;&t;   the first dword in the mixer&n;&t;&t;   memory.&quot;&n;&t;&t;*/
r_if
c_cond
(paren
id|hdsp-&gt;io_type
op_eq
id|H9632
op_logical_and
id|addr
op_ge
l_int|512
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|hdsp-&gt;io_type
op_eq
id|H9652
op_logical_and
id|addr
op_ge
l_int|1352
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
id|hdsp-&gt;mixer_matrix
(braket
id|addr
)braket
op_assign
id|data
suffix:semicolon
multiline_comment|/* `addr&squot; addresses a 16-bit wide address, but&n;&t;&t;   the address space accessed via hdsp_write&n;&t;&t;   uses byte offsets. put another way, addr&n;&t;&t;   varies from 0 to 1351, but to access the&n;&t;&t;   corresponding memory location, we need&n;&t;&t;   to access 0 to 2703 ...&n;&t;&t;*/
id|ad
op_assign
id|addr
op_div
l_int|2
suffix:semicolon
id|hdsp_write
(paren
id|hdsp
comma
l_int|4096
op_plus
(paren
id|ad
op_star
l_int|4
)paren
comma
(paren
id|hdsp-&gt;mixer_matrix
(braket
(paren
id|addr
op_amp
l_int|0x7fe
)paren
op_plus
l_int|1
)braket
op_lshift
l_int|16
)paren
op_plus
id|hdsp-&gt;mixer_matrix
(braket
id|addr
op_amp
l_int|0x7fe
)braket
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|ad
op_assign
(paren
id|addr
op_lshift
l_int|16
)paren
op_plus
id|data
suffix:semicolon
r_if
c_cond
(paren
id|hdsp_fifo_wait
c_func
(paren
id|hdsp
comma
l_int|127
comma
id|HDSP_LONG_WAIT
)paren
)paren
(brace
r_return
op_minus
l_int|1
suffix:semicolon
)brace
id|hdsp_write
(paren
id|hdsp
comma
id|HDSP_fifoData
comma
id|ad
)paren
suffix:semicolon
id|hdsp-&gt;mixer_matrix
(braket
id|addr
)braket
op_assign
id|data
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_use_is_exclusive
r_static
r_int
id|snd_hdsp_use_is_exclusive
c_func
(paren
id|hdsp_t
op_star
id|hdsp
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
r_int
id|ret
op_assign
l_int|1
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|hdsp-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|hdsp-&gt;playback_pid
op_ne
id|hdsp-&gt;capture_pid
)paren
op_logical_and
(paren
id|hdsp-&gt;playback_pid
op_ge
l_int|0
)paren
op_logical_and
(paren
id|hdsp-&gt;capture_pid
op_ge
l_int|0
)paren
)paren
(brace
id|ret
op_assign
l_int|0
suffix:semicolon
)brace
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|hdsp-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
DECL|function|hdsp_external_sample_rate
r_static
r_int
id|hdsp_external_sample_rate
(paren
id|hdsp_t
op_star
id|hdsp
)paren
(brace
r_int
r_int
id|status2
op_assign
id|hdsp_read
c_func
(paren
id|hdsp
comma
id|HDSP_status2Register
)paren
suffix:semicolon
r_int
r_int
id|rate_bits
op_assign
id|status2
op_amp
id|HDSP_systemFrequencyMask
suffix:semicolon
r_switch
c_cond
(paren
id|rate_bits
)paren
(brace
r_case
id|HDSP_systemFrequency32
suffix:colon
r_return
l_int|32000
suffix:semicolon
r_case
id|HDSP_systemFrequency44_1
suffix:colon
r_return
l_int|44100
suffix:semicolon
r_case
id|HDSP_systemFrequency48
suffix:colon
r_return
l_int|48000
suffix:semicolon
r_case
id|HDSP_systemFrequency64
suffix:colon
r_return
l_int|64000
suffix:semicolon
r_case
id|HDSP_systemFrequency88_2
suffix:colon
r_return
l_int|88200
suffix:semicolon
r_case
id|HDSP_systemFrequency96
suffix:colon
r_return
l_int|96000
suffix:semicolon
r_default
suffix:colon
r_return
l_int|0
suffix:semicolon
)brace
)brace
DECL|function|hdsp_spdif_sample_rate
r_static
r_int
id|hdsp_spdif_sample_rate
c_func
(paren
id|hdsp_t
op_star
id|hdsp
)paren
(brace
r_int
r_int
id|status
op_assign
id|hdsp_read
c_func
(paren
id|hdsp
comma
id|HDSP_statusRegister
)paren
suffix:semicolon
r_int
r_int
id|rate_bits
op_assign
(paren
id|status
op_amp
id|HDSP_spdifFrequencyMask
)paren
suffix:semicolon
r_if
c_cond
(paren
id|status
op_amp
id|HDSP_SPDIFErrorFlag
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|rate_bits
)paren
(brace
r_case
id|HDSP_spdifFrequency32KHz
suffix:colon
r_return
l_int|32000
suffix:semicolon
r_case
id|HDSP_spdifFrequency44_1KHz
suffix:colon
r_return
l_int|44100
suffix:semicolon
r_case
id|HDSP_spdifFrequency48KHz
suffix:colon
r_return
l_int|48000
suffix:semicolon
r_case
id|HDSP_spdifFrequency64KHz
suffix:colon
r_return
l_int|64000
suffix:semicolon
r_case
id|HDSP_spdifFrequency88_2KHz
suffix:colon
r_return
l_int|88200
suffix:semicolon
r_case
id|HDSP_spdifFrequency96KHz
suffix:colon
r_return
l_int|96000
suffix:semicolon
r_case
id|HDSP_spdifFrequency128KHz
suffix:colon
r_if
c_cond
(paren
id|hdsp-&gt;io_type
op_eq
id|H9632
)paren
r_return
l_int|128000
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HDSP_spdifFrequency176_4KHz
suffix:colon
r_if
c_cond
(paren
id|hdsp-&gt;io_type
op_eq
id|H9632
)paren
r_return
l_int|176400
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HDSP_spdifFrequency192KHz
suffix:colon
r_if
c_cond
(paren
id|hdsp-&gt;io_type
op_eq
id|H9632
)paren
r_return
l_int|192000
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_break
suffix:semicolon
)brace
id|snd_printk
(paren
l_string|&quot;unknown spdif frequency status; bits = 0x%x, status = 0x%x&bslash;n&quot;
comma
id|rate_bits
comma
id|status
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|hdsp_compute_period_size
r_static
r_void
id|hdsp_compute_period_size
c_func
(paren
id|hdsp_t
op_star
id|hdsp
)paren
(brace
id|hdsp-&gt;period_bytes
op_assign
l_int|1
op_lshift
(paren
(paren
id|hdsp_decode_latency
c_func
(paren
id|hdsp-&gt;control_register
)paren
op_plus
l_int|8
)paren
)paren
suffix:semicolon
)brace
DECL|function|hdsp_hw_pointer
r_static
id|snd_pcm_uframes_t
id|hdsp_hw_pointer
c_func
(paren
id|hdsp_t
op_star
id|hdsp
)paren
(brace
r_int
id|position
suffix:semicolon
id|position
op_assign
id|hdsp_read
c_func
(paren
id|hdsp
comma
id|HDSP_statusRegister
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|hdsp-&gt;precise_ptr
)paren
(brace
r_return
(paren
id|position
op_amp
id|HDSP_BufferID
)paren
ques
c_cond
(paren
id|hdsp-&gt;period_bytes
op_div
l_int|4
)paren
suffix:colon
l_int|0
suffix:semicolon
)brace
id|position
op_and_assign
id|HDSP_BufferPositionMask
suffix:semicolon
id|position
op_div_assign
l_int|4
suffix:semicolon
id|position
op_and_assign
(paren
id|hdsp-&gt;period_bytes
op_div
l_int|2
)paren
op_minus
l_int|1
suffix:semicolon
r_return
id|position
suffix:semicolon
)brace
DECL|function|hdsp_reset_hw_pointer
r_static
r_void
id|hdsp_reset_hw_pointer
c_func
(paren
id|hdsp_t
op_star
id|hdsp
)paren
(brace
id|hdsp_write
(paren
id|hdsp
comma
id|HDSP_resetPointer
comma
l_int|0
)paren
suffix:semicolon
)brace
DECL|function|hdsp_start_audio
r_static
r_void
id|hdsp_start_audio
c_func
(paren
id|hdsp_t
op_star
id|s
)paren
(brace
id|s-&gt;control_register
op_or_assign
(paren
id|HDSP_AudioInterruptEnable
op_or
id|HDSP_Start
)paren
suffix:semicolon
id|hdsp_write
c_func
(paren
id|s
comma
id|HDSP_controlRegister
comma
id|s-&gt;control_register
)paren
suffix:semicolon
)brace
DECL|function|hdsp_stop_audio
r_static
r_void
id|hdsp_stop_audio
c_func
(paren
id|hdsp_t
op_star
id|s
)paren
(brace
id|s-&gt;control_register
op_and_assign
op_complement
(paren
id|HDSP_Start
op_or
id|HDSP_AudioInterruptEnable
)paren
suffix:semicolon
id|hdsp_write
c_func
(paren
id|s
comma
id|HDSP_controlRegister
comma
id|s-&gt;control_register
)paren
suffix:semicolon
)brace
DECL|function|hdsp_silence_playback
r_static
r_void
id|hdsp_silence_playback
c_func
(paren
id|hdsp_t
op_star
id|hdsp
)paren
(brace
id|memset
c_func
(paren
id|hdsp-&gt;playback_buffer
comma
l_int|0
comma
id|HDSP_DMA_AREA_BYTES
)paren
suffix:semicolon
)brace
DECL|function|hdsp_set_interrupt_interval
r_static
r_int
id|hdsp_set_interrupt_interval
c_func
(paren
id|hdsp_t
op_star
id|s
comma
r_int
r_int
id|frames
)paren
(brace
r_int
id|n
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|s-&gt;lock
)paren
suffix:semicolon
id|frames
op_rshift_assign
l_int|7
suffix:semicolon
id|n
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
id|frames
)paren
(brace
id|n
op_increment
suffix:semicolon
id|frames
op_rshift_assign
l_int|1
suffix:semicolon
)brace
id|s-&gt;control_register
op_and_assign
op_complement
id|HDSP_LatencyMask
suffix:semicolon
id|s-&gt;control_register
op_or_assign
id|hdsp_encode_latency
c_func
(paren
id|n
)paren
suffix:semicolon
id|hdsp_write
c_func
(paren
id|s
comma
id|HDSP_controlRegister
comma
id|s-&gt;control_register
)paren
suffix:semicolon
id|hdsp_compute_period_size
c_func
(paren
id|s
)paren
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|s-&gt;lock
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|hdsp_set_rate
r_static
r_int
id|hdsp_set_rate
c_func
(paren
id|hdsp_t
op_star
id|hdsp
comma
r_int
id|rate
comma
r_int
id|called_internally
)paren
(brace
r_int
id|reject_if_open
op_assign
l_int|0
suffix:semicolon
r_int
id|current_rate
suffix:semicolon
r_int
id|rate_bits
suffix:semicolon
multiline_comment|/* ASSUMPTION: hdsp-&gt;lock is either held, or&n;&t;   there is no need for it (e.g. during module&n;&t;   initialization).&n;&t;*/
r_if
c_cond
(paren
op_logical_neg
(paren
id|hdsp-&gt;control_register
op_amp
id|HDSP_ClockModeMaster
)paren
)paren
(brace
r_if
c_cond
(paren
id|called_internally
)paren
(brace
multiline_comment|/* request from ctl or card initialization */
id|snd_printk
c_func
(paren
l_string|&quot;device is not running as a clock master: cannot set sample rate.&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* hw_param request while in AutoSync mode */
r_int
id|external_freq
op_assign
id|hdsp_external_sample_rate
c_func
(paren
id|hdsp
)paren
suffix:semicolon
r_int
id|spdif_freq
op_assign
id|hdsp_spdif_sample_rate
c_func
(paren
id|hdsp
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|spdif_freq
op_eq
id|external_freq
op_star
l_int|2
)paren
op_logical_and
(paren
id|hdsp_autosync_ref
c_func
(paren
id|hdsp
)paren
op_ge
id|HDSP_AUTOSYNC_FROM_ADAT1
)paren
)paren
(brace
id|snd_printk
c_func
(paren
l_string|&quot;Detected ADAT in double speed mode&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|hdsp-&gt;io_type
op_eq
id|H9632
op_logical_and
(paren
id|spdif_freq
op_eq
id|external_freq
op_star
l_int|4
)paren
op_logical_and
(paren
id|hdsp_autosync_ref
c_func
(paren
id|hdsp
)paren
op_ge
id|HDSP_AUTOSYNC_FROM_ADAT1
)paren
)paren
(brace
id|snd_printk
c_func
(paren
l_string|&quot;Detected ADAT in quad speed mode&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|rate
op_ne
id|external_freq
)paren
(brace
id|snd_printk
c_func
(paren
l_string|&quot;No AutoSync source for requested rate&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
)brace
)brace
id|current_rate
op_assign
id|hdsp-&gt;system_sample_rate
suffix:semicolon
multiline_comment|/* Changing from a &quot;single speed&quot; to a &quot;double speed&quot; rate is&n;&t;   not allowed if any substreams are open. This is because&n;&t;   such a change causes a shift in the location of &n;&t;   the DMA buffers and a reduction in the number of available&n;&t;   buffers. &n;&n;&t;   Note that a similar but essentially insoluble problem&n;&t;   exists for externally-driven rate changes. All we can do&n;&t;   is to flag rate changes in the read/write routines.  */
r_if
c_cond
(paren
id|rate
OG
l_int|96000
op_logical_and
id|hdsp-&gt;io_type
op_ne
id|H9632
)paren
(brace
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|rate
)paren
(brace
r_case
l_int|32000
suffix:colon
r_if
c_cond
(paren
id|current_rate
OG
l_int|48000
)paren
(brace
id|reject_if_open
op_assign
l_int|1
suffix:semicolon
)brace
id|rate_bits
op_assign
id|HDSP_Frequency32KHz
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|44100
suffix:colon
r_if
c_cond
(paren
id|current_rate
OG
l_int|48000
)paren
(brace
id|reject_if_open
op_assign
l_int|1
suffix:semicolon
)brace
id|rate_bits
op_assign
id|HDSP_Frequency44_1KHz
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|48000
suffix:colon
r_if
c_cond
(paren
id|current_rate
OG
l_int|48000
)paren
(brace
id|reject_if_open
op_assign
l_int|1
suffix:semicolon
)brace
id|rate_bits
op_assign
id|HDSP_Frequency48KHz
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|64000
suffix:colon
r_if
c_cond
(paren
id|current_rate
op_le
l_int|48000
op_logical_or
id|current_rate
OG
l_int|96000
)paren
(brace
id|reject_if_open
op_assign
l_int|1
suffix:semicolon
)brace
id|rate_bits
op_assign
id|HDSP_Frequency64KHz
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|88200
suffix:colon
r_if
c_cond
(paren
id|current_rate
op_le
l_int|48000
op_logical_or
id|current_rate
OG
l_int|96000
)paren
(brace
id|reject_if_open
op_assign
l_int|1
suffix:semicolon
)brace
id|rate_bits
op_assign
id|HDSP_Frequency88_2KHz
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|96000
suffix:colon
r_if
c_cond
(paren
id|current_rate
op_le
l_int|48000
op_logical_or
id|current_rate
OG
l_int|96000
)paren
(brace
id|reject_if_open
op_assign
l_int|1
suffix:semicolon
)brace
id|rate_bits
op_assign
id|HDSP_Frequency96KHz
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|128000
suffix:colon
r_if
c_cond
(paren
id|current_rate
OL
l_int|128000
)paren
(brace
id|reject_if_open
op_assign
l_int|1
suffix:semicolon
)brace
id|rate_bits
op_assign
id|HDSP_Frequency128KHz
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|176400
suffix:colon
r_if
c_cond
(paren
id|current_rate
OL
l_int|128000
)paren
(brace
id|reject_if_open
op_assign
l_int|1
suffix:semicolon
)brace
id|rate_bits
op_assign
id|HDSP_Frequency176_4KHz
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|192000
suffix:colon
r_if
c_cond
(paren
id|current_rate
OL
l_int|128000
)paren
(brace
id|reject_if_open
op_assign
l_int|1
suffix:semicolon
)brace
id|rate_bits
op_assign
id|HDSP_Frequency192KHz
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|reject_if_open
op_logical_and
(paren
id|hdsp-&gt;capture_pid
op_ge
l_int|0
op_logical_or
id|hdsp-&gt;playback_pid
op_ge
l_int|0
)paren
)paren
(brace
id|snd_printk
(paren
l_string|&quot;cannot change speed mode (capture PID = %d, playback PID = %d)&bslash;n&quot;
comma
id|hdsp-&gt;capture_pid
comma
id|hdsp-&gt;playback_pid
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
id|hdsp-&gt;control_register
op_and_assign
op_complement
id|HDSP_FrequencyMask
suffix:semicolon
id|hdsp-&gt;control_register
op_or_assign
id|rate_bits
suffix:semicolon
id|hdsp_write
c_func
(paren
id|hdsp
comma
id|HDSP_controlRegister
comma
id|hdsp-&gt;control_register
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rate
op_ge
l_int|128000
)paren
(brace
id|hdsp-&gt;channel_map
op_assign
id|channel_map_H9632_qs
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|rate
OG
l_int|48000
)paren
(brace
r_if
c_cond
(paren
id|hdsp-&gt;io_type
op_eq
id|H9632
)paren
(brace
id|hdsp-&gt;channel_map
op_assign
id|channel_map_H9632_ds
suffix:semicolon
)brace
r_else
(brace
id|hdsp-&gt;channel_map
op_assign
id|channel_map_ds
suffix:semicolon
)brace
)brace
r_else
(brace
r_switch
c_cond
(paren
id|hdsp-&gt;io_type
)paren
(brace
r_case
id|Multiface
suffix:colon
id|hdsp-&gt;channel_map
op_assign
id|channel_map_mf_ss
suffix:semicolon
r_break
suffix:semicolon
r_case
id|Digiface
suffix:colon
r_case
id|H9652
suffix:colon
id|hdsp-&gt;channel_map
op_assign
id|channel_map_df_ss
suffix:semicolon
r_break
suffix:semicolon
r_case
id|H9632
suffix:colon
id|hdsp-&gt;channel_map
op_assign
id|channel_map_H9632_ss
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
multiline_comment|/* should never happen */
r_break
suffix:semicolon
)brace
)brace
id|hdsp-&gt;system_sample_rate
op_assign
id|rate
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|hdsp_set_thru
r_static
r_void
id|hdsp_set_thru
c_func
(paren
id|hdsp_t
op_star
id|hdsp
comma
r_int
id|channel
comma
r_int
id|enable
)paren
(brace
id|hdsp-&gt;passthru
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|channel
OL
l_int|0
)paren
(brace
r_int
id|i
suffix:semicolon
multiline_comment|/* set thru for all channels */
r_if
c_cond
(paren
id|enable
)paren
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|hdsp-&gt;max_channels
suffix:semicolon
id|i
op_increment
)paren
(brace
id|hdsp_write_gain
(paren
id|hdsp
comma
id|hdsp_input_to_output_key
c_func
(paren
id|hdsp
comma
id|i
comma
id|i
)paren
comma
id|UNITY_GAIN
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|hdsp-&gt;max_channels
suffix:semicolon
id|i
op_increment
)paren
(brace
id|hdsp_write_gain
(paren
id|hdsp
comma
id|hdsp_input_to_output_key
c_func
(paren
id|hdsp
comma
id|i
comma
id|i
)paren
comma
id|MINUS_INFINITY_GAIN
)paren
suffix:semicolon
)brace
)brace
)brace
r_else
(brace
r_int
id|mapped_channel
suffix:semicolon
id|snd_assert
c_func
(paren
id|channel
OL
id|hdsp-&gt;max_channels
comma
r_return
)paren
suffix:semicolon
id|mapped_channel
op_assign
id|hdsp-&gt;channel_map
(braket
id|channel
)braket
suffix:semicolon
id|snd_assert
c_func
(paren
id|mapped_channel
OG
op_minus
l_int|1
comma
r_return
)paren
suffix:semicolon
r_if
c_cond
(paren
id|enable
)paren
(brace
id|hdsp_write_gain
(paren
id|hdsp
comma
id|hdsp_input_to_output_key
c_func
(paren
id|hdsp
comma
id|mapped_channel
comma
id|mapped_channel
)paren
comma
id|UNITY_GAIN
)paren
suffix:semicolon
)brace
r_else
(brace
id|hdsp_write_gain
(paren
id|hdsp
comma
id|hdsp_input_to_output_key
c_func
(paren
id|hdsp
comma
id|mapped_channel
comma
id|mapped_channel
)paren
comma
id|MINUS_INFINITY_GAIN
)paren
suffix:semicolon
)brace
)brace
)brace
DECL|function|hdsp_set_passthru
r_static
r_int
id|hdsp_set_passthru
c_func
(paren
id|hdsp_t
op_star
id|hdsp
comma
r_int
id|onoff
)paren
(brace
r_if
c_cond
(paren
id|onoff
)paren
(brace
id|hdsp_set_thru
c_func
(paren
id|hdsp
comma
op_minus
l_int|1
comma
l_int|1
)paren
suffix:semicolon
id|hdsp_reset_hw_pointer
c_func
(paren
id|hdsp
)paren
suffix:semicolon
id|hdsp_silence_playback
c_func
(paren
id|hdsp
)paren
suffix:semicolon
multiline_comment|/* we don&squot;t want interrupts, so do a&n;&t;&t;   custom version of hdsp_start_audio().&n;&t;&t;*/
id|hdsp-&gt;control_register
op_or_assign
(paren
id|HDSP_Start
op_or
id|HDSP_AudioInterruptEnable
op_or
id|hdsp_encode_latency
c_func
(paren
l_int|7
)paren
)paren
suffix:semicolon
id|hdsp_write
c_func
(paren
id|hdsp
comma
id|HDSP_controlRegister
comma
id|hdsp-&gt;control_register
)paren
suffix:semicolon
id|hdsp-&gt;passthru
op_assign
l_int|1
suffix:semicolon
)brace
r_else
(brace
id|hdsp_set_thru
c_func
(paren
id|hdsp
comma
op_minus
l_int|1
comma
l_int|0
)paren
suffix:semicolon
id|hdsp_stop_audio
c_func
(paren
id|hdsp
)paren
suffix:semicolon
id|hdsp-&gt;passthru
op_assign
l_int|0
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*----------------------------------------------------------------------------&n;   MIDI&n;  ----------------------------------------------------------------------------*/
DECL|function|snd_hdsp_midi_read_byte
r_static
r_int
r_char
id|snd_hdsp_midi_read_byte
(paren
id|hdsp_t
op_star
id|hdsp
comma
r_int
id|id
)paren
(brace
multiline_comment|/* the hardware already does the relevant bit-mask with 0xff */
r_if
c_cond
(paren
id|id
)paren
(brace
r_return
id|hdsp_read
c_func
(paren
id|hdsp
comma
id|HDSP_midiDataIn1
)paren
suffix:semicolon
)brace
r_else
(brace
r_return
id|hdsp_read
c_func
(paren
id|hdsp
comma
id|HDSP_midiDataIn0
)paren
suffix:semicolon
)brace
)brace
DECL|function|snd_hdsp_midi_write_byte
r_static
r_void
id|snd_hdsp_midi_write_byte
(paren
id|hdsp_t
op_star
id|hdsp
comma
r_int
id|id
comma
r_int
id|val
)paren
(brace
multiline_comment|/* the hardware already does the relevant bit-mask with 0xff */
r_if
c_cond
(paren
id|id
)paren
(brace
id|hdsp_write
c_func
(paren
id|hdsp
comma
id|HDSP_midiDataOut1
comma
id|val
)paren
suffix:semicolon
)brace
r_else
(brace
id|hdsp_write
c_func
(paren
id|hdsp
comma
id|HDSP_midiDataOut0
comma
id|val
)paren
suffix:semicolon
)brace
)brace
DECL|function|snd_hdsp_midi_input_available
r_static
r_int
id|snd_hdsp_midi_input_available
(paren
id|hdsp_t
op_star
id|hdsp
comma
r_int
id|id
)paren
(brace
r_if
c_cond
(paren
id|id
)paren
(brace
r_return
(paren
id|hdsp_read
c_func
(paren
id|hdsp
comma
id|HDSP_midiStatusIn1
)paren
op_amp
l_int|0xff
)paren
suffix:semicolon
)brace
r_else
(brace
r_return
(paren
id|hdsp_read
c_func
(paren
id|hdsp
comma
id|HDSP_midiStatusIn0
)paren
op_amp
l_int|0xff
)paren
suffix:semicolon
)brace
)brace
DECL|function|snd_hdsp_midi_output_possible
r_static
r_int
id|snd_hdsp_midi_output_possible
(paren
id|hdsp_t
op_star
id|hdsp
comma
r_int
id|id
)paren
(brace
r_int
id|fifo_bytes_used
suffix:semicolon
r_if
c_cond
(paren
id|id
)paren
(brace
id|fifo_bytes_used
op_assign
id|hdsp_read
c_func
(paren
id|hdsp
comma
id|HDSP_midiStatusOut1
)paren
op_amp
l_int|0xff
suffix:semicolon
)brace
r_else
(brace
id|fifo_bytes_used
op_assign
id|hdsp_read
c_func
(paren
id|hdsp
comma
id|HDSP_midiStatusOut0
)paren
op_amp
l_int|0xff
suffix:semicolon
)brace
r_if
c_cond
(paren
id|fifo_bytes_used
OL
l_int|128
)paren
(brace
r_return
l_int|128
op_minus
id|fifo_bytes_used
suffix:semicolon
)brace
r_else
(brace
r_return
l_int|0
suffix:semicolon
)brace
)brace
DECL|function|snd_hdsp_flush_midi_input
r_static
r_void
id|snd_hdsp_flush_midi_input
(paren
id|hdsp_t
op_star
id|hdsp
comma
r_int
id|id
)paren
(brace
r_while
c_loop
(paren
id|snd_hdsp_midi_input_available
(paren
id|hdsp
comma
id|id
)paren
)paren
(brace
id|snd_hdsp_midi_read_byte
(paren
id|hdsp
comma
id|id
)paren
suffix:semicolon
)brace
)brace
DECL|function|snd_hdsp_midi_output_write
r_static
r_int
id|snd_hdsp_midi_output_write
(paren
id|hdsp_midi_t
op_star
id|hmidi
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
r_int
id|n_pending
suffix:semicolon
r_int
id|to_write
suffix:semicolon
r_int
id|i
suffix:semicolon
r_int
r_char
id|buf
(braket
l_int|128
)braket
suffix:semicolon
multiline_comment|/* Output is not interrupt driven */
id|spin_lock_irqsave
(paren
op_amp
id|hmidi-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hmidi-&gt;output
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|snd_rawmidi_transmit_empty
(paren
id|hmidi-&gt;output
)paren
)paren
(brace
r_if
c_cond
(paren
(paren
id|n_pending
op_assign
id|snd_hdsp_midi_output_possible
(paren
id|hmidi-&gt;hdsp
comma
id|hmidi-&gt;id
)paren
)paren
OG
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|n_pending
OG
(paren
r_int
)paren
r_sizeof
(paren
id|buf
)paren
)paren
id|n_pending
op_assign
r_sizeof
(paren
id|buf
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|to_write
op_assign
id|snd_rawmidi_transmit
(paren
id|hmidi-&gt;output
comma
id|buf
comma
id|n_pending
)paren
)paren
OG
l_int|0
)paren
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|to_write
suffix:semicolon
op_increment
id|i
)paren
id|snd_hdsp_midi_write_byte
(paren
id|hmidi-&gt;hdsp
comma
id|hmidi-&gt;id
comma
id|buf
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
)brace
)brace
)brace
id|spin_unlock_irqrestore
(paren
op_amp
id|hmidi-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_midi_input_read
r_static
r_int
id|snd_hdsp_midi_input_read
(paren
id|hdsp_midi_t
op_star
id|hmidi
)paren
(brace
r_int
r_char
id|buf
(braket
l_int|128
)braket
suffix:semicolon
multiline_comment|/* this buffer is designed to match the MIDI input FIFO size */
r_int
r_int
id|flags
suffix:semicolon
r_int
id|n_pending
suffix:semicolon
r_int
id|i
suffix:semicolon
id|spin_lock_irqsave
(paren
op_amp
id|hmidi-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|n_pending
op_assign
id|snd_hdsp_midi_input_available
(paren
id|hmidi-&gt;hdsp
comma
id|hmidi-&gt;id
)paren
)paren
OG
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|hmidi-&gt;input
)paren
(brace
r_if
c_cond
(paren
id|n_pending
OG
(paren
r_int
)paren
r_sizeof
(paren
id|buf
)paren
)paren
(brace
id|n_pending
op_assign
r_sizeof
(paren
id|buf
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|n_pending
suffix:semicolon
op_increment
id|i
)paren
(brace
id|buf
(braket
id|i
)braket
op_assign
id|snd_hdsp_midi_read_byte
(paren
id|hmidi-&gt;hdsp
comma
id|hmidi-&gt;id
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|n_pending
)paren
(brace
id|snd_rawmidi_receive
(paren
id|hmidi-&gt;input
comma
id|buf
comma
id|n_pending
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
multiline_comment|/* flush the MIDI input FIFO */
r_while
c_loop
(paren
op_decrement
id|n_pending
)paren
(brace
id|snd_hdsp_midi_read_byte
(paren
id|hmidi-&gt;hdsp
comma
id|hmidi-&gt;id
)paren
suffix:semicolon
)brace
)brace
)brace
id|hmidi-&gt;pending
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|hmidi-&gt;id
)paren
(brace
id|hmidi-&gt;hdsp-&gt;control_register
op_or_assign
id|HDSP_Midi1InterruptEnable
suffix:semicolon
)brace
r_else
(brace
id|hmidi-&gt;hdsp-&gt;control_register
op_or_assign
id|HDSP_Midi0InterruptEnable
suffix:semicolon
)brace
id|hdsp_write
c_func
(paren
id|hmidi-&gt;hdsp
comma
id|HDSP_controlRegister
comma
id|hmidi-&gt;hdsp-&gt;control_register
)paren
suffix:semicolon
id|spin_unlock_irqrestore
(paren
op_amp
id|hmidi-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_return
id|snd_hdsp_midi_output_write
(paren
id|hmidi
)paren
suffix:semicolon
)brace
DECL|function|snd_hdsp_midi_input_trigger
r_static
r_void
id|snd_hdsp_midi_input_trigger
c_func
(paren
id|snd_rawmidi_substream_t
op_star
id|substream
comma
r_int
id|up
)paren
(brace
id|hdsp_t
op_star
id|hdsp
suffix:semicolon
id|hdsp_midi_t
op_star
id|hmidi
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|u32
id|ie
suffix:semicolon
id|hmidi
op_assign
(paren
id|hdsp_midi_t
op_star
)paren
id|substream-&gt;rmidi-&gt;private_data
suffix:semicolon
id|hdsp
op_assign
id|hmidi-&gt;hdsp
suffix:semicolon
id|ie
op_assign
id|hmidi-&gt;id
ques
c_cond
id|HDSP_Midi1InterruptEnable
suffix:colon
id|HDSP_Midi0InterruptEnable
suffix:semicolon
id|spin_lock_irqsave
(paren
op_amp
id|hdsp-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|up
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|hdsp-&gt;control_register
op_amp
id|ie
)paren
)paren
(brace
id|snd_hdsp_flush_midi_input
(paren
id|hdsp
comma
id|hmidi-&gt;id
)paren
suffix:semicolon
id|hdsp-&gt;control_register
op_or_assign
id|ie
suffix:semicolon
)brace
)brace
r_else
(brace
id|hdsp-&gt;control_register
op_and_assign
op_complement
id|ie
suffix:semicolon
)brace
id|hdsp_write
c_func
(paren
id|hdsp
comma
id|HDSP_controlRegister
comma
id|hdsp-&gt;control_register
)paren
suffix:semicolon
id|spin_unlock_irqrestore
(paren
op_amp
id|hdsp-&gt;lock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|snd_hdsp_midi_output_timer
r_static
r_void
id|snd_hdsp_midi_output_timer
c_func
(paren
r_int
r_int
id|data
)paren
(brace
id|hdsp_midi_t
op_star
id|hmidi
op_assign
(paren
id|hdsp_midi_t
op_star
)paren
id|data
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|snd_hdsp_midi_output_write
c_func
(paren
id|hmidi
)paren
suffix:semicolon
id|spin_lock_irqsave
(paren
op_amp
id|hmidi-&gt;lock
comma
id|flags
)paren
suffix:semicolon
multiline_comment|/* this does not bump hmidi-&gt;istimer, because the&n;&t;   kernel automatically removed the timer when it&n;&t;   expired, and we are now adding it back, thus&n;&t;   leaving istimer wherever it was set before.  &n;&t;*/
r_if
c_cond
(paren
id|hmidi-&gt;istimer
)paren
(brace
id|hmidi-&gt;timer.expires
op_assign
l_int|1
op_plus
id|jiffies
suffix:semicolon
id|add_timer
c_func
(paren
op_amp
id|hmidi-&gt;timer
)paren
suffix:semicolon
)brace
id|spin_unlock_irqrestore
(paren
op_amp
id|hmidi-&gt;lock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|snd_hdsp_midi_output_trigger
r_static
r_void
id|snd_hdsp_midi_output_trigger
c_func
(paren
id|snd_rawmidi_substream_t
op_star
id|substream
comma
r_int
id|up
)paren
(brace
id|hdsp_midi_t
op_star
id|hmidi
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|hmidi
op_assign
(paren
id|hdsp_midi_t
op_star
)paren
id|substream-&gt;rmidi-&gt;private_data
suffix:semicolon
id|spin_lock_irqsave
(paren
op_amp
id|hmidi-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|up
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|hmidi-&gt;istimer
)paren
(brace
id|init_timer
c_func
(paren
op_amp
id|hmidi-&gt;timer
)paren
suffix:semicolon
id|hmidi-&gt;timer.function
op_assign
id|snd_hdsp_midi_output_timer
suffix:semicolon
id|hmidi-&gt;timer.data
op_assign
(paren
r_int
r_int
)paren
id|hmidi
suffix:semicolon
id|hmidi-&gt;timer.expires
op_assign
l_int|1
op_plus
id|jiffies
suffix:semicolon
id|add_timer
c_func
(paren
op_amp
id|hmidi-&gt;timer
)paren
suffix:semicolon
id|hmidi-&gt;istimer
op_increment
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|hmidi-&gt;istimer
op_logical_and
op_decrement
id|hmidi-&gt;istimer
op_le
l_int|0
)paren
(brace
id|del_timer
(paren
op_amp
id|hmidi-&gt;timer
)paren
suffix:semicolon
)brace
)brace
id|spin_unlock_irqrestore
(paren
op_amp
id|hmidi-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|up
)paren
id|snd_hdsp_midi_output_write
c_func
(paren
id|hmidi
)paren
suffix:semicolon
)brace
DECL|function|snd_hdsp_midi_input_open
r_static
r_int
id|snd_hdsp_midi_input_open
c_func
(paren
id|snd_rawmidi_substream_t
op_star
id|substream
)paren
(brace
id|hdsp_midi_t
op_star
id|hmidi
suffix:semicolon
id|hmidi
op_assign
(paren
id|hdsp_midi_t
op_star
)paren
id|substream-&gt;rmidi-&gt;private_data
suffix:semicolon
id|spin_lock_irq
(paren
op_amp
id|hmidi-&gt;lock
)paren
suffix:semicolon
id|snd_hdsp_flush_midi_input
(paren
id|hmidi-&gt;hdsp
comma
id|hmidi-&gt;id
)paren
suffix:semicolon
id|hmidi-&gt;input
op_assign
id|substream
suffix:semicolon
id|spin_unlock_irq
(paren
op_amp
id|hmidi-&gt;lock
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_midi_output_open
r_static
r_int
id|snd_hdsp_midi_output_open
c_func
(paren
id|snd_rawmidi_substream_t
op_star
id|substream
)paren
(brace
id|hdsp_midi_t
op_star
id|hmidi
suffix:semicolon
id|hmidi
op_assign
(paren
id|hdsp_midi_t
op_star
)paren
id|substream-&gt;rmidi-&gt;private_data
suffix:semicolon
id|spin_lock_irq
(paren
op_amp
id|hmidi-&gt;lock
)paren
suffix:semicolon
id|hmidi-&gt;output
op_assign
id|substream
suffix:semicolon
id|spin_unlock_irq
(paren
op_amp
id|hmidi-&gt;lock
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_midi_input_close
r_static
r_int
id|snd_hdsp_midi_input_close
c_func
(paren
id|snd_rawmidi_substream_t
op_star
id|substream
)paren
(brace
id|hdsp_midi_t
op_star
id|hmidi
suffix:semicolon
id|snd_hdsp_midi_input_trigger
(paren
id|substream
comma
l_int|0
)paren
suffix:semicolon
id|hmidi
op_assign
(paren
id|hdsp_midi_t
op_star
)paren
id|substream-&gt;rmidi-&gt;private_data
suffix:semicolon
id|spin_lock_irq
(paren
op_amp
id|hmidi-&gt;lock
)paren
suffix:semicolon
id|hmidi-&gt;input
op_assign
l_int|NULL
suffix:semicolon
id|spin_unlock_irq
(paren
op_amp
id|hmidi-&gt;lock
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_midi_output_close
r_static
r_int
id|snd_hdsp_midi_output_close
c_func
(paren
id|snd_rawmidi_substream_t
op_star
id|substream
)paren
(brace
id|hdsp_midi_t
op_star
id|hmidi
suffix:semicolon
id|snd_hdsp_midi_output_trigger
(paren
id|substream
comma
l_int|0
)paren
suffix:semicolon
id|hmidi
op_assign
(paren
id|hdsp_midi_t
op_star
)paren
id|substream-&gt;rmidi-&gt;private_data
suffix:semicolon
id|spin_lock_irq
(paren
op_amp
id|hmidi-&gt;lock
)paren
suffix:semicolon
id|hmidi-&gt;output
op_assign
l_int|NULL
suffix:semicolon
id|spin_unlock_irq
(paren
op_amp
id|hmidi-&gt;lock
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|snd_hdsp_midi_output
r_static
id|snd_rawmidi_ops_t
id|snd_hdsp_midi_output
op_assign
(brace
dot
id|open
op_assign
id|snd_hdsp_midi_output_open
comma
dot
id|close
op_assign
id|snd_hdsp_midi_output_close
comma
dot
id|trigger
op_assign
id|snd_hdsp_midi_output_trigger
comma
)brace
suffix:semicolon
DECL|variable|snd_hdsp_midi_input
r_static
id|snd_rawmidi_ops_t
id|snd_hdsp_midi_input
op_assign
(brace
dot
id|open
op_assign
id|snd_hdsp_midi_input_open
comma
dot
id|close
op_assign
id|snd_hdsp_midi_input_close
comma
dot
id|trigger
op_assign
id|snd_hdsp_midi_input_trigger
comma
)brace
suffix:semicolon
DECL|function|snd_hdsp_create_midi
r_static
r_int
id|__devinit
id|snd_hdsp_create_midi
(paren
id|snd_card_t
op_star
id|card
comma
id|hdsp_t
op_star
id|hdsp
comma
r_int
id|id
)paren
(brace
r_char
id|buf
(braket
l_int|32
)braket
suffix:semicolon
id|hdsp-&gt;midi
(braket
id|id
)braket
dot
id|id
op_assign
id|id
suffix:semicolon
id|hdsp-&gt;midi
(braket
id|id
)braket
dot
id|rmidi
op_assign
l_int|NULL
suffix:semicolon
id|hdsp-&gt;midi
(braket
id|id
)braket
dot
id|input
op_assign
l_int|NULL
suffix:semicolon
id|hdsp-&gt;midi
(braket
id|id
)braket
dot
id|output
op_assign
l_int|NULL
suffix:semicolon
id|hdsp-&gt;midi
(braket
id|id
)braket
dot
id|hdsp
op_assign
id|hdsp
suffix:semicolon
id|hdsp-&gt;midi
(braket
id|id
)braket
dot
id|istimer
op_assign
l_int|0
suffix:semicolon
id|hdsp-&gt;midi
(braket
id|id
)braket
dot
id|pending
op_assign
l_int|0
suffix:semicolon
id|spin_lock_init
(paren
op_amp
id|hdsp-&gt;midi
(braket
id|id
)braket
dot
id|lock
)paren
suffix:semicolon
id|sprintf
(paren
id|buf
comma
l_string|&quot;%s MIDI %d&quot;
comma
id|card-&gt;shortname
comma
id|id
op_plus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|snd_rawmidi_new
(paren
id|card
comma
id|buf
comma
id|id
comma
l_int|1
comma
l_int|1
comma
op_amp
id|hdsp-&gt;midi
(braket
id|id
)braket
dot
id|rmidi
)paren
OL
l_int|0
)paren
(brace
r_return
op_minus
l_int|1
suffix:semicolon
)brace
id|sprintf
(paren
id|hdsp-&gt;midi
(braket
id|id
)braket
dot
id|rmidi-&gt;name
comma
l_string|&quot;%s MIDI %d&quot;
comma
id|card-&gt;id
comma
id|id
op_plus
l_int|1
)paren
suffix:semicolon
id|hdsp-&gt;midi
(braket
id|id
)braket
dot
id|rmidi-&gt;private_data
op_assign
op_amp
id|hdsp-&gt;midi
(braket
id|id
)braket
suffix:semicolon
id|snd_rawmidi_set_ops
(paren
id|hdsp-&gt;midi
(braket
id|id
)braket
dot
id|rmidi
comma
id|SNDRV_RAWMIDI_STREAM_OUTPUT
comma
op_amp
id|snd_hdsp_midi_output
)paren
suffix:semicolon
id|snd_rawmidi_set_ops
(paren
id|hdsp-&gt;midi
(braket
id|id
)braket
dot
id|rmidi
comma
id|SNDRV_RAWMIDI_STREAM_INPUT
comma
op_amp
id|snd_hdsp_midi_input
)paren
suffix:semicolon
id|hdsp-&gt;midi
(braket
id|id
)braket
dot
id|rmidi-&gt;info_flags
op_or_assign
id|SNDRV_RAWMIDI_INFO_OUTPUT
op_or
id|SNDRV_RAWMIDI_INFO_INPUT
op_or
id|SNDRV_RAWMIDI_INFO_DUPLEX
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*-----------------------------------------------------------------------------&n;  Control Interface&n;  ----------------------------------------------------------------------------*/
DECL|function|snd_hdsp_convert_from_aes
r_static
id|u32
id|snd_hdsp_convert_from_aes
c_func
(paren
id|snd_aes_iec958_t
op_star
id|aes
)paren
(brace
id|u32
id|val
op_assign
l_int|0
suffix:semicolon
id|val
op_or_assign
(paren
id|aes-&gt;status
(braket
l_int|0
)braket
op_amp
id|IEC958_AES0_PROFESSIONAL
)paren
ques
c_cond
id|HDSP_SPDIFProfessional
suffix:colon
l_int|0
suffix:semicolon
id|val
op_or_assign
(paren
id|aes-&gt;status
(braket
l_int|0
)braket
op_amp
id|IEC958_AES0_NONAUDIO
)paren
ques
c_cond
id|HDSP_SPDIFNonAudio
suffix:colon
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|val
op_amp
id|HDSP_SPDIFProfessional
)paren
id|val
op_or_assign
(paren
id|aes-&gt;status
(braket
l_int|0
)braket
op_amp
id|IEC958_AES0_PRO_EMPHASIS_5015
)paren
ques
c_cond
id|HDSP_SPDIFEmphasis
suffix:colon
l_int|0
suffix:semicolon
r_else
id|val
op_or_assign
(paren
id|aes-&gt;status
(braket
l_int|0
)braket
op_amp
id|IEC958_AES0_CON_EMPHASIS_5015
)paren
ques
c_cond
id|HDSP_SPDIFEmphasis
suffix:colon
l_int|0
suffix:semicolon
r_return
id|val
suffix:semicolon
)brace
DECL|function|snd_hdsp_convert_to_aes
r_static
r_void
id|snd_hdsp_convert_to_aes
c_func
(paren
id|snd_aes_iec958_t
op_star
id|aes
comma
id|u32
id|val
)paren
(brace
id|aes-&gt;status
(braket
l_int|0
)braket
op_assign
(paren
(paren
id|val
op_amp
id|HDSP_SPDIFProfessional
)paren
ques
c_cond
id|IEC958_AES0_PROFESSIONAL
suffix:colon
l_int|0
)paren
op_or
(paren
(paren
id|val
op_amp
id|HDSP_SPDIFNonAudio
)paren
ques
c_cond
id|IEC958_AES0_NONAUDIO
suffix:colon
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|val
op_amp
id|HDSP_SPDIFProfessional
)paren
id|aes-&gt;status
(braket
l_int|0
)braket
op_or_assign
(paren
id|val
op_amp
id|HDSP_SPDIFEmphasis
)paren
ques
c_cond
id|IEC958_AES0_PRO_EMPHASIS_5015
suffix:colon
l_int|0
suffix:semicolon
r_else
id|aes-&gt;status
(braket
l_int|0
)braket
op_or_assign
(paren
id|val
op_amp
id|HDSP_SPDIFEmphasis
)paren
ques
c_cond
id|IEC958_AES0_CON_EMPHASIS_5015
suffix:colon
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_control_spdif_info
r_static
r_int
id|snd_hdsp_control_spdif_info
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_IEC958
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_control_spdif_get
r_static
r_int
id|snd_hdsp_control_spdif_get
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|snd_hdsp_convert_to_aes
c_func
(paren
op_amp
id|ucontrol-&gt;value.iec958
comma
id|hdsp-&gt;creg_spdif
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_control_spdif_put
r_static
r_int
id|snd_hdsp_control_spdif_put
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|change
suffix:semicolon
id|u32
id|val
suffix:semicolon
id|val
op_assign
id|snd_hdsp_convert_from_aes
c_func
(paren
op_amp
id|ucontrol-&gt;value.iec958
)paren
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
id|change
op_assign
id|val
op_ne
id|hdsp-&gt;creg_spdif
suffix:semicolon
id|hdsp-&gt;creg_spdif
op_assign
id|val
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
r_return
id|change
suffix:semicolon
)brace
DECL|function|snd_hdsp_control_spdif_stream_info
r_static
r_int
id|snd_hdsp_control_spdif_stream_info
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_IEC958
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_control_spdif_stream_get
r_static
r_int
id|snd_hdsp_control_spdif_stream_get
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|snd_hdsp_convert_to_aes
c_func
(paren
op_amp
id|ucontrol-&gt;value.iec958
comma
id|hdsp-&gt;creg_spdif_stream
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_control_spdif_stream_put
r_static
r_int
id|snd_hdsp_control_spdif_stream_put
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|change
suffix:semicolon
id|u32
id|val
suffix:semicolon
id|val
op_assign
id|snd_hdsp_convert_from_aes
c_func
(paren
op_amp
id|ucontrol-&gt;value.iec958
)paren
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
id|change
op_assign
id|val
op_ne
id|hdsp-&gt;creg_spdif_stream
suffix:semicolon
id|hdsp-&gt;creg_spdif_stream
op_assign
id|val
suffix:semicolon
id|hdsp-&gt;control_register
op_and_assign
op_complement
(paren
id|HDSP_SPDIFProfessional
op_or
id|HDSP_SPDIFNonAudio
op_or
id|HDSP_SPDIFEmphasis
)paren
suffix:semicolon
id|hdsp_write
c_func
(paren
id|hdsp
comma
id|HDSP_controlRegister
comma
id|hdsp-&gt;control_register
op_or_assign
id|val
)paren
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
r_return
id|change
suffix:semicolon
)brace
DECL|function|snd_hdsp_control_spdif_mask_info
r_static
r_int
id|snd_hdsp_control_spdif_mask_info
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_IEC958
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_control_spdif_mask_get
r_static
r_int
id|snd_hdsp_control_spdif_mask_get
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|ucontrol-&gt;value.iec958.status
(braket
l_int|0
)braket
op_assign
id|kcontrol-&gt;private_value
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|macro|HDSP_SPDIF_IN
mdefine_line|#define HDSP_SPDIF_IN(xname, xindex) &bslash;&n;{ .iface = SNDRV_CTL_ELEM_IFACE_PCM,  &bslash;&n;  .name = xname, &bslash;&n;  .index = xindex, &bslash;&n;  .info = snd_hdsp_info_spdif_in, &bslash;&n;  .get = snd_hdsp_get_spdif_in, &bslash;&n;  .put = snd_hdsp_put_spdif_in }
DECL|function|hdsp_spdif_in
r_static
r_int
r_int
id|hdsp_spdif_in
c_func
(paren
id|hdsp_t
op_star
id|hdsp
)paren
(brace
r_return
id|hdsp_decode_spdif_in
c_func
(paren
id|hdsp-&gt;control_register
op_amp
id|HDSP_SPDIFInputMask
)paren
suffix:semicolon
)brace
DECL|function|hdsp_set_spdif_input
r_static
r_int
id|hdsp_set_spdif_input
c_func
(paren
id|hdsp_t
op_star
id|hdsp
comma
r_int
id|in
)paren
(brace
id|hdsp-&gt;control_register
op_and_assign
op_complement
id|HDSP_SPDIFInputMask
suffix:semicolon
id|hdsp-&gt;control_register
op_or_assign
id|hdsp_encode_spdif_in
c_func
(paren
id|in
)paren
suffix:semicolon
id|hdsp_write
c_func
(paren
id|hdsp
comma
id|HDSP_controlRegister
comma
id|hdsp-&gt;control_register
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_info_spdif_in
r_static
r_int
id|snd_hdsp_info_spdif_in
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
r_static
r_char
op_star
id|texts
(braket
l_int|4
)braket
op_assign
(brace
l_string|&quot;Optical&quot;
comma
l_string|&quot;Coaxial&quot;
comma
l_string|&quot;Internal&quot;
comma
l_string|&quot;AES&quot;
)brace
suffix:semicolon
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_ENUMERATED
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
id|uinfo-&gt;value.enumerated.items
op_assign
(paren
(paren
id|hdsp-&gt;io_type
op_eq
id|H9632
)paren
ques
c_cond
l_int|4
suffix:colon
l_int|3
)paren
suffix:semicolon
r_if
c_cond
(paren
id|uinfo-&gt;value.enumerated.item
OG
(paren
(paren
id|hdsp-&gt;io_type
op_eq
id|H9632
)paren
ques
c_cond
l_int|3
suffix:colon
l_int|2
)paren
)paren
id|uinfo-&gt;value.enumerated.item
op_assign
(paren
(paren
id|hdsp-&gt;io_type
op_eq
id|H9632
)paren
ques
c_cond
l_int|3
suffix:colon
l_int|2
)paren
suffix:semicolon
id|strcpy
c_func
(paren
id|uinfo-&gt;value.enumerated.name
comma
id|texts
(braket
id|uinfo-&gt;value.enumerated.item
)braket
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_get_spdif_in
r_static
r_int
id|snd_hdsp_get_spdif_in
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
id|hdsp_spdif_in
c_func
(paren
id|hdsp
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_put_spdif_in
r_static
r_int
id|snd_hdsp_put_spdif_in
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|change
suffix:semicolon
r_int
r_int
id|val
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snd_hdsp_use_is_exclusive
c_func
(paren
id|hdsp
)paren
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
id|val
op_assign
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_mod
(paren
(paren
id|hdsp-&gt;io_type
op_eq
id|H9632
)paren
ques
c_cond
l_int|4
suffix:colon
l_int|3
)paren
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
id|change
op_assign
id|val
op_ne
id|hdsp_spdif_in
c_func
(paren
id|hdsp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|change
)paren
id|hdsp_set_spdif_input
c_func
(paren
id|hdsp
comma
id|val
)paren
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
r_return
id|change
suffix:semicolon
)brace
DECL|macro|HDSP_SPDIF_OUT
mdefine_line|#define HDSP_SPDIF_OUT(xname, xindex) &bslash;&n;{ .iface = SNDRV_CTL_ELEM_IFACE_HWDEP, .name = xname, .index = xindex, &bslash;&n;  .info = snd_hdsp_info_spdif_bits, &bslash;&n;  .get = snd_hdsp_get_spdif_out, .put = snd_hdsp_put_spdif_out }
DECL|function|hdsp_spdif_out
r_static
r_int
id|hdsp_spdif_out
c_func
(paren
id|hdsp_t
op_star
id|hdsp
)paren
(brace
r_return
(paren
id|hdsp-&gt;control_register
op_amp
id|HDSP_SPDIFOpticalOut
)paren
ques
c_cond
l_int|1
suffix:colon
l_int|0
suffix:semicolon
)brace
DECL|function|hdsp_set_spdif_output
r_static
r_int
id|hdsp_set_spdif_output
c_func
(paren
id|hdsp_t
op_star
id|hdsp
comma
r_int
id|out
)paren
(brace
r_if
c_cond
(paren
id|out
)paren
(brace
id|hdsp-&gt;control_register
op_or_assign
id|HDSP_SPDIFOpticalOut
suffix:semicolon
)brace
r_else
(brace
id|hdsp-&gt;control_register
op_and_assign
op_complement
id|HDSP_SPDIFOpticalOut
suffix:semicolon
)brace
id|hdsp_write
c_func
(paren
id|hdsp
comma
id|HDSP_controlRegister
comma
id|hdsp-&gt;control_register
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_info_spdif_bits
r_static
r_int
id|snd_hdsp_info_spdif_bits
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_BOOLEAN
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
id|uinfo-&gt;value.integer.min
op_assign
l_int|0
suffix:semicolon
id|uinfo-&gt;value.integer.max
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_get_spdif_out
r_static
r_int
id|snd_hdsp_get_spdif_out
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
id|hdsp_spdif_out
c_func
(paren
id|hdsp
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_put_spdif_out
r_static
r_int
id|snd_hdsp_put_spdif_out
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|change
suffix:semicolon
r_int
r_int
id|val
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snd_hdsp_use_is_exclusive
c_func
(paren
id|hdsp
)paren
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
id|val
op_assign
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_amp
l_int|1
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
id|change
op_assign
(paren
r_int
)paren
id|val
op_ne
id|hdsp_spdif_out
c_func
(paren
id|hdsp
)paren
suffix:semicolon
id|hdsp_set_spdif_output
c_func
(paren
id|hdsp
comma
id|val
)paren
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
r_return
id|change
suffix:semicolon
)brace
DECL|macro|HDSP_SPDIF_PROFESSIONAL
mdefine_line|#define HDSP_SPDIF_PROFESSIONAL(xname, xindex) &bslash;&n;{ .iface = SNDRV_CTL_ELEM_IFACE_HWDEP, .name = xname, .index = xindex, &bslash;&n;  .info = snd_hdsp_info_spdif_bits, &bslash;&n;  .get = snd_hdsp_get_spdif_professional, .put = snd_hdsp_put_spdif_professional }
DECL|function|hdsp_spdif_professional
r_static
r_int
id|hdsp_spdif_professional
c_func
(paren
id|hdsp_t
op_star
id|hdsp
)paren
(brace
r_return
(paren
id|hdsp-&gt;control_register
op_amp
id|HDSP_SPDIFProfessional
)paren
ques
c_cond
l_int|1
suffix:colon
l_int|0
suffix:semicolon
)brace
DECL|function|hdsp_set_spdif_professional
r_static
r_int
id|hdsp_set_spdif_professional
c_func
(paren
id|hdsp_t
op_star
id|hdsp
comma
r_int
id|val
)paren
(brace
r_if
c_cond
(paren
id|val
)paren
(brace
id|hdsp-&gt;control_register
op_or_assign
id|HDSP_SPDIFProfessional
suffix:semicolon
)brace
r_else
(brace
id|hdsp-&gt;control_register
op_and_assign
op_complement
id|HDSP_SPDIFProfessional
suffix:semicolon
)brace
id|hdsp_write
c_func
(paren
id|hdsp
comma
id|HDSP_controlRegister
comma
id|hdsp-&gt;control_register
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_get_spdif_professional
r_static
r_int
id|snd_hdsp_get_spdif_professional
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
id|hdsp_spdif_professional
c_func
(paren
id|hdsp
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_put_spdif_professional
r_static
r_int
id|snd_hdsp_put_spdif_professional
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|change
suffix:semicolon
r_int
r_int
id|val
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snd_hdsp_use_is_exclusive
c_func
(paren
id|hdsp
)paren
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
id|val
op_assign
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_amp
l_int|1
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
id|change
op_assign
(paren
r_int
)paren
id|val
op_ne
id|hdsp_spdif_professional
c_func
(paren
id|hdsp
)paren
suffix:semicolon
id|hdsp_set_spdif_professional
c_func
(paren
id|hdsp
comma
id|val
)paren
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
r_return
id|change
suffix:semicolon
)brace
DECL|macro|HDSP_SPDIF_EMPHASIS
mdefine_line|#define HDSP_SPDIF_EMPHASIS(xname, xindex) &bslash;&n;{ .iface = SNDRV_CTL_ELEM_IFACE_HWDEP, .name = xname, .index = xindex, &bslash;&n;  .info = snd_hdsp_info_spdif_bits, &bslash;&n;  .get = snd_hdsp_get_spdif_emphasis, .put = snd_hdsp_put_spdif_emphasis }
DECL|function|hdsp_spdif_emphasis
r_static
r_int
id|hdsp_spdif_emphasis
c_func
(paren
id|hdsp_t
op_star
id|hdsp
)paren
(brace
r_return
(paren
id|hdsp-&gt;control_register
op_amp
id|HDSP_SPDIFEmphasis
)paren
ques
c_cond
l_int|1
suffix:colon
l_int|0
suffix:semicolon
)brace
DECL|function|hdsp_set_spdif_emphasis
r_static
r_int
id|hdsp_set_spdif_emphasis
c_func
(paren
id|hdsp_t
op_star
id|hdsp
comma
r_int
id|val
)paren
(brace
r_if
c_cond
(paren
id|val
)paren
(brace
id|hdsp-&gt;control_register
op_or_assign
id|HDSP_SPDIFEmphasis
suffix:semicolon
)brace
r_else
(brace
id|hdsp-&gt;control_register
op_and_assign
op_complement
id|HDSP_SPDIFEmphasis
suffix:semicolon
)brace
id|hdsp_write
c_func
(paren
id|hdsp
comma
id|HDSP_controlRegister
comma
id|hdsp-&gt;control_register
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_get_spdif_emphasis
r_static
r_int
id|snd_hdsp_get_spdif_emphasis
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
id|hdsp_spdif_emphasis
c_func
(paren
id|hdsp
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_put_spdif_emphasis
r_static
r_int
id|snd_hdsp_put_spdif_emphasis
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|change
suffix:semicolon
r_int
r_int
id|val
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snd_hdsp_use_is_exclusive
c_func
(paren
id|hdsp
)paren
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
id|val
op_assign
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_amp
l_int|1
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
id|change
op_assign
(paren
r_int
)paren
id|val
op_ne
id|hdsp_spdif_emphasis
c_func
(paren
id|hdsp
)paren
suffix:semicolon
id|hdsp_set_spdif_emphasis
c_func
(paren
id|hdsp
comma
id|val
)paren
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
r_return
id|change
suffix:semicolon
)brace
DECL|macro|HDSP_SPDIF_NON_AUDIO
mdefine_line|#define HDSP_SPDIF_NON_AUDIO(xname, xindex) &bslash;&n;{ .iface = SNDRV_CTL_ELEM_IFACE_HWDEP, .name = xname, .index = xindex, &bslash;&n;  .info = snd_hdsp_info_spdif_bits, &bslash;&n;  .get = snd_hdsp_get_spdif_nonaudio, .put = snd_hdsp_put_spdif_nonaudio }
DECL|function|hdsp_spdif_nonaudio
r_static
r_int
id|hdsp_spdif_nonaudio
c_func
(paren
id|hdsp_t
op_star
id|hdsp
)paren
(brace
r_return
(paren
id|hdsp-&gt;control_register
op_amp
id|HDSP_SPDIFNonAudio
)paren
ques
c_cond
l_int|1
suffix:colon
l_int|0
suffix:semicolon
)brace
DECL|function|hdsp_set_spdif_nonaudio
r_static
r_int
id|hdsp_set_spdif_nonaudio
c_func
(paren
id|hdsp_t
op_star
id|hdsp
comma
r_int
id|val
)paren
(brace
r_if
c_cond
(paren
id|val
)paren
(brace
id|hdsp-&gt;control_register
op_or_assign
id|HDSP_SPDIFNonAudio
suffix:semicolon
)brace
r_else
(brace
id|hdsp-&gt;control_register
op_and_assign
op_complement
id|HDSP_SPDIFNonAudio
suffix:semicolon
)brace
id|hdsp_write
c_func
(paren
id|hdsp
comma
id|HDSP_controlRegister
comma
id|hdsp-&gt;control_register
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_get_spdif_nonaudio
r_static
r_int
id|snd_hdsp_get_spdif_nonaudio
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
id|hdsp_spdif_nonaudio
c_func
(paren
id|hdsp
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_put_spdif_nonaudio
r_static
r_int
id|snd_hdsp_put_spdif_nonaudio
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|change
suffix:semicolon
r_int
r_int
id|val
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snd_hdsp_use_is_exclusive
c_func
(paren
id|hdsp
)paren
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
id|val
op_assign
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_amp
l_int|1
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
id|change
op_assign
(paren
r_int
)paren
id|val
op_ne
id|hdsp_spdif_nonaudio
c_func
(paren
id|hdsp
)paren
suffix:semicolon
id|hdsp_set_spdif_nonaudio
c_func
(paren
id|hdsp
comma
id|val
)paren
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
r_return
id|change
suffix:semicolon
)brace
DECL|macro|HDSP_SPDIF_SAMPLE_RATE
mdefine_line|#define HDSP_SPDIF_SAMPLE_RATE(xname, xindex) &bslash;&n;{ .iface = SNDRV_CTL_ELEM_IFACE_HWDEP, &bslash;&n;  .name = xname, &bslash;&n;  .index = xindex, &bslash;&n;  .access = SNDRV_CTL_ELEM_ACCESS_READ, &bslash;&n;  .info = snd_hdsp_info_spdif_sample_rate, &bslash;&n;  .get = snd_hdsp_get_spdif_sample_rate &bslash;&n;}
DECL|function|snd_hdsp_info_spdif_sample_rate
r_static
r_int
id|snd_hdsp_info_spdif_sample_rate
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
r_static
r_char
op_star
id|texts
(braket
)braket
op_assign
(brace
l_string|&quot;32000&quot;
comma
l_string|&quot;44100&quot;
comma
l_string|&quot;48000&quot;
comma
l_string|&quot;64000&quot;
comma
l_string|&quot;88200&quot;
comma
l_string|&quot;96000&quot;
comma
l_string|&quot;None&quot;
comma
l_string|&quot;128000&quot;
comma
l_string|&quot;176400&quot;
comma
l_string|&quot;192000&quot;
)brace
suffix:semicolon
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_ENUMERATED
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
id|uinfo-&gt;value.enumerated.items
op_assign
(paren
id|hdsp-&gt;io_type
op_eq
id|H9632
)paren
ques
c_cond
l_int|10
suffix:colon
l_int|7
suffix:semicolon
r_if
c_cond
(paren
id|uinfo-&gt;value.enumerated.item
op_ge
id|uinfo-&gt;value.enumerated.items
)paren
id|uinfo-&gt;value.enumerated.item
op_assign
id|uinfo-&gt;value.enumerated.items
op_minus
l_int|1
suffix:semicolon
id|strcpy
c_func
(paren
id|uinfo-&gt;value.enumerated.name
comma
id|texts
(braket
id|uinfo-&gt;value.enumerated.item
)braket
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_get_spdif_sample_rate
r_static
r_int
id|snd_hdsp_get_spdif_sample_rate
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|hdsp_spdif_sample_rate
c_func
(paren
id|hdsp
)paren
)paren
(brace
r_case
l_int|32000
suffix:colon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|44100
suffix:colon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|48000
suffix:colon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
l_int|2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|64000
suffix:colon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
l_int|3
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|88200
suffix:colon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
l_int|4
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|96000
suffix:colon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
l_int|5
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|128000
suffix:colon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
l_int|7
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|176400
suffix:colon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
l_int|8
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|192000
suffix:colon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
l_int|9
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
l_int|6
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|macro|HDSP_SYSTEM_SAMPLE_RATE
mdefine_line|#define HDSP_SYSTEM_SAMPLE_RATE(xname, xindex) &bslash;&n;{ .iface = SNDRV_CTL_ELEM_IFACE_HWDEP, &bslash;&n;  .name = xname, &bslash;&n;  .index = xindex, &bslash;&n;  .access = SNDRV_CTL_ELEM_ACCESS_READ, &bslash;&n;  .info = snd_hdsp_info_system_sample_rate, &bslash;&n;  .get = snd_hdsp_get_system_sample_rate &bslash;&n;}
DECL|function|snd_hdsp_info_system_sample_rate
r_static
r_int
id|snd_hdsp_info_system_sample_rate
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_INTEGER
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_get_system_sample_rate
r_static
r_int
id|snd_hdsp_get_system_sample_rate
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
id|hdsp-&gt;system_sample_rate
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|macro|HDSP_AUTOSYNC_SAMPLE_RATE
mdefine_line|#define HDSP_AUTOSYNC_SAMPLE_RATE(xname, xindex) &bslash;&n;{ .iface = SNDRV_CTL_ELEM_IFACE_PCM, &bslash;&n;  .name = xname, &bslash;&n;  .index = xindex, &bslash;&n;  .access = SNDRV_CTL_ELEM_ACCESS_READ, &bslash;&n;  .info = snd_hdsp_info_autosync_sample_rate, &bslash;&n;  .get = snd_hdsp_get_autosync_sample_rate &bslash;&n;}
DECL|function|snd_hdsp_info_autosync_sample_rate
r_static
r_int
id|snd_hdsp_info_autosync_sample_rate
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_static
r_char
op_star
id|texts
(braket
)braket
op_assign
(brace
l_string|&quot;32000&quot;
comma
l_string|&quot;44100&quot;
comma
l_string|&quot;48000&quot;
comma
l_string|&quot;64000&quot;
comma
l_string|&quot;88200&quot;
comma
l_string|&quot;96000&quot;
comma
l_string|&quot;None&quot;
comma
l_string|&quot;128000&quot;
comma
l_string|&quot;176400&quot;
comma
l_string|&quot;192000&quot;
)brace
suffix:semicolon
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_ENUMERATED
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
id|uinfo-&gt;value.enumerated.items
op_assign
(paren
id|hdsp-&gt;io_type
op_eq
id|H9632
)paren
ques
c_cond
l_int|10
suffix:colon
l_int|7
suffix:semicolon
r_if
c_cond
(paren
id|uinfo-&gt;value.enumerated.item
op_ge
id|uinfo-&gt;value.enumerated.items
)paren
id|uinfo-&gt;value.enumerated.item
op_assign
id|uinfo-&gt;value.enumerated.items
op_minus
l_int|1
suffix:semicolon
id|strcpy
c_func
(paren
id|uinfo-&gt;value.enumerated.name
comma
id|texts
(braket
id|uinfo-&gt;value.enumerated.item
)braket
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_get_autosync_sample_rate
r_static
r_int
id|snd_hdsp_get_autosync_sample_rate
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|hdsp_external_sample_rate
c_func
(paren
id|hdsp
)paren
)paren
(brace
r_case
l_int|32000
suffix:colon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|44100
suffix:colon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|48000
suffix:colon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
l_int|2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|64000
suffix:colon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
l_int|3
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|88200
suffix:colon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
l_int|4
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|96000
suffix:colon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
l_int|5
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|128000
suffix:colon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
l_int|7
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|176400
suffix:colon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
l_int|8
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|192000
suffix:colon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
l_int|9
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
l_int|6
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|macro|HDSP_SYSTEM_CLOCK_MODE
mdefine_line|#define HDSP_SYSTEM_CLOCK_MODE(xname, xindex) &bslash;&n;{ .iface = SNDRV_CTL_ELEM_IFACE_HWDEP, &bslash;&n;  .name = xname, &bslash;&n;  .index = xindex, &bslash;&n;  .access = SNDRV_CTL_ELEM_ACCESS_READ, &bslash;&n;  .info = snd_hdsp_info_system_clock_mode, &bslash;&n;  .get = snd_hdsp_get_system_clock_mode &bslash;&n;}
DECL|function|hdsp_system_clock_mode
r_static
r_int
id|hdsp_system_clock_mode
c_func
(paren
id|hdsp_t
op_star
id|hdsp
)paren
(brace
r_if
c_cond
(paren
id|hdsp-&gt;control_register
op_amp
id|HDSP_ClockModeMaster
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|hdsp_external_sample_rate
c_func
(paren
id|hdsp
)paren
op_ne
id|hdsp-&gt;system_sample_rate
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|snd_hdsp_info_system_clock_mode
r_static
r_int
id|snd_hdsp_info_system_clock_mode
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
r_static
r_char
op_star
id|texts
(braket
)braket
op_assign
(brace
l_string|&quot;Master&quot;
comma
l_string|&quot;Slave&quot;
)brace
suffix:semicolon
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_ENUMERATED
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
id|uinfo-&gt;value.enumerated.items
op_assign
l_int|2
suffix:semicolon
r_if
c_cond
(paren
id|uinfo-&gt;value.enumerated.item
op_ge
id|uinfo-&gt;value.enumerated.items
)paren
id|uinfo-&gt;value.enumerated.item
op_assign
id|uinfo-&gt;value.enumerated.items
op_minus
l_int|1
suffix:semicolon
id|strcpy
c_func
(paren
id|uinfo-&gt;value.enumerated.name
comma
id|texts
(braket
id|uinfo-&gt;value.enumerated.item
)braket
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_get_system_clock_mode
r_static
r_int
id|snd_hdsp_get_system_clock_mode
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
id|hdsp_system_clock_mode
c_func
(paren
id|hdsp
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|macro|HDSP_CLOCK_SOURCE
mdefine_line|#define HDSP_CLOCK_SOURCE(xname, xindex) &bslash;&n;{ .iface = SNDRV_CTL_ELEM_IFACE_PCM, &bslash;&n;  .name = xname, &bslash;&n;  .index = xindex, &bslash;&n;  .info = snd_hdsp_info_clock_source, &bslash;&n;  .get = snd_hdsp_get_clock_source, &bslash;&n;  .put = snd_hdsp_put_clock_source &bslash;&n;}
DECL|function|hdsp_clock_source
r_static
r_int
id|hdsp_clock_source
c_func
(paren
id|hdsp_t
op_star
id|hdsp
)paren
(brace
r_if
c_cond
(paren
id|hdsp-&gt;control_register
op_amp
id|HDSP_ClockModeMaster
)paren
(brace
r_switch
c_cond
(paren
id|hdsp-&gt;system_sample_rate
)paren
(brace
r_case
l_int|32000
suffix:colon
r_return
l_int|1
suffix:semicolon
r_case
l_int|44100
suffix:colon
r_return
l_int|2
suffix:semicolon
r_case
l_int|48000
suffix:colon
r_return
l_int|3
suffix:semicolon
r_case
l_int|64000
suffix:colon
r_return
l_int|4
suffix:semicolon
r_case
l_int|88200
suffix:colon
r_return
l_int|5
suffix:semicolon
r_case
l_int|96000
suffix:colon
r_return
l_int|6
suffix:semicolon
r_case
l_int|128000
suffix:colon
r_return
l_int|7
suffix:semicolon
r_case
l_int|176400
suffix:colon
r_return
l_int|8
suffix:semicolon
r_case
l_int|192000
suffix:colon
r_return
l_int|9
suffix:semicolon
r_default
suffix:colon
r_return
l_int|3
suffix:semicolon
)brace
)brace
r_else
(brace
r_return
l_int|0
suffix:semicolon
)brace
)brace
DECL|function|hdsp_set_clock_source
r_static
r_int
id|hdsp_set_clock_source
c_func
(paren
id|hdsp_t
op_star
id|hdsp
comma
r_int
id|mode
)paren
(brace
r_int
id|rate
suffix:semicolon
r_switch
c_cond
(paren
id|mode
)paren
(brace
r_case
id|HDSP_CLOCK_SOURCE_AUTOSYNC
suffix:colon
r_if
c_cond
(paren
id|hdsp_external_sample_rate
c_func
(paren
id|hdsp
)paren
op_ne
l_int|0
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|hdsp_set_rate
c_func
(paren
id|hdsp
comma
id|hdsp_external_sample_rate
c_func
(paren
id|hdsp
)paren
comma
l_int|1
)paren
)paren
(brace
id|hdsp-&gt;control_register
op_and_assign
op_complement
id|HDSP_ClockModeMaster
suffix:semicolon
id|hdsp_write
c_func
(paren
id|hdsp
comma
id|HDSP_controlRegister
comma
id|hdsp-&gt;control_register
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
)brace
r_return
op_minus
l_int|1
suffix:semicolon
r_case
id|HDSP_CLOCK_SOURCE_INTERNAL_32KHZ
suffix:colon
id|rate
op_assign
l_int|32000
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HDSP_CLOCK_SOURCE_INTERNAL_44_1KHZ
suffix:colon
id|rate
op_assign
l_int|44100
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HDSP_CLOCK_SOURCE_INTERNAL_48KHZ
suffix:colon
id|rate
op_assign
l_int|48000
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HDSP_CLOCK_SOURCE_INTERNAL_64KHZ
suffix:colon
id|rate
op_assign
l_int|64000
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HDSP_CLOCK_SOURCE_INTERNAL_88_2KHZ
suffix:colon
id|rate
op_assign
l_int|88200
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HDSP_CLOCK_SOURCE_INTERNAL_96KHZ
suffix:colon
id|rate
op_assign
l_int|96000
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HDSP_CLOCK_SOURCE_INTERNAL_128KHZ
suffix:colon
id|rate
op_assign
l_int|128000
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HDSP_CLOCK_SOURCE_INTERNAL_176_4KHZ
suffix:colon
id|rate
op_assign
l_int|176400
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HDSP_CLOCK_SOURCE_INTERNAL_192KHZ
suffix:colon
id|rate
op_assign
l_int|192000
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|rate
op_assign
l_int|48000
suffix:semicolon
)brace
id|hdsp-&gt;control_register
op_or_assign
id|HDSP_ClockModeMaster
suffix:semicolon
id|hdsp_write
c_func
(paren
id|hdsp
comma
id|HDSP_controlRegister
comma
id|hdsp-&gt;control_register
)paren
suffix:semicolon
id|hdsp_set_rate
c_func
(paren
id|hdsp
comma
id|rate
comma
l_int|1
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_info_clock_source
r_static
r_int
id|snd_hdsp_info_clock_source
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
r_static
r_char
op_star
id|texts
(braket
)braket
op_assign
(brace
l_string|&quot;AutoSync&quot;
comma
l_string|&quot;Internal 32.0 kHz&quot;
comma
l_string|&quot;Internal 44.1 kHz&quot;
comma
l_string|&quot;Internal 48.0 kHz&quot;
comma
l_string|&quot;Internal 64.0 kHz&quot;
comma
l_string|&quot;Internal 88.2 kHz&quot;
comma
l_string|&quot;Internal 96.0 kHz&quot;
comma
l_string|&quot;Internal 128 kHz&quot;
comma
l_string|&quot;Internal 176.4 kHz&quot;
comma
l_string|&quot;Internal 192.0 KHz&quot;
)brace
suffix:semicolon
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_ENUMERATED
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|hdsp-&gt;io_type
op_eq
id|H9632
)paren
id|uinfo-&gt;value.enumerated.items
op_assign
l_int|10
suffix:semicolon
r_else
id|uinfo-&gt;value.enumerated.items
op_assign
l_int|7
suffix:semicolon
r_if
c_cond
(paren
id|uinfo-&gt;value.enumerated.item
op_ge
id|uinfo-&gt;value.enumerated.items
)paren
id|uinfo-&gt;value.enumerated.item
op_assign
id|uinfo-&gt;value.enumerated.items
op_minus
l_int|1
suffix:semicolon
id|strcpy
c_func
(paren
id|uinfo-&gt;value.enumerated.name
comma
id|texts
(braket
id|uinfo-&gt;value.enumerated.item
)braket
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_get_clock_source
r_static
r_int
id|snd_hdsp_get_clock_source
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
id|hdsp_clock_source
c_func
(paren
id|hdsp
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_put_clock_source
r_static
r_int
id|snd_hdsp_put_clock_source
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|change
suffix:semicolon
r_int
id|val
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snd_hdsp_use_is_exclusive
c_func
(paren
id|hdsp
)paren
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
id|val
op_assign
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
suffix:semicolon
r_if
c_cond
(paren
id|val
OL
l_int|0
)paren
id|val
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|hdsp-&gt;io_type
op_eq
id|H9632
)paren
(brace
r_if
c_cond
(paren
id|val
OG
l_int|9
)paren
id|val
op_assign
l_int|9
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|val
OG
l_int|6
)paren
id|val
op_assign
l_int|6
suffix:semicolon
)brace
id|spin_lock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|val
op_ne
id|hdsp_clock_source
c_func
(paren
id|hdsp
)paren
)paren
(brace
id|change
op_assign
(paren
id|hdsp_set_clock_source
c_func
(paren
id|hdsp
comma
id|val
)paren
op_eq
l_int|0
)paren
ques
c_cond
l_int|1
suffix:colon
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|change
op_assign
l_int|0
suffix:semicolon
)brace
id|spin_unlock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
r_return
id|change
suffix:semicolon
)brace
DECL|macro|HDSP_DA_GAIN
mdefine_line|#define HDSP_DA_GAIN(xname, xindex) &bslash;&n;{ .iface = SNDRV_CTL_ELEM_IFACE_HWDEP, &bslash;&n;  .name = xname, &bslash;&n;  .index = xindex, &bslash;&n;  .info = snd_hdsp_info_da_gain, &bslash;&n;  .get = snd_hdsp_get_da_gain, &bslash;&n;  .put = snd_hdsp_put_da_gain &bslash;&n;}
DECL|function|hdsp_da_gain
r_static
r_int
id|hdsp_da_gain
c_func
(paren
id|hdsp_t
op_star
id|hdsp
)paren
(brace
r_switch
c_cond
(paren
id|hdsp-&gt;control_register
op_amp
id|HDSP_DAGainMask
)paren
(brace
r_case
id|HDSP_DAGainHighGain
suffix:colon
r_return
l_int|0
suffix:semicolon
r_case
id|HDSP_DAGainPlus4dBu
suffix:colon
r_return
l_int|1
suffix:semicolon
r_case
id|HDSP_DAGainMinus10dBV
suffix:colon
r_return
l_int|2
suffix:semicolon
r_default
suffix:colon
r_return
l_int|1
suffix:semicolon
)brace
)brace
DECL|function|hdsp_set_da_gain
r_static
r_int
id|hdsp_set_da_gain
c_func
(paren
id|hdsp_t
op_star
id|hdsp
comma
r_int
id|mode
)paren
(brace
id|hdsp-&gt;control_register
op_and_assign
op_complement
id|HDSP_DAGainMask
suffix:semicolon
r_switch
c_cond
(paren
id|mode
)paren
(brace
r_case
l_int|0
suffix:colon
id|hdsp-&gt;control_register
op_or_assign
id|HDSP_DAGainHighGain
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|hdsp-&gt;control_register
op_or_assign
id|HDSP_DAGainPlus4dBu
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|hdsp-&gt;control_register
op_or_assign
id|HDSP_DAGainMinus10dBV
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
id|hdsp_write
c_func
(paren
id|hdsp
comma
id|HDSP_controlRegister
comma
id|hdsp-&gt;control_register
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_info_da_gain
r_static
r_int
id|snd_hdsp_info_da_gain
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
r_static
r_char
op_star
id|texts
(braket
)braket
op_assign
(brace
l_string|&quot;Hi Gain&quot;
comma
l_string|&quot;+4 dBu&quot;
comma
l_string|&quot;-10 dbV&quot;
)brace
suffix:semicolon
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_ENUMERATED
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
id|uinfo-&gt;value.enumerated.items
op_assign
l_int|3
suffix:semicolon
r_if
c_cond
(paren
id|uinfo-&gt;value.enumerated.item
op_ge
id|uinfo-&gt;value.enumerated.items
)paren
id|uinfo-&gt;value.enumerated.item
op_assign
id|uinfo-&gt;value.enumerated.items
op_minus
l_int|1
suffix:semicolon
id|strcpy
c_func
(paren
id|uinfo-&gt;value.enumerated.name
comma
id|texts
(braket
id|uinfo-&gt;value.enumerated.item
)braket
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_get_da_gain
r_static
r_int
id|snd_hdsp_get_da_gain
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
id|hdsp_da_gain
c_func
(paren
id|hdsp
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_put_da_gain
r_static
r_int
id|snd_hdsp_put_da_gain
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|change
suffix:semicolon
r_int
id|val
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snd_hdsp_use_is_exclusive
c_func
(paren
id|hdsp
)paren
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
id|val
op_assign
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
suffix:semicolon
r_if
c_cond
(paren
id|val
OL
l_int|0
)paren
id|val
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|val
OG
l_int|2
)paren
id|val
op_assign
l_int|2
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|val
op_ne
id|hdsp_da_gain
c_func
(paren
id|hdsp
)paren
)paren
(brace
id|change
op_assign
(paren
id|hdsp_set_da_gain
c_func
(paren
id|hdsp
comma
id|val
)paren
op_eq
l_int|0
)paren
ques
c_cond
l_int|1
suffix:colon
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|change
op_assign
l_int|0
suffix:semicolon
)brace
id|spin_unlock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
r_return
id|change
suffix:semicolon
)brace
DECL|macro|HDSP_AD_GAIN
mdefine_line|#define HDSP_AD_GAIN(xname, xindex) &bslash;&n;{ .iface = SNDRV_CTL_ELEM_IFACE_HWDEP, &bslash;&n;  .name = xname, &bslash;&n;  .index = xindex, &bslash;&n;  .info = snd_hdsp_info_ad_gain, &bslash;&n;  .get = snd_hdsp_get_ad_gain, &bslash;&n;  .put = snd_hdsp_put_ad_gain &bslash;&n;}
DECL|function|hdsp_ad_gain
r_static
r_int
id|hdsp_ad_gain
c_func
(paren
id|hdsp_t
op_star
id|hdsp
)paren
(brace
r_switch
c_cond
(paren
id|hdsp-&gt;control_register
op_amp
id|HDSP_ADGainMask
)paren
(brace
r_case
id|HDSP_ADGainMinus10dBV
suffix:colon
r_return
l_int|0
suffix:semicolon
r_case
id|HDSP_ADGainPlus4dBu
suffix:colon
r_return
l_int|1
suffix:semicolon
r_case
id|HDSP_ADGainLowGain
suffix:colon
r_return
l_int|2
suffix:semicolon
r_default
suffix:colon
r_return
l_int|1
suffix:semicolon
)brace
)brace
DECL|function|hdsp_set_ad_gain
r_static
r_int
id|hdsp_set_ad_gain
c_func
(paren
id|hdsp_t
op_star
id|hdsp
comma
r_int
id|mode
)paren
(brace
id|hdsp-&gt;control_register
op_and_assign
op_complement
id|HDSP_ADGainMask
suffix:semicolon
r_switch
c_cond
(paren
id|mode
)paren
(brace
r_case
l_int|0
suffix:colon
id|hdsp-&gt;control_register
op_or_assign
id|HDSP_ADGainMinus10dBV
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|hdsp-&gt;control_register
op_or_assign
id|HDSP_ADGainPlus4dBu
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|hdsp-&gt;control_register
op_or_assign
id|HDSP_ADGainLowGain
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
id|hdsp_write
c_func
(paren
id|hdsp
comma
id|HDSP_controlRegister
comma
id|hdsp-&gt;control_register
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_info_ad_gain
r_static
r_int
id|snd_hdsp_info_ad_gain
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
r_static
r_char
op_star
id|texts
(braket
)braket
op_assign
(brace
l_string|&quot;-10 dBV&quot;
comma
l_string|&quot;+4 dBu&quot;
comma
l_string|&quot;Lo Gain&quot;
)brace
suffix:semicolon
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_ENUMERATED
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
id|uinfo-&gt;value.enumerated.items
op_assign
l_int|3
suffix:semicolon
r_if
c_cond
(paren
id|uinfo-&gt;value.enumerated.item
op_ge
id|uinfo-&gt;value.enumerated.items
)paren
id|uinfo-&gt;value.enumerated.item
op_assign
id|uinfo-&gt;value.enumerated.items
op_minus
l_int|1
suffix:semicolon
id|strcpy
c_func
(paren
id|uinfo-&gt;value.enumerated.name
comma
id|texts
(braket
id|uinfo-&gt;value.enumerated.item
)braket
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_get_ad_gain
r_static
r_int
id|snd_hdsp_get_ad_gain
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
id|hdsp_ad_gain
c_func
(paren
id|hdsp
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_put_ad_gain
r_static
r_int
id|snd_hdsp_put_ad_gain
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|change
suffix:semicolon
r_int
id|val
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snd_hdsp_use_is_exclusive
c_func
(paren
id|hdsp
)paren
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
id|val
op_assign
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
suffix:semicolon
r_if
c_cond
(paren
id|val
OL
l_int|0
)paren
id|val
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|val
OG
l_int|2
)paren
id|val
op_assign
l_int|2
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|val
op_ne
id|hdsp_ad_gain
c_func
(paren
id|hdsp
)paren
)paren
(brace
id|change
op_assign
(paren
id|hdsp_set_ad_gain
c_func
(paren
id|hdsp
comma
id|val
)paren
op_eq
l_int|0
)paren
ques
c_cond
l_int|1
suffix:colon
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|change
op_assign
l_int|0
suffix:semicolon
)brace
id|spin_unlock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
r_return
id|change
suffix:semicolon
)brace
DECL|macro|HDSP_PHONE_GAIN
mdefine_line|#define HDSP_PHONE_GAIN(xname, xindex) &bslash;&n;{ .iface = SNDRV_CTL_ELEM_IFACE_HWDEP, &bslash;&n;  .name = xname, &bslash;&n;  .index = xindex, &bslash;&n;  .info = snd_hdsp_info_phone_gain, &bslash;&n;  .get = snd_hdsp_get_phone_gain, &bslash;&n;  .put = snd_hdsp_put_phone_gain &bslash;&n;}
DECL|function|hdsp_phone_gain
r_static
r_int
id|hdsp_phone_gain
c_func
(paren
id|hdsp_t
op_star
id|hdsp
)paren
(brace
r_switch
c_cond
(paren
id|hdsp-&gt;control_register
op_amp
id|HDSP_PhoneGainMask
)paren
(brace
r_case
id|HDSP_PhoneGain0dB
suffix:colon
r_return
l_int|0
suffix:semicolon
r_case
id|HDSP_PhoneGainMinus6dB
suffix:colon
r_return
l_int|1
suffix:semicolon
r_case
id|HDSP_PhoneGainMinus12dB
suffix:colon
r_return
l_int|2
suffix:semicolon
r_default
suffix:colon
r_return
l_int|0
suffix:semicolon
)brace
)brace
DECL|function|hdsp_set_phone_gain
r_static
r_int
id|hdsp_set_phone_gain
c_func
(paren
id|hdsp_t
op_star
id|hdsp
comma
r_int
id|mode
)paren
(brace
id|hdsp-&gt;control_register
op_and_assign
op_complement
id|HDSP_PhoneGainMask
suffix:semicolon
r_switch
c_cond
(paren
id|mode
)paren
(brace
r_case
l_int|0
suffix:colon
id|hdsp-&gt;control_register
op_or_assign
id|HDSP_PhoneGain0dB
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|hdsp-&gt;control_register
op_or_assign
id|HDSP_PhoneGainMinus6dB
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|hdsp-&gt;control_register
op_or_assign
id|HDSP_PhoneGainMinus12dB
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
id|hdsp_write
c_func
(paren
id|hdsp
comma
id|HDSP_controlRegister
comma
id|hdsp-&gt;control_register
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_info_phone_gain
r_static
r_int
id|snd_hdsp_info_phone_gain
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
r_static
r_char
op_star
id|texts
(braket
)braket
op_assign
(brace
l_string|&quot;0 dB&quot;
comma
l_string|&quot;-6 dB&quot;
comma
l_string|&quot;-12 dB&quot;
)brace
suffix:semicolon
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_ENUMERATED
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
id|uinfo-&gt;value.enumerated.items
op_assign
l_int|3
suffix:semicolon
r_if
c_cond
(paren
id|uinfo-&gt;value.enumerated.item
op_ge
id|uinfo-&gt;value.enumerated.items
)paren
id|uinfo-&gt;value.enumerated.item
op_assign
id|uinfo-&gt;value.enumerated.items
op_minus
l_int|1
suffix:semicolon
id|strcpy
c_func
(paren
id|uinfo-&gt;value.enumerated.name
comma
id|texts
(braket
id|uinfo-&gt;value.enumerated.item
)braket
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_get_phone_gain
r_static
r_int
id|snd_hdsp_get_phone_gain
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
id|hdsp_phone_gain
c_func
(paren
id|hdsp
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_put_phone_gain
r_static
r_int
id|snd_hdsp_put_phone_gain
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|change
suffix:semicolon
r_int
id|val
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snd_hdsp_use_is_exclusive
c_func
(paren
id|hdsp
)paren
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
id|val
op_assign
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
suffix:semicolon
r_if
c_cond
(paren
id|val
OL
l_int|0
)paren
id|val
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|val
OG
l_int|2
)paren
id|val
op_assign
l_int|2
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|val
op_ne
id|hdsp_phone_gain
c_func
(paren
id|hdsp
)paren
)paren
(brace
id|change
op_assign
(paren
id|hdsp_set_phone_gain
c_func
(paren
id|hdsp
comma
id|val
)paren
op_eq
l_int|0
)paren
ques
c_cond
l_int|1
suffix:colon
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|change
op_assign
l_int|0
suffix:semicolon
)brace
id|spin_unlock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
r_return
id|change
suffix:semicolon
)brace
DECL|macro|HDSP_XLR_BREAKOUT_CABLE
mdefine_line|#define HDSP_XLR_BREAKOUT_CABLE(xname, xindex) &bslash;&n;{ .iface = SNDRV_CTL_ELEM_IFACE_HWDEP, &bslash;&n;  .name = xname, &bslash;&n;  .index = xindex, &bslash;&n;  .info = snd_hdsp_info_xlr_breakout_cable, &bslash;&n;  .get = snd_hdsp_get_xlr_breakout_cable, &bslash;&n;  .put = snd_hdsp_put_xlr_breakout_cable &bslash;&n;}
DECL|function|hdsp_xlr_breakout_cable
r_static
r_int
id|hdsp_xlr_breakout_cable
c_func
(paren
id|hdsp_t
op_star
id|hdsp
)paren
(brace
r_if
c_cond
(paren
id|hdsp-&gt;control_register
op_amp
id|HDSP_XLRBreakoutCable
)paren
(brace
r_return
l_int|1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|hdsp_set_xlr_breakout_cable
r_static
r_int
id|hdsp_set_xlr_breakout_cable
c_func
(paren
id|hdsp_t
op_star
id|hdsp
comma
r_int
id|mode
)paren
(brace
r_if
c_cond
(paren
id|mode
)paren
(brace
id|hdsp-&gt;control_register
op_or_assign
id|HDSP_XLRBreakoutCable
suffix:semicolon
)brace
r_else
(brace
id|hdsp-&gt;control_register
op_and_assign
op_complement
id|HDSP_XLRBreakoutCable
suffix:semicolon
)brace
id|hdsp_write
c_func
(paren
id|hdsp
comma
id|HDSP_controlRegister
comma
id|hdsp-&gt;control_register
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_info_xlr_breakout_cable
r_static
r_int
id|snd_hdsp_info_xlr_breakout_cable
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_BOOLEAN
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
id|uinfo-&gt;value.integer.min
op_assign
l_int|0
suffix:semicolon
id|uinfo-&gt;value.integer.max
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_get_xlr_breakout_cable
r_static
r_int
id|snd_hdsp_get_xlr_breakout_cable
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
id|hdsp_xlr_breakout_cable
c_func
(paren
id|hdsp
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_put_xlr_breakout_cable
r_static
r_int
id|snd_hdsp_put_xlr_breakout_cable
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|change
suffix:semicolon
r_int
id|val
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snd_hdsp_use_is_exclusive
c_func
(paren
id|hdsp
)paren
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
id|val
op_assign
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_amp
l_int|1
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
id|change
op_assign
(paren
r_int
)paren
id|val
op_ne
id|hdsp_xlr_breakout_cable
c_func
(paren
id|hdsp
)paren
suffix:semicolon
id|hdsp_set_xlr_breakout_cable
c_func
(paren
id|hdsp
comma
id|val
)paren
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
r_return
id|change
suffix:semicolon
)brace
multiline_comment|/* (De)activates old RME Analog Extension Board&n;   These are connected to the internal ADAT connector&n;   Switching this on desactivates external ADAT&n;*/
DECL|macro|HDSP_AEB
mdefine_line|#define HDSP_AEB(xname, xindex) &bslash;&n;{ .iface = SNDRV_CTL_ELEM_IFACE_HWDEP, &bslash;&n;  .name = xname, &bslash;&n;  .index = xindex, &bslash;&n;  .info = snd_hdsp_info_aeb, &bslash;&n;  .get = snd_hdsp_get_aeb, &bslash;&n;  .put = snd_hdsp_put_aeb &bslash;&n;}
DECL|function|hdsp_aeb
r_static
r_int
id|hdsp_aeb
c_func
(paren
id|hdsp_t
op_star
id|hdsp
)paren
(brace
r_if
c_cond
(paren
id|hdsp-&gt;control_register
op_amp
id|HDSP_AnalogExtensionBoard
)paren
(brace
r_return
l_int|1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|hdsp_set_aeb
r_static
r_int
id|hdsp_set_aeb
c_func
(paren
id|hdsp_t
op_star
id|hdsp
comma
r_int
id|mode
)paren
(brace
r_if
c_cond
(paren
id|mode
)paren
(brace
id|hdsp-&gt;control_register
op_or_assign
id|HDSP_AnalogExtensionBoard
suffix:semicolon
)brace
r_else
(brace
id|hdsp-&gt;control_register
op_and_assign
op_complement
id|HDSP_AnalogExtensionBoard
suffix:semicolon
)brace
id|hdsp_write
c_func
(paren
id|hdsp
comma
id|HDSP_controlRegister
comma
id|hdsp-&gt;control_register
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_info_aeb
r_static
r_int
id|snd_hdsp_info_aeb
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_BOOLEAN
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
id|uinfo-&gt;value.integer.min
op_assign
l_int|0
suffix:semicolon
id|uinfo-&gt;value.integer.max
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_get_aeb
r_static
r_int
id|snd_hdsp_get_aeb
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
id|hdsp_aeb
c_func
(paren
id|hdsp
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_put_aeb
r_static
r_int
id|snd_hdsp_put_aeb
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|change
suffix:semicolon
r_int
id|val
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snd_hdsp_use_is_exclusive
c_func
(paren
id|hdsp
)paren
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
id|val
op_assign
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_amp
l_int|1
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
id|change
op_assign
(paren
r_int
)paren
id|val
op_ne
id|hdsp_aeb
c_func
(paren
id|hdsp
)paren
suffix:semicolon
id|hdsp_set_aeb
c_func
(paren
id|hdsp
comma
id|val
)paren
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
r_return
id|change
suffix:semicolon
)brace
DECL|macro|HDSP_PREF_SYNC_REF
mdefine_line|#define HDSP_PREF_SYNC_REF(xname, xindex) &bslash;&n;{ .iface = SNDRV_CTL_ELEM_IFACE_HWDEP, &bslash;&n;  .name = xname, &bslash;&n;  .index = xindex, &bslash;&n;  .info = snd_hdsp_info_pref_sync_ref, &bslash;&n;  .get = snd_hdsp_get_pref_sync_ref, &bslash;&n;  .put = snd_hdsp_put_pref_sync_ref &bslash;&n;}
DECL|function|hdsp_pref_sync_ref
r_static
r_int
id|hdsp_pref_sync_ref
c_func
(paren
id|hdsp_t
op_star
id|hdsp
)paren
(brace
multiline_comment|/* Notice that this looks at the requested sync source,&n;&t;   not the one actually in use.&n;&t;*/
r_switch
c_cond
(paren
id|hdsp-&gt;control_register
op_amp
id|HDSP_SyncRefMask
)paren
(brace
r_case
id|HDSP_SyncRef_ADAT1
suffix:colon
r_return
id|HDSP_SYNC_FROM_ADAT1
suffix:semicolon
r_case
id|HDSP_SyncRef_ADAT2
suffix:colon
r_return
id|HDSP_SYNC_FROM_ADAT2
suffix:semicolon
r_case
id|HDSP_SyncRef_ADAT3
suffix:colon
r_return
id|HDSP_SYNC_FROM_ADAT3
suffix:semicolon
r_case
id|HDSP_SyncRef_SPDIF
suffix:colon
r_return
id|HDSP_SYNC_FROM_SPDIF
suffix:semicolon
r_case
id|HDSP_SyncRef_WORD
suffix:colon
r_return
id|HDSP_SYNC_FROM_WORD
suffix:semicolon
r_case
id|HDSP_SyncRef_ADAT_SYNC
suffix:colon
r_return
id|HDSP_SYNC_FROM_ADAT_SYNC
suffix:semicolon
r_default
suffix:colon
r_return
id|HDSP_SYNC_FROM_WORD
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|hdsp_set_pref_sync_ref
r_static
r_int
id|hdsp_set_pref_sync_ref
c_func
(paren
id|hdsp_t
op_star
id|hdsp
comma
r_int
id|pref
)paren
(brace
id|hdsp-&gt;control_register
op_and_assign
op_complement
id|HDSP_SyncRefMask
suffix:semicolon
r_switch
c_cond
(paren
id|pref
)paren
(brace
r_case
id|HDSP_SYNC_FROM_ADAT1
suffix:colon
id|hdsp-&gt;control_register
op_and_assign
op_complement
id|HDSP_SyncRefMask
suffix:semicolon
multiline_comment|/* clear SyncRef bits */
r_break
suffix:semicolon
r_case
id|HDSP_SYNC_FROM_ADAT2
suffix:colon
id|hdsp-&gt;control_register
op_or_assign
id|HDSP_SyncRef_ADAT2
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HDSP_SYNC_FROM_ADAT3
suffix:colon
id|hdsp-&gt;control_register
op_or_assign
id|HDSP_SyncRef_ADAT3
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HDSP_SYNC_FROM_SPDIF
suffix:colon
id|hdsp-&gt;control_register
op_or_assign
id|HDSP_SyncRef_SPDIF
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HDSP_SYNC_FROM_WORD
suffix:colon
id|hdsp-&gt;control_register
op_or_assign
id|HDSP_SyncRef_WORD
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HDSP_SYNC_FROM_ADAT_SYNC
suffix:colon
id|hdsp-&gt;control_register
op_or_assign
id|HDSP_SyncRef_ADAT_SYNC
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
id|hdsp_write
c_func
(paren
id|hdsp
comma
id|HDSP_controlRegister
comma
id|hdsp-&gt;control_register
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_info_pref_sync_ref
r_static
r_int
id|snd_hdsp_info_pref_sync_ref
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
r_static
r_char
op_star
id|texts
(braket
)braket
op_assign
(brace
l_string|&quot;Word&quot;
comma
l_string|&quot;IEC958&quot;
comma
l_string|&quot;ADAT1&quot;
comma
l_string|&quot;ADAT Sync&quot;
comma
l_string|&quot;ADAT2&quot;
comma
l_string|&quot;ADAT3&quot;
)brace
suffix:semicolon
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_ENUMERATED
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
r_switch
c_cond
(paren
id|hdsp-&gt;io_type
)paren
(brace
r_case
id|Digiface
suffix:colon
r_case
id|H9652
suffix:colon
id|uinfo-&gt;value.enumerated.items
op_assign
l_int|6
suffix:semicolon
r_break
suffix:semicolon
r_case
id|Multiface
suffix:colon
id|uinfo-&gt;value.enumerated.items
op_assign
l_int|4
suffix:semicolon
r_break
suffix:semicolon
r_case
id|H9632
suffix:colon
id|uinfo-&gt;value.enumerated.items
op_assign
l_int|3
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|uinfo-&gt;value.enumerated.items
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|uinfo-&gt;value.enumerated.item
op_ge
id|uinfo-&gt;value.enumerated.items
)paren
id|uinfo-&gt;value.enumerated.item
op_assign
id|uinfo-&gt;value.enumerated.items
op_minus
l_int|1
suffix:semicolon
id|strcpy
c_func
(paren
id|uinfo-&gt;value.enumerated.name
comma
id|texts
(braket
id|uinfo-&gt;value.enumerated.item
)braket
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_get_pref_sync_ref
r_static
r_int
id|snd_hdsp_get_pref_sync_ref
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
id|hdsp_pref_sync_ref
c_func
(paren
id|hdsp
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_put_pref_sync_ref
r_static
r_int
id|snd_hdsp_put_pref_sync_ref
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|change
comma
id|max
suffix:semicolon
r_int
r_int
id|val
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snd_hdsp_use_is_exclusive
c_func
(paren
id|hdsp
)paren
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
r_switch
c_cond
(paren
id|hdsp-&gt;io_type
)paren
(brace
r_case
id|Digiface
suffix:colon
r_case
id|H9652
suffix:colon
id|max
op_assign
l_int|6
suffix:semicolon
r_break
suffix:semicolon
r_case
id|Multiface
suffix:colon
id|max
op_assign
l_int|4
suffix:semicolon
r_break
suffix:semicolon
r_case
id|H9632
suffix:colon
id|max
op_assign
l_int|3
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
id|EIO
suffix:semicolon
)brace
id|val
op_assign
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_mod
id|max
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
id|change
op_assign
(paren
r_int
)paren
id|val
op_ne
id|hdsp_pref_sync_ref
c_func
(paren
id|hdsp
)paren
suffix:semicolon
id|hdsp_set_pref_sync_ref
c_func
(paren
id|hdsp
comma
id|val
)paren
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
r_return
id|change
suffix:semicolon
)brace
DECL|macro|HDSP_AUTOSYNC_REF
mdefine_line|#define HDSP_AUTOSYNC_REF(xname, xindex) &bslash;&n;{ .iface = SNDRV_CTL_ELEM_IFACE_HWDEP, &bslash;&n;  .name = xname, &bslash;&n;  .index = xindex, &bslash;&n;  .access = SNDRV_CTL_ELEM_ACCESS_READ, &bslash;&n;  .info = snd_hdsp_info_autosync_ref, &bslash;&n;  .get = snd_hdsp_get_autosync_ref, &bslash;&n;}
DECL|function|hdsp_autosync_ref
r_static
r_int
id|hdsp_autosync_ref
c_func
(paren
id|hdsp_t
op_star
id|hdsp
)paren
(brace
multiline_comment|/* This looks at the autosync selected sync reference */
r_int
r_int
id|status2
op_assign
id|hdsp_read
c_func
(paren
id|hdsp
comma
id|HDSP_status2Register
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|status2
op_amp
id|HDSP_SelSyncRefMask
)paren
(brace
r_case
id|HDSP_SelSyncRef_WORD
suffix:colon
r_return
id|HDSP_AUTOSYNC_FROM_WORD
suffix:semicolon
r_case
id|HDSP_SelSyncRef_ADAT_SYNC
suffix:colon
r_return
id|HDSP_AUTOSYNC_FROM_ADAT_SYNC
suffix:semicolon
r_case
id|HDSP_SelSyncRef_SPDIF
suffix:colon
r_return
id|HDSP_AUTOSYNC_FROM_SPDIF
suffix:semicolon
r_case
id|HDSP_SelSyncRefMask
suffix:colon
r_return
id|HDSP_AUTOSYNC_FROM_NONE
suffix:semicolon
r_case
id|HDSP_SelSyncRef_ADAT1
suffix:colon
r_return
id|HDSP_AUTOSYNC_FROM_ADAT1
suffix:semicolon
r_case
id|HDSP_SelSyncRef_ADAT2
suffix:colon
r_return
id|HDSP_AUTOSYNC_FROM_ADAT2
suffix:semicolon
r_case
id|HDSP_SelSyncRef_ADAT3
suffix:colon
r_return
id|HDSP_AUTOSYNC_FROM_ADAT3
suffix:semicolon
r_default
suffix:colon
r_return
id|HDSP_AUTOSYNC_FROM_WORD
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_info_autosync_ref
r_static
r_int
id|snd_hdsp_info_autosync_ref
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
r_static
r_char
op_star
id|texts
(braket
)braket
op_assign
(brace
l_string|&quot;Word&quot;
comma
l_string|&quot;ADAT Sync&quot;
comma
l_string|&quot;IEC958&quot;
comma
l_string|&quot;None&quot;
comma
l_string|&quot;ADAT1&quot;
comma
l_string|&quot;ADAT2&quot;
comma
l_string|&quot;ADAT3&quot;
)brace
suffix:semicolon
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_ENUMERATED
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
id|uinfo-&gt;value.enumerated.items
op_assign
l_int|7
suffix:semicolon
r_if
c_cond
(paren
id|uinfo-&gt;value.enumerated.item
op_ge
id|uinfo-&gt;value.enumerated.items
)paren
id|uinfo-&gt;value.enumerated.item
op_assign
id|uinfo-&gt;value.enumerated.items
op_minus
l_int|1
suffix:semicolon
id|strcpy
c_func
(paren
id|uinfo-&gt;value.enumerated.name
comma
id|texts
(braket
id|uinfo-&gt;value.enumerated.item
)braket
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_get_autosync_ref
r_static
r_int
id|snd_hdsp_get_autosync_ref
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
id|hdsp_autosync_ref
c_func
(paren
id|hdsp
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|macro|HDSP_PASSTHRU
mdefine_line|#define HDSP_PASSTHRU(xname, xindex) &bslash;&n;{ .iface = SNDRV_CTL_ELEM_IFACE_HWDEP, &bslash;&n;  .name = xname, &bslash;&n;  .index = xindex, &bslash;&n;  .info = snd_hdsp_info_passthru, &bslash;&n;  .put = snd_hdsp_put_passthru, &bslash;&n;  .get = snd_hdsp_get_passthru &bslash;&n;}
DECL|function|snd_hdsp_info_passthru
r_static
r_int
id|snd_hdsp_info_passthru
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_BOOLEAN
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
id|uinfo-&gt;value.integer.min
op_assign
l_int|0
suffix:semicolon
id|uinfo-&gt;value.integer.max
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_get_passthru
r_static
r_int
id|snd_hdsp_get_passthru
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
id|hdsp-&gt;passthru
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_put_passthru
r_static
r_int
id|snd_hdsp_put_passthru
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|change
suffix:semicolon
r_int
r_int
id|val
suffix:semicolon
r_int
id|err
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snd_hdsp_use_is_exclusive
c_func
(paren
id|hdsp
)paren
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
id|val
op_assign
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_amp
l_int|1
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
id|change
op_assign
(paren
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_ne
id|hdsp-&gt;passthru
)paren
suffix:semicolon
r_if
c_cond
(paren
id|change
)paren
id|err
op_assign
id|hdsp_set_passthru
c_func
(paren
id|hdsp
comma
id|val
)paren
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
r_return
id|err
ques
c_cond
id|err
suffix:colon
id|change
suffix:semicolon
)brace
DECL|macro|HDSP_LINE_OUT
mdefine_line|#define HDSP_LINE_OUT(xname, xindex) &bslash;&n;{ .iface = SNDRV_CTL_ELEM_IFACE_HWDEP, &bslash;&n;  .name = xname, &bslash;&n;  .index = xindex, &bslash;&n;  .info = snd_hdsp_info_line_out, &bslash;&n;  .get = snd_hdsp_get_line_out, &bslash;&n;  .put = snd_hdsp_put_line_out &bslash;&n;}
DECL|function|hdsp_line_out
r_static
r_int
id|hdsp_line_out
c_func
(paren
id|hdsp_t
op_star
id|hdsp
)paren
(brace
r_return
(paren
id|hdsp-&gt;control_register
op_amp
id|HDSP_LineOut
)paren
ques
c_cond
l_int|1
suffix:colon
l_int|0
suffix:semicolon
)brace
DECL|function|hdsp_set_line_output
r_static
r_int
id|hdsp_set_line_output
c_func
(paren
id|hdsp_t
op_star
id|hdsp
comma
r_int
id|out
)paren
(brace
r_if
c_cond
(paren
id|out
)paren
(brace
id|hdsp-&gt;control_register
op_or_assign
id|HDSP_LineOut
suffix:semicolon
)brace
r_else
(brace
id|hdsp-&gt;control_register
op_and_assign
op_complement
id|HDSP_LineOut
suffix:semicolon
)brace
id|hdsp_write
c_func
(paren
id|hdsp
comma
id|HDSP_controlRegister
comma
id|hdsp-&gt;control_register
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_info_line_out
r_static
r_int
id|snd_hdsp_info_line_out
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_BOOLEAN
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
id|uinfo-&gt;value.integer.min
op_assign
l_int|0
suffix:semicolon
id|uinfo-&gt;value.integer.max
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_get_line_out
r_static
r_int
id|snd_hdsp_get_line_out
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
id|hdsp_line_out
c_func
(paren
id|hdsp
)paren
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_put_line_out
r_static
r_int
id|snd_hdsp_put_line_out
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|change
suffix:semicolon
r_int
r_int
id|val
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snd_hdsp_use_is_exclusive
c_func
(paren
id|hdsp
)paren
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
id|val
op_assign
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_amp
l_int|1
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
id|change
op_assign
(paren
r_int
)paren
id|val
op_ne
id|hdsp_line_out
c_func
(paren
id|hdsp
)paren
suffix:semicolon
id|hdsp_set_line_output
c_func
(paren
id|hdsp
comma
id|val
)paren
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
r_return
id|change
suffix:semicolon
)brace
DECL|macro|HDSP_MIXER
mdefine_line|#define HDSP_MIXER(xname, xindex) &bslash;&n;{ .iface = SNDRV_CTL_ELEM_IFACE_HWDEP, &bslash;&n;  .name = xname, &bslash;&n;  .index = xindex, &bslash;&n;  .access = SNDRV_CTL_ELEM_ACCESS_READWRITE | &bslash;&n;&t;&t; SNDRV_CTL_ELEM_ACCESS_VOLATILE, &bslash;&n;  .info = snd_hdsp_info_mixer, &bslash;&n;  .get = snd_hdsp_get_mixer, &bslash;&n;  .put = snd_hdsp_put_mixer &bslash;&n;}
DECL|function|snd_hdsp_info_mixer
r_static
r_int
id|snd_hdsp_info_mixer
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_INTEGER
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|3
suffix:semicolon
id|uinfo-&gt;value.integer.min
op_assign
l_int|0
suffix:semicolon
id|uinfo-&gt;value.integer.max
op_assign
l_int|65536
suffix:semicolon
id|uinfo-&gt;value.integer.step
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_get_mixer
r_static
r_int
id|snd_hdsp_get_mixer
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|source
suffix:semicolon
r_int
id|destination
suffix:semicolon
r_int
id|addr
suffix:semicolon
id|source
op_assign
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
suffix:semicolon
id|destination
op_assign
id|ucontrol-&gt;value.integer.value
(braket
l_int|1
)braket
suffix:semicolon
r_if
c_cond
(paren
id|source
op_ge
id|hdsp-&gt;max_channels
)paren
(brace
id|addr
op_assign
id|hdsp_playback_to_output_key
c_func
(paren
id|hdsp
comma
id|source
op_minus
id|hdsp-&gt;max_channels
comma
id|destination
)paren
suffix:semicolon
)brace
r_else
(brace
id|addr
op_assign
id|hdsp_input_to_output_key
c_func
(paren
id|hdsp
comma
id|source
comma
id|destination
)paren
suffix:semicolon
)brace
id|spin_lock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|2
)braket
op_assign
id|hdsp_read_gain
(paren
id|hdsp
comma
id|addr
)paren
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_put_mixer
r_static
r_int
id|snd_hdsp_put_mixer
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|change
suffix:semicolon
r_int
id|source
suffix:semicolon
r_int
id|destination
suffix:semicolon
r_int
id|gain
suffix:semicolon
r_int
id|addr
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snd_hdsp_use_is_exclusive
c_func
(paren
id|hdsp
)paren
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
id|source
op_assign
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
suffix:semicolon
id|destination
op_assign
id|ucontrol-&gt;value.integer.value
(braket
l_int|1
)braket
suffix:semicolon
r_if
c_cond
(paren
id|source
op_ge
id|hdsp-&gt;max_channels
)paren
(brace
id|addr
op_assign
id|hdsp_playback_to_output_key
c_func
(paren
id|hdsp
comma
id|source
op_minus
id|hdsp-&gt;max_channels
comma
id|destination
)paren
suffix:semicolon
)brace
r_else
(brace
id|addr
op_assign
id|hdsp_input_to_output_key
c_func
(paren
id|hdsp
comma
id|source
comma
id|destination
)paren
suffix:semicolon
)brace
id|gain
op_assign
id|ucontrol-&gt;value.integer.value
(braket
l_int|2
)braket
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
id|change
op_assign
id|gain
op_ne
id|hdsp_read_gain
c_func
(paren
id|hdsp
comma
id|addr
)paren
suffix:semicolon
r_if
c_cond
(paren
id|change
)paren
id|hdsp_write_gain
c_func
(paren
id|hdsp
comma
id|addr
comma
id|gain
)paren
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
r_return
id|change
suffix:semicolon
)brace
DECL|macro|HDSP_WC_SYNC_CHECK
mdefine_line|#define HDSP_WC_SYNC_CHECK(xname, xindex) &bslash;&n;{ .iface = SNDRV_CTL_ELEM_IFACE_HWDEP, &bslash;&n;  .name = xname, &bslash;&n;  .index = xindex, &bslash;&n;  .access = SNDRV_CTL_ELEM_ACCESS_READ | SNDRV_CTL_ELEM_ACCESS_VOLATILE, &bslash;&n;  .info = snd_hdsp_info_sync_check, &bslash;&n;  .get = snd_hdsp_get_wc_sync_check &bslash;&n;}
DECL|function|snd_hdsp_info_sync_check
r_static
r_int
id|snd_hdsp_info_sync_check
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
r_static
r_char
op_star
id|texts
(braket
)braket
op_assign
(brace
l_string|&quot;No Lock&quot;
comma
l_string|&quot;Lock&quot;
comma
l_string|&quot;Sync&quot;
)brace
suffix:semicolon
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_ENUMERATED
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
id|uinfo-&gt;value.enumerated.items
op_assign
l_int|3
suffix:semicolon
r_if
c_cond
(paren
id|uinfo-&gt;value.enumerated.item
op_ge
id|uinfo-&gt;value.enumerated.items
)paren
id|uinfo-&gt;value.enumerated.item
op_assign
id|uinfo-&gt;value.enumerated.items
op_minus
l_int|1
suffix:semicolon
id|strcpy
c_func
(paren
id|uinfo-&gt;value.enumerated.name
comma
id|texts
(braket
id|uinfo-&gt;value.enumerated.item
)braket
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|hdsp_wc_sync_check
r_static
r_int
id|hdsp_wc_sync_check
c_func
(paren
id|hdsp_t
op_star
id|hdsp
)paren
(brace
r_int
id|status2
op_assign
id|hdsp_read
c_func
(paren
id|hdsp
comma
id|HDSP_status2Register
)paren
suffix:semicolon
r_if
c_cond
(paren
id|status2
op_amp
id|HDSP_wc_lock
)paren
(brace
r_if
c_cond
(paren
id|status2
op_amp
id|HDSP_wc_sync
)paren
(brace
r_return
l_int|2
suffix:semicolon
)brace
r_else
(brace
r_return
l_int|1
suffix:semicolon
)brace
)brace
r_else
(brace
r_return
l_int|0
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_get_wc_sync_check
r_static
r_int
id|snd_hdsp_get_wc_sync_check
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
id|hdsp_wc_sync_check
c_func
(paren
id|hdsp
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|macro|HDSP_SPDIF_SYNC_CHECK
mdefine_line|#define HDSP_SPDIF_SYNC_CHECK(xname, xindex) &bslash;&n;{ .iface = SNDRV_CTL_ELEM_IFACE_HWDEP, &bslash;&n;  .name = xname, &bslash;&n;  .index = xindex, &bslash;&n;  .access = SNDRV_CTL_ELEM_ACCESS_READ | SNDRV_CTL_ELEM_ACCESS_VOLATILE, &bslash;&n;  .info = snd_hdsp_info_sync_check, &bslash;&n;  .get = snd_hdsp_get_spdif_sync_check &bslash;&n;}
DECL|function|hdsp_spdif_sync_check
r_static
r_int
id|hdsp_spdif_sync_check
c_func
(paren
id|hdsp_t
op_star
id|hdsp
)paren
(brace
r_int
id|status
op_assign
id|hdsp_read
c_func
(paren
id|hdsp
comma
id|HDSP_statusRegister
)paren
suffix:semicolon
r_if
c_cond
(paren
id|status
op_amp
id|HDSP_SPDIFErrorFlag
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|status
op_amp
id|HDSP_SPDIFSync
)paren
(brace
r_return
l_int|2
suffix:semicolon
)brace
r_else
(brace
r_return
l_int|1
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_get_spdif_sync_check
r_static
r_int
id|snd_hdsp_get_spdif_sync_check
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
id|hdsp_spdif_sync_check
c_func
(paren
id|hdsp
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|macro|HDSP_ADATSYNC_SYNC_CHECK
mdefine_line|#define HDSP_ADATSYNC_SYNC_CHECK(xname, xindex) &bslash;&n;{ .iface = SNDRV_CTL_ELEM_IFACE_HWDEP, &bslash;&n;  .name = xname, &bslash;&n;  .index = xindex, &bslash;&n;  .access = SNDRV_CTL_ELEM_ACCESS_READ | SNDRV_CTL_ELEM_ACCESS_VOLATILE, &bslash;&n;  .info = snd_hdsp_info_sync_check, &bslash;&n;  .get = snd_hdsp_get_adatsync_sync_check &bslash;&n;}
DECL|function|hdsp_adatsync_sync_check
r_static
r_int
id|hdsp_adatsync_sync_check
c_func
(paren
id|hdsp_t
op_star
id|hdsp
)paren
(brace
r_int
id|status
op_assign
id|hdsp_read
c_func
(paren
id|hdsp
comma
id|HDSP_statusRegister
)paren
suffix:semicolon
r_if
c_cond
(paren
id|status
op_amp
id|HDSP_TimecodeLock
)paren
(brace
r_if
c_cond
(paren
id|status
op_amp
id|HDSP_TimecodeSync
)paren
(brace
r_return
l_int|2
suffix:semicolon
)brace
r_else
(brace
r_return
l_int|1
suffix:semicolon
)brace
)brace
r_else
(brace
r_return
l_int|0
suffix:semicolon
)brace
)brace
DECL|function|snd_hdsp_get_adatsync_sync_check
r_static
r_int
id|snd_hdsp_get_adatsync_sync_check
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
id|hdsp_adatsync_sync_check
c_func
(paren
id|hdsp
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|macro|HDSP_ADAT_SYNC_CHECK
mdefine_line|#define HDSP_ADAT_SYNC_CHECK &bslash;&n;{ .iface = SNDRV_CTL_ELEM_IFACE_HWDEP, &bslash;&n;  .access = SNDRV_CTL_ELEM_ACCESS_READ | SNDRV_CTL_ELEM_ACCESS_VOLATILE, &bslash;&n;  .info = snd_hdsp_info_sync_check, &bslash;&n;  .get = snd_hdsp_get_adat_sync_check &bslash;&n;}
DECL|function|hdsp_adat_sync_check
r_static
r_int
id|hdsp_adat_sync_check
c_func
(paren
id|hdsp_t
op_star
id|hdsp
comma
r_int
id|idx
)paren
(brace
r_int
id|status
op_assign
id|hdsp_read
c_func
(paren
id|hdsp
comma
id|HDSP_statusRegister
)paren
suffix:semicolon
r_if
c_cond
(paren
id|status
op_amp
(paren
id|HDSP_Lock0
op_rshift
id|idx
)paren
)paren
(brace
r_if
c_cond
(paren
id|status
op_amp
(paren
id|HDSP_Sync0
op_rshift
id|idx
)paren
)paren
(brace
r_return
l_int|2
suffix:semicolon
)brace
r_else
(brace
r_return
l_int|1
suffix:semicolon
)brace
)brace
r_else
(brace
r_return
l_int|0
suffix:semicolon
)brace
)brace
DECL|function|snd_hdsp_get_adat_sync_check
r_static
r_int
id|snd_hdsp_get_adat_sync_check
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
r_int
id|offset
suffix:semicolon
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|offset
op_assign
id|ucontrol-&gt;id.index
op_minus
l_int|1
suffix:semicolon
id|snd_assert
c_func
(paren
id|offset
op_ge
l_int|0
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|hdsp-&gt;io_type
)paren
(brace
r_case
id|Digiface
suffix:colon
r_case
id|H9652
suffix:colon
r_if
c_cond
(paren
id|offset
op_ge
l_int|3
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_break
suffix:semicolon
r_case
id|Multiface
suffix:colon
r_case
id|H9632
suffix:colon
r_if
c_cond
(paren
id|offset
op_ge
l_int|1
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
id|EIO
suffix:semicolon
)brace
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
id|hdsp_adat_sync_check
c_func
(paren
id|hdsp
comma
id|offset
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|snd_hdsp_9632_controls
r_static
id|snd_kcontrol_new_t
id|snd_hdsp_9632_controls
(braket
)braket
op_assign
(brace
id|HDSP_DA_GAIN
c_func
(paren
l_string|&quot;DA Gain&quot;
comma
l_int|0
)paren
comma
id|HDSP_AD_GAIN
c_func
(paren
l_string|&quot;AD Gain&quot;
comma
l_int|0
)paren
comma
id|HDSP_PHONE_GAIN
c_func
(paren
l_string|&quot;Phones Gain&quot;
comma
l_int|0
)paren
comma
id|HDSP_XLR_BREAKOUT_CABLE
c_func
(paren
l_string|&quot;XLR Breakout Cable&quot;
comma
l_int|0
)paren
)brace
suffix:semicolon
DECL|variable|snd_hdsp_controls
r_static
id|snd_kcontrol_new_t
id|snd_hdsp_controls
(braket
)braket
op_assign
(brace
(brace
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_PCM
comma
dot
id|name
op_assign
id|SNDRV_CTL_NAME_IEC958
c_func
(paren
l_string|&quot;&quot;
comma
id|PLAYBACK
comma
id|DEFAULT
)paren
comma
dot
id|info
op_assign
id|snd_hdsp_control_spdif_info
comma
dot
id|get
op_assign
id|snd_hdsp_control_spdif_get
comma
dot
id|put
op_assign
id|snd_hdsp_control_spdif_put
comma
)brace
comma
(brace
dot
id|access
op_assign
id|SNDRV_CTL_ELEM_ACCESS_READWRITE
op_or
id|SNDRV_CTL_ELEM_ACCESS_INACTIVE
comma
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_PCM
comma
dot
id|name
op_assign
id|SNDRV_CTL_NAME_IEC958
c_func
(paren
l_string|&quot;&quot;
comma
id|PLAYBACK
comma
id|PCM_STREAM
)paren
comma
dot
id|info
op_assign
id|snd_hdsp_control_spdif_stream_info
comma
dot
id|get
op_assign
id|snd_hdsp_control_spdif_stream_get
comma
dot
id|put
op_assign
id|snd_hdsp_control_spdif_stream_put
comma
)brace
comma
(brace
dot
id|access
op_assign
id|SNDRV_CTL_ELEM_ACCESS_READ
comma
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_MIXER
comma
dot
id|name
op_assign
id|SNDRV_CTL_NAME_IEC958
c_func
(paren
l_string|&quot;&quot;
comma
id|PLAYBACK
comma
id|CON_MASK
)paren
comma
dot
id|info
op_assign
id|snd_hdsp_control_spdif_mask_info
comma
dot
id|get
op_assign
id|snd_hdsp_control_spdif_mask_get
comma
dot
id|private_value
op_assign
id|IEC958_AES0_NONAUDIO
op_or
id|IEC958_AES0_PROFESSIONAL
op_or
id|IEC958_AES0_CON_EMPHASIS
comma
)brace
comma
(brace
dot
id|access
op_assign
id|SNDRV_CTL_ELEM_ACCESS_READ
comma
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_MIXER
comma
dot
id|name
op_assign
id|SNDRV_CTL_NAME_IEC958
c_func
(paren
l_string|&quot;&quot;
comma
id|PLAYBACK
comma
id|PRO_MASK
)paren
comma
dot
id|info
op_assign
id|snd_hdsp_control_spdif_mask_info
comma
dot
id|get
op_assign
id|snd_hdsp_control_spdif_mask_get
comma
dot
id|private_value
op_assign
id|IEC958_AES0_NONAUDIO
op_or
id|IEC958_AES0_PROFESSIONAL
op_or
id|IEC958_AES0_PRO_EMPHASIS
comma
)brace
comma
id|HDSP_MIXER
c_func
(paren
l_string|&quot;Mixer&quot;
comma
l_int|0
)paren
comma
id|HDSP_SPDIF_IN
c_func
(paren
l_string|&quot;IEC958 Input Connector&quot;
comma
l_int|0
)paren
comma
id|HDSP_SPDIF_OUT
c_func
(paren
l_string|&quot;IEC958 Output also on ADAT1&quot;
comma
l_int|0
)paren
comma
id|HDSP_SPDIF_PROFESSIONAL
c_func
(paren
l_string|&quot;IEC958 Professional Bit&quot;
comma
l_int|0
)paren
comma
id|HDSP_SPDIF_EMPHASIS
c_func
(paren
l_string|&quot;IEC958 Emphasis Bit&quot;
comma
l_int|0
)paren
comma
id|HDSP_SPDIF_NON_AUDIO
c_func
(paren
l_string|&quot;IEC958 Non-audio Bit&quot;
comma
l_int|0
)paren
comma
multiline_comment|/* &squot;Sample Clock Source&squot; complies with the alsa control naming scheme */
id|HDSP_CLOCK_SOURCE
c_func
(paren
l_string|&quot;Sample Clock Source&quot;
comma
l_int|0
)paren
comma
id|HDSP_SYSTEM_CLOCK_MODE
c_func
(paren
l_string|&quot;System Clock Mode&quot;
comma
l_int|0
)paren
comma
id|HDSP_PREF_SYNC_REF
c_func
(paren
l_string|&quot;Preferred Sync Reference&quot;
comma
l_int|0
)paren
comma
id|HDSP_AUTOSYNC_REF
c_func
(paren
l_string|&quot;AutoSync Reference&quot;
comma
l_int|0
)paren
comma
id|HDSP_SPDIF_SAMPLE_RATE
c_func
(paren
l_string|&quot;SPDIF Sample Rate&quot;
comma
l_int|0
)paren
comma
id|HDSP_SYSTEM_SAMPLE_RATE
c_func
(paren
l_string|&quot;System Sample Rate&quot;
comma
l_int|0
)paren
comma
multiline_comment|/* &squot;External Rate&squot; complies with the alsa control naming scheme */
id|HDSP_AUTOSYNC_SAMPLE_RATE
c_func
(paren
l_string|&quot;External Rate&quot;
comma
l_int|0
)paren
comma
id|HDSP_WC_SYNC_CHECK
c_func
(paren
l_string|&quot;Word Clock Lock Status&quot;
comma
l_int|0
)paren
comma
id|HDSP_SPDIF_SYNC_CHECK
c_func
(paren
l_string|&quot;SPDIF Lock Status&quot;
comma
l_int|0
)paren
comma
id|HDSP_ADATSYNC_SYNC_CHECK
c_func
(paren
l_string|&quot;ADAT Sync Lock Status&quot;
comma
l_int|0
)paren
comma
id|HDSP_PASSTHRU
c_func
(paren
l_string|&quot;Passthru&quot;
comma
l_int|0
)paren
comma
id|HDSP_LINE_OUT
c_func
(paren
l_string|&quot;Line Out&quot;
comma
l_int|0
)paren
comma
)brace
suffix:semicolon
DECL|variable|snd_hdsp_96xx_aeb
r_static
id|snd_kcontrol_new_t
id|snd_hdsp_96xx_aeb
op_assign
id|HDSP_AEB
c_func
(paren
l_string|&quot;Analog Extension Board&quot;
comma
l_int|0
)paren
suffix:semicolon
DECL|variable|snd_hdsp_adat_sync_check
r_static
id|snd_kcontrol_new_t
id|snd_hdsp_adat_sync_check
op_assign
id|HDSP_ADAT_SYNC_CHECK
suffix:semicolon
DECL|function|snd_hdsp_create_controls
r_static
r_int
id|snd_hdsp_create_controls
c_func
(paren
id|snd_card_t
op_star
id|card
comma
id|hdsp_t
op_star
id|hdsp
)paren
(brace
r_int
r_int
id|idx
suffix:semicolon
r_int
id|err
suffix:semicolon
id|snd_kcontrol_t
op_star
id|kctl
suffix:semicolon
r_for
c_loop
(paren
id|idx
op_assign
l_int|0
suffix:semicolon
id|idx
OL
id|ARRAY_SIZE
c_func
(paren
id|snd_hdsp_controls
)paren
suffix:semicolon
id|idx
op_increment
)paren
(brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|card
comma
id|kctl
op_assign
id|snd_ctl_new1
c_func
(paren
op_amp
id|snd_hdsp_controls
(braket
id|idx
)braket
comma
id|hdsp
)paren
)paren
)paren
OL
l_int|0
)paren
(brace
r_return
id|err
suffix:semicolon
)brace
r_if
c_cond
(paren
id|idx
op_eq
l_int|1
)paren
multiline_comment|/* IEC958 (S/PDIF) Stream */
id|hdsp-&gt;spdif_ctl
op_assign
id|kctl
suffix:semicolon
)brace
multiline_comment|/* ADAT SyncCheck status */
id|snd_hdsp_adat_sync_check.name
op_assign
l_string|&quot;ADAT Lock Status&quot;
suffix:semicolon
id|snd_hdsp_adat_sync_check.index
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
(paren
id|card
comma
id|kctl
op_assign
id|snd_ctl_new1
c_func
(paren
op_amp
id|snd_hdsp_adat_sync_check
comma
id|hdsp
)paren
)paren
)paren
)paren
(brace
r_return
id|err
suffix:semicolon
)brace
r_if
c_cond
(paren
id|hdsp-&gt;io_type
op_eq
id|Digiface
op_logical_or
id|hdsp-&gt;io_type
op_eq
id|H9652
)paren
(brace
r_for
c_loop
(paren
id|idx
op_assign
l_int|1
suffix:semicolon
id|idx
OL
l_int|3
suffix:semicolon
op_increment
id|idx
)paren
(brace
id|snd_hdsp_adat_sync_check.index
op_assign
id|idx
op_plus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
(paren
id|card
comma
id|kctl
op_assign
id|snd_ctl_new1
c_func
(paren
op_amp
id|snd_hdsp_adat_sync_check
comma
id|hdsp
)paren
)paren
)paren
)paren
(brace
r_return
id|err
suffix:semicolon
)brace
)brace
)brace
multiline_comment|/* DA, AD and Phone gain and XLR breakout cable controls for H9632 cards */
r_if
c_cond
(paren
id|hdsp-&gt;io_type
op_eq
id|H9632
)paren
(brace
r_for
c_loop
(paren
id|idx
op_assign
l_int|0
suffix:semicolon
id|idx
OL
id|ARRAY_SIZE
c_func
(paren
id|snd_hdsp_9632_controls
)paren
suffix:semicolon
id|idx
op_increment
)paren
(brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|card
comma
id|kctl
op_assign
id|snd_ctl_new1
c_func
(paren
op_amp
id|snd_hdsp_9632_controls
(braket
id|idx
)braket
comma
id|hdsp
)paren
)paren
)paren
OL
l_int|0
)paren
(brace
r_return
id|err
suffix:semicolon
)brace
)brace
)brace
multiline_comment|/* AEB control for H96xx card */
r_if
c_cond
(paren
id|hdsp-&gt;io_type
op_eq
id|H9632
op_logical_or
id|hdsp-&gt;io_type
op_eq
id|H9652
)paren
(brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|card
comma
id|kctl
op_assign
id|snd_ctl_new1
c_func
(paren
op_amp
id|snd_hdsp_96xx_aeb
comma
id|hdsp
)paren
)paren
)paren
OL
l_int|0
)paren
(brace
r_return
id|err
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*------------------------------------------------------------&n;   /proc interface &n; ------------------------------------------------------------*/
r_static
r_void
DECL|function|snd_hdsp_proc_read
id|snd_hdsp_proc_read
c_func
(paren
id|snd_info_entry_t
op_star
id|entry
comma
id|snd_info_buffer_t
op_star
id|buffer
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
(paren
id|hdsp_t
op_star
)paren
id|entry-&gt;private_data
suffix:semicolon
r_int
r_int
id|status
suffix:semicolon
r_int
r_int
id|status2
suffix:semicolon
r_char
op_star
id|pref_sync_ref
suffix:semicolon
r_char
op_star
id|autosync_ref
suffix:semicolon
r_char
op_star
id|system_clock_mode
suffix:semicolon
r_char
op_star
id|clock_source
suffix:semicolon
r_int
id|x
suffix:semicolon
r_if
c_cond
(paren
id|hdsp_check_for_iobox
(paren
id|hdsp
)paren
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;No I/O box connected.&bslash;nPlease connect one and upload firmware.&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|hdsp_check_for_firmware
c_func
(paren
id|hdsp
)paren
)paren
(brace
r_if
c_cond
(paren
id|hdsp-&gt;state
op_amp
id|HDSP_FirmwareCached
)paren
(brace
r_if
c_cond
(paren
id|snd_hdsp_load_firmware_from_cache
c_func
(paren
id|hdsp
)paren
op_ne
l_int|0
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Firmware loading from cache failed, please upload manually.&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
)brace
r_else
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;No firmware loaded nor cached, please upload firmware.&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
)brace
id|status
op_assign
id|hdsp_read
c_func
(paren
id|hdsp
comma
id|HDSP_statusRegister
)paren
suffix:semicolon
id|status2
op_assign
id|hdsp_read
c_func
(paren
id|hdsp
comma
id|HDSP_status2Register
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;%s (Card #%d)&bslash;n&quot;
comma
id|hdsp-&gt;card_name
comma
id|hdsp-&gt;card-&gt;number
op_plus
l_int|1
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Buffers: capture %p playback %p&bslash;n&quot;
comma
id|hdsp-&gt;capture_buffer
comma
id|hdsp-&gt;playback_buffer
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;IRQ: %d Registers bus: 0x%lx VM: 0x%lx&bslash;n&quot;
comma
id|hdsp-&gt;irq
comma
id|hdsp-&gt;port
comma
(paren
r_int
r_int
)paren
id|hdsp-&gt;iobase
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Control register: 0x%x&bslash;n&quot;
comma
id|hdsp-&gt;control_register
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Control2 register: 0x%x&bslash;n&quot;
comma
id|hdsp-&gt;control2_register
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Status register: 0x%x&bslash;n&quot;
comma
id|status
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Status2 register: 0x%x&bslash;n&quot;
comma
id|status2
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;FIFO status: %d&bslash;n&quot;
comma
id|hdsp_read
c_func
(paren
id|hdsp
comma
id|HDSP_fifoStatus
)paren
op_amp
l_int|0xff
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;MIDI1 Output status: 0x%x&bslash;n&quot;
comma
id|hdsp_read
c_func
(paren
id|hdsp
comma
id|HDSP_midiStatusOut0
)paren
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;MIDI1 Input status: 0x%x&bslash;n&quot;
comma
id|hdsp_read
c_func
(paren
id|hdsp
comma
id|HDSP_midiStatusIn0
)paren
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;MIDI2 Output status: 0x%x&bslash;n&quot;
comma
id|hdsp_read
c_func
(paren
id|hdsp
comma
id|HDSP_midiStatusOut1
)paren
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;MIDI2 Input status: 0x%x&bslash;n&quot;
comma
id|hdsp_read
c_func
(paren
id|hdsp
comma
id|HDSP_midiStatusIn1
)paren
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|x
op_assign
l_int|1
op_lshift
(paren
l_int|6
op_plus
id|hdsp_decode_latency
c_func
(paren
id|hdsp-&gt;control_register
op_amp
id|HDSP_LatencyMask
)paren
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Buffer Size (Latency): %d samples (2 periods of %lu bytes)&bslash;n&quot;
comma
id|x
comma
(paren
r_int
r_int
)paren
id|hdsp-&gt;period_bytes
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Hardware pointer (frames): %ld&bslash;n&quot;
comma
id|hdsp_hw_pointer
c_func
(paren
id|hdsp
)paren
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Passthru: %s&bslash;n&quot;
comma
id|hdsp-&gt;passthru
ques
c_cond
l_string|&quot;yes&quot;
suffix:colon
l_string|&quot;no&quot;
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Line out: %s&bslash;n&quot;
comma
(paren
id|hdsp-&gt;control_register
op_amp
id|HDSP_LineOut
)paren
ques
c_cond
l_string|&quot;on&quot;
suffix:colon
l_string|&quot;off&quot;
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Firmware version: %d&bslash;n&quot;
comma
(paren
id|status2
op_amp
id|HDSP_version0
)paren
op_or
(paren
id|status2
op_amp
id|HDSP_version1
)paren
op_lshift
l_int|1
op_or
(paren
id|status2
op_amp
id|HDSP_version2
)paren
op_lshift
l_int|2
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|hdsp_clock_source
c_func
(paren
id|hdsp
)paren
)paren
(brace
r_case
id|HDSP_CLOCK_SOURCE_AUTOSYNC
suffix:colon
id|clock_source
op_assign
l_string|&quot;AutoSync&quot;
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HDSP_CLOCK_SOURCE_INTERNAL_32KHZ
suffix:colon
id|clock_source
op_assign
l_string|&quot;Internal 32 kHz&quot;
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HDSP_CLOCK_SOURCE_INTERNAL_44_1KHZ
suffix:colon
id|clock_source
op_assign
l_string|&quot;Internal 44.1 kHz&quot;
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HDSP_CLOCK_SOURCE_INTERNAL_48KHZ
suffix:colon
id|clock_source
op_assign
l_string|&quot;Internal 48 kHz&quot;
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HDSP_CLOCK_SOURCE_INTERNAL_64KHZ
suffix:colon
id|clock_source
op_assign
l_string|&quot;Internal 64 kHz&quot;
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HDSP_CLOCK_SOURCE_INTERNAL_88_2KHZ
suffix:colon
id|clock_source
op_assign
l_string|&quot;Internal 88.2 kHz&quot;
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HDSP_CLOCK_SOURCE_INTERNAL_96KHZ
suffix:colon
id|clock_source
op_assign
l_string|&quot;Internal 96 kHz&quot;
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HDSP_CLOCK_SOURCE_INTERNAL_128KHZ
suffix:colon
id|clock_source
op_assign
l_string|&quot;Internal 128 kHz&quot;
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HDSP_CLOCK_SOURCE_INTERNAL_176_4KHZ
suffix:colon
id|clock_source
op_assign
l_string|&quot;Internal 176.4 kHz&quot;
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HDSP_CLOCK_SOURCE_INTERNAL_192KHZ
suffix:colon
id|clock_source
op_assign
l_string|&quot;Internal 192 kHz&quot;
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|clock_source
op_assign
l_string|&quot;Error&quot;
suffix:semicolon
)brace
id|snd_iprintf
(paren
id|buffer
comma
l_string|&quot;Sample Clock Source: %s&bslash;n&quot;
comma
id|clock_source
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hdsp_system_clock_mode
c_func
(paren
id|hdsp
)paren
)paren
(brace
id|system_clock_mode
op_assign
l_string|&quot;Slave&quot;
suffix:semicolon
)brace
r_else
(brace
id|system_clock_mode
op_assign
l_string|&quot;Master&quot;
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|hdsp_pref_sync_ref
(paren
id|hdsp
)paren
)paren
(brace
r_case
id|HDSP_SYNC_FROM_WORD
suffix:colon
id|pref_sync_ref
op_assign
l_string|&quot;Word Clock&quot;
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HDSP_SYNC_FROM_ADAT_SYNC
suffix:colon
id|pref_sync_ref
op_assign
l_string|&quot;ADAT Sync&quot;
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HDSP_SYNC_FROM_SPDIF
suffix:colon
id|pref_sync_ref
op_assign
l_string|&quot;SPDIF&quot;
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HDSP_SYNC_FROM_ADAT1
suffix:colon
id|pref_sync_ref
op_assign
l_string|&quot;ADAT1&quot;
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HDSP_SYNC_FROM_ADAT2
suffix:colon
id|pref_sync_ref
op_assign
l_string|&quot;ADAT2&quot;
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HDSP_SYNC_FROM_ADAT3
suffix:colon
id|pref_sync_ref
op_assign
l_string|&quot;ADAT3&quot;
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|pref_sync_ref
op_assign
l_string|&quot;Word Clock&quot;
suffix:semicolon
r_break
suffix:semicolon
)brace
id|snd_iprintf
(paren
id|buffer
comma
l_string|&quot;Preferred Sync Reference: %s&bslash;n&quot;
comma
id|pref_sync_ref
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|hdsp_autosync_ref
(paren
id|hdsp
)paren
)paren
(brace
r_case
id|HDSP_AUTOSYNC_FROM_WORD
suffix:colon
id|autosync_ref
op_assign
l_string|&quot;Word Clock&quot;
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HDSP_AUTOSYNC_FROM_ADAT_SYNC
suffix:colon
id|autosync_ref
op_assign
l_string|&quot;ADAT Sync&quot;
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HDSP_AUTOSYNC_FROM_SPDIF
suffix:colon
id|autosync_ref
op_assign
l_string|&quot;SPDIF&quot;
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HDSP_AUTOSYNC_FROM_NONE
suffix:colon
id|autosync_ref
op_assign
l_string|&quot;None&quot;
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HDSP_AUTOSYNC_FROM_ADAT1
suffix:colon
id|autosync_ref
op_assign
l_string|&quot;ADAT1&quot;
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HDSP_AUTOSYNC_FROM_ADAT2
suffix:colon
id|autosync_ref
op_assign
l_string|&quot;ADAT2&quot;
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HDSP_AUTOSYNC_FROM_ADAT3
suffix:colon
id|autosync_ref
op_assign
l_string|&quot;ADAT3&quot;
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|autosync_ref
op_assign
l_string|&quot;---&quot;
suffix:semicolon
r_break
suffix:semicolon
)brace
id|snd_iprintf
(paren
id|buffer
comma
l_string|&quot;AutoSync Reference: %s&bslash;n&quot;
comma
id|autosync_ref
)paren
suffix:semicolon
id|snd_iprintf
(paren
id|buffer
comma
l_string|&quot;AutoSync Frequency: %d&bslash;n&quot;
comma
id|hdsp_external_sample_rate
c_func
(paren
id|hdsp
)paren
)paren
suffix:semicolon
id|snd_iprintf
(paren
id|buffer
comma
l_string|&quot;System Clock Mode: %s&bslash;n&quot;
comma
id|system_clock_mode
)paren
suffix:semicolon
id|snd_iprintf
(paren
id|buffer
comma
l_string|&quot;System Clock Frequency: %d&bslash;n&quot;
comma
id|hdsp-&gt;system_sample_rate
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|hdsp_spdif_in
c_func
(paren
id|hdsp
)paren
)paren
(brace
r_case
id|HDSP_SPDIFIN_OPTICAL
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;IEC958 input: Optical&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HDSP_SPDIFIN_COAXIAL
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;IEC958 input: Coaxial&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HDSP_SPDIFIN_INTERNAL
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;IEC958 input: Internal&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HDSP_SPDIFIN_AES
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;IEC958 input: AES&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;IEC958 input: ???&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|hdsp-&gt;control_register
op_amp
id|HDSP_SPDIFOpticalOut
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;IEC958 output: Coaxial &amp; ADAT1&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;IEC958 output: Coaxial only&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|hdsp-&gt;control_register
op_amp
id|HDSP_SPDIFProfessional
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;IEC958 quality: Professional&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;IEC958 quality: Consumer&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|hdsp-&gt;control_register
op_amp
id|HDSP_SPDIFEmphasis
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;IEC958 emphasis: on&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;IEC958 emphasis: off&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|hdsp-&gt;control_register
op_amp
id|HDSP_SPDIFNonAudio
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;IEC958 NonAudio: on&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;IEC958 NonAudio: off&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|x
op_assign
id|hdsp_spdif_sample_rate
(paren
id|hdsp
)paren
)paren
op_ne
l_int|0
)paren
(brace
id|snd_iprintf
(paren
id|buffer
comma
l_string|&quot;IEC958 sample rate: %d&bslash;n&quot;
comma
id|x
)paren
suffix:semicolon
)brace
r_else
(brace
id|snd_iprintf
(paren
id|buffer
comma
l_string|&quot;IEC958 sample rate: Error flag set&bslash;n&quot;
)paren
suffix:semicolon
)brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
multiline_comment|/* Sync Check */
id|x
op_assign
id|status
op_amp
id|HDSP_Sync0
suffix:semicolon
r_if
c_cond
(paren
id|status
op_amp
id|HDSP_Lock0
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;ADAT1: %s&bslash;n&quot;
comma
id|x
ques
c_cond
l_string|&quot;Sync&quot;
suffix:colon
l_string|&quot;Lock&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;ADAT1: No Lock&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|hdsp-&gt;io_type
)paren
(brace
r_case
id|Digiface
suffix:colon
r_case
id|H9652
suffix:colon
id|x
op_assign
id|status
op_amp
id|HDSP_Sync1
suffix:semicolon
r_if
c_cond
(paren
id|status
op_amp
id|HDSP_Lock1
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;ADAT2: %s&bslash;n&quot;
comma
id|x
ques
c_cond
l_string|&quot;Sync&quot;
suffix:colon
l_string|&quot;Lock&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;ADAT2: No Lock&bslash;n&quot;
)paren
suffix:semicolon
)brace
id|x
op_assign
id|status
op_amp
id|HDSP_Sync2
suffix:semicolon
r_if
c_cond
(paren
id|status
op_amp
id|HDSP_Lock2
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;ADAT3: %s&bslash;n&quot;
comma
id|x
ques
c_cond
l_string|&quot;Sync&quot;
suffix:colon
l_string|&quot;Lock&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;ADAT3: No Lock&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_default
suffix:colon
multiline_comment|/* relax */
r_break
suffix:semicolon
)brace
id|x
op_assign
id|status
op_amp
id|HDSP_SPDIFSync
suffix:semicolon
r_if
c_cond
(paren
id|status
op_amp
id|HDSP_SPDIFErrorFlag
)paren
(brace
id|snd_iprintf
(paren
id|buffer
comma
l_string|&quot;SPDIF: No Lock&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|snd_iprintf
(paren
id|buffer
comma
l_string|&quot;SPDIF: %s&bslash;n&quot;
comma
id|x
ques
c_cond
l_string|&quot;Sync&quot;
suffix:colon
l_string|&quot;Lock&quot;
)paren
suffix:semicolon
)brace
id|x
op_assign
id|status2
op_amp
id|HDSP_wc_sync
suffix:semicolon
r_if
c_cond
(paren
id|status2
op_amp
id|HDSP_wc_lock
)paren
(brace
id|snd_iprintf
(paren
id|buffer
comma
l_string|&quot;Word Clock: %s&bslash;n&quot;
comma
id|x
ques
c_cond
l_string|&quot;Sync&quot;
suffix:colon
l_string|&quot;Lock&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|snd_iprintf
(paren
id|buffer
comma
l_string|&quot;Word Clock: No Lock&bslash;n&quot;
)paren
suffix:semicolon
)brace
id|x
op_assign
id|status
op_amp
id|HDSP_TimecodeSync
suffix:semicolon
r_if
c_cond
(paren
id|status
op_amp
id|HDSP_TimecodeLock
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;ADAT Sync: %s&bslash;n&quot;
comma
id|x
ques
c_cond
l_string|&quot;Sync&quot;
suffix:colon
l_string|&quot;Lock&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;ADAT Sync: No Lock&bslash;n&quot;
)paren
suffix:semicolon
)brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
multiline_comment|/* Informations about H9632 specific controls */
r_if
c_cond
(paren
id|hdsp-&gt;io_type
op_eq
id|H9632
)paren
(brace
r_char
op_star
id|tmp
suffix:semicolon
r_switch
c_cond
(paren
id|hdsp_ad_gain
c_func
(paren
id|hdsp
)paren
)paren
(brace
r_case
l_int|0
suffix:colon
id|tmp
op_assign
l_string|&quot;-10 dBV&quot;
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|tmp
op_assign
l_string|&quot;+4 dBu&quot;
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|tmp
op_assign
l_string|&quot;Lo Gain&quot;
suffix:semicolon
r_break
suffix:semicolon
)brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;AD Gain : %s&bslash;n&quot;
comma
id|tmp
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|hdsp_da_gain
c_func
(paren
id|hdsp
)paren
)paren
(brace
r_case
l_int|0
suffix:colon
id|tmp
op_assign
l_string|&quot;Hi Gain&quot;
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|tmp
op_assign
l_string|&quot;+4 dBu&quot;
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|tmp
op_assign
l_string|&quot;-10 dBV&quot;
suffix:semicolon
r_break
suffix:semicolon
)brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;DA Gain : %s&bslash;n&quot;
comma
id|tmp
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|hdsp_phone_gain
c_func
(paren
id|hdsp
)paren
)paren
(brace
r_case
l_int|0
suffix:colon
id|tmp
op_assign
l_string|&quot;0 dB&quot;
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|tmp
op_assign
l_string|&quot;-6 dB&quot;
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|tmp
op_assign
l_string|&quot;-12 dB&quot;
suffix:semicolon
r_break
suffix:semicolon
)brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Phones Gain : %s&bslash;n&quot;
comma
id|tmp
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;XLR Breakout Cable : %s&bslash;n&quot;
comma
id|hdsp_xlr_breakout_cable
c_func
(paren
id|hdsp
)paren
ques
c_cond
l_string|&quot;yes&quot;
suffix:colon
l_string|&quot;no&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hdsp-&gt;control_register
op_amp
id|HDSP_AnalogExtensionBoard
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;AEB : on (ADAT1 internal)&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;AEB : off (ADAT1 external)&bslash;n&quot;
)paren
suffix:semicolon
)brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
)brace
)brace
DECL|function|snd_hdsp_proc_init
r_static
r_void
id|__devinit
id|snd_hdsp_proc_init
c_func
(paren
id|hdsp_t
op_star
id|hdsp
)paren
(brace
id|snd_info_entry_t
op_star
id|entry
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snd_card_proc_new
c_func
(paren
id|hdsp-&gt;card
comma
l_string|&quot;hdsp&quot;
comma
op_amp
id|entry
)paren
)paren
id|snd_info_set_text_ops
c_func
(paren
id|entry
comma
id|hdsp
comma
l_int|1024
comma
id|snd_hdsp_proc_read
)paren
suffix:semicolon
)brace
DECL|function|snd_hdsp_free_buffers
r_static
r_void
id|snd_hdsp_free_buffers
c_func
(paren
id|hdsp_t
op_star
id|hdsp
)paren
(brace
id|snd_hammerfall_free_buffer
c_func
(paren
op_amp
id|hdsp-&gt;capture_dma_buf
comma
id|hdsp-&gt;pci
)paren
suffix:semicolon
id|snd_hammerfall_free_buffer
c_func
(paren
op_amp
id|hdsp-&gt;playback_dma_buf
comma
id|hdsp-&gt;pci
)paren
suffix:semicolon
)brace
DECL|function|snd_hdsp_initialize_memory
r_static
r_int
id|__devinit
id|snd_hdsp_initialize_memory
c_func
(paren
id|hdsp_t
op_star
id|hdsp
)paren
(brace
r_int
r_int
id|pb_bus
comma
id|cb_bus
suffix:semicolon
r_if
c_cond
(paren
id|snd_hammerfall_get_buffer
c_func
(paren
id|hdsp-&gt;pci
comma
op_amp
id|hdsp-&gt;capture_dma_buf
comma
id|HDSP_DMA_AREA_BYTES
)paren
OL
l_int|0
op_logical_or
id|snd_hammerfall_get_buffer
c_func
(paren
id|hdsp-&gt;pci
comma
op_amp
id|hdsp-&gt;playback_dma_buf
comma
id|HDSP_DMA_AREA_BYTES
)paren
OL
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|hdsp-&gt;capture_dma_buf.area
)paren
id|snd_dma_free_pages
c_func
(paren
op_amp
id|hdsp-&gt;capture_dma_buf
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;%s: no buffers available&bslash;n&quot;
comma
id|hdsp-&gt;card_name
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
multiline_comment|/* Align to bus-space 64K boundary */
id|cb_bus
op_assign
(paren
id|hdsp-&gt;capture_dma_buf.addr
op_plus
l_int|0xFFFF
)paren
op_amp
op_complement
l_int|0xFFFFl
suffix:semicolon
id|pb_bus
op_assign
(paren
id|hdsp-&gt;playback_dma_buf.addr
op_plus
l_int|0xFFFF
)paren
op_amp
op_complement
l_int|0xFFFFl
suffix:semicolon
multiline_comment|/* Tell the card where it is */
id|hdsp_write
c_func
(paren
id|hdsp
comma
id|HDSP_inputBufferAddress
comma
id|cb_bus
)paren
suffix:semicolon
id|hdsp_write
c_func
(paren
id|hdsp
comma
id|HDSP_outputBufferAddress
comma
id|pb_bus
)paren
suffix:semicolon
id|hdsp-&gt;capture_buffer
op_assign
id|hdsp-&gt;capture_dma_buf.area
op_plus
(paren
id|cb_bus
op_minus
id|hdsp-&gt;capture_dma_buf.addr
)paren
suffix:semicolon
id|hdsp-&gt;playback_buffer
op_assign
id|hdsp-&gt;playback_dma_buf.area
op_plus
(paren
id|pb_bus
op_minus
id|hdsp-&gt;playback_dma_buf.addr
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_set_defaults
r_static
r_int
id|snd_hdsp_set_defaults
c_func
(paren
id|hdsp_t
op_star
id|hdsp
)paren
(brace
r_int
r_int
id|i
suffix:semicolon
multiline_comment|/* ASSUMPTION: hdsp-&gt;lock is either held, or&n;&t;   there is no need to hold it (e.g. during module&n;&t;   initalization).&n;&t; */
multiline_comment|/* set defaults:&n;&n;&t;   SPDIF Input via Coax &n;&t;   Master clock mode&n;&t;   maximum latency (7 =&gt; 2^7 = 8192 samples, 64Kbyte buffer,&n;&t;                    which implies 2 4096 sample, 32Kbyte periods).&n;           Enable line out.&t;&t;&t;    &n;&t; */
id|hdsp-&gt;control_register
op_assign
id|HDSP_ClockModeMaster
op_or
id|HDSP_SPDIFInputCoaxial
op_or
id|hdsp_encode_latency
c_func
(paren
l_int|7
)paren
op_or
id|HDSP_LineOut
suffix:semicolon
id|hdsp_write
c_func
(paren
id|hdsp
comma
id|HDSP_controlRegister
comma
id|hdsp-&gt;control_register
)paren
suffix:semicolon
macro_line|#ifdef SNDRV_BIG_ENDIAN
id|hdsp-&gt;control2_register
op_assign
id|HDSP_BIGENDIAN_MODE
suffix:semicolon
macro_line|#else
id|hdsp-&gt;control2_register
op_assign
l_int|0
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
id|hdsp-&gt;io_type
op_eq
id|H9652
)paren
(brace
id|snd_hdsp_9652_enable_mixer
(paren
id|hdsp
)paren
suffix:semicolon
)brace
r_else
(brace
id|hdsp_write
(paren
id|hdsp
comma
id|HDSP_control2Reg
comma
id|hdsp-&gt;control2_register
)paren
suffix:semicolon
)brace
id|hdsp_reset_hw_pointer
c_func
(paren
id|hdsp
)paren
suffix:semicolon
id|hdsp_compute_period_size
c_func
(paren
id|hdsp
)paren
suffix:semicolon
multiline_comment|/* silence everything */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|HDSP_MATRIX_MIXER_SIZE
suffix:semicolon
op_increment
id|i
)paren
(brace
id|hdsp-&gt;mixer_matrix
(braket
id|i
)braket
op_assign
id|MINUS_INFINITY_GAIN
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
(paren
(paren
id|hdsp-&gt;io_type
op_eq
id|H9652
op_logical_or
id|hdsp-&gt;io_type
op_eq
id|H9632
)paren
ques
c_cond
l_int|1352
suffix:colon
id|HDSP_MATRIX_MIXER_SIZE
)paren
suffix:semicolon
op_increment
id|i
)paren
(brace
r_if
c_cond
(paren
id|hdsp_write_gain
(paren
id|hdsp
comma
id|i
comma
id|MINUS_INFINITY_GAIN
)paren
)paren
(brace
r_return
op_minus
id|EIO
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
(paren
id|hdsp-&gt;io_type
op_ne
id|H9652
)paren
op_logical_and
id|line_outs_monitor
(braket
id|hdsp-&gt;dev
)braket
)paren
(brace
r_int
id|lineouts_base
suffix:semicolon
id|snd_printk
(paren
l_string|&quot;sending all inputs and playback streams to line outs.&bslash;n&quot;
)paren
suffix:semicolon
multiline_comment|/* route all inputs to the line outs for easy monitoring. send&n;&t;&t;   odd numbered channels to right, even to left.&n;&t;&t;*/
r_if
c_cond
(paren
id|hdsp-&gt;io_type
op_eq
id|H9632
)paren
(brace
multiline_comment|/* this is the phones/analog output */
id|lineouts_base
op_assign
l_int|10
suffix:semicolon
)brace
r_else
(brace
id|lineouts_base
op_assign
l_int|26
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|hdsp-&gt;max_channels
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|i
op_amp
l_int|1
)paren
(brace
r_if
c_cond
(paren
id|hdsp_write_gain
(paren
id|hdsp
comma
id|hdsp_input_to_output_key
(paren
id|hdsp
comma
id|i
comma
id|lineouts_base
)paren
comma
id|UNITY_GAIN
)paren
op_logical_or
id|hdsp_write_gain
(paren
id|hdsp
comma
id|hdsp_playback_to_output_key
(paren
id|hdsp
comma
id|i
comma
id|lineouts_base
)paren
comma
id|UNITY_GAIN
)paren
)paren
(brace
r_return
op_minus
id|EIO
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|hdsp_write_gain
(paren
id|hdsp
comma
id|hdsp_input_to_output_key
(paren
id|hdsp
comma
id|i
comma
id|lineouts_base
op_plus
l_int|1
)paren
comma
id|UNITY_GAIN
)paren
op_logical_or
id|hdsp_write_gain
(paren
id|hdsp
comma
id|hdsp_playback_to_output_key
(paren
id|hdsp
comma
id|i
comma
id|lineouts_base
op_plus
l_int|1
)paren
comma
id|UNITY_GAIN
)paren
)paren
(brace
r_return
op_minus
id|EIO
suffix:semicolon
)brace
)brace
)brace
)brace
id|hdsp-&gt;passthru
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* H9632 specific defaults */
r_if
c_cond
(paren
id|hdsp-&gt;io_type
op_eq
id|H9632
)paren
(brace
id|hdsp-&gt;control_register
op_or_assign
(paren
id|HDSP_DAGainPlus4dBu
op_or
id|HDSP_ADGainPlus4dBu
op_or
id|HDSP_PhoneGain0dB
)paren
suffix:semicolon
id|hdsp_write
c_func
(paren
id|hdsp
comma
id|HDSP_controlRegister
comma
id|hdsp-&gt;control_register
)paren
suffix:semicolon
)brace
multiline_comment|/* set a default rate so that the channel map is set up.&n;&t; */
id|hdsp_set_rate
c_func
(paren
id|hdsp
comma
l_int|48000
comma
l_int|1
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|hdsp_midi_tasklet
r_static
r_void
id|hdsp_midi_tasklet
c_func
(paren
r_int
r_int
id|arg
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
(paren
id|hdsp_t
op_star
)paren
id|arg
suffix:semicolon
r_if
c_cond
(paren
id|hdsp-&gt;midi
(braket
l_int|0
)braket
dot
id|pending
)paren
(brace
id|snd_hdsp_midi_input_read
(paren
op_amp
id|hdsp-&gt;midi
(braket
l_int|0
)braket
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|hdsp-&gt;midi
(braket
l_int|1
)braket
dot
id|pending
)paren
(brace
id|snd_hdsp_midi_input_read
(paren
op_amp
id|hdsp-&gt;midi
(braket
l_int|1
)braket
)paren
suffix:semicolon
)brace
)brace
DECL|function|snd_hdsp_interrupt
r_static
id|irqreturn_t
id|snd_hdsp_interrupt
c_func
(paren
r_int
id|irq
comma
r_void
op_star
id|dev_id
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
(paren
id|hdsp_t
op_star
)paren
id|dev_id
suffix:semicolon
r_int
r_int
id|status
suffix:semicolon
r_int
id|audio
suffix:semicolon
r_int
id|midi0
suffix:semicolon
r_int
id|midi1
suffix:semicolon
r_int
r_int
id|midi0status
suffix:semicolon
r_int
r_int
id|midi1status
suffix:semicolon
r_int
id|schedule
op_assign
l_int|0
suffix:semicolon
id|status
op_assign
id|hdsp_read
c_func
(paren
id|hdsp
comma
id|HDSP_statusRegister
)paren
suffix:semicolon
id|audio
op_assign
id|status
op_amp
id|HDSP_audioIRQPending
suffix:semicolon
id|midi0
op_assign
id|status
op_amp
id|HDSP_midi0IRQPending
suffix:semicolon
id|midi1
op_assign
id|status
op_amp
id|HDSP_midi1IRQPending
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|audio
op_logical_and
op_logical_neg
id|midi0
op_logical_and
op_logical_neg
id|midi1
)paren
(brace
r_return
id|IRQ_NONE
suffix:semicolon
)brace
id|hdsp_write
c_func
(paren
id|hdsp
comma
id|HDSP_interruptConfirmation
comma
l_int|0
)paren
suffix:semicolon
id|midi0status
op_assign
id|hdsp_read
(paren
id|hdsp
comma
id|HDSP_midiStatusIn0
)paren
op_amp
l_int|0xff
suffix:semicolon
id|midi1status
op_assign
id|hdsp_read
(paren
id|hdsp
comma
id|HDSP_midiStatusIn1
)paren
op_amp
l_int|0xff
suffix:semicolon
r_if
c_cond
(paren
id|audio
)paren
(brace
r_if
c_cond
(paren
id|hdsp-&gt;capture_substream
)paren
(brace
id|snd_pcm_period_elapsed
c_func
(paren
id|hdsp-&gt;pcm-&gt;streams
(braket
id|SNDRV_PCM_STREAM_CAPTURE
)braket
dot
id|substream
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|hdsp-&gt;playback_substream
)paren
(brace
id|snd_pcm_period_elapsed
c_func
(paren
id|hdsp-&gt;pcm-&gt;streams
(braket
id|SNDRV_PCM_STREAM_PLAYBACK
)braket
dot
id|substream
)paren
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|midi0
op_logical_and
id|midi0status
)paren
(brace
multiline_comment|/* we disable interrupts for this input until processing is done */
id|hdsp-&gt;control_register
op_and_assign
op_complement
id|HDSP_Midi0InterruptEnable
suffix:semicolon
id|hdsp_write
c_func
(paren
id|hdsp
comma
id|HDSP_controlRegister
comma
id|hdsp-&gt;control_register
)paren
suffix:semicolon
id|hdsp-&gt;midi
(braket
l_int|0
)braket
dot
id|pending
op_assign
l_int|1
suffix:semicolon
id|schedule
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|midi1
op_logical_and
id|midi1status
)paren
(brace
multiline_comment|/* we disable interrupts for this input until processing is done */
id|hdsp-&gt;control_register
op_and_assign
op_complement
id|HDSP_Midi1InterruptEnable
suffix:semicolon
id|hdsp_write
c_func
(paren
id|hdsp
comma
id|HDSP_controlRegister
comma
id|hdsp-&gt;control_register
)paren
suffix:semicolon
id|hdsp-&gt;midi
(braket
l_int|1
)braket
dot
id|pending
op_assign
l_int|1
suffix:semicolon
id|schedule
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|schedule
)paren
id|tasklet_hi_schedule
c_func
(paren
op_amp
id|hdsp-&gt;midi_tasklet
)paren
suffix:semicolon
r_return
id|IRQ_HANDLED
suffix:semicolon
)brace
DECL|function|snd_hdsp_hw_pointer
r_static
id|snd_pcm_uframes_t
id|snd_hdsp_hw_pointer
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
r_return
id|hdsp_hw_pointer
c_func
(paren
id|hdsp
)paren
suffix:semicolon
)brace
DECL|function|hdsp_channel_buffer_location
r_static
r_char
op_star
id|hdsp_channel_buffer_location
c_func
(paren
id|hdsp_t
op_star
id|hdsp
comma
r_int
id|stream
comma
r_int
id|channel
)paren
(brace
r_int
id|mapped_channel
suffix:semicolon
id|snd_assert
c_func
(paren
id|channel
op_ge
l_int|0
op_logical_and
id|channel
OL
id|hdsp-&gt;max_channels
comma
r_return
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|mapped_channel
op_assign
id|hdsp-&gt;channel_map
(braket
id|channel
)braket
)paren
OL
l_int|0
)paren
(brace
r_return
l_int|NULL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|stream
op_eq
id|SNDRV_PCM_STREAM_CAPTURE
)paren
(brace
r_return
id|hdsp-&gt;capture_buffer
op_plus
(paren
id|mapped_channel
op_star
id|HDSP_CHANNEL_BUFFER_BYTES
)paren
suffix:semicolon
)brace
r_else
(brace
r_return
id|hdsp-&gt;playback_buffer
op_plus
(paren
id|mapped_channel
op_star
id|HDSP_CHANNEL_BUFFER_BYTES
)paren
suffix:semicolon
)brace
)brace
DECL|function|snd_hdsp_playback_copy
r_static
r_int
id|snd_hdsp_playback_copy
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|channel
comma
id|snd_pcm_uframes_t
id|pos
comma
r_void
id|__user
op_star
id|src
comma
id|snd_pcm_uframes_t
id|count
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
r_char
op_star
id|channel_buf
suffix:semicolon
id|snd_assert
c_func
(paren
id|pos
op_plus
id|count
op_le
id|HDSP_CHANNEL_BUFFER_BYTES
op_div
l_int|4
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|channel_buf
op_assign
id|hdsp_channel_buffer_location
(paren
id|hdsp
comma
id|substream-&gt;pstr-&gt;stream
comma
id|channel
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|channel_buf
op_ne
l_int|NULL
comma
r_return
op_minus
id|EIO
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
id|channel_buf
op_plus
id|pos
op_star
l_int|4
comma
id|src
comma
id|count
op_star
l_int|4
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
DECL|function|snd_hdsp_capture_copy
r_static
r_int
id|snd_hdsp_capture_copy
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|channel
comma
id|snd_pcm_uframes_t
id|pos
comma
r_void
id|__user
op_star
id|dst
comma
id|snd_pcm_uframes_t
id|count
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
r_char
op_star
id|channel_buf
suffix:semicolon
id|snd_assert
c_func
(paren
id|pos
op_plus
id|count
op_le
id|HDSP_CHANNEL_BUFFER_BYTES
op_div
l_int|4
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|channel_buf
op_assign
id|hdsp_channel_buffer_location
(paren
id|hdsp
comma
id|substream-&gt;pstr-&gt;stream
comma
id|channel
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|channel_buf
op_ne
l_int|NULL
comma
r_return
op_minus
id|EIO
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|dst
comma
id|channel_buf
op_plus
id|pos
op_star
l_int|4
comma
id|count
op_star
l_int|4
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
DECL|function|snd_hdsp_hw_silence
r_static
r_int
id|snd_hdsp_hw_silence
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|channel
comma
id|snd_pcm_uframes_t
id|pos
comma
id|snd_pcm_uframes_t
id|count
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
r_char
op_star
id|channel_buf
suffix:semicolon
id|channel_buf
op_assign
id|hdsp_channel_buffer_location
(paren
id|hdsp
comma
id|substream-&gt;pstr-&gt;stream
comma
id|channel
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|channel_buf
op_ne
l_int|NULL
comma
r_return
op_minus
id|EIO
)paren
suffix:semicolon
id|memset
c_func
(paren
id|channel_buf
op_plus
id|pos
op_star
l_int|4
comma
l_int|0
comma
id|count
op_star
l_int|4
)paren
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
DECL|function|snd_hdsp_reset
r_static
r_int
id|snd_hdsp_reset
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|other
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_PLAYBACK
)paren
id|other
op_assign
id|hdsp-&gt;capture_substream
suffix:semicolon
r_else
id|other
op_assign
id|hdsp-&gt;playback_substream
suffix:semicolon
r_if
c_cond
(paren
id|hdsp-&gt;running
)paren
id|runtime-&gt;status-&gt;hw_ptr
op_assign
id|hdsp_hw_pointer
c_func
(paren
id|hdsp
)paren
suffix:semicolon
r_else
id|runtime-&gt;status-&gt;hw_ptr
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|other
)paren
(brace
r_struct
id|list_head
op_star
id|pos
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|s
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|oruntime
op_assign
id|other-&gt;runtime
suffix:semicolon
id|snd_pcm_group_for_each
c_func
(paren
id|pos
comma
id|substream
)paren
(brace
id|s
op_assign
id|snd_pcm_group_substream_entry
c_func
(paren
id|pos
)paren
suffix:semicolon
r_if
c_cond
(paren
id|s
op_eq
id|other
)paren
(brace
id|oruntime-&gt;status-&gt;hw_ptr
op_assign
id|runtime-&gt;status-&gt;hw_ptr
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_hw_params
r_static
r_int
id|snd_hdsp_hw_params
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_hw_params_t
op_star
id|params
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
r_int
id|err
suffix:semicolon
id|pid_t
id|this_pid
suffix:semicolon
id|pid_t
id|other_pid
suffix:semicolon
r_if
c_cond
(paren
id|hdsp_check_for_iobox
(paren
id|hdsp
)paren
)paren
(brace
r_return
op_minus
id|EIO
suffix:semicolon
)brace
r_if
c_cond
(paren
id|hdsp_check_for_firmware
c_func
(paren
id|hdsp
)paren
)paren
(brace
r_if
c_cond
(paren
id|hdsp-&gt;state
op_amp
id|HDSP_FirmwareCached
)paren
(brace
r_if
c_cond
(paren
id|snd_hdsp_load_firmware_from_cache
c_func
(paren
id|hdsp
)paren
op_ne
l_int|0
)paren
(brace
id|snd_printk
c_func
(paren
l_string|&quot;Firmware loading from cache failed, please upload manually.&bslash;n&quot;
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
id|snd_printk
c_func
(paren
l_string|&quot;No firmware loaded nor cached, please upload firmware.&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_return
op_minus
id|EIO
suffix:semicolon
)brace
id|spin_lock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;pstr-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_PLAYBACK
)paren
(brace
id|hdsp-&gt;control_register
op_and_assign
op_complement
(paren
id|HDSP_SPDIFProfessional
op_or
id|HDSP_SPDIFNonAudio
op_or
id|HDSP_SPDIFEmphasis
)paren
suffix:semicolon
id|hdsp_write
c_func
(paren
id|hdsp
comma
id|HDSP_controlRegister
comma
id|hdsp-&gt;control_register
op_or_assign
id|hdsp-&gt;creg_spdif_stream
)paren
suffix:semicolon
id|this_pid
op_assign
id|hdsp-&gt;playback_pid
suffix:semicolon
id|other_pid
op_assign
id|hdsp-&gt;capture_pid
suffix:semicolon
)brace
r_else
(brace
id|this_pid
op_assign
id|hdsp-&gt;capture_pid
suffix:semicolon
id|other_pid
op_assign
id|hdsp-&gt;playback_pid
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|other_pid
OG
l_int|0
)paren
op_logical_and
(paren
id|this_pid
op_ne
id|other_pid
)paren
)paren
(brace
multiline_comment|/* The other stream is open, and not by the same&n;&t;&t;   task as this one. Make sure that the parameters&n;&t;&t;   that matter are the same.&n;&t;&t; */
r_if
c_cond
(paren
id|params_rate
c_func
(paren
id|params
)paren
op_ne
id|hdsp-&gt;system_sample_rate
)paren
(brace
id|spin_unlock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
id|_snd_pcm_hw_param_setempty
c_func
(paren
id|params
comma
id|SNDRV_PCM_HW_PARAM_RATE
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
r_if
c_cond
(paren
id|params_period_size
c_func
(paren
id|params
)paren
op_ne
id|hdsp-&gt;period_bytes
op_div
l_int|4
)paren
(brace
id|spin_unlock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
id|_snd_pcm_hw_param_setempty
c_func
(paren
id|params
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_SIZE
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
multiline_comment|/* We&squot;re fine. */
id|spin_unlock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|spin_unlock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
)brace
multiline_comment|/* how to make sure that the rate matches an externally-set one ?&n;&t; */
id|spin_lock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|hdsp_set_rate
c_func
(paren
id|hdsp
comma
id|params_rate
c_func
(paren
id|params
)paren
comma
l_int|0
)paren
)paren
OL
l_int|0
)paren
(brace
id|spin_unlock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
id|_snd_pcm_hw_param_setempty
c_func
(paren
id|params
comma
id|SNDRV_PCM_HW_PARAM_RATE
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
r_else
(brace
id|spin_unlock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|hdsp_set_interrupt_interval
c_func
(paren
id|hdsp
comma
id|params_period_size
c_func
(paren
id|params
)paren
)paren
)paren
OL
l_int|0
)paren
(brace
id|_snd_pcm_hw_param_setempty
c_func
(paren
id|params
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_SIZE
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_channel_info
r_static
r_int
id|snd_hdsp_channel_info
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_channel_info_t
op_star
id|info
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
r_int
id|mapped_channel
suffix:semicolon
id|snd_assert
c_func
(paren
id|info-&gt;channel
OL
id|hdsp-&gt;max_channels
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|mapped_channel
op_assign
id|hdsp-&gt;channel_map
(braket
id|info-&gt;channel
)braket
)paren
OL
l_int|0
)paren
(brace
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|info-&gt;offset
op_assign
id|mapped_channel
op_star
id|HDSP_CHANNEL_BUFFER_BYTES
suffix:semicolon
id|info-&gt;first
op_assign
l_int|0
suffix:semicolon
id|info-&gt;step
op_assign
l_int|32
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_ioctl
r_static
r_int
id|snd_hdsp_ioctl
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
r_int
id|cmd
comma
r_void
op_star
id|arg
)paren
(brace
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|SNDRV_PCM_IOCTL1_RESET
suffix:colon
(brace
r_return
id|snd_hdsp_reset
c_func
(paren
id|substream
)paren
suffix:semicolon
)brace
r_case
id|SNDRV_PCM_IOCTL1_CHANNEL_INFO
suffix:colon
(brace
id|snd_pcm_channel_info_t
op_star
id|info
op_assign
id|arg
suffix:semicolon
r_return
id|snd_hdsp_channel_info
c_func
(paren
id|substream
comma
id|info
)paren
suffix:semicolon
)brace
r_default
suffix:colon
r_break
suffix:semicolon
)brace
r_return
id|snd_pcm_lib_ioctl
c_func
(paren
id|substream
comma
id|cmd
comma
id|arg
)paren
suffix:semicolon
)brace
DECL|function|snd_hdsp_trigger
r_static
r_int
id|snd_hdsp_trigger
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|cmd
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|other
suffix:semicolon
r_int
id|running
suffix:semicolon
r_if
c_cond
(paren
id|hdsp_check_for_iobox
(paren
id|hdsp
)paren
)paren
(brace
r_return
op_minus
id|EIO
suffix:semicolon
)brace
r_if
c_cond
(paren
id|hdsp_check_for_firmware
c_func
(paren
id|hdsp
)paren
)paren
(brace
r_if
c_cond
(paren
id|hdsp-&gt;state
op_amp
id|HDSP_FirmwareCached
)paren
(brace
r_if
c_cond
(paren
id|snd_hdsp_load_firmware_from_cache
c_func
(paren
id|hdsp
)paren
op_ne
l_int|0
)paren
(brace
id|snd_printk
c_func
(paren
l_string|&quot;Firmware loading from cache failed, please upload manually.&bslash;n&quot;
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
id|snd_printk
c_func
(paren
l_string|&quot;No firmware loaded nor cached, please upload firmware.&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_return
op_minus
id|EIO
suffix:semicolon
)brace
id|spin_lock
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
id|running
op_assign
id|hdsp-&gt;running
suffix:semicolon
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|SNDRV_PCM_TRIGGER_START
suffix:colon
id|running
op_or_assign
l_int|1
op_lshift
id|substream-&gt;stream
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_TRIGGER_STOP
suffix:colon
id|running
op_and_assign
op_complement
(paren
l_int|1
op_lshift
id|substream-&gt;stream
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|snd_BUG
c_func
(paren
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|substream-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_PLAYBACK
)paren
id|other
op_assign
id|hdsp-&gt;capture_substream
suffix:semicolon
r_else
id|other
op_assign
id|hdsp-&gt;playback_substream
suffix:semicolon
r_if
c_cond
(paren
id|other
)paren
(brace
r_struct
id|list_head
op_star
id|pos
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|s
suffix:semicolon
id|snd_pcm_group_for_each
c_func
(paren
id|pos
comma
id|substream
)paren
(brace
id|s
op_assign
id|snd_pcm_group_substream_entry
c_func
(paren
id|pos
)paren
suffix:semicolon
r_if
c_cond
(paren
id|s
op_eq
id|other
)paren
(brace
id|snd_pcm_trigger_done
c_func
(paren
id|s
comma
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|cmd
op_eq
id|SNDRV_PCM_TRIGGER_START
)paren
id|running
op_or_assign
l_int|1
op_lshift
id|s-&gt;stream
suffix:semicolon
r_else
id|running
op_and_assign
op_complement
(paren
l_int|1
op_lshift
id|s-&gt;stream
)paren
suffix:semicolon
r_goto
id|_ok
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|cmd
op_eq
id|SNDRV_PCM_TRIGGER_START
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|running
op_amp
(paren
l_int|1
op_lshift
id|SNDRV_PCM_STREAM_PLAYBACK
)paren
)paren
op_logical_and
id|substream-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_CAPTURE
)paren
id|hdsp_silence_playback
c_func
(paren
id|hdsp
)paren
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|running
op_logical_and
id|substream-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_PLAYBACK
)paren
id|hdsp_silence_playback
c_func
(paren
id|hdsp
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|substream-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_CAPTURE
)paren
id|hdsp_silence_playback
c_func
(paren
id|hdsp
)paren
suffix:semicolon
)brace
id|_ok
suffix:colon
id|snd_pcm_trigger_done
c_func
(paren
id|substream
comma
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|hdsp-&gt;running
op_logical_and
id|running
)paren
id|hdsp_start_audio
c_func
(paren
id|hdsp
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|hdsp-&gt;running
op_logical_and
op_logical_neg
id|running
)paren
id|hdsp_stop_audio
c_func
(paren
id|hdsp
)paren
suffix:semicolon
id|hdsp-&gt;running
op_assign
id|running
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_prepare
r_static
r_int
id|snd_hdsp_prepare
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
r_int
id|result
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|hdsp_check_for_iobox
(paren
id|hdsp
)paren
)paren
(brace
r_return
op_minus
id|EIO
suffix:semicolon
)brace
r_if
c_cond
(paren
id|hdsp_check_for_firmware
c_func
(paren
id|hdsp
)paren
)paren
(brace
r_if
c_cond
(paren
id|hdsp-&gt;state
op_amp
id|HDSP_FirmwareCached
)paren
(brace
r_if
c_cond
(paren
id|snd_hdsp_load_firmware_from_cache
c_func
(paren
id|hdsp
)paren
op_ne
l_int|0
)paren
(brace
id|snd_printk
c_func
(paren
l_string|&quot;Firmware loading from cache failed, please upload manually.&bslash;n&quot;
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
id|snd_printk
c_func
(paren
l_string|&quot;No firmware loaded nor cached, please upload firmware.&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_return
op_minus
id|EIO
suffix:semicolon
)brace
id|spin_lock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|hdsp-&gt;running
)paren
id|hdsp_reset_hw_pointer
c_func
(paren
id|hdsp
)paren
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
DECL|variable|snd_hdsp_playback_subinfo
r_static
id|snd_pcm_hardware_t
id|snd_hdsp_playback_subinfo
op_assign
(brace
dot
id|info
op_assign
(paren
id|SNDRV_PCM_INFO_MMAP
op_or
id|SNDRV_PCM_INFO_MMAP_VALID
op_or
id|SNDRV_PCM_INFO_NONINTERLEAVED
op_or
id|SNDRV_PCM_INFO_SYNC_START
op_or
id|SNDRV_PCM_INFO_DOUBLE
)paren
comma
dot
id|formats
op_assign
id|SNDRV_PCM_FMTBIT_S32_LE
comma
dot
id|rates
op_assign
(paren
id|SNDRV_PCM_RATE_32000
op_or
id|SNDRV_PCM_RATE_44100
op_or
id|SNDRV_PCM_RATE_48000
op_or
id|SNDRV_PCM_RATE_64000
op_or
id|SNDRV_PCM_RATE_88200
op_or
id|SNDRV_PCM_RATE_96000
)paren
comma
dot
id|rate_min
op_assign
l_int|32000
comma
dot
id|rate_max
op_assign
l_int|96000
comma
dot
id|channels_min
op_assign
l_int|14
comma
dot
id|channels_max
op_assign
id|HDSP_MAX_CHANNELS
comma
dot
id|buffer_bytes_max
op_assign
id|HDSP_CHANNEL_BUFFER_BYTES
op_star
id|HDSP_MAX_CHANNELS
comma
dot
id|period_bytes_min
op_assign
(paren
l_int|64
op_star
l_int|4
)paren
op_star
l_int|10
comma
dot
id|period_bytes_max
op_assign
(paren
l_int|8192
op_star
l_int|4
)paren
op_star
id|HDSP_MAX_CHANNELS
comma
dot
id|periods_min
op_assign
l_int|2
comma
dot
id|periods_max
op_assign
l_int|2
comma
dot
id|fifo_size
op_assign
l_int|0
)brace
suffix:semicolon
DECL|variable|snd_hdsp_capture_subinfo
r_static
id|snd_pcm_hardware_t
id|snd_hdsp_capture_subinfo
op_assign
(brace
dot
id|info
op_assign
(paren
id|SNDRV_PCM_INFO_MMAP
op_or
id|SNDRV_PCM_INFO_MMAP_VALID
op_or
id|SNDRV_PCM_INFO_NONINTERLEAVED
op_or
id|SNDRV_PCM_INFO_SYNC_START
)paren
comma
dot
id|formats
op_assign
id|SNDRV_PCM_FMTBIT_S32_LE
comma
dot
id|rates
op_assign
(paren
id|SNDRV_PCM_RATE_32000
op_or
id|SNDRV_PCM_RATE_44100
op_or
id|SNDRV_PCM_RATE_48000
op_or
id|SNDRV_PCM_RATE_64000
op_or
id|SNDRV_PCM_RATE_88200
op_or
id|SNDRV_PCM_RATE_96000
)paren
comma
dot
id|rate_min
op_assign
l_int|32000
comma
dot
id|rate_max
op_assign
l_int|96000
comma
dot
id|channels_min
op_assign
l_int|14
comma
dot
id|channels_max
op_assign
id|HDSP_MAX_CHANNELS
comma
dot
id|buffer_bytes_max
op_assign
id|HDSP_CHANNEL_BUFFER_BYTES
op_star
id|HDSP_MAX_CHANNELS
comma
dot
id|period_bytes_min
op_assign
(paren
l_int|64
op_star
l_int|4
)paren
op_star
l_int|10
comma
dot
id|period_bytes_max
op_assign
(paren
l_int|8192
op_star
l_int|4
)paren
op_star
id|HDSP_MAX_CHANNELS
comma
dot
id|periods_min
op_assign
l_int|2
comma
dot
id|periods_max
op_assign
l_int|2
comma
dot
id|fifo_size
op_assign
l_int|0
)brace
suffix:semicolon
DECL|variable|hdsp_period_sizes
r_static
r_int
r_int
id|hdsp_period_sizes
(braket
)braket
op_assign
(brace
l_int|64
comma
l_int|128
comma
l_int|256
comma
l_int|512
comma
l_int|1024
comma
l_int|2048
comma
l_int|4096
comma
l_int|8192
)brace
suffix:semicolon
DECL|variable|hdsp_hw_constraints_period_sizes
r_static
id|snd_pcm_hw_constraint_list_t
id|hdsp_hw_constraints_period_sizes
op_assign
(brace
dot
id|count
op_assign
id|ARRAY_SIZE
c_func
(paren
id|hdsp_period_sizes
)paren
comma
dot
id|list
op_assign
id|hdsp_period_sizes
comma
dot
id|mask
op_assign
l_int|0
)brace
suffix:semicolon
DECL|variable|hdsp_9632_sample_rates
r_static
r_int
r_int
id|hdsp_9632_sample_rates
(braket
)braket
op_assign
(brace
l_int|32000
comma
l_int|44100
comma
l_int|48000
comma
l_int|64000
comma
l_int|88200
comma
l_int|96000
comma
l_int|128000
comma
l_int|176400
comma
l_int|192000
)brace
suffix:semicolon
DECL|variable|hdsp_hw_constraints_9632_sample_rates
r_static
id|snd_pcm_hw_constraint_list_t
id|hdsp_hw_constraints_9632_sample_rates
op_assign
(brace
dot
id|count
op_assign
id|ARRAY_SIZE
c_func
(paren
id|hdsp_9632_sample_rates
)paren
comma
dot
id|list
op_assign
id|hdsp_9632_sample_rates
comma
dot
id|mask
op_assign
l_int|0
)brace
suffix:semicolon
DECL|function|snd_hdsp_hw_rule_in_channels
r_static
r_int
id|snd_hdsp_hw_rule_in_channels
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_rule_t
op_star
id|rule
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|rule
op_member_access_from_pointer
r_private
suffix:semicolon
id|snd_interval_t
op_star
id|c
op_assign
id|hw_param_interval
c_func
(paren
id|params
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hdsp-&gt;io_type
op_eq
id|H9632
)paren
(brace
r_int
r_int
id|list
(braket
l_int|3
)braket
suffix:semicolon
id|list
(braket
l_int|0
)braket
op_assign
id|hdsp-&gt;qs_in_channels
suffix:semicolon
id|list
(braket
l_int|1
)braket
op_assign
id|hdsp-&gt;ds_in_channels
suffix:semicolon
id|list
(braket
l_int|2
)braket
op_assign
id|hdsp-&gt;ss_in_channels
suffix:semicolon
r_return
id|snd_interval_list
c_func
(paren
id|c
comma
l_int|3
comma
id|list
comma
l_int|0
)paren
suffix:semicolon
)brace
r_else
(brace
r_int
r_int
id|list
(braket
l_int|2
)braket
suffix:semicolon
id|list
(braket
l_int|0
)braket
op_assign
id|hdsp-&gt;ds_in_channels
suffix:semicolon
id|list
(braket
l_int|1
)braket
op_assign
id|hdsp-&gt;ss_in_channels
suffix:semicolon
r_return
id|snd_interval_list
c_func
(paren
id|c
comma
l_int|2
comma
id|list
comma
l_int|0
)paren
suffix:semicolon
)brace
)brace
DECL|function|snd_hdsp_hw_rule_out_channels
r_static
r_int
id|snd_hdsp_hw_rule_out_channels
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_rule_t
op_star
id|rule
)paren
(brace
r_int
r_int
id|list
(braket
l_int|3
)braket
suffix:semicolon
id|hdsp_t
op_star
id|hdsp
op_assign
id|rule
op_member_access_from_pointer
r_private
suffix:semicolon
id|snd_interval_t
op_star
id|c
op_assign
id|hw_param_interval
c_func
(paren
id|params
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hdsp-&gt;io_type
op_eq
id|H9632
)paren
(brace
id|list
(braket
l_int|0
)braket
op_assign
id|hdsp-&gt;qs_out_channels
suffix:semicolon
id|list
(braket
l_int|1
)braket
op_assign
id|hdsp-&gt;ds_out_channels
suffix:semicolon
id|list
(braket
l_int|2
)braket
op_assign
id|hdsp-&gt;ss_out_channels
suffix:semicolon
r_return
id|snd_interval_list
c_func
(paren
id|c
comma
l_int|3
comma
id|list
comma
l_int|0
)paren
suffix:semicolon
)brace
r_else
(brace
id|list
(braket
l_int|0
)braket
op_assign
id|hdsp-&gt;ds_out_channels
suffix:semicolon
id|list
(braket
l_int|1
)braket
op_assign
id|hdsp-&gt;ss_out_channels
suffix:semicolon
)brace
r_return
id|snd_interval_list
c_func
(paren
id|c
comma
l_int|2
comma
id|list
comma
l_int|0
)paren
suffix:semicolon
)brace
DECL|function|snd_hdsp_hw_rule_in_channels_rate
r_static
r_int
id|snd_hdsp_hw_rule_in_channels_rate
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_rule_t
op_star
id|rule
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|rule
op_member_access_from_pointer
r_private
suffix:semicolon
id|snd_interval_t
op_star
id|c
op_assign
id|hw_param_interval
c_func
(paren
id|params
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
)paren
suffix:semicolon
id|snd_interval_t
op_star
id|r
op_assign
id|hw_param_interval
c_func
(paren
id|params
comma
id|SNDRV_PCM_HW_PARAM_RATE
)paren
suffix:semicolon
r_if
c_cond
(paren
id|r-&gt;min
OG
l_int|96000
op_logical_and
id|hdsp-&gt;io_type
op_eq
id|H9632
)paren
(brace
id|snd_interval_t
id|t
op_assign
(brace
dot
id|min
op_assign
id|hdsp-&gt;qs_in_channels
comma
dot
id|max
op_assign
id|hdsp-&gt;qs_in_channels
comma
dot
id|integer
op_assign
l_int|1
comma
)brace
suffix:semicolon
r_return
id|snd_interval_refine
c_func
(paren
id|c
comma
op_amp
id|t
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|r-&gt;min
OG
l_int|48000
op_logical_and
id|r-&gt;max
op_le
l_int|96000
)paren
(brace
id|snd_interval_t
id|t
op_assign
(brace
dot
id|min
op_assign
id|hdsp-&gt;ds_in_channels
comma
dot
id|max
op_assign
id|hdsp-&gt;ds_in_channels
comma
dot
id|integer
op_assign
l_int|1
comma
)brace
suffix:semicolon
r_return
id|snd_interval_refine
c_func
(paren
id|c
comma
op_amp
id|t
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|r-&gt;max
OL
l_int|64000
)paren
(brace
id|snd_interval_t
id|t
op_assign
(brace
dot
id|min
op_assign
id|hdsp-&gt;ss_in_channels
comma
dot
id|max
op_assign
id|hdsp-&gt;ss_in_channels
comma
dot
id|integer
op_assign
l_int|1
comma
)brace
suffix:semicolon
r_return
id|snd_interval_refine
c_func
(paren
id|c
comma
op_amp
id|t
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_hw_rule_out_channels_rate
r_static
r_int
id|snd_hdsp_hw_rule_out_channels_rate
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_rule_t
op_star
id|rule
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|rule
op_member_access_from_pointer
r_private
suffix:semicolon
id|snd_interval_t
op_star
id|c
op_assign
id|hw_param_interval
c_func
(paren
id|params
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
)paren
suffix:semicolon
id|snd_interval_t
op_star
id|r
op_assign
id|hw_param_interval
c_func
(paren
id|params
comma
id|SNDRV_PCM_HW_PARAM_RATE
)paren
suffix:semicolon
r_if
c_cond
(paren
id|r-&gt;min
OG
l_int|96000
op_logical_and
id|hdsp-&gt;io_type
op_eq
id|H9632
)paren
(brace
id|snd_interval_t
id|t
op_assign
(brace
dot
id|min
op_assign
id|hdsp-&gt;qs_out_channels
comma
dot
id|max
op_assign
id|hdsp-&gt;qs_out_channels
comma
dot
id|integer
op_assign
l_int|1
comma
)brace
suffix:semicolon
r_return
id|snd_interval_refine
c_func
(paren
id|c
comma
op_amp
id|t
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|r-&gt;min
OG
l_int|48000
op_logical_and
id|r-&gt;max
op_le
l_int|96000
)paren
(brace
id|snd_interval_t
id|t
op_assign
(brace
dot
id|min
op_assign
id|hdsp-&gt;ds_out_channels
comma
dot
id|max
op_assign
id|hdsp-&gt;ds_out_channels
comma
dot
id|integer
op_assign
l_int|1
comma
)brace
suffix:semicolon
r_return
id|snd_interval_refine
c_func
(paren
id|c
comma
op_amp
id|t
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|r-&gt;max
OL
l_int|64000
)paren
(brace
id|snd_interval_t
id|t
op_assign
(brace
dot
id|min
op_assign
id|hdsp-&gt;ss_out_channels
comma
dot
id|max
op_assign
id|hdsp-&gt;ss_out_channels
comma
dot
id|integer
op_assign
l_int|1
comma
)brace
suffix:semicolon
r_return
id|snd_interval_refine
c_func
(paren
id|c
comma
op_amp
id|t
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_hw_rule_rate_out_channels
r_static
r_int
id|snd_hdsp_hw_rule_rate_out_channels
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_rule_t
op_star
id|rule
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|rule
op_member_access_from_pointer
r_private
suffix:semicolon
id|snd_interval_t
op_star
id|c
op_assign
id|hw_param_interval
c_func
(paren
id|params
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
)paren
suffix:semicolon
id|snd_interval_t
op_star
id|r
op_assign
id|hw_param_interval
c_func
(paren
id|params
comma
id|SNDRV_PCM_HW_PARAM_RATE
)paren
suffix:semicolon
r_if
c_cond
(paren
id|c-&gt;min
op_ge
id|hdsp-&gt;ss_out_channels
)paren
(brace
id|snd_interval_t
id|t
op_assign
(brace
dot
id|min
op_assign
l_int|32000
comma
dot
id|max
op_assign
l_int|48000
comma
dot
id|integer
op_assign
l_int|1
comma
)brace
suffix:semicolon
r_return
id|snd_interval_refine
c_func
(paren
id|r
comma
op_amp
id|t
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|c-&gt;max
op_le
id|hdsp-&gt;qs_out_channels
op_logical_and
id|hdsp-&gt;io_type
op_eq
id|H9632
)paren
(brace
id|snd_interval_t
id|t
op_assign
(brace
dot
id|min
op_assign
l_int|128000
comma
dot
id|max
op_assign
l_int|192000
comma
dot
id|integer
op_assign
l_int|1
comma
)brace
suffix:semicolon
r_return
id|snd_interval_refine
c_func
(paren
id|r
comma
op_amp
id|t
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|c-&gt;max
op_le
id|hdsp-&gt;ds_out_channels
)paren
(brace
id|snd_interval_t
id|t
op_assign
(brace
dot
id|min
op_assign
l_int|64000
comma
dot
id|max
op_assign
l_int|96000
comma
dot
id|integer
op_assign
l_int|1
comma
)brace
suffix:semicolon
r_return
id|snd_interval_refine
c_func
(paren
id|r
comma
op_amp
id|t
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_hw_rule_rate_in_channels
r_static
r_int
id|snd_hdsp_hw_rule_rate_in_channels
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_rule_t
op_star
id|rule
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|rule
op_member_access_from_pointer
r_private
suffix:semicolon
id|snd_interval_t
op_star
id|c
op_assign
id|hw_param_interval
c_func
(paren
id|params
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
)paren
suffix:semicolon
id|snd_interval_t
op_star
id|r
op_assign
id|hw_param_interval
c_func
(paren
id|params
comma
id|SNDRV_PCM_HW_PARAM_RATE
)paren
suffix:semicolon
r_if
c_cond
(paren
id|c-&gt;min
op_ge
id|hdsp-&gt;ss_in_channels
)paren
(brace
id|snd_interval_t
id|t
op_assign
(brace
dot
id|min
op_assign
l_int|32000
comma
dot
id|max
op_assign
l_int|48000
comma
dot
id|integer
op_assign
l_int|1
comma
)brace
suffix:semicolon
r_return
id|snd_interval_refine
c_func
(paren
id|r
comma
op_amp
id|t
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|c-&gt;max
op_le
id|hdsp-&gt;qs_in_channels
op_logical_and
id|hdsp-&gt;io_type
op_eq
id|H9632
)paren
(brace
id|snd_interval_t
id|t
op_assign
(brace
dot
id|min
op_assign
l_int|128000
comma
dot
id|max
op_assign
l_int|192000
comma
dot
id|integer
op_assign
l_int|1
comma
)brace
suffix:semicolon
r_return
id|snd_interval_refine
c_func
(paren
id|r
comma
op_amp
id|t
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|c-&gt;max
op_le
id|hdsp-&gt;ds_in_channels
)paren
(brace
id|snd_interval_t
id|t
op_assign
(brace
dot
id|min
op_assign
l_int|64000
comma
dot
id|max
op_assign
l_int|96000
comma
dot
id|integer
op_assign
l_int|1
comma
)brace
suffix:semicolon
r_return
id|snd_interval_refine
c_func
(paren
id|r
comma
op_amp
id|t
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_playback_open
r_static
r_int
id|snd_hdsp_playback_open
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|hdsp_check_for_iobox
(paren
id|hdsp
)paren
)paren
(brace
r_return
op_minus
id|EIO
suffix:semicolon
)brace
r_if
c_cond
(paren
id|hdsp_check_for_firmware
c_func
(paren
id|hdsp
)paren
)paren
(brace
r_if
c_cond
(paren
id|hdsp-&gt;state
op_amp
id|HDSP_FirmwareCached
)paren
(brace
r_if
c_cond
(paren
id|snd_hdsp_load_firmware_from_cache
c_func
(paren
id|hdsp
)paren
op_ne
l_int|0
)paren
(brace
id|snd_printk
c_func
(paren
l_string|&quot;Firmware loading from cache failed, please upload manually.&bslash;n&quot;
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
id|snd_printk
c_func
(paren
l_string|&quot;No firmware loaded nor cached, please upload firmware.&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_return
op_minus
id|EIO
suffix:semicolon
)brace
id|spin_lock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
id|snd_pcm_set_sync
c_func
(paren
id|substream
)paren
suffix:semicolon
id|runtime-&gt;hw
op_assign
id|snd_hdsp_playback_subinfo
suffix:semicolon
id|runtime-&gt;dma_area
op_assign
id|hdsp-&gt;playback_buffer
suffix:semicolon
id|runtime-&gt;dma_bytes
op_assign
id|HDSP_DMA_AREA_BYTES
suffix:semicolon
r_if
c_cond
(paren
id|hdsp-&gt;capture_substream
op_eq
l_int|NULL
)paren
(brace
id|hdsp_stop_audio
c_func
(paren
id|hdsp
)paren
suffix:semicolon
id|hdsp_set_thru
c_func
(paren
id|hdsp
comma
op_minus
l_int|1
comma
l_int|0
)paren
suffix:semicolon
)brace
id|hdsp-&gt;playback_pid
op_assign
id|current-&gt;pid
suffix:semicolon
id|hdsp-&gt;playback_substream
op_assign
id|substream
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
id|snd_pcm_hw_constraint_msbits
c_func
(paren
id|runtime
comma
l_int|0
comma
l_int|32
comma
l_int|24
)paren
suffix:semicolon
id|snd_pcm_hw_constraint_list
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_SIZE
comma
op_amp
id|hdsp_hw_constraints_period_sizes
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hdsp-&gt;io_type
op_eq
id|H9632
)paren
(brace
id|runtime-&gt;hw.channels_min
op_assign
id|hdsp-&gt;qs_out_channels
suffix:semicolon
id|runtime-&gt;hw.channels_max
op_assign
id|hdsp-&gt;ss_out_channels
suffix:semicolon
id|runtime-&gt;hw.rate_max
op_assign
l_int|192000
suffix:semicolon
id|runtime-&gt;hw.rates
op_assign
id|SNDRV_PCM_RATE_KNOT
suffix:semicolon
id|snd_pcm_hw_constraint_list
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_RATE
comma
op_amp
id|hdsp_hw_constraints_9632_sample_rates
)paren
suffix:semicolon
)brace
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
comma
id|snd_hdsp_hw_rule_out_channels
comma
id|hdsp
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
comma
op_minus
l_int|1
)paren
suffix:semicolon
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
comma
id|snd_hdsp_hw_rule_out_channels_rate
comma
id|hdsp
comma
id|SNDRV_PCM_HW_PARAM_RATE
comma
op_minus
l_int|1
)paren
suffix:semicolon
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_RATE
comma
id|snd_hdsp_hw_rule_rate_out_channels
comma
id|hdsp
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
comma
op_minus
l_int|1
)paren
suffix:semicolon
id|hdsp-&gt;creg_spdif_stream
op_assign
id|hdsp-&gt;creg_spdif
suffix:semicolon
id|hdsp-&gt;spdif_ctl-&gt;vd
(braket
l_int|0
)braket
dot
id|access
op_and_assign
op_complement
id|SNDRV_CTL_ELEM_ACCESS_INACTIVE
suffix:semicolon
id|snd_ctl_notify
c_func
(paren
id|hdsp-&gt;card
comma
id|SNDRV_CTL_EVENT_MASK_VALUE
op_or
id|SNDRV_CTL_EVENT_MASK_INFO
comma
op_amp
id|hdsp-&gt;spdif_ctl-&gt;id
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_playback_release
r_static
r_int
id|snd_hdsp_playback_release
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
id|hdsp-&gt;playback_pid
op_assign
op_minus
l_int|1
suffix:semicolon
id|hdsp-&gt;playback_substream
op_assign
l_int|NULL
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
id|hdsp-&gt;spdif_ctl-&gt;vd
(braket
l_int|0
)braket
dot
id|access
op_or_assign
id|SNDRV_CTL_ELEM_ACCESS_INACTIVE
suffix:semicolon
id|snd_ctl_notify
c_func
(paren
id|hdsp-&gt;card
comma
id|SNDRV_CTL_EVENT_MASK_VALUE
op_or
id|SNDRV_CTL_EVENT_MASK_INFO
comma
op_amp
id|hdsp-&gt;spdif_ctl-&gt;id
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_capture_open
r_static
r_int
id|snd_hdsp_capture_open
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|hdsp_check_for_iobox
(paren
id|hdsp
)paren
)paren
(brace
r_return
op_minus
id|EIO
suffix:semicolon
)brace
r_if
c_cond
(paren
id|hdsp_check_for_firmware
c_func
(paren
id|hdsp
)paren
)paren
(brace
r_if
c_cond
(paren
id|hdsp-&gt;state
op_amp
id|HDSP_FirmwareCached
)paren
(brace
r_if
c_cond
(paren
id|snd_hdsp_load_firmware_from_cache
c_func
(paren
id|hdsp
)paren
op_ne
l_int|0
)paren
(brace
id|snd_printk
c_func
(paren
l_string|&quot;Firmware loading from cache failed, please upload manually.&bslash;n&quot;
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
id|snd_printk
c_func
(paren
l_string|&quot;No firmware loaded nor cached, please upload firmware.&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_return
op_minus
id|EIO
suffix:semicolon
)brace
id|spin_lock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
id|snd_pcm_set_sync
c_func
(paren
id|substream
)paren
suffix:semicolon
id|runtime-&gt;hw
op_assign
id|snd_hdsp_capture_subinfo
suffix:semicolon
id|runtime-&gt;dma_area
op_assign
id|hdsp-&gt;capture_buffer
suffix:semicolon
id|runtime-&gt;dma_bytes
op_assign
id|HDSP_DMA_AREA_BYTES
suffix:semicolon
r_if
c_cond
(paren
id|hdsp-&gt;playback_substream
op_eq
l_int|NULL
)paren
(brace
id|hdsp_stop_audio
c_func
(paren
id|hdsp
)paren
suffix:semicolon
id|hdsp_set_thru
c_func
(paren
id|hdsp
comma
op_minus
l_int|1
comma
l_int|0
)paren
suffix:semicolon
)brace
id|hdsp-&gt;capture_pid
op_assign
id|current-&gt;pid
suffix:semicolon
id|hdsp-&gt;capture_substream
op_assign
id|substream
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
id|snd_pcm_hw_constraint_msbits
c_func
(paren
id|runtime
comma
l_int|0
comma
l_int|32
comma
l_int|24
)paren
suffix:semicolon
id|snd_pcm_hw_constraint_list
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_SIZE
comma
op_amp
id|hdsp_hw_constraints_period_sizes
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hdsp-&gt;io_type
op_eq
id|H9632
)paren
(brace
id|runtime-&gt;hw.channels_min
op_assign
id|hdsp-&gt;qs_in_channels
suffix:semicolon
id|runtime-&gt;hw.channels_max
op_assign
id|hdsp-&gt;ss_in_channels
suffix:semicolon
id|runtime-&gt;hw.rate_max
op_assign
l_int|192000
suffix:semicolon
id|runtime-&gt;hw.rates
op_assign
id|SNDRV_PCM_RATE_KNOT
suffix:semicolon
id|snd_pcm_hw_constraint_list
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_RATE
comma
op_amp
id|hdsp_hw_constraints_9632_sample_rates
)paren
suffix:semicolon
)brace
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
comma
id|snd_hdsp_hw_rule_in_channels
comma
id|hdsp
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
comma
op_minus
l_int|1
)paren
suffix:semicolon
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
comma
id|snd_hdsp_hw_rule_in_channels_rate
comma
id|hdsp
comma
id|SNDRV_PCM_HW_PARAM_RATE
comma
op_minus
l_int|1
)paren
suffix:semicolon
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_RATE
comma
id|snd_hdsp_hw_rule_rate_in_channels
comma
id|hdsp
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_capture_release
r_static
r_int
id|snd_hdsp_capture_release
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
id|hdsp-&gt;capture_pid
op_assign
op_minus
l_int|1
suffix:semicolon
id|hdsp-&gt;capture_substream
op_assign
l_int|NULL
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_hwdep_dummy_op
r_static
r_int
id|snd_hdsp_hwdep_dummy_op
c_func
(paren
id|snd_hwdep_t
op_star
id|hw
comma
r_struct
id|file
op_star
id|file
)paren
(brace
multiline_comment|/* we have nothing to initialize but the call is required */
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* helper functions for copying meter values */
DECL|function|copy_u32_le
r_static
r_inline
r_int
id|copy_u32_le
c_func
(paren
r_void
id|__user
op_star
id|dest
comma
r_void
id|__iomem
op_star
id|src
)paren
(brace
id|u32
id|val
op_assign
id|readl
c_func
(paren
id|src
)paren
suffix:semicolon
r_return
id|copy_to_user
c_func
(paren
id|dest
comma
op_amp
id|val
comma
l_int|4
)paren
suffix:semicolon
)brace
DECL|function|copy_u64_le
r_static
r_inline
r_int
id|copy_u64_le
c_func
(paren
r_void
id|__user
op_star
id|dest
comma
r_void
id|__iomem
op_star
id|src_low
comma
r_void
id|__iomem
op_star
id|src_high
)paren
(brace
id|u32
id|rms_low
comma
id|rms_high
suffix:semicolon
id|u64
id|rms
suffix:semicolon
id|rms_low
op_assign
id|readl
c_func
(paren
id|src_low
)paren
suffix:semicolon
id|rms_high
op_assign
id|readl
c_func
(paren
id|src_high
)paren
suffix:semicolon
id|rms
op_assign
(paren
(paren
id|u64
)paren
id|rms_high
op_lshift
l_int|32
)paren
op_or
id|rms_low
suffix:semicolon
r_return
id|copy_to_user
c_func
(paren
id|dest
comma
op_amp
id|rms
comma
l_int|8
)paren
suffix:semicolon
)brace
DECL|function|copy_u48_le
r_static
r_inline
r_int
id|copy_u48_le
c_func
(paren
r_void
id|__user
op_star
id|dest
comma
r_void
id|__iomem
op_star
id|src_low
comma
r_void
id|__iomem
op_star
id|src_high
)paren
(brace
id|u32
id|rms_low
comma
id|rms_high
suffix:semicolon
id|u64
id|rms
suffix:semicolon
id|rms_low
op_assign
id|readl
c_func
(paren
id|src_low
)paren
op_amp
l_int|0xffffff00
suffix:semicolon
id|rms_high
op_assign
id|readl
c_func
(paren
id|src_high
)paren
op_amp
l_int|0xffffff00
suffix:semicolon
id|rms
op_assign
(paren
(paren
id|u64
)paren
id|rms_high
op_lshift
l_int|32
)paren
op_or
id|rms_low
suffix:semicolon
r_return
id|copy_to_user
c_func
(paren
id|dest
comma
op_amp
id|rms
comma
l_int|8
)paren
suffix:semicolon
)brace
DECL|function|hdsp_9652_get_peak
r_static
r_int
id|hdsp_9652_get_peak
c_func
(paren
id|hdsp_t
op_star
id|hdsp
comma
id|hdsp_peak_rms_t
id|__user
op_star
id|peak_rms
)paren
(brace
r_int
id|doublespeed
op_assign
l_int|0
suffix:semicolon
r_int
id|i
comma
id|j
comma
id|channels
comma
id|ofs
suffix:semicolon
r_if
c_cond
(paren
id|hdsp_read
(paren
id|hdsp
comma
id|HDSP_statusRegister
)paren
op_amp
id|HDSP_DoubleSpeedStatus
)paren
id|doublespeed
op_assign
l_int|1
suffix:semicolon
id|channels
op_assign
id|doublespeed
ques
c_cond
l_int|14
suffix:colon
l_int|26
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
comma
id|j
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|26
suffix:semicolon
op_increment
id|i
)paren
(brace
r_if
c_cond
(paren
id|doublespeed
op_logical_and
(paren
id|i
op_amp
l_int|4
)paren
)paren
r_continue
suffix:semicolon
id|ofs
op_assign
id|HDSP_9652_peakBase
op_minus
id|j
op_star
l_int|4
suffix:semicolon
r_if
c_cond
(paren
id|copy_u32_le
c_func
(paren
op_amp
id|peak_rms-&gt;input_peaks
(braket
id|i
)braket
comma
id|hdsp-&gt;iobase
op_plus
id|ofs
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|ofs
op_sub_assign
id|channels
op_star
l_int|4
suffix:semicolon
r_if
c_cond
(paren
id|copy_u32_le
c_func
(paren
op_amp
id|peak_rms-&gt;playback_peaks
(braket
id|i
)braket
comma
id|hdsp-&gt;iobase
op_plus
id|ofs
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|ofs
op_sub_assign
id|channels
op_star
l_int|4
suffix:semicolon
r_if
c_cond
(paren
id|copy_u32_le
c_func
(paren
op_amp
id|peak_rms-&gt;output_peaks
(braket
id|i
)braket
comma
id|hdsp-&gt;iobase
op_plus
id|ofs
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|ofs
op_assign
id|HDSP_9652_rmsBase
op_plus
id|j
op_star
l_int|8
suffix:semicolon
r_if
c_cond
(paren
id|copy_u48_le
c_func
(paren
op_amp
id|peak_rms-&gt;input_rms
(braket
id|i
)braket
comma
id|hdsp-&gt;iobase
op_plus
id|ofs
comma
id|hdsp-&gt;iobase
op_plus
id|ofs
op_plus
l_int|4
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|ofs
op_add_assign
id|channels
op_star
l_int|8
suffix:semicolon
r_if
c_cond
(paren
id|copy_u48_le
c_func
(paren
op_amp
id|peak_rms-&gt;playback_rms
(braket
id|i
)braket
comma
id|hdsp-&gt;iobase
op_plus
id|ofs
comma
id|hdsp-&gt;iobase
op_plus
id|ofs
op_plus
l_int|4
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|ofs
op_add_assign
id|channels
op_star
l_int|8
suffix:semicolon
r_if
c_cond
(paren
id|copy_u48_le
c_func
(paren
op_amp
id|peak_rms-&gt;output_rms
(braket
id|i
)braket
comma
id|hdsp-&gt;iobase
op_plus
id|ofs
comma
id|hdsp-&gt;iobase
op_plus
id|ofs
op_plus
l_int|4
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|j
op_increment
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|hdsp_9632_get_peak
r_static
r_int
id|hdsp_9632_get_peak
c_func
(paren
id|hdsp_t
op_star
id|hdsp
comma
id|hdsp_peak_rms_t
id|__user
op_star
id|peak_rms
)paren
(brace
r_int
id|i
comma
id|j
suffix:semicolon
id|hdsp_9632_meters_t
id|__iomem
op_star
id|m
suffix:semicolon
r_int
id|doublespeed
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|hdsp_read
(paren
id|hdsp
comma
id|HDSP_statusRegister
)paren
op_amp
id|HDSP_DoubleSpeedStatus
)paren
id|doublespeed
op_assign
l_int|1
suffix:semicolon
id|m
op_assign
(paren
id|hdsp_9632_meters_t
id|__iomem
op_star
)paren
(paren
id|hdsp-&gt;iobase
op_plus
id|HDSP_9632_metersBase
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
comma
id|j
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|16
suffix:semicolon
op_increment
id|i
comma
op_increment
id|j
)paren
(brace
r_if
c_cond
(paren
id|copy_u32_le
c_func
(paren
op_amp
id|peak_rms-&gt;input_peaks
(braket
id|i
)braket
comma
op_amp
id|m-&gt;input_peak
(braket
id|j
)braket
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
id|copy_u32_le
c_func
(paren
op_amp
id|peak_rms-&gt;playback_peaks
(braket
id|i
)braket
comma
op_amp
id|m-&gt;playback_peak
(braket
id|j
)braket
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
id|copy_u32_le
c_func
(paren
op_amp
id|peak_rms-&gt;output_peaks
(braket
id|i
)braket
comma
op_amp
id|m-&gt;output_peak
(braket
id|j
)braket
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
id|copy_u64_le
c_func
(paren
op_amp
id|peak_rms-&gt;input_rms
(braket
id|i
)braket
comma
op_amp
id|m-&gt;input_rms_low
(braket
id|j
)braket
comma
op_amp
id|m-&gt;input_rms_high
(braket
id|j
)braket
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
id|copy_u64_le
c_func
(paren
op_amp
id|peak_rms-&gt;playback_rms
(braket
id|i
)braket
comma
op_amp
id|m-&gt;playback_rms_low
(braket
id|j
)braket
comma
op_amp
id|m-&gt;playback_rms_high
(braket
id|j
)braket
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
id|copy_u64_le
c_func
(paren
op_amp
id|peak_rms-&gt;output_rms
(braket
id|i
)braket
comma
op_amp
id|m-&gt;output_rms_low
(braket
id|j
)braket
comma
op_amp
id|m-&gt;output_rms_high
(braket
id|j
)braket
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
id|doublespeed
op_logical_and
id|i
op_eq
l_int|3
)paren
id|i
op_add_assign
l_int|4
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|hdsp_get_peak
r_static
r_int
id|hdsp_get_peak
c_func
(paren
id|hdsp_t
op_star
id|hdsp
comma
id|hdsp_peak_rms_t
id|__user
op_star
id|peak_rms
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|26
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|copy_u32_le
c_func
(paren
op_amp
id|peak_rms-&gt;playback_peaks
(braket
id|i
)braket
comma
id|hdsp-&gt;iobase
op_plus
id|HDSP_playbackPeakLevel
op_plus
id|i
op_star
l_int|4
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
id|copy_u32_le
c_func
(paren
op_amp
id|peak_rms-&gt;input_peaks
(braket
id|i
)braket
comma
id|hdsp-&gt;iobase
op_plus
id|HDSP_inputPeakLevel
op_plus
id|i
op_star
l_int|4
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|28
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|copy_u32_le
c_func
(paren
op_amp
id|peak_rms-&gt;output_peaks
(braket
id|i
)braket
comma
id|hdsp-&gt;iobase
op_plus
id|HDSP_outputPeakLevel
op_plus
id|i
op_star
l_int|4
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|26
suffix:semicolon
op_increment
id|i
)paren
(brace
r_if
c_cond
(paren
id|copy_u64_le
c_func
(paren
op_amp
id|peak_rms-&gt;playback_rms
(braket
id|i
)braket
comma
id|hdsp-&gt;iobase
op_plus
id|HDSP_playbackRmsLevel
op_plus
id|i
op_star
l_int|8
comma
id|hdsp-&gt;iobase
op_plus
id|HDSP_playbackRmsLevel
op_plus
id|i
op_star
l_int|8
op_plus
l_int|4
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
id|copy_u64_le
c_func
(paren
op_amp
id|peak_rms-&gt;input_rms
(braket
id|i
)braket
comma
id|hdsp-&gt;iobase
op_plus
id|HDSP_inputRmsLevel
op_plus
id|i
op_star
l_int|8
comma
id|hdsp-&gt;iobase
op_plus
id|HDSP_inputRmsLevel
op_plus
id|i
op_star
l_int|8
op_plus
l_int|4
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_hwdep_ioctl
r_static
r_int
id|snd_hdsp_hwdep_ioctl
c_func
(paren
id|snd_hwdep_t
op_star
id|hw
comma
r_struct
id|file
op_star
id|file
comma
r_int
r_int
id|cmd
comma
r_int
r_int
id|arg
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
(paren
id|hdsp_t
op_star
)paren
id|hw-&gt;private_data
suffix:semicolon
r_void
id|__user
op_star
id|argp
op_assign
(paren
r_void
id|__user
op_star
)paren
id|arg
suffix:semicolon
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|SNDRV_HDSP_IOCTL_GET_PEAK_RMS
suffix:colon
(brace
id|hdsp_peak_rms_t
id|__user
op_star
id|peak_rms
op_assign
(paren
id|hdsp_peak_rms_t
id|__user
op_star
)paren
id|arg
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|hdsp-&gt;state
op_amp
id|HDSP_FirmwareLoaded
)paren
)paren
(brace
id|snd_printk
c_func
(paren
id|KERN_ERR
l_string|&quot;firmware needs to be uploaded to the card.&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|hdsp-&gt;io_type
)paren
(brace
r_case
id|H9652
suffix:colon
r_return
id|hdsp_9652_get_peak
c_func
(paren
id|hdsp
comma
id|peak_rms
)paren
suffix:semicolon
r_case
id|H9632
suffix:colon
r_return
id|hdsp_9632_get_peak
c_func
(paren
id|hdsp
comma
id|peak_rms
)paren
suffix:semicolon
r_default
suffix:colon
r_return
id|hdsp_get_peak
c_func
(paren
id|hdsp
comma
id|peak_rms
)paren
suffix:semicolon
)brace
)brace
r_case
id|SNDRV_HDSP_IOCTL_GET_CONFIG_INFO
suffix:colon
(brace
id|hdsp_config_info_t
id|info
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|hdsp-&gt;state
op_amp
id|HDSP_FirmwareLoaded
)paren
)paren
(brace
id|snd_printk
c_func
(paren
l_string|&quot;Firmware needs to be uploaded to the card.&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|spin_lock_irqsave
c_func
(paren
op_amp
id|hdsp-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|info.pref_sync_ref
op_assign
(paren
r_int
r_char
)paren
id|hdsp_pref_sync_ref
c_func
(paren
id|hdsp
)paren
suffix:semicolon
id|info.wordclock_sync_check
op_assign
(paren
r_int
r_char
)paren
id|hdsp_wc_sync_check
c_func
(paren
id|hdsp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hdsp-&gt;io_type
op_ne
id|H9632
)paren
(brace
id|info.adatsync_sync_check
op_assign
(paren
r_int
r_char
)paren
id|hdsp_adatsync_sync_check
c_func
(paren
id|hdsp
)paren
suffix:semicolon
)brace
id|info.spdif_sync_check
op_assign
(paren
r_int
r_char
)paren
id|hdsp_spdif_sync_check
c_func
(paren
id|hdsp
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
(paren
(paren
id|hdsp-&gt;io_type
op_ne
id|Multiface
op_logical_and
id|hdsp-&gt;io_type
op_ne
id|H9632
)paren
ques
c_cond
l_int|3
suffix:colon
l_int|1
)paren
suffix:semicolon
op_increment
id|i
)paren
(brace
id|info.adat_sync_check
(braket
id|i
)braket
op_assign
(paren
r_int
r_char
)paren
id|hdsp_adat_sync_check
c_func
(paren
id|hdsp
comma
id|i
)paren
suffix:semicolon
)brace
id|info.spdif_in
op_assign
(paren
r_int
r_char
)paren
id|hdsp_spdif_in
c_func
(paren
id|hdsp
)paren
suffix:semicolon
id|info.spdif_out
op_assign
(paren
r_int
r_char
)paren
id|hdsp_spdif_out
c_func
(paren
id|hdsp
)paren
suffix:semicolon
id|info.spdif_professional
op_assign
(paren
r_int
r_char
)paren
id|hdsp_spdif_professional
c_func
(paren
id|hdsp
)paren
suffix:semicolon
id|info.spdif_emphasis
op_assign
(paren
r_int
r_char
)paren
id|hdsp_spdif_emphasis
c_func
(paren
id|hdsp
)paren
suffix:semicolon
id|info.spdif_nonaudio
op_assign
(paren
r_int
r_char
)paren
id|hdsp_spdif_nonaudio
c_func
(paren
id|hdsp
)paren
suffix:semicolon
id|info.spdif_sample_rate
op_assign
id|hdsp_spdif_sample_rate
c_func
(paren
id|hdsp
)paren
suffix:semicolon
id|info.system_sample_rate
op_assign
id|hdsp-&gt;system_sample_rate
suffix:semicolon
id|info.autosync_sample_rate
op_assign
id|hdsp_external_sample_rate
c_func
(paren
id|hdsp
)paren
suffix:semicolon
id|info.system_clock_mode
op_assign
(paren
r_int
r_char
)paren
id|hdsp_system_clock_mode
c_func
(paren
id|hdsp
)paren
suffix:semicolon
id|info.clock_source
op_assign
(paren
r_int
r_char
)paren
id|hdsp_clock_source
c_func
(paren
id|hdsp
)paren
suffix:semicolon
id|info.autosync_ref
op_assign
(paren
r_int
r_char
)paren
id|hdsp_autosync_ref
c_func
(paren
id|hdsp
)paren
suffix:semicolon
id|info.line_out
op_assign
(paren
r_int
r_char
)paren
id|hdsp_line_out
c_func
(paren
id|hdsp
)paren
suffix:semicolon
id|info.passthru
op_assign
(paren
r_int
r_char
)paren
id|hdsp-&gt;passthru
suffix:semicolon
r_if
c_cond
(paren
id|hdsp-&gt;io_type
op_eq
id|H9632
)paren
(brace
id|info.da_gain
op_assign
(paren
r_int
r_char
)paren
id|hdsp_da_gain
c_func
(paren
id|hdsp
)paren
suffix:semicolon
id|info.ad_gain
op_assign
(paren
r_int
r_char
)paren
id|hdsp_ad_gain
c_func
(paren
id|hdsp
)paren
suffix:semicolon
id|info.phone_gain
op_assign
(paren
r_int
r_char
)paren
id|hdsp_phone_gain
c_func
(paren
id|hdsp
)paren
suffix:semicolon
id|info.xlr_breakout_cable
op_assign
(paren
r_int
r_char
)paren
id|hdsp_xlr_breakout_cable
c_func
(paren
id|hdsp
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|hdsp-&gt;io_type
op_eq
id|H9632
op_logical_or
id|hdsp-&gt;io_type
op_eq
id|H9652
)paren
(brace
id|info.analog_extension_board
op_assign
(paren
r_int
r_char
)paren
id|hdsp_aeb
c_func
(paren
id|hdsp
)paren
suffix:semicolon
)brace
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|hdsp-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|argp
comma
op_amp
id|info
comma
r_sizeof
(paren
id|info
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|SNDRV_HDSP_IOCTL_GET_9632_AEB
suffix:colon
(brace
id|hdsp_9632_aeb_t
id|h9632_aeb
suffix:semicolon
r_if
c_cond
(paren
id|hdsp-&gt;io_type
op_ne
id|H9632
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|h9632_aeb.aebi
op_assign
id|hdsp-&gt;ss_in_channels
op_minus
id|H9632_SS_CHANNELS
suffix:semicolon
id|h9632_aeb.aebo
op_assign
id|hdsp-&gt;ss_out_channels
op_minus
id|H9632_SS_CHANNELS
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|argp
comma
op_amp
id|h9632_aeb
comma
r_sizeof
(paren
id|h9632_aeb
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|SNDRV_HDSP_IOCTL_GET_VERSION
suffix:colon
(brace
id|hdsp_version_t
id|hdsp_version
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
id|hdsp-&gt;io_type
op_eq
id|H9652
op_logical_or
id|hdsp-&gt;io_type
op_eq
id|H9632
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|hdsp-&gt;io_type
op_eq
id|Undefined
)paren
(brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|hdsp_get_iobox_version
c_func
(paren
id|hdsp
)paren
)paren
OL
l_int|0
)paren
(brace
r_return
id|err
suffix:semicolon
)brace
)brace
id|hdsp_version.io_type
op_assign
id|hdsp-&gt;io_type
suffix:semicolon
id|hdsp_version.firmware_rev
op_assign
id|hdsp-&gt;firmware_rev
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|copy_to_user
c_func
(paren
id|argp
comma
op_amp
id|hdsp_version
comma
r_sizeof
(paren
id|hdsp_version
)paren
)paren
)paren
)paren
(brace
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
r_break
suffix:semicolon
)brace
macro_line|#ifndef HDSP_FW_LOADER
r_case
id|SNDRV_HDSP_IOCTL_UPLOAD_FIRMWARE
suffix:colon
(brace
id|hdsp_firmware_t
id|__user
op_star
id|firmware
suffix:semicolon
id|u32
id|__user
op_star
id|firmware_data
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
id|hdsp-&gt;io_type
op_eq
id|H9652
op_logical_or
id|hdsp-&gt;io_type
op_eq
id|H9632
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
multiline_comment|/* SNDRV_HDSP_IOCTL_GET_VERSION must have been called */
r_if
c_cond
(paren
id|hdsp-&gt;io_type
op_eq
id|Undefined
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|hdsp-&gt;state
op_amp
(paren
id|HDSP_FirmwareCached
op_or
id|HDSP_FirmwareLoaded
)paren
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
id|snd_printk
c_func
(paren
l_string|&quot;initializing firmware upload&bslash;n&quot;
)paren
suffix:semicolon
id|firmware
op_assign
(paren
id|hdsp_firmware_t
id|__user
op_star
)paren
id|argp
suffix:semicolon
r_if
c_cond
(paren
id|get_user
c_func
(paren
id|firmware_data
comma
op_amp
id|firmware-&gt;firmware_data
)paren
)paren
(brace
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
r_if
c_cond
(paren
id|hdsp_check_for_iobox
(paren
id|hdsp
)paren
)paren
(brace
r_return
op_minus
id|EIO
suffix:semicolon
)brace
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
id|hdsp-&gt;firmware_cache
comma
id|firmware_data
comma
r_sizeof
(paren
id|hdsp-&gt;firmware_cache
)paren
)paren
op_ne
l_int|0
)paren
(brace
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
id|hdsp-&gt;state
op_or_assign
id|HDSP_FirmwareCached
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_hdsp_load_firmware_from_cache
c_func
(paren
id|hdsp
)paren
)paren
OL
l_int|0
)paren
(brace
r_return
id|err
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|hdsp-&gt;state
op_amp
id|HDSP_InitializationComplete
)paren
)paren
(brace
id|snd_hdsp_initialize_channels
c_func
(paren
id|hdsp
)paren
suffix:semicolon
id|snd_hdsp_initialize_midi_flush
c_func
(paren
id|hdsp
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_hdsp_create_alsa_devices
c_func
(paren
id|hdsp-&gt;card
comma
id|hdsp
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_printk
c_func
(paren
l_string|&quot;error creating alsa devices&bslash;n&quot;
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
)brace
r_break
suffix:semicolon
)brace
macro_line|#endif
r_case
id|SNDRV_HDSP_IOCTL_GET_MIXER
suffix:colon
(brace
id|hdsp_mixer_t
id|__user
op_star
id|mixer
op_assign
(paren
id|hdsp_mixer_t
id|__user
op_star
)paren
id|argp
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|mixer-&gt;matrix
comma
id|hdsp-&gt;mixer_matrix
comma
r_sizeof
(paren
r_int
r_int
)paren
op_star
id|HDSP_MATRIX_MIXER_SIZE
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_break
suffix:semicolon
)brace
r_default
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|snd_hdsp_playback_ops
r_static
id|snd_pcm_ops_t
id|snd_hdsp_playback_ops
op_assign
(brace
dot
id|open
op_assign
id|snd_hdsp_playback_open
comma
dot
id|close
op_assign
id|snd_hdsp_playback_release
comma
dot
id|ioctl
op_assign
id|snd_hdsp_ioctl
comma
dot
id|hw_params
op_assign
id|snd_hdsp_hw_params
comma
dot
id|prepare
op_assign
id|snd_hdsp_prepare
comma
dot
id|trigger
op_assign
id|snd_hdsp_trigger
comma
dot
id|pointer
op_assign
id|snd_hdsp_hw_pointer
comma
dot
id|copy
op_assign
id|snd_hdsp_playback_copy
comma
dot
id|silence
op_assign
id|snd_hdsp_hw_silence
comma
)brace
suffix:semicolon
DECL|variable|snd_hdsp_capture_ops
r_static
id|snd_pcm_ops_t
id|snd_hdsp_capture_ops
op_assign
(brace
dot
id|open
op_assign
id|snd_hdsp_capture_open
comma
dot
id|close
op_assign
id|snd_hdsp_capture_release
comma
dot
id|ioctl
op_assign
id|snd_hdsp_ioctl
comma
dot
id|hw_params
op_assign
id|snd_hdsp_hw_params
comma
dot
id|prepare
op_assign
id|snd_hdsp_prepare
comma
dot
id|trigger
op_assign
id|snd_hdsp_trigger
comma
dot
id|pointer
op_assign
id|snd_hdsp_hw_pointer
comma
dot
id|copy
op_assign
id|snd_hdsp_capture_copy
comma
)brace
suffix:semicolon
DECL|function|snd_hdsp_create_hwdep
r_static
r_int
id|__devinit
id|snd_hdsp_create_hwdep
c_func
(paren
id|snd_card_t
op_star
id|card
comma
id|hdsp_t
op_star
id|hdsp
)paren
(brace
id|snd_hwdep_t
op_star
id|hw
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_hwdep_new
c_func
(paren
id|card
comma
l_string|&quot;HDSP hwdep&quot;
comma
l_int|0
comma
op_amp
id|hw
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|hdsp-&gt;hwdep
op_assign
id|hw
suffix:semicolon
id|hw-&gt;private_data
op_assign
id|hdsp
suffix:semicolon
id|strcpy
c_func
(paren
id|hw-&gt;name
comma
l_string|&quot;HDSP hwdep interface&quot;
)paren
suffix:semicolon
id|hw-&gt;ops.open
op_assign
id|snd_hdsp_hwdep_dummy_op
suffix:semicolon
id|hw-&gt;ops.ioctl
op_assign
id|snd_hdsp_hwdep_ioctl
suffix:semicolon
id|hw-&gt;ops.release
op_assign
id|snd_hdsp_hwdep_dummy_op
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_create_pcm
r_static
r_int
id|snd_hdsp_create_pcm
c_func
(paren
id|snd_card_t
op_star
id|card
comma
id|hdsp_t
op_star
id|hdsp
)paren
(brace
id|snd_pcm_t
op_star
id|pcm
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_pcm_new
c_func
(paren
id|card
comma
id|hdsp-&gt;card_name
comma
l_int|0
comma
l_int|1
comma
l_int|1
comma
op_amp
id|pcm
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|hdsp-&gt;pcm
op_assign
id|pcm
suffix:semicolon
id|pcm-&gt;private_data
op_assign
id|hdsp
suffix:semicolon
id|strcpy
c_func
(paren
id|pcm-&gt;name
comma
id|hdsp-&gt;card_name
)paren
suffix:semicolon
id|snd_pcm_set_ops
c_func
(paren
id|pcm
comma
id|SNDRV_PCM_STREAM_PLAYBACK
comma
op_amp
id|snd_hdsp_playback_ops
)paren
suffix:semicolon
id|snd_pcm_set_ops
c_func
(paren
id|pcm
comma
id|SNDRV_PCM_STREAM_CAPTURE
comma
op_amp
id|snd_hdsp_capture_ops
)paren
suffix:semicolon
id|pcm-&gt;info_flags
op_assign
id|SNDRV_PCM_INFO_JOINT_DUPLEX
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_9652_enable_mixer
r_static
r_void
id|snd_hdsp_9652_enable_mixer
(paren
id|hdsp_t
op_star
id|hdsp
)paren
(brace
id|hdsp-&gt;control2_register
op_or_assign
id|HDSP_9652_ENABLE_MIXER
suffix:semicolon
id|hdsp_write
(paren
id|hdsp
comma
id|HDSP_control2Reg
comma
id|hdsp-&gt;control2_register
)paren
suffix:semicolon
)brace
DECL|function|snd_hdsp_enable_io
r_static
r_int
id|snd_hdsp_enable_io
(paren
id|hdsp_t
op_star
id|hdsp
)paren
(brace
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
id|hdsp_fifo_wait
(paren
id|hdsp
comma
l_int|0
comma
l_int|100
)paren
)paren
(brace
r_return
op_minus
id|EIO
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|hdsp-&gt;max_channels
suffix:semicolon
op_increment
id|i
)paren
(brace
id|hdsp_write
(paren
id|hdsp
comma
id|HDSP_inputEnable
op_plus
(paren
l_int|4
op_star
id|i
)paren
comma
l_int|1
)paren
suffix:semicolon
id|hdsp_write
(paren
id|hdsp
comma
id|HDSP_outputEnable
op_plus
(paren
l_int|4
op_star
id|i
)paren
comma
l_int|1
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_initialize_channels
r_static
r_void
id|snd_hdsp_initialize_channels
c_func
(paren
id|hdsp_t
op_star
id|hdsp
)paren
(brace
r_int
id|status
comma
id|aebi_channels
comma
id|aebo_channels
suffix:semicolon
r_switch
c_cond
(paren
id|hdsp-&gt;io_type
)paren
(brace
r_case
id|Digiface
suffix:colon
id|hdsp-&gt;card_name
op_assign
l_string|&quot;RME Hammerfall DSP + Digiface&quot;
suffix:semicolon
id|hdsp-&gt;ss_in_channels
op_assign
id|hdsp-&gt;ss_out_channels
op_assign
id|DIGIFACE_SS_CHANNELS
suffix:semicolon
id|hdsp-&gt;ds_in_channels
op_assign
id|hdsp-&gt;ds_out_channels
op_assign
id|DIGIFACE_DS_CHANNELS
suffix:semicolon
r_break
suffix:semicolon
r_case
id|H9652
suffix:colon
id|hdsp-&gt;card_name
op_assign
l_string|&quot;RME Hammerfall HDSP 9652&quot;
suffix:semicolon
id|hdsp-&gt;ss_in_channels
op_assign
id|hdsp-&gt;ss_out_channels
op_assign
id|H9652_SS_CHANNELS
suffix:semicolon
id|hdsp-&gt;ds_in_channels
op_assign
id|hdsp-&gt;ds_out_channels
op_assign
id|H9652_DS_CHANNELS
suffix:semicolon
r_break
suffix:semicolon
r_case
id|H9632
suffix:colon
id|status
op_assign
id|hdsp_read
c_func
(paren
id|hdsp
comma
id|HDSP_statusRegister
)paren
suffix:semicolon
multiline_comment|/* HDSP_AEBx bits are low when AEB are connected */
id|aebi_channels
op_assign
(paren
id|status
op_amp
id|HDSP_AEBI
)paren
ques
c_cond
l_int|0
suffix:colon
l_int|4
suffix:semicolon
id|aebo_channels
op_assign
(paren
id|status
op_amp
id|HDSP_AEBO
)paren
ques
c_cond
l_int|0
suffix:colon
l_int|4
suffix:semicolon
id|hdsp-&gt;card_name
op_assign
l_string|&quot;RME Hammerfall HDSP 9632&quot;
suffix:semicolon
id|hdsp-&gt;ss_in_channels
op_assign
id|H9632_SS_CHANNELS
op_plus
id|aebi_channels
suffix:semicolon
id|hdsp-&gt;ds_in_channels
op_assign
id|H9632_DS_CHANNELS
op_plus
id|aebi_channels
suffix:semicolon
id|hdsp-&gt;qs_in_channels
op_assign
id|H9632_QS_CHANNELS
op_plus
id|aebi_channels
suffix:semicolon
id|hdsp-&gt;ss_out_channels
op_assign
id|H9632_SS_CHANNELS
op_plus
id|aebo_channels
suffix:semicolon
id|hdsp-&gt;ds_out_channels
op_assign
id|H9632_DS_CHANNELS
op_plus
id|aebo_channels
suffix:semicolon
id|hdsp-&gt;qs_out_channels
op_assign
id|H9632_QS_CHANNELS
op_plus
id|aebo_channels
suffix:semicolon
r_break
suffix:semicolon
r_case
id|Multiface
suffix:colon
id|hdsp-&gt;card_name
op_assign
l_string|&quot;RME Hammerfall DSP + Multiface&quot;
suffix:semicolon
id|hdsp-&gt;ss_in_channels
op_assign
id|hdsp-&gt;ss_out_channels
op_assign
id|MULTIFACE_SS_CHANNELS
suffix:semicolon
id|hdsp-&gt;ds_in_channels
op_assign
id|hdsp-&gt;ds_out_channels
op_assign
id|MULTIFACE_DS_CHANNELS
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
multiline_comment|/* should never get here */
r_break
suffix:semicolon
)brace
)brace
DECL|function|snd_hdsp_initialize_midi_flush
r_static
r_void
id|snd_hdsp_initialize_midi_flush
(paren
id|hdsp_t
op_star
id|hdsp
)paren
(brace
id|snd_hdsp_flush_midi_input
(paren
id|hdsp
comma
l_int|0
)paren
suffix:semicolon
id|snd_hdsp_flush_midi_input
(paren
id|hdsp
comma
l_int|1
)paren
suffix:semicolon
)brace
DECL|function|snd_hdsp_create_alsa_devices
r_static
r_int
id|snd_hdsp_create_alsa_devices
c_func
(paren
id|snd_card_t
op_star
id|card
comma
id|hdsp_t
op_star
id|hdsp
)paren
(brace
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_hdsp_create_pcm
c_func
(paren
id|card
comma
id|hdsp
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_printk
c_func
(paren
l_string|&quot;Error creating pcm interface&bslash;n&quot;
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_hdsp_create_midi
c_func
(paren
id|card
comma
id|hdsp
comma
l_int|0
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_printk
c_func
(paren
l_string|&quot;Error creating first midi interface&bslash;n&quot;
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_hdsp_create_midi
c_func
(paren
id|card
comma
id|hdsp
comma
l_int|1
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_printk
c_func
(paren
l_string|&quot;Error creating second midi interface&bslash;n&quot;
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_hdsp_create_controls
c_func
(paren
id|card
comma
id|hdsp
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_printk
c_func
(paren
l_string|&quot;Error creating ctl interface&bslash;n&quot;
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
id|snd_hdsp_proc_init
c_func
(paren
id|hdsp
)paren
suffix:semicolon
id|hdsp-&gt;system_sample_rate
op_assign
op_minus
l_int|1
suffix:semicolon
id|hdsp-&gt;playback_pid
op_assign
op_minus
l_int|1
suffix:semicolon
id|hdsp-&gt;capture_pid
op_assign
op_minus
l_int|1
suffix:semicolon
id|hdsp-&gt;capture_substream
op_assign
l_int|NULL
suffix:semicolon
id|hdsp-&gt;playback_substream
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_hdsp_set_defaults
c_func
(paren
id|hdsp
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_printk
c_func
(paren
l_string|&quot;Error setting default values&bslash;n&quot;
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|hdsp-&gt;state
op_amp
id|HDSP_InitializationComplete
)paren
)paren
(brace
id|sprintf
c_func
(paren
id|card-&gt;longname
comma
l_string|&quot;%s at 0x%lx, irq %d&quot;
comma
id|hdsp-&gt;card_name
comma
id|hdsp-&gt;port
comma
id|hdsp-&gt;irq
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_card_register
c_func
(paren
id|card
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_printk
c_func
(paren
l_string|&quot;error registering card&bslash;n&quot;
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
id|hdsp-&gt;state
op_or_assign
id|HDSP_InitializationComplete
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#ifdef HDSP_FW_LOADER
multiline_comment|/* load firmware via hotplug fw loader */
DECL|function|hdsp_request_fw_loader
r_static
r_int
id|__devinit
id|hdsp_request_fw_loader
c_func
(paren
id|hdsp_t
op_star
id|hdsp
)paren
(brace
r_const
r_char
op_star
id|fwfile
suffix:semicolon
r_const
r_struct
id|firmware
op_star
id|fw
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
id|hdsp-&gt;io_type
op_eq
id|H9652
op_logical_or
id|hdsp-&gt;io_type
op_eq
id|H9632
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|hdsp-&gt;io_type
op_eq
id|Undefined
)paren
(brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|hdsp_get_iobox_version
c_func
(paren
id|hdsp
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_if
c_cond
(paren
id|hdsp-&gt;io_type
op_eq
id|H9652
op_logical_or
id|hdsp-&gt;io_type
op_eq
id|H9632
)paren
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|hdsp_check_for_iobox
(paren
id|hdsp
)paren
)paren
r_return
op_minus
id|EIO
suffix:semicolon
multiline_comment|/* caution: max length of firmware filename is 30! */
r_switch
c_cond
(paren
id|hdsp-&gt;io_type
)paren
(brace
r_case
id|Multiface
suffix:colon
r_if
c_cond
(paren
id|hdsp-&gt;firmware_rev
op_eq
l_int|0xa
)paren
id|fwfile
op_assign
l_string|&quot;multiface_firmware.bin&quot;
suffix:semicolon
r_else
id|fwfile
op_assign
l_string|&quot;multiface_firmware_rev11.bin&quot;
suffix:semicolon
r_break
suffix:semicolon
r_case
id|Digiface
suffix:colon
r_if
c_cond
(paren
id|hdsp-&gt;firmware_rev
op_eq
l_int|0xa
)paren
id|fwfile
op_assign
l_string|&quot;digiface_firmware.bin&quot;
suffix:semicolon
r_else
id|fwfile
op_assign
l_string|&quot;digiface_firmware_rev11.bin&quot;
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|snd_printk
c_func
(paren
id|KERN_ERR
l_string|&quot;hdsp: invalid io_type %d&bslash;n&quot;
comma
id|hdsp-&gt;io_type
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|request_firmware
c_func
(paren
op_amp
id|fw
comma
id|fwfile
comma
op_amp
id|hdsp-&gt;pci-&gt;dev
)paren
)paren
(brace
id|snd_printk
c_func
(paren
id|KERN_ERR
l_string|&quot;hdsp: cannot load firmware %s&bslash;n&quot;
comma
id|fwfile
)paren
suffix:semicolon
r_return
op_minus
id|ENOENT
suffix:semicolon
)brace
r_if
c_cond
(paren
id|fw-&gt;size
OL
r_sizeof
(paren
id|hdsp-&gt;firmware_cache
)paren
)paren
(brace
id|snd_printk
c_func
(paren
id|KERN_ERR
l_string|&quot;hdsp: too short firmware size %d (expected %d)&bslash;n&quot;
comma
(paren
r_int
)paren
id|fw-&gt;size
comma
(paren
r_int
)paren
r_sizeof
(paren
id|hdsp-&gt;firmware_cache
)paren
)paren
suffix:semicolon
id|release_firmware
c_func
(paren
id|fw
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
macro_line|#ifdef SNDRV_BIG_ENDIAN
(brace
r_int
id|i
suffix:semicolon
id|u32
op_star
id|src
op_assign
id|hdsp-&gt;data
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|ARRAY_SIZE
c_func
(paren
id|hdsp-&gt;firmware_cache
)paren
suffix:semicolon
id|i
op_increment
comma
id|src
op_increment
)paren
id|hdsp-&gt;firmware_cache
(braket
id|i
)braket
op_assign
(paren
(paren
op_star
id|src
op_amp
l_int|0x000000ff
)paren
op_lshift
l_int|16
)paren
op_or
(paren
(paren
op_star
id|src
op_amp
l_int|0x0000ff00
)paren
op_lshift
l_int|8
)paren
op_or
(paren
(paren
op_star
id|src
op_amp
l_int|0x00ff0000
)paren
op_rshift
l_int|8
)paren
op_or
(paren
(paren
op_star
id|src
op_amp
l_int|0xff000000
)paren
op_rshift
l_int|16
)paren
suffix:semicolon
)brace
macro_line|#else
id|memcpy
c_func
(paren
id|hdsp-&gt;firmware_cache
comma
id|fw-&gt;data
comma
r_sizeof
(paren
id|hdsp-&gt;firmware_cache
)paren
)paren
suffix:semicolon
macro_line|#endif
id|release_firmware
c_func
(paren
id|fw
)paren
suffix:semicolon
id|hdsp-&gt;state
op_or_assign
id|HDSP_FirmwareCached
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_hdsp_load_firmware_from_cache
c_func
(paren
id|hdsp
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|hdsp-&gt;state
op_amp
id|HDSP_InitializationComplete
)paren
)paren
(brace
id|snd_hdsp_initialize_channels
c_func
(paren
id|hdsp
)paren
suffix:semicolon
id|snd_hdsp_initialize_midi_flush
c_func
(paren
id|hdsp
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_hdsp_create_alsa_devices
c_func
(paren
id|hdsp-&gt;card
comma
id|hdsp
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_printk
c_func
(paren
l_string|&quot;error creating alsa devices&bslash;n&quot;
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#endif
DECL|function|snd_hdsp_create
r_static
r_int
id|__devinit
id|snd_hdsp_create
c_func
(paren
id|snd_card_t
op_star
id|card
comma
id|hdsp_t
op_star
id|hdsp
comma
r_int
id|precise_ptr
)paren
(brace
r_struct
id|pci_dev
op_star
id|pci
op_assign
id|hdsp-&gt;pci
suffix:semicolon
r_int
id|err
suffix:semicolon
r_int
id|is_9652
op_assign
l_int|0
suffix:semicolon
r_int
id|is_9632
op_assign
l_int|0
suffix:semicolon
id|hdsp-&gt;irq
op_assign
op_minus
l_int|1
suffix:semicolon
id|hdsp-&gt;state
op_assign
l_int|0
suffix:semicolon
id|hdsp-&gt;midi
(braket
l_int|0
)braket
dot
id|rmidi
op_assign
l_int|NULL
suffix:semicolon
id|hdsp-&gt;midi
(braket
l_int|1
)braket
dot
id|rmidi
op_assign
l_int|NULL
suffix:semicolon
id|hdsp-&gt;midi
(braket
l_int|0
)braket
dot
id|input
op_assign
l_int|NULL
suffix:semicolon
id|hdsp-&gt;midi
(braket
l_int|1
)braket
dot
id|input
op_assign
l_int|NULL
suffix:semicolon
id|hdsp-&gt;midi
(braket
l_int|0
)braket
dot
id|output
op_assign
l_int|NULL
suffix:semicolon
id|hdsp-&gt;midi
(braket
l_int|1
)braket
dot
id|output
op_assign
l_int|NULL
suffix:semicolon
id|spin_lock_init
c_func
(paren
op_amp
id|hdsp-&gt;midi
(braket
l_int|0
)braket
dot
id|lock
)paren
suffix:semicolon
id|spin_lock_init
c_func
(paren
op_amp
id|hdsp-&gt;midi
(braket
l_int|1
)braket
dot
id|lock
)paren
suffix:semicolon
id|hdsp-&gt;iobase
op_assign
l_int|NULL
suffix:semicolon
id|hdsp-&gt;control_register
op_assign
l_int|0
suffix:semicolon
id|hdsp-&gt;control2_register
op_assign
l_int|0
suffix:semicolon
id|hdsp-&gt;io_type
op_assign
id|Undefined
suffix:semicolon
id|hdsp-&gt;max_channels
op_assign
l_int|26
suffix:semicolon
id|hdsp-&gt;card
op_assign
id|card
suffix:semicolon
id|spin_lock_init
c_func
(paren
op_amp
id|hdsp-&gt;lock
)paren
suffix:semicolon
id|tasklet_init
c_func
(paren
op_amp
id|hdsp-&gt;midi_tasklet
comma
id|hdsp_midi_tasklet
comma
(paren
r_int
r_int
)paren
id|hdsp
)paren
suffix:semicolon
id|pci_read_config_word
c_func
(paren
id|hdsp-&gt;pci
comma
id|PCI_CLASS_REVISION
comma
op_amp
id|hdsp-&gt;firmware_rev
)paren
suffix:semicolon
multiline_comment|/* From Martin Bjoernsen :&n;&t;    &quot;It is important that the card&squot;s latency timer register in&n;&t;    the PCI configuration space is set to a value much larger&n;&t;    than 0 by the computer&squot;s BIOS or the driver.&n;&t;    The windows driver always sets this 8 bit register [...]&n;&t;    to its maximum 255 to avoid problems with some computers.&quot;&n;&t;*/
id|pci_write_config_byte
c_func
(paren
id|hdsp-&gt;pci
comma
id|PCI_LATENCY_TIMER
comma
l_int|0xFF
)paren
suffix:semicolon
id|strcpy
c_func
(paren
id|card-&gt;driver
comma
l_string|&quot;H-DSP&quot;
)paren
suffix:semicolon
id|strcpy
c_func
(paren
id|card-&gt;mixername
comma
l_string|&quot;Xilinx FPGA&quot;
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|hdsp-&gt;firmware_rev
op_amp
l_int|0xff
)paren
(brace
r_case
l_int|0xa
suffix:colon
r_case
l_int|0xb
suffix:colon
r_case
l_int|0x32
suffix:colon
id|hdsp-&gt;card_name
op_assign
l_string|&quot;RME Hammerfall DSP&quot;
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x64
suffix:colon
r_case
l_int|0x65
suffix:colon
r_case
l_int|0x68
suffix:colon
id|hdsp-&gt;card_name
op_assign
l_string|&quot;RME HDSP 9652&quot;
suffix:semicolon
id|is_9652
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x96
suffix:colon
r_case
l_int|0x97
suffix:colon
id|hdsp-&gt;card_name
op_assign
l_string|&quot;RME HDSP 9632&quot;
suffix:semicolon
id|hdsp-&gt;max_channels
op_assign
l_int|16
suffix:semicolon
id|is_9632
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
id|ENODEV
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|pci_enable_device
c_func
(paren
id|pci
)paren
)paren
OL
l_int|0
)paren
(brace
r_return
id|err
suffix:semicolon
)brace
id|pci_set_master
c_func
(paren
id|hdsp-&gt;pci
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|pci_request_regions
c_func
(paren
id|pci
comma
l_string|&quot;hdsp&quot;
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|hdsp-&gt;port
op_assign
id|pci_resource_start
c_func
(paren
id|pci
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|hdsp-&gt;iobase
op_assign
id|ioremap_nocache
c_func
(paren
id|hdsp-&gt;port
comma
id|HDSP_IO_EXTENT
)paren
)paren
op_eq
l_int|NULL
)paren
(brace
id|snd_printk
c_func
(paren
l_string|&quot;unable to remap region 0x%lx-0x%lx&bslash;n&quot;
comma
id|hdsp-&gt;port
comma
id|hdsp-&gt;port
op_plus
id|HDSP_IO_EXTENT
op_minus
l_int|1
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
r_if
c_cond
(paren
id|request_irq
c_func
(paren
id|pci-&gt;irq
comma
id|snd_hdsp_interrupt
comma
id|SA_INTERRUPT
op_or
id|SA_SHIRQ
comma
l_string|&quot;hdsp&quot;
comma
(paren
r_void
op_star
)paren
id|hdsp
)paren
)paren
(brace
id|snd_printk
c_func
(paren
l_string|&quot;unable to use IRQ %d&bslash;n&quot;
comma
id|pci-&gt;irq
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
id|hdsp-&gt;irq
op_assign
id|pci-&gt;irq
suffix:semicolon
id|hdsp-&gt;precise_ptr
op_assign
id|precise_ptr
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_hdsp_initialize_memory
c_func
(paren
id|hdsp
)paren
)paren
OL
l_int|0
)paren
(brace
r_return
id|err
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|is_9652
op_logical_and
op_logical_neg
id|is_9632
op_logical_and
id|hdsp_check_for_iobox
(paren
id|hdsp
)paren
)paren
(brace
multiline_comment|/* no iobox connected, we defer initialization */
id|snd_printk
c_func
(paren
l_string|&quot;card initialization pending : waiting for firmware&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_hdsp_create_hwdep
c_func
(paren
id|card
comma
id|hdsp
)paren
)paren
OL
l_int|0
)paren
(brace
r_return
id|err
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_hdsp_enable_io
c_func
(paren
id|hdsp
)paren
)paren
op_ne
l_int|0
)paren
(brace
r_return
id|err
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|hdsp_read
(paren
id|hdsp
comma
id|HDSP_statusRegister
)paren
op_amp
id|HDSP_DllError
)paren
op_ne
l_int|0
)paren
(brace
macro_line|#ifdef HDSP_FW_LOADER
r_if
c_cond
(paren
(paren
id|err
op_assign
id|hdsp_request_fw_loader
c_func
(paren
id|hdsp
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
macro_line|#else
id|snd_printk
c_func
(paren
l_string|&quot;card initialization pending : waiting for firmware&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_hdsp_create_hwdep
c_func
(paren
id|card
comma
id|hdsp
)paren
)paren
OL
l_int|0
)paren
(brace
r_return
id|err
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
macro_line|#endif
)brace
id|snd_printk
c_func
(paren
l_string|&quot;Firmware already loaded, initializing card.&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hdsp_read
c_func
(paren
id|hdsp
comma
id|HDSP_status2Register
)paren
op_amp
id|HDSP_version1
)paren
(brace
id|hdsp-&gt;io_type
op_assign
id|Multiface
suffix:semicolon
)brace
r_else
(brace
id|hdsp-&gt;io_type
op_assign
id|Digiface
suffix:semicolon
)brace
r_if
c_cond
(paren
id|is_9652
)paren
(brace
id|hdsp-&gt;io_type
op_assign
id|H9652
suffix:semicolon
)brace
r_if
c_cond
(paren
id|is_9632
)paren
(brace
id|hdsp-&gt;io_type
op_assign
id|H9632
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_hdsp_create_hwdep
c_func
(paren
id|card
comma
id|hdsp
)paren
)paren
OL
l_int|0
)paren
(brace
r_return
id|err
suffix:semicolon
)brace
id|snd_hdsp_initialize_channels
c_func
(paren
id|hdsp
)paren
suffix:semicolon
id|snd_hdsp_initialize_midi_flush
c_func
(paren
id|hdsp
)paren
suffix:semicolon
id|hdsp-&gt;state
op_or_assign
id|HDSP_FirmwareLoaded
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_hdsp_create_alsa_devices
c_func
(paren
id|card
comma
id|hdsp
)paren
)paren
OL
l_int|0
)paren
(brace
r_return
id|err
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_free
r_static
r_int
id|snd_hdsp_free
c_func
(paren
id|hdsp_t
op_star
id|hdsp
)paren
(brace
r_if
c_cond
(paren
id|hdsp-&gt;port
)paren
(brace
multiline_comment|/* stop the audio, and cancel all interrupts */
id|hdsp-&gt;control_register
op_and_assign
op_complement
(paren
id|HDSP_Start
op_or
id|HDSP_AudioInterruptEnable
op_or
id|HDSP_Midi0InterruptEnable
op_or
id|HDSP_Midi1InterruptEnable
)paren
suffix:semicolon
id|hdsp_write
(paren
id|hdsp
comma
id|HDSP_controlRegister
comma
id|hdsp-&gt;control_register
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|hdsp-&gt;irq
op_ge
l_int|0
)paren
id|free_irq
c_func
(paren
id|hdsp-&gt;irq
comma
(paren
r_void
op_star
)paren
id|hdsp
)paren
suffix:semicolon
id|snd_hdsp_free_buffers
c_func
(paren
id|hdsp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hdsp-&gt;iobase
)paren
id|iounmap
c_func
(paren
id|hdsp-&gt;iobase
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hdsp-&gt;port
)paren
id|pci_release_regions
c_func
(paren
id|hdsp-&gt;pci
)paren
suffix:semicolon
id|pci_disable_device
c_func
(paren
id|hdsp-&gt;pci
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_card_free
r_static
r_void
id|snd_hdsp_card_free
c_func
(paren
id|snd_card_t
op_star
id|card
)paren
(brace
id|hdsp_t
op_star
id|hdsp
op_assign
(paren
id|hdsp_t
op_star
)paren
id|card-&gt;private_data
suffix:semicolon
r_if
c_cond
(paren
id|hdsp
)paren
id|snd_hdsp_free
c_func
(paren
id|hdsp
)paren
suffix:semicolon
)brace
DECL|function|snd_hdsp_probe
r_static
r_int
id|__devinit
id|snd_hdsp_probe
c_func
(paren
r_struct
id|pci_dev
op_star
id|pci
comma
r_const
r_struct
id|pci_device_id
op_star
id|pci_id
)paren
(brace
r_static
r_int
id|dev
suffix:semicolon
id|hdsp_t
op_star
id|hdsp
suffix:semicolon
id|snd_card_t
op_star
id|card
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
id|dev
op_ge
id|SNDRV_CARDS
)paren
r_return
op_minus
id|ENODEV
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|enable
(braket
id|dev
)braket
)paren
(brace
id|dev
op_increment
suffix:semicolon
r_return
op_minus
id|ENOENT
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|card
op_assign
id|snd_card_new
c_func
(paren
id|index
(braket
id|dev
)braket
comma
id|id
(braket
id|dev
)braket
comma
id|THIS_MODULE
comma
r_sizeof
(paren
id|hdsp_t
)paren
)paren
)paren
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|hdsp
op_assign
(paren
id|hdsp_t
op_star
)paren
id|card-&gt;private_data
suffix:semicolon
id|card-&gt;private_free
op_assign
id|snd_hdsp_card_free
suffix:semicolon
id|hdsp-&gt;dev
op_assign
id|dev
suffix:semicolon
id|hdsp-&gt;pci
op_assign
id|pci
suffix:semicolon
id|snd_card_set_dev
c_func
(paren
id|card
comma
op_amp
id|pci-&gt;dev
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_hdsp_create
c_func
(paren
id|card
comma
id|hdsp
comma
id|precise_ptr
(braket
id|dev
)braket
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_card_free
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
id|strcpy
c_func
(paren
id|card-&gt;shortname
comma
l_string|&quot;Hammerfall DSP&quot;
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|card-&gt;longname
comma
l_string|&quot;%s at 0x%lx, irq %d&quot;
comma
id|hdsp-&gt;card_name
comma
id|hdsp-&gt;port
comma
id|hdsp-&gt;irq
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_card_register
c_func
(paren
id|card
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_card_free
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
id|pci_set_drvdata
c_func
(paren
id|pci
comma
id|card
)paren
suffix:semicolon
id|dev
op_increment
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hdsp_remove
r_static
r_void
id|__devexit
id|snd_hdsp_remove
c_func
(paren
r_struct
id|pci_dev
op_star
id|pci
)paren
(brace
id|snd_card_free
c_func
(paren
id|pci_get_drvdata
c_func
(paren
id|pci
)paren
)paren
suffix:semicolon
id|pci_set_drvdata
c_func
(paren
id|pci
comma
l_int|NULL
)paren
suffix:semicolon
)brace
DECL|variable|driver
r_static
r_struct
id|pci_driver
id|driver
op_assign
(brace
dot
id|name
op_assign
l_string|&quot;RME Hammerfall DSP&quot;
comma
dot
id|id_table
op_assign
id|snd_hdsp_ids
comma
dot
id|probe
op_assign
id|snd_hdsp_probe
comma
dot
id|remove
op_assign
id|__devexit_p
c_func
(paren
id|snd_hdsp_remove
)paren
comma
)brace
suffix:semicolon
DECL|function|alsa_card_hdsp_init
r_static
r_int
id|__init
id|alsa_card_hdsp_init
c_func
(paren
r_void
)paren
(brace
r_return
id|pci_module_init
c_func
(paren
op_amp
id|driver
)paren
suffix:semicolon
)brace
DECL|function|alsa_card_hdsp_exit
r_static
r_void
id|__exit
id|alsa_card_hdsp_exit
c_func
(paren
r_void
)paren
(brace
id|pci_unregister_driver
c_func
(paren
op_amp
id|driver
)paren
suffix:semicolon
)brace
id|module_init
c_func
(paren
id|alsa_card_hdsp_init
)paren
id|module_exit
c_func
(paren
id|alsa_card_hdsp_exit
)paren
eof
