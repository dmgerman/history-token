multiline_comment|/*&n; *   ALSA driver for RME Digi9652 audio interfaces &n; *&n; *&t;Copyright (c) 1999 IEM - Winfried Ritsch&n; *      Copyright (c) 1999-2001  Paul Davis&n; *&n; *   This program is free software; you can redistribute it and/or modify&n; *   it under the terms of the GNU General Public License as published by&n; *   the Free Software Foundation; either version 2 of the License, or&n; *   (at your option) any later version.&n; *&n; *   This program is distributed in the hope that it will be useful,&n; *   but WITHOUT ANY WARRANTY; without even the implied warranty of&n; *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; *   GNU General Public License for more details.&n; *&n; *   You should have received a copy of the GNU General Public License&n; *   along with this program; if not, write to the Free Software&n; *   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA&n; *&n; */
macro_line|#include &lt;sound/driver.h&gt;
macro_line|#include &lt;asm/io.h&gt;
macro_line|#include &lt;linux/delay.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;sound/core.h&gt;
macro_line|#include &lt;sound/control.h&gt;
macro_line|#include &lt;sound/pcm.h&gt;
macro_line|#include &lt;sound/info.h&gt;
macro_line|#include &lt;sound/asoundef.h&gt;
DECL|macro|SNDRV_GET_ID
mdefine_line|#define SNDRV_GET_ID
macro_line|#include &lt;sound/initval.h&gt;
DECL|variable|snd_index
r_static
r_int
id|snd_index
(braket
id|SNDRV_CARDS
)braket
op_assign
id|SNDRV_DEFAULT_IDX
suffix:semicolon
multiline_comment|/* Index 0-MAX */
DECL|variable|snd_id
r_static
r_char
op_star
id|snd_id
(braket
id|SNDRV_CARDS
)braket
op_assign
id|SNDRV_DEFAULT_STR
suffix:semicolon
multiline_comment|/* ID for this card */
DECL|variable|snd_enable
r_static
r_int
id|snd_enable
(braket
id|SNDRV_CARDS
)braket
op_assign
id|SNDRV_DEFAULT_ENABLE_PNP
suffix:semicolon
multiline_comment|/* Enable this card */
DECL|variable|snd_precise_ptr
r_static
r_int
id|snd_precise_ptr
(braket
id|SNDRV_CARDS
)braket
op_assign
(brace
(braket
l_int|0
dot
dot
dot
(paren
id|SNDRV_CARDS
op_minus
l_int|1
)paren
)braket
op_assign
l_int|0
)brace
suffix:semicolon
multiline_comment|/* Enable precise pointer */
id|EXPORT_NO_SYMBOLS
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|snd_index
comma
l_string|&quot;1-&quot;
id|__MODULE_STRING
c_func
(paren
id|SNDRV_CARDS
)paren
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|snd_index
comma
l_string|&quot;Index value for RME Digi9652 (Hammerfall) soundcard.&quot;
)paren
suffix:semicolon
id|MODULE_PARM_SYNTAX
c_func
(paren
id|snd_index
comma
id|SNDRV_INDEX_DESC
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|snd_id
comma
l_string|&quot;1-&quot;
id|__MODULE_STRING
c_func
(paren
id|SNDRV_CARDS
)paren
l_string|&quot;s&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|snd_id
comma
l_string|&quot;ID string for RME Digi9652 (Hammerfall) soundcard.&quot;
)paren
suffix:semicolon
id|MODULE_PARM_SYNTAX
c_func
(paren
id|snd_id
comma
id|SNDRV_ID_DESC
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|snd_enable
comma
l_string|&quot;1-&quot;
id|__MODULE_STRING
c_func
(paren
id|SNDRV_CARDS
)paren
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|snd_enable
comma
l_string|&quot;Enable/disable specific RME96{52,36} soundcards.&quot;
)paren
suffix:semicolon
id|MODULE_PARM_SYNTAX
c_func
(paren
id|snd_enable
comma
id|SNDRV_ENABLE_DESC
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|snd_precise_ptr
comma
l_string|&quot;1-&quot;
id|__MODULE_STRING
c_func
(paren
id|SNDRV_CARDS
)paren
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|snd_precise_ptr
comma
l_string|&quot;Enable precise pointer (doesn&squot;t work reliably).&quot;
)paren
suffix:semicolon
id|MODULE_PARM_SYNTAX
c_func
(paren
id|snd_precise_ptr
comma
id|SNDRV_ENABLED
l_string|&quot;,&quot;
id|SNDRV_BOOLEAN_FALSE_DESC
)paren
suffix:semicolon
id|MODULE_AUTHOR
c_func
(paren
l_string|&quot;Paul Davis &lt;pbd@op.net&gt;, Winfried Ritsch&quot;
)paren
suffix:semicolon
id|MODULE_DESCRIPTION
c_func
(paren
l_string|&quot;RME Digi9652/Digi9636&quot;
)paren
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
id|MODULE_CLASSES
c_func
(paren
l_string|&quot;{sound}&quot;
)paren
suffix:semicolon
id|MODULE_DEVICES
c_func
(paren
l_string|&quot;{{RME,Hammerfall},&quot;
l_string|&quot;{RME,Hammerfall-Light}}&quot;
)paren
suffix:semicolon
multiline_comment|/* The Hammerfall has two sets of 24 ADAT + 2 S/PDIF channels, one for&n;   capture, one for playback. Both the ADAT and S/PDIF channels appear&n;   to the host CPU in the same block of memory. There is no functional&n;   difference between them in terms of access.&n;   &n;   The Hammerfall Light is identical to the Hammerfall, except that it&n;   has 2 sets 18 channels (16 ADAT + 2 S/PDIF) for capture and playback.&n;*/
DECL|macro|RME9652_NCHANNELS
mdefine_line|#define RME9652_NCHANNELS       26
DECL|macro|RME9636_NCHANNELS
mdefine_line|#define RME9636_NCHANNELS       18
multiline_comment|/* Preferred sync source choices - used by &quot;sync_pref&quot; control switch */
DECL|macro|RME9652_SYNC_FROM_SPDIF
mdefine_line|#define RME9652_SYNC_FROM_SPDIF 0
DECL|macro|RME9652_SYNC_FROM_ADAT1
mdefine_line|#define RME9652_SYNC_FROM_ADAT1 1
DECL|macro|RME9652_SYNC_FROM_ADAT2
mdefine_line|#define RME9652_SYNC_FROM_ADAT2 2
DECL|macro|RME9652_SYNC_FROM_ADAT3
mdefine_line|#define RME9652_SYNC_FROM_ADAT3 3
multiline_comment|/* Possible sources of S/PDIF input */
DECL|macro|RME9652_SPDIFIN_OPTICAL
mdefine_line|#define RME9652_SPDIFIN_OPTICAL 0&t;/* optical (ADAT1) */
DECL|macro|RME9652_SPDIFIN_COAXIAL
mdefine_line|#define RME9652_SPDIFIN_COAXIAL 1&t;/* coaxial (RCA) */
DECL|macro|RME9652_SPDIFIN_INTERN
mdefine_line|#define RME9652_SPDIFIN_INTERN  2&t;/* internal (CDROM) */
multiline_comment|/* ------------- Status-Register bits --------------------- */
DECL|macro|RME9652_IRQ
mdefine_line|#define RME9652_IRQ&t;   (1&lt;&lt;0)&t;/* IRQ is High if not reset by irq_clear */
DECL|macro|RME9652_lock_2
mdefine_line|#define RME9652_lock_2&t;   (1&lt;&lt;1)&t;/* ADAT 3-PLL: 1=locked, 0=unlocked */
DECL|macro|RME9652_lock_1
mdefine_line|#define RME9652_lock_1&t;   (1&lt;&lt;2)&t;/* ADAT 2-PLL: 1=locked, 0=unlocked */
DECL|macro|RME9652_lock_0
mdefine_line|#define RME9652_lock_0&t;   (1&lt;&lt;3)&t;/* ADAT 1-PLL: 1=locked, 0=unlocked */
DECL|macro|RME9652_fs48
mdefine_line|#define RME9652_fs48&t;   (1&lt;&lt;4)&t;/* sample rate is 0=44.1/88.2,1=48/96 Khz */
DECL|macro|RME9652_wsel_rd
mdefine_line|#define RME9652_wsel_rd&t;   (1&lt;&lt;5)&t;/* if Word-Clock is used and valid then 1 */
multiline_comment|/* bits 6-15 encode h/w buffer pointer position */
DECL|macro|RME9652_sync_2
mdefine_line|#define RME9652_sync_2&t;   (1&lt;&lt;16)&t;/* if ADAT-IN 3 in sync to system clock */
DECL|macro|RME9652_sync_1
mdefine_line|#define RME9652_sync_1&t;   (1&lt;&lt;17)&t;/* if ADAT-IN 2 in sync to system clock */
DECL|macro|RME9652_sync_0
mdefine_line|#define RME9652_sync_0&t;   (1&lt;&lt;18)&t;/* if ADAT-IN 1 in sync to system clock */
DECL|macro|RME9652_DS_rd
mdefine_line|#define RME9652_DS_rd&t;   (1&lt;&lt;19)&t;/* 1=Double Speed Mode, 0=Normal Speed */
DECL|macro|RME9652_tc_busy
mdefine_line|#define RME9652_tc_busy&t;   (1&lt;&lt;20)&t;/* 1=time-code copy in progress (960ms) */
DECL|macro|RME9652_tc_out
mdefine_line|#define RME9652_tc_out&t;   (1&lt;&lt;21)&t;/* time-code out bit */
DECL|macro|RME9652_F_0
mdefine_line|#define RME9652_F_0&t;   (1&lt;&lt;22)&t;/* 000=64kHz, 100=88.2kHz, 011=96kHz  */
DECL|macro|RME9652_F_1
mdefine_line|#define RME9652_F_1&t;   (1&lt;&lt;23)&t;/* 111=32kHz, 110=44.1kHz, 101=48kHz, */
DECL|macro|RME9652_F_2
mdefine_line|#define RME9652_F_2&t;   (1&lt;&lt;24)&t;/* external Crystal Chip if ERF=1 */
DECL|macro|RME9652_ERF
mdefine_line|#define RME9652_ERF&t;   (1&lt;&lt;25)&t;/* Error-Flag of SDPIF Receiver (1=No Lock) */
DECL|macro|RME9652_buffer_id
mdefine_line|#define RME9652_buffer_id  (1&lt;&lt;26)&t;/* toggles by each interrupt on rec/play */
DECL|macro|RME9652_tc_valid
mdefine_line|#define RME9652_tc_valid   (1&lt;&lt;27)&t;/* 1 = a signal is detected on time-code input */
DECL|macro|RME9652_SPDIF_READ
mdefine_line|#define RME9652_SPDIF_READ (1&lt;&lt;28)      /* byte available from Rev 1.5+ S/PDIF interface */
DECL|macro|RME9652_sync
mdefine_line|#define RME9652_sync&t;  (RME9652_sync_0|RME9652_sync_1|RME9652_sync_2)
DECL|macro|RME9652_lock
mdefine_line|#define RME9652_lock&t;  (RME9652_lock_0|RME9652_lock_1|RME9652_lock_2)
DECL|macro|RME9652_F
mdefine_line|#define RME9652_F&t;  (RME9652_F_0|RME9652_F_1|RME9652_F_2)
DECL|macro|rme9652_decode_spdif_rate
mdefine_line|#define rme9652_decode_spdif_rate(x) ((x)&gt;&gt;22)
multiline_comment|/* Bit 6..15 : h/w buffer pointer */
DECL|macro|RME9652_buf_pos
mdefine_line|#define RME9652_buf_pos&t;  0x000FFC0
multiline_comment|/* Bits 31,30,29 are bits 5,4,3 of h/w pointer position on later&n;   Rev G EEPROMS and Rev 1.5 cards or later.&n;*/
DECL|macro|RME9652_REV15_buf_pos
mdefine_line|#define RME9652_REV15_buf_pos(x) ((((x)&amp;0xE0000000)&gt;&gt;26)|((x)&amp;RME9652_buf_pos))
macro_line|#ifndef PCI_VENDOR_ID_XILINX
DECL|macro|PCI_VENDOR_ID_XILINX
mdefine_line|#define PCI_VENDOR_ID_XILINX&t;&t;0x10ee
macro_line|#endif
macro_line|#ifndef PCI_DEVICE_ID_XILINX_HAMMERFALL
DECL|macro|PCI_DEVICE_ID_XILINX_HAMMERFALL
mdefine_line|#define PCI_DEVICE_ID_XILINX_HAMMERFALL&t;0x3fc4
macro_line|#endif
multiline_comment|/* amount of io space we remap for register access. i&squot;m not sure we&n;   even need this much, but 1K is nice round number :)&n;*/
DECL|macro|RME9652_IO_EXTENT
mdefine_line|#define RME9652_IO_EXTENT     1024
DECL|macro|RME9652_init_buffer
mdefine_line|#define RME9652_init_buffer       0
DECL|macro|RME9652_play_buffer
mdefine_line|#define RME9652_play_buffer       32&t;/* holds ptr to 26x64kBit host RAM */
DECL|macro|RME9652_rec_buffer
mdefine_line|#define RME9652_rec_buffer        36&t;/* holds ptr to 26x64kBit host RAM */
DECL|macro|RME9652_control_register
mdefine_line|#define RME9652_control_register  64
DECL|macro|RME9652_irq_clear
mdefine_line|#define RME9652_irq_clear         96
DECL|macro|RME9652_time_code
mdefine_line|#define RME9652_time_code         100&t;/* useful if used with alesis adat */
DECL|macro|RME9652_thru_base
mdefine_line|#define RME9652_thru_base         128&t;/* 132...228 Thru for 26 channels */
multiline_comment|/* Read-only registers */
multiline_comment|/* Writing to any of the register locations writes to the status&n;   register. We&squot;ll use the first location as our point of access.&n;*/
DECL|macro|RME9652_status_register
mdefine_line|#define RME9652_status_register    0
multiline_comment|/* --------- Control-Register Bits ---------------- */
DECL|macro|RME9652_start_bit
mdefine_line|#define RME9652_start_bit&t;   (1&lt;&lt;0)&t;/* start record/play */
multiline_comment|/* bits 1-3 encode buffersize/latency */
DECL|macro|RME9652_Master
mdefine_line|#define RME9652_Master&t;&t;   (1&lt;&lt;4)&t;/* Clock Mode Master=1,Slave/Auto=0 */
DECL|macro|RME9652_IE
mdefine_line|#define RME9652_IE&t;&t;   (1&lt;&lt;5)&t;/* Interupt Enable */
DECL|macro|RME9652_freq
mdefine_line|#define RME9652_freq&t;&t;   (1&lt;&lt;6)       /* samplerate 0=44.1/88.2, 1=48/96 kHz */
DECL|macro|RME9652_freq1
mdefine_line|#define RME9652_freq1&t;&t;   (1&lt;&lt;7)       /* if 0, 32kHz, else always 1 */
DECL|macro|RME9652_DS
mdefine_line|#define RME9652_DS                 (1&lt;&lt;8)&t;/* Doule Speed 0=44.1/48, 1=88.2/96 Khz */
DECL|macro|RME9652_PRO
mdefine_line|#define RME9652_PRO&t;&t;   (1&lt;&lt;9)&t;/* S/PDIF out: 0=consumer, 1=professional */
DECL|macro|RME9652_EMP
mdefine_line|#define RME9652_EMP&t;&t;   (1&lt;&lt;10)&t;/*  Emphasis 0=None, 1=ON */
DECL|macro|RME9652_Dolby
mdefine_line|#define RME9652_Dolby&t;&t;   (1&lt;&lt;11)&t;/*  Non-audio bit 1=set, 0=unset */
DECL|macro|RME9652_opt_out
mdefine_line|#define RME9652_opt_out&t;           (1&lt;&lt;12)&t;/* Use 1st optical OUT as SPDIF: 1=yes,0=no */
DECL|macro|RME9652_wsel
mdefine_line|#define RME9652_wsel&t;&t;   (1&lt;&lt;13)&t;/* use Wordclock as sync (overwrites master) */
DECL|macro|RME9652_inp_0
mdefine_line|#define RME9652_inp_0&t;&t;   (1&lt;&lt;14)&t;/* SPDIF-IN: 00=optical (ADAT1),     */
DECL|macro|RME9652_inp_1
mdefine_line|#define RME9652_inp_1&t;&t;   (1&lt;&lt;15)&t;/* 01=koaxial (Cinch), 10=Internal CDROM */
DECL|macro|RME9652_SyncPref_ADAT2
mdefine_line|#define RME9652_SyncPref_ADAT2&t;   (1&lt;&lt;16)
DECL|macro|RME9652_SyncPref_ADAT3
mdefine_line|#define RME9652_SyncPref_ADAT3&t;   (1&lt;&lt;17)
DECL|macro|RME9652_SPDIF_RESET
mdefine_line|#define RME9652_SPDIF_RESET        (1&lt;&lt;18)      /* Rev 1.5+: h/w S/PDIF receiver */
DECL|macro|RME9652_SPDIF_SELECT
mdefine_line|#define RME9652_SPDIF_SELECT       (1&lt;&lt;19)
DECL|macro|RME9652_SPDIF_CLOCK
mdefine_line|#define RME9652_SPDIF_CLOCK        (1&lt;&lt;20)
DECL|macro|RME9652_SPDIF_WRITE
mdefine_line|#define RME9652_SPDIF_WRITE        (1&lt;&lt;21)
DECL|macro|RME9652_ADAT1_INTERNAL
mdefine_line|#define RME9652_ADAT1_INTERNAL     (1&lt;&lt;22)      /* Rev 1.5+: if set, internal CD connector carries ADAT */
multiline_comment|/* buffersize = 512Bytes * 2^n, where n is made from Bit2 ... Bit0 */
DECL|macro|RME9652_latency
mdefine_line|#define RME9652_latency            0x0e
DECL|macro|rme9652_encode_latency
mdefine_line|#define rme9652_encode_latency(x)  (((x)&amp;0x7)&lt;&lt;1)
DECL|macro|rme9652_decode_latency
mdefine_line|#define rme9652_decode_latency(x)  (((x)&gt;&gt;1)&amp;0x7)
DECL|macro|rme9652_running_double_speed
mdefine_line|#define rme9652_running_double_speed(s) ((s)-&gt;control_register &amp; RME9652_DS)
DECL|macro|RME9652_inp
mdefine_line|#define RME9652_inp                (RME9652_inp_0|RME9652_inp_1)
DECL|macro|rme9652_encode_spdif_in
mdefine_line|#define rme9652_encode_spdif_in(x) (((x)&amp;0x3)&lt;&lt;14)
DECL|macro|rme9652_decode_spdif_in
mdefine_line|#define rme9652_decode_spdif_in(x) (((x)&gt;&gt;14)&amp;0x3)
DECL|macro|RME9652_SyncPref_Mask
mdefine_line|#define RME9652_SyncPref_Mask      (RME9652_SyncPref_ADAT2|RME9652_SyncPref_ADAT3)
DECL|macro|RME9652_SyncPref_ADAT1
mdefine_line|#define RME9652_SyncPref_ADAT1&t;   0
DECL|macro|RME9652_SyncPref_SPDIF
mdefine_line|#define RME9652_SyncPref_SPDIF&t;   (RME9652_SyncPref_ADAT2|RME9652_SyncPref_ADAT3)
multiline_comment|/* the size of a substream (1 mono data stream) */
DECL|macro|RME9652_CHANNEL_BUFFER_SAMPLES
mdefine_line|#define RME9652_CHANNEL_BUFFER_SAMPLES  (16*1024)
DECL|macro|RME9652_CHANNEL_BUFFER_BYTES
mdefine_line|#define RME9652_CHANNEL_BUFFER_BYTES    (4*RME9652_CHANNEL_BUFFER_SAMPLES)
multiline_comment|/* the size of the area we need to allocate for DMA transfers. the&n;   size is the same regardless of the number of channels - the &n;   9636 still uses the same memory area.&n;&n;   Note that we allocate 1 more channel than is apparently needed&n;   because the h/w seems to write 1 byte beyond the end of the last&n;   page. Sigh.&n;*/
DECL|macro|RME9652_DMA_AREA_BYTES
mdefine_line|#define RME9652_DMA_AREA_BYTES ((RME9652_NCHANNELS+1) * RME9652_CHANNEL_BUFFER_BYTES)
DECL|macro|RME9652_DMA_AREA_KILOBYTES
mdefine_line|#define RME9652_DMA_AREA_KILOBYTES (RME9652_DMA_AREA_BYTES/1024)
DECL|struct|snd_rme9652
r_typedef
r_struct
id|snd_rme9652
(brace
DECL|member|dev
r_int
id|dev
suffix:semicolon
DECL|member|lock
id|spinlock_t
id|lock
suffix:semicolon
DECL|member|irq
r_int
id|irq
suffix:semicolon
DECL|member|port
r_int
r_int
id|port
suffix:semicolon
DECL|member|res_port
r_struct
id|resource
op_star
id|res_port
suffix:semicolon
DECL|member|iobase
r_int
r_int
id|iobase
suffix:semicolon
DECL|member|precise_ptr
r_int
id|precise_ptr
suffix:semicolon
DECL|member|control_register
id|u32
id|control_register
suffix:semicolon
multiline_comment|/* cached value */
DECL|member|thru_bits
id|u32
id|thru_bits
suffix:semicolon
multiline_comment|/* thru 1=on, 0=off channel 1=Bit1... channel 26= Bit26 */
DECL|member|creg_spdif
id|u32
id|creg_spdif
suffix:semicolon
DECL|member|creg_spdif_stream
id|u32
id|creg_spdif_stream
suffix:semicolon
DECL|member|card_name
r_char
op_star
id|card_name
suffix:semicolon
multiline_comment|/* hammerfall or hammerfall light names */
DECL|member|hw_offsetmask
r_int
id|hw_offsetmask
suffix:semicolon
multiline_comment|/* &amp;-with status register to get real hw_offset */
DECL|member|prev_hw_offset
r_int
id|prev_hw_offset
suffix:semicolon
multiline_comment|/* previous hw offset */
DECL|member|max_jitter
r_int
id|max_jitter
suffix:semicolon
multiline_comment|/* maximum jitter in frames for &n;&t;&t;&t;&t;&t;   hw pointer */
DECL|member|period_bytes
r_int
id|period_bytes
suffix:semicolon
multiline_comment|/* guess what this is */
DECL|member|ds_channels
r_int
r_char
id|ds_channels
suffix:semicolon
DECL|member|ss_channels
r_int
r_char
id|ss_channels
suffix:semicolon
multiline_comment|/* different for hammerfall/hammerfall-light */
DECL|member|capture_buffer_unaligned
r_void
op_star
id|capture_buffer_unaligned
suffix:semicolon
multiline_comment|/* original buffer addresses */
DECL|member|playback_buffer_unaligned
r_void
op_star
id|playback_buffer_unaligned
suffix:semicolon
multiline_comment|/* original buffer addresses */
DECL|member|capture_buffer
r_int
r_char
op_star
id|capture_buffer
suffix:semicolon
multiline_comment|/* suitably aligned address */
DECL|member|playback_buffer
r_int
r_char
op_star
id|playback_buffer
suffix:semicolon
multiline_comment|/* suitably aligned address */
DECL|member|capture_buffer_addr
id|dma_addr_t
id|capture_buffer_addr
suffix:semicolon
DECL|member|playback_buffer_addr
id|dma_addr_t
id|playback_buffer_addr
suffix:semicolon
DECL|member|capture_pid
id|pid_t
id|capture_pid
suffix:semicolon
DECL|member|playback_pid
id|pid_t
id|playback_pid
suffix:semicolon
DECL|member|capture_substream
id|snd_pcm_substream_t
op_star
id|capture_substream
suffix:semicolon
DECL|member|playback_substream
id|snd_pcm_substream_t
op_star
id|playback_substream
suffix:semicolon
DECL|member|running
r_int
id|running
suffix:semicolon
DECL|member|passthru
r_int
id|passthru
suffix:semicolon
multiline_comment|/* non-zero if doing pass-thru */
DECL|member|hw_rev
r_int
id|hw_rev
suffix:semicolon
multiline_comment|/* h/w rev * 10 (i.e. 1.5 has hw_rev = 15) */
DECL|member|last_spdif_sample_rate
r_int
id|last_spdif_sample_rate
suffix:semicolon
multiline_comment|/* so that we can catch externally ... */
DECL|member|last_adat_sample_rate
r_int
id|last_adat_sample_rate
suffix:semicolon
multiline_comment|/* ... induced rate changes            */
DECL|member|channel_map
r_char
op_star
id|channel_map
suffix:semicolon
DECL|member|card
id|snd_card_t
op_star
id|card
suffix:semicolon
DECL|member|pcm
id|snd_pcm_t
op_star
id|pcm
suffix:semicolon
DECL|member|pci
r_struct
id|pci_dev
op_star
id|pci
suffix:semicolon
DECL|member|proc_entry
id|snd_info_entry_t
op_star
id|proc_entry
suffix:semicolon
DECL|member|spdif_ctl
id|snd_kcontrol_t
op_star
id|spdif_ctl
suffix:semicolon
DECL|typedef|rme9652_t
)brace
id|rme9652_t
suffix:semicolon
multiline_comment|/* These tables map the ALSA channels 1..N to the channels that we&n;   need to use in order to find the relevant channel buffer. RME&n;   refer to this kind of mapping as between &quot;the ADAT channel and&n;   the DMA channel.&quot; We index it using the logical audio channel,&n;   and the value is the DMA channel (i.e. channel buffer number)&n;   where the data for that channel can be read/written from/to.&n;*/
DECL|variable|channel_map_9652_ss
r_static
r_char
id|channel_map_9652_ss
(braket
l_int|26
)braket
op_assign
(brace
l_int|0
comma
l_int|1
comma
l_int|2
comma
l_int|3
comma
l_int|4
comma
l_int|5
comma
l_int|6
comma
l_int|7
comma
l_int|8
comma
l_int|9
comma
l_int|10
comma
l_int|11
comma
l_int|12
comma
l_int|13
comma
l_int|14
comma
l_int|15
comma
l_int|16
comma
l_int|17
comma
l_int|18
comma
l_int|19
comma
l_int|20
comma
l_int|21
comma
l_int|22
comma
l_int|23
comma
l_int|24
comma
l_int|25
)brace
suffix:semicolon
DECL|variable|channel_map_9636_ss
r_static
r_char
id|channel_map_9636_ss
(braket
l_int|26
)braket
op_assign
(brace
l_int|0
comma
l_int|1
comma
l_int|2
comma
l_int|3
comma
l_int|4
comma
l_int|5
comma
l_int|6
comma
l_int|7
comma
l_int|8
comma
l_int|9
comma
l_int|10
comma
l_int|11
comma
l_int|12
comma
l_int|13
comma
l_int|14
comma
l_int|15
comma
multiline_comment|/* channels 16 and 17 are S/PDIF */
l_int|24
comma
l_int|25
comma
multiline_comment|/* channels 18-25 don&squot;t exist */
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
)brace
suffix:semicolon
DECL|variable|channel_map_9652_ds
r_static
r_char
id|channel_map_9652_ds
(braket
l_int|26
)braket
op_assign
(brace
multiline_comment|/* ADAT channels are remapped */
l_int|1
comma
l_int|3
comma
l_int|5
comma
l_int|7
comma
l_int|9
comma
l_int|11
comma
l_int|13
comma
l_int|15
comma
l_int|17
comma
l_int|19
comma
l_int|21
comma
l_int|23
comma
multiline_comment|/* channels 12 and 13 are S/PDIF */
l_int|24
comma
l_int|25
comma
multiline_comment|/* others don&squot;t exist */
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
)brace
suffix:semicolon
DECL|variable|channel_map_9636_ds
r_static
r_char
id|channel_map_9636_ds
(braket
l_int|26
)braket
op_assign
(brace
multiline_comment|/* ADAT channels are remapped */
l_int|1
comma
l_int|3
comma
l_int|5
comma
l_int|7
comma
l_int|9
comma
l_int|11
comma
l_int|13
comma
l_int|15
comma
multiline_comment|/* channels 8 and 9 are S/PDIF */
l_int|24
comma
l_int|25
multiline_comment|/* others don&squot;t exist */
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
)brace
suffix:semicolon
DECL|macro|RME9652_PREALLOCATE_MEMORY
mdefine_line|#define RME9652_PREALLOCATE_MEMORY&t;/* via module snd-rme9652_mem */
macro_line|#ifdef RME9652_PREALLOCATE_MEMORY
r_extern
r_void
op_star
id|snd_rme9652_get_buffer
c_func
(paren
r_int
id|card
comma
id|dma_addr_t
op_star
id|dmaaddr
)paren
suffix:semicolon
r_extern
r_void
id|snd_rme9652_free_buffer
c_func
(paren
r_int
id|card
comma
r_void
op_star
id|ptr
)paren
suffix:semicolon
macro_line|#endif
DECL|variable|__devinitdata
r_static
r_struct
id|pci_device_id
id|snd_rme9652_ids
(braket
)braket
id|__devinitdata
op_assign
(brace
(brace
l_int|0x10ee
comma
l_int|0x3fc4
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
)brace
comma
multiline_comment|/* RME Digi9652 */
(brace
l_int|0
comma
)brace
)brace
suffix:semicolon
id|MODULE_DEVICE_TABLE
c_func
(paren
id|pci
comma
id|snd_rme9652_ids
)paren
suffix:semicolon
DECL|function|rme9652_write
r_static
r_inline
r_void
id|rme9652_write
c_func
(paren
id|rme9652_t
op_star
id|rme9652
comma
r_int
id|reg
comma
r_int
id|val
)paren
(brace
id|writel
c_func
(paren
id|val
comma
id|rme9652-&gt;iobase
op_plus
id|reg
)paren
suffix:semicolon
)brace
DECL|function|rme9652_read
r_static
r_inline
r_int
r_int
id|rme9652_read
c_func
(paren
id|rme9652_t
op_star
id|rme9652
comma
r_int
id|reg
)paren
(brace
r_return
id|readl
c_func
(paren
id|rme9652-&gt;iobase
op_plus
id|reg
)paren
suffix:semicolon
)brace
DECL|function|snd_rme9652_use_is_exclusive
r_static
r_inline
r_int
id|snd_rme9652_use_is_exclusive
c_func
(paren
id|rme9652_t
op_star
id|rme9652
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
r_int
id|ret
op_assign
l_int|1
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|rme9652-&gt;playback_pid
op_ne
id|rme9652-&gt;capture_pid
)paren
op_logical_and
(paren
id|rme9652-&gt;playback_pid
op_ge
l_int|0
)paren
op_logical_and
(paren
id|rme9652-&gt;capture_pid
op_ge
l_int|0
)paren
)paren
(brace
id|ret
op_assign
l_int|0
suffix:semicolon
)brace
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
DECL|function|rme9652_adat_sample_rate
r_static
r_inline
r_int
id|rme9652_adat_sample_rate
c_func
(paren
id|rme9652_t
op_star
id|rme9652
)paren
(brace
r_if
c_cond
(paren
id|rme9652_running_double_speed
c_func
(paren
id|rme9652
)paren
)paren
(brace
r_return
(paren
id|rme9652_read
c_func
(paren
id|rme9652
comma
id|RME9652_status_register
)paren
op_amp
id|RME9652_fs48
)paren
ques
c_cond
l_int|96000
suffix:colon
l_int|88200
suffix:semicolon
)brace
r_else
(brace
r_return
(paren
id|rme9652_read
c_func
(paren
id|rme9652
comma
id|RME9652_status_register
)paren
op_amp
id|RME9652_fs48
)paren
ques
c_cond
l_int|48000
suffix:colon
l_int|44100
suffix:semicolon
)brace
)brace
DECL|function|rme9652_compute_period_size
r_static
r_inline
r_void
id|rme9652_compute_period_size
c_func
(paren
id|rme9652_t
op_star
id|rme9652
)paren
(brace
r_int
r_int
id|i
suffix:semicolon
id|i
op_assign
id|rme9652-&gt;control_register
op_amp
id|RME9652_latency
suffix:semicolon
id|rme9652-&gt;period_bytes
op_assign
l_int|1
op_lshift
(paren
(paren
id|rme9652_decode_latency
c_func
(paren
id|i
)paren
op_plus
l_int|8
)paren
)paren
suffix:semicolon
id|rme9652-&gt;hw_offsetmask
op_assign
(paren
id|rme9652-&gt;period_bytes
op_star
l_int|2
op_minus
l_int|1
)paren
op_amp
id|RME9652_buf_pos
suffix:semicolon
id|rme9652-&gt;max_jitter
op_assign
l_int|80
suffix:semicolon
)brace
DECL|function|rme9652_hw_pointer
r_static
id|snd_pcm_uframes_t
id|rme9652_hw_pointer
c_func
(paren
id|rme9652_t
op_star
id|rme9652
)paren
(brace
r_int
id|status
suffix:semicolon
r_int
id|offset
comma
id|frag
suffix:semicolon
id|snd_pcm_uframes_t
id|period_size
op_assign
id|rme9652-&gt;period_bytes
op_div
l_int|4
suffix:semicolon
id|snd_pcm_sframes_t
id|delta
suffix:semicolon
id|status
op_assign
id|rme9652_read
c_func
(paren
id|rme9652
comma
id|RME9652_status_register
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|rme9652-&gt;precise_ptr
)paren
r_return
(paren
id|status
op_amp
id|RME9652_buffer_id
)paren
ques
c_cond
id|period_size
suffix:colon
l_int|0
suffix:semicolon
id|offset
op_assign
id|status
op_amp
id|RME9652_buf_pos
suffix:semicolon
multiline_comment|/* The hardware may give a backward movement for up to 80 frames&n;           Martin Kirst &lt;martin.kirst@freenet.de&gt; knows the details.&n;&t;*/
id|delta
op_assign
id|rme9652-&gt;prev_hw_offset
op_minus
id|offset
suffix:semicolon
id|delta
op_and_assign
l_int|0xffff
suffix:semicolon
r_if
c_cond
(paren
id|delta
op_le
id|rme9652-&gt;max_jitter
op_star
l_int|4
)paren
id|offset
op_assign
id|rme9652-&gt;prev_hw_offset
suffix:semicolon
r_else
id|rme9652-&gt;prev_hw_offset
op_assign
id|offset
suffix:semicolon
id|offset
op_and_assign
id|rme9652-&gt;hw_offsetmask
suffix:semicolon
id|offset
op_div_assign
l_int|4
suffix:semicolon
id|frag
op_assign
id|status
op_amp
id|RME9652_buffer_id
suffix:semicolon
r_if
c_cond
(paren
id|offset
OL
id|period_size
)paren
(brace
r_if
c_cond
(paren
id|offset
OG
id|rme9652-&gt;max_jitter
)paren
(brace
r_if
c_cond
(paren
id|frag
)paren
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;Unexpected hw_pointer position (bufid == 0): status: %x offset: %d&bslash;n&quot;
comma
id|status
comma
id|offset
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|frag
)paren
r_return
l_int|0
suffix:semicolon
id|offset
op_sub_assign
id|rme9652-&gt;max_jitter
suffix:semicolon
r_if
c_cond
(paren
id|offset
OL
l_int|0
)paren
id|offset
op_add_assign
id|period_size
op_star
l_int|2
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|offset
OG
id|period_size
op_plus
id|rme9652-&gt;max_jitter
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|frag
)paren
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;Unexpected hw_pointer position (bufid == 1): status: %x offset: %d&bslash;n&quot;
comma
id|status
comma
id|offset
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|frag
)paren
r_return
id|period_size
suffix:semicolon
id|offset
op_sub_assign
id|rme9652-&gt;max_jitter
suffix:semicolon
)brace
r_return
id|offset
suffix:semicolon
)brace
DECL|function|rme9652_reset_hw_pointer
r_static
r_inline
r_void
id|rme9652_reset_hw_pointer
c_func
(paren
id|rme9652_t
op_star
id|rme9652
)paren
(brace
r_int
id|i
suffix:semicolon
multiline_comment|/* reset the FIFO pointer to zero. We do this by writing to 8&n;&t;   registers, each of which is a 32bit wide register, and set&n;&t;   them all to zero. Note that s-&gt;iobase is a pointer to&n;&t;   int32, not pointer to char.  &n;&t;*/
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|8
suffix:semicolon
id|i
op_increment
)paren
(brace
id|rme9652_write
c_func
(paren
id|rme9652
comma
id|i
op_star
l_int|4
comma
l_int|0
)paren
suffix:semicolon
id|udelay
c_func
(paren
l_int|10
)paren
suffix:semicolon
)brace
id|rme9652-&gt;prev_hw_offset
op_assign
l_int|0
suffix:semicolon
)brace
DECL|function|rme9652_start
r_static
r_inline
r_void
id|rme9652_start
c_func
(paren
id|rme9652_t
op_star
id|s
)paren
(brace
id|s-&gt;control_register
op_or_assign
(paren
id|RME9652_IE
op_or
id|RME9652_start_bit
)paren
suffix:semicolon
id|rme9652_write
c_func
(paren
id|s
comma
id|RME9652_control_register
comma
id|s-&gt;control_register
)paren
suffix:semicolon
)brace
DECL|function|rme9652_stop
r_static
r_inline
r_void
id|rme9652_stop
c_func
(paren
id|rme9652_t
op_star
id|s
)paren
(brace
id|s-&gt;control_register
op_and_assign
op_complement
(paren
id|RME9652_start_bit
op_or
id|RME9652_IE
)paren
suffix:semicolon
id|rme9652_write
c_func
(paren
id|s
comma
id|RME9652_control_register
comma
id|s-&gt;control_register
)paren
suffix:semicolon
)brace
DECL|function|rme9652_set_interrupt_interval
r_static
r_int
id|rme9652_set_interrupt_interval
c_func
(paren
id|rme9652_t
op_star
id|s
comma
r_int
r_int
id|frames
)paren
(brace
r_int
id|restart
op_assign
l_int|0
suffix:semicolon
r_int
id|n
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|s-&gt;lock
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|restart
op_assign
id|s-&gt;running
)paren
)paren
(brace
id|rme9652_stop
c_func
(paren
id|s
)paren
suffix:semicolon
)brace
id|frames
op_rshift_assign
l_int|7
suffix:semicolon
id|n
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
id|frames
)paren
(brace
id|n
op_increment
suffix:semicolon
id|frames
op_rshift_assign
l_int|1
suffix:semicolon
)brace
id|s-&gt;control_register
op_and_assign
op_complement
id|RME9652_latency
suffix:semicolon
id|s-&gt;control_register
op_or_assign
id|rme9652_encode_latency
c_func
(paren
id|n
)paren
suffix:semicolon
id|rme9652_write
c_func
(paren
id|s
comma
id|RME9652_control_register
comma
id|s-&gt;control_register
)paren
suffix:semicolon
id|rme9652_compute_period_size
c_func
(paren
id|s
)paren
suffix:semicolon
r_if
c_cond
(paren
id|restart
)paren
id|rme9652_start
c_func
(paren
id|s
)paren
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|s-&gt;lock
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|rme9652_set_rate
r_static
r_int
id|rme9652_set_rate
c_func
(paren
id|rme9652_t
op_star
id|rme9652
comma
r_int
id|rate
)paren
(brace
r_int
id|restart
suffix:semicolon
r_int
id|reject_if_open
op_assign
l_int|0
suffix:semicolon
r_int
id|xrate
suffix:semicolon
multiline_comment|/* Changing from a &quot;single speed&quot; to a &quot;double speed&quot; rate is&n;&t;   not allowed if any substreams are open. This is because&n;&t;   such a change causes a shift in the location of &n;&t;   the DMA buffers and a reduction in the number of available&n;&t;   buffers. &n;&n;&t;   Note that a similar but essentially insoluble problem&n;&t;   exists for externally-driven rate changes. All we can do&n;&t;   is to flag rate changes in the read/write routines.&n;&t; */
id|spin_lock_irq
c_func
(paren
op_amp
id|rme9652-&gt;lock
)paren
suffix:semicolon
id|xrate
op_assign
id|rme9652_adat_sample_rate
c_func
(paren
id|rme9652
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|rate
)paren
(brace
r_case
l_int|44100
suffix:colon
r_if
c_cond
(paren
id|xrate
OG
l_int|48000
)paren
(brace
id|reject_if_open
op_assign
l_int|1
suffix:semicolon
)brace
id|rate
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|48000
suffix:colon
r_if
c_cond
(paren
id|xrate
OG
l_int|48000
)paren
(brace
id|reject_if_open
op_assign
l_int|1
suffix:semicolon
)brace
id|rate
op_assign
id|RME9652_freq
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|88200
suffix:colon
r_if
c_cond
(paren
id|xrate
OL
l_int|48000
)paren
(brace
id|reject_if_open
op_assign
l_int|1
suffix:semicolon
)brace
id|rate
op_assign
id|RME9652_DS
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|96000
suffix:colon
r_if
c_cond
(paren
id|xrate
OL
l_int|48000
)paren
(brace
id|reject_if_open
op_assign
l_int|1
suffix:semicolon
)brace
id|rate
op_assign
id|RME9652_DS
op_or
id|RME9652_freq
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|reject_if_open
op_logical_and
(paren
id|rme9652-&gt;capture_pid
op_ge
l_int|0
op_logical_or
id|rme9652-&gt;playback_pid
op_ge
l_int|0
)paren
)paren
(brace
id|spin_unlock_irq
c_func
(paren
op_amp
id|rme9652-&gt;lock
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|restart
op_assign
id|rme9652-&gt;running
)paren
)paren
(brace
id|rme9652_stop
c_func
(paren
id|rme9652
)paren
suffix:semicolon
)brace
id|rme9652-&gt;control_register
op_and_assign
op_complement
(paren
id|RME9652_freq
op_or
id|RME9652_DS
)paren
suffix:semicolon
id|rme9652-&gt;control_register
op_or_assign
id|rate
suffix:semicolon
id|rme9652_write
c_func
(paren
id|rme9652
comma
id|RME9652_control_register
comma
id|rme9652-&gt;control_register
)paren
suffix:semicolon
r_if
c_cond
(paren
id|restart
)paren
(brace
id|rme9652_start
c_func
(paren
id|rme9652
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|rate
op_amp
id|RME9652_DS
)paren
(brace
r_if
c_cond
(paren
id|rme9652-&gt;ss_channels
op_eq
id|RME9652_NCHANNELS
)paren
(brace
id|rme9652-&gt;channel_map
op_assign
id|channel_map_9652_ds
suffix:semicolon
)brace
r_else
(brace
id|rme9652-&gt;channel_map
op_assign
id|channel_map_9636_ds
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|rme9652-&gt;ss_channels
op_eq
id|RME9652_NCHANNELS
)paren
(brace
id|rme9652-&gt;channel_map
op_assign
id|channel_map_9652_ss
suffix:semicolon
)brace
r_else
(brace
id|rme9652-&gt;channel_map
op_assign
id|channel_map_9636_ss
suffix:semicolon
)brace
)brace
id|spin_unlock_irq
c_func
(paren
op_amp
id|rme9652-&gt;lock
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|rme9652_set_thru
r_static
r_void
id|rme9652_set_thru
c_func
(paren
id|rme9652_t
op_star
id|rme9652
comma
r_int
id|channel
comma
r_int
id|enable
)paren
(brace
r_int
id|i
suffix:semicolon
id|rme9652-&gt;passthru
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|channel
OL
l_int|0
)paren
(brace
multiline_comment|/* set thru for all channels */
r_if
c_cond
(paren
id|enable
)paren
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|RME9652_NCHANNELS
suffix:semicolon
id|i
op_increment
)paren
(brace
id|rme9652-&gt;thru_bits
op_or_assign
(paren
l_int|1
op_lshift
id|i
)paren
suffix:semicolon
id|rme9652_write
c_func
(paren
id|rme9652
comma
id|RME9652_thru_base
op_plus
id|i
op_star
l_int|4
comma
l_int|1
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|RME9652_NCHANNELS
suffix:semicolon
id|i
op_increment
)paren
(brace
id|rme9652-&gt;thru_bits
op_and_assign
op_complement
(paren
l_int|1
op_lshift
id|i
)paren
suffix:semicolon
id|rme9652_write
c_func
(paren
id|rme9652
comma
id|RME9652_thru_base
op_plus
id|i
op_star
l_int|4
comma
l_int|0
)paren
suffix:semicolon
)brace
)brace
)brace
r_else
(brace
r_int
id|mapped_channel
suffix:semicolon
id|snd_assert
c_func
(paren
id|channel
op_eq
id|RME9652_NCHANNELS
comma
r_return
)paren
suffix:semicolon
id|mapped_channel
op_assign
id|rme9652-&gt;channel_map
(braket
id|channel
)braket
suffix:semicolon
r_if
c_cond
(paren
id|enable
)paren
(brace
id|rme9652-&gt;thru_bits
op_or_assign
(paren
l_int|1
op_lshift
id|mapped_channel
)paren
suffix:semicolon
)brace
r_else
(brace
id|rme9652-&gt;thru_bits
op_and_assign
op_complement
(paren
l_int|1
op_lshift
id|mapped_channel
)paren
suffix:semicolon
)brace
id|rme9652_write
c_func
(paren
id|rme9652
comma
id|RME9652_thru_base
op_plus
id|mapped_channel
op_star
l_int|4
comma
id|enable
ques
c_cond
l_int|1
suffix:colon
l_int|0
)paren
suffix:semicolon
)brace
)brace
DECL|function|rme9652_set_passthru
r_static
r_int
id|rme9652_set_passthru
c_func
(paren
id|rme9652_t
op_star
id|rme9652
comma
r_int
id|onoff
)paren
(brace
r_if
c_cond
(paren
id|onoff
)paren
(brace
id|rme9652_set_thru
c_func
(paren
id|rme9652
comma
op_minus
l_int|1
comma
l_int|1
)paren
suffix:semicolon
multiline_comment|/* we don&squot;t want interrupts, so do a&n;&t;&t;   custom version of rme9652_start().&n;&t;&t;*/
id|rme9652-&gt;control_register
op_assign
id|RME9652_inp_0
op_or
id|rme9652_encode_latency
c_func
(paren
l_int|7
)paren
op_or
id|RME9652_start_bit
suffix:semicolon
id|rme9652_reset_hw_pointer
c_func
(paren
id|rme9652
)paren
suffix:semicolon
id|rme9652_write
c_func
(paren
id|rme9652
comma
id|RME9652_control_register
comma
id|rme9652-&gt;control_register
)paren
suffix:semicolon
id|rme9652-&gt;passthru
op_assign
l_int|1
suffix:semicolon
)brace
r_else
(brace
id|rme9652_set_thru
c_func
(paren
id|rme9652
comma
op_minus
l_int|1
comma
l_int|0
)paren
suffix:semicolon
id|rme9652_stop
c_func
(paren
id|rme9652
)paren
suffix:semicolon
id|rme9652-&gt;passthru
op_assign
l_int|0
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|rme9652_spdif_set_bit
r_static
r_void
id|rme9652_spdif_set_bit
(paren
id|rme9652_t
op_star
id|rme9652
comma
r_int
id|mask
comma
r_int
id|onoff
)paren
(brace
r_if
c_cond
(paren
id|onoff
)paren
id|rme9652-&gt;control_register
op_or_assign
id|mask
suffix:semicolon
r_else
id|rme9652-&gt;control_register
op_and_assign
op_complement
id|mask
suffix:semicolon
id|rme9652_write
c_func
(paren
id|rme9652
comma
id|RME9652_control_register
comma
id|rme9652-&gt;control_register
)paren
suffix:semicolon
)brace
DECL|function|rme9652_spdif_write_byte
r_static
r_void
id|rme9652_spdif_write_byte
(paren
id|rme9652_t
op_star
id|rme9652
comma
r_const
r_int
id|val
)paren
(brace
r_int
id|mask
suffix:semicolon
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
comma
id|mask
op_assign
l_int|0x80
suffix:semicolon
id|i
OL
l_int|8
suffix:semicolon
id|i
op_increment
comma
id|mask
op_rshift_assign
l_int|1
)paren
(brace
r_if
c_cond
(paren
id|val
op_amp
id|mask
)paren
id|rme9652_spdif_set_bit
(paren
id|rme9652
comma
id|RME9652_SPDIF_WRITE
comma
l_int|1
)paren
suffix:semicolon
r_else
id|rme9652_spdif_set_bit
(paren
id|rme9652
comma
id|RME9652_SPDIF_WRITE
comma
l_int|0
)paren
suffix:semicolon
id|rme9652_spdif_set_bit
(paren
id|rme9652
comma
id|RME9652_SPDIF_CLOCK
comma
l_int|1
)paren
suffix:semicolon
id|rme9652_spdif_set_bit
(paren
id|rme9652
comma
id|RME9652_SPDIF_CLOCK
comma
l_int|0
)paren
suffix:semicolon
)brace
)brace
DECL|function|rme9652_spdif_read_byte
r_static
r_int
id|rme9652_spdif_read_byte
(paren
id|rme9652_t
op_star
id|rme9652
)paren
(brace
r_int
id|mask
suffix:semicolon
r_int
id|val
suffix:semicolon
r_int
id|i
suffix:semicolon
id|val
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
comma
id|mask
op_assign
l_int|0x80
suffix:semicolon
id|i
OL
l_int|8
suffix:semicolon
id|i
op_increment
comma
id|mask
op_rshift_assign
l_int|1
)paren
(brace
id|rme9652_spdif_set_bit
(paren
id|rme9652
comma
id|RME9652_SPDIF_CLOCK
comma
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rme9652_read
(paren
id|rme9652
comma
id|RME9652_status_register
)paren
op_amp
id|RME9652_SPDIF_READ
)paren
id|val
op_or_assign
id|mask
suffix:semicolon
id|rme9652_spdif_set_bit
(paren
id|rme9652
comma
id|RME9652_SPDIF_CLOCK
comma
l_int|0
)paren
suffix:semicolon
)brace
r_return
id|val
suffix:semicolon
)brace
DECL|function|rme9652_write_spdif_codec
r_static
r_void
id|rme9652_write_spdif_codec
(paren
id|rme9652_t
op_star
id|rme9652
comma
r_const
r_int
id|address
comma
r_const
r_int
id|data
)paren
(brace
id|rme9652_spdif_set_bit
(paren
id|rme9652
comma
id|RME9652_SPDIF_SELECT
comma
l_int|1
)paren
suffix:semicolon
id|rme9652_spdif_write_byte
(paren
id|rme9652
comma
l_int|0x20
)paren
suffix:semicolon
id|rme9652_spdif_write_byte
(paren
id|rme9652
comma
id|address
)paren
suffix:semicolon
id|rme9652_spdif_write_byte
(paren
id|rme9652
comma
id|data
)paren
suffix:semicolon
id|rme9652_spdif_set_bit
(paren
id|rme9652
comma
id|RME9652_SPDIF_SELECT
comma
l_int|0
)paren
suffix:semicolon
)brace
DECL|function|rme9652_spdif_read_codec
r_static
r_int
id|rme9652_spdif_read_codec
(paren
id|rme9652_t
op_star
id|rme9652
comma
r_const
r_int
id|address
)paren
(brace
r_int
id|ret
suffix:semicolon
id|rme9652_spdif_set_bit
(paren
id|rme9652
comma
id|RME9652_SPDIF_SELECT
comma
l_int|1
)paren
suffix:semicolon
id|rme9652_spdif_write_byte
(paren
id|rme9652
comma
l_int|0x20
)paren
suffix:semicolon
id|rme9652_spdif_write_byte
(paren
id|rme9652
comma
id|address
)paren
suffix:semicolon
id|rme9652_spdif_set_bit
(paren
id|rme9652
comma
id|RME9652_SPDIF_SELECT
comma
l_int|0
)paren
suffix:semicolon
id|rme9652_spdif_set_bit
(paren
id|rme9652
comma
id|RME9652_SPDIF_SELECT
comma
l_int|1
)paren
suffix:semicolon
id|rme9652_spdif_write_byte
(paren
id|rme9652
comma
l_int|0x21
)paren
suffix:semicolon
id|ret
op_assign
id|rme9652_spdif_read_byte
(paren
id|rme9652
)paren
suffix:semicolon
id|rme9652_spdif_set_bit
(paren
id|rme9652
comma
id|RME9652_SPDIF_SELECT
comma
l_int|0
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
DECL|function|rme9652_initialize_spdif_receiver
r_static
r_void
id|rme9652_initialize_spdif_receiver
(paren
id|rme9652_t
op_star
id|rme9652
)paren
(brace
multiline_comment|/* XXX what unsets this ? */
id|rme9652-&gt;control_register
op_or_assign
id|RME9652_SPDIF_RESET
suffix:semicolon
id|rme9652_write_spdif_codec
(paren
id|rme9652
comma
l_int|4
comma
l_int|0x40
)paren
suffix:semicolon
id|rme9652_write_spdif_codec
(paren
id|rme9652
comma
l_int|17
comma
l_int|0x13
)paren
suffix:semicolon
id|rme9652_write_spdif_codec
(paren
id|rme9652
comma
l_int|6
comma
l_int|0x02
)paren
suffix:semicolon
)brace
DECL|function|rme9652_spdif_sample_rate
r_static
r_inline
r_int
id|rme9652_spdif_sample_rate
c_func
(paren
id|rme9652_t
op_star
id|s
)paren
(brace
r_int
r_int
id|rate_bits
suffix:semicolon
r_if
c_cond
(paren
id|rme9652_read
c_func
(paren
id|s
comma
id|RME9652_status_register
)paren
op_amp
id|RME9652_ERF
)paren
(brace
r_return
op_minus
l_int|1
suffix:semicolon
multiline_comment|/* error condition */
)brace
r_if
c_cond
(paren
id|s-&gt;hw_rev
op_eq
l_int|15
)paren
(brace
r_int
id|x
comma
id|y
comma
id|ret
suffix:semicolon
id|x
op_assign
id|rme9652_spdif_read_codec
(paren
id|s
comma
l_int|30
)paren
suffix:semicolon
r_if
c_cond
(paren
id|x
op_ne
l_int|0
)paren
id|y
op_assign
l_int|48000
op_star
l_int|64
op_div
id|x
suffix:semicolon
r_else
id|y
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|y
OG
l_int|30400
op_logical_and
id|y
OL
l_int|33600
)paren
id|ret
op_assign
l_int|32000
suffix:semicolon
r_else
r_if
c_cond
(paren
id|y
OG
l_int|41900
op_logical_and
id|y
OL
l_int|46000
)paren
id|ret
op_assign
l_int|44100
suffix:semicolon
r_else
r_if
c_cond
(paren
id|y
OG
l_int|46000
op_logical_and
id|y
OL
l_int|50400
)paren
id|ret
op_assign
l_int|48000
suffix:semicolon
r_else
r_if
c_cond
(paren
id|y
OG
l_int|60800
op_logical_and
id|y
OL
l_int|67200
)paren
id|ret
op_assign
l_int|64000
suffix:semicolon
r_else
r_if
c_cond
(paren
id|y
OG
l_int|83700
op_logical_and
id|y
OL
l_int|92000
)paren
id|ret
op_assign
l_int|88200
suffix:semicolon
r_else
r_if
c_cond
(paren
id|y
OG
l_int|92000
op_logical_and
id|y
OL
l_int|100000
)paren
id|ret
op_assign
l_int|96000
suffix:semicolon
r_else
id|ret
op_assign
l_int|0
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
id|rate_bits
op_assign
id|rme9652_read
c_func
(paren
id|s
comma
id|RME9652_status_register
)paren
op_amp
id|RME9652_F
suffix:semicolon
r_switch
c_cond
(paren
id|rme9652_decode_spdif_rate
c_func
(paren
id|rate_bits
)paren
)paren
(brace
r_case
l_int|0x7
suffix:colon
r_return
l_int|32000
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x6
suffix:colon
r_return
l_int|44100
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x5
suffix:colon
r_return
l_int|48000
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x4
suffix:colon
r_return
l_int|88200
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x3
suffix:colon
r_return
l_int|96000
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x0
suffix:colon
r_return
l_int|64000
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|snd_printk
c_func
(paren
l_string|&quot;%s: unknown S/PDIF input rate (bits = 0x%x)&bslash;n&quot;
comma
id|s-&gt;card_name
comma
id|rate_bits
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
multiline_comment|/*-----------------------------------------------------------------------------&n;  Control Interface&n;  ----------------------------------------------------------------------------*/
DECL|function|snd_rme9652_convert_from_aes
r_static
id|u32
id|snd_rme9652_convert_from_aes
c_func
(paren
id|snd_aes_iec958_t
op_star
id|aes
)paren
(brace
id|u32
id|val
op_assign
l_int|0
suffix:semicolon
id|val
op_or_assign
(paren
id|aes-&gt;status
(braket
l_int|0
)braket
op_amp
id|IEC958_AES0_PROFESSIONAL
)paren
ques
c_cond
id|RME9652_PRO
suffix:colon
l_int|0
suffix:semicolon
id|val
op_or_assign
(paren
id|aes-&gt;status
(braket
l_int|0
)braket
op_amp
id|IEC958_AES0_NONAUDIO
)paren
ques
c_cond
id|RME9652_Dolby
suffix:colon
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|val
op_amp
id|RME9652_PRO
)paren
id|val
op_or_assign
(paren
id|aes-&gt;status
(braket
l_int|0
)braket
op_amp
id|IEC958_AES0_PRO_EMPHASIS_5015
)paren
ques
c_cond
id|RME9652_EMP
suffix:colon
l_int|0
suffix:semicolon
r_else
id|val
op_or_assign
(paren
id|aes-&gt;status
(braket
l_int|0
)braket
op_amp
id|IEC958_AES0_CON_EMPHASIS_5015
)paren
ques
c_cond
id|RME9652_EMP
suffix:colon
l_int|0
suffix:semicolon
r_return
id|val
suffix:semicolon
)brace
DECL|function|snd_rme9652_convert_to_aes
r_static
r_void
id|snd_rme9652_convert_to_aes
c_func
(paren
id|snd_aes_iec958_t
op_star
id|aes
comma
id|u32
id|val
)paren
(brace
id|aes-&gt;status
(braket
l_int|0
)braket
op_assign
(paren
(paren
id|val
op_amp
id|RME9652_PRO
)paren
ques
c_cond
id|IEC958_AES0_PROFESSIONAL
suffix:colon
l_int|0
)paren
op_or
(paren
(paren
id|val
op_amp
id|RME9652_Dolby
)paren
ques
c_cond
id|IEC958_AES0_NONAUDIO
suffix:colon
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|val
op_amp
id|RME9652_PRO
)paren
id|aes-&gt;status
(braket
l_int|0
)braket
op_or_assign
(paren
id|val
op_amp
id|RME9652_EMP
)paren
ques
c_cond
id|IEC958_AES0_PRO_EMPHASIS_5015
suffix:colon
l_int|0
suffix:semicolon
r_else
id|aes-&gt;status
(braket
l_int|0
)braket
op_or_assign
(paren
id|val
op_amp
id|RME9652_EMP
)paren
ques
c_cond
id|IEC958_AES0_CON_EMPHASIS_5015
suffix:colon
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_control_spdif_info
r_static
r_int
id|snd_rme9652_control_spdif_info
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_IEC958
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_control_spdif_get
r_static
r_int
id|snd_rme9652_control_spdif_get
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|rme9652_t
op_star
id|rme9652
op_assign
id|_snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|snd_rme9652_convert_to_aes
c_func
(paren
op_amp
id|ucontrol-&gt;value.iec958
comma
id|rme9652-&gt;creg_spdif
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_control_spdif_put
r_static
r_int
id|snd_rme9652_control_spdif_put
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|rme9652_t
op_star
id|rme9652
op_assign
id|_snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
id|change
suffix:semicolon
id|u32
id|val
suffix:semicolon
id|val
op_assign
id|snd_rme9652_convert_from_aes
c_func
(paren
op_amp
id|ucontrol-&gt;value.iec958
)paren
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|change
op_assign
id|val
op_ne
id|rme9652-&gt;creg_spdif
suffix:semicolon
id|rme9652-&gt;creg_spdif
op_assign
id|val
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_return
id|change
suffix:semicolon
)brace
DECL|function|snd_rme9652_control_spdif_stream_info
r_static
r_int
id|snd_rme9652_control_spdif_stream_info
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_IEC958
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_control_spdif_stream_get
r_static
r_int
id|snd_rme9652_control_spdif_stream_get
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|rme9652_t
op_star
id|rme9652
op_assign
id|_snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|snd_rme9652_convert_to_aes
c_func
(paren
op_amp
id|ucontrol-&gt;value.iec958
comma
id|rme9652-&gt;creg_spdif_stream
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_control_spdif_stream_put
r_static
r_int
id|snd_rme9652_control_spdif_stream_put
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|rme9652_t
op_star
id|rme9652
op_assign
id|_snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
id|change
suffix:semicolon
id|u32
id|val
suffix:semicolon
id|val
op_assign
id|snd_rme9652_convert_from_aes
c_func
(paren
op_amp
id|ucontrol-&gt;value.iec958
)paren
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|change
op_assign
id|val
op_ne
id|rme9652-&gt;creg_spdif_stream
suffix:semicolon
id|rme9652-&gt;creg_spdif_stream
op_assign
id|val
suffix:semicolon
id|rme9652-&gt;control_register
op_and_assign
op_complement
(paren
id|RME9652_PRO
op_or
id|RME9652_Dolby
op_or
id|RME9652_EMP
)paren
suffix:semicolon
id|rme9652_write
c_func
(paren
id|rme9652
comma
id|RME9652_control_register
comma
id|rme9652-&gt;control_register
op_or_assign
id|val
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_return
id|change
suffix:semicolon
)brace
DECL|function|snd_rme9652_control_spdif_mask_info
r_static
r_int
id|snd_rme9652_control_spdif_mask_info
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_IEC958
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_control_spdif_mask_get
r_static
r_int
id|snd_rme9652_control_spdif_mask_get
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|ucontrol-&gt;value.iec958.status
(braket
l_int|0
)braket
op_assign
id|kcontrol-&gt;private_value
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|macro|RME9652_ADAT1_IN
mdefine_line|#define RME9652_ADAT1_IN(xname, xindex) &bslash;&n;{ iface: SNDRV_CTL_ELEM_IFACE_PCM, name: xname, index: xindex, &bslash;&n;  info: snd_rme9652_info_adat1_in, &bslash;&n;  get: snd_rme9652_get_adat1_in, &bslash;&n;  put: snd_rme9652_put_adat1_in }
DECL|function|rme9652_adat1_in
r_static
r_int
r_int
id|rme9652_adat1_in
c_func
(paren
id|rme9652_t
op_star
id|rme9652
)paren
(brace
r_if
c_cond
(paren
id|rme9652-&gt;control_register
op_amp
id|RME9652_ADAT1_INTERNAL
)paren
r_return
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|rme9652_set_adat1_input
r_static
r_int
id|rme9652_set_adat1_input
c_func
(paren
id|rme9652_t
op_star
id|rme9652
comma
r_int
id|internal
)paren
(brace
r_int
id|restart
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|internal
)paren
(brace
id|rme9652-&gt;control_register
op_or_assign
id|RME9652_ADAT1_INTERNAL
suffix:semicolon
)brace
r_else
(brace
id|rme9652-&gt;control_register
op_and_assign
op_complement
id|RME9652_ADAT1_INTERNAL
suffix:semicolon
)brace
multiline_comment|/* XXX do we actually need to stop the card when we do this ? */
r_if
c_cond
(paren
(paren
id|restart
op_assign
id|rme9652-&gt;running
)paren
)paren
(brace
id|rme9652_stop
c_func
(paren
id|rme9652
)paren
suffix:semicolon
)brace
id|rme9652_write
c_func
(paren
id|rme9652
comma
id|RME9652_control_register
comma
id|rme9652-&gt;control_register
)paren
suffix:semicolon
r_if
c_cond
(paren
id|restart
)paren
(brace
id|rme9652_start
c_func
(paren
id|rme9652
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_info_adat1_in
r_static
r_int
id|snd_rme9652_info_adat1_in
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
r_static
r_char
op_star
id|texts
(braket
l_int|2
)braket
op_assign
(brace
l_string|&quot;ADAT1&quot;
comma
l_string|&quot;Internal&quot;
)brace
suffix:semicolon
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_ENUMERATED
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
id|uinfo-&gt;value.enumerated.items
op_assign
l_int|2
suffix:semicolon
r_if
c_cond
(paren
id|uinfo-&gt;value.enumerated.item
OG
l_int|1
)paren
id|uinfo-&gt;value.enumerated.item
op_assign
l_int|1
suffix:semicolon
id|strcpy
c_func
(paren
id|uinfo-&gt;value.enumerated.name
comma
id|texts
(braket
id|uinfo-&gt;value.enumerated.item
)braket
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_get_adat1_in
r_static
r_int
id|snd_rme9652_get_adat1_in
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|rme9652_t
op_star
id|rme9652
op_assign
id|_snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
id|rme9652_adat1_in
c_func
(paren
id|rme9652
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_put_adat1_in
r_static
r_int
id|snd_rme9652_put_adat1_in
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|rme9652_t
op_star
id|rme9652
op_assign
id|_snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
id|change
suffix:semicolon
r_int
r_int
id|val
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snd_rme9652_use_is_exclusive
c_func
(paren
id|rme9652
)paren
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
id|val
op_assign
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_mod
l_int|2
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|change
op_assign
id|val
op_ne
id|rme9652_adat1_in
c_func
(paren
id|rme9652
)paren
suffix:semicolon
r_if
c_cond
(paren
id|change
)paren
id|rme9652_set_adat1_input
c_func
(paren
id|rme9652
comma
id|val
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_return
id|change
suffix:semicolon
)brace
DECL|macro|RME9652_SPDIF_IN
mdefine_line|#define RME9652_SPDIF_IN(xname, xindex) &bslash;&n;{ iface: SNDRV_CTL_ELEM_IFACE_PCM, name: xname, index: xindex, &bslash;&n;  info: snd_rme9652_info_spdif_in, &bslash;&n;  get: snd_rme9652_get_spdif_in, put: snd_rme9652_put_spdif_in }
DECL|function|rme9652_spdif_in
r_static
r_int
r_int
id|rme9652_spdif_in
c_func
(paren
id|rme9652_t
op_star
id|rme9652
)paren
(brace
r_return
id|rme9652_decode_spdif_in
c_func
(paren
id|rme9652-&gt;control_register
op_amp
id|RME9652_inp
)paren
suffix:semicolon
)brace
DECL|function|rme9652_set_spdif_input
r_static
r_int
id|rme9652_set_spdif_input
c_func
(paren
id|rme9652_t
op_star
id|rme9652
comma
r_int
id|in
)paren
(brace
r_int
id|restart
op_assign
l_int|0
suffix:semicolon
id|rme9652-&gt;control_register
op_and_assign
op_complement
id|RME9652_inp
suffix:semicolon
id|rme9652-&gt;control_register
op_or_assign
id|rme9652_encode_spdif_in
c_func
(paren
id|in
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|restart
op_assign
id|rme9652-&gt;running
)paren
)paren
(brace
id|rme9652_stop
c_func
(paren
id|rme9652
)paren
suffix:semicolon
)brace
id|rme9652_write
c_func
(paren
id|rme9652
comma
id|RME9652_control_register
comma
id|rme9652-&gt;control_register
)paren
suffix:semicolon
r_if
c_cond
(paren
id|restart
)paren
(brace
id|rme9652_start
c_func
(paren
id|rme9652
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_info_spdif_in
r_static
r_int
id|snd_rme9652_info_spdif_in
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
r_static
r_char
op_star
id|texts
(braket
l_int|3
)braket
op_assign
(brace
l_string|&quot;ADAT1&quot;
comma
l_string|&quot;Coaxial&quot;
comma
l_string|&quot;Internal&quot;
)brace
suffix:semicolon
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_ENUMERATED
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
id|uinfo-&gt;value.enumerated.items
op_assign
l_int|3
suffix:semicolon
r_if
c_cond
(paren
id|uinfo-&gt;value.enumerated.item
OG
l_int|2
)paren
id|uinfo-&gt;value.enumerated.item
op_assign
l_int|2
suffix:semicolon
id|strcpy
c_func
(paren
id|uinfo-&gt;value.enumerated.name
comma
id|texts
(braket
id|uinfo-&gt;value.enumerated.item
)braket
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_get_spdif_in
r_static
r_int
id|snd_rme9652_get_spdif_in
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|rme9652_t
op_star
id|rme9652
op_assign
id|_snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
id|rme9652_spdif_in
c_func
(paren
id|rme9652
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_put_spdif_in
r_static
r_int
id|snd_rme9652_put_spdif_in
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|rme9652_t
op_star
id|rme9652
op_assign
id|_snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
id|change
suffix:semicolon
r_int
r_int
id|val
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snd_rme9652_use_is_exclusive
c_func
(paren
id|rme9652
)paren
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
id|val
op_assign
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_mod
l_int|3
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|change
op_assign
id|val
op_ne
id|rme9652_spdif_in
c_func
(paren
id|rme9652
)paren
suffix:semicolon
r_if
c_cond
(paren
id|change
)paren
id|rme9652_set_spdif_input
c_func
(paren
id|rme9652
comma
id|val
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_return
id|change
suffix:semicolon
)brace
DECL|macro|RME9652_SPDIF_OUT
mdefine_line|#define RME9652_SPDIF_OUT(xname, xindex) &bslash;&n;{ iface: SNDRV_CTL_ELEM_IFACE_PCM, name: xname, index: xindex, &bslash;&n;  info: snd_rme9652_info_spdif_out, &bslash;&n;  get: snd_rme9652_get_spdif_out, put: snd_rme9652_put_spdif_out }
DECL|function|rme9652_spdif_out
r_static
r_int
id|rme9652_spdif_out
c_func
(paren
id|rme9652_t
op_star
id|rme9652
)paren
(brace
r_return
(paren
id|rme9652-&gt;control_register
op_amp
id|RME9652_opt_out
)paren
ques
c_cond
l_int|1
suffix:colon
l_int|0
suffix:semicolon
)brace
DECL|function|rme9652_set_spdif_output
r_static
r_int
id|rme9652_set_spdif_output
c_func
(paren
id|rme9652_t
op_star
id|rme9652
comma
r_int
id|out
)paren
(brace
r_int
id|restart
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|out
)paren
(brace
id|rme9652-&gt;control_register
op_or_assign
id|RME9652_opt_out
suffix:semicolon
)brace
r_else
(brace
id|rme9652-&gt;control_register
op_and_assign
op_complement
id|RME9652_opt_out
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|restart
op_assign
id|rme9652-&gt;running
)paren
)paren
(brace
id|rme9652_stop
c_func
(paren
id|rme9652
)paren
suffix:semicolon
)brace
id|rme9652_write
c_func
(paren
id|rme9652
comma
id|RME9652_control_register
comma
id|rme9652-&gt;control_register
)paren
suffix:semicolon
r_if
c_cond
(paren
id|restart
)paren
(brace
id|rme9652_start
c_func
(paren
id|rme9652
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_info_spdif_out
r_static
r_int
id|snd_rme9652_info_spdif_out
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_BOOLEAN
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
id|uinfo-&gt;value.integer.min
op_assign
l_int|0
suffix:semicolon
id|uinfo-&gt;value.integer.max
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_get_spdif_out
r_static
r_int
id|snd_rme9652_get_spdif_out
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|rme9652_t
op_star
id|rme9652
op_assign
id|_snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
id|rme9652_spdif_out
c_func
(paren
id|rme9652
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_put_spdif_out
r_static
r_int
id|snd_rme9652_put_spdif_out
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|rme9652_t
op_star
id|rme9652
op_assign
id|_snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
id|change
suffix:semicolon
r_int
r_int
id|val
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snd_rme9652_use_is_exclusive
c_func
(paren
id|rme9652
)paren
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
id|val
op_assign
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_amp
l_int|1
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|change
op_assign
id|val
op_ne
id|rme9652_spdif_out
c_func
(paren
id|rme9652
)paren
suffix:semicolon
id|rme9652_set_spdif_output
c_func
(paren
id|rme9652
comma
id|val
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_return
id|change
suffix:semicolon
)brace
DECL|macro|RME9652_SYNC_MODE
mdefine_line|#define RME9652_SYNC_MODE(xname, xindex) &bslash;&n;{ iface: SNDRV_CTL_ELEM_IFACE_PCM, name: xname, index: xindex, &bslash;&n;  info: snd_rme9652_info_sync_mode, &bslash;&n;  get: snd_rme9652_get_sync_mode, put: snd_rme9652_put_sync_mode }
DECL|function|rme9652_sync_mode
r_static
r_int
id|rme9652_sync_mode
c_func
(paren
id|rme9652_t
op_star
id|rme9652
)paren
(brace
r_if
c_cond
(paren
id|rme9652-&gt;control_register
op_amp
id|RME9652_wsel
)paren
(brace
r_return
l_int|2
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|rme9652-&gt;control_register
op_amp
id|RME9652_Master
)paren
(brace
r_return
l_int|1
suffix:semicolon
)brace
r_else
(brace
r_return
l_int|0
suffix:semicolon
)brace
)brace
DECL|function|rme9652_set_sync_mode
r_static
r_int
id|rme9652_set_sync_mode
c_func
(paren
id|rme9652_t
op_star
id|rme9652
comma
r_int
id|mode
)paren
(brace
r_int
id|restart
op_assign
l_int|0
suffix:semicolon
r_switch
c_cond
(paren
id|mode
)paren
(brace
r_case
l_int|0
suffix:colon
id|rme9652-&gt;control_register
op_and_assign
op_complement
(paren
id|RME9652_Master
op_or
id|RME9652_wsel
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|rme9652-&gt;control_register
op_assign
(paren
id|rme9652-&gt;control_register
op_amp
op_complement
id|RME9652_wsel
)paren
op_or
id|RME9652_Master
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|rme9652-&gt;control_register
op_or_assign
(paren
id|RME9652_Master
op_or
id|RME9652_wsel
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|restart
op_assign
id|rme9652-&gt;running
)paren
)paren
(brace
id|rme9652_stop
c_func
(paren
id|rme9652
)paren
suffix:semicolon
)brace
id|rme9652_write
c_func
(paren
id|rme9652
comma
id|RME9652_control_register
comma
id|rme9652-&gt;control_register
)paren
suffix:semicolon
r_if
c_cond
(paren
id|restart
)paren
(brace
id|rme9652_start
c_func
(paren
id|rme9652
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_info_sync_mode
r_static
r_int
id|snd_rme9652_info_sync_mode
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
r_static
r_char
op_star
id|texts
(braket
l_int|3
)braket
op_assign
(brace
l_string|&quot;AutoSync&quot;
comma
l_string|&quot;Master&quot;
comma
l_string|&quot;Word Clock&quot;
)brace
suffix:semicolon
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_ENUMERATED
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
id|uinfo-&gt;value.enumerated.items
op_assign
l_int|3
suffix:semicolon
r_if
c_cond
(paren
id|uinfo-&gt;value.enumerated.item
OG
l_int|2
)paren
id|uinfo-&gt;value.enumerated.item
op_assign
l_int|2
suffix:semicolon
id|strcpy
c_func
(paren
id|uinfo-&gt;value.enumerated.name
comma
id|texts
(braket
id|uinfo-&gt;value.enumerated.item
)braket
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_get_sync_mode
r_static
r_int
id|snd_rme9652_get_sync_mode
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|rme9652_t
op_star
id|rme9652
op_assign
id|_snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
id|rme9652_sync_mode
c_func
(paren
id|rme9652
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_put_sync_mode
r_static
r_int
id|snd_rme9652_put_sync_mode
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|rme9652_t
op_star
id|rme9652
op_assign
id|_snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
id|change
suffix:semicolon
r_int
r_int
id|val
suffix:semicolon
id|val
op_assign
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_mod
l_int|3
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|change
op_assign
id|val
op_ne
id|rme9652_sync_mode
c_func
(paren
id|rme9652
)paren
suffix:semicolon
id|rme9652_set_sync_mode
c_func
(paren
id|rme9652
comma
id|val
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_return
id|change
suffix:semicolon
)brace
DECL|macro|RME9652_SYNC_PREF
mdefine_line|#define RME9652_SYNC_PREF(xname, xindex) &bslash;&n;{ iface: SNDRV_CTL_ELEM_IFACE_PCM, name: xname, index: xindex, &bslash;&n;  info: snd_rme9652_info_sync_pref, &bslash;&n;  get: snd_rme9652_get_sync_pref, put: snd_rme9652_put_sync_pref }
DECL|function|rme9652_sync_pref
r_static
r_int
id|rme9652_sync_pref
c_func
(paren
id|rme9652_t
op_star
id|rme9652
)paren
(brace
r_switch
c_cond
(paren
id|rme9652-&gt;control_register
op_amp
id|RME9652_SyncPref_Mask
)paren
(brace
r_case
id|RME9652_SyncPref_ADAT1
suffix:colon
r_return
id|RME9652_SYNC_FROM_ADAT1
suffix:semicolon
r_case
id|RME9652_SyncPref_ADAT2
suffix:colon
r_return
id|RME9652_SYNC_FROM_ADAT2
suffix:semicolon
r_case
id|RME9652_SyncPref_ADAT3
suffix:colon
r_return
id|RME9652_SYNC_FROM_ADAT3
suffix:semicolon
r_case
id|RME9652_SyncPref_SPDIF
suffix:colon
r_return
id|RME9652_SYNC_FROM_SPDIF
suffix:semicolon
)brace
multiline_comment|/* Not reachable */
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|rme9652_set_sync_pref
r_static
r_int
id|rme9652_set_sync_pref
c_func
(paren
id|rme9652_t
op_star
id|rme9652
comma
r_int
id|pref
)paren
(brace
r_int
id|restart
suffix:semicolon
id|rme9652-&gt;control_register
op_and_assign
op_complement
id|RME9652_SyncPref_Mask
suffix:semicolon
r_switch
c_cond
(paren
id|pref
)paren
(brace
r_case
id|RME9652_SYNC_FROM_ADAT1
suffix:colon
id|rme9652-&gt;control_register
op_or_assign
id|RME9652_SyncPref_ADAT1
suffix:semicolon
r_break
suffix:semicolon
r_case
id|RME9652_SYNC_FROM_ADAT2
suffix:colon
id|rme9652-&gt;control_register
op_or_assign
id|RME9652_SyncPref_ADAT2
suffix:semicolon
r_break
suffix:semicolon
r_case
id|RME9652_SYNC_FROM_ADAT3
suffix:colon
id|rme9652-&gt;control_register
op_or_assign
id|RME9652_SyncPref_ADAT3
suffix:semicolon
r_break
suffix:semicolon
r_case
id|RME9652_SYNC_FROM_SPDIF
suffix:colon
id|rme9652-&gt;control_register
op_or_assign
id|RME9652_SyncPref_SPDIF
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|restart
op_assign
id|rme9652-&gt;running
)paren
)paren
(brace
id|rme9652_stop
c_func
(paren
id|rme9652
)paren
suffix:semicolon
)brace
id|rme9652_write
c_func
(paren
id|rme9652
comma
id|RME9652_control_register
comma
id|rme9652-&gt;control_register
)paren
suffix:semicolon
r_if
c_cond
(paren
id|restart
)paren
(brace
id|rme9652_start
c_func
(paren
id|rme9652
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_info_sync_pref
r_static
r_int
id|snd_rme9652_info_sync_pref
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
r_static
r_char
op_star
id|texts
(braket
l_int|4
)braket
op_assign
(brace
l_string|&quot;IEC958 In&quot;
comma
l_string|&quot;ADAT1 In&quot;
comma
l_string|&quot;ADAT2 In&quot;
comma
l_string|&quot;ADAT3 In&quot;
)brace
suffix:semicolon
id|rme9652_t
op_star
id|rme9652
op_assign
id|_snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_ENUMERATED
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
id|uinfo-&gt;value.enumerated.items
op_assign
id|rme9652-&gt;ss_channels
op_eq
id|RME9652_NCHANNELS
ques
c_cond
l_int|4
suffix:colon
l_int|3
suffix:semicolon
r_if
c_cond
(paren
id|uinfo-&gt;value.enumerated.item
op_ge
id|uinfo-&gt;value.enumerated.items
)paren
id|uinfo-&gt;value.enumerated.item
op_assign
id|uinfo-&gt;value.enumerated.items
op_minus
l_int|1
suffix:semicolon
id|strcpy
c_func
(paren
id|uinfo-&gt;value.enumerated.name
comma
id|texts
(braket
id|uinfo-&gt;value.enumerated.item
)braket
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_get_sync_pref
r_static
r_int
id|snd_rme9652_get_sync_pref
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|rme9652_t
op_star
id|rme9652
op_assign
id|_snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
id|rme9652_sync_pref
c_func
(paren
id|rme9652
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_put_sync_pref
r_static
r_int
id|snd_rme9652_put_sync_pref
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|rme9652_t
op_star
id|rme9652
op_assign
id|_snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
id|change
comma
id|max
suffix:semicolon
r_int
r_int
id|val
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snd_rme9652_use_is_exclusive
c_func
(paren
id|rme9652
)paren
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
id|max
op_assign
id|rme9652-&gt;ss_channels
op_eq
id|RME9652_NCHANNELS
ques
c_cond
l_int|4
suffix:colon
l_int|3
suffix:semicolon
id|val
op_assign
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_mod
id|max
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|change
op_assign
id|val
op_ne
id|rme9652_sync_pref
c_func
(paren
id|rme9652
)paren
suffix:semicolon
id|rme9652_set_sync_pref
c_func
(paren
id|rme9652
comma
id|val
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_return
id|change
suffix:semicolon
)brace
DECL|function|snd_rme9652_info_thru
r_static
r_int
id|snd_rme9652_info_thru
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|rme9652_t
op_star
id|rme9652
op_assign
id|_snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_BOOLEAN
suffix:semicolon
id|uinfo-&gt;count
op_assign
id|rme9652-&gt;ss_channels
suffix:semicolon
id|uinfo-&gt;value.integer.min
op_assign
l_int|0
suffix:semicolon
id|uinfo-&gt;value.integer.max
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_get_thru
r_static
r_int
id|snd_rme9652_get_thru
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|rme9652_t
op_star
id|rme9652
op_assign
id|_snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_int
id|k
suffix:semicolon
id|u32
id|thru_bits
op_assign
id|rme9652-&gt;thru_bits
suffix:semicolon
r_for
c_loop
(paren
id|k
op_assign
l_int|0
suffix:semicolon
id|k
OL
id|rme9652-&gt;ss_channels
suffix:semicolon
op_increment
id|k
)paren
(brace
id|ucontrol-&gt;value.integer.value
(braket
id|k
)braket
op_assign
op_logical_neg
op_logical_neg
(paren
id|thru_bits
op_amp
(paren
l_int|1
op_lshift
id|k
)paren
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_put_thru
r_static
r_int
id|snd_rme9652_put_thru
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|rme9652_t
op_star
id|rme9652
op_assign
id|_snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
id|change
suffix:semicolon
r_int
r_int
id|chn
suffix:semicolon
id|u32
id|thru_bits
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snd_rme9652_use_is_exclusive
c_func
(paren
id|rme9652
)paren
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
r_for
c_loop
(paren
id|chn
op_assign
l_int|0
suffix:semicolon
id|chn
OL
id|rme9652-&gt;ss_channels
suffix:semicolon
op_increment
id|chn
)paren
(brace
r_if
c_cond
(paren
id|ucontrol-&gt;value.integer.value
(braket
id|chn
)braket
)paren
id|thru_bits
op_or_assign
l_int|1
op_lshift
id|chn
suffix:semicolon
)brace
id|spin_lock_irqsave
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|change
op_assign
id|thru_bits
op_xor
id|rme9652-&gt;thru_bits
suffix:semicolon
r_if
c_cond
(paren
id|change
)paren
(brace
r_for
c_loop
(paren
id|chn
op_assign
l_int|0
suffix:semicolon
id|chn
OL
id|rme9652-&gt;ss_channels
suffix:semicolon
op_increment
id|chn
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|change
op_amp
(paren
l_int|1
op_lshift
id|chn
)paren
)paren
)paren
r_continue
suffix:semicolon
id|rme9652_set_thru
c_func
(paren
id|rme9652
comma
id|chn
comma
id|thru_bits
op_amp
(paren
l_int|1
op_lshift
id|chn
)paren
)paren
suffix:semicolon
)brace
)brace
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_return
op_logical_neg
op_logical_neg
id|change
suffix:semicolon
)brace
DECL|macro|RME9652_PASSTHRU
mdefine_line|#define RME9652_PASSTHRU(xname, xindex) &bslash;&n;{ iface: SNDRV_CTL_ELEM_IFACE_PCM, name: xname, index: xindex, &bslash;&n;  info: snd_rme9652_info_passthru, &bslash;&n;  put: snd_rme9652_put_passthru, &bslash;&n;  get: snd_rme9652_get_passthru }
DECL|function|snd_rme9652_info_passthru
r_static
r_int
id|snd_rme9652_info_passthru
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_BOOLEAN
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
id|uinfo-&gt;value.integer.min
op_assign
l_int|0
suffix:semicolon
id|uinfo-&gt;value.integer.max
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_get_passthru
r_static
r_int
id|snd_rme9652_get_passthru
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|rme9652_t
op_star
id|rme9652
op_assign
id|_snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
id|rme9652-&gt;passthru
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_put_passthru
r_static
r_int
id|snd_rme9652_put_passthru
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|rme9652_t
op_star
id|rme9652
op_assign
id|_snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
id|change
suffix:semicolon
r_int
r_int
id|val
suffix:semicolon
r_int
id|err
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snd_rme9652_use_is_exclusive
c_func
(paren
id|rme9652
)paren
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
id|val
op_assign
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_amp
l_int|1
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|change
op_assign
(paren
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_ne
id|rme9652-&gt;passthru
)paren
suffix:semicolon
r_if
c_cond
(paren
id|change
)paren
id|err
op_assign
id|rme9652_set_passthru
c_func
(paren
id|rme9652
comma
id|val
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_return
id|err
ques
c_cond
id|err
suffix:colon
id|change
suffix:semicolon
)brace
multiline_comment|/* Read-only switches */
DECL|macro|RME9652_SPDIF_RATE
mdefine_line|#define RME9652_SPDIF_RATE(xname, xindex) &bslash;&n;{ iface: SNDRV_CTL_ELEM_IFACE_PCM, name: xname, index: xindex, &bslash;&n;  access: SNDRV_CTL_ELEM_ACCESS_READ | SNDRV_CTL_ELEM_ACCESS_VOLATILE, &bslash;&n;  info: snd_rme9652_info_spdif_rate, &bslash;&n;  get: snd_rme9652_get_spdif_rate }
DECL|function|snd_rme9652_info_spdif_rate
r_static
r_int
id|snd_rme9652_info_spdif_rate
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_INTEGER
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
id|uinfo-&gt;value.integer.min
op_assign
l_int|0
suffix:semicolon
id|uinfo-&gt;value.integer.max
op_assign
l_int|96000
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_get_spdif_rate
r_static
r_int
id|snd_rme9652_get_spdif_rate
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|rme9652_t
op_star
id|rme9652
op_assign
id|_snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
id|rme9652_spdif_sample_rate
c_func
(paren
id|rme9652
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|macro|RME9652_ADAT_SYNC
mdefine_line|#define RME9652_ADAT_SYNC(xname, xindex, xidx) &bslash;&n;{ iface: SNDRV_CTL_ELEM_IFACE_PCM, name: xname, index: xindex, &bslash;&n;  access: SNDRV_CTL_ELEM_ACCESS_READ | SNDRV_CTL_ELEM_ACCESS_VOLATILE, &bslash;&n;  info: snd_rme9652_info_adat_sync, &bslash;&n;  get: snd_rme9652_get_adat_sync, private_value: xidx }
DECL|function|snd_rme9652_info_adat_sync
r_static
r_int
id|snd_rme9652_info_adat_sync
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
r_static
r_char
op_star
id|texts
(braket
l_int|4
)braket
op_assign
(brace
l_string|&quot;No Lock&quot;
comma
l_string|&quot;Lock&quot;
comma
l_string|&quot;No Lock Sync&quot;
comma
l_string|&quot;Lock Sync&quot;
)brace
suffix:semicolon
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_ENUMERATED
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
id|uinfo-&gt;value.enumerated.items
op_assign
l_int|4
suffix:semicolon
r_if
c_cond
(paren
id|uinfo-&gt;value.enumerated.item
op_ge
id|uinfo-&gt;value.enumerated.items
)paren
id|uinfo-&gt;value.enumerated.item
op_assign
id|uinfo-&gt;value.enumerated.items
op_minus
l_int|1
suffix:semicolon
id|strcpy
c_func
(paren
id|uinfo-&gt;value.enumerated.name
comma
id|texts
(braket
id|uinfo-&gt;value.enumerated.item
)braket
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_get_adat_sync
r_static
r_int
id|snd_rme9652_get_adat_sync
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|rme9652_t
op_star
id|rme9652
op_assign
id|_snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_int
id|mask1
comma
id|mask2
comma
id|val
suffix:semicolon
r_switch
c_cond
(paren
id|kcontrol-&gt;private_value
)paren
(brace
r_case
l_int|0
suffix:colon
id|mask1
op_assign
id|RME9652_lock_0
suffix:semicolon
id|mask2
op_assign
id|RME9652_sync_0
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|mask1
op_assign
id|RME9652_lock_1
suffix:semicolon
id|mask2
op_assign
id|RME9652_sync_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|mask1
op_assign
id|RME9652_lock_2
suffix:semicolon
id|mask2
op_assign
id|RME9652_sync_2
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|val
op_assign
id|rme9652_read
c_func
(paren
id|rme9652
comma
id|RME9652_status_register
)paren
suffix:semicolon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
(paren
id|val
op_amp
id|mask1
)paren
ques
c_cond
l_int|1
suffix:colon
l_int|0
suffix:semicolon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_or_assign
(paren
id|val
op_amp
id|mask2
)paren
ques
c_cond
l_int|2
suffix:colon
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|macro|RME9652_TC_VALID
mdefine_line|#define RME9652_TC_VALID(xname, xindex) &bslash;&n;{ iface: SNDRV_CTL_ELEM_IFACE_PCM, name: xname, index: xindex, &bslash;&n;  access: SNDRV_CTL_ELEM_ACCESS_READ | SNDRV_CTL_ELEM_ACCESS_VOLATILE, &bslash;&n;  info: snd_rme9652_info_tc_valid, &bslash;&n;  get: snd_rme9652_get_tc_valid }
DECL|function|snd_rme9652_info_tc_valid
r_static
r_int
id|snd_rme9652_info_tc_valid
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_BOOLEAN
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
id|uinfo-&gt;value.integer.min
op_assign
l_int|0
suffix:semicolon
id|uinfo-&gt;value.integer.max
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_get_tc_valid
r_static
r_int
id|snd_rme9652_get_tc_valid
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|rme9652_t
op_star
id|rme9652
op_assign
id|_snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
(paren
id|rme9652_read
c_func
(paren
id|rme9652
comma
id|RME9652_status_register
)paren
op_amp
id|RME9652_tc_valid
)paren
ques
c_cond
l_int|1
suffix:colon
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#if ALSA_HAS_STANDARD_WAY_OF_RETURNING_TIMECODE
multiline_comment|/* FIXME: this routine needs a port to the new control API --jk */
DECL|function|snd_rme9652_get_tc_value
r_static
r_int
id|snd_rme9652_get_tc_value
c_func
(paren
r_void
op_star
id|private_data
comma
id|snd_kswitch_t
op_star
id|kswitch
comma
id|snd_switch_t
op_star
id|uswitch
)paren
(brace
id|rme9652_t
op_star
id|s
op_assign
(paren
id|rme9652_t
op_star
)paren
id|private_data
suffix:semicolon
id|u32
id|value
suffix:semicolon
r_int
id|i
suffix:semicolon
id|uswitch-&gt;type
op_assign
id|SNDRV_SW_TYPE_DWORD
suffix:semicolon
r_if
c_cond
(paren
(paren
id|rme9652_read
c_func
(paren
id|s
comma
id|RME9652_status_register
)paren
op_amp
id|RME9652_tc_valid
)paren
op_eq
l_int|0
)paren
(brace
id|uswitch-&gt;value.data32
(braket
l_int|0
)braket
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* timecode request */
id|rme9652_write
c_func
(paren
id|s
comma
id|RME9652_time_code
comma
l_int|0
)paren
suffix:semicolon
multiline_comment|/* XXX bug alert: loop-based timing !!!! */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|50
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|rme9652_read
c_func
(paren
id|s
comma
id|i
op_star
l_int|4
)paren
op_amp
id|RME9652_tc_busy
)paren
)paren
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|rme9652_read
c_func
(paren
id|s
comma
id|i
op_star
l_int|4
)paren
op_amp
id|RME9652_tc_busy
)paren
)paren
(brace
r_return
op_minus
id|EIO
suffix:semicolon
)brace
id|value
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|32
suffix:semicolon
id|i
op_increment
)paren
(brace
id|value
op_rshift_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|rme9652_read
c_func
(paren
id|s
comma
id|i
op_star
l_int|4
)paren
op_amp
id|RME9652_tc_out
)paren
id|value
op_or_assign
l_int|0x80000000
suffix:semicolon
)brace
r_if
c_cond
(paren
id|value
OG
l_int|2
op_star
l_int|60
op_star
l_int|48000
)paren
(brace
id|value
op_sub_assign
l_int|2
op_star
l_int|60
op_star
l_int|48000
suffix:semicolon
)brace
r_else
(brace
id|value
op_assign
l_int|0
suffix:semicolon
)brace
id|uswitch-&gt;value.data32
(braket
l_int|0
)braket
op_assign
id|value
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#endif&t;&t;&t;&t;/* ALSA_HAS_STANDARD_WAY_OF_RETURNING_TIMECODE */
DECL|macro|RME9652_CONTROLS
mdefine_line|#define RME9652_CONTROLS (sizeof(snd_rme9652_controls)/sizeof(snd_kcontrol_new_t))
DECL|variable|snd_rme9652_controls
r_static
id|snd_kcontrol_new_t
id|snd_rme9652_controls
(braket
)braket
op_assign
(brace
(brace
id|iface
suffix:colon
id|SNDRV_CTL_ELEM_IFACE_PCM
comma
id|name
suffix:colon
id|SNDRV_CTL_NAME_IEC958
c_func
(paren
l_string|&quot;&quot;
comma
id|PLAYBACK
comma
id|DEFAULT
)paren
comma
id|info
suffix:colon
id|snd_rme9652_control_spdif_info
comma
id|get
suffix:colon
id|snd_rme9652_control_spdif_get
comma
id|put
suffix:colon
id|snd_rme9652_control_spdif_put
comma
)brace
comma
(brace
id|access
suffix:colon
id|SNDRV_CTL_ELEM_ACCESS_READWRITE
op_or
id|SNDRV_CTL_ELEM_ACCESS_INACTIVE
comma
id|iface
suffix:colon
id|SNDRV_CTL_ELEM_IFACE_PCM
comma
id|name
suffix:colon
id|SNDRV_CTL_NAME_IEC958
c_func
(paren
l_string|&quot;&quot;
comma
id|PLAYBACK
comma
id|PCM_STREAM
)paren
comma
id|info
suffix:colon
id|snd_rme9652_control_spdif_stream_info
comma
id|get
suffix:colon
id|snd_rme9652_control_spdif_stream_get
comma
id|put
suffix:colon
id|snd_rme9652_control_spdif_stream_put
comma
)brace
comma
(brace
id|access
suffix:colon
id|SNDRV_CTL_ELEM_ACCESS_READ
comma
id|iface
suffix:colon
id|SNDRV_CTL_ELEM_IFACE_MIXER
comma
id|name
suffix:colon
id|SNDRV_CTL_NAME_IEC958
c_func
(paren
l_string|&quot;&quot;
comma
id|PLAYBACK
comma
id|CON_MASK
)paren
comma
id|info
suffix:colon
id|snd_rme9652_control_spdif_mask_info
comma
id|get
suffix:colon
id|snd_rme9652_control_spdif_mask_get
comma
id|private_value
suffix:colon
id|IEC958_AES0_NONAUDIO
op_or
id|IEC958_AES0_PROFESSIONAL
op_or
id|IEC958_AES0_CON_EMPHASIS
comma
)brace
comma
(brace
id|access
suffix:colon
id|SNDRV_CTL_ELEM_ACCESS_READ
comma
id|iface
suffix:colon
id|SNDRV_CTL_ELEM_IFACE_MIXER
comma
id|name
suffix:colon
id|SNDRV_CTL_NAME_IEC958
c_func
(paren
l_string|&quot;&quot;
comma
id|PLAYBACK
comma
id|PRO_MASK
)paren
comma
id|info
suffix:colon
id|snd_rme9652_control_spdif_mask_info
comma
id|get
suffix:colon
id|snd_rme9652_control_spdif_mask_get
comma
id|private_value
suffix:colon
id|IEC958_AES0_NONAUDIO
op_or
id|IEC958_AES0_PROFESSIONAL
op_or
id|IEC958_AES0_PRO_EMPHASIS
comma
)brace
comma
id|RME9652_SPDIF_IN
c_func
(paren
l_string|&quot;IEC958 Input Connector&quot;
comma
l_int|0
)paren
comma
id|RME9652_SPDIF_OUT
c_func
(paren
l_string|&quot;IEC958 Output also on ADAT1&quot;
comma
l_int|0
)paren
comma
id|RME9652_SYNC_MODE
c_func
(paren
l_string|&quot;Sync Mode&quot;
comma
l_int|0
)paren
comma
id|RME9652_SYNC_PREF
c_func
(paren
l_string|&quot;Preferred Sync Source&quot;
comma
l_int|0
)paren
comma
(brace
id|iface
suffix:colon
id|SNDRV_CTL_ELEM_IFACE_PCM
comma
id|name
suffix:colon
l_string|&quot;Channels Thru&quot;
comma
id|index
suffix:colon
l_int|0
comma
id|info
suffix:colon
id|snd_rme9652_info_thru
comma
id|get
suffix:colon
id|snd_rme9652_get_thru
comma
id|put
suffix:colon
id|snd_rme9652_put_thru
comma
)brace
comma
id|RME9652_SPDIF_RATE
c_func
(paren
l_string|&quot;IEC958 Sample Rate&quot;
comma
l_int|0
)paren
comma
id|RME9652_ADAT_SYNC
c_func
(paren
l_string|&quot;ADAT1 Sync Check&quot;
comma
l_int|0
comma
l_int|0
)paren
comma
id|RME9652_ADAT_SYNC
c_func
(paren
l_string|&quot;ADAT2 Sync Check&quot;
comma
l_int|0
comma
l_int|1
)paren
comma
id|RME9652_ADAT_SYNC
c_func
(paren
l_string|&quot;ADAT3 Sync Check&quot;
comma
l_int|0
comma
l_int|2
)paren
comma
id|RME9652_TC_VALID
c_func
(paren
l_string|&quot;Timecode Valid&quot;
comma
l_int|0
)paren
comma
id|RME9652_PASSTHRU
c_func
(paren
l_string|&quot;Passthru&quot;
comma
l_int|0
)paren
)brace
suffix:semicolon
DECL|variable|snd_rme9652_adat3_check
r_static
id|snd_kcontrol_new_t
id|snd_rme9652_adat3_check
op_assign
id|RME9652_ADAT_SYNC
c_func
(paren
l_string|&quot;ADAT3 Sync Check&quot;
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
DECL|variable|snd_rme9652_adat1_input
r_static
id|snd_kcontrol_new_t
id|snd_rme9652_adat1_input
op_assign
id|RME9652_ADAT1_IN
c_func
(paren
l_string|&quot;ADAT1 Input Source&quot;
comma
l_int|0
)paren
suffix:semicolon
DECL|function|snd_rme9652_create_controls
r_int
id|snd_rme9652_create_controls
c_func
(paren
id|snd_card_t
op_star
id|card
comma
id|rme9652_t
op_star
id|rme9652
)paren
(brace
r_int
id|idx
comma
id|err
suffix:semicolon
id|snd_kcontrol_t
op_star
id|kctl
suffix:semicolon
r_for
c_loop
(paren
id|idx
op_assign
l_int|0
suffix:semicolon
id|idx
OL
id|RME9652_CONTROLS
suffix:semicolon
id|idx
op_increment
)paren
(brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|card
comma
id|kctl
op_assign
id|snd_ctl_new1
c_func
(paren
op_amp
id|snd_rme9652_controls
(braket
id|idx
)braket
comma
id|rme9652
)paren
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_if
c_cond
(paren
id|idx
op_eq
l_int|1
)paren
multiline_comment|/* IEC958 (S/PDIF) Stream */
id|rme9652-&gt;spdif_ctl
op_assign
id|kctl
suffix:semicolon
)brace
r_if
c_cond
(paren
id|rme9652-&gt;ss_channels
op_eq
id|RME9652_NCHANNELS
)paren
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|card
comma
id|kctl
op_assign
id|snd_ctl_new1
c_func
(paren
op_amp
id|snd_rme9652_adat3_check
comma
id|rme9652
)paren
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_if
c_cond
(paren
id|rme9652-&gt;hw_rev
op_ge
l_int|15
)paren
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|card
comma
id|kctl
op_assign
id|snd_ctl_new1
c_func
(paren
op_amp
id|snd_rme9652_adat1_input
comma
id|rme9652
)paren
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*------------------------------------------------------------&n;   /proc interface &n; ------------------------------------------------------------*/
r_static
r_void
DECL|function|snd_rme9652_proc_read
id|snd_rme9652_proc_read
c_func
(paren
id|snd_info_entry_t
op_star
id|entry
comma
id|snd_info_buffer_t
op_star
id|buffer
)paren
(brace
id|rme9652_t
op_star
id|rme9652
op_assign
(paren
id|rme9652_t
op_star
)paren
id|entry-&gt;private_data
suffix:semicolon
id|u32
id|thru_bits
op_assign
id|rme9652-&gt;thru_bits
suffix:semicolon
r_int
id|show_auto_sync_source
op_assign
l_int|0
suffix:semicolon
r_int
id|i
suffix:semicolon
r_int
r_int
id|status
suffix:semicolon
r_int
id|x
suffix:semicolon
id|status
op_assign
id|rme9652_read
c_func
(paren
id|rme9652
comma
id|RME9652_status_register
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;%s (Card #%d)&bslash;n&quot;
comma
id|rme9652-&gt;card_name
comma
id|rme9652-&gt;card-&gt;number
op_plus
l_int|1
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Buffers: capture %p playback %p&bslash;n&quot;
comma
id|rme9652-&gt;capture_buffer
comma
id|rme9652-&gt;playback_buffer
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;IRQ: %d Registers bus: 0x%lx VM: 0x%lx&bslash;n&quot;
comma
id|rme9652-&gt;irq
comma
id|rme9652-&gt;port
comma
id|rme9652-&gt;iobase
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Control register: %x&bslash;n&quot;
comma
id|rme9652-&gt;control_register
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|x
op_assign
l_int|1
op_lshift
(paren
l_int|6
op_plus
id|rme9652_decode_latency
c_func
(paren
id|rme9652-&gt;control_register
op_amp
id|RME9652_latency
)paren
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Latency: %d samples (2 periods of %lu bytes)&bslash;n&quot;
comma
id|x
comma
(paren
r_int
r_int
)paren
id|rme9652-&gt;period_bytes
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Hardware pointer (frames): %ld&bslash;n&quot;
comma
id|rme9652_hw_pointer
c_func
(paren
id|rme9652
)paren
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Passthru: %s&bslash;n&quot;
comma
id|rme9652-&gt;passthru
ques
c_cond
l_string|&quot;yes&quot;
suffix:colon
l_string|&quot;no&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|rme9652-&gt;control_register
op_amp
(paren
id|RME9652_Master
op_or
id|RME9652_wsel
)paren
)paren
op_eq
l_int|0
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Clock mode: autosync&bslash;n&quot;
)paren
suffix:semicolon
id|show_auto_sync_source
op_assign
l_int|1
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|rme9652-&gt;control_register
op_amp
id|RME9652_wsel
)paren
(brace
r_if
c_cond
(paren
id|status
op_amp
id|RME9652_wsel_rd
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Clock mode: word clock&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Clock mode: word clock (no signal)&bslash;n&quot;
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Clock mode: master&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|show_auto_sync_source
)paren
(brace
r_switch
c_cond
(paren
id|rme9652-&gt;control_register
op_amp
id|RME9652_SyncPref_Mask
)paren
(brace
r_case
id|RME9652_SyncPref_ADAT1
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Pref. sync source: ADAT1&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|RME9652_SyncPref_ADAT2
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Pref. sync source: ADAT2&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|RME9652_SyncPref_ADAT3
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Pref. sync source: ADAT3&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|RME9652_SyncPref_SPDIF
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Pref. sync source: IEC958&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Pref. sync source: ???&bslash;n&quot;
)paren
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|rme9652-&gt;hw_rev
op_ge
l_int|15
)paren
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;&bslash;nADAT1 Input source: %s&bslash;n&quot;
comma
(paren
id|rme9652-&gt;control_register
op_amp
id|RME9652_ADAT1_INTERNAL
)paren
ques
c_cond
l_string|&quot;Internal&quot;
suffix:colon
l_string|&quot;ADAT1 optical&quot;
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|rme9652_decode_spdif_in
c_func
(paren
id|rme9652-&gt;control_register
op_amp
id|RME9652_inp
)paren
)paren
(brace
r_case
id|RME9652_SPDIFIN_OPTICAL
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;IEC958 input: ADAT1&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|RME9652_SPDIFIN_COAXIAL
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;IEC958 input: Coaxial&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|RME9652_SPDIFIN_INTERN
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;IEC958 input: Internal&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;IEC958 input: ???&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|rme9652-&gt;control_register
op_amp
id|RME9652_opt_out
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;IEC958 output: Coaxial &amp; ADAT1&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;IEC958 output: Coaxial only&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|rme9652-&gt;control_register
op_amp
id|RME9652_PRO
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;IEC958 quality: Professional&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;IEC958 quality: Consumer&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|rme9652-&gt;control_register
op_amp
id|RME9652_EMP
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;IEC958 emphasis: on&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;IEC958 emphasis: off&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|rme9652-&gt;control_register
op_amp
id|RME9652_Dolby
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;IEC958 Dolby: on&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;IEC958 Dolby: off&bslash;n&quot;
)paren
suffix:semicolon
)brace
id|i
op_assign
id|rme9652_spdif_sample_rate
c_func
(paren
id|rme9652
)paren
suffix:semicolon
r_if
c_cond
(paren
id|i
OL
l_int|0
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;IEC958 sample rate: error flag set&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|i
op_eq
l_int|0
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;IEC958 sample rate: undetermined&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;IEC958 sample rate: %d&bslash;n&quot;
comma
id|i
)paren
suffix:semicolon
)brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;ADAT Sample rate: %dHz&bslash;n&quot;
comma
id|rme9652_adat_sample_rate
c_func
(paren
id|rme9652
)paren
)paren
suffix:semicolon
multiline_comment|/* Sync Check */
id|x
op_assign
id|status
op_amp
id|RME9652_sync_0
suffix:semicolon
r_if
c_cond
(paren
id|status
op_amp
id|RME9652_lock_0
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;ADAT1: %s&bslash;n&quot;
comma
id|x
ques
c_cond
l_string|&quot;Sync&quot;
suffix:colon
l_string|&quot;Lock&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;ADAT1: No Lock&bslash;n&quot;
)paren
suffix:semicolon
)brace
id|x
op_assign
id|status
op_amp
id|RME9652_sync_1
suffix:semicolon
r_if
c_cond
(paren
id|status
op_amp
id|RME9652_lock_1
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;ADAT2: %s&bslash;n&quot;
comma
id|x
ques
c_cond
l_string|&quot;Sync&quot;
suffix:colon
l_string|&quot;Lock&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;ADAT2: No Lock&bslash;n&quot;
)paren
suffix:semicolon
)brace
id|x
op_assign
id|status
op_amp
id|RME9652_sync_2
suffix:semicolon
r_if
c_cond
(paren
id|status
op_amp
id|RME9652_lock_2
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;ADAT3: %s&bslash;n&quot;
comma
id|x
ques
c_cond
l_string|&quot;Sync&quot;
suffix:colon
l_string|&quot;Lock&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;ADAT3: No Lock&bslash;n&quot;
)paren
suffix:semicolon
)brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Timecode signal: %s&bslash;n&quot;
comma
(paren
id|status
op_amp
id|RME9652_tc_valid
)paren
ques
c_cond
l_string|&quot;yes&quot;
suffix:colon
l_string|&quot;no&quot;
)paren
suffix:semicolon
multiline_comment|/* thru modes */
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Punch Status:&bslash;n&bslash;n&quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|rme9652-&gt;ss_channels
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|thru_bits
op_amp
(paren
l_int|1
op_lshift
id|i
)paren
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;%2d:  on &quot;
comma
id|i
op_plus
l_int|1
)paren
suffix:semicolon
)brace
r_else
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;%2d: off &quot;
comma
id|i
op_plus
l_int|1
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
(paren
id|i
op_plus
l_int|1
)paren
op_mod
l_int|8
)paren
op_eq
l_int|0
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
)brace
)brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
)brace
DECL|function|snd_rme9652_proc_init
r_static
r_void
id|__init
id|snd_rme9652_proc_init
c_func
(paren
id|rme9652_t
op_star
id|rme9652
)paren
(brace
id|snd_info_entry_t
op_star
id|entry
suffix:semicolon
r_if
c_cond
(paren
(paren
id|entry
op_assign
id|snd_info_create_card_entry
c_func
(paren
id|rme9652-&gt;card
comma
l_string|&quot;rme9652&quot;
comma
id|rme9652-&gt;card-&gt;proc_root
)paren
)paren
op_ne
l_int|NULL
)paren
(brace
id|entry-&gt;content
op_assign
id|SNDRV_INFO_CONTENT_TEXT
suffix:semicolon
id|entry-&gt;private_data
op_assign
id|rme9652
suffix:semicolon
id|entry-&gt;mode
op_assign
id|S_IFREG
op_or
id|S_IRUGO
op_or
id|S_IWUSR
suffix:semicolon
id|entry-&gt;c.text.read_size
op_assign
l_int|256
suffix:semicolon
id|entry-&gt;c.text.read
op_assign
id|snd_rme9652_proc_read
suffix:semicolon
r_if
c_cond
(paren
id|snd_info_register
c_func
(paren
id|entry
)paren
OL
l_int|0
)paren
(brace
id|snd_info_free_entry
c_func
(paren
id|entry
)paren
suffix:semicolon
id|entry
op_assign
l_int|NULL
suffix:semicolon
)brace
)brace
id|rme9652-&gt;proc_entry
op_assign
id|entry
suffix:semicolon
)brace
DECL|function|snd_rme9652_proc_done
r_static
r_void
id|snd_rme9652_proc_done
c_func
(paren
id|rme9652_t
op_star
id|rme9652
)paren
(brace
r_if
c_cond
(paren
id|rme9652-&gt;proc_entry
)paren
(brace
id|snd_info_unregister
c_func
(paren
id|rme9652-&gt;proc_entry
)paren
suffix:semicolon
id|rme9652-&gt;proc_entry
op_assign
l_int|NULL
suffix:semicolon
)brace
)brace
DECL|function|snd_rme9652_free_buffers
r_static
r_void
id|snd_rme9652_free_buffers
c_func
(paren
id|rme9652_t
op_star
id|rme9652
)paren
(brace
r_if
c_cond
(paren
id|rme9652-&gt;capture_buffer_unaligned
)paren
(brace
macro_line|#ifndef RME9652_PREALLOCATE_MEMORY
id|snd_free_pci_pages
c_func
(paren
id|rme9652-&gt;pci
comma
id|RME9652_DMA_AREA_BYTES
comma
id|rme9652-&gt;capture_buffer_unaligned
comma
id|rme9652-&gt;capture_buffer_addr
)paren
suffix:semicolon
macro_line|#else
id|snd_rme9652_free_buffer
c_func
(paren
id|rme9652-&gt;dev
comma
id|rme9652-&gt;capture_buffer_unaligned
)paren
suffix:semicolon
macro_line|#endif
)brace
r_if
c_cond
(paren
id|rme9652-&gt;playback_buffer_unaligned
)paren
(brace
macro_line|#ifndef RME9652_PREALLOCATE_MEMORY
id|snd_free_pci_pages
c_func
(paren
id|rme9652-&gt;pci
comma
id|RME9652_DMA_AREA_BYTES
comma
id|rme9652-&gt;playback_buffer_unaligned
comma
id|rme9652-&gt;playback_buffer_addr
)paren
suffix:semicolon
macro_line|#else
id|snd_rme9652_free_buffer
c_func
(paren
id|rme9652-&gt;dev
comma
id|rme9652-&gt;playback_buffer_unaligned
)paren
suffix:semicolon
macro_line|#endif
)brace
)brace
DECL|function|snd_rme9652_free
r_static
r_int
id|snd_rme9652_free
c_func
(paren
id|rme9652_t
op_star
id|rme9652
)paren
(brace
r_if
c_cond
(paren
id|rme9652-&gt;irq
op_ge
l_int|0
)paren
id|rme9652_stop
c_func
(paren
id|rme9652
)paren
suffix:semicolon
id|snd_rme9652_proc_done
c_func
(paren
id|rme9652
)paren
suffix:semicolon
id|snd_rme9652_free_buffers
c_func
(paren
id|rme9652
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rme9652-&gt;iobase
)paren
id|iounmap
c_func
(paren
(paren
r_void
op_star
)paren
id|rme9652-&gt;iobase
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rme9652-&gt;res_port
)paren
(brace
id|release_resource
c_func
(paren
id|rme9652-&gt;res_port
)paren
suffix:semicolon
id|kfree_nocheck
c_func
(paren
id|rme9652-&gt;res_port
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|rme9652-&gt;irq
op_ge
l_int|0
)paren
id|free_irq
c_func
(paren
id|rme9652-&gt;irq
comma
(paren
r_void
op_star
)paren
id|rme9652
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_initialize_memory
r_static
r_int
id|__init
id|snd_rme9652_initialize_memory
c_func
(paren
id|rme9652_t
op_star
id|rme9652
)paren
(brace
r_void
op_star
id|pb
comma
op_star
id|cb
suffix:semicolon
id|dma_addr_t
id|pb_addr
comma
id|cb_addr
suffix:semicolon
r_int
r_int
id|pb_bus
comma
id|cb_bus
suffix:semicolon
macro_line|#ifndef RME9652_PREALLOCATE_MEMORY
id|cb
op_assign
id|snd_malloc_pci_pages
c_func
(paren
id|rme9652-&gt;pci
comma
id|RME9652_DMA_AREA_BYTES
comma
op_amp
id|cb_addr
)paren
suffix:semicolon
id|pb
op_assign
id|snd_malloc_pci_pages
c_func
(paren
id|rme9652-&gt;pci
comma
id|RME9652_DMA_AREA_BYTES
comma
op_amp
id|pb_addr
)paren
suffix:semicolon
macro_line|#else
id|cb
op_assign
id|snd_rme9652_get_buffer
c_func
(paren
id|rme9652-&gt;dev
comma
op_amp
id|cb_addr
)paren
suffix:semicolon
id|pb
op_assign
id|snd_rme9652_get_buffer
c_func
(paren
id|rme9652-&gt;dev
comma
op_amp
id|pb_addr
)paren
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
id|cb
op_eq
l_int|0
op_logical_or
id|pb
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|cb
)paren
(brace
macro_line|#ifdef RME9652_PREALLOCATE_MEMORY
id|snd_rme9652_free_buffer
c_func
(paren
id|rme9652-&gt;dev
comma
id|cb
)paren
suffix:semicolon
macro_line|#else
id|snd_free_pci_pages
c_func
(paren
id|rme9652-&gt;pci
comma
id|RME9652_DMA_AREA_BYTES
comma
id|cb
comma
id|cb_addr
)paren
suffix:semicolon
macro_line|#endif
)brace
r_if
c_cond
(paren
id|pb
)paren
(brace
macro_line|#ifdef RME9652_PREALLOCATE_MEMORY
id|snd_rme9652_free_buffer
c_func
(paren
id|rme9652-&gt;dev
comma
id|pb
)paren
suffix:semicolon
macro_line|#else
id|snd_free_pci_pages
c_func
(paren
id|rme9652-&gt;pci
comma
id|RME9652_DMA_AREA_BYTES
comma
id|pb
comma
id|pb_addr
)paren
suffix:semicolon
macro_line|#endif
)brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;%s: no buffers available&bslash;n&quot;
comma
id|rme9652-&gt;card_name
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
multiline_comment|/* save raw addresses for use when freeing memory later */
id|rme9652-&gt;capture_buffer_unaligned
op_assign
id|cb
suffix:semicolon
id|rme9652-&gt;playback_buffer_unaligned
op_assign
id|pb
suffix:semicolon
id|rme9652-&gt;capture_buffer_addr
op_assign
id|cb_addr
suffix:semicolon
id|rme9652-&gt;playback_buffer_addr
op_assign
id|pb_addr
suffix:semicolon
multiline_comment|/* Align to bus-space 64K boundary */
id|cb_bus
op_assign
(paren
id|cb_addr
op_plus
l_int|0xFFFF
)paren
op_amp
op_complement
l_int|0xFFFFl
suffix:semicolon
id|pb_bus
op_assign
(paren
id|pb_addr
op_plus
l_int|0xFFFF
)paren
op_amp
op_complement
l_int|0xFFFFl
suffix:semicolon
multiline_comment|/* Tell the card where it is */
id|rme9652_write
c_func
(paren
id|rme9652
comma
id|RME9652_rec_buffer
comma
id|cb_bus
)paren
suffix:semicolon
id|rme9652_write
c_func
(paren
id|rme9652
comma
id|RME9652_play_buffer
comma
id|pb_bus
)paren
suffix:semicolon
id|rme9652-&gt;capture_buffer
op_assign
id|cb
op_plus
(paren
id|cb_bus
op_minus
id|cb_addr
)paren
suffix:semicolon
id|rme9652-&gt;playback_buffer
op_assign
id|pb
op_plus
(paren
id|pb_bus
op_minus
id|pb_addr
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_set_defaults
r_static
r_void
id|snd_rme9652_set_defaults
c_func
(paren
id|rme9652_t
op_star
id|rme9652
)paren
(brace
r_int
r_int
id|k
suffix:semicolon
multiline_comment|/* ASSUMPTION: rme9652-&gt;lock is either held, or&n;&t;   there is no need to hold it (e.g. during module&n;&t;   initalization).&n;&t; */
multiline_comment|/* set defaults:&n;&n;&t;   SPDIF Input via Coax &n;&t;   autosync clock mode&n;&t;   maximum latency (7 = 8192 samples, 64Kbyte buffer,&n;&t;   which implies 2 4096 sample, 32Kbyte periods).&n;&t;   &n;&t;   if rev 1.5, initialize the S/PDIF receiver.&n;&n;&t; */
id|rme9652-&gt;control_register
op_assign
id|RME9652_inp_0
op_or
id|rme9652_encode_latency
c_func
(paren
l_int|7
)paren
suffix:semicolon
id|rme9652_write
c_func
(paren
id|rme9652
comma
id|RME9652_control_register
comma
id|rme9652-&gt;control_register
)paren
suffix:semicolon
id|rme9652_reset_hw_pointer
c_func
(paren
id|rme9652
)paren
suffix:semicolon
id|rme9652_compute_period_size
c_func
(paren
id|rme9652
)paren
suffix:semicolon
multiline_comment|/* default: thru off for all channels */
r_for
c_loop
(paren
id|k
op_assign
l_int|0
suffix:semicolon
id|k
OL
id|RME9652_NCHANNELS
suffix:semicolon
op_increment
id|k
)paren
id|rme9652_write
c_func
(paren
id|rme9652
comma
id|RME9652_thru_base
op_plus
id|k
op_star
l_int|4
comma
l_int|0
)paren
suffix:semicolon
id|rme9652-&gt;thru_bits
op_assign
l_int|0
suffix:semicolon
id|rme9652-&gt;passthru
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* set a default rate so that the channel map is set up */
id|rme9652_set_rate
c_func
(paren
id|rme9652
comma
l_int|48000
)paren
suffix:semicolon
)brace
DECL|function|snd_rme9652_interrupt
r_void
id|snd_rme9652_interrupt
c_func
(paren
r_int
id|irq
comma
r_void
op_star
id|dev_id
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|rme9652_t
op_star
id|rme9652
op_assign
(paren
id|rme9652_t
op_star
)paren
id|dev_id
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|rme9652_read
c_func
(paren
id|rme9652
comma
id|RME9652_status_register
)paren
op_amp
id|RME9652_IRQ
)paren
)paren
(brace
r_return
suffix:semicolon
)brace
id|rme9652_write
c_func
(paren
id|rme9652
comma
id|RME9652_irq_clear
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rme9652-&gt;capture_substream
)paren
(brace
id|snd_pcm_period_elapsed
c_func
(paren
id|rme9652-&gt;pcm-&gt;streams
(braket
id|SNDRV_PCM_STREAM_CAPTURE
)braket
dot
id|substream
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|rme9652-&gt;playback_substream
)paren
(brace
id|snd_pcm_period_elapsed
c_func
(paren
id|rme9652-&gt;pcm-&gt;streams
(braket
id|SNDRV_PCM_STREAM_PLAYBACK
)braket
dot
id|substream
)paren
suffix:semicolon
)brace
)brace
DECL|function|snd_rme9652_hw_pointer
r_static
id|snd_pcm_uframes_t
id|snd_rme9652_hw_pointer
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|rme9652_t
op_star
id|rme9652
op_assign
id|_snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
r_return
id|rme9652_hw_pointer
c_func
(paren
id|rme9652
)paren
suffix:semicolon
)brace
DECL|function|rme9652_channel_buffer_location
r_static
r_char
op_star
id|rme9652_channel_buffer_location
c_func
(paren
id|rme9652_t
op_star
id|rme9652
comma
r_int
id|stream
comma
r_int
id|channel
)paren
(brace
r_int
id|mapped_channel
suffix:semicolon
id|snd_assert
c_func
(paren
id|channel
op_ge
l_int|0
op_logical_or
id|channel
OL
id|RME9652_NCHANNELS
comma
r_return
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|mapped_channel
op_assign
id|rme9652-&gt;channel_map
(braket
id|channel
)braket
)paren
OL
l_int|0
)paren
(brace
r_return
l_int|NULL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|stream
op_eq
id|SNDRV_PCM_STREAM_CAPTURE
)paren
(brace
r_return
id|rme9652-&gt;capture_buffer
op_plus
(paren
id|mapped_channel
op_star
id|RME9652_CHANNEL_BUFFER_BYTES
)paren
suffix:semicolon
)brace
r_else
(brace
r_return
id|rme9652-&gt;playback_buffer
op_plus
(paren
id|mapped_channel
op_star
id|RME9652_CHANNEL_BUFFER_BYTES
)paren
suffix:semicolon
)brace
)brace
DECL|function|snd_rme9652_playback_copy
r_static
r_int
id|snd_rme9652_playback_copy
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|channel
comma
id|snd_pcm_uframes_t
id|pos
comma
r_void
op_star
id|src
comma
id|snd_pcm_uframes_t
id|count
)paren
(brace
id|rme9652_t
op_star
id|rme9652
op_assign
id|_snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
r_char
op_star
id|channel_buf
suffix:semicolon
id|snd_assert
c_func
(paren
id|pos
op_plus
id|count
op_le
id|RME9652_CHANNEL_BUFFER_BYTES
op_div
l_int|4
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|channel_buf
op_assign
id|rme9652_channel_buffer_location
(paren
id|rme9652
comma
id|substream-&gt;pstr-&gt;stream
comma
id|channel
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|channel_buf
op_ne
l_int|NULL
comma
r_return
op_minus
id|EIO
)paren
suffix:semicolon
id|copy_from_user
c_func
(paren
id|channel_buf
op_plus
id|pos
op_star
l_int|4
comma
id|src
comma
id|count
op_star
l_int|4
)paren
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
DECL|function|snd_rme9652_capture_copy
r_static
r_int
id|snd_rme9652_capture_copy
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|channel
comma
id|snd_pcm_uframes_t
id|pos
comma
r_void
op_star
id|dst
comma
id|snd_pcm_uframes_t
id|count
)paren
(brace
id|rme9652_t
op_star
id|rme9652
op_assign
id|_snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
r_char
op_star
id|channel_buf
suffix:semicolon
id|snd_assert
c_func
(paren
id|pos
op_plus
id|count
op_le
id|RME9652_CHANNEL_BUFFER_BYTES
op_div
l_int|4
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|channel_buf
op_assign
id|rme9652_channel_buffer_location
(paren
id|rme9652
comma
id|substream-&gt;pstr-&gt;stream
comma
id|channel
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|channel_buf
op_ne
l_int|NULL
comma
r_return
op_minus
id|EIO
)paren
suffix:semicolon
id|copy_to_user
c_func
(paren
id|dst
comma
id|channel_buf
op_plus
id|pos
op_star
l_int|4
comma
id|count
op_star
l_int|4
)paren
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
DECL|function|snd_rme9652_hw_silence
r_static
r_int
id|snd_rme9652_hw_silence
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|channel
comma
id|snd_pcm_uframes_t
id|pos
comma
id|snd_pcm_uframes_t
id|count
)paren
(brace
id|rme9652_t
op_star
id|rme9652
op_assign
id|_snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
r_char
op_star
id|channel_buf
suffix:semicolon
id|channel_buf
op_assign
id|rme9652_channel_buffer_location
(paren
id|rme9652
comma
id|substream-&gt;pstr-&gt;stream
comma
id|channel
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|channel_buf
op_ne
l_int|NULL
comma
r_return
op_minus
id|EIO
)paren
suffix:semicolon
id|memset
c_func
(paren
id|channel_buf
op_plus
id|pos
op_star
l_int|4
comma
l_int|0
comma
id|count
op_star
l_int|4
)paren
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
DECL|function|snd_rme9652_reset
r_static
r_int
id|snd_rme9652_reset
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|rme9652_t
op_star
id|rme9652
op_assign
id|_snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|other
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_PLAYBACK
)paren
id|other
op_assign
id|rme9652-&gt;capture_substream
suffix:semicolon
r_else
id|other
op_assign
id|rme9652-&gt;playback_substream
suffix:semicolon
r_if
c_cond
(paren
id|rme9652-&gt;running
)paren
id|runtime-&gt;status-&gt;hw_ptr
op_assign
id|rme9652_hw_pointer
c_func
(paren
id|rme9652
)paren
suffix:semicolon
r_else
id|runtime-&gt;status-&gt;hw_ptr
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|other
)paren
(brace
id|snd_pcm_substream_t
op_star
id|s
op_assign
id|substream
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|oruntime
op_assign
id|other-&gt;runtime
suffix:semicolon
r_do
(brace
id|s
op_assign
id|s-&gt;link_next
suffix:semicolon
r_if
c_cond
(paren
id|s
op_eq
id|other
)paren
(brace
id|oruntime-&gt;status-&gt;hw_ptr
op_assign
id|runtime-&gt;status-&gt;hw_ptr
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_while
c_loop
(paren
id|s
op_ne
id|substream
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_hw_params
r_static
r_int
id|snd_rme9652_hw_params
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_hw_params_t
op_star
id|params
)paren
(brace
id|rme9652_t
op_star
id|rme9652
op_assign
id|_snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
r_int
id|err
suffix:semicolon
id|pid_t
id|this_pid
suffix:semicolon
id|pid_t
id|other_pid
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|rme9652-&gt;lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;pstr-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_PLAYBACK
)paren
(brace
id|rme9652-&gt;control_register
op_and_assign
op_complement
(paren
id|RME9652_PRO
op_or
id|RME9652_Dolby
op_or
id|RME9652_EMP
)paren
suffix:semicolon
id|rme9652_write
c_func
(paren
id|rme9652
comma
id|RME9652_control_register
comma
id|rme9652-&gt;control_register
op_or_assign
id|rme9652-&gt;creg_spdif_stream
)paren
suffix:semicolon
id|this_pid
op_assign
id|rme9652-&gt;playback_pid
suffix:semicolon
id|other_pid
op_assign
id|rme9652-&gt;capture_pid
suffix:semicolon
)brace
r_else
(brace
id|this_pid
op_assign
id|rme9652-&gt;capture_pid
suffix:semicolon
id|other_pid
op_assign
id|rme9652-&gt;playback_pid
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|other_pid
OG
l_int|0
)paren
op_logical_and
(paren
id|this_pid
op_ne
id|other_pid
)paren
)paren
(brace
multiline_comment|/* The other stream is open, and not by the same&n;&t;&t;   task as this one. Make sure that the parameters&n;&t;&t;   that matter are the same.&n;&t;&t; */
r_if
c_cond
(paren
id|params_rate
c_func
(paren
id|params
)paren
op_ne
id|rme9652_adat_sample_rate
c_func
(paren
id|rme9652
)paren
)paren
(brace
id|spin_unlock_irq
c_func
(paren
op_amp
id|rme9652-&gt;lock
)paren
suffix:semicolon
id|_snd_pcm_hw_param_setempty
c_func
(paren
id|params
comma
id|SNDRV_PCM_HW_PARAM_RATE
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
r_if
c_cond
(paren
id|params_period_size
c_func
(paren
id|params
)paren
op_ne
id|rme9652-&gt;period_bytes
op_div
l_int|4
)paren
(brace
id|spin_unlock_irq
c_func
(paren
op_amp
id|rme9652-&gt;lock
)paren
suffix:semicolon
id|_snd_pcm_hw_param_setempty
c_func
(paren
id|params
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_SIZE
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
multiline_comment|/* We&squot;re fine. */
id|spin_unlock_irq
c_func
(paren
op_amp
id|rme9652-&gt;lock
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|spin_unlock_irq
c_func
(paren
op_amp
id|rme9652-&gt;lock
)paren
suffix:semicolon
)brace
multiline_comment|/* how to make sure that the rate matches an externally-set one ?&n;&t; */
r_if
c_cond
(paren
(paren
id|err
op_assign
id|rme9652_set_rate
c_func
(paren
id|rme9652
comma
id|params_rate
c_func
(paren
id|params
)paren
)paren
)paren
OL
l_int|0
)paren
(brace
id|_snd_pcm_hw_param_setempty
c_func
(paren
id|params
comma
id|SNDRV_PCM_HW_PARAM_RATE
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|rme9652_set_interrupt_interval
c_func
(paren
id|rme9652
comma
id|params_period_size
c_func
(paren
id|params
)paren
)paren
)paren
OL
l_int|0
)paren
(brace
id|_snd_pcm_hw_param_setempty
c_func
(paren
id|params
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_SIZE
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_channel_info
r_static
r_int
id|snd_rme9652_channel_info
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_channel_info_t
op_star
id|info
)paren
(brace
id|rme9652_t
op_star
id|rme9652
op_assign
id|_snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
r_int
id|chn
suffix:semicolon
id|snd_assert
c_func
(paren
id|info-&gt;channel
OL
id|RME9652_NCHANNELS
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|chn
op_assign
id|rme9652-&gt;channel_map
(braket
id|info-&gt;channel
)braket
)paren
OL
l_int|0
)paren
(brace
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|info-&gt;offset
op_assign
id|chn
op_star
id|RME9652_CHANNEL_BUFFER_BYTES
suffix:semicolon
id|info-&gt;first
op_assign
l_int|0
suffix:semicolon
id|info-&gt;step
op_assign
l_int|32
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_ioctl
r_static
r_int
id|snd_rme9652_ioctl
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
r_int
id|cmd
comma
r_void
op_star
id|arg
)paren
(brace
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|SNDRV_PCM_IOCTL1_RESET
suffix:colon
(brace
r_return
id|snd_rme9652_reset
c_func
(paren
id|substream
)paren
suffix:semicolon
)brace
r_case
id|SNDRV_PCM_IOCTL1_CHANNEL_INFO
suffix:colon
(brace
id|snd_pcm_channel_info_t
op_star
id|info
op_assign
id|arg
suffix:semicolon
r_return
id|snd_rme9652_channel_info
c_func
(paren
id|substream
comma
id|info
)paren
suffix:semicolon
)brace
r_default
suffix:colon
r_break
suffix:semicolon
)brace
r_return
id|snd_pcm_lib_ioctl
c_func
(paren
id|substream
comma
id|cmd
comma
id|arg
)paren
suffix:semicolon
)brace
DECL|function|rme9652_silence_playback
r_static
r_void
id|rme9652_silence_playback
c_func
(paren
id|rme9652_t
op_star
id|rme9652
)paren
(brace
id|memset
c_func
(paren
id|rme9652-&gt;playback_buffer
comma
l_int|0
comma
id|RME9652_DMA_AREA_BYTES
)paren
suffix:semicolon
)brace
DECL|function|snd_rme9652_trigger
r_static
r_int
id|snd_rme9652_trigger
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|cmd
)paren
(brace
id|rme9652_t
op_star
id|rme9652
op_assign
id|_snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|other
suffix:semicolon
r_int
id|running
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|rme9652-&gt;lock
)paren
suffix:semicolon
id|running
op_assign
id|rme9652-&gt;running
suffix:semicolon
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|SNDRV_PCM_TRIGGER_START
suffix:colon
id|running
op_or_assign
l_int|1
op_lshift
id|substream-&gt;stream
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_TRIGGER_STOP
suffix:colon
id|running
op_and_assign
op_complement
(paren
l_int|1
op_lshift
id|substream-&gt;stream
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|snd_BUG
c_func
(paren
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|rme9652-&gt;lock
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|substream-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_PLAYBACK
)paren
id|other
op_assign
id|rme9652-&gt;capture_substream
suffix:semicolon
r_else
id|other
op_assign
id|rme9652-&gt;playback_substream
suffix:semicolon
r_if
c_cond
(paren
id|other
)paren
(brace
id|snd_pcm_substream_t
op_star
id|s
op_assign
id|substream
suffix:semicolon
r_do
(brace
id|s
op_assign
id|s-&gt;link_next
suffix:semicolon
r_if
c_cond
(paren
id|s
op_eq
id|other
)paren
(brace
id|snd_pcm_trigger_done
c_func
(paren
id|s
comma
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|cmd
op_eq
id|SNDRV_PCM_TRIGGER_START
)paren
id|running
op_or_assign
l_int|1
op_lshift
id|s-&gt;stream
suffix:semicolon
r_else
id|running
op_and_assign
op_complement
(paren
l_int|1
op_lshift
id|s-&gt;stream
)paren
suffix:semicolon
r_goto
id|_ok
suffix:semicolon
)brace
)brace
r_while
c_loop
(paren
id|s
op_ne
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|cmd
op_eq
id|SNDRV_PCM_TRIGGER_START
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|running
op_amp
(paren
l_int|1
op_lshift
id|SNDRV_PCM_STREAM_PLAYBACK
)paren
)paren
op_logical_and
id|substream-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_CAPTURE
)paren
id|rme9652_silence_playback
c_func
(paren
id|rme9652
)paren
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|running
op_logical_and
id|substream-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_PLAYBACK
)paren
id|rme9652_silence_playback
c_func
(paren
id|rme9652
)paren
suffix:semicolon
)brace
)brace
id|_ok
suffix:colon
id|snd_pcm_trigger_done
c_func
(paren
id|substream
comma
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|rme9652-&gt;running
op_logical_and
id|running
)paren
id|rme9652_start
c_func
(paren
id|rme9652
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|rme9652-&gt;running
op_logical_and
op_logical_neg
id|running
)paren
id|rme9652_stop
c_func
(paren
id|rme9652
)paren
suffix:semicolon
id|rme9652-&gt;running
op_assign
id|running
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|rme9652-&gt;lock
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_prepare
r_static
r_int
id|snd_rme9652_prepare
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|rme9652_t
op_star
id|rme9652
op_assign
id|_snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
r_int
id|result
op_assign
l_int|0
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|rme9652-&gt;lock
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|rme9652-&gt;running
)paren
id|rme9652_reset_hw_pointer
c_func
(paren
id|rme9652
)paren
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|rme9652-&gt;lock
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
DECL|variable|snd_rme9652_playback_subinfo
r_static
id|snd_pcm_hardware_t
id|snd_rme9652_playback_subinfo
op_assign
(brace
id|info
suffix:colon
(paren
id|SNDRV_PCM_INFO_MMAP
op_or
id|SNDRV_PCM_INFO_MMAP_VALID
op_or
id|SNDRV_PCM_INFO_NONINTERLEAVED
op_or
id|SNDRV_PCM_INFO_SYNC_START
op_or
id|SNDRV_PCM_INFO_DOUBLE
)paren
comma
id|formats
suffix:colon
id|SNDRV_PCM_FMTBIT_S32_LE
comma
id|rates
suffix:colon
(paren
id|SNDRV_PCM_RATE_44100
op_or
id|SNDRV_PCM_RATE_48000
op_or
id|SNDRV_PCM_RATE_88200
op_or
id|SNDRV_PCM_RATE_96000
)paren
comma
id|rate_min
suffix:colon
l_int|44100
comma
id|rate_max
suffix:colon
l_int|96000
comma
id|channels_min
suffix:colon
l_int|10
comma
id|channels_max
suffix:colon
l_int|26
comma
id|buffer_bytes_max
suffix:colon
l_int|1024
op_star
l_int|1024
comma
id|period_bytes_min
suffix:colon
l_int|1
comma
id|period_bytes_max
suffix:colon
l_int|1024
op_star
l_int|1024
comma
id|periods_min
suffix:colon
l_int|2
comma
id|periods_max
suffix:colon
l_int|2
comma
id|fifo_size
suffix:colon
l_int|0
comma
)brace
suffix:semicolon
DECL|variable|snd_rme9652_capture_subinfo
r_static
id|snd_pcm_hardware_t
id|snd_rme9652_capture_subinfo
op_assign
(brace
id|info
suffix:colon
(paren
id|SNDRV_PCM_INFO_MMAP
op_or
id|SNDRV_PCM_INFO_MMAP_VALID
op_or
id|SNDRV_PCM_INFO_NONINTERLEAVED
op_or
id|SNDRV_PCM_INFO_SYNC_START
)paren
comma
id|formats
suffix:colon
id|SNDRV_PCM_FMTBIT_S32_LE
comma
id|rates
suffix:colon
(paren
id|SNDRV_PCM_RATE_44100
op_or
id|SNDRV_PCM_RATE_48000
op_or
id|SNDRV_PCM_RATE_88200
op_or
id|SNDRV_PCM_RATE_96000
)paren
comma
id|rate_min
suffix:colon
l_int|44100
comma
id|rate_max
suffix:colon
l_int|96000
comma
id|channels_min
suffix:colon
l_int|10
comma
id|channels_max
suffix:colon
l_int|26
comma
id|buffer_bytes_max
suffix:colon
l_int|1024
op_star
l_int|1024
comma
id|period_bytes_min
suffix:colon
l_int|1
comma
id|period_bytes_max
suffix:colon
l_int|1024
op_star
l_int|1024
comma
id|periods_min
suffix:colon
l_int|2
comma
id|periods_max
suffix:colon
l_int|2
comma
id|fifo_size
suffix:colon
l_int|0
comma
)brace
suffix:semicolon
DECL|variable|period_sizes
r_static
r_int
r_int
id|period_sizes
(braket
)braket
op_assign
(brace
l_int|64
comma
l_int|128
comma
l_int|256
comma
l_int|512
comma
l_int|1024
comma
l_int|2048
comma
l_int|4096
comma
l_int|8192
)brace
suffix:semicolon
DECL|macro|PERIOD_SIZES
mdefine_line|#define PERIOD_SIZES sizeof(period_sizes) / sizeof(period_sizes[0])
DECL|variable|hw_constraints_period_sizes
r_static
id|snd_pcm_hw_constraint_list_t
id|hw_constraints_period_sizes
op_assign
(brace
id|count
suffix:colon
id|PERIOD_SIZES
comma
id|list
suffix:colon
id|period_sizes
comma
id|mask
suffix:colon
l_int|0
)brace
suffix:semicolon
DECL|function|snd_rme9652_hw_rule_channels
r_static
r_int
id|snd_rme9652_hw_rule_channels
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_rule_t
op_star
id|rule
)paren
(brace
id|rme9652_t
op_star
id|rme9652
op_assign
id|rule
op_member_access_from_pointer
r_private
suffix:semicolon
id|snd_interval_t
op_star
id|c
op_assign
id|hw_param_interval
c_func
(paren
id|params
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
)paren
suffix:semicolon
r_int
r_int
id|list
(braket
l_int|2
)braket
op_assign
(brace
id|rme9652-&gt;ds_channels
comma
id|rme9652-&gt;ss_channels
)brace
suffix:semicolon
r_return
id|snd_interval_list
c_func
(paren
id|c
comma
l_int|2
comma
id|list
comma
l_int|0
)paren
suffix:semicolon
)brace
DECL|function|snd_rme9652_hw_rule_channels_rate
r_static
r_int
id|snd_rme9652_hw_rule_channels_rate
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_rule_t
op_star
id|rule
)paren
(brace
id|rme9652_t
op_star
id|rme9652
op_assign
id|rule
op_member_access_from_pointer
r_private
suffix:semicolon
id|snd_interval_t
op_star
id|c
op_assign
id|hw_param_interval
c_func
(paren
id|params
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
)paren
suffix:semicolon
id|snd_interval_t
op_star
id|r
op_assign
id|hw_param_interval
c_func
(paren
id|params
comma
id|SNDRV_PCM_HW_PARAM_RATE
)paren
suffix:semicolon
r_if
c_cond
(paren
id|r-&gt;min
OG
l_int|48000
)paren
(brace
id|snd_interval_t
id|t
op_assign
(brace
id|min
suffix:colon
id|rme9652-&gt;ds_channels
comma
id|max
suffix:colon
id|rme9652-&gt;ds_channels
comma
id|integer
suffix:colon
l_int|1
comma
)brace
suffix:semicolon
r_return
id|snd_interval_refine
c_func
(paren
id|c
comma
op_amp
id|t
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|r-&gt;max
OL
l_int|88200
)paren
(brace
id|snd_interval_t
id|t
op_assign
(brace
id|min
suffix:colon
id|rme9652-&gt;ss_channels
comma
id|max
suffix:colon
id|rme9652-&gt;ss_channels
comma
id|integer
suffix:colon
l_int|1
comma
)brace
suffix:semicolon
r_return
id|snd_interval_refine
c_func
(paren
id|c
comma
op_amp
id|t
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_hw_rule_rate_channels
r_static
r_int
id|snd_rme9652_hw_rule_rate_channels
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_rule_t
op_star
id|rule
)paren
(brace
id|rme9652_t
op_star
id|rme9652
op_assign
id|rule
op_member_access_from_pointer
r_private
suffix:semicolon
id|snd_interval_t
op_star
id|c
op_assign
id|hw_param_interval
c_func
(paren
id|params
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
)paren
suffix:semicolon
id|snd_interval_t
op_star
id|r
op_assign
id|hw_param_interval
c_func
(paren
id|params
comma
id|SNDRV_PCM_HW_PARAM_RATE
)paren
suffix:semicolon
r_if
c_cond
(paren
id|c-&gt;min
op_ge
id|rme9652-&gt;ss_channels
)paren
(brace
id|snd_interval_t
id|t
op_assign
(brace
id|min
suffix:colon
l_int|44100
comma
id|max
suffix:colon
l_int|48000
comma
id|integer
suffix:colon
l_int|1
comma
)brace
suffix:semicolon
r_return
id|snd_interval_refine
c_func
(paren
id|r
comma
op_amp
id|t
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|c-&gt;max
op_le
id|rme9652-&gt;ds_channels
)paren
(brace
id|snd_interval_t
id|t
op_assign
(brace
id|min
suffix:colon
l_int|88200
comma
id|max
suffix:colon
l_int|96000
comma
id|integer
suffix:colon
l_int|1
comma
)brace
suffix:semicolon
r_return
id|snd_interval_refine
c_func
(paren
id|r
comma
op_amp
id|t
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_playback_open
r_static
r_int
id|snd_rme9652_playback_open
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|rme9652_t
op_star
id|rme9652
op_assign
id|_snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|snd_pcm_set_sync
c_func
(paren
id|substream
)paren
suffix:semicolon
id|runtime-&gt;hw
op_assign
id|snd_rme9652_playback_subinfo
suffix:semicolon
id|runtime-&gt;dma_area
op_assign
id|rme9652-&gt;playback_buffer
suffix:semicolon
id|runtime-&gt;dma_bytes
op_assign
id|RME9652_DMA_AREA_BYTES
suffix:semicolon
r_if
c_cond
(paren
id|rme9652-&gt;capture_substream
op_eq
l_int|NULL
)paren
(brace
id|rme9652_stop
c_func
(paren
id|rme9652
)paren
suffix:semicolon
id|rme9652_set_thru
c_func
(paren
id|rme9652
comma
op_minus
l_int|1
comma
l_int|0
)paren
suffix:semicolon
)brace
id|rme9652-&gt;playback_pid
op_assign
id|current-&gt;pid
suffix:semicolon
id|rme9652-&gt;playback_substream
op_assign
id|substream
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|snd_pcm_hw_constraint_msbits
c_func
(paren
id|runtime
comma
l_int|0
comma
l_int|32
comma
l_int|24
)paren
suffix:semicolon
id|snd_pcm_hw_constraint_list
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_SIZE
comma
op_amp
id|hw_constraints_period_sizes
)paren
suffix:semicolon
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
comma
id|snd_rme9652_hw_rule_channels
comma
id|rme9652
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
comma
op_minus
l_int|1
)paren
suffix:semicolon
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
comma
id|snd_rme9652_hw_rule_channels_rate
comma
id|rme9652
comma
id|SNDRV_PCM_HW_PARAM_RATE
comma
op_minus
l_int|1
)paren
suffix:semicolon
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_RATE
comma
id|snd_rme9652_hw_rule_rate_channels
comma
id|rme9652
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
comma
op_minus
l_int|1
)paren
suffix:semicolon
id|rme9652-&gt;creg_spdif_stream
op_assign
id|rme9652-&gt;creg_spdif
suffix:semicolon
id|rme9652-&gt;spdif_ctl-&gt;access
op_and_assign
op_complement
id|SNDRV_CTL_ELEM_ACCESS_INACTIVE
suffix:semicolon
id|snd_ctl_notify
c_func
(paren
id|rme9652-&gt;card
comma
id|SNDRV_CTL_EVENT_MASK_VALUE
op_or
id|SNDRV_CTL_EVENT_MASK_INFO
comma
op_amp
id|rme9652-&gt;spdif_ctl-&gt;id
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_playback_release
r_static
r_int
id|snd_rme9652_playback_release
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|rme9652_t
op_star
id|rme9652
op_assign
id|_snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|rme9652-&gt;playback_pid
op_assign
op_minus
l_int|1
suffix:semicolon
id|rme9652-&gt;playback_substream
op_assign
l_int|NULL
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|rme9652-&gt;spdif_ctl-&gt;access
op_or_assign
id|SNDRV_CTL_ELEM_ACCESS_INACTIVE
suffix:semicolon
id|snd_ctl_notify
c_func
(paren
id|rme9652-&gt;card
comma
id|SNDRV_CTL_EVENT_MASK_VALUE
op_or
id|SNDRV_CTL_EVENT_MASK_INFO
comma
op_amp
id|rme9652-&gt;spdif_ctl-&gt;id
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_capture_open
r_static
r_int
id|snd_rme9652_capture_open
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|rme9652_t
op_star
id|rme9652
op_assign
id|_snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|snd_pcm_set_sync
c_func
(paren
id|substream
)paren
suffix:semicolon
id|runtime-&gt;hw
op_assign
id|snd_rme9652_capture_subinfo
suffix:semicolon
id|runtime-&gt;dma_area
op_assign
id|rme9652-&gt;capture_buffer
suffix:semicolon
id|runtime-&gt;dma_bytes
op_assign
id|RME9652_DMA_AREA_BYTES
suffix:semicolon
r_if
c_cond
(paren
id|rme9652-&gt;playback_substream
op_eq
l_int|NULL
)paren
(brace
id|rme9652_stop
c_func
(paren
id|rme9652
)paren
suffix:semicolon
id|rme9652_set_thru
c_func
(paren
id|rme9652
comma
op_minus
l_int|1
comma
l_int|0
)paren
suffix:semicolon
)brace
id|rme9652-&gt;capture_pid
op_assign
id|current-&gt;pid
suffix:semicolon
id|rme9652-&gt;capture_substream
op_assign
id|substream
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|snd_pcm_hw_constraint_msbits
c_func
(paren
id|runtime
comma
l_int|0
comma
l_int|32
comma
l_int|24
)paren
suffix:semicolon
id|snd_pcm_hw_constraint_list
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_SIZE
comma
op_amp
id|hw_constraints_period_sizes
)paren
suffix:semicolon
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
comma
id|snd_rme9652_hw_rule_channels
comma
id|rme9652
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
comma
op_minus
l_int|1
)paren
suffix:semicolon
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
comma
id|snd_rme9652_hw_rule_channels_rate
comma
id|rme9652
comma
id|SNDRV_PCM_HW_PARAM_RATE
comma
op_minus
l_int|1
)paren
suffix:semicolon
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_RATE
comma
id|snd_rme9652_hw_rule_rate_channels
comma
id|rme9652
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_capture_release
r_static
r_int
id|snd_rme9652_capture_release
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|rme9652_t
op_star
id|rme9652
op_assign
id|_snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|rme9652-&gt;capture_pid
op_assign
op_minus
l_int|1
suffix:semicolon
id|rme9652-&gt;capture_substream
op_assign
l_int|NULL
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|rme9652-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|snd_rme9652_playback_ops
r_static
id|snd_pcm_ops_t
id|snd_rme9652_playback_ops
op_assign
(brace
id|open
suffix:colon
id|snd_rme9652_playback_open
comma
id|close
suffix:colon
id|snd_rme9652_playback_release
comma
id|ioctl
suffix:colon
id|snd_rme9652_ioctl
comma
id|hw_params
suffix:colon
id|snd_rme9652_hw_params
comma
id|prepare
suffix:colon
id|snd_rme9652_prepare
comma
id|trigger
suffix:colon
id|snd_rme9652_trigger
comma
id|pointer
suffix:colon
id|snd_rme9652_hw_pointer
comma
id|copy
suffix:colon
id|snd_rme9652_playback_copy
comma
id|silence
suffix:colon
id|snd_rme9652_hw_silence
comma
)brace
suffix:semicolon
DECL|variable|snd_rme9652_capture_ops
r_static
id|snd_pcm_ops_t
id|snd_rme9652_capture_ops
op_assign
(brace
id|open
suffix:colon
id|snd_rme9652_capture_open
comma
id|close
suffix:colon
id|snd_rme9652_capture_release
comma
id|ioctl
suffix:colon
id|snd_rme9652_ioctl
comma
id|hw_params
suffix:colon
id|snd_rme9652_hw_params
comma
id|prepare
suffix:colon
id|snd_rme9652_prepare
comma
id|trigger
suffix:colon
id|snd_rme9652_trigger
comma
id|pointer
suffix:colon
id|snd_rme9652_hw_pointer
comma
id|copy
suffix:colon
id|snd_rme9652_capture_copy
comma
)brace
suffix:semicolon
DECL|function|snd_rme9652_create_pcm
r_static
r_int
id|__init
id|snd_rme9652_create_pcm
c_func
(paren
id|snd_card_t
op_star
id|card
comma
id|rme9652_t
op_star
id|rme9652
)paren
(brace
id|snd_pcm_t
op_star
id|pcm
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_pcm_new
c_func
(paren
id|card
comma
id|rme9652-&gt;card_name
comma
l_int|0
comma
l_int|1
comma
l_int|1
comma
op_amp
id|pcm
)paren
)paren
OL
l_int|0
)paren
(brace
r_return
id|err
suffix:semicolon
)brace
id|rme9652-&gt;pcm
op_assign
id|pcm
suffix:semicolon
id|pcm-&gt;private_data
op_assign
id|rme9652
suffix:semicolon
id|strcpy
c_func
(paren
id|pcm-&gt;name
comma
id|rme9652-&gt;card_name
)paren
suffix:semicolon
id|snd_pcm_set_ops
c_func
(paren
id|pcm
comma
id|SNDRV_PCM_STREAM_PLAYBACK
comma
op_amp
id|snd_rme9652_playback_ops
)paren
suffix:semicolon
id|snd_pcm_set_ops
c_func
(paren
id|pcm
comma
id|SNDRV_PCM_STREAM_CAPTURE
comma
op_amp
id|snd_rme9652_capture_ops
)paren
suffix:semicolon
id|pcm-&gt;info_flags
op_assign
id|SNDRV_PCM_INFO_JOINT_DUPLEX
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_create
r_static
r_int
id|__init
id|snd_rme9652_create
c_func
(paren
id|snd_card_t
op_star
id|card
comma
id|rme9652_t
op_star
id|rme9652
comma
r_int
id|precise_ptr
)paren
(brace
r_struct
id|pci_dev
op_star
id|pci
op_assign
id|rme9652-&gt;pci
suffix:semicolon
r_int
id|err
suffix:semicolon
r_int
id|status
suffix:semicolon
r_int
r_int
id|rev
suffix:semicolon
id|rme9652-&gt;irq
op_assign
op_minus
l_int|1
suffix:semicolon
id|rme9652-&gt;card
op_assign
id|card
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|pci_enable_device
c_func
(paren
id|pci
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|spin_lock_init
c_func
(paren
op_amp
id|rme9652-&gt;lock
)paren
suffix:semicolon
id|rme9652-&gt;port
op_assign
id|pci_resource_start
c_func
(paren
id|pci
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|rme9652-&gt;res_port
op_assign
id|request_mem_region
c_func
(paren
id|rme9652-&gt;port
comma
id|RME9652_IO_EXTENT
comma
l_string|&quot;rme9652&quot;
)paren
)paren
op_eq
l_int|NULL
)paren
(brace
id|snd_printk
c_func
(paren
l_string|&quot;unable to grab memory region 0x%lx-0x%lx&bslash;n&quot;
comma
id|rme9652-&gt;port
comma
id|rme9652-&gt;port
op_plus
id|RME9652_IO_EXTENT
op_minus
l_int|1
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
r_if
c_cond
(paren
id|request_irq
c_func
(paren
id|pci-&gt;irq
comma
id|snd_rme9652_interrupt
comma
id|SA_INTERRUPT
op_or
id|SA_SHIRQ
comma
l_string|&quot;rme9652&quot;
comma
(paren
r_void
op_star
)paren
id|rme9652
)paren
)paren
(brace
id|snd_printk
c_func
(paren
l_string|&quot;unable to grab IRQ %d&bslash;n&quot;
comma
id|pci-&gt;irq
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
id|rme9652-&gt;irq
op_assign
id|pci-&gt;irq
suffix:semicolon
id|rme9652-&gt;iobase
op_assign
(paren
r_int
r_int
)paren
id|ioremap_nocache
c_func
(paren
id|rme9652-&gt;port
comma
id|RME9652_IO_EXTENT
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rme9652-&gt;iobase
op_eq
l_int|0
)paren
(brace
id|snd_printk
c_func
(paren
l_string|&quot;unable to remap region 0x%lx-0x%lx&bslash;n&quot;
comma
id|rme9652-&gt;port
comma
id|rme9652-&gt;port
op_plus
id|RME9652_IO_EXTENT
op_minus
l_int|1
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
id|rme9652-&gt;precise_ptr
op_assign
id|precise_ptr
suffix:semicolon
multiline_comment|/* Determine the h/w rev level of the card. This seems like&n;&t;   a particularly kludgy way to encode it, but its what RME&n;&t;   chose to do, so we follow them ...&n;&t;*/
id|status
op_assign
id|rme9652_read
c_func
(paren
id|rme9652
comma
id|RME9652_status_register
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rme9652_decode_spdif_rate
c_func
(paren
id|status
op_amp
id|RME9652_F
)paren
op_eq
l_int|1
)paren
(brace
id|rme9652-&gt;hw_rev
op_assign
l_int|15
suffix:semicolon
)brace
r_else
(brace
id|rme9652-&gt;hw_rev
op_assign
l_int|11
suffix:semicolon
)brace
multiline_comment|/* Differentiate between the standard Hammerfall, and the&n;&t;   &quot;Light&quot;, which does not have the expansion board. This&n;&t;   method comes from information received from Mathhias&n;&t;   Clausen at RME. Display the EEPROM and h/w revID where&n;&t;   relevant.  &n;&t;*/
id|pci_read_config_word
c_func
(paren
id|rme9652-&gt;pci
comma
id|PCI_CLASS_REVISION
comma
op_amp
id|rev
)paren
suffix:semicolon
id|strcpy
c_func
(paren
id|card-&gt;driver
comma
l_string|&quot;RME9652&quot;
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|rev
op_amp
l_int|0xff
)paren
(brace
r_case
l_int|8
suffix:colon
multiline_comment|/* original eprom */
id|strcpy
c_func
(paren
id|card-&gt;driver
comma
l_string|&quot;RME9636&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rme9652-&gt;hw_rev
op_eq
l_int|15
)paren
(brace
id|rme9652-&gt;card_name
op_assign
l_string|&quot;RME Digi9636 (Rev 1.5)&quot;
suffix:semicolon
)brace
r_else
(brace
id|rme9652-&gt;card_name
op_assign
l_string|&quot;RME Digi9636&quot;
suffix:semicolon
)brace
id|rme9652-&gt;ss_channels
op_assign
id|RME9636_NCHANNELS
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|9
suffix:colon
multiline_comment|/* W36_G EPROM */
id|strcpy
c_func
(paren
id|card-&gt;driver
comma
l_string|&quot;RME9636&quot;
)paren
suffix:semicolon
id|rme9652-&gt;card_name
op_assign
l_string|&quot;RME Digi9636 (Rev G)&quot;
suffix:semicolon
id|rme9652-&gt;ss_channels
op_assign
id|RME9636_NCHANNELS
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|4
suffix:colon
multiline_comment|/* W52_G EPROM */
id|rme9652-&gt;card_name
op_assign
l_string|&quot;RME Digi9652 (Rev G)&quot;
suffix:semicolon
id|rme9652-&gt;ss_channels
op_assign
id|RME9652_NCHANNELS
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
(brace
)brace
r_case
l_int|3
suffix:colon
multiline_comment|/* original eprom */
r_if
c_cond
(paren
id|rme9652-&gt;hw_rev
op_eq
l_int|15
)paren
(brace
id|rme9652-&gt;card_name
op_assign
l_string|&quot;RME Digi9652 (Rev 1.5)&quot;
suffix:semicolon
)brace
r_else
(brace
id|rme9652-&gt;card_name
op_assign
l_string|&quot;RME Digi9652&quot;
suffix:semicolon
)brace
id|rme9652-&gt;ss_channels
op_assign
id|RME9652_NCHANNELS
suffix:semicolon
r_break
suffix:semicolon
)brace
id|rme9652-&gt;ds_channels
op_assign
(paren
id|rme9652-&gt;ss_channels
op_minus
l_int|2
)paren
op_div
l_int|2
op_plus
l_int|2
suffix:semicolon
id|pci_set_master
c_func
(paren
id|rme9652-&gt;pci
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_rme9652_initialize_memory
c_func
(paren
id|rme9652
)paren
)paren
OL
l_int|0
)paren
(brace
r_return
id|err
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_rme9652_create_pcm
c_func
(paren
id|card
comma
id|rme9652
)paren
)paren
OL
l_int|0
)paren
(brace
r_return
id|err
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_rme9652_create_controls
c_func
(paren
id|card
comma
id|rme9652
)paren
)paren
OL
l_int|0
)paren
(brace
r_return
id|err
suffix:semicolon
)brace
id|snd_rme9652_proc_init
c_func
(paren
id|rme9652
)paren
suffix:semicolon
id|rme9652-&gt;last_spdif_sample_rate
op_assign
op_minus
l_int|1
suffix:semicolon
id|rme9652-&gt;last_adat_sample_rate
op_assign
op_minus
l_int|1
suffix:semicolon
id|rme9652-&gt;playback_pid
op_assign
op_minus
l_int|1
suffix:semicolon
id|rme9652-&gt;capture_pid
op_assign
op_minus
l_int|1
suffix:semicolon
id|rme9652-&gt;capture_substream
op_assign
l_int|NULL
suffix:semicolon
id|rme9652-&gt;playback_substream
op_assign
l_int|NULL
suffix:semicolon
id|snd_rme9652_set_defaults
c_func
(paren
id|rme9652
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rme9652-&gt;hw_rev
op_eq
l_int|15
)paren
(brace
id|rme9652_initialize_spdif_receiver
(paren
id|rme9652
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_card_free
r_static
r_void
id|snd_rme9652_card_free
c_func
(paren
id|snd_card_t
op_star
id|card
)paren
(brace
id|rme9652_t
op_star
id|rme9652
op_assign
(paren
id|rme9652_t
op_star
)paren
id|card-&gt;private_data
suffix:semicolon
r_if
c_cond
(paren
id|rme9652
)paren
id|snd_rme9652_free
c_func
(paren
id|rme9652
)paren
suffix:semicolon
)brace
DECL|function|snd_rme9652_probe
r_static
r_int
id|__devinit
id|snd_rme9652_probe
c_func
(paren
r_struct
id|pci_dev
op_star
id|pci
comma
r_const
r_struct
id|pci_device_id
op_star
id|id
)paren
(brace
r_static
r_int
id|dev
op_assign
l_int|0
suffix:semicolon
id|rme9652_t
op_star
id|rme9652
suffix:semicolon
id|snd_card_t
op_star
id|card
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
id|dev
op_ge
id|SNDRV_CARDS
)paren
r_return
op_minus
id|ENODEV
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snd_enable
(braket
id|dev
)braket
)paren
(brace
id|dev
op_increment
suffix:semicolon
r_return
op_minus
id|ENOENT
suffix:semicolon
)brace
id|card
op_assign
id|snd_card_new
c_func
(paren
id|snd_index
(braket
id|dev
)braket
comma
id|snd_id
(braket
id|dev
)braket
comma
id|THIS_MODULE
comma
r_sizeof
(paren
id|rme9652_t
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|rme9652
op_assign
(paren
id|rme9652_t
op_star
)paren
id|card-&gt;private_data
suffix:semicolon
id|card-&gt;private_free
op_assign
id|snd_rme9652_card_free
suffix:semicolon
id|rme9652-&gt;dev
op_assign
id|dev
suffix:semicolon
id|rme9652-&gt;pci
op_assign
id|pci
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_rme9652_create
c_func
(paren
id|card
comma
id|rme9652
comma
id|snd_precise_ptr
(braket
id|dev
)braket
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_card_free
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
id|strcpy
c_func
(paren
id|card-&gt;shortname
comma
id|rme9652-&gt;card_name
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|card-&gt;longname
comma
l_string|&quot;%s at 0x%lx, irq %d&quot;
comma
id|card-&gt;shortname
comma
id|rme9652-&gt;port
comma
id|rme9652-&gt;irq
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_card_register
c_func
(paren
id|card
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_card_free
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
id|pci_set_drvdata
c_func
(paren
id|pci
comma
id|card
)paren
suffix:semicolon
id|dev
op_increment
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_rme9652_remove
r_static
r_void
id|__devexit
id|snd_rme9652_remove
c_func
(paren
r_struct
id|pci_dev
op_star
id|pci
)paren
(brace
id|snd_card_free
c_func
(paren
id|pci_get_drvdata
c_func
(paren
id|pci
)paren
)paren
suffix:semicolon
id|pci_set_drvdata
c_func
(paren
id|pci
comma
l_int|NULL
)paren
suffix:semicolon
)brace
DECL|variable|driver
r_static
r_struct
id|pci_driver
id|driver
op_assign
(brace
id|name
suffix:colon
l_string|&quot;RME Digi9652 (Hammerfall)&quot;
comma
id|id_table
suffix:colon
id|snd_rme9652_ids
comma
id|probe
suffix:colon
id|snd_rme9652_probe
comma
id|remove
suffix:colon
id|__devexit_p
c_func
(paren
id|snd_rme9652_remove
)paren
comma
)brace
suffix:semicolon
DECL|function|alsa_card_hammerfall_init
r_static
r_int
id|__init
id|alsa_card_hammerfall_init
c_func
(paren
r_void
)paren
(brace
r_if
c_cond
(paren
id|pci_module_init
c_func
(paren
op_amp
id|driver
)paren
OL
l_int|0
)paren
(brace
macro_line|#ifdef MODULE
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;RME Digi9652/Digi9636: no cards found&bslash;n&quot;
)paren
suffix:semicolon
macro_line|#endif
r_return
op_minus
id|ENODEV
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|alsa_card_hammerfall_exit
r_static
r_void
id|__exit
id|alsa_card_hammerfall_exit
c_func
(paren
r_void
)paren
(brace
id|pci_unregister_driver
c_func
(paren
op_amp
id|driver
)paren
suffix:semicolon
)brace
id|module_init
c_func
(paren
id|alsa_card_hammerfall_init
)paren
id|module_exit
c_func
(paren
id|alsa_card_hammerfall_exit
)paren
macro_line|#ifndef MODULE
multiline_comment|/* format is: snd-rme9652=snd_enable,snd_index,snd_id */
DECL|function|alsa_card_rme9652_setup
r_static
r_int
id|__init
id|alsa_card_rme9652_setup
c_func
(paren
r_char
op_star
id|str
)paren
(brace
r_static
r_int
id|__initdata
id|nr_dev
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|nr_dev
op_ge
id|SNDRV_CARDS
)paren
r_return
l_int|0
suffix:semicolon
(paren
r_void
)paren
(paren
id|get_option
c_func
(paren
op_amp
id|str
comma
op_amp
id|snd_enable
(braket
id|nr_dev
)braket
)paren
op_eq
l_int|2
op_logical_and
id|get_option
c_func
(paren
op_amp
id|str
comma
op_amp
id|snd_index
(braket
id|nr_dev
)braket
)paren
op_eq
l_int|2
op_logical_and
id|get_id
c_func
(paren
op_amp
id|str
comma
op_amp
id|snd_id
(braket
id|nr_dev
)braket
)paren
op_eq
l_int|2
)paren
suffix:semicolon
id|nr_dev
op_increment
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
id|__setup
c_func
(paren
l_string|&quot;snd-rme9652=&quot;
comma
id|alsa_card_rme9652_setup
)paren
suffix:semicolon
macro_line|#endif /* ifndef MODULE */
eof
