multiline_comment|/*&n; *  Copyright (c) by Jaroslav Kysela &lt;perex@suse.cz&gt;&n; *  Routines for control of YMF724/740/744/754 chips&n; *&n; *  BUGS:&n; *    --&n; *&n; *  TODO:&n; *    --&n; *&n; *   This program is free software; you can redistribute it and/or modify&n; *   it under the terms of the GNU General Public License as published by&n; *   the Free Software Foundation; either version 2 of the License, or&n; *   (at your option) any later version.&n; *&n; *   This program is distributed in the hope that it will be useful,&n; *   but WITHOUT ANY WARRANTY; without even the implied warranty of&n; *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; *   GNU General Public License for more details.&n; *&n; *   You should have received a copy of the GNU General Public License&n; *   along with this program; if not, write to the Free Software&n; *   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA&n; *&n; */
DECL|macro|__NO_VERSION__
mdefine_line|#define __NO_VERSION__
macro_line|#include &lt;sound/driver.h&gt;
macro_line|#include &lt;asm/io.h&gt;
macro_line|#include &lt;linux/delay.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;sound/core.h&gt;
macro_line|#include &lt;sound/control.h&gt;
macro_line|#include &lt;sound/info.h&gt;
macro_line|#include &lt;sound/ymfpci.h&gt;
macro_line|#include &lt;sound/asoundef.h&gt;
macro_line|#include &lt;sound/mpu401.h&gt;
DECL|macro|chip_t
mdefine_line|#define chip_t ymfpci_t
multiline_comment|/*&n; *  constants&n; */
multiline_comment|/*&n; *  common I/O routines&n; */
r_static
r_void
id|snd_ymfpci_irq_wait
c_func
(paren
id|ymfpci_t
op_star
id|chip
)paren
suffix:semicolon
DECL|function|snd_ymfpci_readb
r_static
r_inline
id|u8
id|snd_ymfpci_readb
c_func
(paren
id|ymfpci_t
op_star
id|chip
comma
id|u32
id|offset
)paren
(brace
r_return
id|readb
c_func
(paren
id|chip-&gt;reg_area_virt
op_plus
id|offset
)paren
suffix:semicolon
)brace
DECL|function|snd_ymfpci_writeb
r_static
r_inline
r_void
id|snd_ymfpci_writeb
c_func
(paren
id|ymfpci_t
op_star
id|chip
comma
id|u32
id|offset
comma
id|u8
id|val
)paren
(brace
id|writeb
c_func
(paren
id|val
comma
id|chip-&gt;reg_area_virt
op_plus
id|offset
)paren
suffix:semicolon
)brace
DECL|function|snd_ymfpci_readw
r_static
r_inline
id|u16
id|snd_ymfpci_readw
c_func
(paren
id|ymfpci_t
op_star
id|chip
comma
id|u32
id|offset
)paren
(brace
r_return
id|readw
c_func
(paren
id|chip-&gt;reg_area_virt
op_plus
id|offset
)paren
suffix:semicolon
)brace
DECL|function|snd_ymfpci_writew
r_static
r_inline
r_void
id|snd_ymfpci_writew
c_func
(paren
id|ymfpci_t
op_star
id|chip
comma
id|u32
id|offset
comma
id|u16
id|val
)paren
(brace
id|writew
c_func
(paren
id|val
comma
id|chip-&gt;reg_area_virt
op_plus
id|offset
)paren
suffix:semicolon
)brace
DECL|function|snd_ymfpci_readl
r_static
r_inline
id|u32
id|snd_ymfpci_readl
c_func
(paren
id|ymfpci_t
op_star
id|chip
comma
id|u32
id|offset
)paren
(brace
r_return
id|readl
c_func
(paren
id|chip-&gt;reg_area_virt
op_plus
id|offset
)paren
suffix:semicolon
)brace
DECL|function|snd_ymfpci_writel
r_static
r_inline
r_void
id|snd_ymfpci_writel
c_func
(paren
id|ymfpci_t
op_star
id|chip
comma
id|u32
id|offset
comma
id|u32
id|val
)paren
(brace
id|writel
c_func
(paren
id|val
comma
id|chip-&gt;reg_area_virt
op_plus
id|offset
)paren
suffix:semicolon
)brace
DECL|function|snd_ymfpci_codec_ready
r_static
r_int
id|snd_ymfpci_codec_ready
c_func
(paren
id|ymfpci_t
op_star
id|chip
comma
r_int
id|secondary
comma
r_int
id|sched
)paren
(brace
r_int
r_int
id|end_time
suffix:semicolon
id|u32
id|reg
op_assign
id|secondary
ques
c_cond
id|YDSXGR_SECSTATUSADR
suffix:colon
id|YDSXGR_PRISTATUSADR
suffix:semicolon
id|end_time
op_assign
(paren
id|jiffies
op_plus
(paren
(paren
l_int|3
op_star
id|HZ
)paren
op_div
l_int|4
)paren
)paren
op_plus
l_int|1
suffix:semicolon
r_do
(brace
r_if
c_cond
(paren
(paren
id|snd_ymfpci_readw
c_func
(paren
id|chip
comma
id|reg
)paren
op_amp
l_int|0x8000
)paren
op_eq
l_int|0
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|sched
)paren
(brace
id|set_current_state
c_func
(paren
id|TASK_UNINTERRUPTIBLE
)paren
suffix:semicolon
id|schedule_timeout
c_func
(paren
l_int|1
)paren
suffix:semicolon
)brace
)brace
r_while
c_loop
(paren
id|end_time
op_minus
(paren
r_int
r_int
)paren
id|jiffies
op_ge
l_int|0
)paren
suffix:semicolon
id|snd_printk
c_func
(paren
l_string|&quot;codec_ready: codec %i is not ready [0x%x]&bslash;n&quot;
comma
id|secondary
comma
id|snd_ymfpci_readw
c_func
(paren
id|chip
comma
id|reg
)paren
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
DECL|function|snd_ymfpci_codec_write
r_static
r_void
id|snd_ymfpci_codec_write
c_func
(paren
id|ac97_t
op_star
id|ac97
comma
id|u16
id|reg
comma
id|u16
id|val
)paren
(brace
id|ymfpci_t
op_star
id|chip
op_assign
id|snd_magic_cast
c_func
(paren
id|ymfpci_t
comma
id|ac97-&gt;private_data
comma
r_return
)paren
suffix:semicolon
id|u32
id|cmd
suffix:semicolon
id|snd_ymfpci_codec_ready
c_func
(paren
id|chip
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
id|cmd
op_assign
(paren
(paren
id|YDSXG_AC97WRITECMD
op_or
id|reg
)paren
op_lshift
l_int|16
)paren
op_or
id|val
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_AC97CMDDATA
comma
id|cmd
)paren
suffix:semicolon
)brace
DECL|function|snd_ymfpci_codec_read
r_static
id|u16
id|snd_ymfpci_codec_read
c_func
(paren
id|ac97_t
op_star
id|ac97
comma
id|u16
id|reg
)paren
(brace
id|ymfpci_t
op_star
id|chip
op_assign
id|snd_magic_cast
c_func
(paren
id|ymfpci_t
comma
id|ac97-&gt;private_data
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
r_if
c_cond
(paren
id|snd_ymfpci_codec_ready
c_func
(paren
id|chip
comma
l_int|0
comma
l_int|0
)paren
)paren
r_return
op_complement
l_int|0
suffix:semicolon
id|snd_ymfpci_writew
c_func
(paren
id|chip
comma
id|YDSXGR_AC97CMDADR
comma
id|YDSXG_AC97READCMD
op_or
id|reg
)paren
suffix:semicolon
r_if
c_cond
(paren
id|snd_ymfpci_codec_ready
c_func
(paren
id|chip
comma
l_int|0
comma
l_int|0
)paren
)paren
r_return
op_complement
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;device_id
op_eq
id|PCI_DEVICE_ID_YAMAHA_744
op_logical_and
id|chip-&gt;rev
OL
l_int|2
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|600
suffix:semicolon
id|i
op_increment
)paren
id|snd_ymfpci_readw
c_func
(paren
id|chip
comma
id|YDSXGR_PRISTATUSDATA
)paren
suffix:semicolon
)brace
r_return
id|snd_ymfpci_readw
c_func
(paren
id|chip
comma
id|YDSXGR_PRISTATUSDATA
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; *  Misc routines&n; */
DECL|function|snd_ymfpci_calc_delta
r_static
id|u32
id|snd_ymfpci_calc_delta
c_func
(paren
id|u32
id|rate
)paren
(brace
r_switch
c_cond
(paren
id|rate
)paren
(brace
r_case
l_int|8000
suffix:colon
r_return
l_int|0x02aaab00
suffix:semicolon
r_case
l_int|11025
suffix:colon
r_return
l_int|0x03accd00
suffix:semicolon
r_case
l_int|16000
suffix:colon
r_return
l_int|0x05555500
suffix:semicolon
r_case
l_int|22050
suffix:colon
r_return
l_int|0x07599a00
suffix:semicolon
r_case
l_int|32000
suffix:colon
r_return
l_int|0x0aaaab00
suffix:semicolon
r_case
l_int|44100
suffix:colon
r_return
l_int|0x0eb33300
suffix:semicolon
r_default
suffix:colon
r_return
(paren
(paren
id|rate
op_lshift
l_int|16
)paren
op_div
l_int|375
)paren
op_lshift
l_int|5
suffix:semicolon
)brace
)brace
DECL|variable|def_rate
r_static
id|u32
id|def_rate
(braket
l_int|8
)braket
op_assign
(brace
l_int|100
comma
l_int|2000
comma
l_int|8000
comma
l_int|11025
comma
l_int|16000
comma
l_int|22050
comma
l_int|32000
comma
l_int|48000
)brace
suffix:semicolon
DECL|function|snd_ymfpci_calc_lpfK
r_static
id|u32
id|snd_ymfpci_calc_lpfK
c_func
(paren
id|u32
id|rate
)paren
(brace
id|u32
id|i
suffix:semicolon
r_static
id|u32
id|val
(braket
l_int|8
)braket
op_assign
(brace
l_int|0x00570000
comma
l_int|0x06AA0000
comma
l_int|0x18B20000
comma
l_int|0x20930000
comma
l_int|0x2B9A0000
comma
l_int|0x35A10000
comma
l_int|0x3EAA0000
comma
l_int|0x40000000
)brace
suffix:semicolon
r_if
c_cond
(paren
id|rate
op_eq
l_int|44100
)paren
r_return
l_int|0x40000000
suffix:semicolon
multiline_comment|/* FIXME: What&squot;s the right value? */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|8
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|rate
op_le
id|def_rate
(braket
id|i
)braket
)paren
r_return
id|val
(braket
id|i
)braket
suffix:semicolon
r_return
id|val
(braket
l_int|0
)braket
suffix:semicolon
)brace
DECL|function|snd_ymfpci_calc_lpfQ
r_static
id|u32
id|snd_ymfpci_calc_lpfQ
c_func
(paren
id|u32
id|rate
)paren
(brace
id|u32
id|i
suffix:semicolon
r_static
id|u32
id|val
(braket
l_int|8
)braket
op_assign
(brace
l_int|0x35280000
comma
l_int|0x34A70000
comma
l_int|0x32020000
comma
l_int|0x31770000
comma
l_int|0x31390000
comma
l_int|0x31C90000
comma
l_int|0x33D00000
comma
l_int|0x40000000
)brace
suffix:semicolon
r_if
c_cond
(paren
id|rate
op_eq
l_int|44100
)paren
r_return
l_int|0x370A0000
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|8
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|rate
op_le
id|def_rate
(braket
id|i
)braket
)paren
r_return
id|val
(braket
id|i
)braket
suffix:semicolon
r_return
id|val
(braket
l_int|0
)braket
suffix:semicolon
)brace
multiline_comment|/*&n; *  Hardware start management&n; */
DECL|function|snd_ymfpci_hw_start
r_static
r_void
id|snd_ymfpci_hw_start
c_func
(paren
id|ymfpci_t
op_star
id|chip
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;start_count
op_increment
OG
l_int|0
)paren
r_goto
id|__end
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_MODE
comma
id|snd_ymfpci_readl
c_func
(paren
id|chip
comma
id|YDSXGR_MODE
)paren
op_or
l_int|3
)paren
suffix:semicolon
id|chip-&gt;active_bank
op_assign
id|snd_ymfpci_readl
c_func
(paren
id|chip
comma
id|YDSXGR_CTRLSELECT
)paren
op_amp
l_int|1
suffix:semicolon
id|__end
suffix:colon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|snd_ymfpci_hw_stop
r_static
r_void
id|snd_ymfpci_hw_stop
c_func
(paren
id|ymfpci_t
op_star
id|chip
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
r_int
id|timeout
op_assign
l_int|1000
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
op_decrement
id|chip-&gt;start_count
OG
l_int|0
)paren
r_goto
id|__end
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_MODE
comma
id|snd_ymfpci_readl
c_func
(paren
id|chip
comma
id|YDSXGR_MODE
)paren
op_amp
op_complement
l_int|3
)paren
suffix:semicolon
r_while
c_loop
(paren
id|timeout
op_decrement
OG
l_int|0
)paren
(brace
r_if
c_cond
(paren
(paren
id|snd_ymfpci_readl
c_func
(paren
id|chip
comma
id|YDSXGR_STATUS
)paren
op_amp
l_int|2
)paren
op_eq
l_int|0
)paren
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|chip-&gt;interrupt_sleep_count
)paren
)paren
(brace
id|atomic_set
c_func
(paren
op_amp
id|chip-&gt;interrupt_sleep_count
comma
l_int|0
)paren
suffix:semicolon
id|wake_up
c_func
(paren
op_amp
id|chip-&gt;interrupt_sleep
)paren
suffix:semicolon
)brace
id|__end
suffix:colon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; *  Playback voice management&n; */
DECL|function|voice_alloc
r_static
r_int
id|voice_alloc
c_func
(paren
id|ymfpci_t
op_star
id|chip
comma
id|ymfpci_voice_type_t
id|type
comma
r_int
id|pair
comma
id|ymfpci_voice_t
op_star
op_star
id|rvoice
)paren
(brace
id|ymfpci_voice_t
op_star
id|voice
comma
op_star
id|voice2
suffix:semicolon
r_int
id|idx
suffix:semicolon
op_star
id|rvoice
op_assign
l_int|NULL
suffix:semicolon
r_for
c_loop
(paren
id|idx
op_assign
l_int|0
suffix:semicolon
id|idx
OL
id|YDSXG_PLAYBACK_VOICES
suffix:semicolon
id|idx
op_add_assign
id|pair
ques
c_cond
l_int|2
suffix:colon
l_int|1
)paren
(brace
id|voice
op_assign
op_amp
id|chip-&gt;voices
(braket
id|idx
)braket
suffix:semicolon
id|voice2
op_assign
id|pair
ques
c_cond
op_amp
id|chip-&gt;voices
(braket
id|idx
op_plus
l_int|1
)braket
suffix:colon
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
id|voice-&gt;use
op_logical_or
(paren
id|voice2
op_logical_and
id|voice2-&gt;use
)paren
)paren
r_continue
suffix:semicolon
id|voice-&gt;use
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|voice2
)paren
id|voice2-&gt;use
op_assign
l_int|1
suffix:semicolon
r_switch
c_cond
(paren
id|type
)paren
(brace
r_case
id|YMFPCI_PCM
suffix:colon
id|voice-&gt;pcm
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|voice2
)paren
id|voice2-&gt;pcm
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_case
id|YMFPCI_SYNTH
suffix:colon
id|voice-&gt;synth
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_case
id|YMFPCI_MIDI
suffix:colon
id|voice-&gt;midi
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
)brace
id|snd_ymfpci_hw_start
c_func
(paren
id|chip
)paren
suffix:semicolon
r_if
c_cond
(paren
id|voice2
)paren
id|snd_ymfpci_hw_start
c_func
(paren
id|chip
)paren
suffix:semicolon
op_star
id|rvoice
op_assign
id|voice
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
DECL|function|snd_ymfpci_voice_alloc
r_int
id|snd_ymfpci_voice_alloc
c_func
(paren
id|ymfpci_t
op_star
id|chip
comma
id|ymfpci_voice_type_t
id|type
comma
r_int
id|pair
comma
id|ymfpci_voice_t
op_star
op_star
id|rvoice
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
r_int
id|result
suffix:semicolon
id|snd_assert
c_func
(paren
id|rvoice
op_ne
l_int|NULL
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
op_logical_neg
id|pair
op_logical_or
id|type
op_eq
id|YMFPCI_PCM
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;voice_lock
comma
id|flags
)paren
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
suffix:semicolon
)paren
(brace
id|result
op_assign
id|voice_alloc
c_func
(paren
id|chip
comma
id|type
comma
id|pair
comma
id|rvoice
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
op_eq
l_int|0
op_logical_or
id|type
op_ne
id|YMFPCI_PCM
)paren
r_break
suffix:semicolon
multiline_comment|/* TODO: synth/midi voice deallocation */
r_break
suffix:semicolon
)brace
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;voice_lock
comma
id|flags
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
DECL|function|snd_ymfpci_voice_free
r_int
id|snd_ymfpci_voice_free
c_func
(paren
id|ymfpci_t
op_star
id|chip
comma
id|ymfpci_voice_t
op_star
id|pvoice
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
id|snd_assert
c_func
(paren
id|pvoice
op_ne
l_int|NULL
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|snd_ymfpci_hw_stop
c_func
(paren
id|chip
)paren
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;voice_lock
comma
id|flags
)paren
suffix:semicolon
id|pvoice-&gt;use
op_assign
id|pvoice-&gt;pcm
op_assign
id|pvoice-&gt;synth
op_assign
id|pvoice-&gt;midi
op_assign
l_int|0
suffix:semicolon
id|pvoice-&gt;ypcm
op_assign
l_int|NULL
suffix:semicolon
id|pvoice-&gt;interrupt
op_assign
l_int|NULL
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;voice_lock
comma
id|flags
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; *  PCM part&n; */
DECL|function|snd_ymfpci_pcm_interrupt
r_static
r_void
id|snd_ymfpci_pcm_interrupt
c_func
(paren
id|ymfpci_t
op_star
id|chip
comma
id|ymfpci_voice_t
op_star
id|voice
)paren
(brace
id|ymfpci_pcm_t
op_star
id|ypcm
suffix:semicolon
id|u32
id|pos
comma
id|delta
suffix:semicolon
r_if
c_cond
(paren
(paren
id|ypcm
op_assign
id|voice-&gt;ypcm
)paren
op_eq
l_int|NULL
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|ypcm-&gt;substream
op_eq
l_int|NULL
)paren
r_return
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ypcm-&gt;running
)paren
(brace
id|pos
op_assign
id|le32_to_cpu
c_func
(paren
id|voice-&gt;bank
(braket
id|chip-&gt;active_bank
)braket
dot
id|start
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pos
OL
id|ypcm-&gt;last_pos
)paren
id|delta
op_assign
id|pos
op_plus
(paren
id|ypcm-&gt;buffer_size
op_minus
id|ypcm-&gt;last_pos
)paren
suffix:semicolon
r_else
id|delta
op_assign
id|pos
op_minus
id|ypcm-&gt;last_pos
suffix:semicolon
id|ypcm-&gt;period_pos
op_add_assign
id|delta
suffix:semicolon
id|ypcm-&gt;last_pos
op_assign
id|pos
suffix:semicolon
r_while
c_loop
(paren
id|ypcm-&gt;period_pos
op_ge
id|ypcm-&gt;period_size
)paren
(brace
singleline_comment|// printk(&quot;done - active_bank = 0x%x, start = 0x%x&bslash;n&quot;, chip-&gt;active_bank, voice-&gt;bank[chip-&gt;active_bank].start);
id|spin_unlock
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
id|snd_pcm_period_elapsed
c_func
(paren
id|ypcm-&gt;substream
)paren
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
id|ypcm-&gt;period_pos
op_sub_assign
id|ypcm-&gt;period_size
suffix:semicolon
)brace
)brace
id|spin_unlock
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
)brace
DECL|function|snd_ymfpci_pcm_capture_interrupt
r_static
r_void
id|snd_ymfpci_pcm_capture_interrupt
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|ymfpci_pcm_t
op_star
id|ypcm
op_assign
id|snd_magic_cast
c_func
(paren
id|ymfpci_pcm_t
comma
id|runtime-&gt;private_data
comma
r_return
)paren
suffix:semicolon
id|ymfpci_t
op_star
id|chip
op_assign
id|ypcm-&gt;chip
suffix:semicolon
id|u32
id|pos
comma
id|delta
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ypcm-&gt;running
)paren
(brace
id|pos
op_assign
id|le32_to_cpu
c_func
(paren
id|chip-&gt;bank_capture
(braket
id|ypcm-&gt;capture_bank_number
)braket
(braket
id|chip-&gt;active_bank
)braket
op_member_access_from_pointer
id|start
)paren
op_rshift
id|ypcm-&gt;shift
suffix:semicolon
r_if
c_cond
(paren
id|pos
OL
id|ypcm-&gt;last_pos
)paren
id|delta
op_assign
id|pos
op_plus
(paren
id|ypcm-&gt;buffer_size
op_minus
id|ypcm-&gt;last_pos
)paren
suffix:semicolon
r_else
id|delta
op_assign
id|pos
op_minus
id|ypcm-&gt;last_pos
suffix:semicolon
id|ypcm-&gt;period_pos
op_add_assign
id|delta
suffix:semicolon
id|ypcm-&gt;last_pos
op_assign
id|pos
suffix:semicolon
r_while
c_loop
(paren
id|ypcm-&gt;period_pos
op_ge
id|ypcm-&gt;period_size
)paren
(brace
id|ypcm-&gt;period_pos
op_assign
l_int|0
suffix:semicolon
singleline_comment|// printk(&quot;done - active_bank = 0x%x, start = 0x%x&bslash;n&quot;, chip-&gt;active_bank, voice-&gt;bank[chip-&gt;active_bank].start);
id|spin_unlock
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
id|snd_pcm_period_elapsed
c_func
(paren
id|substream
)paren
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
)brace
)brace
id|spin_unlock
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
)brace
DECL|function|snd_ymfpci_playback_trigger
r_static
r_int
id|snd_ymfpci_playback_trigger
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|cmd
)paren
(brace
id|ymfpci_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|ymfpci_pcm_t
op_star
id|ypcm
op_assign
id|snd_magic_cast
c_func
(paren
id|ymfpci_pcm_t
comma
id|substream-&gt;runtime-&gt;private_data
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
r_int
id|result
op_assign
l_int|0
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ypcm-&gt;voices
(braket
l_int|0
)braket
op_eq
l_int|NULL
)paren
(brace
id|result
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_goto
id|__unlock
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|SNDRV_PCM_TRIGGER_START
suffix:colon
r_case
id|SNDRV_PCM_TRIGGER_PAUSE_RELEASE
suffix:colon
r_case
id|SNDRV_PCM_TRIGGER_RESUME
suffix:colon
id|chip-&gt;ctrl_playback
(braket
id|ypcm-&gt;voices
(braket
l_int|0
)braket
op_member_access_from_pointer
id|number
op_plus
l_int|1
)braket
op_assign
id|cpu_to_le32
c_func
(paren
id|ypcm-&gt;voices
(braket
l_int|0
)braket
op_member_access_from_pointer
id|bank_addr
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ypcm-&gt;voices
(braket
l_int|1
)braket
op_ne
l_int|NULL
)paren
id|chip-&gt;ctrl_playback
(braket
id|ypcm-&gt;voices
(braket
l_int|1
)braket
op_member_access_from_pointer
id|number
op_plus
l_int|1
)braket
op_assign
id|cpu_to_le32
c_func
(paren
id|ypcm-&gt;voices
(braket
l_int|1
)braket
op_member_access_from_pointer
id|bank_addr
)paren
suffix:semicolon
id|ypcm-&gt;running
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_TRIGGER_STOP
suffix:colon
r_case
id|SNDRV_PCM_TRIGGER_PAUSE_PUSH
suffix:colon
r_case
id|SNDRV_PCM_TRIGGER_SUSPEND
suffix:colon
id|chip-&gt;ctrl_playback
(braket
id|ypcm-&gt;voices
(braket
l_int|0
)braket
op_member_access_from_pointer
id|number
op_plus
l_int|1
)braket
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|ypcm-&gt;voices
(braket
l_int|1
)braket
op_ne
l_int|NULL
)paren
id|chip-&gt;ctrl_playback
(braket
id|ypcm-&gt;voices
(braket
l_int|1
)braket
op_member_access_from_pointer
id|number
op_plus
l_int|1
)braket
op_assign
l_int|0
suffix:semicolon
id|ypcm-&gt;running
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|result
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_break
suffix:semicolon
)brace
id|__unlock
suffix:colon
id|spin_unlock
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
DECL|function|snd_ymfpci_capture_trigger
r_static
r_int
id|snd_ymfpci_capture_trigger
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|cmd
)paren
(brace
id|ymfpci_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|ymfpci_pcm_t
op_star
id|ypcm
op_assign
id|snd_magic_cast
c_func
(paren
id|ymfpci_pcm_t
comma
id|substream-&gt;runtime-&gt;private_data
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
r_int
id|result
op_assign
l_int|0
suffix:semicolon
id|u32
id|tmp
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|SNDRV_PCM_TRIGGER_START
suffix:colon
r_case
id|SNDRV_PCM_TRIGGER_PAUSE_RELEASE
suffix:colon
r_case
id|SNDRV_PCM_TRIGGER_RESUME
suffix:colon
id|tmp
op_assign
id|snd_ymfpci_readl
c_func
(paren
id|chip
comma
id|YDSXGR_MAPOFREC
)paren
op_or
(paren
l_int|1
op_lshift
id|ypcm-&gt;capture_bank_number
)paren
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_MAPOFREC
comma
id|tmp
)paren
suffix:semicolon
id|ypcm-&gt;running
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_TRIGGER_STOP
suffix:colon
r_case
id|SNDRV_PCM_TRIGGER_PAUSE_PUSH
suffix:colon
r_case
id|SNDRV_PCM_TRIGGER_SUSPEND
suffix:colon
id|tmp
op_assign
id|snd_ymfpci_readl
c_func
(paren
id|chip
comma
id|YDSXGR_MAPOFREC
)paren
op_amp
op_complement
(paren
l_int|1
op_lshift
id|ypcm-&gt;capture_bank_number
)paren
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_MAPOFREC
comma
id|tmp
)paren
suffix:semicolon
id|ypcm-&gt;running
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|result
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_break
suffix:semicolon
)brace
id|spin_unlock
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
DECL|function|snd_ymfpci_pcm_voice_alloc
r_static
r_int
id|snd_ymfpci_pcm_voice_alloc
c_func
(paren
id|ymfpci_pcm_t
op_star
id|ypcm
comma
r_int
id|voices
)paren
(brace
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
id|ypcm-&gt;voices
(braket
l_int|1
)braket
op_ne
l_int|NULL
op_logical_and
id|voices
OL
l_int|2
)paren
(brace
id|snd_ymfpci_voice_free
c_func
(paren
id|ypcm-&gt;chip
comma
id|ypcm-&gt;voices
(braket
l_int|1
)braket
)paren
suffix:semicolon
id|ypcm-&gt;voices
(braket
l_int|1
)braket
op_assign
l_int|NULL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|voices
op_eq
l_int|1
op_logical_and
id|ypcm-&gt;voices
(braket
l_int|0
)braket
op_ne
l_int|NULL
)paren
r_return
l_int|0
suffix:semicolon
multiline_comment|/* already allocated */
r_if
c_cond
(paren
id|voices
op_eq
l_int|2
op_logical_and
id|ypcm-&gt;voices
(braket
l_int|0
)braket
op_ne
l_int|NULL
op_logical_and
id|ypcm-&gt;voices
(braket
l_int|1
)braket
op_ne
l_int|NULL
)paren
r_return
l_int|0
suffix:semicolon
multiline_comment|/* already allocated */
r_if
c_cond
(paren
id|voices
OG
l_int|1
)paren
(brace
r_if
c_cond
(paren
id|ypcm-&gt;voices
(braket
l_int|0
)braket
op_ne
l_int|NULL
op_logical_and
id|ypcm-&gt;voices
(braket
l_int|1
)braket
op_eq
l_int|NULL
)paren
(brace
id|snd_ymfpci_voice_free
c_func
(paren
id|ypcm-&gt;chip
comma
id|ypcm-&gt;voices
(braket
l_int|0
)braket
)paren
suffix:semicolon
id|ypcm-&gt;voices
(braket
l_int|0
)braket
op_assign
l_int|NULL
suffix:semicolon
)brace
)brace
id|err
op_assign
id|snd_ymfpci_voice_alloc
c_func
(paren
id|ypcm-&gt;chip
comma
id|YMFPCI_PCM
comma
id|voices
OG
l_int|1
comma
op_amp
id|ypcm-&gt;voices
(braket
l_int|0
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|ypcm-&gt;voices
(braket
l_int|0
)braket
op_member_access_from_pointer
id|ypcm
op_assign
id|ypcm
suffix:semicolon
id|ypcm-&gt;voices
(braket
l_int|0
)braket
op_member_access_from_pointer
id|interrupt
op_assign
id|snd_ymfpci_pcm_interrupt
suffix:semicolon
r_if
c_cond
(paren
id|voices
OG
l_int|1
)paren
(brace
id|ypcm-&gt;voices
(braket
l_int|1
)braket
op_assign
op_amp
id|ypcm-&gt;chip-&gt;voices
(braket
id|ypcm-&gt;voices
(braket
l_int|0
)braket
op_member_access_from_pointer
id|number
op_plus
l_int|1
)braket
suffix:semicolon
id|ypcm-&gt;voices
(braket
l_int|1
)braket
op_member_access_from_pointer
id|ypcm
op_assign
id|ypcm
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ymfpci_pcm_init_voice
r_static
r_void
id|snd_ymfpci_pcm_init_voice
c_func
(paren
id|ymfpci_voice_t
op_star
id|voice
comma
r_int
id|stereo
comma
r_int
id|rate
comma
r_int
id|w_16
comma
r_int
r_int
id|addr
comma
r_int
r_int
id|end
comma
r_int
id|eff2
)paren
(brace
id|u32
id|format
suffix:semicolon
id|u32
id|delta
op_assign
id|snd_ymfpci_calc_delta
c_func
(paren
id|rate
)paren
suffix:semicolon
id|u32
id|lpfQ
op_assign
id|snd_ymfpci_calc_lpfQ
c_func
(paren
id|rate
)paren
suffix:semicolon
id|u32
id|lpfK
op_assign
id|snd_ymfpci_calc_lpfK
c_func
(paren
id|rate
)paren
suffix:semicolon
id|snd_ymfpci_playback_bank_t
op_star
id|bank
suffix:semicolon
r_int
r_int
id|nbank
suffix:semicolon
id|snd_assert
c_func
(paren
id|voice
op_ne
l_int|NULL
comma
r_return
)paren
suffix:semicolon
id|format
op_assign
(paren
id|stereo
ques
c_cond
l_int|0x00010000
suffix:colon
l_int|0
)paren
op_or
(paren
id|w_16
ques
c_cond
l_int|0
suffix:colon
l_int|0x80000000
)paren
suffix:semicolon
r_for
c_loop
(paren
id|nbank
op_assign
l_int|0
suffix:semicolon
id|nbank
OL
l_int|2
suffix:semicolon
id|nbank
op_increment
)paren
(brace
id|bank
op_assign
op_amp
id|voice-&gt;bank
(braket
id|nbank
)braket
suffix:semicolon
id|bank-&gt;format
op_assign
id|cpu_to_le32
c_func
(paren
id|format
)paren
suffix:semicolon
id|bank-&gt;loop_default
op_assign
l_int|0
suffix:semicolon
id|bank-&gt;base
op_assign
id|cpu_to_le32
c_func
(paren
id|addr
)paren
suffix:semicolon
id|bank-&gt;loop_start
op_assign
l_int|0
suffix:semicolon
id|bank-&gt;loop_end
op_assign
id|cpu_to_le32
c_func
(paren
id|end
)paren
suffix:semicolon
id|bank-&gt;loop_frac
op_assign
l_int|0
suffix:semicolon
id|bank-&gt;eg_gain_end
op_assign
id|cpu_to_le32
c_func
(paren
l_int|0x40000000
)paren
suffix:semicolon
id|bank-&gt;lpfQ
op_assign
id|cpu_to_le32
c_func
(paren
id|lpfQ
)paren
suffix:semicolon
id|bank-&gt;status
op_assign
l_int|0
suffix:semicolon
id|bank-&gt;num_of_frames
op_assign
l_int|0
suffix:semicolon
id|bank-&gt;loop_count
op_assign
l_int|0
suffix:semicolon
id|bank-&gt;start
op_assign
l_int|0
suffix:semicolon
id|bank-&gt;start_frac
op_assign
l_int|0
suffix:semicolon
id|bank-&gt;delta
op_assign
id|bank-&gt;delta_end
op_assign
id|cpu_to_le32
c_func
(paren
id|delta
)paren
suffix:semicolon
id|bank-&gt;lpfK
op_assign
id|bank-&gt;lpfK_end
op_assign
id|cpu_to_le32
c_func
(paren
id|lpfK
)paren
suffix:semicolon
id|bank-&gt;eg_gain
op_assign
id|cpu_to_le32
c_func
(paren
l_int|0x40000000
)paren
suffix:semicolon
id|bank-&gt;lpfD1
op_assign
id|bank-&gt;lpfD2
op_assign
l_int|0
suffix:semicolon
id|bank-&gt;left_gain
op_assign
id|bank-&gt;right_gain
op_assign
id|bank-&gt;left_gain_end
op_assign
id|bank-&gt;right_gain_end
op_assign
id|bank-&gt;eff1_gain
op_assign
id|bank-&gt;eff2_gain
op_assign
id|bank-&gt;eff3_gain
op_assign
id|bank-&gt;eff1_gain_end
op_assign
id|bank-&gt;eff2_gain_end
op_assign
id|bank-&gt;eff3_gain_end
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|stereo
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|eff2
)paren
(brace
id|bank-&gt;left_gain
op_assign
id|bank-&gt;right_gain
op_assign
id|bank-&gt;left_gain_end
op_assign
id|bank-&gt;right_gain_end
op_assign
id|cpu_to_le32
c_func
(paren
l_int|0x40000000
)paren
suffix:semicolon
)brace
r_else
(brace
id|bank-&gt;eff2_gain
op_assign
id|bank-&gt;eff2_gain_end
op_assign
id|bank-&gt;eff3_gain
op_assign
id|bank-&gt;eff3_gain_end
op_assign
id|cpu_to_le32
c_func
(paren
l_int|0x40000000
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
op_logical_neg
id|eff2
)paren
(brace
r_if
c_cond
(paren
(paren
id|voice-&gt;number
op_amp
l_int|1
)paren
op_eq
l_int|0
)paren
(brace
id|bank-&gt;left_gain
op_assign
id|bank-&gt;left_gain_end
op_assign
id|cpu_to_le32
c_func
(paren
l_int|0x40000000
)paren
suffix:semicolon
)brace
r_else
(brace
id|bank-&gt;format
op_or_assign
id|cpu_to_le32
c_func
(paren
l_int|1
)paren
suffix:semicolon
id|bank-&gt;right_gain
op_assign
id|bank-&gt;right_gain_end
op_assign
id|cpu_to_le32
c_func
(paren
l_int|0x40000000
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
(paren
id|voice-&gt;number
op_amp
l_int|1
)paren
op_eq
l_int|0
)paren
(brace
id|bank-&gt;eff3_gain
op_assign
id|bank-&gt;eff3_gain_end
op_assign
id|cpu_to_le32
c_func
(paren
l_int|0x40000000
)paren
suffix:semicolon
)brace
r_else
(brace
id|bank-&gt;format
op_or_assign
id|cpu_to_le32
c_func
(paren
l_int|1
)paren
suffix:semicolon
id|bank-&gt;eff2_gain
op_assign
id|bank-&gt;eff2_gain_end
op_assign
id|cpu_to_le32
c_func
(paren
l_int|0x40000000
)paren
suffix:semicolon
)brace
)brace
)brace
)brace
)brace
DECL|function|snd_ymfpci_ac3_init
r_static
r_int
id|snd_ymfpci_ac3_init
c_func
(paren
id|ymfpci_t
op_star
id|chip
)paren
(brace
r_int
r_char
op_star
id|ptr
suffix:semicolon
id|dma_addr_t
id|ptr_addr
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;ac3_tmp_base
op_ne
l_int|NULL
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
r_if
c_cond
(paren
(paren
id|ptr
op_assign
id|snd_malloc_pci_pages
c_func
(paren
id|chip-&gt;pci
comma
l_int|4096
comma
op_amp
id|ptr_addr
)paren
)paren
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|chip-&gt;ac3_tmp_base
op_assign
id|ptr
suffix:semicolon
id|chip-&gt;ac3_tmp_base_addr
op_assign
id|ptr_addr
suffix:semicolon
id|chip-&gt;bank_effect
(braket
l_int|3
)braket
(braket
l_int|0
)braket
op_member_access_from_pointer
id|base
op_assign
id|chip-&gt;bank_effect
(braket
l_int|3
)braket
(braket
l_int|1
)braket
op_member_access_from_pointer
id|base
op_assign
id|cpu_to_le32
c_func
(paren
id|chip-&gt;ac3_tmp_base_addr
)paren
suffix:semicolon
id|chip-&gt;bank_effect
(braket
l_int|3
)braket
(braket
l_int|0
)braket
op_member_access_from_pointer
id|loop_end
op_assign
id|chip-&gt;bank_effect
(braket
l_int|3
)braket
(braket
l_int|1
)braket
op_member_access_from_pointer
id|loop_end
op_assign
id|cpu_to_le32
c_func
(paren
l_int|1024
)paren
suffix:semicolon
id|chip-&gt;bank_effect
(braket
l_int|4
)braket
(braket
l_int|0
)braket
op_member_access_from_pointer
id|base
op_assign
id|chip-&gt;bank_effect
(braket
l_int|4
)braket
(braket
l_int|1
)braket
op_member_access_from_pointer
id|base
op_assign
id|cpu_to_le32
c_func
(paren
id|chip-&gt;ac3_tmp_base_addr
op_plus
l_int|2048
)paren
suffix:semicolon
id|chip-&gt;bank_effect
(braket
l_int|4
)braket
(braket
l_int|0
)braket
op_member_access_from_pointer
id|loop_end
op_assign
id|chip-&gt;bank_effect
(braket
l_int|4
)braket
(braket
l_int|1
)braket
op_member_access_from_pointer
id|loop_end
op_assign
id|cpu_to_le32
c_func
(paren
l_int|1024
)paren
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_MAPOFEFFECT
comma
id|snd_ymfpci_readl
c_func
(paren
id|chip
comma
id|YDSXGR_MAPOFEFFECT
)paren
op_or
l_int|3
op_lshift
l_int|3
)paren
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ymfpci_ac3_done
r_static
r_int
id|snd_ymfpci_ac3_done
c_func
(paren
id|ymfpci_t
op_star
id|chip
)paren
(brace
id|spin_lock_irq
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_MAPOFEFFECT
comma
id|snd_ymfpci_readl
c_func
(paren
id|chip
comma
id|YDSXGR_MAPOFEFFECT
)paren
op_amp
op_complement
(paren
l_int|3
op_lshift
l_int|3
)paren
)paren
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
id|snd_ymfpci_irq_wait
c_func
(paren
id|chip
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;ac3_tmp_base
)paren
(brace
id|snd_free_pci_pages
c_func
(paren
id|chip-&gt;pci
comma
l_int|4096
comma
id|chip-&gt;ac3_tmp_base
comma
id|chip-&gt;ac3_tmp_base_addr
)paren
suffix:semicolon
id|chip-&gt;ac3_tmp_base
op_assign
l_int|NULL
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ymfpci_playback_hw_params
r_static
r_int
id|snd_ymfpci_playback_hw_params
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_hw_params_t
op_star
id|hw_params
)paren
(brace
id|ymfpci_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|ymfpci_pcm_t
op_star
id|ypcm
op_assign
id|snd_magic_cast
c_func
(paren
id|ymfpci_pcm_t
comma
id|runtime-&gt;private_data
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_pcm_lib_malloc_pages
c_func
(paren
id|substream
comma
id|params_buffer_bytes
c_func
(paren
id|hw_params
)paren
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ymfpci_pcm_voice_alloc
c_func
(paren
id|ypcm
comma
id|params_channels
c_func
(paren
id|hw_params
)paren
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_if
c_cond
(paren
id|ypcm-&gt;spdif
op_logical_or
id|ypcm-&gt;mode4ch
)paren
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ymfpci_ac3_init
c_func
(paren
id|chip
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ymfpci_playback_hw_free
r_static
r_int
id|snd_ymfpci_playback_hw_free
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|ymfpci_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|ymfpci_pcm_t
op_star
id|ypcm
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;private_data
op_eq
l_int|NULL
)paren
r_return
l_int|0
suffix:semicolon
id|ypcm
op_assign
id|snd_magic_cast
c_func
(paren
id|ymfpci_pcm_t
comma
id|runtime-&gt;private_data
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
multiline_comment|/* wait, until the PCI operations are not finished */
id|snd_ymfpci_irq_wait
c_func
(paren
id|chip
)paren
suffix:semicolon
id|snd_pcm_lib_free_pages
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ypcm-&gt;voices
(braket
l_int|1
)braket
)paren
(brace
id|snd_ymfpci_voice_free
c_func
(paren
id|chip
comma
id|ypcm-&gt;voices
(braket
l_int|1
)braket
)paren
suffix:semicolon
id|ypcm-&gt;voices
(braket
l_int|1
)braket
op_assign
l_int|NULL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ypcm-&gt;voices
(braket
l_int|0
)braket
)paren
(brace
id|snd_ymfpci_voice_free
c_func
(paren
id|chip
comma
id|ypcm-&gt;voices
(braket
l_int|0
)braket
)paren
suffix:semicolon
id|ypcm-&gt;voices
(braket
l_int|0
)braket
op_assign
l_int|NULL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ypcm-&gt;spdif
op_logical_or
id|ypcm-&gt;mode4ch
)paren
id|snd_ymfpci_ac3_done
c_func
(paren
id|chip
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ymfpci_playback_prepare
r_static
r_int
id|snd_ymfpci_playback_prepare
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
singleline_comment|// ymfpci_t *chip = snd_pcm_substream_chip(substream);
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|ymfpci_pcm_t
op_star
id|ypcm
op_assign
id|snd_magic_cast
c_func
(paren
id|ymfpci_pcm_t
comma
id|runtime-&gt;private_data
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
r_int
id|nvoice
suffix:semicolon
id|ypcm-&gt;period_size
op_assign
id|runtime-&gt;period_size
suffix:semicolon
id|ypcm-&gt;buffer_size
op_assign
id|runtime-&gt;buffer_size
suffix:semicolon
id|ypcm-&gt;period_pos
op_assign
l_int|0
suffix:semicolon
id|ypcm-&gt;last_pos
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|nvoice
op_assign
l_int|0
suffix:semicolon
id|nvoice
OL
id|runtime-&gt;channels
suffix:semicolon
id|nvoice
op_increment
)paren
id|snd_ymfpci_pcm_init_voice
c_func
(paren
id|ypcm-&gt;voices
(braket
id|nvoice
)braket
comma
id|runtime-&gt;channels
op_eq
l_int|2
comma
id|runtime-&gt;rate
comma
id|snd_pcm_format_width
c_func
(paren
id|runtime-&gt;format
)paren
op_eq
l_int|16
comma
id|runtime-&gt;dma_addr
comma
id|ypcm-&gt;buffer_size
comma
id|ypcm-&gt;spdif
op_logical_or
id|ypcm-&gt;mode4ch
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ymfpci_capture_hw_params
r_static
r_int
id|snd_ymfpci_capture_hw_params
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_hw_params_t
op_star
id|hw_params
)paren
(brace
r_return
id|snd_pcm_lib_malloc_pages
c_func
(paren
id|substream
comma
id|params_buffer_bytes
c_func
(paren
id|hw_params
)paren
)paren
suffix:semicolon
)brace
DECL|function|snd_ymfpci_capture_hw_free
r_static
r_int
id|snd_ymfpci_capture_hw_free
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|ymfpci_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
multiline_comment|/* wait, until the PCI operations are not finished */
id|snd_ymfpci_irq_wait
c_func
(paren
id|chip
)paren
suffix:semicolon
r_return
id|snd_pcm_lib_free_pages
c_func
(paren
id|substream
)paren
suffix:semicolon
)brace
DECL|function|snd_ymfpci_capture_prepare
r_static
r_int
id|snd_ymfpci_capture_prepare
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|ymfpci_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|ymfpci_pcm_t
op_star
id|ypcm
op_assign
id|snd_magic_cast
c_func
(paren
id|ymfpci_pcm_t
comma
id|runtime-&gt;private_data
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|snd_ymfpci_capture_bank_t
op_star
id|bank
suffix:semicolon
r_int
id|nbank
suffix:semicolon
id|u32
id|rate
comma
id|format
suffix:semicolon
id|ypcm-&gt;period_size
op_assign
id|runtime-&gt;period_size
suffix:semicolon
id|ypcm-&gt;buffer_size
op_assign
id|runtime-&gt;buffer_size
suffix:semicolon
id|ypcm-&gt;period_pos
op_assign
l_int|0
suffix:semicolon
id|ypcm-&gt;last_pos
op_assign
l_int|0
suffix:semicolon
id|ypcm-&gt;shift
op_assign
l_int|0
suffix:semicolon
id|rate
op_assign
(paren
(paren
l_int|48000
op_star
l_int|4096
)paren
op_div
id|runtime-&gt;rate
)paren
op_minus
l_int|1
suffix:semicolon
id|format
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;channels
op_eq
l_int|2
)paren
(brace
id|format
op_or_assign
l_int|2
suffix:semicolon
id|ypcm-&gt;shift
op_increment
suffix:semicolon
)brace
r_if
c_cond
(paren
id|snd_pcm_format_width
c_func
(paren
id|runtime-&gt;format
)paren
op_eq
l_int|8
)paren
id|format
op_or_assign
l_int|1
suffix:semicolon
r_else
id|ypcm-&gt;shift
op_increment
suffix:semicolon
r_switch
c_cond
(paren
id|ypcm-&gt;capture_bank_number
)paren
(brace
r_case
l_int|0
suffix:colon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_RECFORMAT
comma
id|format
)paren
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_RECSLOTSR
comma
id|rate
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_ADCFORMAT
comma
id|format
)paren
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_ADCSLOTSR
comma
id|rate
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_for
c_loop
(paren
id|nbank
op_assign
l_int|0
suffix:semicolon
id|nbank
OL
l_int|2
suffix:semicolon
id|nbank
op_increment
)paren
(brace
id|bank
op_assign
id|chip-&gt;bank_capture
(braket
id|ypcm-&gt;capture_bank_number
)braket
(braket
id|nbank
)braket
suffix:semicolon
id|bank-&gt;base
op_assign
id|cpu_to_le32
c_func
(paren
id|runtime-&gt;dma_addr
)paren
suffix:semicolon
id|bank-&gt;loop_end
op_assign
id|cpu_to_le32
c_func
(paren
id|ypcm-&gt;buffer_size
op_lshift
id|ypcm-&gt;shift
)paren
suffix:semicolon
id|bank-&gt;start
op_assign
l_int|0
suffix:semicolon
id|bank-&gt;num_of_loops
op_assign
l_int|0
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ymfpci_playback_pointer
r_static
id|snd_pcm_uframes_t
id|snd_ymfpci_playback_pointer
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|ymfpci_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|ymfpci_pcm_t
op_star
id|ypcm
op_assign
id|snd_magic_cast
c_func
(paren
id|ymfpci_pcm_t
comma
id|runtime-&gt;private_data
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|ymfpci_voice_t
op_star
id|voice
op_assign
id|ypcm-&gt;voices
(braket
l_int|0
)braket
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|ypcm-&gt;running
op_logical_and
id|voice
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_return
id|le32_to_cpu
c_func
(paren
id|voice-&gt;bank
(braket
id|chip-&gt;active_bank
)braket
dot
id|start
)paren
suffix:semicolon
)brace
DECL|function|snd_ymfpci_capture_pointer
r_static
id|snd_pcm_uframes_t
id|snd_ymfpci_capture_pointer
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|ymfpci_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|ymfpci_pcm_t
op_star
id|ypcm
op_assign
id|snd_magic_cast
c_func
(paren
id|ymfpci_pcm_t
comma
id|runtime-&gt;private_data
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ypcm-&gt;running
)paren
r_return
l_int|0
suffix:semicolon
r_return
id|le32_to_cpu
c_func
(paren
id|chip-&gt;bank_capture
(braket
id|ypcm-&gt;capture_bank_number
)braket
(braket
id|chip-&gt;active_bank
)braket
op_member_access_from_pointer
id|start
)paren
op_rshift
id|ypcm-&gt;shift
suffix:semicolon
)brace
DECL|function|snd_ymfpci_irq_wait
r_static
r_void
id|snd_ymfpci_irq_wait
c_func
(paren
id|ymfpci_t
op_star
id|chip
)paren
(brace
id|wait_queue_t
id|wait
suffix:semicolon
r_int
id|loops
op_assign
l_int|4
suffix:semicolon
r_while
c_loop
(paren
id|loops
op_decrement
OG
l_int|0
)paren
(brace
r_if
c_cond
(paren
(paren
id|snd_ymfpci_readl
c_func
(paren
id|chip
comma
id|YDSXGR_MODE
)paren
op_amp
l_int|3
)paren
op_eq
l_int|0
)paren
r_continue
suffix:semicolon
id|init_waitqueue_entry
c_func
(paren
op_amp
id|wait
comma
id|current
)paren
suffix:semicolon
id|add_wait_queue
c_func
(paren
op_amp
id|chip-&gt;interrupt_sleep
comma
op_amp
id|wait
)paren
suffix:semicolon
id|atomic_inc
c_func
(paren
op_amp
id|chip-&gt;interrupt_sleep_count
)paren
suffix:semicolon
id|set_current_state
c_func
(paren
id|TASK_UNINTERRUPTIBLE
)paren
suffix:semicolon
id|schedule_timeout
c_func
(paren
id|HZ
op_div
l_int|20
)paren
suffix:semicolon
id|remove_wait_queue
c_func
(paren
op_amp
id|chip-&gt;interrupt_sleep
comma
op_amp
id|wait
)paren
suffix:semicolon
)brace
)brace
DECL|function|snd_ymfpci_interrupt
r_static
r_void
id|snd_ymfpci_interrupt
c_func
(paren
r_int
id|irq
comma
r_void
op_star
id|dev_id
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|ymfpci_t
op_star
id|chip
op_assign
id|snd_magic_cast
c_func
(paren
id|ymfpci_t
comma
id|dev_id
comma
r_return
)paren
suffix:semicolon
id|u32
id|status
comma
id|nvoice
comma
id|mode
suffix:semicolon
id|ymfpci_voice_t
op_star
id|voice
suffix:semicolon
id|status
op_assign
id|snd_ymfpci_readl
c_func
(paren
id|chip
comma
id|YDSXGR_STATUS
)paren
suffix:semicolon
r_if
c_cond
(paren
id|status
op_amp
l_int|0x80000000
)paren
(brace
id|chip-&gt;active_bank
op_assign
id|snd_ymfpci_readl
c_func
(paren
id|chip
comma
id|YDSXGR_CTRLSELECT
)paren
op_amp
l_int|1
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|chip-&gt;voice_lock
)paren
suffix:semicolon
r_for
c_loop
(paren
id|nvoice
op_assign
l_int|0
suffix:semicolon
id|nvoice
OL
id|YDSXG_PLAYBACK_VOICES
suffix:semicolon
id|nvoice
op_increment
)paren
(brace
id|voice
op_assign
op_amp
id|chip-&gt;voices
(braket
id|nvoice
)braket
suffix:semicolon
r_if
c_cond
(paren
id|voice-&gt;interrupt
)paren
id|voice
op_member_access_from_pointer
id|interrupt
c_func
(paren
id|chip
comma
id|voice
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|nvoice
op_assign
l_int|0
suffix:semicolon
id|nvoice
OL
id|YDSXG_CAPTURE_VOICES
suffix:semicolon
id|nvoice
op_increment
)paren
(brace
r_if
c_cond
(paren
id|chip-&gt;capture_substream
(braket
id|nvoice
)braket
)paren
id|snd_ymfpci_pcm_capture_interrupt
c_func
(paren
id|chip-&gt;capture_substream
(braket
id|nvoice
)braket
)paren
suffix:semicolon
)brace
macro_line|#if 0
r_for
c_loop
(paren
id|nvoice
op_assign
l_int|0
suffix:semicolon
id|nvoice
OL
id|YDSXG_EFFECT_VOICES
suffix:semicolon
id|nvoice
op_increment
)paren
(brace
r_if
c_cond
(paren
id|chip-&gt;effect_substream
(braket
id|nvoice
)braket
)paren
id|snd_ymfpci_pcm_effect_interrupt
c_func
(paren
id|chip-&gt;effect_substream
(braket
id|nvoice
)braket
)paren
suffix:semicolon
)brace
macro_line|#endif
id|spin_unlock
c_func
(paren
op_amp
id|chip-&gt;voice_lock
)paren
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_STATUS
comma
l_int|0x80000000
)paren
suffix:semicolon
id|mode
op_assign
id|snd_ymfpci_readl
c_func
(paren
id|chip
comma
id|YDSXGR_MODE
)paren
op_or
l_int|2
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_MODE
comma
id|mode
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|chip-&gt;interrupt_sleep_count
)paren
)paren
(brace
id|atomic_set
c_func
(paren
op_amp
id|chip-&gt;interrupt_sleep_count
comma
l_int|0
)paren
suffix:semicolon
id|wake_up
c_func
(paren
op_amp
id|chip-&gt;interrupt_sleep
)paren
suffix:semicolon
)brace
)brace
id|status
op_assign
id|snd_ymfpci_readl
c_func
(paren
id|chip
comma
id|YDSXGR_INTFLAG
)paren
suffix:semicolon
r_if
c_cond
(paren
id|status
op_amp
l_int|1
)paren
(brace
multiline_comment|/* timer handler */
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_INTFLAG
comma
op_complement
l_int|0
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|chip-&gt;rawmidi
)paren
id|snd_mpu401_uart_interrupt
c_func
(paren
id|irq
comma
id|chip-&gt;rawmidi-&gt;private_data
comma
id|regs
)paren
suffix:semicolon
)brace
DECL|variable|snd_ymfpci_playback
r_static
id|snd_pcm_hardware_t
id|snd_ymfpci_playback
op_assign
(brace
id|info
suffix:colon
(paren
id|SNDRV_PCM_INFO_MMAP
op_or
id|SNDRV_PCM_INFO_MMAP_VALID
op_or
id|SNDRV_PCM_INFO_INTERLEAVED
op_or
id|SNDRV_PCM_INFO_BLOCK_TRANSFER
op_or
id|SNDRV_PCM_INFO_PAUSE
op_or
id|SNDRV_PCM_INFO_RESUME
)paren
comma
id|formats
suffix:colon
id|SNDRV_PCM_FMTBIT_U8
op_or
id|SNDRV_PCM_FMTBIT_S16_LE
comma
id|rates
suffix:colon
id|SNDRV_PCM_RATE_CONTINUOUS
op_or
id|SNDRV_PCM_RATE_8000_48000
comma
id|rate_min
suffix:colon
l_int|8000
comma
id|rate_max
suffix:colon
l_int|48000
comma
id|channels_min
suffix:colon
l_int|1
comma
id|channels_max
suffix:colon
l_int|2
comma
id|buffer_bytes_max
suffix:colon
l_int|256
op_star
l_int|1024
comma
multiline_comment|/* FIXME: enough? */
id|period_bytes_min
suffix:colon
l_int|64
comma
id|period_bytes_max
suffix:colon
l_int|256
op_star
l_int|1024
comma
multiline_comment|/* FIXME: enough? */
id|periods_min
suffix:colon
l_int|3
comma
id|periods_max
suffix:colon
l_int|1024
comma
id|fifo_size
suffix:colon
l_int|0
comma
)brace
suffix:semicolon
DECL|variable|snd_ymfpci_capture
r_static
id|snd_pcm_hardware_t
id|snd_ymfpci_capture
op_assign
(brace
id|info
suffix:colon
(paren
id|SNDRV_PCM_INFO_MMAP
op_or
id|SNDRV_PCM_INFO_MMAP_VALID
op_or
id|SNDRV_PCM_INFO_INTERLEAVED
op_or
id|SNDRV_PCM_INFO_BLOCK_TRANSFER
op_or
id|SNDRV_PCM_INFO_PAUSE
op_or
id|SNDRV_PCM_INFO_RESUME
)paren
comma
id|formats
suffix:colon
id|SNDRV_PCM_FMTBIT_U8
op_or
id|SNDRV_PCM_FMTBIT_S16_LE
comma
id|rates
suffix:colon
id|SNDRV_PCM_RATE_CONTINUOUS
op_or
id|SNDRV_PCM_RATE_8000_48000
comma
id|rate_min
suffix:colon
l_int|8000
comma
id|rate_max
suffix:colon
l_int|48000
comma
id|channels_min
suffix:colon
l_int|1
comma
id|channels_max
suffix:colon
l_int|2
comma
id|buffer_bytes_max
suffix:colon
l_int|256
op_star
l_int|1024
comma
multiline_comment|/* FIXME: enough? */
id|period_bytes_min
suffix:colon
l_int|64
comma
id|period_bytes_max
suffix:colon
l_int|256
op_star
l_int|1024
comma
multiline_comment|/* FIXME: enough? */
id|periods_min
suffix:colon
l_int|3
comma
id|periods_max
suffix:colon
l_int|1024
comma
id|fifo_size
suffix:colon
l_int|0
comma
)brace
suffix:semicolon
DECL|function|snd_ymfpci_pcm_free_substream
r_static
r_void
id|snd_ymfpci_pcm_free_substream
c_func
(paren
id|snd_pcm_runtime_t
op_star
id|runtime
)paren
(brace
id|ymfpci_pcm_t
op_star
id|ypcm
op_assign
id|snd_magic_cast
c_func
(paren
id|ymfpci_pcm_t
comma
id|runtime-&gt;private_data
comma
r_return
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ypcm
)paren
id|snd_magic_kfree
c_func
(paren
id|ypcm
)paren
suffix:semicolon
)brace
DECL|function|snd_ymfpci_playback_open
r_static
r_int
id|snd_ymfpci_playback_open
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|ymfpci_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|ymfpci_pcm_t
op_star
id|ypcm
suffix:semicolon
id|ypcm
op_assign
id|snd_magic_kcalloc
c_func
(paren
id|ymfpci_pcm_t
comma
l_int|0
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ypcm
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|ypcm-&gt;chip
op_assign
id|chip
suffix:semicolon
id|ypcm-&gt;type
op_assign
id|PLAYBACK_VOICE
suffix:semicolon
id|ypcm-&gt;substream
op_assign
id|substream
suffix:semicolon
id|runtime-&gt;hw
op_assign
id|snd_ymfpci_playback
suffix:semicolon
id|runtime-&gt;private_data
op_assign
id|ypcm
suffix:semicolon
id|runtime-&gt;private_free
op_assign
id|snd_ymfpci_pcm_free_substream
suffix:semicolon
multiline_comment|/* FIXME? True value is 256/48 = 5.33333 ms */
id|snd_pcm_hw_constraint_minmax
c_func
(paren
id|runtime
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_TIME
comma
l_int|5333
comma
id|UINT_MAX
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ymfpci_playback_spdif_open
r_static
r_int
id|snd_ymfpci_playback_spdif_open
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|ymfpci_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|ymfpci_pcm_t
op_star
id|ypcm
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ymfpci_playback_open
c_func
(paren
id|substream
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|ypcm
op_assign
id|snd_magic_cast
c_func
(paren
id|ymfpci_pcm_t
comma
id|runtime-&gt;private_data
comma
r_return
l_int|0
)paren
suffix:semicolon
id|ypcm-&gt;spdif
op_assign
l_int|1
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
id|snd_ymfpci_writew
c_func
(paren
id|chip
comma
id|YDSXGR_SPDIFOUTCTRL
comma
id|snd_ymfpci_readw
c_func
(paren
id|chip
comma
id|YDSXGR_SPDIFOUTCTRL
)paren
op_or
l_int|2
)paren
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_MODE
comma
id|snd_ymfpci_readl
c_func
(paren
id|chip
comma
id|YDSXGR_MODE
)paren
op_or
(paren
l_int|1
op_lshift
l_int|30
)paren
)paren
suffix:semicolon
id|chip-&gt;spdif_pcm_bits
op_assign
id|chip-&gt;spdif_bits
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_SPDIFOUTSTATUS
comma
id|chip-&gt;spdif_pcm_bits
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
id|chip-&gt;spdif_pcm_ctl-&gt;access
op_and_assign
op_complement
id|SNDRV_CTL_ELEM_ACCESS_INACTIVE
suffix:semicolon
id|snd_ctl_notify
c_func
(paren
id|chip-&gt;card
comma
id|SNDRV_CTL_EVENT_MASK_VALUE
op_or
id|SNDRV_CTL_EVENT_MASK_INFO
comma
op_amp
id|chip-&gt;spdif_pcm_ctl-&gt;id
)paren
suffix:semicolon
multiline_comment|/* FIXME? True value is 256/48 = 5.33333 ms */
id|snd_pcm_hw_constraint_minmax
c_func
(paren
id|runtime
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_TIME
comma
l_int|5333
comma
id|UINT_MAX
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ymfpci_playback_4ch_open
r_static
r_int
id|snd_ymfpci_playback_4ch_open
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|ymfpci_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|ymfpci_pcm_t
op_star
id|ypcm
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ymfpci_playback_open
c_func
(paren
id|substream
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|ypcm
op_assign
id|snd_magic_cast
c_func
(paren
id|ymfpci_pcm_t
comma
id|runtime-&gt;private_data
comma
r_return
l_int|0
)paren
suffix:semicolon
id|ypcm-&gt;mode4ch
op_assign
l_int|1
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
id|snd_ymfpci_writew
c_func
(paren
id|chip
comma
id|YDSXGR_SECCONFIG
comma
(paren
id|snd_ymfpci_readw
c_func
(paren
id|chip
comma
id|YDSXGR_SECCONFIG
)paren
op_amp
op_complement
l_int|0x0030
)paren
op_or
l_int|0x0010
)paren
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_MODE
comma
id|snd_ymfpci_readl
c_func
(paren
id|chip
comma
id|YDSXGR_MODE
)paren
op_or
(paren
l_int|1
op_lshift
l_int|30
)paren
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
multiline_comment|/* FIXME? True value is 256/48 = 5.33333 ms */
id|snd_pcm_hw_constraint_minmax
c_func
(paren
id|runtime
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_TIME
comma
l_int|5333
comma
id|UINT_MAX
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ymfpci_capture_open
r_static
r_int
id|snd_ymfpci_capture_open
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|u32
id|capture_bank_number
)paren
(brace
id|ymfpci_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|ymfpci_pcm_t
op_star
id|ypcm
suffix:semicolon
id|ypcm
op_assign
id|snd_magic_kcalloc
c_func
(paren
id|ymfpci_pcm_t
comma
l_int|0
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ypcm
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|ypcm-&gt;chip
op_assign
id|chip
suffix:semicolon
id|ypcm-&gt;type
op_assign
id|capture_bank_number
op_plus
id|CAPTURE_REC
suffix:semicolon
id|ypcm-&gt;substream
op_assign
id|substream
suffix:semicolon
id|ypcm-&gt;capture_bank_number
op_assign
id|capture_bank_number
suffix:semicolon
id|chip-&gt;capture_substream
(braket
id|capture_bank_number
)braket
op_assign
id|substream
suffix:semicolon
id|runtime-&gt;hw
op_assign
id|snd_ymfpci_capture
suffix:semicolon
multiline_comment|/* FIXME? True value is 256/48 = 5.33333 ms */
id|snd_pcm_hw_constraint_minmax
c_func
(paren
id|runtime
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_TIME
comma
l_int|5333
comma
id|UINT_MAX
)paren
suffix:semicolon
id|runtime-&gt;private_data
op_assign
id|ypcm
suffix:semicolon
id|runtime-&gt;private_free
op_assign
id|snd_ymfpci_pcm_free_substream
suffix:semicolon
id|snd_ymfpci_hw_start
c_func
(paren
id|chip
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ymfpci_capture_rec_open
r_static
r_int
id|snd_ymfpci_capture_rec_open
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
r_return
id|snd_ymfpci_capture_open
c_func
(paren
id|substream
comma
l_int|0
)paren
suffix:semicolon
)brace
DECL|function|snd_ymfpci_capture_ac97_open
r_static
r_int
id|snd_ymfpci_capture_ac97_open
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
r_return
id|snd_ymfpci_capture_open
c_func
(paren
id|substream
comma
l_int|1
)paren
suffix:semicolon
)brace
DECL|function|snd_ymfpci_playback_close
r_static
r_int
id|snd_ymfpci_playback_close
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ymfpci_playback_spdif_close
r_static
r_int
id|snd_ymfpci_playback_spdif_close
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|ymfpci_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_MODE
comma
id|snd_ymfpci_readl
c_func
(paren
id|chip
comma
id|YDSXGR_MODE
)paren
op_amp
op_complement
(paren
l_int|1
op_lshift
l_int|30
)paren
)paren
suffix:semicolon
id|snd_ymfpci_writew
c_func
(paren
id|chip
comma
id|YDSXGR_SPDIFOUTCTRL
comma
id|snd_ymfpci_readw
c_func
(paren
id|chip
comma
id|YDSXGR_SPDIFOUTCTRL
)paren
op_amp
op_complement
l_int|2
)paren
suffix:semicolon
id|snd_ymfpci_writew
c_func
(paren
id|chip
comma
id|YDSXGR_SPDIFOUTSTATUS
comma
id|chip-&gt;spdif_bits
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
id|chip-&gt;spdif_pcm_ctl-&gt;access
op_or_assign
id|SNDRV_CTL_ELEM_ACCESS_INACTIVE
suffix:semicolon
id|snd_ctl_notify
c_func
(paren
id|chip-&gt;card
comma
id|SNDRV_CTL_EVENT_MASK_VALUE
op_or
id|SNDRV_CTL_EVENT_MASK_INFO
comma
op_amp
id|chip-&gt;spdif_pcm_ctl-&gt;id
)paren
suffix:semicolon
r_return
id|snd_ymfpci_playback_close
c_func
(paren
id|substream
)paren
suffix:semicolon
)brace
DECL|function|snd_ymfpci_playback_4ch_close
r_static
r_int
id|snd_ymfpci_playback_4ch_close
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|ymfpci_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_MODE
comma
id|snd_ymfpci_readl
c_func
(paren
id|chip
comma
id|YDSXGR_MODE
)paren
op_amp
op_complement
(paren
l_int|1
op_lshift
l_int|30
)paren
)paren
suffix:semicolon
id|snd_ymfpci_writew
c_func
(paren
id|chip
comma
id|YDSXGR_SECCONFIG
comma
(paren
id|snd_ymfpci_readw
c_func
(paren
id|chip
comma
id|YDSXGR_SECCONFIG
)paren
op_amp
op_complement
l_int|0x0330
)paren
op_or
l_int|0x0010
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
r_return
id|snd_ymfpci_playback_close
c_func
(paren
id|substream
)paren
suffix:semicolon
)brace
DECL|function|snd_ymfpci_capture_close
r_static
r_int
id|snd_ymfpci_capture_close
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|ymfpci_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|ymfpci_pcm_t
op_star
id|ypcm
op_assign
id|snd_magic_cast
c_func
(paren
id|ymfpci_pcm_t
comma
id|runtime-&gt;private_data
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ypcm
op_ne
l_int|NULL
)paren
(brace
id|chip-&gt;capture_substream
(braket
id|ypcm-&gt;capture_bank_number
)braket
op_assign
l_int|NULL
suffix:semicolon
id|snd_ymfpci_hw_stop
c_func
(paren
id|chip
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|snd_ymfpci_playback_ops
r_static
id|snd_pcm_ops_t
id|snd_ymfpci_playback_ops
op_assign
(brace
id|open
suffix:colon
id|snd_ymfpci_playback_open
comma
id|close
suffix:colon
id|snd_ymfpci_playback_close
comma
id|ioctl
suffix:colon
id|snd_pcm_lib_ioctl
comma
id|hw_params
suffix:colon
id|snd_ymfpci_playback_hw_params
comma
id|hw_free
suffix:colon
id|snd_ymfpci_playback_hw_free
comma
id|prepare
suffix:colon
id|snd_ymfpci_playback_prepare
comma
id|trigger
suffix:colon
id|snd_ymfpci_playback_trigger
comma
id|pointer
suffix:colon
id|snd_ymfpci_playback_pointer
comma
)brace
suffix:semicolon
DECL|variable|snd_ymfpci_capture_rec_ops
r_static
id|snd_pcm_ops_t
id|snd_ymfpci_capture_rec_ops
op_assign
(brace
id|open
suffix:colon
id|snd_ymfpci_capture_rec_open
comma
id|close
suffix:colon
id|snd_ymfpci_capture_close
comma
id|ioctl
suffix:colon
id|snd_pcm_lib_ioctl
comma
id|hw_params
suffix:colon
id|snd_ymfpci_capture_hw_params
comma
id|hw_free
suffix:colon
id|snd_ymfpci_capture_hw_free
comma
id|prepare
suffix:colon
id|snd_ymfpci_capture_prepare
comma
id|trigger
suffix:colon
id|snd_ymfpci_capture_trigger
comma
id|pointer
suffix:colon
id|snd_ymfpci_capture_pointer
comma
)brace
suffix:semicolon
DECL|function|snd_ymfpci_pcm_free
r_static
r_void
id|snd_ymfpci_pcm_free
c_func
(paren
id|snd_pcm_t
op_star
id|pcm
)paren
(brace
id|ymfpci_t
op_star
id|chip
op_assign
id|snd_magic_cast
c_func
(paren
id|ymfpci_t
comma
id|pcm-&gt;private_data
comma
r_return
)paren
suffix:semicolon
id|chip-&gt;pcm
op_assign
l_int|NULL
suffix:semicolon
id|snd_pcm_lib_preallocate_free_for_all
c_func
(paren
id|pcm
)paren
suffix:semicolon
)brace
DECL|function|snd_ymfpci_pcm
r_int
id|__devinit
id|snd_ymfpci_pcm
c_func
(paren
id|ymfpci_t
op_star
id|chip
comma
r_int
id|device
comma
id|snd_pcm_t
op_star
op_star
id|rpcm
)paren
(brace
id|snd_pcm_t
op_star
id|pcm
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
id|rpcm
)paren
op_star
id|rpcm
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_pcm_new
c_func
(paren
id|chip-&gt;card
comma
l_string|&quot;YMFPCI&quot;
comma
id|device
comma
l_int|32
comma
l_int|1
comma
op_amp
id|pcm
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|pcm-&gt;private_data
op_assign
id|chip
suffix:semicolon
id|pcm-&gt;private_free
op_assign
id|snd_ymfpci_pcm_free
suffix:semicolon
id|snd_pcm_set_ops
c_func
(paren
id|pcm
comma
id|SNDRV_PCM_STREAM_PLAYBACK
comma
op_amp
id|snd_ymfpci_playback_ops
)paren
suffix:semicolon
id|snd_pcm_set_ops
c_func
(paren
id|pcm
comma
id|SNDRV_PCM_STREAM_CAPTURE
comma
op_amp
id|snd_ymfpci_capture_rec_ops
)paren
suffix:semicolon
multiline_comment|/* global setup */
id|pcm-&gt;info_flags
op_assign
l_int|0
suffix:semicolon
id|strcpy
c_func
(paren
id|pcm-&gt;name
comma
l_string|&quot;YMFPCI&quot;
)paren
suffix:semicolon
id|chip-&gt;pcm
op_assign
id|pcm
suffix:semicolon
id|snd_pcm_lib_preallocate_pci_pages_for_all
c_func
(paren
id|chip-&gt;pci
comma
id|pcm
comma
l_int|64
op_star
l_int|1024
comma
l_int|256
op_star
l_int|1024
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rpcm
)paren
op_star
id|rpcm
op_assign
id|pcm
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|snd_ymfpci_capture_ac97_ops
r_static
id|snd_pcm_ops_t
id|snd_ymfpci_capture_ac97_ops
op_assign
(brace
id|open
suffix:colon
id|snd_ymfpci_capture_ac97_open
comma
id|close
suffix:colon
id|snd_ymfpci_capture_close
comma
id|ioctl
suffix:colon
id|snd_pcm_lib_ioctl
comma
id|hw_params
suffix:colon
id|snd_ymfpci_capture_hw_params
comma
id|hw_free
suffix:colon
id|snd_ymfpci_capture_hw_free
comma
id|prepare
suffix:colon
id|snd_ymfpci_capture_prepare
comma
id|trigger
suffix:colon
id|snd_ymfpci_capture_trigger
comma
id|pointer
suffix:colon
id|snd_ymfpci_capture_pointer
comma
)brace
suffix:semicolon
DECL|function|snd_ymfpci_pcm2_free
r_static
r_void
id|snd_ymfpci_pcm2_free
c_func
(paren
id|snd_pcm_t
op_star
id|pcm
)paren
(brace
id|ymfpci_t
op_star
id|chip
op_assign
id|snd_magic_cast
c_func
(paren
id|ymfpci_t
comma
id|pcm-&gt;private_data
comma
r_return
)paren
suffix:semicolon
id|chip-&gt;pcm2
op_assign
l_int|NULL
suffix:semicolon
id|snd_pcm_lib_preallocate_free_for_all
c_func
(paren
id|pcm
)paren
suffix:semicolon
)brace
DECL|function|snd_ymfpci_pcm2
r_int
id|__devinit
id|snd_ymfpci_pcm2
c_func
(paren
id|ymfpci_t
op_star
id|chip
comma
r_int
id|device
comma
id|snd_pcm_t
op_star
op_star
id|rpcm
)paren
(brace
id|snd_pcm_t
op_star
id|pcm
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
id|rpcm
)paren
op_star
id|rpcm
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_pcm_new
c_func
(paren
id|chip-&gt;card
comma
l_string|&quot;YMFPCI - AC&squot;97&quot;
comma
id|device
comma
l_int|0
comma
l_int|1
comma
op_amp
id|pcm
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|pcm-&gt;private_data
op_assign
id|chip
suffix:semicolon
id|pcm-&gt;private_free
op_assign
id|snd_ymfpci_pcm2_free
suffix:semicolon
id|snd_pcm_set_ops
c_func
(paren
id|pcm
comma
id|SNDRV_PCM_STREAM_CAPTURE
comma
op_amp
id|snd_ymfpci_capture_ac97_ops
)paren
suffix:semicolon
multiline_comment|/* global setup */
id|pcm-&gt;info_flags
op_assign
l_int|0
suffix:semicolon
id|strcpy
c_func
(paren
id|pcm-&gt;name
comma
l_string|&quot;YMFPCI - AC&squot;97&quot;
)paren
suffix:semicolon
id|chip-&gt;pcm2
op_assign
id|pcm
suffix:semicolon
id|snd_pcm_lib_preallocate_pci_pages_for_all
c_func
(paren
id|chip-&gt;pci
comma
id|pcm
comma
l_int|64
op_star
l_int|1024
comma
l_int|256
op_star
l_int|1024
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rpcm
)paren
op_star
id|rpcm
op_assign
id|pcm
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|snd_ymfpci_playback_spdif_ops
r_static
id|snd_pcm_ops_t
id|snd_ymfpci_playback_spdif_ops
op_assign
(brace
id|open
suffix:colon
id|snd_ymfpci_playback_spdif_open
comma
id|close
suffix:colon
id|snd_ymfpci_playback_spdif_close
comma
id|ioctl
suffix:colon
id|snd_pcm_lib_ioctl
comma
id|hw_params
suffix:colon
id|snd_ymfpci_playback_hw_params
comma
id|hw_free
suffix:colon
id|snd_ymfpci_playback_hw_free
comma
id|prepare
suffix:colon
id|snd_ymfpci_playback_prepare
comma
id|trigger
suffix:colon
id|snd_ymfpci_playback_trigger
comma
id|pointer
suffix:colon
id|snd_ymfpci_playback_pointer
comma
)brace
suffix:semicolon
DECL|function|snd_ymfpci_pcm_spdif_free
r_static
r_void
id|snd_ymfpci_pcm_spdif_free
c_func
(paren
id|snd_pcm_t
op_star
id|pcm
)paren
(brace
id|ymfpci_t
op_star
id|chip
op_assign
id|snd_magic_cast
c_func
(paren
id|ymfpci_t
comma
id|pcm-&gt;private_data
comma
r_return
)paren
suffix:semicolon
id|chip-&gt;pcm_spdif
op_assign
l_int|NULL
suffix:semicolon
)brace
DECL|function|snd_ymfpci_pcm_spdif
r_int
id|__devinit
id|snd_ymfpci_pcm_spdif
c_func
(paren
id|ymfpci_t
op_star
id|chip
comma
r_int
id|device
comma
id|snd_pcm_t
op_star
op_star
id|rpcm
)paren
(brace
id|snd_pcm_t
op_star
id|pcm
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
id|rpcm
)paren
op_star
id|rpcm
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_pcm_new
c_func
(paren
id|chip-&gt;card
comma
l_string|&quot;YMFPCI - IEC958&quot;
comma
id|device
comma
l_int|1
comma
l_int|0
comma
op_amp
id|pcm
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|pcm-&gt;private_data
op_assign
id|chip
suffix:semicolon
id|pcm-&gt;private_free
op_assign
id|snd_ymfpci_pcm_spdif_free
suffix:semicolon
id|snd_pcm_set_ops
c_func
(paren
id|pcm
comma
id|SNDRV_PCM_STREAM_PLAYBACK
comma
op_amp
id|snd_ymfpci_playback_spdif_ops
)paren
suffix:semicolon
multiline_comment|/* global setup */
id|pcm-&gt;info_flags
op_assign
l_int|0
suffix:semicolon
id|strcpy
c_func
(paren
id|pcm-&gt;name
comma
l_string|&quot;YMFPCI - IEC958&quot;
)paren
suffix:semicolon
id|chip-&gt;pcm_spdif
op_assign
id|pcm
suffix:semicolon
r_if
c_cond
(paren
id|rpcm
)paren
op_star
id|rpcm
op_assign
id|pcm
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|snd_ymfpci_playback_4ch_ops
r_static
id|snd_pcm_ops_t
id|snd_ymfpci_playback_4ch_ops
op_assign
(brace
id|open
suffix:colon
id|snd_ymfpci_playback_4ch_open
comma
id|close
suffix:colon
id|snd_ymfpci_playback_4ch_close
comma
id|ioctl
suffix:colon
id|snd_pcm_lib_ioctl
comma
id|hw_params
suffix:colon
id|snd_ymfpci_playback_hw_params
comma
id|hw_free
suffix:colon
id|snd_ymfpci_playback_hw_free
comma
id|prepare
suffix:colon
id|snd_ymfpci_playback_prepare
comma
id|trigger
suffix:colon
id|snd_ymfpci_playback_trigger
comma
id|pointer
suffix:colon
id|snd_ymfpci_playback_pointer
comma
)brace
suffix:semicolon
DECL|function|snd_ymfpci_pcm_4ch_free
r_static
r_void
id|snd_ymfpci_pcm_4ch_free
c_func
(paren
id|snd_pcm_t
op_star
id|pcm
)paren
(brace
id|ymfpci_t
op_star
id|chip
op_assign
id|snd_magic_cast
c_func
(paren
id|ymfpci_t
comma
id|pcm-&gt;private_data
comma
r_return
)paren
suffix:semicolon
id|chip-&gt;pcm_4ch
op_assign
l_int|NULL
suffix:semicolon
)brace
DECL|function|snd_ymfpci_pcm_4ch
r_int
id|__devinit
id|snd_ymfpci_pcm_4ch
c_func
(paren
id|ymfpci_t
op_star
id|chip
comma
r_int
id|device
comma
id|snd_pcm_t
op_star
op_star
id|rpcm
)paren
(brace
id|snd_pcm_t
op_star
id|pcm
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
id|rpcm
)paren
op_star
id|rpcm
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_pcm_new
c_func
(paren
id|chip-&gt;card
comma
l_string|&quot;YMFPCI - Rear&quot;
comma
id|device
comma
l_int|1
comma
l_int|0
comma
op_amp
id|pcm
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|pcm-&gt;private_data
op_assign
id|chip
suffix:semicolon
id|pcm-&gt;private_free
op_assign
id|snd_ymfpci_pcm_4ch_free
suffix:semicolon
id|snd_pcm_set_ops
c_func
(paren
id|pcm
comma
id|SNDRV_PCM_STREAM_PLAYBACK
comma
op_amp
id|snd_ymfpci_playback_4ch_ops
)paren
suffix:semicolon
multiline_comment|/* global setup */
id|pcm-&gt;info_flags
op_assign
l_int|0
suffix:semicolon
id|strcpy
c_func
(paren
id|pcm-&gt;name
comma
l_string|&quot;YMFPCI - Rear PCM&quot;
)paren
suffix:semicolon
id|chip-&gt;pcm_4ch
op_assign
id|pcm
suffix:semicolon
r_if
c_cond
(paren
id|rpcm
)paren
op_star
id|rpcm
op_assign
id|pcm
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ymfpci_spdif_default_info
r_static
r_int
id|snd_ymfpci_spdif_default_info
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_IEC958
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ymfpci_spdif_default_get
r_static
r_int
id|snd_ymfpci_spdif_default_get
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|ymfpci_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
id|ucontrol-&gt;value.iec958.status
(braket
l_int|0
)braket
op_assign
(paren
id|chip-&gt;spdif_bits
op_rshift
l_int|0
)paren
op_amp
l_int|0xff
suffix:semicolon
id|ucontrol-&gt;value.iec958.status
(braket
l_int|1
)braket
op_assign
(paren
id|chip-&gt;spdif_bits
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ymfpci_spdif_default_put
r_static
r_int
id|snd_ymfpci_spdif_default_put
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|ymfpci_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
r_int
id|val
suffix:semicolon
r_int
id|change
suffix:semicolon
id|val
op_assign
(paren
(paren
id|ucontrol-&gt;value.iec958.status
(braket
l_int|0
)braket
op_amp
l_int|0x3e
)paren
op_lshift
l_int|0
)paren
op_or
(paren
id|ucontrol-&gt;value.iec958.status
(braket
l_int|1
)braket
op_lshift
l_int|8
)paren
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
id|change
op_assign
id|chip-&gt;spdif_bits
op_ne
id|val
suffix:semicolon
id|chip-&gt;spdif_bits
op_assign
id|val
suffix:semicolon
r_if
c_cond
(paren
(paren
id|snd_ymfpci_readw
c_func
(paren
id|chip
comma
id|YDSXGR_SPDIFOUTCTRL
)paren
op_amp
l_int|1
)paren
op_logical_and
id|chip-&gt;pcm_spdif
op_eq
l_int|NULL
)paren
id|snd_ymfpci_writew
c_func
(paren
id|chip
comma
id|YDSXGR_SPDIFOUTSTATUS
comma
id|chip-&gt;spdif_bits
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
r_return
id|change
suffix:semicolon
)brace
DECL|variable|__devinitdata
r_static
id|snd_kcontrol_new_t
id|snd_ymfpci_spdif_default
id|__devinitdata
op_assign
(brace
id|iface
suffix:colon
id|SNDRV_CTL_ELEM_IFACE_PCM
comma
id|name
suffix:colon
id|SNDRV_CTL_NAME_IEC958
c_func
(paren
l_string|&quot;&quot;
comma
id|PLAYBACK
comma
id|DEFAULT
)paren
comma
id|info
suffix:colon
id|snd_ymfpci_spdif_default_info
comma
id|get
suffix:colon
id|snd_ymfpci_spdif_default_get
comma
id|put
suffix:colon
id|snd_ymfpci_spdif_default_put
)brace
suffix:semicolon
DECL|function|snd_ymfpci_spdif_mask_info
r_static
r_int
id|snd_ymfpci_spdif_mask_info
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_IEC958
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ymfpci_spdif_mask_get
r_static
r_int
id|snd_ymfpci_spdif_mask_get
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|ymfpci_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
id|ucontrol-&gt;value.iec958.status
(braket
l_int|0
)braket
op_assign
l_int|0x3e
suffix:semicolon
id|ucontrol-&gt;value.iec958.status
(braket
l_int|1
)braket
op_assign
l_int|0xff
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|__devinitdata
r_static
id|snd_kcontrol_new_t
id|snd_ymfpci_spdif_mask
id|__devinitdata
op_assign
(brace
id|access
suffix:colon
id|SNDRV_CTL_ELEM_ACCESS_READ
comma
id|iface
suffix:colon
id|SNDRV_CTL_ELEM_IFACE_PCM
comma
id|name
suffix:colon
id|SNDRV_CTL_NAME_IEC958
c_func
(paren
l_string|&quot;&quot;
comma
id|PLAYBACK
comma
id|CON_MASK
)paren
comma
id|info
suffix:colon
id|snd_ymfpci_spdif_mask_info
comma
id|get
suffix:colon
id|snd_ymfpci_spdif_mask_get
comma
)brace
suffix:semicolon
DECL|function|snd_ymfpci_spdif_stream_info
r_static
r_int
id|snd_ymfpci_spdif_stream_info
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_IEC958
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ymfpci_spdif_stream_get
r_static
r_int
id|snd_ymfpci_spdif_stream_get
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|ymfpci_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
id|ucontrol-&gt;value.iec958.status
(braket
l_int|0
)braket
op_assign
(paren
id|chip-&gt;spdif_pcm_bits
op_rshift
l_int|0
)paren
op_amp
l_int|0xff
suffix:semicolon
id|ucontrol-&gt;value.iec958.status
(braket
l_int|1
)braket
op_assign
(paren
id|chip-&gt;spdif_pcm_bits
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ymfpci_spdif_stream_put
r_static
r_int
id|snd_ymfpci_spdif_stream_put
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|ymfpci_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
r_int
id|val
suffix:semicolon
r_int
id|change
suffix:semicolon
id|val
op_assign
(paren
(paren
id|ucontrol-&gt;value.iec958.status
(braket
l_int|0
)braket
op_amp
l_int|0x3e
)paren
op_lshift
l_int|0
)paren
op_or
(paren
id|ucontrol-&gt;value.iec958.status
(braket
l_int|1
)braket
op_lshift
l_int|8
)paren
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
id|change
op_assign
id|chip-&gt;spdif_pcm_bits
op_ne
id|val
suffix:semicolon
id|chip-&gt;spdif_pcm_bits
op_assign
id|val
suffix:semicolon
r_if
c_cond
(paren
(paren
id|snd_ymfpci_readw
c_func
(paren
id|chip
comma
id|YDSXGR_SPDIFOUTCTRL
)paren
op_amp
l_int|2
)paren
)paren
id|snd_ymfpci_writew
c_func
(paren
id|chip
comma
id|YDSXGR_SPDIFOUTSTATUS
comma
id|chip-&gt;spdif_pcm_bits
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
r_return
id|change
suffix:semicolon
)brace
DECL|variable|__devinitdata
r_static
id|snd_kcontrol_new_t
id|snd_ymfpci_spdif_stream
id|__devinitdata
op_assign
(brace
id|access
suffix:colon
id|SNDRV_CTL_ELEM_ACCESS_READWRITE
op_or
id|SNDRV_CTL_ELEM_ACCESS_INACTIVE
comma
id|iface
suffix:colon
id|SNDRV_CTL_ELEM_IFACE_PCM
comma
id|name
suffix:colon
id|SNDRV_CTL_NAME_IEC958
c_func
(paren
l_string|&quot;&quot;
comma
id|PLAYBACK
comma
id|PCM_STREAM
)paren
comma
id|info
suffix:colon
id|snd_ymfpci_spdif_stream_info
comma
id|get
suffix:colon
id|snd_ymfpci_spdif_stream_get
comma
id|put
suffix:colon
id|snd_ymfpci_spdif_stream_put
)brace
suffix:semicolon
multiline_comment|/*&n; *  Mixer controls&n; */
DECL|macro|YMFPCI_SINGLE
mdefine_line|#define YMFPCI_SINGLE(xname, xindex, reg) &bslash;&n;{ iface: SNDRV_CTL_ELEM_IFACE_MIXER, name: xname, index: xindex, &bslash;&n;  info: snd_ymfpci_info_single, &bslash;&n;  get: snd_ymfpci_get_single, put: snd_ymfpci_put_single, &bslash;&n;  private_value: reg }
DECL|function|snd_ymfpci_info_single
r_static
r_int
id|snd_ymfpci_info_single
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
r_int
r_int
id|mask
op_assign
l_int|1
suffix:semicolon
r_switch
c_cond
(paren
id|kcontrol-&gt;private_value
)paren
(brace
r_case
id|YDSXGR_SPDIFOUTCTRL
suffix:colon
r_break
suffix:semicolon
r_case
id|YDSXGR_SPDIFINCTRL
suffix:colon
r_break
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|uinfo-&gt;type
op_assign
id|mask
op_eq
l_int|1
ques
c_cond
id|SNDRV_CTL_ELEM_TYPE_BOOLEAN
suffix:colon
id|SNDRV_CTL_ELEM_TYPE_INTEGER
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
id|uinfo-&gt;value.integer.min
op_assign
l_int|0
suffix:semicolon
id|uinfo-&gt;value.integer.max
op_assign
id|mask
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ymfpci_get_single
r_static
r_int
id|snd_ymfpci_get_single
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|ymfpci_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|reg
op_assign
id|kcontrol-&gt;private_value
suffix:semicolon
r_int
r_int
id|shift
op_assign
l_int|0
comma
id|mask
op_assign
l_int|1
comma
id|invert
op_assign
l_int|0
suffix:semicolon
r_switch
c_cond
(paren
id|kcontrol-&gt;private_value
)paren
(brace
r_case
id|YDSXGR_SPDIFOUTCTRL
suffix:colon
r_break
suffix:semicolon
r_case
id|YDSXGR_SPDIFINCTRL
suffix:colon
r_break
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
(paren
id|snd_ymfpci_readl
c_func
(paren
id|chip
comma
id|reg
)paren
op_rshift
id|shift
)paren
op_amp
id|mask
suffix:semicolon
r_if
c_cond
(paren
id|invert
)paren
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
id|mask
op_minus
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ymfpci_put_single
r_static
r_int
id|snd_ymfpci_put_single
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|ymfpci_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
id|reg
op_assign
id|kcontrol-&gt;private_value
suffix:semicolon
r_int
r_int
id|shift
op_assign
l_int|0
comma
id|mask
op_assign
l_int|1
comma
id|invert
op_assign
l_int|0
suffix:semicolon
r_int
id|change
suffix:semicolon
r_int
r_int
id|val
comma
id|oval
suffix:semicolon
r_switch
c_cond
(paren
id|kcontrol-&gt;private_value
)paren
(brace
r_case
id|YDSXGR_SPDIFOUTCTRL
suffix:colon
r_break
suffix:semicolon
r_case
id|YDSXGR_SPDIFINCTRL
suffix:colon
r_break
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|val
op_assign
(paren
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_amp
id|mask
)paren
suffix:semicolon
r_if
c_cond
(paren
id|invert
)paren
id|val
op_assign
id|mask
op_minus
id|val
suffix:semicolon
id|val
op_lshift_assign
id|shift
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
id|oval
op_assign
id|snd_ymfpci_readl
c_func
(paren
id|chip
comma
id|reg
)paren
suffix:semicolon
id|val
op_assign
(paren
id|oval
op_amp
op_complement
(paren
id|mask
op_lshift
id|shift
)paren
)paren
op_or
id|val
suffix:semicolon
id|change
op_assign
id|val
op_ne
id|oval
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|reg
comma
id|val
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
r_return
id|change
suffix:semicolon
)brace
DECL|macro|YMFPCI_DOUBLE
mdefine_line|#define YMFPCI_DOUBLE(xname, xindex, reg) &bslash;&n;{ iface: SNDRV_CTL_ELEM_IFACE_MIXER, name: xname, index: xindex, &bslash;&n;  info: snd_ymfpci_info_double, &bslash;&n;  get: snd_ymfpci_get_double, put: snd_ymfpci_put_double, &bslash;&n;  private_value: reg }
DECL|function|snd_ymfpci_info_double
r_static
r_int
id|snd_ymfpci_info_double
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
r_int
r_int
id|reg
op_assign
id|kcontrol-&gt;private_value
suffix:semicolon
r_int
r_int
id|mask
op_assign
l_int|16383
suffix:semicolon
r_if
c_cond
(paren
id|reg
OL
l_int|0x80
op_logical_or
id|reg
op_ge
l_int|0xc0
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|uinfo-&gt;type
op_assign
id|mask
op_eq
l_int|1
ques
c_cond
id|SNDRV_CTL_ELEM_TYPE_BOOLEAN
suffix:colon
id|SNDRV_CTL_ELEM_TYPE_INTEGER
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|2
suffix:semicolon
id|uinfo-&gt;value.integer.min
op_assign
l_int|0
suffix:semicolon
id|uinfo-&gt;value.integer.max
op_assign
id|mask
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ymfpci_get_double
r_static
r_int
id|snd_ymfpci_get_double
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|ymfpci_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
r_int
id|reg
op_assign
id|kcontrol-&gt;private_value
suffix:semicolon
r_int
r_int
id|shift_left
op_assign
l_int|0
comma
id|shift_right
op_assign
l_int|16
comma
id|mask
op_assign
l_int|16383
comma
id|invert
op_assign
l_int|0
suffix:semicolon
r_int
r_int
id|val
suffix:semicolon
r_if
c_cond
(paren
id|reg
OL
l_int|0x80
op_logical_or
id|reg
op_ge
l_int|0xc0
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
id|val
op_assign
id|snd_ymfpci_readl
c_func
(paren
id|chip
comma
id|reg
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
(paren
id|val
op_rshift
id|shift_left
)paren
op_amp
id|mask
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|1
)braket
op_assign
(paren
id|val
op_rshift
id|shift_right
)paren
op_amp
id|mask
suffix:semicolon
r_if
c_cond
(paren
id|invert
)paren
(brace
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
id|mask
op_minus
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|1
)braket
op_assign
id|mask
op_minus
id|ucontrol-&gt;value.integer.value
(braket
l_int|1
)braket
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ymfpci_put_double
r_static
r_int
id|snd_ymfpci_put_double
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|ymfpci_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
r_int
id|reg
op_assign
id|kcontrol-&gt;private_value
suffix:semicolon
r_int
r_int
id|shift_left
op_assign
l_int|0
comma
id|shift_right
op_assign
l_int|16
comma
id|mask
op_assign
l_int|16383
comma
id|invert
op_assign
l_int|0
suffix:semicolon
r_int
id|change
suffix:semicolon
r_int
r_int
id|val1
comma
id|val2
comma
id|oval
suffix:semicolon
r_if
c_cond
(paren
id|reg
OL
l_int|0x80
op_logical_or
id|reg
op_ge
l_int|0xc0
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|val1
op_assign
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_amp
id|mask
suffix:semicolon
id|val2
op_assign
id|ucontrol-&gt;value.integer.value
(braket
l_int|1
)braket
op_amp
id|mask
suffix:semicolon
r_if
c_cond
(paren
id|invert
)paren
(brace
id|val1
op_assign
id|mask
op_minus
id|val1
suffix:semicolon
id|val2
op_assign
id|mask
op_minus
id|val2
suffix:semicolon
)brace
id|val1
op_lshift_assign
id|shift_left
suffix:semicolon
id|val2
op_lshift_assign
id|shift_right
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
id|oval
op_assign
id|snd_ymfpci_readl
c_func
(paren
id|chip
comma
id|reg
)paren
suffix:semicolon
id|val1
op_assign
(paren
id|oval
op_amp
op_complement
(paren
(paren
id|mask
op_lshift
id|shift_left
)paren
op_or
(paren
id|mask
op_lshift
id|shift_right
)paren
)paren
)paren
op_or
id|val1
op_or
id|val2
suffix:semicolon
id|change
op_assign
id|val1
op_ne
id|oval
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|reg
comma
id|val1
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
r_return
id|change
suffix:semicolon
)brace
DECL|macro|YMFPCI_CONTROLS
mdefine_line|#define YMFPCI_CONTROLS (sizeof(snd_ymfpci_controls)/sizeof(snd_kcontrol_new_t))
DECL|variable|__devinitdata
r_static
id|snd_kcontrol_new_t
id|snd_ymfpci_controls
(braket
)braket
id|__devinitdata
op_assign
(brace
id|YMFPCI_DOUBLE
c_func
(paren
l_string|&quot;Wave Playback Volume&quot;
comma
l_int|0
comma
id|YDSXGR_NATIVEDACOUTVOL
)paren
comma
id|YMFPCI_DOUBLE
c_func
(paren
l_string|&quot;Wave Capture Volume&quot;
comma
l_int|0
comma
id|YDSXGR_NATIVEDACLOOPVOL
)paren
comma
id|YMFPCI_DOUBLE
c_func
(paren
l_string|&quot;Digital Capture Volume&quot;
comma
l_int|0
comma
id|YDSXGR_NATIVEDACINVOL
)paren
comma
id|YMFPCI_DOUBLE
c_func
(paren
l_string|&quot;Digital Capture Volume&quot;
comma
l_int|1
comma
id|YDSXGR_NATIVEADCINVOL
)paren
comma
id|YMFPCI_DOUBLE
c_func
(paren
l_string|&quot;ADC Playback Volume&quot;
comma
l_int|0
comma
id|YDSXGR_PRIADCOUTVOL
)paren
comma
id|YMFPCI_DOUBLE
c_func
(paren
l_string|&quot;ADC Capture Volume&quot;
comma
l_int|0
comma
id|YDSXGR_PRIADCLOOPVOL
)paren
comma
id|YMFPCI_DOUBLE
c_func
(paren
l_string|&quot;ADC Playback Volume&quot;
comma
l_int|1
comma
id|YDSXGR_SECADCOUTVOL
)paren
comma
id|YMFPCI_DOUBLE
c_func
(paren
l_string|&quot;ADC Capture Volume&quot;
comma
l_int|1
comma
id|YDSXGR_SECADCLOOPVOL
)paren
comma
id|YMFPCI_DOUBLE
c_func
(paren
id|SNDRV_CTL_NAME_IEC958
c_func
(paren
l_string|&quot;AC97 &quot;
comma
id|PLAYBACK
comma
id|VOLUME
)paren
comma
l_int|0
comma
id|YDSXGR_ZVOUTVOL
)paren
comma
id|YMFPCI_DOUBLE
c_func
(paren
id|SNDRV_CTL_NAME_IEC958
c_func
(paren
l_string|&quot;&quot;
comma
id|CAPTURE
comma
id|VOLUME
)paren
comma
l_int|0
comma
id|YDSXGR_ZVLOOPVOL
)paren
comma
id|YMFPCI_DOUBLE
c_func
(paren
id|SNDRV_CTL_NAME_IEC958
c_func
(paren
l_string|&quot;AC97 &quot;
comma
id|PLAYBACK
comma
id|VOLUME
)paren
comma
l_int|1
comma
id|YDSXGR_SPDIFOUTVOL
)paren
comma
id|YMFPCI_DOUBLE
c_func
(paren
id|SNDRV_CTL_NAME_IEC958
c_func
(paren
l_string|&quot;&quot;
comma
id|CAPTURE
comma
id|VOLUME
)paren
comma
l_int|1
comma
id|YDSXGR_SPDIFLOOPVOL
)paren
comma
id|YMFPCI_SINGLE
c_func
(paren
id|SNDRV_CTL_NAME_IEC958
c_func
(paren
l_string|&quot;&quot;
comma
id|PLAYBACK
comma
id|SWITCH
)paren
comma
l_int|0
comma
id|YDSXGR_SPDIFOUTCTRL
)paren
comma
id|YMFPCI_SINGLE
c_func
(paren
id|SNDRV_CTL_NAME_IEC958
c_func
(paren
l_string|&quot;&quot;
comma
id|CAPTURE
comma
id|SWITCH
)paren
comma
l_int|0
comma
id|YDSXGR_SPDIFINCTRL
)paren
)brace
suffix:semicolon
multiline_comment|/*&n; *  Mixer routines&n; */
DECL|function|snd_ymfpci_mixer_free_ac97
r_static
r_void
id|snd_ymfpci_mixer_free_ac97
c_func
(paren
id|ac97_t
op_star
id|ac97
)paren
(brace
id|ymfpci_t
op_star
id|chip
op_assign
id|snd_magic_cast
c_func
(paren
id|ymfpci_t
comma
id|ac97-&gt;private_data
comma
r_return
)paren
suffix:semicolon
id|chip-&gt;ac97
op_assign
l_int|NULL
suffix:semicolon
)brace
DECL|function|snd_ymfpci_mixer
r_int
id|__devinit
id|snd_ymfpci_mixer
c_func
(paren
id|ymfpci_t
op_star
id|chip
)paren
(brace
id|ac97_t
id|ac97
suffix:semicolon
id|snd_kcontrol_t
op_star
id|kctl
suffix:semicolon
r_int
id|err
comma
id|idx
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|ac97
comma
l_int|0
comma
r_sizeof
(paren
id|ac97
)paren
)paren
suffix:semicolon
id|ac97.write
op_assign
id|snd_ymfpci_codec_write
suffix:semicolon
id|ac97.read
op_assign
id|snd_ymfpci_codec_read
suffix:semicolon
id|ac97.private_data
op_assign
id|chip
suffix:semicolon
id|ac97.private_free
op_assign
id|snd_ymfpci_mixer_free_ac97
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ac97_mixer
c_func
(paren
id|chip-&gt;card
comma
op_amp
id|ac97
comma
op_amp
id|chip-&gt;ac97
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_for
c_loop
(paren
id|idx
op_assign
l_int|0
suffix:semicolon
id|idx
OL
id|YMFPCI_CONTROLS
suffix:semicolon
id|idx
op_increment
)paren
(brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|chip-&gt;card
comma
id|snd_ctl_new1
c_func
(paren
op_amp
id|snd_ymfpci_controls
(braket
id|idx
)braket
comma
id|chip
)paren
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
multiline_comment|/* add S/PDIF control */
id|snd_assert
c_func
(paren
id|chip-&gt;pcm_spdif
op_ne
l_int|NULL
comma
r_return
op_minus
id|EIO
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|chip-&gt;card
comma
id|kctl
op_assign
id|snd_ctl_new1
c_func
(paren
op_amp
id|snd_ymfpci_spdif_default
comma
id|chip
)paren
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|kctl-&gt;id.device
op_assign
id|chip-&gt;pcm_spdif-&gt;device
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|chip-&gt;card
comma
id|kctl
op_assign
id|snd_ctl_new1
c_func
(paren
op_amp
id|snd_ymfpci_spdif_mask
comma
id|chip
)paren
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|kctl-&gt;id.device
op_assign
id|chip-&gt;pcm_spdif-&gt;device
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|chip-&gt;card
comma
id|kctl
op_assign
id|snd_ctl_new1
c_func
(paren
op_amp
id|snd_ymfpci_spdif_stream
comma
id|chip
)paren
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|kctl-&gt;id.device
op_assign
id|chip-&gt;pcm_spdif-&gt;device
suffix:semicolon
id|chip-&gt;spdif_pcm_ctl
op_assign
id|kctl
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * joystick support&n; */
DECL|variable|ymfpci_joystick_ports
r_static
r_int
id|ymfpci_joystick_ports
(braket
l_int|4
)braket
op_assign
(brace
l_int|0x201
comma
l_int|0x202
comma
l_int|0x204
comma
l_int|0x205
)brace
suffix:semicolon
DECL|function|setup_joystick_base
r_static
r_void
id|setup_joystick_base
c_func
(paren
id|ymfpci_t
op_star
id|chip
)paren
(brace
r_if
c_cond
(paren
id|chip-&gt;pci-&gt;device
op_ge
l_int|0x0010
)paren
multiline_comment|/* YMF 744/754 */
id|pci_write_config_word
c_func
(paren
id|chip-&gt;pci
comma
id|PCIR_DSXG_JOYBASE
comma
id|ymfpci_joystick_ports
(braket
id|chip-&gt;joystick_port
)braket
)paren
suffix:semicolon
r_else
(brace
id|u16
id|legacy_ctrl2
suffix:semicolon
id|pci_read_config_word
c_func
(paren
id|chip-&gt;pci
comma
id|PCIR_DSXG_ELEGACY
comma
op_amp
id|legacy_ctrl2
)paren
suffix:semicolon
id|legacy_ctrl2
op_and_assign
op_complement
(paren
l_int|3
op_lshift
l_int|6
)paren
suffix:semicolon
id|legacy_ctrl2
op_or_assign
id|chip-&gt;joystick_port
op_lshift
l_int|6
suffix:semicolon
id|pci_write_config_word
c_func
(paren
id|chip-&gt;pci
comma
id|PCIR_DSXG_ELEGACY
comma
id|legacy_ctrl2
)paren
suffix:semicolon
)brace
)brace
DECL|function|snd_ymfpci_joystick_info
r_static
r_int
id|snd_ymfpci_joystick_info
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_BOOLEAN
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
id|uinfo-&gt;value.integer.min
op_assign
l_int|0
suffix:semicolon
id|uinfo-&gt;value.integer.max
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ymfpci_joystick_get
r_static
r_int
id|snd_ymfpci_joystick_get
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|ymfpci_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|u16
id|val
suffix:semicolon
id|pci_read_config_word
c_func
(paren
id|chip-&gt;pci
comma
id|PCIR_DSXG_LEGACY
comma
op_amp
id|val
)paren
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
(paren
id|val
op_amp
l_int|0x04
)paren
ques
c_cond
l_int|1
suffix:colon
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ymfpci_joystick_put
r_static
r_int
id|snd_ymfpci_joystick_put
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|ymfpci_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|u16
id|val
comma
id|oval
suffix:semicolon
id|pci_read_config_word
c_func
(paren
id|chip-&gt;pci
comma
id|PCIR_DSXG_LEGACY
comma
op_amp
id|oval
)paren
suffix:semicolon
id|val
op_assign
id|oval
op_amp
op_complement
l_int|0x04
suffix:semicolon
r_if
c_cond
(paren
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
)paren
id|val
op_or_assign
l_int|0x04
suffix:semicolon
r_if
c_cond
(paren
id|val
op_ne
id|oval
)paren
(brace
id|setup_joystick_base
c_func
(paren
id|chip
)paren
suffix:semicolon
id|pci_write_config_word
c_func
(paren
id|chip-&gt;pci
comma
id|PCIR_DSXG_LEGACY
comma
id|val
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ymfpci_joystick_addr_info
r_static
r_int
id|snd_ymfpci_joystick_addr_info
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_ENUMERATED
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
id|uinfo-&gt;value.enumerated.items
op_assign
l_int|4
suffix:semicolon
r_if
c_cond
(paren
id|uinfo-&gt;value.enumerated.item
op_ge
l_int|4
)paren
id|uinfo-&gt;value.enumerated.item
op_assign
l_int|3
suffix:semicolon
id|sprintf
c_func
(paren
id|uinfo-&gt;value.enumerated.name
comma
l_string|&quot;port 0x%x&quot;
comma
id|ymfpci_joystick_ports
(braket
id|uinfo-&gt;value.enumerated.item
)braket
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ymfpci_joystick_addr_get
r_static
r_int
id|snd_ymfpci_joystick_addr_get
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|ymfpci_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
id|chip-&gt;joystick_port
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ymfpci_joystick_addr_put
r_static
r_int
id|snd_ymfpci_joystick_addr_put
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|ymfpci_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_ne
id|chip-&gt;joystick_port
)paren
(brace
id|snd_assert
c_func
(paren
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_ge
l_int|0
op_logical_and
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
OL
l_int|4
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|chip-&gt;joystick_port
op_assign
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
suffix:semicolon
id|setup_joystick_base
c_func
(paren
id|chip
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|__devinitdata
r_static
id|snd_kcontrol_new_t
id|snd_ymfpci_control_joystick
id|__devinitdata
op_assign
(brace
id|name
suffix:colon
l_string|&quot;Joystick&quot;
comma
id|iface
suffix:colon
id|SNDRV_CTL_ELEM_IFACE_CARD
comma
id|info
suffix:colon
id|snd_ymfpci_joystick_info
comma
id|get
suffix:colon
id|snd_ymfpci_joystick_get
comma
id|put
suffix:colon
id|snd_ymfpci_joystick_put
comma
)brace
suffix:semicolon
DECL|variable|__devinitdata
r_static
id|snd_kcontrol_new_t
id|snd_ymfpci_control_joystick_addr
id|__devinitdata
op_assign
(brace
id|name
suffix:colon
l_string|&quot;Joystick Address&quot;
comma
id|iface
suffix:colon
id|SNDRV_CTL_ELEM_IFACE_CARD
comma
id|info
suffix:colon
id|snd_ymfpci_joystick_addr_info
comma
id|get
suffix:colon
id|snd_ymfpci_joystick_addr_get
comma
id|put
suffix:colon
id|snd_ymfpci_joystick_addr_put
comma
)brace
suffix:semicolon
DECL|function|snd_ymfpci_joystick
r_int
id|__devinit
id|snd_ymfpci_joystick
c_func
(paren
id|ymfpci_t
op_star
id|chip
)paren
(brace
r_int
id|err
suffix:semicolon
id|chip-&gt;joystick_port
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* default */
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|chip-&gt;card
comma
id|snd_ctl_new1
c_func
(paren
op_amp
id|snd_ymfpci_control_joystick
comma
id|chip
)paren
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|chip-&gt;card
comma
id|snd_ctl_new1
c_func
(paren
op_amp
id|snd_ymfpci_control_joystick_addr
comma
id|chip
)paren
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; *  proc interface&n; */
DECL|function|snd_ymfpci_proc_read
r_static
r_void
id|snd_ymfpci_proc_read
c_func
(paren
id|snd_info_entry_t
op_star
id|entry
comma
id|snd_info_buffer_t
op_star
id|buffer
)paren
(brace
singleline_comment|// ymfpci_t *chip = snd_magic_cast(ymfpci_t, private_data, return);
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;YMFPCI&bslash;n&bslash;n&quot;
)paren
suffix:semicolon
)brace
DECL|function|snd_ymfpci_proc_init
r_static
r_int
id|__devinit
id|snd_ymfpci_proc_init
c_func
(paren
id|snd_card_t
op_star
id|card
comma
id|ymfpci_t
op_star
id|chip
)paren
(brace
id|snd_info_entry_t
op_star
id|entry
suffix:semicolon
id|entry
op_assign
id|snd_info_create_card_entry
c_func
(paren
id|card
comma
l_string|&quot;ymfpci&quot;
comma
id|card-&gt;proc_root
)paren
suffix:semicolon
r_if
c_cond
(paren
id|entry
)paren
(brace
id|entry-&gt;content
op_assign
id|SNDRV_INFO_CONTENT_TEXT
suffix:semicolon
id|entry-&gt;private_data
op_assign
id|chip
suffix:semicolon
id|entry-&gt;mode
op_assign
id|S_IFREG
op_or
id|S_IRUGO
op_or
id|S_IWUSR
suffix:semicolon
id|entry-&gt;c.text.read_size
op_assign
l_int|4096
suffix:semicolon
id|entry-&gt;c.text.read
op_assign
id|snd_ymfpci_proc_read
suffix:semicolon
r_if
c_cond
(paren
id|snd_info_register
c_func
(paren
id|entry
)paren
OL
l_int|0
)paren
(brace
id|snd_info_unregister
c_func
(paren
id|entry
)paren
suffix:semicolon
id|entry
op_assign
l_int|NULL
suffix:semicolon
)brace
)brace
id|chip-&gt;proc_entry
op_assign
id|entry
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ymfpci_proc_done
r_static
r_int
id|snd_ymfpci_proc_done
c_func
(paren
id|ymfpci_t
op_star
id|chip
)paren
(brace
r_if
c_cond
(paren
id|chip-&gt;proc_entry
)paren
id|snd_info_unregister
c_func
(paren
(paren
id|snd_info_entry_t
op_star
)paren
id|chip-&gt;proc_entry
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; *  initialization routines&n; */
DECL|function|snd_ymfpci_aclink_reset
r_static
r_void
id|snd_ymfpci_aclink_reset
c_func
(paren
r_struct
id|pci_dev
op_star
id|pci
)paren
(brace
id|u8
id|cmd
suffix:semicolon
id|pci_read_config_byte
c_func
(paren
id|pci
comma
id|PCIR_DSXG_CTRL
comma
op_amp
id|cmd
)paren
suffix:semicolon
macro_line|#if 0 
singleline_comment|// force to reset
r_if
c_cond
(paren
id|cmd
op_amp
l_int|0x03
)paren
(brace
macro_line|#endif
id|pci_write_config_byte
c_func
(paren
id|pci
comma
id|PCIR_DSXG_CTRL
comma
id|cmd
op_amp
l_int|0xfc
)paren
suffix:semicolon
id|pci_write_config_byte
c_func
(paren
id|pci
comma
id|PCIR_DSXG_CTRL
comma
id|cmd
op_or
l_int|0x03
)paren
suffix:semicolon
id|pci_write_config_byte
c_func
(paren
id|pci
comma
id|PCIR_DSXG_CTRL
comma
id|cmd
op_amp
l_int|0xfc
)paren
suffix:semicolon
id|pci_write_config_word
c_func
(paren
id|pci
comma
id|PCIR_DSXG_PWRCTRL1
comma
l_int|0
)paren
suffix:semicolon
id|pci_write_config_word
c_func
(paren
id|pci
comma
id|PCIR_DSXG_PWRCTRL2
comma
l_int|0
)paren
suffix:semicolon
macro_line|#if 0
)brace
macro_line|#endif
)brace
DECL|function|snd_ymfpci_enable_dsp
r_static
r_void
id|snd_ymfpci_enable_dsp
c_func
(paren
id|ymfpci_t
op_star
id|chip
)paren
(brace
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_CONFIG
comma
l_int|0x00000001
)paren
suffix:semicolon
)brace
DECL|function|snd_ymfpci_disable_dsp
r_static
r_void
id|snd_ymfpci_disable_dsp
c_func
(paren
id|ymfpci_t
op_star
id|chip
)paren
(brace
id|u32
id|val
suffix:semicolon
r_int
id|timeout
op_assign
l_int|1000
suffix:semicolon
id|val
op_assign
id|snd_ymfpci_readl
c_func
(paren
id|chip
comma
id|YDSXGR_CONFIG
)paren
suffix:semicolon
r_if
c_cond
(paren
id|val
)paren
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_CONFIG
comma
l_int|0x00000000
)paren
suffix:semicolon
r_while
c_loop
(paren
id|timeout
op_decrement
OG
l_int|0
)paren
(brace
id|val
op_assign
id|snd_ymfpci_readl
c_func
(paren
id|chip
comma
id|YDSXGR_STATUS
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|val
op_amp
l_int|0x00000002
)paren
op_eq
l_int|0
)paren
r_break
suffix:semicolon
)brace
)brace
macro_line|#include &quot;ymfpci_image.h&quot;
DECL|function|snd_ymfpci_download_image
r_static
r_void
id|snd_ymfpci_download_image
c_func
(paren
id|ymfpci_t
op_star
id|chip
)paren
(brace
r_int
id|i
suffix:semicolon
id|u16
id|ctrl
suffix:semicolon
r_int
r_int
op_star
id|inst
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_NATIVEDACOUTVOL
comma
l_int|0x00000000
)paren
suffix:semicolon
id|snd_ymfpci_disable_dsp
c_func
(paren
id|chip
)paren
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_MODE
comma
l_int|0x00010000
)paren
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_MODE
comma
l_int|0x00000000
)paren
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_MAPOFREC
comma
l_int|0x00000000
)paren
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_MAPOFEFFECT
comma
l_int|0x00000000
)paren
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_PLAYCTRLBASE
comma
l_int|0x00000000
)paren
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_RECCTRLBASE
comma
l_int|0x00000000
)paren
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_EFFCTRLBASE
comma
l_int|0x00000000
)paren
suffix:semicolon
id|ctrl
op_assign
id|snd_ymfpci_readw
c_func
(paren
id|chip
comma
id|YDSXGR_GLOBALCTRL
)paren
suffix:semicolon
id|snd_ymfpci_writew
c_func
(paren
id|chip
comma
id|YDSXGR_GLOBALCTRL
comma
id|ctrl
op_amp
op_complement
l_int|0x0007
)paren
suffix:semicolon
multiline_comment|/* setup DSP instruction code */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|YDSXG_DSPLENGTH
op_div
l_int|4
suffix:semicolon
id|i
op_increment
)paren
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_DSPINSTRAM
op_plus
(paren
id|i
op_lshift
l_int|2
)paren
comma
id|DspInst
(braket
id|i
)braket
)paren
suffix:semicolon
multiline_comment|/* setup control instruction code */
r_switch
c_cond
(paren
id|chip-&gt;device_id
)paren
(brace
r_case
id|PCI_DEVICE_ID_YAMAHA_724F
suffix:colon
r_case
id|PCI_DEVICE_ID_YAMAHA_740C
suffix:colon
r_case
id|PCI_DEVICE_ID_YAMAHA_744
suffix:colon
r_case
id|PCI_DEVICE_ID_YAMAHA_754
suffix:colon
id|inst
op_assign
id|CntrlInst1E
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|inst
op_assign
id|CntrlInst
suffix:semicolon
r_break
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|YDSXG_CTRLLENGTH
op_div
l_int|4
suffix:semicolon
id|i
op_increment
)paren
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_CTRLINSTRAM
op_plus
(paren
id|i
op_lshift
l_int|2
)paren
comma
id|inst
(braket
id|i
)braket
)paren
suffix:semicolon
id|snd_ymfpci_enable_dsp
c_func
(paren
id|chip
)paren
suffix:semicolon
)brace
DECL|function|snd_ymfpci_memalloc
r_static
r_int
id|__devinit
id|snd_ymfpci_memalloc
c_func
(paren
id|ymfpci_t
op_star
id|chip
)paren
(brace
r_int
id|size
comma
id|playback_ctrl_size
suffix:semicolon
r_int
id|voice
comma
id|bank
comma
id|reg
suffix:semicolon
id|u8
op_star
id|ptr
suffix:semicolon
id|dma_addr_t
id|ptr_addr
suffix:semicolon
id|playback_ctrl_size
op_assign
l_int|4
op_plus
l_int|4
op_star
id|YDSXG_PLAYBACK_VOICES
suffix:semicolon
id|chip-&gt;bank_size_playback
op_assign
id|snd_ymfpci_readl
c_func
(paren
id|chip
comma
id|YDSXGR_PLAYCTRLSIZE
)paren
op_lshift
l_int|2
suffix:semicolon
id|chip-&gt;bank_size_capture
op_assign
id|snd_ymfpci_readl
c_func
(paren
id|chip
comma
id|YDSXGR_RECCTRLSIZE
)paren
op_lshift
l_int|2
suffix:semicolon
id|chip-&gt;bank_size_effect
op_assign
id|snd_ymfpci_readl
c_func
(paren
id|chip
comma
id|YDSXGR_EFFCTRLSIZE
)paren
op_lshift
l_int|2
suffix:semicolon
id|chip-&gt;work_size
op_assign
id|YDSXG_DEFAULT_WORK_SIZE
suffix:semicolon
id|size
op_assign
(paren
(paren
id|playback_ctrl_size
op_plus
l_int|0x00ff
)paren
op_amp
op_complement
l_int|0x00ff
)paren
op_plus
(paren
(paren
id|chip-&gt;bank_size_playback
op_star
l_int|2
op_star
id|YDSXG_PLAYBACK_VOICES
op_plus
l_int|0x00ff
)paren
op_amp
op_complement
l_int|0x00ff
)paren
op_plus
(paren
(paren
id|chip-&gt;bank_size_capture
op_star
l_int|2
op_star
id|YDSXG_CAPTURE_VOICES
op_plus
l_int|0x00ff
)paren
op_amp
op_complement
l_int|0x00ff
)paren
op_plus
(paren
(paren
id|chip-&gt;bank_size_effect
op_star
l_int|2
op_star
id|YDSXG_EFFECT_VOICES
op_plus
l_int|0x00ff
)paren
op_amp
op_complement
l_int|0x00ff
)paren
op_plus
id|chip-&gt;work_size
suffix:semicolon
multiline_comment|/* work_ptr must be aligned to 256 bytes, but it&squot;s already&n;&t;   covered with the kernel page allocation mechanism */
r_if
c_cond
(paren
(paren
id|ptr
op_assign
id|snd_malloc_pci_pages
c_func
(paren
id|chip-&gt;pci
comma
id|size
comma
op_amp
id|ptr_addr
)paren
)paren
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|memset
c_func
(paren
id|ptr
comma
l_int|0
comma
id|size
)paren
suffix:semicolon
multiline_comment|/* for sure */
id|chip-&gt;work_ptr
op_assign
id|ptr
suffix:semicolon
id|chip-&gt;work_ptr_addr
op_assign
id|ptr_addr
suffix:semicolon
id|chip-&gt;work_ptr_size
op_assign
id|size
suffix:semicolon
id|chip-&gt;bank_base_playback
op_assign
id|ptr
suffix:semicolon
id|chip-&gt;bank_base_playback_addr
op_assign
id|ptr_addr
suffix:semicolon
id|chip-&gt;ctrl_playback
op_assign
(paren
id|u32
op_star
)paren
id|ptr
suffix:semicolon
id|chip-&gt;ctrl_playback
(braket
l_int|0
)braket
op_assign
id|cpu_to_le32
c_func
(paren
id|YDSXG_PLAYBACK_VOICES
)paren
suffix:semicolon
id|ptr
op_add_assign
(paren
id|playback_ctrl_size
op_plus
l_int|0x00ff
)paren
op_amp
op_complement
l_int|0x00ff
suffix:semicolon
id|ptr_addr
op_add_assign
(paren
id|playback_ctrl_size
op_plus
l_int|0x00ff
)paren
op_amp
op_complement
l_int|0x00ff
suffix:semicolon
r_for
c_loop
(paren
id|voice
op_assign
l_int|0
suffix:semicolon
id|voice
OL
id|YDSXG_PLAYBACK_VOICES
suffix:semicolon
id|voice
op_increment
)paren
(brace
id|chip-&gt;voices
(braket
id|voice
)braket
dot
id|number
op_assign
id|voice
suffix:semicolon
id|chip-&gt;voices
(braket
id|voice
)braket
dot
id|bank
op_assign
(paren
id|snd_ymfpci_playback_bank_t
op_star
)paren
id|ptr
suffix:semicolon
id|chip-&gt;voices
(braket
id|voice
)braket
dot
id|bank_addr
op_assign
id|ptr_addr
suffix:semicolon
r_for
c_loop
(paren
id|bank
op_assign
l_int|0
suffix:semicolon
id|bank
OL
l_int|2
suffix:semicolon
id|bank
op_increment
)paren
(brace
id|chip-&gt;bank_playback
(braket
id|voice
)braket
(braket
id|bank
)braket
op_assign
(paren
id|snd_ymfpci_playback_bank_t
op_star
)paren
id|ptr
suffix:semicolon
id|ptr
op_add_assign
id|chip-&gt;bank_size_playback
suffix:semicolon
id|ptr_addr
op_add_assign
id|chip-&gt;bank_size_playback
suffix:semicolon
)brace
)brace
id|ptr
op_assign
(paren
r_char
op_star
)paren
(paren
(paren
(paren
r_int
r_int
)paren
id|ptr
op_plus
l_int|0x00ff
)paren
op_amp
op_complement
l_int|0x00ff
)paren
suffix:semicolon
id|ptr_addr
op_assign
(paren
id|ptr_addr
op_plus
l_int|0x00ff
)paren
op_amp
op_complement
l_int|0x00ff
suffix:semicolon
id|chip-&gt;bank_base_capture
op_assign
id|ptr
suffix:semicolon
id|chip-&gt;bank_base_capture_addr
op_assign
id|ptr_addr
suffix:semicolon
r_for
c_loop
(paren
id|voice
op_assign
l_int|0
suffix:semicolon
id|voice
OL
id|YDSXG_CAPTURE_VOICES
suffix:semicolon
id|voice
op_increment
)paren
r_for
c_loop
(paren
id|bank
op_assign
l_int|0
suffix:semicolon
id|bank
OL
l_int|2
suffix:semicolon
id|bank
op_increment
)paren
(brace
id|chip-&gt;bank_capture
(braket
id|voice
)braket
(braket
id|bank
)braket
op_assign
(paren
id|snd_ymfpci_capture_bank_t
op_star
)paren
id|ptr
suffix:semicolon
id|ptr
op_add_assign
id|chip-&gt;bank_size_capture
suffix:semicolon
id|ptr_addr
op_add_assign
id|chip-&gt;bank_size_capture
suffix:semicolon
)brace
id|ptr
op_assign
(paren
r_char
op_star
)paren
(paren
(paren
(paren
r_int
r_int
)paren
id|ptr
op_plus
l_int|0x00ff
)paren
op_amp
op_complement
l_int|0x00ff
)paren
suffix:semicolon
id|ptr_addr
op_assign
(paren
id|ptr_addr
op_plus
l_int|0x00ff
)paren
op_amp
op_complement
l_int|0x00ff
suffix:semicolon
id|chip-&gt;bank_base_effect
op_assign
id|ptr
suffix:semicolon
id|chip-&gt;bank_base_effect_addr
op_assign
id|ptr_addr
suffix:semicolon
r_for
c_loop
(paren
id|voice
op_assign
l_int|0
suffix:semicolon
id|voice
OL
id|YDSXG_EFFECT_VOICES
suffix:semicolon
id|voice
op_increment
)paren
r_for
c_loop
(paren
id|bank
op_assign
l_int|0
suffix:semicolon
id|bank
OL
l_int|2
suffix:semicolon
id|bank
op_increment
)paren
(brace
id|chip-&gt;bank_effect
(braket
id|voice
)braket
(braket
id|bank
)braket
op_assign
(paren
id|snd_ymfpci_effect_bank_t
op_star
)paren
id|ptr
suffix:semicolon
id|ptr
op_add_assign
id|chip-&gt;bank_size_effect
suffix:semicolon
id|ptr_addr
op_add_assign
id|chip-&gt;bank_size_effect
suffix:semicolon
)brace
id|ptr
op_assign
(paren
r_char
op_star
)paren
(paren
(paren
(paren
r_int
r_int
)paren
id|ptr
op_plus
l_int|0x00ff
)paren
op_amp
op_complement
l_int|0x00ff
)paren
suffix:semicolon
id|ptr_addr
op_assign
(paren
id|ptr_addr
op_plus
l_int|0x00ff
)paren
op_amp
op_complement
l_int|0x00ff
suffix:semicolon
id|chip-&gt;work_base
op_assign
id|ptr
suffix:semicolon
id|chip-&gt;work_base_addr
op_assign
id|ptr_addr
suffix:semicolon
id|snd_assert
c_func
(paren
id|ptr
op_plus
id|chip-&gt;work_size
op_eq
id|chip-&gt;work_ptr
op_plus
id|chip-&gt;work_ptr_size
comma
)paren
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_PLAYCTRLBASE
comma
id|chip-&gt;bank_base_playback_addr
)paren
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_RECCTRLBASE
comma
id|chip-&gt;bank_base_capture_addr
)paren
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_EFFCTRLBASE
comma
id|chip-&gt;bank_base_effect_addr
)paren
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_WORKBASE
comma
id|chip-&gt;work_base_addr
)paren
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_WORKSIZE
comma
id|chip-&gt;work_size
op_rshift
l_int|2
)paren
suffix:semicolon
multiline_comment|/* S/PDIF output initialization */
id|chip-&gt;spdif_bits
op_assign
id|chip-&gt;spdif_pcm_bits
op_assign
id|SNDRV_PCM_DEFAULT_CON_SPDIF
op_amp
l_int|0xffff
suffix:semicolon
id|snd_ymfpci_writew
c_func
(paren
id|chip
comma
id|YDSXGR_SPDIFOUTCTRL
comma
l_int|0
)paren
suffix:semicolon
id|snd_ymfpci_writew
c_func
(paren
id|chip
comma
id|YDSXGR_SPDIFOUTSTATUS
comma
id|chip-&gt;spdif_bits
)paren
suffix:semicolon
multiline_comment|/* S/PDIF input initialization */
id|snd_ymfpci_writew
c_func
(paren
id|chip
comma
id|YDSXGR_SPDIFINCTRL
comma
l_int|0
)paren
suffix:semicolon
multiline_comment|/* digital mixer setup */
r_for
c_loop
(paren
id|reg
op_assign
l_int|0x80
suffix:semicolon
id|reg
OL
l_int|0xc0
suffix:semicolon
id|reg
op_add_assign
l_int|4
)paren
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|reg
comma
l_int|0
)paren
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_NATIVEDACOUTVOL
comma
l_int|0x3fff3fff
)paren
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_ZVOUTVOL
comma
l_int|0x3fff3fff
)paren
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_SPDIFOUTVOL
comma
l_int|0x3fff3fff
)paren
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_NATIVEADCINVOL
comma
l_int|0x3fff3fff
)paren
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_NATIVEDACINVOL
comma
l_int|0x3fff3fff
)paren
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_PRIADCLOOPVOL
comma
l_int|0x3fff3fff
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ymfpci_free
r_static
r_int
id|snd_ymfpci_free
c_func
(paren
id|ymfpci_t
op_star
id|chip
)paren
(brace
id|u16
id|ctrl
suffix:semicolon
id|snd_assert
c_func
(paren
id|chip
op_ne
l_int|NULL
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|snd_ymfpci_proc_done
c_func
(paren
id|chip
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;res_reg_area
)paren
(brace
multiline_comment|/* don&squot;t touch busy hardware */
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_NATIVEDACOUTVOL
comma
l_int|0
)paren
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_BUF441OUTVOL
comma
l_int|0
)paren
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_STATUS
comma
op_complement
l_int|0
)paren
suffix:semicolon
id|snd_ymfpci_disable_dsp
c_func
(paren
id|chip
)paren
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_PLAYCTRLBASE
comma
l_int|0
)paren
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_RECCTRLBASE
comma
l_int|0
)paren
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_EFFCTRLBASE
comma
l_int|0
)paren
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_WORKBASE
comma
l_int|0
)paren
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_WORKSIZE
comma
l_int|0
)paren
suffix:semicolon
id|ctrl
op_assign
id|snd_ymfpci_readw
c_func
(paren
id|chip
comma
id|YDSXGR_GLOBALCTRL
)paren
suffix:semicolon
id|snd_ymfpci_writew
c_func
(paren
id|chip
comma
id|YDSXGR_GLOBALCTRL
comma
id|ctrl
op_amp
op_complement
l_int|0x0007
)paren
suffix:semicolon
)brace
multiline_comment|/* Set PCI device to D3 state */
singleline_comment|// pci_set_power_state(chip-&gt;pci, 3);
macro_line|#ifdef CONFIG_PM
r_if
c_cond
(paren
id|chip-&gt;saved_regs
)paren
id|kfree
c_func
(paren
id|chip-&gt;saved_regs
)paren
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
id|chip-&gt;reg_area_virt
)paren
id|iounmap
c_func
(paren
(paren
r_void
op_star
)paren
id|chip-&gt;reg_area_virt
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;work_ptr
)paren
id|snd_free_pci_pages
c_func
(paren
id|chip-&gt;pci
comma
id|chip-&gt;work_ptr_size
comma
id|chip-&gt;work_ptr
comma
id|chip-&gt;work_ptr_addr
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;irq
op_ge
l_int|0
)paren
id|free_irq
c_func
(paren
id|chip-&gt;irq
comma
(paren
r_void
op_star
)paren
id|chip
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;res_reg_area
)paren
(brace
id|release_resource
c_func
(paren
id|chip-&gt;res_reg_area
)paren
suffix:semicolon
id|kfree_nocheck
c_func
(paren
id|chip-&gt;res_reg_area
)paren
suffix:semicolon
)brace
id|pci_write_config_word
c_func
(paren
id|chip-&gt;pci
comma
l_int|0x40
comma
id|chip-&gt;old_legacy_ctrl
)paren
suffix:semicolon
id|snd_magic_kfree
c_func
(paren
id|chip
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ymfpci_dev_free
r_static
r_int
id|snd_ymfpci_dev_free
c_func
(paren
id|snd_device_t
op_star
id|device
)paren
(brace
id|ymfpci_t
op_star
id|chip
op_assign
id|snd_magic_cast
c_func
(paren
id|ymfpci_t
comma
id|device-&gt;device_data
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
r_return
id|snd_ymfpci_free
c_func
(paren
id|chip
)paren
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_PM
DECL|variable|saved_regs_index
r_static
r_int
id|saved_regs_index
(braket
)braket
op_assign
(brace
multiline_comment|/* spdif */
id|YDSXGR_SPDIFOUTCTRL
comma
id|YDSXGR_SPDIFOUTSTATUS
comma
id|YDSXGR_SPDIFINCTRL
comma
multiline_comment|/* volumes */
id|YDSXGR_PRIADCLOOPVOL
comma
id|YDSXGR_NATIVEDACINVOL
comma
id|YDSXGR_NATIVEDACOUTVOL
comma
singleline_comment|// YDSXGR_BUF441OUTVOL,
id|YDSXGR_NATIVEADCINVOL
comma
id|YDSXGR_SPDIFLOOPVOL
comma
id|YDSXGR_SPDIFOUTVOL
comma
id|YDSXGR_ZVOUTVOL
comma
multiline_comment|/* address bases */
id|YDSXGR_PLAYCTRLBASE
comma
id|YDSXGR_RECCTRLBASE
comma
id|YDSXGR_EFFCTRLBASE
comma
id|YDSXGR_WORKBASE
comma
multiline_comment|/* capture set up */
id|YDSXGR_MAPOFREC
comma
id|YDSXGR_RECFORMAT
comma
id|YDSXGR_RECSLOTSR
comma
id|YDSXGR_ADCFORMAT
comma
id|YDSXGR_ADCSLOTSR
comma
)brace
suffix:semicolon
DECL|macro|YDSXGR_NUM_SAVED_REGS
mdefine_line|#define YDSXGR_NUM_SAVED_REGS&t;(sizeof(saved_regs_index)/sizeof(saved_regs_index[0]))
DECL|function|snd_ymfpci_suspend
r_void
id|snd_ymfpci_suspend
c_func
(paren
id|ymfpci_t
op_star
id|chip
)paren
(brace
id|snd_card_t
op_star
id|card
op_assign
id|chip-&gt;card
suffix:semicolon
r_int
id|i
suffix:semicolon
id|snd_power_lock
c_func
(paren
id|card
)paren
suffix:semicolon
r_if
c_cond
(paren
id|card-&gt;power_state
op_eq
id|SNDRV_CTL_POWER_D3hot
)paren
r_goto
id|__skip
suffix:semicolon
id|snd_pcm_suspend_all
c_func
(paren
id|chip-&gt;pcm
)paren
suffix:semicolon
id|snd_pcm_suspend_all
c_func
(paren
id|chip-&gt;pcm2
)paren
suffix:semicolon
id|snd_pcm_suspend_all
c_func
(paren
id|chip-&gt;pcm_spdif
)paren
suffix:semicolon
id|snd_pcm_suspend_all
c_func
(paren
id|chip-&gt;pcm_4ch
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|YDSXGR_NUM_SAVED_REGS
suffix:semicolon
id|i
op_increment
)paren
id|chip-&gt;saved_regs
(braket
id|i
)braket
op_assign
id|snd_ymfpci_readl
c_func
(paren
id|chip
comma
id|saved_regs_index
(braket
id|i
)braket
)paren
suffix:semicolon
id|chip-&gt;saved_ydsxgr_mode
op_assign
id|snd_ymfpci_readl
c_func
(paren
id|chip
comma
id|YDSXGR_MODE
)paren
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_NATIVEDACOUTVOL
comma
l_int|0
)paren
suffix:semicolon
id|snd_ymfpci_disable_dsp
c_func
(paren
id|chip
)paren
suffix:semicolon
id|snd_power_change_state
c_func
(paren
id|card
comma
id|SNDRV_CTL_POWER_D3hot
)paren
suffix:semicolon
id|__skip
suffix:colon
id|snd_power_unlock
c_func
(paren
id|card
)paren
suffix:semicolon
)brace
DECL|function|snd_ymfpci_resume
r_void
id|snd_ymfpci_resume
c_func
(paren
id|ymfpci_t
op_star
id|chip
)paren
(brace
id|snd_card_t
op_star
id|card
op_assign
id|chip-&gt;card
suffix:semicolon
r_int
id|i
suffix:semicolon
id|snd_power_lock
c_func
(paren
id|card
)paren
suffix:semicolon
r_if
c_cond
(paren
id|card-&gt;power_state
op_eq
id|SNDRV_CTL_POWER_D0
)paren
r_goto
id|__skip
suffix:semicolon
id|pci_enable_device
c_func
(paren
id|chip-&gt;pci
)paren
suffix:semicolon
id|pci_set_master
c_func
(paren
id|chip-&gt;pci
)paren
suffix:semicolon
id|snd_ymfpci_aclink_reset
c_func
(paren
id|chip-&gt;pci
)paren
suffix:semicolon
id|snd_ymfpci_codec_ready
c_func
(paren
id|chip
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
id|snd_ymfpci_download_image
c_func
(paren
id|chip
)paren
suffix:semicolon
id|udelay
c_func
(paren
l_int|100
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|YDSXGR_NUM_SAVED_REGS
suffix:semicolon
id|i
op_increment
)paren
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|saved_regs_index
(braket
id|i
)braket
comma
id|chip-&gt;saved_regs
(braket
id|i
)braket
)paren
suffix:semicolon
id|snd_ac97_resume
c_func
(paren
id|chip-&gt;ac97
)paren
suffix:semicolon
multiline_comment|/* start hw again */
r_if
c_cond
(paren
id|chip-&gt;start_count
OG
l_int|0
)paren
(brace
id|spin_lock
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
id|snd_ymfpci_writel
c_func
(paren
id|chip
comma
id|YDSXGR_MODE
comma
id|chip-&gt;saved_ydsxgr_mode
)paren
suffix:semicolon
id|chip-&gt;active_bank
op_assign
id|snd_ymfpci_readl
c_func
(paren
id|chip
comma
id|YDSXGR_CTRLSELECT
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
)brace
id|snd_power_change_state
c_func
(paren
id|card
comma
id|SNDRV_CTL_POWER_D0
)paren
suffix:semicolon
id|__skip
suffix:colon
id|snd_power_unlock
c_func
(paren
id|card
)paren
suffix:semicolon
)brace
DECL|function|snd_ymfpci_set_power_state
r_static
r_int
id|snd_ymfpci_set_power_state
c_func
(paren
id|snd_card_t
op_star
id|card
comma
r_int
r_int
id|power_state
)paren
(brace
id|ymfpci_t
op_star
id|chip
op_assign
id|snd_magic_cast
c_func
(paren
id|ymfpci_t
comma
id|card-&gt;power_state_private_data
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|power_state
)paren
(brace
r_case
id|SNDRV_CTL_POWER_D0
suffix:colon
r_case
id|SNDRV_CTL_POWER_D1
suffix:colon
r_case
id|SNDRV_CTL_POWER_D2
suffix:colon
id|snd_ymfpci_resume
c_func
(paren
id|chip
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNDRV_CTL_POWER_D3hot
suffix:colon
r_case
id|SNDRV_CTL_POWER_D3cold
suffix:colon
id|snd_ymfpci_suspend
c_func
(paren
id|chip
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#endif /* CONFIG_PM */
DECL|function|snd_ymfpci_create
r_int
id|__devinit
id|snd_ymfpci_create
c_func
(paren
id|snd_card_t
op_star
id|card
comma
r_struct
id|pci_dev
op_star
id|pci
comma
r_int
r_int
id|old_legacy_ctrl
comma
id|ymfpci_t
op_star
op_star
id|rchip
)paren
(brace
id|ymfpci_t
op_star
id|chip
suffix:semicolon
r_int
id|err
suffix:semicolon
r_static
id|snd_device_ops_t
id|ops
op_assign
(brace
id|dev_free
suffix:colon
id|snd_ymfpci_dev_free
comma
)brace
suffix:semicolon
op_star
id|rchip
op_assign
l_int|NULL
suffix:semicolon
multiline_comment|/* enable PCI device */
r_if
c_cond
(paren
(paren
id|err
op_assign
id|pci_enable_device
c_func
(paren
id|pci
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|chip
op_assign
id|snd_magic_kcalloc
c_func
(paren
id|ymfpci_t
comma
l_int|0
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chip
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|chip-&gt;old_legacy_ctrl
op_assign
id|old_legacy_ctrl
suffix:semicolon
id|spin_lock_init
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
id|spin_lock_init
c_func
(paren
op_amp
id|chip-&gt;voice_lock
)paren
suffix:semicolon
id|init_waitqueue_head
c_func
(paren
op_amp
id|chip-&gt;interrupt_sleep
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|chip-&gt;interrupt_sleep_count
comma
l_int|0
)paren
suffix:semicolon
id|chip-&gt;card
op_assign
id|card
suffix:semicolon
id|chip-&gt;pci
op_assign
id|pci
suffix:semicolon
id|chip-&gt;irq
op_assign
op_minus
l_int|1
suffix:semicolon
id|chip-&gt;device_id
op_assign
id|pci-&gt;device
suffix:semicolon
id|pci_read_config_byte
c_func
(paren
id|pci
comma
id|PCI_REVISION_ID
comma
(paren
id|u8
op_star
)paren
op_amp
id|chip-&gt;rev
)paren
suffix:semicolon
id|chip-&gt;reg_area_phys
op_assign
id|pci_resource_start
c_func
(paren
id|pci
comma
l_int|0
)paren
suffix:semicolon
id|chip-&gt;reg_area_virt
op_assign
(paren
r_int
r_int
)paren
id|ioremap_nocache
c_func
(paren
id|chip-&gt;reg_area_phys
comma
l_int|0x8000
)paren
suffix:semicolon
id|pci_set_master
c_func
(paren
id|pci
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|chip-&gt;res_reg_area
op_assign
id|request_mem_region
c_func
(paren
id|chip-&gt;reg_area_phys
comma
l_int|0x8000
comma
l_string|&quot;YMFPCI&quot;
)paren
)paren
op_eq
l_int|NULL
)paren
(brace
id|snd_ymfpci_free
c_func
(paren
id|chip
)paren
suffix:semicolon
id|snd_printk
c_func
(paren
l_string|&quot;unable to grab memory region 0x%lx-0x%lx&bslash;n&quot;
comma
id|chip-&gt;reg_area_phys
comma
id|chip-&gt;reg_area_phys
op_plus
l_int|0x8000
op_minus
l_int|1
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
r_if
c_cond
(paren
id|request_irq
c_func
(paren
id|pci-&gt;irq
comma
id|snd_ymfpci_interrupt
comma
id|SA_INTERRUPT
op_or
id|SA_SHIRQ
comma
l_string|&quot;YMFPCI&quot;
comma
(paren
r_void
op_star
)paren
id|chip
)paren
)paren
(brace
id|snd_ymfpci_free
c_func
(paren
id|chip
)paren
suffix:semicolon
id|snd_printk
c_func
(paren
l_string|&quot;unable to grab IRQ %d&bslash;n&quot;
comma
id|pci-&gt;irq
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
id|chip-&gt;irq
op_assign
id|pci-&gt;irq
suffix:semicolon
id|snd_ymfpci_aclink_reset
c_func
(paren
id|pci
)paren
suffix:semicolon
r_if
c_cond
(paren
id|snd_ymfpci_codec_ready
c_func
(paren
id|chip
comma
l_int|0
comma
l_int|1
)paren
OL
l_int|0
)paren
(brace
id|snd_ymfpci_free
c_func
(paren
id|chip
)paren
suffix:semicolon
r_return
op_minus
id|EIO
suffix:semicolon
)brace
id|snd_ymfpci_download_image
c_func
(paren
id|chip
)paren
suffix:semicolon
id|udelay
c_func
(paren
l_int|100
)paren
suffix:semicolon
multiline_comment|/* seems we need a delay after downloading image.. */
r_if
c_cond
(paren
id|snd_ymfpci_memalloc
c_func
(paren
id|chip
)paren
OL
l_int|0
)paren
(brace
id|snd_ymfpci_free
c_func
(paren
id|chip
)paren
suffix:semicolon
r_return
op_minus
id|EIO
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_PM
id|chip-&gt;saved_regs
op_assign
id|kmalloc
c_func
(paren
id|YDSXGR_NUM_SAVED_REGS
op_star
r_sizeof
(paren
id|u32
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;saved_regs
op_eq
l_int|NULL
)paren
(brace
id|snd_ymfpci_free
c_func
(paren
id|chip
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|card-&gt;set_power_state
op_assign
id|snd_ymfpci_set_power_state
suffix:semicolon
id|card-&gt;power_state_private_data
op_assign
id|chip
suffix:semicolon
macro_line|#endif
id|snd_ymfpci_proc_init
c_func
(paren
id|card
comma
id|chip
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_device_new
c_func
(paren
id|card
comma
id|SNDRV_DEV_LOWLEVEL
comma
id|chip
comma
op_amp
id|ops
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_ymfpci_free
c_func
(paren
id|chip
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
op_star
id|rchip
op_assign
id|chip
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
eof
