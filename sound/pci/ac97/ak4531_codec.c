multiline_comment|/*&n; *  Copyright (c) by Jaroslav Kysela &lt;perex@suse.cz&gt;&n; *  Universal routines for AK4531 codec&n; *&n; *&n; *   This program is free software; you can redistribute it and/or modify&n; *   it under the terms of the GNU General Public License as published by&n; *   the Free Software Foundation; either version 2 of the License, or&n; *   (at your option) any later version.&n; *&n; *   This program is distributed in the hope that it will be useful,&n; *   but WITHOUT ANY WARRANTY; without even the implied warranty of&n; *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; *   GNU General Public License for more details.&n; *&n; *   You should have received a copy of the GNU General Public License&n; *   along with this program; if not, write to the Free Software&n; *   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA&n; *&n; */
macro_line|#include &lt;sound/driver.h&gt;
macro_line|#include &lt;linux/delay.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;sound/core.h&gt;
macro_line|#include &lt;sound/ak4531_codec.h&gt;
id|MODULE_AUTHOR
c_func
(paren
l_string|&quot;Jaroslav Kysela &lt;perex@suse.cz&gt;&quot;
)paren
suffix:semicolon
id|MODULE_DESCRIPTION
c_func
(paren
l_string|&quot;Universal routines for AK4531 codec&quot;
)paren
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
DECL|macro|chip_t
mdefine_line|#define chip_t ak4531_t
r_static
r_void
id|snd_ak4531_proc_init
c_func
(paren
id|snd_card_t
op_star
id|card
comma
id|ak4531_t
op_star
id|ak4531
)paren
suffix:semicolon
multiline_comment|/*&n; *&n; */
macro_line|#if 0
r_static
r_void
id|snd_ak4531_dump
c_func
(paren
id|ak4531_t
op_star
id|ak4531
)paren
(brace
r_int
id|idx
suffix:semicolon
r_for
c_loop
(paren
id|idx
op_assign
l_int|0
suffix:semicolon
id|idx
OL
l_int|0x19
suffix:semicolon
id|idx
op_increment
)paren
id|printk
c_func
(paren
l_string|&quot;ak4531 0x%x: 0x%x&bslash;n&quot;
comma
id|idx
comma
id|ak4531-&gt;regs
(braket
id|idx
)braket
)paren
suffix:semicolon
)brace
macro_line|#endif
multiline_comment|/*&n; *&n; */
DECL|macro|AK4531_SINGLE
mdefine_line|#define AK4531_SINGLE(xname, xindex, reg, shift, mask, invert) &bslash;&n;{ .iface = SNDRV_CTL_ELEM_IFACE_MIXER, .name = xname, .index = xindex, &bslash;&n;  .info = snd_ak4531_info_single, &bslash;&n;  .get = snd_ak4531_get_single, .put = snd_ak4531_put_single, &bslash;&n;  .private_value = reg | (shift &lt;&lt; 16) | (mask &lt;&lt; 24) | (invert &lt;&lt; 22) }
DECL|function|snd_ak4531_info_single
r_static
r_int
id|snd_ak4531_info_single
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
r_int
id|mask
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|24
)paren
op_amp
l_int|0xff
suffix:semicolon
id|uinfo-&gt;type
op_assign
id|mask
op_eq
l_int|1
ques
c_cond
id|SNDRV_CTL_ELEM_TYPE_BOOLEAN
suffix:colon
id|SNDRV_CTL_ELEM_TYPE_INTEGER
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
id|uinfo-&gt;value.integer.min
op_assign
l_int|0
suffix:semicolon
id|uinfo-&gt;value.integer.max
op_assign
id|mask
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ak4531_get_single
r_static
r_int
id|snd_ak4531_get_single
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|ak4531_t
op_star
id|ak4531
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
id|reg
op_assign
id|kcontrol-&gt;private_value
op_amp
l_int|0xff
suffix:semicolon
r_int
id|shift
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|16
)paren
op_amp
l_int|0x07
suffix:semicolon
r_int
id|mask
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|24
)paren
op_amp
l_int|0xff
suffix:semicolon
r_int
id|invert
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|22
)paren
op_amp
l_int|1
suffix:semicolon
r_int
id|val
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|ak4531-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
id|val
op_assign
(paren
id|ak4531-&gt;regs
(braket
id|reg
)braket
op_rshift
id|shift
)paren
op_amp
id|mask
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|ak4531-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|invert
)paren
(brace
id|val
op_assign
id|mask
op_minus
id|val
suffix:semicolon
)brace
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
id|val
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ak4531_put_single
r_static
r_int
id|snd_ak4531_put_single
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|ak4531_t
op_star
id|ak4531
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
id|reg
op_assign
id|kcontrol-&gt;private_value
op_amp
l_int|0xff
suffix:semicolon
r_int
id|shift
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|16
)paren
op_amp
l_int|0x07
suffix:semicolon
r_int
id|mask
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|24
)paren
op_amp
l_int|0xff
suffix:semicolon
r_int
id|invert
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|22
)paren
op_amp
l_int|1
suffix:semicolon
r_int
id|change
suffix:semicolon
r_int
id|val
suffix:semicolon
id|val
op_assign
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_amp
id|mask
suffix:semicolon
r_if
c_cond
(paren
id|invert
)paren
(brace
id|val
op_assign
id|mask
op_minus
id|val
suffix:semicolon
)brace
id|val
op_lshift_assign
id|shift
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|ak4531-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
id|val
op_assign
(paren
id|ak4531-&gt;regs
(braket
id|reg
)braket
op_amp
op_complement
(paren
id|mask
op_lshift
id|shift
)paren
)paren
op_or
id|val
suffix:semicolon
id|change
op_assign
id|val
op_ne
id|ak4531-&gt;regs
(braket
id|reg
)braket
suffix:semicolon
id|ak4531
op_member_access_from_pointer
id|write
c_func
(paren
id|ak4531
comma
id|reg
comma
id|ak4531-&gt;regs
(braket
id|reg
)braket
op_assign
id|val
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|ak4531-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
r_return
id|change
suffix:semicolon
)brace
DECL|macro|AK4531_DOUBLE
mdefine_line|#define AK4531_DOUBLE(xname, xindex, left_reg, right_reg, left_shift, right_shift, mask, invert) &bslash;&n;{ .iface = SNDRV_CTL_ELEM_IFACE_MIXER, .name = xname, .index = xindex, &bslash;&n;  .info = snd_ak4531_info_double, &bslash;&n;  .get = snd_ak4531_get_double, .put = snd_ak4531_put_double, &bslash;&n;  .private_value = left_reg | (right_reg &lt;&lt; 8) | (left_shift &lt;&lt; 16) | (right_shift &lt;&lt; 19) | (mask &lt;&lt; 24) | (invert &lt;&lt; 22) }
DECL|function|snd_ak4531_info_double
r_static
r_int
id|snd_ak4531_info_double
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
r_int
id|mask
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|24
)paren
op_amp
l_int|0xff
suffix:semicolon
id|uinfo-&gt;type
op_assign
id|mask
op_eq
l_int|1
ques
c_cond
id|SNDRV_CTL_ELEM_TYPE_BOOLEAN
suffix:colon
id|SNDRV_CTL_ELEM_TYPE_INTEGER
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|2
suffix:semicolon
id|uinfo-&gt;value.integer.min
op_assign
l_int|0
suffix:semicolon
id|uinfo-&gt;value.integer.max
op_assign
id|mask
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ak4531_get_double
r_static
r_int
id|snd_ak4531_get_double
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|ak4531_t
op_star
id|ak4531
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
id|left_reg
op_assign
id|kcontrol-&gt;private_value
op_amp
l_int|0xff
suffix:semicolon
r_int
id|right_reg
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
suffix:semicolon
r_int
id|left_shift
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|16
)paren
op_amp
l_int|0x07
suffix:semicolon
r_int
id|right_shift
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|19
)paren
op_amp
l_int|0x07
suffix:semicolon
r_int
id|mask
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|24
)paren
op_amp
l_int|0xff
suffix:semicolon
r_int
id|invert
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|22
)paren
op_amp
l_int|1
suffix:semicolon
r_int
id|left
comma
id|right
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|ak4531-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
id|left
op_assign
(paren
id|ak4531-&gt;regs
(braket
id|left_reg
)braket
op_rshift
id|left_shift
)paren
op_amp
id|mask
suffix:semicolon
id|right
op_assign
(paren
id|ak4531-&gt;regs
(braket
id|right_reg
)braket
op_rshift
id|right_shift
)paren
op_amp
id|mask
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|ak4531-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|invert
)paren
(brace
id|left
op_assign
id|mask
op_minus
id|left
suffix:semicolon
id|right
op_assign
id|mask
op_minus
id|right
suffix:semicolon
)brace
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
id|left
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|1
)braket
op_assign
id|right
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ak4531_put_double
r_static
r_int
id|snd_ak4531_put_double
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|ak4531_t
op_star
id|ak4531
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
id|left_reg
op_assign
id|kcontrol-&gt;private_value
op_amp
l_int|0xff
suffix:semicolon
r_int
id|right_reg
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
suffix:semicolon
r_int
id|left_shift
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|16
)paren
op_amp
l_int|0x07
suffix:semicolon
r_int
id|right_shift
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|19
)paren
op_amp
l_int|0x07
suffix:semicolon
r_int
id|mask
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|24
)paren
op_amp
l_int|0xff
suffix:semicolon
r_int
id|invert
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|22
)paren
op_amp
l_int|1
suffix:semicolon
r_int
id|change
suffix:semicolon
r_int
id|left
comma
id|right
suffix:semicolon
id|left
op_assign
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_amp
id|mask
suffix:semicolon
id|right
op_assign
id|ucontrol-&gt;value.integer.value
(braket
l_int|1
)braket
op_amp
id|mask
suffix:semicolon
r_if
c_cond
(paren
id|invert
)paren
(brace
id|left
op_assign
id|mask
op_minus
id|left
suffix:semicolon
id|right
op_assign
id|mask
op_minus
id|right
suffix:semicolon
)brace
id|left
op_lshift_assign
id|left_shift
suffix:semicolon
id|right
op_lshift_assign
id|right_shift
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|ak4531-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|left_reg
op_eq
id|right_reg
)paren
(brace
id|left
op_assign
(paren
id|ak4531-&gt;regs
(braket
id|left_reg
)braket
op_amp
op_complement
(paren
(paren
id|mask
op_lshift
id|left_shift
)paren
op_or
(paren
id|mask
op_lshift
id|right_shift
)paren
)paren
)paren
op_or
id|left
op_or
id|right
suffix:semicolon
id|change
op_assign
id|left
op_ne
id|ak4531-&gt;regs
(braket
id|left_reg
)braket
suffix:semicolon
id|ak4531
op_member_access_from_pointer
id|write
c_func
(paren
id|ak4531
comma
id|left_reg
comma
id|ak4531-&gt;regs
(braket
id|left_reg
)braket
op_assign
id|left
)paren
suffix:semicolon
)brace
r_else
(brace
id|left
op_assign
(paren
id|ak4531-&gt;regs
(braket
id|left_reg
)braket
op_amp
op_complement
(paren
id|mask
op_lshift
id|left_shift
)paren
)paren
op_or
id|left
suffix:semicolon
id|right
op_assign
(paren
id|ak4531-&gt;regs
(braket
id|right_reg
)braket
op_amp
op_complement
(paren
id|mask
op_lshift
id|right_shift
)paren
)paren
op_or
id|right
suffix:semicolon
id|change
op_assign
id|left
op_ne
id|ak4531-&gt;regs
(braket
id|left_reg
)braket
op_logical_or
id|right
op_ne
id|ak4531-&gt;regs
(braket
id|right_reg
)braket
suffix:semicolon
id|ak4531
op_member_access_from_pointer
id|write
c_func
(paren
id|ak4531
comma
id|left_reg
comma
id|ak4531-&gt;regs
(braket
id|left_reg
)braket
op_assign
id|left
)paren
suffix:semicolon
id|ak4531
op_member_access_from_pointer
id|write
c_func
(paren
id|ak4531
comma
id|right_reg
comma
id|ak4531-&gt;regs
(braket
id|right_reg
)braket
op_assign
id|right
)paren
suffix:semicolon
)brace
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|ak4531-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
r_return
id|change
suffix:semicolon
)brace
DECL|macro|AK4531_INPUT_SW
mdefine_line|#define AK4531_INPUT_SW(xname, xindex, reg1, reg2, left_shift, right_shift) &bslash;&n;{ .iface = SNDRV_CTL_ELEM_IFACE_MIXER, .name = xname, .index = xindex, &bslash;&n;  .info = snd_ak4531_info_input_sw, &bslash;&n;  .get = snd_ak4531_get_input_sw, .put = snd_ak4531_put_input_sw, &bslash;&n;  .private_value = reg1 | (reg2 &lt;&lt; 8) | (left_shift &lt;&lt; 16) | (right_shift &lt;&lt; 24) }
DECL|function|snd_ak4531_info_input_sw
r_static
r_int
id|snd_ak4531_info_input_sw
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_BOOLEAN
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|4
suffix:semicolon
id|uinfo-&gt;value.integer.min
op_assign
l_int|0
suffix:semicolon
id|uinfo-&gt;value.integer.max
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ak4531_get_input_sw
r_static
r_int
id|snd_ak4531_get_input_sw
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|ak4531_t
op_star
id|ak4531
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
id|reg1
op_assign
id|kcontrol-&gt;private_value
op_amp
l_int|0xff
suffix:semicolon
r_int
id|reg2
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
suffix:semicolon
r_int
id|left_shift
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|16
)paren
op_amp
l_int|0x0f
suffix:semicolon
r_int
id|right_shift
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|24
)paren
op_amp
l_int|0x0f
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|ak4531-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
(paren
id|ak4531-&gt;regs
(braket
id|reg1
)braket
op_rshift
id|left_shift
)paren
op_amp
l_int|1
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|1
)braket
op_assign
(paren
id|ak4531-&gt;regs
(braket
id|reg2
)braket
op_rshift
id|left_shift
)paren
op_amp
l_int|1
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|2
)braket
op_assign
(paren
id|ak4531-&gt;regs
(braket
id|reg1
)braket
op_rshift
id|right_shift
)paren
op_amp
l_int|1
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|3
)braket
op_assign
(paren
id|ak4531-&gt;regs
(braket
id|reg2
)braket
op_rshift
id|right_shift
)paren
op_amp
l_int|1
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|ak4531-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ak4531_put_input_sw
r_static
r_int
id|snd_ak4531_put_input_sw
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|ak4531_t
op_star
id|ak4531
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
id|reg1
op_assign
id|kcontrol-&gt;private_value
op_amp
l_int|0xff
suffix:semicolon
r_int
id|reg2
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
suffix:semicolon
r_int
id|left_shift
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|16
)paren
op_amp
l_int|0x0f
suffix:semicolon
r_int
id|right_shift
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|24
)paren
op_amp
l_int|0x0f
suffix:semicolon
r_int
id|change
suffix:semicolon
r_int
id|val1
comma
id|val2
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|ak4531-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
id|val1
op_assign
id|ak4531-&gt;regs
(braket
id|reg1
)braket
op_amp
op_complement
(paren
(paren
l_int|1
op_lshift
id|left_shift
)paren
op_or
(paren
l_int|1
op_lshift
id|right_shift
)paren
)paren
suffix:semicolon
id|val2
op_assign
id|ak4531-&gt;regs
(braket
id|reg2
)braket
op_amp
op_complement
(paren
(paren
l_int|1
op_lshift
id|left_shift
)paren
op_or
(paren
l_int|1
op_lshift
id|right_shift
)paren
)paren
suffix:semicolon
id|val1
op_or_assign
(paren
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_amp
l_int|1
)paren
op_lshift
id|left_shift
suffix:semicolon
id|val2
op_or_assign
(paren
id|ucontrol-&gt;value.integer.value
(braket
l_int|1
)braket
op_amp
l_int|1
)paren
op_lshift
id|left_shift
suffix:semicolon
id|val1
op_or_assign
(paren
id|ucontrol-&gt;value.integer.value
(braket
l_int|2
)braket
op_amp
l_int|1
)paren
op_lshift
id|right_shift
suffix:semicolon
id|val2
op_or_assign
(paren
id|ucontrol-&gt;value.integer.value
(braket
l_int|3
)braket
op_amp
l_int|1
)paren
op_lshift
id|right_shift
suffix:semicolon
id|change
op_assign
id|val1
op_ne
id|ak4531-&gt;regs
(braket
id|reg1
)braket
op_logical_or
id|val2
op_ne
id|ak4531-&gt;regs
(braket
id|reg2
)braket
suffix:semicolon
id|ak4531
op_member_access_from_pointer
id|write
c_func
(paren
id|ak4531
comma
id|reg1
comma
id|ak4531-&gt;regs
(braket
id|reg1
)braket
op_assign
id|val1
)paren
suffix:semicolon
id|ak4531
op_member_access_from_pointer
id|write
c_func
(paren
id|ak4531
comma
id|reg2
comma
id|ak4531-&gt;regs
(braket
id|reg2
)braket
op_assign
id|val2
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|ak4531-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
r_return
id|change
suffix:semicolon
)brace
DECL|macro|AK4531_CONTROLS
mdefine_line|#define AK4531_CONTROLS (sizeof(snd_ak4531_controls)/sizeof(snd_kcontrol_new_t))
DECL|variable|snd_ak4531_controls
r_static
id|snd_kcontrol_new_t
id|snd_ak4531_controls
(braket
)braket
op_assign
(brace
id|AK4531_DOUBLE
c_func
(paren
l_string|&quot;Master Playback Switch&quot;
comma
l_int|0
comma
id|AK4531_LMASTER
comma
id|AK4531_RMASTER
comma
l_int|7
comma
l_int|7
comma
l_int|1
comma
l_int|1
)paren
comma
id|AK4531_DOUBLE
c_func
(paren
l_string|&quot;Master Playback Volume&quot;
comma
l_int|0
comma
id|AK4531_LMASTER
comma
id|AK4531_RMASTER
comma
l_int|0
comma
l_int|0
comma
l_int|0x1f
comma
l_int|1
)paren
comma
id|AK4531_SINGLE
c_func
(paren
l_string|&quot;Master Mono Playback Switch&quot;
comma
l_int|0
comma
id|AK4531_MONO_OUT
comma
l_int|7
comma
l_int|1
comma
l_int|1
)paren
comma
id|AK4531_SINGLE
c_func
(paren
l_string|&quot;Master Mono Playback Volume&quot;
comma
l_int|0
comma
id|AK4531_MONO_OUT
comma
l_int|0
comma
l_int|0x07
comma
l_int|1
)paren
comma
id|AK4531_DOUBLE
c_func
(paren
l_string|&quot;PCM Switch&quot;
comma
l_int|0
comma
id|AK4531_LVOICE
comma
id|AK4531_RVOICE
comma
l_int|7
comma
l_int|7
comma
l_int|1
comma
l_int|1
)paren
comma
id|AK4531_DOUBLE
c_func
(paren
l_string|&quot;PCM Volume&quot;
comma
l_int|0
comma
id|AK4531_LVOICE
comma
id|AK4531_RVOICE
comma
l_int|0
comma
l_int|0
comma
l_int|0x1f
comma
l_int|1
)paren
comma
id|AK4531_DOUBLE
c_func
(paren
l_string|&quot;PCM Playback Switch&quot;
comma
l_int|0
comma
id|AK4531_OUT_SW2
comma
id|AK4531_OUT_SW2
comma
l_int|3
comma
l_int|2
comma
l_int|1
comma
l_int|0
)paren
comma
id|AK4531_DOUBLE
c_func
(paren
l_string|&quot;PCM Capture Switch&quot;
comma
l_int|0
comma
id|AK4531_LIN_SW2
comma
id|AK4531_RIN_SW2
comma
l_int|2
comma
l_int|2
comma
l_int|1
comma
l_int|0
)paren
comma
id|AK4531_DOUBLE
c_func
(paren
l_string|&quot;PCM Switch&quot;
comma
l_int|1
comma
id|AK4531_LFM
comma
id|AK4531_RFM
comma
l_int|7
comma
l_int|7
comma
l_int|1
comma
l_int|1
)paren
comma
id|AK4531_DOUBLE
c_func
(paren
l_string|&quot;PCM Volume&quot;
comma
l_int|1
comma
id|AK4531_LFM
comma
id|AK4531_RFM
comma
l_int|0
comma
l_int|0
comma
l_int|0x1f
comma
l_int|1
)paren
comma
id|AK4531_DOUBLE
c_func
(paren
l_string|&quot;PCM Playback Switch&quot;
comma
l_int|1
comma
id|AK4531_OUT_SW1
comma
id|AK4531_OUT_SW1
comma
l_int|6
comma
l_int|5
comma
l_int|1
comma
l_int|0
)paren
comma
id|AK4531_INPUT_SW
c_func
(paren
l_string|&quot;PCM Capture Route&quot;
comma
l_int|1
comma
id|AK4531_LIN_SW1
comma
id|AK4531_RIN_SW1
comma
l_int|6
comma
l_int|5
)paren
comma
id|AK4531_DOUBLE
c_func
(paren
l_string|&quot;CD Switch&quot;
comma
l_int|0
comma
id|AK4531_LCD
comma
id|AK4531_RCD
comma
l_int|7
comma
l_int|7
comma
l_int|1
comma
l_int|1
)paren
comma
id|AK4531_DOUBLE
c_func
(paren
l_string|&quot;CD Volume&quot;
comma
l_int|0
comma
id|AK4531_LCD
comma
id|AK4531_RCD
comma
l_int|0
comma
l_int|0
comma
l_int|0x1f
comma
l_int|1
)paren
comma
id|AK4531_DOUBLE
c_func
(paren
l_string|&quot;CD Playback Switch&quot;
comma
l_int|0
comma
id|AK4531_OUT_SW1
comma
id|AK4531_OUT_SW1
comma
l_int|2
comma
l_int|1
comma
l_int|1
comma
l_int|0
)paren
comma
id|AK4531_INPUT_SW
c_func
(paren
l_string|&quot;CD Capture Route&quot;
comma
l_int|0
comma
id|AK4531_LIN_SW1
comma
id|AK4531_RIN_SW1
comma
l_int|2
comma
l_int|1
)paren
comma
id|AK4531_DOUBLE
c_func
(paren
l_string|&quot;Line Switch&quot;
comma
l_int|0
comma
id|AK4531_LLINE
comma
id|AK4531_RLINE
comma
l_int|7
comma
l_int|7
comma
l_int|1
comma
l_int|1
)paren
comma
id|AK4531_DOUBLE
c_func
(paren
l_string|&quot;Line Volume&quot;
comma
l_int|0
comma
id|AK4531_LLINE
comma
id|AK4531_RLINE
comma
l_int|0
comma
l_int|0
comma
l_int|0x1f
comma
l_int|1
)paren
comma
id|AK4531_DOUBLE
c_func
(paren
l_string|&quot;Line Playback Switch&quot;
comma
l_int|0
comma
id|AK4531_OUT_SW1
comma
id|AK4531_OUT_SW1
comma
l_int|4
comma
l_int|3
comma
l_int|1
comma
l_int|0
)paren
comma
id|AK4531_INPUT_SW
c_func
(paren
l_string|&quot;Line Capture Route&quot;
comma
l_int|0
comma
id|AK4531_LIN_SW1
comma
id|AK4531_RIN_SW1
comma
l_int|4
comma
l_int|3
)paren
comma
id|AK4531_DOUBLE
c_func
(paren
l_string|&quot;Aux Switch&quot;
comma
l_int|0
comma
id|AK4531_LAUXA
comma
id|AK4531_RAUXA
comma
l_int|7
comma
l_int|7
comma
l_int|1
comma
l_int|1
)paren
comma
id|AK4531_DOUBLE
c_func
(paren
l_string|&quot;Aux Volume&quot;
comma
l_int|0
comma
id|AK4531_LAUXA
comma
id|AK4531_RAUXA
comma
l_int|0
comma
l_int|0
comma
l_int|0x1f
comma
l_int|1
)paren
comma
id|AK4531_DOUBLE
c_func
(paren
l_string|&quot;Aux Playback Switch&quot;
comma
l_int|0
comma
id|AK4531_OUT_SW2
comma
id|AK4531_OUT_SW2
comma
l_int|5
comma
l_int|4
comma
l_int|1
comma
l_int|0
)paren
comma
id|AK4531_INPUT_SW
c_func
(paren
l_string|&quot;Aux Input Route&quot;
comma
l_int|0
comma
id|AK4531_LIN_SW2
comma
id|AK4531_RIN_SW2
comma
l_int|4
comma
l_int|3
)paren
comma
id|AK4531_SINGLE
c_func
(paren
l_string|&quot;Mono Switch&quot;
comma
l_int|0
comma
id|AK4531_MONO1
comma
l_int|7
comma
l_int|1
comma
l_int|1
)paren
comma
id|AK4531_SINGLE
c_func
(paren
l_string|&quot;Mono Volume&quot;
comma
l_int|0
comma
id|AK4531_MONO1
comma
l_int|0
comma
l_int|0x1f
comma
l_int|1
)paren
comma
id|AK4531_SINGLE
c_func
(paren
l_string|&quot;Mono Playback Switch&quot;
comma
l_int|0
comma
id|AK4531_OUT_SW2
comma
l_int|0
comma
l_int|1
comma
l_int|0
)paren
comma
id|AK4531_DOUBLE
c_func
(paren
l_string|&quot;Mono Capture Switch&quot;
comma
l_int|0
comma
id|AK4531_LIN_SW2
comma
id|AK4531_RIN_SW2
comma
l_int|0
comma
l_int|0
comma
l_int|1
comma
l_int|0
)paren
comma
id|AK4531_SINGLE
c_func
(paren
l_string|&quot;Mono Switch&quot;
comma
l_int|1
comma
id|AK4531_MONO2
comma
l_int|7
comma
l_int|1
comma
l_int|1
)paren
comma
id|AK4531_SINGLE
c_func
(paren
l_string|&quot;Mono Volume&quot;
comma
l_int|1
comma
id|AK4531_MONO2
comma
l_int|0
comma
l_int|0x1f
comma
l_int|1
)paren
comma
id|AK4531_SINGLE
c_func
(paren
l_string|&quot;Mono Playback Switch&quot;
comma
l_int|1
comma
id|AK4531_OUT_SW2
comma
l_int|1
comma
l_int|1
comma
l_int|0
)paren
comma
id|AK4531_DOUBLE
c_func
(paren
l_string|&quot;Mono Capture Switch&quot;
comma
l_int|1
comma
id|AK4531_LIN_SW2
comma
id|AK4531_RIN_SW2
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|0
)paren
comma
id|AK4531_SINGLE
c_func
(paren
l_string|&quot;Mic Volume&quot;
comma
l_int|0
comma
id|AK4531_MIC
comma
l_int|0
comma
l_int|0x1f
comma
l_int|1
)paren
comma
id|AK4531_SINGLE
c_func
(paren
l_string|&quot;Mic Switch&quot;
comma
l_int|0
comma
id|AK4531_MIC
comma
l_int|7
comma
l_int|1
comma
l_int|1
)paren
comma
id|AK4531_SINGLE
c_func
(paren
l_string|&quot;Mic Playback Switch&quot;
comma
l_int|0
comma
id|AK4531_OUT_SW1
comma
l_int|0
comma
l_int|1
comma
l_int|0
)paren
comma
id|AK4531_DOUBLE
c_func
(paren
l_string|&quot;Mic Capture Switch&quot;
comma
l_int|0
comma
id|AK4531_LIN_SW1
comma
id|AK4531_RIN_SW1
comma
l_int|0
comma
l_int|0
comma
l_int|1
comma
l_int|0
)paren
comma
id|AK4531_DOUBLE
c_func
(paren
l_string|&quot;Mic Bypass Capture Switch&quot;
comma
l_int|0
comma
id|AK4531_LIN_SW2
comma
id|AK4531_RIN_SW2
comma
l_int|7
comma
l_int|7
comma
l_int|1
comma
l_int|0
)paren
comma
id|AK4531_DOUBLE
c_func
(paren
l_string|&quot;Mono1 Bypass Capture Switch&quot;
comma
l_int|0
comma
id|AK4531_LIN_SW2
comma
id|AK4531_RIN_SW2
comma
l_int|6
comma
l_int|6
comma
l_int|1
comma
l_int|0
)paren
comma
id|AK4531_DOUBLE
c_func
(paren
l_string|&quot;Mono2 Bypass Capture Switch&quot;
comma
l_int|0
comma
id|AK4531_LIN_SW2
comma
id|AK4531_RIN_SW2
comma
l_int|5
comma
l_int|5
comma
l_int|1
comma
l_int|0
)paren
comma
id|AK4531_SINGLE
c_func
(paren
l_string|&quot;AD Input Select&quot;
comma
l_int|0
comma
id|AK4531_AD_IN
comma
l_int|0
comma
l_int|1
comma
l_int|0
)paren
comma
id|AK4531_SINGLE
c_func
(paren
l_string|&quot;Mic Boost (+30dB)&quot;
comma
l_int|0
comma
id|AK4531_MIC_GAIN
comma
l_int|0
comma
l_int|1
comma
l_int|0
)paren
)brace
suffix:semicolon
DECL|function|snd_ak4531_free
r_static
r_int
id|snd_ak4531_free
c_func
(paren
id|ak4531_t
op_star
id|ak4531
)paren
(brace
r_if
c_cond
(paren
id|ak4531
)paren
(brace
r_if
c_cond
(paren
id|ak4531-&gt;private_free
)paren
id|ak4531
op_member_access_from_pointer
id|private_free
c_func
(paren
id|ak4531
)paren
suffix:semicolon
id|snd_magic_kfree
c_func
(paren
id|ak4531
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ak4531_dev_free
r_static
r_int
id|snd_ak4531_dev_free
c_func
(paren
id|snd_device_t
op_star
id|device
)paren
(brace
id|ak4531_t
op_star
id|ak4531
op_assign
id|snd_magic_cast
c_func
(paren
id|ak4531_t
comma
id|device-&gt;device_data
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
r_return
id|snd_ak4531_free
c_func
(paren
id|ak4531
)paren
suffix:semicolon
)brace
DECL|variable|snd_ak4531_initial_map
r_static
id|u8
id|snd_ak4531_initial_map
(braket
l_int|0x19
op_plus
l_int|1
)braket
op_assign
(brace
l_int|0x9f
comma
multiline_comment|/* 00: Master Volume Lch */
l_int|0x9f
comma
multiline_comment|/* 01: Master Volume Rch */
l_int|0x9f
comma
multiline_comment|/* 02: Voice Volume Lch */
l_int|0x9f
comma
multiline_comment|/* 03: Voice Volume Rch */
l_int|0x9f
comma
multiline_comment|/* 04: FM Volume Lch */
l_int|0x9f
comma
multiline_comment|/* 05: FM Volume Rch */
l_int|0x9f
comma
multiline_comment|/* 06: CD Audio Volume Lch */
l_int|0x9f
comma
multiline_comment|/* 07: CD Audio Volume Rch */
l_int|0x9f
comma
multiline_comment|/* 08: Line Volume Lch */
l_int|0x9f
comma
multiline_comment|/* 09: Line Volume Rch */
l_int|0x9f
comma
multiline_comment|/* 0a: Aux Volume Lch */
l_int|0x9f
comma
multiline_comment|/* 0b: Aux Volume Rch */
l_int|0x9f
comma
multiline_comment|/* 0c: Mono1 Volume */
l_int|0x9f
comma
multiline_comment|/* 0d: Mono2 Volume */
l_int|0x9f
comma
multiline_comment|/* 0e: Mic Volume */
l_int|0x87
comma
multiline_comment|/* 0f: Mono-out Volume */
l_int|0x00
comma
multiline_comment|/* 10: Output Mixer SW1 */
l_int|0x00
comma
multiline_comment|/* 11: Output Mixer SW2 */
l_int|0x00
comma
multiline_comment|/* 12: Lch Input Mixer SW1 */
l_int|0x00
comma
multiline_comment|/* 13: Rch Input Mixer SW1 */
l_int|0x00
comma
multiline_comment|/* 14: Lch Input Mixer SW2 */
l_int|0x00
comma
multiline_comment|/* 15: Rch Input Mixer SW2 */
l_int|0x00
comma
multiline_comment|/* 16: Reset &amp; Power Down */
l_int|0x00
comma
multiline_comment|/* 17: Clock Select */
l_int|0x00
comma
multiline_comment|/* 18: AD Input Select */
l_int|0x01
multiline_comment|/* 19: Mic Amp Setup */
)brace
suffix:semicolon
DECL|function|snd_ak4531_mixer
r_int
id|snd_ak4531_mixer
c_func
(paren
id|snd_card_t
op_star
id|card
comma
id|ak4531_t
op_star
id|_ak4531
comma
id|ak4531_t
op_star
op_star
id|rak4531
)paren
(brace
r_int
id|idx
comma
id|err
suffix:semicolon
id|ak4531_t
op_star
id|ak4531
suffix:semicolon
r_static
id|snd_device_ops_t
id|ops
op_assign
(brace
dot
id|dev_free
op_assign
id|snd_ak4531_dev_free
comma
)brace
suffix:semicolon
id|snd_assert
c_func
(paren
id|rak4531
op_ne
l_int|NULL
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
op_star
id|rak4531
op_assign
l_int|NULL
suffix:semicolon
id|snd_assert
c_func
(paren
id|card
op_ne
l_int|NULL
op_logical_and
id|_ak4531
op_ne
l_int|NULL
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|ak4531
op_assign
id|snd_magic_kcalloc
c_func
(paren
id|ak4531_t
comma
l_int|0
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ak4531
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
op_star
id|ak4531
op_assign
op_star
id|_ak4531
suffix:semicolon
id|spin_lock_init
c_func
(paren
op_amp
id|ak4531-&gt;reg_lock
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_component_add
c_func
(paren
id|card
comma
l_string|&quot;AK4531&quot;
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_ak4531_free
c_func
(paren
id|ak4531
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
id|strcpy
c_func
(paren
id|card-&gt;mixername
comma
l_string|&quot;Asahi Kasei AK4531&quot;
)paren
suffix:semicolon
id|ak4531
op_member_access_from_pointer
id|write
c_func
(paren
id|ak4531
comma
id|AK4531_RESET
comma
l_int|0x03
)paren
suffix:semicolon
multiline_comment|/* no RST, PD */
id|udelay
c_func
(paren
l_int|100
)paren
suffix:semicolon
id|ak4531
op_member_access_from_pointer
id|write
c_func
(paren
id|ak4531
comma
id|AK4531_CLOCK
comma
l_int|0x00
)paren
suffix:semicolon
multiline_comment|/* CODEC ADC and CODEC DAC use {LR,B}CLK2 and run off LRCLK2 PLL */
r_for
c_loop
(paren
id|idx
op_assign
l_int|0
suffix:semicolon
id|idx
OL
l_int|0x19
suffix:semicolon
id|idx
op_increment
)paren
(brace
r_if
c_cond
(paren
id|idx
op_eq
id|AK4531_RESET
op_logical_or
id|idx
op_eq
id|AK4531_CLOCK
)paren
r_continue
suffix:semicolon
id|ak4531
op_member_access_from_pointer
id|write
c_func
(paren
id|ak4531
comma
id|idx
comma
id|ak4531-&gt;regs
(braket
id|idx
)braket
op_assign
id|snd_ak4531_initial_map
(braket
id|idx
)braket
)paren
suffix:semicolon
multiline_comment|/* recording source is mixer */
)brace
r_for
c_loop
(paren
id|idx
op_assign
l_int|0
suffix:semicolon
id|idx
OL
id|AK4531_CONTROLS
suffix:semicolon
id|idx
op_increment
)paren
(brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|card
comma
id|snd_ctl_new1
c_func
(paren
op_amp
id|snd_ak4531_controls
(braket
id|idx
)braket
comma
id|ak4531
)paren
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_ak4531_free
c_func
(paren
id|ak4531
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
)brace
id|snd_ak4531_proc_init
c_func
(paren
id|card
comma
id|ak4531
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_device_new
c_func
(paren
id|card
comma
id|SNDRV_DEV_LOWLEVEL
comma
id|ak4531
comma
op_amp
id|ops
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_ak4531_free
c_func
(paren
id|ak4531
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
macro_line|#if 0
id|snd_ak4531_dump
c_func
(paren
id|ak4531
)paren
suffix:semicolon
macro_line|#endif
op_star
id|rak4531
op_assign
id|ak4531
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n;&n; */
DECL|function|snd_ak4531_proc_read
r_static
r_void
id|snd_ak4531_proc_read
c_func
(paren
id|snd_info_entry_t
op_star
id|entry
comma
id|snd_info_buffer_t
op_star
id|buffer
)paren
(brace
id|ak4531_t
op_star
id|ak4531
op_assign
id|snd_magic_cast
c_func
(paren
id|ak4531_t
comma
id|entry-&gt;private_data
comma
r_return
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Asahi Kasei AK4531&bslash;n&bslash;n&quot;
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Recording source   : %s&bslash;n&quot;
l_string|&quot;MIC gain           : %s&bslash;n&quot;
comma
id|ak4531-&gt;regs
(braket
id|AK4531_AD_IN
)braket
op_amp
l_int|1
ques
c_cond
l_string|&quot;external&quot;
suffix:colon
l_string|&quot;mixer&quot;
comma
id|ak4531-&gt;regs
(braket
id|AK4531_MIC_GAIN
)braket
op_amp
l_int|1
ques
c_cond
l_string|&quot;+30dB&quot;
suffix:colon
l_string|&quot;+0dB&quot;
)paren
suffix:semicolon
)brace
DECL|function|snd_ak4531_proc_init
r_static
r_void
id|snd_ak4531_proc_init
c_func
(paren
id|snd_card_t
op_star
id|card
comma
id|ak4531_t
op_star
id|ak4531
)paren
(brace
id|snd_info_entry_t
op_star
id|entry
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snd_card_proc_new
c_func
(paren
id|card
comma
l_string|&quot;ak4531&quot;
comma
op_amp
id|entry
)paren
)paren
id|snd_info_set_text_ops
c_func
(paren
id|entry
comma
id|ak4531
comma
id|snd_ak4531_proc_read
)paren
suffix:semicolon
)brace
DECL|variable|snd_ak4531_mixer
id|EXPORT_SYMBOL
c_func
(paren
id|snd_ak4531_mixer
)paren
suffix:semicolon
multiline_comment|/*&n; *  INIT part&n; */
DECL|function|alsa_ak4531_init
r_static
r_int
id|__init
id|alsa_ak4531_init
c_func
(paren
r_void
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|alsa_ak4531_exit
r_static
r_void
id|__exit
id|alsa_ak4531_exit
c_func
(paren
r_void
)paren
(brace
)brace
id|module_init
c_func
(paren
id|alsa_ak4531_init
)paren
id|module_exit
c_func
(paren
id|alsa_ak4531_exit
)paren
eof
