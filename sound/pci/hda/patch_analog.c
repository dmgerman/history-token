multiline_comment|/*&n; * HD audio interface patch for AD1986A&n; *&n; * Copyright (c) 2005 Takashi Iwai &lt;tiwai@suse.de&gt;&n; *&n; *  This driver is free software; you can redistribute it and/or modify&n; *  it under the terms of the GNU General Public License as published by&n; *  the Free Software Foundation; either version 2 of the License, or&n; *  (at your option) any later version.&n; *&n; *  This driver is distributed in the hope that it will be useful,&n; *  but WITHOUT ANY WARRANTY; without even the implied warranty of&n; *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; *  GNU General Public License for more details.&n; *&n; *  You should have received a copy of the GNU General Public License&n; *  along with this program; if not, write to the Free Software&n; *  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA&n; */
macro_line|#include &lt;sound/driver.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/delay.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;linux/pci.h&gt;
macro_line|#include &lt;sound/core.h&gt;
macro_line|#include &quot;hda_codec.h&quot;
macro_line|#include &quot;hda_local.h&quot;
DECL|struct|ad1986a_spec
r_struct
id|ad1986a_spec
(brace
DECL|member|amp_mutex
r_struct
id|semaphore
id|amp_mutex
suffix:semicolon
multiline_comment|/* PCM volume/mute control mutex */
DECL|member|multiout
r_struct
id|hda_multi_out
id|multiout
suffix:semicolon
multiline_comment|/* playback */
DECL|member|cur_mux
r_int
r_int
id|cur_mux
suffix:semicolon
multiline_comment|/* capture source */
DECL|member|pcm_rec
r_struct
id|hda_pcm
id|pcm_rec
(braket
l_int|2
)braket
suffix:semicolon
multiline_comment|/* PCM information */
)brace
suffix:semicolon
DECL|macro|AD1986A_SPDIF_OUT
mdefine_line|#define AD1986A_SPDIF_OUT&t;0x02
DECL|macro|AD1986A_FRONT_DAC
mdefine_line|#define AD1986A_FRONT_DAC&t;0x03
DECL|macro|AD1986A_SURR_DAC
mdefine_line|#define AD1986A_SURR_DAC&t;0x04
DECL|macro|AD1986A_CLFE_DAC
mdefine_line|#define AD1986A_CLFE_DAC&t;0x05
DECL|macro|AD1986A_ADC
mdefine_line|#define AD1986A_ADC&t;&t;0x06
DECL|variable|ad1986a_dac_nids
r_static
id|hda_nid_t
id|ad1986a_dac_nids
(braket
l_int|3
)braket
op_assign
(brace
id|AD1986A_FRONT_DAC
comma
id|AD1986A_SURR_DAC
comma
id|AD1986A_CLFE_DAC
)brace
suffix:semicolon
DECL|variable|ad1986a_capture_source
r_static
r_struct
id|hda_input_mux
id|ad1986a_capture_source
op_assign
(brace
dot
id|num_items
op_assign
l_int|7
comma
dot
id|items
op_assign
(brace
(brace
l_string|&quot;Mic&quot;
comma
l_int|0x0
)brace
comma
(brace
l_string|&quot;CD&quot;
comma
l_int|0x1
)brace
comma
(brace
l_string|&quot;Aux&quot;
comma
l_int|0x3
)brace
comma
(brace
l_string|&quot;Line&quot;
comma
l_int|0x4
)brace
comma
(brace
l_string|&quot;Mix&quot;
comma
l_int|0x5
)brace
comma
(brace
l_string|&quot;Mono&quot;
comma
l_int|0x6
)brace
comma
(brace
l_string|&quot;Phone&quot;
comma
l_int|0x7
)brace
comma
)brace
comma
)brace
suffix:semicolon
multiline_comment|/*&n; * PCM control&n; *&n; * bind volumes/mutes of 3 DACs as a single PCM control for simplicity&n; */
DECL|macro|ad1986a_pcm_amp_vol_info
mdefine_line|#define ad1986a_pcm_amp_vol_info&t;snd_hda_mixer_amp_volume_info
DECL|function|ad1986a_pcm_amp_vol_get
r_static
r_int
id|ad1986a_pcm_amp_vol_get
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
r_struct
id|hda_codec
op_star
id|codec
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_struct
id|ad1986a_spec
op_star
id|ad
op_assign
id|codec-&gt;spec
suffix:semicolon
id|down
c_func
(paren
op_amp
id|ad-&gt;amp_mutex
)paren
suffix:semicolon
id|snd_hda_mixer_amp_volume_get
c_func
(paren
id|kcontrol
comma
id|ucontrol
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|ad-&gt;amp_mutex
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|ad1986a_pcm_amp_vol_put
r_static
r_int
id|ad1986a_pcm_amp_vol_put
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
r_struct
id|hda_codec
op_star
id|codec
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_struct
id|ad1986a_spec
op_star
id|ad
op_assign
id|codec-&gt;spec
suffix:semicolon
r_int
id|i
comma
id|change
op_assign
l_int|0
suffix:semicolon
id|down
c_func
(paren
op_amp
id|ad-&gt;amp_mutex
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|ARRAY_SIZE
c_func
(paren
id|ad1986a_dac_nids
)paren
suffix:semicolon
id|i
op_increment
)paren
(brace
id|kcontrol-&gt;private_value
op_assign
id|HDA_COMPOSE_AMP_VAL
c_func
(paren
id|ad1986a_dac_nids
(braket
id|i
)braket
comma
l_int|3
comma
l_int|0
comma
id|HDA_OUTPUT
)paren
suffix:semicolon
id|change
op_or_assign
id|snd_hda_mixer_amp_volume_put
c_func
(paren
id|kcontrol
comma
id|ucontrol
)paren
suffix:semicolon
)brace
id|kcontrol-&gt;private_value
op_assign
id|HDA_COMPOSE_AMP_VAL
c_func
(paren
id|AD1986A_FRONT_DAC
comma
l_int|3
comma
l_int|0
comma
id|HDA_OUTPUT
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|ad-&gt;amp_mutex
)paren
suffix:semicolon
r_return
id|change
suffix:semicolon
)brace
DECL|macro|ad1986a_pcm_amp_sw_info
mdefine_line|#define ad1986a_pcm_amp_sw_info&t;&t;snd_hda_mixer_amp_volume_info
DECL|function|ad1986a_pcm_amp_sw_get
r_static
r_int
id|ad1986a_pcm_amp_sw_get
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
r_struct
id|hda_codec
op_star
id|codec
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_struct
id|ad1986a_spec
op_star
id|ad
op_assign
id|codec-&gt;spec
suffix:semicolon
id|down
c_func
(paren
op_amp
id|ad-&gt;amp_mutex
)paren
suffix:semicolon
id|snd_hda_mixer_amp_switch_get
c_func
(paren
id|kcontrol
comma
id|ucontrol
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|ad-&gt;amp_mutex
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|ad1986a_pcm_amp_sw_put
r_static
r_int
id|ad1986a_pcm_amp_sw_put
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
r_struct
id|hda_codec
op_star
id|codec
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_struct
id|ad1986a_spec
op_star
id|ad
op_assign
id|codec-&gt;spec
suffix:semicolon
r_int
id|i
comma
id|change
op_assign
l_int|0
suffix:semicolon
id|down
c_func
(paren
op_amp
id|ad-&gt;amp_mutex
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|ARRAY_SIZE
c_func
(paren
id|ad1986a_dac_nids
)paren
suffix:semicolon
id|i
op_increment
)paren
(brace
id|kcontrol-&gt;private_value
op_assign
id|HDA_COMPOSE_AMP_VAL
c_func
(paren
id|ad1986a_dac_nids
(braket
id|i
)braket
comma
l_int|3
comma
l_int|0
comma
id|HDA_OUTPUT
)paren
suffix:semicolon
id|change
op_or_assign
id|snd_hda_mixer_amp_switch_put
c_func
(paren
id|kcontrol
comma
id|ucontrol
)paren
suffix:semicolon
)brace
id|kcontrol-&gt;private_value
op_assign
id|HDA_COMPOSE_AMP_VAL
c_func
(paren
id|AD1986A_FRONT_DAC
comma
l_int|3
comma
l_int|0
comma
id|HDA_OUTPUT
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|ad-&gt;amp_mutex
)paren
suffix:semicolon
r_return
id|change
suffix:semicolon
)brace
multiline_comment|/*&n; * input MUX handling&n; */
DECL|function|ad1986a_mux_enum_info
r_static
r_int
id|ad1986a_mux_enum_info
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
r_return
id|snd_hda_input_mux_info
c_func
(paren
op_amp
id|ad1986a_capture_source
comma
id|uinfo
)paren
suffix:semicolon
)brace
DECL|function|ad1986a_mux_enum_get
r_static
r_int
id|ad1986a_mux_enum_get
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
r_struct
id|hda_codec
op_star
id|codec
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_struct
id|ad1986a_spec
op_star
id|spec
op_assign
id|codec-&gt;spec
suffix:semicolon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
id|spec-&gt;cur_mux
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|ad1986a_mux_enum_put
r_static
r_int
id|ad1986a_mux_enum_put
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
r_struct
id|hda_codec
op_star
id|codec
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_struct
id|ad1986a_spec
op_star
id|spec
op_assign
id|codec-&gt;spec
suffix:semicolon
r_return
id|snd_hda_input_mux_put
c_func
(paren
id|codec
comma
op_amp
id|ad1986a_capture_source
comma
id|ucontrol
comma
id|AD1986A_ADC
comma
op_amp
id|spec-&gt;cur_mux
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * mixers&n; */
DECL|variable|ad1986a_mixers
r_static
id|snd_kcontrol_new_t
id|ad1986a_mixers
(braket
)braket
op_assign
(brace
(brace
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_MIXER
comma
dot
id|name
op_assign
l_string|&quot;PCM Playback Volume&quot;
comma
dot
id|info
op_assign
id|ad1986a_pcm_amp_vol_info
comma
dot
id|get
op_assign
id|ad1986a_pcm_amp_vol_get
comma
dot
id|put
op_assign
id|ad1986a_pcm_amp_vol_put
comma
dot
id|private_value
op_assign
id|HDA_COMPOSE_AMP_VAL
c_func
(paren
id|AD1986A_FRONT_DAC
comma
l_int|3
comma
l_int|0
comma
id|HDA_OUTPUT
)paren
)brace
comma
(brace
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_MIXER
comma
dot
id|name
op_assign
l_string|&quot;PCM Playback Switch&quot;
comma
dot
id|info
op_assign
id|ad1986a_pcm_amp_sw_info
comma
dot
id|get
op_assign
id|ad1986a_pcm_amp_sw_get
comma
dot
id|put
op_assign
id|ad1986a_pcm_amp_sw_put
comma
dot
id|private_value
op_assign
id|HDA_COMPOSE_AMP_VAL
c_func
(paren
id|AD1986A_FRONT_DAC
comma
l_int|3
comma
l_int|0
comma
id|HDA_OUTPUT
)paren
)brace
comma
id|HDA_CODEC_VOLUME
c_func
(paren
l_string|&quot;Front Playback Volume&quot;
comma
l_int|0x1b
comma
l_int|0x0
comma
id|HDA_OUTPUT
)paren
comma
id|HDA_CODEC_MUTE
c_func
(paren
l_string|&quot;Front Playback Switch&quot;
comma
l_int|0x1b
comma
l_int|0x0
comma
id|HDA_OUTPUT
)paren
comma
id|HDA_CODEC_VOLUME
c_func
(paren
l_string|&quot;Surround Playback Volume&quot;
comma
l_int|0x1c
comma
l_int|0x0
comma
id|HDA_OUTPUT
)paren
comma
id|HDA_CODEC_MUTE
c_func
(paren
l_string|&quot;Surround Playback Switch&quot;
comma
l_int|0x1c
comma
l_int|0x0
comma
id|HDA_OUTPUT
)paren
comma
id|HDA_CODEC_VOLUME_MONO
c_func
(paren
l_string|&quot;Center Playback Volume&quot;
comma
l_int|0x1d
comma
l_int|1
comma
l_int|0x0
comma
id|HDA_OUTPUT
)paren
comma
id|HDA_CODEC_VOLUME_MONO
c_func
(paren
l_string|&quot;LFE Playback Volume&quot;
comma
l_int|0x1d
comma
l_int|2
comma
l_int|0x0
comma
id|HDA_OUTPUT
)paren
comma
id|HDA_CODEC_MUTE_MONO
c_func
(paren
l_string|&quot;Center Playback Switch&quot;
comma
l_int|0x1d
comma
l_int|1
comma
l_int|0x0
comma
id|HDA_OUTPUT
)paren
comma
id|HDA_CODEC_MUTE_MONO
c_func
(paren
l_string|&quot;LFE Playback Switch&quot;
comma
l_int|0x1d
comma
l_int|2
comma
l_int|0x0
comma
id|HDA_OUTPUT
)paren
comma
id|HDA_CODEC_VOLUME
c_func
(paren
l_string|&quot;Headphone Playback Volume&quot;
comma
l_int|0x1a
comma
l_int|0x0
comma
id|HDA_OUTPUT
)paren
comma
id|HDA_CODEC_MUTE
c_func
(paren
l_string|&quot;Headphone Playback Switch&quot;
comma
l_int|0x1a
comma
l_int|0x0
comma
id|HDA_OUTPUT
)paren
comma
id|HDA_CODEC_VOLUME
c_func
(paren
l_string|&quot;CD Playback Volume&quot;
comma
l_int|0x15
comma
l_int|0x0
comma
id|HDA_OUTPUT
)paren
comma
id|HDA_CODEC_MUTE
c_func
(paren
l_string|&quot;CD Playback Switch&quot;
comma
l_int|0x15
comma
l_int|0x0
comma
id|HDA_OUTPUT
)paren
comma
id|HDA_CODEC_VOLUME
c_func
(paren
l_string|&quot;Line Playback Volume&quot;
comma
l_int|0x17
comma
l_int|0x0
comma
id|HDA_OUTPUT
)paren
comma
id|HDA_CODEC_MUTE
c_func
(paren
l_string|&quot;Line Playback Switch&quot;
comma
l_int|0x17
comma
l_int|0x0
comma
id|HDA_OUTPUT
)paren
comma
id|HDA_CODEC_VOLUME
c_func
(paren
l_string|&quot;Aux Playback Volume&quot;
comma
l_int|0x16
comma
l_int|0x0
comma
id|HDA_OUTPUT
)paren
comma
id|HDA_CODEC_MUTE
c_func
(paren
l_string|&quot;Aux Playback Switch&quot;
comma
l_int|0x16
comma
l_int|0x0
comma
id|HDA_OUTPUT
)paren
comma
id|HDA_CODEC_VOLUME
c_func
(paren
l_string|&quot;Mic Playback Volume&quot;
comma
l_int|0x13
comma
l_int|0x0
comma
id|HDA_OUTPUT
)paren
comma
id|HDA_CODEC_MUTE
c_func
(paren
l_string|&quot;Mic Playback Switch&quot;
comma
l_int|0x13
comma
l_int|0x0
comma
id|HDA_OUTPUT
)paren
comma
id|HDA_CODEC_VOLUME
c_func
(paren
l_string|&quot;PC Speaker Playback Volume&quot;
comma
l_int|0x18
comma
l_int|0x0
comma
id|HDA_OUTPUT
)paren
comma
id|HDA_CODEC_MUTE
c_func
(paren
l_string|&quot;PC Speaker Playback Switch&quot;
comma
l_int|0x18
comma
l_int|0x0
comma
id|HDA_OUTPUT
)paren
comma
id|HDA_CODEC_VOLUME
c_func
(paren
l_string|&quot;Mono Playback Volume&quot;
comma
l_int|0x1e
comma
l_int|0x0
comma
id|HDA_OUTPUT
)paren
comma
id|HDA_CODEC_MUTE
c_func
(paren
l_string|&quot;Mono Playback Switch&quot;
comma
l_int|0x1e
comma
l_int|0x0
comma
id|HDA_OUTPUT
)paren
comma
id|HDA_CODEC_VOLUME
c_func
(paren
l_string|&quot;Capture Volume&quot;
comma
l_int|0x12
comma
l_int|0x0
comma
id|HDA_OUTPUT
)paren
comma
id|HDA_CODEC_MUTE
c_func
(paren
l_string|&quot;Capture Switch&quot;
comma
l_int|0x12
comma
l_int|0x0
comma
id|HDA_OUTPUT
)paren
comma
(brace
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_MIXER
comma
dot
id|name
op_assign
l_string|&quot;Capture Source&quot;
comma
dot
id|info
op_assign
id|ad1986a_mux_enum_info
comma
dot
id|get
op_assign
id|ad1986a_mux_enum_get
comma
dot
id|put
op_assign
id|ad1986a_mux_enum_put
comma
)brace
comma
id|HDA_CODEC_MUTE
c_func
(paren
l_string|&quot;Stereo Downmix Switch&quot;
comma
l_int|0x09
comma
l_int|0x0
comma
id|HDA_OUTPUT
)paren
comma
(brace
)brace
multiline_comment|/* end */
)brace
suffix:semicolon
multiline_comment|/*&n; * initialization verbs&n; */
DECL|variable|ad1986a_init_verbs
r_static
r_struct
id|hda_verb
id|ad1986a_init_verbs
(braket
)braket
op_assign
(brace
multiline_comment|/* Front, Surround, CLFE DAC; mute as default */
(brace
l_int|0x03
comma
id|AC_VERB_SET_AMP_GAIN_MUTE
comma
l_int|0xb080
)brace
comma
(brace
l_int|0x04
comma
id|AC_VERB_SET_AMP_GAIN_MUTE
comma
l_int|0xb080
)brace
comma
(brace
l_int|0x05
comma
id|AC_VERB_SET_AMP_GAIN_MUTE
comma
l_int|0xb080
)brace
comma
multiline_comment|/* Downmix - off */
(brace
l_int|0x09
comma
id|AC_VERB_SET_AMP_GAIN_MUTE
comma
l_int|0xb080
)brace
comma
multiline_comment|/* HP, Line-Out, Surround, CLFE selectors */
(brace
l_int|0x0a
comma
id|AC_VERB_SET_CONNECT_SEL
comma
l_int|0x0
)brace
comma
(brace
l_int|0x0b
comma
id|AC_VERB_SET_CONNECT_SEL
comma
l_int|0x0
)brace
comma
(brace
l_int|0x0c
comma
id|AC_VERB_SET_CONNECT_SEL
comma
l_int|0x0
)brace
comma
(brace
l_int|0x0d
comma
id|AC_VERB_SET_CONNECT_SEL
comma
l_int|0x0
)brace
comma
multiline_comment|/* Mono selector */
(brace
l_int|0x0e
comma
id|AC_VERB_SET_CONNECT_SEL
comma
l_int|0x0
)brace
comma
multiline_comment|/* Mic selector: Mic 1/2 pin */
(brace
l_int|0x0f
comma
id|AC_VERB_SET_CONNECT_SEL
comma
l_int|0x0
)brace
comma
multiline_comment|/* Line-in selector: Line-in */
(brace
l_int|0x10
comma
id|AC_VERB_SET_CONNECT_SEL
comma
l_int|0x0
)brace
comma
multiline_comment|/* Mic 1/2 swap */
(brace
l_int|0x11
comma
id|AC_VERB_SET_CONNECT_SEL
comma
l_int|0x0
)brace
comma
multiline_comment|/* Record selector: mic */
(brace
l_int|0x12
comma
id|AC_VERB_SET_CONNECT_SEL
comma
l_int|0x0
)brace
comma
multiline_comment|/* Mic, Phone, CD, Aux, Line-In amp; mute as default */
(brace
l_int|0x13
comma
id|AC_VERB_SET_AMP_GAIN_MUTE
comma
l_int|0xb080
)brace
comma
(brace
l_int|0x14
comma
id|AC_VERB_SET_AMP_GAIN_MUTE
comma
l_int|0xb080
)brace
comma
(brace
l_int|0x15
comma
id|AC_VERB_SET_AMP_GAIN_MUTE
comma
l_int|0xb080
)brace
comma
(brace
l_int|0x16
comma
id|AC_VERB_SET_AMP_GAIN_MUTE
comma
l_int|0xb080
)brace
comma
(brace
l_int|0x17
comma
id|AC_VERB_SET_AMP_GAIN_MUTE
comma
l_int|0xb080
)brace
comma
multiline_comment|/* PC beep */
(brace
l_int|0x18
comma
id|AC_VERB_SET_CONNECT_SEL
comma
l_int|0x0
)brace
comma
multiline_comment|/* HP, Line-Out, Surround, CLFE, Mono pins; mute as default */
(brace
l_int|0x1a
comma
id|AC_VERB_SET_AMP_GAIN_MUTE
comma
l_int|0xb080
)brace
comma
(brace
l_int|0x1b
comma
id|AC_VERB_SET_AMP_GAIN_MUTE
comma
l_int|0xb080
)brace
comma
(brace
l_int|0x1c
comma
id|AC_VERB_SET_AMP_GAIN_MUTE
comma
l_int|0xb080
)brace
comma
(brace
l_int|0x1d
comma
id|AC_VERB_SET_AMP_GAIN_MUTE
comma
l_int|0xb080
)brace
comma
(brace
l_int|0x1e
comma
id|AC_VERB_SET_AMP_GAIN_MUTE
comma
l_int|0xb080
)brace
comma
(brace
)brace
multiline_comment|/* end */
)brace
suffix:semicolon
DECL|function|ad1986a_init
r_static
r_int
id|ad1986a_init
c_func
(paren
r_struct
id|hda_codec
op_star
id|codec
)paren
(brace
id|snd_hda_sequence_write
c_func
(paren
id|codec
comma
id|ad1986a_init_verbs
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|ad1986a_build_controls
r_static
r_int
id|ad1986a_build_controls
c_func
(paren
r_struct
id|hda_codec
op_star
id|codec
)paren
(brace
r_int
id|err
suffix:semicolon
id|err
op_assign
id|snd_hda_add_new_ctls
c_func
(paren
id|codec
comma
id|ad1986a_mixers
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|snd_hda_create_spdif_out_ctls
c_func
(paren
id|codec
comma
id|AD1986A_SPDIF_OUT
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * Analog playback callbacks&n; */
DECL|function|ad1986a_playback_pcm_open
r_static
r_int
id|ad1986a_playback_pcm_open
c_func
(paren
r_struct
id|hda_pcm_stream
op_star
id|hinfo
comma
r_struct
id|hda_codec
op_star
id|codec
comma
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
r_struct
id|ad1986a_spec
op_star
id|spec
op_assign
id|codec-&gt;spec
suffix:semicolon
r_return
id|snd_hda_multi_out_analog_open
c_func
(paren
id|codec
comma
op_amp
id|spec-&gt;multiout
comma
id|substream
)paren
suffix:semicolon
)brace
DECL|function|ad1986a_playback_pcm_prepare
r_static
r_int
id|ad1986a_playback_pcm_prepare
c_func
(paren
r_struct
id|hda_pcm_stream
op_star
id|hinfo
comma
r_struct
id|hda_codec
op_star
id|codec
comma
r_int
r_int
id|stream_tag
comma
r_int
r_int
id|format
comma
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
r_struct
id|ad1986a_spec
op_star
id|spec
op_assign
id|codec-&gt;spec
suffix:semicolon
r_return
id|snd_hda_multi_out_analog_prepare
c_func
(paren
id|codec
comma
op_amp
id|spec-&gt;multiout
comma
id|stream_tag
comma
id|format
comma
id|substream
)paren
suffix:semicolon
)brace
DECL|function|ad1986a_playback_pcm_cleanup
r_static
r_int
id|ad1986a_playback_pcm_cleanup
c_func
(paren
r_struct
id|hda_pcm_stream
op_star
id|hinfo
comma
r_struct
id|hda_codec
op_star
id|codec
comma
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
r_struct
id|ad1986a_spec
op_star
id|spec
op_assign
id|codec-&gt;spec
suffix:semicolon
r_return
id|snd_hda_multi_out_analog_cleanup
c_func
(paren
id|codec
comma
op_amp
id|spec-&gt;multiout
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Digital out&n; */
DECL|function|ad1986a_dig_playback_pcm_open
r_static
r_int
id|ad1986a_dig_playback_pcm_open
c_func
(paren
r_struct
id|hda_pcm_stream
op_star
id|hinfo
comma
r_struct
id|hda_codec
op_star
id|codec
comma
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
r_struct
id|ad1986a_spec
op_star
id|spec
op_assign
id|codec-&gt;spec
suffix:semicolon
r_return
id|snd_hda_multi_out_dig_open
c_func
(paren
id|codec
comma
op_amp
id|spec-&gt;multiout
)paren
suffix:semicolon
)brace
DECL|function|ad1986a_dig_playback_pcm_close
r_static
r_int
id|ad1986a_dig_playback_pcm_close
c_func
(paren
r_struct
id|hda_pcm_stream
op_star
id|hinfo
comma
r_struct
id|hda_codec
op_star
id|codec
comma
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
r_struct
id|ad1986a_spec
op_star
id|spec
op_assign
id|codec-&gt;spec
suffix:semicolon
r_return
id|snd_hda_multi_out_dig_close
c_func
(paren
id|codec
comma
op_amp
id|spec-&gt;multiout
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Analog capture&n; */
DECL|function|ad1986a_capture_pcm_prepare
r_static
r_int
id|ad1986a_capture_pcm_prepare
c_func
(paren
r_struct
id|hda_pcm_stream
op_star
id|hinfo
comma
r_struct
id|hda_codec
op_star
id|codec
comma
r_int
r_int
id|stream_tag
comma
r_int
r_int
id|format
comma
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_hda_codec_setup_stream
c_func
(paren
id|codec
comma
id|AD1986A_ADC
comma
id|stream_tag
comma
l_int|0
comma
id|format
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|ad1986a_capture_pcm_cleanup
r_static
r_int
id|ad1986a_capture_pcm_cleanup
c_func
(paren
r_struct
id|hda_pcm_stream
op_star
id|hinfo
comma
r_struct
id|hda_codec
op_star
id|codec
comma
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_hda_codec_setup_stream
c_func
(paren
id|codec
comma
id|AD1986A_ADC
comma
l_int|0
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; */
DECL|variable|ad1986a_pcm_analog_playback
r_static
r_struct
id|hda_pcm_stream
id|ad1986a_pcm_analog_playback
op_assign
(brace
dot
id|substreams
op_assign
l_int|1
comma
dot
id|channels_min
op_assign
l_int|2
comma
dot
id|channels_max
op_assign
l_int|6
comma
dot
id|nid
op_assign
id|AD1986A_FRONT_DAC
comma
multiline_comment|/* NID to query formats and rates */
dot
id|ops
op_assign
(brace
dot
id|open
op_assign
id|ad1986a_playback_pcm_open
comma
dot
id|prepare
op_assign
id|ad1986a_playback_pcm_prepare
comma
dot
id|cleanup
op_assign
id|ad1986a_playback_pcm_cleanup
)brace
comma
)brace
suffix:semicolon
DECL|variable|ad1986a_pcm_analog_capture
r_static
r_struct
id|hda_pcm_stream
id|ad1986a_pcm_analog_capture
op_assign
(brace
dot
id|substreams
op_assign
l_int|2
comma
dot
id|channels_min
op_assign
l_int|2
comma
dot
id|channels_max
op_assign
l_int|2
comma
dot
id|nid
op_assign
id|AD1986A_ADC
comma
multiline_comment|/* NID to query formats and rates */
dot
id|ops
op_assign
(brace
dot
id|prepare
op_assign
id|ad1986a_capture_pcm_prepare
comma
dot
id|cleanup
op_assign
id|ad1986a_capture_pcm_cleanup
)brace
comma
)brace
suffix:semicolon
DECL|variable|ad1986a_pcm_digital_playback
r_static
r_struct
id|hda_pcm_stream
id|ad1986a_pcm_digital_playback
op_assign
(brace
dot
id|substreams
op_assign
l_int|1
comma
dot
id|channels_min
op_assign
l_int|2
comma
dot
id|channels_max
op_assign
l_int|2
comma
dot
id|nid
op_assign
id|AD1986A_SPDIF_OUT
comma
dot
id|ops
op_assign
(brace
dot
id|open
op_assign
id|ad1986a_dig_playback_pcm_open
comma
dot
id|close
op_assign
id|ad1986a_dig_playback_pcm_close
)brace
comma
)brace
suffix:semicolon
DECL|function|ad1986a_build_pcms
r_static
r_int
id|ad1986a_build_pcms
c_func
(paren
r_struct
id|hda_codec
op_star
id|codec
)paren
(brace
r_struct
id|ad1986a_spec
op_star
id|spec
op_assign
id|codec-&gt;spec
suffix:semicolon
r_struct
id|hda_pcm
op_star
id|info
op_assign
id|spec-&gt;pcm_rec
suffix:semicolon
id|codec-&gt;num_pcms
op_assign
l_int|2
suffix:semicolon
id|codec-&gt;pcm_info
op_assign
id|info
suffix:semicolon
id|info-&gt;name
op_assign
l_string|&quot;AD1986A Analog&quot;
suffix:semicolon
id|info-&gt;stream
(braket
id|SNDRV_PCM_STREAM_PLAYBACK
)braket
op_assign
id|ad1986a_pcm_analog_playback
suffix:semicolon
id|info-&gt;stream
(braket
id|SNDRV_PCM_STREAM_CAPTURE
)braket
op_assign
id|ad1986a_pcm_analog_capture
suffix:semicolon
id|info
op_increment
suffix:semicolon
id|info-&gt;name
op_assign
l_string|&quot;AD1986A Digital&quot;
suffix:semicolon
id|info-&gt;stream
(braket
id|SNDRV_PCM_STREAM_PLAYBACK
)braket
op_assign
id|ad1986a_pcm_digital_playback
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|ad1986a_free
r_static
r_void
id|ad1986a_free
c_func
(paren
r_struct
id|hda_codec
op_star
id|codec
)paren
(brace
id|kfree
c_func
(paren
id|codec-&gt;spec
)paren
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_PM
DECL|function|ad1986a_resume
r_static
r_int
id|ad1986a_resume
c_func
(paren
r_struct
id|hda_codec
op_star
id|codec
)paren
(brace
id|ad1986a_init
c_func
(paren
id|codec
)paren
suffix:semicolon
id|snd_hda_resume_ctls
c_func
(paren
id|codec
comma
id|ad1986a_mixers
)paren
suffix:semicolon
id|snd_hda_resume_spdif_out
c_func
(paren
id|codec
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#endif
DECL|variable|ad1986a_patch_ops
r_static
r_struct
id|hda_codec_ops
id|ad1986a_patch_ops
op_assign
(brace
dot
id|build_controls
op_assign
id|ad1986a_build_controls
comma
dot
id|build_pcms
op_assign
id|ad1986a_build_pcms
comma
dot
id|init
op_assign
id|ad1986a_init
comma
dot
id|free
op_assign
id|ad1986a_free
comma
macro_line|#ifdef CONFIG_PM
dot
id|resume
op_assign
id|ad1986a_resume
comma
macro_line|#endif
)brace
suffix:semicolon
DECL|function|patch_ad1986a
r_static
r_int
id|patch_ad1986a
c_func
(paren
r_struct
id|hda_codec
op_star
id|codec
)paren
(brace
r_struct
id|ad1986a_spec
op_star
id|spec
suffix:semicolon
id|spec
op_assign
id|kcalloc
c_func
(paren
l_int|1
comma
r_sizeof
(paren
op_star
id|spec
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|spec
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|init_MUTEX
c_func
(paren
op_amp
id|spec-&gt;amp_mutex
)paren
suffix:semicolon
id|codec-&gt;spec
op_assign
id|spec
suffix:semicolon
id|spec-&gt;multiout.max_channels
op_assign
l_int|6
suffix:semicolon
id|spec-&gt;multiout.num_dacs
op_assign
id|ARRAY_SIZE
c_func
(paren
id|ad1986a_dac_nids
)paren
suffix:semicolon
id|spec-&gt;multiout.dac_nids
op_assign
id|ad1986a_dac_nids
suffix:semicolon
id|spec-&gt;multiout.dig_out_nid
op_assign
id|AD1986A_SPDIF_OUT
suffix:semicolon
id|codec-&gt;patch_ops
op_assign
id|ad1986a_patch_ops
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * patch entries&n; */
DECL|variable|snd_hda_preset_analog
r_struct
id|hda_codec_preset
id|snd_hda_preset_analog
(braket
)braket
op_assign
(brace
(brace
dot
id|id
op_assign
l_int|0x11d41986
comma
dot
id|name
op_assign
l_string|&quot;AD1986A&quot;
comma
dot
id|patch
op_assign
id|patch_ad1986a
)brace
comma
(brace
)brace
multiline_comment|/* terminator */
)brace
suffix:semicolon
eof
