multiline_comment|/*&n; * Universal Interface for Intel High Definition Audio Codec&n; *&n; * Copyright (c) 2004 Takashi Iwai &lt;tiwai@suse.de&gt;&n; *&n; *&n; *  This driver is free software; you can redistribute it and/or modify&n; *  it under the terms of the GNU General Public License as published by&n; *  the Free Software Foundation; either version 2 of the License, or&n; *  (at your option) any later version.&n; *&n; *  This driver is distributed in the hope that it will be useful,&n; *  but WITHOUT ANY WARRANTY; without even the implied warranty of&n; *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; *  GNU General Public License for more details.&n; *&n; *  You should have received a copy of the GNU General Public License&n; *  along with this program; if not, write to the Free Software&n; *  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA&n; */
macro_line|#include &lt;sound/driver.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/delay.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;linux/pci.h&gt;
macro_line|#include &lt;linux/moduleparam.h&gt;
macro_line|#include &lt;sound/core.h&gt;
macro_line|#include &quot;hda_codec.h&quot;
macro_line|#include &lt;sound/asoundef.h&gt;
macro_line|#include &lt;sound/initval.h&gt;
macro_line|#include &quot;hda_local.h&quot;
id|MODULE_AUTHOR
c_func
(paren
l_string|&quot;Takashi Iwai &lt;tiwai@suse.de&gt;&quot;
)paren
suffix:semicolon
id|MODULE_DESCRIPTION
c_func
(paren
l_string|&quot;Universal interface for High Definition Audio Codec&quot;
)paren
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
multiline_comment|/*&n; * vendor / preset table&n; */
DECL|struct|hda_vendor_id
r_struct
id|hda_vendor_id
(brace
DECL|member|id
r_int
r_int
id|id
suffix:semicolon
DECL|member|name
r_const
r_char
op_star
id|name
suffix:semicolon
)brace
suffix:semicolon
multiline_comment|/* codec vendor labels */
DECL|variable|hda_vendor_ids
r_static
r_struct
id|hda_vendor_id
id|hda_vendor_ids
(braket
)braket
op_assign
(brace
(brace
l_int|0x10ec
comma
l_string|&quot;Realtek&quot;
)brace
comma
(brace
l_int|0x434d
comma
l_string|&quot;C-Media&quot;
)brace
comma
(brace
)brace
multiline_comment|/* terminator */
)brace
suffix:semicolon
multiline_comment|/* codec presets */
macro_line|#include &quot;hda_patch.h&quot;
multiline_comment|/**&n; * snd_hda_codec_read - send a command and get the response&n; * @codec: the HDA codec&n; * @nid: NID to send the command&n; * @direct: direct flag&n; * @verb: the verb to send&n; * @parm: the parameter for the verb&n; *&n; * Send a single command and read the corresponding response.&n; *&n; * Returns the obtained response value, or -1 for an error.&n; */
DECL|function|snd_hda_codec_read
r_int
r_int
id|snd_hda_codec_read
c_func
(paren
r_struct
id|hda_codec
op_star
id|codec
comma
id|hda_nid_t
id|nid
comma
r_int
id|direct
comma
r_int
r_int
id|verb
comma
r_int
r_int
id|parm
)paren
(brace
r_int
r_int
id|res
suffix:semicolon
id|down
c_func
(paren
op_amp
id|codec-&gt;bus-&gt;cmd_mutex
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|codec-&gt;bus-&gt;ops
dot
id|command
c_func
(paren
id|codec
comma
id|nid
comma
id|direct
comma
id|verb
comma
id|parm
)paren
)paren
id|res
op_assign
id|codec-&gt;bus-&gt;ops
dot
id|get_response
c_func
(paren
id|codec
)paren
suffix:semicolon
r_else
id|res
op_assign
(paren
r_int
r_int
)paren
op_minus
l_int|1
suffix:semicolon
id|up
c_func
(paren
op_amp
id|codec-&gt;bus-&gt;cmd_mutex
)paren
suffix:semicolon
r_return
id|res
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_hda_codec_write - send a single command without waiting for response&n; * @codec: the HDA codec&n; * @nid: NID to send the command&n; * @direct: direct flag&n; * @verb: the verb to send&n; * @parm: the parameter for the verb&n; *&n; * Send a single command without waiting for response.&n; *&n; * Returns 0 if successful, or a negative error code.&n; */
DECL|function|snd_hda_codec_write
r_int
id|snd_hda_codec_write
c_func
(paren
r_struct
id|hda_codec
op_star
id|codec
comma
id|hda_nid_t
id|nid
comma
r_int
id|direct
comma
r_int
r_int
id|verb
comma
r_int
r_int
id|parm
)paren
(brace
r_int
id|err
suffix:semicolon
id|down
c_func
(paren
op_amp
id|codec-&gt;bus-&gt;cmd_mutex
)paren
suffix:semicolon
id|err
op_assign
id|codec-&gt;bus-&gt;ops
dot
id|command
c_func
(paren
id|codec
comma
id|nid
comma
id|direct
comma
id|verb
comma
id|parm
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|codec-&gt;bus-&gt;cmd_mutex
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_hda_sequence_write - sequence writes&n; * @codec: the HDA codec&n; * @seq: VERB array to send&n; *&n; * Send the commands sequentially from the given array.&n; * The array must be terminated with NID=0.&n; */
DECL|function|snd_hda_sequence_write
r_void
id|snd_hda_sequence_write
c_func
(paren
r_struct
id|hda_codec
op_star
id|codec
comma
r_const
r_struct
id|hda_verb
op_star
id|seq
)paren
(brace
r_for
c_loop
(paren
suffix:semicolon
id|seq-&gt;nid
suffix:semicolon
id|seq
op_increment
)paren
id|snd_hda_codec_write
c_func
(paren
id|codec
comma
id|seq-&gt;nid
comma
l_int|0
comma
id|seq-&gt;verb
comma
id|seq-&gt;param
)paren
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_hda_get_sub_nodes - get the range of sub nodes&n; * @codec: the HDA codec&n; * @nid: NID to parse&n; * @start_id: the pointer to store the start NID&n; *&n; * Parse the NID and store the start NID of its sub-nodes.&n; * Returns the number of sub-nodes.&n; */
DECL|function|snd_hda_get_sub_nodes
r_int
id|snd_hda_get_sub_nodes
c_func
(paren
r_struct
id|hda_codec
op_star
id|codec
comma
id|hda_nid_t
id|nid
comma
id|hda_nid_t
op_star
id|start_id
)paren
(brace
r_int
r_int
id|parm
suffix:semicolon
id|parm
op_assign
id|snd_hda_param_read
c_func
(paren
id|codec
comma
id|nid
comma
id|AC_PAR_NODE_COUNT
)paren
suffix:semicolon
op_star
id|start_id
op_assign
(paren
id|parm
op_rshift
l_int|16
)paren
op_amp
l_int|0x7fff
suffix:semicolon
r_return
(paren
r_int
)paren
(paren
id|parm
op_amp
l_int|0x7fff
)paren
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_hda_get_connections - get connection list&n; * @codec: the HDA codec&n; * @nid: NID to parse&n; * @conn_list: connection list array&n; * @max_conns: max. number of connections to store&n; *&n; * Parses the connection list of the given widget and stores the list&n; * of NIDs.&n; *&n; * Returns the number of connections, or a negative error code.&n; */
DECL|function|snd_hda_get_connections
r_int
id|snd_hda_get_connections
c_func
(paren
r_struct
id|hda_codec
op_star
id|codec
comma
id|hda_nid_t
id|nid
comma
id|hda_nid_t
op_star
id|conn_list
comma
r_int
id|max_conns
)paren
(brace
r_int
r_int
id|parm
suffix:semicolon
r_int
id|i
comma
id|j
comma
id|conn_len
comma
id|num_tupples
comma
id|conns
suffix:semicolon
r_int
r_int
id|shift
comma
id|num_elems
comma
id|mask
suffix:semicolon
id|snd_assert
c_func
(paren
id|conn_list
op_logical_and
id|max_conns
OG
l_int|0
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|parm
op_assign
id|snd_hda_param_read
c_func
(paren
id|codec
comma
id|nid
comma
id|AC_PAR_CONNLIST_LEN
)paren
suffix:semicolon
r_if
c_cond
(paren
id|parm
op_amp
id|AC_CLIST_LONG
)paren
(brace
multiline_comment|/* long form */
id|shift
op_assign
l_int|16
suffix:semicolon
id|num_elems
op_assign
l_int|2
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* short form */
id|shift
op_assign
l_int|8
suffix:semicolon
id|num_elems
op_assign
l_int|4
suffix:semicolon
)brace
id|conn_len
op_assign
id|parm
op_amp
id|AC_CLIST_LENGTH
suffix:semicolon
id|num_tupples
op_assign
id|num_elems
op_div
l_int|2
suffix:semicolon
id|mask
op_assign
(paren
l_int|1
op_lshift
(paren
id|shift
op_minus
l_int|1
)paren
)paren
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|conn_len
)paren
r_return
l_int|0
suffix:semicolon
multiline_comment|/* no connection */
r_if
c_cond
(paren
id|conn_len
op_eq
l_int|1
)paren
(brace
multiline_comment|/* single connection */
id|parm
op_assign
id|snd_hda_codec_read
c_func
(paren
id|codec
comma
id|nid
comma
l_int|0
comma
id|AC_VERB_GET_CONNECT_LIST
comma
l_int|0
)paren
suffix:semicolon
id|conn_list
(braket
l_int|0
)braket
op_assign
id|parm
op_amp
id|mask
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
multiline_comment|/* multi connection */
id|conns
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|conn_len
suffix:semicolon
id|i
op_add_assign
id|num_elems
)paren
(brace
id|parm
op_assign
id|snd_hda_codec_read
c_func
(paren
id|codec
comma
id|nid
comma
l_int|0
comma
id|AC_VERB_GET_CONNECT_LIST
comma
id|i
)paren
suffix:semicolon
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
id|num_tupples
suffix:semicolon
id|j
op_increment
)paren
(brace
r_int
id|range_val
suffix:semicolon
id|hda_nid_t
id|val1
comma
id|val2
comma
id|n
suffix:semicolon
id|range_val
op_assign
id|parm
op_amp
(paren
l_int|1
op_lshift
(paren
id|shift
op_minus
l_int|1
)paren
)paren
suffix:semicolon
multiline_comment|/* ranges */
id|val1
op_assign
id|parm
op_amp
id|mask
suffix:semicolon
id|parm
op_rshift_assign
id|shift
suffix:semicolon
id|val2
op_assign
id|parm
op_amp
id|mask
suffix:semicolon
id|parm
op_rshift_assign
id|shift
suffix:semicolon
r_if
c_cond
(paren
id|range_val
)paren
(brace
multiline_comment|/* ranges between val1 and val2 */
r_if
c_cond
(paren
id|val1
OG
id|val2
)paren
(brace
id|snd_printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;hda_codec: invalid dep_range_val %x:%x&bslash;n&quot;
comma
id|val1
comma
id|val2
)paren
suffix:semicolon
r_continue
suffix:semicolon
)brace
r_for
c_loop
(paren
id|n
op_assign
id|val1
suffix:semicolon
id|n
op_le
id|val2
suffix:semicolon
id|n
op_increment
)paren
(brace
r_if
c_cond
(paren
id|conns
op_ge
id|max_conns
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|conn_list
(braket
id|conns
op_increment
)braket
op_assign
id|n
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
op_logical_neg
id|val1
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
id|conns
op_ge
id|max_conns
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|conn_list
(braket
id|conns
op_increment
)braket
op_assign
id|val1
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|val2
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
id|conns
op_ge
id|max_conns
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|conn_list
(braket
id|conns
op_increment
)braket
op_assign
id|val2
suffix:semicolon
)brace
)brace
)brace
r_return
id|conns
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_hda_queue_unsol_event - add an unsolicited event to queue&n; * @bus: the BUS&n; * @res: unsolicited event (lower 32bit of RIRB entry)&n; * @res_ex: codec addr and flags (upper 32bit or RIRB entry)&n; *&n; * Adds the given event to the queue.  The events are processed in&n; * the workqueue asynchronously.  Call this function in the interrupt&n; * hanlder when RIRB receives an unsolicited event.&n; *&n; * Returns 0 if successful, or a negative error code.&n; */
DECL|function|snd_hda_queue_unsol_event
r_int
id|snd_hda_queue_unsol_event
c_func
(paren
r_struct
id|hda_bus
op_star
id|bus
comma
id|u32
id|res
comma
id|u32
id|res_ex
)paren
(brace
r_struct
id|hda_bus_unsolicited
op_star
id|unsol
suffix:semicolon
r_int
r_int
id|wp
suffix:semicolon
r_if
c_cond
(paren
(paren
id|unsol
op_assign
id|bus-&gt;unsol
)paren
op_eq
l_int|NULL
)paren
r_return
l_int|0
suffix:semicolon
id|wp
op_assign
(paren
id|unsol-&gt;wp
op_plus
l_int|1
)paren
op_mod
id|HDA_UNSOL_QUEUE_SIZE
suffix:semicolon
id|unsol-&gt;wp
op_assign
id|wp
suffix:semicolon
id|wp
op_lshift_assign
l_int|1
suffix:semicolon
id|unsol-&gt;queue
(braket
id|wp
)braket
op_assign
id|res
suffix:semicolon
id|unsol-&gt;queue
(braket
id|wp
op_plus
l_int|1
)braket
op_assign
id|res_ex
suffix:semicolon
id|queue_work
c_func
(paren
id|unsol-&gt;workq
comma
op_amp
id|unsol-&gt;work
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * process queueud unsolicited events&n; */
DECL|function|process_unsol_events
r_static
r_void
id|process_unsol_events
c_func
(paren
r_void
op_star
id|data
)paren
(brace
r_struct
id|hda_bus
op_star
id|bus
op_assign
id|data
suffix:semicolon
r_struct
id|hda_bus_unsolicited
op_star
id|unsol
op_assign
id|bus-&gt;unsol
suffix:semicolon
r_struct
id|hda_codec
op_star
id|codec
suffix:semicolon
r_int
r_int
id|rp
comma
id|caddr
comma
id|res
suffix:semicolon
r_while
c_loop
(paren
id|unsol-&gt;rp
op_ne
id|unsol-&gt;wp
)paren
(brace
id|rp
op_assign
(paren
id|unsol-&gt;rp
op_plus
l_int|1
)paren
op_mod
id|HDA_UNSOL_QUEUE_SIZE
suffix:semicolon
id|unsol-&gt;rp
op_assign
id|rp
suffix:semicolon
id|rp
op_lshift_assign
l_int|1
suffix:semicolon
id|res
op_assign
id|unsol-&gt;queue
(braket
id|rp
)braket
suffix:semicolon
id|caddr
op_assign
id|unsol-&gt;queue
(braket
id|rp
op_plus
l_int|1
)braket
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|caddr
op_amp
(paren
l_int|1
op_lshift
l_int|4
)paren
)paren
)paren
multiline_comment|/* no unsolicited event? */
r_continue
suffix:semicolon
id|codec
op_assign
id|bus-&gt;caddr_tbl
(braket
id|caddr
op_amp
l_int|0x0f
)braket
suffix:semicolon
r_if
c_cond
(paren
id|codec
op_logical_and
id|codec-&gt;patch_ops.unsol_event
)paren
id|codec-&gt;patch_ops
dot
id|unsol_event
c_func
(paren
id|codec
comma
id|res
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/*&n; * initialize unsolicited queue&n; */
DECL|function|init_unsol_queue
r_static
r_int
id|init_unsol_queue
c_func
(paren
r_struct
id|hda_bus
op_star
id|bus
)paren
(brace
r_struct
id|hda_bus_unsolicited
op_star
id|unsol
suffix:semicolon
id|unsol
op_assign
id|kcalloc
c_func
(paren
l_int|1
comma
r_sizeof
(paren
op_star
id|unsol
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|unsol
)paren
(brace
id|snd_printk
c_func
(paren
id|KERN_ERR
l_string|&quot;hda_codec: can&squot;t allocate unsolicited queue&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|unsol-&gt;workq
op_assign
id|create_workqueue
c_func
(paren
l_string|&quot;hda_codec&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|unsol-&gt;workq
)paren
(brace
id|snd_printk
c_func
(paren
id|KERN_ERR
l_string|&quot;hda_codec: can&squot;t create workqueue&bslash;n&quot;
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|unsol
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|INIT_WORK
c_func
(paren
op_amp
id|unsol-&gt;work
comma
id|process_unsol_events
comma
id|bus
)paren
suffix:semicolon
id|bus-&gt;unsol
op_assign
id|unsol
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * destructor&n; */
r_static
r_void
id|snd_hda_codec_free
c_func
(paren
r_struct
id|hda_codec
op_star
id|codec
)paren
suffix:semicolon
DECL|function|snd_hda_bus_free
r_static
r_int
id|snd_hda_bus_free
c_func
(paren
r_struct
id|hda_bus
op_star
id|bus
)paren
(brace
r_struct
id|list_head
op_star
id|p
comma
op_star
id|n
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|bus
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|bus-&gt;unsol
)paren
(brace
id|destroy_workqueue
c_func
(paren
id|bus-&gt;unsol-&gt;workq
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|bus-&gt;unsol
)paren
suffix:semicolon
)brace
id|list_for_each_safe
c_func
(paren
id|p
comma
id|n
comma
op_amp
id|bus-&gt;codec_list
)paren
(brace
r_struct
id|hda_codec
op_star
id|codec
op_assign
id|list_entry
c_func
(paren
id|p
comma
r_struct
id|hda_codec
comma
id|list
)paren
suffix:semicolon
id|snd_hda_codec_free
c_func
(paren
id|codec
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|bus-&gt;ops.private_free
)paren
id|bus-&gt;ops
dot
id|private_free
c_func
(paren
id|bus
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|bus
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hda_bus_dev_free
r_static
r_int
id|snd_hda_bus_dev_free
c_func
(paren
id|snd_device_t
op_star
id|device
)paren
(brace
r_struct
id|hda_bus
op_star
id|bus
op_assign
id|device-&gt;device_data
suffix:semicolon
r_return
id|snd_hda_bus_free
c_func
(paren
id|bus
)paren
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_hda_bus_new - create a HDA bus&n; * @card: the card entry&n; * @temp: the template for hda_bus information&n; * @busp: the pointer to store the created bus instance&n; *&n; * Returns 0 if successful, or a negative error code.&n; */
DECL|function|snd_hda_bus_new
r_int
id|snd_hda_bus_new
c_func
(paren
id|snd_card_t
op_star
id|card
comma
r_const
r_struct
id|hda_bus_template
op_star
id|temp
comma
r_struct
id|hda_bus
op_star
op_star
id|busp
)paren
(brace
r_struct
id|hda_bus
op_star
id|bus
suffix:semicolon
r_int
id|err
suffix:semicolon
r_static
id|snd_device_ops_t
id|dev_ops
op_assign
(brace
dot
id|dev_free
op_assign
id|snd_hda_bus_dev_free
comma
)brace
suffix:semicolon
id|snd_assert
c_func
(paren
id|temp
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|temp-&gt;ops.command
op_logical_and
id|temp-&gt;ops.get_response
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|busp
)paren
op_star
id|busp
op_assign
l_int|NULL
suffix:semicolon
id|bus
op_assign
id|kcalloc
c_func
(paren
l_int|1
comma
r_sizeof
(paren
op_star
id|bus
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|bus
op_eq
l_int|NULL
)paren
(brace
id|snd_printk
c_func
(paren
id|KERN_ERR
l_string|&quot;can&squot;t allocate struct hda_bus&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|bus-&gt;card
op_assign
id|card
suffix:semicolon
id|bus-&gt;private_data
op_assign
id|temp-&gt;private_data
suffix:semicolon
id|bus-&gt;pci
op_assign
id|temp-&gt;pci
suffix:semicolon
id|bus-&gt;modelname
op_assign
id|temp-&gt;modelname
suffix:semicolon
id|bus-&gt;ops
op_assign
id|temp-&gt;ops
suffix:semicolon
id|init_MUTEX
c_func
(paren
op_amp
id|bus-&gt;cmd_mutex
)paren
suffix:semicolon
id|INIT_LIST_HEAD
c_func
(paren
op_amp
id|bus-&gt;codec_list
)paren
suffix:semicolon
id|init_unsol_queue
c_func
(paren
id|bus
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_device_new
c_func
(paren
id|card
comma
id|SNDRV_DEV_BUS
comma
id|bus
comma
op_amp
id|dev_ops
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_hda_bus_free
c_func
(paren
id|bus
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
r_if
c_cond
(paren
id|busp
)paren
op_star
id|busp
op_assign
id|bus
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * find a matching codec preset&n; */
DECL|function|find_codec_preset
r_static
r_const
r_struct
id|hda_codec_preset
op_star
id|find_codec_preset
c_func
(paren
r_struct
id|hda_codec
op_star
id|codec
)paren
(brace
r_const
r_struct
id|hda_codec_preset
op_star
op_star
id|tbl
comma
op_star
id|preset
suffix:semicolon
r_for
c_loop
(paren
id|tbl
op_assign
id|hda_preset_tables
suffix:semicolon
op_star
id|tbl
suffix:semicolon
id|tbl
op_increment
)paren
(brace
r_for
c_loop
(paren
id|preset
op_assign
op_star
id|tbl
suffix:semicolon
id|preset-&gt;id
suffix:semicolon
id|preset
op_increment
)paren
(brace
id|u32
id|mask
op_assign
id|preset-&gt;mask
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|mask
)paren
id|mask
op_assign
op_complement
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|preset-&gt;id
op_eq
(paren
id|codec-&gt;vendor_id
op_amp
id|mask
)paren
)paren
r_return
id|preset
suffix:semicolon
)brace
)brace
r_return
l_int|NULL
suffix:semicolon
)brace
multiline_comment|/*&n; * snd_hda_get_codec_name - store the codec name&n; */
DECL|function|snd_hda_get_codec_name
r_void
id|snd_hda_get_codec_name
c_func
(paren
r_struct
id|hda_codec
op_star
id|codec
comma
r_char
op_star
id|name
comma
r_int
id|namelen
)paren
(brace
r_const
r_struct
id|hda_vendor_id
op_star
id|c
suffix:semicolon
r_const
r_char
op_star
id|vendor
op_assign
l_int|NULL
suffix:semicolon
id|u16
id|vendor_id
op_assign
id|codec-&gt;vendor_id
op_rshift
l_int|16
suffix:semicolon
r_char
id|tmp
(braket
l_int|16
)braket
suffix:semicolon
r_for
c_loop
(paren
id|c
op_assign
id|hda_vendor_ids
suffix:semicolon
id|c-&gt;id
suffix:semicolon
id|c
op_increment
)paren
(brace
r_if
c_cond
(paren
id|c-&gt;id
op_eq
id|vendor_id
)paren
(brace
id|vendor
op_assign
id|c-&gt;name
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
op_logical_neg
id|vendor
)paren
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;Generic %04x&quot;
comma
id|vendor_id
)paren
suffix:semicolon
id|vendor
op_assign
id|tmp
suffix:semicolon
)brace
r_if
c_cond
(paren
id|codec-&gt;preset
op_logical_and
id|codec-&gt;preset-&gt;name
)paren
id|snprintf
c_func
(paren
id|name
comma
id|namelen
comma
l_string|&quot;%s %s&quot;
comma
id|vendor
comma
id|codec-&gt;preset-&gt;name
)paren
suffix:semicolon
r_else
id|snprintf
c_func
(paren
id|name
comma
id|namelen
comma
l_string|&quot;%s ID %x&quot;
comma
id|vendor
comma
id|codec-&gt;vendor_id
op_amp
l_int|0xffff
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * look for an AFG node&n; *&n; * return 0 if not found&n; */
DECL|function|look_for_afg_node
r_static
r_int
id|look_for_afg_node
c_func
(paren
r_struct
id|hda_codec
op_star
id|codec
)paren
(brace
r_int
id|i
comma
id|total_nodes
suffix:semicolon
id|hda_nid_t
id|nid
suffix:semicolon
id|total_nodes
op_assign
id|snd_hda_get_sub_nodes
c_func
(paren
id|codec
comma
id|AC_NODE_ROOT
comma
op_amp
id|nid
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|total_nodes
suffix:semicolon
id|i
op_increment
comma
id|nid
op_increment
)paren
(brace
r_if
c_cond
(paren
id|snd_hda_param_read
c_func
(paren
id|codec
comma
id|nid
comma
id|AC_PAR_FUNCTION_TYPE
)paren
op_eq
id|AC_GRP_AUDIO_FUNCTION
)paren
r_return
id|nid
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * codec destructor&n; */
DECL|function|snd_hda_codec_free
r_static
r_void
id|snd_hda_codec_free
c_func
(paren
r_struct
id|hda_codec
op_star
id|codec
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|codec
)paren
r_return
suffix:semicolon
id|list_del
c_func
(paren
op_amp
id|codec-&gt;list
)paren
suffix:semicolon
id|codec-&gt;bus-&gt;caddr_tbl
(braket
id|codec-&gt;addr
)braket
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
id|codec-&gt;patch_ops.free
)paren
id|codec-&gt;patch_ops
dot
id|free
c_func
(paren
id|codec
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|codec
)paren
suffix:semicolon
)brace
r_static
r_void
id|init_amp_hash
c_func
(paren
r_struct
id|hda_codec
op_star
id|codec
)paren
suffix:semicolon
multiline_comment|/**&n; * snd_hda_codec_new - create a HDA codec&n; * @bus: the bus to assign&n; * @codec_addr: the codec address&n; * @codecp: the pointer to store the generated codec&n; *&n; * Returns 0 if successful, or a negative error code.&n; */
DECL|function|snd_hda_codec_new
r_int
id|snd_hda_codec_new
c_func
(paren
r_struct
id|hda_bus
op_star
id|bus
comma
r_int
r_int
id|codec_addr
comma
r_struct
id|hda_codec
op_star
op_star
id|codecp
)paren
(brace
r_struct
id|hda_codec
op_star
id|codec
suffix:semicolon
r_char
id|component
(braket
l_int|13
)braket
suffix:semicolon
r_int
id|err
suffix:semicolon
id|snd_assert
c_func
(paren
id|bus
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|codec_addr
op_le
id|HDA_MAX_CODEC_ADDRESS
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|bus-&gt;caddr_tbl
(braket
id|codec_addr
)braket
)paren
(brace
id|snd_printk
c_func
(paren
id|KERN_ERR
l_string|&quot;hda_codec: address 0x%x is already occupied&bslash;n&quot;
comma
id|codec_addr
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
id|codec
op_assign
id|kcalloc
c_func
(paren
l_int|1
comma
r_sizeof
(paren
op_star
id|codec
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|codec
op_eq
l_int|NULL
)paren
(brace
id|snd_printk
c_func
(paren
id|KERN_ERR
l_string|&quot;can&squot;t allocate struct hda_codec&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|codec-&gt;bus
op_assign
id|bus
suffix:semicolon
id|codec-&gt;addr
op_assign
id|codec_addr
suffix:semicolon
id|init_MUTEX
c_func
(paren
op_amp
id|codec-&gt;spdif_mutex
)paren
suffix:semicolon
id|init_amp_hash
c_func
(paren
id|codec
)paren
suffix:semicolon
id|list_add_tail
c_func
(paren
op_amp
id|codec-&gt;list
comma
op_amp
id|bus-&gt;codec_list
)paren
suffix:semicolon
id|bus-&gt;caddr_tbl
(braket
id|codec_addr
)braket
op_assign
id|codec
suffix:semicolon
id|codec-&gt;vendor_id
op_assign
id|snd_hda_param_read
c_func
(paren
id|codec
comma
id|AC_NODE_ROOT
comma
id|AC_PAR_VENDOR_ID
)paren
suffix:semicolon
id|codec-&gt;subsystem_id
op_assign
id|snd_hda_param_read
c_func
(paren
id|codec
comma
id|AC_NODE_ROOT
comma
id|AC_PAR_SUBSYSTEM_ID
)paren
suffix:semicolon
id|codec-&gt;revision_id
op_assign
id|snd_hda_param_read
c_func
(paren
id|codec
comma
id|AC_NODE_ROOT
comma
id|AC_PAR_REV_ID
)paren
suffix:semicolon
multiline_comment|/* FIXME: support for multiple AFGs? */
id|codec-&gt;afg
op_assign
id|look_for_afg_node
c_func
(paren
id|codec
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|codec-&gt;afg
)paren
(brace
id|snd_printk
c_func
(paren
id|KERN_ERR
l_string|&quot;hda_codec: no AFG node found&bslash;n&quot;
)paren
suffix:semicolon
id|snd_hda_codec_free
c_func
(paren
id|codec
)paren
suffix:semicolon
r_return
op_minus
id|ENODEV
suffix:semicolon
)brace
id|codec-&gt;preset
op_assign
id|find_codec_preset
c_func
(paren
id|codec
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
op_star
id|bus-&gt;card-&gt;mixername
)paren
id|snd_hda_get_codec_name
c_func
(paren
id|codec
comma
id|bus-&gt;card-&gt;mixername
comma
r_sizeof
(paren
id|bus-&gt;card-&gt;mixername
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|codec-&gt;preset
op_logical_and
id|codec-&gt;preset-&gt;patch
)paren
id|err
op_assign
id|codec-&gt;preset
op_member_access_from_pointer
id|patch
c_func
(paren
id|codec
)paren
suffix:semicolon
r_else
id|err
op_assign
id|snd_hda_parse_generic_codec
c_func
(paren
id|codec
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
(brace
id|snd_hda_codec_free
c_func
(paren
id|codec
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
id|snd_hda_codec_proc_new
c_func
(paren
id|codec
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|component
comma
l_string|&quot;HDA:%08x&quot;
comma
id|codec-&gt;vendor_id
)paren
suffix:semicolon
id|snd_component_add
c_func
(paren
id|codec-&gt;bus-&gt;card
comma
id|component
)paren
suffix:semicolon
r_if
c_cond
(paren
id|codecp
)paren
op_star
id|codecp
op_assign
id|codec
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_hda_codec_setup_stream - set up the codec for streaming&n; * @codec: the CODEC to set up&n; * @nid: the NID to set up&n; * @stream_tag: stream tag to pass, it&squot;s between 0x1 and 0xf.&n; * @channel_id: channel id to pass, zero based.&n; * @format: stream format.&n; */
DECL|function|snd_hda_codec_setup_stream
r_void
id|snd_hda_codec_setup_stream
c_func
(paren
r_struct
id|hda_codec
op_star
id|codec
comma
id|hda_nid_t
id|nid
comma
id|u32
id|stream_tag
comma
r_int
id|channel_id
comma
r_int
id|format
)paren
(brace
id|snd_printdd
c_func
(paren
l_string|&quot;hda_codec_setup_stream: NID=0x%x, stream=0x%x, channel=%d, format=0x%x&bslash;n&quot;
comma
id|nid
comma
id|stream_tag
comma
id|channel_id
comma
id|format
)paren
suffix:semicolon
id|snd_hda_codec_write
c_func
(paren
id|codec
comma
id|nid
comma
l_int|0
comma
id|AC_VERB_SET_CHANNEL_STREAMID
comma
(paren
id|stream_tag
op_lshift
l_int|4
)paren
op_or
id|channel_id
)paren
suffix:semicolon
id|msleep
c_func
(paren
l_int|1
)paren
suffix:semicolon
id|snd_hda_codec_write
c_func
(paren
id|codec
comma
id|nid
comma
l_int|0
comma
id|AC_VERB_SET_STREAM_FORMAT
comma
id|format
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * amp access functions&n; */
DECL|macro|HDA_HASH_KEY
mdefine_line|#define HDA_HASH_KEY(nid,dir,idx) (u32)((nid) + (idx) * 32 + (dir) * 64)
DECL|macro|INFO_AMP_CAPS
mdefine_line|#define INFO_AMP_CAPS&t;(1&lt;&lt;0)
DECL|macro|INFO_AMP_VOL
mdefine_line|#define INFO_AMP_VOL&t;(1&lt;&lt;1)
multiline_comment|/* initialize the hash table */
DECL|function|init_amp_hash
r_static
r_void
id|init_amp_hash
c_func
(paren
r_struct
id|hda_codec
op_star
id|codec
)paren
(brace
id|memset
c_func
(paren
id|codec-&gt;amp_hash
comma
l_int|0xff
comma
r_sizeof
(paren
id|codec-&gt;amp_hash
)paren
)paren
suffix:semicolon
id|codec-&gt;num_amp_entries
op_assign
l_int|0
suffix:semicolon
)brace
multiline_comment|/* query the hash.  allocate an entry if not found. */
DECL|function|get_alloc_amp_hash
r_static
r_struct
id|hda_amp_info
op_star
id|get_alloc_amp_hash
c_func
(paren
r_struct
id|hda_codec
op_star
id|codec
comma
id|u32
id|key
)paren
(brace
id|u16
id|idx
op_assign
id|key
op_mod
(paren
id|u16
)paren
id|ARRAY_SIZE
c_func
(paren
id|codec-&gt;amp_hash
)paren
suffix:semicolon
id|u16
id|cur
op_assign
id|codec-&gt;amp_hash
(braket
id|idx
)braket
suffix:semicolon
r_struct
id|hda_amp_info
op_star
id|info
suffix:semicolon
r_while
c_loop
(paren
id|cur
op_ne
l_int|0xffff
)paren
(brace
id|info
op_assign
op_amp
id|codec-&gt;amp_info
(braket
id|cur
)braket
suffix:semicolon
r_if
c_cond
(paren
id|info-&gt;key
op_eq
id|key
)paren
r_return
id|info
suffix:semicolon
id|cur
op_assign
id|info-&gt;next
suffix:semicolon
)brace
multiline_comment|/* add a new hash entry */
r_if
c_cond
(paren
id|codec-&gt;num_amp_entries
op_ge
id|ARRAY_SIZE
c_func
(paren
id|codec-&gt;amp_info
)paren
)paren
(brace
id|snd_printk
c_func
(paren
id|KERN_ERR
l_string|&quot;hda_codec: Tooooo many amps!&bslash;n&quot;
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
id|cur
op_assign
id|codec-&gt;num_amp_entries
op_increment
suffix:semicolon
id|info
op_assign
op_amp
id|codec-&gt;amp_info
(braket
id|cur
)braket
suffix:semicolon
id|info-&gt;key
op_assign
id|key
suffix:semicolon
id|info-&gt;status
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* not initialized yet */
id|info-&gt;next
op_assign
id|codec-&gt;amp_hash
(braket
id|idx
)braket
suffix:semicolon
id|codec-&gt;amp_hash
(braket
id|idx
)braket
op_assign
id|cur
suffix:semicolon
r_return
id|info
suffix:semicolon
)brace
multiline_comment|/*&n; * query AMP capabilities for the given widget and direction&n; */
DECL|function|query_amp_caps
r_static
id|u32
id|query_amp_caps
c_func
(paren
r_struct
id|hda_codec
op_star
id|codec
comma
id|hda_nid_t
id|nid
comma
r_int
id|direction
)paren
(brace
r_struct
id|hda_amp_info
op_star
id|info
op_assign
id|get_alloc_amp_hash
c_func
(paren
id|codec
comma
id|HDA_HASH_KEY
c_func
(paren
id|nid
comma
id|direction
comma
l_int|0
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|info
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|info-&gt;status
op_amp
id|INFO_AMP_CAPS
)paren
)paren
(brace
id|info-&gt;amp_caps
op_assign
id|snd_hda_param_read
c_func
(paren
id|codec
comma
id|nid
comma
id|direction
op_eq
id|HDA_OUTPUT
ques
c_cond
id|AC_PAR_AMP_OUT_CAP
suffix:colon
id|AC_PAR_AMP_IN_CAP
)paren
suffix:semicolon
id|info-&gt;status
op_or_assign
id|INFO_AMP_CAPS
suffix:semicolon
)brace
r_return
id|info-&gt;amp_caps
suffix:semicolon
)brace
multiline_comment|/*&n; * read the current volume to info&n; * if the cache exists, read from the cache.&n; */
DECL|function|get_vol_mute
r_static
r_void
id|get_vol_mute
c_func
(paren
r_struct
id|hda_codec
op_star
id|codec
comma
r_struct
id|hda_amp_info
op_star
id|info
comma
id|hda_nid_t
id|nid
comma
r_int
id|ch
comma
r_int
id|direction
comma
r_int
id|index
)paren
(brace
id|u32
id|val
comma
id|parm
suffix:semicolon
r_if
c_cond
(paren
id|info-&gt;status
op_amp
(paren
id|INFO_AMP_VOL
op_lshift
id|ch
)paren
)paren
r_return
suffix:semicolon
id|parm
op_assign
id|ch
ques
c_cond
id|AC_AMP_GET_RIGHT
suffix:colon
id|AC_AMP_GET_LEFT
suffix:semicolon
id|parm
op_or_assign
id|direction
op_eq
id|HDA_OUTPUT
ques
c_cond
id|AC_AMP_GET_OUTPUT
suffix:colon
id|AC_AMP_GET_INPUT
suffix:semicolon
id|parm
op_or_assign
id|index
suffix:semicolon
id|val
op_assign
id|snd_hda_codec_read
c_func
(paren
id|codec
comma
id|nid
comma
l_int|0
comma
id|AC_VERB_GET_AMP_GAIN_MUTE
comma
id|parm
)paren
suffix:semicolon
id|info-&gt;vol
(braket
id|ch
)braket
op_assign
id|val
op_amp
l_int|0xff
suffix:semicolon
id|info-&gt;status
op_or_assign
id|INFO_AMP_VOL
op_lshift
id|ch
suffix:semicolon
)brace
multiline_comment|/*&n; * write the current volume in info to the h/w&n; */
DECL|function|put_vol_mute
r_static
r_void
id|put_vol_mute
c_func
(paren
r_struct
id|hda_codec
op_star
id|codec
comma
id|hda_nid_t
id|nid
comma
r_int
id|ch
comma
r_int
id|direction
comma
r_int
id|index
comma
r_int
id|val
)paren
(brace
id|u32
id|parm
suffix:semicolon
id|parm
op_assign
id|ch
ques
c_cond
id|AC_AMP_SET_RIGHT
suffix:colon
id|AC_AMP_SET_LEFT
suffix:semicolon
id|parm
op_or_assign
id|direction
op_eq
id|HDA_OUTPUT
ques
c_cond
id|AC_AMP_SET_OUTPUT
suffix:colon
id|AC_AMP_SET_INPUT
suffix:semicolon
id|parm
op_or_assign
id|index
op_lshift
id|AC_AMP_SET_INDEX_SHIFT
suffix:semicolon
id|parm
op_or_assign
id|val
suffix:semicolon
id|snd_hda_codec_write
c_func
(paren
id|codec
comma
id|nid
comma
l_int|0
comma
id|AC_VERB_SET_AMP_GAIN_MUTE
comma
id|parm
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * read/write AMP value.  The volume is between 0 to 0x7f, 0x80 = mute bit.&n; */
DECL|function|snd_hda_codec_amp_read
r_int
id|snd_hda_codec_amp_read
c_func
(paren
r_struct
id|hda_codec
op_star
id|codec
comma
id|hda_nid_t
id|nid
comma
r_int
id|ch
comma
r_int
id|direction
comma
r_int
id|index
)paren
(brace
r_struct
id|hda_amp_info
op_star
id|info
op_assign
id|get_alloc_amp_hash
c_func
(paren
id|codec
comma
id|HDA_HASH_KEY
c_func
(paren
id|nid
comma
id|direction
comma
id|index
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|info
)paren
r_return
l_int|0
suffix:semicolon
id|get_vol_mute
c_func
(paren
id|codec
comma
id|info
comma
id|nid
comma
id|ch
comma
id|direction
comma
id|index
)paren
suffix:semicolon
r_return
id|info-&gt;vol
(braket
id|ch
)braket
suffix:semicolon
)brace
DECL|function|snd_hda_codec_amp_write
r_int
id|snd_hda_codec_amp_write
c_func
(paren
r_struct
id|hda_codec
op_star
id|codec
comma
id|hda_nid_t
id|nid
comma
r_int
id|ch
comma
r_int
id|direction
comma
r_int
id|idx
comma
r_int
id|val
)paren
(brace
r_struct
id|hda_amp_info
op_star
id|info
op_assign
id|get_alloc_amp_hash
c_func
(paren
id|codec
comma
id|HDA_HASH_KEY
c_func
(paren
id|nid
comma
id|direction
comma
id|idx
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|info
)paren
r_return
l_int|0
suffix:semicolon
id|get_vol_mute
c_func
(paren
id|codec
comma
id|info
comma
id|nid
comma
id|ch
comma
id|direction
comma
id|idx
)paren
suffix:semicolon
r_if
c_cond
(paren
id|info-&gt;vol
(braket
id|ch
)braket
op_eq
id|val
op_logical_and
op_logical_neg
id|codec-&gt;in_resume
)paren
r_return
l_int|0
suffix:semicolon
id|put_vol_mute
c_func
(paren
id|codec
comma
id|nid
comma
id|ch
comma
id|direction
comma
id|idx
comma
id|val
)paren
suffix:semicolon
id|info-&gt;vol
(braket
id|ch
)braket
op_assign
id|val
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
multiline_comment|/*&n; * AMP control callbacks&n; */
multiline_comment|/* retrieve parameters from private_value */
DECL|macro|get_amp_nid
mdefine_line|#define get_amp_nid(kc)&t;&t;((kc)-&gt;private_value &amp; 0xffff)
DECL|macro|get_amp_channels
mdefine_line|#define get_amp_channels(kc)&t;(((kc)-&gt;private_value &gt;&gt; 16) &amp; 0x3)
DECL|macro|get_amp_direction
mdefine_line|#define get_amp_direction(kc)&t;(((kc)-&gt;private_value &gt;&gt; 18) &amp; 0x1)
DECL|macro|get_amp_index
mdefine_line|#define get_amp_index(kc)&t;(((kc)-&gt;private_value &gt;&gt; 19) &amp; 0xf)
multiline_comment|/* volume */
DECL|function|snd_hda_mixer_amp_volume_info
r_int
id|snd_hda_mixer_amp_volume_info
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
r_struct
id|hda_codec
op_star
id|codec
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|u16
id|nid
op_assign
id|get_amp_nid
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|u8
id|chs
op_assign
id|get_amp_channels
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|dir
op_assign
id|get_amp_direction
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|u32
id|caps
suffix:semicolon
id|caps
op_assign
id|query_amp_caps
c_func
(paren
id|codec
comma
id|nid
comma
id|dir
)paren
suffix:semicolon
id|caps
op_assign
(paren
id|caps
op_amp
id|AC_AMPCAP_NUM_STEPS
)paren
op_rshift
id|AC_AMPCAP_NUM_STEPS_SHIFT
suffix:semicolon
multiline_comment|/* num steps */
r_if
c_cond
(paren
op_logical_neg
id|caps
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;hda_codec: num_steps = 0 for NID=0x%x&bslash;n&quot;
comma
id|nid
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_INTEGER
suffix:semicolon
id|uinfo-&gt;count
op_assign
id|chs
op_eq
l_int|3
ques
c_cond
l_int|2
suffix:colon
l_int|1
suffix:semicolon
id|uinfo-&gt;value.integer.min
op_assign
l_int|0
suffix:semicolon
id|uinfo-&gt;value.integer.max
op_assign
id|caps
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hda_mixer_amp_volume_get
r_int
id|snd_hda_mixer_amp_volume_get
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
r_struct
id|hda_codec
op_star
id|codec
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|hda_nid_t
id|nid
op_assign
id|get_amp_nid
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|chs
op_assign
id|get_amp_channels
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|dir
op_assign
id|get_amp_direction
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|idx
op_assign
id|get_amp_index
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
op_star
id|valp
op_assign
id|ucontrol-&gt;value.integer.value
suffix:semicolon
r_if
c_cond
(paren
id|chs
op_amp
l_int|1
)paren
op_star
id|valp
op_increment
op_assign
id|snd_hda_codec_amp_read
c_func
(paren
id|codec
comma
id|nid
comma
l_int|0
comma
id|dir
comma
id|idx
)paren
op_amp
l_int|0x7f
suffix:semicolon
r_if
c_cond
(paren
id|chs
op_amp
l_int|2
)paren
op_star
id|valp
op_assign
id|snd_hda_codec_amp_read
c_func
(paren
id|codec
comma
id|nid
comma
l_int|1
comma
id|dir
comma
id|idx
)paren
op_amp
l_int|0x7f
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hda_mixer_amp_volume_put
r_int
id|snd_hda_mixer_amp_volume_put
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
r_struct
id|hda_codec
op_star
id|codec
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|hda_nid_t
id|nid
op_assign
id|get_amp_nid
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|chs
op_assign
id|get_amp_channels
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|dir
op_assign
id|get_amp_direction
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|idx
op_assign
id|get_amp_index
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|val
suffix:semicolon
r_int
op_star
id|valp
op_assign
id|ucontrol-&gt;value.integer.value
suffix:semicolon
r_int
id|change
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|chs
op_amp
l_int|1
)paren
(brace
id|val
op_assign
op_star
id|valp
op_amp
l_int|0x7f
suffix:semicolon
id|val
op_or_assign
id|snd_hda_codec_amp_read
c_func
(paren
id|codec
comma
id|nid
comma
l_int|0
comma
id|dir
comma
id|idx
)paren
op_amp
l_int|0x80
suffix:semicolon
id|change
op_assign
id|snd_hda_codec_amp_write
c_func
(paren
id|codec
comma
id|nid
comma
l_int|0
comma
id|dir
comma
id|idx
comma
id|val
)paren
suffix:semicolon
id|valp
op_increment
suffix:semicolon
)brace
r_if
c_cond
(paren
id|chs
op_amp
l_int|2
)paren
(brace
id|val
op_assign
op_star
id|valp
op_amp
l_int|0x7f
suffix:semicolon
id|val
op_or_assign
id|snd_hda_codec_amp_read
c_func
(paren
id|codec
comma
id|nid
comma
l_int|1
comma
id|dir
comma
id|idx
)paren
op_amp
l_int|0x80
suffix:semicolon
id|change
op_or_assign
id|snd_hda_codec_amp_write
c_func
(paren
id|codec
comma
id|nid
comma
l_int|1
comma
id|dir
comma
id|idx
comma
id|val
)paren
suffix:semicolon
)brace
r_return
id|change
suffix:semicolon
)brace
multiline_comment|/* switch */
DECL|function|snd_hda_mixer_amp_switch_info
r_int
id|snd_hda_mixer_amp_switch_info
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
r_int
id|chs
op_assign
id|get_amp_channels
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_BOOLEAN
suffix:semicolon
id|uinfo-&gt;count
op_assign
id|chs
op_eq
l_int|3
ques
c_cond
l_int|2
suffix:colon
l_int|1
suffix:semicolon
id|uinfo-&gt;value.integer.min
op_assign
l_int|0
suffix:semicolon
id|uinfo-&gt;value.integer.max
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hda_mixer_amp_switch_get
r_int
id|snd_hda_mixer_amp_switch_get
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
r_struct
id|hda_codec
op_star
id|codec
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|hda_nid_t
id|nid
op_assign
id|get_amp_nid
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|chs
op_assign
id|get_amp_channels
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|dir
op_assign
id|get_amp_direction
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|idx
op_assign
id|get_amp_index
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
op_star
id|valp
op_assign
id|ucontrol-&gt;value.integer.value
suffix:semicolon
r_if
c_cond
(paren
id|chs
op_amp
l_int|1
)paren
op_star
id|valp
op_increment
op_assign
(paren
id|snd_hda_codec_amp_read
c_func
(paren
id|codec
comma
id|nid
comma
l_int|0
comma
id|dir
comma
id|idx
)paren
op_amp
l_int|0x80
)paren
ques
c_cond
l_int|0
suffix:colon
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|chs
op_amp
l_int|2
)paren
op_star
id|valp
op_assign
(paren
id|snd_hda_codec_amp_read
c_func
(paren
id|codec
comma
id|nid
comma
l_int|1
comma
id|dir
comma
id|idx
)paren
op_amp
l_int|0x80
)paren
ques
c_cond
l_int|0
suffix:colon
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hda_mixer_amp_switch_put
r_int
id|snd_hda_mixer_amp_switch_put
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
r_struct
id|hda_codec
op_star
id|codec
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|hda_nid_t
id|nid
op_assign
id|get_amp_nid
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|chs
op_assign
id|get_amp_channels
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|dir
op_assign
id|get_amp_direction
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|idx
op_assign
id|get_amp_index
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|val
suffix:semicolon
r_int
op_star
id|valp
op_assign
id|ucontrol-&gt;value.integer.value
suffix:semicolon
r_int
id|change
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|chs
op_amp
l_int|1
)paren
(brace
id|val
op_assign
id|snd_hda_codec_amp_read
c_func
(paren
id|codec
comma
id|nid
comma
l_int|0
comma
id|dir
comma
id|idx
)paren
op_amp
l_int|0x7f
suffix:semicolon
id|val
op_or_assign
op_star
id|valp
ques
c_cond
l_int|0
suffix:colon
l_int|0x80
suffix:semicolon
id|change
op_assign
id|snd_hda_codec_amp_write
c_func
(paren
id|codec
comma
id|nid
comma
l_int|0
comma
id|dir
comma
id|idx
comma
id|val
)paren
suffix:semicolon
id|valp
op_increment
suffix:semicolon
)brace
r_if
c_cond
(paren
id|chs
op_amp
l_int|2
)paren
(brace
id|val
op_assign
id|snd_hda_codec_amp_read
c_func
(paren
id|codec
comma
id|nid
comma
l_int|1
comma
id|dir
comma
id|idx
)paren
op_amp
l_int|0x7f
suffix:semicolon
id|val
op_or_assign
op_star
id|valp
ques
c_cond
l_int|0
suffix:colon
l_int|0x80
suffix:semicolon
id|change
op_assign
id|snd_hda_codec_amp_write
c_func
(paren
id|codec
comma
id|nid
comma
l_int|1
comma
id|dir
comma
id|idx
comma
id|val
)paren
suffix:semicolon
)brace
r_return
id|change
suffix:semicolon
)brace
multiline_comment|/*&n; * SPDIF out controls&n; */
DECL|function|snd_hda_spdif_mask_info
r_static
r_int
id|snd_hda_spdif_mask_info
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_IEC958
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hda_spdif_cmask_get
r_static
r_int
id|snd_hda_spdif_cmask_get
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|ucontrol-&gt;value.iec958.status
(braket
l_int|0
)braket
op_assign
id|IEC958_AES0_PROFESSIONAL
op_or
id|IEC958_AES0_NONAUDIO
op_or
id|IEC958_AES0_CON_EMPHASIS_5015
op_or
id|IEC958_AES0_CON_NOT_COPYRIGHT
suffix:semicolon
id|ucontrol-&gt;value.iec958.status
(braket
l_int|1
)braket
op_assign
id|IEC958_AES1_CON_CATEGORY
op_or
id|IEC958_AES1_CON_ORIGINAL
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hda_spdif_pmask_get
r_static
r_int
id|snd_hda_spdif_pmask_get
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|ucontrol-&gt;value.iec958.status
(braket
l_int|0
)braket
op_assign
id|IEC958_AES0_PROFESSIONAL
op_or
id|IEC958_AES0_NONAUDIO
op_or
id|IEC958_AES0_PRO_EMPHASIS_5015
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hda_spdif_default_get
r_static
r_int
id|snd_hda_spdif_default_get
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
r_struct
id|hda_codec
op_star
id|codec
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|ucontrol-&gt;value.iec958.status
(braket
l_int|0
)braket
op_assign
id|codec-&gt;spdif_status
op_amp
l_int|0xff
suffix:semicolon
id|ucontrol-&gt;value.iec958.status
(braket
l_int|1
)braket
op_assign
(paren
id|codec-&gt;spdif_status
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
suffix:semicolon
id|ucontrol-&gt;value.iec958.status
(braket
l_int|2
)braket
op_assign
(paren
id|codec-&gt;spdif_status
op_rshift
l_int|16
)paren
op_amp
l_int|0xff
suffix:semicolon
id|ucontrol-&gt;value.iec958.status
(braket
l_int|3
)braket
op_assign
(paren
id|codec-&gt;spdif_status
op_rshift
l_int|24
)paren
op_amp
l_int|0xff
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hda_spdif_default_put
r_static
r_int
id|snd_hda_spdif_default_put
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
r_struct
id|hda_codec
op_star
id|codec
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|hda_nid_t
id|nid
op_assign
id|kcontrol-&gt;private_value
suffix:semicolon
r_int
r_int
id|sbits
suffix:semicolon
r_int
r_int
id|val
suffix:semicolon
r_int
id|change
suffix:semicolon
id|val
op_assign
l_int|0
suffix:semicolon
id|down
c_func
(paren
op_amp
id|codec-&gt;spdif_mutex
)paren
suffix:semicolon
id|sbits
op_assign
id|codec-&gt;spdif_status
op_amp
l_int|1
suffix:semicolon
id|sbits
op_or_assign
id|ucontrol-&gt;value.iec958.status
(braket
l_int|0
)braket
op_amp
(paren
id|IEC958_AES0_PROFESSIONAL
op_or
id|IEC958_AES0_NONAUDIO
)paren
suffix:semicolon
r_if
c_cond
(paren
id|sbits
op_amp
id|IEC958_AES0_PROFESSIONAL
)paren
id|val
op_assign
l_int|1
op_lshift
l_int|6
suffix:semicolon
r_if
c_cond
(paren
id|sbits
op_amp
id|IEC958_AES0_NONAUDIO
)paren
id|val
op_or_assign
l_int|1
op_lshift
l_int|5
suffix:semicolon
r_if
c_cond
(paren
id|sbits
op_amp
id|IEC958_AES0_PROFESSIONAL
)paren
(brace
id|sbits
op_or_assign
id|ucontrol-&gt;value.iec958.status
(braket
l_int|0
)braket
op_amp
id|IEC958_AES0_PRO_EMPHASIS
suffix:semicolon
r_if
c_cond
(paren
(paren
id|sbits
op_amp
id|IEC958_AES0_PRO_EMPHASIS
)paren
op_eq
id|IEC958_AES0_PRO_EMPHASIS_5015
)paren
id|val
op_or_assign
l_int|1
op_lshift
l_int|3
suffix:semicolon
)brace
r_else
(brace
id|sbits
op_or_assign
id|ucontrol-&gt;value.iec958.status
(braket
l_int|0
)braket
op_amp
(paren
id|IEC958_AES0_CON_EMPHASIS
op_or
id|IEC958_AES0_CON_NOT_COPYRIGHT
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|sbits
op_amp
id|IEC958_AES0_CON_EMPHASIS
)paren
op_eq
id|IEC958_AES0_CON_EMPHASIS_5015
)paren
id|val
op_or_assign
l_int|1
op_lshift
l_int|3
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|sbits
op_amp
id|IEC958_AES0_CON_NOT_COPYRIGHT
)paren
)paren
id|val
op_or_assign
l_int|1
op_lshift
l_int|4
suffix:semicolon
id|sbits
op_or_assign
id|ucontrol-&gt;value.iec958.status
(braket
l_int|1
)braket
op_lshift
l_int|8
suffix:semicolon
r_if
c_cond
(paren
id|sbits
op_amp
(paren
id|IEC958_AES1_CON_ORIGINAL
op_lshift
l_int|8
)paren
)paren
id|val
op_or_assign
l_int|1
op_lshift
l_int|7
suffix:semicolon
id|val
op_or_assign
id|sbits
op_amp
(paren
id|IEC958_AES1_CON_CATEGORY
op_lshift
l_int|8
)paren
suffix:semicolon
)brace
id|change
op_assign
id|codec-&gt;spdif_status
op_ne
id|sbits
suffix:semicolon
id|codec-&gt;spdif_status
op_assign
id|sbits
suffix:semicolon
r_if
c_cond
(paren
id|change
)paren
(brace
id|snd_hda_codec_write
c_func
(paren
id|codec
comma
id|nid
comma
l_int|0
comma
id|AC_VERB_SET_DIGI_CONVERT_1
comma
id|val
op_amp
l_int|0xff
)paren
suffix:semicolon
id|snd_hda_codec_write
c_func
(paren
id|codec
comma
id|nid
comma
l_int|0
comma
id|AC_VERB_SET_DIGI_CONVERT_2
comma
id|val
op_rshift
l_int|8
)paren
suffix:semicolon
)brace
id|up
c_func
(paren
op_amp
id|codec-&gt;spdif_mutex
)paren
suffix:semicolon
r_return
id|change
suffix:semicolon
)brace
DECL|function|snd_hda_spdif_out_switch_info
r_static
r_int
id|snd_hda_spdif_out_switch_info
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_BOOLEAN
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
id|uinfo-&gt;value.integer.min
op_assign
l_int|0
suffix:semicolon
id|uinfo-&gt;value.integer.max
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hda_spdif_out_switch_get
r_static
r_int
id|snd_hda_spdif_out_switch_get
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
r_struct
id|hda_codec
op_star
id|codec
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
id|codec-&gt;spdif_status
op_amp
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hda_spdif_out_switch_put
r_static
r_int
id|snd_hda_spdif_out_switch_put
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
r_struct
id|hda_codec
op_star
id|codec
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|hda_nid_t
id|nid
op_assign
id|kcontrol-&gt;private_value
suffix:semicolon
r_int
r_int
id|sbits
suffix:semicolon
r_int
id|change
suffix:semicolon
id|down
c_func
(paren
op_amp
id|codec-&gt;spdif_mutex
)paren
suffix:semicolon
id|sbits
op_assign
id|codec-&gt;spdif_status
op_amp
op_complement
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
)paren
id|sbits
op_or_assign
l_int|1
suffix:semicolon
id|change
op_assign
id|codec-&gt;spdif_status
op_ne
id|sbits
suffix:semicolon
r_if
c_cond
(paren
id|change
)paren
(brace
id|codec-&gt;spdif_status
op_assign
id|sbits
suffix:semicolon
id|snd_hda_codec_write
c_func
(paren
id|codec
comma
id|nid
comma
l_int|0
comma
id|AC_VERB_SET_DIGI_CONVERT_1
comma
id|sbits
op_amp
l_int|0xff
)paren
suffix:semicolon
)brace
id|up
c_func
(paren
op_amp
id|codec-&gt;spdif_mutex
)paren
suffix:semicolon
r_return
id|change
suffix:semicolon
)brace
DECL|variable|dig_mixes
r_static
id|snd_kcontrol_new_t
id|dig_mixes
(braket
)braket
op_assign
(brace
(brace
dot
id|access
op_assign
id|SNDRV_CTL_ELEM_ACCESS_READ
comma
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_MIXER
comma
dot
id|name
op_assign
id|SNDRV_CTL_NAME_IEC958
c_func
(paren
l_string|&quot;&quot;
comma
id|PLAYBACK
comma
id|CON_MASK
)paren
comma
dot
id|info
op_assign
id|snd_hda_spdif_mask_info
comma
dot
id|get
op_assign
id|snd_hda_spdif_cmask_get
comma
)brace
comma
(brace
dot
id|access
op_assign
id|SNDRV_CTL_ELEM_ACCESS_READ
comma
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_MIXER
comma
dot
id|name
op_assign
id|SNDRV_CTL_NAME_IEC958
c_func
(paren
l_string|&quot;&quot;
comma
id|PLAYBACK
comma
id|PRO_MASK
)paren
comma
dot
id|info
op_assign
id|snd_hda_spdif_mask_info
comma
dot
id|get
op_assign
id|snd_hda_spdif_pmask_get
comma
)brace
comma
(brace
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_MIXER
comma
dot
id|name
op_assign
id|SNDRV_CTL_NAME_IEC958
c_func
(paren
l_string|&quot;&quot;
comma
id|PLAYBACK
comma
id|DEFAULT
)paren
comma
dot
id|info
op_assign
id|snd_hda_spdif_mask_info
comma
dot
id|get
op_assign
id|snd_hda_spdif_default_get
comma
dot
id|put
op_assign
id|snd_hda_spdif_default_put
comma
)brace
comma
(brace
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_MIXER
comma
dot
id|name
op_assign
id|SNDRV_CTL_NAME_IEC958
c_func
(paren
l_string|&quot;&quot;
comma
id|PLAYBACK
comma
id|SWITCH
)paren
comma
dot
id|info
op_assign
id|snd_hda_spdif_out_switch_info
comma
dot
id|get
op_assign
id|snd_hda_spdif_out_switch_get
comma
dot
id|put
op_assign
id|snd_hda_spdif_out_switch_put
comma
)brace
comma
(brace
)brace
multiline_comment|/* end */
)brace
suffix:semicolon
multiline_comment|/**&n; * snd_hda_create_spdif_out_ctls - create SPDIF-related controls&n; * @codec: the HDA codec&n; * @nid: audio out widget NID&n; *&n; * Creates controls related with the SPDIF output.&n; * Called from each patch supporting the SPDIF out.&n; *&n; * Returns 0 if successful, or a negative error code.&n; */
DECL|function|snd_hda_create_spdif_out_ctls
r_int
id|snd_hda_create_spdif_out_ctls
c_func
(paren
r_struct
id|hda_codec
op_star
id|codec
comma
id|hda_nid_t
id|nid
)paren
(brace
r_int
id|err
suffix:semicolon
id|snd_kcontrol_t
op_star
id|kctl
suffix:semicolon
id|snd_kcontrol_new_t
op_star
id|dig_mix
suffix:semicolon
r_for
c_loop
(paren
id|dig_mix
op_assign
id|dig_mixes
suffix:semicolon
id|dig_mix-&gt;name
suffix:semicolon
id|dig_mix
op_increment
)paren
(brace
id|kctl
op_assign
id|snd_ctl_new1
c_func
(paren
id|dig_mix
comma
id|codec
)paren
suffix:semicolon
id|kctl-&gt;private_value
op_assign
id|nid
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|codec-&gt;bus-&gt;card
comma
id|kctl
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
macro_line|#if 0
multiline_comment|/* not enabled, consumer, audio, no emphasis, original, PCM coder */
id|codec-&gt;spdif_status
op_assign
(paren
l_int|1
op_lshift
l_int|7
)paren
op_or
(paren
l_int|0x02
op_lshift
l_int|8
)paren
suffix:semicolon
macro_line|#else
id|codec-&gt;spdif_status
op_assign
id|snd_hda_codec_read
c_func
(paren
id|codec
comma
id|nid
comma
l_int|0
comma
id|AC_VERB_GET_DIGI_CONVERT
comma
l_int|0
)paren
suffix:semicolon
macro_line|#endif
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_hda_build_controls - build mixer controls&n; * @bus: the BUS&n; *&n; * Creates mixer controls for each codec included in the bus.&n; *&n; * Returns 0 if successful, otherwise a negative error code.&n; */
DECL|function|snd_hda_build_controls
r_int
id|snd_hda_build_controls
c_func
(paren
r_struct
id|hda_bus
op_star
id|bus
)paren
(brace
r_struct
id|list_head
op_star
id|p
suffix:semicolon
multiline_comment|/* build controls */
id|list_for_each
c_func
(paren
id|p
comma
op_amp
id|bus-&gt;codec_list
)paren
(brace
r_struct
id|hda_codec
op_star
id|codec
op_assign
id|list_entry
c_func
(paren
id|p
comma
r_struct
id|hda_codec
comma
id|list
)paren
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|codec-&gt;patch_ops.build_controls
)paren
r_continue
suffix:semicolon
id|err
op_assign
id|codec-&gt;patch_ops
dot
id|build_controls
c_func
(paren
id|codec
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
multiline_comment|/* initialize */
id|list_for_each
c_func
(paren
id|p
comma
op_amp
id|bus-&gt;codec_list
)paren
(brace
r_struct
id|hda_codec
op_star
id|codec
op_assign
id|list_entry
c_func
(paren
id|p
comma
r_struct
id|hda_codec
comma
id|list
)paren
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|codec-&gt;patch_ops.init
)paren
r_continue
suffix:semicolon
id|err
op_assign
id|codec-&gt;patch_ops
dot
id|init
c_func
(paren
id|codec
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * stream formats&n; */
DECL|variable|rate_bits
r_static
r_int
r_int
id|rate_bits
(braket
)braket
(braket
l_int|3
)braket
op_assign
(brace
multiline_comment|/* rate in Hz, ALSA rate bitmask, HDA format value */
(brace
l_int|8000
comma
id|SNDRV_PCM_RATE_8000
comma
l_int|0x0500
)brace
comma
multiline_comment|/* 1/6 x 48 */
(brace
l_int|11025
comma
id|SNDRV_PCM_RATE_11025
comma
l_int|0x4300
)brace
comma
multiline_comment|/* 1/4 x 44 */
(brace
l_int|16000
comma
id|SNDRV_PCM_RATE_16000
comma
l_int|0x0200
)brace
comma
multiline_comment|/* 1/3 x 48 */
(brace
l_int|22050
comma
id|SNDRV_PCM_RATE_22050
comma
l_int|0x4100
)brace
comma
multiline_comment|/* 1/2 x 44 */
(brace
l_int|32000
comma
id|SNDRV_PCM_RATE_32000
comma
l_int|0x0a00
)brace
comma
multiline_comment|/* 2/3 x 48 */
(brace
l_int|44100
comma
id|SNDRV_PCM_RATE_44100
comma
l_int|0x4000
)brace
comma
multiline_comment|/* 44 */
(brace
l_int|48000
comma
id|SNDRV_PCM_RATE_48000
comma
l_int|0x0000
)brace
comma
multiline_comment|/* 48 */
(brace
l_int|88200
comma
id|SNDRV_PCM_RATE_88200
comma
l_int|0x4800
)brace
comma
multiline_comment|/* 2 x 44 */
(brace
l_int|96000
comma
id|SNDRV_PCM_RATE_96000
comma
l_int|0x0800
)brace
comma
multiline_comment|/* 2 x 48 */
(brace
l_int|176400
comma
id|SNDRV_PCM_RATE_176400
comma
l_int|0x5800
)brace
comma
multiline_comment|/* 4 x 44 */
(brace
l_int|192000
comma
id|SNDRV_PCM_RATE_192000
comma
l_int|0x1800
)brace
comma
multiline_comment|/* 4 x 48 */
(brace
l_int|0
)brace
)brace
suffix:semicolon
multiline_comment|/**&n; * snd_hda_calc_stream_format - calculate format bitset&n; * @rate: the sample rate&n; * @channels: the number of channels&n; * @format: the PCM format (SNDRV_PCM_FORMAT_XXX)&n; * @maxbps: the max. bps&n; *&n; * Calculate the format bitset from the given rate, channels and th PCM format.&n; *&n; * Return zero if invalid.&n; */
DECL|function|snd_hda_calc_stream_format
r_int
r_int
id|snd_hda_calc_stream_format
c_func
(paren
r_int
r_int
id|rate
comma
r_int
r_int
id|channels
comma
r_int
r_int
id|format
comma
r_int
r_int
id|maxbps
)paren
(brace
r_int
id|i
suffix:semicolon
r_int
r_int
id|val
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|rate_bits
(braket
id|i
)braket
(braket
l_int|0
)braket
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|rate_bits
(braket
id|i
)braket
(braket
l_int|0
)braket
op_eq
id|rate
)paren
(brace
id|val
op_assign
id|rate_bits
(braket
id|i
)braket
(braket
l_int|2
)braket
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|rate_bits
(braket
id|i
)braket
(braket
l_int|0
)braket
)paren
(brace
id|snd_printdd
c_func
(paren
l_string|&quot;invalid rate %d&bslash;n&quot;
comma
id|rate
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|channels
op_eq
l_int|0
op_logical_or
id|channels
OG
l_int|8
)paren
(brace
id|snd_printdd
c_func
(paren
l_string|&quot;invalid channels %d&bslash;n&quot;
comma
id|channels
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|val
op_or_assign
id|channels
op_minus
l_int|1
suffix:semicolon
r_switch
c_cond
(paren
id|snd_pcm_format_width
c_func
(paren
id|format
)paren
)paren
(brace
r_case
l_int|8
suffix:colon
id|val
op_or_assign
l_int|0x00
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|16
suffix:colon
id|val
op_or_assign
l_int|0x10
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|20
suffix:colon
r_case
l_int|24
suffix:colon
r_case
l_int|32
suffix:colon
r_if
c_cond
(paren
id|maxbps
op_ge
l_int|32
)paren
id|val
op_or_assign
l_int|0x40
suffix:semicolon
r_else
r_if
c_cond
(paren
id|maxbps
op_ge
l_int|24
)paren
id|val
op_or_assign
l_int|0x30
suffix:semicolon
r_else
id|val
op_or_assign
l_int|0x20
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|snd_printdd
c_func
(paren
l_string|&quot;invalid format width %d&bslash;n&quot;
comma
id|snd_pcm_format_width
c_func
(paren
id|format
)paren
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_return
id|val
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_hda_query_supported_pcm - query the supported PCM rates and formats&n; * @codec: the HDA codec&n; * @nid: NID to query&n; * @ratesp: the pointer to store the detected rate bitflags&n; * @formatsp: the pointer to store the detected formats&n; * @bpsp: the pointer to store the detected format widths&n; *&n; * Queries the supported PCM rates and formats.  The NULL @ratesp, @formatsp&n; * or @bsps argument is ignored.&n; *&n; * Returns 0 if successful, otherwise a negative error code.&n; */
DECL|function|snd_hda_query_supported_pcm
r_int
id|snd_hda_query_supported_pcm
c_func
(paren
r_struct
id|hda_codec
op_star
id|codec
comma
id|hda_nid_t
id|nid
comma
id|u32
op_star
id|ratesp
comma
id|u64
op_star
id|formatsp
comma
r_int
r_int
op_star
id|bpsp
)paren
(brace
r_int
id|i
suffix:semicolon
r_int
r_int
id|val
comma
id|streams
suffix:semicolon
id|val
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|nid
op_ne
id|codec-&gt;afg
op_logical_and
id|snd_hda_param_read
c_func
(paren
id|codec
comma
id|nid
comma
id|AC_PAR_AUDIO_WIDGET_CAP
)paren
op_amp
id|AC_WCAP_FORMAT_OVRD
)paren
(brace
id|val
op_assign
id|snd_hda_param_read
c_func
(paren
id|codec
comma
id|nid
comma
id|AC_PAR_PCM
)paren
suffix:semicolon
r_if
c_cond
(paren
id|val
op_eq
op_minus
l_int|1
)paren
r_return
op_minus
id|EIO
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|val
)paren
id|val
op_assign
id|snd_hda_param_read
c_func
(paren
id|codec
comma
id|codec-&gt;afg
comma
id|AC_PAR_PCM
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ratesp
)paren
(brace
id|u32
id|rates
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|rate_bits
(braket
id|i
)braket
(braket
l_int|0
)braket
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|val
op_amp
(paren
l_int|1
op_lshift
id|i
)paren
)paren
id|rates
op_or_assign
id|rate_bits
(braket
id|i
)braket
(braket
l_int|1
)braket
suffix:semicolon
)brace
op_star
id|ratesp
op_assign
id|rates
suffix:semicolon
)brace
r_if
c_cond
(paren
id|formatsp
op_logical_or
id|bpsp
)paren
(brace
id|u64
id|formats
op_assign
l_int|0
suffix:semicolon
r_int
r_int
id|bps
suffix:semicolon
r_int
r_int
id|wcaps
suffix:semicolon
id|wcaps
op_assign
id|snd_hda_param_read
c_func
(paren
id|codec
comma
id|nid
comma
id|AC_PAR_AUDIO_WIDGET_CAP
)paren
suffix:semicolon
id|streams
op_assign
id|snd_hda_param_read
c_func
(paren
id|codec
comma
id|nid
comma
id|AC_PAR_STREAM
)paren
suffix:semicolon
r_if
c_cond
(paren
id|streams
op_eq
op_minus
l_int|1
)paren
r_return
op_minus
id|EIO
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|streams
)paren
(brace
id|streams
op_assign
id|snd_hda_param_read
c_func
(paren
id|codec
comma
id|codec-&gt;afg
comma
id|AC_PAR_STREAM
)paren
suffix:semicolon
r_if
c_cond
(paren
id|streams
op_eq
op_minus
l_int|1
)paren
r_return
op_minus
id|EIO
suffix:semicolon
)brace
id|bps
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|streams
op_amp
id|AC_SUPFMT_PCM
)paren
(brace
r_if
c_cond
(paren
id|val
op_amp
id|AC_SUPPCM_BITS_8
)paren
(brace
id|formats
op_or_assign
id|SNDRV_PCM_FMTBIT_U8
suffix:semicolon
id|bps
op_assign
l_int|8
suffix:semicolon
)brace
r_if
c_cond
(paren
id|val
op_amp
id|AC_SUPPCM_BITS_16
)paren
(brace
id|formats
op_or_assign
id|SNDRV_PCM_FMTBIT_S16_LE
suffix:semicolon
id|bps
op_assign
l_int|16
suffix:semicolon
)brace
r_if
c_cond
(paren
id|wcaps
op_amp
id|AC_WCAP_DIGITAL
)paren
(brace
r_if
c_cond
(paren
id|val
op_amp
id|AC_SUPPCM_BITS_32
)paren
id|formats
op_or_assign
id|SNDRV_PCM_FMTBIT_IEC958_SUBFRAME_LE
suffix:semicolon
r_if
c_cond
(paren
id|val
op_amp
(paren
id|AC_SUPPCM_BITS_20
op_or
id|AC_SUPPCM_BITS_24
)paren
)paren
id|formats
op_or_assign
id|SNDRV_PCM_FMTBIT_S32_LE
suffix:semicolon
r_if
c_cond
(paren
id|val
op_amp
id|AC_SUPPCM_BITS_24
)paren
id|bps
op_assign
l_int|24
suffix:semicolon
r_else
r_if
c_cond
(paren
id|val
op_amp
id|AC_SUPPCM_BITS_20
)paren
id|bps
op_assign
l_int|20
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|val
op_amp
(paren
id|AC_SUPPCM_BITS_20
op_or
id|AC_SUPPCM_BITS_24
op_or
id|AC_SUPPCM_BITS_32
)paren
)paren
(brace
id|formats
op_or_assign
id|SNDRV_PCM_FMTBIT_S32_LE
suffix:semicolon
r_if
c_cond
(paren
id|val
op_amp
id|AC_SUPPCM_BITS_32
)paren
id|bps
op_assign
l_int|32
suffix:semicolon
r_else
r_if
c_cond
(paren
id|val
op_amp
id|AC_SUPPCM_BITS_20
)paren
id|bps
op_assign
l_int|20
suffix:semicolon
r_else
r_if
c_cond
(paren
id|val
op_amp
id|AC_SUPPCM_BITS_24
)paren
id|bps
op_assign
l_int|24
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|streams
op_eq
id|AC_SUPFMT_FLOAT32
)paren
(brace
multiline_comment|/* should be exclusive */
id|formats
op_or_assign
id|SNDRV_PCM_FMTBIT_FLOAT_LE
suffix:semicolon
id|bps
op_assign
l_int|32
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|streams
op_eq
id|AC_SUPFMT_AC3
)paren
(brace
multiline_comment|/* should be exclusive */
multiline_comment|/* temporary hack: we have still no proper support&n;&t;&t;&t; * for the direct AC3 stream...&n;&t;&t;&t; */
id|formats
op_or_assign
id|SNDRV_PCM_FMTBIT_U8
suffix:semicolon
id|bps
op_assign
l_int|8
suffix:semicolon
)brace
r_if
c_cond
(paren
id|formatsp
)paren
op_star
id|formatsp
op_assign
id|formats
suffix:semicolon
r_if
c_cond
(paren
id|bpsp
)paren
op_star
id|bpsp
op_assign
id|bps
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_hda_is_supported_format - check whether the given node supports the format val&n; *&n; * Returns 1 if supported, 0 if not.&n; */
DECL|function|snd_hda_is_supported_format
r_int
id|snd_hda_is_supported_format
c_func
(paren
r_struct
id|hda_codec
op_star
id|codec
comma
id|hda_nid_t
id|nid
comma
r_int
r_int
id|format
)paren
(brace
r_int
id|i
suffix:semicolon
r_int
r_int
id|val
op_assign
l_int|0
comma
id|rate
suffix:semicolon
r_if
c_cond
(paren
id|nid
op_ne
id|codec-&gt;afg
op_logical_and
id|snd_hda_param_read
c_func
(paren
id|codec
comma
id|nid
comma
id|AC_PAR_AUDIO_WIDGET_CAP
)paren
op_amp
id|AC_WCAP_FORMAT_OVRD
)paren
(brace
id|val
op_assign
id|snd_hda_param_read
c_func
(paren
id|codec
comma
id|nid
comma
id|AC_PAR_PCM
)paren
suffix:semicolon
r_if
c_cond
(paren
id|val
op_eq
op_minus
l_int|1
)paren
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|val
)paren
(brace
id|val
op_assign
id|snd_hda_param_read
c_func
(paren
id|codec
comma
id|codec-&gt;afg
comma
id|AC_PAR_PCM
)paren
suffix:semicolon
r_if
c_cond
(paren
id|val
op_eq
op_minus
l_int|1
)paren
r_return
l_int|0
suffix:semicolon
)brace
id|rate
op_assign
id|format
op_amp
l_int|0xffff
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|rate_bits
(braket
id|i
)braket
(braket
l_int|0
)braket
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|rate_bits
(braket
id|i
)braket
(braket
l_int|2
)braket
op_eq
id|rate
)paren
(brace
r_if
c_cond
(paren
id|val
op_amp
(paren
l_int|1
op_lshift
id|i
)paren
)paren
r_break
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|rate_bits
(braket
id|i
)braket
(braket
l_int|0
)braket
)paren
r_return
l_int|0
suffix:semicolon
id|val
op_assign
id|snd_hda_param_read
c_func
(paren
id|codec
comma
id|nid
comma
id|AC_PAR_STREAM
)paren
suffix:semicolon
r_if
c_cond
(paren
id|val
op_eq
op_minus
l_int|1
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|val
op_logical_and
id|nid
op_ne
id|codec-&gt;afg
)paren
id|val
op_assign
id|snd_hda_param_read
c_func
(paren
id|codec
comma
id|codec-&gt;afg
comma
id|AC_PAR_STREAM
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|val
op_logical_or
id|val
op_eq
op_minus
l_int|1
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|val
op_amp
id|AC_SUPFMT_PCM
)paren
(brace
r_switch
c_cond
(paren
id|format
op_amp
l_int|0xf0
)paren
(brace
r_case
l_int|0x00
suffix:colon
r_if
c_cond
(paren
op_logical_neg
(paren
id|val
op_amp
id|AC_SUPPCM_BITS_8
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x10
suffix:colon
r_if
c_cond
(paren
op_logical_neg
(paren
id|val
op_amp
id|AC_SUPPCM_BITS_16
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x20
suffix:colon
r_if
c_cond
(paren
op_logical_neg
(paren
id|val
op_amp
id|AC_SUPPCM_BITS_20
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x30
suffix:colon
r_if
c_cond
(paren
op_logical_neg
(paren
id|val
op_amp
id|AC_SUPPCM_BITS_24
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x40
suffix:colon
r_if
c_cond
(paren
op_logical_neg
(paren
id|val
op_amp
id|AC_SUPPCM_BITS_32
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_return
l_int|0
suffix:semicolon
)brace
)brace
r_else
(brace
multiline_comment|/* FIXME: check for float32 and AC3? */
)brace
r_return
l_int|1
suffix:semicolon
)brace
multiline_comment|/*&n; * PCM stuff&n; */
DECL|function|hda_pcm_default_open_close
r_static
r_int
id|hda_pcm_default_open_close
c_func
(paren
r_struct
id|hda_pcm_stream
op_star
id|hinfo
comma
r_struct
id|hda_codec
op_star
id|codec
comma
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|hda_pcm_default_prepare
r_static
r_int
id|hda_pcm_default_prepare
c_func
(paren
r_struct
id|hda_pcm_stream
op_star
id|hinfo
comma
r_struct
id|hda_codec
op_star
id|codec
comma
r_int
r_int
id|stream_tag
comma
r_int
r_int
id|format
comma
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_hda_codec_setup_stream
c_func
(paren
id|codec
comma
id|hinfo-&gt;nid
comma
id|stream_tag
comma
l_int|0
comma
id|format
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|hda_pcm_default_cleanup
r_static
r_int
id|hda_pcm_default_cleanup
c_func
(paren
r_struct
id|hda_pcm_stream
op_star
id|hinfo
comma
r_struct
id|hda_codec
op_star
id|codec
comma
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_hda_codec_setup_stream
c_func
(paren
id|codec
comma
id|hinfo-&gt;nid
comma
l_int|0
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|set_pcm_default_values
r_static
r_int
id|set_pcm_default_values
c_func
(paren
r_struct
id|hda_codec
op_star
id|codec
comma
r_struct
id|hda_pcm_stream
op_star
id|info
)paren
(brace
r_if
c_cond
(paren
id|info-&gt;nid
)paren
(brace
multiline_comment|/* query support PCM information from the given NID */
r_if
c_cond
(paren
op_logical_neg
id|info-&gt;rates
op_logical_or
op_logical_neg
id|info-&gt;formats
)paren
id|snd_hda_query_supported_pcm
c_func
(paren
id|codec
comma
id|info-&gt;nid
comma
id|info-&gt;rates
ques
c_cond
l_int|NULL
suffix:colon
op_amp
id|info-&gt;rates
comma
id|info-&gt;formats
ques
c_cond
l_int|NULL
suffix:colon
op_amp
id|info-&gt;formats
comma
id|info-&gt;maxbps
ques
c_cond
l_int|NULL
suffix:colon
op_amp
id|info-&gt;maxbps
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|info-&gt;ops.open
op_eq
l_int|NULL
)paren
id|info-&gt;ops.open
op_assign
id|hda_pcm_default_open_close
suffix:semicolon
r_if
c_cond
(paren
id|info-&gt;ops.close
op_eq
l_int|NULL
)paren
id|info-&gt;ops.close
op_assign
id|hda_pcm_default_open_close
suffix:semicolon
r_if
c_cond
(paren
id|info-&gt;ops.prepare
op_eq
l_int|NULL
)paren
(brace
id|snd_assert
c_func
(paren
id|info-&gt;nid
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|info-&gt;ops.prepare
op_assign
id|hda_pcm_default_prepare
suffix:semicolon
)brace
r_if
c_cond
(paren
id|info-&gt;ops.prepare
op_eq
l_int|NULL
)paren
(brace
id|snd_assert
c_func
(paren
id|info-&gt;nid
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|info-&gt;ops.prepare
op_assign
id|hda_pcm_default_prepare
suffix:semicolon
)brace
r_if
c_cond
(paren
id|info-&gt;ops.cleanup
op_eq
l_int|NULL
)paren
(brace
id|snd_assert
c_func
(paren
id|info-&gt;nid
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|info-&gt;ops.cleanup
op_assign
id|hda_pcm_default_cleanup
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_hda_build_pcms - build PCM information&n; * @bus: the BUS&n; *&n; * Create PCM information for each codec included in the bus.&n; *&n; * The build_pcms codec patch is requested to set up codec-&gt;num_pcms and&n; * codec-&gt;pcm_info properly.  The array is referred by the top-level driver&n; * to create its PCM instances.&n; * The allocated codec-&gt;pcm_info should be released in codec-&gt;patch_ops.free&n; * callback.&n; *&n; * At least, substreams, channels_min and channels_max must be filled for&n; * each stream.  substreams = 0 indicates that the stream doesn&squot;t exist.&n; * When rates and/or formats are zero, the supported values are queried&n; * from the given nid.  The nid is used also by the default ops.prepare&n; * and ops.cleanup callbacks.&n; *&n; * The driver needs to call ops.open in its open callback.  Similarly,&n; * ops.close is supposed to be called in the close callback.&n; * ops.prepare should be called in the prepare or hw_params callback&n; * with the proper parameters for set up.&n; * ops.cleanup should be called in hw_free for clean up of streams.&n; *&n; * This function returns 0 if successfull, or a negative error code.&n; */
DECL|function|snd_hda_build_pcms
r_int
id|snd_hda_build_pcms
c_func
(paren
r_struct
id|hda_bus
op_star
id|bus
)paren
(brace
r_struct
id|list_head
op_star
id|p
suffix:semicolon
id|list_for_each
c_func
(paren
id|p
comma
op_amp
id|bus-&gt;codec_list
)paren
(brace
r_struct
id|hda_codec
op_star
id|codec
op_assign
id|list_entry
c_func
(paren
id|p
comma
r_struct
id|hda_codec
comma
id|list
)paren
suffix:semicolon
r_int
r_int
id|pcm
comma
id|s
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|codec-&gt;patch_ops.build_pcms
)paren
r_continue
suffix:semicolon
id|err
op_assign
id|codec-&gt;patch_ops
dot
id|build_pcms
c_func
(paren
id|codec
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_for
c_loop
(paren
id|pcm
op_assign
l_int|0
suffix:semicolon
id|pcm
OL
id|codec-&gt;num_pcms
suffix:semicolon
id|pcm
op_increment
)paren
(brace
r_for
c_loop
(paren
id|s
op_assign
l_int|0
suffix:semicolon
id|s
OL
l_int|2
suffix:semicolon
id|s
op_increment
)paren
(brace
r_struct
id|hda_pcm_stream
op_star
id|info
suffix:semicolon
id|info
op_assign
op_amp
id|codec-&gt;pcm_info
(braket
id|pcm
)braket
dot
id|stream
(braket
id|s
)braket
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|info-&gt;substreams
)paren
r_continue
suffix:semicolon
id|err
op_assign
id|set_pcm_default_values
c_func
(paren
id|codec
comma
id|info
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_hda_check_board_config - compare the current codec with the config table&n; * @codec: the HDA codec&n; * @tbl: configuration table, terminated by null entries&n; *&n; * Compares the modelname or PCI subsystem id of the current codec with the&n; * given configuration table.  If a matching entry is found, returns its&n; * config value (supposed to be 0 or positive).&n; *&n; * If no entries are matching, the function returns a negative value.&n; */
DECL|function|snd_hda_check_board_config
r_int
id|snd_hda_check_board_config
c_func
(paren
r_struct
id|hda_codec
op_star
id|codec
comma
r_struct
id|hda_board_config
op_star
id|tbl
)paren
(brace
r_struct
id|hda_board_config
op_star
id|c
suffix:semicolon
r_if
c_cond
(paren
id|codec-&gt;bus-&gt;modelname
)paren
(brace
r_for
c_loop
(paren
id|c
op_assign
id|tbl
suffix:semicolon
id|c-&gt;modelname
op_logical_or
id|c-&gt;pci_vendor
suffix:semicolon
id|c
op_increment
)paren
(brace
r_if
c_cond
(paren
id|c-&gt;modelname
op_logical_and
op_logical_neg
id|strcmp
c_func
(paren
id|codec-&gt;bus-&gt;modelname
comma
id|c-&gt;modelname
)paren
)paren
(brace
id|snd_printd
c_func
(paren
id|KERN_INFO
l_string|&quot;hda_codec: model &squot;%s&squot; is selected&bslash;n&quot;
comma
id|c-&gt;modelname
)paren
suffix:semicolon
r_return
id|c-&gt;config
suffix:semicolon
)brace
)brace
)brace
r_if
c_cond
(paren
id|codec-&gt;bus-&gt;pci
)paren
(brace
id|u16
id|subsystem_vendor
comma
id|subsystem_device
suffix:semicolon
id|pci_read_config_word
c_func
(paren
id|codec-&gt;bus-&gt;pci
comma
id|PCI_SUBSYSTEM_VENDOR_ID
comma
op_amp
id|subsystem_vendor
)paren
suffix:semicolon
id|pci_read_config_word
c_func
(paren
id|codec-&gt;bus-&gt;pci
comma
id|PCI_SUBSYSTEM_ID
comma
op_amp
id|subsystem_device
)paren
suffix:semicolon
r_for
c_loop
(paren
id|c
op_assign
id|tbl
suffix:semicolon
id|c-&gt;modelname
op_logical_or
id|c-&gt;pci_vendor
suffix:semicolon
id|c
op_increment
)paren
(brace
r_if
c_cond
(paren
id|c-&gt;pci_vendor
op_eq
id|subsystem_vendor
op_logical_and
id|c-&gt;pci_device
op_eq
id|subsystem_device
)paren
r_return
id|c-&gt;config
suffix:semicolon
)brace
)brace
r_return
op_minus
l_int|1
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_hda_add_new_ctls - create controls from the array&n; * @codec: the HDA codec&n; * @knew: the array of snd_kcontrol_new_t&n; *&n; * This helper function creates and add new controls in the given array.&n; * The array must be terminated with an empty entry as terminator.&n; *&n; * Returns 0 if successful, or a negative error code.&n; */
DECL|function|snd_hda_add_new_ctls
r_int
id|snd_hda_add_new_ctls
c_func
(paren
r_struct
id|hda_codec
op_star
id|codec
comma
id|snd_kcontrol_new_t
op_star
id|knew
)paren
(brace
r_int
id|err
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
id|knew-&gt;name
suffix:semicolon
id|knew
op_increment
)paren
(brace
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|codec-&gt;bus-&gt;card
comma
id|snd_ctl_new1
c_func
(paren
id|knew
comma
id|codec
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * input MUX helper&n; */
DECL|function|snd_hda_input_mux_info
r_int
id|snd_hda_input_mux_info
c_func
(paren
r_const
r_struct
id|hda_input_mux
op_star
id|imux
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
r_int
r_int
id|index
suffix:semicolon
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_ENUMERATED
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
id|uinfo-&gt;value.enumerated.items
op_assign
id|imux-&gt;num_items
suffix:semicolon
id|index
op_assign
id|uinfo-&gt;value.enumerated.item
suffix:semicolon
r_if
c_cond
(paren
id|index
op_ge
id|imux-&gt;num_items
)paren
id|index
op_assign
id|imux-&gt;num_items
op_minus
l_int|1
suffix:semicolon
id|strcpy
c_func
(paren
id|uinfo-&gt;value.enumerated.name
comma
id|imux-&gt;items
(braket
id|index
)braket
dot
id|label
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_hda_input_mux_put
r_int
id|snd_hda_input_mux_put
c_func
(paren
r_struct
id|hda_codec
op_star
id|codec
comma
r_const
r_struct
id|hda_input_mux
op_star
id|imux
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
comma
id|hda_nid_t
id|nid
comma
r_int
r_int
op_star
id|cur_val
)paren
(brace
r_int
r_int
id|idx
suffix:semicolon
id|idx
op_assign
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
suffix:semicolon
r_if
c_cond
(paren
id|idx
op_ge
id|imux-&gt;num_items
)paren
id|idx
op_assign
id|imux-&gt;num_items
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
op_star
id|cur_val
op_eq
id|idx
op_logical_and
op_logical_neg
id|codec-&gt;in_resume
)paren
r_return
l_int|0
suffix:semicolon
id|snd_hda_codec_write
c_func
(paren
id|codec
comma
id|nid
comma
l_int|0
comma
id|AC_VERB_SET_CONNECT_SEL
comma
id|imux-&gt;items
(braket
id|idx
)braket
dot
id|index
)paren
suffix:semicolon
op_star
id|cur_val
op_assign
id|idx
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
multiline_comment|/*&n; * Multi-channel / digital-out PCM helper functions&n; */
multiline_comment|/*&n; * open the digital out in the exclusive mode&n; */
DECL|function|snd_hda_multi_out_dig_open
r_int
id|snd_hda_multi_out_dig_open
c_func
(paren
r_struct
id|hda_codec
op_star
id|codec
comma
r_struct
id|hda_multi_out
op_star
id|mout
)paren
(brace
id|down
c_func
(paren
op_amp
id|codec-&gt;spdif_mutex
)paren
suffix:semicolon
r_if
c_cond
(paren
id|mout-&gt;dig_out_used
)paren
(brace
id|up
c_func
(paren
op_amp
id|codec-&gt;spdif_mutex
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
multiline_comment|/* already being used */
)brace
id|mout-&gt;dig_out_used
op_assign
id|HDA_DIG_EXCLUSIVE
suffix:semicolon
id|up
c_func
(paren
op_amp
id|codec-&gt;spdif_mutex
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * release the digital out&n; */
DECL|function|snd_hda_multi_out_dig_close
r_int
id|snd_hda_multi_out_dig_close
c_func
(paren
r_struct
id|hda_codec
op_star
id|codec
comma
r_struct
id|hda_multi_out
op_star
id|mout
)paren
(brace
id|down
c_func
(paren
op_amp
id|codec-&gt;spdif_mutex
)paren
suffix:semicolon
id|mout-&gt;dig_out_used
op_assign
l_int|0
suffix:semicolon
id|up
c_func
(paren
op_amp
id|codec-&gt;spdif_mutex
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * set up more restrictions for analog out&n; */
DECL|function|snd_hda_multi_out_analog_open
r_int
id|snd_hda_multi_out_analog_open
c_func
(paren
r_struct
id|hda_codec
op_star
id|codec
comma
r_struct
id|hda_multi_out
op_star
id|mout
comma
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|substream-&gt;runtime-&gt;hw.channels_max
op_assign
id|mout-&gt;max_channels
suffix:semicolon
r_return
id|snd_pcm_hw_constraint_step
c_func
(paren
id|substream-&gt;runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
comma
l_int|2
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * set up the i/o for analog out&n; * when the digital out is available, copy the front out to digital out, too.&n; */
DECL|function|snd_hda_multi_out_analog_prepare
r_int
id|snd_hda_multi_out_analog_prepare
c_func
(paren
r_struct
id|hda_codec
op_star
id|codec
comma
r_struct
id|hda_multi_out
op_star
id|mout
comma
r_int
r_int
id|stream_tag
comma
r_int
r_int
id|format
comma
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|hda_nid_t
op_star
id|nids
op_assign
id|mout-&gt;dac_nids
suffix:semicolon
r_int
id|chs
op_assign
id|substream-&gt;runtime-&gt;channels
suffix:semicolon
r_int
id|i
suffix:semicolon
id|down
c_func
(paren
op_amp
id|codec-&gt;spdif_mutex
)paren
suffix:semicolon
r_if
c_cond
(paren
id|mout-&gt;dig_out_nid
op_logical_and
id|mout-&gt;dig_out_used
op_ne
id|HDA_DIG_EXCLUSIVE
)paren
(brace
r_if
c_cond
(paren
id|chs
op_eq
l_int|2
op_logical_and
id|snd_hda_is_supported_format
c_func
(paren
id|codec
comma
id|mout-&gt;dig_out_nid
comma
id|format
)paren
)paren
(brace
id|mout-&gt;dig_out_used
op_assign
id|HDA_DIG_ANALOG_DUP
suffix:semicolon
multiline_comment|/* setup digital receiver */
id|snd_hda_codec_setup_stream
c_func
(paren
id|codec
comma
id|mout-&gt;dig_out_nid
comma
id|stream_tag
comma
l_int|0
comma
id|format
)paren
suffix:semicolon
r_if
c_cond
(paren
id|codec-&gt;spdif_status
op_amp
id|AC_DIG1_NONAUDIO
)paren
(brace
multiline_comment|/* non-audio SPDIF out, turning off all DACs */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|mout-&gt;num_dacs
suffix:semicolon
id|i
op_increment
)paren
id|snd_hda_codec_setup_stream
c_func
(paren
id|codec
comma
id|nids
(braket
id|i
)braket
comma
l_int|0
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|mout-&gt;hp_nid
)paren
id|snd_hda_codec_setup_stream
c_func
(paren
id|codec
comma
id|mout-&gt;hp_nid
comma
l_int|0
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|codec-&gt;spdif_mutex
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
)brace
r_else
(brace
id|mout-&gt;dig_out_used
op_assign
l_int|0
suffix:semicolon
id|snd_hda_codec_setup_stream
c_func
(paren
id|codec
comma
id|mout-&gt;dig_out_nid
comma
l_int|0
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
)brace
)brace
id|up
c_func
(paren
op_amp
id|codec-&gt;spdif_mutex
)paren
suffix:semicolon
multiline_comment|/* front */
id|snd_hda_codec_setup_stream
c_func
(paren
id|codec
comma
id|nids
(braket
id|HDA_FRONT
)braket
comma
id|stream_tag
comma
l_int|0
comma
id|format
)paren
suffix:semicolon
r_if
c_cond
(paren
id|mout-&gt;hp_nid
)paren
multiline_comment|/* headphone out will just decode front left/right (stereo) */
id|snd_hda_codec_setup_stream
c_func
(paren
id|codec
comma
id|mout-&gt;hp_nid
comma
id|stream_tag
comma
l_int|0
comma
id|format
)paren
suffix:semicolon
multiline_comment|/* surrounds */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|mout-&gt;num_dacs
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|i
op_eq
id|HDA_REAR
op_logical_and
id|chs
op_eq
l_int|2
)paren
multiline_comment|/* copy front to rear */
id|snd_hda_codec_setup_stream
c_func
(paren
id|codec
comma
id|nids
(braket
id|i
)braket
comma
id|stream_tag
comma
l_int|0
comma
id|format
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|chs
op_ge
(paren
id|i
op_plus
l_int|1
)paren
op_star
l_int|2
)paren
multiline_comment|/* independent out */
id|snd_hda_codec_setup_stream
c_func
(paren
id|codec
comma
id|nids
(braket
id|i
)braket
comma
id|stream_tag
comma
id|i
op_star
l_int|2
comma
id|format
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * clean up the setting for analog out&n; */
DECL|function|snd_hda_multi_out_analog_cleanup
r_int
id|snd_hda_multi_out_analog_cleanup
c_func
(paren
r_struct
id|hda_codec
op_star
id|codec
comma
r_struct
id|hda_multi_out
op_star
id|mout
)paren
(brace
id|hda_nid_t
op_star
id|nids
op_assign
id|mout-&gt;dac_nids
suffix:semicolon
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|mout-&gt;num_dacs
suffix:semicolon
id|i
op_increment
)paren
id|snd_hda_codec_setup_stream
c_func
(paren
id|codec
comma
id|nids
(braket
id|i
)braket
comma
l_int|0
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|mout-&gt;hp_nid
)paren
id|snd_hda_codec_setup_stream
c_func
(paren
id|codec
comma
id|mout-&gt;hp_nid
comma
l_int|0
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
id|down
c_func
(paren
op_amp
id|codec-&gt;spdif_mutex
)paren
suffix:semicolon
r_if
c_cond
(paren
id|mout-&gt;dig_out_nid
op_logical_and
id|mout-&gt;dig_out_used
op_eq
id|HDA_DIG_ANALOG_DUP
)paren
(brace
id|snd_hda_codec_setup_stream
c_func
(paren
id|codec
comma
id|mout-&gt;dig_out_nid
comma
l_int|0
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
id|mout-&gt;dig_out_used
op_assign
l_int|0
suffix:semicolon
)brace
id|up
c_func
(paren
op_amp
id|codec-&gt;spdif_mutex
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_PM
multiline_comment|/*&n; * power management&n; */
multiline_comment|/**&n; * snd_hda_suspend - suspend the codecs&n; * @bus: the HDA bus&n; * @state: suspsend state&n; *&n; * Returns 0 if successful.&n; */
DECL|function|snd_hda_suspend
r_int
id|snd_hda_suspend
c_func
(paren
r_struct
id|hda_bus
op_star
id|bus
comma
r_int
r_int
id|state
)paren
(brace
r_struct
id|list_head
op_star
id|p
suffix:semicolon
multiline_comment|/* FIXME: should handle power widget capabilities */
id|list_for_each
c_func
(paren
id|p
comma
op_amp
id|bus-&gt;codec_list
)paren
(brace
r_struct
id|hda_codec
op_star
id|codec
op_assign
id|list_entry
c_func
(paren
id|p
comma
r_struct
id|hda_codec
comma
id|list
)paren
suffix:semicolon
r_if
c_cond
(paren
id|codec-&gt;patch_ops.suspend
)paren
id|codec-&gt;patch_ops
dot
id|suspend
c_func
(paren
id|codec
comma
id|state
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_hda_resume - resume the codecs&n; * @bus: the HDA bus&n; * @state: resume state&n; *&n; * Returns 0 if successful.&n; */
DECL|function|snd_hda_resume
r_int
id|snd_hda_resume
c_func
(paren
r_struct
id|hda_bus
op_star
id|bus
comma
r_int
r_int
id|state
)paren
(brace
r_struct
id|list_head
op_star
id|p
suffix:semicolon
id|list_for_each
c_func
(paren
id|p
comma
op_amp
id|bus-&gt;codec_list
)paren
(brace
r_struct
id|hda_codec
op_star
id|codec
op_assign
id|list_entry
c_func
(paren
id|p
comma
r_struct
id|hda_codec
comma
id|list
)paren
suffix:semicolon
r_if
c_cond
(paren
id|codec-&gt;patch_ops.resume
)paren
id|codec-&gt;patch_ops
dot
id|resume
c_func
(paren
id|codec
comma
id|state
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_hda_resume_ctls - resume controls in the new control list&n; * @codec: the HDA codec&n; * @knew: the array of snd_kcontrol_new_t&n; *&n; * This function resumes the mixer controls in the snd_kcontrol_new_t array,&n; * originally for snd_hda_add_new_ctls().&n; * The array must be terminated with an empty entry as terminator.&n; */
DECL|function|snd_hda_resume_ctls
r_int
id|snd_hda_resume_ctls
c_func
(paren
r_struct
id|hda_codec
op_star
id|codec
comma
id|snd_kcontrol_new_t
op_star
id|knew
)paren
(brace
id|snd_ctl_elem_value_t
op_star
id|val
suffix:semicolon
id|val
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
op_star
id|val
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|val
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|codec-&gt;in_resume
op_assign
l_int|1
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
id|knew-&gt;name
suffix:semicolon
id|knew
op_increment
)paren
(brace
r_int
id|i
comma
id|count
suffix:semicolon
id|count
op_assign
id|knew-&gt;count
ques
c_cond
id|knew-&gt;count
suffix:colon
l_int|1
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|count
suffix:semicolon
id|i
op_increment
)paren
(brace
id|memset
c_func
(paren
id|val
comma
l_int|0
comma
r_sizeof
(paren
op_star
id|val
)paren
)paren
suffix:semicolon
id|val-&gt;id.iface
op_assign
id|knew-&gt;iface
suffix:semicolon
id|val-&gt;id.device
op_assign
id|knew-&gt;device
suffix:semicolon
id|val-&gt;id.subdevice
op_assign
id|knew-&gt;subdevice
suffix:semicolon
id|strcpy
c_func
(paren
id|val-&gt;id.name
comma
id|knew-&gt;name
)paren
suffix:semicolon
id|val-&gt;id.index
op_assign
id|knew-&gt;index
ques
c_cond
id|knew-&gt;index
suffix:colon
id|i
suffix:semicolon
multiline_comment|/* Assume that get callback reads only from cache,&n;&t;&t;&t; * not accessing to the real hardware&n;&t;&t;&t; */
r_if
c_cond
(paren
id|snd_ctl_elem_read
c_func
(paren
id|codec-&gt;bus-&gt;card
comma
id|val
)paren
OL
l_int|0
)paren
r_continue
suffix:semicolon
id|snd_ctl_elem_write
c_func
(paren
id|codec-&gt;bus-&gt;card
comma
l_int|NULL
comma
id|val
)paren
suffix:semicolon
)brace
)brace
id|codec-&gt;in_resume
op_assign
l_int|0
suffix:semicolon
id|kfree
c_func
(paren
id|val
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_hda_resume_spdi_out - resume the digital I/O&n; * @codec: the HDA codec&n; */
DECL|function|snd_hda_resume_spdif_out
r_int
id|snd_hda_resume_spdif_out
c_func
(paren
r_struct
id|hda_codec
op_star
id|codec
)paren
(brace
r_return
id|snd_hda_resume_ctls
c_func
(paren
id|codec
comma
id|dig_mixes
)paren
suffix:semicolon
)brace
macro_line|#endif
multiline_comment|/*&n; * symbols exported for controller modules&n; */
DECL|variable|snd_hda_codec_read
id|EXPORT_SYMBOL
c_func
(paren
id|snd_hda_codec_read
)paren
suffix:semicolon
DECL|variable|snd_hda_codec_write
id|EXPORT_SYMBOL
c_func
(paren
id|snd_hda_codec_write
)paren
suffix:semicolon
DECL|variable|snd_hda_sequence_write
id|EXPORT_SYMBOL
c_func
(paren
id|snd_hda_sequence_write
)paren
suffix:semicolon
DECL|variable|snd_hda_get_sub_nodes
id|EXPORT_SYMBOL
c_func
(paren
id|snd_hda_get_sub_nodes
)paren
suffix:semicolon
DECL|variable|snd_hda_queue_unsol_event
id|EXPORT_SYMBOL
c_func
(paren
id|snd_hda_queue_unsol_event
)paren
suffix:semicolon
DECL|variable|snd_hda_bus_new
id|EXPORT_SYMBOL
c_func
(paren
id|snd_hda_bus_new
)paren
suffix:semicolon
DECL|variable|snd_hda_codec_new
id|EXPORT_SYMBOL
c_func
(paren
id|snd_hda_codec_new
)paren
suffix:semicolon
DECL|variable|snd_hda_codec_setup_stream
id|EXPORT_SYMBOL
c_func
(paren
id|snd_hda_codec_setup_stream
)paren
suffix:semicolon
DECL|variable|snd_hda_calc_stream_format
id|EXPORT_SYMBOL
c_func
(paren
id|snd_hda_calc_stream_format
)paren
suffix:semicolon
DECL|variable|snd_hda_build_pcms
id|EXPORT_SYMBOL
c_func
(paren
id|snd_hda_build_pcms
)paren
suffix:semicolon
DECL|variable|snd_hda_build_controls
id|EXPORT_SYMBOL
c_func
(paren
id|snd_hda_build_controls
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_PM
DECL|variable|snd_hda_suspend
id|EXPORT_SYMBOL
c_func
(paren
id|snd_hda_suspend
)paren
suffix:semicolon
DECL|variable|snd_hda_resume
id|EXPORT_SYMBOL
c_func
(paren
id|snd_hda_resume
)paren
suffix:semicolon
macro_line|#endif
multiline_comment|/*&n; *  INIT part&n; */
DECL|function|alsa_hda_init
r_static
r_int
id|__init
id|alsa_hda_init
c_func
(paren
r_void
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|alsa_hda_exit
r_static
r_void
id|__exit
id|alsa_hda_exit
c_func
(paren
r_void
)paren
(brace
)brace
id|module_init
c_func
(paren
id|alsa_hda_init
)paren
id|module_exit
c_func
(paren
id|alsa_hda_exit
)paren
eof
