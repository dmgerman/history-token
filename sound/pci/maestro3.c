multiline_comment|/*&n; * Driver for ESS Maestro3/Allegro soundcards.&n; * Copyright (c) 2000 by Zach Brown &lt;zab@zabbo.net&gt;&n; *                       Takashi Iwai &lt;tiwai@suse.de&gt;&n; *&n; * Most of the hardware init stuffs are based on maestro3 driver for&n; * OSS/Free by Zach Brown.  Many thanks to Zach!&n; *&n; *   This program is free software; you can redistribute it and/or modify&n; *   it under the terms of the GNU General Public License as published by&n; *   the Free Software Foundation; either version 2 of the License, or&n; *   (at your option) any later version.&n; *&n; *   This program is distributed in the hope that it will be useful,&n; *   but WITHOUT ANY WARRANTY; without even the implied warranty of&n; *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; *   GNU General Public License for more details.&n; *&n; *   You should have received a copy of the GNU General Public License&n; *   along with this program; if not, write to the Free Software&n; *   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA&n; *&n; *&n; * ChangeLog:&n; * Aug. 27, 2001&n; *     - Fixed deadlock on capture&n; *     - Added Canyon3D-2 support by Rob Riggs &lt;rob@pangalactic.org&gt;&n; *&n; */
DECL|macro|CARD_NAME
mdefine_line|#define CARD_NAME &quot;ESS Maestro3/Allegro/Canyon3D-2&quot;
DECL|macro|DRIVER_NAME
mdefine_line|#define DRIVER_NAME &quot;Maestro3&quot;
macro_line|#include &lt;sound/driver.h&gt;
macro_line|#include &lt;asm/io.h&gt;
macro_line|#include &lt;linux/delay.h&gt;
macro_line|#include &lt;linux/interrupt.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;linux/vmalloc.h&gt;
macro_line|#include &lt;sound/core.h&gt;
macro_line|#include &lt;sound/info.h&gt;
macro_line|#include &lt;sound/control.h&gt;
macro_line|#include &lt;sound/pcm.h&gt;
macro_line|#include &lt;sound/ac97_codec.h&gt;
DECL|macro|SNDRV_GET_ID
mdefine_line|#define SNDRV_GET_ID
macro_line|#include &lt;sound/initval.h&gt;
id|EXPORT_NO_SYMBOLS
suffix:semicolon
id|MODULE_AUTHOR
c_func
(paren
l_string|&quot;Zach Brown &lt;zab@zabbo.net&gt;, Takashi Iwai &lt;tiwai@suse.de&gt;&quot;
)paren
suffix:semicolon
id|MODULE_DESCRIPTION
c_func
(paren
l_string|&quot;ESS Maestro3 PCI&quot;
)paren
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
id|MODULE_CLASSES
c_func
(paren
l_string|&quot;{sound}&quot;
)paren
suffix:semicolon
id|MODULE_DEVICES
c_func
(paren
l_string|&quot;{{ESS,Maestro3 PCI},&quot;
l_string|&quot;{ESS,Allegro PCI},&quot;
l_string|&quot;{ESS,Allegro-1 PCI},&quot;
l_string|&quot;{ESS,Canyon3D-2/LE PCI}}&quot;
)paren
suffix:semicolon
DECL|variable|snd_index
r_static
r_int
id|snd_index
(braket
id|SNDRV_CARDS
)braket
op_assign
id|SNDRV_DEFAULT_IDX
suffix:semicolon
multiline_comment|/* Index 0-MAX */
DECL|variable|snd_id
r_static
r_char
op_star
id|snd_id
(braket
id|SNDRV_CARDS
)braket
op_assign
id|SNDRV_DEFAULT_STR
suffix:semicolon
multiline_comment|/* ID for this card */
DECL|variable|snd_enable
r_static
r_int
id|snd_enable
(braket
id|SNDRV_CARDS
)braket
op_assign
id|SNDRV_DEFAULT_ENABLE_PNP
suffix:semicolon
multiline_comment|/* all enabled */
DECL|variable|snd_external_amp
r_static
r_int
id|snd_external_amp
(braket
id|SNDRV_CARDS
)braket
op_assign
(brace
(braket
l_int|0
dot
dot
dot
(paren
id|SNDRV_CARDS
op_minus
l_int|1
)paren
)braket
op_assign
l_int|1
)brace
suffix:semicolon
DECL|variable|snd_amp_gpio
r_static
r_int
id|snd_amp_gpio
(braket
id|SNDRV_CARDS
)braket
op_assign
(brace
(braket
l_int|0
dot
dot
dot
(paren
id|SNDRV_CARDS
op_minus
l_int|1
)paren
)braket
op_assign
op_minus
l_int|1
)brace
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|snd_index
comma
l_string|&quot;1-&quot;
id|__MODULE_STRING
c_func
(paren
id|SNDRV_CARDS
)paren
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|snd_index
comma
l_string|&quot;Index value for &quot;
id|CARD_NAME
l_string|&quot; soundcard.&quot;
)paren
suffix:semicolon
id|MODULE_PARM_SYNTAX
c_func
(paren
id|snd_index
comma
id|SNDRV_INDEX_DESC
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|snd_id
comma
l_string|&quot;1-&quot;
id|__MODULE_STRING
c_func
(paren
id|SNDRV_CARDS
)paren
l_string|&quot;s&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|snd_id
comma
l_string|&quot;ID string for &quot;
id|CARD_NAME
l_string|&quot; soundcard.&quot;
)paren
suffix:semicolon
id|MODULE_PARM_SYNTAX
c_func
(paren
id|snd_id
comma
id|SNDRV_ID_DESC
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|snd_enable
comma
l_string|&quot;1-&quot;
id|__MODULE_STRING
c_func
(paren
id|SNDRV_CARDS
)paren
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|snd_enable
comma
l_string|&quot;Enable this soundcard.&quot;
)paren
suffix:semicolon
id|MODULE_PARM_SYNTAX
c_func
(paren
id|snd_enable
comma
id|SNDRV_ENABLE_DESC
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|snd_external_amp
comma
l_string|&quot;1-&quot;
id|__MODULE_STRING
c_func
(paren
id|SNDRV_CARDS
)paren
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|snd_external_amp
comma
l_string|&quot;Enable external amp for &quot;
id|CARD_NAME
l_string|&quot; soundcard.&quot;
)paren
suffix:semicolon
id|MODULE_PARM_SYNTAX
c_func
(paren
id|snd_external_amp
comma
id|SNDRV_ENABLED
l_string|&quot;,&quot;
id|SNDRV_BOOLEAN_TRUE_DESC
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|snd_amp_gpio
comma
l_string|&quot;1-&quot;
id|__MODULE_STRING
c_func
(paren
id|SNDRV_CARDS
)paren
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|snd_amp_gpio
comma
l_string|&quot;GPIO pin number for external amp. (default = -1)&quot;
)paren
suffix:semicolon
id|MODULE_PARM_SYNTAX
c_func
(paren
id|snd_amp_gpio
comma
id|SNDRV_ENABLED
)paren
suffix:semicolon
DECL|macro|MAX_PLAYBACKS
mdefine_line|#define MAX_PLAYBACKS&t;2
DECL|macro|MAX_CAPTURES
mdefine_line|#define MAX_CAPTURES&t;1
DECL|macro|NR_DSPS
mdefine_line|#define NR_DSPS&t;&t;(MAX_PLAYBACKS + MAX_CAPTURES)
multiline_comment|/*&n; * maestro3 registers&n; */
multiline_comment|/* Allegro PCI configuration registers */
DECL|macro|PCI_LEGACY_AUDIO_CTRL
mdefine_line|#define PCI_LEGACY_AUDIO_CTRL   0x40
DECL|macro|SOUND_BLASTER_ENABLE
mdefine_line|#define SOUND_BLASTER_ENABLE    0x00000001
DECL|macro|FM_SYNTHESIS_ENABLE
mdefine_line|#define FM_SYNTHESIS_ENABLE     0x00000002
DECL|macro|GAME_PORT_ENABLE
mdefine_line|#define GAME_PORT_ENABLE        0x00000004
DECL|macro|MPU401_IO_ENABLE
mdefine_line|#define MPU401_IO_ENABLE        0x00000008
DECL|macro|MPU401_IRQ_ENABLE
mdefine_line|#define MPU401_IRQ_ENABLE       0x00000010
DECL|macro|ALIAS_10BIT_IO
mdefine_line|#define ALIAS_10BIT_IO          0x00000020
DECL|macro|SB_DMA_MASK
mdefine_line|#define SB_DMA_MASK             0x000000C0
DECL|macro|SB_DMA_0
mdefine_line|#define SB_DMA_0                0x00000040
DECL|macro|SB_DMA_1
mdefine_line|#define SB_DMA_1                0x00000040
DECL|macro|SB_DMA_R
mdefine_line|#define SB_DMA_R                0x00000080
DECL|macro|SB_DMA_3
mdefine_line|#define SB_DMA_3                0x000000C0
DECL|macro|SB_IRQ_MASK
mdefine_line|#define SB_IRQ_MASK             0x00000700
DECL|macro|SB_IRQ_5
mdefine_line|#define SB_IRQ_5                0x00000000
DECL|macro|SB_IRQ_7
mdefine_line|#define SB_IRQ_7                0x00000100
DECL|macro|SB_IRQ_9
mdefine_line|#define SB_IRQ_9                0x00000200
DECL|macro|SB_IRQ_10
mdefine_line|#define SB_IRQ_10               0x00000300
DECL|macro|MIDI_IRQ_MASK
mdefine_line|#define MIDI_IRQ_MASK           0x00003800
DECL|macro|SERIAL_IRQ_ENABLE
mdefine_line|#define SERIAL_IRQ_ENABLE       0x00004000
DECL|macro|DISABLE_LEGACY
mdefine_line|#define DISABLE_LEGACY          0x00008000
DECL|macro|PCI_ALLEGRO_CONFIG
mdefine_line|#define PCI_ALLEGRO_CONFIG      0x50
DECL|macro|SB_ADDR_240
mdefine_line|#define SB_ADDR_240             0x00000004
DECL|macro|MPU_ADDR_MASK
mdefine_line|#define MPU_ADDR_MASK           0x00000018
DECL|macro|MPU_ADDR_330
mdefine_line|#define MPU_ADDR_330            0x00000000
DECL|macro|MPU_ADDR_300
mdefine_line|#define MPU_ADDR_300            0x00000008
DECL|macro|MPU_ADDR_320
mdefine_line|#define MPU_ADDR_320            0x00000010
DECL|macro|MPU_ADDR_340
mdefine_line|#define MPU_ADDR_340            0x00000018
DECL|macro|USE_PCI_TIMING
mdefine_line|#define USE_PCI_TIMING          0x00000040
DECL|macro|POSTED_WRITE_ENABLE
mdefine_line|#define POSTED_WRITE_ENABLE     0x00000080
DECL|macro|DMA_POLICY_MASK
mdefine_line|#define DMA_POLICY_MASK         0x00000700
DECL|macro|DMA_DDMA
mdefine_line|#define DMA_DDMA                0x00000000
DECL|macro|DMA_TDMA
mdefine_line|#define DMA_TDMA                0x00000100
DECL|macro|DMA_PCPCI
mdefine_line|#define DMA_PCPCI               0x00000200
DECL|macro|DMA_WBDMA16
mdefine_line|#define DMA_WBDMA16             0x00000400
DECL|macro|DMA_WBDMA4
mdefine_line|#define DMA_WBDMA4              0x00000500
DECL|macro|DMA_WBDMA2
mdefine_line|#define DMA_WBDMA2              0x00000600
DECL|macro|DMA_WBDMA1
mdefine_line|#define DMA_WBDMA1              0x00000700
DECL|macro|DMA_SAFE_GUARD
mdefine_line|#define DMA_SAFE_GUARD          0x00000800
DECL|macro|HI_PERF_GP_ENABLE
mdefine_line|#define HI_PERF_GP_ENABLE       0x00001000
DECL|macro|PIC_SNOOP_MODE_0
mdefine_line|#define PIC_SNOOP_MODE_0        0x00002000
DECL|macro|PIC_SNOOP_MODE_1
mdefine_line|#define PIC_SNOOP_MODE_1        0x00004000
DECL|macro|SOUNDBLASTER_IRQ_MASK
mdefine_line|#define SOUNDBLASTER_IRQ_MASK   0x00008000
DECL|macro|RING_IN_ENABLE
mdefine_line|#define RING_IN_ENABLE          0x00010000
DECL|macro|SPDIF_TEST_MODE
mdefine_line|#define SPDIF_TEST_MODE         0x00020000
DECL|macro|CLK_MULT_MODE_SELECT_2
mdefine_line|#define CLK_MULT_MODE_SELECT_2  0x00040000
DECL|macro|EEPROM_WRITE_ENABLE
mdefine_line|#define EEPROM_WRITE_ENABLE     0x00080000
DECL|macro|CODEC_DIR_IN
mdefine_line|#define CODEC_DIR_IN            0x00100000
DECL|macro|HV_BUTTON_FROM_GD
mdefine_line|#define HV_BUTTON_FROM_GD       0x00200000
DECL|macro|REDUCED_DEBOUNCE
mdefine_line|#define REDUCED_DEBOUNCE        0x00400000
DECL|macro|HV_CTRL_ENABLE
mdefine_line|#define HV_CTRL_ENABLE          0x00800000
DECL|macro|SPDIF_ENABLE
mdefine_line|#define SPDIF_ENABLE            0x01000000
DECL|macro|CLK_DIV_SELECT
mdefine_line|#define CLK_DIV_SELECT          0x06000000
DECL|macro|CLK_DIV_BY_48
mdefine_line|#define CLK_DIV_BY_48           0x00000000
DECL|macro|CLK_DIV_BY_49
mdefine_line|#define CLK_DIV_BY_49           0x02000000
DECL|macro|CLK_DIV_BY_50
mdefine_line|#define CLK_DIV_BY_50           0x04000000
DECL|macro|CLK_DIV_RESERVED
mdefine_line|#define CLK_DIV_RESERVED        0x06000000
DECL|macro|PM_CTRL_ENABLE
mdefine_line|#define PM_CTRL_ENABLE          0x08000000
DECL|macro|CLK_MULT_MODE_SELECT
mdefine_line|#define CLK_MULT_MODE_SELECT    0x30000000
DECL|macro|CLK_MULT_MODE_SHIFT
mdefine_line|#define CLK_MULT_MODE_SHIFT     28
DECL|macro|CLK_MULT_MODE_0
mdefine_line|#define CLK_MULT_MODE_0         0x00000000
DECL|macro|CLK_MULT_MODE_1
mdefine_line|#define CLK_MULT_MODE_1         0x10000000
DECL|macro|CLK_MULT_MODE_2
mdefine_line|#define CLK_MULT_MODE_2         0x20000000
DECL|macro|CLK_MULT_MODE_3
mdefine_line|#define CLK_MULT_MODE_3         0x30000000
DECL|macro|INT_CLK_SELECT
mdefine_line|#define INT_CLK_SELECT          0x40000000
DECL|macro|INT_CLK_MULT_RESET
mdefine_line|#define INT_CLK_MULT_RESET      0x80000000
multiline_comment|/* M3 */
DECL|macro|INT_CLK_SRC_NOT_PCI
mdefine_line|#define INT_CLK_SRC_NOT_PCI     0x00100000
DECL|macro|INT_CLK_MULT_ENABLE
mdefine_line|#define INT_CLK_MULT_ENABLE     0x80000000
DECL|macro|PCI_ACPI_CONTROL
mdefine_line|#define PCI_ACPI_CONTROL        0x54
DECL|macro|PCI_ACPI_D0
mdefine_line|#define PCI_ACPI_D0             0x00000000
DECL|macro|PCI_ACPI_D1
mdefine_line|#define PCI_ACPI_D1             0xB4F70000
DECL|macro|PCI_ACPI_D2
mdefine_line|#define PCI_ACPI_D2             0xB4F7B4F7
DECL|macro|PCI_USER_CONFIG
mdefine_line|#define PCI_USER_CONFIG         0x58
DECL|macro|EXT_PCI_MASTER_ENABLE
mdefine_line|#define EXT_PCI_MASTER_ENABLE   0x00000001
DECL|macro|SPDIF_OUT_SELECT
mdefine_line|#define SPDIF_OUT_SELECT        0x00000002
DECL|macro|TEST_PIN_DIR_CTRL
mdefine_line|#define TEST_PIN_DIR_CTRL       0x00000004
DECL|macro|AC97_CODEC_TEST
mdefine_line|#define AC97_CODEC_TEST         0x00000020
DECL|macro|TRI_STATE_BUFFER
mdefine_line|#define TRI_STATE_BUFFER        0x00000080
DECL|macro|IN_CLK_12MHZ_SELECT
mdefine_line|#define IN_CLK_12MHZ_SELECT     0x00000100
DECL|macro|MULTI_FUNC_DISABLE
mdefine_line|#define MULTI_FUNC_DISABLE      0x00000200
DECL|macro|EXT_MASTER_PAIR_SEL
mdefine_line|#define EXT_MASTER_PAIR_SEL     0x00000400
DECL|macro|PCI_MASTER_SUPPORT
mdefine_line|#define PCI_MASTER_SUPPORT      0x00000800
DECL|macro|STOP_CLOCK_ENABLE
mdefine_line|#define STOP_CLOCK_ENABLE       0x00001000
DECL|macro|EAPD_DRIVE_ENABLE
mdefine_line|#define EAPD_DRIVE_ENABLE       0x00002000
DECL|macro|REQ_TRI_STATE_ENABLE
mdefine_line|#define REQ_TRI_STATE_ENABLE    0x00004000
DECL|macro|REQ_LOW_ENABLE
mdefine_line|#define REQ_LOW_ENABLE          0x00008000
DECL|macro|MIDI_1_ENABLE
mdefine_line|#define MIDI_1_ENABLE           0x00010000
DECL|macro|MIDI_2_ENABLE
mdefine_line|#define MIDI_2_ENABLE           0x00020000
DECL|macro|SB_AUDIO_SYNC
mdefine_line|#define SB_AUDIO_SYNC           0x00040000
DECL|macro|HV_CTRL_TEST
mdefine_line|#define HV_CTRL_TEST            0x00100000
DECL|macro|SOUNDBLASTER_TEST
mdefine_line|#define SOUNDBLASTER_TEST       0x00400000
DECL|macro|PCI_USER_CONFIG_C
mdefine_line|#define PCI_USER_CONFIG_C       0x5C
DECL|macro|PCI_DDMA_CTRL
mdefine_line|#define PCI_DDMA_CTRL           0x60
DECL|macro|DDMA_ENABLE
mdefine_line|#define DDMA_ENABLE             0x00000001
multiline_comment|/* Allegro registers */
DECL|macro|HOST_INT_CTRL
mdefine_line|#define HOST_INT_CTRL           0x18
DECL|macro|SB_INT_ENABLE
mdefine_line|#define SB_INT_ENABLE           0x0001
DECL|macro|MPU401_INT_ENABLE
mdefine_line|#define MPU401_INT_ENABLE       0x0002
DECL|macro|ASSP_INT_ENABLE
mdefine_line|#define ASSP_INT_ENABLE         0x0010
DECL|macro|RING_INT_ENABLE
mdefine_line|#define RING_INT_ENABLE         0x0020
DECL|macro|HV_INT_ENABLE
mdefine_line|#define HV_INT_ENABLE           0x0040
DECL|macro|CLKRUN_GEN_ENABLE
mdefine_line|#define CLKRUN_GEN_ENABLE       0x0100
DECL|macro|HV_CTRL_TO_PME
mdefine_line|#define HV_CTRL_TO_PME          0x0400
DECL|macro|SOFTWARE_RESET_ENABLE
mdefine_line|#define SOFTWARE_RESET_ENABLE   0x8000
multiline_comment|/*&n; * should be using the above defines, probably.&n; */
DECL|macro|REGB_ENABLE_RESET
mdefine_line|#define REGB_ENABLE_RESET               0x01
DECL|macro|REGB_STOP_CLOCK
mdefine_line|#define REGB_STOP_CLOCK                 0x10
DECL|macro|HOST_INT_STATUS
mdefine_line|#define HOST_INT_STATUS         0x1A
DECL|macro|SB_INT_PENDING
mdefine_line|#define SB_INT_PENDING          0x01
DECL|macro|MPU401_INT_PENDING
mdefine_line|#define MPU401_INT_PENDING      0x02
DECL|macro|ASSP_INT_PENDING
mdefine_line|#define ASSP_INT_PENDING        0x10
DECL|macro|RING_INT_PENDING
mdefine_line|#define RING_INT_PENDING        0x20
DECL|macro|HV_INT_PENDING
mdefine_line|#define HV_INT_PENDING          0x40
DECL|macro|HARDWARE_VOL_CTRL
mdefine_line|#define HARDWARE_VOL_CTRL       0x1B
DECL|macro|SHADOW_MIX_REG_VOICE
mdefine_line|#define SHADOW_MIX_REG_VOICE    0x1C
DECL|macro|HW_VOL_COUNTER_VOICE
mdefine_line|#define HW_VOL_COUNTER_VOICE    0x1D
DECL|macro|SHADOW_MIX_REG_MASTER
mdefine_line|#define SHADOW_MIX_REG_MASTER   0x1E
DECL|macro|HW_VOL_COUNTER_MASTER
mdefine_line|#define HW_VOL_COUNTER_MASTER   0x1F
DECL|macro|CODEC_COMMAND
mdefine_line|#define CODEC_COMMAND           0x30
DECL|macro|CODEC_READ_B
mdefine_line|#define CODEC_READ_B            0x80
DECL|macro|CODEC_STATUS
mdefine_line|#define CODEC_STATUS            0x30
DECL|macro|CODEC_BUSY_B
mdefine_line|#define CODEC_BUSY_B            0x01
DECL|macro|CODEC_DATA
mdefine_line|#define CODEC_DATA              0x32
DECL|macro|RING_BUS_CTRL_A
mdefine_line|#define RING_BUS_CTRL_A         0x36
DECL|macro|RAC_PME_ENABLE
mdefine_line|#define RAC_PME_ENABLE          0x0100
DECL|macro|RAC_SDFS_ENABLE
mdefine_line|#define RAC_SDFS_ENABLE         0x0200
DECL|macro|LAC_PME_ENABLE
mdefine_line|#define LAC_PME_ENABLE          0x0400
DECL|macro|LAC_SDFS_ENABLE
mdefine_line|#define LAC_SDFS_ENABLE         0x0800
DECL|macro|SERIAL_AC_LINK_ENABLE
mdefine_line|#define SERIAL_AC_LINK_ENABLE   0x1000
DECL|macro|IO_SRAM_ENABLE
mdefine_line|#define IO_SRAM_ENABLE          0x2000
DECL|macro|IIS_INPUT_ENABLE
mdefine_line|#define IIS_INPUT_ENABLE        0x8000
DECL|macro|RING_BUS_CTRL_B
mdefine_line|#define RING_BUS_CTRL_B         0x38
DECL|macro|SECOND_CODEC_ID_MASK
mdefine_line|#define SECOND_CODEC_ID_MASK    0x0003
DECL|macro|SPDIF_FUNC_ENABLE
mdefine_line|#define SPDIF_FUNC_ENABLE       0x0010
DECL|macro|SECOND_AC_ENABLE
mdefine_line|#define SECOND_AC_ENABLE        0x0020
DECL|macro|SB_MODULE_INTF_ENABLE
mdefine_line|#define SB_MODULE_INTF_ENABLE   0x0040
DECL|macro|SSPE_ENABLE
mdefine_line|#define SSPE_ENABLE             0x0040
DECL|macro|M3I_DOCK_ENABLE
mdefine_line|#define M3I_DOCK_ENABLE         0x0080
DECL|macro|SDO_OUT_DEST_CTRL
mdefine_line|#define SDO_OUT_DEST_CTRL       0x3A
DECL|macro|COMMAND_ADDR_OUT
mdefine_line|#define COMMAND_ADDR_OUT        0x0003
DECL|macro|PCM_LR_OUT_LOCAL
mdefine_line|#define PCM_LR_OUT_LOCAL        0x0000
DECL|macro|PCM_LR_OUT_REMOTE
mdefine_line|#define PCM_LR_OUT_REMOTE       0x0004
DECL|macro|PCM_LR_OUT_MUTE
mdefine_line|#define PCM_LR_OUT_MUTE         0x0008
DECL|macro|PCM_LR_OUT_BOTH
mdefine_line|#define PCM_LR_OUT_BOTH         0x000C
DECL|macro|LINE1_DAC_OUT_LOCAL
mdefine_line|#define LINE1_DAC_OUT_LOCAL     0x0000
DECL|macro|LINE1_DAC_OUT_REMOTE
mdefine_line|#define LINE1_DAC_OUT_REMOTE    0x0010
DECL|macro|LINE1_DAC_OUT_MUTE
mdefine_line|#define LINE1_DAC_OUT_MUTE      0x0020
DECL|macro|LINE1_DAC_OUT_BOTH
mdefine_line|#define LINE1_DAC_OUT_BOTH      0x0030
DECL|macro|PCM_CLS_OUT_LOCAL
mdefine_line|#define PCM_CLS_OUT_LOCAL       0x0000
DECL|macro|PCM_CLS_OUT_REMOTE
mdefine_line|#define PCM_CLS_OUT_REMOTE      0x0040
DECL|macro|PCM_CLS_OUT_MUTE
mdefine_line|#define PCM_CLS_OUT_MUTE        0x0080
DECL|macro|PCM_CLS_OUT_BOTH
mdefine_line|#define PCM_CLS_OUT_BOTH        0x00C0
DECL|macro|PCM_RLF_OUT_LOCAL
mdefine_line|#define PCM_RLF_OUT_LOCAL       0x0000
DECL|macro|PCM_RLF_OUT_REMOTE
mdefine_line|#define PCM_RLF_OUT_REMOTE      0x0100
DECL|macro|PCM_RLF_OUT_MUTE
mdefine_line|#define PCM_RLF_OUT_MUTE        0x0200
DECL|macro|PCM_RLF_OUT_BOTH
mdefine_line|#define PCM_RLF_OUT_BOTH        0x0300
DECL|macro|LINE2_DAC_OUT_LOCAL
mdefine_line|#define LINE2_DAC_OUT_LOCAL     0x0000
DECL|macro|LINE2_DAC_OUT_REMOTE
mdefine_line|#define LINE2_DAC_OUT_REMOTE    0x0400
DECL|macro|LINE2_DAC_OUT_MUTE
mdefine_line|#define LINE2_DAC_OUT_MUTE      0x0800
DECL|macro|LINE2_DAC_OUT_BOTH
mdefine_line|#define LINE2_DAC_OUT_BOTH      0x0C00
DECL|macro|HANDSET_OUT_LOCAL
mdefine_line|#define HANDSET_OUT_LOCAL       0x0000
DECL|macro|HANDSET_OUT_REMOTE
mdefine_line|#define HANDSET_OUT_REMOTE      0x1000
DECL|macro|HANDSET_OUT_MUTE
mdefine_line|#define HANDSET_OUT_MUTE        0x2000
DECL|macro|HANDSET_OUT_BOTH
mdefine_line|#define HANDSET_OUT_BOTH        0x3000
DECL|macro|IO_CTRL_OUT_LOCAL
mdefine_line|#define IO_CTRL_OUT_LOCAL       0x0000
DECL|macro|IO_CTRL_OUT_REMOTE
mdefine_line|#define IO_CTRL_OUT_REMOTE      0x4000
DECL|macro|IO_CTRL_OUT_MUTE
mdefine_line|#define IO_CTRL_OUT_MUTE        0x8000
DECL|macro|IO_CTRL_OUT_BOTH
mdefine_line|#define IO_CTRL_OUT_BOTH        0xC000
DECL|macro|SDO_IN_DEST_CTRL
mdefine_line|#define SDO_IN_DEST_CTRL        0x3C
DECL|macro|STATUS_ADDR_IN
mdefine_line|#define STATUS_ADDR_IN          0x0003
DECL|macro|PCM_LR_IN_LOCAL
mdefine_line|#define PCM_LR_IN_LOCAL         0x0000
DECL|macro|PCM_LR_IN_REMOTE
mdefine_line|#define PCM_LR_IN_REMOTE        0x0004
DECL|macro|PCM_LR_RESERVED
mdefine_line|#define PCM_LR_RESERVED         0x0008
DECL|macro|PCM_LR_IN_BOTH
mdefine_line|#define PCM_LR_IN_BOTH          0x000C
DECL|macro|LINE1_ADC_IN_LOCAL
mdefine_line|#define LINE1_ADC_IN_LOCAL      0x0000
DECL|macro|LINE1_ADC_IN_REMOTE
mdefine_line|#define LINE1_ADC_IN_REMOTE     0x0010
DECL|macro|LINE1_ADC_IN_MUTE
mdefine_line|#define LINE1_ADC_IN_MUTE       0x0020
DECL|macro|MIC_ADC_IN_LOCAL
mdefine_line|#define MIC_ADC_IN_LOCAL        0x0000
DECL|macro|MIC_ADC_IN_REMOTE
mdefine_line|#define MIC_ADC_IN_REMOTE       0x0040
DECL|macro|MIC_ADC_IN_MUTE
mdefine_line|#define MIC_ADC_IN_MUTE         0x0080
DECL|macro|LINE2_DAC_IN_LOCAL
mdefine_line|#define LINE2_DAC_IN_LOCAL      0x0000
DECL|macro|LINE2_DAC_IN_REMOTE
mdefine_line|#define LINE2_DAC_IN_REMOTE     0x0400
DECL|macro|LINE2_DAC_IN_MUTE
mdefine_line|#define LINE2_DAC_IN_MUTE       0x0800
DECL|macro|HANDSET_IN_LOCAL
mdefine_line|#define HANDSET_IN_LOCAL        0x0000
DECL|macro|HANDSET_IN_REMOTE
mdefine_line|#define HANDSET_IN_REMOTE       0x1000
DECL|macro|HANDSET_IN_MUTE
mdefine_line|#define HANDSET_IN_MUTE         0x2000
DECL|macro|IO_STATUS_IN_LOCAL
mdefine_line|#define IO_STATUS_IN_LOCAL      0x0000
DECL|macro|IO_STATUS_IN_REMOTE
mdefine_line|#define IO_STATUS_IN_REMOTE     0x4000
DECL|macro|SPDIF_IN_CTRL
mdefine_line|#define SPDIF_IN_CTRL           0x3E
DECL|macro|SPDIF_IN_ENABLE
mdefine_line|#define SPDIF_IN_ENABLE         0x0001
DECL|macro|GPIO_DATA
mdefine_line|#define GPIO_DATA               0x60
DECL|macro|GPIO_DATA_MASK
mdefine_line|#define GPIO_DATA_MASK          0x0FFF
DECL|macro|GPIO_HV_STATUS
mdefine_line|#define GPIO_HV_STATUS          0x3000
DECL|macro|GPIO_PME_STATUS
mdefine_line|#define GPIO_PME_STATUS         0x4000
DECL|macro|GPIO_MASK
mdefine_line|#define GPIO_MASK               0x64
DECL|macro|GPIO_DIRECTION
mdefine_line|#define GPIO_DIRECTION          0x68
DECL|macro|GPO_PRIMARY_AC97
mdefine_line|#define GPO_PRIMARY_AC97        0x0001
DECL|macro|GPI_LINEOUT_SENSE
mdefine_line|#define GPI_LINEOUT_SENSE       0x0004
DECL|macro|GPO_SECONDARY_AC97
mdefine_line|#define GPO_SECONDARY_AC97      0x0008
DECL|macro|GPI_VOL_DOWN
mdefine_line|#define GPI_VOL_DOWN            0x0010
DECL|macro|GPI_VOL_UP
mdefine_line|#define GPI_VOL_UP              0x0020
DECL|macro|GPI_IIS_CLK
mdefine_line|#define GPI_IIS_CLK             0x0040
DECL|macro|GPI_IIS_LRCLK
mdefine_line|#define GPI_IIS_LRCLK           0x0080
DECL|macro|GPI_IIS_DATA
mdefine_line|#define GPI_IIS_DATA            0x0100
DECL|macro|GPI_DOCKING_STATUS
mdefine_line|#define GPI_DOCKING_STATUS      0x0100
DECL|macro|GPI_HEADPHONE_SENSE
mdefine_line|#define GPI_HEADPHONE_SENSE     0x0200
DECL|macro|GPO_EXT_AMP_SHUTDOWN
mdefine_line|#define GPO_EXT_AMP_SHUTDOWN    0x1000
DECL|macro|GPO_EXT_AMP_M3
mdefine_line|#define GPO_EXT_AMP_M3&t;&t;1&t;/* default m3 amp */
DECL|macro|GPO_EXT_AMP_ALLEGRO
mdefine_line|#define GPO_EXT_AMP_ALLEGRO&t;8&t;/* default allegro amp */
multiline_comment|/* M3 */
DECL|macro|GPO_M3_EXT_AMP_SHUTDN
mdefine_line|#define GPO_M3_EXT_AMP_SHUTDN   0x0002
DECL|macro|ASSP_INDEX_PORT
mdefine_line|#define ASSP_INDEX_PORT         0x80
DECL|macro|ASSP_MEMORY_PORT
mdefine_line|#define ASSP_MEMORY_PORT        0x82
DECL|macro|ASSP_DATA_PORT
mdefine_line|#define ASSP_DATA_PORT          0x84
DECL|macro|MPU401_DATA_PORT
mdefine_line|#define MPU401_DATA_PORT        0x98
DECL|macro|MPU401_STATUS_PORT
mdefine_line|#define MPU401_STATUS_PORT      0x99
DECL|macro|CLK_MULT_DATA_PORT
mdefine_line|#define CLK_MULT_DATA_PORT      0x9C
DECL|macro|ASSP_CONTROL_A
mdefine_line|#define ASSP_CONTROL_A          0xA2
DECL|macro|ASSP_0_WS_ENABLE
mdefine_line|#define ASSP_0_WS_ENABLE        0x01
DECL|macro|ASSP_CTRL_A_RESERVED1
mdefine_line|#define ASSP_CTRL_A_RESERVED1   0x02
DECL|macro|ASSP_CTRL_A_RESERVED2
mdefine_line|#define ASSP_CTRL_A_RESERVED2   0x04
DECL|macro|ASSP_CLK_49MHZ_SELECT
mdefine_line|#define ASSP_CLK_49MHZ_SELECT   0x08
DECL|macro|FAST_PLU_ENABLE
mdefine_line|#define FAST_PLU_ENABLE         0x10
DECL|macro|ASSP_CTRL_A_RESERVED3
mdefine_line|#define ASSP_CTRL_A_RESERVED3   0x20
DECL|macro|DSP_CLK_36MHZ_SELECT
mdefine_line|#define DSP_CLK_36MHZ_SELECT    0x40
DECL|macro|ASSP_CONTROL_B
mdefine_line|#define ASSP_CONTROL_B          0xA4
DECL|macro|RESET_ASSP
mdefine_line|#define RESET_ASSP              0x00
DECL|macro|RUN_ASSP
mdefine_line|#define RUN_ASSP                0x01
DECL|macro|ENABLE_ASSP_CLOCK
mdefine_line|#define ENABLE_ASSP_CLOCK       0x00
DECL|macro|STOP_ASSP_CLOCK
mdefine_line|#define STOP_ASSP_CLOCK         0x10
DECL|macro|RESET_TOGGLE
mdefine_line|#define RESET_TOGGLE            0x40
DECL|macro|ASSP_CONTROL_C
mdefine_line|#define ASSP_CONTROL_C          0xA6
DECL|macro|ASSP_HOST_INT_ENABLE
mdefine_line|#define ASSP_HOST_INT_ENABLE    0x01
DECL|macro|FM_ADDR_REMAP_DISABLE
mdefine_line|#define FM_ADDR_REMAP_DISABLE   0x02
DECL|macro|HOST_WRITE_PORT_ENABLE
mdefine_line|#define HOST_WRITE_PORT_ENABLE  0x08
DECL|macro|ASSP_HOST_INT_STATUS
mdefine_line|#define ASSP_HOST_INT_STATUS    0xAC
DECL|macro|DSP2HOST_REQ_PIORECORD
mdefine_line|#define DSP2HOST_REQ_PIORECORD  0x01
DECL|macro|DSP2HOST_REQ_I2SRATE
mdefine_line|#define DSP2HOST_REQ_I2SRATE    0x02
DECL|macro|DSP2HOST_REQ_TIMER
mdefine_line|#define DSP2HOST_REQ_TIMER      0x04
multiline_comment|/* AC97 registers */
multiline_comment|/* XXX fix this crap up */
multiline_comment|/*#define AC97_RESET              0x00*/
DECL|macro|AC97_VOL_MUTE_B
mdefine_line|#define AC97_VOL_MUTE_B         0x8000
DECL|macro|AC97_VOL_M
mdefine_line|#define AC97_VOL_M              0x1F
DECL|macro|AC97_LEFT_VOL_S
mdefine_line|#define AC97_LEFT_VOL_S         8
DECL|macro|AC97_MASTER_VOL
mdefine_line|#define AC97_MASTER_VOL         0x02
DECL|macro|AC97_LINE_LEVEL_VOL
mdefine_line|#define AC97_LINE_LEVEL_VOL     0x04
DECL|macro|AC97_MASTER_MONO_VOL
mdefine_line|#define AC97_MASTER_MONO_VOL    0x06
DECL|macro|AC97_PC_BEEP_VOL
mdefine_line|#define AC97_PC_BEEP_VOL        0x0A
DECL|macro|AC97_PC_BEEP_VOL_M
mdefine_line|#define AC97_PC_BEEP_VOL_M      0x0F
DECL|macro|AC97_SROUND_MASTER_VOL
mdefine_line|#define AC97_SROUND_MASTER_VOL  0x38
DECL|macro|AC97_PC_BEEP_VOL_S
mdefine_line|#define AC97_PC_BEEP_VOL_S      1
multiline_comment|/*#define AC97_PHONE_VOL          0x0C&n;#define AC97_MIC_VOL            0x0E*/
DECL|macro|AC97_MIC_20DB_ENABLE
mdefine_line|#define AC97_MIC_20DB_ENABLE    0x40
multiline_comment|/*#define AC97_LINEIN_VOL         0x10&n;#define AC97_CD_VOL             0x12&n;#define AC97_VIDEO_VOL          0x14&n;#define AC97_AUX_VOL            0x16*/
DECL|macro|AC97_PCM_OUT_VOL
mdefine_line|#define AC97_PCM_OUT_VOL        0x18
multiline_comment|/*#define AC97_RECORD_SELECT      0x1A*/
DECL|macro|AC97_RECORD_MIC
mdefine_line|#define AC97_RECORD_MIC         0x00
DECL|macro|AC97_RECORD_CD
mdefine_line|#define AC97_RECORD_CD          0x01
DECL|macro|AC97_RECORD_VIDEO
mdefine_line|#define AC97_RECORD_VIDEO       0x02
DECL|macro|AC97_RECORD_AUX
mdefine_line|#define AC97_RECORD_AUX         0x03
DECL|macro|AC97_RECORD_MONO_MUX
mdefine_line|#define AC97_RECORD_MONO_MUX    0x02
DECL|macro|AC97_RECORD_DIGITAL
mdefine_line|#define AC97_RECORD_DIGITAL     0x03
DECL|macro|AC97_RECORD_LINE
mdefine_line|#define AC97_RECORD_LINE        0x04
DECL|macro|AC97_RECORD_STEREO
mdefine_line|#define AC97_RECORD_STEREO      0x05
DECL|macro|AC97_RECORD_MONO
mdefine_line|#define AC97_RECORD_MONO        0x06
DECL|macro|AC97_RECORD_PHONE
mdefine_line|#define AC97_RECORD_PHONE       0x07
multiline_comment|/*#define AC97_RECORD_GAIN        0x1C*/
DECL|macro|AC97_RECORD_VOL_M
mdefine_line|#define AC97_RECORD_VOL_M       0x0F
multiline_comment|/*#define AC97_GENERAL_PURPOSE    0x20*/
DECL|macro|AC97_POWER_DOWN_CTRL
mdefine_line|#define AC97_POWER_DOWN_CTRL    0x26
DECL|macro|AC97_ADC_READY
mdefine_line|#define AC97_ADC_READY          0x0001
DECL|macro|AC97_DAC_READY
mdefine_line|#define AC97_DAC_READY          0x0002
DECL|macro|AC97_ANALOG_READY
mdefine_line|#define AC97_ANALOG_READY       0x0004
DECL|macro|AC97_VREF_ON
mdefine_line|#define AC97_VREF_ON            0x0008
DECL|macro|AC97_PR0
mdefine_line|#define AC97_PR0                0x0100
DECL|macro|AC97_PR1
mdefine_line|#define AC97_PR1                0x0200
DECL|macro|AC97_PR2
mdefine_line|#define AC97_PR2                0x0400
DECL|macro|AC97_PR3
mdefine_line|#define AC97_PR3                0x0800
DECL|macro|AC97_PR4
mdefine_line|#define AC97_PR4                0x1000
DECL|macro|AC97_RESERVED1
mdefine_line|#define AC97_RESERVED1          0x28
DECL|macro|AC97_VENDOR_TEST
mdefine_line|#define AC97_VENDOR_TEST        0x5A
DECL|macro|AC97_CLOCK_DELAY
mdefine_line|#define AC97_CLOCK_DELAY        0x5C
DECL|macro|AC97_LINEOUT_MUX_SEL
mdefine_line|#define AC97_LINEOUT_MUX_SEL    0x0001
DECL|macro|AC97_MONO_MUX_SEL
mdefine_line|#define AC97_MONO_MUX_SEL       0x0002
DECL|macro|AC97_CLOCK_DELAY_SEL
mdefine_line|#define AC97_CLOCK_DELAY_SEL    0x1F
DECL|macro|AC97_DAC_CDS_SHIFT
mdefine_line|#define AC97_DAC_CDS_SHIFT      6
DECL|macro|AC97_ADC_CDS_SHIFT
mdefine_line|#define AC97_ADC_CDS_SHIFT      11
DECL|macro|AC97_MULTI_CHANNEL_SEL
mdefine_line|#define AC97_MULTI_CHANNEL_SEL  0x74
multiline_comment|/*#define AC97_VENDOR_ID1         0x7C&n;#define AC97_VENDOR_ID2         0x7E*/
multiline_comment|/*&n; * ASSP control regs&n; */
DECL|macro|DSP_PORT_TIMER_COUNT
mdefine_line|#define DSP_PORT_TIMER_COUNT    0x06
DECL|macro|DSP_PORT_MEMORY_INDEX
mdefine_line|#define DSP_PORT_MEMORY_INDEX   0x80
DECL|macro|DSP_PORT_MEMORY_TYPE
mdefine_line|#define DSP_PORT_MEMORY_TYPE    0x82
DECL|macro|MEMTYPE_INTERNAL_CODE
mdefine_line|#define MEMTYPE_INTERNAL_CODE   0x0002
DECL|macro|MEMTYPE_INTERNAL_DATA
mdefine_line|#define MEMTYPE_INTERNAL_DATA   0x0003
DECL|macro|MEMTYPE_MASK
mdefine_line|#define MEMTYPE_MASK            0x0003
DECL|macro|DSP_PORT_MEMORY_DATA
mdefine_line|#define DSP_PORT_MEMORY_DATA    0x84
DECL|macro|DSP_PORT_CONTROL_REG_A
mdefine_line|#define DSP_PORT_CONTROL_REG_A  0xA2
DECL|macro|DSP_PORT_CONTROL_REG_B
mdefine_line|#define DSP_PORT_CONTROL_REG_B  0xA4
DECL|macro|DSP_PORT_CONTROL_REG_C
mdefine_line|#define DSP_PORT_CONTROL_REG_C  0xA6
DECL|macro|REV_A_CODE_MEMORY_BEGIN
mdefine_line|#define REV_A_CODE_MEMORY_BEGIN         0x0000
DECL|macro|REV_A_CODE_MEMORY_END
mdefine_line|#define REV_A_CODE_MEMORY_END           0x0FFF
DECL|macro|REV_A_CODE_MEMORY_UNIT_LENGTH
mdefine_line|#define REV_A_CODE_MEMORY_UNIT_LENGTH   0x0040
DECL|macro|REV_A_CODE_MEMORY_LENGTH
mdefine_line|#define REV_A_CODE_MEMORY_LENGTH        (REV_A_CODE_MEMORY_END - REV_A_CODE_MEMORY_BEGIN + 1)
DECL|macro|REV_B_CODE_MEMORY_BEGIN
mdefine_line|#define REV_B_CODE_MEMORY_BEGIN         0x0000
DECL|macro|REV_B_CODE_MEMORY_END
mdefine_line|#define REV_B_CODE_MEMORY_END           0x0BFF
DECL|macro|REV_B_CODE_MEMORY_UNIT_LENGTH
mdefine_line|#define REV_B_CODE_MEMORY_UNIT_LENGTH   0x0040
DECL|macro|REV_B_CODE_MEMORY_LENGTH
mdefine_line|#define REV_B_CODE_MEMORY_LENGTH        (REV_B_CODE_MEMORY_END - REV_B_CODE_MEMORY_BEGIN + 1)
DECL|macro|REV_A_DATA_MEMORY_BEGIN
mdefine_line|#define REV_A_DATA_MEMORY_BEGIN         0x1000
DECL|macro|REV_A_DATA_MEMORY_END
mdefine_line|#define REV_A_DATA_MEMORY_END           0x2FFF
DECL|macro|REV_A_DATA_MEMORY_UNIT_LENGTH
mdefine_line|#define REV_A_DATA_MEMORY_UNIT_LENGTH   0x0080
DECL|macro|REV_A_DATA_MEMORY_LENGTH
mdefine_line|#define REV_A_DATA_MEMORY_LENGTH        (REV_A_DATA_MEMORY_END - REV_A_DATA_MEMORY_BEGIN + 1)
DECL|macro|REV_B_DATA_MEMORY_BEGIN
mdefine_line|#define REV_B_DATA_MEMORY_BEGIN         0x1000
DECL|macro|REV_B_DATA_MEMORY_END
mdefine_line|#define REV_B_DATA_MEMORY_END           0x2BFF
DECL|macro|REV_B_DATA_MEMORY_UNIT_LENGTH
mdefine_line|#define REV_B_DATA_MEMORY_UNIT_LENGTH   0x0080
DECL|macro|REV_B_DATA_MEMORY_LENGTH
mdefine_line|#define REV_B_DATA_MEMORY_LENGTH        (REV_B_DATA_MEMORY_END - REV_B_DATA_MEMORY_BEGIN + 1)
DECL|macro|NUM_UNITS_KERNEL_CODE
mdefine_line|#define NUM_UNITS_KERNEL_CODE          16
DECL|macro|NUM_UNITS_KERNEL_DATA
mdefine_line|#define NUM_UNITS_KERNEL_DATA           2
DECL|macro|NUM_UNITS_KERNEL_CODE_WITH_HSP
mdefine_line|#define NUM_UNITS_KERNEL_CODE_WITH_HSP 16
DECL|macro|NUM_UNITS_KERNEL_DATA_WITH_HSP
mdefine_line|#define NUM_UNITS_KERNEL_DATA_WITH_HSP  5
multiline_comment|/*&n; * Kernel data layout&n; */
DECL|macro|DP_SHIFT_COUNT
mdefine_line|#define DP_SHIFT_COUNT                  7
DECL|macro|KDATA_BASE_ADDR
mdefine_line|#define KDATA_BASE_ADDR                 0x1000
DECL|macro|KDATA_BASE_ADDR2
mdefine_line|#define KDATA_BASE_ADDR2                0x1080
DECL|macro|KDATA_TASK0
mdefine_line|#define KDATA_TASK0                     (KDATA_BASE_ADDR + 0x0000)
DECL|macro|KDATA_TASK1
mdefine_line|#define KDATA_TASK1                     (KDATA_BASE_ADDR + 0x0001)
DECL|macro|KDATA_TASK2
mdefine_line|#define KDATA_TASK2                     (KDATA_BASE_ADDR + 0x0002)
DECL|macro|KDATA_TASK3
mdefine_line|#define KDATA_TASK3                     (KDATA_BASE_ADDR + 0x0003)
DECL|macro|KDATA_TASK4
mdefine_line|#define KDATA_TASK4                     (KDATA_BASE_ADDR + 0x0004)
DECL|macro|KDATA_TASK5
mdefine_line|#define KDATA_TASK5                     (KDATA_BASE_ADDR + 0x0005)
DECL|macro|KDATA_TASK6
mdefine_line|#define KDATA_TASK6                     (KDATA_BASE_ADDR + 0x0006)
DECL|macro|KDATA_TASK7
mdefine_line|#define KDATA_TASK7                     (KDATA_BASE_ADDR + 0x0007)
DECL|macro|KDATA_TASK_ENDMARK
mdefine_line|#define KDATA_TASK_ENDMARK              (KDATA_BASE_ADDR + 0x0008)
DECL|macro|KDATA_CURRENT_TASK
mdefine_line|#define KDATA_CURRENT_TASK              (KDATA_BASE_ADDR + 0x0009)
DECL|macro|KDATA_TASK_SWITCH
mdefine_line|#define KDATA_TASK_SWITCH               (KDATA_BASE_ADDR + 0x000A)
DECL|macro|KDATA_INSTANCE0_POS3D
mdefine_line|#define KDATA_INSTANCE0_POS3D           (KDATA_BASE_ADDR + 0x000B)
DECL|macro|KDATA_INSTANCE1_POS3D
mdefine_line|#define KDATA_INSTANCE1_POS3D           (KDATA_BASE_ADDR + 0x000C)
DECL|macro|KDATA_INSTANCE2_POS3D
mdefine_line|#define KDATA_INSTANCE2_POS3D           (KDATA_BASE_ADDR + 0x000D)
DECL|macro|KDATA_INSTANCE3_POS3D
mdefine_line|#define KDATA_INSTANCE3_POS3D           (KDATA_BASE_ADDR + 0x000E)
DECL|macro|KDATA_INSTANCE4_POS3D
mdefine_line|#define KDATA_INSTANCE4_POS3D           (KDATA_BASE_ADDR + 0x000F)
DECL|macro|KDATA_INSTANCE5_POS3D
mdefine_line|#define KDATA_INSTANCE5_POS3D           (KDATA_BASE_ADDR + 0x0010)
DECL|macro|KDATA_INSTANCE6_POS3D
mdefine_line|#define KDATA_INSTANCE6_POS3D           (KDATA_BASE_ADDR + 0x0011)
DECL|macro|KDATA_INSTANCE7_POS3D
mdefine_line|#define KDATA_INSTANCE7_POS3D           (KDATA_BASE_ADDR + 0x0012)
DECL|macro|KDATA_INSTANCE8_POS3D
mdefine_line|#define KDATA_INSTANCE8_POS3D           (KDATA_BASE_ADDR + 0x0013)
DECL|macro|KDATA_INSTANCE_POS3D_ENDMARK
mdefine_line|#define KDATA_INSTANCE_POS3D_ENDMARK    (KDATA_BASE_ADDR + 0x0014)
DECL|macro|KDATA_INSTANCE0_SPKVIRT
mdefine_line|#define KDATA_INSTANCE0_SPKVIRT         (KDATA_BASE_ADDR + 0x0015)
DECL|macro|KDATA_INSTANCE_SPKVIRT_ENDMARK
mdefine_line|#define KDATA_INSTANCE_SPKVIRT_ENDMARK  (KDATA_BASE_ADDR + 0x0016)
DECL|macro|KDATA_INSTANCE0_SPDIF
mdefine_line|#define KDATA_INSTANCE0_SPDIF           (KDATA_BASE_ADDR + 0x0017)
DECL|macro|KDATA_INSTANCE_SPDIF_ENDMARK
mdefine_line|#define KDATA_INSTANCE_SPDIF_ENDMARK    (KDATA_BASE_ADDR + 0x0018)
DECL|macro|KDATA_INSTANCE0_MODEM
mdefine_line|#define KDATA_INSTANCE0_MODEM           (KDATA_BASE_ADDR + 0x0019)
DECL|macro|KDATA_INSTANCE_MODEM_ENDMARK
mdefine_line|#define KDATA_INSTANCE_MODEM_ENDMARK    (KDATA_BASE_ADDR + 0x001A)
DECL|macro|KDATA_INSTANCE0_SRC
mdefine_line|#define KDATA_INSTANCE0_SRC             (KDATA_BASE_ADDR + 0x001B)
DECL|macro|KDATA_INSTANCE1_SRC
mdefine_line|#define KDATA_INSTANCE1_SRC             (KDATA_BASE_ADDR + 0x001C)
DECL|macro|KDATA_INSTANCE_SRC_ENDMARK
mdefine_line|#define KDATA_INSTANCE_SRC_ENDMARK      (KDATA_BASE_ADDR + 0x001D)
DECL|macro|KDATA_INSTANCE0_MINISRC
mdefine_line|#define KDATA_INSTANCE0_MINISRC         (KDATA_BASE_ADDR + 0x001E)
DECL|macro|KDATA_INSTANCE1_MINISRC
mdefine_line|#define KDATA_INSTANCE1_MINISRC         (KDATA_BASE_ADDR + 0x001F)
DECL|macro|KDATA_INSTANCE2_MINISRC
mdefine_line|#define KDATA_INSTANCE2_MINISRC         (KDATA_BASE_ADDR + 0x0020)
DECL|macro|KDATA_INSTANCE3_MINISRC
mdefine_line|#define KDATA_INSTANCE3_MINISRC         (KDATA_BASE_ADDR + 0x0021)
DECL|macro|KDATA_INSTANCE_MINISRC_ENDMARK
mdefine_line|#define KDATA_INSTANCE_MINISRC_ENDMARK  (KDATA_BASE_ADDR + 0x0022)
DECL|macro|KDATA_INSTANCE0_CPYTHRU
mdefine_line|#define KDATA_INSTANCE0_CPYTHRU         (KDATA_BASE_ADDR + 0x0023)
DECL|macro|KDATA_INSTANCE1_CPYTHRU
mdefine_line|#define KDATA_INSTANCE1_CPYTHRU         (KDATA_BASE_ADDR + 0x0024)
DECL|macro|KDATA_INSTANCE_CPYTHRU_ENDMARK
mdefine_line|#define KDATA_INSTANCE_CPYTHRU_ENDMARK  (KDATA_BASE_ADDR + 0x0025)
DECL|macro|KDATA_CURRENT_DMA
mdefine_line|#define KDATA_CURRENT_DMA               (KDATA_BASE_ADDR + 0x0026)
DECL|macro|KDATA_DMA_SWITCH
mdefine_line|#define KDATA_DMA_SWITCH                (KDATA_BASE_ADDR + 0x0027)
DECL|macro|KDATA_DMA_ACTIVE
mdefine_line|#define KDATA_DMA_ACTIVE                (KDATA_BASE_ADDR + 0x0028)
DECL|macro|KDATA_DMA_XFER0
mdefine_line|#define KDATA_DMA_XFER0                 (KDATA_BASE_ADDR + 0x0029)
DECL|macro|KDATA_DMA_XFER1
mdefine_line|#define KDATA_DMA_XFER1                 (KDATA_BASE_ADDR + 0x002A)
DECL|macro|KDATA_DMA_XFER2
mdefine_line|#define KDATA_DMA_XFER2                 (KDATA_BASE_ADDR + 0x002B)
DECL|macro|KDATA_DMA_XFER3
mdefine_line|#define KDATA_DMA_XFER3                 (KDATA_BASE_ADDR + 0x002C)
DECL|macro|KDATA_DMA_XFER4
mdefine_line|#define KDATA_DMA_XFER4                 (KDATA_BASE_ADDR + 0x002D)
DECL|macro|KDATA_DMA_XFER5
mdefine_line|#define KDATA_DMA_XFER5                 (KDATA_BASE_ADDR + 0x002E)
DECL|macro|KDATA_DMA_XFER6
mdefine_line|#define KDATA_DMA_XFER6                 (KDATA_BASE_ADDR + 0x002F)
DECL|macro|KDATA_DMA_XFER7
mdefine_line|#define KDATA_DMA_XFER7                 (KDATA_BASE_ADDR + 0x0030)
DECL|macro|KDATA_DMA_XFER8
mdefine_line|#define KDATA_DMA_XFER8                 (KDATA_BASE_ADDR + 0x0031)
DECL|macro|KDATA_DMA_XFER_ENDMARK
mdefine_line|#define KDATA_DMA_XFER_ENDMARK          (KDATA_BASE_ADDR + 0x0032)
DECL|macro|KDATA_I2S_SAMPLE_COUNT
mdefine_line|#define KDATA_I2S_SAMPLE_COUNT          (KDATA_BASE_ADDR + 0x0033)
DECL|macro|KDATA_I2S_INT_METER
mdefine_line|#define KDATA_I2S_INT_METER             (KDATA_BASE_ADDR + 0x0034)
DECL|macro|KDATA_I2S_ACTIVE
mdefine_line|#define KDATA_I2S_ACTIVE                (KDATA_BASE_ADDR + 0x0035)
DECL|macro|KDATA_TIMER_COUNT_RELOAD
mdefine_line|#define KDATA_TIMER_COUNT_RELOAD        (KDATA_BASE_ADDR + 0x0036)
DECL|macro|KDATA_TIMER_COUNT_CURRENT
mdefine_line|#define KDATA_TIMER_COUNT_CURRENT       (KDATA_BASE_ADDR + 0x0037)
DECL|macro|KDATA_HALT_SYNCH_CLIENT
mdefine_line|#define KDATA_HALT_SYNCH_CLIENT         (KDATA_BASE_ADDR + 0x0038)
DECL|macro|KDATA_HALT_SYNCH_DMA
mdefine_line|#define KDATA_HALT_SYNCH_DMA            (KDATA_BASE_ADDR + 0x0039)
DECL|macro|KDATA_HALT_ACKNOWLEDGE
mdefine_line|#define KDATA_HALT_ACKNOWLEDGE          (KDATA_BASE_ADDR + 0x003A)
DECL|macro|KDATA_ADC1_XFER0
mdefine_line|#define KDATA_ADC1_XFER0                (KDATA_BASE_ADDR + 0x003B)
DECL|macro|KDATA_ADC1_XFER_ENDMARK
mdefine_line|#define KDATA_ADC1_XFER_ENDMARK         (KDATA_BASE_ADDR + 0x003C)
DECL|macro|KDATA_ADC1_LEFT_VOLUME
mdefine_line|#define KDATA_ADC1_LEFT_VOLUME&t;&t;&t;(KDATA_BASE_ADDR + 0x003D)
DECL|macro|KDATA_ADC1_RIGHT_VOLUME
mdefine_line|#define KDATA_ADC1_RIGHT_VOLUME  &t;&t;(KDATA_BASE_ADDR + 0x003E)
DECL|macro|KDATA_ADC1_LEFT_SUR_VOL
mdefine_line|#define KDATA_ADC1_LEFT_SUR_VOL&t;&t;&t;(KDATA_BASE_ADDR + 0x003F)
DECL|macro|KDATA_ADC1_RIGHT_SUR_VOL
mdefine_line|#define KDATA_ADC1_RIGHT_SUR_VOL&t;&t;(KDATA_BASE_ADDR + 0x0040)
DECL|macro|KDATA_ADC2_XFER0
mdefine_line|#define KDATA_ADC2_XFER0                (KDATA_BASE_ADDR + 0x0041)
DECL|macro|KDATA_ADC2_XFER_ENDMARK
mdefine_line|#define KDATA_ADC2_XFER_ENDMARK         (KDATA_BASE_ADDR + 0x0042)
DECL|macro|KDATA_ADC2_LEFT_VOLUME
mdefine_line|#define KDATA_ADC2_LEFT_VOLUME&t;&t;&t;(KDATA_BASE_ADDR + 0x0043)
DECL|macro|KDATA_ADC2_RIGHT_VOLUME
mdefine_line|#define KDATA_ADC2_RIGHT_VOLUME&t;&t;&t;(KDATA_BASE_ADDR + 0x0044)
DECL|macro|KDATA_ADC2_LEFT_SUR_VOL
mdefine_line|#define KDATA_ADC2_LEFT_SUR_VOL&t;&t;&t;(KDATA_BASE_ADDR + 0x0045)
DECL|macro|KDATA_ADC2_RIGHT_SUR_VOL
mdefine_line|#define KDATA_ADC2_RIGHT_SUR_VOL&t;&t;(KDATA_BASE_ADDR + 0x0046)
DECL|macro|KDATA_CD_XFER0
mdefine_line|#define KDATA_CD_XFER0&t;&t;&t;&t;&t;(KDATA_BASE_ADDR + 0x0047)&t;&t;&t;&t;&t;
DECL|macro|KDATA_CD_XFER_ENDMARK
mdefine_line|#define KDATA_CD_XFER_ENDMARK&t;&t;&t;(KDATA_BASE_ADDR + 0x0048)
DECL|macro|KDATA_CD_LEFT_VOLUME
mdefine_line|#define KDATA_CD_LEFT_VOLUME&t;&t;&t;(KDATA_BASE_ADDR + 0x0049)
DECL|macro|KDATA_CD_RIGHT_VOLUME
mdefine_line|#define KDATA_CD_RIGHT_VOLUME&t;&t;&t;(KDATA_BASE_ADDR + 0x004A)
DECL|macro|KDATA_CD_LEFT_SUR_VOL
mdefine_line|#define KDATA_CD_LEFT_SUR_VOL&t;&t;&t;(KDATA_BASE_ADDR + 0x004B)
DECL|macro|KDATA_CD_RIGHT_SUR_VOL
mdefine_line|#define KDATA_CD_RIGHT_SUR_VOL&t;&t;&t;(KDATA_BASE_ADDR + 0x004C)
DECL|macro|KDATA_MIC_XFER0
mdefine_line|#define KDATA_MIC_XFER0&t;&t;&t;&t;&t;(KDATA_BASE_ADDR + 0x004D)
DECL|macro|KDATA_MIC_XFER_ENDMARK
mdefine_line|#define KDATA_MIC_XFER_ENDMARK&t;&t;&t;(KDATA_BASE_ADDR + 0x004E)
DECL|macro|KDATA_MIC_VOLUME
mdefine_line|#define KDATA_MIC_VOLUME&t;&t;&t;&t;(KDATA_BASE_ADDR + 0x004F)
DECL|macro|KDATA_MIC_SUR_VOL
mdefine_line|#define KDATA_MIC_SUR_VOL&t;&t;&t;&t;(KDATA_BASE_ADDR + 0x0050)
DECL|macro|KDATA_I2S_XFER0
mdefine_line|#define KDATA_I2S_XFER0                 (KDATA_BASE_ADDR + 0x0051)
DECL|macro|KDATA_I2S_XFER_ENDMARK
mdefine_line|#define KDATA_I2S_XFER_ENDMARK          (KDATA_BASE_ADDR + 0x0052)
DECL|macro|KDATA_CHI_XFER0
mdefine_line|#define KDATA_CHI_XFER0                 (KDATA_BASE_ADDR + 0x0053)
DECL|macro|KDATA_CHI_XFER_ENDMARK
mdefine_line|#define KDATA_CHI_XFER_ENDMARK          (KDATA_BASE_ADDR + 0x0054)
DECL|macro|KDATA_SPDIF_XFER
mdefine_line|#define KDATA_SPDIF_XFER                (KDATA_BASE_ADDR + 0x0055)
DECL|macro|KDATA_SPDIF_CURRENT_FRAME
mdefine_line|#define KDATA_SPDIF_CURRENT_FRAME       (KDATA_BASE_ADDR + 0x0056)
DECL|macro|KDATA_SPDIF_FRAME0
mdefine_line|#define KDATA_SPDIF_FRAME0              (KDATA_BASE_ADDR + 0x0057)
DECL|macro|KDATA_SPDIF_FRAME1
mdefine_line|#define KDATA_SPDIF_FRAME1              (KDATA_BASE_ADDR + 0x0058)
DECL|macro|KDATA_SPDIF_FRAME2
mdefine_line|#define KDATA_SPDIF_FRAME2              (KDATA_BASE_ADDR + 0x0059)
DECL|macro|KDATA_SPDIF_REQUEST
mdefine_line|#define KDATA_SPDIF_REQUEST             (KDATA_BASE_ADDR + 0x005A)
DECL|macro|KDATA_SPDIF_TEMP
mdefine_line|#define KDATA_SPDIF_TEMP                (KDATA_BASE_ADDR + 0x005B)
DECL|macro|KDATA_SPDIFIN_XFER0
mdefine_line|#define KDATA_SPDIFIN_XFER0             (KDATA_BASE_ADDR + 0x005C)
DECL|macro|KDATA_SPDIFIN_XFER_ENDMARK
mdefine_line|#define KDATA_SPDIFIN_XFER_ENDMARK      (KDATA_BASE_ADDR + 0x005D)
DECL|macro|KDATA_SPDIFIN_INT_METER
mdefine_line|#define KDATA_SPDIFIN_INT_METER         (KDATA_BASE_ADDR + 0x005E)
DECL|macro|KDATA_DSP_RESET_COUNT
mdefine_line|#define KDATA_DSP_RESET_COUNT           (KDATA_BASE_ADDR + 0x005F)
DECL|macro|KDATA_DEBUG_OUTPUT
mdefine_line|#define KDATA_DEBUG_OUTPUT              (KDATA_BASE_ADDR + 0x0060)
DECL|macro|KDATA_KERNEL_ISR_LIST
mdefine_line|#define KDATA_KERNEL_ISR_LIST           (KDATA_BASE_ADDR + 0x0061)
DECL|macro|KDATA_KERNEL_ISR_CBSR1
mdefine_line|#define KDATA_KERNEL_ISR_CBSR1          (KDATA_BASE_ADDR + 0x0062)
DECL|macro|KDATA_KERNEL_ISR_CBER1
mdefine_line|#define KDATA_KERNEL_ISR_CBER1          (KDATA_BASE_ADDR + 0x0063)
DECL|macro|KDATA_KERNEL_ISR_CBCR
mdefine_line|#define KDATA_KERNEL_ISR_CBCR           (KDATA_BASE_ADDR + 0x0064)
DECL|macro|KDATA_KERNEL_ISR_AR0
mdefine_line|#define KDATA_KERNEL_ISR_AR0            (KDATA_BASE_ADDR + 0x0065)
DECL|macro|KDATA_KERNEL_ISR_AR1
mdefine_line|#define KDATA_KERNEL_ISR_AR1            (KDATA_BASE_ADDR + 0x0066)
DECL|macro|KDATA_KERNEL_ISR_AR2
mdefine_line|#define KDATA_KERNEL_ISR_AR2            (KDATA_BASE_ADDR + 0x0067)
DECL|macro|KDATA_KERNEL_ISR_AR3
mdefine_line|#define KDATA_KERNEL_ISR_AR3            (KDATA_BASE_ADDR + 0x0068)
DECL|macro|KDATA_KERNEL_ISR_AR4
mdefine_line|#define KDATA_KERNEL_ISR_AR4            (KDATA_BASE_ADDR + 0x0069)
DECL|macro|KDATA_KERNEL_ISR_AR5
mdefine_line|#define KDATA_KERNEL_ISR_AR5            (KDATA_BASE_ADDR + 0x006A)
DECL|macro|KDATA_KERNEL_ISR_BRCR
mdefine_line|#define KDATA_KERNEL_ISR_BRCR           (KDATA_BASE_ADDR + 0x006B)
DECL|macro|KDATA_KERNEL_ISR_PASR
mdefine_line|#define KDATA_KERNEL_ISR_PASR           (KDATA_BASE_ADDR + 0x006C)
DECL|macro|KDATA_KERNEL_ISR_PAER
mdefine_line|#define KDATA_KERNEL_ISR_PAER           (KDATA_BASE_ADDR + 0x006D)
DECL|macro|KDATA_CLIENT_SCRATCH0
mdefine_line|#define KDATA_CLIENT_SCRATCH0           (KDATA_BASE_ADDR + 0x006E)
DECL|macro|KDATA_CLIENT_SCRATCH1
mdefine_line|#define KDATA_CLIENT_SCRATCH1           (KDATA_BASE_ADDR + 0x006F)
DECL|macro|KDATA_KERNEL_SCRATCH
mdefine_line|#define KDATA_KERNEL_SCRATCH            (KDATA_BASE_ADDR + 0x0070)
DECL|macro|KDATA_KERNEL_ISR_SCRATCH
mdefine_line|#define KDATA_KERNEL_ISR_SCRATCH        (KDATA_BASE_ADDR + 0x0071)
DECL|macro|KDATA_OUEUE_LEFT
mdefine_line|#define KDATA_OUEUE_LEFT                (KDATA_BASE_ADDR + 0x0072)
DECL|macro|KDATA_QUEUE_RIGHT
mdefine_line|#define KDATA_QUEUE_RIGHT               (KDATA_BASE_ADDR + 0x0073)
DECL|macro|KDATA_ADC1_REQUEST
mdefine_line|#define KDATA_ADC1_REQUEST              (KDATA_BASE_ADDR + 0x0074)
DECL|macro|KDATA_ADC2_REQUEST
mdefine_line|#define KDATA_ADC2_REQUEST              (KDATA_BASE_ADDR + 0x0075)
DECL|macro|KDATA_CD_REQUEST
mdefine_line|#define KDATA_CD_REQUEST&t;&t;&t;&t;(KDATA_BASE_ADDR + 0x0076)
DECL|macro|KDATA_MIC_REQUEST
mdefine_line|#define KDATA_MIC_REQUEST&t;&t;&t;&t;(KDATA_BASE_ADDR + 0x0077)
DECL|macro|KDATA_ADC1_MIXER_REQUEST
mdefine_line|#define KDATA_ADC1_MIXER_REQUEST        (KDATA_BASE_ADDR + 0x0078)
DECL|macro|KDATA_ADC2_MIXER_REQUEST
mdefine_line|#define KDATA_ADC2_MIXER_REQUEST        (KDATA_BASE_ADDR + 0x0079)
DECL|macro|KDATA_CD_MIXER_REQUEST
mdefine_line|#define KDATA_CD_MIXER_REQUEST&t;&t;&t;(KDATA_BASE_ADDR + 0x007A)
DECL|macro|KDATA_MIC_MIXER_REQUEST
mdefine_line|#define KDATA_MIC_MIXER_REQUEST&t;&t;&t;(KDATA_BASE_ADDR + 0x007B)
DECL|macro|KDATA_MIC_SYNC_COUNTER
mdefine_line|#define KDATA_MIC_SYNC_COUNTER&t;&t;&t;(KDATA_BASE_ADDR + 0x007C)
multiline_comment|/*&n; * second &squot;segment&squot; (?) reserved for mixer&n; * buffers..&n; */
DECL|macro|KDATA_MIXER_WORD0
mdefine_line|#define KDATA_MIXER_WORD0               (KDATA_BASE_ADDR2 + 0x0000)
DECL|macro|KDATA_MIXER_WORD1
mdefine_line|#define KDATA_MIXER_WORD1               (KDATA_BASE_ADDR2 + 0x0001)
DECL|macro|KDATA_MIXER_WORD2
mdefine_line|#define KDATA_MIXER_WORD2               (KDATA_BASE_ADDR2 + 0x0002)
DECL|macro|KDATA_MIXER_WORD3
mdefine_line|#define KDATA_MIXER_WORD3               (KDATA_BASE_ADDR2 + 0x0003)
DECL|macro|KDATA_MIXER_WORD4
mdefine_line|#define KDATA_MIXER_WORD4               (KDATA_BASE_ADDR2 + 0x0004)
DECL|macro|KDATA_MIXER_WORD5
mdefine_line|#define KDATA_MIXER_WORD5               (KDATA_BASE_ADDR2 + 0x0005)
DECL|macro|KDATA_MIXER_WORD6
mdefine_line|#define KDATA_MIXER_WORD6               (KDATA_BASE_ADDR2 + 0x0006)
DECL|macro|KDATA_MIXER_WORD7
mdefine_line|#define KDATA_MIXER_WORD7               (KDATA_BASE_ADDR2 + 0x0007)
DECL|macro|KDATA_MIXER_WORD8
mdefine_line|#define KDATA_MIXER_WORD8               (KDATA_BASE_ADDR2 + 0x0008)
DECL|macro|KDATA_MIXER_WORD9
mdefine_line|#define KDATA_MIXER_WORD9               (KDATA_BASE_ADDR2 + 0x0009)
DECL|macro|KDATA_MIXER_WORDA
mdefine_line|#define KDATA_MIXER_WORDA               (KDATA_BASE_ADDR2 + 0x000A)
DECL|macro|KDATA_MIXER_WORDB
mdefine_line|#define KDATA_MIXER_WORDB               (KDATA_BASE_ADDR2 + 0x000B)
DECL|macro|KDATA_MIXER_WORDC
mdefine_line|#define KDATA_MIXER_WORDC               (KDATA_BASE_ADDR2 + 0x000C)
DECL|macro|KDATA_MIXER_WORDD
mdefine_line|#define KDATA_MIXER_WORDD               (KDATA_BASE_ADDR2 + 0x000D)
DECL|macro|KDATA_MIXER_WORDE
mdefine_line|#define KDATA_MIXER_WORDE               (KDATA_BASE_ADDR2 + 0x000E)
DECL|macro|KDATA_MIXER_WORDF
mdefine_line|#define KDATA_MIXER_WORDF               (KDATA_BASE_ADDR2 + 0x000F)
DECL|macro|KDATA_MIXER_XFER0
mdefine_line|#define KDATA_MIXER_XFER0               (KDATA_BASE_ADDR2 + 0x0010)
DECL|macro|KDATA_MIXER_XFER1
mdefine_line|#define KDATA_MIXER_XFER1               (KDATA_BASE_ADDR2 + 0x0011)
DECL|macro|KDATA_MIXER_XFER2
mdefine_line|#define KDATA_MIXER_XFER2               (KDATA_BASE_ADDR2 + 0x0012)
DECL|macro|KDATA_MIXER_XFER3
mdefine_line|#define KDATA_MIXER_XFER3               (KDATA_BASE_ADDR2 + 0x0013)
DECL|macro|KDATA_MIXER_XFER4
mdefine_line|#define KDATA_MIXER_XFER4               (KDATA_BASE_ADDR2 + 0x0014)
DECL|macro|KDATA_MIXER_XFER5
mdefine_line|#define KDATA_MIXER_XFER5               (KDATA_BASE_ADDR2 + 0x0015)
DECL|macro|KDATA_MIXER_XFER6
mdefine_line|#define KDATA_MIXER_XFER6               (KDATA_BASE_ADDR2 + 0x0016)
DECL|macro|KDATA_MIXER_XFER7
mdefine_line|#define KDATA_MIXER_XFER7               (KDATA_BASE_ADDR2 + 0x0017)
DECL|macro|KDATA_MIXER_XFER8
mdefine_line|#define KDATA_MIXER_XFER8               (KDATA_BASE_ADDR2 + 0x0018)
DECL|macro|KDATA_MIXER_XFER9
mdefine_line|#define KDATA_MIXER_XFER9               (KDATA_BASE_ADDR2 + 0x0019)
DECL|macro|KDATA_MIXER_XFER_ENDMARK
mdefine_line|#define KDATA_MIXER_XFER_ENDMARK        (KDATA_BASE_ADDR2 + 0x001A)
DECL|macro|KDATA_MIXER_TASK_NUMBER
mdefine_line|#define KDATA_MIXER_TASK_NUMBER         (KDATA_BASE_ADDR2 + 0x001B)
DECL|macro|KDATA_CURRENT_MIXER
mdefine_line|#define KDATA_CURRENT_MIXER             (KDATA_BASE_ADDR2 + 0x001C)
DECL|macro|KDATA_MIXER_ACTIVE
mdefine_line|#define KDATA_MIXER_ACTIVE              (KDATA_BASE_ADDR2 + 0x001D)
DECL|macro|KDATA_MIXER_BANK_STATUS
mdefine_line|#define KDATA_MIXER_BANK_STATUS         (KDATA_BASE_ADDR2 + 0x001E)
DECL|macro|KDATA_DAC_LEFT_VOLUME
mdefine_line|#define KDATA_DAC_LEFT_VOLUME&t;        (KDATA_BASE_ADDR2 + 0x001F)
DECL|macro|KDATA_DAC_RIGHT_VOLUME
mdefine_line|#define KDATA_DAC_RIGHT_VOLUME          (KDATA_BASE_ADDR2 + 0x0020)
DECL|macro|MAX_INSTANCE_MINISRC
mdefine_line|#define MAX_INSTANCE_MINISRC            (KDATA_INSTANCE_MINISRC_ENDMARK - KDATA_INSTANCE0_MINISRC)
DECL|macro|MAX_VIRTUAL_DMA_CHANNELS
mdefine_line|#define MAX_VIRTUAL_DMA_CHANNELS        (KDATA_DMA_XFER_ENDMARK - KDATA_DMA_XFER0)
DECL|macro|MAX_VIRTUAL_MIXER_CHANNELS
mdefine_line|#define MAX_VIRTUAL_MIXER_CHANNELS      (KDATA_MIXER_XFER_ENDMARK - KDATA_MIXER_XFER0)
DECL|macro|MAX_VIRTUAL_ADC1_CHANNELS
mdefine_line|#define MAX_VIRTUAL_ADC1_CHANNELS       (KDATA_ADC1_XFER_ENDMARK - KDATA_ADC1_XFER0)
multiline_comment|/*&n; * client data area offsets&n; */
DECL|macro|CDATA_INSTANCE_READY
mdefine_line|#define CDATA_INSTANCE_READY            0x00
DECL|macro|CDATA_HOST_SRC_ADDRL
mdefine_line|#define CDATA_HOST_SRC_ADDRL            0x01
DECL|macro|CDATA_HOST_SRC_ADDRH
mdefine_line|#define CDATA_HOST_SRC_ADDRH            0x02
DECL|macro|CDATA_HOST_SRC_END_PLUS_1L
mdefine_line|#define CDATA_HOST_SRC_END_PLUS_1L      0x03
DECL|macro|CDATA_HOST_SRC_END_PLUS_1H
mdefine_line|#define CDATA_HOST_SRC_END_PLUS_1H      0x04
DECL|macro|CDATA_HOST_SRC_CURRENTL
mdefine_line|#define CDATA_HOST_SRC_CURRENTL         0x05
DECL|macro|CDATA_HOST_SRC_CURRENTH
mdefine_line|#define CDATA_HOST_SRC_CURRENTH         0x06
DECL|macro|CDATA_IN_BUF_CONNECT
mdefine_line|#define CDATA_IN_BUF_CONNECT            0x07
DECL|macro|CDATA_OUT_BUF_CONNECT
mdefine_line|#define CDATA_OUT_BUF_CONNECT           0x08
DECL|macro|CDATA_IN_BUF_BEGIN
mdefine_line|#define CDATA_IN_BUF_BEGIN              0x09
DECL|macro|CDATA_IN_BUF_END_PLUS_1
mdefine_line|#define CDATA_IN_BUF_END_PLUS_1         0x0A
DECL|macro|CDATA_IN_BUF_HEAD
mdefine_line|#define CDATA_IN_BUF_HEAD               0x0B
DECL|macro|CDATA_IN_BUF_TAIL
mdefine_line|#define CDATA_IN_BUF_TAIL               0x0C
DECL|macro|CDATA_OUT_BUF_BEGIN
mdefine_line|#define CDATA_OUT_BUF_BEGIN             0x0D
DECL|macro|CDATA_OUT_BUF_END_PLUS_1
mdefine_line|#define CDATA_OUT_BUF_END_PLUS_1        0x0E
DECL|macro|CDATA_OUT_BUF_HEAD
mdefine_line|#define CDATA_OUT_BUF_HEAD              0x0F
DECL|macro|CDATA_OUT_BUF_TAIL
mdefine_line|#define CDATA_OUT_BUF_TAIL              0x10
DECL|macro|CDATA_DMA_CONTROL
mdefine_line|#define CDATA_DMA_CONTROL               0x11
DECL|macro|CDATA_RESERVED
mdefine_line|#define CDATA_RESERVED                  0x12
DECL|macro|CDATA_FREQUENCY
mdefine_line|#define CDATA_FREQUENCY                 0x13
DECL|macro|CDATA_LEFT_VOLUME
mdefine_line|#define CDATA_LEFT_VOLUME               0x14
DECL|macro|CDATA_RIGHT_VOLUME
mdefine_line|#define CDATA_RIGHT_VOLUME              0x15
DECL|macro|CDATA_LEFT_SUR_VOL
mdefine_line|#define CDATA_LEFT_SUR_VOL              0x16
DECL|macro|CDATA_RIGHT_SUR_VOL
mdefine_line|#define CDATA_RIGHT_SUR_VOL             0x17
DECL|macro|CDATA_HEADER_LEN
mdefine_line|#define CDATA_HEADER_LEN                0x18
DECL|macro|SRC3_DIRECTION_OFFSET
mdefine_line|#define SRC3_DIRECTION_OFFSET           CDATA_HEADER_LEN
DECL|macro|SRC3_MODE_OFFSET
mdefine_line|#define SRC3_MODE_OFFSET                (CDATA_HEADER_LEN + 1)
DECL|macro|SRC3_WORD_LENGTH_OFFSET
mdefine_line|#define SRC3_WORD_LENGTH_OFFSET         (CDATA_HEADER_LEN + 2)
DECL|macro|SRC3_PARAMETER_OFFSET
mdefine_line|#define SRC3_PARAMETER_OFFSET           (CDATA_HEADER_LEN + 3)
DECL|macro|SRC3_COEFF_ADDR_OFFSET
mdefine_line|#define SRC3_COEFF_ADDR_OFFSET          (CDATA_HEADER_LEN + 8)
DECL|macro|SRC3_FILTAP_ADDR_OFFSET
mdefine_line|#define SRC3_FILTAP_ADDR_OFFSET         (CDATA_HEADER_LEN + 10)
DECL|macro|SRC3_TEMP_INBUF_ADDR_OFFSET
mdefine_line|#define SRC3_TEMP_INBUF_ADDR_OFFSET     (CDATA_HEADER_LEN + 16)
DECL|macro|SRC3_TEMP_OUTBUF_ADDR_OFFSET
mdefine_line|#define SRC3_TEMP_OUTBUF_ADDR_OFFSET    (CDATA_HEADER_LEN + 17)
DECL|macro|MINISRC_IN_BUFFER_SIZE
mdefine_line|#define MINISRC_IN_BUFFER_SIZE   ( 0x50 * 2 )
DECL|macro|MINISRC_OUT_BUFFER_SIZE
mdefine_line|#define MINISRC_OUT_BUFFER_SIZE  ( 0x50 * 2 * 2)
DECL|macro|MINISRC_OUT_BUFFER_SIZE
mdefine_line|#define MINISRC_OUT_BUFFER_SIZE  ( 0x50 * 2 * 2)
DECL|macro|MINISRC_TMP_BUFFER_SIZE
mdefine_line|#define MINISRC_TMP_BUFFER_SIZE  ( 112 + ( MINISRC_BIQUAD_STAGE * 3 + 4 ) * 2 * 2 )
DECL|macro|MINISRC_BIQUAD_STAGE
mdefine_line|#define MINISRC_BIQUAD_STAGE    2
DECL|macro|MINISRC_COEF_LOC
mdefine_line|#define MINISRC_COEF_LOC          0x175
DECL|macro|DMACONTROL_BLOCK_MASK
mdefine_line|#define DMACONTROL_BLOCK_MASK           0x000F
DECL|macro|DMAC_BLOCK0_SELECTOR
mdefine_line|#define  DMAC_BLOCK0_SELECTOR           0x0000
DECL|macro|DMAC_BLOCK1_SELECTOR
mdefine_line|#define  DMAC_BLOCK1_SELECTOR           0x0001
DECL|macro|DMAC_BLOCK2_SELECTOR
mdefine_line|#define  DMAC_BLOCK2_SELECTOR           0x0002
DECL|macro|DMAC_BLOCK3_SELECTOR
mdefine_line|#define  DMAC_BLOCK3_SELECTOR           0x0003
DECL|macro|DMAC_BLOCK4_SELECTOR
mdefine_line|#define  DMAC_BLOCK4_SELECTOR           0x0004
DECL|macro|DMAC_BLOCK5_SELECTOR
mdefine_line|#define  DMAC_BLOCK5_SELECTOR           0x0005
DECL|macro|DMAC_BLOCK6_SELECTOR
mdefine_line|#define  DMAC_BLOCK6_SELECTOR           0x0006
DECL|macro|DMAC_BLOCK7_SELECTOR
mdefine_line|#define  DMAC_BLOCK7_SELECTOR           0x0007
DECL|macro|DMAC_BLOCK8_SELECTOR
mdefine_line|#define  DMAC_BLOCK8_SELECTOR           0x0008
DECL|macro|DMAC_BLOCK9_SELECTOR
mdefine_line|#define  DMAC_BLOCK9_SELECTOR           0x0009
DECL|macro|DMAC_BLOCKA_SELECTOR
mdefine_line|#define  DMAC_BLOCKA_SELECTOR           0x000A
DECL|macro|DMAC_BLOCKB_SELECTOR
mdefine_line|#define  DMAC_BLOCKB_SELECTOR           0x000B
DECL|macro|DMAC_BLOCKC_SELECTOR
mdefine_line|#define  DMAC_BLOCKC_SELECTOR           0x000C
DECL|macro|DMAC_BLOCKD_SELECTOR
mdefine_line|#define  DMAC_BLOCKD_SELECTOR           0x000D
DECL|macro|DMAC_BLOCKE_SELECTOR
mdefine_line|#define  DMAC_BLOCKE_SELECTOR           0x000E
DECL|macro|DMAC_BLOCKF_SELECTOR
mdefine_line|#define  DMAC_BLOCKF_SELECTOR           0x000F
DECL|macro|DMACONTROL_PAGE_MASK
mdefine_line|#define DMACONTROL_PAGE_MASK            0x00F0
DECL|macro|DMAC_PAGE0_SELECTOR
mdefine_line|#define  DMAC_PAGE0_SELECTOR            0x0030
DECL|macro|DMAC_PAGE1_SELECTOR
mdefine_line|#define  DMAC_PAGE1_SELECTOR            0x0020
DECL|macro|DMAC_PAGE2_SELECTOR
mdefine_line|#define  DMAC_PAGE2_SELECTOR            0x0010
DECL|macro|DMAC_PAGE3_SELECTOR
mdefine_line|#define  DMAC_PAGE3_SELECTOR            0x0000
DECL|macro|DMACONTROL_AUTOREPEAT
mdefine_line|#define DMACONTROL_AUTOREPEAT           0x1000
DECL|macro|DMACONTROL_STOPPED
mdefine_line|#define DMACONTROL_STOPPED              0x2000
DECL|macro|DMACONTROL_DIRECTION
mdefine_line|#define DMACONTROL_DIRECTION            0x0100
multiline_comment|/*&n; * an arbitrary volume we set the internal&n; * volume settings to so that the ac97 volume&n; * range is a little less insane.  0x7fff is &n; * max.&n; */
DECL|macro|ARB_VOLUME
mdefine_line|#define ARB_VOLUME ( 0x6800 )
multiline_comment|/*&n; */
DECL|typedef|m3_dma_t
r_typedef
r_struct
id|snd_m3_dma
id|m3_dma_t
suffix:semicolon
DECL|typedef|m3_t
r_typedef
r_struct
id|snd_m3
id|m3_t
suffix:semicolon
DECL|macro|chip_t
mdefine_line|#define chip_t m3_t
DECL|struct|m3_list
r_struct
id|m3_list
(brace
DECL|member|curlen
r_int
id|curlen
suffix:semicolon
DECL|member|mem_addr
r_int
id|mem_addr
suffix:semicolon
DECL|member|max
r_int
id|max
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|snd_m3_dma
r_struct
id|snd_m3_dma
(brace
DECL|member|number
r_int
id|number
suffix:semicolon
DECL|member|chip
id|m3_t
op_star
id|chip
suffix:semicolon
DECL|member|substream
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
DECL|struct|assp_instance
r_struct
id|assp_instance
(brace
DECL|member|code
DECL|member|data
r_int
r_int
id|code
comma
id|data
suffix:semicolon
DECL|member|inst
)brace
id|inst
suffix:semicolon
DECL|member|running
r_int
id|running
suffix:semicolon
DECL|member|opened
r_int
id|opened
suffix:semicolon
DECL|member|buffer_addr
r_int
r_int
id|buffer_addr
suffix:semicolon
DECL|member|dma_size
r_int
id|dma_size
suffix:semicolon
DECL|member|period_size
r_int
id|period_size
suffix:semicolon
DECL|member|hwptr
r_int
r_int
id|hwptr
suffix:semicolon
DECL|member|count
r_int
id|count
suffix:semicolon
DECL|member|index
r_int
id|index
(braket
l_int|3
)braket
suffix:semicolon
DECL|member|index_list
r_struct
id|m3_list
op_star
id|index_list
(braket
l_int|3
)braket
suffix:semicolon
DECL|member|in_lists
r_int
id|in_lists
suffix:semicolon
DECL|member|list
r_struct
id|list_head
id|list
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|snd_m3
r_struct
id|snd_m3
(brace
DECL|member|card
id|snd_card_t
op_star
id|card
suffix:semicolon
DECL|member|iobase
r_int
r_int
id|iobase
suffix:semicolon
DECL|member|iobase_res
r_struct
id|resource
op_star
id|iobase_res
suffix:semicolon
DECL|member|irq
r_int
id|irq
suffix:semicolon
DECL|member|allegro_flag
r_int
id|allegro_flag
suffix:colon
l_int|1
suffix:semicolon
DECL|member|ac97
id|ac97_t
op_star
id|ac97
suffix:semicolon
DECL|member|pcm
id|snd_pcm_t
op_star
id|pcm
suffix:semicolon
DECL|member|pci
r_struct
id|pci_dev
op_star
id|pci
suffix:semicolon
multiline_comment|/* pci_dev in 2.2 kernel doesn&squot;t have them, so we keep them private */
DECL|member|subsystem_vendor
id|u16
id|subsystem_vendor
suffix:semicolon
DECL|member|subsystem_device
id|u16
id|subsystem_device
suffix:semicolon
DECL|member|dacs_active
r_int
id|dacs_active
suffix:semicolon
DECL|member|timer_users
r_int
id|timer_users
suffix:semicolon
DECL|member|msrc_list
r_struct
id|m3_list
id|msrc_list
suffix:semicolon
DECL|member|mixer_list
r_struct
id|m3_list
id|mixer_list
suffix:semicolon
DECL|member|adc1_list
r_struct
id|m3_list
id|adc1_list
suffix:semicolon
DECL|member|dma_list
r_struct
id|m3_list
id|dma_list
suffix:semicolon
multiline_comment|/* for storing reset state..*/
DECL|member|reset_state
id|u8
id|reset_state
suffix:semicolon
DECL|member|external_amp
r_int
id|external_amp
suffix:semicolon
DECL|member|amp_gpio
r_int
id|amp_gpio
suffix:semicolon
multiline_comment|/* pcm streams */
DECL|member|num_substreams
r_int
id|num_substreams
suffix:semicolon
DECL|member|substreams
id|m3_dma_t
op_star
id|substreams
suffix:semicolon
DECL|member|reg_lock
id|spinlock_t
id|reg_lock
suffix:semicolon
macro_line|#ifdef CONFIG_PM
DECL|member|suspend_mem
id|u16
op_star
id|suspend_mem
suffix:semicolon
macro_line|#endif
)brace
suffix:semicolon
multiline_comment|/*&n; * pci ids&n; */
macro_line|#ifndef PCI_VENDOR_ID_ESS
DECL|macro|PCI_VENDOR_ID_ESS
mdefine_line|#define PCI_VENDOR_ID_ESS         0x125D
macro_line|#endif
macro_line|#ifndef PCI_DEVICE_ID_ESS_ALLEGRO_1
DECL|macro|PCI_DEVICE_ID_ESS_ALLEGRO_1
mdefine_line|#define PCI_DEVICE_ID_ESS_ALLEGRO_1&t;0x1988
macro_line|#endif
macro_line|#ifndef PCI_DEVICE_ID_ESS_ALLEGRO
DECL|macro|PCI_DEVICE_ID_ESS_ALLEGRO
mdefine_line|#define PCI_DEVICE_ID_ESS_ALLEGRO&t;0x1989
macro_line|#endif
macro_line|#ifndef PCI_DEVICE_ID_ESS_CANYON3D_2LE
DECL|macro|PCI_DEVICE_ID_ESS_CANYON3D_2LE
mdefine_line|#define PCI_DEVICE_ID_ESS_CANYON3D_2LE&t;0x1990
macro_line|#endif
macro_line|#ifndef PCI_DEVICE_ID_ESS_CANYON3D_2
DECL|macro|PCI_DEVICE_ID_ESS_CANYON3D_2
mdefine_line|#define PCI_DEVICE_ID_ESS_CANYON3D_2&t;0x1992
macro_line|#endif
macro_line|#ifndef PCI_DEVICE_ID_ESS_MAESTRO3
DECL|macro|PCI_DEVICE_ID_ESS_MAESTRO3
mdefine_line|#define PCI_DEVICE_ID_ESS_MAESTRO3&t;0x1998
macro_line|#endif
macro_line|#ifndef PCI_DEVICE_ID_ESS_MAESTRO3_1
DECL|macro|PCI_DEVICE_ID_ESS_MAESTRO3_1
mdefine_line|#define PCI_DEVICE_ID_ESS_MAESTRO3_1&t;0x1999
macro_line|#endif
macro_line|#ifndef PCI_DEVICE_ID_ESS_MAESTRO3_HW
DECL|macro|PCI_DEVICE_ID_ESS_MAESTRO3_HW
mdefine_line|#define PCI_DEVICE_ID_ESS_MAESTRO3_HW&t;0x199a
macro_line|#endif
macro_line|#ifndef PCI_DEVICE_ID_ESS_MAESTRO3_2
DECL|macro|PCI_DEVICE_ID_ESS_MAESTRO3_2
mdefine_line|#define PCI_DEVICE_ID_ESS_MAESTRO3_2&t;0x199b
macro_line|#endif
DECL|variable|__devinitdata
r_static
r_struct
id|pci_device_id
id|snd_m3_ids
(braket
)braket
id|__devinitdata
op_assign
(brace
(brace
id|PCI_VENDOR_ID_ESS
comma
id|PCI_DEVICE_ID_ESS_ALLEGRO_1
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
id|PCI_CLASS_MULTIMEDIA_AUDIO
op_lshift
l_int|8
comma
l_int|0xffff00
comma
l_int|0
)brace
comma
(brace
id|PCI_VENDOR_ID_ESS
comma
id|PCI_DEVICE_ID_ESS_ALLEGRO
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
id|PCI_CLASS_MULTIMEDIA_AUDIO
op_lshift
l_int|8
comma
l_int|0xffff00
comma
l_int|0
)brace
comma
(brace
id|PCI_VENDOR_ID_ESS
comma
id|PCI_DEVICE_ID_ESS_CANYON3D_2LE
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
id|PCI_CLASS_MULTIMEDIA_AUDIO
op_lshift
l_int|8
comma
l_int|0xffff00
comma
l_int|0
)brace
comma
(brace
id|PCI_VENDOR_ID_ESS
comma
id|PCI_DEVICE_ID_ESS_CANYON3D_2
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
id|PCI_CLASS_MULTIMEDIA_AUDIO
op_lshift
l_int|8
comma
l_int|0xffff00
comma
l_int|0
)brace
comma
(brace
id|PCI_VENDOR_ID_ESS
comma
id|PCI_DEVICE_ID_ESS_MAESTRO3
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
id|PCI_CLASS_MULTIMEDIA_AUDIO
op_lshift
l_int|8
comma
l_int|0xffff00
comma
l_int|0
)brace
comma
(brace
id|PCI_VENDOR_ID_ESS
comma
id|PCI_DEVICE_ID_ESS_MAESTRO3_1
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
id|PCI_CLASS_MULTIMEDIA_AUDIO
op_lshift
l_int|8
comma
l_int|0xffff00
comma
l_int|0
)brace
comma
(brace
id|PCI_VENDOR_ID_ESS
comma
id|PCI_DEVICE_ID_ESS_MAESTRO3_HW
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
id|PCI_CLASS_MULTIMEDIA_AUDIO
op_lshift
l_int|8
comma
l_int|0xffff00
comma
l_int|0
)brace
comma
(brace
id|PCI_VENDOR_ID_ESS
comma
id|PCI_DEVICE_ID_ESS_MAESTRO3_2
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
id|PCI_CLASS_MULTIMEDIA_AUDIO
op_lshift
l_int|8
comma
l_int|0xffff00
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
)brace
comma
)brace
suffix:semicolon
id|MODULE_DEVICE_TABLE
c_func
(paren
id|pci
comma
id|snd_m3_ids
)paren
suffix:semicolon
multiline_comment|/*&n; * lowlevel functions&n; */
DECL|function|snd_m3_outw
r_inline
r_static
r_void
id|snd_m3_outw
c_func
(paren
id|m3_t
op_star
id|chip
comma
id|u16
id|value
comma
r_int
r_int
id|reg
)paren
(brace
id|outw
c_func
(paren
id|value
comma
id|chip-&gt;iobase
op_plus
id|reg
)paren
suffix:semicolon
)brace
DECL|function|snd_m3_inw
r_inline
r_static
id|u16
id|snd_m3_inw
c_func
(paren
id|m3_t
op_star
id|chip
comma
r_int
r_int
id|reg
)paren
(brace
r_return
id|inw
c_func
(paren
id|chip-&gt;iobase
op_plus
id|reg
)paren
suffix:semicolon
)brace
DECL|function|snd_m3_outb
r_inline
r_static
r_void
id|snd_m3_outb
c_func
(paren
id|m3_t
op_star
id|chip
comma
id|u8
id|value
comma
r_int
r_int
id|reg
)paren
(brace
id|outb
c_func
(paren
id|value
comma
id|chip-&gt;iobase
op_plus
id|reg
)paren
suffix:semicolon
)brace
DECL|function|snd_m3_inb
r_inline
r_static
id|u8
id|snd_m3_inb
c_func
(paren
id|m3_t
op_star
id|chip
comma
r_int
r_int
id|reg
)paren
(brace
r_return
id|inb
c_func
(paren
id|chip-&gt;iobase
op_plus
id|reg
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * access 16bit words to the code or data regions of the dsp&squot;s memory.&n; * index addresses 16bit words.&n; */
DECL|function|snd_m3_assp_read
r_static
id|u16
id|snd_m3_assp_read
c_func
(paren
id|m3_t
op_star
id|chip
comma
id|u16
id|region
comma
id|u16
id|index
)paren
(brace
id|snd_m3_outw
c_func
(paren
id|chip
comma
id|region
op_amp
id|MEMTYPE_MASK
comma
id|DSP_PORT_MEMORY_TYPE
)paren
suffix:semicolon
id|snd_m3_outw
c_func
(paren
id|chip
comma
id|index
comma
id|DSP_PORT_MEMORY_INDEX
)paren
suffix:semicolon
r_return
id|snd_m3_inw
c_func
(paren
id|chip
comma
id|DSP_PORT_MEMORY_DATA
)paren
suffix:semicolon
)brace
DECL|function|snd_m3_assp_write
r_static
r_void
id|snd_m3_assp_write
c_func
(paren
id|m3_t
op_star
id|chip
comma
id|u16
id|region
comma
id|u16
id|index
comma
id|u16
id|data
)paren
(brace
id|snd_m3_outw
c_func
(paren
id|chip
comma
id|region
op_amp
id|MEMTYPE_MASK
comma
id|DSP_PORT_MEMORY_TYPE
)paren
suffix:semicolon
id|snd_m3_outw
c_func
(paren
id|chip
comma
id|index
comma
id|DSP_PORT_MEMORY_INDEX
)paren
suffix:semicolon
id|snd_m3_outw
c_func
(paren
id|chip
comma
id|data
comma
id|DSP_PORT_MEMORY_DATA
)paren
suffix:semicolon
)brace
DECL|function|snd_m3_assp_halt
r_static
r_void
id|snd_m3_assp_halt
c_func
(paren
id|m3_t
op_star
id|chip
)paren
(brace
id|chip-&gt;reset_state
op_assign
id|snd_m3_inb
c_func
(paren
id|chip
comma
id|DSP_PORT_CONTROL_REG_B
)paren
op_amp
op_complement
id|REGB_STOP_CLOCK
suffix:semicolon
id|mdelay
c_func
(paren
l_int|10
)paren
suffix:semicolon
id|snd_m3_outb
c_func
(paren
id|chip
comma
id|chip-&gt;reset_state
op_amp
op_complement
id|REGB_ENABLE_RESET
comma
id|DSP_PORT_CONTROL_REG_B
)paren
suffix:semicolon
)brace
DECL|function|snd_m3_assp_continue
r_static
r_void
id|snd_m3_assp_continue
c_func
(paren
id|m3_t
op_star
id|chip
)paren
(brace
id|snd_m3_outb
c_func
(paren
id|chip
comma
id|chip-&gt;reset_state
op_or
id|REGB_ENABLE_RESET
comma
id|DSP_PORT_CONTROL_REG_B
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * This makes me sad. the maestro3 has lists&n; * internally that must be packed.. 0 terminates,&n; * apparently, or maybe all unused entries have&n; * to be 0, the lists have static lengths set&n; * by the binary code images.&n; */
DECL|function|snd_m3_add_list
r_static
r_int
id|snd_m3_add_list
c_func
(paren
id|m3_t
op_star
id|chip
comma
r_struct
id|m3_list
op_star
id|list
comma
id|u16
id|val
)paren
(brace
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|list-&gt;mem_addr
op_plus
id|list-&gt;curlen
comma
id|val
)paren
suffix:semicolon
r_return
id|list-&gt;curlen
op_increment
suffix:semicolon
)brace
DECL|function|snd_m3_remove_list
r_static
r_void
id|snd_m3_remove_list
c_func
(paren
id|m3_t
op_star
id|chip
comma
r_struct
id|m3_list
op_star
id|list
comma
r_int
id|index
)paren
(brace
id|u16
id|val
suffix:semicolon
r_int
id|lastindex
op_assign
id|list-&gt;curlen
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|index
op_ne
id|lastindex
)paren
(brace
id|val
op_assign
id|snd_m3_assp_read
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|list-&gt;mem_addr
op_plus
id|lastindex
)paren
suffix:semicolon
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|list-&gt;mem_addr
op_plus
id|index
comma
id|val
)paren
suffix:semicolon
)brace
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|list-&gt;mem_addr
op_plus
id|lastindex
comma
l_int|0
)paren
suffix:semicolon
id|list-&gt;curlen
op_decrement
suffix:semicolon
)brace
DECL|function|snd_m3_inc_timer_users
r_static
r_void
id|snd_m3_inc_timer_users
c_func
(paren
id|m3_t
op_star
id|chip
)paren
(brace
id|chip-&gt;timer_users
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;timer_users
op_ne
l_int|1
)paren
r_return
suffix:semicolon
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|KDATA_TIMER_COUNT_RELOAD
comma
l_int|240
)paren
suffix:semicolon
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|KDATA_TIMER_COUNT_CURRENT
comma
l_int|240
)paren
suffix:semicolon
id|snd_m3_outw
c_func
(paren
id|chip
comma
id|snd_m3_inw
c_func
(paren
id|chip
comma
id|HOST_INT_CTRL
)paren
op_or
id|CLKRUN_GEN_ENABLE
comma
id|HOST_INT_CTRL
)paren
suffix:semicolon
)brace
DECL|function|snd_m3_dec_timer_users
r_static
r_void
id|snd_m3_dec_timer_users
c_func
(paren
id|m3_t
op_star
id|chip
)paren
(brace
id|chip-&gt;timer_users
op_decrement
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;timer_users
OG
l_int|0
)paren
r_return
suffix:semicolon
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|KDATA_TIMER_COUNT_RELOAD
comma
l_int|0
)paren
suffix:semicolon
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|KDATA_TIMER_COUNT_CURRENT
comma
l_int|0
)paren
suffix:semicolon
id|snd_m3_outw
c_func
(paren
id|chip
comma
id|snd_m3_inw
c_func
(paren
id|chip
comma
id|HOST_INT_CTRL
)paren
op_amp
op_complement
id|CLKRUN_GEN_ENABLE
comma
id|HOST_INT_CTRL
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * start/stop&n; */
multiline_comment|/* spinlock held! */
DECL|function|snd_m3_pcm_start
r_static
r_int
id|snd_m3_pcm_start
c_func
(paren
id|m3_t
op_star
id|chip
comma
id|m3_dma_t
op_star
id|s
comma
id|snd_pcm_substream_t
op_star
id|subs
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|s
op_logical_or
op_logical_neg
id|subs
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|snd_m3_inc_timer_users
c_func
(paren
id|chip
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|subs-&gt;stream
)paren
(brace
r_case
id|SNDRV_PCM_STREAM_PLAYBACK
suffix:colon
id|chip-&gt;dacs_active
op_increment
suffix:semicolon
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|s-&gt;inst.data
op_plus
id|CDATA_INSTANCE_READY
comma
l_int|1
)paren
suffix:semicolon
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|KDATA_MIXER_TASK_NUMBER
comma
id|chip-&gt;dacs_active
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_STREAM_CAPTURE
suffix:colon
id|snd_m3_assp_write
c_func
(paren
id|s-&gt;chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|KDATA_ADC1_REQUEST
comma
l_int|1
)paren
suffix:semicolon
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|s-&gt;inst.data
op_plus
id|CDATA_INSTANCE_READY
comma
l_int|1
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* spinlock held! */
DECL|function|snd_m3_pcm_stop
r_static
r_int
id|snd_m3_pcm_stop
c_func
(paren
id|m3_t
op_star
id|chip
comma
id|m3_dma_t
op_star
id|s
comma
id|snd_pcm_substream_t
op_star
id|subs
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|s
op_logical_or
op_logical_neg
id|subs
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|s-&gt;inst.data
op_plus
id|CDATA_INSTANCE_READY
comma
l_int|0
)paren
suffix:semicolon
id|snd_m3_dec_timer_users
c_func
(paren
id|chip
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|subs-&gt;stream
)paren
(brace
r_case
id|SNDRV_PCM_STREAM_PLAYBACK
suffix:colon
id|chip-&gt;dacs_active
op_decrement
suffix:semicolon
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|KDATA_MIXER_TASK_NUMBER
comma
id|chip-&gt;dacs_active
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_STREAM_CAPTURE
suffix:colon
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|KDATA_ADC1_REQUEST
comma
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|snd_m3_pcm_trigger
id|snd_m3_pcm_trigger
c_func
(paren
id|snd_pcm_substream_t
op_star
id|subs
comma
r_int
id|cmd
)paren
(brace
id|m3_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|subs
)paren
suffix:semicolon
id|m3_dma_t
op_star
id|s
op_assign
(paren
id|m3_dma_t
op_star
)paren
id|subs-&gt;runtime-&gt;private_data
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
id|err
op_assign
op_minus
id|EINVAL
suffix:semicolon
id|snd_assert
c_func
(paren
id|s
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|SNDRV_PCM_TRIGGER_START
suffix:colon
r_case
id|SNDRV_PCM_TRIGGER_RESUME
suffix:colon
r_if
c_cond
(paren
id|s-&gt;running
)paren
id|err
op_assign
op_minus
id|EBUSY
suffix:semicolon
r_else
(brace
id|s-&gt;running
op_assign
l_int|1
suffix:semicolon
id|err
op_assign
id|snd_m3_pcm_start
c_func
(paren
id|chip
comma
id|s
comma
id|subs
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_TRIGGER_STOP
suffix:colon
r_case
id|SNDRV_PCM_TRIGGER_SUSPEND
suffix:colon
r_if
c_cond
(paren
op_logical_neg
id|s-&gt;running
)paren
id|err
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* should return error? */
r_else
(brace
id|s-&gt;running
op_assign
l_int|0
suffix:semicolon
id|err
op_assign
id|snd_m3_pcm_stop
c_func
(paren
id|chip
comma
id|s
comma
id|subs
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
)brace
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
multiline_comment|/*&n; * setup&n; */
r_static
r_void
DECL|function|snd_m3_pcm_setup1
id|snd_m3_pcm_setup1
c_func
(paren
id|m3_t
op_star
id|chip
comma
id|m3_dma_t
op_star
id|s
comma
id|snd_pcm_substream_t
op_star
id|subs
)paren
(brace
r_int
id|dsp_in_size
comma
id|dsp_out_size
comma
id|dsp_in_buffer
comma
id|dsp_out_buffer
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|subs-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|subs-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_PLAYBACK
)paren
(brace
id|dsp_in_size
op_assign
id|MINISRC_IN_BUFFER_SIZE
op_minus
(paren
l_int|0x20
op_star
l_int|2
)paren
suffix:semicolon
id|dsp_out_size
op_assign
id|MINISRC_OUT_BUFFER_SIZE
op_minus
(paren
l_int|0x20
op_star
l_int|2
)paren
suffix:semicolon
)brace
r_else
(brace
id|dsp_in_size
op_assign
id|MINISRC_IN_BUFFER_SIZE
op_minus
(paren
l_int|0x10
op_star
l_int|2
)paren
suffix:semicolon
id|dsp_out_size
op_assign
id|MINISRC_OUT_BUFFER_SIZE
op_minus
(paren
l_int|0x10
op_star
l_int|2
)paren
suffix:semicolon
)brace
id|dsp_in_buffer
op_assign
id|s-&gt;inst.data
op_plus
(paren
id|MINISRC_TMP_BUFFER_SIZE
op_div
l_int|2
)paren
suffix:semicolon
id|dsp_out_buffer
op_assign
id|dsp_in_buffer
op_plus
(paren
id|dsp_in_size
op_div
l_int|2
)paren
op_plus
l_int|1
suffix:semicolon
id|s-&gt;dma_size
op_assign
id|frames_to_bytes
c_func
(paren
id|runtime
comma
id|runtime-&gt;buffer_size
)paren
suffix:semicolon
id|s-&gt;period_size
op_assign
id|frames_to_bytes
c_func
(paren
id|runtime
comma
id|runtime-&gt;period_size
)paren
suffix:semicolon
id|s-&gt;hwptr
op_assign
l_int|0
suffix:semicolon
id|s-&gt;count
op_assign
l_int|0
suffix:semicolon
DECL|macro|LO
mdefine_line|#define LO(x) ((x) &amp; 0xffff)
DECL|macro|HI
mdefine_line|#define HI(x) LO((x) &gt;&gt; 16)
multiline_comment|/* host dma buffer pointers */
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|s-&gt;inst.data
op_plus
id|CDATA_HOST_SRC_ADDRL
comma
id|LO
c_func
(paren
id|s-&gt;buffer_addr
)paren
)paren
suffix:semicolon
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|s-&gt;inst.data
op_plus
id|CDATA_HOST_SRC_ADDRH
comma
id|HI
c_func
(paren
id|s-&gt;buffer_addr
)paren
)paren
suffix:semicolon
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|s-&gt;inst.data
op_plus
id|CDATA_HOST_SRC_END_PLUS_1L
comma
id|LO
c_func
(paren
id|s-&gt;buffer_addr
op_plus
id|s-&gt;dma_size
)paren
)paren
suffix:semicolon
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|s-&gt;inst.data
op_plus
id|CDATA_HOST_SRC_END_PLUS_1H
comma
id|HI
c_func
(paren
id|s-&gt;buffer_addr
op_plus
id|s-&gt;dma_size
)paren
)paren
suffix:semicolon
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|s-&gt;inst.data
op_plus
id|CDATA_HOST_SRC_CURRENTL
comma
id|LO
c_func
(paren
id|s-&gt;buffer_addr
)paren
)paren
suffix:semicolon
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|s-&gt;inst.data
op_plus
id|CDATA_HOST_SRC_CURRENTH
comma
id|HI
c_func
(paren
id|s-&gt;buffer_addr
)paren
)paren
suffix:semicolon
DECL|macro|LO
macro_line|#undef LO
DECL|macro|HI
macro_line|#undef HI
multiline_comment|/* dsp buffers */
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|s-&gt;inst.data
op_plus
id|CDATA_IN_BUF_BEGIN
comma
id|dsp_in_buffer
)paren
suffix:semicolon
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|s-&gt;inst.data
op_plus
id|CDATA_IN_BUF_END_PLUS_1
comma
id|dsp_in_buffer
op_plus
(paren
id|dsp_in_size
op_div
l_int|2
)paren
)paren
suffix:semicolon
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|s-&gt;inst.data
op_plus
id|CDATA_IN_BUF_HEAD
comma
id|dsp_in_buffer
)paren
suffix:semicolon
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|s-&gt;inst.data
op_plus
id|CDATA_IN_BUF_TAIL
comma
id|dsp_in_buffer
)paren
suffix:semicolon
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|s-&gt;inst.data
op_plus
id|CDATA_OUT_BUF_BEGIN
comma
id|dsp_out_buffer
)paren
suffix:semicolon
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|s-&gt;inst.data
op_plus
id|CDATA_OUT_BUF_END_PLUS_1
comma
id|dsp_out_buffer
op_plus
(paren
id|dsp_out_size
op_div
l_int|2
)paren
)paren
suffix:semicolon
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|s-&gt;inst.data
op_plus
id|CDATA_OUT_BUF_HEAD
comma
id|dsp_out_buffer
)paren
suffix:semicolon
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|s-&gt;inst.data
op_plus
id|CDATA_OUT_BUF_TAIL
comma
id|dsp_out_buffer
)paren
suffix:semicolon
)brace
DECL|function|snd_m3_pcm_setup2
r_static
r_void
id|snd_m3_pcm_setup2
c_func
(paren
id|m3_t
op_star
id|chip
comma
id|m3_dma_t
op_star
id|s
comma
id|snd_pcm_runtime_t
op_star
id|runtime
)paren
(brace
id|u32
id|freq
suffix:semicolon
multiline_comment|/* &n;&t; * put us in the lists if we&squot;re not already there&n;&t; */
r_if
c_cond
(paren
op_logical_neg
id|s-&gt;in_lists
)paren
(brace
id|s-&gt;index
(braket
l_int|0
)braket
op_assign
id|snd_m3_add_list
c_func
(paren
id|chip
comma
id|s-&gt;index_list
(braket
l_int|0
)braket
comma
id|s-&gt;inst.data
op_rshift
id|DP_SHIFT_COUNT
)paren
suffix:semicolon
id|s-&gt;index
(braket
l_int|1
)braket
op_assign
id|snd_m3_add_list
c_func
(paren
id|chip
comma
id|s-&gt;index_list
(braket
l_int|1
)braket
comma
id|s-&gt;inst.data
op_rshift
id|DP_SHIFT_COUNT
)paren
suffix:semicolon
id|s-&gt;index
(braket
l_int|2
)braket
op_assign
id|snd_m3_add_list
c_func
(paren
id|chip
comma
id|s-&gt;index_list
(braket
l_int|2
)braket
comma
id|s-&gt;inst.data
op_rshift
id|DP_SHIFT_COUNT
)paren
suffix:semicolon
id|s-&gt;in_lists
op_assign
l_int|1
suffix:semicolon
)brace
multiline_comment|/* write to &squot;mono&squot; word */
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|s-&gt;inst.data
op_plus
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|1
comma
id|runtime-&gt;channels
op_eq
l_int|2
ques
c_cond
l_int|0
suffix:colon
l_int|1
)paren
suffix:semicolon
multiline_comment|/* write to &squot;8bit&squot; word */
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|s-&gt;inst.data
op_plus
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|2
comma
id|snd_pcm_format_width
c_func
(paren
id|runtime-&gt;format
)paren
op_eq
l_int|16
ques
c_cond
l_int|0
suffix:colon
l_int|1
)paren
suffix:semicolon
multiline_comment|/* set up dac/adc rate */
id|freq
op_assign
(paren
(paren
id|runtime-&gt;rate
op_lshift
l_int|15
)paren
op_plus
l_int|24000
)paren
op_div
l_int|48000
suffix:semicolon
r_if
c_cond
(paren
id|freq
)paren
id|freq
op_decrement
suffix:semicolon
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|s-&gt;inst.data
op_plus
id|CDATA_FREQUENCY
comma
id|freq
)paren
suffix:semicolon
)brace
DECL|struct|play_vals
r_static
r_struct
id|play_vals
(brace
DECL|member|addr
DECL|member|val
id|u16
id|addr
comma
id|val
suffix:semicolon
DECL|variable|pv
)brace
id|pv
(braket
)braket
op_assign
(brace
(brace
id|CDATA_LEFT_VOLUME
comma
id|ARB_VOLUME
)brace
comma
(brace
id|CDATA_RIGHT_VOLUME
comma
id|ARB_VOLUME
)brace
comma
(brace
id|SRC3_DIRECTION_OFFSET
comma
l_int|0
)brace
comma
multiline_comment|/* +1, +2 are stereo/16 bit */
(brace
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|3
comma
l_int|0x0000
)brace
comma
multiline_comment|/* fraction? */
(brace
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|4
comma
l_int|0
)brace
comma
multiline_comment|/* first l */
(brace
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|5
comma
l_int|0
)brace
comma
multiline_comment|/* first r */
(brace
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|6
comma
l_int|0
)brace
comma
multiline_comment|/* second l */
(brace
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|7
comma
l_int|0
)brace
comma
multiline_comment|/* second r */
(brace
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|8
comma
l_int|0
)brace
comma
multiline_comment|/* delta l */
(brace
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|9
comma
l_int|0
)brace
comma
multiline_comment|/* delta r */
(brace
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|10
comma
l_int|0x8000
)brace
comma
multiline_comment|/* round */
(brace
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|11
comma
l_int|0xFF00
)brace
comma
multiline_comment|/* higher bute mark */
(brace
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|13
comma
l_int|0
)brace
comma
multiline_comment|/* temp0 */
(brace
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|14
comma
l_int|0
)brace
comma
multiline_comment|/* c fraction */
(brace
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|15
comma
l_int|0
)brace
comma
multiline_comment|/* counter */
(brace
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|16
comma
l_int|8
)brace
comma
multiline_comment|/* numin */
(brace
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|17
comma
l_int|50
op_star
l_int|2
)brace
comma
multiline_comment|/* numout */
(brace
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|18
comma
id|MINISRC_BIQUAD_STAGE
op_minus
l_int|1
)brace
comma
multiline_comment|/* numstage */
(brace
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|20
comma
l_int|0
)brace
comma
multiline_comment|/* filtertap */
(brace
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|21
comma
l_int|0
)brace
multiline_comment|/* booster */
)brace
suffix:semicolon
multiline_comment|/* the mode passed should be already shifted and masked */
r_static
r_void
DECL|function|snd_m3_playback_setup
id|snd_m3_playback_setup
c_func
(paren
id|m3_t
op_star
id|chip
comma
id|m3_dma_t
op_star
id|s
comma
id|snd_pcm_substream_t
op_star
id|subs
)paren
(brace
r_int
id|i
suffix:semicolon
multiline_comment|/*&n;&t; * some per client initializers&n;&t; */
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|s-&gt;inst.data
op_plus
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|12
comma
id|s-&gt;inst.data
op_plus
l_int|40
op_plus
l_int|8
)paren
suffix:semicolon
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|s-&gt;inst.data
op_plus
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|19
comma
id|s-&gt;inst.code
op_plus
id|MINISRC_COEF_LOC
)paren
suffix:semicolon
multiline_comment|/* enable or disable low pass filter? */
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|s-&gt;inst.data
op_plus
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|22
comma
id|subs-&gt;runtime-&gt;rate
OG
l_int|45000
ques
c_cond
l_int|0xff
suffix:colon
l_int|0
)paren
suffix:semicolon
multiline_comment|/* tell it which way dma is going? */
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|s-&gt;inst.data
op_plus
id|CDATA_DMA_CONTROL
comma
id|DMACONTROL_AUTOREPEAT
op_plus
id|DMAC_PAGE3_SELECTOR
op_plus
id|DMAC_BLOCKF_SELECTOR
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * set an armload of static initializers&n;&t; */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
(paren
r_sizeof
(paren
id|pv
)paren
op_div
r_sizeof
(paren
id|pv
(braket
l_int|0
)braket
)paren
)paren
suffix:semicolon
id|i
op_increment
)paren
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|s-&gt;inst.data
op_plus
id|pv
(braket
id|i
)braket
dot
id|addr
comma
id|pv
(braket
id|i
)braket
dot
id|val
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; *    Native record driver &n; */
DECL|struct|rec_vals
r_static
r_struct
id|rec_vals
(brace
DECL|member|addr
DECL|member|val
id|u16
id|addr
comma
id|val
suffix:semicolon
DECL|variable|rv
)brace
id|rv
(braket
)braket
op_assign
(brace
(brace
id|CDATA_LEFT_VOLUME
comma
id|ARB_VOLUME
)brace
comma
(brace
id|CDATA_RIGHT_VOLUME
comma
id|ARB_VOLUME
)brace
comma
(brace
id|SRC3_DIRECTION_OFFSET
comma
l_int|1
)brace
comma
multiline_comment|/* +1, +2 are stereo/16 bit */
(brace
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|3
comma
l_int|0x0000
)brace
comma
multiline_comment|/* fraction? */
(brace
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|4
comma
l_int|0
)brace
comma
multiline_comment|/* first l */
(brace
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|5
comma
l_int|0
)brace
comma
multiline_comment|/* first r */
(brace
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|6
comma
l_int|0
)brace
comma
multiline_comment|/* second l */
(brace
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|7
comma
l_int|0
)brace
comma
multiline_comment|/* second r */
(brace
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|8
comma
l_int|0
)brace
comma
multiline_comment|/* delta l */
(brace
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|9
comma
l_int|0
)brace
comma
multiline_comment|/* delta r */
(brace
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|10
comma
l_int|0x8000
)brace
comma
multiline_comment|/* round */
(brace
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|11
comma
l_int|0xFF00
)brace
comma
multiline_comment|/* higher bute mark */
(brace
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|13
comma
l_int|0
)brace
comma
multiline_comment|/* temp0 */
(brace
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|14
comma
l_int|0
)brace
comma
multiline_comment|/* c fraction */
(brace
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|15
comma
l_int|0
)brace
comma
multiline_comment|/* counter */
(brace
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|16
comma
l_int|50
)brace
comma
multiline_comment|/* numin */
(brace
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|17
comma
l_int|8
)brace
comma
multiline_comment|/* numout */
(brace
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|18
comma
l_int|0
)brace
comma
multiline_comment|/* numstage */
(brace
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|19
comma
l_int|0
)brace
comma
multiline_comment|/* coef */
(brace
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|20
comma
l_int|0
)brace
comma
multiline_comment|/* filtertap */
(brace
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|21
comma
l_int|0
)brace
comma
multiline_comment|/* booster */
(brace
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|22
comma
l_int|0xff
)brace
multiline_comment|/* skip lpf */
)brace
suffix:semicolon
r_static
r_void
DECL|function|snd_m3_capture_setup
id|snd_m3_capture_setup
c_func
(paren
id|m3_t
op_star
id|chip
comma
id|m3_dma_t
op_star
id|s
comma
id|snd_pcm_substream_t
op_star
id|subs
)paren
(brace
r_int
id|i
suffix:semicolon
multiline_comment|/*&n;&t; * some per client initializers&n;&t; */
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|s-&gt;inst.data
op_plus
id|SRC3_DIRECTION_OFFSET
op_plus
l_int|12
comma
id|s-&gt;inst.data
op_plus
l_int|40
op_plus
l_int|8
)paren
suffix:semicolon
multiline_comment|/* tell it which way dma is going? */
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|s-&gt;inst.data
op_plus
id|CDATA_DMA_CONTROL
comma
id|DMACONTROL_DIRECTION
op_plus
id|DMACONTROL_AUTOREPEAT
op_plus
id|DMAC_PAGE3_SELECTOR
op_plus
id|DMAC_BLOCKF_SELECTOR
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * set an armload of static initializers&n;&t; */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
(paren
r_sizeof
(paren
id|rv
)paren
op_div
r_sizeof
(paren
id|rv
(braket
l_int|0
)braket
)paren
)paren
suffix:semicolon
id|i
op_increment
)paren
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|s-&gt;inst.data
op_plus
id|rv
(braket
id|i
)braket
dot
id|addr
comma
id|rv
(braket
id|i
)braket
dot
id|val
)paren
suffix:semicolon
)brace
DECL|function|snd_m3_pcm_hw_params
r_static
r_int
id|snd_m3_pcm_hw_params
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_hw_params_t
op_star
id|hw_params
)paren
(brace
id|m3_dma_t
op_star
id|s
op_assign
(paren
id|m3_dma_t
op_star
)paren
id|substream-&gt;runtime-&gt;private_data
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_pcm_lib_malloc_pages
c_func
(paren
id|substream
comma
id|params_buffer_bytes
c_func
(paren
id|hw_params
)paren
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
multiline_comment|/* set buffer address */
id|s-&gt;buffer_addr
op_assign
id|substream-&gt;runtime-&gt;dma_addr
suffix:semicolon
r_if
c_cond
(paren
id|s-&gt;buffer_addr
op_amp
l_int|0x3
)paren
(brace
id|snd_printk
c_func
(paren
l_string|&quot;oh my, not aligned&bslash;n&quot;
)paren
suffix:semicolon
id|s-&gt;buffer_addr
op_assign
id|s-&gt;buffer_addr
op_amp
op_complement
l_int|0x3
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_m3_pcm_hw_free
r_static
r_int
id|snd_m3_pcm_hw_free
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|m3_dma_t
op_star
id|s
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;runtime-&gt;private_data
op_eq
l_int|NULL
)paren
r_return
l_int|0
suffix:semicolon
id|s
op_assign
(paren
id|m3_dma_t
op_star
)paren
id|substream-&gt;runtime-&gt;private_data
suffix:semicolon
id|snd_pcm_lib_free_pages
c_func
(paren
id|substream
)paren
suffix:semicolon
id|s-&gt;buffer_addr
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|snd_m3_pcm_prepare
id|snd_m3_pcm_prepare
c_func
(paren
id|snd_pcm_substream_t
op_star
id|subs
)paren
(brace
id|m3_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|subs
)paren
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|subs-&gt;runtime
suffix:semicolon
id|m3_dma_t
op_star
id|s
op_assign
(paren
id|m3_dma_t
op_star
)paren
id|runtime-&gt;private_data
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|snd_assert
c_func
(paren
id|s
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;format
op_ne
id|SNDRV_PCM_FORMAT_U8
op_logical_and
id|runtime-&gt;format
op_ne
id|SNDRV_PCM_FORMAT_S16_LE
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;rate
OG
l_int|48000
op_logical_or
id|runtime-&gt;rate
OL
l_int|8000
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
id|snd_m3_pcm_setup1
c_func
(paren
id|chip
comma
id|s
comma
id|subs
)paren
suffix:semicolon
r_if
c_cond
(paren
id|subs-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_PLAYBACK
)paren
id|snd_m3_playback_setup
c_func
(paren
id|chip
comma
id|s
comma
id|subs
)paren
suffix:semicolon
r_else
id|snd_m3_capture_setup
c_func
(paren
id|chip
comma
id|s
comma
id|subs
)paren
suffix:semicolon
id|snd_m3_pcm_setup2
c_func
(paren
id|chip
comma
id|s
comma
id|runtime
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * get current pointer&n; */
r_static
r_int
r_int
DECL|function|snd_m3_get_pointer
id|snd_m3_get_pointer
c_func
(paren
id|m3_t
op_star
id|chip
comma
id|m3_dma_t
op_star
id|s
comma
id|snd_pcm_substream_t
op_star
id|subs
)paren
(brace
id|u16
id|hi
op_assign
l_int|0
comma
id|lo
op_assign
l_int|0
suffix:semicolon
r_int
id|retry
op_assign
l_int|10
suffix:semicolon
id|u32
id|addr
suffix:semicolon
multiline_comment|/*&n;&t; * try and get a valid answer&n;&t; */
r_while
c_loop
(paren
id|retry
op_decrement
)paren
(brace
id|hi
op_assign
id|snd_m3_assp_read
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|s-&gt;inst.data
op_plus
id|CDATA_HOST_SRC_CURRENTH
)paren
suffix:semicolon
id|lo
op_assign
id|snd_m3_assp_read
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|s-&gt;inst.data
op_plus
id|CDATA_HOST_SRC_CURRENTL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hi
op_eq
id|snd_m3_assp_read
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|s-&gt;inst.data
op_plus
id|CDATA_HOST_SRC_CURRENTH
)paren
)paren
r_break
suffix:semicolon
)brace
id|addr
op_assign
id|lo
op_or
(paren
(paren
id|u32
)paren
id|hi
op_lshift
l_int|16
)paren
suffix:semicolon
r_return
(paren
r_int
r_int
)paren
(paren
id|addr
op_minus
id|s-&gt;buffer_addr
)paren
suffix:semicolon
)brace
r_static
id|snd_pcm_uframes_t
DECL|function|snd_m3_pcm_pointer
id|snd_m3_pcm_pointer
c_func
(paren
id|snd_pcm_substream_t
op_star
id|subs
)paren
(brace
id|m3_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|subs
)paren
suffix:semicolon
id|m3_dma_t
op_star
id|s
op_assign
(paren
id|m3_dma_t
op_star
)paren
id|subs-&gt;runtime-&gt;private_data
suffix:semicolon
id|snd_assert
c_func
(paren
id|s
op_ne
l_int|NULL
comma
r_return
l_int|0
)paren
suffix:semicolon
r_return
id|bytes_to_frames
c_func
(paren
id|subs-&gt;runtime
comma
id|snd_m3_get_pointer
c_func
(paren
id|chip
comma
id|s
comma
id|subs
)paren
)paren
suffix:semicolon
)brace
multiline_comment|/* update pointer */
multiline_comment|/* spinlock held! */
DECL|function|snd_m3_update_ptr
r_static
r_void
id|snd_m3_update_ptr
c_func
(paren
id|m3_t
op_star
id|chip
comma
id|m3_dma_t
op_star
id|s
)paren
(brace
id|snd_pcm_substream_t
op_star
id|subs
op_assign
id|s-&gt;substream
suffix:semicolon
r_int
r_int
id|hwptr
suffix:semicolon
r_int
id|diff
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|s-&gt;running
)paren
r_return
suffix:semicolon
id|hwptr
op_assign
id|snd_m3_get_pointer
c_func
(paren
id|chip
comma
id|s
comma
id|subs
)paren
op_mod
id|s-&gt;dma_size
suffix:semicolon
id|diff
op_assign
(paren
id|s-&gt;dma_size
op_plus
id|hwptr
op_minus
id|s-&gt;hwptr
)paren
op_mod
id|s-&gt;dma_size
suffix:semicolon
id|s-&gt;hwptr
op_assign
id|hwptr
suffix:semicolon
id|s-&gt;count
op_add_assign
id|diff
suffix:semicolon
r_if
c_cond
(paren
id|s-&gt;count
op_ge
(paren
r_int
)paren
id|s-&gt;period_size
)paren
(brace
id|s-&gt;count
op_mod_assign
id|s-&gt;period_size
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
id|snd_pcm_period_elapsed
c_func
(paren
id|subs
)paren
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|snd_m3_interrupt
id|snd_m3_interrupt
c_func
(paren
r_int
id|irq
comma
r_void
op_star
id|dev_id
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|m3_t
op_star
id|chip
op_assign
id|snd_magic_cast
c_func
(paren
id|m3_t
comma
id|dev_id
comma
)paren
suffix:semicolon
id|u8
id|status
suffix:semicolon
r_int
id|i
suffix:semicolon
id|status
op_assign
id|inb
c_func
(paren
id|chip-&gt;iobase
op_plus
l_int|0x1A
)paren
suffix:semicolon
r_if
c_cond
(paren
id|status
op_eq
l_int|0xff
)paren
r_return
suffix:semicolon
multiline_comment|/* presumably acking the ints? */
id|outw
c_func
(paren
id|status
comma
id|chip-&gt;iobase
op_plus
l_int|0x1A
)paren
suffix:semicolon
multiline_comment|/*if (in_suspend)&n;&t;&t;return;*/
multiline_comment|/*&n;&t; * ack an assp int if its running&n;&t; * and has an int pending&n;&t; */
r_if
c_cond
(paren
id|status
op_amp
id|ASSP_INT_PENDING
)paren
(brace
id|u8
id|ctl
op_assign
id|inb
c_func
(paren
id|chip-&gt;iobase
op_plus
id|ASSP_CONTROL_B
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|ctl
op_amp
id|STOP_ASSP_CLOCK
)paren
)paren
(brace
id|ctl
op_assign
id|inb
c_func
(paren
id|chip-&gt;iobase
op_plus
id|ASSP_HOST_INT_STATUS
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ctl
op_amp
id|DSP2HOST_REQ_TIMER
)paren
(brace
id|outb
c_func
(paren
id|DSP2HOST_REQ_TIMER
comma
id|chip-&gt;iobase
op_plus
id|ASSP_HOST_INT_STATUS
)paren
suffix:semicolon
multiline_comment|/* update adc/dac info if it was a timer int */
id|spin_lock
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|chip-&gt;num_substreams
suffix:semicolon
id|i
op_increment
)paren
(brace
id|m3_dma_t
op_star
id|s
op_assign
op_amp
id|chip-&gt;substreams
(braket
id|i
)braket
suffix:semicolon
r_if
c_cond
(paren
id|s-&gt;running
)paren
id|snd_m3_update_ptr
c_func
(paren
id|chip
comma
id|s
)paren
suffix:semicolon
)brace
id|spin_unlock
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
)brace
)brace
)brace
multiline_comment|/* XXX is this needed? */
r_if
c_cond
(paren
id|status
op_amp
l_int|0x40
)paren
id|outb
c_func
(paren
l_int|0x40
comma
id|chip-&gt;iobase
op_plus
l_int|0x1A
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; */
DECL|variable|snd_m3_playback
r_static
id|snd_pcm_hardware_t
id|snd_m3_playback
op_assign
(brace
id|info
suffix:colon
(paren
id|SNDRV_PCM_INFO_MMAP
op_or
id|SNDRV_PCM_INFO_INTERLEAVED
op_or
id|SNDRV_PCM_INFO_MMAP_VALID
op_or
id|SNDRV_PCM_INFO_BLOCK_TRANSFER
op_or
multiline_comment|/*SNDRV_PCM_INFO_PAUSE |*/
id|SNDRV_PCM_INFO_RESUME
)paren
comma
id|formats
suffix:colon
id|SNDRV_PCM_FMTBIT_U8
op_or
id|SNDRV_PCM_FMTBIT_S16_LE
comma
id|rates
suffix:colon
id|SNDRV_PCM_RATE_CONTINUOUS
op_or
id|SNDRV_PCM_RATE_8000_48000
comma
id|rate_min
suffix:colon
l_int|8000
comma
id|rate_max
suffix:colon
l_int|48000
comma
id|channels_min
suffix:colon
l_int|1
comma
id|channels_max
suffix:colon
l_int|2
comma
id|buffer_bytes_max
suffix:colon
(paren
l_int|512
op_star
l_int|1024
)paren
comma
id|period_bytes_min
suffix:colon
l_int|64
comma
id|period_bytes_max
suffix:colon
(paren
l_int|512
op_star
l_int|1024
)paren
comma
id|periods_min
suffix:colon
l_int|1
comma
id|periods_max
suffix:colon
l_int|1024
comma
)brace
suffix:semicolon
DECL|variable|snd_m3_capture
r_static
id|snd_pcm_hardware_t
id|snd_m3_capture
op_assign
(brace
id|info
suffix:colon
(paren
id|SNDRV_PCM_INFO_MMAP
op_or
id|SNDRV_PCM_INFO_INTERLEAVED
op_or
id|SNDRV_PCM_INFO_MMAP_VALID
op_or
id|SNDRV_PCM_INFO_BLOCK_TRANSFER
op_or
multiline_comment|/*SNDRV_PCM_INFO_PAUSE |*/
id|SNDRV_PCM_INFO_RESUME
)paren
comma
id|formats
suffix:colon
id|SNDRV_PCM_FMTBIT_U8
op_or
id|SNDRV_PCM_FMTBIT_S16_LE
comma
id|rates
suffix:colon
id|SNDRV_PCM_RATE_CONTINUOUS
op_or
id|SNDRV_PCM_RATE_8000_48000
comma
id|rate_min
suffix:colon
l_int|8000
comma
id|rate_max
suffix:colon
l_int|48000
comma
id|channels_min
suffix:colon
l_int|1
comma
id|channels_max
suffix:colon
l_int|2
comma
id|buffer_bytes_max
suffix:colon
(paren
l_int|512
op_star
l_int|1024
)paren
comma
id|period_bytes_min
suffix:colon
l_int|64
comma
id|period_bytes_max
suffix:colon
(paren
l_int|512
op_star
l_int|1024
)paren
comma
id|periods_min
suffix:colon
l_int|1
comma
id|periods_max
suffix:colon
l_int|1024
comma
)brace
suffix:semicolon
multiline_comment|/*&n; */
r_static
r_int
DECL|function|snd_m3_substream_open
id|snd_m3_substream_open
c_func
(paren
id|m3_t
op_star
id|chip
comma
id|snd_pcm_substream_t
op_star
id|subs
)paren
(brace
r_int
id|i
suffix:semicolon
id|m3_dma_t
op_star
id|s
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|chip-&gt;num_substreams
suffix:semicolon
id|i
op_increment
)paren
(brace
id|s
op_assign
op_amp
id|chip-&gt;substreams
(braket
id|i
)braket
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|s-&gt;opened
)paren
r_goto
id|__found
suffix:semicolon
)brace
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|__found
suffix:colon
id|s-&gt;opened
op_assign
l_int|1
suffix:semicolon
id|s-&gt;running
op_assign
l_int|0
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
id|subs-&gt;runtime-&gt;private_data
op_assign
id|s
suffix:semicolon
id|s-&gt;substream
op_assign
id|subs
suffix:semicolon
multiline_comment|/* set list owners */
r_if
c_cond
(paren
id|subs-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_PLAYBACK
)paren
(brace
id|s-&gt;index_list
(braket
l_int|0
)braket
op_assign
op_amp
id|chip-&gt;mixer_list
suffix:semicolon
)brace
r_else
id|s-&gt;index_list
(braket
l_int|0
)braket
op_assign
op_amp
id|chip-&gt;adc1_list
suffix:semicolon
id|s-&gt;index_list
(braket
l_int|1
)braket
op_assign
op_amp
id|chip-&gt;msrc_list
suffix:semicolon
id|s-&gt;index_list
(braket
l_int|2
)braket
op_assign
op_amp
id|chip-&gt;dma_list
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_void
DECL|function|snd_m3_substream_close
id|snd_m3_substream_close
c_func
(paren
id|m3_t
op_star
id|chip
comma
id|snd_pcm_substream_t
op_star
id|subs
)paren
(brace
id|m3_dma_t
op_star
id|s
op_assign
(paren
id|m3_dma_t
op_star
)paren
id|subs-&gt;runtime-&gt;private_data
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_if
c_cond
(paren
id|s
op_eq
l_int|NULL
)paren
r_return
suffix:semicolon
multiline_comment|/* not opened properly */
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|s-&gt;substream
op_logical_and
id|s-&gt;running
)paren
id|snd_m3_pcm_stop
c_func
(paren
id|chip
comma
id|s
comma
id|s-&gt;substream
)paren
suffix:semicolon
multiline_comment|/* does this happen? */
r_if
c_cond
(paren
id|s-&gt;in_lists
)paren
(brace
id|snd_m3_remove_list
c_func
(paren
id|chip
comma
id|s-&gt;index_list
(braket
l_int|0
)braket
comma
id|s-&gt;index
(braket
l_int|0
)braket
)paren
suffix:semicolon
id|snd_m3_remove_list
c_func
(paren
id|chip
comma
id|s-&gt;index_list
(braket
l_int|1
)braket
comma
id|s-&gt;index
(braket
l_int|1
)braket
)paren
suffix:semicolon
id|snd_m3_remove_list
c_func
(paren
id|chip
comma
id|s-&gt;index_list
(braket
l_int|2
)braket
comma
id|s-&gt;index
(braket
l_int|2
)braket
)paren
suffix:semicolon
id|s-&gt;in_lists
op_assign
l_int|0
suffix:semicolon
)brace
id|s-&gt;running
op_assign
l_int|0
suffix:semicolon
id|s-&gt;opened
op_assign
l_int|0
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|snd_m3_playback_open
id|snd_m3_playback_open
c_func
(paren
id|snd_pcm_substream_t
op_star
id|subs
)paren
(brace
id|m3_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|subs
)paren
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|subs-&gt;runtime
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_m3_substream_open
c_func
(paren
id|chip
comma
id|subs
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|runtime-&gt;hw
op_assign
id|snd_m3_playback
suffix:semicolon
id|snd_pcm_set_sync
c_func
(paren
id|subs
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|snd_m3_playback_close
id|snd_m3_playback_close
c_func
(paren
id|snd_pcm_substream_t
op_star
id|subs
)paren
(brace
id|m3_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|subs
)paren
suffix:semicolon
id|snd_m3_substream_close
c_func
(paren
id|chip
comma
id|subs
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|snd_m3_capture_open
id|snd_m3_capture_open
c_func
(paren
id|snd_pcm_substream_t
op_star
id|subs
)paren
(brace
id|m3_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|subs
)paren
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|subs-&gt;runtime
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_m3_substream_open
c_func
(paren
id|chip
comma
id|subs
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|runtime-&gt;hw
op_assign
id|snd_m3_capture
suffix:semicolon
id|snd_pcm_set_sync
c_func
(paren
id|subs
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|snd_m3_capture_close
id|snd_m3_capture_close
c_func
(paren
id|snd_pcm_substream_t
op_star
id|subs
)paren
(brace
id|m3_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|subs
)paren
suffix:semicolon
id|snd_m3_substream_close
c_func
(paren
id|chip
comma
id|subs
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * create pcm instance&n; */
DECL|variable|snd_m3_playback_ops
r_static
id|snd_pcm_ops_t
id|snd_m3_playback_ops
op_assign
(brace
id|open
suffix:colon
id|snd_m3_playback_open
comma
id|close
suffix:colon
id|snd_m3_playback_close
comma
id|ioctl
suffix:colon
id|snd_pcm_lib_ioctl
comma
id|hw_params
suffix:colon
id|snd_m3_pcm_hw_params
comma
id|hw_free
suffix:colon
id|snd_m3_pcm_hw_free
comma
id|prepare
suffix:colon
id|snd_m3_pcm_prepare
comma
id|trigger
suffix:colon
id|snd_m3_pcm_trigger
comma
id|pointer
suffix:colon
id|snd_m3_pcm_pointer
comma
)brace
suffix:semicolon
DECL|variable|snd_m3_capture_ops
r_static
id|snd_pcm_ops_t
id|snd_m3_capture_ops
op_assign
(brace
id|open
suffix:colon
id|snd_m3_capture_open
comma
id|close
suffix:colon
id|snd_m3_capture_close
comma
id|ioctl
suffix:colon
id|snd_pcm_lib_ioctl
comma
id|hw_params
suffix:colon
id|snd_m3_pcm_hw_params
comma
id|hw_free
suffix:colon
id|snd_m3_pcm_hw_free
comma
id|prepare
suffix:colon
id|snd_m3_pcm_prepare
comma
id|trigger
suffix:colon
id|snd_m3_pcm_trigger
comma
id|pointer
suffix:colon
id|snd_m3_pcm_pointer
comma
)brace
suffix:semicolon
r_static
r_int
id|__devinit
DECL|function|snd_m3_pcm
id|snd_m3_pcm
c_func
(paren
id|m3_t
op_star
id|chip
comma
r_int
id|device
)paren
(brace
id|snd_pcm_t
op_star
id|pcm
suffix:semicolon
r_int
id|err
suffix:semicolon
id|err
op_assign
id|snd_pcm_new
c_func
(paren
id|chip-&gt;card
comma
id|chip-&gt;card-&gt;driver
comma
id|device
comma
id|MAX_PLAYBACKS
comma
id|MAX_CAPTURES
comma
op_amp
id|pcm
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|snd_pcm_set_ops
c_func
(paren
id|pcm
comma
id|SNDRV_PCM_STREAM_PLAYBACK
comma
op_amp
id|snd_m3_playback_ops
)paren
suffix:semicolon
id|snd_pcm_set_ops
c_func
(paren
id|pcm
comma
id|SNDRV_PCM_STREAM_CAPTURE
comma
op_amp
id|snd_m3_capture_ops
)paren
suffix:semicolon
id|pcm-&gt;private_data
op_assign
id|chip
suffix:semicolon
id|pcm-&gt;info_flags
op_assign
l_int|0
suffix:semicolon
id|strcpy
c_func
(paren
id|pcm-&gt;name
comma
id|chip-&gt;card-&gt;driver
)paren
suffix:semicolon
id|chip-&gt;pcm
op_assign
id|pcm
suffix:semicolon
id|snd_pcm_lib_preallocate_pci_pages_for_all
c_func
(paren
id|chip-&gt;pci
comma
id|pcm
comma
l_int|64
op_star
l_int|1024
comma
l_int|64
op_star
l_int|1024
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * ac97 interface&n; */
multiline_comment|/*&n; * Wait for the ac97 serial bus to be free.&n; * return nonzero if the bus is still busy.&n; */
DECL|function|snd_m3_ac97_wait
r_static
r_int
id|snd_m3_ac97_wait
c_func
(paren
id|m3_t
op_star
id|chip
)paren
(brace
r_int
id|i
op_assign
l_int|10000
suffix:semicolon
r_do
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|snd_m3_inb
c_func
(paren
id|chip
comma
l_int|0x30
)paren
op_amp
l_int|1
)paren
)paren
r_return
l_int|0
suffix:semicolon
)brace
r_while
c_loop
(paren
id|i
op_decrement
OG
l_int|0
)paren
suffix:semicolon
id|snd_printk
c_func
(paren
l_string|&quot;ac97 serial bus busy&bslash;n&quot;
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
r_static
r_int
r_int
DECL|function|snd_m3_ac97_read
id|snd_m3_ac97_read
c_func
(paren
id|ac97_t
op_star
id|ac97
comma
r_int
r_int
id|reg
)paren
(brace
id|m3_t
op_star
id|chip
op_assign
id|snd_magic_cast
c_func
(paren
id|m3_t
comma
id|ac97-&gt;private_data
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
r_int
r_int
id|ret
op_assign
l_int|0
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|snd_m3_ac97_wait
c_func
(paren
id|chip
)paren
)paren
r_goto
id|__error
suffix:semicolon
id|snd_m3_outb
c_func
(paren
id|chip
comma
l_int|0x80
op_or
(paren
id|reg
op_amp
l_int|0x7f
)paren
comma
l_int|0x30
)paren
suffix:semicolon
r_if
c_cond
(paren
id|snd_m3_ac97_wait
c_func
(paren
id|chip
)paren
)paren
r_goto
id|__error
suffix:semicolon
id|ret
op_assign
id|snd_m3_inw
c_func
(paren
id|chip
comma
l_int|0x32
)paren
suffix:semicolon
id|__error
suffix:colon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
r_static
r_void
DECL|function|snd_m3_ac97_write
id|snd_m3_ac97_write
c_func
(paren
id|ac97_t
op_star
id|ac97
comma
r_int
r_int
id|reg
comma
r_int
r_int
id|val
)paren
(brace
id|m3_t
op_star
id|chip
op_assign
id|snd_magic_cast
c_func
(paren
id|m3_t
comma
id|ac97-&gt;private_data
comma
r_return
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|snd_m3_ac97_wait
c_func
(paren
id|chip
)paren
)paren
r_goto
id|__error
suffix:semicolon
id|snd_m3_outw
c_func
(paren
id|chip
comma
id|val
comma
l_int|0x32
)paren
suffix:semicolon
id|snd_m3_outb
c_func
(paren
id|chip
comma
id|reg
op_amp
l_int|0x7f
comma
l_int|0x30
)paren
suffix:semicolon
id|__error
suffix:colon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|snd_m3_remote_codec_config
r_static
r_void
id|snd_m3_remote_codec_config
c_func
(paren
r_int
id|io
comma
r_int
id|isremote
)paren
(brace
id|isremote
op_assign
id|isremote
ques
c_cond
l_int|1
suffix:colon
l_int|0
suffix:semicolon
id|outw
c_func
(paren
(paren
id|inw
c_func
(paren
id|io
op_plus
id|RING_BUS_CTRL_B
)paren
op_amp
op_complement
id|SECOND_CODEC_ID_MASK
)paren
op_or
id|isremote
comma
id|io
op_plus
id|RING_BUS_CTRL_B
)paren
suffix:semicolon
id|outw
c_func
(paren
(paren
id|inw
c_func
(paren
id|io
op_plus
id|SDO_OUT_DEST_CTRL
)paren
op_amp
op_complement
id|COMMAND_ADDR_OUT
)paren
op_or
id|isremote
comma
id|io
op_plus
id|SDO_OUT_DEST_CTRL
)paren
suffix:semicolon
id|outw
c_func
(paren
(paren
id|inw
c_func
(paren
id|io
op_plus
id|SDO_IN_DEST_CTRL
)paren
op_amp
op_complement
id|STATUS_ADDR_IN
)paren
op_or
id|isremote
comma
id|io
op_plus
id|SDO_IN_DEST_CTRL
)paren
suffix:semicolon
)brace
multiline_comment|/* &n; * hack, returns non zero on err &n; */
DECL|function|snd_m3_try_read_vendor
r_static
r_int
id|snd_m3_try_read_vendor
c_func
(paren
id|m3_t
op_star
id|chip
)paren
(brace
id|u16
id|ret
suffix:semicolon
r_if
c_cond
(paren
id|snd_m3_ac97_wait
c_func
(paren
id|chip
)paren
)paren
r_return
l_int|1
suffix:semicolon
id|snd_m3_outb
c_func
(paren
id|chip
comma
l_int|0x80
op_or
(paren
id|AC97_VENDOR_ID1
op_amp
l_int|0x7f
)paren
comma
l_int|0x30
)paren
suffix:semicolon
r_if
c_cond
(paren
id|snd_m3_ac97_wait
c_func
(paren
id|chip
)paren
)paren
r_return
l_int|1
suffix:semicolon
id|ret
op_assign
id|snd_m3_inw
c_func
(paren
id|chip
comma
l_int|0x32
)paren
suffix:semicolon
r_return
(paren
id|ret
op_eq
l_int|0
)paren
op_logical_or
(paren
id|ret
op_eq
l_int|0xffff
)paren
suffix:semicolon
)brace
DECL|function|snd_m3_ac97_reset
r_static
r_void
id|snd_m3_ac97_reset
c_func
(paren
id|m3_t
op_star
id|chip
comma
r_int
id|busywait
)paren
(brace
id|u16
id|dir
suffix:semicolon
r_int
id|delay1
op_assign
l_int|0
comma
id|delay2
op_assign
l_int|0
comma
id|i
suffix:semicolon
r_int
id|io
op_assign
id|chip-&gt;iobase
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;allegro_flag
)paren
(brace
multiline_comment|/*&n;&t;&t; * the onboard codec on the allegro seems &n;&t;&t; * to want to wait a very long time before&n;&t;&t; * coming back to life &n;&t;&t; */
id|delay1
op_assign
l_int|50
suffix:semicolon
id|delay2
op_assign
l_int|800
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* maestro3 */
id|delay1
op_assign
l_int|20
suffix:semicolon
id|delay2
op_assign
l_int|500
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|5
suffix:semicolon
id|i
op_increment
)paren
(brace
id|dir
op_assign
id|inw
c_func
(paren
id|io
op_plus
id|GPIO_DIRECTION
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;subsystem_vendor
op_eq
l_int|0x1028
op_logical_and
id|chip-&gt;subsystem_device
op_eq
l_int|0x00b0
)paren
multiline_comment|/* Dell Inspiron 4000 */
suffix:semicolon
multiline_comment|/* seems conflicting with IrDA */
r_else
id|dir
op_or_assign
l_int|0x10
suffix:semicolon
multiline_comment|/* assuming pci bus master? */
id|snd_m3_remote_codec_config
c_func
(paren
id|io
comma
l_int|0
)paren
suffix:semicolon
id|outw
c_func
(paren
id|IO_SRAM_ENABLE
comma
id|io
op_plus
id|RING_BUS_CTRL_A
)paren
suffix:semicolon
id|udelay
c_func
(paren
l_int|20
)paren
suffix:semicolon
id|outw
c_func
(paren
id|dir
op_amp
op_complement
id|GPO_PRIMARY_AC97
comma
id|io
op_plus
id|GPIO_DIRECTION
)paren
suffix:semicolon
id|outw
c_func
(paren
op_complement
id|GPO_PRIMARY_AC97
comma
id|io
op_plus
id|GPIO_MASK
)paren
suffix:semicolon
id|outw
c_func
(paren
l_int|0
comma
id|io
op_plus
id|GPIO_DATA
)paren
suffix:semicolon
id|outw
c_func
(paren
id|dir
op_or
id|GPO_PRIMARY_AC97
comma
id|io
op_plus
id|GPIO_DIRECTION
)paren
suffix:semicolon
r_if
c_cond
(paren
id|busywait
)paren
(brace
id|mdelay
c_func
(paren
id|delay1
)paren
suffix:semicolon
)brace
r_else
(brace
id|set_current_state
c_func
(paren
id|TASK_UNINTERRUPTIBLE
)paren
suffix:semicolon
id|schedule_timeout
c_func
(paren
(paren
id|delay1
op_star
id|HZ
)paren
op_div
l_int|1000
)paren
suffix:semicolon
)brace
id|outw
c_func
(paren
id|GPO_PRIMARY_AC97
comma
id|io
op_plus
id|GPIO_DATA
)paren
suffix:semicolon
id|udelay
c_func
(paren
l_int|5
)paren
suffix:semicolon
multiline_comment|/* ok, bring back the ac-link */
id|outw
c_func
(paren
id|IO_SRAM_ENABLE
op_or
id|SERIAL_AC_LINK_ENABLE
comma
id|io
op_plus
id|RING_BUS_CTRL_A
)paren
suffix:semicolon
id|outw
c_func
(paren
op_complement
l_int|0
comma
id|io
op_plus
id|GPIO_MASK
)paren
suffix:semicolon
r_if
c_cond
(paren
id|busywait
)paren
(brace
id|mdelay
c_func
(paren
id|delay2
)paren
suffix:semicolon
)brace
r_else
(brace
id|set_current_state
c_func
(paren
id|TASK_UNINTERRUPTIBLE
)paren
suffix:semicolon
id|schedule_timeout
c_func
(paren
(paren
id|delay2
op_star
id|HZ
)paren
op_div
l_int|1000
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|snd_m3_try_read_vendor
c_func
(paren
id|chip
)paren
)paren
r_break
suffix:semicolon
id|delay1
op_add_assign
l_int|10
suffix:semicolon
id|delay2
op_add_assign
l_int|100
suffix:semicolon
id|snd_printd
c_func
(paren
l_string|&quot;maestro3: retrying codec reset with delays of %d and %d ms&bslash;n&quot;
comma
id|delay1
comma
id|delay2
)paren
suffix:semicolon
)brace
macro_line|#if 0
multiline_comment|/* more gung-ho reset that doesn&squot;t&n;&t; * seem to work anywhere :)&n;&t; */
id|tmp
op_assign
id|inw
c_func
(paren
id|io
op_plus
id|RING_BUS_CTRL_A
)paren
suffix:semicolon
id|outw
c_func
(paren
id|RAC_SDFS_ENABLE
op_or
id|LAC_SDFS_ENABLE
comma
id|io
op_plus
id|RING_BUS_CTRL_A
)paren
suffix:semicolon
id|mdelay
c_func
(paren
l_int|20
)paren
suffix:semicolon
id|outw
c_func
(paren
id|tmp
comma
id|io
op_plus
id|RING_BUS_CTRL_A
)paren
suffix:semicolon
id|mdelay
c_func
(paren
l_int|50
)paren
suffix:semicolon
macro_line|#endif
)brace
DECL|function|snd_m3_mixer
r_static
r_int
id|snd_m3_mixer
c_func
(paren
id|m3_t
op_star
id|chip
)paren
(brace
id|ac97_t
id|ac97
suffix:semicolon
r_int
id|err
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|ac97
comma
l_int|0
comma
r_sizeof
(paren
id|ac97
)paren
)paren
suffix:semicolon
id|ac97.write
op_assign
id|snd_m3_ac97_write
suffix:semicolon
id|ac97.read
op_assign
id|snd_m3_ac97_read
suffix:semicolon
id|ac97.private_data
op_assign
id|chip
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ac97_mixer
c_func
(paren
id|chip-&gt;card
comma
op_amp
id|ac97
comma
op_amp
id|chip-&gt;ac97
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
multiline_comment|/* seems ac97 PCM needs initialization.. hack hack.. */
id|snd_ac97_write
c_func
(paren
id|chip-&gt;ac97
comma
id|AC97_PCM
comma
l_int|0x8000
op_or
(paren
l_int|15
op_lshift
l_int|8
)paren
op_or
l_int|15
)paren
suffix:semicolon
id|set_current_state
c_func
(paren
id|TASK_UNINTERRUPTIBLE
)paren
suffix:semicolon
id|schedule_timeout
c_func
(paren
id|HZ
op_div
l_int|10
)paren
suffix:semicolon
id|snd_ac97_write
c_func
(paren
id|chip-&gt;ac97
comma
id|AC97_PCM
comma
l_int|0
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * DSP Code images&n; */
DECL|variable|assp_kernel_image
r_static
id|u16
id|assp_kernel_image
(braket
)braket
op_assign
(brace
l_int|0x7980
comma
l_int|0x0030
comma
l_int|0x7980
comma
l_int|0x03B4
comma
l_int|0x7980
comma
l_int|0x03B4
comma
l_int|0x7980
comma
l_int|0x00FB
comma
l_int|0x7980
comma
l_int|0x00DD
comma
l_int|0x7980
comma
l_int|0x03B4
comma
l_int|0x7980
comma
l_int|0x0332
comma
l_int|0x7980
comma
l_int|0x0287
comma
l_int|0x7980
comma
l_int|0x03B4
comma
l_int|0x7980
comma
l_int|0x03B4
comma
l_int|0x7980
comma
l_int|0x03B4
comma
l_int|0x7980
comma
l_int|0x03B4
comma
l_int|0x7980
comma
l_int|0x031A
comma
l_int|0x7980
comma
l_int|0x03B4
comma
l_int|0x7980
comma
l_int|0x022F
comma
l_int|0x7980
comma
l_int|0x03B4
comma
l_int|0x7980
comma
l_int|0x03B4
comma
l_int|0x7980
comma
l_int|0x03B4
comma
l_int|0x7980
comma
l_int|0x03B4
comma
l_int|0x7980
comma
l_int|0x03B4
comma
l_int|0x7980
comma
l_int|0x0063
comma
l_int|0x7980
comma
l_int|0x006B
comma
l_int|0x7980
comma
l_int|0x03B4
comma
l_int|0x7980
comma
l_int|0x03B4
comma
l_int|0xBF80
comma
l_int|0x2C7C
comma
l_int|0x8806
comma
l_int|0x8804
comma
l_int|0xBE40
comma
l_int|0xBC20
comma
l_int|0xAE09
comma
l_int|0x1000
comma
l_int|0xAE0A
comma
l_int|0x0001
comma
l_int|0x6938
comma
l_int|0xEB08
comma
l_int|0x0053
comma
l_int|0x695A
comma
l_int|0xEB08
comma
l_int|0x00D6
comma
l_int|0x0009
comma
l_int|0x8B88
comma
l_int|0x6980
comma
l_int|0xE388
comma
l_int|0x0036
comma
l_int|0xBE30
comma
l_int|0xBC20
comma
l_int|0x6909
comma
l_int|0xB801
comma
l_int|0x9009
comma
l_int|0xBE41
comma
l_int|0xBE41
comma
l_int|0x6928
comma
l_int|0xEB88
comma
l_int|0x0078
comma
l_int|0xBE41
comma
l_int|0xBE40
comma
l_int|0x7980
comma
l_int|0x0038
comma
l_int|0xBE41
comma
l_int|0xBE41
comma
l_int|0x903A
comma
l_int|0x6938
comma
l_int|0xE308
comma
l_int|0x0056
comma
l_int|0x903A
comma
l_int|0xBE41
comma
l_int|0xBE40
comma
l_int|0xEF00
comma
l_int|0x903A
comma
l_int|0x6939
comma
l_int|0xE308
comma
l_int|0x005E
comma
l_int|0x903A
comma
l_int|0xEF00
comma
l_int|0x690B
comma
l_int|0x660C
comma
l_int|0xEF8C
comma
l_int|0x690A
comma
l_int|0x660C
comma
l_int|0x620B
comma
l_int|0x6609
comma
l_int|0xEF00
comma
l_int|0x6910
comma
l_int|0x660F
comma
l_int|0xEF04
comma
l_int|0xE388
comma
l_int|0x0075
comma
l_int|0x690E
comma
l_int|0x660F
comma
l_int|0x6210
comma
l_int|0x660D
comma
l_int|0xEF00
comma
l_int|0x690E
comma
l_int|0x660D
comma
l_int|0xEF00
comma
l_int|0xAE70
comma
l_int|0x0001
comma
l_int|0xBC20
comma
l_int|0xAE27
comma
l_int|0x0001
comma
l_int|0x6939
comma
l_int|0xEB08
comma
l_int|0x005D
comma
l_int|0x6926
comma
l_int|0xB801
comma
l_int|0x9026
comma
l_int|0x0026
comma
l_int|0x8B88
comma
l_int|0x6980
comma
l_int|0xE388
comma
l_int|0x00CB
comma
l_int|0x9028
comma
l_int|0x0D28
comma
l_int|0x4211
comma
l_int|0xE100
comma
l_int|0x007A
comma
l_int|0x4711
comma
l_int|0xE100
comma
l_int|0x00A0
comma
l_int|0x7A80
comma
l_int|0x0063
comma
l_int|0xB811
comma
l_int|0x660A
comma
l_int|0x6209
comma
l_int|0xE304
comma
l_int|0x007A
comma
l_int|0x0C0B
comma
l_int|0x4005
comma
l_int|0x100A
comma
l_int|0xBA01
comma
l_int|0x9012
comma
l_int|0x0C12
comma
l_int|0x4002
comma
l_int|0x7980
comma
l_int|0x00AF
comma
l_int|0x7A80
comma
l_int|0x006B
comma
l_int|0xBE02
comma
l_int|0x620E
comma
l_int|0x660D
comma
l_int|0xBA10
comma
l_int|0xE344
comma
l_int|0x007A
comma
l_int|0x0C10
comma
l_int|0x4005
comma
l_int|0x100E
comma
l_int|0xBA01
comma
l_int|0x9012
comma
l_int|0x0C12
comma
l_int|0x4002
comma
l_int|0x1003
comma
l_int|0xBA02
comma
l_int|0x9012
comma
l_int|0x0C12
comma
l_int|0x4000
comma
l_int|0x1003
comma
l_int|0xE388
comma
l_int|0x00BA
comma
l_int|0x1004
comma
l_int|0x7980
comma
l_int|0x00BC
comma
l_int|0x1004
comma
l_int|0xBA01
comma
l_int|0x9012
comma
l_int|0x0C12
comma
l_int|0x4001
comma
l_int|0x0C05
comma
l_int|0x4003
comma
l_int|0x0C06
comma
l_int|0x4004
comma
l_int|0x1011
comma
l_int|0xBFB0
comma
l_int|0x01FF
comma
l_int|0x9012
comma
l_int|0x0C12
comma
l_int|0x4006
comma
l_int|0xBC20
comma
l_int|0xEF00
comma
l_int|0xAE26
comma
l_int|0x1028
comma
l_int|0x6970
comma
l_int|0xBFD0
comma
l_int|0x0001
comma
l_int|0x9070
comma
l_int|0xE388
comma
l_int|0x007A
comma
l_int|0xAE28
comma
l_int|0x0000
comma
l_int|0xEF00
comma
l_int|0xAE70
comma
l_int|0x0300
comma
l_int|0x0C70
comma
l_int|0xB00C
comma
l_int|0xAE5A
comma
l_int|0x0000
comma
l_int|0xEF00
comma
l_int|0x7A80
comma
l_int|0x038A
comma
l_int|0x697F
comma
l_int|0xB801
comma
l_int|0x907F
comma
l_int|0x0056
comma
l_int|0x8B88
comma
l_int|0x0CA0
comma
l_int|0xB008
comma
l_int|0xAF71
comma
l_int|0xB000
comma
l_int|0x4E71
comma
l_int|0xE200
comma
l_int|0x00F3
comma
l_int|0xAE56
comma
l_int|0x1057
comma
l_int|0x0056
comma
l_int|0x0CA0
comma
l_int|0xB008
comma
l_int|0x8056
comma
l_int|0x7980
comma
l_int|0x03A1
comma
l_int|0x0810
comma
l_int|0xBFA0
comma
l_int|0x1059
comma
l_int|0xE304
comma
l_int|0x03A1
comma
l_int|0x8056
comma
l_int|0x7980
comma
l_int|0x03A1
comma
l_int|0x7A80
comma
l_int|0x038A
comma
l_int|0xBF01
comma
l_int|0xBE43
comma
l_int|0xBE59
comma
l_int|0x907C
comma
l_int|0x6937
comma
l_int|0xE388
comma
l_int|0x010D
comma
l_int|0xBA01
comma
l_int|0xE308
comma
l_int|0x010C
comma
l_int|0xAE71
comma
l_int|0x0004
comma
l_int|0x0C71
comma
l_int|0x5000
comma
l_int|0x6936
comma
l_int|0x9037
comma
l_int|0xBF0A
comma
l_int|0x109E
comma
l_int|0x8B8A
comma
l_int|0xAF80
comma
l_int|0x8014
comma
l_int|0x4C80
comma
l_int|0xBF0A
comma
l_int|0x0560
comma
l_int|0xF500
comma
l_int|0xBF0A
comma
l_int|0x0520
comma
l_int|0xB900
comma
l_int|0xBB17
comma
l_int|0x90A0
comma
l_int|0x6917
comma
l_int|0xE388
comma
l_int|0x0148
comma
l_int|0x0D17
comma
l_int|0xE100
comma
l_int|0x0127
comma
l_int|0xBF0C
comma
l_int|0x0578
comma
l_int|0xBF0D
comma
l_int|0x057C
comma
l_int|0x7980
comma
l_int|0x012B
comma
l_int|0xBF0C
comma
l_int|0x0538
comma
l_int|0xBF0D
comma
l_int|0x053C
comma
l_int|0x6900
comma
l_int|0xE308
comma
l_int|0x0135
comma
l_int|0x8B8C
comma
l_int|0xBE59
comma
l_int|0xBB07
comma
l_int|0x90A0
comma
l_int|0xBC20
comma
l_int|0x7980
comma
l_int|0x0157
comma
l_int|0x030C
comma
l_int|0x8B8B
comma
l_int|0xB903
comma
l_int|0x8809
comma
l_int|0xBEC6
comma
l_int|0x013E
comma
l_int|0x69AC
comma
l_int|0x90AB
comma
l_int|0x69AD
comma
l_int|0x90AB
comma
l_int|0x0813
comma
l_int|0x660A
comma
l_int|0xE344
comma
l_int|0x0144
comma
l_int|0x0309
comma
l_int|0x830C
comma
l_int|0xBC20
comma
l_int|0x7980
comma
l_int|0x0157
comma
l_int|0x6955
comma
l_int|0xE388
comma
l_int|0x0157
comma
l_int|0x7C38
comma
l_int|0xBF0B
comma
l_int|0x0578
comma
l_int|0xF500
comma
l_int|0xBF0B
comma
l_int|0x0538
comma
l_int|0xB907
comma
l_int|0x8809
comma
l_int|0xBEC6
comma
l_int|0x0156
comma
l_int|0x10AB
comma
l_int|0x90AA
comma
l_int|0x6974
comma
l_int|0xE388
comma
l_int|0x0163
comma
l_int|0xAE72
comma
l_int|0x0540
comma
l_int|0xF500
comma
l_int|0xAE72
comma
l_int|0x0500
comma
l_int|0xAE61
comma
l_int|0x103B
comma
l_int|0x7A80
comma
l_int|0x02F6
comma
l_int|0x6978
comma
l_int|0xE388
comma
l_int|0x0182
comma
l_int|0x8B8C
comma
l_int|0xBF0C
comma
l_int|0x0560
comma
l_int|0xE500
comma
l_int|0x7C40
comma
l_int|0x0814
comma
l_int|0xBA20
comma
l_int|0x8812
comma
l_int|0x733D
comma
l_int|0x7A80
comma
l_int|0x0380
comma
l_int|0x733E
comma
l_int|0x7A80
comma
l_int|0x0380
comma
l_int|0x8B8C
comma
l_int|0xBF0C
comma
l_int|0x056C
comma
l_int|0xE500
comma
l_int|0x7C40
comma
l_int|0x0814
comma
l_int|0xBA2C
comma
l_int|0x8812
comma
l_int|0x733F
comma
l_int|0x7A80
comma
l_int|0x0380
comma
l_int|0x7340
comma
l_int|0x7A80
comma
l_int|0x0380
comma
l_int|0x6975
comma
l_int|0xE388
comma
l_int|0x018E
comma
l_int|0xAE72
comma
l_int|0x0548
comma
l_int|0xF500
comma
l_int|0xAE72
comma
l_int|0x0508
comma
l_int|0xAE61
comma
l_int|0x1041
comma
l_int|0x7A80
comma
l_int|0x02F6
comma
l_int|0x6979
comma
l_int|0xE388
comma
l_int|0x01AD
comma
l_int|0x8B8C
comma
l_int|0xBF0C
comma
l_int|0x0560
comma
l_int|0xE500
comma
l_int|0x7C40
comma
l_int|0x0814
comma
l_int|0xBA18
comma
l_int|0x8812
comma
l_int|0x7343
comma
l_int|0x7A80
comma
l_int|0x0380
comma
l_int|0x7344
comma
l_int|0x7A80
comma
l_int|0x0380
comma
l_int|0x8B8C
comma
l_int|0xBF0C
comma
l_int|0x056C
comma
l_int|0xE500
comma
l_int|0x7C40
comma
l_int|0x0814
comma
l_int|0xBA24
comma
l_int|0x8812
comma
l_int|0x7345
comma
l_int|0x7A80
comma
l_int|0x0380
comma
l_int|0x7346
comma
l_int|0x7A80
comma
l_int|0x0380
comma
l_int|0x6976
comma
l_int|0xE388
comma
l_int|0x01B9
comma
l_int|0xAE72
comma
l_int|0x0558
comma
l_int|0xF500
comma
l_int|0xAE72
comma
l_int|0x0518
comma
l_int|0xAE61
comma
l_int|0x1047
comma
l_int|0x7A80
comma
l_int|0x02F6
comma
l_int|0x697A
comma
l_int|0xE388
comma
l_int|0x01D8
comma
l_int|0x8B8C
comma
l_int|0xBF0C
comma
l_int|0x0560
comma
l_int|0xE500
comma
l_int|0x7C40
comma
l_int|0x0814
comma
l_int|0xBA08
comma
l_int|0x8812
comma
l_int|0x7349
comma
l_int|0x7A80
comma
l_int|0x0380
comma
l_int|0x734A
comma
l_int|0x7A80
comma
l_int|0x0380
comma
l_int|0x8B8C
comma
l_int|0xBF0C
comma
l_int|0x056C
comma
l_int|0xE500
comma
l_int|0x7C40
comma
l_int|0x0814
comma
l_int|0xBA14
comma
l_int|0x8812
comma
l_int|0x734B
comma
l_int|0x7A80
comma
l_int|0x0380
comma
l_int|0x734C
comma
l_int|0x7A80
comma
l_int|0x0380
comma
l_int|0xBC21
comma
l_int|0xAE1C
comma
l_int|0x1090
comma
l_int|0x8B8A
comma
l_int|0xBF0A
comma
l_int|0x0560
comma
l_int|0xE500
comma
l_int|0x7C40
comma
l_int|0x0812
comma
l_int|0xB804
comma
l_int|0x8813
comma
l_int|0x8B8D
comma
l_int|0xBF0D
comma
l_int|0x056C
comma
l_int|0xE500
comma
l_int|0x7C40
comma
l_int|0x0815
comma
l_int|0xB804
comma
l_int|0x8811
comma
l_int|0x7A80
comma
l_int|0x034A
comma
l_int|0x8B8A
comma
l_int|0xBF0A
comma
l_int|0x0560
comma
l_int|0xE500
comma
l_int|0x7C40
comma
l_int|0x731F
comma
l_int|0xB903
comma
l_int|0x8809
comma
l_int|0xBEC6
comma
l_int|0x01F9
comma
l_int|0x548A
comma
l_int|0xBE03
comma
l_int|0x98A0
comma
l_int|0x7320
comma
l_int|0xB903
comma
l_int|0x8809
comma
l_int|0xBEC6
comma
l_int|0x0201
comma
l_int|0x548A
comma
l_int|0xBE03
comma
l_int|0x98A0
comma
l_int|0x1F20
comma
l_int|0x2F1F
comma
l_int|0x9826
comma
l_int|0xBC20
comma
l_int|0x6935
comma
l_int|0xE388
comma
l_int|0x03A1
comma
l_int|0x6933
comma
l_int|0xB801
comma
l_int|0x9033
comma
l_int|0xBFA0
comma
l_int|0x02EE
comma
l_int|0xE308
comma
l_int|0x03A1
comma
l_int|0x9033
comma
l_int|0xBF00
comma
l_int|0x6951
comma
l_int|0xE388
comma
l_int|0x021F
comma
l_int|0x7334
comma
l_int|0xBE80
comma
l_int|0x5760
comma
l_int|0xBE03
comma
l_int|0x9F7E
comma
l_int|0xBE59
comma
l_int|0x9034
comma
l_int|0x697E
comma
l_int|0x0D51
comma
l_int|0x9013
comma
l_int|0xBC20
comma
l_int|0x695C
comma
l_int|0xE388
comma
l_int|0x03A1
comma
l_int|0x735E
comma
l_int|0xBE80
comma
l_int|0x5760
comma
l_int|0xBE03
comma
l_int|0x9F7E
comma
l_int|0xBE59
comma
l_int|0x905E
comma
l_int|0x697E
comma
l_int|0x0D5C
comma
l_int|0x9013
comma
l_int|0x7980
comma
l_int|0x03A1
comma
l_int|0x7A80
comma
l_int|0x038A
comma
l_int|0xBF01
comma
l_int|0xBE43
comma
l_int|0x6977
comma
l_int|0xE388
comma
l_int|0x024E
comma
l_int|0xAE61
comma
l_int|0x104D
comma
l_int|0x0061
comma
l_int|0x8B88
comma
l_int|0x6980
comma
l_int|0xE388
comma
l_int|0x024E
comma
l_int|0x9071
comma
l_int|0x0D71
comma
l_int|0x000B
comma
l_int|0xAFA0
comma
l_int|0x8010
comma
l_int|0xAFA0
comma
l_int|0x8010
comma
l_int|0x0810
comma
l_int|0x660A
comma
l_int|0xE308
comma
l_int|0x0249
comma
l_int|0x0009
comma
l_int|0x0810
comma
l_int|0x660C
comma
l_int|0xE388
comma
l_int|0x024E
comma
l_int|0x800B
comma
l_int|0xBC20
comma
l_int|0x697B
comma
l_int|0xE388
comma
l_int|0x03A1
comma
l_int|0xBF0A
comma
l_int|0x109E
comma
l_int|0x8B8A
comma
l_int|0xAF80
comma
l_int|0x8014
comma
l_int|0x4C80
comma
l_int|0xE100
comma
l_int|0x0266
comma
l_int|0x697C
comma
l_int|0xBF90
comma
l_int|0x0560
comma
l_int|0x9072
comma
l_int|0x0372
comma
l_int|0x697C
comma
l_int|0xBF90
comma
l_int|0x0564
comma
l_int|0x9073
comma
l_int|0x0473
comma
l_int|0x7980
comma
l_int|0x0270
comma
l_int|0x697C
comma
l_int|0xBF90
comma
l_int|0x0520
comma
l_int|0x9072
comma
l_int|0x0372
comma
l_int|0x697C
comma
l_int|0xBF90
comma
l_int|0x0524
comma
l_int|0x9073
comma
l_int|0x0473
comma
l_int|0x697C
comma
l_int|0xB801
comma
l_int|0x907C
comma
l_int|0xBF0A
comma
l_int|0x10FD
comma
l_int|0x8B8A
comma
l_int|0xAF80
comma
l_int|0x8010
comma
l_int|0x734F
comma
l_int|0x548A
comma
l_int|0xBE03
comma
l_int|0x9880
comma
l_int|0xBC21
comma
l_int|0x7326
comma
l_int|0x548B
comma
l_int|0xBE03
comma
l_int|0x618B
comma
l_int|0x988C
comma
l_int|0xBE03
comma
l_int|0x6180
comma
l_int|0x9880
comma
l_int|0x7980
comma
l_int|0x03A1
comma
l_int|0x7A80
comma
l_int|0x038A
comma
l_int|0x0D28
comma
l_int|0x4711
comma
l_int|0xE100
comma
l_int|0x02BE
comma
l_int|0xAF12
comma
l_int|0x4006
comma
l_int|0x6912
comma
l_int|0xBFB0
comma
l_int|0x0C00
comma
l_int|0xE388
comma
l_int|0x02B6
comma
l_int|0xBFA0
comma
l_int|0x0800
comma
l_int|0xE388
comma
l_int|0x02B2
comma
l_int|0x6912
comma
l_int|0xBFB0
comma
l_int|0x0C00
comma
l_int|0xBFA0
comma
l_int|0x0400
comma
l_int|0xE388
comma
l_int|0x02A3
comma
l_int|0x6909
comma
l_int|0x900B
comma
l_int|0x7980
comma
l_int|0x02A5
comma
l_int|0xAF0B
comma
l_int|0x4005
comma
l_int|0x6901
comma
l_int|0x9005
comma
l_int|0x6902
comma
l_int|0x9006
comma
l_int|0x4311
comma
l_int|0xE100
comma
l_int|0x02ED
comma
l_int|0x6911
comma
l_int|0xBFC0
comma
l_int|0x2000
comma
l_int|0x9011
comma
l_int|0x7980
comma
l_int|0x02ED
comma
l_int|0x6909
comma
l_int|0x900B
comma
l_int|0x7980
comma
l_int|0x02B8
comma
l_int|0xAF0B
comma
l_int|0x4005
comma
l_int|0xAF05
comma
l_int|0x4003
comma
l_int|0xAF06
comma
l_int|0x4004
comma
l_int|0x7980
comma
l_int|0x02ED
comma
l_int|0xAF12
comma
l_int|0x4006
comma
l_int|0x6912
comma
l_int|0xBFB0
comma
l_int|0x0C00
comma
l_int|0xE388
comma
l_int|0x02E7
comma
l_int|0xBFA0
comma
l_int|0x0800
comma
l_int|0xE388
comma
l_int|0x02E3
comma
l_int|0x6912
comma
l_int|0xBFB0
comma
l_int|0x0C00
comma
l_int|0xBFA0
comma
l_int|0x0400
comma
l_int|0xE388
comma
l_int|0x02D4
comma
l_int|0x690D
comma
l_int|0x9010
comma
l_int|0x7980
comma
l_int|0x02D6
comma
l_int|0xAF10
comma
l_int|0x4005
comma
l_int|0x6901
comma
l_int|0x9005
comma
l_int|0x6902
comma
l_int|0x9006
comma
l_int|0x4311
comma
l_int|0xE100
comma
l_int|0x02ED
comma
l_int|0x6911
comma
l_int|0xBFC0
comma
l_int|0x2000
comma
l_int|0x9011
comma
l_int|0x7980
comma
l_int|0x02ED
comma
l_int|0x690D
comma
l_int|0x9010
comma
l_int|0x7980
comma
l_int|0x02E9
comma
l_int|0xAF10
comma
l_int|0x4005
comma
l_int|0xAF05
comma
l_int|0x4003
comma
l_int|0xAF06
comma
l_int|0x4004
comma
l_int|0xBC20
comma
l_int|0x6970
comma
l_int|0x9071
comma
l_int|0x7A80
comma
l_int|0x0078
comma
l_int|0x6971
comma
l_int|0x9070
comma
l_int|0x7980
comma
l_int|0x03A1
comma
l_int|0xBC20
comma
l_int|0x0361
comma
l_int|0x8B8B
comma
l_int|0x6980
comma
l_int|0xEF88
comma
l_int|0x0272
comma
l_int|0x0372
comma
l_int|0x7804
comma
l_int|0x9071
comma
l_int|0x0D71
comma
l_int|0x8B8A
comma
l_int|0x000B
comma
l_int|0xB903
comma
l_int|0x8809
comma
l_int|0xBEC6
comma
l_int|0x0309
comma
l_int|0x69A8
comma
l_int|0x90AB
comma
l_int|0x69A8
comma
l_int|0x90AA
comma
l_int|0x0810
comma
l_int|0x660A
comma
l_int|0xE344
comma
l_int|0x030F
comma
l_int|0x0009
comma
l_int|0x0810
comma
l_int|0x660C
comma
l_int|0xE388
comma
l_int|0x0314
comma
l_int|0x800B
comma
l_int|0xBC20
comma
l_int|0x6961
comma
l_int|0xB801
comma
l_int|0x9061
comma
l_int|0x7980
comma
l_int|0x02F7
comma
l_int|0x7A80
comma
l_int|0x038A
comma
l_int|0x5D35
comma
l_int|0x0001
comma
l_int|0x6934
comma
l_int|0xB801
comma
l_int|0x9034
comma
l_int|0xBF0A
comma
l_int|0x109E
comma
l_int|0x8B8A
comma
l_int|0xAF80
comma
l_int|0x8014
comma
l_int|0x4880
comma
l_int|0xAE72
comma
l_int|0x0550
comma
l_int|0xF500
comma
l_int|0xAE72
comma
l_int|0x0510
comma
l_int|0xAE61
comma
l_int|0x1051
comma
l_int|0x7A80
comma
l_int|0x02F6
comma
l_int|0x7980
comma
l_int|0x03A1
comma
l_int|0x7A80
comma
l_int|0x038A
comma
l_int|0x5D35
comma
l_int|0x0002
comma
l_int|0x695E
comma
l_int|0xB801
comma
l_int|0x905E
comma
l_int|0xBF0A
comma
l_int|0x109E
comma
l_int|0x8B8A
comma
l_int|0xAF80
comma
l_int|0x8014
comma
l_int|0x4780
comma
l_int|0xAE72
comma
l_int|0x0558
comma
l_int|0xF500
comma
l_int|0xAE72
comma
l_int|0x0518
comma
l_int|0xAE61
comma
l_int|0x105C
comma
l_int|0x7A80
comma
l_int|0x02F6
comma
l_int|0x7980
comma
l_int|0x03A1
comma
l_int|0x001C
comma
l_int|0x8B88
comma
l_int|0x6980
comma
l_int|0xEF88
comma
l_int|0x901D
comma
l_int|0x0D1D
comma
l_int|0x100F
comma
l_int|0x6610
comma
l_int|0xE38C
comma
l_int|0x0358
comma
l_int|0x690E
comma
l_int|0x6610
comma
l_int|0x620F
comma
l_int|0x660D
comma
l_int|0xBA0F
comma
l_int|0xE301
comma
l_int|0x037A
comma
l_int|0x0410
comma
l_int|0x8B8A
comma
l_int|0xB903
comma
l_int|0x8809
comma
l_int|0xBEC6
comma
l_int|0x036C
comma
l_int|0x6A8C
comma
l_int|0x61AA
comma
l_int|0x98AB
comma
l_int|0x6A8C
comma
l_int|0x61AB
comma
l_int|0x98AD
comma
l_int|0x6A8C
comma
l_int|0x61AD
comma
l_int|0x98A9
comma
l_int|0x6A8C
comma
l_int|0x61A9
comma
l_int|0x98AA
comma
l_int|0x7C04
comma
l_int|0x8B8B
comma
l_int|0x7C04
comma
l_int|0x8B8D
comma
l_int|0x7C04
comma
l_int|0x8B89
comma
l_int|0x7C04
comma
l_int|0x0814
comma
l_int|0x660E
comma
l_int|0xE308
comma
l_int|0x0379
comma
l_int|0x040D
comma
l_int|0x8410
comma
l_int|0xBC21
comma
l_int|0x691C
comma
l_int|0xB801
comma
l_int|0x901C
comma
l_int|0x7980
comma
l_int|0x034A
comma
l_int|0xB903
comma
l_int|0x8809
comma
l_int|0x8B8A
comma
l_int|0xBEC6
comma
l_int|0x0388
comma
l_int|0x54AC
comma
l_int|0xBE03
comma
l_int|0x618C
comma
l_int|0x98AA
comma
l_int|0xEF00
comma
l_int|0xBC20
comma
l_int|0xBE46
comma
l_int|0x0809
comma
l_int|0x906B
comma
l_int|0x080A
comma
l_int|0x906C
comma
l_int|0x080B
comma
l_int|0x906D
comma
l_int|0x081A
comma
l_int|0x9062
comma
l_int|0x081B
comma
l_int|0x9063
comma
l_int|0x081E
comma
l_int|0x9064
comma
l_int|0xBE59
comma
l_int|0x881E
comma
l_int|0x8065
comma
l_int|0x8166
comma
l_int|0x8267
comma
l_int|0x8368
comma
l_int|0x8469
comma
l_int|0x856A
comma
l_int|0xEF00
comma
l_int|0xBC20
comma
l_int|0x696B
comma
l_int|0x8809
comma
l_int|0x696C
comma
l_int|0x880A
comma
l_int|0x696D
comma
l_int|0x880B
comma
l_int|0x6962
comma
l_int|0x881A
comma
l_int|0x6963
comma
l_int|0x881B
comma
l_int|0x6964
comma
l_int|0x881E
comma
l_int|0x0065
comma
l_int|0x0166
comma
l_int|0x0267
comma
l_int|0x0368
comma
l_int|0x0469
comma
l_int|0x056A
comma
l_int|0xBE3A
comma
)brace
suffix:semicolon
multiline_comment|/*&n; * Mini sample rate converter code image&n; * that is to be loaded at 0x400 on the DSP.&n; */
DECL|variable|assp_minisrc_image
r_static
id|u16
id|assp_minisrc_image
(braket
)braket
op_assign
(brace
l_int|0xBF80
comma
l_int|0x101E
comma
l_int|0x906E
comma
l_int|0x006E
comma
l_int|0x8B88
comma
l_int|0x6980
comma
l_int|0xEF88
comma
l_int|0x906F
comma
l_int|0x0D6F
comma
l_int|0x6900
comma
l_int|0xEB08
comma
l_int|0x0412
comma
l_int|0xBC20
comma
l_int|0x696E
comma
l_int|0xB801
comma
l_int|0x906E
comma
l_int|0x7980
comma
l_int|0x0403
comma
l_int|0xB90E
comma
l_int|0x8807
comma
l_int|0xBE43
comma
l_int|0xBF01
comma
l_int|0xBE47
comma
l_int|0xBE41
comma
l_int|0x7A80
comma
l_int|0x002A
comma
l_int|0xBE40
comma
l_int|0x3029
comma
l_int|0xEFCC
comma
l_int|0xBE41
comma
l_int|0x7A80
comma
l_int|0x0028
comma
l_int|0xBE40
comma
l_int|0x3028
comma
l_int|0xEFCC
comma
l_int|0x6907
comma
l_int|0xE308
comma
l_int|0x042A
comma
l_int|0x6909
comma
l_int|0x902C
comma
l_int|0x7980
comma
l_int|0x042C
comma
l_int|0x690D
comma
l_int|0x902C
comma
l_int|0x1009
comma
l_int|0x881A
comma
l_int|0x100A
comma
l_int|0xBA01
comma
l_int|0x881B
comma
l_int|0x100D
comma
l_int|0x881C
comma
l_int|0x100E
comma
l_int|0xBA01
comma
l_int|0x881D
comma
l_int|0xBF80
comma
l_int|0x00ED
comma
l_int|0x881E
comma
l_int|0x050C
comma
l_int|0x0124
comma
l_int|0xB904
comma
l_int|0x9027
comma
l_int|0x6918
comma
l_int|0xE308
comma
l_int|0x04B3
comma
l_int|0x902D
comma
l_int|0x6913
comma
l_int|0xBFA0
comma
l_int|0x7598
comma
l_int|0xF704
comma
l_int|0xAE2D
comma
l_int|0x00FF
comma
l_int|0x8B8D
comma
l_int|0x6919
comma
l_int|0xE308
comma
l_int|0x0463
comma
l_int|0x691A
comma
l_int|0xE308
comma
l_int|0x0456
comma
l_int|0xB907
comma
l_int|0x8809
comma
l_int|0xBEC6
comma
l_int|0x0453
comma
l_int|0x10A9
comma
l_int|0x90AD
comma
l_int|0x7980
comma
l_int|0x047C
comma
l_int|0xB903
comma
l_int|0x8809
comma
l_int|0xBEC6
comma
l_int|0x0460
comma
l_int|0x1889
comma
l_int|0x6C22
comma
l_int|0x90AD
comma
l_int|0x10A9
comma
l_int|0x6E23
comma
l_int|0x6C22
comma
l_int|0x90AD
comma
l_int|0x7980
comma
l_int|0x047C
comma
l_int|0x101A
comma
l_int|0xE308
comma
l_int|0x046F
comma
l_int|0xB903
comma
l_int|0x8809
comma
l_int|0xBEC6
comma
l_int|0x046C
comma
l_int|0x10A9
comma
l_int|0x90A0
comma
l_int|0x90AD
comma
l_int|0x7980
comma
l_int|0x047C
comma
l_int|0xB901
comma
l_int|0x8809
comma
l_int|0xBEC6
comma
l_int|0x047B
comma
l_int|0x1889
comma
l_int|0x6C22
comma
l_int|0x90A0
comma
l_int|0x90AD
comma
l_int|0x10A9
comma
l_int|0x6E23
comma
l_int|0x6C22
comma
l_int|0x90A0
comma
l_int|0x90AD
comma
l_int|0x692D
comma
l_int|0xE308
comma
l_int|0x049C
comma
l_int|0x0124
comma
l_int|0xB703
comma
l_int|0xB902
comma
l_int|0x8818
comma
l_int|0x8B89
comma
l_int|0x022C
comma
l_int|0x108A
comma
l_int|0x7C04
comma
l_int|0x90A0
comma
l_int|0x692B
comma
l_int|0x881F
comma
l_int|0x7E80
comma
l_int|0x055B
comma
l_int|0x692A
comma
l_int|0x8809
comma
l_int|0x8B89
comma
l_int|0x99A0
comma
l_int|0x108A
comma
l_int|0x90A0
comma
l_int|0x692B
comma
l_int|0x881F
comma
l_int|0x7E80
comma
l_int|0x055B
comma
l_int|0x692A
comma
l_int|0x8809
comma
l_int|0x8B89
comma
l_int|0x99AF
comma
l_int|0x7B99
comma
l_int|0x0484
comma
l_int|0x0124
comma
l_int|0x060F
comma
l_int|0x101B
comma
l_int|0x2013
comma
l_int|0x901B
comma
l_int|0xBFA0
comma
l_int|0x7FFF
comma
l_int|0xE344
comma
l_int|0x04AC
comma
l_int|0x901B
comma
l_int|0x8B89
comma
l_int|0x7A80
comma
l_int|0x051A
comma
l_int|0x6927
comma
l_int|0xBA01
comma
l_int|0x9027
comma
l_int|0x7A80
comma
l_int|0x0523
comma
l_int|0x6927
comma
l_int|0xE308
comma
l_int|0x049E
comma
l_int|0x7980
comma
l_int|0x050F
comma
l_int|0x0624
comma
l_int|0x1026
comma
l_int|0x2013
comma
l_int|0x9026
comma
l_int|0xBFA0
comma
l_int|0x7FFF
comma
l_int|0xE304
comma
l_int|0x04C0
comma
l_int|0x8B8D
comma
l_int|0x7A80
comma
l_int|0x051A
comma
l_int|0x7980
comma
l_int|0x04B4
comma
l_int|0x9026
comma
l_int|0x1013
comma
l_int|0x3026
comma
l_int|0x901B
comma
l_int|0x8B8D
comma
l_int|0x7A80
comma
l_int|0x051A
comma
l_int|0x7A80
comma
l_int|0x0523
comma
l_int|0x1027
comma
l_int|0xBA01
comma
l_int|0x9027
comma
l_int|0xE308
comma
l_int|0x04B4
comma
l_int|0x0124
comma
l_int|0x060F
comma
l_int|0x8B89
comma
l_int|0x691A
comma
l_int|0xE308
comma
l_int|0x04EA
comma
l_int|0x6919
comma
l_int|0xE388
comma
l_int|0x04E0
comma
l_int|0xB903
comma
l_int|0x8809
comma
l_int|0xBEC6
comma
l_int|0x04DD
comma
l_int|0x1FA0
comma
l_int|0x2FAE
comma
l_int|0x98A9
comma
l_int|0x7980
comma
l_int|0x050F
comma
l_int|0xB901
comma
l_int|0x8818
comma
l_int|0xB907
comma
l_int|0x8809
comma
l_int|0xBEC6
comma
l_int|0x04E7
comma
l_int|0x10EE
comma
l_int|0x90A9
comma
l_int|0x7980
comma
l_int|0x050F
comma
l_int|0x6919
comma
l_int|0xE308
comma
l_int|0x04FE
comma
l_int|0xB903
comma
l_int|0x8809
comma
l_int|0xBE46
comma
l_int|0xBEC6
comma
l_int|0x04FA
comma
l_int|0x17A0
comma
l_int|0xBE1E
comma
l_int|0x1FAE
comma
l_int|0xBFBF
comma
l_int|0xFF00
comma
l_int|0xBE13
comma
l_int|0xBFDF
comma
l_int|0x8080
comma
l_int|0x99A9
comma
l_int|0xBE47
comma
l_int|0x7980
comma
l_int|0x050F
comma
l_int|0xB901
comma
l_int|0x8809
comma
l_int|0xBEC6
comma
l_int|0x050E
comma
l_int|0x16A0
comma
l_int|0x26A0
comma
l_int|0xBFB7
comma
l_int|0xFF00
comma
l_int|0xBE1E
comma
l_int|0x1EA0
comma
l_int|0x2EAE
comma
l_int|0xBFBF
comma
l_int|0xFF00
comma
l_int|0xBE13
comma
l_int|0xBFDF
comma
l_int|0x8080
comma
l_int|0x99A9
comma
l_int|0x850C
comma
l_int|0x860F
comma
l_int|0x6907
comma
l_int|0xE388
comma
l_int|0x0516
comma
l_int|0x0D07
comma
l_int|0x8510
comma
l_int|0xBE59
comma
l_int|0x881E
comma
l_int|0xBE4A
comma
l_int|0xEF00
comma
l_int|0x101E
comma
l_int|0x901C
comma
l_int|0x101F
comma
l_int|0x901D
comma
l_int|0x10A0
comma
l_int|0x901E
comma
l_int|0x10A0
comma
l_int|0x901F
comma
l_int|0xEF00
comma
l_int|0x101E
comma
l_int|0x301C
comma
l_int|0x9020
comma
l_int|0x731B
comma
l_int|0x5420
comma
l_int|0xBE03
comma
l_int|0x9825
comma
l_int|0x1025
comma
l_int|0x201C
comma
l_int|0x9025
comma
l_int|0x7325
comma
l_int|0x5414
comma
l_int|0xBE03
comma
l_int|0x8B8E
comma
l_int|0x9880
comma
l_int|0x692F
comma
l_int|0xE388
comma
l_int|0x0539
comma
l_int|0xBE59
comma
l_int|0xBB07
comma
l_int|0x6180
comma
l_int|0x9880
comma
l_int|0x8BA0
comma
l_int|0x101F
comma
l_int|0x301D
comma
l_int|0x9021
comma
l_int|0x731B
comma
l_int|0x5421
comma
l_int|0xBE03
comma
l_int|0x982E
comma
l_int|0x102E
comma
l_int|0x201D
comma
l_int|0x902E
comma
l_int|0x732E
comma
l_int|0x5415
comma
l_int|0xBE03
comma
l_int|0x9880
comma
l_int|0x692F
comma
l_int|0xE388
comma
l_int|0x054F
comma
l_int|0xBE59
comma
l_int|0xBB07
comma
l_int|0x6180
comma
l_int|0x9880
comma
l_int|0x8BA0
comma
l_int|0x6918
comma
l_int|0xEF08
comma
l_int|0x7325
comma
l_int|0x5416
comma
l_int|0xBE03
comma
l_int|0x98A0
comma
l_int|0x732E
comma
l_int|0x5417
comma
l_int|0xBE03
comma
l_int|0x98A0
comma
l_int|0xEF00
comma
l_int|0x8BA0
comma
l_int|0xBEC6
comma
l_int|0x056B
comma
l_int|0xBE59
comma
l_int|0xBB04
comma
l_int|0xAA90
comma
l_int|0xBE04
comma
l_int|0xBE1E
comma
l_int|0x99E0
comma
l_int|0x8BE0
comma
l_int|0x69A0
comma
l_int|0x90D0
comma
l_int|0x69A0
comma
l_int|0x90D0
comma
l_int|0x081F
comma
l_int|0xB805
comma
l_int|0x881F
comma
l_int|0x8B90
comma
l_int|0x69A0
comma
l_int|0x90D0
comma
l_int|0x69A0
comma
l_int|0x9090
comma
l_int|0x8BD0
comma
l_int|0x8BD8
comma
l_int|0xBE1F
comma
l_int|0xEF00
comma
l_int|0x0000
comma
l_int|0x0000
comma
l_int|0x0000
comma
l_int|0x0000
comma
l_int|0x0000
comma
l_int|0x0000
comma
l_int|0x0000
comma
l_int|0x0000
comma
l_int|0x0000
comma
l_int|0x0000
comma
l_int|0x0000
comma
l_int|0x0000
comma
l_int|0x0000
comma
l_int|0x0000
comma
l_int|0x0000
comma
l_int|0x0000
comma
l_int|0x0000
comma
l_int|0x0000
comma
l_int|0x0000
comma
l_int|0x0000
comma
)brace
suffix:semicolon
multiline_comment|/*&n; * initialize ASSP&n; */
DECL|macro|MINISRC_LPF_LEN
mdefine_line|#define MINISRC_LPF_LEN 10
DECL|variable|minisrc_lpf
r_static
id|u16
id|minisrc_lpf
(braket
id|MINISRC_LPF_LEN
)braket
op_assign
(brace
l_int|0X0743
comma
l_int|0X1104
comma
l_int|0X0A4C
comma
l_int|0XF88D
comma
l_int|0X242C
comma
l_int|0X1023
comma
l_int|0X1AA9
comma
l_int|0X0B60
comma
l_int|0XEFDD
comma
l_int|0X186F
)brace
suffix:semicolon
DECL|function|snd_m3_assp_init
r_static
r_void
id|snd_m3_assp_init
c_func
(paren
id|m3_t
op_star
id|chip
)paren
(brace
r_int
id|i
suffix:semicolon
multiline_comment|/* zero kernel data */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
(paren
id|REV_B_DATA_MEMORY_UNIT_LENGTH
op_star
id|NUM_UNITS_KERNEL_DATA
)paren
op_div
l_int|2
suffix:semicolon
id|i
op_increment
)paren
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|KDATA_BASE_ADDR
op_plus
id|i
comma
l_int|0
)paren
suffix:semicolon
multiline_comment|/* zero mixer data? */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
(paren
id|REV_B_DATA_MEMORY_UNIT_LENGTH
op_star
id|NUM_UNITS_KERNEL_DATA
)paren
op_div
l_int|2
suffix:semicolon
id|i
op_increment
)paren
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|KDATA_BASE_ADDR2
op_plus
id|i
comma
l_int|0
)paren
suffix:semicolon
multiline_comment|/* init dma pointer */
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|KDATA_CURRENT_DMA
comma
id|KDATA_DMA_XFER0
)paren
suffix:semicolon
multiline_comment|/* write kernel into code memory.. */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
r_sizeof
(paren
id|assp_kernel_image
)paren
op_div
l_int|2
suffix:semicolon
id|i
op_increment
)paren
(brace
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_CODE
comma
id|REV_B_CODE_MEMORY_BEGIN
op_plus
id|i
comma
id|assp_kernel_image
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
multiline_comment|/*&n;&t; * We only have this one client and we know that 0x400&n;&t; * is free in our kernel&squot;s mem map, so lets just&n;&t; * drop it there.  It seems that the minisrc doesn&squot;t&n;&t; * need vectors, so we won&squot;t bother with them..&n;&t; */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
r_sizeof
(paren
id|assp_minisrc_image
)paren
op_div
l_int|2
suffix:semicolon
id|i
op_increment
)paren
(brace
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_CODE
comma
l_int|0x400
op_plus
id|i
comma
id|assp_minisrc_image
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
multiline_comment|/*&n;&t; * write the coefficients for the low pass filter?&n;&t; */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|MINISRC_LPF_LEN
suffix:semicolon
id|i
op_increment
)paren
(brace
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_CODE
comma
l_int|0x400
op_plus
id|MINISRC_COEF_LOC
op_plus
id|i
comma
id|minisrc_lpf
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_CODE
comma
l_int|0x400
op_plus
id|MINISRC_COEF_LOC
op_plus
id|MINISRC_LPF_LEN
comma
l_int|0x8000
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * the minisrc is the only thing on&n;&t; * our task list..&n;&t; */
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|KDATA_TASK0
comma
l_int|0x400
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * init the mixer number..&n;&t; */
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|KDATA_MIXER_TASK_NUMBER
comma
l_int|0
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * EXTREME KERNEL MASTER VOLUME&n;&t; */
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|KDATA_DAC_LEFT_VOLUME
comma
id|ARB_VOLUME
)paren
suffix:semicolon
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|KDATA_DAC_RIGHT_VOLUME
comma
id|ARB_VOLUME
)paren
suffix:semicolon
id|chip-&gt;mixer_list.curlen
op_assign
l_int|0
suffix:semicolon
id|chip-&gt;mixer_list.mem_addr
op_assign
id|KDATA_MIXER_XFER0
suffix:semicolon
id|chip-&gt;mixer_list.max
op_assign
id|MAX_VIRTUAL_MIXER_CHANNELS
suffix:semicolon
id|chip-&gt;adc1_list.curlen
op_assign
l_int|0
suffix:semicolon
id|chip-&gt;adc1_list.mem_addr
op_assign
id|KDATA_ADC1_XFER0
suffix:semicolon
id|chip-&gt;adc1_list.max
op_assign
id|MAX_VIRTUAL_ADC1_CHANNELS
suffix:semicolon
id|chip-&gt;dma_list.curlen
op_assign
l_int|0
suffix:semicolon
id|chip-&gt;dma_list.mem_addr
op_assign
id|KDATA_DMA_XFER0
suffix:semicolon
id|chip-&gt;dma_list.max
op_assign
id|MAX_VIRTUAL_DMA_CHANNELS
suffix:semicolon
id|chip-&gt;msrc_list.curlen
op_assign
l_int|0
suffix:semicolon
id|chip-&gt;msrc_list.mem_addr
op_assign
id|KDATA_INSTANCE0_MINISRC
suffix:semicolon
id|chip-&gt;msrc_list.max
op_assign
id|MAX_INSTANCE_MINISRC
suffix:semicolon
)brace
DECL|function|snd_m3_assp_client_init
r_static
r_int
id|snd_m3_assp_client_init
c_func
(paren
id|m3_t
op_star
id|chip
comma
id|m3_dma_t
op_star
id|s
comma
r_int
id|index
)paren
(brace
r_int
id|data_bytes
op_assign
l_int|2
op_star
(paren
id|MINISRC_TMP_BUFFER_SIZE
op_div
l_int|2
op_plus
id|MINISRC_IN_BUFFER_SIZE
op_div
l_int|2
op_plus
l_int|1
op_plus
id|MINISRC_OUT_BUFFER_SIZE
op_div
l_int|2
op_plus
l_int|1
)paren
suffix:semicolon
r_int
id|address
comma
id|i
suffix:semicolon
multiline_comment|/*&n;&t; * the revb memory map has 0x1100 through 0x1c00&n;&t; * free.  &n;&t; */
multiline_comment|/*&n;&t; * align instance address to 256 bytes so that it&squot;s&n;&t; * shifted list address is aligned.&n;&t; * list address = (mem address &gt;&gt; 1) &gt;&gt; 7;&n;&t; */
id|data_bytes
op_assign
(paren
id|data_bytes
op_plus
l_int|255
)paren
op_amp
op_complement
l_int|255
suffix:semicolon
id|address
op_assign
l_int|0x1100
op_plus
(paren
(paren
id|data_bytes
op_div
l_int|2
)paren
op_star
id|index
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|address
op_plus
(paren
id|data_bytes
op_div
l_int|2
)paren
)paren
op_ge
l_int|0x1c00
)paren
(brace
id|snd_printk
c_func
(paren
l_string|&quot;no memory for %d bytes at ind %d (addr 0x%x)&bslash;n&quot;
comma
id|data_bytes
comma
id|index
comma
id|address
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|s-&gt;number
op_assign
id|index
suffix:semicolon
id|s-&gt;inst.code
op_assign
l_int|0x400
suffix:semicolon
id|s-&gt;inst.data
op_assign
id|address
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
id|data_bytes
op_div
l_int|2
suffix:semicolon
id|i
OG
l_int|0
suffix:semicolon
id|address
op_increment
comma
id|i
op_decrement
)paren
(brace
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|address
comma
l_int|0
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* &n; * this works for the reference board, have to find&n; * out about others&n; *&n; * this needs more magic for 4 speaker, but..&n; */
r_static
r_void
DECL|function|snd_m3_amp_enable
id|snd_m3_amp_enable
c_func
(paren
id|m3_t
op_star
id|chip
comma
r_int
id|enable
)paren
(brace
r_int
id|io
op_assign
id|chip-&gt;iobase
suffix:semicolon
id|u16
id|gpo
comma
id|polarity
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|chip-&gt;external_amp
)paren
r_return
suffix:semicolon
id|polarity
op_assign
id|enable
ques
c_cond
l_int|0
suffix:colon
l_int|1
suffix:semicolon
id|polarity
op_assign
id|polarity
op_lshift
id|chip-&gt;amp_gpio
suffix:semicolon
id|gpo
op_assign
l_int|1
op_lshift
id|chip-&gt;amp_gpio
suffix:semicolon
id|outw
c_func
(paren
op_complement
id|gpo
comma
id|io
op_plus
id|GPIO_MASK
)paren
suffix:semicolon
id|outw
c_func
(paren
id|inw
c_func
(paren
id|io
op_plus
id|GPIO_DIRECTION
)paren
op_or
id|gpo
comma
id|io
op_plus
id|GPIO_DIRECTION
)paren
suffix:semicolon
id|outw
c_func
(paren
(paren
id|GPO_SECONDARY_AC97
op_or
id|GPO_PRIMARY_AC97
op_or
id|polarity
)paren
comma
id|io
op_plus
id|GPIO_DATA
)paren
suffix:semicolon
id|outw
c_func
(paren
l_int|0xffff
comma
id|io
op_plus
id|GPIO_MASK
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|snd_m3_chip_init
id|snd_m3_chip_init
c_func
(paren
id|m3_t
op_star
id|chip
)paren
(brace
r_struct
id|pci_dev
op_star
id|pcidev
op_assign
id|chip-&gt;pci
suffix:semicolon
id|u32
id|n
suffix:semicolon
id|u8
id|t
suffix:semicolon
multiline_comment|/* makes as much sense as &squot;n&squot;, no? */
id|pci_read_config_dword
c_func
(paren
id|pcidev
comma
id|PCI_ALLEGRO_CONFIG
comma
op_amp
id|n
)paren
suffix:semicolon
id|n
op_and_assign
id|REDUCED_DEBOUNCE
suffix:semicolon
id|n
op_or_assign
id|PM_CTRL_ENABLE
op_or
id|CLK_DIV_BY_49
op_or
id|USE_PCI_TIMING
suffix:semicolon
id|pci_write_config_dword
c_func
(paren
id|pcidev
comma
id|PCI_ALLEGRO_CONFIG
comma
id|n
)paren
suffix:semicolon
id|outb
c_func
(paren
id|RESET_ASSP
comma
id|chip-&gt;iobase
op_plus
id|ASSP_CONTROL_B
)paren
suffix:semicolon
id|pci_read_config_dword
c_func
(paren
id|pcidev
comma
id|PCI_ALLEGRO_CONFIG
comma
op_amp
id|n
)paren
suffix:semicolon
id|n
op_and_assign
op_complement
id|INT_CLK_SELECT
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|chip-&gt;allegro_flag
)paren
(brace
id|n
op_and_assign
op_complement
id|INT_CLK_MULT_ENABLE
suffix:semicolon
id|n
op_or_assign
id|INT_CLK_SRC_NOT_PCI
suffix:semicolon
)brace
id|n
op_and_assign
op_complement
(paren
id|CLK_MULT_MODE_SELECT
op_or
id|CLK_MULT_MODE_SELECT_2
)paren
suffix:semicolon
id|pci_write_config_dword
c_func
(paren
id|pcidev
comma
id|PCI_ALLEGRO_CONFIG
comma
id|n
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;allegro_flag
)paren
(brace
id|pci_read_config_dword
c_func
(paren
id|pcidev
comma
id|PCI_USER_CONFIG
comma
op_amp
id|n
)paren
suffix:semicolon
id|n
op_or_assign
id|IN_CLK_12MHZ_SELECT
suffix:semicolon
id|pci_write_config_dword
c_func
(paren
id|pcidev
comma
id|PCI_USER_CONFIG
comma
id|n
)paren
suffix:semicolon
)brace
id|t
op_assign
id|inb
c_func
(paren
id|chip-&gt;iobase
op_plus
id|ASSP_CONTROL_A
)paren
suffix:semicolon
id|t
op_and_assign
op_complement
(paren
id|DSP_CLK_36MHZ_SELECT
op_or
id|ASSP_CLK_49MHZ_SELECT
)paren
suffix:semicolon
id|t
op_or_assign
id|ASSP_CLK_49MHZ_SELECT
suffix:semicolon
id|t
op_or_assign
id|ASSP_0_WS_ENABLE
suffix:semicolon
id|outb
c_func
(paren
id|t
comma
id|chip-&gt;iobase
op_plus
id|ASSP_CONTROL_A
)paren
suffix:semicolon
id|outb
c_func
(paren
id|RUN_ASSP
comma
id|chip-&gt;iobase
op_plus
id|ASSP_CONTROL_B
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_void
DECL|function|snd_m3_enable_ints
id|snd_m3_enable_ints
c_func
(paren
id|m3_t
op_star
id|chip
)paren
(brace
r_int
r_int
id|io
op_assign
id|chip-&gt;iobase
suffix:semicolon
id|outw
c_func
(paren
id|ASSP_INT_ENABLE
comma
id|io
op_plus
id|HOST_INT_CTRL
)paren
suffix:semicolon
id|outb
c_func
(paren
id|inb
c_func
(paren
id|io
op_plus
id|ASSP_CONTROL_C
)paren
op_or
id|ASSP_HOST_INT_ENABLE
comma
id|io
op_plus
id|ASSP_CONTROL_C
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; */
DECL|function|snd_m3_free
r_static
r_int
id|snd_m3_free
c_func
(paren
id|m3_t
op_star
id|chip
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
id|m3_dma_t
op_star
id|s
suffix:semicolon
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;substreams
)paren
(brace
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|chip-&gt;num_substreams
suffix:semicolon
id|i
op_increment
)paren
(brace
id|s
op_assign
op_amp
id|chip-&gt;substreams
(braket
id|i
)braket
suffix:semicolon
multiline_comment|/* check surviving pcms; this should not happen though.. */
r_if
c_cond
(paren
id|s-&gt;substream
op_logical_and
id|s-&gt;running
)paren
id|snd_m3_pcm_stop
c_func
(paren
id|chip
comma
id|s
comma
id|s-&gt;substream
)paren
suffix:semicolon
)brace
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;reg_lock
comma
id|flags
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|chip-&gt;substreams
)paren
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_PM
r_if
c_cond
(paren
id|chip-&gt;suspend_mem
)paren
id|vfree
c_func
(paren
id|chip-&gt;suspend_mem
)paren
suffix:semicolon
macro_line|#endif
id|synchronize_irq
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;iobase_res
)paren
(brace
id|release_resource
c_func
(paren
id|chip-&gt;iobase_res
)paren
suffix:semicolon
id|kfree_nocheck
c_func
(paren
id|chip-&gt;iobase_res
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|chip-&gt;irq
op_ge
l_int|0
)paren
id|free_irq
c_func
(paren
id|chip-&gt;irq
comma
(paren
r_void
op_star
)paren
id|chip
)paren
suffix:semicolon
id|snd_magic_kfree
c_func
(paren
id|chip
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * APM support&n; */
macro_line|#ifdef CONFIG_PM
DECL|function|m3_suspend
r_static
r_void
id|m3_suspend
c_func
(paren
id|m3_t
op_star
id|chip
)paren
(brace
id|snd_card_t
op_star
id|card
op_assign
id|chip-&gt;card
suffix:semicolon
r_int
id|i
comma
id|index
suffix:semicolon
id|snd_power_lock
c_func
(paren
id|card
)paren
suffix:semicolon
r_if
c_cond
(paren
id|card-&gt;power_state
op_eq
id|SNDRV_CTL_POWER_D3hot
)paren
r_goto
id|__skip
suffix:semicolon
id|snd_pcm_suspend_all
c_func
(paren
id|chip-&gt;pcm
)paren
suffix:semicolon
id|mdelay
c_func
(paren
l_int|10
)paren
suffix:semicolon
multiline_comment|/* give the assp a chance to idle.. */
id|snd_m3_assp_halt
c_func
(paren
id|chip
)paren
suffix:semicolon
multiline_comment|/* save dsp image */
id|index
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
id|REV_B_CODE_MEMORY_BEGIN
suffix:semicolon
id|i
op_le
id|REV_B_CODE_MEMORY_END
suffix:semicolon
id|i
op_increment
)paren
id|chip-&gt;suspend_mem
(braket
id|index
op_increment
)braket
op_assign
id|snd_m3_assp_read
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_CODE
comma
id|i
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
id|REV_B_DATA_MEMORY_BEGIN
suffix:semicolon
id|i
op_le
id|REV_B_DATA_MEMORY_END
suffix:semicolon
id|i
op_increment
)paren
id|chip-&gt;suspend_mem
(braket
id|index
op_increment
)braket
op_assign
id|snd_m3_assp_read
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|i
)paren
suffix:semicolon
multiline_comment|/* power down apci registers */
id|snd_m3_outw
c_func
(paren
id|chip
comma
l_int|0xffff
comma
l_int|0x54
)paren
suffix:semicolon
id|snd_m3_outw
c_func
(paren
id|chip
comma
l_int|0xffff
comma
l_int|0x56
)paren
suffix:semicolon
id|snd_power_change_state
c_func
(paren
id|card
comma
id|SNDRV_CTL_POWER_D3hot
)paren
suffix:semicolon
id|__skip
suffix:colon
id|snd_power_unlock
c_func
(paren
id|card
)paren
suffix:semicolon
)brace
DECL|function|m3_resume
r_static
r_void
id|m3_resume
c_func
(paren
id|m3_t
op_star
id|chip
)paren
(brace
id|snd_card_t
op_star
id|card
op_assign
id|chip-&gt;card
suffix:semicolon
r_int
id|i
comma
id|index
suffix:semicolon
id|snd_power_lock
c_func
(paren
id|card
)paren
suffix:semicolon
r_if
c_cond
(paren
id|card-&gt;power_state
op_eq
id|SNDRV_CTL_POWER_D0
)paren
r_goto
id|__skip
suffix:semicolon
multiline_comment|/* first lets just bring everything back. .*/
id|snd_m3_outw
c_func
(paren
id|chip
comma
l_int|0
comma
l_int|0x54
)paren
suffix:semicolon
id|snd_m3_outw
c_func
(paren
id|chip
comma
l_int|0
comma
l_int|0x56
)paren
suffix:semicolon
id|snd_m3_chip_init
c_func
(paren
id|chip
)paren
suffix:semicolon
id|snd_m3_assp_halt
c_func
(paren
id|chip
)paren
suffix:semicolon
id|snd_m3_ac97_reset
c_func
(paren
id|chip
comma
l_int|1
)paren
suffix:semicolon
multiline_comment|/* restore dsp image */
id|index
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
id|REV_B_CODE_MEMORY_BEGIN
suffix:semicolon
id|i
op_le
id|REV_B_CODE_MEMORY_END
suffix:semicolon
id|i
op_increment
)paren
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_CODE
comma
id|i
comma
id|chip-&gt;suspend_mem
(braket
id|index
op_increment
)braket
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
id|REV_B_DATA_MEMORY_BEGIN
suffix:semicolon
id|i
op_le
id|REV_B_DATA_MEMORY_END
suffix:semicolon
id|i
op_increment
)paren
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|i
comma
id|chip-&gt;suspend_mem
(braket
id|index
op_increment
)braket
)paren
suffix:semicolon
multiline_comment|/* tell the dma engine to restart itself */
id|snd_m3_assp_write
c_func
(paren
id|chip
comma
id|MEMTYPE_INTERNAL_DATA
comma
id|KDATA_DMA_ACTIVE
comma
l_int|0
)paren
suffix:semicolon
multiline_comment|/* restore ac97 registers */
id|snd_ac97_resume
c_func
(paren
id|chip-&gt;ac97
)paren
suffix:semicolon
id|snd_m3_assp_continue
c_func
(paren
id|chip
)paren
suffix:semicolon
id|snd_m3_enable_ints
c_func
(paren
id|chip
)paren
suffix:semicolon
id|snd_m3_amp_enable
c_func
(paren
id|chip
comma
l_int|1
)paren
suffix:semicolon
id|snd_power_change_state
c_func
(paren
id|card
comma
id|SNDRV_CTL_POWER_D0
)paren
suffix:semicolon
id|__skip
suffix:colon
id|snd_power_unlock
c_func
(paren
id|card
)paren
suffix:semicolon
)brace
macro_line|#ifndef PCI_OLD_SUSPEND
DECL|function|snd_m3_suspend
r_static
r_int
id|snd_m3_suspend
c_func
(paren
r_struct
id|pci_dev
op_star
id|pci
comma
id|u32
id|state
)paren
(brace
id|m3_t
op_star
id|chip
op_assign
id|snd_magic_cast
c_func
(paren
id|m3_t
comma
id|pci_get_drvdata
c_func
(paren
id|pci
)paren
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|m3_suspend
c_func
(paren
id|chip
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_m3_resume
r_static
r_int
id|snd_m3_resume
c_func
(paren
r_struct
id|pci_dev
op_star
id|pci
)paren
(brace
id|m3_t
op_star
id|chip
op_assign
id|snd_magic_cast
c_func
(paren
id|m3_t
comma
id|pci_get_drvdata
c_func
(paren
id|pci
)paren
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|m3_resume
c_func
(paren
id|chip
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#else
DECL|function|snd_m3_suspend
r_static
r_void
id|snd_m3_suspend
c_func
(paren
r_struct
id|pci_dev
op_star
id|pci
)paren
(brace
id|m3_t
op_star
id|chip
op_assign
id|snd_magic_cast
c_func
(paren
id|m3_t
comma
id|pci_get_drvdata
c_func
(paren
id|pci
)paren
comma
r_return
)paren
suffix:semicolon
id|m3_suspend
c_func
(paren
id|chip
)paren
suffix:semicolon
)brace
DECL|function|snd_m3_resume
r_static
r_void
id|snd_m3_resume
c_func
(paren
r_struct
id|pci_dev
op_star
id|pci
)paren
(brace
id|m3_t
op_star
id|chip
op_assign
id|snd_magic_cast
c_func
(paren
id|m3_t
comma
id|pci_get_drvdata
c_func
(paren
id|pci
)paren
comma
r_return
)paren
suffix:semicolon
id|m3_resume
c_func
(paren
id|chip
)paren
suffix:semicolon
)brace
macro_line|#endif
multiline_comment|/* callback */
DECL|function|snd_m3_set_power_state
r_static
r_int
id|snd_m3_set_power_state
c_func
(paren
id|snd_card_t
op_star
id|card
comma
r_int
r_int
id|power_state
)paren
(brace
id|m3_t
op_star
id|chip
op_assign
id|snd_magic_cast
c_func
(paren
id|m3_t
comma
id|card-&gt;power_state_private_data
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|power_state
)paren
(brace
r_case
id|SNDRV_CTL_POWER_D0
suffix:colon
r_case
id|SNDRV_CTL_POWER_D1
suffix:colon
r_case
id|SNDRV_CTL_POWER_D2
suffix:colon
id|m3_resume
c_func
(paren
id|chip
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNDRV_CTL_POWER_D3hot
suffix:colon
r_case
id|SNDRV_CTL_POWER_D3cold
suffix:colon
id|m3_suspend
c_func
(paren
id|chip
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#endif /* CONFIG_PM */
multiline_comment|/*&n; */
DECL|function|snd_m3_dev_free
r_static
r_int
id|snd_m3_dev_free
c_func
(paren
id|snd_device_t
op_star
id|device
)paren
(brace
id|m3_t
op_star
id|chip
op_assign
id|snd_magic_cast
c_func
(paren
id|m3_t
comma
id|device-&gt;device_data
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
r_return
id|snd_m3_free
c_func
(paren
id|chip
)paren
suffix:semicolon
)brace
r_static
r_int
id|__devinit
DECL|function|snd_m3_create
id|snd_m3_create
c_func
(paren
id|snd_card_t
op_star
id|card
comma
r_struct
id|pci_dev
op_star
id|pci
comma
r_int
id|enable_amp
comma
r_int
id|amp_gpio
comma
id|m3_t
op_star
op_star
id|chip_ret
)paren
(brace
id|m3_t
op_star
id|chip
suffix:semicolon
r_int
id|i
comma
id|err
suffix:semicolon
r_static
id|snd_device_ops_t
id|ops
op_assign
(brace
id|dev_free
suffix:colon
id|snd_m3_dev_free
comma
)brace
suffix:semicolon
op_star
id|chip_ret
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
id|pci_enable_device
c_func
(paren
id|pci
)paren
)paren
r_return
op_minus
id|EIO
suffix:semicolon
multiline_comment|/* check, if we can restrict PCI DMA transfers to 28 bits */
r_if
c_cond
(paren
op_logical_neg
id|pci_dma_supported
c_func
(paren
id|pci
comma
l_int|0x0fffffff
)paren
)paren
(brace
id|snd_printk
c_func
(paren
l_string|&quot;architecture does not support 28bit PCI busmaster DMA&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|ENXIO
suffix:semicolon
)brace
id|pci_set_dma_mask
c_func
(paren
id|pci
comma
l_int|0x0fffffff
)paren
suffix:semicolon
id|chip
op_assign
id|snd_magic_kcalloc
c_func
(paren
id|m3_t
comma
l_int|0
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chip
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|spin_lock_init
c_func
(paren
op_amp
id|chip-&gt;reg_lock
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|pci-&gt;device
)paren
(brace
r_case
id|PCI_DEVICE_ID_ESS_ALLEGRO
suffix:colon
r_case
id|PCI_DEVICE_ID_ESS_ALLEGRO_1
suffix:colon
r_case
id|PCI_DEVICE_ID_ESS_CANYON3D_2LE
suffix:colon
r_case
id|PCI_DEVICE_ID_ESS_CANYON3D_2
suffix:colon
id|chip-&gt;allegro_flag
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
)brace
macro_line|#ifndef LINUX_2_2
id|chip-&gt;subsystem_vendor
op_assign
id|pci-&gt;subsystem_vendor
suffix:semicolon
id|chip-&gt;subsystem_device
op_assign
id|pci-&gt;subsystem_device
suffix:semicolon
macro_line|#else
id|pci_read_config_word
c_func
(paren
id|pci
comma
id|PCI_SUBSYSTEM_VENDOR_ID
comma
op_amp
id|chip-&gt;subsystem_vendor
)paren
suffix:semicolon
id|pci_read_config_word
c_func
(paren
id|pci
comma
id|PCI_SUBSYSTEM_ID
comma
op_amp
id|chip-&gt;subsystem_device
)paren
suffix:semicolon
macro_line|#endif
id|chip-&gt;card
op_assign
id|card
suffix:semicolon
id|chip-&gt;pci
op_assign
id|pci
suffix:semicolon
id|chip-&gt;irq
op_assign
op_minus
l_int|1
suffix:semicolon
id|chip-&gt;external_amp
op_assign
id|enable_amp
suffix:semicolon
r_if
c_cond
(paren
id|amp_gpio
op_ge
l_int|0
op_logical_and
id|amp_gpio
op_le
l_int|0x0f
)paren
id|chip-&gt;amp_gpio
op_assign
id|amp_gpio
suffix:semicolon
r_else
r_if
c_cond
(paren
id|chip-&gt;allegro_flag
)paren
(brace
multiline_comment|/* panasonic CF-28 &quot;toughbook&quot; has different GPIO connection.. */
r_if
c_cond
(paren
id|chip-&gt;subsystem_vendor
op_eq
l_int|0x10f7
op_logical_and
id|chip-&gt;subsystem_device
op_eq
l_int|0x833e
)paren
id|chip-&gt;amp_gpio
op_assign
l_int|0x0d
suffix:semicolon
r_else
id|chip-&gt;amp_gpio
op_assign
id|GPO_EXT_AMP_ALLEGRO
suffix:semicolon
)brace
r_else
id|chip-&gt;amp_gpio
op_assign
id|GPO_EXT_AMP_M3
suffix:semicolon
multiline_comment|/* presumably this is for all &squot;maestro3&squot;s.. */
id|chip-&gt;num_substreams
op_assign
id|NR_DSPS
suffix:semicolon
id|chip-&gt;substreams
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
id|m3_dma_t
)paren
op_star
id|chip-&gt;num_substreams
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;substreams
op_eq
l_int|NULL
)paren
(brace
id|snd_magic_kfree
c_func
(paren
id|chip
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|memset
c_func
(paren
id|chip-&gt;substreams
comma
l_int|0
comma
r_sizeof
(paren
id|m3_dma_t
)paren
op_star
id|chip-&gt;num_substreams
)paren
suffix:semicolon
id|chip-&gt;iobase
op_assign
id|pci_resource_start
c_func
(paren
id|pci
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|chip-&gt;iobase_res
op_assign
id|request_region
c_func
(paren
id|chip-&gt;iobase
comma
l_int|256
comma
id|card-&gt;driver
)paren
)paren
op_eq
l_int|NULL
)paren
(brace
id|snd_m3_free
c_func
(paren
id|chip
)paren
suffix:semicolon
id|snd_printk
c_func
(paren
l_string|&quot;unable to grab i/o ports %ld&bslash;n&quot;
comma
id|chip-&gt;iobase
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
multiline_comment|/* just to be sure */
id|pci_set_master
c_func
(paren
id|pci
)paren
suffix:semicolon
id|snd_m3_chip_init
c_func
(paren
id|chip
)paren
suffix:semicolon
id|snd_m3_assp_halt
c_func
(paren
id|chip
)paren
suffix:semicolon
id|snd_m3_ac97_reset
c_func
(paren
id|chip
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_m3_mixer
c_func
(paren
id|chip
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_m3_free
c_func
(paren
id|chip
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
id|snd_m3_assp_init
c_func
(paren
id|chip
)paren
suffix:semicolon
id|snd_m3_amp_enable
c_func
(paren
id|chip
comma
l_int|1
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|chip-&gt;num_substreams
suffix:semicolon
id|i
op_increment
)paren
(brace
id|m3_dma_t
op_star
id|s
op_assign
op_amp
id|chip-&gt;substreams
(braket
id|i
)braket
suffix:semicolon
id|s-&gt;chip
op_assign
id|chip
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_m3_assp_client_init
c_func
(paren
id|chip
comma
id|s
comma
id|i
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_m3_free
c_func
(paren
id|chip
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_m3_pcm
c_func
(paren
id|chip
comma
l_int|0
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_m3_free
c_func
(paren
id|chip
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
r_if
c_cond
(paren
id|request_irq
c_func
(paren
id|pci-&gt;irq
comma
id|snd_m3_interrupt
comma
id|SA_INTERRUPT
op_or
id|SA_SHIRQ
comma
id|card-&gt;driver
comma
(paren
r_void
op_star
)paren
id|chip
)paren
)paren
(brace
id|snd_m3_free
c_func
(paren
id|chip
)paren
suffix:semicolon
id|snd_printk
c_func
(paren
l_string|&quot;unable to grab IRQ %d&bslash;n&quot;
comma
id|pci-&gt;irq
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|chip-&gt;irq
op_assign
id|pci-&gt;irq
suffix:semicolon
macro_line|#ifdef CONFIG_PM
id|chip-&gt;suspend_mem
op_assign
id|vmalloc
c_func
(paren
r_sizeof
(paren
id|u16
)paren
op_star
(paren
id|REV_B_CODE_MEMORY_LENGTH
op_plus
id|REV_B_DATA_MEMORY_LENGTH
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;suspend_mem
op_eq
l_int|NULL
)paren
id|snd_printk
c_func
(paren
l_string|&quot;can&squot;t allocate apm buffer&bslash;n&quot;
)paren
suffix:semicolon
id|card-&gt;set_power_state
op_assign
id|snd_m3_set_power_state
suffix:semicolon
id|card-&gt;power_state_private_data
op_assign
id|chip
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_device_new
c_func
(paren
id|card
comma
id|SNDRV_DEV_LOWLEVEL
comma
id|chip
comma
op_amp
id|ops
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_m3_free
c_func
(paren
id|chip
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
id|snd_m3_enable_ints
c_func
(paren
id|chip
)paren
suffix:semicolon
id|snd_m3_assp_continue
c_func
(paren
id|chip
)paren
suffix:semicolon
op_star
id|chip_ret
op_assign
id|chip
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; */
r_static
r_int
id|__devinit
DECL|function|snd_m3_probe
id|snd_m3_probe
c_func
(paren
r_struct
id|pci_dev
op_star
id|pci
comma
r_const
r_struct
id|pci_device_id
op_star
id|id
)paren
(brace
r_static
r_int
id|dev
suffix:semicolon
id|snd_card_t
op_star
id|card
suffix:semicolon
id|m3_t
op_star
id|chip
suffix:semicolon
r_int
id|err
suffix:semicolon
multiline_comment|/* don&squot;t pick up modems */
r_if
c_cond
(paren
(paren
(paren
id|pci
op_member_access_from_pointer
r_class
op_rshift
l_int|8
)paren
op_amp
l_int|0xffff
)paren
op_ne
id|PCI_CLASS_MULTIMEDIA_AUDIO
)paren
r_return
op_minus
id|ENODEV
suffix:semicolon
r_if
c_cond
(paren
id|dev
op_ge
id|SNDRV_CARDS
)paren
r_return
op_minus
id|ENODEV
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snd_enable
(braket
id|dev
)braket
)paren
(brace
id|dev
op_increment
suffix:semicolon
r_return
op_minus
id|ENOENT
suffix:semicolon
)brace
id|card
op_assign
id|snd_card_new
c_func
(paren
id|snd_index
(braket
id|dev
)braket
comma
id|snd_id
(braket
id|dev
)braket
comma
id|THIS_MODULE
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|card
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
r_switch
c_cond
(paren
id|pci-&gt;device
)paren
(brace
r_case
id|PCI_DEVICE_ID_ESS_ALLEGRO
suffix:colon
r_case
id|PCI_DEVICE_ID_ESS_ALLEGRO_1
suffix:colon
id|strcpy
c_func
(paren
id|card-&gt;driver
comma
l_string|&quot;Allegro&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|PCI_DEVICE_ID_ESS_CANYON3D_2LE
suffix:colon
r_case
id|PCI_DEVICE_ID_ESS_CANYON3D_2
suffix:colon
id|strcpy
c_func
(paren
id|card-&gt;driver
comma
l_string|&quot;Canyon3D-2&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|strcpy
c_func
(paren
id|card-&gt;driver
comma
l_string|&quot;Maestro3&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_m3_create
c_func
(paren
id|card
comma
id|pci
comma
id|snd_external_amp
(braket
id|dev
)braket
comma
id|snd_amp_gpio
(braket
id|dev
)braket
comma
op_amp
id|chip
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_card_free
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
id|sprintf
c_func
(paren
id|card-&gt;shortname
comma
l_string|&quot;ESS %s PCI&quot;
comma
id|card-&gt;driver
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|card-&gt;longname
comma
l_string|&quot;%s at 0x%lx, irq %d&quot;
comma
id|card-&gt;shortname
comma
id|chip-&gt;iobase
comma
id|chip-&gt;irq
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_card_register
c_func
(paren
id|card
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_card_free
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
id|pci_set_drvdata
c_func
(paren
id|pci
comma
id|chip
)paren
suffix:semicolon
id|dev
op_increment
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_m3_remove
r_static
r_void
id|__devexit
id|snd_m3_remove
c_func
(paren
r_struct
id|pci_dev
op_star
id|pci
)paren
(brace
id|m3_t
op_star
id|chip
op_assign
id|snd_magic_cast
c_func
(paren
id|m3_t
comma
id|pci_get_drvdata
c_func
(paren
id|pci
)paren
comma
r_return
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chip
)paren
id|snd_card_free
c_func
(paren
id|chip-&gt;card
)paren
suffix:semicolon
id|pci_set_drvdata
c_func
(paren
id|pci
comma
l_int|NULL
)paren
suffix:semicolon
)brace
DECL|variable|driver
r_static
r_struct
id|pci_driver
id|driver
op_assign
(brace
id|name
suffix:colon
l_string|&quot;Maestro3&quot;
comma
id|id_table
suffix:colon
id|snd_m3_ids
comma
id|probe
suffix:colon
id|snd_m3_probe
comma
id|remove
suffix:colon
id|__devexit_p
c_func
(paren
id|snd_m3_remove
)paren
comma
macro_line|#ifdef CONFIG_PM
id|suspend
suffix:colon
id|snd_m3_suspend
comma
id|resume
suffix:colon
id|snd_m3_resume
comma
macro_line|#endif
)brace
suffix:semicolon
DECL|function|alsa_card_m3_init
r_static
r_int
id|__init
id|alsa_card_m3_init
c_func
(paren
r_void
)paren
(brace
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|pci_module_init
c_func
(paren
op_amp
id|driver
)paren
)paren
OL
l_int|0
)paren
(brace
macro_line|#ifdef MODULE
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;Maestro3/Allegro soundcard not found or device busy&bslash;n&quot;
)paren
suffix:semicolon
macro_line|#endif
r_return
id|err
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|alsa_card_m3_exit
r_static
r_void
id|__exit
id|alsa_card_m3_exit
c_func
(paren
r_void
)paren
(brace
id|pci_unregister_driver
c_func
(paren
op_amp
id|driver
)paren
suffix:semicolon
)brace
id|module_init
c_func
(paren
id|alsa_card_m3_init
)paren
id|module_exit
c_func
(paren
id|alsa_card_m3_exit
)paren
macro_line|#ifndef MODULE
multiline_comment|/* format is: snd-maestro3=snd_enable,snd_index,snd_id,snd_external_amp,snd_amp_gpio */
DECL|function|alsa_card_maestro3_setup
r_static
r_int
id|__init
id|alsa_card_maestro3_setup
c_func
(paren
r_char
op_star
id|str
)paren
(brace
r_static
r_int
id|__initdata
id|nr_dev
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|nr_dev
op_ge
id|SNDRV_CARDS
)paren
r_return
l_int|0
suffix:semicolon
(paren
r_void
)paren
(paren
id|get_option
c_func
(paren
op_amp
id|str
comma
op_amp
id|snd_enable
(braket
id|nr_dev
)braket
)paren
op_eq
l_int|2
op_logical_and
id|get_option
c_func
(paren
op_amp
id|str
comma
op_amp
id|snd_index
(braket
id|nr_dev
)braket
)paren
op_eq
l_int|2
op_logical_and
id|get_id
c_func
(paren
op_amp
id|str
comma
op_amp
id|snd_id
(braket
id|nr_dev
)braket
)paren
op_eq
l_int|2
op_logical_and
id|get_option
c_func
(paren
op_amp
id|str
comma
op_amp
id|snd_external_amp
(braket
id|nr_dev
)braket
)paren
op_eq
l_int|2
op_logical_and
id|get_option
c_func
(paren
op_amp
id|str
comma
op_amp
id|snd_amp_gpio
(braket
id|nr_dev
)braket
)paren
op_eq
l_int|2
)paren
suffix:semicolon
id|nr_dev
op_increment
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
id|__setup
c_func
(paren
l_string|&quot;snd-maestro3=&quot;
comma
id|alsa_card_maestro3_setup
)paren
suffix:semicolon
macro_line|#endif /* ifndef MODULE */
eof
