multiline_comment|/*&n; *  Timers abstract layer&n; *  Copyright (c) by Jaroslav Kysela &lt;perex@suse.cz&gt;&n; *&n; *&n; *   This program is free software; you can redistribute it and/or modify&n; *   it under the terms of the GNU General Public License as published by&n; *   the Free Software Foundation; either version 2 of the License, or&n; *   (at your option) any later version.&n; *&n; *   This program is distributed in the hope that it will be useful,&n; *   but WITHOUT ANY WARRANTY; without even the implied warranty of&n; *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; *   GNU General Public License for more details.&n; *&n; *   You should have received a copy of the GNU General Public License&n; *   along with this program; if not, write to the Free Software&n; *   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA&n; *&n; */
macro_line|#include &lt;sound/driver.h&gt;
macro_line|#include &lt;linux/delay.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/smp_lock.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;linux/time.h&gt;
macro_line|#include &lt;linux/moduleparam.h&gt;
macro_line|#include &lt;sound/core.h&gt;
macro_line|#include &lt;sound/timer.h&gt;
macro_line|#include &lt;sound/control.h&gt;
macro_line|#include &lt;sound/info.h&gt;
macro_line|#include &lt;sound/minors.h&gt;
macro_line|#include &lt;sound/initval.h&gt;
macro_line|#include &lt;linux/kmod.h&gt;
macro_line|#ifdef CONFIG_KERNELD
macro_line|#include &lt;linux/kerneld.h&gt;
macro_line|#endif
macro_line|#if !defined(CONFIG_SND_RTCTIMER) &amp;&amp; !defined(CONFIG_SND_RTCTIMER_MODULE)
DECL|macro|DEFAULT_TIMER_LIMIT
mdefine_line|#define DEFAULT_TIMER_LIMIT 1
macro_line|#else
DECL|macro|DEFAULT_TIMER_LIMIT
mdefine_line|#define DEFAULT_TIMER_LIMIT 2
macro_line|#endif
DECL|variable|timer_limit
r_static
r_int
id|timer_limit
op_assign
id|DEFAULT_TIMER_LIMIT
suffix:semicolon
id|MODULE_AUTHOR
c_func
(paren
l_string|&quot;Jaroslav Kysela &lt;perex@suse.cz&gt;, Takashi Iwai &lt;tiwai@suse.de&gt;&quot;
)paren
suffix:semicolon
id|MODULE_DESCRIPTION
c_func
(paren
l_string|&quot;ALSA timer interface&quot;
)paren
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|timer_limit
comma
r_int
comma
l_int|0444
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|timer_limit
comma
l_string|&quot;Maximum global timers in system.&quot;
)paren
suffix:semicolon
r_typedef
r_struct
(brace
DECL|member|timeri
id|snd_timer_instance_t
op_star
id|timeri
suffix:semicolon
DECL|member|tread
r_int
id|tread
suffix:semicolon
multiline_comment|/* enhanced read with timestamps and events */
DECL|member|ticks
r_int
r_int
id|ticks
suffix:semicolon
DECL|member|overrun
r_int
r_int
id|overrun
suffix:semicolon
DECL|member|qhead
r_int
id|qhead
suffix:semicolon
DECL|member|qtail
r_int
id|qtail
suffix:semicolon
DECL|member|qused
r_int
id|qused
suffix:semicolon
DECL|member|queue_size
r_int
id|queue_size
suffix:semicolon
DECL|member|queue
id|snd_timer_read_t
op_star
id|queue
suffix:semicolon
DECL|member|tqueue
id|snd_timer_tread_t
op_star
id|tqueue
suffix:semicolon
DECL|member|qlock
id|spinlock_t
id|qlock
suffix:semicolon
DECL|member|last_resolution
r_int
r_int
id|last_resolution
suffix:semicolon
DECL|member|filter
r_int
r_int
id|filter
suffix:semicolon
DECL|member|tstamp
r_struct
id|timespec
id|tstamp
suffix:semicolon
multiline_comment|/* trigger tstamp */
DECL|member|qchange_sleep
id|wait_queue_head_t
id|qchange_sleep
suffix:semicolon
DECL|member|fasync
r_struct
id|fasync_struct
op_star
id|fasync
suffix:semicolon
DECL|typedef|snd_timer_user_t
)brace
id|snd_timer_user_t
suffix:semicolon
multiline_comment|/* list of timers */
r_static
id|LIST_HEAD
c_func
(paren
id|snd_timer_list
)paren
suffix:semicolon
multiline_comment|/* list of slave instances */
r_static
id|LIST_HEAD
c_func
(paren
id|snd_timer_slave_list
)paren
suffix:semicolon
multiline_comment|/* lock for slave active lists */
DECL|variable|slave_active_lock
r_static
id|spinlock_t
id|slave_active_lock
op_assign
id|SPIN_LOCK_UNLOCKED
suffix:semicolon
r_static
id|DECLARE_MUTEX
c_func
(paren
id|register_mutex
)paren
suffix:semicolon
r_static
r_int
id|snd_timer_free
c_func
(paren
id|snd_timer_t
op_star
id|timer
)paren
suffix:semicolon
r_static
r_int
id|snd_timer_dev_free
c_func
(paren
id|snd_device_t
op_star
id|device
)paren
suffix:semicolon
r_static
r_int
id|snd_timer_dev_register
c_func
(paren
id|snd_device_t
op_star
id|device
)paren
suffix:semicolon
r_static
r_int
id|snd_timer_dev_unregister
c_func
(paren
id|snd_device_t
op_star
id|device
)paren
suffix:semicolon
r_static
r_void
id|snd_timer_reschedule
c_func
(paren
id|snd_timer_t
op_star
id|timer
comma
r_int
r_int
id|ticks_left
)paren
suffix:semicolon
multiline_comment|/*&n; * create a timer instance with the given owner string.&n; * when timer is not NULL, increments the module counter&n; */
DECL|function|snd_timer_instance_new
r_static
id|snd_timer_instance_t
op_star
id|snd_timer_instance_new
c_func
(paren
r_char
op_star
id|owner
comma
id|snd_timer_t
op_star
id|timer
)paren
(brace
id|snd_timer_instance_t
op_star
id|timeri
suffix:semicolon
id|timeri
op_assign
id|kcalloc
c_func
(paren
l_int|1
comma
r_sizeof
(paren
op_star
id|timeri
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|timeri
op_eq
l_int|NULL
)paren
r_return
l_int|NULL
suffix:semicolon
id|timeri-&gt;owner
op_assign
id|snd_kmalloc_strdup
c_func
(paren
id|owner
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|timeri-&gt;owner
)paren
(brace
id|kfree
c_func
(paren
id|timeri
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
id|INIT_LIST_HEAD
c_func
(paren
op_amp
id|timeri-&gt;open_list
)paren
suffix:semicolon
id|INIT_LIST_HEAD
c_func
(paren
op_amp
id|timeri-&gt;active_list
)paren
suffix:semicolon
id|INIT_LIST_HEAD
c_func
(paren
op_amp
id|timeri-&gt;ack_list
)paren
suffix:semicolon
id|INIT_LIST_HEAD
c_func
(paren
op_amp
id|timeri-&gt;slave_list_head
)paren
suffix:semicolon
id|INIT_LIST_HEAD
c_func
(paren
op_amp
id|timeri-&gt;slave_active_head
)paren
suffix:semicolon
id|timeri-&gt;timer
op_assign
id|timer
suffix:semicolon
r_if
c_cond
(paren
id|timer
op_logical_and
id|timer-&gt;card
op_logical_and
op_logical_neg
id|try_module_get
c_func
(paren
id|timer-&gt;card-&gt;module
)paren
)paren
(brace
id|kfree
c_func
(paren
id|timeri-&gt;owner
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|timeri
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
r_return
id|timeri
suffix:semicolon
)brace
multiline_comment|/*&n; * find a timer instance from the given timer id&n; */
DECL|function|snd_timer_find
r_static
id|snd_timer_t
op_star
id|snd_timer_find
c_func
(paren
id|snd_timer_id_t
op_star
id|tid
)paren
(brace
id|snd_timer_t
op_star
id|timer
op_assign
l_int|NULL
suffix:semicolon
r_struct
id|list_head
op_star
id|p
suffix:semicolon
id|list_for_each
c_func
(paren
id|p
comma
op_amp
id|snd_timer_list
)paren
(brace
id|timer
op_assign
(paren
id|snd_timer_t
op_star
)paren
id|list_entry
c_func
(paren
id|p
comma
id|snd_timer_t
comma
id|device_list
)paren
suffix:semicolon
r_if
c_cond
(paren
id|timer-&gt;tmr_class
op_ne
id|tid-&gt;dev_class
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
(paren
id|timer-&gt;tmr_class
op_eq
id|SNDRV_TIMER_CLASS_CARD
op_logical_or
id|timer-&gt;tmr_class
op_eq
id|SNDRV_TIMER_CLASS_PCM
)paren
op_logical_and
(paren
id|timer-&gt;card
op_eq
l_int|NULL
op_logical_or
id|timer-&gt;card-&gt;number
op_ne
id|tid-&gt;card
)paren
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|timer-&gt;tmr_device
op_ne
id|tid-&gt;device
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|timer-&gt;tmr_subdevice
op_ne
id|tid-&gt;subdevice
)paren
r_continue
suffix:semicolon
r_return
id|timer
suffix:semicolon
)brace
r_return
l_int|NULL
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_KMOD
DECL|function|snd_timer_request
r_static
r_void
id|snd_timer_request
c_func
(paren
id|snd_timer_id_t
op_star
id|tid
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|current-&gt;fs-&gt;root
)paren
r_return
suffix:semicolon
r_switch
c_cond
(paren
id|tid-&gt;dev_class
)paren
(brace
r_case
id|SNDRV_TIMER_CLASS_GLOBAL
suffix:colon
r_if
c_cond
(paren
id|tid-&gt;device
OL
id|timer_limit
)paren
id|request_module
c_func
(paren
l_string|&quot;snd-timer-%i&quot;
comma
id|tid-&gt;device
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNDRV_TIMER_CLASS_CARD
suffix:colon
r_case
id|SNDRV_TIMER_CLASS_PCM
suffix:colon
r_if
c_cond
(paren
id|tid-&gt;card
OL
id|snd_ecards_limit
)paren
id|request_module
c_func
(paren
l_string|&quot;snd-card-%i&quot;
comma
id|tid-&gt;card
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_break
suffix:semicolon
)brace
)brace
macro_line|#endif
multiline_comment|/*&n; * look for a master instance matching with the slave id of the given slave.&n; * when found, relink the open_link of the slave.&n; *&n; * call this with register_mutex down.&n; */
DECL|function|snd_timer_check_slave
r_static
r_void
id|snd_timer_check_slave
c_func
(paren
id|snd_timer_instance_t
op_star
id|slave
)paren
(brace
id|snd_timer_t
op_star
id|timer
suffix:semicolon
id|snd_timer_instance_t
op_star
id|master
suffix:semicolon
r_struct
id|list_head
op_star
id|p
comma
op_star
id|q
suffix:semicolon
multiline_comment|/* FIXME: it&squot;s really dumb to look up all entries.. */
id|list_for_each
c_func
(paren
id|p
comma
op_amp
id|snd_timer_list
)paren
(brace
id|timer
op_assign
(paren
id|snd_timer_t
op_star
)paren
id|list_entry
c_func
(paren
id|p
comma
id|snd_timer_t
comma
id|device_list
)paren
suffix:semicolon
id|list_for_each
c_func
(paren
id|q
comma
op_amp
id|timer-&gt;open_list_head
)paren
(brace
id|master
op_assign
(paren
id|snd_timer_instance_t
op_star
)paren
id|list_entry
c_func
(paren
id|q
comma
id|snd_timer_instance_t
comma
id|open_list
)paren
suffix:semicolon
r_if
c_cond
(paren
id|slave-&gt;slave_class
op_eq
id|master-&gt;slave_class
op_logical_and
id|slave-&gt;slave_id
op_eq
id|master-&gt;slave_id
)paren
(brace
id|list_del
c_func
(paren
op_amp
id|slave-&gt;open_list
)paren
suffix:semicolon
id|list_add_tail
c_func
(paren
op_amp
id|slave-&gt;open_list
comma
op_amp
id|master-&gt;slave_list_head
)paren
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|slave_active_lock
)paren
suffix:semicolon
id|slave-&gt;master
op_assign
id|master
suffix:semicolon
id|slave-&gt;timer
op_assign
id|master-&gt;timer
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|slave_active_lock
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
)brace
)brace
)brace
multiline_comment|/*&n; * look for slave instances matching with the slave id of the given master.&n; * when found, relink the open_link of slaves.&n; *&n; * call this with register_mutex down.&n; */
DECL|function|snd_timer_check_master
r_static
r_void
id|snd_timer_check_master
c_func
(paren
id|snd_timer_instance_t
op_star
id|master
)paren
(brace
id|snd_timer_instance_t
op_star
id|slave
suffix:semicolon
r_struct
id|list_head
op_star
id|p
comma
op_star
id|n
suffix:semicolon
multiline_comment|/* check all pending slaves */
id|list_for_each_safe
c_func
(paren
id|p
comma
id|n
comma
op_amp
id|snd_timer_slave_list
)paren
(brace
id|slave
op_assign
(paren
id|snd_timer_instance_t
op_star
)paren
id|list_entry
c_func
(paren
id|p
comma
id|snd_timer_instance_t
comma
id|open_list
)paren
suffix:semicolon
r_if
c_cond
(paren
id|slave-&gt;slave_class
op_eq
id|master-&gt;slave_class
op_logical_and
id|slave-&gt;slave_id
op_eq
id|master-&gt;slave_id
)paren
(brace
id|list_del
c_func
(paren
id|p
)paren
suffix:semicolon
id|list_add_tail
c_func
(paren
id|p
comma
op_amp
id|master-&gt;slave_list_head
)paren
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|slave_active_lock
)paren
suffix:semicolon
id|slave-&gt;master
op_assign
id|master
suffix:semicolon
id|slave-&gt;timer
op_assign
id|master-&gt;timer
suffix:semicolon
r_if
c_cond
(paren
id|slave-&gt;flags
op_amp
id|SNDRV_TIMER_IFLG_RUNNING
)paren
id|list_add_tail
c_func
(paren
op_amp
id|slave-&gt;active_list
comma
op_amp
id|master-&gt;slave_active_head
)paren
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|slave_active_lock
)paren
suffix:semicolon
)brace
)brace
)brace
multiline_comment|/*&n; * open a timer instance&n; * when opening a master, the slave id must be here given.&n; */
DECL|function|snd_timer_open
r_int
id|snd_timer_open
c_func
(paren
id|snd_timer_instance_t
op_star
op_star
id|ti
comma
r_char
op_star
id|owner
comma
id|snd_timer_id_t
op_star
id|tid
comma
r_int
r_int
id|slave_id
)paren
(brace
id|snd_timer_t
op_star
id|timer
suffix:semicolon
id|snd_timer_instance_t
op_star
id|timeri
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
id|tid-&gt;dev_class
op_eq
id|SNDRV_TIMER_CLASS_SLAVE
)paren
(brace
multiline_comment|/* open a slave instance */
r_if
c_cond
(paren
id|tid-&gt;dev_sclass
op_le
id|SNDRV_TIMER_SCLASS_NONE
op_logical_or
id|tid-&gt;dev_sclass
OG
id|SNDRV_TIMER_SCLASS_OSS_SEQUENCER
)paren
(brace
id|snd_printd
c_func
(paren
l_string|&quot;invalid slave class %i&bslash;n&quot;
comma
id|tid-&gt;dev_sclass
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|down
c_func
(paren
op_amp
id|register_mutex
)paren
suffix:semicolon
id|timeri
op_assign
id|snd_timer_instance_new
c_func
(paren
id|owner
comma
l_int|NULL
)paren
suffix:semicolon
id|timeri-&gt;slave_class
op_assign
id|tid-&gt;dev_sclass
suffix:semicolon
id|timeri-&gt;slave_id
op_assign
id|tid-&gt;device
suffix:semicolon
id|timeri-&gt;flags
op_or_assign
id|SNDRV_TIMER_IFLG_SLAVE
suffix:semicolon
id|list_add_tail
c_func
(paren
op_amp
id|timeri-&gt;open_list
comma
op_amp
id|snd_timer_slave_list
)paren
suffix:semicolon
id|snd_timer_check_slave
c_func
(paren
id|timeri
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|register_mutex
)paren
suffix:semicolon
op_star
id|ti
op_assign
id|timeri
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* open a master instance */
id|down
c_func
(paren
op_amp
id|register_mutex
)paren
suffix:semicolon
id|timer
op_assign
id|snd_timer_find
c_func
(paren
id|tid
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_KMOD
r_if
c_cond
(paren
id|timer
op_eq
l_int|NULL
)paren
(brace
id|up
c_func
(paren
op_amp
id|register_mutex
)paren
suffix:semicolon
id|snd_timer_request
c_func
(paren
id|tid
)paren
suffix:semicolon
id|down
c_func
(paren
op_amp
id|register_mutex
)paren
suffix:semicolon
id|timer
op_assign
id|snd_timer_find
c_func
(paren
id|tid
)paren
suffix:semicolon
)brace
macro_line|#endif
r_if
c_cond
(paren
id|timer
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|list_empty
c_func
(paren
op_amp
id|timer-&gt;open_list_head
)paren
)paren
(brace
id|timeri
op_assign
(paren
id|snd_timer_instance_t
op_star
)paren
id|list_entry
c_func
(paren
id|timer-&gt;open_list_head.next
comma
id|snd_timer_instance_t
comma
id|open_list
)paren
suffix:semicolon
r_if
c_cond
(paren
id|timeri-&gt;flags
op_amp
id|SNDRV_TIMER_IFLG_EXCLUSIVE
)paren
(brace
id|up
c_func
(paren
op_amp
id|register_mutex
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
)brace
id|timeri
op_assign
id|snd_timer_instance_new
c_func
(paren
id|owner
comma
id|timer
)paren
suffix:semicolon
r_if
c_cond
(paren
id|timeri
)paren
(brace
id|timeri-&gt;slave_class
op_assign
id|tid-&gt;dev_sclass
suffix:semicolon
id|timeri-&gt;slave_id
op_assign
id|slave_id
suffix:semicolon
r_if
c_cond
(paren
id|list_empty
c_func
(paren
op_amp
id|timer-&gt;open_list_head
)paren
op_logical_and
id|timer-&gt;hw.open
)paren
id|timer-&gt;hw
dot
id|open
c_func
(paren
id|timer
)paren
suffix:semicolon
id|list_add_tail
c_func
(paren
op_amp
id|timeri-&gt;open_list
comma
op_amp
id|timer-&gt;open_list_head
)paren
suffix:semicolon
id|snd_timer_check_master
c_func
(paren
id|timeri
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
id|up
c_func
(paren
op_amp
id|register_mutex
)paren
suffix:semicolon
r_return
op_minus
id|ENODEV
suffix:semicolon
)brace
id|up
c_func
(paren
op_amp
id|register_mutex
)paren
suffix:semicolon
op_star
id|ti
op_assign
id|timeri
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
id|_snd_timer_stop
c_func
(paren
id|snd_timer_instance_t
op_star
id|timeri
comma
r_int
id|keep_flag
comma
r_enum
id|sndrv_timer_event
id|event
)paren
suffix:semicolon
multiline_comment|/*&n; * close a timer instance&n; */
DECL|function|snd_timer_close
r_int
id|snd_timer_close
c_func
(paren
id|snd_timer_instance_t
op_star
id|timeri
)paren
(brace
id|snd_timer_t
op_star
id|timer
op_assign
l_int|NULL
suffix:semicolon
r_struct
id|list_head
op_star
id|p
comma
op_star
id|n
suffix:semicolon
id|snd_timer_instance_t
op_star
id|slave
suffix:semicolon
id|snd_assert
c_func
(paren
id|timeri
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
multiline_comment|/* force to stop the timer */
id|snd_timer_stop
c_func
(paren
id|timeri
)paren
suffix:semicolon
r_if
c_cond
(paren
id|timeri-&gt;flags
op_amp
id|SNDRV_TIMER_IFLG_SLAVE
)paren
(brace
multiline_comment|/* wait, until the active callback is finished */
id|spin_lock_irq
c_func
(paren
op_amp
id|slave_active_lock
)paren
suffix:semicolon
r_while
c_loop
(paren
id|timeri-&gt;flags
op_amp
id|SNDRV_TIMER_IFLG_CALLBACK
)paren
(brace
id|spin_unlock_irq
c_func
(paren
op_amp
id|slave_active_lock
)paren
suffix:semicolon
id|udelay
c_func
(paren
l_int|10
)paren
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|slave_active_lock
)paren
suffix:semicolon
)brace
id|spin_unlock_irq
c_func
(paren
op_amp
id|slave_active_lock
)paren
suffix:semicolon
id|down
c_func
(paren
op_amp
id|register_mutex
)paren
suffix:semicolon
id|list_del
c_func
(paren
op_amp
id|timeri-&gt;open_list
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|register_mutex
)paren
suffix:semicolon
)brace
r_else
(brace
id|timer
op_assign
id|timeri-&gt;timer
suffix:semicolon
multiline_comment|/* wait, until the active callback is finished */
id|spin_lock_irq
c_func
(paren
op_amp
id|timer-&gt;lock
)paren
suffix:semicolon
r_while
c_loop
(paren
id|timeri-&gt;flags
op_amp
id|SNDRV_TIMER_IFLG_CALLBACK
)paren
(brace
id|spin_unlock_irq
c_func
(paren
op_amp
id|timer-&gt;lock
)paren
suffix:semicolon
id|udelay
c_func
(paren
l_int|10
)paren
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|timer-&gt;lock
)paren
suffix:semicolon
)brace
id|spin_unlock_irq
c_func
(paren
op_amp
id|timer-&gt;lock
)paren
suffix:semicolon
id|down
c_func
(paren
op_amp
id|register_mutex
)paren
suffix:semicolon
id|list_del
c_func
(paren
op_amp
id|timeri-&gt;open_list
)paren
suffix:semicolon
r_if
c_cond
(paren
id|timer
op_logical_and
id|list_empty
c_func
(paren
op_amp
id|timer-&gt;open_list_head
)paren
op_logical_and
id|timer-&gt;hw.close
)paren
id|timer-&gt;hw
dot
id|close
c_func
(paren
id|timer
)paren
suffix:semicolon
multiline_comment|/* remove slave links */
id|list_for_each_safe
c_func
(paren
id|p
comma
id|n
comma
op_amp
id|timeri-&gt;slave_list_head
)paren
(brace
id|slave
op_assign
(paren
id|snd_timer_instance_t
op_star
)paren
id|list_entry
c_func
(paren
id|p
comma
id|snd_timer_instance_t
comma
id|open_list
)paren
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|slave_active_lock
)paren
suffix:semicolon
id|_snd_timer_stop
c_func
(paren
id|slave
comma
l_int|1
comma
id|SNDRV_TIMER_EVENT_RESOLUTION
)paren
suffix:semicolon
id|list_del
c_func
(paren
id|p
)paren
suffix:semicolon
id|list_add_tail
c_func
(paren
id|p
comma
op_amp
id|snd_timer_slave_list
)paren
suffix:semicolon
id|slave-&gt;master
op_assign
l_int|NULL
suffix:semicolon
id|slave-&gt;timer
op_assign
l_int|NULL
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|slave_active_lock
)paren
suffix:semicolon
)brace
id|up
c_func
(paren
op_amp
id|register_mutex
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|timeri-&gt;private_free
)paren
id|timeri
op_member_access_from_pointer
id|private_free
c_func
(paren
id|timeri
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|timeri-&gt;owner
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|timeri
)paren
suffix:semicolon
r_if
c_cond
(paren
id|timer
op_logical_and
id|timer-&gt;card
)paren
id|module_put
c_func
(paren
id|timer-&gt;card-&gt;module
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_timer_resolution
r_int
r_int
id|snd_timer_resolution
c_func
(paren
id|snd_timer_instance_t
op_star
id|timeri
)paren
(brace
id|snd_timer_t
op_star
id|timer
suffix:semicolon
r_if
c_cond
(paren
id|timeri
op_eq
l_int|NULL
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
(paren
id|timer
op_assign
id|timeri-&gt;timer
)paren
op_ne
l_int|NULL
)paren
(brace
r_if
c_cond
(paren
id|timer-&gt;hw.c_resolution
)paren
r_return
id|timer-&gt;hw
dot
id|c_resolution
c_func
(paren
id|timer
)paren
suffix:semicolon
r_return
id|timer-&gt;hw.resolution
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_timer_notify1
r_static
r_void
id|snd_timer_notify1
c_func
(paren
id|snd_timer_instance_t
op_star
id|ti
comma
r_enum
id|sndrv_timer_event
id|event
)paren
(brace
id|snd_timer_t
op_star
id|timer
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
r_int
id|resolution
op_assign
l_int|0
suffix:semicolon
id|snd_timer_instance_t
op_star
id|ts
suffix:semicolon
r_struct
id|list_head
op_star
id|n
suffix:semicolon
r_struct
id|timespec
id|tstamp
suffix:semicolon
id|snd_timestamp_now
c_func
(paren
op_amp
id|tstamp
comma
l_int|1
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|event
op_ge
id|SNDRV_TIMER_EVENT_START
op_logical_and
id|event
op_le
id|SNDRV_TIMER_EVENT_PAUSE
comma
r_return
)paren
suffix:semicolon
r_if
c_cond
(paren
id|event
op_eq
id|SNDRV_TIMER_EVENT_START
op_logical_or
id|event
op_eq
id|SNDRV_TIMER_EVENT_CONTINUE
)paren
id|resolution
op_assign
id|snd_timer_resolution
c_func
(paren
id|ti
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ti-&gt;ccallback
)paren
id|ti
op_member_access_from_pointer
id|ccallback
c_func
(paren
id|ti
comma
id|SNDRV_TIMER_EVENT_START
comma
op_amp
id|tstamp
comma
id|resolution
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ti-&gt;flags
op_amp
id|SNDRV_TIMER_IFLG_SLAVE
)paren
r_return
suffix:semicolon
id|timer
op_assign
id|ti-&gt;timer
suffix:semicolon
r_if
c_cond
(paren
id|timer
op_eq
l_int|NULL
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|timer-&gt;hw.flags
op_amp
id|SNDRV_TIMER_HW_SLAVE
)paren
r_return
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|timer-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|list_for_each
c_func
(paren
id|n
comma
op_amp
id|ti-&gt;slave_active_head
)paren
(brace
id|ts
op_assign
(paren
id|snd_timer_instance_t
op_star
)paren
id|list_entry
c_func
(paren
id|n
comma
id|snd_timer_instance_t
comma
id|active_list
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ts-&gt;ccallback
)paren
id|ts
op_member_access_from_pointer
id|ccallback
c_func
(paren
id|ti
comma
id|event
op_plus
l_int|100
comma
op_amp
id|tstamp
comma
id|resolution
)paren
suffix:semicolon
)brace
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|timer-&gt;lock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|snd_timer_start1
r_static
r_int
id|snd_timer_start1
c_func
(paren
id|snd_timer_t
op_star
id|timer
comma
id|snd_timer_instance_t
op_star
id|timeri
comma
r_int
r_int
id|sticks
)paren
(brace
id|list_del
c_func
(paren
op_amp
id|timeri-&gt;active_list
)paren
suffix:semicolon
id|list_add_tail
c_func
(paren
op_amp
id|timeri-&gt;active_list
comma
op_amp
id|timer-&gt;active_list_head
)paren
suffix:semicolon
r_if
c_cond
(paren
id|timer-&gt;running
)paren
(brace
r_if
c_cond
(paren
id|timer-&gt;hw.flags
op_amp
id|SNDRV_TIMER_HW_SLAVE
)paren
r_goto
id|__start_now
suffix:semicolon
id|timer-&gt;flags
op_or_assign
id|SNDRV_TIMER_FLG_RESCHED
suffix:semicolon
id|timeri-&gt;flags
op_or_assign
id|SNDRV_TIMER_IFLG_START
suffix:semicolon
r_return
l_int|1
suffix:semicolon
multiline_comment|/* delayed start */
)brace
r_else
(brace
id|timer-&gt;sticks
op_assign
id|sticks
suffix:semicolon
id|timer-&gt;hw
dot
id|start
c_func
(paren
id|timer
)paren
suffix:semicolon
id|__start_now
suffix:colon
id|timer-&gt;running
op_increment
suffix:semicolon
id|timeri-&gt;flags
op_or_assign
id|SNDRV_TIMER_IFLG_RUNNING
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
)brace
DECL|function|snd_timer_start_slave
r_static
r_int
id|snd_timer_start_slave
c_func
(paren
id|snd_timer_instance_t
op_star
id|timeri
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|slave_active_lock
comma
id|flags
)paren
suffix:semicolon
id|timeri-&gt;flags
op_or_assign
id|SNDRV_TIMER_IFLG_RUNNING
suffix:semicolon
r_if
c_cond
(paren
id|timeri-&gt;master
)paren
id|list_add_tail
c_func
(paren
op_amp
id|timeri-&gt;active_list
comma
op_amp
id|timeri-&gt;master-&gt;slave_active_head
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|slave_active_lock
comma
id|flags
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
multiline_comment|/* delayed start */
)brace
multiline_comment|/*&n; *  start the timer instance&n; */
DECL|function|snd_timer_start
r_int
id|snd_timer_start
c_func
(paren
id|snd_timer_instance_t
op_star
id|timeri
comma
r_int
r_int
id|ticks
)paren
(brace
id|snd_timer_t
op_star
id|timer
suffix:semicolon
r_int
id|result
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_if
c_cond
(paren
id|timeri
op_eq
l_int|NULL
op_logical_or
id|ticks
OL
l_int|1
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|timeri-&gt;flags
op_amp
id|SNDRV_TIMER_IFLG_SLAVE
)paren
(brace
id|result
op_assign
id|snd_timer_start_slave
c_func
(paren
id|timeri
)paren
suffix:semicolon
id|snd_timer_notify1
c_func
(paren
id|timeri
comma
id|SNDRV_TIMER_EVENT_START
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
id|timer
op_assign
id|timeri-&gt;timer
suffix:semicolon
r_if
c_cond
(paren
id|timer
op_eq
l_int|NULL
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|timer-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|timeri-&gt;ticks
op_assign
id|timeri-&gt;cticks
op_assign
id|ticks
suffix:semicolon
id|timeri-&gt;pticks
op_assign
l_int|0
suffix:semicolon
id|result
op_assign
id|snd_timer_start1
c_func
(paren
id|timer
comma
id|timeri
comma
id|ticks
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|timer-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|snd_timer_notify1
c_func
(paren
id|timeri
comma
id|SNDRV_TIMER_EVENT_START
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
DECL|function|_snd_timer_stop
r_static
r_int
id|_snd_timer_stop
c_func
(paren
id|snd_timer_instance_t
op_star
id|timeri
comma
r_int
id|keep_flag
comma
r_enum
id|sndrv_timer_event
id|event
)paren
(brace
id|snd_timer_t
op_star
id|timer
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|snd_assert
c_func
(paren
id|timeri
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
r_if
c_cond
(paren
id|timeri-&gt;flags
op_amp
id|SNDRV_TIMER_IFLG_SLAVE
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|keep_flag
)paren
(brace
id|spin_lock_irqsave
c_func
(paren
op_amp
id|slave_active_lock
comma
id|flags
)paren
suffix:semicolon
id|timeri-&gt;flags
op_and_assign
op_complement
id|SNDRV_TIMER_IFLG_RUNNING
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|slave_active_lock
comma
id|flags
)paren
suffix:semicolon
)brace
r_goto
id|__end
suffix:semicolon
)brace
id|timer
op_assign
id|timeri-&gt;timer
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|timer
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|timer-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|list_del_init
c_func
(paren
op_amp
id|timeri-&gt;ack_list
)paren
suffix:semicolon
id|list_del_init
c_func
(paren
op_amp
id|timeri-&gt;active_list
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|timeri-&gt;flags
op_amp
id|SNDRV_TIMER_IFLG_RUNNING
)paren
op_logical_and
op_logical_neg
(paren
op_decrement
id|timer-&gt;running
)paren
)paren
(brace
id|timer-&gt;hw
dot
id|stop
c_func
(paren
id|timer
)paren
suffix:semicolon
r_if
c_cond
(paren
id|timer-&gt;flags
op_amp
id|SNDRV_TIMER_FLG_RESCHED
)paren
(brace
id|timer-&gt;flags
op_and_assign
op_complement
id|SNDRV_TIMER_FLG_RESCHED
suffix:semicolon
id|snd_timer_reschedule
c_func
(paren
id|timer
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|timer-&gt;flags
op_amp
id|SNDRV_TIMER_FLG_CHANGE
)paren
(brace
id|timer-&gt;flags
op_and_assign
op_complement
id|SNDRV_TIMER_FLG_CHANGE
suffix:semicolon
id|timer-&gt;hw
dot
id|start
c_func
(paren
id|timer
)paren
suffix:semicolon
)brace
)brace
)brace
r_if
c_cond
(paren
op_logical_neg
id|keep_flag
)paren
id|timeri-&gt;flags
op_and_assign
op_complement
(paren
id|SNDRV_TIMER_IFLG_RUNNING
op_or
id|SNDRV_TIMER_IFLG_START
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|timer-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|__end
suffix:colon
r_if
c_cond
(paren
id|event
op_ne
id|SNDRV_TIMER_EVENT_RESOLUTION
)paren
id|snd_timer_notify1
c_func
(paren
id|timeri
comma
id|event
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * stop the timer instance.&n; *&n; * do not call this from the timer callback!&n; */
DECL|function|snd_timer_stop
r_int
id|snd_timer_stop
c_func
(paren
id|snd_timer_instance_t
op_star
id|timeri
)paren
(brace
id|snd_timer_t
op_star
id|timer
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
id|err
suffix:semicolon
id|err
op_assign
id|_snd_timer_stop
c_func
(paren
id|timeri
comma
l_int|0
comma
id|SNDRV_TIMER_EVENT_STOP
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|timer
op_assign
id|timeri-&gt;timer
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|timer-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|timeri-&gt;cticks
op_assign
id|timeri-&gt;ticks
suffix:semicolon
id|timeri-&gt;pticks
op_assign
l_int|0
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|timer-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * start again..  the tick is kept.&n; */
DECL|function|snd_timer_continue
r_int
id|snd_timer_continue
c_func
(paren
id|snd_timer_instance_t
op_star
id|timeri
)paren
(brace
id|snd_timer_t
op_star
id|timer
suffix:semicolon
r_int
id|result
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_if
c_cond
(paren
id|timeri
op_eq
l_int|NULL
)paren
r_return
id|result
suffix:semicolon
r_if
c_cond
(paren
id|timeri-&gt;flags
op_amp
id|SNDRV_TIMER_IFLG_SLAVE
)paren
r_return
id|snd_timer_start_slave
c_func
(paren
id|timeri
)paren
suffix:semicolon
id|timer
op_assign
id|timeri-&gt;timer
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|timer
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|timer-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|timeri-&gt;cticks
)paren
id|timeri-&gt;cticks
op_assign
l_int|1
suffix:semicolon
id|timeri-&gt;pticks
op_assign
l_int|0
suffix:semicolon
id|result
op_assign
id|snd_timer_start1
c_func
(paren
id|timer
comma
id|timeri
comma
id|timer-&gt;sticks
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|timer-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|snd_timer_notify1
c_func
(paren
id|timeri
comma
id|SNDRV_TIMER_EVENT_CONTINUE
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
multiline_comment|/*&n; * pause.. remember the ticks left&n; */
DECL|function|snd_timer_pause
r_int
id|snd_timer_pause
c_func
(paren
id|snd_timer_instance_t
op_star
id|timeri
)paren
(brace
r_return
id|_snd_timer_stop
c_func
(paren
id|timeri
comma
l_int|0
comma
id|SNDRV_TIMER_EVENT_PAUSE
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * reschedule the timer&n; *&n; * start pending instances and check the scheduling ticks.&n; * when the scheduling ticks is changed set CHANGE flag to reprogram the timer.&n; */
DECL|function|snd_timer_reschedule
r_static
r_void
id|snd_timer_reschedule
c_func
(paren
id|snd_timer_t
op_star
id|timer
comma
r_int
r_int
id|ticks_left
)paren
(brace
id|snd_timer_instance_t
op_star
id|ti
suffix:semicolon
r_int
r_int
id|ticks
op_assign
op_complement
l_int|0UL
suffix:semicolon
r_struct
id|list_head
op_star
id|p
suffix:semicolon
id|list_for_each
c_func
(paren
id|p
comma
op_amp
id|timer-&gt;active_list_head
)paren
(brace
id|ti
op_assign
(paren
id|snd_timer_instance_t
op_star
)paren
id|list_entry
c_func
(paren
id|p
comma
id|snd_timer_instance_t
comma
id|active_list
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ti-&gt;flags
op_amp
id|SNDRV_TIMER_IFLG_START
)paren
(brace
id|ti-&gt;flags
op_and_assign
op_complement
id|SNDRV_TIMER_IFLG_START
suffix:semicolon
id|ti-&gt;flags
op_or_assign
id|SNDRV_TIMER_IFLG_RUNNING
suffix:semicolon
id|timer-&gt;running
op_increment
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ti-&gt;flags
op_amp
id|SNDRV_TIMER_IFLG_RUNNING
)paren
(brace
r_if
c_cond
(paren
id|ticks
OG
id|ti-&gt;cticks
)paren
id|ticks
op_assign
id|ti-&gt;cticks
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|ticks
op_eq
op_complement
l_int|0UL
)paren
(brace
id|timer-&gt;flags
op_and_assign
op_complement
id|SNDRV_TIMER_FLG_RESCHED
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ticks
OG
id|timer-&gt;hw.ticks
)paren
id|ticks
op_assign
id|timer-&gt;hw.ticks
suffix:semicolon
r_if
c_cond
(paren
id|ticks_left
op_ne
id|ticks
)paren
id|timer-&gt;flags
op_or_assign
id|SNDRV_TIMER_FLG_CHANGE
suffix:semicolon
id|timer-&gt;sticks
op_assign
id|ticks
suffix:semicolon
)brace
multiline_comment|/*&n; * timer tasklet&n; *&n; */
DECL|function|snd_timer_tasklet
r_static
r_void
id|snd_timer_tasklet
c_func
(paren
r_int
r_int
id|arg
)paren
(brace
id|snd_timer_t
op_star
id|timer
op_assign
(paren
id|snd_timer_t
op_star
)paren
id|arg
suffix:semicolon
id|snd_timer_instance_t
op_star
id|ti
suffix:semicolon
r_struct
id|list_head
op_star
id|p
suffix:semicolon
r_int
r_int
id|resolution
comma
id|ticks
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|timer-&gt;lock
)paren
suffix:semicolon
multiline_comment|/* now process all callbacks */
r_while
c_loop
(paren
op_logical_neg
id|list_empty
c_func
(paren
op_amp
id|timer-&gt;sack_list_head
)paren
)paren
(brace
id|p
op_assign
id|timer-&gt;sack_list_head.next
suffix:semicolon
multiline_comment|/* get first item */
id|ti
op_assign
(paren
id|snd_timer_instance_t
op_star
)paren
id|list_entry
c_func
(paren
id|p
comma
id|snd_timer_instance_t
comma
id|ack_list
)paren
suffix:semicolon
multiline_comment|/* remove from ack_list and make empty */
id|list_del_init
c_func
(paren
id|p
)paren
suffix:semicolon
id|ticks
op_assign
id|ti-&gt;pticks
suffix:semicolon
id|ti-&gt;pticks
op_assign
l_int|0
suffix:semicolon
id|resolution
op_assign
id|ti-&gt;resolution
suffix:semicolon
id|ti-&gt;flags
op_or_assign
id|SNDRV_TIMER_IFLG_CALLBACK
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|timer-&gt;lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ti-&gt;callback
)paren
id|ti
op_member_access_from_pointer
id|callback
c_func
(paren
id|ti
comma
id|resolution
comma
id|ticks
)paren
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|timer-&gt;lock
)paren
suffix:semicolon
id|ti-&gt;flags
op_and_assign
op_complement
id|SNDRV_TIMER_IFLG_CALLBACK
suffix:semicolon
)brace
id|spin_unlock
c_func
(paren
op_amp
id|timer-&gt;lock
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * timer interrupt&n; *&n; * ticks_left is usually equal to timer-&gt;sticks.&n; *&n; */
DECL|function|snd_timer_interrupt
r_void
id|snd_timer_interrupt
c_func
(paren
id|snd_timer_t
op_star
id|timer
comma
r_int
r_int
id|ticks_left
)paren
(brace
id|snd_timer_instance_t
op_star
id|ti
comma
op_star
id|ts
suffix:semicolon
r_int
r_int
id|resolution
comma
id|ticks
suffix:semicolon
r_struct
id|list_head
op_star
id|p
comma
op_star
id|q
comma
op_star
id|n
suffix:semicolon
r_int
id|use_tasklet
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|timer
op_eq
l_int|NULL
)paren
r_return
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|timer-&gt;lock
)paren
suffix:semicolon
multiline_comment|/* remember the current resolution */
r_if
c_cond
(paren
id|timer-&gt;hw.c_resolution
)paren
id|resolution
op_assign
id|timer-&gt;hw
dot
id|c_resolution
c_func
(paren
id|timer
)paren
suffix:semicolon
r_else
id|resolution
op_assign
id|timer-&gt;hw.resolution
suffix:semicolon
multiline_comment|/* loop for all active instances&n;&t; * here we cannot use list_for_each because the active_list of a processed&n;&t; * instance is relinked to done_list_head before callback is called.&n;&t; */
id|list_for_each_safe
c_func
(paren
id|p
comma
id|n
comma
op_amp
id|timer-&gt;active_list_head
)paren
(brace
id|ti
op_assign
(paren
id|snd_timer_instance_t
op_star
)paren
id|list_entry
c_func
(paren
id|p
comma
id|snd_timer_instance_t
comma
id|active_list
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|ti-&gt;flags
op_amp
id|SNDRV_TIMER_IFLG_RUNNING
)paren
)paren
r_continue
suffix:semicolon
id|ti-&gt;pticks
op_add_assign
id|ticks_left
suffix:semicolon
id|ti-&gt;resolution
op_assign
id|resolution
suffix:semicolon
r_if
c_cond
(paren
id|ti-&gt;cticks
OL
id|ticks_left
)paren
id|ti-&gt;cticks
op_assign
l_int|0
suffix:semicolon
r_else
id|ti-&gt;cticks
op_sub_assign
id|ticks_left
suffix:semicolon
r_if
c_cond
(paren
id|ti-&gt;cticks
)paren
multiline_comment|/* not expired */
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|ti-&gt;flags
op_amp
id|SNDRV_TIMER_IFLG_AUTO
)paren
(brace
id|ti-&gt;cticks
op_assign
id|ti-&gt;ticks
suffix:semicolon
)brace
r_else
(brace
id|ti-&gt;flags
op_and_assign
op_complement
id|SNDRV_TIMER_IFLG_RUNNING
suffix:semicolon
r_if
c_cond
(paren
op_decrement
id|timer-&gt;running
)paren
id|list_del
c_func
(paren
id|p
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|list_empty
c_func
(paren
op_amp
id|ti-&gt;ack_list
)paren
)paren
(brace
r_if
c_cond
(paren
(paren
id|timer-&gt;hw.flags
op_amp
id|SNDRV_TIMER_HW_TASKLET
)paren
op_logical_or
(paren
id|ti-&gt;flags
op_amp
id|SNDRV_TIMER_IFLG_FAST
)paren
)paren
(brace
id|list_add_tail
c_func
(paren
op_amp
id|ti-&gt;ack_list
comma
op_amp
id|timer-&gt;ack_list_head
)paren
suffix:semicolon
)brace
r_else
(brace
id|list_add_tail
c_func
(paren
op_amp
id|ti-&gt;ack_list
comma
op_amp
id|timer-&gt;sack_list_head
)paren
suffix:semicolon
)brace
)brace
id|list_for_each
c_func
(paren
id|q
comma
op_amp
id|ti-&gt;slave_active_head
)paren
(brace
id|ts
op_assign
(paren
id|snd_timer_instance_t
op_star
)paren
id|list_entry
c_func
(paren
id|q
comma
id|snd_timer_instance_t
comma
id|active_list
)paren
suffix:semicolon
id|ts-&gt;pticks
op_assign
id|ti-&gt;pticks
suffix:semicolon
id|ts-&gt;resolution
op_assign
id|resolution
suffix:semicolon
r_if
c_cond
(paren
id|list_empty
c_func
(paren
op_amp
id|ts-&gt;ack_list
)paren
)paren
(brace
r_if
c_cond
(paren
(paren
id|timer-&gt;hw.flags
op_amp
id|SNDRV_TIMER_HW_TASKLET
)paren
op_logical_or
(paren
id|ti-&gt;flags
op_amp
id|SNDRV_TIMER_IFLG_FAST
)paren
)paren
(brace
id|list_add_tail
c_func
(paren
op_amp
id|ts-&gt;ack_list
comma
op_amp
id|timer-&gt;ack_list_head
)paren
suffix:semicolon
)brace
r_else
(brace
id|list_add_tail
c_func
(paren
op_amp
id|ts-&gt;ack_list
comma
op_amp
id|timer-&gt;sack_list_head
)paren
suffix:semicolon
)brace
)brace
)brace
)brace
r_if
c_cond
(paren
id|timer-&gt;flags
op_amp
id|SNDRV_TIMER_FLG_RESCHED
)paren
id|snd_timer_reschedule
c_func
(paren
id|timer
comma
id|ticks_left
)paren
suffix:semicolon
r_if
c_cond
(paren
id|timer-&gt;running
)paren
(brace
r_if
c_cond
(paren
id|timer-&gt;hw.flags
op_amp
id|SNDRV_TIMER_HW_STOP
)paren
(brace
id|timer-&gt;hw
dot
id|stop
c_func
(paren
id|timer
)paren
suffix:semicolon
id|timer-&gt;flags
op_or_assign
id|SNDRV_TIMER_FLG_CHANGE
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|timer-&gt;hw.flags
op_amp
id|SNDRV_TIMER_HW_AUTO
)paren
op_logical_or
(paren
id|timer-&gt;flags
op_amp
id|SNDRV_TIMER_FLG_CHANGE
)paren
)paren
(brace
multiline_comment|/* restart timer */
id|timer-&gt;flags
op_and_assign
op_complement
id|SNDRV_TIMER_FLG_CHANGE
suffix:semicolon
id|timer-&gt;hw
dot
id|start
c_func
(paren
id|timer
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
id|timer-&gt;hw
dot
id|stop
c_func
(paren
id|timer
)paren
suffix:semicolon
)brace
multiline_comment|/* now process all fast callbacks */
r_while
c_loop
(paren
op_logical_neg
id|list_empty
c_func
(paren
op_amp
id|timer-&gt;ack_list_head
)paren
)paren
(brace
id|p
op_assign
id|timer-&gt;ack_list_head.next
suffix:semicolon
multiline_comment|/* get first item */
id|ti
op_assign
(paren
id|snd_timer_instance_t
op_star
)paren
id|list_entry
c_func
(paren
id|p
comma
id|snd_timer_instance_t
comma
id|ack_list
)paren
suffix:semicolon
multiline_comment|/* remove from ack_list and make empty */
id|list_del_init
c_func
(paren
id|p
)paren
suffix:semicolon
id|ticks
op_assign
id|ti-&gt;pticks
suffix:semicolon
id|ti-&gt;pticks
op_assign
l_int|0
suffix:semicolon
id|ti-&gt;flags
op_or_assign
id|SNDRV_TIMER_IFLG_CALLBACK
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|timer-&gt;lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ti-&gt;callback
)paren
id|ti
op_member_access_from_pointer
id|callback
c_func
(paren
id|ti
comma
id|resolution
comma
id|ticks
)paren
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|timer-&gt;lock
)paren
suffix:semicolon
id|ti-&gt;flags
op_and_assign
op_complement
id|SNDRV_TIMER_IFLG_CALLBACK
suffix:semicolon
)brace
multiline_comment|/* do we have any slow callbacks? */
id|use_tasklet
op_assign
op_logical_neg
id|list_empty
c_func
(paren
op_amp
id|timer-&gt;sack_list_head
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|timer-&gt;lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|use_tasklet
)paren
id|tasklet_hi_schedule
c_func
(paren
op_amp
id|timer-&gt;task_queue
)paren
suffix:semicolon
)brace
multiline_comment|/*&n;&n; */
DECL|function|snd_timer_new
r_int
id|snd_timer_new
c_func
(paren
id|snd_card_t
op_star
id|card
comma
r_char
op_star
id|id
comma
id|snd_timer_id_t
op_star
id|tid
comma
id|snd_timer_t
op_star
op_star
id|rtimer
)paren
(brace
id|snd_timer_t
op_star
id|timer
suffix:semicolon
r_int
id|err
suffix:semicolon
r_static
id|snd_device_ops_t
id|ops
op_assign
(brace
dot
id|dev_free
op_assign
id|snd_timer_dev_free
comma
dot
id|dev_register
op_assign
id|snd_timer_dev_register
comma
dot
id|dev_unregister
op_assign
id|snd_timer_dev_unregister
)brace
suffix:semicolon
id|snd_assert
c_func
(paren
id|tid
op_ne
l_int|NULL
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|rtimer
op_ne
l_int|NULL
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
op_star
id|rtimer
op_assign
l_int|NULL
suffix:semicolon
id|timer
op_assign
id|kcalloc
c_func
(paren
l_int|1
comma
r_sizeof
(paren
op_star
id|timer
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|timer
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|timer-&gt;tmr_class
op_assign
id|tid-&gt;dev_class
suffix:semicolon
id|timer-&gt;card
op_assign
id|card
suffix:semicolon
id|timer-&gt;tmr_device
op_assign
id|tid-&gt;device
suffix:semicolon
id|timer-&gt;tmr_subdevice
op_assign
id|tid-&gt;subdevice
suffix:semicolon
r_if
c_cond
(paren
id|id
)paren
id|strlcpy
c_func
(paren
id|timer-&gt;id
comma
id|id
comma
r_sizeof
(paren
id|timer-&gt;id
)paren
)paren
suffix:semicolon
id|INIT_LIST_HEAD
c_func
(paren
op_amp
id|timer-&gt;device_list
)paren
suffix:semicolon
id|INIT_LIST_HEAD
c_func
(paren
op_amp
id|timer-&gt;open_list_head
)paren
suffix:semicolon
id|INIT_LIST_HEAD
c_func
(paren
op_amp
id|timer-&gt;active_list_head
)paren
suffix:semicolon
id|INIT_LIST_HEAD
c_func
(paren
op_amp
id|timer-&gt;ack_list_head
)paren
suffix:semicolon
id|INIT_LIST_HEAD
c_func
(paren
op_amp
id|timer-&gt;sack_list_head
)paren
suffix:semicolon
id|spin_lock_init
c_func
(paren
op_amp
id|timer-&gt;lock
)paren
suffix:semicolon
id|tasklet_init
c_func
(paren
op_amp
id|timer-&gt;task_queue
comma
id|snd_timer_tasklet
comma
(paren
r_int
r_int
)paren
id|timer
)paren
suffix:semicolon
r_if
c_cond
(paren
id|card
op_ne
l_int|NULL
)paren
(brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_device_new
c_func
(paren
id|card
comma
id|SNDRV_DEV_TIMER
comma
id|timer
comma
op_amp
id|ops
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_timer_free
c_func
(paren
id|timer
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
)brace
op_star
id|rtimer
op_assign
id|timer
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_timer_free
r_static
r_int
id|snd_timer_free
c_func
(paren
id|snd_timer_t
op_star
id|timer
)paren
(brace
id|snd_assert
c_func
(paren
id|timer
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
r_if
c_cond
(paren
id|timer-&gt;private_free
)paren
id|timer
op_member_access_from_pointer
id|private_free
c_func
(paren
id|timer
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|timer
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_timer_dev_free
r_int
id|snd_timer_dev_free
c_func
(paren
id|snd_device_t
op_star
id|device
)paren
(brace
id|snd_timer_t
op_star
id|timer
op_assign
id|device-&gt;device_data
suffix:semicolon
r_return
id|snd_timer_free
c_func
(paren
id|timer
)paren
suffix:semicolon
)brace
DECL|function|snd_timer_dev_register
r_int
id|snd_timer_dev_register
c_func
(paren
id|snd_device_t
op_star
id|dev
)paren
(brace
id|snd_timer_t
op_star
id|timer
op_assign
id|dev-&gt;device_data
suffix:semicolon
id|snd_timer_t
op_star
id|timer1
suffix:semicolon
r_struct
id|list_head
op_star
id|p
suffix:semicolon
id|snd_assert
c_func
(paren
id|timer
op_ne
l_int|NULL
op_logical_and
id|timer-&gt;hw.start
op_ne
l_int|NULL
op_logical_and
id|timer-&gt;hw.stop
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|timer-&gt;hw.flags
op_amp
id|SNDRV_TIMER_HW_SLAVE
)paren
op_logical_and
op_logical_neg
id|timer-&gt;hw.resolution
op_logical_and
id|timer-&gt;hw.c_resolution
op_eq
l_int|NULL
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|down
c_func
(paren
op_amp
id|register_mutex
)paren
suffix:semicolon
id|list_for_each
c_func
(paren
id|p
comma
op_amp
id|snd_timer_list
)paren
(brace
id|timer1
op_assign
(paren
id|snd_timer_t
op_star
)paren
id|list_entry
c_func
(paren
id|p
comma
id|snd_timer_t
comma
id|device_list
)paren
suffix:semicolon
r_if
c_cond
(paren
id|timer1-&gt;tmr_class
OG
id|timer-&gt;tmr_class
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
id|timer1-&gt;tmr_class
OL
id|timer-&gt;tmr_class
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|timer1-&gt;card
op_logical_and
id|timer-&gt;card
)paren
(brace
r_if
c_cond
(paren
id|timer1-&gt;card-&gt;number
OG
id|timer-&gt;card-&gt;number
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
id|timer1-&gt;card-&gt;number
OL
id|timer-&gt;card-&gt;number
)paren
r_continue
suffix:semicolon
)brace
r_if
c_cond
(paren
id|timer1-&gt;tmr_device
OG
id|timer-&gt;tmr_device
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
id|timer1-&gt;tmr_device
OL
id|timer-&gt;tmr_device
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|timer1-&gt;tmr_subdevice
OG
id|timer-&gt;tmr_subdevice
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
id|timer1-&gt;tmr_subdevice
OL
id|timer-&gt;tmr_subdevice
)paren
r_continue
suffix:semicolon
multiline_comment|/* conflicts.. */
id|up
c_func
(paren
op_amp
id|register_mutex
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
id|list_add_tail
c_func
(paren
op_amp
id|timer-&gt;device_list
comma
id|p
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|register_mutex
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_timer_unregister
r_int
id|snd_timer_unregister
c_func
(paren
id|snd_timer_t
op_star
id|timer
)paren
(brace
r_struct
id|list_head
op_star
id|p
comma
op_star
id|n
suffix:semicolon
id|snd_timer_instance_t
op_star
id|ti
suffix:semicolon
id|snd_assert
c_func
(paren
id|timer
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|down
c_func
(paren
op_amp
id|register_mutex
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|list_empty
c_func
(paren
op_amp
id|timer-&gt;open_list_head
)paren
)paren
(brace
id|snd_printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;timer 0x%lx is busy?&bslash;n&quot;
comma
(paren
r_int
)paren
id|timer
)paren
suffix:semicolon
id|list_for_each_safe
c_func
(paren
id|p
comma
id|n
comma
op_amp
id|timer-&gt;open_list_head
)paren
(brace
id|list_del_init
c_func
(paren
id|p
)paren
suffix:semicolon
id|ti
op_assign
(paren
id|snd_timer_instance_t
op_star
)paren
id|list_entry
c_func
(paren
id|p
comma
id|snd_timer_instance_t
comma
id|open_list
)paren
suffix:semicolon
id|ti-&gt;timer
op_assign
l_int|NULL
suffix:semicolon
)brace
)brace
id|list_del
c_func
(paren
op_amp
id|timer-&gt;device_list
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|register_mutex
)paren
suffix:semicolon
r_return
id|snd_timer_free
c_func
(paren
id|timer
)paren
suffix:semicolon
)brace
DECL|function|snd_timer_dev_unregister
r_static
r_int
id|snd_timer_dev_unregister
c_func
(paren
id|snd_device_t
op_star
id|device
)paren
(brace
id|snd_timer_t
op_star
id|timer
op_assign
id|device-&gt;device_data
suffix:semicolon
r_return
id|snd_timer_unregister
c_func
(paren
id|timer
)paren
suffix:semicolon
)brace
DECL|function|snd_timer_notify
r_void
id|snd_timer_notify
c_func
(paren
id|snd_timer_t
op_star
id|timer
comma
r_enum
id|sndrv_timer_event
id|event
comma
r_struct
id|timespec
op_star
id|tstamp
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
r_int
r_int
id|resolution
op_assign
l_int|0
suffix:semicolon
id|snd_timer_instance_t
op_star
id|ti
comma
op_star
id|ts
suffix:semicolon
r_struct
id|list_head
op_star
id|p
comma
op_star
id|n
suffix:semicolon
id|snd_runtime_check
c_func
(paren
id|timer-&gt;hw.flags
op_amp
id|SNDRV_TIMER_HW_SLAVE
comma
r_return
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|event
op_ge
id|SNDRV_TIMER_EVENT_MSTART
op_logical_and
id|event
op_le
id|SNDRV_TIMER_EVENT_MPAUSE
comma
r_return
)paren
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|timer-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|event
op_eq
id|SNDRV_TIMER_EVENT_MSTART
op_logical_or
id|event
op_eq
id|SNDRV_TIMER_EVENT_MCONTINUE
)paren
(brace
r_if
c_cond
(paren
id|timer-&gt;hw.c_resolution
)paren
id|resolution
op_assign
id|timer-&gt;hw
dot
id|c_resolution
c_func
(paren
id|timer
)paren
suffix:semicolon
r_else
id|resolution
op_assign
id|timer-&gt;hw.resolution
suffix:semicolon
)brace
id|list_for_each
c_func
(paren
id|p
comma
op_amp
id|timer-&gt;active_list_head
)paren
(brace
id|ti
op_assign
(paren
id|snd_timer_instance_t
op_star
)paren
id|list_entry
c_func
(paren
id|p
comma
id|snd_timer_instance_t
comma
id|active_list
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ti-&gt;ccallback
)paren
id|ti
op_member_access_from_pointer
id|ccallback
c_func
(paren
id|ti
comma
id|event
comma
id|tstamp
comma
id|resolution
)paren
suffix:semicolon
id|list_for_each
c_func
(paren
id|n
comma
op_amp
id|ti-&gt;slave_active_head
)paren
(brace
id|ts
op_assign
(paren
id|snd_timer_instance_t
op_star
)paren
id|list_entry
c_func
(paren
id|n
comma
id|snd_timer_instance_t
comma
id|active_list
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ts-&gt;ccallback
)paren
id|ts
op_member_access_from_pointer
id|ccallback
c_func
(paren
id|ts
comma
id|event
comma
id|tstamp
comma
id|resolution
)paren
suffix:semicolon
)brace
)brace
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|timer-&gt;lock
comma
id|flags
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * exported functions for global timers&n; */
DECL|function|snd_timer_global_new
r_int
id|snd_timer_global_new
c_func
(paren
r_char
op_star
id|id
comma
r_int
id|device
comma
id|snd_timer_t
op_star
op_star
id|rtimer
)paren
(brace
id|snd_timer_id_t
id|tid
suffix:semicolon
id|tid.dev_class
op_assign
id|SNDRV_TIMER_CLASS_GLOBAL
suffix:semicolon
id|tid.dev_sclass
op_assign
id|SNDRV_TIMER_SCLASS_NONE
suffix:semicolon
id|tid.card
op_assign
op_minus
l_int|1
suffix:semicolon
id|tid.device
op_assign
id|device
suffix:semicolon
id|tid.subdevice
op_assign
l_int|0
suffix:semicolon
r_return
id|snd_timer_new
c_func
(paren
l_int|NULL
comma
id|id
comma
op_amp
id|tid
comma
id|rtimer
)paren
suffix:semicolon
)brace
DECL|function|snd_timer_global_free
r_int
id|snd_timer_global_free
c_func
(paren
id|snd_timer_t
op_star
id|timer
)paren
(brace
r_return
id|snd_timer_free
c_func
(paren
id|timer
)paren
suffix:semicolon
)brace
DECL|function|snd_timer_global_register
r_int
id|snd_timer_global_register
c_func
(paren
id|snd_timer_t
op_star
id|timer
)paren
(brace
id|snd_device_t
id|dev
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|dev
comma
l_int|0
comma
r_sizeof
(paren
id|dev
)paren
)paren
suffix:semicolon
id|dev.device_data
op_assign
id|timer
suffix:semicolon
r_return
id|snd_timer_dev_register
c_func
(paren
op_amp
id|dev
)paren
suffix:semicolon
)brace
DECL|function|snd_timer_global_unregister
r_int
id|snd_timer_global_unregister
c_func
(paren
id|snd_timer_t
op_star
id|timer
)paren
(brace
r_return
id|snd_timer_unregister
c_func
(paren
id|timer
)paren
suffix:semicolon
)brace
multiline_comment|/* &n; *  System timer&n; */
DECL|struct|snd_timer_system_private
r_struct
id|snd_timer_system_private
(brace
DECL|member|tlist
r_struct
id|timer_list
id|tlist
suffix:semicolon
DECL|member|timer
r_struct
id|timer
op_star
id|timer
suffix:semicolon
DECL|member|last_expires
r_int
r_int
id|last_expires
suffix:semicolon
DECL|member|last_jiffies
r_int
r_int
id|last_jiffies
suffix:semicolon
DECL|member|correction
r_int
r_int
id|correction
suffix:semicolon
)brace
suffix:semicolon
DECL|function|snd_timer_system_resolution
r_int
r_int
id|snd_timer_system_resolution
c_func
(paren
r_void
)paren
(brace
r_return
l_int|1000000000L
op_div
id|HZ
suffix:semicolon
)brace
DECL|function|snd_timer_s_function
r_static
r_void
id|snd_timer_s_function
c_func
(paren
r_int
r_int
id|data
)paren
(brace
id|snd_timer_t
op_star
id|timer
op_assign
(paren
id|snd_timer_t
op_star
)paren
id|data
suffix:semicolon
r_struct
id|snd_timer_system_private
op_star
id|priv
op_assign
id|timer-&gt;private_data
suffix:semicolon
r_int
r_int
id|jiff
op_assign
id|jiffies
suffix:semicolon
r_if
c_cond
(paren
id|time_after
c_func
(paren
id|jiff
comma
id|priv-&gt;last_expires
)paren
)paren
id|priv-&gt;correction
op_assign
(paren
r_int
)paren
id|jiff
op_minus
(paren
r_int
)paren
id|priv-&gt;last_expires
suffix:semicolon
id|snd_timer_interrupt
c_func
(paren
id|timer
comma
(paren
r_int
)paren
id|jiff
op_minus
(paren
r_int
)paren
id|priv-&gt;last_jiffies
)paren
suffix:semicolon
)brace
DECL|function|snd_timer_s_start
r_static
r_int
id|snd_timer_s_start
c_func
(paren
id|snd_timer_t
op_star
id|timer
)paren
(brace
r_struct
id|snd_timer_system_private
op_star
id|priv
suffix:semicolon
r_int
r_int
id|njiff
suffix:semicolon
id|priv
op_assign
(paren
r_struct
id|snd_timer_system_private
op_star
)paren
id|timer-&gt;private_data
suffix:semicolon
id|njiff
op_assign
(paren
id|priv-&gt;last_jiffies
op_assign
id|jiffies
)paren
suffix:semicolon
r_if
c_cond
(paren
id|priv-&gt;correction
OG
id|timer-&gt;sticks
op_minus
l_int|1
)paren
(brace
id|priv-&gt;correction
op_sub_assign
id|timer-&gt;sticks
op_minus
l_int|1
suffix:semicolon
id|njiff
op_increment
suffix:semicolon
)brace
r_else
(brace
id|njiff
op_add_assign
id|timer-&gt;sticks
op_minus
id|priv-&gt;correction
suffix:semicolon
id|priv-&gt;correction
op_sub_assign
id|timer-&gt;sticks
suffix:semicolon
)brace
id|priv-&gt;last_expires
op_assign
id|priv-&gt;tlist.expires
op_assign
id|njiff
suffix:semicolon
id|add_timer
c_func
(paren
op_amp
id|priv-&gt;tlist
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_timer_s_stop
r_static
r_int
id|snd_timer_s_stop
c_func
(paren
id|snd_timer_t
op_star
id|timer
)paren
(brace
r_struct
id|snd_timer_system_private
op_star
id|priv
suffix:semicolon
r_int
r_int
id|jiff
suffix:semicolon
id|priv
op_assign
(paren
r_struct
id|snd_timer_system_private
op_star
)paren
id|timer-&gt;private_data
suffix:semicolon
id|del_timer
c_func
(paren
op_amp
id|priv-&gt;tlist
)paren
suffix:semicolon
id|jiff
op_assign
id|jiffies
suffix:semicolon
r_if
c_cond
(paren
id|time_before
c_func
(paren
id|jiff
comma
id|priv-&gt;last_expires
)paren
)paren
id|timer-&gt;sticks
op_assign
id|priv-&gt;last_expires
op_minus
id|jiff
suffix:semicolon
r_else
id|timer-&gt;sticks
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|snd_timer_system
r_static
r_struct
id|_snd_timer_hardware
id|snd_timer_system
op_assign
(brace
dot
id|flags
op_assign
id|SNDRV_TIMER_HW_FIRST
op_or
id|SNDRV_TIMER_HW_TASKLET
comma
dot
id|resolution
op_assign
l_int|1000000000L
op_div
id|HZ
comma
dot
id|ticks
op_assign
l_int|10000000L
comma
dot
id|start
op_assign
id|snd_timer_s_start
comma
dot
id|stop
op_assign
id|snd_timer_s_stop
)brace
suffix:semicolon
DECL|function|snd_timer_free_system
r_static
r_void
id|snd_timer_free_system
c_func
(paren
id|snd_timer_t
op_star
id|timer
)paren
(brace
id|kfree
c_func
(paren
id|timer-&gt;private_data
)paren
suffix:semicolon
)brace
DECL|function|snd_timer_register_system
r_static
r_int
id|snd_timer_register_system
c_func
(paren
r_void
)paren
(brace
id|snd_timer_t
op_star
id|timer
suffix:semicolon
r_struct
id|snd_timer_system_private
op_star
id|priv
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_timer_global_new
c_func
(paren
l_string|&quot;system&quot;
comma
id|SNDRV_TIMER_GLOBAL_SYSTEM
comma
op_amp
id|timer
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|strcpy
c_func
(paren
id|timer-&gt;name
comma
l_string|&quot;system timer&quot;
)paren
suffix:semicolon
id|timer-&gt;hw
op_assign
id|snd_timer_system
suffix:semicolon
id|priv
op_assign
id|kcalloc
c_func
(paren
l_int|1
comma
r_sizeof
(paren
op_star
id|priv
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|priv
op_eq
l_int|NULL
)paren
(brace
id|snd_timer_free
c_func
(paren
id|timer
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|init_timer
c_func
(paren
op_amp
id|priv-&gt;tlist
)paren
suffix:semicolon
id|priv-&gt;tlist.function
op_assign
id|snd_timer_s_function
suffix:semicolon
id|priv-&gt;tlist.data
op_assign
(paren
r_int
r_int
)paren
id|timer
suffix:semicolon
id|timer-&gt;private_data
op_assign
id|priv
suffix:semicolon
id|timer-&gt;private_free
op_assign
id|snd_timer_free_system
suffix:semicolon
r_return
id|snd_timer_global_register
c_func
(paren
id|timer
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; *  Info interface&n; */
DECL|function|snd_timer_proc_read
r_static
r_void
id|snd_timer_proc_read
c_func
(paren
id|snd_info_entry_t
op_star
id|entry
comma
id|snd_info_buffer_t
op_star
id|buffer
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
id|snd_timer_t
op_star
id|timer
suffix:semicolon
id|snd_timer_instance_t
op_star
id|ti
suffix:semicolon
r_struct
id|list_head
op_star
id|p
comma
op_star
id|q
suffix:semicolon
id|down
c_func
(paren
op_amp
id|register_mutex
)paren
suffix:semicolon
id|list_for_each
c_func
(paren
id|p
comma
op_amp
id|snd_timer_list
)paren
(brace
id|timer
op_assign
(paren
id|snd_timer_t
op_star
)paren
id|list_entry
c_func
(paren
id|p
comma
id|snd_timer_t
comma
id|device_list
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|timer-&gt;tmr_class
)paren
(brace
r_case
id|SNDRV_TIMER_CLASS_GLOBAL
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;G%i: &quot;
comma
id|timer-&gt;tmr_device
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNDRV_TIMER_CLASS_CARD
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;C%i-%i: &quot;
comma
id|timer-&gt;card-&gt;number
comma
id|timer-&gt;tmr_device
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNDRV_TIMER_CLASS_PCM
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;P%i-%i-%i: &quot;
comma
id|timer-&gt;card-&gt;number
comma
id|timer-&gt;tmr_device
comma
id|timer-&gt;tmr_subdevice
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;?%i-%i-%i-%i: &quot;
comma
id|timer-&gt;tmr_class
comma
id|timer-&gt;card
ques
c_cond
id|timer-&gt;card-&gt;number
suffix:colon
op_minus
l_int|1
comma
id|timer-&gt;tmr_device
comma
id|timer-&gt;tmr_subdevice
)paren
suffix:semicolon
)brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;%s :&quot;
comma
id|timer-&gt;name
)paren
suffix:semicolon
r_if
c_cond
(paren
id|timer-&gt;hw.resolution
)paren
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot; %lu.%03luus (%lu ticks)&quot;
comma
id|timer-&gt;hw.resolution
op_div
l_int|1000
comma
id|timer-&gt;hw.resolution
op_mod
l_int|1000
comma
id|timer-&gt;hw.ticks
)paren
suffix:semicolon
r_if
c_cond
(paren
id|timer-&gt;hw.flags
op_amp
id|SNDRV_TIMER_HW_SLAVE
)paren
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot; SLAVE&quot;
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|timer-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|list_for_each
c_func
(paren
id|q
comma
op_amp
id|timer-&gt;open_list_head
)paren
(brace
id|ti
op_assign
(paren
id|snd_timer_instance_t
op_star
)paren
id|list_entry
c_func
(paren
id|q
comma
id|snd_timer_instance_t
comma
id|open_list
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;  Client %s : %s : lost interrupts %li&bslash;n&quot;
comma
id|ti-&gt;owner
ques
c_cond
id|ti-&gt;owner
suffix:colon
l_string|&quot;unknown&quot;
comma
id|ti-&gt;flags
op_amp
(paren
id|SNDRV_TIMER_IFLG_START
op_or
id|SNDRV_TIMER_IFLG_RUNNING
)paren
ques
c_cond
l_string|&quot;running&quot;
suffix:colon
l_string|&quot;stopped&quot;
comma
id|ti-&gt;lost
)paren
suffix:semicolon
)brace
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|timer-&gt;lock
comma
id|flags
)paren
suffix:semicolon
)brace
id|up
c_func
(paren
op_amp
id|register_mutex
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; *  USER SPACE interface&n; */
DECL|function|snd_timer_user_interrupt
r_static
r_void
id|snd_timer_user_interrupt
c_func
(paren
id|snd_timer_instance_t
op_star
id|timeri
comma
r_int
r_int
id|resolution
comma
r_int
r_int
id|ticks
)paren
(brace
id|snd_timer_user_t
op_star
id|tu
op_assign
id|timeri-&gt;callback_data
suffix:semicolon
id|snd_timer_read_t
op_star
id|r
suffix:semicolon
r_int
id|prev
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|tu-&gt;qlock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tu-&gt;qused
OG
l_int|0
)paren
(brace
id|prev
op_assign
id|tu-&gt;qtail
op_eq
l_int|0
ques
c_cond
id|tu-&gt;queue_size
op_minus
l_int|1
suffix:colon
id|tu-&gt;qtail
op_minus
l_int|1
suffix:semicolon
id|r
op_assign
op_amp
id|tu-&gt;queue
(braket
id|prev
)braket
suffix:semicolon
r_if
c_cond
(paren
id|r-&gt;resolution
op_eq
id|resolution
)paren
(brace
id|r-&gt;ticks
op_add_assign
id|ticks
suffix:semicolon
r_goto
id|__wake
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|tu-&gt;qused
op_ge
id|tu-&gt;queue_size
)paren
(brace
id|tu-&gt;overrun
op_increment
suffix:semicolon
)brace
r_else
(brace
id|r
op_assign
op_amp
id|tu-&gt;queue
(braket
id|tu-&gt;qtail
op_increment
)braket
suffix:semicolon
id|tu-&gt;qtail
op_mod_assign
id|tu-&gt;queue_size
suffix:semicolon
id|r-&gt;resolution
op_assign
id|resolution
suffix:semicolon
id|r-&gt;ticks
op_assign
id|ticks
suffix:semicolon
id|tu-&gt;qused
op_increment
suffix:semicolon
)brace
id|__wake
suffix:colon
id|spin_unlock
c_func
(paren
op_amp
id|tu-&gt;qlock
)paren
suffix:semicolon
id|kill_fasync
c_func
(paren
op_amp
id|tu-&gt;fasync
comma
id|SIGIO
comma
id|POLL_IN
)paren
suffix:semicolon
id|wake_up
c_func
(paren
op_amp
id|tu-&gt;qchange_sleep
)paren
suffix:semicolon
)brace
DECL|function|snd_timer_user_append_to_tqueue
r_static
r_void
id|snd_timer_user_append_to_tqueue
c_func
(paren
id|snd_timer_user_t
op_star
id|tu
comma
id|snd_timer_tread_t
op_star
id|tread
)paren
(brace
r_if
c_cond
(paren
id|tu-&gt;qused
op_ge
id|tu-&gt;queue_size
)paren
(brace
id|tu-&gt;overrun
op_increment
suffix:semicolon
)brace
r_else
(brace
id|memcpy
c_func
(paren
op_amp
id|tu-&gt;queue
(braket
id|tu-&gt;qtail
op_increment
)braket
comma
id|tread
comma
r_sizeof
(paren
op_star
id|tread
)paren
)paren
suffix:semicolon
id|tu-&gt;qused
op_increment
suffix:semicolon
)brace
)brace
DECL|function|snd_timer_user_ccallback
r_static
r_void
id|snd_timer_user_ccallback
c_func
(paren
id|snd_timer_instance_t
op_star
id|timeri
comma
r_enum
id|sndrv_timer_event
id|event
comma
r_struct
id|timespec
op_star
id|tstamp
comma
r_int
r_int
id|resolution
)paren
(brace
id|snd_timer_user_t
op_star
id|tu
op_assign
id|timeri-&gt;callback_data
suffix:semicolon
id|snd_timer_tread_t
id|r1
suffix:semicolon
r_if
c_cond
(paren
id|event
op_ge
id|SNDRV_TIMER_EVENT_START
op_logical_and
id|event
op_le
id|SNDRV_TIMER_EVENT_PAUSE
)paren
id|tu-&gt;tstamp
op_assign
op_star
id|tstamp
suffix:semicolon
r_if
c_cond
(paren
(paren
id|tu-&gt;filter
op_amp
(paren
l_int|1
op_lshift
id|event
)paren
)paren
op_eq
l_int|0
op_logical_or
op_logical_neg
id|tu-&gt;tread
)paren
r_return
suffix:semicolon
id|r1.event
op_assign
id|event
suffix:semicolon
id|r1.tstamp
op_assign
op_star
id|tstamp
suffix:semicolon
id|r1.val
op_assign
id|resolution
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|tu-&gt;qlock
)paren
suffix:semicolon
id|snd_timer_user_append_to_tqueue
c_func
(paren
id|tu
comma
op_amp
id|r1
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|tu-&gt;qlock
)paren
suffix:semicolon
)brace
DECL|function|snd_timer_user_tinterrupt
r_static
r_void
id|snd_timer_user_tinterrupt
c_func
(paren
id|snd_timer_instance_t
op_star
id|timeri
comma
r_int
r_int
id|resolution
comma
r_int
r_int
id|ticks
)paren
(brace
id|snd_timer_user_t
op_star
id|tu
op_assign
id|timeri-&gt;callback_data
suffix:semicolon
id|snd_timer_tread_t
op_star
id|r
comma
id|r1
suffix:semicolon
r_struct
id|timespec
id|tstamp
suffix:semicolon
r_int
id|prev
comma
id|append
op_assign
l_int|0
suffix:semicolon
id|snd_timestamp_zero
c_func
(paren
op_amp
id|tstamp
)paren
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|tu-&gt;qlock
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|tu-&gt;filter
op_amp
(paren
(paren
l_int|1
op_lshift
id|SNDRV_TIMER_EVENT_RESOLUTION
)paren
op_or
(paren
l_int|1
op_lshift
id|SNDRV_TIMER_EVENT_TICK
)paren
)paren
)paren
op_eq
l_int|0
)paren
(brace
id|spin_unlock
c_func
(paren
op_amp
id|tu-&gt;qlock
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|tu-&gt;last_resolution
op_ne
id|resolution
op_logical_or
id|ticks
OG
l_int|0
)paren
id|snd_timestamp_now
c_func
(paren
op_amp
id|tstamp
comma
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|tu-&gt;filter
op_amp
(paren
l_int|1
op_lshift
id|SNDRV_TIMER_EVENT_RESOLUTION
)paren
)paren
op_logical_and
id|tu-&gt;last_resolution
op_ne
id|resolution
)paren
(brace
id|r1.event
op_assign
id|SNDRV_TIMER_EVENT_RESOLUTION
suffix:semicolon
id|r1.tstamp
op_assign
id|tstamp
suffix:semicolon
id|r1.val
op_assign
id|resolution
suffix:semicolon
id|snd_timer_user_append_to_tqueue
c_func
(paren
id|tu
comma
op_amp
id|r1
)paren
suffix:semicolon
id|tu-&gt;last_resolution
op_assign
id|resolution
suffix:semicolon
id|append
op_increment
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|tu-&gt;filter
op_amp
(paren
l_int|1
op_lshift
id|SNDRV_TIMER_EVENT_TICK
)paren
)paren
op_eq
l_int|0
)paren
r_goto
id|__wake
suffix:semicolon
r_if
c_cond
(paren
id|ticks
op_eq
l_int|0
)paren
r_goto
id|__wake
suffix:semicolon
r_if
c_cond
(paren
id|tu-&gt;qused
OG
l_int|0
)paren
(brace
id|prev
op_assign
id|tu-&gt;qtail
op_eq
l_int|0
ques
c_cond
id|tu-&gt;queue_size
op_minus
l_int|1
suffix:colon
id|tu-&gt;qtail
op_minus
l_int|1
suffix:semicolon
id|r
op_assign
op_amp
id|tu-&gt;tqueue
(braket
id|prev
)braket
suffix:semicolon
r_if
c_cond
(paren
id|r-&gt;event
op_eq
id|SNDRV_TIMER_EVENT_TICK
)paren
(brace
id|r-&gt;tstamp
op_assign
id|tstamp
suffix:semicolon
id|r-&gt;val
op_add_assign
id|ticks
suffix:semicolon
id|append
op_increment
suffix:semicolon
r_goto
id|__wake
suffix:semicolon
)brace
)brace
id|r1.event
op_assign
id|SNDRV_TIMER_EVENT_TICK
suffix:semicolon
id|r1.tstamp
op_assign
id|tstamp
suffix:semicolon
id|r1.val
op_assign
id|ticks
suffix:semicolon
id|snd_timer_user_append_to_tqueue
c_func
(paren
id|tu
comma
op_amp
id|r1
)paren
suffix:semicolon
id|append
op_increment
suffix:semicolon
id|__wake
suffix:colon
id|spin_unlock
c_func
(paren
op_amp
id|tu-&gt;qlock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|append
op_eq
l_int|0
)paren
r_return
suffix:semicolon
id|kill_fasync
c_func
(paren
op_amp
id|tu-&gt;fasync
comma
id|SIGIO
comma
id|POLL_IN
)paren
suffix:semicolon
id|wake_up
c_func
(paren
op_amp
id|tu-&gt;qchange_sleep
)paren
suffix:semicolon
)brace
DECL|function|snd_timer_user_open
r_static
r_int
id|snd_timer_user_open
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
id|snd_timer_user_t
op_star
id|tu
suffix:semicolon
id|tu
op_assign
id|kcalloc
c_func
(paren
l_int|1
comma
r_sizeof
(paren
op_star
id|tu
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tu
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|spin_lock_init
c_func
(paren
op_amp
id|tu-&gt;qlock
)paren
suffix:semicolon
id|init_waitqueue_head
c_func
(paren
op_amp
id|tu-&gt;qchange_sleep
)paren
suffix:semicolon
id|tu-&gt;ticks
op_assign
l_int|1
suffix:semicolon
id|tu-&gt;queue_size
op_assign
l_int|128
suffix:semicolon
id|tu-&gt;queue
op_assign
(paren
id|snd_timer_read_t
op_star
)paren
id|kmalloc
c_func
(paren
id|tu-&gt;queue_size
op_star
r_sizeof
(paren
id|snd_timer_read_t
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tu-&gt;queue
op_eq
l_int|NULL
)paren
(brace
id|kfree
c_func
(paren
id|tu
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|file-&gt;private_data
op_assign
id|tu
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_timer_user_release
r_static
r_int
id|snd_timer_user_release
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
id|snd_timer_user_t
op_star
id|tu
suffix:semicolon
r_if
c_cond
(paren
id|file-&gt;private_data
)paren
(brace
id|tu
op_assign
id|file-&gt;private_data
suffix:semicolon
id|file-&gt;private_data
op_assign
l_int|NULL
suffix:semicolon
id|fasync_helper
c_func
(paren
op_minus
l_int|1
comma
id|file
comma
l_int|0
comma
op_amp
id|tu-&gt;fasync
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tu-&gt;timeri
)paren
id|snd_timer_close
c_func
(paren
id|tu-&gt;timeri
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|tu-&gt;queue
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|tu-&gt;tqueue
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|tu
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_timer_user_zero_id
r_static
r_void
id|snd_timer_user_zero_id
c_func
(paren
id|snd_timer_id_t
op_star
id|id
)paren
(brace
id|id-&gt;dev_class
op_assign
id|SNDRV_TIMER_CLASS_NONE
suffix:semicolon
id|id-&gt;dev_sclass
op_assign
id|SNDRV_TIMER_SCLASS_NONE
suffix:semicolon
id|id-&gt;card
op_assign
op_minus
l_int|1
suffix:semicolon
id|id-&gt;device
op_assign
op_minus
l_int|1
suffix:semicolon
id|id-&gt;subdevice
op_assign
op_minus
l_int|1
suffix:semicolon
)brace
DECL|function|snd_timer_user_copy_id
r_static
r_void
id|snd_timer_user_copy_id
c_func
(paren
id|snd_timer_id_t
op_star
id|id
comma
id|snd_timer_t
op_star
id|timer
)paren
(brace
id|id-&gt;dev_class
op_assign
id|timer-&gt;tmr_class
suffix:semicolon
id|id-&gt;dev_sclass
op_assign
id|SNDRV_TIMER_SCLASS_NONE
suffix:semicolon
id|id-&gt;card
op_assign
id|timer-&gt;card
ques
c_cond
id|timer-&gt;card-&gt;number
suffix:colon
op_minus
l_int|1
suffix:semicolon
id|id-&gt;device
op_assign
id|timer-&gt;tmr_device
suffix:semicolon
id|id-&gt;subdevice
op_assign
id|timer-&gt;tmr_subdevice
suffix:semicolon
)brace
DECL|function|snd_timer_user_next_device
r_static
r_int
id|snd_timer_user_next_device
c_func
(paren
id|snd_timer_id_t
id|__user
op_star
id|_tid
)paren
(brace
id|snd_timer_id_t
id|id
suffix:semicolon
id|snd_timer_t
op_star
id|timer
suffix:semicolon
r_struct
id|list_head
op_star
id|p
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|id
comma
id|_tid
comma
r_sizeof
(paren
id|id
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|down
c_func
(paren
op_amp
id|register_mutex
)paren
suffix:semicolon
r_if
c_cond
(paren
id|id.dev_class
OL
l_int|0
)paren
(brace
multiline_comment|/* first item */
r_if
c_cond
(paren
id|list_empty
c_func
(paren
op_amp
id|snd_timer_list
)paren
)paren
id|snd_timer_user_zero_id
c_func
(paren
op_amp
id|id
)paren
suffix:semicolon
r_else
(brace
id|timer
op_assign
(paren
id|snd_timer_t
op_star
)paren
id|list_entry
c_func
(paren
id|snd_timer_list.next
comma
id|snd_timer_t
comma
id|device_list
)paren
suffix:semicolon
id|snd_timer_user_copy_id
c_func
(paren
op_amp
id|id
comma
id|timer
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
r_switch
c_cond
(paren
id|id.dev_class
)paren
(brace
r_case
id|SNDRV_TIMER_CLASS_GLOBAL
suffix:colon
id|id.device
op_assign
id|id.device
OL
l_int|0
ques
c_cond
l_int|0
suffix:colon
id|id.device
op_plus
l_int|1
suffix:semicolon
id|list_for_each
c_func
(paren
id|p
comma
op_amp
id|snd_timer_list
)paren
(brace
id|timer
op_assign
(paren
id|snd_timer_t
op_star
)paren
id|list_entry
c_func
(paren
id|p
comma
id|snd_timer_t
comma
id|device_list
)paren
suffix:semicolon
r_if
c_cond
(paren
id|timer-&gt;tmr_class
OG
id|SNDRV_TIMER_CLASS_GLOBAL
)paren
(brace
id|snd_timer_user_copy_id
c_func
(paren
op_amp
id|id
comma
id|timer
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|timer-&gt;tmr_device
op_ge
id|id.device
)paren
(brace
id|snd_timer_user_copy_id
c_func
(paren
op_amp
id|id
comma
id|timer
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|p
op_eq
op_amp
id|snd_timer_list
)paren
id|snd_timer_user_zero_id
c_func
(paren
op_amp
id|id
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNDRV_TIMER_CLASS_CARD
suffix:colon
r_case
id|SNDRV_TIMER_CLASS_PCM
suffix:colon
r_if
c_cond
(paren
id|id.card
OL
l_int|0
)paren
(brace
id|id.card
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|id.card
OL
l_int|0
)paren
(brace
id|id.card
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|id.device
OL
l_int|0
)paren
(brace
id|id.device
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|id.subdevice
op_assign
id|id.subdevice
OL
l_int|0
ques
c_cond
l_int|0
suffix:colon
id|id.subdevice
op_plus
l_int|1
suffix:semicolon
)brace
)brace
)brace
id|list_for_each
c_func
(paren
id|p
comma
op_amp
id|snd_timer_list
)paren
(brace
id|timer
op_assign
(paren
id|snd_timer_t
op_star
)paren
id|list_entry
c_func
(paren
id|p
comma
id|snd_timer_t
comma
id|device_list
)paren
suffix:semicolon
r_if
c_cond
(paren
id|timer-&gt;tmr_class
OG
id|id.dev_class
)paren
(brace
id|snd_timer_user_copy_id
c_func
(paren
op_amp
id|id
comma
id|timer
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|timer-&gt;tmr_class
OL
id|id.dev_class
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|timer-&gt;card-&gt;number
OG
id|id.card
)paren
(brace
id|snd_timer_user_copy_id
c_func
(paren
op_amp
id|id
comma
id|timer
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|timer-&gt;card-&gt;number
OL
id|id.card
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|timer-&gt;tmr_device
OG
id|id.device
)paren
(brace
id|snd_timer_user_copy_id
c_func
(paren
op_amp
id|id
comma
id|timer
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|timer-&gt;tmr_device
OL
id|id.device
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|timer-&gt;tmr_subdevice
OG
id|id.subdevice
)paren
(brace
id|snd_timer_user_copy_id
c_func
(paren
op_amp
id|id
comma
id|timer
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|timer-&gt;tmr_subdevice
OL
id|id.subdevice
)paren
r_continue
suffix:semicolon
id|snd_timer_user_copy_id
c_func
(paren
op_amp
id|id
comma
id|timer
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|p
op_eq
op_amp
id|snd_timer_list
)paren
id|snd_timer_user_zero_id
c_func
(paren
op_amp
id|id
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|snd_timer_user_zero_id
c_func
(paren
op_amp
id|id
)paren
suffix:semicolon
)brace
)brace
id|up
c_func
(paren
op_amp
id|register_mutex
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|_tid
comma
op_amp
id|id
comma
r_sizeof
(paren
op_star
id|_tid
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_timer_user_ginfo
r_static
r_int
id|snd_timer_user_ginfo
c_func
(paren
r_struct
id|file
op_star
id|file
comma
id|snd_timer_ginfo_t
id|__user
op_star
id|_ginfo
)paren
(brace
id|snd_timer_ginfo_t
id|ginfo
suffix:semicolon
id|snd_timer_id_t
id|tid
suffix:semicolon
id|snd_timer_t
op_star
id|t
suffix:semicolon
r_struct
id|list_head
op_star
id|p
suffix:semicolon
r_int
id|err
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|ginfo
comma
id|_ginfo
comma
r_sizeof
(paren
id|ginfo
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|tid
op_assign
id|ginfo.tid
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|ginfo
comma
l_int|0
comma
r_sizeof
(paren
id|ginfo
)paren
)paren
suffix:semicolon
id|ginfo.tid
op_assign
id|tid
suffix:semicolon
id|down
c_func
(paren
op_amp
id|register_mutex
)paren
suffix:semicolon
id|t
op_assign
id|snd_timer_find
c_func
(paren
op_amp
id|tid
)paren
suffix:semicolon
r_if
c_cond
(paren
id|t
op_ne
l_int|NULL
)paren
(brace
id|ginfo.card
op_assign
id|t-&gt;card
ques
c_cond
id|t-&gt;card-&gt;number
suffix:colon
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|t-&gt;hw.flags
op_amp
id|SNDRV_TIMER_HW_SLAVE
)paren
id|ginfo.flags
op_or_assign
id|SNDRV_TIMER_FLG_SLAVE
suffix:semicolon
id|strlcpy
c_func
(paren
id|ginfo.id
comma
id|t-&gt;id
comma
r_sizeof
(paren
id|ginfo.id
)paren
)paren
suffix:semicolon
id|strlcpy
c_func
(paren
id|ginfo.name
comma
id|t-&gt;name
comma
r_sizeof
(paren
id|ginfo.name
)paren
)paren
suffix:semicolon
id|ginfo.resolution
op_assign
id|t-&gt;hw.resolution
suffix:semicolon
r_if
c_cond
(paren
id|t-&gt;hw.resolution_min
OG
l_int|0
)paren
(brace
id|ginfo.resolution_min
op_assign
id|t-&gt;hw.resolution_min
suffix:semicolon
id|ginfo.resolution_max
op_assign
id|t-&gt;hw.resolution_max
suffix:semicolon
)brace
id|list_for_each
c_func
(paren
id|p
comma
op_amp
id|t-&gt;open_list_head
)paren
(brace
id|ginfo.clients
op_increment
suffix:semicolon
)brace
)brace
r_else
(brace
id|err
op_assign
op_minus
id|ENODEV
suffix:semicolon
)brace
id|up
c_func
(paren
op_amp
id|register_mutex
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
op_ge
l_int|0
op_logical_and
id|copy_to_user
c_func
(paren
id|_ginfo
comma
op_amp
id|ginfo
comma
r_sizeof
(paren
id|ginfo
)paren
)paren
)paren
id|err
op_assign
op_minus
id|EFAULT
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|function|snd_timer_user_gparams
r_static
r_int
id|snd_timer_user_gparams
c_func
(paren
r_struct
id|file
op_star
id|file
comma
id|snd_timer_gparams_t
id|__user
op_star
id|_gparams
)paren
(brace
id|snd_timer_gparams_t
id|gparams
suffix:semicolon
id|snd_timer_t
op_star
id|t
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|gparams
comma
id|_gparams
comma
r_sizeof
(paren
id|gparams
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|down
c_func
(paren
op_amp
id|register_mutex
)paren
suffix:semicolon
id|t
op_assign
id|snd_timer_find
c_func
(paren
op_amp
id|gparams.tid
)paren
suffix:semicolon
r_if
c_cond
(paren
id|t
op_ne
l_int|NULL
)paren
(brace
r_if
c_cond
(paren
id|list_empty
c_func
(paren
op_amp
id|t-&gt;open_list_head
)paren
)paren
(brace
r_if
c_cond
(paren
id|t-&gt;hw.set_period
)paren
id|err
op_assign
id|t-&gt;hw
dot
id|set_period
c_func
(paren
id|t
comma
id|gparams.period_num
comma
id|gparams.period_den
)paren
suffix:semicolon
r_else
id|err
op_assign
op_minus
id|ENOSYS
suffix:semicolon
)brace
r_else
(brace
id|err
op_assign
op_minus
id|EBUSY
suffix:semicolon
)brace
)brace
r_else
(brace
id|err
op_assign
op_minus
id|ENODEV
suffix:semicolon
)brace
id|up
c_func
(paren
op_amp
id|register_mutex
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|function|snd_timer_user_gstatus
r_static
r_int
id|snd_timer_user_gstatus
c_func
(paren
r_struct
id|file
op_star
id|file
comma
id|snd_timer_gstatus_t
id|__user
op_star
id|_gstatus
)paren
(brace
id|snd_timer_gstatus_t
id|gstatus
suffix:semicolon
id|snd_timer_id_t
id|tid
suffix:semicolon
id|snd_timer_t
op_star
id|t
suffix:semicolon
r_int
id|err
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|gstatus
comma
id|_gstatus
comma
r_sizeof
(paren
id|gstatus
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|tid
op_assign
id|gstatus.tid
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|gstatus
comma
l_int|0
comma
r_sizeof
(paren
id|gstatus
)paren
)paren
suffix:semicolon
id|gstatus.tid
op_assign
id|tid
suffix:semicolon
id|down
c_func
(paren
op_amp
id|register_mutex
)paren
suffix:semicolon
id|t
op_assign
id|snd_timer_find
c_func
(paren
op_amp
id|tid
)paren
suffix:semicolon
r_if
c_cond
(paren
id|t
op_ne
l_int|NULL
)paren
(brace
r_if
c_cond
(paren
id|t-&gt;hw.c_resolution
)paren
id|gstatus.resolution
op_assign
id|t-&gt;hw
dot
id|c_resolution
c_func
(paren
id|t
)paren
suffix:semicolon
r_else
id|gstatus.resolution
op_assign
id|t-&gt;hw.resolution
suffix:semicolon
r_if
c_cond
(paren
id|t-&gt;hw.precise_resolution
)paren
(brace
id|t-&gt;hw
dot
id|precise_resolution
c_func
(paren
id|t
comma
op_amp
id|gstatus.resolution_num
comma
op_amp
id|gstatus.resolution_den
)paren
suffix:semicolon
)brace
r_else
(brace
id|gstatus.resolution_num
op_assign
id|gstatus.resolution
suffix:semicolon
id|gstatus.resolution_den
op_assign
l_int|1000000000uL
suffix:semicolon
)brace
)brace
r_else
(brace
id|err
op_assign
op_minus
id|ENODEV
suffix:semicolon
)brace
id|up
c_func
(paren
op_amp
id|register_mutex
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
op_ge
l_int|0
op_logical_and
id|copy_to_user
c_func
(paren
id|_gstatus
comma
op_amp
id|gstatus
comma
r_sizeof
(paren
id|gstatus
)paren
)paren
)paren
id|err
op_assign
op_minus
id|EFAULT
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|function|snd_timer_user_tselect
r_static
r_int
id|snd_timer_user_tselect
c_func
(paren
r_struct
id|file
op_star
id|file
comma
id|snd_timer_select_t
id|__user
op_star
id|_tselect
)paren
(brace
id|snd_timer_user_t
op_star
id|tu
suffix:semicolon
id|snd_timer_select_t
id|tselect
suffix:semicolon
r_char
id|str
(braket
l_int|32
)braket
suffix:semicolon
r_int
id|err
suffix:semicolon
id|tu
op_assign
id|file-&gt;private_data
suffix:semicolon
r_if
c_cond
(paren
id|tu-&gt;timeri
)paren
id|snd_timer_close
c_func
(paren
id|tu-&gt;timeri
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|tselect
comma
id|_tselect
comma
r_sizeof
(paren
id|tselect
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|sprintf
c_func
(paren
id|str
comma
l_string|&quot;application %i&quot;
comma
id|current-&gt;pid
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tselect.id.dev_class
op_ne
id|SNDRV_TIMER_CLASS_SLAVE
)paren
id|tselect.id.dev_sclass
op_assign
id|SNDRV_TIMER_SCLASS_APPLICATION
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_timer_open
c_func
(paren
op_amp
id|tu-&gt;timeri
comma
id|str
comma
op_amp
id|tselect.id
comma
id|current-&gt;pid
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_if
c_cond
(paren
id|tu-&gt;queue
)paren
(brace
id|kfree
c_func
(paren
id|tu-&gt;queue
)paren
suffix:semicolon
id|tu-&gt;queue
op_assign
l_int|NULL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|tu-&gt;tqueue
)paren
(brace
id|kfree
c_func
(paren
id|tu-&gt;tqueue
)paren
suffix:semicolon
id|tu-&gt;tqueue
op_assign
l_int|NULL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|tu-&gt;tread
)paren
(brace
id|tu-&gt;tqueue
op_assign
(paren
id|snd_timer_tread_t
op_star
)paren
id|kmalloc
c_func
(paren
id|tu-&gt;queue_size
op_star
r_sizeof
(paren
id|snd_timer_tread_t
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tu-&gt;tqueue
op_eq
l_int|NULL
)paren
(brace
id|snd_timer_close
c_func
(paren
id|tu-&gt;timeri
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
)brace
r_else
(brace
id|tu-&gt;queue
op_assign
(paren
id|snd_timer_read_t
op_star
)paren
id|kmalloc
c_func
(paren
id|tu-&gt;queue_size
op_star
r_sizeof
(paren
id|snd_timer_read_t
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tu-&gt;queue
op_eq
l_int|NULL
)paren
(brace
id|snd_timer_close
c_func
(paren
id|tu-&gt;timeri
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
)brace
id|tu-&gt;timeri-&gt;flags
op_or_assign
id|SNDRV_TIMER_IFLG_FAST
suffix:semicolon
id|tu-&gt;timeri-&gt;callback
op_assign
id|tu-&gt;tread
ques
c_cond
id|snd_timer_user_tinterrupt
suffix:colon
id|snd_timer_user_interrupt
suffix:semicolon
id|tu-&gt;timeri-&gt;ccallback
op_assign
id|snd_timer_user_ccallback
suffix:semicolon
id|tu-&gt;timeri-&gt;callback_data
op_assign
(paren
r_void
op_star
)paren
id|tu
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_timer_user_info
r_static
r_int
id|snd_timer_user_info
c_func
(paren
r_struct
id|file
op_star
id|file
comma
id|snd_timer_info_t
id|__user
op_star
id|_info
)paren
(brace
id|snd_timer_user_t
op_star
id|tu
suffix:semicolon
id|snd_timer_info_t
id|info
suffix:semicolon
id|snd_timer_t
op_star
id|t
suffix:semicolon
id|tu
op_assign
id|file-&gt;private_data
suffix:semicolon
id|snd_assert
c_func
(paren
id|tu-&gt;timeri
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|t
op_assign
id|tu-&gt;timeri-&gt;timer
suffix:semicolon
id|snd_assert
c_func
(paren
id|t
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|info
comma
l_int|0
comma
r_sizeof
(paren
id|info
)paren
)paren
suffix:semicolon
id|info.card
op_assign
id|t-&gt;card
ques
c_cond
id|t-&gt;card-&gt;number
suffix:colon
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|t-&gt;hw.flags
op_amp
id|SNDRV_TIMER_HW_SLAVE
)paren
id|info.flags
op_or_assign
id|SNDRV_TIMER_FLG_SLAVE
suffix:semicolon
id|strlcpy
c_func
(paren
id|info.id
comma
id|t-&gt;id
comma
r_sizeof
(paren
id|info.id
)paren
)paren
suffix:semicolon
id|strlcpy
c_func
(paren
id|info.name
comma
id|t-&gt;name
comma
r_sizeof
(paren
id|info.name
)paren
)paren
suffix:semicolon
id|info.resolution
op_assign
id|t-&gt;hw.resolution
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|_info
comma
op_amp
id|info
comma
r_sizeof
(paren
op_star
id|_info
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_timer_user_params
r_static
r_int
id|snd_timer_user_params
c_func
(paren
r_struct
id|file
op_star
id|file
comma
id|snd_timer_params_t
id|__user
op_star
id|_params
)paren
(brace
id|snd_timer_user_t
op_star
id|tu
suffix:semicolon
id|snd_timer_params_t
id|params
suffix:semicolon
id|snd_timer_t
op_star
id|t
suffix:semicolon
id|snd_timer_read_t
op_star
id|tr
suffix:semicolon
id|snd_timer_tread_t
op_star
id|ttr
suffix:semicolon
r_int
id|err
suffix:semicolon
id|tu
op_assign
id|file-&gt;private_data
suffix:semicolon
id|snd_assert
c_func
(paren
id|tu-&gt;timeri
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|t
op_assign
id|tu-&gt;timeri-&gt;timer
suffix:semicolon
id|snd_assert
c_func
(paren
id|t
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|params
comma
id|_params
comma
r_sizeof
(paren
id|params
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|t-&gt;hw.flags
op_amp
id|SNDRV_TIMER_HW_SLAVE
)paren
op_logical_and
id|params.ticks
OL
l_int|1
)paren
(brace
id|err
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_goto
id|_end
suffix:semicolon
)brace
r_if
c_cond
(paren
id|params.queue_size
OG
l_int|0
op_logical_and
(paren
id|params.queue_size
template_param
l_int|1024
)paren
)paren
(brace
id|err
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_goto
id|_end
suffix:semicolon
)brace
r_if
c_cond
(paren
id|params.filter
op_amp
op_complement
(paren
(paren
l_int|1
op_lshift
id|SNDRV_TIMER_EVENT_RESOLUTION
)paren
op_or
(paren
l_int|1
op_lshift
id|SNDRV_TIMER_EVENT_TICK
)paren
op_or
(paren
l_int|1
op_lshift
id|SNDRV_TIMER_EVENT_START
)paren
op_or
(paren
l_int|1
op_lshift
id|SNDRV_TIMER_EVENT_STOP
)paren
op_or
(paren
l_int|1
op_lshift
id|SNDRV_TIMER_EVENT_CONTINUE
)paren
op_or
(paren
l_int|1
op_lshift
id|SNDRV_TIMER_EVENT_PAUSE
)paren
op_or
(paren
l_int|1
op_lshift
id|SNDRV_TIMER_EVENT_MSTART
)paren
op_or
(paren
l_int|1
op_lshift
id|SNDRV_TIMER_EVENT_MSTOP
)paren
op_or
(paren
l_int|1
op_lshift
id|SNDRV_TIMER_EVENT_MCONTINUE
)paren
op_or
(paren
l_int|1
op_lshift
id|SNDRV_TIMER_EVENT_MPAUSE
)paren
)paren
)paren
(brace
id|err
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_goto
id|_end
suffix:semicolon
)brace
id|snd_timer_stop
c_func
(paren
id|tu-&gt;timeri
)paren
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|t-&gt;lock
)paren
suffix:semicolon
id|tu-&gt;timeri-&gt;flags
op_and_assign
op_complement
(paren
id|SNDRV_TIMER_IFLG_AUTO
op_or
id|SNDRV_TIMER_IFLG_EXCLUSIVE
op_or
id|SNDRV_TIMER_IFLG_EARLY_EVENT
)paren
suffix:semicolon
r_if
c_cond
(paren
id|params.flags
op_amp
id|SNDRV_TIMER_PSFLG_AUTO
)paren
id|tu-&gt;timeri-&gt;flags
op_or_assign
id|SNDRV_TIMER_IFLG_AUTO
suffix:semicolon
r_if
c_cond
(paren
id|params.flags
op_amp
id|SNDRV_TIMER_PSFLG_EXCLUSIVE
)paren
id|tu-&gt;timeri-&gt;flags
op_or_assign
id|SNDRV_TIMER_IFLG_EXCLUSIVE
suffix:semicolon
r_if
c_cond
(paren
id|params.flags
op_amp
id|SNDRV_TIMER_PSFLG_EARLY_EVENT
)paren
id|tu-&gt;timeri-&gt;flags
op_or_assign
id|SNDRV_TIMER_IFLG_EARLY_EVENT
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|t-&gt;lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|params.queue_size
OG
l_int|0
op_logical_and
(paren
r_int
r_int
)paren
id|tu-&gt;queue_size
op_ne
id|params.queue_size
)paren
(brace
r_if
c_cond
(paren
id|tu-&gt;tread
)paren
(brace
id|ttr
op_assign
(paren
id|snd_timer_tread_t
op_star
)paren
id|kmalloc
c_func
(paren
id|params.queue_size
op_star
r_sizeof
(paren
id|snd_timer_tread_t
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ttr
)paren
(brace
id|kfree
c_func
(paren
id|tu-&gt;tqueue
)paren
suffix:semicolon
id|tu-&gt;queue_size
op_assign
id|params.queue_size
suffix:semicolon
id|tu-&gt;tqueue
op_assign
id|ttr
suffix:semicolon
)brace
)brace
r_else
(brace
id|tr
op_assign
(paren
id|snd_timer_read_t
op_star
)paren
id|kmalloc
c_func
(paren
id|params.queue_size
op_star
r_sizeof
(paren
id|snd_timer_read_t
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tr
)paren
(brace
id|kfree
c_func
(paren
id|tu-&gt;queue
)paren
suffix:semicolon
id|tu-&gt;queue_size
op_assign
id|params.queue_size
suffix:semicolon
id|tu-&gt;queue
op_assign
id|tr
suffix:semicolon
)brace
)brace
)brace
id|tu-&gt;qhead
op_assign
id|tu-&gt;qtail
op_assign
id|tu-&gt;qused
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|tu-&gt;timeri-&gt;flags
op_amp
id|SNDRV_TIMER_IFLG_EARLY_EVENT
)paren
(brace
r_if
c_cond
(paren
id|tu-&gt;tread
)paren
(brace
id|snd_timer_tread_t
id|tread
suffix:semicolon
id|tread.event
op_assign
id|SNDRV_TIMER_EVENT_EARLY
suffix:semicolon
id|tread.tstamp.tv_sec
op_assign
l_int|0
suffix:semicolon
id|tread.tstamp.tv_nsec
op_assign
l_int|0
suffix:semicolon
id|tread.val
op_assign
l_int|0
suffix:semicolon
id|snd_timer_user_append_to_tqueue
c_func
(paren
id|tu
comma
op_amp
id|tread
)paren
suffix:semicolon
)brace
r_else
(brace
id|snd_timer_read_t
op_star
id|r
op_assign
op_amp
id|tu-&gt;queue
(braket
l_int|0
)braket
suffix:semicolon
id|r-&gt;resolution
op_assign
l_int|0
suffix:semicolon
id|r-&gt;ticks
op_assign
l_int|0
suffix:semicolon
id|tu-&gt;qused
op_increment
suffix:semicolon
id|tu-&gt;qtail
op_increment
suffix:semicolon
)brace
)brace
id|tu-&gt;filter
op_assign
id|params.filter
suffix:semicolon
id|tu-&gt;ticks
op_assign
id|params.ticks
suffix:semicolon
id|err
op_assign
l_int|0
suffix:semicolon
id|_end
suffix:colon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|_params
comma
op_amp
id|params
comma
r_sizeof
(paren
id|params
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|function|snd_timer_user_status
r_static
r_int
id|snd_timer_user_status
c_func
(paren
r_struct
id|file
op_star
id|file
comma
id|snd_timer_status_t
id|__user
op_star
id|_status
)paren
(brace
id|snd_timer_user_t
op_star
id|tu
suffix:semicolon
id|snd_timer_status_t
id|status
suffix:semicolon
id|tu
op_assign
id|file-&gt;private_data
suffix:semicolon
id|snd_assert
c_func
(paren
id|tu-&gt;timeri
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|status
comma
l_int|0
comma
r_sizeof
(paren
id|status
)paren
)paren
suffix:semicolon
id|status.tstamp
op_assign
id|tu-&gt;tstamp
suffix:semicolon
id|status.resolution
op_assign
id|snd_timer_resolution
c_func
(paren
id|tu-&gt;timeri
)paren
suffix:semicolon
id|status.lost
op_assign
id|tu-&gt;timeri-&gt;lost
suffix:semicolon
id|status.overrun
op_assign
id|tu-&gt;overrun
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|tu-&gt;qlock
)paren
suffix:semicolon
id|status.queue
op_assign
id|tu-&gt;qused
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|tu-&gt;qlock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|_status
comma
op_amp
id|status
comma
r_sizeof
(paren
id|status
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_timer_user_start
r_static
r_int
id|snd_timer_user_start
c_func
(paren
r_struct
id|file
op_star
id|file
)paren
(brace
r_int
id|err
suffix:semicolon
id|snd_timer_user_t
op_star
id|tu
suffix:semicolon
id|tu
op_assign
id|file-&gt;private_data
suffix:semicolon
id|snd_assert
c_func
(paren
id|tu-&gt;timeri
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|snd_timer_stop
c_func
(paren
id|tu-&gt;timeri
)paren
suffix:semicolon
id|tu-&gt;timeri-&gt;lost
op_assign
l_int|0
suffix:semicolon
id|tu-&gt;last_resolution
op_assign
l_int|0
suffix:semicolon
r_return
(paren
id|err
op_assign
id|snd_timer_start
c_func
(paren
id|tu-&gt;timeri
comma
id|tu-&gt;ticks
)paren
)paren
OL
l_int|0
ques
c_cond
id|err
suffix:colon
l_int|0
suffix:semicolon
)brace
DECL|function|snd_timer_user_stop
r_static
r_int
id|snd_timer_user_stop
c_func
(paren
r_struct
id|file
op_star
id|file
)paren
(brace
r_int
id|err
suffix:semicolon
id|snd_timer_user_t
op_star
id|tu
suffix:semicolon
id|tu
op_assign
id|file-&gt;private_data
suffix:semicolon
id|snd_assert
c_func
(paren
id|tu-&gt;timeri
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
r_return
(paren
id|err
op_assign
id|snd_timer_stop
c_func
(paren
id|tu-&gt;timeri
)paren
)paren
OL
l_int|0
ques
c_cond
id|err
suffix:colon
l_int|0
suffix:semicolon
)brace
DECL|function|snd_timer_user_continue
r_static
r_int
id|snd_timer_user_continue
c_func
(paren
r_struct
id|file
op_star
id|file
)paren
(brace
r_int
id|err
suffix:semicolon
id|snd_timer_user_t
op_star
id|tu
suffix:semicolon
id|tu
op_assign
id|file-&gt;private_data
suffix:semicolon
id|snd_assert
c_func
(paren
id|tu-&gt;timeri
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|tu-&gt;timeri-&gt;lost
op_assign
l_int|0
suffix:semicolon
r_return
(paren
id|err
op_assign
id|snd_timer_continue
c_func
(paren
id|tu-&gt;timeri
)paren
)paren
OL
l_int|0
ques
c_cond
id|err
suffix:colon
l_int|0
suffix:semicolon
)brace
DECL|function|_snd_timer_user_ioctl
r_static
r_inline
r_int
id|_snd_timer_user_ioctl
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
comma
r_int
r_int
id|cmd
comma
r_int
r_int
id|arg
)paren
(brace
id|snd_timer_user_t
op_star
id|tu
suffix:semicolon
r_void
id|__user
op_star
id|argp
op_assign
(paren
r_void
id|__user
op_star
)paren
id|arg
suffix:semicolon
r_int
id|__user
op_star
id|p
op_assign
id|argp
suffix:semicolon
id|tu
op_assign
id|file-&gt;private_data
suffix:semicolon
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|SNDRV_TIMER_IOCTL_PVERSION
suffix:colon
r_return
id|put_user
c_func
(paren
id|SNDRV_TIMER_VERSION
comma
id|p
)paren
ques
c_cond
op_minus
id|EFAULT
suffix:colon
l_int|0
suffix:semicolon
r_case
id|SNDRV_TIMER_IOCTL_NEXT_DEVICE
suffix:colon
r_return
id|snd_timer_user_next_device
c_func
(paren
id|argp
)paren
suffix:semicolon
r_case
id|SNDRV_TIMER_IOCTL_TREAD
suffix:colon
(brace
r_int
id|xarg
suffix:semicolon
r_if
c_cond
(paren
id|tu-&gt;timeri
)paren
multiline_comment|/* too late */
r_return
op_minus
id|EBUSY
suffix:semicolon
r_if
c_cond
(paren
id|get_user
c_func
(paren
id|xarg
comma
id|p
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|tu-&gt;tread
op_assign
id|xarg
ques
c_cond
l_int|1
suffix:colon
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_case
id|SNDRV_TIMER_IOCTL_GINFO
suffix:colon
r_return
id|snd_timer_user_ginfo
c_func
(paren
id|file
comma
id|argp
)paren
suffix:semicolon
r_case
id|SNDRV_TIMER_IOCTL_GPARAMS
suffix:colon
r_return
id|snd_timer_user_gparams
c_func
(paren
id|file
comma
id|argp
)paren
suffix:semicolon
r_case
id|SNDRV_TIMER_IOCTL_GSTATUS
suffix:colon
r_return
id|snd_timer_user_gstatus
c_func
(paren
id|file
comma
id|argp
)paren
suffix:semicolon
r_case
id|SNDRV_TIMER_IOCTL_SELECT
suffix:colon
r_return
id|snd_timer_user_tselect
c_func
(paren
id|file
comma
id|argp
)paren
suffix:semicolon
r_case
id|SNDRV_TIMER_IOCTL_INFO
suffix:colon
r_return
id|snd_timer_user_info
c_func
(paren
id|file
comma
id|argp
)paren
suffix:semicolon
r_case
id|SNDRV_TIMER_IOCTL_PARAMS
suffix:colon
r_return
id|snd_timer_user_params
c_func
(paren
id|file
comma
id|argp
)paren
suffix:semicolon
r_case
id|SNDRV_TIMER_IOCTL_STATUS
suffix:colon
r_return
id|snd_timer_user_status
c_func
(paren
id|file
comma
id|argp
)paren
suffix:semicolon
r_case
id|SNDRV_TIMER_IOCTL_START
suffix:colon
r_return
id|snd_timer_user_start
c_func
(paren
id|file
)paren
suffix:semicolon
r_case
id|SNDRV_TIMER_IOCTL_STOP
suffix:colon
r_return
id|snd_timer_user_stop
c_func
(paren
id|file
)paren
suffix:semicolon
r_case
id|SNDRV_TIMER_IOCTL_CONTINUE
suffix:colon
r_return
id|snd_timer_user_continue
c_func
(paren
id|file
)paren
suffix:semicolon
)brace
r_return
op_minus
id|ENOTTY
suffix:semicolon
)brace
multiline_comment|/* FIXME: need to unlock BKL to allow preemption */
DECL|function|snd_timer_user_ioctl
r_static
r_int
id|snd_timer_user_ioctl
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
comma
r_int
r_int
id|cmd
comma
r_int
r_int
id|arg
)paren
(brace
r_int
id|err
suffix:semicolon
id|unlock_kernel
c_func
(paren
)paren
suffix:semicolon
id|err
op_assign
id|_snd_timer_user_ioctl
c_func
(paren
id|inode
comma
id|file
comma
id|cmd
comma
id|arg
)paren
suffix:semicolon
id|lock_kernel
c_func
(paren
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|function|snd_timer_user_fasync
r_static
r_int
id|snd_timer_user_fasync
c_func
(paren
r_int
id|fd
comma
r_struct
id|file
op_star
id|file
comma
r_int
id|on
)paren
(brace
id|snd_timer_user_t
op_star
id|tu
suffix:semicolon
r_int
id|err
suffix:semicolon
id|tu
op_assign
id|file-&gt;private_data
suffix:semicolon
id|err
op_assign
id|fasync_helper
c_func
(paren
id|fd
comma
id|file
comma
id|on
comma
op_amp
id|tu-&gt;fasync
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_timer_user_read
r_static
id|ssize_t
id|snd_timer_user_read
c_func
(paren
r_struct
id|file
op_star
id|file
comma
r_char
id|__user
op_star
id|buffer
comma
r_int
id|count
comma
id|loff_t
op_star
id|offset
)paren
(brace
id|snd_timer_user_t
op_star
id|tu
suffix:semicolon
r_int
id|result
op_assign
l_int|0
comma
id|unit
suffix:semicolon
r_int
id|err
op_assign
l_int|0
suffix:semicolon
id|tu
op_assign
id|file-&gt;private_data
suffix:semicolon
id|unit
op_assign
id|tu-&gt;tread
ques
c_cond
r_sizeof
(paren
id|snd_timer_tread_t
)paren
suffix:colon
r_sizeof
(paren
id|snd_timer_read_t
)paren
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|tu-&gt;qlock
)paren
suffix:semicolon
r_while
c_loop
(paren
(paren
r_int
)paren
id|count
op_minus
id|result
op_ge
id|unit
)paren
(brace
r_while
c_loop
(paren
op_logical_neg
id|tu-&gt;qused
)paren
(brace
id|wait_queue_t
id|wait
suffix:semicolon
r_if
c_cond
(paren
(paren
id|file-&gt;f_flags
op_amp
id|O_NONBLOCK
)paren
op_ne
l_int|0
op_logical_or
id|result
OG
l_int|0
)paren
(brace
id|err
op_assign
op_minus
id|EAGAIN
suffix:semicolon
r_break
suffix:semicolon
)brace
id|set_current_state
c_func
(paren
id|TASK_INTERRUPTIBLE
)paren
suffix:semicolon
id|init_waitqueue_entry
c_func
(paren
op_amp
id|wait
comma
id|current
)paren
suffix:semicolon
id|add_wait_queue
c_func
(paren
op_amp
id|tu-&gt;qchange_sleep
comma
op_amp
id|wait
)paren
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|tu-&gt;qlock
)paren
suffix:semicolon
id|schedule
c_func
(paren
)paren
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|tu-&gt;qlock
)paren
suffix:semicolon
id|remove_wait_queue
c_func
(paren
op_amp
id|tu-&gt;qchange_sleep
comma
op_amp
id|wait
)paren
suffix:semicolon
r_if
c_cond
(paren
id|signal_pending
c_func
(paren
id|current
)paren
)paren
(brace
id|err
op_assign
op_minus
id|ERESTARTSYS
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
id|spin_unlock_irq
c_func
(paren
op_amp
id|tu-&gt;qlock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_goto
id|_error
suffix:semicolon
r_if
c_cond
(paren
id|tu-&gt;tread
)paren
(brace
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|buffer
comma
op_amp
id|tu-&gt;tqueue
(braket
id|tu-&gt;qhead
op_increment
)braket
comma
r_sizeof
(paren
id|snd_timer_tread_t
)paren
)paren
)paren
(brace
id|err
op_assign
op_minus
id|EFAULT
suffix:semicolon
r_goto
id|_error
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|buffer
comma
op_amp
id|tu-&gt;queue
(braket
id|tu-&gt;qhead
op_increment
)braket
comma
r_sizeof
(paren
id|snd_timer_read_t
)paren
)paren
)paren
(brace
id|err
op_assign
op_minus
id|EFAULT
suffix:semicolon
r_goto
id|_error
suffix:semicolon
)brace
)brace
id|tu-&gt;qhead
op_mod_assign
id|tu-&gt;queue_size
suffix:semicolon
id|result
op_add_assign
id|unit
suffix:semicolon
id|buffer
op_add_assign
id|unit
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|tu-&gt;qlock
)paren
suffix:semicolon
id|tu-&gt;qused
op_decrement
suffix:semicolon
)brace
id|spin_unlock_irq
c_func
(paren
op_amp
id|tu-&gt;qlock
)paren
suffix:semicolon
id|_error
suffix:colon
r_return
id|result
OG
l_int|0
ques
c_cond
id|result
suffix:colon
id|err
suffix:semicolon
)brace
DECL|function|snd_timer_user_poll
r_static
r_int
r_int
id|snd_timer_user_poll
c_func
(paren
r_struct
id|file
op_star
id|file
comma
id|poll_table
op_star
id|wait
)paren
(brace
r_int
r_int
id|mask
suffix:semicolon
id|snd_timer_user_t
op_star
id|tu
suffix:semicolon
id|tu
op_assign
id|file-&gt;private_data
suffix:semicolon
id|poll_wait
c_func
(paren
id|file
comma
op_amp
id|tu-&gt;qchange_sleep
comma
id|wait
)paren
suffix:semicolon
id|mask
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|tu-&gt;qused
)paren
id|mask
op_or_assign
id|POLLIN
op_or
id|POLLRDNORM
suffix:semicolon
r_return
id|mask
suffix:semicolon
)brace
DECL|variable|snd_timer_f_ops
r_static
r_struct
id|file_operations
id|snd_timer_f_ops
op_assign
(brace
dot
id|owner
op_assign
id|THIS_MODULE
comma
dot
id|read
op_assign
id|snd_timer_user_read
comma
dot
id|open
op_assign
id|snd_timer_user_open
comma
dot
id|release
op_assign
id|snd_timer_user_release
comma
dot
id|poll
op_assign
id|snd_timer_user_poll
comma
dot
id|ioctl
op_assign
id|snd_timer_user_ioctl
comma
dot
id|fasync
op_assign
id|snd_timer_user_fasync
comma
)brace
suffix:semicolon
DECL|variable|snd_timer_reg
r_static
id|snd_minor_t
id|snd_timer_reg
op_assign
(brace
dot
id|comment
op_assign
l_string|&quot;timer&quot;
comma
dot
id|f_ops
op_assign
op_amp
id|snd_timer_f_ops
comma
)brace
suffix:semicolon
multiline_comment|/*&n; *  ENTRY functions&n; */
DECL|variable|snd_timer_proc_entry
r_static
id|snd_info_entry_t
op_star
id|snd_timer_proc_entry
op_assign
l_int|NULL
suffix:semicolon
DECL|function|alsa_timer_init
r_static
r_int
id|__init
id|alsa_timer_init
c_func
(paren
r_void
)paren
(brace
r_int
id|err
suffix:semicolon
id|snd_info_entry_t
op_star
id|entry
suffix:semicolon
macro_line|#ifdef SNDRV_OSS_INFO_DEV_TIMERS
id|snd_oss_info_register
c_func
(paren
id|SNDRV_OSS_INFO_DEV_TIMERS
comma
id|SNDRV_CARDS
op_minus
l_int|1
comma
l_string|&quot;system timer&quot;
)paren
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
(paren
id|entry
op_assign
id|snd_info_create_module_entry
c_func
(paren
id|THIS_MODULE
comma
l_string|&quot;timers&quot;
comma
l_int|NULL
)paren
)paren
op_ne
l_int|NULL
)paren
(brace
id|entry-&gt;c.text.read_size
op_assign
id|SNDRV_TIMER_DEVICES
op_star
l_int|128
suffix:semicolon
id|entry-&gt;c.text.read
op_assign
id|snd_timer_proc_read
suffix:semicolon
r_if
c_cond
(paren
id|snd_info_register
c_func
(paren
id|entry
)paren
OL
l_int|0
)paren
(brace
id|snd_info_free_entry
c_func
(paren
id|entry
)paren
suffix:semicolon
id|entry
op_assign
l_int|NULL
suffix:semicolon
)brace
)brace
id|snd_timer_proc_entry
op_assign
id|entry
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_timer_register_system
c_func
(paren
)paren
)paren
OL
l_int|0
)paren
id|snd_printk
c_func
(paren
id|KERN_ERR
l_string|&quot;unable to register system timer (%i)&bslash;n&quot;
comma
id|err
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_register_device
c_func
(paren
id|SNDRV_DEVICE_TYPE_TIMER
comma
l_int|NULL
comma
l_int|0
comma
op_amp
id|snd_timer_reg
comma
l_string|&quot;timer&quot;
)paren
)paren
OL
l_int|0
)paren
id|snd_printk
c_func
(paren
id|KERN_ERR
l_string|&quot;unable to register timer device (%i)&bslash;n&quot;
comma
id|err
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|alsa_timer_exit
r_static
r_void
id|__exit
id|alsa_timer_exit
c_func
(paren
r_void
)paren
(brace
r_struct
id|list_head
op_star
id|p
comma
op_star
id|n
suffix:semicolon
id|snd_unregister_device
c_func
(paren
id|SNDRV_DEVICE_TYPE_TIMER
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
multiline_comment|/* unregister the system timer */
id|list_for_each_safe
c_func
(paren
id|p
comma
id|n
comma
op_amp
id|snd_timer_list
)paren
(brace
id|snd_timer_t
op_star
id|timer
op_assign
(paren
id|snd_timer_t
op_star
)paren
id|list_entry
c_func
(paren
id|p
comma
id|snd_timer_t
comma
id|device_list
)paren
suffix:semicolon
id|snd_timer_unregister
c_func
(paren
id|timer
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|snd_timer_proc_entry
)paren
(brace
id|snd_info_unregister
c_func
(paren
id|snd_timer_proc_entry
)paren
suffix:semicolon
id|snd_timer_proc_entry
op_assign
l_int|NULL
suffix:semicolon
)brace
macro_line|#ifdef SNDRV_OSS_INFO_DEV_TIMERS
id|snd_oss_info_unregister
c_func
(paren
id|SNDRV_OSS_INFO_DEV_TIMERS
comma
id|SNDRV_CARDS
op_minus
l_int|1
)paren
suffix:semicolon
macro_line|#endif
)brace
id|module_init
c_func
(paren
id|alsa_timer_init
)paren
id|module_exit
c_func
(paren
id|alsa_timer_exit
)paren
id|EXPORT_SYMBOL
c_func
(paren
id|snd_timer_open
)paren
suffix:semicolon
DECL|variable|EXPORT_SYMBOL
id|EXPORT_SYMBOL
c_func
(paren
id|snd_timer_close
)paren
suffix:semicolon
DECL|variable|snd_timer_resolution
id|EXPORT_SYMBOL
c_func
(paren
id|snd_timer_resolution
)paren
suffix:semicolon
DECL|variable|snd_timer_start
id|EXPORT_SYMBOL
c_func
(paren
id|snd_timer_start
)paren
suffix:semicolon
DECL|variable|snd_timer_stop
id|EXPORT_SYMBOL
c_func
(paren
id|snd_timer_stop
)paren
suffix:semicolon
DECL|variable|snd_timer_continue
id|EXPORT_SYMBOL
c_func
(paren
id|snd_timer_continue
)paren
suffix:semicolon
DECL|variable|snd_timer_pause
id|EXPORT_SYMBOL
c_func
(paren
id|snd_timer_pause
)paren
suffix:semicolon
DECL|variable|snd_timer_new
id|EXPORT_SYMBOL
c_func
(paren
id|snd_timer_new
)paren
suffix:semicolon
DECL|variable|snd_timer_notify
id|EXPORT_SYMBOL
c_func
(paren
id|snd_timer_notify
)paren
suffix:semicolon
DECL|variable|snd_timer_global_new
id|EXPORT_SYMBOL
c_func
(paren
id|snd_timer_global_new
)paren
suffix:semicolon
DECL|variable|snd_timer_global_free
id|EXPORT_SYMBOL
c_func
(paren
id|snd_timer_global_free
)paren
suffix:semicolon
DECL|variable|snd_timer_global_register
id|EXPORT_SYMBOL
c_func
(paren
id|snd_timer_global_register
)paren
suffix:semicolon
DECL|variable|snd_timer_global_unregister
id|EXPORT_SYMBOL
c_func
(paren
id|snd_timer_global_unregister
)paren
suffix:semicolon
DECL|variable|snd_timer_interrupt
id|EXPORT_SYMBOL
c_func
(paren
id|snd_timer_interrupt
)paren
suffix:semicolon
DECL|variable|snd_timer_system_resolution
id|EXPORT_SYMBOL
c_func
(paren
id|snd_timer_system_resolution
)paren
suffix:semicolon
eof
