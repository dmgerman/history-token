multiline_comment|/*&n; *  Digital Audio (PCM) abstract layer&n; *  Copyright (c) by Jaroslav Kysela &lt;perex@suse.cz&gt;&n; *&n; *&n; *   This program is free software; you can redistribute it and/or modify&n; *   it under the terms of the GNU General Public License as published by&n; *   the Free Software Foundation; either version 2 of the License, or&n; *   (at your option) any later version.&n; *&n; *   This program is distributed in the hope that it will be useful,&n; *   but WITHOUT ANY WARRANTY; without even the implied warranty of&n; *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; *   GNU General Public License for more details.&n; *&n; *   You should have received a copy of the GNU General Public License&n; *   along with this program; if not, write to the Free Software&n; *   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA&n; *&n; */
macro_line|#include &lt;sound/driver.h&gt;
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;linux/smp_lock.h&gt;
macro_line|#include &lt;linux/file.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;linux/time.h&gt;
macro_line|#include &lt;linux/uio.h&gt;
macro_line|#include &lt;sound/core.h&gt;
macro_line|#include &lt;sound/control.h&gt;
macro_line|#include &lt;sound/info.h&gt;
macro_line|#include &lt;sound/pcm.h&gt;
macro_line|#include &lt;sound/pcm_params.h&gt;
macro_line|#include &lt;sound/timer.h&gt;
macro_line|#include &lt;sound/minors.h&gt;
macro_line|#include &lt;asm/io.h&gt;
multiline_comment|/*&n; *  Compatibility&n; */
DECL|struct|sndrv_pcm_hw_params_old
r_struct
id|sndrv_pcm_hw_params_old
(brace
DECL|member|flags
r_int
r_int
id|flags
suffix:semicolon
DECL|member|masks
r_int
r_int
id|masks
(braket
id|SNDRV_PCM_HW_PARAM_SUBFORMAT
op_minus
id|SNDRV_PCM_HW_PARAM_ACCESS
op_plus
l_int|1
)braket
suffix:semicolon
DECL|member|intervals
r_struct
id|sndrv_interval
id|intervals
(braket
id|SNDRV_PCM_HW_PARAM_TICK_TIME
op_minus
id|SNDRV_PCM_HW_PARAM_SAMPLE_BITS
op_plus
l_int|1
)braket
suffix:semicolon
DECL|member|rmask
r_int
r_int
id|rmask
suffix:semicolon
DECL|member|cmask
r_int
r_int
id|cmask
suffix:semicolon
DECL|member|info
r_int
r_int
id|info
suffix:semicolon
DECL|member|msbits
r_int
r_int
id|msbits
suffix:semicolon
DECL|member|rate_num
r_int
r_int
id|rate_num
suffix:semicolon
DECL|member|rate_den
r_int
r_int
id|rate_den
suffix:semicolon
DECL|member|fifo_size
id|sndrv_pcm_uframes_t
id|fifo_size
suffix:semicolon
DECL|member|reserved
r_int
r_char
id|reserved
(braket
l_int|64
)braket
suffix:semicolon
)brace
suffix:semicolon
DECL|macro|SNDRV_PCM_IOCTL_HW_REFINE_OLD
mdefine_line|#define SNDRV_PCM_IOCTL_HW_REFINE_OLD _IOWR(&squot;A&squot;, 0x10, struct sndrv_pcm_hw_params_old)
DECL|macro|SNDRV_PCM_IOCTL_HW_PARAMS_OLD
mdefine_line|#define SNDRV_PCM_IOCTL_HW_PARAMS_OLD _IOWR(&squot;A&squot;, 0x11, struct sndrv_pcm_hw_params_old)
r_static
r_int
id|snd_pcm_hw_refine_old_user
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_struct
id|sndrv_pcm_hw_params_old
id|__user
op_star
id|_oparams
)paren
suffix:semicolon
r_static
r_int
id|snd_pcm_hw_params_old_user
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_struct
id|sndrv_pcm_hw_params_old
id|__user
op_star
id|_oparams
)paren
suffix:semicolon
multiline_comment|/*&n; *&n; */
DECL|variable|snd_pcm_link_rwlock
id|rwlock_t
id|snd_pcm_link_rwlock
op_assign
id|RW_LOCK_UNLOCKED
suffix:semicolon
r_static
id|DECLARE_RWSEM
c_func
(paren
id|snd_pcm_link_rwsem
)paren
suffix:semicolon
DECL|function|snd_enter_user
r_static
r_inline
id|mm_segment_t
id|snd_enter_user
c_func
(paren
r_void
)paren
(brace
id|mm_segment_t
id|fs
op_assign
id|get_fs
c_func
(paren
)paren
suffix:semicolon
id|set_fs
c_func
(paren
id|get_ds
c_func
(paren
)paren
)paren
suffix:semicolon
r_return
id|fs
suffix:semicolon
)brace
DECL|function|snd_leave_user
r_static
r_inline
r_void
id|snd_leave_user
c_func
(paren
id|mm_segment_t
id|fs
)paren
(brace
id|set_fs
c_func
(paren
id|fs
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_info
r_int
id|snd_pcm_info
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_info_t
op_star
id|info
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
id|snd_pcm_t
op_star
id|pcm
op_assign
id|substream-&gt;pcm
suffix:semicolon
id|snd_pcm_str_t
op_star
id|pstr
op_assign
id|substream-&gt;pstr
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|memset
c_func
(paren
id|info
comma
l_int|0
comma
r_sizeof
(paren
op_star
id|info
)paren
)paren
suffix:semicolon
id|info-&gt;card
op_assign
id|pcm-&gt;card-&gt;number
suffix:semicolon
id|info-&gt;device
op_assign
id|pcm-&gt;device
suffix:semicolon
id|info-&gt;stream
op_assign
id|substream-&gt;stream
suffix:semicolon
id|info-&gt;subdevice
op_assign
id|substream-&gt;number
suffix:semicolon
id|strlcpy
c_func
(paren
id|info-&gt;id
comma
id|pcm-&gt;id
comma
r_sizeof
(paren
id|info-&gt;id
)paren
)paren
suffix:semicolon
id|strlcpy
c_func
(paren
id|info-&gt;name
comma
id|pcm-&gt;name
comma
r_sizeof
(paren
id|info-&gt;name
)paren
)paren
suffix:semicolon
id|info-&gt;dev_class
op_assign
id|pcm-&gt;dev_class
suffix:semicolon
id|info-&gt;dev_subclass
op_assign
id|pcm-&gt;dev_subclass
suffix:semicolon
id|info-&gt;subdevices_count
op_assign
id|pstr-&gt;substream_count
suffix:semicolon
id|info-&gt;subdevices_avail
op_assign
id|pstr-&gt;substream_count
op_minus
id|pstr-&gt;substream_opened
suffix:semicolon
id|strlcpy
c_func
(paren
id|info-&gt;subname
comma
id|substream-&gt;name
comma
r_sizeof
(paren
id|info-&gt;subname
)paren
)paren
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
multiline_comment|/* AB: FIXME!!! This is definitely nonsense */
r_if
c_cond
(paren
id|runtime
)paren
(brace
id|info-&gt;sync
op_assign
id|runtime-&gt;sync
suffix:semicolon
id|substream-&gt;ops
op_member_access_from_pointer
id|ioctl
c_func
(paren
id|substream
comma
id|SNDRV_PCM_IOCTL1_INFO
comma
id|info
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_info_user
r_int
id|snd_pcm_info_user
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_info_t
id|__user
op_star
id|_info
)paren
(brace
id|snd_pcm_info_t
id|info
suffix:semicolon
r_int
id|err
op_assign
id|snd_pcm_info
c_func
(paren
id|substream
comma
op_amp
id|info
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|_info
comma
op_amp
id|info
comma
r_sizeof
(paren
id|info
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|macro|RULES_DEBUG
macro_line|#undef RULES_DEBUG
macro_line|#ifdef RULES_DEBUG
DECL|macro|HW_PARAM
mdefine_line|#define HW_PARAM(v) [SNDRV_PCM_HW_PARAM_##v] = #v
DECL|variable|snd_pcm_hw_param_names
r_char
op_star
id|snd_pcm_hw_param_names
(braket
)braket
op_assign
(brace
id|HW_PARAM
c_func
(paren
id|ACCESS
)paren
comma
id|HW_PARAM
c_func
(paren
id|FORMAT
)paren
comma
id|HW_PARAM
c_func
(paren
id|SUBFORMAT
)paren
comma
id|HW_PARAM
c_func
(paren
id|SAMPLE_BITS
)paren
comma
id|HW_PARAM
c_func
(paren
id|FRAME_BITS
)paren
comma
id|HW_PARAM
c_func
(paren
id|CHANNELS
)paren
comma
id|HW_PARAM
c_func
(paren
id|RATE
)paren
comma
id|HW_PARAM
c_func
(paren
id|PERIOD_TIME
)paren
comma
id|HW_PARAM
c_func
(paren
id|PERIOD_SIZE
)paren
comma
id|HW_PARAM
c_func
(paren
id|PERIOD_BYTES
)paren
comma
id|HW_PARAM
c_func
(paren
id|PERIODS
)paren
comma
id|HW_PARAM
c_func
(paren
id|BUFFER_TIME
)paren
comma
id|HW_PARAM
c_func
(paren
id|BUFFER_SIZE
)paren
comma
id|HW_PARAM
c_func
(paren
id|BUFFER_BYTES
)paren
comma
id|HW_PARAM
c_func
(paren
id|TICK_TIME
)paren
comma
)brace
suffix:semicolon
macro_line|#endif
DECL|function|snd_pcm_hw_refine
r_int
id|snd_pcm_hw_refine
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_hw_params_t
op_star
id|params
)paren
(brace
r_int
r_int
id|k
suffix:semicolon
id|snd_pcm_hardware_t
op_star
id|hw
suffix:semicolon
id|snd_interval_t
op_star
id|i
op_assign
l_int|NULL
suffix:semicolon
id|snd_mask_t
op_star
id|m
op_assign
l_int|NULL
suffix:semicolon
id|snd_pcm_hw_constraints_t
op_star
id|constrs
op_assign
op_amp
id|substream-&gt;runtime-&gt;hw_constraints
suffix:semicolon
r_int
r_int
id|rstamps
(braket
id|constrs-&gt;rules_num
)braket
suffix:semicolon
r_int
r_int
id|vstamps
(braket
id|SNDRV_PCM_HW_PARAM_LAST_INTERVAL
op_plus
l_int|1
)braket
suffix:semicolon
r_int
r_int
id|stamp
op_assign
l_int|2
suffix:semicolon
r_int
id|changed
comma
id|again
suffix:semicolon
id|params-&gt;info
op_assign
l_int|0
suffix:semicolon
id|params-&gt;fifo_size
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|params-&gt;rmask
op_amp
(paren
l_int|1
op_lshift
id|SNDRV_PCM_HW_PARAM_SAMPLE_BITS
)paren
)paren
id|params-&gt;msbits
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|params-&gt;rmask
op_amp
(paren
l_int|1
op_lshift
id|SNDRV_PCM_HW_PARAM_RATE
)paren
)paren
(brace
id|params-&gt;rate_num
op_assign
l_int|0
suffix:semicolon
id|params-&gt;rate_den
op_assign
l_int|0
suffix:semicolon
)brace
r_for
c_loop
(paren
id|k
op_assign
id|SNDRV_PCM_HW_PARAM_FIRST_MASK
suffix:semicolon
id|k
op_le
id|SNDRV_PCM_HW_PARAM_LAST_MASK
suffix:semicolon
id|k
op_increment
)paren
(brace
id|m
op_assign
id|hw_param_mask
c_func
(paren
id|params
comma
id|k
)paren
suffix:semicolon
r_if
c_cond
(paren
id|snd_mask_empty
c_func
(paren
id|m
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|params-&gt;rmask
op_amp
(paren
l_int|1
op_lshift
id|k
)paren
)paren
)paren
r_continue
suffix:semicolon
macro_line|#ifdef RULES_DEBUG
id|printk
c_func
(paren
l_string|&quot;%s = &quot;
comma
id|snd_pcm_hw_param_names
(braket
id|k
)braket
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%04x%04x%04x%04x -&gt; &quot;
comma
id|m-&gt;bits
(braket
l_int|3
)braket
comma
id|m-&gt;bits
(braket
l_int|2
)braket
comma
id|m-&gt;bits
(braket
l_int|1
)braket
comma
id|m-&gt;bits
(braket
l_int|0
)braket
)paren
suffix:semicolon
macro_line|#endif
id|changed
op_assign
id|snd_mask_refine
c_func
(paren
id|m
comma
id|constrs_mask
c_func
(paren
id|constrs
comma
id|k
)paren
)paren
suffix:semicolon
macro_line|#ifdef RULES_DEBUG
id|printk
c_func
(paren
l_string|&quot;%04x%04x%04x%04x&bslash;n&quot;
comma
id|m-&gt;bits
(braket
l_int|3
)braket
comma
id|m-&gt;bits
(braket
l_int|2
)braket
comma
id|m-&gt;bits
(braket
l_int|1
)braket
comma
id|m-&gt;bits
(braket
l_int|0
)braket
)paren
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
id|changed
)paren
id|params-&gt;cmask
op_or_assign
l_int|1
op_lshift
id|k
suffix:semicolon
r_if
c_cond
(paren
id|changed
OL
l_int|0
)paren
r_return
id|changed
suffix:semicolon
)brace
r_for
c_loop
(paren
id|k
op_assign
id|SNDRV_PCM_HW_PARAM_FIRST_INTERVAL
suffix:semicolon
id|k
op_le
id|SNDRV_PCM_HW_PARAM_LAST_INTERVAL
suffix:semicolon
id|k
op_increment
)paren
(brace
id|i
op_assign
id|hw_param_interval
c_func
(paren
id|params
comma
id|k
)paren
suffix:semicolon
r_if
c_cond
(paren
id|snd_interval_empty
c_func
(paren
id|i
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|params-&gt;rmask
op_amp
(paren
l_int|1
op_lshift
id|k
)paren
)paren
)paren
r_continue
suffix:semicolon
macro_line|#ifdef RULES_DEBUG
id|printk
c_func
(paren
l_string|&quot;%s = &quot;
comma
id|snd_pcm_hw_param_names
(braket
id|k
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
id|i-&gt;empty
)paren
id|printk
c_func
(paren
l_string|&quot;empty&quot;
)paren
suffix:semicolon
r_else
id|printk
c_func
(paren
l_string|&quot;%c%u %u%c&quot;
comma
id|i-&gt;openmin
ques
c_cond
l_char|&squot;(&squot;
suffix:colon
l_char|&squot;[&squot;
comma
id|i-&gt;min
comma
id|i-&gt;max
comma
id|i-&gt;openmax
ques
c_cond
l_char|&squot;)&squot;
suffix:colon
l_char|&squot;]&squot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot; -&gt; &quot;
)paren
suffix:semicolon
macro_line|#endif
id|changed
op_assign
id|snd_interval_refine
c_func
(paren
id|i
comma
id|constrs_interval
c_func
(paren
id|constrs
comma
id|k
)paren
)paren
suffix:semicolon
macro_line|#ifdef RULES_DEBUG
r_if
c_cond
(paren
id|i-&gt;empty
)paren
id|printk
c_func
(paren
l_string|&quot;empty&bslash;n&quot;
)paren
suffix:semicolon
r_else
id|printk
c_func
(paren
l_string|&quot;%c%u %u%c&bslash;n&quot;
comma
id|i-&gt;openmin
ques
c_cond
l_char|&squot;(&squot;
suffix:colon
l_char|&squot;[&squot;
comma
id|i-&gt;min
comma
id|i-&gt;max
comma
id|i-&gt;openmax
ques
c_cond
l_char|&squot;)&squot;
suffix:colon
l_char|&squot;]&squot;
)paren
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
id|changed
)paren
id|params-&gt;cmask
op_or_assign
l_int|1
op_lshift
id|k
suffix:semicolon
r_if
c_cond
(paren
id|changed
OL
l_int|0
)paren
r_return
id|changed
suffix:semicolon
)brace
r_for
c_loop
(paren
id|k
op_assign
l_int|0
suffix:semicolon
id|k
OL
id|constrs-&gt;rules_num
suffix:semicolon
id|k
op_increment
)paren
id|rstamps
(braket
id|k
)braket
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|k
op_assign
l_int|0
suffix:semicolon
id|k
op_le
id|SNDRV_PCM_HW_PARAM_LAST_INTERVAL
suffix:semicolon
id|k
op_increment
)paren
id|vstamps
(braket
id|k
)braket
op_assign
(paren
id|params-&gt;rmask
op_amp
(paren
l_int|1
op_lshift
id|k
)paren
)paren
ques
c_cond
l_int|1
suffix:colon
l_int|0
suffix:semicolon
r_do
(brace
id|again
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|k
op_assign
l_int|0
suffix:semicolon
id|k
OL
id|constrs-&gt;rules_num
suffix:semicolon
id|k
op_increment
)paren
(brace
id|snd_pcm_hw_rule_t
op_star
id|r
op_assign
op_amp
id|constrs-&gt;rules
(braket
id|k
)braket
suffix:semicolon
r_int
r_int
id|d
suffix:semicolon
r_int
id|doit
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|r-&gt;cond
op_logical_and
op_logical_neg
(paren
id|r-&gt;cond
op_amp
id|params-&gt;flags
)paren
)paren
r_continue
suffix:semicolon
r_for
c_loop
(paren
id|d
op_assign
l_int|0
suffix:semicolon
id|r-&gt;deps
(braket
id|d
)braket
op_ge
l_int|0
suffix:semicolon
id|d
op_increment
)paren
(brace
r_if
c_cond
(paren
id|vstamps
(braket
id|r-&gt;deps
(braket
id|d
)braket
)braket
OG
id|rstamps
(braket
id|k
)braket
)paren
(brace
id|doit
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
op_logical_neg
id|doit
)paren
r_continue
suffix:semicolon
macro_line|#ifdef RULES_DEBUG
id|printk
c_func
(paren
l_string|&quot;Rule %d [%p]: &quot;
comma
id|k
comma
id|r-&gt;func
)paren
suffix:semicolon
r_if
c_cond
(paren
id|r-&gt;var
op_ge
l_int|0
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s = &quot;
comma
id|snd_pcm_hw_param_names
(braket
id|r-&gt;var
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hw_is_mask
c_func
(paren
id|r-&gt;var
)paren
)paren
(brace
id|m
op_assign
id|hw_param_mask
c_func
(paren
id|params
comma
id|r-&gt;var
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%x&quot;
comma
op_star
id|m-&gt;bits
)paren
suffix:semicolon
)brace
r_else
(brace
id|i
op_assign
id|hw_param_interval
c_func
(paren
id|params
comma
id|r-&gt;var
)paren
suffix:semicolon
r_if
c_cond
(paren
id|i-&gt;empty
)paren
id|printk
c_func
(paren
l_string|&quot;empty&quot;
)paren
suffix:semicolon
r_else
id|printk
c_func
(paren
l_string|&quot;%c%u %u%c&quot;
comma
id|i-&gt;openmin
ques
c_cond
l_char|&squot;(&squot;
suffix:colon
l_char|&squot;[&squot;
comma
id|i-&gt;min
comma
id|i-&gt;max
comma
id|i-&gt;openmax
ques
c_cond
l_char|&squot;)&squot;
suffix:colon
l_char|&squot;]&squot;
)paren
suffix:semicolon
)brace
)brace
macro_line|#endif
id|changed
op_assign
id|r
op_member_access_from_pointer
id|func
c_func
(paren
id|params
comma
id|r
)paren
suffix:semicolon
macro_line|#ifdef RULES_DEBUG
r_if
c_cond
(paren
id|r-&gt;var
op_ge
l_int|0
)paren
(brace
id|printk
c_func
(paren
l_string|&quot; -&gt; &quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hw_is_mask
c_func
(paren
id|r-&gt;var
)paren
)paren
id|printk
c_func
(paren
l_string|&quot;%x&quot;
comma
op_star
id|m-&gt;bits
)paren
suffix:semicolon
r_else
(brace
r_if
c_cond
(paren
id|i-&gt;empty
)paren
id|printk
c_func
(paren
l_string|&quot;empty&quot;
)paren
suffix:semicolon
r_else
id|printk
c_func
(paren
l_string|&quot;%c%u %u%c&quot;
comma
id|i-&gt;openmin
ques
c_cond
l_char|&squot;(&squot;
suffix:colon
l_char|&squot;[&squot;
comma
id|i-&gt;min
comma
id|i-&gt;max
comma
id|i-&gt;openmax
ques
c_cond
l_char|&squot;)&squot;
suffix:colon
l_char|&squot;]&squot;
)paren
suffix:semicolon
)brace
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
macro_line|#endif
id|rstamps
(braket
id|k
)braket
op_assign
id|stamp
suffix:semicolon
r_if
c_cond
(paren
id|changed
op_logical_and
id|r-&gt;var
op_ge
l_int|0
)paren
(brace
id|params-&gt;cmask
op_or_assign
(paren
l_int|1
op_lshift
id|r-&gt;var
)paren
suffix:semicolon
id|vstamps
(braket
id|r-&gt;var
)braket
op_assign
id|stamp
suffix:semicolon
id|again
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|changed
OL
l_int|0
)paren
r_return
id|changed
suffix:semicolon
id|stamp
op_increment
suffix:semicolon
)brace
)brace
r_while
c_loop
(paren
id|again
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|params-&gt;msbits
)paren
(brace
id|i
op_assign
id|hw_param_interval
c_func
(paren
id|params
comma
id|SNDRV_PCM_HW_PARAM_SAMPLE_BITS
)paren
suffix:semicolon
r_if
c_cond
(paren
id|snd_interval_single
c_func
(paren
id|i
)paren
)paren
id|params-&gt;msbits
op_assign
id|snd_interval_value
c_func
(paren
id|i
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|params-&gt;rate_den
)paren
(brace
id|i
op_assign
id|hw_param_interval
c_func
(paren
id|params
comma
id|SNDRV_PCM_HW_PARAM_RATE
)paren
suffix:semicolon
r_if
c_cond
(paren
id|snd_interval_single
c_func
(paren
id|i
)paren
)paren
(brace
id|params-&gt;rate_num
op_assign
id|snd_interval_value
c_func
(paren
id|i
)paren
suffix:semicolon
id|params-&gt;rate_den
op_assign
l_int|1
suffix:semicolon
)brace
)brace
id|hw
op_assign
op_amp
id|substream-&gt;runtime-&gt;hw
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|params-&gt;info
)paren
id|params-&gt;info
op_assign
id|hw-&gt;info
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|params-&gt;fifo_size
)paren
id|params-&gt;fifo_size
op_assign
id|hw-&gt;fifo_size
suffix:semicolon
id|params-&gt;rmask
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_hw_refine_user
r_static
r_int
id|snd_pcm_hw_refine_user
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_hw_params_t
id|__user
op_star
id|_params
)paren
(brace
id|snd_pcm_hw_params_t
op_star
id|params
suffix:semicolon
r_int
id|err
suffix:semicolon
id|params
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
op_star
id|params
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|params
)paren
(brace
id|err
op_assign
op_minus
id|ENOMEM
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
id|params
comma
id|_params
comma
r_sizeof
(paren
op_star
id|params
)paren
)paren
)paren
(brace
id|err
op_assign
op_minus
id|EFAULT
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|err
op_assign
id|snd_pcm_hw_refine
c_func
(paren
id|substream
comma
id|params
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|_params
comma
id|params
comma
r_sizeof
(paren
op_star
id|params
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|err
)paren
id|err
op_assign
op_minus
id|EFAULT
suffix:semicolon
)brace
id|out
suffix:colon
id|kfree
c_func
(paren
id|params
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|function|snd_pcm_hw_params
r_static
r_int
id|snd_pcm_hw_params
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_hw_params_t
op_star
id|params
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_int
id|err
suffix:semicolon
r_int
r_int
id|bits
suffix:semicolon
id|snd_pcm_uframes_t
id|frames
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_assert
c_func
(paren
id|runtime
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|snd_pcm_stream_lock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|runtime-&gt;status-&gt;state
)paren
(brace
r_case
id|SNDRV_PCM_STATE_OPEN
suffix:colon
r_case
id|SNDRV_PCM_STATE_SETUP
suffix:colon
r_case
id|SNDRV_PCM_STATE_PREPARED
suffix:colon
r_break
suffix:semicolon
r_default
suffix:colon
id|snd_pcm_stream_unlock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_return
op_minus
id|EBADFD
suffix:semicolon
)brace
id|snd_pcm_stream_unlock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
macro_line|#if defined(CONFIG_SND_PCM_OSS) || defined(CONFIG_SND_PCM_OSS_MODULE)
r_if
c_cond
(paren
op_logical_neg
id|substream-&gt;oss.oss
)paren
macro_line|#endif
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|runtime-&gt;mmap_count
)paren
)paren
r_return
op_minus
id|EBADFD
suffix:semicolon
id|params-&gt;rmask
op_assign
op_complement
l_int|0U
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_refine
c_func
(paren
id|substream
comma
id|params
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_goto
id|_error
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_params_choose
c_func
(paren
id|substream
comma
id|params
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_goto
id|_error
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;ops-&gt;hw_params
op_ne
l_int|NULL
)paren
(brace
id|err
op_assign
id|substream-&gt;ops
op_member_access_from_pointer
id|hw_params
c_func
(paren
id|substream
comma
id|params
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_goto
id|_error
suffix:semicolon
)brace
id|runtime-&gt;access
op_assign
id|params_access
c_func
(paren
id|params
)paren
suffix:semicolon
id|runtime-&gt;format
op_assign
id|params_format
c_func
(paren
id|params
)paren
suffix:semicolon
id|runtime-&gt;subformat
op_assign
id|params_subformat
c_func
(paren
id|params
)paren
suffix:semicolon
id|runtime-&gt;channels
op_assign
id|params_channels
c_func
(paren
id|params
)paren
suffix:semicolon
id|runtime-&gt;rate
op_assign
id|params_rate
c_func
(paren
id|params
)paren
suffix:semicolon
id|runtime-&gt;period_size
op_assign
id|params_period_size
c_func
(paren
id|params
)paren
suffix:semicolon
id|runtime-&gt;periods
op_assign
id|params_periods
c_func
(paren
id|params
)paren
suffix:semicolon
id|runtime-&gt;buffer_size
op_assign
id|params_buffer_size
c_func
(paren
id|params
)paren
suffix:semicolon
id|runtime-&gt;tick_time
op_assign
id|params_tick_time
c_func
(paren
id|params
)paren
suffix:semicolon
id|runtime-&gt;info
op_assign
id|params-&gt;info
suffix:semicolon
id|runtime-&gt;rate_num
op_assign
id|params-&gt;rate_num
suffix:semicolon
id|runtime-&gt;rate_den
op_assign
id|params-&gt;rate_den
suffix:semicolon
id|bits
op_assign
id|snd_pcm_format_physical_width
c_func
(paren
id|runtime-&gt;format
)paren
suffix:semicolon
id|runtime-&gt;sample_bits
op_assign
id|bits
suffix:semicolon
id|bits
op_mul_assign
id|runtime-&gt;channels
suffix:semicolon
id|runtime-&gt;frame_bits
op_assign
id|bits
suffix:semicolon
id|frames
op_assign
l_int|1
suffix:semicolon
r_while
c_loop
(paren
id|bits
op_mod
l_int|8
op_ne
l_int|0
)paren
(brace
id|bits
op_mul_assign
l_int|2
suffix:semicolon
id|frames
op_mul_assign
l_int|2
suffix:semicolon
)brace
id|runtime-&gt;byte_align
op_assign
id|bits
op_div
l_int|8
suffix:semicolon
id|runtime-&gt;min_align
op_assign
id|frames
suffix:semicolon
multiline_comment|/* Default sw params */
id|runtime-&gt;tstamp_mode
op_assign
id|SNDRV_PCM_TSTAMP_NONE
suffix:semicolon
id|runtime-&gt;period_step
op_assign
l_int|1
suffix:semicolon
id|runtime-&gt;sleep_min
op_assign
l_int|0
suffix:semicolon
id|runtime-&gt;control-&gt;avail_min
op_assign
id|runtime-&gt;period_size
suffix:semicolon
id|runtime-&gt;xfer_align
op_assign
id|runtime-&gt;period_size
suffix:semicolon
id|runtime-&gt;start_threshold
op_assign
l_int|1
suffix:semicolon
id|runtime-&gt;stop_threshold
op_assign
id|runtime-&gt;buffer_size
suffix:semicolon
id|runtime-&gt;silence_threshold
op_assign
l_int|0
suffix:semicolon
id|runtime-&gt;silence_size
op_assign
l_int|0
suffix:semicolon
id|runtime-&gt;boundary
op_assign
id|runtime-&gt;buffer_size
suffix:semicolon
r_while
c_loop
(paren
id|runtime-&gt;boundary
op_star
l_int|2
op_le
id|LONG_MAX
op_minus
id|runtime-&gt;buffer_size
)paren
id|runtime-&gt;boundary
op_mul_assign
l_int|2
suffix:semicolon
id|snd_pcm_timer_resolution_change
c_func
(paren
id|substream
)paren
suffix:semicolon
id|runtime-&gt;status-&gt;state
op_assign
id|SNDRV_PCM_STATE_SETUP
suffix:semicolon
r_return
l_int|0
suffix:semicolon
id|_error
suffix:colon
multiline_comment|/* hardware might be unuseable from this time,&n;&t;   so we force application to retry to set&n;&t;   the correct hardware parameter settings */
id|runtime-&gt;status-&gt;state
op_assign
id|SNDRV_PCM_STATE_OPEN
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;ops-&gt;hw_free
op_ne
l_int|NULL
)paren
id|substream-&gt;ops
op_member_access_from_pointer
id|hw_free
c_func
(paren
id|substream
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|function|snd_pcm_hw_params_user
r_static
r_int
id|snd_pcm_hw_params_user
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_hw_params_t
id|__user
op_star
id|_params
)paren
(brace
id|snd_pcm_hw_params_t
op_star
id|params
suffix:semicolon
r_int
id|err
suffix:semicolon
id|params
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
op_star
id|params
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|params
)paren
(brace
id|err
op_assign
op_minus
id|ENOMEM
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
id|params
comma
id|_params
comma
r_sizeof
(paren
op_star
id|params
)paren
)paren
)paren
(brace
id|err
op_assign
op_minus
id|EFAULT
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|err
op_assign
id|snd_pcm_hw_params
c_func
(paren
id|substream
comma
id|params
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|_params
comma
id|params
comma
r_sizeof
(paren
op_star
id|params
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|err
)paren
id|err
op_assign
op_minus
id|EFAULT
suffix:semicolon
)brace
id|out
suffix:colon
id|kfree
c_func
(paren
id|params
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|function|snd_pcm_hw_free
r_static
r_int
id|snd_pcm_hw_free
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_int
id|result
op_assign
l_int|0
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_assert
c_func
(paren
id|runtime
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|snd_pcm_stream_lock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|runtime-&gt;status-&gt;state
)paren
(brace
r_case
id|SNDRV_PCM_STATE_SETUP
suffix:colon
r_case
id|SNDRV_PCM_STATE_PREPARED
suffix:colon
r_break
suffix:semicolon
r_default
suffix:colon
id|snd_pcm_stream_unlock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_return
op_minus
id|EBADFD
suffix:semicolon
)brace
id|snd_pcm_stream_unlock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|runtime-&gt;mmap_count
)paren
)paren
r_return
op_minus
id|EBADFD
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;ops-&gt;hw_free
)paren
id|result
op_assign
id|substream-&gt;ops
op_member_access_from_pointer
id|hw_free
c_func
(paren
id|substream
)paren
suffix:semicolon
id|runtime-&gt;status-&gt;state
op_assign
id|SNDRV_PCM_STATE_OPEN
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
DECL|function|snd_pcm_sw_params
r_static
r_int
id|snd_pcm_sw_params
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_sw_params_t
op_star
id|params
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_assert
c_func
(paren
id|runtime
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|snd_pcm_stream_lock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_OPEN
)paren
(brace
id|snd_pcm_stream_unlock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_return
op_minus
id|EBADFD
suffix:semicolon
)brace
id|snd_pcm_stream_unlock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|params-&gt;tstamp_mode
OG
id|SNDRV_PCM_TSTAMP_LAST
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|params-&gt;avail_min
op_eq
l_int|0
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|params-&gt;xfer_align
op_eq
l_int|0
op_logical_or
id|params-&gt;xfer_align
op_mod
id|runtime-&gt;min_align
op_ne
l_int|0
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|params-&gt;silence_size
op_ge
id|runtime-&gt;boundary
)paren
(brace
r_if
c_cond
(paren
id|params-&gt;silence_threshold
op_ne
l_int|0
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|params-&gt;silence_size
OG
id|params-&gt;silence_threshold
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|params-&gt;silence_threshold
OG
id|runtime-&gt;buffer_size
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|snd_pcm_stream_lock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
id|runtime-&gt;tstamp_mode
op_assign
id|params-&gt;tstamp_mode
suffix:semicolon
id|runtime-&gt;sleep_min
op_assign
id|params-&gt;sleep_min
suffix:semicolon
id|runtime-&gt;period_step
op_assign
id|params-&gt;period_step
suffix:semicolon
id|runtime-&gt;control-&gt;avail_min
op_assign
id|params-&gt;avail_min
suffix:semicolon
id|runtime-&gt;start_threshold
op_assign
id|params-&gt;start_threshold
suffix:semicolon
id|runtime-&gt;stop_threshold
op_assign
id|params-&gt;stop_threshold
suffix:semicolon
id|runtime-&gt;silence_threshold
op_assign
id|params-&gt;silence_threshold
suffix:semicolon
id|runtime-&gt;silence_size
op_assign
id|params-&gt;silence_size
suffix:semicolon
id|runtime-&gt;xfer_align
op_assign
id|params-&gt;xfer_align
suffix:semicolon
id|params-&gt;boundary
op_assign
id|runtime-&gt;boundary
suffix:semicolon
r_if
c_cond
(paren
id|snd_pcm_running
c_func
(paren
id|substream
)paren
)paren
(brace
r_if
c_cond
(paren
id|runtime-&gt;sleep_min
)paren
id|snd_pcm_tick_prepare
c_func
(paren
id|substream
)paren
suffix:semicolon
r_else
id|snd_pcm_tick_set
c_func
(paren
id|substream
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_PLAYBACK
op_logical_and
id|runtime-&gt;silence_size
OG
l_int|0
)paren
id|snd_pcm_playback_silence
c_func
(paren
id|substream
comma
id|ULONG_MAX
)paren
suffix:semicolon
id|wake_up
c_func
(paren
op_amp
id|runtime-&gt;sleep
)paren
suffix:semicolon
)brace
id|snd_pcm_stream_unlock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_sw_params_user
r_static
r_int
id|snd_pcm_sw_params_user
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_sw_params_t
id|__user
op_star
id|_params
)paren
(brace
id|snd_pcm_sw_params_t
id|params
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|params
comma
id|_params
comma
r_sizeof
(paren
id|params
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|err
op_assign
id|snd_pcm_sw_params
c_func
(paren
id|substream
comma
op_amp
id|params
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|_params
comma
op_amp
id|params
comma
r_sizeof
(paren
id|params
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|function|snd_pcm_status
r_int
id|snd_pcm_status
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_status_t
op_star
id|status
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_pcm_stream_lock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
id|status-&gt;state
op_assign
id|runtime-&gt;status-&gt;state
suffix:semicolon
id|status-&gt;suspended_state
op_assign
id|runtime-&gt;status-&gt;suspended_state
suffix:semicolon
r_if
c_cond
(paren
id|status-&gt;state
op_eq
id|SNDRV_PCM_STATE_OPEN
)paren
r_goto
id|_end
suffix:semicolon
id|status-&gt;trigger_tstamp
op_assign
id|runtime-&gt;trigger_tstamp
suffix:semicolon
r_if
c_cond
(paren
id|snd_pcm_running
c_func
(paren
id|substream
)paren
)paren
(brace
id|snd_pcm_update_hw_ptr
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;tstamp_mode
op_amp
id|SNDRV_PCM_TSTAMP_MMAP
)paren
id|status-&gt;tstamp
op_assign
id|runtime-&gt;status-&gt;tstamp
suffix:semicolon
r_else
id|snd_timestamp_now
c_func
(paren
op_amp
id|status-&gt;tstamp
comma
id|runtime-&gt;tstamp_timespec
)paren
suffix:semicolon
)brace
r_else
id|snd_timestamp_now
c_func
(paren
op_amp
id|status-&gt;tstamp
comma
id|runtime-&gt;tstamp_timespec
)paren
suffix:semicolon
id|status-&gt;appl_ptr
op_assign
id|runtime-&gt;control-&gt;appl_ptr
suffix:semicolon
id|status-&gt;hw_ptr
op_assign
id|runtime-&gt;status-&gt;hw_ptr
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_PLAYBACK
)paren
(brace
id|status-&gt;avail
op_assign
id|snd_pcm_playback_avail
c_func
(paren
id|runtime
)paren
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_RUNNING
op_logical_or
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_DRAINING
)paren
id|status-&gt;delay
op_assign
id|runtime-&gt;buffer_size
op_minus
id|status-&gt;avail
suffix:semicolon
r_else
id|status-&gt;delay
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|status-&gt;avail
op_assign
id|snd_pcm_capture_avail
c_func
(paren
id|runtime
)paren
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_RUNNING
)paren
id|status-&gt;delay
op_assign
id|status-&gt;avail
suffix:semicolon
r_else
id|status-&gt;delay
op_assign
l_int|0
suffix:semicolon
)brace
id|status-&gt;avail_max
op_assign
id|runtime-&gt;avail_max
suffix:semicolon
id|status-&gt;overrange
op_assign
id|runtime-&gt;overrange
suffix:semicolon
id|runtime-&gt;avail_max
op_assign
l_int|0
suffix:semicolon
id|runtime-&gt;overrange
op_assign
l_int|0
suffix:semicolon
id|_end
suffix:colon
id|snd_pcm_stream_unlock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_status_user
r_static
r_int
id|snd_pcm_status_user
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_status_t
id|__user
op_star
id|_status
)paren
(brace
id|snd_pcm_status_t
id|status
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_int
id|res
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|status
comma
l_int|0
comma
r_sizeof
(paren
id|status
)paren
)paren
suffix:semicolon
id|res
op_assign
id|snd_pcm_status
c_func
(paren
id|substream
comma
op_amp
id|status
)paren
suffix:semicolon
r_if
c_cond
(paren
id|res
OL
l_int|0
)paren
r_return
id|res
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|_status
comma
op_amp
id|status
comma
r_sizeof
(paren
id|status
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_channel_info
r_static
r_int
id|snd_pcm_channel_info
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_channel_info_t
id|__user
op_star
id|_info
)paren
(brace
id|snd_pcm_channel_info_t
id|info
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_int
id|res
suffix:semicolon
r_int
r_int
id|channel
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|info
comma
id|_info
comma
r_sizeof
(paren
id|info
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|channel
op_assign
id|info.channel
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_pcm_stream_lock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_OPEN
)paren
(brace
id|snd_pcm_stream_unlock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_return
op_minus
id|EBADFD
suffix:semicolon
)brace
id|snd_pcm_stream_unlock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|channel
op_ge
id|runtime-&gt;channels
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|info
comma
l_int|0
comma
r_sizeof
(paren
id|info
)paren
)paren
suffix:semicolon
id|info.channel
op_assign
id|channel
suffix:semicolon
id|res
op_assign
id|substream-&gt;ops
op_member_access_from_pointer
id|ioctl
c_func
(paren
id|substream
comma
id|SNDRV_PCM_IOCTL1_CHANNEL_INFO
comma
op_amp
id|info
)paren
suffix:semicolon
r_if
c_cond
(paren
id|res
OL
l_int|0
)paren
r_return
id|res
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|_info
comma
op_amp
id|info
comma
r_sizeof
(paren
id|info
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_trigger_tstamp
r_static
r_void
id|snd_pcm_trigger_tstamp
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;trigger_master
op_eq
l_int|NULL
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;trigger_master
op_eq
id|substream
)paren
(brace
id|snd_timestamp_now
c_func
(paren
op_amp
id|runtime-&gt;trigger_tstamp
comma
id|runtime-&gt;tstamp_timespec
)paren
suffix:semicolon
)brace
r_else
(brace
id|snd_pcm_trigger_tstamp
c_func
(paren
id|runtime-&gt;trigger_master
)paren
suffix:semicolon
id|runtime-&gt;trigger_tstamp
op_assign
id|runtime-&gt;trigger_master-&gt;runtime-&gt;trigger_tstamp
suffix:semicolon
)brace
id|runtime-&gt;trigger_master
op_assign
l_int|NULL
suffix:semicolon
)brace
DECL|struct|action_ops
r_struct
id|action_ops
(brace
DECL|member|pre_action
r_int
(paren
op_star
id|pre_action
)paren
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
suffix:semicolon
DECL|member|do_action
r_int
(paren
op_star
id|do_action
)paren
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
suffix:semicolon
DECL|member|undo_action
r_void
(paren
op_star
id|undo_action
)paren
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
suffix:semicolon
DECL|member|post_action
r_void
(paren
op_star
id|post_action
)paren
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
suffix:semicolon
)brace
suffix:semicolon
multiline_comment|/*&n; *  this functions is core for handling of linked stream&n; *  Note: the stream state might be changed also on failure&n; *  Note2: call with calling stream lock + link lock&n; */
DECL|function|snd_pcm_action_group
r_static
r_int
id|snd_pcm_action_group
c_func
(paren
r_struct
id|action_ops
op_star
id|ops
comma
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
comma
r_int
id|do_lock
)paren
(brace
r_struct
id|list_head
op_star
id|pos
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|s
op_assign
l_int|NULL
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|s1
suffix:semicolon
r_int
id|res
op_assign
l_int|0
suffix:semicolon
id|snd_pcm_group_for_each
c_func
(paren
id|pos
comma
id|substream
)paren
(brace
id|s
op_assign
id|snd_pcm_group_substream_entry
c_func
(paren
id|pos
)paren
suffix:semicolon
r_if
c_cond
(paren
id|do_lock
op_logical_and
id|s
op_ne
id|substream
)paren
id|spin_lock
c_func
(paren
op_amp
id|s-&gt;self_group.lock
)paren
suffix:semicolon
id|res
op_assign
id|ops
op_member_access_from_pointer
id|pre_action
c_func
(paren
id|s
comma
id|state
)paren
suffix:semicolon
r_if
c_cond
(paren
id|res
OL
l_int|0
)paren
r_goto
id|_unlock
suffix:semicolon
)brace
id|snd_pcm_group_for_each
c_func
(paren
id|pos
comma
id|substream
)paren
(brace
id|s
op_assign
id|snd_pcm_group_substream_entry
c_func
(paren
id|pos
)paren
suffix:semicolon
id|res
op_assign
id|ops
op_member_access_from_pointer
id|do_action
c_func
(paren
id|s
comma
id|state
)paren
suffix:semicolon
r_if
c_cond
(paren
id|res
OL
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|ops-&gt;undo_action
)paren
(brace
id|snd_pcm_group_for_each
c_func
(paren
id|pos
comma
id|substream
)paren
(brace
id|s1
op_assign
id|snd_pcm_group_substream_entry
c_func
(paren
id|pos
)paren
suffix:semicolon
r_if
c_cond
(paren
id|s1
op_eq
id|s
)paren
multiline_comment|/* failed stream */
r_break
suffix:semicolon
id|ops
op_member_access_from_pointer
id|undo_action
c_func
(paren
id|s1
comma
id|state
)paren
suffix:semicolon
)brace
)brace
id|s
op_assign
l_int|NULL
suffix:semicolon
multiline_comment|/* unlock all */
r_goto
id|_unlock
suffix:semicolon
)brace
)brace
id|snd_pcm_group_for_each
c_func
(paren
id|pos
comma
id|substream
)paren
(brace
id|s
op_assign
id|snd_pcm_group_substream_entry
c_func
(paren
id|pos
)paren
suffix:semicolon
id|ops
op_member_access_from_pointer
id|post_action
c_func
(paren
id|s
comma
id|state
)paren
suffix:semicolon
)brace
id|_unlock
suffix:colon
r_if
c_cond
(paren
id|do_lock
)paren
(brace
multiline_comment|/* unlock streams */
id|snd_pcm_group_for_each
c_func
(paren
id|pos
comma
id|substream
)paren
(brace
id|s1
op_assign
id|snd_pcm_group_substream_entry
c_func
(paren
id|pos
)paren
suffix:semicolon
r_if
c_cond
(paren
id|s1
op_ne
id|substream
)paren
id|spin_unlock
c_func
(paren
op_amp
id|s1-&gt;self_group.lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|s1
op_eq
id|s
)paren
multiline_comment|/* end */
r_break
suffix:semicolon
)brace
)brace
r_return
id|res
suffix:semicolon
)brace
multiline_comment|/*&n; *  Note: call with stream lock&n; */
DECL|function|snd_pcm_action_single
r_static
r_int
id|snd_pcm_action_single
c_func
(paren
r_struct
id|action_ops
op_star
id|ops
comma
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
r_int
id|res
suffix:semicolon
id|res
op_assign
id|ops
op_member_access_from_pointer
id|pre_action
c_func
(paren
id|substream
comma
id|state
)paren
suffix:semicolon
r_if
c_cond
(paren
id|res
OL
l_int|0
)paren
r_return
id|res
suffix:semicolon
id|res
op_assign
id|ops
op_member_access_from_pointer
id|do_action
c_func
(paren
id|substream
comma
id|state
)paren
suffix:semicolon
r_if
c_cond
(paren
id|res
op_eq
l_int|0
)paren
id|ops
op_member_access_from_pointer
id|post_action
c_func
(paren
id|substream
comma
id|state
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|ops-&gt;undo_action
)paren
id|ops
op_member_access_from_pointer
id|undo_action
c_func
(paren
id|substream
comma
id|state
)paren
suffix:semicolon
r_return
id|res
suffix:semicolon
)brace
multiline_comment|/*&n; *  Note: call with stream lock&n; */
DECL|function|snd_pcm_action
r_static
r_int
id|snd_pcm_action
c_func
(paren
r_struct
id|action_ops
op_star
id|ops
comma
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
r_int
id|res
suffix:semicolon
r_if
c_cond
(paren
id|snd_pcm_stream_linked
c_func
(paren
id|substream
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|spin_trylock
c_func
(paren
op_amp
id|substream-&gt;group-&gt;lock
)paren
)paren
(brace
id|spin_unlock
c_func
(paren
op_amp
id|substream-&gt;self_group.lock
)paren
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|substream-&gt;group-&gt;lock
)paren
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|substream-&gt;self_group.lock
)paren
suffix:semicolon
)brace
id|res
op_assign
id|snd_pcm_action_group
c_func
(paren
id|ops
comma
id|substream
comma
id|state
comma
l_int|1
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|substream-&gt;group-&gt;lock
)paren
suffix:semicolon
)brace
r_else
(brace
id|res
op_assign
id|snd_pcm_action_single
c_func
(paren
id|ops
comma
id|substream
comma
id|state
)paren
suffix:semicolon
)brace
r_return
id|res
suffix:semicolon
)brace
multiline_comment|/*&n; *  Note: don&squot;t use any locks before&n; */
DECL|function|snd_pcm_action_lock_irq
r_static
r_int
id|snd_pcm_action_lock_irq
c_func
(paren
r_struct
id|action_ops
op_star
id|ops
comma
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
r_int
id|res
suffix:semicolon
id|read_lock_irq
c_func
(paren
op_amp
id|snd_pcm_link_rwlock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|snd_pcm_stream_linked
c_func
(paren
id|substream
)paren
)paren
(brace
id|spin_lock
c_func
(paren
op_amp
id|substream-&gt;group-&gt;lock
)paren
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|substream-&gt;self_group.lock
)paren
suffix:semicolon
id|res
op_assign
id|snd_pcm_action_group
c_func
(paren
id|ops
comma
id|substream
comma
id|state
comma
l_int|1
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|substream-&gt;self_group.lock
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|substream-&gt;group-&gt;lock
)paren
suffix:semicolon
)brace
r_else
(brace
id|spin_lock
c_func
(paren
op_amp
id|substream-&gt;self_group.lock
)paren
suffix:semicolon
id|res
op_assign
id|snd_pcm_action_single
c_func
(paren
id|ops
comma
id|substream
comma
id|state
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|substream-&gt;self_group.lock
)paren
suffix:semicolon
)brace
id|read_unlock_irq
c_func
(paren
op_amp
id|snd_pcm_link_rwlock
)paren
suffix:semicolon
r_return
id|res
suffix:semicolon
)brace
multiline_comment|/*&n; */
DECL|function|snd_pcm_action_nonatomic
r_static
r_int
id|snd_pcm_action_nonatomic
c_func
(paren
r_struct
id|action_ops
op_star
id|ops
comma
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
r_int
id|res
suffix:semicolon
id|down_read
c_func
(paren
op_amp
id|snd_pcm_link_rwsem
)paren
suffix:semicolon
r_if
c_cond
(paren
id|snd_pcm_stream_linked
c_func
(paren
id|substream
)paren
)paren
id|res
op_assign
id|snd_pcm_action_group
c_func
(paren
id|ops
comma
id|substream
comma
id|state
comma
l_int|0
)paren
suffix:semicolon
r_else
id|res
op_assign
id|snd_pcm_action_single
c_func
(paren
id|ops
comma
id|substream
comma
id|state
)paren
suffix:semicolon
id|up_read
c_func
(paren
op_amp
id|snd_pcm_link_rwsem
)paren
suffix:semicolon
r_return
id|res
suffix:semicolon
)brace
multiline_comment|/*&n; * start callbacks&n; */
DECL|function|snd_pcm_pre_start
r_static
r_int
id|snd_pcm_pre_start
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_ne
id|SNDRV_PCM_STATE_PREPARED
)paren
r_return
op_minus
id|EBADFD
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_PLAYBACK
op_logical_and
op_logical_neg
id|snd_pcm_playback_data
c_func
(paren
id|substream
)paren
)paren
r_return
op_minus
id|EPIPE
suffix:semicolon
id|runtime-&gt;trigger_master
op_assign
id|substream
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_do_start
r_static
r_int
id|snd_pcm_do_start
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
r_if
c_cond
(paren
id|substream-&gt;runtime-&gt;trigger_master
op_ne
id|substream
)paren
r_return
l_int|0
suffix:semicolon
r_return
id|substream-&gt;ops
op_member_access_from_pointer
id|trigger
c_func
(paren
id|substream
comma
id|SNDRV_PCM_TRIGGER_START
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_undo_start
r_static
r_void
id|snd_pcm_undo_start
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
r_if
c_cond
(paren
id|substream-&gt;runtime-&gt;trigger_master
op_eq
id|substream
)paren
id|substream-&gt;ops
op_member_access_from_pointer
id|trigger
c_func
(paren
id|substream
comma
id|SNDRV_PCM_TRIGGER_STOP
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_post_start
r_static
r_void
id|snd_pcm_post_start
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_pcm_trigger_tstamp
c_func
(paren
id|substream
)paren
suffix:semicolon
id|runtime-&gt;status-&gt;state
op_assign
id|state
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_PLAYBACK
op_logical_and
id|runtime-&gt;silence_size
OG
l_int|0
)paren
id|snd_pcm_playback_silence
c_func
(paren
id|substream
comma
id|ULONG_MAX
)paren
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;sleep_min
)paren
id|snd_pcm_tick_prepare
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;timer
)paren
id|snd_timer_notify
c_func
(paren
id|substream-&gt;timer
comma
id|SNDRV_TIMER_EVENT_MSTART
comma
op_amp
id|runtime-&gt;trigger_tstamp
)paren
suffix:semicolon
)brace
DECL|variable|snd_pcm_action_start
r_static
r_struct
id|action_ops
id|snd_pcm_action_start
op_assign
(brace
dot
id|pre_action
op_assign
id|snd_pcm_pre_start
comma
dot
id|do_action
op_assign
id|snd_pcm_do_start
comma
dot
id|undo_action
op_assign
id|snd_pcm_undo_start
comma
dot
id|post_action
op_assign
id|snd_pcm_post_start
)brace
suffix:semicolon
multiline_comment|/**&n; * snd_pcm_start&n; *&n; * Start all linked streams.&n; */
DECL|function|snd_pcm_start
r_int
id|snd_pcm_start
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
r_return
id|snd_pcm_action
c_func
(paren
op_amp
id|snd_pcm_action_start
comma
id|substream
comma
id|SNDRV_PCM_STATE_RUNNING
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * stop callbacks&n; */
DECL|function|snd_pcm_pre_stop
r_static
r_int
id|snd_pcm_pre_stop
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_OPEN
)paren
r_return
op_minus
id|EBADFD
suffix:semicolon
id|runtime-&gt;trigger_master
op_assign
id|substream
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_do_stop
r_static
r_int
id|snd_pcm_do_stop
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
r_if
c_cond
(paren
id|substream-&gt;runtime-&gt;trigger_master
op_eq
id|substream
op_logical_and
id|snd_pcm_running
c_func
(paren
id|substream
)paren
)paren
id|substream-&gt;ops
op_member_access_from_pointer
id|trigger
c_func
(paren
id|substream
comma
id|SNDRV_PCM_TRIGGER_STOP
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
multiline_comment|/* unconditonally stop all substreams */
)brace
DECL|function|snd_pcm_post_stop
r_static
r_void
id|snd_pcm_post_stop
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_ne
id|state
)paren
(brace
id|snd_pcm_trigger_tstamp
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;timer
)paren
id|snd_timer_notify
c_func
(paren
id|substream-&gt;timer
comma
id|SNDRV_TIMER_EVENT_MSTOP
comma
op_amp
id|runtime-&gt;trigger_tstamp
)paren
suffix:semicolon
id|runtime-&gt;status-&gt;state
op_assign
id|state
suffix:semicolon
id|snd_pcm_tick_set
c_func
(paren
id|substream
comma
l_int|0
)paren
suffix:semicolon
)brace
id|wake_up
c_func
(paren
op_amp
id|runtime-&gt;sleep
)paren
suffix:semicolon
)brace
DECL|variable|snd_pcm_action_stop
r_static
r_struct
id|action_ops
id|snd_pcm_action_stop
op_assign
(brace
dot
id|pre_action
op_assign
id|snd_pcm_pre_stop
comma
dot
id|do_action
op_assign
id|snd_pcm_do_stop
comma
dot
id|post_action
op_assign
id|snd_pcm_post_stop
)brace
suffix:semicolon
multiline_comment|/**&n; * snd_pcm_stop&n; *&n; * Try to stop all running streams in the substream group.&n; * The state of each stream is changed to the given value after that unconditionally.&n; */
DECL|function|snd_pcm_stop
r_int
id|snd_pcm_stop
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
r_return
id|snd_pcm_action
c_func
(paren
op_amp
id|snd_pcm_action_stop
comma
id|substream
comma
id|state
)paren
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_pcm_drain_done&n; *&n; * Stop the DMA only when the given stream is playback.&n; * The state is changed to SETUP.&n; * Unlike snd_pcm_stop(), this affects only the given stream.&n; */
DECL|function|snd_pcm_drain_done
r_int
id|snd_pcm_drain_done
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
r_return
id|snd_pcm_action_single
c_func
(paren
op_amp
id|snd_pcm_action_stop
comma
id|substream
comma
id|SNDRV_PCM_STATE_SETUP
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * pause callbacks&n; */
DECL|function|snd_pcm_pre_pause
r_static
r_int
id|snd_pcm_pre_pause
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|push
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|runtime-&gt;info
op_amp
id|SNDRV_PCM_INFO_PAUSE
)paren
)paren
r_return
op_minus
id|ENOSYS
suffix:semicolon
r_if
c_cond
(paren
id|push
)paren
(brace
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_ne
id|SNDRV_PCM_STATE_RUNNING
)paren
r_return
op_minus
id|EBADFD
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_ne
id|SNDRV_PCM_STATE_PAUSED
)paren
r_return
op_minus
id|EBADFD
suffix:semicolon
id|runtime-&gt;trigger_master
op_assign
id|substream
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_do_pause
r_static
r_int
id|snd_pcm_do_pause
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|push
)paren
(brace
r_if
c_cond
(paren
id|substream-&gt;runtime-&gt;trigger_master
op_ne
id|substream
)paren
r_return
l_int|0
suffix:semicolon
r_return
id|substream-&gt;ops
op_member_access_from_pointer
id|trigger
c_func
(paren
id|substream
comma
id|push
ques
c_cond
id|SNDRV_PCM_TRIGGER_PAUSE_PUSH
suffix:colon
id|SNDRV_PCM_TRIGGER_PAUSE_RELEASE
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_undo_pause
r_static
r_void
id|snd_pcm_undo_pause
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|push
)paren
(brace
r_if
c_cond
(paren
id|substream-&gt;runtime-&gt;trigger_master
op_eq
id|substream
)paren
id|substream-&gt;ops
op_member_access_from_pointer
id|trigger
c_func
(paren
id|substream
comma
id|push
ques
c_cond
id|SNDRV_PCM_TRIGGER_PAUSE_RELEASE
suffix:colon
id|SNDRV_PCM_TRIGGER_PAUSE_PUSH
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_post_pause
r_static
r_void
id|snd_pcm_post_pause
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|push
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_pcm_trigger_tstamp
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|push
)paren
(brace
id|runtime-&gt;status-&gt;state
op_assign
id|SNDRV_PCM_STATE_PAUSED
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;timer
)paren
id|snd_timer_notify
c_func
(paren
id|substream-&gt;timer
comma
id|SNDRV_TIMER_EVENT_MPAUSE
comma
op_amp
id|runtime-&gt;trigger_tstamp
)paren
suffix:semicolon
id|snd_pcm_tick_set
c_func
(paren
id|substream
comma
l_int|0
)paren
suffix:semicolon
id|wake_up
c_func
(paren
op_amp
id|runtime-&gt;sleep
)paren
suffix:semicolon
)brace
r_else
(brace
id|runtime-&gt;status-&gt;state
op_assign
id|SNDRV_PCM_STATE_RUNNING
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;sleep_min
)paren
id|snd_pcm_tick_prepare
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;timer
)paren
id|snd_timer_notify
c_func
(paren
id|substream-&gt;timer
comma
id|SNDRV_TIMER_EVENT_MCONTINUE
comma
op_amp
id|runtime-&gt;trigger_tstamp
)paren
suffix:semicolon
)brace
)brace
DECL|variable|snd_pcm_action_pause
r_static
r_struct
id|action_ops
id|snd_pcm_action_pause
op_assign
(brace
dot
id|pre_action
op_assign
id|snd_pcm_pre_pause
comma
dot
id|do_action
op_assign
id|snd_pcm_do_pause
comma
dot
id|undo_action
op_assign
id|snd_pcm_undo_pause
comma
dot
id|post_action
op_assign
id|snd_pcm_post_pause
)brace
suffix:semicolon
multiline_comment|/*&n; * Push/release the pause for all linked streams.&n; */
DECL|function|snd_pcm_pause
r_static
r_int
id|snd_pcm_pause
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|push
)paren
(brace
r_return
id|snd_pcm_action
c_func
(paren
op_amp
id|snd_pcm_action_pause
comma
id|substream
comma
id|push
)paren
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_PM
multiline_comment|/* suspend */
DECL|function|snd_pcm_pre_suspend
r_static
r_int
id|snd_pcm_pre_suspend
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_SUSPENDED
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
id|runtime-&gt;trigger_master
op_assign
id|substream
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_do_suspend
r_static
r_int
id|snd_pcm_do_suspend
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;trigger_master
op_ne
id|substream
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snd_pcm_running
c_func
(paren
id|substream
)paren
)paren
r_return
l_int|0
suffix:semicolon
id|substream-&gt;ops
op_member_access_from_pointer
id|trigger
c_func
(paren
id|substream
comma
id|SNDRV_PCM_TRIGGER_SUSPEND
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
multiline_comment|/* suspend unconditionally */
)brace
DECL|function|snd_pcm_post_suspend
r_static
r_void
id|snd_pcm_post_suspend
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_pcm_trigger_tstamp
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;timer
)paren
id|snd_timer_notify
c_func
(paren
id|substream-&gt;timer
comma
id|SNDRV_TIMER_EVENT_MPAUSE
comma
op_amp
id|runtime-&gt;trigger_tstamp
)paren
suffix:semicolon
id|runtime-&gt;status-&gt;suspended_state
op_assign
id|runtime-&gt;status-&gt;state
suffix:semicolon
id|runtime-&gt;status-&gt;state
op_assign
id|SNDRV_PCM_STATE_SUSPENDED
suffix:semicolon
id|snd_pcm_tick_set
c_func
(paren
id|substream
comma
l_int|0
)paren
suffix:semicolon
id|wake_up
c_func
(paren
op_amp
id|runtime-&gt;sleep
)paren
suffix:semicolon
)brace
DECL|variable|snd_pcm_action_suspend
r_static
r_struct
id|action_ops
id|snd_pcm_action_suspend
op_assign
(brace
dot
id|pre_action
op_assign
id|snd_pcm_pre_suspend
comma
dot
id|do_action
op_assign
id|snd_pcm_do_suspend
comma
dot
id|post_action
op_assign
id|snd_pcm_post_suspend
)brace
suffix:semicolon
multiline_comment|/**&n; * snd_pcm_suspend&n; *&n; * Trigger SUSPEND to all linked streams.&n; * After this call, all streams are changed to SUSPENDED state.&n; */
DECL|function|snd_pcm_suspend
r_int
id|snd_pcm_suspend
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
r_return
id|snd_pcm_action
c_func
(paren
op_amp
id|snd_pcm_action_suspend
comma
id|substream
comma
l_int|0
)paren
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_pcm_suspend_all&n; *&n; * Trigger SUSPEND to all substreams in the given pcm.&n; * After this call, all streams are changed to SUSPENDED state.&n; */
DECL|function|snd_pcm_suspend_all
r_int
id|snd_pcm_suspend_all
c_func
(paren
id|snd_pcm_t
op_star
id|pcm
)paren
(brace
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
r_int
id|stream
comma
id|err
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|stream
op_assign
l_int|0
suffix:semicolon
id|stream
OL
l_int|2
suffix:semicolon
id|stream
op_increment
)paren
(brace
r_for
c_loop
(paren
id|substream
op_assign
id|pcm-&gt;streams
(braket
id|stream
)braket
dot
id|substream
suffix:semicolon
id|substream
suffix:semicolon
id|substream
op_assign
id|substream-&gt;next
)paren
(brace
multiline_comment|/* FIXME: the open/close code should lock this as well */
r_if
c_cond
(paren
id|substream-&gt;runtime
op_eq
l_int|NULL
)paren
r_continue
suffix:semicolon
id|snd_pcm_stream_lock
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;runtime-&gt;status-&gt;state
op_ne
id|SNDRV_PCM_STATE_SUSPENDED
)paren
id|err
op_assign
id|snd_pcm_suspend
c_func
(paren
id|substream
)paren
suffix:semicolon
id|snd_pcm_stream_unlock
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* resume */
DECL|function|snd_pcm_pre_resume
r_static
r_int
id|snd_pcm_pre_resume
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|runtime-&gt;info
op_amp
id|SNDRV_PCM_INFO_RESUME
)paren
)paren
r_return
op_minus
id|ENOSYS
suffix:semicolon
id|runtime-&gt;trigger_master
op_assign
id|substream
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_do_resume
r_static
r_int
id|snd_pcm_do_resume
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;trigger_master
op_ne
id|substream
)paren
r_return
l_int|0
suffix:semicolon
multiline_comment|/* DMA not running previously? */
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;suspended_state
op_ne
id|SNDRV_PCM_STATE_RUNNING
op_logical_and
(paren
id|runtime-&gt;status-&gt;suspended_state
op_ne
id|SNDRV_PCM_STATE_DRAINING
op_logical_or
id|substream-&gt;stream
op_ne
id|SNDRV_PCM_STREAM_PLAYBACK
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_return
id|substream-&gt;ops
op_member_access_from_pointer
id|trigger
c_func
(paren
id|substream
comma
id|SNDRV_PCM_TRIGGER_RESUME
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_undo_resume
r_static
r_void
id|snd_pcm_undo_resume
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
r_if
c_cond
(paren
id|substream-&gt;runtime-&gt;trigger_master
op_eq
id|substream
op_logical_and
id|snd_pcm_running
c_func
(paren
id|substream
)paren
)paren
id|substream-&gt;ops
op_member_access_from_pointer
id|trigger
c_func
(paren
id|substream
comma
id|SNDRV_PCM_TRIGGER_SUSPEND
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_post_resume
r_static
r_void
id|snd_pcm_post_resume
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_pcm_trigger_tstamp
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;timer
)paren
id|snd_timer_notify
c_func
(paren
id|substream-&gt;timer
comma
id|SNDRV_TIMER_EVENT_MCONTINUE
comma
op_amp
id|runtime-&gt;trigger_tstamp
)paren
suffix:semicolon
id|runtime-&gt;status-&gt;state
op_assign
id|runtime-&gt;status-&gt;suspended_state
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;sleep_min
)paren
id|snd_pcm_tick_prepare
c_func
(paren
id|substream
)paren
suffix:semicolon
)brace
DECL|variable|snd_pcm_action_resume
r_static
r_struct
id|action_ops
id|snd_pcm_action_resume
op_assign
(brace
dot
id|pre_action
op_assign
id|snd_pcm_pre_resume
comma
dot
id|do_action
op_assign
id|snd_pcm_do_resume
comma
dot
id|undo_action
op_assign
id|snd_pcm_undo_resume
comma
dot
id|post_action
op_assign
id|snd_pcm_post_resume
)brace
suffix:semicolon
DECL|function|snd_pcm_resume
r_static
r_int
id|snd_pcm_resume
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_card_t
op_star
id|card
op_assign
id|substream-&gt;pcm-&gt;card
suffix:semicolon
r_int
id|res
suffix:semicolon
id|snd_power_lock
c_func
(paren
id|card
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|res
op_assign
id|snd_power_wait
c_func
(paren
id|card
comma
id|SNDRV_CTL_POWER_D0
comma
id|substream-&gt;ffile
)paren
)paren
op_ge
l_int|0
)paren
id|res
op_assign
id|snd_pcm_action_lock_irq
c_func
(paren
op_amp
id|snd_pcm_action_resume
comma
id|substream
comma
l_int|0
)paren
suffix:semicolon
id|snd_power_unlock
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|res
suffix:semicolon
)brace
macro_line|#else
DECL|function|snd_pcm_resume
r_static
r_int
id|snd_pcm_resume
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
r_return
op_minus
id|ENOSYS
suffix:semicolon
)brace
macro_line|#endif /* CONFIG_PM */
multiline_comment|/*&n; * xrun ioctl&n; *&n; * Change the RUNNING stream(s) to XRUN state.&n; */
DECL|function|snd_pcm_xrun
r_static
r_int
id|snd_pcm_xrun
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_card_t
op_star
id|card
op_assign
id|substream-&gt;pcm-&gt;card
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_int
id|result
suffix:semicolon
id|snd_power_lock
c_func
(paren
id|card
)paren
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_SUSPENDED
)paren
(brace
id|result
op_assign
id|snd_power_wait
c_func
(paren
id|card
comma
id|SNDRV_CTL_POWER_D0
comma
id|substream-&gt;ffile
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
OL
l_int|0
)paren
r_goto
id|_unlock
suffix:semicolon
)brace
id|snd_pcm_stream_lock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|runtime-&gt;status-&gt;state
)paren
(brace
r_case
id|SNDRV_PCM_STATE_XRUN
suffix:colon
id|result
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* already there */
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_RUNNING
suffix:colon
id|result
op_assign
id|snd_pcm_stop
c_func
(paren
id|substream
comma
id|SNDRV_PCM_STATE_XRUN
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|result
op_assign
op_minus
id|EBADFD
suffix:semicolon
)brace
id|snd_pcm_stream_unlock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
id|_unlock
suffix:colon
id|snd_power_unlock
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
multiline_comment|/*&n; * reset ioctl&n; */
DECL|function|snd_pcm_pre_reset
r_static
r_int
id|snd_pcm_pre_reset
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_switch
c_cond
(paren
id|runtime-&gt;status-&gt;state
)paren
(brace
r_case
id|SNDRV_PCM_STATE_RUNNING
suffix:colon
r_case
id|SNDRV_PCM_STATE_PREPARED
suffix:colon
r_case
id|SNDRV_PCM_STATE_PAUSED
suffix:colon
r_case
id|SNDRV_PCM_STATE_SUSPENDED
suffix:colon
r_return
l_int|0
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
id|EBADFD
suffix:semicolon
)brace
)brace
DECL|function|snd_pcm_do_reset
r_static
r_int
id|snd_pcm_do_reset
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_int
id|err
op_assign
id|substream-&gt;ops
op_member_access_from_pointer
id|ioctl
c_func
(paren
id|substream
comma
id|SNDRV_PCM_IOCTL1_RESET
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
singleline_comment|// snd_assert(runtime-&gt;status-&gt;hw_ptr &lt; runtime-&gt;buffer_size, );
id|runtime-&gt;hw_ptr_base
op_assign
l_int|0
suffix:semicolon
id|runtime-&gt;hw_ptr_interrupt
op_assign
id|runtime-&gt;status-&gt;hw_ptr
op_minus
id|runtime-&gt;status-&gt;hw_ptr
op_mod
id|runtime-&gt;period_size
suffix:semicolon
id|runtime-&gt;silence_start
op_assign
id|runtime-&gt;status-&gt;hw_ptr
suffix:semicolon
id|runtime-&gt;silence_filled
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_post_reset
r_static
r_void
id|snd_pcm_post_reset
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|runtime-&gt;control-&gt;appl_ptr
op_assign
id|runtime-&gt;status-&gt;hw_ptr
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_PLAYBACK
op_logical_and
id|runtime-&gt;silence_size
OG
l_int|0
)paren
id|snd_pcm_playback_silence
c_func
(paren
id|substream
comma
id|ULONG_MAX
)paren
suffix:semicolon
)brace
DECL|variable|snd_pcm_action_reset
r_static
r_struct
id|action_ops
id|snd_pcm_action_reset
op_assign
(brace
dot
id|pre_action
op_assign
id|snd_pcm_pre_reset
comma
dot
id|do_action
op_assign
id|snd_pcm_do_reset
comma
dot
id|post_action
op_assign
id|snd_pcm_post_reset
)brace
suffix:semicolon
DECL|function|snd_pcm_reset
r_static
r_int
id|snd_pcm_reset
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
r_return
id|snd_pcm_action_nonatomic
c_func
(paren
op_amp
id|snd_pcm_action_reset
comma
id|substream
comma
l_int|0
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * prepare ioctl&n; */
DECL|function|snd_pcm_pre_prepare
r_static
r_int
id|snd_pcm_pre_prepare
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_OPEN
)paren
r_return
op_minus
id|EBADFD
suffix:semicolon
r_if
c_cond
(paren
id|snd_pcm_running
c_func
(paren
id|substream
)paren
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_do_prepare
r_static
r_int
id|snd_pcm_do_prepare
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
r_int
id|err
suffix:semicolon
id|err
op_assign
id|substream-&gt;ops
op_member_access_from_pointer
id|prepare
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_return
id|snd_pcm_do_reset
c_func
(paren
id|substream
comma
l_int|0
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_post_prepare
r_static
r_void
id|snd_pcm_post_prepare
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|runtime-&gt;control-&gt;appl_ptr
op_assign
id|runtime-&gt;status-&gt;hw_ptr
suffix:semicolon
id|runtime-&gt;status-&gt;state
op_assign
id|SNDRV_PCM_STATE_PREPARED
suffix:semicolon
)brace
DECL|variable|snd_pcm_action_prepare
r_static
r_struct
id|action_ops
id|snd_pcm_action_prepare
op_assign
(brace
dot
id|pre_action
op_assign
id|snd_pcm_pre_prepare
comma
dot
id|do_action
op_assign
id|snd_pcm_do_prepare
comma
dot
id|post_action
op_assign
id|snd_pcm_post_prepare
)brace
suffix:semicolon
multiline_comment|/**&n; * snd_pcm_prepare&n; */
DECL|function|snd_pcm_prepare
r_int
id|snd_pcm_prepare
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
r_int
id|res
suffix:semicolon
id|snd_card_t
op_star
id|card
op_assign
id|substream-&gt;pcm-&gt;card
suffix:semicolon
id|snd_power_lock
c_func
(paren
id|card
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|res
op_assign
id|snd_power_wait
c_func
(paren
id|card
comma
id|SNDRV_CTL_POWER_D0
comma
id|substream-&gt;ffile
)paren
)paren
op_ge
l_int|0
)paren
id|res
op_assign
id|snd_pcm_action_nonatomic
c_func
(paren
op_amp
id|snd_pcm_action_prepare
comma
id|substream
comma
l_int|0
)paren
suffix:semicolon
id|snd_power_unlock
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|res
suffix:semicolon
)brace
multiline_comment|/*&n; * drain ioctl&n; */
DECL|function|snd_pcm_pre_drain_init
r_static
r_int
id|snd_pcm_pre_drain_init
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
r_if
c_cond
(paren
id|substream-&gt;ffile-&gt;f_flags
op_amp
id|O_NONBLOCK
)paren
r_return
op_minus
id|EAGAIN
suffix:semicolon
id|substream-&gt;runtime-&gt;trigger_master
op_assign
id|substream
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_do_drain_init
r_static
r_int
id|snd_pcm_do_drain_init
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_PLAYBACK
)paren
(brace
r_switch
c_cond
(paren
id|runtime-&gt;status-&gt;state
)paren
(brace
r_case
id|SNDRV_PCM_STATE_PREPARED
suffix:colon
multiline_comment|/* start playback stream if possible */
r_if
c_cond
(paren
op_logical_neg
id|snd_pcm_playback_empty
c_func
(paren
id|substream
)paren
)paren
(brace
id|snd_pcm_do_start
c_func
(paren
id|substream
comma
id|SNDRV_PCM_STATE_DRAINING
)paren
suffix:semicolon
id|snd_pcm_post_start
c_func
(paren
id|substream
comma
id|SNDRV_PCM_STATE_DRAINING
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_RUNNING
suffix:colon
id|runtime-&gt;status-&gt;state
op_assign
id|SNDRV_PCM_STATE_DRAINING
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_break
suffix:semicolon
)brace
)brace
r_else
(brace
multiline_comment|/* stop running stream */
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_RUNNING
)paren
(brace
r_int
id|state
op_assign
id|snd_pcm_capture_avail
c_func
(paren
id|runtime
)paren
OG
l_int|0
ques
c_cond
id|SNDRV_PCM_STATE_DRAINING
suffix:colon
id|SNDRV_PCM_STATE_SETUP
suffix:semicolon
id|snd_pcm_do_stop
c_func
(paren
id|substream
comma
id|state
)paren
suffix:semicolon
id|snd_pcm_post_stop
c_func
(paren
id|substream
comma
id|state
)paren
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_post_drain_init
r_static
r_void
id|snd_pcm_post_drain_init
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
)brace
DECL|variable|snd_pcm_action_drain_init
r_static
r_struct
id|action_ops
id|snd_pcm_action_drain_init
op_assign
(brace
dot
id|pre_action
op_assign
id|snd_pcm_pre_drain_init
comma
dot
id|do_action
op_assign
id|snd_pcm_do_drain_init
comma
dot
id|post_action
op_assign
id|snd_pcm_post_drain_init
)brace
suffix:semicolon
DECL|struct|drain_rec
r_struct
id|drain_rec
(brace
DECL|member|substream
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
DECL|member|wait
id|wait_queue_t
id|wait
suffix:semicolon
DECL|member|stop_threshold
id|snd_pcm_uframes_t
id|stop_threshold
suffix:semicolon
)brace
suffix:semicolon
r_static
r_int
id|snd_pcm_drop
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
suffix:semicolon
multiline_comment|/*&n; * Drain the stream(s).&n; * When the substream is linked, sync until the draining of all playback streams&n; * is finished.&n; * After this call, all streams are supposed to be either SETUP or DRAINING&n; * (capture only) state.&n; */
DECL|function|snd_pcm_drain
r_static
r_int
id|snd_pcm_drain
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_card_t
op_star
id|card
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_struct
id|list_head
op_star
id|pos
suffix:semicolon
r_int
id|result
op_assign
l_int|0
suffix:semicolon
r_int
id|i
comma
id|num_drecs
suffix:semicolon
r_struct
id|drain_rec
op_star
id|drec
comma
id|drec_tmp
comma
op_star
id|d
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|card
op_assign
id|substream-&gt;pcm-&gt;card
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_OPEN
)paren
r_return
op_minus
id|EBADFD
suffix:semicolon
id|down_read
c_func
(paren
op_amp
id|snd_pcm_link_rwsem
)paren
suffix:semicolon
id|snd_power_lock
c_func
(paren
id|card
)paren
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_SUSPENDED
)paren
(brace
id|result
op_assign
id|snd_power_wait
c_func
(paren
id|card
comma
id|SNDRV_CTL_POWER_D0
comma
id|substream-&gt;ffile
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
OL
l_int|0
)paren
r_goto
id|_unlock
suffix:semicolon
)brace
multiline_comment|/* allocate temporary record for drain sync */
r_if
c_cond
(paren
id|snd_pcm_stream_linked
c_func
(paren
id|substream
)paren
)paren
(brace
id|drec
op_assign
id|kmalloc
c_func
(paren
id|substream-&gt;group-&gt;count
op_star
r_sizeof
(paren
op_star
id|drec
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|drec
)paren
(brace
id|result
op_assign
op_minus
id|ENOMEM
suffix:semicolon
r_goto
id|_unlock
suffix:semicolon
)brace
)brace
r_else
id|drec
op_assign
op_amp
id|drec_tmp
suffix:semicolon
id|snd_pcm_stream_lock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
multiline_comment|/* resume pause */
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_PAUSED
)paren
id|snd_pcm_pause
c_func
(paren
id|substream
comma
l_int|0
)paren
suffix:semicolon
multiline_comment|/* pre-start/stop - all running streams are changed to DRAINING state */
id|result
op_assign
id|snd_pcm_action
c_func
(paren
op_amp
id|snd_pcm_action_drain_init
comma
id|substream
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
OL
l_int|0
)paren
r_goto
id|_end
suffix:semicolon
multiline_comment|/* check streams with PLAYBACK &amp; DRAINING */
id|num_drecs
op_assign
l_int|0
suffix:semicolon
id|snd_pcm_group_for_each
c_func
(paren
id|pos
comma
id|substream
)paren
(brace
id|snd_pcm_substream_t
op_star
id|s
op_assign
id|snd_pcm_group_substream_entry
c_func
(paren
id|pos
)paren
suffix:semicolon
id|runtime
op_assign
id|s-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_ne
id|SNDRV_PCM_STATE_DRAINING
)paren
(brace
id|runtime-&gt;status-&gt;state
op_assign
id|SNDRV_PCM_STATE_SETUP
suffix:semicolon
r_continue
suffix:semicolon
)brace
r_if
c_cond
(paren
id|s-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_PLAYBACK
)paren
(brace
id|d
op_assign
op_amp
id|drec
(braket
id|num_drecs
op_increment
)braket
suffix:semicolon
id|d-&gt;substream
op_assign
id|s
suffix:semicolon
id|init_waitqueue_entry
c_func
(paren
op_amp
id|d-&gt;wait
comma
id|current
)paren
suffix:semicolon
id|add_wait_queue
c_func
(paren
op_amp
id|runtime-&gt;sleep
comma
op_amp
id|d-&gt;wait
)paren
suffix:semicolon
multiline_comment|/* stop_threshold fixup to avoid endless loop when&n;&t;&t;&t; * stop_threshold &gt; buffer_size&n;&t;&t;&t; */
id|d-&gt;stop_threshold
op_assign
id|runtime-&gt;stop_threshold
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;stop_threshold
OG
id|runtime-&gt;buffer_size
)paren
id|runtime-&gt;stop_threshold
op_assign
id|runtime-&gt;buffer_size
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
op_logical_neg
id|num_drecs
)paren
r_goto
id|_end
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
suffix:semicolon
)paren
(brace
r_int
id|tout
suffix:semicolon
r_if
c_cond
(paren
id|signal_pending
c_func
(paren
id|current
)paren
)paren
(brace
id|result
op_assign
op_minus
id|ERESTARTSYS
suffix:semicolon
r_break
suffix:semicolon
)brace
id|set_current_state
c_func
(paren
id|TASK_INTERRUPTIBLE
)paren
suffix:semicolon
id|snd_pcm_stream_unlock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
id|snd_power_unlock
c_func
(paren
id|card
)paren
suffix:semicolon
id|tout
op_assign
id|schedule_timeout
c_func
(paren
l_int|10
op_star
id|HZ
)paren
suffix:semicolon
id|snd_power_lock
c_func
(paren
id|card
)paren
suffix:semicolon
id|snd_pcm_stream_lock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tout
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|substream-&gt;runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_SUSPENDED
)paren
id|result
op_assign
op_minus
id|ESTRPIPE
suffix:semicolon
r_else
(brace
id|snd_printd
c_func
(paren
l_string|&quot;playback drain error (DMA or IRQ trouble?)&bslash;n&quot;
)paren
suffix:semicolon
id|snd_pcm_stop
c_func
(paren
id|substream
comma
id|SNDRV_PCM_STATE_SETUP
)paren
suffix:semicolon
id|result
op_assign
op_minus
id|EIO
suffix:semicolon
)brace
r_break
suffix:semicolon
)brace
multiline_comment|/* all finished? */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|num_drecs
suffix:semicolon
id|i
op_increment
)paren
(brace
id|runtime
op_assign
id|drec
(braket
id|i
)braket
dot
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_DRAINING
)paren
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|i
op_eq
id|num_drecs
)paren
r_break
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|num_drecs
suffix:semicolon
id|i
op_increment
)paren
(brace
id|d
op_assign
op_amp
id|drec
(braket
id|i
)braket
suffix:semicolon
id|runtime
op_assign
id|d-&gt;substream-&gt;runtime
suffix:semicolon
id|remove_wait_queue
c_func
(paren
op_amp
id|runtime-&gt;sleep
comma
op_amp
id|d-&gt;wait
)paren
suffix:semicolon
id|runtime-&gt;stop_threshold
op_assign
id|d-&gt;stop_threshold
suffix:semicolon
)brace
id|_end
suffix:colon
id|snd_pcm_stream_unlock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|drec
op_logical_and
id|drec
op_ne
op_amp
id|drec_tmp
)paren
id|kfree
c_func
(paren
id|drec
)paren
suffix:semicolon
id|_unlock
suffix:colon
id|snd_power_unlock
c_func
(paren
id|card
)paren
suffix:semicolon
id|up_read
c_func
(paren
op_amp
id|snd_pcm_link_rwsem
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
multiline_comment|/*&n; * drop ioctl&n; *&n; * Immediately put all linked substreams into SETUP state.&n; */
DECL|function|snd_pcm_drop
r_static
r_int
id|snd_pcm_drop
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
id|snd_card_t
op_star
id|card
suffix:semicolon
r_int
id|result
op_assign
l_int|0
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|card
op_assign
id|substream-&gt;pcm-&gt;card
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_OPEN
)paren
r_return
op_minus
id|EBADFD
suffix:semicolon
id|snd_power_lock
c_func
(paren
id|card
)paren
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_SUSPENDED
)paren
(brace
id|result
op_assign
id|snd_power_wait
c_func
(paren
id|card
comma
id|SNDRV_CTL_POWER_D0
comma
id|substream-&gt;ffile
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
OL
l_int|0
)paren
r_goto
id|_unlock
suffix:semicolon
)brace
id|snd_pcm_stream_lock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
multiline_comment|/* resume pause */
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_PAUSED
)paren
id|snd_pcm_pause
c_func
(paren
id|substream
comma
l_int|0
)paren
suffix:semicolon
id|snd_pcm_stop
c_func
(paren
id|substream
comma
id|SNDRV_PCM_STATE_SETUP
)paren
suffix:semicolon
multiline_comment|/* runtime-&gt;control-&gt;appl_ptr = runtime-&gt;status-&gt;hw_ptr; */
id|snd_pcm_stream_unlock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
id|_unlock
suffix:colon
id|snd_power_unlock
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
multiline_comment|/* WARNING: Don&squot;t forget to fput back the file */
r_extern
r_int
id|snd_major
suffix:semicolon
DECL|function|snd_pcm_file_fd
r_static
r_struct
id|file
op_star
id|snd_pcm_file_fd
c_func
(paren
r_int
id|fd
)paren
(brace
r_struct
id|file
op_star
id|file
suffix:semicolon
r_struct
id|inode
op_star
id|inode
suffix:semicolon
r_int
r_int
id|minor
suffix:semicolon
id|file
op_assign
id|fget
c_func
(paren
id|fd
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|file
)paren
r_return
l_int|NULL
suffix:semicolon
id|inode
op_assign
id|file-&gt;f_dentry-&gt;d_inode
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|S_ISCHR
c_func
(paren
id|inode-&gt;i_mode
)paren
op_logical_or
id|imajor
c_func
(paren
id|inode
)paren
op_ne
id|snd_major
)paren
(brace
id|fput
c_func
(paren
id|file
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
id|minor
op_assign
id|iminor
c_func
(paren
id|inode
)paren
suffix:semicolon
r_if
c_cond
(paren
id|minor
op_ge
l_int|256
op_logical_or
id|minor
op_mod
id|SNDRV_MINOR_DEVICES
OL
id|SNDRV_MINOR_PCM_PLAYBACK
)paren
(brace
id|fput
c_func
(paren
id|file
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
r_return
id|file
suffix:semicolon
)brace
multiline_comment|/*&n; * PCM link handling&n; */
DECL|function|snd_pcm_link
r_static
r_int
id|snd_pcm_link
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|fd
)paren
(brace
r_int
id|res
op_assign
l_int|0
suffix:semicolon
r_struct
id|file
op_star
id|file
suffix:semicolon
id|snd_pcm_file_t
op_star
id|pcm_file
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|substream1
suffix:semicolon
id|file
op_assign
id|snd_pcm_file_fd
c_func
(paren
id|fd
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|file
)paren
r_return
op_minus
id|EBADFD
suffix:semicolon
id|pcm_file
op_assign
id|file-&gt;private_data
suffix:semicolon
id|substream1
op_assign
id|pcm_file-&gt;substream
suffix:semicolon
id|down_write
c_func
(paren
op_amp
id|snd_pcm_link_rwsem
)paren
suffix:semicolon
id|write_lock_irq
c_func
(paren
op_amp
id|snd_pcm_link_rwlock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_OPEN
op_logical_or
id|substream-&gt;runtime-&gt;status-&gt;state
op_ne
id|substream1-&gt;runtime-&gt;status-&gt;state
)paren
(brace
id|res
op_assign
op_minus
id|EBADFD
suffix:semicolon
r_goto
id|_end
suffix:semicolon
)brace
r_if
c_cond
(paren
id|snd_pcm_stream_linked
c_func
(paren
id|substream1
)paren
)paren
(brace
id|res
op_assign
op_minus
id|EALREADY
suffix:semicolon
r_goto
id|_end
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|snd_pcm_stream_linked
c_func
(paren
id|substream
)paren
)paren
(brace
id|substream-&gt;group
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
id|snd_pcm_group_t
)paren
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;group
op_eq
l_int|NULL
)paren
(brace
id|res
op_assign
op_minus
id|ENOMEM
suffix:semicolon
r_goto
id|_end
suffix:semicolon
)brace
id|spin_lock_init
c_func
(paren
op_amp
id|substream-&gt;group-&gt;lock
)paren
suffix:semicolon
id|INIT_LIST_HEAD
c_func
(paren
op_amp
id|substream-&gt;group-&gt;substreams
)paren
suffix:semicolon
id|list_add_tail
c_func
(paren
op_amp
id|substream-&gt;link_list
comma
op_amp
id|substream-&gt;group-&gt;substreams
)paren
suffix:semicolon
id|substream-&gt;group-&gt;count
op_assign
l_int|1
suffix:semicolon
)brace
id|list_add_tail
c_func
(paren
op_amp
id|substream1-&gt;link_list
comma
op_amp
id|substream-&gt;group-&gt;substreams
)paren
suffix:semicolon
id|substream-&gt;group-&gt;count
op_increment
suffix:semicolon
id|substream1-&gt;group
op_assign
id|substream-&gt;group
suffix:semicolon
id|_end
suffix:colon
id|write_unlock_irq
c_func
(paren
op_amp
id|snd_pcm_link_rwlock
)paren
suffix:semicolon
id|up_write
c_func
(paren
op_amp
id|snd_pcm_link_rwsem
)paren
suffix:semicolon
id|fput
c_func
(paren
id|file
)paren
suffix:semicolon
r_return
id|res
suffix:semicolon
)brace
DECL|function|relink_to_local
r_static
r_void
id|relink_to_local
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|substream-&gt;group
op_assign
op_amp
id|substream-&gt;self_group
suffix:semicolon
id|INIT_LIST_HEAD
c_func
(paren
op_amp
id|substream-&gt;self_group.substreams
)paren
suffix:semicolon
id|list_add_tail
c_func
(paren
op_amp
id|substream-&gt;link_list
comma
op_amp
id|substream-&gt;self_group.substreams
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_unlink
r_static
r_int
id|snd_pcm_unlink
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
r_struct
id|list_head
op_star
id|pos
suffix:semicolon
r_int
id|res
op_assign
l_int|0
suffix:semicolon
id|down_write
c_func
(paren
op_amp
id|snd_pcm_link_rwsem
)paren
suffix:semicolon
id|write_lock_irq
c_func
(paren
op_amp
id|snd_pcm_link_rwlock
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snd_pcm_stream_linked
c_func
(paren
id|substream
)paren
)paren
(brace
id|res
op_assign
op_minus
id|EALREADY
suffix:semicolon
r_goto
id|_end
suffix:semicolon
)brace
id|list_del
c_func
(paren
op_amp
id|substream-&gt;link_list
)paren
suffix:semicolon
id|substream-&gt;group-&gt;count
op_decrement
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;group-&gt;count
op_eq
l_int|1
)paren
(brace
multiline_comment|/* detach the last stream, too */
id|snd_pcm_group_for_each
c_func
(paren
id|pos
comma
id|substream
)paren
(brace
id|relink_to_local
c_func
(paren
id|snd_pcm_group_substream_entry
c_func
(paren
id|pos
)paren
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|kfree
c_func
(paren
id|substream-&gt;group
)paren
suffix:semicolon
)brace
id|relink_to_local
c_func
(paren
id|substream
)paren
suffix:semicolon
id|_end
suffix:colon
id|write_unlock_irq
c_func
(paren
op_amp
id|snd_pcm_link_rwlock
)paren
suffix:semicolon
id|up_write
c_func
(paren
op_amp
id|snd_pcm_link_rwsem
)paren
suffix:semicolon
r_return
id|res
suffix:semicolon
)brace
multiline_comment|/*&n; * hw configurator&n; */
DECL|function|snd_pcm_hw_rule_mul
r_static
r_int
id|snd_pcm_hw_rule_mul
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_rule_t
op_star
id|rule
)paren
(brace
id|snd_interval_t
id|t
suffix:semicolon
id|snd_interval_mul
c_func
(paren
id|hw_param_interval_c
c_func
(paren
id|params
comma
id|rule-&gt;deps
(braket
l_int|0
)braket
)paren
comma
id|hw_param_interval_c
c_func
(paren
id|params
comma
id|rule-&gt;deps
(braket
l_int|1
)braket
)paren
comma
op_amp
id|t
)paren
suffix:semicolon
r_return
id|snd_interval_refine
c_func
(paren
id|hw_param_interval
c_func
(paren
id|params
comma
id|rule-&gt;var
)paren
comma
op_amp
id|t
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_hw_rule_div
r_static
r_int
id|snd_pcm_hw_rule_div
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_rule_t
op_star
id|rule
)paren
(brace
id|snd_interval_t
id|t
suffix:semicolon
id|snd_interval_div
c_func
(paren
id|hw_param_interval_c
c_func
(paren
id|params
comma
id|rule-&gt;deps
(braket
l_int|0
)braket
)paren
comma
id|hw_param_interval_c
c_func
(paren
id|params
comma
id|rule-&gt;deps
(braket
l_int|1
)braket
)paren
comma
op_amp
id|t
)paren
suffix:semicolon
r_return
id|snd_interval_refine
c_func
(paren
id|hw_param_interval
c_func
(paren
id|params
comma
id|rule-&gt;var
)paren
comma
op_amp
id|t
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_hw_rule_muldivk
r_static
r_int
id|snd_pcm_hw_rule_muldivk
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_rule_t
op_star
id|rule
)paren
(brace
id|snd_interval_t
id|t
suffix:semicolon
id|snd_interval_muldivk
c_func
(paren
id|hw_param_interval_c
c_func
(paren
id|params
comma
id|rule-&gt;deps
(braket
l_int|0
)braket
)paren
comma
id|hw_param_interval_c
c_func
(paren
id|params
comma
id|rule-&gt;deps
(braket
l_int|1
)braket
)paren
comma
(paren
r_int
r_int
)paren
id|rule
op_member_access_from_pointer
r_private
comma
op_amp
id|t
)paren
suffix:semicolon
r_return
id|snd_interval_refine
c_func
(paren
id|hw_param_interval
c_func
(paren
id|params
comma
id|rule-&gt;var
)paren
comma
op_amp
id|t
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_hw_rule_mulkdiv
r_static
r_int
id|snd_pcm_hw_rule_mulkdiv
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_rule_t
op_star
id|rule
)paren
(brace
id|snd_interval_t
id|t
suffix:semicolon
id|snd_interval_mulkdiv
c_func
(paren
id|hw_param_interval_c
c_func
(paren
id|params
comma
id|rule-&gt;deps
(braket
l_int|0
)braket
)paren
comma
(paren
r_int
r_int
)paren
id|rule
op_member_access_from_pointer
r_private
comma
id|hw_param_interval_c
c_func
(paren
id|params
comma
id|rule-&gt;deps
(braket
l_int|1
)braket
)paren
comma
op_amp
id|t
)paren
suffix:semicolon
r_return
id|snd_interval_refine
c_func
(paren
id|hw_param_interval
c_func
(paren
id|params
comma
id|rule-&gt;var
)paren
comma
op_amp
id|t
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_hw_rule_format
r_static
r_int
id|snd_pcm_hw_rule_format
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_rule_t
op_star
id|rule
)paren
(brace
r_int
r_int
id|k
suffix:semicolon
id|snd_interval_t
op_star
id|i
op_assign
id|hw_param_interval
c_func
(paren
id|params
comma
id|rule-&gt;deps
(braket
l_int|0
)braket
)paren
suffix:semicolon
id|snd_mask_t
id|m
suffix:semicolon
id|snd_mask_t
op_star
id|mask
op_assign
id|hw_param_mask
c_func
(paren
id|params
comma
id|SNDRV_PCM_HW_PARAM_FORMAT
)paren
suffix:semicolon
id|snd_mask_any
c_func
(paren
op_amp
id|m
)paren
suffix:semicolon
r_for
c_loop
(paren
id|k
op_assign
l_int|0
suffix:semicolon
id|k
op_le
id|SNDRV_PCM_FORMAT_LAST
suffix:semicolon
op_increment
id|k
)paren
(brace
r_int
id|bits
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snd_mask_test
c_func
(paren
id|mask
comma
id|k
)paren
)paren
r_continue
suffix:semicolon
id|bits
op_assign
id|snd_pcm_format_physical_width
c_func
(paren
id|k
)paren
suffix:semicolon
r_if
c_cond
(paren
id|bits
op_le
l_int|0
)paren
r_continue
suffix:semicolon
multiline_comment|/* ignore invalid formats */
r_if
c_cond
(paren
(paren
r_int
)paren
id|bits
template_param
id|i-&gt;max
)paren
id|snd_mask_reset
c_func
(paren
op_amp
id|m
comma
id|k
)paren
suffix:semicolon
)brace
r_return
id|snd_mask_refine
c_func
(paren
id|mask
comma
op_amp
id|m
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_hw_rule_sample_bits
r_static
r_int
id|snd_pcm_hw_rule_sample_bits
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_rule_t
op_star
id|rule
)paren
(brace
id|snd_interval_t
id|t
suffix:semicolon
r_int
r_int
id|k
suffix:semicolon
id|t.min
op_assign
id|UINT_MAX
suffix:semicolon
id|t.max
op_assign
l_int|0
suffix:semicolon
id|t.openmin
op_assign
l_int|0
suffix:semicolon
id|t.openmax
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|k
op_assign
l_int|0
suffix:semicolon
id|k
op_le
id|SNDRV_PCM_FORMAT_LAST
suffix:semicolon
op_increment
id|k
)paren
(brace
r_int
id|bits
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snd_mask_test
c_func
(paren
id|hw_param_mask
c_func
(paren
id|params
comma
id|SNDRV_PCM_HW_PARAM_FORMAT
)paren
comma
id|k
)paren
)paren
r_continue
suffix:semicolon
id|bits
op_assign
id|snd_pcm_format_physical_width
c_func
(paren
id|k
)paren
suffix:semicolon
r_if
c_cond
(paren
id|bits
op_le
l_int|0
)paren
r_continue
suffix:semicolon
multiline_comment|/* ignore invalid formats */
r_if
c_cond
(paren
id|t.min
OG
(paren
r_int
)paren
id|bits
)paren
id|t.min
op_assign
id|bits
suffix:semicolon
r_if
c_cond
(paren
id|t.max
OL
(paren
r_int
)paren
id|bits
)paren
id|t.max
op_assign
id|bits
suffix:semicolon
)brace
id|t.integer
op_assign
l_int|1
suffix:semicolon
r_return
id|snd_interval_refine
c_func
(paren
id|hw_param_interval
c_func
(paren
id|params
comma
id|rule-&gt;var
)paren
comma
op_amp
id|t
)paren
suffix:semicolon
)brace
macro_line|#if SNDRV_PCM_RATE_5512 != 1 &lt;&lt; 0 || SNDRV_PCM_RATE_192000 != 1 &lt;&lt; 12
macro_line|#error &quot;Change this table&quot;
macro_line|#endif
DECL|variable|rates
r_static
r_int
r_int
id|rates
(braket
)braket
op_assign
(brace
l_int|5512
comma
l_int|8000
comma
l_int|11025
comma
l_int|16000
comma
l_int|22050
comma
l_int|32000
comma
l_int|44100
comma
l_int|48000
comma
l_int|64000
comma
l_int|88200
comma
l_int|96000
comma
l_int|176400
comma
l_int|192000
)brace
suffix:semicolon
DECL|function|snd_pcm_hw_rule_rate
r_static
r_int
id|snd_pcm_hw_rule_rate
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_rule_t
op_star
id|rule
)paren
(brace
id|snd_pcm_hardware_t
op_star
id|hw
op_assign
id|rule
op_member_access_from_pointer
r_private
suffix:semicolon
r_return
id|snd_interval_list
c_func
(paren
id|hw_param_interval
c_func
(paren
id|params
comma
id|rule-&gt;var
)paren
comma
id|ARRAY_SIZE
c_func
(paren
id|rates
)paren
comma
id|rates
comma
id|hw-&gt;rates
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_hw_rule_buffer_bytes_max
r_static
r_int
id|snd_pcm_hw_rule_buffer_bytes_max
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_rule_t
op_star
id|rule
)paren
(brace
id|snd_interval_t
id|t
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|substream
op_assign
id|rule
op_member_access_from_pointer
r_private
suffix:semicolon
id|t.min
op_assign
l_int|0
suffix:semicolon
id|t.max
op_assign
id|substream-&gt;buffer_bytes_max
suffix:semicolon
id|t.openmin
op_assign
l_int|0
suffix:semicolon
id|t.openmax
op_assign
l_int|0
suffix:semicolon
id|t.integer
op_assign
l_int|1
suffix:semicolon
r_return
id|snd_interval_refine
c_func
(paren
id|hw_param_interval
c_func
(paren
id|params
comma
id|rule-&gt;var
)paren
comma
op_amp
id|t
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_hw_constraints_init
r_int
id|snd_pcm_hw_constraints_init
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_pcm_hw_constraints_t
op_star
id|constrs
op_assign
op_amp
id|runtime-&gt;hw_constraints
suffix:semicolon
r_int
id|k
comma
id|err
suffix:semicolon
r_for
c_loop
(paren
id|k
op_assign
id|SNDRV_PCM_HW_PARAM_FIRST_MASK
suffix:semicolon
id|k
op_le
id|SNDRV_PCM_HW_PARAM_LAST_MASK
suffix:semicolon
id|k
op_increment
)paren
(brace
id|snd_mask_any
c_func
(paren
id|constrs_mask
c_func
(paren
id|constrs
comma
id|k
)paren
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|k
op_assign
id|SNDRV_PCM_HW_PARAM_FIRST_INTERVAL
suffix:semicolon
id|k
op_le
id|SNDRV_PCM_HW_PARAM_LAST_INTERVAL
suffix:semicolon
id|k
op_increment
)paren
(brace
id|snd_interval_any
c_func
(paren
id|constrs_interval
c_func
(paren
id|constrs
comma
id|k
)paren
)paren
suffix:semicolon
)brace
id|snd_interval_setinteger
c_func
(paren
id|constrs_interval
c_func
(paren
id|constrs
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
)paren
)paren
suffix:semicolon
id|snd_interval_setinteger
c_func
(paren
id|constrs_interval
c_func
(paren
id|constrs
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_SIZE
)paren
)paren
suffix:semicolon
id|snd_interval_setinteger
c_func
(paren
id|constrs_interval
c_func
(paren
id|constrs
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_BYTES
)paren
)paren
suffix:semicolon
id|snd_interval_setinteger
c_func
(paren
id|constrs_interval
c_func
(paren
id|constrs
comma
id|SNDRV_PCM_HW_PARAM_SAMPLE_BITS
)paren
)paren
suffix:semicolon
id|snd_interval_setinteger
c_func
(paren
id|constrs_interval
c_func
(paren
id|constrs
comma
id|SNDRV_PCM_HW_PARAM_FRAME_BITS
)paren
)paren
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_FORMAT
comma
id|snd_pcm_hw_rule_format
comma
l_int|NULL
comma
id|SNDRV_PCM_HW_PARAM_SAMPLE_BITS
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_SAMPLE_BITS
comma
id|snd_pcm_hw_rule_sample_bits
comma
l_int|NULL
comma
id|SNDRV_PCM_HW_PARAM_FORMAT
comma
id|SNDRV_PCM_HW_PARAM_SAMPLE_BITS
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_SAMPLE_BITS
comma
id|snd_pcm_hw_rule_div
comma
l_int|NULL
comma
id|SNDRV_PCM_HW_PARAM_FRAME_BITS
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_FRAME_BITS
comma
id|snd_pcm_hw_rule_mul
comma
l_int|NULL
comma
id|SNDRV_PCM_HW_PARAM_SAMPLE_BITS
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_FRAME_BITS
comma
id|snd_pcm_hw_rule_mulkdiv
comma
(paren
r_void
op_star
)paren
l_int|8
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_BYTES
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_SIZE
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_FRAME_BITS
comma
id|snd_pcm_hw_rule_mulkdiv
comma
(paren
r_void
op_star
)paren
l_int|8
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_BYTES
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_SIZE
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
comma
id|snd_pcm_hw_rule_div
comma
l_int|NULL
comma
id|SNDRV_PCM_HW_PARAM_FRAME_BITS
comma
id|SNDRV_PCM_HW_PARAM_SAMPLE_BITS
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_RATE
comma
id|snd_pcm_hw_rule_mulkdiv
comma
(paren
r_void
op_star
)paren
l_int|1000000
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_SIZE
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_TIME
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_RATE
comma
id|snd_pcm_hw_rule_mulkdiv
comma
(paren
r_void
op_star
)paren
l_int|1000000
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_SIZE
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_TIME
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_PERIODS
comma
id|snd_pcm_hw_rule_div
comma
l_int|NULL
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_SIZE
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_SIZE
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_SIZE
comma
id|snd_pcm_hw_rule_div
comma
l_int|NULL
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_SIZE
comma
id|SNDRV_PCM_HW_PARAM_PERIODS
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_SIZE
comma
id|snd_pcm_hw_rule_mulkdiv
comma
(paren
r_void
op_star
)paren
l_int|8
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_BYTES
comma
id|SNDRV_PCM_HW_PARAM_FRAME_BITS
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_SIZE
comma
id|snd_pcm_hw_rule_muldivk
comma
(paren
r_void
op_star
)paren
l_int|1000000
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_TIME
comma
id|SNDRV_PCM_HW_PARAM_RATE
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_SIZE
comma
id|snd_pcm_hw_rule_mul
comma
l_int|NULL
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_SIZE
comma
id|SNDRV_PCM_HW_PARAM_PERIODS
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_SIZE
comma
id|snd_pcm_hw_rule_mulkdiv
comma
(paren
r_void
op_star
)paren
l_int|8
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_BYTES
comma
id|SNDRV_PCM_HW_PARAM_FRAME_BITS
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_SIZE
comma
id|snd_pcm_hw_rule_muldivk
comma
(paren
r_void
op_star
)paren
l_int|1000000
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_TIME
comma
id|SNDRV_PCM_HW_PARAM_RATE
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_BYTES
comma
id|snd_pcm_hw_rule_muldivk
comma
(paren
r_void
op_star
)paren
l_int|8
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_SIZE
comma
id|SNDRV_PCM_HW_PARAM_FRAME_BITS
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_BYTES
comma
id|snd_pcm_hw_rule_muldivk
comma
(paren
r_void
op_star
)paren
l_int|8
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_SIZE
comma
id|SNDRV_PCM_HW_PARAM_FRAME_BITS
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_TIME
comma
id|snd_pcm_hw_rule_mulkdiv
comma
(paren
r_void
op_star
)paren
l_int|1000000
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_SIZE
comma
id|SNDRV_PCM_HW_PARAM_RATE
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_TIME
comma
id|snd_pcm_hw_rule_mulkdiv
comma
(paren
r_void
op_star
)paren
l_int|1000000
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_SIZE
comma
id|SNDRV_PCM_HW_PARAM_RATE
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_hw_constraints_complete
r_int
id|snd_pcm_hw_constraints_complete
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_pcm_hardware_t
op_star
id|hw
op_assign
op_amp
id|runtime-&gt;hw
suffix:semicolon
r_int
id|err
suffix:semicolon
r_int
r_int
id|mask
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|hw-&gt;info
op_amp
id|SNDRV_PCM_INFO_INTERLEAVED
)paren
id|mask
op_or_assign
l_int|1
op_lshift
id|SNDRV_PCM_ACCESS_RW_INTERLEAVED
suffix:semicolon
r_if
c_cond
(paren
id|hw-&gt;info
op_amp
id|SNDRV_PCM_INFO_NONINTERLEAVED
)paren
id|mask
op_or_assign
l_int|1
op_lshift
id|SNDRV_PCM_ACCESS_RW_NONINTERLEAVED
suffix:semicolon
r_if
c_cond
(paren
id|hw-&gt;info
op_amp
id|SNDRV_PCM_INFO_MMAP
)paren
(brace
r_if
c_cond
(paren
id|hw-&gt;info
op_amp
id|SNDRV_PCM_INFO_INTERLEAVED
)paren
id|mask
op_or_assign
l_int|1
op_lshift
id|SNDRV_PCM_ACCESS_MMAP_INTERLEAVED
suffix:semicolon
r_if
c_cond
(paren
id|hw-&gt;info
op_amp
id|SNDRV_PCM_INFO_NONINTERLEAVED
)paren
id|mask
op_or_assign
l_int|1
op_lshift
id|SNDRV_PCM_ACCESS_MMAP_NONINTERLEAVED
suffix:semicolon
r_if
c_cond
(paren
id|hw-&gt;info
op_amp
id|SNDRV_PCM_INFO_COMPLEX
)paren
id|mask
op_or_assign
l_int|1
op_lshift
id|SNDRV_PCM_ACCESS_MMAP_COMPLEX
suffix:semicolon
)brace
id|err
op_assign
id|snd_pcm_hw_constraint_mask
c_func
(paren
id|runtime
comma
id|SNDRV_PCM_HW_PARAM_ACCESS
comma
id|mask
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|err
op_ge
l_int|0
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_constraint_mask64
c_func
(paren
id|runtime
comma
id|SNDRV_PCM_HW_PARAM_FORMAT
comma
id|hw-&gt;formats
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|err
op_ge
l_int|0
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_constraint_mask
c_func
(paren
id|runtime
comma
id|SNDRV_PCM_HW_PARAM_SUBFORMAT
comma
l_int|1
op_lshift
id|SNDRV_PCM_SUBFORMAT_STD
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|err
op_ge
l_int|0
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_constraint_minmax
c_func
(paren
id|runtime
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
comma
id|hw-&gt;channels_min
comma
id|hw-&gt;channels_max
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|err
op_ge
l_int|0
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_constraint_minmax
c_func
(paren
id|runtime
comma
id|SNDRV_PCM_HW_PARAM_RATE
comma
id|hw-&gt;rate_min
comma
id|hw-&gt;rate_max
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|err
op_ge
l_int|0
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_constraint_minmax
c_func
(paren
id|runtime
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_BYTES
comma
id|hw-&gt;period_bytes_min
comma
id|hw-&gt;period_bytes_max
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|err
op_ge
l_int|0
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_constraint_minmax
c_func
(paren
id|runtime
comma
id|SNDRV_PCM_HW_PARAM_PERIODS
comma
id|hw-&gt;periods_min
comma
id|hw-&gt;periods_max
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|err
op_ge
l_int|0
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_constraint_minmax
c_func
(paren
id|runtime
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_BYTES
comma
id|hw-&gt;period_bytes_min
comma
id|hw-&gt;buffer_bytes_max
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|err
op_ge
l_int|0
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_BYTES
comma
id|snd_pcm_hw_rule_buffer_bytes_max
comma
id|substream
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_BYTES
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
multiline_comment|/* FIXME: remove */
r_if
c_cond
(paren
id|runtime-&gt;dma_bytes
)paren
(brace
id|err
op_assign
id|snd_pcm_hw_constraint_minmax
c_func
(paren
id|runtime
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_BYTES
comma
l_int|0
comma
id|runtime-&gt;dma_bytes
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|err
op_ge
l_int|0
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|hw-&gt;rates
op_amp
(paren
id|SNDRV_PCM_RATE_KNOT
op_or
id|SNDRV_PCM_RATE_CONTINUOUS
)paren
)paren
)paren
(brace
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_RATE
comma
id|snd_pcm_hw_rule_rate
comma
id|hw
comma
id|SNDRV_PCM_HW_PARAM_RATE
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
multiline_comment|/* FIXME: this belong to lowlevel */
id|snd_pcm_hw_constraint_minmax
c_func
(paren
id|runtime
comma
id|SNDRV_PCM_HW_PARAM_TICK_TIME
comma
l_int|1000000
op_div
id|HZ
comma
l_int|1000000
op_div
id|HZ
)paren
suffix:semicolon
id|snd_pcm_hw_constraint_integer
c_func
(paren
id|runtime
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_SIZE
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_add_file
r_static
r_void
id|snd_pcm_add_file
c_func
(paren
id|snd_pcm_str_t
op_star
id|str
comma
id|snd_pcm_file_t
op_star
id|pcm_file
)paren
(brace
id|pcm_file-&gt;next
op_assign
id|str-&gt;files
suffix:semicolon
id|str-&gt;files
op_assign
id|pcm_file
suffix:semicolon
)brace
DECL|function|snd_pcm_remove_file
r_static
r_void
id|snd_pcm_remove_file
c_func
(paren
id|snd_pcm_str_t
op_star
id|str
comma
id|snd_pcm_file_t
op_star
id|pcm_file
)paren
(brace
id|snd_pcm_file_t
op_star
id|pcm_file1
suffix:semicolon
r_if
c_cond
(paren
id|str-&gt;files
op_eq
id|pcm_file
)paren
(brace
id|str-&gt;files
op_assign
id|pcm_file-&gt;next
suffix:semicolon
)brace
r_else
(brace
id|pcm_file1
op_assign
id|str-&gt;files
suffix:semicolon
r_while
c_loop
(paren
id|pcm_file1
op_logical_and
id|pcm_file1-&gt;next
op_ne
id|pcm_file
)paren
id|pcm_file1
op_assign
id|pcm_file1-&gt;next
suffix:semicolon
r_if
c_cond
(paren
id|pcm_file1
op_ne
l_int|NULL
)paren
id|pcm_file1-&gt;next
op_assign
id|pcm_file-&gt;next
suffix:semicolon
)brace
)brace
DECL|function|snd_pcm_release_file
r_static
r_int
id|snd_pcm_release_file
c_func
(paren
id|snd_pcm_file_t
op_star
id|pcm_file
)paren
(brace
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
id|snd_pcm_str_t
op_star
id|str
suffix:semicolon
id|snd_assert
c_func
(paren
id|pcm_file
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|substream
op_assign
id|pcm_file-&gt;substream
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|str
op_assign
id|substream-&gt;pstr
suffix:semicolon
id|snd_pcm_unlink
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;open_flag
)paren
(brace
r_if
c_cond
(paren
id|substream-&gt;ops-&gt;hw_free
op_ne
l_int|NULL
)paren
id|substream-&gt;ops
op_member_access_from_pointer
id|hw_free
c_func
(paren
id|substream
)paren
suffix:semicolon
id|substream-&gt;ops
op_member_access_from_pointer
id|close
c_func
(paren
id|substream
)paren
suffix:semicolon
id|substream-&gt;open_flag
op_assign
l_int|0
suffix:semicolon
)brace
id|substream-&gt;ffile
op_assign
l_int|NULL
suffix:semicolon
id|snd_pcm_remove_file
c_func
(paren
id|str
comma
id|pcm_file
)paren
suffix:semicolon
id|snd_pcm_release_substream
c_func
(paren
id|substream
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|pcm_file
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_open_file
r_static
r_int
id|snd_pcm_open_file
c_func
(paren
r_struct
id|file
op_star
id|file
comma
id|snd_pcm_t
op_star
id|pcm
comma
r_int
id|stream
comma
id|snd_pcm_file_t
op_star
op_star
id|rpcm_file
)paren
(brace
r_int
id|err
op_assign
l_int|0
suffix:semicolon
id|snd_pcm_file_t
op_star
id|pcm_file
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
id|snd_pcm_str_t
op_star
id|str
suffix:semicolon
id|snd_assert
c_func
(paren
id|rpcm_file
op_ne
l_int|NULL
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
op_star
id|rpcm_file
op_assign
l_int|NULL
suffix:semicolon
id|pcm_file
op_assign
id|kcalloc
c_func
(paren
l_int|1
comma
r_sizeof
(paren
op_star
id|pcm_file
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pcm_file
op_eq
l_int|NULL
)paren
(brace
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_pcm_open_substream
c_func
(paren
id|pcm
comma
id|stream
comma
op_amp
id|substream
)paren
)paren
OL
l_int|0
)paren
(brace
id|kfree
c_func
(paren
id|pcm_file
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
id|str
op_assign
id|substream-&gt;pstr
suffix:semicolon
id|substream-&gt;file
op_assign
id|pcm_file
suffix:semicolon
id|substream-&gt;no_mmap_ctrl
op_assign
l_int|0
suffix:semicolon
id|pcm_file-&gt;substream
op_assign
id|substream
suffix:semicolon
id|snd_pcm_add_file
c_func
(paren
id|str
comma
id|pcm_file
)paren
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_constraints_init
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
(brace
id|snd_printd
c_func
(paren
l_string|&quot;snd_pcm_hw_constraints_init failed&bslash;n&quot;
)paren
suffix:semicolon
id|snd_pcm_release_file
c_func
(paren
id|pcm_file
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|substream-&gt;ops
op_member_access_from_pointer
id|open
c_func
(paren
id|substream
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_pcm_release_file
c_func
(paren
id|pcm_file
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
id|substream-&gt;open_flag
op_assign
l_int|1
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_constraints_complete
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
(brace
id|snd_printd
c_func
(paren
l_string|&quot;snd_pcm_hw_constraints_complete failed&bslash;n&quot;
)paren
suffix:semicolon
id|substream-&gt;ops
op_member_access_from_pointer
id|close
c_func
(paren
id|substream
)paren
suffix:semicolon
id|snd_pcm_release_file
c_func
(paren
id|pcm_file
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
id|substream-&gt;ffile
op_assign
id|file
suffix:semicolon
id|file-&gt;private_data
op_assign
id|pcm_file
suffix:semicolon
op_star
id|rpcm_file
op_assign
id|pcm_file
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_open
r_int
id|snd_pcm_open
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_int
id|cardnum
op_assign
id|SNDRV_MINOR_CARD
c_func
(paren
id|iminor
c_func
(paren
id|inode
)paren
)paren
suffix:semicolon
r_int
id|device
op_assign
id|SNDRV_MINOR_DEVICE
c_func
(paren
id|iminor
c_func
(paren
id|inode
)paren
)paren
suffix:semicolon
r_int
id|err
suffix:semicolon
id|snd_pcm_t
op_star
id|pcm
suffix:semicolon
id|snd_pcm_file_t
op_star
id|pcm_file
suffix:semicolon
id|wait_queue_t
id|wait
suffix:semicolon
id|snd_runtime_check
c_func
(paren
id|device
op_ge
id|SNDRV_MINOR_PCM_PLAYBACK
op_logical_and
id|device
OL
id|SNDRV_MINOR_DEVICES
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|pcm
op_assign
id|snd_pcm_devices
(braket
(paren
id|cardnum
op_star
id|SNDRV_PCM_DEVICES
)paren
op_plus
(paren
id|device
op_mod
id|SNDRV_MINOR_PCMS
)paren
)braket
suffix:semicolon
r_if
c_cond
(paren
id|pcm
op_eq
l_int|NULL
)paren
(brace
id|err
op_assign
op_minus
id|ENODEV
suffix:semicolon
r_goto
id|__error1
suffix:semicolon
)brace
id|err
op_assign
id|snd_card_file_add
c_func
(paren
id|pcm-&gt;card
comma
id|file
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_goto
id|__error1
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|try_module_get
c_func
(paren
id|pcm-&gt;card-&gt;module
)paren
)paren
(brace
id|err
op_assign
op_minus
id|EFAULT
suffix:semicolon
r_goto
id|__error2
suffix:semicolon
)brace
id|init_waitqueue_entry
c_func
(paren
op_amp
id|wait
comma
id|current
)paren
suffix:semicolon
id|add_wait_queue
c_func
(paren
op_amp
id|pcm-&gt;open_wait
comma
op_amp
id|wait
)paren
suffix:semicolon
id|down
c_func
(paren
op_amp
id|pcm-&gt;open_mutex
)paren
suffix:semicolon
r_while
c_loop
(paren
l_int|1
)paren
(brace
id|err
op_assign
id|snd_pcm_open_file
c_func
(paren
id|file
comma
id|pcm
comma
id|device
op_ge
id|SNDRV_MINOR_PCM_CAPTURE
ques
c_cond
id|SNDRV_PCM_STREAM_CAPTURE
suffix:colon
id|SNDRV_PCM_STREAM_PLAYBACK
comma
op_amp
id|pcm_file
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
op_ge
l_int|0
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
id|err
op_eq
op_minus
id|EAGAIN
)paren
(brace
r_if
c_cond
(paren
id|file-&gt;f_flags
op_amp
id|O_NONBLOCK
)paren
(brace
id|err
op_assign
op_minus
id|EBUSY
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_else
r_break
suffix:semicolon
id|set_current_state
c_func
(paren
id|TASK_INTERRUPTIBLE
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|pcm-&gt;open_mutex
)paren
suffix:semicolon
id|schedule
c_func
(paren
)paren
suffix:semicolon
id|down
c_func
(paren
op_amp
id|pcm-&gt;open_mutex
)paren
suffix:semicolon
r_if
c_cond
(paren
id|signal_pending
c_func
(paren
id|current
)paren
)paren
(brace
id|err
op_assign
op_minus
id|ERESTARTSYS
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
id|remove_wait_queue
c_func
(paren
op_amp
id|pcm-&gt;open_wait
comma
op_amp
id|wait
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|pcm-&gt;open_mutex
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_goto
id|__error
suffix:semicolon
r_return
id|err
suffix:semicolon
id|__error
suffix:colon
id|module_put
c_func
(paren
id|pcm-&gt;card-&gt;module
)paren
suffix:semicolon
id|__error2
suffix:colon
id|snd_card_file_remove
c_func
(paren
id|pcm-&gt;card
comma
id|file
)paren
suffix:semicolon
id|__error1
suffix:colon
r_return
id|err
suffix:semicolon
)brace
DECL|function|snd_pcm_release
r_int
id|snd_pcm_release
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
id|snd_pcm_t
op_star
id|pcm
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
id|snd_pcm_file_t
op_star
id|pcm_file
suffix:semicolon
id|pcm_file
op_assign
id|file-&gt;private_data
suffix:semicolon
id|substream
op_assign
id|pcm_file-&gt;substream
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
op_logical_neg
id|atomic_read
c_func
(paren
op_amp
id|substream-&gt;runtime-&gt;mmap_count
)paren
comma
)paren
suffix:semicolon
id|pcm
op_assign
id|substream-&gt;pcm
suffix:semicolon
id|snd_pcm_drop
c_func
(paren
id|substream
)paren
suffix:semicolon
id|fasync_helper
c_func
(paren
op_minus
l_int|1
comma
id|file
comma
l_int|0
comma
op_amp
id|substream-&gt;runtime-&gt;fasync
)paren
suffix:semicolon
id|down
c_func
(paren
op_amp
id|pcm-&gt;open_mutex
)paren
suffix:semicolon
id|snd_pcm_release_file
c_func
(paren
id|pcm_file
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|pcm-&gt;open_mutex
)paren
suffix:semicolon
id|wake_up
c_func
(paren
op_amp
id|pcm-&gt;open_wait
)paren
suffix:semicolon
id|module_put
c_func
(paren
id|pcm-&gt;card-&gt;module
)paren
suffix:semicolon
id|snd_card_file_remove
c_func
(paren
id|pcm-&gt;card
comma
id|file
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_playback_rewind
id|snd_pcm_sframes_t
id|snd_pcm_playback_rewind
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_uframes_t
id|frames
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_pcm_sframes_t
id|appl_ptr
suffix:semicolon
id|snd_pcm_sframes_t
id|ret
suffix:semicolon
id|snd_pcm_sframes_t
id|hw_avail
suffix:semicolon
r_if
c_cond
(paren
id|frames
op_eq
l_int|0
)paren
r_return
l_int|0
suffix:semicolon
id|snd_pcm_stream_lock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|runtime-&gt;status-&gt;state
)paren
(brace
r_case
id|SNDRV_PCM_STATE_PREPARED
suffix:colon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_DRAINING
suffix:colon
r_case
id|SNDRV_PCM_STATE_RUNNING
suffix:colon
r_if
c_cond
(paren
id|snd_pcm_update_hw_ptr
c_func
(paren
id|substream
)paren
op_ge
l_int|0
)paren
r_break
suffix:semicolon
multiline_comment|/* Fall through */
r_case
id|SNDRV_PCM_STATE_XRUN
suffix:colon
id|ret
op_assign
op_minus
id|EPIPE
suffix:semicolon
r_goto
id|__end
suffix:semicolon
r_default
suffix:colon
id|ret
op_assign
op_minus
id|EBADFD
suffix:semicolon
r_goto
id|__end
suffix:semicolon
)brace
id|hw_avail
op_assign
id|snd_pcm_playback_hw_avail
c_func
(paren
id|runtime
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hw_avail
op_le
l_int|0
)paren
(brace
id|ret
op_assign
l_int|0
suffix:semicolon
r_goto
id|__end
suffix:semicolon
)brace
r_if
c_cond
(paren
id|frames
OG
(paren
id|snd_pcm_uframes_t
)paren
id|hw_avail
)paren
id|frames
op_assign
id|hw_avail
suffix:semicolon
r_else
id|frames
op_sub_assign
id|frames
op_mod
id|runtime-&gt;xfer_align
suffix:semicolon
id|appl_ptr
op_assign
id|runtime-&gt;control-&gt;appl_ptr
op_minus
id|frames
suffix:semicolon
r_if
c_cond
(paren
id|appl_ptr
OL
l_int|0
)paren
id|appl_ptr
op_add_assign
id|runtime-&gt;boundary
suffix:semicolon
id|runtime-&gt;control-&gt;appl_ptr
op_assign
id|appl_ptr
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_RUNNING
op_logical_and
id|runtime-&gt;sleep_min
)paren
id|snd_pcm_tick_prepare
c_func
(paren
id|substream
)paren
suffix:semicolon
id|ret
op_assign
id|frames
suffix:semicolon
id|__end
suffix:colon
id|snd_pcm_stream_unlock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
DECL|function|snd_pcm_capture_rewind
id|snd_pcm_sframes_t
id|snd_pcm_capture_rewind
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_uframes_t
id|frames
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_pcm_sframes_t
id|appl_ptr
suffix:semicolon
id|snd_pcm_sframes_t
id|ret
suffix:semicolon
id|snd_pcm_sframes_t
id|hw_avail
suffix:semicolon
r_if
c_cond
(paren
id|frames
op_eq
l_int|0
)paren
r_return
l_int|0
suffix:semicolon
id|snd_pcm_stream_lock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|runtime-&gt;status-&gt;state
)paren
(brace
r_case
id|SNDRV_PCM_STATE_PREPARED
suffix:colon
r_case
id|SNDRV_PCM_STATE_DRAINING
suffix:colon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_RUNNING
suffix:colon
r_if
c_cond
(paren
id|snd_pcm_update_hw_ptr
c_func
(paren
id|substream
)paren
op_ge
l_int|0
)paren
r_break
suffix:semicolon
multiline_comment|/* Fall through */
r_case
id|SNDRV_PCM_STATE_XRUN
suffix:colon
id|ret
op_assign
op_minus
id|EPIPE
suffix:semicolon
r_goto
id|__end
suffix:semicolon
r_default
suffix:colon
id|ret
op_assign
op_minus
id|EBADFD
suffix:semicolon
r_goto
id|__end
suffix:semicolon
)brace
id|hw_avail
op_assign
id|snd_pcm_capture_hw_avail
c_func
(paren
id|runtime
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hw_avail
op_le
l_int|0
)paren
(brace
id|ret
op_assign
l_int|0
suffix:semicolon
r_goto
id|__end
suffix:semicolon
)brace
r_if
c_cond
(paren
id|frames
OG
(paren
id|snd_pcm_uframes_t
)paren
id|hw_avail
)paren
id|frames
op_assign
id|hw_avail
suffix:semicolon
r_else
id|frames
op_sub_assign
id|frames
op_mod
id|runtime-&gt;xfer_align
suffix:semicolon
id|appl_ptr
op_assign
id|runtime-&gt;control-&gt;appl_ptr
op_minus
id|frames
suffix:semicolon
r_if
c_cond
(paren
id|appl_ptr
OL
l_int|0
)paren
id|appl_ptr
op_add_assign
id|runtime-&gt;boundary
suffix:semicolon
id|runtime-&gt;control-&gt;appl_ptr
op_assign
id|appl_ptr
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_RUNNING
op_logical_and
id|runtime-&gt;sleep_min
)paren
id|snd_pcm_tick_prepare
c_func
(paren
id|substream
)paren
suffix:semicolon
id|ret
op_assign
id|frames
suffix:semicolon
id|__end
suffix:colon
id|snd_pcm_stream_unlock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
DECL|function|snd_pcm_playback_forward
id|snd_pcm_sframes_t
id|snd_pcm_playback_forward
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_uframes_t
id|frames
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_pcm_sframes_t
id|appl_ptr
suffix:semicolon
id|snd_pcm_sframes_t
id|ret
suffix:semicolon
id|snd_pcm_sframes_t
id|avail
suffix:semicolon
r_if
c_cond
(paren
id|frames
op_eq
l_int|0
)paren
r_return
l_int|0
suffix:semicolon
id|snd_pcm_stream_lock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|runtime-&gt;status-&gt;state
)paren
(brace
r_case
id|SNDRV_PCM_STATE_PREPARED
suffix:colon
r_case
id|SNDRV_PCM_STATE_PAUSED
suffix:colon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_DRAINING
suffix:colon
r_case
id|SNDRV_PCM_STATE_RUNNING
suffix:colon
r_if
c_cond
(paren
id|snd_pcm_update_hw_ptr
c_func
(paren
id|substream
)paren
op_ge
l_int|0
)paren
r_break
suffix:semicolon
multiline_comment|/* Fall through */
r_case
id|SNDRV_PCM_STATE_XRUN
suffix:colon
id|ret
op_assign
op_minus
id|EPIPE
suffix:semicolon
r_goto
id|__end
suffix:semicolon
r_default
suffix:colon
id|ret
op_assign
op_minus
id|EBADFD
suffix:semicolon
r_goto
id|__end
suffix:semicolon
)brace
id|avail
op_assign
id|snd_pcm_playback_avail
c_func
(paren
id|runtime
)paren
suffix:semicolon
r_if
c_cond
(paren
id|avail
op_le
l_int|0
)paren
(brace
id|ret
op_assign
l_int|0
suffix:semicolon
r_goto
id|__end
suffix:semicolon
)brace
r_if
c_cond
(paren
id|frames
OG
(paren
id|snd_pcm_uframes_t
)paren
id|avail
)paren
id|frames
op_assign
id|avail
suffix:semicolon
r_else
id|frames
op_sub_assign
id|frames
op_mod
id|runtime-&gt;xfer_align
suffix:semicolon
id|appl_ptr
op_assign
id|runtime-&gt;control-&gt;appl_ptr
op_plus
id|frames
suffix:semicolon
r_if
c_cond
(paren
id|appl_ptr
op_ge
(paren
id|snd_pcm_sframes_t
)paren
id|runtime-&gt;boundary
)paren
id|appl_ptr
op_sub_assign
id|runtime-&gt;boundary
suffix:semicolon
id|runtime-&gt;control-&gt;appl_ptr
op_assign
id|appl_ptr
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_RUNNING
op_logical_and
id|runtime-&gt;sleep_min
)paren
id|snd_pcm_tick_prepare
c_func
(paren
id|substream
)paren
suffix:semicolon
id|ret
op_assign
id|frames
suffix:semicolon
id|__end
suffix:colon
id|snd_pcm_stream_unlock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
DECL|function|snd_pcm_capture_forward
id|snd_pcm_sframes_t
id|snd_pcm_capture_forward
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_uframes_t
id|frames
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_pcm_sframes_t
id|appl_ptr
suffix:semicolon
id|snd_pcm_sframes_t
id|ret
suffix:semicolon
id|snd_pcm_sframes_t
id|avail
suffix:semicolon
r_if
c_cond
(paren
id|frames
op_eq
l_int|0
)paren
r_return
l_int|0
suffix:semicolon
id|snd_pcm_stream_lock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|runtime-&gt;status-&gt;state
)paren
(brace
r_case
id|SNDRV_PCM_STATE_PREPARED
suffix:colon
r_case
id|SNDRV_PCM_STATE_DRAINING
suffix:colon
r_case
id|SNDRV_PCM_STATE_PAUSED
suffix:colon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_RUNNING
suffix:colon
r_if
c_cond
(paren
id|snd_pcm_update_hw_ptr
c_func
(paren
id|substream
)paren
op_ge
l_int|0
)paren
r_break
suffix:semicolon
multiline_comment|/* Fall through */
r_case
id|SNDRV_PCM_STATE_XRUN
suffix:colon
id|ret
op_assign
op_minus
id|EPIPE
suffix:semicolon
r_goto
id|__end
suffix:semicolon
r_default
suffix:colon
id|ret
op_assign
op_minus
id|EBADFD
suffix:semicolon
r_goto
id|__end
suffix:semicolon
)brace
id|avail
op_assign
id|snd_pcm_capture_avail
c_func
(paren
id|runtime
)paren
suffix:semicolon
r_if
c_cond
(paren
id|avail
op_le
l_int|0
)paren
(brace
id|ret
op_assign
l_int|0
suffix:semicolon
r_goto
id|__end
suffix:semicolon
)brace
r_if
c_cond
(paren
id|frames
OG
(paren
id|snd_pcm_uframes_t
)paren
id|avail
)paren
id|frames
op_assign
id|avail
suffix:semicolon
r_else
id|frames
op_sub_assign
id|frames
op_mod
id|runtime-&gt;xfer_align
suffix:semicolon
id|appl_ptr
op_assign
id|runtime-&gt;control-&gt;appl_ptr
op_plus
id|frames
suffix:semicolon
r_if
c_cond
(paren
id|appl_ptr
op_ge
(paren
id|snd_pcm_sframes_t
)paren
id|runtime-&gt;boundary
)paren
id|appl_ptr
op_sub_assign
id|runtime-&gt;boundary
suffix:semicolon
id|runtime-&gt;control-&gt;appl_ptr
op_assign
id|appl_ptr
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_RUNNING
op_logical_and
id|runtime-&gt;sleep_min
)paren
id|snd_pcm_tick_prepare
c_func
(paren
id|substream
)paren
suffix:semicolon
id|ret
op_assign
id|frames
suffix:semicolon
id|__end
suffix:colon
id|snd_pcm_stream_unlock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
DECL|function|snd_pcm_hwsync
r_static
r_int
id|snd_pcm_hwsync
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_int
id|err
suffix:semicolon
id|snd_pcm_stream_lock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|runtime-&gt;status-&gt;state
)paren
(brace
r_case
id|SNDRV_PCM_STATE_DRAINING
suffix:colon
r_if
c_cond
(paren
id|substream-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_CAPTURE
)paren
r_goto
id|__badfd
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_RUNNING
suffix:colon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_pcm_update_hw_ptr
c_func
(paren
id|substream
)paren
)paren
OL
l_int|0
)paren
r_break
suffix:semicolon
multiline_comment|/* Fall through */
r_case
id|SNDRV_PCM_STATE_PREPARED
suffix:colon
r_case
id|SNDRV_PCM_STATE_SUSPENDED
suffix:colon
id|err
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_XRUN
suffix:colon
id|err
op_assign
op_minus
id|EPIPE
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|__badfd
suffix:colon
id|err
op_assign
op_minus
id|EBADFD
suffix:semicolon
r_break
suffix:semicolon
)brace
id|snd_pcm_stream_unlock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|function|snd_pcm_delay
r_static
r_int
id|snd_pcm_delay
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_sframes_t
id|__user
op_star
id|res
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_int
id|err
suffix:semicolon
id|snd_pcm_sframes_t
id|n
op_assign
l_int|0
suffix:semicolon
id|snd_pcm_stream_lock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|runtime-&gt;status-&gt;state
)paren
(brace
r_case
id|SNDRV_PCM_STATE_DRAINING
suffix:colon
r_if
c_cond
(paren
id|substream-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_CAPTURE
)paren
r_goto
id|__badfd
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_RUNNING
suffix:colon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_pcm_update_hw_ptr
c_func
(paren
id|substream
)paren
)paren
OL
l_int|0
)paren
r_break
suffix:semicolon
multiline_comment|/* Fall through */
r_case
id|SNDRV_PCM_STATE_PREPARED
suffix:colon
r_case
id|SNDRV_PCM_STATE_SUSPENDED
suffix:colon
id|err
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_PLAYBACK
)paren
id|n
op_assign
id|snd_pcm_playback_hw_avail
c_func
(paren
id|runtime
)paren
suffix:semicolon
r_else
id|n
op_assign
id|snd_pcm_capture_avail
c_func
(paren
id|runtime
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_XRUN
suffix:colon
id|err
op_assign
op_minus
id|EPIPE
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|__badfd
suffix:colon
id|err
op_assign
op_minus
id|EBADFD
suffix:semicolon
r_break
suffix:semicolon
)brace
id|snd_pcm_stream_unlock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|err
)paren
r_if
c_cond
(paren
id|put_user
c_func
(paren
id|n
comma
id|res
)paren
)paren
id|err
op_assign
op_minus
id|EFAULT
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|function|snd_pcm_sync_ptr
r_static
r_int
id|snd_pcm_sync_ptr
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_struct
id|sndrv_pcm_sync_ptr
id|__user
op_star
id|_sync_ptr
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_struct
id|sndrv_pcm_sync_ptr
id|sync_ptr
suffix:semicolon
r_volatile
r_struct
id|sndrv_pcm_mmap_status
op_star
id|status
suffix:semicolon
r_volatile
r_struct
id|sndrv_pcm_mmap_control
op_star
id|control
suffix:semicolon
r_int
id|err
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|sync_ptr
comma
l_int|0
comma
r_sizeof
(paren
id|sync_ptr
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|get_user
c_func
(paren
id|sync_ptr.flags
comma
(paren
r_int
id|__user
op_star
)paren
op_amp
(paren
id|_sync_ptr-&gt;flags
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|sync_ptr.c.control
comma
op_amp
(paren
id|_sync_ptr-&gt;c.control
)paren
comma
r_sizeof
(paren
r_struct
id|sndrv_pcm_mmap_control
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|status
op_assign
id|runtime-&gt;status
suffix:semicolon
id|control
op_assign
id|runtime-&gt;control
suffix:semicolon
r_if
c_cond
(paren
id|sync_ptr.flags
op_amp
id|SNDRV_PCM_SYNC_PTR_HWSYNC
)paren
(brace
id|err
op_assign
id|snd_pcm_hwsync
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
id|snd_pcm_stream_lock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|sync_ptr.flags
op_amp
id|SNDRV_PCM_SYNC_PTR_APPL
)paren
)paren
id|control-&gt;appl_ptr
op_assign
id|sync_ptr.c.control.appl_ptr
suffix:semicolon
r_else
id|sync_ptr.c.control.appl_ptr
op_assign
id|control-&gt;appl_ptr
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|sync_ptr.flags
op_amp
id|SNDRV_PCM_SYNC_PTR_AVAIL_MIN
)paren
)paren
id|control-&gt;avail_min
op_assign
id|sync_ptr.c.control.avail_min
suffix:semicolon
r_else
id|sync_ptr.c.control.avail_min
op_assign
id|control-&gt;avail_min
suffix:semicolon
id|sync_ptr.s.status.state
op_assign
id|status-&gt;state
suffix:semicolon
id|sync_ptr.s.status.hw_ptr
op_assign
id|status-&gt;hw_ptr
suffix:semicolon
id|sync_ptr.s.status.tstamp
op_assign
id|status-&gt;tstamp
suffix:semicolon
id|sync_ptr.s.status.suspended_state
op_assign
id|status-&gt;suspended_state
suffix:semicolon
id|snd_pcm_stream_unlock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|_sync_ptr
comma
op_amp
id|sync_ptr
comma
r_sizeof
(paren
id|sync_ptr
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
id|snd_pcm_playback_ioctl1
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
r_int
id|cmd
comma
r_void
id|__user
op_star
id|arg
)paren
suffix:semicolon
r_static
r_int
id|snd_pcm_capture_ioctl1
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
r_int
id|cmd
comma
r_void
id|__user
op_star
id|arg
)paren
suffix:semicolon
DECL|function|snd_pcm_common_ioctl1
r_static
r_int
id|snd_pcm_common_ioctl1
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
r_int
id|cmd
comma
r_void
id|__user
op_star
id|arg
)paren
(brace
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|SNDRV_PCM_IOCTL_PVERSION
suffix:colon
r_return
id|put_user
c_func
(paren
id|SNDRV_PCM_VERSION
comma
(paren
r_int
id|__user
op_star
)paren
id|arg
)paren
ques
c_cond
op_minus
id|EFAULT
suffix:colon
l_int|0
suffix:semicolon
r_case
id|SNDRV_PCM_IOCTL_INFO
suffix:colon
r_return
id|snd_pcm_info_user
c_func
(paren
id|substream
comma
id|arg
)paren
suffix:semicolon
r_case
id|SNDRV_PCM_IOCTL_TSTAMP
suffix:colon
(brace
r_int
id|xarg
suffix:semicolon
r_if
c_cond
(paren
id|get_user
c_func
(paren
id|xarg
comma
(paren
r_int
id|__user
op_star
)paren
id|arg
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|substream-&gt;runtime-&gt;tstamp_timespec
op_assign
id|xarg
ques
c_cond
l_int|1
suffix:colon
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_case
id|SNDRV_PCM_IOCTL_HW_REFINE
suffix:colon
r_return
id|snd_pcm_hw_refine_user
c_func
(paren
id|substream
comma
id|arg
)paren
suffix:semicolon
r_case
id|SNDRV_PCM_IOCTL_HW_PARAMS
suffix:colon
r_return
id|snd_pcm_hw_params_user
c_func
(paren
id|substream
comma
id|arg
)paren
suffix:semicolon
r_case
id|SNDRV_PCM_IOCTL_HW_FREE
suffix:colon
r_return
id|snd_pcm_hw_free
c_func
(paren
id|substream
)paren
suffix:semicolon
r_case
id|SNDRV_PCM_IOCTL_SW_PARAMS
suffix:colon
r_return
id|snd_pcm_sw_params_user
c_func
(paren
id|substream
comma
id|arg
)paren
suffix:semicolon
r_case
id|SNDRV_PCM_IOCTL_STATUS
suffix:colon
r_return
id|snd_pcm_status_user
c_func
(paren
id|substream
comma
id|arg
)paren
suffix:semicolon
r_case
id|SNDRV_PCM_IOCTL_CHANNEL_INFO
suffix:colon
r_return
id|snd_pcm_channel_info
c_func
(paren
id|substream
comma
id|arg
)paren
suffix:semicolon
r_case
id|SNDRV_PCM_IOCTL_PREPARE
suffix:colon
r_return
id|snd_pcm_prepare
c_func
(paren
id|substream
)paren
suffix:semicolon
r_case
id|SNDRV_PCM_IOCTL_RESET
suffix:colon
r_return
id|snd_pcm_reset
c_func
(paren
id|substream
)paren
suffix:semicolon
r_case
id|SNDRV_PCM_IOCTL_START
suffix:colon
r_return
id|snd_pcm_action_lock_irq
c_func
(paren
op_amp
id|snd_pcm_action_start
comma
id|substream
comma
id|SNDRV_PCM_STATE_RUNNING
)paren
suffix:semicolon
r_case
id|SNDRV_PCM_IOCTL_LINK
suffix:colon
r_return
id|snd_pcm_link
c_func
(paren
id|substream
comma
(paren
r_int
)paren
(paren
r_int
r_int
)paren
id|arg
)paren
suffix:semicolon
r_case
id|SNDRV_PCM_IOCTL_UNLINK
suffix:colon
r_return
id|snd_pcm_unlink
c_func
(paren
id|substream
)paren
suffix:semicolon
r_case
id|SNDRV_PCM_IOCTL_RESUME
suffix:colon
r_return
id|snd_pcm_resume
c_func
(paren
id|substream
)paren
suffix:semicolon
r_case
id|SNDRV_PCM_IOCTL_XRUN
suffix:colon
r_return
id|snd_pcm_xrun
c_func
(paren
id|substream
)paren
suffix:semicolon
r_case
id|SNDRV_PCM_IOCTL_HWSYNC
suffix:colon
r_return
id|snd_pcm_hwsync
c_func
(paren
id|substream
)paren
suffix:semicolon
r_case
id|SNDRV_PCM_IOCTL_DELAY
suffix:colon
r_return
id|snd_pcm_delay
c_func
(paren
id|substream
comma
id|arg
)paren
suffix:semicolon
r_case
id|SNDRV_PCM_IOCTL_SYNC_PTR
suffix:colon
r_return
id|snd_pcm_sync_ptr
c_func
(paren
id|substream
comma
id|arg
)paren
suffix:semicolon
r_case
id|SNDRV_PCM_IOCTL_HW_REFINE_OLD
suffix:colon
r_return
id|snd_pcm_hw_refine_old_user
c_func
(paren
id|substream
comma
id|arg
)paren
suffix:semicolon
r_case
id|SNDRV_PCM_IOCTL_HW_PARAMS_OLD
suffix:colon
r_return
id|snd_pcm_hw_params_old_user
c_func
(paren
id|substream
comma
id|arg
)paren
suffix:semicolon
r_case
id|SNDRV_PCM_IOCTL_DRAIN
suffix:colon
r_return
id|snd_pcm_drain
c_func
(paren
id|substream
)paren
suffix:semicolon
r_case
id|SNDRV_PCM_IOCTL_DROP
suffix:colon
r_return
id|snd_pcm_drop
c_func
(paren
id|substream
)paren
suffix:semicolon
)brace
id|snd_printd
c_func
(paren
l_string|&quot;unknown ioctl = 0x%x&bslash;n&quot;
comma
id|cmd
)paren
suffix:semicolon
r_return
op_minus
id|ENOTTY
suffix:semicolon
)brace
DECL|function|snd_pcm_playback_ioctl1
r_static
r_int
id|snd_pcm_playback_ioctl1
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
r_int
id|cmd
comma
r_void
id|__user
op_star
id|arg
)paren
(brace
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_PLAYBACK
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|SNDRV_PCM_IOCTL_WRITEI_FRAMES
suffix:colon
(brace
id|snd_xferi_t
id|xferi
suffix:semicolon
id|snd_xferi_t
id|__user
op_star
id|_xferi
op_assign
id|arg
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_pcm_sframes_t
id|result
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_OPEN
)paren
r_return
op_minus
id|EBADFD
suffix:semicolon
r_if
c_cond
(paren
id|put_user
c_func
(paren
l_int|0
comma
op_amp
id|_xferi-&gt;result
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|xferi
comma
id|_xferi
comma
r_sizeof
(paren
id|xferi
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|result
op_assign
id|snd_pcm_lib_write
c_func
(paren
id|substream
comma
id|xferi.buf
comma
id|xferi.frames
)paren
suffix:semicolon
id|__put_user
c_func
(paren
id|result
comma
op_amp
id|_xferi-&gt;result
)paren
suffix:semicolon
r_return
id|result
OL
l_int|0
ques
c_cond
id|result
suffix:colon
l_int|0
suffix:semicolon
)brace
r_case
id|SNDRV_PCM_IOCTL_WRITEN_FRAMES
suffix:colon
(brace
id|snd_xfern_t
id|xfern
suffix:semicolon
id|snd_xfern_t
id|__user
op_star
id|_xfern
op_assign
id|arg
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_void
id|__user
op_star
op_star
id|bufs
suffix:semicolon
id|snd_pcm_sframes_t
id|result
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_OPEN
)paren
r_return
op_minus
id|EBADFD
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;channels
OG
l_int|128
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|put_user
c_func
(paren
l_int|0
comma
op_amp
id|_xfern-&gt;result
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|xfern
comma
id|_xfern
comma
r_sizeof
(paren
id|xfern
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|bufs
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_void
op_star
)paren
op_star
id|runtime-&gt;channels
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|bufs
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
id|bufs
comma
id|xfern.bufs
comma
r_sizeof
(paren
r_void
op_star
)paren
op_star
id|runtime-&gt;channels
)paren
)paren
(brace
id|kfree
c_func
(paren
id|bufs
)paren
suffix:semicolon
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
id|result
op_assign
id|snd_pcm_lib_writev
c_func
(paren
id|substream
comma
id|bufs
comma
id|xfern.frames
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|bufs
)paren
suffix:semicolon
id|__put_user
c_func
(paren
id|result
comma
op_amp
id|_xfern-&gt;result
)paren
suffix:semicolon
r_return
id|result
OL
l_int|0
ques
c_cond
id|result
suffix:colon
l_int|0
suffix:semicolon
)brace
r_case
id|SNDRV_PCM_IOCTL_REWIND
suffix:colon
(brace
id|snd_pcm_uframes_t
id|frames
suffix:semicolon
id|snd_pcm_uframes_t
id|__user
op_star
id|_frames
op_assign
id|arg
suffix:semicolon
id|snd_pcm_sframes_t
id|result
suffix:semicolon
r_if
c_cond
(paren
id|get_user
c_func
(paren
id|frames
comma
id|_frames
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
id|put_user
c_func
(paren
l_int|0
comma
id|_frames
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|result
op_assign
id|snd_pcm_playback_rewind
c_func
(paren
id|substream
comma
id|frames
)paren
suffix:semicolon
id|__put_user
c_func
(paren
id|result
comma
id|_frames
)paren
suffix:semicolon
r_return
id|result
OL
l_int|0
ques
c_cond
id|result
suffix:colon
l_int|0
suffix:semicolon
)brace
r_case
id|SNDRV_PCM_IOCTL_FORWARD
suffix:colon
(brace
id|snd_pcm_uframes_t
id|frames
suffix:semicolon
id|snd_pcm_uframes_t
id|__user
op_star
id|_frames
op_assign
id|arg
suffix:semicolon
id|snd_pcm_sframes_t
id|result
suffix:semicolon
r_if
c_cond
(paren
id|get_user
c_func
(paren
id|frames
comma
id|_frames
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
id|put_user
c_func
(paren
l_int|0
comma
id|_frames
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|result
op_assign
id|snd_pcm_playback_forward
c_func
(paren
id|substream
comma
id|frames
)paren
suffix:semicolon
id|__put_user
c_func
(paren
id|result
comma
id|_frames
)paren
suffix:semicolon
r_return
id|result
OL
l_int|0
ques
c_cond
id|result
suffix:colon
l_int|0
suffix:semicolon
)brace
r_case
id|SNDRV_PCM_IOCTL_PAUSE
suffix:colon
(brace
r_int
id|res
suffix:semicolon
id|snd_pcm_stream_lock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
id|res
op_assign
id|snd_pcm_pause
c_func
(paren
id|substream
comma
(paren
r_int
)paren
(paren
r_int
r_int
)paren
id|arg
)paren
suffix:semicolon
id|snd_pcm_stream_unlock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_return
id|res
suffix:semicolon
)brace
)brace
r_return
id|snd_pcm_common_ioctl1
c_func
(paren
id|substream
comma
id|cmd
comma
id|arg
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_capture_ioctl1
r_static
r_int
id|snd_pcm_capture_ioctl1
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
r_int
id|cmd
comma
r_void
id|__user
op_star
id|arg
)paren
(brace
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_CAPTURE
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|SNDRV_PCM_IOCTL_READI_FRAMES
suffix:colon
(brace
id|snd_xferi_t
id|xferi
suffix:semicolon
id|snd_xferi_t
id|__user
op_star
id|_xferi
op_assign
id|arg
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_pcm_sframes_t
id|result
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_OPEN
)paren
r_return
op_minus
id|EBADFD
suffix:semicolon
r_if
c_cond
(paren
id|put_user
c_func
(paren
l_int|0
comma
op_amp
id|_xferi-&gt;result
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|xferi
comma
id|_xferi
comma
r_sizeof
(paren
id|xferi
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|result
op_assign
id|snd_pcm_lib_read
c_func
(paren
id|substream
comma
id|xferi.buf
comma
id|xferi.frames
)paren
suffix:semicolon
id|__put_user
c_func
(paren
id|result
comma
op_amp
id|_xferi-&gt;result
)paren
suffix:semicolon
r_return
id|result
OL
l_int|0
ques
c_cond
id|result
suffix:colon
l_int|0
suffix:semicolon
)brace
r_case
id|SNDRV_PCM_IOCTL_READN_FRAMES
suffix:colon
(brace
id|snd_xfern_t
id|xfern
suffix:semicolon
id|snd_xfern_t
id|__user
op_star
id|_xfern
op_assign
id|arg
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_void
op_star
id|bufs
suffix:semicolon
id|snd_pcm_sframes_t
id|result
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_OPEN
)paren
r_return
op_minus
id|EBADFD
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;channels
OG
l_int|128
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|put_user
c_func
(paren
l_int|0
comma
op_amp
id|_xfern-&gt;result
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|xfern
comma
id|_xfern
comma
r_sizeof
(paren
id|xfern
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|bufs
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_void
op_star
)paren
op_star
id|runtime-&gt;channels
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|bufs
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
id|bufs
comma
id|xfern.bufs
comma
r_sizeof
(paren
r_void
op_star
)paren
op_star
id|runtime-&gt;channels
)paren
)paren
(brace
id|kfree
c_func
(paren
id|bufs
)paren
suffix:semicolon
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
id|result
op_assign
id|snd_pcm_lib_readv
c_func
(paren
id|substream
comma
id|bufs
comma
id|xfern.frames
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|bufs
)paren
suffix:semicolon
id|__put_user
c_func
(paren
id|result
comma
op_amp
id|_xfern-&gt;result
)paren
suffix:semicolon
r_return
id|result
OL
l_int|0
ques
c_cond
id|result
suffix:colon
l_int|0
suffix:semicolon
)brace
r_case
id|SNDRV_PCM_IOCTL_REWIND
suffix:colon
(brace
id|snd_pcm_uframes_t
id|frames
suffix:semicolon
id|snd_pcm_uframes_t
id|__user
op_star
id|_frames
op_assign
id|arg
suffix:semicolon
id|snd_pcm_sframes_t
id|result
suffix:semicolon
r_if
c_cond
(paren
id|get_user
c_func
(paren
id|frames
comma
id|_frames
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
id|put_user
c_func
(paren
l_int|0
comma
id|_frames
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|result
op_assign
id|snd_pcm_capture_rewind
c_func
(paren
id|substream
comma
id|frames
)paren
suffix:semicolon
id|__put_user
c_func
(paren
id|result
comma
id|_frames
)paren
suffix:semicolon
r_return
id|result
OL
l_int|0
ques
c_cond
id|result
suffix:colon
l_int|0
suffix:semicolon
)brace
r_case
id|SNDRV_PCM_IOCTL_FORWARD
suffix:colon
(brace
id|snd_pcm_uframes_t
id|frames
suffix:semicolon
id|snd_pcm_uframes_t
id|__user
op_star
id|_frames
op_assign
id|arg
suffix:semicolon
id|snd_pcm_sframes_t
id|result
suffix:semicolon
r_if
c_cond
(paren
id|get_user
c_func
(paren
id|frames
comma
id|_frames
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
id|put_user
c_func
(paren
l_int|0
comma
id|_frames
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|result
op_assign
id|snd_pcm_capture_forward
c_func
(paren
id|substream
comma
id|frames
)paren
suffix:semicolon
id|__put_user
c_func
(paren
id|result
comma
id|_frames
)paren
suffix:semicolon
r_return
id|result
OL
l_int|0
ques
c_cond
id|result
suffix:colon
l_int|0
suffix:semicolon
)brace
)brace
r_return
id|snd_pcm_common_ioctl1
c_func
(paren
id|substream
comma
id|cmd
comma
id|arg
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_playback_ioctl
r_static
r_int
id|snd_pcm_playback_ioctl
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
comma
r_int
r_int
id|cmd
comma
r_int
r_int
id|arg
)paren
(brace
id|snd_pcm_file_t
op_star
id|pcm_file
suffix:semicolon
r_int
id|err
suffix:semicolon
id|pcm_file
op_assign
id|file-&gt;private_data
suffix:semicolon
r_if
c_cond
(paren
(paren
(paren
id|cmd
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
)paren
op_ne
l_char|&squot;A&squot;
)paren
r_return
op_minus
id|ENOTTY
suffix:semicolon
multiline_comment|/* FIXME: need to unlock BKL to allow preemption */
id|unlock_kernel
c_func
(paren
)paren
suffix:semicolon
id|err
op_assign
id|snd_pcm_playback_ioctl1
c_func
(paren
id|pcm_file-&gt;substream
comma
id|cmd
comma
(paren
r_void
id|__user
op_star
)paren
id|arg
)paren
suffix:semicolon
id|lock_kernel
c_func
(paren
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|function|snd_pcm_capture_ioctl
r_static
r_int
id|snd_pcm_capture_ioctl
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
comma
r_int
r_int
id|cmd
comma
r_int
r_int
id|arg
)paren
(brace
id|snd_pcm_file_t
op_star
id|pcm_file
suffix:semicolon
r_int
id|err
suffix:semicolon
id|pcm_file
op_assign
id|file-&gt;private_data
suffix:semicolon
r_if
c_cond
(paren
(paren
(paren
id|cmd
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
)paren
op_ne
l_char|&squot;A&squot;
)paren
r_return
op_minus
id|ENOTTY
suffix:semicolon
multiline_comment|/* FIXME: need to unlock BKL to allow preemption */
id|unlock_kernel
c_func
(paren
)paren
suffix:semicolon
id|err
op_assign
id|snd_pcm_capture_ioctl1
c_func
(paren
id|pcm_file-&gt;substream
comma
id|cmd
comma
(paren
r_void
id|__user
op_star
)paren
id|arg
)paren
suffix:semicolon
id|lock_kernel
c_func
(paren
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|function|snd_pcm_kernel_playback_ioctl
r_int
id|snd_pcm_kernel_playback_ioctl
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
r_int
id|cmd
comma
r_void
op_star
id|arg
)paren
(brace
id|mm_segment_t
id|fs
suffix:semicolon
r_int
id|result
suffix:semicolon
id|fs
op_assign
id|snd_enter_user
c_func
(paren
)paren
suffix:semicolon
id|result
op_assign
id|snd_pcm_playback_ioctl1
c_func
(paren
id|substream
comma
id|cmd
comma
id|arg
)paren
suffix:semicolon
id|snd_leave_user
c_func
(paren
id|fs
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
DECL|function|snd_pcm_kernel_capture_ioctl
r_int
id|snd_pcm_kernel_capture_ioctl
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
r_int
id|cmd
comma
r_void
op_star
id|arg
)paren
(brace
id|mm_segment_t
id|fs
suffix:semicolon
r_int
id|result
suffix:semicolon
id|fs
op_assign
id|snd_enter_user
c_func
(paren
)paren
suffix:semicolon
id|result
op_assign
id|snd_pcm_capture_ioctl1
c_func
(paren
id|substream
comma
id|cmd
comma
id|arg
)paren
suffix:semicolon
id|snd_leave_user
c_func
(paren
id|fs
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
DECL|function|snd_pcm_kernel_ioctl
r_int
id|snd_pcm_kernel_ioctl
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
r_int
id|cmd
comma
r_void
op_star
id|arg
)paren
(brace
r_switch
c_cond
(paren
id|substream-&gt;stream
)paren
(brace
r_case
id|SNDRV_PCM_STREAM_PLAYBACK
suffix:colon
r_return
id|snd_pcm_kernel_playback_ioctl
c_func
(paren
id|substream
comma
id|cmd
comma
id|arg
)paren
suffix:semicolon
r_case
id|SNDRV_PCM_STREAM_CAPTURE
suffix:colon
r_return
id|snd_pcm_kernel_capture_ioctl
c_func
(paren
id|substream
comma
id|cmd
comma
id|arg
)paren
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
)brace
DECL|function|snd_pcm_read
r_static
id|ssize_t
id|snd_pcm_read
c_func
(paren
r_struct
id|file
op_star
id|file
comma
r_char
id|__user
op_star
id|buf
comma
r_int
id|count
comma
id|loff_t
op_star
id|offset
)paren
(brace
id|snd_pcm_file_t
op_star
id|pcm_file
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
id|snd_pcm_sframes_t
id|result
suffix:semicolon
id|pcm_file
op_assign
id|file-&gt;private_data
suffix:semicolon
id|substream
op_assign
id|pcm_file-&gt;substream
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_OPEN
)paren
r_return
op_minus
id|EBADFD
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|frame_aligned
c_func
(paren
id|runtime
comma
id|count
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|count
op_assign
id|bytes_to_frames
c_func
(paren
id|runtime
comma
id|count
)paren
suffix:semicolon
id|result
op_assign
id|snd_pcm_lib_read
c_func
(paren
id|substream
comma
id|buf
comma
id|count
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
OG
l_int|0
)paren
id|result
op_assign
id|frames_to_bytes
c_func
(paren
id|runtime
comma
id|result
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
DECL|function|snd_pcm_write
r_static
id|ssize_t
id|snd_pcm_write
c_func
(paren
r_struct
id|file
op_star
id|file
comma
r_const
r_char
id|__user
op_star
id|buf
comma
r_int
id|count
comma
id|loff_t
op_star
id|offset
)paren
(brace
id|snd_pcm_file_t
op_star
id|pcm_file
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
id|snd_pcm_sframes_t
id|result
suffix:semicolon
id|pcm_file
op_assign
id|file-&gt;private_data
suffix:semicolon
id|substream
op_assign
id|pcm_file-&gt;substream
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
id|result
op_assign
op_minus
id|ENXIO
suffix:semicolon
r_goto
id|end
)paren
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_OPEN
)paren
(brace
id|result
op_assign
op_minus
id|EBADFD
suffix:semicolon
r_goto
id|end
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|frame_aligned
c_func
(paren
id|runtime
comma
id|count
)paren
)paren
(brace
id|result
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_goto
id|end
suffix:semicolon
)brace
id|count
op_assign
id|bytes_to_frames
c_func
(paren
id|runtime
comma
id|count
)paren
suffix:semicolon
id|result
op_assign
id|snd_pcm_lib_write
c_func
(paren
id|substream
comma
id|buf
comma
id|count
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
OG
l_int|0
)paren
id|result
op_assign
id|frames_to_bytes
c_func
(paren
id|runtime
comma
id|result
)paren
suffix:semicolon
id|end
suffix:colon
r_return
id|result
suffix:semicolon
)brace
DECL|function|snd_pcm_readv
r_static
id|ssize_t
id|snd_pcm_readv
c_func
(paren
r_struct
id|file
op_star
id|file
comma
r_const
r_struct
id|iovec
op_star
id|_vector
comma
r_int
r_int
id|count
comma
id|loff_t
op_star
id|offset
)paren
(brace
id|snd_pcm_file_t
op_star
id|pcm_file
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
id|snd_pcm_sframes_t
id|result
suffix:semicolon
r_int
r_int
id|i
suffix:semicolon
r_void
id|__user
op_star
op_star
id|bufs
suffix:semicolon
id|snd_pcm_uframes_t
id|frames
suffix:semicolon
id|pcm_file
op_assign
id|file-&gt;private_data
suffix:semicolon
id|substream
op_assign
id|pcm_file-&gt;substream
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_OPEN
)paren
r_return
op_minus
id|EBADFD
suffix:semicolon
r_if
c_cond
(paren
id|count
OG
l_int|1024
op_logical_or
id|count
op_ne
id|runtime-&gt;channels
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|frame_aligned
c_func
(paren
id|runtime
comma
id|_vector-&gt;iov_len
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|frames
op_assign
id|bytes_to_samples
c_func
(paren
id|runtime
comma
id|_vector-&gt;iov_len
)paren
suffix:semicolon
id|bufs
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_void
op_star
)paren
op_star
id|count
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|bufs
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|count
suffix:semicolon
op_increment
id|i
)paren
id|bufs
(braket
id|i
)braket
op_assign
id|_vector
(braket
id|i
)braket
dot
id|iov_base
suffix:semicolon
id|result
op_assign
id|snd_pcm_lib_readv
c_func
(paren
id|substream
comma
id|bufs
comma
id|frames
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
OG
l_int|0
)paren
id|result
op_assign
id|frames_to_bytes
c_func
(paren
id|runtime
comma
id|result
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|bufs
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
DECL|function|snd_pcm_writev
r_static
id|ssize_t
id|snd_pcm_writev
c_func
(paren
r_struct
id|file
op_star
id|file
comma
r_const
r_struct
id|iovec
op_star
id|_vector
comma
r_int
r_int
id|count
comma
id|loff_t
op_star
id|offset
)paren
(brace
id|snd_pcm_file_t
op_star
id|pcm_file
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
id|snd_pcm_sframes_t
id|result
suffix:semicolon
r_int
r_int
id|i
suffix:semicolon
r_void
id|__user
op_star
op_star
id|bufs
suffix:semicolon
id|snd_pcm_uframes_t
id|frames
suffix:semicolon
id|pcm_file
op_assign
id|file-&gt;private_data
suffix:semicolon
id|substream
op_assign
id|pcm_file-&gt;substream
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
id|result
op_assign
op_minus
id|ENXIO
suffix:semicolon
r_goto
id|end
)paren
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_OPEN
)paren
(brace
id|result
op_assign
op_minus
id|EBADFD
suffix:semicolon
r_goto
id|end
suffix:semicolon
)brace
r_if
c_cond
(paren
id|count
OG
l_int|128
op_logical_or
id|count
op_ne
id|runtime-&gt;channels
op_logical_or
op_logical_neg
id|frame_aligned
c_func
(paren
id|runtime
comma
id|_vector-&gt;iov_len
)paren
)paren
(brace
id|result
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_goto
id|end
suffix:semicolon
)brace
id|frames
op_assign
id|bytes_to_samples
c_func
(paren
id|runtime
comma
id|_vector-&gt;iov_len
)paren
suffix:semicolon
id|bufs
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_void
op_star
)paren
op_star
id|count
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|bufs
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|count
suffix:semicolon
op_increment
id|i
)paren
id|bufs
(braket
id|i
)braket
op_assign
id|_vector
(braket
id|i
)braket
dot
id|iov_base
suffix:semicolon
id|result
op_assign
id|snd_pcm_lib_writev
c_func
(paren
id|substream
comma
id|bufs
comma
id|frames
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
OG
l_int|0
)paren
id|result
op_assign
id|frames_to_bytes
c_func
(paren
id|runtime
comma
id|result
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|bufs
)paren
suffix:semicolon
id|end
suffix:colon
r_return
id|result
suffix:semicolon
)brace
DECL|function|snd_pcm_playback_poll
r_int
r_int
id|snd_pcm_playback_poll
c_func
(paren
r_struct
id|file
op_star
id|file
comma
id|poll_table
op_star
id|wait
)paren
(brace
id|snd_pcm_file_t
op_star
id|pcm_file
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_int
r_int
id|mask
suffix:semicolon
id|snd_pcm_uframes_t
id|avail
suffix:semicolon
id|pcm_file
op_assign
id|file-&gt;private_data
suffix:semicolon
id|substream
op_assign
id|pcm_file-&gt;substream
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|poll_wait
c_func
(paren
id|file
comma
op_amp
id|runtime-&gt;sleep
comma
id|wait
)paren
suffix:semicolon
id|snd_pcm_stream_lock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
id|avail
op_assign
id|snd_pcm_playback_avail
c_func
(paren
id|runtime
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|runtime-&gt;status-&gt;state
)paren
(brace
r_case
id|SNDRV_PCM_STATE_RUNNING
suffix:colon
r_case
id|SNDRV_PCM_STATE_PREPARED
suffix:colon
r_case
id|SNDRV_PCM_STATE_PAUSED
suffix:colon
r_if
c_cond
(paren
id|avail
op_ge
id|runtime-&gt;control-&gt;avail_min
)paren
(brace
id|mask
op_assign
id|POLLOUT
op_or
id|POLLWRNORM
suffix:semicolon
r_break
suffix:semicolon
)brace
multiline_comment|/* Fall through */
r_case
id|SNDRV_PCM_STATE_DRAINING
suffix:colon
id|mask
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|mask
op_assign
id|POLLOUT
op_or
id|POLLWRNORM
op_or
id|POLLERR
suffix:semicolon
r_break
suffix:semicolon
)brace
id|snd_pcm_stream_unlock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_return
id|mask
suffix:semicolon
)brace
DECL|function|snd_pcm_capture_poll
r_int
r_int
id|snd_pcm_capture_poll
c_func
(paren
r_struct
id|file
op_star
id|file
comma
id|poll_table
op_star
id|wait
)paren
(brace
id|snd_pcm_file_t
op_star
id|pcm_file
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_int
r_int
id|mask
suffix:semicolon
id|snd_pcm_uframes_t
id|avail
suffix:semicolon
id|pcm_file
op_assign
id|file-&gt;private_data
suffix:semicolon
id|substream
op_assign
id|pcm_file-&gt;substream
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|poll_wait
c_func
(paren
id|file
comma
op_amp
id|runtime-&gt;sleep
comma
id|wait
)paren
suffix:semicolon
id|snd_pcm_stream_lock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
id|avail
op_assign
id|snd_pcm_capture_avail
c_func
(paren
id|runtime
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|runtime-&gt;status-&gt;state
)paren
(brace
r_case
id|SNDRV_PCM_STATE_RUNNING
suffix:colon
r_case
id|SNDRV_PCM_STATE_PREPARED
suffix:colon
r_case
id|SNDRV_PCM_STATE_PAUSED
suffix:colon
r_if
c_cond
(paren
id|avail
op_ge
id|runtime-&gt;control-&gt;avail_min
)paren
(brace
id|mask
op_assign
id|POLLIN
op_or
id|POLLRDNORM
suffix:semicolon
r_break
suffix:semicolon
)brace
id|mask
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_DRAINING
suffix:colon
r_if
c_cond
(paren
id|avail
OG
l_int|0
)paren
(brace
id|mask
op_assign
id|POLLIN
op_or
id|POLLRDNORM
suffix:semicolon
r_break
suffix:semicolon
)brace
multiline_comment|/* Fall through */
r_default
suffix:colon
id|mask
op_assign
id|POLLIN
op_or
id|POLLRDNORM
op_or
id|POLLERR
suffix:semicolon
r_break
suffix:semicolon
)brace
id|snd_pcm_stream_unlock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_return
id|mask
suffix:semicolon
)brace
multiline_comment|/*&n; * mmap support&n; */
multiline_comment|/*&n; * Only on coherent architectures, we can mmap the status and the control records&n; * for effcient data transfer.  On others, we have to use HWSYNC ioctl...&n; */
macro_line|#if defined(CONFIG_X86) || defined(CONFIG_PPC) || defined(CONFIG_ALPHA)
multiline_comment|/*&n; * mmap status record&n; */
DECL|function|snd_pcm_mmap_status_nopage
r_static
r_struct
id|page
op_star
id|snd_pcm_mmap_status_nopage
c_func
(paren
r_struct
id|vm_area_struct
op_star
id|area
comma
r_int
r_int
id|address
comma
r_int
op_star
id|type
)paren
(brace
id|snd_pcm_substream_t
op_star
id|substream
op_assign
(paren
id|snd_pcm_substream_t
op_star
)paren
id|area-&gt;vm_private_data
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_struct
id|page
op_star
id|page
suffix:semicolon
r_if
c_cond
(paren
id|substream
op_eq
l_int|NULL
)paren
r_return
id|NOPAGE_OOM
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|page
op_assign
id|virt_to_page
c_func
(paren
id|runtime-&gt;status
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|PageReserved
c_func
(paren
id|page
)paren
)paren
id|get_page
c_func
(paren
id|page
)paren
suffix:semicolon
r_if
c_cond
(paren
id|type
)paren
op_star
id|type
op_assign
id|VM_FAULT_MINOR
suffix:semicolon
r_return
id|page
suffix:semicolon
)brace
DECL|variable|snd_pcm_vm_ops_status
r_static
r_struct
id|vm_operations_struct
id|snd_pcm_vm_ops_status
op_assign
(brace
dot
id|nopage
op_assign
id|snd_pcm_mmap_status_nopage
comma
)brace
suffix:semicolon
DECL|function|snd_pcm_mmap_status
r_static
r_int
id|snd_pcm_mmap_status
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_struct
id|file
op_star
id|file
comma
r_struct
id|vm_area_struct
op_star
id|area
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_int
id|size
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|area-&gt;vm_flags
op_amp
id|VM_READ
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_assert
c_func
(paren
id|runtime
op_ne
l_int|NULL
comma
r_return
op_minus
id|EAGAIN
)paren
suffix:semicolon
id|size
op_assign
id|area-&gt;vm_end
op_minus
id|area-&gt;vm_start
suffix:semicolon
r_if
c_cond
(paren
id|size
op_ne
id|PAGE_ALIGN
c_func
(paren
r_sizeof
(paren
id|snd_pcm_mmap_status_t
)paren
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|area-&gt;vm_ops
op_assign
op_amp
id|snd_pcm_vm_ops_status
suffix:semicolon
id|area-&gt;vm_private_data
op_assign
id|substream
suffix:semicolon
id|area-&gt;vm_flags
op_or_assign
id|VM_RESERVED
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * mmap control record&n; */
DECL|function|snd_pcm_mmap_control_nopage
r_static
r_struct
id|page
op_star
id|snd_pcm_mmap_control_nopage
c_func
(paren
r_struct
id|vm_area_struct
op_star
id|area
comma
r_int
r_int
id|address
comma
r_int
op_star
id|type
)paren
(brace
id|snd_pcm_substream_t
op_star
id|substream
op_assign
(paren
id|snd_pcm_substream_t
op_star
)paren
id|area-&gt;vm_private_data
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_struct
id|page
op_star
id|page
suffix:semicolon
r_if
c_cond
(paren
id|substream
op_eq
l_int|NULL
)paren
r_return
id|NOPAGE_OOM
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|page
op_assign
id|virt_to_page
c_func
(paren
id|runtime-&gt;control
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|PageReserved
c_func
(paren
id|page
)paren
)paren
id|get_page
c_func
(paren
id|page
)paren
suffix:semicolon
r_if
c_cond
(paren
id|type
)paren
op_star
id|type
op_assign
id|VM_FAULT_MINOR
suffix:semicolon
r_return
id|page
suffix:semicolon
)brace
DECL|variable|snd_pcm_vm_ops_control
r_static
r_struct
id|vm_operations_struct
id|snd_pcm_vm_ops_control
op_assign
(brace
dot
id|nopage
op_assign
id|snd_pcm_mmap_control_nopage
comma
)brace
suffix:semicolon
DECL|function|snd_pcm_mmap_control
r_static
r_int
id|snd_pcm_mmap_control
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_struct
id|file
op_star
id|file
comma
r_struct
id|vm_area_struct
op_star
id|area
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_int
id|size
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|area-&gt;vm_flags
op_amp
id|VM_READ
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_assert
c_func
(paren
id|runtime
op_ne
l_int|NULL
comma
r_return
op_minus
id|EAGAIN
)paren
suffix:semicolon
id|size
op_assign
id|area-&gt;vm_end
op_minus
id|area-&gt;vm_start
suffix:semicolon
r_if
c_cond
(paren
id|size
op_ne
id|PAGE_ALIGN
c_func
(paren
r_sizeof
(paren
id|snd_pcm_mmap_control_t
)paren
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|area-&gt;vm_ops
op_assign
op_amp
id|snd_pcm_vm_ops_control
suffix:semicolon
id|area-&gt;vm_private_data
op_assign
id|substream
suffix:semicolon
id|area-&gt;vm_flags
op_or_assign
id|VM_RESERVED
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#else /* ! coherent mmap */
multiline_comment|/*&n; * don&squot;t support mmap for status and control records.&n; */
DECL|function|snd_pcm_mmap_status
r_static
r_int
id|snd_pcm_mmap_status
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_struct
id|file
op_star
id|file
comma
r_struct
id|vm_area_struct
op_star
id|area
)paren
(brace
r_return
op_minus
id|ENXIO
suffix:semicolon
)brace
DECL|function|snd_pcm_mmap_control
r_static
r_int
id|snd_pcm_mmap_control
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_struct
id|file
op_star
id|file
comma
r_struct
id|vm_area_struct
op_star
id|area
)paren
(brace
r_return
op_minus
id|ENXIO
suffix:semicolon
)brace
macro_line|#endif /* coherent mmap */
multiline_comment|/*&n; * nopage callback for mmapping a RAM page&n; */
DECL|function|snd_pcm_mmap_data_nopage
r_static
r_struct
id|page
op_star
id|snd_pcm_mmap_data_nopage
c_func
(paren
r_struct
id|vm_area_struct
op_star
id|area
comma
r_int
r_int
id|address
comma
r_int
op_star
id|type
)paren
(brace
id|snd_pcm_substream_t
op_star
id|substream
op_assign
(paren
id|snd_pcm_substream_t
op_star
)paren
id|area-&gt;vm_private_data
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_int
r_int
id|offset
suffix:semicolon
r_struct
id|page
op_star
id|page
suffix:semicolon
r_void
op_star
id|vaddr
suffix:semicolon
r_int
id|dma_bytes
suffix:semicolon
r_if
c_cond
(paren
id|substream
op_eq
l_int|NULL
)paren
r_return
id|NOPAGE_OOM
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|offset
op_assign
id|area-&gt;vm_pgoff
op_lshift
id|PAGE_SHIFT
suffix:semicolon
id|offset
op_add_assign
id|address
op_minus
id|area-&gt;vm_start
suffix:semicolon
id|snd_assert
c_func
(paren
(paren
id|offset
op_mod
id|PAGE_SIZE
)paren
op_eq
l_int|0
comma
r_return
id|NOPAGE_OOM
)paren
suffix:semicolon
id|dma_bytes
op_assign
id|PAGE_ALIGN
c_func
(paren
id|runtime-&gt;dma_bytes
)paren
suffix:semicolon
r_if
c_cond
(paren
id|offset
OG
id|dma_bytes
op_minus
id|PAGE_SIZE
)paren
r_return
id|NOPAGE_SIGBUS
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;ops-&gt;page
)paren
(brace
id|page
op_assign
id|substream-&gt;ops
op_member_access_from_pointer
id|page
c_func
(paren
id|substream
comma
id|offset
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|page
)paren
r_return
id|NOPAGE_OOM
suffix:semicolon
)brace
r_else
(brace
id|vaddr
op_assign
id|runtime-&gt;dma_area
op_plus
id|offset
suffix:semicolon
id|page
op_assign
id|virt_to_page
c_func
(paren
id|vaddr
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|PageReserved
c_func
(paren
id|page
)paren
)paren
id|get_page
c_func
(paren
id|page
)paren
suffix:semicolon
r_if
c_cond
(paren
id|type
)paren
op_star
id|type
op_assign
id|VM_FAULT_MINOR
suffix:semicolon
r_return
id|page
suffix:semicolon
)brace
DECL|variable|snd_pcm_vm_ops_data
r_static
r_struct
id|vm_operations_struct
id|snd_pcm_vm_ops_data
op_assign
(brace
dot
id|open
op_assign
id|snd_pcm_mmap_data_open
comma
dot
id|close
op_assign
id|snd_pcm_mmap_data_close
comma
dot
id|nopage
op_assign
id|snd_pcm_mmap_data_nopage
comma
)brace
suffix:semicolon
multiline_comment|/*&n; * mmap the DMA buffer on RAM&n; */
DECL|function|snd_pcm_default_mmap
r_static
r_int
id|snd_pcm_default_mmap
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_struct
id|vm_area_struct
op_star
id|area
)paren
(brace
id|area-&gt;vm_ops
op_assign
op_amp
id|snd_pcm_vm_ops_data
suffix:semicolon
id|area-&gt;vm_private_data
op_assign
id|substream
suffix:semicolon
id|area-&gt;vm_flags
op_or_assign
id|VM_RESERVED
suffix:semicolon
id|atomic_inc
c_func
(paren
op_amp
id|substream-&gt;runtime-&gt;mmap_count
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * mmap the DMA buffer on I/O memory area&n; */
macro_line|#if SNDRV_PCM_INFO_MMAP_IOMEM
DECL|variable|snd_pcm_vm_ops_data_mmio
r_static
r_struct
id|vm_operations_struct
id|snd_pcm_vm_ops_data_mmio
op_assign
(brace
dot
id|open
op_assign
id|snd_pcm_mmap_data_open
comma
dot
id|close
op_assign
id|snd_pcm_mmap_data_close
comma
)brace
suffix:semicolon
DECL|function|snd_pcm_lib_mmap_iomem
r_int
id|snd_pcm_lib_mmap_iomem
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_struct
id|vm_area_struct
op_star
id|area
)paren
(brace
r_int
id|size
suffix:semicolon
r_int
r_int
id|offset
suffix:semicolon
macro_line|#ifdef pgprot_noncached
id|area-&gt;vm_page_prot
op_assign
id|pgprot_noncached
c_func
(paren
id|area-&gt;vm_page_prot
)paren
suffix:semicolon
macro_line|#endif
id|area-&gt;vm_ops
op_assign
op_amp
id|snd_pcm_vm_ops_data_mmio
suffix:semicolon
id|area-&gt;vm_private_data
op_assign
id|substream
suffix:semicolon
id|area-&gt;vm_flags
op_or_assign
id|VM_IO
suffix:semicolon
id|size
op_assign
id|area-&gt;vm_end
op_minus
id|area-&gt;vm_start
suffix:semicolon
id|offset
op_assign
id|area-&gt;vm_pgoff
op_lshift
id|PAGE_SHIFT
suffix:semicolon
r_if
c_cond
(paren
id|io_remap_page_range
c_func
(paren
id|area
comma
id|area-&gt;vm_start
comma
id|substream-&gt;runtime-&gt;dma_addr
op_plus
id|offset
comma
id|size
comma
id|area-&gt;vm_page_prot
)paren
)paren
r_return
op_minus
id|EAGAIN
suffix:semicolon
id|atomic_inc
c_func
(paren
op_amp
id|substream-&gt;runtime-&gt;mmap_count
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#endif /* SNDRV_PCM_INFO_MMAP */
multiline_comment|/*&n; * mmap DMA buffer&n; */
DECL|function|snd_pcm_mmap_data
r_int
id|snd_pcm_mmap_data
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_struct
id|file
op_star
id|file
comma
r_struct
id|vm_area_struct
op_star
id|area
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_int
id|size
suffix:semicolon
r_int
r_int
id|offset
suffix:semicolon
r_int
id|dma_bytes
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_PLAYBACK
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|area-&gt;vm_flags
op_amp
(paren
id|VM_WRITE
op_or
id|VM_READ
)paren
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|area-&gt;vm_flags
op_amp
id|VM_READ
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_assert
c_func
(paren
id|runtime
op_ne
l_int|NULL
comma
r_return
op_minus
id|EAGAIN
)paren
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_OPEN
)paren
r_return
op_minus
id|EBADFD
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|runtime-&gt;info
op_amp
id|SNDRV_PCM_INFO_MMAP
)paren
)paren
r_return
op_minus
id|ENXIO
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;access
op_eq
id|SNDRV_PCM_ACCESS_RW_INTERLEAVED
op_logical_or
id|runtime-&gt;access
op_eq
id|SNDRV_PCM_ACCESS_RW_NONINTERLEAVED
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|size
op_assign
id|area-&gt;vm_end
op_minus
id|area-&gt;vm_start
suffix:semicolon
id|offset
op_assign
id|area-&gt;vm_pgoff
op_lshift
id|PAGE_SHIFT
suffix:semicolon
id|dma_bytes
op_assign
id|PAGE_ALIGN
c_func
(paren
id|runtime-&gt;dma_bytes
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
r_int
)paren
id|size
OG
id|dma_bytes
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|offset
OG
id|dma_bytes
op_minus
id|size
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;ops-&gt;mmap
)paren
r_return
id|substream-&gt;ops
op_member_access_from_pointer
id|mmap
c_func
(paren
id|substream
comma
id|area
)paren
suffix:semicolon
r_else
r_return
id|snd_pcm_default_mmap
c_func
(paren
id|substream
comma
id|area
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_mmap
r_static
r_int
id|snd_pcm_mmap
c_func
(paren
r_struct
id|file
op_star
id|file
comma
r_struct
id|vm_area_struct
op_star
id|area
)paren
(brace
id|snd_pcm_file_t
op_star
id|pcm_file
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
r_int
r_int
id|offset
suffix:semicolon
id|pcm_file
op_assign
id|file-&gt;private_data
suffix:semicolon
id|substream
op_assign
id|pcm_file-&gt;substream
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|offset
op_assign
id|area-&gt;vm_pgoff
op_lshift
id|PAGE_SHIFT
suffix:semicolon
r_switch
c_cond
(paren
id|offset
)paren
(brace
r_case
id|SNDRV_PCM_MMAP_OFFSET_STATUS
suffix:colon
r_if
c_cond
(paren
id|substream-&gt;no_mmap_ctrl
)paren
r_return
op_minus
id|ENXIO
suffix:semicolon
r_return
id|snd_pcm_mmap_status
c_func
(paren
id|substream
comma
id|file
comma
id|area
)paren
suffix:semicolon
r_case
id|SNDRV_PCM_MMAP_OFFSET_CONTROL
suffix:colon
r_if
c_cond
(paren
id|substream-&gt;no_mmap_ctrl
)paren
r_return
op_minus
id|ENXIO
suffix:semicolon
r_return
id|snd_pcm_mmap_control
c_func
(paren
id|substream
comma
id|file
comma
id|area
)paren
suffix:semicolon
r_default
suffix:colon
r_return
id|snd_pcm_mmap_data
c_func
(paren
id|substream
comma
id|file
comma
id|area
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_fasync
r_static
r_int
id|snd_pcm_fasync
c_func
(paren
r_int
id|fd
comma
r_struct
id|file
op_star
id|file
comma
r_int
id|on
)paren
(brace
id|snd_pcm_file_t
op_star
id|pcm_file
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_int
id|err
suffix:semicolon
id|pcm_file
op_assign
id|file-&gt;private_data
suffix:semicolon
id|substream
op_assign
id|pcm_file-&gt;substream
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|err
op_assign
id|fasync_helper
c_func
(paren
id|fd
comma
id|file
comma
id|on
comma
op_amp
id|runtime-&gt;fasync
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; *  To be removed helpers to keep binary compatibility&n; */
DECL|macro|__OLD_TO_NEW_MASK
mdefine_line|#define __OLD_TO_NEW_MASK(x) ((x&amp;7)|((x&amp;0x07fffff8)&lt;&lt;5))
DECL|macro|__NEW_TO_OLD_MASK
mdefine_line|#define __NEW_TO_OLD_MASK(x) ((x&amp;7)|((x&amp;0xffffff00)&gt;&gt;5))
DECL|function|snd_pcm_hw_convert_from_old_params
r_static
r_void
id|snd_pcm_hw_convert_from_old_params
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
r_struct
id|sndrv_pcm_hw_params_old
op_star
id|oparams
)paren
(brace
r_int
r_int
id|i
suffix:semicolon
id|memset
c_func
(paren
id|params
comma
l_int|0
comma
r_sizeof
(paren
op_star
id|params
)paren
)paren
suffix:semicolon
id|params-&gt;flags
op_assign
id|oparams-&gt;flags
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|ARRAY_SIZE
c_func
(paren
id|oparams-&gt;masks
)paren
suffix:semicolon
id|i
op_increment
)paren
id|params-&gt;masks
(braket
id|i
)braket
dot
id|bits
(braket
l_int|0
)braket
op_assign
id|oparams-&gt;masks
(braket
id|i
)braket
suffix:semicolon
id|memcpy
c_func
(paren
id|params-&gt;intervals
comma
id|oparams-&gt;intervals
comma
r_sizeof
(paren
id|oparams-&gt;intervals
)paren
)paren
suffix:semicolon
id|params-&gt;rmask
op_assign
id|__OLD_TO_NEW_MASK
c_func
(paren
id|oparams-&gt;rmask
)paren
suffix:semicolon
id|params-&gt;cmask
op_assign
id|__OLD_TO_NEW_MASK
c_func
(paren
id|oparams-&gt;cmask
)paren
suffix:semicolon
id|params-&gt;info
op_assign
id|oparams-&gt;info
suffix:semicolon
id|params-&gt;msbits
op_assign
id|oparams-&gt;msbits
suffix:semicolon
id|params-&gt;rate_num
op_assign
id|oparams-&gt;rate_num
suffix:semicolon
id|params-&gt;rate_den
op_assign
id|oparams-&gt;rate_den
suffix:semicolon
id|params-&gt;fifo_size
op_assign
id|oparams-&gt;fifo_size
suffix:semicolon
)brace
DECL|function|snd_pcm_hw_convert_to_old_params
r_static
r_void
id|snd_pcm_hw_convert_to_old_params
c_func
(paren
r_struct
id|sndrv_pcm_hw_params_old
op_star
id|oparams
comma
id|snd_pcm_hw_params_t
op_star
id|params
)paren
(brace
r_int
r_int
id|i
suffix:semicolon
id|memset
c_func
(paren
id|oparams
comma
l_int|0
comma
r_sizeof
(paren
op_star
id|oparams
)paren
)paren
suffix:semicolon
id|oparams-&gt;flags
op_assign
id|params-&gt;flags
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|ARRAY_SIZE
c_func
(paren
id|oparams-&gt;masks
)paren
suffix:semicolon
id|i
op_increment
)paren
id|oparams-&gt;masks
(braket
id|i
)braket
op_assign
id|params-&gt;masks
(braket
id|i
)braket
dot
id|bits
(braket
l_int|0
)braket
suffix:semicolon
id|memcpy
c_func
(paren
id|oparams-&gt;intervals
comma
id|params-&gt;intervals
comma
r_sizeof
(paren
id|oparams-&gt;intervals
)paren
)paren
suffix:semicolon
id|oparams-&gt;rmask
op_assign
id|__NEW_TO_OLD_MASK
c_func
(paren
id|params-&gt;rmask
)paren
suffix:semicolon
id|oparams-&gt;cmask
op_assign
id|__NEW_TO_OLD_MASK
c_func
(paren
id|params-&gt;cmask
)paren
suffix:semicolon
id|oparams-&gt;info
op_assign
id|params-&gt;info
suffix:semicolon
id|oparams-&gt;msbits
op_assign
id|params-&gt;msbits
suffix:semicolon
id|oparams-&gt;rate_num
op_assign
id|params-&gt;rate_num
suffix:semicolon
id|oparams-&gt;rate_den
op_assign
id|params-&gt;rate_den
suffix:semicolon
id|oparams-&gt;fifo_size
op_assign
id|params-&gt;fifo_size
suffix:semicolon
)brace
DECL|function|snd_pcm_hw_refine_old_user
r_static
r_int
id|snd_pcm_hw_refine_old_user
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_struct
id|sndrv_pcm_hw_params_old
id|__user
op_star
id|_oparams
)paren
(brace
id|snd_pcm_hw_params_t
op_star
id|params
suffix:semicolon
r_struct
id|sndrv_pcm_hw_params_old
op_star
id|oparams
op_assign
l_int|NULL
suffix:semicolon
r_int
id|err
suffix:semicolon
id|params
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
op_star
id|params
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|params
)paren
(brace
id|err
op_assign
op_minus
id|ENOMEM
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|oparams
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
op_star
id|oparams
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|oparams
)paren
(brace
id|err
op_assign
op_minus
id|ENOMEM
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
id|oparams
comma
id|_oparams
comma
r_sizeof
(paren
op_star
id|oparams
)paren
)paren
)paren
(brace
id|err
op_assign
op_minus
id|EFAULT
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|snd_pcm_hw_convert_from_old_params
c_func
(paren
id|params
comma
id|oparams
)paren
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_refine
c_func
(paren
id|substream
comma
id|params
)paren
suffix:semicolon
id|snd_pcm_hw_convert_to_old_params
c_func
(paren
id|oparams
comma
id|params
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|_oparams
comma
id|oparams
comma
r_sizeof
(paren
op_star
id|oparams
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|err
)paren
id|err
op_assign
op_minus
id|EFAULT
suffix:semicolon
)brace
id|out
suffix:colon
id|kfree
c_func
(paren
id|params
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|oparams
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|function|snd_pcm_hw_params_old_user
r_static
r_int
id|snd_pcm_hw_params_old_user
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_struct
id|sndrv_pcm_hw_params_old
id|__user
op_star
id|_oparams
)paren
(brace
id|snd_pcm_hw_params_t
op_star
id|params
suffix:semicolon
r_struct
id|sndrv_pcm_hw_params_old
op_star
id|oparams
op_assign
l_int|NULL
suffix:semicolon
r_int
id|err
suffix:semicolon
id|params
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
op_star
id|params
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|params
)paren
(brace
id|err
op_assign
op_minus
id|ENOMEM
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|oparams
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
op_star
id|oparams
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|oparams
)paren
(brace
id|err
op_assign
op_minus
id|ENOMEM
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
id|oparams
comma
id|_oparams
comma
r_sizeof
(paren
op_star
id|oparams
)paren
)paren
)paren
(brace
id|err
op_assign
op_minus
id|EFAULT
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|snd_pcm_hw_convert_from_old_params
c_func
(paren
id|params
comma
id|oparams
)paren
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_params
c_func
(paren
id|substream
comma
id|params
)paren
suffix:semicolon
id|snd_pcm_hw_convert_to_old_params
c_func
(paren
id|oparams
comma
id|params
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|_oparams
comma
id|oparams
comma
r_sizeof
(paren
op_star
id|oparams
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|err
)paren
id|err
op_assign
op_minus
id|EFAULT
suffix:semicolon
)brace
id|out
suffix:colon
id|kfree
c_func
(paren
id|params
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|oparams
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
multiline_comment|/*&n; *  Register section&n; */
DECL|variable|snd_pcm_f_ops_playback
r_static
r_struct
id|file_operations
id|snd_pcm_f_ops_playback
op_assign
(brace
dot
id|owner
op_assign
id|THIS_MODULE
comma
dot
id|write
op_assign
id|snd_pcm_write
comma
dot
id|writev
op_assign
id|snd_pcm_writev
comma
dot
id|open
op_assign
id|snd_pcm_open
comma
dot
id|release
op_assign
id|snd_pcm_release
comma
dot
id|poll
op_assign
id|snd_pcm_playback_poll
comma
dot
id|ioctl
op_assign
id|snd_pcm_playback_ioctl
comma
dot
id|mmap
op_assign
id|snd_pcm_mmap
comma
dot
id|fasync
op_assign
id|snd_pcm_fasync
comma
)brace
suffix:semicolon
DECL|variable|snd_pcm_f_ops_capture
r_static
r_struct
id|file_operations
id|snd_pcm_f_ops_capture
op_assign
(brace
dot
id|owner
op_assign
id|THIS_MODULE
comma
dot
id|read
op_assign
id|snd_pcm_read
comma
dot
id|readv
op_assign
id|snd_pcm_readv
comma
dot
id|open
op_assign
id|snd_pcm_open
comma
dot
id|release
op_assign
id|snd_pcm_release
comma
dot
id|poll
op_assign
id|snd_pcm_capture_poll
comma
dot
id|ioctl
op_assign
id|snd_pcm_capture_ioctl
comma
dot
id|mmap
op_assign
id|snd_pcm_mmap
comma
dot
id|fasync
op_assign
id|snd_pcm_fasync
comma
)brace
suffix:semicolon
DECL|variable|snd_pcm_reg
id|snd_minor_t
id|snd_pcm_reg
(braket
l_int|2
)braket
op_assign
(brace
(brace
dot
id|comment
op_assign
l_string|&quot;digital audio playback&quot;
comma
dot
id|f_ops
op_assign
op_amp
id|snd_pcm_f_ops_playback
comma
)brace
comma
(brace
dot
id|comment
op_assign
l_string|&quot;digital audio capture&quot;
comma
dot
id|f_ops
op_assign
op_amp
id|snd_pcm_f_ops_capture
comma
)brace
)brace
suffix:semicolon
eof
