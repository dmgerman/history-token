multiline_comment|/*&n; *  Digital Audio (PCM) abstract layer&n; *  Copyright (c) by Jaroslav Kysela &lt;perex@suse.cz&gt;&n; *&n; *&n; *   This program is free software; you can redistribute it and/or modify&n; *   it under the terms of the GNU General Public License as published by&n; *   the Free Software Foundation; either version 2 of the License, or&n; *   (at your option) any later version.&n; *&n; *   This program is distributed in the hope that it will be useful,&n; *   but WITHOUT ANY WARRANTY; without even the implied warranty of&n; *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; *   GNU General Public License for more details.&n; *&n; *   You should have received a copy of the GNU General Public License&n; *   along with this program; if not, write to the Free Software&n; *   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA&n; *&n; */
DECL|macro|__NO_VERSION__
mdefine_line|#define __NO_VERSION__
macro_line|#include &lt;sound/driver.h&gt;
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;linux/file.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;linux/time.h&gt;
macro_line|#include &lt;sound/core.h&gt;
macro_line|#include &lt;sound/control.h&gt;
macro_line|#include &lt;sound/info.h&gt;
macro_line|#include &lt;sound/pcm.h&gt;
macro_line|#include &lt;sound/pcm_params.h&gt;
macro_line|#include &lt;sound/minors.h&gt;
DECL|variable|pcm_link_lock
id|spinlock_t
id|pcm_link_lock
op_assign
id|SPIN_LOCK_UNLOCKED
suffix:semicolon
DECL|function|snd_enter_user
r_static
r_inline
id|mm_segment_t
id|snd_enter_user
c_func
(paren
r_void
)paren
(brace
id|mm_segment_t
id|fs
op_assign
id|get_fs
c_func
(paren
)paren
suffix:semicolon
id|set_fs
c_func
(paren
id|get_ds
c_func
(paren
)paren
)paren
suffix:semicolon
r_return
id|fs
suffix:semicolon
)brace
DECL|function|snd_leave_user
r_static
r_inline
r_void
id|snd_leave_user
c_func
(paren
id|mm_segment_t
id|fs
)paren
(brace
id|set_fs
c_func
(paren
id|fs
)paren
suffix:semicolon
)brace
DECL|function|dec_mod_count
r_static
r_inline
r_void
id|dec_mod_count
c_func
(paren
r_struct
id|module
op_star
id|module
)paren
(brace
r_if
c_cond
(paren
id|module
)paren
id|__MOD_DEC_USE_COUNT
c_func
(paren
id|module
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_info
r_int
id|snd_pcm_info
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_info_t
op_star
id|info
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
id|snd_pcm_t
op_star
id|pcm
op_assign
id|substream-&gt;pcm
suffix:semicolon
id|snd_pcm_str_t
op_star
id|pstr
op_assign
id|substream-&gt;pstr
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|memset
c_func
(paren
id|info
comma
l_int|0
comma
r_sizeof
(paren
op_star
id|info
)paren
)paren
suffix:semicolon
id|info-&gt;card
op_assign
id|pcm-&gt;card-&gt;number
suffix:semicolon
id|info-&gt;device
op_assign
id|pcm-&gt;device
suffix:semicolon
id|info-&gt;stream
op_assign
id|substream-&gt;stream
suffix:semicolon
id|info-&gt;subdevice
op_assign
id|substream-&gt;number
suffix:semicolon
id|strncpy
c_func
(paren
id|info-&gt;id
comma
id|pcm-&gt;id
comma
r_sizeof
(paren
id|info-&gt;id
)paren
op_minus
l_int|1
)paren
suffix:semicolon
id|strncpy
c_func
(paren
id|info-&gt;name
comma
id|pcm-&gt;name
comma
r_sizeof
(paren
id|info-&gt;name
)paren
op_minus
l_int|1
)paren
suffix:semicolon
id|info-&gt;dev_class
op_assign
id|pcm-&gt;dev_class
suffix:semicolon
id|info-&gt;dev_subclass
op_assign
id|pcm-&gt;dev_subclass
suffix:semicolon
id|info-&gt;subdevices_count
op_assign
id|pstr-&gt;substream_count
suffix:semicolon
id|info-&gt;subdevices_avail
op_assign
id|pstr-&gt;substream_count
op_minus
id|pstr-&gt;substream_opened
suffix:semicolon
id|strncpy
c_func
(paren
id|info-&gt;subname
comma
id|substream-&gt;name
comma
r_sizeof
(paren
id|info-&gt;subname
)paren
op_minus
l_int|1
)paren
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
multiline_comment|/* AB: FIXME!!! This is definitely nonsense */
r_if
c_cond
(paren
id|runtime
)paren
(brace
id|info-&gt;sync
op_assign
id|runtime-&gt;sync
suffix:semicolon
id|substream-&gt;ops
op_member_access_from_pointer
id|ioctl
c_func
(paren
id|substream
comma
id|SNDRV_PCM_IOCTL1_INFO
comma
id|info
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_info_user
r_int
id|snd_pcm_info_user
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_info_t
op_star
id|_info
)paren
(brace
id|snd_pcm_info_t
id|info
suffix:semicolon
r_int
id|err
op_assign
id|snd_pcm_info
c_func
(paren
id|substream
comma
op_amp
id|info
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|_info
comma
op_amp
id|info
comma
r_sizeof
(paren
id|info
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|macro|RULES_DEBUG
macro_line|#undef RULES_DEBUG
macro_line|#ifdef RULES_DEBUG
DECL|macro|HW_PARAM
mdefine_line|#define HW_PARAM(v) [SNDRV_PCM_HW_PARAM_##v] = #v
DECL|variable|snd_pcm_hw_param_names
r_char
op_star
id|snd_pcm_hw_param_names
(braket
)braket
op_assign
(brace
id|HW_PARAM
c_func
(paren
id|ACCESS
)paren
comma
id|HW_PARAM
c_func
(paren
id|FORMAT
)paren
comma
id|HW_PARAM
c_func
(paren
id|SUBFORMAT
)paren
comma
id|HW_PARAM
c_func
(paren
id|SAMPLE_BITS
)paren
comma
id|HW_PARAM
c_func
(paren
id|FRAME_BITS
)paren
comma
id|HW_PARAM
c_func
(paren
id|CHANNELS
)paren
comma
id|HW_PARAM
c_func
(paren
id|RATE
)paren
comma
id|HW_PARAM
c_func
(paren
id|PERIOD_TIME
)paren
comma
id|HW_PARAM
c_func
(paren
id|PERIOD_SIZE
)paren
comma
id|HW_PARAM
c_func
(paren
id|PERIOD_BYTES
)paren
comma
id|HW_PARAM
c_func
(paren
id|PERIODS
)paren
comma
id|HW_PARAM
c_func
(paren
id|BUFFER_TIME
)paren
comma
id|HW_PARAM
c_func
(paren
id|BUFFER_SIZE
)paren
comma
id|HW_PARAM
c_func
(paren
id|BUFFER_BYTES
)paren
comma
id|HW_PARAM
c_func
(paren
id|TICK_TIME
)paren
comma
)brace
suffix:semicolon
macro_line|#endif
DECL|function|snd_pcm_hw_refine
r_int
id|snd_pcm_hw_refine
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_hw_params_t
op_star
id|params
)paren
(brace
r_int
r_int
id|k
suffix:semicolon
id|snd_pcm_hardware_t
op_star
id|hw
suffix:semicolon
id|snd_interval_t
op_star
id|i
op_assign
l_int|NULL
suffix:semicolon
id|snd_mask_t
op_star
id|m
op_assign
l_int|NULL
suffix:semicolon
id|snd_pcm_hw_constraints_t
op_star
id|constrs
op_assign
op_amp
id|substream-&gt;runtime-&gt;hw_constraints
suffix:semicolon
r_int
r_int
id|rstamps
(braket
id|constrs-&gt;rules_num
)braket
suffix:semicolon
r_int
r_int
id|vstamps
(braket
id|SNDRV_PCM_HW_PARAM_LAST
op_plus
l_int|1
)braket
suffix:semicolon
r_int
r_int
id|stamp
op_assign
l_int|2
suffix:semicolon
r_int
id|changed
comma
id|again
suffix:semicolon
id|params-&gt;info
op_assign
l_int|0
suffix:semicolon
id|params-&gt;fifo_size
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|params-&gt;rmask
op_amp
(paren
l_int|1
op_lshift
id|SNDRV_PCM_HW_PARAM_SAMPLE_BITS
)paren
)paren
id|params-&gt;msbits
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|params-&gt;rmask
op_amp
(paren
l_int|1
op_lshift
id|SNDRV_PCM_HW_PARAM_RATE
)paren
)paren
(brace
id|params-&gt;rate_num
op_assign
l_int|0
suffix:semicolon
id|params-&gt;rate_den
op_assign
l_int|0
suffix:semicolon
)brace
r_for
c_loop
(paren
id|k
op_assign
id|SNDRV_PCM_HW_PARAM_FIRST_MASK
suffix:semicolon
id|k
op_le
id|SNDRV_PCM_HW_PARAM_LAST_MASK
suffix:semicolon
id|k
op_increment
)paren
(brace
id|m
op_assign
id|hw_param_mask
c_func
(paren
id|params
comma
id|k
)paren
suffix:semicolon
r_if
c_cond
(paren
id|snd_mask_empty
c_func
(paren
id|m
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|params-&gt;rmask
op_amp
(paren
l_int|1
op_lshift
id|k
)paren
)paren
)paren
r_continue
suffix:semicolon
macro_line|#ifdef RULES_DEBUG
id|printk
c_func
(paren
l_string|&quot;%s = &quot;
comma
id|snd_pcm_hw_param_names
(braket
id|k
)braket
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%x -&gt; &quot;
comma
op_star
id|m
)paren
suffix:semicolon
macro_line|#endif
id|changed
op_assign
id|snd_mask_refine
c_func
(paren
id|m
comma
id|constrs_mask
c_func
(paren
id|constrs
comma
id|k
)paren
)paren
suffix:semicolon
macro_line|#ifdef RULES_DEBUG
id|printk
c_func
(paren
l_string|&quot;%x&bslash;n&quot;
comma
op_star
id|m
)paren
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
id|changed
)paren
id|params-&gt;cmask
op_or_assign
l_int|1
op_lshift
id|k
suffix:semicolon
r_if
c_cond
(paren
id|changed
OL
l_int|0
)paren
r_return
id|changed
suffix:semicolon
)brace
r_for
c_loop
(paren
id|k
op_assign
id|SNDRV_PCM_HW_PARAM_FIRST_INTERVAL
suffix:semicolon
id|k
op_le
id|SNDRV_PCM_HW_PARAM_LAST_INTERVAL
suffix:semicolon
id|k
op_increment
)paren
(brace
id|i
op_assign
id|hw_param_interval
c_func
(paren
id|params
comma
id|k
)paren
suffix:semicolon
r_if
c_cond
(paren
id|snd_interval_empty
c_func
(paren
id|i
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|params-&gt;rmask
op_amp
(paren
l_int|1
op_lshift
id|k
)paren
)paren
)paren
r_continue
suffix:semicolon
macro_line|#ifdef RULES_DEBUG
id|printk
c_func
(paren
l_string|&quot;%s = &quot;
comma
id|snd_pcm_hw_param_names
(braket
id|k
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
id|i-&gt;empty
)paren
id|printk
c_func
(paren
l_string|&quot;empty&quot;
)paren
suffix:semicolon
r_else
id|printk
c_func
(paren
l_string|&quot;%c%u %u%c&quot;
comma
id|i-&gt;openmin
ques
c_cond
l_char|&squot;(&squot;
suffix:colon
l_char|&squot;[&squot;
comma
id|i-&gt;min
comma
id|i-&gt;max
comma
id|i-&gt;openmax
ques
c_cond
l_char|&squot;)&squot;
suffix:colon
l_char|&squot;]&squot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot; -&gt; &quot;
)paren
suffix:semicolon
macro_line|#endif
id|changed
op_assign
id|snd_interval_refine
c_func
(paren
id|i
comma
id|constrs_interval
c_func
(paren
id|constrs
comma
id|k
)paren
)paren
suffix:semicolon
macro_line|#ifdef RULES_DEBUG
r_if
c_cond
(paren
id|i-&gt;empty
)paren
id|printk
c_func
(paren
l_string|&quot;empty&bslash;n&quot;
)paren
suffix:semicolon
r_else
id|printk
c_func
(paren
l_string|&quot;%c%u %u%c&bslash;n&quot;
comma
id|i-&gt;openmin
ques
c_cond
l_char|&squot;(&squot;
suffix:colon
l_char|&squot;[&squot;
comma
id|i-&gt;min
comma
id|i-&gt;max
comma
id|i-&gt;openmax
ques
c_cond
l_char|&squot;)&squot;
suffix:colon
l_char|&squot;]&squot;
)paren
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
id|changed
)paren
id|params-&gt;cmask
op_or_assign
l_int|1
op_lshift
id|k
suffix:semicolon
r_if
c_cond
(paren
id|changed
OL
l_int|0
)paren
r_return
id|changed
suffix:semicolon
)brace
r_for
c_loop
(paren
id|k
op_assign
l_int|0
suffix:semicolon
id|k
OL
id|constrs-&gt;rules_num
suffix:semicolon
id|k
op_increment
)paren
id|rstamps
(braket
id|k
)braket
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|k
op_assign
l_int|0
suffix:semicolon
id|k
op_le
id|SNDRV_PCM_HW_PARAM_LAST
suffix:semicolon
id|k
op_increment
)paren
id|vstamps
(braket
id|k
)braket
op_assign
(paren
id|params-&gt;rmask
op_amp
(paren
l_int|1
op_lshift
id|k
)paren
)paren
ques
c_cond
l_int|1
suffix:colon
l_int|0
suffix:semicolon
r_do
(brace
id|again
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|k
op_assign
l_int|0
suffix:semicolon
id|k
OL
id|constrs-&gt;rules_num
suffix:semicolon
id|k
op_increment
)paren
(brace
id|snd_pcm_hw_rule_t
op_star
id|r
op_assign
op_amp
id|constrs-&gt;rules
(braket
id|k
)braket
suffix:semicolon
r_int
r_int
id|d
suffix:semicolon
r_int
id|doit
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|r-&gt;cond
op_logical_and
op_logical_neg
(paren
id|r-&gt;cond
op_amp
id|params-&gt;flags
)paren
)paren
r_continue
suffix:semicolon
r_for
c_loop
(paren
id|d
op_assign
l_int|0
suffix:semicolon
id|r-&gt;deps
(braket
id|d
)braket
op_ge
l_int|0
suffix:semicolon
id|d
op_increment
)paren
(brace
r_if
c_cond
(paren
id|vstamps
(braket
id|r-&gt;deps
(braket
id|d
)braket
)braket
OG
id|rstamps
(braket
id|k
)braket
)paren
(brace
id|doit
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
op_logical_neg
id|doit
)paren
r_continue
suffix:semicolon
macro_line|#ifdef RULES_DEBUG
id|printk
c_func
(paren
l_string|&quot;Rule %d [%p]: &quot;
comma
id|k
comma
id|r-&gt;func
)paren
suffix:semicolon
r_if
c_cond
(paren
id|r-&gt;var
op_ge
l_int|0
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s = &quot;
comma
id|snd_pcm_hw_param_names
(braket
id|r-&gt;var
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hw_is_mask
c_func
(paren
id|r-&gt;var
)paren
)paren
(brace
id|m
op_assign
id|hw_param_mask
c_func
(paren
id|params
comma
id|r-&gt;var
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%x&quot;
comma
op_star
id|m
)paren
suffix:semicolon
)brace
r_else
(brace
id|i
op_assign
id|hw_param_interval
c_func
(paren
id|params
comma
id|r-&gt;var
)paren
suffix:semicolon
r_if
c_cond
(paren
id|i-&gt;empty
)paren
id|printk
c_func
(paren
l_string|&quot;empty&quot;
)paren
suffix:semicolon
r_else
id|printk
c_func
(paren
l_string|&quot;%c%u %u%c&quot;
comma
id|i-&gt;openmin
ques
c_cond
l_char|&squot;(&squot;
suffix:colon
l_char|&squot;[&squot;
comma
id|i-&gt;min
comma
id|i-&gt;max
comma
id|i-&gt;openmax
ques
c_cond
l_char|&squot;)&squot;
suffix:colon
l_char|&squot;]&squot;
)paren
suffix:semicolon
)brace
)brace
macro_line|#endif
id|changed
op_assign
id|r
op_member_access_from_pointer
id|func
c_func
(paren
id|params
comma
id|r
)paren
suffix:semicolon
macro_line|#ifdef RULES_DEBUG
r_if
c_cond
(paren
id|r-&gt;var
op_ge
l_int|0
)paren
(brace
id|printk
c_func
(paren
l_string|&quot; -&gt; &quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hw_is_mask
c_func
(paren
id|r-&gt;var
)paren
)paren
id|printk
c_func
(paren
l_string|&quot;%x&quot;
comma
op_star
id|m
)paren
suffix:semicolon
r_else
(brace
r_if
c_cond
(paren
id|i-&gt;empty
)paren
id|printk
c_func
(paren
l_string|&quot;empty&quot;
)paren
suffix:semicolon
r_else
id|printk
c_func
(paren
l_string|&quot;%c%u %u%c&quot;
comma
id|i-&gt;openmin
ques
c_cond
l_char|&squot;(&squot;
suffix:colon
l_char|&squot;[&squot;
comma
id|i-&gt;min
comma
id|i-&gt;max
comma
id|i-&gt;openmax
ques
c_cond
l_char|&squot;)&squot;
suffix:colon
l_char|&squot;]&squot;
)paren
suffix:semicolon
)brace
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
macro_line|#endif
id|rstamps
(braket
id|k
)braket
op_assign
id|stamp
suffix:semicolon
r_if
c_cond
(paren
id|changed
op_logical_and
id|r-&gt;var
op_ge
l_int|0
)paren
(brace
id|params-&gt;cmask
op_or_assign
(paren
l_int|1
op_lshift
id|r-&gt;var
)paren
suffix:semicolon
id|vstamps
(braket
id|r-&gt;var
)braket
op_assign
id|stamp
suffix:semicolon
id|again
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|changed
OL
l_int|0
)paren
r_return
id|changed
suffix:semicolon
id|stamp
op_increment
suffix:semicolon
)brace
)brace
r_while
c_loop
(paren
id|again
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|params-&gt;msbits
)paren
(brace
id|i
op_assign
id|hw_param_interval
c_func
(paren
id|params
comma
id|SNDRV_PCM_HW_PARAM_SAMPLE_BITS
)paren
suffix:semicolon
r_if
c_cond
(paren
id|snd_interval_single
c_func
(paren
id|i
)paren
)paren
id|params-&gt;msbits
op_assign
id|snd_interval_value
c_func
(paren
id|i
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|params-&gt;rate_den
)paren
(brace
id|i
op_assign
id|hw_param_interval
c_func
(paren
id|params
comma
id|SNDRV_PCM_HW_PARAM_RATE
)paren
suffix:semicolon
r_if
c_cond
(paren
id|snd_interval_single
c_func
(paren
id|i
)paren
)paren
(brace
id|params-&gt;rate_num
op_assign
id|snd_interval_value
c_func
(paren
id|i
)paren
suffix:semicolon
id|params-&gt;rate_den
op_assign
l_int|1
suffix:semicolon
)brace
)brace
id|hw
op_assign
op_amp
id|substream-&gt;runtime-&gt;hw
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|params-&gt;info
)paren
id|params-&gt;info
op_assign
id|hw-&gt;info
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|params-&gt;fifo_size
)paren
id|params-&gt;fifo_size
op_assign
id|hw-&gt;fifo_size
suffix:semicolon
id|params-&gt;rmask
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_hw_refine_user
r_static
r_int
id|snd_pcm_hw_refine_user
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_hw_params_t
op_star
id|_params
)paren
(brace
id|snd_pcm_hw_params_t
id|params
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|params
comma
id|_params
comma
r_sizeof
(paren
id|params
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_refine
c_func
(paren
id|substream
comma
op_amp
id|params
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|_params
comma
op_amp
id|params
comma
r_sizeof
(paren
id|params
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|function|snd_pcm_hw_params
r_static
r_int
id|snd_pcm_hw_params
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_hw_params_t
op_star
id|params
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_int
id|err
suffix:semicolon
r_int
r_int
id|bits
suffix:semicolon
id|snd_pcm_uframes_t
id|frames
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_assert
c_func
(paren
id|runtime
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|runtime-&gt;status-&gt;state
)paren
(brace
r_case
id|SNDRV_PCM_STATE_OPEN
suffix:colon
r_case
id|SNDRV_PCM_STATE_SETUP
suffix:colon
r_case
id|SNDRV_PCM_STATE_PREPARED
suffix:colon
r_break
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
id|EBADFD
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_SND_OSSEMUL
r_if
c_cond
(paren
op_logical_neg
id|substream-&gt;oss.oss
)paren
macro_line|#endif
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|runtime-&gt;mmap_count
)paren
)paren
r_return
op_minus
id|EBADFD
suffix:semicolon
id|params-&gt;rmask
op_assign
op_complement
l_int|0U
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_refine
c_func
(paren
id|substream
comma
id|params
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_goto
id|_error
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_params_choose
c_func
(paren
id|substream
comma
id|params
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_goto
id|_error
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;ops-&gt;hw_params
op_ne
l_int|NULL
)paren
(brace
id|err
op_assign
id|substream-&gt;ops
op_member_access_from_pointer
id|hw_params
c_func
(paren
id|substream
comma
id|params
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_goto
id|_error
suffix:semicolon
)brace
id|runtime-&gt;access
op_assign
id|params_access
c_func
(paren
id|params
)paren
suffix:semicolon
id|runtime-&gt;format
op_assign
id|params_format
c_func
(paren
id|params
)paren
suffix:semicolon
id|runtime-&gt;subformat
op_assign
id|params_subformat
c_func
(paren
id|params
)paren
suffix:semicolon
id|runtime-&gt;channels
op_assign
id|params_channels
c_func
(paren
id|params
)paren
suffix:semicolon
id|runtime-&gt;rate
op_assign
id|params_rate
c_func
(paren
id|params
)paren
suffix:semicolon
id|runtime-&gt;period_size
op_assign
id|params_period_size
c_func
(paren
id|params
)paren
suffix:semicolon
id|runtime-&gt;periods
op_assign
id|params_periods
c_func
(paren
id|params
)paren
suffix:semicolon
id|runtime-&gt;buffer_size
op_assign
id|params_buffer_size
c_func
(paren
id|params
)paren
suffix:semicolon
id|runtime-&gt;tick_time
op_assign
id|params_tick_time
c_func
(paren
id|params
)paren
suffix:semicolon
id|runtime-&gt;info
op_assign
id|params-&gt;info
suffix:semicolon
id|runtime-&gt;rate_num
op_assign
id|params-&gt;rate_num
suffix:semicolon
id|runtime-&gt;rate_den
op_assign
id|params-&gt;rate_den
suffix:semicolon
id|bits
op_assign
id|snd_pcm_format_physical_width
c_func
(paren
id|runtime-&gt;format
)paren
suffix:semicolon
id|runtime-&gt;sample_bits
op_assign
id|bits
suffix:semicolon
id|bits
op_mul_assign
id|runtime-&gt;channels
suffix:semicolon
id|runtime-&gt;frame_bits
op_assign
id|bits
suffix:semicolon
id|frames
op_assign
l_int|1
suffix:semicolon
r_while
c_loop
(paren
id|bits
op_mod
l_int|8
op_ne
l_int|0
)paren
(brace
id|bits
op_mul_assign
l_int|2
suffix:semicolon
id|frames
op_mul_assign
l_int|2
suffix:semicolon
)brace
id|runtime-&gt;byte_align
op_assign
id|bits
op_div
l_int|8
suffix:semicolon
id|runtime-&gt;min_align
op_assign
id|frames
suffix:semicolon
multiline_comment|/* Default sw params */
id|runtime-&gt;tstamp_mode
op_assign
id|SNDRV_PCM_TSTAMP_NONE
suffix:semicolon
id|runtime-&gt;period_step
op_assign
l_int|1
suffix:semicolon
id|runtime-&gt;sleep_min
op_assign
l_int|0
suffix:semicolon
id|runtime-&gt;control-&gt;avail_min
op_assign
id|runtime-&gt;period_size
suffix:semicolon
id|runtime-&gt;xfer_align
op_assign
id|runtime-&gt;period_size
suffix:semicolon
id|runtime-&gt;start_threshold
op_assign
l_int|1
suffix:semicolon
id|runtime-&gt;stop_threshold
op_assign
id|runtime-&gt;buffer_size
suffix:semicolon
id|runtime-&gt;silence_threshold
op_assign
l_int|0
suffix:semicolon
id|runtime-&gt;silence_size
op_assign
l_int|0
suffix:semicolon
id|runtime-&gt;boundary
op_assign
id|runtime-&gt;buffer_size
suffix:semicolon
r_while
c_loop
(paren
id|runtime-&gt;boundary
op_star
l_int|2
op_le
id|LONG_MAX
op_minus
id|runtime-&gt;buffer_size
)paren
id|runtime-&gt;boundary
op_mul_assign
l_int|2
suffix:semicolon
id|snd_pcm_timer_resolution_change
c_func
(paren
id|substream
)paren
suffix:semicolon
id|runtime-&gt;status-&gt;state
op_assign
id|SNDRV_PCM_STATE_SETUP
suffix:semicolon
r_return
l_int|0
suffix:semicolon
id|_error
suffix:colon
multiline_comment|/* hardware might be unuseable from this time,&n;&t;   so we force application to retry to set&n;&t;   the correct hardware parameter settings */
id|runtime-&gt;status-&gt;state
op_assign
id|SNDRV_PCM_STATE_OPEN
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;ops-&gt;hw_free
op_ne
l_int|NULL
)paren
id|substream-&gt;ops
op_member_access_from_pointer
id|hw_free
c_func
(paren
id|substream
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|function|snd_pcm_hw_params_user
r_static
r_int
id|snd_pcm_hw_params_user
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_hw_params_t
op_star
id|_params
)paren
(brace
id|snd_pcm_hw_params_t
id|params
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|params
comma
id|_params
comma
r_sizeof
(paren
id|params
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_params
c_func
(paren
id|substream
comma
op_amp
id|params
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|_params
comma
op_amp
id|params
comma
r_sizeof
(paren
id|params
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|function|snd_pcm_hw_free
r_static
r_int
id|snd_pcm_hw_free
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_int
id|result
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_assert
c_func
(paren
id|runtime
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|runtime-&gt;status-&gt;state
)paren
(brace
r_case
id|SNDRV_PCM_STATE_SETUP
suffix:colon
r_case
id|SNDRV_PCM_STATE_PREPARED
suffix:colon
r_break
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
id|EBADFD
suffix:semicolon
)brace
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|runtime-&gt;mmap_count
)paren
)paren
r_return
op_minus
id|EBADFD
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;ops-&gt;hw_free
op_eq
l_int|NULL
)paren
r_return
l_int|0
suffix:semicolon
id|result
op_assign
id|substream-&gt;ops
op_member_access_from_pointer
id|hw_free
c_func
(paren
id|substream
)paren
suffix:semicolon
id|runtime-&gt;status-&gt;state
op_assign
id|SNDRV_PCM_STATE_OPEN
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
DECL|function|snd_pcm_sw_params
r_static
r_int
id|snd_pcm_sw_params
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_sw_params_t
op_star
id|params
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_assert
c_func
(paren
id|runtime
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_OPEN
)paren
r_return
op_minus
id|EBADFD
suffix:semicolon
r_if
c_cond
(paren
id|params-&gt;tstamp_mode
OG
id|SNDRV_PCM_TSTAMP_LAST
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|params-&gt;avail_min
op_eq
l_int|0
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|params-&gt;xfer_align
op_eq
l_int|0
op_logical_or
id|params-&gt;xfer_align
op_mod
id|runtime-&gt;min_align
op_ne
l_int|0
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|params-&gt;silence_threshold
op_plus
id|params-&gt;silence_size
OG
id|runtime-&gt;buffer_size
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|runtime-&gt;tstamp_mode
op_assign
id|params-&gt;tstamp_mode
suffix:semicolon
id|runtime-&gt;sleep_min
op_assign
id|params-&gt;sleep_min
suffix:semicolon
id|runtime-&gt;period_step
op_assign
id|params-&gt;period_step
suffix:semicolon
id|runtime-&gt;control-&gt;avail_min
op_assign
id|params-&gt;avail_min
suffix:semicolon
id|runtime-&gt;start_threshold
op_assign
id|params-&gt;start_threshold
suffix:semicolon
id|runtime-&gt;stop_threshold
op_assign
id|params-&gt;stop_threshold
suffix:semicolon
id|runtime-&gt;silence_threshold
op_assign
id|params-&gt;silence_threshold
suffix:semicolon
id|runtime-&gt;silence_size
op_assign
id|params-&gt;silence_size
suffix:semicolon
id|runtime-&gt;xfer_align
op_assign
id|params-&gt;xfer_align
suffix:semicolon
id|params-&gt;boundary
op_assign
id|runtime-&gt;boundary
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|snd_pcm_running
c_func
(paren
id|substream
)paren
)paren
(brace
r_if
c_cond
(paren
id|runtime-&gt;sleep_min
)paren
id|snd_pcm_tick_prepare
c_func
(paren
id|substream
)paren
suffix:semicolon
r_else
id|snd_pcm_tick_set
c_func
(paren
id|substream
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_PLAYBACK
op_logical_and
id|runtime-&gt;silence_size
OG
l_int|0
)paren
id|snd_pcm_playback_silence
c_func
(paren
id|substream
)paren
suffix:semicolon
id|wake_up
c_func
(paren
op_amp
id|runtime-&gt;sleep
)paren
suffix:semicolon
)brace
id|spin_unlock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_sw_params_user
r_static
r_int
id|snd_pcm_sw_params_user
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_sw_params_t
op_star
id|_params
)paren
(brace
id|snd_pcm_sw_params_t
id|params
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|params
comma
id|_params
comma
r_sizeof
(paren
id|params
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|err
op_assign
id|snd_pcm_sw_params
c_func
(paren
id|substream
comma
op_amp
id|params
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|_params
comma
op_amp
id|params
comma
r_sizeof
(paren
id|params
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|function|snd_pcm_status
r_int
id|snd_pcm_status
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_status_t
op_star
id|status
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
id|status-&gt;state
op_assign
id|runtime-&gt;status-&gt;state
suffix:semicolon
id|status-&gt;suspended_state
op_assign
id|runtime-&gt;status-&gt;suspended_state
suffix:semicolon
r_if
c_cond
(paren
id|status-&gt;state
op_eq
id|SNDRV_PCM_STATE_OPEN
)paren
r_goto
id|_end
suffix:semicolon
id|status-&gt;trigger_tstamp
op_assign
id|runtime-&gt;trigger_tstamp
suffix:semicolon
r_if
c_cond
(paren
id|snd_pcm_running
c_func
(paren
id|substream
)paren
)paren
(brace
id|snd_pcm_update_hw_ptr
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;tstamp_mode
op_amp
id|SNDRV_PCM_TSTAMP_MMAP
)paren
id|status-&gt;tstamp
op_assign
id|runtime-&gt;status-&gt;tstamp
suffix:semicolon
r_else
id|snd_timestamp_now
c_func
(paren
op_amp
id|status-&gt;tstamp
)paren
suffix:semicolon
)brace
r_else
id|snd_timestamp_now
c_func
(paren
op_amp
id|status-&gt;tstamp
)paren
suffix:semicolon
id|status-&gt;appl_ptr
op_assign
id|runtime-&gt;control-&gt;appl_ptr
suffix:semicolon
id|status-&gt;hw_ptr
op_assign
id|runtime-&gt;status-&gt;hw_ptr
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_PLAYBACK
)paren
(brace
id|status-&gt;avail
op_assign
id|snd_pcm_playback_avail
c_func
(paren
id|runtime
)paren
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_RUNNING
op_logical_or
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_DRAINING
)paren
id|status-&gt;delay
op_assign
id|runtime-&gt;buffer_size
op_minus
id|status-&gt;avail
suffix:semicolon
)brace
r_else
(brace
id|status-&gt;avail
op_assign
id|snd_pcm_capture_avail
c_func
(paren
id|runtime
)paren
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_RUNNING
)paren
id|status-&gt;delay
op_assign
id|status-&gt;avail
suffix:semicolon
)brace
id|status-&gt;avail_max
op_assign
id|runtime-&gt;avail_max
suffix:semicolon
id|status-&gt;overrange
op_assign
id|runtime-&gt;overrange
suffix:semicolon
id|runtime-&gt;avail_max
op_assign
l_int|0
suffix:semicolon
id|runtime-&gt;overrange
op_assign
l_int|0
suffix:semicolon
id|_end
suffix:colon
id|spin_unlock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_status_user
r_static
r_int
id|snd_pcm_status_user
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_status_t
op_star
id|_status
)paren
(brace
id|snd_pcm_status_t
id|status
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_int
id|res
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|status
comma
l_int|0
comma
r_sizeof
(paren
id|status
)paren
)paren
suffix:semicolon
id|res
op_assign
id|snd_pcm_status
c_func
(paren
id|substream
comma
op_amp
id|status
)paren
suffix:semicolon
r_if
c_cond
(paren
id|res
OL
l_int|0
)paren
r_return
id|res
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|_status
comma
op_amp
id|status
comma
r_sizeof
(paren
id|status
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_channel_info
r_static
r_int
id|snd_pcm_channel_info
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_channel_info_t
op_star
id|_info
)paren
(brace
id|snd_pcm_channel_info_t
id|info
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_int
id|res
suffix:semicolon
r_int
r_int
id|channel
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|info
comma
id|_info
comma
r_sizeof
(paren
id|info
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|channel
op_assign
id|info.channel
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_OPEN
)paren
r_return
op_minus
id|EBADFD
suffix:semicolon
r_if
c_cond
(paren
id|channel
op_ge
id|runtime-&gt;channels
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|info
comma
l_int|0
comma
r_sizeof
(paren
id|info
)paren
)paren
suffix:semicolon
id|info.channel
op_assign
id|channel
suffix:semicolon
id|res
op_assign
id|substream-&gt;ops
op_member_access_from_pointer
id|ioctl
c_func
(paren
id|substream
comma
id|SNDRV_PCM_IOCTL1_CHANNEL_INFO
comma
op_amp
id|info
)paren
suffix:semicolon
r_if
c_cond
(paren
id|res
OL
l_int|0
)paren
r_return
id|res
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|_info
comma
op_amp
id|info
comma
r_sizeof
(paren
id|info
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_trigger_time
r_static
r_void
id|snd_pcm_trigger_time
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;trigger_master
op_eq
l_int|NULL
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;trigger_master
op_eq
id|substream
)paren
(brace
id|snd_timestamp_now
c_func
(paren
op_amp
id|runtime-&gt;trigger_tstamp
)paren
suffix:semicolon
)brace
r_else
(brace
id|snd_pcm_trigger_time
c_func
(paren
id|runtime-&gt;trigger_master
)paren
suffix:semicolon
id|runtime-&gt;trigger_tstamp
op_assign
id|runtime-&gt;trigger_master-&gt;runtime-&gt;trigger_tstamp
suffix:semicolon
)brace
id|runtime-&gt;trigger_master
op_assign
l_int|NULL
suffix:semicolon
)brace
DECL|macro|_SND_PCM_ACTION
mdefine_line|#define _SND_PCM_ACTION(aname, substream, state, res, check_master) { &bslash;&n;&t;snd_pcm_substream_t *s; &bslash;&n;&t;res = 0; &bslash;&n;&t;spin_lock(&amp;pcm_link_lock); &bslash;&n;&t;s = substream; &bslash;&n;&t;do { &bslash;&n;&t;&t;if (s != substream) &bslash;&n;&t;&t;&t;spin_lock(&amp;s-&gt;runtime-&gt;lock); &bslash;&n;&t;&t;res = snd_pcm_pre_##aname(s, state); &bslash;&n;&t;&t;if (res &lt; 0) &bslash;&n;&t;&t;&t;break; &bslash;&n;&t;&t;s = s-&gt;link_next; &bslash;&n;&t;} while (s != substream); &bslash;&n;&t;if (res &lt; 0) { &bslash;&n;&t;&t;/* Clean all spin_lock */ &bslash;&n;&t;&t;while (s != substream) { &bslash;&n;&t;&t;&t;spin_unlock(&amp;s-&gt;runtime-&gt;lock); &bslash;&n;&t;&t;&t;s = s-&gt;link_prev; &bslash;&n;&t;&t;} &bslash;&n;&t;&t;goto _end; &bslash;&n;&t;} &bslash;&n;&t;s = substream; &bslash;&n;&t;do { &bslash;&n;&t;&t;snd_pcm_runtime_t *runtime = s-&gt;runtime; &bslash;&n;&t;&t;int err; &bslash;&n;&t;&t;if (check_master &amp;&amp; runtime-&gt;trigger_master != s) &bslash;&n;&t;&t;&t;goto _done; &bslash;&n;&t;&t;err = snd_pcm_do_##aname(s, state); &bslash;&n;&t;&t;if (err &lt; 0) { &bslash;&n;&t;&t;&t;if (res == 0) &bslash;&n;&t;&t;&t;&t;res = err; &bslash;&n;&t;&t;} else { &bslash;&n;&t;&t;&t;_done: &bslash;&n;&t;&t;&t;snd_pcm_post_##aname(s, state); &bslash;&n;&t;&t;} &bslash;&n;&t;&t;if (s != substream) &bslash;&n;&t;&t;&t;spin_unlock(&amp;runtime-&gt;lock); &bslash;&n;&t;&t;s = s-&gt;link_next; &bslash;&n;&t;} while (s != substream); &bslash;&n; _end: &bslash;&n;&t;spin_unlock(&amp;pcm_link_lock); &bslash;&n;}
DECL|macro|SND_PCM_ACTION
mdefine_line|#define SND_PCM_ACTION(aname, substream, state) { &bslash;&n;&t;int res; &bslash;&n;&t;_SND_PCM_ACTION(aname, substream, state, res, 1); &bslash;&n;&t;return res; &bslash;&n;}
DECL|function|snd_pcm_pre_start
r_static
r_inline
r_int
id|snd_pcm_pre_start
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_ne
id|SNDRV_PCM_STATE_PREPARED
)paren
r_return
op_minus
id|EBADFD
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_PLAYBACK
op_logical_and
op_logical_neg
id|snd_pcm_playback_data
c_func
(paren
id|substream
)paren
)paren
r_return
op_minus
id|EPIPE
suffix:semicolon
id|runtime-&gt;trigger_master
op_assign
id|substream
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_do_start
r_static
r_inline
r_int
id|snd_pcm_do_start
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
r_return
id|substream-&gt;ops
op_member_access_from_pointer
id|trigger
c_func
(paren
id|substream
comma
id|SNDRV_PCM_TRIGGER_START
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_post_start
r_static
r_inline
r_void
id|snd_pcm_post_start
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_pcm_trigger_time
c_func
(paren
id|substream
)paren
suffix:semicolon
id|runtime-&gt;status-&gt;state
op_assign
id|SNDRV_PCM_STATE_RUNNING
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_PLAYBACK
op_logical_and
id|runtime-&gt;silence_size
OG
l_int|0
)paren
id|snd_pcm_playback_silence
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;sleep_min
)paren
id|snd_pcm_tick_prepare
c_func
(paren
id|substream
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_start
r_int
id|snd_pcm_start
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|SND_PCM_ACTION
c_func
(paren
id|start
comma
id|substream
comma
l_int|0
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_pre_stop
r_static
r_inline
r_int
id|snd_pcm_pre_stop
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snd_pcm_running
c_func
(paren
id|substream
)paren
)paren
r_return
op_minus
id|EBADFD
suffix:semicolon
id|runtime-&gt;trigger_master
op_assign
id|substream
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_do_stop
r_static
r_inline
r_int
id|snd_pcm_do_stop
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
r_return
id|substream-&gt;ops
op_member_access_from_pointer
id|trigger
c_func
(paren
id|substream
comma
id|SNDRV_PCM_TRIGGER_STOP
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_post_stop
r_static
r_inline
r_void
id|snd_pcm_post_stop
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_pcm_trigger_time
c_func
(paren
id|substream
)paren
suffix:semicolon
id|runtime-&gt;status-&gt;state
op_assign
id|state
suffix:semicolon
id|snd_pcm_tick_set
c_func
(paren
id|substream
comma
l_int|0
)paren
suffix:semicolon
id|wake_up
c_func
(paren
op_amp
id|runtime-&gt;sleep
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_stop
r_int
id|snd_pcm_stop
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
id|SND_PCM_ACTION
c_func
(paren
id|stop
comma
id|substream
comma
id|state
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_pre_pause
r_static
r_inline
r_int
id|snd_pcm_pre_pause
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|push
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|runtime-&gt;info
op_amp
id|SNDRV_PCM_INFO_PAUSE
)paren
)paren
r_return
op_minus
id|ENOSYS
suffix:semicolon
r_if
c_cond
(paren
id|push
)paren
(brace
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_ne
id|SNDRV_PCM_STATE_RUNNING
)paren
r_return
op_minus
id|EBADFD
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_ne
id|SNDRV_PCM_STATE_PAUSED
)paren
r_return
op_minus
id|EBADFD
suffix:semicolon
id|runtime-&gt;trigger_master
op_assign
id|substream
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_do_pause
r_static
r_inline
r_int
id|snd_pcm_do_pause
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|push
)paren
(brace
r_return
id|substream-&gt;ops
op_member_access_from_pointer
id|trigger
c_func
(paren
id|substream
comma
id|push
ques
c_cond
id|SNDRV_PCM_TRIGGER_PAUSE_PUSH
suffix:colon
id|SNDRV_PCM_TRIGGER_PAUSE_RELEASE
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_post_pause
r_static
r_inline
r_void
id|snd_pcm_post_pause
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|push
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_pcm_trigger_time
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|push
)paren
(brace
id|runtime-&gt;status-&gt;state
op_assign
id|SNDRV_PCM_STATE_PAUSED
suffix:semicolon
id|snd_pcm_tick_set
c_func
(paren
id|substream
comma
l_int|0
)paren
suffix:semicolon
id|wake_up
c_func
(paren
op_amp
id|runtime-&gt;sleep
)paren
suffix:semicolon
)brace
r_else
(brace
id|runtime-&gt;status-&gt;state
op_assign
id|SNDRV_PCM_STATE_RUNNING
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;sleep_min
)paren
id|snd_pcm_tick_prepare
c_func
(paren
id|substream
)paren
suffix:semicolon
)brace
)brace
DECL|function|snd_pcm_pause
r_static
r_int
id|snd_pcm_pause
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|push
)paren
(brace
id|SND_PCM_ACTION
c_func
(paren
id|pause
comma
id|substream
comma
id|push
)paren
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_PM
multiline_comment|/* suspend */
DECL|function|snd_pcm_pre_suspend
r_static
r_inline
r_int
id|snd_pcm_pre_suspend
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_SUSPENDED
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
id|runtime-&gt;status-&gt;suspended_state
op_assign
id|runtime-&gt;status-&gt;state
suffix:semicolon
id|runtime-&gt;trigger_master
op_assign
id|substream
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_do_suspend
r_static
r_inline
r_int
id|snd_pcm_do_suspend
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;suspended_state
op_ne
id|SNDRV_PCM_STATE_RUNNING
)paren
r_return
l_int|0
suffix:semicolon
r_return
id|substream-&gt;ops
op_member_access_from_pointer
id|trigger
c_func
(paren
id|substream
comma
id|SNDRV_PCM_TRIGGER_SUSPEND
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_post_suspend
r_static
r_inline
r_void
id|snd_pcm_post_suspend
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_pcm_trigger_time
c_func
(paren
id|substream
)paren
suffix:semicolon
id|runtime-&gt;status-&gt;state
op_assign
id|SNDRV_PCM_STATE_SUSPENDED
suffix:semicolon
id|snd_pcm_tick_set
c_func
(paren
id|substream
comma
l_int|0
)paren
suffix:semicolon
id|wake_up
c_func
(paren
op_amp
id|runtime-&gt;sleep
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_suspend
r_int
id|snd_pcm_suspend
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|SND_PCM_ACTION
c_func
(paren
id|suspend
comma
id|substream
comma
l_int|0
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_suspend_all
r_int
id|snd_pcm_suspend_all
c_func
(paren
id|snd_pcm_t
op_star
id|pcm
)paren
(brace
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_int
id|stream
comma
id|err
suffix:semicolon
r_for
c_loop
(paren
id|stream
op_assign
l_int|0
suffix:semicolon
id|stream
OL
l_int|2
suffix:semicolon
id|stream
op_increment
)paren
(brace
r_for
c_loop
(paren
id|substream
op_assign
id|pcm-&gt;streams
(braket
id|stream
)braket
dot
id|substream
suffix:semicolon
id|substream
suffix:semicolon
id|substream
op_assign
id|substream-&gt;next
)paren
(brace
multiline_comment|/* FIXME: the open/close code should lock this as well */
r_if
c_cond
(paren
(paren
id|runtime
op_assign
id|substream-&gt;runtime
)paren
op_eq
l_int|NULL
)paren
r_continue
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_SUSPENDED
)paren
(brace
id|spin_unlock
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
r_continue
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_pcm_suspend
c_func
(paren
id|substream
)paren
)paren
OL
l_int|0
)paren
(brace
id|spin_unlock
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
id|spin_unlock
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* resume */
DECL|function|snd_pcm_pre_resume
r_static
r_inline
r_int
id|snd_pcm_pre_resume
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|runtime-&gt;info
op_amp
id|SNDRV_PCM_INFO_RESUME
)paren
)paren
r_return
op_minus
id|ENOSYS
suffix:semicolon
id|runtime-&gt;trigger_master
op_assign
id|substream
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_do_resume
r_static
r_inline
r_int
id|snd_pcm_do_resume
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;suspended_state
op_ne
id|SNDRV_PCM_STATE_RUNNING
)paren
r_return
l_int|0
suffix:semicolon
r_return
id|substream-&gt;ops
op_member_access_from_pointer
id|trigger
c_func
(paren
id|substream
comma
id|SNDRV_PCM_TRIGGER_RESUME
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_post_resume
r_static
r_inline
r_void
id|snd_pcm_post_resume
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_pcm_trigger_time
c_func
(paren
id|substream
)paren
suffix:semicolon
id|runtime-&gt;status-&gt;state
op_assign
id|runtime-&gt;status-&gt;suspended_state
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;sleep_min
)paren
id|snd_pcm_tick_prepare
c_func
(paren
id|substream
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_resume
r_static
r_int
id|snd_pcm_resume
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_card_t
op_star
id|card
op_assign
id|substream-&gt;pcm-&gt;card
suffix:semicolon
r_int
id|res
suffix:semicolon
id|snd_power_lock
c_func
(paren
id|card
)paren
suffix:semicolon
r_while
c_loop
(paren
id|snd_power_get_state
c_func
(paren
id|card
)paren
op_ne
id|SNDRV_CTL_POWER_D0
)paren
(brace
r_if
c_cond
(paren
id|substream-&gt;ffile-&gt;f_flags
op_amp
id|O_NONBLOCK
)paren
(brace
id|res
op_assign
op_minus
id|EAGAIN
suffix:semicolon
r_goto
id|_power_unlock
suffix:semicolon
)brace
id|snd_power_wait
c_func
(paren
id|card
)paren
suffix:semicolon
)brace
id|_SND_PCM_ACTION
c_func
(paren
id|resume
comma
id|substream
comma
l_int|0
comma
id|res
comma
l_int|1
)paren
suffix:semicolon
id|_power_unlock
suffix:colon
id|snd_power_unlock
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|res
suffix:semicolon
)brace
macro_line|#else
DECL|function|snd_pcm_resume
r_static
r_int
id|snd_pcm_resume
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
r_return
op_minus
id|ENOSYS
suffix:semicolon
)brace
macro_line|#endif /* CONFIG_PM */
DECL|function|snd_pcm_xrun
r_static
r_int
id|snd_pcm_xrun
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_card_t
op_star
id|card
op_assign
id|substream-&gt;pcm-&gt;card
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_int
id|result
suffix:semicolon
id|snd_power_lock
c_func
(paren
id|card
)paren
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
id|_xrun_recovery
suffix:colon
r_switch
c_cond
(paren
id|runtime-&gt;status-&gt;state
)paren
(brace
r_case
id|SNDRV_PCM_STATE_XRUN
suffix:colon
id|result
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* already there */
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_RUNNING
suffix:colon
id|result
op_assign
id|snd_pcm_stop
c_func
(paren
id|substream
comma
id|SNDRV_PCM_STATE_XRUN
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_SUSPENDED
suffix:colon
r_while
c_loop
(paren
id|snd_power_get_state
c_func
(paren
id|card
)paren
op_ne
id|SNDRV_CTL_POWER_D0
)paren
(brace
r_if
c_cond
(paren
id|substream-&gt;ffile-&gt;f_flags
op_amp
id|O_NONBLOCK
)paren
(brace
id|result
op_assign
op_minus
id|EAGAIN
suffix:semicolon
r_goto
id|_end
suffix:semicolon
)brace
id|spin_unlock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
id|snd_power_wait
c_func
(paren
id|card
)paren
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
)brace
r_goto
id|_xrun_recovery
suffix:semicolon
r_default
suffix:colon
id|result
op_assign
op_minus
id|EBADFD
suffix:semicolon
)brace
id|_end
suffix:colon
id|spin_unlock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
id|snd_power_unlock
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
DECL|function|snd_pcm_pre_reset
r_static
r_inline
r_int
id|snd_pcm_pre_reset
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_switch
c_cond
(paren
id|runtime-&gt;status-&gt;state
)paren
(brace
r_case
id|SNDRV_PCM_STATE_RUNNING
suffix:colon
r_case
id|SNDRV_PCM_STATE_PREPARED
suffix:colon
r_case
id|SNDRV_PCM_STATE_PAUSED
suffix:colon
r_case
id|SNDRV_PCM_STATE_SUSPENDED
suffix:colon
r_return
l_int|0
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
id|EBADFD
suffix:semicolon
)brace
)brace
DECL|function|snd_pcm_do_reset
r_static
r_inline
r_int
id|snd_pcm_do_reset
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_int
id|err
op_assign
id|substream-&gt;ops
op_member_access_from_pointer
id|ioctl
c_func
(paren
id|substream
comma
id|SNDRV_PCM_IOCTL1_RESET
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|snd_assert
c_func
(paren
id|runtime-&gt;status-&gt;hw_ptr
OL
id|runtime-&gt;buffer_size
comma
)paren
suffix:semicolon
id|runtime-&gt;hw_ptr_base
op_assign
l_int|0
suffix:semicolon
id|runtime-&gt;hw_ptr_interrupt
op_assign
id|runtime-&gt;status-&gt;hw_ptr
op_minus
id|runtime-&gt;status-&gt;hw_ptr
op_mod
id|runtime-&gt;period_size
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_post_reset
r_static
r_inline
r_void
id|snd_pcm_post_reset
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|runtime-&gt;control-&gt;appl_ptr
op_assign
id|runtime-&gt;status-&gt;hw_ptr
suffix:semicolon
)brace
DECL|function|snd_pcm_reset
r_static
r_int
id|snd_pcm_reset
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
r_int
id|res
suffix:semicolon
id|_SND_PCM_ACTION
c_func
(paren
id|reset
comma
id|substream
comma
l_int|0
comma
id|res
comma
l_int|0
)paren
suffix:semicolon
r_return
id|res
suffix:semicolon
)brace
DECL|function|snd_pcm_pre_prepare
r_static
r_inline
r_int
id|snd_pcm_pre_prepare
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_switch
c_cond
(paren
id|runtime-&gt;status-&gt;state
)paren
(brace
r_case
id|SNDRV_PCM_STATE_OPEN
suffix:colon
r_return
op_minus
id|EBADFD
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_RUNNING
suffix:colon
r_return
op_minus
id|EBUSY
suffix:semicolon
r_default
suffix:colon
r_return
l_int|0
suffix:semicolon
)brace
)brace
DECL|function|snd_pcm_do_prepare
r_static
r_inline
r_int
id|snd_pcm_do_prepare
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
r_int
id|err
suffix:semicolon
id|err
op_assign
id|substream-&gt;ops
op_member_access_from_pointer
id|prepare
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_return
id|snd_pcm_do_reset
c_func
(paren
id|substream
comma
l_int|0
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_post_prepare
r_static
r_inline
r_void
id|snd_pcm_post_prepare
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|runtime-&gt;control-&gt;appl_ptr
op_assign
id|runtime-&gt;status-&gt;hw_ptr
suffix:semicolon
id|runtime-&gt;status-&gt;state
op_assign
id|SNDRV_PCM_STATE_PREPARED
suffix:semicolon
)brace
DECL|function|snd_pcm_prepare
r_int
id|snd_pcm_prepare
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
r_int
id|res
suffix:semicolon
id|snd_card_t
op_star
id|card
op_assign
id|substream-&gt;pcm-&gt;card
suffix:semicolon
id|snd_power_lock
c_func
(paren
id|card
)paren
suffix:semicolon
r_while
c_loop
(paren
id|snd_power_get_state
c_func
(paren
id|card
)paren
op_ne
id|SNDRV_CTL_POWER_D0
)paren
(brace
r_if
c_cond
(paren
id|substream-&gt;ffile-&gt;f_flags
op_amp
id|O_NONBLOCK
)paren
(brace
id|res
op_assign
op_minus
id|EAGAIN
suffix:semicolon
r_goto
id|_power_unlock
suffix:semicolon
)brace
id|snd_power_wait
c_func
(paren
id|card
)paren
suffix:semicolon
)brace
id|_SND_PCM_ACTION
c_func
(paren
id|prepare
comma
id|substream
comma
l_int|0
comma
id|res
comma
l_int|0
)paren
suffix:semicolon
id|_power_unlock
suffix:colon
id|snd_power_unlock
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|res
suffix:semicolon
)brace
DECL|function|snd_pcm_change_state
r_static
r_void
id|snd_pcm_change_state
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|state
)paren
(brace
id|snd_pcm_substream_t
op_star
id|s
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|pcm_link_lock
)paren
suffix:semicolon
id|s
op_assign
id|substream-&gt;link_next
suffix:semicolon
r_while
c_loop
(paren
id|s
op_ne
id|substream
)paren
(brace
id|spin_lock
c_func
(paren
op_amp
id|s-&gt;runtime-&gt;lock
)paren
suffix:semicolon
id|s
op_assign
id|s-&gt;link_next
suffix:semicolon
)brace
id|s
op_assign
id|substream
suffix:semicolon
r_do
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|s-&gt;runtime
suffix:semicolon
id|runtime-&gt;status-&gt;state
op_assign
id|state
suffix:semicolon
r_if
c_cond
(paren
id|s
op_ne
id|substream
)paren
id|spin_unlock
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
id|s
op_assign
id|s-&gt;link_next
suffix:semicolon
)brace
r_while
c_loop
(paren
id|s
op_ne
id|substream
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|pcm_link_lock
)paren
suffix:semicolon
)brace
r_static
r_int
id|snd_pcm_playback_drop
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
suffix:semicolon
DECL|function|snd_pcm_playback_drain
r_static
r_int
id|snd_pcm_playback_drain
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_card_t
op_star
id|card
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_int
id|err
comma
id|result
op_assign
l_int|0
suffix:semicolon
id|wait_queue_t
id|wait
suffix:semicolon
r_enum
(brace
id|READY
comma
id|EXPIRED
comma
id|SUSPENDED
comma
id|SIGNALED
)brace
id|state
op_assign
id|READY
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_PLAYBACK
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|card
op_assign
id|substream-&gt;pcm-&gt;card
suffix:semicolon
id|snd_power_lock
c_func
(paren
id|card
)paren
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|runtime-&gt;status-&gt;state
)paren
(brace
r_case
id|SNDRV_PCM_STATE_PAUSED
suffix:colon
id|snd_pcm_pause
c_func
(paren
id|substream
comma
l_int|0
)paren
suffix:semicolon
multiline_comment|/* Fall through */
r_case
id|SNDRV_PCM_STATE_RUNNING
suffix:colon
r_case
id|SNDRV_PCM_STATE_DRAINING
suffix:colon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_SUSPENDED
suffix:colon
r_while
c_loop
(paren
id|snd_power_get_state
c_func
(paren
id|card
)paren
op_ne
id|SNDRV_CTL_POWER_D0
)paren
(brace
r_if
c_cond
(paren
id|substream-&gt;ffile-&gt;f_flags
op_amp
id|O_NONBLOCK
)paren
(brace
id|result
op_assign
op_minus
id|EAGAIN
suffix:semicolon
r_goto
id|_end
suffix:semicolon
)brace
id|spin_unlock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
id|snd_power_wait
c_func
(paren
id|card
)paren
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
)brace
r_goto
id|_xrun_recovery
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_OPEN
suffix:colon
id|result
op_assign
op_minus
id|EBADFD
suffix:semicolon
r_goto
id|_end
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_PREPARED
suffix:colon
r_if
c_cond
(paren
op_logical_neg
id|snd_pcm_playback_empty
c_func
(paren
id|substream
)paren
)paren
(brace
id|err
op_assign
id|snd_pcm_start
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
(brace
id|result
op_assign
id|err
suffix:semicolon
r_goto
id|_end
suffix:semicolon
)brace
r_break
suffix:semicolon
)brace
multiline_comment|/* Fall through */
r_case
id|SNDRV_PCM_STATE_XRUN
suffix:colon
id|_xrun_recovery
suffix:colon
id|snd_pcm_change_state
c_func
(paren
id|substream
comma
id|SNDRV_PCM_STATE_SETUP
)paren
suffix:semicolon
multiline_comment|/* Fall through */
r_case
id|SNDRV_PCM_STATE_SETUP
suffix:colon
r_goto
id|_end
suffix:semicolon
)brace
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_RUNNING
)paren
(brace
r_if
c_cond
(paren
id|snd_pcm_playback_empty
c_func
(paren
id|substream
)paren
)paren
(brace
id|snd_pcm_stop
c_func
(paren
id|substream
comma
id|SNDRV_PCM_STATE_SETUP
)paren
suffix:semicolon
r_goto
id|_end
suffix:semicolon
)brace
id|snd_pcm_change_state
c_func
(paren
id|substream
comma
id|SNDRV_PCM_STATE_DRAINING
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|substream-&gt;ffile-&gt;f_flags
op_amp
id|O_NONBLOCK
)paren
(brace
id|result
op_assign
op_minus
id|EAGAIN
suffix:semicolon
r_goto
id|_end
suffix:semicolon
)brace
id|init_waitqueue_entry
c_func
(paren
op_amp
id|wait
comma
id|current
)paren
suffix:semicolon
id|add_wait_queue
c_func
(paren
op_amp
id|runtime-&gt;sleep
comma
op_amp
id|wait
)paren
suffix:semicolon
r_while
c_loop
(paren
l_int|1
)paren
(brace
id|set_current_state
c_func
(paren
id|TASK_INTERRUPTIBLE
)paren
suffix:semicolon
r_if
c_cond
(paren
id|signal_pending
c_func
(paren
id|current
)paren
)paren
(brace
id|state
op_assign
id|SIGNALED
suffix:semicolon
r_break
suffix:semicolon
)brace
id|spin_unlock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|schedule_timeout
c_func
(paren
l_int|10
op_star
id|HZ
)paren
op_eq
l_int|0
)paren
(brace
id|spin_lock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
id|state
op_assign
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_SUSPENDED
ques
c_cond
id|SUSPENDED
suffix:colon
id|EXPIRED
suffix:semicolon
r_break
suffix:semicolon
)brace
id|spin_lock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_ne
id|SNDRV_PCM_STATE_DRAINING
)paren
(brace
id|state
op_assign
id|READY
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
id|set_current_state
c_func
(paren
id|TASK_RUNNING
)paren
suffix:semicolon
id|remove_wait_queue
c_func
(paren
op_amp
id|runtime-&gt;sleep
comma
op_amp
id|wait
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|state
)paren
(brace
r_case
id|SIGNALED
suffix:colon
id|result
op_assign
op_minus
id|ERESTARTSYS
suffix:semicolon
r_goto
id|_end
suffix:semicolon
r_case
id|SUSPENDED
suffix:colon
id|result
op_assign
op_minus
id|ESTRPIPE
suffix:semicolon
r_goto
id|_end
suffix:semicolon
r_case
id|EXPIRED
suffix:colon
id|snd_printd
c_func
(paren
l_string|&quot;playback drain error (DMA or IRQ trouble?)&bslash;n&quot;
)paren
suffix:semicolon
id|result
op_assign
op_minus
id|EIO
suffix:semicolon
r_goto
id|_end
suffix:semicolon
r_default
suffix:colon
r_break
suffix:semicolon
)brace
id|_end
suffix:colon
id|spin_unlock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
id|snd_power_unlock
c_func
(paren
id|card
)paren
suffix:semicolon
r_if
c_cond
(paren
id|state
op_eq
id|EXPIRED
)paren
id|snd_pcm_playback_drop
c_func
(paren
id|substream
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
DECL|function|snd_pcm_playback_drop
r_static
r_int
id|snd_pcm_playback_drop
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_card_t
op_star
id|card
op_assign
id|substream-&gt;pcm-&gt;card
suffix:semicolon
r_int
id|res
op_assign
l_int|0
suffix:semicolon
id|snd_power_lock
c_func
(paren
id|card
)paren
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|runtime-&gt;status-&gt;state
)paren
(brace
r_case
id|SNDRV_PCM_STATE_OPEN
suffix:colon
id|res
op_assign
op_minus
id|EBADFD
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_SETUP
suffix:colon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_PAUSED
suffix:colon
id|snd_pcm_pause
c_func
(paren
id|substream
comma
l_int|0
)paren
suffix:semicolon
multiline_comment|/* Fall through */
r_case
id|SNDRV_PCM_STATE_RUNNING
suffix:colon
r_case
id|SNDRV_PCM_STATE_DRAINING
suffix:colon
r_if
c_cond
(paren
id|snd_pcm_update_hw_ptr
c_func
(paren
id|substream
)paren
op_ge
l_int|0
)paren
(brace
id|snd_pcm_stop
c_func
(paren
id|substream
comma
id|SNDRV_PCM_STATE_SETUP
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
multiline_comment|/* Fall through */
r_case
id|SNDRV_PCM_STATE_PREPARED
suffix:colon
r_case
id|SNDRV_PCM_STATE_XRUN
suffix:colon
id|_xrun_recovery
suffix:colon
id|snd_pcm_change_state
c_func
(paren
id|substream
comma
id|SNDRV_PCM_STATE_SETUP
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_SUSPENDED
suffix:colon
r_while
c_loop
(paren
id|snd_power_get_state
c_func
(paren
id|card
)paren
op_ne
id|SNDRV_CTL_POWER_D0
)paren
(brace
r_if
c_cond
(paren
id|substream-&gt;ffile-&gt;f_flags
op_amp
id|O_NONBLOCK
)paren
(brace
id|res
op_assign
op_minus
id|EAGAIN
suffix:semicolon
r_goto
id|_end
suffix:semicolon
)brace
id|spin_unlock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
id|snd_power_wait
c_func
(paren
id|card
)paren
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
)brace
r_goto
id|_xrun_recovery
suffix:semicolon
)brace
id|runtime-&gt;control-&gt;appl_ptr
op_assign
id|runtime-&gt;status-&gt;hw_ptr
suffix:semicolon
id|_end
suffix:colon
id|spin_unlock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
id|snd_power_unlock
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|res
suffix:semicolon
)brace
DECL|function|snd_pcm_capture_drain
r_static
r_int
id|snd_pcm_capture_drain
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_card_t
op_star
id|card
op_assign
id|substream-&gt;pcm-&gt;card
suffix:semicolon
r_int
id|res
op_assign
l_int|0
suffix:semicolon
id|snd_power_lock
c_func
(paren
id|card
)paren
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|runtime-&gt;status-&gt;state
)paren
(brace
r_case
id|SNDRV_PCM_STATE_OPEN
suffix:colon
id|res
op_assign
op_minus
id|EBADFD
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_PREPARED
suffix:colon
id|snd_pcm_change_state
c_func
(paren
id|substream
comma
id|SNDRV_PCM_STATE_SETUP
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_SETUP
suffix:colon
r_case
id|SNDRV_PCM_STATE_DRAINING
suffix:colon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_PAUSED
suffix:colon
id|snd_pcm_pause
c_func
(paren
id|substream
comma
l_int|0
)paren
suffix:semicolon
multiline_comment|/* Fall through */
r_case
id|SNDRV_PCM_STATE_RUNNING
suffix:colon
r_if
c_cond
(paren
id|snd_pcm_update_hw_ptr
c_func
(paren
id|substream
)paren
op_ge
l_int|0
)paren
(brace
id|snd_pcm_stop
c_func
(paren
id|substream
comma
id|snd_pcm_capture_avail
c_func
(paren
id|runtime
)paren
OG
l_int|0
ques
c_cond
id|SNDRV_PCM_STATE_DRAINING
suffix:colon
id|SNDRV_PCM_STATE_SETUP
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
multiline_comment|/* Fall through */
r_case
id|SNDRV_PCM_STATE_XRUN
suffix:colon
id|_xrun_recovery
suffix:colon
id|snd_pcm_change_state
c_func
(paren
id|substream
comma
id|snd_pcm_capture_avail
c_func
(paren
id|runtime
)paren
OG
l_int|0
ques
c_cond
id|SNDRV_PCM_STATE_DRAINING
suffix:colon
id|SNDRV_PCM_STATE_SETUP
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_SUSPENDED
suffix:colon
r_while
c_loop
(paren
id|snd_power_get_state
c_func
(paren
id|card
)paren
op_ne
id|SNDRV_CTL_POWER_D0
)paren
(brace
r_if
c_cond
(paren
id|substream-&gt;ffile-&gt;f_flags
op_amp
id|O_NONBLOCK
)paren
(brace
id|res
op_assign
op_minus
id|EAGAIN
suffix:semicolon
r_goto
id|_end
suffix:semicolon
)brace
id|spin_unlock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
id|snd_power_wait
c_func
(paren
id|card
)paren
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
)brace
r_goto
id|_xrun_recovery
suffix:semicolon
)brace
id|_end
suffix:colon
id|spin_unlock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
id|snd_power_unlock
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|res
suffix:semicolon
)brace
DECL|function|snd_pcm_capture_drop
r_static
r_int
id|snd_pcm_capture_drop
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_card_t
op_star
id|card
op_assign
id|substream-&gt;pcm-&gt;card
suffix:semicolon
r_int
id|res
op_assign
l_int|0
suffix:semicolon
id|snd_power_lock
c_func
(paren
id|card
)paren
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|runtime-&gt;status-&gt;state
)paren
(brace
r_case
id|SNDRV_PCM_STATE_OPEN
suffix:colon
id|res
op_assign
op_minus
id|EBADFD
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_SETUP
suffix:colon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_PAUSED
suffix:colon
id|snd_pcm_pause
c_func
(paren
id|substream
comma
l_int|0
)paren
suffix:semicolon
multiline_comment|/* Fall through */
r_case
id|SNDRV_PCM_STATE_RUNNING
suffix:colon
id|snd_pcm_stop
c_func
(paren
id|substream
comma
id|SNDRV_PCM_STATE_SETUP
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_SUSPENDED
suffix:colon
r_while
c_loop
(paren
id|snd_power_get_state
c_func
(paren
id|card
)paren
op_ne
id|SNDRV_CTL_POWER_D0
)paren
(brace
r_if
c_cond
(paren
id|substream-&gt;ffile-&gt;f_flags
op_amp
id|O_NONBLOCK
)paren
(brace
id|res
op_assign
op_minus
id|EAGAIN
suffix:semicolon
r_goto
id|_end
suffix:semicolon
)brace
id|spin_unlock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
id|snd_power_wait
c_func
(paren
id|card
)paren
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
)brace
multiline_comment|/* Fall through */
r_case
id|SNDRV_PCM_STATE_PREPARED
suffix:colon
r_case
id|SNDRV_PCM_STATE_DRAINING
suffix:colon
r_case
id|SNDRV_PCM_STATE_XRUN
suffix:colon
id|snd_pcm_change_state
c_func
(paren
id|substream
comma
id|SNDRV_PCM_STATE_SETUP
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|runtime-&gt;control-&gt;appl_ptr
op_assign
id|runtime-&gt;status-&gt;hw_ptr
suffix:semicolon
id|_end
suffix:colon
id|spin_unlock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
id|snd_power_unlock
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|res
suffix:semicolon
)brace
multiline_comment|/* WARNING: Don&squot;t forget to fput back the file */
DECL|function|snd_pcm_file_fd
r_static
r_struct
id|file
op_star
id|snd_pcm_file_fd
c_func
(paren
r_int
id|fd
)paren
(brace
r_struct
id|file
op_star
id|file
suffix:semicolon
r_struct
id|inode
op_star
id|inode
suffix:semicolon
r_int
r_int
id|minor
suffix:semicolon
id|file
op_assign
id|fget
c_func
(paren
id|fd
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|file
)paren
r_return
l_int|0
suffix:semicolon
id|inode
op_assign
id|file-&gt;f_dentry-&gt;d_inode
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|S_ISCHR
c_func
(paren
id|inode-&gt;i_mode
)paren
op_logical_or
id|major
c_func
(paren
id|inode-&gt;i_rdev
)paren
op_ne
id|CONFIG_SND_MAJOR
)paren
(brace
id|fput
c_func
(paren
id|file
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|minor
op_assign
id|minor
c_func
(paren
id|inode-&gt;i_rdev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|minor
op_ge
l_int|256
op_logical_or
id|minor
op_mod
id|SNDRV_MINOR_DEVICES
OL
id|SNDRV_MINOR_PCM_PLAYBACK
)paren
(brace
id|fput
c_func
(paren
id|file
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_return
id|file
suffix:semicolon
)brace
DECL|function|snd_pcm_link
r_static
r_int
id|snd_pcm_link
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|fd
)paren
(brace
r_int
id|res
op_assign
l_int|0
suffix:semicolon
r_struct
id|file
op_star
id|file
suffix:semicolon
id|snd_pcm_file_t
op_star
id|pcm_file
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|s
comma
op_star
id|substream1
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_OPEN
)paren
r_return
op_minus
id|EBADFD
suffix:semicolon
id|file
op_assign
id|snd_pcm_file_fd
c_func
(paren
id|fd
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|file
)paren
r_return
op_minus
id|EBADFD
suffix:semicolon
id|pcm_file
op_assign
id|snd_magic_cast
c_func
(paren
id|snd_pcm_file_t
comma
id|file-&gt;private_data
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|substream1
op_assign
id|pcm_file-&gt;substream
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|pcm_link_lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;runtime-&gt;status-&gt;state
op_ne
id|substream1-&gt;runtime-&gt;status-&gt;state
)paren
(brace
id|res
op_assign
op_minus
id|EBADFD
suffix:semicolon
r_goto
id|_end
suffix:semicolon
)brace
id|s
op_assign
id|substream
suffix:semicolon
r_do
(brace
r_if
c_cond
(paren
id|s
op_eq
id|substream1
)paren
(brace
id|res
op_assign
op_minus
id|EALREADY
suffix:semicolon
r_goto
id|_end
suffix:semicolon
)brace
id|s
op_assign
id|s-&gt;link_next
suffix:semicolon
)brace
r_while
c_loop
(paren
id|s
op_ne
id|substream
)paren
suffix:semicolon
id|substream1-&gt;link_prev-&gt;link_next
op_assign
id|substream-&gt;link_next
suffix:semicolon
id|substream-&gt;link_next-&gt;link_prev
op_assign
id|substream1-&gt;link_prev
suffix:semicolon
id|substream-&gt;link_next
op_assign
id|substream1
suffix:semicolon
id|substream1-&gt;link_prev
op_assign
id|substream
suffix:semicolon
id|_end
suffix:colon
id|spin_unlock_irq
c_func
(paren
op_amp
id|pcm_link_lock
)paren
suffix:semicolon
id|fput
c_func
(paren
id|file
)paren
suffix:semicolon
r_return
id|res
suffix:semicolon
)brace
DECL|function|snd_pcm_unlink
r_static
r_int
id|snd_pcm_unlink
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|spin_lock_irq
c_func
(paren
op_amp
id|pcm_link_lock
)paren
suffix:semicolon
id|substream-&gt;link_prev-&gt;link_next
op_assign
id|substream-&gt;link_next
suffix:semicolon
id|substream-&gt;link_next-&gt;link_prev
op_assign
id|substream-&gt;link_prev
suffix:semicolon
id|substream-&gt;link_prev
op_assign
id|substream
suffix:semicolon
id|substream-&gt;link_next
op_assign
id|substream
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|pcm_link_lock
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_hw_rule_mul
r_static
r_int
id|snd_pcm_hw_rule_mul
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_rule_t
op_star
id|rule
)paren
(brace
id|snd_interval_t
id|t
suffix:semicolon
id|snd_interval_mul
c_func
(paren
id|hw_param_interval_c
c_func
(paren
id|params
comma
id|rule-&gt;deps
(braket
l_int|0
)braket
)paren
comma
id|hw_param_interval_c
c_func
(paren
id|params
comma
id|rule-&gt;deps
(braket
l_int|1
)braket
)paren
comma
op_amp
id|t
)paren
suffix:semicolon
r_return
id|snd_interval_refine
c_func
(paren
id|hw_param_interval
c_func
(paren
id|params
comma
id|rule-&gt;var
)paren
comma
op_amp
id|t
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_hw_rule_div
r_static
r_int
id|snd_pcm_hw_rule_div
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_rule_t
op_star
id|rule
)paren
(brace
id|snd_interval_t
id|t
suffix:semicolon
id|snd_interval_div
c_func
(paren
id|hw_param_interval_c
c_func
(paren
id|params
comma
id|rule-&gt;deps
(braket
l_int|0
)braket
)paren
comma
id|hw_param_interval_c
c_func
(paren
id|params
comma
id|rule-&gt;deps
(braket
l_int|1
)braket
)paren
comma
op_amp
id|t
)paren
suffix:semicolon
r_return
id|snd_interval_refine
c_func
(paren
id|hw_param_interval
c_func
(paren
id|params
comma
id|rule-&gt;var
)paren
comma
op_amp
id|t
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_hw_rule_muldivk
r_static
r_int
id|snd_pcm_hw_rule_muldivk
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_rule_t
op_star
id|rule
)paren
(brace
id|snd_interval_t
id|t
suffix:semicolon
id|snd_interval_muldivk
c_func
(paren
id|hw_param_interval_c
c_func
(paren
id|params
comma
id|rule-&gt;deps
(braket
l_int|0
)braket
)paren
comma
id|hw_param_interval_c
c_func
(paren
id|params
comma
id|rule-&gt;deps
(braket
l_int|1
)braket
)paren
comma
(paren
r_int
r_int
)paren
id|rule
op_member_access_from_pointer
r_private
comma
op_amp
id|t
)paren
suffix:semicolon
r_return
id|snd_interval_refine
c_func
(paren
id|hw_param_interval
c_func
(paren
id|params
comma
id|rule-&gt;var
)paren
comma
op_amp
id|t
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_hw_rule_mulkdiv
r_static
r_int
id|snd_pcm_hw_rule_mulkdiv
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_rule_t
op_star
id|rule
)paren
(brace
id|snd_interval_t
id|t
suffix:semicolon
id|snd_interval_mulkdiv
c_func
(paren
id|hw_param_interval_c
c_func
(paren
id|params
comma
id|rule-&gt;deps
(braket
l_int|0
)braket
)paren
comma
(paren
r_int
r_int
)paren
id|rule
op_member_access_from_pointer
r_private
comma
id|hw_param_interval_c
c_func
(paren
id|params
comma
id|rule-&gt;deps
(braket
l_int|1
)braket
)paren
comma
op_amp
id|t
)paren
suffix:semicolon
r_return
id|snd_interval_refine
c_func
(paren
id|hw_param_interval
c_func
(paren
id|params
comma
id|rule-&gt;var
)paren
comma
op_amp
id|t
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_hw_rule_format
r_static
r_int
id|snd_pcm_hw_rule_format
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_rule_t
op_star
id|rule
)paren
(brace
r_int
r_int
id|k
suffix:semicolon
id|snd_interval_t
op_star
id|i
op_assign
id|hw_param_interval
c_func
(paren
id|params
comma
id|rule-&gt;deps
(braket
l_int|0
)braket
)paren
suffix:semicolon
r_int
r_int
id|m
op_assign
op_complement
l_int|0U
suffix:semicolon
r_int
r_int
op_star
id|mask
op_assign
id|hw_param_mask
c_func
(paren
id|params
comma
id|SNDRV_PCM_HW_PARAM_FORMAT
)paren
suffix:semicolon
r_for
c_loop
(paren
id|k
op_assign
l_int|0
suffix:semicolon
id|k
op_le
id|SNDRV_PCM_FORMAT_LAST
suffix:semicolon
op_increment
id|k
)paren
(brace
r_int
id|bits
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
op_star
id|mask
op_amp
(paren
l_int|1U
op_lshift
id|k
)paren
)paren
)paren
r_continue
suffix:semicolon
id|bits
op_assign
id|snd_pcm_format_physical_width
c_func
(paren
id|k
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|bits
OG
l_int|0
comma
r_continue
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
r_int
)paren
id|bits
template_param
id|i-&gt;max
)paren
id|m
op_and_assign
op_complement
(paren
l_int|1U
op_lshift
id|k
)paren
suffix:semicolon
)brace
r_return
id|snd_mask_refine
c_func
(paren
id|mask
comma
op_amp
id|m
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_hw_rule_sample_bits
r_static
r_int
id|snd_pcm_hw_rule_sample_bits
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_rule_t
op_star
id|rule
)paren
(brace
id|snd_interval_t
id|t
suffix:semicolon
r_int
r_int
id|k
suffix:semicolon
id|t.min
op_assign
id|UINT_MAX
suffix:semicolon
id|t.max
op_assign
l_int|0
suffix:semicolon
id|t.openmin
op_assign
l_int|0
suffix:semicolon
id|t.openmax
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|k
op_assign
l_int|0
suffix:semicolon
id|k
op_le
id|SNDRV_PCM_FORMAT_LAST
suffix:semicolon
op_increment
id|k
)paren
(brace
r_int
id|bits
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
op_star
id|hw_param_mask
c_func
(paren
id|params
comma
id|SNDRV_PCM_HW_PARAM_FORMAT
)paren
op_amp
(paren
l_int|1U
op_lshift
id|k
)paren
)paren
)paren
r_continue
suffix:semicolon
id|bits
op_assign
id|snd_pcm_format_physical_width
c_func
(paren
id|k
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|bits
OG
l_int|0
comma
r_continue
)paren
suffix:semicolon
r_if
c_cond
(paren
id|t.min
OG
(paren
r_int
)paren
id|bits
)paren
id|t.min
op_assign
id|bits
suffix:semicolon
r_if
c_cond
(paren
id|t.max
OL
(paren
r_int
)paren
id|bits
)paren
id|t.max
op_assign
id|bits
suffix:semicolon
)brace
id|t.integer
op_assign
l_int|1
suffix:semicolon
r_return
id|snd_interval_refine
c_func
(paren
id|hw_param_interval
c_func
(paren
id|params
comma
id|rule-&gt;var
)paren
comma
op_amp
id|t
)paren
suffix:semicolon
)brace
macro_line|#if SNDRV_PCM_RATE_5512 != 1 &lt;&lt; 0 || SNDRV_PCM_RATE_192000 != 1 &lt;&lt; 12
macro_line|#error &quot;Change this table&quot;
macro_line|#endif
DECL|variable|rates
r_static
r_int
r_int
id|rates
(braket
)braket
op_assign
(brace
l_int|5512
comma
l_int|8000
comma
l_int|11025
comma
l_int|16000
comma
l_int|22050
comma
l_int|32000
comma
l_int|44100
comma
l_int|48000
comma
l_int|64000
comma
l_int|88200
comma
l_int|96000
comma
l_int|176400
comma
l_int|192000
)brace
suffix:semicolon
DECL|macro|RATES
mdefine_line|#define RATES (sizeof(rates) / sizeof(rates[0]))
DECL|function|snd_pcm_hw_rule_rate
r_static
r_int
id|snd_pcm_hw_rule_rate
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_rule_t
op_star
id|rule
)paren
(brace
id|snd_pcm_hardware_t
op_star
id|hw
op_assign
id|rule
op_member_access_from_pointer
r_private
suffix:semicolon
r_return
id|snd_interval_list
c_func
(paren
id|hw_param_interval
c_func
(paren
id|params
comma
id|rule-&gt;var
)paren
comma
id|RATES
comma
id|rates
comma
id|hw-&gt;rates
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_hw_rule_buffer_bytes_max
r_static
r_int
id|snd_pcm_hw_rule_buffer_bytes_max
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_rule_t
op_star
id|rule
)paren
(brace
id|snd_interval_t
id|t
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|substream
op_assign
id|rule
op_member_access_from_pointer
r_private
suffix:semicolon
id|t.min
op_assign
l_int|0
suffix:semicolon
id|t.max
op_assign
id|substream-&gt;buffer_bytes_max
suffix:semicolon
id|t.openmin
op_assign
l_int|0
suffix:semicolon
id|t.openmax
op_assign
l_int|0
suffix:semicolon
id|t.integer
op_assign
l_int|1
suffix:semicolon
r_return
id|snd_interval_refine
c_func
(paren
id|hw_param_interval
c_func
(paren
id|params
comma
id|rule-&gt;var
)paren
comma
op_amp
id|t
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_hw_constraints_init
r_int
id|snd_pcm_hw_constraints_init
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_pcm_hw_constraints_t
op_star
id|constrs
op_assign
op_amp
id|runtime-&gt;hw_constraints
suffix:semicolon
r_int
id|k
comma
id|err
suffix:semicolon
r_for
c_loop
(paren
id|k
op_assign
id|SNDRV_PCM_HW_PARAM_FIRST_MASK
suffix:semicolon
id|k
op_le
id|SNDRV_PCM_HW_PARAM_LAST_MASK
suffix:semicolon
id|k
op_increment
)paren
(brace
id|snd_mask_any
c_func
(paren
id|constrs_mask
c_func
(paren
id|constrs
comma
id|k
)paren
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|k
op_assign
id|SNDRV_PCM_HW_PARAM_FIRST_INTERVAL
suffix:semicolon
id|k
op_le
id|SNDRV_PCM_HW_PARAM_LAST_INTERVAL
suffix:semicolon
id|k
op_increment
)paren
(brace
id|snd_interval_any
c_func
(paren
id|constrs_interval
c_func
(paren
id|constrs
comma
id|k
)paren
)paren
suffix:semicolon
)brace
id|snd_interval_setinteger
c_func
(paren
id|constrs_interval
c_func
(paren
id|constrs
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
)paren
)paren
suffix:semicolon
id|snd_interval_setinteger
c_func
(paren
id|constrs_interval
c_func
(paren
id|constrs
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_SIZE
)paren
)paren
suffix:semicolon
id|snd_interval_setinteger
c_func
(paren
id|constrs_interval
c_func
(paren
id|constrs
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_BYTES
)paren
)paren
suffix:semicolon
id|snd_interval_setinteger
c_func
(paren
id|constrs_interval
c_func
(paren
id|constrs
comma
id|SNDRV_PCM_HW_PARAM_SAMPLE_BITS
)paren
)paren
suffix:semicolon
id|snd_interval_setinteger
c_func
(paren
id|constrs_interval
c_func
(paren
id|constrs
comma
id|SNDRV_PCM_HW_PARAM_FRAME_BITS
)paren
)paren
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_FORMAT
comma
id|snd_pcm_hw_rule_format
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_SAMPLE_BITS
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_SAMPLE_BITS
comma
id|snd_pcm_hw_rule_sample_bits
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_FORMAT
comma
id|SNDRV_PCM_HW_PARAM_SAMPLE_BITS
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_SAMPLE_BITS
comma
id|snd_pcm_hw_rule_div
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_FRAME_BITS
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_FRAME_BITS
comma
id|snd_pcm_hw_rule_mul
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_SAMPLE_BITS
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_FRAME_BITS
comma
id|snd_pcm_hw_rule_mulkdiv
comma
(paren
r_void
op_star
)paren
l_int|8
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_BYTES
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_SIZE
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_FRAME_BITS
comma
id|snd_pcm_hw_rule_mulkdiv
comma
(paren
r_void
op_star
)paren
l_int|8
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_BYTES
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_SIZE
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
comma
id|snd_pcm_hw_rule_div
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_FRAME_BITS
comma
id|SNDRV_PCM_HW_PARAM_SAMPLE_BITS
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_RATE
comma
id|snd_pcm_hw_rule_mulkdiv
comma
(paren
r_void
op_star
)paren
l_int|1000000
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_SIZE
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_TIME
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_RATE
comma
id|snd_pcm_hw_rule_mulkdiv
comma
(paren
r_void
op_star
)paren
l_int|1000000
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_SIZE
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_TIME
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_PERIODS
comma
id|snd_pcm_hw_rule_div
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_SIZE
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_SIZE
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_SIZE
comma
id|snd_pcm_hw_rule_div
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_SIZE
comma
id|SNDRV_PCM_HW_PARAM_PERIODS
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_SIZE
comma
id|snd_pcm_hw_rule_mulkdiv
comma
(paren
r_void
op_star
)paren
l_int|8
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_BYTES
comma
id|SNDRV_PCM_HW_PARAM_FRAME_BITS
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_SIZE
comma
id|snd_pcm_hw_rule_muldivk
comma
(paren
r_void
op_star
)paren
l_int|1000000
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_TIME
comma
id|SNDRV_PCM_HW_PARAM_RATE
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_SIZE
comma
id|snd_pcm_hw_rule_mul
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_SIZE
comma
id|SNDRV_PCM_HW_PARAM_PERIODS
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_SIZE
comma
id|snd_pcm_hw_rule_mulkdiv
comma
(paren
r_void
op_star
)paren
l_int|8
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_BYTES
comma
id|SNDRV_PCM_HW_PARAM_FRAME_BITS
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_SIZE
comma
id|snd_pcm_hw_rule_muldivk
comma
(paren
r_void
op_star
)paren
l_int|1000000
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_TIME
comma
id|SNDRV_PCM_HW_PARAM_RATE
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_BYTES
comma
id|snd_pcm_hw_rule_muldivk
comma
(paren
r_void
op_star
)paren
l_int|8
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_SIZE
comma
id|SNDRV_PCM_HW_PARAM_FRAME_BITS
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_BYTES
comma
id|snd_pcm_hw_rule_muldivk
comma
(paren
r_void
op_star
)paren
l_int|8
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_SIZE
comma
id|SNDRV_PCM_HW_PARAM_FRAME_BITS
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_TIME
comma
id|snd_pcm_hw_rule_mulkdiv
comma
(paren
r_void
op_star
)paren
l_int|1000000
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_SIZE
comma
id|SNDRV_PCM_HW_PARAM_RATE
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_TIME
comma
id|snd_pcm_hw_rule_mulkdiv
comma
(paren
r_void
op_star
)paren
l_int|1000000
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_SIZE
comma
id|SNDRV_PCM_HW_PARAM_RATE
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_hw_constraints_complete
r_int
id|snd_pcm_hw_constraints_complete
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_pcm_hardware_t
op_star
id|hw
op_assign
op_amp
id|runtime-&gt;hw
suffix:semicolon
r_int
id|err
suffix:semicolon
r_int
r_int
id|mask
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|hw-&gt;info
op_amp
id|SNDRV_PCM_INFO_INTERLEAVED
)paren
id|mask
op_or_assign
l_int|1
op_lshift
id|SNDRV_PCM_ACCESS_RW_INTERLEAVED
suffix:semicolon
r_if
c_cond
(paren
id|hw-&gt;info
op_amp
id|SNDRV_PCM_INFO_NONINTERLEAVED
)paren
id|mask
op_or_assign
l_int|1
op_lshift
id|SNDRV_PCM_ACCESS_RW_NONINTERLEAVED
suffix:semicolon
r_if
c_cond
(paren
id|hw-&gt;info
op_amp
id|SNDRV_PCM_INFO_MMAP
)paren
(brace
r_if
c_cond
(paren
id|hw-&gt;info
op_amp
id|SNDRV_PCM_INFO_INTERLEAVED
)paren
id|mask
op_or_assign
l_int|1
op_lshift
id|SNDRV_PCM_ACCESS_MMAP_INTERLEAVED
suffix:semicolon
r_if
c_cond
(paren
id|hw-&gt;info
op_amp
id|SNDRV_PCM_INFO_NONINTERLEAVED
)paren
id|mask
op_or_assign
l_int|1
op_lshift
id|SNDRV_PCM_ACCESS_MMAP_NONINTERLEAVED
suffix:semicolon
r_if
c_cond
(paren
id|hw-&gt;info
op_amp
id|SNDRV_PCM_INFO_COMPLEX
)paren
id|mask
op_or_assign
l_int|1
op_lshift
id|SNDRV_PCM_ACCESS_MMAP_COMPLEX
suffix:semicolon
)brace
id|err
op_assign
id|snd_pcm_hw_constraint_mask
c_func
(paren
id|runtime
comma
id|SNDRV_PCM_HW_PARAM_ACCESS
comma
id|mask
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|err
op_ge
l_int|0
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_constraint_mask
c_func
(paren
id|runtime
comma
id|SNDRV_PCM_HW_PARAM_FORMAT
comma
id|hw-&gt;formats
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|err
op_ge
l_int|0
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_constraint_mask
c_func
(paren
id|runtime
comma
id|SNDRV_PCM_HW_PARAM_SUBFORMAT
comma
l_int|1
op_lshift
id|SNDRV_PCM_SUBFORMAT_STD
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|err
op_ge
l_int|0
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_constraint_minmax
c_func
(paren
id|runtime
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
comma
id|hw-&gt;channels_min
comma
id|hw-&gt;channels_max
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|err
op_ge
l_int|0
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_constraint_minmax
c_func
(paren
id|runtime
comma
id|SNDRV_PCM_HW_PARAM_RATE
comma
id|hw-&gt;rate_min
comma
id|hw-&gt;rate_max
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|err
op_ge
l_int|0
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_constraint_minmax
c_func
(paren
id|runtime
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_BYTES
comma
id|hw-&gt;period_bytes_min
comma
id|hw-&gt;period_bytes_max
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|err
op_ge
l_int|0
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_constraint_minmax
c_func
(paren
id|runtime
comma
id|SNDRV_PCM_HW_PARAM_PERIODS
comma
id|hw-&gt;periods_min
comma
id|hw-&gt;periods_max
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|err
op_ge
l_int|0
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_constraint_minmax
c_func
(paren
id|runtime
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_BYTES
comma
id|hw-&gt;period_bytes_min
comma
id|hw-&gt;buffer_bytes_max
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|err
op_ge
l_int|0
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_BYTES
comma
id|snd_pcm_hw_rule_buffer_bytes_max
comma
id|substream
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_BYTES
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
multiline_comment|/* FIXME: remove */
r_if
c_cond
(paren
id|runtime-&gt;dma_bytes
)paren
(brace
id|err
op_assign
id|snd_pcm_hw_constraint_minmax
c_func
(paren
id|runtime
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_BYTES
comma
l_int|0
comma
id|runtime-&gt;dma_bytes
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|err
op_ge
l_int|0
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|hw-&gt;rates
op_amp
(paren
id|SNDRV_PCM_RATE_KNOT
op_or
id|SNDRV_PCM_RATE_CONTINUOUS
)paren
)paren
)paren
(brace
id|err
op_assign
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_RATE
comma
id|snd_pcm_hw_rule_rate
comma
id|hw
comma
id|SNDRV_PCM_HW_PARAM_RATE
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
multiline_comment|/* FIXME: this belong to lowlevel */
id|snd_pcm_hw_constraint_minmax
c_func
(paren
id|runtime
comma
id|SNDRV_PCM_HW_PARAM_TICK_TIME
comma
l_int|1000000
op_div
id|HZ
comma
l_int|1000000
op_div
id|HZ
)paren
suffix:semicolon
id|snd_pcm_hw_constraint_integer
c_func
(paren
id|runtime
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_SIZE
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_add_file
r_static
r_void
id|snd_pcm_add_file
c_func
(paren
id|snd_pcm_str_t
op_star
id|str
comma
id|snd_pcm_file_t
op_star
id|pcm_file
)paren
(brace
id|pcm_file-&gt;next
op_assign
id|str-&gt;files
suffix:semicolon
id|str-&gt;files
op_assign
id|pcm_file
suffix:semicolon
)brace
DECL|function|snd_pcm_remove_file
r_static
r_void
id|snd_pcm_remove_file
c_func
(paren
id|snd_pcm_str_t
op_star
id|str
comma
id|snd_pcm_file_t
op_star
id|pcm_file
)paren
(brace
id|snd_pcm_file_t
op_star
id|pcm_file1
suffix:semicolon
r_if
c_cond
(paren
id|str-&gt;files
op_eq
id|pcm_file
)paren
(brace
id|str-&gt;files
op_assign
id|pcm_file-&gt;next
suffix:semicolon
)brace
r_else
(brace
id|pcm_file1
op_assign
id|str-&gt;files
suffix:semicolon
r_while
c_loop
(paren
id|pcm_file1
op_logical_and
id|pcm_file1-&gt;next
op_ne
id|pcm_file
)paren
id|pcm_file1
op_assign
id|pcm_file1-&gt;next
suffix:semicolon
r_if
c_cond
(paren
id|pcm_file1
op_ne
l_int|NULL
)paren
id|pcm_file1-&gt;next
op_assign
id|pcm_file-&gt;next
suffix:semicolon
)brace
)brace
DECL|function|snd_pcm_release_file
r_static
r_int
id|snd_pcm_release_file
c_func
(paren
id|snd_pcm_file_t
op_star
id|pcm_file
)paren
(brace
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
id|snd_pcm_str_t
op_star
id|str
suffix:semicolon
id|snd_assert
c_func
(paren
id|pcm_file
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|substream
op_assign
id|pcm_file-&gt;substream
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|str
op_assign
id|substream-&gt;pstr
suffix:semicolon
id|snd_pcm_unlink
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;ops-&gt;hw_free
op_ne
l_int|NULL
)paren
id|substream-&gt;ops
op_member_access_from_pointer
id|hw_free
c_func
(paren
id|substream
)paren
suffix:semicolon
id|substream-&gt;ops
op_member_access_from_pointer
id|close
c_func
(paren
id|substream
)paren
suffix:semicolon
id|substream-&gt;ffile
op_assign
l_int|NULL
suffix:semicolon
id|snd_pcm_remove_file
c_func
(paren
id|str
comma
id|pcm_file
)paren
suffix:semicolon
id|snd_pcm_release_substream
c_func
(paren
id|substream
)paren
suffix:semicolon
id|snd_magic_kfree
c_func
(paren
id|pcm_file
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_open_file
r_static
r_int
id|snd_pcm_open_file
c_func
(paren
r_struct
id|file
op_star
id|file
comma
id|snd_pcm_t
op_star
id|pcm
comma
r_int
id|stream
comma
id|snd_pcm_file_t
op_star
op_star
id|rpcm_file
)paren
(brace
r_int
id|err
op_assign
l_int|0
suffix:semicolon
id|snd_pcm_file_t
op_star
id|pcm_file
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
id|snd_pcm_str_t
op_star
id|str
suffix:semicolon
id|snd_assert
c_func
(paren
id|rpcm_file
op_ne
l_int|NULL
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
op_star
id|rpcm_file
op_assign
l_int|NULL
suffix:semicolon
id|pcm_file
op_assign
id|snd_magic_kcalloc
c_func
(paren
id|snd_pcm_file_t
comma
l_int|0
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pcm_file
op_eq
l_int|NULL
)paren
(brace
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_pcm_open_substream
c_func
(paren
id|pcm
comma
id|stream
comma
op_amp
id|substream
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_magic_kfree
c_func
(paren
id|pcm_file
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
id|str
op_assign
id|substream-&gt;pstr
suffix:semicolon
id|substream-&gt;file
op_assign
id|pcm_file
suffix:semicolon
id|pcm_file-&gt;substream
op_assign
id|substream
suffix:semicolon
id|snd_pcm_add_file
c_func
(paren
id|str
comma
id|pcm_file
)paren
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_constraints_init
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
(brace
id|snd_printd
c_func
(paren
l_string|&quot;snd_pcm_hw_constraints_init failed&bslash;n&quot;
)paren
suffix:semicolon
id|snd_pcm_release_file
c_func
(paren
id|pcm_file
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|substream-&gt;ops
op_member_access_from_pointer
id|open
c_func
(paren
id|substream
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_pcm_release_file
c_func
(paren
id|pcm_file
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
id|err
op_assign
id|snd_pcm_hw_constraints_complete
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
(brace
id|snd_printd
c_func
(paren
l_string|&quot;snd_pcm_hw_constraints_complete failed&bslash;n&quot;
)paren
suffix:semicolon
id|substream-&gt;ops
op_member_access_from_pointer
id|close
c_func
(paren
id|substream
)paren
suffix:semicolon
id|snd_pcm_release_file
c_func
(paren
id|pcm_file
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
id|substream-&gt;ffile
op_assign
id|file
suffix:semicolon
id|file-&gt;private_data
op_assign
id|pcm_file
suffix:semicolon
op_star
id|rpcm_file
op_assign
id|pcm_file
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_open
r_int
id|snd_pcm_open
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_int
id|cardnum
op_assign
id|SNDRV_MINOR_CARD
c_func
(paren
id|minor
c_func
(paren
id|inode-&gt;i_rdev
)paren
)paren
suffix:semicolon
r_int
id|device
op_assign
id|SNDRV_MINOR_DEVICE
c_func
(paren
id|minor
c_func
(paren
id|inode-&gt;i_rdev
)paren
)paren
suffix:semicolon
r_int
id|err
suffix:semicolon
id|snd_pcm_t
op_star
id|pcm
suffix:semicolon
id|snd_pcm_file_t
op_star
id|pcm_file
suffix:semicolon
id|wait_queue_t
id|wait
suffix:semicolon
macro_line|#ifdef LINUX_2_2
id|MOD_INC_USE_COUNT
suffix:semicolon
macro_line|#endif
id|snd_runtime_check
c_func
(paren
id|device
op_ge
id|SNDRV_MINOR_PCM_PLAYBACK
op_logical_and
id|device
OL
id|SNDRV_MINOR_DEVICES
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|pcm
op_assign
id|snd_pcm_devices
(braket
(paren
id|cardnum
op_star
id|SNDRV_PCM_DEVICES
)paren
op_plus
(paren
id|device
op_mod
id|SNDRV_MINOR_PCMS
)paren
)braket
suffix:semicolon
r_if
c_cond
(paren
id|pcm
op_eq
l_int|NULL
)paren
(brace
id|err
op_assign
op_minus
id|ENODEV
suffix:semicolon
r_goto
id|__error1
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|try_inc_mod_count
c_func
(paren
id|pcm-&gt;card-&gt;module
)paren
)paren
(brace
id|err
op_assign
op_minus
id|EFAULT
suffix:semicolon
r_goto
id|__error1
suffix:semicolon
)brace
id|init_waitqueue_entry
c_func
(paren
op_amp
id|wait
comma
id|current
)paren
suffix:semicolon
id|add_wait_queue
c_func
(paren
op_amp
id|pcm-&gt;open_wait
comma
op_amp
id|wait
)paren
suffix:semicolon
r_while
c_loop
(paren
l_int|1
)paren
(brace
id|down
c_func
(paren
op_amp
id|pcm-&gt;open_mutex
)paren
suffix:semicolon
id|err
op_assign
id|snd_pcm_open_file
c_func
(paren
id|file
comma
id|pcm
comma
id|device
op_ge
id|SNDRV_MINOR_PCM_CAPTURE
ques
c_cond
id|SNDRV_PCM_STREAM_CAPTURE
suffix:colon
id|SNDRV_PCM_STREAM_PLAYBACK
comma
op_amp
id|pcm_file
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
op_ge
l_int|0
)paren
r_break
suffix:semicolon
id|up
c_func
(paren
op_amp
id|pcm-&gt;open_mutex
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
op_eq
op_minus
id|EAGAIN
)paren
(brace
r_if
c_cond
(paren
id|file-&gt;f_flags
op_amp
id|O_NONBLOCK
)paren
(brace
id|err
op_assign
op_minus
id|EBUSY
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_else
r_break
suffix:semicolon
id|set_current_state
c_func
(paren
id|TASK_INTERRUPTIBLE
)paren
suffix:semicolon
id|schedule
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|signal_pending
c_func
(paren
id|current
)paren
)paren
(brace
id|err
op_assign
op_minus
id|ERESTARTSYS
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
id|set_current_state
c_func
(paren
id|TASK_RUNNING
)paren
suffix:semicolon
id|remove_wait_queue
c_func
(paren
op_amp
id|pcm-&gt;open_wait
comma
op_amp
id|wait
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_goto
id|__error
suffix:semicolon
id|up
c_func
(paren
op_amp
id|pcm-&gt;open_mutex
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
id|__error
suffix:colon
id|dec_mod_count
c_func
(paren
id|pcm-&gt;card-&gt;module
)paren
suffix:semicolon
id|__error1
suffix:colon
macro_line|#ifdef LINUX_2_2
id|MOD_DEC_USE_COUNT
suffix:semicolon
macro_line|#endif
r_return
id|err
suffix:semicolon
)brace
DECL|function|snd_pcm_release
r_int
id|snd_pcm_release
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
id|snd_pcm_t
op_star
id|pcm
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
id|snd_pcm_file_t
op_star
id|pcm_file
suffix:semicolon
id|pcm_file
op_assign
id|snd_magic_cast
c_func
(paren
id|snd_pcm_file_t
comma
id|file-&gt;private_data
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|substream
op_assign
id|pcm_file-&gt;substream
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
op_logical_neg
id|atomic_read
c_func
(paren
op_amp
id|substream-&gt;runtime-&gt;mmap_count
)paren
comma
)paren
suffix:semicolon
id|pcm
op_assign
id|substream-&gt;pcm
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_PLAYBACK
)paren
(brace
r_if
c_cond
(paren
(paren
id|substream-&gt;ffile-&gt;f_flags
op_amp
id|O_NONBLOCK
)paren
op_logical_or
id|snd_pcm_playback_drain
c_func
(paren
id|substream
)paren
op_eq
op_minus
id|ERESTARTSYS
)paren
id|snd_pcm_playback_drop
c_func
(paren
id|substream
)paren
suffix:semicolon
)brace
r_else
id|snd_pcm_capture_drop
c_func
(paren
id|substream
)paren
suffix:semicolon
id|fasync_helper
c_func
(paren
op_minus
l_int|1
comma
id|file
comma
l_int|0
comma
op_amp
id|substream-&gt;runtime-&gt;fasync
)paren
suffix:semicolon
id|down
c_func
(paren
op_amp
id|pcm-&gt;open_mutex
)paren
suffix:semicolon
id|snd_pcm_release_file
c_func
(paren
id|pcm_file
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|pcm-&gt;open_mutex
)paren
suffix:semicolon
id|wake_up
c_func
(paren
op_amp
id|pcm-&gt;open_wait
)paren
suffix:semicolon
id|dec_mod_count
c_func
(paren
id|pcm-&gt;card-&gt;module
)paren
suffix:semicolon
macro_line|#ifdef LINUX_2_2
id|MOD_DEC_USE_COUNT
suffix:semicolon
macro_line|#endif
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_playback_rewind
id|snd_pcm_sframes_t
id|snd_pcm_playback_rewind
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_uframes_t
id|frames
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_pcm_sframes_t
id|appl_ptr
suffix:semicolon
id|snd_pcm_sframes_t
id|ret
suffix:semicolon
id|snd_pcm_sframes_t
id|hw_avail
suffix:semicolon
r_if
c_cond
(paren
id|frames
op_eq
l_int|0
)paren
r_return
l_int|0
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|runtime-&gt;status-&gt;state
)paren
(brace
r_case
id|SNDRV_PCM_STATE_PREPARED
suffix:colon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_DRAINING
suffix:colon
r_case
id|SNDRV_PCM_STATE_RUNNING
suffix:colon
r_if
c_cond
(paren
id|snd_pcm_update_hw_ptr
c_func
(paren
id|substream
)paren
op_ge
l_int|0
)paren
r_break
suffix:semicolon
multiline_comment|/* Fall through */
r_case
id|SNDRV_PCM_STATE_XRUN
suffix:colon
id|ret
op_assign
op_minus
id|EPIPE
suffix:semicolon
r_goto
id|__end
suffix:semicolon
r_default
suffix:colon
id|ret
op_assign
op_minus
id|EBADFD
suffix:semicolon
r_goto
id|__end
suffix:semicolon
)brace
id|hw_avail
op_assign
id|snd_pcm_playback_hw_avail
c_func
(paren
id|runtime
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hw_avail
op_le
l_int|0
)paren
(brace
id|ret
op_assign
l_int|0
suffix:semicolon
r_goto
id|__end
suffix:semicolon
)brace
r_if
c_cond
(paren
id|frames
OG
id|hw_avail
)paren
id|frames
op_assign
id|hw_avail
suffix:semicolon
r_else
id|frames
op_sub_assign
id|frames
op_mod
id|runtime-&gt;xfer_align
suffix:semicolon
id|appl_ptr
op_assign
id|runtime-&gt;control-&gt;appl_ptr
op_minus
id|frames
suffix:semicolon
r_if
c_cond
(paren
id|appl_ptr
OL
l_int|0
)paren
id|appl_ptr
op_add_assign
id|runtime-&gt;boundary
suffix:semicolon
id|runtime-&gt;control-&gt;appl_ptr
op_assign
id|appl_ptr
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_RUNNING
op_logical_and
id|runtime-&gt;sleep_min
)paren
id|snd_pcm_tick_prepare
c_func
(paren
id|substream
)paren
suffix:semicolon
id|ret
op_assign
id|frames
suffix:semicolon
id|__end
suffix:colon
id|spin_unlock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
DECL|function|snd_pcm_capture_rewind
id|snd_pcm_sframes_t
id|snd_pcm_capture_rewind
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_uframes_t
id|frames
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_pcm_sframes_t
id|appl_ptr
suffix:semicolon
id|snd_pcm_sframes_t
id|ret
suffix:semicolon
id|snd_pcm_sframes_t
id|hw_avail
suffix:semicolon
r_if
c_cond
(paren
id|frames
op_eq
l_int|0
)paren
r_return
l_int|0
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|runtime-&gt;status-&gt;state
)paren
(brace
r_case
id|SNDRV_PCM_STATE_PREPARED
suffix:colon
r_case
id|SNDRV_PCM_STATE_DRAINING
suffix:colon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_RUNNING
suffix:colon
r_if
c_cond
(paren
id|snd_pcm_update_hw_ptr
c_func
(paren
id|substream
)paren
op_ge
l_int|0
)paren
r_break
suffix:semicolon
multiline_comment|/* Fall through */
r_case
id|SNDRV_PCM_STATE_XRUN
suffix:colon
id|ret
op_assign
op_minus
id|EPIPE
suffix:semicolon
r_goto
id|__end
suffix:semicolon
r_default
suffix:colon
id|ret
op_assign
op_minus
id|EBADFD
suffix:semicolon
r_goto
id|__end
suffix:semicolon
)brace
id|hw_avail
op_assign
id|snd_pcm_capture_hw_avail
c_func
(paren
id|runtime
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hw_avail
op_le
l_int|0
)paren
(brace
id|ret
op_assign
l_int|0
suffix:semicolon
r_goto
id|__end
suffix:semicolon
)brace
r_if
c_cond
(paren
id|frames
OG
id|hw_avail
)paren
id|frames
op_assign
id|hw_avail
suffix:semicolon
r_else
id|frames
op_sub_assign
id|frames
op_mod
id|runtime-&gt;xfer_align
suffix:semicolon
id|appl_ptr
op_assign
id|runtime-&gt;control-&gt;appl_ptr
op_minus
id|frames
suffix:semicolon
r_if
c_cond
(paren
id|appl_ptr
OL
l_int|0
)paren
id|appl_ptr
op_add_assign
id|runtime-&gt;boundary
suffix:semicolon
id|runtime-&gt;control-&gt;appl_ptr
op_assign
id|appl_ptr
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_RUNNING
op_logical_and
id|runtime-&gt;sleep_min
)paren
id|snd_pcm_tick_prepare
c_func
(paren
id|substream
)paren
suffix:semicolon
id|ret
op_assign
id|frames
suffix:semicolon
id|__end
suffix:colon
id|spin_unlock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
DECL|function|snd_pcm_playback_delay
r_static
r_int
id|snd_pcm_playback_delay
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_sframes_t
op_star
id|res
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_int
id|err
op_assign
l_int|0
suffix:semicolon
id|snd_pcm_sframes_t
id|n
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|runtime-&gt;status-&gt;state
)paren
(brace
r_case
id|SNDRV_PCM_STATE_RUNNING
suffix:colon
r_case
id|SNDRV_PCM_STATE_DRAINING
suffix:colon
r_if
c_cond
(paren
id|snd_pcm_update_hw_ptr
c_func
(paren
id|substream
)paren
op_ge
l_int|0
)paren
(brace
id|n
op_assign
id|snd_pcm_playback_hw_avail
c_func
(paren
id|runtime
)paren
suffix:semicolon
r_if
c_cond
(paren
id|put_user
c_func
(paren
id|n
comma
id|res
)paren
)paren
id|err
op_assign
op_minus
id|EFAULT
suffix:semicolon
r_break
suffix:semicolon
)brace
r_else
(brace
id|err
op_assign
id|SNDRV_PCM_STATE_RUNNING
ques
c_cond
op_minus
id|EPIPE
suffix:colon
op_minus
id|EBADFD
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_SUSPENDED
suffix:colon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;suspended_state
op_eq
id|SNDRV_PCM_STATE_RUNNING
)paren
(brace
id|n
op_assign
id|snd_pcm_playback_hw_avail
c_func
(paren
id|runtime
)paren
suffix:semicolon
r_if
c_cond
(paren
id|put_user
c_func
(paren
id|n
comma
id|res
)paren
)paren
id|err
op_assign
op_minus
id|EFAULT
suffix:semicolon
)brace
r_else
(brace
id|err
op_assign
op_minus
id|EBADFD
suffix:semicolon
)brace
r_break
suffix:semicolon
r_default
suffix:colon
id|err
op_assign
op_minus
id|EBADFD
suffix:semicolon
r_break
suffix:semicolon
)brace
id|spin_unlock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|function|snd_pcm_capture_delay
r_static
r_int
id|snd_pcm_capture_delay
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_sframes_t
op_star
id|res
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_int
id|err
op_assign
l_int|0
suffix:semicolon
id|snd_pcm_sframes_t
id|n
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|runtime-&gt;status-&gt;state
)paren
(brace
r_case
id|SNDRV_PCM_STATE_RUNNING
suffix:colon
r_if
c_cond
(paren
id|snd_pcm_update_hw_ptr
c_func
(paren
id|substream
)paren
op_ge
l_int|0
)paren
(brace
id|n
op_assign
id|snd_pcm_capture_avail
c_func
(paren
id|runtime
)paren
suffix:semicolon
r_if
c_cond
(paren
id|put_user
c_func
(paren
id|n
comma
id|res
)paren
)paren
id|err
op_assign
op_minus
id|EFAULT
suffix:semicolon
r_break
suffix:semicolon
)brace
multiline_comment|/* Fall through */
r_case
id|SNDRV_PCM_STATE_XRUN
suffix:colon
id|err
op_assign
op_minus
id|EPIPE
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_SUSPENDED
suffix:colon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;suspended_state
op_eq
id|SNDRV_PCM_STATE_RUNNING
)paren
(brace
id|n
op_assign
id|snd_pcm_capture_avail
c_func
(paren
id|runtime
)paren
suffix:semicolon
r_if
c_cond
(paren
id|put_user
c_func
(paren
id|n
comma
id|res
)paren
)paren
id|err
op_assign
op_minus
id|EFAULT
suffix:semicolon
)brace
r_else
(brace
id|err
op_assign
op_minus
id|EBADFD
suffix:semicolon
)brace
r_break
suffix:semicolon
r_default
suffix:colon
id|err
op_assign
op_minus
id|EBADFD
suffix:semicolon
r_break
suffix:semicolon
)brace
id|spin_unlock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
r_static
r_int
id|snd_pcm_playback_ioctl1
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
r_int
id|cmd
comma
r_void
op_star
id|arg
)paren
suffix:semicolon
r_static
r_int
id|snd_pcm_capture_ioctl1
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
r_int
id|cmd
comma
r_void
op_star
id|arg
)paren
suffix:semicolon
DECL|function|snd_pcm_common_ioctl1
r_static
r_int
id|snd_pcm_common_ioctl1
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
r_int
id|cmd
comma
r_void
op_star
id|arg
)paren
(brace
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|SNDRV_PCM_IOCTL_PVERSION
suffix:colon
r_return
id|put_user
c_func
(paren
id|SNDRV_PCM_VERSION
comma
(paren
r_int
op_star
)paren
id|arg
)paren
ques
c_cond
op_minus
id|EFAULT
suffix:colon
l_int|0
suffix:semicolon
r_case
id|SNDRV_PCM_IOCTL_INFO
suffix:colon
r_return
id|snd_pcm_info_user
c_func
(paren
id|substream
comma
(paren
id|snd_pcm_info_t
op_star
)paren
id|arg
)paren
suffix:semicolon
r_case
id|SNDRV_PCM_IOCTL_HW_REFINE
suffix:colon
r_return
id|snd_pcm_hw_refine_user
c_func
(paren
id|substream
comma
(paren
id|snd_pcm_hw_params_t
op_star
)paren
id|arg
)paren
suffix:semicolon
r_case
id|SNDRV_PCM_IOCTL_HW_PARAMS
suffix:colon
r_return
id|snd_pcm_hw_params_user
c_func
(paren
id|substream
comma
(paren
id|snd_pcm_hw_params_t
op_star
)paren
id|arg
)paren
suffix:semicolon
r_case
id|SNDRV_PCM_IOCTL_HW_FREE
suffix:colon
r_return
id|snd_pcm_hw_free
c_func
(paren
id|substream
)paren
suffix:semicolon
r_case
id|SNDRV_PCM_IOCTL_SW_PARAMS
suffix:colon
r_return
id|snd_pcm_sw_params_user
c_func
(paren
id|substream
comma
(paren
id|snd_pcm_sw_params_t
op_star
)paren
id|arg
)paren
suffix:semicolon
r_case
id|SNDRV_PCM_IOCTL_STATUS
suffix:colon
r_return
id|snd_pcm_status_user
c_func
(paren
id|substream
comma
(paren
id|snd_pcm_status_t
op_star
)paren
id|arg
)paren
suffix:semicolon
r_case
id|SNDRV_PCM_IOCTL_CHANNEL_INFO
suffix:colon
r_return
id|snd_pcm_channel_info
c_func
(paren
id|substream
comma
(paren
id|snd_pcm_channel_info_t
op_star
)paren
id|arg
)paren
suffix:semicolon
r_case
id|SNDRV_PCM_IOCTL_PREPARE
suffix:colon
(brace
r_int
id|res
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|substream-&gt;runtime-&gt;lock
)paren
suffix:semicolon
id|res
op_assign
id|snd_pcm_prepare
c_func
(paren
id|substream
)paren
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|substream-&gt;runtime-&gt;lock
)paren
suffix:semicolon
r_return
id|res
suffix:semicolon
)brace
r_case
id|SNDRV_PCM_IOCTL_RESET
suffix:colon
(brace
r_int
id|res
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|substream-&gt;runtime-&gt;lock
)paren
suffix:semicolon
id|res
op_assign
id|snd_pcm_reset
c_func
(paren
id|substream
)paren
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|substream-&gt;runtime-&gt;lock
)paren
suffix:semicolon
r_return
id|res
suffix:semicolon
)brace
r_case
id|SNDRV_PCM_IOCTL_START
suffix:colon
(brace
r_int
id|res
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|substream-&gt;runtime-&gt;lock
)paren
suffix:semicolon
id|res
op_assign
id|snd_pcm_start
c_func
(paren
id|substream
)paren
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|substream-&gt;runtime-&gt;lock
)paren
suffix:semicolon
r_return
id|res
suffix:semicolon
)brace
r_case
id|SNDRV_PCM_IOCTL_LINK
suffix:colon
r_return
id|snd_pcm_link
c_func
(paren
id|substream
comma
(paren
r_int
)paren
id|arg
)paren
suffix:semicolon
r_case
id|SNDRV_PCM_IOCTL_UNLINK
suffix:colon
r_return
id|snd_pcm_unlink
c_func
(paren
id|substream
)paren
suffix:semicolon
r_case
id|SNDRV_PCM_IOCTL_RESUME
suffix:colon
r_return
id|snd_pcm_resume
c_func
(paren
id|substream
)paren
suffix:semicolon
r_case
id|SNDRV_PCM_IOCTL_XRUN
suffix:colon
r_return
id|snd_pcm_xrun
c_func
(paren
id|substream
)paren
suffix:semicolon
)brace
id|snd_printd
c_func
(paren
l_string|&quot;unknown ioctl = 0x%x&bslash;n&quot;
comma
id|cmd
)paren
suffix:semicolon
r_return
op_minus
id|ENOTTY
suffix:semicolon
)brace
DECL|function|snd_pcm_playback_ioctl1
r_static
r_int
id|snd_pcm_playback_ioctl1
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
r_int
id|cmd
comma
r_void
op_star
id|arg
)paren
(brace
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_PLAYBACK
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|SNDRV_PCM_IOCTL_WRITEI_FRAMES
suffix:colon
(brace
id|snd_xferi_t
id|xferi
comma
op_star
id|_xferi
op_assign
id|arg
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_pcm_sframes_t
id|result
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_OPEN
)paren
r_return
op_minus
id|EBADFD
suffix:semicolon
r_if
c_cond
(paren
id|put_user
c_func
(paren
l_int|0
comma
op_amp
id|_xferi-&gt;result
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|xferi
comma
id|_xferi
comma
r_sizeof
(paren
id|xferi
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|result
op_assign
id|snd_pcm_lib_write
c_func
(paren
id|substream
comma
id|xferi.buf
comma
id|xferi.frames
)paren
suffix:semicolon
id|__put_user
c_func
(paren
id|result
comma
op_amp
id|_xferi-&gt;result
)paren
suffix:semicolon
r_return
id|result
OL
l_int|0
ques
c_cond
id|result
suffix:colon
l_int|0
suffix:semicolon
)brace
r_case
id|SNDRV_PCM_IOCTL_WRITEN_FRAMES
suffix:colon
(brace
id|snd_xfern_t
id|xfern
comma
op_star
id|_xfern
op_assign
id|arg
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_void
op_star
id|bufs
(braket
l_int|128
)braket
suffix:semicolon
id|snd_pcm_sframes_t
id|result
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_OPEN
)paren
r_return
op_minus
id|EBADFD
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;channels
OG
l_int|128
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|put_user
c_func
(paren
l_int|0
comma
op_amp
id|_xfern-&gt;result
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|xfern
comma
id|_xfern
comma
r_sizeof
(paren
id|xfern
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
id|bufs
comma
id|xfern.bufs
comma
r_sizeof
(paren
op_star
id|bufs
)paren
op_star
id|runtime-&gt;channels
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|result
op_assign
id|snd_pcm_lib_writev
c_func
(paren
id|substream
comma
id|bufs
comma
id|xfern.frames
)paren
suffix:semicolon
id|__put_user
c_func
(paren
id|result
comma
op_amp
id|_xfern-&gt;result
)paren
suffix:semicolon
r_return
id|result
OL
l_int|0
ques
c_cond
id|result
suffix:colon
l_int|0
suffix:semicolon
)brace
r_case
id|SNDRV_PCM_IOCTL_REWIND
suffix:colon
(brace
id|snd_pcm_uframes_t
id|frames
comma
op_star
id|_frames
op_assign
id|arg
suffix:semicolon
id|snd_pcm_sframes_t
id|result
suffix:semicolon
r_if
c_cond
(paren
id|get_user
c_func
(paren
id|frames
comma
id|_frames
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
id|put_user
c_func
(paren
l_int|0
comma
id|_frames
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|result
op_assign
id|snd_pcm_playback_rewind
c_func
(paren
id|substream
comma
id|frames
)paren
suffix:semicolon
id|__put_user
c_func
(paren
id|result
comma
id|_frames
)paren
suffix:semicolon
r_return
id|result
OL
l_int|0
ques
c_cond
id|result
suffix:colon
l_int|0
suffix:semicolon
)brace
r_case
id|SNDRV_PCM_IOCTL_PAUSE
suffix:colon
(brace
r_int
id|res
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|substream-&gt;runtime-&gt;lock
)paren
suffix:semicolon
id|res
op_assign
id|snd_pcm_pause
c_func
(paren
id|substream
comma
(paren
r_int
)paren
id|arg
)paren
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|substream-&gt;runtime-&gt;lock
)paren
suffix:semicolon
r_return
id|res
suffix:semicolon
)brace
r_case
id|SNDRV_PCM_IOCTL_DRAIN
suffix:colon
r_return
id|snd_pcm_playback_drain
c_func
(paren
id|substream
)paren
suffix:semicolon
r_case
id|SNDRV_PCM_IOCTL_DROP
suffix:colon
r_return
id|snd_pcm_playback_drop
c_func
(paren
id|substream
)paren
suffix:semicolon
r_case
id|SNDRV_PCM_IOCTL_DELAY
suffix:colon
r_return
id|snd_pcm_playback_delay
c_func
(paren
id|substream
comma
(paren
id|snd_pcm_sframes_t
op_star
)paren
id|arg
)paren
suffix:semicolon
)brace
r_return
id|snd_pcm_common_ioctl1
c_func
(paren
id|substream
comma
id|cmd
comma
id|arg
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_capture_ioctl1
r_static
r_int
id|snd_pcm_capture_ioctl1
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
r_int
id|cmd
comma
r_void
op_star
id|arg
)paren
(brace
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_CAPTURE
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|SNDRV_PCM_IOCTL_READI_FRAMES
suffix:colon
(brace
id|snd_xferi_t
id|xferi
comma
op_star
id|_xferi
op_assign
id|arg
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_pcm_sframes_t
id|result
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_OPEN
)paren
r_return
op_minus
id|EBADFD
suffix:semicolon
r_if
c_cond
(paren
id|put_user
c_func
(paren
l_int|0
comma
op_amp
id|_xferi-&gt;result
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|xferi
comma
id|_xferi
comma
r_sizeof
(paren
id|xferi
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|result
op_assign
id|snd_pcm_lib_read
c_func
(paren
id|substream
comma
id|xferi.buf
comma
id|xferi.frames
)paren
suffix:semicolon
id|__put_user
c_func
(paren
id|result
comma
op_amp
id|_xferi-&gt;result
)paren
suffix:semicolon
r_return
id|result
OL
l_int|0
ques
c_cond
id|result
suffix:colon
l_int|0
suffix:semicolon
)brace
r_case
id|SNDRV_PCM_IOCTL_READN_FRAMES
suffix:colon
(brace
id|snd_xfern_t
id|xfern
comma
op_star
id|_xfern
op_assign
id|arg
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_void
op_star
id|bufs
(braket
l_int|128
)braket
suffix:semicolon
id|snd_pcm_sframes_t
id|result
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_OPEN
)paren
r_return
op_minus
id|EBADFD
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;channels
OG
l_int|128
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|put_user
c_func
(paren
l_int|0
comma
op_amp
id|_xfern-&gt;result
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|xfern
comma
id|_xfern
comma
r_sizeof
(paren
id|xfern
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
id|bufs
comma
id|xfern.bufs
comma
r_sizeof
(paren
op_star
id|bufs
)paren
op_star
id|runtime-&gt;channels
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|result
op_assign
id|snd_pcm_lib_readv
c_func
(paren
id|substream
comma
id|bufs
comma
id|xfern.frames
)paren
suffix:semicolon
id|__put_user
c_func
(paren
id|result
comma
op_amp
id|_xfern-&gt;result
)paren
suffix:semicolon
r_return
id|result
OL
l_int|0
ques
c_cond
id|result
suffix:colon
l_int|0
suffix:semicolon
)brace
r_case
id|SNDRV_PCM_IOCTL_REWIND
suffix:colon
(brace
id|snd_pcm_uframes_t
id|frames
comma
op_star
id|_frames
op_assign
id|arg
suffix:semicolon
id|snd_pcm_sframes_t
id|result
suffix:semicolon
r_if
c_cond
(paren
id|get_user
c_func
(paren
id|frames
comma
id|_frames
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
id|put_user
c_func
(paren
l_int|0
comma
id|_frames
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|result
op_assign
id|snd_pcm_capture_rewind
c_func
(paren
id|substream
comma
id|frames
)paren
suffix:semicolon
id|__put_user
c_func
(paren
id|result
comma
id|_frames
)paren
suffix:semicolon
r_return
id|result
OL
l_int|0
ques
c_cond
id|result
suffix:colon
l_int|0
suffix:semicolon
)brace
r_case
id|SNDRV_PCM_IOCTL_DRAIN
suffix:colon
r_return
id|snd_pcm_capture_drain
c_func
(paren
id|substream
)paren
suffix:semicolon
r_case
id|SNDRV_PCM_IOCTL_DROP
suffix:colon
r_return
id|snd_pcm_capture_drop
c_func
(paren
id|substream
)paren
suffix:semicolon
r_case
id|SNDRV_PCM_IOCTL_DELAY
suffix:colon
r_return
id|snd_pcm_capture_delay
c_func
(paren
id|substream
comma
(paren
id|snd_pcm_sframes_t
op_star
)paren
id|arg
)paren
suffix:semicolon
)brace
r_return
id|snd_pcm_common_ioctl1
c_func
(paren
id|substream
comma
id|cmd
comma
id|arg
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_playback_ioctl
r_static
r_int
id|snd_pcm_playback_ioctl
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
comma
r_int
r_int
id|cmd
comma
r_int
r_int
id|arg
)paren
(brace
id|snd_pcm_file_t
op_star
id|pcm_file
suffix:semicolon
id|pcm_file
op_assign
id|snd_magic_cast
c_func
(paren
id|snd_pcm_file_t
comma
id|file-&gt;private_data
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
(paren
id|cmd
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
)paren
op_ne
l_char|&squot;A&squot;
)paren
r_return
op_minus
id|ENOTTY
suffix:semicolon
r_return
id|snd_pcm_playback_ioctl1
c_func
(paren
id|pcm_file-&gt;substream
comma
id|cmd
comma
(paren
r_void
op_star
)paren
id|arg
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_capture_ioctl
r_static
r_int
id|snd_pcm_capture_ioctl
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
comma
r_int
r_int
id|cmd
comma
r_int
r_int
id|arg
)paren
(brace
id|snd_pcm_file_t
op_star
id|pcm_file
suffix:semicolon
id|pcm_file
op_assign
id|snd_magic_cast
c_func
(paren
id|snd_pcm_file_t
comma
id|file-&gt;private_data
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
(paren
id|cmd
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
)paren
op_ne
l_char|&squot;A&squot;
)paren
r_return
op_minus
id|ENOTTY
suffix:semicolon
r_return
id|snd_pcm_capture_ioctl1
c_func
(paren
id|pcm_file-&gt;substream
comma
id|cmd
comma
(paren
r_void
op_star
)paren
id|arg
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_kernel_playback_ioctl
r_int
id|snd_pcm_kernel_playback_ioctl
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
r_int
id|cmd
comma
r_void
op_star
id|arg
)paren
(brace
id|mm_segment_t
id|fs
suffix:semicolon
r_int
id|result
suffix:semicolon
id|fs
op_assign
id|snd_enter_user
c_func
(paren
)paren
suffix:semicolon
id|result
op_assign
id|snd_pcm_playback_ioctl1
c_func
(paren
id|substream
comma
id|cmd
comma
id|arg
)paren
suffix:semicolon
id|snd_leave_user
c_func
(paren
id|fs
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
DECL|function|snd_pcm_kernel_capture_ioctl
r_int
id|snd_pcm_kernel_capture_ioctl
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
r_int
id|cmd
comma
r_void
op_star
id|arg
)paren
(brace
id|mm_segment_t
id|fs
suffix:semicolon
r_int
id|result
suffix:semicolon
id|fs
op_assign
id|snd_enter_user
c_func
(paren
)paren
suffix:semicolon
id|result
op_assign
id|snd_pcm_capture_ioctl1
c_func
(paren
id|substream
comma
id|cmd
comma
id|arg
)paren
suffix:semicolon
id|snd_leave_user
c_func
(paren
id|fs
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
DECL|function|snd_pcm_kernel_ioctl
r_int
id|snd_pcm_kernel_ioctl
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
r_int
id|cmd
comma
r_void
op_star
id|arg
)paren
(brace
r_switch
c_cond
(paren
id|substream-&gt;stream
)paren
(brace
r_case
id|SNDRV_PCM_STREAM_PLAYBACK
suffix:colon
r_return
id|snd_pcm_kernel_playback_ioctl
c_func
(paren
id|substream
comma
id|cmd
comma
id|arg
)paren
suffix:semicolon
r_case
id|SNDRV_PCM_STREAM_CAPTURE
suffix:colon
r_return
id|snd_pcm_kernel_capture_ioctl
c_func
(paren
id|substream
comma
id|cmd
comma
id|arg
)paren
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
)brace
DECL|function|snd_pcm_read
r_static
id|ssize_t
id|snd_pcm_read
c_func
(paren
r_struct
id|file
op_star
id|file
comma
r_char
op_star
id|buf
comma
r_int
id|count
comma
id|loff_t
op_star
id|offset
)paren
(brace
id|snd_pcm_file_t
op_star
id|pcm_file
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
id|snd_pcm_sframes_t
id|result
suffix:semicolon
id|pcm_file
op_assign
id|snd_magic_cast
c_func
(paren
id|snd_pcm_file_t
comma
id|file-&gt;private_data
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|substream
op_assign
id|pcm_file-&gt;substream
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_OPEN
)paren
r_return
op_minus
id|EBADFD
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|frame_aligned
c_func
(paren
id|runtime
comma
id|count
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|count
op_assign
id|bytes_to_frames
c_func
(paren
id|runtime
comma
id|count
)paren
suffix:semicolon
id|result
op_assign
id|snd_pcm_lib_read
c_func
(paren
id|substream
comma
id|buf
comma
id|count
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
OG
l_int|0
)paren
id|result
op_assign
id|frames_to_bytes
c_func
(paren
id|runtime
comma
id|result
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
DECL|function|snd_pcm_write
r_static
id|ssize_t
id|snd_pcm_write
c_func
(paren
r_struct
id|file
op_star
id|file
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
comma
id|loff_t
op_star
id|offset
)paren
(brace
id|snd_pcm_file_t
op_star
id|pcm_file
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
id|snd_pcm_sframes_t
id|result
suffix:semicolon
id|up
c_func
(paren
op_amp
id|file-&gt;f_dentry-&gt;d_inode-&gt;i_sem
)paren
suffix:semicolon
id|pcm_file
op_assign
id|snd_magic_cast
c_func
(paren
id|snd_pcm_file_t
comma
id|file-&gt;private_data
comma
id|result
op_assign
op_minus
id|ENXIO
suffix:semicolon
r_goto
id|end
)paren
suffix:semicolon
id|substream
op_assign
id|pcm_file-&gt;substream
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
id|result
op_assign
op_minus
id|ENXIO
suffix:semicolon
r_goto
id|end
)paren
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_OPEN
)paren
(brace
id|result
op_assign
op_minus
id|EBADFD
suffix:semicolon
r_goto
id|end
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|frame_aligned
c_func
(paren
id|runtime
comma
id|count
)paren
)paren
(brace
id|result
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_goto
id|end
suffix:semicolon
)brace
id|count
op_assign
id|bytes_to_frames
c_func
(paren
id|runtime
comma
id|count
)paren
suffix:semicolon
id|result
op_assign
id|snd_pcm_lib_write
c_func
(paren
id|substream
comma
id|buf
comma
id|count
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
OG
l_int|0
)paren
id|result
op_assign
id|frames_to_bytes
c_func
(paren
id|runtime
comma
id|result
)paren
suffix:semicolon
id|end
suffix:colon
id|down
c_func
(paren
op_amp
id|file-&gt;f_dentry-&gt;d_inode-&gt;i_sem
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
macro_line|#if LINUX_VERSION_CODE &gt;= KERNEL_VERSION(2, 3, 44)
DECL|function|snd_pcm_readv
r_static
id|ssize_t
id|snd_pcm_readv
c_func
(paren
r_struct
id|file
op_star
id|file
comma
r_const
r_struct
id|iovec
op_star
id|_vector
comma
r_int
r_int
id|count
comma
id|loff_t
op_star
id|offset
)paren
(brace
id|snd_pcm_file_t
op_star
id|pcm_file
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
id|snd_pcm_sframes_t
id|result
suffix:semicolon
r_int
r_int
id|i
suffix:semicolon
r_void
op_star
id|bufs
(braket
l_int|128
)braket
suffix:semicolon
id|snd_pcm_uframes_t
id|frames
suffix:semicolon
id|pcm_file
op_assign
id|snd_magic_cast
c_func
(paren
id|snd_pcm_file_t
comma
id|file-&gt;private_data
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|substream
op_assign
id|pcm_file-&gt;substream
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_OPEN
)paren
r_return
op_minus
id|EBADFD
suffix:semicolon
r_if
c_cond
(paren
id|count
OG
l_int|128
op_logical_or
id|count
op_ne
id|runtime-&gt;channels
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|frame_aligned
c_func
(paren
id|runtime
comma
id|_vector-&gt;iov_len
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|frames
op_assign
id|bytes_to_samples
c_func
(paren
id|runtime
comma
id|_vector-&gt;iov_len
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|count
suffix:semicolon
op_increment
id|i
)paren
id|bufs
(braket
id|i
)braket
op_assign
id|_vector
(braket
id|i
)braket
dot
id|iov_base
suffix:semicolon
id|result
op_assign
id|snd_pcm_lib_readv
c_func
(paren
id|substream
comma
id|bufs
comma
id|frames
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
OG
l_int|0
)paren
id|result
op_assign
id|frames_to_bytes
c_func
(paren
id|runtime
comma
id|result
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
DECL|function|snd_pcm_writev
r_static
id|ssize_t
id|snd_pcm_writev
c_func
(paren
r_struct
id|file
op_star
id|file
comma
r_const
r_struct
id|iovec
op_star
id|_vector
comma
r_int
r_int
id|count
comma
id|loff_t
op_star
id|offset
)paren
(brace
id|snd_pcm_file_t
op_star
id|pcm_file
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
id|snd_pcm_sframes_t
id|result
suffix:semicolon
r_int
r_int
id|i
suffix:semicolon
r_void
op_star
id|bufs
(braket
l_int|128
)braket
suffix:semicolon
id|snd_pcm_uframes_t
id|frames
suffix:semicolon
id|up
c_func
(paren
op_amp
id|file-&gt;f_dentry-&gt;d_inode-&gt;i_sem
)paren
suffix:semicolon
id|pcm_file
op_assign
id|snd_magic_cast
c_func
(paren
id|snd_pcm_file_t
comma
id|file-&gt;private_data
comma
id|result
op_assign
op_minus
id|ENXIO
suffix:semicolon
r_goto
id|end
)paren
suffix:semicolon
id|substream
op_assign
id|pcm_file-&gt;substream
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
id|result
op_assign
op_minus
id|ENXIO
suffix:semicolon
r_goto
id|end
)paren
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_OPEN
)paren
(brace
id|result
op_assign
op_minus
id|EBADFD
suffix:semicolon
r_goto
id|end
suffix:semicolon
)brace
r_if
c_cond
(paren
id|count
OG
l_int|128
op_logical_or
id|count
op_ne
id|runtime-&gt;channels
op_logical_or
op_logical_neg
id|frame_aligned
c_func
(paren
id|runtime
comma
id|_vector-&gt;iov_len
)paren
)paren
(brace
id|result
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_goto
id|end
suffix:semicolon
)brace
id|frames
op_assign
id|bytes_to_samples
c_func
(paren
id|runtime
comma
id|_vector-&gt;iov_len
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|count
suffix:semicolon
op_increment
id|i
)paren
id|bufs
(braket
id|i
)braket
op_assign
id|_vector
(braket
id|i
)braket
dot
id|iov_base
suffix:semicolon
id|result
op_assign
id|snd_pcm_lib_writev
c_func
(paren
id|substream
comma
id|bufs
comma
id|frames
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
OG
l_int|0
)paren
id|result
op_assign
id|frames_to_bytes
c_func
(paren
id|runtime
comma
id|result
)paren
suffix:semicolon
id|end
suffix:colon
id|down
c_func
(paren
op_amp
id|file-&gt;f_dentry-&gt;d_inode-&gt;i_sem
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
macro_line|#endif
DECL|function|snd_pcm_playback_poll
r_int
r_int
id|snd_pcm_playback_poll
c_func
(paren
r_struct
id|file
op_star
id|file
comma
id|poll_table
op_star
id|wait
)paren
(brace
id|snd_pcm_file_t
op_star
id|pcm_file
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_int
r_int
id|mask
suffix:semicolon
id|snd_pcm_uframes_t
id|avail
suffix:semicolon
id|pcm_file
op_assign
id|snd_magic_cast
c_func
(paren
id|snd_pcm_file_t
comma
id|file-&gt;private_data
comma
r_return
l_int|0
)paren
suffix:semicolon
id|substream
op_assign
id|pcm_file-&gt;substream
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|poll_wait
c_func
(paren
id|file
comma
op_amp
id|runtime-&gt;sleep
comma
id|wait
)paren
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
id|avail
op_assign
id|snd_pcm_playback_avail
c_func
(paren
id|runtime
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|runtime-&gt;status-&gt;state
)paren
(brace
r_case
id|SNDRV_PCM_STATE_RUNNING
suffix:colon
r_if
c_cond
(paren
id|avail
op_ge
id|runtime-&gt;control-&gt;avail_min
)paren
(brace
id|mask
op_assign
id|POLLOUT
op_or
id|POLLWRNORM
suffix:semicolon
r_break
suffix:semicolon
)brace
multiline_comment|/* Fall through */
r_case
id|SNDRV_PCM_STATE_DRAINING
suffix:colon
id|mask
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_PREPARED
suffix:colon
r_if
c_cond
(paren
id|avail
OG
l_int|0
)paren
(brace
id|mask
op_assign
id|POLLOUT
op_or
id|POLLWRNORM
suffix:semicolon
r_break
suffix:semicolon
)brace
multiline_comment|/* Fall through */
r_default
suffix:colon
id|mask
op_assign
id|POLLOUT
op_or
id|POLLWRNORM
op_or
id|POLLERR
suffix:semicolon
r_break
suffix:semicolon
)brace
id|spin_unlock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
r_return
id|mask
suffix:semicolon
)brace
DECL|function|snd_pcm_capture_poll
r_int
r_int
id|snd_pcm_capture_poll
c_func
(paren
r_struct
id|file
op_star
id|file
comma
id|poll_table
op_star
id|wait
)paren
(brace
id|snd_pcm_file_t
op_star
id|pcm_file
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_int
r_int
id|mask
suffix:semicolon
id|snd_pcm_uframes_t
id|avail
suffix:semicolon
id|pcm_file
op_assign
id|snd_magic_cast
c_func
(paren
id|snd_pcm_file_t
comma
id|file-&gt;private_data
comma
r_return
l_int|0
)paren
suffix:semicolon
id|substream
op_assign
id|pcm_file-&gt;substream
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|poll_wait
c_func
(paren
id|file
comma
op_amp
id|runtime-&gt;sleep
comma
id|wait
)paren
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
id|avail
op_assign
id|snd_pcm_capture_avail
c_func
(paren
id|runtime
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|runtime-&gt;status-&gt;state
)paren
(brace
r_case
id|SNDRV_PCM_STATE_RUNNING
suffix:colon
r_if
c_cond
(paren
id|avail
op_ge
id|runtime-&gt;control-&gt;avail_min
)paren
(brace
id|mask
op_assign
id|POLLIN
op_or
id|POLLRDNORM
suffix:semicolon
r_break
suffix:semicolon
)brace
id|mask
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_DRAINING
suffix:colon
r_if
c_cond
(paren
id|avail
OG
l_int|0
)paren
(brace
id|mask
op_assign
id|POLLIN
op_or
id|POLLRDNORM
suffix:semicolon
r_break
suffix:semicolon
)brace
multiline_comment|/* Fall through */
r_default
suffix:colon
id|mask
op_assign
id|POLLIN
op_or
id|POLLRDNORM
op_or
id|POLLERR
suffix:semicolon
r_break
suffix:semicolon
)brace
id|spin_unlock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
r_return
id|mask
suffix:semicolon
)brace
macro_line|#ifndef VM_RESERVED
macro_line|#ifndef LINUX_2_2
DECL|function|snd_pcm_mmap_swapout
r_static
r_int
id|snd_pcm_mmap_swapout
c_func
(paren
r_struct
id|page
op_star
id|page
comma
r_struct
id|file
op_star
id|file
)paren
macro_line|#else
r_static
r_int
id|snd_pcm_mmap_swapout
c_func
(paren
r_struct
id|vm_area_struct
op_star
id|area
comma
r_struct
id|page
op_star
id|page
)paren
macro_line|#endif
(brace
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#endif
macro_line|#ifndef LINUX_2_2
DECL|function|snd_pcm_mmap_status_nopage
r_static
r_struct
id|page
op_star
id|snd_pcm_mmap_status_nopage
c_func
(paren
r_struct
id|vm_area_struct
op_star
id|area
comma
r_int
r_int
id|address
comma
r_int
id|no_share
)paren
macro_line|#else
r_static
r_int
r_int
id|snd_pcm_mmap_status_nopage
c_func
(paren
r_struct
id|vm_area_struct
op_star
id|area
comma
r_int
r_int
id|address
comma
r_int
id|no_share
)paren
macro_line|#endif
(brace
id|snd_pcm_substream_t
op_star
id|substream
op_assign
(paren
id|snd_pcm_substream_t
op_star
)paren
id|area-&gt;vm_private_data
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_struct
id|page
op_star
id|page
suffix:semicolon
r_if
c_cond
(paren
id|substream
op_eq
l_int|NULL
)paren
r_return
id|NOPAGE_OOM
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|page
op_assign
id|virt_to_page
c_func
(paren
id|runtime-&gt;status
)paren
suffix:semicolon
id|get_page
c_func
(paren
id|page
)paren
suffix:semicolon
macro_line|#ifndef LINUX_2_2
r_return
id|page
suffix:semicolon
macro_line|#else
r_return
id|page_address
c_func
(paren
id|page
)paren
suffix:semicolon
macro_line|#endif
)brace
DECL|variable|snd_pcm_vm_ops_status
r_static
r_struct
id|vm_operations_struct
id|snd_pcm_vm_ops_status
op_assign
(brace
id|nopage
suffix:colon
id|snd_pcm_mmap_status_nopage
comma
macro_line|#ifndef VM_RESERVED
id|swapout
suffix:colon
id|snd_pcm_mmap_swapout
comma
macro_line|#endif
)brace
suffix:semicolon
DECL|function|snd_pcm_mmap_status
r_int
id|snd_pcm_mmap_status
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_struct
id|file
op_star
id|file
comma
r_struct
id|vm_area_struct
op_star
id|area
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_int
id|size
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|area-&gt;vm_flags
op_amp
id|VM_READ
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_assert
c_func
(paren
id|runtime
op_ne
l_int|NULL
comma
r_return
op_minus
id|EAGAIN
)paren
suffix:semicolon
id|size
op_assign
id|area-&gt;vm_end
op_minus
id|area-&gt;vm_start
suffix:semicolon
r_if
c_cond
(paren
id|size
op_ne
id|PAGE_ALIGN
c_func
(paren
r_sizeof
(paren
id|snd_pcm_mmap_status_t
)paren
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|area-&gt;vm_ops
op_assign
op_amp
id|snd_pcm_vm_ops_status
suffix:semicolon
macro_line|#ifndef LINUX_2_2
id|area-&gt;vm_private_data
op_assign
id|substream
suffix:semicolon
macro_line|#else
id|area-&gt;vm_private_data
op_assign
(paren
r_int
)paren
id|substream
suffix:semicolon
macro_line|#endif
macro_line|#ifdef VM_RESERVED
id|area-&gt;vm_flags
op_or_assign
id|VM_RESERVED
suffix:semicolon
macro_line|#endif
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#ifndef LINUX_2_2
DECL|function|snd_pcm_mmap_control_nopage
r_static
r_struct
id|page
op_star
id|snd_pcm_mmap_control_nopage
c_func
(paren
r_struct
id|vm_area_struct
op_star
id|area
comma
r_int
r_int
id|address
comma
r_int
id|no_share
)paren
macro_line|#else
r_static
r_int
r_int
id|snd_pcm_mmap_control_nopage
c_func
(paren
r_struct
id|vm_area_struct
op_star
id|area
comma
r_int
r_int
id|address
comma
r_int
id|no_share
)paren
macro_line|#endif
(brace
id|snd_pcm_substream_t
op_star
id|substream
op_assign
(paren
id|snd_pcm_substream_t
op_star
)paren
id|area-&gt;vm_private_data
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_struct
id|page
op_star
id|page
suffix:semicolon
r_if
c_cond
(paren
id|substream
op_eq
l_int|NULL
)paren
r_return
id|NOPAGE_OOM
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|page
op_assign
id|virt_to_page
c_func
(paren
id|runtime-&gt;control
)paren
suffix:semicolon
id|get_page
c_func
(paren
id|page
)paren
suffix:semicolon
macro_line|#ifndef LINUX_2_2
r_return
id|page
suffix:semicolon
macro_line|#else
r_return
id|page_address
c_func
(paren
id|page
)paren
suffix:semicolon
macro_line|#endif
)brace
DECL|variable|snd_pcm_vm_ops_control
r_static
r_struct
id|vm_operations_struct
id|snd_pcm_vm_ops_control
op_assign
(brace
id|nopage
suffix:colon
id|snd_pcm_mmap_control_nopage
comma
macro_line|#ifndef VM_RESERVED
id|swapout
suffix:colon
id|snd_pcm_mmap_swapout
comma
macro_line|#endif
)brace
suffix:semicolon
DECL|function|snd_pcm_mmap_control
r_static
r_int
id|snd_pcm_mmap_control
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_struct
id|file
op_star
id|file
comma
r_struct
id|vm_area_struct
op_star
id|area
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_int
id|size
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|area-&gt;vm_flags
op_amp
id|VM_READ
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_assert
c_func
(paren
id|runtime
op_ne
l_int|NULL
comma
r_return
op_minus
id|EAGAIN
)paren
suffix:semicolon
id|size
op_assign
id|area-&gt;vm_end
op_minus
id|area-&gt;vm_start
suffix:semicolon
r_if
c_cond
(paren
id|size
op_ne
id|PAGE_ALIGN
c_func
(paren
r_sizeof
(paren
id|snd_pcm_mmap_control_t
)paren
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|area-&gt;vm_ops
op_assign
op_amp
id|snd_pcm_vm_ops_control
suffix:semicolon
macro_line|#ifndef LINUX_2_2
id|area-&gt;vm_private_data
op_assign
id|substream
suffix:semicolon
macro_line|#else
id|area-&gt;vm_private_data
op_assign
(paren
r_int
)paren
id|substream
suffix:semicolon
macro_line|#endif
macro_line|#ifdef VM_RESERVED
id|area-&gt;vm_flags
op_or_assign
id|VM_RESERVED
suffix:semicolon
macro_line|#endif
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_mmap_data_open
r_static
r_void
id|snd_pcm_mmap_data_open
c_func
(paren
r_struct
id|vm_area_struct
op_star
id|area
)paren
(brace
macro_line|#if 0
id|snd_pcm_substream_t
op_star
id|substream
op_assign
(paren
id|snd_pcm_substream_t
op_star
)paren
id|area-&gt;vm_private_data
suffix:semicolon
id|atomic_inc
c_func
(paren
op_amp
id|substream-&gt;runtime-&gt;mmap_count
)paren
suffix:semicolon
macro_line|#endif
)brace
DECL|function|snd_pcm_mmap_data_close
r_static
r_void
id|snd_pcm_mmap_data_close
c_func
(paren
r_struct
id|vm_area_struct
op_star
id|area
)paren
(brace
id|snd_pcm_substream_t
op_star
id|substream
op_assign
(paren
id|snd_pcm_substream_t
op_star
)paren
id|area-&gt;vm_private_data
suffix:semicolon
id|atomic_dec
c_func
(paren
op_amp
id|substream-&gt;runtime-&gt;mmap_count
)paren
suffix:semicolon
)brace
macro_line|#ifndef LINUX_2_2
DECL|function|snd_pcm_mmap_data_nopage
r_static
r_struct
id|page
op_star
id|snd_pcm_mmap_data_nopage
c_func
(paren
r_struct
id|vm_area_struct
op_star
id|area
comma
r_int
r_int
id|address
comma
r_int
id|no_share
)paren
macro_line|#else
r_static
r_int
r_int
id|snd_pcm_mmap_data_nopage
c_func
(paren
r_struct
id|vm_area_struct
op_star
id|area
comma
r_int
r_int
id|address
comma
r_int
id|no_share
)paren
macro_line|#endif
(brace
id|snd_pcm_substream_t
op_star
id|substream
op_assign
(paren
id|snd_pcm_substream_t
op_star
)paren
id|area-&gt;vm_private_data
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_int
r_int
id|offset
suffix:semicolon
r_struct
id|page
op_star
id|page
suffix:semicolon
r_int
id|dma_bytes
suffix:semicolon
r_if
c_cond
(paren
id|substream
op_eq
l_int|NULL
)paren
r_return
id|NOPAGE_OOM
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
macro_line|#if LINUX_VERSION_CODE &gt;= KERNEL_VERSION(2, 3, 25)
id|offset
op_assign
id|area-&gt;vm_pgoff
op_lshift
id|PAGE_SHIFT
suffix:semicolon
macro_line|#else
id|offset
op_assign
id|area-&gt;vm_offset
suffix:semicolon
macro_line|#endif
id|offset
op_add_assign
id|address
op_minus
id|area-&gt;vm_start
suffix:semicolon
id|snd_assert
c_func
(paren
(paren
id|offset
op_mod
id|PAGE_SIZE
)paren
op_eq
l_int|0
comma
r_return
id|NOPAGE_OOM
)paren
suffix:semicolon
id|dma_bytes
op_assign
id|PAGE_ALIGN
c_func
(paren
id|runtime-&gt;dma_bytes
)paren
suffix:semicolon
r_if
c_cond
(paren
id|offset
OG
id|dma_bytes
op_minus
id|PAGE_SIZE
)paren
r_return
id|NOPAGE_SIGBUS
suffix:semicolon
id|page
op_assign
id|virt_to_page
c_func
(paren
id|runtime-&gt;dma_area
op_plus
id|offset
)paren
suffix:semicolon
id|get_page
c_func
(paren
id|page
)paren
suffix:semicolon
macro_line|#ifndef LINUX_2_2
r_return
id|page
suffix:semicolon
macro_line|#else
r_return
id|page_address
c_func
(paren
id|page
)paren
suffix:semicolon
macro_line|#endif
)brace
DECL|variable|snd_pcm_vm_ops_data
r_static
r_struct
id|vm_operations_struct
id|snd_pcm_vm_ops_data
op_assign
(brace
id|open
suffix:colon
id|snd_pcm_mmap_data_open
comma
id|close
suffix:colon
id|snd_pcm_mmap_data_close
comma
id|nopage
suffix:colon
id|snd_pcm_mmap_data_nopage
comma
macro_line|#ifndef VM_RESERVED
id|swapout
suffix:colon
id|snd_pcm_mmap_swapout
comma
macro_line|#endif
)brace
suffix:semicolon
DECL|function|snd_pcm_mmap_data
r_int
id|snd_pcm_mmap_data
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_struct
id|file
op_star
id|file
comma
r_struct
id|vm_area_struct
op_star
id|area
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_int
id|size
suffix:semicolon
r_int
r_int
id|offset
suffix:semicolon
r_int
id|dma_bytes
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_PLAYBACK
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|area-&gt;vm_flags
op_amp
(paren
id|VM_WRITE
op_or
id|VM_READ
)paren
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|area-&gt;vm_flags
op_amp
id|VM_READ
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_assert
c_func
(paren
id|runtime
op_ne
l_int|NULL
comma
r_return
op_minus
id|EAGAIN
)paren
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_OPEN
)paren
r_return
op_minus
id|EBADFD
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|runtime-&gt;info
op_amp
id|SNDRV_PCM_INFO_MMAP
)paren
)paren
r_return
op_minus
id|ENXIO
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;access
op_eq
id|SNDRV_PCM_ACCESS_RW_INTERLEAVED
op_logical_or
id|runtime-&gt;access
op_eq
id|SNDRV_PCM_ACCESS_RW_NONINTERLEAVED
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|size
op_assign
id|area-&gt;vm_end
op_minus
id|area-&gt;vm_start
suffix:semicolon
macro_line|#if LINUX_VERSION_CODE &gt;= KERNEL_VERSION(2, 3, 25)
id|offset
op_assign
id|area-&gt;vm_pgoff
op_lshift
id|PAGE_SHIFT
suffix:semicolon
macro_line|#else
id|offset
op_assign
id|area-&gt;vm_offset
suffix:semicolon
macro_line|#endif
id|dma_bytes
op_assign
id|PAGE_ALIGN
c_func
(paren
id|runtime-&gt;dma_bytes
)paren
suffix:semicolon
r_if
c_cond
(paren
id|size
OG
id|dma_bytes
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|offset
OG
id|dma_bytes
op_minus
id|size
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|area-&gt;vm_ops
op_assign
op_amp
id|snd_pcm_vm_ops_data
suffix:semicolon
macro_line|#ifndef LINUX_2_2
id|area-&gt;vm_private_data
op_assign
id|substream
suffix:semicolon
macro_line|#else
id|area-&gt;vm_private_data
op_assign
(paren
r_int
)paren
id|substream
suffix:semicolon
macro_line|#endif
macro_line|#ifdef VM_RESERVED
id|area-&gt;vm_flags
op_or_assign
id|VM_RESERVED
suffix:semicolon
macro_line|#endif
id|atomic_inc
c_func
(paren
op_amp
id|runtime-&gt;mmap_count
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_mmap
r_static
r_int
id|snd_pcm_mmap
c_func
(paren
r_struct
id|file
op_star
id|file
comma
r_struct
id|vm_area_struct
op_star
id|area
)paren
(brace
id|snd_pcm_file_t
op_star
id|pcm_file
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
r_int
r_int
id|offset
suffix:semicolon
id|pcm_file
op_assign
id|snd_magic_cast
c_func
(paren
id|snd_pcm_file_t
comma
id|file-&gt;private_data
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|substream
op_assign
id|pcm_file-&gt;substream
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
macro_line|#if LINUX_VERSION_CODE &gt;= KERNEL_VERSION(2, 3, 25)
id|offset
op_assign
id|area-&gt;vm_pgoff
op_lshift
id|PAGE_SHIFT
suffix:semicolon
macro_line|#else
id|offset
op_assign
id|area-&gt;vm_offset
suffix:semicolon
macro_line|#endif
r_switch
c_cond
(paren
id|offset
)paren
(brace
r_case
id|SNDRV_PCM_MMAP_OFFSET_STATUS
suffix:colon
r_return
id|snd_pcm_mmap_status
c_func
(paren
id|substream
comma
id|file
comma
id|area
)paren
suffix:semicolon
r_case
id|SNDRV_PCM_MMAP_OFFSET_CONTROL
suffix:colon
r_return
id|snd_pcm_mmap_control
c_func
(paren
id|substream
comma
id|file
comma
id|area
)paren
suffix:semicolon
r_default
suffix:colon
r_return
id|snd_pcm_mmap_data
c_func
(paren
id|substream
comma
id|file
comma
id|area
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_fasync
r_static
r_int
id|snd_pcm_fasync
c_func
(paren
r_int
id|fd
comma
r_struct
id|file
op_star
id|file
comma
r_int
id|on
)paren
(brace
id|snd_pcm_file_t
op_star
id|pcm_file
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_int
id|err
suffix:semicolon
id|pcm_file
op_assign
id|snd_magic_cast
c_func
(paren
id|snd_pcm_file_t
comma
id|file-&gt;private_data
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|substream
op_assign
id|pcm_file-&gt;substream
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|err
op_assign
id|fasync_helper
c_func
(paren
id|fd
comma
id|file
comma
id|on
comma
op_amp
id|runtime-&gt;fasync
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; *  Register section&n; */
DECL|variable|snd_pcm_f_ops_playback
r_static
r_struct
id|file_operations
id|snd_pcm_f_ops_playback
op_assign
(brace
macro_line|#ifndef LINUX_2_2
id|owner
suffix:colon
id|THIS_MODULE
comma
macro_line|#endif
id|write
suffix:colon
id|snd_pcm_write
comma
macro_line|#if LINUX_VERSION_CODE &gt;= KERNEL_VERSION(2, 3, 44)
id|writev
suffix:colon
id|snd_pcm_writev
comma
macro_line|#endif
id|open
suffix:colon
id|snd_pcm_open
comma
id|release
suffix:colon
id|snd_pcm_release
comma
id|poll
suffix:colon
id|snd_pcm_playback_poll
comma
id|ioctl
suffix:colon
id|snd_pcm_playback_ioctl
comma
id|mmap
suffix:colon
id|snd_pcm_mmap
comma
id|fasync
suffix:colon
id|snd_pcm_fasync
comma
)brace
suffix:semicolon
DECL|variable|snd_pcm_f_ops_capture
r_static
r_struct
id|file_operations
id|snd_pcm_f_ops_capture
op_assign
(brace
macro_line|#ifndef LINUX_2_2
id|owner
suffix:colon
id|THIS_MODULE
comma
macro_line|#endif
id|read
suffix:colon
id|snd_pcm_read
comma
macro_line|#if LINUX_VERSION_CODE &gt;= KERNEL_VERSION(2, 3, 44)
id|readv
suffix:colon
id|snd_pcm_readv
comma
macro_line|#endif
id|open
suffix:colon
id|snd_pcm_open
comma
id|release
suffix:colon
id|snd_pcm_release
comma
id|poll
suffix:colon
id|snd_pcm_capture_poll
comma
id|ioctl
suffix:colon
id|snd_pcm_capture_ioctl
comma
id|mmap
suffix:colon
id|snd_pcm_mmap
comma
id|fasync
suffix:colon
id|snd_pcm_fasync
comma
)brace
suffix:semicolon
DECL|variable|snd_pcm_reg
id|snd_minor_t
id|snd_pcm_reg
(braket
l_int|2
)braket
op_assign
(brace
(brace
id|comment
suffix:colon
l_string|&quot;digital audio playback&quot;
comma
id|f_ops
suffix:colon
op_amp
id|snd_pcm_f_ops_playback
comma
)brace
comma
(brace
id|comment
suffix:colon
l_string|&quot;digital audio capture&quot;
comma
id|f_ops
suffix:colon
op_amp
id|snd_pcm_f_ops_capture
comma
)brace
)brace
suffix:semicolon
eof
