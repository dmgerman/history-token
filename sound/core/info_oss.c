multiline_comment|/*&n; *  Information interface for ALSA driver&n; *  Copyright (c) by Jaroslav Kysela &lt;perex@suse.cz&gt;&n; *&n; *&n; *   This program is free software; you can redistribute it and/or modify&n; *   it under the terms of the GNU General Public License as published by&n; *   the Free Software Foundation; either version 2 of the License, or&n; *   (at your option) any later version.&n; *&n; *   This program is distributed in the hope that it will be useful,&n; *   but WITHOUT ANY WARRANTY; without even the implied warranty of&n; *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; *   GNU General Public License for more details.&n; *&n; *   You should have received a copy of the GNU General Public License&n; *   along with this program; if not, write to the Free Software&n; *   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA&n; *&n; */
macro_line|#include &lt;sound/driver.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;linux/time.h&gt;
macro_line|#include &lt;sound/core.h&gt;
macro_line|#include &lt;sound/minors.h&gt;
macro_line|#include &lt;sound/info.h&gt;
macro_line|#include &lt;sound/version.h&gt;
macro_line|#include &lt;linux/utsname.h&gt;
macro_line|#if defined(CONFIG_SND_OSSEMUL) &amp;&amp; defined(CONFIG_PROC_FS)
multiline_comment|/*&n; *  OSS compatible part&n; */
r_static
id|DECLARE_MUTEX
c_func
(paren
id|strings
)paren
suffix:semicolon
DECL|variable|snd_sndstat_strings
r_static
r_char
op_star
id|snd_sndstat_strings
(braket
id|SNDRV_CARDS
)braket
(braket
id|SNDRV_OSS_INFO_DEV_COUNT
)braket
suffix:semicolon
DECL|variable|snd_sndstat_proc_entry
r_static
id|snd_info_entry_t
op_star
id|snd_sndstat_proc_entry
suffix:semicolon
DECL|function|snd_oss_info_register
r_int
id|snd_oss_info_register
c_func
(paren
r_int
id|dev
comma
r_int
id|num
comma
r_char
op_star
id|string
)paren
(brace
r_char
op_star
id|x
suffix:semicolon
id|snd_assert
c_func
(paren
id|dev
op_ge
l_int|0
op_logical_and
id|dev
OL
id|SNDRV_OSS_INFO_DEV_COUNT
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|num
op_ge
l_int|0
op_logical_and
id|num
OL
id|SNDRV_CARDS
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|down
c_func
(paren
op_amp
id|strings
)paren
suffix:semicolon
r_if
c_cond
(paren
id|string
op_eq
l_int|NULL
)paren
(brace
r_if
c_cond
(paren
(paren
id|x
op_assign
id|snd_sndstat_strings
(braket
id|num
)braket
(braket
id|dev
)braket
)paren
op_ne
l_int|NULL
)paren
(brace
id|kfree
c_func
(paren
id|x
)paren
suffix:semicolon
id|x
op_assign
l_int|NULL
suffix:semicolon
)brace
)brace
r_else
(brace
id|x
op_assign
id|snd_kmalloc_strdup
c_func
(paren
id|string
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|x
op_eq
l_int|NULL
)paren
(brace
id|up
c_func
(paren
op_amp
id|strings
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
)brace
id|snd_sndstat_strings
(braket
id|num
)braket
(braket
id|dev
)braket
op_assign
id|x
suffix:semicolon
id|up
c_func
(paren
op_amp
id|strings
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_extern
r_void
id|snd_card_info_read_oss
c_func
(paren
id|snd_info_buffer_t
op_star
id|buffer
)paren
suffix:semicolon
DECL|function|snd_sndstat_show_strings
r_static
r_int
id|snd_sndstat_show_strings
c_func
(paren
id|snd_info_buffer_t
op_star
id|buf
comma
r_char
op_star
id|id
comma
r_int
id|dev
)paren
(brace
r_int
id|idx
comma
id|ok
op_assign
op_minus
l_int|1
suffix:semicolon
r_char
op_star
id|str
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buf
comma
l_string|&quot;&bslash;n%s:&quot;
comma
id|id
)paren
suffix:semicolon
id|down
c_func
(paren
op_amp
id|strings
)paren
suffix:semicolon
r_for
c_loop
(paren
id|idx
op_assign
l_int|0
suffix:semicolon
id|idx
OL
id|SNDRV_CARDS
suffix:semicolon
id|idx
op_increment
)paren
(brace
id|str
op_assign
id|snd_sndstat_strings
(braket
id|idx
)braket
(braket
id|dev
)braket
suffix:semicolon
r_if
c_cond
(paren
id|str
)paren
(brace
r_if
c_cond
(paren
id|ok
OL
l_int|0
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buf
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|ok
op_increment
suffix:semicolon
)brace
id|snd_iprintf
c_func
(paren
id|buf
comma
l_string|&quot;%i: %s&bslash;n&quot;
comma
id|idx
comma
id|str
)paren
suffix:semicolon
)brace
)brace
id|up
c_func
(paren
op_amp
id|strings
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ok
OL
l_int|0
)paren
id|snd_iprintf
c_func
(paren
id|buf
comma
l_string|&quot; NOT ENABLED IN CONFIG&bslash;n&quot;
)paren
suffix:semicolon
r_return
id|ok
suffix:semicolon
)brace
DECL|function|snd_sndstat_proc_read
r_static
r_void
id|snd_sndstat_proc_read
c_func
(paren
id|snd_info_entry_t
op_star
id|entry
comma
id|snd_info_buffer_t
op_star
id|buffer
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Sound Driver:3.8.1a-980706 (ALSA v&quot;
id|CONFIG_SND_VERSION
l_string|&quot; emulation code)&bslash;n&quot;
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Kernel: %s %s %s %s %s&bslash;n&quot;
comma
id|system_utsname.sysname
comma
id|system_utsname.nodename
comma
id|system_utsname.release
comma
id|system_utsname.version
comma
id|system_utsname.machine
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Config options: 0&bslash;n&quot;
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;&bslash;nInstalled drivers: &bslash;n&quot;
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Type 10: ALSA emulation&bslash;n&quot;
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;&bslash;nCard config: &bslash;n&quot;
)paren
suffix:semicolon
id|snd_card_info_read_oss
c_func
(paren
id|buffer
)paren
suffix:semicolon
id|snd_sndstat_show_strings
c_func
(paren
id|buffer
comma
l_string|&quot;Audio devices&quot;
comma
id|SNDRV_OSS_INFO_DEV_AUDIO
)paren
suffix:semicolon
id|snd_sndstat_show_strings
c_func
(paren
id|buffer
comma
l_string|&quot;Synth devices&quot;
comma
id|SNDRV_OSS_INFO_DEV_SYNTH
)paren
suffix:semicolon
id|snd_sndstat_show_strings
c_func
(paren
id|buffer
comma
l_string|&quot;Midi devices&quot;
comma
id|SNDRV_OSS_INFO_DEV_MIDI
)paren
suffix:semicolon
id|snd_sndstat_show_strings
c_func
(paren
id|buffer
comma
l_string|&quot;Timers&quot;
comma
id|SNDRV_OSS_INFO_DEV_TIMERS
)paren
suffix:semicolon
id|snd_sndstat_show_strings
c_func
(paren
id|buffer
comma
l_string|&quot;Mixers&quot;
comma
id|SNDRV_OSS_INFO_DEV_MIXERS
)paren
suffix:semicolon
)brace
DECL|function|snd_info_minor_register
r_int
id|snd_info_minor_register
c_func
(paren
r_void
)paren
(brace
id|snd_info_entry_t
op_star
id|entry
suffix:semicolon
id|memset
c_func
(paren
id|snd_sndstat_strings
comma
l_int|0
comma
r_sizeof
(paren
id|snd_sndstat_strings
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|entry
op_assign
id|snd_info_create_module_entry
c_func
(paren
id|THIS_MODULE
comma
l_string|&quot;sndstat&quot;
comma
id|snd_oss_root
)paren
)paren
op_ne
l_int|NULL
)paren
(brace
id|entry-&gt;content
op_assign
id|SNDRV_INFO_CONTENT_TEXT
suffix:semicolon
id|entry-&gt;c.text.read_size
op_assign
l_int|2048
suffix:semicolon
id|entry-&gt;c.text.read
op_assign
id|snd_sndstat_proc_read
suffix:semicolon
r_if
c_cond
(paren
id|snd_info_register
c_func
(paren
id|entry
)paren
OL
l_int|0
)paren
(brace
id|snd_info_free_entry
c_func
(paren
id|entry
)paren
suffix:semicolon
id|entry
op_assign
l_int|NULL
suffix:semicolon
)brace
)brace
id|snd_sndstat_proc_entry
op_assign
id|entry
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_info_minor_unregister
r_int
id|snd_info_minor_unregister
c_func
(paren
r_void
)paren
(brace
r_if
c_cond
(paren
id|snd_sndstat_proc_entry
)paren
(brace
id|snd_info_unregister
c_func
(paren
id|snd_sndstat_proc_entry
)paren
suffix:semicolon
id|snd_sndstat_proc_entry
op_assign
l_int|NULL
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#else
DECL|function|snd_info_minor_register
r_int
id|snd_info_minor_register
c_func
(paren
r_void
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_info_minor_unregister
r_int
id|snd_info_minor_unregister
c_func
(paren
r_void
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#endif /* CONFIG_SND_OSSEMUL */
eof
