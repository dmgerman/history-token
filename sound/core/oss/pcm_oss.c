multiline_comment|/*&n; *  Digital Audio (PCM) abstract layer / OSS compatible&n; *  Copyright (c) by Jaroslav Kysela &lt;perex@suse.cz&gt;&n; *&n; *&n; *   This program is free software; you can redistribute it and/or modify&n; *   it under the terms of the GNU General Public License as published by&n; *   the Free Software Foundation; either version 2 of the License, or&n; *   (at your option) any later version.&n; *&n; *   This program is distributed in the hope that it will be useful,&n; *   but WITHOUT ANY WARRANTY; without even the implied warranty of&n; *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; *   GNU General Public License for more details.&n; *&n; *   You should have received a copy of the GNU General Public License&n; *   along with this program; if not, write to the Free Software&n; *   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA&n; *&n; */
macro_line|#if 0
mdefine_line|#define PLUGIN_DEBUG
macro_line|#endif
macro_line|#include &lt;sound/driver.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;sound/core.h&gt;
macro_line|#include &lt;sound/minors.h&gt;
macro_line|#include &lt;sound/pcm.h&gt;
macro_line|#include &lt;sound/pcm_params.h&gt;
macro_line|#include &quot;pcm_plugin.h&quot;
macro_line|#include &lt;sound/info.h&gt;
macro_line|#include &lt;linux/soundcard.h&gt;
macro_line|#include &lt;sound/initval.h&gt;
DECL|variable|snd_dsp_map
r_static
r_int
id|snd_dsp_map
(braket
id|SNDRV_CARDS
)braket
op_assign
(brace
(braket
l_int|0
dot
dot
dot
(paren
id|SNDRV_CARDS
op_minus
l_int|1
)paren
)braket
op_assign
l_int|0
)brace
suffix:semicolon
DECL|variable|snd_adsp_map
r_static
r_int
id|snd_adsp_map
(braket
id|SNDRV_CARDS
)braket
op_assign
(brace
(braket
l_int|0
dot
dot
dot
(paren
id|SNDRV_CARDS
op_minus
l_int|1
)paren
)braket
op_assign
l_int|1
)brace
suffix:semicolon
DECL|variable|snd_nonblock_open
r_static
r_int
id|snd_nonblock_open
op_assign
l_int|0
suffix:semicolon
id|MODULE_AUTHOR
c_func
(paren
l_string|&quot;Jaroslav Kysela &lt;perex@suse.cz&gt;, Abramo Bagnara &lt;abramo@alsa-project.org&gt;&quot;
)paren
suffix:semicolon
id|MODULE_DESCRIPTION
c_func
(paren
l_string|&quot;PCM OSS emulation for ALSA.&quot;
)paren
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|snd_dsp_map
comma
l_string|&quot;1-&quot;
id|__MODULE_STRING
c_func
(paren
id|SNDRV_CARDS
)paren
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|snd_dsp_map
comma
l_string|&quot;PCM device number assigned to 1st OSS device.&quot;
)paren
suffix:semicolon
id|MODULE_PARM_SYNTAX
c_func
(paren
id|snd_dsp_map
comma
l_string|&quot;default:0,skill:advanced&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|snd_adsp_map
comma
l_string|&quot;1-&quot;
id|__MODULE_STRING
c_func
(paren
id|SNDRV_CARDS
)paren
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|snd_adsp_map
comma
l_string|&quot;PCM device number assigned to 2nd OSS device.&quot;
)paren
suffix:semicolon
id|MODULE_PARM_SYNTAX
c_func
(paren
id|snd_adsp_map
comma
l_string|&quot;default:1,skill:advanced&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|snd_nonblock_open
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|snd_nonblock_open
comma
l_string|&quot;Don&squot;t block opening busy PCM devices.&quot;
)paren
suffix:semicolon
id|MODULE_PARM_SYNTAX
c_func
(paren
id|snd_nonblock_open
comma
l_string|&quot;default:0,skill:advanced&quot;
)paren
suffix:semicolon
r_extern
r_int
id|snd_mixer_oss_ioctl_card
c_func
(paren
id|snd_card_t
op_star
id|card
comma
r_int
r_int
id|cmd
comma
r_int
r_int
id|arg
)paren
suffix:semicolon
r_static
r_int
id|snd_pcm_oss_get_rate
c_func
(paren
id|snd_pcm_oss_file_t
op_star
id|pcm_oss_file
)paren
suffix:semicolon
r_static
r_int
id|snd_pcm_oss_get_channels
c_func
(paren
id|snd_pcm_oss_file_t
op_star
id|pcm_oss_file
)paren
suffix:semicolon
r_static
r_int
id|snd_pcm_oss_get_format
c_func
(paren
id|snd_pcm_oss_file_t
op_star
id|pcm_oss_file
)paren
suffix:semicolon
id|EXPORT_NO_SYMBOLS
suffix:semicolon
DECL|function|snd_enter_user
r_static
r_inline
id|mm_segment_t
id|snd_enter_user
c_func
(paren
r_void
)paren
(brace
id|mm_segment_t
id|fs
op_assign
id|get_fs
c_func
(paren
)paren
suffix:semicolon
id|set_fs
c_func
(paren
id|get_ds
c_func
(paren
)paren
)paren
suffix:semicolon
r_return
id|fs
suffix:semicolon
)brace
DECL|function|snd_leave_user
r_static
r_inline
r_void
id|snd_leave_user
c_func
(paren
id|mm_segment_t
id|fs
)paren
(brace
id|set_fs
c_func
(paren
id|fs
)paren
suffix:semicolon
)brace
DECL|function|dec_mod_count
r_static
r_inline
r_void
id|dec_mod_count
c_func
(paren
r_struct
id|module
op_star
id|module
)paren
(brace
r_if
c_cond
(paren
id|module
)paren
id|__MOD_DEC_USE_COUNT
c_func
(paren
id|module
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_plugin_clear
r_int
id|snd_pcm_oss_plugin_clear
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_pcm_plugin_t
op_star
id|plugin
comma
op_star
id|next
suffix:semicolon
id|plugin
op_assign
id|runtime-&gt;oss.plugin_first
suffix:semicolon
r_while
c_loop
(paren
id|plugin
)paren
(brace
id|next
op_assign
id|plugin-&gt;next
suffix:semicolon
id|snd_pcm_plugin_free
c_func
(paren
id|plugin
)paren
suffix:semicolon
id|plugin
op_assign
id|next
suffix:semicolon
)brace
id|runtime-&gt;oss.plugin_first
op_assign
id|runtime-&gt;oss.plugin_last
op_assign
l_int|NULL
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_plugin_insert
r_int
id|snd_pcm_plugin_insert
c_func
(paren
id|snd_pcm_plugin_t
op_star
id|plugin
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|plugin-&gt;plug-&gt;runtime
suffix:semicolon
id|plugin-&gt;next
op_assign
id|runtime-&gt;oss.plugin_first
suffix:semicolon
id|plugin-&gt;prev
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;oss.plugin_first
)paren
(brace
id|runtime-&gt;oss.plugin_first-&gt;prev
op_assign
id|plugin
suffix:semicolon
id|runtime-&gt;oss.plugin_first
op_assign
id|plugin
suffix:semicolon
)brace
r_else
(brace
id|runtime-&gt;oss.plugin_last
op_assign
id|runtime-&gt;oss.plugin_first
op_assign
id|plugin
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_plugin_append
r_int
id|snd_pcm_plugin_append
c_func
(paren
id|snd_pcm_plugin_t
op_star
id|plugin
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|plugin-&gt;plug-&gt;runtime
suffix:semicolon
id|plugin-&gt;next
op_assign
l_int|NULL
suffix:semicolon
id|plugin-&gt;prev
op_assign
id|runtime-&gt;oss.plugin_last
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;oss.plugin_last
)paren
(brace
id|runtime-&gt;oss.plugin_last-&gt;next
op_assign
id|plugin
suffix:semicolon
id|runtime-&gt;oss.plugin_last
op_assign
id|plugin
suffix:semicolon
)brace
r_else
(brace
id|runtime-&gt;oss.plugin_last
op_assign
id|runtime-&gt;oss.plugin_first
op_assign
id|plugin
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_bytes
r_static
r_int
id|snd_pcm_oss_bytes
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|frames
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;period_size
op_eq
id|runtime-&gt;oss.period_bytes
)paren
r_return
id|frames
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;period_size
OL
id|runtime-&gt;oss.period_bytes
)paren
r_return
id|frames
op_star
(paren
id|runtime-&gt;oss.period_bytes
op_div
id|runtime-&gt;period_size
)paren
suffix:semicolon
r_return
id|frames
op_div
(paren
id|runtime-&gt;period_size
op_div
id|runtime-&gt;oss.period_bytes
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_format_from
r_static
r_int
id|snd_pcm_oss_format_from
c_func
(paren
r_int
id|format
)paren
(brace
r_switch
c_cond
(paren
id|format
)paren
(brace
r_case
id|AFMT_MU_LAW
suffix:colon
r_return
id|SNDRV_PCM_FORMAT_MU_LAW
suffix:semicolon
r_case
id|AFMT_A_LAW
suffix:colon
r_return
id|SNDRV_PCM_FORMAT_A_LAW
suffix:semicolon
r_case
id|AFMT_IMA_ADPCM
suffix:colon
r_return
id|SNDRV_PCM_FORMAT_IMA_ADPCM
suffix:semicolon
r_case
id|AFMT_U8
suffix:colon
r_return
id|SNDRV_PCM_FORMAT_U8
suffix:semicolon
r_case
id|AFMT_S16_LE
suffix:colon
r_return
id|SNDRV_PCM_FORMAT_S16_LE
suffix:semicolon
r_case
id|AFMT_S16_BE
suffix:colon
r_return
id|SNDRV_PCM_FORMAT_S16_BE
suffix:semicolon
r_case
id|AFMT_S8
suffix:colon
r_return
id|SNDRV_PCM_FORMAT_S8
suffix:semicolon
r_case
id|AFMT_U16_LE
suffix:colon
r_return
id|SNDRV_PCM_FORMAT_U16_LE
suffix:semicolon
r_case
id|AFMT_U16_BE
suffix:colon
r_return
id|SNDRV_PCM_FORMAT_U16_BE
suffix:semicolon
r_case
id|AFMT_MPEG
suffix:colon
r_return
id|SNDRV_PCM_FORMAT_MPEG
suffix:semicolon
r_default
suffix:colon
r_return
id|SNDRV_PCM_FORMAT_U8
suffix:semicolon
)brace
)brace
DECL|function|snd_pcm_oss_format_to
r_static
r_int
id|snd_pcm_oss_format_to
c_func
(paren
r_int
id|format
)paren
(brace
r_switch
c_cond
(paren
id|format
)paren
(brace
r_case
id|SNDRV_PCM_FORMAT_MU_LAW
suffix:colon
r_return
id|AFMT_MU_LAW
suffix:semicolon
r_case
id|SNDRV_PCM_FORMAT_A_LAW
suffix:colon
r_return
id|AFMT_A_LAW
suffix:semicolon
r_case
id|SNDRV_PCM_FORMAT_IMA_ADPCM
suffix:colon
r_return
id|AFMT_IMA_ADPCM
suffix:semicolon
r_case
id|SNDRV_PCM_FORMAT_U8
suffix:colon
r_return
id|AFMT_U8
suffix:semicolon
r_case
id|SNDRV_PCM_FORMAT_S16_LE
suffix:colon
r_return
id|AFMT_S16_LE
suffix:semicolon
r_case
id|SNDRV_PCM_FORMAT_S16_BE
suffix:colon
r_return
id|AFMT_S16_BE
suffix:semicolon
r_case
id|SNDRV_PCM_FORMAT_S8
suffix:colon
r_return
id|AFMT_S8
suffix:semicolon
r_case
id|SNDRV_PCM_FORMAT_U16_LE
suffix:colon
r_return
id|AFMT_U16_LE
suffix:semicolon
r_case
id|SNDRV_PCM_FORMAT_U16_BE
suffix:colon
r_return
id|AFMT_U16_BE
suffix:semicolon
r_case
id|SNDRV_PCM_FORMAT_MPEG
suffix:colon
r_return
id|AFMT_MPEG
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
)brace
DECL|function|snd_pcm_oss_period_size
r_static
r_int
id|snd_pcm_oss_period_size
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_hw_params_t
op_star
id|oss_params
comma
id|snd_pcm_hw_params_t
op_star
id|slave_params
)paren
(brace
r_int
id|s
suffix:semicolon
r_int
id|oss_buffer_size
comma
id|oss_period_size
comma
id|oss_periods
suffix:semicolon
r_int
id|min_period_size
comma
id|max_period_size
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_int
id|oss_frame_size
suffix:semicolon
id|oss_frame_size
op_assign
id|snd_pcm_format_physical_width
c_func
(paren
id|params_format
c_func
(paren
id|oss_params
)paren
)paren
op_star
id|params_channels
c_func
(paren
id|oss_params
)paren
op_div
l_int|8
suffix:semicolon
id|oss_buffer_size
op_assign
id|snd_pcm_plug_client_size
c_func
(paren
id|substream
comma
id|snd_pcm_hw_param_value_max
c_func
(paren
id|slave_params
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_SIZE
comma
l_int|0
)paren
)paren
op_star
id|oss_frame_size
suffix:semicolon
id|oss_buffer_size
op_assign
l_int|1
op_lshift
id|ld2
c_func
(paren
id|oss_buffer_size
)paren
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|runtime-&gt;mmap_count
)paren
)paren
(brace
r_if
c_cond
(paren
id|oss_buffer_size
OG
id|runtime-&gt;oss.mmap_bytes
)paren
id|oss_buffer_size
op_assign
id|runtime-&gt;oss.mmap_bytes
suffix:semicolon
)brace
r_if
c_cond
(paren
id|substream-&gt;oss.setup
op_logical_and
id|substream-&gt;oss.setup-&gt;period_size
OG
l_int|16
)paren
id|oss_period_size
op_assign
id|substream-&gt;oss.setup-&gt;period_size
suffix:semicolon
r_else
r_if
c_cond
(paren
id|runtime-&gt;oss.fragshift
)paren
(brace
id|oss_period_size
op_assign
l_int|1
op_lshift
id|runtime-&gt;oss.fragshift
suffix:semicolon
r_if
c_cond
(paren
id|oss_period_size
OG
id|oss_buffer_size
op_div
l_int|2
)paren
id|oss_period_size
op_assign
id|oss_buffer_size
op_div
l_int|2
suffix:semicolon
)brace
r_else
(brace
r_int
id|sd
suffix:semicolon
r_int
id|bytes_per_sec
op_assign
id|params_rate
c_func
(paren
id|oss_params
)paren
op_star
id|snd_pcm_format_physical_width
c_func
(paren
id|params_format
c_func
(paren
id|oss_params
)paren
)paren
op_star
id|params_channels
c_func
(paren
id|oss_params
)paren
op_div
l_int|8
suffix:semicolon
id|oss_period_size
op_assign
id|oss_buffer_size
suffix:semicolon
r_do
(brace
id|oss_period_size
op_div_assign
l_int|2
suffix:semicolon
)brace
r_while
c_loop
(paren
id|oss_period_size
OG
id|bytes_per_sec
)paren
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;oss.subdivision
op_eq
l_int|0
)paren
(brace
id|sd
op_assign
l_int|4
suffix:semicolon
r_if
c_cond
(paren
id|oss_period_size
op_div
id|sd
OG
l_int|4096
)paren
id|sd
op_mul_assign
l_int|2
suffix:semicolon
r_if
c_cond
(paren
id|oss_period_size
op_div
id|sd
OL
l_int|4096
)paren
id|sd
op_assign
l_int|1
suffix:semicolon
)brace
r_else
id|sd
op_assign
id|runtime-&gt;oss.subdivision
suffix:semicolon
id|oss_period_size
op_div_assign
id|sd
suffix:semicolon
r_if
c_cond
(paren
id|oss_period_size
OL
l_int|16
)paren
id|oss_period_size
op_assign
l_int|16
suffix:semicolon
)brace
id|min_period_size
op_assign
id|snd_pcm_plug_client_size
c_func
(paren
id|substream
comma
id|snd_pcm_hw_param_value_min
c_func
(paren
id|slave_params
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_SIZE
comma
l_int|0
)paren
)paren
suffix:semicolon
id|min_period_size
op_mul_assign
id|oss_frame_size
suffix:semicolon
id|min_period_size
op_assign
l_int|1
op_lshift
(paren
id|ld2
c_func
(paren
id|min_period_size
op_minus
l_int|1
)paren
op_plus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|oss_period_size
OL
id|min_period_size
)paren
id|oss_period_size
op_assign
id|min_period_size
suffix:semicolon
id|max_period_size
op_assign
id|snd_pcm_plug_client_size
c_func
(paren
id|substream
comma
id|snd_pcm_hw_param_value_max
c_func
(paren
id|slave_params
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_SIZE
comma
l_int|0
)paren
)paren
suffix:semicolon
id|max_period_size
op_mul_assign
id|oss_frame_size
suffix:semicolon
id|max_period_size
op_assign
l_int|1
op_lshift
id|ld2
c_func
(paren
id|max_period_size
)paren
suffix:semicolon
r_if
c_cond
(paren
id|oss_period_size
OG
id|max_period_size
)paren
id|oss_period_size
op_assign
id|max_period_size
suffix:semicolon
id|oss_periods
op_assign
id|oss_buffer_size
op_div
id|oss_period_size
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;oss.setup
)paren
(brace
r_if
c_cond
(paren
id|substream-&gt;oss.setup-&gt;periods
OG
l_int|1
)paren
id|oss_periods
op_assign
id|substream-&gt;oss.setup-&gt;periods
suffix:semicolon
)brace
id|s
op_assign
id|snd_pcm_hw_param_value_max
c_func
(paren
id|slave_params
comma
id|SNDRV_PCM_HW_PARAM_PERIODS
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;oss.maxfrags
op_logical_and
id|s
OG
id|runtime-&gt;oss.maxfrags
)paren
id|s
op_assign
id|runtime-&gt;oss.maxfrags
suffix:semicolon
r_if
c_cond
(paren
id|oss_periods
OG
id|s
)paren
id|oss_periods
op_assign
id|s
suffix:semicolon
id|s
op_assign
id|snd_pcm_hw_param_value_min
c_func
(paren
id|slave_params
comma
id|SNDRV_PCM_HW_PARAM_PERIODS
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|s
OL
l_int|2
)paren
id|s
op_assign
l_int|2
suffix:semicolon
r_if
c_cond
(paren
id|oss_periods
OL
id|s
)paren
id|oss_periods
op_assign
id|s
suffix:semicolon
r_while
c_loop
(paren
id|oss_period_size
op_star
id|oss_periods
OG
id|oss_buffer_size
)paren
id|oss_period_size
op_div_assign
l_int|2
suffix:semicolon
id|snd_assert
c_func
(paren
id|oss_period_size
op_ge
l_int|16
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|runtime-&gt;oss.period_bytes
op_assign
id|oss_period_size
suffix:semicolon
id|runtime-&gt;oss.periods
op_assign
id|oss_periods
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_change_params
r_static
r_int
id|snd_pcm_oss_change_params
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_pcm_hw_params_t
id|params
comma
id|sparams
suffix:semicolon
id|snd_pcm_sw_params_t
id|sw_params
suffix:semicolon
id|ssize_t
id|oss_buffer_size
comma
id|oss_period_size
suffix:semicolon
r_int
id|oss_frame_size
suffix:semicolon
r_int
id|err
suffix:semicolon
r_int
id|direct
suffix:semicolon
r_int
id|format
comma
id|sformat
comma
id|n
suffix:semicolon
r_int
r_int
id|sformat_mask
suffix:semicolon
r_int
r_int
id|mask
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|runtime-&gt;mmap_count
)paren
)paren
(brace
id|direct
op_assign
l_int|1
suffix:semicolon
)brace
r_else
(brace
id|snd_pcm_oss_setup_t
op_star
id|setup
op_assign
id|substream-&gt;oss.setup
suffix:semicolon
id|direct
op_assign
(paren
id|setup
op_ne
l_int|NULL
op_logical_and
id|setup-&gt;direct
)paren
suffix:semicolon
)brace
id|_snd_pcm_hw_params_any
c_func
(paren
op_amp
id|sparams
)paren
suffix:semicolon
id|_snd_pcm_hw_param_setinteger
c_func
(paren
op_amp
id|sparams
comma
id|SNDRV_PCM_HW_PARAM_PERIODS
)paren
suffix:semicolon
id|_snd_pcm_hw_param_min
c_func
(paren
op_amp
id|sparams
comma
id|SNDRV_PCM_HW_PARAM_PERIODS
comma
l_int|2
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|runtime-&gt;mmap_count
)paren
)paren
id|mask
op_assign
l_int|1
op_lshift
id|SNDRV_PCM_ACCESS_MMAP_INTERLEAVED
suffix:semicolon
r_else
(brace
id|mask
op_assign
l_int|1
op_lshift
id|SNDRV_PCM_ACCESS_RW_INTERLEAVED
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|direct
)paren
id|mask
op_or_assign
l_int|1
op_lshift
id|SNDRV_PCM_ACCESS_RW_NONINTERLEAVED
suffix:semicolon
)brace
id|err
op_assign
id|snd_pcm_hw_param_mask
c_func
(paren
id|substream
comma
op_amp
id|sparams
comma
id|SNDRV_PCM_HW_PARAM_ACCESS
comma
op_amp
id|mask
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
(brace
id|snd_printd
c_func
(paren
l_string|&quot;No usable accesses&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|snd_pcm_hw_param_near
c_func
(paren
id|substream
comma
op_amp
id|sparams
comma
id|SNDRV_PCM_HW_PARAM_RATE
comma
id|runtime-&gt;oss.rate
comma
l_int|0
)paren
suffix:semicolon
id|snd_pcm_hw_param_near
c_func
(paren
id|substream
comma
op_amp
id|sparams
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
comma
id|runtime-&gt;oss.channels
comma
l_int|0
)paren
suffix:semicolon
id|format
op_assign
id|snd_pcm_oss_format_from
c_func
(paren
id|runtime-&gt;oss.format
)paren
suffix:semicolon
id|sformat_mask
op_assign
op_star
id|hw_param_mask
c_func
(paren
op_amp
id|sparams
comma
id|SNDRV_PCM_HW_PARAM_FORMAT
)paren
suffix:semicolon
r_if
c_cond
(paren
id|direct
)paren
id|sformat
op_assign
id|format
suffix:semicolon
r_else
id|sformat
op_assign
id|snd_pcm_plug_slave_format
c_func
(paren
id|format
comma
id|sformat_mask
)paren
suffix:semicolon
r_if
c_cond
(paren
id|sformat
OL
l_int|0
op_logical_or
op_logical_neg
(paren
id|sformat_mask
op_amp
(paren
l_int|1
op_lshift
id|sformat
)paren
)paren
)paren
(brace
r_for
c_loop
(paren
id|sformat
op_assign
l_int|0
suffix:semicolon
id|sformat
op_le
id|SNDRV_PCM_FORMAT_LAST
suffix:semicolon
id|sformat
op_increment
)paren
(brace
r_if
c_cond
(paren
(paren
id|sformat_mask
op_amp
(paren
l_int|1
op_lshift
id|sformat
)paren
)paren
op_logical_and
id|snd_pcm_oss_format_to
c_func
(paren
id|sformat
)paren
op_ge
l_int|0
)paren
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|sformat
OG
id|SNDRV_PCM_FORMAT_LAST
)paren
(brace
id|snd_printd
c_func
(paren
l_string|&quot;Cannot find a format!!!&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
)brace
id|err
op_assign
id|_snd_pcm_hw_param_set
c_func
(paren
op_amp
id|sparams
comma
id|SNDRV_PCM_HW_PARAM_FORMAT
comma
id|sformat
comma
l_int|0
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|err
op_ge
l_int|0
comma
r_return
id|err
)paren
suffix:semicolon
r_if
c_cond
(paren
id|direct
)paren
(brace
id|params
op_assign
id|sparams
suffix:semicolon
)brace
r_else
(brace
id|_snd_pcm_hw_params_any
c_func
(paren
op_amp
id|params
)paren
suffix:semicolon
id|_snd_pcm_hw_param_set
c_func
(paren
op_amp
id|params
comma
id|SNDRV_PCM_HW_PARAM_ACCESS
comma
id|SNDRV_PCM_ACCESS_RW_INTERLEAVED
comma
l_int|0
)paren
suffix:semicolon
id|_snd_pcm_hw_param_set
c_func
(paren
op_amp
id|params
comma
id|SNDRV_PCM_HW_PARAM_FORMAT
comma
id|snd_pcm_oss_format_from
c_func
(paren
id|runtime-&gt;oss.format
)paren
comma
l_int|0
)paren
suffix:semicolon
id|_snd_pcm_hw_param_set
c_func
(paren
op_amp
id|params
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
comma
id|runtime-&gt;oss.channels
comma
l_int|0
)paren
suffix:semicolon
id|_snd_pcm_hw_param_set
c_func
(paren
op_amp
id|params
comma
id|SNDRV_PCM_HW_PARAM_RATE
comma
id|runtime-&gt;oss.rate
comma
l_int|0
)paren
suffix:semicolon
id|pdprintf
c_func
(paren
l_string|&quot;client: access = %i, format = %i, channels = %i, rate = %i&bslash;n&quot;
comma
id|params_access
c_func
(paren
op_amp
id|params
)paren
comma
id|params_format
c_func
(paren
op_amp
id|params
)paren
comma
id|params_channels
c_func
(paren
op_amp
id|params
)paren
comma
id|params_rate
c_func
(paren
op_amp
id|params
)paren
)paren
suffix:semicolon
)brace
id|pdprintf
c_func
(paren
l_string|&quot;slave: access = %i, format = %i, channels = %i, rate = %i&bslash;n&quot;
comma
id|params_access
c_func
(paren
op_amp
id|sparams
)paren
comma
id|params_format
c_func
(paren
op_amp
id|sparams
)paren
comma
id|params_channels
c_func
(paren
op_amp
id|sparams
)paren
comma
id|params_rate
c_func
(paren
op_amp
id|sparams
)paren
)paren
suffix:semicolon
id|oss_frame_size
op_assign
id|snd_pcm_format_physical_width
c_func
(paren
id|params_format
c_func
(paren
op_amp
id|params
)paren
)paren
op_star
id|params_channels
c_func
(paren
op_amp
id|params
)paren
op_div
l_int|8
suffix:semicolon
id|snd_pcm_oss_plugin_clear
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|direct
)paren
(brace
multiline_comment|/* add necessary plugins */
id|snd_pcm_oss_plugin_clear
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_pcm_plug_format_plugins
c_func
(paren
id|substream
comma
op_amp
id|params
comma
op_amp
id|sparams
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_printd
c_func
(paren
l_string|&quot;snd_pcm_plug_format_plugins failed: %i&bslash;n&quot;
comma
id|err
)paren
suffix:semicolon
id|snd_pcm_oss_plugin_clear
c_func
(paren
id|substream
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
r_if
c_cond
(paren
id|runtime-&gt;oss.plugin_first
)paren
(brace
id|snd_pcm_plugin_t
op_star
id|plugin
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_pcm_plugin_build_io
c_func
(paren
id|substream
comma
op_amp
id|sparams
comma
op_amp
id|plugin
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_printd
c_func
(paren
l_string|&quot;snd_pcm_plugin_build_io failed: %i&bslash;n&quot;
comma
id|err
)paren
suffix:semicolon
id|snd_pcm_oss_plugin_clear
c_func
(paren
id|substream
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
r_if
c_cond
(paren
id|substream-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_PLAYBACK
)paren
(brace
id|err
op_assign
id|snd_pcm_plugin_append
c_func
(paren
id|plugin
)paren
suffix:semicolon
)brace
r_else
(brace
id|err
op_assign
id|snd_pcm_plugin_insert
c_func
(paren
id|plugin
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
(brace
id|snd_pcm_oss_plugin_clear
c_func
(paren
id|substream
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
)brace
)brace
id|err
op_assign
id|snd_pcm_oss_period_size
c_func
(paren
id|substream
comma
op_amp
id|params
comma
op_amp
id|sparams
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|n
op_assign
id|snd_pcm_plug_slave_size
c_func
(paren
id|substream
comma
id|runtime-&gt;oss.period_bytes
op_div
id|oss_frame_size
)paren
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_param_near
c_func
(paren
id|substream
comma
op_amp
id|sparams
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_SIZE
comma
id|n
comma
l_int|0
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|err
op_ge
l_int|0
comma
r_return
id|err
)paren
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_param_near
c_func
(paren
id|substream
comma
op_amp
id|sparams
comma
id|SNDRV_PCM_HW_PARAM_PERIODS
comma
id|runtime-&gt;oss.periods
comma
l_int|0
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|err
op_ge
l_int|0
comma
r_return
id|err
)paren
suffix:semicolon
id|snd_pcm_kernel_ioctl
c_func
(paren
id|substream
comma
id|SNDRV_PCM_IOCTL_DROP
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_pcm_kernel_ioctl
c_func
(paren
id|substream
comma
id|SNDRV_PCM_IOCTL_HW_PARAMS
comma
op_amp
id|sparams
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_printd
c_func
(paren
l_string|&quot;HW_PARAMS failed: %i&bslash;n&quot;
comma
id|err
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
id|memset
c_func
(paren
op_amp
id|sw_params
comma
l_int|0
comma
r_sizeof
(paren
id|sw_params
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;oss.trigger
)paren
(brace
id|sw_params.start_threshold
op_assign
l_int|1
suffix:semicolon
)brace
r_else
(brace
id|sw_params.start_threshold
op_assign
id|runtime-&gt;boundary
suffix:semicolon
)brace
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|runtime-&gt;mmap_count
)paren
)paren
id|sw_params.stop_threshold
op_assign
id|runtime-&gt;boundary
suffix:semicolon
r_else
id|sw_params.stop_threshold
op_assign
id|runtime-&gt;buffer_size
suffix:semicolon
id|sw_params.tstamp_mode
op_assign
id|SNDRV_PCM_TSTAMP_NONE
suffix:semicolon
id|sw_params.period_step
op_assign
l_int|1
suffix:semicolon
id|sw_params.sleep_min
op_assign
l_int|0
suffix:semicolon
id|sw_params.avail_min
op_assign
id|runtime-&gt;period_size
suffix:semicolon
id|sw_params.xfer_align
op_assign
l_int|1
suffix:semicolon
id|sw_params.silence_threshold
op_assign
l_int|0
suffix:semicolon
id|sw_params.silence_size
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_pcm_kernel_ioctl
c_func
(paren
id|substream
comma
id|SNDRV_PCM_IOCTL_SW_PARAMS
comma
op_amp
id|sw_params
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_printd
c_func
(paren
l_string|&quot;SW_PARAMS failed: %i&bslash;n&quot;
comma
id|err
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
id|runtime-&gt;control-&gt;avail_min
op_assign
id|runtime-&gt;period_size
suffix:semicolon
id|runtime-&gt;oss.periods
op_assign
id|params_periods
c_func
(paren
op_amp
id|sparams
)paren
suffix:semicolon
id|oss_period_size
op_assign
id|snd_pcm_plug_client_size
c_func
(paren
id|substream
comma
id|params_period_size
c_func
(paren
op_amp
id|sparams
)paren
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|oss_period_size
op_ge
l_int|0
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;oss.plugin_first
)paren
(brace
id|err
op_assign
id|snd_pcm_plug_alloc
c_func
(paren
id|substream
comma
id|oss_period_size
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
id|oss_period_size
op_mul_assign
id|oss_frame_size
suffix:semicolon
id|oss_buffer_size
op_assign
id|oss_period_size
op_star
id|runtime-&gt;oss.periods
suffix:semicolon
id|snd_assert
c_func
(paren
id|oss_buffer_size
op_ge
l_int|0
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|runtime-&gt;oss.period_bytes
op_assign
id|oss_period_size
suffix:semicolon
id|runtime-&gt;oss.buffer_bytes
op_assign
id|oss_buffer_size
suffix:semicolon
id|pdprintf
c_func
(paren
l_string|&quot;oss: period bytes = %i, buffer bytes = %i&bslash;n&quot;
comma
id|runtime-&gt;oss.period_bytes
comma
id|runtime-&gt;oss.buffer_bytes
)paren
suffix:semicolon
id|pdprintf
c_func
(paren
l_string|&quot;slave: period_size = %i, buffer_size = %i&bslash;n&quot;
comma
id|params_period_size
c_func
(paren
op_amp
id|sparams
)paren
comma
id|params_buffer_size
c_func
(paren
op_amp
id|sparams
)paren
)paren
suffix:semicolon
id|runtime-&gt;oss.format
op_assign
id|snd_pcm_oss_format_to
c_func
(paren
id|params_format
c_func
(paren
op_amp
id|params
)paren
)paren
suffix:semicolon
id|runtime-&gt;oss.channels
op_assign
id|params_channels
c_func
(paren
op_amp
id|params
)paren
suffix:semicolon
id|runtime-&gt;oss.rate
op_assign
id|params_rate
c_func
(paren
op_amp
id|params
)paren
suffix:semicolon
id|runtime-&gt;oss.params
op_assign
l_int|0
suffix:semicolon
id|runtime-&gt;oss.prepare
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;oss.buffer
op_ne
l_int|NULL
)paren
id|vfree
c_func
(paren
id|runtime-&gt;oss.buffer
)paren
suffix:semicolon
id|runtime-&gt;oss.buffer
op_assign
id|vmalloc
c_func
(paren
id|runtime-&gt;oss.period_bytes
)paren
suffix:semicolon
id|runtime-&gt;oss.buffer_used
op_assign
l_int|0
suffix:semicolon
id|snd_assert
c_func
(paren
id|runtime-&gt;dma_area
op_ne
l_int|NULL
comma
r_return
op_minus
id|EIO
)paren
suffix:semicolon
id|snd_pcm_format_set_silence
c_func
(paren
id|runtime-&gt;format
comma
id|runtime-&gt;dma_area
comma
id|bytes_to_samples
c_func
(paren
id|runtime
comma
id|runtime-&gt;dma_bytes
)paren
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_get_active_substream
r_static
r_int
id|snd_pcm_oss_get_active_substream
c_func
(paren
id|snd_pcm_oss_file_t
op_star
id|pcm_oss_file
comma
id|snd_pcm_substream_t
op_star
op_star
id|r_substream
)paren
(brace
r_int
id|idx
comma
id|err
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|asubstream
op_assign
l_int|NULL
comma
op_star
id|substream
suffix:semicolon
r_for
c_loop
(paren
id|idx
op_assign
l_int|0
suffix:semicolon
id|idx
OL
l_int|2
suffix:semicolon
id|idx
op_increment
)paren
(brace
id|substream
op_assign
id|pcm_oss_file-&gt;streams
(braket
id|idx
)braket
suffix:semicolon
r_if
c_cond
(paren
id|substream
op_eq
l_int|NULL
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|asubstream
op_eq
l_int|NULL
)paren
id|asubstream
op_assign
id|substream
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;runtime-&gt;oss.params
)paren
(brace
id|err
op_assign
id|snd_pcm_oss_change_params
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
)brace
id|snd_assert
c_func
(paren
id|asubstream
op_ne
l_int|NULL
comma
r_return
op_minus
id|EIO
)paren
suffix:semicolon
r_if
c_cond
(paren
id|r_substream
)paren
op_star
id|r_substream
op_assign
id|asubstream
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_prepare
r_static
r_int
id|snd_pcm_oss_prepare
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
r_int
id|err
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|err
op_assign
id|snd_pcm_kernel_ioctl
c_func
(paren
id|substream
comma
id|SNDRV_PCM_IOCTL_PREPARE
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
(brace
id|snd_printd
c_func
(paren
l_string|&quot;snd_pcm_oss_prepare: SNDRV_PCM_IOCTL_PREPARE failed&bslash;n&quot;
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
id|runtime-&gt;oss.prepare
op_assign
l_int|0
suffix:semicolon
id|runtime-&gt;oss.prev_hw_ptr_interrupt
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_make_ready
r_static
r_int
id|snd_pcm_oss_make_ready
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
id|substream
op_eq
l_int|NULL
)paren
r_return
l_int|0
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;oss.params
)paren
(brace
id|err
op_assign
id|snd_pcm_oss_change_params
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
r_if
c_cond
(paren
id|runtime-&gt;oss.prepare
)paren
(brace
id|err
op_assign
id|snd_pcm_oss_prepare
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_write3
id|snd_pcm_sframes_t
id|snd_pcm_oss_write3
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_const
r_char
op_star
id|ptr
comma
id|snd_pcm_uframes_t
id|frames
comma
r_int
id|in_kernel
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|mm_segment_t
id|fs
suffix:semicolon
r_int
id|ret
suffix:semicolon
r_while
c_loop
(paren
l_int|1
)paren
(brace
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_XRUN
op_logical_or
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_SUSPENDED
)paren
(brace
id|ret
op_assign
id|snd_pcm_oss_prepare
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
OL
l_int|0
)paren
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|in_kernel
)paren
id|fs
op_assign
id|snd_enter_user
c_func
(paren
)paren
suffix:semicolon
id|ret
op_assign
id|snd_pcm_lib_write
c_func
(paren
id|substream
comma
id|ptr
comma
id|frames
)paren
suffix:semicolon
r_if
c_cond
(paren
id|in_kernel
)paren
id|snd_leave_user
c_func
(paren
id|fs
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
op_ne
op_minus
id|EPIPE
op_logical_and
id|ret
op_ne
op_minus
id|ESTRPIPE
)paren
r_break
suffix:semicolon
multiline_comment|/* test, if we can&squot;t store new data, because the stream */
multiline_comment|/* has not been started */
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_PREPARED
)paren
r_return
op_minus
id|EAGAIN
suffix:semicolon
)brace
r_return
id|ret
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_read3
id|snd_pcm_sframes_t
id|snd_pcm_oss_read3
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_char
op_star
id|ptr
comma
id|snd_pcm_uframes_t
id|frames
comma
r_int
id|in_kernel
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|mm_segment_t
id|fs
suffix:semicolon
r_int
id|ret
suffix:semicolon
r_while
c_loop
(paren
l_int|1
)paren
(brace
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_XRUN
op_logical_or
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_SUSPENDED
)paren
(brace
id|ret
op_assign
id|snd_pcm_kernel_ioctl
c_func
(paren
id|substream
comma
id|SNDRV_PCM_IOCTL_DRAIN
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
OL
l_int|0
)paren
r_break
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_SETUP
)paren
(brace
id|ret
op_assign
id|snd_pcm_oss_prepare
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
OL
l_int|0
)paren
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|in_kernel
)paren
id|fs
op_assign
id|snd_enter_user
c_func
(paren
)paren
suffix:semicolon
id|ret
op_assign
id|snd_pcm_lib_read
c_func
(paren
id|substream
comma
id|ptr
comma
id|frames
)paren
suffix:semicolon
r_if
c_cond
(paren
id|in_kernel
)paren
id|snd_leave_user
c_func
(paren
id|fs
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
op_ne
op_minus
id|EPIPE
op_logical_and
id|ret
op_ne
op_minus
id|ESTRPIPE
)paren
r_break
suffix:semicolon
)brace
r_return
id|ret
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_writev3
id|snd_pcm_sframes_t
id|snd_pcm_oss_writev3
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_void
op_star
op_star
id|bufs
comma
id|snd_pcm_uframes_t
id|frames
comma
r_int
id|in_kernel
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|mm_segment_t
id|fs
suffix:semicolon
r_int
id|ret
suffix:semicolon
r_while
c_loop
(paren
l_int|1
)paren
(brace
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_XRUN
op_logical_or
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_SUSPENDED
)paren
(brace
id|ret
op_assign
id|snd_pcm_oss_prepare
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
OL
l_int|0
)paren
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|in_kernel
)paren
id|fs
op_assign
id|snd_enter_user
c_func
(paren
)paren
suffix:semicolon
id|ret
op_assign
id|snd_pcm_lib_writev
c_func
(paren
id|substream
comma
id|bufs
comma
id|frames
)paren
suffix:semicolon
r_if
c_cond
(paren
id|in_kernel
)paren
id|snd_leave_user
c_func
(paren
id|fs
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
op_ne
op_minus
id|EPIPE
op_logical_and
id|ret
op_ne
op_minus
id|ESTRPIPE
)paren
r_break
suffix:semicolon
multiline_comment|/* test, if we can&squot;t store new data, because the stream */
multiline_comment|/* has not been started */
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_PREPARED
)paren
r_return
op_minus
id|EAGAIN
suffix:semicolon
)brace
r_return
id|ret
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_readv3
id|snd_pcm_sframes_t
id|snd_pcm_oss_readv3
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_void
op_star
op_star
id|bufs
comma
id|snd_pcm_uframes_t
id|frames
comma
r_int
id|in_kernel
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|mm_segment_t
id|fs
suffix:semicolon
r_int
id|ret
suffix:semicolon
r_while
c_loop
(paren
l_int|1
)paren
(brace
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_XRUN
op_logical_or
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_SUSPENDED
)paren
(brace
id|ret
op_assign
id|snd_pcm_kernel_ioctl
c_func
(paren
id|substream
comma
id|SNDRV_PCM_IOCTL_DRAIN
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
OL
l_int|0
)paren
r_break
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_SETUP
)paren
(brace
id|ret
op_assign
id|snd_pcm_oss_prepare
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
OL
l_int|0
)paren
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|in_kernel
)paren
id|fs
op_assign
id|snd_enter_user
c_func
(paren
)paren
suffix:semicolon
id|ret
op_assign
id|snd_pcm_lib_readv
c_func
(paren
id|substream
comma
id|bufs
comma
id|frames
)paren
suffix:semicolon
r_if
c_cond
(paren
id|in_kernel
)paren
id|snd_leave_user
c_func
(paren
id|fs
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
op_ne
op_minus
id|EPIPE
op_logical_and
id|ret
op_ne
op_minus
id|ESTRPIPE
)paren
r_break
suffix:semicolon
)brace
r_return
id|ret
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_write2
r_static
id|ssize_t
id|snd_pcm_oss_write2
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|bytes
comma
r_int
id|in_kernel
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_pcm_sframes_t
id|frames
comma
id|frames1
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;oss.plugin_first
)paren
(brace
id|snd_pcm_plugin_channel_t
op_star
id|channels
suffix:semicolon
r_int
id|oss_frame_bytes
op_assign
(paren
id|runtime-&gt;oss.plugin_first-&gt;src_width
op_star
id|runtime-&gt;oss.plugin_first-&gt;src_format.channels
)paren
op_div
l_int|8
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|in_kernel
)paren
(brace
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
id|runtime-&gt;oss.buffer
comma
id|buf
comma
id|bytes
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|buf
op_assign
id|runtime-&gt;oss.buffer
suffix:semicolon
)brace
id|frames
op_assign
id|bytes
op_div
id|oss_frame_bytes
suffix:semicolon
id|frames1
op_assign
id|snd_pcm_plug_client_channels_buf
c_func
(paren
id|substream
comma
(paren
r_char
op_star
)paren
id|buf
comma
id|frames
comma
op_amp
id|channels
)paren
suffix:semicolon
r_if
c_cond
(paren
id|frames1
OL
l_int|0
)paren
r_return
id|frames1
suffix:semicolon
id|frames1
op_assign
id|snd_pcm_plug_write_transfer
c_func
(paren
id|substream
comma
id|channels
comma
id|frames1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|frames1
op_le
l_int|0
)paren
r_return
id|frames1
suffix:semicolon
id|bytes
op_assign
id|frames1
op_star
id|oss_frame_bytes
suffix:semicolon
)brace
r_else
(brace
id|frames
op_assign
id|bytes_to_frames
c_func
(paren
id|runtime
comma
id|bytes
)paren
suffix:semicolon
id|frames1
op_assign
id|snd_pcm_oss_write3
c_func
(paren
id|substream
comma
id|buf
comma
id|frames
comma
id|in_kernel
)paren
suffix:semicolon
r_if
c_cond
(paren
id|frames1
op_le
l_int|0
)paren
r_return
id|frames1
suffix:semicolon
id|bytes
op_assign
id|frames_to_bytes
c_func
(paren
id|runtime
comma
id|frames1
)paren
suffix:semicolon
)brace
r_return
id|bytes
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_write1
r_static
id|ssize_t
id|snd_pcm_oss_write1
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|bytes
)paren
(brace
r_int
id|xfer
op_assign
l_int|0
suffix:semicolon
id|ssize_t
id|tmp
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|runtime-&gt;mmap_count
)paren
)paren
r_return
op_minus
id|ENXIO
suffix:semicolon
r_if
c_cond
(paren
(paren
id|tmp
op_assign
id|snd_pcm_oss_make_ready
c_func
(paren
id|substream
)paren
)paren
OL
l_int|0
)paren
r_return
id|tmp
suffix:semicolon
r_while
c_loop
(paren
id|bytes
OG
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|bytes
template_param
l_int|0
)paren
(brace
id|tmp
op_assign
id|bytes
suffix:semicolon
r_if
c_cond
(paren
id|tmp
op_plus
id|runtime-&gt;oss.buffer_used
OG
id|runtime-&gt;oss.period_bytes
)paren
id|tmp
op_assign
id|runtime-&gt;oss.period_bytes
op_minus
id|runtime-&gt;oss.buffer_used
suffix:semicolon
r_if
c_cond
(paren
id|tmp
OG
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
id|runtime-&gt;oss.buffer
op_plus
id|runtime-&gt;oss.buffer_used
comma
id|buf
comma
id|tmp
)paren
)paren
r_return
id|xfer
OG
l_int|0
ques
c_cond
id|xfer
suffix:colon
op_minus
id|EFAULT
suffix:semicolon
)brace
id|runtime-&gt;oss.buffer_used
op_add_assign
id|tmp
suffix:semicolon
id|buf
op_add_assign
id|tmp
suffix:semicolon
id|bytes
op_sub_assign
id|tmp
suffix:semicolon
id|xfer
op_add_assign
id|tmp
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;oss.buffer_used
op_eq
id|runtime-&gt;oss.period_bytes
)paren
(brace
id|tmp
op_assign
id|snd_pcm_oss_write2
c_func
(paren
id|substream
comma
id|runtime-&gt;oss.buffer
comma
id|runtime-&gt;oss.period_bytes
comma
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tmp
op_le
l_int|0
)paren
r_return
id|xfer
OG
l_int|0
ques
c_cond
id|xfer
suffix:colon
id|tmp
suffix:semicolon
id|runtime-&gt;oss.bytes
op_add_assign
id|tmp
suffix:semicolon
id|runtime-&gt;oss.buffer_used
op_assign
l_int|0
suffix:semicolon
)brace
)brace
r_else
(brace
id|tmp
op_assign
id|snd_pcm_oss_write2
c_func
(paren
id|substream
comma
(paren
r_char
op_star
)paren
id|buf
comma
id|runtime-&gt;oss.period_bytes
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tmp
op_le
l_int|0
)paren
r_return
id|xfer
OG
l_int|0
ques
c_cond
id|xfer
suffix:colon
id|tmp
suffix:semicolon
id|runtime-&gt;oss.bytes
op_add_assign
id|tmp
suffix:semicolon
id|buf
op_add_assign
id|tmp
suffix:semicolon
id|bytes
op_sub_assign
id|tmp
suffix:semicolon
id|xfer
op_add_assign
id|tmp
suffix:semicolon
)brace
)brace
r_return
id|xfer
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_read2
r_static
id|ssize_t
id|snd_pcm_oss_read2
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_char
op_star
id|buf
comma
r_int
id|bytes
comma
r_int
id|in_kernel
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_pcm_sframes_t
id|frames
comma
id|frames1
suffix:semicolon
r_char
op_star
id|final_dst
op_assign
id|buf
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;oss.plugin_first
)paren
(brace
id|snd_pcm_plugin_channel_t
op_star
id|channels
suffix:semicolon
r_int
id|oss_frame_bytes
op_assign
(paren
id|runtime-&gt;oss.plugin_last-&gt;dst_width
op_star
id|runtime-&gt;oss.plugin_last-&gt;dst_format.channels
)paren
op_div
l_int|8
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|in_kernel
)paren
id|buf
op_assign
id|runtime-&gt;oss.buffer
suffix:semicolon
id|frames
op_assign
id|bytes
op_div
id|oss_frame_bytes
suffix:semicolon
id|frames1
op_assign
id|snd_pcm_plug_client_channels_buf
c_func
(paren
id|substream
comma
id|buf
comma
id|frames
comma
op_amp
id|channels
)paren
suffix:semicolon
r_if
c_cond
(paren
id|frames1
OL
l_int|0
)paren
r_return
id|frames1
suffix:semicolon
id|frames1
op_assign
id|snd_pcm_plug_read_transfer
c_func
(paren
id|substream
comma
id|channels
comma
id|frames1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|frames1
op_le
l_int|0
)paren
r_return
id|frames1
suffix:semicolon
id|bytes
op_assign
id|frames1
op_star
id|oss_frame_bytes
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|in_kernel
op_logical_and
id|copy_to_user
c_func
(paren
id|final_dst
comma
id|buf
comma
id|bytes
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
r_else
(brace
id|frames
op_assign
id|bytes_to_frames
c_func
(paren
id|runtime
comma
id|bytes
)paren
suffix:semicolon
id|frames1
op_assign
id|snd_pcm_oss_read3
c_func
(paren
id|substream
comma
id|buf
comma
id|frames
comma
id|in_kernel
)paren
suffix:semicolon
r_if
c_cond
(paren
id|frames1
op_le
l_int|0
)paren
r_return
id|frames1
suffix:semicolon
id|bytes
op_assign
id|frames_to_bytes
c_func
(paren
id|runtime
comma
id|frames1
)paren
suffix:semicolon
)brace
r_return
id|bytes
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_read1
r_static
id|ssize_t
id|snd_pcm_oss_read1
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_char
op_star
id|buf
comma
r_int
id|bytes
)paren
(brace
r_int
id|xfer
op_assign
l_int|0
suffix:semicolon
id|ssize_t
id|tmp
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|runtime-&gt;mmap_count
)paren
)paren
r_return
op_minus
id|ENXIO
suffix:semicolon
r_if
c_cond
(paren
(paren
id|tmp
op_assign
id|snd_pcm_oss_make_ready
c_func
(paren
id|substream
)paren
)paren
OL
l_int|0
)paren
r_return
id|tmp
suffix:semicolon
r_while
c_loop
(paren
id|bytes
OG
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|bytes
template_param
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|runtime-&gt;oss.buffer_used
op_eq
l_int|0
)paren
(brace
id|tmp
op_assign
id|snd_pcm_oss_read2
c_func
(paren
id|substream
comma
id|runtime-&gt;oss.buffer
comma
id|runtime-&gt;oss.period_bytes
comma
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tmp
op_le
l_int|0
)paren
r_return
id|xfer
OG
l_int|0
ques
c_cond
id|xfer
suffix:colon
id|tmp
suffix:semicolon
id|runtime-&gt;oss.bytes
op_add_assign
id|tmp
suffix:semicolon
id|runtime-&gt;oss.buffer_used
op_assign
id|runtime-&gt;oss.period_bytes
suffix:semicolon
)brace
id|tmp
op_assign
id|bytes
suffix:semicolon
r_if
c_cond
(paren
(paren
r_int
)paren
id|tmp
OG
id|runtime-&gt;oss.buffer_used
)paren
id|tmp
op_assign
id|runtime-&gt;oss.buffer_used
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|buf
comma
id|runtime-&gt;oss.buffer
op_plus
(paren
id|runtime-&gt;oss.period_bytes
op_minus
id|runtime-&gt;oss.buffer_used
)paren
comma
id|tmp
)paren
)paren
r_return
id|xfer
OG
l_int|0
ques
c_cond
id|xfer
suffix:colon
op_minus
id|EFAULT
suffix:semicolon
id|buf
op_add_assign
id|tmp
suffix:semicolon
id|bytes
op_sub_assign
id|tmp
suffix:semicolon
id|xfer
op_add_assign
id|tmp
suffix:semicolon
id|runtime-&gt;oss.buffer_used
op_sub_assign
id|tmp
suffix:semicolon
)brace
r_else
(brace
id|tmp
op_assign
id|snd_pcm_oss_read2
c_func
(paren
id|substream
comma
(paren
r_char
op_star
)paren
id|buf
comma
id|runtime-&gt;oss.period_bytes
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tmp
op_le
l_int|0
)paren
r_return
id|xfer
OG
l_int|0
ques
c_cond
id|xfer
suffix:colon
id|tmp
suffix:semicolon
id|runtime-&gt;oss.bytes
op_add_assign
id|tmp
suffix:semicolon
id|buf
op_add_assign
id|tmp
suffix:semicolon
id|bytes
op_sub_assign
id|tmp
suffix:semicolon
id|xfer
op_add_assign
id|tmp
suffix:semicolon
)brace
)brace
r_return
id|xfer
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_reset
r_static
r_int
id|snd_pcm_oss_reset
c_func
(paren
id|snd_pcm_oss_file_t
op_star
id|pcm_oss_file
)paren
(brace
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
id|substream
op_assign
id|pcm_oss_file-&gt;streams
(braket
id|SNDRV_PCM_STREAM_PLAYBACK
)braket
suffix:semicolon
r_if
c_cond
(paren
id|substream
op_ne
l_int|NULL
)paren
(brace
id|snd_pcm_kernel_playback_ioctl
c_func
(paren
id|substream
comma
id|SNDRV_PCM_IOCTL_DROP
comma
l_int|0
)paren
suffix:semicolon
id|substream-&gt;runtime-&gt;oss.prepare
op_assign
l_int|1
suffix:semicolon
)brace
id|substream
op_assign
id|pcm_oss_file-&gt;streams
(braket
id|SNDRV_PCM_STREAM_CAPTURE
)braket
suffix:semicolon
r_if
c_cond
(paren
id|substream
op_ne
l_int|NULL
)paren
(brace
id|snd_pcm_kernel_capture_ioctl
c_func
(paren
id|substream
comma
id|SNDRV_PCM_IOCTL_DROP
comma
l_int|0
)paren
suffix:semicolon
id|substream-&gt;runtime-&gt;oss.prepare
op_assign
l_int|1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_sync
r_static
r_int
id|snd_pcm_oss_sync
c_func
(paren
id|snd_pcm_oss_file_t
op_star
id|pcm_oss_file
)paren
(brace
r_int
id|err
op_assign
l_int|0
suffix:semicolon
r_int
r_int
id|saved_f_flags
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
id|ssize_t
id|result
suffix:semicolon
id|wait_queue_t
id|wait
suffix:semicolon
id|substream
op_assign
id|pcm_oss_file-&gt;streams
(braket
id|SNDRV_PCM_STREAM_PLAYBACK
)braket
suffix:semicolon
r_if
c_cond
(paren
id|substream
op_ne
l_int|NULL
)paren
(brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_pcm_oss_make_ready
c_func
(paren
id|substream
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;oss.buffer_used
OG
l_int|0
)paren
(brace
id|snd_pcm_format_set_silence
c_func
(paren
id|runtime-&gt;format
comma
id|runtime-&gt;oss.buffer
op_plus
id|runtime-&gt;oss.buffer_used
comma
id|bytes_to_samples
c_func
(paren
id|runtime
comma
id|runtime-&gt;oss.period_bytes
op_minus
id|runtime-&gt;oss.buffer_used
)paren
)paren
suffix:semicolon
id|init_waitqueue_entry
c_func
(paren
op_amp
id|wait
comma
id|current
)paren
suffix:semicolon
id|add_wait_queue
c_func
(paren
op_amp
id|runtime-&gt;sleep
comma
op_amp
id|wait
)paren
suffix:semicolon
r_while
c_loop
(paren
l_int|1
)paren
(brace
id|result
op_assign
id|snd_pcm_oss_write2
c_func
(paren
id|substream
comma
id|runtime-&gt;oss.buffer
comma
id|runtime-&gt;oss.period_bytes
comma
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
OG
l_int|0
)paren
(brace
id|runtime-&gt;oss.buffer_used
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|result
op_ne
l_int|0
op_logical_and
id|result
op_ne
op_minus
id|EAGAIN
)paren
r_break
suffix:semicolon
id|set_current_state
c_func
(paren
id|TASK_INTERRUPTIBLE
)paren
suffix:semicolon
id|schedule
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|signal_pending
c_func
(paren
id|current
)paren
)paren
(brace
id|result
op_assign
op_minus
id|ERESTARTSYS
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
id|set_current_state
c_func
(paren
id|TASK_RUNNING
)paren
suffix:semicolon
id|remove_wait_queue
c_func
(paren
op_amp
id|runtime-&gt;sleep
comma
op_amp
id|wait
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
OL
l_int|0
)paren
r_return
id|result
suffix:semicolon
)brace
id|saved_f_flags
op_assign
id|substream-&gt;ffile-&gt;f_flags
suffix:semicolon
id|substream-&gt;ffile-&gt;f_flags
op_and_assign
op_complement
id|O_NONBLOCK
suffix:semicolon
id|err
op_assign
id|snd_pcm_kernel_playback_ioctl
c_func
(paren
id|substream
comma
id|SNDRV_PCM_IOCTL_DRAIN
comma
l_int|0
)paren
suffix:semicolon
id|substream-&gt;ffile-&gt;f_flags
op_assign
id|saved_f_flags
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|runtime-&gt;oss.prepare
op_assign
l_int|1
suffix:semicolon
)brace
id|substream
op_assign
id|pcm_oss_file-&gt;streams
(braket
id|SNDRV_PCM_STREAM_CAPTURE
)braket
suffix:semicolon
r_if
c_cond
(paren
id|substream
op_ne
l_int|NULL
)paren
(brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_pcm_oss_make_ready
c_func
(paren
id|substream
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|err
op_assign
id|snd_pcm_kernel_capture_ioctl
c_func
(paren
id|substream
comma
id|SNDRV_PCM_IOCTL_DROP
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|runtime-&gt;oss.buffer_used
op_assign
l_int|0
suffix:semicolon
id|runtime-&gt;oss.prepare
op_assign
l_int|1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_set_rate
r_static
r_int
id|snd_pcm_oss_set_rate
c_func
(paren
id|snd_pcm_oss_file_t
op_star
id|pcm_oss_file
comma
r_int
id|rate
)paren
(brace
r_int
id|idx
suffix:semicolon
r_for
c_loop
(paren
id|idx
op_assign
l_int|1
suffix:semicolon
id|idx
op_ge
l_int|0
suffix:semicolon
op_decrement
id|idx
)paren
(brace
id|snd_pcm_substream_t
op_star
id|substream
op_assign
id|pcm_oss_file-&gt;streams
(braket
id|idx
)braket
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_if
c_cond
(paren
id|substream
op_eq
l_int|NULL
)paren
r_continue
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|rate
OL
l_int|1000
)paren
id|rate
op_assign
l_int|1000
suffix:semicolon
r_else
r_if
c_cond
(paren
id|rate
OG
l_int|48000
)paren
id|rate
op_assign
l_int|48000
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;oss.rate
op_ne
id|rate
)paren
(brace
id|runtime-&gt;oss.params
op_assign
l_int|1
suffix:semicolon
id|runtime-&gt;oss.rate
op_assign
id|rate
suffix:semicolon
)brace
)brace
r_return
id|snd_pcm_oss_get_rate
c_func
(paren
id|pcm_oss_file
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_get_rate
r_static
r_int
id|snd_pcm_oss_get_rate
c_func
(paren
id|snd_pcm_oss_file_t
op_star
id|pcm_oss_file
)paren
(brace
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_pcm_oss_get_active_substream
c_func
(paren
id|pcm_oss_file
comma
op_amp
id|substream
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_return
id|substream-&gt;runtime-&gt;oss.rate
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_set_channels
r_static
r_int
id|snd_pcm_oss_set_channels
c_func
(paren
id|snd_pcm_oss_file_t
op_star
id|pcm_oss_file
comma
r_int
id|channels
)paren
(brace
r_int
id|idx
suffix:semicolon
r_if
c_cond
(paren
id|channels
OL
l_int|1
)paren
id|channels
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|channels
OG
l_int|128
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_for
c_loop
(paren
id|idx
op_assign
l_int|1
suffix:semicolon
id|idx
op_ge
l_int|0
suffix:semicolon
op_decrement
id|idx
)paren
(brace
id|snd_pcm_substream_t
op_star
id|substream
op_assign
id|pcm_oss_file-&gt;streams
(braket
id|idx
)braket
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_if
c_cond
(paren
id|substream
op_eq
l_int|NULL
)paren
r_continue
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;oss.channels
op_ne
id|channels
)paren
(brace
id|runtime-&gt;oss.params
op_assign
l_int|1
suffix:semicolon
id|runtime-&gt;oss.channels
op_assign
id|channels
suffix:semicolon
)brace
)brace
r_return
id|snd_pcm_oss_get_channels
c_func
(paren
id|pcm_oss_file
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_get_channels
r_static
r_int
id|snd_pcm_oss_get_channels
c_func
(paren
id|snd_pcm_oss_file_t
op_star
id|pcm_oss_file
)paren
(brace
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_pcm_oss_get_active_substream
c_func
(paren
id|pcm_oss_file
comma
op_amp
id|substream
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_return
id|substream-&gt;runtime-&gt;oss.channels
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_get_block_size
r_static
r_int
id|snd_pcm_oss_get_block_size
c_func
(paren
id|snd_pcm_oss_file_t
op_star
id|pcm_oss_file
)paren
(brace
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_pcm_oss_get_active_substream
c_func
(paren
id|pcm_oss_file
comma
op_amp
id|substream
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_return
id|substream-&gt;runtime-&gt;oss.period_bytes
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_get_formats
r_static
r_int
id|snd_pcm_oss_get_formats
c_func
(paren
id|snd_pcm_oss_file_t
op_star
id|pcm_oss_file
)paren
(brace
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
r_int
id|err
suffix:semicolon
r_int
id|direct
suffix:semicolon
id|snd_pcm_hw_params_t
id|params
suffix:semicolon
r_int
r_int
id|formats
op_assign
l_int|0
suffix:semicolon
r_int
r_int
id|format_mask
suffix:semicolon
r_int
id|fmt
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_pcm_oss_get_active_substream
c_func
(paren
id|pcm_oss_file
comma
op_amp
id|substream
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|substream-&gt;runtime-&gt;mmap_count
)paren
)paren
(brace
id|direct
op_assign
l_int|1
suffix:semicolon
)brace
r_else
(brace
id|snd_pcm_oss_setup_t
op_star
id|setup
op_assign
id|substream-&gt;oss.setup
suffix:semicolon
id|direct
op_assign
(paren
id|setup
op_ne
l_int|NULL
op_logical_and
id|setup-&gt;direct
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|direct
)paren
r_return
id|AFMT_MU_LAW
op_or
id|AFMT_U8
op_or
id|AFMT_S16_LE
op_or
id|AFMT_S16_BE
op_or
id|AFMT_S8
op_or
id|AFMT_U16_LE
op_or
id|AFMT_U16_BE
suffix:semicolon
id|_snd_pcm_hw_params_any
c_func
(paren
op_amp
id|params
)paren
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_refine
c_func
(paren
id|substream
comma
op_amp
id|params
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|err
op_ge
l_int|0
comma
r_return
id|err
)paren
suffix:semicolon
id|format_mask
op_assign
op_star
id|hw_param_mask
c_func
(paren
op_amp
id|params
comma
id|SNDRV_PCM_HW_PARAM_FORMAT
)paren
suffix:semicolon
r_for
c_loop
(paren
id|fmt
op_assign
l_int|0
suffix:semicolon
id|fmt
OL
l_int|32
suffix:semicolon
op_increment
id|fmt
)paren
(brace
r_if
c_cond
(paren
id|format_mask
op_amp
(paren
l_int|1
op_lshift
id|fmt
)paren
)paren
(brace
r_int
id|f
op_assign
id|snd_pcm_oss_format_to
c_func
(paren
id|fmt
)paren
suffix:semicolon
r_if
c_cond
(paren
id|f
op_ge
l_int|0
)paren
id|formats
op_or_assign
id|f
suffix:semicolon
)brace
)brace
r_return
id|formats
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_set_format
r_static
r_int
id|snd_pcm_oss_set_format
c_func
(paren
id|snd_pcm_oss_file_t
op_star
id|pcm_oss_file
comma
r_int
id|format
)paren
(brace
r_int
id|formats
comma
id|idx
suffix:semicolon
r_if
c_cond
(paren
id|format
op_ne
id|AFMT_QUERY
)paren
(brace
id|formats
op_assign
id|snd_pcm_oss_get_formats
c_func
(paren
id|pcm_oss_file
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|formats
op_amp
id|format
)paren
)paren
id|format
op_assign
id|AFMT_U8
suffix:semicolon
r_for
c_loop
(paren
id|idx
op_assign
l_int|1
suffix:semicolon
id|idx
op_ge
l_int|0
suffix:semicolon
op_decrement
id|idx
)paren
(brace
id|snd_pcm_substream_t
op_star
id|substream
op_assign
id|pcm_oss_file-&gt;streams
(braket
id|idx
)braket
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_if
c_cond
(paren
id|substream
op_eq
l_int|NULL
)paren
r_continue
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;oss.format
op_ne
id|format
)paren
(brace
id|runtime-&gt;oss.params
op_assign
l_int|1
suffix:semicolon
id|runtime-&gt;oss.format
op_assign
id|format
suffix:semicolon
)brace
)brace
)brace
r_return
id|snd_pcm_oss_get_format
c_func
(paren
id|pcm_oss_file
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_get_format
r_static
r_int
id|snd_pcm_oss_get_format
c_func
(paren
id|snd_pcm_oss_file_t
op_star
id|pcm_oss_file
)paren
(brace
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_pcm_oss_get_active_substream
c_func
(paren
id|pcm_oss_file
comma
op_amp
id|substream
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_return
id|substream-&gt;runtime-&gt;oss.format
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_set_subdivide1
r_static
r_int
id|snd_pcm_oss_set_subdivide1
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|subdivide
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_if
c_cond
(paren
id|substream
op_eq
l_int|NULL
)paren
r_return
l_int|0
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|subdivide
op_eq
l_int|0
)paren
(brace
id|subdivide
op_assign
id|runtime-&gt;oss.subdivision
suffix:semicolon
r_if
c_cond
(paren
id|subdivide
op_eq
l_int|0
)paren
id|subdivide
op_assign
l_int|1
suffix:semicolon
r_return
id|subdivide
suffix:semicolon
)brace
r_if
c_cond
(paren
id|runtime-&gt;oss.subdivision
op_logical_or
id|runtime-&gt;oss.fragshift
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|subdivide
op_ne
l_int|1
op_logical_and
id|subdivide
op_ne
l_int|2
op_logical_and
id|subdivide
op_ne
l_int|4
op_logical_and
id|subdivide
op_ne
l_int|8
op_logical_and
id|subdivide
op_ne
l_int|16
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|runtime-&gt;oss.subdivision
op_assign
id|subdivide
suffix:semicolon
id|runtime-&gt;oss.params
op_assign
l_int|1
suffix:semicolon
r_return
id|subdivide
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_set_subdivide
r_static
r_int
id|snd_pcm_oss_set_subdivide
c_func
(paren
id|snd_pcm_oss_file_t
op_star
id|pcm_oss_file
comma
r_int
id|subdivide
)paren
(brace
r_int
id|err
op_assign
op_minus
id|EINVAL
comma
id|idx
suffix:semicolon
r_for
c_loop
(paren
id|idx
op_assign
l_int|1
suffix:semicolon
id|idx
op_ge
l_int|0
suffix:semicolon
op_decrement
id|idx
)paren
(brace
id|snd_pcm_substream_t
op_star
id|substream
op_assign
id|pcm_oss_file-&gt;streams
(braket
id|idx
)braket
suffix:semicolon
r_if
c_cond
(paren
id|substream
op_eq
l_int|NULL
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_pcm_oss_set_subdivide1
c_func
(paren
id|substream
comma
id|subdivide
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
r_return
id|err
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_set_fragment1
r_static
r_int
id|snd_pcm_oss_set_fragment1
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
r_int
id|val
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_if
c_cond
(paren
id|substream
op_eq
l_int|NULL
)paren
r_return
l_int|0
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;oss.subdivision
op_logical_or
id|runtime-&gt;oss.fragshift
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|runtime-&gt;oss.fragshift
op_assign
id|val
op_amp
l_int|0xffff
suffix:semicolon
id|runtime-&gt;oss.maxfrags
op_assign
(paren
id|val
op_rshift
l_int|16
)paren
op_amp
l_int|0xffff
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;oss.fragshift
OL
l_int|4
)paren
multiline_comment|/* &lt; 16 */
id|runtime-&gt;oss.fragshift
op_assign
l_int|4
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;oss.maxfrags
OL
l_int|2
)paren
id|runtime-&gt;oss.maxfrags
op_assign
l_int|2
suffix:semicolon
id|runtime-&gt;oss.params
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_set_fragment
r_static
r_int
id|snd_pcm_oss_set_fragment
c_func
(paren
id|snd_pcm_oss_file_t
op_star
id|pcm_oss_file
comma
r_int
r_int
id|val
)paren
(brace
r_int
id|err
op_assign
op_minus
id|EINVAL
comma
id|idx
suffix:semicolon
r_for
c_loop
(paren
id|idx
op_assign
l_int|1
suffix:semicolon
id|idx
op_ge
l_int|0
suffix:semicolon
op_decrement
id|idx
)paren
(brace
id|snd_pcm_substream_t
op_star
id|substream
op_assign
id|pcm_oss_file-&gt;streams
(braket
id|idx
)braket
suffix:semicolon
r_if
c_cond
(paren
id|substream
op_eq
l_int|NULL
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_pcm_oss_set_fragment1
c_func
(paren
id|substream
comma
id|val
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
r_return
id|err
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_nonblock
r_static
r_int
id|snd_pcm_oss_nonblock
c_func
(paren
r_struct
id|file
op_star
id|file
)paren
(brace
id|file-&gt;f_flags
op_or_assign
id|O_NONBLOCK
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_get_caps1
r_static
r_int
id|snd_pcm_oss_get_caps1
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|res
)paren
(brace
r_if
c_cond
(paren
id|substream
op_eq
l_int|NULL
)paren
(brace
id|res
op_and_assign
op_complement
id|DSP_CAP_DUPLEX
suffix:semicolon
r_return
id|res
suffix:semicolon
)brace
macro_line|#ifdef DSP_CAP_MULTI
r_if
c_cond
(paren
id|substream-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_PLAYBACK
)paren
r_if
c_cond
(paren
id|substream-&gt;pstr-&gt;substream_count
OG
l_int|1
)paren
id|res
op_or_assign
id|DSP_CAP_MULTI
suffix:semicolon
macro_line|#endif
multiline_comment|/* DSP_CAP_REALTIME is set all times: */
multiline_comment|/* all ALSA drivers can return actual pointer in ring buffer */
macro_line|#if defined(DSP_CAP_REALTIME) &amp;&amp; 0
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;info
op_amp
(paren
id|SNDRV_PCM_INFO_BLOCK_TRANSFER
op_or
id|SNDRV_PCM_INFO_BATCH
)paren
)paren
id|res
op_and_assign
op_complement
id|DSP_CAP_REALTIME
suffix:semicolon
)brace
macro_line|#endif
r_return
id|res
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_get_caps
r_static
r_int
id|snd_pcm_oss_get_caps
c_func
(paren
id|snd_pcm_oss_file_t
op_star
id|pcm_oss_file
)paren
(brace
r_int
id|result
comma
id|idx
suffix:semicolon
id|result
op_assign
id|DSP_CAP_TRIGGER
op_or
id|DSP_CAP_MMAP
op_or
id|DSP_CAP_DUPLEX
op_or
id|DSP_CAP_REALTIME
suffix:semicolon
r_for
c_loop
(paren
id|idx
op_assign
l_int|0
suffix:semicolon
id|idx
OL
l_int|2
suffix:semicolon
id|idx
op_increment
)paren
(brace
id|snd_pcm_substream_t
op_star
id|substream
op_assign
id|pcm_oss_file-&gt;streams
(braket
id|idx
)braket
suffix:semicolon
id|result
op_assign
id|snd_pcm_oss_get_caps1
c_func
(paren
id|substream
comma
id|result
)paren
suffix:semicolon
)brace
id|result
op_or_assign
l_int|0x0001
suffix:semicolon
multiline_comment|/* revision - same as SB AWE 64 */
r_return
id|result
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_simulate_fill
r_static
r_void
id|snd_pcm_oss_simulate_fill
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_pcm_uframes_t
id|appl_ptr
suffix:semicolon
id|appl_ptr
op_assign
id|runtime-&gt;hw_ptr_interrupt
op_plus
id|runtime-&gt;buffer_size
suffix:semicolon
id|appl_ptr
op_mod_assign
id|runtime-&gt;boundary
suffix:semicolon
id|runtime-&gt;control-&gt;appl_ptr
op_assign
id|appl_ptr
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_set_trigger
r_static
r_int
id|snd_pcm_oss_set_trigger
c_func
(paren
id|snd_pcm_oss_file_t
op_star
id|pcm_oss_file
comma
r_int
id|trigger
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|psubstream
op_assign
l_int|NULL
comma
op_star
id|csubstream
op_assign
l_int|NULL
suffix:semicolon
r_int
id|err
comma
id|cmd
suffix:semicolon
id|psubstream
op_assign
id|pcm_oss_file-&gt;streams
(braket
id|SNDRV_PCM_STREAM_PLAYBACK
)braket
suffix:semicolon
id|csubstream
op_assign
id|pcm_oss_file-&gt;streams
(braket
id|SNDRV_PCM_STREAM_CAPTURE
)braket
suffix:semicolon
r_if
c_cond
(paren
id|psubstream
)paren
(brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_pcm_oss_make_ready
c_func
(paren
id|psubstream
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|psubstream-&gt;runtime-&gt;mmap_count
)paren
)paren
id|snd_pcm_oss_simulate_fill
c_func
(paren
id|psubstream
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|csubstream
)paren
(brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_pcm_oss_make_ready
c_func
(paren
id|csubstream
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
r_if
c_cond
(paren
id|psubstream
)paren
(brace
id|runtime
op_assign
id|psubstream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|trigger
op_amp
id|PCM_ENABLE_OUTPUT
)paren
(brace
r_if
c_cond
(paren
id|runtime-&gt;oss.trigger
)paren
r_goto
id|_skip1
suffix:semicolon
id|runtime-&gt;oss.trigger
op_assign
l_int|1
suffix:semicolon
id|runtime-&gt;start_threshold
op_assign
l_int|1
suffix:semicolon
id|cmd
op_assign
id|SNDRV_PCM_IOCTL_START
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
op_logical_neg
id|runtime-&gt;oss.trigger
)paren
r_goto
id|_skip1
suffix:semicolon
id|runtime-&gt;oss.trigger
op_assign
l_int|0
suffix:semicolon
id|runtime-&gt;start_threshold
op_assign
id|runtime-&gt;boundary
suffix:semicolon
id|cmd
op_assign
id|SNDRV_PCM_IOCTL_DROP
suffix:semicolon
id|runtime-&gt;oss.prepare
op_assign
l_int|1
suffix:semicolon
)brace
id|err
op_assign
id|snd_pcm_kernel_playback_ioctl
c_func
(paren
id|psubstream
comma
id|cmd
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
id|_skip1
suffix:colon
r_if
c_cond
(paren
id|csubstream
)paren
(brace
id|runtime
op_assign
id|csubstream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|trigger
op_amp
id|PCM_ENABLE_INPUT
)paren
(brace
r_if
c_cond
(paren
id|runtime-&gt;oss.trigger
)paren
r_goto
id|_skip2
suffix:semicolon
id|runtime-&gt;oss.trigger
op_assign
l_int|1
suffix:semicolon
id|runtime-&gt;start_threshold
op_assign
l_int|1
suffix:semicolon
id|cmd
op_assign
id|SNDRV_PCM_IOCTL_START
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
op_logical_neg
id|runtime-&gt;oss.trigger
)paren
r_goto
id|_skip2
suffix:semicolon
id|runtime-&gt;oss.trigger
op_assign
l_int|0
suffix:semicolon
id|runtime-&gt;start_threshold
op_assign
id|runtime-&gt;boundary
suffix:semicolon
id|cmd
op_assign
id|SNDRV_PCM_IOCTL_DROP
suffix:semicolon
id|runtime-&gt;oss.prepare
op_assign
l_int|1
suffix:semicolon
)brace
id|err
op_assign
id|snd_pcm_kernel_capture_ioctl
c_func
(paren
id|csubstream
comma
id|cmd
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
id|_skip2
suffix:colon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_get_trigger
r_static
r_int
id|snd_pcm_oss_get_trigger
c_func
(paren
id|snd_pcm_oss_file_t
op_star
id|pcm_oss_file
)paren
(brace
id|snd_pcm_substream_t
op_star
id|psubstream
op_assign
l_int|NULL
comma
op_star
id|csubstream
op_assign
l_int|NULL
suffix:semicolon
r_int
id|result
op_assign
l_int|0
suffix:semicolon
id|psubstream
op_assign
id|pcm_oss_file-&gt;streams
(braket
id|SNDRV_PCM_STREAM_PLAYBACK
)braket
suffix:semicolon
id|csubstream
op_assign
id|pcm_oss_file-&gt;streams
(braket
id|SNDRV_PCM_STREAM_CAPTURE
)braket
suffix:semicolon
r_if
c_cond
(paren
id|psubstream
op_logical_and
id|psubstream-&gt;runtime
op_logical_and
id|psubstream-&gt;runtime-&gt;oss.trigger
)paren
id|result
op_or_assign
id|PCM_ENABLE_OUTPUT
suffix:semicolon
r_if
c_cond
(paren
id|csubstream
op_logical_and
id|csubstream-&gt;runtime
op_logical_and
id|csubstream-&gt;runtime-&gt;oss.trigger
)paren
id|result
op_or_assign
id|PCM_ENABLE_INPUT
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_get_odelay
r_static
r_int
id|snd_pcm_oss_get_odelay
c_func
(paren
id|snd_pcm_oss_file_t
op_star
id|pcm_oss_file
)paren
(brace
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
id|snd_pcm_sframes_t
id|delay
suffix:semicolon
r_int
id|err
suffix:semicolon
id|substream
op_assign
id|pcm_oss_file-&gt;streams
(braket
id|SNDRV_PCM_STREAM_PLAYBACK
)braket
suffix:semicolon
r_if
c_cond
(paren
id|substream
op_eq
l_int|NULL
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_pcm_oss_make_ready
c_func
(paren
id|substream
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;oss.params
op_logical_or
id|runtime-&gt;oss.prepare
)paren
r_return
l_int|0
suffix:semicolon
id|err
op_assign
id|snd_pcm_kernel_playback_ioctl
c_func
(paren
id|substream
comma
id|SNDRV_PCM_IOCTL_DELAY
comma
op_amp
id|delay
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_return
id|snd_pcm_oss_bytes
c_func
(paren
id|substream
comma
id|delay
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_get_ptr
r_static
r_int
id|snd_pcm_oss_get_ptr
c_func
(paren
id|snd_pcm_oss_file_t
op_star
id|pcm_oss_file
comma
r_int
id|stream
comma
r_struct
id|count_info
op_star
id|_info
)paren
(brace
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
id|snd_pcm_status_t
id|status
suffix:semicolon
r_struct
id|count_info
id|info
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
id|_info
op_eq
l_int|NULL
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|substream
op_assign
id|pcm_oss_file-&gt;streams
(braket
id|stream
)braket
suffix:semicolon
r_if
c_cond
(paren
id|substream
op_eq
l_int|NULL
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_pcm_oss_make_ready
c_func
(paren
id|substream
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;oss.params
op_logical_or
id|runtime-&gt;oss.prepare
)paren
(brace
id|memset
c_func
(paren
op_amp
id|info
comma
l_int|0
comma
r_sizeof
(paren
id|info
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|_info
comma
op_amp
id|info
comma
r_sizeof
(paren
id|info
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|memset
c_func
(paren
op_amp
id|status
comma
l_int|0
comma
r_sizeof
(paren
id|status
)paren
)paren
suffix:semicolon
id|err
op_assign
id|snd_pcm_kernel_ioctl
c_func
(paren
id|substream
comma
id|SNDRV_PCM_IOCTL_STATUS
comma
op_amp
id|status
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_if
c_cond
(paren
id|stream
op_eq
id|SNDRV_PCM_STREAM_PLAYBACK
)paren
(brace
id|info.bytes
op_assign
id|runtime-&gt;oss.bytes
op_minus
id|snd_pcm_oss_bytes
c_func
(paren
id|substream
comma
id|runtime-&gt;buffer_size
op_minus
id|status.avail
)paren
suffix:semicolon
)brace
r_else
(brace
id|info.bytes
op_assign
id|runtime-&gt;oss.bytes
op_plus
id|snd_pcm_oss_bytes
c_func
(paren
id|substream
comma
id|status.avail
)paren
suffix:semicolon
)brace
id|info.ptr
op_assign
id|snd_pcm_oss_bytes
c_func
(paren
id|substream
comma
id|runtime-&gt;status-&gt;hw_ptr
op_mod
id|runtime-&gt;buffer_size
)paren
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|runtime-&gt;mmap_count
)paren
)paren
(brace
id|snd_pcm_sframes_t
id|n
suffix:semicolon
id|n
op_assign
id|runtime-&gt;hw_ptr_interrupt
op_minus
id|runtime-&gt;oss.prev_hw_ptr_interrupt
suffix:semicolon
r_if
c_cond
(paren
id|n
OL
l_int|0
)paren
id|n
op_add_assign
id|runtime-&gt;boundary
suffix:semicolon
id|info.blocks
op_assign
id|n
op_div
id|runtime-&gt;period_size
suffix:semicolon
id|runtime-&gt;oss.prev_hw_ptr_interrupt
op_assign
id|runtime-&gt;hw_ptr_interrupt
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_PLAYBACK
)paren
id|snd_pcm_oss_simulate_fill
c_func
(paren
id|substream
)paren
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|stream
op_eq
id|SNDRV_PCM_STREAM_PLAYBACK
)paren
id|info.blocks
op_assign
(paren
id|runtime-&gt;buffer_size
op_minus
id|status.avail
)paren
op_div
id|runtime-&gt;period_size
suffix:semicolon
r_else
id|info.blocks
op_assign
id|status.avail
op_div
id|runtime-&gt;period_size
suffix:semicolon
)brace
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|_info
comma
op_amp
id|info
comma
r_sizeof
(paren
id|info
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_get_space
r_static
r_int
id|snd_pcm_oss_get_space
c_func
(paren
id|snd_pcm_oss_file_t
op_star
id|pcm_oss_file
comma
r_int
id|stream
comma
r_struct
id|audio_buf_info
op_star
id|_info
)paren
(brace
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
id|snd_pcm_status_t
id|status
suffix:semicolon
r_struct
id|audio_buf_info
id|info
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
id|_info
op_eq
l_int|NULL
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|substream
op_assign
id|pcm_oss_file-&gt;streams
(braket
id|stream
)braket
suffix:semicolon
r_if
c_cond
(paren
id|substream
op_eq
l_int|NULL
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;oss.params
op_logical_and
(paren
id|err
op_assign
id|snd_pcm_oss_change_params
c_func
(paren
id|substream
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|info.fragsize
op_assign
id|runtime-&gt;oss.period_bytes
suffix:semicolon
id|info.fragstotal
op_assign
id|runtime-&gt;periods
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|status
comma
l_int|0
comma
r_sizeof
(paren
id|status
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;oss.prepare
)paren
(brace
r_if
c_cond
(paren
id|stream
op_eq
id|SNDRV_PCM_STREAM_PLAYBACK
)paren
(brace
id|info.bytes
op_assign
id|runtime-&gt;oss.period_bytes
op_star
id|runtime-&gt;periods
suffix:semicolon
id|info.fragments
op_assign
id|runtime-&gt;periods
suffix:semicolon
)brace
r_else
(brace
id|info.bytes
op_assign
l_int|0
suffix:semicolon
id|info.fragments
op_assign
l_int|0
suffix:semicolon
)brace
)brace
r_else
(brace
id|err
op_assign
id|snd_pcm_kernel_ioctl
c_func
(paren
id|substream
comma
id|SNDRV_PCM_IOCTL_STATUS
comma
op_amp
id|status
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|info.bytes
op_assign
id|snd_pcm_oss_bytes
c_func
(paren
id|substream
comma
id|status.avail
)paren
suffix:semicolon
id|info.fragments
op_assign
id|status.avail
op_div
id|runtime-&gt;period_size
suffix:semicolon
)brace
macro_line|#if 0
multiline_comment|/* very experimental stuff to get Quake2 working */
id|runtime-&gt;oss.period
op_assign
(paren
id|info.periods
op_minus
l_int|1
)paren
op_lshift
l_int|16
suffix:semicolon
r_for
c_loop
(paren
id|tmp
op_assign
id|info.fragsize
suffix:semicolon
id|tmp
OG
l_int|1
suffix:semicolon
id|tmp
op_rshift_assign
l_int|1
)paren
id|runtime-&gt;oss.period
op_increment
suffix:semicolon
id|runtime-&gt;oss.subdivision
op_assign
l_int|1
suffix:semicolon
multiline_comment|/* disable SUBDIVIDE */
macro_line|#endif
singleline_comment|// printk(&quot;space: bytes = %i, periods = %i, fragstotal = %i, fragsize = %i&bslash;n&quot;, info.bytes, info.periods, info.fragstotal, info.fragsize);
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|_info
comma
op_amp
id|info
comma
r_sizeof
(paren
id|info
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_get_mapbuf
r_static
r_int
id|snd_pcm_oss_get_mapbuf
c_func
(paren
id|snd_pcm_oss_file_t
op_star
id|pcm_oss_file
comma
r_int
id|stream
comma
r_struct
id|buffmem_desc
op_star
id|_info
)paren
(brace
singleline_comment|// it won&squot;t be probably implemented
singleline_comment|// snd_printd(&quot;TODO: snd_pcm_oss_get_mapbuf&bslash;n&quot;);
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_look_for_setup
r_static
id|snd_pcm_oss_setup_t
op_star
id|snd_pcm_oss_look_for_setup
c_func
(paren
id|snd_pcm_t
op_star
id|pcm
comma
r_int
id|stream
comma
r_const
r_char
op_star
id|task_name
)paren
(brace
r_const
r_char
op_star
id|ptr
comma
op_star
id|ptrl
suffix:semicolon
id|snd_pcm_oss_setup_t
op_star
id|setup
suffix:semicolon
id|down
c_func
(paren
op_amp
id|pcm-&gt;streams
(braket
id|stream
)braket
dot
id|oss.setup_mutex
)paren
suffix:semicolon
r_for
c_loop
(paren
id|setup
op_assign
id|pcm-&gt;streams
(braket
id|stream
)braket
dot
id|oss.setup_list
suffix:semicolon
id|setup
suffix:semicolon
id|setup
op_assign
id|setup-&gt;next
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|setup-&gt;task_name
comma
id|task_name
)paren
)paren
(brace
id|up
c_func
(paren
op_amp
id|pcm-&gt;streams
(braket
id|stream
)braket
dot
id|oss.setup_mutex
)paren
suffix:semicolon
r_return
id|setup
suffix:semicolon
)brace
)brace
id|ptr
op_assign
id|ptrl
op_assign
id|task_name
suffix:semicolon
r_while
c_loop
(paren
op_star
id|ptr
)paren
(brace
r_if
c_cond
(paren
op_star
id|ptr
op_eq
l_char|&squot;/&squot;
)paren
id|ptrl
op_assign
id|ptr
op_plus
l_int|1
suffix:semicolon
id|ptr
op_increment
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ptrl
op_eq
id|task_name
)paren
(brace
r_goto
id|__not_found
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
r_for
c_loop
(paren
id|setup
op_assign
id|pcm-&gt;streams
(braket
id|stream
)braket
dot
id|oss.setup_list
suffix:semicolon
id|setup
suffix:semicolon
id|setup
op_assign
id|setup-&gt;next
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|setup-&gt;task_name
comma
id|ptrl
)paren
)paren
(brace
id|up
c_func
(paren
op_amp
id|pcm-&gt;streams
(braket
id|stream
)braket
dot
id|oss.setup_mutex
)paren
suffix:semicolon
r_return
id|setup
suffix:semicolon
)brace
)brace
id|__not_found
suffix:colon
id|up
c_func
(paren
op_amp
id|pcm-&gt;streams
(braket
id|stream
)braket
dot
id|oss.setup_mutex
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_init_substream
r_static
r_void
id|snd_pcm_oss_init_substream
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_oss_setup_t
op_star
id|setup
comma
r_int
id|minor
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
id|substream-&gt;oss.oss
op_assign
l_int|1
suffix:semicolon
id|substream-&gt;oss.setup
op_assign
id|setup
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|runtime-&gt;oss.params
op_assign
l_int|1
suffix:semicolon
id|runtime-&gt;oss.trigger
op_assign
l_int|1
suffix:semicolon
id|runtime-&gt;oss.rate
op_assign
l_int|8000
suffix:semicolon
r_switch
c_cond
(paren
id|SNDRV_MINOR_OSS_DEVICE
c_func
(paren
id|minor
)paren
)paren
(brace
r_case
id|SNDRV_MINOR_OSS_PCM_8
suffix:colon
id|runtime-&gt;oss.format
op_assign
id|AFMT_U8
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNDRV_MINOR_OSS_PCM_16
suffix:colon
id|runtime-&gt;oss.format
op_assign
id|AFMT_S16_LE
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|runtime-&gt;oss.format
op_assign
id|AFMT_MU_LAW
suffix:semicolon
)brace
id|runtime-&gt;oss.channels
op_assign
l_int|1
suffix:semicolon
id|runtime-&gt;oss.fragshift
op_assign
l_int|0
suffix:semicolon
id|runtime-&gt;oss.maxfrags
op_assign
l_int|0
suffix:semicolon
id|runtime-&gt;oss.subdivision
op_assign
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_release_substream
r_static
r_void
id|snd_pcm_oss_release_substream
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;oss.buffer
)paren
id|vfree
c_func
(paren
id|runtime-&gt;oss.buffer
)paren
suffix:semicolon
id|snd_pcm_oss_plugin_clear
c_func
(paren
id|substream
)paren
suffix:semicolon
id|substream-&gt;oss.file
op_assign
l_int|NULL
suffix:semicolon
id|substream-&gt;oss.oss
op_assign
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_release_file
r_static
r_int
id|snd_pcm_oss_release_file
c_func
(paren
id|snd_pcm_oss_file_t
op_star
id|pcm_oss_file
)paren
(brace
r_int
id|cidx
suffix:semicolon
id|snd_assert
c_func
(paren
id|pcm_oss_file
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
r_for
c_loop
(paren
id|cidx
op_assign
l_int|0
suffix:semicolon
id|cidx
OL
l_int|2
suffix:semicolon
op_increment
id|cidx
)paren
(brace
id|snd_pcm_substream_t
op_star
id|substream
op_assign
id|pcm_oss_file-&gt;streams
(braket
id|cidx
)braket
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_if
c_cond
(paren
id|substream
op_eq
l_int|NULL
)paren
r_continue
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|snd_pcm_running
c_func
(paren
id|substream
)paren
)paren
id|snd_pcm_stop
c_func
(paren
id|substream
comma
id|SNDRV_PCM_STATE_SETUP
)paren
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;ops-&gt;hw_free
op_ne
l_int|NULL
)paren
id|substream-&gt;ops
op_member_access_from_pointer
id|hw_free
c_func
(paren
id|substream
)paren
suffix:semicolon
id|substream-&gt;ops
op_member_access_from_pointer
id|close
c_func
(paren
id|substream
)paren
suffix:semicolon
id|substream-&gt;ffile
op_assign
l_int|NULL
suffix:semicolon
id|snd_pcm_oss_release_substream
c_func
(paren
id|substream
)paren
suffix:semicolon
id|snd_pcm_release_substream
c_func
(paren
id|substream
)paren
suffix:semicolon
)brace
id|snd_magic_kfree
c_func
(paren
id|pcm_oss_file
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_open_file
r_static
r_int
id|snd_pcm_oss_open_file
c_func
(paren
r_struct
id|file
op_star
id|file
comma
id|snd_pcm_t
op_star
id|pcm
comma
id|snd_pcm_oss_file_t
op_star
op_star
id|rpcm_oss_file
comma
r_int
id|minor
comma
id|snd_pcm_oss_setup_t
op_star
id|psetup
comma
id|snd_pcm_oss_setup_t
op_star
id|csetup
)paren
(brace
r_int
id|err
op_assign
l_int|0
suffix:semicolon
id|snd_pcm_oss_file_t
op_star
id|pcm_oss_file
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|psubstream
op_assign
l_int|NULL
comma
op_star
id|csubstream
op_assign
l_int|NULL
suffix:semicolon
r_int
r_int
id|f_mode
op_assign
id|file-&gt;f_mode
suffix:semicolon
id|snd_assert
c_func
(paren
id|rpcm_oss_file
op_ne
l_int|NULL
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
op_star
id|rpcm_oss_file
op_assign
l_int|NULL
suffix:semicolon
id|pcm_oss_file
op_assign
id|snd_magic_kcalloc
c_func
(paren
id|snd_pcm_oss_file_t
comma
l_int|0
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pcm_oss_file
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
r_if
c_cond
(paren
(paren
id|f_mode
op_amp
(paren
id|FMODE_WRITE
op_or
id|FMODE_READ
)paren
)paren
op_eq
(paren
id|FMODE_WRITE
op_or
id|FMODE_READ
)paren
op_logical_and
(paren
id|pcm-&gt;info_flags
op_amp
id|SNDRV_PCM_INFO_HALF_DUPLEX
)paren
)paren
id|f_mode
op_assign
id|FMODE_WRITE
suffix:semicolon
r_if
c_cond
(paren
(paren
id|f_mode
op_amp
id|FMODE_WRITE
)paren
op_logical_and
op_logical_neg
(paren
id|psetup
op_logical_and
id|psetup-&gt;disable
)paren
)paren
(brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_pcm_open_substream
c_func
(paren
id|pcm
comma
id|SNDRV_PCM_STREAM_PLAYBACK
comma
op_amp
id|psubstream
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_pcm_oss_release_file
c_func
(paren
id|pcm_oss_file
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
id|pcm_oss_file-&gt;streams
(braket
id|SNDRV_PCM_STREAM_PLAYBACK
)braket
op_assign
id|psubstream
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|f_mode
op_amp
id|FMODE_READ
)paren
op_logical_and
op_logical_neg
(paren
id|csetup
op_logical_and
id|csetup-&gt;disable
)paren
)paren
(brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_pcm_open_substream
c_func
(paren
id|pcm
comma
id|SNDRV_PCM_STREAM_CAPTURE
comma
op_amp
id|csubstream
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_pcm_oss_release_file
c_func
(paren
id|pcm_oss_file
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
id|pcm_oss_file-&gt;streams
(braket
id|SNDRV_PCM_STREAM_CAPTURE
)braket
op_assign
id|csubstream
suffix:semicolon
)brace
r_if
c_cond
(paren
id|psubstream
op_eq
l_int|NULL
op_logical_and
id|csubstream
op_eq
l_int|NULL
)paren
(brace
id|snd_pcm_oss_release_file
c_func
(paren
id|pcm_oss_file
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|psubstream
op_ne
l_int|NULL
)paren
(brace
id|psubstream-&gt;oss.file
op_assign
id|pcm_oss_file
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_constraints_init
c_func
(paren
id|psubstream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
(brace
id|snd_printd
c_func
(paren
l_string|&quot;snd_pcm_hw_constraint_init failed&bslash;n&quot;
)paren
suffix:semicolon
id|snd_pcm_oss_release_file
c_func
(paren
id|pcm_oss_file
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|psubstream-&gt;ops
op_member_access_from_pointer
id|open
c_func
(paren
id|psubstream
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_pcm_oss_release_file
c_func
(paren
id|pcm_oss_file
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
id|err
op_assign
id|snd_pcm_hw_constraints_complete
c_func
(paren
id|psubstream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
(brace
id|snd_printd
c_func
(paren
l_string|&quot;snd_pcm_hw_constraint_complete failed&bslash;n&quot;
)paren
suffix:semicolon
id|snd_pcm_oss_release_file
c_func
(paren
id|pcm_oss_file
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
id|psubstream-&gt;ffile
op_assign
id|file
suffix:semicolon
id|snd_pcm_oss_init_substream
c_func
(paren
id|psubstream
comma
id|psetup
comma
id|minor
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|csubstream
op_ne
l_int|NULL
)paren
(brace
id|csubstream-&gt;oss.file
op_assign
id|pcm_oss_file
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_constraints_init
c_func
(paren
id|csubstream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
(brace
id|snd_printd
c_func
(paren
l_string|&quot;snd_pcm_hw_constraint_init failed&bslash;n&quot;
)paren
suffix:semicolon
id|snd_pcm_oss_release_file
c_func
(paren
id|pcm_oss_file
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|csubstream-&gt;ops
op_member_access_from_pointer
id|open
c_func
(paren
id|csubstream
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_pcm_oss_release_file
c_func
(paren
id|pcm_oss_file
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
id|err
op_assign
id|snd_pcm_hw_constraints_complete
c_func
(paren
id|csubstream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
(brace
id|snd_printd
c_func
(paren
l_string|&quot;snd_pcm_hw_constraint_complete failed&bslash;n&quot;
)paren
suffix:semicolon
id|snd_pcm_oss_release_file
c_func
(paren
id|pcm_oss_file
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
id|csubstream-&gt;ffile
op_assign
id|file
suffix:semicolon
id|snd_pcm_oss_init_substream
c_func
(paren
id|csubstream
comma
id|csetup
comma
id|minor
)paren
suffix:semicolon
)brace
id|file-&gt;private_data
op_assign
id|pcm_oss_file
suffix:semicolon
op_star
id|rpcm_oss_file
op_assign
id|pcm_oss_file
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_open
r_static
r_int
id|snd_pcm_oss_open
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_int
id|minor
op_assign
id|minor
c_func
(paren
id|inode-&gt;i_rdev
)paren
suffix:semicolon
r_int
id|cardnum
op_assign
id|SNDRV_MINOR_OSS_CARD
c_func
(paren
id|minor
)paren
suffix:semicolon
r_int
id|device
suffix:semicolon
r_int
id|err
suffix:semicolon
r_char
id|task_name
(braket
l_int|32
)braket
suffix:semicolon
id|snd_pcm_t
op_star
id|pcm
suffix:semicolon
id|snd_pcm_oss_file_t
op_star
id|pcm_oss_file
suffix:semicolon
id|snd_pcm_oss_setup_t
op_star
id|psetup
op_assign
l_int|NULL
comma
op_star
id|csetup
op_assign
l_int|NULL
suffix:semicolon
r_int
id|nonblock
suffix:semicolon
id|wait_queue_t
id|wait
suffix:semicolon
id|snd_assert
c_func
(paren
id|cardnum
op_ge
l_int|0
op_logical_and
id|cardnum
OL
id|SNDRV_CARDS
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|device
op_assign
id|SNDRV_MINOR_OSS_DEVICE
c_func
(paren
id|minor
)paren
op_eq
id|SNDRV_MINOR_OSS_PCM1
ques
c_cond
id|snd_adsp_map
(braket
id|cardnum
)braket
suffix:colon
id|snd_dsp_map
(braket
id|cardnum
)braket
suffix:semicolon
macro_line|#ifdef LINUX_2_2
id|MOD_INC_USE_COUNT
suffix:semicolon
macro_line|#endif
id|pcm
op_assign
id|snd_pcm_devices
(braket
(paren
id|cardnum
op_star
id|SNDRV_PCM_DEVICES
)paren
op_plus
id|device
)braket
suffix:semicolon
r_if
c_cond
(paren
id|pcm
op_eq
l_int|NULL
)paren
(brace
id|err
op_assign
op_minus
id|ENODEV
suffix:semicolon
r_goto
id|__error1
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|try_inc_mod_count
c_func
(paren
id|pcm-&gt;card-&gt;module
)paren
)paren
(brace
id|err
op_assign
op_minus
id|EFAULT
suffix:semicolon
r_goto
id|__error1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|snd_task_name
c_func
(paren
id|current
comma
id|task_name
comma
r_sizeof
(paren
id|task_name
)paren
)paren
OL
l_int|0
)paren
(brace
id|err
op_assign
op_minus
id|EFAULT
suffix:semicolon
r_goto
id|__error1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|file-&gt;f_mode
op_amp
id|FMODE_WRITE
)paren
id|psetup
op_assign
id|snd_pcm_oss_look_for_setup
c_func
(paren
id|pcm
comma
id|SNDRV_PCM_STREAM_PLAYBACK
comma
id|task_name
)paren
suffix:semicolon
r_if
c_cond
(paren
id|file-&gt;f_mode
op_amp
id|FMODE_READ
)paren
id|csetup
op_assign
id|snd_pcm_oss_look_for_setup
c_func
(paren
id|pcm
comma
id|SNDRV_PCM_STREAM_CAPTURE
comma
id|task_name
)paren
suffix:semicolon
id|nonblock
op_assign
op_logical_neg
op_logical_neg
(paren
id|file-&gt;f_flags
op_amp
id|O_NONBLOCK
)paren
suffix:semicolon
r_if
c_cond
(paren
id|psetup
op_logical_and
op_logical_neg
id|psetup-&gt;disable
)paren
(brace
r_if
c_cond
(paren
id|psetup-&gt;nonblock
)paren
id|nonblock
op_assign
l_int|1
suffix:semicolon
r_else
r_if
c_cond
(paren
id|psetup-&gt;block
)paren
id|nonblock
op_assign
l_int|0
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|nonblock
)paren
id|nonblock
op_assign
id|snd_nonblock_open
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|csetup
op_logical_and
op_logical_neg
id|csetup-&gt;disable
)paren
(brace
r_if
c_cond
(paren
id|csetup-&gt;nonblock
)paren
id|nonblock
op_assign
l_int|1
suffix:semicolon
r_else
r_if
c_cond
(paren
id|csetup-&gt;block
)paren
id|nonblock
op_assign
l_int|0
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|nonblock
)paren
id|nonblock
op_assign
id|snd_nonblock_open
suffix:semicolon
)brace
id|init_waitqueue_entry
c_func
(paren
op_amp
id|wait
comma
id|current
)paren
suffix:semicolon
id|add_wait_queue
c_func
(paren
op_amp
id|pcm-&gt;open_wait
comma
op_amp
id|wait
)paren
suffix:semicolon
r_while
c_loop
(paren
l_int|1
)paren
(brace
id|down
c_func
(paren
op_amp
id|pcm-&gt;open_mutex
)paren
suffix:semicolon
id|err
op_assign
id|snd_pcm_oss_open_file
c_func
(paren
id|file
comma
id|pcm
comma
op_amp
id|pcm_oss_file
comma
id|minor
comma
id|psetup
comma
id|csetup
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
op_ge
l_int|0
)paren
r_break
suffix:semicolon
id|up
c_func
(paren
op_amp
id|pcm-&gt;open_mutex
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
op_eq
op_minus
id|EAGAIN
)paren
(brace
r_if
c_cond
(paren
id|nonblock
)paren
(brace
id|err
op_assign
op_minus
id|EBUSY
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_else
r_break
suffix:semicolon
id|set_current_state
c_func
(paren
id|TASK_INTERRUPTIBLE
)paren
suffix:semicolon
id|schedule
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|signal_pending
c_func
(paren
id|current
)paren
)paren
(brace
id|err
op_assign
op_minus
id|ERESTARTSYS
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
id|set_current_state
c_func
(paren
id|TASK_RUNNING
)paren
suffix:semicolon
id|remove_wait_queue
c_func
(paren
op_amp
id|pcm-&gt;open_wait
comma
op_amp
id|wait
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_goto
id|__error
suffix:semicolon
id|up
c_func
(paren
op_amp
id|pcm-&gt;open_mutex
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
id|__error
suffix:colon
id|dec_mod_count
c_func
(paren
id|pcm-&gt;card-&gt;module
)paren
suffix:semicolon
id|__error1
suffix:colon
macro_line|#ifdef LINUX_2_2
id|MOD_DEC_USE_COUNT
suffix:semicolon
macro_line|#endif
r_return
id|err
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_release
r_static
r_int
id|snd_pcm_oss_release
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
id|snd_pcm_t
op_star
id|pcm
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
id|snd_pcm_oss_file_t
op_star
id|pcm_oss_file
suffix:semicolon
id|pcm_oss_file
op_assign
id|snd_magic_cast
c_func
(paren
id|snd_pcm_oss_file_t
comma
id|file-&gt;private_data
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|substream
op_assign
id|pcm_oss_file-&gt;streams
(braket
id|SNDRV_PCM_STREAM_PLAYBACK
)braket
suffix:semicolon
r_if
c_cond
(paren
id|substream
op_eq
l_int|NULL
)paren
id|substream
op_assign
id|pcm_oss_file-&gt;streams
(braket
id|SNDRV_PCM_STREAM_CAPTURE
)braket
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|pcm
op_assign
id|substream-&gt;pcm
suffix:semicolon
id|snd_pcm_oss_sync
c_func
(paren
id|pcm_oss_file
)paren
suffix:semicolon
id|down
c_func
(paren
op_amp
id|pcm-&gt;open_mutex
)paren
suffix:semicolon
id|snd_pcm_oss_release_file
c_func
(paren
id|pcm_oss_file
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|pcm-&gt;open_mutex
)paren
suffix:semicolon
id|wake_up
c_func
(paren
op_amp
id|pcm-&gt;open_wait
)paren
suffix:semicolon
id|dec_mod_count
c_func
(paren
id|pcm-&gt;card-&gt;module
)paren
suffix:semicolon
macro_line|#ifdef LINUX_2_2
id|MOD_DEC_USE_COUNT
suffix:semicolon
macro_line|#endif
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_ioctl
r_static
r_int
id|snd_pcm_oss_ioctl
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
comma
r_int
r_int
id|cmd
comma
r_int
r_int
id|arg
)paren
(brace
id|snd_pcm_oss_file_t
op_star
id|pcm_oss_file
suffix:semicolon
r_int
id|res
suffix:semicolon
id|pcm_oss_file
op_assign
id|snd_magic_cast
c_func
(paren
id|snd_pcm_oss_file_t
comma
id|file-&gt;private_data
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
r_if
c_cond
(paren
id|cmd
op_eq
id|OSS_GETVERSION
)paren
r_return
id|put_user
c_func
(paren
id|SNDRV_OSS_VERSION
comma
(paren
r_int
op_star
)paren
id|arg
)paren
ques
c_cond
op_minus
id|EFAULT
suffix:colon
l_int|0
suffix:semicolon
r_if
c_cond
(paren
(paren
(paren
id|cmd
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
)paren
op_eq
l_char|&squot;M&squot;
)paren
(brace
multiline_comment|/* mixer ioctl - for OSS (grrr) compatibility */
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
r_int
id|idx
suffix:semicolon
r_for
c_loop
(paren
id|idx
op_assign
l_int|0
suffix:semicolon
id|idx
OL
l_int|2
suffix:semicolon
op_increment
id|idx
)paren
(brace
id|substream
op_assign
id|pcm_oss_file-&gt;streams
(braket
id|idx
)braket
suffix:semicolon
r_if
c_cond
(paren
id|substream
op_ne
l_int|NULL
)paren
r_break
suffix:semicolon
)brace
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
r_return
id|snd_mixer_oss_ioctl_card
c_func
(paren
id|substream-&gt;pcm-&gt;card
comma
id|cmd
comma
id|arg
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
(paren
id|cmd
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
)paren
op_ne
l_char|&squot;P&squot;
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|SNDCTL_DSP_RESET
suffix:colon
r_return
id|snd_pcm_oss_reset
c_func
(paren
id|pcm_oss_file
)paren
suffix:semicolon
r_case
id|SNDCTL_DSP_SYNC
suffix:colon
r_return
id|snd_pcm_oss_sync
c_func
(paren
id|pcm_oss_file
)paren
suffix:semicolon
r_case
id|SNDCTL_DSP_SPEED
suffix:colon
r_if
c_cond
(paren
id|get_user
c_func
(paren
id|res
comma
(paren
r_int
op_star
)paren
id|arg
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
(paren
id|res
op_assign
id|snd_pcm_oss_set_rate
c_func
(paren
id|pcm_oss_file
comma
id|res
)paren
)paren
OL
l_int|0
)paren
r_return
id|res
suffix:semicolon
r_return
id|put_user
c_func
(paren
id|res
comma
(paren
r_int
op_star
)paren
id|arg
)paren
ques
c_cond
op_minus
id|EFAULT
suffix:colon
l_int|0
suffix:semicolon
r_case
id|SOUND_PCM_READ_RATE
suffix:colon
id|res
op_assign
id|snd_pcm_oss_get_rate
c_func
(paren
id|pcm_oss_file
)paren
suffix:semicolon
r_if
c_cond
(paren
id|res
OL
l_int|0
)paren
r_return
id|res
suffix:semicolon
r_return
id|put_user
c_func
(paren
id|res
comma
(paren
r_int
op_star
)paren
id|arg
)paren
ques
c_cond
op_minus
id|EFAULT
suffix:colon
l_int|0
suffix:semicolon
r_case
id|SNDCTL_DSP_STEREO
suffix:colon
r_if
c_cond
(paren
id|get_user
c_func
(paren
id|res
comma
(paren
r_int
op_star
)paren
id|arg
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|res
op_assign
id|res
OG
l_int|0
ques
c_cond
l_int|2
suffix:colon
l_int|1
suffix:semicolon
r_if
c_cond
(paren
(paren
id|res
op_assign
id|snd_pcm_oss_set_channels
c_func
(paren
id|pcm_oss_file
comma
id|res
)paren
)paren
OL
l_int|0
)paren
r_return
id|res
suffix:semicolon
r_return
id|put_user
c_func
(paren
op_decrement
id|res
comma
(paren
r_int
op_star
)paren
id|arg
)paren
ques
c_cond
op_minus
id|EFAULT
suffix:colon
l_int|0
suffix:semicolon
r_case
id|SNDCTL_DSP_GETBLKSIZE
suffix:colon
id|res
op_assign
id|snd_pcm_oss_get_block_size
c_func
(paren
id|pcm_oss_file
)paren
suffix:semicolon
r_if
c_cond
(paren
id|res
OL
l_int|0
)paren
r_return
id|res
suffix:semicolon
r_return
id|put_user
c_func
(paren
id|res
comma
(paren
r_int
op_star
)paren
id|arg
)paren
ques
c_cond
op_minus
id|EFAULT
suffix:colon
l_int|0
suffix:semicolon
r_case
id|SNDCTL_DSP_SETFMT
suffix:colon
r_if
c_cond
(paren
id|get_user
c_func
(paren
id|res
comma
(paren
r_int
op_star
)paren
id|arg
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|res
op_assign
id|snd_pcm_oss_set_format
c_func
(paren
id|pcm_oss_file
comma
id|res
)paren
suffix:semicolon
r_if
c_cond
(paren
id|res
OL
l_int|0
)paren
r_return
id|res
suffix:semicolon
r_return
id|put_user
c_func
(paren
id|res
comma
(paren
r_int
op_star
)paren
id|arg
)paren
ques
c_cond
op_minus
id|EFAULT
suffix:colon
l_int|0
suffix:semicolon
r_case
id|SOUND_PCM_READ_BITS
suffix:colon
id|res
op_assign
id|snd_pcm_oss_get_format
c_func
(paren
id|pcm_oss_file
)paren
suffix:semicolon
r_if
c_cond
(paren
id|res
OL
l_int|0
)paren
r_return
id|res
suffix:semicolon
r_return
id|put_user
c_func
(paren
id|res
comma
(paren
r_int
op_star
)paren
id|arg
)paren
ques
c_cond
op_minus
id|EFAULT
suffix:colon
l_int|0
suffix:semicolon
r_case
id|SNDCTL_DSP_CHANNELS
suffix:colon
r_if
c_cond
(paren
id|get_user
c_func
(paren
id|res
comma
(paren
r_int
op_star
)paren
id|arg
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|res
op_assign
id|snd_pcm_oss_set_channels
c_func
(paren
id|pcm_oss_file
comma
id|res
)paren
suffix:semicolon
r_if
c_cond
(paren
id|res
OL
l_int|0
)paren
r_return
id|res
suffix:semicolon
r_return
id|put_user
c_func
(paren
id|res
comma
(paren
r_int
op_star
)paren
id|arg
)paren
ques
c_cond
op_minus
id|EFAULT
suffix:colon
l_int|0
suffix:semicolon
r_case
id|SOUND_PCM_READ_CHANNELS
suffix:colon
id|res
op_assign
id|snd_pcm_oss_get_channels
c_func
(paren
id|pcm_oss_file
)paren
suffix:semicolon
r_if
c_cond
(paren
id|res
OL
l_int|0
)paren
r_return
id|res
suffix:semicolon
r_return
id|put_user
c_func
(paren
id|res
comma
(paren
r_int
op_star
)paren
id|arg
)paren
ques
c_cond
op_minus
id|EFAULT
suffix:colon
l_int|0
suffix:semicolon
r_case
id|SOUND_PCM_WRITE_FILTER
suffix:colon
r_case
id|SOUND_PCM_READ_FILTER
suffix:colon
r_return
op_minus
id|EIO
suffix:semicolon
r_case
id|SNDCTL_DSP_POST
suffix:colon
multiline_comment|/* to do */
r_return
l_int|0
suffix:semicolon
r_case
id|SNDCTL_DSP_SUBDIVIDE
suffix:colon
r_if
c_cond
(paren
id|get_user
c_func
(paren
id|res
comma
(paren
r_int
op_star
)paren
id|arg
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|res
op_assign
id|snd_pcm_oss_set_subdivide
c_func
(paren
id|pcm_oss_file
comma
id|res
)paren
suffix:semicolon
r_if
c_cond
(paren
id|res
OL
l_int|0
)paren
r_return
id|res
suffix:semicolon
r_return
id|put_user
c_func
(paren
id|res
comma
(paren
r_int
op_star
)paren
id|arg
)paren
ques
c_cond
op_minus
id|EFAULT
suffix:colon
l_int|0
suffix:semicolon
r_case
id|SNDCTL_DSP_SETFRAGMENT
suffix:colon
r_if
c_cond
(paren
id|get_user
c_func
(paren
id|res
comma
(paren
r_int
op_star
)paren
id|arg
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
id|snd_pcm_oss_set_fragment
c_func
(paren
id|pcm_oss_file
comma
id|res
)paren
suffix:semicolon
r_case
id|SNDCTL_DSP_GETFMTS
suffix:colon
id|res
op_assign
id|snd_pcm_oss_get_formats
c_func
(paren
id|pcm_oss_file
)paren
suffix:semicolon
r_if
c_cond
(paren
id|res
OL
l_int|0
)paren
r_return
id|res
suffix:semicolon
r_return
id|put_user
c_func
(paren
id|res
comma
(paren
r_int
op_star
)paren
id|arg
)paren
ques
c_cond
op_minus
id|EFAULT
suffix:colon
l_int|0
suffix:semicolon
r_case
id|SNDCTL_DSP_GETOSPACE
suffix:colon
r_case
id|SNDCTL_DSP_GETISPACE
suffix:colon
r_return
id|snd_pcm_oss_get_space
c_func
(paren
id|pcm_oss_file
comma
id|cmd
op_eq
id|SNDCTL_DSP_GETISPACE
ques
c_cond
id|SNDRV_PCM_STREAM_CAPTURE
suffix:colon
id|SNDRV_PCM_STREAM_PLAYBACK
comma
(paren
r_struct
id|audio_buf_info
op_star
)paren
id|arg
)paren
suffix:semicolon
r_case
id|SNDCTL_DSP_NONBLOCK
suffix:colon
r_return
id|snd_pcm_oss_nonblock
c_func
(paren
id|file
)paren
suffix:semicolon
r_case
id|SNDCTL_DSP_GETCAPS
suffix:colon
id|res
op_assign
id|snd_pcm_oss_get_caps
c_func
(paren
id|pcm_oss_file
)paren
suffix:semicolon
r_if
c_cond
(paren
id|res
OL
l_int|0
)paren
r_return
id|res
suffix:semicolon
r_return
id|put_user
c_func
(paren
id|res
comma
(paren
r_int
op_star
)paren
id|arg
)paren
ques
c_cond
op_minus
id|EFAULT
suffix:colon
l_int|0
suffix:semicolon
r_case
id|SNDCTL_DSP_GETTRIGGER
suffix:colon
id|res
op_assign
id|snd_pcm_oss_get_trigger
c_func
(paren
id|pcm_oss_file
)paren
suffix:semicolon
r_if
c_cond
(paren
id|res
OL
l_int|0
)paren
r_return
id|res
suffix:semicolon
r_return
id|put_user
c_func
(paren
id|res
comma
(paren
r_int
op_star
)paren
id|arg
)paren
ques
c_cond
op_minus
id|EFAULT
suffix:colon
l_int|0
suffix:semicolon
r_case
id|SNDCTL_DSP_SETTRIGGER
suffix:colon
r_if
c_cond
(paren
id|get_user
c_func
(paren
id|res
comma
(paren
r_int
op_star
)paren
id|arg
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
id|snd_pcm_oss_set_trigger
c_func
(paren
id|pcm_oss_file
comma
id|res
)paren
suffix:semicolon
r_case
id|SNDCTL_DSP_GETIPTR
suffix:colon
r_case
id|SNDCTL_DSP_GETOPTR
suffix:colon
r_return
id|snd_pcm_oss_get_ptr
c_func
(paren
id|pcm_oss_file
comma
id|cmd
op_eq
id|SNDCTL_DSP_GETIPTR
ques
c_cond
id|SNDRV_PCM_STREAM_CAPTURE
suffix:colon
id|SNDRV_PCM_STREAM_PLAYBACK
comma
(paren
r_struct
id|count_info
op_star
)paren
id|arg
)paren
suffix:semicolon
r_case
id|SNDCTL_DSP_MAPINBUF
suffix:colon
r_case
id|SNDCTL_DSP_MAPOUTBUF
suffix:colon
r_return
id|snd_pcm_oss_get_mapbuf
c_func
(paren
id|pcm_oss_file
comma
id|cmd
op_eq
id|SNDCTL_DSP_MAPINBUF
ques
c_cond
id|SNDRV_PCM_STREAM_CAPTURE
suffix:colon
id|SNDRV_PCM_STREAM_PLAYBACK
comma
(paren
r_struct
id|buffmem_desc
op_star
)paren
id|arg
)paren
suffix:semicolon
r_case
id|SNDCTL_DSP_SETSYNCRO
suffix:colon
multiline_comment|/* stop DMA now.. */
r_return
l_int|0
suffix:semicolon
r_case
id|SNDCTL_DSP_SETDUPLEX
suffix:colon
r_if
c_cond
(paren
id|snd_pcm_oss_get_caps
c_func
(paren
id|pcm_oss_file
)paren
op_amp
id|DSP_CAP_DUPLEX
)paren
r_return
l_int|0
suffix:semicolon
r_return
op_minus
id|EIO
suffix:semicolon
r_case
id|SNDCTL_DSP_GETODELAY
suffix:colon
id|res
op_assign
id|snd_pcm_oss_get_odelay
c_func
(paren
id|pcm_oss_file
)paren
suffix:semicolon
r_if
c_cond
(paren
id|res
OL
l_int|0
)paren
r_return
id|res
suffix:semicolon
r_return
id|put_user
c_func
(paren
id|res
comma
(paren
r_int
op_star
)paren
id|arg
)paren
ques
c_cond
op_minus
id|EFAULT
suffix:colon
l_int|0
suffix:semicolon
r_case
id|SNDCTL_DSP_PROFILE
suffix:colon
r_return
l_int|0
suffix:semicolon
multiline_comment|/* silently ignore */
r_default
suffix:colon
id|snd_printd
c_func
(paren
l_string|&quot;pcm_oss: unknown command = 0x%x&bslash;n&quot;
comma
id|cmd
)paren
suffix:semicolon
)brace
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_read
r_static
id|ssize_t
id|snd_pcm_oss_read
c_func
(paren
r_struct
id|file
op_star
id|file
comma
r_char
op_star
id|buf
comma
r_int
id|count
comma
id|loff_t
op_star
id|offset
)paren
(brace
id|snd_pcm_oss_file_t
op_star
id|pcm_oss_file
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
id|pcm_oss_file
op_assign
id|snd_magic_cast
c_func
(paren
id|snd_pcm_oss_file_t
comma
id|file-&gt;private_data
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|substream
op_assign
id|pcm_oss_file-&gt;streams
(braket
id|SNDRV_PCM_STREAM_CAPTURE
)braket
suffix:semicolon
r_if
c_cond
(paren
id|substream
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENXIO
suffix:semicolon
r_return
id|snd_pcm_oss_read1
c_func
(paren
id|substream
comma
id|buf
comma
id|count
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_write
r_static
id|ssize_t
id|snd_pcm_oss_write
c_func
(paren
r_struct
id|file
op_star
id|file
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
comma
id|loff_t
op_star
id|offset
)paren
(brace
id|snd_pcm_oss_file_t
op_star
id|pcm_oss_file
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
r_int
id|result
suffix:semicolon
id|pcm_oss_file
op_assign
id|snd_magic_cast
c_func
(paren
id|snd_pcm_oss_file_t
comma
id|file-&gt;private_data
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|substream
op_assign
id|pcm_oss_file-&gt;streams
(braket
id|SNDRV_PCM_STREAM_PLAYBACK
)braket
suffix:semicolon
r_if
c_cond
(paren
id|substream
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENXIO
suffix:semicolon
id|up
c_func
(paren
op_amp
id|file-&gt;f_dentry-&gt;d_inode-&gt;i_sem
)paren
suffix:semicolon
id|result
op_assign
id|snd_pcm_oss_write1
c_func
(paren
id|substream
comma
id|buf
comma
id|count
)paren
suffix:semicolon
id|down
c_func
(paren
op_amp
id|file-&gt;f_dentry-&gt;d_inode-&gt;i_sem
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_playback_ready
r_static
r_int
id|snd_pcm_oss_playback_ready
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|runtime-&gt;mmap_count
)paren
)paren
r_return
id|runtime-&gt;oss.prev_hw_ptr_interrupt
op_ne
id|runtime-&gt;hw_ptr_interrupt
suffix:semicolon
r_else
r_return
id|snd_pcm_playback_ready
c_func
(paren
id|substream
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_capture_ready
r_static
r_int
id|snd_pcm_oss_capture_ready
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|runtime-&gt;mmap_count
)paren
)paren
r_return
id|runtime-&gt;oss.prev_hw_ptr_interrupt
op_ne
id|runtime-&gt;hw_ptr_interrupt
suffix:semicolon
r_else
r_return
id|snd_pcm_capture_ready
c_func
(paren
id|substream
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_poll
r_static
r_int
r_int
id|snd_pcm_oss_poll
c_func
(paren
r_struct
id|file
op_star
id|file
comma
id|poll_table
op_star
id|wait
)paren
(brace
id|snd_pcm_oss_file_t
op_star
id|pcm_oss_file
suffix:semicolon
r_int
r_int
id|mask
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|psubstream
op_assign
l_int|NULL
comma
op_star
id|csubstream
op_assign
l_int|NULL
suffix:semicolon
id|pcm_oss_file
op_assign
id|snd_magic_cast
c_func
(paren
id|snd_pcm_oss_file_t
comma
id|file-&gt;private_data
comma
r_return
l_int|0
)paren
suffix:semicolon
id|psubstream
op_assign
id|pcm_oss_file-&gt;streams
(braket
id|SNDRV_PCM_STREAM_PLAYBACK
)braket
suffix:semicolon
id|csubstream
op_assign
id|pcm_oss_file-&gt;streams
(braket
id|SNDRV_PCM_STREAM_CAPTURE
)braket
suffix:semicolon
id|mask
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|psubstream
op_ne
l_int|NULL
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|psubstream-&gt;runtime
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
id|poll_wait
c_func
(paren
id|file
comma
op_amp
id|runtime-&gt;sleep
comma
id|wait
)paren
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_ne
id|SNDRV_PCM_STATE_DRAINING
op_logical_and
(paren
id|runtime-&gt;status-&gt;state
op_ne
id|SNDRV_PCM_STATE_RUNNING
op_logical_or
id|snd_pcm_oss_playback_ready
c_func
(paren
id|psubstream
)paren
)paren
)paren
id|mask
op_or_assign
id|POLLOUT
op_or
id|POLLWRNORM
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|csubstream
op_ne
l_int|NULL
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|csubstream-&gt;runtime
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
id|poll_wait
c_func
(paren
id|file
comma
op_amp
id|runtime-&gt;sleep
comma
id|wait
)paren
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_ne
id|SNDRV_PCM_STATE_RUNNING
op_logical_or
id|snd_pcm_oss_capture_ready
c_func
(paren
id|csubstream
)paren
)paren
id|mask
op_or_assign
id|POLLIN
op_or
id|POLLRDNORM
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|runtime-&gt;lock
)paren
suffix:semicolon
)brace
r_return
id|mask
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_mmap
r_static
r_int
id|snd_pcm_oss_mmap
c_func
(paren
r_struct
id|file
op_star
id|file
comma
r_struct
id|vm_area_struct
op_star
id|area
)paren
(brace
id|snd_pcm_oss_file_t
op_star
id|pcm_oss_file
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|substream
op_assign
l_int|NULL
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_int
id|err
suffix:semicolon
id|pcm_oss_file
op_assign
id|snd_magic_cast
c_func
(paren
id|snd_pcm_oss_file_t
comma
id|file-&gt;private_data
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
r_switch
c_cond
(paren
(paren
id|area-&gt;vm_flags
op_amp
(paren
id|VM_READ
op_or
id|VM_WRITE
)paren
)paren
)paren
(brace
r_case
id|VM_READ
op_or
id|VM_WRITE
suffix:colon
id|substream
op_assign
id|pcm_oss_file-&gt;streams
(braket
id|SNDRV_PCM_STREAM_PLAYBACK
)braket
suffix:semicolon
r_if
c_cond
(paren
id|substream
)paren
r_break
suffix:semicolon
multiline_comment|/* Fall through */
r_case
id|VM_READ
suffix:colon
id|substream
op_assign
id|pcm_oss_file-&gt;streams
(braket
id|SNDRV_PCM_STREAM_CAPTURE
)braket
suffix:semicolon
r_break
suffix:semicolon
r_case
id|VM_WRITE
suffix:colon
id|substream
op_assign
id|pcm_oss_file-&gt;streams
(braket
id|SNDRV_PCM_STREAM_PLAYBACK
)braket
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
multiline_comment|/* set VM_READ access as well to fix memset() routines that do&n;&t;   reads before writes (to improve performance) */
id|area-&gt;vm_flags
op_or_assign
id|VM_READ
suffix:semicolon
r_if
c_cond
(paren
id|substream
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENXIO
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|runtime-&gt;info
op_amp
id|SNDRV_PCM_INFO_MMAP_VALID
)paren
)paren
r_return
op_minus
id|EIO
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;info
op_amp
id|SNDRV_PCM_INFO_INTERLEAVED
)paren
id|runtime-&gt;access
op_assign
id|SNDRV_PCM_ACCESS_MMAP_INTERLEAVED
suffix:semicolon
r_else
r_return
op_minus
id|EIO
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;oss.params
)paren
(brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_pcm_oss_change_params
c_func
(paren
id|substream
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
r_if
c_cond
(paren
id|runtime-&gt;oss.plugin_first
op_ne
l_int|NULL
)paren
r_return
op_minus
id|EIO
suffix:semicolon
macro_line|#if LINUX_VERSION_CODE &gt;= KERNEL_VERSION(2, 3, 25)
r_if
c_cond
(paren
id|area-&gt;vm_pgoff
op_ne
l_int|0
)paren
macro_line|#else
r_if
c_cond
(paren
id|area-&gt;vm_offset
op_ne
l_int|0
)paren
macro_line|#endif
r_return
op_minus
id|EINVAL
suffix:semicolon
id|err
op_assign
id|snd_pcm_mmap_data
c_func
(paren
id|substream
comma
id|file
comma
id|area
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|runtime-&gt;oss.mmap_bytes
op_assign
id|area-&gt;vm_end
op_minus
id|area-&gt;vm_start
suffix:semicolon
multiline_comment|/* In mmap mode we never stop */
id|runtime-&gt;stop_threshold
op_assign
id|runtime-&gt;boundary
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; *  /proc interface&n; */
DECL|function|snd_pcm_oss_proc_read
r_static
r_void
id|snd_pcm_oss_proc_read
c_func
(paren
id|snd_info_entry_t
op_star
id|entry
comma
id|snd_info_buffer_t
op_star
id|buffer
)paren
(brace
id|snd_pcm_str_t
op_star
id|pstr
op_assign
(paren
id|snd_pcm_str_t
op_star
)paren
id|entry-&gt;private_data
suffix:semicolon
id|snd_pcm_oss_setup_t
op_star
id|setup
op_assign
id|pstr-&gt;oss.setup_list
suffix:semicolon
id|down
c_func
(paren
op_amp
id|pstr-&gt;oss.setup_mutex
)paren
suffix:semicolon
r_while
c_loop
(paren
id|setup
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;%s %u %u%s%s%s%s&bslash;n&quot;
comma
id|setup-&gt;task_name
comma
id|setup-&gt;periods
comma
id|setup-&gt;period_size
comma
id|setup-&gt;disable
ques
c_cond
l_string|&quot; disable&quot;
suffix:colon
l_string|&quot;&quot;
comma
id|setup-&gt;direct
ques
c_cond
l_string|&quot; direct&quot;
suffix:colon
l_string|&quot;&quot;
comma
id|setup-&gt;block
ques
c_cond
l_string|&quot; block&quot;
suffix:colon
l_string|&quot;&quot;
comma
id|setup-&gt;nonblock
ques
c_cond
l_string|&quot; non-block&quot;
suffix:colon
l_string|&quot;&quot;
)paren
suffix:semicolon
id|setup
op_assign
id|setup-&gt;next
suffix:semicolon
)brace
id|up
c_func
(paren
op_amp
id|pstr-&gt;oss.setup_mutex
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_proc_free_setup_list
r_static
r_void
id|snd_pcm_oss_proc_free_setup_list
c_func
(paren
id|snd_pcm_str_t
op_star
id|pstr
)paren
(brace
r_int
r_int
id|idx
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
id|snd_pcm_oss_setup_t
op_star
id|setup
comma
op_star
id|setupn
suffix:semicolon
r_for
c_loop
(paren
id|idx
op_assign
l_int|0
comma
id|substream
op_assign
id|pstr-&gt;substream
suffix:semicolon
id|idx
OL
id|pstr-&gt;substream_count
suffix:semicolon
id|idx
op_increment
comma
id|substream
op_assign
id|substream-&gt;next
)paren
id|substream-&gt;oss.setup
op_assign
l_int|NULL
suffix:semicolon
r_for
c_loop
(paren
id|setup
op_assign
id|pstr-&gt;oss.setup_list
comma
id|pstr-&gt;oss.setup_list
op_assign
l_int|NULL
suffix:semicolon
id|setup
suffix:semicolon
id|setup
op_assign
id|setupn
)paren
(brace
id|setupn
op_assign
id|setup-&gt;next
suffix:semicolon
id|kfree
c_func
(paren
id|setup-&gt;task_name
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|setup
)paren
suffix:semicolon
)brace
id|pstr-&gt;oss.setup_list
op_assign
l_int|NULL
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_proc_write
r_static
r_void
id|snd_pcm_oss_proc_write
c_func
(paren
id|snd_info_entry_t
op_star
id|entry
comma
id|snd_info_buffer_t
op_star
id|buffer
)paren
(brace
id|snd_pcm_str_t
op_star
id|pstr
op_assign
(paren
id|snd_pcm_str_t
op_star
)paren
id|entry-&gt;private_data
suffix:semicolon
r_char
id|line
(braket
l_int|512
)braket
comma
id|str
(braket
l_int|32
)braket
comma
id|task_name
(braket
l_int|32
)braket
comma
op_star
id|ptr
suffix:semicolon
r_int
id|idx1
suffix:semicolon
id|snd_pcm_oss_setup_t
op_star
id|setup
comma
op_star
id|setup1
comma
r_template
suffix:semicolon
r_while
c_loop
(paren
op_logical_neg
id|snd_info_get_line
c_func
(paren
id|buffer
comma
id|line
comma
r_sizeof
(paren
id|line
)paren
)paren
)paren
(brace
id|down
c_func
(paren
op_amp
id|pstr-&gt;oss.setup_mutex
)paren
suffix:semicolon
id|memset
c_func
(paren
op_amp
r_template
comma
l_int|0
comma
r_sizeof
(paren
r_template
)paren
)paren
suffix:semicolon
id|ptr
op_assign
id|snd_info_get_str
c_func
(paren
id|task_name
comma
id|line
comma
r_sizeof
(paren
id|task_name
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|task_name
comma
l_string|&quot;clear&quot;
)paren
op_logical_or
op_logical_neg
id|strcmp
c_func
(paren
id|task_name
comma
l_string|&quot;erase&quot;
)paren
)paren
(brace
id|snd_pcm_oss_proc_free_setup_list
c_func
(paren
id|pstr
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|pstr-&gt;oss.setup_mutex
)paren
suffix:semicolon
r_continue
suffix:semicolon
)brace
r_for
c_loop
(paren
id|setup
op_assign
id|pstr-&gt;oss.setup_list
suffix:semicolon
id|setup
suffix:semicolon
id|setup
op_assign
id|setup-&gt;next
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|setup-&gt;task_name
comma
id|task_name
)paren
)paren
(brace
r_template
op_assign
op_star
id|setup
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
id|ptr
op_assign
id|snd_info_get_str
c_func
(paren
id|str
comma
id|ptr
comma
r_sizeof
(paren
id|str
)paren
)paren
suffix:semicolon
r_template
dot
id|periods
op_assign
id|simple_strtoul
c_func
(paren
id|str
comma
l_int|NULL
comma
l_int|10
)paren
suffix:semicolon
id|ptr
op_assign
id|snd_info_get_str
c_func
(paren
id|str
comma
id|ptr
comma
r_sizeof
(paren
id|str
)paren
)paren
suffix:semicolon
r_template
dot
id|period_size
op_assign
id|simple_strtoul
c_func
(paren
id|str
comma
l_int|NULL
comma
l_int|10
)paren
suffix:semicolon
r_for
c_loop
(paren
id|idx1
op_assign
l_int|31
suffix:semicolon
id|idx1
op_ge
l_int|0
suffix:semicolon
id|idx1
op_decrement
)paren
r_if
c_cond
(paren
r_template
dot
id|period_size
op_amp
(paren
l_int|1
op_lshift
id|idx1
)paren
)paren
r_break
suffix:semicolon
r_for
c_loop
(paren
id|idx1
op_decrement
suffix:semicolon
id|idx1
op_ge
l_int|0
suffix:semicolon
id|idx1
op_decrement
)paren
r_template
dot
id|period_size
op_and_assign
op_complement
(paren
l_int|1
op_lshift
id|idx1
)paren
suffix:semicolon
r_do
(brace
id|ptr
op_assign
id|snd_info_get_str
c_func
(paren
id|str
comma
id|ptr
comma
r_sizeof
(paren
id|str
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|str
comma
l_string|&quot;disable&quot;
)paren
)paren
(brace
r_template
dot
id|disable
op_assign
l_int|1
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|str
comma
l_string|&quot;direct&quot;
)paren
)paren
(brace
r_template
dot
id|direct
op_assign
l_int|1
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|str
comma
l_string|&quot;block&quot;
)paren
)paren
(brace
r_template
dot
id|block
op_assign
l_int|1
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|str
comma
l_string|&quot;non-block&quot;
)paren
)paren
(brace
r_template
dot
id|nonblock
op_assign
l_int|1
suffix:semicolon
)brace
)brace
r_while
c_loop
(paren
op_star
id|str
)paren
suffix:semicolon
r_if
c_cond
(paren
id|setup
op_eq
l_int|NULL
)paren
(brace
id|setup
op_assign
(paren
id|snd_pcm_oss_setup_t
op_star
)paren
id|kmalloc
c_func
(paren
r_sizeof
(paren
id|snd_pcm_oss_setup_t
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|setup
)paren
(brace
r_if
c_cond
(paren
id|pstr-&gt;oss.setup_list
op_eq
l_int|NULL
)paren
(brace
id|pstr-&gt;oss.setup_list
op_assign
id|setup
suffix:semicolon
)brace
r_else
(brace
r_for
c_loop
(paren
id|setup1
op_assign
id|pstr-&gt;oss.setup_list
suffix:semicolon
id|setup1-&gt;next
suffix:semicolon
id|setup1
op_assign
id|setup1-&gt;next
)paren
suffix:semicolon
id|setup1-&gt;next
op_assign
id|setup
suffix:semicolon
)brace
r_template
dot
id|task_name
op_assign
id|snd_kmalloc_strdup
c_func
(paren
id|task_name
comma
id|GFP_KERNEL
)paren
suffix:semicolon
)brace
r_else
(brace
id|buffer-&gt;error
op_assign
op_minus
id|ENOMEM
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|setup
)paren
op_star
id|setup
op_assign
r_template
suffix:semicolon
id|up
c_func
(paren
op_amp
id|pstr-&gt;oss.setup_mutex
)paren
suffix:semicolon
)brace
)brace
DECL|function|snd_pcm_oss_proc_init
r_static
r_void
id|snd_pcm_oss_proc_init
c_func
(paren
id|snd_pcm_t
op_star
id|pcm
)paren
(brace
r_int
id|stream
suffix:semicolon
r_for
c_loop
(paren
id|stream
op_assign
l_int|0
suffix:semicolon
id|stream
OL
l_int|2
suffix:semicolon
op_increment
id|stream
)paren
(brace
id|snd_info_entry_t
op_star
id|entry
suffix:semicolon
id|snd_pcm_str_t
op_star
id|pstr
op_assign
op_amp
id|pcm-&gt;streams
(braket
id|stream
)braket
suffix:semicolon
r_if
c_cond
(paren
id|pstr-&gt;substream_count
op_eq
l_int|0
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
(paren
id|entry
op_assign
id|snd_info_create_card_entry
c_func
(paren
id|pcm-&gt;card
comma
l_string|&quot;oss&quot;
comma
id|pstr-&gt;proc_root
)paren
)paren
op_ne
l_int|NULL
)paren
(brace
id|entry-&gt;content
op_assign
id|SNDRV_INFO_CONTENT_TEXT
suffix:semicolon
id|entry-&gt;mode
op_assign
id|S_IFREG
op_or
id|S_IRUGO
op_or
id|S_IWUSR
suffix:semicolon
id|entry-&gt;c.text.read_size
op_assign
l_int|8192
suffix:semicolon
id|entry-&gt;c.text.read
op_assign
id|snd_pcm_oss_proc_read
suffix:semicolon
id|entry-&gt;c.text.write_size
op_assign
l_int|8192
suffix:semicolon
id|entry-&gt;c.text.write
op_assign
id|snd_pcm_oss_proc_write
suffix:semicolon
id|entry-&gt;private_data
op_assign
id|pstr
suffix:semicolon
r_if
c_cond
(paren
id|snd_info_register
c_func
(paren
id|entry
)paren
OL
l_int|0
)paren
(brace
id|snd_info_free_entry
c_func
(paren
id|entry
)paren
suffix:semicolon
id|entry
op_assign
l_int|NULL
suffix:semicolon
)brace
)brace
id|pstr-&gt;oss.proc_entry
op_assign
id|entry
suffix:semicolon
)brace
)brace
DECL|function|snd_pcm_oss_proc_done
r_static
r_void
id|snd_pcm_oss_proc_done
c_func
(paren
id|snd_pcm_t
op_star
id|pcm
)paren
(brace
r_int
id|stream
suffix:semicolon
r_for
c_loop
(paren
id|stream
op_assign
l_int|0
suffix:semicolon
id|stream
OL
l_int|2
suffix:semicolon
op_increment
id|stream
)paren
(brace
id|snd_pcm_str_t
op_star
id|pstr
op_assign
op_amp
id|pcm-&gt;streams
(braket
id|stream
)braket
suffix:semicolon
r_if
c_cond
(paren
id|pstr-&gt;oss.proc_entry
)paren
(brace
id|snd_info_unregister
c_func
(paren
id|pstr-&gt;oss.proc_entry
)paren
suffix:semicolon
id|pstr-&gt;oss.proc_entry
op_assign
l_int|NULL
suffix:semicolon
id|snd_pcm_oss_proc_free_setup_list
c_func
(paren
id|pstr
)paren
suffix:semicolon
)brace
)brace
)brace
multiline_comment|/*&n; *  ENTRY functions&n; */
DECL|variable|snd_pcm_oss_f_reg
r_static
r_struct
id|file_operations
id|snd_pcm_oss_f_reg
op_assign
(brace
macro_line|#ifndef LINUX_2_2
id|owner
suffix:colon
id|THIS_MODULE
comma
macro_line|#endif
id|read
suffix:colon
id|snd_pcm_oss_read
comma
id|write
suffix:colon
id|snd_pcm_oss_write
comma
id|open
suffix:colon
id|snd_pcm_oss_open
comma
id|release
suffix:colon
id|snd_pcm_oss_release
comma
id|poll
suffix:colon
id|snd_pcm_oss_poll
comma
id|ioctl
suffix:colon
id|snd_pcm_oss_ioctl
comma
id|mmap
suffix:colon
id|snd_pcm_oss_mmap
comma
)brace
suffix:semicolon
DECL|variable|snd_pcm_oss_reg
r_static
id|snd_minor_t
id|snd_pcm_oss_reg
op_assign
(brace
id|comment
suffix:colon
l_string|&quot;digital audio&quot;
comma
id|f_ops
suffix:colon
op_amp
id|snd_pcm_oss_f_reg
comma
)brace
suffix:semicolon
DECL|function|register_oss_dsp
r_static
r_void
id|register_oss_dsp
c_func
(paren
r_int
r_int
id|native_minor
comma
id|snd_pcm_t
op_star
id|pcm
comma
r_int
id|index
)paren
(brace
r_char
id|name
(braket
l_int|128
)braket
suffix:semicolon
id|sprintf
c_func
(paren
id|name
comma
l_string|&quot;dsp%i%i&quot;
comma
id|pcm-&gt;card-&gt;number
comma
id|pcm-&gt;device
)paren
suffix:semicolon
r_if
c_cond
(paren
id|snd_register_oss_device
c_func
(paren
id|SNDRV_OSS_DEVICE_TYPE_PCM
comma
id|pcm-&gt;card
comma
id|index
comma
op_amp
id|snd_pcm_oss_reg
comma
id|name
)paren
OL
l_int|0
)paren
(brace
id|snd_printk
c_func
(paren
l_string|&quot;unable to register OSS PCM device %i:%i&bslash;n&quot;
comma
id|pcm-&gt;card-&gt;number
comma
id|pcm-&gt;device
)paren
suffix:semicolon
)brace
)brace
DECL|function|snd_pcm_oss_register_minor
r_static
r_int
id|snd_pcm_oss_register_minor
c_func
(paren
r_int
r_int
id|native_minor
comma
id|snd_pcm_t
op_star
id|pcm
)paren
(brace
id|pcm-&gt;oss.reg
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|snd_dsp_map
(braket
id|pcm-&gt;card-&gt;number
)braket
op_eq
id|pcm-&gt;device
)paren
(brace
r_char
id|name
(braket
l_int|128
)braket
suffix:semicolon
r_int
id|duplex
suffix:semicolon
id|register_oss_dsp
c_func
(paren
id|native_minor
comma
id|pcm
comma
l_int|0
)paren
suffix:semicolon
id|duplex
op_assign
(paren
id|pcm-&gt;streams
(braket
id|SNDRV_PCM_STREAM_PLAYBACK
)braket
dot
id|substream_count
OG
l_int|0
op_logical_and
id|pcm-&gt;streams
(braket
id|SNDRV_PCM_STREAM_CAPTURE
)braket
dot
id|substream_count
op_logical_and
op_logical_neg
(paren
id|pcm-&gt;info_flags
op_amp
id|SNDRV_PCM_INFO_HALF_DUPLEX
)paren
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|name
comma
l_string|&quot;%s%s&quot;
comma
id|pcm-&gt;name
comma
id|duplex
ques
c_cond
l_string|&quot; (DUPLEX)&quot;
suffix:colon
l_string|&quot;&quot;
)paren
suffix:semicolon
id|snd_oss_info_register
c_func
(paren
id|SNDRV_OSS_INFO_DEV_AUDIO
comma
id|pcm-&gt;card-&gt;number
comma
id|name
)paren
suffix:semicolon
id|pcm-&gt;oss.reg
op_increment
suffix:semicolon
)brace
r_if
c_cond
(paren
id|snd_adsp_map
(braket
id|pcm-&gt;card-&gt;number
)braket
op_eq
id|pcm-&gt;device
)paren
(brace
id|register_oss_dsp
c_func
(paren
id|native_minor
comma
id|pcm
comma
l_int|1
)paren
suffix:semicolon
id|pcm-&gt;oss.reg
op_increment
suffix:semicolon
)brace
r_if
c_cond
(paren
id|pcm-&gt;oss.reg
)paren
id|snd_pcm_oss_proc_init
c_func
(paren
id|pcm
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_oss_unregister_minor
r_static
r_int
id|snd_pcm_oss_unregister_minor
c_func
(paren
r_int
r_int
id|native_minor
comma
id|snd_pcm_t
op_star
id|pcm
)paren
(brace
r_if
c_cond
(paren
id|pcm-&gt;oss.reg
)paren
(brace
r_if
c_cond
(paren
id|snd_dsp_map
(braket
id|pcm-&gt;card-&gt;number
)braket
op_eq
id|pcm-&gt;device
)paren
(brace
id|snd_unregister_oss_device
c_func
(paren
id|SNDRV_OSS_DEVICE_TYPE_PCM
comma
id|pcm-&gt;card
comma
l_int|0
)paren
suffix:semicolon
id|snd_oss_info_unregister
c_func
(paren
id|SNDRV_OSS_INFO_DEV_AUDIO
comma
id|pcm-&gt;card-&gt;number
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|snd_adsp_map
(braket
id|pcm-&gt;card-&gt;number
)braket
op_eq
id|pcm-&gt;device
)paren
id|snd_unregister_oss_device
c_func
(paren
id|SNDRV_OSS_DEVICE_TYPE_PCM
comma
id|pcm-&gt;card
comma
l_int|1
)paren
suffix:semicolon
id|pcm-&gt;oss.reg
op_assign
l_int|0
suffix:semicolon
id|snd_pcm_oss_proc_done
c_func
(paren
id|pcm
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|snd_pcm_oss_notify
r_static
id|snd_pcm_notify_t
id|snd_pcm_oss_notify
op_assign
(brace
id|n_register
suffix:colon
id|snd_pcm_oss_register_minor
comma
id|n_unregister
suffix:colon
id|snd_pcm_oss_unregister_minor
comma
)brace
suffix:semicolon
DECL|function|alsa_pcm_oss_init
r_static
r_int
id|__init
id|alsa_pcm_oss_init
c_func
(paren
r_void
)paren
(brace
r_int
id|i
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_pcm_notify
c_func
(paren
op_amp
id|snd_pcm_oss_notify
comma
l_int|0
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
multiline_comment|/* check device map table */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|SNDRV_CARDS
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|snd_dsp_map
(braket
id|i
)braket
OL
l_int|0
op_logical_or
id|snd_dsp_map
(braket
id|i
)braket
op_ge
id|SNDRV_PCM_DEVICES
)paren
(brace
id|snd_printk
c_func
(paren
l_string|&quot;invalid dsp_map[%d] = %d&bslash;n&quot;
comma
id|i
comma
id|snd_dsp_map
(braket
id|i
)braket
)paren
suffix:semicolon
id|snd_dsp_map
(braket
id|i
)braket
op_assign
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|snd_adsp_map
(braket
id|i
)braket
OL
l_int|0
op_logical_or
id|snd_adsp_map
(braket
id|i
)braket
op_ge
id|SNDRV_PCM_DEVICES
)paren
(brace
id|snd_printk
c_func
(paren
l_string|&quot;invalid adsp_map[%d] = %d&bslash;n&quot;
comma
id|i
comma
id|snd_adsp_map
(braket
id|i
)braket
)paren
suffix:semicolon
id|snd_adsp_map
(braket
id|i
)braket
op_assign
l_int|1
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|alsa_pcm_oss_exit
r_static
r_void
id|__exit
id|alsa_pcm_oss_exit
c_func
(paren
r_void
)paren
(brace
id|snd_pcm_notify
c_func
(paren
op_amp
id|snd_pcm_oss_notify
comma
l_int|1
)paren
suffix:semicolon
)brace
id|module_init
c_func
(paren
id|alsa_pcm_oss_init
)paren
id|module_exit
c_func
(paren
id|alsa_pcm_oss_exit
)paren
eof
