multiline_comment|/*&n; *  Digital Audio (PCM) abstract layer&n; *  Copyright (c) by Jaroslav Kysela &lt;perex@suse.cz&gt;&n; *                   Abramo Bagnara &lt;abramo@alsa-project.org&gt;&n; *&n; *&n; *   This program is free software; you can redistribute it and/or modify&n; *   it under the terms of the GNU General Public License as published by&n; *   the Free Software Foundation; either version 2 of the License, or&n; *   (at your option) any later version.&n; *&n; *   This program is distributed in the hope that it will be useful,&n; *   but WITHOUT ANY WARRANTY; without even the implied warranty of&n; *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; *   GNU General Public License for more details.&n; *&n; *   You should have received a copy of the GNU General Public License&n; *   along with this program; if not, write to the Free Software&n; *   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA&n; *&n; */
macro_line|#include &lt;sound/driver.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;linux/time.h&gt;
macro_line|#include &lt;sound/core.h&gt;
macro_line|#include &lt;sound/control.h&gt;
macro_line|#include &lt;sound/info.h&gt;
macro_line|#include &lt;sound/pcm.h&gt;
macro_line|#include &lt;sound/pcm_params.h&gt;
macro_line|#include &lt;sound/timer.h&gt;
multiline_comment|/*&n; * fill ring buffer with silence&n; * runtime-&gt;silence_start: starting pointer to silence area&n; * runtime-&gt;silence_filled: size filled with silence&n; * runtime-&gt;silence_threshold: threshold from application&n; * runtime-&gt;silence_size: maximal size from application&n; *&n; * when runtime-&gt;silence_size &gt;= runtime-&gt;boundary - fill processed area with silence immediately&n; */
DECL|function|snd_pcm_playback_silence
r_void
id|snd_pcm_playback_silence
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_uframes_t
id|new_hw_ptr
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_pcm_uframes_t
id|frames
comma
id|ofs
comma
id|transfer
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;silence_size
OL
id|runtime-&gt;boundary
)paren
(brace
id|snd_pcm_sframes_t
id|noise_dist
comma
id|n
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;silence_start
op_ne
id|runtime-&gt;control-&gt;appl_ptr
)paren
(brace
id|n
op_assign
id|runtime-&gt;control-&gt;appl_ptr
op_minus
id|runtime-&gt;silence_start
suffix:semicolon
r_if
c_cond
(paren
id|n
OL
l_int|0
)paren
id|n
op_add_assign
id|runtime-&gt;boundary
suffix:semicolon
r_if
c_cond
(paren
(paren
id|snd_pcm_uframes_t
)paren
id|n
OL
id|runtime-&gt;silence_filled
)paren
id|runtime-&gt;silence_filled
op_sub_assign
id|n
suffix:semicolon
r_else
id|runtime-&gt;silence_filled
op_assign
l_int|0
suffix:semicolon
id|runtime-&gt;silence_start
op_assign
id|runtime-&gt;control-&gt;appl_ptr
suffix:semicolon
)brace
r_if
c_cond
(paren
id|runtime-&gt;silence_filled
op_eq
id|runtime-&gt;buffer_size
)paren
r_return
suffix:semicolon
id|snd_assert
c_func
(paren
id|runtime-&gt;silence_filled
op_le
id|runtime-&gt;buffer_size
comma
r_return
)paren
suffix:semicolon
id|noise_dist
op_assign
id|snd_pcm_playback_hw_avail
c_func
(paren
id|runtime
)paren
op_plus
id|runtime-&gt;silence_filled
suffix:semicolon
r_if
c_cond
(paren
id|noise_dist
op_ge
(paren
id|snd_pcm_sframes_t
)paren
id|runtime-&gt;silence_threshold
)paren
r_return
suffix:semicolon
id|frames
op_assign
id|runtime-&gt;silence_threshold
op_minus
id|noise_dist
suffix:semicolon
r_if
c_cond
(paren
id|frames
OG
id|runtime-&gt;silence_size
)paren
id|frames
op_assign
id|runtime-&gt;silence_size
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|new_hw_ptr
op_eq
id|ULONG_MAX
)paren
(brace
multiline_comment|/* initialization */
id|snd_pcm_sframes_t
id|avail
op_assign
id|snd_pcm_playback_hw_avail
c_func
(paren
id|runtime
)paren
suffix:semicolon
id|runtime-&gt;silence_filled
op_assign
id|avail
OG
l_int|0
ques
c_cond
id|avail
suffix:colon
l_int|0
suffix:semicolon
id|runtime-&gt;silence_start
op_assign
(paren
id|runtime-&gt;status-&gt;hw_ptr
op_plus
id|runtime-&gt;silence_filled
)paren
op_mod
id|runtime-&gt;boundary
suffix:semicolon
)brace
r_else
(brace
id|ofs
op_assign
id|runtime-&gt;status-&gt;hw_ptr
suffix:semicolon
id|frames
op_assign
id|new_hw_ptr
op_minus
id|ofs
suffix:semicolon
r_if
c_cond
(paren
(paren
id|snd_pcm_sframes_t
)paren
id|frames
OL
l_int|0
)paren
id|frames
op_add_assign
id|runtime-&gt;boundary
suffix:semicolon
id|runtime-&gt;silence_filled
op_sub_assign
id|frames
suffix:semicolon
r_if
c_cond
(paren
(paren
id|snd_pcm_sframes_t
)paren
id|runtime-&gt;silence_filled
OL
l_int|0
)paren
(brace
id|runtime-&gt;silence_filled
op_assign
l_int|0
suffix:semicolon
id|runtime-&gt;silence_start
op_assign
(paren
id|ofs
op_plus
id|frames
)paren
op_minus
id|runtime-&gt;buffer_size
suffix:semicolon
)brace
r_else
(brace
id|runtime-&gt;silence_start
op_assign
id|ofs
op_minus
id|runtime-&gt;silence_filled
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|snd_pcm_sframes_t
)paren
id|runtime-&gt;silence_start
OL
l_int|0
)paren
id|runtime-&gt;silence_start
op_add_assign
id|runtime-&gt;boundary
suffix:semicolon
)brace
id|frames
op_assign
id|runtime-&gt;buffer_size
op_minus
id|runtime-&gt;silence_filled
suffix:semicolon
)brace
id|snd_assert
c_func
(paren
id|frames
op_le
id|runtime-&gt;buffer_size
comma
r_return
)paren
suffix:semicolon
r_if
c_cond
(paren
id|frames
op_eq
l_int|0
)paren
r_return
suffix:semicolon
id|ofs
op_assign
(paren
id|runtime-&gt;silence_start
op_plus
id|runtime-&gt;silence_filled
)paren
op_mod
id|runtime-&gt;buffer_size
suffix:semicolon
r_while
c_loop
(paren
id|frames
OG
l_int|0
)paren
(brace
id|transfer
op_assign
id|ofs
op_plus
id|frames
OG
id|runtime-&gt;buffer_size
ques
c_cond
id|runtime-&gt;buffer_size
op_minus
id|ofs
suffix:colon
id|frames
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;access
op_eq
id|SNDRV_PCM_ACCESS_RW_INTERLEAVED
op_logical_or
id|runtime-&gt;access
op_eq
id|SNDRV_PCM_ACCESS_MMAP_INTERLEAVED
)paren
(brace
r_if
c_cond
(paren
id|substream-&gt;ops-&gt;silence
)paren
(brace
r_int
id|err
suffix:semicolon
id|err
op_assign
id|substream-&gt;ops
op_member_access_from_pointer
id|silence
c_func
(paren
id|substream
comma
op_minus
l_int|1
comma
id|ofs
comma
id|transfer
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|err
op_ge
l_int|0
comma
)paren
suffix:semicolon
)brace
r_else
(brace
r_char
op_star
id|hwbuf
op_assign
id|runtime-&gt;dma_area
op_plus
id|frames_to_bytes
c_func
(paren
id|runtime
comma
id|ofs
)paren
suffix:semicolon
id|snd_pcm_format_set_silence
c_func
(paren
id|runtime-&gt;format
comma
id|hwbuf
comma
id|transfer
op_star
id|runtime-&gt;channels
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
r_int
r_int
id|c
suffix:semicolon
r_int
r_int
id|channels
op_assign
id|runtime-&gt;channels
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;ops-&gt;silence
)paren
(brace
r_for
c_loop
(paren
id|c
op_assign
l_int|0
suffix:semicolon
id|c
OL
id|channels
suffix:semicolon
op_increment
id|c
)paren
(brace
r_int
id|err
suffix:semicolon
id|err
op_assign
id|substream-&gt;ops
op_member_access_from_pointer
id|silence
c_func
(paren
id|substream
comma
id|c
comma
id|ofs
comma
id|transfer
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|err
op_ge
l_int|0
comma
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
r_int
id|dma_csize
op_assign
id|runtime-&gt;dma_bytes
op_div
id|channels
suffix:semicolon
r_for
c_loop
(paren
id|c
op_assign
l_int|0
suffix:semicolon
id|c
OL
id|channels
suffix:semicolon
op_increment
id|c
)paren
(brace
r_char
op_star
id|hwbuf
op_assign
id|runtime-&gt;dma_area
op_plus
(paren
id|c
op_star
id|dma_csize
)paren
op_plus
id|samples_to_bytes
c_func
(paren
id|runtime
comma
id|ofs
)paren
suffix:semicolon
id|snd_pcm_format_set_silence
c_func
(paren
id|runtime-&gt;format
comma
id|hwbuf
comma
id|transfer
)paren
suffix:semicolon
)brace
)brace
)brace
id|runtime-&gt;silence_filled
op_add_assign
id|transfer
suffix:semicolon
id|frames
op_sub_assign
id|transfer
suffix:semicolon
id|ofs
op_assign
l_int|0
suffix:semicolon
)brace
)brace
DECL|function|snd_pcm_update_hw_ptr_pos
r_static
r_inline
id|snd_pcm_uframes_t
id|snd_pcm_update_hw_ptr_pos
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_runtime_t
op_star
id|runtime
)paren
(brace
id|snd_pcm_uframes_t
id|pos
suffix:semicolon
id|pos
op_assign
id|substream-&gt;ops
op_member_access_from_pointer
id|pointer
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;tstamp_mode
op_amp
id|SNDRV_PCM_TSTAMP_MMAP
)paren
id|snd_timestamp_now
c_func
(paren
(paren
id|snd_timestamp_t
op_star
)paren
op_amp
id|runtime-&gt;status-&gt;tstamp
comma
id|runtime-&gt;tstamp_timespec
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_SND_DEBUG
r_if
c_cond
(paren
id|pos
op_ge
id|runtime-&gt;buffer_size
)paren
(brace
id|snd_printk
c_func
(paren
id|KERN_ERR
l_string|&quot;BUG: stream = %i, pos = 0x%lx, buffer size = 0x%lx, period size = 0x%lx&bslash;n&quot;
comma
id|substream-&gt;stream
comma
id|pos
comma
id|runtime-&gt;buffer_size
comma
id|runtime-&gt;period_size
)paren
suffix:semicolon
)brace
r_else
macro_line|#endif
id|snd_runtime_check
c_func
(paren
id|pos
OL
id|runtime-&gt;buffer_size
comma
r_return
l_int|0
)paren
suffix:semicolon
id|pos
op_sub_assign
id|pos
op_mod
id|runtime-&gt;min_align
suffix:semicolon
r_return
id|pos
suffix:semicolon
)brace
DECL|function|snd_pcm_update_hw_ptr_post
r_static
r_inline
r_int
id|snd_pcm_update_hw_ptr_post
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_runtime_t
op_star
id|runtime
)paren
(brace
id|snd_pcm_uframes_t
id|avail
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_PLAYBACK
)paren
id|avail
op_assign
id|snd_pcm_playback_avail
c_func
(paren
id|runtime
)paren
suffix:semicolon
r_else
id|avail
op_assign
id|snd_pcm_capture_avail
c_func
(paren
id|runtime
)paren
suffix:semicolon
r_if
c_cond
(paren
id|avail
OG
id|runtime-&gt;avail_max
)paren
id|runtime-&gt;avail_max
op_assign
id|avail
suffix:semicolon
r_if
c_cond
(paren
id|avail
op_ge
id|runtime-&gt;stop_threshold
)paren
(brace
id|snd_pcm_stop
c_func
(paren
id|substream
comma
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_DRAINING
ques
c_cond
id|SNDRV_PCM_STATE_SETUP
suffix:colon
id|SNDRV_PCM_STATE_XRUN
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_SND_DEBUG
r_if
c_cond
(paren
id|substream-&gt;pstr-&gt;xrun_debug
)paren
(brace
id|snd_printd
c_func
(paren
id|KERN_DEBUG
l_string|&quot;XRUN: pcmC%dD%d%c&bslash;n&quot;
comma
id|substream-&gt;pcm-&gt;card-&gt;number
comma
id|substream-&gt;pcm-&gt;device
comma
id|substream-&gt;stream
ques
c_cond
l_char|&squot;c&squot;
suffix:colon
l_char|&squot;p&squot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;pstr-&gt;xrun_debug
OG
l_int|1
)paren
id|dump_stack
c_func
(paren
)paren
suffix:semicolon
)brace
macro_line|#endif
r_return
op_minus
id|EPIPE
suffix:semicolon
)brace
r_if
c_cond
(paren
id|avail
op_ge
id|runtime-&gt;control-&gt;avail_min
)paren
id|wake_up
c_func
(paren
op_amp
id|runtime-&gt;sleep
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_update_hw_ptr_interrupt
r_static
r_inline
r_int
id|snd_pcm_update_hw_ptr_interrupt
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_pcm_uframes_t
id|pos
suffix:semicolon
id|snd_pcm_uframes_t
id|new_hw_ptr
comma
id|hw_ptr_interrupt
suffix:semicolon
id|snd_pcm_sframes_t
id|delta
suffix:semicolon
id|pos
op_assign
id|snd_pcm_update_hw_ptr_pos
c_func
(paren
id|substream
comma
id|runtime
)paren
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;period_size
op_eq
id|runtime-&gt;buffer_size
)paren
r_goto
id|__next_buf
suffix:semicolon
id|new_hw_ptr
op_assign
id|runtime-&gt;hw_ptr_base
op_plus
id|pos
suffix:semicolon
id|hw_ptr_interrupt
op_assign
id|runtime-&gt;hw_ptr_interrupt
op_plus
id|runtime-&gt;period_size
suffix:semicolon
id|delta
op_assign
id|hw_ptr_interrupt
op_minus
id|new_hw_ptr
suffix:semicolon
r_if
c_cond
(paren
id|delta
OG
l_int|0
)paren
(brace
r_if
c_cond
(paren
(paren
id|snd_pcm_uframes_t
)paren
id|delta
OL
id|runtime-&gt;buffer_size
op_div
l_int|2
)paren
(brace
macro_line|#ifdef CONFIG_SND_DEBUG
r_if
c_cond
(paren
id|runtime-&gt;periods
OG
l_int|1
op_logical_and
id|substream-&gt;pstr-&gt;xrun_debug
)paren
(brace
id|snd_printd
c_func
(paren
id|KERN_ERR
l_string|&quot;Unexpected hw_pointer value [1] (stream = %i, delta: -%ld, max jitter = %ld): wrong interrupt acknowledge?&bslash;n&quot;
comma
id|substream-&gt;stream
comma
(paren
r_int
)paren
id|delta
comma
id|runtime-&gt;buffer_size
op_div
l_int|2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;pstr-&gt;xrun_debug
OG
l_int|1
)paren
id|dump_stack
c_func
(paren
)paren
suffix:semicolon
)brace
macro_line|#endif
r_return
l_int|0
suffix:semicolon
)brace
id|__next_buf
suffix:colon
id|runtime-&gt;hw_ptr_base
op_add_assign
id|runtime-&gt;buffer_size
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;hw_ptr_base
op_eq
id|runtime-&gt;boundary
)paren
id|runtime-&gt;hw_ptr_base
op_assign
l_int|0
suffix:semicolon
id|new_hw_ptr
op_assign
id|runtime-&gt;hw_ptr_base
op_plus
id|pos
suffix:semicolon
)brace
r_if
c_cond
(paren
id|substream-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_PLAYBACK
op_logical_and
id|runtime-&gt;silence_size
OG
l_int|0
)paren
id|snd_pcm_playback_silence
c_func
(paren
id|substream
comma
id|new_hw_ptr
)paren
suffix:semicolon
id|runtime-&gt;status-&gt;hw_ptr
op_assign
id|new_hw_ptr
suffix:semicolon
id|runtime-&gt;hw_ptr_interrupt
op_assign
id|new_hw_ptr
op_minus
id|new_hw_ptr
op_mod
id|runtime-&gt;period_size
suffix:semicolon
r_return
id|snd_pcm_update_hw_ptr_post
c_func
(paren
id|substream
comma
id|runtime
)paren
suffix:semicolon
)brace
multiline_comment|/* CAUTION: call it with irq disabled */
DECL|function|snd_pcm_update_hw_ptr
r_int
id|snd_pcm_update_hw_ptr
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_pcm_uframes_t
id|pos
suffix:semicolon
id|snd_pcm_uframes_t
id|old_hw_ptr
comma
id|new_hw_ptr
suffix:semicolon
id|snd_pcm_sframes_t
id|delta
suffix:semicolon
id|old_hw_ptr
op_assign
id|runtime-&gt;status-&gt;hw_ptr
suffix:semicolon
id|pos
op_assign
id|snd_pcm_update_hw_ptr_pos
c_func
(paren
id|substream
comma
id|runtime
)paren
suffix:semicolon
id|new_hw_ptr
op_assign
id|runtime-&gt;hw_ptr_base
op_plus
id|pos
suffix:semicolon
id|delta
op_assign
id|old_hw_ptr
op_minus
id|new_hw_ptr
suffix:semicolon
r_if
c_cond
(paren
id|delta
OG
l_int|0
)paren
(brace
r_if
c_cond
(paren
(paren
id|snd_pcm_uframes_t
)paren
id|delta
OL
id|runtime-&gt;buffer_size
op_div
l_int|2
)paren
(brace
macro_line|#ifdef CONFIG_SND_DEBUG
r_if
c_cond
(paren
id|runtime-&gt;periods
OG
l_int|2
op_logical_and
id|substream-&gt;pstr-&gt;xrun_debug
)paren
(brace
id|snd_printd
c_func
(paren
id|KERN_ERR
l_string|&quot;Unexpected hw_pointer value [2] (stream = %i, delta: -%ld, max jitter = %ld): wrong interrupt acknowledge?&bslash;n&quot;
comma
id|substream-&gt;stream
comma
(paren
r_int
)paren
id|delta
comma
id|runtime-&gt;buffer_size
op_div
l_int|2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;pstr-&gt;xrun_debug
OG
l_int|1
)paren
id|dump_stack
c_func
(paren
)paren
suffix:semicolon
)brace
macro_line|#endif
r_return
l_int|0
suffix:semicolon
)brace
id|runtime-&gt;hw_ptr_base
op_add_assign
id|runtime-&gt;buffer_size
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;hw_ptr_base
op_eq
id|runtime-&gt;boundary
)paren
id|runtime-&gt;hw_ptr_base
op_assign
l_int|0
suffix:semicolon
id|new_hw_ptr
op_assign
id|runtime-&gt;hw_ptr_base
op_plus
id|pos
suffix:semicolon
)brace
r_if
c_cond
(paren
id|substream-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_PLAYBACK
op_logical_and
id|runtime-&gt;silence_size
OG
l_int|0
)paren
id|snd_pcm_playback_silence
c_func
(paren
id|substream
comma
id|new_hw_ptr
)paren
suffix:semicolon
id|runtime-&gt;status-&gt;hw_ptr
op_assign
id|new_hw_ptr
suffix:semicolon
r_return
id|snd_pcm_update_hw_ptr_post
c_func
(paren
id|substream
comma
id|runtime
)paren
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_pcm_set_ops - set the PCM operators&n; * @pcm: the pcm instance&n; * @direction: stream direction, SNDRV_PCM_STREAM_XXX&n; * @ops: the operator table&n; *&n; * Sets the given PCM operators to the pcm instance.&n; */
DECL|function|snd_pcm_set_ops
r_void
id|snd_pcm_set_ops
c_func
(paren
id|snd_pcm_t
op_star
id|pcm
comma
r_int
id|direction
comma
id|snd_pcm_ops_t
op_star
id|ops
)paren
(brace
id|snd_pcm_str_t
op_star
id|stream
op_assign
op_amp
id|pcm-&gt;streams
(braket
id|direction
)braket
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|substream
suffix:semicolon
r_for
c_loop
(paren
id|substream
op_assign
id|stream-&gt;substream
suffix:semicolon
id|substream
op_ne
l_int|NULL
suffix:semicolon
id|substream
op_assign
id|substream-&gt;next
)paren
id|substream-&gt;ops
op_assign
id|ops
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_pcm_sync - set the PCM sync id&n; * @substream: the pcm substream&n; *&n; * Sets the PCM sync identifier for the card.&n; */
DECL|function|snd_pcm_set_sync
r_void
id|snd_pcm_set_sync
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|runtime-&gt;sync.id32
(braket
l_int|0
)braket
op_assign
id|substream-&gt;pcm-&gt;card-&gt;number
suffix:semicolon
id|runtime-&gt;sync.id32
(braket
l_int|1
)braket
op_assign
op_minus
l_int|1
suffix:semicolon
id|runtime-&gt;sync.id32
(braket
l_int|2
)braket
op_assign
op_minus
l_int|1
suffix:semicolon
id|runtime-&gt;sync.id32
(braket
l_int|3
)braket
op_assign
op_minus
l_int|1
suffix:semicolon
)brace
multiline_comment|/*&n; *  Standard ioctl routine&n; */
multiline_comment|/* Code taken from alsa-lib */
DECL|macro|assert
mdefine_line|#define assert(a) snd_assert((a), return -EINVAL)
DECL|function|div32
r_static
r_inline
r_int
r_int
id|div32
c_func
(paren
r_int
r_int
id|a
comma
r_int
r_int
id|b
comma
r_int
r_int
op_star
id|r
)paren
(brace
r_if
c_cond
(paren
id|b
op_eq
l_int|0
)paren
(brace
op_star
id|r
op_assign
l_int|0
suffix:semicolon
r_return
id|UINT_MAX
suffix:semicolon
)brace
op_star
id|r
op_assign
id|a
op_mod
id|b
suffix:semicolon
r_return
id|a
op_div
id|b
suffix:semicolon
)brace
DECL|function|div_down
r_static
r_inline
r_int
r_int
id|div_down
c_func
(paren
r_int
r_int
id|a
comma
r_int
r_int
id|b
)paren
(brace
r_if
c_cond
(paren
id|b
op_eq
l_int|0
)paren
r_return
id|UINT_MAX
suffix:semicolon
r_return
id|a
op_div
id|b
suffix:semicolon
)brace
DECL|function|div_up
r_static
r_inline
r_int
r_int
id|div_up
c_func
(paren
r_int
r_int
id|a
comma
r_int
r_int
id|b
)paren
(brace
r_int
r_int
id|r
suffix:semicolon
r_int
r_int
id|q
suffix:semicolon
r_if
c_cond
(paren
id|b
op_eq
l_int|0
)paren
r_return
id|UINT_MAX
suffix:semicolon
id|q
op_assign
id|div32
c_func
(paren
id|a
comma
id|b
comma
op_amp
id|r
)paren
suffix:semicolon
r_if
c_cond
(paren
id|r
)paren
op_increment
id|q
suffix:semicolon
r_return
id|q
suffix:semicolon
)brace
DECL|function|mul
r_static
r_inline
r_int
r_int
id|mul
c_func
(paren
r_int
r_int
id|a
comma
r_int
r_int
id|b
)paren
(brace
r_if
c_cond
(paren
id|a
op_eq
l_int|0
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|div_down
c_func
(paren
id|UINT_MAX
comma
id|a
)paren
OL
id|b
)paren
r_return
id|UINT_MAX
suffix:semicolon
r_return
id|a
op_star
id|b
suffix:semicolon
)brace
DECL|function|muldiv32
r_static
r_inline
r_int
r_int
id|muldiv32
c_func
(paren
r_int
r_int
id|a
comma
r_int
r_int
id|b
comma
r_int
r_int
id|c
comma
r_int
r_int
op_star
id|r
)paren
(brace
id|u_int64_t
id|n
op_assign
(paren
id|u_int64_t
)paren
id|a
op_star
id|b
suffix:semicolon
r_if
c_cond
(paren
id|c
op_eq
l_int|0
)paren
(brace
id|snd_assert
c_func
(paren
id|n
OG
l_int|0
comma
)paren
suffix:semicolon
op_star
id|r
op_assign
l_int|0
suffix:semicolon
r_return
id|UINT_MAX
suffix:semicolon
)brace
id|div64_32
c_func
(paren
op_amp
id|n
comma
id|c
comma
id|r
)paren
suffix:semicolon
r_if
c_cond
(paren
id|n
op_ge
id|UINT_MAX
)paren
(brace
op_star
id|r
op_assign
l_int|0
suffix:semicolon
r_return
id|UINT_MAX
suffix:semicolon
)brace
r_return
id|n
suffix:semicolon
)brace
DECL|function|snd_interval_refine_min
r_int
id|snd_interval_refine_min
c_func
(paren
id|snd_interval_t
op_star
id|i
comma
r_int
r_int
id|min
comma
r_int
id|openmin
)paren
(brace
r_int
id|changed
op_assign
l_int|0
suffix:semicolon
m_assert
(paren
op_logical_neg
id|snd_interval_empty
c_func
(paren
id|i
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|i-&gt;min
OL
id|min
)paren
(brace
id|i-&gt;min
op_assign
id|min
suffix:semicolon
id|i-&gt;openmin
op_assign
id|openmin
suffix:semicolon
id|changed
op_assign
l_int|1
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|i-&gt;min
op_eq
id|min
op_logical_and
op_logical_neg
id|i-&gt;openmin
op_logical_and
id|openmin
)paren
(brace
id|i-&gt;openmin
op_assign
l_int|1
suffix:semicolon
id|changed
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|i-&gt;integer
)paren
(brace
r_if
c_cond
(paren
id|i-&gt;openmin
)paren
(brace
id|i-&gt;min
op_increment
suffix:semicolon
id|i-&gt;openmin
op_assign
l_int|0
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|snd_interval_checkempty
c_func
(paren
id|i
)paren
)paren
(brace
id|snd_interval_none
c_func
(paren
id|i
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_return
id|changed
suffix:semicolon
)brace
DECL|function|snd_interval_refine_max
r_int
id|snd_interval_refine_max
c_func
(paren
id|snd_interval_t
op_star
id|i
comma
r_int
r_int
id|max
comma
r_int
id|openmax
)paren
(brace
r_int
id|changed
op_assign
l_int|0
suffix:semicolon
m_assert
(paren
op_logical_neg
id|snd_interval_empty
c_func
(paren
id|i
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|i-&gt;max
OG
id|max
)paren
(brace
id|i-&gt;max
op_assign
id|max
suffix:semicolon
id|i-&gt;openmax
op_assign
id|openmax
suffix:semicolon
id|changed
op_assign
l_int|1
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|i-&gt;max
op_eq
id|max
op_logical_and
op_logical_neg
id|i-&gt;openmax
op_logical_and
id|openmax
)paren
(brace
id|i-&gt;openmax
op_assign
l_int|1
suffix:semicolon
id|changed
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|i-&gt;integer
)paren
(brace
r_if
c_cond
(paren
id|i-&gt;openmax
)paren
(brace
id|i-&gt;max
op_decrement
suffix:semicolon
id|i-&gt;openmax
op_assign
l_int|0
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|snd_interval_checkempty
c_func
(paren
id|i
)paren
)paren
(brace
id|snd_interval_none
c_func
(paren
id|i
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_return
id|changed
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_interval_refine - refine the interval value of configurator&n; * @i: the interval value to refine&n; * @v: the interval value to refer to&n; *&n; * Refines the interval value with the reference value.&n; * The interval is changed to the range satisfying both intervals.&n; * The interval status (min, max, integer, etc.) are evaluated.&n; *&n; * Returns non-zero if the value is changed, zero if not changed.&n; */
DECL|function|snd_interval_refine
r_int
id|snd_interval_refine
c_func
(paren
id|snd_interval_t
op_star
id|i
comma
r_const
id|snd_interval_t
op_star
id|v
)paren
(brace
r_int
id|changed
op_assign
l_int|0
suffix:semicolon
m_assert
(paren
op_logical_neg
id|snd_interval_empty
c_func
(paren
id|i
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|i-&gt;min
OL
id|v-&gt;min
)paren
(brace
id|i-&gt;min
op_assign
id|v-&gt;min
suffix:semicolon
id|i-&gt;openmin
op_assign
id|v-&gt;openmin
suffix:semicolon
id|changed
op_assign
l_int|1
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|i-&gt;min
op_eq
id|v-&gt;min
op_logical_and
op_logical_neg
id|i-&gt;openmin
op_logical_and
id|v-&gt;openmin
)paren
(brace
id|i-&gt;openmin
op_assign
l_int|1
suffix:semicolon
id|changed
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|i-&gt;max
OG
id|v-&gt;max
)paren
(brace
id|i-&gt;max
op_assign
id|v-&gt;max
suffix:semicolon
id|i-&gt;openmax
op_assign
id|v-&gt;openmax
suffix:semicolon
id|changed
op_assign
l_int|1
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|i-&gt;max
op_eq
id|v-&gt;max
op_logical_and
op_logical_neg
id|i-&gt;openmax
op_logical_and
id|v-&gt;openmax
)paren
(brace
id|i-&gt;openmax
op_assign
l_int|1
suffix:semicolon
id|changed
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|i-&gt;integer
op_logical_and
id|v-&gt;integer
)paren
(brace
id|i-&gt;integer
op_assign
l_int|1
suffix:semicolon
id|changed
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|i-&gt;integer
)paren
(brace
r_if
c_cond
(paren
id|i-&gt;openmin
)paren
(brace
id|i-&gt;min
op_increment
suffix:semicolon
id|i-&gt;openmin
op_assign
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|i-&gt;openmax
)paren
(brace
id|i-&gt;max
op_decrement
suffix:semicolon
id|i-&gt;openmax
op_assign
l_int|0
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|i-&gt;openmin
op_logical_and
op_logical_neg
id|i-&gt;openmax
op_logical_and
id|i-&gt;min
op_eq
id|i-&gt;max
)paren
id|i-&gt;integer
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|snd_interval_checkempty
c_func
(paren
id|i
)paren
)paren
(brace
id|snd_interval_none
c_func
(paren
id|i
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_return
id|changed
suffix:semicolon
)brace
DECL|function|snd_interval_refine_first
r_int
id|snd_interval_refine_first
c_func
(paren
id|snd_interval_t
op_star
id|i
)paren
(brace
m_assert
(paren
op_logical_neg
id|snd_interval_empty
c_func
(paren
id|i
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|snd_interval_single
c_func
(paren
id|i
)paren
)paren
r_return
l_int|0
suffix:semicolon
id|i-&gt;max
op_assign
id|i-&gt;min
suffix:semicolon
id|i-&gt;openmax
op_assign
id|i-&gt;openmin
suffix:semicolon
r_if
c_cond
(paren
id|i-&gt;openmax
)paren
id|i-&gt;max
op_increment
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|snd_interval_refine_last
r_int
id|snd_interval_refine_last
c_func
(paren
id|snd_interval_t
op_star
id|i
)paren
(brace
m_assert
(paren
op_logical_neg
id|snd_interval_empty
c_func
(paren
id|i
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|snd_interval_single
c_func
(paren
id|i
)paren
)paren
r_return
l_int|0
suffix:semicolon
id|i-&gt;min
op_assign
id|i-&gt;max
suffix:semicolon
id|i-&gt;openmin
op_assign
id|i-&gt;openmax
suffix:semicolon
r_if
c_cond
(paren
id|i-&gt;openmin
)paren
id|i-&gt;min
op_decrement
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|snd_interval_refine_set
r_int
id|snd_interval_refine_set
c_func
(paren
id|snd_interval_t
op_star
id|i
comma
r_int
r_int
id|val
)paren
(brace
id|snd_interval_t
id|t
suffix:semicolon
id|t.empty
op_assign
l_int|0
suffix:semicolon
id|t.min
op_assign
id|t.max
op_assign
id|val
suffix:semicolon
id|t.openmin
op_assign
id|t.openmax
op_assign
l_int|0
suffix:semicolon
id|t.integer
op_assign
l_int|1
suffix:semicolon
r_return
id|snd_interval_refine
c_func
(paren
id|i
comma
op_amp
id|t
)paren
suffix:semicolon
)brace
DECL|function|snd_interval_mul
r_void
id|snd_interval_mul
c_func
(paren
r_const
id|snd_interval_t
op_star
id|a
comma
r_const
id|snd_interval_t
op_star
id|b
comma
id|snd_interval_t
op_star
id|c
)paren
(brace
r_if
c_cond
(paren
id|a-&gt;empty
op_logical_or
id|b-&gt;empty
)paren
(brace
id|snd_interval_none
c_func
(paren
id|c
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|c-&gt;empty
op_assign
l_int|0
suffix:semicolon
id|c-&gt;min
op_assign
id|mul
c_func
(paren
id|a-&gt;min
comma
id|b-&gt;min
)paren
suffix:semicolon
id|c-&gt;openmin
op_assign
(paren
id|a-&gt;openmin
op_logical_or
id|b-&gt;openmin
)paren
suffix:semicolon
id|c-&gt;max
op_assign
id|mul
c_func
(paren
id|a-&gt;max
comma
id|b-&gt;max
)paren
suffix:semicolon
id|c-&gt;openmax
op_assign
(paren
id|a-&gt;openmax
op_logical_or
id|b-&gt;openmax
)paren
suffix:semicolon
id|c-&gt;integer
op_assign
(paren
id|a-&gt;integer
op_logical_and
id|b-&gt;integer
)paren
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_interval_div - refine the interval value with division&n; *&n; * c = a / b&n; *&n; * Returns non-zero if the value is changed, zero if not changed.&n; */
DECL|function|snd_interval_div
r_void
id|snd_interval_div
c_func
(paren
r_const
id|snd_interval_t
op_star
id|a
comma
r_const
id|snd_interval_t
op_star
id|b
comma
id|snd_interval_t
op_star
id|c
)paren
(brace
r_int
r_int
id|r
suffix:semicolon
r_if
c_cond
(paren
id|a-&gt;empty
op_logical_or
id|b-&gt;empty
)paren
(brace
id|snd_interval_none
c_func
(paren
id|c
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|c-&gt;empty
op_assign
l_int|0
suffix:semicolon
id|c-&gt;min
op_assign
id|div32
c_func
(paren
id|a-&gt;min
comma
id|b-&gt;max
comma
op_amp
id|r
)paren
suffix:semicolon
id|c-&gt;openmin
op_assign
(paren
id|r
op_logical_or
id|a-&gt;openmin
op_logical_or
id|b-&gt;openmax
)paren
suffix:semicolon
r_if
c_cond
(paren
id|b-&gt;min
OG
l_int|0
)paren
(brace
id|c-&gt;max
op_assign
id|div32
c_func
(paren
id|a-&gt;max
comma
id|b-&gt;min
comma
op_amp
id|r
)paren
suffix:semicolon
r_if
c_cond
(paren
id|r
)paren
(brace
id|c-&gt;max
op_increment
suffix:semicolon
id|c-&gt;openmax
op_assign
l_int|1
suffix:semicolon
)brace
r_else
id|c-&gt;openmax
op_assign
(paren
id|a-&gt;openmax
op_logical_or
id|b-&gt;openmin
)paren
suffix:semicolon
)brace
r_else
(brace
id|c-&gt;max
op_assign
id|UINT_MAX
suffix:semicolon
id|c-&gt;openmax
op_assign
l_int|0
suffix:semicolon
)brace
id|c-&gt;integer
op_assign
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_interval_muldivk - refine the interval value&n; *&n; * c = a * b / k&n; *&n; * Returns non-zero if the value is changed, zero if not changed.&n; */
DECL|function|snd_interval_muldivk
r_void
id|snd_interval_muldivk
c_func
(paren
r_const
id|snd_interval_t
op_star
id|a
comma
r_const
id|snd_interval_t
op_star
id|b
comma
r_int
r_int
id|k
comma
id|snd_interval_t
op_star
id|c
)paren
(brace
r_int
r_int
id|r
suffix:semicolon
r_if
c_cond
(paren
id|a-&gt;empty
op_logical_or
id|b-&gt;empty
)paren
(brace
id|snd_interval_none
c_func
(paren
id|c
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|c-&gt;empty
op_assign
l_int|0
suffix:semicolon
id|c-&gt;min
op_assign
id|muldiv32
c_func
(paren
id|a-&gt;min
comma
id|b-&gt;min
comma
id|k
comma
op_amp
id|r
)paren
suffix:semicolon
id|c-&gt;openmin
op_assign
(paren
id|r
op_logical_or
id|a-&gt;openmin
op_logical_or
id|b-&gt;openmin
)paren
suffix:semicolon
id|c-&gt;max
op_assign
id|muldiv32
c_func
(paren
id|a-&gt;max
comma
id|b-&gt;max
comma
id|k
comma
op_amp
id|r
)paren
suffix:semicolon
r_if
c_cond
(paren
id|r
)paren
(brace
id|c-&gt;max
op_increment
suffix:semicolon
id|c-&gt;openmax
op_assign
l_int|1
suffix:semicolon
)brace
r_else
id|c-&gt;openmax
op_assign
(paren
id|a-&gt;openmax
op_logical_or
id|b-&gt;openmax
)paren
suffix:semicolon
id|c-&gt;integer
op_assign
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_interval_mulkdiv - refine the interval value&n; *&n; * c = a * k / b&n; *&n; * Returns non-zero if the value is changed, zero if not changed.&n; */
DECL|function|snd_interval_mulkdiv
r_void
id|snd_interval_mulkdiv
c_func
(paren
r_const
id|snd_interval_t
op_star
id|a
comma
r_int
r_int
id|k
comma
r_const
id|snd_interval_t
op_star
id|b
comma
id|snd_interval_t
op_star
id|c
)paren
(brace
r_int
r_int
id|r
suffix:semicolon
r_if
c_cond
(paren
id|a-&gt;empty
op_logical_or
id|b-&gt;empty
)paren
(brace
id|snd_interval_none
c_func
(paren
id|c
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|c-&gt;empty
op_assign
l_int|0
suffix:semicolon
id|c-&gt;min
op_assign
id|muldiv32
c_func
(paren
id|a-&gt;min
comma
id|k
comma
id|b-&gt;max
comma
op_amp
id|r
)paren
suffix:semicolon
id|c-&gt;openmin
op_assign
(paren
id|r
op_logical_or
id|a-&gt;openmin
op_logical_or
id|b-&gt;openmax
)paren
suffix:semicolon
r_if
c_cond
(paren
id|b-&gt;min
OG
l_int|0
)paren
(brace
id|c-&gt;max
op_assign
id|muldiv32
c_func
(paren
id|a-&gt;max
comma
id|k
comma
id|b-&gt;min
comma
op_amp
id|r
)paren
suffix:semicolon
r_if
c_cond
(paren
id|r
)paren
(brace
id|c-&gt;max
op_increment
suffix:semicolon
id|c-&gt;openmax
op_assign
l_int|1
suffix:semicolon
)brace
r_else
id|c-&gt;openmax
op_assign
(paren
id|a-&gt;openmax
op_logical_or
id|b-&gt;openmin
)paren
suffix:semicolon
)brace
r_else
(brace
id|c-&gt;max
op_assign
id|UINT_MAX
suffix:semicolon
id|c-&gt;openmax
op_assign
l_int|0
suffix:semicolon
)brace
id|c-&gt;integer
op_assign
l_int|0
suffix:semicolon
)brace
DECL|macro|assert
macro_line|#undef assert
multiline_comment|/* ---- */
multiline_comment|/**&n; * snd_interval_ratnum - refine the interval value&n; *&n; * Returns non-zero if the value is changed, zero if not changed.&n; */
DECL|function|snd_interval_ratnum
r_int
id|snd_interval_ratnum
c_func
(paren
id|snd_interval_t
op_star
id|i
comma
r_int
r_int
id|rats_count
comma
id|ratnum_t
op_star
id|rats
comma
r_int
r_int
op_star
id|nump
comma
r_int
r_int
op_star
id|denp
)paren
(brace
r_int
r_int
id|best_num
comma
id|best_diff
comma
id|best_den
suffix:semicolon
r_int
r_int
id|k
suffix:semicolon
id|snd_interval_t
id|t
suffix:semicolon
r_int
id|err
suffix:semicolon
id|best_num
op_assign
id|best_den
op_assign
id|best_diff
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|k
op_assign
l_int|0
suffix:semicolon
id|k
OL
id|rats_count
suffix:semicolon
op_increment
id|k
)paren
(brace
r_int
r_int
id|num
op_assign
id|rats
(braket
id|k
)braket
dot
id|num
suffix:semicolon
r_int
r_int
id|den
suffix:semicolon
r_int
r_int
id|q
op_assign
id|i-&gt;min
suffix:semicolon
r_int
id|diff
suffix:semicolon
r_if
c_cond
(paren
id|q
op_eq
l_int|0
)paren
id|q
op_assign
l_int|1
suffix:semicolon
id|den
op_assign
id|div_down
c_func
(paren
id|num
comma
id|q
)paren
suffix:semicolon
r_if
c_cond
(paren
id|den
OL
id|rats
(braket
id|k
)braket
dot
id|den_min
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|den
OG
id|rats
(braket
id|k
)braket
dot
id|den_max
)paren
id|den
op_assign
id|rats
(braket
id|k
)braket
dot
id|den_max
suffix:semicolon
r_else
(brace
r_int
r_int
id|r
suffix:semicolon
id|r
op_assign
(paren
id|den
op_minus
id|rats
(braket
id|k
)braket
dot
id|den_min
)paren
op_mod
id|rats
(braket
id|k
)braket
dot
id|den_step
suffix:semicolon
r_if
c_cond
(paren
id|r
op_ne
l_int|0
)paren
id|den
op_sub_assign
id|r
suffix:semicolon
)brace
id|diff
op_assign
id|num
op_minus
id|q
op_star
id|den
suffix:semicolon
r_if
c_cond
(paren
id|best_num
op_eq
l_int|0
op_logical_or
id|diff
op_star
id|best_den
OL
id|best_diff
op_star
id|den
)paren
(brace
id|best_diff
op_assign
id|diff
suffix:semicolon
id|best_den
op_assign
id|den
suffix:semicolon
id|best_num
op_assign
id|num
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|best_den
op_eq
l_int|0
)paren
(brace
id|i-&gt;empty
op_assign
l_int|1
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|t.min
op_assign
id|div_down
c_func
(paren
id|best_num
comma
id|best_den
)paren
suffix:semicolon
id|t.openmin
op_assign
op_logical_neg
op_logical_neg
(paren
id|best_num
op_mod
id|best_den
)paren
suffix:semicolon
id|best_num
op_assign
id|best_den
op_assign
id|best_diff
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|k
op_assign
l_int|0
suffix:semicolon
id|k
OL
id|rats_count
suffix:semicolon
op_increment
id|k
)paren
(brace
r_int
r_int
id|num
op_assign
id|rats
(braket
id|k
)braket
dot
id|num
suffix:semicolon
r_int
r_int
id|den
suffix:semicolon
r_int
r_int
id|q
op_assign
id|i-&gt;max
suffix:semicolon
r_int
id|diff
suffix:semicolon
r_if
c_cond
(paren
id|q
op_eq
l_int|0
)paren
(brace
id|i-&gt;empty
op_assign
l_int|1
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|den
op_assign
id|div_up
c_func
(paren
id|num
comma
id|q
)paren
suffix:semicolon
r_if
c_cond
(paren
id|den
OG
id|rats
(braket
id|k
)braket
dot
id|den_max
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|den
OL
id|rats
(braket
id|k
)braket
dot
id|den_min
)paren
id|den
op_assign
id|rats
(braket
id|k
)braket
dot
id|den_min
suffix:semicolon
r_else
(brace
r_int
r_int
id|r
suffix:semicolon
id|r
op_assign
(paren
id|den
op_minus
id|rats
(braket
id|k
)braket
dot
id|den_min
)paren
op_mod
id|rats
(braket
id|k
)braket
dot
id|den_step
suffix:semicolon
r_if
c_cond
(paren
id|r
op_ne
l_int|0
)paren
id|den
op_add_assign
id|rats
(braket
id|k
)braket
dot
id|den_step
op_minus
id|r
suffix:semicolon
)brace
id|diff
op_assign
id|q
op_star
id|den
op_minus
id|num
suffix:semicolon
r_if
c_cond
(paren
id|best_num
op_eq
l_int|0
op_logical_or
id|diff
op_star
id|best_den
OL
id|best_diff
op_star
id|den
)paren
(brace
id|best_diff
op_assign
id|diff
suffix:semicolon
id|best_den
op_assign
id|den
suffix:semicolon
id|best_num
op_assign
id|num
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|best_den
op_eq
l_int|0
)paren
(brace
id|i-&gt;empty
op_assign
l_int|1
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|t.max
op_assign
id|div_up
c_func
(paren
id|best_num
comma
id|best_den
)paren
suffix:semicolon
id|t.openmax
op_assign
op_logical_neg
op_logical_neg
(paren
id|best_num
op_mod
id|best_den
)paren
suffix:semicolon
id|t.integer
op_assign
l_int|0
suffix:semicolon
id|err
op_assign
id|snd_interval_refine
c_func
(paren
id|i
comma
op_amp
id|t
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_if
c_cond
(paren
id|snd_interval_single
c_func
(paren
id|i
)paren
)paren
(brace
r_if
c_cond
(paren
id|nump
)paren
op_star
id|nump
op_assign
id|best_num
suffix:semicolon
r_if
c_cond
(paren
id|denp
)paren
op_star
id|denp
op_assign
id|best_den
suffix:semicolon
)brace
r_return
id|err
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_interval_ratden - refine the interval value&n; *&n; * Returns non-zero if the value is changed, zero if not changed.&n; */
DECL|function|snd_interval_ratden
r_int
id|snd_interval_ratden
c_func
(paren
id|snd_interval_t
op_star
id|i
comma
r_int
r_int
id|rats_count
comma
id|ratden_t
op_star
id|rats
comma
r_int
r_int
op_star
id|nump
comma
r_int
r_int
op_star
id|denp
)paren
(brace
r_int
r_int
id|best_num
comma
id|best_diff
comma
id|best_den
suffix:semicolon
r_int
r_int
id|k
suffix:semicolon
id|snd_interval_t
id|t
suffix:semicolon
r_int
id|err
suffix:semicolon
id|best_num
op_assign
id|best_den
op_assign
id|best_diff
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|k
op_assign
l_int|0
suffix:semicolon
id|k
OL
id|rats_count
suffix:semicolon
op_increment
id|k
)paren
(brace
r_int
r_int
id|num
suffix:semicolon
r_int
r_int
id|den
op_assign
id|rats
(braket
id|k
)braket
dot
id|den
suffix:semicolon
r_int
r_int
id|q
op_assign
id|i-&gt;min
suffix:semicolon
r_int
id|diff
suffix:semicolon
id|num
op_assign
id|mul
c_func
(paren
id|q
comma
id|den
)paren
suffix:semicolon
r_if
c_cond
(paren
id|num
OG
id|rats
(braket
id|k
)braket
dot
id|num_max
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|num
OL
id|rats
(braket
id|k
)braket
dot
id|num_min
)paren
id|num
op_assign
id|rats
(braket
id|k
)braket
dot
id|num_max
suffix:semicolon
r_else
(brace
r_int
r_int
id|r
suffix:semicolon
id|r
op_assign
(paren
id|num
op_minus
id|rats
(braket
id|k
)braket
dot
id|num_min
)paren
op_mod
id|rats
(braket
id|k
)braket
dot
id|num_step
suffix:semicolon
r_if
c_cond
(paren
id|r
op_ne
l_int|0
)paren
id|num
op_add_assign
id|rats
(braket
id|k
)braket
dot
id|num_step
op_minus
id|r
suffix:semicolon
)brace
id|diff
op_assign
id|num
op_minus
id|q
op_star
id|den
suffix:semicolon
r_if
c_cond
(paren
id|best_num
op_eq
l_int|0
op_logical_or
id|diff
op_star
id|best_den
OL
id|best_diff
op_star
id|den
)paren
(brace
id|best_diff
op_assign
id|diff
suffix:semicolon
id|best_den
op_assign
id|den
suffix:semicolon
id|best_num
op_assign
id|num
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|best_den
op_eq
l_int|0
)paren
(brace
id|i-&gt;empty
op_assign
l_int|1
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|t.min
op_assign
id|div_down
c_func
(paren
id|best_num
comma
id|best_den
)paren
suffix:semicolon
id|t.openmin
op_assign
op_logical_neg
op_logical_neg
(paren
id|best_num
op_mod
id|best_den
)paren
suffix:semicolon
id|best_num
op_assign
id|best_den
op_assign
id|best_diff
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|k
op_assign
l_int|0
suffix:semicolon
id|k
OL
id|rats_count
suffix:semicolon
op_increment
id|k
)paren
(brace
r_int
r_int
id|num
suffix:semicolon
r_int
r_int
id|den
op_assign
id|rats
(braket
id|k
)braket
dot
id|den
suffix:semicolon
r_int
r_int
id|q
op_assign
id|i-&gt;max
suffix:semicolon
r_int
id|diff
suffix:semicolon
id|num
op_assign
id|mul
c_func
(paren
id|q
comma
id|den
)paren
suffix:semicolon
r_if
c_cond
(paren
id|num
OL
id|rats
(braket
id|k
)braket
dot
id|num_min
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|num
OG
id|rats
(braket
id|k
)braket
dot
id|num_max
)paren
id|num
op_assign
id|rats
(braket
id|k
)braket
dot
id|num_max
suffix:semicolon
r_else
(brace
r_int
r_int
id|r
suffix:semicolon
id|r
op_assign
(paren
id|num
op_minus
id|rats
(braket
id|k
)braket
dot
id|num_min
)paren
op_mod
id|rats
(braket
id|k
)braket
dot
id|num_step
suffix:semicolon
r_if
c_cond
(paren
id|r
op_ne
l_int|0
)paren
id|num
op_sub_assign
id|r
suffix:semicolon
)brace
id|diff
op_assign
id|q
op_star
id|den
op_minus
id|num
suffix:semicolon
r_if
c_cond
(paren
id|best_num
op_eq
l_int|0
op_logical_or
id|diff
op_star
id|best_den
OL
id|best_diff
op_star
id|den
)paren
(brace
id|best_diff
op_assign
id|diff
suffix:semicolon
id|best_den
op_assign
id|den
suffix:semicolon
id|best_num
op_assign
id|num
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|best_den
op_eq
l_int|0
)paren
(brace
id|i-&gt;empty
op_assign
l_int|1
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|t.max
op_assign
id|div_up
c_func
(paren
id|best_num
comma
id|best_den
)paren
suffix:semicolon
id|t.openmax
op_assign
op_logical_neg
op_logical_neg
(paren
id|best_num
op_mod
id|best_den
)paren
suffix:semicolon
id|t.integer
op_assign
l_int|0
suffix:semicolon
id|err
op_assign
id|snd_interval_refine
c_func
(paren
id|i
comma
op_amp
id|t
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_if
c_cond
(paren
id|snd_interval_single
c_func
(paren
id|i
)paren
)paren
(brace
r_if
c_cond
(paren
id|nump
)paren
op_star
id|nump
op_assign
id|best_num
suffix:semicolon
r_if
c_cond
(paren
id|denp
)paren
op_star
id|denp
op_assign
id|best_den
suffix:semicolon
)brace
r_return
id|err
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_interval_list - refine the interval value from the list&n; * @i: the interval value to refine&n; * @count: the number of elements in the list&n; * @list: the value list&n; * @mask: the bit-mask to evaluate&n; *&n; * Refines the interval value from the list.&n; * When mask is non-zero, only the elements corresponding to bit 1 are&n; * evaluated.&n; *&n; * Returns non-zero if the value is changed, zero if not changed.&n; */
DECL|function|snd_interval_list
r_int
id|snd_interval_list
c_func
(paren
id|snd_interval_t
op_star
id|i
comma
r_int
r_int
id|count
comma
r_int
r_int
op_star
id|list
comma
r_int
r_int
id|mask
)paren
(brace
r_int
r_int
id|k
suffix:semicolon
r_int
id|changed
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|k
op_assign
l_int|0
suffix:semicolon
id|k
OL
id|count
suffix:semicolon
id|k
op_increment
)paren
(brace
r_if
c_cond
(paren
id|mask
op_logical_and
op_logical_neg
(paren
id|mask
op_amp
(paren
l_int|1
op_lshift
id|k
)paren
)paren
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|i-&gt;min
op_eq
id|list
(braket
id|k
)braket
op_logical_and
op_logical_neg
id|i-&gt;openmin
)paren
r_goto
id|_l1
suffix:semicolon
r_if
c_cond
(paren
id|i-&gt;min
OL
id|list
(braket
id|k
)braket
)paren
(brace
id|i-&gt;min
op_assign
id|list
(braket
id|k
)braket
suffix:semicolon
id|i-&gt;openmin
op_assign
l_int|0
suffix:semicolon
id|changed
op_assign
l_int|1
suffix:semicolon
r_goto
id|_l1
suffix:semicolon
)brace
)brace
id|i-&gt;empty
op_assign
l_int|1
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
id|_l1
suffix:colon
r_for
c_loop
(paren
id|k
op_assign
id|count
suffix:semicolon
id|k
op_decrement
OG
l_int|0
suffix:semicolon
)paren
(brace
r_if
c_cond
(paren
id|mask
op_logical_and
op_logical_neg
(paren
id|mask
op_amp
(paren
l_int|1
op_lshift
id|k
)paren
)paren
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|i-&gt;max
op_eq
id|list
(braket
id|k
)braket
op_logical_and
op_logical_neg
id|i-&gt;openmax
)paren
r_goto
id|_l2
suffix:semicolon
r_if
c_cond
(paren
id|i-&gt;max
OG
id|list
(braket
id|k
)braket
)paren
(brace
id|i-&gt;max
op_assign
id|list
(braket
id|k
)braket
suffix:semicolon
id|i-&gt;openmax
op_assign
l_int|0
suffix:semicolon
id|changed
op_assign
l_int|1
suffix:semicolon
r_goto
id|_l2
suffix:semicolon
)brace
)brace
id|i-&gt;empty
op_assign
l_int|1
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
id|_l2
suffix:colon
r_if
c_cond
(paren
id|snd_interval_checkempty
c_func
(paren
id|i
)paren
)paren
(brace
id|i-&gt;empty
op_assign
l_int|1
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_return
id|changed
suffix:semicolon
)brace
DECL|function|snd_interval_step
r_int
id|snd_interval_step
c_func
(paren
id|snd_interval_t
op_star
id|i
comma
r_int
r_int
id|min
comma
r_int
r_int
id|step
)paren
(brace
r_int
r_int
id|n
suffix:semicolon
r_int
id|changed
op_assign
l_int|0
suffix:semicolon
id|n
op_assign
(paren
id|i-&gt;min
op_minus
id|min
)paren
op_mod
id|step
suffix:semicolon
r_if
c_cond
(paren
id|n
op_ne
l_int|0
op_logical_or
id|i-&gt;openmin
)paren
(brace
id|i-&gt;min
op_add_assign
id|step
op_minus
id|n
suffix:semicolon
id|changed
op_assign
l_int|1
suffix:semicolon
)brace
id|n
op_assign
(paren
id|i-&gt;max
op_minus
id|min
)paren
op_mod
id|step
suffix:semicolon
r_if
c_cond
(paren
id|n
op_ne
l_int|0
op_logical_or
id|i-&gt;openmax
)paren
(brace
id|i-&gt;max
op_sub_assign
id|n
suffix:semicolon
id|changed
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|snd_interval_checkempty
c_func
(paren
id|i
)paren
)paren
(brace
id|i-&gt;empty
op_assign
l_int|1
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_return
id|changed
suffix:semicolon
)brace
multiline_comment|/* Info constraints helpers */
multiline_comment|/**&n; * snd_pcm_hw_rule_add - add the hw-constraint rule&n; * @runtime: the pcm runtime instance&n; * @cond: condition bits&n; * @var: the variable to evaluate&n; * @func: the evaluation function&n; * @private: the private data pointer passed to function&n; * @dep: the dependent variables&n; *&n; * Returns zero if successful, or a negative error code on failure.&n; */
DECL|function|snd_pcm_hw_rule_add
r_int
id|snd_pcm_hw_rule_add
c_func
(paren
id|snd_pcm_runtime_t
op_star
id|runtime
comma
r_int
r_int
id|cond
comma
r_int
id|var
comma
id|snd_pcm_hw_rule_func_t
id|func
comma
r_void
op_star
r_private
comma
r_int
id|dep
comma
dot
dot
dot
)paren
(brace
id|snd_pcm_hw_constraints_t
op_star
id|constrs
op_assign
op_amp
id|runtime-&gt;hw_constraints
suffix:semicolon
id|snd_pcm_hw_rule_t
op_star
id|c
suffix:semicolon
r_int
r_int
id|k
suffix:semicolon
id|va_list
id|args
suffix:semicolon
id|va_start
c_func
(paren
id|args
comma
id|dep
)paren
suffix:semicolon
r_if
c_cond
(paren
id|constrs-&gt;rules_num
op_ge
id|constrs-&gt;rules_all
)paren
(brace
id|snd_pcm_hw_rule_t
op_star
id|old
op_assign
id|constrs-&gt;rules
suffix:semicolon
r_if
c_cond
(paren
id|constrs-&gt;rules_all
op_eq
l_int|0
)paren
id|constrs-&gt;rules_all
op_assign
l_int|32
suffix:semicolon
r_else
(brace
id|old
op_assign
id|constrs-&gt;rules
suffix:semicolon
id|constrs-&gt;rules_all
op_add_assign
l_int|10
suffix:semicolon
)brace
id|constrs-&gt;rules
op_assign
id|snd_kcalloc
c_func
(paren
id|constrs-&gt;rules_all
op_star
r_sizeof
(paren
op_star
id|c
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|constrs-&gt;rules
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
r_if
c_cond
(paren
id|old
)paren
(brace
id|memcpy
c_func
(paren
id|constrs-&gt;rules
comma
id|old
comma
id|constrs-&gt;rules_num
op_star
r_sizeof
(paren
op_star
id|c
)paren
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|old
)paren
suffix:semicolon
)brace
)brace
id|c
op_assign
op_amp
id|constrs-&gt;rules
(braket
id|constrs-&gt;rules_num
)braket
suffix:semicolon
id|c-&gt;cond
op_assign
id|cond
suffix:semicolon
id|c-&gt;func
op_assign
id|func
suffix:semicolon
id|c-&gt;var
op_assign
id|var
suffix:semicolon
id|c
op_member_access_from_pointer
r_private
op_assign
r_private
suffix:semicolon
id|k
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
l_int|1
)paren
(brace
id|snd_assert
c_func
(paren
id|k
OL
r_sizeof
(paren
id|c-&gt;deps
)paren
op_div
r_sizeof
(paren
id|c-&gt;deps
(braket
l_int|0
)braket
)paren
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|c-&gt;deps
(braket
id|k
op_increment
)braket
op_assign
id|dep
suffix:semicolon
r_if
c_cond
(paren
id|dep
OL
l_int|0
)paren
r_break
suffix:semicolon
id|dep
op_assign
id|va_arg
c_func
(paren
id|args
comma
r_int
)paren
suffix:semicolon
)brace
id|constrs-&gt;rules_num
op_increment
suffix:semicolon
id|va_end
c_func
(paren
id|args
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_pcm_hw_constraint_mask&n; */
DECL|function|snd_pcm_hw_constraint_mask
r_int
id|snd_pcm_hw_constraint_mask
c_func
(paren
id|snd_pcm_runtime_t
op_star
id|runtime
comma
id|snd_pcm_hw_param_t
id|var
comma
id|u_int32_t
id|mask
)paren
(brace
id|snd_pcm_hw_constraints_t
op_star
id|constrs
op_assign
op_amp
id|runtime-&gt;hw_constraints
suffix:semicolon
id|snd_mask_t
op_star
id|maskp
op_assign
id|constrs_mask
c_func
(paren
id|constrs
comma
id|var
)paren
suffix:semicolon
op_star
id|maskp-&gt;bits
op_and_assign
id|mask
suffix:semicolon
id|memset
c_func
(paren
id|maskp-&gt;bits
op_plus
l_int|1
comma
l_int|0
comma
(paren
id|SNDRV_MASK_MAX
op_minus
l_int|32
)paren
op_div
l_int|8
)paren
suffix:semicolon
multiline_comment|/* clear rest */
r_if
c_cond
(paren
op_star
id|maskp-&gt;bits
op_eq
l_int|0
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_pcm_hw_constraint_mask64&n; */
DECL|function|snd_pcm_hw_constraint_mask64
r_int
id|snd_pcm_hw_constraint_mask64
c_func
(paren
id|snd_pcm_runtime_t
op_star
id|runtime
comma
id|snd_pcm_hw_param_t
id|var
comma
id|u_int64_t
id|mask
)paren
(brace
id|snd_pcm_hw_constraints_t
op_star
id|constrs
op_assign
op_amp
id|runtime-&gt;hw_constraints
suffix:semicolon
id|snd_mask_t
op_star
id|maskp
op_assign
id|constrs_mask
c_func
(paren
id|constrs
comma
id|var
)paren
suffix:semicolon
id|maskp-&gt;bits
(braket
l_int|0
)braket
op_and_assign
(paren
id|u_int32_t
)paren
id|mask
suffix:semicolon
id|maskp-&gt;bits
(braket
l_int|1
)braket
op_and_assign
(paren
id|u_int32_t
)paren
(paren
id|mask
op_rshift
l_int|32
)paren
suffix:semicolon
id|memset
c_func
(paren
id|maskp-&gt;bits
op_plus
l_int|2
comma
l_int|0
comma
(paren
id|SNDRV_MASK_MAX
op_minus
l_int|64
)paren
op_div
l_int|8
)paren
suffix:semicolon
multiline_comment|/* clear rest */
r_if
c_cond
(paren
op_logical_neg
id|maskp-&gt;bits
(braket
l_int|0
)braket
op_logical_and
op_logical_neg
id|maskp-&gt;bits
(braket
l_int|1
)braket
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_pcm_hw_constraint_integer&n; */
DECL|function|snd_pcm_hw_constraint_integer
r_int
id|snd_pcm_hw_constraint_integer
c_func
(paren
id|snd_pcm_runtime_t
op_star
id|runtime
comma
id|snd_pcm_hw_param_t
id|var
)paren
(brace
id|snd_pcm_hw_constraints_t
op_star
id|constrs
op_assign
op_amp
id|runtime-&gt;hw_constraints
suffix:semicolon
r_return
id|snd_interval_setinteger
c_func
(paren
id|constrs_interval
c_func
(paren
id|constrs
comma
id|var
)paren
)paren
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_pcm_hw_constraint_minmax&n; */
DECL|function|snd_pcm_hw_constraint_minmax
r_int
id|snd_pcm_hw_constraint_minmax
c_func
(paren
id|snd_pcm_runtime_t
op_star
id|runtime
comma
id|snd_pcm_hw_param_t
id|var
comma
r_int
r_int
id|min
comma
r_int
r_int
id|max
)paren
(brace
id|snd_pcm_hw_constraints_t
op_star
id|constrs
op_assign
op_amp
id|runtime-&gt;hw_constraints
suffix:semicolon
id|snd_interval_t
id|t
suffix:semicolon
id|t.min
op_assign
id|min
suffix:semicolon
id|t.max
op_assign
id|max
suffix:semicolon
id|t.openmin
op_assign
id|t.openmax
op_assign
l_int|0
suffix:semicolon
id|t.integer
op_assign
l_int|0
suffix:semicolon
r_return
id|snd_interval_refine
c_func
(paren
id|constrs_interval
c_func
(paren
id|constrs
comma
id|var
)paren
comma
op_amp
id|t
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_hw_rule_list
r_static
r_int
id|snd_pcm_hw_rule_list
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_rule_t
op_star
id|rule
)paren
(brace
id|snd_pcm_hw_constraint_list_t
op_star
id|list
op_assign
id|rule
op_member_access_from_pointer
r_private
suffix:semicolon
r_return
id|snd_interval_list
c_func
(paren
id|hw_param_interval
c_func
(paren
id|params
comma
id|rule-&gt;var
)paren
comma
id|list-&gt;count
comma
id|list-&gt;list
comma
id|list-&gt;mask
)paren
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_pcm_hw_constraint_list&n; */
DECL|function|snd_pcm_hw_constraint_list
r_int
id|snd_pcm_hw_constraint_list
c_func
(paren
id|snd_pcm_runtime_t
op_star
id|runtime
comma
r_int
r_int
id|cond
comma
id|snd_pcm_hw_param_t
id|var
comma
id|snd_pcm_hw_constraint_list_t
op_star
id|l
)paren
(brace
r_return
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
id|cond
comma
id|var
comma
id|snd_pcm_hw_rule_list
comma
id|l
comma
id|var
comma
op_minus
l_int|1
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_hw_rule_ratnums
r_static
r_int
id|snd_pcm_hw_rule_ratnums
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_rule_t
op_star
id|rule
)paren
(brace
id|snd_pcm_hw_constraint_ratnums_t
op_star
id|r
op_assign
id|rule
op_member_access_from_pointer
r_private
suffix:semicolon
r_int
r_int
id|num
op_assign
l_int|0
comma
id|den
op_assign
l_int|0
suffix:semicolon
r_int
id|err
suffix:semicolon
id|err
op_assign
id|snd_interval_ratnum
c_func
(paren
id|hw_param_interval
c_func
(paren
id|params
comma
id|rule-&gt;var
)paren
comma
id|r-&gt;nrats
comma
id|r-&gt;rats
comma
op_amp
id|num
comma
op_amp
id|den
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
op_ge
l_int|0
op_logical_and
id|den
op_logical_and
id|rule-&gt;var
op_eq
id|SNDRV_PCM_HW_PARAM_RATE
)paren
(brace
id|params-&gt;rate_num
op_assign
id|num
suffix:semicolon
id|params-&gt;rate_den
op_assign
id|den
suffix:semicolon
)brace
r_return
id|err
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_pcm_hw_constraint_ratnums&n; */
DECL|function|snd_pcm_hw_constraint_ratnums
r_int
id|snd_pcm_hw_constraint_ratnums
c_func
(paren
id|snd_pcm_runtime_t
op_star
id|runtime
comma
r_int
r_int
id|cond
comma
id|snd_pcm_hw_param_t
id|var
comma
id|snd_pcm_hw_constraint_ratnums_t
op_star
id|r
)paren
(brace
r_return
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
id|cond
comma
id|var
comma
id|snd_pcm_hw_rule_ratnums
comma
id|r
comma
id|var
comma
op_minus
l_int|1
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_hw_rule_ratdens
r_static
r_int
id|snd_pcm_hw_rule_ratdens
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_rule_t
op_star
id|rule
)paren
(brace
id|snd_pcm_hw_constraint_ratdens_t
op_star
id|r
op_assign
id|rule
op_member_access_from_pointer
r_private
suffix:semicolon
r_int
r_int
id|num
op_assign
l_int|0
comma
id|den
op_assign
l_int|0
suffix:semicolon
r_int
id|err
op_assign
id|snd_interval_ratden
c_func
(paren
id|hw_param_interval
c_func
(paren
id|params
comma
id|rule-&gt;var
)paren
comma
id|r-&gt;nrats
comma
id|r-&gt;rats
comma
op_amp
id|num
comma
op_amp
id|den
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
op_ge
l_int|0
op_logical_and
id|den
op_logical_and
id|rule-&gt;var
op_eq
id|SNDRV_PCM_HW_PARAM_RATE
)paren
(brace
id|params-&gt;rate_num
op_assign
id|num
suffix:semicolon
id|params-&gt;rate_den
op_assign
id|den
suffix:semicolon
)brace
r_return
id|err
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_pcm_hw_constraint_ratdens&n; */
DECL|function|snd_pcm_hw_constraint_ratdens
r_int
id|snd_pcm_hw_constraint_ratdens
c_func
(paren
id|snd_pcm_runtime_t
op_star
id|runtime
comma
r_int
r_int
id|cond
comma
id|snd_pcm_hw_param_t
id|var
comma
id|snd_pcm_hw_constraint_ratdens_t
op_star
id|r
)paren
(brace
r_return
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
id|cond
comma
id|var
comma
id|snd_pcm_hw_rule_ratdens
comma
id|r
comma
id|var
comma
op_minus
l_int|1
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_hw_rule_msbits
r_static
r_int
id|snd_pcm_hw_rule_msbits
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_rule_t
op_star
id|rule
)paren
(brace
r_int
r_int
id|l
op_assign
(paren
r_int
r_int
)paren
id|rule
op_member_access_from_pointer
r_private
suffix:semicolon
r_int
id|width
op_assign
id|l
op_amp
l_int|0xffff
suffix:semicolon
r_int
r_int
id|msbits
op_assign
id|l
op_rshift
l_int|16
suffix:semicolon
id|snd_interval_t
op_star
id|i
op_assign
id|hw_param_interval
c_func
(paren
id|params
comma
id|SNDRV_PCM_HW_PARAM_SAMPLE_BITS
)paren
suffix:semicolon
r_if
c_cond
(paren
id|snd_interval_single
c_func
(paren
id|i
)paren
op_logical_and
id|snd_interval_value
c_func
(paren
id|i
)paren
op_eq
id|width
)paren
id|params-&gt;msbits
op_assign
id|msbits
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_pcm_hw_constraint_msbits&n; */
DECL|function|snd_pcm_hw_constraint_msbits
r_int
id|snd_pcm_hw_constraint_msbits
c_func
(paren
id|snd_pcm_runtime_t
op_star
id|runtime
comma
r_int
r_int
id|cond
comma
r_int
r_int
id|width
comma
r_int
r_int
id|msbits
)paren
(brace
r_int
r_int
id|l
op_assign
(paren
id|msbits
op_lshift
l_int|16
)paren
op_or
id|width
suffix:semicolon
r_return
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
id|cond
comma
op_minus
l_int|1
comma
id|snd_pcm_hw_rule_msbits
comma
(paren
r_void
op_star
)paren
id|l
comma
id|SNDRV_PCM_HW_PARAM_SAMPLE_BITS
comma
op_minus
l_int|1
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_hw_rule_step
r_static
r_int
id|snd_pcm_hw_rule_step
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_rule_t
op_star
id|rule
)paren
(brace
r_int
r_int
id|step
op_assign
(paren
r_int
r_int
)paren
id|rule
op_member_access_from_pointer
r_private
suffix:semicolon
r_return
id|snd_interval_step
c_func
(paren
id|hw_param_interval
c_func
(paren
id|params
comma
id|rule-&gt;var
)paren
comma
l_int|0
comma
id|step
)paren
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_pcm_hw_constraint_step&n; */
DECL|function|snd_pcm_hw_constraint_step
r_int
id|snd_pcm_hw_constraint_step
c_func
(paren
id|snd_pcm_runtime_t
op_star
id|runtime
comma
r_int
r_int
id|cond
comma
id|snd_pcm_hw_param_t
id|var
comma
r_int
r_int
id|step
)paren
(brace
r_return
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
id|cond
comma
id|var
comma
id|snd_pcm_hw_rule_step
comma
(paren
r_void
op_star
)paren
id|step
comma
id|var
comma
op_minus
l_int|1
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_hw_rule_pow2
r_static
r_int
id|snd_pcm_hw_rule_pow2
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_rule_t
op_star
id|rule
)paren
(brace
r_static
r_int
id|pow2_sizes
(braket
)braket
op_assign
(brace
l_int|1
op_lshift
l_int|0
comma
l_int|1
op_lshift
l_int|1
comma
l_int|1
op_lshift
l_int|2
comma
l_int|1
op_lshift
l_int|3
comma
l_int|1
op_lshift
l_int|4
comma
l_int|1
op_lshift
l_int|5
comma
l_int|1
op_lshift
l_int|6
comma
l_int|1
op_lshift
l_int|7
comma
l_int|1
op_lshift
l_int|8
comma
l_int|1
op_lshift
l_int|9
comma
l_int|1
op_lshift
l_int|10
comma
l_int|1
op_lshift
l_int|11
comma
l_int|1
op_lshift
l_int|12
comma
l_int|1
op_lshift
l_int|13
comma
l_int|1
op_lshift
l_int|14
comma
l_int|1
op_lshift
l_int|15
comma
l_int|1
op_lshift
l_int|16
comma
l_int|1
op_lshift
l_int|17
comma
l_int|1
op_lshift
l_int|18
comma
l_int|1
op_lshift
l_int|19
comma
l_int|1
op_lshift
l_int|20
comma
l_int|1
op_lshift
l_int|21
comma
l_int|1
op_lshift
l_int|22
comma
l_int|1
op_lshift
l_int|23
comma
l_int|1
op_lshift
l_int|24
comma
l_int|1
op_lshift
l_int|25
comma
l_int|1
op_lshift
l_int|26
comma
l_int|1
op_lshift
l_int|27
comma
l_int|1
op_lshift
l_int|28
comma
l_int|1
op_lshift
l_int|29
comma
l_int|1
op_lshift
l_int|30
)brace
suffix:semicolon
r_return
id|snd_interval_list
c_func
(paren
id|hw_param_interval
c_func
(paren
id|params
comma
id|rule-&gt;var
)paren
comma
r_sizeof
(paren
id|pow2_sizes
)paren
op_div
r_sizeof
(paren
r_int
)paren
comma
id|pow2_sizes
comma
l_int|0
)paren
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_pcm_hw_constraint_pow2&n; */
DECL|function|snd_pcm_hw_constraint_pow2
r_int
id|snd_pcm_hw_constraint_pow2
c_func
(paren
id|snd_pcm_runtime_t
op_star
id|runtime
comma
r_int
r_int
id|cond
comma
id|snd_pcm_hw_param_t
id|var
)paren
(brace
r_return
id|snd_pcm_hw_rule_add
c_func
(paren
id|runtime
comma
id|cond
comma
id|var
comma
id|snd_pcm_hw_rule_pow2
comma
l_int|NULL
comma
id|var
comma
op_minus
l_int|1
)paren
suffix:semicolon
)brace
multiline_comment|/* To use the same code we have in alsa-lib */
DECL|macro|snd_pcm_t
mdefine_line|#define snd_pcm_t snd_pcm_substream_t
DECL|macro|assert
mdefine_line|#define assert(i) snd_assert((i), return -EINVAL)
macro_line|#ifndef INT_MIN
DECL|macro|INT_MIN
mdefine_line|#define INT_MIN ((int)((unsigned int)INT_MAX+1))
macro_line|#endif
DECL|function|_snd_pcm_hw_param_any
r_void
id|_snd_pcm_hw_param_any
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_param_t
id|var
)paren
(brace
r_if
c_cond
(paren
id|hw_is_mask
c_func
(paren
id|var
)paren
)paren
(brace
id|snd_mask_any
c_func
(paren
id|hw_param_mask
c_func
(paren
id|params
comma
id|var
)paren
)paren
suffix:semicolon
id|params-&gt;cmask
op_or_assign
l_int|1
op_lshift
id|var
suffix:semicolon
id|params-&gt;rmask
op_or_assign
l_int|1
op_lshift
id|var
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|hw_is_interval
c_func
(paren
id|var
)paren
)paren
(brace
id|snd_interval_any
c_func
(paren
id|hw_param_interval
c_func
(paren
id|params
comma
id|var
)paren
)paren
suffix:semicolon
id|params-&gt;cmask
op_or_assign
l_int|1
op_lshift
id|var
suffix:semicolon
id|params-&gt;rmask
op_or_assign
l_int|1
op_lshift
id|var
suffix:semicolon
r_return
suffix:semicolon
)brace
id|snd_BUG
c_func
(paren
)paren
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_pcm_hw_param_any&n; */
DECL|function|snd_pcm_hw_param_any
r_int
id|snd_pcm_hw_param_any
c_func
(paren
id|snd_pcm_t
op_star
id|pcm
comma
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_param_t
id|var
)paren
(brace
id|_snd_pcm_hw_param_any
c_func
(paren
id|params
comma
id|var
)paren
suffix:semicolon
r_return
id|snd_pcm_hw_refine
c_func
(paren
id|pcm
comma
id|params
)paren
suffix:semicolon
)brace
DECL|function|_snd_pcm_hw_params_any
r_void
id|_snd_pcm_hw_params_any
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
)paren
(brace
r_int
r_int
id|k
suffix:semicolon
id|memset
c_func
(paren
id|params
comma
l_int|0
comma
r_sizeof
(paren
op_star
id|params
)paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|k
op_assign
id|SNDRV_PCM_HW_PARAM_FIRST_MASK
suffix:semicolon
id|k
op_le
id|SNDRV_PCM_HW_PARAM_LAST_MASK
suffix:semicolon
id|k
op_increment
)paren
id|_snd_pcm_hw_param_any
c_func
(paren
id|params
comma
id|k
)paren
suffix:semicolon
r_for
c_loop
(paren
id|k
op_assign
id|SNDRV_PCM_HW_PARAM_FIRST_INTERVAL
suffix:semicolon
id|k
op_le
id|SNDRV_PCM_HW_PARAM_LAST_INTERVAL
suffix:semicolon
id|k
op_increment
)paren
id|_snd_pcm_hw_param_any
c_func
(paren
id|params
comma
id|k
)paren
suffix:semicolon
id|params-&gt;info
op_assign
op_complement
l_int|0U
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_pcm_hw_params_any&n; *&n; * Fill PARAMS with full configuration space boundaries&n; */
DECL|function|snd_pcm_hw_params_any
r_int
id|snd_pcm_hw_params_any
c_func
(paren
id|snd_pcm_t
op_star
id|pcm
comma
id|snd_pcm_hw_params_t
op_star
id|params
)paren
(brace
id|_snd_pcm_hw_params_any
c_func
(paren
id|params
)paren
suffix:semicolon
r_return
id|snd_pcm_hw_refine
c_func
(paren
id|pcm
comma
id|params
)paren
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_pcm_hw_param_value&n; *&n; * Return the value for field PAR if it&squot;s fixed in configuration space &n; *  defined by PARAMS. Return -EINVAL otherwise&n; */
DECL|function|snd_pcm_hw_param_value
r_int
id|snd_pcm_hw_param_value
c_func
(paren
r_const
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_param_t
id|var
comma
r_int
op_star
id|dir
)paren
(brace
r_if
c_cond
(paren
id|hw_is_mask
c_func
(paren
id|var
)paren
)paren
(brace
r_const
id|snd_mask_t
op_star
id|mask
op_assign
id|hw_param_mask_c
c_func
(paren
id|params
comma
id|var
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snd_mask_single
c_func
(paren
id|mask
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|dir
)paren
op_star
id|dir
op_assign
l_int|0
suffix:semicolon
r_return
id|snd_mask_value
c_func
(paren
id|mask
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|hw_is_interval
c_func
(paren
id|var
)paren
)paren
(brace
r_const
id|snd_interval_t
op_star
id|i
op_assign
id|hw_param_interval_c
c_func
(paren
id|params
comma
id|var
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snd_interval_single
c_func
(paren
id|i
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|dir
)paren
op_star
id|dir
op_assign
id|i-&gt;openmin
suffix:semicolon
r_return
id|snd_interval_value
c_func
(paren
id|i
)paren
suffix:semicolon
)brace
m_assert
(paren
l_int|0
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_pcm_hw_param_value_min&n; *&n; * Return the minimum value for field PAR.&n; */
DECL|function|snd_pcm_hw_param_value_min
r_int
r_int
id|snd_pcm_hw_param_value_min
c_func
(paren
r_const
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_param_t
id|var
comma
r_int
op_star
id|dir
)paren
(brace
r_if
c_cond
(paren
id|hw_is_mask
c_func
(paren
id|var
)paren
)paren
(brace
r_if
c_cond
(paren
id|dir
)paren
op_star
id|dir
op_assign
l_int|0
suffix:semicolon
r_return
id|snd_mask_min
c_func
(paren
id|hw_param_mask_c
c_func
(paren
id|params
comma
id|var
)paren
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|hw_is_interval
c_func
(paren
id|var
)paren
)paren
(brace
r_const
id|snd_interval_t
op_star
id|i
op_assign
id|hw_param_interval_c
c_func
(paren
id|params
comma
id|var
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dir
)paren
op_star
id|dir
op_assign
id|i-&gt;openmin
suffix:semicolon
r_return
id|snd_interval_min
c_func
(paren
id|i
)paren
suffix:semicolon
)brace
m_assert
(paren
l_int|0
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_pcm_hw_param_value_max&n; *&n; * Return the maximum value for field PAR.&n; */
DECL|function|snd_pcm_hw_param_value_max
r_int
r_int
id|snd_pcm_hw_param_value_max
c_func
(paren
r_const
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_param_t
id|var
comma
r_int
op_star
id|dir
)paren
(brace
r_if
c_cond
(paren
id|hw_is_mask
c_func
(paren
id|var
)paren
)paren
(brace
r_if
c_cond
(paren
id|dir
)paren
op_star
id|dir
op_assign
l_int|0
suffix:semicolon
r_return
id|snd_mask_max
c_func
(paren
id|hw_param_mask_c
c_func
(paren
id|params
comma
id|var
)paren
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|hw_is_interval
c_func
(paren
id|var
)paren
)paren
(brace
r_const
id|snd_interval_t
op_star
id|i
op_assign
id|hw_param_interval_c
c_func
(paren
id|params
comma
id|var
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dir
)paren
op_star
id|dir
op_assign
op_minus
(paren
r_int
)paren
id|i-&gt;openmax
suffix:semicolon
r_return
id|snd_interval_max
c_func
(paren
id|i
)paren
suffix:semicolon
)brace
m_assert
(paren
l_int|0
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
DECL|function|_snd_pcm_hw_param_setempty
r_void
id|_snd_pcm_hw_param_setempty
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_param_t
id|var
)paren
(brace
r_if
c_cond
(paren
id|hw_is_mask
c_func
(paren
id|var
)paren
)paren
(brace
id|snd_mask_none
c_func
(paren
id|hw_param_mask
c_func
(paren
id|params
comma
id|var
)paren
)paren
suffix:semicolon
id|params-&gt;cmask
op_or_assign
l_int|1
op_lshift
id|var
suffix:semicolon
id|params-&gt;rmask
op_or_assign
l_int|1
op_lshift
id|var
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|hw_is_interval
c_func
(paren
id|var
)paren
)paren
(brace
id|snd_interval_none
c_func
(paren
id|hw_param_interval
c_func
(paren
id|params
comma
id|var
)paren
)paren
suffix:semicolon
id|params-&gt;cmask
op_or_assign
l_int|1
op_lshift
id|var
suffix:semicolon
id|params-&gt;rmask
op_or_assign
l_int|1
op_lshift
id|var
suffix:semicolon
)brace
r_else
(brace
id|snd_BUG
c_func
(paren
)paren
suffix:semicolon
)brace
)brace
DECL|function|_snd_pcm_hw_param_setinteger
r_int
id|_snd_pcm_hw_param_setinteger
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_param_t
id|var
)paren
(brace
r_int
id|changed
suffix:semicolon
m_assert
(paren
id|hw_is_interval
c_func
(paren
id|var
)paren
)paren
suffix:semicolon
id|changed
op_assign
id|snd_interval_setinteger
c_func
(paren
id|hw_param_interval
c_func
(paren
id|params
comma
id|var
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|changed
)paren
(brace
id|params-&gt;cmask
op_or_assign
l_int|1
op_lshift
id|var
suffix:semicolon
id|params-&gt;rmask
op_or_assign
l_int|1
op_lshift
id|var
suffix:semicolon
)brace
r_return
id|changed
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_pcm_hw_param_setinteger&n; *&n; * Inside configuration space defined by PARAMS remove from PAR all &n; * non integer values. Reduce configuration space accordingly.&n; * Return -EINVAL if the configuration space is empty&n; */
DECL|function|snd_pcm_hw_param_setinteger
r_int
id|snd_pcm_hw_param_setinteger
c_func
(paren
id|snd_pcm_t
op_star
id|pcm
comma
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_param_t
id|var
)paren
(brace
r_int
id|changed
op_assign
id|_snd_pcm_hw_param_setinteger
c_func
(paren
id|params
comma
id|var
)paren
suffix:semicolon
r_if
c_cond
(paren
id|changed
OL
l_int|0
)paren
r_return
id|changed
suffix:semicolon
r_if
c_cond
(paren
id|params-&gt;rmask
)paren
(brace
r_int
id|err
op_assign
id|snd_pcm_hw_refine
c_func
(paren
id|pcm
comma
id|params
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|_snd_pcm_hw_param_first
r_int
id|_snd_pcm_hw_param_first
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_param_t
id|var
)paren
(brace
r_int
id|changed
suffix:semicolon
r_if
c_cond
(paren
id|hw_is_mask
c_func
(paren
id|var
)paren
)paren
id|changed
op_assign
id|snd_mask_refine_first
c_func
(paren
id|hw_param_mask
c_func
(paren
id|params
comma
id|var
)paren
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|hw_is_interval
c_func
(paren
id|var
)paren
)paren
id|changed
op_assign
id|snd_interval_refine_first
c_func
(paren
id|hw_param_interval
c_func
(paren
id|params
comma
id|var
)paren
)paren
suffix:semicolon
r_else
(brace
m_assert
(paren
l_int|0
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|changed
)paren
(brace
id|params-&gt;cmask
op_or_assign
l_int|1
op_lshift
id|var
suffix:semicolon
id|params-&gt;rmask
op_or_assign
l_int|1
op_lshift
id|var
suffix:semicolon
)brace
r_return
id|changed
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_pcm_hw_param_first&n; *&n; * Inside configuration space defined by PARAMS remove from PAR all &n; * values &gt; minimum. Reduce configuration space accordingly.&n; * Return the minimum.&n; */
DECL|function|snd_pcm_hw_param_first
r_int
id|snd_pcm_hw_param_first
c_func
(paren
id|snd_pcm_t
op_star
id|pcm
comma
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_param_t
id|var
comma
r_int
op_star
id|dir
)paren
(brace
r_int
id|changed
op_assign
id|_snd_pcm_hw_param_first
c_func
(paren
id|params
comma
id|var
)paren
suffix:semicolon
r_if
c_cond
(paren
id|changed
OL
l_int|0
)paren
r_return
id|changed
suffix:semicolon
r_if
c_cond
(paren
id|params-&gt;rmask
)paren
(brace
r_int
id|err
op_assign
id|snd_pcm_hw_refine
c_func
(paren
id|pcm
comma
id|params
)paren
suffix:semicolon
m_assert
(paren
id|err
op_ge
l_int|0
)paren
suffix:semicolon
)brace
r_return
id|snd_pcm_hw_param_value
c_func
(paren
id|params
comma
id|var
comma
id|dir
)paren
suffix:semicolon
)brace
DECL|function|_snd_pcm_hw_param_last
r_int
id|_snd_pcm_hw_param_last
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_param_t
id|var
)paren
(brace
r_int
id|changed
suffix:semicolon
r_if
c_cond
(paren
id|hw_is_mask
c_func
(paren
id|var
)paren
)paren
id|changed
op_assign
id|snd_mask_refine_last
c_func
(paren
id|hw_param_mask
c_func
(paren
id|params
comma
id|var
)paren
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|hw_is_interval
c_func
(paren
id|var
)paren
)paren
id|changed
op_assign
id|snd_interval_refine_last
c_func
(paren
id|hw_param_interval
c_func
(paren
id|params
comma
id|var
)paren
)paren
suffix:semicolon
r_else
(brace
m_assert
(paren
l_int|0
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|changed
)paren
(brace
id|params-&gt;cmask
op_or_assign
l_int|1
op_lshift
id|var
suffix:semicolon
id|params-&gt;rmask
op_or_assign
l_int|1
op_lshift
id|var
suffix:semicolon
)brace
r_return
id|changed
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_pcm_hw_param_last&n; *&n; * Inside configuration space defined by PARAMS remove from PAR all &n; * values &lt; maximum. Reduce configuration space accordingly.&n; * Return the maximum.&n; */
DECL|function|snd_pcm_hw_param_last
r_int
id|snd_pcm_hw_param_last
c_func
(paren
id|snd_pcm_t
op_star
id|pcm
comma
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_param_t
id|var
comma
r_int
op_star
id|dir
)paren
(brace
r_int
id|changed
op_assign
id|_snd_pcm_hw_param_last
c_func
(paren
id|params
comma
id|var
)paren
suffix:semicolon
r_if
c_cond
(paren
id|changed
OL
l_int|0
)paren
r_return
id|changed
suffix:semicolon
r_if
c_cond
(paren
id|params-&gt;rmask
)paren
(brace
r_int
id|err
op_assign
id|snd_pcm_hw_refine
c_func
(paren
id|pcm
comma
id|params
)paren
suffix:semicolon
m_assert
(paren
id|err
op_ge
l_int|0
)paren
suffix:semicolon
)brace
r_return
id|snd_pcm_hw_param_value
c_func
(paren
id|params
comma
id|var
comma
id|dir
)paren
suffix:semicolon
)brace
DECL|function|_snd_pcm_hw_param_min
r_int
id|_snd_pcm_hw_param_min
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_param_t
id|var
comma
r_int
r_int
id|val
comma
r_int
id|dir
)paren
(brace
r_int
id|changed
suffix:semicolon
r_int
id|open
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|dir
)paren
(brace
r_if
c_cond
(paren
id|dir
OG
l_int|0
)paren
(brace
id|open
op_assign
l_int|1
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|dir
OL
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|val
OG
l_int|0
)paren
(brace
id|open
op_assign
l_int|1
suffix:semicolon
id|val
op_decrement
suffix:semicolon
)brace
)brace
)brace
r_if
c_cond
(paren
id|hw_is_mask
c_func
(paren
id|var
)paren
)paren
id|changed
op_assign
id|snd_mask_refine_min
c_func
(paren
id|hw_param_mask
c_func
(paren
id|params
comma
id|var
)paren
comma
id|val
op_plus
op_logical_neg
op_logical_neg
id|open
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|hw_is_interval
c_func
(paren
id|var
)paren
)paren
id|changed
op_assign
id|snd_interval_refine_min
c_func
(paren
id|hw_param_interval
c_func
(paren
id|params
comma
id|var
)paren
comma
id|val
comma
id|open
)paren
suffix:semicolon
r_else
(brace
m_assert
(paren
l_int|0
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|changed
)paren
(brace
id|params-&gt;cmask
op_or_assign
l_int|1
op_lshift
id|var
suffix:semicolon
id|params-&gt;rmask
op_or_assign
l_int|1
op_lshift
id|var
suffix:semicolon
)brace
r_return
id|changed
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_pcm_hw_param_min&n; *&n; * Inside configuration space defined by PARAMS remove from PAR all &n; * values &lt; VAL. Reduce configuration space accordingly.&n; * Return new minimum or -EINVAL if the configuration space is empty&n; */
DECL|function|snd_pcm_hw_param_min
r_int
id|snd_pcm_hw_param_min
c_func
(paren
id|snd_pcm_t
op_star
id|pcm
comma
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_param_t
id|var
comma
r_int
r_int
id|val
comma
r_int
op_star
id|dir
)paren
(brace
r_int
id|changed
op_assign
id|_snd_pcm_hw_param_min
c_func
(paren
id|params
comma
id|var
comma
id|val
comma
id|dir
ques
c_cond
op_star
id|dir
suffix:colon
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|changed
OL
l_int|0
)paren
r_return
id|changed
suffix:semicolon
r_if
c_cond
(paren
id|params-&gt;rmask
)paren
(brace
r_int
id|err
op_assign
id|snd_pcm_hw_refine
c_func
(paren
id|pcm
comma
id|params
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
r_return
id|snd_pcm_hw_param_value_min
c_func
(paren
id|params
comma
id|var
comma
id|dir
)paren
suffix:semicolon
)brace
DECL|function|_snd_pcm_hw_param_max
r_int
id|_snd_pcm_hw_param_max
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_param_t
id|var
comma
r_int
r_int
id|val
comma
r_int
id|dir
)paren
(brace
r_int
id|changed
suffix:semicolon
r_int
id|open
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|dir
)paren
(brace
r_if
c_cond
(paren
id|dir
OL
l_int|0
)paren
(brace
id|open
op_assign
l_int|1
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|dir
OG
l_int|0
)paren
(brace
id|open
op_assign
l_int|1
suffix:semicolon
id|val
op_increment
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|hw_is_mask
c_func
(paren
id|var
)paren
)paren
(brace
r_if
c_cond
(paren
id|val
op_eq
l_int|0
op_logical_and
id|open
)paren
(brace
id|snd_mask_none
c_func
(paren
id|hw_param_mask
c_func
(paren
id|params
comma
id|var
)paren
)paren
suffix:semicolon
id|changed
op_assign
op_minus
id|EINVAL
suffix:semicolon
)brace
r_else
id|changed
op_assign
id|snd_mask_refine_max
c_func
(paren
id|hw_param_mask
c_func
(paren
id|params
comma
id|var
)paren
comma
id|val
op_minus
op_logical_neg
op_logical_neg
id|open
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|hw_is_interval
c_func
(paren
id|var
)paren
)paren
id|changed
op_assign
id|snd_interval_refine_max
c_func
(paren
id|hw_param_interval
c_func
(paren
id|params
comma
id|var
)paren
comma
id|val
comma
id|open
)paren
suffix:semicolon
r_else
(brace
m_assert
(paren
l_int|0
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|changed
)paren
(brace
id|params-&gt;cmask
op_or_assign
l_int|1
op_lshift
id|var
suffix:semicolon
id|params-&gt;rmask
op_or_assign
l_int|1
op_lshift
id|var
suffix:semicolon
)brace
r_return
id|changed
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_pcm_hw_param_max&n; *&n; * Inside configuration space defined by PARAMS remove from PAR all &n; *  values &gt;= VAL + 1. Reduce configuration space accordingly.&n; *  Return new maximum or -EINVAL if the configuration space is empty&n; */
DECL|function|snd_pcm_hw_param_max
r_int
id|snd_pcm_hw_param_max
c_func
(paren
id|snd_pcm_t
op_star
id|pcm
comma
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_param_t
id|var
comma
r_int
r_int
id|val
comma
r_int
op_star
id|dir
)paren
(brace
r_int
id|changed
op_assign
id|_snd_pcm_hw_param_max
c_func
(paren
id|params
comma
id|var
comma
id|val
comma
id|dir
ques
c_cond
op_star
id|dir
suffix:colon
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|changed
OL
l_int|0
)paren
r_return
id|changed
suffix:semicolon
r_if
c_cond
(paren
id|params-&gt;rmask
)paren
(brace
r_int
id|err
op_assign
id|snd_pcm_hw_refine
c_func
(paren
id|pcm
comma
id|params
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
r_return
id|snd_pcm_hw_param_value_max
c_func
(paren
id|params
comma
id|var
comma
id|dir
)paren
suffix:semicolon
)brace
DECL|function|_snd_pcm_hw_param_set
r_int
id|_snd_pcm_hw_param_set
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_param_t
id|var
comma
r_int
r_int
id|val
comma
r_int
id|dir
)paren
(brace
r_int
id|changed
suffix:semicolon
r_if
c_cond
(paren
id|hw_is_mask
c_func
(paren
id|var
)paren
)paren
(brace
id|snd_mask_t
op_star
id|m
op_assign
id|hw_param_mask
c_func
(paren
id|params
comma
id|var
)paren
suffix:semicolon
r_if
c_cond
(paren
id|val
op_eq
l_int|0
op_logical_and
id|dir
OL
l_int|0
)paren
(brace
id|changed
op_assign
op_minus
id|EINVAL
suffix:semicolon
id|snd_mask_none
c_func
(paren
id|m
)paren
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|dir
OG
l_int|0
)paren
id|val
op_increment
suffix:semicolon
r_else
r_if
c_cond
(paren
id|dir
OL
l_int|0
)paren
id|val
op_decrement
suffix:semicolon
id|changed
op_assign
id|snd_mask_refine_set
c_func
(paren
id|hw_param_mask
c_func
(paren
id|params
comma
id|var
)paren
comma
id|val
)paren
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|hw_is_interval
c_func
(paren
id|var
)paren
)paren
(brace
id|snd_interval_t
op_star
id|i
op_assign
id|hw_param_interval
c_func
(paren
id|params
comma
id|var
)paren
suffix:semicolon
r_if
c_cond
(paren
id|val
op_eq
l_int|0
op_logical_and
id|dir
OL
l_int|0
)paren
(brace
id|changed
op_assign
op_minus
id|EINVAL
suffix:semicolon
id|snd_interval_none
c_func
(paren
id|i
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|dir
op_eq
l_int|0
)paren
id|changed
op_assign
id|snd_interval_refine_set
c_func
(paren
id|i
comma
id|val
)paren
suffix:semicolon
r_else
(brace
id|snd_interval_t
id|t
suffix:semicolon
id|t.openmin
op_assign
l_int|1
suffix:semicolon
id|t.openmax
op_assign
l_int|1
suffix:semicolon
id|t.empty
op_assign
l_int|0
suffix:semicolon
id|t.integer
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|dir
OL
l_int|0
)paren
(brace
id|t.min
op_assign
id|val
op_minus
l_int|1
suffix:semicolon
id|t.max
op_assign
id|val
suffix:semicolon
)brace
r_else
(brace
id|t.min
op_assign
id|val
suffix:semicolon
id|t.max
op_assign
id|val
op_plus
l_int|1
suffix:semicolon
)brace
id|changed
op_assign
id|snd_interval_refine
c_func
(paren
id|i
comma
op_amp
id|t
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
m_assert
(paren
l_int|0
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|changed
)paren
(brace
id|params-&gt;cmask
op_or_assign
l_int|1
op_lshift
id|var
suffix:semicolon
id|params-&gt;rmask
op_or_assign
l_int|1
op_lshift
id|var
suffix:semicolon
)brace
r_return
id|changed
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_pcm_hw_param_set&n; *&n; * Inside configuration space defined by PARAMS remove from PAR all &n; * values != VAL. Reduce configuration space accordingly.&n; *  Return VAL or -EINVAL if the configuration space is empty&n; */
DECL|function|snd_pcm_hw_param_set
r_int
id|snd_pcm_hw_param_set
c_func
(paren
id|snd_pcm_t
op_star
id|pcm
comma
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_param_t
id|var
comma
r_int
r_int
id|val
comma
r_int
id|dir
)paren
(brace
r_int
id|changed
op_assign
id|_snd_pcm_hw_param_set
c_func
(paren
id|params
comma
id|var
comma
id|val
comma
id|dir
)paren
suffix:semicolon
r_if
c_cond
(paren
id|changed
OL
l_int|0
)paren
r_return
id|changed
suffix:semicolon
r_if
c_cond
(paren
id|params-&gt;rmask
)paren
(brace
r_int
id|err
op_assign
id|snd_pcm_hw_refine
c_func
(paren
id|pcm
comma
id|params
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
r_return
id|snd_pcm_hw_param_value
c_func
(paren
id|params
comma
id|var
comma
l_int|NULL
)paren
suffix:semicolon
)brace
DECL|function|_snd_pcm_hw_param_mask
r_int
id|_snd_pcm_hw_param_mask
c_func
(paren
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_param_t
id|var
comma
r_const
id|snd_mask_t
op_star
id|val
)paren
(brace
r_int
id|changed
suffix:semicolon
m_assert
(paren
id|hw_is_mask
c_func
(paren
id|var
)paren
)paren
suffix:semicolon
id|changed
op_assign
id|snd_mask_refine
c_func
(paren
id|hw_param_mask
c_func
(paren
id|params
comma
id|var
)paren
comma
id|val
)paren
suffix:semicolon
r_if
c_cond
(paren
id|changed
)paren
(brace
id|params-&gt;cmask
op_or_assign
l_int|1
op_lshift
id|var
suffix:semicolon
id|params-&gt;rmask
op_or_assign
l_int|1
op_lshift
id|var
suffix:semicolon
)brace
r_return
id|changed
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_pcm_hw_param_mask&n; *&n; * Inside configuration space defined by PARAMS remove from PAR all values&n; * not contained in MASK. Reduce configuration space accordingly.&n; * This function can be called only for SNDRV_PCM_HW_PARAM_ACCESS,&n; * SNDRV_PCM_HW_PARAM_FORMAT, SNDRV_PCM_HW_PARAM_SUBFORMAT.&n; * Return 0 on success or -EINVAL&n; * if the configuration space is empty&n; */
DECL|function|snd_pcm_hw_param_mask
r_int
id|snd_pcm_hw_param_mask
c_func
(paren
id|snd_pcm_t
op_star
id|pcm
comma
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_param_t
id|var
comma
r_const
id|snd_mask_t
op_star
id|val
)paren
(brace
r_int
id|changed
op_assign
id|_snd_pcm_hw_param_mask
c_func
(paren
id|params
comma
id|var
comma
id|val
)paren
suffix:semicolon
r_if
c_cond
(paren
id|changed
OL
l_int|0
)paren
r_return
id|changed
suffix:semicolon
r_if
c_cond
(paren
id|params-&gt;rmask
)paren
(brace
r_int
id|err
op_assign
id|snd_pcm_hw_refine
c_func
(paren
id|pcm
comma
id|params
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|boundary_sub
r_static
r_int
id|boundary_sub
c_func
(paren
r_int
id|a
comma
r_int
id|adir
comma
r_int
id|b
comma
r_int
id|bdir
comma
r_int
op_star
id|c
comma
r_int
op_star
id|cdir
)paren
(brace
id|adir
op_assign
id|adir
OL
l_int|0
ques
c_cond
op_minus
l_int|1
suffix:colon
(paren
id|adir
OG
l_int|0
ques
c_cond
l_int|1
suffix:colon
l_int|0
)paren
suffix:semicolon
id|bdir
op_assign
id|bdir
OL
l_int|0
ques
c_cond
op_minus
l_int|1
suffix:colon
(paren
id|bdir
OG
l_int|0
ques
c_cond
l_int|1
suffix:colon
l_int|0
)paren
suffix:semicolon
op_star
id|c
op_assign
id|a
op_minus
id|b
suffix:semicolon
op_star
id|cdir
op_assign
id|adir
op_minus
id|bdir
suffix:semicolon
r_if
c_cond
(paren
op_star
id|cdir
op_eq
op_minus
l_int|2
)paren
(brace
m_assert
(paren
op_star
id|c
OG
id|INT_MIN
)paren
suffix:semicolon
(paren
op_star
id|c
)paren
op_decrement
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_star
id|cdir
op_eq
l_int|2
)paren
(brace
m_assert
(paren
op_star
id|c
OL
id|INT_MAX
)paren
suffix:semicolon
(paren
op_star
id|c
)paren
op_increment
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|boundary_lt
r_static
r_int
id|boundary_lt
c_func
(paren
r_int
r_int
id|a
comma
r_int
id|adir
comma
r_int
r_int
id|b
comma
r_int
id|bdir
)paren
(brace
m_assert
(paren
id|a
OG
l_int|0
op_logical_or
id|adir
op_ge
l_int|0
)paren
suffix:semicolon
m_assert
(paren
id|b
OG
l_int|0
op_logical_or
id|bdir
op_ge
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|adir
OL
l_int|0
)paren
(brace
id|a
op_decrement
suffix:semicolon
id|adir
op_assign
l_int|1
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|adir
OG
l_int|0
)paren
id|adir
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|bdir
OL
l_int|0
)paren
(brace
id|b
op_decrement
suffix:semicolon
id|bdir
op_assign
l_int|1
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|bdir
OG
l_int|0
)paren
id|bdir
op_assign
l_int|1
suffix:semicolon
r_return
id|a
OL
id|b
op_logical_or
(paren
id|a
op_eq
id|b
op_logical_and
id|adir
OL
id|bdir
)paren
suffix:semicolon
)brace
multiline_comment|/* Return 1 if min is nearer to best than max */
DECL|function|boundary_nearer
r_static
r_int
id|boundary_nearer
c_func
(paren
r_int
id|min
comma
r_int
id|mindir
comma
r_int
id|best
comma
r_int
id|bestdir
comma
r_int
id|max
comma
r_int
id|maxdir
)paren
(brace
r_int
id|dmin
comma
id|dmindir
suffix:semicolon
r_int
id|dmax
comma
id|dmaxdir
suffix:semicolon
id|boundary_sub
c_func
(paren
id|best
comma
id|bestdir
comma
id|min
comma
id|mindir
comma
op_amp
id|dmin
comma
op_amp
id|dmindir
)paren
suffix:semicolon
id|boundary_sub
c_func
(paren
id|max
comma
id|maxdir
comma
id|best
comma
id|bestdir
comma
op_amp
id|dmax
comma
op_amp
id|dmaxdir
)paren
suffix:semicolon
r_return
id|boundary_lt
c_func
(paren
id|dmin
comma
id|dmindir
comma
id|dmax
comma
id|dmaxdir
)paren
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_pcm_hw_param_near&n; *&n; * Inside configuration space defined by PARAMS set PAR to the available value&n; * nearest to VAL. Reduce configuration space accordingly.&n; * This function cannot be called for SNDRV_PCM_HW_PARAM_ACCESS,&n; * SNDRV_PCM_HW_PARAM_FORMAT, SNDRV_PCM_HW_PARAM_SUBFORMAT.&n; * Return the value found.&n;  */
DECL|function|snd_pcm_hw_param_near
r_int
id|snd_pcm_hw_param_near
c_func
(paren
id|snd_pcm_t
op_star
id|pcm
comma
id|snd_pcm_hw_params_t
op_star
id|params
comma
id|snd_pcm_hw_param_t
id|var
comma
r_int
r_int
id|best
comma
r_int
op_star
id|dir
)paren
(brace
id|snd_pcm_hw_params_t
op_star
id|save
op_assign
l_int|NULL
suffix:semicolon
r_int
id|v
suffix:semicolon
r_int
r_int
id|saved_min
suffix:semicolon
r_int
id|last
op_assign
l_int|0
suffix:semicolon
r_int
id|min
comma
id|max
suffix:semicolon
r_int
id|mindir
comma
id|maxdir
suffix:semicolon
r_int
id|valdir
op_assign
id|dir
ques
c_cond
op_star
id|dir
suffix:colon
l_int|0
suffix:semicolon
multiline_comment|/* FIXME */
r_if
c_cond
(paren
id|best
OG
id|INT_MAX
)paren
id|best
op_assign
id|INT_MAX
suffix:semicolon
id|min
op_assign
id|max
op_assign
id|best
suffix:semicolon
id|mindir
op_assign
id|maxdir
op_assign
id|valdir
suffix:semicolon
r_if
c_cond
(paren
id|maxdir
OG
l_int|0
)paren
id|maxdir
op_assign
l_int|0
suffix:semicolon
r_else
r_if
c_cond
(paren
id|maxdir
op_eq
l_int|0
)paren
id|maxdir
op_assign
op_minus
l_int|1
suffix:semicolon
r_else
(brace
id|maxdir
op_assign
l_int|1
suffix:semicolon
id|max
op_decrement
suffix:semicolon
)brace
id|save
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
op_star
id|save
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|save
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
op_star
id|save
op_assign
op_star
id|params
suffix:semicolon
id|saved_min
op_assign
id|min
suffix:semicolon
id|min
op_assign
id|snd_pcm_hw_param_min
c_func
(paren
id|pcm
comma
id|params
comma
id|var
comma
id|min
comma
op_amp
id|mindir
)paren
suffix:semicolon
r_if
c_cond
(paren
id|min
op_ge
l_int|0
)paren
(brace
id|snd_pcm_hw_params_t
op_star
id|params1
suffix:semicolon
r_if
c_cond
(paren
id|max
OL
l_int|0
)paren
r_goto
id|_end
suffix:semicolon
r_if
c_cond
(paren
(paren
r_int
r_int
)paren
id|min
op_eq
id|saved_min
op_logical_and
id|mindir
op_eq
id|valdir
)paren
r_goto
id|_end
suffix:semicolon
id|params1
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
op_star
id|params1
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|params1
op_eq
l_int|NULL
)paren
(brace
id|kfree
c_func
(paren
id|save
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
op_star
id|params1
op_assign
op_star
id|save
suffix:semicolon
id|max
op_assign
id|snd_pcm_hw_param_max
c_func
(paren
id|pcm
comma
id|params1
comma
id|var
comma
id|max
comma
op_amp
id|maxdir
)paren
suffix:semicolon
r_if
c_cond
(paren
id|max
OL
l_int|0
)paren
(brace
id|kfree
c_func
(paren
id|params1
)paren
suffix:semicolon
r_goto
id|_end
suffix:semicolon
)brace
r_if
c_cond
(paren
id|boundary_nearer
c_func
(paren
id|max
comma
id|maxdir
comma
id|best
comma
id|valdir
comma
id|min
comma
id|mindir
)paren
)paren
(brace
op_star
id|params
op_assign
op_star
id|params1
suffix:semicolon
id|last
op_assign
l_int|1
suffix:semicolon
)brace
id|kfree
c_func
(paren
id|params1
)paren
suffix:semicolon
)brace
r_else
(brace
op_star
id|params
op_assign
op_star
id|save
suffix:semicolon
id|max
op_assign
id|snd_pcm_hw_param_max
c_func
(paren
id|pcm
comma
id|params
comma
id|var
comma
id|max
comma
op_amp
id|maxdir
)paren
suffix:semicolon
m_assert
(paren
id|max
op_ge
l_int|0
)paren
suffix:semicolon
id|last
op_assign
l_int|1
suffix:semicolon
)brace
id|_end
suffix:colon
id|kfree
c_func
(paren
id|save
)paren
suffix:semicolon
r_if
c_cond
(paren
id|last
)paren
id|v
op_assign
id|snd_pcm_hw_param_last
c_func
(paren
id|pcm
comma
id|params
comma
id|var
comma
id|dir
)paren
suffix:semicolon
r_else
id|v
op_assign
id|snd_pcm_hw_param_first
c_func
(paren
id|pcm
comma
id|params
comma
id|var
comma
id|dir
)paren
suffix:semicolon
m_assert
(paren
id|v
op_ge
l_int|0
)paren
suffix:semicolon
r_return
id|v
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_pcm_hw_param_choose&n; *&n; * Choose one configuration from configuration space defined by PARAMS&n; * The configuration chosen is that obtained fixing in this order:&n; * first access, first format, first subformat, min channels,&n; * min rate, min period time, max buffer size, min tick time&n; */
DECL|function|snd_pcm_hw_params_choose
r_int
id|snd_pcm_hw_params_choose
c_func
(paren
id|snd_pcm_t
op_star
id|pcm
comma
id|snd_pcm_hw_params_t
op_star
id|params
)paren
(brace
r_int
id|err
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_param_first
c_func
(paren
id|pcm
comma
id|params
comma
id|SNDRV_PCM_HW_PARAM_ACCESS
comma
l_int|NULL
)paren
suffix:semicolon
m_assert
(paren
id|err
op_ge
l_int|0
)paren
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_param_first
c_func
(paren
id|pcm
comma
id|params
comma
id|SNDRV_PCM_HW_PARAM_FORMAT
comma
l_int|NULL
)paren
suffix:semicolon
m_assert
(paren
id|err
op_ge
l_int|0
)paren
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_param_first
c_func
(paren
id|pcm
comma
id|params
comma
id|SNDRV_PCM_HW_PARAM_SUBFORMAT
comma
l_int|NULL
)paren
suffix:semicolon
m_assert
(paren
id|err
op_ge
l_int|0
)paren
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_param_first
c_func
(paren
id|pcm
comma
id|params
comma
id|SNDRV_PCM_HW_PARAM_CHANNELS
comma
l_int|NULL
)paren
suffix:semicolon
m_assert
(paren
id|err
op_ge
l_int|0
)paren
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_param_first
c_func
(paren
id|pcm
comma
id|params
comma
id|SNDRV_PCM_HW_PARAM_RATE
comma
l_int|NULL
)paren
suffix:semicolon
m_assert
(paren
id|err
op_ge
l_int|0
)paren
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_param_first
c_func
(paren
id|pcm
comma
id|params
comma
id|SNDRV_PCM_HW_PARAM_PERIOD_TIME
comma
l_int|NULL
)paren
suffix:semicolon
m_assert
(paren
id|err
op_ge
l_int|0
)paren
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_param_last
c_func
(paren
id|pcm
comma
id|params
comma
id|SNDRV_PCM_HW_PARAM_BUFFER_SIZE
comma
l_int|NULL
)paren
suffix:semicolon
m_assert
(paren
id|err
op_ge
l_int|0
)paren
suffix:semicolon
id|err
op_assign
id|snd_pcm_hw_param_first
c_func
(paren
id|pcm
comma
id|params
comma
id|SNDRV_PCM_HW_PARAM_TICK_TIME
comma
l_int|NULL
)paren
suffix:semicolon
m_assert
(paren
id|err
op_ge
l_int|0
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|macro|snd_pcm_t
macro_line|#undef snd_pcm_t
DECL|macro|assert
macro_line|#undef assert
DECL|function|snd_pcm_lib_ioctl_reset
r_static
r_int
id|snd_pcm_lib_ioctl_reset
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_void
op_star
id|arg
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|snd_pcm_running
c_func
(paren
id|substream
)paren
op_logical_and
id|snd_pcm_update_hw_ptr
c_func
(paren
id|substream
)paren
op_ge
l_int|0
)paren
(brace
id|runtime-&gt;status-&gt;hw_ptr
op_mod_assign
id|runtime-&gt;buffer_size
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|runtime-&gt;status-&gt;hw_ptr
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_lib_ioctl_channel_info
r_static
r_int
id|snd_pcm_lib_ioctl_channel_info
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_void
op_star
id|arg
)paren
(brace
id|snd_pcm_channel_info_t
op_star
id|info
op_assign
id|arg
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_int
id|width
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|runtime-&gt;info
op_amp
id|SNDRV_PCM_INFO_MMAP
)paren
)paren
(brace
id|info-&gt;offset
op_assign
op_minus
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|width
op_assign
id|snd_pcm_format_physical_width
c_func
(paren
id|runtime-&gt;format
)paren
suffix:semicolon
r_if
c_cond
(paren
id|width
OL
l_int|0
)paren
r_return
id|width
suffix:semicolon
id|info-&gt;offset
op_assign
l_int|0
suffix:semicolon
r_switch
c_cond
(paren
id|runtime-&gt;access
)paren
(brace
r_case
id|SNDRV_PCM_ACCESS_MMAP_INTERLEAVED
suffix:colon
r_case
id|SNDRV_PCM_ACCESS_RW_INTERLEAVED
suffix:colon
id|info-&gt;first
op_assign
id|info-&gt;channel
op_star
id|width
suffix:semicolon
id|info-&gt;step
op_assign
id|runtime-&gt;channels
op_star
id|width
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_ACCESS_MMAP_NONINTERLEAVED
suffix:colon
r_case
id|SNDRV_PCM_ACCESS_RW_NONINTERLEAVED
suffix:colon
(brace
r_int
id|size
op_assign
id|runtime-&gt;dma_bytes
op_div
id|runtime-&gt;channels
suffix:semicolon
id|info-&gt;first
op_assign
id|info-&gt;channel
op_star
id|size
op_star
l_int|8
suffix:semicolon
id|info-&gt;step
op_assign
id|width
suffix:semicolon
r_break
suffix:semicolon
)brace
r_default
suffix:colon
id|snd_BUG
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_pcm_lib_ioctl - a generic PCM ioctl callback&n; * @substream: the pcm substream instance&n; * @cmd: ioctl command&n; * @arg: ioctl argument&n; *&n; * Processes the generic ioctl commands for PCM.&n; * Can be passed as the ioctl callback for PCM ops.&n; *&n; * Returns zero if successful, or a negative error code on failure.&n; */
DECL|function|snd_pcm_lib_ioctl
r_int
id|snd_pcm_lib_ioctl
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
r_int
id|cmd
comma
r_void
op_star
id|arg
)paren
(brace
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|SNDRV_PCM_IOCTL1_INFO
suffix:colon
r_return
l_int|0
suffix:semicolon
r_case
id|SNDRV_PCM_IOCTL1_RESET
suffix:colon
r_return
id|snd_pcm_lib_ioctl_reset
c_func
(paren
id|substream
comma
id|arg
)paren
suffix:semicolon
r_case
id|SNDRV_PCM_IOCTL1_CHANNEL_INFO
suffix:colon
r_return
id|snd_pcm_lib_ioctl_channel_info
c_func
(paren
id|substream
comma
id|arg
)paren
suffix:semicolon
)brace
r_return
op_minus
id|ENXIO
suffix:semicolon
)brace
multiline_comment|/*&n; *  Conditions&n; */
multiline_comment|/**&n; * snd_pcm_playback_ready - check whether the playback buffer is available&n; * @substream: the pcm substream instance&n; *&n; * Checks whether enough free space is available on the playback buffer.&n; *&n; * Returns non-zero if available, or zero if not.&n; */
DECL|function|snd_pcm_playback_ready
r_int
id|snd_pcm_playback_ready
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_return
id|snd_pcm_playback_avail
c_func
(paren
id|runtime
)paren
op_ge
id|runtime-&gt;control-&gt;avail_min
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_pcm_capture_ready - check whether the capture buffer is available&n; * @substream: the pcm substream instance&n; *&n; * Checks whether enough capture data is available on the capture buffer.&n; *&n; * Returns non-zero if available, or zero if not.&n; */
DECL|function|snd_pcm_capture_ready
r_int
id|snd_pcm_capture_ready
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_return
id|snd_pcm_capture_avail
c_func
(paren
id|runtime
)paren
op_ge
id|runtime-&gt;control-&gt;avail_min
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_pcm_playback_data - check whether any data exists on the playback buffer&n; * @substream: the pcm substream instance&n; *&n; * Checks whether any data exists on the playback buffer. If stop_threshold&n; * is bigger or equal to boundary, then this function returns always non-zero.&n; *&n; * Returns non-zero if exists, or zero if not.&n; */
DECL|function|snd_pcm_playback_data
r_int
id|snd_pcm_playback_data
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;stop_threshold
op_ge
id|runtime-&gt;boundary
)paren
r_return
l_int|1
suffix:semicolon
r_return
id|snd_pcm_playback_avail
c_func
(paren
id|runtime
)paren
OL
id|runtime-&gt;buffer_size
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_pcm_playback_empty - check whether the playback buffer is empty&n; * @substream: the pcm substream instance&n; *&n; * Checks whether the playback buffer is empty.&n; *&n; * Returns non-zero if empty, or zero if not.&n; */
DECL|function|snd_pcm_playback_empty
r_int
id|snd_pcm_playback_empty
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_return
id|snd_pcm_playback_avail
c_func
(paren
id|runtime
)paren
op_ge
id|runtime-&gt;buffer_size
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_pcm_capture_empty - check whether the capture buffer is empty&n; * @substream: the pcm substream instance&n; *&n; * Checks whether the capture buffer is empty.&n; *&n; * Returns non-zero if empty, or zero if not.&n; */
DECL|function|snd_pcm_capture_empty
r_int
id|snd_pcm_capture_empty
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_return
id|snd_pcm_capture_avail
c_func
(paren
id|runtime
)paren
op_eq
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_system_tick_set
r_static
r_void
id|snd_pcm_system_tick_set
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
r_int
id|ticks
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
id|ticks
op_eq
l_int|0
)paren
id|del_timer
c_func
(paren
op_amp
id|runtime-&gt;tick_timer
)paren
suffix:semicolon
r_else
(brace
id|ticks
op_div_assign
(paren
l_int|1000000
op_div
id|HZ
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ticks
op_mod
(paren
l_int|1000000
op_div
id|HZ
)paren
)paren
id|ticks
op_increment
suffix:semicolon
id|mod_timer
c_func
(paren
op_amp
id|runtime-&gt;tick_timer
comma
id|jiffies
op_plus
id|ticks
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/* Temporary alias */
DECL|function|snd_pcm_tick_set
r_void
id|snd_pcm_tick_set
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
r_int
id|ticks
)paren
(brace
id|snd_pcm_system_tick_set
c_func
(paren
id|substream
comma
id|ticks
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_tick_prepare
r_void
id|snd_pcm_tick_prepare
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_pcm_uframes_t
id|frames
op_assign
id|ULONG_MAX
suffix:semicolon
id|snd_pcm_uframes_t
id|avail
comma
id|dist
suffix:semicolon
r_int
r_int
id|ticks
suffix:semicolon
id|u_int64_t
id|n
suffix:semicolon
id|u_int32_t
id|r
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;stream
op_eq
id|SNDRV_PCM_STREAM_PLAYBACK
)paren
(brace
r_if
c_cond
(paren
id|runtime-&gt;silence_size
op_ge
id|runtime-&gt;boundary
)paren
(brace
id|frames
op_assign
l_int|1
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|runtime-&gt;silence_size
OG
l_int|0
op_logical_and
id|runtime-&gt;silence_filled
OL
id|runtime-&gt;buffer_size
)paren
(brace
id|snd_pcm_sframes_t
id|noise_dist
suffix:semicolon
id|noise_dist
op_assign
id|snd_pcm_playback_hw_avail
c_func
(paren
id|runtime
)paren
op_plus
id|runtime-&gt;silence_filled
suffix:semicolon
id|snd_assert
c_func
(paren
id|noise_dist
op_le
(paren
id|snd_pcm_sframes_t
)paren
id|runtime-&gt;silence_threshold
comma
)paren
suffix:semicolon
id|frames
op_assign
id|noise_dist
op_minus
id|runtime-&gt;silence_threshold
suffix:semicolon
)brace
id|avail
op_assign
id|snd_pcm_playback_avail
c_func
(paren
id|runtime
)paren
suffix:semicolon
)brace
r_else
(brace
id|avail
op_assign
id|snd_pcm_capture_avail
c_func
(paren
id|runtime
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|avail
OL
id|runtime-&gt;control-&gt;avail_min
)paren
(brace
id|snd_pcm_sframes_t
id|n
op_assign
id|runtime-&gt;control-&gt;avail_min
op_minus
id|avail
suffix:semicolon
r_if
c_cond
(paren
id|n
OG
l_int|0
op_logical_and
id|frames
OG
(paren
id|snd_pcm_uframes_t
)paren
id|n
)paren
id|frames
op_assign
id|n
suffix:semicolon
)brace
r_if
c_cond
(paren
id|avail
OL
id|runtime-&gt;buffer_size
)paren
(brace
id|snd_pcm_sframes_t
id|n
op_assign
id|runtime-&gt;buffer_size
op_minus
id|avail
suffix:semicolon
r_if
c_cond
(paren
id|n
OG
l_int|0
op_logical_and
id|frames
OG
(paren
id|snd_pcm_uframes_t
)paren
id|n
)paren
id|frames
op_assign
id|n
suffix:semicolon
)brace
r_if
c_cond
(paren
id|frames
op_eq
id|ULONG_MAX
)paren
(brace
id|snd_pcm_tick_set
c_func
(paren
id|substream
comma
l_int|0
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|dist
op_assign
id|runtime-&gt;status-&gt;hw_ptr
op_minus
id|runtime-&gt;hw_ptr_base
suffix:semicolon
multiline_comment|/* Distance to next interrupt */
id|dist
op_assign
id|runtime-&gt;period_size
op_minus
id|dist
op_mod
id|runtime-&gt;period_size
suffix:semicolon
r_if
c_cond
(paren
id|dist
op_le
id|frames
)paren
(brace
id|snd_pcm_tick_set
c_func
(paren
id|substream
comma
l_int|0
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
multiline_comment|/* the base time is us */
id|n
op_assign
id|frames
suffix:semicolon
id|n
op_mul_assign
l_int|1000000
suffix:semicolon
id|div64_32
c_func
(paren
op_amp
id|n
comma
id|runtime-&gt;tick_time
op_star
id|runtime-&gt;rate
comma
op_amp
id|r
)paren
suffix:semicolon
id|ticks
op_assign
id|n
op_plus
(paren
id|r
OG
l_int|0
ques
c_cond
l_int|1
suffix:colon
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ticks
OL
id|runtime-&gt;sleep_min
)paren
id|ticks
op_assign
id|runtime-&gt;sleep_min
suffix:semicolon
id|snd_pcm_tick_set
c_func
(paren
id|substream
comma
(paren
r_int
r_int
)paren
id|ticks
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_tick_elapsed
r_void
id|snd_pcm_tick_elapsed
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
)paren
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_assert
c_func
(paren
id|runtime
op_ne
l_int|NULL
comma
r_return
)paren
suffix:semicolon
id|snd_pcm_stream_lock_irqsave
c_func
(paren
id|substream
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snd_pcm_running
c_func
(paren
id|substream
)paren
op_logical_or
id|snd_pcm_update_hw_ptr
c_func
(paren
id|substream
)paren
OL
l_int|0
)paren
r_goto
id|_end
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;sleep_min
)paren
id|snd_pcm_tick_prepare
c_func
(paren
id|substream
)paren
suffix:semicolon
id|_end
suffix:colon
id|snd_pcm_stream_unlock_irqrestore
c_func
(paren
id|substream
comma
id|flags
)paren
suffix:semicolon
)brace
multiline_comment|/**&n; * snd_pcm_period_elapsed - update the pcm status for the next period&n; * @substream: the pcm substream instance&n; *&n; * This function is called from the interrupt handler when the&n; * PCM has processed the period size.  It will update the current&n; * pointer, set up the tick, wake up sleepers, etc.&n; *&n; * Even if more than one periods have elapsed since the last call, you&n; * have to call this only once.&n; */
DECL|function|snd_pcm_period_elapsed
r_void
id|snd_pcm_period_elapsed
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
)paren
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_assert
c_func
(paren
id|runtime
op_ne
l_int|NULL
comma
r_return
)paren
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;transfer_ack_begin
)paren
id|runtime
op_member_access_from_pointer
id|transfer_ack_begin
c_func
(paren
id|substream
)paren
suffix:semicolon
id|snd_pcm_stream_lock_irqsave
c_func
(paren
id|substream
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snd_pcm_running
c_func
(paren
id|substream
)paren
op_logical_or
id|snd_pcm_update_hw_ptr_interrupt
c_func
(paren
id|substream
)paren
OL
l_int|0
)paren
r_goto
id|_end
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;timer_running
)paren
id|snd_timer_interrupt
c_func
(paren
id|substream-&gt;timer
comma
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;sleep_min
)paren
id|snd_pcm_tick_prepare
c_func
(paren
id|substream
)paren
suffix:semicolon
id|_end
suffix:colon
id|snd_pcm_stream_unlock_irqrestore
c_func
(paren
id|substream
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;transfer_ack_end
)paren
id|runtime
op_member_access_from_pointer
id|transfer_ack_end
c_func
(paren
id|substream
)paren
suffix:semicolon
id|kill_fasync
c_func
(paren
op_amp
id|runtime-&gt;fasync
comma
id|SIGIO
comma
id|POLL_IN
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_lib_write_transfer
r_static
r_int
id|snd_pcm_lib_write_transfer
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
r_int
id|hwoff
comma
r_int
r_int
id|data
comma
r_int
r_int
id|off
comma
id|snd_pcm_uframes_t
id|frames
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_int
id|err
suffix:semicolon
r_char
id|__user
op_star
id|buf
op_assign
(paren
r_char
id|__user
op_star
)paren
id|data
op_plus
id|frames_to_bytes
c_func
(paren
id|runtime
comma
id|off
)paren
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;ops-&gt;copy
)paren
(brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|substream-&gt;ops
op_member_access_from_pointer
id|copy
c_func
(paren
id|substream
comma
op_minus
l_int|1
comma
id|hwoff
comma
id|buf
comma
id|frames
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
r_else
(brace
r_char
op_star
id|hwbuf
op_assign
id|runtime-&gt;dma_area
op_plus
id|frames_to_bytes
c_func
(paren
id|runtime
comma
id|hwoff
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|runtime-&gt;dma_area
comma
r_return
op_minus
id|EFAULT
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
id|hwbuf
comma
id|buf
comma
id|frames_to_bytes
c_func
(paren
id|runtime
comma
id|frames
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|typedef|transfer_f
r_typedef
r_int
(paren
op_star
id|transfer_f
)paren
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
r_int
id|hwoff
comma
r_int
r_int
id|data
comma
r_int
r_int
id|off
comma
id|snd_pcm_uframes_t
id|size
)paren
suffix:semicolon
DECL|function|snd_pcm_lib_write1
r_static
id|snd_pcm_sframes_t
id|snd_pcm_lib_write1
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
r_int
id|data
comma
id|snd_pcm_uframes_t
id|size
comma
r_int
id|nonblock
comma
id|transfer_f
id|transfer
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_pcm_uframes_t
id|xfer
op_assign
l_int|0
suffix:semicolon
id|snd_pcm_uframes_t
id|offset
op_assign
l_int|0
suffix:semicolon
r_int
id|err
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|size
op_eq
l_int|0
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|size
OG
id|runtime-&gt;xfer_align
)paren
id|size
op_sub_assign
id|size
op_mod
id|runtime-&gt;xfer_align
suffix:semicolon
id|snd_pcm_stream_lock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|runtime-&gt;status-&gt;state
)paren
(brace
r_case
id|SNDRV_PCM_STATE_PREPARED
suffix:colon
r_case
id|SNDRV_PCM_STATE_RUNNING
suffix:colon
r_case
id|SNDRV_PCM_STATE_PAUSED
suffix:colon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_XRUN
suffix:colon
id|err
op_assign
op_minus
id|EPIPE
suffix:semicolon
r_goto
id|_end_unlock
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_SUSPENDED
suffix:colon
id|err
op_assign
op_minus
id|ESTRPIPE
suffix:semicolon
r_goto
id|_end_unlock
suffix:semicolon
r_default
suffix:colon
id|err
op_assign
op_minus
id|EBADFD
suffix:semicolon
r_goto
id|_end_unlock
suffix:semicolon
)brace
r_while
c_loop
(paren
id|size
OG
l_int|0
)paren
(brace
id|snd_pcm_uframes_t
id|frames
comma
id|appl_ptr
comma
id|appl_ofs
suffix:semicolon
id|snd_pcm_uframes_t
id|avail
suffix:semicolon
id|snd_pcm_uframes_t
id|cont
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;sleep_min
op_eq
l_int|0
op_logical_and
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_RUNNING
)paren
id|snd_pcm_update_hw_ptr
c_func
(paren
id|substream
)paren
suffix:semicolon
id|avail
op_assign
id|snd_pcm_playback_avail
c_func
(paren
id|runtime
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
(paren
id|avail
template_param
id|avail
)paren
op_logical_or
(paren
id|size
op_ge
id|runtime-&gt;xfer_align
op_logical_and
id|avail
OL
id|runtime-&gt;xfer_align
)paren
)paren
)paren
(brace
id|wait_queue_t
id|wait
suffix:semicolon
r_enum
(brace
id|READY
comma
id|SIGNALED
comma
id|ERROR
comma
id|SUSPENDED
comma
id|EXPIRED
)brace
id|state
suffix:semicolon
r_int
id|tout
suffix:semicolon
r_if
c_cond
(paren
id|nonblock
)paren
(brace
id|err
op_assign
op_minus
id|EAGAIN
suffix:semicolon
r_goto
id|_end_unlock
suffix:semicolon
)brace
id|init_waitqueue_entry
c_func
(paren
op_amp
id|wait
comma
id|current
)paren
suffix:semicolon
id|add_wait_queue
c_func
(paren
op_amp
id|runtime-&gt;sleep
comma
op_amp
id|wait
)paren
suffix:semicolon
r_while
c_loop
(paren
l_int|1
)paren
(brace
r_if
c_cond
(paren
id|signal_pending
c_func
(paren
id|current
)paren
)paren
(brace
id|state
op_assign
id|SIGNALED
suffix:semicolon
r_break
suffix:semicolon
)brace
id|set_current_state
c_func
(paren
id|TASK_INTERRUPTIBLE
)paren
suffix:semicolon
id|snd_pcm_stream_unlock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
id|tout
op_assign
id|schedule_timeout
c_func
(paren
l_int|10
op_star
id|HZ
)paren
suffix:semicolon
id|snd_pcm_stream_lock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tout
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_ne
id|SNDRV_PCM_STATE_PREPARED
op_logical_and
id|runtime-&gt;status-&gt;state
op_ne
id|SNDRV_PCM_STATE_PAUSED
)paren
(brace
id|state
op_assign
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_SUSPENDED
ques
c_cond
id|SUSPENDED
suffix:colon
id|EXPIRED
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_switch
c_cond
(paren
id|runtime-&gt;status-&gt;state
)paren
(brace
r_case
id|SNDRV_PCM_STATE_XRUN
suffix:colon
r_case
id|SNDRV_PCM_STATE_DRAINING
suffix:colon
id|state
op_assign
id|ERROR
suffix:semicolon
r_goto
id|_end_loop
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_SUSPENDED
suffix:colon
id|state
op_assign
id|SUSPENDED
suffix:semicolon
r_goto
id|_end_loop
suffix:semicolon
r_default
suffix:colon
r_break
suffix:semicolon
)brace
id|avail
op_assign
id|snd_pcm_playback_avail
c_func
(paren
id|runtime
)paren
suffix:semicolon
r_if
c_cond
(paren
id|avail
op_ge
id|runtime-&gt;control-&gt;avail_min
)paren
(brace
id|state
op_assign
id|READY
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
id|_end_loop
suffix:colon
id|remove_wait_queue
c_func
(paren
op_amp
id|runtime-&gt;sleep
comma
op_amp
id|wait
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|state
)paren
(brace
r_case
id|ERROR
suffix:colon
id|err
op_assign
op_minus
id|EPIPE
suffix:semicolon
r_goto
id|_end_unlock
suffix:semicolon
r_case
id|SUSPENDED
suffix:colon
id|err
op_assign
op_minus
id|ESTRPIPE
suffix:semicolon
r_goto
id|_end_unlock
suffix:semicolon
r_case
id|SIGNALED
suffix:colon
id|err
op_assign
op_minus
id|ERESTARTSYS
suffix:semicolon
r_goto
id|_end_unlock
suffix:semicolon
r_case
id|EXPIRED
suffix:colon
id|snd_printd
c_func
(paren
l_string|&quot;playback write error (DMA or IRQ trouble?)&bslash;n&quot;
)paren
suffix:semicolon
id|err
op_assign
op_minus
id|EIO
suffix:semicolon
r_goto
id|_end_unlock
suffix:semicolon
r_default
suffix:colon
r_break
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|avail
OG
id|runtime-&gt;xfer_align
)paren
id|avail
op_sub_assign
id|avail
op_mod
id|runtime-&gt;xfer_align
suffix:semicolon
id|frames
op_assign
id|size
OG
id|avail
ques
c_cond
id|avail
suffix:colon
id|size
suffix:semicolon
id|cont
op_assign
id|runtime-&gt;buffer_size
op_minus
id|runtime-&gt;control-&gt;appl_ptr
op_mod
id|runtime-&gt;buffer_size
suffix:semicolon
r_if
c_cond
(paren
id|frames
OG
id|cont
)paren
id|frames
op_assign
id|cont
suffix:semicolon
id|snd_assert
c_func
(paren
id|frames
op_ne
l_int|0
comma
id|snd_pcm_stream_unlock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|appl_ptr
op_assign
id|runtime-&gt;control-&gt;appl_ptr
suffix:semicolon
id|appl_ofs
op_assign
id|appl_ptr
op_mod
id|runtime-&gt;buffer_size
suffix:semicolon
id|snd_pcm_stream_unlock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|transfer
c_func
(paren
id|substream
comma
id|appl_ofs
comma
id|data
comma
id|offset
comma
id|frames
)paren
)paren
OL
l_int|0
)paren
r_goto
id|_end
suffix:semicolon
id|snd_pcm_stream_lock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|runtime-&gt;status-&gt;state
)paren
(brace
r_case
id|SNDRV_PCM_STATE_XRUN
suffix:colon
id|err
op_assign
op_minus
id|EPIPE
suffix:semicolon
r_goto
id|_end_unlock
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_SUSPENDED
suffix:colon
id|err
op_assign
op_minus
id|ESTRPIPE
suffix:semicolon
r_goto
id|_end_unlock
suffix:semicolon
r_default
suffix:colon
r_break
suffix:semicolon
)brace
id|appl_ptr
op_add_assign
id|frames
suffix:semicolon
r_if
c_cond
(paren
id|appl_ptr
op_ge
id|runtime-&gt;boundary
)paren
(brace
id|runtime-&gt;control-&gt;appl_ptr
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|runtime-&gt;control-&gt;appl_ptr
op_assign
id|appl_ptr
suffix:semicolon
)brace
r_if
c_cond
(paren
id|substream-&gt;ops-&gt;ack
)paren
id|substream-&gt;ops
op_member_access_from_pointer
id|ack
c_func
(paren
id|substream
)paren
suffix:semicolon
id|offset
op_add_assign
id|frames
suffix:semicolon
id|size
op_sub_assign
id|frames
suffix:semicolon
id|xfer
op_add_assign
id|frames
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_PREPARED
op_logical_and
id|snd_pcm_playback_hw_avail
c_func
(paren
id|runtime
)paren
op_ge
(paren
id|snd_pcm_sframes_t
)paren
id|runtime-&gt;start_threshold
)paren
(brace
id|err
op_assign
id|snd_pcm_start
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_goto
id|_end_unlock
suffix:semicolon
)brace
r_if
c_cond
(paren
id|runtime-&gt;sleep_min
op_logical_and
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_RUNNING
)paren
id|snd_pcm_tick_prepare
c_func
(paren
id|substream
)paren
suffix:semicolon
)brace
id|_end_unlock
suffix:colon
id|snd_pcm_stream_unlock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
id|_end
suffix:colon
r_return
id|xfer
OG
l_int|0
ques
c_cond
(paren
id|snd_pcm_sframes_t
)paren
id|xfer
suffix:colon
id|err
suffix:semicolon
)brace
DECL|function|snd_pcm_lib_write
id|snd_pcm_sframes_t
id|snd_pcm_lib_write
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_const
r_void
id|__user
op_star
id|buf
comma
id|snd_pcm_uframes_t
id|size
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_int
id|nonblock
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_assert
c_func
(paren
id|runtime
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream-&gt;ops-&gt;copy
op_ne
l_int|NULL
op_logical_or
id|runtime-&gt;dma_area
op_ne
l_int|NULL
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_OPEN
)paren
r_return
op_minus
id|EBADFD
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream-&gt;ffile
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|nonblock
op_assign
op_logical_neg
op_logical_neg
(paren
id|substream-&gt;ffile-&gt;f_flags
op_amp
id|O_NONBLOCK
)paren
suffix:semicolon
macro_line|#if defined(CONFIG_SND_PCM_OSS) || defined(CONFIG_SND_PCM_OSS_MODULE)
r_if
c_cond
(paren
id|substream-&gt;oss.oss
)paren
(brace
id|snd_pcm_oss_setup_t
op_star
id|setup
op_assign
id|substream-&gt;oss.setup
suffix:semicolon
r_if
c_cond
(paren
id|setup
op_ne
l_int|NULL
)paren
(brace
r_if
c_cond
(paren
id|setup-&gt;nonblock
)paren
id|nonblock
op_assign
l_int|1
suffix:semicolon
r_else
r_if
c_cond
(paren
id|setup-&gt;block
)paren
id|nonblock
op_assign
l_int|0
suffix:semicolon
)brace
)brace
macro_line|#endif
r_if
c_cond
(paren
id|runtime-&gt;access
op_ne
id|SNDRV_PCM_ACCESS_RW_INTERLEAVED
op_logical_and
id|runtime-&gt;channels
OG
l_int|1
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|snd_pcm_lib_write1
c_func
(paren
id|substream
comma
(paren
r_int
r_int
)paren
id|buf
comma
id|size
comma
id|nonblock
comma
id|snd_pcm_lib_write_transfer
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_lib_writev_transfer
r_static
r_int
id|snd_pcm_lib_writev_transfer
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
r_int
id|hwoff
comma
r_int
r_int
id|data
comma
r_int
r_int
id|off
comma
id|snd_pcm_uframes_t
id|frames
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_int
id|err
suffix:semicolon
r_void
id|__user
op_star
op_star
id|bufs
op_assign
(paren
r_void
id|__user
op_star
op_star
)paren
id|data
suffix:semicolon
r_int
id|channels
op_assign
id|runtime-&gt;channels
suffix:semicolon
r_int
id|c
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;ops-&gt;copy
)paren
(brace
id|snd_assert
c_func
(paren
id|substream-&gt;ops-&gt;silence
op_ne
l_int|NULL
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
r_for
c_loop
(paren
id|c
op_assign
l_int|0
suffix:semicolon
id|c
OL
id|channels
suffix:semicolon
op_increment
id|c
comma
op_increment
id|bufs
)paren
(brace
r_if
c_cond
(paren
op_star
id|bufs
op_eq
l_int|NULL
)paren
(brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|substream-&gt;ops
op_member_access_from_pointer
id|silence
c_func
(paren
id|substream
comma
id|c
comma
id|hwoff
comma
id|frames
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
r_else
(brace
r_char
id|__user
op_star
id|buf
op_assign
op_star
id|bufs
op_plus
id|samples_to_bytes
c_func
(paren
id|runtime
comma
id|off
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|substream-&gt;ops
op_member_access_from_pointer
id|copy
c_func
(paren
id|substream
comma
id|c
comma
id|hwoff
comma
id|buf
comma
id|frames
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
)brace
)brace
r_else
(brace
multiline_comment|/* default transfer behaviour */
r_int
id|dma_csize
op_assign
id|runtime-&gt;dma_bytes
op_div
id|channels
suffix:semicolon
id|snd_assert
c_func
(paren
id|runtime-&gt;dma_area
comma
r_return
op_minus
id|EFAULT
)paren
suffix:semicolon
r_for
c_loop
(paren
id|c
op_assign
l_int|0
suffix:semicolon
id|c
OL
id|channels
suffix:semicolon
op_increment
id|c
comma
op_increment
id|bufs
)paren
(brace
r_char
op_star
id|hwbuf
op_assign
id|runtime-&gt;dma_area
op_plus
(paren
id|c
op_star
id|dma_csize
)paren
op_plus
id|samples_to_bytes
c_func
(paren
id|runtime
comma
id|hwoff
)paren
suffix:semicolon
r_if
c_cond
(paren
op_star
id|bufs
op_eq
l_int|NULL
)paren
(brace
id|snd_pcm_format_set_silence
c_func
(paren
id|runtime-&gt;format
comma
id|hwbuf
comma
id|frames
)paren
suffix:semicolon
)brace
r_else
(brace
r_char
id|__user
op_star
id|buf
op_assign
op_star
id|bufs
op_plus
id|samples_to_bytes
c_func
(paren
id|runtime
comma
id|off
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
id|hwbuf
comma
id|buf
comma
id|samples_to_bytes
c_func
(paren
id|runtime
comma
id|frames
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_lib_writev
id|snd_pcm_sframes_t
id|snd_pcm_lib_writev
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_void
id|__user
op_star
op_star
id|bufs
comma
id|snd_pcm_uframes_t
id|frames
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_int
id|nonblock
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_assert
c_func
(paren
id|runtime
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream-&gt;ops-&gt;copy
op_ne
l_int|NULL
op_logical_or
id|runtime-&gt;dma_area
op_ne
l_int|NULL
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_OPEN
)paren
r_return
op_minus
id|EBADFD
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream-&gt;ffile
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|nonblock
op_assign
op_logical_neg
op_logical_neg
(paren
id|substream-&gt;ffile-&gt;f_flags
op_amp
id|O_NONBLOCK
)paren
suffix:semicolon
macro_line|#if defined(CONFIG_SND_PCM_OSS) || defined(CONFIG_SND_PCM_OSS_MODULE)
r_if
c_cond
(paren
id|substream-&gt;oss.oss
)paren
(brace
id|snd_pcm_oss_setup_t
op_star
id|setup
op_assign
id|substream-&gt;oss.setup
suffix:semicolon
r_if
c_cond
(paren
id|setup
op_ne
l_int|NULL
)paren
(brace
r_if
c_cond
(paren
id|setup-&gt;nonblock
)paren
id|nonblock
op_assign
l_int|1
suffix:semicolon
r_else
r_if
c_cond
(paren
id|setup-&gt;block
)paren
id|nonblock
op_assign
l_int|0
suffix:semicolon
)brace
)brace
macro_line|#endif
r_if
c_cond
(paren
id|runtime-&gt;access
op_ne
id|SNDRV_PCM_ACCESS_RW_NONINTERLEAVED
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|snd_pcm_lib_write1
c_func
(paren
id|substream
comma
(paren
r_int
r_int
)paren
id|bufs
comma
id|frames
comma
id|nonblock
comma
id|snd_pcm_lib_writev_transfer
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_lib_read_transfer
r_static
r_int
id|snd_pcm_lib_read_transfer
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
r_int
id|hwoff
comma
r_int
r_int
id|data
comma
r_int
r_int
id|off
comma
id|snd_pcm_uframes_t
id|frames
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_int
id|err
suffix:semicolon
r_char
id|__user
op_star
id|buf
op_assign
(paren
r_char
id|__user
op_star
)paren
id|data
op_plus
id|frames_to_bytes
c_func
(paren
id|runtime
comma
id|off
)paren
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;ops-&gt;copy
)paren
(brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|substream-&gt;ops
op_member_access_from_pointer
id|copy
c_func
(paren
id|substream
comma
op_minus
l_int|1
comma
id|hwoff
comma
id|buf
comma
id|frames
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
r_else
(brace
r_char
op_star
id|hwbuf
op_assign
id|runtime-&gt;dma_area
op_plus
id|frames_to_bytes
c_func
(paren
id|runtime
comma
id|hwoff
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|runtime-&gt;dma_area
comma
r_return
op_minus
id|EFAULT
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|buf
comma
id|hwbuf
comma
id|frames_to_bytes
c_func
(paren
id|runtime
comma
id|frames
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_lib_read1
r_static
id|snd_pcm_sframes_t
id|snd_pcm_lib_read1
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
r_int
id|data
comma
id|snd_pcm_uframes_t
id|size
comma
r_int
id|nonblock
comma
id|transfer_f
id|transfer
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_pcm_uframes_t
id|xfer
op_assign
l_int|0
suffix:semicolon
id|snd_pcm_uframes_t
id|offset
op_assign
l_int|0
suffix:semicolon
r_int
id|err
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|size
op_eq
l_int|0
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|size
OG
id|runtime-&gt;xfer_align
)paren
id|size
op_sub_assign
id|size
op_mod
id|runtime-&gt;xfer_align
suffix:semicolon
id|snd_pcm_stream_lock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|runtime-&gt;status-&gt;state
)paren
(brace
r_case
id|SNDRV_PCM_STATE_PREPARED
suffix:colon
r_if
c_cond
(paren
id|size
op_ge
id|runtime-&gt;start_threshold
)paren
(brace
id|err
op_assign
id|snd_pcm_start
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_goto
id|_end_unlock
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_DRAINING
suffix:colon
r_case
id|SNDRV_PCM_STATE_RUNNING
suffix:colon
r_case
id|SNDRV_PCM_STATE_PAUSED
suffix:colon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_XRUN
suffix:colon
id|err
op_assign
op_minus
id|EPIPE
suffix:semicolon
r_goto
id|_end_unlock
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_SUSPENDED
suffix:colon
id|err
op_assign
op_minus
id|ESTRPIPE
suffix:semicolon
r_goto
id|_end_unlock
suffix:semicolon
r_default
suffix:colon
id|err
op_assign
op_minus
id|EBADFD
suffix:semicolon
r_goto
id|_end_unlock
suffix:semicolon
)brace
r_while
c_loop
(paren
id|size
OG
l_int|0
)paren
(brace
id|snd_pcm_uframes_t
id|frames
comma
id|appl_ptr
comma
id|appl_ofs
suffix:semicolon
id|snd_pcm_uframes_t
id|avail
suffix:semicolon
id|snd_pcm_uframes_t
id|cont
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;sleep_min
op_eq
l_int|0
op_logical_and
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_RUNNING
)paren
id|snd_pcm_update_hw_ptr
c_func
(paren
id|substream
)paren
suffix:semicolon
id|__draining
suffix:colon
id|avail
op_assign
id|snd_pcm_capture_avail
c_func
(paren
id|runtime
)paren
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_DRAINING
)paren
(brace
r_if
c_cond
(paren
id|avail
OL
id|runtime-&gt;xfer_align
)paren
(brace
id|err
op_assign
op_minus
id|EPIPE
suffix:semicolon
r_goto
id|_end_unlock
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
(paren
id|avail
template_param
id|avail
)paren
op_logical_or
(paren
id|size
op_ge
id|runtime-&gt;xfer_align
op_logical_and
id|avail
OL
id|runtime-&gt;xfer_align
)paren
)paren
(brace
id|wait_queue_t
id|wait
suffix:semicolon
r_enum
(brace
id|READY
comma
id|SIGNALED
comma
id|ERROR
comma
id|SUSPENDED
comma
id|EXPIRED
)brace
id|state
suffix:semicolon
r_int
id|tout
suffix:semicolon
r_if
c_cond
(paren
id|nonblock
)paren
(brace
id|err
op_assign
op_minus
id|EAGAIN
suffix:semicolon
r_goto
id|_end_unlock
suffix:semicolon
)brace
id|init_waitqueue_entry
c_func
(paren
op_amp
id|wait
comma
id|current
)paren
suffix:semicolon
id|add_wait_queue
c_func
(paren
op_amp
id|runtime-&gt;sleep
comma
op_amp
id|wait
)paren
suffix:semicolon
r_while
c_loop
(paren
l_int|1
)paren
(brace
r_if
c_cond
(paren
id|signal_pending
c_func
(paren
id|current
)paren
)paren
(brace
id|state
op_assign
id|SIGNALED
suffix:semicolon
r_break
suffix:semicolon
)brace
id|set_current_state
c_func
(paren
id|TASK_INTERRUPTIBLE
)paren
suffix:semicolon
id|snd_pcm_stream_unlock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
id|tout
op_assign
id|schedule_timeout
c_func
(paren
l_int|10
op_star
id|HZ
)paren
suffix:semicolon
id|snd_pcm_stream_lock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tout
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_ne
id|SNDRV_PCM_STATE_PREPARED
op_logical_and
id|runtime-&gt;status-&gt;state
op_ne
id|SNDRV_PCM_STATE_PAUSED
)paren
(brace
id|state
op_assign
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_SUSPENDED
ques
c_cond
id|SUSPENDED
suffix:colon
id|EXPIRED
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_switch
c_cond
(paren
id|runtime-&gt;status-&gt;state
)paren
(brace
r_case
id|SNDRV_PCM_STATE_XRUN
suffix:colon
id|state
op_assign
id|ERROR
suffix:semicolon
r_goto
id|_end_loop
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_SUSPENDED
suffix:colon
id|state
op_assign
id|SUSPENDED
suffix:semicolon
r_goto
id|_end_loop
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_DRAINING
suffix:colon
r_goto
id|__draining
suffix:semicolon
r_default
suffix:colon
r_break
suffix:semicolon
)brace
id|avail
op_assign
id|snd_pcm_capture_avail
c_func
(paren
id|runtime
)paren
suffix:semicolon
r_if
c_cond
(paren
id|avail
op_ge
id|runtime-&gt;control-&gt;avail_min
)paren
(brace
id|state
op_assign
id|READY
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
id|_end_loop
suffix:colon
id|remove_wait_queue
c_func
(paren
op_amp
id|runtime-&gt;sleep
comma
op_amp
id|wait
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|state
)paren
(brace
r_case
id|ERROR
suffix:colon
id|err
op_assign
op_minus
id|EPIPE
suffix:semicolon
r_goto
id|_end_unlock
suffix:semicolon
r_case
id|SUSPENDED
suffix:colon
id|err
op_assign
op_minus
id|ESTRPIPE
suffix:semicolon
r_goto
id|_end_unlock
suffix:semicolon
r_case
id|SIGNALED
suffix:colon
id|err
op_assign
op_minus
id|ERESTARTSYS
suffix:semicolon
r_goto
id|_end_unlock
suffix:semicolon
r_case
id|EXPIRED
suffix:colon
id|snd_printd
c_func
(paren
l_string|&quot;capture read error (DMA or IRQ trouble?)&bslash;n&quot;
)paren
suffix:semicolon
id|err
op_assign
op_minus
id|EIO
suffix:semicolon
r_goto
id|_end_unlock
suffix:semicolon
r_default
suffix:colon
r_break
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|avail
OG
id|runtime-&gt;xfer_align
)paren
id|avail
op_sub_assign
id|avail
op_mod
id|runtime-&gt;xfer_align
suffix:semicolon
id|frames
op_assign
id|size
OG
id|avail
ques
c_cond
id|avail
suffix:colon
id|size
suffix:semicolon
id|cont
op_assign
id|runtime-&gt;buffer_size
op_minus
id|runtime-&gt;control-&gt;appl_ptr
op_mod
id|runtime-&gt;buffer_size
suffix:semicolon
r_if
c_cond
(paren
id|frames
OG
id|cont
)paren
id|frames
op_assign
id|cont
suffix:semicolon
id|snd_assert
c_func
(paren
id|frames
op_ne
l_int|0
comma
id|snd_pcm_stream_unlock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|appl_ptr
op_assign
id|runtime-&gt;control-&gt;appl_ptr
suffix:semicolon
id|appl_ofs
op_assign
id|appl_ptr
op_mod
id|runtime-&gt;buffer_size
suffix:semicolon
id|snd_pcm_stream_unlock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|transfer
c_func
(paren
id|substream
comma
id|appl_ofs
comma
id|data
comma
id|offset
comma
id|frames
)paren
)paren
OL
l_int|0
)paren
r_goto
id|_end
suffix:semicolon
id|snd_pcm_stream_lock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|runtime-&gt;status-&gt;state
)paren
(brace
r_case
id|SNDRV_PCM_STATE_XRUN
suffix:colon
id|err
op_assign
op_minus
id|EPIPE
suffix:semicolon
r_goto
id|_end_unlock
suffix:semicolon
r_case
id|SNDRV_PCM_STATE_SUSPENDED
suffix:colon
id|err
op_assign
op_minus
id|ESTRPIPE
suffix:semicolon
r_goto
id|_end_unlock
suffix:semicolon
r_default
suffix:colon
r_break
suffix:semicolon
)brace
id|appl_ptr
op_add_assign
id|frames
suffix:semicolon
r_if
c_cond
(paren
id|appl_ptr
op_ge
id|runtime-&gt;boundary
)paren
(brace
id|runtime-&gt;control-&gt;appl_ptr
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|runtime-&gt;control-&gt;appl_ptr
op_assign
id|appl_ptr
suffix:semicolon
)brace
r_if
c_cond
(paren
id|substream-&gt;ops-&gt;ack
)paren
id|substream-&gt;ops
op_member_access_from_pointer
id|ack
c_func
(paren
id|substream
)paren
suffix:semicolon
id|offset
op_add_assign
id|frames
suffix:semicolon
id|size
op_sub_assign
id|frames
suffix:semicolon
id|xfer
op_add_assign
id|frames
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;sleep_min
op_logical_and
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_RUNNING
)paren
id|snd_pcm_tick_prepare
c_func
(paren
id|substream
)paren
suffix:semicolon
)brace
id|_end_unlock
suffix:colon
id|snd_pcm_stream_unlock_irq
c_func
(paren
id|substream
)paren
suffix:semicolon
id|_end
suffix:colon
r_return
id|xfer
OG
l_int|0
ques
c_cond
(paren
id|snd_pcm_sframes_t
)paren
id|xfer
suffix:colon
id|err
suffix:semicolon
)brace
DECL|function|snd_pcm_lib_read
id|snd_pcm_sframes_t
id|snd_pcm_lib_read
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_void
id|__user
op_star
id|buf
comma
id|snd_pcm_uframes_t
id|size
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_int
id|nonblock
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_assert
c_func
(paren
id|runtime
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream-&gt;ops-&gt;copy
op_ne
l_int|NULL
op_logical_or
id|runtime-&gt;dma_area
op_ne
l_int|NULL
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_OPEN
)paren
r_return
op_minus
id|EBADFD
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream-&gt;ffile
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|nonblock
op_assign
op_logical_neg
op_logical_neg
(paren
id|substream-&gt;ffile-&gt;f_flags
op_amp
id|O_NONBLOCK
)paren
suffix:semicolon
macro_line|#if defined(CONFIG_SND_PCM_OSS) || defined(CONFIG_SND_PCM_OSS_MODULE)
r_if
c_cond
(paren
id|substream-&gt;oss.oss
)paren
(brace
id|snd_pcm_oss_setup_t
op_star
id|setup
op_assign
id|substream-&gt;oss.setup
suffix:semicolon
r_if
c_cond
(paren
id|setup
op_ne
l_int|NULL
)paren
(brace
r_if
c_cond
(paren
id|setup-&gt;nonblock
)paren
id|nonblock
op_assign
l_int|1
suffix:semicolon
r_else
r_if
c_cond
(paren
id|setup-&gt;block
)paren
id|nonblock
op_assign
l_int|0
suffix:semicolon
)brace
)brace
macro_line|#endif
r_if
c_cond
(paren
id|runtime-&gt;access
op_ne
id|SNDRV_PCM_ACCESS_RW_INTERLEAVED
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|snd_pcm_lib_read1
c_func
(paren
id|substream
comma
(paren
r_int
r_int
)paren
id|buf
comma
id|size
comma
id|nonblock
comma
id|snd_pcm_lib_read_transfer
)paren
suffix:semicolon
)brace
DECL|function|snd_pcm_lib_readv_transfer
r_static
r_int
id|snd_pcm_lib_readv_transfer
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
r_int
id|hwoff
comma
r_int
r_int
id|data
comma
r_int
r_int
id|off
comma
id|snd_pcm_uframes_t
id|frames
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_int
id|err
suffix:semicolon
r_void
id|__user
op_star
op_star
id|bufs
op_assign
(paren
r_void
id|__user
op_star
op_star
)paren
id|data
suffix:semicolon
r_int
id|channels
op_assign
id|runtime-&gt;channels
suffix:semicolon
r_int
id|c
suffix:semicolon
r_if
c_cond
(paren
id|substream-&gt;ops-&gt;copy
)paren
(brace
r_for
c_loop
(paren
id|c
op_assign
l_int|0
suffix:semicolon
id|c
OL
id|channels
suffix:semicolon
op_increment
id|c
comma
op_increment
id|bufs
)paren
(brace
r_char
id|__user
op_star
id|buf
suffix:semicolon
r_if
c_cond
(paren
op_star
id|bufs
op_eq
l_int|NULL
)paren
r_continue
suffix:semicolon
id|buf
op_assign
op_star
id|bufs
op_plus
id|samples_to_bytes
c_func
(paren
id|runtime
comma
id|off
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|substream-&gt;ops
op_member_access_from_pointer
id|copy
c_func
(paren
id|substream
comma
id|c
comma
id|hwoff
comma
id|buf
comma
id|frames
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
)brace
r_else
(brace
id|snd_pcm_uframes_t
id|dma_csize
op_assign
id|runtime-&gt;dma_bytes
op_div
id|channels
suffix:semicolon
id|snd_assert
c_func
(paren
id|runtime-&gt;dma_area
comma
r_return
op_minus
id|EFAULT
)paren
suffix:semicolon
r_for
c_loop
(paren
id|c
op_assign
l_int|0
suffix:semicolon
id|c
OL
id|channels
suffix:semicolon
op_increment
id|c
comma
op_increment
id|bufs
)paren
(brace
r_char
op_star
id|hwbuf
suffix:semicolon
r_char
id|__user
op_star
id|buf
suffix:semicolon
r_if
c_cond
(paren
op_star
id|bufs
op_eq
l_int|NULL
)paren
r_continue
suffix:semicolon
id|hwbuf
op_assign
id|runtime-&gt;dma_area
op_plus
(paren
id|c
op_star
id|dma_csize
)paren
op_plus
id|samples_to_bytes
c_func
(paren
id|runtime
comma
id|hwoff
)paren
suffix:semicolon
id|buf
op_assign
op_star
id|bufs
op_plus
id|samples_to_bytes
c_func
(paren
id|runtime
comma
id|off
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|buf
comma
id|hwbuf
comma
id|samples_to_bytes
c_func
(paren
id|runtime
comma
id|frames
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_pcm_lib_readv
id|snd_pcm_sframes_t
id|snd_pcm_lib_readv
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_void
id|__user
op_star
op_star
id|bufs
comma
id|snd_pcm_uframes_t
id|frames
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
suffix:semicolon
r_int
id|nonblock
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
id|snd_assert
c_func
(paren
id|runtime
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream-&gt;ops-&gt;copy
op_ne
l_int|NULL
op_logical_or
id|runtime-&gt;dma_area
op_ne
l_int|NULL
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|runtime-&gt;status-&gt;state
op_eq
id|SNDRV_PCM_STATE_OPEN
)paren
r_return
op_minus
id|EBADFD
suffix:semicolon
id|snd_assert
c_func
(paren
id|substream-&gt;ffile
op_ne
l_int|NULL
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
id|nonblock
op_assign
op_logical_neg
op_logical_neg
(paren
id|substream-&gt;ffile-&gt;f_flags
op_amp
id|O_NONBLOCK
)paren
suffix:semicolon
macro_line|#if defined(CONFIG_SND_PCM_OSS) || defined(CONFIG_SND_PCM_OSS_MODULE)
r_if
c_cond
(paren
id|substream-&gt;oss.oss
)paren
(brace
id|snd_pcm_oss_setup_t
op_star
id|setup
op_assign
id|substream-&gt;oss.setup
suffix:semicolon
r_if
c_cond
(paren
id|setup
op_ne
l_int|NULL
)paren
(brace
r_if
c_cond
(paren
id|setup-&gt;nonblock
)paren
id|nonblock
op_assign
l_int|1
suffix:semicolon
r_else
r_if
c_cond
(paren
id|setup-&gt;block
)paren
id|nonblock
op_assign
l_int|0
suffix:semicolon
)brace
)brace
macro_line|#endif
r_if
c_cond
(paren
id|runtime-&gt;access
op_ne
id|SNDRV_PCM_ACCESS_RW_NONINTERLEAVED
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|snd_pcm_lib_read1
c_func
(paren
id|substream
comma
(paren
r_int
r_int
)paren
id|bufs
comma
id|frames
comma
id|nonblock
comma
id|snd_pcm_lib_readv_transfer
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; *  Exported symbols&n; */
DECL|variable|snd_interval_refine
id|EXPORT_SYMBOL
c_func
(paren
id|snd_interval_refine
)paren
suffix:semicolon
DECL|variable|snd_interval_list
id|EXPORT_SYMBOL
c_func
(paren
id|snd_interval_list
)paren
suffix:semicolon
DECL|variable|snd_interval_ratnum
id|EXPORT_SYMBOL
c_func
(paren
id|snd_interval_ratnum
)paren
suffix:semicolon
DECL|variable|snd_interval_ratden
id|EXPORT_SYMBOL
c_func
(paren
id|snd_interval_ratden
)paren
suffix:semicolon
DECL|variable|snd_interval_muldivk
id|EXPORT_SYMBOL
c_func
(paren
id|snd_interval_muldivk
)paren
suffix:semicolon
DECL|variable|snd_interval_mulkdiv
id|EXPORT_SYMBOL
c_func
(paren
id|snd_interval_mulkdiv
)paren
suffix:semicolon
DECL|variable|snd_interval_div
id|EXPORT_SYMBOL
c_func
(paren
id|snd_interval_div
)paren
suffix:semicolon
DECL|variable|_snd_pcm_hw_params_any
id|EXPORT_SYMBOL
c_func
(paren
id|_snd_pcm_hw_params_any
)paren
suffix:semicolon
DECL|variable|_snd_pcm_hw_param_min
id|EXPORT_SYMBOL
c_func
(paren
id|_snd_pcm_hw_param_min
)paren
suffix:semicolon
DECL|variable|_snd_pcm_hw_param_set
id|EXPORT_SYMBOL
c_func
(paren
id|_snd_pcm_hw_param_set
)paren
suffix:semicolon
DECL|variable|_snd_pcm_hw_param_setempty
id|EXPORT_SYMBOL
c_func
(paren
id|_snd_pcm_hw_param_setempty
)paren
suffix:semicolon
DECL|variable|_snd_pcm_hw_param_setinteger
id|EXPORT_SYMBOL
c_func
(paren
id|_snd_pcm_hw_param_setinteger
)paren
suffix:semicolon
DECL|variable|snd_pcm_hw_param_value_min
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_hw_param_value_min
)paren
suffix:semicolon
DECL|variable|snd_pcm_hw_param_value_max
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_hw_param_value_max
)paren
suffix:semicolon
DECL|variable|snd_pcm_hw_param_mask
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_hw_param_mask
)paren
suffix:semicolon
DECL|variable|snd_pcm_hw_param_first
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_hw_param_first
)paren
suffix:semicolon
DECL|variable|snd_pcm_hw_param_last
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_hw_param_last
)paren
suffix:semicolon
DECL|variable|snd_pcm_hw_param_near
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_hw_param_near
)paren
suffix:semicolon
DECL|variable|snd_pcm_hw_param_set
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_hw_param_set
)paren
suffix:semicolon
DECL|variable|snd_pcm_hw_refine
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_hw_refine
)paren
suffix:semicolon
DECL|variable|snd_pcm_hw_constraints_init
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_hw_constraints_init
)paren
suffix:semicolon
DECL|variable|snd_pcm_hw_constraints_complete
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_hw_constraints_complete
)paren
suffix:semicolon
DECL|variable|snd_pcm_hw_constraint_list
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_hw_constraint_list
)paren
suffix:semicolon
DECL|variable|snd_pcm_hw_constraint_step
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_hw_constraint_step
)paren
suffix:semicolon
DECL|variable|snd_pcm_hw_constraint_ratnums
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_hw_constraint_ratnums
)paren
suffix:semicolon
DECL|variable|snd_pcm_hw_constraint_ratdens
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_hw_constraint_ratdens
)paren
suffix:semicolon
DECL|variable|snd_pcm_hw_constraint_msbits
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_hw_constraint_msbits
)paren
suffix:semicolon
DECL|variable|snd_pcm_hw_constraint_minmax
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_hw_constraint_minmax
)paren
suffix:semicolon
DECL|variable|snd_pcm_hw_constraint_integer
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_hw_constraint_integer
)paren
suffix:semicolon
DECL|variable|snd_pcm_hw_constraint_pow2
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_hw_constraint_pow2
)paren
suffix:semicolon
DECL|variable|snd_pcm_hw_rule_add
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_hw_rule_add
)paren
suffix:semicolon
DECL|variable|snd_pcm_set_ops
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_set_ops
)paren
suffix:semicolon
DECL|variable|snd_pcm_set_sync
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_set_sync
)paren
suffix:semicolon
DECL|variable|snd_pcm_lib_ioctl
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_lib_ioctl
)paren
suffix:semicolon
DECL|variable|snd_pcm_playback_ready
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_playback_ready
)paren
suffix:semicolon
DECL|variable|snd_pcm_capture_ready
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_capture_ready
)paren
suffix:semicolon
DECL|variable|snd_pcm_playback_data
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_playback_data
)paren
suffix:semicolon
DECL|variable|snd_pcm_capture_empty
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_capture_empty
)paren
suffix:semicolon
DECL|variable|snd_pcm_stop
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_stop
)paren
suffix:semicolon
DECL|variable|snd_pcm_period_elapsed
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_period_elapsed
)paren
suffix:semicolon
DECL|variable|snd_pcm_lib_write
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_lib_write
)paren
suffix:semicolon
DECL|variable|snd_pcm_lib_read
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_lib_read
)paren
suffix:semicolon
DECL|variable|snd_pcm_lib_writev
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_lib_writev
)paren
suffix:semicolon
DECL|variable|snd_pcm_lib_readv
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_lib_readv
)paren
suffix:semicolon
DECL|variable|snd_pcm_lib_buffer_bytes
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_lib_buffer_bytes
)paren
suffix:semicolon
DECL|variable|snd_pcm_lib_period_bytes
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_lib_period_bytes
)paren
suffix:semicolon
multiline_comment|/* pcm_memory.c */
DECL|variable|snd_pcm_lib_preallocate_free
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_lib_preallocate_free
)paren
suffix:semicolon
DECL|variable|snd_pcm_lib_preallocate_free_for_all
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_lib_preallocate_free_for_all
)paren
suffix:semicolon
DECL|variable|snd_pcm_lib_preallocate_pages
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_lib_preallocate_pages
)paren
suffix:semicolon
DECL|variable|snd_pcm_lib_preallocate_pages_for_all
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_lib_preallocate_pages_for_all
)paren
suffix:semicolon
DECL|variable|snd_pcm_sgbuf_ops_page
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_sgbuf_ops_page
)paren
suffix:semicolon
DECL|variable|snd_pcm_lib_malloc_pages
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_lib_malloc_pages
)paren
suffix:semicolon
DECL|variable|snd_pcm_lib_free_pages
id|EXPORT_SYMBOL
c_func
(paren
id|snd_pcm_lib_free_pages
)paren
suffix:semicolon
eof
