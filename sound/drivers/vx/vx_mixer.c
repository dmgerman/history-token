multiline_comment|/*&n; * Driver for Digigram VX soundcards&n; *&n; * Common mixer part&n; *&n; * Copyright (c) 2002 by Takashi Iwai &lt;tiwai@suse.de&gt;&n; *&n; *   This program is free software; you can redistribute it and/or modify&n; *   it under the terms of the GNU General Public License as published by&n; *   the Free Software Foundation; either version 2 of the License, or&n; *   (at your option) any later version.&n; *&n; *   This program is distributed in the hope that it will be useful,&n; *   but WITHOUT ANY WARRANTY; without even the implied warranty of&n; *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; *   GNU General Public License for more details.&n; *&n; *   You should have received a copy of the GNU General Public License&n; *   along with this program; if not, write to the Free Software&n; *   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA&n; */
macro_line|#include &lt;sound/driver.h&gt;
macro_line|#include &lt;sound/core.h&gt;
macro_line|#include &lt;sound/control.h&gt;
macro_line|#include &lt;sound/vx_core.h&gt;
macro_line|#include &quot;vx_cmd.h&quot;
multiline_comment|/*&n; * write a codec data (24bit)&n; */
DECL|function|vx_write_codec_reg
r_static
r_void
id|vx_write_codec_reg
c_func
(paren
id|vx_core_t
op_star
id|chip
comma
r_int
id|codec
comma
r_int
r_int
id|data
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
id|snd_assert
c_func
(paren
id|chip-&gt;ops-&gt;write_codec
comma
r_return
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;chip_status
op_amp
id|VX_STAT_IS_STALE
)paren
r_return
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|chip-&gt;ops
op_member_access_from_pointer
id|write_codec
c_func
(paren
id|chip
comma
id|codec
comma
id|data
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Data type used to access the Codec&n; */
r_typedef
r_union
(brace
DECL|member|l
id|u32
id|l
suffix:semicolon
macro_line|#ifdef SNDRV_BIG_ENDIAN
DECL|struct|w
r_struct
id|w
(brace
DECL|member|h
id|u16
id|h
suffix:semicolon
DECL|member|l
id|u16
id|l
suffix:semicolon
DECL|member|w
)brace
id|w
suffix:semicolon
DECL|struct|b
r_struct
id|b
(brace
DECL|member|hh
id|u8
id|hh
suffix:semicolon
DECL|member|mh
id|u8
id|mh
suffix:semicolon
DECL|member|ml
id|u8
id|ml
suffix:semicolon
DECL|member|ll
id|u8
id|ll
suffix:semicolon
DECL|member|b
)brace
id|b
suffix:semicolon
macro_line|#else /* LITTLE_ENDIAN */
DECL|struct|w
r_struct
id|w
(brace
DECL|member|l
id|u16
id|l
suffix:semicolon
DECL|member|h
id|u16
id|h
suffix:semicolon
DECL|member|w
)brace
id|w
suffix:semicolon
DECL|struct|b
r_struct
id|b
(brace
DECL|member|ll
id|u8
id|ll
suffix:semicolon
DECL|member|ml
id|u8
id|ml
suffix:semicolon
DECL|member|mh
id|u8
id|mh
suffix:semicolon
DECL|member|hh
id|u8
id|hh
suffix:semicolon
DECL|member|b
)brace
id|b
suffix:semicolon
macro_line|#endif
DECL|typedef|vx_codec_data_t
)brace
id|vx_codec_data_t
suffix:semicolon
DECL|macro|SET_CDC_DATA_SEL
mdefine_line|#define SET_CDC_DATA_SEL(di,s)          ((di).b.mh = (u8) (s))
DECL|macro|SET_CDC_DATA_REG
mdefine_line|#define SET_CDC_DATA_REG(di,r)          ((di).b.ml = (u8) (r))
DECL|macro|SET_CDC_DATA_VAL
mdefine_line|#define SET_CDC_DATA_VAL(di,d)          ((di).b.ll = (u8) (d))
DECL|macro|SET_CDC_DATA_INIT
mdefine_line|#define SET_CDC_DATA_INIT(di)           ((di).l = 0L, SET_CDC_DATA_SEL(di,XX_CODEC_SELECTOR))
multiline_comment|/*&n; * set up codec register and write the value&n; * @codec: the codec id, 0 or 1&n; * @reg: register index&n; * @val: data value&n; */
DECL|function|vx_set_codec_reg
r_static
r_void
id|vx_set_codec_reg
c_func
(paren
id|vx_core_t
op_star
id|chip
comma
r_int
id|codec
comma
r_int
id|reg
comma
r_int
id|val
)paren
(brace
id|vx_codec_data_t
id|data
suffix:semicolon
multiline_comment|/* DAC control register */
id|SET_CDC_DATA_INIT
c_func
(paren
id|data
)paren
suffix:semicolon
id|SET_CDC_DATA_REG
c_func
(paren
id|data
comma
id|reg
)paren
suffix:semicolon
id|SET_CDC_DATA_VAL
c_func
(paren
id|data
comma
id|val
)paren
suffix:semicolon
id|vx_write_codec_reg
c_func
(paren
id|chip
comma
id|codec
comma
id|data.l
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * vx_set_analog_output_level - set the output attenuation level&n; * @codec: the output codec, 0 or 1.  (1 for VXP440 only)&n; * @left: left output level, 0 = mute&n; * @right: right output level&n; */
DECL|function|vx_set_analog_output_level
r_static
r_void
id|vx_set_analog_output_level
c_func
(paren
id|vx_core_t
op_star
id|chip
comma
r_int
id|codec
comma
r_int
id|left
comma
r_int
id|right
)paren
(brace
id|left
op_assign
id|chip-&gt;hw-&gt;output_level_max
op_minus
id|left
suffix:semicolon
id|right
op_assign
id|chip-&gt;hw-&gt;output_level_max
op_minus
id|right
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;ops-&gt;akm_write
)paren
(brace
id|chip-&gt;ops
op_member_access_from_pointer
id|akm_write
c_func
(paren
id|chip
comma
id|XX_CODEC_LEVEL_LEFT_REGISTER
comma
id|left
)paren
suffix:semicolon
id|chip-&gt;ops
op_member_access_from_pointer
id|akm_write
c_func
(paren
id|chip
comma
id|XX_CODEC_LEVEL_RIGHT_REGISTER
comma
id|right
)paren
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* convert to attenuation level: 0 = 0dB (max), 0xe3 = -113.5 dB (min) */
id|vx_set_codec_reg
c_func
(paren
id|chip
comma
id|codec
comma
id|XX_CODEC_LEVEL_LEFT_REGISTER
comma
id|left
)paren
suffix:semicolon
id|vx_set_codec_reg
c_func
(paren
id|chip
comma
id|codec
comma
id|XX_CODEC_LEVEL_RIGHT_REGISTER
comma
id|right
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/*&n; * vx_toggle_dac_mute -  mute/unmute DAC&n; * @mute: 0 = unmute, 1 = mute&n; */
DECL|macro|DAC_ATTEN_MIN
mdefine_line|#define DAC_ATTEN_MIN&t;0x08
DECL|macro|DAC_ATTEN_MAX
mdefine_line|#define DAC_ATTEN_MAX&t;0x38
DECL|function|vx_toggle_dac_mute
r_void
id|vx_toggle_dac_mute
c_func
(paren
id|vx_core_t
op_star
id|chip
comma
r_int
id|mute
)paren
(brace
r_int
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|chip-&gt;hw-&gt;num_codecs
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|chip-&gt;ops-&gt;akm_write
)paren
id|chip-&gt;ops
op_member_access_from_pointer
id|akm_write
c_func
(paren
id|chip
comma
id|XX_CODEC_DAC_CONTROL_REGISTER
comma
id|mute
)paren
suffix:semicolon
multiline_comment|/* XXX */
r_else
id|vx_set_codec_reg
c_func
(paren
id|chip
comma
id|i
comma
id|XX_CODEC_DAC_CONTROL_REGISTER
comma
id|mute
ques
c_cond
id|DAC_ATTEN_MAX
suffix:colon
id|DAC_ATTEN_MIN
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/*&n; * vx_reset_codec - reset and initialize the codecs&n; */
DECL|function|vx_reset_codec
r_void
id|vx_reset_codec
c_func
(paren
id|vx_core_t
op_star
id|chip
comma
r_int
id|cold_reset
)paren
(brace
r_int
r_int
id|i
suffix:semicolon
r_int
id|port
op_assign
id|chip-&gt;type
op_ge
id|VX_TYPE_VXPOCKET
ques
c_cond
l_int|0x75
suffix:colon
l_int|0x65
suffix:semicolon
id|chip-&gt;ops
op_member_access_from_pointer
id|reset_codec
c_func
(paren
id|chip
)paren
suffix:semicolon
multiline_comment|/* AKM codecs should be initialized in reset_codec callback */
r_if
c_cond
(paren
op_logical_neg
id|chip-&gt;ops-&gt;akm_write
)paren
(brace
multiline_comment|/* initialize old codecs */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|chip-&gt;hw-&gt;num_codecs
suffix:semicolon
id|i
op_increment
)paren
(brace
multiline_comment|/* DAC control register (change level when zero crossing + mute) */
id|vx_set_codec_reg
c_func
(paren
id|chip
comma
id|i
comma
id|XX_CODEC_DAC_CONTROL_REGISTER
comma
id|DAC_ATTEN_MAX
)paren
suffix:semicolon
multiline_comment|/* ADC control register */
id|vx_set_codec_reg
c_func
(paren
id|chip
comma
id|i
comma
id|XX_CODEC_ADC_CONTROL_REGISTER
comma
l_int|0x00
)paren
suffix:semicolon
multiline_comment|/* Port mode register */
id|vx_set_codec_reg
c_func
(paren
id|chip
comma
id|i
comma
id|XX_CODEC_PORT_MODE_REGISTER
comma
id|port
)paren
suffix:semicolon
multiline_comment|/* Clock control register */
id|vx_set_codec_reg
c_func
(paren
id|chip
comma
id|i
comma
id|XX_CODEC_CLOCK_CONTROL_REGISTER
comma
l_int|0x00
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/* mute analog output */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|chip-&gt;hw-&gt;num_codecs
suffix:semicolon
id|i
op_increment
)paren
(brace
id|chip-&gt;output_level
(braket
id|i
)braket
(braket
l_int|0
)braket
op_assign
l_int|0
suffix:semicolon
id|chip-&gt;output_level
(braket
id|i
)braket
(braket
l_int|1
)braket
op_assign
l_int|0
suffix:semicolon
id|vx_set_analog_output_level
c_func
(paren
id|chip
comma
id|i
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/*&n; * change the audio input source&n; * @src: the target source (VX_AUDIO_SRC_XXX)&n; */
DECL|function|vx_change_audio_source
r_static
r_void
id|vx_change_audio_source
c_func
(paren
id|vx_core_t
op_star
id|chip
comma
r_int
id|src
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;chip_status
op_amp
id|VX_STAT_IS_STALE
)paren
r_return
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|chip-&gt;ops
op_member_access_from_pointer
id|change_audio_source
c_func
(paren
id|chip
comma
id|src
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * change the audio source if necessary and possible&n; * returns 1 if the source is actually changed.&n; */
DECL|function|vx_sync_audio_source
r_int
id|vx_sync_audio_source
c_func
(paren
id|vx_core_t
op_star
id|chip
)paren
(brace
r_if
c_cond
(paren
id|chip-&gt;audio_source_target
op_eq
id|chip-&gt;audio_source
op_logical_or
id|chip-&gt;pcm_running
)paren
r_return
l_int|0
suffix:semicolon
id|vx_change_audio_source
c_func
(paren
id|chip
comma
id|chip-&gt;audio_source_target
)paren
suffix:semicolon
id|chip-&gt;audio_source
op_assign
id|chip-&gt;audio_source_target
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
multiline_comment|/*&n; * audio level, mute, monitoring&n; */
DECL|struct|vx_audio_level
r_struct
id|vx_audio_level
(brace
DECL|member|has_level
r_int
r_int
id|has_level
suffix:colon
l_int|1
suffix:semicolon
DECL|member|has_monitor_level
r_int
r_int
id|has_monitor_level
suffix:colon
l_int|1
suffix:semicolon
DECL|member|has_mute
r_int
r_int
id|has_mute
suffix:colon
l_int|1
suffix:semicolon
DECL|member|has_monitor_mute
r_int
r_int
id|has_monitor_mute
suffix:colon
l_int|1
suffix:semicolon
DECL|member|mute
r_int
r_int
id|mute
suffix:semicolon
DECL|member|monitor_mute
r_int
r_int
id|monitor_mute
suffix:semicolon
DECL|member|level
r_int
id|level
suffix:semicolon
DECL|member|monitor_level
r_int
id|monitor_level
suffix:semicolon
)brace
suffix:semicolon
DECL|function|vx_adjust_audio_level
r_static
r_int
id|vx_adjust_audio_level
c_func
(paren
id|vx_core_t
op_star
id|chip
comma
r_int
id|audio
comma
r_int
id|capture
comma
r_struct
id|vx_audio_level
op_star
id|info
)paren
(brace
r_struct
id|vx_rmh
id|rmh
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;chip_status
op_amp
id|VX_STAT_IS_STALE
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
id|vx_init_rmh
c_func
(paren
op_amp
id|rmh
comma
id|CMD_AUDIO_LEVEL_ADJUST
)paren
suffix:semicolon
r_if
c_cond
(paren
id|capture
)paren
id|rmh.Cmd
(braket
l_int|0
)braket
op_or_assign
id|COMMAND_RECORD_MASK
suffix:semicolon
multiline_comment|/* Add Audio IO mask */
id|rmh.Cmd
(braket
l_int|1
)braket
op_assign
l_int|1
op_lshift
id|audio
suffix:semicolon
id|rmh.Cmd
(braket
l_int|2
)braket
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|info-&gt;has_level
)paren
(brace
id|rmh.Cmd
(braket
l_int|0
)braket
op_or_assign
id|VALID_AUDIO_IO_DIGITAL_LEVEL
suffix:semicolon
id|rmh.Cmd
(braket
l_int|2
)braket
op_or_assign
id|info-&gt;level
suffix:semicolon
)brace
r_if
c_cond
(paren
id|info-&gt;has_monitor_level
)paren
(brace
id|rmh.Cmd
(braket
l_int|0
)braket
op_or_assign
id|VALID_AUDIO_IO_MONITORING_LEVEL
suffix:semicolon
id|rmh.Cmd
(braket
l_int|2
)braket
op_or_assign
(paren
(paren
r_int
r_int
)paren
id|info-&gt;monitor_level
op_lshift
l_int|10
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|info-&gt;has_mute
)paren
(brace
id|rmh.Cmd
(braket
l_int|0
)braket
op_or_assign
id|VALID_AUDIO_IO_MUTE_LEVEL
suffix:semicolon
r_if
c_cond
(paren
id|info-&gt;mute
)paren
id|rmh.Cmd
(braket
l_int|2
)braket
op_or_assign
id|AUDIO_IO_HAS_MUTE_LEVEL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|info-&gt;has_monitor_mute
)paren
(brace
multiline_comment|/* validate flag for M2 at least to unmute it */
id|rmh.Cmd
(braket
l_int|0
)braket
op_or_assign
id|VALID_AUDIO_IO_MUTE_MONITORING_1
op_or
id|VALID_AUDIO_IO_MUTE_MONITORING_2
suffix:semicolon
r_if
c_cond
(paren
id|info-&gt;monitor_mute
)paren
id|rmh.Cmd
(braket
l_int|2
)braket
op_or_assign
id|AUDIO_IO_HAS_MUTE_MONITORING_1
suffix:semicolon
)brace
r_return
id|vx_send_msg
c_func
(paren
id|chip
comma
op_amp
id|rmh
)paren
suffix:semicolon
)brace
macro_line|#if 0 
singleline_comment|// not used
r_static
r_int
id|vx_read_audio_level
c_func
(paren
id|vx_core_t
op_star
id|chip
comma
r_int
id|audio
comma
r_int
id|capture
comma
r_struct
id|vx_audio_level
op_star
id|info
)paren
(brace
r_int
id|err
suffix:semicolon
r_struct
id|vx_rmh
id|rmh
suffix:semicolon
id|memset
c_func
(paren
id|info
comma
l_int|0
comma
r_sizeof
(paren
op_star
id|info
)paren
)paren
suffix:semicolon
id|vx_init_rmh
c_func
(paren
op_amp
id|rmh
comma
id|CMD_GET_AUDIO_LEVELS
)paren
suffix:semicolon
r_if
c_cond
(paren
id|capture
)paren
id|rmh.Cmd
(braket
l_int|0
)braket
op_or_assign
id|COMMAND_RECORD_MASK
suffix:semicolon
multiline_comment|/* Add Audio IO mask */
id|rmh.Cmd
(braket
l_int|1
)braket
op_assign
l_int|1
op_lshift
id|audio
suffix:semicolon
id|err
op_assign
id|vx_send_msg
c_func
(paren
id|chip
comma
op_amp
id|rmh
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|info.level
op_assign
id|rmh.Stat
(braket
l_int|0
)braket
op_amp
id|MASK_DSP_WORD_LEVEL
suffix:semicolon
id|info.monitor_level
op_assign
(paren
id|rmh.Stat
(braket
l_int|0
)braket
op_rshift
l_int|10
)paren
op_amp
id|MASK_DSP_WORD_LEVEL
suffix:semicolon
id|info.mute
op_assign
(paren
id|rmh.Stat
(braket
id|i
)braket
op_amp
id|AUDIO_IO_HAS_MUTE_LEVEL
)paren
ques
c_cond
l_int|1
suffix:colon
l_int|0
suffix:semicolon
id|info.monitor_mute
op_assign
(paren
id|rmh.Stat
(braket
id|i
)braket
op_amp
id|AUDIO_IO_HAS_MUTE_MONITORING_1
)paren
ques
c_cond
l_int|1
suffix:colon
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#endif 
singleline_comment|// not used
multiline_comment|/*&n; * set the monitoring level and mute state of the given audio&n; * no more static, because must be called from vx_pcm to demute monitoring&n; */
DECL|function|vx_set_monitor_level
r_int
id|vx_set_monitor_level
c_func
(paren
id|vx_core_t
op_star
id|chip
comma
r_int
id|audio
comma
r_int
id|level
comma
r_int
id|active
)paren
(brace
r_struct
id|vx_audio_level
id|info
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|info
comma
l_int|0
comma
r_sizeof
(paren
id|info
)paren
)paren
suffix:semicolon
id|info.has_monitor_level
op_assign
l_int|1
suffix:semicolon
id|info.monitor_level
op_assign
id|level
suffix:semicolon
id|info.has_monitor_mute
op_assign
l_int|1
suffix:semicolon
id|info.monitor_mute
op_assign
op_logical_neg
id|active
suffix:semicolon
id|chip-&gt;audio_monitor
(braket
id|audio
)braket
op_assign
id|level
suffix:semicolon
id|chip-&gt;audio_monitor_active
(braket
id|audio
)braket
op_assign
id|active
suffix:semicolon
r_return
id|vx_adjust_audio_level
c_func
(paren
id|chip
comma
id|audio
comma
l_int|0
comma
op_amp
id|info
)paren
suffix:semicolon
multiline_comment|/* playback only */
)brace
multiline_comment|/*&n; * set the mute status of the given audio&n; */
DECL|function|vx_set_audio_switch
r_static
r_int
id|vx_set_audio_switch
c_func
(paren
id|vx_core_t
op_star
id|chip
comma
r_int
id|audio
comma
r_int
id|active
)paren
(brace
r_struct
id|vx_audio_level
id|info
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|info
comma
l_int|0
comma
r_sizeof
(paren
id|info
)paren
)paren
suffix:semicolon
id|info.has_mute
op_assign
l_int|1
suffix:semicolon
id|info.mute
op_assign
op_logical_neg
id|active
suffix:semicolon
id|chip-&gt;audio_active
(braket
id|audio
)braket
op_assign
id|active
suffix:semicolon
r_return
id|vx_adjust_audio_level
c_func
(paren
id|chip
comma
id|audio
comma
l_int|0
comma
op_amp
id|info
)paren
suffix:semicolon
multiline_comment|/* playback only */
)brace
multiline_comment|/*&n; * set the mute status of the given audio&n; */
DECL|function|vx_set_audio_gain
r_static
r_int
id|vx_set_audio_gain
c_func
(paren
id|vx_core_t
op_star
id|chip
comma
r_int
id|audio
comma
r_int
id|capture
comma
r_int
id|level
)paren
(brace
r_struct
id|vx_audio_level
id|info
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|info
comma
l_int|0
comma
r_sizeof
(paren
id|info
)paren
)paren
suffix:semicolon
id|info.has_level
op_assign
l_int|1
suffix:semicolon
id|info.level
op_assign
id|level
suffix:semicolon
id|chip-&gt;audio_gain
(braket
id|capture
)braket
(braket
id|audio
)braket
op_assign
id|level
suffix:semicolon
r_return
id|vx_adjust_audio_level
c_func
(paren
id|chip
comma
id|audio
comma
id|capture
comma
op_amp
id|info
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * reset all audio levels&n; */
DECL|function|vx_reset_audio_levels
r_static
r_void
id|vx_reset_audio_levels
c_func
(paren
id|vx_core_t
op_star
id|chip
)paren
(brace
r_int
r_int
id|i
comma
id|c
suffix:semicolon
r_struct
id|vx_audio_level
id|info
suffix:semicolon
id|memset
c_func
(paren
id|chip-&gt;audio_gain
comma
l_int|0
comma
r_sizeof
(paren
id|chip-&gt;audio_gain
)paren
)paren
suffix:semicolon
id|memset
c_func
(paren
id|chip-&gt;audio_active
comma
l_int|0
comma
r_sizeof
(paren
id|chip-&gt;audio_active
)paren
)paren
suffix:semicolon
id|memset
c_func
(paren
id|chip-&gt;audio_monitor
comma
l_int|0
comma
r_sizeof
(paren
id|chip-&gt;audio_monitor
)paren
)paren
suffix:semicolon
id|memset
c_func
(paren
id|chip-&gt;audio_monitor_active
comma
l_int|0
comma
r_sizeof
(paren
id|chip-&gt;audio_monitor_active
)paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|c
op_assign
l_int|0
suffix:semicolon
id|c
OL
l_int|2
suffix:semicolon
id|c
op_increment
)paren
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|chip-&gt;hw-&gt;num_ins
op_star
l_int|2
suffix:semicolon
id|i
op_increment
)paren
(brace
id|memset
c_func
(paren
op_amp
id|info
comma
l_int|0
comma
r_sizeof
(paren
id|info
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|c
op_eq
l_int|0
)paren
(brace
id|info.has_monitor_level
op_assign
l_int|1
suffix:semicolon
id|info.has_mute
op_assign
l_int|1
suffix:semicolon
id|info.has_monitor_mute
op_assign
l_int|1
suffix:semicolon
)brace
id|info.has_level
op_assign
l_int|1
suffix:semicolon
id|info.level
op_assign
id|CVAL_0DB
suffix:semicolon
multiline_comment|/* default: 0dB */
id|vx_adjust_audio_level
c_func
(paren
id|chip
comma
id|i
comma
id|c
comma
op_amp
id|info
)paren
suffix:semicolon
id|chip-&gt;audio_gain
(braket
id|c
)braket
(braket
id|i
)braket
op_assign
id|CVAL_0DB
suffix:semicolon
id|chip-&gt;audio_monitor
(braket
id|i
)braket
op_assign
id|CVAL_0DB
suffix:semicolon
)brace
)brace
)brace
multiline_comment|/*&n; * VU, peak meter record&n; */
DECL|macro|VU_METER_CHANNELS
mdefine_line|#define VU_METER_CHANNELS&t;2
DECL|struct|vx_vu_meter
r_struct
id|vx_vu_meter
(brace
DECL|member|saturated
r_int
id|saturated
suffix:semicolon
DECL|member|vu_level
r_int
id|vu_level
suffix:semicolon
DECL|member|peak_level
r_int
id|peak_level
suffix:semicolon
)brace
suffix:semicolon
multiline_comment|/*&n; * get the VU and peak meter values&n; * @audio: the audio index&n; * @capture: 0 = playback, 1 = capture operation&n; * @info: the array of vx_vu_meter records (size = 2).&n; */
DECL|function|vx_get_audio_vu_meter
r_static
r_int
id|vx_get_audio_vu_meter
c_func
(paren
id|vx_core_t
op_star
id|chip
comma
r_int
id|audio
comma
r_int
id|capture
comma
r_struct
id|vx_vu_meter
op_star
id|info
)paren
(brace
r_struct
id|vx_rmh
id|rmh
suffix:semicolon
r_int
id|i
comma
id|err
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;chip_status
op_amp
id|VX_STAT_IS_STALE
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
id|vx_init_rmh
c_func
(paren
op_amp
id|rmh
comma
id|CMD_AUDIO_VU_PIC_METER
)paren
suffix:semicolon
id|rmh.LgStat
op_add_assign
l_int|2
op_star
id|VU_METER_CHANNELS
suffix:semicolon
r_if
c_cond
(paren
id|capture
)paren
id|rmh.Cmd
(braket
l_int|0
)braket
op_or_assign
id|COMMAND_RECORD_MASK
suffix:semicolon
multiline_comment|/* Add Audio IO mask */
id|rmh.Cmd
(braket
l_int|1
)braket
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|VU_METER_CHANNELS
suffix:semicolon
id|i
op_increment
)paren
id|rmh.Cmd
(braket
l_int|1
)braket
op_or_assign
l_int|1
op_lshift
(paren
id|audio
op_plus
id|i
)paren
suffix:semicolon
id|err
op_assign
id|vx_send_msg
c_func
(paren
id|chip
comma
op_amp
id|rmh
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
multiline_comment|/* Read response */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|2
op_star
id|VU_METER_CHANNELS
suffix:semicolon
id|i
op_add_assign
l_int|2
)paren
(brace
id|info-&gt;saturated
op_assign
(paren
id|rmh.Stat
(braket
l_int|0
)braket
op_amp
(paren
l_int|1
op_lshift
(paren
id|audio
op_plus
id|i
)paren
)paren
)paren
ques
c_cond
l_int|1
suffix:colon
l_int|0
suffix:semicolon
id|info-&gt;vu_level
op_assign
id|rmh.Stat
(braket
id|i
op_plus
l_int|1
)braket
suffix:semicolon
id|info-&gt;peak_level
op_assign
id|rmh.Stat
(braket
id|i
op_plus
l_int|2
)braket
suffix:semicolon
id|info
op_increment
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * control API entries&n; */
multiline_comment|/*&n; * output level control&n; */
DECL|function|vx_output_level_info
r_static
r_int
id|vx_output_level_info
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|vx_core_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_INTEGER
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|2
suffix:semicolon
id|uinfo-&gt;value.integer.min
op_assign
l_int|0
suffix:semicolon
id|uinfo-&gt;value.integer.max
op_assign
id|chip-&gt;hw-&gt;output_level_max
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|vx_output_level_get
r_static
r_int
id|vx_output_level_get
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|vx_core_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|codec
op_assign
id|kcontrol-&gt;id.index
suffix:semicolon
id|down
c_func
(paren
op_amp
id|chip-&gt;mixer_mutex
)paren
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
id|chip-&gt;output_level
(braket
id|codec
)braket
(braket
l_int|0
)braket
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|1
)braket
op_assign
id|chip-&gt;output_level
(braket
id|codec
)braket
(braket
l_int|1
)braket
suffix:semicolon
id|up
c_func
(paren
op_amp
id|chip-&gt;mixer_mutex
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|vx_output_level_put
r_static
r_int
id|vx_output_level_put
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|vx_core_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|codec
op_assign
id|kcontrol-&gt;id.index
suffix:semicolon
id|down
c_func
(paren
op_amp
id|chip-&gt;mixer_mutex
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_ne
id|chip-&gt;output_level
(braket
id|codec
)braket
(braket
l_int|0
)braket
op_logical_or
id|ucontrol-&gt;value.integer.value
(braket
l_int|1
)braket
op_ne
id|chip-&gt;output_level
(braket
id|codec
)braket
(braket
l_int|1
)braket
)paren
(brace
id|vx_set_analog_output_level
c_func
(paren
id|chip
comma
id|codec
comma
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
comma
id|ucontrol-&gt;value.integer.value
(braket
l_int|1
)braket
)paren
suffix:semicolon
id|chip-&gt;output_level
(braket
id|codec
)braket
(braket
l_int|0
)braket
op_assign
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
suffix:semicolon
id|chip-&gt;output_level
(braket
id|codec
)braket
(braket
l_int|1
)braket
op_assign
id|ucontrol-&gt;value.integer.value
(braket
l_int|1
)braket
suffix:semicolon
id|up
c_func
(paren
op_amp
id|chip-&gt;mixer_mutex
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
id|up
c_func
(paren
op_amp
id|chip-&gt;mixer_mutex
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|vx_control_output_level
r_static
id|snd_kcontrol_new_t
id|vx_control_output_level
op_assign
(brace
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_MIXER
comma
dot
id|name
op_assign
l_string|&quot;Master Playback Volume&quot;
comma
dot
id|info
op_assign
id|vx_output_level_info
comma
dot
id|get
op_assign
id|vx_output_level_get
comma
dot
id|put
op_assign
id|vx_output_level_put
comma
)brace
suffix:semicolon
multiline_comment|/*&n; * audio source select&n; */
DECL|function|vx_audio_src_info
r_static
r_int
id|vx_audio_src_info
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
r_static
r_char
op_star
id|texts_mic
(braket
l_int|3
)braket
op_assign
(brace
l_string|&quot;Digital&quot;
comma
l_string|&quot;Line&quot;
comma
l_string|&quot;Mic&quot;
)brace
suffix:semicolon
r_static
r_char
op_star
id|texts_vx2
(braket
l_int|2
)braket
op_assign
(brace
l_string|&quot;Digital&quot;
comma
l_string|&quot;Analog&quot;
)brace
suffix:semicolon
id|vx_core_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_ENUMERATED
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;type
op_ge
id|VX_TYPE_VXPOCKET
)paren
(brace
id|uinfo-&gt;value.enumerated.items
op_assign
l_int|3
suffix:semicolon
r_if
c_cond
(paren
id|uinfo-&gt;value.enumerated.item
OG
l_int|2
)paren
id|uinfo-&gt;value.enumerated.item
op_assign
l_int|2
suffix:semicolon
id|strcpy
c_func
(paren
id|uinfo-&gt;value.enumerated.name
comma
id|texts_mic
(braket
id|uinfo-&gt;value.enumerated.item
)braket
)paren
suffix:semicolon
)brace
r_else
(brace
id|uinfo-&gt;value.enumerated.items
op_assign
l_int|2
suffix:semicolon
r_if
c_cond
(paren
id|uinfo-&gt;value.enumerated.item
OG
l_int|1
)paren
id|uinfo-&gt;value.enumerated.item
op_assign
l_int|1
suffix:semicolon
id|strcpy
c_func
(paren
id|uinfo-&gt;value.enumerated.name
comma
id|texts_vx2
(braket
id|uinfo-&gt;value.enumerated.item
)braket
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|vx_audio_src_get
r_static
r_int
id|vx_audio_src_get
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|vx_core_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
id|chip-&gt;audio_source_target
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|vx_audio_src_put
r_static
r_int
id|vx_audio_src_put
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|vx_core_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|down
c_func
(paren
op_amp
id|chip-&gt;mixer_mutex
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;audio_source_target
op_ne
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
)paren
(brace
id|chip-&gt;audio_source_target
op_assign
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
suffix:semicolon
id|vx_sync_audio_source
c_func
(paren
id|chip
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|chip-&gt;mixer_mutex
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
id|up
c_func
(paren
op_amp
id|chip-&gt;mixer_mutex
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|vx_control_audio_src
r_static
id|snd_kcontrol_new_t
id|vx_control_audio_src
op_assign
(brace
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_MIXER
comma
dot
id|name
op_assign
l_string|&quot;Capture Source&quot;
comma
dot
id|info
op_assign
id|vx_audio_src_info
comma
dot
id|get
op_assign
id|vx_audio_src_get
comma
dot
id|put
op_assign
id|vx_audio_src_put
comma
)brace
suffix:semicolon
multiline_comment|/*&n; * clock mode selection&n; */
DECL|function|vx_clock_mode_info
r_static
r_int
id|vx_clock_mode_info
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
r_static
r_char
op_star
id|texts
(braket
l_int|3
)braket
op_assign
(brace
l_string|&quot;Auto&quot;
comma
l_string|&quot;Internal&quot;
comma
l_string|&quot;External&quot;
)brace
suffix:semicolon
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_ENUMERATED
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
id|uinfo-&gt;value.enumerated.items
op_assign
l_int|3
suffix:semicolon
r_if
c_cond
(paren
id|uinfo-&gt;value.enumerated.item
OG
l_int|2
)paren
id|uinfo-&gt;value.enumerated.item
op_assign
l_int|2
suffix:semicolon
id|strcpy
c_func
(paren
id|uinfo-&gt;value.enumerated.name
comma
id|texts
(braket
id|uinfo-&gt;value.enumerated.item
)braket
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|vx_clock_mode_get
r_static
r_int
id|vx_clock_mode_get
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|vx_core_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
id|chip-&gt;clock_mode
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|vx_clock_mode_put
r_static
r_int
id|vx_clock_mode_put
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|vx_core_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|down
c_func
(paren
op_amp
id|chip-&gt;mixer_mutex
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;clock_mode
op_ne
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
)paren
(brace
id|chip-&gt;clock_mode
op_assign
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
suffix:semicolon
id|vx_set_clock
c_func
(paren
id|chip
comma
id|chip-&gt;freq
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|chip-&gt;mixer_mutex
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
id|up
c_func
(paren
op_amp
id|chip-&gt;mixer_mutex
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|vx_control_clock_mode
r_static
id|snd_kcontrol_new_t
id|vx_control_clock_mode
op_assign
(brace
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_MIXER
comma
dot
id|name
op_assign
l_string|&quot;Clock Mode&quot;
comma
dot
id|info
op_assign
id|vx_clock_mode_info
comma
dot
id|get
op_assign
id|vx_clock_mode_get
comma
dot
id|put
op_assign
id|vx_clock_mode_put
comma
)brace
suffix:semicolon
multiline_comment|/*&n; * Audio Gain&n; */
DECL|function|vx_audio_gain_info
r_static
r_int
id|vx_audio_gain_info
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_INTEGER
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|2
suffix:semicolon
id|uinfo-&gt;value.integer.min
op_assign
l_int|0
suffix:semicolon
id|uinfo-&gt;value.integer.max
op_assign
id|CVAL_MAX
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|vx_audio_gain_get
r_static
r_int
id|vx_audio_gain_get
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|vx_core_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|audio
op_assign
id|kcontrol-&gt;private_value
op_amp
l_int|0xff
suffix:semicolon
r_int
id|capture
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|8
)paren
op_amp
l_int|1
suffix:semicolon
id|down
c_func
(paren
op_amp
id|chip-&gt;mixer_mutex
)paren
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
id|chip-&gt;audio_gain
(braket
id|capture
)braket
(braket
id|audio
)braket
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|1
)braket
op_assign
id|chip-&gt;audio_gain
(braket
id|capture
)braket
(braket
id|audio
op_plus
l_int|1
)braket
suffix:semicolon
id|up
c_func
(paren
op_amp
id|chip-&gt;mixer_mutex
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|vx_audio_gain_put
r_static
r_int
id|vx_audio_gain_put
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|vx_core_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|audio
op_assign
id|kcontrol-&gt;private_value
op_amp
l_int|0xff
suffix:semicolon
r_int
id|capture
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|8
)paren
op_amp
l_int|1
suffix:semicolon
id|down
c_func
(paren
op_amp
id|chip-&gt;mixer_mutex
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_ne
id|chip-&gt;audio_gain
(braket
id|capture
)braket
(braket
id|audio
)braket
op_logical_or
id|ucontrol-&gt;value.integer.value
(braket
l_int|1
)braket
op_ne
id|chip-&gt;audio_gain
(braket
id|capture
)braket
(braket
id|audio
op_plus
l_int|1
)braket
)paren
(brace
id|vx_set_audio_gain
c_func
(paren
id|chip
comma
id|audio
comma
id|capture
comma
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
)paren
suffix:semicolon
id|vx_set_audio_gain
c_func
(paren
id|chip
comma
id|audio
op_plus
l_int|1
comma
id|capture
comma
id|ucontrol-&gt;value.integer.value
(braket
l_int|1
)braket
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|chip-&gt;mixer_mutex
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
id|up
c_func
(paren
op_amp
id|chip-&gt;mixer_mutex
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|vx_audio_monitor_get
r_static
r_int
id|vx_audio_monitor_get
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|vx_core_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|audio
op_assign
id|kcontrol-&gt;private_value
op_amp
l_int|0xff
suffix:semicolon
id|down
c_func
(paren
op_amp
id|chip-&gt;mixer_mutex
)paren
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
id|chip-&gt;audio_monitor
(braket
id|audio
)braket
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|1
)braket
op_assign
id|chip-&gt;audio_monitor
(braket
id|audio
op_plus
l_int|1
)braket
suffix:semicolon
id|up
c_func
(paren
op_amp
id|chip-&gt;mixer_mutex
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|vx_audio_monitor_put
r_static
r_int
id|vx_audio_monitor_put
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|vx_core_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|audio
op_assign
id|kcontrol-&gt;private_value
op_amp
l_int|0xff
suffix:semicolon
id|down
c_func
(paren
op_amp
id|chip-&gt;mixer_mutex
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_ne
id|chip-&gt;audio_monitor
(braket
id|audio
)braket
op_logical_or
id|ucontrol-&gt;value.integer.value
(braket
l_int|1
)braket
op_ne
id|chip-&gt;audio_monitor
(braket
id|audio
op_plus
l_int|1
)braket
)paren
(brace
id|vx_set_monitor_level
c_func
(paren
id|chip
comma
id|audio
comma
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
comma
id|chip-&gt;audio_monitor_active
(braket
id|audio
)braket
)paren
suffix:semicolon
id|vx_set_monitor_level
c_func
(paren
id|chip
comma
id|audio
op_plus
l_int|1
comma
id|ucontrol-&gt;value.integer.value
(braket
l_int|1
)braket
comma
id|chip-&gt;audio_monitor_active
(braket
id|audio
op_plus
l_int|1
)braket
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|chip-&gt;mixer_mutex
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
id|up
c_func
(paren
op_amp
id|chip-&gt;mixer_mutex
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|vx_audio_sw_info
r_static
r_int
id|vx_audio_sw_info
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_BOOLEAN
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|2
suffix:semicolon
id|uinfo-&gt;value.integer.min
op_assign
l_int|0
suffix:semicolon
id|uinfo-&gt;value.integer.max
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|vx_audio_sw_get
r_static
r_int
id|vx_audio_sw_get
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|vx_core_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|audio
op_assign
id|kcontrol-&gt;private_value
op_amp
l_int|0xff
suffix:semicolon
id|down
c_func
(paren
op_amp
id|chip-&gt;mixer_mutex
)paren
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
id|chip-&gt;audio_active
(braket
id|audio
)braket
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|1
)braket
op_assign
id|chip-&gt;audio_active
(braket
id|audio
op_plus
l_int|1
)braket
suffix:semicolon
id|up
c_func
(paren
op_amp
id|chip-&gt;mixer_mutex
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|vx_audio_sw_put
r_static
r_int
id|vx_audio_sw_put
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|vx_core_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|audio
op_assign
id|kcontrol-&gt;private_value
op_amp
l_int|0xff
suffix:semicolon
id|down
c_func
(paren
op_amp
id|chip-&gt;mixer_mutex
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_ne
id|chip-&gt;audio_active
(braket
id|audio
)braket
op_logical_or
id|ucontrol-&gt;value.integer.value
(braket
l_int|1
)braket
op_ne
id|chip-&gt;audio_active
(braket
id|audio
op_plus
l_int|1
)braket
)paren
(brace
id|vx_set_audio_switch
c_func
(paren
id|chip
comma
id|audio
comma
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
)paren
suffix:semicolon
id|vx_set_audio_switch
c_func
(paren
id|chip
comma
id|audio
op_plus
l_int|1
comma
id|ucontrol-&gt;value.integer.value
(braket
l_int|1
)braket
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|chip-&gt;mixer_mutex
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
id|up
c_func
(paren
op_amp
id|chip-&gt;mixer_mutex
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|vx_monitor_sw_get
r_static
r_int
id|vx_monitor_sw_get
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|vx_core_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|audio
op_assign
id|kcontrol-&gt;private_value
op_amp
l_int|0xff
suffix:semicolon
id|down
c_func
(paren
op_amp
id|chip-&gt;mixer_mutex
)paren
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
id|chip-&gt;audio_monitor_active
(braket
id|audio
)braket
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|1
)braket
op_assign
id|chip-&gt;audio_monitor_active
(braket
id|audio
op_plus
l_int|1
)braket
suffix:semicolon
id|up
c_func
(paren
op_amp
id|chip-&gt;mixer_mutex
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|vx_monitor_sw_put
r_static
r_int
id|vx_monitor_sw_put
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|vx_core_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|audio
op_assign
id|kcontrol-&gt;private_value
op_amp
l_int|0xff
suffix:semicolon
id|down
c_func
(paren
op_amp
id|chip-&gt;mixer_mutex
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_ne
id|chip-&gt;audio_monitor_active
(braket
id|audio
)braket
op_logical_or
id|ucontrol-&gt;value.integer.value
(braket
l_int|1
)braket
op_ne
id|chip-&gt;audio_monitor_active
(braket
id|audio
op_plus
l_int|1
)braket
)paren
(brace
id|vx_set_monitor_level
c_func
(paren
id|chip
comma
id|audio
comma
id|chip-&gt;audio_monitor
(braket
id|audio
)braket
comma
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
)paren
suffix:semicolon
id|vx_set_monitor_level
c_func
(paren
id|chip
comma
id|audio
op_plus
l_int|1
comma
id|chip-&gt;audio_monitor
(braket
id|audio
op_plus
l_int|1
)braket
comma
id|ucontrol-&gt;value.integer.value
(braket
l_int|1
)braket
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|chip-&gt;mixer_mutex
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
id|up
c_func
(paren
op_amp
id|chip-&gt;mixer_mutex
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|vx_control_audio_gain
r_static
id|snd_kcontrol_new_t
id|vx_control_audio_gain
op_assign
(brace
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_MIXER
comma
multiline_comment|/* name will be filled later */
dot
id|info
op_assign
id|vx_audio_gain_info
comma
dot
id|get
op_assign
id|vx_audio_gain_get
comma
dot
id|put
op_assign
id|vx_audio_gain_put
)brace
suffix:semicolon
DECL|variable|vx_control_output_switch
r_static
id|snd_kcontrol_new_t
id|vx_control_output_switch
op_assign
(brace
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_MIXER
comma
dot
id|name
op_assign
l_string|&quot;PCM Playback Switch&quot;
comma
dot
id|info
op_assign
id|vx_audio_sw_info
comma
dot
id|get
op_assign
id|vx_audio_sw_get
comma
dot
id|put
op_assign
id|vx_audio_sw_put
)brace
suffix:semicolon
DECL|variable|vx_control_monitor_gain
r_static
id|snd_kcontrol_new_t
id|vx_control_monitor_gain
op_assign
(brace
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_MIXER
comma
dot
id|name
op_assign
l_string|&quot;Monitoring Volume&quot;
comma
dot
id|info
op_assign
id|vx_audio_gain_info
comma
multiline_comment|/* shared */
dot
id|get
op_assign
id|vx_audio_monitor_get
comma
dot
id|put
op_assign
id|vx_audio_monitor_put
)brace
suffix:semicolon
DECL|variable|vx_control_monitor_switch
r_static
id|snd_kcontrol_new_t
id|vx_control_monitor_switch
op_assign
(brace
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_MIXER
comma
dot
id|name
op_assign
l_string|&quot;Monitoring Switch&quot;
comma
dot
id|info
op_assign
id|vx_audio_sw_info
comma
multiline_comment|/* shared */
dot
id|get
op_assign
id|vx_monitor_sw_get
comma
dot
id|put
op_assign
id|vx_monitor_sw_put
)brace
suffix:semicolon
multiline_comment|/*&n; * IEC958 status bits&n; */
DECL|function|vx_iec958_info
r_static
r_int
id|vx_iec958_info
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_IEC958
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|vx_iec958_get
r_static
r_int
id|vx_iec958_get
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|vx_core_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|down
c_func
(paren
op_amp
id|chip-&gt;mixer_mutex
)paren
suffix:semicolon
id|ucontrol-&gt;value.iec958.status
(braket
l_int|0
)braket
op_assign
(paren
id|chip-&gt;uer_bits
op_rshift
l_int|0
)paren
op_amp
l_int|0xff
suffix:semicolon
id|ucontrol-&gt;value.iec958.status
(braket
l_int|1
)braket
op_assign
(paren
id|chip-&gt;uer_bits
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
suffix:semicolon
id|ucontrol-&gt;value.iec958.status
(braket
l_int|2
)braket
op_assign
(paren
id|chip-&gt;uer_bits
op_rshift
l_int|16
)paren
op_amp
l_int|0xff
suffix:semicolon
id|ucontrol-&gt;value.iec958.status
(braket
l_int|3
)braket
op_assign
(paren
id|chip-&gt;uer_bits
op_rshift
l_int|24
)paren
op_amp
l_int|0xff
suffix:semicolon
id|up
c_func
(paren
op_amp
id|chip-&gt;mixer_mutex
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|vx_iec958_mask_get
r_static
r_int
id|vx_iec958_mask_get
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|ucontrol-&gt;value.iec958.status
(braket
l_int|0
)braket
op_assign
l_int|0xff
suffix:semicolon
id|ucontrol-&gt;value.iec958.status
(braket
l_int|1
)braket
op_assign
l_int|0xff
suffix:semicolon
id|ucontrol-&gt;value.iec958.status
(braket
l_int|2
)braket
op_assign
l_int|0xff
suffix:semicolon
id|ucontrol-&gt;value.iec958.status
(braket
l_int|3
)braket
op_assign
l_int|0xff
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|vx_iec958_put
r_static
r_int
id|vx_iec958_put
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|vx_core_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_int
id|val
suffix:semicolon
id|val
op_assign
(paren
id|ucontrol-&gt;value.iec958.status
(braket
l_int|0
)braket
op_lshift
l_int|0
)paren
op_or
(paren
id|ucontrol-&gt;value.iec958.status
(braket
l_int|1
)braket
op_lshift
l_int|8
)paren
op_or
(paren
id|ucontrol-&gt;value.iec958.status
(braket
l_int|2
)braket
op_lshift
l_int|16
)paren
op_or
(paren
id|ucontrol-&gt;value.iec958.status
(braket
l_int|3
)braket
op_lshift
l_int|24
)paren
suffix:semicolon
id|down
c_func
(paren
op_amp
id|chip-&gt;mixer_mutex
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;uer_bits
op_ne
id|val
)paren
(brace
id|chip-&gt;uer_bits
op_assign
id|val
suffix:semicolon
id|vx_set_iec958_status
c_func
(paren
id|chip
comma
id|val
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|chip-&gt;mixer_mutex
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
id|up
c_func
(paren
op_amp
id|chip-&gt;mixer_mutex
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|vx_control_iec958_mask
r_static
id|snd_kcontrol_new_t
id|vx_control_iec958_mask
op_assign
(brace
dot
id|access
op_assign
id|SNDRV_CTL_ELEM_ACCESS_READ
comma
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_MIXER
comma
dot
id|name
op_assign
id|SNDRV_CTL_NAME_IEC958
c_func
(paren
l_string|&quot;&quot;
comma
id|PLAYBACK
comma
id|MASK
)paren
comma
dot
id|info
op_assign
id|vx_iec958_info
comma
multiline_comment|/* shared */
dot
id|get
op_assign
id|vx_iec958_mask_get
comma
)brace
suffix:semicolon
DECL|variable|vx_control_iec958
r_static
id|snd_kcontrol_new_t
id|vx_control_iec958
op_assign
(brace
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_MIXER
comma
dot
id|name
op_assign
id|SNDRV_CTL_NAME_IEC958
c_func
(paren
l_string|&quot;&quot;
comma
id|PLAYBACK
comma
id|DEFAULT
)paren
comma
dot
id|info
op_assign
id|vx_iec958_info
comma
dot
id|get
op_assign
id|vx_iec958_get
comma
dot
id|put
op_assign
id|vx_iec958_put
)brace
suffix:semicolon
multiline_comment|/*&n; * VU meter&n; */
DECL|macro|METER_MAX
mdefine_line|#define METER_MAX&t;0xff
DECL|macro|METER_SHIFT
mdefine_line|#define METER_SHIFT&t;16
DECL|function|vx_vu_meter_info
r_static
r_int
id|vx_vu_meter_info
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_INTEGER
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|2
suffix:semicolon
id|uinfo-&gt;value.integer.min
op_assign
l_int|0
suffix:semicolon
id|uinfo-&gt;value.integer.max
op_assign
id|METER_MAX
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|vx_vu_meter_get
r_static
r_int
id|vx_vu_meter_get
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|vx_core_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_struct
id|vx_vu_meter
id|meter
(braket
l_int|2
)braket
suffix:semicolon
r_int
id|audio
op_assign
id|kcontrol-&gt;private_value
op_amp
l_int|0xff
suffix:semicolon
r_int
id|capture
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|8
)paren
op_amp
l_int|1
suffix:semicolon
id|vx_get_audio_vu_meter
c_func
(paren
id|chip
comma
id|audio
comma
id|capture
comma
id|meter
)paren
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
id|meter
(braket
l_int|0
)braket
dot
id|vu_level
op_rshift
id|METER_SHIFT
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|1
)braket
op_assign
id|meter
(braket
l_int|1
)braket
dot
id|vu_level
op_rshift
id|METER_SHIFT
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|vx_peak_meter_get
r_static
r_int
id|vx_peak_meter_get
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|vx_core_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_struct
id|vx_vu_meter
id|meter
(braket
l_int|2
)braket
suffix:semicolon
r_int
id|audio
op_assign
id|kcontrol-&gt;private_value
op_amp
l_int|0xff
suffix:semicolon
r_int
id|capture
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|8
)paren
op_amp
l_int|1
suffix:semicolon
id|vx_get_audio_vu_meter
c_func
(paren
id|chip
comma
id|audio
comma
id|capture
comma
id|meter
)paren
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
id|meter
(braket
l_int|0
)braket
dot
id|peak_level
op_rshift
id|METER_SHIFT
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|1
)braket
op_assign
id|meter
(braket
l_int|1
)braket
dot
id|peak_level
op_rshift
id|METER_SHIFT
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|vx_saturation_info
r_static
r_int
id|vx_saturation_info
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_BOOLEAN
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|2
suffix:semicolon
id|uinfo-&gt;value.integer.min
op_assign
l_int|0
suffix:semicolon
id|uinfo-&gt;value.integer.max
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|vx_saturation_get
r_static
r_int
id|vx_saturation_get
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|vx_core_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_struct
id|vx_vu_meter
id|meter
(braket
l_int|2
)braket
suffix:semicolon
r_int
id|audio
op_assign
id|kcontrol-&gt;private_value
op_amp
l_int|0xff
suffix:semicolon
id|vx_get_audio_vu_meter
c_func
(paren
id|chip
comma
id|audio
comma
l_int|1
comma
id|meter
)paren
suffix:semicolon
multiline_comment|/* capture only */
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
id|meter
(braket
l_int|0
)braket
dot
id|saturated
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|1
)braket
op_assign
id|meter
(braket
l_int|1
)braket
dot
id|saturated
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|vx_control_vu_meter
r_static
id|snd_kcontrol_new_t
id|vx_control_vu_meter
op_assign
(brace
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_MIXER
comma
dot
id|access
op_assign
id|SNDRV_CTL_ELEM_ACCESS_READ
op_or
id|SNDRV_CTL_ELEM_ACCESS_VOLATILE
comma
multiline_comment|/* name will be filled later */
dot
id|info
op_assign
id|vx_vu_meter_info
comma
dot
id|get
op_assign
id|vx_vu_meter_get
comma
)brace
suffix:semicolon
DECL|variable|vx_control_peak_meter
r_static
id|snd_kcontrol_new_t
id|vx_control_peak_meter
op_assign
(brace
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_MIXER
comma
dot
id|access
op_assign
id|SNDRV_CTL_ELEM_ACCESS_READ
op_or
id|SNDRV_CTL_ELEM_ACCESS_VOLATILE
comma
multiline_comment|/* name will be filled later */
dot
id|info
op_assign
id|vx_vu_meter_info
comma
multiline_comment|/* shared */
dot
id|get
op_assign
id|vx_peak_meter_get
comma
)brace
suffix:semicolon
DECL|variable|vx_control_saturation
r_static
id|snd_kcontrol_new_t
id|vx_control_saturation
op_assign
(brace
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_MIXER
comma
dot
id|name
op_assign
l_string|&quot;Input Saturation&quot;
comma
dot
id|access
op_assign
id|SNDRV_CTL_ELEM_ACCESS_READ
op_or
id|SNDRV_CTL_ELEM_ACCESS_VOLATILE
comma
dot
id|info
op_assign
id|vx_saturation_info
comma
dot
id|get
op_assign
id|vx_saturation_get
comma
)brace
suffix:semicolon
multiline_comment|/*&n; *&n; */
DECL|function|snd_vx_mixer_new
r_int
id|snd_vx_mixer_new
c_func
(paren
id|vx_core_t
op_star
id|chip
)paren
(brace
r_int
r_int
id|i
comma
id|c
suffix:semicolon
r_int
id|err
suffix:semicolon
id|snd_kcontrol_new_t
id|temp
suffix:semicolon
id|snd_card_t
op_star
id|card
op_assign
id|chip-&gt;card
suffix:semicolon
r_char
id|name
(braket
l_int|32
)braket
suffix:semicolon
id|strcpy
c_func
(paren
id|card-&gt;mixername
comma
id|card-&gt;driver
)paren
suffix:semicolon
multiline_comment|/* output level controls */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|chip-&gt;hw-&gt;num_outs
suffix:semicolon
id|i
op_increment
)paren
(brace
id|temp
op_assign
id|vx_control_output_level
suffix:semicolon
id|temp.index
op_assign
id|i
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|card
comma
id|snd_ctl_new1
c_func
(paren
op_amp
id|temp
comma
id|chip
)paren
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
multiline_comment|/* PCM volumes, switches, monitoring */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|chip-&gt;hw-&gt;num_outs
suffix:semicolon
id|i
op_increment
)paren
(brace
r_int
id|val
op_assign
id|i
op_star
l_int|2
suffix:semicolon
id|temp
op_assign
id|vx_control_audio_gain
suffix:semicolon
id|temp.index
op_assign
id|i
suffix:semicolon
id|temp.name
op_assign
l_string|&quot;PCM Playback Volume&quot;
suffix:semicolon
id|temp.private_value
op_assign
id|val
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|card
comma
id|snd_ctl_new1
c_func
(paren
op_amp
id|temp
comma
id|chip
)paren
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|temp
op_assign
id|vx_control_output_switch
suffix:semicolon
id|temp.index
op_assign
id|i
suffix:semicolon
id|temp.private_value
op_assign
id|val
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|card
comma
id|snd_ctl_new1
c_func
(paren
op_amp
id|temp
comma
id|chip
)paren
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|temp
op_assign
id|vx_control_monitor_gain
suffix:semicolon
id|temp.index
op_assign
id|i
suffix:semicolon
id|temp.private_value
op_assign
id|val
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|card
comma
id|snd_ctl_new1
c_func
(paren
op_amp
id|temp
comma
id|chip
)paren
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|temp
op_assign
id|vx_control_monitor_switch
suffix:semicolon
id|temp.index
op_assign
id|i
suffix:semicolon
id|temp.private_value
op_assign
id|val
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|card
comma
id|snd_ctl_new1
c_func
(paren
op_amp
id|temp
comma
id|chip
)paren
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|chip-&gt;hw-&gt;num_outs
suffix:semicolon
id|i
op_increment
)paren
(brace
id|temp
op_assign
id|vx_control_audio_gain
suffix:semicolon
id|temp.index
op_assign
id|i
suffix:semicolon
id|temp.name
op_assign
l_string|&quot;PCM Capture Volume&quot;
suffix:semicolon
id|temp.private_value
op_assign
(paren
id|i
op_star
l_int|2
)paren
op_or
(paren
l_int|1
op_lshift
l_int|8
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|card
comma
id|snd_ctl_new1
c_func
(paren
op_amp
id|temp
comma
id|chip
)paren
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
multiline_comment|/* Audio source */
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|card
comma
id|snd_ctl_new1
c_func
(paren
op_amp
id|vx_control_audio_src
comma
id|chip
)paren
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
multiline_comment|/* clock mode */
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|card
comma
id|snd_ctl_new1
c_func
(paren
op_amp
id|vx_control_clock_mode
comma
id|chip
)paren
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
multiline_comment|/* IEC958 controls */
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|card
comma
id|snd_ctl_new1
c_func
(paren
op_amp
id|vx_control_iec958_mask
comma
id|chip
)paren
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|card
comma
id|snd_ctl_new1
c_func
(paren
op_amp
id|vx_control_iec958
comma
id|chip
)paren
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
multiline_comment|/* VU, peak, saturation meters */
r_for
c_loop
(paren
id|c
op_assign
l_int|0
suffix:semicolon
id|c
OL
l_int|2
suffix:semicolon
id|c
op_increment
)paren
(brace
r_static
r_char
op_star
id|dir
(braket
l_int|2
)braket
op_assign
(brace
l_string|&quot;Output&quot;
comma
l_string|&quot;Input&quot;
)brace
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|chip-&gt;hw-&gt;num_ins
suffix:semicolon
id|i
op_increment
)paren
(brace
r_int
id|val
op_assign
(paren
id|i
op_star
l_int|2
)paren
op_or
(paren
id|c
op_lshift
l_int|8
)paren
suffix:semicolon
r_if
c_cond
(paren
id|c
op_eq
l_int|1
)paren
(brace
id|temp
op_assign
id|vx_control_saturation
suffix:semicolon
id|temp.index
op_assign
id|i
suffix:semicolon
id|temp.private_value
op_assign
id|val
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|card
comma
id|snd_ctl_new1
c_func
(paren
op_amp
id|temp
comma
id|chip
)paren
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
id|sprintf
c_func
(paren
id|name
comma
l_string|&quot;%s VU Meter&quot;
comma
id|dir
(braket
id|c
)braket
)paren
suffix:semicolon
id|temp
op_assign
id|vx_control_vu_meter
suffix:semicolon
id|temp.index
op_assign
id|i
suffix:semicolon
id|temp.name
op_assign
id|name
suffix:semicolon
id|temp.private_value
op_assign
id|val
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|card
comma
id|snd_ctl_new1
c_func
(paren
op_amp
id|temp
comma
id|chip
)paren
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|sprintf
c_func
(paren
id|name
comma
l_string|&quot;%s Peak Meter&quot;
comma
id|dir
(braket
id|c
)braket
)paren
suffix:semicolon
id|temp
op_assign
id|vx_control_peak_meter
suffix:semicolon
id|temp.index
op_assign
id|i
suffix:semicolon
id|temp.name
op_assign
id|name
suffix:semicolon
id|temp.private_value
op_assign
id|val
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|card
comma
id|snd_ctl_new1
c_func
(paren
op_amp
id|temp
comma
id|chip
)paren
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
)brace
id|vx_reset_audio_levels
c_func
(paren
id|chip
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
eof
