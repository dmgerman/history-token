multiline_comment|/*&n; * Driver for the i2c/i2s based TA3004 sound chip used&n; * on some Apple hardware. Also known as &quot;snapper&quot;.&n; *&n; * Tobias Sargeant &lt;tobias.sargeant@bigpond.com&gt;&n; * Based upon tas3001c.c by Christopher C. Chimelis &lt;chris@debian.org&gt;:&n; *&n; * Input support by Renzo Davoli &lt;renzo@cs.unibo.it&gt;&n; *&n; */
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;linux/proc_fs.h&gt;
macro_line|#include &lt;linux/ioport.h&gt;
macro_line|#include &lt;linux/sysctl.h&gt;
macro_line|#include &lt;linux/types.h&gt;
macro_line|#include &lt;linux/i2c.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/soundcard.h&gt;
macro_line|#include &lt;linux/interrupt.h&gt;
macro_line|#include &lt;linux/workqueue.h&gt;
macro_line|#include &lt;asm/uaccess.h&gt;
macro_line|#include &lt;asm/errno.h&gt;
macro_line|#include &lt;asm/io.h&gt;
macro_line|#include &lt;asm/prom.h&gt;
macro_line|#include &quot;dmasound.h&quot;
macro_line|#include &quot;tas_common.h&quot;
macro_line|#include &quot;tas3004.h&quot;
macro_line|#include &quot;tas_ioctl.h&quot;
multiline_comment|/* #define DEBUG_DRCE */
DECL|macro|TAS3004_BIQUAD_FILTER_COUNT
mdefine_line|#define TAS3004_BIQUAD_FILTER_COUNT  7
DECL|macro|TAS3004_BIQUAD_CHANNEL_COUNT
mdefine_line|#define TAS3004_BIQUAD_CHANNEL_COUNT 2
DECL|macro|VOL_DEFAULT
mdefine_line|#define VOL_DEFAULT&t;(100 * 4 / 5)
DECL|macro|INPUT_DEFAULT
mdefine_line|#define INPUT_DEFAULT&t;(100 * 4 / 5)
DECL|macro|BASS_DEFAULT
mdefine_line|#define BASS_DEFAULT&t;(100 / 2)
DECL|macro|TREBLE_DEFAULT
mdefine_line|#define TREBLE_DEFAULT&t;(100 / 2)
DECL|struct|tas3004_data_t
r_struct
id|tas3004_data_t
(brace
DECL|member|super
r_struct
id|tas_data_t
id|super
suffix:semicolon
DECL|member|device_id
r_int
id|device_id
suffix:semicolon
DECL|member|output_id
r_int
id|output_id
suffix:semicolon
DECL|member|speaker_id
r_int
id|speaker_id
suffix:semicolon
DECL|member|drce_state
r_struct
id|tas_drce_t
id|drce_state
suffix:semicolon
)brace
suffix:semicolon
DECL|macro|MAKE_TIME
mdefine_line|#define MAKE_TIME(sec,usec) (((sec)&lt;&lt;12) + (50000+(usec/10)*(1&lt;&lt;12))/100000)
DECL|macro|MAKE_RATIO
mdefine_line|#define MAKE_RATIO(i,f) (((i)&lt;&lt;8) + ((500+(f)*(1&lt;&lt;8))/1000))
DECL|variable|tas3004_eq_unity
r_static
r_const
r_union
id|tas_biquad_t
id|tas3004_eq_unity
op_assign
(brace
dot
id|buf
op_assign
(brace
l_int|0x100000
comma
l_int|0x000000
comma
l_int|0x000000
comma
l_int|0x000000
comma
l_int|0x000000
)brace
comma
)brace
suffix:semicolon
DECL|variable|tas3004_drce_min
r_static
r_const
r_struct
id|tas_drce_t
id|tas3004_drce_min
op_assign
(brace
dot
id|enable
op_assign
l_int|1
comma
dot
id|above
op_assign
(brace
dot
id|val
op_assign
id|MAKE_RATIO
c_func
(paren
l_int|16
comma
l_int|0
)paren
comma
dot
id|expand
op_assign
l_int|0
)brace
comma
dot
id|below
op_assign
(brace
dot
id|val
op_assign
id|MAKE_RATIO
c_func
(paren
l_int|2
comma
l_int|0
)paren
comma
dot
id|expand
op_assign
l_int|0
)brace
comma
dot
id|threshold
op_assign
op_minus
l_int|0x59a0
comma
dot
id|energy
op_assign
id|MAKE_TIME
c_func
(paren
l_int|0
comma
l_int|1700
)paren
comma
dot
id|attack
op_assign
id|MAKE_TIME
c_func
(paren
l_int|0
comma
l_int|1700
)paren
comma
dot
id|decay
op_assign
id|MAKE_TIME
c_func
(paren
l_int|0
comma
l_int|1700
)paren
comma
)brace
suffix:semicolon
DECL|variable|tas3004_drce_max
r_static
r_const
r_struct
id|tas_drce_t
id|tas3004_drce_max
op_assign
(brace
dot
id|enable
op_assign
l_int|1
comma
dot
id|above
op_assign
(brace
dot
id|val
op_assign
id|MAKE_RATIO
c_func
(paren
l_int|1
comma
l_int|500
)paren
comma
dot
id|expand
op_assign
l_int|1
)brace
comma
dot
id|below
op_assign
(brace
dot
id|val
op_assign
id|MAKE_RATIO
c_func
(paren
l_int|2
comma
l_int|0
)paren
comma
dot
id|expand
op_assign
l_int|1
)brace
comma
dot
id|threshold
op_assign
op_minus
l_int|0x0
comma
dot
id|energy
op_assign
id|MAKE_TIME
c_func
(paren
l_int|2
comma
l_int|400000
)paren
comma
dot
id|attack
op_assign
id|MAKE_TIME
c_func
(paren
l_int|2
comma
l_int|400000
)paren
comma
dot
id|decay
op_assign
id|MAKE_TIME
c_func
(paren
l_int|2
comma
l_int|400000
)paren
comma
)brace
suffix:semicolon
DECL|variable|time_constants
r_static
r_const
r_int
r_int
id|time_constants
(braket
)braket
op_assign
initialization_block
suffix:semicolon
DECL|variable|above_threshold_compression_ratio
r_static
r_const
r_int
r_int
id|above_threshold_compression_ratio
(braket
)braket
op_assign
initialization_block
suffix:semicolon
DECL|variable|above_threshold_expansion_ratio
r_static
r_const
r_int
r_int
id|above_threshold_expansion_ratio
(braket
)braket
op_assign
initialization_block
suffix:semicolon
DECL|variable|below_threshold_compression_ratio
r_static
r_const
r_int
r_int
id|below_threshold_compression_ratio
(braket
)braket
op_assign
initialization_block
suffix:semicolon
DECL|variable|below_threshold_expansion_ratio
r_static
r_const
r_int
r_int
id|below_threshold_expansion_ratio
(braket
)braket
op_assign
initialization_block
suffix:semicolon
r_static
r_inline
r_int
DECL|function|search
id|search
c_func
(paren
r_int
r_int
id|val
comma
r_const
r_int
r_int
op_star
id|arr
comma
r_const
r_int
id|arrsize
)paren
(brace
multiline_comment|/*&n;&t; * This could be a binary search, but for small tables,&n;&t; * a linear search is likely to be faster&n;&t; */
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|arrsize
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|arr
(braket
id|i
)braket
op_ge
id|val
)paren
r_goto
id|_1
suffix:semicolon
r_return
id|arrsize
op_minus
l_int|1
suffix:semicolon
id|_1
suffix:colon
r_if
c_cond
(paren
id|i
op_eq
l_int|0
)paren
r_return
l_int|0
suffix:semicolon
r_return
(paren
id|arr
(braket
id|i
)braket
op_minus
id|val
OL
id|val
op_minus
id|arr
(braket
id|i
op_minus
l_int|1
)braket
)paren
ques
c_cond
id|i
suffix:colon
id|i
op_minus
l_int|1
suffix:semicolon
)brace
DECL|macro|SEARCH
mdefine_line|#define SEARCH(a, b) search(a, b, ARRAY_SIZE(b))
r_static
r_inline
r_int
DECL|function|time_index
id|time_index
c_func
(paren
r_int
r_int
id|time
)paren
(brace
r_return
id|SEARCH
c_func
(paren
id|time
comma
id|time_constants
)paren
suffix:semicolon
)brace
r_static
r_inline
r_int
DECL|function|above_threshold_compression_index
id|above_threshold_compression_index
c_func
(paren
r_int
r_int
id|ratio
)paren
(brace
r_return
id|SEARCH
c_func
(paren
id|ratio
comma
id|above_threshold_compression_ratio
)paren
suffix:semicolon
)brace
r_static
r_inline
r_int
DECL|function|above_threshold_expansion_index
id|above_threshold_expansion_index
c_func
(paren
r_int
r_int
id|ratio
)paren
(brace
r_return
id|SEARCH
c_func
(paren
id|ratio
comma
id|above_threshold_expansion_ratio
)paren
suffix:semicolon
)brace
r_static
r_inline
r_int
DECL|function|below_threshold_compression_index
id|below_threshold_compression_index
c_func
(paren
r_int
r_int
id|ratio
)paren
(brace
r_return
id|SEARCH
c_func
(paren
id|ratio
comma
id|below_threshold_compression_ratio
)paren
suffix:semicolon
)brace
r_static
r_inline
r_int
DECL|function|below_threshold_expansion_index
id|below_threshold_expansion_index
c_func
(paren
r_int
r_int
id|ratio
)paren
(brace
r_return
id|SEARCH
c_func
(paren
id|ratio
comma
id|below_threshold_expansion_ratio
)paren
suffix:semicolon
)brace
DECL|function|db_to_regval
r_static
r_inline
r_int
r_char
id|db_to_regval
c_func
(paren
r_int
id|db
)paren
(brace
r_int
id|r
op_assign
l_int|0
suffix:semicolon
id|r
op_assign
(paren
id|db
op_plus
l_int|0x59a0
)paren
op_div
l_int|0x60
suffix:semicolon
r_if
c_cond
(paren
id|r
OL
l_int|0x91
)paren
r_return
l_int|0x91
suffix:semicolon
r_if
c_cond
(paren
id|r
OG
l_int|0xef
)paren
r_return
l_int|0xef
suffix:semicolon
r_return
id|r
suffix:semicolon
)brace
DECL|function|quantize_db
r_static
r_inline
r_int
id|quantize_db
c_func
(paren
r_int
id|db
)paren
(brace
r_return
id|db_to_regval
c_func
(paren
id|db
)paren
op_star
l_int|0x60
op_minus
l_int|0x59a0
suffix:semicolon
)brace
r_static
r_inline
r_int
DECL|function|register_width
id|register_width
c_func
(paren
r_enum
id|tas3004_reg_t
id|r
)paren
(brace
r_switch
c_cond
(paren
id|r
)paren
(brace
r_case
id|TAS3004_REG_MCR
suffix:colon
r_case
id|TAS3004_REG_TREBLE
suffix:colon
r_case
id|TAS3004_REG_BASS
suffix:colon
r_case
id|TAS3004_REG_ANALOG_CTRL
suffix:colon
r_case
id|TAS3004_REG_TEST1
suffix:colon
r_case
id|TAS3004_REG_TEST2
suffix:colon
r_case
id|TAS3004_REG_MCR2
suffix:colon
r_return
l_int|1
suffix:semicolon
r_case
id|TAS3004_REG_LEFT_LOUD_BIQUAD_GAIN
suffix:colon
r_case
id|TAS3004_REG_RIGHT_LOUD_BIQUAD_GAIN
suffix:colon
r_return
l_int|3
suffix:semicolon
r_case
id|TAS3004_REG_DRC
suffix:colon
r_case
id|TAS3004_REG_VOLUME
suffix:colon
r_return
l_int|6
suffix:semicolon
r_case
id|TAS3004_REG_LEFT_MIXER
suffix:colon
r_case
id|TAS3004_REG_RIGHT_MIXER
suffix:colon
r_return
l_int|9
suffix:semicolon
r_case
id|TAS3004_REG_TEST
suffix:colon
r_return
l_int|10
suffix:semicolon
r_case
id|TAS3004_REG_LEFT_BIQUAD0
suffix:colon
r_case
id|TAS3004_REG_LEFT_BIQUAD1
suffix:colon
r_case
id|TAS3004_REG_LEFT_BIQUAD2
suffix:colon
r_case
id|TAS3004_REG_LEFT_BIQUAD3
suffix:colon
r_case
id|TAS3004_REG_LEFT_BIQUAD4
suffix:colon
r_case
id|TAS3004_REG_LEFT_BIQUAD5
suffix:colon
r_case
id|TAS3004_REG_LEFT_BIQUAD6
suffix:colon
r_case
id|TAS3004_REG_RIGHT_BIQUAD0
suffix:colon
r_case
id|TAS3004_REG_RIGHT_BIQUAD1
suffix:colon
r_case
id|TAS3004_REG_RIGHT_BIQUAD2
suffix:colon
r_case
id|TAS3004_REG_RIGHT_BIQUAD3
suffix:colon
r_case
id|TAS3004_REG_RIGHT_BIQUAD4
suffix:colon
r_case
id|TAS3004_REG_RIGHT_BIQUAD5
suffix:colon
r_case
id|TAS3004_REG_RIGHT_BIQUAD6
suffix:colon
r_case
id|TAS3004_REG_LEFT_LOUD_BIQUAD
suffix:colon
r_case
id|TAS3004_REG_RIGHT_LOUD_BIQUAD
suffix:colon
r_return
l_int|15
suffix:semicolon
r_default
suffix:colon
r_return
l_int|0
suffix:semicolon
)brace
)brace
r_static
r_int
DECL|function|tas3004_write_register
id|tas3004_write_register
c_func
(paren
r_struct
id|tas3004_data_t
op_star
id|self
comma
r_enum
id|tas3004_reg_t
id|reg_num
comma
r_char
op_star
id|data
comma
id|uint
id|write_mode
)paren
(brace
r_if
c_cond
(paren
id|reg_num
op_eq
id|TAS3004_REG_MCR
op_logical_or
id|reg_num
op_eq
id|TAS3004_REG_BASS
op_logical_or
id|reg_num
op_eq
id|TAS3004_REG_TREBLE
op_logical_or
id|reg_num
op_eq
id|TAS3004_REG_ANALOG_CTRL
)paren
(brace
r_return
id|tas_write_byte_register
c_func
(paren
op_amp
id|self-&gt;super
comma
(paren
id|uint
)paren
id|reg_num
comma
op_star
id|data
comma
id|write_mode
)paren
suffix:semicolon
)brace
r_else
(brace
r_return
id|tas_write_register
c_func
(paren
op_amp
id|self-&gt;super
comma
(paren
id|uint
)paren
id|reg_num
comma
id|register_width
c_func
(paren
id|reg_num
)paren
comma
id|data
comma
id|write_mode
)paren
suffix:semicolon
)brace
)brace
r_static
r_int
DECL|function|tas3004_sync_register
id|tas3004_sync_register
c_func
(paren
r_struct
id|tas3004_data_t
op_star
id|self
comma
r_enum
id|tas3004_reg_t
id|reg_num
)paren
(brace
r_if
c_cond
(paren
id|reg_num
op_eq
id|TAS3004_REG_MCR
op_logical_or
id|reg_num
op_eq
id|TAS3004_REG_BASS
op_logical_or
id|reg_num
op_eq
id|TAS3004_REG_TREBLE
op_logical_or
id|reg_num
op_eq
id|TAS3004_REG_ANALOG_CTRL
)paren
(brace
r_return
id|tas_sync_byte_register
c_func
(paren
op_amp
id|self-&gt;super
comma
(paren
id|uint
)paren
id|reg_num
comma
id|register_width
c_func
(paren
id|reg_num
)paren
)paren
suffix:semicolon
)brace
r_else
(brace
r_return
id|tas_sync_register
c_func
(paren
op_amp
id|self-&gt;super
comma
(paren
id|uint
)paren
id|reg_num
comma
id|register_width
c_func
(paren
id|reg_num
)paren
)paren
suffix:semicolon
)brace
)brace
r_static
r_int
DECL|function|tas3004_read_register
id|tas3004_read_register
c_func
(paren
r_struct
id|tas3004_data_t
op_star
id|self
comma
r_enum
id|tas3004_reg_t
id|reg_num
comma
r_char
op_star
id|data
comma
id|uint
id|write_mode
)paren
(brace
r_return
id|tas_read_register
c_func
(paren
op_amp
id|self-&gt;super
comma
(paren
id|uint
)paren
id|reg_num
comma
id|register_width
c_func
(paren
id|reg_num
)paren
comma
id|data
)paren
suffix:semicolon
)brace
r_static
r_inline
r_int
DECL|function|tas3004_fast_load
id|tas3004_fast_load
c_func
(paren
r_struct
id|tas3004_data_t
op_star
id|self
comma
r_int
id|fast
)paren
(brace
r_if
c_cond
(paren
id|fast
)paren
id|self-&gt;super.shadow
(braket
id|TAS3004_REG_MCR
)braket
(braket
l_int|0
)braket
op_or_assign
l_int|0x80
suffix:semicolon
r_else
id|self-&gt;super.shadow
(braket
id|TAS3004_REG_MCR
)braket
(braket
l_int|0
)braket
op_and_assign
l_int|0x7f
suffix:semicolon
r_return
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_MCR
)paren
suffix:semicolon
)brace
r_static
id|uint
DECL|function|tas3004_supported_mixers
id|tas3004_supported_mixers
c_func
(paren
r_struct
id|tas3004_data_t
op_star
id|self
)paren
(brace
r_return
id|SOUND_MASK_VOLUME
op_or
id|SOUND_MASK_PCM
op_or
id|SOUND_MASK_ALTPCM
op_or
id|SOUND_MASK_IMIX
op_or
id|SOUND_MASK_TREBLE
op_or
id|SOUND_MASK_BASS
op_or
id|SOUND_MASK_MIC
op_or
id|SOUND_MASK_LINE
suffix:semicolon
)brace
r_static
r_int
DECL|function|tas3004_mixer_is_stereo
id|tas3004_mixer_is_stereo
c_func
(paren
r_struct
id|tas3004_data_t
op_star
id|self
comma
r_int
id|mixer
)paren
(brace
r_switch
c_cond
(paren
id|mixer
)paren
(brace
r_case
id|SOUND_MIXER_VOLUME
suffix:colon
r_case
id|SOUND_MIXER_PCM
suffix:colon
r_case
id|SOUND_MIXER_ALTPCM
suffix:colon
r_case
id|SOUND_MIXER_IMIX
suffix:colon
r_return
l_int|1
suffix:semicolon
r_default
suffix:colon
r_return
l_int|0
suffix:semicolon
)brace
)brace
r_static
id|uint
DECL|function|tas3004_stereo_mixers
id|tas3004_stereo_mixers
c_func
(paren
r_struct
id|tas3004_data_t
op_star
id|self
)paren
(brace
id|uint
id|r
op_assign
id|tas3004_supported_mixers
c_func
(paren
id|self
)paren
suffix:semicolon
id|uint
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|1
suffix:semicolon
id|i
OL
id|SOUND_MIXER_NRDEVICES
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|r
op_amp
(paren
l_int|1
op_lshift
id|i
)paren
op_logical_and
op_logical_neg
id|tas3004_mixer_is_stereo
c_func
(paren
id|self
comma
id|i
)paren
)paren
id|r
op_and_assign
op_complement
(paren
l_int|1
op_lshift
id|i
)paren
suffix:semicolon
r_return
id|r
suffix:semicolon
)brace
r_static
r_int
DECL|function|tas3004_get_mixer_level
id|tas3004_get_mixer_level
c_func
(paren
r_struct
id|tas3004_data_t
op_star
id|self
comma
r_int
id|mixer
comma
id|uint
op_star
id|level
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|self
)paren
r_return
op_minus
l_int|1
suffix:semicolon
op_star
id|level
op_assign
id|self-&gt;super.mixer
(braket
id|mixer
)braket
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|tas3004_set_mixer_level
id|tas3004_set_mixer_level
c_func
(paren
r_struct
id|tas3004_data_t
op_star
id|self
comma
r_int
id|mixer
comma
id|uint
id|level
)paren
(brace
r_int
id|rc
suffix:semicolon
id|tas_shadow_t
op_star
id|shadow
suffix:semicolon
id|uint
id|temp
suffix:semicolon
id|uint
id|offset
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|self
)paren
r_return
op_minus
l_int|1
suffix:semicolon
id|shadow
op_assign
id|self-&gt;super.shadow
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|tas3004_mixer_is_stereo
c_func
(paren
id|self
comma
id|mixer
)paren
)paren
id|level
op_assign
id|tas_mono_to_stereo
c_func
(paren
id|level
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|mixer
)paren
(brace
r_case
id|SOUND_MIXER_VOLUME
suffix:colon
id|temp
op_assign
id|tas3004_gain.master
(braket
id|level
op_amp
l_int|0xff
)braket
suffix:semicolon
id|SET_4_20
c_func
(paren
id|shadow
(braket
id|TAS3004_REG_VOLUME
)braket
comma
l_int|0
comma
id|temp
)paren
suffix:semicolon
id|temp
op_assign
id|tas3004_gain.master
(braket
(paren
id|level
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
)braket
suffix:semicolon
id|SET_4_20
c_func
(paren
id|shadow
(braket
id|TAS3004_REG_VOLUME
)braket
comma
l_int|3
comma
id|temp
)paren
suffix:semicolon
id|rc
op_assign
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_VOLUME
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SOUND_MIXER_IMIX
suffix:colon
id|offset
op_add_assign
l_int|3
suffix:semicolon
r_case
id|SOUND_MIXER_ALTPCM
suffix:colon
id|offset
op_add_assign
l_int|3
suffix:semicolon
r_case
id|SOUND_MIXER_PCM
suffix:colon
multiline_comment|/*&n;&t;&t; * Don&squot;t load these in fast mode. The documentation&n;&t;&t; * says it can be done in either mode, but testing it&n;&t;&t; * shows that fast mode produces ugly clicking.&n;&t;&t;*/
multiline_comment|/* tas3004_fast_load(self,1); */
id|temp
op_assign
id|tas3004_gain.mixer
(braket
id|level
op_amp
l_int|0xff
)braket
suffix:semicolon
id|SET_4_20
c_func
(paren
id|shadow
(braket
id|TAS3004_REG_LEFT_MIXER
)braket
comma
id|offset
comma
id|temp
)paren
suffix:semicolon
id|temp
op_assign
id|tas3004_gain.mixer
(braket
(paren
id|level
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
)braket
suffix:semicolon
id|SET_4_20
c_func
(paren
id|shadow
(braket
id|TAS3004_REG_RIGHT_MIXER
)braket
comma
id|offset
comma
id|temp
)paren
suffix:semicolon
id|rc
op_assign
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_LEFT_MIXER
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rc
op_eq
l_int|0
)paren
id|rc
op_assign
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_RIGHT_MIXER
)paren
suffix:semicolon
multiline_comment|/* tas3004_fast_load(self,0); */
r_break
suffix:semicolon
r_case
id|SOUND_MIXER_TREBLE
suffix:colon
id|temp
op_assign
id|tas3004_gain.treble
(braket
id|level
op_amp
l_int|0xff
)braket
suffix:semicolon
id|shadow
(braket
id|TAS3004_REG_TREBLE
)braket
(braket
l_int|0
)braket
op_assign
id|temp
op_amp
l_int|0xff
suffix:semicolon
id|rc
op_assign
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_TREBLE
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SOUND_MIXER_BASS
suffix:colon
id|temp
op_assign
id|tas3004_gain.bass
(braket
id|level
op_amp
l_int|0xff
)braket
suffix:semicolon
id|shadow
(braket
id|TAS3004_REG_BASS
)braket
(braket
l_int|0
)braket
op_assign
id|temp
op_amp
l_int|0xff
suffix:semicolon
id|rc
op_assign
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_BASS
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SOUND_MIXER_MIC
suffix:colon
r_if
c_cond
(paren
(paren
id|level
op_amp
l_int|0xff
)paren
OG
l_int|0
)paren
(brace
id|software_input_volume
op_assign
id|SW_INPUT_VOLUME_SCALE
op_star
(paren
id|level
op_amp
l_int|0xff
)paren
suffix:semicolon
r_if
c_cond
(paren
id|self-&gt;super.mixer
(braket
id|mixer
)braket
op_eq
l_int|0
)paren
(brace
id|self-&gt;super.mixer
(braket
id|SOUND_MIXER_LINE
)braket
op_assign
l_int|0
suffix:semicolon
id|shadow
(braket
id|TAS3004_REG_ANALOG_CTRL
)braket
(braket
l_int|0
)braket
op_assign
l_int|0xc2
suffix:semicolon
id|rc
op_assign
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_ANALOG_CTRL
)paren
suffix:semicolon
)brace
r_else
id|rc
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|self-&gt;super.mixer
(braket
id|SOUND_MIXER_LINE
)braket
op_assign
id|SW_INPUT_VOLUME_DEFAULT
suffix:semicolon
id|software_input_volume
op_assign
id|SW_INPUT_VOLUME_SCALE
op_star
(paren
id|self-&gt;super.mixer
(braket
id|SOUND_MIXER_LINE
)braket
op_amp
l_int|0xff
)paren
suffix:semicolon
id|shadow
(braket
id|TAS3004_REG_ANALOG_CTRL
)braket
(braket
l_int|0
)braket
op_assign
l_int|0x00
suffix:semicolon
id|rc
op_assign
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_ANALOG_CTRL
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|SOUND_MIXER_LINE
suffix:colon
r_if
c_cond
(paren
id|self-&gt;super.mixer
(braket
id|SOUND_MIXER_MIC
)braket
op_eq
l_int|0
)paren
(brace
id|software_input_volume
op_assign
id|SW_INPUT_VOLUME_SCALE
op_star
(paren
id|level
op_amp
l_int|0xff
)paren
suffix:semicolon
id|rc
op_assign
l_int|0
suffix:semicolon
)brace
r_break
suffix:semicolon
r_default
suffix:colon
id|rc
op_assign
op_minus
l_int|1
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|rc
OL
l_int|0
)paren
r_return
id|rc
suffix:semicolon
id|self-&gt;super.mixer
(braket
id|mixer
)braket
op_assign
id|level
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|tas3004_leave_sleep
id|tas3004_leave_sleep
c_func
(paren
r_struct
id|tas3004_data_t
op_star
id|self
)paren
(brace
r_int
r_char
id|mcr
op_assign
(paren
l_int|1
op_lshift
l_int|6
)paren
op_plus
(paren
l_int|2
op_lshift
l_int|4
)paren
op_plus
(paren
l_int|2
op_lshift
l_int|2
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|self
)paren
r_return
op_minus
l_int|1
suffix:semicolon
multiline_comment|/* Make sure something answers on the i2c bus */
r_if
c_cond
(paren
id|tas3004_write_register
c_func
(paren
id|self
comma
id|TAS3004_REG_MCR
comma
op_amp
id|mcr
comma
id|WRITE_NORMAL
op_or
id|FORCE_WRITE
)paren
OL
l_int|0
)paren
r_return
op_minus
l_int|1
suffix:semicolon
id|tas3004_fast_load
c_func
(paren
id|self
comma
l_int|1
)paren
suffix:semicolon
(paren
r_void
)paren
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_RIGHT_BIQUAD0
)paren
suffix:semicolon
(paren
r_void
)paren
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_RIGHT_BIQUAD1
)paren
suffix:semicolon
(paren
r_void
)paren
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_RIGHT_BIQUAD2
)paren
suffix:semicolon
(paren
r_void
)paren
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_RIGHT_BIQUAD3
)paren
suffix:semicolon
(paren
r_void
)paren
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_RIGHT_BIQUAD4
)paren
suffix:semicolon
(paren
r_void
)paren
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_RIGHT_BIQUAD5
)paren
suffix:semicolon
(paren
r_void
)paren
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_RIGHT_BIQUAD6
)paren
suffix:semicolon
(paren
r_void
)paren
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_LEFT_BIQUAD0
)paren
suffix:semicolon
(paren
r_void
)paren
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_LEFT_BIQUAD1
)paren
suffix:semicolon
(paren
r_void
)paren
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_LEFT_BIQUAD2
)paren
suffix:semicolon
(paren
r_void
)paren
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_LEFT_BIQUAD3
)paren
suffix:semicolon
(paren
r_void
)paren
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_LEFT_BIQUAD4
)paren
suffix:semicolon
(paren
r_void
)paren
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_LEFT_BIQUAD5
)paren
suffix:semicolon
(paren
r_void
)paren
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_LEFT_BIQUAD6
)paren
suffix:semicolon
id|tas3004_fast_load
c_func
(paren
id|self
comma
l_int|0
)paren
suffix:semicolon
(paren
r_void
)paren
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_VOLUME
)paren
suffix:semicolon
(paren
r_void
)paren
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_LEFT_MIXER
)paren
suffix:semicolon
(paren
r_void
)paren
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_RIGHT_MIXER
)paren
suffix:semicolon
(paren
r_void
)paren
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_TREBLE
)paren
suffix:semicolon
(paren
r_void
)paren
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_BASS
)paren
suffix:semicolon
(paren
r_void
)paren
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_ANALOG_CTRL
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|tas3004_enter_sleep
id|tas3004_enter_sleep
c_func
(paren
r_struct
id|tas3004_data_t
op_star
id|self
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|self
)paren
r_return
op_minus
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|tas3004_sync_biquad
id|tas3004_sync_biquad
c_func
(paren
r_struct
id|tas3004_data_t
op_star
id|self
comma
id|u_int
id|channel
comma
id|u_int
id|filter
)paren
(brace
r_enum
id|tas3004_reg_t
id|reg
suffix:semicolon
r_if
c_cond
(paren
id|channel
op_ge
id|TAS3004_BIQUAD_CHANNEL_COUNT
op_logical_or
id|filter
op_ge
id|TAS3004_BIQUAD_FILTER_COUNT
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|reg
op_assign
(paren
id|channel
ques
c_cond
id|TAS3004_REG_RIGHT_BIQUAD0
suffix:colon
id|TAS3004_REG_LEFT_BIQUAD0
)paren
op_plus
id|filter
suffix:semicolon
r_return
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|reg
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|tas3004_write_biquad_shadow
id|tas3004_write_biquad_shadow
c_func
(paren
r_struct
id|tas3004_data_t
op_star
id|self
comma
id|u_int
id|channel
comma
id|u_int
id|filter
comma
r_const
r_union
id|tas_biquad_t
op_star
id|biquad
)paren
(brace
id|tas_shadow_t
op_star
id|shadow
op_assign
id|self-&gt;super.shadow
suffix:semicolon
r_enum
id|tas3004_reg_t
id|reg
suffix:semicolon
r_if
c_cond
(paren
id|channel
op_ge
id|TAS3004_BIQUAD_CHANNEL_COUNT
op_logical_or
id|filter
op_ge
id|TAS3004_BIQUAD_FILTER_COUNT
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|reg
op_assign
(paren
id|channel
ques
c_cond
id|TAS3004_REG_RIGHT_BIQUAD0
suffix:colon
id|TAS3004_REG_LEFT_BIQUAD0
)paren
op_plus
id|filter
suffix:semicolon
id|SET_4_20
c_func
(paren
id|shadow
(braket
id|reg
)braket
comma
l_int|0
comma
id|biquad-&gt;coeff.b0
)paren
suffix:semicolon
id|SET_4_20
c_func
(paren
id|shadow
(braket
id|reg
)braket
comma
l_int|3
comma
id|biquad-&gt;coeff.b1
)paren
suffix:semicolon
id|SET_4_20
c_func
(paren
id|shadow
(braket
id|reg
)braket
comma
l_int|6
comma
id|biquad-&gt;coeff.b2
)paren
suffix:semicolon
id|SET_4_20
c_func
(paren
id|shadow
(braket
id|reg
)braket
comma
l_int|9
comma
id|biquad-&gt;coeff.a1
)paren
suffix:semicolon
id|SET_4_20
c_func
(paren
id|shadow
(braket
id|reg
)braket
comma
l_int|12
comma
id|biquad-&gt;coeff.a2
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|tas3004_write_biquad
id|tas3004_write_biquad
c_func
(paren
r_struct
id|tas3004_data_t
op_star
id|self
comma
id|u_int
id|channel
comma
id|u_int
id|filter
comma
r_const
r_union
id|tas_biquad_t
op_star
id|biquad
)paren
(brace
r_int
id|rc
suffix:semicolon
id|rc
op_assign
id|tas3004_write_biquad_shadow
c_func
(paren
id|self
comma
id|channel
comma
id|filter
comma
id|biquad
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rc
OL
l_int|0
)paren
r_return
id|rc
suffix:semicolon
r_return
id|tas3004_sync_biquad
c_func
(paren
id|self
comma
id|channel
comma
id|filter
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|tas3004_write_biquad_list
id|tas3004_write_biquad_list
c_func
(paren
r_struct
id|tas3004_data_t
op_star
id|self
comma
id|u_int
id|filter_count
comma
id|u_int
id|flags
comma
r_struct
id|tas_biquad_ctrl_t
op_star
id|biquads
)paren
(brace
r_int
id|i
suffix:semicolon
r_int
id|rc
suffix:semicolon
r_if
c_cond
(paren
id|flags
op_amp
id|TAS_BIQUAD_FAST_LOAD
)paren
id|tas3004_fast_load
c_func
(paren
id|self
comma
l_int|1
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|filter_count
suffix:semicolon
id|i
op_increment
)paren
(brace
id|rc
op_assign
id|tas3004_write_biquad
c_func
(paren
id|self
comma
id|biquads
(braket
id|i
)braket
dot
id|channel
comma
id|biquads
(braket
id|i
)braket
dot
id|filter
comma
op_amp
id|biquads
(braket
id|i
)braket
dot
id|data
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rc
OL
l_int|0
)paren
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|flags
op_amp
id|TAS_BIQUAD_FAST_LOAD
)paren
id|tas3004_fast_load
c_func
(paren
id|self
comma
l_int|0
)paren
suffix:semicolon
r_return
id|rc
suffix:semicolon
)brace
r_static
r_int
DECL|function|tas3004_read_biquad
id|tas3004_read_biquad
c_func
(paren
r_struct
id|tas3004_data_t
op_star
id|self
comma
id|u_int
id|channel
comma
id|u_int
id|filter
comma
r_union
id|tas_biquad_t
op_star
id|biquad
)paren
(brace
id|tas_shadow_t
op_star
id|shadow
op_assign
id|self-&gt;super.shadow
suffix:semicolon
r_enum
id|tas3004_reg_t
id|reg
suffix:semicolon
r_if
c_cond
(paren
id|channel
op_ge
id|TAS3004_BIQUAD_CHANNEL_COUNT
op_logical_or
id|filter
op_ge
id|TAS3004_BIQUAD_FILTER_COUNT
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|reg
op_assign
(paren
id|channel
ques
c_cond
id|TAS3004_REG_RIGHT_BIQUAD0
suffix:colon
id|TAS3004_REG_LEFT_BIQUAD0
)paren
op_plus
id|filter
suffix:semicolon
id|biquad-&gt;coeff.b0
op_assign
id|GET_4_20
c_func
(paren
id|shadow
(braket
id|reg
)braket
comma
l_int|0
)paren
suffix:semicolon
id|biquad-&gt;coeff.b1
op_assign
id|GET_4_20
c_func
(paren
id|shadow
(braket
id|reg
)braket
comma
l_int|3
)paren
suffix:semicolon
id|biquad-&gt;coeff.b2
op_assign
id|GET_4_20
c_func
(paren
id|shadow
(braket
id|reg
)braket
comma
l_int|6
)paren
suffix:semicolon
id|biquad-&gt;coeff.a1
op_assign
id|GET_4_20
c_func
(paren
id|shadow
(braket
id|reg
)braket
comma
l_int|9
)paren
suffix:semicolon
id|biquad-&gt;coeff.a2
op_assign
id|GET_4_20
c_func
(paren
id|shadow
(braket
id|reg
)braket
comma
l_int|12
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|tas3004_eq_rw
id|tas3004_eq_rw
c_func
(paren
r_struct
id|tas3004_data_t
op_star
id|self
comma
id|u_int
id|cmd
comma
id|u_long
id|arg
)paren
(brace
r_int
id|rc
suffix:semicolon
r_struct
id|tas_biquad_ctrl_t
id|biquad
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
(paren
r_void
op_star
)paren
op_amp
id|biquad
comma
(paren
r_const
r_void
op_star
)paren
id|arg
comma
r_sizeof
(paren
r_struct
id|tas_biquad_ctrl_t
)paren
)paren
)paren
(brace
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
r_if
c_cond
(paren
id|cmd
op_amp
id|SIOC_IN
)paren
(brace
id|rc
op_assign
id|tas3004_write_biquad
c_func
(paren
id|self
comma
id|biquad.channel
comma
id|biquad.filter
comma
op_amp
id|biquad.data
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rc
op_ne
l_int|0
)paren
r_return
id|rc
suffix:semicolon
)brace
r_if
c_cond
(paren
id|cmd
op_amp
id|SIOC_OUT
)paren
(brace
id|rc
op_assign
id|tas3004_read_biquad
c_func
(paren
id|self
comma
id|biquad.channel
comma
id|biquad.filter
comma
op_amp
id|biquad.data
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rc
op_ne
l_int|0
)paren
r_return
id|rc
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
(paren
r_void
op_star
)paren
id|arg
comma
(paren
r_const
r_void
op_star
)paren
op_amp
id|biquad
comma
r_sizeof
(paren
r_struct
id|tas_biquad_ctrl_t
)paren
)paren
)paren
(brace
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|tas3004_eq_list_rw
id|tas3004_eq_list_rw
c_func
(paren
r_struct
id|tas3004_data_t
op_star
id|self
comma
id|u_int
id|cmd
comma
id|u_long
id|arg
)paren
(brace
r_int
id|rc
op_assign
l_int|0
suffix:semicolon
r_int
id|filter_count
suffix:semicolon
r_int
id|flags
suffix:semicolon
r_int
id|i
comma
id|j
suffix:semicolon
r_char
id|sync_required
(braket
id|TAS3004_BIQUAD_CHANNEL_COUNT
)braket
(braket
id|TAS3004_BIQUAD_FILTER_COUNT
)braket
suffix:semicolon
r_struct
id|tas_biquad_ctrl_t
id|biquad
suffix:semicolon
id|memset
c_func
(paren
id|sync_required
comma
l_int|0
comma
r_sizeof
(paren
id|sync_required
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
(paren
r_void
op_star
)paren
op_amp
id|filter_count
comma
(paren
r_const
r_void
op_star
)paren
id|arg
op_plus
m_offsetof
(paren
r_struct
id|tas_biquad_ctrl_list_t
comma
id|filter_count
)paren
comma
r_sizeof
(paren
r_int
)paren
)paren
)paren
(brace
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
(paren
r_void
op_star
)paren
op_amp
id|flags
comma
(paren
r_const
r_void
op_star
)paren
id|arg
op_plus
m_offsetof
(paren
r_struct
id|tas_biquad_ctrl_list_t
comma
id|flags
)paren
comma
r_sizeof
(paren
r_int
)paren
)paren
)paren
(brace
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
r_if
c_cond
(paren
id|cmd
op_amp
id|SIOC_IN
)paren
(brace
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|filter_count
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
(paren
r_void
op_star
)paren
op_amp
id|biquad
comma
(paren
r_const
r_void
op_star
)paren
id|arg
op_plus
m_offsetof
(paren
r_struct
id|tas_biquad_ctrl_list_t
comma
id|biquads
(braket
id|i
)braket
)paren
comma
r_sizeof
(paren
r_struct
id|tas_biquad_ctrl_t
)paren
)paren
)paren
(brace
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
r_if
c_cond
(paren
id|cmd
op_amp
id|SIOC_IN
)paren
(brace
id|sync_required
(braket
id|biquad.channel
)braket
(braket
id|biquad.filter
)braket
op_assign
l_int|1
suffix:semicolon
id|rc
op_assign
id|tas3004_write_biquad_shadow
c_func
(paren
id|self
comma
id|biquad.channel
comma
id|biquad.filter
comma
op_amp
id|biquad.data
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rc
op_ne
l_int|0
)paren
r_return
id|rc
suffix:semicolon
)brace
r_if
c_cond
(paren
id|cmd
op_amp
id|SIOC_OUT
)paren
(brace
id|rc
op_assign
id|tas3004_read_biquad
c_func
(paren
id|self
comma
id|biquad.channel
comma
id|biquad.filter
comma
op_amp
id|biquad.data
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rc
op_ne
l_int|0
)paren
r_return
id|rc
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
(paren
r_void
op_star
)paren
id|arg
op_plus
m_offsetof
(paren
r_struct
id|tas_biquad_ctrl_list_t
comma
id|biquads
(braket
id|i
)braket
)paren
comma
(paren
r_const
r_void
op_star
)paren
op_amp
id|biquad
comma
r_sizeof
(paren
r_struct
id|tas_biquad_ctrl_t
)paren
)paren
)paren
(brace
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
)brace
)brace
r_if
c_cond
(paren
id|cmd
op_amp
id|SIOC_IN
)paren
(brace
multiline_comment|/*&n;&t;&t; * This is OK for the tas3004. For the&n;&t;&t; * tas3001c, going into fast load mode causes&n;&t;&t; * the treble and bass to be reset to 0dB, and&n;&t;&t; * volume controls to be muted.&n;&t;&t; */
r_if
c_cond
(paren
id|flags
op_amp
id|TAS_BIQUAD_FAST_LOAD
)paren
id|tas3004_fast_load
c_func
(paren
id|self
comma
l_int|1
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|TAS3004_BIQUAD_CHANNEL_COUNT
suffix:semicolon
id|i
op_increment
)paren
(brace
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
id|TAS3004_BIQUAD_FILTER_COUNT
suffix:semicolon
id|j
op_increment
)paren
(brace
r_if
c_cond
(paren
id|sync_required
(braket
id|i
)braket
(braket
id|j
)braket
)paren
(brace
id|rc
op_assign
id|tas3004_sync_biquad
c_func
(paren
id|self
comma
id|i
comma
id|j
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rc
OL
l_int|0
)paren
r_goto
id|out
suffix:semicolon
)brace
)brace
)brace
id|out
suffix:colon
r_if
c_cond
(paren
id|flags
op_amp
id|TAS_BIQUAD_FAST_LOAD
)paren
id|tas3004_fast_load
c_func
(paren
id|self
comma
l_int|0
)paren
suffix:semicolon
)brace
r_return
id|rc
suffix:semicolon
)brace
r_static
r_int
DECL|function|tas3004_update_drce
id|tas3004_update_drce
c_func
(paren
r_struct
id|tas3004_data_t
op_star
id|self
comma
r_int
id|flags
comma
r_struct
id|tas_drce_t
op_star
id|drce
)paren
(brace
id|tas_shadow_t
op_star
id|shadow
suffix:semicolon
r_int
id|i
suffix:semicolon
id|shadow
op_assign
id|self-&gt;super.shadow
suffix:semicolon
r_if
c_cond
(paren
id|flags
op_amp
id|TAS_DRCE_ABOVE_RATIO
)paren
(brace
id|self-&gt;drce_state.above.expand
op_assign
id|drce-&gt;above.expand
suffix:semicolon
r_if
c_cond
(paren
id|drce-&gt;above.val
op_eq
(paren
l_int|1
op_lshift
l_int|8
)paren
)paren
(brace
id|self-&gt;drce_state.above.val
op_assign
l_int|1
op_lshift
l_int|8
suffix:semicolon
id|shadow
(braket
id|TAS3004_REG_DRC
)braket
(braket
l_int|0
)braket
op_assign
l_int|0x02
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|drce-&gt;above.expand
)paren
(brace
id|i
op_assign
id|above_threshold_expansion_index
c_func
(paren
id|drce-&gt;above.val
)paren
suffix:semicolon
id|self-&gt;drce_state.above.val
op_assign
id|above_threshold_expansion_ratio
(braket
id|i
)braket
suffix:semicolon
id|shadow
(braket
id|TAS3004_REG_DRC
)braket
(braket
l_int|0
)braket
op_assign
l_int|0x0a
op_plus
(paren
id|i
op_lshift
l_int|3
)paren
suffix:semicolon
)brace
r_else
(brace
id|i
op_assign
id|above_threshold_compression_index
c_func
(paren
id|drce-&gt;above.val
)paren
suffix:semicolon
id|self-&gt;drce_state.above.val
op_assign
id|above_threshold_compression_ratio
(braket
id|i
)braket
suffix:semicolon
id|shadow
(braket
id|TAS3004_REG_DRC
)braket
(braket
l_int|0
)braket
op_assign
l_int|0x08
op_plus
(paren
id|i
op_lshift
l_int|3
)paren
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|flags
op_amp
id|TAS_DRCE_BELOW_RATIO
)paren
(brace
id|self-&gt;drce_state.below.expand
op_assign
id|drce-&gt;below.expand
suffix:semicolon
r_if
c_cond
(paren
id|drce-&gt;below.val
op_eq
(paren
l_int|1
op_lshift
l_int|8
)paren
)paren
(brace
id|self-&gt;drce_state.below.val
op_assign
l_int|1
op_lshift
l_int|8
suffix:semicolon
id|shadow
(braket
id|TAS3004_REG_DRC
)braket
(braket
l_int|1
)braket
op_assign
l_int|0x02
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|drce-&gt;below.expand
)paren
(brace
id|i
op_assign
id|below_threshold_expansion_index
c_func
(paren
id|drce-&gt;below.val
)paren
suffix:semicolon
id|self-&gt;drce_state.below.val
op_assign
id|below_threshold_expansion_ratio
(braket
id|i
)braket
suffix:semicolon
id|shadow
(braket
id|TAS3004_REG_DRC
)braket
(braket
l_int|1
)braket
op_assign
l_int|0x08
op_plus
(paren
id|i
op_lshift
l_int|3
)paren
suffix:semicolon
)brace
r_else
(brace
id|i
op_assign
id|below_threshold_compression_index
c_func
(paren
id|drce-&gt;below.val
)paren
suffix:semicolon
id|self-&gt;drce_state.below.val
op_assign
id|below_threshold_compression_ratio
(braket
id|i
)braket
suffix:semicolon
id|shadow
(braket
id|TAS3004_REG_DRC
)braket
(braket
l_int|1
)braket
op_assign
l_int|0x0a
op_plus
(paren
id|i
op_lshift
l_int|3
)paren
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|flags
op_amp
id|TAS_DRCE_THRESHOLD
)paren
(brace
id|self-&gt;drce_state.threshold
op_assign
id|quantize_db
c_func
(paren
id|drce-&gt;threshold
)paren
suffix:semicolon
id|shadow
(braket
id|TAS3004_REG_DRC
)braket
(braket
l_int|2
)braket
op_assign
id|db_to_regval
c_func
(paren
id|self-&gt;drce_state.threshold
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|flags
op_amp
id|TAS_DRCE_ENERGY
)paren
(brace
id|i
op_assign
id|time_index
c_func
(paren
id|drce-&gt;energy
)paren
suffix:semicolon
id|self-&gt;drce_state.energy
op_assign
id|time_constants
(braket
id|i
)braket
suffix:semicolon
id|shadow
(braket
id|TAS3004_REG_DRC
)braket
(braket
l_int|3
)braket
op_assign
l_int|0x40
op_plus
(paren
id|i
op_lshift
l_int|4
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|flags
op_amp
id|TAS_DRCE_ATTACK
)paren
(brace
id|i
op_assign
id|time_index
c_func
(paren
id|drce-&gt;attack
)paren
suffix:semicolon
id|self-&gt;drce_state.attack
op_assign
id|time_constants
(braket
id|i
)braket
suffix:semicolon
id|shadow
(braket
id|TAS3004_REG_DRC
)braket
(braket
l_int|4
)braket
op_assign
l_int|0x40
op_plus
(paren
id|i
op_lshift
l_int|4
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|flags
op_amp
id|TAS_DRCE_DECAY
)paren
(brace
id|i
op_assign
id|time_index
c_func
(paren
id|drce-&gt;decay
)paren
suffix:semicolon
id|self-&gt;drce_state.decay
op_assign
id|time_constants
(braket
id|i
)braket
suffix:semicolon
id|shadow
(braket
id|TAS3004_REG_DRC
)braket
(braket
l_int|5
)braket
op_assign
l_int|0x40
op_plus
(paren
id|i
op_lshift
l_int|4
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|flags
op_amp
id|TAS_DRCE_ENABLE
)paren
(brace
id|self-&gt;drce_state.enable
op_assign
id|drce-&gt;enable
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|self-&gt;drce_state.enable
)paren
(brace
id|shadow
(braket
id|TAS3004_REG_DRC
)braket
(braket
l_int|0
)braket
op_or_assign
l_int|0x01
suffix:semicolon
)brace
macro_line|#ifdef DEBUG_DRCE
id|printk
c_func
(paren
l_string|&quot;DRCE: set [ ENABLE:%x ABOVE:%x/%x BELOW:%x/%x THRESH:%x ENERGY:%x ATTACK:%x DECAY:%x&bslash;n&quot;
comma
id|self-&gt;drce_state.enable
comma
id|self-&gt;drce_state.above.expand
comma
id|self-&gt;drce_state.above.val
comma
id|self-&gt;drce_state.below.expand
comma
id|self-&gt;drce_state.below.val
comma
id|self-&gt;drce_state.threshold
comma
id|self-&gt;drce_state.energy
comma
id|self-&gt;drce_state.attack
comma
id|self-&gt;drce_state.decay
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;DRCE: reg [ %02x %02x %02x %02x %02x %02x ]&bslash;n&quot;
comma
(paren
r_int
r_char
)paren
id|shadow
(braket
id|TAS3004_REG_DRC
)braket
(braket
l_int|0
)braket
comma
(paren
r_int
r_char
)paren
id|shadow
(braket
id|TAS3004_REG_DRC
)braket
(braket
l_int|1
)braket
comma
(paren
r_int
r_char
)paren
id|shadow
(braket
id|TAS3004_REG_DRC
)braket
(braket
l_int|2
)braket
comma
(paren
r_int
r_char
)paren
id|shadow
(braket
id|TAS3004_REG_DRC
)braket
(braket
l_int|3
)braket
comma
(paren
r_int
r_char
)paren
id|shadow
(braket
id|TAS3004_REG_DRC
)braket
(braket
l_int|4
)braket
comma
(paren
r_int
r_char
)paren
id|shadow
(braket
id|TAS3004_REG_DRC
)braket
(braket
l_int|5
)braket
)paren
suffix:semicolon
macro_line|#endif
r_return
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_DRC
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|tas3004_drce_rw
id|tas3004_drce_rw
c_func
(paren
r_struct
id|tas3004_data_t
op_star
id|self
comma
id|u_int
id|cmd
comma
id|u_long
id|arg
)paren
(brace
r_int
id|rc
suffix:semicolon
r_struct
id|tas_drce_ctrl_t
id|drce_ctrl
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
(paren
r_void
op_star
)paren
op_amp
id|drce_ctrl
comma
(paren
r_const
r_void
op_star
)paren
id|arg
comma
r_sizeof
(paren
r_struct
id|tas_drce_ctrl_t
)paren
)paren
)paren
(brace
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
macro_line|#ifdef DEBUG_DRCE
id|printk
c_func
(paren
l_string|&quot;DRCE: input [ FLAGS:%x ENABLE:%x ABOVE:%x/%x BELOW:%x/%x THRESH:%x ENERGY:%x ATTACK:%x DECAY:%x&bslash;n&quot;
comma
id|drce_ctrl.flags
comma
id|drce_ctrl.data.enable
comma
id|drce_ctrl.data.above.expand
comma
id|drce_ctrl.data.above.val
comma
id|drce_ctrl.data.below.expand
comma
id|drce_ctrl.data.below.val
comma
id|drce_ctrl.data.threshold
comma
id|drce_ctrl.data.energy
comma
id|drce_ctrl.data.attack
comma
id|drce_ctrl.data.decay
)paren
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
id|cmd
op_amp
id|SIOC_IN
)paren
(brace
id|rc
op_assign
id|tas3004_update_drce
c_func
(paren
id|self
comma
id|drce_ctrl.flags
comma
op_amp
id|drce_ctrl.data
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rc
OL
l_int|0
)paren
r_return
id|rc
suffix:semicolon
)brace
r_if
c_cond
(paren
id|cmd
op_amp
id|SIOC_OUT
)paren
(brace
r_if
c_cond
(paren
id|drce_ctrl.flags
op_amp
id|TAS_DRCE_ENABLE
)paren
id|drce_ctrl.data.enable
op_assign
id|self-&gt;drce_state.enable
suffix:semicolon
r_if
c_cond
(paren
id|drce_ctrl.flags
op_amp
id|TAS_DRCE_ABOVE_RATIO
)paren
id|drce_ctrl.data.above
op_assign
id|self-&gt;drce_state.above
suffix:semicolon
r_if
c_cond
(paren
id|drce_ctrl.flags
op_amp
id|TAS_DRCE_BELOW_RATIO
)paren
id|drce_ctrl.data.below
op_assign
id|self-&gt;drce_state.below
suffix:semicolon
r_if
c_cond
(paren
id|drce_ctrl.flags
op_amp
id|TAS_DRCE_THRESHOLD
)paren
id|drce_ctrl.data.threshold
op_assign
id|self-&gt;drce_state.threshold
suffix:semicolon
r_if
c_cond
(paren
id|drce_ctrl.flags
op_amp
id|TAS_DRCE_ENERGY
)paren
id|drce_ctrl.data.energy
op_assign
id|self-&gt;drce_state.energy
suffix:semicolon
r_if
c_cond
(paren
id|drce_ctrl.flags
op_amp
id|TAS_DRCE_ATTACK
)paren
id|drce_ctrl.data.attack
op_assign
id|self-&gt;drce_state.attack
suffix:semicolon
r_if
c_cond
(paren
id|drce_ctrl.flags
op_amp
id|TAS_DRCE_DECAY
)paren
id|drce_ctrl.data.decay
op_assign
id|self-&gt;drce_state.decay
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
(paren
r_void
op_star
)paren
id|arg
comma
(paren
r_const
r_void
op_star
)paren
op_amp
id|drce_ctrl
comma
r_sizeof
(paren
r_struct
id|tas_drce_ctrl_t
)paren
)paren
)paren
(brace
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_void
DECL|function|tas3004_update_device_parameters
id|tas3004_update_device_parameters
c_func
(paren
r_struct
id|tas3004_data_t
op_star
id|self
)paren
(brace
r_char
id|data
suffix:semicolon
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|self
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|self-&gt;output_id
op_eq
id|TAS_OUTPUT_HEADPHONES
)paren
(brace
multiline_comment|/* turn on allPass when headphones are plugged in */
id|data
op_assign
l_int|0x02
suffix:semicolon
)brace
r_else
(brace
id|data
op_assign
l_int|0x00
suffix:semicolon
)brace
id|tas3004_write_register
c_func
(paren
id|self
comma
id|TAS3004_REG_MCR2
comma
op_amp
id|data
comma
id|WRITE_NORMAL
op_or
id|FORCE_WRITE
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|tas3004_eq_prefs
(braket
id|i
)braket
suffix:semicolon
id|i
op_increment
)paren
(brace
r_struct
id|tas_eq_pref_t
op_star
id|eq
op_assign
id|tas3004_eq_prefs
(braket
id|i
)braket
suffix:semicolon
r_if
c_cond
(paren
id|eq-&gt;device_id
op_eq
id|self-&gt;device_id
op_logical_and
(paren
id|eq-&gt;output_id
op_eq
l_int|0
op_logical_or
id|eq-&gt;output_id
op_eq
id|self-&gt;output_id
)paren
op_logical_and
(paren
id|eq-&gt;speaker_id
op_eq
l_int|0
op_logical_or
id|eq-&gt;speaker_id
op_eq
id|self-&gt;speaker_id
)paren
)paren
(brace
id|tas3004_update_drce
c_func
(paren
id|self
comma
id|TAS_DRCE_ALL
comma
id|eq-&gt;drce
)paren
suffix:semicolon
id|tas3004_write_biquad_list
c_func
(paren
id|self
comma
id|eq-&gt;filter_count
comma
id|TAS_BIQUAD_FAST_LOAD
comma
id|eq-&gt;biquads
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
)brace
r_static
r_void
DECL|function|tas3004_device_change_handler
id|tas3004_device_change_handler
c_func
(paren
r_void
op_star
id|self
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|self
)paren
r_return
suffix:semicolon
id|tas3004_update_device_parameters
c_func
(paren
(paren
r_struct
id|tas3004_data_t
op_star
)paren
id|self
)paren
suffix:semicolon
)brace
DECL|variable|device_change
r_static
r_struct
id|work_struct
id|device_change
suffix:semicolon
r_static
r_int
DECL|function|tas3004_output_device_change
id|tas3004_output_device_change
c_func
(paren
r_struct
id|tas3004_data_t
op_star
id|self
comma
r_int
id|device_id
comma
r_int
id|output_id
comma
r_int
id|speaker_id
)paren
(brace
id|self-&gt;device_id
op_assign
id|device_id
suffix:semicolon
id|self-&gt;output_id
op_assign
id|output_id
suffix:semicolon
id|self-&gt;speaker_id
op_assign
id|speaker_id
suffix:semicolon
id|schedule_work
c_func
(paren
op_amp
id|device_change
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|tas3004_device_ioctl
id|tas3004_device_ioctl
c_func
(paren
r_struct
id|tas3004_data_t
op_star
id|self
comma
id|u_int
id|cmd
comma
id|u_long
id|arg
)paren
(brace
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|TAS_READ_EQ
suffix:colon
r_case
id|TAS_WRITE_EQ
suffix:colon
r_return
id|tas3004_eq_rw
c_func
(paren
id|self
comma
id|cmd
comma
id|arg
)paren
suffix:semicolon
r_case
id|TAS_READ_EQ_LIST
suffix:colon
r_case
id|TAS_WRITE_EQ_LIST
suffix:colon
r_return
id|tas3004_eq_list_rw
c_func
(paren
id|self
comma
id|cmd
comma
id|arg
)paren
suffix:semicolon
r_case
id|TAS_READ_EQ_FILTER_COUNT
suffix:colon
id|put_user
c_func
(paren
id|TAS3004_BIQUAD_FILTER_COUNT
comma
(paren
id|uint
op_star
)paren
(paren
id|arg
)paren
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_case
id|TAS_READ_EQ_CHANNEL_COUNT
suffix:colon
id|put_user
c_func
(paren
id|TAS3004_BIQUAD_CHANNEL_COUNT
comma
(paren
id|uint
op_star
)paren
(paren
id|arg
)paren
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_case
id|TAS_READ_DRCE
suffix:colon
r_case
id|TAS_WRITE_DRCE
suffix:colon
r_return
id|tas3004_drce_rw
c_func
(paren
id|self
comma
id|cmd
comma
id|arg
)paren
suffix:semicolon
r_case
id|TAS_READ_DRCE_CAPS
suffix:colon
id|put_user
c_func
(paren
id|TAS_DRCE_ENABLE
op_or
id|TAS_DRCE_ABOVE_RATIO
op_or
id|TAS_DRCE_BELOW_RATIO
op_or
id|TAS_DRCE_THRESHOLD
op_or
id|TAS_DRCE_ENERGY
op_or
id|TAS_DRCE_ATTACK
op_or
id|TAS_DRCE_DECAY
comma
(paren
id|uint
op_star
)paren
(paren
id|arg
)paren
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_case
id|TAS_READ_DRCE_MIN
suffix:colon
r_case
id|TAS_READ_DRCE_MAX
suffix:colon
(brace
r_struct
id|tas_drce_ctrl_t
id|drce_ctrl
suffix:semicolon
r_const
r_struct
id|tas_drce_t
op_star
id|drce_copy
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
(paren
r_void
op_star
)paren
op_amp
id|drce_ctrl
comma
(paren
r_const
r_void
op_star
)paren
id|arg
comma
r_sizeof
(paren
r_struct
id|tas_drce_ctrl_t
)paren
)paren
)paren
(brace
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
r_if
c_cond
(paren
id|cmd
op_eq
id|TAS_READ_DRCE_MIN
)paren
(brace
id|drce_copy
op_assign
op_amp
id|tas3004_drce_min
suffix:semicolon
)brace
r_else
(brace
id|drce_copy
op_assign
op_amp
id|tas3004_drce_max
suffix:semicolon
)brace
r_if
c_cond
(paren
id|drce_ctrl.flags
op_amp
id|TAS_DRCE_ABOVE_RATIO
)paren
(brace
id|drce_ctrl.data.above
op_assign
id|drce_copy-&gt;above
suffix:semicolon
)brace
r_if
c_cond
(paren
id|drce_ctrl.flags
op_amp
id|TAS_DRCE_BELOW_RATIO
)paren
(brace
id|drce_ctrl.data.below
op_assign
id|drce_copy-&gt;below
suffix:semicolon
)brace
r_if
c_cond
(paren
id|drce_ctrl.flags
op_amp
id|TAS_DRCE_THRESHOLD
)paren
(brace
id|drce_ctrl.data.threshold
op_assign
id|drce_copy-&gt;threshold
suffix:semicolon
)brace
r_if
c_cond
(paren
id|drce_ctrl.flags
op_amp
id|TAS_DRCE_ENERGY
)paren
(brace
id|drce_ctrl.data.energy
op_assign
id|drce_copy-&gt;energy
suffix:semicolon
)brace
r_if
c_cond
(paren
id|drce_ctrl.flags
op_amp
id|TAS_DRCE_ATTACK
)paren
(brace
id|drce_ctrl.data.attack
op_assign
id|drce_copy-&gt;attack
suffix:semicolon
)brace
r_if
c_cond
(paren
id|drce_ctrl.flags
op_amp
id|TAS_DRCE_DECAY
)paren
(brace
id|drce_ctrl.data.decay
op_assign
id|drce_copy-&gt;decay
suffix:semicolon
)brace
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
(paren
r_void
op_star
)paren
id|arg
comma
(paren
r_const
r_void
op_star
)paren
op_amp
id|drce_ctrl
comma
r_sizeof
(paren
r_struct
id|tas_drce_ctrl_t
)paren
)paren
)paren
(brace
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
)brace
)brace
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_static
r_int
DECL|function|tas3004_init_mixer
id|tas3004_init_mixer
c_func
(paren
r_struct
id|tas3004_data_t
op_star
id|self
)paren
(brace
r_int
r_char
id|mcr
op_assign
(paren
l_int|1
op_lshift
l_int|6
)paren
op_plus
(paren
l_int|2
op_lshift
l_int|4
)paren
op_plus
(paren
l_int|2
op_lshift
l_int|2
)paren
suffix:semicolon
multiline_comment|/* Make sure something answers on the i2c bus */
r_if
c_cond
(paren
id|tas3004_write_register
c_func
(paren
id|self
comma
id|TAS3004_REG_MCR
comma
op_amp
id|mcr
comma
id|WRITE_NORMAL
op_or
id|FORCE_WRITE
)paren
OL
l_int|0
)paren
r_return
op_minus
l_int|1
suffix:semicolon
id|tas3004_fast_load
c_func
(paren
id|self
comma
l_int|1
)paren
suffix:semicolon
(paren
r_void
)paren
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_RIGHT_BIQUAD0
)paren
suffix:semicolon
(paren
r_void
)paren
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_RIGHT_BIQUAD1
)paren
suffix:semicolon
(paren
r_void
)paren
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_RIGHT_BIQUAD2
)paren
suffix:semicolon
(paren
r_void
)paren
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_RIGHT_BIQUAD3
)paren
suffix:semicolon
(paren
r_void
)paren
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_RIGHT_BIQUAD4
)paren
suffix:semicolon
(paren
r_void
)paren
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_RIGHT_BIQUAD5
)paren
suffix:semicolon
(paren
r_void
)paren
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_RIGHT_BIQUAD6
)paren
suffix:semicolon
(paren
r_void
)paren
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_LEFT_BIQUAD0
)paren
suffix:semicolon
(paren
r_void
)paren
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_LEFT_BIQUAD1
)paren
suffix:semicolon
(paren
r_void
)paren
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_LEFT_BIQUAD2
)paren
suffix:semicolon
(paren
r_void
)paren
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_LEFT_BIQUAD3
)paren
suffix:semicolon
(paren
r_void
)paren
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_LEFT_BIQUAD4
)paren
suffix:semicolon
(paren
r_void
)paren
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_LEFT_BIQUAD5
)paren
suffix:semicolon
(paren
r_void
)paren
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_LEFT_BIQUAD6
)paren
suffix:semicolon
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_DRC
)paren
suffix:semicolon
id|tas3004_sync_register
c_func
(paren
id|self
comma
id|TAS3004_REG_MCR2
)paren
suffix:semicolon
id|tas3004_fast_load
c_func
(paren
id|self
comma
l_int|0
)paren
suffix:semicolon
id|tas3004_set_mixer_level
c_func
(paren
id|self
comma
id|SOUND_MIXER_VOLUME
comma
id|VOL_DEFAULT
op_lshift
l_int|8
op_or
id|VOL_DEFAULT
)paren
suffix:semicolon
id|tas3004_set_mixer_level
c_func
(paren
id|self
comma
id|SOUND_MIXER_PCM
comma
id|INPUT_DEFAULT
op_lshift
l_int|8
op_or
id|INPUT_DEFAULT
)paren
suffix:semicolon
id|tas3004_set_mixer_level
c_func
(paren
id|self
comma
id|SOUND_MIXER_ALTPCM
comma
l_int|0
)paren
suffix:semicolon
id|tas3004_set_mixer_level
c_func
(paren
id|self
comma
id|SOUND_MIXER_IMIX
comma
l_int|0
)paren
suffix:semicolon
id|tas3004_set_mixer_level
c_func
(paren
id|self
comma
id|SOUND_MIXER_BASS
comma
id|BASS_DEFAULT
)paren
suffix:semicolon
id|tas3004_set_mixer_level
c_func
(paren
id|self
comma
id|SOUND_MIXER_TREBLE
comma
id|TREBLE_DEFAULT
)paren
suffix:semicolon
id|tas3004_set_mixer_level
c_func
(paren
id|self
comma
id|SOUND_MIXER_LINE
comma
id|SW_INPUT_VOLUME_DEFAULT
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|tas3004_uninit_mixer
id|tas3004_uninit_mixer
c_func
(paren
r_struct
id|tas3004_data_t
op_star
id|self
)paren
(brace
id|tas3004_set_mixer_level
c_func
(paren
id|self
comma
id|SOUND_MIXER_VOLUME
comma
l_int|0
)paren
suffix:semicolon
id|tas3004_set_mixer_level
c_func
(paren
id|self
comma
id|SOUND_MIXER_PCM
comma
l_int|0
)paren
suffix:semicolon
id|tas3004_set_mixer_level
c_func
(paren
id|self
comma
id|SOUND_MIXER_ALTPCM
comma
l_int|0
)paren
suffix:semicolon
id|tas3004_set_mixer_level
c_func
(paren
id|self
comma
id|SOUND_MIXER_IMIX
comma
l_int|0
)paren
suffix:semicolon
id|tas3004_set_mixer_level
c_func
(paren
id|self
comma
id|SOUND_MIXER_BASS
comma
l_int|0
)paren
suffix:semicolon
id|tas3004_set_mixer_level
c_func
(paren
id|self
comma
id|SOUND_MIXER_TREBLE
comma
l_int|0
)paren
suffix:semicolon
id|tas3004_set_mixer_level
c_func
(paren
id|self
comma
id|SOUND_MIXER_LINE
comma
l_int|0
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|tas3004_init
id|tas3004_init
c_func
(paren
r_struct
id|i2c_client
op_star
id|client
)paren
(brace
r_struct
id|tas3004_data_t
op_star
id|self
suffix:semicolon
r_int
id|sz
op_assign
r_sizeof
(paren
op_star
id|self
)paren
op_plus
(paren
id|TAS3004_REG_MAX
op_star
r_sizeof
(paren
id|tas_shadow_t
)paren
)paren
suffix:semicolon
r_char
id|drce_init
(braket
)braket
op_assign
(brace
l_int|0x69
comma
l_int|0x22
comma
l_int|0x9f
comma
l_int|0xb0
comma
l_int|0x60
comma
l_int|0xa0
)brace
suffix:semicolon
r_char
id|mcr2
op_assign
l_int|0
suffix:semicolon
r_int
id|i
comma
id|j
suffix:semicolon
id|self
op_assign
id|kmalloc
c_func
(paren
id|sz
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|self
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|memset
c_func
(paren
id|self
comma
l_int|0
comma
id|sz
)paren
suffix:semicolon
id|self-&gt;super.client
op_assign
id|client
suffix:semicolon
id|self-&gt;super.shadow
op_assign
(paren
id|tas_shadow_t
op_star
)paren
(paren
id|self
op_plus
l_int|1
)paren
suffix:semicolon
id|self-&gt;output_id
op_assign
id|TAS_OUTPUT_HEADPHONES
suffix:semicolon
id|dev_set_drvdata
c_func
(paren
op_amp
id|client-&gt;dev
comma
id|self
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|TAS3004_BIQUAD_CHANNEL_COUNT
suffix:semicolon
id|i
op_increment
)paren
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
id|TAS3004_BIQUAD_FILTER_COUNT
suffix:semicolon
id|j
op_increment
)paren
id|tas3004_write_biquad_shadow
c_func
(paren
id|self
comma
id|i
comma
id|j
comma
op_amp
id|tas3004_eq_unity
)paren
suffix:semicolon
id|tas3004_write_register
c_func
(paren
id|self
comma
id|TAS3004_REG_MCR2
comma
op_amp
id|mcr2
comma
id|WRITE_SHADOW
)paren
suffix:semicolon
id|tas3004_write_register
c_func
(paren
id|self
comma
id|TAS3004_REG_DRC
comma
id|drce_init
comma
id|WRITE_SHADOW
)paren
suffix:semicolon
id|INIT_WORK
c_func
(paren
op_amp
id|device_change
comma
id|tas3004_device_change_handler
comma
id|self
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_void
DECL|function|tas3004_uninit
id|tas3004_uninit
c_func
(paren
r_struct
id|tas3004_data_t
op_star
id|self
)paren
(brace
id|tas3004_uninit_mixer
c_func
(paren
id|self
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|self
)paren
suffix:semicolon
)brace
DECL|variable|tas3004_hooks
r_struct
id|tas_driver_hooks_t
id|tas3004_hooks
op_assign
(brace
dot
id|init
op_assign
(paren
id|tas_hook_init_t
)paren
id|tas3004_init
comma
dot
id|post_init
op_assign
(paren
id|tas_hook_post_init_t
)paren
id|tas3004_init_mixer
comma
dot
id|uninit
op_assign
(paren
id|tas_hook_uninit_t
)paren
id|tas3004_uninit
comma
dot
id|get_mixer_level
op_assign
(paren
id|tas_hook_get_mixer_level_t
)paren
id|tas3004_get_mixer_level
comma
dot
id|set_mixer_level
op_assign
(paren
id|tas_hook_set_mixer_level_t
)paren
id|tas3004_set_mixer_level
comma
dot
id|enter_sleep
op_assign
(paren
id|tas_hook_enter_sleep_t
)paren
id|tas3004_enter_sleep
comma
dot
id|leave_sleep
op_assign
(paren
id|tas_hook_leave_sleep_t
)paren
id|tas3004_leave_sleep
comma
dot
id|supported_mixers
op_assign
(paren
id|tas_hook_supported_mixers_t
)paren
id|tas3004_supported_mixers
comma
dot
id|mixer_is_stereo
op_assign
(paren
id|tas_hook_mixer_is_stereo_t
)paren
id|tas3004_mixer_is_stereo
comma
dot
id|stereo_mixers
op_assign
(paren
id|tas_hook_stereo_mixers_t
)paren
id|tas3004_stereo_mixers
comma
dot
id|output_device_change
op_assign
(paren
id|tas_hook_output_device_change_t
)paren
id|tas3004_output_device_change
comma
dot
id|device_ioctl
op_assign
(paren
id|tas_hook_device_ioctl_t
)paren
id|tas3004_device_ioctl
)brace
suffix:semicolon
eof
