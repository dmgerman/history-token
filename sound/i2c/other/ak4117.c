multiline_comment|/*&n; *  Routines for control of the AK4117 via 4-wire serial interface&n; *  IEC958 (S/PDIF) receiver by Asahi Kasei&n; *  Copyright (c) by Jaroslav Kysela &lt;perex@suse.cz&gt;&n; *&n; *&n; *   This program is free software; you can redistribute it and/or modify&n; *   it under the terms of the GNU General Public License as published by&n; *   the Free Software Foundation; either version 2 of the License, or&n; *   (at your option) any later version.&n; *&n; *   This program is distributed in the hope that it will be useful,&n; *   but WITHOUT ANY WARRANTY; without even the implied warranty of&n; *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; *   GNU General Public License for more details.&n; *&n; *   You should have received a copy of the GNU General Public License&n; *   along with this program; if not, write to the Free Software&n; *   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA&n; *&n; */
macro_line|#include &lt;sound/driver.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;linux/delay.h&gt;
macro_line|#include &lt;sound/core.h&gt;
macro_line|#include &lt;sound/control.h&gt;
macro_line|#include &lt;sound/pcm.h&gt;
macro_line|#include &lt;sound/ak4117.h&gt;
macro_line|#include &lt;sound/asoundef.h&gt;
id|MODULE_AUTHOR
c_func
(paren
l_string|&quot;Jaroslav Kysela &lt;perex@suse.cz&gt;&quot;
)paren
suffix:semicolon
id|MODULE_DESCRIPTION
c_func
(paren
l_string|&quot;AK4117 IEC958 (S/PDIF) receiver by Asahi Kasei&quot;
)paren
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
DECL|macro|AK4117_ADDR
mdefine_line|#define AK4117_ADDR&t;&t;&t;0x00 /* fixed address */
r_static
r_void
id|snd_ak4117_timer
c_func
(paren
r_int
r_int
id|data
)paren
suffix:semicolon
DECL|function|reg_write
r_static
r_void
id|reg_write
c_func
(paren
id|ak4117_t
op_star
id|ak4117
comma
r_int
r_char
id|reg
comma
r_int
r_char
id|val
)paren
(brace
id|ak4117
op_member_access_from_pointer
id|write
c_func
(paren
id|ak4117-&gt;private_data
comma
id|reg
comma
id|val
)paren
suffix:semicolon
r_if
c_cond
(paren
id|reg
OL
r_sizeof
(paren
id|ak4117-&gt;regmap
)paren
)paren
id|ak4117-&gt;regmap
(braket
id|reg
)braket
op_assign
id|val
suffix:semicolon
)brace
DECL|function|reg_read
r_static
r_inline
r_int
r_char
id|reg_read
c_func
(paren
id|ak4117_t
op_star
id|ak4117
comma
r_int
r_char
id|reg
)paren
(brace
r_return
id|ak4117
op_member_access_from_pointer
id|read
c_func
(paren
id|ak4117-&gt;private_data
comma
id|reg
)paren
suffix:semicolon
)brace
macro_line|#if 0
r_static
r_void
id|reg_dump
c_func
(paren
id|ak4117_t
op_star
id|ak4117
)paren
(brace
r_int
id|i
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;AK4117 REG DUMP:&bslash;n&quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|0x1b
suffix:semicolon
id|i
op_increment
)paren
id|printk
c_func
(paren
l_string|&quot;reg[%02x] = %02x (%02x)&bslash;n&quot;
comma
id|i
comma
id|reg_read
c_func
(paren
id|ak4117
comma
id|i
)paren
comma
id|i
OL
r_sizeof
(paren
id|ak4117-&gt;regmap
)paren
ques
c_cond
id|ak4117-&gt;regmap
(braket
id|i
)braket
suffix:colon
l_int|0
)paren
suffix:semicolon
)brace
macro_line|#endif
DECL|function|snd_ak4117_free
r_static
r_void
id|snd_ak4117_free
c_func
(paren
id|ak4117_t
op_star
id|chip
)paren
(brace
id|del_timer
c_func
(paren
op_amp
id|chip-&gt;timer
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|chip
)paren
suffix:semicolon
)brace
DECL|function|snd_ak4117_dev_free
r_static
r_int
id|snd_ak4117_dev_free
c_func
(paren
id|snd_device_t
op_star
id|device
)paren
(brace
id|ak4117_t
op_star
id|chip
op_assign
id|device-&gt;device_data
suffix:semicolon
id|snd_ak4117_free
c_func
(paren
id|chip
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ak4117_create
r_int
id|snd_ak4117_create
c_func
(paren
id|snd_card_t
op_star
id|card
comma
id|ak4117_read_t
op_star
id|read
comma
id|ak4117_write_t
op_star
id|write
comma
r_int
r_char
id|pgm
(braket
l_int|5
)braket
comma
r_void
op_star
id|private_data
comma
id|ak4117_t
op_star
op_star
id|r_ak4117
)paren
(brace
id|ak4117_t
op_star
id|chip
suffix:semicolon
r_int
id|err
op_assign
l_int|0
suffix:semicolon
r_int
r_char
id|reg
suffix:semicolon
r_static
id|snd_device_ops_t
id|ops
op_assign
(brace
dot
id|dev_free
op_assign
id|snd_ak4117_dev_free
comma
)brace
suffix:semicolon
id|chip
op_assign
id|kcalloc
c_func
(paren
l_int|1
comma
r_sizeof
(paren
op_star
id|chip
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chip
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|spin_lock_init
c_func
(paren
op_amp
id|chip-&gt;lock
)paren
suffix:semicolon
id|chip-&gt;card
op_assign
id|card
suffix:semicolon
id|chip-&gt;read
op_assign
id|read
suffix:semicolon
id|chip-&gt;write
op_assign
id|write
suffix:semicolon
id|chip-&gt;private_data
op_assign
id|private_data
suffix:semicolon
id|init_timer
c_func
(paren
op_amp
id|chip-&gt;timer
)paren
suffix:semicolon
id|chip-&gt;timer.data
op_assign
(paren
r_int
r_int
)paren
id|chip
suffix:semicolon
id|chip-&gt;timer.function
op_assign
id|snd_ak4117_timer
suffix:semicolon
r_for
c_loop
(paren
id|reg
op_assign
l_int|0
suffix:semicolon
id|reg
OL
l_int|5
suffix:semicolon
id|reg
op_increment
)paren
id|chip-&gt;regmap
(braket
id|reg
)braket
op_assign
id|pgm
(braket
id|reg
)braket
suffix:semicolon
id|snd_ak4117_reinit
c_func
(paren
id|chip
)paren
suffix:semicolon
id|chip-&gt;rcs0
op_assign
id|reg_read
c_func
(paren
id|chip
comma
id|AK4117_REG_RCS0
)paren
op_amp
op_complement
(paren
id|AK4117_QINT
op_or
id|AK4117_CINT
op_or
id|AK4117_STC
)paren
suffix:semicolon
id|chip-&gt;rcs1
op_assign
id|reg_read
c_func
(paren
id|chip
comma
id|AK4117_REG_RCS1
)paren
suffix:semicolon
id|chip-&gt;rcs2
op_assign
id|reg_read
c_func
(paren
id|chip
comma
id|AK4117_REG_RCS2
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_device_new
c_func
(paren
id|card
comma
id|SNDRV_DEV_CODEC
comma
id|chip
comma
op_amp
id|ops
)paren
)paren
OL
l_int|0
)paren
r_goto
id|__fail
suffix:semicolon
r_if
c_cond
(paren
id|r_ak4117
)paren
op_star
id|r_ak4117
op_assign
id|chip
suffix:semicolon
r_return
l_int|0
suffix:semicolon
id|__fail
suffix:colon
id|snd_ak4117_free
c_func
(paren
id|chip
)paren
suffix:semicolon
r_return
id|err
OL
l_int|0
ques
c_cond
id|err
suffix:colon
op_minus
id|EIO
suffix:semicolon
)brace
DECL|function|snd_ak4117_reg_write
r_void
id|snd_ak4117_reg_write
c_func
(paren
id|ak4117_t
op_star
id|chip
comma
r_int
r_char
id|reg
comma
r_int
r_char
id|mask
comma
r_int
r_char
id|val
)paren
(brace
r_if
c_cond
(paren
id|reg
op_ge
l_int|5
)paren
r_return
suffix:semicolon
id|reg_write
c_func
(paren
id|chip
comma
id|reg
comma
(paren
id|chip-&gt;regmap
(braket
id|reg
)braket
op_amp
op_complement
id|mask
)paren
op_or
id|val
)paren
suffix:semicolon
)brace
DECL|function|snd_ak4117_reinit
r_void
id|snd_ak4117_reinit
c_func
(paren
id|ak4117_t
op_star
id|chip
)paren
(brace
r_int
r_char
id|old
op_assign
id|chip-&gt;regmap
(braket
id|AK4117_REG_PWRDN
)braket
comma
id|reg
suffix:semicolon
id|del_timer
c_func
(paren
op_amp
id|chip-&gt;timer
)paren
suffix:semicolon
id|chip-&gt;init
op_assign
l_int|1
suffix:semicolon
multiline_comment|/* bring the chip to reset state and powerdown state */
id|reg_write
c_func
(paren
id|chip
comma
id|AK4117_REG_PWRDN
comma
l_int|0
)paren
suffix:semicolon
id|udelay
c_func
(paren
l_int|200
)paren
suffix:semicolon
multiline_comment|/* release reset, but leave powerdown */
id|reg_write
c_func
(paren
id|chip
comma
id|AK4117_REG_PWRDN
comma
(paren
id|old
op_or
id|AK4117_RST
)paren
op_amp
op_complement
id|AK4117_PWN
)paren
suffix:semicolon
id|udelay
c_func
(paren
l_int|200
)paren
suffix:semicolon
r_for
c_loop
(paren
id|reg
op_assign
l_int|1
suffix:semicolon
id|reg
OL
l_int|5
suffix:semicolon
id|reg
op_increment
)paren
id|reg_write
c_func
(paren
id|chip
comma
id|reg
comma
id|chip-&gt;regmap
(braket
id|reg
)braket
)paren
suffix:semicolon
multiline_comment|/* release powerdown, everything is initialized now */
id|reg_write
c_func
(paren
id|chip
comma
id|AK4117_REG_PWRDN
comma
id|old
op_or
id|AK4117_RST
op_or
id|AK4117_PWN
)paren
suffix:semicolon
id|chip-&gt;init
op_assign
l_int|0
suffix:semicolon
id|chip-&gt;timer.expires
op_assign
l_int|1
op_plus
id|jiffies
suffix:semicolon
id|add_timer
c_func
(paren
op_amp
id|chip-&gt;timer
)paren
suffix:semicolon
)brace
DECL|function|external_rate
r_static
r_int
r_int
id|external_rate
c_func
(paren
r_int
r_char
id|rcs1
)paren
(brace
r_switch
c_cond
(paren
id|rcs1
op_amp
(paren
id|AK4117_FS0
op_or
id|AK4117_FS1
op_or
id|AK4117_FS2
op_or
id|AK4117_FS3
)paren
)paren
(brace
r_case
id|AK4117_FS_32000HZ
suffix:colon
r_return
l_int|32000
suffix:semicolon
r_case
id|AK4117_FS_44100HZ
suffix:colon
r_return
l_int|44100
suffix:semicolon
r_case
id|AK4117_FS_48000HZ
suffix:colon
r_return
l_int|48000
suffix:semicolon
r_case
id|AK4117_FS_88200HZ
suffix:colon
r_return
l_int|88200
suffix:semicolon
r_case
id|AK4117_FS_96000HZ
suffix:colon
r_return
l_int|96000
suffix:semicolon
r_case
id|AK4117_FS_176400HZ
suffix:colon
r_return
l_int|176400
suffix:semicolon
r_case
id|AK4117_FS_192000HZ
suffix:colon
r_return
l_int|192000
suffix:semicolon
r_default
suffix:colon
r_return
l_int|0
suffix:semicolon
)brace
)brace
DECL|function|snd_ak4117_in_error_info
r_static
r_int
id|snd_ak4117_in_error_info
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_INTEGER
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
id|uinfo-&gt;value.integer.min
op_assign
l_int|0
suffix:semicolon
id|uinfo-&gt;value.integer.max
op_assign
id|LONG_MAX
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ak4117_in_error_get
r_static
r_int
id|snd_ak4117_in_error_get
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|ak4117_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
op_star
id|ptr
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|chip-&gt;lock
)paren
suffix:semicolon
id|ptr
op_assign
(paren
r_int
op_star
)paren
(paren
(paren
(paren
r_char
op_star
)paren
id|chip
)paren
op_plus
id|kcontrol-&gt;private_value
)paren
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
op_star
id|ptr
suffix:semicolon
op_star
id|ptr
op_assign
l_int|0
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|chip-&gt;lock
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ak4117_in_bit_info
r_static
r_int
id|snd_ak4117_in_bit_info
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_BOOLEAN
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
id|uinfo-&gt;value.integer.min
op_assign
l_int|0
suffix:semicolon
id|uinfo-&gt;value.integer.max
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ak4117_in_bit_get
r_static
r_int
id|snd_ak4117_in_bit_get
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|ak4117_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_char
id|reg
op_assign
id|kcontrol-&gt;private_value
op_amp
l_int|0xff
suffix:semicolon
r_int
r_char
id|bit
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
suffix:semicolon
r_int
r_char
id|inv
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|31
)paren
op_amp
l_int|1
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
(paren
(paren
id|reg_read
c_func
(paren
id|chip
comma
id|reg
)paren
op_amp
(paren
l_int|1
op_lshift
id|bit
)paren
)paren
ques
c_cond
l_int|1
suffix:colon
l_int|0
)paren
op_xor
id|inv
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ak4117_rx_info
r_static
r_int
id|snd_ak4117_rx_info
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_INTEGER
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
id|uinfo-&gt;value.integer.min
op_assign
l_int|0
suffix:semicolon
id|uinfo-&gt;value.integer.max
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ak4117_rx_get
r_static
r_int
id|snd_ak4117_rx_get
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|ak4117_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
(paren
id|chip-&gt;regmap
(braket
id|AK4117_REG_IO
)braket
op_amp
id|AK4117_IPS
)paren
ques
c_cond
l_int|1
suffix:colon
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ak4117_rx_put
r_static
r_int
id|snd_ak4117_rx_put
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|ak4117_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|change
suffix:semicolon
id|u8
id|old_val
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|chip-&gt;lock
)paren
suffix:semicolon
id|old_val
op_assign
id|chip-&gt;regmap
(braket
id|AK4117_REG_IO
)braket
suffix:semicolon
id|change
op_assign
op_logical_neg
op_logical_neg
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_ne
(paren
(paren
id|old_val
op_amp
id|AK4117_IPS
)paren
ques
c_cond
l_int|1
suffix:colon
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|change
)paren
id|reg_write
c_func
(paren
id|chip
comma
id|AK4117_REG_IO
comma
(paren
id|old_val
op_amp
op_complement
id|AK4117_IPS
)paren
op_or
(paren
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
ques
c_cond
id|AK4117_IPS
suffix:colon
l_int|0
)paren
)paren
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|chip-&gt;lock
)paren
suffix:semicolon
r_return
id|change
suffix:semicolon
)brace
DECL|function|snd_ak4117_rate_info
r_static
r_int
id|snd_ak4117_rate_info
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_INTEGER
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
id|uinfo-&gt;value.integer.min
op_assign
l_int|0
suffix:semicolon
id|uinfo-&gt;value.integer.max
op_assign
l_int|192000
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ak4117_rate_get
r_static
r_int
id|snd_ak4117_rate_get
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|ak4117_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
id|external_rate
c_func
(paren
id|reg_read
c_func
(paren
id|chip
comma
id|AK4117_REG_RCS1
)paren
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ak4117_spdif_info
r_static
r_int
id|snd_ak4117_spdif_info
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_IEC958
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ak4117_spdif_get
r_static
r_int
id|snd_ak4117_spdif_get
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|ak4117_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|AK4117_REG_RXCSB_SIZE
suffix:semicolon
id|i
op_increment
)paren
id|ucontrol-&gt;value.iec958.status
(braket
id|i
)braket
op_assign
id|reg_read
c_func
(paren
id|chip
comma
id|AK4117_REG_RXCSB0
op_plus
id|i
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ak4117_spdif_mask_info
r_static
r_int
id|snd_ak4117_spdif_mask_info
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_IEC958
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ak4117_spdif_mask_get
r_static
r_int
id|snd_ak4117_spdif_mask_get
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|memset
c_func
(paren
id|ucontrol-&gt;value.iec958.status
comma
l_int|0xff
comma
id|AK4117_REG_RXCSB_SIZE
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ak4117_spdif_pinfo
r_static
r_int
id|snd_ak4117_spdif_pinfo
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_INTEGER
suffix:semicolon
id|uinfo-&gt;value.integer.min
op_assign
l_int|0
suffix:semicolon
id|uinfo-&gt;value.integer.max
op_assign
l_int|0xffff
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|4
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ak4117_spdif_pget
r_static
r_int
id|snd_ak4117_spdif_pget
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|ak4117_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_int
id|tmp
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
l_int|0xf8f2
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|1
)braket
op_assign
l_int|0x4e1f
suffix:semicolon
id|tmp
op_assign
id|reg_read
c_func
(paren
id|chip
comma
id|AK4117_REG_Pc0
)paren
op_or
(paren
id|reg_read
c_func
(paren
id|chip
comma
id|AK4117_REG_Pc1
)paren
op_lshift
l_int|8
)paren
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|2
)braket
op_assign
id|tmp
suffix:semicolon
id|tmp
op_assign
id|reg_read
c_func
(paren
id|chip
comma
id|AK4117_REG_Pd0
)paren
op_or
(paren
id|reg_read
c_func
(paren
id|chip
comma
id|AK4117_REG_Pd1
)paren
op_lshift
l_int|8
)paren
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|3
)braket
op_assign
id|tmp
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ak4117_spdif_qinfo
r_static
r_int
id|snd_ak4117_spdif_qinfo
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_BYTES
suffix:semicolon
id|uinfo-&gt;count
op_assign
id|AK4117_REG_QSUB_SIZE
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ak4117_spdif_qget
r_static
r_int
id|snd_ak4117_spdif_qget
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|ak4117_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|AK4117_REG_QSUB_SIZE
suffix:semicolon
id|i
op_increment
)paren
id|ucontrol-&gt;value.bytes.data
(braket
id|i
)braket
op_assign
id|reg_read
c_func
(paren
id|chip
comma
id|AK4117_REG_QSUB_ADDR
op_plus
id|i
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* Don&squot;t forget to change AK4117_CONTROLS define!!! */
DECL|variable|snd_ak4117_iec958_controls
r_static
id|snd_kcontrol_new_t
id|snd_ak4117_iec958_controls
(braket
)braket
op_assign
(brace
(brace
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_PCM
comma
dot
id|name
op_assign
l_string|&quot;IEC958 Parity Errors&quot;
comma
dot
id|access
op_assign
id|SNDRV_CTL_ELEM_ACCESS_READ
op_or
id|SNDRV_CTL_ELEM_ACCESS_VOLATILE
comma
dot
id|info
op_assign
id|snd_ak4117_in_error_info
comma
dot
id|get
op_assign
id|snd_ak4117_in_error_get
comma
dot
id|private_value
op_assign
m_offsetof
(paren
id|ak4117_t
comma
id|parity_errors
)paren
comma
)brace
comma
(brace
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_PCM
comma
dot
id|name
op_assign
l_string|&quot;IEC958 V-Bit Errors&quot;
comma
dot
id|access
op_assign
id|SNDRV_CTL_ELEM_ACCESS_READ
op_or
id|SNDRV_CTL_ELEM_ACCESS_VOLATILE
comma
dot
id|info
op_assign
id|snd_ak4117_in_error_info
comma
dot
id|get
op_assign
id|snd_ak4117_in_error_get
comma
dot
id|private_value
op_assign
m_offsetof
(paren
id|ak4117_t
comma
id|v_bit_errors
)paren
comma
)brace
comma
(brace
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_PCM
comma
dot
id|name
op_assign
l_string|&quot;IEC958 C-CRC Errors&quot;
comma
dot
id|access
op_assign
id|SNDRV_CTL_ELEM_ACCESS_READ
op_or
id|SNDRV_CTL_ELEM_ACCESS_VOLATILE
comma
dot
id|info
op_assign
id|snd_ak4117_in_error_info
comma
dot
id|get
op_assign
id|snd_ak4117_in_error_get
comma
dot
id|private_value
op_assign
m_offsetof
(paren
id|ak4117_t
comma
id|ccrc_errors
)paren
comma
)brace
comma
(brace
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_PCM
comma
dot
id|name
op_assign
l_string|&quot;IEC958 Q-CRC Errors&quot;
comma
dot
id|access
op_assign
id|SNDRV_CTL_ELEM_ACCESS_READ
op_or
id|SNDRV_CTL_ELEM_ACCESS_VOLATILE
comma
dot
id|info
op_assign
id|snd_ak4117_in_error_info
comma
dot
id|get
op_assign
id|snd_ak4117_in_error_get
comma
dot
id|private_value
op_assign
m_offsetof
(paren
id|ak4117_t
comma
id|qcrc_errors
)paren
comma
)brace
comma
(brace
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_PCM
comma
dot
id|name
op_assign
l_string|&quot;IEC958 External Rate&quot;
comma
dot
id|access
op_assign
id|SNDRV_CTL_ELEM_ACCESS_READ
op_or
id|SNDRV_CTL_ELEM_ACCESS_VOLATILE
comma
dot
id|info
op_assign
id|snd_ak4117_rate_info
comma
dot
id|get
op_assign
id|snd_ak4117_rate_get
comma
)brace
comma
(brace
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_PCM
comma
dot
id|name
op_assign
id|SNDRV_CTL_NAME_IEC958
c_func
(paren
l_string|&quot;&quot;
comma
id|CAPTURE
comma
id|MASK
)paren
comma
dot
id|access
op_assign
id|SNDRV_CTL_ELEM_ACCESS_READ
comma
dot
id|info
op_assign
id|snd_ak4117_spdif_mask_info
comma
dot
id|get
op_assign
id|snd_ak4117_spdif_mask_get
comma
)brace
comma
(brace
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_PCM
comma
dot
id|name
op_assign
id|SNDRV_CTL_NAME_IEC958
c_func
(paren
l_string|&quot;&quot;
comma
id|CAPTURE
comma
id|DEFAULT
)paren
comma
dot
id|access
op_assign
id|SNDRV_CTL_ELEM_ACCESS_READ
op_or
id|SNDRV_CTL_ELEM_ACCESS_VOLATILE
comma
dot
id|info
op_assign
id|snd_ak4117_spdif_info
comma
dot
id|get
op_assign
id|snd_ak4117_spdif_get
comma
)brace
comma
(brace
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_PCM
comma
dot
id|name
op_assign
l_string|&quot;IEC958 Preample Capture Default&quot;
comma
dot
id|access
op_assign
id|SNDRV_CTL_ELEM_ACCESS_READ
op_or
id|SNDRV_CTL_ELEM_ACCESS_VOLATILE
comma
dot
id|info
op_assign
id|snd_ak4117_spdif_pinfo
comma
dot
id|get
op_assign
id|snd_ak4117_spdif_pget
comma
)brace
comma
(brace
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_PCM
comma
dot
id|name
op_assign
l_string|&quot;IEC958 Q-subcode Capture Default&quot;
comma
dot
id|access
op_assign
id|SNDRV_CTL_ELEM_ACCESS_READ
op_or
id|SNDRV_CTL_ELEM_ACCESS_VOLATILE
comma
dot
id|info
op_assign
id|snd_ak4117_spdif_qinfo
comma
dot
id|get
op_assign
id|snd_ak4117_spdif_qget
comma
)brace
comma
(brace
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_PCM
comma
dot
id|name
op_assign
l_string|&quot;IEC958 Audio&quot;
comma
dot
id|access
op_assign
id|SNDRV_CTL_ELEM_ACCESS_READ
op_or
id|SNDRV_CTL_ELEM_ACCESS_VOLATILE
comma
dot
id|info
op_assign
id|snd_ak4117_in_bit_info
comma
dot
id|get
op_assign
id|snd_ak4117_in_bit_get
comma
dot
id|private_value
op_assign
(paren
l_int|1
op_lshift
l_int|31
)paren
op_or
(paren
l_int|3
op_lshift
l_int|8
)paren
op_or
id|AK4117_REG_RCS0
comma
)brace
comma
(brace
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_PCM
comma
dot
id|name
op_assign
l_string|&quot;IEC958 Non-PCM Bitstream&quot;
comma
dot
id|access
op_assign
id|SNDRV_CTL_ELEM_ACCESS_READ
op_or
id|SNDRV_CTL_ELEM_ACCESS_VOLATILE
comma
dot
id|info
op_assign
id|snd_ak4117_in_bit_info
comma
dot
id|get
op_assign
id|snd_ak4117_in_bit_get
comma
dot
id|private_value
op_assign
(paren
l_int|5
op_lshift
l_int|8
)paren
op_or
id|AK4117_REG_RCS1
comma
)brace
comma
(brace
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_PCM
comma
dot
id|name
op_assign
l_string|&quot;IEC958 DTS Bitstream&quot;
comma
dot
id|access
op_assign
id|SNDRV_CTL_ELEM_ACCESS_READ
op_or
id|SNDRV_CTL_ELEM_ACCESS_VOLATILE
comma
dot
id|info
op_assign
id|snd_ak4117_in_bit_info
comma
dot
id|get
op_assign
id|snd_ak4117_in_bit_get
comma
dot
id|private_value
op_assign
(paren
l_int|6
op_lshift
l_int|8
)paren
op_or
id|AK4117_REG_RCS1
comma
)brace
comma
(brace
dot
id|iface
op_assign
id|SNDRV_CTL_ELEM_IFACE_PCM
comma
dot
id|name
op_assign
l_string|&quot;AK4117 Input Select&quot;
comma
dot
id|access
op_assign
id|SNDRV_CTL_ELEM_ACCESS_READ
op_or
id|SNDRV_CTL_ELEM_ACCESS_WRITE
comma
dot
id|info
op_assign
id|snd_ak4117_rx_info
comma
dot
id|get
op_assign
id|snd_ak4117_rx_get
comma
dot
id|put
op_assign
id|snd_ak4117_rx_put
comma
)brace
)brace
suffix:semicolon
DECL|function|snd_ak4117_build
r_int
id|snd_ak4117_build
c_func
(paren
id|ak4117_t
op_star
id|ak4117
comma
id|snd_pcm_substream_t
op_star
id|cap_substream
)paren
(brace
id|snd_kcontrol_t
op_star
id|kctl
suffix:semicolon
r_int
r_int
id|idx
suffix:semicolon
r_int
id|err
suffix:semicolon
id|snd_assert
c_func
(paren
id|cap_substream
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|ak4117-&gt;substream
op_assign
id|cap_substream
suffix:semicolon
r_for
c_loop
(paren
id|idx
op_assign
l_int|0
suffix:semicolon
id|idx
OL
id|AK4117_CONTROLS
suffix:semicolon
id|idx
op_increment
)paren
(brace
id|kctl
op_assign
id|snd_ctl_new1
c_func
(paren
op_amp
id|snd_ak4117_iec958_controls
(braket
id|idx
)braket
comma
id|ak4117
)paren
suffix:semicolon
r_if
c_cond
(paren
id|kctl
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|kctl-&gt;id.device
op_assign
id|cap_substream-&gt;pcm-&gt;device
suffix:semicolon
id|kctl-&gt;id.subdevice
op_assign
id|cap_substream-&gt;number
suffix:semicolon
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|ak4117-&gt;card
comma
id|kctl
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|ak4117-&gt;kctls
(braket
id|idx
)braket
op_assign
id|kctl
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_ak4117_external_rate
r_int
id|snd_ak4117_external_rate
c_func
(paren
id|ak4117_t
op_star
id|ak4117
)paren
(brace
r_int
r_char
id|rcs1
suffix:semicolon
id|rcs1
op_assign
id|reg_read
c_func
(paren
id|ak4117
comma
id|AK4117_REG_RCS1
)paren
suffix:semicolon
r_return
id|external_rate
c_func
(paren
id|rcs1
)paren
suffix:semicolon
)brace
DECL|function|snd_ak4117_check_rate_and_errors
r_int
id|snd_ak4117_check_rate_and_errors
c_func
(paren
id|ak4117_t
op_star
id|ak4117
comma
r_int
r_int
id|flags
)paren
(brace
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|ak4117-&gt;substream
ques
c_cond
id|ak4117-&gt;substream-&gt;runtime
suffix:colon
l_int|NULL
suffix:semicolon
r_int
r_int
id|_flags
suffix:semicolon
r_int
id|res
op_assign
l_int|0
suffix:semicolon
r_int
r_char
id|rcs0
comma
id|rcs1
comma
id|rcs2
suffix:semicolon
r_int
r_char
id|c0
comma
id|c1
suffix:semicolon
id|rcs1
op_assign
id|reg_read
c_func
(paren
id|ak4117
comma
id|AK4117_REG_RCS1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|flags
op_amp
id|AK4117_CHECK_NO_STAT
)paren
r_goto
id|__rate
suffix:semicolon
id|rcs0
op_assign
id|reg_read
c_func
(paren
id|ak4117
comma
id|AK4117_REG_RCS0
)paren
suffix:semicolon
id|rcs2
op_assign
id|reg_read
c_func
(paren
id|ak4117
comma
id|AK4117_REG_RCS2
)paren
suffix:semicolon
singleline_comment|// printk(&quot;AK IRQ: rcs0 = 0x%x, rcs1 = 0x%x, rcs2 = 0x%x&bslash;n&quot;, rcs0, rcs1, rcs2);
id|spin_lock_irqsave
c_func
(paren
op_amp
id|ak4117-&gt;lock
comma
id|_flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rcs0
op_amp
id|AK4117_PAR
)paren
id|ak4117-&gt;parity_errors
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|rcs0
op_amp
id|AK4117_V
)paren
id|ak4117-&gt;v_bit_errors
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|rcs2
op_amp
id|AK4117_CCRC
)paren
id|ak4117-&gt;ccrc_errors
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|rcs2
op_amp
id|AK4117_QCRC
)paren
id|ak4117-&gt;qcrc_errors
op_increment
suffix:semicolon
id|c0
op_assign
(paren
id|ak4117-&gt;rcs0
op_amp
(paren
id|AK4117_QINT
op_or
id|AK4117_CINT
op_or
id|AK4117_STC
op_or
id|AK4117_AUDION
op_or
id|AK4117_AUTO
op_or
id|AK4117_UNLCK
)paren
)paren
op_xor
(paren
id|rcs0
op_amp
(paren
id|AK4117_QINT
op_or
id|AK4117_CINT
op_or
id|AK4117_STC
op_or
id|AK4117_AUDION
op_or
id|AK4117_AUTO
op_or
id|AK4117_UNLCK
)paren
)paren
suffix:semicolon
id|c1
op_assign
(paren
id|ak4117-&gt;rcs1
op_amp
(paren
id|AK4117_DTSCD
op_or
id|AK4117_NPCM
op_or
id|AK4117_PEM
op_or
l_int|0x0f
)paren
)paren
op_xor
(paren
id|rcs1
op_amp
(paren
id|AK4117_DTSCD
op_or
id|AK4117_NPCM
op_or
id|AK4117_PEM
op_or
l_int|0x0f
)paren
)paren
suffix:semicolon
id|ak4117-&gt;rcs0
op_assign
id|rcs0
op_amp
op_complement
(paren
id|AK4117_QINT
op_or
id|AK4117_CINT
op_or
id|AK4117_STC
)paren
suffix:semicolon
id|ak4117-&gt;rcs1
op_assign
id|rcs1
suffix:semicolon
id|ak4117-&gt;rcs2
op_assign
id|rcs2
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|ak4117-&gt;lock
comma
id|_flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rcs0
op_amp
id|AK4117_PAR
)paren
id|snd_ctl_notify
c_func
(paren
id|ak4117-&gt;card
comma
id|SNDRV_CTL_EVENT_MASK_VALUE
comma
op_amp
id|ak4117-&gt;kctls
(braket
l_int|0
)braket
op_member_access_from_pointer
id|id
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rcs0
op_amp
id|AK4117_V
)paren
id|snd_ctl_notify
c_func
(paren
id|ak4117-&gt;card
comma
id|SNDRV_CTL_EVENT_MASK_VALUE
comma
op_amp
id|ak4117-&gt;kctls
(braket
l_int|1
)braket
op_member_access_from_pointer
id|id
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rcs2
op_amp
id|AK4117_CCRC
)paren
id|snd_ctl_notify
c_func
(paren
id|ak4117-&gt;card
comma
id|SNDRV_CTL_EVENT_MASK_VALUE
comma
op_amp
id|ak4117-&gt;kctls
(braket
l_int|2
)braket
op_member_access_from_pointer
id|id
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rcs2
op_amp
id|AK4117_QCRC
)paren
id|snd_ctl_notify
c_func
(paren
id|ak4117-&gt;card
comma
id|SNDRV_CTL_EVENT_MASK_VALUE
comma
op_amp
id|ak4117-&gt;kctls
(braket
l_int|3
)braket
op_member_access_from_pointer
id|id
)paren
suffix:semicolon
multiline_comment|/* rate change */
r_if
c_cond
(paren
id|c1
op_amp
l_int|0x0f
)paren
id|snd_ctl_notify
c_func
(paren
id|ak4117-&gt;card
comma
id|SNDRV_CTL_EVENT_MASK_VALUE
comma
op_amp
id|ak4117-&gt;kctls
(braket
l_int|4
)braket
op_member_access_from_pointer
id|id
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|c1
op_amp
id|AK4117_PEM
)paren
op_or
(paren
id|c0
op_amp
id|AK4117_CINT
)paren
)paren
id|snd_ctl_notify
c_func
(paren
id|ak4117-&gt;card
comma
id|SNDRV_CTL_EVENT_MASK_VALUE
comma
op_amp
id|ak4117-&gt;kctls
(braket
l_int|6
)braket
op_member_access_from_pointer
id|id
)paren
suffix:semicolon
r_if
c_cond
(paren
id|c0
op_amp
id|AK4117_QINT
)paren
id|snd_ctl_notify
c_func
(paren
id|ak4117-&gt;card
comma
id|SNDRV_CTL_EVENT_MASK_VALUE
comma
op_amp
id|ak4117-&gt;kctls
(braket
l_int|8
)braket
op_member_access_from_pointer
id|id
)paren
suffix:semicolon
r_if
c_cond
(paren
id|c0
op_amp
id|AK4117_AUDION
)paren
id|snd_ctl_notify
c_func
(paren
id|ak4117-&gt;card
comma
id|SNDRV_CTL_EVENT_MASK_VALUE
comma
op_amp
id|ak4117-&gt;kctls
(braket
l_int|9
)braket
op_member_access_from_pointer
id|id
)paren
suffix:semicolon
r_if
c_cond
(paren
id|c1
op_amp
id|AK4117_NPCM
)paren
id|snd_ctl_notify
c_func
(paren
id|ak4117-&gt;card
comma
id|SNDRV_CTL_EVENT_MASK_VALUE
comma
op_amp
id|ak4117-&gt;kctls
(braket
l_int|10
)braket
op_member_access_from_pointer
id|id
)paren
suffix:semicolon
r_if
c_cond
(paren
id|c1
op_amp
id|AK4117_DTSCD
)paren
id|snd_ctl_notify
c_func
(paren
id|ak4117-&gt;card
comma
id|SNDRV_CTL_EVENT_MASK_VALUE
comma
op_amp
id|ak4117-&gt;kctls
(braket
l_int|11
)braket
op_member_access_from_pointer
id|id
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ak4117-&gt;change_callback
op_logical_and
(paren
id|c0
op_or
id|c1
)paren
op_ne
l_int|0
)paren
id|ak4117
op_member_access_from_pointer
id|change_callback
c_func
(paren
id|ak4117
comma
id|c0
comma
id|c1
)paren
suffix:semicolon
id|__rate
suffix:colon
multiline_comment|/* compare rate */
id|res
op_assign
id|external_rate
c_func
(paren
id|rcs1
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|flags
op_amp
id|AK4117_CHECK_NO_RATE
)paren
op_logical_and
id|runtime
op_logical_and
id|runtime-&gt;rate
op_ne
id|res
)paren
(brace
id|snd_pcm_stream_lock_irqsave
c_func
(paren
id|ak4117-&gt;substream
comma
id|_flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|snd_pcm_running
c_func
(paren
id|ak4117-&gt;substream
)paren
)paren
(brace
singleline_comment|// printk(&quot;rate changed (%i &lt;- %i)&bslash;n&quot;, runtime-&gt;rate, res);
id|snd_pcm_stop
c_func
(paren
id|ak4117-&gt;substream
comma
id|SNDRV_PCM_STATE_DRAINING
)paren
suffix:semicolon
id|wake_up
c_func
(paren
op_amp
id|runtime-&gt;sleep
)paren
suffix:semicolon
id|res
op_assign
l_int|1
suffix:semicolon
)brace
id|snd_pcm_stream_unlock_irqrestore
c_func
(paren
id|ak4117-&gt;substream
comma
id|_flags
)paren
suffix:semicolon
)brace
r_return
id|res
suffix:semicolon
)brace
DECL|function|snd_ak4117_timer
r_static
r_void
id|snd_ak4117_timer
c_func
(paren
r_int
r_int
id|data
)paren
(brace
id|ak4117_t
op_star
id|chip
op_assign
(paren
id|ak4117_t
op_star
)paren
id|data
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;init
)paren
r_return
suffix:semicolon
id|snd_ak4117_check_rate_and_errors
c_func
(paren
id|chip
comma
l_int|0
)paren
suffix:semicolon
id|chip-&gt;timer.expires
op_assign
l_int|1
op_plus
id|jiffies
suffix:semicolon
id|add_timer
c_func
(paren
op_amp
id|chip-&gt;timer
)paren
suffix:semicolon
)brace
DECL|variable|snd_ak4117_create
id|EXPORT_SYMBOL
c_func
(paren
id|snd_ak4117_create
)paren
suffix:semicolon
DECL|variable|snd_ak4117_reg_write
id|EXPORT_SYMBOL
c_func
(paren
id|snd_ak4117_reg_write
)paren
suffix:semicolon
DECL|variable|snd_ak4117_reinit
id|EXPORT_SYMBOL
c_func
(paren
id|snd_ak4117_reinit
)paren
suffix:semicolon
DECL|variable|snd_ak4117_build
id|EXPORT_SYMBOL
c_func
(paren
id|snd_ak4117_build
)paren
suffix:semicolon
DECL|variable|snd_ak4117_external_rate
id|EXPORT_SYMBOL
c_func
(paren
id|snd_ak4117_external_rate
)paren
suffix:semicolon
DECL|variable|snd_ak4117_check_rate_and_errors
id|EXPORT_SYMBOL
c_func
(paren
id|snd_ak4117_check_rate_and_errors
)paren
suffix:semicolon
eof
