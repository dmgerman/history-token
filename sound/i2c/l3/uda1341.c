multiline_comment|/*&n; * Philips UDA1341 mixer device driver&n; * Copyright (c) 2002 Tomas Kasparek &lt;tomas.kasparek@seznam.cz&gt;&n; *&n; * Portions are Copyright (C) 2000 Lernout &amp; Hauspie Speech Products, N.V.&n; *&n; * This program is free software; you can redistribute it and/or&n; * modify it under the terms of the GNU General Public License.&n; *&n; * History:&n; *&n; * 2002-03-13&t;Tomas Kasparek&t;Initial release - based on uda1341.c from OSS&n; * 2002-03-28   Tomas Kasparek  basic mixer is working (volume, bass, treble)&n; * 2002-03-30   Tomas Kasparek  Proc filesystem support, complete mixer and DSP&n; *                              features support&n; * 2002-04-12&t;Tomas Kasparek&t;Proc interface update, code cleanup&n; */
multiline_comment|/* $Id: uda1341.c,v 1.2 2002/04/18 07:47:59 perex Exp $ */
macro_line|#include &lt;sound/driver.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/types.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;linux/errno.h&gt;
macro_line|#include &lt;linux/ioctl.h&gt;
macro_line|#include &lt;linux/errno.h&gt;
macro_line|#include &lt;asm/uaccess.h&gt;
macro_line|#include &lt;sound/core.h&gt;
macro_line|#include &lt;sound/control.h&gt;
macro_line|#include &lt;sound/initval.h&gt;
macro_line|#include &lt;sound/info.h&gt;
macro_line|#include &lt;linux/l3/l3.h&gt;
DECL|macro|DEBUG_MODE
macro_line|#undef DEBUG_MODE
DECL|macro|DEBUG_FUNCTION_NAMES
macro_line|#undef DEBUG_FUNCTION_NAMES
macro_line|#include &lt;sound/uda1341.h&gt;
multiline_comment|/* {{{ HW regs definition */
DECL|macro|STAT0
mdefine_line|#define STAT0                   0x00
DECL|macro|STAT1
mdefine_line|#define STAT1&t;&t;&t;0x80
DECL|macro|STAT_MASK
mdefine_line|#define STAT_MASK               0x80
DECL|macro|DATA0_0
mdefine_line|#define DATA0_0&t;&t;&t;0x00
DECL|macro|DATA0_1
mdefine_line|#define DATA0_1&t;&t;&t;0x40
DECL|macro|DATA0_2
mdefine_line|#define DATA0_2&t;&t;&t;0x80
DECL|macro|DATA_MASK
mdefine_line|#define DATA_MASK               0xc0
DECL|macro|IS_DATA0
mdefine_line|#define IS_DATA0(x)     ((x) &gt;= data0_0 &amp;&amp; (x) &lt;= data0_2)
DECL|macro|IS_DATA1
mdefine_line|#define IS_DATA1(x)     ((x) == data1)
DECL|macro|IS_STATUS
mdefine_line|#define IS_STATUS(x)    ((x) == stat0 || (x) == stat1)
DECL|macro|IS_EXTEND
mdefine_line|#define IS_EXTEND(x)   ((x) &gt;= ext0 &amp;&amp; (x) &lt;= ext6)
multiline_comment|/* }}} */
DECL|enum|uda1341_regs_names
r_enum
id|uda1341_regs_names
(brace
DECL|enumerator|stat0
id|stat0
comma
DECL|enumerator|stat1
id|stat1
comma
DECL|enumerator|data0_0
id|data0_0
comma
DECL|enumerator|data0_1
id|data0_1
comma
DECL|enumerator|data0_2
id|data0_2
comma
DECL|enumerator|data1
id|data1
comma
DECL|enumerator|ext0
id|ext0
comma
DECL|enumerator|ext1
id|ext1
comma
DECL|enumerator|ext2
id|ext2
comma
DECL|enumerator|empty
id|empty
comma
DECL|enumerator|ext4
id|ext4
comma
DECL|enumerator|ext5
id|ext5
comma
DECL|enumerator|ext6
id|ext6
comma
DECL|enumerator|uda1341_reg_last
id|uda1341_reg_last
comma
)brace
suffix:semicolon
DECL|variable|uda1341_reg_names
r_const
r_char
op_star
id|uda1341_reg_names
(braket
)braket
op_assign
(brace
l_string|&quot;stat 0 &quot;
comma
l_string|&quot;stat 1 &quot;
comma
l_string|&quot;data 00&quot;
comma
l_string|&quot;data 01&quot;
comma
l_string|&quot;data 02&quot;
comma
l_string|&quot;data 1 &quot;
comma
l_string|&quot;ext 0&quot;
comma
l_string|&quot;ext 1&quot;
comma
l_string|&quot;ext 2&quot;
comma
l_string|&quot;empty&quot;
comma
l_string|&quot;ext 4&quot;
comma
l_string|&quot;ext 5&quot;
comma
l_string|&quot;ext 6&quot;
comma
)brace
suffix:semicolon
DECL|variable|uda1341_enum_items
r_const
r_int
id|uda1341_enum_items
(braket
)braket
op_assign
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|2
comma
singleline_comment|//peak - before/after
l_int|4
comma
singleline_comment|//deemp - none/32/44.1/48
l_int|0
comma
l_int|4
comma
singleline_comment|//filter - flat/min/min/max
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|4
comma
singleline_comment|//mixer - differ/line/mic/mixer
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
)brace
suffix:semicolon
DECL|variable|uda1341_enum_names
r_const
r_char
op_star
op_star
id|uda1341_enum_names
(braket
)braket
op_assign
(brace
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
id|peak_names
comma
singleline_comment|//peak - before/after
id|deemp_names
comma
singleline_comment|//deemp - none/32/44.1/48
l_int|NULL
comma
id|filter_names
comma
singleline_comment|//filter - flat/min/min/max
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
id|mixer_names
comma
singleline_comment|//mixer - differ/line/mic/mixer
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
)brace
suffix:semicolon
DECL|typedef|uda1341_cfg
r_typedef
r_int
id|uda1341_cfg
(braket
id|CMD_LAST
)braket
suffix:semicolon
DECL|typedef|uda1341_t
r_typedef
r_struct
id|uda1341
id|uda1341_t
suffix:semicolon
DECL|struct|uda1341
r_struct
id|uda1341
(brace
DECL|member|write
r_void
(paren
op_star
id|write
)paren
(paren
r_struct
id|l3_client
op_star
id|uda1341
comma
r_int
r_int
id|reg
comma
r_int
r_int
id|val
)paren
suffix:semicolon
DECL|member|read
r_int
r_char
(paren
op_star
id|read
)paren
(paren
r_struct
id|l3_client
op_star
id|uda1341
comma
r_int
r_int
id|reg
)paren
suffix:semicolon
DECL|member|regs
r_int
r_char
id|regs
(braket
id|uda1341_reg_last
)braket
suffix:semicolon
DECL|member|active
r_int
id|active
suffix:semicolon
DECL|member|reg_lock
id|spinlock_t
id|reg_lock
suffix:semicolon
DECL|member|card
id|snd_card_t
op_star
id|card
suffix:semicolon
DECL|member|proc_entry
id|snd_info_entry_t
op_star
id|proc_entry
suffix:semicolon
DECL|member|proc_regs_entry
id|snd_info_entry_t
op_star
id|proc_regs_entry
suffix:semicolon
DECL|member|cfg
id|uda1341_cfg
id|cfg
suffix:semicolon
)brace
suffix:semicolon
singleline_comment|//hack for ALSA magic casting
DECL|typedef|l3_client_t
r_typedef
r_struct
id|l3_client
id|l3_client_t
suffix:semicolon
DECL|macro|chip_t
mdefine_line|#define chip_t l3_client_t      
DECL|variable|uda1341
r_static
r_struct
id|l3_client
op_star
id|uda1341
op_assign
l_int|NULL
suffix:semicolon
multiline_comment|/* transfer 8bit integer into string with binary representation */
DECL|function|int2str_bin8
r_void
(def_block
id|int2str_bin8
c_func
(paren
r_uint8
id|val
comma
r_char
op_star
id|buf
)paren
(brace
r_const
r_int
id|size
op_assign
r_sizeof
(paren
id|val
)paren
op_star
l_int|8
suffix:semicolon
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|size
suffix:semicolon
id|i
op_increment
)paren
(brace
op_star
(paren
id|buf
op_increment
)paren
op_assign
(paren
id|val
op_rshift
(paren
id|size
op_minus
l_int|1
)paren
)paren
ques
c_cond
l_char|&squot;1&squot;
suffix:colon
l_char|&squot;0&squot;
suffix:semicolon
id|val
op_lshift_assign
l_int|1
suffix:semicolon
)brace
op_star
id|buf
op_assign
l_char|&squot;&bslash;0&squot;
suffix:semicolon
singleline_comment|//end the string with zero
)brace
)def_block
multiline_comment|/* {{{ HW manipulation routines */
DECL|function|snd_uda1341_codec_write
r_void
id|snd_uda1341_codec_write
c_func
(paren
r_struct
id|l3_client
op_star
id|clnt
comma
r_int
r_int
id|reg
comma
r_int
r_int
id|val
)paren
(brace
r_struct
id|uda1341
op_star
id|uda
op_assign
id|clnt-&gt;driver_data
suffix:semicolon
r_int
id|err
op_assign
l_int|0
suffix:semicolon
r_int
r_char
id|buf
(braket
l_int|2
)braket
op_assign
(brace
l_int|0xc0
comma
l_int|0xe0
)brace
suffix:semicolon
singleline_comment|// for EXT addressing
id|DEBUG_NAME
c_func
(paren
id|KERN_DEBUG
l_string|&quot;codec_write: reg: %s val: %d &quot;
comma
id|uda1341_reg_names
(braket
id|reg
)braket
comma
id|val
)paren
suffix:semicolon
id|uda-&gt;regs
(braket
id|reg
)braket
op_assign
id|val
suffix:semicolon
r_if
c_cond
(paren
id|uda-&gt;active
)paren
(brace
id|DEBUG
c_func
(paren
l_string|&quot;O&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|IS_DATA0
c_func
(paren
id|reg
)paren
)paren
(brace
id|DEBUG
c_func
(paren
l_string|&quot; D0 &quot;
)paren
suffix:semicolon
id|err
op_assign
id|l3_write
c_func
(paren
id|clnt
comma
id|UDA1341_DATA0
comma
(paren
r_const
r_int
r_char
op_star
)paren
op_amp
id|val
comma
l_int|1
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|IS_DATA1
c_func
(paren
id|reg
)paren
)paren
(brace
id|DEBUG
c_func
(paren
l_string|&quot; D1 &quot;
)paren
suffix:semicolon
id|err
op_assign
id|l3_write
c_func
(paren
id|clnt
comma
id|UDA1341_DATA1
comma
(paren
r_const
r_int
r_char
op_star
)paren
op_amp
id|val
comma
l_int|1
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|IS_STATUS
c_func
(paren
id|reg
)paren
)paren
(brace
id|DEBUG
c_func
(paren
l_string|&quot; S &quot;
)paren
suffix:semicolon
id|err
op_assign
id|l3_write
c_func
(paren
id|clnt
comma
id|UDA1341_STATUS
comma
(paren
r_const
r_int
r_char
op_star
)paren
op_amp
id|val
comma
l_int|1
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|IS_EXTEND
c_func
(paren
id|reg
)paren
)paren
(brace
id|DEBUG
c_func
(paren
l_string|&quot; E &quot;
)paren
suffix:semicolon
id|buf
(braket
l_int|0
)braket
op_or_assign
(paren
id|reg
op_minus
id|ext0
)paren
op_amp
l_int|0x7
suffix:semicolon
singleline_comment|//EXT address
id|buf
(braket
l_int|1
)braket
op_or_assign
id|val
suffix:semicolon
singleline_comment|//EXT data
id|DEBUG
c_func
(paren
l_string|&quot;%x %x &quot;
comma
id|buf
(braket
l_int|0
)braket
comma
id|buf
(braket
l_int|1
)braket
)paren
suffix:semicolon
id|err
op_assign
id|l3_write
c_func
(paren
id|clnt
comma
id|UDA1341_DATA0
comma
(paren
r_const
r_int
r_char
op_star
)paren
id|buf
comma
l_int|2
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|err
op_eq
l_int|1
op_logical_or
id|err
op_eq
l_int|2
)paren
id|DEBUG
c_func
(paren
l_string|&quot;K&bslash;n&quot;
)paren
suffix:semicolon
r_else
id|DEBUG
c_func
(paren
l_string|&quot; Error: %d&bslash;n&quot;
comma
id|err
)paren
suffix:semicolon
)brace
r_else
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;UDA1341 codec not active!&bslash;n&quot;
)paren
suffix:semicolon
)brace
DECL|function|snd_uda1341_codec_read
r_int
r_char
id|snd_uda1341_codec_read
c_func
(paren
r_struct
id|l3_client
op_star
id|clnt
comma
r_int
r_int
id|reg
)paren
(brace
r_int
id|err
op_assign
l_int|0
suffix:semicolon
r_int
r_char
id|val
suffix:semicolon
id|DEBUG_NAME
c_func
(paren
id|KERN_DEBUG
l_string|&quot;codec_read: reg: %d &quot;
comma
id|reg
)paren
suffix:semicolon
id|DEBUG
c_func
(paren
l_string|&quot;O&quot;
)paren
suffix:semicolon
id|err
op_assign
id|l3_read
c_func
(paren
id|clnt
comma
id|reg
comma
op_amp
id|val
comma
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
op_eq
l_int|1
)paren
id|DEBUG
c_func
(paren
l_string|&quot;K&bslash;n&quot;
)paren
suffix:semicolon
r_else
id|DEBUG
c_func
(paren
l_string|&quot; Error: %d&bslash;n&quot;
comma
id|err
)paren
suffix:semicolon
r_return
id|val
op_amp
l_int|63
suffix:semicolon
singleline_comment|//use just 6bits - the rest is address of the reg
)brace
DECL|function|snd_uda1341_valid_reg
r_static
r_int
id|snd_uda1341_valid_reg
c_func
(paren
r_struct
id|l3_client
op_star
id|clnt
comma
r_int
r_int
id|reg
)paren
(brace
id|DEBUG_NAME
c_func
(paren
id|KERN_DEBUG
l_string|&quot;valid_reg&bslash;n&quot;
)paren
suffix:semicolon
r_return
id|reg
OL
id|uda1341_reg_last
suffix:semicolon
)brace
DECL|function|snd_uda1341_update_bits
r_int
id|snd_uda1341_update_bits
c_func
(paren
r_struct
id|l3_client
op_star
id|clnt
comma
r_int
r_int
id|reg
comma
r_int
r_int
id|mask
comma
r_int
r_int
id|shift
comma
r_int
r_int
id|value
comma
r_int
id|flush
)paren
(brace
r_int
id|change
suffix:semicolon
r_int
r_int
id|old
comma
r_new
suffix:semicolon
r_struct
id|uda1341
op_star
id|uda
op_assign
id|clnt-&gt;driver_data
suffix:semicolon
id|DEBUG
c_func
(paren
id|KERN_DEBUG
l_string|&quot;update_bits: reg: %s mask: %d shift: %d val: %d&bslash;n&quot;
comma
id|uda1341_reg_names
(braket
id|reg
)braket
comma
id|mask
comma
id|shift
comma
id|value
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snd_uda1341_valid_reg
c_func
(paren
id|clnt
comma
id|reg
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|uda-&gt;reg_lock
)paren
suffix:semicolon
id|old
op_assign
id|uda-&gt;regs
(braket
id|reg
)braket
suffix:semicolon
r_new
op_assign
(paren
id|old
op_amp
op_complement
(paren
id|mask
op_lshift
id|shift
)paren
)paren
op_or
(paren
id|value
op_lshift
id|shift
)paren
suffix:semicolon
id|change
op_assign
id|old
op_ne
r_new
suffix:semicolon
r_if
c_cond
(paren
id|change
)paren
(brace
r_if
c_cond
(paren
id|flush
)paren
id|uda
op_member_access_from_pointer
id|write
c_func
(paren
id|clnt
comma
id|reg
comma
r_new
)paren
suffix:semicolon
id|uda-&gt;regs
(braket
id|reg
)braket
op_assign
r_new
suffix:semicolon
)brace
id|spin_unlock
c_func
(paren
op_amp
id|uda-&gt;reg_lock
)paren
suffix:semicolon
r_return
id|change
suffix:semicolon
)brace
DECL|function|snd_uda1341_cfg_write
r_int
id|snd_uda1341_cfg_write
c_func
(paren
r_struct
id|l3_client
op_star
id|clnt
comma
r_int
r_int
id|what
comma
r_int
r_int
id|value
comma
r_int
id|flush
)paren
(brace
r_struct
id|uda1341
op_star
id|uda
op_assign
id|clnt-&gt;driver_data
suffix:semicolon
r_int
id|ret
op_assign
l_int|0
suffix:semicolon
id|DEBUG_NAME
c_func
(paren
id|KERN_DEBUG
l_string|&quot;cfg_write what: %d value: %d&bslash;n&quot;
comma
id|what
comma
id|value
)paren
suffix:semicolon
id|uda-&gt;cfg
(braket
id|what
)braket
op_assign
id|value
suffix:semicolon
r_switch
c_cond
(paren
id|what
)paren
(brace
r_case
id|CMD_RESET
suffix:colon
id|ret
op_assign
id|snd_uda1341_update_bits
c_func
(paren
id|clnt
comma
id|data0_2
comma
l_int|1
comma
l_int|2
comma
l_int|1
comma
id|flush
)paren
suffix:semicolon
singleline_comment|//MUTE
id|ret
op_assign
id|snd_uda1341_update_bits
c_func
(paren
id|clnt
comma
id|stat0
comma
l_int|1
comma
l_int|6
comma
l_int|1
comma
id|flush
)paren
suffix:semicolon
singleline_comment|//RESET
id|ret
op_assign
id|snd_uda1341_update_bits
c_func
(paren
id|clnt
comma
id|stat0
comma
l_int|1
comma
l_int|6
comma
l_int|0
comma
id|flush
)paren
suffix:semicolon
singleline_comment|// RESTORE
id|uda-&gt;cfg
(braket
id|CMD_RESET
)braket
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
id|CMD_FS
suffix:colon
id|ret
op_assign
id|snd_uda1341_update_bits
c_func
(paren
id|clnt
comma
id|stat0
comma
l_int|3
comma
l_int|4
comma
id|value
comma
id|flush
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|CMD_FORMAT
suffix:colon
id|ret
op_assign
id|snd_uda1341_update_bits
c_func
(paren
id|clnt
comma
id|stat0
comma
l_int|7
comma
l_int|1
comma
id|value
comma
id|flush
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|CMD_OGAIN
suffix:colon
id|ret
op_assign
id|snd_uda1341_update_bits
c_func
(paren
id|clnt
comma
id|stat1
comma
l_int|1
comma
l_int|6
comma
id|value
comma
id|flush
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|CMD_IGAIN
suffix:colon
id|ret
op_assign
id|snd_uda1341_update_bits
c_func
(paren
id|clnt
comma
id|stat1
comma
l_int|1
comma
l_int|5
comma
id|value
comma
id|flush
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|CMD_DAC
suffix:colon
id|ret
op_assign
id|snd_uda1341_update_bits
c_func
(paren
id|clnt
comma
id|stat1
comma
l_int|1
comma
l_int|0
comma
id|value
comma
id|flush
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|CMD_ADC
suffix:colon
id|ret
op_assign
id|snd_uda1341_update_bits
c_func
(paren
id|clnt
comma
id|stat1
comma
l_int|1
comma
l_int|1
comma
id|value
comma
id|flush
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|CMD_VOLUME
suffix:colon
id|ret
op_assign
id|snd_uda1341_update_bits
c_func
(paren
id|clnt
comma
id|data0_0
comma
l_int|63
comma
l_int|0
comma
id|value
comma
id|flush
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|CMD_BASS
suffix:colon
id|ret
op_assign
id|snd_uda1341_update_bits
c_func
(paren
id|clnt
comma
id|data0_1
comma
l_int|15
comma
l_int|2
comma
id|value
comma
id|flush
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|CMD_TREBBLE
suffix:colon
id|ret
op_assign
id|snd_uda1341_update_bits
c_func
(paren
id|clnt
comma
id|data0_1
comma
l_int|3
comma
l_int|0
comma
id|value
comma
id|flush
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|CMD_PEAK
suffix:colon
id|ret
op_assign
id|snd_uda1341_update_bits
c_func
(paren
id|clnt
comma
id|data0_2
comma
l_int|1
comma
l_int|5
comma
id|value
comma
id|flush
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|CMD_DEEMP
suffix:colon
id|ret
op_assign
id|snd_uda1341_update_bits
c_func
(paren
id|clnt
comma
id|data0_2
comma
l_int|3
comma
l_int|3
comma
id|value
comma
id|flush
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|CMD_MUTE
suffix:colon
id|ret
op_assign
id|snd_uda1341_update_bits
c_func
(paren
id|clnt
comma
id|data0_2
comma
l_int|1
comma
l_int|2
comma
id|value
comma
id|flush
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|CMD_FILTER
suffix:colon
id|ret
op_assign
id|snd_uda1341_update_bits
c_func
(paren
id|clnt
comma
id|data0_2
comma
l_int|3
comma
l_int|0
comma
id|value
comma
id|flush
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|CMD_CH1
suffix:colon
id|ret
op_assign
id|snd_uda1341_update_bits
c_func
(paren
id|clnt
comma
id|ext0
comma
l_int|31
comma
l_int|0
comma
id|value
comma
id|flush
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|CMD_CH2
suffix:colon
id|ret
op_assign
id|snd_uda1341_update_bits
c_func
(paren
id|clnt
comma
id|ext1
comma
l_int|31
comma
l_int|0
comma
id|value
comma
id|flush
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|CMD_MIC
suffix:colon
id|ret
op_assign
id|snd_uda1341_update_bits
c_func
(paren
id|clnt
comma
id|ext2
comma
l_int|7
comma
l_int|2
comma
id|value
comma
id|flush
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|CMD_MIXER
suffix:colon
id|ret
op_assign
id|snd_uda1341_update_bits
c_func
(paren
id|clnt
comma
id|ext2
comma
l_int|3
comma
l_int|0
comma
id|value
comma
id|flush
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|CMD_AGC
suffix:colon
id|ret
op_assign
id|snd_uda1341_update_bits
c_func
(paren
id|clnt
comma
id|ext4
comma
l_int|1
comma
l_int|4
comma
id|value
comma
id|flush
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|CMD_IG
suffix:colon
id|ret
op_assign
id|snd_uda1341_update_bits
c_func
(paren
id|clnt
comma
id|ext4
comma
l_int|3
comma
l_int|0
comma
id|value
op_amp
l_int|0x3
comma
id|flush
)paren
suffix:semicolon
id|ret
op_assign
id|snd_uda1341_update_bits
c_func
(paren
id|clnt
comma
id|ext5
comma
l_int|31
comma
l_int|0
comma
id|value
op_rshift
l_int|2
comma
id|flush
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|CMD_AGC_TIME
suffix:colon
id|ret
op_assign
id|snd_uda1341_update_bits
c_func
(paren
id|clnt
comma
id|ext6
comma
l_int|7
comma
l_int|2
comma
id|value
comma
id|flush
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|CMD_AGC_LEVEL
suffix:colon
id|ret
op_assign
id|snd_uda1341_update_bits
c_func
(paren
id|clnt
comma
id|ext6
comma
l_int|3
comma
l_int|0
comma
id|value
comma
id|flush
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|ret
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|uda-&gt;active
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;UDA1341 codec not active!&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_return
id|ret
suffix:semicolon
)brace
multiline_comment|/* }}} */
multiline_comment|/* {{{ Proc interface */
DECL|function|snd_uda1341_proc_read
r_static
r_void
id|snd_uda1341_proc_read
c_func
(paren
id|snd_info_entry_t
op_star
id|entry
comma
id|snd_info_buffer_t
op_star
id|buffer
)paren
(brace
r_struct
id|l3_client
op_star
id|clnt
op_assign
id|snd_magic_cast
c_func
(paren
id|l3_client_t
comma
id|entry-&gt;private_data
comma
r_return
)paren
suffix:semicolon
r_struct
id|uda1341
op_star
id|uda
op_assign
id|clnt-&gt;driver_data
suffix:semicolon
r_int
id|peak
suffix:semicolon
id|peak
op_assign
id|snd_uda1341_codec_read
c_func
(paren
id|clnt
comma
id|UDA1341_DATA1
)paren
suffix:semicolon
id|DEBUG_NAME
c_func
(paren
id|KERN_DEBUG
l_string|&quot;proc_read&bslash;n&quot;
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;%s&bslash;n&bslash;n&quot;
comma
id|uda-&gt;card-&gt;longname
)paren
suffix:semicolon
singleline_comment|// for information about computed values see UDA1341TS datasheet pages 15 - 21
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;DAC power           : %s&bslash;n&quot;
comma
id|uda-&gt;cfg
(braket
id|CMD_DAC
)braket
ques
c_cond
l_string|&quot;on&quot;
suffix:colon
l_string|&quot;off&quot;
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;ADC power           : %s&bslash;n&quot;
comma
id|uda-&gt;cfg
(braket
id|CMD_ADC
)braket
ques
c_cond
l_string|&quot;on&quot;
suffix:colon
l_string|&quot;off&quot;
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Clock frequency     : %s&bslash;n&quot;
comma
id|fs_names
(braket
id|uda-&gt;cfg
(braket
id|CMD_FS
)braket
)braket
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Data format         : %s&bslash;n&bslash;n&quot;
comma
id|format_names
(braket
id|uda-&gt;cfg
(braket
id|CMD_FORMAT
)braket
)braket
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Filter mode         : %s&bslash;n&quot;
comma
id|filter_names
(braket
id|uda-&gt;cfg
(braket
id|CMD_FILTER
)braket
)braket
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Mixer mode          : %s&bslash;n&quot;
comma
id|mixer_names
(braket
id|uda-&gt;cfg
(braket
id|CMD_MIXER
)braket
)braket
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;De-emphasis         : %s&bslash;n&quot;
comma
id|deemp_names
(braket
id|uda-&gt;cfg
(braket
id|CMD_DEEMP
)braket
)braket
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Peak detection pos. : %s&bslash;n&quot;
comma
id|uda-&gt;cfg
(braket
id|CMD_PEAK
)braket
ques
c_cond
l_string|&quot;after&quot;
suffix:colon
l_string|&quot;before&quot;
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Peak value          : %s&bslash;n&bslash;n&quot;
comma
id|peak_value
(braket
id|peak
)braket
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Automatic Gain Ctrl : %s&bslash;n&quot;
comma
id|uda-&gt;cfg
(braket
id|CMD_AGC
)braket
ques
c_cond
l_string|&quot;on&quot;
suffix:colon
l_string|&quot;off&quot;
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;AGC attack time     : %d ms&bslash;n&quot;
comma
id|AGC_atime
(braket
id|uda-&gt;cfg
(braket
id|CMD_AGC_TIME
)braket
)braket
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;AGC decay time      : %d ns&bslash;n&quot;
comma
id|AGC_dtime
(braket
id|uda-&gt;cfg
(braket
id|CMD_AGC_TIME
)braket
)braket
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;AGC output level    : %s dB&bslash;n&bslash;n&quot;
comma
id|AGC_level
(braket
id|uda-&gt;cfg
(braket
id|CMD_AGC_LEVEL
)braket
)braket
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Mute                : %s&bslash;n&quot;
comma
id|uda-&gt;cfg
(braket
id|CMD_MUTE
)braket
ques
c_cond
l_string|&quot;on&quot;
suffix:colon
l_string|&quot;off&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|uda-&gt;cfg
(braket
id|CMD_VOLUME
)braket
op_eq
l_int|0
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Volume              : 0 dB&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|uda-&gt;cfg
(braket
id|CMD_VOLUME
)braket
OL
l_int|62
)paren
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Volume              : %d dB&bslash;n&quot;
comma
op_minus
l_int|1
op_star
id|uda-&gt;cfg
(braket
id|CMD_VOLUME
)braket
op_plus
l_int|1
)paren
suffix:semicolon
r_else
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Volume              : -INF dB&bslash;n&quot;
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Bass                : %s&bslash;n&quot;
comma
id|bass_values
(braket
id|uda-&gt;cfg
(braket
id|CMD_FILTER
)braket
)braket
(braket
id|uda-&gt;cfg
(braket
id|CMD_BASS
)braket
)braket
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Trebble             : %d dB&bslash;n&quot;
comma
id|uda-&gt;cfg
(braket
id|CMD_FILTER
)braket
ques
c_cond
l_int|2
op_star
id|uda-&gt;cfg
(braket
id|CMD_TREBBLE
)braket
suffix:colon
l_int|0
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Input Gain (6dB)    : %s&bslash;n&quot;
comma
id|uda-&gt;cfg
(braket
id|CMD_IGAIN
)braket
ques
c_cond
l_string|&quot;on&quot;
suffix:colon
l_string|&quot;off&quot;
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Output Gain (6dB)   : %s&bslash;n&quot;
comma
id|uda-&gt;cfg
(braket
id|CMD_OGAIN
)braket
ques
c_cond
l_string|&quot;on&quot;
suffix:colon
l_string|&quot;off&quot;
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Mic sensitivity     : %s&bslash;n&quot;
comma
id|mic_sens_value
(braket
id|uda-&gt;cfg
(braket
id|CMD_MIC
)braket
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
id|uda-&gt;cfg
(braket
id|CMD_CH1
)braket
OL
l_int|31
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Mixer gain channel 1: -%d.%c dB&bslash;n&quot;
comma
(paren
(paren
id|uda-&gt;cfg
(braket
id|CMD_CH1
)braket
op_rshift
l_int|1
)paren
op_star
l_int|3
)paren
op_plus
(paren
id|uda-&gt;cfg
(braket
id|CMD_CH1
)braket
op_amp
l_int|1
)paren
comma
id|uda-&gt;cfg
(braket
id|CMD_CH1
)braket
op_amp
l_int|1
ques
c_cond
l_char|&squot;5&squot;
suffix:colon
l_char|&squot;0&squot;
)paren
suffix:semicolon
)brace
r_else
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Mixer gain channel 1: -INF dB&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|uda-&gt;cfg
(braket
id|CMD_CH2
)braket
OL
l_int|31
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Mixer gain channel 2: -%d.%c dB&bslash;n&quot;
comma
(paren
(paren
id|uda-&gt;cfg
(braket
id|CMD_CH2
)braket
op_rshift
l_int|1
)paren
op_star
l_int|3
)paren
op_plus
(paren
id|uda-&gt;cfg
(braket
id|CMD_CH2
)braket
op_amp
l_int|1
)paren
comma
id|uda-&gt;cfg
(braket
id|CMD_CH2
)braket
op_amp
l_int|1
ques
c_cond
l_char|&squot;5&squot;
suffix:colon
l_char|&squot;0&squot;
)paren
suffix:semicolon
)brace
r_else
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Mixer gain channel 2: -INF dB&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|uda-&gt;cfg
(braket
id|CMD_IG
)braket
OG
l_int|5
)paren
(brace
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Input Amp. Gain ch 2: %d.%c dB&bslash;n&quot;
comma
(paren
id|uda-&gt;cfg
(braket
id|CMD_IG
)braket
op_rshift
l_int|1
)paren
op_minus
l_int|3
comma
id|uda-&gt;cfg
(braket
id|CMD_IG
)braket
op_amp
l_int|1
ques
c_cond
l_char|&squot;5&squot;
suffix:colon
l_char|&squot;0&squot;
)paren
suffix:semicolon
)brace
r_else
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;Input Amp. Gain ch 2: %s dB&bslash;n&quot;
comma
id|ig_small_value
(braket
id|uda-&gt;cfg
(braket
id|CMD_IG
)braket
)braket
)paren
suffix:semicolon
)brace
DECL|function|snd_uda1341_proc_regs_read
r_static
r_void
id|snd_uda1341_proc_regs_read
c_func
(paren
id|snd_info_entry_t
op_star
id|entry
comma
id|snd_info_buffer_t
op_star
id|buffer
)paren
(brace
r_struct
id|l3_client
op_star
id|clnt
op_assign
id|snd_magic_cast
c_func
(paren
id|l3_client_t
comma
id|entry-&gt;private_data
comma
r_return
)paren
suffix:semicolon
r_struct
id|uda1341
op_star
id|uda
op_assign
id|clnt-&gt;driver_data
suffix:semicolon
r_int
id|reg
suffix:semicolon
r_char
id|buf
(braket
l_int|12
)braket
suffix:semicolon
id|DEBUG_NAME
c_func
(paren
id|KERN_DEBUG
l_string|&quot;proc_regs_read&bslash;n&quot;
)paren
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|uda-&gt;reg_lock
)paren
suffix:semicolon
r_for
c_loop
(paren
id|reg
op_assign
l_int|0
suffix:semicolon
id|reg
OL
id|uda1341_reg_last
suffix:semicolon
id|reg
op_increment
)paren
(brace
r_if
c_cond
(paren
id|reg
op_eq
id|empty
)paren
r_continue
suffix:semicolon
id|int2str_bin8
c_func
(paren
id|uda-&gt;regs
(braket
id|reg
)braket
comma
id|buf
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;%s = %s&bslash;n&quot;
comma
id|uda1341_reg_names
(braket
id|reg
)braket
comma
id|buf
)paren
suffix:semicolon
)brace
id|int2str_bin8
c_func
(paren
id|snd_uda1341_codec_read
c_func
(paren
id|clnt
comma
id|UDA1341_DATA1
)paren
comma
id|buf
)paren
suffix:semicolon
id|snd_iprintf
c_func
(paren
id|buffer
comma
l_string|&quot;DATA1 = %s&bslash;n&quot;
comma
id|buf
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|uda-&gt;reg_lock
)paren
suffix:semicolon
)brace
DECL|function|snd_uda1341_proc_init
r_static
r_void
id|__devinit
id|snd_uda1341_proc_init
c_func
(paren
id|snd_card_t
op_star
id|card
comma
r_struct
id|l3_client
op_star
id|clnt
)paren
(brace
id|snd_info_entry_t
op_star
id|entry
suffix:semicolon
r_struct
id|uda1341
op_star
id|uda
op_assign
id|clnt-&gt;driver_data
suffix:semicolon
id|DEBUG_NAME
c_func
(paren
id|KERN_DEBUG
l_string|&quot;proc_init&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|entry
op_assign
id|snd_info_create_card_entry
c_func
(paren
id|card
comma
l_string|&quot;uda1341&quot;
comma
id|card-&gt;proc_root
)paren
)paren
op_ne
l_int|NULL
)paren
(brace
id|entry-&gt;content
op_assign
id|SNDRV_INFO_CONTENT_TEXT
suffix:semicolon
id|entry-&gt;private_data
op_assign
id|clnt
suffix:semicolon
id|entry-&gt;mode
op_assign
id|S_IFREG
op_or
id|S_IRUGO
op_or
id|S_IWUSR
suffix:semicolon
id|entry-&gt;c.text.read_size
op_assign
l_int|512
suffix:semicolon
id|entry-&gt;c.text.read
op_assign
id|snd_uda1341_proc_read
suffix:semicolon
r_if
c_cond
(paren
id|snd_info_register
c_func
(paren
id|entry
)paren
OL
l_int|0
)paren
(brace
id|snd_info_free_entry
c_func
(paren
id|entry
)paren
suffix:semicolon
id|entry
op_assign
l_int|NULL
suffix:semicolon
)brace
)brace
id|uda-&gt;proc_entry
op_assign
id|entry
suffix:semicolon
r_if
c_cond
(paren
(paren
id|entry
op_assign
id|snd_info_create_card_entry
c_func
(paren
id|card
comma
l_string|&quot;uda1341-regs&quot;
comma
id|card-&gt;proc_root
)paren
)paren
op_ne
l_int|NULL
)paren
(brace
id|entry-&gt;content
op_assign
id|SNDRV_INFO_CONTENT_TEXT
suffix:semicolon
id|entry-&gt;private_data
op_assign
id|clnt
suffix:semicolon
id|entry-&gt;mode
op_assign
id|S_IFREG
op_or
id|S_IRUGO
op_or
id|S_IWUSR
suffix:semicolon
id|entry-&gt;c.text.read_size
op_assign
l_int|1024
suffix:semicolon
id|entry-&gt;c.text.read
op_assign
id|snd_uda1341_proc_regs_read
suffix:semicolon
r_if
c_cond
(paren
id|snd_info_register
c_func
(paren
id|entry
)paren
OL
l_int|0
)paren
(brace
id|snd_info_free_entry
c_func
(paren
id|entry
)paren
suffix:semicolon
id|entry
op_assign
l_int|NULL
suffix:semicolon
)brace
)brace
id|uda-&gt;proc_regs_entry
op_assign
id|entry
suffix:semicolon
)brace
DECL|function|snd_uda1341_proc_done
r_static
r_void
id|snd_uda1341_proc_done
c_func
(paren
r_struct
id|l3_client
op_star
id|clnt
)paren
(brace
r_struct
id|uda1341
op_star
id|uda
op_assign
id|clnt-&gt;driver_data
suffix:semicolon
id|DEBUG_NAME
c_func
(paren
id|KERN_DEBUG
l_string|&quot;proc_done&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|uda-&gt;proc_regs_entry
)paren
(brace
id|snd_info_unregister
c_func
(paren
id|uda-&gt;proc_regs_entry
)paren
suffix:semicolon
id|uda-&gt;proc_regs_entry
op_assign
l_int|NULL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|uda-&gt;proc_entry
)paren
(brace
id|snd_info_unregister
c_func
(paren
id|uda-&gt;proc_entry
)paren
suffix:semicolon
id|uda-&gt;proc_entry
op_assign
l_int|NULL
suffix:semicolon
)brace
)brace
multiline_comment|/* }}} */
multiline_comment|/* {{{ Mixer controls setting */
multiline_comment|/* {{{ UDA1341 single functions */
DECL|macro|UDA1341_SINGLE
mdefine_line|#define UDA1341_SINGLE(xname, where, reg, shift, mask, invert) &bslash;&n;{ iface: SNDRV_CTL_ELEM_IFACE_MIXER, name: xname, info: snd_uda1341_info_single, &bslash;&n;  get: snd_uda1341_get_single, put: snd_uda1341_put_single, &bslash;&n;  private_value: where | reg &lt;&lt; 5 | (shift &lt;&lt; 9) | (mask &lt;&lt; 12) | (invert &lt;&lt; 18) &bslash;&n;}
DECL|function|snd_uda1341_info_single
r_static
r_int
id|snd_uda1341_info_single
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
r_int
id|mask
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|12
)paren
op_amp
l_int|63
suffix:semicolon
id|DEBUG_NAME
c_func
(paren
id|KERN_DEBUG
l_string|&quot;info_single where: %ld&bslash;n&quot;
comma
id|kcontrol-&gt;private_value
op_amp
l_int|31
)paren
suffix:semicolon
id|uinfo-&gt;type
op_assign
id|mask
op_eq
l_int|1
ques
c_cond
id|SNDRV_CTL_ELEM_TYPE_BOOLEAN
suffix:colon
id|SNDRV_CTL_ELEM_TYPE_INTEGER
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
id|uinfo-&gt;value.integer.min
op_assign
l_int|0
suffix:semicolon
id|uinfo-&gt;value.integer.max
op_assign
id|mask
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_uda1341_get_single
r_static
r_int
id|snd_uda1341_get_single
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
r_struct
id|l3_client
op_star
id|clnt
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|uda1341_t
op_star
id|uda
op_assign
id|clnt-&gt;driver_data
suffix:semicolon
r_int
id|where
op_assign
id|kcontrol-&gt;private_value
op_amp
l_int|31
suffix:semicolon
r_int
id|mask
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|12
)paren
op_amp
l_int|63
suffix:semicolon
r_int
id|invert
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|18
)paren
op_amp
l_int|1
suffix:semicolon
id|DEBUG_NAME
c_func
(paren
id|KERN_DEBUG
l_string|&quot;get_single where: %d (val: %d)&bslash;n&quot;
comma
id|where
comma
id|uda-&gt;cfg
(braket
id|where
)braket
)paren
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
id|uda-&gt;cfg
(braket
id|where
)braket
suffix:semicolon
r_if
c_cond
(paren
id|invert
)paren
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
id|mask
op_minus
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_uda1341_put_single
r_static
r_int
id|snd_uda1341_put_single
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
r_struct
id|l3_client
op_star
id|clnt
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|uda1341_t
op_star
id|uda
op_assign
id|clnt-&gt;driver_data
suffix:semicolon
r_int
id|where
op_assign
id|kcontrol-&gt;private_value
op_amp
l_int|31
suffix:semicolon
r_int
id|reg
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|5
)paren
op_amp
l_int|15
suffix:semicolon
r_int
id|shift
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|9
)paren
op_amp
l_int|7
suffix:semicolon
r_int
id|mask
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|12
)paren
op_amp
l_int|63
suffix:semicolon
r_int
id|invert
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|18
)paren
op_amp
l_int|1
suffix:semicolon
r_int
r_int
id|val
suffix:semicolon
id|val
op_assign
(paren
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_amp
id|mask
)paren
suffix:semicolon
r_if
c_cond
(paren
id|invert
)paren
id|val
op_assign
id|mask
op_minus
id|val
suffix:semicolon
id|DEBUG
c_func
(paren
id|KERN_DEBUG
l_string|&quot;put_single where: %d reg: %d mask: %d shift: %d inv: %d val: %d&bslash;n&quot;
comma
id|where
comma
id|reg
comma
id|mask
comma
id|shift
comma
id|invert
comma
id|val
)paren
suffix:semicolon
id|uda-&gt;cfg
(braket
id|where
)braket
op_assign
id|val
suffix:semicolon
r_return
id|snd_uda1341_update_bits
c_func
(paren
id|clnt
comma
id|reg
comma
id|mask
comma
id|shift
comma
id|val
comma
id|FLUSH
)paren
suffix:semicolon
)brace
multiline_comment|/* }}} */
multiline_comment|/* {{{ UDA1341 enum functions */
DECL|macro|UDA1341_ENUM
mdefine_line|#define UDA1341_ENUM(xname, where, reg, shift, mask, invert) &bslash;&n;{ iface: SNDRV_CTL_ELEM_IFACE_MIXER, name: xname, info: snd_uda1341_info_enum, &bslash;&n;  get: snd_uda1341_get_enum, put: snd_uda1341_put_enum, &bslash;&n;  private_value: where | reg &lt;&lt; 5 | (shift &lt;&lt; 9) | (mask &lt;&lt; 12) | (invert &lt;&lt; 18) &bslash;&n;}
DECL|function|snd_uda1341_info_enum
r_static
r_int
id|snd_uda1341_info_enum
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
r_int
id|where
op_assign
id|kcontrol-&gt;private_value
op_amp
l_int|31
suffix:semicolon
r_const
r_char
op_star
op_star
id|texts
suffix:semicolon
id|DEBUG_NAME
c_func
(paren
id|KERN_DEBUG
l_string|&quot;info_enum where: %d&bslash;n&quot;
comma
id|where
)paren
suffix:semicolon
singleline_comment|// this register we dont handle this way
r_if
c_cond
(paren
op_logical_neg
id|uda1341_enum_items
(braket
id|where
)braket
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_ENUMERATED
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
id|uinfo-&gt;value.enumerated.items
op_assign
id|uda1341_enum_items
(braket
id|where
)braket
suffix:semicolon
r_if
c_cond
(paren
id|uinfo-&gt;value.enumerated.item
op_ge
id|uda1341_enum_items
(braket
id|where
)braket
)paren
id|uinfo-&gt;value.enumerated.item
op_assign
id|uda1341_enum_items
(braket
id|where
)braket
op_minus
l_int|1
suffix:semicolon
id|texts
op_assign
id|uda1341_enum_names
(braket
id|where
)braket
suffix:semicolon
id|strcpy
c_func
(paren
id|uinfo-&gt;value.enumerated.name
comma
id|texts
(braket
id|uinfo-&gt;value.enumerated.item
)braket
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_uda1341_get_enum
r_static
r_int
id|snd_uda1341_get_enum
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
r_struct
id|l3_client
op_star
id|clnt
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|uda1341_t
op_star
id|uda
op_assign
id|clnt-&gt;driver_data
suffix:semicolon
r_int
id|where
op_assign
id|kcontrol-&gt;private_value
op_amp
l_int|31
suffix:semicolon
id|DEBUG_NAME
c_func
(paren
id|KERN_DEBUG
l_string|&quot;get_enum where: %d (val: %d)&bslash;n&quot;
comma
id|where
comma
id|uda-&gt;cfg
(braket
id|where
)braket
)paren
suffix:semicolon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
id|uda-&gt;cfg
(braket
id|where
)braket
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_uda1341_put_enum
r_static
r_int
id|snd_uda1341_put_enum
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
r_struct
id|l3_client
op_star
id|clnt
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|uda1341_t
op_star
id|uda
op_assign
id|clnt-&gt;driver_data
suffix:semicolon
r_int
id|where
op_assign
id|kcontrol-&gt;private_value
op_amp
l_int|31
suffix:semicolon
r_int
id|reg
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|5
)paren
op_amp
l_int|15
suffix:semicolon
r_int
id|shift
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|9
)paren
op_amp
l_int|7
suffix:semicolon
r_int
id|mask
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|12
)paren
op_amp
l_int|63
suffix:semicolon
id|uda-&gt;cfg
(braket
id|where
)braket
op_assign
(paren
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_amp
id|mask
)paren
suffix:semicolon
id|DEBUG
c_func
(paren
id|KERN_DEBUG
l_string|&quot;put_enum where: %d reg: %d mask: %d shift: %d val: %d&bslash;n&quot;
comma
id|where
comma
id|reg
comma
id|mask
comma
id|shift
comma
id|uda-&gt;cfg
(braket
id|where
)braket
)paren
suffix:semicolon
r_return
id|snd_uda1341_update_bits
c_func
(paren
id|clnt
comma
id|reg
comma
id|mask
comma
id|shift
comma
id|uda-&gt;cfg
(braket
id|where
)braket
comma
id|FLUSH
)paren
suffix:semicolon
)brace
multiline_comment|/* }}} */
multiline_comment|/* {{{ UDA1341 2regs functions */
DECL|macro|UDA1341_2REGS
mdefine_line|#define UDA1341_2REGS(xname, where, reg_1, reg_2, shift_1, shift_2, mask_1, mask_2, invert) &bslash;&n;{ iface: SNDRV_CTL_ELEM_IFACE_MIXER, name: (xname), info: snd_uda1341_info_2regs, &bslash;&n;  get: snd_uda1341_get_2regs, put: snd_uda1341_put_2regs, &bslash;&n;  private_value: where | (reg_1 &lt;&lt; 5) | (reg_2 &lt;&lt; 9) | (shift_1 &lt;&lt; 13) | (shift_2 &lt;&lt; 16) | &bslash;&n;                         (mask_1 &lt;&lt; 19) | (mask_2 &lt;&lt; 25) | (invert &lt;&lt; 31) &bslash;&n;}
DECL|function|snd_uda1341_info_2regs
r_static
r_int
id|snd_uda1341_info_2regs
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
r_int
id|mask_1
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|19
)paren
op_amp
l_int|63
suffix:semicolon
r_int
id|mask_2
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|25
)paren
op_amp
l_int|63
suffix:semicolon
r_int
id|mask
suffix:semicolon
id|DEBUG_NAME
c_func
(paren
id|KERN_DEBUG
l_string|&quot;info_2regs where: %ld&bslash;n&quot;
comma
id|kcontrol-&gt;private_value
op_amp
l_int|31
)paren
suffix:semicolon
id|mask
op_assign
(paren
id|mask_2
op_plus
l_int|1
)paren
op_star
(paren
id|mask_1
op_plus
l_int|1
)paren
op_minus
l_int|1
suffix:semicolon
id|uinfo-&gt;type
op_assign
id|mask
op_eq
l_int|1
ques
c_cond
id|SNDRV_CTL_ELEM_TYPE_BOOLEAN
suffix:colon
id|SNDRV_CTL_ELEM_TYPE_INTEGER
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
id|uinfo-&gt;value.integer.min
op_assign
l_int|0
suffix:semicolon
id|uinfo-&gt;value.integer.max
op_assign
id|mask
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_uda1341_get_2regs
r_static
r_int
id|snd_uda1341_get_2regs
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
r_struct
id|l3_client
op_star
id|clnt
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|uda1341_t
op_star
id|uda
op_assign
id|clnt-&gt;driver_data
suffix:semicolon
r_int
id|where
op_assign
id|kcontrol-&gt;private_value
op_amp
l_int|31
suffix:semicolon
r_int
id|mask_1
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|19
)paren
op_amp
l_int|63
suffix:semicolon
r_int
id|mask_2
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|25
)paren
op_amp
l_int|63
suffix:semicolon
r_int
id|invert
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|31
)paren
op_amp
l_int|1
suffix:semicolon
r_int
id|mask
suffix:semicolon
id|DEBUG_NAME
c_func
(paren
id|KERN_DEBUG
l_string|&quot;get_2regs where: %d (val: %d)&bslash;n&quot;
comma
id|where
comma
id|uda-&gt;cfg
(braket
id|where
)braket
)paren
suffix:semicolon
id|mask
op_assign
(paren
id|mask_2
op_plus
l_int|1
)paren
op_star
(paren
id|mask_1
op_plus
l_int|1
)paren
op_minus
l_int|1
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
id|uda-&gt;cfg
(braket
id|where
)braket
suffix:semicolon
r_if
c_cond
(paren
id|invert
)paren
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
id|mask
op_minus
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_uda1341_put_2regs
r_static
r_int
id|snd_uda1341_put_2regs
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
r_struct
id|l3_client
op_star
id|clnt
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
id|uda1341_t
op_star
id|uda
op_assign
id|clnt-&gt;driver_data
suffix:semicolon
r_int
id|where
op_assign
id|kcontrol-&gt;private_value
op_amp
l_int|31
suffix:semicolon
r_int
id|reg_1
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|5
)paren
op_amp
l_int|15
suffix:semicolon
r_int
id|reg_2
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|9
)paren
op_amp
l_int|15
suffix:semicolon
r_int
id|shift_1
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|13
)paren
op_amp
l_int|7
suffix:semicolon
r_int
id|shift_2
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|16
)paren
op_amp
l_int|7
suffix:semicolon
r_int
id|mask_1
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|19
)paren
op_amp
l_int|63
suffix:semicolon
r_int
id|mask_2
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|25
)paren
op_amp
l_int|63
suffix:semicolon
r_int
id|invert
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|31
)paren
op_amp
l_int|1
suffix:semicolon
r_int
id|mask
suffix:semicolon
r_int
r_int
id|val1
comma
id|val2
comma
id|val
suffix:semicolon
id|val
op_assign
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
suffix:semicolon
id|DEBUG_NAME
c_func
(paren
id|KERN_DEBUG
l_string|&quot;put_2regs where: %d reg1: %d reg2: %d mask1: %d mask2: %d &quot;
l_string|&quot;shift1: %d shift2: %d inv: %d val: %d&bslash;n&quot;
comma
id|where
comma
id|reg_1
comma
id|reg_2
comma
id|mask_1
comma
id|mask_2
comma
id|shift_1
comma
id|shift_2
comma
id|invert
comma
id|val
)paren
suffix:semicolon
id|mask
op_assign
(paren
id|mask_2
op_plus
l_int|1
)paren
op_star
(paren
id|mask_1
op_plus
l_int|1
)paren
op_minus
l_int|1
suffix:semicolon
id|val1
op_assign
id|val
op_amp
id|mask_1
suffix:semicolon
id|val2
op_assign
(paren
id|val
op_div
(paren
id|mask_1
op_plus
l_int|1
)paren
)paren
op_amp
id|mask_2
suffix:semicolon
r_if
c_cond
(paren
id|invert
)paren
(brace
id|val1
op_assign
id|mask_1
op_minus
id|val1
suffix:semicolon
id|val2
op_assign
id|mask_2
op_minus
id|val2
suffix:semicolon
)brace
id|uda-&gt;cfg
(braket
id|where
)braket
op_assign
id|invert
ques
c_cond
id|mask
op_minus
id|val
suffix:colon
id|val
suffix:semicolon
singleline_comment|//FIXME - return value
id|snd_uda1341_update_bits
c_func
(paren
id|clnt
comma
id|reg_1
comma
id|mask_1
comma
id|shift_1
comma
id|val1
comma
id|FLUSH
)paren
suffix:semicolon
r_return
id|snd_uda1341_update_bits
c_func
(paren
id|clnt
comma
id|reg_2
comma
id|mask_2
comma
id|shift_2
comma
id|val2
comma
id|FLUSH
)paren
suffix:semicolon
)brace
multiline_comment|/* }}} */
DECL|macro|UDA1341_CONTROLS
mdefine_line|#define UDA1341_CONTROLS (sizeof(snd_uda1341_controls)/sizeof(snd_kcontrol_new_t))
DECL|variable|snd_uda1341_controls
r_static
id|snd_kcontrol_new_t
id|snd_uda1341_controls
(braket
)braket
op_assign
(brace
id|UDA1341_SINGLE
c_func
(paren
l_string|&quot;Master Playback Switch&quot;
comma
id|CMD_MUTE
comma
id|data0_2
comma
l_int|2
comma
l_int|1
comma
l_int|1
)paren
comma
id|UDA1341_SINGLE
c_func
(paren
l_string|&quot;Master Playback Volume&quot;
comma
id|CMD_VOLUME
comma
id|data0_0
comma
l_int|0
comma
l_int|63
comma
l_int|1
)paren
comma
id|UDA1341_SINGLE
c_func
(paren
l_string|&quot;Bass Playback Volume&quot;
comma
id|CMD_BASS
comma
id|data0_1
comma
l_int|2
comma
l_int|15
comma
l_int|0
)paren
comma
id|UDA1341_SINGLE
c_func
(paren
l_string|&quot;Treble Playback Volume&quot;
comma
id|CMD_TREBBLE
comma
id|data0_1
comma
l_int|0
comma
l_int|3
comma
l_int|0
)paren
comma
id|UDA1341_SINGLE
c_func
(paren
l_string|&quot;Input Gain Switch&quot;
comma
id|CMD_IGAIN
comma
id|stat1
comma
l_int|5
comma
l_int|1
comma
l_int|0
)paren
comma
id|UDA1341_SINGLE
c_func
(paren
l_string|&quot;Output Gain Switch&quot;
comma
id|CMD_OGAIN
comma
id|stat1
comma
l_int|6
comma
l_int|1
comma
l_int|0
)paren
comma
id|UDA1341_SINGLE
c_func
(paren
l_string|&quot;Mixer Gain Channel 1 Volume&quot;
comma
id|CMD_CH1
comma
id|ext0
comma
l_int|0
comma
l_int|31
comma
l_int|1
)paren
comma
id|UDA1341_SINGLE
c_func
(paren
l_string|&quot;Mixer Gain Channel 2 Volume&quot;
comma
id|CMD_CH2
comma
id|ext1
comma
l_int|0
comma
l_int|31
comma
l_int|1
)paren
comma
id|UDA1341_SINGLE
c_func
(paren
l_string|&quot;Mic Sensitivity Volume&quot;
comma
id|CMD_MIC
comma
id|ext2
comma
l_int|2
comma
l_int|7
comma
l_int|0
)paren
comma
id|UDA1341_SINGLE
c_func
(paren
l_string|&quot;AGC Output Level&quot;
comma
id|CMD_AGC_LEVEL
comma
id|ext6
comma
l_int|0
comma
l_int|3
comma
l_int|0
)paren
comma
id|UDA1341_SINGLE
c_func
(paren
l_string|&quot;AGC Time Constant&quot;
comma
id|CMD_AGC_TIME
comma
id|ext6
comma
l_int|2
comma
l_int|7
comma
l_int|0
)paren
comma
id|UDA1341_SINGLE
c_func
(paren
l_string|&quot;AGC Time Constant Switch&quot;
comma
id|CMD_AGC
comma
id|ext4
comma
l_int|4
comma
l_int|1
comma
l_int|0
)paren
comma
id|UDA1341_SINGLE
c_func
(paren
l_string|&quot;DAC Power&quot;
comma
id|CMD_DAC
comma
id|stat1
comma
l_int|0
comma
l_int|1
comma
l_int|0
)paren
comma
id|UDA1341_SINGLE
c_func
(paren
l_string|&quot;ADC Power&quot;
comma
id|CMD_ADC
comma
id|stat1
comma
l_int|1
comma
l_int|1
comma
l_int|0
)paren
comma
id|UDA1341_ENUM
c_func
(paren
l_string|&quot;Peak detection&quot;
comma
id|CMD_PEAK
comma
id|data0_2
comma
l_int|5
comma
l_int|1
comma
l_int|0
)paren
comma
id|UDA1341_ENUM
c_func
(paren
l_string|&quot;De-emphasis&quot;
comma
id|CMD_DEEMP
comma
id|data0_2
comma
l_int|3
comma
l_int|3
comma
l_int|0
)paren
comma
id|UDA1341_ENUM
c_func
(paren
l_string|&quot;Mixer mode&quot;
comma
id|CMD_MIXER
comma
id|ext2
comma
l_int|0
comma
l_int|3
comma
l_int|0
)paren
comma
id|UDA1341_ENUM
c_func
(paren
l_string|&quot;Filter mode&quot;
comma
id|CMD_FILTER
comma
id|data0_2
comma
l_int|0
comma
l_int|3
comma
l_int|0
)paren
comma
id|UDA1341_2REGS
c_func
(paren
l_string|&quot;Gain Input Amplifier Gain (channel 2)&quot;
comma
id|CMD_IG
comma
id|ext4
comma
id|ext5
comma
l_int|0
comma
l_int|0
comma
l_int|3
comma
l_int|31
comma
l_int|0
)paren
comma
)brace
suffix:semicolon
DECL|function|snd_chip_uda1341_mixer_new
r_int
id|__init
id|snd_chip_uda1341_mixer_new
c_func
(paren
id|snd_card_t
op_star
id|card
comma
r_struct
id|l3_client
op_star
op_star
id|clnt
)paren
(brace
r_int
id|idx
comma
id|err
suffix:semicolon
id|DEBUG_NAME
c_func
(paren
id|KERN_DEBUG
l_string|&quot;uda1341 mixer_new&bslash;n&quot;
)paren
suffix:semicolon
id|snd_assert
c_func
(paren
id|card
op_ne
l_int|NULL
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|uda1341
op_assign
id|snd_magic_kcalloc
c_func
(paren
id|l3_client_t
comma
l_int|0
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|uda1341
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|l3_attach_client
c_func
(paren
id|uda1341
comma
l_string|&quot;l3-bit-sa1100-gpio&quot;
comma
l_string|&quot;snd-uda1341&quot;
)paren
)paren
)paren
r_return
op_minus
id|ENODEV
suffix:semicolon
r_for
c_loop
(paren
id|idx
op_assign
l_int|0
suffix:semicolon
id|idx
OL
id|UDA1341_CONTROLS
suffix:semicolon
id|idx
op_increment
)paren
(brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|card
comma
id|snd_ctl_new1
c_func
(paren
op_amp
id|snd_uda1341_controls
(braket
id|idx
)braket
comma
id|uda1341
)paren
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
op_star
id|clnt
op_assign
id|uda1341
suffix:semicolon
id|strcpy
c_func
(paren
id|card-&gt;mixername
comma
l_string|&quot;UDA1341TS Mixer&quot;
)paren
suffix:semicolon
(paren
(paren
id|uda1341_t
op_star
)paren
id|uda1341-&gt;driver_data
)paren
op_member_access_from_pointer
id|card
op_assign
id|card
suffix:semicolon
id|snd_uda1341_proc_init
c_func
(paren
id|card
comma
id|uda1341
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_chip_uda1341_mixer_del
r_void
id|__init
id|snd_chip_uda1341_mixer_del
c_func
(paren
id|snd_card_t
op_star
id|card
)paren
(brace
id|DEBUG_NAME
c_func
(paren
id|KERN_DEBUG
l_string|&quot;uda1341 mixer_del&bslash;n&quot;
)paren
suffix:semicolon
id|snd_uda1341_proc_done
c_func
(paren
id|uda1341
)paren
suffix:semicolon
id|l3_detach_client
c_func
(paren
id|uda1341
)paren
suffix:semicolon
id|snd_magic_kfree
c_func
(paren
id|uda1341
)paren
suffix:semicolon
id|uda1341
op_assign
l_int|NULL
suffix:semicolon
)brace
multiline_comment|/* }}} */
multiline_comment|/* {{{ L3 operations */
DECL|function|uda1341_attach
r_static
r_int
id|uda1341_attach
c_func
(paren
r_struct
id|l3_client
op_star
id|clnt
)paren
(brace
r_struct
id|uda1341
op_star
id|uda
suffix:semicolon
id|DEBUG_NAME
c_func
(paren
id|KERN_DEBUG
l_string|&quot;uda1341 attach&bslash;n&quot;
)paren
suffix:semicolon
id|uda
op_assign
id|snd_magic_kcalloc
c_func
(paren
id|uda1341_t
comma
l_int|0
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|uda
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|memset
c_func
(paren
id|uda
comma
l_int|0
comma
r_sizeof
(paren
op_star
id|uda
)paren
)paren
suffix:semicolon
multiline_comment|/* init fixed parts of my copy of registers */
id|uda-&gt;regs
(braket
id|stat0
)braket
op_assign
id|STAT0
suffix:semicolon
id|uda-&gt;regs
(braket
id|stat1
)braket
op_assign
id|STAT1
suffix:semicolon
id|uda-&gt;regs
(braket
id|data0_0
)braket
op_assign
id|DATA0_0
suffix:semicolon
id|uda-&gt;regs
(braket
id|data0_1
)braket
op_assign
id|DATA0_1
suffix:semicolon
id|uda-&gt;regs
(braket
id|data0_2
)braket
op_assign
id|DATA0_2
suffix:semicolon
id|uda-&gt;write
op_assign
id|snd_uda1341_codec_write
suffix:semicolon
id|uda-&gt;read
op_assign
id|snd_uda1341_codec_read
suffix:semicolon
id|spin_lock_init
c_func
(paren
op_amp
id|uda-&gt;reg_lock
)paren
suffix:semicolon
id|clnt-&gt;driver_data
op_assign
id|uda
suffix:semicolon
singleline_comment|//l3_open(clnt);
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|uda1341_detach
r_static
r_void
id|uda1341_detach
c_func
(paren
r_struct
id|l3_client
op_star
id|clnt
)paren
(brace
id|DEBUG_NAME
c_func
(paren
id|KERN_DEBUG
l_string|&quot;uda1341 detach&bslash;n&quot;
)paren
suffix:semicolon
id|snd_magic_kfree
c_func
(paren
id|clnt-&gt;driver_data
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|uda1341_command
id|uda1341_command
c_func
(paren
r_struct
id|l3_client
op_star
id|clnt
comma
r_int
id|cmd
comma
r_void
op_star
id|arg
)paren
(brace
id|DEBUG_NAME
c_func
(paren
id|KERN_DEBUG
l_string|&quot;l3_command&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|cmd
op_ne
id|CMD_READ_REG
)paren
r_return
id|snd_uda1341_cfg_write
c_func
(paren
id|clnt
comma
id|cmd
comma
(paren
r_int
)paren
id|arg
comma
id|FLUSH
)paren
suffix:semicolon
r_return
id|snd_uda1341_codec_read
c_func
(paren
id|clnt
comma
(paren
r_int
)paren
id|arg
)paren
suffix:semicolon
)brace
DECL|function|uda1341_open
r_static
r_int
id|uda1341_open
c_func
(paren
r_struct
id|l3_client
op_star
id|clnt
)paren
(brace
r_struct
id|uda1341
op_star
id|uda
op_assign
id|clnt-&gt;driver_data
suffix:semicolon
id|DEBUG_NAME
c_func
(paren
id|KERN_DEBUG
l_string|&quot;uda1341 open&bslash;n&quot;
)paren
suffix:semicolon
id|uda-&gt;active
op_assign
l_int|1
suffix:semicolon
multiline_comment|/* init default configuration */
id|snd_uda1341_cfg_write
c_func
(paren
id|clnt
comma
id|CMD_RESET
comma
l_int|0
comma
id|REGS_ONLY
)paren
suffix:semicolon
id|snd_uda1341_cfg_write
c_func
(paren
id|clnt
comma
id|CMD_FS
comma
id|F256
comma
id|FLUSH
)paren
suffix:semicolon
singleline_comment|// unknown state after reset
id|snd_uda1341_cfg_write
c_func
(paren
id|clnt
comma
id|CMD_FORMAT
comma
id|LSB16
comma
id|FLUSH
)paren
suffix:semicolon
singleline_comment|// unknown state after reset
id|snd_uda1341_cfg_write
c_func
(paren
id|clnt
comma
id|CMD_OGAIN
comma
id|ON
comma
id|FLUSH
)paren
suffix:semicolon
singleline_comment|// default off after reset
id|snd_uda1341_cfg_write
c_func
(paren
id|clnt
comma
id|CMD_IGAIN
comma
id|ON
comma
id|FLUSH
)paren
suffix:semicolon
singleline_comment|// default off after reset
id|snd_uda1341_cfg_write
c_func
(paren
id|clnt
comma
id|CMD_DAC
comma
id|ON
comma
id|FLUSH
)paren
suffix:semicolon
singleline_comment|// ??? default value after reset
id|snd_uda1341_cfg_write
c_func
(paren
id|clnt
comma
id|CMD_ADC
comma
id|ON
comma
id|FLUSH
)paren
suffix:semicolon
singleline_comment|// ??? default value after reset
id|snd_uda1341_cfg_write
c_func
(paren
id|clnt
comma
id|CMD_VOLUME
comma
l_int|20
comma
id|FLUSH
)paren
suffix:semicolon
singleline_comment|// default 0dB after reset
id|snd_uda1341_cfg_write
c_func
(paren
id|clnt
comma
id|CMD_BASS
comma
l_int|0
comma
id|REGS_ONLY
)paren
suffix:semicolon
singleline_comment|// default value after reset
id|snd_uda1341_cfg_write
c_func
(paren
id|clnt
comma
id|CMD_TREBBLE
comma
l_int|0
comma
id|REGS_ONLY
)paren
suffix:semicolon
singleline_comment|// default value after reset
id|snd_uda1341_cfg_write
c_func
(paren
id|clnt
comma
id|CMD_PEAK
comma
id|AFTER
comma
id|REGS_ONLY
)paren
suffix:semicolon
singleline_comment|// default value after reset
id|snd_uda1341_cfg_write
c_func
(paren
id|clnt
comma
id|CMD_DEEMP
comma
id|NONE
comma
id|REGS_ONLY
)paren
suffix:semicolon
singleline_comment|// default value after reset
singleline_comment|//at this moment should be QMUTED by h3600_audio_init
id|snd_uda1341_cfg_write
c_func
(paren
id|clnt
comma
id|CMD_MUTE
comma
id|OFF
comma
id|REGS_ONLY
)paren
suffix:semicolon
singleline_comment|// default value after reset
id|snd_uda1341_cfg_write
c_func
(paren
id|clnt
comma
id|CMD_FILTER
comma
id|MAX
comma
id|FLUSH
)paren
suffix:semicolon
singleline_comment|// defaul flat after reset
id|snd_uda1341_cfg_write
c_func
(paren
id|clnt
comma
id|CMD_CH1
comma
l_int|31
comma
id|FLUSH
)paren
suffix:semicolon
singleline_comment|// default value after reset
id|snd_uda1341_cfg_write
c_func
(paren
id|clnt
comma
id|CMD_CH2
comma
l_int|4
comma
id|FLUSH
)paren
suffix:semicolon
singleline_comment|// default value after reset
id|snd_uda1341_cfg_write
c_func
(paren
id|clnt
comma
id|CMD_MIC
comma
l_int|4
comma
id|FLUSH
)paren
suffix:semicolon
singleline_comment|// default 0dB after reset
id|snd_uda1341_cfg_write
c_func
(paren
id|clnt
comma
id|CMD_MIXER
comma
id|MIXER
comma
id|FLUSH
)paren
suffix:semicolon
singleline_comment|// default doub.dif.mode          
id|snd_uda1341_cfg_write
c_func
(paren
id|clnt
comma
id|CMD_AGC
comma
id|OFF
comma
id|FLUSH
)paren
suffix:semicolon
singleline_comment|// default value after reset
id|snd_uda1341_cfg_write
c_func
(paren
id|clnt
comma
id|CMD_IG
comma
l_int|0
comma
id|FLUSH
)paren
suffix:semicolon
singleline_comment|// unknown state after reset
id|snd_uda1341_cfg_write
c_func
(paren
id|clnt
comma
id|CMD_AGC_TIME
comma
l_int|0
comma
id|FLUSH
)paren
suffix:semicolon
singleline_comment|// default value after reset
id|snd_uda1341_cfg_write
c_func
(paren
id|clnt
comma
id|CMD_AGC_LEVEL
comma
l_int|0
comma
id|FLUSH
)paren
suffix:semicolon
singleline_comment|// default value after reset
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|uda1341_close
r_static
r_void
id|uda1341_close
c_func
(paren
r_struct
id|l3_client
op_star
id|clnt
)paren
(brace
r_struct
id|uda1341
op_star
id|uda
op_assign
id|clnt-&gt;driver_data
suffix:semicolon
id|DEBUG_NAME
c_func
(paren
id|KERN_DEBUG
l_string|&quot;uda1341 close&bslash;n&quot;
)paren
suffix:semicolon
id|uda-&gt;active
op_assign
l_int|0
suffix:semicolon
)brace
multiline_comment|/* }}} */
multiline_comment|/* {{{ Module and L3 initialization */
DECL|variable|uda1341_ops
r_static
r_struct
id|l3_ops
id|uda1341_ops
op_assign
(brace
id|open
suffix:colon
id|uda1341_open
comma
id|command
suffix:colon
id|uda1341_command
comma
id|close
suffix:colon
id|uda1341_close
comma
)brace
suffix:semicolon
DECL|variable|uda1341_driver
r_static
r_struct
id|l3_driver
id|uda1341_driver
op_assign
(brace
id|name
suffix:colon
id|UDA1341_ALSA_NAME
comma
id|attach_client
suffix:colon
id|uda1341_attach
comma
id|detach_client
suffix:colon
id|uda1341_detach
comma
id|ops
suffix:colon
op_amp
id|uda1341_ops
comma
id|owner
suffix:colon
id|THIS_MODULE
comma
)brace
suffix:semicolon
DECL|function|uda1341_init
r_static
r_int
id|__init
id|uda1341_init
c_func
(paren
r_void
)paren
(brace
r_return
id|l3_add_driver
c_func
(paren
op_amp
id|uda1341_driver
)paren
suffix:semicolon
)brace
DECL|function|uda1341_exit
r_static
r_void
id|__exit
id|uda1341_exit
c_func
(paren
r_void
)paren
(brace
id|l3_del_driver
c_func
(paren
op_amp
id|uda1341_driver
)paren
suffix:semicolon
)brace
DECL|variable|uda1341_init
id|module_init
c_func
(paren
id|uda1341_init
)paren
suffix:semicolon
DECL|variable|uda1341_exit
id|module_exit
c_func
(paren
id|uda1341_exit
)paren
suffix:semicolon
id|MODULE_AUTHOR
c_func
(paren
l_string|&quot;Tomas Kasparek &lt;tomas.kasparek@seznam.cz&gt;&quot;
)paren
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
id|MODULE_DESCRIPTION
c_func
(paren
l_string|&quot;Philips UDA1341 CODEC driver for ALSA&quot;
)paren
suffix:semicolon
id|MODULE_CLASSES
c_func
(paren
l_string|&quot;{sound}&quot;
)paren
suffix:semicolon
id|MODULE_DEVICES
c_func
(paren
l_string|&quot;{{UDA1341,UDA1341TS}}&quot;
)paren
suffix:semicolon
DECL|variable|snd_chip_uda1341_mixer_new
id|EXPORT_SYMBOL
c_func
(paren
id|snd_chip_uda1341_mixer_new
)paren
suffix:semicolon
DECL|variable|snd_chip_uda1341_mixer_del
id|EXPORT_SYMBOL
c_func
(paren
id|snd_chip_uda1341_mixer_del
)paren
suffix:semicolon
multiline_comment|/* }}} */
multiline_comment|/*&n; * Local variables:&n; * indent-tabs-mode: t&n; * End:&n; */
eof
