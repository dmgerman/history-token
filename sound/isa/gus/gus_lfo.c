multiline_comment|/*&n; *  Copyright (c) by Jaroslav Kysela &lt;perex@suse.cz&gt;&n; *  Routines for control of LFO generators (tremolo &amp; vibrato) for&n; *  GF1/InterWave chips...&n; *&n; *&n; *   This program is free software; you can redistribute it and/or modify&n; *   it under the terms of the GNU General Public License as published by&n; *   the Free Software Foundation; either version 2 of the License, or&n; *   (at your option) any later version.&n; *&n; *   This program is distributed in the hope that it will be useful,&n; *   but WITHOUT ANY WARRANTY; without even the implied warranty of&n; *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; *   GNU General Public License for more details.&n; *&n; *   You should have received a copy of the GNU General Public License&n; *   along with this program; if not, write to the Free Software&n; *   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA&n; *&n; */
DECL|macro|__NO_VERSION__
mdefine_line|#define __NO_VERSION__
macro_line|#include &lt;sound/driver.h&gt;
macro_line|#include &lt;sound/core.h&gt;
macro_line|#include &lt;sound/gus.h&gt;
multiline_comment|/*&n; *  called by engine routines&n; */
DECL|function|snd_gf1_lfo_compute_value
r_static
r_int
r_char
id|snd_gf1_lfo_compute_value
c_func
(paren
id|snd_gus_card_t
op_star
id|gus
comma
r_int
r_char
op_star
id|ptr
)paren
(brace
r_int
r_int
id|twaveinc
comma
id|depth_delta
suffix:semicolon
r_int
r_int
id|result
suffix:semicolon
r_int
r_int
id|control
comma
id|twave
comma
id|depth
comma
id|depth_final
suffix:semicolon
r_int
r_char
op_star
id|ptr1
suffix:semicolon
id|control
op_assign
op_star
(paren
r_int
r_int
op_star
)paren
(paren
id|ptr
op_plus
l_int|0x00
)paren
suffix:semicolon
id|ptr1
op_assign
id|ptr
op_plus
(paren
(paren
id|control
op_amp
l_int|0x4000
)paren
op_rshift
l_int|12
)paren
suffix:semicolon
multiline_comment|/* 1. add TWAVEINC to TWAVE and write the result back */
multiline_comment|/* LFO update rate is 689Hz, effect timer is in ms */
r_if
c_cond
(paren
id|gus-&gt;gf1.timer_slave
)paren
id|twaveinc
op_assign
(paren
l_int|689
op_star
id|gus-&gt;gf1.timer_master_gus-&gt;gf1.effect_timer
)paren
op_div
l_int|1000
suffix:semicolon
r_else
id|twaveinc
op_assign
(paren
l_int|689
op_star
id|gus-&gt;gf1.effect_timer
)paren
op_div
l_int|1000
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|twaveinc
)paren
id|twaveinc
op_increment
suffix:semicolon
macro_line|#if 0
id|printk
c_func
(paren
l_string|&quot;twaveinc = 0x%x, effect_timer = %i&bslash;n&quot;
comma
id|twaveinc
comma
id|gus-&gt;gf1.effect_timer
)paren
suffix:semicolon
macro_line|#endif
id|depth
op_assign
op_star
(paren
r_int
r_int
op_star
)paren
(paren
id|ptr1
op_plus
l_int|0x0a
)paren
suffix:semicolon
id|depth_final
op_assign
op_star
(paren
r_int
r_char
op_star
)paren
(paren
id|ptr
op_plus
l_int|0x02
)paren
op_lshift
l_int|5
suffix:semicolon
r_if
c_cond
(paren
id|depth
op_ne
id|depth_final
)paren
(brace
id|depth_delta
op_assign
(paren
(paren
id|twaveinc
op_star
op_star
(paren
id|ptr
op_plus
l_int|0x03
)paren
)paren
op_plus
op_star
(paren
r_int
r_int
op_star
)paren
(paren
id|ptr
op_plus
l_int|0x04
)paren
)paren
suffix:semicolon
op_star
(paren
r_int
r_int
op_star
)paren
(paren
id|ptr
op_plus
l_int|0x04
)paren
op_assign
id|depth_delta
op_mod
l_int|8000
suffix:semicolon
id|depth_delta
op_div_assign
l_int|8000
suffix:semicolon
r_if
c_cond
(paren
id|depth
OL
id|depth_final
)paren
(brace
r_if
c_cond
(paren
id|depth
op_plus
id|depth_delta
OG
id|depth_final
)paren
id|depth
op_assign
id|depth_final
suffix:semicolon
r_else
id|depth
op_add_assign
id|depth_delta
suffix:semicolon
)brace
r_if
c_cond
(paren
id|depth
OG
id|depth_final
)paren
(brace
r_if
c_cond
(paren
id|depth
op_minus
id|depth_delta
OL
id|depth_final
)paren
id|depth
op_assign
id|depth_final
suffix:semicolon
r_else
id|depth
op_sub_assign
id|depth_delta
suffix:semicolon
)brace
op_star
(paren
r_int
r_int
op_star
)paren
(paren
id|ptr1
op_plus
l_int|0x0a
)paren
op_assign
id|depth
suffix:semicolon
)brace
id|twaveinc
op_mul_assign
(paren
r_int
r_int
)paren
id|control
op_amp
l_int|0x7ff
suffix:semicolon
id|twaveinc
op_add_assign
op_star
(paren
r_int
r_int
op_star
)paren
(paren
id|ptr
op_plus
l_int|0x06
)paren
suffix:semicolon
op_star
(paren
r_int
r_int
op_star
)paren
(paren
id|ptr
op_plus
l_int|0x06
)paren
op_assign
id|twaveinc
op_mod
l_int|1000
suffix:semicolon
id|twave
op_assign
op_star
(paren
r_int
r_int
op_star
)paren
(paren
id|ptr1
op_plus
l_int|0x08
)paren
suffix:semicolon
id|twave
op_add_assign
(paren
r_int
r_int
)paren
(paren
id|twaveinc
op_div
(paren
r_int
r_int
)paren
l_int|1000
)paren
suffix:semicolon
op_star
(paren
r_int
r_int
op_star
)paren
(paren
id|ptr1
op_plus
l_int|0x08
)paren
op_assign
id|twave
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|control
op_amp
l_int|0x2000
)paren
)paren
(brace
multiline_comment|/* 2. if shift is low */
r_if
c_cond
(paren
id|twave
op_amp
l_int|0x4000
)paren
(brace
multiline_comment|/* bit 14 high -&gt; invert TWAVE 13-0 */
id|twave
op_xor_assign
l_int|0x3fff
suffix:semicolon
id|twave
op_and_assign
op_complement
l_int|0x4000
suffix:semicolon
)brace
multiline_comment|/* TWAVE bit 15 is exclusive or&squot;d with the invert bit (12) */
id|twave
op_xor_assign
(paren
id|control
op_amp
l_int|0x1000
)paren
op_lshift
l_int|3
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* 2. if shift is high */
r_if
c_cond
(paren
id|twave
op_amp
l_int|0x8000
)paren
multiline_comment|/* bit 15 high -&gt; invert TWAVE 14-0 */
id|twave
op_xor_assign
l_int|0x7fff
suffix:semicolon
multiline_comment|/* the invert bit (12) is used as sign bit */
r_if
c_cond
(paren
id|control
op_amp
l_int|0x1000
)paren
id|twave
op_or_assign
l_int|0x8000
suffix:semicolon
r_else
id|twave
op_and_assign
op_complement
l_int|0x8000
suffix:semicolon
)brace
multiline_comment|/* 3. multiply the 14-bit LFO waveform magnitude by 13-bit DEPTH */
macro_line|#if 0
id|printk
c_func
(paren
l_string|&quot;c=0x%x,tw=0x%x,to=0x%x,d=0x%x,df=0x%x,di=0x%x,r=0x%x,r1=%i&bslash;n&quot;
comma
id|control
comma
id|twave
comma
op_star
(paren
r_int
r_int
op_star
)paren
(paren
id|ptr1
op_plus
l_int|0x08
)paren
comma
id|depth
comma
id|depth_final
comma
op_star
(paren
id|ptr
op_plus
l_int|0x03
)paren
comma
(paren
id|twave
op_amp
l_int|0x7fff
)paren
op_star
id|depth
comma
(paren
(paren
id|twave
op_amp
l_int|0x7fff
)paren
op_star
id|depth
)paren
op_rshift
l_int|21
)paren
suffix:semicolon
macro_line|#endif
id|result
op_assign
(paren
id|twave
op_amp
l_int|0x7fff
)paren
op_star
id|depth
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
multiline_comment|/* shift */
id|result
op_rshift_assign
l_int|21
suffix:semicolon
id|result
op_and_assign
l_int|0x3f
suffix:semicolon
)brace
multiline_comment|/* add sign */
r_if
c_cond
(paren
id|twave
op_amp
l_int|0x8000
)paren
id|result
op_assign
op_minus
id|result
suffix:semicolon
macro_line|#if 0
id|printk
c_func
(paren
l_string|&quot;lfo final value = %i&bslash;n&quot;
comma
id|result
)paren
suffix:semicolon
macro_line|#endif
r_return
id|result
suffix:semicolon
)brace
DECL|function|snd_gf1_lfo_register_setup
r_static
r_void
id|snd_gf1_lfo_register_setup
c_func
(paren
id|snd_gus_card_t
op_star
id|gus
comma
id|snd_gf1_voice_t
op_star
id|voice
comma
r_int
id|lfo_type
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
r_if
c_cond
(paren
id|gus-&gt;gf1.enh_mode
)paren
(brace
id|CLI
c_func
(paren
op_amp
id|flags
)paren
suffix:semicolon
id|gf1_select_voice
c_func
(paren
id|gus
comma
id|voice-&gt;number
)paren
suffix:semicolon
r_if
c_cond
(paren
id|lfo_type
op_amp
l_int|1
)paren
(brace
id|snd_gf1_write8
c_func
(paren
id|gus
comma
id|GF1_VB_FREQUENCY_LFO
comma
id|voice-&gt;lfo_fc
)paren
suffix:semicolon
id|voice-&gt;lfo_fc
op_assign
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|lfo_type
op_amp
l_int|2
)paren
(brace
id|snd_gf1_write8
c_func
(paren
id|gus
comma
id|GF1_VB_VOLUME_LFO
comma
id|voice-&gt;lfo_volume
)paren
suffix:semicolon
id|voice-&gt;lfo_volume
op_assign
l_int|0
suffix:semicolon
)brace
id|STI
c_func
(paren
op_amp
id|flags
)paren
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/*&n;&t;&t; * ok.. with old GF1 chip can be only vibrato emulated...&n;&t;&t; * volume register can be in volume ramp state, so tremolo isn&squot;t simple..&n;&t;&t; */
r_if
c_cond
(paren
op_logical_neg
(paren
id|lfo_type
op_amp
l_int|1
)paren
)paren
r_return
suffix:semicolon
macro_line|#if 0
r_if
c_cond
(paren
id|voice-&gt;lfo_fc
)paren
id|printk
c_func
(paren
l_string|&quot;setup - %i = %i&bslash;n&quot;
comma
id|voice-&gt;number
comma
id|voice-&gt;lfo_fc
)paren
suffix:semicolon
macro_line|#endif
id|CLI
c_func
(paren
op_amp
id|flags
)paren
suffix:semicolon
id|gf1_select_voice
c_func
(paren
id|gus
comma
id|voice-&gt;number
)paren
suffix:semicolon
id|snd_gf1_write16
c_func
(paren
id|gus
comma
id|GF1_VW_FREQUENCY
comma
id|voice-&gt;fc_register
op_plus
id|voice-&gt;lfo_fc
)paren
suffix:semicolon
id|STI
c_func
(paren
op_amp
id|flags
)paren
suffix:semicolon
)brace
)brace
DECL|function|snd_gf1_lfo_effect_interrupt
r_void
id|snd_gf1_lfo_effect_interrupt
c_func
(paren
id|snd_gus_card_t
op_star
id|gus
comma
id|snd_gf1_voice_t
op_star
id|voice
)paren
(brace
r_int
r_char
op_star
id|ptr
suffix:semicolon
macro_line|#if 0
r_if
c_cond
(paren
id|voice-&gt;number
op_ne
l_int|0
)paren
r_return
suffix:semicolon
macro_line|#endif
id|ptr
op_assign
id|gus-&gt;gf1.lfos
op_plus
(paren
(paren
id|voice-&gt;number
)paren
op_lshift
l_int|5
)paren
suffix:semicolon
multiline_comment|/* 1. vibrato */
r_if
c_cond
(paren
op_star
(paren
r_int
r_int
op_star
)paren
(paren
id|ptr
op_plus
l_int|0x00
)paren
op_amp
l_int|0x8000
)paren
id|voice-&gt;lfo_fc
op_assign
id|snd_gf1_lfo_compute_value
c_func
(paren
id|gus
comma
id|ptr
)paren
suffix:semicolon
multiline_comment|/* 2. tremolo */
id|ptr
op_add_assign
l_int|16
suffix:semicolon
r_if
c_cond
(paren
op_star
(paren
r_int
r_int
op_star
)paren
(paren
id|ptr
op_plus
l_int|0x00
)paren
op_amp
l_int|0x8000
)paren
id|voice-&gt;lfo_volume
op_assign
id|snd_gf1_lfo_compute_value
c_func
(paren
id|gus
comma
id|ptr
)paren
suffix:semicolon
multiline_comment|/* 3. register setup */
id|snd_gf1_lfo_register_setup
c_func
(paren
id|gus
comma
id|voice
comma
l_int|3
)paren
suffix:semicolon
)brace
multiline_comment|/*&n;&n; */
DECL|function|snd_gf1_lfo_init
r_void
id|snd_gf1_lfo_init
c_func
(paren
id|snd_gus_card_t
op_star
id|gus
)paren
(brace
r_if
c_cond
(paren
id|gus-&gt;gf1.hw_lfo
)paren
(brace
id|snd_gf1_i_write16
c_func
(paren
id|gus
comma
id|GF1_GW_LFO_BASE
comma
l_int|0x0000
)paren
suffix:semicolon
id|snd_gf1_dram_setmem
c_func
(paren
id|gus
comma
l_int|0
comma
l_int|0x0000
comma
l_int|1024
)paren
suffix:semicolon
multiline_comment|/* now enable LFO */
id|snd_gf1_i_write8
c_func
(paren
id|gus
comma
id|GF1_GB_GLOBAL_MODE
comma
id|snd_gf1_i_look8
c_func
(paren
id|gus
comma
id|GF1_GB_GLOBAL_MODE
)paren
op_or
l_int|0x02
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|gus-&gt;gf1.sw_lfo
)paren
(brace
macro_line|#if 1
id|gus-&gt;gf1.lfos
op_assign
id|snd_calloc
c_func
(paren
l_int|1024
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|gus-&gt;gf1.lfos
)paren
macro_line|#endif
id|gus-&gt;gf1.sw_lfo
op_assign
l_int|0
suffix:semicolon
)brace
)brace
DECL|function|snd_gf1_lfo_done
r_void
id|snd_gf1_lfo_done
c_func
(paren
id|snd_gus_card_t
op_star
id|gus
)paren
(brace
r_if
c_cond
(paren
id|gus-&gt;gf1.sw_lfo
)paren
(brace
r_if
c_cond
(paren
id|gus-&gt;gf1.lfos
)paren
(brace
id|snd_gf1_free
c_func
(paren
id|gus-&gt;gf1.lfos
comma
l_int|1024
)paren
suffix:semicolon
id|gus-&gt;gf1.lfos
op_assign
l_int|NULL
suffix:semicolon
)brace
)brace
)brace
DECL|function|snd_gf1_lfo_program
r_void
id|snd_gf1_lfo_program
c_func
(paren
id|snd_gus_card_t
op_star
id|gus
comma
r_int
id|voice
comma
r_int
id|lfo_type
comma
r_struct
id|ULTRA_STRU_IW_LFO_PROGRAM
op_star
id|program
)paren
(brace
r_int
r_int
id|lfo_addr
comma
id|wave_select
suffix:semicolon
id|wave_select
op_assign
(paren
id|program-&gt;freq_and_control
op_amp
l_int|0x4000
)paren
op_rshift
l_int|12
suffix:semicolon
id|lfo_addr
op_assign
(paren
id|voice
op_lshift
l_int|5
)paren
op_or
(paren
id|lfo_type
op_lshift
l_int|4
)paren
suffix:semicolon
r_if
c_cond
(paren
id|gus-&gt;gf1.hw_lfo
)paren
(brace
macro_line|#if 0
id|printk
c_func
(paren
l_string|&quot;LMCI = 0x%x&bslash;n&quot;
comma
id|snd_gf1_i_look8
c_func
(paren
id|gus
comma
l_int|0x53
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;lfo_program: lfo_addr=0x%x,wave_sel=0x%x,fac=0x%x,df=0x%x,di=0x%x,twave=0x%x,depth=0x%x&bslash;n&quot;
comma
id|lfo_addr
comma
id|wave_select
comma
id|program-&gt;freq_and_control
comma
id|program-&gt;depth_final
comma
id|program-&gt;depth_inc
comma
id|program-&gt;twave
comma
id|program-&gt;depth
)paren
suffix:semicolon
macro_line|#endif
id|snd_gf1_poke
c_func
(paren
id|gus
comma
id|lfo_addr
op_plus
l_int|0x02
comma
id|program-&gt;depth_final
)paren
suffix:semicolon
id|snd_gf1_poke
c_func
(paren
id|gus
comma
id|lfo_addr
op_plus
l_int|0x03
comma
id|program-&gt;depth_inc
)paren
suffix:semicolon
id|snd_gf1_pokew
c_func
(paren
id|gus
comma
id|lfo_addr
op_plus
l_int|0x08
op_plus
id|wave_select
comma
id|program-&gt;twave
)paren
suffix:semicolon
id|snd_gf1_pokew
c_func
(paren
id|gus
comma
id|lfo_addr
op_plus
l_int|0x0a
op_plus
id|wave_select
comma
id|program-&gt;depth
)paren
suffix:semicolon
id|snd_gf1_pokew
c_func
(paren
id|gus
comma
id|lfo_addr
op_plus
l_int|0x00
comma
id|program-&gt;freq_and_control
)paren
suffix:semicolon
macro_line|#if 0
(brace
r_int
id|i
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|16
suffix:semicolon
id|i
op_increment
)paren
id|printk
c_func
(paren
l_string|&quot;%02x:&quot;
comma
id|snd_gf1_peek
c_func
(paren
id|gus
comma
id|lfo_addr
op_plus
id|i
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
)brace
macro_line|#endif
)brace
r_if
c_cond
(paren
id|gus-&gt;gf1.sw_lfo
)paren
(brace
r_int
r_char
op_star
id|ptr
op_assign
id|gus-&gt;gf1.lfos
op_plus
id|lfo_addr
suffix:semicolon
op_star
(paren
id|ptr
op_plus
l_int|0x02
)paren
op_assign
id|program-&gt;depth_final
suffix:semicolon
op_star
(paren
id|ptr
op_plus
l_int|0x03
)paren
op_assign
id|program-&gt;depth_inc
suffix:semicolon
op_star
(paren
r_int
r_int
op_star
)paren
(paren
id|ptr
op_plus
l_int|0x08
op_plus
id|wave_select
)paren
op_assign
id|program-&gt;twave
suffix:semicolon
op_star
(paren
r_int
r_int
op_star
)paren
(paren
id|ptr
op_plus
l_int|0x0a
op_plus
id|wave_select
)paren
op_assign
id|program-&gt;depth
suffix:semicolon
op_star
(paren
r_int
r_int
op_star
)paren
(paren
id|ptr
op_plus
l_int|0x00
)paren
op_assign
id|program-&gt;freq_and_control
suffix:semicolon
)brace
)brace
DECL|function|snd_gf1_lfo_enable
r_void
id|snd_gf1_lfo_enable
c_func
(paren
id|snd_gus_card_t
op_star
id|gus
comma
r_int
id|voice
comma
r_int
id|lfo_type
)paren
(brace
r_int
r_int
id|lfo_addr
suffix:semicolon
id|lfo_addr
op_assign
(paren
id|voice
op_lshift
l_int|5
)paren
op_or
(paren
id|lfo_type
op_lshift
l_int|4
)paren
suffix:semicolon
r_if
c_cond
(paren
id|gus-&gt;gf1.hw_lfo
)paren
id|snd_gf1_pokew
c_func
(paren
id|gus
comma
id|lfo_addr
op_plus
l_int|0x00
comma
id|snd_gf1_peekw
c_func
(paren
id|gus
comma
id|lfo_addr
op_plus
l_int|0x00
)paren
op_or
l_int|0x8000
)paren
suffix:semicolon
r_if
c_cond
(paren
id|gus-&gt;gf1.sw_lfo
)paren
(brace
r_int
r_char
op_star
id|ptr
op_assign
id|gus-&gt;gf1.lfos
op_plus
id|lfo_addr
suffix:semicolon
op_star
(paren
r_int
r_int
op_star
)paren
(paren
id|ptr
op_plus
l_int|0x00
)paren
op_or_assign
l_int|0x8000
suffix:semicolon
)brace
)brace
DECL|function|snd_gf1_lfo_disable
r_void
id|snd_gf1_lfo_disable
c_func
(paren
id|snd_gus_card_t
op_star
id|gus
comma
r_int
id|voice
comma
r_int
id|lfo_type
)paren
(brace
r_int
r_int
id|lfo_addr
suffix:semicolon
id|lfo_addr
op_assign
(paren
id|voice
op_lshift
l_int|5
)paren
op_or
(paren
id|lfo_type
op_lshift
l_int|4
)paren
suffix:semicolon
r_if
c_cond
(paren
id|gus-&gt;gf1.hw_lfo
)paren
id|snd_gf1_pokew
c_func
(paren
id|gus
comma
id|lfo_addr
op_plus
l_int|0x00
comma
id|snd_gf1_peekw
c_func
(paren
id|gus
comma
id|lfo_addr
op_plus
l_int|0x00
)paren
op_amp
op_complement
l_int|0x8000
)paren
suffix:semicolon
r_if
c_cond
(paren
id|gus-&gt;gf1.sw_lfo
)paren
(brace
r_int
r_char
op_star
id|ptr
op_assign
id|gus-&gt;gf1.lfos
op_plus
id|lfo_addr
suffix:semicolon
op_star
(paren
r_int
r_int
op_star
)paren
(paren
id|ptr
op_plus
l_int|0x00
)paren
op_and_assign
op_complement
l_int|0x8000
suffix:semicolon
)brace
)brace
DECL|function|snd_gf1_lfo_change_freq
r_void
id|snd_gf1_lfo_change_freq
c_func
(paren
id|snd_gus_card_t
op_star
id|gus
comma
r_int
id|voice
comma
r_int
id|lfo_type
comma
r_int
id|freq
)paren
(brace
r_int
r_int
id|lfo_addr
suffix:semicolon
id|lfo_addr
op_assign
(paren
id|voice
op_lshift
l_int|5
)paren
op_or
(paren
id|lfo_type
op_lshift
l_int|4
)paren
suffix:semicolon
r_if
c_cond
(paren
id|gus-&gt;gf1.hw_lfo
)paren
id|snd_gf1_pokew
c_func
(paren
id|gus
comma
id|lfo_addr
op_plus
l_int|0x00
comma
(paren
id|snd_gf1_peekw
c_func
(paren
id|gus
comma
id|lfo_addr
op_plus
l_int|0x00
)paren
op_amp
op_complement
l_int|0x7ff
)paren
op_or
(paren
id|freq
op_amp
l_int|0x7ff
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|gus-&gt;gf1.sw_lfo
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
r_int
r_char
op_star
id|ptr
op_assign
id|gus-&gt;gf1.lfos
op_plus
id|lfo_addr
suffix:semicolon
id|CLI
c_func
(paren
op_amp
id|flags
)paren
suffix:semicolon
op_star
(paren
r_int
r_int
op_star
)paren
(paren
id|ptr
op_plus
l_int|0x00
)paren
op_and_assign
op_complement
l_int|0x7ff
suffix:semicolon
op_star
(paren
r_int
r_int
op_star
)paren
(paren
id|ptr
op_plus
l_int|0x00
)paren
op_or_assign
id|freq
op_amp
l_int|0x7ff
suffix:semicolon
id|STI
c_func
(paren
op_amp
id|flags
)paren
suffix:semicolon
)brace
)brace
DECL|function|snd_gf1_lfo_change_depth
r_void
id|snd_gf1_lfo_change_depth
c_func
(paren
id|snd_gus_card_t
op_star
id|gus
comma
r_int
id|voice
comma
r_int
id|lfo_type
comma
r_int
id|depth
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
r_int
r_int
id|lfo_addr
suffix:semicolon
r_int
r_int
id|control
op_assign
l_int|0
suffix:semicolon
r_int
r_char
op_star
id|ptr
suffix:semicolon
id|lfo_addr
op_assign
(paren
id|voice
op_lshift
l_int|5
)paren
op_or
(paren
id|lfo_type
op_lshift
l_int|4
)paren
suffix:semicolon
id|ptr
op_assign
id|gus-&gt;gf1.lfos
op_plus
id|lfo_addr
suffix:semicolon
r_if
c_cond
(paren
id|gus-&gt;gf1.hw_lfo
)paren
id|control
op_assign
id|snd_gf1_peekw
c_func
(paren
id|gus
comma
id|lfo_addr
op_plus
l_int|0x00
)paren
suffix:semicolon
r_if
c_cond
(paren
id|gus-&gt;gf1.sw_lfo
)paren
id|control
op_assign
op_star
(paren
r_int
r_int
op_star
)paren
(paren
id|ptr
op_plus
l_int|0x00
)paren
suffix:semicolon
r_if
c_cond
(paren
id|depth
OL
l_int|0
)paren
(brace
id|control
op_or_assign
l_int|0x1000
suffix:semicolon
id|depth
op_assign
op_minus
id|depth
suffix:semicolon
)brace
r_else
id|control
op_and_assign
op_complement
l_int|0x1000
suffix:semicolon
r_if
c_cond
(paren
id|gus-&gt;gf1.hw_lfo
)paren
(brace
id|CLI
c_func
(paren
op_amp
id|flags
)paren
suffix:semicolon
id|snd_gf1_poke
c_func
(paren
id|gus
comma
id|lfo_addr
op_plus
l_int|0x02
comma
(paren
r_int
r_char
)paren
id|depth
)paren
suffix:semicolon
id|snd_gf1_pokew
c_func
(paren
id|gus
comma
id|lfo_addr
op_plus
l_int|0x0a
op_plus
(paren
(paren
id|control
op_amp
l_int|0x4000
)paren
op_rshift
l_int|12
)paren
comma
id|depth
op_lshift
l_int|5
)paren
suffix:semicolon
id|snd_gf1_pokew
c_func
(paren
id|gus
comma
id|lfo_addr
op_plus
l_int|0x00
comma
id|control
)paren
suffix:semicolon
id|STI
c_func
(paren
op_amp
id|flags
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|gus-&gt;gf1.sw_lfo
)paren
(brace
r_int
r_char
op_star
id|ptr
op_assign
id|gus-&gt;gf1.lfos
op_plus
id|lfo_addr
suffix:semicolon
id|CLI
c_func
(paren
op_amp
id|flags
)paren
suffix:semicolon
op_star
(paren
id|ptr
op_plus
l_int|0x02
)paren
op_assign
(paren
r_int
r_char
)paren
id|depth
suffix:semicolon
op_star
(paren
r_int
r_int
op_star
)paren
(paren
id|ptr
op_plus
l_int|0x0a
op_plus
(paren
(paren
id|control
op_amp
l_int|0x4000
)paren
op_rshift
l_int|12
)paren
)paren
op_assign
id|depth
op_lshift
l_int|5
suffix:semicolon
op_star
(paren
r_int
r_int
op_star
)paren
(paren
id|ptr
op_plus
l_int|0x00
)paren
op_assign
id|control
suffix:semicolon
id|STI
c_func
(paren
op_amp
id|flags
)paren
suffix:semicolon
)brace
)brace
DECL|function|snd_gf1_lfo_setup
r_void
id|snd_gf1_lfo_setup
c_func
(paren
id|snd_gus_card_t
op_star
id|gus
comma
r_int
id|voice
comma
r_int
id|lfo_type
comma
r_int
id|freq
comma
r_int
id|current_depth
comma
r_int
id|depth
comma
r_int
id|sweep
comma
r_int
id|shape
)paren
(brace
r_struct
id|ULTRA_STRU_IW_LFO_PROGRAM
id|program
suffix:semicolon
id|program.freq_and_control
op_assign
l_int|0x8000
op_or
(paren
id|freq
op_amp
l_int|0x7ff
)paren
suffix:semicolon
r_if
c_cond
(paren
id|shape
op_amp
id|ULTRA_STRU_IW_LFO_SHAPE_POSTRIANGLE
)paren
id|program.freq_and_control
op_or_assign
l_int|0x2000
suffix:semicolon
r_if
c_cond
(paren
id|depth
OL
l_int|0
)paren
(brace
id|program.freq_and_control
op_or_assign
l_int|0x1000
suffix:semicolon
id|depth
op_assign
op_minus
id|depth
suffix:semicolon
)brace
id|program.twave
op_assign
l_int|0
suffix:semicolon
id|program.depth
op_assign
id|current_depth
suffix:semicolon
id|program.depth_final
op_assign
id|depth
suffix:semicolon
r_if
c_cond
(paren
id|sweep
)paren
(brace
id|program.depth_inc
op_assign
(paren
r_int
r_char
)paren
(paren
(paren
(paren
r_int
)paren
(paren
(paren
id|depth
op_lshift
l_int|5
)paren
op_minus
id|current_depth
)paren
op_lshift
l_int|9
)paren
op_div
(paren
id|sweep
op_star
l_int|4410L
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|program.depth_inc
)paren
id|program.depth_inc
op_increment
suffix:semicolon
)brace
r_else
id|program.depth
op_assign
(paren
r_int
r_int
)paren
(paren
id|depth
op_lshift
l_int|5
)paren
suffix:semicolon
id|snd_gf1_lfo_program
c_func
(paren
id|gus
comma
id|voice
comma
id|lfo_type
comma
op_amp
id|program
)paren
suffix:semicolon
)brace
DECL|function|snd_gf1_lfo_shutdown
r_void
id|snd_gf1_lfo_shutdown
c_func
(paren
id|snd_gus_card_t
op_star
id|gus
comma
r_int
id|voice
comma
r_int
id|lfo_type
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
r_int
r_int
id|lfo_addr
suffix:semicolon
id|lfo_addr
op_assign
(paren
id|voice
op_lshift
l_int|5
)paren
op_or
(paren
id|lfo_type
op_lshift
l_int|4
)paren
suffix:semicolon
r_if
c_cond
(paren
id|gus-&gt;gf1.hw_lfo
)paren
(brace
id|snd_gf1_pokew
c_func
(paren
id|gus
comma
id|lfo_addr
op_plus
l_int|0x00
comma
l_int|0x0000
)paren
suffix:semicolon
id|CLI
c_func
(paren
op_amp
id|flags
)paren
suffix:semicolon
id|gf1_select_voice
c_func
(paren
id|gus
comma
id|voice
)paren
suffix:semicolon
id|snd_gf1_write8
c_func
(paren
id|gus
comma
id|lfo_type
op_eq
id|ULTRA_LFO_VIBRATO
ques
c_cond
id|GF1_VB_FREQUENCY_LFO
suffix:colon
id|GF1_VB_VOLUME_LFO
comma
l_int|0
)paren
suffix:semicolon
id|STI
c_func
(paren
op_amp
id|flags
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|gus-&gt;gf1.sw_lfo
)paren
(brace
r_int
r_char
op_star
id|ptr
op_assign
id|gus-&gt;gf1.lfos
op_plus
id|lfo_addr
suffix:semicolon
id|snd_gf1_voice_t
op_star
id|pvoice
suffix:semicolon
op_star
(paren
r_int
r_int
op_star
)paren
(paren
id|ptr
op_plus
l_int|0x00
)paren
op_assign
l_int|0
suffix:semicolon
op_star
(paren
r_int
r_int
op_star
)paren
(paren
id|ptr
op_plus
l_int|0x04
)paren
op_assign
l_int|0
suffix:semicolon
op_star
(paren
r_int
r_int
op_star
)paren
(paren
id|ptr
op_plus
l_int|0x06
)paren
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|gus-&gt;gf1.syn_voices
)paren
(brace
id|pvoice
op_assign
id|gus-&gt;gf1.syn_voices
op_plus
id|voice
suffix:semicolon
r_if
c_cond
(paren
id|lfo_type
op_eq
id|ULTRA_LFO_VIBRATO
)paren
id|pvoice-&gt;lfo_fc
op_assign
l_int|0
suffix:semicolon
r_else
id|pvoice-&gt;lfo_volume
op_assign
l_int|0
suffix:semicolon
id|snd_gf1_lfo_register_setup
c_func
(paren
id|gus
comma
id|pvoice
comma
id|lfo_type
op_eq
id|ULTRA_LFO_VIBRATO
ques
c_cond
l_int|1
suffix:colon
l_int|2
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|gus-&gt;gf1.enh_mode
)paren
(brace
id|CLI
c_func
(paren
op_amp
id|flags
)paren
suffix:semicolon
id|gf1_select_voice
c_func
(paren
id|gus
comma
id|voice
)paren
suffix:semicolon
id|snd_gf1_write8
c_func
(paren
id|gus
comma
id|lfo_type
op_eq
id|ULTRA_LFO_VIBRATO
ques
c_cond
id|GF1_VB_FREQUENCY_LFO
suffix:colon
id|GF1_VB_VOLUME_LFO
comma
l_int|0
)paren
suffix:semicolon
id|STI
c_func
(paren
op_amp
id|flags
)paren
suffix:semicolon
)brace
)brace
)brace
DECL|function|snd_gf1_lfo_command
r_void
id|snd_gf1_lfo_command
c_func
(paren
id|snd_gus_card_t
op_star
id|gus
comma
r_int
id|voice
comma
r_int
r_char
op_star
id|data
)paren
(brace
r_int
id|lfo_type
suffix:semicolon
r_int
id|lfo_command
suffix:semicolon
r_int
id|temp1
comma
id|temp2
suffix:semicolon
id|lfo_type
op_assign
op_star
id|data
op_rshift
l_int|7
suffix:semicolon
id|lfo_command
op_assign
op_star
id|data
op_amp
l_int|0x7f
suffix:semicolon
r_switch
c_cond
(paren
id|lfo_command
)paren
(brace
r_case
id|ULTRA_LFO_SETUP
suffix:colon
multiline_comment|/* setup */
id|temp1
op_assign
id|snd_gf1_get_word
c_func
(paren
id|data
comma
l_int|2
)paren
suffix:semicolon
id|temp2
op_assign
id|snd_gf1_get_word
c_func
(paren
id|data
comma
l_int|4
)paren
suffix:semicolon
id|snd_gf1_lfo_setup
c_func
(paren
id|gus
comma
id|voice
comma
id|lfo_type
comma
id|temp1
op_amp
l_int|0x7ff
comma
l_int|0
comma
id|temp2
OG
l_int|255
ques
c_cond
l_int|255
suffix:colon
id|temp2
comma
id|snd_gf1_get_byte
c_func
(paren
id|data
comma
l_int|1
)paren
comma
(paren
id|temp1
op_amp
l_int|0x2000
)paren
op_rshift
l_int|13
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ULTRA_LFO_FREQ
suffix:colon
multiline_comment|/* freq */
id|snd_gf1_lfo_change_depth
c_func
(paren
id|gus
comma
id|voice
comma
id|lfo_type
comma
id|snd_gf1_get_word
c_func
(paren
id|data
comma
l_int|2
)paren
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ULTRA_LFO_DEPTH
suffix:colon
multiline_comment|/* depth */
id|snd_gf1_lfo_change_freq
c_func
(paren
id|gus
comma
id|voice
comma
id|lfo_type
comma
id|snd_gf1_get_word
c_func
(paren
id|data
comma
l_int|2
)paren
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ULTRA_LFO_ENABLE
suffix:colon
multiline_comment|/* enable */
id|snd_gf1_lfo_enable
c_func
(paren
id|gus
comma
id|voice
comma
id|lfo_type
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ULTRA_LFO_DISABLE
suffix:colon
multiline_comment|/* disable */
id|snd_gf1_lfo_disable
c_func
(paren
id|gus
comma
id|voice
comma
id|lfo_type
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ULTRA_LFO_SHUTDOWN
suffix:colon
multiline_comment|/* shutdown */
id|snd_gf1_lfo_shutdown
c_func
(paren
id|gus
comma
id|voice
comma
id|lfo_type
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
eof
