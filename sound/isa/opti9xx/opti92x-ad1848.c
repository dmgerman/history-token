multiline_comment|/*&n;    card-opti92x-ad1848.c - driver for OPTi 82c92x based soundcards.&n;    Copyright (C) 1998-2000 by Massimo Piccioni &lt;dafastidio@libero.it&gt;&n;&n;    Part of this code was developed at the Italian Ministry of Air Defence,&n;    Sixth Division (oh, che pace ...), Rome.&n;&n;    Thanks to Maria Grazia Pollarini, Salvatore Vassallo.&n;&n;    This program is free software; you can redistribute it and/or modify&n;    it under the terms of the GNU General Public License as published by&n;    the Free Software Foundation; either version 2 of the License, or&n;    (at your option) any later version.&n;&n;    This program is distributed in the hope that it will be useful,&n;    but WITHOUT ANY WARRANTY; without even the implied warranty of&n;    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n;    GNU General Public License for more details.&n;&n;    You should have received a copy of the GNU General Public License&n;    along with this program; if not, write to the Free Software&n;    Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA&n;*/
macro_line|#include &lt;sound/driver.h&gt;
macro_line|#include &lt;asm/io.h&gt;
macro_line|#include &lt;asm/dma.h&gt;
macro_line|#include &lt;linux/delay.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#ifndef LINUX_ISAPNP_H
macro_line|#include &lt;linux/isapnp.h&gt;
DECL|macro|isapnp_card
mdefine_line|#define isapnp_card pci_bus
DECL|macro|isapnp_dev
mdefine_line|#define isapnp_dev pci_dev
macro_line|#endif
macro_line|#include &lt;sound/core.h&gt;
macro_line|#ifdef CS4231
macro_line|#include &lt;sound/cs4231.h&gt;
macro_line|#else
macro_line|#ifndef OPTi93X
macro_line|#include &lt;sound/ad1848.h&gt;
macro_line|#else
macro_line|#include &lt;sound/control.h&gt;
macro_line|#include &lt;sound/pcm.h&gt;
macro_line|#endif&t;/* OPTi93X */
macro_line|#endif&t;/* CS4231 */
macro_line|#include &lt;sound/mpu401.h&gt;
macro_line|#include &lt;sound/opl3.h&gt;
DECL|macro|SNDRV_LEGACY_FIND_FREE_IOPORT
mdefine_line|#define SNDRV_LEGACY_FIND_FREE_IOPORT
DECL|macro|SNDRV_LEGACY_FIND_FREE_IRQ
mdefine_line|#define SNDRV_LEGACY_FIND_FREE_IRQ
DECL|macro|SNDRV_LEGACY_FIND_FREE_DMA
mdefine_line|#define SNDRV_LEGACY_FIND_FREE_DMA
DECL|macro|SNDRV_GET_ID
mdefine_line|#define SNDRV_GET_ID
macro_line|#include &lt;sound/initval.h&gt;
id|EXPORT_NO_SYMBOLS
suffix:semicolon
id|MODULE_AUTHOR
c_func
(paren
l_string|&quot;Massimo Piccioni &lt;dafastidio@libero.it&gt;&quot;
)paren
suffix:semicolon
id|MODULE_CLASSES
c_func
(paren
l_string|&quot;{sound}&quot;
)paren
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
macro_line|#ifdef OPTi93X
id|MODULE_DESCRIPTION
c_func
(paren
l_string|&quot;OPTi93X&quot;
)paren
suffix:semicolon
id|MODULE_DEVICES
c_func
(paren
l_string|&quot;{{OPTi,82C931/3}}&quot;
)paren
suffix:semicolon
macro_line|#else&t;/* OPTi93X */
macro_line|#ifdef CS4231
id|MODULE_DESCRIPTION
c_func
(paren
l_string|&quot;OPTi92X - CS4231&quot;
)paren
suffix:semicolon
id|MODULE_DEVICES
c_func
(paren
l_string|&quot;{{OPTi,82C924 (CS4231)},&quot;
l_string|&quot;{OPTi,82C925 (CS4231)}}&quot;
)paren
suffix:semicolon
macro_line|#else&t;/* CS4231 */
id|MODULE_DESCRIPTION
c_func
(paren
l_string|&quot;OPTi92X - AD1848&quot;
)paren
suffix:semicolon
id|MODULE_DEVICES
c_func
(paren
l_string|&quot;{{OPTi,82C924 (AD1848)},&quot;
l_string|&quot;{OPTi,82C925 (AD1848)},&quot;
l_string|&quot;{OAK,Mozart}}&quot;
)paren
suffix:semicolon
macro_line|#endif&t;/* CS4231 */
macro_line|#endif&t;/* OPTi93X */
DECL|variable|snd_index
r_static
r_int
id|snd_index
op_assign
id|SNDRV_DEFAULT_IDX1
suffix:semicolon
multiline_comment|/* Index 0-MAX */
DECL|variable|snd_id
r_static
r_char
op_star
id|snd_id
op_assign
id|SNDRV_DEFAULT_STR1
suffix:semicolon
multiline_comment|/* ID for this card */
singleline_comment|//static int snd_enable = SNDRV_DEFAULT_ENABLE1;&t;/* Enable this card */
DECL|variable|snd_isapnp
r_static
r_int
id|snd_isapnp
op_assign
l_int|1
suffix:semicolon
multiline_comment|/* Enable ISA PnP detection */
DECL|variable|snd_port
r_static
r_int
id|snd_port
op_assign
id|SNDRV_DEFAULT_PORT1
suffix:semicolon
multiline_comment|/* 0x530,0xe80,0xf40,0x604 */
DECL|variable|snd_mpu_port
r_static
r_int
id|snd_mpu_port
op_assign
id|SNDRV_DEFAULT_PORT1
suffix:semicolon
multiline_comment|/* 0x300,0x310,0x320,0x330 */
DECL|variable|snd_fm_port
r_static
r_int
id|snd_fm_port
op_assign
id|SNDRV_DEFAULT_PORT1
suffix:semicolon
multiline_comment|/* 0x388 */
DECL|variable|snd_irq
r_static
r_int
id|snd_irq
op_assign
id|SNDRV_DEFAULT_IRQ1
suffix:semicolon
multiline_comment|/* 5,7,9,10,11 */
DECL|variable|snd_mpu_irq
r_static
r_int
id|snd_mpu_irq
op_assign
id|SNDRV_DEFAULT_IRQ1
suffix:semicolon
multiline_comment|/* 5,7,9,10 */
DECL|variable|snd_dma1
r_static
r_int
id|snd_dma1
op_assign
id|SNDRV_DEFAULT_DMA1
suffix:semicolon
multiline_comment|/* 0,1,3 */
macro_line|#if defined(CS4231) || defined(OPTi93X)
DECL|variable|snd_dma2
r_static
r_int
id|snd_dma2
op_assign
id|SNDRV_DEFAULT_DMA1
suffix:semicolon
multiline_comment|/* 0,1,3 */
macro_line|#endif&t;/* CS4231 || OPTi93X */
id|MODULE_PARM
c_func
(paren
id|snd_index
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|snd_index
comma
l_string|&quot;Index value for opti9xx based soundcard.&quot;
)paren
suffix:semicolon
id|MODULE_PARM_SYNTAX
c_func
(paren
id|snd_index
comma
id|SNDRV_INDEX_DESC
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|snd_id
comma
l_string|&quot;s&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|snd_id
comma
l_string|&quot;ID string for opti9xx based soundcard.&quot;
)paren
suffix:semicolon
id|MODULE_PARM_SYNTAX
c_func
(paren
id|snd_id
comma
id|SNDRV_ID_DESC
)paren
suffix:semicolon
singleline_comment|//MODULE_PARM(snd_enable, &quot;i&quot;);
singleline_comment|//MODULE_PARM_DESC(snd_enable, &quot;Enable opti9xx soundcard.&quot;);
singleline_comment|//MODULE_PARM_SYNTAX(snd_enable, SNDRV_ENABLE_DESC);
id|MODULE_PARM
c_func
(paren
id|snd_isapnp
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|snd_isapnp
comma
l_string|&quot;Enable ISA PnP detection for specified soundcard.&quot;
)paren
suffix:semicolon
id|MODULE_PARM_SYNTAX
c_func
(paren
id|snd_isapnp
comma
id|SNDRV_ISAPNP_DESC
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|snd_port
comma
l_string|&quot;l&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|snd_port
comma
l_string|&quot;WSS port # for opti9xx driver.&quot;
)paren
suffix:semicolon
id|MODULE_PARM_SYNTAX
c_func
(paren
id|snd_port
comma
id|SNDRV_PORT_DESC
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|snd_mpu_port
comma
l_string|&quot;l&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|snd_mpu_port
comma
l_string|&quot;MPU-401 port # for opti9xx driver.&quot;
)paren
suffix:semicolon
id|MODULE_PARM_SYNTAX
c_func
(paren
id|snd_mpu_port
comma
id|SNDRV_PORT_DESC
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|snd_fm_port
comma
l_string|&quot;l&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|snd_fm_port
comma
l_string|&quot;FM port # for opti9xx driver.&quot;
)paren
suffix:semicolon
id|MODULE_PARM_SYNTAX
c_func
(paren
id|snd_fm_port
comma
id|SNDRV_PORT_DESC
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|snd_irq
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|snd_irq
comma
l_string|&quot;WSS irq # for opti9xx driver.&quot;
)paren
suffix:semicolon
id|MODULE_PARM_SYNTAX
c_func
(paren
id|snd_irq
comma
id|SNDRV_IRQ_DESC
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|snd_mpu_irq
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|snd_mpu_irq
comma
l_string|&quot;MPU-401 irq # for opti9xx driver.&quot;
)paren
suffix:semicolon
id|MODULE_PARM_SYNTAX
c_func
(paren
id|snd_mpu_irq
comma
id|SNDRV_IRQ_DESC
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|snd_dma1
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|snd_dma1
comma
l_string|&quot;1st dma # for opti9xx driver.&quot;
)paren
suffix:semicolon
id|MODULE_PARM_SYNTAX
c_func
(paren
id|snd_dma1
comma
id|SNDRV_DMA_DESC
)paren
suffix:semicolon
macro_line|#if defined(CS4231) || defined(OPTi93X)
id|MODULE_PARM
c_func
(paren
id|snd_dma2
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|snd_dma2
comma
l_string|&quot;2nd dma # for opti9xx driver.&quot;
)paren
suffix:semicolon
id|MODULE_PARM_SYNTAX
c_func
(paren
id|snd_dma2
comma
id|SNDRV_DMA_DESC
)paren
suffix:semicolon
macro_line|#endif&t;/* CS4231 || OPTi93X */
DECL|macro|OPTi9XX_HW_DETECT
mdefine_line|#define OPTi9XX_HW_DETECT&t;0
DECL|macro|OPTi9XX_HW_82C928
mdefine_line|#define OPTi9XX_HW_82C928&t;1
DECL|macro|OPTi9XX_HW_82C929
mdefine_line|#define OPTi9XX_HW_82C929&t;2
DECL|macro|OPTi9XX_HW_82C924
mdefine_line|#define OPTi9XX_HW_82C924&t;3
DECL|macro|OPTi9XX_HW_82C925
mdefine_line|#define OPTi9XX_HW_82C925&t;4
DECL|macro|OPTi9XX_HW_82C930
mdefine_line|#define OPTi9XX_HW_82C930&t;5
DECL|macro|OPTi9XX_HW_82C931
mdefine_line|#define OPTi9XX_HW_82C931&t;6
DECL|macro|OPTi9XX_HW_82C933
mdefine_line|#define OPTi9XX_HW_82C933&t;7
DECL|macro|OPTi9XX_HW_LAST
mdefine_line|#define OPTi9XX_HW_LAST&t;&t;OPTi9XX_HW_82C933
DECL|macro|OPTi9XX_MC_REG
mdefine_line|#define OPTi9XX_MC_REG(n)&t;n
DECL|typedef|opti9xx_t
r_typedef
r_struct
id|_snd_opti9xx
id|opti9xx_t
suffix:semicolon
macro_line|#ifdef OPTi93X
DECL|macro|OPTi93X_INDEX
mdefine_line|#define OPTi93X_INDEX&t;&t;&t;0x00
DECL|macro|OPTi93X_DATA
mdefine_line|#define OPTi93X_DATA&t;&t;&t;0x01
DECL|macro|OPTi93X_STATUS
mdefine_line|#define OPTi93X_STATUS&t;&t;&t;0x02
DECL|macro|OPTi93X_DDATA
mdefine_line|#define OPTi93X_DDATA&t;&t;&t;0x03
DECL|macro|OPTi93X_PORT
mdefine_line|#define OPTi93X_PORT(chip, r)&t;&t;((chip)-&gt;port + OPTi93X_##r)
DECL|macro|OPTi93X_MIXOUT_LEFT
mdefine_line|#define OPTi93X_MIXOUT_LEFT&t;&t;0x00
DECL|macro|OPTi93X_MIXOUT_RIGHT
mdefine_line|#define OPTi93X_MIXOUT_RIGHT&t;&t;0x01
DECL|macro|OPTi93X_CD_LEFT_INPUT
mdefine_line|#define OPTi93X_CD_LEFT_INPUT&t;&t;0x02
DECL|macro|OPTi93X_CD_RIGHT_INPUT
mdefine_line|#define OPTi93X_CD_RIGHT_INPUT&t;&t;0x03
DECL|macro|OPTi930_AUX_LEFT_INPUT
mdefine_line|#define OPTi930_AUX_LEFT_INPUT&t;&t;0x04
DECL|macro|OPTi930_AUX_RIGHT_INPUT
mdefine_line|#define OPTi930_AUX_RIGHT_INPUT&t;&t;0x05
DECL|macro|OPTi931_FM_LEFT_INPUT
mdefine_line|#define OPTi931_FM_LEFT_INPUT&t;&t;0x04
DECL|macro|OPTi931_FM_RIGHT_INPUT
mdefine_line|#define OPTi931_FM_RIGHT_INPUT&t;&t;0x05
DECL|macro|OPTi93X_DAC_LEFT
mdefine_line|#define OPTi93X_DAC_LEFT&t;&t;0x06
DECL|macro|OPTi93X_DAC_RIGHT
mdefine_line|#define OPTi93X_DAC_RIGHT&t;&t;0x07
DECL|macro|OPTi93X_PLAY_FORMAT
mdefine_line|#define OPTi93X_PLAY_FORMAT&t;&t;0x08
DECL|macro|OPTi93X_IFACE_CONF
mdefine_line|#define OPTi93X_IFACE_CONF&t;&t;0x09
DECL|macro|OPTi93X_PIN_CTRL
mdefine_line|#define OPTi93X_PIN_CTRL&t;&t;0x0a
DECL|macro|OPTi93X_ERR_INIT
mdefine_line|#define OPTi93X_ERR_INIT&t;&t;0x0b
DECL|macro|OPTi93X_ID
mdefine_line|#define OPTi93X_ID&t;&t;&t;0x0c
DECL|macro|OPTi93X_PLAY_UPR_CNT
mdefine_line|#define OPTi93X_PLAY_UPR_CNT&t;&t;0x0e
DECL|macro|OPTi93X_PLAY_LWR_CNT
mdefine_line|#define OPTi93X_PLAY_LWR_CNT&t;&t;0x0f
DECL|macro|OPTi931_AUX_LEFT_INPUT
mdefine_line|#define OPTi931_AUX_LEFT_INPUT&t;&t;0x10
DECL|macro|OPTi931_AUX_RIGHT_INPUT
mdefine_line|#define OPTi931_AUX_RIGHT_INPUT&t;&t;0x11
DECL|macro|OPTi93X_LINE_LEFT_INPUT
mdefine_line|#define OPTi93X_LINE_LEFT_INPUT&t;&t;0x12
DECL|macro|OPTi93X_LINE_RIGHT_INPUT
mdefine_line|#define OPTi93X_LINE_RIGHT_INPUT&t;0x13
DECL|macro|OPTi93X_MIC_LEFT_INPUT
mdefine_line|#define OPTi93X_MIC_LEFT_INPUT&t;&t;0x14
DECL|macro|OPTi93X_MIC_RIGHT_INPUT
mdefine_line|#define OPTi93X_MIC_RIGHT_INPUT&t;&t;0x15
DECL|macro|OPTi93X_OUT_LEFT
mdefine_line|#define OPTi93X_OUT_LEFT&t;&t;0x16
DECL|macro|OPTi93X_OUT_RIGHT
mdefine_line|#define OPTi93X_OUT_RIGHT&t;&t;0x17
DECL|macro|OPTi93X_CAPT_FORMAT
mdefine_line|#define OPTi93X_CAPT_FORMAT&t;&t;0x1c
DECL|macro|OPTi93X_CAPT_UPR_CNT
mdefine_line|#define OPTi93X_CAPT_UPR_CNT&t;&t;0x1e
DECL|macro|OPTi93X_CAPT_LWR_CNT
mdefine_line|#define OPTi93X_CAPT_LWR_CNT&t;&t;0x1f
DECL|macro|OPTi93X_TRD
mdefine_line|#define OPTi93X_TRD&t;&t;&t;0x20
DECL|macro|OPTi93X_MCE
mdefine_line|#define OPTi93X_MCE&t;&t;&t;0x40
DECL|macro|OPTi93X_INIT
mdefine_line|#define OPTi93X_INIT&t;&t;&t;0x80
DECL|macro|OPTi93X_MIXOUT_MIC_GAIN
mdefine_line|#define OPTi93X_MIXOUT_MIC_GAIN&t;&t;0x20
DECL|macro|OPTi93X_MIXOUT_LINE
mdefine_line|#define OPTi93X_MIXOUT_LINE&t;&t;0x00
DECL|macro|OPTi93X_MIXOUT_CD
mdefine_line|#define OPTi93X_MIXOUT_CD&t;&t;0x40
DECL|macro|OPTi93X_MIXOUT_MIC
mdefine_line|#define OPTi93X_MIXOUT_MIC&t;&t;0x80
DECL|macro|OPTi93X_MIXOUT_MIXER
mdefine_line|#define OPTi93X_MIXOUT_MIXER&t;&t;0xc0
DECL|macro|OPTi93X_STEREO
mdefine_line|#define OPTi93X_STEREO&t;&t;&t;0x10
DECL|macro|OPTi93X_LINEAR_8
mdefine_line|#define OPTi93X_LINEAR_8&t;&t;0x00
DECL|macro|OPTi93X_ULAW_8
mdefine_line|#define OPTi93X_ULAW_8&t;&t;&t;0x20
DECL|macro|OPTi93X_LINEAR_16_LIT
mdefine_line|#define OPTi93X_LINEAR_16_LIT&t;&t;0x40
DECL|macro|OPTi93X_ALAW_8
mdefine_line|#define OPTi93X_ALAW_8&t;&t;&t;0x60
DECL|macro|OPTi93X_ADPCM_16
mdefine_line|#define OPTi93X_ADPCM_16&t;&t;0xa0
DECL|macro|OPTi93X_LINEAR_16_BIG
mdefine_line|#define OPTi93X_LINEAR_16_BIG&t;&t;0xc0
DECL|macro|OPTi93X_CAPTURE_PIO
mdefine_line|#define OPTi93X_CAPTURE_PIO&t;&t;0x80
DECL|macro|OPTi93X_PLAYBACK_PIO
mdefine_line|#define OPTi93X_PLAYBACK_PIO&t;&t;0x40
DECL|macro|OPTi93X_AUTOCALIB
mdefine_line|#define OPTi93X_AUTOCALIB&t;&t;0x08
DECL|macro|OPTi93X_SINGLE_DMA
mdefine_line|#define OPTi93X_SINGLE_DMA&t;&t;0x04
DECL|macro|OPTi93X_CAPTURE_ENABLE
mdefine_line|#define OPTi93X_CAPTURE_ENABLE&t;&t;0x02
DECL|macro|OPTi93X_PLAYBACK_ENABLE
mdefine_line|#define OPTi93X_PLAYBACK_ENABLE&t;&t;0x01
DECL|macro|OPTi93X_IRQ_ENABLE
mdefine_line|#define OPTi93X_IRQ_ENABLE&t;&t;0x02
DECL|macro|OPTi93X_DMA_REQUEST
mdefine_line|#define OPTi93X_DMA_REQUEST&t;&t;0x10
DECL|macro|OPTi93X_CALIB_IN_PROGRESS
mdefine_line|#define OPTi93X_CALIB_IN_PROGRESS&t;0x20
DECL|macro|OPTi93X_IRQ_PLAYBACK
mdefine_line|#define OPTi93X_IRQ_PLAYBACK&t;&t;0x04
DECL|macro|OPTi93X_IRQ_CAPTURE
mdefine_line|#define OPTi93X_IRQ_CAPTURE&t;&t;0x08
DECL|typedef|opti93x_t
r_typedef
r_struct
id|_snd_opti93x
id|opti93x_t
suffix:semicolon
DECL|struct|_snd_opti93x
r_struct
id|_snd_opti93x
(brace
DECL|member|port
r_int
r_int
id|port
suffix:semicolon
DECL|member|res_port
r_struct
id|resource
op_star
id|res_port
suffix:semicolon
DECL|member|irq
r_int
id|irq
suffix:semicolon
DECL|member|dma1
r_int
id|dma1
suffix:semicolon
DECL|member|dma2
r_int
id|dma2
suffix:semicolon
DECL|member|chip
id|opti9xx_t
op_star
id|chip
suffix:semicolon
DECL|member|hardware
r_int
r_int
id|hardware
suffix:semicolon
DECL|member|image
r_int
r_char
id|image
(braket
l_int|32
)braket
suffix:semicolon
DECL|member|mce_bit
r_int
r_char
id|mce_bit
suffix:semicolon
DECL|member|mode
r_int
r_int
id|mode
suffix:semicolon
DECL|member|mute
r_int
id|mute
suffix:semicolon
DECL|member|lock
id|spinlock_t
id|lock
suffix:semicolon
DECL|member|card
id|snd_card_t
op_star
id|card
suffix:semicolon
DECL|member|pcm
id|snd_pcm_t
op_star
id|pcm
suffix:semicolon
DECL|member|playback_substream
id|snd_pcm_substream_t
op_star
id|playback_substream
suffix:semicolon
DECL|member|capture_substream
id|snd_pcm_substream_t
op_star
id|capture_substream
suffix:semicolon
DECL|member|p_dma_size
r_int
r_int
id|p_dma_size
suffix:semicolon
DECL|member|c_dma_size
r_int
r_int
id|c_dma_size
suffix:semicolon
)brace
suffix:semicolon
DECL|macro|OPTi93X_MODE_NONE
mdefine_line|#define OPTi93X_MODE_NONE&t;0x00
DECL|macro|OPTi93X_MODE_PLAY
mdefine_line|#define OPTi93X_MODE_PLAY&t;0x01
DECL|macro|OPTi93X_MODE_CAPTURE
mdefine_line|#define OPTi93X_MODE_CAPTURE&t;0x02
DECL|macro|OPTi93X_MODE_OPEN
mdefine_line|#define OPTi93X_MODE_OPEN&t;(OPTi93X_MODE_PLAY | OPTi93X_MODE_CAPTURE)
macro_line|#endif /* OPTi93X */
DECL|struct|_snd_opti9xx
r_struct
id|_snd_opti9xx
(brace
DECL|member|hardware
r_int
r_int
id|hardware
suffix:semicolon
DECL|member|password
r_int
r_char
id|password
suffix:semicolon
DECL|member|name
r_char
id|name
(braket
l_int|7
)braket
suffix:semicolon
DECL|member|mc_base
r_int
r_int
id|mc_base
suffix:semicolon
DECL|member|res_mc_base
r_struct
id|resource
op_star
id|res_mc_base
suffix:semicolon
DECL|member|mc_base_size
r_int
r_int
id|mc_base_size
suffix:semicolon
macro_line|#ifdef OPTi93X
DECL|member|mc_indir_index
r_int
r_int
id|mc_indir_index
suffix:semicolon
macro_line|#endif&t;/* OPTi93X */
DECL|member|pwd_reg
r_int
r_int
id|pwd_reg
suffix:semicolon
DECL|member|lock
id|spinlock_t
id|lock
suffix:semicolon
DECL|member|wss_base
r_int
id|wss_base
suffix:semicolon
DECL|member|irq
r_int
id|irq
suffix:semicolon
DECL|member|dma1
r_int
id|dma1
suffix:semicolon
macro_line|#if defined(CS4231) || defined(OPTi93X)
DECL|member|dma2
r_int
id|dma2
suffix:semicolon
macro_line|#endif&t;/* CS4231 || OPTi93X */
DECL|member|fm_port
r_int
id|fm_port
suffix:semicolon
DECL|member|mpu_port
r_int
id|mpu_port
suffix:semicolon
DECL|member|mpu_irq
r_int
id|mpu_irq
suffix:semicolon
macro_line|#if defined(OPTi93X)
DECL|member|opti93x
id|opti93x_t
op_star
id|opti93x
suffix:semicolon
macro_line|#elif defined(CS4231)
DECL|member|cs4231
id|cs4231_t
op_star
id|cs4231
suffix:semicolon
macro_line|#else
DECL|member|ad1848
id|ad1848_t
op_star
id|ad1848
suffix:semicolon
macro_line|#endif&t;/* AD1848 */
DECL|member|rmidi
id|snd_rawmidi_t
op_star
id|rmidi
suffix:semicolon
macro_line|#ifdef __ISAPNP__
DECL|member|dev
r_struct
id|isapnp_dev
op_star
id|dev
suffix:semicolon
DECL|member|devmpu
r_struct
id|isapnp_dev
op_star
id|devmpu
suffix:semicolon
macro_line|#endif&t;/* __ISAPNP__ */
)brace
suffix:semicolon
DECL|variable|snd_opti9xx_card
r_static
id|snd_card_t
op_star
id|snd_opti9xx_card
op_assign
id|SNDRV_DEFAULT_PTR1
suffix:semicolon
macro_line|#ifdef __ISAPNP__
DECL|macro|ISAPNP_OPTI9XX
mdefine_line|#define ISAPNP_OPTI9XX(_va, _vb, _vc, _device, _fa, _fb, _fc, _audio, _mpu401) &bslash;&n;&t;{ &bslash;&n;&t;&t;ISAPNP_CARD_ID(_va, _vb, _vc, _device), &bslash;&n;&t;&t;devs: { ISAPNP_DEVICE_ID(_fa, _fb, _fc, _audio), &bslash;&n;&t;&t;&t;ISAPNP_DEVICE_ID(_fa, _fb, _fc, _mpu401), } &bslash;&n;&t;}
DECL|variable|snd_card_opti9xx_pnpids
r_static
r_struct
id|isapnp_card_id
id|snd_card_opti9xx_pnpids
(braket
)braket
op_assign
(brace
macro_line|#ifndef OPTi93X
multiline_comment|/* OPTi 82C924 */
id|ISAPNP_OPTI9XX
c_func
(paren
l_char|&squot;O&squot;
comma
l_char|&squot;P&squot;
comma
l_char|&squot;T&squot;
comma
l_int|0x0924
comma
l_char|&squot;O&squot;
comma
l_char|&squot;P&squot;
comma
l_char|&squot;T&squot;
comma
l_int|0x0000
comma
l_int|0x0002
)paren
comma
multiline_comment|/* OPTi 82C925 */
id|ISAPNP_OPTI9XX
c_func
(paren
l_char|&squot;O&squot;
comma
l_char|&squot;P&squot;
comma
l_char|&squot;T&squot;
comma
l_int|0x0925
comma
l_char|&squot;O&squot;
comma
l_char|&squot;P&squot;
comma
l_char|&squot;T&squot;
comma
l_int|0x9250
comma
l_int|0x0002
)paren
comma
macro_line|#else
multiline_comment|/* OPTi 82C931/3 */
id|ISAPNP_OPTI9XX
c_func
(paren
l_char|&squot;O&squot;
comma
l_char|&squot;P&squot;
comma
l_char|&squot;T&squot;
comma
l_int|0x0931
comma
l_char|&squot;O&squot;
comma
l_char|&squot;P&squot;
comma
l_char|&squot;T&squot;
comma
l_int|0x9310
comma
l_int|0x0002
)paren
comma
macro_line|#endif&t;/* OPTi93X */
(brace
id|ISAPNP_CARD_END
comma
)brace
)brace
suffix:semicolon
DECL|variable|snd_card_opti9xx_pnpids
id|ISAPNP_CARD_TABLE
c_func
(paren
id|snd_card_opti9xx_pnpids
)paren
suffix:semicolon
macro_line|#endif&t;/* __ISAPNP__ */
macro_line|#ifdef OPTi93X
DECL|macro|DRIVER_NAME
mdefine_line|#define DRIVER_NAME&t;&quot;snd-card-opti93x&quot;
macro_line|#else
DECL|macro|DRIVER_NAME
mdefine_line|#define DRIVER_NAME&t;&quot;snd-card-opti92x&quot;
macro_line|#endif&t;/* OPTi93X */
DECL|variable|snd_opti9xx_names
r_static
r_char
op_star
id|snd_opti9xx_names
(braket
)braket
op_assign
(brace
l_string|&quot;unkown&quot;
comma
l_string|&quot;82C928&quot;
comma
l_string|&quot;82C929&quot;
comma
l_string|&quot;82C924&quot;
comma
l_string|&quot;82C925&quot;
comma
l_string|&quot;82C930&quot;
comma
l_string|&quot;82C931&quot;
comma
l_string|&quot;82C933&quot;
)brace
suffix:semicolon
DECL|function|snd_opti9xx_init
r_static
r_int
id|__init
id|snd_opti9xx_init
c_func
(paren
id|opti9xx_t
op_star
id|chip
comma
r_int
r_int
id|hardware
)paren
(brace
id|chip-&gt;hardware
op_assign
id|hardware
suffix:semicolon
id|strcpy
c_func
(paren
id|chip-&gt;name
comma
id|snd_opti9xx_names
(braket
id|hardware
)braket
)paren
suffix:semicolon
id|spin_lock_init
c_func
(paren
op_amp
id|chip-&gt;lock
)paren
suffix:semicolon
id|chip-&gt;wss_base
op_assign
op_minus
l_int|1
suffix:semicolon
id|chip-&gt;irq
op_assign
op_minus
l_int|1
suffix:semicolon
id|chip-&gt;dma1
op_assign
op_minus
l_int|1
suffix:semicolon
macro_line|#if defined(CS4231) || defined (OPTi93X)
id|chip-&gt;dma2
op_assign
op_minus
l_int|1
suffix:semicolon
macro_line|#endif &t;/* CS4231 || OPTi93X */
id|chip-&gt;fm_port
op_assign
op_minus
l_int|1
suffix:semicolon
id|chip-&gt;mpu_port
op_assign
op_minus
l_int|1
suffix:semicolon
id|chip-&gt;mpu_irq
op_assign
op_minus
l_int|1
suffix:semicolon
r_switch
c_cond
(paren
id|hardware
)paren
(brace
macro_line|#ifndef OPTi93X
r_case
id|OPTi9XX_HW_82C928
suffix:colon
r_case
id|OPTi9XX_HW_82C929
suffix:colon
id|chip-&gt;mc_base
op_assign
l_int|0xf8c
suffix:semicolon
id|chip-&gt;password
op_assign
(paren
id|hardware
op_eq
id|OPTi9XX_HW_82C928
)paren
ques
c_cond
l_int|0xe2
suffix:colon
l_int|0xe3
suffix:semicolon
id|chip-&gt;pwd_reg
op_assign
l_int|3
suffix:semicolon
r_break
suffix:semicolon
r_case
id|OPTi9XX_HW_82C924
suffix:colon
r_case
id|OPTi9XX_HW_82C925
suffix:colon
id|chip-&gt;mc_base
op_assign
l_int|0xf8c
suffix:semicolon
id|chip-&gt;password
op_assign
l_int|0xe5
suffix:semicolon
id|chip-&gt;pwd_reg
op_assign
l_int|3
suffix:semicolon
r_break
suffix:semicolon
macro_line|#else&t;/* OPTi93X */
r_case
id|OPTi9XX_HW_82C930
suffix:colon
r_case
id|OPTi9XX_HW_82C931
suffix:colon
r_case
id|OPTi9XX_HW_82C933
suffix:colon
id|chip-&gt;mc_base
op_assign
(paren
id|hardware
op_eq
id|OPTi9XX_HW_82C930
)paren
ques
c_cond
l_int|0xf8f
suffix:colon
l_int|0xf8d
suffix:semicolon
id|chip-&gt;mc_indir_index
op_assign
l_int|0xe0e
suffix:semicolon
id|chip-&gt;password
op_assign
l_int|0xe4
suffix:semicolon
id|chip-&gt;pwd_reg
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif&t;/* OPTi93X */
r_default
suffix:colon
id|snd_printk
c_func
(paren
l_string|&quot;chip %d not supported&bslash;n&quot;
comma
id|hardware
)paren
suffix:semicolon
r_return
op_minus
id|ENODEV
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_opti9xx_read
r_static
r_int
r_char
id|snd_opti9xx_read
c_func
(paren
id|opti9xx_t
op_star
id|chip
comma
r_int
r_char
id|reg
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
r_int
r_char
id|retval
op_assign
l_int|0xff
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|outb
c_func
(paren
id|chip-&gt;password
comma
id|chip-&gt;mc_base
op_plus
id|chip-&gt;pwd_reg
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|chip-&gt;hardware
)paren
(brace
macro_line|#ifndef OPTi93X
r_case
id|OPTi9XX_HW_82C924
suffix:colon
r_case
id|OPTi9XX_HW_82C925
suffix:colon
r_if
c_cond
(paren
id|reg
OG
l_int|7
)paren
(brace
id|outb
c_func
(paren
id|reg
comma
id|chip-&gt;mc_base
op_plus
l_int|8
)paren
suffix:semicolon
id|outb
c_func
(paren
id|chip-&gt;password
comma
id|chip-&gt;mc_base
op_plus
id|chip-&gt;pwd_reg
)paren
suffix:semicolon
id|retval
op_assign
id|inb
c_func
(paren
id|chip-&gt;mc_base
op_plus
l_int|9
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|OPTi9XX_HW_82C928
suffix:colon
r_case
id|OPTi9XX_HW_82C929
suffix:colon
id|retval
op_assign
id|inb
c_func
(paren
id|chip-&gt;mc_base
op_plus
id|reg
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#else&t;/* OPTi93X */
r_case
id|OPTi9XX_HW_82C930
suffix:colon
r_case
id|OPTi9XX_HW_82C931
suffix:colon
r_case
id|OPTi9XX_HW_82C933
suffix:colon
id|outb
c_func
(paren
id|reg
comma
id|chip-&gt;mc_indir_index
)paren
suffix:semicolon
id|outb
c_func
(paren
id|chip-&gt;password
comma
id|chip-&gt;mc_base
op_plus
id|chip-&gt;pwd_reg
)paren
suffix:semicolon
id|retval
op_assign
id|inb
c_func
(paren
id|chip-&gt;mc_indir_index
op_plus
l_int|1
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif&t;/* OPTi93X */
r_default
suffix:colon
id|snd_printk
c_func
(paren
l_string|&quot;chip %d not supported&bslash;n&quot;
comma
id|chip-&gt;hardware
)paren
suffix:semicolon
)brace
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_return
id|retval
suffix:semicolon
)brace
DECL|function|snd_opti9xx_write
r_static
r_void
id|snd_opti9xx_write
c_func
(paren
id|opti9xx_t
op_star
id|chip
comma
r_int
r_char
id|reg
comma
r_int
r_char
id|value
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|outb
c_func
(paren
id|chip-&gt;password
comma
id|chip-&gt;mc_base
op_plus
id|chip-&gt;pwd_reg
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|chip-&gt;hardware
)paren
(brace
macro_line|#ifndef OPTi93X
r_case
id|OPTi9XX_HW_82C924
suffix:colon
r_case
id|OPTi9XX_HW_82C925
suffix:colon
r_if
c_cond
(paren
id|reg
OG
l_int|7
)paren
(brace
id|outb
c_func
(paren
id|reg
comma
id|chip-&gt;mc_base
op_plus
l_int|8
)paren
suffix:semicolon
id|outb
c_func
(paren
id|chip-&gt;password
comma
id|chip-&gt;mc_base
op_plus
id|chip-&gt;pwd_reg
)paren
suffix:semicolon
id|outb
c_func
(paren
id|value
comma
id|chip-&gt;mc_base
op_plus
l_int|9
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|OPTi9XX_HW_82C928
suffix:colon
r_case
id|OPTi9XX_HW_82C929
suffix:colon
id|outb
c_func
(paren
id|value
comma
id|chip-&gt;mc_base
op_plus
id|reg
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#else&t;/* OPTi93X */
r_case
id|OPTi9XX_HW_82C930
suffix:colon
r_case
id|OPTi9XX_HW_82C931
suffix:colon
r_case
id|OPTi9XX_HW_82C933
suffix:colon
id|outb
c_func
(paren
id|reg
comma
id|chip-&gt;mc_indir_index
)paren
suffix:semicolon
id|outb
c_func
(paren
id|chip-&gt;password
comma
id|chip-&gt;mc_base
op_plus
id|chip-&gt;pwd_reg
)paren
suffix:semicolon
id|outb
c_func
(paren
id|value
comma
id|chip-&gt;mc_indir_index
op_plus
l_int|1
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif&t;/* OPTi93X */
r_default
suffix:colon
id|snd_printk
c_func
(paren
l_string|&quot;chip %d not supported&bslash;n&quot;
comma
id|chip-&gt;hardware
)paren
suffix:semicolon
)brace
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|macro|snd_opti9xx_write_mask
mdefine_line|#define snd_opti9xx_write_mask(chip, reg, value, mask)&t;&bslash;&n;&t;snd_opti9xx_write(chip, reg,&t;&t;&t;&bslash;&n;&t;&t;(snd_opti9xx_read(chip, reg) &amp; ~(mask)) | ((value) &amp; (mask)))
DECL|function|snd_opti9xx_configure
r_static
r_int
id|__init
id|snd_opti9xx_configure
c_func
(paren
id|opti9xx_t
op_star
id|chip
)paren
(brace
r_int
r_char
id|wss_base_bits
suffix:semicolon
r_int
r_char
id|irq_bits
suffix:semicolon
r_int
r_char
id|dma_bits
suffix:semicolon
r_int
r_char
id|mpu_port_bits
op_assign
l_int|0
suffix:semicolon
r_int
r_char
id|mpu_irq_bits
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_switch
c_cond
(paren
id|chip-&gt;hardware
)paren
(brace
macro_line|#ifndef OPTi93X
r_case
id|OPTi9XX_HW_82C924
suffix:colon
id|snd_opti9xx_write_mask
c_func
(paren
id|chip
comma
id|OPTi9XX_MC_REG
c_func
(paren
l_int|4
)paren
comma
l_int|0xf0
comma
l_int|0xfc
)paren
suffix:semicolon
id|snd_opti9xx_write_mask
c_func
(paren
id|chip
comma
id|OPTi9XX_MC_REG
c_func
(paren
l_int|6
)paren
comma
l_int|0x02
comma
l_int|0x02
)paren
suffix:semicolon
r_case
id|OPTi9XX_HW_82C925
suffix:colon
id|snd_opti9xx_write_mask
c_func
(paren
id|chip
comma
id|OPTi9XX_MC_REG
c_func
(paren
l_int|1
)paren
comma
l_int|0x80
comma
l_int|0x80
)paren
suffix:semicolon
id|snd_opti9xx_write_mask
c_func
(paren
id|chip
comma
id|OPTi9XX_MC_REG
c_func
(paren
l_int|2
)paren
comma
l_int|0x00
comma
l_int|0x20
)paren
suffix:semicolon
id|snd_opti9xx_write_mask
c_func
(paren
id|chip
comma
id|OPTi9XX_MC_REG
c_func
(paren
l_int|3
)paren
comma
l_int|0xf0
comma
l_int|0xff
)paren
suffix:semicolon
macro_line|#ifdef CS4231
id|snd_opti9xx_write_mask
c_func
(paren
id|chip
comma
id|OPTi9XX_MC_REG
c_func
(paren
l_int|5
)paren
comma
l_int|0x02
comma
l_int|0x02
)paren
suffix:semicolon
macro_line|#else
id|snd_opti9xx_write_mask
c_func
(paren
id|chip
comma
id|OPTi9XX_MC_REG
c_func
(paren
l_int|5
)paren
comma
l_int|0x00
comma
l_int|0x02
)paren
suffix:semicolon
macro_line|#endif&t;/* CS4231 */
r_break
suffix:semicolon
r_case
id|OPTi9XX_HW_82C928
suffix:colon
r_case
id|OPTi9XX_HW_82C929
suffix:colon
id|snd_opti9xx_write_mask
c_func
(paren
id|chip
comma
id|OPTi9XX_MC_REG
c_func
(paren
l_int|1
)paren
comma
l_int|0x80
comma
l_int|0x80
)paren
suffix:semicolon
id|snd_opti9xx_write_mask
c_func
(paren
id|chip
comma
id|OPTi9XX_MC_REG
c_func
(paren
l_int|2
)paren
comma
l_int|0x00
comma
l_int|0x20
)paren
suffix:semicolon
multiline_comment|/*&n;&t;&t;snd_opti9xx_write_mask(chip, OPTi9XX_MC_REG(3), 0xa2, 0xae);&n;&t;&t;*/
id|snd_opti9xx_write_mask
c_func
(paren
id|chip
comma
id|OPTi9XX_MC_REG
c_func
(paren
l_int|4
)paren
comma
l_int|0x00
comma
l_int|0x0c
)paren
suffix:semicolon
macro_line|#ifdef CS4231
id|snd_opti9xx_write_mask
c_func
(paren
id|chip
comma
id|OPTi9XX_MC_REG
c_func
(paren
l_int|5
)paren
comma
l_int|0x02
comma
l_int|0x02
)paren
suffix:semicolon
macro_line|#else
id|snd_opti9xx_write_mask
c_func
(paren
id|chip
comma
id|OPTi9XX_MC_REG
c_func
(paren
l_int|5
)paren
comma
l_int|0x00
comma
l_int|0x02
)paren
suffix:semicolon
macro_line|#endif&t;/* CS4231 */
r_break
suffix:semicolon
macro_line|#else&t;/* OPTi93X */
r_case
id|OPTi9XX_HW_82C930
suffix:colon
r_case
id|OPTi9XX_HW_82C931
suffix:colon
r_case
id|OPTi9XX_HW_82C933
suffix:colon
id|snd_opti9xx_write_mask
c_func
(paren
id|chip
comma
id|OPTi9XX_MC_REG
c_func
(paren
l_int|6
)paren
comma
l_int|0x02
comma
l_int|0x03
)paren
suffix:semicolon
id|snd_opti9xx_write_mask
c_func
(paren
id|chip
comma
id|OPTi9XX_MC_REG
c_func
(paren
l_int|3
)paren
comma
l_int|0x00
comma
l_int|0xff
)paren
suffix:semicolon
id|snd_opti9xx_write_mask
c_func
(paren
id|chip
comma
id|OPTi9XX_MC_REG
c_func
(paren
l_int|4
)paren
comma
l_int|0x10
op_or
(paren
id|chip-&gt;hardware
op_eq
id|OPTi9XX_HW_82C930
ques
c_cond
l_int|0x00
suffix:colon
l_int|0x04
)paren
comma
l_int|0x34
)paren
suffix:semicolon
id|snd_opti9xx_write_mask
c_func
(paren
id|chip
comma
id|OPTi9XX_MC_REG
c_func
(paren
l_int|5
)paren
comma
l_int|0x20
comma
l_int|0xbf
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif&t;/* OPTi93X */
r_default
suffix:colon
id|snd_printk
c_func
(paren
l_string|&quot;chip %d not supported&bslash;n&quot;
comma
id|chip-&gt;hardware
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|chip-&gt;wss_base
)paren
(brace
r_case
l_int|0x530
suffix:colon
id|wss_base_bits
op_assign
l_int|0x00
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x604
suffix:colon
id|wss_base_bits
op_assign
l_int|0x03
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0xe80
suffix:colon
id|wss_base_bits
op_assign
l_int|0x01
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0xf40
suffix:colon
id|wss_base_bits
op_assign
l_int|0x02
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|snd_printk
c_func
(paren
l_string|&quot;WSS port 0x%lx not valid&bslash;n&quot;
comma
id|chip-&gt;wss_base
)paren
suffix:semicolon
r_goto
id|__skip_base
suffix:semicolon
)brace
id|snd_opti9xx_write_mask
c_func
(paren
id|chip
comma
id|OPTi9XX_MC_REG
c_func
(paren
l_int|1
)paren
comma
id|wss_base_bits
op_lshift
l_int|4
comma
l_int|0x30
)paren
suffix:semicolon
id|__skip_base
suffix:colon
r_switch
c_cond
(paren
id|chip-&gt;irq
)paren
(brace
macro_line|#ifdef OPTi93X
r_case
l_int|5
suffix:colon
id|irq_bits
op_assign
l_int|0x05
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif&t;/* OPTi93X */
r_case
l_int|7
suffix:colon
id|irq_bits
op_assign
l_int|0x01
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|9
suffix:colon
id|irq_bits
op_assign
l_int|0x02
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|10
suffix:colon
id|irq_bits
op_assign
l_int|0x03
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|11
suffix:colon
id|irq_bits
op_assign
l_int|0x04
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|snd_printk
c_func
(paren
l_string|&quot;WSS irq # %d not valid&bslash;n&quot;
comma
id|chip-&gt;irq
)paren
suffix:semicolon
r_goto
id|__skip_resources
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|chip-&gt;dma1
)paren
(brace
r_case
l_int|0
suffix:colon
id|dma_bits
op_assign
l_int|0x01
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|dma_bits
op_assign
l_int|0x02
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
id|dma_bits
op_assign
l_int|0x03
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|snd_printk
c_func
(paren
l_string|&quot;WSS dma1 # %d not valid&bslash;n&quot;
comma
id|chip-&gt;dma1
)paren
suffix:semicolon
r_goto
id|__skip_resources
suffix:semicolon
)brace
macro_line|#if defined(CS4231) || defined(OPTi93X)
r_if
c_cond
(paren
id|chip-&gt;dma1
op_eq
id|chip-&gt;dma2
)paren
(brace
id|snd_printk
c_func
(paren
l_string|&quot;don&squot;t want to share dmas&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|chip-&gt;dma2
)paren
(brace
r_case
l_int|0
suffix:colon
r_case
l_int|1
suffix:colon
r_break
suffix:semicolon
r_default
suffix:colon
id|snd_printk
c_func
(paren
l_string|&quot;WSS dma2 # %d not valid&bslash;n&quot;
comma
id|chip-&gt;dma2
)paren
suffix:semicolon
r_goto
id|__skip_resources
suffix:semicolon
)brace
id|dma_bits
op_or_assign
l_int|0x04
suffix:semicolon
macro_line|#endif&t;/* CS4231 || OPTi93X */
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|outb
c_func
(paren
id|irq_bits
op_lshift
l_int|3
op_or
id|dma_bits
comma
id|chip-&gt;wss_base
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|__skip_resources
suffix:colon
r_if
c_cond
(paren
id|chip-&gt;hardware
OG
id|OPTi9XX_HW_82C928
)paren
(brace
r_switch
c_cond
(paren
id|chip-&gt;mpu_port
)paren
(brace
r_case
op_minus
l_int|1
suffix:colon
r_break
suffix:semicolon
r_case
l_int|0x300
suffix:colon
id|mpu_port_bits
op_assign
l_int|0x03
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x310
suffix:colon
id|mpu_port_bits
op_assign
l_int|0x02
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x320
suffix:colon
id|mpu_port_bits
op_assign
l_int|0x01
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x330
suffix:colon
id|mpu_port_bits
op_assign
l_int|0x00
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|snd_printk
c_func
(paren
l_string|&quot;MPU-401 port 0x%lx not valid&bslash;n&quot;
comma
id|chip-&gt;mpu_port
)paren
suffix:semicolon
r_goto
id|__skip_mpu
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|chip-&gt;mpu_irq
)paren
(brace
r_case
l_int|5
suffix:colon
id|mpu_irq_bits
op_assign
l_int|0x02
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|7
suffix:colon
id|mpu_irq_bits
op_assign
l_int|0x03
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|9
suffix:colon
id|mpu_irq_bits
op_assign
l_int|0x00
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|10
suffix:colon
id|mpu_irq_bits
op_assign
l_int|0x01
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|snd_printk
c_func
(paren
l_string|&quot;MPU-401 irq # %d not valid&bslash;n&quot;
comma
id|chip-&gt;mpu_irq
)paren
suffix:semicolon
r_goto
id|__skip_mpu
suffix:semicolon
)brace
id|snd_opti9xx_write_mask
c_func
(paren
id|chip
comma
id|OPTi9XX_MC_REG
c_func
(paren
l_int|6
)paren
comma
(paren
id|chip-&gt;mpu_port
op_eq
op_minus
l_int|1
)paren
ques
c_cond
l_int|0x00
suffix:colon
l_int|0x80
op_or
id|mpu_port_bits
op_lshift
l_int|5
op_or
id|mpu_irq_bits
op_lshift
l_int|3
comma
l_int|0xf8
)paren
suffix:semicolon
)brace
id|__skip_mpu
suffix:colon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#ifdef OPTi93X
DECL|macro|chip_t
mdefine_line|#define chip_t opti93x_t
DECL|variable|snd_opti93x_default_image
r_static
r_int
r_char
id|snd_opti93x_default_image
(braket
l_int|32
)braket
op_assign
(brace
l_int|0x00
comma
multiline_comment|/* 00/00 - l_mixout_outctrl */
l_int|0x00
comma
multiline_comment|/* 01/01 - r_mixout_outctrl */
l_int|0x88
comma
multiline_comment|/* 02/02 - l_cd_inctrl */
l_int|0x88
comma
multiline_comment|/* 03/03 - r_cd_inctrl */
l_int|0x88
comma
multiline_comment|/* 04/04 - l_a1/fm_inctrl */
l_int|0x88
comma
multiline_comment|/* 05/05 - r_a1/fm_inctrl */
l_int|0x80
comma
multiline_comment|/* 06/06 - l_dac_inctrl */
l_int|0x80
comma
multiline_comment|/* 07/07 - r_dac_inctrl */
l_int|0x00
comma
multiline_comment|/* 08/08 - ply_dataform_reg */
l_int|0x00
comma
multiline_comment|/* 09/09 - if_conf */
l_int|0x00
comma
multiline_comment|/* 0a/10 - pin_ctrl */
l_int|0x00
comma
multiline_comment|/* 0b/11 - err_init_reg */
l_int|0x0a
comma
multiline_comment|/* 0c/12 - id_reg */
l_int|0x00
comma
multiline_comment|/* 0d/13 - reserved */
l_int|0x00
comma
multiline_comment|/* 0e/14 - ply_upcount_reg */
l_int|0x00
comma
multiline_comment|/* 0f/15 - ply_lowcount_reg */
l_int|0x88
comma
multiline_comment|/* 10/16 - reserved/l_a1_inctrl */
l_int|0x88
comma
multiline_comment|/* 11/17 - reserved/r_a1_inctrl */
l_int|0x88
comma
multiline_comment|/* 12/18 - l_line_inctrl */
l_int|0x88
comma
multiline_comment|/* 13/19 - r_line_inctrl */
l_int|0x88
comma
multiline_comment|/* 14/20 - l_mic_inctrl */
l_int|0x88
comma
multiline_comment|/* 15/21 - r_mic_inctrl */
l_int|0x80
comma
multiline_comment|/* 16/22 - l_out_outctrl */
l_int|0x80
comma
multiline_comment|/* 17/23 - r_out_outctrl */
l_int|0x00
comma
multiline_comment|/* 18/24 - reserved */
l_int|0x00
comma
multiline_comment|/* 19/25 - reserved */
l_int|0x00
comma
multiline_comment|/* 1a/26 - reserved */
l_int|0x00
comma
multiline_comment|/* 1b/27 - reserved */
l_int|0x00
comma
multiline_comment|/* 1c/28 - cap_dataform_reg */
l_int|0x00
comma
multiline_comment|/* 1d/29 - reserved */
l_int|0x00
comma
multiline_comment|/* 1e/30 - cap_upcount_reg */
l_int|0x00
multiline_comment|/* 1f/31 - cap_lowcount_reg */
)brace
suffix:semicolon
DECL|function|snd_opti93x_busy_wait
r_static
r_int
id|snd_opti93x_busy_wait
c_func
(paren
id|opti93x_t
op_star
id|chip
)paren
(brace
r_int
id|timeout
suffix:semicolon
r_for
c_loop
(paren
id|timeout
op_assign
l_int|250
suffix:semicolon
id|timeout
op_decrement
OG
l_int|0
suffix:semicolon
id|udelay
c_func
(paren
l_int|10
)paren
)paren
r_if
c_cond
(paren
op_logical_neg
(paren
id|inb
c_func
(paren
id|OPTi93X_PORT
c_func
(paren
id|chip
comma
id|INDEX
)paren
)paren
op_amp
id|OPTi93X_INIT
)paren
)paren
r_return
l_int|0
suffix:semicolon
id|snd_printk
c_func
(paren
l_string|&quot;chip still busy.&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
DECL|function|snd_opti93x_in
r_static
r_int
r_char
id|snd_opti93x_in
c_func
(paren
id|opti93x_t
op_star
id|chip
comma
r_int
r_char
id|reg
)paren
(brace
id|snd_opti93x_busy_wait
c_func
(paren
id|chip
)paren
suffix:semicolon
id|outb
c_func
(paren
id|chip-&gt;mce_bit
op_or
(paren
id|reg
op_amp
l_int|0x1f
)paren
comma
id|OPTi93X_PORT
c_func
(paren
id|chip
comma
id|INDEX
)paren
)paren
suffix:semicolon
r_return
id|inb
c_func
(paren
id|OPTi93X_PORT
c_func
(paren
id|chip
comma
id|DATA
)paren
)paren
suffix:semicolon
)brace
DECL|function|snd_opti93x_out
r_static
r_void
id|snd_opti93x_out
c_func
(paren
id|opti93x_t
op_star
id|chip
comma
r_int
r_char
id|reg
comma
r_int
r_char
id|value
)paren
(brace
id|snd_opti93x_busy_wait
c_func
(paren
id|chip
)paren
suffix:semicolon
id|outb
c_func
(paren
id|chip-&gt;mce_bit
op_or
(paren
id|reg
op_amp
l_int|0x1f
)paren
comma
id|OPTi93X_PORT
c_func
(paren
id|chip
comma
id|INDEX
)paren
)paren
suffix:semicolon
id|outb
c_func
(paren
id|value
comma
id|OPTi93X_PORT
c_func
(paren
id|chip
comma
id|DATA
)paren
)paren
suffix:semicolon
)brace
DECL|function|snd_opti93x_out_image
r_static
r_void
id|snd_opti93x_out_image
c_func
(paren
id|opti93x_t
op_star
id|chip
comma
r_int
r_char
id|reg
comma
r_int
r_char
id|value
)paren
(brace
id|snd_opti93x_out
c_func
(paren
id|chip
comma
id|reg
comma
id|chip-&gt;image
(braket
id|reg
)braket
op_assign
id|value
)paren
suffix:semicolon
)brace
DECL|function|snd_opti93x_out_mask
r_static
r_void
id|snd_opti93x_out_mask
c_func
(paren
id|opti93x_t
op_star
id|chip
comma
r_int
r_char
id|reg
comma
r_int
r_char
id|mask
comma
r_int
r_char
id|value
)paren
(brace
id|snd_opti93x_out_image
c_func
(paren
id|chip
comma
id|reg
comma
(paren
id|chip-&gt;image
(braket
id|reg
)braket
op_amp
op_complement
id|mask
)paren
op_or
(paren
id|value
op_amp
id|mask
)paren
)paren
suffix:semicolon
)brace
DECL|function|snd_opti93x_mce_up
r_static
r_void
id|snd_opti93x_mce_up
c_func
(paren
id|opti93x_t
op_star
id|chip
)paren
(brace
id|snd_opti93x_busy_wait
c_func
(paren
id|chip
)paren
suffix:semicolon
id|chip-&gt;mce_bit
op_assign
id|OPTi93X_MCE
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|inb
c_func
(paren
id|OPTi93X_PORT
c_func
(paren
id|chip
comma
id|INDEX
)paren
)paren
op_amp
id|OPTi93X_MCE
)paren
)paren
id|outb
c_func
(paren
id|chip-&gt;mce_bit
comma
id|OPTi93X_PORT
c_func
(paren
id|chip
comma
id|INDEX
)paren
)paren
suffix:semicolon
)brace
DECL|function|snd_opti93x_mce_down
r_static
r_void
id|snd_opti93x_mce_down
c_func
(paren
id|opti93x_t
op_star
id|chip
)paren
(brace
id|snd_opti93x_busy_wait
c_func
(paren
id|chip
)paren
suffix:semicolon
id|chip-&gt;mce_bit
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|inb
c_func
(paren
id|OPTi93X_PORT
c_func
(paren
id|chip
comma
id|INDEX
)paren
)paren
op_amp
id|OPTi93X_MCE
)paren
id|outb
c_func
(paren
id|chip-&gt;mce_bit
comma
id|OPTi93X_PORT
c_func
(paren
id|chip
comma
id|INDEX
)paren
)paren
suffix:semicolon
)brace
DECL|macro|snd_opti93x_mute_reg
mdefine_line|#define snd_opti93x_mute_reg(chip, reg, mute)&t;&bslash;&n;&t;snd_opti93x_out(chip, reg, mute ? 0x80 : chip-&gt;image[reg]);
DECL|function|snd_opti93x_mute
r_static
r_void
id|snd_opti93x_mute
c_func
(paren
id|opti93x_t
op_star
id|chip
comma
r_int
id|mute
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|mute
op_assign
id|mute
ques
c_cond
l_int|1
suffix:colon
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;mute
op_eq
id|mute
)paren
(brace
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|chip-&gt;mute
op_assign
id|mute
suffix:semicolon
id|snd_opti93x_mute_reg
c_func
(paren
id|chip
comma
id|OPTi93X_CD_LEFT_INPUT
comma
id|mute
)paren
suffix:semicolon
id|snd_opti93x_mute_reg
c_func
(paren
id|chip
comma
id|OPTi93X_CD_RIGHT_INPUT
comma
id|mute
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|chip-&gt;hardware
)paren
(brace
r_case
id|OPTi9XX_HW_82C930
suffix:colon
id|snd_opti93x_mute_reg
c_func
(paren
id|chip
comma
id|OPTi930_AUX_LEFT_INPUT
comma
id|mute
)paren
suffix:semicolon
id|snd_opti93x_mute_reg
c_func
(paren
id|chip
comma
id|OPTi930_AUX_RIGHT_INPUT
comma
id|mute
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|OPTi9XX_HW_82C931
suffix:colon
r_case
id|OPTi9XX_HW_82C933
suffix:colon
id|snd_opti93x_mute_reg
c_func
(paren
id|chip
comma
id|OPTi931_FM_LEFT_INPUT
comma
id|mute
)paren
suffix:semicolon
id|snd_opti93x_mute_reg
c_func
(paren
id|chip
comma
id|OPTi931_FM_RIGHT_INPUT
comma
id|mute
)paren
suffix:semicolon
id|snd_opti93x_mute_reg
c_func
(paren
id|chip
comma
id|OPTi931_AUX_LEFT_INPUT
comma
id|mute
)paren
suffix:semicolon
id|snd_opti93x_mute_reg
c_func
(paren
id|chip
comma
id|OPTi931_AUX_RIGHT_INPUT
comma
id|mute
)paren
suffix:semicolon
)brace
id|snd_opti93x_mute_reg
c_func
(paren
id|chip
comma
id|OPTi93X_DAC_LEFT
comma
id|mute
)paren
suffix:semicolon
id|snd_opti93x_mute_reg
c_func
(paren
id|chip
comma
id|OPTi93X_DAC_RIGHT
comma
id|mute
)paren
suffix:semicolon
id|snd_opti93x_mute_reg
c_func
(paren
id|chip
comma
id|OPTi93X_LINE_LEFT_INPUT
comma
id|mute
)paren
suffix:semicolon
id|snd_opti93x_mute_reg
c_func
(paren
id|chip
comma
id|OPTi93X_LINE_RIGHT_INPUT
comma
id|mute
)paren
suffix:semicolon
id|snd_opti93x_mute_reg
c_func
(paren
id|chip
comma
id|OPTi93X_MIC_LEFT_INPUT
comma
id|mute
)paren
suffix:semicolon
id|snd_opti93x_mute_reg
c_func
(paren
id|chip
comma
id|OPTi93X_MIC_RIGHT_INPUT
comma
id|mute
)paren
suffix:semicolon
id|snd_opti93x_mute_reg
c_func
(paren
id|chip
comma
id|OPTi93X_OUT_LEFT
comma
id|mute
)paren
suffix:semicolon
id|snd_opti93x_mute_reg
c_func
(paren
id|chip
comma
id|OPTi93X_OUT_RIGHT
comma
id|mute
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|snd_opti93x_get_count
r_static
r_int
r_int
id|snd_opti93x_get_count
c_func
(paren
r_int
r_char
id|format
comma
r_int
r_int
id|size
)paren
(brace
r_switch
c_cond
(paren
id|format
op_amp
l_int|0xe0
)paren
(brace
r_case
id|OPTi93X_LINEAR_16_LIT
suffix:colon
r_case
id|OPTi93X_LINEAR_16_BIG
suffix:colon
id|size
op_rshift_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_case
id|OPTi93X_ADPCM_16
suffix:colon
r_return
id|size
op_rshift
l_int|2
suffix:semicolon
)brace
r_return
(paren
id|format
op_amp
id|OPTi93X_STEREO
)paren
ques
c_cond
(paren
id|size
op_rshift
l_int|1
)paren
suffix:colon
id|size
suffix:semicolon
)brace
DECL|variable|rates
r_int
r_int
id|rates
(braket
)braket
op_assign
(brace
l_int|5512
comma
l_int|6615
comma
l_int|8000
comma
l_int|9600
comma
l_int|11025
comma
l_int|16000
comma
l_int|18900
comma
l_int|22050
comma
l_int|27428
comma
l_int|32000
comma
l_int|33075
comma
l_int|37800
comma
l_int|44100
comma
l_int|48000
)brace
suffix:semicolon
DECL|macro|RATES
mdefine_line|#define RATES sizeof(rates) / sizeof(rates[0])
DECL|variable|hw_constraints_rates
r_static
id|snd_pcm_hw_constraint_list_t
id|hw_constraints_rates
op_assign
(brace
id|count
suffix:colon
id|RATES
comma
id|list
suffix:colon
id|rates
comma
id|mask
suffix:colon
l_int|0
comma
)brace
suffix:semicolon
DECL|variable|bits
r_int
r_char
id|bits
(braket
)braket
op_assign
(brace
l_int|0x01
comma
l_int|0x0f
comma
l_int|0x00
comma
l_int|0x0e
comma
l_int|0x03
comma
l_int|0x02
comma
l_int|0x05
comma
l_int|0x07
comma
l_int|0x04
comma
l_int|0x06
comma
l_int|0x0d
comma
l_int|0x09
comma
l_int|0x0b
comma
l_int|0x0c
)brace
suffix:semicolon
DECL|function|snd_opti93x_get_freq
r_static
r_int
r_char
id|snd_opti93x_get_freq
c_func
(paren
r_int
r_int
id|rate
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|RATES
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|rate
op_eq
id|rates
(braket
id|i
)braket
)paren
r_return
id|bits
(braket
id|i
)braket
suffix:semicolon
)brace
id|snd_BUG
c_func
(paren
)paren
suffix:semicolon
r_return
id|bits
(braket
id|RATES
op_minus
l_int|1
)braket
suffix:semicolon
)brace
DECL|function|snd_opti93x_get_format
r_static
r_int
r_char
id|snd_opti93x_get_format
c_func
(paren
id|opti93x_t
op_star
id|chip
comma
r_int
r_int
id|format
comma
r_int
id|channels
)paren
(brace
r_int
r_char
id|retval
op_assign
id|OPTi93X_LINEAR_8
suffix:semicolon
r_switch
c_cond
(paren
id|format
)paren
(brace
r_case
id|SNDRV_PCM_FORMAT_MU_LAW
suffix:colon
id|retval
op_assign
id|OPTi93X_ULAW_8
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_FORMAT_A_LAW
suffix:colon
id|retval
op_assign
id|OPTi93X_ALAW_8
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_FORMAT_S16_LE
suffix:colon
id|retval
op_assign
id|OPTi93X_LINEAR_16_LIT
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_FORMAT_S16_BE
suffix:colon
id|retval
op_assign
id|OPTi93X_LINEAR_16_BIG
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNDRV_PCM_FORMAT_IMA_ADPCM
suffix:colon
id|retval
op_assign
id|OPTi93X_ADPCM_16
suffix:semicolon
)brace
r_return
(paren
id|channels
OG
l_int|1
)paren
ques
c_cond
(paren
id|retval
op_or
id|OPTi93X_STEREO
)paren
suffix:colon
id|retval
suffix:semicolon
)brace
DECL|function|snd_opti93x_playback_format
r_static
r_void
id|snd_opti93x_playback_format
c_func
(paren
id|opti93x_t
op_star
id|chip
comma
r_int
r_char
id|fmt
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
r_int
r_char
id|mask
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|snd_opti93x_mute
c_func
(paren
id|chip
comma
l_int|1
)paren
suffix:semicolon
id|snd_opti93x_mce_up
c_func
(paren
id|chip
)paren
suffix:semicolon
id|mask
op_assign
(paren
id|chip-&gt;mode
op_amp
id|OPTi93X_MODE_CAPTURE
)paren
ques
c_cond
l_int|0xf0
suffix:colon
l_int|0xff
suffix:semicolon
id|snd_opti93x_out_mask
c_func
(paren
id|chip
comma
id|OPTi93X_PLAY_FORMAT
comma
id|mask
comma
id|fmt
)paren
suffix:semicolon
id|snd_opti93x_mce_down
c_func
(paren
id|chip
)paren
suffix:semicolon
id|snd_opti93x_mute
c_func
(paren
id|chip
comma
l_int|0
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|snd_opti93x_capture_format
r_static
r_void
id|snd_opti93x_capture_format
c_func
(paren
id|opti93x_t
op_star
id|chip
comma
r_int
r_char
id|fmt
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|snd_opti93x_mute
c_func
(paren
id|chip
comma
l_int|1
)paren
suffix:semicolon
id|snd_opti93x_mce_up
c_func
(paren
id|chip
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|chip-&gt;mode
op_amp
id|OPTi93X_MODE_PLAY
)paren
)paren
id|snd_opti93x_out_mask
c_func
(paren
id|chip
comma
id|OPTi93X_PLAY_FORMAT
comma
l_int|0x0f
comma
id|fmt
)paren
suffix:semicolon
r_else
id|fmt
op_assign
id|chip-&gt;image
(braket
id|OPTi93X_PLAY_FORMAT
)braket
op_amp
l_int|0xf0
suffix:semicolon
id|snd_opti93x_out_image
c_func
(paren
id|chip
comma
id|OPTi93X_CAPT_FORMAT
comma
id|fmt
)paren
suffix:semicolon
id|snd_opti93x_mce_down
c_func
(paren
id|chip
)paren
suffix:semicolon
id|snd_opti93x_mute
c_func
(paren
id|chip
comma
l_int|0
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|snd_opti93x_open
r_static
r_int
id|snd_opti93x_open
c_func
(paren
id|opti93x_t
op_star
id|chip
comma
r_int
r_int
id|mode
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;mode
op_amp
id|mode
)paren
(brace
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_return
op_minus
id|EAGAIN
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|chip-&gt;mode
op_amp
id|OPTi93X_MODE_OPEN
)paren
)paren
(brace
id|outb
c_func
(paren
l_int|0x00
comma
id|OPTi93X_PORT
c_func
(paren
id|chip
comma
id|STATUS
)paren
)paren
suffix:semicolon
id|snd_opti93x_out_mask
c_func
(paren
id|chip
comma
id|OPTi93X_PIN_CTRL
comma
id|OPTi93X_IRQ_ENABLE
comma
id|OPTi93X_IRQ_ENABLE
)paren
suffix:semicolon
id|chip-&gt;mode
op_assign
id|mode
suffix:semicolon
)brace
r_else
id|chip-&gt;mode
op_or_assign
id|mode
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_opti93x_close
r_static
r_void
id|snd_opti93x_close
c_func
(paren
id|opti93x_t
op_star
id|chip
comma
r_int
r_int
id|mode
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|chip-&gt;mode
op_and_assign
op_complement
id|mode
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;mode
op_amp
id|OPTi93X_MODE_OPEN
)paren
(brace
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|snd_opti93x_mute
c_func
(paren
id|chip
comma
l_int|1
)paren
suffix:semicolon
id|outb
c_func
(paren
l_int|0
comma
id|OPTi93X_PORT
c_func
(paren
id|chip
comma
id|STATUS
)paren
)paren
suffix:semicolon
id|snd_opti93x_out_mask
c_func
(paren
id|chip
comma
id|OPTi93X_PIN_CTRL
comma
id|OPTi93X_IRQ_ENABLE
comma
op_complement
id|OPTi93X_IRQ_ENABLE
)paren
suffix:semicolon
id|snd_opti93x_mce_up
c_func
(paren
id|chip
)paren
suffix:semicolon
id|snd_opti93x_out_image
c_func
(paren
id|chip
comma
id|OPTi93X_IFACE_CONF
comma
l_int|0x00
)paren
suffix:semicolon
id|snd_opti93x_mce_down
c_func
(paren
id|chip
)paren
suffix:semicolon
id|chip-&gt;mode
op_assign
l_int|0
suffix:semicolon
id|snd_opti93x_mute
c_func
(paren
id|chip
comma
l_int|0
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|snd_opti93x_trigger
r_static
r_int
id|snd_opti93x_trigger
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
r_char
id|what
comma
r_int
id|cmd
)paren
(brace
id|opti93x_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|SNDRV_PCM_TRIGGER_START
suffix:colon
r_case
id|SNDRV_PCM_TRIGGER_STOP
suffix:colon
(brace
r_int
r_int
id|what
op_assign
l_int|0
suffix:semicolon
id|snd_pcm_substream_t
op_star
id|s
op_assign
id|substream
suffix:semicolon
r_do
(brace
r_if
c_cond
(paren
id|s
op_eq
id|chip-&gt;playback_substream
)paren
(brace
id|what
op_or_assign
id|OPTi93X_PLAYBACK_ENABLE
suffix:semicolon
id|snd_pcm_trigger_done
c_func
(paren
id|s
comma
id|substream
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|s
op_eq
id|chip-&gt;capture_substream
)paren
(brace
id|what
op_or_assign
id|OPTi93X_CAPTURE_ENABLE
suffix:semicolon
id|snd_pcm_trigger_done
c_func
(paren
id|s
comma
id|substream
)paren
suffix:semicolon
)brace
id|s
op_assign
id|s-&gt;link_next
suffix:semicolon
)brace
r_while
c_loop
(paren
id|s
op_ne
id|substream
)paren
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|chip-&gt;lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|SNDRV_PCM_TRIGGER_START
)paren
id|snd_opti93x_out_mask
c_func
(paren
id|chip
comma
id|OPTi93X_IFACE_CONF
comma
id|what
comma
id|what
)paren
suffix:semicolon
r_else
id|snd_opti93x_out_mask
c_func
(paren
id|chip
comma
id|OPTi93X_IFACE_CONF
comma
id|what
comma
l_int|0x00
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|chip-&gt;lock
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_default
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_opti93x_playback_trigger
r_static
r_int
id|snd_opti93x_playback_trigger
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|cmd
)paren
(brace
r_return
id|snd_opti93x_trigger
c_func
(paren
id|substream
comma
id|OPTi93X_PLAYBACK_ENABLE
comma
id|cmd
)paren
suffix:semicolon
)brace
DECL|function|snd_opti93x_capture_trigger
r_static
r_int
id|snd_opti93x_capture_trigger
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
r_int
id|cmd
)paren
(brace
r_return
id|snd_opti93x_trigger
c_func
(paren
id|substream
comma
id|OPTi93X_CAPTURE_ENABLE
comma
id|cmd
)paren
suffix:semicolon
)brace
DECL|function|snd_opti93x_hw_params
r_static
r_int
id|snd_opti93x_hw_params
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
comma
id|snd_pcm_hw_params_t
op_star
id|hw_params
)paren
(brace
r_return
id|snd_pcm_lib_malloc_pages
c_func
(paren
id|substream
comma
id|params_buffer_bytes
c_func
(paren
id|hw_params
)paren
)paren
suffix:semicolon
)brace
DECL|function|snd_opti93x_hw_free
r_static
r_int
id|snd_opti93x_hw_free
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|snd_pcm_lib_free_pages
c_func
(paren
id|substream
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_opti93x_playback_prepare
r_static
r_int
id|snd_opti93x_playback_prepare
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|opti93x_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
r_char
id|format
suffix:semicolon
r_int
r_int
id|count
op_assign
id|snd_pcm_lib_period_bytes
c_func
(paren
id|substream
)paren
suffix:semicolon
r_int
r_int
id|size
op_assign
id|snd_pcm_lib_buffer_bytes
c_func
(paren
id|substream
)paren
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|chip-&gt;p_dma_size
op_assign
id|size
suffix:semicolon
id|snd_opti93x_out_mask
c_func
(paren
id|chip
comma
id|OPTi93X_IFACE_CONF
comma
id|OPTi93X_PLAYBACK_ENABLE
op_or
id|OPTi93X_PLAYBACK_PIO
comma
op_complement
(paren
id|OPTi93X_PLAYBACK_ENABLE
op_or
id|OPTi93X_PLAYBACK_PIO
)paren
)paren
suffix:semicolon
id|snd_dma_program
c_func
(paren
id|chip-&gt;dma1
comma
id|runtime-&gt;dma_addr
comma
id|size
comma
id|DMA_MODE_WRITE
op_or
id|DMA_AUTOINIT
)paren
suffix:semicolon
id|format
op_assign
id|snd_opti93x_get_freq
c_func
(paren
id|runtime-&gt;rate
)paren
suffix:semicolon
id|format
op_or_assign
id|snd_opti93x_get_format
c_func
(paren
id|chip
comma
id|runtime-&gt;format
comma
id|runtime-&gt;channels
)paren
suffix:semicolon
id|snd_opti93x_playback_format
c_func
(paren
id|chip
comma
id|format
)paren
suffix:semicolon
id|format
op_assign
id|chip-&gt;image
(braket
id|OPTi93X_PLAY_FORMAT
)braket
suffix:semicolon
id|count
op_assign
id|snd_opti93x_get_count
c_func
(paren
id|format
comma
id|count
)paren
op_minus
l_int|1
suffix:semicolon
id|snd_opti93x_out_image
c_func
(paren
id|chip
comma
id|OPTi93X_PLAY_LWR_CNT
comma
id|count
)paren
suffix:semicolon
id|snd_opti93x_out_image
c_func
(paren
id|chip
comma
id|OPTi93X_PLAY_UPR_CNT
comma
id|count
op_rshift
l_int|8
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_opti93x_capture_prepare
r_static
r_int
id|snd_opti93x_capture_prepare
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|opti93x_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
r_char
id|format
suffix:semicolon
r_int
r_int
id|count
op_assign
id|snd_pcm_lib_period_bytes
c_func
(paren
id|substream
)paren
suffix:semicolon
r_int
r_int
id|size
op_assign
id|snd_pcm_lib_buffer_bytes
c_func
(paren
id|substream
)paren
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|chip-&gt;c_dma_size
op_assign
id|size
suffix:semicolon
id|snd_opti93x_out_mask
c_func
(paren
id|chip
comma
id|OPTi93X_IFACE_CONF
comma
id|OPTi93X_CAPTURE_ENABLE
op_or
id|OPTi93X_CAPTURE_PIO
comma
(paren
r_int
r_char
)paren
op_complement
(paren
id|OPTi93X_CAPTURE_ENABLE
op_or
id|OPTi93X_CAPTURE_PIO
)paren
)paren
suffix:semicolon
id|snd_dma_program
c_func
(paren
id|chip-&gt;dma2
comma
id|runtime-&gt;dma_addr
comma
id|size
comma
id|DMA_MODE_READ
op_or
id|DMA_AUTOINIT
)paren
suffix:semicolon
id|format
op_assign
id|snd_opti93x_get_freq
c_func
(paren
id|runtime-&gt;rate
)paren
suffix:semicolon
id|format
op_or_assign
id|snd_opti93x_get_format
c_func
(paren
id|chip
comma
id|runtime-&gt;format
comma
id|runtime-&gt;channels
)paren
suffix:semicolon
id|snd_opti93x_capture_format
c_func
(paren
id|chip
comma
id|format
)paren
suffix:semicolon
id|format
op_assign
id|chip-&gt;image
(braket
id|OPTi93X_CAPT_FORMAT
)braket
suffix:semicolon
id|count
op_assign
id|snd_opti93x_get_count
c_func
(paren
id|format
comma
id|count
)paren
op_minus
l_int|1
suffix:semicolon
id|snd_opti93x_out_image
c_func
(paren
id|chip
comma
id|OPTi93X_CAPT_LWR_CNT
comma
id|count
)paren
suffix:semicolon
id|snd_opti93x_out_image
c_func
(paren
id|chip
comma
id|OPTi93X_CAPT_UPR_CNT
comma
id|count
op_rshift
l_int|8
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_opti93x_playback_pointer
r_static
id|snd_pcm_uframes_t
id|snd_opti93x_playback_pointer
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|opti93x_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
r_int
id|ptr
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|chip-&gt;image
(braket
id|OPTi93X_IFACE_CONF
)braket
op_amp
id|OPTi93X_PLAYBACK_ENABLE
)paren
)paren
r_return
l_int|0
suffix:semicolon
id|ptr
op_assign
id|chip-&gt;p_dma_size
op_minus
id|snd_dma_residue
c_func
(paren
id|chip-&gt;dma1
)paren
suffix:semicolon
r_return
id|bytes_to_frames
c_func
(paren
id|substream-&gt;runtime
comma
id|ptr
)paren
suffix:semicolon
)brace
DECL|function|snd_opti93x_capture_pointer
r_static
id|snd_pcm_uframes_t
id|snd_opti93x_capture_pointer
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|opti93x_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
r_int
id|ptr
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|chip-&gt;image
(braket
id|OPTi93X_IFACE_CONF
)braket
op_amp
id|OPTi93X_CAPTURE_ENABLE
)paren
)paren
r_return
l_int|0
suffix:semicolon
id|ptr
op_assign
id|chip-&gt;c_dma_size
op_minus
id|snd_dma_residue
c_func
(paren
id|chip-&gt;dma2
)paren
suffix:semicolon
r_return
id|bytes_to_frames
c_func
(paren
id|substream-&gt;runtime
comma
id|ptr
)paren
suffix:semicolon
)brace
DECL|function|snd_opti93x_overrange
r_static
r_void
id|snd_opti93x_overrange
c_func
(paren
id|opti93x_t
op_star
id|chip
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|snd_opti93x_in
c_func
(paren
id|chip
comma
id|OPTi93X_ERR_INIT
)paren
op_amp
(paren
l_int|0x08
op_or
l_int|0x02
)paren
)paren
id|chip-&gt;capture_substream-&gt;runtime-&gt;overrange
op_increment
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|snd_opti93x_interrupt
r_void
id|snd_opti93x_interrupt
c_func
(paren
r_int
id|irq
comma
r_void
op_star
id|dev_id
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|opti93x_t
op_star
id|codec
op_assign
id|snd_magic_cast
c_func
(paren
id|opti93x_t
comma
id|dev_id
comma
r_return
)paren
suffix:semicolon
r_int
r_char
id|status
suffix:semicolon
id|status
op_assign
id|snd_opti9xx_read
c_func
(paren
id|codec-&gt;chip
comma
id|OPTi9XX_MC_REG
c_func
(paren
l_int|11
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|status
op_amp
id|OPTi93X_IRQ_PLAYBACK
)paren
op_logical_and
id|codec-&gt;playback_substream
)paren
id|snd_pcm_period_elapsed
c_func
(paren
id|codec-&gt;playback_substream
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|status
op_amp
id|OPTi93X_IRQ_CAPTURE
)paren
op_logical_and
id|codec-&gt;capture_substream
)paren
(brace
id|snd_opti93x_overrange
c_func
(paren
id|codec
)paren
suffix:semicolon
id|snd_pcm_period_elapsed
c_func
(paren
id|codec-&gt;capture_substream
)paren
suffix:semicolon
)brace
id|outb
c_func
(paren
l_int|0x00
comma
id|OPTi93X_PORT
c_func
(paren
id|codec
comma
id|STATUS
)paren
)paren
suffix:semicolon
)brace
DECL|variable|snd_opti93x_playback
r_static
id|snd_pcm_hardware_t
id|snd_opti93x_playback
op_assign
(brace
id|info
suffix:colon
(paren
id|SNDRV_PCM_INFO_MMAP
op_or
id|SNDRV_PCM_INFO_INTERLEAVED
op_or
id|SNDRV_PCM_INFO_MMAP_VALID
op_or
id|SNDRV_PCM_INFO_SYNC_START
)paren
comma
id|formats
suffix:colon
(paren
id|SNDRV_PCM_FMTBIT_MU_LAW
op_or
id|SNDRV_PCM_FMTBIT_A_LAW
op_or
id|SNDRV_PCM_FMTBIT_IMA_ADPCM
op_or
id|SNDRV_PCM_FMTBIT_U8
op_or
id|SNDRV_PCM_FMTBIT_S16_LE
op_or
id|SNDRV_PCM_FMTBIT_S16_BE
)paren
comma
id|rates
suffix:colon
id|SNDRV_PCM_RATE_KNOT
op_or
id|SNDRV_PCM_RATE_8000_48000
comma
id|rate_min
suffix:colon
l_int|5512
comma
id|rate_max
suffix:colon
l_int|48000
comma
id|channels_min
suffix:colon
l_int|1
comma
id|channels_max
suffix:colon
l_int|2
comma
id|buffer_bytes_max
suffix:colon
(paren
l_int|128
op_star
l_int|1024
)paren
comma
id|period_bytes_min
suffix:colon
l_int|64
comma
id|period_bytes_max
suffix:colon
(paren
l_int|128
op_star
l_int|1024
)paren
comma
id|periods_min
suffix:colon
l_int|1
comma
id|periods_max
suffix:colon
l_int|1024
comma
id|fifo_size
suffix:colon
l_int|0
comma
)brace
suffix:semicolon
DECL|variable|snd_opti93x_capture
r_static
id|snd_pcm_hardware_t
id|snd_opti93x_capture
op_assign
(brace
id|info
suffix:colon
(paren
id|SNDRV_PCM_INFO_MMAP
op_or
id|SNDRV_PCM_INFO_INTERLEAVED
op_or
id|SNDRV_PCM_INFO_MMAP_VALID
op_or
id|SNDRV_PCM_INFO_SYNC_START
)paren
comma
id|formats
suffix:colon
(paren
id|SNDRV_PCM_FMTBIT_MU_LAW
op_or
id|SNDRV_PCM_FMTBIT_A_LAW
op_or
id|SNDRV_PCM_FMTBIT_IMA_ADPCM
op_or
id|SNDRV_PCM_FMTBIT_U8
op_or
id|SNDRV_PCM_FMTBIT_S16_LE
op_or
id|SNDRV_PCM_FMTBIT_S16_BE
)paren
comma
id|rates
suffix:colon
id|SNDRV_PCM_RATE_8000_48000
comma
id|rate_min
suffix:colon
l_int|5512
comma
id|rate_max
suffix:colon
l_int|48000
comma
id|channels_min
suffix:colon
l_int|1
comma
id|channels_max
suffix:colon
l_int|2
comma
id|buffer_bytes_max
suffix:colon
(paren
l_int|128
op_star
l_int|1024
)paren
comma
id|period_bytes_min
suffix:colon
l_int|64
comma
id|period_bytes_max
suffix:colon
(paren
l_int|128
op_star
l_int|1024
)paren
comma
id|periods_min
suffix:colon
l_int|1
comma
id|periods_max
suffix:colon
l_int|1024
comma
id|fifo_size
suffix:colon
l_int|0
comma
)brace
suffix:semicolon
DECL|function|snd_opti93x_playback_open
r_static
r_int
id|snd_opti93x_playback_open
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
r_int
id|error
suffix:semicolon
id|opti93x_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
(paren
id|error
op_assign
id|snd_opti93x_open
c_func
(paren
id|chip
comma
id|OPTi93X_MODE_PLAY
)paren
)paren
OL
l_int|0
)paren
r_return
id|error
suffix:semicolon
id|snd_pcm_set_sync
c_func
(paren
id|substream
)paren
suffix:semicolon
id|chip-&gt;playback_substream
op_assign
id|substream
suffix:semicolon
id|runtime-&gt;hw
op_assign
id|snd_opti93x_playback
suffix:semicolon
id|snd_pcm_limit_isa_dma_size
c_func
(paren
id|chip-&gt;dma1
comma
op_amp
id|runtime-&gt;hw.buffer_bytes_max
)paren
suffix:semicolon
id|snd_pcm_limit_isa_dma_size
c_func
(paren
id|chip-&gt;dma1
comma
op_amp
id|runtime-&gt;hw.period_bytes_max
)paren
suffix:semicolon
id|snd_pcm_hw_constraint_list
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_RATE
comma
op_amp
id|hw_constraints_rates
)paren
suffix:semicolon
r_return
id|error
suffix:semicolon
)brace
DECL|function|snd_opti93x_capture_open
r_static
r_int
id|snd_opti93x_capture_open
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
r_int
id|error
suffix:semicolon
id|opti93x_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|snd_pcm_runtime_t
op_star
id|runtime
op_assign
id|substream-&gt;runtime
suffix:semicolon
r_if
c_cond
(paren
(paren
id|error
op_assign
id|snd_opti93x_open
c_func
(paren
id|chip
comma
id|OPTi93X_MODE_CAPTURE
)paren
)paren
OL
l_int|0
)paren
r_return
id|error
suffix:semicolon
id|runtime-&gt;hw
op_assign
id|snd_opti93x_capture
suffix:semicolon
id|snd_pcm_set_sync
c_func
(paren
id|substream
)paren
suffix:semicolon
id|snd_pcm_limit_isa_dma_size
c_func
(paren
id|chip-&gt;dma2
comma
op_amp
id|runtime-&gt;hw.buffer_bytes_max
)paren
suffix:semicolon
id|snd_pcm_limit_isa_dma_size
c_func
(paren
id|chip-&gt;dma2
comma
op_amp
id|runtime-&gt;hw.period_bytes_max
)paren
suffix:semicolon
id|snd_pcm_hw_constraint_list
c_func
(paren
id|runtime
comma
l_int|0
comma
id|SNDRV_PCM_HW_PARAM_RATE
comma
op_amp
id|hw_constraints_rates
)paren
suffix:semicolon
r_return
id|error
suffix:semicolon
)brace
DECL|function|snd_opti93x_playback_close
r_static
r_int
id|snd_opti93x_playback_close
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|opti93x_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|chip-&gt;playback_substream
op_assign
l_int|NULL
suffix:semicolon
id|snd_opti93x_close
c_func
(paren
id|chip
comma
id|OPTi93X_MODE_PLAY
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_opti93x_capture_close
r_static
r_int
id|snd_opti93x_capture_close
c_func
(paren
id|snd_pcm_substream_t
op_star
id|substream
)paren
(brace
id|opti93x_t
op_star
id|chip
op_assign
id|snd_pcm_substream_chip
c_func
(paren
id|substream
)paren
suffix:semicolon
id|chip-&gt;capture_substream
op_assign
l_int|NULL
suffix:semicolon
id|snd_opti93x_close
c_func
(paren
id|chip
comma
id|OPTi93X_MODE_CAPTURE
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_opti93x_init
r_static
r_void
id|snd_opti93x_init
c_func
(paren
id|opti93x_t
op_star
id|chip
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
r_int
id|i
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|snd_opti93x_mce_up
c_func
(paren
id|chip
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|32
suffix:semicolon
id|i
op_increment
)paren
id|snd_opti93x_out_image
c_func
(paren
id|chip
comma
id|i
comma
id|snd_opti93x_default_image
(braket
id|i
)braket
)paren
suffix:semicolon
id|snd_opti93x_mce_down
c_func
(paren
id|chip
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|snd_opti93x_probe
r_static
r_int
id|snd_opti93x_probe
c_func
(paren
id|opti93x_t
op_star
id|chip
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
r_int
r_char
id|val
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|val
op_assign
id|snd_opti93x_in
c_func
(paren
id|chip
comma
id|OPTi93X_ID
)paren
op_amp
l_int|0x0f
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_return
(paren
id|val
op_eq
l_int|0x0a
)paren
ques
c_cond
l_int|0
suffix:colon
op_minus
id|ENODEV
suffix:semicolon
)brace
DECL|function|snd_opti93x_free
r_static
r_int
id|snd_opti93x_free
c_func
(paren
id|opti93x_t
op_star
id|chip
)paren
(brace
r_if
c_cond
(paren
id|chip-&gt;res_port
)paren
(brace
id|release_resource
c_func
(paren
id|chip-&gt;res_port
)paren
suffix:semicolon
id|kfree_nocheck
c_func
(paren
id|chip-&gt;res_port
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|chip-&gt;dma1
op_ge
l_int|0
)paren
(brace
id|disable_dma
c_func
(paren
id|chip-&gt;dma1
)paren
suffix:semicolon
id|free_dma
c_func
(paren
id|chip-&gt;dma1
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|chip-&gt;dma2
op_ge
l_int|0
)paren
(brace
id|disable_dma
c_func
(paren
id|chip-&gt;dma2
)paren
suffix:semicolon
id|free_dma
c_func
(paren
id|chip-&gt;dma2
)paren
suffix:semicolon
)brace
id|snd_magic_kfree
c_func
(paren
id|chip
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_opti93x_dev_free
r_static
r_int
id|snd_opti93x_dev_free
c_func
(paren
id|snd_device_t
op_star
id|device
)paren
(brace
id|opti93x_t
op_star
id|chip
op_assign
id|snd_magic_cast
c_func
(paren
id|opti93x_t
comma
id|device-&gt;device_data
comma
r_return
op_minus
id|ENXIO
)paren
suffix:semicolon
r_return
id|snd_opti93x_free
c_func
(paren
id|chip
)paren
suffix:semicolon
)brace
DECL|function|snd_opti93x_chip_id
r_static
r_const
r_char
op_star
id|snd_opti93x_chip_id
c_func
(paren
id|opti93x_t
op_star
id|codec
)paren
(brace
r_switch
c_cond
(paren
id|codec-&gt;hardware
)paren
(brace
r_case
id|OPTi9XX_HW_82C930
suffix:colon
r_return
l_string|&quot;82C930&quot;
suffix:semicolon
r_case
id|OPTi9XX_HW_82C931
suffix:colon
r_return
l_string|&quot;82C931&quot;
suffix:semicolon
r_case
id|OPTi9XX_HW_82C933
suffix:colon
r_return
l_string|&quot;82C933&quot;
suffix:semicolon
r_default
suffix:colon
r_return
l_string|&quot;???&quot;
suffix:semicolon
)brace
)brace
DECL|function|snd_opti93x_create
r_int
id|snd_opti93x_create
c_func
(paren
id|snd_card_t
op_star
id|card
comma
id|opti9xx_t
op_star
id|chip
comma
r_int
id|dma1
comma
r_int
id|dma2
comma
id|opti93x_t
op_star
op_star
id|rcodec
)paren
(brace
r_static
id|snd_device_ops_t
id|ops
op_assign
(brace
id|dev_free
suffix:colon
id|snd_opti93x_dev_free
comma
)brace
suffix:semicolon
r_int
id|error
suffix:semicolon
id|opti93x_t
op_star
id|codec
suffix:semicolon
op_star
id|rcodec
op_assign
l_int|NULL
suffix:semicolon
id|codec
op_assign
id|snd_magic_kcalloc
c_func
(paren
id|opti93x_t
comma
l_int|0
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|codec
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|codec-&gt;irq
op_assign
op_minus
l_int|1
suffix:semicolon
id|codec-&gt;dma1
op_assign
op_minus
l_int|1
suffix:semicolon
id|codec-&gt;dma2
op_assign
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
(paren
id|codec-&gt;res_port
op_assign
id|request_region
c_func
(paren
id|chip-&gt;wss_base
op_plus
l_int|4
comma
l_int|4
comma
l_string|&quot;OPTI93x CODEC&quot;
)paren
)paren
op_eq
l_int|NULL
)paren
(brace
id|snd_opti93x_free
c_func
(paren
id|codec
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
r_if
c_cond
(paren
id|request_dma
c_func
(paren
id|dma1
comma
l_string|&quot;OPTI93x - 1&quot;
)paren
)paren
(brace
id|snd_opti93x_free
c_func
(paren
id|codec
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
id|codec-&gt;dma1
op_assign
id|chip-&gt;dma1
suffix:semicolon
r_if
c_cond
(paren
id|request_dma
c_func
(paren
id|dma2
comma
l_string|&quot;OPTI93x - 2&quot;
)paren
)paren
(brace
id|snd_opti93x_free
c_func
(paren
id|codec
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
id|codec-&gt;dma2
op_assign
id|chip-&gt;dma2
suffix:semicolon
id|codec-&gt;card
op_assign
id|card
suffix:semicolon
id|codec-&gt;port
op_assign
id|chip-&gt;wss_base
op_plus
l_int|4
suffix:semicolon
id|codec-&gt;irq
op_assign
id|chip-&gt;irq
suffix:semicolon
id|spin_lock_init
c_func
(paren
op_amp
id|codec-&gt;lock
)paren
suffix:semicolon
id|codec-&gt;hardware
op_assign
id|chip-&gt;hardware
suffix:semicolon
id|codec-&gt;chip
op_assign
id|chip
suffix:semicolon
r_if
c_cond
(paren
(paren
id|error
op_assign
id|snd_opti93x_probe
c_func
(paren
id|codec
)paren
)paren
)paren
(brace
id|snd_opti93x_free
c_func
(paren
id|codec
)paren
suffix:semicolon
r_return
id|error
suffix:semicolon
)brace
id|snd_opti93x_init
c_func
(paren
id|codec
)paren
suffix:semicolon
multiline_comment|/* Register device */
r_if
c_cond
(paren
(paren
id|error
op_assign
id|snd_device_new
c_func
(paren
id|card
comma
id|SNDRV_DEV_LOWLEVEL
comma
id|chip
comma
op_amp
id|ops
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_opti93x_free
c_func
(paren
id|codec
)paren
suffix:semicolon
r_return
id|error
suffix:semicolon
)brace
op_star
id|rcodec
op_assign
id|codec
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|snd_opti93x_playback_ops
r_static
id|snd_pcm_ops_t
id|snd_opti93x_playback_ops
op_assign
(brace
id|open
suffix:colon
id|snd_opti93x_playback_open
comma
id|close
suffix:colon
id|snd_opti93x_playback_close
comma
id|ioctl
suffix:colon
id|snd_pcm_lib_ioctl
comma
id|hw_params
suffix:colon
id|snd_opti93x_hw_params
comma
id|hw_free
suffix:colon
id|snd_opti93x_hw_free
comma
id|prepare
suffix:colon
id|snd_opti93x_playback_prepare
comma
id|trigger
suffix:colon
id|snd_opti93x_playback_trigger
comma
id|pointer
suffix:colon
id|snd_opti93x_playback_pointer
comma
)brace
suffix:semicolon
DECL|variable|snd_opti93x_capture_ops
r_static
id|snd_pcm_ops_t
id|snd_opti93x_capture_ops
op_assign
(brace
id|open
suffix:colon
id|snd_opti93x_capture_open
comma
id|close
suffix:colon
id|snd_opti93x_capture_close
comma
id|ioctl
suffix:colon
id|snd_pcm_lib_ioctl
comma
id|hw_params
suffix:colon
id|snd_opti93x_hw_params
comma
id|hw_free
suffix:colon
id|snd_opti93x_hw_free
comma
id|prepare
suffix:colon
id|snd_opti93x_capture_prepare
comma
id|trigger
suffix:colon
id|snd_opti93x_capture_trigger
comma
id|pointer
suffix:colon
id|snd_opti93x_capture_pointer
comma
)brace
suffix:semicolon
DECL|function|snd_opti93x_pcm_free
r_static
r_void
id|snd_opti93x_pcm_free
c_func
(paren
id|snd_pcm_t
op_star
id|pcm
)paren
(brace
id|opti93x_t
op_star
id|codec
op_assign
id|snd_magic_cast
c_func
(paren
id|opti93x_t
comma
id|pcm-&gt;private_data
comma
r_return
)paren
suffix:semicolon
id|codec-&gt;pcm
op_assign
l_int|NULL
suffix:semicolon
id|snd_pcm_lib_preallocate_free_for_all
c_func
(paren
id|pcm
)paren
suffix:semicolon
)brace
DECL|function|snd_opti93x_pcm
r_int
id|snd_opti93x_pcm
c_func
(paren
id|opti93x_t
op_star
id|codec
comma
r_int
id|device
comma
id|snd_pcm_t
op_star
op_star
id|rpcm
)paren
(brace
r_int
id|error
suffix:semicolon
id|snd_pcm_t
op_star
id|pcm
suffix:semicolon
r_if
c_cond
(paren
(paren
id|error
op_assign
id|snd_pcm_new
c_func
(paren
id|codec-&gt;card
comma
l_string|&quot;OPTi 82C93X&quot;
comma
id|device
comma
l_int|1
comma
l_int|1
comma
op_amp
id|pcm
)paren
)paren
)paren
r_return
id|error
suffix:semicolon
id|snd_pcm_set_ops
c_func
(paren
id|pcm
comma
id|SNDRV_PCM_STREAM_PLAYBACK
comma
op_amp
id|snd_opti93x_playback_ops
)paren
suffix:semicolon
id|snd_pcm_set_ops
c_func
(paren
id|pcm
comma
id|SNDRV_PCM_STREAM_CAPTURE
comma
op_amp
id|snd_opti93x_capture_ops
)paren
suffix:semicolon
id|pcm-&gt;private_data
op_assign
id|codec
suffix:semicolon
id|pcm-&gt;private_free
op_assign
id|snd_opti93x_pcm_free
suffix:semicolon
id|pcm-&gt;info_flags
op_assign
id|SNDRV_PCM_INFO_JOINT_DUPLEX
suffix:semicolon
id|strcpy
c_func
(paren
id|pcm-&gt;name
comma
id|snd_opti93x_chip_id
c_func
(paren
id|codec
)paren
)paren
suffix:semicolon
id|snd_pcm_lib_preallocate_isa_pages_for_all
c_func
(paren
id|pcm
comma
l_int|64
op_star
l_int|1024
comma
id|codec-&gt;dma1
OG
l_int|3
op_logical_or
id|codec-&gt;dma2
OG
l_int|3
ques
c_cond
l_int|128
op_star
l_int|1024
suffix:colon
l_int|64
op_star
l_int|1024
)paren
suffix:semicolon
id|codec-&gt;pcm
op_assign
id|pcm
suffix:semicolon
r_if
c_cond
(paren
id|rpcm
)paren
op_star
id|rpcm
op_assign
id|pcm
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; *  MIXER part&n; */
DECL|function|snd_opti93x_info_mux
r_static
r_int
id|snd_opti93x_info_mux
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
r_static
r_char
op_star
id|texts
(braket
l_int|4
)braket
op_assign
(brace
l_string|&quot;Line1&quot;
comma
l_string|&quot;Aux&quot;
comma
l_string|&quot;Mic&quot;
comma
l_string|&quot;Mix&quot;
)brace
suffix:semicolon
id|uinfo-&gt;type
op_assign
id|SNDRV_CTL_ELEM_TYPE_ENUMERATED
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|2
suffix:semicolon
id|uinfo-&gt;value.enumerated.items
op_assign
l_int|4
suffix:semicolon
r_if
c_cond
(paren
id|uinfo-&gt;value.enumerated.item
OG
l_int|3
)paren
id|uinfo-&gt;value.enumerated.item
op_assign
l_int|3
suffix:semicolon
id|strcpy
c_func
(paren
id|uinfo-&gt;value.enumerated.name
comma
id|texts
(braket
id|uinfo-&gt;value.enumerated.item
)braket
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_opti93x_get_mux
r_static
r_int
id|snd_opti93x_get_mux
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|opti93x_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_assign
(paren
id|chip-&gt;image
(braket
id|OPTi93X_MIXOUT_LEFT
)braket
op_amp
id|OPTi93X_MIXOUT_MIXER
)paren
op_rshift
l_int|6
suffix:semicolon
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|1
)braket
op_assign
(paren
id|chip-&gt;image
(braket
id|OPTi93X_MIXOUT_RIGHT
)braket
op_amp
id|OPTi93X_MIXOUT_MIXER
)paren
op_rshift
l_int|6
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_opti93x_put_mux
r_static
r_int
id|snd_opti93x_put_mux
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|opti93x_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
r_int
id|left
comma
id|right
suffix:semicolon
r_int
id|change
suffix:semicolon
r_if
c_cond
(paren
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
OG
l_int|3
op_logical_or
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|1
)braket
OG
l_int|3
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|left
op_assign
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|0
)braket
op_lshift
l_int|6
suffix:semicolon
id|right
op_assign
id|ucontrol-&gt;value.enumerated.item
(braket
l_int|1
)braket
op_lshift
l_int|6
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|left
op_assign
(paren
id|chip-&gt;image
(braket
id|OPTi93X_MIXOUT_LEFT
)braket
op_amp
op_complement
id|OPTi93X_MIXOUT_MIXER
)paren
op_or
id|left
suffix:semicolon
id|right
op_assign
(paren
id|chip-&gt;image
(braket
id|OPTi93X_MIXOUT_RIGHT
)braket
op_amp
op_complement
id|OPTi93X_MIXOUT_MIXER
)paren
op_or
id|right
suffix:semicolon
id|change
op_assign
id|left
op_ne
id|chip-&gt;image
(braket
id|OPTi93X_MIXOUT_LEFT
)braket
op_logical_or
id|right
op_ne
id|chip-&gt;image
(braket
id|OPTi93X_MIXOUT_RIGHT
)braket
suffix:semicolon
id|snd_opti93x_out
c_func
(paren
id|chip
comma
id|OPTi93X_MIXOUT_LEFT
comma
id|left
)paren
suffix:semicolon
id|snd_opti93x_out
c_func
(paren
id|chip
comma
id|OPTi93X_MIXOUT_RIGHT
comma
id|right
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_return
id|change
suffix:semicolon
)brace
macro_line|#if 0
mdefine_line|#define OPTi93X_SINGLE(xname, xindex, reg, shift, mask, invert) &bslash;&n;{ iface: SNDRV_CTL_ELEM_IFACE_MIXER, name: xname, index: xindex, &bslash;&n;  info: snd_opti93x_info_single, &bslash;&n;  get: snd_opti93x_get_single, put: snd_opti93x_put_single, &bslash;&n;  private_value: reg | (shift &lt;&lt; 8) | (mask &lt;&lt; 16) | (invert &lt;&lt; 24) }
r_static
r_int
id|snd_opti93x_info_single
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
r_int
id|mask
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|16
)paren
op_amp
l_int|0xff
suffix:semicolon
id|uinfo-&gt;type
op_assign
id|mask
op_eq
l_int|1
ques
c_cond
id|SNDRV_CTL_ELEM_TYPE_BOOLEAN
suffix:colon
id|SNDRV_CTL_ELEM_TYPE_INTEGER
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|1
suffix:semicolon
id|uinfo-&gt;value.integer.min
op_assign
l_int|0
suffix:semicolon
id|uinfo-&gt;value.integer.max
op_assign
id|mask
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
id|snd_opti93x_get_single
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|opti93x_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
id|reg
op_assign
id|kcontrol-&gt;private_value
op_amp
l_int|0xff
suffix:semicolon
r_int
id|shift
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
suffix:semicolon
r_int
id|mask
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|16
)paren
op_amp
l_int|0xff
suffix:semicolon
r_int
id|invert
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|24
)paren
op_amp
l_int|0xff
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
(paren
id|chip-&gt;image
(braket
id|reg
)braket
op_rshift
id|shift
)paren
op_amp
id|mask
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|invert
)paren
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
id|mask
op_minus
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
id|snd_opti93x_put_single
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|opti93x_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
id|reg
op_assign
id|kcontrol-&gt;private_value
op_amp
l_int|0xff
suffix:semicolon
r_int
id|shift
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
suffix:semicolon
r_int
id|mask
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|16
)paren
op_amp
l_int|0xff
suffix:semicolon
r_int
id|invert
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|24
)paren
op_amp
l_int|0xff
suffix:semicolon
r_int
id|change
suffix:semicolon
r_int
r_int
id|val
suffix:semicolon
id|val
op_assign
(paren
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_amp
id|mask
)paren
suffix:semicolon
r_if
c_cond
(paren
id|invert
)paren
id|val
op_assign
id|mask
op_minus
id|val
suffix:semicolon
id|val
op_lshift_assign
id|shift
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|val
op_assign
(paren
id|chip-&gt;image
(braket
id|reg
)braket
op_amp
op_complement
(paren
id|mask
op_lshift
id|shift
)paren
)paren
op_or
id|val
suffix:semicolon
id|change
op_assign
id|val
op_ne
id|chip-&gt;image
(braket
id|reg
)braket
suffix:semicolon
id|snd_opti93x_out
c_func
(paren
id|chip
comma
id|reg
comma
id|val
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_return
id|change
suffix:semicolon
)brace
macro_line|#endif /* single */
DECL|macro|OPTi93X_DOUBLE
mdefine_line|#define OPTi93X_DOUBLE(xname, xindex, left_reg, right_reg, shift_left, shift_right, mask, invert) &bslash;&n;{ iface: SNDRV_CTL_ELEM_IFACE_MIXER, name: xname, index: xindex, &bslash;&n;  info: snd_opti93x_info_double, &bslash;&n;  get: snd_opti93x_get_double, put: snd_opti93x_put_double, &bslash;&n;  private_value: left_reg | (right_reg &lt;&lt; 8) | (shift_left &lt;&lt; 16) | (shift_right &lt;&lt; 19) | (mask &lt;&lt; 24) | (invert &lt;&lt; 22) }
DECL|macro|OPTi93X_DOUBLE_INVERT_INVERT
mdefine_line|#define OPTi93X_DOUBLE_INVERT_INVERT(xctl) &bslash;&n;&t;do { xctl.private_value ^= 22; } while (0)
DECL|macro|OPTi93X_DOUBLE_CHANGE_REGS
mdefine_line|#define OPTi93X_DOUBLE_CHANGE_REGS(xctl, left_reg, right_reg) &bslash;&n;&t;do { xctl.private_value &amp;= ~0x0000ffff; &bslash;&n;&t;     xctl.private_value |= left_reg | (right_reg &lt;&lt; 8); } while (0)
DECL|function|snd_opti93x_info_double
r_static
r_int
id|snd_opti93x_info_double
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_info_t
op_star
id|uinfo
)paren
(brace
r_int
id|mask
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|16
)paren
op_amp
l_int|0xff
suffix:semicolon
id|uinfo-&gt;type
op_assign
id|mask
op_eq
l_int|1
ques
c_cond
id|SNDRV_CTL_ELEM_TYPE_BOOLEAN
suffix:colon
id|SNDRV_CTL_ELEM_TYPE_INTEGER
suffix:semicolon
id|uinfo-&gt;count
op_assign
l_int|2
suffix:semicolon
id|uinfo-&gt;value.integer.min
op_assign
l_int|0
suffix:semicolon
id|uinfo-&gt;value.integer.max
op_assign
id|mask
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_opti93x_get_double
r_static
r_int
id|snd_opti93x_get_double
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|opti93x_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
id|left_reg
op_assign
id|kcontrol-&gt;private_value
op_amp
l_int|0xff
suffix:semicolon
r_int
id|right_reg
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
suffix:semicolon
r_int
id|shift_left
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|16
)paren
op_amp
l_int|0x07
suffix:semicolon
r_int
id|shift_right
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|19
)paren
op_amp
l_int|0x07
suffix:semicolon
r_int
id|mask
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|24
)paren
op_amp
l_int|0xff
suffix:semicolon
r_int
id|invert
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|22
)paren
op_amp
l_int|1
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
(paren
id|chip-&gt;image
(braket
id|left_reg
)braket
op_rshift
id|shift_left
)paren
op_amp
id|mask
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|1
)braket
op_assign
(paren
id|chip-&gt;image
(braket
id|right_reg
)braket
op_rshift
id|shift_right
)paren
op_amp
id|mask
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|invert
)paren
(brace
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_assign
id|mask
op_minus
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
suffix:semicolon
id|ucontrol-&gt;value.integer.value
(braket
l_int|1
)braket
op_assign
id|mask
op_minus
id|ucontrol-&gt;value.integer.value
(braket
l_int|1
)braket
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snd_opti93x_put_double
r_static
r_int
id|snd_opti93x_put_double
c_func
(paren
id|snd_kcontrol_t
op_star
id|kcontrol
comma
id|snd_ctl_elem_value_t
op_star
id|ucontrol
)paren
(brace
id|opti93x_t
op_star
id|chip
op_assign
id|snd_kcontrol_chip
c_func
(paren
id|kcontrol
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
id|left_reg
op_assign
id|kcontrol-&gt;private_value
op_amp
l_int|0xff
suffix:semicolon
r_int
id|right_reg
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
suffix:semicolon
r_int
id|shift_left
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|16
)paren
op_amp
l_int|0x07
suffix:semicolon
r_int
id|shift_right
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|19
)paren
op_amp
l_int|0x07
suffix:semicolon
r_int
id|mask
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|24
)paren
op_amp
l_int|0xff
suffix:semicolon
r_int
id|invert
op_assign
(paren
id|kcontrol-&gt;private_value
op_rshift
l_int|22
)paren
op_amp
l_int|1
suffix:semicolon
r_int
id|change
suffix:semicolon
r_int
r_int
id|val1
comma
id|val2
suffix:semicolon
id|val1
op_assign
id|ucontrol-&gt;value.integer.value
(braket
l_int|0
)braket
op_amp
id|mask
suffix:semicolon
id|val2
op_assign
id|ucontrol-&gt;value.integer.value
(braket
l_int|1
)braket
op_amp
id|mask
suffix:semicolon
r_if
c_cond
(paren
id|invert
)paren
(brace
id|val1
op_assign
id|mask
op_minus
id|val1
suffix:semicolon
id|val2
op_assign
id|mask
op_minus
id|val2
suffix:semicolon
)brace
id|val1
op_lshift_assign
id|shift_left
suffix:semicolon
id|val2
op_lshift_assign
id|shift_right
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|val1
op_assign
(paren
id|chip-&gt;image
(braket
id|left_reg
)braket
op_amp
op_complement
(paren
id|mask
op_lshift
id|shift_left
)paren
)paren
op_or
id|val1
suffix:semicolon
id|val2
op_assign
(paren
id|chip-&gt;image
(braket
id|right_reg
)braket
op_amp
op_complement
(paren
id|mask
op_lshift
id|shift_right
)paren
)paren
op_or
id|val2
suffix:semicolon
id|change
op_assign
id|val1
op_ne
id|chip-&gt;image
(braket
id|left_reg
)braket
op_logical_or
id|val2
op_ne
id|chip-&gt;image
(braket
id|right_reg
)braket
suffix:semicolon
id|snd_opti93x_out
c_func
(paren
id|chip
comma
id|left_reg
comma
id|val1
)paren
suffix:semicolon
id|snd_opti93x_out
c_func
(paren
id|chip
comma
id|right_reg
comma
id|val1
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_return
id|change
suffix:semicolon
)brace
DECL|macro|OPTi93X_CONTROLS
mdefine_line|#define OPTi93X_CONTROLS (sizeof(snd_opti93x_controls)/sizeof(snd_kcontrol_new_t))
DECL|variable|snd_opti93x_controls
r_static
id|snd_kcontrol_new_t
id|snd_opti93x_controls
(braket
)braket
op_assign
(brace
id|OPTi93X_DOUBLE
c_func
(paren
l_string|&quot;Master Playback Switch&quot;
comma
l_int|0
comma
id|OPTi93X_OUT_LEFT
comma
id|OPTi93X_OUT_RIGHT
comma
l_int|7
comma
l_int|7
comma
l_int|1
comma
l_int|1
)paren
comma
id|OPTi93X_DOUBLE
c_func
(paren
l_string|&quot;Master Playback Volume&quot;
comma
l_int|0
comma
id|OPTi93X_OUT_LEFT
comma
id|OPTi93X_OUT_RIGHT
comma
l_int|0
comma
l_int|0
comma
l_int|31
comma
l_int|1
)paren
comma
id|OPTi93X_DOUBLE
c_func
(paren
l_string|&quot;PCM Playback Switch&quot;
comma
l_int|0
comma
id|OPTi93X_DAC_LEFT
comma
id|OPTi93X_DAC_RIGHT
comma
l_int|7
comma
l_int|7
comma
l_int|1
comma
l_int|1
)paren
comma
id|OPTi93X_DOUBLE
c_func
(paren
l_string|&quot;PCM Playback Volume&quot;
comma
l_int|0
comma
id|OPTi93X_DAC_LEFT
comma
id|OPTi93X_DAC_RIGHT
comma
l_int|0
comma
l_int|0
comma
l_int|31
comma
l_int|0
)paren
comma
id|OPTi93X_DOUBLE
c_func
(paren
l_string|&quot;FM Playback Switch&quot;
comma
l_int|0
comma
id|OPTi931_FM_LEFT_INPUT
comma
id|OPTi931_FM_RIGHT_INPUT
comma
l_int|7
comma
l_int|7
comma
l_int|1
comma
l_int|1
)paren
comma
id|OPTi93X_DOUBLE
c_func
(paren
l_string|&quot;FM Playback Volume&quot;
comma
l_int|0
comma
id|OPTi931_FM_LEFT_INPUT
comma
id|OPTi931_FM_RIGHT_INPUT
comma
l_int|0
comma
l_int|0
comma
l_int|15
comma
l_int|1
)paren
comma
id|OPTi93X_DOUBLE
c_func
(paren
l_string|&quot;Line Playback Switch&quot;
comma
l_int|0
comma
id|OPTi93X_LINE_LEFT_INPUT
comma
id|OPTi93X_LINE_RIGHT_INPUT
comma
l_int|7
comma
l_int|7
comma
l_int|1
comma
l_int|1
)paren
comma
id|OPTi93X_DOUBLE
c_func
(paren
l_string|&quot;Line Playback Volume&quot;
comma
l_int|0
comma
id|OPTi93X_LINE_LEFT_INPUT
comma
id|OPTi93X_LINE_RIGHT_INPUT
comma
l_int|0
comma
l_int|0
comma
l_int|15
comma
l_int|1
)paren
comma
id|OPTi93X_DOUBLE
c_func
(paren
l_string|&quot;Mic Playback Switch&quot;
comma
l_int|0
comma
id|OPTi93X_MIC_LEFT_INPUT
comma
id|OPTi93X_MIC_RIGHT_INPUT
comma
l_int|7
comma
l_int|7
comma
l_int|1
comma
l_int|1
)paren
comma
id|OPTi93X_DOUBLE
c_func
(paren
l_string|&quot;Mic Playback Volume&quot;
comma
l_int|0
comma
id|OPTi93X_MIC_LEFT_INPUT
comma
id|OPTi93X_MIC_RIGHT_INPUT
comma
l_int|0
comma
l_int|0
comma
l_int|15
comma
l_int|1
)paren
comma
id|OPTi93X_DOUBLE
c_func
(paren
l_string|&quot;Mic Boost&quot;
comma
l_int|0
comma
id|OPTi93X_MIXOUT_LEFT
comma
id|OPTi93X_MIXOUT_RIGHT
comma
l_int|5
comma
l_int|5
comma
l_int|1
comma
l_int|1
)paren
comma
id|OPTi93X_DOUBLE
c_func
(paren
l_string|&quot;CD Playback Switch&quot;
comma
l_int|0
comma
id|OPTi93X_CD_LEFT_INPUT
comma
id|OPTi93X_CD_RIGHT_INPUT
comma
l_int|7
comma
l_int|7
comma
l_int|1
comma
l_int|1
)paren
comma
id|OPTi93X_DOUBLE
c_func
(paren
l_string|&quot;CD Playback Volume&quot;
comma
l_int|0
comma
id|OPTi93X_CD_LEFT_INPUT
comma
id|OPTi93X_CD_RIGHT_INPUT
comma
l_int|0
comma
l_int|0
comma
l_int|15
comma
l_int|1
)paren
comma
id|OPTi93X_DOUBLE
c_func
(paren
l_string|&quot;Aux Playback Switch&quot;
comma
l_int|0
comma
id|OPTi931_AUX_LEFT_INPUT
comma
id|OPTi931_AUX_RIGHT_INPUT
comma
l_int|7
comma
l_int|7
comma
l_int|1
comma
l_int|1
)paren
comma
id|OPTi93X_DOUBLE
c_func
(paren
l_string|&quot;Aux Playback Volume&quot;
comma
l_int|0
comma
id|OPTi931_AUX_LEFT_INPUT
comma
id|OPTi931_AUX_RIGHT_INPUT
comma
l_int|0
comma
l_int|0
comma
l_int|15
comma
l_int|1
)paren
comma
id|OPTi93X_DOUBLE
c_func
(paren
l_string|&quot;Capture Volume&quot;
comma
l_int|0
comma
id|OPTi93X_MIXOUT_LEFT
comma
id|OPTi93X_MIXOUT_RIGHT
comma
l_int|0
comma
l_int|0
comma
l_int|15
comma
l_int|0
)paren
comma
(brace
id|iface
suffix:colon
id|SNDRV_CTL_ELEM_IFACE_MIXER
comma
id|name
suffix:colon
l_string|&quot;Capture Source&quot;
comma
id|info
suffix:colon
id|snd_opti93x_info_mux
comma
id|get
suffix:colon
id|snd_opti93x_get_mux
comma
id|put
suffix:colon
id|snd_opti93x_put_mux
comma
)brace
)brace
suffix:semicolon
DECL|function|snd_opti93x_mixer
r_int
id|snd_opti93x_mixer
c_func
(paren
id|opti93x_t
op_star
id|chip
)paren
(brace
id|snd_card_t
op_star
id|card
suffix:semicolon
id|snd_kcontrol_new_t
id|knew
suffix:semicolon
r_int
id|err
comma
id|idx
suffix:semicolon
id|snd_assert
c_func
(paren
id|chip
op_ne
l_int|NULL
op_logical_and
id|chip-&gt;card
op_ne
l_int|NULL
comma
r_return
op_minus
id|EINVAL
)paren
suffix:semicolon
id|card
op_assign
id|chip-&gt;card
suffix:semicolon
id|strcpy
c_func
(paren
id|card-&gt;mixername
comma
id|snd_opti93x_chip_id
c_func
(paren
id|chip
)paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|idx
op_assign
l_int|0
suffix:semicolon
id|idx
OL
id|OPTi93X_CONTROLS
suffix:semicolon
id|idx
op_increment
)paren
(brace
id|knew
op_assign
id|snd_opti93x_controls
(braket
id|idx
)braket
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;hardware
op_eq
id|OPTi9XX_HW_82C930
)paren
(brace
r_if
c_cond
(paren
id|strstr
c_func
(paren
id|knew.name
comma
l_string|&quot;FM&quot;
)paren
)paren
multiline_comment|/* skip FM controls */
r_continue
suffix:semicolon
r_else
r_if
c_cond
(paren
id|strcmp
c_func
(paren
id|knew.name
comma
l_string|&quot;Mic Playback Volume&quot;
)paren
)paren
id|OPTi93X_DOUBLE_INVERT_INVERT
c_func
(paren
id|knew
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|strstr
c_func
(paren
id|knew.name
comma
l_string|&quot;Aux&quot;
)paren
)paren
id|OPTi93X_DOUBLE_CHANGE_REGS
c_func
(paren
id|knew
comma
id|OPTi930_AUX_LEFT_INPUT
comma
id|OPTi930_AUX_RIGHT_INPUT
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|strcmp
c_func
(paren
id|knew.name
comma
l_string|&quot;PCM Playback Volume&quot;
)paren
)paren
id|OPTi93X_DOUBLE_INVERT_INVERT
c_func
(paren
id|knew
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|strcmp
c_func
(paren
id|knew.name
comma
l_string|&quot;Master Playback Volume&quot;
)paren
)paren
id|OPTi93X_DOUBLE_INVERT_INVERT
c_func
(paren
id|knew
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_ctl_add
c_func
(paren
id|card
comma
id|snd_ctl_new1
c_func
(paren
op_amp
id|snd_opti93x_controls
(braket
id|idx
)braket
comma
id|chip
)paren
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#endif /* OPTi93X */
DECL|function|snd_card_opti9xx_detect
r_static
r_int
id|__init
id|snd_card_opti9xx_detect
c_func
(paren
id|snd_card_t
op_star
id|card
comma
id|opti9xx_t
op_star
id|chip
)paren
(brace
r_int
id|i
comma
id|err
suffix:semicolon
r_static
r_int
id|opti9xx_mc_size
(braket
)braket
op_assign
(brace
l_int|7
comma
l_int|7
comma
l_int|10
comma
l_int|10
comma
l_int|2
comma
l_int|2
comma
l_int|2
)brace
suffix:semicolon
macro_line|#ifndef OPTi93X
r_for
c_loop
(paren
id|i
op_assign
id|OPTi9XX_HW_82C928
suffix:semicolon
id|i
OL
id|OPTi9XX_HW_82C930
suffix:semicolon
id|i
op_increment
)paren
(brace
r_int
r_char
id|value
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_opti9xx_init
c_func
(paren
id|chip
comma
id|i
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|chip-&gt;mc_base_size
op_assign
id|opti9xx_mc_size
(braket
id|i
)braket
suffix:semicolon
r_if
c_cond
(paren
id|check_region
c_func
(paren
id|chip-&gt;mc_base
comma
id|chip-&gt;mc_base_size
)paren
)paren
r_continue
suffix:semicolon
id|value
op_assign
id|snd_opti9xx_read
c_func
(paren
id|chip
comma
id|OPTi9XX_MC_REG
c_func
(paren
l_int|1
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|value
op_ne
l_int|0xff
)paren
op_logical_and
(paren
id|value
op_ne
id|inb
c_func
(paren
id|chip-&gt;mc_base
op_plus
l_int|1
)paren
)paren
)paren
r_if
c_cond
(paren
id|value
op_eq
id|snd_opti9xx_read
c_func
(paren
id|chip
comma
id|OPTi9XX_MC_REG
c_func
(paren
l_int|1
)paren
)paren
)paren
r_return
l_int|1
suffix:semicolon
)brace
macro_line|#else&t;/* OPTi93X */
r_for
c_loop
(paren
id|i
op_assign
id|OPTi9XX_HW_82C931
suffix:semicolon
id|i
op_ge
id|OPTi9XX_HW_82C930
suffix:semicolon
id|i
op_decrement
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
r_int
r_char
id|value
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|snd_opti9xx_init
c_func
(paren
id|chip
comma
id|i
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|chip-&gt;mc_base_size
op_assign
id|opti9xx_mc_size
(braket
id|i
)braket
suffix:semicolon
r_if
c_cond
(paren
id|check_region
c_func
(paren
id|chip-&gt;mc_base
comma
id|chip-&gt;mc_base_size
)paren
)paren
r_continue
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|outb
c_func
(paren
id|chip-&gt;password
comma
id|chip-&gt;mc_base
op_plus
id|chip-&gt;pwd_reg
)paren
suffix:semicolon
id|outb
c_func
(paren
(paren
(paren
id|chip-&gt;mc_indir_index
op_amp
(paren
l_int|1
op_lshift
l_int|8
)paren
)paren
op_rshift
l_int|4
)paren
op_or
(paren
(paren
id|chip-&gt;mc_indir_index
op_amp
l_int|0xf0
)paren
op_rshift
l_int|4
)paren
comma
id|chip-&gt;mc_base
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|chip-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|value
op_assign
id|snd_opti9xx_read
c_func
(paren
id|chip
comma
id|OPTi9XX_MC_REG
c_func
(paren
l_int|7
)paren
)paren
suffix:semicolon
id|snd_opti9xx_write
c_func
(paren
id|chip
comma
id|OPTi9XX_MC_REG
c_func
(paren
l_int|7
)paren
comma
l_int|0xff
op_minus
id|value
)paren
suffix:semicolon
r_if
c_cond
(paren
id|snd_opti9xx_read
c_func
(paren
id|chip
comma
id|OPTi9XX_MC_REG
c_func
(paren
l_int|7
)paren
)paren
op_eq
l_int|0xff
op_minus
id|value
)paren
r_return
l_int|1
suffix:semicolon
)brace
macro_line|#endif&t;/* OPTi93X */
r_return
op_minus
id|ENODEV
suffix:semicolon
)brace
macro_line|#ifdef __ISAPNP__
DECL|function|snd_card_opti9xx_isapnp
r_static
r_int
id|__init
id|snd_card_opti9xx_isapnp
c_func
(paren
id|opti9xx_t
op_star
id|chip
)paren
(brace
r_struct
id|isapnp_dev
op_star
id|pdev
op_assign
l_int|NULL
suffix:semicolon
r_const
r_struct
id|isapnp_card_id
op_star
id|pid
op_assign
id|snd_card_opti9xx_pnpids
op_minus
l_int|1
suffix:semicolon
r_static
r_struct
id|isapnp_card
op_star
id|card
op_assign
l_int|NULL
suffix:semicolon
id|__again
suffix:colon
r_while
c_loop
(paren
l_int|1
)paren
(brace
id|pid
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|pid-&gt;card_vendor
op_eq
l_int|0
)paren
r_return
op_minus
id|ENODEV
suffix:semicolon
r_if
c_cond
(paren
(paren
id|card
op_assign
id|isapnp_find_card
c_func
(paren
id|pid-&gt;card_vendor
comma
id|pid-&gt;card_device
comma
id|card
)paren
)paren
)paren
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|card
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENODEV
suffix:semicolon
id|chip-&gt;dev
op_assign
id|isapnp_find_dev
c_func
(paren
id|card
comma
id|pid-&gt;devs
(braket
l_int|0
)braket
dot
id|vendor
comma
id|pid-&gt;devs
(braket
l_int|0
)braket
dot
id|function
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;dev
op_eq
l_int|NULL
)paren
r_goto
id|__again
suffix:semicolon
id|chip-&gt;devmpu
op_assign
id|isapnp_find_dev
c_func
(paren
id|card
comma
id|pid-&gt;devs
(braket
l_int|1
)braket
dot
id|vendor
comma
id|pid-&gt;devs
(braket
l_int|1
)braket
dot
id|function
comma
l_int|NULL
)paren
suffix:semicolon
id|pdev
op_assign
id|chip-&gt;dev
suffix:semicolon
r_if
c_cond
(paren
id|pdev
op_member_access_from_pointer
id|prepare
c_func
(paren
id|pdev
)paren
OL
l_int|0
)paren
r_return
op_minus
id|EAGAIN
suffix:semicolon
macro_line|#ifdef OPTi93X
r_if
c_cond
(paren
id|snd_port
op_ne
id|SNDRV_AUTO_PORT
)paren
id|isapnp_resource_change
c_func
(paren
op_amp
id|pdev-&gt;resource
(braket
l_int|0
)braket
comma
id|snd_port
op_plus
l_int|4
comma
l_int|4
)paren
suffix:semicolon
macro_line|#else
r_if
c_cond
(paren
(paren
id|pid-&gt;card_device
op_ne
id|ISAPNP_DEVICE
c_func
(paren
l_int|0x0924
)paren
)paren
op_logical_and
(paren
id|snd_port
op_ne
id|SNDRV_AUTO_PORT
)paren
)paren
id|isapnp_resource_change
c_func
(paren
op_amp
id|pdev-&gt;resource
(braket
l_int|1
)braket
comma
id|snd_port
comma
l_int|4
)paren
suffix:semicolon
macro_line|#endif&t;/* OPTi93X */
r_if
c_cond
(paren
id|snd_irq
op_ne
id|SNDRV_AUTO_IRQ
)paren
id|isapnp_resource_change
c_func
(paren
op_amp
id|pdev-&gt;irq_resource
(braket
l_int|0
)braket
comma
id|snd_irq
comma
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|snd_dma1
op_ne
id|SNDRV_AUTO_DMA
)paren
id|isapnp_resource_change
c_func
(paren
op_amp
id|pdev-&gt;dma_resource
(braket
l_int|0
)braket
comma
id|snd_dma1
comma
l_int|1
)paren
suffix:semicolon
macro_line|#if defined(CS4231) || defined(OPTi93X)
r_if
c_cond
(paren
id|snd_dma2
op_ne
id|SNDRV_AUTO_DMA
)paren
id|isapnp_resource_change
c_func
(paren
op_amp
id|pdev-&gt;dma_resource
(braket
l_int|1
)braket
comma
id|snd_dma2
comma
l_int|1
)paren
suffix:semicolon
macro_line|#endif&t;/* CS4231 || OPTi93X */
r_if
c_cond
(paren
id|snd_fm_port
op_ne
id|SNDRV_AUTO_PORT
)paren
id|isapnp_resource_change
c_func
(paren
op_amp
id|pdev-&gt;resource
(braket
l_int|1
)braket
comma
id|snd_fm_port
comma
l_int|4
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pdev
op_member_access_from_pointer
id|activate
c_func
(paren
id|pdev
)paren
OL
l_int|0
)paren
(brace
id|snd_printk
c_func
(paren
l_string|&quot;AUDIO isapnp configure failure&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
macro_line|#ifdef OPTi93X
id|snd_port
op_assign
id|pdev-&gt;resource
(braket
l_int|0
)braket
dot
id|start
op_minus
l_int|4
suffix:semicolon
id|snd_fm_port
op_assign
id|pdev-&gt;resource
(braket
l_int|1
)braket
dot
id|start
suffix:semicolon
macro_line|#else
r_if
c_cond
(paren
id|pid-&gt;card_device
op_ne
id|ISAPNP_DEVICE
c_func
(paren
l_int|0x0924
)paren
)paren
id|snd_port
op_assign
id|pdev-&gt;resource
(braket
l_int|1
)braket
dot
id|start
suffix:semicolon
id|snd_fm_port
op_assign
id|pdev-&gt;resource
(braket
l_int|2
)braket
dot
id|start
suffix:semicolon
macro_line|#endif&t;/* OPTi93X */
id|snd_irq
op_assign
id|pdev-&gt;irq_resource
(braket
l_int|0
)braket
dot
id|start
suffix:semicolon
id|snd_dma1
op_assign
id|pdev-&gt;dma_resource
(braket
l_int|0
)braket
dot
id|start
suffix:semicolon
macro_line|#if defined(CS4231) || defined(OPTi93X)
id|snd_dma2
op_assign
id|pdev-&gt;dma_resource
(braket
l_int|1
)braket
dot
id|start
suffix:semicolon
macro_line|#endif&t;/* CS4231 || OPTi93X */
id|pdev
op_assign
id|chip-&gt;devmpu
suffix:semicolon
r_if
c_cond
(paren
id|pdev
op_eq
l_int|NULL
op_logical_or
id|pdev
op_member_access_from_pointer
id|prepare
c_func
(paren
id|pdev
)paren
OL
l_int|0
)paren
(brace
id|snd_mpu_port
op_assign
op_minus
l_int|1
suffix:semicolon
id|chip-&gt;devmpu
op_assign
l_int|NULL
suffix:semicolon
r_return
id|pid-&gt;card_device
suffix:semicolon
)brace
r_if
c_cond
(paren
id|snd_mpu_port
op_ne
id|SNDRV_AUTO_PORT
)paren
id|isapnp_resource_change
c_func
(paren
op_amp
id|pdev-&gt;resource
(braket
l_int|0
)braket
comma
id|snd_mpu_port
comma
l_int|2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|snd_mpu_irq
op_ne
id|SNDRV_AUTO_IRQ
)paren
id|isapnp_resource_change
c_func
(paren
op_amp
id|pdev-&gt;irq_resource
(braket
l_int|0
)braket
comma
id|snd_mpu_irq
comma
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pdev
op_member_access_from_pointer
id|activate
c_func
(paren
id|pdev
)paren
OL
l_int|0
)paren
(brace
id|snd_printk
c_func
(paren
l_string|&quot;MPU-401 isapnp configure failure&bslash;n&quot;
)paren
suffix:semicolon
id|snd_mpu_port
op_assign
op_minus
l_int|1
suffix:semicolon
id|chip-&gt;devmpu
op_assign
l_int|NULL
suffix:semicolon
)brace
r_else
(brace
id|snd_mpu_port
op_assign
id|pdev-&gt;resource
(braket
l_int|0
)braket
dot
id|start
suffix:semicolon
id|snd_mpu_irq
op_assign
id|pdev-&gt;irq_resource
(braket
l_int|0
)braket
dot
id|start
suffix:semicolon
)brace
r_return
id|pid-&gt;card_device
suffix:semicolon
)brace
DECL|function|snd_card_opti9xx_deactivate
r_static
r_void
id|snd_card_opti9xx_deactivate
c_func
(paren
id|opti9xx_t
op_star
id|chip
)paren
(brace
r_if
c_cond
(paren
id|chip-&gt;dev
)paren
id|chip-&gt;dev
op_member_access_from_pointer
id|deactivate
c_func
(paren
id|chip-&gt;dev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;devmpu
)paren
id|chip-&gt;devmpu
op_member_access_from_pointer
id|deactivate
c_func
(paren
id|chip-&gt;devmpu
)paren
suffix:semicolon
)brace
macro_line|#endif&t;/* __ISAPNP__ */
macro_line|#if 0
r_static
r_int
id|__init
id|snd_card_opti9xx_resources
c_func
(paren
r_struct
id|snd_card_opti9xx
op_star
id|chip
comma
id|snd_card_t
op_star
id|card
)paren
(brace
r_int
id|error
comma
id|i
comma
id|pnp
op_assign
l_int|0
suffix:semicolon
macro_line|#ifdef __ISAPNP__
id|pnp
op_assign
id|chip-&gt;dev
op_ne
l_int|NULL
suffix:semicolon
macro_line|#endif&t;/* __ISAPNP__ */
macro_line|#ifndef OPTi93X
r_if
c_cond
(paren
id|chip-&gt;chip-&gt;hardware
op_eq
id|OPTi9XX_HW_82C928
)paren
id|snd_mpu_port
op_assign
op_minus
l_int|1
suffix:semicolon
macro_line|#endif&t;/* OPTi93X */
id|error
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|pnp
op_logical_and
(paren
id|snd_mpu_port
op_eq
id|SNDRV_DEFAULT_PORT1
)paren
)paren
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|possible_mpu_ports
(braket
id|i
)braket
op_ne
op_minus
l_int|1
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
op_logical_neg
id|snd_register_ioport
c_func
(paren
id|card
comma
id|possible_mpu_ports
(braket
id|i
)braket
comma
l_int|2
comma
id|DRIVER_NAME
l_string|&quot; - MPU-401&quot;
comma
l_int|NULL
)paren
)paren
(brace
id|snd_mpu_port
op_assign
id|possible_mpu_ports
(braket
id|i
)braket
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|snd_mpu_port
op_eq
id|SNDRV_DEFAULT_PORT1
)paren
id|error
op_assign
op_minus
id|EBUSY
suffix:semicolon
)brace
r_else
id|error
op_assign
(paren
id|snd_mpu_port
op_eq
op_minus
l_int|1
)paren
ques
c_cond
op_minus
id|ENODEV
suffix:colon
id|snd_register_ioport
c_func
(paren
id|card
comma
id|snd_mpu_port
comma
l_int|2
comma
id|DRIVER_NAME
l_string|&quot; - MPU-401&quot;
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|error
)paren
id|chip-&gt;chip-&gt;mpu_port
op_assign
op_minus
l_int|1
suffix:semicolon
r_else
r_if
c_cond
(paren
id|pnp
op_logical_and
(paren
id|snd_irq
op_eq
id|snd_mpu_irq
)paren
)paren
id|chip-&gt;chip-&gt;mpu_irq
op_assign
id|snd_mpu_irq
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|snd_register_interrupt
c_func
(paren
id|card
comma
id|DRIVER_NAME
l_string|&quot; - MPU-401&quot;
comma
id|snd_mpu_irq
comma
id|SNDRV_IRQ_TYPE_ISA
comma
id|snd_card_opti9xx_mpu_interrupt
comma
id|chip
comma
id|pnp
ques
c_cond
id|no_alternatives
suffix:colon
id|possible_mpu_irqs
comma
op_amp
id|chip-&gt;mpuirqptr
)paren
)paren
(brace
id|chip-&gt;chip-&gt;mpu_port
op_assign
id|snd_mpu_port
suffix:semicolon
id|chip-&gt;chip-&gt;mpu_irq
op_assign
id|chip-&gt;mpuirqptr-&gt;irq
suffix:semicolon
)brace
r_else
id|chip-&gt;chip-&gt;mpu_port
op_assign
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|pnp
op_logical_and
(paren
id|snd_port
op_eq
id|SNDRV_DEFAULT_PORT1
)paren
)paren
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|possible_ports
(braket
id|i
)braket
op_ne
op_minus
l_int|1
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
op_logical_neg
id|snd_register_ioport
c_func
(paren
id|card
comma
id|possible_ports
(braket
id|i
)braket
comma
l_int|8
comma
id|DRIVER_NAME
l_string|&quot; - WSS&quot;
comma
l_int|NULL
)paren
)paren
(brace
id|snd_port
op_assign
id|possible_ports
(braket
id|i
)braket
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|snd_port
op_eq
id|SNDRV_DEFAULT_PORT1
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
(paren
id|error
op_assign
id|snd_register_ioport
c_func
(paren
id|card
comma
id|snd_port
comma
l_int|8
comma
id|DRIVER_NAME
l_string|&quot; - WSS&quot;
comma
l_int|NULL
)paren
)paren
OL
l_int|0
)paren
r_return
id|error
suffix:semicolon
id|chip-&gt;chip-&gt;wss_base
op_assign
id|snd_port
suffix:semicolon
r_if
c_cond
(paren
(paren
id|error
op_assign
id|snd_register_interrupt
c_func
(paren
id|card
comma
id|DRIVER_NAME
l_string|&quot; - WSS&quot;
comma
id|snd_irq
comma
id|SNDRV_IRQ_TYPE_ISA
comma
id|snd_card_opti9xx_interrupt
comma
id|chip
comma
id|pnp
ques
c_cond
id|no_alternatives
suffix:colon
id|possible_irqs
comma
op_amp
id|chip-&gt;irqptr
)paren
)paren
OL
l_int|0
)paren
r_return
id|error
suffix:semicolon
id|chip-&gt;chip-&gt;irq
op_assign
id|chip-&gt;irqptr-&gt;irq
suffix:semicolon
r_if
c_cond
(paren
(paren
id|error
op_assign
id|snd_register_dma_channel
c_func
(paren
id|card
comma
macro_line|#if defined(CS4231) || defined(OPTi93X)
id|DRIVER_NAME
l_string|&quot; - WSS playback&quot;
comma
macro_line|#else
id|DRIVER_NAME
l_string|&quot; - WSS&quot;
comma
macro_line|#endif&t;/* CS4231 || OPTi93X */
id|snd_dma1
comma
id|SNDRV_DMA_TYPE_ISA
comma
id|snd_dma1_size
comma
id|pnp
ques
c_cond
id|no_alternatives
suffix:colon
id|possible_dma1s
comma
op_amp
id|chip-&gt;dma1ptr
)paren
)paren
OL
l_int|0
)paren
r_return
id|error
suffix:semicolon
id|chip-&gt;chip-&gt;dma1
op_assign
id|chip-&gt;dma1ptr-&gt;dma
suffix:semicolon
macro_line|#if defined(CS4231) || defined(OPTi93X)
r_if
c_cond
(paren
(paren
id|error
op_assign
id|snd_register_dma_channel
c_func
(paren
id|card
comma
id|DRIVER_NAME
l_string|&quot; - WSS capture&quot;
comma
id|snd_dma2
comma
id|SNDRV_DMA_TYPE_ISA
comma
id|snd_dma2_size
comma
id|pnp
ques
c_cond
id|no_alternatives
suffix:colon
id|possible_dma2s
(braket
id|chip-&gt;dma1ptr-&gt;dma
)braket
comma
op_amp
id|chip-&gt;dma2ptr
)paren
)paren
OL
l_int|0
)paren
r_return
id|error
suffix:semicolon
id|chip-&gt;chip-&gt;dma2
op_assign
id|chip-&gt;dma2ptr-&gt;dma
suffix:semicolon
macro_line|#endif&t;/* CS4231 || OPTi93X */
r_if
c_cond
(paren
id|snd_register_ioport
c_func
(paren
id|card
comma
id|pnp
ques
c_cond
id|snd_fm_port
suffix:colon
id|snd_fm_port
op_assign
l_int|0x388
comma
l_int|4
comma
id|DRIVER_NAME
l_string|&quot; - OPL&quot;
comma
l_int|NULL
)paren
OL
l_int|0
)paren
id|snd_fm_port
op_assign
op_minus
l_int|1
suffix:semicolon
id|chip-&gt;chip-&gt;fm_port
op_assign
id|snd_fm_port
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#endif
DECL|function|snd_card_opti9xx_free
r_static
r_void
id|snd_card_opti9xx_free
c_func
(paren
id|snd_card_t
op_star
id|card
)paren
(brace
id|opti9xx_t
op_star
id|chip
op_assign
(paren
id|opti9xx_t
op_star
)paren
id|card-&gt;private_data
suffix:semicolon
r_if
c_cond
(paren
id|chip
)paren
(brace
macro_line|#ifdef __ISAPNP__
id|snd_card_opti9xx_deactivate
c_func
(paren
id|chip
)paren
suffix:semicolon
macro_line|#endif&t;/* __ISAPNP__ */
r_if
c_cond
(paren
id|chip-&gt;res_mc_base
)paren
(brace
id|release_resource
c_func
(paren
id|chip-&gt;res_mc_base
)paren
suffix:semicolon
id|kfree_nocheck
c_func
(paren
id|chip-&gt;res_mc_base
)paren
suffix:semicolon
)brace
)brace
)brace
DECL|function|snd_card_opti9xx_probe
r_static
r_int
id|__init
id|snd_card_opti9xx_probe
c_func
(paren
r_void
)paren
(brace
r_static
r_int
id|possible_ports
(braket
)braket
op_assign
(brace
l_int|0x530
comma
l_int|0xe80
comma
l_int|0xf40
comma
l_int|0x604
comma
op_minus
l_int|1
)brace
suffix:semicolon
r_static
r_int
id|possible_mpu_ports
(braket
)braket
op_assign
(brace
l_int|0x300
comma
l_int|0x310
comma
l_int|0x320
comma
l_int|0x310
comma
op_minus
l_int|1
)brace
suffix:semicolon
macro_line|#ifdef OPTi93X
r_static
r_int
id|possible_irqs
(braket
)braket
op_assign
(brace
l_int|5
comma
l_int|9
comma
l_int|10
comma
l_int|11
comma
l_int|7
comma
op_minus
l_int|1
)brace
suffix:semicolon
macro_line|#else
r_static
r_int
id|possible_irqs
(braket
)braket
op_assign
(brace
l_int|9
comma
l_int|10
comma
l_int|11
comma
l_int|7
comma
op_minus
l_int|1
)brace
suffix:semicolon
macro_line|#endif&t;/* OPTi93X */
r_static
r_int
id|possible_mpu_irqs
(braket
)braket
op_assign
(brace
l_int|5
comma
l_int|9
comma
l_int|10
comma
l_int|7
comma
op_minus
l_int|1
)brace
suffix:semicolon
r_static
r_int
id|possible_dma1s
(braket
)braket
op_assign
(brace
l_int|3
comma
l_int|1
comma
l_int|0
comma
op_minus
l_int|1
)brace
suffix:semicolon
macro_line|#if defined(CS4231) || defined(OPTi93X)
r_static
r_int
id|possible_dma2s
(braket
)braket
(braket
l_int|2
)braket
op_assign
(brace
(brace
l_int|1
comma
op_minus
l_int|1
)brace
comma
(brace
l_int|0
comma
op_minus
l_int|1
)brace
comma
(brace
op_minus
l_int|1
comma
op_minus
l_int|1
)brace
comma
(brace
l_int|0
comma
op_minus
l_int|1
)brace
)brace
suffix:semicolon
macro_line|#endif&t;/* CS4231 || OPTi93X */
r_int
id|error
suffix:semicolon
id|opti9xx_t
op_star
id|chip
suffix:semicolon
macro_line|#if defined(OPTi93X)
id|opti93x_t
op_star
id|codec
suffix:semicolon
macro_line|#elif defined(CS4231)
id|cs4231_t
op_star
id|codec
suffix:semicolon
id|snd_timer_t
op_star
id|timer
suffix:semicolon
macro_line|#else
id|ad1848_t
op_star
id|codec
suffix:semicolon
macro_line|#endif
id|snd_card_t
op_star
id|card
suffix:semicolon
id|snd_pcm_t
op_star
id|pcm
suffix:semicolon
id|snd_rawmidi_t
op_star
id|rmidi
suffix:semicolon
id|snd_hwdep_t
op_star
id|synth
suffix:semicolon
macro_line|#ifdef __ISAPNP__
r_int
id|hw
suffix:semicolon
macro_line|#endif&t;/* __ISAPNP__ */
r_if
c_cond
(paren
op_logical_neg
(paren
id|card
op_assign
id|snd_card_new
c_func
(paren
id|snd_index
comma
id|snd_id
comma
id|THIS_MODULE
comma
r_sizeof
(paren
id|opti9xx_t
)paren
)paren
)paren
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|card-&gt;private_free
op_assign
id|snd_card_opti9xx_free
suffix:semicolon
id|chip
op_assign
(paren
id|opti9xx_t
op_star
)paren
id|card-&gt;private_data
suffix:semicolon
macro_line|#ifdef __ISAPNP__
r_if
c_cond
(paren
id|snd_isapnp
op_logical_and
(paren
id|hw
op_assign
id|snd_card_opti9xx_isapnp
c_func
(paren
id|chip
)paren
)paren
OG
l_int|0
)paren
(brace
r_switch
c_cond
(paren
id|hw
)paren
(brace
r_case
id|ISAPNP_DEVICE
c_func
(paren
l_int|0x0924
)paren
suffix:colon
id|hw
op_assign
id|OPTi9XX_HW_82C924
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ISAPNP_DEVICE
c_func
(paren
l_int|0x0925
)paren
suffix:colon
id|hw
op_assign
id|OPTi9XX_HW_82C925
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ISAPNP_DEVICE
c_func
(paren
l_int|0x0931
)paren
suffix:colon
id|hw
op_assign
id|OPTi9XX_HW_82C931
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|snd_card_free
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
op_minus
id|ENODEV
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|error
op_assign
id|snd_opti9xx_init
c_func
(paren
id|chip
comma
id|hw
)paren
)paren
)paren
(brace
id|snd_card_free
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|error
suffix:semicolon
)brace
r_if
c_cond
(paren
id|hw
op_le
id|OPTi9XX_HW_82C930
)paren
id|chip-&gt;mc_base
op_sub_assign
l_int|0x80
suffix:semicolon
)brace
r_else
(brace
macro_line|#endif&t;/* __ISAPNP__ */
r_if
c_cond
(paren
(paren
id|error
op_assign
id|snd_card_opti9xx_detect
c_func
(paren
id|card
comma
id|chip
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_card_free
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|error
suffix:semicolon
)brace
macro_line|#ifdef __ISAPNP__
)brace
macro_line|#endif&t;/* __ISAPNP__ */
r_if
c_cond
(paren
(paren
id|chip-&gt;res_mc_base
op_assign
id|request_region
c_func
(paren
id|chip-&gt;mc_base
comma
id|chip-&gt;mc_base_size
comma
l_string|&quot;OPTi9xx MC&quot;
)paren
)paren
op_eq
l_int|NULL
)paren
(brace
id|snd_card_free
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|chip-&gt;wss_base
op_assign
id|snd_port
suffix:semicolon
id|chip-&gt;fm_port
op_assign
id|snd_fm_port
suffix:semicolon
id|chip-&gt;mpu_port
op_assign
id|snd_mpu_port
suffix:semicolon
id|chip-&gt;irq
op_assign
id|snd_irq
suffix:semicolon
id|chip-&gt;mpu_irq
op_assign
id|snd_mpu_irq
suffix:semicolon
id|chip-&gt;dma1
op_assign
id|snd_dma1
suffix:semicolon
macro_line|#if defined(CS4231) || defined(OPTi93X)
id|chip-&gt;dma2
op_assign
id|snd_dma2
suffix:semicolon
macro_line|#endif
macro_line|#ifdef __ISAPNP__
r_if
c_cond
(paren
op_logical_neg
id|snd_isapnp
)paren
(brace
macro_line|#endif
r_if
c_cond
(paren
id|chip-&gt;wss_base
op_eq
id|SNDRV_AUTO_PORT
)paren
(brace
r_if
c_cond
(paren
(paren
id|chip-&gt;wss_base
op_assign
id|snd_legacy_find_free_ioport
c_func
(paren
id|possible_ports
comma
l_int|4
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_card_free
c_func
(paren
id|card
)paren
suffix:semicolon
id|snd_printk
c_func
(paren
l_string|&quot;unable to find a free WSS port&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|chip-&gt;mpu_port
op_eq
id|SNDRV_AUTO_PORT
)paren
(brace
r_if
c_cond
(paren
(paren
id|chip-&gt;mpu_port
op_assign
id|snd_legacy_find_free_ioport
c_func
(paren
id|possible_mpu_ports
comma
l_int|2
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_card_free
c_func
(paren
id|card
)paren
suffix:semicolon
id|snd_printk
c_func
(paren
l_string|&quot;unable to find a free MPU401 port&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|chip-&gt;irq
op_eq
id|SNDRV_AUTO_IRQ
)paren
(brace
r_if
c_cond
(paren
(paren
id|chip-&gt;irq
op_assign
id|snd_legacy_find_free_irq
c_func
(paren
id|possible_irqs
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_card_free
c_func
(paren
id|card
)paren
suffix:semicolon
id|snd_printk
c_func
(paren
l_string|&quot;unable to find a free IRQ&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|chip-&gt;mpu_irq
op_eq
id|SNDRV_AUTO_IRQ
)paren
(brace
r_if
c_cond
(paren
(paren
id|chip-&gt;mpu_irq
op_assign
id|snd_legacy_find_free_irq
c_func
(paren
id|possible_mpu_irqs
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_card_free
c_func
(paren
id|card
)paren
suffix:semicolon
id|snd_printk
c_func
(paren
l_string|&quot;unable to find a free MPU401 IRQ&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|chip-&gt;dma1
op_eq
id|SNDRV_AUTO_DMA
)paren
(brace
r_if
c_cond
(paren
(paren
id|chip-&gt;dma1
op_assign
id|snd_legacy_find_free_dma
c_func
(paren
id|possible_dma1s
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_card_free
c_func
(paren
id|card
)paren
suffix:semicolon
id|snd_printk
c_func
(paren
l_string|&quot;unable to find a free DMA1&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
)brace
macro_line|#if defined(CS4231) || defined(OPTi93X)
r_if
c_cond
(paren
id|chip-&gt;dma2
op_eq
id|SNDRV_AUTO_DMA
)paren
(brace
r_if
c_cond
(paren
(paren
id|chip-&gt;dma2
op_assign
id|snd_legacy_find_free_dma
c_func
(paren
id|possible_dma2s
(braket
id|chip-&gt;dma1
op_mod
l_int|4
)braket
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_card_free
c_func
(paren
id|card
)paren
suffix:semicolon
id|snd_printk
c_func
(paren
l_string|&quot;unable to find a free DMA2&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
)brace
macro_line|#endif
macro_line|#ifdef __ISAPNP__
)brace
macro_line|#endif
r_if
c_cond
(paren
(paren
id|error
op_assign
id|snd_opti9xx_configure
c_func
(paren
id|chip
)paren
)paren
)paren
(brace
id|snd_card_free
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|error
suffix:semicolon
)brace
macro_line|#if defined(OPTi93X)
r_if
c_cond
(paren
(paren
id|error
op_assign
id|snd_opti93x_create
c_func
(paren
id|card
comma
id|chip
comma
id|chip-&gt;dma1
comma
id|chip-&gt;dma2
comma
op_amp
id|codec
)paren
)paren
)paren
(brace
id|snd_card_free
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|error
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|error
op_assign
id|snd_opti93x_pcm
c_func
(paren
id|codec
comma
l_int|0
comma
op_amp
id|pcm
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_card_free
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|error
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|error
op_assign
id|snd_opti93x_mixer
c_func
(paren
id|codec
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_card_free
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|error
suffix:semicolon
)brace
macro_line|#elif defined(CS4231)
r_if
c_cond
(paren
(paren
id|error
op_assign
id|snd_cs4231_create
c_func
(paren
id|card
comma
id|chip-&gt;wss_base
op_plus
l_int|4
comma
op_minus
l_int|1
comma
id|chip-&gt;irq
comma
id|chip-&gt;dma1
comma
id|chip-&gt;dma2
comma
id|CS4231_HW_DETECT
comma
l_int|0
comma
op_amp
id|codec
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_card_free
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|error
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|error
op_assign
id|snd_cs4231_pcm
c_func
(paren
id|codec
comma
l_int|0
comma
op_amp
id|pcm
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_card_free
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|error
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|error
op_assign
id|snd_cs4231_mixer
c_func
(paren
id|codec
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_card_free
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|error
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|error
op_assign
id|snd_cs4231_timer
c_func
(paren
id|codec
comma
l_int|0
comma
op_amp
id|timer
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_card_free
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|error
suffix:semicolon
)brace
macro_line|#else
r_if
c_cond
(paren
(paren
id|error
op_assign
id|snd_ad1848_create
c_func
(paren
id|card
comma
id|chip-&gt;wss_base
op_plus
l_int|4
comma
id|chip-&gt;irq
comma
id|chip-&gt;dma1
comma
id|AD1848_HW_DETECT
comma
op_amp
id|codec
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_card_free
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|error
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|error
op_assign
id|snd_ad1848_pcm
c_func
(paren
id|codec
comma
l_int|0
comma
op_amp
id|pcm
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_card_free
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|error
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|error
op_assign
id|snd_ad1848_mixer
c_func
(paren
id|codec
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_card_free
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|error
suffix:semicolon
)brace
macro_line|#endif
r_if
c_cond
(paren
id|chip-&gt;mpu_port
op_le
l_int|0
)paren
id|rmidi
op_assign
l_int|NULL
suffix:semicolon
r_else
r_if
c_cond
(paren
(paren
id|error
op_assign
id|snd_mpu401_uart_new
c_func
(paren
id|card
comma
l_int|0
comma
id|MPU401_HW_MPU401
comma
id|chip-&gt;mpu_port
comma
l_int|0
comma
id|chip-&gt;mpu_irq
comma
id|SA_INTERRUPT
comma
op_amp
id|rmidi
)paren
)paren
)paren
id|snd_printk
c_func
(paren
l_string|&quot;no MPU-401 device at 0x%lx?&bslash;n&quot;
comma
id|chip-&gt;mpu_port
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;fm_port
OG
l_int|0
)paren
(brace
id|opl3_t
op_star
id|opl3
suffix:semicolon
r_if
c_cond
(paren
id|snd_opl3_create
c_func
(paren
id|card
comma
id|chip-&gt;fm_port
comma
id|chip-&gt;fm_port
op_plus
l_int|2
comma
id|OPL3_HW_AUTO
comma
l_int|0
comma
op_amp
id|opl3
)paren
OL
l_int|0
)paren
(brace
id|snd_printk
c_func
(paren
l_string|&quot;no OPL device at 0x%lx-0x%lx&bslash;n&quot;
comma
id|chip-&gt;fm_port
comma
id|chip-&gt;fm_port
op_plus
l_int|4
op_minus
l_int|1
)paren
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
(paren
id|error
op_assign
id|snd_opl3_timer_new
c_func
(paren
id|opl3
comma
macro_line|#ifdef CS4231
l_int|1
comma
l_int|2
)paren
)paren
OL
l_int|0
)paren
(brace
macro_line|#else
l_int|0
comma
l_int|1
)paren
)paren
OL
l_int|0
)paren
(brace
macro_line|#endif&t;/* CS4231 */
id|snd_card_free
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|error
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|error
op_assign
id|snd_opl3_hwdep_new
c_func
(paren
id|opl3
comma
l_int|0
comma
l_int|1
comma
op_amp
id|synth
)paren
)paren
OL
l_int|0
)paren
(brace
id|snd_card_free
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|error
suffix:semicolon
)brace
)brace
)brace
id|strcpy
c_func
(paren
id|card-&gt;driver
comma
id|chip-&gt;name
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|card-&gt;shortname
comma
l_string|&quot;OPTi %s&quot;
comma
id|card-&gt;driver
)paren
suffix:semicolon
macro_line|#if defined(CS4231) || defined(OPTi93X)
id|sprintf
c_func
(paren
id|card-&gt;longname
comma
l_string|&quot;%s soundcard, %s at 0x%lx, irq %d, dma %d&amp;%d&quot;
comma
id|card-&gt;shortname
comma
id|pcm-&gt;name
comma
id|chip-&gt;wss_base
op_plus
l_int|4
comma
id|chip-&gt;irq
comma
id|chip-&gt;dma1
comma
id|chip-&gt;dma2
)paren
suffix:semicolon
macro_line|#else
id|sprintf
c_func
(paren
id|card-&gt;longname
comma
l_string|&quot;%s soundcard, %s at 0x%lx, irq %d, dma %d&quot;
comma
id|card-&gt;shortname
comma
id|pcm-&gt;name
comma
id|chip-&gt;wss_base
op_plus
l_int|4
comma
id|chip-&gt;irq
comma
id|chip-&gt;dma1
)paren
suffix:semicolon
macro_line|#endif&t;/* CS4231 || OPTi93X */
r_if
c_cond
(paren
(paren
id|error
op_assign
id|snd_card_register
c_func
(paren
id|card
)paren
)paren
)paren
(brace
id|snd_card_free
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|error
suffix:semicolon
)brace
id|snd_opti9xx_card
op_assign
id|card
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|alsa_card_opti9xx_init
r_static
r_int
id|__init
id|alsa_card_opti9xx_init
c_func
(paren
r_void
)paren
(brace
r_int
id|error
suffix:semicolon
r_if
c_cond
(paren
(paren
id|error
op_assign
id|snd_card_opti9xx_probe
c_func
(paren
)paren
)paren
)paren
(brace
macro_line|#ifdef MODULE
macro_line|#ifdef OPTi93X
id|snd_printk
c_func
(paren
l_string|&quot;no OPTi 82C93x soundcard found&bslash;n&quot;
)paren
suffix:semicolon
macro_line|#else
id|snd_printk
c_func
(paren
l_string|&quot;no OPTi 82C92x soundcard found&bslash;n&quot;
)paren
suffix:semicolon
macro_line|#endif&t;/* OPTi93X */
macro_line|#endif
r_return
id|error
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|alsa_card_opti9xx_exit
r_static
r_void
id|__exit
id|alsa_card_opti9xx_exit
c_func
(paren
r_void
)paren
(brace
r_if
c_cond
(paren
id|snd_opti9xx_card
)paren
id|snd_card_free
c_func
(paren
id|snd_opti9xx_card
)paren
suffix:semicolon
)brace
id|module_init
c_func
(paren
id|alsa_card_opti9xx_init
)paren
id|module_exit
c_func
(paren
id|alsa_card_opti9xx_exit
)paren
macro_line|#ifndef MODULE
multiline_comment|/* format is: snd-opti9xx=snd_enable,snd_index,snd_id,snd_isapnp,&n;&t;&t;&t;  snd_port,snd_mpu_port,snd_fm_port,&n;&t;&t;&t;  snd_irq,snd_mpu_irq,&n;&t;&t;&t;  snd_dma1,[snd_dma2] */
DECL|function|alsa_card_opti9xx_setup
r_static
r_int
id|__init
id|alsa_card_opti9xx_setup
c_func
(paren
r_char
op_star
id|str
)paren
(brace
r_int
id|__attribute__
(paren
(paren
id|__unused__
)paren
)paren
id|enable
op_assign
l_int|1
suffix:semicolon
r_int
id|__attribute__
(paren
(paren
id|__unused__
)paren
)paren
id|pnp
op_assign
id|INT_MAX
suffix:semicolon
(paren
r_void
)paren
(paren
id|get_option
c_func
(paren
op_amp
id|str
comma
op_amp
id|enable
)paren
op_eq
l_int|2
op_logical_and
id|get_option
c_func
(paren
op_amp
id|str
comma
op_amp
id|snd_index
)paren
op_eq
l_int|2
op_logical_and
id|get_id
c_func
(paren
op_amp
id|str
comma
op_amp
id|snd_id
)paren
op_eq
l_int|2
op_logical_and
id|get_option
c_func
(paren
op_amp
id|str
comma
op_amp
id|pnp
)paren
op_eq
l_int|2
op_logical_and
id|get_option
c_func
(paren
op_amp
id|str
comma
(paren
r_int
op_star
)paren
op_amp
id|snd_port
)paren
op_eq
l_int|2
op_logical_and
id|get_option
c_func
(paren
op_amp
id|str
comma
(paren
r_int
op_star
)paren
op_amp
id|snd_mpu_port
)paren
op_eq
l_int|2
op_logical_and
id|get_option
c_func
(paren
op_amp
id|str
comma
(paren
r_int
op_star
)paren
op_amp
id|snd_fm_port
)paren
op_eq
l_int|2
op_logical_and
id|get_option
c_func
(paren
op_amp
id|str
comma
op_amp
id|snd_irq
)paren
op_eq
l_int|2
op_logical_and
id|get_option
c_func
(paren
op_amp
id|str
comma
op_amp
id|snd_mpu_irq
)paren
op_eq
l_int|2
op_logical_and
id|get_option
c_func
(paren
op_amp
id|str
comma
op_amp
id|snd_dma1
)paren
op_eq
l_int|2
macro_line|#if defined(CS4231) || defined(OPTi93X)
op_logical_and
id|get_option
c_func
(paren
op_amp
id|str
comma
op_amp
id|snd_dma2
)paren
op_eq
l_int|2
macro_line|#endif
)paren
suffix:semicolon
macro_line|#ifdef __ISAPNP__
r_if
c_cond
(paren
id|pnp
op_ne
id|INT_MAX
)paren
id|snd_isapnp
op_assign
id|pnp
suffix:semicolon
macro_line|#endif
r_return
l_int|1
suffix:semicolon
)brace
macro_line|#if defined(OPTi93X)
id|__setup
c_func
(paren
l_string|&quot;snd-opti93x=&quot;
comma
id|alsa_card_opti9xx_setup
)paren
suffix:semicolon
macro_line|#elif defined(CS4231)
id|__setup
c_func
(paren
l_string|&quot;snd-opti92x-cs4231=&quot;
comma
id|alsa_card_opti9xx_setup
)paren
suffix:semicolon
macro_line|#else
id|__setup
c_func
(paren
l_string|&quot;snd-opti92x-ad1848=&quot;
comma
id|alsa_card_opti9xx_setup
)paren
suffix:semicolon
macro_line|#endif
macro_line|#endif /* ifndef MODULE */
eof
