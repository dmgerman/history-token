multiline_comment|/*&n; * SHA transform algorithm, originally taken from code written by&n; * Peter Gutmann, and placed in the public domain.&n; */
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/cryptohash.h&gt;
multiline_comment|/* The SHA f()-functions.  */
DECL|macro|f1
mdefine_line|#define f1(x,y,z)   (z ^ (x &amp; (y ^ z)))&t;&t;/* x ? y : z */
DECL|macro|f2
mdefine_line|#define f2(x,y,z)   (x ^ y ^ z)&t;&t;&t;/* XOR */
DECL|macro|f3
mdefine_line|#define f3(x,y,z)   ((x &amp; y) + (z &amp; (x ^ y)))&t;/* majority */
multiline_comment|/* The SHA Mysterious Constants */
DECL|macro|K1
mdefine_line|#define K1  0x5A827999L&t;&t;&t;/* Rounds  0-19: sqrt(2) * 2^30 */
DECL|macro|K2
mdefine_line|#define K2  0x6ED9EBA1L&t;&t;&t;/* Rounds 20-39: sqrt(3) * 2^30 */
DECL|macro|K3
mdefine_line|#define K3  0x8F1BBCDCL&t;&t;&t;/* Rounds 40-59: sqrt(5) * 2^30 */
DECL|macro|K4
mdefine_line|#define K4  0xCA62C1D6L&t;&t;&t;/* Rounds 60-79: sqrt(10) * 2^30 */
multiline_comment|/*&n; * sha_transform: single block SHA1 transform&n; *&n; * @digest: 160 bit digest to update&n; * @data:   512 bits of data to hash&n; * @W:      80 words of workspace (see note)&n; *&n; * This function generates a SHA1 digest for a single 512-bit block.&n; * Be warned, it does not handle padding and message digest, do not&n; * confuse it with the full FIPS 180-1 digest algorithm for variable&n; * length messages.&n; *&n; * Note: If the hash is security sensitive, the caller should be sure&n; * to clear the workspace. This is left to the caller to avoid&n; * unnecessary clears between chained hashing operations.&n; */
DECL|function|sha_transform
r_void
id|sha_transform
c_func
(paren
id|__u32
op_star
id|digest
comma
r_const
r_char
op_star
id|in
comma
id|__u32
op_star
id|W
)paren
(brace
id|__u32
id|a
comma
id|b
comma
id|c
comma
id|d
comma
id|e
comma
id|t
comma
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|16
suffix:semicolon
id|i
op_increment
)paren
id|W
(braket
id|i
)braket
op_assign
id|be32_to_cpu
c_func
(paren
(paren
(paren
r_const
id|__u32
op_star
)paren
id|in
)paren
(braket
id|i
)braket
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|64
suffix:semicolon
id|i
op_increment
)paren
id|W
(braket
id|i
op_plus
l_int|16
)braket
op_assign
id|rol32
c_func
(paren
id|W
(braket
id|i
op_plus
l_int|13
)braket
op_xor
id|W
(braket
id|i
op_plus
l_int|8
)braket
op_xor
id|W
(braket
id|i
op_plus
l_int|2
)braket
op_xor
id|W
(braket
id|i
)braket
comma
l_int|1
)paren
suffix:semicolon
id|a
op_assign
id|digest
(braket
l_int|0
)braket
suffix:semicolon
id|b
op_assign
id|digest
(braket
l_int|1
)braket
suffix:semicolon
id|c
op_assign
id|digest
(braket
l_int|2
)braket
suffix:semicolon
id|d
op_assign
id|digest
(braket
l_int|3
)braket
suffix:semicolon
id|e
op_assign
id|digest
(braket
l_int|4
)braket
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|20
suffix:semicolon
id|i
op_increment
)paren
(brace
id|t
op_assign
id|f1
c_func
(paren
id|b
comma
id|c
comma
id|d
)paren
op_plus
id|K1
op_plus
id|rol32
c_func
(paren
id|a
comma
l_int|5
)paren
op_plus
id|e
op_plus
id|W
(braket
id|i
)braket
suffix:semicolon
id|e
op_assign
id|d
suffix:semicolon
id|d
op_assign
id|c
suffix:semicolon
id|c
op_assign
id|rol32
c_func
(paren
id|b
comma
l_int|30
)paren
suffix:semicolon
id|b
op_assign
id|a
suffix:semicolon
id|a
op_assign
id|t
suffix:semicolon
)brace
r_for
c_loop
(paren
suffix:semicolon
id|i
OL
l_int|40
suffix:semicolon
id|i
op_increment
)paren
(brace
id|t
op_assign
id|f2
c_func
(paren
id|b
comma
id|c
comma
id|d
)paren
op_plus
id|K2
op_plus
id|rol32
c_func
(paren
id|a
comma
l_int|5
)paren
op_plus
id|e
op_plus
id|W
(braket
id|i
)braket
suffix:semicolon
id|e
op_assign
id|d
suffix:semicolon
id|d
op_assign
id|c
suffix:semicolon
id|c
op_assign
id|rol32
c_func
(paren
id|b
comma
l_int|30
)paren
suffix:semicolon
id|b
op_assign
id|a
suffix:semicolon
id|a
op_assign
id|t
suffix:semicolon
)brace
r_for
c_loop
(paren
suffix:semicolon
id|i
OL
l_int|60
suffix:semicolon
id|i
op_increment
)paren
(brace
id|t
op_assign
id|f3
c_func
(paren
id|b
comma
id|c
comma
id|d
)paren
op_plus
id|K3
op_plus
id|rol32
c_func
(paren
id|a
comma
l_int|5
)paren
op_plus
id|e
op_plus
id|W
(braket
id|i
)braket
suffix:semicolon
id|e
op_assign
id|d
suffix:semicolon
id|d
op_assign
id|c
suffix:semicolon
id|c
op_assign
id|rol32
c_func
(paren
id|b
comma
l_int|30
)paren
suffix:semicolon
id|b
op_assign
id|a
suffix:semicolon
id|a
op_assign
id|t
suffix:semicolon
)brace
r_for
c_loop
(paren
suffix:semicolon
id|i
OL
l_int|80
suffix:semicolon
id|i
op_increment
)paren
(brace
id|t
op_assign
id|f2
c_func
(paren
id|b
comma
id|c
comma
id|d
)paren
op_plus
id|K4
op_plus
id|rol32
c_func
(paren
id|a
comma
l_int|5
)paren
op_plus
id|e
op_plus
id|W
(braket
id|i
)braket
suffix:semicolon
id|e
op_assign
id|d
suffix:semicolon
id|d
op_assign
id|c
suffix:semicolon
id|c
op_assign
id|rol32
c_func
(paren
id|b
comma
l_int|30
)paren
suffix:semicolon
id|b
op_assign
id|a
suffix:semicolon
id|a
op_assign
id|t
suffix:semicolon
)brace
id|digest
(braket
l_int|0
)braket
op_add_assign
id|a
suffix:semicolon
id|digest
(braket
l_int|1
)braket
op_add_assign
id|b
suffix:semicolon
id|digest
(braket
l_int|2
)braket
op_add_assign
id|c
suffix:semicolon
id|digest
(braket
l_int|3
)braket
op_add_assign
id|d
suffix:semicolon
id|digest
(braket
l_int|4
)braket
op_add_assign
id|e
suffix:semicolon
)brace
DECL|variable|sha_transform
id|EXPORT_SYMBOL
c_func
(paren
id|sha_transform
)paren
suffix:semicolon
multiline_comment|/*&n; * sha_init: initialize the vectors for a SHA1 digest&n; *&n; * @buf: vector to initialize&n; */
DECL|function|sha_init
r_void
id|sha_init
c_func
(paren
id|__u32
op_star
id|buf
)paren
(brace
id|buf
(braket
l_int|0
)braket
op_assign
l_int|0x67452301
suffix:semicolon
id|buf
(braket
l_int|1
)braket
op_assign
l_int|0xefcdab89
suffix:semicolon
id|buf
(braket
l_int|2
)braket
op_assign
l_int|0x98badcfe
suffix:semicolon
id|buf
(braket
l_int|3
)braket
op_assign
l_int|0x10325476
suffix:semicolon
id|buf
(braket
l_int|4
)braket
op_assign
l_int|0xc3d2e1f0
suffix:semicolon
)brace
eof
