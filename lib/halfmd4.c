macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/cryptohash.h&gt;
multiline_comment|/* F, G and H are basic MD4 functions: selection, majority, parity */
DECL|macro|F
mdefine_line|#define F(x, y, z) ((z) ^ ((x) &amp; ((y) ^ (z))))
DECL|macro|G
mdefine_line|#define G(x, y, z) (((x) &amp; (y)) + (((x) ^ (y)) &amp; (z)))
DECL|macro|H
mdefine_line|#define H(x, y, z) ((x) ^ (y) ^ (z))
multiline_comment|/*&n; * The generic round function.  The application is so specific that&n; * we don&squot;t bother protecting all the arguments with parens, as is generally&n; * good macro practice, in favor of extra legibility.&n; * Rotation is separate from addition to prevent recomputation&n; */
DECL|macro|ROUND
mdefine_line|#define ROUND(f, a, b, c, d, x, s)&t;&bslash;&n;&t;(a += f(b, c, d) + x, a = (a &lt;&lt; s) | (a &gt;&gt; (32 - s)))
DECL|macro|K1
mdefine_line|#define K1 0
DECL|macro|K2
mdefine_line|#define K2 013240474631UL
DECL|macro|K3
mdefine_line|#define K3 015666365641UL
multiline_comment|/*&n; * Basic cut-down MD4 transform.  Returns only 32 bits of result.&n; */
DECL|function|half_md4_transform
id|__u32
id|half_md4_transform
c_func
(paren
id|__u32
id|buf
(braket
l_int|4
)braket
comma
id|__u32
r_const
id|in
(braket
l_int|8
)braket
)paren
(brace
id|__u32
id|a
op_assign
id|buf
(braket
l_int|0
)braket
comma
id|b
op_assign
id|buf
(braket
l_int|1
)braket
comma
id|c
op_assign
id|buf
(braket
l_int|2
)braket
comma
id|d
op_assign
id|buf
(braket
l_int|3
)braket
suffix:semicolon
multiline_comment|/* Round 1 */
id|ROUND
c_func
(paren
id|F
comma
id|a
comma
id|b
comma
id|c
comma
id|d
comma
id|in
(braket
l_int|0
)braket
op_plus
id|K1
comma
l_int|3
)paren
suffix:semicolon
id|ROUND
c_func
(paren
id|F
comma
id|d
comma
id|a
comma
id|b
comma
id|c
comma
id|in
(braket
l_int|1
)braket
op_plus
id|K1
comma
l_int|7
)paren
suffix:semicolon
id|ROUND
c_func
(paren
id|F
comma
id|c
comma
id|d
comma
id|a
comma
id|b
comma
id|in
(braket
l_int|2
)braket
op_plus
id|K1
comma
l_int|11
)paren
suffix:semicolon
id|ROUND
c_func
(paren
id|F
comma
id|b
comma
id|c
comma
id|d
comma
id|a
comma
id|in
(braket
l_int|3
)braket
op_plus
id|K1
comma
l_int|19
)paren
suffix:semicolon
id|ROUND
c_func
(paren
id|F
comma
id|a
comma
id|b
comma
id|c
comma
id|d
comma
id|in
(braket
l_int|4
)braket
op_plus
id|K1
comma
l_int|3
)paren
suffix:semicolon
id|ROUND
c_func
(paren
id|F
comma
id|d
comma
id|a
comma
id|b
comma
id|c
comma
id|in
(braket
l_int|5
)braket
op_plus
id|K1
comma
l_int|7
)paren
suffix:semicolon
id|ROUND
c_func
(paren
id|F
comma
id|c
comma
id|d
comma
id|a
comma
id|b
comma
id|in
(braket
l_int|6
)braket
op_plus
id|K1
comma
l_int|11
)paren
suffix:semicolon
id|ROUND
c_func
(paren
id|F
comma
id|b
comma
id|c
comma
id|d
comma
id|a
comma
id|in
(braket
l_int|7
)braket
op_plus
id|K1
comma
l_int|19
)paren
suffix:semicolon
multiline_comment|/* Round 2 */
id|ROUND
c_func
(paren
id|G
comma
id|a
comma
id|b
comma
id|c
comma
id|d
comma
id|in
(braket
l_int|1
)braket
op_plus
id|K2
comma
l_int|3
)paren
suffix:semicolon
id|ROUND
c_func
(paren
id|G
comma
id|d
comma
id|a
comma
id|b
comma
id|c
comma
id|in
(braket
l_int|3
)braket
op_plus
id|K2
comma
l_int|5
)paren
suffix:semicolon
id|ROUND
c_func
(paren
id|G
comma
id|c
comma
id|d
comma
id|a
comma
id|b
comma
id|in
(braket
l_int|5
)braket
op_plus
id|K2
comma
l_int|9
)paren
suffix:semicolon
id|ROUND
c_func
(paren
id|G
comma
id|b
comma
id|c
comma
id|d
comma
id|a
comma
id|in
(braket
l_int|7
)braket
op_plus
id|K2
comma
l_int|13
)paren
suffix:semicolon
id|ROUND
c_func
(paren
id|G
comma
id|a
comma
id|b
comma
id|c
comma
id|d
comma
id|in
(braket
l_int|0
)braket
op_plus
id|K2
comma
l_int|3
)paren
suffix:semicolon
id|ROUND
c_func
(paren
id|G
comma
id|d
comma
id|a
comma
id|b
comma
id|c
comma
id|in
(braket
l_int|2
)braket
op_plus
id|K2
comma
l_int|5
)paren
suffix:semicolon
id|ROUND
c_func
(paren
id|G
comma
id|c
comma
id|d
comma
id|a
comma
id|b
comma
id|in
(braket
l_int|4
)braket
op_plus
id|K2
comma
l_int|9
)paren
suffix:semicolon
id|ROUND
c_func
(paren
id|G
comma
id|b
comma
id|c
comma
id|d
comma
id|a
comma
id|in
(braket
l_int|6
)braket
op_plus
id|K2
comma
l_int|13
)paren
suffix:semicolon
multiline_comment|/* Round 3 */
id|ROUND
c_func
(paren
id|H
comma
id|a
comma
id|b
comma
id|c
comma
id|d
comma
id|in
(braket
l_int|3
)braket
op_plus
id|K3
comma
l_int|3
)paren
suffix:semicolon
id|ROUND
c_func
(paren
id|H
comma
id|d
comma
id|a
comma
id|b
comma
id|c
comma
id|in
(braket
l_int|7
)braket
op_plus
id|K3
comma
l_int|9
)paren
suffix:semicolon
id|ROUND
c_func
(paren
id|H
comma
id|c
comma
id|d
comma
id|a
comma
id|b
comma
id|in
(braket
l_int|2
)braket
op_plus
id|K3
comma
l_int|11
)paren
suffix:semicolon
id|ROUND
c_func
(paren
id|H
comma
id|b
comma
id|c
comma
id|d
comma
id|a
comma
id|in
(braket
l_int|6
)braket
op_plus
id|K3
comma
l_int|15
)paren
suffix:semicolon
id|ROUND
c_func
(paren
id|H
comma
id|a
comma
id|b
comma
id|c
comma
id|d
comma
id|in
(braket
l_int|1
)braket
op_plus
id|K3
comma
l_int|3
)paren
suffix:semicolon
id|ROUND
c_func
(paren
id|H
comma
id|d
comma
id|a
comma
id|b
comma
id|c
comma
id|in
(braket
l_int|5
)braket
op_plus
id|K3
comma
l_int|9
)paren
suffix:semicolon
id|ROUND
c_func
(paren
id|H
comma
id|c
comma
id|d
comma
id|a
comma
id|b
comma
id|in
(braket
l_int|0
)braket
op_plus
id|K3
comma
l_int|11
)paren
suffix:semicolon
id|ROUND
c_func
(paren
id|H
comma
id|b
comma
id|c
comma
id|d
comma
id|a
comma
id|in
(braket
l_int|4
)braket
op_plus
id|K3
comma
l_int|15
)paren
suffix:semicolon
id|buf
(braket
l_int|0
)braket
op_add_assign
id|a
suffix:semicolon
id|buf
(braket
l_int|1
)braket
op_add_assign
id|b
suffix:semicolon
id|buf
(braket
l_int|2
)braket
op_add_assign
id|c
suffix:semicolon
id|buf
(braket
l_int|3
)braket
op_add_assign
id|d
suffix:semicolon
r_return
id|buf
(braket
l_int|1
)braket
suffix:semicolon
multiline_comment|/* &quot;most hashed&quot; word */
)brace
DECL|variable|half_md4_transform
id|EXPORT_SYMBOL
c_func
(paren
id|half_md4_transform
)paren
suffix:semicolon
eof
