multiline_comment|/* compat.c: 32-bit compatibility syscall for 64-bit systems&n; *&n; * Copyright (C) 2004 Red Hat, Inc. All Rights Reserved.&n; * Written by David Howells (dhowells@redhat.com)&n; *&n; * This program is free software; you can redistribute it and/or&n; * modify it under the terms of the GNU General Public License&n; * as published by the Free Software Foundation; either version&n; * 2 of the License, or (at your option) any later version.&n; */
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/syscalls.h&gt;
macro_line|#include &lt;linux/keyctl.h&gt;
macro_line|#include &lt;linux/compat.h&gt;
macro_line|#include &quot;internal.h&quot;
multiline_comment|/*****************************************************************************/
multiline_comment|/*&n; * the key control system call, 32-bit compatibility version for 64-bit archs&n; * - this should only be called if the 64-bit arch uses weird pointers in&n; *   32-bit mode or doesn&squot;t guarantee that the top 32-bits of the argument&n; *   registers on taking a 32-bit syscall are zero&n; * - if you can, you should call sys_keyctl directly&n; */
DECL|function|compat_sys_keyctl
id|asmlinkage
r_int
id|compat_sys_keyctl
c_func
(paren
id|u32
id|option
comma
id|u32
id|arg2
comma
id|u32
id|arg3
comma
id|u32
id|arg4
comma
id|u32
id|arg5
)paren
(brace
r_switch
c_cond
(paren
id|option
)paren
(brace
r_case
id|KEYCTL_GET_KEYRING_ID
suffix:colon
r_return
id|keyctl_get_keyring_ID
c_func
(paren
id|arg2
comma
id|arg3
)paren
suffix:semicolon
r_case
id|KEYCTL_JOIN_SESSION_KEYRING
suffix:colon
r_return
id|keyctl_join_session_keyring
c_func
(paren
id|compat_ptr
c_func
(paren
id|arg3
)paren
)paren
suffix:semicolon
r_case
id|KEYCTL_UPDATE
suffix:colon
r_return
id|keyctl_update_key
c_func
(paren
id|arg2
comma
id|compat_ptr
c_func
(paren
id|arg3
)paren
comma
id|arg4
)paren
suffix:semicolon
r_case
id|KEYCTL_REVOKE
suffix:colon
r_return
id|keyctl_revoke_key
c_func
(paren
id|arg2
)paren
suffix:semicolon
r_case
id|KEYCTL_DESCRIBE
suffix:colon
r_return
id|keyctl_describe_key
c_func
(paren
id|arg2
comma
id|compat_ptr
c_func
(paren
id|arg3
)paren
comma
id|arg4
)paren
suffix:semicolon
r_case
id|KEYCTL_CLEAR
suffix:colon
r_return
id|keyctl_keyring_clear
c_func
(paren
id|arg2
)paren
suffix:semicolon
r_case
id|KEYCTL_LINK
suffix:colon
r_return
id|keyctl_keyring_link
c_func
(paren
id|arg2
comma
id|arg3
)paren
suffix:semicolon
r_case
id|KEYCTL_UNLINK
suffix:colon
r_return
id|keyctl_keyring_unlink
c_func
(paren
id|arg2
comma
id|arg3
)paren
suffix:semicolon
r_case
id|KEYCTL_SEARCH
suffix:colon
r_return
id|keyctl_keyring_search
c_func
(paren
id|arg2
comma
id|compat_ptr
c_func
(paren
id|arg3
)paren
comma
id|compat_ptr
c_func
(paren
id|arg4
)paren
comma
id|arg5
)paren
suffix:semicolon
r_case
id|KEYCTL_READ
suffix:colon
r_return
id|keyctl_read_key
c_func
(paren
id|arg2
comma
id|compat_ptr
c_func
(paren
id|arg3
)paren
comma
id|arg4
)paren
suffix:semicolon
r_case
id|KEYCTL_CHOWN
suffix:colon
r_return
id|keyctl_chown_key
c_func
(paren
id|arg2
comma
id|arg3
comma
id|arg4
)paren
suffix:semicolon
r_case
id|KEYCTL_SETPERM
suffix:colon
r_return
id|keyctl_setperm_key
c_func
(paren
id|arg2
comma
id|arg3
)paren
suffix:semicolon
r_case
id|KEYCTL_INSTANTIATE
suffix:colon
r_return
id|keyctl_instantiate_key
c_func
(paren
id|arg2
comma
id|compat_ptr
c_func
(paren
id|arg3
)paren
comma
id|arg4
comma
id|arg5
)paren
suffix:semicolon
r_case
id|KEYCTL_NEGATE
suffix:colon
r_return
id|keyctl_negate_key
c_func
(paren
id|arg2
comma
id|arg3
comma
id|arg4
)paren
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
id|EOPNOTSUPP
suffix:semicolon
)brace
)brace
multiline_comment|/* end compat_sys_keyctl() */
eof
