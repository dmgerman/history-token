multiline_comment|/*&n; * Stub functions for the default security function pointers in case no&n; * security model is loaded.&n; *&n; * Copyright (C) 2001 WireX Communications, Inc &lt;chris@wirex.com&gt;&n; * Copyright (C) 2001-2002  Greg Kroah-Hartman &lt;greg@kroah.com&gt;&n; * Copyright (C) 2001 Networks Associates Technology, Inc &lt;ssmalley@nai.com&gt;&n; *&n; *&t;This program is free software; you can redistribute it and/or modify&n; *&t;it under the terms of the GNU General Public License as published by&n; *&t;the Free Software Foundation; either version 2 of the License, or&n; *&t;(at your option) any later version.&n; */
DECL|macro|DEBUG
macro_line|#undef DEBUG
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/mman.h&gt;
macro_line|#include &lt;linux/pagemap.h&gt;
macro_line|#include &lt;linux/swap.h&gt;
macro_line|#include &lt;linux/security.h&gt;
macro_line|#include &lt;linux/skbuff.h&gt;
macro_line|#include &lt;linux/netlink.h&gt;
macro_line|#include &lt;net/sock.h&gt;
macro_line|#include &lt;linux/xattr.h&gt;
macro_line|#include &lt;linux/hugetlb.h&gt;
macro_line|#include &lt;linux/ptrace.h&gt;
macro_line|#include &lt;linux/file.h&gt;
DECL|function|dummy_ptrace
r_static
r_int
id|dummy_ptrace
(paren
r_struct
id|task_struct
op_star
id|parent
comma
r_struct
id|task_struct
op_star
id|child
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_capget
r_static
r_int
id|dummy_capget
(paren
r_struct
id|task_struct
op_star
id|target
comma
id|kernel_cap_t
op_star
id|effective
comma
id|kernel_cap_t
op_star
id|inheritable
comma
id|kernel_cap_t
op_star
id|permitted
)paren
(brace
op_star
id|effective
op_assign
op_star
id|inheritable
op_assign
op_star
id|permitted
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|issecure
c_func
(paren
id|SECURE_NOROOT
)paren
)paren
(brace
r_if
c_cond
(paren
id|target-&gt;euid
op_eq
l_int|0
)paren
(brace
op_star
id|permitted
op_or_assign
(paren
op_complement
l_int|0
op_amp
op_complement
id|CAP_FS_MASK
)paren
suffix:semicolon
op_star
id|effective
op_or_assign
(paren
op_complement
l_int|0
op_amp
op_complement
id|CAP_TO_MASK
c_func
(paren
id|CAP_SETPCAP
)paren
op_amp
op_complement
id|CAP_FS_MASK
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|target-&gt;fsuid
op_eq
l_int|0
)paren
(brace
op_star
id|permitted
op_or_assign
id|CAP_FS_MASK
suffix:semicolon
op_star
id|effective
op_or_assign
id|CAP_FS_MASK
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_capset_check
r_static
r_int
id|dummy_capset_check
(paren
r_struct
id|task_struct
op_star
id|target
comma
id|kernel_cap_t
op_star
id|effective
comma
id|kernel_cap_t
op_star
id|inheritable
comma
id|kernel_cap_t
op_star
id|permitted
)paren
(brace
r_return
op_minus
id|EPERM
suffix:semicolon
)brace
DECL|function|dummy_capset_set
r_static
r_void
id|dummy_capset_set
(paren
r_struct
id|task_struct
op_star
id|target
comma
id|kernel_cap_t
op_star
id|effective
comma
id|kernel_cap_t
op_star
id|inheritable
comma
id|kernel_cap_t
op_star
id|permitted
)paren
(brace
r_return
suffix:semicolon
)brace
DECL|function|dummy_acct
r_static
r_int
id|dummy_acct
(paren
r_struct
id|file
op_star
id|file
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_capable
r_static
r_int
id|dummy_capable
(paren
r_struct
id|task_struct
op_star
id|tsk
comma
r_int
id|cap
)paren
(brace
r_if
c_cond
(paren
id|cap_raised
(paren
id|tsk-&gt;cap_effective
comma
id|cap
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_return
op_minus
id|EPERM
suffix:semicolon
)brace
DECL|function|dummy_sysctl
r_static
r_int
id|dummy_sysctl
(paren
id|ctl_table
op_star
id|table
comma
r_int
id|op
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_quotactl
r_static
r_int
id|dummy_quotactl
(paren
r_int
id|cmds
comma
r_int
id|type
comma
r_int
id|id
comma
r_struct
id|super_block
op_star
id|sb
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_quota_on
r_static
r_int
id|dummy_quota_on
(paren
r_struct
id|dentry
op_star
id|dentry
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_syslog
r_static
r_int
id|dummy_syslog
(paren
r_int
id|type
)paren
(brace
r_if
c_cond
(paren
(paren
id|type
op_ne
l_int|3
op_logical_and
id|type
op_ne
l_int|10
)paren
op_logical_and
id|current-&gt;euid
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_settime
r_static
r_int
id|dummy_settime
c_func
(paren
r_struct
id|timespec
op_star
id|ts
comma
r_struct
id|timezone
op_star
id|tz
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|capable
c_func
(paren
id|CAP_SYS_TIME
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * Check that a process has enough memory to allocate a new virtual&n; * mapping. 0 means there is enough memory for the allocation to&n; * succeed and -ENOMEM implies there is not.&n; *&n; * We currently support three overcommit policies, which are set via the&n; * vm.overcommit_memory sysctl.  See Documentation/vm/overcommit-accounting&n; */
DECL|function|dummy_vm_enough_memory
r_static
r_int
id|dummy_vm_enough_memory
c_func
(paren
r_int
id|pages
)paren
(brace
r_int
r_int
id|free
comma
id|allowed
suffix:semicolon
id|vm_acct_memory
c_func
(paren
id|pages
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * Sometimes we want to use more memory than we have&n;&t; */
r_if
c_cond
(paren
id|sysctl_overcommit_memory
op_eq
id|OVERCOMMIT_ALWAYS
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|sysctl_overcommit_memory
op_eq
id|OVERCOMMIT_GUESS
)paren
(brace
id|free
op_assign
id|get_page_cache_size
c_func
(paren
)paren
suffix:semicolon
id|free
op_add_assign
id|nr_free_pages
c_func
(paren
)paren
suffix:semicolon
id|free
op_add_assign
id|nr_swap_pages
suffix:semicolon
multiline_comment|/*&n;&t;&t; * Any slabs which are created with the&n;&t;&t; * SLAB_RECLAIM_ACCOUNT flag claim to have contents&n;&t;&t; * which are reclaimable, under pressure.  The dentry&n;&t;&t; * cache and most inode caches should fall into this&n;&t;&t; */
id|free
op_add_assign
id|atomic_read
c_func
(paren
op_amp
id|slab_reclaim_pages
)paren
suffix:semicolon
multiline_comment|/*&n;&t;&t; * Leave the last 3% for root&n;&t;&t; */
r_if
c_cond
(paren
id|current-&gt;euid
)paren
id|free
op_sub_assign
id|free
op_div
l_int|32
suffix:semicolon
r_if
c_cond
(paren
id|free
OG
id|pages
)paren
r_return
l_int|0
suffix:semicolon
id|vm_unacct_memory
c_func
(paren
id|pages
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|allowed
op_assign
(paren
id|totalram_pages
op_minus
id|hugetlb_total_pages
c_func
(paren
)paren
)paren
op_star
id|sysctl_overcommit_ratio
op_div
l_int|100
suffix:semicolon
id|allowed
op_add_assign
id|total_swap_pages
suffix:semicolon
multiline_comment|/* Leave the last 3% for root */
r_if
c_cond
(paren
id|current-&gt;euid
)paren
id|allowed
op_sub_assign
id|allowed
op_div
l_int|32
suffix:semicolon
multiline_comment|/* Don&squot;t let a single process grow too big:&n;&t;   leave 3% of the size of this process for other processes */
id|allowed
op_sub_assign
id|current-&gt;mm-&gt;total_vm
op_div
l_int|32
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|vm_committed_space
)paren
OL
id|allowed
)paren
r_return
l_int|0
suffix:semicolon
id|vm_unacct_memory
c_func
(paren
id|pages
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
DECL|function|dummy_bprm_alloc_security
r_static
r_int
id|dummy_bprm_alloc_security
(paren
r_struct
id|linux_binprm
op_star
id|bprm
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_bprm_free_security
r_static
r_void
id|dummy_bprm_free_security
(paren
r_struct
id|linux_binprm
op_star
id|bprm
)paren
(brace
r_return
suffix:semicolon
)brace
DECL|function|dummy_bprm_apply_creds
r_static
r_void
id|dummy_bprm_apply_creds
(paren
r_struct
id|linux_binprm
op_star
id|bprm
comma
r_int
id|unsafe
)paren
(brace
r_if
c_cond
(paren
id|bprm-&gt;e_uid
op_ne
id|current-&gt;uid
op_logical_or
id|bprm-&gt;e_gid
op_ne
id|current-&gt;gid
)paren
(brace
id|current-&gt;mm-&gt;dumpable
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
(paren
id|unsafe
op_amp
op_complement
id|LSM_UNSAFE_PTRACE_CAP
)paren
op_logical_and
op_logical_neg
id|capable
c_func
(paren
id|CAP_SETUID
)paren
)paren
(brace
id|bprm-&gt;e_uid
op_assign
id|current-&gt;uid
suffix:semicolon
id|bprm-&gt;e_gid
op_assign
id|current-&gt;gid
suffix:semicolon
)brace
)brace
id|current-&gt;suid
op_assign
id|current-&gt;euid
op_assign
id|current-&gt;fsuid
op_assign
id|bprm-&gt;e_uid
suffix:semicolon
id|current-&gt;sgid
op_assign
id|current-&gt;egid
op_assign
id|current-&gt;fsgid
op_assign
id|bprm-&gt;e_gid
suffix:semicolon
id|dummy_capget
c_func
(paren
id|current
comma
op_amp
id|current-&gt;cap_effective
comma
op_amp
id|current-&gt;cap_inheritable
comma
op_amp
id|current-&gt;cap_permitted
)paren
suffix:semicolon
)brace
DECL|function|dummy_bprm_set_security
r_static
r_int
id|dummy_bprm_set_security
(paren
r_struct
id|linux_binprm
op_star
id|bprm
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_bprm_check_security
r_static
r_int
id|dummy_bprm_check_security
(paren
r_struct
id|linux_binprm
op_star
id|bprm
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_bprm_secureexec
r_static
r_int
id|dummy_bprm_secureexec
(paren
r_struct
id|linux_binprm
op_star
id|bprm
)paren
(brace
multiline_comment|/* The new userland will simply use the value provided&n;&t;   in the AT_SECURE field to decide whether secure mode&n;&t;   is required.  Hence, this logic is required to preserve&n;&t;   the legacy decision algorithm used by the old userland. */
r_return
(paren
id|current-&gt;euid
op_ne
id|current-&gt;uid
op_logical_or
id|current-&gt;egid
op_ne
id|current-&gt;gid
)paren
suffix:semicolon
)brace
DECL|function|dummy_sb_alloc_security
r_static
r_int
id|dummy_sb_alloc_security
(paren
r_struct
id|super_block
op_star
id|sb
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_sb_free_security
r_static
r_void
id|dummy_sb_free_security
(paren
r_struct
id|super_block
op_star
id|sb
)paren
(brace
r_return
suffix:semicolon
)brace
DECL|function|dummy_sb_copy_data
r_static
r_int
id|dummy_sb_copy_data
(paren
r_struct
id|file_system_type
op_star
id|type
comma
r_void
op_star
id|orig
comma
r_void
op_star
id|copy
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_sb_kern_mount
r_static
r_int
id|dummy_sb_kern_mount
(paren
r_struct
id|super_block
op_star
id|sb
comma
r_void
op_star
id|data
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_sb_statfs
r_static
r_int
id|dummy_sb_statfs
(paren
r_struct
id|super_block
op_star
id|sb
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_sb_mount
r_static
r_int
id|dummy_sb_mount
(paren
r_char
op_star
id|dev_name
comma
r_struct
id|nameidata
op_star
id|nd
comma
r_char
op_star
id|type
comma
r_int
r_int
id|flags
comma
r_void
op_star
id|data
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_sb_check_sb
r_static
r_int
id|dummy_sb_check_sb
(paren
r_struct
id|vfsmount
op_star
id|mnt
comma
r_struct
id|nameidata
op_star
id|nd
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_sb_umount
r_static
r_int
id|dummy_sb_umount
(paren
r_struct
id|vfsmount
op_star
id|mnt
comma
r_int
id|flags
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_sb_umount_close
r_static
r_void
id|dummy_sb_umount_close
(paren
r_struct
id|vfsmount
op_star
id|mnt
)paren
(brace
r_return
suffix:semicolon
)brace
DECL|function|dummy_sb_umount_busy
r_static
r_void
id|dummy_sb_umount_busy
(paren
r_struct
id|vfsmount
op_star
id|mnt
)paren
(brace
r_return
suffix:semicolon
)brace
DECL|function|dummy_sb_post_remount
r_static
r_void
id|dummy_sb_post_remount
(paren
r_struct
id|vfsmount
op_star
id|mnt
comma
r_int
r_int
id|flags
comma
r_void
op_star
id|data
)paren
(brace
r_return
suffix:semicolon
)brace
DECL|function|dummy_sb_post_mountroot
r_static
r_void
id|dummy_sb_post_mountroot
(paren
r_void
)paren
(brace
r_return
suffix:semicolon
)brace
DECL|function|dummy_sb_post_addmount
r_static
r_void
id|dummy_sb_post_addmount
(paren
r_struct
id|vfsmount
op_star
id|mnt
comma
r_struct
id|nameidata
op_star
id|nd
)paren
(brace
r_return
suffix:semicolon
)brace
DECL|function|dummy_sb_pivotroot
r_static
r_int
id|dummy_sb_pivotroot
(paren
r_struct
id|nameidata
op_star
id|old_nd
comma
r_struct
id|nameidata
op_star
id|new_nd
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_sb_post_pivotroot
r_static
r_void
id|dummy_sb_post_pivotroot
(paren
r_struct
id|nameidata
op_star
id|old_nd
comma
r_struct
id|nameidata
op_star
id|new_nd
)paren
(brace
r_return
suffix:semicolon
)brace
DECL|function|dummy_inode_alloc_security
r_static
r_int
id|dummy_inode_alloc_security
(paren
r_struct
id|inode
op_star
id|inode
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_inode_free_security
r_static
r_void
id|dummy_inode_free_security
(paren
r_struct
id|inode
op_star
id|inode
)paren
(brace
r_return
suffix:semicolon
)brace
DECL|function|dummy_inode_create
r_static
r_int
id|dummy_inode_create
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|dentry
op_star
id|dentry
comma
r_int
id|mask
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_inode_post_create
r_static
r_void
id|dummy_inode_post_create
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|dentry
op_star
id|dentry
comma
r_int
id|mask
)paren
(brace
r_return
suffix:semicolon
)brace
DECL|function|dummy_inode_link
r_static
r_int
id|dummy_inode_link
(paren
r_struct
id|dentry
op_star
id|old_dentry
comma
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|dentry
op_star
id|new_dentry
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_inode_post_link
r_static
r_void
id|dummy_inode_post_link
(paren
r_struct
id|dentry
op_star
id|old_dentry
comma
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|dentry
op_star
id|new_dentry
)paren
(brace
r_return
suffix:semicolon
)brace
DECL|function|dummy_inode_unlink
r_static
r_int
id|dummy_inode_unlink
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|dentry
op_star
id|dentry
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_inode_symlink
r_static
r_int
id|dummy_inode_symlink
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|dentry
op_star
id|dentry
comma
r_const
r_char
op_star
id|name
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_inode_post_symlink
r_static
r_void
id|dummy_inode_post_symlink
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|dentry
op_star
id|dentry
comma
r_const
r_char
op_star
id|name
)paren
(brace
r_return
suffix:semicolon
)brace
DECL|function|dummy_inode_mkdir
r_static
r_int
id|dummy_inode_mkdir
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|dentry
op_star
id|dentry
comma
r_int
id|mask
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_inode_post_mkdir
r_static
r_void
id|dummy_inode_post_mkdir
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|dentry
op_star
id|dentry
comma
r_int
id|mask
)paren
(brace
r_return
suffix:semicolon
)brace
DECL|function|dummy_inode_rmdir
r_static
r_int
id|dummy_inode_rmdir
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|dentry
op_star
id|dentry
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_inode_mknod
r_static
r_int
id|dummy_inode_mknod
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|dentry
op_star
id|dentry
comma
r_int
id|mode
comma
id|dev_t
id|dev
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_inode_post_mknod
r_static
r_void
id|dummy_inode_post_mknod
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|dentry
op_star
id|dentry
comma
r_int
id|mode
comma
id|dev_t
id|dev
)paren
(brace
r_return
suffix:semicolon
)brace
DECL|function|dummy_inode_rename
r_static
r_int
id|dummy_inode_rename
(paren
r_struct
id|inode
op_star
id|old_inode
comma
r_struct
id|dentry
op_star
id|old_dentry
comma
r_struct
id|inode
op_star
id|new_inode
comma
r_struct
id|dentry
op_star
id|new_dentry
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_inode_post_rename
r_static
r_void
id|dummy_inode_post_rename
(paren
r_struct
id|inode
op_star
id|old_inode
comma
r_struct
id|dentry
op_star
id|old_dentry
comma
r_struct
id|inode
op_star
id|new_inode
comma
r_struct
id|dentry
op_star
id|new_dentry
)paren
(brace
r_return
suffix:semicolon
)brace
DECL|function|dummy_inode_readlink
r_static
r_int
id|dummy_inode_readlink
(paren
r_struct
id|dentry
op_star
id|dentry
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_inode_follow_link
r_static
r_int
id|dummy_inode_follow_link
(paren
r_struct
id|dentry
op_star
id|dentry
comma
r_struct
id|nameidata
op_star
id|nameidata
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_inode_permission
r_static
r_int
id|dummy_inode_permission
(paren
r_struct
id|inode
op_star
id|inode
comma
r_int
id|mask
comma
r_struct
id|nameidata
op_star
id|nd
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_inode_setattr
r_static
r_int
id|dummy_inode_setattr
(paren
r_struct
id|dentry
op_star
id|dentry
comma
r_struct
id|iattr
op_star
id|iattr
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_inode_getattr
r_static
r_int
id|dummy_inode_getattr
(paren
r_struct
id|vfsmount
op_star
id|mnt
comma
r_struct
id|dentry
op_star
id|dentry
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_inode_delete
r_static
r_void
id|dummy_inode_delete
(paren
r_struct
id|inode
op_star
id|ino
)paren
(brace
r_return
suffix:semicolon
)brace
DECL|function|dummy_inode_setxattr
r_static
r_int
id|dummy_inode_setxattr
(paren
r_struct
id|dentry
op_star
id|dentry
comma
r_char
op_star
id|name
comma
r_void
op_star
id|value
comma
r_int
id|size
comma
r_int
id|flags
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|name
comma
id|XATTR_SECURITY_PREFIX
comma
r_sizeof
(paren
id|XATTR_SECURITY_PREFIX
)paren
op_minus
l_int|1
)paren
op_logical_and
op_logical_neg
id|capable
c_func
(paren
id|CAP_SYS_ADMIN
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_inode_post_setxattr
r_static
r_void
id|dummy_inode_post_setxattr
(paren
r_struct
id|dentry
op_star
id|dentry
comma
r_char
op_star
id|name
comma
r_void
op_star
id|value
comma
r_int
id|size
comma
r_int
id|flags
)paren
(brace
)brace
DECL|function|dummy_inode_getxattr
r_static
r_int
id|dummy_inode_getxattr
(paren
r_struct
id|dentry
op_star
id|dentry
comma
r_char
op_star
id|name
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_inode_listxattr
r_static
r_int
id|dummy_inode_listxattr
(paren
r_struct
id|dentry
op_star
id|dentry
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_inode_removexattr
r_static
r_int
id|dummy_inode_removexattr
(paren
r_struct
id|dentry
op_star
id|dentry
comma
r_char
op_star
id|name
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|name
comma
id|XATTR_SECURITY_PREFIX
comma
r_sizeof
(paren
id|XATTR_SECURITY_PREFIX
)paren
op_minus
l_int|1
)paren
op_logical_and
op_logical_neg
id|capable
c_func
(paren
id|CAP_SYS_ADMIN
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_inode_getsecurity
r_static
r_int
id|dummy_inode_getsecurity
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_const
r_char
op_star
id|name
comma
r_void
op_star
id|buffer
comma
r_int
id|size
)paren
(brace
r_return
op_minus
id|EOPNOTSUPP
suffix:semicolon
)brace
DECL|function|dummy_inode_setsecurity
r_static
r_int
id|dummy_inode_setsecurity
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_const
r_char
op_star
id|name
comma
r_const
r_void
op_star
id|value
comma
r_int
id|size
comma
r_int
id|flags
)paren
(brace
r_return
op_minus
id|EOPNOTSUPP
suffix:semicolon
)brace
DECL|function|dummy_inode_listsecurity
r_static
r_int
id|dummy_inode_listsecurity
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_char
op_star
id|buffer
comma
r_int
id|buffer_size
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_file_permission
r_static
r_int
id|dummy_file_permission
(paren
r_struct
id|file
op_star
id|file
comma
r_int
id|mask
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_file_alloc_security
r_static
r_int
id|dummy_file_alloc_security
(paren
r_struct
id|file
op_star
id|file
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_file_free_security
r_static
r_void
id|dummy_file_free_security
(paren
r_struct
id|file
op_star
id|file
)paren
(brace
r_return
suffix:semicolon
)brace
DECL|function|dummy_file_ioctl
r_static
r_int
id|dummy_file_ioctl
(paren
r_struct
id|file
op_star
id|file
comma
r_int
r_int
id|command
comma
r_int
r_int
id|arg
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_file_mmap
r_static
r_int
id|dummy_file_mmap
(paren
r_struct
id|file
op_star
id|file
comma
r_int
r_int
id|prot
comma
r_int
r_int
id|flags
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_file_mprotect
r_static
r_int
id|dummy_file_mprotect
(paren
r_struct
id|vm_area_struct
op_star
id|vma
comma
r_int
r_int
id|prot
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_file_lock
r_static
r_int
id|dummy_file_lock
(paren
r_struct
id|file
op_star
id|file
comma
r_int
r_int
id|cmd
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_file_fcntl
r_static
r_int
id|dummy_file_fcntl
(paren
r_struct
id|file
op_star
id|file
comma
r_int
r_int
id|cmd
comma
r_int
r_int
id|arg
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_file_set_fowner
r_static
r_int
id|dummy_file_set_fowner
(paren
r_struct
id|file
op_star
id|file
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_file_send_sigiotask
r_static
r_int
id|dummy_file_send_sigiotask
(paren
r_struct
id|task_struct
op_star
id|tsk
comma
r_struct
id|fown_struct
op_star
id|fown
comma
r_int
id|sig
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_file_receive
r_static
r_int
id|dummy_file_receive
(paren
r_struct
id|file
op_star
id|file
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_task_create
r_static
r_int
id|dummy_task_create
(paren
r_int
r_int
id|clone_flags
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_task_alloc_security
r_static
r_int
id|dummy_task_alloc_security
(paren
r_struct
id|task_struct
op_star
id|p
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_task_free_security
r_static
r_void
id|dummy_task_free_security
(paren
r_struct
id|task_struct
op_star
id|p
)paren
(brace
r_return
suffix:semicolon
)brace
DECL|function|dummy_task_setuid
r_static
r_int
id|dummy_task_setuid
(paren
id|uid_t
id|id0
comma
id|uid_t
id|id1
comma
id|uid_t
id|id2
comma
r_int
id|flags
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_task_post_setuid
r_static
r_int
id|dummy_task_post_setuid
(paren
id|uid_t
id|id0
comma
id|uid_t
id|id1
comma
id|uid_t
id|id2
comma
r_int
id|flags
)paren
(brace
id|dummy_capget
c_func
(paren
id|current
comma
op_amp
id|current-&gt;cap_effective
comma
op_amp
id|current-&gt;cap_inheritable
comma
op_amp
id|current-&gt;cap_permitted
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_task_setgid
r_static
r_int
id|dummy_task_setgid
(paren
id|gid_t
id|id0
comma
id|gid_t
id|id1
comma
id|gid_t
id|id2
comma
r_int
id|flags
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_task_setpgid
r_static
r_int
id|dummy_task_setpgid
(paren
r_struct
id|task_struct
op_star
id|p
comma
id|pid_t
id|pgid
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_task_getpgid
r_static
r_int
id|dummy_task_getpgid
(paren
r_struct
id|task_struct
op_star
id|p
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_task_getsid
r_static
r_int
id|dummy_task_getsid
(paren
r_struct
id|task_struct
op_star
id|p
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_task_setgroups
r_static
r_int
id|dummy_task_setgroups
(paren
r_struct
id|group_info
op_star
id|group_info
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_task_setnice
r_static
r_int
id|dummy_task_setnice
(paren
r_struct
id|task_struct
op_star
id|p
comma
r_int
id|nice
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_task_setrlimit
r_static
r_int
id|dummy_task_setrlimit
(paren
r_int
r_int
id|resource
comma
r_struct
id|rlimit
op_star
id|new_rlim
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_task_setscheduler
r_static
r_int
id|dummy_task_setscheduler
(paren
r_struct
id|task_struct
op_star
id|p
comma
r_int
id|policy
comma
r_struct
id|sched_param
op_star
id|lp
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_task_getscheduler
r_static
r_int
id|dummy_task_getscheduler
(paren
r_struct
id|task_struct
op_star
id|p
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_task_wait
r_static
r_int
id|dummy_task_wait
(paren
r_struct
id|task_struct
op_star
id|p
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_task_kill
r_static
r_int
id|dummy_task_kill
(paren
r_struct
id|task_struct
op_star
id|p
comma
r_struct
id|siginfo
op_star
id|info
comma
r_int
id|sig
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_task_prctl
r_static
r_int
id|dummy_task_prctl
(paren
r_int
id|option
comma
r_int
r_int
id|arg2
comma
r_int
r_int
id|arg3
comma
r_int
r_int
id|arg4
comma
r_int
r_int
id|arg5
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_task_reparent_to_init
r_static
r_void
id|dummy_task_reparent_to_init
(paren
r_struct
id|task_struct
op_star
id|p
)paren
(brace
id|p-&gt;euid
op_assign
id|p-&gt;fsuid
op_assign
l_int|0
suffix:semicolon
r_return
suffix:semicolon
)brace
DECL|function|dummy_task_to_inode
r_static
r_void
id|dummy_task_to_inode
c_func
(paren
r_struct
id|task_struct
op_star
id|p
comma
r_struct
id|inode
op_star
id|inode
)paren
(brace
)brace
DECL|function|dummy_ipc_permission
r_static
r_int
id|dummy_ipc_permission
(paren
r_struct
id|kern_ipc_perm
op_star
id|ipcp
comma
r_int
id|flag
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_msg_msg_alloc_security
r_static
r_int
id|dummy_msg_msg_alloc_security
(paren
r_struct
id|msg_msg
op_star
id|msg
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_msg_msg_free_security
r_static
r_void
id|dummy_msg_msg_free_security
(paren
r_struct
id|msg_msg
op_star
id|msg
)paren
(brace
r_return
suffix:semicolon
)brace
DECL|function|dummy_msg_queue_alloc_security
r_static
r_int
id|dummy_msg_queue_alloc_security
(paren
r_struct
id|msg_queue
op_star
id|msq
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_msg_queue_free_security
r_static
r_void
id|dummy_msg_queue_free_security
(paren
r_struct
id|msg_queue
op_star
id|msq
)paren
(brace
r_return
suffix:semicolon
)brace
DECL|function|dummy_msg_queue_associate
r_static
r_int
id|dummy_msg_queue_associate
(paren
r_struct
id|msg_queue
op_star
id|msq
comma
r_int
id|msqflg
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_msg_queue_msgctl
r_static
r_int
id|dummy_msg_queue_msgctl
(paren
r_struct
id|msg_queue
op_star
id|msq
comma
r_int
id|cmd
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_msg_queue_msgsnd
r_static
r_int
id|dummy_msg_queue_msgsnd
(paren
r_struct
id|msg_queue
op_star
id|msq
comma
r_struct
id|msg_msg
op_star
id|msg
comma
r_int
id|msgflg
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_msg_queue_msgrcv
r_static
r_int
id|dummy_msg_queue_msgrcv
(paren
r_struct
id|msg_queue
op_star
id|msq
comma
r_struct
id|msg_msg
op_star
id|msg
comma
r_struct
id|task_struct
op_star
id|target
comma
r_int
id|type
comma
r_int
id|mode
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_shm_alloc_security
r_static
r_int
id|dummy_shm_alloc_security
(paren
r_struct
id|shmid_kernel
op_star
id|shp
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_shm_free_security
r_static
r_void
id|dummy_shm_free_security
(paren
r_struct
id|shmid_kernel
op_star
id|shp
)paren
(brace
r_return
suffix:semicolon
)brace
DECL|function|dummy_shm_associate
r_static
r_int
id|dummy_shm_associate
(paren
r_struct
id|shmid_kernel
op_star
id|shp
comma
r_int
id|shmflg
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_shm_shmctl
r_static
r_int
id|dummy_shm_shmctl
(paren
r_struct
id|shmid_kernel
op_star
id|shp
comma
r_int
id|cmd
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_shm_shmat
r_static
r_int
id|dummy_shm_shmat
(paren
r_struct
id|shmid_kernel
op_star
id|shp
comma
r_char
id|__user
op_star
id|shmaddr
comma
r_int
id|shmflg
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_sem_alloc_security
r_static
r_int
id|dummy_sem_alloc_security
(paren
r_struct
id|sem_array
op_star
id|sma
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_sem_free_security
r_static
r_void
id|dummy_sem_free_security
(paren
r_struct
id|sem_array
op_star
id|sma
)paren
(brace
r_return
suffix:semicolon
)brace
DECL|function|dummy_sem_associate
r_static
r_int
id|dummy_sem_associate
(paren
r_struct
id|sem_array
op_star
id|sma
comma
r_int
id|semflg
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_sem_semctl
r_static
r_int
id|dummy_sem_semctl
(paren
r_struct
id|sem_array
op_star
id|sma
comma
r_int
id|cmd
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_sem_semop
r_static
r_int
id|dummy_sem_semop
(paren
r_struct
id|sem_array
op_star
id|sma
comma
r_struct
id|sembuf
op_star
id|sops
comma
r_int
id|nsops
comma
r_int
id|alter
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_netlink_send
r_static
r_int
id|dummy_netlink_send
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|sk_buff
op_star
id|skb
)paren
(brace
r_if
c_cond
(paren
id|current-&gt;euid
op_eq
l_int|0
)paren
id|cap_raise
(paren
id|NETLINK_CB
(paren
id|skb
)paren
dot
id|eff_cap
comma
id|CAP_NET_ADMIN
)paren
suffix:semicolon
r_else
id|NETLINK_CB
(paren
id|skb
)paren
dot
id|eff_cap
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_netlink_recv
r_static
r_int
id|dummy_netlink_recv
(paren
r_struct
id|sk_buff
op_star
id|skb
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|cap_raised
(paren
id|NETLINK_CB
(paren
id|skb
)paren
dot
id|eff_cap
comma
id|CAP_NET_ADMIN
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_SECURITY_NETWORK
DECL|function|dummy_unix_stream_connect
r_static
r_int
id|dummy_unix_stream_connect
(paren
r_struct
id|socket
op_star
id|sock
comma
r_struct
id|socket
op_star
id|other
comma
r_struct
id|sock
op_star
id|newsk
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_unix_may_send
r_static
r_int
id|dummy_unix_may_send
(paren
r_struct
id|socket
op_star
id|sock
comma
r_struct
id|socket
op_star
id|other
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_socket_create
r_static
r_int
id|dummy_socket_create
(paren
r_int
id|family
comma
r_int
id|type
comma
r_int
id|protocol
comma
r_int
id|kern
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_socket_post_create
r_static
r_void
id|dummy_socket_post_create
(paren
r_struct
id|socket
op_star
id|sock
comma
r_int
id|family
comma
r_int
id|type
comma
r_int
id|protocol
comma
r_int
id|kern
)paren
(brace
r_return
suffix:semicolon
)brace
DECL|function|dummy_socket_bind
r_static
r_int
id|dummy_socket_bind
(paren
r_struct
id|socket
op_star
id|sock
comma
r_struct
id|sockaddr
op_star
id|address
comma
r_int
id|addrlen
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_socket_connect
r_static
r_int
id|dummy_socket_connect
(paren
r_struct
id|socket
op_star
id|sock
comma
r_struct
id|sockaddr
op_star
id|address
comma
r_int
id|addrlen
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_socket_listen
r_static
r_int
id|dummy_socket_listen
(paren
r_struct
id|socket
op_star
id|sock
comma
r_int
id|backlog
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_socket_accept
r_static
r_int
id|dummy_socket_accept
(paren
r_struct
id|socket
op_star
id|sock
comma
r_struct
id|socket
op_star
id|newsock
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_socket_post_accept
r_static
r_void
id|dummy_socket_post_accept
(paren
r_struct
id|socket
op_star
id|sock
comma
r_struct
id|socket
op_star
id|newsock
)paren
(brace
r_return
suffix:semicolon
)brace
DECL|function|dummy_socket_sendmsg
r_static
r_int
id|dummy_socket_sendmsg
(paren
r_struct
id|socket
op_star
id|sock
comma
r_struct
id|msghdr
op_star
id|msg
comma
r_int
id|size
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_socket_recvmsg
r_static
r_int
id|dummy_socket_recvmsg
(paren
r_struct
id|socket
op_star
id|sock
comma
r_struct
id|msghdr
op_star
id|msg
comma
r_int
id|size
comma
r_int
id|flags
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_socket_getsockname
r_static
r_int
id|dummy_socket_getsockname
(paren
r_struct
id|socket
op_star
id|sock
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_socket_getpeername
r_static
r_int
id|dummy_socket_getpeername
(paren
r_struct
id|socket
op_star
id|sock
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_socket_setsockopt
r_static
r_int
id|dummy_socket_setsockopt
(paren
r_struct
id|socket
op_star
id|sock
comma
r_int
id|level
comma
r_int
id|optname
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_socket_getsockopt
r_static
r_int
id|dummy_socket_getsockopt
(paren
r_struct
id|socket
op_star
id|sock
comma
r_int
id|level
comma
r_int
id|optname
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_socket_shutdown
r_static
r_int
id|dummy_socket_shutdown
(paren
r_struct
id|socket
op_star
id|sock
comma
r_int
id|how
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_socket_sock_rcv_skb
r_static
r_int
id|dummy_socket_sock_rcv_skb
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|sk_buff
op_star
id|skb
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_socket_getpeersec
r_static
r_int
id|dummy_socket_getpeersec
c_func
(paren
r_struct
id|socket
op_star
id|sock
comma
r_char
id|__user
op_star
id|optval
comma
r_int
id|__user
op_star
id|optlen
comma
r_int
id|len
)paren
(brace
r_return
op_minus
id|ENOPROTOOPT
suffix:semicolon
)brace
DECL|function|dummy_sk_alloc_security
r_static
r_inline
r_int
id|dummy_sk_alloc_security
(paren
r_struct
id|sock
op_star
id|sk
comma
r_int
id|family
comma
r_int
id|priority
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dummy_sk_free_security
r_static
r_inline
r_void
id|dummy_sk_free_security
(paren
r_struct
id|sock
op_star
id|sk
)paren
(brace
)brace
macro_line|#endif&t;/* CONFIG_SECURITY_NETWORK */
DECL|function|dummy_register_security
r_static
r_int
id|dummy_register_security
(paren
r_const
r_char
op_star
id|name
comma
r_struct
id|security_operations
op_star
id|ops
)paren
(brace
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
DECL|function|dummy_unregister_security
r_static
r_int
id|dummy_unregister_security
(paren
r_const
r_char
op_star
id|name
comma
r_struct
id|security_operations
op_star
id|ops
)paren
(brace
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
DECL|function|dummy_d_instantiate
r_static
r_void
id|dummy_d_instantiate
(paren
r_struct
id|dentry
op_star
id|dentry
comma
r_struct
id|inode
op_star
id|inode
)paren
(brace
r_return
suffix:semicolon
)brace
DECL|function|dummy_getprocattr
r_static
r_int
id|dummy_getprocattr
c_func
(paren
r_struct
id|task_struct
op_star
id|p
comma
r_char
op_star
id|name
comma
r_void
op_star
id|value
comma
r_int
id|size
)paren
(brace
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
DECL|function|dummy_setprocattr
r_static
r_int
id|dummy_setprocattr
c_func
(paren
r_struct
id|task_struct
op_star
id|p
comma
r_char
op_star
id|name
comma
r_void
op_star
id|value
comma
r_int
id|size
)paren
(brace
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
DECL|variable|dummy_security_ops
r_struct
id|security_operations
id|dummy_security_ops
suffix:semicolon
DECL|macro|set_to_dummy_if_null
mdefine_line|#define set_to_dummy_if_null(ops, function)&t;&t;&t;&t;&bslash;&n;&t;do {&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;&t;&t;if (!ops-&gt;function) {&t;&t;&t;&t;&t;&bslash;&n;&t;&t;&t;ops-&gt;function = dummy_##function;&t;&t;&bslash;&n;&t;&t;&t;pr_debug(&quot;Had to override the &quot; #function&t;&bslash;&n;&t;&t;&t;&t; &quot; security operation with the dummy one.&bslash;n&quot;);&bslash;&n;&t;&t;&t;}&t;&t;&t;&t;&t;&t;&bslash;&n;&t;} while (0)
DECL|function|security_fixup_ops
r_void
id|security_fixup_ops
(paren
r_struct
id|security_operations
op_star
id|ops
)paren
(brace
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|ptrace
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|capget
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|capset_check
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|capset_set
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|acct
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|capable
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|quotactl
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|quota_on
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|sysctl
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|syslog
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|settime
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|vm_enough_memory
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|bprm_alloc_security
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|bprm_free_security
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|bprm_apply_creds
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|bprm_set_security
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|bprm_check_security
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|bprm_secureexec
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|sb_alloc_security
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|sb_free_security
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|sb_copy_data
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|sb_kern_mount
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|sb_statfs
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|sb_mount
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|sb_check_sb
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|sb_umount
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|sb_umount_close
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|sb_umount_busy
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|sb_post_remount
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|sb_post_mountroot
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|sb_post_addmount
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|sb_pivotroot
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|sb_post_pivotroot
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|inode_alloc_security
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|inode_free_security
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|inode_create
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|inode_post_create
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|inode_link
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|inode_post_link
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|inode_unlink
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|inode_symlink
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|inode_post_symlink
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|inode_mkdir
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|inode_post_mkdir
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|inode_rmdir
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|inode_mknod
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|inode_post_mknod
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|inode_rename
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|inode_post_rename
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|inode_readlink
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|inode_follow_link
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|inode_permission
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|inode_setattr
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|inode_getattr
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|inode_delete
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|inode_setxattr
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|inode_post_setxattr
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|inode_getxattr
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|inode_listxattr
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|inode_removexattr
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|inode_getsecurity
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|inode_setsecurity
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|inode_listsecurity
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|file_permission
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|file_alloc_security
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|file_free_security
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|file_ioctl
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|file_mmap
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|file_mprotect
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|file_lock
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|file_fcntl
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|file_set_fowner
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|file_send_sigiotask
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|file_receive
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|task_create
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|task_alloc_security
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|task_free_security
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|task_setuid
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|task_post_setuid
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|task_setgid
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|task_setpgid
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|task_getpgid
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|task_getsid
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|task_setgroups
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|task_setnice
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|task_setrlimit
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|task_setscheduler
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|task_getscheduler
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|task_wait
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|task_kill
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|task_prctl
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|task_reparent_to_init
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|task_to_inode
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|ipc_permission
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|msg_msg_alloc_security
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|msg_msg_free_security
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|msg_queue_alloc_security
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|msg_queue_free_security
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|msg_queue_associate
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|msg_queue_msgctl
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|msg_queue_msgsnd
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|msg_queue_msgrcv
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|shm_alloc_security
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|shm_free_security
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|shm_associate
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|shm_shmctl
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|shm_shmat
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|sem_alloc_security
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|sem_free_security
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|sem_associate
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|sem_semctl
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|sem_semop
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|netlink_send
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|netlink_recv
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|register_security
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|unregister_security
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|d_instantiate
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|getprocattr
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|setprocattr
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_SECURITY_NETWORK
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|unix_stream_connect
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|unix_may_send
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|socket_create
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|socket_post_create
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|socket_bind
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|socket_connect
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|socket_listen
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|socket_accept
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|socket_post_accept
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|socket_sendmsg
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|socket_recvmsg
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|socket_getsockname
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|socket_getpeername
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|socket_setsockopt
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|socket_getsockopt
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|socket_shutdown
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|socket_sock_rcv_skb
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|socket_getpeersec
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|sk_alloc_security
)paren
suffix:semicolon
id|set_to_dummy_if_null
c_func
(paren
id|ops
comma
id|sk_free_security
)paren
suffix:semicolon
macro_line|#endif&t;/* CONFIG_SECURITY_NETWORK */
)brace
eof
