multiline_comment|/*&n; * A hash table (hashtab) maintains associations between&n; * key values and datum values.  The type of the key values&n; * and the type of the datum values is arbitrary.  The&n; * functions for hash computation and key comparison are&n; * provided by the creator of the table.&n; *&n; * Author : Stephen Smalley, &lt;sds@epoch.ncsc.mil&gt;&n; */
macro_line|#ifndef _SS_HASHTAB_H_
DECL|macro|_SS_HASHTAB_H_
mdefine_line|#define _SS_HASHTAB_H_
DECL|macro|HASHTAB_MAX_NODES
mdefine_line|#define HASHTAB_MAX_NODES&t;0xffffffff
DECL|struct|hashtab_node
r_struct
id|hashtab_node
(brace
DECL|member|key
r_void
op_star
id|key
suffix:semicolon
DECL|member|datum
r_void
op_star
id|datum
suffix:semicolon
DECL|member|next
r_struct
id|hashtab_node
op_star
id|next
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|hashtab
r_struct
id|hashtab
(brace
DECL|member|htable
r_struct
id|hashtab_node
op_star
op_star
id|htable
suffix:semicolon
multiline_comment|/* hash table */
DECL|member|size
id|u32
id|size
suffix:semicolon
multiline_comment|/* number of slots in hash table */
DECL|member|nel
id|u32
id|nel
suffix:semicolon
multiline_comment|/* number of elements in hash table */
DECL|member|hash_value
id|u32
(paren
op_star
id|hash_value
)paren
(paren
r_struct
id|hashtab
op_star
id|h
comma
r_void
op_star
id|key
)paren
suffix:semicolon
multiline_comment|/* hash function */
DECL|member|keycmp
r_int
(paren
op_star
id|keycmp
)paren
(paren
r_struct
id|hashtab
op_star
id|h
comma
r_void
op_star
id|key1
comma
r_void
op_star
id|key2
)paren
suffix:semicolon
multiline_comment|/* key comparison function */
)brace
suffix:semicolon
DECL|struct|hashtab_info
r_struct
id|hashtab_info
(brace
DECL|member|slots_used
id|u32
id|slots_used
suffix:semicolon
DECL|member|max_chain_len
id|u32
id|max_chain_len
suffix:semicolon
)brace
suffix:semicolon
multiline_comment|/*&n; * Creates a new hash table with the specified characteristics.&n; *&n; * Returns NULL if insufficent space is available or&n; * the new hash table otherwise.&n; */
r_struct
id|hashtab
op_star
id|hashtab_create
c_func
(paren
id|u32
(paren
op_star
id|hash_value
)paren
(paren
r_struct
id|hashtab
op_star
id|h
comma
r_void
op_star
id|key
)paren
comma
r_int
(paren
op_star
id|keycmp
)paren
(paren
r_struct
id|hashtab
op_star
id|h
comma
r_void
op_star
id|key1
comma
r_void
op_star
id|key2
)paren
comma
id|u32
id|size
)paren
suffix:semicolon
multiline_comment|/*&n; * Inserts the specified (key, datum) pair into the specified hash table.&n; *&n; * Returns -ENOMEM on memory allocation error,&n; * -EEXIST if there is already an entry with the same key,&n; * -EINVAL for general errors or&n; * 0 otherwise.&n; */
r_int
id|hashtab_insert
c_func
(paren
r_struct
id|hashtab
op_star
id|h
comma
r_void
op_star
id|k
comma
r_void
op_star
id|d
)paren
suffix:semicolon
multiline_comment|/*&n; * Removes the entry with the specified key from the hash table.&n; * Applies the specified destroy function to (key,datum,args) for&n; * the entry.&n; *&n; * Returns -ENOENT if no entry has the specified key,&n; * -EINVAL for general errors or&n; *0 otherwise.&n; */
r_int
id|hashtab_remove
c_func
(paren
r_struct
id|hashtab
op_star
id|h
comma
r_void
op_star
id|k
comma
r_void
(paren
op_star
id|destroy
)paren
(paren
r_void
op_star
id|k
comma
r_void
op_star
id|d
comma
r_void
op_star
id|args
)paren
comma
r_void
op_star
id|args
)paren
suffix:semicolon
multiline_comment|/*&n; * Insert or replace the specified (key, datum) pair in the specified&n; * hash table.  If an entry for the specified key already exists,&n; * then the specified destroy function is applied to (key,datum,args)&n; * for the entry prior to replacing the entry&squot;s contents.&n; *&n; * Returns -ENOMEM if insufficient space is available,&n; * -EINVAL for general errors or&n; * 0 otherwise.&n; */
r_int
id|hashtab_replace
c_func
(paren
r_struct
id|hashtab
op_star
id|h
comma
r_void
op_star
id|k
comma
r_void
op_star
id|d
comma
r_void
(paren
op_star
id|destroy
)paren
(paren
r_void
op_star
id|k
comma
r_void
op_star
id|d
comma
r_void
op_star
id|args
)paren
comma
r_void
op_star
id|args
)paren
suffix:semicolon
multiline_comment|/*&n; * Searches for the entry with the specified key in the hash table.&n; *&n; * Returns NULL if no entry has the specified key or&n; * the datum of the entry otherwise.&n; */
r_void
op_star
id|hashtab_search
c_func
(paren
r_struct
id|hashtab
op_star
id|h
comma
r_void
op_star
id|k
)paren
suffix:semicolon
multiline_comment|/*&n; * Destroys the specified hash table.&n; */
r_void
id|hashtab_destroy
c_func
(paren
r_struct
id|hashtab
op_star
id|h
)paren
suffix:semicolon
multiline_comment|/*&n; * Applies the specified apply function to (key,datum,args)&n; * for each entry in the specified hash table.&n; *&n; * The order in which the function is applied to the entries&n; * is dependent upon the internal structure of the hash table.&n; *&n; * If apply returns a non-zero status, then hashtab_map will cease&n; * iterating through the hash table and will propagate the error&n; * return to its caller.&n; */
r_int
id|hashtab_map
c_func
(paren
r_struct
id|hashtab
op_star
id|h
comma
r_int
(paren
op_star
id|apply
)paren
(paren
r_void
op_star
id|k
comma
r_void
op_star
id|d
comma
r_void
op_star
id|args
)paren
comma
r_void
op_star
id|args
)paren
suffix:semicolon
multiline_comment|/*&n; * Same as hashtab_map, except that if apply returns a non-zero status,&n; * then the (key,datum) pair will be removed from the hashtab and the&n; * destroy function will be applied to (key,datum,args).&n; */
r_void
id|hashtab_map_remove_on_error
c_func
(paren
r_struct
id|hashtab
op_star
id|h
comma
r_int
(paren
op_star
id|apply
)paren
(paren
r_void
op_star
id|k
comma
r_void
op_star
id|d
comma
r_void
op_star
id|args
)paren
comma
r_void
(paren
op_star
id|destroy
)paren
(paren
r_void
op_star
id|k
comma
r_void
op_star
id|d
comma
r_void
op_star
id|args
)paren
comma
r_void
op_star
id|args
)paren
suffix:semicolon
multiline_comment|/* Fill info with some hash table statistics */
r_void
id|hashtab_stat
c_func
(paren
r_struct
id|hashtab
op_star
id|h
comma
r_struct
id|hashtab_info
op_star
id|info
)paren
suffix:semicolon
macro_line|#endif&t;/* _SS_HASHTAB_H */
eof
