multiline_comment|/*&n; *&n; * linux/drivers/s390/net/qeth.c ($Revision: 1.177 $)&n; *&n; * Linux on zSeries OSA Express and HiperSockets support&n; *&n; * Copyright 2000,2003 IBM Corporation&n; *&n; * Author(s): Utz Bacher &lt;utz.bacher@de.ibm.com&gt;&n; *            Cornelia Huck &lt;cohuck@de.ibm.com&gt; (2.5 integration,&n; *                                               numerous bugfixes)&n; *            Frank Pavlic &lt;pavlic@de.ibm.com&gt;  (query/purge ARP, SNMP, fixes)&n; *            Andreas Herrmann &lt;aherrman@de.ibm.com&gt; (bugfixes)&n; *            Thomas Spatzier &lt;tspat@de.ibm.com&gt; (bugfixes)&n; *&n; * This program is free software; you can redistribute it and/or modify&n; * it under the terms of the GNU General Public License as published by&n; * the Free Software Foundation; either version 2, or (at your option)&n; * any later version.&n; *&n; * This program is distributed in the hope that it will be useful,&n; * but WITHOUT ANY WARRANTY; without even the implied warranty of&n; * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; * GNU General Public License for more details.&n; *&n; * You should have received a copy of the GNU General Public License&n; * along with this program; if not, write to the Free Software&n; * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.&n; */
multiline_comment|/*&n; * The driver supports in general all QDIO driven network devices on the&n; * Hydra card.&n; *&n; * For all devices, three channels must be available to the driver. One&n; * channel is the read channel, one is the write channel and the third&n; * one is the channel used to control QDIO.&n; *&n; * There are several stages from the channel recognition to the running&n; * network device:&n; * - The channels are scanned and ordered due to the parameters (see&n; *   MODULE_PARM_DESC)&n; * - The card is hardsetup: this means, that the communication channels&n; *   are prepared&n; * - The card is softsetup: this means, that commands are issued&n; *   to activate the network parameters&n; * - After that, data can flow through the card (transported by QDIO)&n; *&n; *IPA Takeover:&n; * /proc/qeth_ipa_takeover provides the possibility to add and remove&n; * certain ranges of IP addresses to the driver. As soon as these&n; * addresses have to be set by the driver, the driver uses the OSA&n; * Address Takeover mechanism.&n; * reading out of the proc-file displays the registered addresses;&n; * writing into it changes the information. Only one command at one&n; * time must be written into the file. Subsequent commands are ignored.&n; * The following commands are available:&n; * inv4&n; * inv6&n; * add4 &lt;ADDR&gt;/&lt;mask bits&gt;[:&lt;interface&gt;]&n; * add6 &lt;ADDR&gt;/&lt;mask bits&gt;[:&lt;interface&gt;]&n; * del4 &lt;ADDR&gt;/&lt;mask bits&gt;[:&lt;interface&gt;]&n; * del6 &lt;ADDR&gt;/&lt;mask bits&gt;[:&lt;interface&gt;]&n; * inv4 and inv6 toggle the IPA takeover behaviour for all interfaces:&n; * when inv4 was input once, all addresses specified with add4 are not&n; * set using the takeover mechanism, but all other IPv4 addresses are set so.&n; *&n; * add# adds an address range, del# deletes an address range. # corresponds&n; * to the IP version (4 or 6).&n; * &lt;ADDR&gt; is a 8 or 32byte hexadecimal view of the IP address.&n; * &lt;mask bits&gt; specifies the number of bits which are set in the network mask.&n; * &lt;interface&gt; is optional and specifies the interface name to which the&n; * address range is bound.&n; * E. g.&n; *   add4 C0a80100/24&n; * activates all addresses in the 192.168.10 subnet for address takeover.&n; * Note, that the address is not taken over before an according ifconfig&n; * is executed.&n; *&n; *VIPA:&n; * add_vipa4 &lt;ADDR&gt;:&lt;interface&gt;&n; * add_vipa6 &lt;ADDR&gt;:&lt;interface&gt;&n; * del_vipa4 &lt;ADDR&gt;:&lt;interface&gt;&n; * del_vipa6 &lt;ADDR&gt;:&lt;interface&gt;&n; *&n; * the specified address is set/unset as VIPA on the specified interface.&n; * use the src_vipa package to exploit this out of arbitrary applications.&n; *&n; *Proxy ARP:&n; *&n; * add_rxip4 &lt;ADDR&gt;:&lt;interface&gt;&n; * add_rxip6 &lt;ADDR&gt;:&lt;interface&gt;&n; * del_rxip4 &lt;ADDR&gt;:&lt;interface&gt;&n; * del_rxip6 &lt;ADDR&gt;:&lt;interface&gt;&n; *&n; * the specified address is set/unset as &quot;do not fail a gratuitous ARP&quot;&n; * on the specified interface. this can be used to act as a proxy ARP.&n; */
r_static
r_void
r_volatile
DECL|function|qeth_eyecatcher
id|qeth_eyecatcher
c_func
(paren
r_void
)paren
(brace
r_return
suffix:semicolon
)brace
DECL|macro|DEBUG
macro_line|#undef DEBUG
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/moduleparam.h&gt;
macro_line|#include &lt;linux/string.h&gt;
macro_line|#include &lt;linux/errno.h&gt;
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;asm/io.h&gt;
macro_line|#include &lt;asm/ebcdic.h&gt;
macro_line|#include &lt;linux/ctype.h&gt;
macro_line|#include &lt;asm/semaphore.h&gt;
macro_line|#include &lt;asm/timex.h&gt;
macro_line|#include &lt;linux/if.h&gt;
macro_line|#include &lt;linux/if_arp.h&gt;
macro_line|#include &lt;linux/ip.h&gt;
macro_line|#include &lt;linux/inetdevice.h&gt;
macro_line|#include &lt;linux/netdevice.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/workqueue.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;linux/interrupt.h&gt;
macro_line|#include &lt;linux/tcp.h&gt;
macro_line|#include &lt;linux/icmp.h&gt;
macro_line|#include &lt;linux/skbuff.h&gt;
macro_line|#ifdef CONFIG_PROC_FS
macro_line|#include &lt;linux/proc_fs.h&gt;
macro_line|#endif /* CONFIG_PROC_FS */
macro_line|#include &lt;net/route.h&gt;
macro_line|#include &lt;net/arp.h&gt;
macro_line|#include &lt;linux/in.h&gt;
macro_line|#include &lt;linux/igmp.h&gt;
macro_line|#include &lt;net/ip.h&gt;
macro_line|#include &lt;asm/uaccess.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;net/ipv6.h&gt;
macro_line|#include &lt;linux/in6.h&gt;
macro_line|#include &lt;net/if_inet6.h&gt;
macro_line|#include &lt;net/addrconf.h&gt;
macro_line|#include &lt;linux/if_tr.h&gt;
macro_line|#include &lt;linux/trdevice.h&gt;
macro_line|#include &lt;linux/etherdevice.h&gt;
macro_line|#include &lt;linux/reboot.h&gt;
macro_line|#include &lt;linux/if_vlan.h&gt;
macro_line|#include &lt;asm/ccwdev.h&gt;
macro_line|#include &lt;asm/ccwgroup.h&gt;
macro_line|#include &lt;asm/debug.h&gt;
macro_line|#include &quot;qeth_mpc.h&quot;
macro_line|#include &quot;qeth.h&quot;
multiline_comment|/****************** MODULE PARAMETER VARIABLES ********************/
DECL|variable|qeth_sparebufs
r_static
r_int
id|qeth_sparebufs
op_assign
l_int|0
suffix:semicolon
id|module_param
c_func
(paren
id|qeth_sparebufs
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|qeth_sparebufs
comma
l_string|&quot;the number of pre-allocated spare buffers &quot;
l_string|&quot;reserved for low memory situations&quot;
)paren
suffix:semicolon
multiline_comment|/****************** MODULE STUFF **********************************/
DECL|macro|VERSION_QETH_C
mdefine_line|#define VERSION_QETH_C &quot;$Revision: 1.177 $&quot;
DECL|variable|version
r_static
r_const
r_char
op_star
id|version
op_assign
l_string|&quot;qeth S/390 OSA-Express driver (&quot;
id|VERSION_QETH_C
l_string|&quot;/&quot;
id|VERSION_QETH_H
l_string|&quot;/&quot;
id|VERSION_QETH_MPC_H
id|QETH_VERSION_IPV6
id|QETH_VERSION_VLAN
l_string|&quot;)&quot;
suffix:semicolon
id|MODULE_AUTHOR
c_func
(paren
l_string|&quot;Utz Bacher &lt;utz.bacher@de.ibm.com&gt;&quot;
)paren
suffix:semicolon
id|MODULE_DESCRIPTION
c_func
(paren
l_string|&quot;Linux on zSeries OSA Express and HiperSockets support&bslash;n&quot;
"&bslash;"
l_string|&quot;Copyright 2000,2003 IBM Corporation&bslash;n&quot;
)paren
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
multiline_comment|/******************** HERE WE GO ***********************************/
DECL|macro|PROCFILE_SLEEP_SEM_MAX_VALUE
mdefine_line|#define PROCFILE_SLEEP_SEM_MAX_VALUE 0
DECL|macro|PROCFILE_IOCTL_SEM_MAX_VALUE
mdefine_line|#define PROCFILE_IOCTL_SEM_MAX_VALUE 3
DECL|variable|qeth_procfile_ioctl_lock
r_static
r_struct
id|semaphore
id|qeth_procfile_ioctl_lock
suffix:semicolon
DECL|variable|qeth_procfile_ioctl_sem
r_static
r_struct
id|semaphore
id|qeth_procfile_ioctl_sem
suffix:semicolon
DECL|variable|firstcard
r_static
r_struct
id|qeth_card
op_star
id|firstcard
op_assign
l_int|NULL
suffix:semicolon
DECL|variable|sparebufs
r_static
r_struct
id|sparebufs
id|sparebufs
(braket
id|MAX_SPARE_BUFFERS
)braket
suffix:semicolon
DECL|variable|sparebuffer_count
r_static
r_int
id|sparebuffer_count
suffix:semicolon
DECL|variable|known_devices
r_static
r_int
r_int
id|known_devices
(braket
)braket
(braket
l_int|10
)braket
op_assign
id|QETH_MODELLIST_ARRAY
suffix:semicolon
DECL|variable|setup_lock
r_static
id|spinlock_t
id|setup_lock
op_assign
id|SPIN_LOCK_UNLOCKED
suffix:semicolon
DECL|variable|list_lock
r_static
id|rwlock_t
id|list_lock
op_assign
id|RW_LOCK_UNLOCKED
suffix:semicolon
DECL|variable|qeth_dbf_setup
r_static
id|debug_info_t
op_star
id|qeth_dbf_setup
op_assign
l_int|NULL
suffix:semicolon
DECL|variable|qeth_dbf_data
r_static
id|debug_info_t
op_star
id|qeth_dbf_data
op_assign
l_int|NULL
suffix:semicolon
DECL|variable|qeth_dbf_misc
r_static
id|debug_info_t
op_star
id|qeth_dbf_misc
op_assign
l_int|NULL
suffix:semicolon
DECL|variable|qeth_dbf_control
r_static
id|debug_info_t
op_star
id|qeth_dbf_control
op_assign
l_int|NULL
suffix:semicolon
DECL|variable|qeth_dbf_trace
r_static
id|debug_info_t
op_star
id|qeth_dbf_trace
op_assign
l_int|NULL
suffix:semicolon
DECL|variable|qeth_dbf_sense
r_static
id|debug_info_t
op_star
id|qeth_dbf_sense
op_assign
l_int|NULL
suffix:semicolon
DECL|variable|qeth_dbf_qerr
r_static
id|debug_info_t
op_star
id|qeth_dbf_qerr
op_assign
l_int|NULL
suffix:semicolon
DECL|variable|proc_file_registration
r_static
r_int
id|proc_file_registration
suffix:semicolon
macro_line|#ifdef QETH_PERFORMANCE_STATS
DECL|variable|proc_perf_file_registration
r_static
r_int
id|proc_perf_file_registration
suffix:semicolon
DECL|macro|NOW
mdefine_line|#define NOW qeth_get_micros()
macro_line|#endif /* QETH_PERFORMANCE_STATS */
DECL|variable|proc_ipato_file_registration
r_static
r_int
id|proc_ipato_file_registration
suffix:semicolon
DECL|variable|ipato_inv4
DECL|variable|ipato_inv6
r_static
r_int
id|ipato_inv4
op_assign
l_int|0
comma
id|ipato_inv6
op_assign
l_int|0
suffix:semicolon
DECL|variable|ipato_entries
r_static
r_struct
id|ipato_entry
op_star
id|ipato_entries
op_assign
l_int|NULL
suffix:semicolon
DECL|variable|ipato_list_lock
r_static
id|spinlock_t
id|ipato_list_lock
op_assign
id|SPIN_LOCK_UNLOCKED
suffix:semicolon
DECL|struct|tempinfo
r_struct
id|tempinfo
(brace
DECL|member|data
r_char
op_star
id|data
suffix:semicolon
DECL|member|len
r_int
id|len
suffix:semicolon
)brace
suffix:semicolon
multiline_comment|/* thought I could get along without forward declarations...&n; * just lazyness here */
r_static
r_int
id|qeth_reinit_thread
c_func
(paren
r_void
op_star
)paren
suffix:semicolon
r_static
r_inline
r_void
id|qeth_schedule_recovery
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
suffix:semicolon
r_static
r_inline
r_int
DECL|function|QETH_IP_VERSION
id|QETH_IP_VERSION
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
)paren
(brace
r_switch
c_cond
(paren
id|skb-&gt;protocol
)paren
(brace
r_case
id|ETH_P_IPV6
suffix:colon
r_return
l_int|6
suffix:semicolon
r_case
id|ETH_P_IP
suffix:colon
r_return
l_int|4
suffix:semicolon
r_default
suffix:colon
r_return
l_int|0
suffix:semicolon
)brace
)brace
multiline_comment|/* not a macro, as one of the arguments is atomic_read */
r_static
r_inline
r_int
DECL|function|qeth_min
id|qeth_min
c_func
(paren
r_int
id|a
comma
r_int
id|b
)paren
(brace
r_if
c_cond
(paren
id|a
OL
id|b
)paren
r_return
id|a
suffix:semicolon
r_else
r_return
id|b
suffix:semicolon
)brace
r_static
r_inline
r_int
r_int
DECL|function|qeth_get_millis
id|qeth_get_millis
c_func
(paren
r_void
)paren
(brace
r_return
(paren
r_int
)paren
(paren
id|get_clock
c_func
(paren
)paren
op_rshift
l_int|22
)paren
suffix:semicolon
multiline_comment|/* time&gt;&gt;12 is microseconds, we&n;&t;&t;&t;&t;&t;       divide it by 1024 */
)brace
macro_line|#ifdef QETH_PERFORMANCE_STATS
r_static
r_inline
r_int
r_int
DECL|function|qeth_get_micros
id|qeth_get_micros
c_func
(paren
r_void
)paren
(brace
r_return
(paren
r_int
)paren
(paren
id|get_clock
c_func
(paren
)paren
op_rshift
l_int|12
)paren
suffix:semicolon
)brace
macro_line|#endif /* QETH_PERFORMANCE_STATS */
r_static
r_void
DECL|function|qeth_delay_millis
id|qeth_delay_millis
c_func
(paren
r_int
r_int
id|msecs
)paren
(brace
r_int
r_int
id|start
suffix:semicolon
id|start
op_assign
id|qeth_get_millis
c_func
(paren
)paren
suffix:semicolon
r_while
c_loop
(paren
id|qeth_get_millis
c_func
(paren
)paren
op_minus
id|start
OL
id|msecs
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_wait_nonbusy
id|qeth_wait_nonbusy
c_func
(paren
r_int
r_int
id|timeout
)paren
(brace
r_int
r_int
id|start
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;wtnb%4x&quot;
comma
id|timeout
)paren
suffix:semicolon
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|start
op_assign
id|qeth_get_millis
c_func
(paren
)paren
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
suffix:semicolon
)paren
(brace
id|set_task_state
c_func
(paren
id|current
comma
id|TASK_INTERRUPTIBLE
)paren
suffix:semicolon
r_if
c_cond
(paren
id|qeth_get_millis
c_func
(paren
)paren
op_minus
id|start
OG
id|timeout
)paren
(brace
r_goto
id|out
suffix:semicolon
)brace
id|schedule_timeout
c_func
(paren
(paren
(paren
id|start
op_plus
id|timeout
op_minus
id|qeth_get_millis
c_func
(paren
)paren
)paren
op_rshift
l_int|10
)paren
op_star
id|HZ
)paren
suffix:semicolon
)brace
id|out
suffix:colon
id|set_task_state
c_func
(paren
id|current
comma
id|TASK_RUNNING
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_get_mac_for_ipm
id|qeth_get_mac_for_ipm
c_func
(paren
id|__u32
id|ipm
comma
r_char
op_star
id|mac
comma
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_if
c_cond
(paren
id|dev-&gt;type
op_eq
id|ARPHRD_IEEE802_TR
)paren
id|ip_tr_mc_map
c_func
(paren
id|ipm
comma
id|mac
)paren
suffix:semicolon
r_else
id|ip_eth_mc_map
c_func
(paren
id|ipm
comma
id|mac
)paren
suffix:semicolon
)brace
DECL|macro|atomic_swap
mdefine_line|#define atomic_swap(a,b) xchg((int*)a.counter,b)
r_static
r_int
r_inline
DECL|function|my_spin_lock_nonbusy
id|my_spin_lock_nonbusy
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
id|spinlock_t
op_star
id|lock
)paren
(brace
r_for
c_loop
(paren
suffix:semicolon
suffix:semicolon
)paren
(brace
r_if
c_cond
(paren
id|card
)paren
(brace
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;shutdown_phase
)paren
)paren
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|spin_trylock
c_func
(paren
id|lock
)paren
)paren
r_return
l_int|0
suffix:semicolon
id|qeth_wait_nonbusy
c_func
(paren
id|QETH_IDLE_WAIT_TIME
)paren
suffix:semicolon
)brace
)brace
r_static
r_int
r_inline
DECL|function|my_down_trylock_nonbusy
id|my_down_trylock_nonbusy
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_struct
id|semaphore
op_star
id|sema
)paren
(brace
r_for
c_loop
(paren
suffix:semicolon
suffix:semicolon
)paren
(brace
r_if
c_cond
(paren
id|card
)paren
(brace
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;shutdown_phase
)paren
)paren
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|down_trylock
c_func
(paren
id|sema
)paren
)paren
r_return
l_int|0
suffix:semicolon
id|qeth_wait_nonbusy
c_func
(paren
id|QETH_IDLE_WAIT_TIME
)paren
suffix:semicolon
)brace
)brace
macro_line|#ifdef CONFIG_ARCH_S390X
DECL|macro|QETH_GET_ADDR
mdefine_line|#define QETH_GET_ADDR(x) ((__u32)(unsigned long)x)
macro_line|#else /* CONFIG_ARCH_S390X */
DECL|macro|QETH_GET_ADDR
mdefine_line|#define QETH_GET_ADDR(x) ((__u32)x)
macro_line|#endif /* CONFIG_ARCH_S390X */
r_static
r_int
DECL|function|qeth_does_card_exist
id|qeth_does_card_exist
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_struct
id|qeth_card
op_star
id|c
op_assign
id|firstcard
suffix:semicolon
r_int
id|rc
op_assign
l_int|0
suffix:semicolon
id|read_lock
c_func
(paren
op_amp
id|list_lock
)paren
suffix:semicolon
r_while
c_loop
(paren
id|c
)paren
(brace
r_if
c_cond
(paren
id|c
op_eq
id|card
)paren
(brace
id|rc
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
)brace
id|c
op_assign
id|c-&gt;next
suffix:semicolon
)brace
id|read_unlock
c_func
(paren
op_amp
id|list_lock
)paren
suffix:semicolon
r_return
id|rc
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_getxdigit
id|qeth_getxdigit
c_func
(paren
r_char
id|c
)paren
(brace
r_if
c_cond
(paren
(paren
id|c
op_ge
l_char|&squot;0&squot;
)paren
op_logical_and
(paren
id|c
op_le
l_char|&squot;9&squot;
)paren
)paren
r_return
id|c
op_minus
l_char|&squot;0&squot;
suffix:semicolon
r_if
c_cond
(paren
(paren
id|c
op_ge
l_char|&squot;a&squot;
)paren
op_logical_and
(paren
id|c
op_le
l_char|&squot;f&squot;
)paren
)paren
r_return
id|c
op_plus
l_int|10
op_minus
l_char|&squot;a&squot;
suffix:semicolon
r_if
c_cond
(paren
(paren
id|c
op_ge
l_char|&squot;A&squot;
)paren
op_logical_and
(paren
id|c
op_le
l_char|&squot;F&squot;
)paren
)paren
r_return
id|c
op_plus
l_int|10
op_minus
l_char|&squot;A&squot;
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_static
r_struct
id|qeth_card
op_star
DECL|function|qeth_get_card_by_name
id|qeth_get_card_by_name
c_func
(paren
r_char
op_star
id|name
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
id|read_lock
c_func
(paren
op_amp
id|list_lock
)paren
suffix:semicolon
id|card
op_assign
id|firstcard
suffix:semicolon
r_while
c_loop
(paren
id|card
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|name
comma
id|card-&gt;dev_name
comma
id|DEV_NAME_LEN
)paren
)paren
r_break
suffix:semicolon
id|card
op_assign
id|card-&gt;next
suffix:semicolon
)brace
id|read_unlock
c_func
(paren
op_amp
id|list_lock
)paren
suffix:semicolon
r_return
id|card
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_convert_addr_to_text
id|qeth_convert_addr_to_text
c_func
(paren
r_int
id|version
comma
id|__u8
op_star
id|addr
comma
r_char
op_star
id|text
)paren
(brace
r_if
c_cond
(paren
id|version
op_eq
l_int|4
)paren
(brace
id|sprintf
c_func
(paren
id|text
comma
l_string|&quot;%02x%02x%02x%02x&quot;
comma
id|addr
(braket
l_int|0
)braket
comma
id|addr
(braket
l_int|1
)braket
comma
id|addr
(braket
l_int|2
)braket
comma
id|addr
(braket
l_int|3
)braket
)paren
suffix:semicolon
)brace
r_else
(brace
id|sprintf
c_func
(paren
id|text
comma
l_string|&quot;%02x%02x%02x%02x%02x%02x%02x%02x&quot;
l_string|&quot;%02x%02x%02x%02x%02x%02x%02x%02x&quot;
comma
id|addr
(braket
l_int|0
)braket
comma
id|addr
(braket
l_int|1
)braket
comma
id|addr
(braket
l_int|2
)braket
comma
id|addr
(braket
l_int|3
)braket
comma
id|addr
(braket
l_int|4
)braket
comma
id|addr
(braket
l_int|5
)braket
comma
id|addr
(braket
l_int|6
)braket
comma
id|addr
(braket
l_int|7
)braket
comma
id|addr
(braket
l_int|8
)braket
comma
id|addr
(braket
l_int|9
)braket
comma
id|addr
(braket
l_int|10
)braket
comma
id|addr
(braket
l_int|11
)braket
comma
id|addr
(braket
l_int|12
)braket
comma
id|addr
(braket
l_int|13
)braket
comma
id|addr
(braket
l_int|14
)braket
comma
id|addr
(braket
l_int|15
)braket
)paren
suffix:semicolon
)brace
)brace
r_static
r_int
DECL|function|qeth_convert_text_to_addr
id|qeth_convert_text_to_addr
c_func
(paren
r_int
id|version
comma
r_char
op_star
id|text
comma
id|__u8
op_star
id|addr
)paren
(brace
r_int
id|olen
op_assign
(paren
id|version
op_eq
l_int|4
)paren
ques
c_cond
l_int|4
suffix:colon
l_int|16
suffix:semicolon
r_while
c_loop
(paren
id|olen
op_decrement
)paren
(brace
r_if
c_cond
(paren
(paren
op_logical_neg
id|isxdigit
c_func
(paren
op_star
id|text
)paren
)paren
op_logical_or
(paren
op_logical_neg
id|isxdigit
c_func
(paren
op_star
(paren
id|text
op_plus
l_int|1
)paren
)paren
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
op_star
id|addr
op_assign
(paren
id|qeth_getxdigit
c_func
(paren
op_star
id|text
)paren
op_lshift
l_int|4
)paren
op_plus
id|qeth_getxdigit
c_func
(paren
op_star
(paren
id|text
op_plus
l_int|1
)paren
)paren
suffix:semicolon
id|addr
op_increment
suffix:semicolon
id|text
op_add_assign
l_int|2
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_add_ipato_entry
id|qeth_add_ipato_entry
c_func
(paren
r_int
id|version
comma
id|__u8
op_star
id|addr
comma
r_int
id|mask_bits
comma
r_char
op_star
id|dev_name
)paren
(brace
r_struct
id|ipato_entry
op_star
id|entry
comma
op_star
id|e
suffix:semicolon
r_int
id|len
op_assign
(paren
id|version
op_eq
l_int|4
)paren
ques
c_cond
l_int|4
suffix:colon
l_int|16
suffix:semicolon
id|entry
op_assign
(paren
r_struct
id|ipato_entry
op_star
)paren
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|ipato_entry
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|entry
)paren
(brace
id|PRINT_ERR
c_func
(paren
l_string|&quot;not enough memory for ipato allocation&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|entry-&gt;version
op_assign
id|version
suffix:semicolon
id|memcpy
c_func
(paren
id|entry-&gt;addr
comma
id|addr
comma
id|len
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dev_name
)paren
(brace
id|strncpy
c_func
(paren
id|entry-&gt;dev_name
comma
id|dev_name
comma
id|DEV_NAME_LEN
)paren
suffix:semicolon
r_if
c_cond
(paren
id|qeth_get_card_by_name
c_func
(paren
id|dev_name
)paren
op_member_access_from_pointer
id|options.ena_ipat
op_ne
id|ENABLE_TAKEOVER
)paren
id|PRINT_WARN
c_func
(paren
l_string|&quot;IP takeover is not enabled on %s! &quot;
l_string|&quot;Ignoring line&bslash;n&quot;
comma
id|dev_name
)paren
suffix:semicolon
)brace
r_else
id|memset
c_func
(paren
id|entry-&gt;dev_name
comma
l_int|0
comma
id|DEV_NAME_LEN
)paren
suffix:semicolon
id|entry-&gt;mask_bits
op_assign
id|mask_bits
suffix:semicolon
id|entry-&gt;next
op_assign
l_int|NULL
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|ipato_list_lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ipato_entries
)paren
(brace
id|e
op_assign
id|ipato_entries
suffix:semicolon
r_while
c_loop
(paren
id|e
)paren
(brace
r_if
c_cond
(paren
(paren
id|e-&gt;version
op_eq
id|version
)paren
op_logical_and
(paren
id|e-&gt;mask_bits
op_eq
id|mask_bits
)paren
op_logical_and
(paren
(paren
(paren
id|dev_name
)paren
op_logical_and
op_logical_neg
id|strncmp
c_func
(paren
id|e-&gt;dev_name
comma
id|dev_name
comma
id|DEV_NAME_LEN
)paren
)paren
op_logical_or
(paren
op_logical_neg
id|dev_name
)paren
)paren
op_logical_and
(paren
op_logical_neg
id|memcmp
c_func
(paren
id|e-&gt;addr
comma
id|addr
comma
id|len
)paren
)paren
)paren
(brace
id|PRINT_INFO
c_func
(paren
l_string|&quot;ipato to be added does already &quot;
l_string|&quot;exist&bslash;n&quot;
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|entry
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
r_if
c_cond
(paren
id|e-&gt;next
)paren
id|e
op_assign
id|e-&gt;next
suffix:semicolon
r_else
r_break
suffix:semicolon
)brace
id|e-&gt;next
op_assign
id|entry
suffix:semicolon
)brace
r_else
id|ipato_entries
op_assign
id|entry
suffix:semicolon
id|out
suffix:colon
id|spin_unlock
c_func
(paren
op_amp
id|ipato_list_lock
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_del_ipato_entry
id|qeth_del_ipato_entry
c_func
(paren
r_int
id|version
comma
id|__u8
op_star
id|addr
comma
r_int
id|mask_bits
comma
r_char
op_star
id|dev_name
)paren
(brace
r_struct
id|ipato_entry
op_star
id|e
comma
op_star
id|e_before
suffix:semicolon
r_int
id|len
op_assign
(paren
id|version
op_eq
l_int|4
)paren
ques
c_cond
l_int|4
suffix:colon
l_int|16
suffix:semicolon
r_int
id|found
op_assign
l_int|0
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|ipato_list_lock
)paren
suffix:semicolon
id|e
op_assign
id|ipato_entries
suffix:semicolon
r_if
c_cond
(paren
(paren
id|e-&gt;version
op_eq
id|version
)paren
op_logical_and
(paren
id|e-&gt;mask_bits
op_eq
id|mask_bits
)paren
op_logical_and
(paren
op_logical_neg
id|memcmp
c_func
(paren
id|e-&gt;addr
comma
id|addr
comma
id|len
)paren
)paren
)paren
(brace
id|ipato_entries
op_assign
id|e-&gt;next
suffix:semicolon
id|kfree
c_func
(paren
id|e
)paren
suffix:semicolon
)brace
r_else
r_while
c_loop
(paren
id|e
)paren
(brace
id|e_before
op_assign
id|e
suffix:semicolon
id|e
op_assign
id|e-&gt;next
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|e
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
(paren
id|e-&gt;version
op_eq
id|version
)paren
op_logical_and
(paren
id|e-&gt;mask_bits
op_eq
id|mask_bits
)paren
op_logical_and
(paren
(paren
(paren
id|dev_name
)paren
op_logical_and
op_logical_neg
id|strncmp
c_func
(paren
id|e-&gt;dev_name
comma
id|dev_name
comma
id|DEV_NAME_LEN
)paren
)paren
op_logical_or
(paren
op_logical_neg
id|dev_name
)paren
)paren
op_logical_and
(paren
op_logical_neg
id|memcmp
c_func
(paren
id|e-&gt;addr
comma
id|addr
comma
id|len
)paren
)paren
)paren
(brace
id|e_before-&gt;next
op_assign
id|e-&gt;next
suffix:semicolon
id|kfree
c_func
(paren
id|e
)paren
suffix:semicolon
id|found
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
op_logical_neg
id|found
)paren
id|PRINT_INFO
c_func
(paren
l_string|&quot;ipato to be deleted does not exist&bslash;n&quot;
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|ipato_list_lock
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_convert_addr_to_bits
id|qeth_convert_addr_to_bits
c_func
(paren
id|__u8
op_star
id|addr
comma
r_char
op_star
id|bits
comma
r_int
id|len
)paren
(brace
r_int
id|i
comma
id|j
suffix:semicolon
id|__u8
id|octet
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|len
suffix:semicolon
id|i
op_increment
)paren
(brace
id|octet
op_assign
id|addr
(braket
id|i
)braket
suffix:semicolon
r_for
c_loop
(paren
id|j
op_assign
l_int|7
suffix:semicolon
id|j
op_ge
l_int|0
suffix:semicolon
id|j
op_decrement
)paren
(brace
id|bits
(braket
id|i
op_star
l_int|8
op_plus
id|j
)braket
op_assign
(paren
id|octet
op_amp
l_int|1
)paren
ques
c_cond
l_int|1
suffix:colon
l_int|0
suffix:semicolon
id|octet
op_rshift_assign
l_int|1
suffix:semicolon
)brace
)brace
)brace
r_static
r_int
DECL|function|qeth_is_ipa_covered_by_ipato_entries
id|qeth_is_ipa_covered_by_ipato_entries
c_func
(paren
r_int
id|version
comma
id|__u8
op_star
id|addr
comma
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_char
op_star
id|memarea
comma
op_star
id|addr_bits
comma
op_star
id|entry_bits
suffix:semicolon
r_int
id|len
op_assign
(paren
id|version
op_eq
l_int|4
)paren
ques
c_cond
l_int|4
suffix:colon
l_int|16
suffix:semicolon
r_int
id|invert
op_assign
(paren
id|version
op_eq
l_int|4
)paren
ques
c_cond
id|ipato_inv4
suffix:colon
id|ipato_inv6
suffix:semicolon
r_int
id|result
op_assign
l_int|0
suffix:semicolon
r_struct
id|ipato_entry
op_star
id|e
suffix:semicolon
r_if
c_cond
(paren
id|card-&gt;options.ena_ipat
op_ne
id|ENABLE_TAKEOVER
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
id|memarea
op_assign
id|kmalloc
c_func
(paren
l_int|256
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|memarea
)paren
(brace
id|PRINT_ERR
c_func
(paren
l_string|&quot;not enough memory to check out whether to &quot;
l_string|&quot;use ipato&bslash;n&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|addr_bits
op_assign
id|memarea
suffix:semicolon
id|entry_bits
op_assign
id|memarea
op_plus
l_int|128
suffix:semicolon
id|qeth_convert_addr_to_bits
c_func
(paren
id|addr
comma
id|addr_bits
comma
id|len
)paren
suffix:semicolon
id|e
op_assign
id|ipato_entries
suffix:semicolon
r_while
c_loop
(paren
id|e
)paren
(brace
id|qeth_convert_addr_to_bits
c_func
(paren
id|e-&gt;addr
comma
id|entry_bits
comma
id|len
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
op_logical_neg
id|memcmp
c_func
(paren
id|addr_bits
comma
id|entry_bits
comma
id|__min
c_func
(paren
id|len
op_star
l_int|8
comma
id|e-&gt;mask_bits
)paren
)paren
)paren
op_logical_and
(paren
(paren
id|e-&gt;dev_name
(braket
l_int|0
)braket
op_logical_and
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|e-&gt;dev_name
comma
id|card-&gt;dev_name
comma
id|DEV_NAME_LEN
)paren
)paren
)paren
op_logical_or
(paren
op_logical_neg
id|e-&gt;dev_name
(braket
l_int|0
)braket
)paren
)paren
)paren
(brace
id|result
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
)brace
id|e
op_assign
id|e-&gt;next
suffix:semicolon
)brace
id|kfree
c_func
(paren
id|memarea
)paren
suffix:semicolon
r_if
c_cond
(paren
id|invert
)paren
r_return
op_logical_neg
id|result
suffix:semicolon
r_else
r_return
id|result
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_set_dev_flag_running
id|qeth_set_dev_flag_running
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_if
c_cond
(paren
id|card
)paren
(brace
id|card-&gt;dev-&gt;flags
op_or_assign
id|IFF_RUNNING
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|qeth_set_dev_flag_norunning
id|qeth_set_dev_flag_norunning
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_if
c_cond
(paren
id|card
)paren
(brace
id|card-&gt;dev-&gt;flags
op_and_assign
op_complement
id|IFF_RUNNING
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|qeth_restore_dev_flag_state
id|qeth_restore_dev_flag_state
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_if
c_cond
(paren
id|card
)paren
(brace
r_if
c_cond
(paren
id|card-&gt;saved_dev_flags
op_amp
id|IFF_RUNNING
)paren
id|card-&gt;dev-&gt;flags
op_or_assign
id|IFF_RUNNING
suffix:semicolon
r_else
id|card-&gt;dev-&gt;flags
op_and_assign
op_complement
id|IFF_RUNNING
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|qeth_save_dev_flag_state
id|qeth_save_dev_flag_state
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_if
c_cond
(paren
id|card
)paren
(brace
id|card-&gt;saved_dev_flags
op_assign
id|card-&gt;dev-&gt;flags
op_amp
id|IFF_RUNNING
suffix:semicolon
)brace
)brace
r_static
r_int
DECL|function|qeth_open
id|qeth_open
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
id|card
op_assign
(paren
r_struct
id|qeth_card
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;open&quot;
comma
id|card
)paren
suffix:semicolon
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|setup
comma
l_string|&quot;open&quot;
comma
id|card
)paren
suffix:semicolon
id|qeth_save_dev_flag_state
c_func
(paren
id|card
)paren
suffix:semicolon
id|netif_start_queue
c_func
(paren
id|dev
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
(paren
(paren
r_struct
id|qeth_card
op_star
)paren
id|dev-&gt;priv
)paren
op_member_access_from_pointer
id|is_open
comma
l_int|1
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_set_config
id|qeth_set_config
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|ifmap
op_star
id|map
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
id|card
op_assign
(paren
r_struct
id|qeth_card
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
id|QETH_DBF_CARD3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;nscf&quot;
comma
id|card
)paren
suffix:semicolon
r_return
op_minus
id|EOPNOTSUPP
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_is_multicast_skb_at_all
id|qeth_is_multicast_skb_at_all
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_int
id|version
)paren
(brace
r_int
id|i
suffix:semicolon
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
id|i
op_assign
id|RTN_UNSPEC
suffix:semicolon
id|card
op_assign
(paren
r_struct
id|qeth_card
op_star
)paren
id|skb-&gt;dev-&gt;priv
suffix:semicolon
r_if
c_cond
(paren
id|skb-&gt;dst
op_logical_and
id|skb-&gt;dst-&gt;neighbour
)paren
(brace
id|i
op_assign
id|skb-&gt;dst-&gt;neighbour-&gt;type
suffix:semicolon
r_return
(paren
(paren
id|i
op_eq
id|RTN_BROADCAST
)paren
op_logical_or
(paren
id|i
op_eq
id|RTN_MULTICAST
)paren
op_logical_or
(paren
id|i
op_eq
id|RTN_ANYCAST
)paren
)paren
ques
c_cond
id|i
suffix:colon
l_int|0
suffix:semicolon
)brace
multiline_comment|/* ok, we&squot;ve to try it somehow else */
r_if
c_cond
(paren
id|version
op_eq
l_int|4
)paren
(brace
r_return
(paren
(paren
id|skb-&gt;nh.raw
(braket
l_int|16
)braket
op_amp
l_int|0xf0
)paren
op_eq
l_int|0xe0
)paren
ques
c_cond
id|RTN_MULTICAST
suffix:colon
l_int|0
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|version
op_eq
l_int|6
)paren
(brace
r_return
(paren
id|skb-&gt;nh.raw
(braket
l_int|24
)braket
op_eq
l_int|0xff
)paren
ques
c_cond
id|RTN_MULTICAST
suffix:colon
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|memcmp
c_func
(paren
id|skb-&gt;nh.raw
comma
id|skb-&gt;dev-&gt;broadcast
comma
l_int|6
)paren
)paren
(brace
id|i
op_assign
id|RTN_BROADCAST
suffix:semicolon
)brace
r_else
(brace
id|__u16
id|hdr_mac
suffix:semicolon
id|hdr_mac
op_assign
op_star
(paren
(paren
id|__u16
op_star
)paren
id|skb-&gt;nh.raw
)paren
suffix:semicolon
multiline_comment|/* tr multicast? */
r_switch
c_cond
(paren
id|card-&gt;link_type
)paren
(brace
r_case
id|QETH_MPC_LINK_TYPE_HSTR
suffix:colon
r_case
id|QETH_MPC_LINK_TYPE_LANE_TR
suffix:colon
r_if
c_cond
(paren
(paren
id|hdr_mac
op_eq
id|QETH_TR_MAC_NC
)paren
op_logical_or
(paren
id|hdr_mac
op_eq
id|QETH_TR_MAC_C
)paren
)paren
id|i
op_assign
id|RTN_MULTICAST
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* eth or so multicast? */
r_default
suffix:colon
(brace
)brace
r_if
c_cond
(paren
(paren
id|hdr_mac
op_eq
id|QETH_ETH_MAC_V4
)paren
op_logical_or
(paren
id|hdr_mac
op_eq
id|QETH_ETH_MAC_V6
)paren
)paren
id|i
op_assign
id|RTN_MULTICAST
suffix:semicolon
)brace
)brace
r_return
(paren
(paren
id|i
op_eq
id|RTN_BROADCAST
)paren
op_logical_or
(paren
id|i
op_eq
id|RTN_MULTICAST
)paren
op_logical_or
(paren
id|i
op_eq
id|RTN_ANYCAST
)paren
)paren
ques
c_cond
id|i
suffix:colon
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_get_prioqueue
id|qeth_get_prioqueue
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_struct
id|sk_buff
op_star
id|skb
comma
r_int
id|multicast
comma
r_int
id|version
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|version
op_logical_and
(paren
id|card-&gt;type
op_eq
id|QETH_CARD_TYPE_OSAE
)paren
)paren
r_return
id|QETH_DEFAULT_QUEUE
suffix:semicolon
r_switch
c_cond
(paren
id|card-&gt;no_queues
)paren
(brace
r_case
l_int|1
suffix:colon
r_return
l_int|0
suffix:semicolon
r_case
l_int|4
suffix:colon
r_if
c_cond
(paren
id|card-&gt;is_multicast_different
)paren
(brace
r_if
c_cond
(paren
id|multicast
)paren
(brace
r_return
id|card-&gt;is_multicast_different
op_amp
(paren
id|card-&gt;no_queues
op_minus
l_int|1
)paren
suffix:semicolon
)brace
r_else
(brace
r_return
l_int|0
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|card-&gt;options.do_prio_queueing
)paren
(brace
r_if
c_cond
(paren
id|version
op_eq
l_int|4
)paren
(brace
r_if
c_cond
(paren
id|card-&gt;options.do_prio_queueing
op_eq
id|PRIO_QUEUEING_TOS
)paren
(brace
r_if
c_cond
(paren
id|skb-&gt;nh.iph-&gt;tos
op_amp
id|IP_TOS_NOTIMPORTANT
)paren
(brace
r_return
l_int|3
suffix:semicolon
)brace
r_if
c_cond
(paren
id|skb-&gt;nh.iph-&gt;tos
op_amp
id|IP_TOS_LOWDELAY
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|skb-&gt;nh.iph-&gt;tos
op_amp
id|IP_TOS_HIGHTHROUGHPUT
)paren
(brace
r_return
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|skb-&gt;nh.iph-&gt;tos
op_amp
id|IP_TOS_HIGHRELIABILITY
)paren
(brace
r_return
l_int|2
suffix:semicolon
)brace
r_return
id|QETH_DEFAULT_QUEUE
suffix:semicolon
)brace
r_if
c_cond
(paren
id|card-&gt;options.do_prio_queueing
op_eq
id|PRIO_QUEUEING_PREC
)paren
(brace
r_return
l_int|3
op_minus
(paren
id|skb-&gt;nh.iph-&gt;tos
op_rshift
l_int|6
)paren
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|version
op_eq
l_int|6
)paren
(brace
multiline_comment|/********************&n;&t;&t;&t;&t; ********************&n;&t;&t;&t;&t; *TODO: IPv6!!!&n;&t;&t;&t;&t; ********************/
)brace
r_return
id|card-&gt;options.default_queue
suffix:semicolon
)brace
r_else
r_return
id|card-&gt;options.default_queue
suffix:semicolon
r_default
suffix:colon
r_return
l_int|0
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|qeth_wakeup
id|qeth_wakeup
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
id|QETH_DBF_CARD5
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;wkup&quot;
comma
id|card
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;data_has_arrived
comma
l_int|1
)paren
suffix:semicolon
id|wake_up
c_func
(paren
op_amp
id|card-&gt;wait_q
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_check_idx_response
id|qeth_check_idx_response
c_func
(paren
r_int
r_char
op_star
id|buffer
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|buffer
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
(paren
id|buffer
(braket
l_int|2
)braket
op_amp
l_int|0xc0
)paren
op_eq
l_int|0xc0
)paren
(brace
r_return
op_minus
id|EIO
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_get_cards_problem
id|qeth_get_cards_problem
c_func
(paren
r_struct
id|ccw_device
op_star
id|cdev
comma
r_int
r_char
op_star
id|buffer
comma
r_int
id|dstat
comma
r_int
id|cstat
comma
r_int
id|rqparam
comma
r_char
op_star
id|irb
comma
r_char
op_star
id|sense
)paren
(brace
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_int
id|problem
op_assign
l_int|0
suffix:semicolon
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
id|card
op_assign
id|cdev-&gt;dev.driver_data
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;shutdown_phase
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|dstat
op_amp
id|DEV_STAT_UNIT_CHECK
)paren
(brace
r_if
c_cond
(paren
id|sense
(braket
id|SENSE_RESETTING_EVENT_BYTE
)braket
op_amp
id|SENSE_RESETTING_EVENT_FLAG
)paren
(brace
id|QETH_DBF_CARD1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;REVN&quot;
comma
id|card
)paren
suffix:semicolon
id|problem
op_assign
id|PROBLEM_RESETTING_EVENT_INDICATOR
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
r_if
c_cond
(paren
id|sense
(braket
id|SENSE_COMMAND_REJECT_BYTE
)braket
op_amp
id|SENSE_COMMAND_REJECT_FLAG
)paren
(brace
id|QETH_DBF_CARD1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;CREJ&quot;
comma
id|card
)paren
suffix:semicolon
id|problem
op_assign
id|PROBLEM_COMMAND_REJECT
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|sense
(braket
l_int|2
)braket
op_eq
l_int|0xaf
)paren
op_logical_and
(paren
id|sense
(braket
l_int|3
)braket
op_eq
l_int|0xfe
)paren
)paren
(brace
id|QETH_DBF_CARD1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;AFFE&quot;
comma
id|card
)paren
suffix:semicolon
id|problem
op_assign
id|PROBLEM_AFFE
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
op_logical_neg
id|sense
(braket
l_int|0
)braket
)paren
op_logical_and
(paren
op_logical_neg
id|sense
(braket
l_int|1
)braket
)paren
op_logical_and
(paren
op_logical_neg
id|sense
(braket
l_int|2
)braket
)paren
op_logical_and
(paren
op_logical_neg
id|sense
(braket
l_int|3
)braket
)paren
)paren
(brace
id|QETH_DBF_CARD1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;ZSNS&quot;
comma
id|card
)paren
suffix:semicolon
id|problem
op_assign
id|PROBLEM_ZERO_SENSE_DATA
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|QETH_DBF_CARD1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;GCHK&quot;
comma
id|card
)paren
suffix:semicolon
id|problem
op_assign
id|PROBLEM_GENERAL_CHECK
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
r_if
c_cond
(paren
id|cstat
op_amp
(paren
id|SCHN_STAT_CHN_CTRL_CHK
op_or
id|SCHN_STAT_INTF_CTRL_CHK
op_or
id|SCHN_STAT_CHN_DATA_CHK
op_or
id|SCHN_STAT_CHAIN_CHECK
op_or
id|SCHN_STAT_PROT_CHECK
op_or
id|SCHN_STAT_PROG_CHECK
)paren
)paren
(brace
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;GCHK&quot;
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
id|cdev-&gt;dev.bus_id
)paren
suffix:semicolon
id|QETH_DBF_HEX1
c_func
(paren
l_int|0
comma
id|misc
comma
id|irb
comma
id|__max
c_func
(paren
id|QETH_DBF_MISC_LEN
comma
l_int|64
)paren
)paren
suffix:semicolon
id|PRINT_WARN
c_func
(paren
l_string|&quot;check on device %s, dstat=x%x, cstat=x%x, &quot;
l_string|&quot;rqparam=x%x&bslash;n&quot;
comma
id|cdev-&gt;dev.bus_id
comma
id|dstat
comma
id|cstat
comma
id|rqparam
)paren
suffix:semicolon
id|HEXDUMP16
c_func
(paren
id|WARN
comma
l_string|&quot;irb: &quot;
comma
id|irb
)paren
suffix:semicolon
id|HEXDUMP16
c_func
(paren
id|WARN
comma
l_string|&quot;irb: &quot;
comma
(paren
(paren
r_char
op_star
)paren
id|irb
)paren
op_plus
l_int|32
)paren
suffix:semicolon
id|problem
op_assign
id|PROBLEM_GENERAL_CHECK
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
r_if
c_cond
(paren
id|qeth_check_idx_response
c_func
(paren
id|buffer
)paren
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;received an IDX TERMINATE on device %s &quot;
l_string|&quot;with cause code 0x%02x%s&bslash;n&quot;
comma
id|CARD_BUS_ID
c_func
(paren
id|card
)paren
comma
id|buffer
(braket
l_int|4
)braket
comma
(paren
id|buffer
(braket
l_int|4
)braket
op_eq
l_int|0x22
)paren
ques
c_cond
l_string|&quot; -- try another portname&quot;
suffix:colon
l_string|&quot;&quot;
)paren
suffix:semicolon
id|QETH_DBF_CARD1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;RTRM&quot;
comma
id|card
)paren
suffix:semicolon
id|problem
op_assign
id|PROBLEM_RECEIVED_IDX_TERMINATE
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
r_if
c_cond
(paren
id|IS_IPA
c_func
(paren
id|buffer
)paren
op_logical_and
op_logical_neg
id|IS_IPA_REPLY
c_func
(paren
id|buffer
)paren
)paren
(brace
r_if
c_cond
(paren
op_star
(paren
id|PDU_ENCAPSULATION
c_func
(paren
id|buffer
)paren
)paren
op_eq
id|IPA_CMD_STOPLAN
)paren
(brace
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;is_startlaned
comma
l_int|0
)paren
suffix:semicolon
multiline_comment|/* we don&squot;t do a  netif_stop_queue(card-&gt;dev);&n;&t;&t;&t;   we better discard all packets --&n;&t;&t;&t;   the outage could take longer */
id|PRINT_WARN
c_func
(paren
l_string|&quot;Link failure on %s (CHPID 0x%X) -- &quot;
l_string|&quot;there is a network problem or someone &quot;
l_string|&quot;pulled the cable or disabled the port.&quot;
l_string|&quot;Discarding outgoing packets.&bslash;n&quot;
comma
id|card-&gt;dev_name
comma
id|card-&gt;chpid
)paren
suffix:semicolon
id|QETH_DBF_CARD1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;CBOT&quot;
comma
id|card
)paren
suffix:semicolon
id|qeth_set_dev_flag_norunning
c_func
(paren
id|card
)paren
suffix:semicolon
id|problem
op_assign
l_int|0
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
r_if
c_cond
(paren
op_star
(paren
id|PDU_ENCAPSULATION
c_func
(paren
id|buffer
)paren
)paren
op_eq
id|IPA_CMD_STARTLAN
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_startlaned
)paren
)paren
(brace
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;is_startlaned
comma
l_int|1
)paren
suffix:semicolon
id|problem
op_assign
id|PROBLEM_CARD_HAS_STARTLANED
suffix:semicolon
)brace
r_goto
id|out
suffix:semicolon
)brace
r_if
c_cond
(paren
op_star
(paren
id|PDU_ENCAPSULATION
c_func
(paren
id|buffer
)paren
)paren
op_eq
id|IPA_CMD_REGISTER_LOCAL_ADDR
)paren
id|QETH_DBF_CARD3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;irla&quot;
comma
id|card
)paren
suffix:semicolon
r_if
c_cond
(paren
op_star
(paren
id|PDU_ENCAPSULATION
c_func
(paren
id|buffer
)paren
)paren
op_eq
id|IPA_CMD_UNREGISTER_LOCAL_ADDR
)paren
id|QETH_DBF_CARD3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;irla&quot;
comma
id|card
)paren
suffix:semicolon
id|PRINT_WARN
c_func
(paren
l_string|&quot;probably a problem on %s: received data is IPA, &quot;
l_string|&quot;but not a reply: command=0x%x&bslash;n&quot;
comma
id|card-&gt;dev_name
comma
op_star
(paren
id|PDU_ENCAPSULATION
c_func
(paren
id|buffer
)paren
op_plus
l_int|1
)paren
)paren
suffix:semicolon
id|QETH_DBF_CARD1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;INRP&quot;
comma
id|card
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
multiline_comment|/* no probs */
id|out
suffix:colon
r_if
c_cond
(paren
id|problem
)paren
(brace
id|QETH_DBF_CARD3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;gcpr&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%2x%2x%4x&quot;
comma
id|dstat
comma
id|cstat
comma
id|problem
)paren
suffix:semicolon
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%8x&quot;
comma
id|rqparam
)paren
suffix:semicolon
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
r_if
c_cond
(paren
id|buffer
)paren
id|QETH_DBF_HEX3
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|buffer
comma
r_sizeof
(paren
r_void
op_star
)paren
)paren
suffix:semicolon
id|QETH_DBF_HEX3
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|irb
comma
r_sizeof
(paren
r_void
op_star
)paren
)paren
suffix:semicolon
id|QETH_DBF_HEX3
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|sense
comma
r_sizeof
(paren
r_void
op_star
)paren
)paren
suffix:semicolon
)brace
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;problem
comma
id|problem
)paren
suffix:semicolon
r_return
id|problem
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_issue_next_read
id|qeth_issue_next_read
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_int
id|result
comma
id|result2
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
id|QETH_DBF_CARD5
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;isnr&quot;
comma
id|card
)paren
suffix:semicolon
multiline_comment|/* set up next read ccw */
id|memcpy
c_func
(paren
op_amp
id|card-&gt;dma_stuff-&gt;read_ccw
comma
id|READ_CCW
comma
r_sizeof
(paren
r_struct
id|ccw1
)paren
)paren
suffix:semicolon
id|card-&gt;dma_stuff-&gt;read_ccw.count
op_assign
id|QETH_BUFSIZE
suffix:semicolon
multiline_comment|/* recbuf is not yet used by read channel program */
id|card-&gt;dma_stuff-&gt;read_ccw.cda
op_assign
id|QETH_GET_ADDR
c_func
(paren
id|card-&gt;dma_stuff-&gt;recbuf
)paren
suffix:semicolon
multiline_comment|/* &n;&t; * we don&squot;t spin_lock_irqsave(get_ccwdev_lock(CARD_RDEV(card)),flags), as&n;&t; * we are only called in the interrupt handler&n;&t; */
id|result
op_assign
id|ccw_device_start
c_func
(paren
id|CARD_RDEV
c_func
(paren
id|card
)paren
comma
op_amp
id|card-&gt;dma_stuff-&gt;read_ccw
comma
id|MPC_SETUP_STATE
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|qeth_delay_millis
c_func
(paren
id|QETH_WAIT_BEFORE_2ND_DOIO
)paren
suffix:semicolon
id|result2
op_assign
id|ccw_device_start
c_func
(paren
id|CARD_RDEV
c_func
(paren
id|card
)paren
comma
op_amp
id|card-&gt;dma_stuff-&gt;read_ccw
comma
id|MPC_SETUP_STATE
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
id|PRINT_WARN
c_func
(paren
l_string|&quot;read handler on device %s, read: ccw_device_start &quot;
l_string|&quot;returned %i, next try returns %i&bslash;n&quot;
comma
id|CARD_BUS_ID
c_func
(paren
id|card
)paren
comma
id|result
comma
id|result2
)paren
suffix:semicolon
id|QETH_DBF_CARD1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;IsNR&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%04x%04x&quot;
comma
(paren
id|__s16
)paren
id|result
comma
(paren
id|__s16
)paren
id|result2
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
)brace
)brace
r_static
r_int
DECL|function|qeth_is_to_recover
id|qeth_is_to_recover
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_int
id|problem
)paren
(brace
r_switch
c_cond
(paren
id|problem
)paren
(brace
r_case
id|PROBLEM_CARD_HAS_STARTLANED
suffix:colon
r_return
l_int|1
suffix:semicolon
r_case
id|PROBLEM_RECEIVED_IDX_TERMINATE
suffix:colon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;in_recovery
)paren
)paren
(brace
r_return
l_int|1
suffix:semicolon
)brace
r_else
(brace
id|qeth_set_dev_flag_norunning
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_case
id|PROBLEM_ACTIVATE_CHECK_CONDITION
suffix:colon
r_return
l_int|1
suffix:semicolon
r_case
id|PROBLEM_RESETTING_EVENT_INDICATOR
suffix:colon
r_return
l_int|1
suffix:semicolon
r_case
id|PROBLEM_COMMAND_REJECT
suffix:colon
r_return
l_int|0
suffix:semicolon
r_case
id|PROBLEM_ZERO_SENSE_DATA
suffix:colon
r_return
l_int|0
suffix:semicolon
r_case
id|PROBLEM_GENERAL_CHECK
suffix:colon
r_return
l_int|1
suffix:semicolon
r_case
id|PROBLEM_BAD_SIGA_RESULT
suffix:colon
r_return
l_int|1
suffix:semicolon
r_case
id|PROBLEM_USER_TRIGGERED_RECOVERY
suffix:colon
r_return
l_int|1
suffix:semicolon
r_case
id|PROBLEM_AFFE
suffix:colon
r_return
l_int|1
suffix:semicolon
r_case
id|PROBLEM_MACHINE_CHECK
suffix:colon
r_return
l_int|1
suffix:semicolon
r_case
id|PROBLEM_TX_TIMEOUT
suffix:colon
r_return
l_int|1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_get_spare_buf
id|qeth_get_spare_buf
c_func
(paren
r_void
)paren
(brace
r_int
id|i
op_assign
l_int|0
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_while
c_loop
(paren
id|i
OL
id|sparebuffer_count
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|atomic_compare_and_swap
c_func
(paren
id|SPAREBUF_FREE
comma
id|SPAREBUF_USED
comma
op_amp
id|sparebufs
(braket
id|i
)braket
dot
id|status
)paren
)paren
(brace
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;gtspb%3x&quot;
comma
id|i
)paren
suffix:semicolon
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
r_return
id|i
suffix:semicolon
)brace
id|i
op_increment
suffix:semicolon
)brace
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;nospbuf&quot;
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_put_spare_buf
id|qeth_put_spare_buf
c_func
(paren
r_int
id|no
)paren
(brace
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;ptspb%3x&quot;
comma
id|no
)paren
suffix:semicolon
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|sparebufs
(braket
id|no
)braket
dot
id|status
comma
id|SPAREBUF_FREE
)paren
suffix:semicolon
)brace
r_static
r_inline
r_void
DECL|function|qeth_put_buffer_pool_entry
id|qeth_put_buffer_pool_entry
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_int
id|entry_no
)paren
(brace
r_if
c_cond
(paren
id|entry_no
op_amp
id|SPAREBUF_MASK
)paren
id|qeth_put_spare_buf
c_func
(paren
id|entry_no
op_amp
(paren
op_complement
id|SPAREBUF_MASK
)paren
)paren
suffix:semicolon
r_else
id|card-&gt;inbound_buffer_pool_entry_used
(braket
id|entry_no
)braket
op_assign
id|BUFFER_UNUSED
suffix:semicolon
)brace
r_static
r_inline
r_int
DECL|function|qeth_get_empty_buffer_pool_entry
id|qeth_get_empty_buffer_pool_entry
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_int
id|i
suffix:semicolon
r_int
id|max_buffers
op_assign
id|card-&gt;options.inbound_buffer_count
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|max_buffers
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|xchg
c_func
(paren
(paren
r_int
op_star
)paren
op_amp
id|card-&gt;inbound_buffer_pool_entry_used
(braket
id|i
)braket
comma
id|BUFFER_USED
)paren
op_eq
id|BUFFER_UNUSED
)paren
r_return
id|i
suffix:semicolon
)brace
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_static
r_inline
r_void
DECL|function|qeth_clear_input_buffer
id|qeth_clear_input_buffer
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_int
id|bufno
)paren
(brace
r_struct
id|qdio_buffer
op_star
id|buffer
suffix:semicolon
r_int
id|i
suffix:semicolon
r_int
id|elements
comma
id|el_m_1
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
id|QETH_DBF_CARD6
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;clib&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;bufno%3x&quot;
comma
id|bufno
)paren
suffix:semicolon
id|QETH_DBF_TEXT6
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|buffer
op_assign
op_amp
id|card-&gt;inbound_qdio_buffers
(braket
id|bufno
)braket
suffix:semicolon
id|elements
op_assign
id|BUFFER_MAX_ELEMENTS
suffix:semicolon
id|el_m_1
op_assign
id|elements
op_minus
l_int|1
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|elements
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|i
op_eq
id|el_m_1
)paren
id|buffer-&gt;element
(braket
id|i
)braket
dot
id|flags
op_assign
id|SBAL_FLAGS_LAST_ENTRY
suffix:semicolon
r_else
id|buffer-&gt;element
(braket
id|i
)braket
dot
id|flags
op_assign
l_int|0
suffix:semicolon
id|buffer-&gt;element
(braket
id|i
)braket
dot
id|length
op_assign
id|PAGE_SIZE
suffix:semicolon
id|buffer-&gt;element
(braket
id|i
)braket
dot
id|addr
op_assign
id|INBOUND_BUFFER_POS
c_func
(paren
id|card
comma
id|bufno
comma
id|i
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|qeth_queue_input_buffer
id|qeth_queue_input_buffer
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_int
id|bufno
comma
r_int
r_int
id|under_int
)paren
(brace
r_int
id|count
op_assign
l_int|0
comma
id|start
op_assign
l_int|0
comma
id|stop
op_assign
l_int|0
comma
id|pos
suffix:semicolon
r_int
id|result
suffix:semicolon
r_int
id|cnt1
comma
id|cnt2
op_assign
l_int|0
suffix:semicolon
r_int
id|wrapped
op_assign
l_int|0
suffix:semicolon
r_int
id|i
suffix:semicolon
r_int
id|requeue_counter
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_int
id|no
suffix:semicolon
id|QETH_DBF_CARD5
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;qibf&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x%4x&quot;
comma
id|under_int
comma
id|bufno
)paren
suffix:semicolon
id|QETH_DBF_TEXT5
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|atomic_inc
c_func
(paren
op_amp
id|card-&gt;requeue_counter
)paren
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;requeue_counter
)paren
op_le
id|QETH_REQUEUE_THRESHOLD
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|spin_trylock
c_func
(paren
op_amp
id|card-&gt;requeue_input_lock
)paren
)paren
(brace
id|QETH_DBF_CARD5
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;qibl&quot;
comma
id|card
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|requeue_counter
op_assign
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;requeue_counter
)paren
suffix:semicolon
id|pos
op_assign
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;requeue_position
)paren
suffix:semicolon
id|start
op_assign
id|pos
suffix:semicolon
multiline_comment|/* &n;&t; * omit the situation with 128 simultaneously&n;&t; * enqueued buffers, as then we can&squot;t benefit from PCI&n;&t; * avoidance anymore -- therefore we let count not grow as&n;&t; * big as requeue_counter&n;&t; */
r_while
c_loop
(paren
(paren
op_logical_neg
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;inbound_buffer_refcnt
(braket
id|pos
)braket
)paren
)paren
op_logical_and
(paren
id|count
OL
id|requeue_counter
op_minus
l_int|1
)paren
)paren
(brace
id|no
op_assign
id|qeth_get_empty_buffer_pool_entry
c_func
(paren
id|card
)paren
suffix:semicolon
r_if
c_cond
(paren
id|no
op_eq
op_minus
l_int|1
)paren
(brace
r_if
c_cond
(paren
id|count
)paren
r_break
suffix:semicolon
id|no
op_assign
id|qeth_get_spare_buf
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|no
op_eq
op_minus
l_int|1
)paren
(brace
id|PRINT_ERR
c_func
(paren
l_string|&quot;%s: no more input buffers &quot;
l_string|&quot;available! Inbound traffic could &quot;
l_string|&quot;be lost! Try increasing the bufcnt &quot;
l_string|&quot;parameter&bslash;n&quot;
comma
id|card-&gt;dev_name
)paren
suffix:semicolon
id|QETH_DBF_CARD2
c_func
(paren
l_int|1
comma
id|trace
comma
l_string|&quot;QINB&quot;
comma
id|card
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|card-&gt;inbound_buffer_entry_no
(braket
id|pos
)braket
op_assign
id|no
op_or
id|SPAREBUF_MASK
suffix:semicolon
)brace
id|card-&gt;inbound_buffer_entry_no
(braket
id|pos
)braket
op_assign
id|no
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;inbound_buffer_refcnt
(braket
id|pos
)braket
comma
l_int|1
)paren
suffix:semicolon
id|count
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|pos
op_ge
id|QDIO_MAX_BUFFERS_PER_Q
op_minus
l_int|1
)paren
(brace
id|pos
op_assign
l_int|0
suffix:semicolon
id|wrapped
op_assign
l_int|1
suffix:semicolon
)brace
r_else
id|pos
op_increment
suffix:semicolon
)brace
multiline_comment|/* stop points to the position after the last element */
id|stop
op_assign
id|pos
suffix:semicolon
id|QETH_DBF_CARD3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;qibi&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x&quot;
comma
id|requeue_counter
)paren
suffix:semicolon
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x%4x&quot;
comma
id|start
comma
id|stop
)paren
suffix:semicolon
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
r_if
c_cond
(paren
id|wrapped
)paren
(brace
id|cnt1
op_assign
id|QDIO_MAX_BUFFERS_PER_Q
op_minus
id|start
suffix:semicolon
id|cnt2
op_assign
id|stop
suffix:semicolon
)brace
r_else
(brace
id|cnt1
op_assign
id|count
suffix:semicolon
multiline_comment|/* cnt2 is already set to 0 */
)brace
id|atomic_sub
c_func
(paren
id|count
comma
op_amp
id|card-&gt;requeue_counter
)paren
suffix:semicolon
multiline_comment|/* &n;&t; * this is the only place where card-&gt;requeue_position is&n;&t; * written to, so that&squot;s ok (as it is in a lock)&n;&t; */
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;requeue_position
comma
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;requeue_position
)paren
op_plus
id|count
)paren
op_amp
(paren
id|QDIO_MAX_BUFFERS_PER_Q
op_minus
l_int|1
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|cnt1
)paren
(brace
r_for
c_loop
(paren
id|i
op_assign
id|start
suffix:semicolon
id|i
OL
id|start
op_plus
id|cnt1
suffix:semicolon
id|i
op_increment
)paren
(brace
id|qeth_clear_input_buffer
c_func
(paren
id|card
comma
id|i
)paren
suffix:semicolon
)brace
id|result
op_assign
id|do_QDIO
c_func
(paren
id|CARD_DDEV
c_func
(paren
id|card
)paren
comma
id|QDIO_FLAG_SYNC_INPUT
op_or
id|under_int
comma
l_int|0
comma
id|start
comma
id|cnt1
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;qeth_queue_input_buffer&squot;s &quot;
l_string|&quot;do_QDIO returnd %i (device %s)&bslash;n&quot;
comma
id|result
comma
id|CARD_DDEV_ID
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
id|QETH_DBF_CARD1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;QIDQ&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x%4x&quot;
comma
id|result
comma
id|requeue_counter
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x%4x&quot;
comma
id|start
comma
id|cnt1
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|1
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|cnt2
)paren
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|cnt2
suffix:semicolon
id|i
op_increment
)paren
(brace
id|qeth_clear_input_buffer
c_func
(paren
id|card
comma
id|i
)paren
suffix:semicolon
)brace
id|result
op_assign
id|do_QDIO
c_func
(paren
id|CARD_DDEV
c_func
(paren
id|card
)paren
comma
id|QDIO_FLAG_SYNC_INPUT
op_or
id|under_int
comma
l_int|0
comma
l_int|0
comma
id|cnt2
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;qeth_queue_input_buffer&squot;s &quot;
l_string|&quot;do_QDIO returnd %i (device %s)&bslash;n&quot;
comma
id|result
comma
id|CARD_DDEV_ID
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
id|QETH_DBF_CARD1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;QIDQ&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x%4x&quot;
comma
id|result
comma
id|requeue_counter
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x%4x&quot;
comma
l_int|0
comma
id|cnt2
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|1
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
)brace
)brace
id|out
suffix:colon
id|spin_unlock
c_func
(paren
op_amp
id|card-&gt;requeue_input_lock
)paren
suffix:semicolon
)brace
r_static
r_inline
r_struct
id|sk_buff
op_star
DECL|function|qeth_get_skb
id|qeth_get_skb
c_func
(paren
r_int
r_int
id|len
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
macro_line|#ifdef QETH_VLAN
id|skb
op_assign
id|dev_alloc_skb
c_func
(paren
id|len
op_plus
id|VLAN_HLEN
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb
)paren
id|skb_reserve
c_func
(paren
id|skb
comma
id|VLAN_HLEN
)paren
suffix:semicolon
macro_line|#else /* QETH_VLAN */
id|skb
op_assign
id|dev_alloc_skb
c_func
(paren
id|len
)paren
suffix:semicolon
macro_line|#endif /* QETH_VLAN */
r_return
id|skb
suffix:semicolon
)brace
r_static
r_inline
r_struct
id|sk_buff
op_star
DECL|function|qeth_get_next_skb
id|qeth_get_next_skb
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_int
op_star
id|element_ptr
comma
r_int
op_star
id|pos_in_el_ptr
comma
r_void
op_star
op_star
id|hdr_ptr
comma
r_struct
id|qdio_buffer
op_star
id|buffer
)paren
(brace
r_int
id|length
suffix:semicolon
r_char
op_star
id|data_ptr
suffix:semicolon
r_int
id|step
comma
id|len_togo
comma
id|element
comma
id|pos_in_el
suffix:semicolon
r_int
id|curr_len
suffix:semicolon
r_int
id|max_elements
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
id|max_elements
op_assign
id|BUFFER_MAX_ELEMENTS
suffix:semicolon
DECL|macro|SBALE_LEN
mdefine_line|#define SBALE_LEN(x) ((x&gt;=max_elements)?0:(buffer-&gt;element[x].length))
DECL|macro|SBALE_ADDR
mdefine_line|#define SBALE_ADDR(x) (buffer-&gt;element[x].addr)
id|element
op_assign
op_star
id|element_ptr
suffix:semicolon
r_if
c_cond
(paren
id|element
op_ge
id|max_elements
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;device %s: error in interpreting buffer (data &quot;
l_string|&quot;too long), %i elements.&bslash;n&quot;
comma
id|CARD_BUS_ID
c_func
(paren
id|card
)paren
comma
id|element
)paren
suffix:semicolon
id|QETH_DBF_CARD0
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;IEDL&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x%4x&quot;
comma
op_star
id|element_ptr
comma
op_star
id|pos_in_el_ptr
)paren
suffix:semicolon
id|QETH_DBF_TEXT0
c_func
(paren
l_int|1
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|QETH_DBF_HEX0
c_func
(paren
l_int|0
comma
id|misc
comma
id|buffer
comma
id|QETH_DBF_MISC_LEN
)paren
suffix:semicolon
id|QETH_DBF_HEX0
c_func
(paren
l_int|0
comma
id|misc
comma
id|buffer
op_plus
id|QETH_DBF_MISC_LEN
comma
id|QETH_DBF_MISC_LEN
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
id|pos_in_el
op_assign
op_star
id|pos_in_el_ptr
suffix:semicolon
id|curr_len
op_assign
id|SBALE_LEN
c_func
(paren
id|element
)paren
suffix:semicolon
r_if
c_cond
(paren
id|curr_len
OG
id|PAGE_SIZE
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;device %s: bad element length in element %i: &quot;
l_string|&quot;0x%x&bslash;n&quot;
comma
id|CARD_BUS_ID
c_func
(paren
id|card
)paren
comma
id|element
comma
id|curr_len
)paren
suffix:semicolon
id|QETH_DBF_CARD0
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;BELN&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x&quot;
comma
id|curr_len
)paren
suffix:semicolon
id|QETH_DBF_TEXT0
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x%4x&quot;
comma
op_star
id|element_ptr
comma
op_star
id|pos_in_el_ptr
)paren
suffix:semicolon
id|QETH_DBF_TEXT0
c_func
(paren
l_int|1
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|QETH_DBF_HEX0
c_func
(paren
l_int|0
comma
id|misc
comma
id|buffer
comma
id|QETH_DBF_MISC_LEN
)paren
suffix:semicolon
id|QETH_DBF_HEX0
c_func
(paren
l_int|0
comma
id|misc
comma
id|buffer
op_plus
id|QETH_DBF_MISC_LEN
comma
id|QETH_DBF_MISC_LEN
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
multiline_comment|/* header fits in current element? */
r_if
c_cond
(paren
id|curr_len
OL
id|pos_in_el
op_plus
id|QETH_HEADER_SIZE
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|pos_in_el
)paren
(brace
id|QETH_DBF_CARD6
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;gnmh&quot;
comma
id|card
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
multiline_comment|/* no more data in buffer */
)brace
multiline_comment|/* set hdr to next element */
id|element
op_increment
suffix:semicolon
id|pos_in_el
op_assign
l_int|0
suffix:semicolon
id|curr_len
op_assign
id|SBALE_LEN
c_func
(paren
id|element
)paren
suffix:semicolon
multiline_comment|/* does it fit in there? */
r_if
c_cond
(paren
id|curr_len
OL
id|QETH_HEADER_SIZE
)paren
(brace
id|QETH_DBF_CARD6
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;gdnf&quot;
comma
id|card
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
)brace
op_star
id|hdr_ptr
op_assign
id|SBALE_ADDR
c_func
(paren
id|element
)paren
op_plus
id|pos_in_el
suffix:semicolon
id|length
op_assign
op_star
(paren
id|__u16
op_star
)paren
(paren
(paren
r_char
op_star
)paren
(paren
op_star
id|hdr_ptr
)paren
op_plus
id|QETH_HEADER_LEN_POS
)paren
suffix:semicolon
id|QETH_DBF_CARD6
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;gdHd&quot;
comma
id|card
)paren
suffix:semicolon
id|QETH_DBF_HEX6
c_func
(paren
l_int|0
comma
id|trace
comma
id|hdr_ptr
comma
r_sizeof
(paren
r_void
op_star
)paren
)paren
suffix:semicolon
id|pos_in_el
op_add_assign
id|QETH_HEADER_SIZE
suffix:semicolon
r_if
c_cond
(paren
id|curr_len
op_le
id|pos_in_el
)paren
(brace
multiline_comment|/* switch to next element for data */
id|pos_in_el
op_assign
l_int|0
suffix:semicolon
id|element
op_increment
suffix:semicolon
id|curr_len
op_assign
id|SBALE_LEN
c_func
(paren
id|element
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|curr_len
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;device %s: inb. buffer with more headers &quot;
l_string|&quot;than data areas (%i elements).&bslash;n&quot;
comma
id|CARD_BUS_ID
c_func
(paren
id|card
)paren
comma
id|element
)paren
suffix:semicolon
id|QETH_DBF_CARD0
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;IEMH&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%2x%2x%4x&quot;
comma
id|element
comma
op_star
id|element_ptr
comma
op_star
id|pos_in_el_ptr
)paren
suffix:semicolon
id|QETH_DBF_TEXT0
c_func
(paren
l_int|1
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|QETH_DBF_HEX0
c_func
(paren
l_int|0
comma
id|misc
comma
id|buffer
comma
id|QETH_DBF_MISC_LEN
)paren
suffix:semicolon
id|QETH_DBF_HEX0
c_func
(paren
l_int|0
comma
id|misc
comma
id|buffer
op_plus
id|QETH_DBF_MISC_LEN
comma
id|QETH_DBF_MISC_LEN
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
)brace
id|data_ptr
op_assign
id|SBALE_ADDR
c_func
(paren
id|element
)paren
op_plus
id|pos_in_el
suffix:semicolon
r_if
c_cond
(paren
id|card-&gt;options.fake_ll
op_eq
id|FAKE_LL
)paren
(brace
id|skb
op_assign
id|qeth_get_skb
c_func
(paren
id|length
op_plus
id|QETH_FAKE_LL_LEN
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|skb
)paren
r_goto
id|nomem
suffix:semicolon
id|skb_pull
c_func
(paren
id|skb
comma
id|QETH_FAKE_LL_LEN
)paren
suffix:semicolon
)brace
r_else
(brace
id|skb
op_assign
id|qeth_get_skb
c_func
(paren
id|length
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|skb
)paren
r_goto
id|nomem
suffix:semicolon
)brace
id|QETH_DBF_HEX6
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|data_ptr
comma
r_sizeof
(paren
r_void
op_star
)paren
)paren
suffix:semicolon
id|QETH_DBF_HEX6
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|skb
comma
r_sizeof
(paren
r_void
op_star
)paren
)paren
suffix:semicolon
id|len_togo
op_assign
id|length
suffix:semicolon
r_while
c_loop
(paren
l_int|1
)paren
(brace
id|step
op_assign
id|qeth_min
c_func
(paren
id|len_togo
comma
id|curr_len
op_minus
id|pos_in_el
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|step
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;device %s: unexpected end of buffer, &quot;
l_string|&quot;length of element %i is 0. Discarding &quot;
l_string|&quot;packet.&bslash;n&quot;
comma
id|CARD_BUS_ID
c_func
(paren
id|card
)paren
comma
id|element
)paren
suffix:semicolon
id|QETH_DBF_CARD0
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;IEUE&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%2x%2x%4x&quot;
comma
id|element
comma
op_star
id|element_ptr
comma
op_star
id|pos_in_el_ptr
)paren
suffix:semicolon
id|QETH_DBF_TEXT0
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x%4x&quot;
comma
id|len_togo
comma
id|step
)paren
suffix:semicolon
id|QETH_DBF_TEXT0
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x%4x&quot;
comma
id|curr_len
comma
id|pos_in_el
)paren
suffix:semicolon
id|QETH_DBF_TEXT0
c_func
(paren
l_int|1
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|QETH_DBF_HEX0
c_func
(paren
l_int|0
comma
id|misc
comma
id|buffer
comma
id|QETH_DBF_MISC_LEN
)paren
suffix:semicolon
id|QETH_DBF_HEX0
c_func
(paren
l_int|0
comma
id|misc
comma
id|buffer
op_plus
id|QETH_DBF_MISC_LEN
comma
id|QETH_DBF_MISC_LEN
)paren
suffix:semicolon
id|dev_kfree_skb_irq
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
id|step
)paren
comma
id|data_ptr
comma
id|step
)paren
suffix:semicolon
id|len_togo
op_sub_assign
id|step
suffix:semicolon
r_if
c_cond
(paren
id|len_togo
)paren
(brace
id|pos_in_el
op_assign
l_int|0
suffix:semicolon
id|element
op_increment
suffix:semicolon
id|curr_len
op_assign
id|SBALE_LEN
c_func
(paren
id|element
)paren
suffix:semicolon
id|data_ptr
op_assign
id|SBALE_ADDR
c_func
(paren
id|element
)paren
suffix:semicolon
)brace
r_else
(brace
macro_line|#ifdef QETH_INBOUND_PACKING_1_PACKET_PER_SBALE
id|element
op_increment
suffix:semicolon
multiline_comment|/* we don&squot;t need to calculate curr_len */
id|pos_in_el
op_assign
l_int|0
suffix:semicolon
macro_line|#else /* QETH_INBOUND_PACKING_1_PACKET_PER_SBALE */
id|pos_in_el
op_add_assign
id|step
suffix:semicolon
macro_line|#endif /* QETH_INBOUND_PACKING_1_PACKET_PER_SBALE */
r_break
suffix:semicolon
)brace
)brace
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x%4x&quot;
comma
id|element
comma
id|pos_in_el
)paren
suffix:semicolon
id|QETH_DBF_TEXT6
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
op_star
id|element_ptr
op_assign
id|element
suffix:semicolon
op_star
id|pos_in_el_ptr
op_assign
id|pos_in_el
suffix:semicolon
r_return
id|skb
suffix:semicolon
id|nomem
suffix:colon
r_if
c_cond
(paren
id|net_ratelimit
c_func
(paren
)paren
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;no memory for packet from %s&bslash;n&quot;
comma
id|card-&gt;dev_name
)paren
suffix:semicolon
)brace
id|QETH_DBF_CARD0
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;NOMM&quot;
comma
id|card
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
r_static
r_inline
r_void
DECL|function|__qeth_rebuild_skb_fake_ll
id|__qeth_rebuild_skb_fake_ll
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_struct
id|sk_buff
op_star
id|skb
comma
r_void
op_star
id|hdr_ptr
)paren
(brace
id|skb-&gt;mac.raw
op_assign
id|skb-&gt;data
op_minus
id|QETH_FAKE_LL_LEN
suffix:semicolon
r_switch
c_cond
(paren
id|skb-&gt;pkt_type
)paren
(brace
r_case
id|PACKET_MULTICAST
suffix:colon
r_switch
c_cond
(paren
id|skb-&gt;protocol
)paren
(brace
macro_line|#ifdef QETH_IPV6
r_case
id|__constant_htons
c_func
(paren
id|ETH_P_IPV6
)paren
suffix:colon
id|ndisc_mc_map
c_func
(paren
(paren
r_struct
id|in6_addr
op_star
)paren
id|skb-&gt;data
op_plus
id|QETH_FAKE_LL_V6_ADDR_POS
comma
id|skb-&gt;mac.raw
op_plus
id|QETH_FAKE_LL_DEST_MAC_POS
comma
id|card-&gt;dev
comma
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif /* QETH_IPV6 */
r_case
id|__constant_htons
c_func
(paren
id|ETH_P_IP
)paren
suffix:colon
id|qeth_get_mac_for_ipm
c_func
(paren
op_star
(paren
id|__u32
op_star
)paren
id|skb-&gt;data
op_plus
id|QETH_FAKE_LL_V4_ADDR_POS
comma
id|skb-&gt;mac.raw
op_plus
id|QETH_FAKE_LL_DEST_MAC_POS
comma
id|card-&gt;dev
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|memcpy
c_func
(paren
id|skb-&gt;mac.raw
op_plus
id|QETH_FAKE_LL_DEST_MAC_POS
comma
id|card-&gt;dev-&gt;dev_addr
comma
id|QETH_FAKE_LL_ADDR_LEN
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|PACKET_BROADCAST
suffix:colon
id|memset
c_func
(paren
id|skb-&gt;mac.raw
op_plus
id|QETH_FAKE_LL_DEST_MAC_POS
comma
l_int|0xff
comma
id|QETH_FAKE_LL_ADDR_LEN
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|memcpy
c_func
(paren
id|skb-&gt;mac.raw
op_plus
id|QETH_FAKE_LL_DEST_MAC_POS
comma
id|card-&gt;dev-&gt;dev_addr
comma
id|QETH_FAKE_LL_ADDR_LEN
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_star
(paren
id|__u8
op_star
)paren
(paren
id|hdr_ptr
op_plus
l_int|11
)paren
op_amp
id|QETH_EXT_HEADER_SRC_MAC_ADDRESS
)paren
(brace
id|memcpy
c_func
(paren
id|skb-&gt;mac.raw
op_plus
id|QETH_FAKE_LL_SRC_MAC_POS
comma
id|hdr_ptr
op_plus
id|QETH_FAKE_LL_SRC_MAC_POS_IN_QDIO_HDR
comma
id|QETH_FAKE_LL_ADDR_LEN
)paren
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* clear source MAC for security reasons */
id|memset
c_func
(paren
id|skb-&gt;mac.raw
op_plus
id|QETH_FAKE_LL_SRC_MAC_POS
comma
l_int|0
comma
id|QETH_FAKE_LL_ADDR_LEN
)paren
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|skb-&gt;mac.raw
op_plus
id|QETH_FAKE_LL_PROT_POS
comma
op_amp
id|skb-&gt;protocol
comma
id|QETH_FAKE_LL_PROT_LEN
)paren
suffix:semicolon
)brace
r_static
r_inline
r_void
DECL|function|__qeth_rebuild_skb_vlan
id|__qeth_rebuild_skb_vlan
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_struct
id|sk_buff
op_star
id|skb
comma
r_void
op_star
id|hdr_ptr
)paren
(brace
macro_line|#ifdef QETH_VLAN
id|__u16
op_star
id|vlan_tag
suffix:semicolon
r_if
c_cond
(paren
op_star
(paren
id|__u8
op_star
)paren
(paren
id|hdr_ptr
op_plus
l_int|11
)paren
op_amp
id|QETH_EXT_HEADER_VLAN_FRAME
)paren
(brace
id|vlan_tag
op_assign
(paren
id|__u16
op_star
)paren
id|skb_push
c_func
(paren
id|skb
comma
id|VLAN_HLEN
)paren
suffix:semicolon
multiline_comment|/*&n;&t;&t;  if (*(__u8*)(hdr_ptr+11) &amp; &n;&t;&t;  QETH_EXT_HEADER_INCLUDE_VLAN_TAG) {&n;&t;&t;  *vlan_tag = *(__u16*)(hdr_ptr+28);&n;&t;&t;  *(vlan_tag+1)= *(__u16*)(hdr_ptr+30);&n;&t;&t;  } else {&n;&t;&t;*/
op_star
id|vlan_tag
op_assign
op_star
(paren
id|__u16
op_star
)paren
(paren
id|hdr_ptr
op_plus
l_int|12
)paren
suffix:semicolon
op_star
(paren
id|vlan_tag
op_plus
l_int|1
)paren
op_assign
id|skb-&gt;protocol
suffix:semicolon
multiline_comment|/*&n;&t;&t;  }&n;&t;&t;*/
id|skb-&gt;protocol
op_assign
id|__constant_htons
c_func
(paren
id|ETH_P_8021Q
)paren
suffix:semicolon
)brace
macro_line|#endif
)brace
r_static
r_inline
r_void
DECL|function|__qeth_rebuild_skb
id|__qeth_rebuild_skb
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_struct
id|sk_buff
op_star
id|skb
comma
r_void
op_star
id|hdr_ptr
)paren
(brace
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_int
id|version
suffix:semicolon
r_int
r_int
id|cast_type
suffix:semicolon
id|version
op_assign
(paren
(paren
op_star
(paren
id|__u16
op_star
)paren
(paren
id|hdr_ptr
)paren
)paren
op_amp
(paren
id|QETH_HEADER_IPV6
)paren
)paren
ques
c_cond
l_int|6
suffix:colon
l_int|4
suffix:semicolon
id|skb-&gt;protocol
op_assign
id|htons
c_func
(paren
(paren
id|version
op_eq
l_int|4
)paren
ques
c_cond
id|ETH_P_IP
suffix:colon
(paren
id|version
op_eq
l_int|6
)paren
ques
c_cond
id|ETH_P_IPV6
suffix:colon
id|ETH_P_ALL
)paren
suffix:semicolon
id|cast_type
op_assign
(paren
op_star
(paren
id|__u16
op_star
)paren
(paren
id|hdr_ptr
)paren
)paren
op_amp
(paren
id|QETH_CAST_FLAGS
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|cast_type
)paren
(brace
r_case
id|QETH_CAST_UNICAST
suffix:colon
id|skb-&gt;pkt_type
op_assign
id|PACKET_HOST
suffix:semicolon
r_break
suffix:semicolon
r_case
id|QETH_CAST_MULTICAST
suffix:colon
id|skb-&gt;pkt_type
op_assign
id|PACKET_MULTICAST
suffix:semicolon
r_break
suffix:semicolon
r_case
id|QETH_CAST_BROADCAST
suffix:colon
id|skb-&gt;pkt_type
op_assign
id|PACKET_BROADCAST
suffix:semicolon
r_break
suffix:semicolon
r_case
id|QETH_CAST_ANYCAST
suffix:colon
r_case
id|QETH_CAST_NOCAST
suffix:colon
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;ribf&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;castan%2x&quot;
comma
id|cast_type
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|1
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|skb-&gt;pkt_type
op_assign
id|PACKET_HOST
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|PRINT_WARN
c_func
(paren
l_string|&quot;adapter is using an unknown casting value &quot;
l_string|&quot;of 0x%x. Using unicasting instead.&bslash;n&quot;
comma
id|cast_type
)paren
suffix:semicolon
id|skb-&gt;pkt_type
op_assign
id|PACKET_HOST
suffix:semicolon
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;ribf&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;castun%2x&quot;
comma
id|cast_type
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|1
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|card-&gt;options.fake_ll
op_eq
id|FAKE_LL
)paren
id|__qeth_rebuild_skb_fake_ll
c_func
(paren
id|card
comma
id|skb
comma
id|hdr_ptr
)paren
suffix:semicolon
r_else
id|skb-&gt;mac.raw
op_assign
id|skb-&gt;data
suffix:semicolon
id|skb-&gt;ip_summed
op_assign
id|card-&gt;options.checksum_type
suffix:semicolon
r_if
c_cond
(paren
id|card-&gt;options.checksum_type
op_eq
id|HW_CHECKSUMMING
)paren
(brace
multiline_comment|/* do we have a checksummed packet? */
multiline_comment|/* &n;&t;&t; * we only check for TCP/UDP checksums when the pseudo&n;&t;&t; * header was also checked successfully -- for the&n;&t;&t; * rest of the packets, it&squot;s not clear, whether the&n;&t;&t; * upper layer csum is alright. And they shouldn&squot;t&n;&t;&t; * occur too often anyway in real life &n;&t;&t; */
r_if
c_cond
(paren
(paren
op_star
(paren
id|__u8
op_star
)paren
(paren
id|hdr_ptr
op_plus
l_int|11
)paren
op_amp
(paren
id|QETH_EXT_HEADER_CSUM_HDR_REQ
op_or
id|QETH_EXT_HEADER_CSUM_TRANSP_REQ
)paren
)paren
op_eq
(paren
id|QETH_EXT_HEADER_CSUM_HDR_REQ
op_or
id|QETH_EXT_HEADER_CSUM_TRANSP_REQ
)paren
)paren
(brace
macro_line|#if 0
multiline_comment|/* csum does not need to be set inbound anyway */
multiline_comment|/* &n;&t;&t;&t; * vlan is not an issue here, it&squot;s still in&n;&t;&t;&t; * the QDIO header, not pushed in the skb yet&n;&t;&t;&t; */
r_int
id|ip_len
op_assign
(paren
id|skb-&gt;data
(braket
l_int|0
)braket
op_amp
l_int|0x0f
)paren
op_lshift
l_int|2
suffix:semicolon
r_if
c_cond
(paren
op_star
(paren
id|__u8
op_star
)paren
(paren
id|hdr_ptr
op_plus
l_int|11
)paren
op_amp
id|QETH_EXT_HEADER_CSUM_TRANSP_FRAME_TYPE
)paren
(brace
multiline_comment|/* get the UDP checksum */
id|skb-&gt;csum
op_assign
op_star
(paren
id|__u16
op_star
)paren
(paren
op_amp
id|skb-&gt;data
(braket
id|ip_len
op_plus
id|QETH_UDP_CSUM_OFFSET
)braket
)paren
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* get the TCP checksum */
id|skb-&gt;csum
op_assign
op_star
(paren
id|__u16
op_star
)paren
(paren
op_amp
id|skb-&gt;data
(braket
id|ip_len
op_plus
id|QETH_TCP_CSUM_OFFSET
)braket
)paren
suffix:semicolon
)brace
macro_line|#endif /* 0 */
id|skb-&gt;ip_summed
op_assign
id|CHECKSUM_UNNECESSARY
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* make the stack check it */
id|skb-&gt;ip_summed
op_assign
id|SW_CHECKSUMMING
suffix:semicolon
)brace
)brace
r_else
id|skb-&gt;ip_summed
op_assign
id|card-&gt;options.checksum_type
suffix:semicolon
id|__qeth_rebuild_skb_vlan
c_func
(paren
id|card
comma
id|skb
comma
id|hdr_ptr
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_read_in_buffer
id|qeth_read_in_buffer
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_int
id|buffer_no
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
r_void
op_star
id|hdr_ptr
suffix:semicolon
r_int
id|element
op_assign
l_int|0
comma
id|pos_in_el
op_assign
l_int|0
suffix:semicolon
r_struct
id|qdio_buffer
op_star
id|buffer
suffix:semicolon
r_int
id|i
suffix:semicolon
r_int
id|max_elements
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_struct
id|net_device
op_star
id|dev
suffix:semicolon
id|dev
op_assign
id|card-&gt;dev
suffix:semicolon
id|max_elements
op_assign
id|BUFFER_MAX_ELEMENTS
suffix:semicolon
id|buffer
op_assign
op_amp
id|card-&gt;inbound_qdio_buffers
(braket
id|buffer_no
)braket
suffix:semicolon
multiline_comment|/* inform about errors */
r_if
c_cond
(paren
id|buffer-&gt;element
(braket
l_int|15
)braket
dot
id|flags
op_amp
l_int|0xff
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;on device %s: incoming SBALF 15 on buffer &quot;
l_string|&quot;0x%x are 0x%x&bslash;n&quot;
comma
id|CARD_BUS_ID
c_func
(paren
id|card
)paren
comma
id|buffer_no
comma
id|buffer-&gt;element
(braket
l_int|15
)braket
dot
id|flags
op_amp
l_int|0xff
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;SF%s%2x%2x&quot;
comma
id|CARD_BUS_ID
c_func
(paren
id|card
)paren
comma
id|buffer_no
comma
id|buffer-&gt;element
(braket
l_int|15
)braket
dot
id|flags
op_amp
l_int|0xff
)paren
suffix:semicolon
id|QETH_DBF_HEX1
c_func
(paren
l_int|1
comma
id|trace
comma
id|dbf_text
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|max_elements
op_minus
l_int|1
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|buffer-&gt;element
(braket
id|i
)braket
dot
id|flags
op_amp
id|SBAL_FLAGS_LAST_ENTRY
)paren
(brace
id|buffer-&gt;element
(braket
id|i
op_plus
l_int|1
)braket
dot
id|length
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
macro_line|#ifdef QETH_PERFORMANCE_STATS
id|card-&gt;perf_stats.bufs_rec
op_increment
suffix:semicolon
macro_line|#endif /* QETH_PERFORMANCE_STATS */
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;ribX%s&quot;
comma
id|CARD_BUS_ID
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
id|dbf_text
(braket
l_int|3
)braket
op_assign
id|buffer_no
suffix:semicolon
id|QETH_DBF_HEX6
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
r_while
c_loop
(paren
(paren
id|skb
op_assign
id|qeth_get_next_skb
c_func
(paren
id|card
comma
op_amp
id|element
comma
op_amp
id|pos_in_el
comma
op_amp
id|hdr_ptr
comma
id|buffer
)paren
)paren
)paren
(brace
macro_line|#ifdef QETH_PERFORMANCE_STATS
id|card-&gt;perf_stats.skbs_rec
op_increment
suffix:semicolon
macro_line|#endif /* QETH_PERFORMANCE_STATS */
r_if
c_cond
(paren
id|skb
)paren
(brace
id|skb-&gt;dev
op_assign
id|dev
suffix:semicolon
macro_line|#ifdef QETH_IPV6
r_if
c_cond
(paren
(paren
op_star
(paren
id|__u16
op_star
)paren
(paren
id|hdr_ptr
)paren
)paren
op_amp
(paren
id|QETH_HEADER_PASSTHRU
)paren
)paren
id|skb-&gt;protocol
op_assign
id|card
op_member_access_from_pointer
id|type_trans
c_func
(paren
id|skb
comma
id|dev
)paren
suffix:semicolon
r_else
macro_line|#endif /* QETH_IPV6 */
id|__qeth_rebuild_skb
c_func
(paren
id|card
comma
id|skb
comma
id|hdr_ptr
)paren
suffix:semicolon
macro_line|#ifdef QETH_PERFORMANCE_STATS
id|card-&gt;perf_stats.inbound_time
op_add_assign
id|NOW
op_minus
id|card-&gt;perf_stats.inbound_start_time
suffix:semicolon
id|card-&gt;perf_stats.inbound_cnt
op_increment
suffix:semicolon
macro_line|#endif /* QETH_PERFORMANCE_STATS */
id|QETH_DBF_CARD6
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;rxpk&quot;
comma
id|card
)paren
suffix:semicolon
id|netif_rx
c_func
(paren
id|skb
)paren
suffix:semicolon
id|dev-&gt;last_rx
op_assign
id|jiffies
suffix:semicolon
id|card-&gt;stats-&gt;rx_packets
op_increment
suffix:semicolon
id|card-&gt;stats-&gt;rx_bytes
op_add_assign
id|skb-&gt;len
suffix:semicolon
)brace
r_else
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;%s: dropped packet, no buffers &quot;
l_string|&quot;available.&bslash;n&quot;
comma
id|card-&gt;dev_name
)paren
suffix:semicolon
id|QETH_DBF_CARD2
c_func
(paren
l_int|1
comma
id|trace
comma
l_string|&quot;DROP&quot;
comma
id|card
)paren
suffix:semicolon
id|card-&gt;stats-&gt;rx_dropped
op_increment
suffix:semicolon
)brace
)brace
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;inbound_buffer_refcnt
(braket
id|buffer_no
)braket
comma
l_int|0
)paren
suffix:semicolon
id|qeth_put_buffer_pool_entry
c_func
(paren
id|card
comma
id|card-&gt;inbound_buffer_entry_no
(braket
id|buffer_no
)braket
)paren
suffix:semicolon
)brace
r_static
r_inline
r_void
DECL|function|__qeth_fill_header_add_vlan
id|__qeth_fill_header_add_vlan
c_func
(paren
r_struct
id|qeth_hdr
op_star
id|hdr
comma
r_struct
id|sk_buff
op_star
id|skb
comma
r_int
id|version
)paren
(brace
macro_line|#ifdef QETH_VLAN
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
multiline_comment|/* &n;&t; * before we&squot;re going to overwrite this location with next hop ip.&n;&t; * v6 uses passthrough, v4 sets the tag in the QDIO header.&n;&t; */
id|card
op_assign
(paren
r_struct
id|qeth_card
op_star
)paren
id|skb-&gt;dev-&gt;priv
suffix:semicolon
r_if
c_cond
(paren
(paren
id|card-&gt;vlangrp
op_ne
l_int|NULL
)paren
op_logical_and
id|vlan_tx_tag_present
c_func
(paren
id|skb
)paren
)paren
(brace
id|hdr-&gt;ext_flags
op_assign
(paren
id|version
op_eq
l_int|4
)paren
ques
c_cond
id|QETH_EXT_HEADER_VLAN_FRAME
suffix:colon
id|QETH_EXT_HEADER_INCLUDE_VLAN_TAG
suffix:semicolon
id|hdr-&gt;vlan_id
op_assign
id|vlan_tx_tag_get
c_func
(paren
id|skb
)paren
suffix:semicolon
)brace
macro_line|#endif
)brace
r_static
r_inline
id|__u8
DECL|function|__qeth_get_flags_v4
id|__qeth_get_flags_v4
c_func
(paren
r_int
id|multicast
)paren
(brace
r_if
c_cond
(paren
id|multicast
op_eq
id|RTN_MULTICAST
)paren
r_return
id|QETH_CAST_MULTICAST
suffix:semicolon
r_if
c_cond
(paren
id|multicast
op_eq
id|RTN_BROADCAST
)paren
r_return
id|QETH_CAST_BROADCAST
suffix:semicolon
r_return
id|QETH_CAST_UNICAST
suffix:semicolon
)brace
r_static
r_inline
id|__u8
DECL|function|__qeth_get_flags_v6
id|__qeth_get_flags_v6
c_func
(paren
r_int
id|multicast
)paren
(brace
r_if
c_cond
(paren
id|multicast
op_eq
id|RTN_MULTICAST
)paren
r_return
id|QETH_CAST_MULTICAST
op_or
id|QETH_HEADER_PASSTHRU
op_or
id|QETH_HEADER_IPV6
suffix:semicolon
r_if
c_cond
(paren
id|multicast
op_eq
id|RTN_ANYCAST
)paren
r_return
id|QETH_CAST_ANYCAST
op_or
id|QETH_HEADER_PASSTHRU
op_or
id|QETH_HEADER_IPV6
suffix:semicolon
r_if
c_cond
(paren
id|multicast
op_eq
id|RTN_BROADCAST
)paren
r_return
id|QETH_CAST_BROADCAST
op_or
id|QETH_HEADER_PASSTHRU
op_or
id|QETH_HEADER_IPV6
suffix:semicolon
r_return
id|QETH_CAST_UNICAST
op_or
macro_line|#ifdef QETH_IPV6
id|QETH_HEADER_PASSTHRU
op_or
macro_line|#endif /* QETH_IPV6 */
id|QETH_HEADER_IPV6
suffix:semicolon
)brace
r_static
r_inline
r_void
DECL|function|qeth_fill_header
id|qeth_fill_header
c_func
(paren
r_struct
id|qeth_hdr
op_star
id|hdr
comma
r_struct
id|sk_buff
op_star
id|skb
comma
r_int
id|version
comma
r_int
id|multicast
)paren
(brace
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
id|hdr-&gt;id
op_assign
l_int|1
suffix:semicolon
id|hdr-&gt;ext_flags
op_assign
l_int|0
suffix:semicolon
id|__qeth_fill_header_add_vlan
c_func
(paren
id|hdr
comma
id|skb
comma
id|version
)paren
suffix:semicolon
id|hdr-&gt;length
op_assign
id|skb-&gt;len
op_minus
id|QETH_HEADER_SIZE
suffix:semicolon
multiline_comment|/* as skb-&gt;len includes&n;&t;&t;&t;&t;&t;&t;&t;   the header now */
multiline_comment|/* yes, I know this is doubled code, but a small little bit&n;&t;   faster maybe */
r_if
c_cond
(paren
id|version
op_eq
l_int|4
)paren
(brace
multiline_comment|/* IPv4 */
id|hdr-&gt;flags
op_assign
id|__qeth_get_flags_v4
c_func
(paren
id|multicast
)paren
suffix:semicolon
op_star
(paren
(paren
id|__u32
op_star
)paren
(paren
op_amp
id|hdr-&gt;dest_addr
(braket
l_int|0
)braket
)paren
)paren
op_assign
l_int|0
suffix:semicolon
op_star
(paren
(paren
id|__u32
op_star
)paren
(paren
op_amp
id|hdr-&gt;dest_addr
(braket
l_int|4
)braket
)paren
)paren
op_assign
l_int|0
suffix:semicolon
op_star
(paren
(paren
id|__u32
op_star
)paren
(paren
op_amp
id|hdr-&gt;dest_addr
(braket
l_int|8
)braket
)paren
)paren
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
(paren
id|skb-&gt;dst
)paren
op_logical_and
(paren
id|skb-&gt;dst-&gt;neighbour
)paren
)paren
(brace
op_star
(paren
(paren
id|__u32
op_star
)paren
(paren
op_amp
id|hdr-&gt;dest_addr
(braket
l_int|12
)braket
)paren
)paren
op_assign
op_star
(paren
(paren
id|__u32
op_star
)paren
id|skb-&gt;dst-&gt;neighbour-&gt;primary_key
)paren
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* fill in destination address used in ip header */
op_star
(paren
(paren
id|__u32
op_star
)paren
(paren
op_amp
id|hdr-&gt;dest_addr
(braket
l_int|12
)braket
)paren
)paren
op_assign
id|skb-&gt;nh.iph-&gt;daddr
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|version
op_eq
l_int|6
)paren
(brace
multiline_comment|/* IPv6 or passthru */
id|hdr-&gt;flags
op_assign
id|__qeth_get_flags_v6
c_func
(paren
id|multicast
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|skb-&gt;dst
)paren
op_logical_and
(paren
id|skb-&gt;dst-&gt;neighbour
)paren
)paren
(brace
id|memcpy
c_func
(paren
id|hdr-&gt;dest_addr
comma
id|skb-&gt;dst-&gt;neighbour-&gt;primary_key
comma
l_int|16
)paren
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* fill in destination address used in ip header */
id|memcpy
c_func
(paren
id|hdr-&gt;dest_addr
comma
op_amp
id|skb-&gt;nh.ipv6h-&gt;daddr
comma
l_int|16
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
multiline_comment|/* passthrough */
r_if
c_cond
(paren
op_logical_neg
id|memcmp
c_func
(paren
id|skb-&gt;data
op_plus
id|QETH_HEADER_SIZE
comma
id|skb-&gt;dev-&gt;broadcast
comma
l_int|6
)paren
)paren
(brace
multiline_comment|/* broadcast? */
id|hdr-&gt;flags
op_assign
id|QETH_CAST_BROADCAST
op_or
id|QETH_HEADER_PASSTHRU
suffix:semicolon
)brace
r_else
(brace
id|hdr-&gt;flags
op_assign
(paren
id|multicast
op_eq
id|RTN_MULTICAST
)paren
ques
c_cond
id|QETH_CAST_MULTICAST
op_or
id|QETH_HEADER_PASSTHRU
suffix:colon
id|QETH_CAST_UNICAST
op_or
id|QETH_HEADER_PASSTHRU
suffix:semicolon
)brace
)brace
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;filhdr%2x&quot;
comma
id|version
)paren
suffix:semicolon
id|QETH_DBF_TEXT6
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%2x&quot;
comma
id|multicast
)paren
suffix:semicolon
id|QETH_DBF_TEXT6
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|QETH_DBF_HEX6
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|skb
comma
r_sizeof
(paren
r_void
op_star
)paren
)paren
suffix:semicolon
id|QETH_DBF_HEX6
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|skb-&gt;data
comma
r_sizeof
(paren
r_void
op_star
)paren
)paren
suffix:semicolon
id|QETH_DBF_HEX6
c_func
(paren
l_int|0
comma
id|misc
comma
id|hdr
comma
id|__max
c_func
(paren
id|QETH_HEADER_SIZE
comma
id|QETH_DBF_MISC_LEN
)paren
)paren
suffix:semicolon
id|QETH_DBF_HEX6
c_func
(paren
l_int|0
comma
id|data
comma
id|skb-&gt;data
comma
id|__max
c_func
(paren
id|QETH_DBF_DATA_LEN
comma
id|QETH_DBF_DATA_LEN
)paren
)paren
suffix:semicolon
)brace
r_static
r_inline
r_int
DECL|function|qeth_fill_buffer
id|qeth_fill_buffer
c_func
(paren
r_struct
id|qdio_buffer
op_star
id|buffer
comma
r_char
op_star
id|dataptr
comma
r_int
id|length
comma
r_int
id|element
)paren
(brace
r_int
id|length_here
suffix:semicolon
r_int
id|first_lap
op_assign
l_int|1
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_int
id|first_element
op_assign
id|element
suffix:semicolon
r_while
c_loop
(paren
id|length
OG
l_int|0
)paren
(brace
multiline_comment|/* length_here is the remaining amount of data in this page */
id|length_here
op_assign
id|PAGE_SIZE
op_minus
(paren
(paren
r_int
r_int
)paren
id|dataptr
op_amp
(paren
id|PAGE_SIZE
op_minus
l_int|1
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|length
OL
id|length_here
)paren
id|length_here
op_assign
id|length
suffix:semicolon
id|buffer-&gt;element
(braket
id|element
)braket
dot
id|addr
op_assign
id|dataptr
suffix:semicolon
id|buffer-&gt;element
(braket
id|element
)braket
dot
id|length
op_assign
id|length_here
suffix:semicolon
id|length
op_sub_assign
id|length_here
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|length
)paren
(brace
r_if
c_cond
(paren
id|first_lap
)paren
(brace
id|buffer-&gt;element
(braket
id|element
)braket
dot
id|flags
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|buffer-&gt;element
(braket
id|element
)braket
dot
id|flags
op_assign
id|SBAL_FLAGS_LAST_FRAG
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|first_lap
)paren
(brace
id|buffer-&gt;element
(braket
id|element
)braket
dot
id|flags
op_assign
id|SBAL_FLAGS_FIRST_FRAG
suffix:semicolon
)brace
r_else
(brace
id|buffer-&gt;element
(braket
id|element
)braket
dot
id|flags
op_assign
id|SBAL_FLAGS_MIDDLE_FRAG
suffix:semicolon
)brace
)brace
id|dataptr
op_assign
id|dataptr
op_plus
id|length_here
suffix:semicolon
id|element
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|element
OG
id|QDIO_MAX_ELEMENTS_PER_BUFFER
)paren
(brace
id|PRINT_ERR
c_func
(paren
l_string|&quot;qeth_fill_buffer: IP packet too big!&bslash;n&quot;
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;IPpktobg&quot;
)paren
suffix:semicolon
id|QETH_DBF_HEX1
c_func
(paren
l_int|1
comma
id|trace
comma
op_amp
id|dataptr
comma
r_sizeof
(paren
r_void
op_star
)paren
)paren
suffix:semicolon
id|buffer-&gt;element
(braket
id|first_element
)braket
dot
id|length
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
)brace
id|first_lap
op_assign
l_int|0
suffix:semicolon
)brace
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;filbuf%2x&quot;
comma
id|element
)paren
suffix:semicolon
id|QETH_DBF_TEXT6
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|QETH_DBF_HEX3
c_func
(paren
l_int|0
comma
id|misc
comma
id|buffer
comma
id|QETH_DBF_MISC_LEN
)paren
suffix:semicolon
id|QETH_DBF_HEX3
c_func
(paren
l_int|0
comma
id|misc
comma
id|buffer
op_plus
id|QETH_DBF_MISC_LEN
comma
id|QETH_DBF_MISC_LEN
)paren
suffix:semicolon
r_return
id|element
suffix:semicolon
)brace
r_static
r_inline
r_void
DECL|function|qeth_flush_packed_packets
id|qeth_flush_packed_packets
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_int
id|queue
comma
r_int
id|under_int
)paren
(brace
r_struct
id|qdio_buffer
op_star
id|buffer
suffix:semicolon
r_int
id|result
suffix:semicolon
r_int
id|position
suffix:semicolon
r_int
id|position_for_do_qdio
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_int
id|last_pci
suffix:semicolon
id|position
op_assign
id|card-&gt;outbound_first_free_buffer
(braket
id|queue
)braket
suffix:semicolon
multiline_comment|/* can happen, when in the time between deciding to pack and sending&n;&t;   the next packet the lower mark was reached: */
r_if
c_cond
(paren
op_logical_neg
id|card-&gt;outbound_ringbuffer
(braket
id|queue
)braket
op_member_access_from_pointer
id|ringbuf_element
(braket
id|position
)braket
dot
id|next_element_to_fill
)paren
r_return
suffix:semicolon
id|buffer
op_assign
op_amp
id|card-&gt;outbound_ringbuffer
(braket
id|queue
)braket
op_member_access_from_pointer
id|buffer
(braket
id|position
)braket
suffix:semicolon
id|buffer-&gt;element
(braket
id|card-&gt;outbound_ringbuffer
(braket
id|queue
)braket
op_member_access_from_pointer
id|ringbuf_element
(braket
id|position
)braket
dot
id|next_element_to_fill
op_minus
l_int|1
)braket
dot
id|flags
op_or_assign
id|SBAL_FLAGS_LAST_ENTRY
suffix:semicolon
id|card-&gt;dev-&gt;trans_start
op_assign
id|jiffies
suffix:semicolon
macro_line|#ifdef QETH_PERFORMANCE_STATS
r_if
c_cond
(paren
id|card-&gt;outbound_buffer_send_state
(braket
id|queue
)braket
(braket
id|position
)braket
op_eq
id|SEND_STATE_DONT_PACK
)paren
(brace
id|card-&gt;perf_stats.bufs_sent_dont_pack
op_increment
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|card-&gt;outbound_buffer_send_state
(braket
id|queue
)braket
(braket
id|position
)braket
op_eq
id|SEND_STATE_PACK
)paren
(brace
id|card-&gt;perf_stats.bufs_sent_pack
op_increment
suffix:semicolon
)brace
id|card-&gt;perf_stats.bufs_sent
op_increment
suffix:semicolon
macro_line|#endif /* QETH_PERFORMANCE_STATS */
id|position_for_do_qdio
op_assign
id|position
suffix:semicolon
id|position
op_assign
(paren
id|position
op_plus
l_int|1
)paren
op_amp
(paren
id|QDIO_MAX_BUFFERS_PER_Q
op_minus
l_int|1
)paren
suffix:semicolon
id|card-&gt;outbound_first_free_buffer
(braket
id|queue
)braket
op_assign
id|position
suffix:semicolon
id|card-&gt;outbound_bytes_in_buffer
(braket
id|queue
)braket
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* we can override that, as we have at most 127 buffers enqueued */
id|card-&gt;outbound_ringbuffer
(braket
id|queue
)braket
op_member_access_from_pointer
id|ringbuf_element
(braket
id|position
)braket
dot
id|next_element_to_fill
op_assign
l_int|0
suffix:semicolon
id|atomic_inc
c_func
(paren
op_amp
id|card-&gt;outbound_used_buffers
(braket
id|queue
)braket
)paren
suffix:semicolon
id|QETH_DBF_CARD5
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;flsp&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x%2x%2x&quot;
comma
id|position_for_do_qdio
comma
id|under_int
comma
id|queue
)paren
suffix:semicolon
id|QETH_DBF_TEXT5
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|QETH_DBF_HEX5
c_func
(paren
l_int|0
comma
id|misc
comma
id|buffer
comma
id|QETH_DBF_MISC_LEN
)paren
suffix:semicolon
id|QETH_DBF_HEX5
c_func
(paren
l_int|0
comma
id|misc
comma
id|buffer
op_plus
id|QETH_DBF_MISC_LEN
comma
id|QETH_DBF_MISC_LEN
)paren
suffix:semicolon
multiline_comment|/* &n;&t; * we always set the outbound pci flag, don&squot;t care, whether the&n;&t; * adapter honors it or not&n;&t; */
r_switch
c_cond
(paren
id|card-&gt;send_state
(braket
id|queue
)braket
)paren
(brace
r_case
id|SEND_STATE_DONT_PACK
suffix:colon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;outbound_used_buffers
(braket
id|queue
)braket
)paren
OL
id|HIGH_WATERMARK_PACK
op_minus
id|WATERMARK_FUZZ
)paren
r_break
suffix:semicolon
multiline_comment|/* set the PCI bit */
id|card-&gt;outbound_ringbuffer
(braket
id|queue
)braket
op_member_access_from_pointer
id|buffer
(braket
id|position_for_do_qdio
)braket
dot
id|element
(braket
l_int|0
)braket
dot
id|flags
op_or_assign
l_int|0x40
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;last_pci_pos
(braket
id|queue
)braket
comma
id|position_for_do_qdio
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SEND_STATE_PACK
suffix:colon
id|last_pci
op_assign
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;last_pci_pos
(braket
id|queue
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
id|position_for_do_qdio
OL
id|last_pci
)paren
id|last_pci
op_sub_assign
id|QDIO_MAX_BUFFERS_PER_Q
suffix:semicolon
multiline_comment|/* so:&n;&t;&t; * last_pci is the position of the last pci we&squot;ve set&n;&t;&t; * position_for_do_qdio is the position we will send out now&n;&t;&t; * outbound_used_buffers is the number of buffers used (means&n;&t;&t; *   all buffers hydra has, inclusive position_for_do_qdio)&n;&t;&t; *&n;&t;&t; * we have to request a pci, if we have got the buffer of the&n;&t;&t; * last_pci position back.&n;&t;&t; *&n;&t;&t; * position_for_do_qdio-outbound_used_buffers is the newest&n;&t;&t; *   buffer that we got back from hydra&n;&t;&t; *&n;&t;&t; * if this is greater or equal than the last_pci position,&n;&t;&t; * we should request a pci, as no pci request is&n;&t;&t; * outstanding anymore&n;&t;&t; */
r_if
c_cond
(paren
id|position_for_do_qdio
op_minus
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;outbound_used_buffers
(braket
id|queue
)braket
)paren
op_ge
id|last_pci
)paren
(brace
multiline_comment|/* set the PCI bit */
id|card-&gt;outbound_ringbuffer
(braket
id|queue
)braket
op_member_access_from_pointer
id|buffer
(braket
id|position_for_do_qdio
)braket
dot
id|element
(braket
l_int|0
)braket
dot
id|flags
op_or_assign
l_int|0x40
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;last_pci_pos
(braket
id|queue
)braket
comma
id|position_for_do_qdio
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/* &n;&t; * this has to be at the end, otherwise a buffer could be flushed&n;&t; * twice (see comment in qeth_do_send_packet)&n;&t; */
id|result
op_assign
id|do_QDIO
c_func
(paren
id|CARD_DDEV
c_func
(paren
id|card
)paren
comma
id|QDIO_FLAG_SYNC_OUTPUT
op_or
id|under_int
comma
id|queue
comma
id|position_for_do_qdio
comma
l_int|1
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;Outbound do_QDIO returned %i &quot;
l_string|&quot;(device %s)&bslash;n&quot;
comma
id|result
comma
id|CARD_DDEV_ID
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
id|QETH_DBF_CARD5
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;FLSP&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;odoQ%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT5
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x%2x%2x&quot;
comma
id|position_for_do_qdio
comma
id|under_int
comma
id|queue
)paren
suffix:semicolon
id|QETH_DBF_TEXT5
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|QETH_DBF_HEX5
c_func
(paren
l_int|0
comma
id|misc
comma
id|buffer
comma
id|QETH_DBF_MISC_LEN
)paren
suffix:semicolon
id|QETH_DBF_HEX5
c_func
(paren
l_int|0
comma
id|misc
comma
id|buffer
op_plus
id|QETH_DBF_MISC_LEN
comma
id|QETH_DBF_MISC_LEN
)paren
suffix:semicolon
)brace
)brace
DECL|macro|ERROR_NONE
mdefine_line|#define ERROR_NONE 0
DECL|macro|ERROR_RETRY
mdefine_line|#define ERROR_RETRY 1
DECL|macro|ERROR_LINK_FAILURE
mdefine_line|#define ERROR_LINK_FAILURE 2
DECL|macro|ERROR_KICK_THAT_PUPPY
mdefine_line|#define ERROR_KICK_THAT_PUPPY 3
r_static
r_inline
r_int
DECL|function|qeth_determine_send_error
id|qeth_determine_send_error
c_func
(paren
r_int
id|cc
comma
r_int
id|qdio_error
comma
r_int
id|sbalf15
)paren
(brace
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_switch
c_cond
(paren
id|cc
op_amp
l_int|3
)paren
(brace
r_case
l_int|0
suffix:colon
r_if
c_cond
(paren
id|qdio_error
)paren
r_return
id|ERROR_LINK_FAILURE
suffix:semicolon
r_return
id|ERROR_NONE
suffix:semicolon
r_case
l_int|2
suffix:colon
r_if
c_cond
(paren
id|cc
op_amp
id|QDIO_SIGA_ERROR_B_BIT_SET
)paren
(brace
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;sigacc2b&quot;
)paren
suffix:semicolon
r_return
id|ERROR_KICK_THAT_PUPPY
suffix:semicolon
)brace
r_if
c_cond
(paren
id|qeth_sbalf15_in_retrieable_range
c_func
(paren
id|sbalf15
)paren
)paren
r_return
id|ERROR_RETRY
suffix:semicolon
r_return
id|ERROR_LINK_FAILURE
suffix:semicolon
multiline_comment|/* look at qdio_error and sbalf 15 */
r_case
l_int|1
suffix:colon
id|PRINT_WARN
c_func
(paren
l_string|&quot;siga returned cc 1! cc=0x%x, &quot;
l_string|&quot;qdio_error=0x%x, sbalf15=0x%x&bslash;n&quot;
comma
id|cc
comma
id|qdio_error
comma
id|sbalf15
)paren
suffix:semicolon
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;siga-cc1&quot;
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|qerr
comma
l_string|&quot;siga-cc1&quot;
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%1x%2x%2x&quot;
comma
id|cc
comma
id|qdio_error
comma
id|sbalf15
)paren
suffix:semicolon
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|qerr
comma
id|dbf_text
)paren
suffix:semicolon
r_return
id|ERROR_LINK_FAILURE
suffix:semicolon
r_case
l_int|3
suffix:colon
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;siga-cc3&quot;
)paren
suffix:semicolon
r_return
id|ERROR_KICK_THAT_PUPPY
suffix:semicolon
)brace
r_return
id|ERROR_LINK_FAILURE
suffix:semicolon
multiline_comment|/* should never happen */
)brace
r_static
r_inline
r_void
DECL|function|qeth_free_buffer
id|qeth_free_buffer
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_int
id|queue
comma
r_int
id|bufno
comma
r_int
id|qdio_error
comma
r_int
id|siga_error
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
r_int
id|error
suffix:semicolon
r_int
id|retries
suffix:semicolon
r_int
id|sbalf15
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_struct
id|qdio_buffer
op_star
id|buffer
suffix:semicolon
r_switch
c_cond
(paren
id|card-&gt;outbound_buffer_send_state
(braket
id|queue
)braket
(braket
id|bufno
)braket
)paren
(brace
r_case
id|SEND_STATE_DONT_PACK
suffix:colon
multiline_comment|/* fallthrough */
r_case
id|SEND_STATE_PACK
suffix:colon
id|QETH_DBF_CARD5
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;frbf&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%2x%2x%4x&quot;
comma
id|queue
comma
id|bufno
comma
id|card-&gt;outbound_buffer_send_state
(braket
id|queue
)braket
(braket
id|bufno
)braket
)paren
suffix:semicolon
id|QETH_DBF_TEXT5
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|buffer
op_assign
op_amp
id|card-&gt;outbound_ringbuffer
(braket
id|queue
)braket
op_member_access_from_pointer
id|buffer
(braket
id|bufno
)braket
suffix:semicolon
id|sbalf15
op_assign
id|buffer-&gt;element
(braket
l_int|15
)braket
dot
id|flags
op_amp
l_int|0xff
suffix:semicolon
id|error
op_assign
id|qeth_determine_send_error
c_func
(paren
id|siga_error
comma
id|qdio_error
comma
id|sbalf15
)paren
suffix:semicolon
r_if
c_cond
(paren
id|error
op_eq
id|ERROR_KICK_THAT_PUPPY
)paren
(brace
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;KP%s%2x&quot;
comma
id|CARD_BUS_ID
c_func
(paren
id|card
)paren
comma
id|queue
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|qerr
comma
id|dbf_text
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|1
comma
id|setup
comma
id|dbf_text
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%2x%2x%2x%2x&quot;
comma
id|bufno
comma
id|siga_error
comma
id|qdio_error
comma
id|sbalf15
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|1
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|1
comma
id|qerr
comma
id|dbf_text
)paren
suffix:semicolon
id|PRINT_ERR
c_func
(paren
l_string|&quot;Outbound queue x%x on device %s (%s); &quot;
l_string|&quot;errs: siga: x%x, qdio: x%x, flags15: &quot;
l_string|&quot;x%x. The device will be taken down.&bslash;n&quot;
comma
id|queue
comma
id|CARD_BUS_ID
c_func
(paren
id|card
)paren
comma
id|card-&gt;dev_name
comma
id|siga_error
comma
id|qdio_error
comma
id|sbalf15
)paren
suffix:semicolon
id|netif_stop_queue
c_func
(paren
id|card-&gt;dev
)paren
suffix:semicolon
id|qeth_set_dev_flag_norunning
c_func
(paren
id|card
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;problem
comma
id|PROBLEM_BAD_SIGA_RESULT
)paren
suffix:semicolon
id|qeth_schedule_recovery
c_func
(paren
id|card
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|error
op_eq
id|ERROR_RETRY
)paren
(brace
multiline_comment|/* analyze, how many retries we did so far */
id|retries
op_assign
id|card-&gt;send_retries
(braket
id|queue
)braket
(braket
id|bufno
)braket
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;Rt%s%2x&quot;
comma
id|CARD_BUS_ID
c_func
(paren
id|card
)paren
comma
id|queue
)paren
suffix:semicolon
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;b%2x:%2x%2x&quot;
comma
id|bufno
comma
id|sbalf15
comma
id|retries
)paren
suffix:semicolon
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
r_if
c_cond
(paren
op_increment
id|retries
OG
id|SEND_RETRIES_ALLOWED
)paren
(brace
id|error
op_assign
id|ERROR_LINK_FAILURE
suffix:semicolon
id|QETH_DBF_TEXT4
c_func
(paren
l_int|1
comma
id|trace
comma
l_string|&quot;ndegelnd&quot;
)paren
suffix:semicolon
)brace
multiline_comment|/* else error stays RETRY for the switch statemnet */
)brace
r_else
r_if
c_cond
(paren
id|error
op_eq
id|ERROR_LINK_FAILURE
)paren
(brace
multiline_comment|/* we don&squot;t want to log failures resulting from&n;&t;&t;&t; * too many retries */
id|QETH_DBF_CARD3
c_func
(paren
l_int|1
comma
id|trace
comma
l_string|&quot;Fail&quot;
comma
id|card
)paren
suffix:semicolon
id|QETH_DBF_HEX3
c_func
(paren
l_int|0
comma
id|misc
comma
id|buffer
comma
id|QETH_DBF_MISC_LEN
)paren
suffix:semicolon
id|QETH_DBF_HEX3
c_func
(paren
l_int|0
comma
id|misc
comma
id|buffer
op_plus
id|QETH_DBF_MISC_LEN
comma
id|QETH_DBF_MISC_LEN
)paren
suffix:semicolon
)brace
r_while
c_loop
(paren
(paren
id|skb
op_assign
id|skb_dequeue
c_func
(paren
op_amp
id|card-&gt;outbound_ringbuffer
(braket
id|queue
)braket
op_member_access_from_pointer
id|ringbuf_element
(braket
id|bufno
)braket
dot
id|skb_list
)paren
)paren
)paren
(brace
r_switch
c_cond
(paren
id|error
)paren
(brace
r_case
id|ERROR_NONE
suffix:colon
id|atomic_dec
c_func
(paren
op_amp
id|skb-&gt;users
)paren
suffix:semicolon
id|dev_kfree_skb_irq
c_func
(paren
id|skb
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ERROR_RETRY
suffix:colon
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|qerr
comma
l_string|&quot;RETRY!!!&quot;
)paren
suffix:semicolon
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;RETRY!!!&quot;
)paren
suffix:semicolon
id|atomic_dec
c_func
(paren
op_amp
id|skb-&gt;users
)paren
suffix:semicolon
multiline_comment|/* retry packet async (quickly) ... */
id|atomic_dec
c_func
(paren
op_amp
id|skb-&gt;users
)paren
suffix:semicolon
id|dev_kfree_skb_irq
c_func
(paren
id|skb
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ERROR_LINK_FAILURE
suffix:colon
r_case
id|ERROR_KICK_THAT_PUPPY
suffix:colon
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;endeglnd&quot;
)paren
suffix:semicolon
id|atomic_dec
c_func
(paren
op_amp
id|skb-&gt;users
)paren
suffix:semicolon
id|dev_kfree_skb_irq
c_func
(paren
id|skb
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_break
suffix:semicolon
r_default
suffix:colon
id|PRINT_WARN
c_func
(paren
l_string|&quot;oops... wrong send_state on %s. &quot;
l_string|&quot;shouldn&squot;t happen &quot;
l_string|&quot;(line %i). q=%i, bufno=x%x, state=%i&bslash;n&quot;
comma
id|card-&gt;dev_name
comma
id|__LINE__
comma
id|queue
comma
id|bufno
comma
id|card-&gt;outbound_buffer_send_state
(braket
id|queue
)braket
(braket
id|bufno
)braket
)paren
suffix:semicolon
id|QETH_DBF_CARD0
c_func
(paren
l_int|1
comma
id|trace
comma
l_string|&quot;UPSf&quot;
comma
id|card
)paren
suffix:semicolon
id|QETH_DBF_CARD0
c_func
(paren
l_int|1
comma
id|qerr
comma
l_string|&quot;UPSf&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%2x%2x%4x&quot;
comma
id|queue
comma
id|bufno
comma
id|card-&gt;outbound_buffer_send_state
(braket
id|queue
)braket
(braket
id|bufno
)braket
)paren
suffix:semicolon
id|QETH_DBF_TEXT0
c_func
(paren
l_int|1
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|QETH_DBF_TEXT0
c_func
(paren
l_int|1
comma
id|qerr
comma
id|dbf_text
)paren
suffix:semicolon
)brace
id|card-&gt;outbound_buffer_send_state
(braket
id|queue
)braket
(braket
id|bufno
)braket
op_assign
id|SEND_STATE_INACTIVE
suffix:semicolon
id|card-&gt;send_retries
(braket
id|queue
)braket
(braket
id|bufno
)braket
op_assign
l_int|0
suffix:semicolon
)brace
r_static
r_inline
r_void
DECL|function|qeth_free_all_skbs
id|qeth_free_all_skbs
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_int
id|q
comma
id|b
suffix:semicolon
r_for
c_loop
(paren
id|q
op_assign
l_int|0
suffix:semicolon
id|q
OL
id|card-&gt;no_queues
suffix:semicolon
id|q
op_increment
)paren
r_for
c_loop
(paren
id|b
op_assign
l_int|0
suffix:semicolon
id|b
OL
id|QDIO_MAX_BUFFERS_PER_Q
suffix:semicolon
id|b
op_increment
)paren
r_if
c_cond
(paren
id|card-&gt;outbound_buffer_send_state
(braket
id|q
)braket
(braket
id|b
)braket
op_ne
id|SEND_STATE_INACTIVE
)paren
id|qeth_free_buffer
c_func
(paren
id|card
comma
id|q
comma
id|b
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
)brace
r_static
r_inline
r_void
DECL|function|qeth_flush_buffer
id|qeth_flush_buffer
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_int
id|queue
comma
r_int
id|under_int
)paren
(brace
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
id|QETH_DBF_CARD5
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;flsb&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%2x%2x%2x&quot;
comma
id|queue
comma
id|under_int
comma
id|card-&gt;outbound_buffer_send_state
(braket
id|queue
)braket
(braket
id|card-&gt;outbound_first_free_buffer
(braket
id|queue
)braket
)braket
)paren
suffix:semicolon
id|QETH_DBF_TEXT5
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|card-&gt;outbound_buffer_send_state
(braket
id|queue
)braket
(braket
id|card-&gt;outbound_first_free_buffer
(braket
id|queue
)braket
)braket
)paren
(brace
r_case
id|SEND_STATE_DONT_PACK
suffix:colon
r_break
suffix:semicolon
r_case
id|SEND_STATE_PACK
suffix:colon
id|qeth_flush_packed_packets
c_func
(paren
id|card
comma
id|queue
comma
id|under_int
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_break
suffix:semicolon
)brace
)brace
macro_line|#ifdef QETH_VLAN
r_static
r_inline
r_void
DECL|function|qeth_insert_ipv6_vlan_tag
id|qeth_insert_ipv6_vlan_tag
c_func
(paren
r_struct
id|sk_buff
op_star
id|__skb
)paren
(brace
multiline_comment|/* Move the mac addresses to the beginning of the new header.&n;&t; * We are using three memcpys instead of one memmove to save cycles.&n;&t; */
DECL|macro|TMP_CPYSIZE
mdefine_line|#define TMP_CPYSIZE 4
id|__u16
op_star
id|tag
suffix:semicolon
id|tag
op_assign
(paren
id|__u16
op_star
)paren
id|skb_push
c_func
(paren
id|__skb
comma
id|VLAN_HLEN
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|__skb-&gt;data
comma
id|__skb-&gt;data
op_plus
id|TMP_CPYSIZE
comma
id|TMP_CPYSIZE
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|__skb-&gt;data
op_plus
id|TMP_CPYSIZE
comma
id|__skb-&gt;data
op_plus
(paren
l_int|2
op_star
id|TMP_CPYSIZE
)paren
comma
id|TMP_CPYSIZE
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|__skb-&gt;data
op_plus
(paren
l_int|2
op_star
id|TMP_CPYSIZE
)paren
comma
id|__skb-&gt;data
op_plus
(paren
l_int|3
op_star
id|TMP_CPYSIZE
)paren
comma
id|TMP_CPYSIZE
)paren
suffix:semicolon
id|tag
op_assign
(paren
id|__u16
op_star
)paren
(paren
id|__skb-&gt;data
op_plus
(paren
l_int|3
op_star
id|TMP_CPYSIZE
)paren
)paren
suffix:semicolon
multiline_comment|/*first two bytes  = ETH_P_8021Q (0x8100)&n;&t; *second two bytes = VLANID&n;&t; */
op_star
id|tag
op_assign
id|__constant_htons
c_func
(paren
id|ETH_P_8021Q
)paren
suffix:semicolon
op_star
(paren
id|tag
op_plus
l_int|1
)paren
op_assign
id|vlan_tx_tag_get
c_func
(paren
id|__skb
)paren
suffix:semicolon
op_star
(paren
id|tag
op_plus
l_int|1
)paren
op_assign
id|htons
c_func
(paren
op_star
(paren
id|tag
op_plus
l_int|1
)paren
)paren
suffix:semicolon
DECL|macro|TMP_CPYSIZE
macro_line|#undef TMP_CPYSIZE
)brace
macro_line|#endif
r_static
r_inline
r_void
DECL|function|__qeth_add_vlan_tag
id|__qeth_add_vlan_tag
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_struct
id|sk_buff
op_star
id|skb
comma
r_int
id|version
)paren
(brace
macro_line|#ifdef QETH_VLAN
r_if
c_cond
(paren
(paren
id|card-&gt;vlangrp
op_ne
l_int|NULL
)paren
op_logical_and
id|vlan_tx_tag_present
c_func
(paren
id|skb
)paren
op_logical_and
(paren
id|version
op_eq
l_int|6
)paren
)paren
(brace
id|qeth_insert_ipv6_vlan_tag
c_func
(paren
id|skb
)paren
suffix:semicolon
)brace
macro_line|#endif
)brace
r_static
r_inline
r_void
DECL|function|qeth_send_packet_fast
id|qeth_send_packet_fast
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|net_device
op_star
id|dev
comma
r_int
id|queue
comma
r_int
id|version
comma
r_int
id|multicast
)paren
(brace
r_struct
id|qeth_ringbuffer_element
op_star
id|mybuffer
suffix:semicolon
r_int
id|position
suffix:semicolon
r_struct
id|qeth_hdr
op_star
id|hdr
suffix:semicolon
r_char
op_star
id|dataptr
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_struct
id|sk_buff
op_star
id|nskb
suffix:semicolon
id|position
op_assign
id|card-&gt;outbound_first_free_buffer
(braket
id|queue
)braket
suffix:semicolon
id|card-&gt;outbound_buffer_send_state
(braket
id|queue
)braket
(braket
id|position
)braket
op_assign
id|SEND_STATE_DONT_PACK
suffix:semicolon
id|mybuffer
op_assign
op_amp
id|card-&gt;outbound_ringbuffer
(braket
id|queue
)braket
op_member_access_from_pointer
id|ringbuf_element
(braket
id|position
)braket
suffix:semicolon
r_if
c_cond
(paren
id|skb_headroom
c_func
(paren
id|skb
)paren
OL
id|QETH_HEADER_SIZE
)paren
(brace
r_if
c_cond
(paren
(paren
id|version
)paren
op_logical_and
(paren
op_logical_neg
id|card-&gt;realloc_message
)paren
)paren
(brace
id|card-&gt;realloc_message
op_assign
l_int|1
suffix:semicolon
id|PRINT_WARN
c_func
(paren
l_string|&quot;%s: not enough headroom in skb. &quot;
l_string|&quot;Increasing the &quot;
l_string|&quot;add_hhlen parameter by %i may help.&bslash;n&quot;
comma
id|card-&gt;dev_name
comma
id|QETH_HEADER_SIZE
op_minus
id|skb_headroom
c_func
(paren
id|skb
)paren
)paren
suffix:semicolon
)brace
id|PRINT_STUPID
c_func
(paren
l_string|&quot;%s: not enough headroom in skb (missing: %i)&bslash;n&quot;
comma
id|card-&gt;dev_name
comma
id|QETH_HEADER_SIZE
op_minus
id|skb_headroom
c_func
(paren
id|skb
)paren
)paren
suffix:semicolon
id|QETH_DBF_CARD3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;NHRf&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%2x%2x%2x%2x&quot;
comma
id|skb_headroom
c_func
(paren
id|skb
)paren
comma
id|version
comma
id|multicast
comma
id|queue
)paren
suffix:semicolon
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|QETH_DBF_HEX3
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|skb-&gt;head
comma
r_sizeof
(paren
r_void
op_star
)paren
)paren
suffix:semicolon
id|QETH_DBF_HEX3
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|skb-&gt;data
comma
r_sizeof
(paren
r_void
op_star
)paren
)paren
suffix:semicolon
id|nskb
op_assign
id|skb_realloc_headroom
c_func
(paren
id|skb
comma
id|QETH_HEADER_SIZE
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|nskb
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;%s: could not realloc headroom&bslash;n&quot;
comma
id|card-&gt;dev_name
)paren
suffix:semicolon
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;CNRf&quot;
comma
id|card
)paren
suffix:semicolon
id|dev_kfree_skb_irq
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|dev_kfree_skb_irq
c_func
(paren
id|skb
)paren
suffix:semicolon
id|skb
op_assign
id|nskb
suffix:semicolon
)brace
id|__qeth_add_vlan_tag
c_func
(paren
id|card
comma
id|skb
comma
id|version
)paren
suffix:semicolon
id|hdr
op_assign
(paren
r_struct
id|qeth_hdr
op_star
)paren
(paren
id|skb_push
c_func
(paren
id|skb
comma
id|QETH_HEADER_SIZE
)paren
)paren
suffix:semicolon
multiline_comment|/* &n;&t; * sanity check, the Linux memory allocation scheme should&n;&t; * never present us cases like this one (the 32bytes header plus&n;&t; * the first 40 bytes of the paket cross a 4k boundary)&n;&t; */
id|dataptr
op_assign
(paren
r_char
op_star
)paren
id|hdr
suffix:semicolon
r_if
c_cond
(paren
(paren
(paren
(paren
r_int
r_int
)paren
id|dataptr
)paren
op_amp
(paren
op_complement
(paren
id|PAGE_SIZE
op_minus
l_int|1
)paren
)paren
)paren
op_ne
(paren
(paren
(paren
r_int
r_int
)paren
id|dataptr
op_plus
id|QETH_HEADER_SIZE
op_plus
id|QETH_IP_HEADER_SIZE
)paren
op_amp
(paren
op_complement
(paren
id|PAGE_SIZE
op_minus
l_int|1
)paren
)paren
)paren
)paren
(brace
id|PRINT_ERR
c_func
(paren
l_string|&quot;%s: packet misaligned -- the first %i bytes &quot;
l_string|&quot;are not in the same page. Discarding packet!&bslash;n&quot;
comma
id|card-&gt;dev_name
comma
id|QETH_HEADER_SIZE
op_plus
id|QETH_IP_HEADER_SIZE
)paren
suffix:semicolon
id|PRINT_ERR
c_func
(paren
l_string|&quot;head=%p, data=%p&bslash;n&quot;
comma
id|skb-&gt;head
comma
id|skb-&gt;data
)paren
suffix:semicolon
id|QETH_DBF_CARD1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;PMAf&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%2x%2x%2x%2x&quot;
comma
id|skb_headroom
c_func
(paren
id|skb
)paren
comma
id|version
comma
id|multicast
comma
id|queue
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|QETH_DBF_HEX1
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|skb-&gt;head
comma
r_sizeof
(paren
r_void
op_star
)paren
)paren
suffix:semicolon
id|QETH_DBF_HEX1
c_func
(paren
l_int|1
comma
id|trace
comma
op_amp
id|skb-&gt;data
comma
r_sizeof
(paren
r_void
op_star
)paren
)paren
suffix:semicolon
id|dev_kfree_skb_irq
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|atomic_inc
c_func
(paren
op_amp
id|skb-&gt;users
)paren
suffix:semicolon
id|skb_queue_tail
c_func
(paren
op_amp
id|mybuffer-&gt;skb_list
comma
id|skb
)paren
suffix:semicolon
id|qeth_fill_header
c_func
(paren
id|hdr
comma
id|skb
comma
id|version
comma
id|multicast
)paren
suffix:semicolon
multiline_comment|/* we need to write to next_element_to_fill as&n;&t;   qeth_flush_packed_packets checks it */
id|card-&gt;outbound_ringbuffer
(braket
id|queue
)braket
op_member_access_from_pointer
id|ringbuf_element
(braket
id|position
)braket
dot
id|next_element_to_fill
op_assign
id|qeth_fill_buffer
c_func
(paren
op_amp
id|card-&gt;outbound_ringbuffer
(braket
id|queue
)braket
op_member_access_from_pointer
id|buffer
(braket
id|position
)braket
comma
(paren
r_char
op_star
)paren
id|hdr
comma
id|skb-&gt;len
comma
l_int|0
)paren
suffix:semicolon
macro_line|#ifdef QETH_PERFORMANCE_STATS
id|card-&gt;perf_stats.skbs_sent_dont_pack
op_increment
suffix:semicolon
macro_line|#endif /* QETH_PERFORMANCE_STATS */
id|qeth_flush_packed_packets
c_func
(paren
id|card
comma
id|queue
comma
l_int|0
)paren
suffix:semicolon
)brace
multiline_comment|/* no checks, if all elements are used, as then we would not be here (at most&n;   127 buffers are enqueued) */
r_static
r_inline
r_void
DECL|function|qeth_send_packet_packed
id|qeth_send_packet_packed
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|net_device
op_star
id|dev
comma
r_int
id|queue
comma
r_int
id|version
comma
r_int
id|multicast
)paren
(brace
r_struct
id|qeth_ringbuffer_element
op_star
id|mybuffer
suffix:semicolon
r_int
id|elements_needed
suffix:semicolon
r_int
id|element_to_fill
suffix:semicolon
r_int
id|buffer_no
suffix:semicolon
r_int
id|length
suffix:semicolon
r_char
op_star
id|dataptr
suffix:semicolon
r_struct
id|qeth_hdr
op_star
id|hdr
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_struct
id|sk_buff
op_star
id|nskb
suffix:semicolon
multiline_comment|/* sanity check, dev-&gt;hard_header_len should prevent this */
r_if
c_cond
(paren
id|skb_headroom
c_func
(paren
id|skb
)paren
OL
id|QETH_HEADER_SIZE
)paren
(brace
r_if
c_cond
(paren
(paren
id|version
)paren
op_logical_and
(paren
op_logical_neg
id|card-&gt;realloc_message
)paren
)paren
(brace
id|card-&gt;realloc_message
op_assign
l_int|1
suffix:semicolon
id|PRINT_WARN
c_func
(paren
l_string|&quot;%s: not enough headroom in skb. &quot;
l_string|&quot;Try increasing the &quot;
l_string|&quot;add_hhlen parameter by %i.&bslash;n&quot;
comma
id|card-&gt;dev_name
comma
id|QETH_HEADER_SIZE
op_minus
id|skb_headroom
c_func
(paren
id|skb
)paren
)paren
suffix:semicolon
)brace
id|PRINT_STUPID
c_func
(paren
l_string|&quot;%s: not enough headroom in skb (missing: %i)&bslash;n&quot;
comma
id|card-&gt;dev_name
comma
id|QETH_HEADER_SIZE
op_minus
id|skb_headroom
c_func
(paren
id|skb
)paren
)paren
suffix:semicolon
id|QETH_DBF_CARD3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;NHRp&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%2x%2x%2x%2x&quot;
comma
id|skb_headroom
c_func
(paren
id|skb
)paren
comma
id|version
comma
id|multicast
comma
id|queue
)paren
suffix:semicolon
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|QETH_DBF_HEX3
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|skb-&gt;head
comma
r_sizeof
(paren
r_void
op_star
)paren
)paren
suffix:semicolon
id|QETH_DBF_HEX3
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|skb-&gt;data
comma
r_sizeof
(paren
r_void
op_star
)paren
)paren
suffix:semicolon
id|nskb
op_assign
id|skb_realloc_headroom
c_func
(paren
id|skb
comma
id|QETH_HEADER_SIZE
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|nskb
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;%s: could not realloc headroom&bslash;n&quot;
comma
id|card-&gt;dev_name
)paren
suffix:semicolon
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;CNRp&quot;
comma
id|card
)paren
suffix:semicolon
id|dev_kfree_skb_irq
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|dev_kfree_skb_irq
c_func
(paren
id|skb
)paren
suffix:semicolon
id|skb
op_assign
id|nskb
suffix:semicolon
)brace
id|__qeth_add_vlan_tag
c_func
(paren
id|card
comma
id|skb
comma
id|version
)paren
suffix:semicolon
id|hdr
op_assign
(paren
r_struct
id|qeth_hdr
op_star
)paren
(paren
id|skb_push
c_func
(paren
id|skb
comma
id|QETH_HEADER_SIZE
)paren
)paren
suffix:semicolon
id|length
op_assign
id|skb-&gt;len
suffix:semicolon
multiline_comment|/* &n;&t; * sanity check, the Linux memory allocation scheme should&n;&t; * never present us cases like this one (the 32bytes header plus&n;&t; * the first 40 bytes of the paket cross a 4k boundary)&n;&t; */
id|dataptr
op_assign
(paren
r_char
op_star
)paren
id|hdr
suffix:semicolon
r_if
c_cond
(paren
(paren
(paren
(paren
r_int
r_int
)paren
id|dataptr
)paren
op_amp
(paren
op_complement
(paren
id|PAGE_SIZE
op_minus
l_int|1
)paren
)paren
)paren
op_ne
(paren
(paren
(paren
r_int
r_int
)paren
id|dataptr
op_plus
id|QETH_HEADER_SIZE
op_plus
id|QETH_IP_HEADER_SIZE
)paren
op_amp
(paren
op_complement
(paren
id|PAGE_SIZE
op_minus
l_int|1
)paren
)paren
)paren
)paren
(brace
id|PRINT_ERR
c_func
(paren
l_string|&quot;%s: packet misaligned -- the first %i bytes &quot;
l_string|&quot;are not in the same page. Discarding packet!&bslash;n&quot;
comma
id|card-&gt;dev_name
comma
id|QETH_HEADER_SIZE
op_plus
id|QETH_IP_HEADER_SIZE
)paren
suffix:semicolon
id|QETH_DBF_CARD1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;PMAp&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%2x%2x%2x%2x&quot;
comma
id|skb_headroom
c_func
(paren
id|skb
)paren
comma
id|version
comma
id|multicast
comma
id|queue
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|QETH_DBF_HEX1
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|skb-&gt;head
comma
r_sizeof
(paren
r_void
op_star
)paren
)paren
suffix:semicolon
id|QETH_DBF_HEX1
c_func
(paren
l_int|1
comma
id|trace
comma
op_amp
id|skb-&gt;data
comma
r_sizeof
(paren
r_void
op_star
)paren
)paren
suffix:semicolon
id|dev_kfree_skb_irq
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|buffer_no
op_assign
id|card-&gt;outbound_first_free_buffer
(braket
id|queue
)braket
suffix:semicolon
id|element_to_fill
op_assign
id|card-&gt;outbound_ringbuffer
(braket
id|queue
)braket
op_member_access_from_pointer
id|ringbuf_element
(braket
id|buffer_no
)braket
dot
id|next_element_to_fill
suffix:semicolon
id|elements_needed
op_assign
l_int|1
op_plus
(paren
(paren
(paren
(paren
(paren
r_int
r_int
)paren
id|dataptr
)paren
op_amp
(paren
id|PAGE_SIZE
op_minus
l_int|1
)paren
)paren
op_plus
id|length
)paren
op_rshift
id|PAGE_SHIFT
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|elements_needed
OG
(paren
id|QDIO_MAX_ELEMENTS_PER_BUFFER
op_minus
id|element_to_fill
)paren
)paren
op_logical_or
(paren
(paren
id|elements_needed
op_eq
(paren
id|QDIO_MAX_ELEMENTS_PER_BUFFER
op_minus
id|element_to_fill
)paren
)paren
op_logical_and
(paren
(paren
id|element_to_fill
op_rshift
id|PAGE_SHIFT
)paren
op_eq
id|card-&gt;outbound_bytes_in_buffer
(braket
id|queue
)braket
)paren
)paren
)paren
(brace
id|qeth_flush_packed_packets
c_func
(paren
id|card
comma
id|queue
comma
l_int|0
)paren
suffix:semicolon
id|element_to_fill
op_assign
l_int|0
suffix:semicolon
id|card-&gt;outbound_bytes_in_buffer
(braket
id|queue
)braket
op_assign
l_int|0
suffix:semicolon
id|buffer_no
op_assign
(paren
id|buffer_no
op_plus
l_int|1
)paren
op_amp
(paren
id|QDIO_MAX_BUFFERS_PER_Q
op_minus
l_int|1
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|element_to_fill
)paren
id|card-&gt;outbound_buffer_send_state
(braket
id|queue
)braket
(braket
id|buffer_no
)braket
op_assign
id|SEND_STATE_PACK
suffix:semicolon
macro_line|#ifdef QETH_PERFORMANCE_STATS
id|card-&gt;perf_stats.skbs_sent_pack
op_increment
suffix:semicolon
macro_line|#endif /* QETH_PERFORMANCE_STATS */
id|mybuffer
op_assign
op_amp
id|card-&gt;outbound_ringbuffer
(braket
id|queue
)braket
op_member_access_from_pointer
id|ringbuf_element
(braket
id|buffer_no
)braket
suffix:semicolon
id|atomic_inc
c_func
(paren
op_amp
id|skb-&gt;users
)paren
suffix:semicolon
id|skb_queue_tail
c_func
(paren
op_amp
id|mybuffer-&gt;skb_list
comma
id|skb
)paren
suffix:semicolon
id|qeth_fill_header
c_func
(paren
id|hdr
comma
id|skb
comma
id|version
comma
id|multicast
)paren
suffix:semicolon
id|card-&gt;outbound_bytes_in_buffer
(braket
id|queue
)braket
op_add_assign
id|length
op_plus
id|QETH_HEADER_SIZE
suffix:semicolon
id|card-&gt;outbound_ringbuffer
(braket
id|queue
)braket
op_member_access_from_pointer
id|ringbuf_element
(braket
id|buffer_no
)braket
dot
id|next_element_to_fill
op_assign
id|qeth_fill_buffer
c_func
(paren
op_amp
id|card-&gt;outbound_ringbuffer
(braket
id|queue
)braket
op_member_access_from_pointer
id|buffer
(braket
id|buffer_no
)braket
comma
id|dataptr
comma
id|length
comma
id|element_to_fill
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_alloc_spare_bufs
id|qeth_alloc_spare_bufs
c_func
(paren
r_void
)paren
(brace
r_int
id|i
suffix:semicolon
r_int
id|dont_alloc_more
op_assign
l_int|0
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
id|sparebuffer_count
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|qeth_sparebufs
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|dont_alloc_more
)paren
(brace
id|sparebufs
(braket
id|i
)braket
dot
id|buf
op_assign
(paren
r_char
op_star
)paren
id|kmalloc
c_func
(paren
id|DEFAULT_BUFFER_SIZE
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|sparebufs
(braket
id|i
)braket
dot
id|buf
)paren
id|sparebuffer_count
op_increment
suffix:semicolon
r_else
id|dont_alloc_more
op_assign
l_int|1
suffix:semicolon
)brace
id|atomic_set
c_func
(paren
op_amp
id|sparebufs
(braket
id|i
)braket
dot
id|status
comma
(paren
id|dont_alloc_more
)paren
ques
c_cond
id|SPAREBUF_UNAVAIL
suffix:colon
id|SPAREBUF_FREE
)paren
suffix:semicolon
)brace
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;alspb%3x&quot;
comma
id|sparebuffer_count
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|PRINT_INFO
c_func
(paren
l_string|&quot;allocated %i spare buffers&bslash;n&quot;
comma
id|sparebuffer_count
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_free_all_spare_bufs
id|qeth_free_all_spare_bufs
c_func
(paren
r_void
)paren
(brace
r_int
id|i
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;frealspb&quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|qeth_sparebufs
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|sparebufs
(braket
id|i
)braket
dot
id|status
)paren
op_ne
id|SPAREBUF_UNAVAIL
)paren
(brace
id|kfree
c_func
(paren
id|sparebufs
(braket
id|i
)braket
dot
id|buf
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|sparebufs
(braket
id|i
)braket
dot
id|status
comma
id|SPAREBUF_UNAVAIL
)paren
suffix:semicolon
)brace
)brace
r_static
r_inline
r_void
DECL|function|__qeth_dump_packet_info
id|__qeth_dump_packet_info
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_int
id|version
comma
r_int
id|multicast
comma
r_int
id|queue
)paren
(brace
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
id|QETH_DBF_CARD6
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;dsp:&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%c %c%4x&quot;
comma
(paren
id|version
op_eq
l_int|4
)paren
ques
c_cond
l_char|&squot;4&squot;
suffix:colon
(paren
(paren
id|version
op_eq
l_int|6
)paren
ques
c_cond
l_char|&squot;6&squot;
suffix:colon
l_char|&squot;0&squot;
)paren
comma
(paren
id|multicast
)paren
ques
c_cond
l_char|&squot;m&squot;
suffix:colon
l_char|&squot;_&squot;
comma
id|queue
)paren
suffix:semicolon
id|QETH_DBF_TEXT6
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x%4x&quot;
comma
id|card-&gt;outbound_first_free_buffer
(braket
id|queue
)braket
comma
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;outbound_used_buffers
(braket
id|queue
)braket
)paren
)paren
suffix:semicolon
id|QETH_DBF_TEXT6
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
r_if
c_cond
(paren
id|qeth_sbal_packing_on_card
c_func
(paren
id|card-&gt;type
)paren
)paren
(brace
r_switch
c_cond
(paren
id|card-&gt;send_state
(braket
id|queue
)braket
)paren
(brace
r_case
id|SEND_STATE_DONT_PACK
suffix:colon
id|QETH_DBF_TEXT6
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;usngfast&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SEND_STATE_PACK
suffix:colon
id|QETH_DBF_TEXT6
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;usngpack&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_else
(brace
id|QETH_DBF_TEXT6
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;usngfast&quot;
)paren
suffix:semicolon
)brace
)brace
r_static
r_inline
r_void
DECL|function|__qeth_switch_state_if_needed
id|__qeth_switch_state_if_needed
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_int
id|queue
)paren
(brace
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;outbound_used_buffers
(braket
id|queue
)braket
)paren
op_ge
id|HIGH_WATERMARK_PACK
)paren
(brace
id|card-&gt;send_state
(braket
id|queue
)braket
op_assign
id|SEND_STATE_PACK
suffix:semicolon
id|QETH_DBF_CARD3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;stchup&quot;
comma
id|card
)paren
suffix:semicolon
macro_line|#ifdef QETH_PERFORMANCE_STATS
id|card-&gt;perf_stats.sc_dp_p
op_increment
suffix:semicolon
macro_line|#endif /* QETH_PERFORMANCE_STATS */
)brace
)brace
r_static
r_inline
r_int
DECL|function|qeth_do_send_packet
id|qeth_do_send_packet
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_int
id|queue
comma
id|result
op_assign
l_int|0
suffix:semicolon
r_int
id|multicast
comma
id|version
suffix:semicolon
id|version
op_assign
id|QETH_IP_VERSION
c_func
(paren
id|skb
)paren
suffix:semicolon
id|multicast
op_assign
id|qeth_is_multicast_skb_at_all
c_func
(paren
id|skb
comma
id|version
)paren
suffix:semicolon
id|queue
op_assign
id|qeth_get_prioqueue
c_func
(paren
id|card
comma
id|skb
comma
id|multicast
comma
id|version
)paren
suffix:semicolon
id|__qeth_dump_packet_info
c_func
(paren
id|card
comma
id|version
comma
id|multicast
comma
id|queue
)paren
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;outbound_used_buffers
(braket
id|queue
)braket
)paren
op_ge
id|QDIO_MAX_BUFFERS_PER_Q
op_minus
l_int|1
)paren
(brace
id|QETH_DBF_CARD2
c_func
(paren
l_int|1
comma
id|trace
comma
l_string|&quot;cdbs&quot;
comma
id|card
)paren
suffix:semicolon
id|netif_stop_queue
c_func
(paren
id|dev
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
multiline_comment|/* &n;&t; * we are not called under int, so we just spin&n;&t; * happens around once a second under heavy traffic. takes a little&n;&t; * bit less than 10usec in avg. on a z900&n;&t; */
r_if
c_cond
(paren
id|atomic_compare_and_swap
c_func
(paren
id|QETH_LOCK_UNLOCKED
comma
id|QETH_LOCK_NORMAL
comma
op_amp
id|card-&gt;outbound_ringbuffer_lock
(braket
id|queue
)braket
)paren
)paren
(brace
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;SPIN&quot;
comma
id|card
)paren
suffix:semicolon
r_while
c_loop
(paren
id|atomic_compare_and_swap
(paren
id|QETH_LOCK_UNLOCKED
comma
id|QETH_LOCK_NORMAL
comma
op_amp
id|card-&gt;outbound_ringbuffer_lock
(braket
id|queue
)braket
)paren
)paren
suffix:semicolon
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;spin&quot;
comma
id|card
)paren
suffix:semicolon
)brace
macro_line|#ifdef QETH_PERFORMANCE_STATS
id|card-&gt;perf_stats.skbs_sent
op_increment
suffix:semicolon
macro_line|#endif /* QETH_PERFORMANCE_STATS */
r_if
c_cond
(paren
id|qeth_sbal_packing_on_card
c_func
(paren
id|card-&gt;type
)paren
)paren
(brace
r_switch
c_cond
(paren
id|card-&gt;send_state
(braket
id|queue
)braket
)paren
(brace
r_case
id|SEND_STATE_DONT_PACK
suffix:colon
id|qeth_send_packet_fast
c_func
(paren
id|card
comma
id|skb
comma
id|dev
comma
id|queue
comma
id|version
comma
id|multicast
)paren
suffix:semicolon
id|__qeth_switch_state_if_needed
c_func
(paren
id|card
comma
id|queue
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SEND_STATE_PACK
suffix:colon
id|qeth_send_packet_packed
c_func
(paren
id|card
comma
id|skb
comma
id|dev
comma
id|queue
comma
id|version
comma
id|multicast
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|result
op_assign
op_minus
id|EBUSY
suffix:semicolon
id|QETH_DBF_CARD0
c_func
(paren
l_int|1
comma
id|trace
comma
l_string|&quot;UPSs&quot;
comma
id|card
)paren
suffix:semicolon
id|PRINT_ALL
c_func
(paren
l_string|&quot;oops... shouldn&squot;t happen (line %i:%i).&bslash;n&quot;
comma
id|__LINE__
comma
id|card-&gt;send_state
(braket
id|queue
)braket
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
id|qeth_send_packet_fast
c_func
(paren
id|card
comma
id|skb
comma
id|dev
comma
id|queue
comma
id|version
comma
id|multicast
)paren
suffix:semicolon
)brace
multiline_comment|/* ATOMIC: (NORMAL-&gt;UNLOCKED, FLUSH-&gt;NORMAL) */
r_while
c_loop
(paren
id|atomic_dec_return
c_func
(paren
op_amp
id|card-&gt;outbound_ringbuffer_lock
(braket
id|queue
)braket
)paren
)paren
(brace
id|qeth_flush_buffer
c_func
(paren
id|card
comma
id|queue
comma
l_int|0
)paren
suffix:semicolon
id|card-&gt;send_state
(braket
id|queue
)braket
op_assign
id|SEND_STATE_DONT_PACK
suffix:semicolon
)brace
macro_line|#ifdef QETH_PERFORMANCE_STATS
id|card-&gt;perf_stats.outbound_time
op_add_assign
id|NOW
op_minus
id|card-&gt;perf_stats.outbound_start_time
suffix:semicolon
id|card-&gt;perf_stats.outbound_cnt
op_increment
suffix:semicolon
macro_line|#endif /* QETH_PERFORMANCE_STATS */
id|card-&gt;stats-&gt;tx_packets
op_increment
suffix:semicolon
id|card-&gt;stats-&gt;tx_bytes
op_add_assign
id|skb-&gt;len
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_hard_start_xmit
id|qeth_hard_start_xmit
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
r_int
id|result
suffix:semicolon
id|card
op_assign
(paren
r_struct
id|qeth_card
op_star
)paren
(paren
id|dev-&gt;priv
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb
op_eq
l_int|NULL
)paren
r_return
l_int|0
suffix:semicolon
id|QETH_DBF_HEX4
c_func
(paren
l_int|0
comma
id|data
comma
id|skb-&gt;data
comma
id|__max
c_func
(paren
id|QETH_DBF_DATA_LEN
comma
id|skb-&gt;len
)paren
)paren
suffix:semicolon
id|netif_stop_queue
c_func
(paren
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
(brace
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;XMNSNOCD&quot;
)paren
suffix:semicolon
id|dev_kfree_skb_irq
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#ifdef QETH_PERFORMANCE_STATS
id|card-&gt;perf_stats.outbound_start_time
op_assign
id|NOW
suffix:semicolon
macro_line|#endif /* QETH_PERFORMANCE_STATS */
r_if
c_cond
(paren
op_logical_neg
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_startlaned
)paren
)paren
(brace
id|card-&gt;stats-&gt;tx_carrier_errors
op_increment
suffix:semicolon
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;XMNS&quot;
comma
id|card
)paren
suffix:semicolon
id|dev_kfree_skb_irq
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|result
op_assign
id|qeth_do_send_packet
c_func
(paren
id|card
comma
id|skb
comma
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|result
)paren
id|netif_wake_queue
c_func
(paren
id|card-&gt;dev
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
r_static
r_struct
id|net_device_stats
op_star
DECL|function|qeth_get_stats
id|qeth_get_stats
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
id|card
op_assign
(paren
r_struct
id|qeth_card
op_star
)paren
(paren
id|dev-&gt;priv
)paren
suffix:semicolon
id|QETH_DBF_CARD3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;gtst&quot;
comma
id|card
)paren
suffix:semicolon
r_return
id|card-&gt;stats
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_change_mtu
id|qeth_change_mtu
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_int
id|new_mtu
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
id|card
op_assign
(paren
r_struct
id|qeth_card
op_star
)paren
(paren
id|dev-&gt;priv
)paren
suffix:semicolon
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;mtu&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%8x&quot;
comma
id|new_mtu
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
r_if
c_cond
(paren
id|new_mtu
OL
l_int|64
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|new_mtu
OG
l_int|65535
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
(paren
op_logical_neg
id|qeth_is_supported
c_func
(paren
id|IPA_IP_FRAGMENTATION
)paren
)paren
op_logical_and
(paren
op_logical_neg
id|qeth_mtu_is_valid
c_func
(paren
id|card
comma
id|new_mtu
)paren
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|dev-&gt;mtu
op_assign
id|new_mtu
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_start_softsetup_thread
id|qeth_start_softsetup_thread
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;shutdown_phase
)paren
)paren
(brace
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;stss&quot;
comma
id|card
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|card-&gt;softsetup_thread_sem
)paren
suffix:semicolon
)brace
)brace
r_static
r_int
DECL|function|qeth_sleepon
id|qeth_sleepon
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_int
id|timeout
)paren
(brace
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
id|QETH_DBF_CARD5
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;slpn&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%08x&quot;
comma
id|timeout
)paren
suffix:semicolon
id|QETH_DBF_TEXT5
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|wait_event_interruptible_timeout
c_func
(paren
id|card-&gt;wait_q
comma
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;data_has_arrived
)paren
comma
id|timeout
op_star
id|HZ
)paren
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;data_has_arrived
)paren
)paren
(brace
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;data_has_arrived
comma
l_int|0
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_return
op_minus
id|ETIME
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_wakeup_ioctl
id|qeth_wakeup_ioctl
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
id|QETH_DBF_CARD5
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;wkup&quot;
comma
id|card
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;ioctl_data_has_arrived
comma
l_int|1
)paren
suffix:semicolon
id|wake_up
c_func
(paren
op_amp
id|card-&gt;ioctl_wait_q
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_sleepon_ioctl
id|qeth_sleepon_ioctl
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_int
id|timeout
)paren
(brace
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
id|QETH_DBF_CARD5
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;ioctlslpn&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%08x&quot;
comma
id|timeout
)paren
suffix:semicolon
id|QETH_DBF_TEXT5
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|wait_event_interruptible_timeout
c_func
(paren
id|card-&gt;ioctl_wait_q
comma
id|atomic_read
c_func
(paren
op_amp
id|card
op_member_access_from_pointer
id|ioctl_data_has_arrived
)paren
comma
id|timeout
op_star
id|HZ
)paren
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;ioctl_data_has_arrived
)paren
)paren
(brace
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;ioctl_data_has_arrived
comma
l_int|0
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_return
op_minus
id|ETIME
suffix:semicolon
)brace
multiline_comment|/*SNMP IOCTL on Procfile */
r_static
r_void
DECL|function|qeth_wakeup_procfile
id|qeth_wakeup_procfile
c_func
(paren
r_void
)paren
(brace
id|QETH_DBF_TEXT5
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;procwkup&quot;
)paren
suffix:semicolon
multiline_comment|/* is this if statement correct? */
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|qeth_procfile_ioctl_sem.count
)paren
op_le
id|PROCFILE_SLEEP_SEM_MAX_VALUE
)paren
id|up
c_func
(paren
op_amp
id|qeth_procfile_ioctl_sem
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_sleepon_procfile
id|qeth_sleepon_procfile
c_func
(paren
r_void
)paren
(brace
id|QETH_DBF_TEXT5
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;procslp&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|down_interruptible
c_func
(paren
op_amp
id|qeth_procfile_ioctl_sem
)paren
)paren
(brace
r_return
op_minus
id|ERESTARTSYS
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* SNMP END */
r_static
r_char
op_star
DECL|function|qeth_send_control_data
id|qeth_send_control_data
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_int
r_char
op_star
id|buffer
comma
r_int
id|len
comma
r_int
r_int
id|intparam
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
r_int
id|result
comma
id|result2
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_int
r_char
op_star
id|rec_buf
suffix:semicolon
r_int
id|setip
op_assign
(paren
id|intparam
op_amp
id|IPA_SETIP_FLAG
)paren
ques
c_cond
l_int|1
suffix:colon
l_int|0
suffix:semicolon
id|again
suffix:colon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;shutdown_phase
)paren
op_eq
id|QETH_REMOVE_CARD_QUICK
)paren
r_return
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;escape_softsetup
)paren
)paren
r_return
l_int|NULL
suffix:semicolon
multiline_comment|/* we lock very early to synchronize access to seqnos */
r_if
c_cond
(paren
id|atomic_swap
c_func
(paren
op_amp
id|card-&gt;write_busy
comma
l_int|1
)paren
)paren
(brace
id|qeth_wait_nonbusy
c_func
(paren
id|QETH_IDLE_WAIT_TIME
)paren
suffix:semicolon
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;LSCD&quot;
comma
id|card
)paren
suffix:semicolon
r_goto
id|again
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|card-&gt;dma_stuff-&gt;sendbuf
comma
id|card-&gt;send_buf
comma
id|QETH_BUFSIZE
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|QETH_TRANSPORT_HEADER_SEQ_NO
c_func
(paren
id|buffer
)paren
comma
op_amp
id|card-&gt;seqno.trans_hdr
comma
id|QETH_SEQ_NO_LENGTH
)paren
suffix:semicolon
id|card-&gt;seqno.trans_hdr
op_increment
suffix:semicolon
id|memcpy
c_func
(paren
id|QETH_PDU_HEADER_SEQ_NO
c_func
(paren
id|buffer
)paren
comma
op_amp
id|card-&gt;seqno.pdu_hdr
comma
id|QETH_SEQ_NO_LENGTH
)paren
suffix:semicolon
id|card-&gt;seqno.pdu_hdr
op_increment
suffix:semicolon
id|memcpy
c_func
(paren
id|QETH_PDU_HEADER_ACK_SEQ_NO
c_func
(paren
id|buffer
)paren
comma
op_amp
id|card-&gt;seqno.pdu_hdr_ack
comma
id|QETH_SEQ_NO_LENGTH
)paren
suffix:semicolon
multiline_comment|/* there is noone doing this except sleep and this function */
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;data_has_arrived
comma
l_int|0
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|card-&gt;dma_stuff-&gt;write_ccw
comma
id|WRITE_CCW
comma
r_sizeof
(paren
r_struct
id|ccw1
)paren
)paren
suffix:semicolon
id|card-&gt;dma_stuff-&gt;write_ccw.count
op_assign
id|len
suffix:semicolon
id|card-&gt;dma_stuff-&gt;write_ccw.cda
op_assign
id|QETH_GET_ADDR
c_func
(paren
id|card-&gt;dma_stuff-&gt;sendbuf
)paren
suffix:semicolon
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;scdw&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%8x&quot;
comma
id|len
)paren
suffix:semicolon
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|QETH_DBF_HEX4
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|intparam
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
id|QETH_DBF_HEX2
c_func
(paren
l_int|0
comma
id|control
comma
id|buffer
comma
id|QETH_DBF_CONTROL_LEN
)paren
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
id|get_ccwdev_lock
c_func
(paren
id|CARD_WDEV
c_func
(paren
id|card
)paren
)paren
comma
id|flags
)paren
suffix:semicolon
id|result
op_assign
id|ccw_device_start
c_func
(paren
id|CARD_WDEV
c_func
(paren
id|card
)paren
comma
op_amp
id|card-&gt;dma_stuff-&gt;write_ccw
comma
id|intparam
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|qeth_delay_millis
c_func
(paren
id|QETH_WAIT_BEFORE_2ND_DOIO
)paren
suffix:semicolon
id|result2
op_assign
id|ccw_device_start
c_func
(paren
id|CARD_WDEV
c_func
(paren
id|card
)paren
comma
op_amp
id|card-&gt;dma_stuff-&gt;write_ccw
comma
id|intparam
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result2
op_ne
op_minus
id|ENODEV
)paren
id|PRINT_WARN
c_func
(paren
l_string|&quot;qeth_send_control_data: do_IO &quot;
l_string|&quot;returned %i, next try returns %i&bslash;n&quot;
comma
id|result
comma
id|result2
)paren
suffix:semicolon
id|result
op_assign
id|result2
suffix:semicolon
)brace
id|spin_unlock_irqrestore
c_func
(paren
id|get_ccwdev_lock
c_func
(paren
id|CARD_WDEV
c_func
(paren
id|card
)paren
)paren
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;scd:doio&quot;
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x&quot;
comma
(paren
id|__s16
)paren
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
multiline_comment|/* re-enable qeth_send_control_data again */
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;write_busy
comma
l_int|0
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|intparam
op_eq
id|IPA_IOCTL_STATE
)paren
(brace
r_if
c_cond
(paren
id|qeth_sleepon_ioctl
c_func
(paren
id|card
comma
id|QETH_IPA_TIMEOUT
)paren
)paren
(brace
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;scd:ioctime&quot;
)paren
suffix:semicolon
multiline_comment|/* re-enable qeth_send_control_data again */
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;write_busy
comma
l_int|0
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
id|rec_buf
op_assign
id|card-&gt;dma_stuff-&gt;recbuf
suffix:semicolon
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;scro&quot;
comma
id|card
)paren
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|qeth_sleepon
c_func
(paren
id|card
comma
(paren
id|setip
)paren
ques
c_cond
id|QETH_IPA_TIMEOUT
suffix:colon
id|QETH_MPC_TIMEOUT
)paren
)paren
(brace
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;scd:time&quot;
)paren
suffix:semicolon
multiline_comment|/* re-enable qeth_send_control_data again */
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;write_busy
comma
l_int|0
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
id|rec_buf
op_assign
id|card-&gt;ipa_buf
suffix:semicolon
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;scri&quot;
comma
id|card
)paren
suffix:semicolon
)brace
id|QETH_DBF_HEX2
c_func
(paren
l_int|0
comma
id|control
comma
id|rec_buf
comma
id|QETH_DBF_CONTROL_LEN
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|card-&gt;seqno.pdu_hdr_ack
comma
id|QETH_PDU_HEADER_SEQ_NO
c_func
(paren
id|rec_buf
)paren
comma
id|QETH_SEQ_NO_LENGTH
)paren
suffix:semicolon
r_return
id|rec_buf
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_send_ipa_cmd
id|qeth_send_ipa_cmd
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_struct
id|ipa_cmd
op_star
id|cmd
comma
r_int
id|update_cmd
comma
r_int
id|ipatype
)paren
(brace
r_int
r_char
op_star
id|buffer
suffix:semicolon
r_struct
id|ipa_cmd
op_star
id|reply
suffix:semicolon
r_int
id|ipa_cmd
suffix:semicolon
r_int
id|result
suffix:semicolon
multiline_comment|/* don&squot;t muck around with ipv6 if there&squot;s no use to do so */
r_if
c_cond
(paren
(paren
id|cmd-&gt;prot_version
op_eq
l_int|6
)paren
op_logical_and
(paren
op_logical_neg
id|qeth_is_supported
c_func
(paren
id|IPA_IPv6
)paren
)paren
)paren
r_return
l_int|0
suffix:semicolon
id|ipa_cmd
op_assign
id|cmd-&gt;command
suffix:semicolon
id|memcpy
c_func
(paren
id|card-&gt;send_buf
comma
id|IPA_PDU_HEADER
comma
id|IPA_PDU_HEADER_SIZE
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|QETH_IPA_CMD_DEST_ADDR
c_func
(paren
id|card-&gt;send_buf
)paren
comma
op_amp
id|card-&gt;token.ulp_connection_r
comma
id|QETH_MPC_TOKEN_LENGTH
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|card-&gt;send_buf
op_plus
id|IPA_PDU_HEADER_SIZE
comma
id|cmd
comma
r_sizeof
(paren
r_struct
id|ipa_cmd
)paren
)paren
suffix:semicolon
id|buffer
op_assign
id|qeth_send_control_data
c_func
(paren
id|card
comma
id|card-&gt;send_buf
comma
id|IPA_PDU_HEADER_SIZE
op_plus
r_sizeof
(paren
r_struct
id|ipa_cmd
)paren
comma
id|ipatype
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|buffer
)paren
(brace
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;escape_softsetup
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_else
r_return
op_minus
l_int|1
suffix:semicolon
)brace
id|reply
op_assign
(paren
r_struct
id|ipa_cmd
op_star
)paren
id|PDU_ENCAPSULATION
c_func
(paren
id|buffer
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|update_cmd
)paren
op_logical_and
(paren
id|reply
)paren
)paren
id|memcpy
c_func
(paren
id|cmd
comma
id|reply
comma
r_sizeof
(paren
r_struct
id|ipa_cmd
)paren
)paren
suffix:semicolon
id|result
op_assign
id|reply-&gt;return_code
suffix:semicolon
multiline_comment|/* some special sausages: */
r_if
c_cond
(paren
(paren
id|ipa_cmd
op_eq
id|IPA_CMD_SETASSPARMS
)paren
op_logical_and
(paren
id|result
op_eq
l_int|0
)paren
)paren
(brace
id|result
op_assign
id|reply-&gt;data.setassparms.return_code
suffix:semicolon
r_if
c_cond
(paren
(paren
id|reply-&gt;data.setassparms.assist_no
op_eq
id|IPA_INBOUND_CHECKSUM
)paren
op_logical_and
(paren
id|reply-&gt;data.setassparms.command_code
op_eq
id|IPA_CMD_ASS_START
)paren
)paren
id|card-&gt;csum_enable_mask
op_assign
id|reply-&gt;data.setassparms.data.flags_32bit
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|ipa_cmd
op_eq
id|IPA_CMD_SETADAPTERPARMS
)paren
op_logical_and
(paren
id|result
op_eq
l_int|0
)paren
)paren
(brace
id|result
op_assign
id|reply-&gt;data.setadapterparms.return_code
suffix:semicolon
)brace
r_return
id|result
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_fill_ipa_cmd
id|qeth_fill_ipa_cmd
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_struct
id|ipa_cmd
op_star
id|cmd
comma
id|__u8
id|command
comma
r_int
id|ip_vers
)paren
(brace
id|memset
c_func
(paren
id|cmd
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|ipa_cmd
)paren
)paren
suffix:semicolon
id|cmd-&gt;command
op_assign
id|command
suffix:semicolon
id|cmd-&gt;initiator
op_assign
id|INITIATOR_HOST
suffix:semicolon
id|cmd-&gt;seq_no
op_assign
id|card-&gt;seqno.ipa
op_increment
suffix:semicolon
id|cmd-&gt;adapter_type
op_assign
id|qeth_get_adapter_type_for_ipa
c_func
(paren
id|card-&gt;link_type
)paren
suffix:semicolon
id|cmd-&gt;rel_adapter_no
op_assign
(paren
id|__u8
)paren
id|card-&gt;options.portno
suffix:semicolon
id|cmd-&gt;prim_version_no
op_assign
l_int|1
suffix:semicolon
id|cmd-&gt;param_count
op_assign
l_int|1
suffix:semicolon
id|cmd-&gt;prot_version
op_assign
id|ip_vers
suffix:semicolon
id|cmd-&gt;ipa_supported
op_assign
l_int|0
suffix:semicolon
id|cmd-&gt;ipa_enabled
op_assign
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_send_startstoplan
id|qeth_send_startstoplan
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
id|__u8
id|ipacmd
comma
id|__u16
id|ip_vers
)paren
(brace
r_struct
id|ipa_cmd
id|cmd
suffix:semicolon
r_int
id|result
suffix:semicolon
id|qeth_fill_ipa_cmd
c_func
(paren
id|card
comma
op_amp
id|cmd
comma
id|ipacmd
comma
l_int|0
)paren
suffix:semicolon
id|cmd.param_count
op_assign
l_int|0
suffix:semicolon
id|cmd.prot_version
op_assign
id|ip_vers
suffix:semicolon
id|cmd.ipa_supported
op_assign
l_int|0
suffix:semicolon
id|cmd.ipa_enabled
op_assign
l_int|0
suffix:semicolon
id|result
op_assign
id|qeth_send_ipa_cmd
c_func
(paren
id|card
comma
op_amp
id|cmd
comma
l_int|0
comma
id|IPA_CMD_STATE
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_send_startlan
id|qeth_send_startlan
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
id|__u16
id|ip_vers
)paren
(brace
r_int
id|result
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
id|QETH_DBF_CARD4
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;stln&quot;
comma
id|card
)paren
suffix:semicolon
id|result
op_assign
id|qeth_send_startstoplan
c_func
(paren
id|card
comma
id|IPA_CMD_STARTLAN
comma
id|ip_vers
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|result
)paren
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;is_startlaned
comma
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;STRTLNFL&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
)brace
r_return
id|result
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_send_stoplan
id|qeth_send_stoplan
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
macro_line|#ifdef QETH_SEND_STOPLAN_ON_SHUTDOWN
r_int
id|result
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;is_startlaned
comma
l_int|0
)paren
suffix:semicolon
id|QETH_DBF_CARD4
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;spln&quot;
comma
id|card
)paren
suffix:semicolon
id|result
op_assign
id|qeth_send_startstoplan
c_func
(paren
id|card
comma
id|IPA_CMD_STOPLAN
comma
l_int|4
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;STPLNFLD&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
)brace
r_return
id|result
suffix:semicolon
macro_line|#else /* QETH_SEND_STOPLAN_ON_SHUTDOWN */
r_return
l_int|0
suffix:semicolon
macro_line|#endif /* QETH_SEND_STOPLAN_ON_SHUTDOWN */
)brace
r_static
r_int
DECL|function|qeth_send_qipassist
id|qeth_send_qipassist
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_int
id|ip_vers
)paren
(brace
r_struct
id|ipa_cmd
id|cmd
suffix:semicolon
r_int
id|result
suffix:semicolon
id|qeth_fill_ipa_cmd
c_func
(paren
id|card
comma
op_amp
id|cmd
comma
id|IPA_CMD_QIPASSIST
comma
id|ip_vers
)paren
suffix:semicolon
id|result
op_assign
id|qeth_send_ipa_cmd
c_func
(paren
id|card
comma
op_amp
id|cmd
comma
l_int|1
comma
id|IPA_CMD_STATE
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|result
)paren
(brace
r_if
c_cond
(paren
id|ip_vers
op_eq
l_int|4
)paren
(brace
id|card-&gt;ipa_supported
op_assign
id|cmd.ipa_supported
suffix:semicolon
id|card-&gt;ipa_enabled
op_assign
id|cmd.ipa_enabled
suffix:semicolon
)brace
r_else
(brace
id|card-&gt;ipa6_supported
op_assign
id|cmd.ipa_supported
suffix:semicolon
id|card-&gt;ipa6_enabled
op_assign
id|cmd.ipa_enabled
suffix:semicolon
)brace
)brace
r_return
id|result
suffix:semicolon
)brace
multiline_comment|/* QUERY ARP FUNCTIONS */
r_static
r_int
DECL|function|qeth_send_ipa_arpcmd
id|qeth_send_ipa_arpcmd
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_struct
id|arp_cmd
op_star
id|cmd
comma
r_int
id|update_cmd
comma
r_int
id|ipatype
comma
id|__u32
id|req_size
)paren
(brace
r_int
r_char
op_star
id|buffer
suffix:semicolon
r_int
id|ipa_cmd
suffix:semicolon
r_int
id|result
suffix:semicolon
id|__u16
id|s1
comma
id|s2
suffix:semicolon
multiline_comment|/* don&squot;t muck around with ipv6 if there&squot;s no use to do so */
r_if
c_cond
(paren
(paren
id|cmd-&gt;prot_version
op_eq
l_int|6
)paren
op_logical_and
(paren
op_logical_neg
id|qeth_is_supported
c_func
(paren
id|IPA_IPv6
)paren
)paren
)paren
r_return
l_int|0
suffix:semicolon
id|result
op_assign
l_int|0
suffix:semicolon
id|ipa_cmd
op_assign
id|cmd-&gt;command
suffix:semicolon
id|memcpy
c_func
(paren
id|card-&gt;send_buf
comma
id|IPA_PDU_HEADER
comma
id|IPA_PDU_HEADER_SIZE
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|QETH_IPA_CMD_DEST_ADDR
c_func
(paren
id|card-&gt;send_buf
)paren
comma
op_amp
id|card-&gt;token.ulp_connection_r
comma
id|QETH_MPC_TOKEN_LENGTH
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|card-&gt;send_buf
op_plus
id|IPA_PDU_HEADER_SIZE
comma
id|cmd
comma
r_sizeof
(paren
r_struct
id|arp_cmd
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|req_size
)paren
(brace
multiline_comment|/* adjust sizes for big requests */
id|s1
op_assign
(paren
id|__u32
)paren
id|IPA_PDU_HEADER_SIZE
op_plus
id|SNMP_BASE_CMDLENGTH
op_plus
id|req_size
suffix:semicolon
id|s2
op_assign
(paren
id|__u32
)paren
id|SNMP_BASE_CMDLENGTH
op_plus
id|req_size
suffix:semicolon
id|memcpy
c_func
(paren
id|QETH_IPA_PDU_LEN_TOTAL
c_func
(paren
id|card-&gt;send_buf
)paren
comma
op_amp
id|s1
comma
l_int|2
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|QETH_IPA_PDU_LEN_PDU1
c_func
(paren
id|card-&gt;send_buf
)paren
comma
op_amp
id|s2
comma
l_int|2
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|QETH_IPA_PDU_LEN_PDU2
c_func
(paren
id|card-&gt;send_buf
)paren
comma
op_amp
id|s2
comma
l_int|2
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|QETH_IPA_PDU_LEN_PDU3
c_func
(paren
id|card-&gt;send_buf
)paren
comma
op_amp
id|s2
comma
l_int|2
)paren
suffix:semicolon
)brace
id|buffer
op_assign
id|qeth_send_control_data
c_func
(paren
id|card
comma
id|card-&gt;send_buf
comma
id|IPA_PDU_HEADER_SIZE
op_plus
r_sizeof
(paren
r_struct
id|arp_cmd
)paren
comma
id|ipatype
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|buffer
)paren
id|result
op_assign
op_minus
id|ENODATA
suffix:semicolon
r_else
id|result
op_assign
id|card-&gt;ioctl_returncode
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_ioctl_handle_snmp_data
id|qeth_ioctl_handle_snmp_data
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_struct
id|arp_cmd
op_star
id|reply
)paren
(brace
id|__u16
id|data_len
suffix:semicolon
DECL|macro|SNMP_HEADER_SIZE_WITH_TOKEN
mdefine_line|#define SNMP_HEADER_SIZE_WITH_TOKEN 36
id|data_len
op_assign
op_star
(paren
(paren
id|__u16
op_star
)paren
id|QETH_IPA_PDU_LEN_PDU1
c_func
(paren
id|card-&gt;dma_stuff-&gt;recbuf
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|reply-&gt;data.setadapterparms.frame_seq_no
op_eq
l_int|1
)paren
id|data_len
op_assign
id|data_len
op_minus
(paren
id|__u16
)paren
(paren
(paren
r_char
op_star
)paren
id|reply-&gt;data.setadapterparms.data
dot
id|snmp_subcommand.snmp_data
op_minus
(paren
r_char
op_star
)paren
id|reply
)paren
suffix:semicolon
r_else
id|data_len
op_assign
id|data_len
op_minus
(paren
id|__u16
)paren
(paren
(paren
r_char
op_star
)paren
op_amp
id|reply-&gt;data.setadapterparms.data
dot
id|snmp_subcommand.snmp_request
op_minus
(paren
r_char
op_star
)paren
id|reply
)paren
suffix:semicolon
r_if
c_cond
(paren
id|reply-&gt;data.setadapterparms.frame_seq_no
op_eq
l_int|1
)paren
(brace
r_if
c_cond
(paren
id|card-&gt;ioctl_buffersize
op_le
(paren
id|SNMP_HEADER_SIZE_WITH_TOKEN
op_plus
id|reply-&gt;data.setadapterparms
dot
id|frames_used_total
op_star
id|ARP_DATA_SIZE
)paren
)paren
(brace
id|card-&gt;ioctl_returncode
op_assign
id|ARP_RETURNCODE_ERROR
suffix:semicolon
id|reply-&gt;data.setadapterparms.data.snmp_subcommand
dot
id|snmp_returncode
op_assign
op_minus
id|ENOMEM
suffix:semicolon
)brace
r_else
(brace
id|card-&gt;ioctl_returncode
op_assign
id|ARP_RETURNCODE_SUCCESS
suffix:semicolon
id|card-&gt;number_of_entries
op_assign
l_int|0
suffix:semicolon
id|memcpy
c_func
(paren
(paren
(paren
r_char
op_star
)paren
id|card-&gt;ioctl_data_buffer
)paren
comma
id|reply-&gt;data.setadapterparms.snmp_token
comma
id|SNMP_HEADER_SIZE_WITH_TOKEN
)paren
suffix:semicolon
id|card-&gt;ioctl_buffer_pointer
op_assign
id|card-&gt;ioctl_data_buffer
op_plus
id|SNMP_HEADER_SIZE_WITH_TOKEN
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|card-&gt;ioctl_returncode
op_ne
id|ARP_RETURNCODE_ERROR
op_logical_and
id|reply-&gt;data.setadapterparms.frame_seq_no
op_le
id|reply-&gt;data.setadapterparms.frames_used_total
)paren
(brace
r_if
c_cond
(paren
id|reply-&gt;data.setadapterparms.return_code
op_eq
id|IPA_REPLY_SUCCESS
)paren
(brace
r_if
c_cond
(paren
id|reply-&gt;data.setadapterparms.frame_seq_no
op_eq
l_int|1
)paren
id|memcpy
c_func
(paren
id|card-&gt;ioctl_buffer_pointer
comma
id|reply-&gt;data.setadapterparms.data
dot
id|snmp_subcommand.snmp_data
comma
id|data_len
)paren
suffix:semicolon
r_else
id|memcpy
c_func
(paren
id|card-&gt;ioctl_buffer_pointer
comma
(paren
r_char
op_star
)paren
op_amp
id|reply-&gt;data.setadapterparms
dot
id|data.snmp_subcommand.snmp_request
comma
id|data_len
)paren
suffix:semicolon
id|card-&gt;ioctl_buffer_pointer
op_assign
id|card-&gt;ioctl_buffer_pointer
op_plus
id|data_len
suffix:semicolon
id|card-&gt;ioctl_returncode
op_assign
id|ARP_RETURNCODE_SUCCESS
suffix:semicolon
r_if
c_cond
(paren
id|reply-&gt;data.setadapterparms.frame_seq_no
op_eq
id|reply-&gt;data.setadapterparms.frames_used_total
)paren
(brace
id|card-&gt;ioctl_returncode
op_assign
id|ARP_RETURNCODE_LASTREPLY
suffix:semicolon
)brace
)brace
r_else
(brace
id|card-&gt;ioctl_returncode
op_assign
id|ARP_RETURNCODE_ERROR
suffix:semicolon
id|memset
c_func
(paren
id|card-&gt;ioctl_data_buffer
comma
l_int|0
comma
id|card-&gt;ioctl_buffersize
)paren
suffix:semicolon
id|reply-&gt;data.setadapterparms.data.snmp_subcommand
dot
id|snmp_returncode
op_assign
id|reply-&gt;data.setadapterparms.return_code
suffix:semicolon
)brace
)brace
DECL|macro|SNMP_HEADER_SIZE_WITH_TOKEN
macro_line|#undef  SNMP_HEADER_SIZE_WITH_TOKEN
r_return
id|card-&gt;ioctl_returncode
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_ioctl_handle_arp_data
id|qeth_ioctl_handle_arp_data
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_struct
id|arp_cmd
op_star
id|reply
)paren
(brace
r_if
c_cond
(paren
id|reply-&gt;data.setassparms.seq_no
op_eq
l_int|1
)paren
(brace
r_if
c_cond
(paren
id|card-&gt;ioctl_buffersize
op_le
(paren
r_sizeof
(paren
id|__u16
)paren
op_plus
r_sizeof
(paren
r_int
)paren
op_plus
id|reply-&gt;data.setassparms.number_of_replies
op_star
id|ARP_DATA_SIZE
)paren
)paren
(brace
id|card-&gt;ioctl_returncode
op_assign
id|ARP_RETURNCODE_ERROR
suffix:semicolon
)brace
r_else
(brace
id|card-&gt;ioctl_returncode
op_assign
id|ARP_RETURNCODE_SUCCESS
suffix:semicolon
id|card-&gt;number_of_entries
op_assign
l_int|0
suffix:semicolon
id|card-&gt;ioctl_buffer_pointer
op_assign
id|card-&gt;ioctl_data_buffer
op_plus
r_sizeof
(paren
id|__u16
)paren
op_plus
r_sizeof
(paren
r_int
)paren
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|card-&gt;ioctl_returncode
op_ne
id|ARP_RETURNCODE_ERROR
op_logical_and
id|reply-&gt;data.setassparms.seq_no
op_le
id|reply-&gt;data.setassparms.number_of_replies
)paren
(brace
r_if
c_cond
(paren
id|reply-&gt;data.setassparms.return_code
op_eq
id|IPA_REPLY_SUCCESS
)paren
(brace
id|card-&gt;number_of_entries
op_assign
id|card-&gt;number_of_entries
op_plus
id|reply-&gt;data.setassparms
dot
id|data.queryarp_data.number_of_entries
suffix:semicolon
id|memcpy
c_func
(paren
id|card-&gt;ioctl_buffer_pointer
comma
id|reply-&gt;data.setassparms.data.queryarp_data
dot
id|arp_data
comma
id|ARP_DATA_SIZE
)paren
suffix:semicolon
id|card-&gt;ioctl_buffer_pointer
op_assign
id|card
op_member_access_from_pointer
id|ioctl_buffer_pointer
op_plus
id|ARP_DATA_SIZE
suffix:semicolon
id|card-&gt;ioctl_returncode
op_assign
id|ARP_RETURNCODE_SUCCESS
suffix:semicolon
r_if
c_cond
(paren
id|reply-&gt;data.setassparms.seq_no
op_eq
id|reply-&gt;data.setassparms.number_of_replies
)paren
(brace
id|memcpy
c_func
(paren
id|card-&gt;ioctl_data_buffer
comma
op_amp
id|reply-&gt;data.setassparms.data
dot
id|queryarp_data.osa_setbitmask
comma
r_sizeof
(paren
id|__u16
)paren
)paren
suffix:semicolon
id|card-&gt;ioctl_returncode
op_assign
id|ARP_RETURNCODE_LASTREPLY
suffix:semicolon
)brace
)brace
r_else
(brace
id|card-&gt;ioctl_returncode
op_assign
id|ARP_RETURNCODE_ERROR
suffix:semicolon
id|memset
c_func
(paren
id|card-&gt;ioctl_data_buffer
comma
l_int|0
comma
id|card-&gt;ioctl_buffersize
)paren
suffix:semicolon
)brace
)brace
r_return
id|card-&gt;ioctl_returncode
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_look_for_arp_data
id|qeth_look_for_arp_data
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_struct
id|arp_cmd
op_star
id|reply
suffix:semicolon
r_int
id|result
suffix:semicolon
id|reply
op_assign
(paren
r_struct
id|arp_cmd
op_star
)paren
id|PDU_ENCAPSULATION
c_func
(paren
id|card-&gt;dma_stuff-&gt;recbuf
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|reply-&gt;command
op_eq
id|IPA_CMD_SETASSPARMS
)paren
op_logical_and
(paren
id|reply-&gt;data.setassparms.assist_no
op_eq
id|IPA_ARP_PROCESSING
)paren
op_logical_and
(paren
id|reply-&gt;data.setassparms.command_code
op_eq
id|IPA_CMD_ASS_ARP_FLUSH_CACHE
)paren
)paren
(brace
id|result
op_assign
id|ARP_FLUSH
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
(paren
id|reply-&gt;command
op_eq
id|IPA_CMD_SETASSPARMS
)paren
op_logical_and
(paren
id|reply-&gt;data.setassparms.assist_no
op_eq
id|IPA_ARP_PROCESSING
)paren
op_logical_and
(paren
id|reply-&gt;data.setassparms.command_code
op_eq
id|IPA_CMD_ASS_ARP_QUERY_INFO
)paren
op_logical_and
(paren
id|card-&gt;ioctl_returncode
op_eq
id|ARP_RETURNCODE_SUCCESS
)paren
)paren
(brace
id|result
op_assign
id|qeth_ioctl_handle_arp_data
c_func
(paren
id|card
comma
id|reply
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
(paren
id|reply-&gt;command
op_eq
id|IPA_CMD_SETADAPTERPARMS
)paren
op_logical_and
(paren
id|reply-&gt;data.setadapterparms.command_code
op_eq
id|IPA_SETADP_SET_SNMP_CONTROL
)paren
op_logical_and
(paren
id|card-&gt;ioctl_returncode
op_eq
id|ARP_RETURNCODE_SUCCESS
)paren
)paren
(brace
id|result
op_assign
id|qeth_ioctl_handle_snmp_data
c_func
(paren
id|card
comma
id|reply
)paren
suffix:semicolon
)brace
r_else
id|result
op_assign
id|ARP_RETURNCODE_NOARPDATA
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_queryarp
id|qeth_queryarp
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_struct
id|ifreq
op_star
id|req
comma
r_int
id|version
comma
id|__u32
id|assist_no
comma
id|__u16
id|command_code
comma
r_char
op_star
id|c_data
comma
id|__u16
id|len
)paren
(brace
r_int
id|data_size
suffix:semicolon
r_struct
id|arp_cmd
op_star
id|cmd
suffix:semicolon
r_int
id|result
suffix:semicolon
id|cmd
op_assign
(paren
r_struct
id|arp_cmd
op_star
)paren
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|arp_cmd
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|cmd
)paren
(brace
r_return
id|IPA_REPLY_FAILED
suffix:semicolon
)brace
id|memcpy
c_func
(paren
op_amp
id|data_size
comma
id|c_data
comma
r_sizeof
(paren
r_int
)paren
)paren
suffix:semicolon
id|qeth_fill_ipa_cmd
c_func
(paren
id|card
comma
(paren
r_struct
id|ipa_cmd
op_star
)paren
id|cmd
comma
id|IPA_CMD_SETASSPARMS
comma
id|version
)paren
suffix:semicolon
id|cmd-&gt;data.setassparms.assist_no
op_assign
id|assist_no
suffix:semicolon
id|cmd-&gt;data.setassparms.length
op_assign
l_int|8
op_plus
id|len
suffix:semicolon
id|cmd-&gt;data.setassparms.command_code
op_assign
id|command_code
suffix:semicolon
id|cmd-&gt;data.setassparms.return_code
op_assign
l_int|0
suffix:semicolon
id|cmd-&gt;data.setassparms.seq_no
op_assign
l_int|0
suffix:semicolon
id|card-&gt;ioctl_buffersize
op_assign
id|data_size
suffix:semicolon
id|card-&gt;ioctl_data_buffer
op_assign
(paren
r_char
op_star
)paren
id|vmalloc
c_func
(paren
id|data_size
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card-&gt;ioctl_data_buffer
)paren
(brace
id|kfree
c_func
(paren
id|cmd
)paren
suffix:semicolon
r_return
id|IPA_REPLY_FAILED
suffix:semicolon
)brace
id|card-&gt;ioctl_returncode
op_assign
id|ARP_RETURNCODE_SUCCESS
suffix:semicolon
id|result
op_assign
id|qeth_send_ipa_arpcmd
c_func
(paren
id|card
comma
id|cmd
comma
l_int|1
comma
id|IPA_IOCTL_STATE
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|result
op_eq
id|ARP_RETURNCODE_ERROR
)paren
op_logical_or
(paren
id|result
op_eq
op_minus
id|ENODATA
)paren
)paren
(brace
id|result
op_assign
id|IPA_REPLY_FAILED
suffix:semicolon
)brace
r_else
(brace
id|result
op_assign
id|IPA_REPLY_SUCCESS
suffix:semicolon
id|memcpy
c_func
(paren
(paren
(paren
r_char
op_star
)paren
(paren
id|card-&gt;ioctl_data_buffer
)paren
)paren
op_plus
r_sizeof
(paren
id|__u16
)paren
comma
op_amp
(paren
id|card-&gt;number_of_entries
)paren
comma
r_sizeof
(paren
r_int
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|req-&gt;ifr_ifru.ifru_data
comma
id|card-&gt;ioctl_data_buffer
comma
id|data_size
)paren
)paren
id|result
op_assign
op_minus
id|EFAULT
suffix:semicolon
)brace
id|card-&gt;ioctl_buffer_pointer
op_assign
l_int|NULL
suffix:semicolon
id|vfree
c_func
(paren
id|card-&gt;ioctl_data_buffer
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|cmd
)paren
suffix:semicolon
id|card-&gt;number_of_entries
op_assign
l_int|0
suffix:semicolon
id|card-&gt;ioctl_buffersize
op_assign
l_int|0
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
r_static
r_int
DECL|function|snmp_set_setadapterparms_command
id|snmp_set_setadapterparms_command
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_struct
id|arp_cmd
op_star
id|cmd
comma
r_struct
id|ifreq
op_star
id|req
comma
r_char
op_star
id|data
comma
id|__u16
id|len
comma
id|__u16
id|command_code
comma
r_int
id|req_size
)paren
(brace
id|__u32
id|data_size
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|data_size
comma
id|data
comma
r_sizeof
(paren
id|__u32
)paren
)paren
suffix:semicolon
id|card-&gt;ioctl_buffersize
op_assign
id|data_size
suffix:semicolon
id|card-&gt;ioctl_data_buffer
op_assign
(paren
r_char
op_star
)paren
id|vmalloc
c_func
(paren
id|data_size
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card-&gt;ioctl_data_buffer
)paren
(brace
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|card-&gt;ioctl_returncode
op_assign
id|ARP_RETURNCODE_SUCCESS
suffix:semicolon
id|memcpy
c_func
(paren
id|cmd-&gt;data.setadapterparms.snmp_token
comma
id|data
op_plus
id|SNMP_REQUEST_DATA_OFFSET
comma
id|req_size
)paren
suffix:semicolon
id|cmd-&gt;data.setadapterparms.cmdlength
op_assign
id|SNMP_SETADP_CMDLENGTH
op_plus
id|req_size
suffix:semicolon
id|cmd-&gt;data.setadapterparms.command_code
op_assign
id|command_code
suffix:semicolon
id|cmd-&gt;data.setadapterparms.frames_used_total
op_assign
l_int|1
suffix:semicolon
id|cmd-&gt;data.setadapterparms.frame_seq_no
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_send_snmp_control
id|qeth_send_snmp_control
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_struct
id|ifreq
op_star
id|req
comma
id|__u32
id|command
comma
id|__u16
id|command_code
comma
r_char
op_star
id|c_data
comma
id|__u16
id|len
)paren
(brace
r_struct
id|arp_cmd
op_star
id|cmd
suffix:semicolon
id|__u32
id|result
comma
id|req_size
suffix:semicolon
id|cmd
op_assign
(paren
r_struct
id|arp_cmd
op_star
)paren
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|arp_cmd
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|cmd
)paren
(brace
r_return
id|IPA_REPLY_FAILED
suffix:semicolon
)brace
id|qeth_fill_ipa_cmd
c_func
(paren
id|card
comma
(paren
r_struct
id|ipa_cmd
op_star
)paren
id|cmd
comma
id|command
comma
l_int|4
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|req_size
comma
(paren
(paren
r_char
op_star
)paren
id|c_data
)paren
op_plus
r_sizeof
(paren
id|__u32
)paren
comma
r_sizeof
(paren
id|__u32
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|snmp_set_setadapterparms_command
c_func
(paren
id|card
comma
id|cmd
comma
id|req
comma
id|c_data
comma
id|len
comma
id|command_code
comma
id|req_size
)paren
)paren
(brace
id|kfree
c_func
(paren
id|cmd
)paren
suffix:semicolon
r_return
id|IPA_REPLY_FAILED
suffix:semicolon
)brace
id|result
op_assign
id|qeth_send_ipa_arpcmd
c_func
(paren
id|card
comma
id|cmd
comma
l_int|1
comma
id|IPA_IOCTL_STATE
comma
id|req_size
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
op_eq
op_minus
id|ENODATA
)paren
(brace
id|result
op_assign
id|IPA_REPLY_FAILED
suffix:semicolon
r_goto
id|snmp_out
suffix:semicolon
)brace
r_if
c_cond
(paren
id|result
op_eq
id|ARP_RETURNCODE_ERROR
)paren
(brace
id|result
op_assign
id|IPA_REPLY_FAILED
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|req-&gt;ifr_ifru.ifru_data
op_plus
id|SNMP_REQUEST_DATA_OFFSET
comma
id|card-&gt;ioctl_data_buffer
comma
id|card-&gt;ioctl_buffersize
)paren
)paren
id|result
op_assign
op_minus
id|EFAULT
suffix:semicolon
)brace
r_else
(brace
id|result
op_assign
id|IPA_REPLY_SUCCESS
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|req-&gt;ifr_ifru.ifru_data
op_plus
id|SNMP_REQUEST_DATA_OFFSET
comma
id|card-&gt;ioctl_data_buffer
comma
id|card-&gt;ioctl_buffersize
)paren
)paren
id|result
op_assign
op_minus
id|EFAULT
suffix:semicolon
)brace
id|snmp_out
suffix:colon
id|card-&gt;number_of_entries
op_assign
l_int|0
suffix:semicolon
id|card-&gt;ioctl_buffersize
op_assign
l_int|0
suffix:semicolon
id|card-&gt;ioctl_buffer_pointer
op_assign
l_int|NULL
suffix:semicolon
id|vfree
c_func
(paren
id|card-&gt;ioctl_data_buffer
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|cmd
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_send_setassparms
id|qeth_send_setassparms
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_int
id|version
comma
id|__u32
id|assist_no
comma
id|__u16
id|command_code
comma
r_int
id|data
comma
id|__u16
id|len
)paren
(brace
r_struct
id|ipa_cmd
id|cmd
suffix:semicolon
r_int
id|result
suffix:semicolon
id|qeth_fill_ipa_cmd
c_func
(paren
id|card
comma
op_amp
id|cmd
comma
id|IPA_CMD_SETASSPARMS
comma
id|version
)paren
suffix:semicolon
id|cmd.data.setassparms.assist_no
op_assign
id|assist_no
suffix:semicolon
id|cmd.data.setassparms.length
op_assign
l_int|8
op_plus
id|len
suffix:semicolon
id|cmd.data.setassparms.command_code
op_assign
id|command_code
suffix:semicolon
id|cmd.data.setassparms.return_code
op_assign
l_int|0
suffix:semicolon
id|cmd.data.setassparms.seq_no
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|len
op_le
r_sizeof
(paren
id|__u32
)paren
)paren
id|cmd.data.setassparms.data.flags_32bit
op_assign
(paren
id|__u32
)paren
id|data
suffix:semicolon
r_else
r_if
c_cond
(paren
id|len
OG
r_sizeof
(paren
id|__u32
)paren
)paren
id|memcpy
c_func
(paren
op_amp
id|cmd.data.setassparms.data
comma
(paren
r_void
op_star
)paren
id|data
comma
id|qeth_min
c_func
(paren
id|len
comma
id|PAGE_SIZE
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|command_code
op_ne
id|IPA_CMD_ASS_START
)paren
(brace
id|result
op_assign
id|qeth_send_ipa_cmd
c_func
(paren
id|card
comma
op_amp
id|cmd
comma
l_int|0
comma
(paren
(paren
id|assist_no
op_eq
id|IPA_ARP_PROCESSING
)paren
op_logical_and
(paren
id|command_code
op_ne
id|IPA_CMD_ASS_ARP_FLUSH_CACHE
)paren
)paren
ques
c_cond
id|IPA_IOCTL_STATE
suffix:colon
id|IPA_CMD_STATE
)paren
suffix:semicolon
)brace
r_else
id|result
op_assign
id|qeth_send_ipa_cmd
c_func
(paren
id|card
comma
op_amp
id|cmd
comma
l_int|0
comma
id|IPA_CMD_STATE
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_send_setadapterparms_query
id|qeth_send_setadapterparms_query
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_struct
id|ipa_cmd
id|cmd
suffix:semicolon
r_int
id|result
suffix:semicolon
id|qeth_fill_ipa_cmd
c_func
(paren
id|card
comma
op_amp
id|cmd
comma
id|IPA_CMD_SETADAPTERPARMS
comma
id|IPA_SETADAPTERPARMS_IP_VERSION
)paren
suffix:semicolon
id|cmd.data.setadapterparms.cmdlength
op_assign
r_sizeof
(paren
r_struct
id|ipa_setadp_cmd
)paren
suffix:semicolon
id|cmd.data.setadapterparms.command_code
op_assign
id|IPA_SETADP_QUERY_COMMANDS_SUPPORTED
suffix:semicolon
id|cmd.data.setadapterparms.frames_used_total
op_assign
l_int|1
suffix:semicolon
id|cmd.data.setadapterparms.frame_seq_no
op_assign
l_int|1
suffix:semicolon
id|result
op_assign
id|qeth_send_ipa_cmd
c_func
(paren
id|card
comma
op_amp
id|cmd
comma
l_int|1
comma
id|IPA_CMD_STATE
)paren
suffix:semicolon
r_if
c_cond
(paren
id|cmd.data.setadapterparms.data.query_cmds_supp.lan_type
op_amp
l_int|0x7f
)paren
id|card-&gt;link_type
op_assign
id|cmd.data.setadapterparms.data
dot
id|query_cmds_supp.lan_type
suffix:semicolon
id|card-&gt;adp_supported
op_assign
id|cmd.data.setadapterparms.data.query_cmds_supp.supported_cmds
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_send_setadapterparms_mode
id|qeth_send_setadapterparms_mode
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
id|__u32
id|command
comma
id|__u32
id|mode
)paren
(brace
r_struct
id|ipa_cmd
id|cmd
suffix:semicolon
r_int
id|result
suffix:semicolon
id|qeth_fill_ipa_cmd
c_func
(paren
id|card
comma
op_amp
id|cmd
comma
id|IPA_CMD_SETADAPTERPARMS
comma
id|IPA_SETADAPTERPARMS_IP_VERSION
)paren
suffix:semicolon
id|cmd.data.setadapterparms.cmdlength
op_assign
r_sizeof
(paren
r_struct
id|ipa_setadp_cmd
)paren
suffix:semicolon
id|cmd.data.setadapterparms.command_code
op_assign
id|command
suffix:semicolon
id|cmd.data.setadapterparms.frames_used_total
op_assign
l_int|1
suffix:semicolon
id|cmd.data.setadapterparms.frame_seq_no
op_assign
l_int|1
suffix:semicolon
id|cmd.data.setadapterparms.data.mode
op_assign
id|mode
suffix:semicolon
id|result
op_assign
id|qeth_send_ipa_cmd
c_func
(paren
id|card
comma
op_amp
id|cmd
comma
l_int|0
comma
id|IPA_CMD_STATE
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_send_setadapterparms_change_addr
id|qeth_send_setadapterparms_change_addr
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
id|__u32
id|command
comma
id|__u32
id|subcmd
comma
id|__u8
op_star
id|mac_addr
comma
r_int
id|addr_len
)paren
(brace
r_struct
id|ipa_cmd
id|cmd
suffix:semicolon
r_int
id|result
suffix:semicolon
id|qeth_fill_ipa_cmd
c_func
(paren
id|card
comma
op_amp
id|cmd
comma
id|IPA_CMD_SETADAPTERPARMS
comma
id|IPA_SETADAPTERPARMS_IP_VERSION
)paren
suffix:semicolon
id|cmd.data.setadapterparms.cmdlength
op_assign
r_sizeof
(paren
r_struct
id|ipa_setadp_cmd
)paren
suffix:semicolon
id|cmd.data.setadapterparms.command_code
op_assign
id|command
suffix:semicolon
id|cmd.data.setadapterparms.frames_used_total
op_assign
l_int|1
suffix:semicolon
id|cmd.data.setadapterparms.frame_seq_no
op_assign
l_int|1
suffix:semicolon
id|cmd.data.setadapterparms.data.change_addr.cmd
op_assign
id|subcmd
suffix:semicolon
id|cmd.data.setadapterparms.data.change_addr.addr_size
op_assign
id|addr_len
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|cmd.data.setadapterparms.data.change_addr.addr
comma
id|mac_addr
comma
id|addr_len
)paren
suffix:semicolon
id|result
op_assign
id|qeth_send_ipa_cmd
c_func
(paren
id|card
comma
op_amp
id|cmd
comma
l_int|1
comma
id|IPA_CMD_STATE
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|mac_addr
comma
op_amp
id|cmd.data.setadapterparms.data.change_addr.addr
comma
id|addr_len
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_send_setassparms_simple_with_data
id|qeth_send_setassparms_simple_with_data
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
id|__u32
id|assist_no
comma
id|__u16
id|command_code
comma
r_int
id|data
)paren
(brace
r_return
id|qeth_send_setassparms
c_func
(paren
id|card
comma
l_int|4
comma
id|assist_no
comma
id|command_code
comma
id|data
comma
l_int|4
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_send_setassparms_simple_without_data
id|qeth_send_setassparms_simple_without_data
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
id|__u32
id|assist_no
comma
id|__u16
id|command_code
)paren
(brace
r_return
id|qeth_send_setassparms
c_func
(paren
id|card
comma
l_int|4
comma
id|assist_no
comma
id|command_code
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_send_setassparms_simple_without_data6
id|qeth_send_setassparms_simple_without_data6
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
id|__u32
id|assist_no
comma
id|__u16
id|command_code
)paren
(brace
r_return
id|qeth_send_setassparms
c_func
(paren
id|card
comma
l_int|6
comma
id|assist_no
comma
id|command_code
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_send_setdelip
id|qeth_send_setdelip
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
id|__u8
op_star
id|ip
comma
id|__u8
op_star
id|netmask
comma
r_int
id|ipacmd
comma
r_int
id|ip_vers
comma
r_int
r_int
id|flags
)paren
(brace
r_struct
id|ipa_cmd
id|cmd
suffix:semicolon
r_int
id|ip_len
op_assign
(paren
id|ip_vers
op_eq
l_int|6
)paren
ques
c_cond
l_int|16
suffix:colon
l_int|4
suffix:semicolon
id|qeth_fill_ipa_cmd
c_func
(paren
id|card
comma
op_amp
id|cmd
comma
id|ipacmd
comma
id|ip_vers
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ip_vers
op_eq
l_int|6
)paren
(brace
id|memcpy
c_func
(paren
op_amp
id|cmd.data.setdelip6.ip
comma
id|ip
comma
id|ip_len
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|cmd.data.setdelip6.netmask
comma
id|netmask
comma
id|ip_len
)paren
suffix:semicolon
id|cmd.data.setdelip6.flags
op_assign
id|flags
suffix:semicolon
)brace
r_else
(brace
id|memcpy
c_func
(paren
op_amp
id|cmd.data.setdelip4.ip
comma
id|ip
comma
id|ip_len
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|cmd.data.setdelip4.netmask
comma
id|netmask
comma
id|ip_len
)paren
suffix:semicolon
id|cmd.data.setdelip4.flags
op_assign
id|flags
suffix:semicolon
)brace
r_return
id|qeth_send_ipa_cmd
c_func
(paren
id|card
comma
op_amp
id|cmd
comma
l_int|0
comma
id|IPA_CMD_STATE
op_or
(paren
(paren
id|ipacmd
op_eq
id|IPA_CMD_SETIP
)paren
ques
c_cond
id|IPA_SETIP_FLAG
suffix:colon
l_int|0
)paren
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_send_setdelipm
id|qeth_send_setdelipm
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
id|__u8
op_star
id|ip
comma
id|__u8
op_star
id|mac
comma
r_int
id|ipacmd
comma
r_int
id|ip_vers
)paren
(brace
r_struct
id|ipa_cmd
id|cmd
suffix:semicolon
r_int
id|ip_len
op_assign
(paren
id|ip_vers
op_eq
l_int|6
)paren
ques
c_cond
l_int|16
suffix:colon
l_int|4
suffix:semicolon
id|qeth_fill_ipa_cmd
c_func
(paren
id|card
comma
op_amp
id|cmd
comma
id|ipacmd
comma
id|ip_vers
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|cmd.data.setdelipm.mac
comma
id|mac
comma
l_int|6
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ip_vers
op_eq
l_int|6
)paren
(brace
id|memcpy
c_func
(paren
op_amp
id|cmd.data.setdelipm.ip6
comma
id|ip
comma
id|ip_len
)paren
suffix:semicolon
)brace
r_else
(brace
id|memcpy
c_func
(paren
op_amp
id|cmd.data.setdelipm.ip4_6
comma
id|ip
comma
id|ip_len
)paren
suffix:semicolon
)brace
r_return
id|qeth_send_ipa_cmd
c_func
(paren
id|card
comma
op_amp
id|cmd
comma
l_int|0
comma
id|IPA_CMD_STATE
op_or
(paren
(paren
id|ipacmd
op_eq
id|IPA_CMD_SETIPM
)paren
ques
c_cond
id|IPA_SETIP_FLAG
suffix:colon
l_int|0
)paren
)paren
suffix:semicolon
)brace
DECL|macro|PRINT_SETIP_ERROR
mdefine_line|#define PRINT_SETIP_ERROR(x) &bslash;&n;&t;if (result) &bslash;&n;&t;&t;PRINT_ERR(&quot;setip%c: return code 0x%x (%s)&bslash;n&quot;,x,result, &bslash;&n;&t;&t;&t;  (result==0xe002)?&quot;invalid mtu size&quot;: &bslash;&n;&t;       &t;&t;  (result==0xe005)?&quot;duplicate ip address&quot;: &bslash;&n;&t;       &t;&t;  (result==0xe0a5)?&quot;duplicate ip address&quot;: &bslash;&n;       &t;&t;&t;  (result==0xe006)?&quot;ip table full&quot;: &bslash;&n;&t;&t;&t;  (result==0xe008)?&quot;startlan not received&quot;: &bslash;&n;&t;&t;&t;  (result==0xe009)?&quot;setip already received&quot;: &bslash;&n;&t;&t;&t;  (result==0xe00a)?&quot;dup network ip address&quot;: &bslash;&n;&t;&t;&t;  (result==0xe00b)?&quot;mblk no free main task entry&quot;: &bslash;&n;&t;&t;&t;  (result==0xe00d)?&quot;invalid ip version&quot;: &bslash;&n;&t;&t;&t;  (result==0xe00e)?&quot;unsupported arp assist cmd&quot;: &bslash;&n;&t;&t;&t;  (result==0xe00f)?&quot;arp assist not enabled&quot;: &bslash;&n;&t;&t;&t;  (result==0xe080)?&quot;startlan disabled&quot;: &bslash;&n;&t;&t;&t;  (result==0xf012)?&quot;unicast IP address invalid&quot;: &bslash;&n;&t;&t;&t;  (result==0xf013)?&quot;multicast router limit reached&quot;: &bslash;&n;&t;&t;&t;  (result==0xf014)?&quot;stop assist not supported&quot;: &bslash;&n;&t;&t;&t;  (result==0xf015)?&quot;multicast assist not set&quot;: &bslash;&n;&t;&t;&t;  (result==0xf080)?&quot;VM: startlan disabled&quot;: &bslash;&n;&t;&t;&t;  (result==-1)?&quot;IPA communication timeout&quot;: &bslash;&n;&t;&t;&t;  &quot;unknown return code&quot;)
r_static
r_inline
r_int
DECL|function|qeth_send_setip
id|qeth_send_setip
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
id|__u8
op_star
id|ip
comma
id|__u8
op_star
id|netmask
comma
r_int
id|ip_vers
comma
r_int
id|use_retries
)paren
(brace
r_int
id|result
suffix:semicolon
r_int
id|retries
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_int
id|takeover
op_assign
l_int|0
suffix:semicolon
id|retries
op_assign
(paren
id|use_retries
)paren
ques
c_cond
id|QETH_SETIP_RETRIES
suffix:colon
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|qeth_is_ipa_covered_by_ipato_entries
c_func
(paren
id|ip_vers
comma
id|ip
comma
id|card
)paren
)paren
(brace
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;ipto&quot;
comma
id|card
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ip_vers
op_eq
l_int|4
)paren
(brace
op_star
(paren
(paren
id|__u32
op_star
)paren
(paren
op_amp
id|dbf_text
(braket
l_int|0
)braket
)paren
)paren
op_assign
op_star
(paren
(paren
id|__u32
op_star
)paren
id|ip
)paren
suffix:semicolon
op_star
(paren
(paren
id|__u32
op_star
)paren
(paren
op_amp
id|dbf_text
(braket
l_int|4
)braket
)paren
)paren
op_assign
op_star
(paren
(paren
id|__u32
op_star
)paren
id|netmask
)paren
suffix:semicolon
id|QETH_DBF_HEX2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
)brace
r_else
(brace
id|QETH_DBF_HEX2
c_func
(paren
l_int|0
comma
id|trace
comma
id|ip
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
id|QETH_DBF_HEX2
c_func
(paren
l_int|0
comma
id|trace
comma
id|ip
op_plus
id|QETH_DBF_TRACE_LEN
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
id|QETH_DBF_HEX2
c_func
(paren
l_int|0
comma
id|trace
comma
id|netmask
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
id|QETH_DBF_HEX2
c_func
(paren
l_int|0
comma
id|trace
comma
id|netmask
op_plus
id|QETH_DBF_TRACE_LEN
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
)brace
id|takeover
op_assign
l_int|1
suffix:semicolon
)brace
r_else
(brace
)brace
id|retry
suffix:colon
id|result
op_assign
id|qeth_send_setdelip
c_func
(paren
id|card
comma
id|ip
comma
id|netmask
comma
id|IPA_CMD_SETIP
comma
id|ip_vers
comma
(paren
id|takeover
)paren
ques
c_cond
id|IPA_SETIP_TAKEOVER_FLAGS
suffix:colon
id|IPA_SETIP_FLAGS
)paren
suffix:semicolon
id|PRINT_SETIP_ERROR
c_func
(paren
l_char|&squot; &squot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;SETIPFLD&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
(paren
id|result
op_eq
op_minus
l_int|1
)paren
op_logical_or
(paren
id|result
op_eq
l_int|0xe080
)paren
op_logical_or
(paren
id|result
op_eq
l_int|0xf080
)paren
)paren
op_logical_and
(paren
id|retries
op_decrement
)paren
)paren
(brace
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;sipr&quot;
comma
id|card
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ip_vers
op_eq
l_int|4
)paren
(brace
op_star
(paren
(paren
id|__u32
op_star
)paren
(paren
op_amp
id|dbf_text
(braket
l_int|0
)braket
)paren
)paren
op_assign
op_star
(paren
(paren
id|__u32
op_star
)paren
id|ip
)paren
suffix:semicolon
op_star
(paren
(paren
id|__u32
op_star
)paren
(paren
op_amp
id|dbf_text
(braket
l_int|4
)braket
)paren
)paren
op_assign
op_star
(paren
(paren
id|__u32
op_star
)paren
id|netmask
)paren
suffix:semicolon
id|QETH_DBF_HEX2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
)brace
r_else
(brace
id|QETH_DBF_HEX2
c_func
(paren
l_int|0
comma
id|trace
comma
id|ip
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
id|QETH_DBF_HEX2
c_func
(paren
l_int|0
comma
id|trace
comma
id|ip
op_plus
id|QETH_DBF_TRACE_LEN
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
id|QETH_DBF_HEX2
c_func
(paren
l_int|0
comma
id|trace
comma
id|netmask
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
id|QETH_DBF_HEX2
c_func
(paren
l_int|0
comma
id|trace
comma
id|netmask
op_plus
id|QETH_DBF_TRACE_LEN
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
)brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;trying again...&bslash;n&quot;
)paren
suffix:semicolon
r_goto
id|retry
suffix:semicolon
)brace
r_return
id|result
suffix:semicolon
)brace
r_static
r_inline
r_int
DECL|function|qeth_send_delip
id|qeth_send_delip
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
id|__u8
op_star
id|ip
comma
id|__u8
op_star
id|netmask
comma
r_int
id|ip_vers
)paren
(brace
r_return
id|qeth_send_setdelip
c_func
(paren
id|card
comma
id|ip
comma
id|netmask
comma
id|IPA_CMD_DELIP
comma
id|ip_vers
comma
id|IPA_DELIP_FLAGS
)paren
suffix:semicolon
)brace
r_static
r_inline
r_int
DECL|function|qeth_send_setipm
id|qeth_send_setipm
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
id|__u8
op_star
id|ip
comma
id|__u8
op_star
id|mac
comma
r_int
id|ip_vers
comma
r_int
id|use_retries
)paren
(brace
r_int
id|result
suffix:semicolon
r_int
id|retries
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
id|retries
op_assign
(paren
id|use_retries
)paren
ques
c_cond
id|QETH_SETIP_RETRIES
suffix:colon
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|qeth_is_ipa_covered_by_ipato_entries
c_func
(paren
id|ip_vers
comma
id|ip
comma
id|card
)paren
)paren
(brace
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;imto&quot;
comma
id|card
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ip_vers
op_eq
l_int|4
)paren
(brace
op_star
(paren
(paren
id|__u32
op_star
)paren
(paren
op_amp
id|dbf_text
(braket
l_int|0
)braket
)paren
)paren
op_assign
op_star
(paren
(paren
id|__u32
op_star
)paren
id|ip
)paren
suffix:semicolon
id|QETH_DBF_HEX2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
)brace
r_else
(brace
id|QETH_DBF_HEX2
c_func
(paren
l_int|0
comma
id|trace
comma
id|ip
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
id|QETH_DBF_HEX2
c_func
(paren
l_int|0
comma
id|trace
comma
id|ip
op_plus
id|QETH_DBF_TRACE_LEN
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
)brace
)brace
id|retry
suffix:colon
id|result
op_assign
id|qeth_send_setdelipm
c_func
(paren
id|card
comma
id|ip
comma
id|mac
comma
id|IPA_CMD_SETIPM
comma
id|ip_vers
)paren
suffix:semicolon
id|PRINT_SETIP_ERROR
c_func
(paren
l_char|&squot;m&squot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;SETIMFLD&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|result
op_eq
op_minus
l_int|1
)paren
op_logical_and
(paren
id|retries
op_decrement
)paren
)paren
(brace
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;simr&quot;
comma
id|card
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ip_vers
op_eq
l_int|4
)paren
(brace
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%08x&quot;
comma
op_star
(paren
(paren
id|__u32
op_star
)paren
id|ip
)paren
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
)brace
r_else
(brace
id|QETH_DBF_HEX2
c_func
(paren
l_int|0
comma
id|trace
comma
id|ip
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
id|QETH_DBF_HEX2
c_func
(paren
l_int|0
comma
id|trace
comma
id|ip
op_plus
id|QETH_DBF_TRACE_LEN
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
)brace
id|QETH_DBF_HEX2
c_func
(paren
l_int|0
comma
id|trace
comma
id|mac
comma
id|OSA_ADDR_LEN
)paren
suffix:semicolon
id|PRINT_WARN
c_func
(paren
l_string|&quot;trying again...&bslash;n&quot;
)paren
suffix:semicolon
r_goto
id|retry
suffix:semicolon
)brace
r_return
id|result
suffix:semicolon
)brace
r_static
r_inline
r_int
DECL|function|qeth_send_delipm
id|qeth_send_delipm
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
id|__u8
op_star
id|ip
comma
id|__u8
op_star
id|mac
comma
r_int
id|ip_vers
)paren
(brace
r_return
id|qeth_send_setdelipm
c_func
(paren
id|card
comma
id|ip
comma
id|mac
comma
id|IPA_CMD_DELIPM
comma
id|ip_vers
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_add_vipa_entry
id|qeth_add_vipa_entry
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_int
id|version
comma
id|__u8
op_star
id|addr
comma
r_int
id|flag
)paren
(brace
r_struct
id|qeth_vipa_entry
op_star
id|entry
comma
op_star
id|e
suffix:semicolon
r_int
id|result
op_assign
l_int|0
suffix:semicolon
id|entry
op_assign
(paren
r_struct
id|qeth_vipa_entry
op_star
)paren
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|qeth_vipa_entry
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|entry
)paren
(brace
id|PRINT_ERR
c_func
(paren
l_string|&quot;not enough memory for vipa handling&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|entry-&gt;version
op_assign
id|version
suffix:semicolon
id|entry-&gt;flag
op_assign
id|flag
suffix:semicolon
id|memcpy
c_func
(paren
id|entry-&gt;ip
comma
id|addr
comma
l_int|16
)paren
suffix:semicolon
id|entry-&gt;state
op_assign
id|VIPA_2_B_ADDED
suffix:semicolon
id|write_lock
c_func
(paren
op_amp
id|card-&gt;vipa_list_lock
)paren
suffix:semicolon
id|e
op_assign
id|card-&gt;vipa_list
suffix:semicolon
r_while
c_loop
(paren
id|e
)paren
(brace
r_if
c_cond
(paren
id|e-&gt;version
op_ne
id|version
)paren
r_goto
id|next
suffix:semicolon
r_if
c_cond
(paren
id|memcmp
c_func
(paren
id|e-&gt;ip
comma
id|addr
comma
(paren
id|version
op_eq
l_int|4
)paren
ques
c_cond
l_int|4
suffix:colon
l_int|16
)paren
)paren
r_goto
id|next
suffix:semicolon
r_if
c_cond
(paren
id|flag
op_eq
id|IPA_SETIP_VIPA_FLAGS
)paren
(brace
id|PRINT_ERR
c_func
(paren
l_string|&quot;vipa already set&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|PRINT_ERR
c_func
(paren
l_string|&quot;rxip already set&bslash;n&quot;
)paren
suffix:semicolon
)brace
id|kfree
c_func
(paren
id|entry
)paren
suffix:semicolon
id|result
op_assign
op_minus
id|EALREADY
suffix:semicolon
r_goto
id|out
suffix:semicolon
id|next
suffix:colon
id|e
op_assign
id|e-&gt;next
suffix:semicolon
)brace
id|entry-&gt;next
op_assign
id|card-&gt;vipa_list
suffix:semicolon
id|card-&gt;vipa_list
op_assign
id|entry
suffix:semicolon
id|out
suffix:colon
id|write_unlock
c_func
(paren
op_amp
id|card-&gt;vipa_list_lock
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_del_vipa_entry
id|qeth_del_vipa_entry
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_int
id|version
comma
id|__u8
op_star
id|addr
comma
r_int
id|flag
)paren
(brace
r_struct
id|qeth_vipa_entry
op_star
id|e
suffix:semicolon
r_int
id|result
op_assign
l_int|0
suffix:semicolon
id|write_lock
c_func
(paren
op_amp
id|card-&gt;vipa_list_lock
)paren
suffix:semicolon
id|e
op_assign
id|card-&gt;vipa_list
suffix:semicolon
r_while
c_loop
(paren
id|e
)paren
(brace
r_if
c_cond
(paren
id|e-&gt;version
op_ne
id|version
)paren
r_goto
id|next
suffix:semicolon
r_if
c_cond
(paren
id|e-&gt;flag
op_ne
id|flag
)paren
r_goto
id|next
suffix:semicolon
r_if
c_cond
(paren
id|memcmp
c_func
(paren
id|e-&gt;ip
comma
id|addr
comma
(paren
id|version
op_eq
l_int|4
)paren
ques
c_cond
l_int|4
suffix:colon
l_int|16
)paren
)paren
r_goto
id|next
suffix:semicolon
id|e-&gt;state
op_assign
id|VIPA_2_B_REMOVED
suffix:semicolon
r_goto
id|out
suffix:semicolon
id|next
suffix:colon
id|e
op_assign
id|e-&gt;next
suffix:semicolon
)brace
r_if
c_cond
(paren
id|flag
op_eq
id|IPA_SETIP_VIPA_FLAGS
)paren
(brace
id|PRINT_ERR
c_func
(paren
l_string|&quot;vipa not found&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|PRINT_ERR
c_func
(paren
l_string|&quot;rxip not found&bslash;n&quot;
)paren
suffix:semicolon
)brace
id|result
op_assign
op_minus
id|ENOENT
suffix:semicolon
id|out
suffix:colon
id|write_unlock
c_func
(paren
op_amp
id|card-&gt;vipa_list_lock
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_set_vipas
id|qeth_set_vipas
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_int
id|set_only
)paren
(brace
r_struct
id|qeth_vipa_entry
op_star
id|e
comma
op_star
id|le
op_assign
l_int|NULL
comma
op_star
id|ne
suffix:semicolon
multiline_comment|/* ne stands for new entry,&n;&t;&t;&t;&t;&t;&t;&t;   le is last entry */
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_int
id|result
suffix:semicolon
id|__u8
id|netmask
(braket
l_int|16
)braket
op_assign
(brace
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
)brace
suffix:semicolon
r_struct
id|qeth_vipa_entry
op_star
id|priv_add_list
op_assign
l_int|NULL
suffix:semicolon
r_struct
id|qeth_vipa_entry
op_star
id|priv_del_list
op_assign
l_int|NULL
suffix:semicolon
id|write_lock
c_func
(paren
op_amp
id|card-&gt;vipa_list_lock
)paren
suffix:semicolon
id|e
op_assign
id|card-&gt;vipa_list
suffix:semicolon
r_while
c_loop
(paren
id|e
)paren
(brace
r_switch
c_cond
(paren
id|e-&gt;state
)paren
(brace
r_case
id|VIPA_2_B_ADDED
suffix:colon
r_if
c_cond
(paren
op_logical_neg
id|set_only
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_open
)paren
)paren
r_break
suffix:semicolon
multiline_comment|/* we don&squot;t want to hold the lock for a long time...&n;&t;&t;&t; * so we clone the entry */
id|ne
op_assign
(paren
r_struct
id|qeth_vipa_entry
op_star
)paren
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|qeth_vipa_entry
)paren
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ne
)paren
(brace
id|ne-&gt;version
op_assign
id|e-&gt;version
suffix:semicolon
id|ne-&gt;flag
op_assign
id|e-&gt;flag
suffix:semicolon
id|memcpy
c_func
(paren
id|ne-&gt;ip
comma
id|e-&gt;ip
comma
l_int|16
)paren
suffix:semicolon
id|ne-&gt;next
op_assign
id|priv_add_list
suffix:semicolon
id|priv_add_list
op_assign
id|ne
suffix:semicolon
id|e-&gt;state
op_assign
id|VIPA_ESTABLISHED
suffix:semicolon
)brace
r_else
(brace
id|PRINT_ERR
c_func
(paren
l_string|&quot;not enough for internal vipa &quot;
l_string|&quot;handling... trying to set &quot;
l_string|&quot;vipa next time.&bslash;n&quot;
)paren
suffix:semicolon
id|qeth_start_softsetup_thread
c_func
(paren
id|card
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|VIPA_2_B_REMOVED
suffix:colon
r_if
c_cond
(paren
id|set_only
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
id|le
)paren
id|le-&gt;next
op_assign
id|e-&gt;next
suffix:semicolon
r_else
id|card-&gt;vipa_list
op_assign
id|e-&gt;next
suffix:semicolon
id|ne
op_assign
id|e-&gt;next
suffix:semicolon
id|e-&gt;next
op_assign
id|priv_del_list
suffix:semicolon
id|priv_del_list
op_assign
id|e
suffix:semicolon
id|e
op_assign
id|ne
suffix:semicolon
r_continue
suffix:semicolon
r_case
id|VIPA_ESTABLISHED
suffix:colon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_open
)paren
)paren
r_break
suffix:semicolon
multiline_comment|/* we don&squot;t want to hold the lock for a long time...&n;&t;&t;&t; * so we clone the entry */
id|ne
op_assign
(paren
r_struct
id|qeth_vipa_entry
op_star
)paren
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|qeth_vipa_entry
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ne
)paren
(brace
id|ne-&gt;version
op_assign
id|e-&gt;version
suffix:semicolon
id|ne-&gt;flag
op_assign
id|e-&gt;flag
suffix:semicolon
id|memcpy
c_func
(paren
id|ne-&gt;ip
comma
id|e-&gt;ip
comma
l_int|16
)paren
suffix:semicolon
id|ne-&gt;next
op_assign
id|priv_del_list
suffix:semicolon
id|priv_del_list
op_assign
id|ne
suffix:semicolon
id|e-&gt;state
op_assign
id|VIPA_2_B_ADDED
suffix:semicolon
)brace
r_else
(brace
id|PRINT_ERR
c_func
(paren
l_string|&quot;not enough for internal vipa &quot;
l_string|&quot;handling... VIPA/RXIP remains set &quot;
l_string|&quot;although device is stopped.&bslash;n&quot;
)paren
suffix:semicolon
id|qeth_start_softsetup_thread
c_func
(paren
id|card
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_default
suffix:colon
r_break
suffix:semicolon
)brace
id|le
op_assign
id|e
suffix:semicolon
id|e
op_assign
id|e-&gt;next
suffix:semicolon
)brace
id|write_unlock
c_func
(paren
op_amp
id|card-&gt;vipa_list_lock
)paren
suffix:semicolon
r_while
c_loop
(paren
id|priv_add_list
)paren
(brace
id|result
op_assign
id|qeth_send_setdelip
c_func
(paren
id|card
comma
id|priv_add_list-&gt;ip
comma
id|netmask
comma
id|IPA_CMD_SETIP
comma
id|priv_add_list-&gt;version
comma
id|priv_add_list-&gt;flag
)paren
suffix:semicolon
id|PRINT_SETIP_ERROR
c_func
(paren
l_char|&squot;s&squot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;SETSVFLD&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
r_if
c_cond
(paren
id|priv_add_list-&gt;version
op_eq
l_int|4
)paren
(brace
id|PRINT_ERR
c_func
(paren
l_string|&quot;going to leave vipa/rxip x%08x&quot;
l_string|&quot;unset...&bslash;n&quot;
comma
op_star
(paren
(paren
id|__u32
op_star
)paren
op_amp
id|priv_add_list-&gt;ip
(braket
l_int|0
)braket
)paren
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%08x&quot;
comma
op_star
(paren
(paren
id|__u32
op_star
)paren
op_amp
id|priv_add_list-&gt;ip
(braket
l_int|0
)braket
)paren
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
)brace
r_else
(brace
id|PRINT_ERR
c_func
(paren
l_string|&quot;going to leave vipa/rxip &quot;
l_string|&quot;%08x%08x%08x%08x unset...&bslash;n&quot;
comma
op_star
(paren
(paren
id|__u32
op_star
)paren
op_amp
id|priv_add_list-&gt;ip
(braket
l_int|0
)braket
)paren
comma
op_star
(paren
(paren
id|__u32
op_star
)paren
op_amp
id|priv_add_list-&gt;ip
(braket
l_int|4
)braket
)paren
comma
op_star
(paren
(paren
id|__u32
op_star
)paren
op_amp
id|priv_add_list-&gt;ip
(braket
l_int|8
)braket
)paren
comma
op_star
(paren
(paren
id|__u32
op_star
)paren
op_amp
id|priv_add_list-&gt;ip
(braket
l_int|12
)braket
)paren
)paren
suffix:semicolon
id|QETH_DBF_HEX2
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|priv_add_list-&gt;ip
(braket
l_int|0
)braket
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
id|QETH_DBF_HEX2
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|priv_add_list-&gt;ip
(braket
l_int|8
)braket
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
)brace
)brace
id|e
op_assign
id|priv_add_list
suffix:semicolon
id|priv_add_list
op_assign
id|priv_add_list-&gt;next
suffix:semicolon
id|kfree
c_func
(paren
id|e
)paren
suffix:semicolon
)brace
r_while
c_loop
(paren
id|priv_del_list
)paren
(brace
id|result
op_assign
id|qeth_send_setdelip
c_func
(paren
id|card
comma
id|priv_del_list-&gt;ip
comma
id|netmask
comma
id|IPA_CMD_DELIP
comma
id|priv_del_list-&gt;version
comma
id|priv_del_list-&gt;flag
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;DELSVFLD&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
r_if
c_cond
(paren
id|priv_del_list-&gt;version
op_eq
l_int|4
)paren
(brace
id|PRINT_ERR
c_func
(paren
l_string|&quot;could not delete vipa/rxip &quot;
l_string|&quot;%08x...&bslash;n&quot;
comma
op_star
(paren
(paren
id|__u32
op_star
)paren
op_amp
id|priv_del_list-&gt;ip
(braket
l_int|0
)braket
)paren
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%08x&quot;
comma
op_star
(paren
(paren
id|__u32
op_star
)paren
op_amp
id|priv_del_list-&gt;ip
(braket
l_int|0
)braket
)paren
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
)brace
r_else
(brace
id|PRINT_ERR
c_func
(paren
l_string|&quot;could not delete vipa/rxip &quot;
l_string|&quot;%08x%08x%08x%08x...&bslash;n&quot;
comma
op_star
(paren
(paren
id|__u32
op_star
)paren
op_amp
id|priv_del_list-&gt;ip
(braket
l_int|0
)braket
)paren
comma
op_star
(paren
(paren
id|__u32
op_star
)paren
op_amp
id|priv_del_list-&gt;ip
(braket
l_int|4
)braket
)paren
comma
op_star
(paren
(paren
id|__u32
op_star
)paren
op_amp
id|priv_del_list-&gt;ip
(braket
l_int|8
)braket
)paren
comma
op_star
(paren
(paren
id|__u32
op_star
)paren
op_amp
id|priv_del_list-&gt;ip
(braket
l_int|12
)braket
)paren
)paren
suffix:semicolon
id|QETH_DBF_HEX2
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|priv_del_list-&gt;ip
(braket
l_int|0
)braket
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
id|QETH_DBF_HEX2
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|priv_del_list-&gt;ip
(braket
l_int|8
)braket
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
)brace
multiline_comment|/* in case of problems, it&squot;s better if we just display a message and&n; * don&squot;t requeue the entry back...&n;&t;&t;&t;write_lock(&amp;card-&gt;vipa_list_lock);&n;&t;&t;&t;e=card-&gt;vipa_list;&n;&t;&t;&t;card-&gt;vipa_list=priv_del_list;&n;&t;&t;&t;priv_del_list=priv_del_list-&gt;next;&n;&t;&t;&t;card-&gt;vipa_list-&gt;next=e;&n;&t;&t;&t;card-&gt;vipa_list-&gt;state=VIPA_ESTABLISHED;&n;&t;&t;&t;write_unlock(&amp;card-&gt;vipa_list_lock);&n;&t;&t;&t;continue;&n;*/
)brace
id|e
op_assign
id|priv_del_list
suffix:semicolon
id|priv_del_list
op_assign
id|priv_del_list-&gt;next
suffix:semicolon
id|kfree
c_func
(paren
id|e
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|qeth_refresh_vipa_states
id|qeth_refresh_vipa_states
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_struct
id|qeth_vipa_entry
op_star
id|e
suffix:semicolon
id|write_lock
c_func
(paren
op_amp
id|card-&gt;vipa_list_lock
)paren
suffix:semicolon
id|e
op_assign
id|card-&gt;vipa_list
suffix:semicolon
r_while
c_loop
(paren
id|e
)paren
(brace
r_if
c_cond
(paren
id|e-&gt;state
op_eq
id|VIPA_ESTABLISHED
)paren
id|e-&gt;state
op_assign
id|VIPA_2_B_ADDED
suffix:semicolon
id|e
op_assign
id|e-&gt;next
suffix:semicolon
)brace
id|write_unlock
c_func
(paren
op_amp
id|card-&gt;vipa_list_lock
)paren
suffix:semicolon
)brace
r_static
r_inline
r_int
DECL|function|qeth_send_setrtg
id|qeth_send_setrtg
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_int
id|routing_type
comma
r_int
id|ip_vers
)paren
(brace
r_struct
id|ipa_cmd
id|cmd
suffix:semicolon
id|qeth_fill_ipa_cmd
c_func
(paren
id|card
comma
op_amp
id|cmd
comma
id|IPA_CMD_SETRTG
comma
id|ip_vers
)paren
suffix:semicolon
multiline_comment|/* strip off RESET_ROUTING_FLAG */
id|cmd.data.setrtg.type
op_assign
(paren
id|routing_type
)paren
op_amp
(paren
id|ROUTER_MASK
)paren
suffix:semicolon
r_return
id|qeth_send_ipa_cmd
c_func
(paren
id|card
comma
op_amp
id|cmd
comma
l_int|0
comma
id|IPA_CMD_STATE
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_is_ipa_in_list
id|qeth_is_ipa_in_list
c_func
(paren
r_struct
id|in_ifaddr
op_star
id|ip
comma
r_struct
id|in_ifaddr
op_star
id|list
)paren
(brace
r_while
c_loop
(paren
id|list
)paren
(brace
r_if
c_cond
(paren
id|ip-&gt;ifa_address
op_eq
id|list-&gt;ifa_address
)paren
r_return
l_int|1
suffix:semicolon
id|list
op_assign
id|list-&gt;ifa_next
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#ifdef QETH_IPV6
r_static
r_int
DECL|function|qeth_is_ipa_in_list6
id|qeth_is_ipa_in_list6
c_func
(paren
r_struct
id|inet6_ifaddr
op_star
id|ip
comma
r_struct
id|inet6_ifaddr
op_star
id|list
)paren
(brace
r_while
c_loop
(paren
id|list
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|memcmp
c_func
(paren
op_amp
id|ip-&gt;addr.s6_addr
comma
op_amp
id|list-&gt;addr.s6_addr
comma
l_int|16
)paren
)paren
r_return
l_int|1
suffix:semicolon
id|list
op_assign
id|list-&gt;if_next
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_add_ifa6_to_list
id|qeth_add_ifa6_to_list
c_func
(paren
r_struct
id|inet6_ifaddr
op_star
op_star
id|list
comma
r_struct
id|inet6_ifaddr
op_star
id|ifa
)paren
(brace
r_struct
id|inet6_ifaddr
op_star
id|i
suffix:semicolon
r_if
c_cond
(paren
op_star
id|list
op_eq
l_int|NULL
)paren
(brace
op_star
id|list
op_assign
id|ifa
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|qeth_is_ipa_in_list6
c_func
(paren
id|ifa
comma
op_star
id|list
)paren
)paren
r_return
op_minus
id|EALREADY
suffix:semicolon
id|i
op_assign
op_star
id|list
suffix:semicolon
r_while
c_loop
(paren
id|i-&gt;if_next
)paren
(brace
id|i
op_assign
id|i-&gt;if_next
suffix:semicolon
)brace
id|i-&gt;if_next
op_assign
id|ifa
suffix:semicolon
)brace
id|ifa-&gt;if_next
op_assign
l_int|NULL
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#endif /* QETH_IPV6 */
r_static
r_int
DECL|function|qeth_add_ifa_to_list
id|qeth_add_ifa_to_list
c_func
(paren
r_struct
id|in_ifaddr
op_star
op_star
id|list
comma
r_struct
id|in_ifaddr
op_star
id|ifa
)paren
(brace
r_struct
id|in_ifaddr
op_star
id|i
suffix:semicolon
r_if
c_cond
(paren
op_star
id|list
op_eq
l_int|NULL
)paren
(brace
op_star
id|list
op_assign
id|ifa
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|qeth_is_ipa_in_list
c_func
(paren
id|ifa
comma
op_star
id|list
)paren
)paren
r_return
op_minus
id|EALREADY
suffix:semicolon
id|i
op_assign
op_star
id|list
suffix:semicolon
r_while
c_loop
(paren
id|i-&gt;ifa_next
)paren
(brace
id|i
op_assign
id|i-&gt;ifa_next
suffix:semicolon
)brace
id|i-&gt;ifa_next
op_assign
id|ifa
suffix:semicolon
)brace
id|ifa-&gt;ifa_next
op_assign
l_int|NULL
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_void
DECL|function|__qeth_setips_ipv6
id|__qeth_setips_ipv6
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_int
id|use_setip_retries
)paren
(brace
macro_line|#ifdef QETH_IPV6
r_int
id|result
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_struct
id|inet6_ifaddr
op_star
id|addr6
suffix:semicolon
id|__u8
id|netmask
(braket
l_int|16
)braket
suffix:semicolon
DECL|macro|FILL_NETMASK
mdefine_line|#define FILL_NETMASK(len) { &bslash;&n;&t;int i,j; &bslash;&n;&t;for (i=0;i&lt;16;i++) { &bslash;&n;&t;&t;j=(len)-(i*8); &bslash;&n;&t;&t;netmask[i]=(__u8)(0xFF00&gt;&gt;j); &bslash;&n;&t;} &bslash;&n;}
multiline_comment|/* here we go with IPv6 */
id|addr6
op_assign
id|card-&gt;ip_current_state.ip6_ifa
suffix:semicolon
r_while
c_loop
(paren
id|addr6
)paren
(brace
r_if
c_cond
(paren
id|qeth_is_ipa_in_list6
c_func
(paren
id|addr6
comma
id|card-&gt;ip_new_state.ip6_ifa
)paren
)paren
(brace
id|addr6
op_assign
id|addr6-&gt;if_next
suffix:semicolon
r_continue
suffix:semicolon
)brace
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;setipdl6&quot;
)paren
suffix:semicolon
id|QETH_DBF_HEX3
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|addr6-&gt;addr.s6_addr
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
id|QETH_DBF_HEX3
c_func
(paren
l_int|0
comma
id|trace
comma
(paren
(paren
r_char
op_star
)paren
(paren
op_amp
id|addr6-&gt;addr.s6_addr
)paren
)paren
op_plus
id|QETH_DBF_TRACE_LEN
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;nmsk%4u&quot;
comma
id|addr6-&gt;prefix_len
)paren
suffix:semicolon
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|FILL_NETMASK
c_func
(paren
id|addr6-&gt;prefix_len
)paren
suffix:semicolon
id|result
op_assign
id|qeth_send_delip
c_func
(paren
id|card
comma
(paren
id|__u8
op_star
)paren
op_amp
id|addr6-&gt;addr.s6_addr
comma
(paren
id|__u8
op_star
)paren
op_amp
id|netmask
comma
l_int|6
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|PRINT_ERR
c_func
(paren
l_string|&quot;was not able to delete ip &quot;
l_string|&quot;%04x:%04x:%04x:%04x:%04x:%04x:&quot;
l_string|&quot;%04x:%04x/%u on device %s &quot;
l_string|&quot;(result: 0x%x), &quot;
l_string|&quot;trying to continue&bslash;n&quot;
comma
id|addr6-&gt;addr.s6_addr16
(braket
l_int|0
)braket
comma
id|addr6-&gt;addr.s6_addr16
(braket
l_int|1
)braket
comma
id|addr6-&gt;addr.s6_addr16
(braket
l_int|2
)braket
comma
id|addr6-&gt;addr.s6_addr16
(braket
l_int|3
)braket
comma
id|addr6-&gt;addr.s6_addr16
(braket
l_int|4
)braket
comma
id|addr6-&gt;addr.s6_addr16
(braket
l_int|5
)braket
comma
id|addr6-&gt;addr.s6_addr16
(braket
l_int|6
)braket
comma
id|addr6-&gt;addr.s6_addr16
(braket
l_int|7
)braket
comma
id|addr6-&gt;prefix_len
comma
id|CARD_BUS_ID
c_func
(paren
id|card
)paren
comma
id|result
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;std6%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
)brace
id|addr6
op_assign
id|addr6-&gt;if_next
suffix:semicolon
)brace
id|addr6
op_assign
id|card-&gt;ip_new_state.ip6_ifa
suffix:semicolon
r_while
c_loop
(paren
id|addr6
)paren
(brace
r_if
c_cond
(paren
id|qeth_is_ipa_in_list6
c_func
(paren
id|addr6
comma
id|card-&gt;ip_current_state.ip6_ifa
)paren
)paren
(brace
id|addr6
op_assign
id|addr6-&gt;if_next
suffix:semicolon
r_continue
suffix:semicolon
)brace
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;setipst6&quot;
)paren
suffix:semicolon
id|QETH_DBF_HEX3
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|addr6-&gt;addr.s6_addr
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
id|QETH_DBF_HEX3
c_func
(paren
l_int|0
comma
id|trace
comma
(paren
(paren
r_char
op_star
)paren
(paren
op_amp
id|addr6-&gt;addr.s6_addr
)paren
)paren
op_plus
id|QETH_DBF_TRACE_LEN
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;nmsk%4u&quot;
comma
id|addr6-&gt;prefix_len
)paren
suffix:semicolon
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|FILL_NETMASK
c_func
(paren
id|addr6-&gt;prefix_len
)paren
suffix:semicolon
id|result
op_assign
id|qeth_send_setip
c_func
(paren
id|card
comma
(paren
id|__u8
op_star
)paren
op_amp
id|addr6-&gt;addr.s6_addr
comma
(paren
id|__u8
op_star
)paren
op_amp
id|netmask
comma
l_int|6
comma
id|use_setip_retries
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|result
)paren
(brace
id|addr6
op_assign
id|addr6-&gt;if_next
suffix:semicolon
r_continue
suffix:semicolon
)brace
id|PRINT_ERR
c_func
(paren
l_string|&quot;was not able to set ip &quot;
l_string|&quot;%04x:%04x:%04x:%04x:%04x:%04x:&quot;
l_string|&quot;%04x:%04x/%u on device %s &quot;
l_string|&quot;(result: 0x%x), trying to continue&bslash;n&quot;
comma
id|addr6-&gt;addr.s6_addr16
(braket
l_int|0
)braket
comma
id|addr6-&gt;addr.s6_addr16
(braket
l_int|1
)braket
comma
id|addr6-&gt;addr.s6_addr16
(braket
l_int|2
)braket
comma
id|addr6-&gt;addr.s6_addr16
(braket
l_int|3
)braket
comma
id|addr6-&gt;addr.s6_addr16
(braket
l_int|4
)braket
comma
id|addr6-&gt;addr.s6_addr16
(braket
l_int|5
)braket
comma
id|addr6-&gt;addr.s6_addr16
(braket
l_int|6
)braket
comma
id|addr6-&gt;addr.s6_addr16
(braket
l_int|7
)braket
comma
id|addr6-&gt;prefix_len
comma
id|CARD_BUS_ID
c_func
(paren
id|card
)paren
comma
id|result
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;sts6%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|addr6
op_assign
id|addr6-&gt;if_next
suffix:semicolon
)brace
macro_line|#endif /* QETH_IPV6 */
)brace
r_static
r_int
DECL|function|qeth_setips
id|qeth_setips
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_int
id|use_setip_retries
)paren
(brace
r_struct
id|in_ifaddr
op_star
id|addr
suffix:semicolon
r_int
id|result
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
id|QETH_DBF_CARD3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;stip&quot;
comma
id|card
)paren
suffix:semicolon
id|addr
op_assign
id|card-&gt;ip_current_state.ip_ifa
suffix:semicolon
r_while
c_loop
(paren
id|addr
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|qeth_is_ipa_in_list
c_func
(paren
id|addr
comma
id|card-&gt;ip_new_state.ip_ifa
)paren
)paren
(brace
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;setipdel&quot;
)paren
suffix:semicolon
op_star
(paren
(paren
id|__u32
op_star
)paren
(paren
op_amp
id|dbf_text
(braket
l_int|0
)braket
)paren
)paren
op_assign
op_star
(paren
(paren
id|__u32
op_star
)paren
op_amp
id|addr-&gt;ifa_address
)paren
suffix:semicolon
op_star
(paren
(paren
id|__u32
op_star
)paren
(paren
op_amp
id|dbf_text
(braket
l_int|4
)braket
)paren
)paren
op_assign
op_star
(paren
(paren
id|__u32
op_star
)paren
op_amp
id|addr-&gt;ifa_mask
)paren
suffix:semicolon
id|QETH_DBF_HEX3
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
id|result
op_assign
id|qeth_send_delip
c_func
(paren
id|card
comma
(paren
id|__u8
op_star
)paren
op_amp
id|addr-&gt;ifa_address
comma
(paren
id|__u8
op_star
)paren
op_amp
id|addr-&gt;ifa_mask
comma
l_int|4
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|PRINT_ERR
c_func
(paren
l_string|&quot;was not able to delete ip &quot;
l_string|&quot;%08x/%08x on device %s &quot;
l_string|&quot;(result: 0x%x), &quot;
l_string|&quot;trying to continue&bslash;n&quot;
comma
id|addr-&gt;ifa_address
comma
id|addr-&gt;ifa_mask
comma
id|CARD_BUS_ID
c_func
(paren
id|card
)paren
comma
id|result
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;stdl%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
)brace
)brace
id|addr
op_assign
id|addr-&gt;ifa_next
suffix:semicolon
)brace
id|addr
op_assign
id|card-&gt;ip_new_state.ip_ifa
suffix:semicolon
r_while
c_loop
(paren
id|addr
)paren
(brace
r_if
c_cond
(paren
id|qeth_is_ipa_in_list
c_func
(paren
id|addr
comma
id|card-&gt;ip_current_state.ip_ifa
)paren
)paren
(brace
id|addr
op_assign
id|addr-&gt;ifa_next
suffix:semicolon
r_continue
suffix:semicolon
)brace
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;setipset&quot;
)paren
suffix:semicolon
op_star
(paren
(paren
id|__u32
op_star
)paren
(paren
op_amp
id|dbf_text
(braket
l_int|0
)braket
)paren
)paren
op_assign
op_star
(paren
(paren
id|__u32
op_star
)paren
op_amp
id|addr-&gt;ifa_address
)paren
suffix:semicolon
op_star
(paren
(paren
id|__u32
op_star
)paren
(paren
op_amp
id|dbf_text
(braket
l_int|4
)braket
)paren
)paren
op_assign
op_star
(paren
(paren
id|__u32
op_star
)paren
op_amp
id|addr-&gt;ifa_mask
)paren
suffix:semicolon
id|QETH_DBF_HEX3
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
id|result
op_assign
id|qeth_send_setip
c_func
(paren
id|card
comma
(paren
id|__u8
op_star
)paren
op_amp
id|addr-&gt;ifa_address
comma
(paren
id|__u8
op_star
)paren
op_amp
id|addr-&gt;ifa_mask
comma
l_int|4
comma
id|use_setip_retries
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|result
)paren
(brace
id|addr
op_assign
id|addr-&gt;ifa_next
suffix:semicolon
r_continue
suffix:semicolon
)brace
id|PRINT_ERR
c_func
(paren
l_string|&quot;was not able to set ip &quot;
l_string|&quot;%08x/%08x on device %s, trying to continue&bslash;n&quot;
comma
id|addr-&gt;ifa_address
comma
id|addr-&gt;ifa_mask
comma
id|CARD_BUS_ID
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;stst%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|addr
op_assign
id|addr-&gt;ifa_next
suffix:semicolon
)brace
id|__qeth_setips_ipv6
c_func
(paren
id|card
comma
id|use_setip_retries
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_is_ipma_in_list
id|qeth_is_ipma_in_list
c_func
(paren
r_struct
id|qeth_ipm_mac
op_star
id|ipma
comma
r_struct
id|qeth_ipm_mac
op_star
id|list
)paren
(brace
r_while
c_loop
(paren
id|list
)paren
(brace
r_if
c_cond
(paren
(paren
op_logical_neg
id|memcmp
c_func
(paren
id|ipma-&gt;ip
comma
id|list-&gt;ip
comma
l_int|16
)paren
)paren
op_logical_and
(paren
op_logical_neg
id|memcmp
c_func
(paren
id|ipma-&gt;mac
comma
id|list-&gt;mac
comma
l_int|6
)paren
)paren
)paren
r_return
l_int|1
suffix:semicolon
id|list
op_assign
id|list-&gt;next
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_remove_mc_ifa_from_list
id|qeth_remove_mc_ifa_from_list
c_func
(paren
r_struct
id|qeth_ipm_mac
op_star
op_star
id|list
comma
r_struct
id|qeth_ipm_mac
op_star
id|ipma
)paren
(brace
r_struct
id|qeth_ipm_mac
op_star
id|i
comma
op_star
id|li
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
(paren
op_logical_neg
(paren
op_star
id|list
)paren
)paren
op_logical_or
(paren
op_logical_neg
id|ipma
)paren
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
op_star
id|list
op_eq
id|ipma
)paren
(brace
op_star
id|list
op_assign
id|ipma-&gt;next
suffix:semicolon
)brace
r_else
(brace
id|i
op_assign
op_star
id|list
suffix:semicolon
r_while
c_loop
(paren
id|i
)paren
(brace
r_if
c_cond
(paren
id|i
op_eq
id|ipma
)paren
(brace
id|li-&gt;next
op_assign
id|i-&gt;next
suffix:semicolon
)brace
r_else
(brace
id|li
op_assign
id|i
suffix:semicolon
)brace
id|i
op_assign
id|i-&gt;next
suffix:semicolon
)brace
)brace
)brace
r_static
r_int
DECL|function|qeth_add_mc_ifa_to_list
id|qeth_add_mc_ifa_to_list
c_func
(paren
r_struct
id|qeth_ipm_mac
op_star
op_star
id|list
comma
r_struct
id|qeth_ipm_mac
op_star
id|ipma
)paren
(brace
r_struct
id|qeth_ipm_mac
op_star
id|i
suffix:semicolon
r_if
c_cond
(paren
id|qeth_is_ipma_in_list
c_func
(paren
id|ipma
comma
op_star
id|list
)paren
)paren
r_return
op_minus
id|EALREADY
suffix:semicolon
r_if
c_cond
(paren
op_star
id|list
op_eq
l_int|NULL
)paren
(brace
op_star
id|list
op_assign
id|ipma
suffix:semicolon
)brace
r_else
(brace
id|i
op_assign
op_star
id|list
suffix:semicolon
r_while
c_loop
(paren
id|i-&gt;next
)paren
(brace
id|i
op_assign
id|i-&gt;next
suffix:semicolon
)brace
id|i-&gt;next
op_assign
id|ipma
suffix:semicolon
)brace
id|ipma-&gt;next
op_assign
l_int|NULL
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_void
DECL|function|__qeth_setipms_ipv6
id|__qeth_setipms_ipv6
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_int
id|use_setipm_retries
)paren
(brace
macro_line|#ifdef QETH_IPV6
r_struct
id|qeth_ipm_mac
op_star
id|addr
suffix:semicolon
r_int
id|result
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
multiline_comment|/* here we go with IPv6 */
id|addr
op_assign
id|card-&gt;ip_mc_current_state.ipm6_ifa
suffix:semicolon
r_while
c_loop
(paren
id|addr
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|qeth_is_ipma_in_list
c_func
(paren
id|addr
comma
id|card-&gt;ip_mc_new_state.ipm6_ifa
)paren
)paren
(brace
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;setimdl6&quot;
)paren
suffix:semicolon
id|QETH_DBF_HEX3
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|addr-&gt;ip
(braket
l_int|0
)braket
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
id|QETH_DBF_HEX3
c_func
(paren
l_int|0
comma
id|trace
comma
(paren
op_amp
id|addr-&gt;ip
(braket
l_int|0
)braket
)paren
op_plus
id|QETH_DBF_TRACE_LEN
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
id|QETH_DBF_HEX3
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|addr-&gt;mac
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
id|result
op_assign
id|qeth_send_delipm
c_func
(paren
id|card
comma
(paren
id|__u8
op_star
)paren
op_amp
id|addr-&gt;ip
(braket
l_int|0
)braket
comma
(paren
id|__u8
op_star
)paren
id|addr-&gt;mac
comma
l_int|6
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|PRINT_ERR
c_func
(paren
l_string|&quot;was not able to delete &quot;
l_string|&quot;multicast ip %04x:%04x:&quot;
l_string|&quot;%04x:%04x:%04x:%04x:%04x:%04x/&quot;
l_string|&quot;%02x%02x%02x%02x%02x%02x &quot;
l_string|&quot;on device %s (result: 0x%x), &quot;
l_string|&quot;trying to continue&bslash;n&quot;
comma
op_star
(paren
(paren
id|__u16
op_star
)paren
op_amp
id|addr-&gt;ip
(braket
l_int|0
)braket
)paren
comma
op_star
(paren
(paren
id|__u16
op_star
)paren
op_amp
id|addr-&gt;ip
(braket
l_int|2
)braket
)paren
comma
op_star
(paren
(paren
id|__u16
op_star
)paren
op_amp
id|addr-&gt;ip
(braket
l_int|4
)braket
)paren
comma
op_star
(paren
(paren
id|__u16
op_star
)paren
op_amp
id|addr-&gt;ip
(braket
l_int|6
)braket
)paren
comma
op_star
(paren
(paren
id|__u16
op_star
)paren
op_amp
id|addr-&gt;ip
(braket
l_int|8
)braket
)paren
comma
op_star
(paren
(paren
id|__u16
op_star
)paren
op_amp
id|addr-&gt;ip
(braket
l_int|10
)braket
)paren
comma
op_star
(paren
(paren
id|__u16
op_star
)paren
op_amp
id|addr-&gt;ip
(braket
l_int|12
)braket
)paren
comma
op_star
(paren
(paren
id|__u16
op_star
)paren
op_amp
id|addr-&gt;ip
(braket
l_int|14
)braket
)paren
comma
id|addr-&gt;mac
(braket
l_int|0
)braket
comma
id|addr-&gt;mac
(braket
l_int|1
)braket
comma
id|addr-&gt;mac
(braket
l_int|2
)braket
comma
id|addr-&gt;mac
(braket
l_int|3
)braket
comma
id|addr-&gt;mac
(braket
l_int|4
)braket
comma
id|addr-&gt;mac
(braket
l_int|5
)braket
comma
id|CARD_BUS_ID
c_func
(paren
id|card
)paren
comma
id|result
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;smd6%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
)brace
)brace
id|addr
op_assign
id|addr-&gt;next
suffix:semicolon
)brace
id|addr
op_assign
id|card-&gt;ip_mc_new_state.ipm6_ifa
suffix:semicolon
r_while
c_loop
(paren
id|addr
)paren
(brace
r_if
c_cond
(paren
id|qeth_is_ipma_in_list
c_func
(paren
id|addr
comma
id|card-&gt;ip_mc_current_state.ipm6_ifa
)paren
)paren
(brace
id|qeth_remove_mc_ifa_from_list
c_func
(paren
op_amp
id|card-&gt;ip_mc_new_state.ipm6_ifa
comma
id|addr
)paren
suffix:semicolon
id|addr
op_assign
id|addr-&gt;next
suffix:semicolon
r_continue
suffix:semicolon
)brace
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;setimst6&quot;
)paren
suffix:semicolon
id|QETH_DBF_HEX3
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|addr-&gt;ip
(braket
l_int|0
)braket
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
id|QETH_DBF_HEX3
c_func
(paren
l_int|0
comma
id|trace
comma
(paren
op_amp
id|addr-&gt;ip
(braket
l_int|0
)braket
)paren
op_plus
id|QETH_DBF_TRACE_LEN
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
id|QETH_DBF_HEX3
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|addr-&gt;mac
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
id|result
op_assign
id|qeth_send_setipm
c_func
(paren
id|card
comma
(paren
id|__u8
op_star
)paren
op_amp
id|addr-&gt;ip
(braket
l_int|0
)braket
comma
(paren
id|__u8
op_star
)paren
id|addr-&gt;mac
comma
l_int|6
comma
id|use_setipm_retries
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|PRINT_ERR
c_func
(paren
l_string|&quot;was not able to set &quot;
l_string|&quot;multicast ip %04x:%04x:&quot;
l_string|&quot;%04x:%04x:%04x:%04x:%04x:%04x/&quot;
l_string|&quot;%02x%02x%02x%02x%02x%02x &quot;
l_string|&quot;on device %s (result: 0x%x), &quot;
l_string|&quot;trying to continue&bslash;n&quot;
comma
op_star
(paren
(paren
id|__u16
op_star
)paren
op_amp
id|addr-&gt;ip
(braket
l_int|0
)braket
)paren
comma
op_star
(paren
(paren
id|__u16
op_star
)paren
op_amp
id|addr-&gt;ip
(braket
l_int|2
)braket
)paren
comma
op_star
(paren
(paren
id|__u16
op_star
)paren
op_amp
id|addr-&gt;ip
(braket
l_int|4
)braket
)paren
comma
op_star
(paren
(paren
id|__u16
op_star
)paren
op_amp
id|addr-&gt;ip
(braket
l_int|6
)braket
)paren
comma
op_star
(paren
(paren
id|__u16
op_star
)paren
op_amp
id|addr-&gt;ip
(braket
l_int|8
)braket
)paren
comma
op_star
(paren
(paren
id|__u16
op_star
)paren
op_amp
id|addr-&gt;ip
(braket
l_int|10
)braket
)paren
comma
op_star
(paren
(paren
id|__u16
op_star
)paren
op_amp
id|addr-&gt;ip
(braket
l_int|12
)braket
)paren
comma
op_star
(paren
(paren
id|__u16
op_star
)paren
op_amp
id|addr-&gt;ip
(braket
l_int|14
)braket
)paren
comma
id|addr-&gt;mac
(braket
l_int|0
)braket
comma
id|addr-&gt;mac
(braket
l_int|1
)braket
comma
id|addr-&gt;mac
(braket
l_int|2
)braket
comma
id|addr-&gt;mac
(braket
l_int|3
)braket
comma
id|addr-&gt;mac
(braket
l_int|4
)braket
comma
id|addr-&gt;mac
(braket
l_int|5
)braket
comma
id|CARD_BUS_ID
c_func
(paren
id|card
)paren
comma
id|result
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;sms6%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
)brace
r_else
(brace
id|qeth_remove_mc_ifa_from_list
c_func
(paren
op_amp
id|card-&gt;ip_mc_new_state.ipm6_ifa
comma
id|addr
)paren
suffix:semicolon
id|qeth_add_mc_ifa_to_list
c_func
(paren
op_amp
id|card-&gt;ip_mc_current_state.ipm6_ifa
comma
id|addr
)paren
suffix:semicolon
)brace
id|addr
op_assign
id|addr-&gt;next
suffix:semicolon
)brace
macro_line|#endif /* QETH_IPV6 */
)brace
r_static
r_int
DECL|function|qeth_setipms
id|qeth_setipms
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_int
id|use_setipm_retries
)paren
(brace
r_struct
id|qeth_ipm_mac
op_star
id|addr
suffix:semicolon
r_int
id|result
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
id|QETH_DBF_CARD3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;stim&quot;
comma
id|card
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|qeth_is_supported
c_func
(paren
id|IPA_MULTICASTING
)paren
)paren
r_return
l_int|0
suffix:semicolon
id|addr
op_assign
id|card-&gt;ip_mc_current_state.ipm_ifa
suffix:semicolon
r_while
c_loop
(paren
id|addr
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|qeth_is_ipma_in_list
c_func
(paren
id|addr
comma
id|card-&gt;ip_mc_new_state.ipm_ifa
)paren
)paren
(brace
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;setimdel&quot;
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%08x&quot;
comma
op_star
(paren
(paren
id|__u32
op_star
)paren
op_amp
id|addr-&gt;ip
(braket
l_int|0
)braket
)paren
)paren
suffix:semicolon
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
op_star
(paren
(paren
id|__u32
op_star
)paren
(paren
op_amp
id|dbf_text
(braket
l_int|0
)braket
)paren
)paren
op_assign
op_star
(paren
(paren
id|__u32
op_star
)paren
op_amp
id|addr-&gt;mac
)paren
suffix:semicolon
op_star
(paren
(paren
id|__u32
op_star
)paren
(paren
op_amp
id|dbf_text
(braket
l_int|4
)braket
)paren
)paren
op_assign
op_star
(paren
(paren
(paren
id|__u32
op_star
)paren
op_amp
id|addr-&gt;mac
)paren
op_plus
l_int|1
)paren
suffix:semicolon
id|QETH_DBF_HEX3
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
id|result
op_assign
id|qeth_send_delipm
c_func
(paren
id|card
comma
(paren
id|__u8
op_star
)paren
op_amp
id|addr-&gt;ip
(braket
l_int|0
)braket
comma
(paren
id|__u8
op_star
)paren
id|addr-&gt;mac
comma
l_int|4
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|PRINT_ERR
c_func
(paren
l_string|&quot;was not able to delete &quot;
l_string|&quot;multicast ip %08x/&quot;
l_string|&quot;%02x%02x%02x%02x%02x%02x &quot;
l_string|&quot;on device %s &quot;
l_string|&quot;(result: 0x%x), &quot;
l_string|&quot;trying to continue&bslash;n&quot;
comma
op_star
(paren
(paren
id|__u32
op_star
)paren
op_amp
id|addr-&gt;ip
(braket
l_int|0
)braket
)paren
comma
id|addr-&gt;mac
(braket
l_int|0
)braket
comma
id|addr-&gt;mac
(braket
l_int|1
)braket
comma
id|addr-&gt;mac
(braket
l_int|2
)braket
comma
id|addr-&gt;mac
(braket
l_int|3
)braket
comma
id|addr-&gt;mac
(braket
l_int|4
)braket
comma
id|addr-&gt;mac
(braket
l_int|5
)braket
comma
id|CARD_BUS_ID
c_func
(paren
id|card
)paren
comma
id|result
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;smdl%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
)brace
)brace
id|addr
op_assign
id|addr-&gt;next
suffix:semicolon
)brace
id|addr
op_assign
id|card-&gt;ip_mc_new_state.ipm_ifa
suffix:semicolon
r_while
c_loop
(paren
id|addr
)paren
(brace
r_if
c_cond
(paren
id|qeth_is_ipma_in_list
c_func
(paren
id|addr
comma
id|card-&gt;ip_mc_current_state.ipm_ifa
)paren
)paren
(brace
id|addr
op_assign
id|addr-&gt;next
suffix:semicolon
r_continue
suffix:semicolon
)brace
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;setimset&quot;
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%08x&quot;
comma
op_star
(paren
(paren
id|__u32
op_star
)paren
op_amp
id|addr-&gt;ip
(braket
l_int|0
)braket
)paren
)paren
suffix:semicolon
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
op_star
(paren
(paren
id|__u32
op_star
)paren
(paren
op_amp
id|dbf_text
(braket
l_int|0
)braket
)paren
)paren
op_assign
op_star
(paren
(paren
id|__u32
op_star
)paren
op_amp
id|addr-&gt;mac
)paren
suffix:semicolon
op_star
(paren
(paren
id|__u32
op_star
)paren
(paren
op_amp
id|dbf_text
(braket
l_int|4
)braket
)paren
)paren
op_assign
op_star
(paren
(paren
(paren
id|__u32
op_star
)paren
op_amp
id|addr-&gt;mac
)paren
op_plus
l_int|1
)paren
suffix:semicolon
id|QETH_DBF_HEX3
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
id|result
op_assign
id|qeth_send_setipm
c_func
(paren
id|card
comma
(paren
id|__u8
op_star
)paren
op_amp
id|addr-&gt;ip
(braket
l_int|0
)braket
comma
(paren
id|__u8
op_star
)paren
id|addr-&gt;mac
comma
l_int|4
comma
id|use_setipm_retries
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|PRINT_ERR
c_func
(paren
l_string|&quot;was not able to set multicast ip %08x/&quot;
l_string|&quot;%02x%02x%02x%02x%02x%02x &quot;
l_string|&quot;on device %s (result: 0x%x), &quot;
l_string|&quot;trying to continue&bslash;n&quot;
comma
op_star
(paren
(paren
id|__u32
op_star
)paren
op_amp
id|addr-&gt;ip
(braket
l_int|0
)braket
)paren
comma
id|addr-&gt;mac
(braket
l_int|0
)braket
comma
id|addr-&gt;mac
(braket
l_int|1
)braket
comma
id|addr-&gt;mac
(braket
l_int|2
)braket
comma
id|addr-&gt;mac
(braket
l_int|3
)braket
comma
id|addr-&gt;mac
(braket
l_int|4
)braket
comma
id|addr-&gt;mac
(braket
l_int|5
)braket
comma
id|CARD_BUS_ID
c_func
(paren
id|card
)paren
comma
id|result
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;smst%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|qeth_remove_mc_ifa_from_list
(paren
op_amp
id|card-&gt;ip_mc_current_state.ipm_ifa
comma
id|addr
)paren
suffix:semicolon
)brace
id|addr
op_assign
id|addr-&gt;next
suffix:semicolon
)brace
id|__qeth_setipms_ipv6
c_func
(paren
id|card
comma
id|use_setipm_retries
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_clone_ifa
id|qeth_clone_ifa
c_func
(paren
r_struct
id|in_ifaddr
op_star
id|src
comma
r_struct
id|in_ifaddr
op_star
id|dest
)paren
(brace
id|memcpy
c_func
(paren
id|dest
comma
id|src
comma
r_sizeof
(paren
r_struct
id|in_ifaddr
)paren
)paren
suffix:semicolon
id|dest-&gt;ifa_next
op_assign
l_int|NULL
suffix:semicolon
)brace
macro_line|#ifdef QETH_IPV6
r_static
r_void
DECL|function|qeth_clone_ifa6
id|qeth_clone_ifa6
c_func
(paren
r_struct
id|inet6_ifaddr
op_star
id|src
comma
r_struct
id|inet6_ifaddr
op_star
id|dest
)paren
(brace
id|memcpy
c_func
(paren
id|dest
comma
id|src
comma
r_sizeof
(paren
r_struct
id|inet6_ifaddr
)paren
)paren
suffix:semicolon
id|dest-&gt;if_next
op_assign
l_int|NULL
suffix:semicolon
)brace
macro_line|#endif /* QETH_IPV6 */
DECL|macro|QETH_STANDARD_RETVALS
mdefine_line|#define QETH_STANDARD_RETVALS &bslash;&n;&t;&t;ret_val=-EIO; &bslash;&n;&t;&t;if (result == -EFAULT) ret_val = -EFAULT; &bslash;&n;                if (result==IPA_REPLY_SUCCESS) ret_val=0; &bslash;&n;&t;&t;if (result==IPA_REPLY_FAILED) ret_val=-EIO; &bslash;&n;&t;&t;if (result==IPA_REPLY_OPNOTSUPP) ret_val=-EOPNOTSUPP
r_static
r_int
DECL|function|qeth_do_ioctl
id|qeth_do_ioctl
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|ifreq
op_star
id|rq
comma
r_int
id|cmd
)paren
(brace
r_char
op_star
id|data
suffix:semicolon
r_int
id|result
comma
id|i
comma
id|ret_val
suffix:semicolon
r_int
id|version
op_assign
l_int|4
suffix:semicolon
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_char
id|buff
(braket
l_int|100
)braket
suffix:semicolon
id|card
op_assign
(paren
r_struct
id|qeth_card
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
id|PRINT_STUPID
c_func
(paren
l_string|&quot;CALL: qeth_do_ioctl called with cmd %i (=0x%x).&bslash;n&quot;
comma
id|cmd
comma
id|cmd
)paren
suffix:semicolon
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;ioct&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;cmd=%4x&quot;
comma
id|cmd
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|QETH_DBF_HEX2
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|rq
comma
r_sizeof
(paren
r_void
op_star
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|cmd
OL
id|SIOCDEVPRIVATE
)paren
op_logical_or
(paren
id|cmd
OG
id|SIOCDEVPRIVATE
op_plus
l_int|5
)paren
)paren
r_return
op_minus
id|EOPNOTSUPP
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
id|buff
comma
id|rq-&gt;ifr_ifru.ifru_data
comma
r_sizeof
(paren
id|buff
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|data
op_assign
id|buff
suffix:semicolon
r_if
c_cond
(paren
(paren
op_logical_neg
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_registered
)paren
)paren
op_logical_or
(paren
op_logical_neg
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_hardsetup
)paren
)paren
)paren
r_return
op_minus
id|ENODEV
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;shutdown_phase
)paren
)paren
r_return
op_minus
id|ENODEV
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|card-&gt;ioctl_lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;shutdown_phase
)paren
)paren
(brace
id|ret_val
op_assign
op_minus
id|ENODEV
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
op_logical_neg
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_registered
)paren
)paren
op_logical_or
(paren
op_logical_neg
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_hardsetup
)paren
)paren
)paren
(brace
id|ret_val
op_assign
op_minus
id|ENODEV
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|SIOCDEVPRIVATE
op_plus
l_int|0
suffix:colon
r_if
c_cond
(paren
op_logical_neg
id|capable
c_func
(paren
id|CAP_NET_ADMIN
)paren
)paren
(brace
id|ret_val
op_assign
op_minus
id|EPERM
suffix:semicolon
r_break
suffix:semicolon
)brace
id|result
op_assign
id|qeth_send_setassparms
c_func
(paren
id|card
comma
id|version
comma
id|IPA_ARP_PROCESSING
comma
id|IPA_CMD_ASS_ARP_SET_NO_ENTRIES
comma
id|rq-&gt;ifr_ifru.ifru_ivalue
comma
l_int|4
)paren
suffix:semicolon
id|QETH_STANDARD_RETVALS
suffix:semicolon
r_if
c_cond
(paren
id|result
op_eq
l_int|3
)paren
id|ret_val
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SIOCDEVPRIVATE
op_plus
l_int|1
suffix:colon
r_if
c_cond
(paren
op_logical_neg
id|capable
c_func
(paren
id|CAP_NET_ADMIN
)paren
)paren
(brace
id|ret_val
op_assign
op_minus
id|EPERM
suffix:semicolon
r_break
suffix:semicolon
)brace
id|result
op_assign
id|qeth_queryarp
c_func
(paren
id|card
comma
id|rq
comma
id|version
comma
id|IPA_ARP_PROCESSING
comma
id|IPA_CMD_ASS_ARP_QUERY_INFO
comma
id|data
comma
l_int|4
)paren
suffix:semicolon
id|QETH_STANDARD_RETVALS
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SIOCDEVPRIVATE
op_plus
l_int|2
suffix:colon
r_if
c_cond
(paren
op_logical_neg
id|capable
c_func
(paren
id|CAP_NET_ADMIN
)paren
)paren
(brace
id|ret_val
op_assign
op_minus
id|EPERM
suffix:semicolon
r_break
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|12
suffix:semicolon
id|i
OL
l_int|24
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|data
(braket
id|i
)braket
)paren
id|version
op_assign
l_int|6
suffix:semicolon
id|result
op_assign
id|qeth_send_setassparms
c_func
(paren
id|card
comma
id|version
comma
id|IPA_ARP_PROCESSING
comma
id|IPA_CMD_ASS_ARP_ADD_ENTRY
comma
(paren
r_int
)paren
id|data
comma
l_int|56
)paren
suffix:semicolon
id|QETH_STANDARD_RETVALS
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SIOCDEVPRIVATE
op_plus
l_int|3
suffix:colon
r_if
c_cond
(paren
op_logical_neg
id|capable
c_func
(paren
id|CAP_NET_ADMIN
)paren
)paren
(brace
id|ret_val
op_assign
op_minus
id|EPERM
suffix:semicolon
r_break
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|4
suffix:semicolon
id|i
OL
l_int|12
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|data
(braket
id|i
)braket
)paren
id|version
op_assign
l_int|6
suffix:semicolon
id|result
op_assign
id|qeth_send_setassparms
c_func
(paren
id|card
comma
id|version
comma
id|IPA_ARP_PROCESSING
comma
id|IPA_CMD_ASS_ARP_REMOVE_ENTRY
comma
(paren
r_int
)paren
id|data
comma
l_int|16
)paren
suffix:semicolon
id|QETH_STANDARD_RETVALS
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SIOCDEVPRIVATE
op_plus
l_int|4
suffix:colon
r_if
c_cond
(paren
op_logical_neg
id|capable
c_func
(paren
id|CAP_NET_ADMIN
)paren
)paren
(brace
id|ret_val
op_assign
op_minus
id|EPERM
suffix:semicolon
r_break
suffix:semicolon
)brace
id|result
op_assign
id|qeth_send_setassparms
c_func
(paren
id|card
comma
id|version
comma
id|IPA_ARP_PROCESSING
comma
id|IPA_CMD_ASS_ARP_FLUSH_CACHE
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
id|QETH_STANDARD_RETVALS
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SIOCDEVPRIVATE
op_plus
l_int|5
suffix:colon
id|result
op_assign
id|qeth_send_snmp_control
c_func
(paren
id|card
comma
id|rq
comma
id|IPA_CMD_SETADAPTERPARMS
comma
id|IPA_SETADP_SET_SNMP_CONTROL
comma
id|data
comma
l_int|4
)paren
suffix:semicolon
id|QETH_STANDARD_RETVALS
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|ret_val
op_assign
op_minus
id|EOPNOTSUPP
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|out
suffix:colon
id|spin_unlock
c_func
(paren
op_amp
id|card-&gt;ioctl_lock
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;ret=%4x&quot;
comma
id|ret_val
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
r_return
id|ret_val
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_clear_ifamc_list
id|qeth_clear_ifamc_list
c_func
(paren
r_struct
id|qeth_ipm_mac
op_star
op_star
id|ifa_list
)paren
(brace
r_struct
id|qeth_ipm_mac
op_star
id|ifa
suffix:semicolon
r_while
c_loop
(paren
op_star
id|ifa_list
)paren
(brace
id|ifa
op_assign
op_star
id|ifa_list
suffix:semicolon
op_star
id|ifa_list
op_assign
id|ifa-&gt;next
suffix:semicolon
id|kfree
c_func
(paren
id|ifa
)paren
suffix:semicolon
)brace
)brace
macro_line|#ifdef QETH_IPV6
r_static
r_void
DECL|function|qeth_clear_ifa6_list
id|qeth_clear_ifa6_list
c_func
(paren
r_struct
id|inet6_ifaddr
op_star
op_star
id|ifa_list
)paren
(brace
r_struct
id|inet6_ifaddr
op_star
id|ifa
suffix:semicolon
r_while
c_loop
(paren
op_star
id|ifa_list
)paren
(brace
id|ifa
op_assign
op_star
id|ifa_list
suffix:semicolon
op_star
id|ifa_list
op_assign
id|ifa-&gt;if_next
suffix:semicolon
id|kfree
c_func
(paren
id|ifa
)paren
suffix:semicolon
)brace
)brace
r_static
r_inline
r_void
DECL|function|__qeth_append_vlan_ipas_v6
id|__qeth_append_vlan_ipas_v6
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
macro_line|#ifdef QETH_VLAN
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_struct
id|vlan_group
op_star
id|card_group
suffix:semicolon
r_int
id|i
suffix:semicolon
r_int
id|remove
suffix:semicolon
r_struct
id|inet6_ifaddr
op_star
id|ifa
comma
op_star
id|ifanew
suffix:semicolon
multiline_comment|/*&n;&t; * append all known VLAN IP Addresses corresponding to the real device&n;&t; * card-&gt;dev-&gt;ifindex&n;&t; */
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;to-vip6s&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
op_logical_neg
id|qeth_is_supported
c_func
(paren
id|IPA_FULL_VLAN
)paren
)paren
op_logical_or
(paren
op_logical_neg
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_open
)paren
)paren
)paren
r_return
suffix:semicolon
id|card_group
op_assign
(paren
r_struct
id|vlan_group
op_star
)paren
id|card-&gt;vlangrp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card_group
)paren
r_return
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|VLAN_GROUP_ARRAY_LEN
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|card_group-&gt;vlan_devices
(braket
id|i
)braket
op_logical_or
op_logical_neg
(paren
id|card_group-&gt;vlan_devices
(braket
id|i
)braket
op_member_access_from_pointer
id|flags
op_amp
id|IFF_UP
)paren
op_logical_or
op_logical_neg
(paren
r_struct
id|inet6_dev
op_star
)paren
id|card_group-&gt;vlan_devices
(braket
id|i
)braket
op_member_access_from_pointer
id|ip6_ptr
)paren
r_continue
suffix:semicolon
id|ifa
op_assign
(paren
(paren
r_struct
id|inet6_dev
op_star
)paren
id|card_group-&gt;vlan_devices
(braket
id|i
)braket
op_member_access_from_pointer
id|ip6_ptr
)paren
op_member_access_from_pointer
id|addr_list
suffix:semicolon
r_while
c_loop
(paren
id|ifa
)paren
(brace
id|ifanew
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|inet6_ifaddr
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ifanew
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;No memory for IP address &quot;
l_string|&quot;handling. Some of the IPs &quot;
l_string|&quot;will not be set on %s.&bslash;n&quot;
comma
id|card-&gt;dev_name
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;TOIPNMEM&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|qeth_clone_ifa6
c_func
(paren
id|ifa
comma
id|ifanew
)paren
suffix:semicolon
id|remove
op_assign
id|qeth_add_ifa6_to_list
(paren
op_amp
id|card-&gt;ip_new_state.ip6_ifa
comma
id|ifanew
)paren
suffix:semicolon
id|QETH_DBF_HEX4
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|ifanew-&gt;addr.s6_addr
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
id|QETH_DBF_HEX4
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|ifanew-&gt;addr.s6_addr
op_plus
id|QETH_DBF_TRACE_LEN
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;pref%4u&quot;
comma
id|ifanew-&gt;prefix_len
)paren
suffix:semicolon
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
r_if
c_cond
(paren
id|remove
)paren
(brace
id|kfree
c_func
(paren
id|ifanew
)paren
suffix:semicolon
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;alrdv6rm&quot;
)paren
suffix:semicolon
)brace
)brace
id|ifa
op_assign
id|ifa-&gt;if_next
suffix:semicolon
)brace
)brace
macro_line|#endif
)brace
r_static
r_inline
r_void
DECL|function|__qeth_append_vlan_ipas_v6_mc
id|__qeth_append_vlan_ipas_v6_mc
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
macro_line|#ifdef QETH_VLAN
r_struct
id|vlan_group
op_star
id|card_group
suffix:semicolon
r_int
id|i
suffix:semicolon
r_int
id|remove
suffix:semicolon
r_struct
id|inet6_dev
op_star
id|in6_vdev
suffix:semicolon
r_char
id|buf
(braket
id|MAX_ADDR_LEN
)braket
suffix:semicolon
r_struct
id|qeth_ipm_mac
op_star
id|ipmanew
suffix:semicolon
r_struct
id|ifmcaddr6
op_star
id|im6
suffix:semicolon
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;tovipm6s&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|qeth_is_supported
c_func
(paren
id|IPA_FULL_VLAN
)paren
op_logical_or
op_logical_neg
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_open
)paren
)paren
r_return
suffix:semicolon
id|card_group
op_assign
(paren
r_struct
id|vlan_group
op_star
)paren
id|card-&gt;vlangrp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card_group
)paren
r_return
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|VLAN_GROUP_ARRAY_LEN
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|card_group-&gt;vlan_devices
(braket
id|i
)braket
op_logical_or
op_logical_neg
(paren
id|card_group-&gt;vlan_devices
(braket
id|i
)braket
op_member_access_from_pointer
id|flags
op_amp
id|IFF_UP
)paren
)paren
r_continue
suffix:semicolon
id|in6_vdev
op_assign
id|in6_dev_get
c_func
(paren
id|card_group-&gt;vlan_devices
(braket
id|i
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|in6_vdev
)paren
(brace
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;id26&quot;
comma
id|card
)paren
suffix:semicolon
r_continue
suffix:semicolon
)brace
id|read_lock
c_func
(paren
op_amp
id|in6_vdev-&gt;lock
)paren
suffix:semicolon
r_for
c_loop
(paren
id|im6
op_assign
id|in6_vdev-&gt;mc_list
suffix:semicolon
id|im6
suffix:semicolon
id|im6
op_assign
id|im6-&gt;next
)paren
(brace
id|ndisc_mc_map
c_func
(paren
op_amp
id|im6-&gt;mca_addr
comma
id|buf
comma
id|card_group-&gt;vlan_devices
(braket
id|i
)braket
comma
l_int|0
)paren
suffix:semicolon
id|ipmanew
op_assign
(paren
r_struct
id|qeth_ipm_mac
op_star
)paren
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|qeth_ipm_mac
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ipmanew
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;No memory for IPM address &quot;
l_string|&quot;handling. Multicast IP &quot;
l_string|&quot;%04x:%04x:%04x:%04x:%04x:&quot;
l_string|&quot;%04x:%04x:%04x&quot;
l_string|&quot;will not be set on %s.&bslash;n&quot;
comma
id|im6-&gt;mca_addr.s6_addr16
(braket
l_int|0
)braket
comma
id|im6-&gt;mca_addr.s6_addr16
(braket
l_int|1
)braket
comma
id|im6-&gt;mca_addr.s6_addr16
(braket
l_int|2
)braket
comma
id|im6-&gt;mca_addr.s6_addr16
(braket
l_int|3
)braket
comma
id|im6-&gt;mca_addr.s6_addr16
(braket
l_int|4
)braket
comma
id|im6-&gt;mca_addr.s6_addr16
(braket
l_int|5
)braket
comma
id|im6-&gt;mca_addr.s6_addr16
(braket
l_int|6
)braket
comma
id|im6-&gt;mca_addr.s6_addr16
(braket
l_int|7
)braket
comma
id|card-&gt;dev_name
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;TOIPMNMM&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|memset
c_func
(paren
id|ipmanew
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|qeth_ipm_mac
)paren
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|ipmanew-&gt;mac
comma
id|buf
comma
id|OSA_ADDR_LEN
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|ipmanew-&gt;ip
comma
id|im6-&gt;mca_addr.s6_addr
comma
l_int|16
)paren
suffix:semicolon
id|ipmanew-&gt;next
op_assign
l_int|NULL
suffix:semicolon
id|remove
op_assign
id|qeth_add_mc_ifa_to_list
(paren
op_amp
id|card-&gt;ip_mc_new_state.ipm6_ifa
comma
id|ipmanew
)paren
suffix:semicolon
id|QETH_DBF_HEX4
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|ipmanew-&gt;ip
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
id|QETH_DBF_HEX4
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|ipmanew-&gt;ip
op_plus
id|QETH_DBF_TRACE_LEN
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
id|QETH_DBF_HEX4
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|ipmanew-&gt;mac
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
r_if
c_cond
(paren
id|remove
)paren
(brace
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;mlrdv6rm&quot;
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|ipmanew
)paren
suffix:semicolon
)brace
)brace
)brace
id|read_unlock
c_func
(paren
op_amp
id|in6_vdev-&gt;lock
)paren
suffix:semicolon
id|in6_dev_put
c_func
(paren
id|in6_vdev
)paren
suffix:semicolon
)brace
macro_line|#endif
)brace
r_static
r_struct
id|inet6_dev
op_star
DECL|function|__qeth_get_mc_lock_v6
id|__qeth_get_mc_lock_v6
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_struct
id|inet6_dev
op_star
id|in6_dev
suffix:semicolon
id|in6_dev
op_assign
id|in6_dev_get
c_func
(paren
id|card-&gt;dev
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|in6_dev
)paren
(brace
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;id16&quot;
comma
id|card
)paren
suffix:semicolon
r_return
id|ERR_PTR
c_func
(paren
op_minus
id|ENODEV
)paren
suffix:semicolon
)brace
id|read_lock
c_func
(paren
op_amp
id|in6_dev-&gt;lock
)paren
suffix:semicolon
r_return
id|in6_dev
suffix:semicolon
)brace
r_static
r_void
DECL|function|__qeth_takeover_ip_ipms6_mc
id|__qeth_takeover_ip_ipms6_mc
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_struct
id|inet6_dev
op_star
id|in6_dev
)paren
(brace
r_int
id|remove
suffix:semicolon
r_struct
id|qeth_ipm_mac
op_star
id|ipmanew
suffix:semicolon
r_struct
id|ifmcaddr6
op_star
id|im6
suffix:semicolon
r_char
id|buf
(braket
id|MAX_ADDR_LEN
)braket
suffix:semicolon
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;to-ipm6s&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_open
)paren
)paren
r_for
c_loop
(paren
id|im6
op_assign
id|in6_dev-&gt;mc_list
suffix:semicolon
id|im6
suffix:semicolon
id|im6
op_assign
id|im6-&gt;next
)paren
(brace
id|ndisc_mc_map
c_func
(paren
op_amp
id|im6-&gt;mca_addr
comma
id|buf
comma
id|card-&gt;dev
comma
l_int|0
)paren
suffix:semicolon
id|ipmanew
op_assign
(paren
r_struct
id|qeth_ipm_mac
op_star
)paren
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|qeth_ipm_mac
)paren
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ipmanew
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;No memory for IPM address &quot;
l_string|&quot;handling. Multicast IP &quot;
l_string|&quot;%04x:%04x:%04x:%04x:%04x:%04x:%04x:%04x&quot;
l_string|&quot;will not be set on %s.&bslash;n&quot;
comma
id|im6-&gt;mca_addr.s6_addr16
(braket
l_int|0
)braket
comma
id|im6-&gt;mca_addr.s6_addr16
(braket
l_int|1
)braket
comma
id|im6-&gt;mca_addr.s6_addr16
(braket
l_int|2
)braket
comma
id|im6-&gt;mca_addr.s6_addr16
(braket
l_int|3
)braket
comma
id|im6-&gt;mca_addr.s6_addr16
(braket
l_int|4
)braket
comma
id|im6-&gt;mca_addr.s6_addr16
(braket
l_int|5
)braket
comma
id|im6-&gt;mca_addr.s6_addr16
(braket
l_int|6
)braket
comma
id|im6-&gt;mca_addr.s6_addr16
(braket
l_int|7
)braket
comma
id|card-&gt;dev_name
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;TOIPMNMM&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|memset
c_func
(paren
id|ipmanew
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|qeth_ipm_mac
)paren
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|ipmanew-&gt;mac
comma
id|buf
comma
id|OSA_ADDR_LEN
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|ipmanew-&gt;ip
comma
id|im6-&gt;mca_addr.s6_addr
comma
l_int|16
)paren
suffix:semicolon
id|ipmanew-&gt;next
op_assign
l_int|NULL
suffix:semicolon
id|remove
op_assign
id|qeth_add_mc_ifa_to_list
c_func
(paren
op_amp
id|card
op_member_access_from_pointer
id|ip_mc_new_state
dot
id|ipm6_ifa
comma
id|ipmanew
)paren
suffix:semicolon
id|QETH_DBF_HEX4
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|ipmanew-&gt;ip
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
id|QETH_DBF_HEX4
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|ipmanew-&gt;ip
op_plus
id|QETH_DBF_TRACE_LEN
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
id|QETH_DBF_HEX4
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|ipmanew-&gt;mac
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
r_if
c_cond
(paren
id|remove
)paren
(brace
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;mlrdy6rm&quot;
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|ipmanew
)paren
suffix:semicolon
)brace
)brace
)brace
id|__qeth_append_vlan_ipas_v6_mc
c_func
(paren
id|card
)paren
suffix:semicolon
id|read_unlock
c_func
(paren
op_amp
id|in6_dev-&gt;lock
)paren
suffix:semicolon
id|in6_dev_put
c_func
(paren
id|in6_dev
)paren
suffix:semicolon
)brace
macro_line|#endif /* QETH_IPV6 */
r_static
r_void
DECL|function|qeth_takeover_ip_ipms6
id|qeth_takeover_ip_ipms6
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
macro_line|#ifdef QETH_IPV6
r_struct
id|inet6_ifaddr
op_star
id|ifa
comma
op_star
id|ifanew
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_int
id|remove
suffix:semicolon
r_struct
id|inet6_dev
op_star
id|in6_dev
suffix:semicolon
id|QETH_DBF_CARD3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;tip6&quot;
comma
id|card
)paren
suffix:semicolon
multiline_comment|/* unicast */
multiline_comment|/* clear ip_current_state */
id|qeth_clear_ifa6_list
c_func
(paren
op_amp
id|card-&gt;ip_current_state.ip6_ifa
)paren
suffix:semicolon
multiline_comment|/* take it over */
id|card-&gt;ip_current_state.ip6_ifa
op_assign
id|card-&gt;ip_new_state.ip6_ifa
suffix:semicolon
id|card-&gt;ip_new_state.ip6_ifa
op_assign
l_int|NULL
suffix:semicolon
id|in6_dev
op_assign
id|__qeth_get_mc_lock_v6
c_func
(paren
id|card
)paren
suffix:semicolon
r_if
c_cond
(paren
id|PTR_ERR
c_func
(paren
id|in6_dev
)paren
op_eq
op_minus
id|ENODEV
)paren
r_return
suffix:semicolon
multiline_comment|/* get new one, we try to have the same order as ifa_list in device&n;&t;   structure, for what reason ever */
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;to-ip6s&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_open
)paren
)paren
op_logical_and
(paren
id|card-&gt;dev-&gt;ip6_ptr
)paren
op_logical_and
(paren
(paren
(paren
r_struct
id|inet6_dev
op_star
)paren
id|card-&gt;dev-&gt;ip6_ptr
)paren
op_member_access_from_pointer
id|addr_list
)paren
)paren
(brace
id|ifa
op_assign
(paren
(paren
r_struct
id|inet6_dev
op_star
)paren
id|card-&gt;dev-&gt;ip6_ptr
)paren
op_member_access_from_pointer
id|addr_list
suffix:semicolon
r_while
c_loop
(paren
id|ifa
)paren
(brace
id|ifanew
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|inet6_ifaddr
)paren
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ifanew
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;No memory for IP address &quot;
l_string|&quot;handling. Some of the IPs &quot;
l_string|&quot;will not be set on %s.&bslash;n&quot;
comma
id|card-&gt;dev_name
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;TOIPNMEM&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|qeth_clone_ifa6
c_func
(paren
id|ifa
comma
id|ifanew
)paren
suffix:semicolon
id|remove
op_assign
id|qeth_add_ifa6_to_list
c_func
(paren
op_amp
id|card-&gt;ip_new_state
dot
id|ip6_ifa
comma
id|ifanew
)paren
suffix:semicolon
id|QETH_DBF_HEX4
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|ifanew-&gt;addr.s6_addr
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
id|QETH_DBF_HEX4
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|ifanew-&gt;addr.s6_addr
op_plus
id|QETH_DBF_TRACE_LEN
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;pref%4u&quot;
comma
id|ifanew-&gt;prefix_len
)paren
suffix:semicolon
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
r_if
c_cond
(paren
id|remove
)paren
(brace
id|kfree
c_func
(paren
id|ifanew
)paren
suffix:semicolon
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;alrdy6rm&quot;
)paren
suffix:semicolon
)brace
)brace
id|ifa
op_assign
id|ifa-&gt;if_next
suffix:semicolon
)brace
)brace
id|__qeth_append_vlan_ipas_v6
c_func
(paren
id|card
)paren
suffix:semicolon
id|__qeth_takeover_ip_ipms6_mc
c_func
(paren
id|card
comma
id|in6_dev
)paren
suffix:semicolon
macro_line|#endif /* QETH_IPV6 */
)brace
r_static
r_void
DECL|function|qeth_clear_ifa4_list
id|qeth_clear_ifa4_list
c_func
(paren
r_struct
id|in_ifaddr
op_star
op_star
id|ifa_list
)paren
(brace
r_struct
id|in_ifaddr
op_star
id|ifa
suffix:semicolon
r_while
c_loop
(paren
op_star
id|ifa_list
)paren
(brace
id|ifa
op_assign
op_star
id|ifa_list
suffix:semicolon
op_star
id|ifa_list
op_assign
id|ifa-&gt;ifa_next
suffix:semicolon
id|kfree
c_func
(paren
id|ifa
)paren
suffix:semicolon
)brace
)brace
r_static
r_inline
r_void
DECL|function|__qeth_append_vlan_ipas_v4
id|__qeth_append_vlan_ipas_v4
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
macro_line|#ifdef QETH_VLAN
r_struct
id|in_ifaddr
op_star
id|ifa
comma
op_star
id|ifanew
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_struct
id|vlan_group
op_star
id|card_group
suffix:semicolon
r_int
id|i
suffix:semicolon
r_int
id|remove
suffix:semicolon
r_struct
id|in_device
op_star
id|vin4_dev
suffix:semicolon
multiline_comment|/*&n;&t; * append all known VLAN IP Addresses corresponding to the real device&n;&t; * card-&gt;dev-&gt;ifindex&n;&t; */
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;to-vips&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|qeth_is_supported
c_func
(paren
id|IPA_FULL_VLAN
)paren
op_logical_or
op_logical_neg
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_open
)paren
)paren
r_return
suffix:semicolon
id|card_group
op_assign
(paren
r_struct
id|vlan_group
op_star
)paren
id|card-&gt;vlangrp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card_group
)paren
r_return
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|VLAN_GROUP_ARRAY_LEN
suffix:semicolon
id|i
op_increment
)paren
(brace
id|vin4_dev
op_assign
id|in_dev_get
c_func
(paren
id|card-&gt;dev
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|vin4_dev
)paren
(brace
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;nodvhol2&quot;
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|card-&gt;dev_name
)paren
suffix:semicolon
r_continue
suffix:semicolon
)brace
id|read_lock
c_func
(paren
op_amp
id|vin4_dev-&gt;lock
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|card_group-&gt;vlan_devices
(braket
id|i
)braket
)paren
op_logical_and
(paren
id|card_group-&gt;vlan_devices
(braket
id|i
)braket
op_member_access_from_pointer
id|flags
op_amp
id|IFF_UP
)paren
)paren
(brace
id|ifa
op_assign
(paren
(paren
r_struct
id|in_device
op_star
)paren
id|card_group-&gt;vlan_devices
(braket
id|i
)braket
op_member_access_from_pointer
id|ip_ptr
)paren
op_member_access_from_pointer
id|ifa_list
suffix:semicolon
r_while
c_loop
(paren
id|ifa
)paren
(brace
id|ifanew
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|in_ifaddr
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ifanew
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;No memory for IP address &quot;
l_string|&quot;handling. Some of the IPs &quot;
l_string|&quot;will not be set on %s.&bslash;n&quot;
comma
id|card-&gt;dev_name
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;TOIPNMEM&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|qeth_clone_ifa
c_func
(paren
id|ifa
comma
id|ifanew
)paren
suffix:semicolon
id|remove
op_assign
id|qeth_add_ifa_to_list
(paren
op_amp
id|card-&gt;ip_new_state.ip_ifa
comma
id|ifanew
)paren
suffix:semicolon
op_star
(paren
(paren
id|__u32
op_star
)paren
(paren
op_amp
id|dbf_text
(braket
l_int|0
)braket
)paren
)paren
op_assign
op_star
(paren
(paren
id|__u32
op_star
)paren
op_amp
id|ifanew-&gt;ifa_address
)paren
suffix:semicolon
op_star
(paren
(paren
id|__u32
op_star
)paren
(paren
op_amp
id|dbf_text
(braket
l_int|4
)braket
)paren
)paren
op_assign
op_star
(paren
(paren
id|__u32
op_star
)paren
op_amp
id|ifanew-&gt;ifa_mask
)paren
suffix:semicolon
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
r_if
c_cond
(paren
id|remove
)paren
(brace
id|kfree
c_func
(paren
id|ifanew
)paren
suffix:semicolon
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;alrdv4rm&quot;
)paren
suffix:semicolon
)brace
)brace
id|ifa
op_assign
id|ifa-&gt;ifa_next
suffix:semicolon
)brace
)brace
id|read_unlock
c_func
(paren
op_amp
id|vin4_dev-&gt;lock
)paren
suffix:semicolon
id|in_dev_put
c_func
(paren
id|vin4_dev
)paren
suffix:semicolon
)brace
macro_line|#endif /* QETH_VLAN */
)brace
r_static
r_inline
r_void
DECL|function|__qeth_append_vlan_ipas_v4_mc
id|__qeth_append_vlan_ipas_v4_mc
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
macro_line|#ifdef QETH_VLAN
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_int
id|i
suffix:semicolon
r_int
id|remove
suffix:semicolon
r_struct
id|vlan_group
op_star
id|card_group
suffix:semicolon
r_struct
id|in_device
op_star
id|vin4_dev
suffix:semicolon
r_struct
id|qeth_ipm_mac
op_star
id|ipmanew
suffix:semicolon
r_struct
id|ip_mc_list
op_star
id|im4
suffix:semicolon
r_char
id|buf
(braket
id|MAX_ADDR_LEN
)braket
suffix:semicolon
id|__u32
id|maddr
suffix:semicolon
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;to-vipms&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|qeth_is_supported
c_func
(paren
id|IPA_FULL_VLAN
)paren
op_logical_or
op_logical_neg
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_open
)paren
)paren
r_return
suffix:semicolon
id|card_group
op_assign
(paren
r_struct
id|vlan_group
op_star
)paren
id|card-&gt;vlangrp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card_group
)paren
r_return
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|VLAN_GROUP_ARRAY_LEN
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|card_group-&gt;vlan_devices
(braket
id|i
)braket
op_logical_or
op_logical_neg
(paren
id|card_group-&gt;vlan_devices
(braket
id|i
)braket
op_member_access_from_pointer
id|flags
op_amp
id|IFF_UP
)paren
)paren
r_continue
suffix:semicolon
id|vin4_dev
op_assign
id|in_dev_get
c_func
(paren
id|card_group-&gt;vlan_devices
(braket
id|i
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|vin4_dev
)paren
(brace
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;novdhol3&quot;
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|card-&gt;dev_name
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|card_group-&gt;vlan_devices
(braket
id|i
)braket
op_member_access_from_pointer
id|name
)paren
suffix:semicolon
r_continue
suffix:semicolon
)brace
id|read_lock
c_func
(paren
op_amp
id|vin4_dev-&gt;lock
)paren
suffix:semicolon
r_for
c_loop
(paren
id|im4
op_assign
id|vin4_dev-&gt;mc_list
suffix:semicolon
id|im4
suffix:semicolon
id|im4
op_assign
id|im4-&gt;next
)paren
(brace
id|qeth_get_mac_for_ipm
c_func
(paren
id|im4-&gt;multiaddr
comma
id|buf
comma
id|vin4_dev-&gt;dev
)paren
suffix:semicolon
id|ipmanew
op_assign
(paren
r_struct
id|qeth_ipm_mac
op_star
)paren
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|qeth_ipm_mac
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ipmanew
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;No memory for IPM address &quot;
l_string|&quot;handling. Multicast VLAN IP %08x&quot;
l_string|&quot;will not be set on %s.&bslash;n&quot;
comma
(paren
id|__u32
)paren
id|im4-&gt;multiaddr
comma
id|card-&gt;dev_name
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;TOIPMNMM&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|memset
c_func
(paren
id|ipmanew
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|qeth_ipm_mac
)paren
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|ipmanew-&gt;mac
comma
id|buf
comma
id|OSA_ADDR_LEN
)paren
suffix:semicolon
id|maddr
op_assign
id|im4-&gt;multiaddr
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
(paren
id|ipmanew-&gt;ip
(braket
l_int|0
)braket
)paren
comma
op_amp
id|maddr
comma
l_int|4
)paren
suffix:semicolon
id|memset
c_func
(paren
op_amp
(paren
id|ipmanew-&gt;ip
(braket
l_int|4
)braket
)paren
comma
l_int|0xff
comma
l_int|12
)paren
suffix:semicolon
id|ipmanew-&gt;next
op_assign
l_int|NULL
suffix:semicolon
id|remove
op_assign
id|qeth_add_mc_ifa_to_list
(paren
op_amp
id|card-&gt;ip_mc_new_state.ipm_ifa
comma
id|ipmanew
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%08x&quot;
comma
op_star
(paren
(paren
id|__u32
op_star
)paren
op_amp
id|ipmanew-&gt;ip
)paren
)paren
suffix:semicolon
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|QETH_DBF_HEX4
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|ipmanew-&gt;mac
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
r_if
c_cond
(paren
id|remove
)paren
(brace
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;mlrdv4rm&quot;
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|ipmanew
)paren
suffix:semicolon
)brace
)brace
)brace
id|read_unlock
c_func
(paren
op_amp
id|vin4_dev-&gt;lock
)paren
suffix:semicolon
id|in_dev_put
c_func
(paren
id|vin4_dev
)paren
suffix:semicolon
)brace
macro_line|#endif /* QETH_VLAN */
)brace
r_static
r_struct
id|in_device
op_star
DECL|function|__qeth_get_mc_lock
id|__qeth_get_mc_lock
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_struct
id|in_device
op_star
id|in4_dev
suffix:semicolon
multiline_comment|/* multicast */
multiline_comment|/* clear ip_mc_current_state */
id|qeth_clear_ifamc_list
c_func
(paren
op_amp
id|card-&gt;ip_mc_current_state.ipm_ifa
)paren
suffix:semicolon
multiline_comment|/* take it over */
id|card-&gt;ip_mc_current_state.ipm_ifa
op_assign
id|card-&gt;ip_mc_new_state.ipm_ifa
suffix:semicolon
multiline_comment|/* get new one, we try to have the same order as ifa_list in device&n;&t;   structure, for what reason ever */
id|card-&gt;ip_mc_new_state.ipm_ifa
op_assign
l_int|NULL
suffix:semicolon
id|in4_dev
op_assign
id|in_dev_get
c_func
(paren
id|card-&gt;dev
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|in4_dev
)paren
(brace
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;nodvhol1&quot;
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|card-&gt;dev_name
)paren
suffix:semicolon
r_return
id|ERR_PTR
c_func
(paren
op_minus
id|ENODEV
)paren
suffix:semicolon
)brace
id|read_lock
c_func
(paren
op_amp
id|in4_dev-&gt;lock
)paren
suffix:semicolon
r_return
id|in4_dev
suffix:semicolon
)brace
r_static
r_void
DECL|function|__qeth_takeover_ip_ipms_mc
id|__qeth_takeover_ip_ipms_mc
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_struct
id|in_device
op_star
id|in4_dev
)paren
(brace
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_int
id|remove
suffix:semicolon
r_struct
id|qeth_ipm_mac
op_star
id|ipmanew
suffix:semicolon
r_struct
id|ip_mc_list
op_star
id|im4
suffix:semicolon
r_char
id|buf
(braket
id|MAX_ADDR_LEN
)braket
suffix:semicolon
id|__u32
id|maddr
suffix:semicolon
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;to-ipms&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_open
)paren
)paren
r_for
c_loop
(paren
id|im4
op_assign
id|in4_dev-&gt;mc_list
suffix:semicolon
id|im4
suffix:semicolon
id|im4
op_assign
id|im4-&gt;next
)paren
(brace
id|qeth_get_mac_for_ipm
c_func
(paren
id|im4-&gt;multiaddr
comma
id|buf
comma
id|in4_dev-&gt;dev
)paren
suffix:semicolon
id|ipmanew
op_assign
(paren
r_struct
id|qeth_ipm_mac
op_star
)paren
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|qeth_ipm_mac
)paren
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ipmanew
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;No memory for IPM address &quot;
l_string|&quot;handling. Multicast IP %08x&quot;
l_string|&quot;will not be set on %s.&bslash;n&quot;
comma
(paren
id|__u32
)paren
id|im4-&gt;multiaddr
comma
id|card-&gt;dev_name
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;TOIPMNMM&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|memset
c_func
(paren
id|ipmanew
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|qeth_ipm_mac
)paren
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|ipmanew-&gt;mac
comma
id|buf
comma
id|OSA_ADDR_LEN
)paren
suffix:semicolon
id|maddr
op_assign
id|im4-&gt;multiaddr
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
(paren
id|ipmanew-&gt;ip
(braket
l_int|0
)braket
)paren
comma
op_amp
id|maddr
comma
l_int|4
)paren
suffix:semicolon
id|memset
c_func
(paren
op_amp
(paren
id|ipmanew-&gt;ip
(braket
l_int|4
)braket
)paren
comma
l_int|0xff
comma
l_int|12
)paren
suffix:semicolon
id|ipmanew-&gt;next
op_assign
l_int|NULL
suffix:semicolon
id|remove
op_assign
id|qeth_add_mc_ifa_to_list
c_func
(paren
op_amp
id|card
op_member_access_from_pointer
id|ip_mc_new_state
dot
id|ipm_ifa
comma
id|ipmanew
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%08x&quot;
comma
op_star
(paren
(paren
id|__u32
op_star
)paren
op_amp
id|ipmanew-&gt;ip
)paren
)paren
suffix:semicolon
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|QETH_DBF_HEX4
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|ipmanew-&gt;mac
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
r_if
c_cond
(paren
id|remove
)paren
(brace
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;mlrdy4rm&quot;
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|ipmanew
)paren
suffix:semicolon
)brace
)brace
)brace
id|__qeth_append_vlan_ipas_v4
c_func
(paren
id|card
)paren
suffix:semicolon
id|read_unlock
c_func
(paren
op_amp
id|in4_dev-&gt;lock
)paren
suffix:semicolon
id|in_dev_put
c_func
(paren
id|in4_dev
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_takeover_ip_ipms
id|qeth_takeover_ip_ipms
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_struct
id|in_ifaddr
op_star
id|ifa
comma
op_star
id|ifanew
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_int
id|remove
suffix:semicolon
r_struct
id|in_device
op_star
id|in4_dev
suffix:semicolon
id|QETH_DBF_CARD3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;tips&quot;
comma
id|card
)paren
suffix:semicolon
multiline_comment|/* unicast */
multiline_comment|/* clear ip_current_state */
id|qeth_clear_ifa4_list
c_func
(paren
op_amp
id|card-&gt;ip_current_state.ip_ifa
)paren
suffix:semicolon
multiline_comment|/* take it over */
id|card-&gt;ip_current_state.ip_ifa
op_assign
id|card-&gt;ip_new_state.ip_ifa
suffix:semicolon
id|card-&gt;ip_new_state.ip_ifa
op_assign
l_int|NULL
suffix:semicolon
id|in4_dev
op_assign
id|__qeth_get_mc_lock
c_func
(paren
id|card
)paren
suffix:semicolon
r_if
c_cond
(paren
id|PTR_ERR
c_func
(paren
id|in4_dev
)paren
op_eq
op_minus
id|ENODEV
)paren
r_return
suffix:semicolon
multiline_comment|/* get new one, we try to have the same order as ifa_list in device&n;&t;   structure, for what reason ever */
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;to-ips&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_open
)paren
)paren
op_logical_and
(paren
id|card-&gt;dev-&gt;ip_ptr
)paren
op_logical_and
(paren
(paren
(paren
r_struct
id|in_device
op_star
)paren
id|card-&gt;dev-&gt;ip_ptr
)paren
op_member_access_from_pointer
id|ifa_list
)paren
)paren
(brace
id|ifa
op_assign
(paren
(paren
r_struct
id|in_device
op_star
)paren
id|card-&gt;dev-&gt;ip_ptr
)paren
op_member_access_from_pointer
id|ifa_list
suffix:semicolon
r_while
c_loop
(paren
id|ifa
)paren
(brace
id|ifanew
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|in_ifaddr
)paren
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ifanew
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;No memory for IP address &quot;
l_string|&quot;handling. Some of the IPs &quot;
l_string|&quot;will not be set on %s.&bslash;n&quot;
comma
id|card-&gt;dev_name
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;TOIPNMEM&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|qeth_clone_ifa
c_func
(paren
id|ifa
comma
id|ifanew
)paren
suffix:semicolon
id|remove
op_assign
id|qeth_add_ifa_to_list
c_func
(paren
op_amp
id|card-&gt;ip_new_state
dot
id|ip_ifa
comma
id|ifanew
)paren
suffix:semicolon
op_star
(paren
(paren
id|__u32
op_star
)paren
(paren
op_amp
id|dbf_text
(braket
l_int|0
)braket
)paren
)paren
op_assign
op_star
(paren
(paren
id|__u32
op_star
)paren
op_amp
id|ifanew-&gt;ifa_address
)paren
suffix:semicolon
op_star
(paren
(paren
id|__u32
op_star
)paren
(paren
op_amp
id|dbf_text
(braket
l_int|4
)braket
)paren
)paren
op_assign
op_star
(paren
(paren
id|__u32
op_star
)paren
op_amp
id|ifanew-&gt;ifa_mask
)paren
suffix:semicolon
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
r_if
c_cond
(paren
id|remove
)paren
(brace
id|kfree
c_func
(paren
id|ifanew
)paren
suffix:semicolon
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;alrdy4rm&quot;
)paren
suffix:semicolon
)brace
)brace
id|ifa
op_assign
id|ifa-&gt;ifa_next
suffix:semicolon
)brace
)brace
id|__qeth_append_vlan_ipas_v4
c_func
(paren
id|card
)paren
suffix:semicolon
id|__qeth_takeover_ip_ipms_mc
c_func
(paren
id|card
comma
id|in4_dev
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_get_unique_id
id|qeth_get_unique_id
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
macro_line|#ifdef QETH_IPV6
r_struct
id|ipa_cmd
id|cmd
suffix:semicolon
r_int
id|result
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|qeth_is_supported
c_func
(paren
id|IPA_IPv6
)paren
)paren
(brace
id|card-&gt;unique_id
op_assign
id|UNIQUE_ID_IF_CREATE_ADDR_FAILED
op_or
id|UNIQUE_ID_NOT_BY_CARD
suffix:semicolon
r_return
suffix:semicolon
)brace
id|qeth_fill_ipa_cmd
c_func
(paren
id|card
comma
op_amp
id|cmd
comma
id|IPA_CMD_CREATE_ADDR
comma
l_int|6
)paren
suffix:semicolon
op_star
(paren
(paren
id|__u16
op_star
)paren
op_amp
id|cmd.data.create_destroy_addr.unique_id
(braket
l_int|6
)braket
)paren
op_assign
id|card-&gt;unique_id
suffix:semicolon
id|result
op_assign
id|qeth_send_ipa_cmd
c_func
(paren
id|card
comma
op_amp
id|cmd
comma
l_int|1
comma
id|IPA_CMD_STATE
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|card-&gt;unique_id
op_assign
id|UNIQUE_ID_IF_CREATE_ADDR_FAILED
op_or
id|UNIQUE_ID_NOT_BY_CARD
suffix:semicolon
id|PRINT_WARN
c_func
(paren
l_string|&quot;couldn&squot;t get a unique id from the card on device &quot;
l_string|&quot;%s (result=x%x), using default id. ipv6 &quot;
l_string|&quot;autoconfig on other lpars may lead to duplicate &quot;
l_string|&quot;ip addresses. please use manually &quot;
l_string|&quot;configured ones.&bslash;n&quot;
comma
id|CARD_BUS_ID
c_func
(paren
id|card
)paren
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;unid fld&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
)brace
r_else
(brace
id|card-&gt;unique_id
op_assign
op_star
(paren
(paren
id|__u16
op_star
)paren
op_amp
id|cmd.data.create_destroy_addr.unique_id
(braket
l_int|6
)braket
)paren
suffix:semicolon
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|setup
comma
l_string|&quot;uniqueid&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x&quot;
comma
id|card-&gt;unique_id
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|setup
comma
id|dbf_text
)paren
suffix:semicolon
)brace
macro_line|#else /* QETH_IPV6 */
id|card-&gt;unique_id
op_assign
id|UNIQUE_ID_IF_CREATE_ADDR_FAILED
op_or
id|UNIQUE_ID_NOT_BY_CARD
suffix:semicolon
macro_line|#endif /* QETH_IPV6 */
)brace
r_static
r_void
DECL|function|qeth_put_unique_id
id|qeth_put_unique_id
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
macro_line|#ifdef QETH_IPV6
r_struct
id|ipa_cmd
id|cmd
suffix:semicolon
r_int
id|result
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
multiline_comment|/* is also true, if ipv6 is not supported on the card */
r_if
c_cond
(paren
(paren
id|card-&gt;unique_id
op_amp
id|UNIQUE_ID_NOT_BY_CARD
)paren
op_eq
id|UNIQUE_ID_NOT_BY_CARD
)paren
r_return
suffix:semicolon
id|qeth_fill_ipa_cmd
c_func
(paren
id|card
comma
op_amp
id|cmd
comma
id|IPA_CMD_DESTROY_ADDR
comma
l_int|6
)paren
suffix:semicolon
op_star
(paren
(paren
id|__u16
op_star
)paren
op_amp
id|cmd.data.create_destroy_addr.unique_id
(braket
l_int|6
)braket
)paren
op_assign
id|card-&gt;unique_id
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|cmd.data.create_destroy_addr.unique_id
(braket
l_int|0
)braket
comma
id|card-&gt;dev-&gt;dev_addr
comma
id|OSA_ADDR_LEN
)paren
suffix:semicolon
id|result
op_assign
id|qeth_send_ipa_cmd
c_func
(paren
id|card
comma
op_amp
id|cmd
comma
l_int|1
comma
id|IPA_CMD_STATE
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;unibkfld&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
)brace
macro_line|#else /* QETH_IPV6 */
id|card-&gt;unique_id
op_assign
id|UNIQUE_ID_IF_CREATE_ADDR_FAILED
op_or
id|UNIQUE_ID_NOT_BY_CARD
suffix:semicolon
macro_line|#endif /* QETH_IPV6 */
)brace
r_static
r_inline
r_void
DECL|function|__qeth_setparms_hstr
id|__qeth_setparms_hstr
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_int
id|result
suffix:semicolon
r_if
c_cond
(paren
(paren
id|card-&gt;link_type
op_ne
id|QETH_MPC_LINK_TYPE_HSTR
)paren
op_logical_and
(paren
id|card-&gt;link_type
op_ne
id|QETH_MPC_LINK_TYPE_LANE_TR
)paren
)paren
r_return
suffix:semicolon
id|QETH_DBF_CARD3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;hstr&quot;
comma
id|card
)paren
suffix:semicolon
r_if
c_cond
(paren
id|qeth_is_adp_supported
c_func
(paren
id|IPA_SETADP_SET_BROADCAST_MODE
)paren
)paren
(brace
id|result
op_assign
id|qeth_send_setadapterparms_mode
(paren
id|card
comma
id|IPA_SETADP_SET_BROADCAST_MODE
comma
id|card-&gt;options.broadcast_mode
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;couldn&squot;t set broadcast mode on &quot;
l_string|&quot;device %s: x%x&bslash;n&quot;
comma
id|CARD_BUS_ID
c_func
(paren
id|card
)paren
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_CARD1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;STBRDCST&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|1
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|card-&gt;options.broadcast_mode
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;set adapter parameters not available &quot;
l_string|&quot;to set broadcast mode, using ALLRINGS &quot;
l_string|&quot;on device %s:&bslash;n&quot;
comma
id|CARD_BUS_ID
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
id|QETH_DBF_CARD1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;NOBC&quot;
comma
id|card
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|qeth_is_adp_supported
c_func
(paren
id|IPA_SETADP_SET_BROADCAST_MODE
)paren
)paren
(brace
id|result
op_assign
id|qeth_send_setadapterparms_mode
(paren
id|card
comma
id|IPA_SETADP_ALTER_MAC_ADDRESS
comma
id|card-&gt;options.macaddr_mode
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;couldn&squot;t set macaddr mode on &quot;
l_string|&quot;device %s: x%x&bslash;n&quot;
comma
id|CARD_BUS_ID
c_func
(paren
id|card
)paren
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_CARD1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;STMACMOD&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|1
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|card-&gt;options.macaddr_mode
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;set adapter parameters not available &quot;
l_string|&quot;to set macaddr mode, using NONCANONICAL &quot;
l_string|&quot;on device %s:&bslash;n&quot;
comma
id|CARD_BUS_ID
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
id|QETH_DBF_CARD1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;NOMA&quot;
comma
id|card
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|qeth_do_setadapterparms_stuff
id|qeth_do_setadapterparms_stuff
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_int
id|result
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|qeth_is_supported
c_func
(paren
id|IPA_SETADAPTERPARMS
)paren
)paren
(brace
r_return
suffix:semicolon
)brace
id|QETH_DBF_CARD4
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;stap&quot;
comma
id|card
)paren
suffix:semicolon
id|result
op_assign
id|qeth_send_setadapterparms_query
c_func
(paren
id|card
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;couldn&squot;t set adapter parameters on device %s: &quot;
l_string|&quot;x%x&bslash;n&quot;
comma
id|CARD_BUS_ID
c_func
(paren
id|card
)paren
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_CARD1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;SETADPFL&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|1
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;spap%4x&quot;
comma
id|card-&gt;adp_supported
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
r_if
c_cond
(paren
id|qeth_is_adp_supported
c_func
(paren
id|IPA_SETADP_ALTER_MAC_ADDRESS
)paren
)paren
(brace
id|QETH_DBF_CARD3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;rdmc&quot;
comma
id|card
)paren
suffix:semicolon
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|setup
comma
l_string|&quot;rdmc&quot;
comma
id|card
)paren
suffix:semicolon
id|result
op_assign
id|qeth_send_setadapterparms_change_addr
c_func
(paren
id|card
comma
id|IPA_SETADP_ALTER_MAC_ADDRESS
comma
id|CHANGE_ADDR_READ_MAC
comma
id|card-&gt;dev
op_member_access_from_pointer
id|dev_addr
comma
id|OSA_ADDR_LEN
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;couldn&squot;t get MAC address on &quot;
l_string|&quot;device %s: x%x&bslash;n&quot;
comma
id|CARD_BUS_ID
c_func
(paren
id|card
)paren
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_CARD1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;NOMACADD&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|1
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
)brace
r_else
(brace
id|QETH_DBF_HEX2
c_func
(paren
l_int|0
comma
id|setup
comma
id|card-&gt;dev-&gt;dev_addr
comma
id|__max
c_func
(paren
id|OSA_ADDR_LEN
comma
id|QETH_DBF_SETUP_LEN
)paren
)paren
suffix:semicolon
id|QETH_DBF_HEX3
c_func
(paren
l_int|0
comma
id|trace
comma
id|card-&gt;dev-&gt;dev_addr
comma
id|__max
c_func
(paren
id|OSA_ADDR_LEN
comma
id|QETH_DBF_TRACE_LEN
)paren
)paren
suffix:semicolon
)brace
)brace
id|__qeth_setparms_hstr
c_func
(paren
id|card
)paren
suffix:semicolon
)brace
r_static
r_inline
r_void
DECL|function|__qeth_start_vlan_assist
id|__qeth_start_vlan_assist
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
macro_line|#ifdef QETH_VLAN
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_int
id|result
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|qeth_is_supported
c_func
(paren
id|IPA_FULL_VLAN
)paren
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;VLAN not supported on %s&bslash;n&quot;
comma
id|card-&gt;dev_name
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;vlnotsup&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|result
op_assign
id|qeth_send_setassparms_simple_without_data
c_func
(paren
id|card
comma
id|IPA_VLAN_PRIO
comma
id|IPA_CMD_ASS_START
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;enavlan&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;Could not start vlan &quot;
l_string|&quot;assist on %s: 0x%x, continuing&bslash;n&quot;
comma
id|card-&gt;dev_name
comma
id|result
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;VLAN%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|card-&gt;dev-&gt;features
op_or_assign
id|NETIF_F_HW_VLAN_TX
op_or
id|NETIF_F_HW_VLAN_RX
suffix:semicolon
macro_line|#endif /* QETH_VLAN */
)brace
r_static
r_inline
r_void
DECL|function|__qeth_start_mc_assist
id|__qeth_start_mc_assist
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_int
id|result
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|qeth_is_supported
c_func
(paren
id|IPA_MULTICASTING
)paren
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;multicasting not supported on %s&bslash;n&quot;
comma
id|card-&gt;dev_name
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;mcnotsup&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|result
op_assign
id|qeth_send_setassparms_simple_without_data
c_func
(paren
id|card
comma
id|IPA_MULTICASTING
comma
id|IPA_CMD_ASS_START
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;enamcass&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;Could not start multicast &quot;
l_string|&quot;assist on %s: 0x%x, continuing&bslash;n&quot;
comma
id|card-&gt;dev_name
comma
id|result
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;MCAS%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|card-&gt;dev-&gt;flags
op_or_assign
id|IFF_MULTICAST
suffix:semicolon
)brace
r_static
r_int
DECL|function|__qeth_softsetup_enable_ipv6
id|__qeth_softsetup_enable_ipv6
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_int
id|do_a_startlan6
)paren
(brace
r_int
id|result
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_if
c_cond
(paren
id|do_a_startlan6
)paren
(brace
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;startln6&quot;
)paren
suffix:semicolon
id|netif_stop_queue
c_func
(paren
id|card-&gt;dev
)paren
suffix:semicolon
id|result
op_assign
id|qeth_send_startlan
c_func
(paren
id|card
comma
l_int|6
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;stl6%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;is_softsetup
comma
l_int|0
)paren
suffix:semicolon
multiline_comment|/* do not return an error */
r_if
c_cond
(paren
(paren
id|result
op_eq
l_int|0xe080
)paren
op_logical_or
(paren
id|result
op_eq
l_int|0xf080
)paren
)paren
id|result
op_assign
l_int|0
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
)brace
id|netif_wake_queue
c_func
(paren
id|card-&gt;dev
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;qipassi6&quot;
)paren
suffix:semicolon
id|result
op_assign
id|qeth_send_qipassist
c_func
(paren
id|card
comma
l_int|6
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;couldn&squot;t send QIPASSIST6 on %s: 0x%x&bslash;n&quot;
comma
id|card-&gt;dev_name
comma
id|result
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;QIP6%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;is_softsetup
comma
l_int|0
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x%4x&quot;
comma
id|card-&gt;ipa6_supported
comma
id|card-&gt;ipa6_enabled
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;enaipv46&quot;
)paren
suffix:semicolon
id|result
op_assign
id|qeth_send_setassparms_simple_with_data
c_func
(paren
id|card
comma
id|IPA_IPv6
comma
id|IPA_CMD_ASS_START
comma
l_int|3
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;Could not enable IPv4&amp;6 assist &quot;
l_string|&quot;on %s: 0x%x, continuing&bslash;n&quot;
comma
id|card-&gt;dev_name
comma
id|result
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;I46A%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
multiline_comment|/* go on */
)brace
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;enaipv6&quot;
)paren
suffix:semicolon
id|result
op_assign
id|qeth_send_setassparms_simple_without_data6
c_func
(paren
id|card
comma
id|IPA_IPv6
comma
id|IPA_CMD_ASS_START
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;Could not start IPv6 assist &quot;
l_string|&quot;on %s: 0x%x, continuing&bslash;n&quot;
comma
id|card-&gt;dev_name
comma
id|result
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;I6AS%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
multiline_comment|/* go on */
)brace
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;enapstr6&quot;
)paren
suffix:semicolon
id|result
op_assign
id|qeth_send_setassparms_simple_without_data6
c_func
(paren
id|card
comma
id|IPA_PASSTHRU
comma
id|IPA_CMD_ASS_START
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;Could not enable passthrough &quot;
l_string|&quot;on %s: 0x%x, continuing&bslash;n&quot;
comma
id|card-&gt;dev_name
comma
id|result
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;PSTR%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
multiline_comment|/* go on */
)brace
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|__qeth_softsetup_start_assists
id|__qeth_softsetup_start_assists
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_int
id|result
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_int
id|do_a_startlan6
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_softsetup
)paren
)paren
r_return
l_int|0
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;enable_routing_attempts4
comma
id|QETH_ROUTING_ATTEMPTS
)paren
suffix:semicolon
macro_line|#ifdef QETH_IPV6
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;enable_routing_attempts6
comma
id|QETH_ROUTING_ATTEMPTS
)paren
suffix:semicolon
macro_line|#endif /* QETH_IPV6 */
r_if
c_cond
(paren
(paren
op_logical_neg
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_startlaned
)paren
)paren
op_logical_and
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;startlan_attempts
)paren
)paren
)paren
(brace
id|atomic_dec
c_func
(paren
op_amp
id|card-&gt;startlan_attempts
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;startlan&quot;
)paren
suffix:semicolon
id|netif_stop_queue
c_func
(paren
id|card-&gt;dev
)paren
suffix:semicolon
id|result
op_assign
id|qeth_send_startlan
c_func
(paren
id|card
comma
l_int|4
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;couldn&squot;t send STARTLAN on %s &quot;
l_string|&quot;(CHPID 0x%X): 0x%x (%s)&bslash;n&quot;
comma
id|card-&gt;dev_name
comma
id|card-&gt;chpid
comma
id|result
comma
(paren
id|result
op_eq
l_int|0xe080
)paren
ques
c_cond
l_string|&quot;startlan disabled (link &quot;
l_string|&quot;failure -- please check the &quot;
l_string|&quot;network, plug in the cable or &quot;
l_string|&quot;enable the OSA port&quot;
suffix:colon
(paren
id|result
op_eq
l_int|0xf080
)paren
ques
c_cond
l_string|&quot;startlan disabled (VM: LAN &quot;
"&bslash;"
l_string|&quot;is offline for functions &quot;
"&bslash;"
l_string|&quot;requiring LAN access.&quot;
suffix:colon
l_string|&quot;unknown return code&quot;
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;stln%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;is_softsetup
comma
l_int|0
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;is_startlaned
comma
l_int|0
)paren
suffix:semicolon
multiline_comment|/* do not return an error */
r_if
c_cond
(paren
(paren
id|result
op_eq
l_int|0xe080
)paren
op_logical_or
(paren
id|result
op_eq
l_int|0xf080
)paren
)paren
(brace
id|result
op_assign
l_int|0
suffix:semicolon
)brace
r_return
id|result
suffix:semicolon
)brace
id|do_a_startlan6
op_assign
l_int|1
suffix:semicolon
)brace
id|netif_wake_queue
c_func
(paren
id|card-&gt;dev
)paren
suffix:semicolon
id|qeth_do_setadapterparms_stuff
c_func
(paren
id|card
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|qeth_is_supported
c_func
(paren
id|IPA_ARP_PROCESSING
)paren
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;oops... ARP processing not supported &quot;
l_string|&quot;on %s!&bslash;n&quot;
comma
id|card-&gt;dev_name
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;NOarpPRC&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;enaARPpr&quot;
)paren
suffix:semicolon
id|result
op_assign
id|qeth_send_setassparms_simple_without_data
(paren
id|card
comma
id|IPA_ARP_PROCESSING
comma
id|IPA_CMD_ASS_START
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;Could not start ARP processing &quot;
l_string|&quot;assist on %s: 0x%x&bslash;n&quot;
comma
id|card-&gt;dev_name
comma
id|result
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;ARPp%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;is_softsetup
comma
l_int|0
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|qeth_is_supported
c_func
(paren
id|IPA_IP_FRAGMENTATION
)paren
)paren
(brace
id|PRINT_INFO
c_func
(paren
l_string|&quot;IP fragmentation supported on &quot;
l_string|&quot;%s... :-)&bslash;n&quot;
comma
id|card-&gt;dev_name
)paren
suffix:semicolon
multiline_comment|/* start it */
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;enaipfrg&quot;
)paren
suffix:semicolon
id|result
op_assign
id|qeth_send_setassparms_simple_without_data
(paren
id|card
comma
id|IPA_IP_FRAGMENTATION
comma
id|IPA_CMD_ASS_START
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;Could not start IP fragmenting &quot;
l_string|&quot;assist on %s: 0x%x, continuing&bslash;n&quot;
comma
id|card-&gt;dev_name
comma
id|result
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;IFRG%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
multiline_comment|/* go on */
)brace
)brace
r_if
c_cond
(paren
id|card-&gt;options.fake_ll
op_eq
id|FAKE_LL
)paren
(brace
r_if
c_cond
(paren
id|qeth_is_supported
c_func
(paren
id|IPA_SOURCE_MAC_AVAIL
)paren
)paren
(brace
multiline_comment|/* start it */
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;enainsrc&quot;
)paren
suffix:semicolon
id|result
op_assign
id|qeth_send_setassparms_simple_without_data
(paren
id|card
comma
id|IPA_SOURCE_MAC_AVAIL
comma
id|IPA_CMD_ASS_START
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|PRINT_WARN
(paren
l_string|&quot;Could not start inbound source &quot;
l_string|&quot;assist on %s: 0x%x, continuing&bslash;n&quot;
comma
id|card-&gt;dev_name
comma
id|result
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;INSR%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
multiline_comment|/* go on */
)brace
)brace
r_else
(brace
id|PRINT_INFO
c_func
(paren
l_string|&quot;Inbound source addresses not &quot;
l_string|&quot;supported on %s&bslash;n&quot;
comma
id|card-&gt;dev_name
)paren
suffix:semicolon
)brace
)brace
id|__qeth_start_vlan_assist
c_func
(paren
id|card
)paren
suffix:semicolon
id|__qeth_start_mc_assist
c_func
(paren
id|card
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|qeth_is_supported
c_func
(paren
id|IPA_IPv6
)paren
)paren
(brace
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;ipv6ntsp&quot;
)paren
suffix:semicolon
id|PRINT_WARN
c_func
(paren
l_string|&quot;IPv6 not supported on %s&bslash;n&quot;
comma
id|card-&gt;dev_name
)paren
suffix:semicolon
)brace
r_else
(brace
id|result
op_assign
id|__qeth_softsetup_enable_ipv6
c_func
(paren
id|card
comma
id|do_a_startlan6
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
op_ne
l_int|0
)paren
r_return
id|result
suffix:semicolon
)brace
id|card-&gt;broadcast_capable
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|qeth_is_supported
c_func
(paren
id|IPA_FILTERING
)paren
)paren
(brace
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;filtntsp&quot;
)paren
suffix:semicolon
id|PRINT_WARN
c_func
(paren
l_string|&quot;Broadcasting not supported on %s&bslash;n&quot;
comma
id|card-&gt;dev_name
)paren
suffix:semicolon
)brace
r_else
(brace
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;enafiltr&quot;
)paren
suffix:semicolon
id|result
op_assign
id|qeth_send_setassparms_simple_without_data
(paren
id|card
comma
id|IPA_FILTERING
comma
id|IPA_CMD_ASS_START
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;Could not enable broadcast &quot;
l_string|&quot;filtering on %s: &quot;
l_string|&quot;0x%x, continuing&bslash;n&quot;
comma
id|card-&gt;dev_name
comma
id|result
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;FLT1%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
r_goto
id|go_on_filt
suffix:semicolon
)brace
id|result
op_assign
id|qeth_send_setassparms_simple_with_data
(paren
id|card
comma
id|IPA_FILTERING
comma
id|IPA_CMD_ASS_CONFIGURE
comma
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;Could not set up broadcast &quot;
l_string|&quot;filtering on %s: &quot;
l_string|&quot;0x%x, continuing&bslash;n&quot;
comma
id|card-&gt;dev_name
comma
id|result
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;FLT2%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
r_goto
id|go_on_filt
suffix:semicolon
)brace
id|card-&gt;dev-&gt;flags
op_or_assign
id|IFF_BROADCAST
suffix:semicolon
id|card-&gt;broadcast_capable
op_assign
l_int|1
suffix:semicolon
)brace
id|go_on_filt
suffix:colon
r_if
c_cond
(paren
id|card-&gt;options.checksum_type
op_eq
id|HW_CHECKSUMMING
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|qeth_is_supported
c_func
(paren
id|IPA_INBOUND_CHECKSUM
)paren
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;Inbound HW checksumming not &quot;
l_string|&quot;supported on %s, continuing &quot;
l_string|&quot;using inbound sw checksumming&bslash;n&quot;
comma
id|card-&gt;dev_name
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;ibckntsp&quot;
)paren
suffix:semicolon
id|card-&gt;options.checksum_type
op_assign
id|SW_CHECKSUMMING
suffix:semicolon
)brace
r_else
(brace
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;ibcksupp&quot;
)paren
suffix:semicolon
id|result
op_assign
id|qeth_send_setassparms_simple_without_data
(paren
id|card
comma
id|IPA_INBOUND_CHECKSUM
comma
id|IPA_CMD_ASS_START
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;Could not start inbound &quot;
l_string|&quot;checksumming on %s: 0x%x, &quot;
l_string|&quot;continuing using &quot;
l_string|&quot;inbound sw checksumming&bslash;n&quot;
comma
id|card-&gt;dev_name
comma
id|result
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;SIBC%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|card-&gt;options.checksum_type
op_assign
id|SW_CHECKSUMMING
suffix:semicolon
r_goto
id|go_on_checksum
suffix:semicolon
)brace
id|result
op_assign
id|qeth_send_setassparms_simple_with_data
(paren
id|card
comma
id|IPA_INBOUND_CHECKSUM
comma
id|IPA_CMD_ASS_ENABLE
comma
id|card-&gt;csum_enable_mask
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;Could not enable inbound &quot;
"&bslash;"
l_string|&quot;checksumming on %s: 0x%x, &quot;
"&bslash;"
l_string|&quot;continuing using &quot;
"&bslash;"
l_string|&quot;inbound sw checksumming&bslash;n&quot;
comma
id|card-&gt;dev_name
comma
id|result
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;EIBC%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|card-&gt;options.checksum_type
op_assign
id|SW_CHECKSUMMING
suffix:semicolon
r_goto
id|go_on_checksum
suffix:semicolon
)brace
)brace
)brace
id|go_on_checksum
suffix:colon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;is_softsetup
comma
l_int|1
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_inline
r_void
DECL|function|__qeth_softsetup_routingv4
id|__qeth_softsetup_routingv4
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_int
id|result
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;enable_routing_attempts4
)paren
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card-&gt;options.routing_type4
)paren
(brace
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;enable_routing_attempts4
comma
l_int|0
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;rt4fld
comma
l_int|0
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;strtg4%2x&quot;
comma
id|card-&gt;options.routing_type4
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|result
op_assign
id|qeth_send_setrtg
c_func
(paren
id|card
comma
id|card-&gt;options.routing_type4
comma
l_int|4
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|result
)paren
(brace
multiline_comment|/* routing set correctly */
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;enable_routing_attempts4
comma
l_int|0
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;rt4fld
comma
l_int|0
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|atomic_dec_return
c_func
(paren
op_amp
id|card-&gt;enable_routing_attempts4
)paren
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;couldn&squot;t set up v4 routing type &quot;
l_string|&quot;on %s: 0x%x (%s).&bslash;nWill try &quot;
l_string|&quot;next time again.&bslash;n&quot;
comma
id|card-&gt;dev_name
comma
id|result
comma
(paren
(paren
id|result
op_eq
l_int|0xe010
)paren
op_logical_or
(paren
id|result
op_eq
l_int|0xe008
)paren
)paren
ques
c_cond
l_string|&quot;primary already defined&quot;
suffix:colon
(paren
(paren
id|result
op_eq
l_int|0xe011
)paren
op_logical_or
(paren
id|result
op_eq
l_int|0xe009
)paren
)paren
ques
c_cond
l_string|&quot;secondary already defined&quot;
suffix:colon
(paren
id|result
op_eq
l_int|0xe012
)paren
ques
c_cond
l_string|&quot;invalid indicator&quot;
suffix:colon
l_string|&quot;unknown return code&quot;
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;sRT4%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;rt4fld
comma
l_int|1
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
)brace
r_else
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;couldn&squot;t set up v4 routing type &quot;
l_string|&quot;on %s: 0x%x (%s).&bslash;nTrying to &quot;
l_string|&quot;continue without routing.&bslash;n&quot;
comma
id|card-&gt;dev_name
comma
id|result
comma
(paren
(paren
id|result
op_eq
l_int|0xe010
)paren
op_logical_or
(paren
id|result
op_eq
l_int|0xe008
)paren
)paren
ques
c_cond
l_string|&quot;primary already defined&quot;
suffix:colon
(paren
(paren
id|result
op_eq
l_int|0xe011
)paren
op_logical_or
(paren
id|result
op_eq
l_int|0xe009
)paren
)paren
ques
c_cond
l_string|&quot;secondary already defined&quot;
suffix:colon
(paren
id|result
op_eq
l_int|0xe012
)paren
ques
c_cond
l_string|&quot;invalid indicator&quot;
suffix:colon
l_string|&quot;unknown return code&quot;
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;SRT4%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;rt4fld
comma
l_int|1
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|__qeth_softsetup_routingv6
id|__qeth_softsetup_routingv6
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
macro_line|#ifdef QETH_IPV6
r_int
id|result
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;enable_routing_attempts6
)paren
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card-&gt;options.routing_type6
op_logical_or
(paren
(paren
id|card-&gt;type
op_eq
id|QETH_CARD_TYPE_OSAE
)paren
op_logical_and
(paren
(paren
id|card-&gt;options.routing_type6
op_amp
id|ROUTER_MASK
)paren
op_eq
id|MULTICAST_ROUTER
)paren
op_logical_and
op_logical_neg
id|qeth_is_supported6
c_func
(paren
id|IPA_OSA_MC_ROUTER_AVAIL
)paren
)paren
)paren
(brace
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;enable_routing_attempts6
comma
l_int|0
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;rt6fld
comma
l_int|0
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;strtg6%2x&quot;
comma
id|card-&gt;options.routing_type6
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|result
op_assign
id|qeth_send_setrtg
c_func
(paren
id|card
comma
id|card-&gt;options.routing_type6
comma
l_int|6
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|result
)paren
(brace
multiline_comment|/* routing set correctly */
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;enable_routing_attempts6
comma
l_int|0
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;rt6fld
comma
l_int|0
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|atomic_dec_return
c_func
(paren
op_amp
id|card-&gt;enable_routing_attempts6
)paren
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;couldn&squot;t set up v6 routing type &quot;
l_string|&quot;on %s: 0x%x (%s).&bslash;nWill try &quot;
l_string|&quot;next time again.&bslash;n&quot;
comma
id|card-&gt;dev_name
comma
id|result
comma
(paren
(paren
id|result
op_eq
l_int|0xe010
)paren
op_logical_or
(paren
id|result
op_eq
l_int|0xe008
)paren
)paren
ques
c_cond
l_string|&quot;primary already defined&quot;
suffix:colon
(paren
(paren
id|result
op_eq
l_int|0xe011
)paren
op_logical_or
(paren
id|result
op_eq
l_int|0xe009
)paren
)paren
ques
c_cond
l_string|&quot;secondary already defined&quot;
suffix:colon
(paren
id|result
op_eq
l_int|0xe012
)paren
ques
c_cond
l_string|&quot;invalid indicator&quot;
suffix:colon
l_string|&quot;unknown return code&quot;
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;sRT6%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;rt6fld
comma
l_int|1
)paren
suffix:semicolon
)brace
r_else
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;couldn&squot;t set up v6 routing type &quot;
l_string|&quot;on %s: 0x%x (%s).&bslash;nTrying to &quot;
l_string|&quot;continue without routing.&bslash;n&quot;
comma
id|card-&gt;dev_name
comma
id|result
comma
(paren
(paren
id|result
op_eq
l_int|0xe010
)paren
op_logical_or
(paren
id|result
op_eq
l_int|0xe008
)paren
)paren
ques
c_cond
l_string|&quot;primary already defined&quot;
suffix:colon
(paren
(paren
id|result
op_eq
l_int|0xe011
)paren
op_logical_or
(paren
id|result
op_eq
l_int|0xe009
)paren
)paren
ques
c_cond
l_string|&quot;secondary already defined&quot;
suffix:colon
(paren
id|result
op_eq
l_int|0xe012
)paren
ques
c_cond
l_string|&quot;invalid indicator&quot;
suffix:colon
l_string|&quot;unknown return code&quot;
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;SRT6%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;rt6fld
comma
l_int|1
)paren
suffix:semicolon
)brace
macro_line|#endif /* QETH_IPV6 */
)brace
r_static
r_int
DECL|function|qeth_softsetup_card
id|qeth_softsetup_card
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_int
id|wait_for_lock
)paren
(brace
r_int
id|result
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_int
id|use_setip_retries
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|wait_for_lock
op_eq
id|QETH_WAIT_FOR_LOCK
)paren
(brace
id|down
c_func
(paren
op_amp
id|card-&gt;softsetup_sema
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|wait_for_lock
op_eq
id|QETH_DONT_WAIT_FOR_LOCK
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|down_trylock
c_func
(paren
op_amp
id|card-&gt;softsetup_sema
)paren
)paren
(brace
r_return
op_minus
id|EAGAIN
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|wait_for_lock
op_eq
id|QETH_LOCK_ALREADY_HELD
)paren
(brace
id|use_setip_retries
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* we are in recovery and don&squot;t want&n;&t;&t;&t;&t;&t;   to repeat setting ips on and on */
)brace
r_else
(brace
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|qeth_save_dev_flag_state
c_func
(paren
id|card
)paren
suffix:semicolon
id|QETH_DBF_CARD1
c_func
(paren
l_int|0
comma
id|trace
comma
id|wait_for_lock
ques
c_cond
l_string|&quot;sscw&quot;
suffix:colon
l_string|&quot;sscn&quot;
comma
id|card
)paren
suffix:semicolon
id|result
op_assign
id|__qeth_softsetup_start_assists
c_func
(paren
id|card
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
r_goto
id|out
suffix:semicolon
id|__qeth_softsetup_routingv4
c_func
(paren
id|card
)paren
suffix:semicolon
id|__qeth_softsetup_routingv6
c_func
(paren
id|card
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;delvipa&quot;
)paren
suffix:semicolon
id|qeth_set_vipas
c_func
(paren
id|card
comma
l_int|0
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;toip/ms&quot;
)paren
suffix:semicolon
id|qeth_takeover_ip_ipms
c_func
(paren
id|card
)paren
suffix:semicolon
id|qeth_takeover_ip_ipms6
c_func
(paren
id|card
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;setvipa&quot;
)paren
suffix:semicolon
id|qeth_set_vipas
c_func
(paren
id|card
comma
l_int|1
)paren
suffix:semicolon
id|result
op_assign
id|qeth_setips
c_func
(paren
id|card
comma
id|use_setip_retries
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
multiline_comment|/* by now, qeth_setips does not return errors */
id|PRINT_WARN
c_func
(paren
l_string|&quot;couldn&squot;t set up IPs on %s: 0x%x&bslash;n&quot;
comma
id|card-&gt;dev_name
comma
id|result
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;SSIP%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;is_softsetup
comma
l_int|0
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|result
op_assign
id|qeth_setipms
c_func
(paren
id|card
comma
id|use_setip_retries
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
multiline_comment|/* by now, qeth_setipms does not return errors */
id|PRINT_WARN
c_func
(paren
l_string|&quot;couldn&squot;t set up multicast IPs on %s: 0x%x&bslash;n&quot;
comma
id|card-&gt;dev_name
comma
id|result
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;ssim%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;is_softsetup
comma
l_int|0
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|out
suffix:colon
r_if
c_cond
(paren
op_logical_neg
id|result
)paren
(brace
id|netif_wake_queue
c_func
(paren
id|card-&gt;dev
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|wait_for_lock
op_ne
id|QETH_LOCK_ALREADY_HELD
)paren
id|up
c_func
(paren
op_amp
id|card-&gt;softsetup_sema
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_softsetup_thread
id|qeth_softsetup_thread
c_func
(paren
r_void
op_star
id|param
)paren
(brace
r_char
id|name
(braket
l_int|15
)braket
suffix:semicolon
r_struct
id|qeth_card
op_star
id|card
op_assign
(paren
r_struct
id|qeth_card
op_star
)paren
id|param
suffix:semicolon
multiline_comment|/* set a nice name ... */
id|sprintf
c_func
(paren
id|name
comma
l_string|&quot;qethsoftd%s&quot;
comma
id|CARD_BUS_ID
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
id|daemonize
c_func
(paren
id|name
)paren
suffix:semicolon
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;ssth&quot;
comma
id|card
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;softsetup_thread_is_running
comma
l_int|1
)paren
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
suffix:semicolon
)paren
(brace
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;shutdown_phase
)paren
)paren
r_goto
id|out
suffix:semicolon
id|down_interruptible
c_func
(paren
op_amp
id|card-&gt;softsetup_thread_sem
)paren
suffix:semicolon
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;ssst&quot;
comma
id|card
)paren
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;shutdown_phase
)paren
)paren
r_goto
id|out
suffix:semicolon
r_while
c_loop
(paren
id|qeth_softsetup_card
c_func
(paren
id|card
comma
id|QETH_DONT_WAIT_FOR_LOCK
)paren
op_eq
op_minus
id|EAGAIN
)paren
(brace
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;shutdown_phase
)paren
)paren
r_goto
id|out
suffix:semicolon
id|qeth_wait_nonbusy
c_func
(paren
id|QETH_IDLE_WAIT_TIME
)paren
suffix:semicolon
)brace
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;sssd&quot;
comma
id|card
)paren
suffix:semicolon
id|netif_wake_queue
c_func
(paren
id|card-&gt;dev
)paren
suffix:semicolon
)brace
id|out
suffix:colon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;softsetup_thread_is_running
comma
l_int|0
)paren
suffix:semicolon
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;lsst&quot;
comma
id|card
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_softsetup_thread_starter
id|qeth_softsetup_thread_starter
c_func
(paren
r_void
op_star
id|data
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
(paren
r_struct
id|qeth_card
op_star
)paren
id|data
suffix:semicolon
id|QETH_DBF_CARD4
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;ssts&quot;
comma
id|card
)paren
suffix:semicolon
id|sema_init
c_func
(paren
op_amp
id|card-&gt;softsetup_thread_sem
comma
l_int|0
)paren
suffix:semicolon
id|kernel_thread
c_func
(paren
id|qeth_softsetup_thread
comma
id|card
comma
id|SIGCHLD
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_start_reinit_thread
id|qeth_start_reinit_thread
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
multiline_comment|/* we allow max 2 reinit threads, one could be just about to&n;&t; * finish and the next would be waiting. another waiting&n;&t; * reinit_thread is not necessary. */
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;reinit_counter
)paren
OL
l_int|2
)paren
(brace
id|atomic_inc
c_func
(paren
op_amp
id|card-&gt;reinit_counter
)paren
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;shutdown_phase
)paren
)paren
(brace
id|atomic_dec
c_func
(paren
op_amp
id|card-&gt;reinit_counter
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;stri&quot;
comma
id|card
)paren
suffix:semicolon
id|PRINT_STUPID
c_func
(paren
l_string|&quot;starting reinit-thread&bslash;n&quot;
)paren
suffix:semicolon
id|kernel_thread
c_func
(paren
id|qeth_reinit_thread
comma
id|card
comma
id|SIGCHLD
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|qeth_recover
id|qeth_recover
c_func
(paren
r_void
op_star
id|data
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
r_int
id|i
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
id|card
op_assign
(paren
r_struct
id|qeth_card
op_star
)paren
id|data
suffix:semicolon
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;recv&quot;
comma
id|card
)paren
suffix:semicolon
r_if
c_cond
(paren
id|atomic_compare_and_swap
c_func
(paren
l_int|0
comma
l_int|1
comma
op_amp
id|card-&gt;in_recovery
)paren
)paren
r_return
suffix:semicolon
id|i
op_assign
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;problem
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;PROB%4x&quot;
comma
id|i
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
r_if
c_cond
(paren
id|i
op_ne
id|PROBLEM_TX_TIMEOUT
)paren
id|PRINT_WARN
c_func
(paren
l_string|&quot;recovery was scheduled on device %s (%s) with &quot;
l_string|&quot;problem 0x%x&bslash;n&quot;
comma
id|CARD_BUS_ID
c_func
(paren
id|card
)paren
comma
id|card-&gt;dev_name
comma
id|i
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|i
)paren
(brace
r_case
id|PROBLEM_RECEIVED_IDX_TERMINATE
suffix:colon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;in_recovery
)paren
)paren
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;break_out
comma
id|QETH_BREAKOUT_AGAIN
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|PROBLEM_CARD_HAS_STARTLANED
suffix:colon
id|PRINT_WARN
c_func
(paren
l_string|&quot;You are lucky! Somebody either fixed the &quot;
l_string|&quot;network problem, plugged the cable back in &quot;
l_string|&quot;or enabled the OSA port on %s (CHPID 0x%X). &quot;
l_string|&quot;The link has come up.&bslash;n&quot;
comma
id|card-&gt;dev_name
comma
id|card-&gt;chpid
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;CBIN%4x&quot;
comma
id|i
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;is_softsetup
comma
l_int|0
)paren
suffix:semicolon
id|qeth_set_dev_flag_running
c_func
(paren
id|card
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;enable_routing_attempts4
comma
id|QETH_ROUTING_ATTEMPTS
)paren
suffix:semicolon
id|qeth_clear_ifa4_list
c_func
(paren
op_amp
id|card-&gt;ip_new_state.ip_ifa
)paren
suffix:semicolon
macro_line|#ifdef QETH_IPV6
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;enable_routing_attempts6
comma
id|QETH_ROUTING_ATTEMPTS
)paren
suffix:semicolon
id|qeth_clear_ifa6_list
c_func
(paren
op_amp
id|card-&gt;ip_new_state.ip6_ifa
)paren
suffix:semicolon
macro_line|#endif /* QETH_IPV6 */
id|qeth_clear_ifamc_list
c_func
(paren
op_amp
id|card-&gt;ip_mc_new_state.ipm_ifa
)paren
suffix:semicolon
macro_line|#ifdef QETH_IPV6
id|qeth_clear_ifamc_list
c_func
(paren
op_amp
id|card-&gt;ip_mc_new_state.ipm6_ifa
)paren
suffix:semicolon
macro_line|#endif /* QETH_IPV6 */
id|qeth_refresh_vipa_states
c_func
(paren
id|card
)paren
suffix:semicolon
id|qeth_start_softsetup_thread
c_func
(paren
id|card
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;in_recovery
comma
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|PROBLEM_RESETTING_EVENT_INDICATOR
suffix:colon
multiline_comment|/* we do nothing here */
r_break
suffix:semicolon
r_case
id|PROBLEM_ACTIVATE_CHECK_CONDITION
suffix:colon
r_case
id|PROBLEM_GENERAL_CHECK
suffix:colon
r_case
id|PROBLEM_USER_TRIGGERED_RECOVERY
suffix:colon
r_case
id|PROBLEM_AFFE
suffix:colon
r_case
id|PROBLEM_MACHINE_CHECK
suffix:colon
r_case
id|PROBLEM_BAD_SIGA_RESULT
suffix:colon
r_case
id|PROBLEM_TX_TIMEOUT
suffix:colon
id|qeth_start_reinit_thread
c_func
(paren
id|card
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_static
r_inline
r_void
DECL|function|qeth_schedule_recovery
id|qeth_schedule_recovery
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_if
c_cond
(paren
id|card
)paren
(brace
id|INIT_WORK
c_func
(paren
op_amp
id|card-&gt;tqueue
comma
id|qeth_recover
comma
id|card
)paren
suffix:semicolon
id|schedule_work
c_func
(paren
op_amp
id|card-&gt;tqueue
)paren
suffix:semicolon
)brace
r_else
(brace
id|QETH_DBF_TEXT2
c_func
(paren
l_int|1
comma
id|trace
comma
l_string|&quot;scdnocrd&quot;
)paren
suffix:semicolon
id|PRINT_WARN
c_func
(paren
l_string|&quot;recovery requested to be scheduled &quot;
l_string|&quot;with no card!&bslash;n&quot;
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|qeth_qdio_input_handler
id|qeth_qdio_input_handler
c_func
(paren
r_struct
id|ccw_device
op_star
id|cdev
comma
r_int
r_int
id|status
comma
r_int
r_int
id|qdio_error
comma
r_int
r_int
id|siga_error
comma
r_int
r_int
id|queue
comma
r_int
id|first_element
comma
r_int
id|count
comma
r_int
r_int
id|card_ptr
)paren
(brace
r_struct
id|net_device
op_star
id|dev
suffix:semicolon
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
r_int
id|problem
suffix:semicolon
r_int
id|sbalf15
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;qibhn%s&quot;
comma
id|cdev-&gt;dev.bus_id
)paren
suffix:semicolon
id|QETH_DBF_HEX6
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
id|card
op_assign
(paren
r_struct
id|qeth_card
op_star
)paren
id|card_ptr
suffix:semicolon
macro_line|#ifdef QETH_PERFORMANCE_STATS
id|card-&gt;perf_stats.inbound_start_time
op_assign
id|NOW
suffix:semicolon
macro_line|#endif /* QETH_PERFORMANCE_STATS */
id|dev
op_assign
id|card-&gt;dev
suffix:semicolon
r_if
c_cond
(paren
id|status
op_amp
id|QDIO_STATUS_LOOK_FOR_ERROR
)paren
(brace
r_if
c_cond
(paren
id|status
op_amp
id|QDIO_STATUS_ACTIVATE_CHECK_CONDITION
)paren
(brace
id|problem
op_assign
id|PROBLEM_ACTIVATE_CHECK_CONDITION
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;problem
comma
id|problem
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;IHACTQCK&quot;
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x%4x&quot;
comma
id|first_element
comma
id|count
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x%4x&quot;
comma
id|queue
comma
id|status
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|QETH_DBF_CARD1
c_func
(paren
l_int|1
comma
id|trace
comma
l_string|&quot;qscd&quot;
comma
id|card
)paren
suffix:semicolon
id|qeth_schedule_recovery
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|sbalf15
op_assign
(paren
id|card-&gt;inbound_qdio_buffers
(braket
(paren
id|first_element
op_plus
id|count
op_minus
l_int|1
)paren
op_amp
id|QDIO_MAX_BUFFERS_PER_Q
)braket
dot
id|element
(braket
l_int|15
)braket
dot
id|flags
)paren
op_logical_and
l_int|0xff
suffix:semicolon
id|PRINT_STUPID
c_func
(paren
l_string|&quot;inbound qdio transfer error on device %s. &quot;
l_string|&quot;qdio_error=0x%x (more than one: %c), &quot;
l_string|&quot;siga_error=0x%x (more than one: %c), &quot;
l_string|&quot;sbalf15=x%x, bufno=x%x&bslash;n&quot;
comma
id|cdev-&gt;dev.bus_id
comma
id|qdio_error
comma
(paren
id|status
op_amp
id|QDIO_STATUS_MORE_THAN_ONE_QDIO_ERROR
)paren
ques
c_cond
l_char|&squot;y&squot;
suffix:colon
l_char|&squot;n&squot;
comma
id|siga_error
comma
(paren
id|status
op_amp
id|QDIO_STATUS_MORE_THAN_ONE_SIGA_ERROR
)paren
ques
c_cond
l_char|&squot;y&squot;
suffix:colon
l_char|&squot;n&squot;
comma
id|sbalf15
comma
id|first_element
)paren
suffix:semicolon
id|QETH_DBF_CARD1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;IQTI&quot;
comma
id|card
)paren
suffix:semicolon
id|QETH_DBF_CARD1
c_func
(paren
l_int|0
comma
id|qerr
comma
l_string|&quot;IQTI&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x%4x&quot;
comma
id|first_element
comma
id|count
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|qerr
comma
id|dbf_text
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%2x%4x%2x&quot;
comma
id|queue
comma
id|status
comma
id|sbalf15
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|qerr
comma
id|dbf_text
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x%4x&quot;
comma
id|qdio_error
comma
id|siga_error
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|qerr
comma
id|dbf_text
)paren
suffix:semicolon
multiline_comment|/* we inform about error more detailed in&n;&t;&t; * qeth_read_in_buffer() */
)brace
r_for
c_loop
(paren
suffix:semicolon
suffix:semicolon
)paren
(brace
id|qeth_read_in_buffer
c_func
(paren
id|card
comma
id|first_element
)paren
suffix:semicolon
id|qeth_queue_input_buffer
c_func
(paren
id|card
comma
id|first_element
comma
id|QDIO_FLAG_UNDER_INTERRUPT
)paren
suffix:semicolon
id|count
op_decrement
suffix:semicolon
r_if
c_cond
(paren
id|count
)paren
id|first_element
op_assign
(paren
id|first_element
op_plus
l_int|1
)paren
op_amp
(paren
id|QDIO_MAX_BUFFERS_PER_Q
op_minus
l_int|1
)paren
suffix:semicolon
r_else
r_break
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|__qeth_try_to_flush_packets
id|__qeth_try_to_flush_packets
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_int
id|last_pci_hit
comma
r_int
r_int
id|queue
)paren
(brace
r_int
id|switch_state
suffix:semicolon
id|switch_state
op_assign
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;outbound_used_buffers
(braket
id|queue
)braket
)paren
op_le
id|LOW_WATERMARK_PACK
)paren
suffix:semicolon
multiline_comment|/* first_element is the last buffer that we got back from hydra */
r_if
c_cond
(paren
op_logical_neg
id|switch_state
op_logical_and
op_logical_neg
id|last_pci_hit
)paren
r_return
suffix:semicolon
suffix:semicolon
id|QETH_DBF_CARD3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;stchcw&quot;
comma
id|card
)paren
suffix:semicolon
r_if
c_cond
(paren
id|atomic_swap
c_func
(paren
op_amp
id|card-&gt;outbound_ringbuffer_lock
(braket
id|queue
)braket
comma
id|QETH_LOCK_FLUSH
)paren
op_eq
id|QETH_LOCK_UNLOCKED
)paren
(brace
multiline_comment|/* &n;&t;&t; * we stop the queue as we try to not run onto the &n;&t;&t; * outbound_ringbuffer_lock -- this will not prevent it totally,&n;&t;&t; * but reduce it. in high traffic situations, it saves around&n;&t;&t; * 20us per second, hopefully this is amortized by calling &n;&t;&t; * netif_...&n;&t;&t; */
id|netif_stop_queue
c_func
(paren
id|card-&gt;dev
)paren
suffix:semicolon
id|qeth_flush_packed_packets
c_func
(paren
id|card
comma
id|queue
comma
id|QDIO_FLAG_UNDER_INTERRUPT
)paren
suffix:semicolon
multiline_comment|/* &n;&t;&t; * only switch state to non-packing, if the amount of used&n;&t;&t; * buffers decreased&n;&t;&t; */
r_if
c_cond
(paren
id|switch_state
)paren
id|card-&gt;send_state
(braket
id|queue
)braket
op_assign
id|SEND_STATE_DONT_PACK
suffix:semicolon
id|netif_wake_queue
c_func
(paren
id|card-&gt;dev
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;outbound_ringbuffer_lock
(braket
id|queue
)braket
comma
id|QETH_LOCK_UNLOCKED
)paren
suffix:semicolon
)brace
multiline_comment|/* &n;&t; * if the lock was UNLOCKED, we flush ourselves, otherwise this is done&n;&t; * in do_send_packet when the lock is released&n;&t; */
macro_line|#ifdef QETH_PERFORMANCE_STATS
id|card-&gt;perf_stats.sc_p_dp
op_increment
suffix:semicolon
macro_line|#endif /* QETH_PERFORMANCE_STATS */
)brace
r_static
r_void
DECL|function|qeth_qdio_output_handler
id|qeth_qdio_output_handler
c_func
(paren
r_struct
id|ccw_device
op_star
id|cdev
comma
r_int
r_int
id|status
comma
r_int
r_int
id|qdio_error
comma
r_int
r_int
id|siga_error
comma
r_int
r_int
id|queue
comma
r_int
id|first_element
comma
r_int
id|count
comma
r_int
r_int
id|card_ptr
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
r_int
id|mycnt
comma
id|problem
comma
id|buffers_used
suffix:semicolon
r_int
id|sbalf15
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_int
id|last_pci_hit
op_assign
l_int|0
suffix:semicolon
r_int
id|last_pci
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;qouthn%s&quot;
comma
id|cdev-&gt;dev.bus_id
)paren
suffix:semicolon
id|QETH_DBF_HEX6
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
id|mycnt
op_assign
id|count
suffix:semicolon
id|card
op_assign
(paren
r_struct
id|qeth_card
op_star
)paren
id|card_ptr
suffix:semicolon
r_if
c_cond
(paren
id|status
op_amp
id|QDIO_STATUS_LOOK_FOR_ERROR
)paren
(brace
r_if
c_cond
(paren
id|status
op_amp
id|QDIO_STATUS_ACTIVATE_CHECK_CONDITION
)paren
(brace
id|problem
op_assign
id|PROBLEM_ACTIVATE_CHECK_CONDITION
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;problem
comma
id|problem
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;OHACTQCK&quot;
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x%4x&quot;
comma
id|first_element
comma
id|count
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x%4x&quot;
comma
id|queue
comma
id|status
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|QETH_DBF_CARD1
c_func
(paren
l_int|1
comma
id|trace
comma
l_string|&quot;qscd&quot;
comma
id|card
)paren
suffix:semicolon
id|qeth_schedule_recovery
c_func
(paren
id|card
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|sbalf15
op_assign
(paren
id|card-&gt;outbound_ringbuffer
(braket
id|queue
)braket
op_member_access_from_pointer
id|buffer
(braket
(paren
id|first_element
op_plus
id|count
op_minus
l_int|1
)paren
op_amp
id|QDIO_MAX_BUFFERS_PER_Q
)braket
dot
id|element
(braket
l_int|15
)braket
dot
id|flags
)paren
op_amp
l_int|0xff
suffix:semicolon
id|PRINT_STUPID
c_func
(paren
l_string|&quot;outbound qdio transfer error on device %s, &quot;
l_string|&quot;queue=%i. qdio_error=0x%x (more than one: %c),&quot;
l_string|&quot; siga_error=0x%x (more than one: %c), &quot;
l_string|&quot;sbalf15=x%x, bufno=x%x&bslash;n&quot;
comma
id|cdev-&gt;dev.bus_id
comma
id|queue
comma
id|qdio_error
comma
id|status
op_amp
id|QDIO_STATUS_MORE_THAN_ONE_QDIO_ERROR
ques
c_cond
l_char|&squot;y&squot;
suffix:colon
l_char|&squot;n&squot;
comma
id|siga_error
comma
id|status
op_amp
id|QDIO_STATUS_MORE_THAN_ONE_SIGA_ERROR
ques
c_cond
l_char|&squot;y&squot;
suffix:colon
l_char|&squot;n&squot;
comma
id|sbalf15
comma
id|first_element
)paren
suffix:semicolon
id|QETH_DBF_CARD1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;IQTO&quot;
comma
id|card
)paren
suffix:semicolon
id|QETH_DBF_CARD1
c_func
(paren
l_int|0
comma
id|qerr
comma
l_string|&quot;IQTO&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x%4x&quot;
comma
id|first_element
comma
id|count
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|qerr
comma
id|dbf_text
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%2x%4x%2x&quot;
comma
id|queue
comma
id|status
comma
id|sbalf15
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|qerr
comma
id|dbf_text
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x%4x&quot;
comma
id|qdio_error
comma
id|siga_error
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|qerr
comma
id|dbf_text
)paren
suffix:semicolon
multiline_comment|/* we maybe do recovery or dst_link_failures&n;&t;&t; * in qeth_free_buffer */
)brace
r_if
c_cond
(paren
id|mycnt
)paren
(brace
id|last_pci
op_assign
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;last_pci_pos
(braket
id|queue
)braket
)paren
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
suffix:semicolon
)paren
(brace
id|qeth_free_buffer
c_func
(paren
id|card
comma
id|queue
comma
id|first_element
comma
id|qdio_error
comma
id|siga_error
)paren
suffix:semicolon
r_if
c_cond
(paren
id|first_element
op_eq
id|last_pci
)paren
id|last_pci_hit
op_assign
l_int|1
suffix:semicolon
id|mycnt
op_decrement
suffix:semicolon
r_if
c_cond
(paren
id|mycnt
OG
l_int|0
)paren
id|first_element
op_assign
(paren
id|first_element
op_plus
l_int|1
)paren
op_amp
(paren
id|QDIO_MAX_BUFFERS_PER_Q
op_minus
l_int|1
)paren
suffix:semicolon
r_else
r_break
suffix:semicolon
)brace
)brace
id|buffers_used
op_assign
id|atomic_add_return
c_func
(paren
op_minus
id|count
comma
op_amp
id|card-&gt;outbound_used_buffers
(braket
id|queue
)braket
)paren
op_plus
id|count
suffix:semicolon
r_switch
c_cond
(paren
id|card-&gt;send_state
(braket
id|queue
)braket
)paren
(brace
r_case
id|SEND_STATE_PACK
suffix:colon
id|__qeth_try_to_flush_packets
c_func
(paren
id|card
comma
id|last_pci_hit
comma
id|queue
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_break
suffix:semicolon
)brace
multiline_comment|/* we don&squot;t have to start the queue, if it was started already */
r_if
c_cond
(paren
id|buffers_used
OL
id|QDIO_MAX_BUFFERS_PER_Q
op_minus
l_int|1
)paren
r_return
suffix:semicolon
id|out
suffix:colon
id|netif_wake_queue
c_func
(paren
id|card-&gt;dev
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|__qeth_check_irb_error
id|__qeth_check_irb_error
c_func
(paren
r_struct
id|ccw_device
op_star
id|cdev
comma
r_struct
id|irb
op_star
id|irb
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|IS_ERR
c_func
(paren
id|irb
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_switch
c_cond
(paren
id|PTR_ERR
c_func
(paren
id|irb
)paren
)paren
(brace
r_case
op_minus
id|EIO
suffix:colon
id|PRINT_WARN
c_func
(paren
l_string|&quot;i/o-error on device %s&bslash;n&quot;
comma
id|cdev-&gt;dev.bus_id
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
op_minus
id|ETIMEDOUT
suffix:colon
id|PRINT_WARN
c_func
(paren
l_string|&quot;timeout on device %s&bslash;n&quot;
comma
id|cdev-&gt;dev.bus_id
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|PRINT_WARN
c_func
(paren
l_string|&quot;unknown error %ld on device %s&bslash;n&quot;
comma
id|PTR_ERR
c_func
(paren
id|irb
)paren
comma
id|cdev-&gt;dev.bus_id
)paren
suffix:semicolon
)brace
r_return
id|PTR_ERR
c_func
(paren
id|irb
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_interrupt_handler_read
id|qeth_interrupt_handler_read
c_func
(paren
r_struct
id|ccw_device
op_star
id|cdev
comma
r_int
r_int
id|intparm
comma
r_struct
id|irb
op_star
id|irb
)paren
(brace
r_int
id|cstat
comma
id|dstat
suffix:semicolon
r_int
id|problem
suffix:semicolon
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
r_int
id|rqparam
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_int
id|result
suffix:semicolon
r_if
c_cond
(paren
id|__qeth_check_irb_error
c_func
(paren
id|cdev
comma
id|irb
)paren
)paren
r_return
suffix:semicolon
id|cstat
op_assign
id|irb-&gt;scsw.cstat
suffix:semicolon
id|dstat
op_assign
id|irb-&gt;scsw.dstat
suffix:semicolon
id|rqparam
op_assign
id|intparm
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;rint%s&quot;
comma
id|cdev-&gt;dev.bus_id
)paren
suffix:semicolon
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x%4x&quot;
comma
id|cstat
comma
id|dstat
)paren
suffix:semicolon
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x&quot;
comma
id|rqparam
)paren
suffix:semicolon
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|card
op_assign
id|cdev-&gt;dev.driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|irb-&gt;scsw.fctl
op_amp
(paren
id|SCSW_FCTL_CLEAR_FUNC
op_or
id|SCSW_FCTL_HALT_FUNC
)paren
)paren
(brace
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;clear_succeeded0
comma
l_int|1
)paren
suffix:semicolon
id|wake_up
c_func
(paren
op_amp
id|card-&gt;wait_q
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|rqparam
)paren
(brace
id|PRINT_STUPID
c_func
(paren
l_string|&quot;got unsolicited interrupt in read handler &quot;
l_string|&quot;for %s&bslash;n&quot;
comma
id|cdev-&gt;dev.bus_id
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|dstat
op_eq
l_int|0
)paren
op_logical_and
(paren
id|cstat
op_eq
l_int|0
)paren
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|irb-&gt;esw.esw0.erw.cons
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;sense data available on read channel.&bslash;n&quot;
)paren
suffix:semicolon
id|HEXDUMP16
c_func
(paren
id|WARN
comma
l_string|&quot;irb: &quot;
comma
id|irb
)paren
suffix:semicolon
id|HEXDUMP16
c_func
(paren
id|WARN
comma
l_string|&quot;sense data: &quot;
comma
id|irb-&gt;ecw
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;RSNS%s&quot;
comma
id|cdev-&gt;dev.bus_id
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|QETH_DBF_HEX0
c_func
(paren
l_int|0
comma
id|sense
comma
id|irb
comma
id|QETH_DBF_SENSE_LEN
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|cstat
op_ne
l_int|0
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;got nonzero-nonpci channel status in read_&quot;
l_string|&quot;handler (device %s, devstat 0x%02x, schstat &quot;
l_string|&quot;0x%02x, rqparam 0x%x)&bslash;n&quot;
comma
id|cdev-&gt;dev.bus_id
comma
id|dstat
comma
id|cstat
comma
id|rqparam
)paren
suffix:semicolon
)brace
id|problem
op_assign
id|qeth_get_cards_problem
c_func
(paren
id|cdev
comma
id|card-&gt;dma_stuff-&gt;recbuf
comma
id|dstat
comma
id|cstat
comma
id|rqparam
comma
(paren
r_char
op_star
)paren
id|irb
comma
(paren
r_char
op_star
)paren
id|irb-&gt;ecw
)paren
suffix:semicolon
multiline_comment|/* detect errors in dstat here */
r_if
c_cond
(paren
(paren
id|dstat
op_amp
id|DEV_STAT_UNIT_EXCEP
)paren
op_logical_or
(paren
id|dstat
op_amp
id|DEV_STAT_UNIT_CHECK
)paren
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;unit check/exception in read_handler &quot;
l_string|&quot;(device %s, devstat 0x%02x, schstat 0x%02x, &quot;
l_string|&quot;rqparam 0x%x)&bslash;n&quot;
comma
id|cdev-&gt;dev.bus_id
comma
id|dstat
comma
id|cstat
comma
id|rqparam
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_hardsetup
)paren
)paren
(brace
r_if
c_cond
(paren
(paren
id|problem
)paren
op_logical_and
(paren
id|qeth_is_to_recover
c_func
(paren
id|card
comma
id|problem
)paren
)paren
)paren
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;break_out
comma
id|QETH_BREAKOUT_AGAIN
)paren
suffix:semicolon
r_else
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;break_out
comma
id|QETH_BREAKOUT_LEAVE
)paren
suffix:semicolon
r_goto
id|wakeup_out
suffix:semicolon
)brace
r_else
r_goto
id|recover
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|dstat
op_amp
id|DEV_STAT_CHN_END
)paren
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;didn&squot;t get device end in read_handler &quot;
l_string|&quot;(device %s, devstat 0x%02x, schstat 0x%02x, &quot;
l_string|&quot;rqparam 0x%x)&bslash;n&quot;
comma
id|cdev-&gt;dev.bus_id
comma
id|dstat
comma
id|cstat
comma
id|rqparam
)paren
suffix:semicolon
r_goto
id|wakeup_out
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|rqparam
op_eq
id|IDX_ACTIVATE_WRITE_STATE
)paren
op_logical_or
(paren
id|rqparam
op_eq
id|NOP_STATE
)paren
)paren
(brace
r_goto
id|wakeup_out
suffix:semicolon
)brace
multiline_comment|/* at this point, (maybe channel end and) device end has appeared */
multiline_comment|/* we don&squot;t start the next read until we have examined the buffer. */
r_if
c_cond
(paren
(paren
id|rqparam
op_ne
id|IDX_ACTIVATE_READ_STATE
)paren
op_logical_and
(paren
id|rqparam
op_ne
id|IDX_ACTIVATE_WRITE_STATE
)paren
)paren
id|qeth_issue_next_read
c_func
(paren
id|card
)paren
suffix:semicolon
id|recover
suffix:colon
r_if
c_cond
(paren
id|qeth_is_to_recover
c_func
(paren
id|card
comma
id|problem
)paren
)paren
(brace
id|QETH_DBF_CARD2
c_func
(paren
l_int|1
comma
id|trace
comma
l_string|&quot;rscd&quot;
comma
id|card
)paren
suffix:semicolon
id|qeth_schedule_recovery
c_func
(paren
id|card
)paren
suffix:semicolon
r_goto
id|wakeup_out
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|IS_IPA
c_func
(paren
id|card-&gt;dma_stuff-&gt;recbuf
)paren
op_logical_or
id|IS_IPA_REPLY
c_func
(paren
id|card-&gt;dma_stuff-&gt;recbuf
)paren
)paren
(brace
multiline_comment|/* setup or unknown data */
id|result
op_assign
id|qeth_look_for_arp_data
c_func
(paren
id|card
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|result
)paren
(brace
r_case
id|ARP_RETURNCODE_ERROR
suffix:colon
r_case
id|ARP_RETURNCODE_LASTREPLY
suffix:colon
id|qeth_wakeup_ioctl
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
suffix:semicolon
r_default
suffix:colon
r_break
suffix:semicolon
)brace
)brace
id|wakeup_out
suffix:colon
id|memcpy
c_func
(paren
id|card-&gt;ipa_buf
comma
id|card-&gt;dma_stuff-&gt;recbuf
comma
id|QETH_BUFSIZE
)paren
suffix:semicolon
id|qeth_wakeup
c_func
(paren
id|card
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_interrupt_handler_write
id|qeth_interrupt_handler_write
c_func
(paren
r_struct
id|ccw_device
op_star
id|cdev
comma
r_int
r_int
id|intparm
comma
r_struct
id|irb
op_star
id|irb
)paren
(brace
r_int
id|cstat
comma
id|dstat
comma
id|rqparam
suffix:semicolon
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
r_int
id|problem
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_if
c_cond
(paren
id|__qeth_check_irb_error
c_func
(paren
id|cdev
comma
id|irb
)paren
)paren
r_return
suffix:semicolon
id|cstat
op_assign
id|irb-&gt;scsw.cstat
suffix:semicolon
id|dstat
op_assign
id|irb-&gt;scsw.dstat
suffix:semicolon
id|rqparam
op_assign
id|intparm
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;wint%s&quot;
comma
id|cdev-&gt;dev.bus_id
)paren
suffix:semicolon
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x%4x&quot;
comma
id|cstat
comma
id|dstat
)paren
suffix:semicolon
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x&quot;
comma
id|rqparam
)paren
suffix:semicolon
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|card
op_assign
id|cdev-&gt;dev.driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|irb-&gt;scsw.fctl
op_amp
(paren
id|SCSW_FCTL_CLEAR_FUNC
op_or
id|SCSW_FCTL_HALT_FUNC
)paren
)paren
(brace
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;clear_succeeded1
comma
l_int|1
)paren
suffix:semicolon
id|wake_up
c_func
(paren
op_amp
id|card-&gt;wait_q
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|rqparam
)paren
(brace
id|PRINT_STUPID
c_func
(paren
l_string|&quot;got unsolicited interrupt in write handler &quot;
l_string|&quot;for %s&bslash;n&quot;
comma
id|cdev-&gt;dev.bus_id
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|dstat
op_eq
l_int|0
)paren
op_logical_and
(paren
id|cstat
op_eq
l_int|0
)paren
)paren
r_goto
id|out
suffix:semicolon
r_if
c_cond
(paren
id|irb-&gt;esw.esw0.erw.cons
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;sense data available on write channel.&bslash;n&quot;
)paren
suffix:semicolon
id|HEXDUMP16
c_func
(paren
id|WARN
comma
l_string|&quot;irb: &quot;
comma
id|irb
)paren
suffix:semicolon
id|HEXDUMP16
c_func
(paren
id|WARN
comma
l_string|&quot;sense data: &quot;
comma
id|irb-&gt;ecw
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;WSNS%s&quot;
comma
id|cdev-&gt;dev.bus_id
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|QETH_DBF_HEX0
c_func
(paren
l_int|0
comma
id|sense
comma
id|irb
comma
id|QETH_DBF_SENSE_LEN
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|cstat
op_ne
l_int|0
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;got nonzero channel status in write_handler &quot;
l_string|&quot;(device %s, devstat 0x%02x, schstat 0x%02x, &quot;
l_string|&quot;rqparam 0x%x)&bslash;n&quot;
comma
id|cdev-&gt;dev.bus_id
comma
id|dstat
comma
id|cstat
comma
id|rqparam
)paren
suffix:semicolon
)brace
id|problem
op_assign
id|qeth_get_cards_problem
c_func
(paren
id|cdev
comma
l_int|NULL
comma
id|dstat
comma
id|cstat
comma
id|rqparam
comma
(paren
r_char
op_star
)paren
id|irb
comma
(paren
r_char
op_star
)paren
id|irb-&gt;ecw
)paren
suffix:semicolon
multiline_comment|/* detect errors in dstat here */
r_if
c_cond
(paren
(paren
id|dstat
op_amp
id|DEV_STAT_UNIT_EXCEP
)paren
op_logical_or
(paren
id|dstat
op_amp
id|DEV_STAT_UNIT_CHECK
)paren
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;unit check/exception in write_handler &quot;
l_string|&quot;(device %s, devstat 0x%02x, schstat 0x%02x, &quot;
l_string|&quot;rqparam 0x%x)&bslash;n&quot;
comma
id|cdev-&gt;dev.bus_id
comma
id|dstat
comma
id|cstat
comma
id|rqparam
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_hardsetup
)paren
)paren
(brace
r_if
c_cond
(paren
id|problem
op_eq
id|PROBLEM_RESETTING_EVENT_INDICATOR
)paren
(brace
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;break_out
comma
id|QETH_BREAKOUT_AGAIN
)paren
suffix:semicolon
id|qeth_wakeup
c_func
(paren
id|card
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;break_out
comma
id|QETH_BREAKOUT_LEAVE
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
r_else
r_goto
id|recover
suffix:semicolon
)brace
r_if
c_cond
(paren
id|dstat
op_eq
id|DEV_STAT_DEV_END
)paren
r_goto
id|out
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|dstat
op_amp
id|DEV_STAT_CHN_END
)paren
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;didn&squot;t get device end in write_handler &quot;
l_string|&quot;(device %s, devstat 0x%02x, schstat 0x%02x, &quot;
l_string|&quot;rqparam 0x%x)&bslash;n&quot;
comma
id|cdev-&gt;dev.bus_id
comma
id|dstat
comma
id|cstat
comma
id|rqparam
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|recover
suffix:colon
r_if
c_cond
(paren
id|qeth_is_to_recover
c_func
(paren
id|card
comma
id|problem
)paren
)paren
(brace
id|QETH_DBF_CARD2
c_func
(paren
l_int|1
comma
id|trace
comma
l_string|&quot;wscd&quot;
comma
id|card
)paren
suffix:semicolon
id|qeth_schedule_recovery
c_func
(paren
id|card
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
multiline_comment|/* at this point, (maybe channel end and) device end has appeared */
r_if
c_cond
(paren
(paren
id|rqparam
op_eq
id|IDX_ACTIVATE_READ_STATE
)paren
op_logical_or
(paren
id|rqparam
op_eq
id|IDX_ACTIVATE_WRITE_STATE
)paren
op_logical_or
(paren
id|rqparam
op_eq
id|NOP_STATE
)paren
)paren
(brace
id|qeth_wakeup
c_func
(paren
id|card
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
multiline_comment|/* well, a write has been done successfully. */
id|out
suffix:colon
multiline_comment|/* all statuses are final statuses on the write channel */
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;write_busy
comma
l_int|0
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_interrupt_handler_qdio
id|qeth_interrupt_handler_qdio
c_func
(paren
r_struct
id|ccw_device
op_star
id|cdev
comma
r_int
r_int
id|intparm
comma
r_struct
id|irb
op_star
id|irb
)paren
(brace
r_int
id|cstat
comma
id|dstat
comma
id|rqparam
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
r_if
c_cond
(paren
id|__qeth_check_irb_error
c_func
(paren
id|cdev
comma
id|irb
)paren
)paren
r_return
suffix:semicolon
id|cstat
op_assign
id|irb-&gt;scsw.cstat
suffix:semicolon
id|dstat
op_assign
id|irb-&gt;scsw.dstat
suffix:semicolon
id|rqparam
op_assign
id|intparm
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;qint%s&quot;
comma
id|cdev-&gt;dev.bus_id
)paren
suffix:semicolon
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x%4x&quot;
comma
id|cstat
comma
id|dstat
)paren
suffix:semicolon
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x&quot;
comma
id|rqparam
)paren
suffix:semicolon
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|card
op_assign
id|cdev-&gt;dev.driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|irb-&gt;scsw.fctl
op_amp
(paren
id|SCSW_FCTL_CLEAR_FUNC
op_or
id|SCSW_FCTL_HALT_FUNC
)paren
)paren
(brace
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;clear_succeeded2
comma
l_int|1
)paren
suffix:semicolon
id|wake_up
c_func
(paren
op_amp
id|card-&gt;wait_q
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|rqparam
)paren
(brace
id|PRINT_STUPID
c_func
(paren
l_string|&quot;got unsolicited interrupt in qdio handler, &quot;
l_string|&quot;device%s&bslash;n&quot;
comma
id|cdev-&gt;dev.bus_id
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|dstat
op_eq
l_int|0
)paren
op_logical_and
(paren
id|cstat
op_eq
l_int|0
)paren
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|irb-&gt;esw.esw0.erw.cons
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;sense data available on qdio channel.&bslash;n&quot;
)paren
suffix:semicolon
id|HEXDUMP16
c_func
(paren
id|WARN
comma
l_string|&quot;irb: &quot;
comma
id|irb
)paren
suffix:semicolon
id|HEXDUMP16
c_func
(paren
id|WARN
comma
l_string|&quot;sense data: &quot;
comma
id|irb-&gt;ecw
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;QSNS%s&quot;
comma
id|cdev-&gt;dev.bus_id
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|QETH_DBF_HEX0
c_func
(paren
l_int|0
comma
id|sense
comma
id|irb
comma
id|QETH_DBF_SENSE_LEN
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|rqparam
op_eq
id|NOP_STATE
)paren
(brace
id|qeth_wakeup
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|cstat
op_ne
l_int|0
)paren
(brace
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;qchk%s&quot;
comma
id|cdev-&gt;dev.bus_id
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x%4x&quot;
comma
id|cstat
comma
id|dstat
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x&quot;
comma
id|rqparam
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|PRINT_WARN
c_func
(paren
l_string|&quot;got nonzero channel status in qdio_handler &quot;
l_string|&quot;(device %s, devstat 0x%02x, schstat 0x%02x)&bslash;n&quot;
comma
id|cdev-&gt;dev.bus_id
comma
id|dstat
comma
id|cstat
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|dstat
op_amp
op_complement
(paren
id|DEV_STAT_CHN_END
op_or
id|DEV_STAT_DEV_END
)paren
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;got the following dstat on the qdio channel: &quot;
l_string|&quot;device %s, dstat 0x%02x, cstat 0x%02x, &quot;
l_string|&quot;rqparam=%i&bslash;n&quot;
comma
id|cdev-&gt;dev.bus_id
comma
id|dstat
comma
id|cstat
comma
id|rqparam
)paren
suffix:semicolon
)brace
)brace
r_static
r_int
DECL|function|qeth_register_netdev
id|qeth_register_netdev
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_int
id|result
suffix:semicolon
id|QETH_DBF_CARD3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;rgnd&quot;
comma
id|card
)paren
suffix:semicolon
id|result
op_assign
id|register_netdev
c_func
(paren
id|card-&gt;dev
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_unregister_netdev
id|qeth_unregister_netdev
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
id|QETH_DBF_CARD3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;nrgn&quot;
comma
id|card
)paren
suffix:semicolon
id|unregister_netdev
c_func
(paren
id|card-&gt;dev
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_stop
id|qeth_stop
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
id|card
op_assign
(paren
r_struct
id|qeth_card
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;stop&quot;
comma
id|card
)paren
suffix:semicolon
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|setup
comma
l_string|&quot;stop&quot;
comma
id|card
)paren
suffix:semicolon
id|qeth_save_dev_flag_state
c_func
(paren
id|card
)paren
suffix:semicolon
id|netif_stop_queue
c_func
(paren
id|dev
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;is_open
comma
l_int|0
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_softshutdown
id|qeth_softshutdown
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
id|QETH_DBF_CARD3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;ssht&quot;
comma
id|card
)paren
suffix:semicolon
id|qeth_send_stoplan
c_func
(paren
id|card
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|__qeth_clear_card_halt_clear
id|__qeth_clear_card_halt_clear
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_int
id|halt
)paren
(brace
r_int
r_int
id|flags0
comma
id|flags1
comma
id|flags2
suffix:semicolon
r_int
id|ret0
comma
id|ret1
comma
id|ret2
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;clear_succeeded0
comma
l_int|0
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;clear_succeeded1
comma
l_int|0
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;clear_succeeded2
comma
l_int|0
)paren
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
id|get_ccwdev_lock
c_func
(paren
id|CARD_RDEV
c_func
(paren
id|card
)paren
)paren
comma
id|flags0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|halt
)paren
id|ret0
op_assign
id|ccw_device_halt
c_func
(paren
id|CARD_RDEV
c_func
(paren
id|card
)paren
comma
id|CLEAR_STATE
)paren
suffix:semicolon
r_else
id|ret0
op_assign
id|ccw_device_clear
c_func
(paren
id|CARD_RDEV
c_func
(paren
id|card
)paren
comma
id|CLEAR_STATE
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
id|get_ccwdev_lock
c_func
(paren
id|CARD_RDEV
c_func
(paren
id|card
)paren
)paren
comma
id|flags0
)paren
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
id|get_ccwdev_lock
c_func
(paren
id|CARD_WDEV
c_func
(paren
id|card
)paren
)paren
comma
id|flags1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|halt
)paren
id|ret1
op_assign
id|ccw_device_halt
c_func
(paren
id|CARD_WDEV
c_func
(paren
id|card
)paren
comma
id|CLEAR_STATE
)paren
suffix:semicolon
r_else
id|ret1
op_assign
id|ccw_device_clear
c_func
(paren
id|CARD_WDEV
c_func
(paren
id|card
)paren
comma
id|CLEAR_STATE
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
id|get_ccwdev_lock
c_func
(paren
id|CARD_WDEV
c_func
(paren
id|card
)paren
)paren
comma
id|flags1
)paren
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
id|get_ccwdev_lock
c_func
(paren
id|CARD_DDEV
c_func
(paren
id|card
)paren
)paren
comma
id|flags2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|halt
)paren
id|ret2
op_assign
id|ccw_device_halt
c_func
(paren
id|CARD_DDEV
c_func
(paren
id|card
)paren
comma
id|CLEAR_STATE
)paren
suffix:semicolon
r_else
id|ret2
op_assign
id|ccw_device_clear
c_func
(paren
id|CARD_DDEV
c_func
(paren
id|card
)paren
comma
id|CLEAR_STATE
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
id|get_ccwdev_lock
c_func
(paren
id|CARD_DDEV
c_func
(paren
id|card
)paren
)paren
comma
id|flags2
)paren
suffix:semicolon
multiline_comment|/* The device owns us an interrupt. */
r_if
c_cond
(paren
(paren
id|ret0
op_eq
l_int|0
)paren
op_logical_and
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;clear_succeeded0
)paren
op_eq
l_int|0
)paren
)paren
id|wait_event
c_func
(paren
id|card-&gt;wait_q
comma
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;clear_succeeded0
)paren
op_eq
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|ret1
op_eq
l_int|0
)paren
op_logical_and
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;clear_succeeded1
)paren
op_eq
l_int|0
)paren
)paren
id|wait_event
c_func
(paren
id|card-&gt;wait_q
comma
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;clear_succeeded1
)paren
op_eq
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|ret2
op_eq
l_int|0
)paren
op_logical_and
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;clear_succeeded2
)paren
op_eq
l_int|0
)paren
)paren
id|wait_event
c_func
(paren
id|card-&gt;wait_q
comma
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;clear_succeeded2
)paren
op_eq
l_int|1
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_clear_card
id|qeth_clear_card
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_int
id|qdio_clean
comma
r_int
id|use_halt
)paren
(brace
id|QETH_DBF_CARD3
c_func
(paren
l_int|0
comma
id|trace
comma
id|qdio_clean
ques
c_cond
l_string|&quot;clrq&quot;
suffix:colon
l_string|&quot;clr&quot;
comma
id|card
)paren
suffix:semicolon
id|QETH_DBF_CARD1
c_func
(paren
l_int|0
comma
id|setup
comma
id|qdio_clean
ques
c_cond
l_string|&quot;clrq&quot;
suffix:colon
l_string|&quot;clr&quot;
comma
id|card
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;write_busy
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|qdio_clean
)paren
id|qdio_cleanup
c_func
(paren
id|CARD_DDEV
c_func
(paren
id|card
)paren
comma
(paren
id|card-&gt;type
op_eq
id|QETH_CARD_TYPE_IQD
)paren
ques
c_cond
id|QDIO_FLAG_CLEANUP_USING_HALT
suffix:colon
id|QDIO_FLAG_CLEANUP_USING_CLEAR
)paren
suffix:semicolon
r_if
c_cond
(paren
id|use_halt
)paren
id|__qeth_clear_card_halt_clear
c_func
(paren
id|card
comma
l_int|1
)paren
suffix:semicolon
id|__qeth_clear_card_halt_clear
c_func
(paren
id|card
comma
l_int|0
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_free_card_stuff
id|qeth_free_card_stuff
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_int
id|i
comma
id|j
suffix:semicolon
r_struct
id|qeth_vipa_entry
op_star
id|e
comma
op_star
id|e2
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
suffix:semicolon
id|QETH_DBF_CARD3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;freest&quot;
comma
id|card
)paren
suffix:semicolon
id|QETH_DBF_CARD1
c_func
(paren
l_int|0
comma
id|setup
comma
l_string|&quot;freest&quot;
comma
id|card
)paren
suffix:semicolon
id|write_lock
c_func
(paren
op_amp
id|card-&gt;vipa_list_lock
)paren
suffix:semicolon
id|e
op_assign
id|card-&gt;vipa_list
suffix:semicolon
r_while
c_loop
(paren
id|e
)paren
(brace
id|e2
op_assign
id|e-&gt;next
suffix:semicolon
id|kfree
c_func
(paren
id|e
)paren
suffix:semicolon
id|e
op_assign
id|e2
suffix:semicolon
)brace
id|write_unlock
c_func
(paren
op_amp
id|card-&gt;vipa_list_lock
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|card-&gt;options.inbound_buffer_count
suffix:semicolon
id|i
op_increment
)paren
(brace
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
id|BUFFER_MAX_ELEMENTS
suffix:semicolon
id|j
op_increment
)paren
(brace
r_if
c_cond
(paren
id|card-&gt;inbound_buffer_pool_entry
(braket
id|i
)braket
(braket
id|j
)braket
)paren
(brace
id|kfree
c_func
(paren
id|card-&gt;inbound_buffer_pool_entry
(braket
id|i
)braket
(braket
id|j
)braket
)paren
suffix:semicolon
id|card-&gt;inbound_buffer_pool_entry
(braket
id|i
)braket
(braket
id|j
)braket
op_assign
l_int|NULL
suffix:semicolon
)brace
)brace
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|card-&gt;no_queues
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|card-&gt;outbound_ringbuffer
(braket
id|i
)braket
)paren
id|vfree
c_func
(paren
id|card-&gt;outbound_ringbuffer
(braket
id|i
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
id|card-&gt;stats
)paren
id|kfree
c_func
(paren
id|card-&gt;stats
)paren
suffix:semicolon
r_if
c_cond
(paren
id|card-&gt;dma_stuff
)paren
id|kfree
c_func
(paren
id|card-&gt;dma_stuff
)paren
suffix:semicolon
r_if
c_cond
(paren
id|card-&gt;dev
)paren
id|free_netdev
c_func
(paren
id|card-&gt;dev
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_free_card
id|qeth_free_card
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
suffix:semicolon
id|QETH_DBF_CARD3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;free&quot;
comma
id|card
)paren
suffix:semicolon
id|QETH_DBF_CARD1
c_func
(paren
l_int|0
comma
id|setup
comma
l_string|&quot;free&quot;
comma
id|card
)paren
suffix:semicolon
id|vfree
c_func
(paren
id|card
)paren
suffix:semicolon
multiline_comment|/* we checked against NULL already */
)brace
multiline_comment|/* also locked from outside (setup_lock) */
r_static
r_void
DECL|function|qeth_remove_card_from_list
id|qeth_remove_card_from_list
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_struct
id|qeth_card
op_star
id|cn
suffix:semicolon
r_int
r_int
id|flags0
comma
id|flags1
comma
id|flags2
suffix:semicolon
id|write_lock
c_func
(paren
op_amp
id|list_lock
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
(brace
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;RMCWNOCD&quot;
)paren
suffix:semicolon
id|PRINT_WARN
c_func
(paren
l_string|&quot;qeth_remove_card_from_list call with no card!&bslash;n&quot;
)paren
suffix:semicolon
id|write_unlock
c_func
(paren
op_amp
id|list_lock
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|QETH_DBF_CARD3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;rmcl&quot;
comma
id|card
)paren
suffix:semicolon
multiline_comment|/* check first, if card is in list */
r_if
c_cond
(paren
op_logical_neg
id|firstcard
)paren
(brace
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;NOCRDINL&quot;
)paren
suffix:semicolon
id|PRINT_WARN
(paren
l_string|&quot;qeth_remove_card_from_list called on empty card list!!&bslash;n&quot;
)paren
suffix:semicolon
id|write_unlock
c_func
(paren
op_amp
id|list_lock
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|spin_lock_irqsave
c_func
(paren
id|get_ccwdev_lock
c_func
(paren
id|CARD_RDEV
c_func
(paren
id|card
)paren
)paren
comma
id|flags0
)paren
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
id|get_ccwdev_lock
c_func
(paren
id|CARD_WDEV
c_func
(paren
id|card
)paren
)paren
comma
id|flags1
)paren
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
id|get_ccwdev_lock
c_func
(paren
id|CARD_DDEV
c_func
(paren
id|card
)paren
)paren
comma
id|flags2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|firstcard
op_eq
id|card
)paren
id|firstcard
op_assign
id|card-&gt;next
suffix:semicolon
r_else
(brace
id|cn
op_assign
id|firstcard
suffix:semicolon
r_while
c_loop
(paren
id|cn-&gt;next
)paren
(brace
r_if
c_cond
(paren
id|cn-&gt;next
op_eq
id|card
)paren
(brace
id|cn-&gt;next
op_assign
id|card-&gt;next
suffix:semicolon
id|card-&gt;next
op_assign
l_int|NULL
suffix:semicolon
r_break
suffix:semicolon
)brace
id|cn
op_assign
id|cn-&gt;next
suffix:semicolon
)brace
)brace
id|spin_unlock_irqrestore
c_func
(paren
id|get_ccwdev_lock
c_func
(paren
id|CARD_DDEV
c_func
(paren
id|card
)paren
)paren
comma
id|flags2
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
id|get_ccwdev_lock
c_func
(paren
id|CARD_WDEV
c_func
(paren
id|card
)paren
)paren
comma
id|flags1
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
id|get_ccwdev_lock
c_func
(paren
id|CARD_RDEV
c_func
(paren
id|card
)paren
)paren
comma
id|flags0
)paren
suffix:semicolon
id|write_unlock
c_func
(paren
op_amp
id|list_lock
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_delete_all_ips
id|qeth_delete_all_ips
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_struct
id|qeth_vipa_entry
op_star
id|e
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_softsetup
)paren
)paren
(brace
id|qeth_clear_ifa4_list
c_func
(paren
op_amp
id|card-&gt;ip_new_state.ip_ifa
)paren
suffix:semicolon
id|qeth_clear_ifamc_list
c_func
(paren
op_amp
id|card-&gt;ip_mc_new_state.ipm_ifa
)paren
suffix:semicolon
macro_line|#ifdef QETH_IPV6
id|qeth_clear_ifa6_list
c_func
(paren
op_amp
id|card-&gt;ip_new_state.ip6_ifa
)paren
suffix:semicolon
id|qeth_clear_ifamc_list
c_func
(paren
op_amp
id|card-&gt;ip_mc_new_state.ipm6_ifa
)paren
suffix:semicolon
macro_line|#endif /* QETH_IPV6 */
id|write_lock
c_func
(paren
op_amp
id|card-&gt;vipa_list_lock
)paren
suffix:semicolon
id|e
op_assign
id|card-&gt;vipa_list
suffix:semicolon
r_while
c_loop
(paren
id|e
)paren
(brace
id|e-&gt;state
op_assign
id|VIPA_2_B_REMOVED
suffix:semicolon
id|e
op_assign
id|e-&gt;next
suffix:semicolon
)brace
id|write_unlock
c_func
(paren
op_amp
id|card-&gt;vipa_list_lock
)paren
suffix:semicolon
id|qeth_start_softsetup_thread
c_func
(paren
id|card
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|qeth_remove_card
id|qeth_remove_card
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_int
id|method
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
suffix:semicolon
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;rmcd&quot;
comma
id|card
)paren
suffix:semicolon
id|QETH_DBF_CARD1
c_func
(paren
l_int|0
comma
id|setup
comma
l_string|&quot;rmcd&quot;
comma
id|card
)paren
suffix:semicolon
r_if
c_cond
(paren
id|method
op_eq
id|QETH_REMOVE_CARD_PROPER
)paren
(brace
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;shutdown_phase
comma
id|QETH_REMOVE_CARD_PROPER
)paren
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_open
)paren
)paren
(brace
id|qeth_stop
c_func
(paren
id|card-&gt;dev
)paren
suffix:semicolon
id|qeth_wait_nonbusy
c_func
(paren
id|QETH_REMOVE_WAIT_TIME
)paren
suffix:semicolon
)brace
id|qeth_delete_all_ips
c_func
(paren
id|card
)paren
suffix:semicolon
)brace
r_else
(brace
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;shutdown_phase
comma
id|QETH_REMOVE_CARD_QUICK
)paren
suffix:semicolon
)brace
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;write_busy
comma
l_int|0
)paren
suffix:semicolon
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;freeskbs&quot;
)paren
suffix:semicolon
id|qeth_free_all_skbs
c_func
(paren
id|card
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;upthrsem&quot;
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|card-&gt;softsetup_thread_sem
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|card-&gt;reinit_thread_sem
)paren
suffix:semicolon
r_while
c_loop
(paren
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;softsetup_thread_is_running
)paren
)paren
op_logical_or
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;reinit_counter
)paren
)paren
)paren
(brace
id|qeth_wait_nonbusy
c_func
(paren
id|QETH_WAIT_FOR_THREAD_TIME
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|method
op_eq
id|QETH_REMOVE_CARD_PROPER
)paren
(brace
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;softshut&quot;
)paren
suffix:semicolon
id|qeth_softshutdown
c_func
(paren
id|card
)paren
suffix:semicolon
id|qeth_wait_nonbusy
c_func
(paren
id|QETH_REMOVE_WAIT_TIME
)paren
suffix:semicolon
)brace
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;is_startlaned
comma
l_int|0
)paren
suffix:semicolon
multiline_comment|/* paranoia, qeth_stop&n;&t;&t;&t;&t;&t;&t;   should prevent&n;&t;&t;&t;&t;&t;&t;   further calls of&n;&t;&t;&t;&t;&t;&t;   hard_start_xmit */
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_registered
)paren
)paren
(brace
multiline_comment|/* Remove sysfs symlinks. */
id|sysfs_remove_link
c_func
(paren
op_amp
id|card-&gt;gdev-&gt;dev.kobj
comma
id|card-&gt;dev_name
)paren
suffix:semicolon
id|sysfs_remove_link
c_func
(paren
op_amp
id|card-&gt;dev-&gt;class_dev.kobj
comma
id|CARD_BUS_ID
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;unregdev&quot;
)paren
suffix:semicolon
id|qeth_unregister_netdev
c_func
(paren
id|card
)paren
suffix:semicolon
id|qeth_wait_nonbusy
c_func
(paren
id|QETH_REMOVE_WAIT_TIME
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;is_registered
comma
l_int|0
)paren
suffix:semicolon
)brace
id|qeth_put_unique_id
c_func
(paren
id|card
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;clrcard&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_hardsetup
)paren
)paren
(brace
id|PRINT_STUPID
c_func
(paren
l_string|&quot;clearing card %s&bslash;n&quot;
comma
id|card-&gt;dev_name
)paren
suffix:semicolon
id|qeth_clear_card
c_func
(paren
id|card
comma
l_int|1
comma
l_int|0
)paren
suffix:semicolon
)brace
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;is_hardsetup
comma
l_int|0
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;is_softsetup
comma
l_int|0
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;cardrmvd&quot;
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_destructor
id|qeth_destructor
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
id|card
op_assign
(paren
r_struct
id|qeth_card
op_star
)paren
(paren
id|dev-&gt;priv
)paren
suffix:semicolon
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;dstr&quot;
comma
id|card
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_set_multicast_list
id|qeth_set_multicast_list
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;priv
suffix:semicolon
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;smcl&quot;
comma
id|card
)paren
suffix:semicolon
id|qeth_start_softsetup_thread
c_func
(paren
id|card
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_set_mac_address
id|qeth_set_mac_address
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_void
op_star
id|addr
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
id|card
op_assign
(paren
r_struct
id|qeth_card
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;stmc&quot;
comma
id|card
)paren
suffix:semicolon
r_return
op_minus
id|EOPNOTSUPP
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_neigh_setup
id|qeth_neigh_setup
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|neigh_parms
op_star
id|np
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
id|card
op_assign
(paren
r_struct
id|qeth_card
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;ngst&quot;
comma
id|card
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_generate_tokens
id|qeth_generate_tokens
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
id|card-&gt;token.issuer_rm_w
op_assign
l_int|0x00010103UL
suffix:semicolon
id|card-&gt;token.cm_filter_w
op_assign
l_int|0x00010108UL
suffix:semicolon
id|card-&gt;token.cm_connection_w
op_assign
l_int|0x0001010aUL
suffix:semicolon
id|card-&gt;token.ulp_filter_w
op_assign
l_int|0x0001010bUL
suffix:semicolon
id|card-&gt;token.ulp_connection_w
op_assign
l_int|0x0001010dUL
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_peer_func_level
id|qeth_peer_func_level
c_func
(paren
r_int
id|level
)paren
(brace
r_if
c_cond
(paren
(paren
id|level
op_amp
l_int|0xff
)paren
op_eq
l_int|8
)paren
r_return
(paren
id|level
op_amp
l_int|0xff
)paren
op_plus
l_int|0x400
suffix:semicolon
r_if
c_cond
(paren
(paren
(paren
id|level
op_rshift
l_int|8
)paren
op_amp
l_int|3
)paren
op_eq
l_int|1
)paren
r_return
(paren
id|level
op_amp
l_int|0xff
)paren
op_plus
l_int|0x200
suffix:semicolon
r_return
id|level
suffix:semicolon
multiline_comment|/* hmmm... don&squot;t know what to do with that level. */
)brace
multiline_comment|/* returns last four digits of bus_id */
multiline_comment|/* FIXME: device driver shouldn&squot;t be aware of bus_id format - but don&squot;t know&n;   what else to use... (CH) */
r_static
r_inline
id|__u16
DECL|function|__raw_devno_from_bus_id
id|__raw_devno_from_bus_id
c_func
(paren
r_char
op_star
id|id
)paren
(brace
id|id
op_add_assign
(paren
id|strlen
c_func
(paren
id|id
)paren
op_minus
l_int|4
)paren
suffix:semicolon
r_return
(paren
id|__u16
)paren
id|simple_strtoul
c_func
(paren
id|id
comma
op_amp
id|id
comma
l_int|16
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_idx_activate_read
id|qeth_idx_activate_read
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_int
id|result
comma
id|result2
suffix:semicolon
id|__u16
id|temp
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
id|result
op_assign
id|result2
op_assign
l_int|0
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|card-&gt;dma_stuff-&gt;write_ccw
comma
id|WRITE_CCW
comma
r_sizeof
(paren
r_struct
id|ccw1
)paren
)paren
suffix:semicolon
id|card-&gt;dma_stuff-&gt;write_ccw.count
op_assign
id|IDX_ACTIVATE_SIZE
suffix:semicolon
id|card-&gt;dma_stuff-&gt;write_ccw.cda
op_assign
id|QETH_GET_ADDR
c_func
(paren
id|card-&gt;dma_stuff-&gt;sendbuf
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|card-&gt;dma_stuff-&gt;sendbuf
comma
id|IDX_ACTIVATE_READ
comma
id|IDX_ACTIVATE_SIZE
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|QETH_TRANSPORT_HEADER_SEQ_NO
c_func
(paren
id|card-&gt;dma_stuff-&gt;sendbuf
)paren
comma
op_amp
id|card-&gt;seqno.trans_hdr
comma
id|QETH_SEQ_NO_LENGTH
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|QETH_IDX_ACT_ISSUER_RM_TOKEN
c_func
(paren
id|card-&gt;dma_stuff-&gt;sendbuf
)paren
comma
op_amp
id|card-&gt;token.issuer_rm_w
comma
id|QETH_MPC_TOKEN_LENGTH
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|QETH_IDX_ACT_FUNC_LEVEL
c_func
(paren
id|card-&gt;dma_stuff-&gt;sendbuf
)paren
comma
op_amp
id|card-&gt;func_level
comma
l_int|2
)paren
suffix:semicolon
id|temp
op_assign
id|__raw_devno_from_bus_id
c_func
(paren
id|CARD_DDEV_ID
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|QETH_IDX_ACT_QDIO_DEV_CUA
c_func
(paren
id|card-&gt;dma_stuff-&gt;sendbuf
)paren
comma
op_amp
id|temp
comma
l_int|2
)paren
suffix:semicolon
id|temp
op_assign
(paren
id|card-&gt;cula
op_lshift
l_int|8
)paren
op_plus
id|card-&gt;unit_addr2
suffix:semicolon
id|memcpy
c_func
(paren
id|QETH_IDX_ACT_QDIO_DEV_REALADDR
c_func
(paren
id|card-&gt;dma_stuff-&gt;sendbuf
)paren
comma
op_amp
id|temp
comma
l_int|2
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;iarw&quot;
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|CARD_RDEV_ID
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
id|QETH_DBF_HEX2
c_func
(paren
l_int|0
comma
id|control
comma
id|card-&gt;dma_stuff-&gt;sendbuf
comma
id|QETH_DBF_CONTROL_LEN
)paren
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
id|get_ccwdev_lock
c_func
(paren
id|CARD_RDEV
c_func
(paren
id|card
)paren
)paren
comma
id|flags
)paren
suffix:semicolon
id|result
op_assign
id|ccw_device_start
c_func
(paren
id|CARD_RDEV
c_func
(paren
id|card
)paren
comma
op_amp
id|card-&gt;dma_stuff-&gt;write_ccw
comma
id|IDX_ACTIVATE_WRITE_STATE
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|qeth_delay_millis
c_func
(paren
id|QETH_WAIT_BEFORE_2ND_DOIO
)paren
suffix:semicolon
id|result2
op_assign
id|ccw_device_start
c_func
(paren
id|CARD_RDEV
c_func
(paren
id|card
)paren
comma
op_amp
id|card-&gt;dma_stuff-&gt;write_ccw
comma
id|IDX_ACTIVATE_WRITE_STATE
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;IRW1%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;IRW2%4x&quot;
comma
id|result2
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|PRINT_WARN
c_func
(paren
l_string|&quot;qeth_idx_activate_read (write): do_IO returned &quot;
l_string|&quot;%i, next try returns %i&bslash;n&quot;
comma
id|result
comma
id|result2
)paren
suffix:semicolon
)brace
id|spin_unlock_irqrestore
c_func
(paren
id|get_ccwdev_lock
c_func
(paren
id|CARD_RDEV
c_func
(paren
id|card
)paren
)paren
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;break_out
)paren
)paren
(brace
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;IARWBRKO&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EIO
suffix:semicolon
)brace
r_if
c_cond
(paren
id|qeth_sleepon
c_func
(paren
id|card
comma
id|QETH_MPC_TIMEOUT
)paren
)paren
(brace
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;IRWT&quot;
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
id|CARD_RDEV_ID
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
id|PRINT_ERR
c_func
(paren
l_string|&quot;IDX_ACTIVATE(wr) on read channel device %s: &quot;
l_string|&quot;timeout&bslash;n&quot;
comma
id|CARD_RDEV_ID
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
r_return
op_minus
id|EIO
suffix:semicolon
)brace
multiline_comment|/* start reading on read channel, card-&gt;read_ccw is not yet used */
id|memcpy
c_func
(paren
op_amp
id|card-&gt;dma_stuff-&gt;read_ccw
comma
id|READ_CCW
comma
r_sizeof
(paren
r_struct
id|ccw1
)paren
)paren
suffix:semicolon
id|card-&gt;dma_stuff-&gt;read_ccw.count
op_assign
id|QETH_BUFSIZE
suffix:semicolon
id|card-&gt;dma_stuff-&gt;read_ccw.cda
op_assign
id|QETH_GET_ADDR
c_func
(paren
id|card-&gt;dma_stuff-&gt;recbuf
)paren
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
id|get_ccwdev_lock
c_func
(paren
id|CARD_RDEV
c_func
(paren
id|card
)paren
)paren
comma
id|flags
)paren
suffix:semicolon
id|result2
op_assign
l_int|0
suffix:semicolon
id|result
op_assign
id|ccw_device_start
c_func
(paren
id|CARD_RDEV
c_func
(paren
id|card
)paren
comma
op_amp
id|card-&gt;dma_stuff-&gt;read_ccw
comma
id|IDX_ACTIVATE_READ_STATE
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|qeth_delay_millis
c_func
(paren
id|QETH_WAIT_BEFORE_2ND_DOIO
)paren
suffix:semicolon
id|result2
op_assign
id|ccw_device_start
c_func
(paren
id|CARD_RDEV
c_func
(paren
id|card
)paren
comma
op_amp
id|card-&gt;dma_stuff-&gt;read_ccw
comma
id|IDX_ACTIVATE_READ_STATE
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;IRR1%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;IRR2%4x&quot;
comma
id|result2
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|PRINT_WARN
c_func
(paren
l_string|&quot;qeth_idx_activate_read (read): do_IO &quot;
l_string|&quot;returned %i, next try returns %i&bslash;n&quot;
comma
id|result
comma
id|result2
)paren
suffix:semicolon
)brace
id|spin_unlock_irqrestore
c_func
(paren
id|get_ccwdev_lock
c_func
(paren
id|CARD_RDEV
c_func
(paren
id|card
)paren
)paren
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result2
)paren
(brace
id|result
op_assign
id|result2
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
r_return
id|result
suffix:semicolon
)brace
r_if
c_cond
(paren
id|qeth_sleepon
c_func
(paren
id|card
comma
id|QETH_MPC_TIMEOUT
)paren
)paren
(brace
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;IRRT&quot;
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
id|CARD_RDEV_ID
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
id|PRINT_ERR
c_func
(paren
l_string|&quot;IDX_ACTIVATE(rd) on read channel device %s: &quot;
l_string|&quot;timeout&bslash;n&quot;
comma
id|CARD_RDEV_ID
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
r_return
op_minus
id|EIO
suffix:semicolon
)brace
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;iarr&quot;
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|CARD_RDEV_ID
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
id|QETH_DBF_HEX2
c_func
(paren
l_int|0
comma
id|control
comma
id|card-&gt;dma_stuff-&gt;recbuf
comma
id|QETH_DBF_CONTROL_LEN
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|QETH_IS_IDX_ACT_POS_REPLY
c_func
(paren
id|card-&gt;dma_stuff-&gt;recbuf
)paren
)paren
)paren
(brace
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;IRNR&quot;
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
id|CARD_RDEV_ID
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
id|PRINT_ERR
c_func
(paren
l_string|&quot;IDX_ACTIVATE on read channel device %s: negative &quot;
l_string|&quot;reply&bslash;n&quot;
comma
id|CARD_RDEV_ID
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
r_return
op_minus
id|EIO
suffix:semicolon
)brace
id|card-&gt;portname_required
op_assign
(paren
(paren
op_logical_neg
id|QETH_IDX_NO_PORTNAME_REQUIRED
c_func
(paren
id|card-&gt;dma_stuff-&gt;recbuf
)paren
)paren
op_logical_and
(paren
id|card-&gt;type
op_eq
id|QETH_CARD_TYPE_OSAE
)paren
)paren
suffix:semicolon
suffix:semicolon
multiline_comment|/*&n;&t; * however, as the portname indication of OSA is wrong, we have to&n;&t; * do this:&n;&t; */
id|card-&gt;portname_required
op_assign
(paren
id|card-&gt;type
op_eq
id|QETH_CARD_TYPE_OSAE
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|temp
comma
id|QETH_IDX_ACT_FUNC_LEVEL
c_func
(paren
id|card-&gt;dma_stuff-&gt;recbuf
)paren
comma
l_int|2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|temp
op_ne
id|qeth_peer_func_level
c_func
(paren
id|card-&gt;func_level
)paren
)paren
(brace
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;IRFL&quot;
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
id|CARD_RDEV_ID
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x%4x&quot;
comma
id|card-&gt;func_level
comma
id|temp
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|PRINT_WARN
c_func
(paren
l_string|&quot;IDX_ACTIVATE on read channel device %s: function &quot;
l_string|&quot;level mismatch (sent: 0x%x, received: 0x%x)&bslash;n&quot;
comma
id|CARD_RDEV_ID
c_func
(paren
id|card
)paren
comma
id|card-&gt;func_level
comma
id|temp
)paren
suffix:semicolon
id|result
op_assign
op_minus
id|EIO
suffix:semicolon
)brace
id|memcpy
c_func
(paren
op_amp
id|card-&gt;token.issuer_rm_r
comma
id|QETH_IDX_ACT_ISSUER_RM_TOKEN
c_func
(paren
id|card-&gt;dma_stuff-&gt;recbuf
)paren
comma
id|QETH_MPC_TOKEN_LENGTH
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|card-&gt;level
(braket
l_int|0
)braket
comma
id|QETH_IDX_REPLY_LEVEL
c_func
(paren
id|card-&gt;dma_stuff-&gt;recbuf
)paren
comma
id|QETH_MCL_LENGTH
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_idx_activate_write
id|qeth_idx_activate_write
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_int
id|result
comma
id|result2
suffix:semicolon
id|__u16
id|temp
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
id|result
op_assign
id|result2
op_assign
l_int|0
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|card-&gt;dma_stuff-&gt;write_ccw
comma
id|WRITE_CCW
comma
r_sizeof
(paren
r_struct
id|ccw1
)paren
)paren
suffix:semicolon
id|card-&gt;dma_stuff-&gt;write_ccw.count
op_assign
id|IDX_ACTIVATE_SIZE
suffix:semicolon
id|card-&gt;dma_stuff-&gt;write_ccw.cda
op_assign
id|QETH_GET_ADDR
c_func
(paren
id|card-&gt;dma_stuff-&gt;sendbuf
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|card-&gt;dma_stuff-&gt;sendbuf
comma
id|IDX_ACTIVATE_WRITE
comma
id|IDX_ACTIVATE_SIZE
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|QETH_TRANSPORT_HEADER_SEQ_NO
c_func
(paren
id|card-&gt;dma_stuff-&gt;sendbuf
)paren
comma
op_amp
id|card-&gt;seqno.trans_hdr
comma
id|QETH_SEQ_NO_LENGTH
)paren
suffix:semicolon
id|card-&gt;seqno.trans_hdr
op_increment
suffix:semicolon
id|memcpy
c_func
(paren
id|QETH_IDX_ACT_ISSUER_RM_TOKEN
c_func
(paren
id|card-&gt;dma_stuff-&gt;sendbuf
)paren
comma
op_amp
id|card-&gt;token.issuer_rm_w
comma
id|QETH_MPC_TOKEN_LENGTH
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|QETH_IDX_ACT_FUNC_LEVEL
c_func
(paren
id|card-&gt;dma_stuff-&gt;sendbuf
)paren
comma
op_amp
id|card-&gt;func_level
comma
l_int|2
)paren
suffix:semicolon
id|temp
op_assign
id|__raw_devno_from_bus_id
c_func
(paren
id|CARD_DDEV_ID
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|QETH_IDX_ACT_QDIO_DEV_CUA
c_func
(paren
id|card-&gt;dma_stuff-&gt;sendbuf
)paren
comma
op_amp
id|temp
comma
l_int|2
)paren
suffix:semicolon
id|temp
op_assign
(paren
id|card-&gt;cula
op_lshift
l_int|8
)paren
op_plus
id|card-&gt;unit_addr2
suffix:semicolon
id|memcpy
c_func
(paren
id|QETH_IDX_ACT_QDIO_DEV_REALADDR
c_func
(paren
id|card-&gt;dma_stuff-&gt;sendbuf
)paren
comma
op_amp
id|temp
comma
l_int|2
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;iaww&quot;
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|CARD_WDEV_ID
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
id|QETH_DBF_HEX2
c_func
(paren
l_int|0
comma
id|control
comma
id|card-&gt;dma_stuff-&gt;sendbuf
comma
id|QETH_DBF_CONTROL_LEN
)paren
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
id|get_ccwdev_lock
c_func
(paren
id|CARD_WDEV
c_func
(paren
id|card
)paren
)paren
comma
id|flags
)paren
suffix:semicolon
id|result
op_assign
id|ccw_device_start
c_func
(paren
id|CARD_WDEV
c_func
(paren
id|card
)paren
comma
op_amp
id|card-&gt;dma_stuff-&gt;write_ccw
comma
id|IDX_ACTIVATE_WRITE_STATE
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|qeth_delay_millis
c_func
(paren
id|QETH_WAIT_BEFORE_2ND_DOIO
)paren
suffix:semicolon
id|result2
op_assign
id|ccw_device_start
c_func
(paren
id|CARD_WDEV
c_func
(paren
id|card
)paren
comma
op_amp
id|card-&gt;dma_stuff-&gt;write_ccw
comma
id|IDX_ACTIVATE_WRITE_STATE
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;IWW1%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;IWW2%4x&quot;
comma
id|result2
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|PRINT_WARN
c_func
(paren
l_string|&quot;qeth_idx_activate_write (write): do_IO &quot;
l_string|&quot;returned %i, next try returns %i&bslash;n&quot;
comma
id|result
comma
id|result2
)paren
suffix:semicolon
)brace
id|spin_unlock_irqrestore
c_func
(paren
id|get_ccwdev_lock
c_func
(paren
id|CARD_WDEV
c_func
(paren
id|card
)paren
)paren
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;break_out
)paren
)paren
(brace
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;IAWWBRKO&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EIO
suffix:semicolon
)brace
r_if
c_cond
(paren
id|qeth_sleepon
c_func
(paren
id|card
comma
id|QETH_MPC_TIMEOUT
)paren
)paren
(brace
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;IWWT&quot;
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
id|CARD_WDEV_ID
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
id|PRINT_ERR
c_func
(paren
l_string|&quot;IDX_ACTIVATE(wr) on write channel device %s: &quot;
l_string|&quot;timeout&bslash;n&quot;
comma
id|CARD_WDEV_ID
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
r_return
op_minus
id|EIO
suffix:semicolon
)brace
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;idxawrrd&quot;
)paren
suffix:semicolon
multiline_comment|/* start one read on write channel */
id|memcpy
c_func
(paren
op_amp
id|card-&gt;dma_stuff-&gt;read_ccw
comma
id|READ_CCW
comma
r_sizeof
(paren
r_struct
id|ccw1
)paren
)paren
suffix:semicolon
id|card-&gt;dma_stuff-&gt;read_ccw.count
op_assign
id|QETH_BUFSIZE
suffix:semicolon
multiline_comment|/* recbuf and card-&gt;read_ccw is not yet used by any other&n;&t;   read channel program */
id|card-&gt;dma_stuff-&gt;read_ccw.cda
op_assign
id|QETH_GET_ADDR
c_func
(paren
id|card-&gt;dma_stuff-&gt;recbuf
)paren
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
id|get_ccwdev_lock
c_func
(paren
id|CARD_WDEV
c_func
(paren
id|card
)paren
)paren
comma
id|flags
)paren
suffix:semicolon
id|result2
op_assign
l_int|0
suffix:semicolon
id|result
op_assign
id|ccw_device_start
c_func
(paren
id|CARD_WDEV
c_func
(paren
id|card
)paren
comma
op_amp
id|card-&gt;dma_stuff-&gt;read_ccw
comma
id|IDX_ACTIVATE_READ_STATE
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|qeth_delay_millis
c_func
(paren
id|QETH_WAIT_BEFORE_2ND_DOIO
)paren
suffix:semicolon
id|result2
op_assign
id|ccw_device_start
c_func
(paren
id|CARD_WDEV
c_func
(paren
id|card
)paren
comma
op_amp
id|card-&gt;dma_stuff-&gt;read_ccw
comma
id|IDX_ACTIVATE_READ_STATE
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;IWR1%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;IWR2%4x&quot;
comma
id|result2
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|PRINT_WARN
c_func
(paren
l_string|&quot;qeth_idx_activate_write (read): do_IO returned &quot;
l_string|&quot;%i, next try returns %i&bslash;n&quot;
comma
id|result
comma
id|result2
)paren
suffix:semicolon
)brace
id|spin_unlock_irqrestore
c_func
(paren
id|get_ccwdev_lock
c_func
(paren
id|CARD_WDEV
c_func
(paren
id|card
)paren
)paren
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result2
)paren
(brace
id|result
op_assign
id|result2
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
r_return
id|result
suffix:semicolon
)brace
r_if
c_cond
(paren
id|qeth_sleepon
c_func
(paren
id|card
comma
id|QETH_MPC_TIMEOUT
)paren
)paren
(brace
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;IWRT&quot;
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
id|CARD_WDEV_ID
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
id|PRINT_ERR
c_func
(paren
l_string|&quot;IDX_ACTIVATE(rd) on write channel device %s: &quot;
l_string|&quot;timeout&bslash;n&quot;
comma
id|CARD_WDEV_ID
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
r_return
op_minus
id|EIO
suffix:semicolon
)brace
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;iawr&quot;
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|CARD_WDEV_ID
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
id|QETH_DBF_HEX2
c_func
(paren
l_int|0
comma
id|control
comma
id|card-&gt;dma_stuff-&gt;recbuf
comma
id|QETH_DBF_CONTROL_LEN
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|QETH_IS_IDX_ACT_POS_REPLY
c_func
(paren
id|card-&gt;dma_stuff-&gt;recbuf
)paren
)paren
)paren
(brace
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;IWNR&quot;
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
id|CARD_WDEV_ID
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
id|PRINT_ERR
c_func
(paren
l_string|&quot;IDX_ACTIVATE on write channel device %s: negative &quot;
l_string|&quot;reply&bslash;n&quot;
comma
id|CARD_WDEV_ID
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
r_return
op_minus
id|EIO
suffix:semicolon
)brace
id|memcpy
c_func
(paren
op_amp
id|temp
comma
id|QETH_IDX_ACT_FUNC_LEVEL
c_func
(paren
id|card-&gt;dma_stuff-&gt;recbuf
)paren
comma
l_int|2
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|temp
op_amp
op_complement
l_int|0x0100
)paren
op_ne
id|qeth_peer_func_level
c_func
(paren
id|card-&gt;func_level
)paren
)paren
(brace
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;IWFM&quot;
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
id|CARD_WDEV_ID
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x%4x&quot;
comma
id|card-&gt;func_level
comma
id|temp
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|PRINT_WARN
c_func
(paren
l_string|&quot;IDX_ACTIVATE on write channel device %s: function &quot;
l_string|&quot;level mismatch (sent: 0x%x, received: 0x%x)&bslash;n&quot;
comma
id|CARD_WDEV_ID
c_func
(paren
id|card
)paren
comma
id|card-&gt;func_level
comma
id|temp
)paren
suffix:semicolon
id|result
op_assign
op_minus
id|EIO
suffix:semicolon
)brace
r_return
id|result
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_cm_enable
id|qeth_cm_enable
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_int
r_char
op_star
id|buffer
suffix:semicolon
r_int
id|result
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
id|memcpy
c_func
(paren
id|card-&gt;send_buf
comma
id|CM_ENABLE
comma
id|CM_ENABLE_SIZE
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|QETH_CM_ENABLE_ISSUER_RM_TOKEN
c_func
(paren
id|card-&gt;send_buf
)paren
comma
op_amp
id|card-&gt;token.issuer_rm_r
comma
id|QETH_MPC_TOKEN_LENGTH
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|QETH_CM_ENABLE_FILTER_TOKEN
c_func
(paren
id|card-&gt;send_buf
)paren
comma
op_amp
id|card-&gt;token.cm_filter_w
comma
id|QETH_MPC_TOKEN_LENGTH
)paren
suffix:semicolon
id|buffer
op_assign
id|qeth_send_control_data
c_func
(paren
id|card
comma
id|card-&gt;send_buf
comma
id|CM_ENABLE_SIZE
comma
id|MPC_SETUP_STATE
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|buffer
)paren
(brace
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;CME:NOBF&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EIO
suffix:semicolon
)brace
id|memcpy
c_func
(paren
op_amp
id|card-&gt;token.cm_filter_r
comma
id|QETH_CM_ENABLE_RESP_FILTER_TOKEN
c_func
(paren
id|buffer
)paren
comma
id|QETH_MPC_TOKEN_LENGTH
)paren
suffix:semicolon
id|result
op_assign
id|qeth_check_idx_response
c_func
(paren
id|buffer
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;cme=%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_cm_setup
id|qeth_cm_setup
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_int
r_char
op_star
id|buffer
suffix:semicolon
r_int
id|result
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
id|memcpy
c_func
(paren
id|card-&gt;send_buf
comma
id|CM_SETUP
comma
id|CM_SETUP_SIZE
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|QETH_CM_SETUP_DEST_ADDR
c_func
(paren
id|card-&gt;send_buf
)paren
comma
op_amp
id|card-&gt;token.issuer_rm_r
comma
id|QETH_MPC_TOKEN_LENGTH
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|QETH_CM_SETUP_CONNECTION_TOKEN
c_func
(paren
id|card-&gt;send_buf
)paren
comma
op_amp
id|card-&gt;token.cm_connection_w
comma
id|QETH_MPC_TOKEN_LENGTH
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|QETH_CM_SETUP_FILTER_TOKEN
c_func
(paren
id|card-&gt;send_buf
)paren
comma
op_amp
id|card-&gt;token.cm_filter_r
comma
id|QETH_MPC_TOKEN_LENGTH
)paren
suffix:semicolon
id|buffer
op_assign
id|qeth_send_control_data
c_func
(paren
id|card
comma
id|card-&gt;send_buf
comma
id|CM_SETUP_SIZE
comma
id|MPC_SETUP_STATE
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|buffer
)paren
(brace
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;CMS:NOBF&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EIO
suffix:semicolon
)brace
id|memcpy
c_func
(paren
op_amp
id|card-&gt;token.cm_connection_r
comma
id|QETH_CM_SETUP_RESP_DEST_ADDR
c_func
(paren
id|buffer
)paren
comma
id|QETH_MPC_TOKEN_LENGTH
)paren
suffix:semicolon
id|result
op_assign
id|qeth_check_idx_response
c_func
(paren
id|buffer
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;cms=%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_ulp_enable
id|qeth_ulp_enable
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_int
r_char
op_star
id|buffer
suffix:semicolon
id|__u16
id|mtu
comma
id|framesize
suffix:semicolon
id|__u16
id|len
suffix:semicolon
id|__u8
id|link_type
suffix:semicolon
r_int
id|result
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
id|memcpy
c_func
(paren
id|card-&gt;send_buf
comma
id|ULP_ENABLE
comma
id|ULP_ENABLE_SIZE
)paren
suffix:semicolon
op_star
(paren
id|QETH_ULP_ENABLE_LINKNUM
c_func
(paren
id|card-&gt;send_buf
)paren
)paren
op_assign
(paren
id|__u8
)paren
id|card-&gt;options.portno
suffix:semicolon
id|memcpy
c_func
(paren
id|QETH_ULP_ENABLE_DEST_ADDR
c_func
(paren
id|card-&gt;send_buf
)paren
comma
op_amp
id|card-&gt;token.cm_connection_r
comma
id|QETH_MPC_TOKEN_LENGTH
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|QETH_ULP_ENABLE_FILTER_TOKEN
c_func
(paren
id|card-&gt;send_buf
)paren
comma
op_amp
id|card-&gt;token.ulp_filter_w
comma
id|QETH_MPC_TOKEN_LENGTH
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|QETH_ULP_ENABLE_PORTNAME_AND_LL
c_func
(paren
id|card-&gt;send_buf
)paren
comma
id|card-&gt;options.portname
comma
l_int|9
)paren
suffix:semicolon
id|buffer
op_assign
id|qeth_send_control_data
c_func
(paren
id|card
comma
id|card-&gt;send_buf
comma
id|ULP_ENABLE_SIZE
comma
id|MPC_SETUP_STATE
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|buffer
)paren
(brace
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;ULE:NOBF&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EIO
suffix:semicolon
)brace
id|memcpy
c_func
(paren
op_amp
id|card-&gt;token.ulp_filter_r
comma
id|QETH_ULP_ENABLE_RESP_FILTER_TOKEN
c_func
(paren
id|buffer
)paren
comma
id|QETH_MPC_TOKEN_LENGTH
)paren
suffix:semicolon
multiline_comment|/* to be done before qeth_init_ringbuffers and qeth_init_dev */
r_if
c_cond
(paren
id|qeth_get_mtu_out_of_mpc
c_func
(paren
id|card-&gt;type
)paren
)paren
(brace
id|memcpy
c_func
(paren
op_amp
id|framesize
comma
id|QETH_ULP_ENABLE_RESP_MAX_MTU
c_func
(paren
id|buffer
)paren
comma
l_int|2
)paren
suffix:semicolon
id|mtu
op_assign
id|qeth_get_mtu_outof_framesize
c_func
(paren
id|framesize
)paren
suffix:semicolon
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;ule&quot;
comma
id|card
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;mtu=%4x&quot;
comma
id|mtu
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|mtu
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|card-&gt;max_mtu
op_assign
id|mtu
suffix:semicolon
id|card-&gt;initial_mtu
op_assign
id|mtu
suffix:semicolon
id|card-&gt;inbound_buffer_size
op_assign
id|mtu
op_plus
l_int|2
op_star
id|PAGE_SIZE
suffix:semicolon
)brace
r_else
(brace
id|card-&gt;initial_mtu
op_assign
id|qeth_get_initial_mtu_for_card
c_func
(paren
id|card
)paren
suffix:semicolon
id|card-&gt;max_mtu
op_assign
id|qeth_get_max_mtu_for_card
c_func
(paren
id|card-&gt;type
)paren
suffix:semicolon
id|card-&gt;inbound_buffer_size
op_assign
id|DEFAULT_BUFFER_SIZE
suffix:semicolon
)brace
id|memcpy
c_func
(paren
op_amp
id|len
comma
id|QETH_ULP_ENABLE_RESP_DIFINFO_LEN
c_func
(paren
id|buffer
)paren
comma
l_int|2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|len
op_ge
id|QETH_MPC_DIFINFO_LEN_INDICATES_LINK_TYPE
)paren
(brace
id|memcpy
c_func
(paren
op_amp
id|link_type
comma
id|QETH_ULP_ENABLE_RESP_LINK_TYPE
c_func
(paren
id|buffer
)paren
comma
l_int|1
)paren
suffix:semicolon
id|card-&gt;link_type
op_assign
id|link_type
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;link=%2x&quot;
comma
id|link_type
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
)brace
r_else
id|card-&gt;link_type
op_assign
l_int|0
suffix:semicolon
id|result
op_assign
id|qeth_check_idx_response
c_func
(paren
id|buffer
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;ule=%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_ulp_setup
id|qeth_ulp_setup
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_int
r_char
op_star
id|buffer
suffix:semicolon
id|__u16
id|temp
suffix:semicolon
r_int
id|result
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
id|memcpy
c_func
(paren
id|card-&gt;send_buf
comma
id|ULP_SETUP
comma
id|ULP_SETUP_SIZE
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|QETH_ULP_SETUP_DEST_ADDR
c_func
(paren
id|card-&gt;send_buf
)paren
comma
op_amp
id|card-&gt;token.cm_connection_r
comma
id|QETH_MPC_TOKEN_LENGTH
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|QETH_ULP_SETUP_CONNECTION_TOKEN
c_func
(paren
id|card-&gt;send_buf
)paren
comma
op_amp
id|card-&gt;token.ulp_connection_w
comma
id|QETH_MPC_TOKEN_LENGTH
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|QETH_ULP_SETUP_FILTER_TOKEN
c_func
(paren
id|card-&gt;send_buf
)paren
comma
op_amp
id|card-&gt;token.ulp_filter_r
comma
id|QETH_MPC_TOKEN_LENGTH
)paren
suffix:semicolon
id|temp
op_assign
id|__raw_devno_from_bus_id
c_func
(paren
id|CARD_DDEV_ID
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|QETH_ULP_SETUP_CUA
c_func
(paren
id|card-&gt;send_buf
)paren
comma
op_amp
id|temp
comma
l_int|2
)paren
suffix:semicolon
id|temp
op_assign
(paren
id|card-&gt;cula
op_lshift
l_int|8
)paren
op_plus
id|card-&gt;unit_addr2
suffix:semicolon
id|memcpy
c_func
(paren
id|QETH_ULP_SETUP_REAL_DEVADDR
c_func
(paren
id|card-&gt;send_buf
)paren
comma
op_amp
id|temp
comma
l_int|2
)paren
suffix:semicolon
id|buffer
op_assign
id|qeth_send_control_data
c_func
(paren
id|card
comma
id|card-&gt;send_buf
comma
id|ULP_SETUP_SIZE
comma
id|MPC_SETUP_STATE
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|buffer
)paren
(brace
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;ULS:NOBF&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EIO
suffix:semicolon
)brace
id|memcpy
c_func
(paren
op_amp
id|card-&gt;token.ulp_connection_r
comma
id|QETH_ULP_SETUP_RESP_CONNECTION_TOKEN
c_func
(paren
id|buffer
)paren
comma
id|QETH_MPC_TOKEN_LENGTH
)paren
suffix:semicolon
id|result
op_assign
id|qeth_check_idx_response
c_func
(paren
id|buffer
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;uls=%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_qdio_establish
id|qeth_qdio_establish
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_int
id|result
suffix:semicolon
r_char
op_star
id|adapter_area
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_void
op_star
op_star
id|input_array
comma
op_star
op_star
id|output_array
comma
op_star
op_star
id|ptr
suffix:semicolon
r_int
id|i
comma
id|j
suffix:semicolon
r_struct
id|qdio_initialize
id|init_data
suffix:semicolon
id|adapter_area
op_assign
id|vmalloc
c_func
(paren
id|QDIO_MAX_BUFFERS_PER_Q
op_star
r_sizeof
(paren
r_char
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|adapter_area
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|memset
c_func
(paren
id|adapter_area
comma
l_int|0
comma
id|QDIO_MAX_BUFFERS_PER_Q
op_star
r_sizeof
(paren
r_char
)paren
)paren
suffix:semicolon
id|adapter_area
(braket
l_int|0
)braket
op_assign
id|_ascebc
(braket
l_char|&squot;P&squot;
)braket
suffix:semicolon
id|adapter_area
(braket
l_int|1
)braket
op_assign
id|_ascebc
(braket
l_char|&squot;C&squot;
)braket
suffix:semicolon
id|adapter_area
(braket
l_int|2
)braket
op_assign
id|_ascebc
(braket
l_char|&squot;I&squot;
)braket
suffix:semicolon
id|adapter_area
(braket
l_int|3
)braket
op_assign
id|_ascebc
(braket
l_char|&squot;T&squot;
)braket
suffix:semicolon
op_star
(paren
(paren
r_int
r_int
op_star
)paren
(paren
op_amp
id|adapter_area
(braket
l_int|4
)braket
)paren
)paren
op_assign
id|PCI_THRESHOLD_A
suffix:semicolon
op_star
(paren
(paren
r_int
r_int
op_star
)paren
(paren
op_amp
id|adapter_area
(braket
l_int|8
)braket
)paren
)paren
op_assign
id|PCI_THRESHOLD_B
suffix:semicolon
op_star
(paren
(paren
r_int
r_int
op_star
)paren
(paren
op_amp
id|adapter_area
(braket
l_int|12
)braket
)paren
)paren
op_assign
id|PCI_TIMER_VALUE
suffix:semicolon
id|input_array
op_assign
id|vmalloc
c_func
(paren
id|QDIO_MAX_BUFFERS_PER_Q
op_star
r_sizeof
(paren
r_void
op_star
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|input_array
)paren
(brace
id|vfree
c_func
(paren
id|adapter_area
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|ptr
op_assign
id|input_array
suffix:semicolon
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
id|QDIO_MAX_BUFFERS_PER_Q
suffix:semicolon
id|j
op_increment
)paren
(brace
op_star
id|ptr
op_assign
(paren
r_void
op_star
)paren
id|virt_to_phys
c_func
(paren
op_amp
id|card-&gt;inbound_qdio_buffers
(braket
id|j
)braket
)paren
suffix:semicolon
id|ptr
op_increment
suffix:semicolon
)brace
id|output_array
op_assign
id|vmalloc
c_func
(paren
id|QDIO_MAX_BUFFERS_PER_Q
op_star
r_sizeof
(paren
r_void
op_star
)paren
op_star
id|card-&gt;no_queues
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|output_array
)paren
(brace
id|vfree
c_func
(paren
id|input_array
)paren
suffix:semicolon
id|vfree
c_func
(paren
id|adapter_area
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|ptr
op_assign
id|output_array
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|card-&gt;no_queues
suffix:semicolon
id|i
op_increment
)paren
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
id|QDIO_MAX_BUFFERS_PER_Q
suffix:semicolon
id|j
op_increment
)paren
(brace
op_star
id|ptr
op_assign
(paren
r_void
op_star
)paren
id|virt_to_phys
(paren
op_amp
id|card-&gt;outbound_ringbuffer
(braket
id|i
)braket
op_member_access_from_pointer
id|buffer
(braket
id|j
)braket
)paren
suffix:semicolon
id|ptr
op_increment
suffix:semicolon
)brace
id|init_data.cdev
op_assign
id|CARD_DDEV
c_func
(paren
id|card
)paren
suffix:semicolon
id|init_data.q_format
op_assign
id|qeth_get_q_format
c_func
(paren
id|card-&gt;type
)paren
suffix:semicolon
id|init_data.qib_param_field_format
op_assign
l_int|0
suffix:semicolon
id|init_data.qib_param_field
op_assign
id|adapter_area
suffix:semicolon
id|init_data.input_slib_elements
op_assign
l_int|NULL
suffix:semicolon
id|init_data.output_slib_elements
op_assign
l_int|NULL
suffix:semicolon
id|init_data.min_input_threshold
op_assign
id|card-&gt;options.polltime
suffix:semicolon
id|init_data.max_input_threshold
op_assign
id|card-&gt;options.polltime
suffix:semicolon
id|init_data.min_output_threshold
op_assign
id|QETH_MIN_OUTPUT_THRESHOLD
suffix:semicolon
id|init_data.max_output_threshold
op_assign
id|QETH_MAX_OUTPUT_THRESHOLD
suffix:semicolon
id|init_data.no_input_qs
op_assign
l_int|1
suffix:semicolon
id|init_data.no_output_qs
op_assign
id|card-&gt;no_queues
suffix:semicolon
id|init_data.input_handler
op_assign
id|qeth_qdio_input_handler
suffix:semicolon
id|init_data.output_handler
op_assign
id|qeth_qdio_output_handler
suffix:semicolon
id|init_data.int_parm
op_assign
(paren
r_int
r_int
)paren
id|card
suffix:semicolon
id|init_data.flags
op_assign
id|QDIO_INBOUND_0COPY_SBALS
op_or
id|QDIO_OUTBOUND_0COPY_SBALS
op_or
id|QDIO_USE_OUTBOUND_PCIS
suffix:semicolon
id|init_data.input_sbal_addr_array
op_assign
id|input_array
suffix:semicolon
id|init_data.output_sbal_addr_array
op_assign
id|output_array
suffix:semicolon
id|result
op_assign
id|qdio_initialize
c_func
(paren
op_amp
id|init_data
)paren
suffix:semicolon
id|vfree
c_func
(paren
id|input_array
)paren
suffix:semicolon
id|vfree
c_func
(paren
id|output_array
)paren
suffix:semicolon
id|vfree
c_func
(paren
id|adapter_area
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;qde=%4i&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_qdio_activate
id|qeth_qdio_activate
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_int
id|result
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
id|result
op_assign
id|qdio_activate
c_func
(paren
id|CARD_DDEV
c_func
(paren
id|card
)paren
comma
l_int|0
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;qda=%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_dm_act
id|qeth_dm_act
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_int
r_char
op_star
id|buffer
suffix:semicolon
r_int
id|result
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
id|memcpy
c_func
(paren
id|card-&gt;send_buf
comma
id|DM_ACT
comma
id|DM_ACT_SIZE
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|QETH_DM_ACT_DEST_ADDR
c_func
(paren
id|card-&gt;send_buf
)paren
comma
op_amp
id|card-&gt;token.cm_connection_r
comma
id|QETH_MPC_TOKEN_LENGTH
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|QETH_DM_ACT_CONNECTION_TOKEN
c_func
(paren
id|card-&gt;send_buf
)paren
comma
op_amp
id|card-&gt;token.ulp_connection_r
comma
id|QETH_MPC_TOKEN_LENGTH
)paren
suffix:semicolon
id|buffer
op_assign
id|qeth_send_control_data
c_func
(paren
id|card
comma
id|card-&gt;send_buf
comma
id|DM_ACT_SIZE
comma
id|MPC_SETUP_STATE
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|buffer
)paren
(brace
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;DMA:NOBF&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EIO
suffix:semicolon
)brace
id|result
op_assign
id|qeth_check_idx_response
c_func
(paren
id|buffer
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;dma=%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
r_static
r_inline
r_int
DECL|function|__qeth_verify_dev_vlan
id|__qeth_verify_dev_vlan
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
macro_line|#ifdef QETH_VLAN
r_struct
id|vlan_group
op_star
id|vlan_grp
suffix:semicolon
r_int
id|i
suffix:semicolon
r_int
id|result
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* check all vlan devices */
id|vlan_grp
op_assign
(paren
r_struct
id|vlan_group
op_star
)paren
id|card-&gt;vlangrp
suffix:semicolon
r_if
c_cond
(paren
id|vlan_grp
)paren
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|VLAN_GROUP_ARRAY_LEN
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|vlan_grp-&gt;vlan_devices
(braket
id|i
)braket
op_eq
id|dev
)paren
(brace
id|result
op_assign
id|QETH_VERIFY_IS_VLAN_DEV
suffix:semicolon
)brace
)brace
)brace
r_return
id|result
suffix:semicolon
macro_line|#endif
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#if defined(QETH_VLAN)||defined(QETH_IPV6)
r_static
r_int
DECL|function|qeth_verify_dev
id|qeth_verify_dev
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|qeth_card
op_star
id|tmp
suffix:semicolon
r_int
id|result
op_assign
l_int|0
suffix:semicolon
id|read_lock
c_func
(paren
op_amp
id|list_lock
)paren
suffix:semicolon
id|tmp
op_assign
id|firstcard
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
id|tmp
op_logical_and
(paren
op_logical_neg
id|result
)paren
suffix:semicolon
id|tmp
op_assign
id|tmp-&gt;next
)paren
(brace
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|tmp-&gt;shutdown_phase
)paren
)paren
r_continue
suffix:semicolon
id|result
op_assign
(paren
id|dev
op_eq
id|tmp-&gt;dev
)paren
ques
c_cond
id|QETH_VERIFY_IS_REAL_DEV
suffix:colon
id|__qeth_verify_dev_vlan
c_func
(paren
id|dev
comma
id|tmp
)paren
suffix:semicolon
)brace
id|read_unlock
c_func
(paren
op_amp
id|list_lock
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
macro_line|#endif /* defined(QETH_VLAN)||defined(QETH_IPV6) */
r_static
r_int
DECL|function|qeth_verify_card
id|qeth_verify_card
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_struct
id|qeth_card
op_star
id|tmp
suffix:semicolon
r_int
id|result
op_assign
l_int|0
suffix:semicolon
id|read_lock
c_func
(paren
op_amp
id|list_lock
)paren
suffix:semicolon
id|tmp
op_assign
id|firstcard
suffix:semicolon
r_while
c_loop
(paren
id|tmp
)paren
(brace
r_if
c_cond
(paren
(paren
id|card
op_eq
id|tmp
)paren
op_logical_and
(paren
op_logical_neg
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;shutdown_phase
)paren
)paren
)paren
(brace
id|result
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
)brace
id|tmp
op_assign
id|tmp-&gt;next
suffix:semicolon
)brace
id|read_unlock
c_func
(paren
op_amp
id|list_lock
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
r_static
r_inline
r_struct
id|qeth_card
op_star
DECL|function|__qeth_get_card_from_dev
id|__qeth_get_card_from_dev
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
macro_line|#ifdef QETH_VLAN
r_if
c_cond
(paren
id|qeth_verify_dev
c_func
(paren
id|dev
)paren
op_eq
id|QETH_VERIFY_IS_VLAN_DEV
)paren
r_return
(paren
r_struct
id|qeth_card
op_star
)paren
id|VLAN_DEV_INFO
c_func
(paren
id|dev
)paren
op_member_access_from_pointer
id|real_dev-&gt;priv
suffix:semicolon
r_else
macro_line|#endif
r_return
(paren
r_struct
id|qeth_card
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
)brace
macro_line|#ifdef QETH_IPV6
multiline_comment|/* FIXME: don&squot;t put extern declarations in a c file, use a header that&squot;s&n; * shared with the definition for this! */
r_extern
r_struct
id|neigh_table
id|arp_tbl
suffix:semicolon
DECL|variable|qeth_old_arp_constructor
r_static
r_int
(paren
op_star
id|qeth_old_arp_constructor
)paren
(paren
r_struct
id|neighbour
op_star
)paren
suffix:semicolon
DECL|variable|arp_direct_ops_template
r_static
r_struct
id|neigh_ops
id|arp_direct_ops_template
op_assign
(brace
dot
id|family
op_assign
id|AF_INET
comma
dot
id|destructor
op_assign
l_int|NULL
comma
dot
id|solicit
op_assign
l_int|NULL
comma
dot
id|error_report
op_assign
l_int|NULL
comma
dot
id|output
op_assign
id|dev_queue_xmit
comma
dot
id|connected_output
op_assign
id|dev_queue_xmit
comma
dot
id|hh_output
op_assign
id|dev_queue_xmit
comma
dot
id|queue_xmit
op_assign
id|dev_queue_xmit
)brace
suffix:semicolon
multiline_comment|/*&n; * FIXME:&n; * as we have neighbour structures point to this structure, even&n; * after our life time, this will stay in memory as a leak &n; */
DECL|variable|arp_direct_ops
r_static
r_struct
id|neigh_ops
op_star
id|arp_direct_ops
suffix:semicolon
r_static
r_int
DECL|function|qeth_arp_constructor
id|qeth_arp_constructor
c_func
(paren
r_struct
id|neighbour
op_star
id|neigh
)paren
(brace
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_struct
id|net_device
op_star
id|dev
op_assign
id|neigh-&gt;dev
suffix:semicolon
r_struct
id|in_device
op_star
id|in_dev
op_assign
id|in_dev_get
c_func
(paren
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|in_dev
op_eq
l_int|NULL
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;arpconst&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|qeth_verify_dev
c_func
(paren
id|dev
)paren
)paren
(brace
id|in_dev_put
c_func
(paren
id|in_dev
)paren
suffix:semicolon
r_return
id|qeth_old_arp_constructor
c_func
(paren
id|neigh
)paren
suffix:semicolon
)brace
id|neigh-&gt;type
op_assign
id|inet_addr_type
c_func
(paren
op_star
(paren
id|u32
op_star
)paren
id|neigh-&gt;primary_key
)paren
suffix:semicolon
r_if
c_cond
(paren
id|in_dev-&gt;arp_parms
)paren
id|neigh-&gt;parms
op_assign
id|in_dev-&gt;arp_parms
suffix:semicolon
id|in_dev_put
c_func
(paren
id|in_dev
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%08x&quot;
comma
id|ntohl
c_func
(paren
op_star
(paren
(paren
id|__u32
op_star
)paren
(paren
id|neigh-&gt;primary_key
)paren
)paren
)paren
)paren
suffix:semicolon
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|QETH_DBF_HEX4
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|neigh
comma
r_sizeof
(paren
r_void
op_star
)paren
)paren
suffix:semicolon
id|neigh-&gt;nud_state
op_assign
id|NUD_NOARP
suffix:semicolon
id|neigh-&gt;ops
op_assign
id|arp_direct_ops
suffix:semicolon
id|neigh-&gt;output
op_assign
id|neigh-&gt;ops-&gt;queue_xmit
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_hard_header
id|qeth_hard_header
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|net_device
op_star
id|dev
comma
r_int
r_int
id|type
comma
r_void
op_star
id|daddr
comma
r_void
op_star
id|saddr
comma
r_int
id|len
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
id|QETH_DBF_TEXT5
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;hardhdr&quot;
)paren
suffix:semicolon
id|card
op_assign
id|__qeth_get_card_from_dev
c_func
(paren
id|dev
)paren
suffix:semicolon
r_return
id|card
op_member_access_from_pointer
id|hard_header
c_func
(paren
id|skb
comma
id|dev
comma
id|type
comma
id|daddr
comma
id|saddr
comma
id|len
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_header_cache_update
id|qeth_header_cache_update
c_func
(paren
r_struct
id|hh_cache
op_star
id|hh
comma
r_struct
id|net_device
op_star
id|dev
comma
r_int
r_char
op_star
id|haddr
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
id|card
op_assign
(paren
r_struct
id|qeth_card
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
id|QETH_DBF_TEXT5
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;hdrcheup&quot;
)paren
suffix:semicolon
r_return
id|card
op_member_access_from_pointer
id|header_cache_update
c_func
(paren
id|hh
comma
id|dev
comma
id|haddr
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_rebuild_header
id|qeth_rebuild_header
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
id|QETH_DBF_TEXT5
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;rebldhdr&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb-&gt;protocol
op_eq
id|__constant_htons
c_func
(paren
id|ETH_P_IP
)paren
)paren
r_return
l_int|0
suffix:semicolon
id|card
op_assign
id|__qeth_get_card_from_dev
c_func
(paren
id|skb-&gt;dev
)paren
suffix:semicolon
r_return
id|card
op_member_access_from_pointer
id|rebuild_header
c_func
(paren
id|skb
)paren
suffix:semicolon
)brace
r_int
DECL|function|qeth_ipv6_generate_eui64
id|qeth_ipv6_generate_eui64
c_func
(paren
id|u8
op_star
id|eui
comma
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_switch
c_cond
(paren
id|dev-&gt;type
)paren
(brace
r_case
id|ARPHRD_ETHER
suffix:colon
r_case
id|ARPHRD_FDDI
suffix:colon
r_case
id|ARPHRD_IEEE802_TR
suffix:colon
r_if
c_cond
(paren
id|dev-&gt;addr_len
op_ne
id|ETH_ALEN
)paren
r_return
op_minus
l_int|1
suffix:semicolon
id|memcpy
c_func
(paren
id|eui
comma
id|dev-&gt;dev_addr
comma
l_int|3
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|eui
op_plus
l_int|5
comma
id|dev-&gt;dev_addr
op_plus
l_int|3
comma
l_int|3
)paren
suffix:semicolon
id|eui
(braket
l_int|3
)braket
op_assign
(paren
id|dev-&gt;dev_id
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
suffix:semicolon
id|eui
(braket
l_int|4
)braket
op_assign
id|dev-&gt;dev_id
op_amp
l_int|0xff
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_return
op_minus
l_int|1
suffix:semicolon
)brace
macro_line|#endif /* QETH_IPV6 */
r_static
r_void
DECL|function|qeth_ipv6_init_card
id|qeth_ipv6_init_card
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
macro_line|#ifdef QETH_IPV6
id|card-&gt;hard_header
op_assign
id|qeth_get_hard_header
c_func
(paren
id|card-&gt;link_type
)paren
suffix:semicolon
id|card-&gt;rebuild_header
op_assign
id|qeth_get_rebuild_header
c_func
(paren
id|card-&gt;link_type
)paren
suffix:semicolon
id|card-&gt;hard_header_cache
op_assign
id|qeth_get_hard_header_cache
c_func
(paren
id|card-&gt;link_type
)paren
suffix:semicolon
id|card-&gt;header_cache_update
op_assign
id|qeth_get_header_cache_update
c_func
(paren
id|card-&gt;link_type
)paren
suffix:semicolon
id|card-&gt;type_trans
op_assign
id|qeth_get_type_trans
c_func
(paren
id|card-&gt;link_type
)paren
suffix:semicolon
id|card-&gt;dev-&gt;dev_id
op_assign
id|card-&gt;unique_id
op_amp
l_int|0xffff
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|card-&gt;unique_id
op_amp
id|UNIQUE_ID_NOT_BY_CARD
)paren
)paren
id|card-&gt;dev-&gt;generate_eui64
op_assign
id|qeth_ipv6_generate_eui64
suffix:semicolon
macro_line|#endif /* QETH_IPV6 */
)brace
macro_line|#ifdef QETH_VLAN
r_static
r_void
DECL|function|qeth_vlan_rx_register
id|qeth_vlan_rx_register
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|vlan_group
op_star
id|grp
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
id|card
op_assign
(paren
r_struct
id|qeth_card
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|card-&gt;vlan_lock
)paren
suffix:semicolon
id|card-&gt;vlangrp
op_assign
id|grp
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|card-&gt;vlan_lock
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_vlan_rx_kill_vid
id|qeth_vlan_rx_kill_vid
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_int
r_int
id|vid
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
id|card
op_assign
(paren
r_struct
id|qeth_card
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|card-&gt;vlan_lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|card-&gt;vlangrp
)paren
id|card-&gt;vlangrp-&gt;vlan_devices
(braket
id|vid
)braket
op_assign
l_int|NULL
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|card-&gt;vlan_lock
)paren
suffix:semicolon
)brace
macro_line|#endif
r_static
r_void
DECL|function|qeth_tx_timeout
id|qeth_tx_timeout
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
id|card
op_assign
(paren
r_struct
id|qeth_card
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
id|QETH_DBF_CARD2
c_func
(paren
l_int|1
comma
id|trace
comma
l_string|&quot;XMTO&quot;
comma
id|card
)paren
suffix:semicolon
id|card-&gt;stats-&gt;tx_errors
op_increment
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;problem
comma
id|PROBLEM_TX_TIMEOUT
)paren
suffix:semicolon
id|qeth_schedule_recovery
c_func
(paren
id|card
)paren
suffix:semicolon
)brace
r_static
r_void
op_star
DECL|function|__qeth_rebuild_header_func
id|__qeth_rebuild_header_func
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
macro_line|#ifdef QETH_IPV6
r_return
(paren
op_logical_neg
(paren
id|qeth_get_additional_dev_flags
c_func
(paren
id|card-&gt;type
)paren
op_amp
id|IFF_NOARP
)paren
)paren
ques
c_cond
(paren
id|qeth_get_rebuild_header
c_func
(paren
id|card-&gt;link_type
)paren
ques
c_cond
id|qeth_rebuild_header
suffix:colon
l_int|NULL
)paren
suffix:colon
l_int|NULL
suffix:semicolon
macro_line|#endif /* QETH_IPV6 */
r_return
l_int|NULL
suffix:semicolon
)brace
r_static
r_void
op_star
DECL|function|__qeth_hard_header_func
id|__qeth_hard_header_func
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
macro_line|#ifdef QETH_IPV6
r_return
(paren
op_logical_neg
(paren
id|qeth_get_additional_dev_flags
c_func
(paren
id|card-&gt;type
)paren
op_amp
id|IFF_NOARP
)paren
)paren
ques
c_cond
(paren
id|qeth_get_hard_header
c_func
(paren
id|card-&gt;link_type
)paren
ques
c_cond
id|qeth_hard_header
suffix:colon
l_int|NULL
)paren
suffix:colon
l_int|NULL
suffix:semicolon
macro_line|#endif /* QETH_IPV6 */
r_return
l_int|NULL
suffix:semicolon
)brace
r_static
r_void
op_star
DECL|function|__qeth_header_cache_update_func
id|__qeth_header_cache_update_func
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
macro_line|#ifdef QETH_IPV6
r_return
(paren
op_logical_neg
(paren
id|qeth_get_additional_dev_flags
c_func
(paren
id|card-&gt;type
)paren
op_amp
id|IFF_NOARP
)paren
)paren
ques
c_cond
(paren
id|qeth_get_header_cache_update
c_func
(paren
id|card-&gt;link_type
)paren
ques
c_cond
id|qeth_header_cache_update
suffix:colon
l_int|NULL
)paren
suffix:colon
l_int|NULL
suffix:semicolon
macro_line|#endif /* QETH_IPV6 */
r_return
l_int|NULL
suffix:semicolon
)brace
r_static
r_void
op_star
DECL|function|__qeth_hard_header_cache_func
id|__qeth_hard_header_cache_func
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
macro_line|#ifdef QETH_IPV6
r_return
(paren
op_logical_neg
(paren
id|qeth_get_additional_dev_flags
c_func
(paren
id|card-&gt;type
)paren
op_amp
id|IFF_NOARP
)paren
)paren
ques
c_cond
id|qeth_get_hard_header_cache
c_func
(paren
id|card-&gt;link_type
)paren
suffix:colon
l_int|NULL
suffix:semicolon
macro_line|#endif /* QETH_IPV6 */
r_return
l_int|NULL
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_init_dev
id|qeth_init_dev
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
id|card
op_assign
(paren
r_struct
id|qeth_card
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
id|QETH_DBF_CARD3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;inid&quot;
comma
id|card
)paren
suffix:semicolon
id|dev-&gt;tx_timeout
op_assign
op_amp
id|qeth_tx_timeout
suffix:semicolon
id|dev-&gt;watchdog_timeo
op_assign
id|QETH_TX_TIMEOUT
suffix:semicolon
id|dev-&gt;open
op_assign
id|qeth_open
suffix:semicolon
id|dev-&gt;stop
op_assign
id|qeth_stop
suffix:semicolon
id|dev-&gt;set_config
op_assign
id|qeth_set_config
suffix:semicolon
id|dev-&gt;hard_start_xmit
op_assign
id|qeth_hard_start_xmit
suffix:semicolon
id|dev-&gt;do_ioctl
op_assign
id|qeth_do_ioctl
suffix:semicolon
id|dev-&gt;get_stats
op_assign
id|qeth_get_stats
suffix:semicolon
id|dev-&gt;change_mtu
op_assign
id|qeth_change_mtu
suffix:semicolon
macro_line|#ifdef QETH_VLAN
id|dev-&gt;vlan_rx_register
op_assign
id|qeth_vlan_rx_register
suffix:semicolon
id|dev-&gt;vlan_rx_kill_vid
op_assign
id|qeth_vlan_rx_kill_vid
suffix:semicolon
macro_line|#endif
id|dev-&gt;rebuild_header
op_assign
id|__qeth_rebuild_header_func
c_func
(paren
id|card
)paren
suffix:semicolon
id|dev-&gt;hard_header
op_assign
id|__qeth_hard_header_func
c_func
(paren
id|card
)paren
suffix:semicolon
id|dev-&gt;header_cache_update
op_assign
id|__qeth_header_cache_update_func
c_func
(paren
id|card
)paren
suffix:semicolon
id|dev-&gt;hard_header_cache
op_assign
id|__qeth_hard_header_cache_func
c_func
(paren
id|card
)paren
suffix:semicolon
id|dev-&gt;hard_header_parse
op_assign
l_int|NULL
suffix:semicolon
id|dev-&gt;destructor
op_assign
id|qeth_destructor
suffix:semicolon
id|dev-&gt;set_multicast_list
op_assign
id|qeth_set_multicast_list
suffix:semicolon
id|dev-&gt;set_mac_address
op_assign
id|qeth_set_mac_address
suffix:semicolon
id|dev-&gt;neigh_setup
op_assign
id|qeth_neigh_setup
suffix:semicolon
id|dev-&gt;flags
op_or_assign
id|qeth_get_additional_dev_flags
c_func
(paren
id|card-&gt;type
)paren
suffix:semicolon
id|dev-&gt;flags
op_or_assign
(paren
(paren
id|card-&gt;options.fake_broadcast
op_eq
id|FAKE_BROADCAST
)paren
op_logical_or
(paren
id|card-&gt;broadcast_capable
)paren
)paren
ques
c_cond
id|IFF_BROADCAST
suffix:colon
l_int|0
suffix:semicolon
multiline_comment|/* is done in hardsetup_card... see comment below&n;&t; qeth_send_qipassist(card,4);*/
multiline_comment|/* that was the old place. one id. we need to make sure, that&n;&t; * hydra knows about us going to use the same id again, so we&n;&t; * do that in hardsetup_card every time&n;&t; qeth_get_unique_id(card);*/
id|dev-&gt;tx_queue_len
op_assign
id|qeth_get_device_tx_q_len
c_func
(paren
id|card-&gt;type
)paren
suffix:semicolon
id|dev-&gt;hard_header_len
op_assign
id|qeth_get_hlen
c_func
(paren
id|card-&gt;link_type
)paren
op_plus
id|card-&gt;options.add_hhlen
suffix:semicolon
id|dev-&gt;addr_len
op_assign
id|OSA_ADDR_LEN
suffix:semicolon
multiline_comment|/* is ok for eth, tr, atm lane */
id|SET_MODULE_OWNER
c_func
(paren
id|dev
)paren
suffix:semicolon
id|netif_start_queue
c_func
(paren
id|dev
)paren
suffix:semicolon
id|dev-&gt;mtu
op_assign
id|card-&gt;initial_mtu
suffix:semicolon
id|qeth_ipv6_init_card
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_get_unitaddr
id|qeth_get_unitaddr
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_char
op_star
id|prcd
suffix:semicolon
r_int
id|result
op_assign
l_int|0
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_int
id|length
suffix:semicolon
id|QETH_DBF_CARD3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;gtua&quot;
comma
id|card
)paren
suffix:semicolon
id|result
op_assign
id|read_conf_data
c_func
(paren
id|CARD_DDEV
c_func
(paren
id|card
)paren
comma
(paren
r_void
op_star
op_star
)paren
op_amp
id|prcd
comma
op_amp
id|length
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;rcd%4x&quot;
comma
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|PRINT_ERR
c_func
(paren
l_string|&quot;read_conf_data for device %s returned %i&bslash;n&quot;
comma
id|CARD_DDEV_ID
c_func
(paren
id|card
)paren
comma
id|result
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
id|card-&gt;chpid
op_assign
id|prcd
(braket
l_int|30
)braket
suffix:semicolon
id|card-&gt;unit_addr2
op_assign
id|prcd
(braket
l_int|31
)braket
suffix:semicolon
id|card-&gt;cula
op_assign
id|prcd
(braket
l_int|63
)braket
suffix:semicolon
id|card-&gt;is_guest_lan
op_assign
(paren
(paren
id|prcd
(braket
l_int|0x10
)braket
op_eq
id|_ascebc
(braket
l_char|&squot;V&squot;
)braket
)paren
op_logical_and
(paren
id|prcd
(braket
l_int|0x11
)braket
op_eq
id|_ascebc
(braket
l_char|&squot;M&squot;
)braket
)paren
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;chpid:%02x&quot;
comma
id|card-&gt;chpid
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;unad2:%02x&quot;
comma
id|card-&gt;unit_addr2
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;cula:%02x&quot;
comma
id|card-&gt;cula
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_send_nops
id|qeth_send_nops
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_int
id|result
comma
id|result2
suffix:semicolon
r_int
r_int
id|saveflags
suffix:semicolon
id|card-&gt;dma_stuff-&gt;write_ccw.cmd_code
op_assign
id|CCW_NOP_CMD
suffix:semicolon
id|card-&gt;dma_stuff-&gt;write_ccw.flags
op_assign
id|CCW_FLAG_SLI
suffix:semicolon
id|card-&gt;dma_stuff-&gt;write_ccw.count
op_assign
id|CCW_NOP_COUNT
suffix:semicolon
id|card-&gt;dma_stuff-&gt;write_ccw.cda
op_assign
(paren
r_int
r_int
)paren
l_int|NULL
suffix:semicolon
DECL|macro|DO_SEND_NOP
mdefine_line|#define DO_SEND_NOP(cdev) &bslash;&n;do { &bslash;&n;&t;QETH_DBF_TEXT3(0, trace, &quot;snnp&quot;); &bslash;&n;&t;QETH_DBF_TEXT3(0, trace, cdev-&gt;dev.bus_id); &bslash;&n;&bslash;&n;&t;spin_lock_irqsave(get_ccwdev_lock(cdev),saveflags); &bslash;&n;&t;ccw_device_set_options(cdev, 0); &bslash;&n;        result=ccw_device_start(cdev,&amp;card-&gt;dma_stuff-&gt;write_ccw, &bslash;&n;&t;&t;&t;&t;NOP_STATE,0,0); &bslash;&n;        if (result) { &bslash;&n;&t;&t;qeth_delay_millis(QETH_WAIT_BEFORE_2ND_DOIO); &bslash;&n;                result2=ccw_device_start(cdev,&amp;card-&gt;dma_stuff-&gt;write_ccw, &bslash;&n;&t;&t;&t;&t;&t; NOP_STATE,0,0); &bslash;&n;                PRINT_WARN(&quot;qeth_send_nops on device %s: do_IO returned %i, &quot; &bslash;&n;                           &quot;next try returns %i&bslash;n&quot;, &bslash;&n;                           cdev-&gt;dev.bus_id,result,result2); &bslash;&n;&t;&t;result=result2; &bslash;&n;        } &bslash;&n;        spin_unlock_irqrestore(get_ccwdev_lock(cdev),saveflags); &bslash;&n;&bslash;&n;&t;if (result) goto exit; &bslash;&n;&bslash;&n;        if (qeth_sleepon(card,QETH_NOP_TIMEOUT)) { &bslash;&n;&t;&t;QETH_DBF_TEXT2(0,trace,&quot;snnp:tme&quot;); &bslash;&n;&t;&t;result=-EIO; &bslash;&n;&t;&t;goto exit; &bslash;&n;        } &bslash;&n;} while (0)
id|DO_SEND_NOP
c_func
(paren
id|CARD_RDEV
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
id|DO_SEND_NOP
c_func
(paren
id|CARD_WDEV
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
id|DO_SEND_NOP
c_func
(paren
id|CARD_DDEV
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
m_exit
suffix:colon
r_return
id|result
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_clear_card_structures
id|qeth_clear_card_structures
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_int
id|i
comma
id|j
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
(brace
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;clrCRDnc&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|QETH_DBF_CARD3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;clcs&quot;
comma
id|card
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;is_startlaned
comma
l_int|0
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|QETH_MAX_QUEUES
suffix:semicolon
id|i
op_increment
)paren
(brace
id|card-&gt;send_state
(braket
id|i
)braket
op_assign
id|SEND_STATE_DONT_PACK
suffix:semicolon
id|card-&gt;outbound_first_free_buffer
(braket
id|i
)braket
op_assign
l_int|0
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;outbound_used_buffers
(braket
id|i
)braket
comma
l_int|0
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;outbound_ringbuffer_lock
(braket
id|i
)braket
comma
l_int|0
)paren
suffix:semicolon
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
id|QDIO_MAX_BUFFERS_PER_Q
suffix:semicolon
id|j
op_increment
)paren
(brace
id|card-&gt;outbound_buffer_send_state
(braket
id|i
)braket
(braket
id|j
)braket
op_assign
id|SEND_STATE_DONT_PACK
suffix:semicolon
id|card-&gt;send_retries
(braket
id|i
)braket
(braket
id|j
)braket
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|i
OL
id|card-&gt;no_queues
)paren
(brace
id|card-&gt;outbound_ringbuffer
(braket
id|i
)braket
op_member_access_from_pointer
id|ringbuf_element
(braket
id|j
)braket
dot
id|next_element_to_fill
op_assign
l_int|0
suffix:semicolon
id|card-&gt;outbound_bytes_in_buffer
(braket
id|i
)braket
op_assign
l_int|0
suffix:semicolon
id|skb_queue_head_init
c_func
(paren
op_amp
id|card
op_member_access_from_pointer
id|outbound_ringbuffer
(braket
id|i
)braket
op_member_access_from_pointer
id|ringbuf_element
(braket
id|j
)braket
dot
id|skb_list
)paren
suffix:semicolon
)brace
)brace
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|card-&gt;options.inbound_buffer_count
suffix:semicolon
id|i
op_increment
)paren
(brace
id|xchg
c_func
(paren
(paren
r_int
op_star
)paren
op_amp
id|card-&gt;inbound_buffer_pool_entry_used
(braket
id|i
)braket
comma
id|BUFFER_UNUSED
)paren
suffix:semicolon
)brace
id|spin_lock_init
c_func
(paren
op_amp
id|card-&gt;requeue_input_lock
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;requeue_position
comma
l_int|0
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;requeue_counter
comma
l_int|0
)paren
suffix:semicolon
id|card-&gt;seqno.trans_hdr
op_assign
l_int|0
suffix:semicolon
id|card-&gt;seqno.pdu_hdr
op_assign
l_int|0
suffix:semicolon
id|card-&gt;seqno.pdu_hdr_ack
op_assign
l_int|0
suffix:semicolon
id|card-&gt;seqno.ipa
op_assign
l_int|0
suffix:semicolon
id|qeth_clear_ifa4_list
c_func
(paren
op_amp
id|card-&gt;ip_current_state.ip_ifa
)paren
suffix:semicolon
id|qeth_clear_ifa4_list
c_func
(paren
op_amp
id|card-&gt;ip_new_state.ip_ifa
)paren
suffix:semicolon
id|qeth_clear_ifamc_list
c_func
(paren
op_amp
id|card-&gt;ip_mc_current_state.ipm_ifa
)paren
suffix:semicolon
id|qeth_clear_ifamc_list
c_func
(paren
op_amp
id|card-&gt;ip_mc_new_state.ipm_ifa
)paren
suffix:semicolon
macro_line|#ifdef QETH_IPV6
id|qeth_clear_ifa6_list
c_func
(paren
op_amp
id|card-&gt;ip_current_state.ip6_ifa
)paren
suffix:semicolon
id|qeth_clear_ifa6_list
c_func
(paren
op_amp
id|card-&gt;ip_new_state.ip6_ifa
)paren
suffix:semicolon
id|qeth_clear_ifamc_list
c_func
(paren
op_amp
id|card-&gt;ip_mc_current_state.ipm6_ifa
)paren
suffix:semicolon
id|qeth_clear_ifamc_list
c_func
(paren
op_amp
id|card-&gt;ip_mc_new_state.ipm6_ifa
)paren
suffix:semicolon
macro_line|#endif /* QETH_IPV6 */
)brace
r_static
r_void
DECL|function|qeth_init_input_buffers
id|qeth_init_input_buffers
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_int
id|i
suffix:semicolon
multiline_comment|/* slowly, slowly (we don&squot;t want to enqueue all buffers&n;&t; * at one time) */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|QDIO_MAX_BUFFERS_PER_Q
suffix:semicolon
id|i
op_increment
)paren
(brace
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;inbound_buffer_refcnt
(braket
id|i
)braket
comma
l_int|1
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|QDIO_MAX_BUFFERS_PER_Q
suffix:semicolon
id|i
op_increment
)paren
(brace
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;inbound_buffer_refcnt
(braket
id|i
)braket
comma
l_int|0
)paren
suffix:semicolon
multiline_comment|/* only try to queue as many buffers as we have at all */
r_if
c_cond
(paren
id|i
OL
id|card-&gt;options.inbound_buffer_count
)paren
id|qeth_queue_input_buffer
c_func
(paren
id|card
comma
id|i
comma
l_int|0
)paren
suffix:semicolon
)brace
id|qdio_synchronize
c_func
(paren
id|CARD_DDEV
c_func
(paren
id|card
)paren
comma
id|QDIO_FLAG_SYNC_INPUT
comma
l_int|0
)paren
suffix:semicolon
)brace
multiline_comment|/* initializes all the structures for a card */
r_static
r_int
DECL|function|qeth_hardsetup_card
id|qeth_hardsetup_card
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_int
id|in_recovery
)paren
(brace
r_int
id|result
comma
id|q
comma
id|breakout
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
id|laps
op_assign
id|QETH_HARDSETUP_LAPS
suffix:semicolon
r_int
id|clear_laps
suffix:semicolon
r_int
id|cleanup_qdio
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_int
id|i
comma
id|r
suffix:semicolon
multiline_comment|/* setup name and so on */
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;shutdown_phase
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_hardsetup
)paren
)paren
(brace
id|QETH_DBF_CARD2
c_func
(paren
l_int|1
comma
id|trace
comma
l_string|&quot;hscd&quot;
comma
id|card
)paren
suffix:semicolon
id|PRINT_ALL
c_func
(paren
l_string|&quot;card is already hardsetup.&bslash;n&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|cleanup_qdio
op_assign
id|in_recovery
suffix:semicolon
multiline_comment|/* if we are in recovery, we clean&n;&t;&t;&t;&t;&t;   the qdio stuff up */
id|down
c_func
(paren
op_amp
id|card-&gt;hardsetup_sema
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;write_busy
comma
l_int|0
)paren
suffix:semicolon
r_do
(brace
r_if
c_cond
(paren
id|in_recovery
)paren
(brace
id|PRINT_STUPID
c_func
(paren
l_string|&quot;qeth: recovery: quiescing %s...&bslash;n&quot;
comma
id|card-&gt;dev_name
)paren
suffix:semicolon
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;Rqsc&quot;
comma
id|card
)paren
suffix:semicolon
id|qeth_wait_nonbusy
c_func
(paren
id|QETH_QUIESCE_WAIT_BEFORE_CLEAR
)paren
suffix:semicolon
)brace
id|clear_laps
op_assign
id|QETH_HARDSETUP_CLEAR_LAPS
suffix:semicolon
r_do
(brace
r_if
c_cond
(paren
id|in_recovery
)paren
id|PRINT_STUPID
c_func
(paren
l_string|&quot;clearing card %s&bslash;n&quot;
comma
id|card-&gt;dev_name
)paren
suffix:semicolon
id|qeth_clear_card
c_func
(paren
id|card
comma
id|cleanup_qdio
comma
(paren
id|card-&gt;type
op_eq
id|QETH_CARD_TYPE_OSAE
)paren
)paren
suffix:semicolon
id|result
op_assign
id|qeth_send_nops
c_func
(paren
id|card
)paren
suffix:semicolon
id|breakout
op_assign
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;break_out
)paren
suffix:semicolon
)brace
r_while
c_loop
(paren
(paren
op_decrement
id|clear_laps
)paren
op_logical_and
(paren
id|result
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
r_goto
m_exit
suffix:semicolon
)brace
r_if
c_cond
(paren
id|in_recovery
)paren
(brace
id|PRINT_STUPID
c_func
(paren
l_string|&quot;qeth: recovery: still quiescing %s...&bslash;n&quot;
comma
id|card-&gt;dev_name
)paren
suffix:semicolon
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;RQsc&quot;
comma
id|card
)paren
suffix:semicolon
id|qeth_wait_nonbusy
c_func
(paren
id|QETH_QUIESCE_WAIT_AFTER_CLEAR
)paren
suffix:semicolon
)brace
r_else
(brace
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;shutdown_phase
comma
l_int|0
)paren
suffix:semicolon
)brace
id|cleanup_qdio
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* qdio was cleaned now, if necessary */
id|result
op_assign
id|qeth_get_unitaddr
c_func
(paren
id|card
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
r_goto
m_exit
suffix:semicolon
id|qeth_generate_tokens
c_func
(paren
id|card
)paren
suffix:semicolon
DECL|macro|PRINT_TOKENS
mdefine_line|#define PRINT_TOKENS do { &bslash;&n;&t;&t;sprintf(dbf_text,&quot;stra    &quot;); &bslash;&n;&t;&t;memcpy(&amp;dbf_text[4],&amp;card-&gt;seqno.trans_hdr,4); &bslash;&n;&t;&t;QETH_DBF_HEX3(0,trace,dbf_text,QETH_DBF_TRACE_LEN); &bslash;&n;&t;&t;sprintf(dbf_text,&quot;spdu    &quot;); &bslash;&n;&t;&t;memcpy(&amp;dbf_text[4],&amp;card-&gt;seqno.pdu_hdr,4); &bslash;&n;&t;&t;QETH_DBF_HEX3(0,trace,dbf_text,QETH_DBF_TRACE_LEN); &bslash;&n;&t;&t;sprintf(dbf_text,&quot;spda    &quot;); &bslash;&n;&t;&t;memcpy(&amp;dbf_text[4],&amp;card-&gt;seqno.pdu_hdr_ack,4); &bslash;&n;&t;&t;QETH_DBF_HEX3(0,trace,dbf_text,QETH_DBF_TRACE_LEN); &bslash;&n;&t;&t;sprintf(dbf_text,&quot;sipa    &quot;); &bslash;&n;&t;&t;memcpy(&amp;dbf_text[4],&amp;card-&gt;seqno.ipa,4); &bslash;&n;&t;&t;QETH_DBF_HEX3(0,trace,dbf_text,QETH_DBF_TRACE_LEN); &bslash;&n;&t;&t;sprintf(dbf_text,&quot;tisw    &quot;); &bslash;&n;&t;&t;memcpy(&amp;dbf_text[4],&amp;card-&gt;token.issuer_rm_w,4); &bslash;&n;&t;&t;QETH_DBF_HEX3(0,trace,dbf_text,QETH_DBF_TRACE_LEN); &bslash;&n;&t;&t;sprintf(dbf_text,&quot;tisr    &quot;); &bslash;&n;&t;&t;memcpy(&amp;dbf_text[4],&amp;card-&gt;token.issuer_rm_r,4); &bslash;&n;&t;&t;QETH_DBF_HEX3(0,trace,dbf_text,QETH_DBF_TRACE_LEN); &bslash;&n;&t;&t;sprintf(dbf_text,&quot;tcfw    &quot;); &bslash;&n;&t;&t;memcpy(&amp;dbf_text[4],&amp;card-&gt;token.cm_filter_w,4); &bslash;&n;&t;&t;QETH_DBF_HEX3(0,trace,dbf_text,QETH_DBF_TRACE_LEN); &bslash;&n;&t;&t;sprintf(dbf_text,&quot;tcfr    &quot;); &bslash;&n;&t;&t;memcpy(&amp;dbf_text[4],&amp;card-&gt;token.cm_filter_r,4); &bslash;&n;&t;&t;QETH_DBF_HEX3(0,trace,dbf_text,QETH_DBF_TRACE_LEN); &bslash;&n;&t;&t;sprintf(dbf_text,&quot;tccw    &quot;); &bslash;&n;&t;&t;memcpy(&amp;dbf_text[4],&amp;card-&gt;token.cm_connection_w,4); &bslash;&n;&t;&t;QETH_DBF_HEX3(0,trace,dbf_text,QETH_DBF_TRACE_LEN); &bslash;&n;&t;&t;sprintf(dbf_text,&quot;tccr    &quot;); &bslash;&n;&t;&t;memcpy(&amp;dbf_text[4],&amp;card-&gt;token.cm_connection_r,4); &bslash;&n;&t;&t;QETH_DBF_HEX3(0,trace,dbf_text,QETH_DBF_TRACE_LEN); &bslash;&n;&t;&t;sprintf(dbf_text,&quot;tufw    &quot;); &bslash;&n;&t;&t;memcpy(&amp;dbf_text[4],&amp;card-&gt;token.ulp_filter_w,4); &bslash;&n;&t;&t;QETH_DBF_HEX3(0,trace,dbf_text,QETH_DBF_TRACE_LEN); &bslash;&n;&t;&t;sprintf(dbf_text,&quot;tufr    &quot;); &bslash;&n;&t;&t;memcpy(&amp;dbf_text[4],&amp;card-&gt;token.ulp_filter_r,4); &bslash;&n;&t;&t;QETH_DBF_HEX3(0,trace,dbf_text,QETH_DBF_TRACE_LEN); &bslash;&n;&t;&t;sprintf(dbf_text,&quot;tucw    &quot;); &bslash;&n;&t;&t;memcpy(&amp;dbf_text[4],&amp;card-&gt;token.ulp_connection_w,4); &bslash;&n;&t;&t;QETH_DBF_HEX3(0,trace,dbf_text,QETH_DBF_TRACE_LEN); &bslash;&n;&t;&t;sprintf(dbf_text,&quot;tucr    &quot;); &bslash;&n;&t;&t;memcpy(&amp;dbf_text[4],&amp;card-&gt;token.ulp_connection_r,4); &bslash;&n;&t;&t;QETH_DBF_HEX3(0,trace,dbf_text,QETH_DBF_TRACE_LEN); &bslash;&n;&t;} while (0)
id|PRINT_TOKENS
suffix:semicolon
multiline_comment|/* card-&gt;break_out and problem will be set here to 0&n;&t;&t; * (in each lap) (there can&squot;t be a problem at this&n;&t;&t; * early time) */
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;problem
comma
l_int|0
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;break_out
comma
l_int|0
)paren
suffix:semicolon
DECL|macro|CHECK_ERRORS
mdefine_line|#define CHECK_ERRORS &bslash;&n;&t;&t;breakout=atomic_read(&amp;card-&gt;break_out); &bslash;&n;&t;&t;if (breakout==QETH_BREAKOUT_AGAIN) &bslash;&n;&t;&t;&t;continue; &bslash;&n;&t;&t;else if (breakout==QETH_BREAKOUT_LEAVE) { &bslash;&n;&t;&t;&t;result=-EIO; &bslash;&n;&t;&t;&t;goto exit; &bslash;&n;&t;&t;} &bslash;&n;&t;&t;if (result) goto exit
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;hsidxard&quot;
)paren
suffix:semicolon
id|result
op_assign
id|qeth_idx_activate_read
c_func
(paren
id|card
)paren
suffix:semicolon
id|CHECK_ERRORS
suffix:semicolon
id|PRINT_TOKENS
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;hsidxawr&quot;
)paren
suffix:semicolon
id|result
op_assign
id|qeth_idx_activate_write
c_func
(paren
id|card
)paren
suffix:semicolon
id|CHECK_ERRORS
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;hsissurd&quot;
)paren
suffix:semicolon
multiline_comment|/* from here, there will always be an outstanding read */
id|spin_lock_irqsave
c_func
(paren
id|get_ccwdev_lock
c_func
(paren
id|CARD_RDEV
c_func
(paren
id|card
)paren
)paren
comma
id|flags
)paren
suffix:semicolon
id|qeth_issue_next_read
c_func
(paren
id|card
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
id|get_ccwdev_lock
c_func
(paren
id|CARD_RDEV
c_func
(paren
id|card
)paren
)paren
comma
id|flags
)paren
suffix:semicolon
id|PRINT_TOKENS
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;hscmenab&quot;
)paren
suffix:semicolon
id|result
op_assign
id|qeth_cm_enable
c_func
(paren
id|card
)paren
suffix:semicolon
id|CHECK_ERRORS
suffix:semicolon
id|PRINT_TOKENS
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;hscmsetu&quot;
)paren
suffix:semicolon
id|result
op_assign
id|qeth_cm_setup
c_func
(paren
id|card
)paren
suffix:semicolon
id|CHECK_ERRORS
suffix:semicolon
id|PRINT_TOKENS
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;hsulpena&quot;
)paren
suffix:semicolon
id|result
op_assign
id|qeth_ulp_enable
c_func
(paren
id|card
)paren
suffix:semicolon
id|CHECK_ERRORS
suffix:semicolon
id|PRINT_TOKENS
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;hsulpset&quot;
)paren
suffix:semicolon
id|result
op_assign
id|qeth_ulp_setup
c_func
(paren
id|card
)paren
suffix:semicolon
id|CHECK_ERRORS
suffix:semicolon
id|cleanup_qdio
op_assign
l_int|1
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;hsqdioes&quot;
)paren
suffix:semicolon
id|result
op_assign
id|qeth_qdio_establish
c_func
(paren
id|card
)paren
suffix:semicolon
id|CHECK_ERRORS
suffix:semicolon
id|PRINT_TOKENS
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;hsqdioac&quot;
)paren
suffix:semicolon
id|result
op_assign
id|qeth_qdio_activate
c_func
(paren
id|card
)paren
suffix:semicolon
id|CHECK_ERRORS
suffix:semicolon
id|PRINT_TOKENS
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;hsdmact&quot;
)paren
suffix:semicolon
id|result
op_assign
id|qeth_dm_act
c_func
(paren
id|card
)paren
suffix:semicolon
id|CHECK_ERRORS
suffix:semicolon
)brace
r_while
c_loop
(paren
(paren
id|laps
op_decrement
)paren
op_logical_and
(paren
id|breakout
op_eq
id|QETH_BREAKOUT_AGAIN
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|breakout
op_eq
id|QETH_BREAKOUT_AGAIN
)paren
(brace
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;hsnr&quot;
comma
id|card
)paren
suffix:semicolon
id|PRINT_ERR
c_func
(paren
l_string|&quot;qeth: recovery not successful on device &quot;
l_string|&quot;%s/%s/%s; giving up.&bslash;n&quot;
comma
id|CARD_RDEV_ID
c_func
(paren
id|card
)paren
comma
id|CARD_WDEV_ID
c_func
(paren
id|card
)paren
comma
id|CARD_DDEV_ID
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
id|result
op_assign
op_minus
id|EIO
suffix:semicolon
r_goto
m_exit
suffix:semicolon
)brace
id|qeth_clear_ifa4_list
c_func
(paren
op_amp
id|card-&gt;ip_current_state.ip_ifa
)paren
suffix:semicolon
id|qeth_clear_ifa4_list
c_func
(paren
op_amp
id|card-&gt;ip_new_state.ip_ifa
)paren
suffix:semicolon
id|qeth_clear_ifamc_list
c_func
(paren
op_amp
id|card-&gt;ip_mc_current_state.ipm_ifa
)paren
suffix:semicolon
id|qeth_clear_ifamc_list
c_func
(paren
op_amp
id|card-&gt;ip_mc_new_state.ipm_ifa
)paren
suffix:semicolon
macro_line|#ifdef QETH_IPV6
id|qeth_clear_ifa6_list
c_func
(paren
op_amp
id|card-&gt;ip_current_state.ip6_ifa
)paren
suffix:semicolon
id|qeth_clear_ifa6_list
c_func
(paren
op_amp
id|card-&gt;ip_new_state.ip6_ifa
)paren
suffix:semicolon
id|qeth_clear_ifamc_list
c_func
(paren
op_amp
id|card-&gt;ip_mc_current_state.ipm6_ifa
)paren
suffix:semicolon
id|qeth_clear_ifamc_list
c_func
(paren
op_amp
id|card-&gt;ip_mc_new_state.ipm6_ifa
)paren
suffix:semicolon
macro_line|#endif /* QETH_IPV6 */
r_if
c_cond
(paren
op_logical_neg
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_registered
)paren
)paren
(brace
id|card-&gt;dev-&gt;dev_addr
(braket
l_int|0
)braket
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* we don&squot;t know the mac addr yet */
id|card-&gt;dev-&gt;dev_addr
(braket
l_int|1
)braket
op_assign
l_int|0
suffix:semicolon
id|card-&gt;dev-&gt;dev_addr
(braket
l_int|2
)braket
op_assign
l_int|0
suffix:semicolon
id|card-&gt;dev-&gt;dev_addr
(braket
l_int|3
)braket
op_assign
l_int|0
suffix:semicolon
id|card-&gt;dev-&gt;dev_addr
(braket
l_int|4
)braket
op_assign
l_int|0
suffix:semicolon
id|card-&gt;dev-&gt;dev_addr
(braket
l_int|5
)braket
op_assign
l_int|0
suffix:semicolon
id|card-&gt;dev-&gt;broadcast
(braket
l_int|0
)braket
op_assign
id|card-&gt;dev-&gt;broadcast
(braket
l_int|1
)braket
op_assign
l_int|0xff
suffix:semicolon
id|card-&gt;dev-&gt;broadcast
(braket
l_int|2
)braket
op_assign
id|card-&gt;dev-&gt;broadcast
(braket
l_int|3
)braket
op_assign
l_int|0xff
suffix:semicolon
id|card-&gt;dev-&gt;broadcast
(braket
l_int|4
)braket
op_assign
id|card-&gt;dev-&gt;broadcast
(braket
l_int|5
)braket
op_assign
l_int|0xff
suffix:semicolon
id|card-&gt;dev-&gt;type
op_assign
id|qeth_get_arphrd_type
c_func
(paren
id|card-&gt;type
comma
id|card-&gt;link_type
)paren
suffix:semicolon
id|card-&gt;dev-&gt;init
op_assign
id|qeth_init_dev
suffix:semicolon
id|card-&gt;ipa_timeout
op_assign
id|qeth_get_ipa_timeout
c_func
(paren
id|card-&gt;type
)paren
suffix:semicolon
)brace
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;is_hardsetup
comma
l_int|1
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;is_softsetup
comma
l_int|0
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;startlan_attempts
comma
l_int|1
)paren
suffix:semicolon
r_for
c_loop
(paren
id|q
op_assign
l_int|0
suffix:semicolon
id|q
OL
id|card-&gt;no_queues
suffix:semicolon
id|q
op_increment
)paren
id|card-&gt;send_state
(braket
id|q
)braket
op_assign
id|SEND_STATE_DONT_PACK
suffix:semicolon
multiline_comment|/* we need to know first, whether we should include a value&n;&t; * into eui-64 address generation */
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;qipassi4&quot;
)paren
suffix:semicolon
id|r
op_assign
id|qeth_send_qipassist
c_func
(paren
id|card
comma
l_int|4
)paren
suffix:semicolon
r_if
c_cond
(paren
id|r
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;couldn&squot;t send QIPASSIST4 on %s: &quot;
l_string|&quot;0x%x&bslash;n&quot;
comma
id|card-&gt;dev_name
comma
id|r
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;QIP4%4x&quot;
comma
id|r
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
)brace
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%4x%4x&quot;
comma
id|card-&gt;ipa_supported
comma
id|card-&gt;ipa_enabled
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|qeth_get_unique_id
c_func
(paren
id|card
)paren
suffix:semicolon
multiline_comment|/* print out status */
r_if
c_cond
(paren
id|in_recovery
)paren
(brace
id|qeth_clear_card_structures
c_func
(paren
id|card
)paren
suffix:semicolon
id|qeth_init_input_buffers
c_func
(paren
id|card
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;RECOVSUC&quot;
)paren
suffix:semicolon
id|PRINT_INFO
c_func
(paren
l_string|&quot;qeth: recovered device %s/%s/%s (%s) &quot;
l_string|&quot;successfully.&bslash;n&quot;
comma
id|CARD_RDEV_ID
c_func
(paren
id|card
)paren
comma
id|CARD_WDEV_ID
c_func
(paren
id|card
)paren
comma
id|CARD_DDEV_ID
c_func
(paren
id|card
)paren
comma
id|card-&gt;dev_name
)paren
suffix:semicolon
)brace
r_else
(brace
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;hrdsetok&quot;
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|card-&gt;type
)paren
(brace
r_case
id|QETH_CARD_TYPE_OSAE
suffix:colon
multiline_comment|/* &n;&t;&t;&t; * VM will use a non-zero first character to indicate&n;&t;&t;&t; * a HiperSockets like reporting of the level&n;&t;&t;&t; * OSA sets the first character to zero&n;&t;&t;&t; */
r_if
c_cond
(paren
op_logical_neg
id|card-&gt;level
(braket
l_int|0
)braket
)paren
(brace
id|sprintf
c_func
(paren
id|card-&gt;level
comma
l_string|&quot;%02x%02x&quot;
comma
id|card-&gt;level
(braket
l_int|2
)braket
comma
id|card-&gt;level
(braket
l_int|3
)braket
)paren
suffix:semicolon
id|card-&gt;level
(braket
id|QETH_MCL_LENGTH
)braket
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
)brace
multiline_comment|/* fallthrough */
r_case
id|QETH_CARD_TYPE_IQD
suffix:colon
id|card-&gt;level
(braket
l_int|0
)braket
op_assign
(paren
r_char
)paren
id|_ebcasc
(braket
(paren
id|__u8
)paren
id|card-&gt;level
(braket
l_int|0
)braket
)braket
suffix:semicolon
id|card-&gt;level
(braket
l_int|1
)braket
op_assign
(paren
r_char
)paren
id|_ebcasc
(braket
(paren
id|__u8
)paren
id|card-&gt;level
(braket
l_int|1
)braket
)braket
suffix:semicolon
id|card-&gt;level
(braket
l_int|2
)braket
op_assign
(paren
r_char
)paren
id|_ebcasc
(braket
(paren
id|__u8
)paren
id|card-&gt;level
(braket
l_int|2
)braket
)braket
suffix:semicolon
id|card-&gt;level
(braket
l_int|3
)braket
op_assign
(paren
r_char
)paren
id|_ebcasc
(braket
(paren
id|__u8
)paren
id|card-&gt;level
(braket
l_int|3
)braket
)braket
suffix:semicolon
id|card-&gt;level
(braket
id|QETH_MCL_LENGTH
)braket
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|memset
c_func
(paren
op_amp
id|card-&gt;level
(braket
l_int|0
)braket
comma
l_int|0
comma
id|QETH_MCL_LENGTH
op_plus
l_int|1
)paren
suffix:semicolon
)brace
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;lvl:%s&quot;
comma
id|card-&gt;level
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|setup
comma
id|dbf_text
)paren
suffix:semicolon
r_if
c_cond
(paren
id|card-&gt;portname_required
)paren
(brace
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%s&quot;
comma
id|card-&gt;options.portname
op_plus
l_int|1
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|8
suffix:semicolon
id|i
op_increment
)paren
id|dbf_text
(braket
id|i
)braket
op_assign
(paren
r_char
)paren
id|_ebcasc
(braket
(paren
id|__u8
)paren
id|dbf_text
(braket
id|i
)braket
)braket
suffix:semicolon
id|dbf_text
(braket
l_int|8
)braket
op_assign
l_int|0
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;qeth: Device %s/%s/%s is a%s card%s%s%s&bslash;n&quot;
l_string|&quot;with link type %s (portname: %s)&bslash;n&quot;
comma
id|CARD_RDEV_ID
c_func
(paren
id|card
)paren
comma
id|CARD_WDEV_ID
c_func
(paren
id|card
)paren
comma
id|CARD_DDEV_ID
c_func
(paren
id|card
)paren
comma
id|qeth_get_cardname
c_func
(paren
id|card-&gt;type
comma
id|card-&gt;is_guest_lan
)paren
comma
(paren
id|card-&gt;level
(braket
l_int|0
)braket
)paren
ques
c_cond
l_string|&quot; (level: &quot;
suffix:colon
l_string|&quot;&quot;
comma
(paren
id|card-&gt;level
(braket
l_int|0
)braket
)paren
ques
c_cond
id|card-&gt;level
suffix:colon
l_string|&quot;&quot;
comma
(paren
id|card-&gt;level
(braket
l_int|0
)braket
)paren
ques
c_cond
l_string|&quot;)&quot;
suffix:colon
l_string|&quot;&quot;
comma
id|qeth_get_link_type_name
c_func
(paren
id|card-&gt;type
comma
id|card-&gt;link_type
)paren
comma
id|dbf_text
)paren
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|card-&gt;options.portname
(braket
l_int|0
)braket
)paren
id|printk
c_func
(paren
l_string|&quot;qeth: Device %s/%s/%s is a%s &quot;
l_string|&quot;card%s%s%s&bslash;nwith link type %s &quot;
l_string|&quot;(no portname needed by interface).&bslash;n&quot;
comma
id|CARD_RDEV_ID
c_func
(paren
id|card
)paren
comma
id|CARD_WDEV_ID
c_func
(paren
id|card
)paren
comma
id|CARD_DDEV_ID
c_func
(paren
id|card
)paren
comma
id|qeth_get_cardname
c_func
(paren
id|card-&gt;type
comma
id|card-&gt;is_guest_lan
)paren
comma
(paren
id|card-&gt;level
(braket
l_int|0
)braket
)paren
ques
c_cond
l_string|&quot; (level: &quot;
suffix:colon
l_string|&quot;&quot;
comma
(paren
id|card-&gt;level
(braket
l_int|0
)braket
)paren
ques
c_cond
id|card-&gt;level
suffix:colon
l_string|&quot;&quot;
comma
(paren
id|card-&gt;level
(braket
l_int|0
)braket
)paren
ques
c_cond
l_string|&quot;)&quot;
suffix:colon
l_string|&quot;&quot;
comma
id|qeth_get_link_type_name
c_func
(paren
id|card-&gt;type
comma
id|card-&gt;link_type
)paren
)paren
suffix:semicolon
r_else
id|printk
c_func
(paren
l_string|&quot;qeth: Device %s/%s/%s is a%s &quot;
l_string|&quot;card%s%s%s&bslash;nwith link type %s.&bslash;n&quot;
comma
id|CARD_RDEV_ID
c_func
(paren
id|card
)paren
comma
id|CARD_WDEV_ID
c_func
(paren
id|card
)paren
comma
id|CARD_DDEV_ID
c_func
(paren
id|card
)paren
comma
id|qeth_get_cardname
c_func
(paren
id|card-&gt;type
comma
id|card-&gt;is_guest_lan
)paren
comma
(paren
id|card-&gt;level
(braket
l_int|0
)braket
)paren
ques
c_cond
l_string|&quot; (level: &quot;
suffix:colon
l_string|&quot;&quot;
comma
(paren
id|card-&gt;level
(braket
l_int|0
)braket
)paren
ques
c_cond
id|card-&gt;level
suffix:colon
l_string|&quot;&quot;
comma
(paren
id|card-&gt;level
(braket
l_int|0
)braket
)paren
ques
c_cond
l_string|&quot;)&quot;
suffix:colon
l_string|&quot;&quot;
comma
id|qeth_get_link_type_name
c_func
(paren
id|card-&gt;type
comma
id|card-&gt;link_type
)paren
)paren
suffix:semicolon
)brace
)brace
m_exit
suffix:colon
id|up
c_func
(paren
op_amp
id|card-&gt;hardsetup_sema
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_reinit_thread
id|qeth_reinit_thread
c_func
(paren
r_void
op_star
id|param
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
(paren
r_struct
id|qeth_card
op_star
)paren
id|param
suffix:semicolon
r_int
id|already_registered
suffix:semicolon
r_int
id|already_hardsetup
suffix:semicolon
r_int
id|retry
op_assign
id|QETH_RECOVERY_HARDSETUP_RETRY
suffix:semicolon
r_int
id|result
suffix:semicolon
r_char
id|name
(braket
l_int|15
)braket
suffix:semicolon
id|QETH_DBF_CARD1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;RINI&quot;
comma
id|card
)paren
suffix:semicolon
multiline_comment|/* set a nice name ... */
id|sprintf
c_func
(paren
id|name
comma
l_string|&quot;qethrinid%s&quot;
comma
id|CARD_BUS_ID
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
id|daemonize
c_func
(paren
id|name
)paren
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;shutdown_phase
)paren
)paren
r_goto
id|out_wakeup
suffix:semicolon
id|down_interruptible
c_func
(paren
op_amp
id|card-&gt;reinit_thread_sem
)paren
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;shutdown_phase
)paren
)paren
r_goto
id|out_wakeup
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;ri-gotin&quot;
)paren
suffix:semicolon
id|PRINT_STUPID
c_func
(paren
l_string|&quot;entering recovery (reinit) thread for device %s&bslash;n&quot;
comma
id|card-&gt;dev_name
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;is_startlaned
comma
l_int|0
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;is_softsetup
comma
l_int|0
)paren
suffix:semicolon
id|read_lock
c_func
(paren
op_amp
id|list_lock
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|qeth_verify_card
c_func
(paren
id|card
)paren
)paren
r_goto
id|out
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;ri-vrfd&quot;
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;write_busy
comma
l_int|0
)paren
suffix:semicolon
id|qeth_set_dev_flag_norunning
c_func
(paren
id|card
)paren
suffix:semicolon
id|already_hardsetup
op_assign
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_hardsetup
)paren
suffix:semicolon
id|already_registered
op_assign
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_registered
)paren
suffix:semicolon
r_if
c_cond
(paren
id|already_hardsetup
)paren
(brace
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;is_hardsetup
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
op_minus
l_int|1
op_eq
id|my_spin_lock_nonbusy
c_func
(paren
id|card
comma
op_amp
id|setup_lock
)paren
)paren
r_goto
id|out
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;shutdown_phase
)paren
)paren
r_goto
id|out_wakeup
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;escape_softsetup
comma
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
op_minus
l_int|1
op_eq
id|my_down_trylock_nonbusy
c_func
(paren
id|card
comma
op_amp
id|card-&gt;softsetup_sema
)paren
)paren
(brace
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;escape_softsetup
comma
l_int|0
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;escape_softsetup
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;shutdown_phase
)paren
)paren
(brace
id|up
c_func
(paren
op_amp
id|card-&gt;softsetup_sema
)paren
suffix:semicolon
r_goto
id|out_wakeup
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|qeth_verify_card
c_func
(paren
id|card
)paren
)paren
r_goto
id|out
suffix:semicolon
r_if
c_cond
(paren
id|already_registered
)paren
id|netif_stop_queue
c_func
(paren
id|card-&gt;dev
)paren
suffix:semicolon
id|qeth_wait_nonbusy
c_func
(paren
id|QETH_QUIESCE_NETDEV_TIME
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;is_startlaned
comma
l_int|0
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;ri-frskb&quot;
)paren
suffix:semicolon
id|qeth_free_all_skbs
c_func
(paren
id|card
)paren
suffix:semicolon
r_do
(brace
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;ri-hrdst&quot;
)paren
suffix:semicolon
id|result
op_assign
id|qeth_hardsetup_card
c_func
(paren
id|card
comma
l_int|1
)paren
suffix:semicolon
)brace
r_while
c_loop
(paren
id|result
op_logical_and
(paren
id|retry
op_decrement
)paren
)paren
suffix:semicolon
multiline_comment|/* tries to remove old ips, that&squot;s paranoid, but ok */
id|qeth_clear_ifa4_list
c_func
(paren
op_amp
id|card-&gt;ip_new_state.ip_ifa
)paren
suffix:semicolon
id|qeth_clear_ifamc_list
c_func
(paren
op_amp
id|card-&gt;ip_mc_new_state.ipm_ifa
)paren
suffix:semicolon
macro_line|#ifdef QETH_IPV6
id|qeth_clear_ifa6_list
c_func
(paren
op_amp
id|card-&gt;ip_new_state.ip6_ifa
)paren
suffix:semicolon
id|qeth_clear_ifamc_list
c_func
(paren
op_amp
id|card-&gt;ip_mc_new_state.ipm6_ifa
)paren
suffix:semicolon
macro_line|#endif /* QETH_IPV6 */
r_if
c_cond
(paren
id|result
)paren
(brace
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;ri-nosuc&quot;
)paren
suffix:semicolon
id|PRINT_ERR
c_func
(paren
l_string|&quot;qeth: RECOVERY WAS NOT SUCCESSFUL ON %s &quot;
l_string|&quot;(%s/%s/%s), GIVING UP, &quot;
l_string|&quot;OUTGOING PACKETS WILL BE DISCARDED!&bslash;n&quot;
comma
id|card-&gt;dev_name
comma
id|CARD_RDEV_ID
c_func
(paren
id|card
)paren
comma
id|CARD_WDEV_ID
c_func
(paren
id|card
)paren
comma
id|CARD_DDEV_ID
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
multiline_comment|/* early leave hard_start_xmit! */
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;is_startlaned
comma
l_int|0
)paren
suffix:semicolon
id|qeth_wakeup_procfile
c_func
(paren
)paren
suffix:semicolon
)brace
r_else
(brace
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;ri-sftst&quot;
)paren
suffix:semicolon
id|qeth_softsetup_card
c_func
(paren
id|card
comma
id|QETH_LOCK_ALREADY_HELD
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|card-&gt;softsetup_sema
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|already_registered
)paren
(brace
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;ri-regcd&quot;
)paren
suffix:semicolon
id|qeth_register_netdev
c_func
(paren
id|card
)paren
suffix:semicolon
)brace
id|qeth_restore_dev_flag_state
c_func
(paren
id|card
)paren
suffix:semicolon
id|netif_wake_queue
c_func
(paren
id|card-&gt;dev
)paren
suffix:semicolon
id|qeth_wakeup_procfile
c_func
(paren
)paren
suffix:semicolon
)brace
id|spin_unlock
c_func
(paren
op_amp
id|setup_lock
)paren
suffix:semicolon
)brace
id|out
suffix:colon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;in_recovery
comma
l_int|0
)paren
suffix:semicolon
id|read_unlock
c_func
(paren
op_amp
id|list_lock
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;ri-leave&quot;
)paren
suffix:semicolon
id|out_wakeup
suffix:colon
id|up
c_func
(paren
op_amp
id|card-&gt;reinit_thread_sem
)paren
suffix:semicolon
id|atomic_dec
c_func
(paren
op_amp
id|card-&gt;reinit_counter
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_fill_qeth_card_options
id|qeth_fill_qeth_card_options
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_int
id|i
suffix:semicolon
id|card-&gt;options.portname
(braket
l_int|0
)braket
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|1
suffix:semicolon
id|i
OL
l_int|9
suffix:semicolon
id|i
op_increment
)paren
id|card-&gt;options.portname
(braket
id|i
)braket
op_assign
id|_ascebc
(braket
l_char|&squot; &squot;
)braket
suffix:semicolon
id|strcpy
c_func
(paren
id|card-&gt;options.devname
comma
l_string|&quot; &quot;
)paren
suffix:semicolon
id|card-&gt;options.routing_type4
op_assign
id|NO_ROUTER
suffix:semicolon
macro_line|#ifdef QETH_IPV6
id|card-&gt;options.routing_type6
op_assign
id|NO_ROUTER
suffix:semicolon
macro_line|#endif /* QETH_IPV6 */
id|card-&gt;options.portno
op_assign
l_int|0
suffix:semicolon
id|card-&gt;options.checksum_type
op_assign
id|QETH_CHECKSUM_DEFAULT
suffix:semicolon
id|card-&gt;options.do_prio_queueing
op_assign
id|QETH_PRIOQ_DEFAULT
suffix:semicolon
id|card-&gt;options.default_queue
op_assign
id|QETH_DEFAULT_QUEUE
suffix:semicolon
id|card-&gt;options.inbound_buffer_count
op_assign
id|DEFAULT_BUFFER_COUNT
suffix:semicolon
id|card-&gt;options.polltime
op_assign
id|QETH_MAX_INPUT_THRESHOLD
suffix:semicolon
id|card-&gt;options.macaddr_mode
op_assign
id|MACADDR_NONCANONICAL
suffix:semicolon
id|card-&gt;options.broadcast_mode
op_assign
id|BROADCAST_ALLRINGS
suffix:semicolon
id|card-&gt;options.fake_broadcast
op_assign
id|DONT_FAKE_BROADCAST
suffix:semicolon
id|card-&gt;options.ena_ipat
op_assign
id|ENABLE_TAKEOVER
suffix:semicolon
id|card-&gt;options.add_hhlen
op_assign
id|DEFAULT_ADD_HHLEN
suffix:semicolon
id|card-&gt;options.fake_ll
op_assign
id|DONT_FAKE_LL
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_alloc_card_stuff
id|qeth_alloc_card_stuff
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;alccrdst&quot;
)paren
suffix:semicolon
id|card-&gt;dma_stuff
op_assign
(paren
r_struct
id|qeth_dma_stuff
op_star
)paren
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|qeth_dma_stuff
)paren
comma
id|GFP_KERNEL
op_or
id|GFP_DMA
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card-&gt;dma_stuff
)paren
r_goto
id|exit_dma
suffix:semicolon
id|memset
c_func
(paren
id|card-&gt;dma_stuff
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|qeth_dma_stuff
)paren
)paren
suffix:semicolon
id|card-&gt;dma_stuff-&gt;recbuf
op_assign
(paren
r_char
op_star
)paren
id|kmalloc
c_func
(paren
id|QETH_BUFSIZE
comma
id|GFP_KERNEL
op_or
id|GFP_DMA
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card-&gt;dma_stuff-&gt;recbuf
)paren
r_goto
id|exit_dma1
suffix:semicolon
id|memset
c_func
(paren
id|card-&gt;dma_stuff-&gt;recbuf
comma
l_int|0
comma
id|QETH_BUFSIZE
)paren
suffix:semicolon
id|card-&gt;dma_stuff-&gt;sendbuf
op_assign
(paren
r_char
op_star
)paren
id|kmalloc
c_func
(paren
id|QETH_BUFSIZE
comma
id|GFP_KERNEL
op_or
id|GFP_DMA
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card-&gt;dma_stuff-&gt;sendbuf
)paren
r_goto
id|exit_dma2
suffix:semicolon
id|memset
c_func
(paren
id|card-&gt;dma_stuff-&gt;sendbuf
comma
l_int|0
comma
id|QETH_BUFSIZE
)paren
suffix:semicolon
id|card-&gt;dev
op_assign
(paren
r_struct
id|net_device
op_star
)paren
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|net_device
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card-&gt;dev
)paren
r_goto
id|exit_dev
suffix:semicolon
id|memset
c_func
(paren
id|card-&gt;dev
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|net_device
)paren
)paren
suffix:semicolon
id|card-&gt;stats
op_assign
(paren
r_struct
id|net_device_stats
op_star
)paren
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|net_device_stats
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card-&gt;stats
)paren
r_goto
id|exit_stats
suffix:semicolon
id|memset
c_func
(paren
id|card-&gt;stats
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|net_device_stats
)paren
)paren
suffix:semicolon
multiline_comment|/* setup net_device stuff */
id|card-&gt;dev-&gt;priv
op_assign
id|card
suffix:semicolon
multiline_comment|/* setup net_device_stats stuff */
multiline_comment|/* =nothing yet */
r_return
l_int|0
suffix:semicolon
multiline_comment|/* these are quick exits in case of failures of the kmallocs */
id|exit_stats
suffix:colon
id|free_netdev
c_func
(paren
id|card-&gt;dev
)paren
suffix:semicolon
id|exit_dev
suffix:colon
id|kfree
c_func
(paren
id|card-&gt;dma_stuff-&gt;sendbuf
)paren
suffix:semicolon
id|exit_dma2
suffix:colon
id|kfree
c_func
(paren
id|card-&gt;dma_stuff-&gt;recbuf
)paren
suffix:semicolon
id|exit_dma1
suffix:colon
id|kfree
c_func
(paren
id|card-&gt;dma_stuff
)paren
suffix:semicolon
id|exit_dma
suffix:colon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
r_static
r_struct
id|qeth_card
op_star
DECL|function|qeth_alloc_card
id|qeth_alloc_card
c_func
(paren
r_void
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;alloccrd&quot;
)paren
suffix:semicolon
id|card
op_assign
(paren
r_struct
id|qeth_card
op_star
)paren
id|vmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|qeth_card
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
l_int|NULL
suffix:semicolon
id|memset
c_func
(paren
id|card
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|qeth_card
)paren
)paren
suffix:semicolon
id|init_waitqueue_head
c_func
(paren
op_amp
id|card-&gt;wait_q
)paren
suffix:semicolon
id|init_waitqueue_head
c_func
(paren
op_amp
id|card-&gt;ioctl_wait_q
)paren
suffix:semicolon
id|qeth_fill_qeth_card_options
c_func
(paren
id|card
)paren
suffix:semicolon
id|init_MUTEX
c_func
(paren
op_amp
id|card-&gt;softsetup_sema
)paren
suffix:semicolon
id|init_MUTEX
c_func
(paren
op_amp
id|card-&gt;hardsetup_sema
)paren
suffix:semicolon
id|spin_lock_init
c_func
(paren
op_amp
id|card-&gt;ioctl_lock
)paren
suffix:semicolon
macro_line|#ifdef QETH_VLAN
id|spin_lock_init
c_func
(paren
op_amp
id|card-&gt;vlan_lock
)paren
suffix:semicolon
id|card-&gt;vlangrp
op_assign
l_int|NULL
suffix:semicolon
macro_line|#endif
id|card-&gt;unique_id
op_assign
l_int|0
suffix:semicolon
id|sema_init
c_func
(paren
op_amp
id|card-&gt;reinit_thread_sem
comma
l_int|0
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|card-&gt;reinit_thread_sem
)paren
suffix:semicolon
multiline_comment|/* setup card stuff */
id|card-&gt;ip_current_state.ip_ifa
op_assign
l_int|NULL
suffix:semicolon
id|card-&gt;ip_new_state.ip_ifa
op_assign
l_int|NULL
suffix:semicolon
id|card-&gt;ip_mc_current_state.ipm_ifa
op_assign
l_int|NULL
suffix:semicolon
id|card-&gt;ip_mc_new_state.ipm_ifa
op_assign
l_int|NULL
suffix:semicolon
macro_line|#ifdef QETH_IPV6
id|card-&gt;ip_current_state.ip6_ifa
op_assign
l_int|NULL
suffix:semicolon
id|card-&gt;ip_new_state.ip6_ifa
op_assign
l_int|NULL
suffix:semicolon
id|card-&gt;ip_mc_current_state.ipm6_ifa
op_assign
l_int|NULL
suffix:semicolon
id|card-&gt;ip_mc_new_state.ipm6_ifa
op_assign
l_int|NULL
suffix:semicolon
macro_line|#endif /* QETH_IPV6 */
id|card-&gt;csum_enable_mask
op_assign
id|IPA_CHECKSUM_DEFAULT_ENABLE_MASK
suffix:semicolon
multiline_comment|/* and return to the sender */
r_return
id|card
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_init_ringbuffers1
id|qeth_init_ringbuffers1
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_int
id|i
comma
id|j
suffix:semicolon
id|QETH_DBF_CARD3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;irb1&quot;
comma
id|card
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|card-&gt;no_queues
suffix:semicolon
id|i
op_increment
)paren
(brace
id|card-&gt;outbound_ringbuffer
(braket
id|i
)braket
op_assign
id|vmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|qeth_ringbuffer
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card-&gt;outbound_ringbuffer
(braket
id|i
)braket
)paren
(brace
r_for
c_loop
(paren
id|j
op_assign
id|i
op_minus
l_int|1
suffix:semicolon
id|j
op_ge
l_int|0
suffix:semicolon
id|j
op_decrement
)paren
(brace
id|vfree
c_func
(paren
id|card-&gt;outbound_ringbuffer
(braket
id|j
)braket
)paren
suffix:semicolon
id|card-&gt;outbound_ringbuffer
(braket
id|j
)braket
op_assign
l_int|NULL
suffix:semicolon
)brace
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|memset
c_func
(paren
id|card-&gt;outbound_ringbuffer
(braket
id|i
)braket
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|qeth_ringbuffer
)paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
id|QDIO_MAX_BUFFERS_PER_Q
suffix:semicolon
id|j
op_increment
)paren
id|skb_queue_head_init
c_func
(paren
op_amp
id|card-&gt;outbound_ringbuffer
(braket
id|i
)braket
op_member_access_from_pointer
id|ringbuf_element
(braket
id|j
)braket
dot
id|skb_list
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_init_ringbuffers2
id|qeth_init_ringbuffers2
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_int
id|i
comma
id|j
suffix:semicolon
id|QETH_DBF_CARD3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;irb2&quot;
comma
id|card
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|card-&gt;options.inbound_buffer_count
suffix:semicolon
id|i
op_increment
)paren
(brace
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
id|BUFFER_MAX_ELEMENTS
suffix:semicolon
id|j
op_increment
)paren
(brace
id|card-&gt;inbound_buffer_pool_entry
(braket
id|i
)braket
(braket
id|j
)braket
op_assign
id|kmalloc
c_func
(paren
id|PAGE_SIZE
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card-&gt;inbound_buffer_pool_entry
(braket
id|i
)braket
(braket
id|j
)braket
)paren
(brace
r_goto
id|out
suffix:semicolon
)brace
)brace
id|card-&gt;inbound_buffer_pool_entry_used
(braket
id|i
)braket
op_assign
id|BUFFER_UNUSED
suffix:semicolon
)brace
id|spin_lock_init
c_func
(paren
op_amp
id|card-&gt;requeue_input_lock
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
id|out
suffix:colon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|card-&gt;options.inbound_buffer_count
suffix:semicolon
id|i
op_increment
)paren
(brace
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
id|QDIO_MAX_ELEMENTS_PER_BUFFER
suffix:semicolon
id|j
op_increment
)paren
(brace
r_if
c_cond
(paren
id|card-&gt;inbound_buffer_pool_entry
(braket
id|i
)braket
(braket
id|j
)braket
)paren
(brace
r_if
c_cond
(paren
id|j
OL
id|BUFFER_MAX_ELEMENTS
)paren
id|kfree
c_func
(paren
id|card
op_member_access_from_pointer
id|inbound_buffer_pool_entry
(braket
id|i
)braket
(braket
id|j
)braket
)paren
suffix:semicolon
id|card-&gt;inbound_buffer_pool_entry
(braket
id|i
)braket
(braket
id|j
)braket
op_assign
l_int|NULL
suffix:semicolon
)brace
)brace
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|card-&gt;no_queues
suffix:semicolon
id|i
op_increment
)paren
(brace
id|vfree
c_func
(paren
id|card-&gt;outbound_ringbuffer
(braket
id|i
)braket
)paren
suffix:semicolon
id|card-&gt;outbound_ringbuffer
(braket
id|i
)braket
op_assign
l_int|NULL
suffix:semicolon
)brace
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
multiline_comment|/* also locked from outside (setup_lock) */
r_static
r_void
DECL|function|qeth_insert_card_into_list
id|qeth_insert_card_into_list
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
id|QETH_DBF_CARD3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;icil&quot;
comma
id|card
)paren
suffix:semicolon
id|write_lock
c_func
(paren
op_amp
id|list_lock
)paren
suffix:semicolon
id|card-&gt;next
op_assign
id|firstcard
suffix:semicolon
id|firstcard
op_assign
id|card
suffix:semicolon
id|write_unlock
c_func
(paren
op_amp
id|list_lock
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_determine_card_type
id|qeth_determine_card_type
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_int
id|i
op_assign
l_int|0
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
r_while
c_loop
(paren
id|known_devices
(braket
id|i
)braket
(braket
l_int|4
)braket
)paren
(brace
r_if
c_cond
(paren
(paren
id|CARD_RDEV
c_func
(paren
id|card
)paren
op_member_access_from_pointer
id|id.dev_type
op_eq
id|known_devices
(braket
id|i
)braket
(braket
l_int|2
)braket
)paren
op_logical_and
(paren
id|CARD_RDEV
c_func
(paren
id|card
)paren
op_member_access_from_pointer
id|id.dev_model
op_eq
id|known_devices
(braket
id|i
)braket
(braket
l_int|3
)braket
)paren
)paren
(brace
id|card-&gt;type
op_assign
id|known_devices
(braket
id|i
)braket
(braket
l_int|4
)braket
suffix:semicolon
r_if
c_cond
(paren
id|card-&gt;options.ena_ipat
op_eq
id|ENABLE_TAKEOVER
)paren
id|card-&gt;func_level
op_assign
id|known_devices
(braket
id|i
)braket
(braket
l_int|6
)braket
suffix:semicolon
r_else
id|card-&gt;func_level
op_assign
id|known_devices
(braket
id|i
)braket
(braket
l_int|7
)braket
suffix:semicolon
id|card-&gt;no_queues
op_assign
id|known_devices
(braket
id|i
)braket
(braket
l_int|8
)braket
suffix:semicolon
id|card-&gt;is_multicast_different
op_assign
id|known_devices
(braket
id|i
)braket
(braket
l_int|9
)braket
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|setup
comma
id|CARD_BUS_ID
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;ctyp%4x&quot;
comma
id|card-&gt;type
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|setup
comma
id|dbf_text
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|i
op_increment
suffix:semicolon
)brace
id|card-&gt;type
op_assign
id|QETH_CARD_TYPE_UNKNOWN
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|setup
comma
id|CARD_BUS_ID
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;ctypUNKN&quot;
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|setup
comma
id|dbf_text
)paren
suffix:semicolon
id|PRINT_ERR
c_func
(paren
l_string|&quot;unknown card type on device %s&bslash;n&quot;
comma
id|CARD_BUS_ID
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
r_return
op_minus
id|ENOENT
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_getint
id|qeth_getint
c_func
(paren
r_char
op_star
id|s
comma
r_int
id|longint
)paren
(brace
r_int
id|cnt
suffix:semicolon
r_int
id|hex
suffix:semicolon
r_int
id|result
suffix:semicolon
r_char
id|c
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|s
)paren
r_return
op_minus
l_int|1
suffix:semicolon
id|hex
op_assign
(paren
(paren
id|s
(braket
l_int|0
)braket
op_eq
l_char|&squot;0&squot;
)paren
op_logical_and
(paren
(paren
id|s
(braket
l_int|1
)braket
op_eq
l_char|&squot;x&squot;
)paren
op_logical_or
(paren
id|s
(braket
l_int|1
)braket
op_eq
l_char|&squot;X&squot;
)paren
)paren
)paren
ques
c_cond
l_int|1
suffix:colon
l_int|0
suffix:semicolon
id|cnt
op_assign
(paren
id|hex
)paren
ques
c_cond
l_int|2
suffix:colon
l_int|0
suffix:semicolon
multiline_comment|/* start from the first real digit */
r_if
c_cond
(paren
op_logical_neg
(paren
id|s
(braket
id|cnt
)braket
)paren
)paren
r_return
op_minus
l_int|1
suffix:semicolon
id|result
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
(paren
id|c
op_assign
id|s
(braket
id|cnt
op_increment
)braket
)paren
)paren
(brace
r_if
c_cond
(paren
id|hex
)paren
(brace
r_if
c_cond
(paren
id|isxdigit
c_func
(paren
id|c
)paren
)paren
id|result
op_assign
id|result
op_star
l_int|16
op_plus
id|qeth_getxdigit
c_func
(paren
id|c
)paren
suffix:semicolon
r_else
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|isdigit
c_func
(paren
id|c
)paren
)paren
id|result
op_assign
id|result
op_star
l_int|10
op_plus
id|c
op_minus
l_char|&squot;0&squot;
suffix:semicolon
r_else
r_return
op_minus
l_int|1
suffix:semicolon
)brace
multiline_comment|/* prevent overflow, 0xffff is enough for us */
r_if
c_cond
(paren
id|longint
)paren
(brace
r_if
c_cond
(paren
id|result
OG
l_int|0xfffffff
)paren
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|result
OG
l_int|0xffff
)paren
r_return
op_minus
l_int|1
suffix:semicolon
)brace
)brace
r_return
id|result
suffix:semicolon
)brace
r_static
r_void
DECL|function|__qeth_correct_routing_status_v4
id|__qeth_correct_routing_status_v4
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_if
c_cond
(paren
id|card-&gt;options.routing_type4
op_eq
id|NO_ROUTER
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|card-&gt;type
op_eq
id|QETH_CARD_TYPE_IQD
)paren
(brace
multiline_comment|/* if it&squot;s not a mc router, it&squot;s no router */
r_if
c_cond
(paren
(paren
id|card-&gt;options.routing_type4
op_eq
id|PRIMARY_ROUTER
)paren
op_logical_or
(paren
id|card-&gt;options.routing_type4
op_eq
id|SECONDARY_ROUTER
)paren
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;routing not applicable, reset &quot;
l_string|&quot;routing status for ipv4. &bslash;n&quot;
)paren
suffix:semicolon
id|card-&gt;options.routing_type4
op_assign
id|NO_ROUTER
suffix:semicolon
)brace
id|card-&gt;options.do_prio_queueing
op_assign
id|NO_PRIO_QUEUEING
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* if it&squot;s a mc router, it&squot;s no router */
r_if
c_cond
(paren
(paren
op_logical_neg
id|qeth_is_supported
c_func
(paren
id|IPA_OSA_MC_ROUTER_AVAIL
)paren
op_logical_and
(paren
id|card-&gt;options.routing_type4
op_eq
id|MULTICAST_ROUTER
)paren
)paren
op_logical_or
(paren
id|card-&gt;options.routing_type4
op_eq
id|PRIMARY_CONNECTOR
)paren
op_logical_or
(paren
id|card-&gt;options.routing_type4
op_eq
id|SECONDARY_CONNECTOR
)paren
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;routing not applicable, reset &quot;
l_string|&quot;routing status for ipv4. (Did you mean &quot;
l_string|&quot;primary_router or secondary_router?)&bslash;n&quot;
)paren
suffix:semicolon
id|card-&gt;options.routing_type4
op_assign
id|NO_ROUTER
suffix:semicolon
)brace
)brace
)brace
r_static
r_void
DECL|function|__qeth_correct_routing_status_v6
id|__qeth_correct_routing_status_v6
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
macro_line|#ifdef QETH_IPV6
r_if
c_cond
(paren
id|card-&gt;options.routing_type6
op_eq
id|NO_ROUTER
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|card-&gt;type
op_eq
id|QETH_CARD_TYPE_IQD
)paren
(brace
multiline_comment|/* if it&squot;s not a mc router, it&squot;s no router */
r_if
c_cond
(paren
(paren
id|card-&gt;options.routing_type6
op_eq
id|PRIMARY_ROUTER
)paren
op_logical_or
(paren
id|card-&gt;options.routing_type6
op_eq
id|SECONDARY_ROUTER
)paren
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;routing not applicable, reset &quot;
l_string|&quot;routing status for ipv6. &bslash;n&quot;
)paren
suffix:semicolon
id|card-&gt;options.routing_type6
op_assign
id|NO_ROUTER
suffix:semicolon
)brace
id|card-&gt;options.do_prio_queueing
op_assign
id|NO_PRIO_QUEUEING
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* if it&squot;s a mc router, it&squot;s no router */
r_if
c_cond
(paren
(paren
op_logical_neg
id|qeth_is_supported
c_func
(paren
id|IPA_OSA_MC_ROUTER_AVAIL
)paren
op_logical_and
(paren
id|card-&gt;options.routing_type6
op_eq
id|MULTICAST_ROUTER
)paren
)paren
op_logical_or
(paren
id|card-&gt;options.routing_type6
op_eq
id|PRIMARY_CONNECTOR
)paren
op_logical_or
(paren
id|card-&gt;options.routing_type6
op_eq
id|SECONDARY_CONNECTOR
)paren
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;routing not applicable, reset &quot;
l_string|&quot;routing status for ipv6. (Did you mean &quot;
l_string|&quot;primary_router or secondary_router?)&bslash;n&quot;
)paren
suffix:semicolon
id|card-&gt;options.routing_type6
op_assign
id|NO_ROUTER
suffix:semicolon
)brace
)brace
macro_line|#endif /* QETH_IPV6 */
)brace
r_static
r_void
DECL|function|qeth_correct_routing_status
id|qeth_correct_routing_status
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
id|__qeth_correct_routing_status_v4
c_func
(paren
id|card
)paren
suffix:semicolon
id|__qeth_correct_routing_status_v6
c_func
(paren
id|card
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_init_netdev
id|qeth_init_netdev
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_int
id|result
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
id|result
op_assign
id|qeth_register_netdev
c_func
(paren
id|card
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|PRINT_ALL
c_func
(paren
l_string|&quot;         register_netdev %s -- rc=%i&bslash;n&quot;
comma
id|card-&gt;dev_name
comma
id|result
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;rgnd%4x&quot;
comma
(paren
id|__u16
)paren
id|result
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|1
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;is_registered
comma
l_int|0
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|strcpy
c_func
(paren
id|card-&gt;dev_name
comma
id|card-&gt;dev-&gt;name
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;write_busy
comma
l_int|0
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;is_registered
comma
l_int|1
)paren
suffix:semicolon
id|result
op_assign
id|qeth_softsetup_card
c_func
(paren
id|card
comma
id|QETH_WAIT_FOR_LOCK
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|result
)paren
(brace
id|qeth_init_input_buffers
c_func
(paren
id|card
)paren
suffix:semicolon
)brace
r_else
(brace
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;SSFAILED&quot;
)paren
suffix:semicolon
id|PRINT_WARN
c_func
(paren
l_string|&quot;soft-setup of card failed!&bslash;n&quot;
)paren
suffix:semicolon
)brace
id|INIT_WORK
c_func
(paren
op_amp
id|card-&gt;tqueue
comma
id|qeth_softsetup_thread_starter
comma
id|card
)paren
suffix:semicolon
id|schedule_work
c_func
(paren
op_amp
id|card-&gt;tqueue
)paren
suffix:semicolon
id|out
suffix:colon
id|qeth_wakeup_procfile
c_func
(paren
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_dev_event
id|qeth_dev_event
c_func
(paren
r_struct
id|notifier_block
op_star
id|this
comma
r_int
r_int
id|event
comma
r_void
op_star
id|ptr
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
r_struct
id|net_device
op_star
id|dev
op_assign
(paren
r_struct
id|net_device
op_star
)paren
id|ptr
suffix:semicolon
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;devevent&quot;
)paren
suffix:semicolon
id|QETH_DBF_HEX3
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|event
comma
r_sizeof
(paren
r_int
r_int
)paren
)paren
suffix:semicolon
id|QETH_DBF_HEX3
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|dev
comma
r_sizeof
(paren
r_void
op_star
)paren
)paren
suffix:semicolon
id|card
op_assign
id|__qeth_get_card_from_dev
c_func
(paren
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|qeth_does_card_exist
c_func
(paren
id|card
)paren
)paren
(brace
id|qeth_save_dev_flag_state
c_func
(paren
id|card
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|event
)paren
(brace
r_default
suffix:colon
id|qeth_start_softsetup_thread
c_func
(paren
id|card
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_return
id|NOTIFY_DONE
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_ip_event
id|qeth_ip_event
c_func
(paren
r_struct
id|notifier_block
op_star
id|this
comma
r_int
r_int
id|event
comma
r_void
op_star
id|ptr
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
r_struct
id|in_ifaddr
op_star
id|ifa
op_assign
(paren
r_struct
id|in_ifaddr
op_star
)paren
id|ptr
suffix:semicolon
r_struct
id|net_device
op_star
id|dev
op_assign
id|ifa-&gt;ifa_dev-&gt;dev
suffix:semicolon
r_char
id|dbf_text
(braket
l_int|15
)braket
suffix:semicolon
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;ipevent&quot;
)paren
suffix:semicolon
id|QETH_DBF_HEX3
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|event
comma
r_sizeof
(paren
r_int
r_int
)paren
)paren
suffix:semicolon
id|QETH_DBF_HEX3
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|dev
comma
r_sizeof
(paren
r_void
op_star
)paren
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%08x&quot;
comma
id|ifa-&gt;ifa_address
)paren
suffix:semicolon
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|dbf_text
comma
l_string|&quot;%08x&quot;
comma
id|ifa-&gt;ifa_mask
)paren
suffix:semicolon
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
id|dbf_text
)paren
suffix:semicolon
id|card
op_assign
id|__qeth_get_card_from_dev
c_func
(paren
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|qeth_does_card_exist
c_func
(paren
id|card
)paren
)paren
(brace
id|QETH_DBF_HEX3
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|card
comma
r_sizeof
(paren
r_void
op_star
)paren
)paren
suffix:semicolon
id|qeth_save_dev_flag_state
c_func
(paren
id|card
)paren
suffix:semicolon
id|qeth_start_softsetup_thread
c_func
(paren
id|card
)paren
suffix:semicolon
)brace
r_return
id|NOTIFY_DONE
suffix:semicolon
)brace
macro_line|#ifdef QETH_IPV6
r_static
r_int
DECL|function|qeth_ip6_event
id|qeth_ip6_event
c_func
(paren
r_struct
id|notifier_block
op_star
id|this
comma
r_int
r_int
id|event
comma
r_void
op_star
id|ptr
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
r_struct
id|inet6_ifaddr
op_star
id|ifa
op_assign
(paren
r_struct
id|inet6_ifaddr
op_star
)paren
id|ptr
suffix:semicolon
r_struct
id|net_device
op_star
id|dev
op_assign
id|ifa-&gt;idev-&gt;dev
suffix:semicolon
id|QETH_DBF_TEXT3
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;ip6event&quot;
)paren
suffix:semicolon
id|QETH_DBF_HEX3
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|event
comma
r_sizeof
(paren
r_int
r_int
)paren
)paren
suffix:semicolon
id|QETH_DBF_HEX3
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|dev
comma
r_sizeof
(paren
r_void
op_star
)paren
)paren
suffix:semicolon
id|QETH_DBF_HEX3
c_func
(paren
l_int|0
comma
id|trace
comma
id|ifa-&gt;addr.s6_addr
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
id|QETH_DBF_HEX3
c_func
(paren
l_int|0
comma
id|trace
comma
id|ifa-&gt;addr.s6_addr
op_plus
id|QETH_DBF_TRACE_LEN
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
id|card
op_assign
id|__qeth_get_card_from_dev
c_func
(paren
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|qeth_does_card_exist
c_func
(paren
id|card
)paren
)paren
(brace
id|QETH_DBF_HEX3
c_func
(paren
l_int|0
comma
id|trace
comma
op_amp
id|card
comma
r_sizeof
(paren
r_void
op_star
)paren
)paren
suffix:semicolon
id|qeth_save_dev_flag_state
c_func
(paren
id|card
)paren
suffix:semicolon
id|qeth_start_softsetup_thread
c_func
(paren
id|card
)paren
suffix:semicolon
)brace
r_return
id|NOTIFY_DONE
suffix:semicolon
)brace
macro_line|#endif /* QETH_IPV6 */
r_static
r_int
DECL|function|qeth_reboot_event
id|qeth_reboot_event
c_func
(paren
r_struct
id|notifier_block
op_star
id|this
comma
r_int
r_int
id|event
comma
r_void
op_star
id|ptr
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
id|read_lock
c_func
(paren
op_amp
id|list_lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|firstcard
)paren
(brace
id|card
op_assign
id|firstcard
suffix:semicolon
id|clear_another_one
suffix:colon
r_if
c_cond
(paren
id|card-&gt;type
op_eq
id|QETH_CARD_TYPE_IQD
)paren
(brace
id|ccw_device_halt
c_func
(paren
id|CARD_DDEV
c_func
(paren
id|card
)paren
comma
l_int|0
)paren
suffix:semicolon
id|ccw_device_clear
c_func
(paren
id|CARD_RDEV
c_func
(paren
id|card
)paren
comma
l_int|0
)paren
suffix:semicolon
id|ccw_device_clear
c_func
(paren
id|CARD_WDEV
c_func
(paren
id|card
)paren
comma
l_int|0
)paren
suffix:semicolon
id|ccw_device_clear
c_func
(paren
id|CARD_DDEV
c_func
(paren
id|card
)paren
comma
l_int|0
)paren
suffix:semicolon
)brace
r_else
(brace
id|ccw_device_clear
c_func
(paren
id|CARD_DDEV
c_func
(paren
id|card
)paren
comma
l_int|0
)paren
suffix:semicolon
id|ccw_device_clear
c_func
(paren
id|CARD_RDEV
c_func
(paren
id|card
)paren
comma
l_int|0
)paren
suffix:semicolon
id|ccw_device_clear
c_func
(paren
id|CARD_WDEV
c_func
(paren
id|card
)paren
comma
l_int|0
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|card-&gt;next
)paren
(brace
id|card
op_assign
id|card-&gt;next
suffix:semicolon
r_goto
id|clear_another_one
suffix:semicolon
)brace
)brace
id|read_unlock
c_func
(paren
op_amp
id|list_lock
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|qeth_dev_notifier
r_static
r_struct
id|notifier_block
id|qeth_dev_notifier
op_assign
(brace
id|qeth_dev_event
comma
l_int|0
)brace
suffix:semicolon
DECL|variable|qeth_ip_notifier
r_static
r_struct
id|notifier_block
id|qeth_ip_notifier
op_assign
(brace
id|qeth_ip_event
comma
l_int|0
)brace
suffix:semicolon
macro_line|#ifdef QETH_IPV6
DECL|variable|qeth_ip6_notifier
r_static
r_struct
id|notifier_block
id|qeth_ip6_notifier
op_assign
(brace
id|qeth_ip6_event
comma
l_int|0
)brace
suffix:semicolon
macro_line|#endif /* QETH_IPV6 */
DECL|variable|qeth_reboot_notifier
r_static
r_struct
id|notifier_block
id|qeth_reboot_notifier
op_assign
(brace
id|qeth_reboot_event
comma
l_int|0
)brace
suffix:semicolon
r_static
r_void
DECL|function|qeth_register_notifiers
id|qeth_register_notifiers
c_func
(paren
r_void
)paren
(brace
r_int
id|r
suffix:semicolon
id|QETH_DBF_TEXT5
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;regnotif&quot;
)paren
suffix:semicolon
multiline_comment|/* register to be notified on events */
id|r
op_assign
id|register_netdevice_notifier
c_func
(paren
op_amp
id|qeth_dev_notifier
)paren
suffix:semicolon
id|r
op_assign
id|register_inetaddr_notifier
c_func
(paren
op_amp
id|qeth_ip_notifier
)paren
suffix:semicolon
macro_line|#ifdef QETH_IPV6
id|r
op_assign
id|register_inet6addr_notifier
c_func
(paren
op_amp
id|qeth_ip6_notifier
)paren
suffix:semicolon
macro_line|#endif /* QETH_IPV6 */
id|r
op_assign
id|register_reboot_notifier
c_func
(paren
op_amp
id|qeth_reboot_notifier
)paren
suffix:semicolon
)brace
r_static
r_void
id|__exit
DECL|function|qeth_unregister_notifiers
id|qeth_unregister_notifiers
c_func
(paren
r_void
)paren
(brace
r_int
id|r
suffix:semicolon
id|QETH_DBF_TEXT5
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;unregnot&quot;
)paren
suffix:semicolon
id|r
op_assign
id|unregister_netdevice_notifier
c_func
(paren
op_amp
id|qeth_dev_notifier
)paren
suffix:semicolon
id|r
op_assign
id|unregister_inetaddr_notifier
c_func
(paren
op_amp
id|qeth_ip_notifier
)paren
suffix:semicolon
macro_line|#ifdef QETH_IPV6
id|r
op_assign
id|unregister_inet6addr_notifier
c_func
(paren
op_amp
id|qeth_ip6_notifier
)paren
suffix:semicolon
macro_line|#endif /* QETH_IPV6 */
id|r
op_assign
id|unregister_reboot_notifier
c_func
(paren
op_amp
id|qeth_reboot_notifier
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_procfile_open
id|qeth_procfile_open
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_int
id|length
op_assign
l_int|0
suffix:semicolon
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
r_char
id|checksum_str
(braket
l_int|5
)braket
comma
id|queueing_str
(braket
l_int|14
)braket
comma
id|router_str
(braket
l_int|8
)braket
comma
id|bufsize_str
(braket
l_int|4
)braket
suffix:semicolon
r_char
op_star
id|buffer
suffix:semicolon
r_int
id|rc
op_assign
l_int|0
suffix:semicolon
r_int
id|size
suffix:semicolon
r_struct
id|tempinfo
op_star
id|info
suffix:semicolon
id|info
op_assign
(paren
r_struct
id|tempinfo
op_star
)paren
id|vmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|tempinfo
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|info
op_eq
l_int|NULL
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;No memory available for data&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
r_else
(brace
id|file-&gt;private_data
op_assign
(paren
r_void
op_star
)paren
id|info
suffix:semicolon
)brace
multiline_comment|/* lock all the stuff */
id|read_lock
c_func
(paren
op_amp
id|list_lock
)paren
suffix:semicolon
id|card
op_assign
id|firstcard
suffix:semicolon
id|size
op_assign
l_int|200
suffix:semicolon
multiline_comment|/* 2 lines plus some sanity space */
r_while
c_loop
(paren
id|card
)paren
(brace
id|size
op_add_assign
l_int|90
suffix:semicolon
multiline_comment|/* if device name is &gt; 10 chars, (should never&n;&t;&t;&t;&t;   happen...), we&squot;ll need that */
id|card
op_assign
id|card-&gt;next
suffix:semicolon
)brace
id|buffer
op_assign
id|info-&gt;data
op_assign
(paren
r_char
op_star
)paren
id|vmalloc
c_func
(paren
id|size
)paren
suffix:semicolon
r_if
c_cond
(paren
id|info-&gt;data
op_eq
l_int|NULL
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;No memory available for data&bslash;n&quot;
)paren
suffix:semicolon
id|vfree
c_func
(paren
id|info
)paren
suffix:semicolon
id|rc
op_assign
op_minus
id|ENOMEM
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;procread&quot;
)paren
suffix:semicolon
id|length
op_add_assign
id|sprintf
c_func
(paren
id|buffer
op_plus
id|length
comma
l_string|&quot;devices                  CHPID     &quot;
l_string|&quot;device     cardtype port chksum prio-q&squot;ing &quot;
l_string|&quot;rtr fsz cnt&bslash;n&quot;
)paren
suffix:semicolon
id|length
op_add_assign
id|sprintf
c_func
(paren
id|buffer
op_plus
id|length
comma
l_string|&quot;-------------------------- --- ----&quot;
l_string|&quot;------ -------------- --     -- ---------- &quot;
l_string|&quot;--- --- ---&bslash;n&quot;
)paren
suffix:semicolon
id|card
op_assign
id|firstcard
suffix:semicolon
r_while
c_loop
(paren
id|card
)paren
(brace
id|strcpy
c_func
(paren
id|checksum_str
comma
(paren
id|card-&gt;options.checksum_type
op_eq
id|SW_CHECKSUMMING
)paren
ques
c_cond
l_string|&quot;SW&quot;
suffix:colon
(paren
id|card-&gt;options.checksum_type
op_eq
id|HW_CHECKSUMMING
)paren
ques
c_cond
l_string|&quot;HW&quot;
suffix:colon
l_string|&quot;no&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|card-&gt;options.do_prio_queueing
op_eq
id|NO_PRIO_QUEUEING
)paren
(brace
id|sprintf
c_func
(paren
id|queueing_str
comma
l_string|&quot;always_q_%i&quot;
comma
id|card-&gt;options.default_queue
)paren
suffix:semicolon
)brace
r_else
(brace
id|strcpy
c_func
(paren
id|queueing_str
comma
(paren
id|card-&gt;options.do_prio_queueing
op_eq
id|PRIO_QUEUEING_PREC
)paren
ques
c_cond
l_string|&quot;by_prec.&quot;
suffix:colon
l_string|&quot;by_ToS&quot;
)paren
suffix:semicolon
)brace
multiline_comment|/* FIXME: this is really a mess... */
macro_line|#ifdef QETH_IPV6
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;rt4fld
)paren
op_logical_or
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;rt6fld
)paren
)paren
id|strcpy
c_func
(paren
id|router_str
comma
l_string|&quot;FLD&quot;
)paren
suffix:semicolon
macro_line|#else/* QETH_IPV6 */
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;rt4fld
)paren
)paren
id|strcpy
c_func
(paren
id|router_str
comma
l_string|&quot;FLD&quot;
)paren
suffix:semicolon
macro_line|#endif /* QETH_IPV6 */
r_else
r_if
c_cond
(paren
(paren
(paren
id|card-&gt;options.routing_type4
op_amp
id|ROUTER_MASK
)paren
op_eq
id|PRIMARY_ROUTER
)paren
macro_line|#ifdef QETH_IPV6
op_logical_and
(paren
(paren
(paren
id|card-&gt;options.routing_type6
op_amp
id|ROUTER_MASK
)paren
op_eq
id|PRIMARY_ROUTER
)paren
op_logical_or
(paren
op_logical_neg
id|qeth_is_supported
c_func
(paren
id|IPA_IPv6
)paren
)paren
)paren
macro_line|#endif /* QETH_IPV6 */
)paren
(brace
id|strcpy
c_func
(paren
id|router_str
comma
l_string|&quot;pri&quot;
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
(paren
(paren
id|card-&gt;options.routing_type4
op_amp
id|ROUTER_MASK
)paren
op_eq
id|SECONDARY_ROUTER
)paren
macro_line|#ifdef QETH_IPV6
op_logical_and
(paren
(paren
(paren
id|card-&gt;options.routing_type6
op_amp
id|ROUTER_MASK
)paren
op_eq
id|SECONDARY_ROUTER
)paren
op_logical_or
(paren
op_logical_neg
id|qeth_is_supported
c_func
(paren
id|IPA_IPv6
)paren
)paren
)paren
macro_line|#endif /* QETH_IPV6 */
)paren
(brace
id|strcpy
c_func
(paren
id|router_str
comma
l_string|&quot;sec&quot;
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
(paren
(paren
id|card-&gt;options.routing_type4
op_amp
id|ROUTER_MASK
)paren
op_eq
id|MULTICAST_ROUTER
)paren
macro_line|#ifdef QETH_IPV6
op_logical_and
(paren
(paren
(paren
id|card-&gt;options.routing_type6
op_amp
id|ROUTER_MASK
)paren
op_eq
id|MULTICAST_ROUTER
)paren
op_logical_or
(paren
op_logical_neg
id|qeth_is_supported
c_func
(paren
id|IPA_IPv6
)paren
)paren
)paren
macro_line|#endif /* QETH_IPV6 */
)paren
(brace
id|strcpy
c_func
(paren
id|router_str
comma
l_string|&quot;mc&quot;
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
(paren
(paren
id|card-&gt;options.routing_type4
op_amp
id|ROUTER_MASK
)paren
op_eq
id|PRIMARY_CONNECTOR
)paren
macro_line|#ifdef QETH_IPV6
op_logical_and
(paren
(paren
(paren
id|card-&gt;options.routing_type6
op_amp
id|ROUTER_MASK
)paren
op_eq
id|PRIMARY_CONNECTOR
)paren
op_logical_or
(paren
op_logical_neg
id|qeth_is_supported
c_func
(paren
id|IPA_IPv6
)paren
)paren
)paren
macro_line|#endif /* QETH_IPV6 */
)paren
(brace
id|strcpy
c_func
(paren
id|router_str
comma
l_string|&quot;p.c&quot;
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
(paren
(paren
id|card-&gt;options.routing_type4
op_amp
id|ROUTER_MASK
)paren
op_eq
id|SECONDARY_CONNECTOR
)paren
macro_line|#ifdef QETH_IPV6
op_logical_and
(paren
(paren
(paren
id|card-&gt;options.routing_type6
op_amp
id|ROUTER_MASK
)paren
op_eq
id|SECONDARY_CONNECTOR
)paren
op_logical_or
(paren
op_logical_neg
id|qeth_is_supported
c_func
(paren
id|IPA_IPv6
)paren
)paren
)paren
macro_line|#endif /* QETH_IPV6 */
)paren
(brace
id|strcpy
c_func
(paren
id|router_str
comma
l_string|&quot;s.c&quot;
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
(paren
(paren
id|card-&gt;options.routing_type4
op_amp
id|ROUTER_MASK
)paren
op_eq
id|NO_ROUTER
)paren
macro_line|#ifdef QETH_IPV6
op_logical_and
(paren
(paren
(paren
id|card-&gt;options.routing_type6
op_amp
id|ROUTER_MASK
)paren
op_eq
id|NO_ROUTER
)paren
op_logical_or
(paren
op_logical_neg
id|qeth_is_supported
c_func
(paren
id|IPA_IPv6
)paren
)paren
)paren
macro_line|#endif /* QETH_IPV6 */
)paren
(brace
id|strcpy
c_func
(paren
id|router_str
comma
l_string|&quot;no&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|strcpy
c_func
(paren
id|router_str
comma
l_string|&quot;mix&quot;
)paren
suffix:semicolon
)brace
id|strcpy
c_func
(paren
id|bufsize_str
comma
(paren
id|BUFFER_SIZE
op_eq
l_int|16384
)paren
ques
c_cond
l_string|&quot;16k&quot;
suffix:colon
(paren
id|BUFFER_SIZE
op_eq
l_int|24576
)paren
ques
c_cond
l_string|&quot;24k&quot;
suffix:colon
(paren
id|BUFFER_SIZE
op_eq
l_int|32768
)paren
ques
c_cond
l_string|&quot;32k&quot;
suffix:colon
(paren
id|BUFFER_SIZE
op_eq
l_int|40960
)paren
ques
c_cond
l_string|&quot;40k&quot;
suffix:colon
l_string|&quot;64k&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_startlaned
)paren
)paren
(brace
id|length
op_add_assign
id|sprintf
c_func
(paren
id|buffer
op_plus
id|length
comma
l_string|&quot;%s/%s/%s x%02X %10s %14s %2i&quot;
l_string|&quot;  +++ CABLE PULLED +++&bslash;n&quot;
comma
id|CARD_RDEV_ID
c_func
(paren
id|card
)paren
comma
id|CARD_WDEV_ID
c_func
(paren
id|card
)paren
comma
id|CARD_DDEV_ID
c_func
(paren
id|card
)paren
comma
id|card-&gt;chpid
comma
id|card-&gt;dev_name
comma
id|qeth_get_cardname_short
(paren
id|card-&gt;type
comma
id|card-&gt;link_type
comma
id|card-&gt;is_guest_lan
)paren
comma
id|card-&gt;options.portno
)paren
suffix:semicolon
)brace
r_else
(brace
id|length
op_add_assign
id|sprintf
c_func
(paren
id|buffer
op_plus
id|length
comma
l_string|&quot;%s/%s/%s x%02X %10s %14s %2i&quot;
l_string|&quot;     %2s %10s %3s %3s %3i&bslash;n&quot;
comma
id|CARD_RDEV_ID
c_func
(paren
id|card
)paren
comma
id|CARD_WDEV_ID
c_func
(paren
id|card
)paren
comma
id|CARD_DDEV_ID
c_func
(paren
id|card
)paren
comma
id|card-&gt;chpid
comma
id|card-&gt;dev_name
comma
id|qeth_get_cardname_short
(paren
id|card-&gt;type
comma
id|card-&gt;link_type
comma
id|card-&gt;is_guest_lan
)paren
comma
id|card-&gt;options.portno
comma
id|checksum_str
comma
id|queueing_str
comma
id|router_str
comma
id|bufsize_str
comma
id|card-&gt;options.inbound_buffer_count
)paren
suffix:semicolon
)brace
id|card
op_assign
id|card-&gt;next
suffix:semicolon
)brace
id|out
suffix:colon
id|info-&gt;len
op_assign
id|length
suffix:semicolon
multiline_comment|/* unlock all the stuff */
id|read_unlock
c_func
(paren
op_amp
id|list_lock
)paren
suffix:semicolon
r_return
id|rc
suffix:semicolon
)brace
DECL|macro|_OUTP_IT
mdefine_line|#define _OUTP_IT(x...) c+=sprintf(buffer+c,x)
macro_line|#ifdef QETH_PERFORMANCE_STATS
r_static
r_int
DECL|function|qeth_perf_procfile_read
id|qeth_perf_procfile_read
c_func
(paren
r_char
op_star
id|buffer
comma
r_char
op_star
op_star
id|buffer_location
comma
id|off_t
id|offset
comma
r_int
id|buffer_length
comma
r_int
op_star
id|eof
comma
r_void
op_star
id|data
)paren
(brace
r_int
id|c
op_assign
l_int|0
suffix:semicolon
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
multiline_comment|/* we are always called with buffer_length=4k, so we all&n;&t;   deliver on the first read */
r_if
c_cond
(paren
id|offset
OG
l_int|0
)paren
r_return
l_int|0
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;perfpfrd&quot;
)paren
suffix:semicolon
id|card
op_assign
id|firstcard
suffix:semicolon
r_while
c_loop
(paren
id|card
)paren
(brace
id|_OUTP_IT
c_func
(paren
l_string|&quot;For card with devnos %s/%s/%s (%s):&bslash;n&quot;
comma
id|CARD_RDEV_ID
c_func
(paren
id|card
)paren
comma
id|CARD_WDEV_ID
c_func
(paren
id|card
)paren
comma
id|CARD_DDEV_ID
c_func
(paren
id|card
)paren
comma
id|card-&gt;dev_name
)paren
suffix:semicolon
id|_OUTP_IT
c_func
(paren
l_string|&quot;  Skb&squot;s/buffers received                 : %i/%i&bslash;n&quot;
comma
id|card-&gt;perf_stats.skbs_rec
comma
id|card-&gt;perf_stats.bufs_rec
)paren
suffix:semicolon
id|_OUTP_IT
c_func
(paren
l_string|&quot;  Skb&squot;s/buffers sent                     : %i/%i&bslash;n&quot;
comma
id|card-&gt;perf_stats.skbs_sent
comma
id|card-&gt;perf_stats.bufs_sent
)paren
suffix:semicolon
id|_OUTP_IT
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|_OUTP_IT
c_func
(paren
l_string|&quot;  Skb&squot;s/buffers sent without packing     : %i/%i&bslash;n&quot;
comma
id|card-&gt;perf_stats.skbs_sent_dont_pack
comma
id|card-&gt;perf_stats.bufs_sent_dont_pack
)paren
suffix:semicolon
id|_OUTP_IT
c_func
(paren
l_string|&quot;  Skb&squot;s/buffers sent with packing        : %i/%i&bslash;n&quot;
comma
id|card-&gt;perf_stats.skbs_sent_pack
comma
id|card-&gt;perf_stats.bufs_sent_pack
)paren
suffix:semicolon
id|_OUTP_IT
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|_OUTP_IT
c_func
(paren
l_string|&quot;  Packing state changes no pkg.-&gt;packing : %i/%i&bslash;n&quot;
comma
id|card-&gt;perf_stats.sc_dp_p
comma
id|card-&gt;perf_stats.sc_p_dp
)paren
suffix:semicolon
id|_OUTP_IT
c_func
(paren
l_string|&quot;  Current buffer usage (outbound q&squot;s)    : &quot;
l_string|&quot;%i/%i/%i/%i&bslash;n&quot;
comma
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;outbound_used_buffers
(braket
l_int|0
)braket
)paren
comma
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;outbound_used_buffers
(braket
l_int|1
)braket
)paren
comma
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;outbound_used_buffers
(braket
l_int|2
)braket
)paren
comma
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;outbound_used_buffers
(braket
l_int|3
)braket
)paren
)paren
suffix:semicolon
id|_OUTP_IT
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|_OUTP_IT
c_func
(paren
l_string|&quot;  Inbound time (in us)                   : %i&bslash;n&quot;
comma
id|card-&gt;perf_stats.inbound_time
)paren
suffix:semicolon
id|_OUTP_IT
c_func
(paren
l_string|&quot;  Inbound cnt                            : %i&bslash;n&quot;
comma
id|card-&gt;perf_stats.inbound_cnt
)paren
suffix:semicolon
id|_OUTP_IT
c_func
(paren
l_string|&quot;  Outbound time (in us, incl QDIO)       : %i&bslash;n&quot;
comma
id|card-&gt;perf_stats.outbound_time
)paren
suffix:semicolon
id|_OUTP_IT
c_func
(paren
l_string|&quot;  Outbound cnt                           : %i&bslash;n&quot;
comma
id|card-&gt;perf_stats.outbound_cnt
)paren
suffix:semicolon
id|_OUTP_IT
c_func
(paren
l_string|&quot;  Watermarks: L/H=%i/%i&bslash;n&quot;
comma
id|LOW_WATERMARK_PACK
comma
id|HIGH_WATERMARK_PACK
)paren
suffix:semicolon
id|_OUTP_IT
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|card
op_assign
id|card-&gt;next
suffix:semicolon
)brace
r_return
id|c
suffix:semicolon
)brace
DECL|variable|qeth_perf_proc_file
r_static
r_struct
id|proc_dir_entry
op_star
id|qeth_perf_proc_file
suffix:semicolon
macro_line|#endif /* QETH_PERFORMANCE_STATS */
r_static
r_int
DECL|function|qeth_ipato_procfile_open
id|qeth_ipato_procfile_open
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_char
id|text
(braket
l_int|33
)braket
suffix:semicolon
r_struct
id|ipato_entry
op_star
id|ipato_entry
suffix:semicolon
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
r_struct
id|qeth_vipa_entry
op_star
id|vipa_entry
suffix:semicolon
r_int
id|rc
op_assign
l_int|0
suffix:semicolon
r_struct
id|tempinfo
op_star
id|info
suffix:semicolon
r_int
id|size
suffix:semicolon
r_char
id|entry_type
(braket
l_int|5
)braket
suffix:semicolon
id|info
op_assign
(paren
r_struct
id|tempinfo
op_star
)paren
id|vmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|tempinfo
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|info
op_eq
l_int|NULL
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;No memory available for data&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
r_else
(brace
id|file-&gt;private_data
op_assign
(paren
r_void
op_star
)paren
id|info
suffix:semicolon
)brace
id|info-&gt;len
op_assign
l_int|0
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;ipatorea&quot;
)paren
suffix:semicolon
multiline_comment|/* lock all the stuff */
id|spin_lock
c_func
(paren
op_amp
id|ipato_list_lock
)paren
suffix:semicolon
id|read_lock
c_func
(paren
op_amp
id|list_lock
)paren
suffix:semicolon
id|size
op_assign
l_int|64
suffix:semicolon
multiline_comment|/* for inv4/6 etc. */
id|ipato_entry
op_assign
id|ipato_entries
suffix:semicolon
r_while
c_loop
(paren
id|ipato_entry
)paren
(brace
id|ipato_entry
op_assign
id|ipato_entry-&gt;next
suffix:semicolon
id|size
op_add_assign
l_int|64
suffix:semicolon
)brace
id|card
op_assign
id|firstcard
suffix:semicolon
r_while
c_loop
(paren
id|card
)paren
(brace
id|read_lock
c_func
(paren
op_amp
id|card-&gt;vipa_list_lock
)paren
suffix:semicolon
id|vipa_entry
op_assign
id|card-&gt;vipa_list
suffix:semicolon
r_while
c_loop
(paren
id|vipa_entry
)paren
(brace
id|vipa_entry
op_assign
id|vipa_entry-&gt;next
suffix:semicolon
id|size
op_add_assign
l_int|64
suffix:semicolon
)brace
multiline_comment|/*read_unlock(&amp;card-&gt;vipa_list_lock); don&squot;t unlock it here */
id|card
op_assign
id|card-&gt;next
suffix:semicolon
)brace
id|info-&gt;data
op_assign
(paren
r_char
op_star
)paren
id|vmalloc
c_func
(paren
id|size
)paren
suffix:semicolon
r_if
c_cond
(paren
id|info-&gt;data
op_eq
l_int|NULL
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;No memory available for data&bslash;n&quot;
)paren
suffix:semicolon
id|vfree
c_func
(paren
id|info
)paren
suffix:semicolon
id|rc
op_assign
op_minus
id|ENOMEM
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
DECL|macro|_IOUTP_IT
mdefine_line|#define _IOUTP_IT(x...) info-&gt;len+=sprintf(info-&gt;data+info-&gt;len,x)
r_if
c_cond
(paren
id|ipato_inv4
)paren
id|_IOUTP_IT
c_func
(paren
l_string|&quot;inv4&bslash;n&quot;
)paren
suffix:semicolon
id|ipato_entry
op_assign
id|ipato_entries
suffix:semicolon
id|text
(braket
l_int|8
)braket
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
id|ipato_entry
)paren
(brace
r_if
c_cond
(paren
id|ipato_entry-&gt;version
op_eq
l_int|4
)paren
(brace
id|qeth_convert_addr_to_text
c_func
(paren
l_int|4
comma
id|ipato_entry-&gt;addr
comma
id|text
)paren
suffix:semicolon
id|_IOUTP_IT
c_func
(paren
l_string|&quot;add4 %s/%i%s%s&bslash;n&quot;
comma
id|text
comma
id|ipato_entry-&gt;mask_bits
comma
id|ipato_entry-&gt;dev_name
(braket
l_int|0
)braket
ques
c_cond
l_string|&quot;:&quot;
suffix:colon
l_string|&quot;&quot;
comma
id|ipato_entry-&gt;dev_name
(braket
l_int|0
)braket
ques
c_cond
id|ipato_entry-&gt;dev_name
suffix:colon
l_string|&quot;&quot;
)paren
suffix:semicolon
)brace
id|ipato_entry
op_assign
id|ipato_entry-&gt;next
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ipato_inv6
)paren
id|_IOUTP_IT
c_func
(paren
l_string|&quot;inv6&bslash;n&quot;
)paren
suffix:semicolon
id|ipato_entry
op_assign
id|ipato_entries
suffix:semicolon
id|text
(braket
l_int|32
)braket
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
id|ipato_entry
)paren
(brace
r_if
c_cond
(paren
id|ipato_entry-&gt;version
op_eq
l_int|6
)paren
(brace
id|qeth_convert_addr_to_text
c_func
(paren
l_int|6
comma
id|ipato_entry-&gt;addr
comma
id|text
)paren
suffix:semicolon
id|_IOUTP_IT
c_func
(paren
l_string|&quot;add6 %s/%i%s%s&bslash;n&quot;
comma
id|text
comma
id|ipato_entry-&gt;mask_bits
comma
id|ipato_entry-&gt;dev_name
(braket
l_int|0
)braket
ques
c_cond
l_string|&quot;:&quot;
suffix:colon
l_string|&quot;&quot;
comma
id|ipato_entry-&gt;dev_name
(braket
l_int|0
)braket
ques
c_cond
id|ipato_entry-&gt;dev_name
suffix:colon
l_string|&quot;&quot;
)paren
suffix:semicolon
)brace
id|ipato_entry
op_assign
id|ipato_entry-&gt;next
suffix:semicolon
)brace
id|card
op_assign
id|firstcard
suffix:semicolon
r_while
c_loop
(paren
id|card
)paren
(brace
id|vipa_entry
op_assign
id|card-&gt;vipa_list
suffix:semicolon
r_while
c_loop
(paren
id|vipa_entry
)paren
(brace
id|strcpy
c_func
(paren
id|entry_type
comma
(paren
id|vipa_entry-&gt;flag
op_eq
id|IPA_SETIP_VIPA_FLAGS
)paren
ques
c_cond
l_string|&quot;vipa&quot;
suffix:colon
l_string|&quot;rxip&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|vipa_entry-&gt;version
op_eq
l_int|4
)paren
(brace
id|_IOUTP_IT
c_func
(paren
l_string|&quot;add_%s4 %02x%02x%02x%02x:%s&bslash;n&quot;
comma
id|entry_type
comma
id|vipa_entry-&gt;ip
(braket
l_int|0
)braket
comma
id|vipa_entry-&gt;ip
(braket
l_int|1
)braket
comma
id|vipa_entry-&gt;ip
(braket
l_int|2
)braket
comma
id|vipa_entry-&gt;ip
(braket
l_int|3
)braket
comma
id|card-&gt;dev_name
)paren
suffix:semicolon
)brace
r_else
(brace
id|_IOUTP_IT
c_func
(paren
l_string|&quot;add_%s6 %02x%02x%02x%02x&quot;
l_string|&quot;%02x%02x%02x%02x&quot;
l_string|&quot;%02x%02x%02x%02x&quot;
l_string|&quot;%02x%02x%02x%02x:%s&bslash;n&quot;
comma
id|entry_type
comma
id|vipa_entry-&gt;ip
(braket
l_int|0
)braket
comma
id|vipa_entry-&gt;ip
(braket
l_int|1
)braket
comma
id|vipa_entry-&gt;ip
(braket
l_int|2
)braket
comma
id|vipa_entry-&gt;ip
(braket
l_int|3
)braket
comma
id|vipa_entry-&gt;ip
(braket
l_int|4
)braket
comma
id|vipa_entry-&gt;ip
(braket
l_int|5
)braket
comma
id|vipa_entry-&gt;ip
(braket
l_int|6
)braket
comma
id|vipa_entry-&gt;ip
(braket
l_int|7
)braket
comma
id|vipa_entry-&gt;ip
(braket
l_int|8
)braket
comma
id|vipa_entry-&gt;ip
(braket
l_int|9
)braket
comma
id|vipa_entry-&gt;ip
(braket
l_int|10
)braket
comma
id|vipa_entry-&gt;ip
(braket
l_int|11
)braket
comma
id|vipa_entry-&gt;ip
(braket
l_int|12
)braket
comma
id|vipa_entry-&gt;ip
(braket
l_int|13
)braket
comma
id|vipa_entry-&gt;ip
(braket
l_int|14
)braket
comma
id|vipa_entry-&gt;ip
(braket
l_int|15
)braket
comma
id|card-&gt;dev_name
)paren
suffix:semicolon
)brace
id|vipa_entry
op_assign
id|vipa_entry-&gt;next
suffix:semicolon
)brace
id|card
op_assign
id|card-&gt;next
suffix:semicolon
)brace
id|out
suffix:colon
multiline_comment|/* unlock all the stuff */
id|card
op_assign
id|firstcard
suffix:semicolon
r_while
c_loop
(paren
id|card
)paren
(brace
multiline_comment|/*read_lock(&amp;card-&gt;vipa_list_lock); don&squot;t lock it here */
id|read_unlock
c_func
(paren
op_amp
id|card-&gt;vipa_list_lock
)paren
suffix:semicolon
id|card
op_assign
id|card-&gt;next
suffix:semicolon
)brace
id|read_unlock
c_func
(paren
op_amp
id|list_lock
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|ipato_list_lock
)paren
suffix:semicolon
r_return
id|rc
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_procfile_read
id|qeth_procfile_read
c_func
(paren
r_struct
id|file
op_star
id|file
comma
r_char
op_star
id|user_buf
comma
r_int
id|user_len
comma
id|loff_t
op_star
id|offset
)paren
(brace
id|loff_t
id|len
suffix:semicolon
r_struct
id|tempinfo
op_star
id|p_info
op_assign
(paren
r_struct
id|tempinfo
op_star
)paren
id|file-&gt;private_data
suffix:semicolon
r_if
c_cond
(paren
op_star
id|offset
op_ge
id|p_info-&gt;len
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|len
op_assign
id|__min
c_func
(paren
id|user_len
comma
(paren
id|p_info-&gt;len
op_minus
op_star
id|offset
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|user_buf
comma
op_amp
(paren
id|p_info-&gt;data
(braket
op_star
id|offset
)braket
)paren
comma
id|len
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
(paren
op_star
id|offset
)paren
op_add_assign
id|len
suffix:semicolon
r_return
id|len
suffix:semicolon
)brace
)brace
multiline_comment|/* ATT: this is also the procfile release function for the ipato&n; * procfs entry */
r_static
r_int
DECL|function|qeth_procfile_release
id|qeth_procfile_release
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_struct
id|tempinfo
op_star
id|p_info
op_assign
(paren
r_struct
id|tempinfo
op_star
)paren
id|file-&gt;private_data
suffix:semicolon
r_if
c_cond
(paren
id|p_info
)paren
(brace
r_if
c_cond
(paren
id|p_info-&gt;data
)paren
id|vfree
c_func
(paren
id|p_info-&gt;data
)paren
suffix:semicolon
id|vfree
c_func
(paren
id|p_info
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_ipato_procfile_write
id|qeth_ipato_procfile_write
c_func
(paren
r_struct
id|file
op_star
id|file
comma
r_const
r_char
op_star
id|user_buffer
comma
r_int
id|user_len
comma
id|loff_t
op_star
id|offset
)paren
(brace
r_int
id|add
comma
id|version
suffix:semicolon
r_char
id|text
(braket
l_int|33
)braket
suffix:semicolon
id|__u8
id|addr
(braket
l_int|16
)braket
suffix:semicolon
r_int
id|len
comma
id|i
comma
id|flag
suffix:semicolon
r_int
id|mask_bits
suffix:semicolon
r_char
op_star
id|buffer
suffix:semicolon
r_int
id|dev_name_there
suffix:semicolon
r_char
op_star
id|dev_name_ptr
suffix:semicolon
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
DECL|macro|BUFFER_LEN
mdefine_line|#define BUFFER_LEN (10+32+1+5+1+DEV_NAME_LEN+1)
r_if
c_cond
(paren
op_star
id|offset
OG
l_int|0
)paren
r_return
id|user_len
suffix:semicolon
id|buffer
op_assign
id|vmalloc
c_func
(paren
id|__max
c_func
(paren
id|__max
c_func
(paren
id|user_len
op_plus
l_int|1
comma
id|BUFFER_LEN
)paren
comma
id|QETH_DBF_MISC_LEN
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|buffer
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
multiline_comment|/* BUFFER_LEN=command incl. blank+addr+slash+mask_bits+&n;&t; * colon+DEV_NAME_LEN+zero */
id|memset
c_func
(paren
id|buffer
comma
l_int|0
comma
id|BUFFER_LEN
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
id|buffer
comma
id|user_buffer
comma
id|user_len
)paren
)paren
(brace
id|vfree
c_func
(paren
id|buffer
)paren
suffix:semicolon
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;ipatowri&quot;
)paren
suffix:semicolon
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|misc
comma
id|buffer
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|buffer
comma
l_string|&quot;inv4&quot;
comma
l_int|4
)paren
)paren
(brace
id|ipato_inv4
op_assign
l_int|1
op_minus
id|ipato_inv4
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|buffer
comma
l_string|&quot;inv6&quot;
comma
l_int|4
)paren
)paren
(brace
id|ipato_inv6
op_assign
l_int|1
op_minus
id|ipato_inv6
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|buffer
comma
l_string|&quot;add4 &quot;
comma
l_int|5
)paren
)paren
op_logical_or
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|buffer
comma
l_string|&quot;add6 &quot;
comma
l_int|5
)paren
)paren
op_logical_or
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|buffer
comma
l_string|&quot;del4 &quot;
comma
l_int|5
)paren
)paren
op_logical_or
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|buffer
comma
l_string|&quot;del6 &quot;
comma
l_int|5
)paren
)paren
)paren
(brace
id|text
(braket
l_int|8
)braket
op_assign
l_int|0
suffix:semicolon
id|text
(braket
l_int|32
)braket
op_assign
l_int|0
suffix:semicolon
id|add
op_assign
op_logical_neg
id|strncmp
c_func
(paren
id|buffer
comma
l_string|&quot;add&quot;
comma
l_int|3
)paren
suffix:semicolon
id|version
op_assign
(paren
id|buffer
(braket
l_int|3
)braket
op_eq
l_char|&squot;4&squot;
)paren
ques
c_cond
l_int|4
suffix:colon
l_int|6
suffix:semicolon
id|len
op_assign
(paren
id|version
op_eq
l_int|4
)paren
ques
c_cond
l_int|8
suffix:colon
l_int|32
suffix:semicolon
id|strncpy
c_func
(paren
id|text
comma
id|buffer
op_plus
l_int|5
comma
id|len
)paren
suffix:semicolon
r_if
c_cond
(paren
id|qeth_convert_text_to_addr
c_func
(paren
id|version
comma
id|text
comma
id|addr
)paren
)paren
(brace
id|PRINT_ERR
c_func
(paren
l_string|&quot;error in parsing ipato information &quot;
l_string|&quot;(addr)&bslash;n&quot;
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|strncpy
c_func
(paren
id|text
comma
id|buffer
op_plus
l_int|5
op_plus
id|len
op_plus
l_int|1
comma
l_int|10
)paren
suffix:semicolon
multiline_comment|/* we prepare mask_bits for qeth_getints */
id|dev_name_there
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|5
op_plus
id|len
op_plus
l_int|1
suffix:semicolon
id|i
OL
id|BUFFER_LEN
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
op_star
(paren
id|buffer
op_plus
id|i
)paren
op_eq
l_char|&squot;&bslash;n&squot;
)paren
(brace
op_star
(paren
id|buffer
op_plus
id|i
)paren
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
op_star
(paren
id|buffer
op_plus
id|i
)paren
op_eq
l_char|&squot;:&squot;
)paren
(brace
op_star
(paren
id|buffer
op_plus
id|i
)paren
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* so that qeth_getint works */
id|dev_name_there
op_assign
id|i
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
op_star
(paren
id|buffer
op_plus
id|i
)paren
op_eq
l_int|0
)paren
r_break
suffix:semicolon
)brace
id|mask_bits
op_assign
id|qeth_getint
c_func
(paren
id|buffer
op_plus
l_int|5
op_plus
id|len
op_plus
l_int|1
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|mask_bits
OL
l_int|0
)paren
op_logical_or
(paren
id|mask_bits
OG
(paren
(paren
id|version
op_eq
l_int|4
)paren
ques
c_cond
l_int|32
suffix:colon
l_int|128
)paren
)paren
)paren
(brace
id|PRINT_ERR
c_func
(paren
l_string|&quot;error in parsing ipato information &quot;
l_string|&quot;(mask bits)&bslash;n&quot;
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
r_if
c_cond
(paren
id|dev_name_there
)paren
(brace
id|dev_name_ptr
op_assign
id|buffer
op_plus
id|dev_name_there
op_plus
l_int|1
suffix:semicolon
multiline_comment|/* wipe out the linefeed */
r_for
c_loop
(paren
id|i
op_assign
id|dev_name_there
op_plus
l_int|1
suffix:semicolon
id|i
OL
id|dev_name_there
op_plus
l_int|1
op_plus
id|DEV_NAME_LEN
op_plus
l_int|1
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
op_star
(paren
id|buffer
op_plus
id|i
)paren
op_eq
l_char|&squot;&bslash;n&squot;
)paren
op_star
(paren
id|buffer
op_plus
id|i
)paren
op_assign
l_int|0
suffix:semicolon
)brace
r_else
id|dev_name_ptr
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
id|add
)paren
id|qeth_add_ipato_entry
c_func
(paren
id|version
comma
id|addr
comma
id|mask_bits
comma
id|dev_name_ptr
)paren
suffix:semicolon
r_else
id|qeth_del_ipato_entry
c_func
(paren
id|version
comma
id|addr
comma
id|mask_bits
comma
id|dev_name_ptr
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|buffer
comma
l_string|&quot;add_vipa4 &quot;
comma
l_int|10
)paren
)paren
op_logical_or
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|buffer
comma
l_string|&quot;add_rxip4 &quot;
comma
l_int|10
)paren
)paren
op_logical_or
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|buffer
comma
l_string|&quot;add_vipa6 &quot;
comma
l_int|10
)paren
)paren
op_logical_or
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|buffer
comma
l_string|&quot;add_rxip6 &quot;
comma
l_int|10
)paren
)paren
op_logical_or
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|buffer
comma
l_string|&quot;del_vipa4 &quot;
comma
l_int|10
)paren
)paren
op_logical_or
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|buffer
comma
l_string|&quot;del_rxip4 &quot;
comma
l_int|10
)paren
)paren
op_logical_or
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|buffer
comma
l_string|&quot;del_vipa6 &quot;
comma
l_int|10
)paren
)paren
op_logical_or
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|buffer
comma
l_string|&quot;del_rxip6 &quot;
comma
l_int|10
)paren
)paren
)paren
(brace
id|text
(braket
l_int|8
)braket
op_assign
l_int|0
suffix:semicolon
id|text
(braket
l_int|32
)braket
op_assign
l_int|0
suffix:semicolon
id|add
op_assign
op_logical_neg
id|strncmp
c_func
(paren
id|buffer
comma
l_string|&quot;add&quot;
comma
l_int|3
)paren
suffix:semicolon
id|flag
op_assign
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|buffer
op_plus
l_int|4
comma
l_string|&quot;vipa&quot;
comma
l_int|4
)paren
)paren
ques
c_cond
id|IPA_SETIP_VIPA_FLAGS
suffix:colon
id|IPA_SETIP_TAKEOVER_FLAGS
suffix:semicolon
id|version
op_assign
(paren
id|buffer
(braket
l_int|8
)braket
op_eq
l_char|&squot;4&squot;
)paren
ques
c_cond
l_int|4
suffix:colon
l_int|6
suffix:semicolon
id|len
op_assign
(paren
id|version
op_eq
l_int|4
)paren
ques
c_cond
l_int|8
suffix:colon
l_int|32
suffix:semicolon
id|strncpy
c_func
(paren
id|text
comma
id|buffer
op_plus
l_int|10
comma
id|len
)paren
suffix:semicolon
r_if
c_cond
(paren
id|qeth_convert_text_to_addr
c_func
(paren
id|version
comma
id|text
comma
id|addr
)paren
)paren
(brace
id|PRINT_ERR
c_func
(paren
l_string|&quot;error in parsing vipa/rxip information &quot;
l_string|&quot;(addr)&bslash;n&quot;
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
r_if
c_cond
(paren
op_star
(paren
id|buffer
op_plus
l_int|10
op_plus
id|len
)paren
op_ne
l_char|&squot;:&squot;
)paren
(brace
id|PRINT_ERR
c_func
(paren
l_string|&quot;error in parsing vipa/rxip information &quot;
l_string|&quot;(no interface)&bslash;n&quot;
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
multiline_comment|/* interface name is at buffer+10+len+1 */
multiline_comment|/* wipe out the &bslash;n */
r_for
c_loop
(paren
id|i
op_assign
l_int|10
op_plus
id|len
op_plus
l_int|1
suffix:semicolon
id|i
OL
l_int|10
op_plus
id|len
op_plus
l_int|1
op_plus
id|DEV_NAME_LEN
op_plus
l_int|1
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
op_star
(paren
id|buffer
op_plus
id|i
)paren
op_eq
l_char|&squot;&bslash;n&squot;
)paren
op_star
(paren
id|buffer
op_plus
id|i
)paren
op_assign
l_int|0
suffix:semicolon
id|card
op_assign
id|qeth_get_card_by_name
c_func
(paren
id|buffer
op_plus
l_int|10
op_plus
id|len
op_plus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
(brace
id|PRINT_ERR
c_func
(paren
l_string|&quot;error in parsing vipa/rxip information &quot;
l_string|&quot;(unknown interface)&bslash;n&quot;
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
r_if
c_cond
(paren
id|add
)paren
id|i
op_assign
id|qeth_add_vipa_entry
c_func
(paren
id|card
comma
id|version
comma
id|addr
comma
id|flag
)paren
suffix:semicolon
r_else
id|i
op_assign
id|qeth_del_vipa_entry
c_func
(paren
id|card
comma
id|version
comma
id|addr
comma
id|flag
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|i
)paren
id|qeth_start_softsetup_thread
c_func
(paren
id|card
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|PRINT_ERR
c_func
(paren
l_string|&quot;unknown ipato information command&bslash;n&quot;
)paren
suffix:semicolon
id|out
suffix:colon
id|vfree
c_func
(paren
id|buffer
)paren
suffix:semicolon
op_star
id|offset
op_assign
op_star
id|offset
op_plus
id|user_len
suffix:semicolon
DECL|macro|BUFFER_LEN
macro_line|#undef BUFFER_LEN
r_return
id|user_len
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_procfile_getinterfaces
id|qeth_procfile_getinterfaces
c_func
(paren
r_int
r_int
id|arg
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
r_char
id|parms
(braket
l_int|16
)braket
suffix:semicolon
r_char
op_star
id|buffer
suffix:semicolon
r_char
op_star
id|buffer_pointer
suffix:semicolon
id|__u32
id|version
comma
id|valid_fields
comma
id|qeth_version
comma
id|number_of_devices
comma
id|if_index
suffix:semicolon
id|__u32
id|data_size
comma
id|data_len
suffix:semicolon
r_int
r_int
id|ioctl_flags
suffix:semicolon
r_int
id|result
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* the struct of version 0 is:&n;&t;   typedef struct dev_list&n;&t;   {&n;&t;   char device_name[IFNAME_MAXLEN]; // OSA-Exp device name (e.g. eth0)&n;&t;   __u32 if_index;                  // interface index from kernel&n;&t;   __u32 flags;                    // device charateristics&n;&t;   } __attribute__((packed)) DEV_LIST;&n;&n;&t;   typedef struct osaexp_dev_ver0&n;&t;   {&n;&t;   __u32 version;                // structure version&n;&t;   __u32 valid_fields;           // bitmask of fields that are really filled&n;&t;   __u32 qeth_version;           // qeth driver version&n;&t;   __u32 number_of_devices;      // number of OSA Express devices&n;&t;   struct dev_list devices[0]; // list of OSA Express devices&n;&t;   } __attribute__((packed)) OSAEXP_DEV_VER0;&n;&t; */
id|version
op_assign
l_int|0
suffix:semicolon
id|valid_fields
op_assign
l_int|0
suffix:semicolon
id|qeth_version
op_assign
l_int|0
suffix:semicolon
id|number_of_devices
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
(paren
r_void
op_star
)paren
id|parms
comma
(paren
r_void
op_star
)paren
id|arg
comma
r_sizeof
(paren
id|parms
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|data_size
comma
id|parms
comma
r_sizeof
(paren
id|__u32
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|data_size
OG
l_int|0
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
id|data_size
OG
id|IOCTL_MAX_TRANSFER_SIZE
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|access_ok
c_func
(paren
id|VERIFY_WRITE
comma
(paren
r_void
op_star
)paren
id|arg
comma
id|data_size
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|read_lock
c_func
(paren
op_amp
id|list_lock
)paren
suffix:semicolon
id|card
op_assign
id|firstcard
suffix:semicolon
DECL|macro|IOCTL_USER_STRUCT_SIZE
mdefine_line|#define IOCTL_USER_STRUCT_SIZE (DEV_NAME_LEN*sizeof(char)) + &bslash;&n;&t;sizeof(__u32) + sizeof(__u32)
r_while
c_loop
(paren
id|card
)paren
(brace
r_if
c_cond
(paren
id|card-&gt;type
op_eq
id|QETH_CARD_TYPE_OSAE
)paren
id|number_of_devices
op_assign
id|number_of_devices
op_plus
id|IOCTL_USER_STRUCT_SIZE
suffix:semicolon
id|card
op_assign
id|card-&gt;next
suffix:semicolon
)brace
DECL|macro|IOCTL_USER_STRUCT_SIZE
macro_line|#undef IOCTL_USER_STRUCT_SIZE
r_if
c_cond
(paren
(paren
id|number_of_devices
op_plus
l_int|4
op_star
r_sizeof
(paren
id|__u32
)paren
)paren
op_ge
id|data_size
)paren
(brace
id|result
op_assign
op_minus
id|ENOMEM
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|number_of_devices
op_assign
l_int|0
suffix:semicolon
id|card
op_assign
id|firstcard
suffix:semicolon
id|buffer
op_assign
(paren
r_char
op_star
)paren
id|vmalloc
c_func
(paren
id|data_size
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|buffer
)paren
(brace
id|result
op_assign
op_minus
id|EFAULT
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|buffer_pointer
op_assign
(paren
(paren
r_char
op_star
)paren
(paren
id|buffer
)paren
)paren
op_plus
(paren
l_int|4
op_star
r_sizeof
(paren
id|__u32
)paren
)paren
suffix:semicolon
r_while
c_loop
(paren
id|card
)paren
(brace
r_if
c_cond
(paren
(paren
id|card-&gt;type
op_eq
id|QETH_CARD_TYPE_OSAE
)paren
op_logical_and
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_hardsetup
)paren
)paren
op_logical_and
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_registered
)paren
)paren
)paren
(brace
id|memcpy
c_func
(paren
id|buffer_pointer
comma
id|card-&gt;dev_name
comma
id|DEV_NAME_LEN
)paren
suffix:semicolon
id|buffer_pointer
op_assign
id|buffer_pointer
op_plus
id|DEV_NAME_LEN
suffix:semicolon
id|if_index
op_assign
id|card-&gt;dev-&gt;ifindex
suffix:semicolon
id|memcpy
c_func
(paren
id|buffer_pointer
comma
op_amp
id|if_index
comma
r_sizeof
(paren
id|__u32
)paren
)paren
suffix:semicolon
id|buffer_pointer
op_assign
id|buffer_pointer
op_plus
r_sizeof
(paren
id|__u32
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|buffer_pointer
comma
op_amp
id|ioctl_flags
comma
r_sizeof
(paren
id|__u32
)paren
)paren
suffix:semicolon
id|buffer_pointer
op_assign
id|buffer_pointer
op_plus
r_sizeof
(paren
id|__u32
)paren
suffix:semicolon
id|number_of_devices
op_assign
id|number_of_devices
op_plus
l_int|1
suffix:semicolon
)brace
id|card
op_assign
id|card-&gt;next
suffix:semicolon
)brace
multiline_comment|/* we copy the real size */
id|data_len
op_assign
id|buffer_pointer
op_minus
id|buffer
suffix:semicolon
id|buffer_pointer
op_assign
id|buffer
suffix:semicolon
multiline_comment|/* copy the header information at the beginning of the buffer */
id|memcpy
c_func
(paren
id|buffer_pointer
comma
op_amp
id|version
comma
r_sizeof
(paren
id|__u32
)paren
)paren
suffix:semicolon
id|memcpy
c_func
(paren
(paren
(paren
r_char
op_star
)paren
id|buffer_pointer
)paren
op_plus
r_sizeof
(paren
id|__u32
)paren
comma
op_amp
id|valid_fields
comma
r_sizeof
(paren
id|__u32
)paren
)paren
suffix:semicolon
id|memcpy
c_func
(paren
(paren
(paren
r_char
op_star
)paren
id|buffer_pointer
)paren
op_plus
(paren
l_int|2
op_star
r_sizeof
(paren
id|__u32
)paren
)paren
comma
op_amp
id|qeth_version
comma
r_sizeof
(paren
id|__u32
)paren
)paren
suffix:semicolon
id|memcpy
c_func
(paren
(paren
(paren
r_char
op_star
)paren
id|buffer_pointer
)paren
op_plus
(paren
l_int|3
op_star
r_sizeof
(paren
id|__u32
)paren
)paren
comma
op_amp
id|number_of_devices
comma
r_sizeof
(paren
id|__u32
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
(paren
r_char
op_star
)paren
id|arg
comma
id|buffer
comma
id|data_len
)paren
)paren
id|result
op_assign
op_minus
id|EFAULT
suffix:semicolon
id|vfree
c_func
(paren
id|buffer
)paren
suffix:semicolon
id|out
suffix:colon
id|read_unlock
c_func
(paren
op_amp
id|list_lock
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
DECL|macro|PARMS_BUFFERLENGTH
macro_line|#undef PARMS_BUFFERLENGTH
)brace
suffix:semicolon
r_static
r_int
DECL|function|qeth_procfile_interfacechanges
id|qeth_procfile_interfacechanges
c_func
(paren
r_int
r_int
id|arg
)paren
(brace
r_return
id|qeth_sleepon_procfile
c_func
(paren
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_procfile_ioctl
id|qeth_procfile_ioctl
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
comma
r_int
r_int
id|cmd
comma
r_int
r_int
id|arg
)paren
(brace
r_int
id|result
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|down_interruptible
c_func
(paren
op_amp
id|qeth_procfile_ioctl_lock
)paren
)paren
(brace
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|QETH_IOCPROC_OSAEINTERFACES
suffix:colon
id|result
op_assign
id|qeth_procfile_getinterfaces
c_func
(paren
id|arg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|QETH_IOCPROC_INTERFACECHANGES
suffix:colon
id|result
op_assign
id|qeth_procfile_interfacechanges
c_func
(paren
id|arg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|result
op_assign
op_minus
id|EOPNOTSUPP
suffix:semicolon
)brace
id|up
c_func
(paren
op_amp
id|qeth_procfile_ioctl_lock
)paren
suffix:semicolon
)brace
r_else
id|result
op_assign
op_minus
id|ERESTARTSYS
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
suffix:semicolon
DECL|variable|qeth_procfile_fops
r_static
r_struct
id|file_operations
id|qeth_procfile_fops
op_assign
(brace
dot
id|owner
op_assign
id|THIS_MODULE
comma
dot
id|ioctl
op_assign
id|qeth_procfile_ioctl
comma
dot
id|read
op_assign
id|qeth_procfile_read
comma
dot
id|open
op_assign
id|qeth_procfile_open
comma
dot
id|release
op_assign
id|qeth_procfile_release
comma
)brace
suffix:semicolon
DECL|variable|qeth_proc_file
r_static
r_struct
id|proc_dir_entry
op_star
id|qeth_proc_file
suffix:semicolon
DECL|variable|qeth_ipato_procfile_fops
r_static
r_struct
id|file_operations
id|qeth_ipato_procfile_fops
op_assign
(brace
dot
id|owner
op_assign
id|THIS_MODULE
comma
dot
id|read
op_assign
id|qeth_procfile_read
comma
multiline_comment|/* same as above! */
dot
id|write
op_assign
id|qeth_ipato_procfile_write
comma
dot
id|open
op_assign
id|qeth_ipato_procfile_open
comma
dot
id|release
op_assign
id|qeth_procfile_release
multiline_comment|/* same as above! */
)brace
suffix:semicolon
DECL|variable|qeth_ipato_proc_file
r_static
r_struct
id|proc_dir_entry
op_star
id|qeth_ipato_proc_file
suffix:semicolon
r_static
r_inline
r_void
DECL|function|__qeth_add_procfs_perf
id|__qeth_add_procfs_perf
c_func
(paren
r_void
)paren
(brace
macro_line|#ifdef QETH_PERFORMANCE_STATS
id|proc_perf_file_registration
op_assign
l_int|0
suffix:semicolon
id|qeth_perf_proc_file
op_assign
id|create_proc_entry
c_func
(paren
id|QETH_PERF_PROCFILE_NAME
comma
id|S_IFREG
op_or
l_int|0444
comma
op_amp
id|proc_root
)paren
suffix:semicolon
r_if
c_cond
(paren
id|qeth_perf_proc_file
)paren
(brace
id|qeth_perf_proc_file-&gt;read_proc
op_assign
op_amp
id|qeth_perf_procfile_read
suffix:semicolon
)brace
r_else
id|proc_perf_file_registration
op_assign
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|proc_perf_file_registration
)paren
id|PRINT_WARN
c_func
(paren
l_string|&quot;was not able to register perf. proc-file (%i).&bslash;n&quot;
comma
id|proc_perf_file_registration
)paren
suffix:semicolon
macro_line|#endif /* QETH_PERFORMANCE_STATS */
)brace
r_static
r_void
DECL|function|qeth_add_procfs_entries
id|qeth_add_procfs_entries
c_func
(paren
r_void
)paren
(brace
id|proc_file_registration
op_assign
l_int|0
suffix:semicolon
id|qeth_proc_file
op_assign
id|create_proc_entry
c_func
(paren
id|QETH_PROCFILE_NAME
comma
id|S_IFREG
op_or
l_int|0444
comma
op_amp
id|proc_root
)paren
suffix:semicolon
r_if
c_cond
(paren
id|qeth_proc_file
)paren
(brace
id|qeth_proc_file-&gt;proc_fops
op_assign
op_amp
id|qeth_procfile_fops
suffix:semicolon
id|sema_init
c_func
(paren
op_amp
id|qeth_procfile_ioctl_sem
comma
id|PROCFILE_SLEEP_SEM_MAX_VALUE
)paren
suffix:semicolon
id|sema_init
c_func
(paren
op_amp
id|qeth_procfile_ioctl_lock
comma
id|PROCFILE_IOCTL_SEM_MAX_VALUE
)paren
suffix:semicolon
)brace
r_else
id|proc_file_registration
op_assign
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|proc_file_registration
)paren
id|PRINT_WARN
c_func
(paren
l_string|&quot;was not able to register proc-file (%i).&bslash;n&quot;
comma
id|proc_file_registration
)paren
suffix:semicolon
id|proc_ipato_file_registration
op_assign
l_int|0
suffix:semicolon
id|qeth_ipato_proc_file
op_assign
id|create_proc_entry
c_func
(paren
id|QETH_IPA_PROCFILE_NAME
comma
id|S_IFREG
op_or
l_int|0644
comma
op_amp
id|proc_root
)paren
suffix:semicolon
r_if
c_cond
(paren
id|qeth_ipato_proc_file
)paren
(brace
id|qeth_ipato_proc_file-&gt;proc_fops
op_assign
op_amp
id|qeth_ipato_procfile_fops
suffix:semicolon
)brace
r_else
id|proc_ipato_file_registration
op_assign
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|proc_ipato_file_registration
)paren
id|PRINT_WARN
c_func
(paren
l_string|&quot;was not able to register ipato-proc-file (%i).&bslash;n&quot;
comma
id|proc_ipato_file_registration
)paren
suffix:semicolon
id|__qeth_add_procfs_perf
c_func
(paren
)paren
suffix:semicolon
)brace
r_static
r_void
id|__exit
DECL|function|qeth_remove_procfs_entries
id|qeth_remove_procfs_entries
c_func
(paren
r_void
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|proc_file_registration
)paren
multiline_comment|/* means if it went ok earlier */
id|remove_proc_entry
c_func
(paren
id|QETH_PROCFILE_NAME
comma
op_amp
id|proc_root
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|proc_ipato_file_registration
)paren
multiline_comment|/* means if it went ok earlier */
id|remove_proc_entry
c_func
(paren
id|QETH_IPA_PROCFILE_NAME
comma
op_amp
id|proc_root
)paren
suffix:semicolon
macro_line|#ifdef QETH_PERFORMANCE_STATS
r_if
c_cond
(paren
op_logical_neg
id|proc_perf_file_registration
)paren
multiline_comment|/* means if it went ok earlier */
id|remove_proc_entry
c_func
(paren
id|QETH_PERF_PROCFILE_NAME
comma
op_amp
id|proc_root
)paren
suffix:semicolon
macro_line|#endif /* QETH_PERFORMANCE_STATS */
)brace
r_static
r_int
DECL|function|qeth_register_dbf_views
id|qeth_register_dbf_views
c_func
(paren
r_void
)paren
(brace
id|qeth_dbf_setup
op_assign
id|debug_register
c_func
(paren
id|QETH_DBF_SETUP_NAME
comma
id|QETH_DBF_SETUP_INDEX
comma
id|QETH_DBF_SETUP_NR_AREAS
comma
id|QETH_DBF_SETUP_LEN
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|qeth_dbf_setup
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|debug_register_view
c_func
(paren
id|qeth_dbf_setup
comma
op_amp
id|debug_hex_ascii_view
)paren
suffix:semicolon
id|debug_set_level
c_func
(paren
id|qeth_dbf_setup
comma
id|QETH_DBF_SETUP_LEVEL
)paren
suffix:semicolon
id|qeth_dbf_misc
op_assign
id|debug_register
c_func
(paren
id|QETH_DBF_MISC_NAME
comma
id|QETH_DBF_MISC_INDEX
comma
id|QETH_DBF_MISC_NR_AREAS
comma
id|QETH_DBF_MISC_LEN
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|qeth_dbf_misc
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|debug_register_view
c_func
(paren
id|qeth_dbf_misc
comma
op_amp
id|debug_hex_ascii_view
)paren
suffix:semicolon
id|debug_set_level
c_func
(paren
id|qeth_dbf_misc
comma
id|QETH_DBF_MISC_LEVEL
)paren
suffix:semicolon
id|qeth_dbf_data
op_assign
id|debug_register
c_func
(paren
id|QETH_DBF_DATA_NAME
comma
id|QETH_DBF_DATA_INDEX
comma
id|QETH_DBF_DATA_NR_AREAS
comma
id|QETH_DBF_DATA_LEN
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|qeth_dbf_data
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|debug_register_view
c_func
(paren
id|qeth_dbf_data
comma
op_amp
id|debug_hex_ascii_view
)paren
suffix:semicolon
id|debug_set_level
c_func
(paren
id|qeth_dbf_data
comma
id|QETH_DBF_DATA_LEVEL
)paren
suffix:semicolon
id|qeth_dbf_control
op_assign
id|debug_register
c_func
(paren
id|QETH_DBF_CONTROL_NAME
comma
id|QETH_DBF_CONTROL_INDEX
comma
id|QETH_DBF_CONTROL_NR_AREAS
comma
id|QETH_DBF_CONTROL_LEN
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|qeth_dbf_control
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|debug_register_view
c_func
(paren
id|qeth_dbf_control
comma
op_amp
id|debug_hex_ascii_view
)paren
suffix:semicolon
id|debug_set_level
c_func
(paren
id|qeth_dbf_control
comma
id|QETH_DBF_CONTROL_LEVEL
)paren
suffix:semicolon
id|qeth_dbf_sense
op_assign
id|debug_register
c_func
(paren
id|QETH_DBF_SENSE_NAME
comma
id|QETH_DBF_SENSE_INDEX
comma
id|QETH_DBF_SENSE_NR_AREAS
comma
id|QETH_DBF_SENSE_LEN
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|qeth_dbf_sense
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|debug_register_view
c_func
(paren
id|qeth_dbf_sense
comma
op_amp
id|debug_hex_ascii_view
)paren
suffix:semicolon
id|debug_set_level
c_func
(paren
id|qeth_dbf_sense
comma
id|QETH_DBF_SENSE_LEVEL
)paren
suffix:semicolon
id|qeth_dbf_qerr
op_assign
id|debug_register
c_func
(paren
id|QETH_DBF_QERR_NAME
comma
id|QETH_DBF_QERR_INDEX
comma
id|QETH_DBF_QERR_NR_AREAS
comma
id|QETH_DBF_QERR_LEN
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|qeth_dbf_qerr
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|debug_register_view
c_func
(paren
id|qeth_dbf_qerr
comma
op_amp
id|debug_hex_ascii_view
)paren
suffix:semicolon
id|debug_set_level
c_func
(paren
id|qeth_dbf_qerr
comma
id|QETH_DBF_QERR_LEVEL
)paren
suffix:semicolon
id|qeth_dbf_trace
op_assign
id|debug_register
c_func
(paren
id|QETH_DBF_TRACE_NAME
comma
id|QETH_DBF_TRACE_INDEX
comma
id|QETH_DBF_TRACE_NR_AREAS
comma
id|QETH_DBF_TRACE_LEN
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|qeth_dbf_trace
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|debug_register_view
c_func
(paren
id|qeth_dbf_trace
comma
op_amp
id|debug_hex_ascii_view
)paren
suffix:semicolon
id|debug_set_level
c_func
(paren
id|qeth_dbf_trace
comma
id|QETH_DBF_TRACE_LEVEL
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_unregister_dbf_views
id|qeth_unregister_dbf_views
c_func
(paren
r_void
)paren
(brace
r_if
c_cond
(paren
id|qeth_dbf_setup
)paren
id|debug_unregister
c_func
(paren
id|qeth_dbf_setup
)paren
suffix:semicolon
r_if
c_cond
(paren
id|qeth_dbf_qerr
)paren
id|debug_unregister
c_func
(paren
id|qeth_dbf_qerr
)paren
suffix:semicolon
r_if
c_cond
(paren
id|qeth_dbf_sense
)paren
id|debug_unregister
c_func
(paren
id|qeth_dbf_sense
)paren
suffix:semicolon
r_if
c_cond
(paren
id|qeth_dbf_misc
)paren
id|debug_unregister
c_func
(paren
id|qeth_dbf_misc
)paren
suffix:semicolon
r_if
c_cond
(paren
id|qeth_dbf_data
)paren
id|debug_unregister
c_func
(paren
id|qeth_dbf_data
)paren
suffix:semicolon
r_if
c_cond
(paren
id|qeth_dbf_control
)paren
id|debug_unregister
c_func
(paren
id|qeth_dbf_control
)paren
suffix:semicolon
r_if
c_cond
(paren
id|qeth_dbf_trace
)paren
id|debug_unregister
c_func
(paren
id|qeth_dbf_trace
)paren
suffix:semicolon
)brace
macro_line|#ifdef QETH_IPV6
r_static
r_int
DECL|function|qeth_ipv6_init
id|qeth_ipv6_init
c_func
(paren
r_void
)paren
(brace
id|qeth_old_arp_constructor
op_assign
id|arp_tbl.constructor
suffix:semicolon
id|write_lock
c_func
(paren
op_amp
id|arp_tbl.lock
)paren
suffix:semicolon
id|arp_tbl.constructor
op_assign
id|qeth_arp_constructor
suffix:semicolon
id|write_unlock
c_func
(paren
op_amp
id|arp_tbl.lock
)paren
suffix:semicolon
multiline_comment|/* generate the memory leak here - FIXME*/
id|arp_direct_ops
op_assign
(paren
r_struct
id|neigh_ops
op_star
)paren
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|neigh_ops
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|arp_direct_ops
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|memcpy
c_func
(paren
id|arp_direct_ops
comma
op_amp
id|arp_direct_ops_template
comma
r_sizeof
(paren
r_struct
id|neigh_ops
)paren
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_ipv6_uninit
id|qeth_ipv6_uninit
c_func
(paren
r_void
)paren
(brace
id|write_lock
c_func
(paren
op_amp
id|arp_tbl.lock
)paren
suffix:semicolon
id|arp_tbl.constructor
op_assign
id|qeth_old_arp_constructor
suffix:semicolon
id|write_unlock
c_func
(paren
op_amp
id|arp_tbl.lock
)paren
suffix:semicolon
)brace
macro_line|#endif /* QETH_IPV6 */
r_static
r_int
DECL|function|qeth_get_internal_functions
id|qeth_get_internal_functions
c_func
(paren
r_void
)paren
(brace
r_struct
id|net_device
op_star
id|dev
suffix:semicolon
macro_line|#ifdef CONFIG_NET_ETHERNET
id|dev
op_assign
id|alloc_etherdev
c_func
(paren
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dev
)paren
(brace
id|PRINT_ERR
c_func
(paren
l_string|&quot;Not enough memory for internal functions.&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|qeth_my_eth_header
op_assign
id|dev-&gt;hard_header
suffix:semicolon
id|qeth_my_eth_rebuild_header
op_assign
id|dev-&gt;rebuild_header
suffix:semicolon
id|qeth_my_eth_header_cache
op_assign
id|dev-&gt;hard_header_cache
suffix:semicolon
id|qeth_my_eth_header_cache_update
op_assign
id|dev-&gt;header_cache_update
suffix:semicolon
id|free_netdev
c_func
(paren
id|dev
)paren
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_TR
id|dev
op_assign
id|alloc_trdev
c_func
(paren
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dev
)paren
(brace
id|PRINT_ERR
c_func
(paren
l_string|&quot;Not enough memory for internal functions.&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|qeth_my_tr_header
op_assign
id|dev-&gt;hard_header
suffix:semicolon
id|qeth_my_tr_rebuild_header
op_assign
id|dev-&gt;rebuild_header
suffix:semicolon
id|free_netdev
c_func
(paren
id|dev
)paren
suffix:semicolon
macro_line|#endif
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|qeth_ids
r_static
r_struct
id|ccw_device_id
id|qeth_ids
(braket
)braket
op_assign
(brace
(brace
id|CCW_DEVICE
c_func
(paren
l_int|0x1731
comma
l_int|0x01
)paren
comma
id|driver_info
suffix:colon
id|QETH_CARD_TYPE_OSAE
)brace
comma
(brace
id|CCW_DEVICE
c_func
(paren
l_int|0x1731
comma
l_int|0x05
)paren
comma
id|driver_info
suffix:colon
id|QETH_CARD_TYPE_IQD
)brace
comma
(brace
)brace
comma
)brace
suffix:semicolon
id|MODULE_DEVICE_TABLE
c_func
(paren
id|ccw
comma
id|qeth_ids
)paren
suffix:semicolon
DECL|variable|qeth_ccw_driver
r_static
r_struct
id|ccw_driver
id|qeth_ccw_driver
op_assign
(brace
dot
id|name
op_assign
l_string|&quot;qeth&quot;
comma
dot
id|ids
op_assign
id|qeth_ids
comma
dot
id|probe
op_assign
id|ccwgroup_probe_ccwdev
comma
dot
id|remove
op_assign
id|ccwgroup_remove_ccwdev
comma
)brace
suffix:semicolon
DECL|variable|qeth_root_dev
r_static
r_struct
id|device
op_star
id|qeth_root_dev
suffix:semicolon
DECL|variable|qeth_ccwgroup_driver
r_static
r_struct
id|ccwgroup_driver
id|qeth_ccwgroup_driver
suffix:semicolon
r_static
id|ssize_t
DECL|function|qeth_group_store
id|qeth_group_store
c_func
(paren
r_struct
id|device_driver
op_star
id|drv
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_const
r_char
op_star
id|start
comma
op_star
id|end
suffix:semicolon
r_char
id|bus_ids
(braket
l_int|3
)braket
(braket
id|BUS_ID_SIZE
)braket
comma
op_star
id|argv
(braket
l_int|3
)braket
suffix:semicolon
r_int
id|i
suffix:semicolon
id|pr_debug
c_func
(paren
l_string|&quot;group_store %s&bslash;n&quot;
comma
id|buf
)paren
suffix:semicolon
id|start
op_assign
id|buf
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|3
suffix:semicolon
id|i
op_increment
)paren
(brace
r_static
r_const
r_char
id|delim
(braket
)braket
op_assign
(brace
l_char|&squot;,&squot;
comma
l_char|&squot;,&squot;
comma
l_char|&squot;&bslash;n&squot;
)brace
suffix:semicolon
r_int
id|len
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|end
op_assign
id|strchr
c_func
(paren
id|start
comma
id|delim
(braket
id|i
)braket
)paren
)paren
)paren
r_return
id|count
suffix:semicolon
id|len
op_assign
id|min_t
c_func
(paren
r_int
comma
id|BUS_ID_SIZE
comma
id|end
op_minus
id|start
)paren
suffix:semicolon
id|strncpy
c_func
(paren
id|bus_ids
(braket
id|i
)braket
comma
id|start
comma
id|len
)paren
suffix:semicolon
id|bus_ids
(braket
id|i
)braket
(braket
id|len
)braket
op_assign
l_char|&squot;&bslash;0&squot;
suffix:semicolon
id|start
op_assign
id|end
op_plus
l_int|1
suffix:semicolon
id|argv
(braket
id|i
)braket
op_assign
id|bus_ids
(braket
id|i
)braket
suffix:semicolon
)brace
id|pr_debug
c_func
(paren
l_string|&quot;creating qeth group device from &squot;%s&squot;, &squot;%s&squot; and &squot;%s&squot;&bslash;n&quot;
comma
id|bus_ids
(braket
l_int|0
)braket
comma
id|bus_ids
(braket
l_int|1
)braket
comma
id|bus_ids
(braket
l_int|2
)braket
)paren
suffix:semicolon
id|ccwgroup_create
c_func
(paren
id|qeth_root_dev
comma
id|qeth_ccwgroup_driver.driver_id
comma
op_amp
id|qeth_ccw_driver
comma
l_int|3
comma
id|argv
)paren
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
r_static
id|DRIVER_ATTR
c_func
(paren
id|group
comma
l_int|0200
comma
l_int|0
comma
id|qeth_group_store
)paren
suffix:semicolon
r_static
id|ssize_t
DECL|function|qeth_bufcnt_show
id|qeth_bufcnt_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%i&bslash;n&quot;
comma
id|card-&gt;options.inbound_buffer_count
)paren
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_bufcnt_store
id|qeth_bufcnt_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_int
r_int
id|cnt
suffix:semicolon
r_char
op_star
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
id|count
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_softsetup
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
id|cnt
op_assign
id|simple_strtoul
c_func
(paren
id|buf
comma
op_amp
id|tmp
comma
l_int|16
)paren
suffix:semicolon
id|cnt
op_assign
(paren
id|cnt
OL
id|BUFCNT_MIN
)paren
ques
c_cond
id|BUFCNT_MIN
suffix:colon
(paren
(paren
id|cnt
OG
id|BUFCNT_MAX
)paren
ques
c_cond
id|BUFCNT_MAX
suffix:colon
id|cnt
)paren
suffix:semicolon
id|card-&gt;options.inbound_buffer_count
op_assign
id|cnt
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
r_static
id|DEVICE_ATTR
c_func
(paren
id|bufcnt
comma
l_int|0644
comma
id|qeth_bufcnt_show
comma
id|qeth_bufcnt_store
)paren
suffix:semicolon
r_static
id|ssize_t
DECL|function|qeth_portname_show
id|qeth_portname_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_char
id|tmp
(braket
l_int|9
)braket
suffix:semicolon
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|card-&gt;portname_required
)paren
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;%s&quot;
comma
id|card-&gt;options.portname
op_plus
l_int|1
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|8
suffix:semicolon
id|i
op_increment
)paren
id|tmp
(braket
id|i
)braket
op_assign
(paren
r_char
)paren
id|_ebcasc
(braket
(paren
id|__u8
)paren
id|tmp
(braket
id|i
)braket
)braket
suffix:semicolon
id|tmp
(braket
l_int|8
)braket
op_assign
l_int|0
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
id|tmp
)paren
suffix:semicolon
)brace
r_else
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
l_string|&quot;no portname required&quot;
)paren
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_portname_store
id|qeth_portname_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_char
op_star
id|tmp
suffix:semicolon
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
id|count
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_hardsetup
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
multiline_comment|/* Remove trailing &squot;&bslash;n&squot;. */
id|tmp
op_assign
id|strsep
c_func
(paren
(paren
r_char
op_star
op_star
)paren
op_amp
id|buf
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|strlen
c_func
(paren
id|tmp
)paren
OG
l_int|8
)paren
op_logical_or
(paren
id|strlen
c_func
(paren
id|tmp
)paren
OL
l_int|2
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|card-&gt;options.portname
(braket
l_int|0
)braket
op_assign
id|strlen
c_func
(paren
id|tmp
)paren
suffix:semicolon
multiline_comment|/* for beauty reasons: */
r_for
c_loop
(paren
id|i
op_assign
l_int|1
suffix:semicolon
id|i
OL
l_int|9
suffix:semicolon
id|i
op_increment
)paren
id|card-&gt;options.portname
(braket
id|i
)braket
op_assign
l_char|&squot; &squot;
suffix:semicolon
id|strcpy
c_func
(paren
id|card-&gt;options.portname
op_plus
l_int|1
comma
id|tmp
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|1
suffix:semicolon
id|i
OL
l_int|9
suffix:semicolon
id|i
op_increment
)paren
id|card-&gt;options.portname
(braket
id|i
)braket
op_assign
id|_ascebc
(braket
(paren
r_int
r_char
)paren
id|card-&gt;options.portname
(braket
id|i
)braket
)braket
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
r_static
id|DEVICE_ATTR
c_func
(paren
id|portname
comma
l_int|0644
comma
id|qeth_portname_show
comma
id|qeth_portname_store
)paren
suffix:semicolon
r_static
id|ssize_t
DECL|function|qeth_route4_show
id|qeth_route4_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;rt4fld
)paren
)paren
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
l_string|&quot;FLD&quot;
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|card-&gt;options.routing_type4
op_amp
id|ROUTER_MASK
)paren
(brace
r_case
id|PRIMARY_ROUTER
suffix:colon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
l_string|&quot;primary router&quot;
)paren
suffix:semicolon
r_case
id|SECONDARY_ROUTER
suffix:colon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
l_string|&quot;secondary router&quot;
)paren
suffix:semicolon
r_case
id|MULTICAST_ROUTER
suffix:colon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
l_string|&quot;multicast router&quot;
)paren
suffix:semicolon
r_case
id|PRIMARY_CONNECTOR
suffix:colon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
l_string|&quot;primary connector&quot;
)paren
suffix:semicolon
r_case
id|SECONDARY_CONNECTOR
suffix:colon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
l_string|&quot;secondary connector&quot;
)paren
suffix:semicolon
r_default
suffix:colon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
l_string|&quot;no&quot;
)paren
suffix:semicolon
)brace
)brace
r_static
id|ssize_t
DECL|function|qeth_route4_store
id|qeth_route4_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_int
id|cnt
suffix:semicolon
r_char
op_star
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
id|count
suffix:semicolon
multiline_comment|/* Remove trailing &squot;&bslash;n&squot;. */
id|tmp
op_assign
id|strsep
c_func
(paren
(paren
r_char
op_star
op_star
)paren
op_amp
id|buf
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|cnt
op_assign
id|strlen
c_func
(paren
id|tmp
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|tmp
comma
l_string|&quot;primary_router&quot;
comma
id|cnt
)paren
)paren
(brace
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;pri4&quot;
comma
id|card
)paren
suffix:semicolon
id|card-&gt;options.routing_type4
op_assign
id|PRIMARY_ROUTER
op_or
id|RESET_ROUTING_FLAG
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|tmp
comma
l_string|&quot;secondary_router&quot;
comma
id|cnt
)paren
)paren
(brace
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;sec4&quot;
comma
id|card
)paren
suffix:semicolon
id|card-&gt;options.routing_type4
op_assign
id|SECONDARY_ROUTER
op_or
id|RESET_ROUTING_FLAG
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|tmp
comma
l_string|&quot;multicast_router&quot;
comma
id|cnt
)paren
)paren
(brace
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;mcr4&quot;
comma
id|card
)paren
suffix:semicolon
id|card-&gt;options.routing_type4
op_assign
id|MULTICAST_ROUTER
op_or
id|RESET_ROUTING_FLAG
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|tmp
comma
l_string|&quot;primary_connector&quot;
comma
id|cnt
)paren
)paren
(brace
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;prc4&quot;
comma
id|card
)paren
suffix:semicolon
id|card-&gt;options.routing_type4
op_assign
id|PRIMARY_CONNECTOR
op_or
id|RESET_ROUTING_FLAG
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|tmp
comma
l_string|&quot;secondary_connector&quot;
comma
id|cnt
)paren
)paren
(brace
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;scc4&quot;
comma
id|card
)paren
suffix:semicolon
id|card-&gt;options.routing_type4
op_assign
id|SECONDARY_CONNECTOR
op_or
id|RESET_ROUTING_FLAG
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|tmp
comma
l_string|&quot;no_router&quot;
comma
id|cnt
)paren
)paren
(brace
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;nor4&quot;
comma
id|card
)paren
suffix:semicolon
id|card-&gt;options.routing_type4
op_assign
id|NO_ROUTER
op_or
id|RESET_ROUTING_FLAG
suffix:semicolon
)brace
r_else
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;unknown command input in route4 attribute&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|__qeth_correct_routing_status_v4
c_func
(paren
id|card
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;enable_routing_attempts4
comma
id|QETH_ROUTING_ATTEMPTS
)paren
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_softsetup
)paren
)paren
id|qeth_start_softsetup_thread
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
r_static
id|DEVICE_ATTR
c_func
(paren
id|route4
comma
l_int|0644
comma
id|qeth_route4_show
comma
id|qeth_route4_store
)paren
suffix:semicolon
r_static
id|ssize_t
DECL|function|qeth_route6_show
id|qeth_route6_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
macro_line|#ifdef QETH_IPV6
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;rt6fld
)paren
)paren
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
l_string|&quot;FLD&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|qeth_is_supported
c_func
(paren
id|IPA_IPv6
)paren
)paren
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
l_string|&quot;n/a&quot;
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|card-&gt;options.routing_type6
op_amp
id|ROUTER_MASK
)paren
(brace
r_case
id|PRIMARY_ROUTER
suffix:colon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
l_string|&quot;primary router&quot;
)paren
suffix:semicolon
r_case
id|SECONDARY_ROUTER
suffix:colon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
l_string|&quot;secondary router&quot;
)paren
suffix:semicolon
r_case
id|MULTICAST_ROUTER
suffix:colon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
l_string|&quot;multicast router&quot;
)paren
suffix:semicolon
r_case
id|PRIMARY_CONNECTOR
suffix:colon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
l_string|&quot;primary connector&quot;
)paren
suffix:semicolon
r_case
id|SECONDARY_CONNECTOR
suffix:colon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
l_string|&quot;secondary connector&quot;
)paren
suffix:semicolon
r_default
suffix:colon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
l_string|&quot;no&quot;
)paren
suffix:semicolon
)brace
macro_line|#endif /* QETH_IPV6 */
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
l_string|&quot;n/a&quot;
)paren
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_route6_store
id|qeth_route6_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
macro_line|#ifdef QETH_IPV6
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_int
id|cnt
suffix:semicolon
r_char
op_star
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
id|count
suffix:semicolon
multiline_comment|/* Remove trailing &squot;&bslash;n&squot;. */
id|tmp
op_assign
id|strsep
c_func
(paren
(paren
r_char
op_star
op_star
)paren
op_amp
id|buf
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|cnt
op_assign
id|strlen
c_func
(paren
id|tmp
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|tmp
comma
l_string|&quot;primary_router&quot;
comma
id|cnt
)paren
)paren
(brace
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;pri6&quot;
comma
id|card
)paren
suffix:semicolon
id|card-&gt;options.routing_type6
op_assign
id|PRIMARY_ROUTER
op_or
id|RESET_ROUTING_FLAG
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|tmp
comma
l_string|&quot;secondary_router&quot;
comma
id|cnt
)paren
)paren
(brace
id|QETH_DBF_TEXT2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;sec6&quot;
)paren
suffix:semicolon
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;sec6&quot;
comma
id|card
)paren
suffix:semicolon
id|card-&gt;options.routing_type6
op_assign
id|SECONDARY_ROUTER
op_or
id|RESET_ROUTING_FLAG
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|tmp
comma
l_string|&quot;multicast_router&quot;
comma
id|cnt
)paren
)paren
(brace
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;mcr6&quot;
comma
id|card
)paren
suffix:semicolon
id|card-&gt;options.routing_type6
op_assign
id|MULTICAST_ROUTER
op_or
id|RESET_ROUTING_FLAG
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|tmp
comma
l_string|&quot;primary_connector&quot;
comma
id|cnt
)paren
)paren
(brace
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;prc6&quot;
comma
id|card
)paren
suffix:semicolon
id|card-&gt;options.routing_type6
op_assign
id|PRIMARY_CONNECTOR
op_or
id|RESET_ROUTING_FLAG
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|tmp
comma
l_string|&quot;secondary_connector&quot;
comma
id|cnt
)paren
)paren
(brace
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;scc6&quot;
comma
id|card
)paren
suffix:semicolon
id|card-&gt;options.routing_type6
op_assign
id|SECONDARY_CONNECTOR
op_or
id|RESET_ROUTING_FLAG
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|tmp
comma
l_string|&quot;no_router&quot;
comma
id|cnt
)paren
)paren
(brace
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;nor6&quot;
comma
id|card
)paren
suffix:semicolon
id|card-&gt;options.routing_type6
op_assign
id|NO_ROUTER
op_or
id|RESET_ROUTING_FLAG
suffix:semicolon
)brace
r_else
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;unknown command input in route6 attribute&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|__qeth_correct_routing_status_v6
c_func
(paren
id|card
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;enable_routing_attempts6
comma
id|QETH_ROUTING_ATTEMPTS
)paren
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_softsetup
)paren
)paren
id|qeth_start_softsetup_thread
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|count
suffix:semicolon
macro_line|#endif /* QETH_IPV6 */
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_static
id|DEVICE_ATTR
c_func
(paren
id|route6
comma
l_int|0644
comma
id|qeth_route6_show
comma
id|qeth_route6_store
)paren
suffix:semicolon
r_static
id|ssize_t
DECL|function|qeth_checksum_show
id|qeth_checksum_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_switch
c_cond
(paren
id|card-&gt;options.checksum_type
)paren
(brace
r_case
id|SW_CHECKSUMMING
suffix:colon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
l_string|&quot;sw&quot;
)paren
suffix:semicolon
r_case
id|HW_CHECKSUMMING
suffix:colon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
l_string|&quot;hw&quot;
)paren
suffix:semicolon
r_default
suffix:colon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
l_string|&quot;no&quot;
)paren
suffix:semicolon
)brace
)brace
r_static
id|ssize_t
DECL|function|qeth_checksum_store
id|qeth_checksum_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_char
op_star
id|tmp
suffix:semicolon
r_int
id|cnt
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
id|count
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_hardsetup
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
multiline_comment|/* Remove trailing &squot;&bslash;n&squot;. */
id|tmp
op_assign
id|strsep
c_func
(paren
(paren
r_char
op_star
op_star
)paren
op_amp
id|buf
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|cnt
op_assign
id|strlen
c_func
(paren
id|tmp
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|tmp
comma
l_string|&quot;sw_checksumming&quot;
comma
id|cnt
)paren
)paren
id|card-&gt;options.checksum_type
op_assign
id|SW_CHECKSUMMING
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|tmp
comma
l_string|&quot;hw_checksumming&quot;
comma
id|cnt
)paren
)paren
id|card-&gt;options.checksum_type
op_assign
id|HW_CHECKSUMMING
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|tmp
comma
l_string|&quot;no_checksumming&quot;
comma
id|cnt
)paren
)paren
id|card-&gt;options.checksum_type
op_assign
id|NO_CHECKSUMMING
suffix:semicolon
r_else
id|PRINT_WARN
c_func
(paren
l_string|&quot;unknown checksumming type &squot;%s&squot;&bslash;n&quot;
comma
id|tmp
)paren
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
r_static
id|DEVICE_ATTR
c_func
(paren
id|checksumming
comma
l_int|0644
comma
id|qeth_checksum_show
comma
id|qeth_checksum_store
)paren
suffix:semicolon
r_static
id|ssize_t
DECL|function|qeth_prioq_show
id|qeth_prioq_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_switch
c_cond
(paren
id|card-&gt;options.do_prio_queueing
)paren
(brace
r_case
id|PRIO_QUEUEING_PREC
suffix:colon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
l_string|&quot;by precedence&quot;
)paren
suffix:semicolon
r_case
id|PRIO_QUEUEING_TOS
suffix:colon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
l_string|&quot;by type of service&quot;
)paren
suffix:semicolon
r_default
suffix:colon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;always queue %i&bslash;n&quot;
comma
id|card-&gt;options.default_queue
)paren
suffix:semicolon
)brace
)brace
r_static
id|ssize_t
DECL|function|qeth_prioq_store
id|qeth_prioq_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_char
op_star
id|tmp
suffix:semicolon
r_int
id|cnt
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
id|count
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_hardsetup
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
multiline_comment|/* Remove trailing &squot;&bslash;n&squot;. */
id|tmp
op_assign
id|strsep
c_func
(paren
(paren
r_char
op_star
op_star
)paren
op_amp
id|buf
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|cnt
op_assign
id|strlen
c_func
(paren
id|tmp
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|tmp
comma
l_string|&quot;prio_queueing_prec&quot;
comma
id|cnt
)paren
)paren
id|card-&gt;options.do_prio_queueing
op_assign
id|PRIO_QUEUEING_PREC
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|tmp
comma
l_string|&quot;prio_queueing_tos&quot;
comma
id|cnt
)paren
)paren
id|card-&gt;options.do_prio_queueing
op_assign
id|PRIO_QUEUEING_TOS
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|tmp
comma
l_string|&quot;no_prio_queueing:0&quot;
comma
id|cnt
)paren
)paren
(brace
id|card-&gt;options.do_prio_queueing
op_assign
id|NO_PRIO_QUEUEING
suffix:semicolon
id|card-&gt;options.default_queue
op_assign
l_int|0
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|tmp
comma
l_string|&quot;no_prio_queueing:1&quot;
comma
id|cnt
)paren
)paren
(brace
id|card-&gt;options.do_prio_queueing
op_assign
id|NO_PRIO_QUEUEING
suffix:semicolon
id|card-&gt;options.default_queue
op_assign
l_int|1
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|tmp
comma
l_string|&quot;no_prio_queueing:2&quot;
comma
id|cnt
)paren
)paren
(brace
id|card-&gt;options.do_prio_queueing
op_assign
id|NO_PRIO_QUEUEING
suffix:semicolon
id|card-&gt;options.default_queue
op_assign
l_int|2
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|tmp
comma
l_string|&quot;no_prio_queueing:3&quot;
comma
id|cnt
)paren
)paren
(brace
id|card-&gt;options.do_prio_queueing
op_assign
id|NO_PRIO_QUEUEING
suffix:semicolon
id|card-&gt;options.default_queue
op_assign
l_int|3
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|tmp
comma
l_string|&quot;no_prio_queueing&quot;
comma
id|cnt
)paren
)paren
(brace
id|card-&gt;options.do_prio_queueing
op_assign
id|NO_PRIO_QUEUEING
suffix:semicolon
id|card-&gt;options.default_queue
op_assign
id|QETH_DEFAULT_QUEUE
suffix:semicolon
)brace
r_else
id|PRINT_WARN
c_func
(paren
l_string|&quot;unknown queueing type &squot;%s&squot;&bslash;n&quot;
comma
id|tmp
)paren
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
r_static
id|DEVICE_ATTR
c_func
(paren
id|priority_queueing
comma
l_int|0644
comma
id|qeth_prioq_show
comma
id|qeth_prioq_store
)paren
suffix:semicolon
r_static
id|ssize_t
DECL|function|qeth_portno_show
id|qeth_portno_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%i&bslash;n&quot;
comma
id|card-&gt;options.portno
)paren
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_portno_store
id|qeth_portno_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_char
op_star
id|tmp
suffix:semicolon
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
id|count
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_hardsetup
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
id|i
op_assign
id|simple_strtoul
c_func
(paren
id|buf
comma
op_amp
id|tmp
comma
l_int|16
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|i
OL
l_int|0
)paren
op_logical_or
(paren
id|i
OG
id|MAX_PORTNO
)paren
)paren
(brace
id|PRINT_ERR
c_func
(paren
l_string|&quot;portno %i out of range&bslash;n&quot;
comma
id|i
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|card-&gt;options.portno
op_assign
id|i
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
r_static
id|DEVICE_ATTR
c_func
(paren
id|portno
comma
l_int|0644
comma
id|qeth_portno_show
comma
id|qeth_portno_store
)paren
suffix:semicolon
r_static
id|ssize_t
DECL|function|qeth_polltime_show
id|qeth_polltime_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%i&bslash;n&quot;
comma
id|card-&gt;options.polltime
)paren
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_polltime_store
id|qeth_polltime_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_char
op_star
id|tmp
suffix:semicolon
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
id|count
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_hardsetup
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
id|i
op_assign
id|simple_strtoul
c_func
(paren
id|buf
comma
op_amp
id|tmp
comma
l_int|16
)paren
suffix:semicolon
r_if
c_cond
(paren
id|i
OL
l_int|0
)paren
(brace
id|PRINT_ERR
c_func
(paren
l_string|&quot;polltime %i invalid&bslash;n&quot;
comma
id|i
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|card-&gt;options.polltime
op_assign
id|i
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
r_static
id|DEVICE_ATTR
c_func
(paren
id|polltime
comma
l_int|0644
comma
id|qeth_polltime_show
comma
id|qeth_polltime_store
)paren
suffix:semicolon
r_static
id|ssize_t
DECL|function|qeth_hhlen_show
id|qeth_hhlen_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%i&bslash;n&quot;
comma
id|card-&gt;options.add_hhlen
)paren
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_hhlen_store
id|qeth_hhlen_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_char
op_star
id|tmp
suffix:semicolon
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
id|count
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_hardsetup
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
id|i
op_assign
id|simple_strtoul
c_func
(paren
id|buf
comma
op_amp
id|tmp
comma
l_int|16
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|i
OL
l_int|0
)paren
op_logical_or
(paren
id|i
OG
id|MAX_ADD_HHLEN
)paren
)paren
(brace
id|PRINT_ERR
c_func
(paren
l_string|&quot;add_hhlen out of range&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|card-&gt;options.add_hhlen
op_assign
id|i
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
r_static
id|DEVICE_ATTR
c_func
(paren
id|add_hhlen
comma
l_int|0644
comma
id|qeth_hhlen_show
comma
id|qeth_hhlen_store
)paren
suffix:semicolon
r_static
id|ssize_t
DECL|function|qeth_takeover_show
id|qeth_takeover_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
(paren
id|card-&gt;options.ena_ipat
op_eq
id|ENABLE_TAKEOVER
)paren
ques
c_cond
l_string|&quot;1&quot;
suffix:colon
l_string|&quot;0&quot;
)paren
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_takeover_store
id|qeth_takeover_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_int
id|i
suffix:semicolon
r_char
op_star
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
id|count
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_hardsetup
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
id|i
op_assign
id|simple_strtoul
c_func
(paren
id|buf
comma
op_amp
id|tmp
comma
l_int|16
)paren
suffix:semicolon
r_if
c_cond
(paren
id|i
op_eq
l_int|1
)paren
id|card-&gt;options.ena_ipat
op_assign
id|ENABLE_TAKEOVER
suffix:semicolon
r_else
r_if
c_cond
(paren
id|i
op_eq
l_int|0
)paren
id|card-&gt;options.ena_ipat
op_assign
id|DISABLE_TAKEOVER
suffix:semicolon
r_else
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
r_static
id|DEVICE_ATTR
c_func
(paren
id|enable_takeover
comma
l_int|0644
comma
id|qeth_takeover_show
comma
id|qeth_takeover_store
)paren
suffix:semicolon
r_static
id|ssize_t
DECL|function|qeth_macaddr_show
id|qeth_macaddr_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
(paren
id|card-&gt;options.macaddr_mode
op_eq
id|MACADDR_CANONICAL
)paren
ques
c_cond
l_string|&quot;1&quot;
suffix:colon
l_string|&quot;0&quot;
)paren
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_macaddr_store
id|qeth_macaddr_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_int
id|i
suffix:semicolon
r_char
op_star
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
id|count
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_hardsetup
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
id|i
op_assign
id|simple_strtoul
c_func
(paren
id|buf
comma
op_amp
id|tmp
comma
l_int|16
)paren
suffix:semicolon
r_if
c_cond
(paren
id|i
op_eq
l_int|0
)paren
id|card-&gt;options.macaddr_mode
op_assign
id|MACADDR_NONCANONICAL
suffix:semicolon
r_else
r_if
c_cond
(paren
id|i
op_eq
l_int|1
)paren
id|card-&gt;options.macaddr_mode
op_assign
id|MACADDR_CANONICAL
suffix:semicolon
r_else
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
r_static
id|DEVICE_ATTR
c_func
(paren
id|canonical_macaddr
comma
l_int|0644
comma
id|qeth_macaddr_show
comma
id|qeth_macaddr_store
)paren
suffix:semicolon
r_static
id|ssize_t
DECL|function|qeth_fakebr_show
id|qeth_fakebr_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
(paren
id|card-&gt;options.fake_broadcast
op_eq
id|FAKE_BROADCAST
)paren
ques
c_cond
l_string|&quot;1&quot;
suffix:colon
l_string|&quot;0&quot;
)paren
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_fakebr_store
id|qeth_fakebr_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_int
id|i
suffix:semicolon
r_char
op_star
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
id|count
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_hardsetup
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
id|i
op_assign
id|simple_strtoul
c_func
(paren
id|buf
comma
op_amp
id|tmp
comma
l_int|16
)paren
suffix:semicolon
r_if
c_cond
(paren
id|i
op_eq
l_int|0
)paren
id|card-&gt;options.fake_broadcast
op_assign
id|DONT_FAKE_BROADCAST
suffix:semicolon
r_else
r_if
c_cond
(paren
id|i
op_eq
l_int|1
)paren
id|card-&gt;options.fake_broadcast
op_assign
id|FAKE_BROADCAST
suffix:semicolon
r_else
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
r_static
id|DEVICE_ATTR
c_func
(paren
id|fake_broadcast
comma
l_int|0644
comma
id|qeth_fakebr_show
comma
id|qeth_fakebr_store
)paren
suffix:semicolon
r_static
id|ssize_t
DECL|function|qeth_fakell_show
id|qeth_fakell_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
(paren
id|card-&gt;options.fake_ll
op_eq
id|FAKE_LL
)paren
ques
c_cond
l_string|&quot;1&quot;
suffix:colon
l_string|&quot;0&quot;
)paren
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_fakell_store
id|qeth_fakell_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_int
id|i
suffix:semicolon
r_char
op_star
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
id|count
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_hardsetup
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
id|i
op_assign
id|simple_strtoul
c_func
(paren
id|buf
comma
op_amp
id|tmp
comma
l_int|16
)paren
suffix:semicolon
r_if
c_cond
(paren
id|i
op_eq
l_int|0
)paren
id|card-&gt;options.fake_ll
op_assign
id|DONT_FAKE_LL
suffix:semicolon
r_else
r_if
c_cond
(paren
id|i
op_eq
l_int|1
)paren
id|card-&gt;options.fake_ll
op_assign
id|FAKE_LL
suffix:semicolon
r_else
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
r_static
id|DEVICE_ATTR
c_func
(paren
id|fake_ll
comma
l_int|0644
comma
id|qeth_fakell_show
comma
id|qeth_fakell_store
)paren
suffix:semicolon
r_static
id|ssize_t
DECL|function|qeth_broadcast_show
id|qeth_broadcast_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
(paren
id|card-&gt;options.broadcast_mode
op_eq
id|BROADCAST_ALLRINGS
)paren
ques
c_cond
l_string|&quot;allrings&quot;
suffix:colon
l_string|&quot;local&quot;
)paren
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_broadcast_store
id|qeth_broadcast_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_char
op_star
id|tmp
suffix:semicolon
r_int
id|cnt
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
id|count
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_hardsetup
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
multiline_comment|/* Remove trailing &squot;&bslash;n&squot;. */
id|tmp
op_assign
id|strsep
c_func
(paren
(paren
r_char
op_star
op_star
)paren
op_amp
id|buf
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|cnt
op_assign
id|strlen
c_func
(paren
id|tmp
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|tmp
comma
l_string|&quot;broadcast_allrings&quot;
comma
id|cnt
)paren
)paren
id|card-&gt;options.broadcast_mode
op_assign
id|BROADCAST_ALLRINGS
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|tmp
comma
l_string|&quot;broadcast_local&quot;
comma
id|cnt
)paren
)paren
id|card-&gt;options.broadcast_mode
op_assign
id|BROADCAST_LOCAL
suffix:semicolon
r_else
id|PRINT_WARN
c_func
(paren
l_string|&quot;unknown broadcast type &squot;%s&squot;&bslash;n&quot;
comma
id|tmp
)paren
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
r_static
id|DEVICE_ATTR
c_func
(paren
id|broadcast_mode
comma
l_int|0644
comma
id|qeth_broadcast_show
comma
id|qeth_broadcast_store
)paren
suffix:semicolon
r_static
id|ssize_t
DECL|function|qeth_recover_store
id|qeth_recover_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_int
id|i
suffix:semicolon
r_char
op_star
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
id|count
suffix:semicolon
id|i
op_assign
id|simple_strtoul
c_func
(paren
id|buf
comma
op_amp
id|tmp
comma
l_int|16
)paren
suffix:semicolon
r_if
c_cond
(paren
id|i
op_eq
l_int|1
)paren
(brace
id|QETH_DBF_CARD2
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;UTRC&quot;
comma
id|card
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|card-&gt;problem
comma
id|PROBLEM_USER_TRIGGERED_RECOVERY
)paren
suffix:semicolon
id|qeth_schedule_recovery
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
r_else
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_static
id|DEVICE_ATTR
c_func
(paren
id|recover
comma
l_int|0200
comma
l_int|0
comma
id|qeth_recover_store
)paren
suffix:semicolon
r_static
id|ssize_t
DECL|function|qeth_card_type_show
id|qeth_card_type_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;is_softsetup
)paren
)paren
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;n/a&bslash;n&quot;
)paren
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
id|qeth_get_cardname_short
c_func
(paren
id|card-&gt;type
comma
id|card-&gt;link_type
comma
id|card-&gt;is_guest_lan
)paren
)paren
suffix:semicolon
)brace
r_static
id|DEVICE_ATTR
c_func
(paren
id|card_type
comma
l_int|0444
comma
id|qeth_card_type_show
comma
l_int|NULL
)paren
suffix:semicolon
DECL|variable|qeth_attrs
r_static
r_struct
id|attribute
op_star
id|qeth_attrs
(braket
)braket
op_assign
(brace
op_amp
id|dev_attr_bufcnt.attr
comma
op_amp
id|dev_attr_portname.attr
comma
op_amp
id|dev_attr_route4.attr
comma
op_amp
id|dev_attr_route6.attr
comma
op_amp
id|dev_attr_checksumming.attr
comma
op_amp
id|dev_attr_priority_queueing.attr
comma
op_amp
id|dev_attr_portno.attr
comma
op_amp
id|dev_attr_polltime.attr
comma
op_amp
id|dev_attr_add_hhlen.attr
comma
op_amp
id|dev_attr_enable_takeover.attr
comma
op_amp
id|dev_attr_canonical_macaddr.attr
comma
op_amp
id|dev_attr_fake_broadcast.attr
comma
op_amp
id|dev_attr_fake_ll.attr
comma
op_amp
id|dev_attr_broadcast_mode.attr
comma
op_amp
id|dev_attr_recover.attr
comma
op_amp
id|dev_attr_card_type.attr
comma
l_int|NULL
comma
)brace
suffix:semicolon
DECL|variable|qeth_attr_group
r_static
r_struct
id|attribute_group
id|qeth_attr_group
op_assign
(brace
dot
id|attrs
op_assign
id|qeth_attrs
comma
)brace
suffix:semicolon
r_static
r_inline
r_int
DECL|function|__qeth_create_attributes
id|__qeth_create_attributes
c_func
(paren
r_struct
id|device
op_star
id|dev
)paren
(brace
r_return
id|sysfs_create_group
c_func
(paren
op_amp
id|dev-&gt;kobj
comma
op_amp
id|qeth_attr_group
)paren
suffix:semicolon
)brace
r_static
r_inline
r_void
DECL|function|__qeth_remove_attributes
id|__qeth_remove_attributes
c_func
(paren
r_struct
id|device
op_star
id|dev
)paren
(brace
id|sysfs_remove_group
c_func
(paren
op_amp
id|dev-&gt;kobj
comma
op_amp
id|qeth_attr_group
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_probe_device
id|qeth_probe_device
c_func
(paren
r_struct
id|ccwgroup_device
op_star
id|gdev
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
r_int
id|ret
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|get_device
c_func
(paren
op_amp
id|gdev-&gt;dev
)paren
)paren
r_return
op_minus
id|ENODEV
suffix:semicolon
id|card
op_assign
id|qeth_alloc_card
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
(brace
id|put_device
c_func
(paren
op_amp
id|gdev-&gt;dev
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|gdev-&gt;dev.driver_data
op_assign
id|card
suffix:semicolon
id|card-&gt;gdev
op_assign
id|gdev
suffix:semicolon
id|gdev-&gt;cdev
(braket
l_int|0
)braket
op_member_access_from_pointer
id|handler
op_assign
id|qeth_interrupt_handler_read
suffix:semicolon
id|gdev-&gt;cdev
(braket
l_int|0
)braket
op_member_access_from_pointer
id|dev.driver_data
op_assign
id|card
suffix:semicolon
id|gdev-&gt;cdev
(braket
l_int|1
)braket
op_member_access_from_pointer
id|handler
op_assign
id|qeth_interrupt_handler_write
suffix:semicolon
id|gdev-&gt;cdev
(braket
l_int|1
)braket
op_member_access_from_pointer
id|dev.driver_data
op_assign
id|card
suffix:semicolon
id|gdev-&gt;cdev
(braket
l_int|2
)braket
op_member_access_from_pointer
id|handler
op_assign
id|qeth_interrupt_handler_qdio
suffix:semicolon
id|gdev-&gt;cdev
(braket
l_int|2
)braket
op_member_access_from_pointer
id|dev.driver_data
op_assign
id|card
suffix:semicolon
id|ret
op_assign
id|__qeth_create_attributes
c_func
(paren
op_amp
id|gdev-&gt;dev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
op_ne
l_int|0
)paren
r_goto
id|out
suffix:semicolon
r_return
l_int|0
suffix:semicolon
id|out
suffix:colon
id|put_device
c_func
(paren
op_amp
id|gdev-&gt;dev
)paren
suffix:semicolon
id|qeth_free_card
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
multiline_comment|/* &n; * Replaces qeth_probe and qeth_attach_handler. &n; * This is called after piping to the &squot;online&squot; attribute,&n; * when all parameters are ready.&n; */
r_static
r_int
DECL|function|qeth_activate
id|qeth_activate
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_int
id|result
suffix:semicolon
id|ccw_device_set_online
c_func
(paren
id|CARD_RDEV
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
id|ccw_device_set_online
c_func
(paren
id|CARD_WDEV
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
id|ccw_device_set_online
c_func
(paren
id|CARD_DDEV
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
id|QETH_DBF_CARD1
c_func
(paren
l_int|0
comma
id|setup
comma
l_string|&quot;activ&quot;
comma
id|card
)paren
suffix:semicolon
id|QETH_DBF_HEX1
c_func
(paren
l_int|0
comma
id|setup
comma
op_amp
id|card
comma
r_sizeof
(paren
r_void
op_star
)paren
)paren
suffix:semicolon
id|QETH_DBF_HEX1
c_func
(paren
l_int|0
comma
id|setup
comma
op_amp
id|card-&gt;dev
comma
r_sizeof
(paren
r_void
op_star
)paren
)paren
suffix:semicolon
id|QETH_DBF_HEX1
c_func
(paren
l_int|0
comma
id|setup
comma
op_amp
id|card-&gt;stats
comma
r_sizeof
(paren
r_void
op_star
)paren
)paren
suffix:semicolon
id|QETH_DBF_HEX2
c_func
(paren
l_int|0
comma
id|misc
comma
op_amp
id|card-&gt;options
comma
id|QETH_DBF_MISC_LEN
)paren
suffix:semicolon
r_if
c_cond
(paren
id|qeth_determine_card_type
c_func
(paren
id|card
)paren
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;%s: not a valid card type&bslash;n&quot;
comma
id|__func__
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|qeth_insert_card_into_list
c_func
(paren
id|card
)paren
suffix:semicolon
id|qeth_correct_routing_status
c_func
(paren
id|card
)paren
suffix:semicolon
id|result
op_assign
id|qeth_init_ringbuffers1
c_func
(paren
id|card
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;%s: could not init ringbuffers1&bslash;n&quot;
comma
id|__func__
)paren
suffix:semicolon
r_goto
id|out_remove
suffix:semicolon
)brace
id|result
op_assign
id|qeth_hardsetup_card
c_func
(paren
id|card
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
r_goto
id|out_remove
suffix:semicolon
)brace
id|result
op_assign
id|qeth_init_ringbuffers2
c_func
(paren
id|card
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;%s: could not init ringbuffers2&bslash;n&quot;
comma
id|__func__
)paren
suffix:semicolon
r_goto
id|out_remove
suffix:semicolon
)brace
multiline_comment|/* this was previously done in chandev_initnetdevice */
id|snprintf
c_func
(paren
id|card-&gt;dev-&gt;name
comma
l_int|8
comma
l_string|&quot;%s%%d&quot;
comma
id|qeth_get_dev_basename
c_func
(paren
id|card-&gt;type
comma
id|card-&gt;link_type
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|qeth_init_netdev
c_func
(paren
id|card
)paren
)paren
r_goto
id|out_remove
suffix:semicolon
r_if
c_cond
(paren
id|sysfs_create_link
c_func
(paren
op_amp
id|card-&gt;gdev-&gt;dev.kobj
comma
op_amp
id|card-&gt;dev-&gt;class_dev.kobj
comma
id|card-&gt;dev_name
)paren
)paren
(brace
id|qeth_unregister_netdev
c_func
(paren
id|card
)paren
suffix:semicolon
r_goto
id|out_remove
suffix:semicolon
)brace
r_if
c_cond
(paren
id|sysfs_create_link
c_func
(paren
op_amp
id|card-&gt;dev-&gt;class_dev.kobj
comma
op_amp
id|card-&gt;gdev-&gt;dev.kobj
comma
id|CARD_BUS_ID
c_func
(paren
id|card
)paren
)paren
)paren
(brace
id|sysfs_remove_link
c_func
(paren
op_amp
id|card-&gt;gdev-&gt;dev.kobj
comma
id|card-&gt;dev_name
)paren
suffix:semicolon
id|qeth_unregister_netdev
c_func
(paren
id|card
)paren
suffix:semicolon
r_goto
id|out_remove
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
multiline_comment|/* success */
id|out_remove
suffix:colon
id|qeth_remove_card
c_func
(paren
id|card
comma
id|QETH_REMOVE_CARD_QUICK
)paren
suffix:semicolon
id|qeth_remove_card_from_list
c_func
(paren
id|card
)paren
suffix:semicolon
id|out
suffix:colon
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;freecard&quot;
)paren
suffix:semicolon
id|ccw_device_set_offline
c_func
(paren
id|CARD_DDEV
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
id|ccw_device_set_offline
c_func
(paren
id|CARD_WDEV
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
id|ccw_device_set_offline
c_func
(paren
id|CARD_RDEV
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
r_return
op_minus
id|ENODEV
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_set_online
id|qeth_set_online
c_func
(paren
r_struct
id|ccwgroup_device
op_star
id|gdev
)paren
(brace
r_int
id|rc
suffix:semicolon
r_struct
id|qeth_card
op_star
id|card
op_assign
id|gdev-&gt;dev.driver_data
suffix:semicolon
id|BUG_ON
c_func
(paren
op_logical_neg
id|card
)paren
suffix:semicolon
id|rc
op_assign
id|qeth_alloc_card_stuff
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|rc
ques
c_cond
id|rc
suffix:colon
id|qeth_activate
c_func
(paren
id|card
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_set_offline
id|qeth_set_offline
c_func
(paren
r_struct
id|ccwgroup_device
op_star
id|gdev
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|gdev-&gt;dev.driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|ENODEV
suffix:semicolon
id|qeth_remove_card
c_func
(paren
id|card
comma
id|QETH_REMOVE_CARD_PROPER
)paren
suffix:semicolon
id|qeth_remove_card_from_list
c_func
(paren
id|card
)paren
suffix:semicolon
id|QETH_DBF_TEXT4
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;freecard&quot;
)paren
suffix:semicolon
id|ccw_device_set_offline
c_func
(paren
id|CARD_DDEV
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
id|ccw_device_set_offline
c_func
(paren
id|CARD_WDEV
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
id|ccw_device_set_offline
c_func
(paren
id|CARD_RDEV
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
id|qeth_free_card_stuff
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_remove_device
id|qeth_remove_device
c_func
(paren
r_struct
id|ccwgroup_device
op_star
id|gdev
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|gdev-&gt;dev.driver_data
suffix:semicolon
r_if
c_cond
(paren
id|card
op_logical_and
id|qeth_does_card_exist
c_func
(paren
id|card
)paren
)paren
multiline_comment|/* Means that card is already in list. */
id|qeth_set_offline
c_func
(paren
id|gdev
)paren
suffix:semicolon
id|__qeth_remove_attributes
c_func
(paren
op_amp
id|gdev-&gt;dev
)paren
suffix:semicolon
id|gdev-&gt;dev.driver_data
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
id|card
)paren
id|qeth_free_card
c_func
(paren
id|card
)paren
suffix:semicolon
id|put_device
c_func
(paren
op_amp
id|gdev-&gt;dev
)paren
suffix:semicolon
)brace
DECL|variable|qeth_ccwgroup_driver
r_static
r_struct
id|ccwgroup_driver
id|qeth_ccwgroup_driver
op_assign
(brace
dot
id|name
op_assign
l_string|&quot;qeth&quot;
comma
dot
id|driver_id
op_assign
l_int|0xD8C5E3C8
comma
dot
id|probe
op_assign
id|qeth_probe_device
comma
dot
id|remove
op_assign
id|qeth_remove_device
comma
dot
id|set_online
op_assign
id|qeth_set_online
comma
dot
id|set_offline
op_assign
id|qeth_set_offline
comma
)brace
suffix:semicolon
r_static
r_int
id|__init
DECL|function|qeth_init
id|qeth_init
c_func
(paren
r_void
)paren
(brace
r_int
id|result
suffix:semicolon
id|qeth_eyecatcher
c_func
(paren
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;qeth: loading %s&bslash;n&quot;
comma
id|version
)paren
suffix:semicolon
id|result
op_assign
id|qeth_get_internal_functions
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
r_goto
id|out
suffix:semicolon
id|qeth_alloc_spare_bufs
c_func
(paren
)paren
suffix:semicolon
macro_line|#ifdef QETH_IPV6
r_if
c_cond
(paren
id|qeth_ipv6_init
c_func
(paren
)paren
)paren
(brace
id|PRINT_ERR
c_func
(paren
l_string|&quot;Out of memory during ipv6 init.&bslash;n&quot;
)paren
suffix:semicolon
r_goto
id|out_sparebufs
suffix:semicolon
)brace
macro_line|#endif /* QETH_IPV6 */
id|result
op_assign
id|qeth_register_dbf_views
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|PRINT_ERR
c_func
(paren
l_string|&quot;not enough memory for dbf. Will not load module.&bslash;n&quot;
)paren
suffix:semicolon
r_goto
id|out_ipv6
suffix:semicolon
)brace
id|result
op_assign
id|ccwgroup_driver_register
c_func
(paren
op_amp
id|qeth_ccwgroup_driver
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
r_goto
id|out_dbf
suffix:semicolon
id|result
op_assign
id|ccw_driver_register
c_func
(paren
op_amp
id|qeth_ccw_driver
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
r_goto
id|out_gdrv
suffix:semicolon
id|result
op_assign
id|driver_create_file
c_func
(paren
op_amp
id|qeth_ccwgroup_driver.driver
comma
op_amp
id|driver_attr_group
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
r_goto
id|out_cdrv
suffix:semicolon
id|qeth_root_dev
op_assign
id|s390_root_dev_register
c_func
(paren
l_string|&quot;qeth&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|IS_ERR
c_func
(paren
id|qeth_root_dev
)paren
)paren
(brace
id|result
op_assign
id|PTR_ERR
c_func
(paren
id|qeth_root_dev
)paren
suffix:semicolon
r_goto
id|out_file
suffix:semicolon
)brace
id|qeth_register_notifiers
c_func
(paren
)paren
suffix:semicolon
id|qeth_add_procfs_entries
c_func
(paren
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
id|out_file
suffix:colon
id|driver_remove_file
c_func
(paren
op_amp
id|qeth_ccwgroup_driver.driver
comma
op_amp
id|driver_attr_group
)paren
suffix:semicolon
id|out_cdrv
suffix:colon
id|ccw_driver_unregister
c_func
(paren
op_amp
id|qeth_ccw_driver
)paren
suffix:semicolon
id|out_gdrv
suffix:colon
id|ccwgroup_driver_unregister
c_func
(paren
op_amp
id|qeth_ccwgroup_driver
)paren
suffix:semicolon
id|out_dbf
suffix:colon
id|qeth_unregister_dbf_views
c_func
(paren
)paren
suffix:semicolon
id|out_ipv6
suffix:colon
macro_line|#ifdef QETH_IPV6
id|qeth_ipv6_uninit
c_func
(paren
)paren
suffix:semicolon
id|out_sparebufs
suffix:colon
macro_line|#endif /* QETH_IPV6 */
id|qeth_free_all_spare_bufs
c_func
(paren
)paren
suffix:semicolon
id|out
suffix:colon
r_return
id|result
suffix:semicolon
)brace
r_static
r_void
id|__exit
DECL|function|qeth_exit
id|qeth_exit
c_func
(paren
r_void
)paren
(brace
macro_line|#ifdef QETH_IPV6
id|qeth_ipv6_uninit
c_func
(paren
)paren
suffix:semicolon
macro_line|#endif /* QETH_IPV6 */
id|qeth_unregister_notifiers
c_func
(paren
)paren
suffix:semicolon
id|qeth_remove_procfs_entries
c_func
(paren
)paren
suffix:semicolon
id|QETH_DBF_TEXT1
c_func
(paren
l_int|0
comma
id|trace
comma
l_string|&quot;cleanup.&quot;
)paren
suffix:semicolon
id|driver_remove_file
c_func
(paren
op_amp
id|qeth_ccwgroup_driver.driver
comma
op_amp
id|driver_attr_group
)paren
suffix:semicolon
id|ccw_driver_unregister
c_func
(paren
op_amp
id|qeth_ccw_driver
)paren
suffix:semicolon
id|ccwgroup_driver_unregister
c_func
(paren
op_amp
id|qeth_ccwgroup_driver
)paren
suffix:semicolon
id|s390_root_dev_unregister
c_func
(paren
id|qeth_root_dev
)paren
suffix:semicolon
r_while
c_loop
(paren
id|firstcard
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|firstcard
suffix:semicolon
id|qeth_remove_card
c_func
(paren
id|card
comma
id|QETH_REMOVE_CARD_QUICK
)paren
suffix:semicolon
id|qeth_remove_card_from_list
c_func
(paren
id|card
)paren
suffix:semicolon
id|qeth_free_card
c_func
(paren
id|card
)paren
suffix:semicolon
)brace
id|qeth_free_all_spare_bufs
c_func
(paren
)paren
suffix:semicolon
id|qeth_unregister_dbf_views
c_func
(paren
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;qeth: %s: module removed&bslash;n&quot;
comma
id|version
)paren
suffix:semicolon
)brace
DECL|variable|qeth_eyecatcher
id|EXPORT_SYMBOL
c_func
(paren
id|qeth_eyecatcher
)paren
suffix:semicolon
DECL|variable|qeth_init
id|module_init
c_func
(paren
id|qeth_init
)paren
suffix:semicolon
DECL|variable|qeth_exit
id|module_exit
c_func
(paren
id|qeth_exit
)paren
suffix:semicolon
eof
