multiline_comment|/*&n; *&n; * linux/drivers/s390/net/qeth_fs.c ($Revision: 1.13 $)&n; *&n; * Linux on zSeries OSA Express and HiperSockets support&n; * This file contains code related to procfs.&n; *&n; * Copyright 2000,2003 IBM Corporation&n; *&n; * Author(s): Thomas Spatzier &lt;tspat@de.ibm.com&gt;&n; *&n; */
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/proc_fs.h&gt;
macro_line|#include &lt;linux/seq_file.h&gt;
macro_line|#include &lt;linux/list.h&gt;
macro_line|#include &lt;linux/rwsem.h&gt;
macro_line|#include &quot;qeth.h&quot;
macro_line|#include &quot;qeth_mpc.h&quot;
macro_line|#include &quot;qeth_fs.h&quot;
DECL|variable|VERSION_QETH_PROC_C
r_const
r_char
op_star
id|VERSION_QETH_PROC_C
op_assign
l_string|&quot;$Revision: 1.13 $&quot;
suffix:semicolon
multiline_comment|/***** /proc/qeth *****/
DECL|macro|QETH_PROCFILE_NAME
mdefine_line|#define QETH_PROCFILE_NAME &quot;qeth&quot;
DECL|variable|qeth_procfile
r_static
r_struct
id|proc_dir_entry
op_star
id|qeth_procfile
suffix:semicolon
r_static
r_void
op_star
DECL|function|qeth_procfile_seq_start
id|qeth_procfile_seq_start
c_func
(paren
r_struct
id|seq_file
op_star
id|s
comma
id|loff_t
op_star
id|offset
)paren
(brace
r_struct
id|list_head
op_star
id|next_card
op_assign
l_int|NULL
suffix:semicolon
r_int
id|i
op_assign
l_int|0
suffix:semicolon
id|down_read
c_func
(paren
op_amp
id|qeth_ccwgroup_driver.driver.bus-&gt;subsys.rwsem
)paren
suffix:semicolon
r_if
c_cond
(paren
op_star
id|offset
op_eq
l_int|0
)paren
r_return
id|SEQ_START_TOKEN
suffix:semicolon
multiline_comment|/* get card at pos *offset */
id|list_for_each
c_func
(paren
id|next_card
comma
op_amp
id|qeth_ccwgroup_driver.driver.devices
)paren
r_if
c_cond
(paren
op_increment
id|i
op_eq
op_star
id|offset
)paren
r_return
id|next_card
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_procfile_seq_stop
id|qeth_procfile_seq_stop
c_func
(paren
r_struct
id|seq_file
op_star
id|s
comma
r_void
op_star
id|it
)paren
(brace
id|up_read
c_func
(paren
op_amp
id|qeth_ccwgroup_driver.driver.bus-&gt;subsys.rwsem
)paren
suffix:semicolon
)brace
r_static
r_void
op_star
DECL|function|qeth_procfile_seq_next
id|qeth_procfile_seq_next
c_func
(paren
r_struct
id|seq_file
op_star
id|s
comma
r_void
op_star
id|it
comma
id|loff_t
op_star
id|offset
)paren
(brace
r_struct
id|list_head
op_star
id|next_card
op_assign
l_int|NULL
suffix:semicolon
r_struct
id|list_head
op_star
id|current_card
suffix:semicolon
r_if
c_cond
(paren
id|it
op_eq
id|SEQ_START_TOKEN
)paren
(brace
id|next_card
op_assign
id|qeth_ccwgroup_driver.driver.devices.next
suffix:semicolon
r_if
c_cond
(paren
id|next_card-&gt;next
op_eq
id|next_card
)paren
multiline_comment|/* list empty */
r_return
l_int|NULL
suffix:semicolon
(paren
op_star
id|offset
)paren
op_increment
suffix:semicolon
)brace
r_else
(brace
id|current_card
op_assign
(paren
r_struct
id|list_head
op_star
)paren
id|it
suffix:semicolon
r_if
c_cond
(paren
id|current_card-&gt;next
op_eq
op_amp
id|qeth_ccwgroup_driver.driver.devices
)paren
r_return
l_int|NULL
suffix:semicolon
multiline_comment|/* end of list reached */
id|next_card
op_assign
id|current_card-&gt;next
suffix:semicolon
(paren
op_star
id|offset
)paren
op_increment
suffix:semicolon
)brace
r_return
id|next_card
suffix:semicolon
)brace
r_static
r_inline
r_const
r_char
op_star
DECL|function|qeth_get_router_str
id|qeth_get_router_str
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_int
id|ipv
)paren
(brace
r_int
id|routing_type
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|ipv
op_eq
l_int|4
)paren
(brace
id|routing_type
op_assign
id|card-&gt;options.route4.type
suffix:semicolon
)brace
r_else
(brace
macro_line|#ifdef CONFIG_QETH_IPV6
id|routing_type
op_assign
id|card-&gt;options.route6.type
suffix:semicolon
macro_line|#else
r_return
l_string|&quot;n/a&quot;
suffix:semicolon
macro_line|#endif /* CONFIG_QETH_IPV6 */
)brace
r_if
c_cond
(paren
id|routing_type
op_eq
id|PRIMARY_ROUTER
)paren
r_return
l_string|&quot;pri&quot;
suffix:semicolon
r_else
r_if
c_cond
(paren
id|routing_type
op_eq
id|SECONDARY_ROUTER
)paren
r_return
l_string|&quot;sec&quot;
suffix:semicolon
r_else
r_if
c_cond
(paren
id|routing_type
op_eq
id|MULTICAST_ROUTER
)paren
(brace
r_if
c_cond
(paren
id|card-&gt;info.broadcast_capable
op_eq
id|QETH_BROADCAST_WITHOUT_ECHO
)paren
r_return
l_string|&quot;mc+&quot;
suffix:semicolon
r_return
l_string|&quot;mc&quot;
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|routing_type
op_eq
id|PRIMARY_CONNECTOR
)paren
(brace
r_if
c_cond
(paren
id|card-&gt;info.broadcast_capable
op_eq
id|QETH_BROADCAST_WITHOUT_ECHO
)paren
r_return
l_string|&quot;p+c&quot;
suffix:semicolon
r_return
l_string|&quot;p.c&quot;
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|routing_type
op_eq
id|SECONDARY_CONNECTOR
)paren
(brace
r_if
c_cond
(paren
id|card-&gt;info.broadcast_capable
op_eq
id|QETH_BROADCAST_WITHOUT_ECHO
)paren
r_return
l_string|&quot;s+c&quot;
suffix:semicolon
r_return
l_string|&quot;s.c&quot;
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|routing_type
op_eq
id|NO_ROUTER
)paren
r_return
l_string|&quot;no&quot;
suffix:semicolon
r_else
r_return
l_string|&quot;unk&quot;
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_procfile_seq_show
id|qeth_procfile_seq_show
c_func
(paren
r_struct
id|seq_file
op_star
id|s
comma
r_void
op_star
id|it
)paren
(brace
r_struct
id|device
op_star
id|device
suffix:semicolon
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
r_char
id|tmp
(braket
l_int|12
)braket
suffix:semicolon
multiline_comment|/* for qeth_get_prioq_str */
r_if
c_cond
(paren
id|it
op_eq
id|SEQ_START_TOKEN
)paren
(brace
id|seq_printf
c_func
(paren
id|s
comma
l_string|&quot;devices                    CHPID interface  &quot;
l_string|&quot;cardtype       port chksum prio-q&squot;ing rtr4 &quot;
l_string|&quot;rtr6 fsz   cnt&bslash;n&quot;
)paren
suffix:semicolon
id|seq_printf
c_func
(paren
id|s
comma
l_string|&quot;-------------------------- ----- ---------- &quot;
l_string|&quot;-------------- ---- ------ ---------- ---- &quot;
l_string|&quot;---- ----- -----&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|device
op_assign
id|list_entry
c_func
(paren
id|it
comma
r_struct
id|device
comma
id|driver_list
)paren
suffix:semicolon
id|card
op_assign
id|device-&gt;driver_data
suffix:semicolon
id|seq_printf
c_func
(paren
id|s
comma
l_string|&quot;%s/%s/%s x%02X   %-10s %-14s %-4i &quot;
comma
id|CARD_RDEV_ID
c_func
(paren
id|card
)paren
comma
id|CARD_WDEV_ID
c_func
(paren
id|card
)paren
comma
id|CARD_DDEV_ID
c_func
(paren
id|card
)paren
comma
id|card-&gt;info.chpid
comma
id|QETH_CARD_IFNAME
c_func
(paren
id|card
)paren
comma
id|qeth_get_cardname_short
c_func
(paren
id|card
)paren
comma
id|card-&gt;info.portno
)paren
suffix:semicolon
r_if
c_cond
(paren
id|card-&gt;lan_online
)paren
id|seq_printf
c_func
(paren
id|s
comma
l_string|&quot;%-6s %-10s %-4s %-4s %-5s %-5i&bslash;n&quot;
comma
id|qeth_get_checksum_str
c_func
(paren
id|card
)paren
comma
id|qeth_get_prioq_str
c_func
(paren
id|card
comma
id|tmp
)paren
comma
id|qeth_get_router_str
c_func
(paren
id|card
comma
l_int|4
)paren
comma
id|qeth_get_router_str
c_func
(paren
id|card
comma
l_int|6
)paren
comma
id|qeth_get_bufsize_str
c_func
(paren
id|card
)paren
comma
id|card-&gt;qdio.in_buf_pool.buf_count
)paren
suffix:semicolon
r_else
id|seq_printf
c_func
(paren
id|s
comma
l_string|&quot;  +++ LAN OFFLINE +++&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|qeth_procfile_seq_ops
r_static
r_struct
id|seq_operations
id|qeth_procfile_seq_ops
op_assign
(brace
dot
id|start
op_assign
id|qeth_procfile_seq_start
comma
dot
id|stop
op_assign
id|qeth_procfile_seq_stop
comma
dot
id|next
op_assign
id|qeth_procfile_seq_next
comma
dot
id|show
op_assign
id|qeth_procfile_seq_show
comma
)brace
suffix:semicolon
r_static
r_int
DECL|function|qeth_procfile_open
id|qeth_procfile_open
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_return
id|seq_open
c_func
(paren
id|file
comma
op_amp
id|qeth_procfile_seq_ops
)paren
suffix:semicolon
)brace
DECL|variable|qeth_procfile_fops
r_static
r_struct
id|file_operations
id|qeth_procfile_fops
op_assign
(brace
dot
id|owner
op_assign
id|THIS_MODULE
comma
dot
id|open
op_assign
id|qeth_procfile_open
comma
dot
id|read
op_assign
id|seq_read
comma
dot
id|llseek
op_assign
id|seq_lseek
comma
dot
id|release
op_assign
id|seq_release
comma
)brace
suffix:semicolon
multiline_comment|/***** /proc/qeth_perf *****/
DECL|macro|QETH_PERF_PROCFILE_NAME
mdefine_line|#define QETH_PERF_PROCFILE_NAME &quot;qeth_perf&quot;
DECL|variable|qeth_perf_procfile
r_static
r_struct
id|proc_dir_entry
op_star
id|qeth_perf_procfile
suffix:semicolon
macro_line|#ifdef CONFIG_QETH_PERF_STATS
r_static
r_void
op_star
DECL|function|qeth_perf_procfile_seq_start
id|qeth_perf_procfile_seq_start
c_func
(paren
r_struct
id|seq_file
op_star
id|s
comma
id|loff_t
op_star
id|offset
)paren
(brace
r_struct
id|list_head
op_star
id|next_card
op_assign
l_int|NULL
suffix:semicolon
r_int
id|i
op_assign
l_int|0
suffix:semicolon
id|down_read
c_func
(paren
op_amp
id|qeth_ccwgroup_driver.driver.bus-&gt;subsys.rwsem
)paren
suffix:semicolon
multiline_comment|/* get card at pos *offset */
(def_block
id|list_for_each
c_func
(paren
id|next_card
comma
op_amp
id|qeth_ccwgroup_driver.driver.devices
)paren
(brace
r_if
c_cond
(paren
id|i
op_eq
op_star
id|offset
)paren
r_return
id|next_card
suffix:semicolon
id|i
op_increment
suffix:semicolon
)brace
)def_block
r_return
l_int|NULL
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_perf_procfile_seq_stop
id|qeth_perf_procfile_seq_stop
c_func
(paren
r_struct
id|seq_file
op_star
id|s
comma
r_void
op_star
id|it
)paren
(brace
id|up_read
c_func
(paren
op_amp
id|qeth_ccwgroup_driver.driver.bus-&gt;subsys.rwsem
)paren
suffix:semicolon
)brace
r_static
r_void
op_star
DECL|function|qeth_perf_procfile_seq_next
id|qeth_perf_procfile_seq_next
c_func
(paren
r_struct
id|seq_file
op_star
id|s
comma
r_void
op_star
id|it
comma
id|loff_t
op_star
id|offset
)paren
(brace
r_struct
id|list_head
op_star
id|current_card
op_assign
(paren
r_struct
id|list_head
op_star
)paren
id|it
suffix:semicolon
r_if
c_cond
(paren
id|current_card-&gt;next
op_eq
op_amp
id|qeth_ccwgroup_driver.driver.devices
)paren
r_return
l_int|NULL
suffix:semicolon
multiline_comment|/* end of list reached */
(paren
op_star
id|offset
)paren
op_increment
suffix:semicolon
r_return
id|current_card-&gt;next
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_perf_procfile_seq_show
id|qeth_perf_procfile_seq_show
c_func
(paren
r_struct
id|seq_file
op_star
id|s
comma
r_void
op_star
id|it
)paren
(brace
r_struct
id|device
op_star
id|device
suffix:semicolon
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
id|device
op_assign
id|list_entry
c_func
(paren
id|it
comma
r_struct
id|device
comma
id|driver_list
)paren
suffix:semicolon
id|card
op_assign
id|device-&gt;driver_data
suffix:semicolon
id|seq_printf
c_func
(paren
id|s
comma
l_string|&quot;For card with devnos %s/%s/%s (%s):&bslash;n&quot;
comma
id|CARD_RDEV_ID
c_func
(paren
id|card
)paren
comma
id|CARD_WDEV_ID
c_func
(paren
id|card
)paren
comma
id|CARD_DDEV_ID
c_func
(paren
id|card
)paren
comma
id|QETH_CARD_IFNAME
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
id|seq_printf
c_func
(paren
id|s
comma
l_string|&quot;  Skb&squot;s/buffers received                 : %li/%i&bslash;n&quot;
l_string|&quot;  Skb&squot;s/buffers sent                     : %li/%i&bslash;n&bslash;n&quot;
comma
id|card-&gt;stats.rx_packets
comma
id|card-&gt;perf_stats.bufs_rec
comma
id|card-&gt;stats.tx_packets
comma
id|card-&gt;perf_stats.bufs_sent
)paren
suffix:semicolon
id|seq_printf
c_func
(paren
id|s
comma
l_string|&quot;  Skb&squot;s/buffers sent without packing     : %li/%i&bslash;n&quot;
l_string|&quot;  Skb&squot;s/buffers sent with packing        : %i/%i&bslash;n&bslash;n&quot;
comma
id|card-&gt;stats.tx_packets
op_minus
id|card-&gt;perf_stats.skbs_sent_pack
comma
id|card-&gt;perf_stats.bufs_sent
op_minus
id|card-&gt;perf_stats.bufs_sent_pack
comma
id|card-&gt;perf_stats.skbs_sent_pack
comma
id|card-&gt;perf_stats.bufs_sent_pack
)paren
suffix:semicolon
id|seq_printf
c_func
(paren
id|s
comma
l_string|&quot;  Packing state changes no pkg.-&gt;packing : %i/%i&bslash;n&quot;
l_string|&quot;  Watermarks L/H                         : %i/%i&bslash;n&quot;
l_string|&quot;  Current buffer usage (outbound q&squot;s)    : &quot;
l_string|&quot;%i/%i/%i/%i&bslash;n&bslash;n&quot;
comma
id|card-&gt;perf_stats.sc_dp_p
comma
id|card-&gt;perf_stats.sc_p_dp
comma
id|QETH_LOW_WATERMARK_PACK
comma
id|QETH_HIGH_WATERMARK_PACK
comma
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;qdio.out_qs
(braket
l_int|0
)braket
op_member_access_from_pointer
id|used_buffers
)paren
comma
(paren
id|card-&gt;qdio.no_out_queues
OG
l_int|1
)paren
ques
c_cond
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;qdio.out_qs
(braket
l_int|1
)braket
op_member_access_from_pointer
id|used_buffers
)paren
suffix:colon
l_int|0
comma
(paren
id|card-&gt;qdio.no_out_queues
OG
l_int|2
)paren
ques
c_cond
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;qdio.out_qs
(braket
l_int|2
)braket
op_member_access_from_pointer
id|used_buffers
)paren
suffix:colon
l_int|0
comma
(paren
id|card-&gt;qdio.no_out_queues
OG
l_int|3
)paren
ques
c_cond
id|atomic_read
c_func
(paren
op_amp
id|card-&gt;qdio.out_qs
(braket
l_int|3
)braket
op_member_access_from_pointer
id|used_buffers
)paren
suffix:colon
l_int|0
)paren
suffix:semicolon
id|seq_printf
c_func
(paren
id|s
comma
l_string|&quot;  Inbound handler time (in us)           : %i&bslash;n&quot;
l_string|&quot;  Inbound handler count                  : %i&bslash;n&quot;
l_string|&quot;  Inbound do_QDIO time (in us)           : %i&bslash;n&quot;
l_string|&quot;  Inbound do_QDIO count                  : %i&bslash;n&bslash;n&quot;
l_string|&quot;  Outbound handler time (in us)          : %i&bslash;n&quot;
l_string|&quot;  Outbound handler count                 : %i&bslash;n&bslash;n&quot;
l_string|&quot;  Outbound time (in us, incl QDIO)       : %i&bslash;n&quot;
l_string|&quot;  Outbound count                         : %i&bslash;n&quot;
l_string|&quot;  Outbound do_QDIO time (in us)          : %i&bslash;n&quot;
l_string|&quot;  Outbound do_QDIO count                 : %i&bslash;n&quot;
comma
id|card-&gt;perf_stats.inbound_time
comma
id|card-&gt;perf_stats.inbound_cnt
comma
id|card-&gt;perf_stats.inbound_do_qdio_time
comma
id|card-&gt;perf_stats.inbound_do_qdio_cnt
comma
id|card-&gt;perf_stats.outbound_handler_time
comma
id|card-&gt;perf_stats.outbound_handler_cnt
comma
id|card-&gt;perf_stats.outbound_time
comma
id|card-&gt;perf_stats.outbound_cnt
comma
id|card-&gt;perf_stats.outbound_do_qdio_time
comma
id|card-&gt;perf_stats.outbound_do_qdio_cnt
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|qeth_perf_procfile_seq_ops
r_static
r_struct
id|seq_operations
id|qeth_perf_procfile_seq_ops
op_assign
(brace
dot
id|start
op_assign
id|qeth_perf_procfile_seq_start
comma
dot
id|stop
op_assign
id|qeth_perf_procfile_seq_stop
comma
dot
id|next
op_assign
id|qeth_perf_procfile_seq_next
comma
dot
id|show
op_assign
id|qeth_perf_procfile_seq_show
comma
)brace
suffix:semicolon
r_static
r_int
DECL|function|qeth_perf_procfile_open
id|qeth_perf_procfile_open
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_return
id|seq_open
c_func
(paren
id|file
comma
op_amp
id|qeth_perf_procfile_seq_ops
)paren
suffix:semicolon
)brace
DECL|variable|qeth_perf_procfile_fops
r_static
r_struct
id|file_operations
id|qeth_perf_procfile_fops
op_assign
(brace
dot
id|owner
op_assign
id|THIS_MODULE
comma
dot
id|open
op_assign
id|qeth_perf_procfile_open
comma
dot
id|read
op_assign
id|seq_read
comma
dot
id|llseek
op_assign
id|seq_lseek
comma
dot
id|release
op_assign
id|seq_release
comma
)brace
suffix:semicolon
DECL|macro|qeth_perf_procfile_created
mdefine_line|#define qeth_perf_procfile_created qeth_perf_procfile
macro_line|#else
DECL|macro|qeth_perf_procfile_created
mdefine_line|#define qeth_perf_procfile_created 1
macro_line|#endif /* CONFIG_QETH_PERF_STATS */
multiline_comment|/***** /proc/qeth_ipa_takeover *****/
DECL|macro|QETH_IPATO_PROCFILE_NAME
mdefine_line|#define QETH_IPATO_PROCFILE_NAME &quot;qeth_ipa_takeover&quot;
DECL|variable|qeth_ipato_procfile
r_static
r_struct
id|proc_dir_entry
op_star
id|qeth_ipato_procfile
suffix:semicolon
r_static
r_void
op_star
DECL|function|qeth_ipato_procfile_seq_start
id|qeth_ipato_procfile_seq_start
c_func
(paren
r_struct
id|seq_file
op_star
id|s
comma
id|loff_t
op_star
id|offset
)paren
(brace
r_struct
id|list_head
op_star
id|next_card
op_assign
l_int|NULL
suffix:semicolon
r_int
id|i
op_assign
l_int|0
suffix:semicolon
id|down_read
c_func
(paren
op_amp
id|qeth_ccwgroup_driver.driver.bus-&gt;subsys.rwsem
)paren
suffix:semicolon
multiline_comment|/* TODO: finish this */
multiline_comment|/*&n;&t; * maybe SEQ_SATRT_TOKEN can be returned for offset 0&n;&t; * output driver settings then;&n;&t; * else output setting for respective card&n;&t; */
multiline_comment|/* get card at pos *offset */
(def_block
id|list_for_each
c_func
(paren
id|next_card
comma
op_amp
id|qeth_ccwgroup_driver.driver.devices
)paren
(brace
r_if
c_cond
(paren
id|i
op_eq
op_star
id|offset
)paren
r_return
id|next_card
suffix:semicolon
id|i
op_increment
suffix:semicolon
)brace
)def_block
r_return
l_int|NULL
suffix:semicolon
)brace
r_static
r_void
DECL|function|qeth_ipato_procfile_seq_stop
id|qeth_ipato_procfile_seq_stop
c_func
(paren
r_struct
id|seq_file
op_star
id|s
comma
r_void
op_star
id|it
)paren
(brace
id|up_read
c_func
(paren
op_amp
id|qeth_ccwgroup_driver.driver.bus-&gt;subsys.rwsem
)paren
suffix:semicolon
)brace
r_static
r_void
op_star
DECL|function|qeth_ipato_procfile_seq_next
id|qeth_ipato_procfile_seq_next
c_func
(paren
r_struct
id|seq_file
op_star
id|s
comma
r_void
op_star
id|it
comma
id|loff_t
op_star
id|offset
)paren
(brace
r_struct
id|list_head
op_star
id|current_card
op_assign
(paren
r_struct
id|list_head
op_star
)paren
id|it
suffix:semicolon
multiline_comment|/* TODO: finish this */
multiline_comment|/*&n;&t; * maybe SEQ_SATRT_TOKEN can be returned for offset 0&n;&t; * output driver settings then;&n;&t; * else output setting for respective card&n;&t; */
r_if
c_cond
(paren
id|current_card-&gt;next
op_eq
op_amp
id|qeth_ccwgroup_driver.driver.devices
)paren
r_return
l_int|NULL
suffix:semicolon
multiline_comment|/* end of list reached */
(paren
op_star
id|offset
)paren
op_increment
suffix:semicolon
r_return
id|current_card-&gt;next
suffix:semicolon
)brace
r_static
r_int
DECL|function|qeth_ipato_procfile_seq_show
id|qeth_ipato_procfile_seq_show
c_func
(paren
r_struct
id|seq_file
op_star
id|s
comma
r_void
op_star
id|it
)paren
(brace
r_struct
id|device
op_star
id|device
suffix:semicolon
r_struct
id|qeth_card
op_star
id|card
suffix:semicolon
multiline_comment|/* TODO: finish this */
multiline_comment|/*&n;&t; * maybe SEQ_SATRT_TOKEN can be returned for offset 0&n;&t; * output driver settings then;&n;&t; * else output setting for respective card&n;&t; */
id|device
op_assign
id|list_entry
c_func
(paren
id|it
comma
r_struct
id|device
comma
id|driver_list
)paren
suffix:semicolon
id|card
op_assign
id|device-&gt;driver_data
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|qeth_ipato_procfile_seq_ops
r_static
r_struct
id|seq_operations
id|qeth_ipato_procfile_seq_ops
op_assign
(brace
dot
id|start
op_assign
id|qeth_ipato_procfile_seq_start
comma
dot
id|stop
op_assign
id|qeth_ipato_procfile_seq_stop
comma
dot
id|next
op_assign
id|qeth_ipato_procfile_seq_next
comma
dot
id|show
op_assign
id|qeth_ipato_procfile_seq_show
comma
)brace
suffix:semicolon
r_static
r_int
DECL|function|qeth_ipato_procfile_open
id|qeth_ipato_procfile_open
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_return
id|seq_open
c_func
(paren
id|file
comma
op_amp
id|qeth_ipato_procfile_seq_ops
)paren
suffix:semicolon
)brace
DECL|variable|qeth_ipato_procfile_fops
r_static
r_struct
id|file_operations
id|qeth_ipato_procfile_fops
op_assign
(brace
dot
id|owner
op_assign
id|THIS_MODULE
comma
dot
id|open
op_assign
id|qeth_ipato_procfile_open
comma
dot
id|read
op_assign
id|seq_read
comma
dot
id|llseek
op_assign
id|seq_lseek
comma
dot
id|release
op_assign
id|seq_release
comma
)brace
suffix:semicolon
r_int
id|__init
DECL|function|qeth_create_procfs_entries
id|qeth_create_procfs_entries
c_func
(paren
r_void
)paren
(brace
id|qeth_procfile
op_assign
id|create_proc_entry
c_func
(paren
id|QETH_PROCFILE_NAME
comma
id|S_IFREG
op_or
l_int|0444
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|qeth_procfile
)paren
id|qeth_procfile-&gt;proc_fops
op_assign
op_amp
id|qeth_procfile_fops
suffix:semicolon
macro_line|#ifdef CONFIG_QETH_PERF_STATS
id|qeth_perf_procfile
op_assign
id|create_proc_entry
c_func
(paren
id|QETH_PERF_PROCFILE_NAME
comma
id|S_IFREG
op_or
l_int|0444
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|qeth_perf_procfile
)paren
id|qeth_perf_procfile-&gt;proc_fops
op_assign
op_amp
id|qeth_perf_procfile_fops
suffix:semicolon
macro_line|#endif /* CONFIG_QETH_PERF_STATS */
id|qeth_ipato_procfile
op_assign
id|create_proc_entry
c_func
(paren
id|QETH_IPATO_PROCFILE_NAME
comma
id|S_IFREG
op_or
l_int|0444
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|qeth_ipato_procfile
)paren
id|qeth_ipato_procfile-&gt;proc_fops
op_assign
op_amp
id|qeth_ipato_procfile_fops
suffix:semicolon
r_if
c_cond
(paren
id|qeth_procfile
op_logical_and
id|qeth_ipato_procfile
op_logical_and
id|qeth_perf_procfile_created
)paren
r_return
l_int|0
suffix:semicolon
r_else
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
r_void
id|__exit
DECL|function|qeth_remove_procfs_entries
id|qeth_remove_procfs_entries
c_func
(paren
r_void
)paren
(brace
r_if
c_cond
(paren
id|qeth_procfile
)paren
id|remove_proc_entry
c_func
(paren
id|QETH_PROCFILE_NAME
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|qeth_perf_procfile
)paren
id|remove_proc_entry
c_func
(paren
id|QETH_PERF_PROCFILE_NAME
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|qeth_ipato_procfile
)paren
id|remove_proc_entry
c_func
(paren
id|QETH_IPATO_PROCFILE_NAME
comma
l_int|NULL
)paren
suffix:semicolon
)brace
multiline_comment|/* ONLY FOR DEVELOPMENT! -&gt; make it as module */
multiline_comment|/*&n;static void&n;qeth_create_sysfs_entries(void)&n;{&n;&t;struct device *dev;&n;&n;&t;down_read(&amp;qeth_ccwgroup_driver.driver.bus-&gt;subsys.rwsem);&n;&n;&t;list_for_each_entry(dev, &amp;qeth_ccwgroup_driver.driver.devices,&n;&t;&t;&t;driver_list)&n;&t;&t;qeth_create_device_attributes(dev);&n;&n;&t;up_read(&amp;qeth_ccwgroup_driver.driver.bus-&gt;subsys.rwsem);&n;}&n;&n;static void&n;qeth_remove_sysfs_entries(void)&n;{&n;&t;struct device *dev;&n;&n;&t;down_read(&amp;qeth_ccwgroup_driver.driver.bus-&gt;subsys.rwsem);&n;&n;&t;list_for_each_entry(dev, &amp;qeth_ccwgroup_driver.driver.devices,&n;&t;&t;&t;driver_list)&n;&t;&t;qeth_remove_device_attributes(dev);&n;&n;&t;up_read(&amp;qeth_ccwgroup_driver.driver.bus-&gt;subsys.rwsem);&n;}&n;&n;static int __init&n;qeth_fs_init(void)&n;{&n;&t;printk(KERN_INFO &quot;qeth_fs_init&bslash;n&quot;);&n;&t;qeth_create_procfs_entries();&n;&t;qeth_create_sysfs_entries();&n;&n;&t;return 0;&n;}&n;&n;static void __exit&n;qeth_fs_exit(void)&n;{&n;&t;printk(KERN_INFO &quot;qeth_fs_exit&bslash;n&quot;);&n;&t;qeth_remove_procfs_entries();&n;&t;qeth_remove_sysfs_entries();&n;}&n;&n;&n;module_init(qeth_fs_init);&n;module_exit(qeth_fs_exit);&n;&n;MODULE_LICENSE(&quot;GPL&quot;);&n;*/
eof
