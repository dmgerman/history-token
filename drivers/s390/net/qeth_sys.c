multiline_comment|/*&n; *&n; * linux/drivers/s390/net/qeth_sys.c ($Revision: 1.49 $)&n; *&n; * Linux on zSeries OSA Express and HiperSockets support&n; * This file contains code related to sysfs.&n; *&n; * Copyright 2000,2003 IBM Corporation&n; *&n; * Author(s): Thomas Spatzier &lt;tspat@de.ibm.com&gt;&n; * &t;      Frank Pavlic &lt;pavlic@de.ibm.com&gt;&n; *&n; */
macro_line|#include &lt;linux/list.h&gt;
macro_line|#include &lt;linux/rwsem.h&gt;
macro_line|#include &lt;asm/ebcdic.h&gt;
macro_line|#include &quot;qeth.h&quot;
macro_line|#include &quot;qeth_mpc.h&quot;
macro_line|#include &quot;qeth_fs.h&quot;
DECL|variable|VERSION_QETH_SYS_C
r_const
r_char
op_star
id|VERSION_QETH_SYS_C
op_assign
l_string|&quot;$Revision: 1.49 $&quot;
suffix:semicolon
multiline_comment|/*****************************************************************************/
multiline_comment|/*                                                                           */
multiline_comment|/*          /sys-fs stuff UNDER DEVELOPMENT !!!                              */
multiline_comment|/*                                                                           */
multiline_comment|/*****************************************************************************/
singleline_comment|//low/high watermark
r_static
id|ssize_t
DECL|function|qeth_dev_state_show
id|qeth_dev_state_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_switch
c_cond
(paren
id|card-&gt;state
)paren
(brace
r_case
id|CARD_STATE_DOWN
suffix:colon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;DOWN&bslash;n&quot;
)paren
suffix:semicolon
r_case
id|CARD_STATE_HARDSETUP
suffix:colon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;HARDSETUP&bslash;n&quot;
)paren
suffix:semicolon
r_case
id|CARD_STATE_SOFTSETUP
suffix:colon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;SOFTSETUP&bslash;n&quot;
)paren
suffix:semicolon
r_case
id|CARD_STATE_UP
suffix:colon
r_if
c_cond
(paren
id|card-&gt;lan_online
)paren
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;UP (LAN ONLINE)&bslash;n&quot;
)paren
suffix:semicolon
r_else
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;UP (LAN OFFLINE)&bslash;n&quot;
)paren
suffix:semicolon
r_case
id|CARD_STATE_RECOVER
suffix:colon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;RECOVER&bslash;n&quot;
)paren
suffix:semicolon
r_default
suffix:colon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;UNKNOWN&bslash;n&quot;
)paren
suffix:semicolon
)brace
)brace
r_static
id|DEVICE_ATTR
c_func
(paren
id|state
comma
l_int|0444
comma
id|qeth_dev_state_show
comma
l_int|NULL
)paren
suffix:semicolon
r_static
id|ssize_t
DECL|function|qeth_dev_chpid_show
id|qeth_dev_chpid_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%02X&bslash;n&quot;
comma
id|card-&gt;info.chpid
)paren
suffix:semicolon
)brace
r_static
id|DEVICE_ATTR
c_func
(paren
id|chpid
comma
l_int|0444
comma
id|qeth_dev_chpid_show
comma
l_int|NULL
)paren
suffix:semicolon
r_static
id|ssize_t
DECL|function|qeth_dev_if_name_show
id|qeth_dev_if_name_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
id|QETH_CARD_IFNAME
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
)brace
r_static
id|DEVICE_ATTR
c_func
(paren
id|if_name
comma
l_int|0444
comma
id|qeth_dev_if_name_show
comma
l_int|NULL
)paren
suffix:semicolon
r_static
id|ssize_t
DECL|function|qeth_dev_card_type_show
id|qeth_dev_card_type_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
id|qeth_get_cardname_short
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
)brace
r_static
id|DEVICE_ATTR
c_func
(paren
id|card_type
comma
l_int|0444
comma
id|qeth_dev_card_type_show
comma
l_int|NULL
)paren
suffix:semicolon
r_static
id|ssize_t
DECL|function|qeth_dev_portno_show
id|qeth_dev_portno_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%i&bslash;n&quot;
comma
id|card-&gt;info.portno
)paren
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_dev_portno_store
id|qeth_dev_portno_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_char
op_star
id|tmp
suffix:semicolon
r_int
r_int
id|portno
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
(paren
id|card-&gt;state
op_ne
id|CARD_STATE_DOWN
)paren
op_logical_and
(paren
id|card-&gt;state
op_ne
id|CARD_STATE_RECOVER
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
id|portno
op_assign
id|simple_strtoul
c_func
(paren
id|buf
comma
op_amp
id|tmp
comma
l_int|16
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|portno
OL
l_int|0
)paren
op_logical_or
(paren
id|portno
OG
id|MAX_PORTNO
)paren
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;portno 0x%X is out of range&bslash;n&quot;
comma
id|portno
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|card-&gt;info.portno
op_assign
id|portno
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
r_static
id|DEVICE_ATTR
c_func
(paren
id|portno
comma
l_int|0644
comma
id|qeth_dev_portno_show
comma
id|qeth_dev_portno_store
)paren
suffix:semicolon
r_static
id|ssize_t
DECL|function|qeth_dev_portname_show
id|qeth_dev_portname_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_char
id|portname
(braket
l_int|9
)braket
op_assign
(brace
l_int|0
comma
)brace
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|card-&gt;info.portname_required
)paren
(brace
id|memcpy
c_func
(paren
id|portname
comma
id|card-&gt;info.portname
op_plus
l_int|1
comma
l_int|8
)paren
suffix:semicolon
id|EBCASC
c_func
(paren
id|portname
comma
l_int|8
)paren
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
id|portname
)paren
suffix:semicolon
)brace
r_else
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;no portname required&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_dev_portname_store
id|qeth_dev_portname_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_char
op_star
id|tmp
suffix:semicolon
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
(paren
id|card-&gt;state
op_ne
id|CARD_STATE_DOWN
)paren
op_logical_and
(paren
id|card-&gt;state
op_ne
id|CARD_STATE_RECOVER
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
id|tmp
op_assign
id|strsep
c_func
(paren
(paren
r_char
op_star
op_star
)paren
op_amp
id|buf
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|strlen
c_func
(paren
id|tmp
)paren
OG
l_int|8
)paren
op_logical_or
(paren
id|strlen
c_func
(paren
id|tmp
)paren
OL
l_int|2
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|card-&gt;info.portname
(braket
l_int|0
)braket
op_assign
id|strlen
c_func
(paren
id|tmp
)paren
suffix:semicolon
multiline_comment|/* for beauty reasons */
r_for
c_loop
(paren
id|i
op_assign
l_int|1
suffix:semicolon
id|i
OL
l_int|9
suffix:semicolon
id|i
op_increment
)paren
id|card-&gt;info.portname
(braket
id|i
)braket
op_assign
l_char|&squot; &squot;
suffix:semicolon
id|strcpy
c_func
(paren
id|card-&gt;info.portname
op_plus
l_int|1
comma
id|tmp
)paren
suffix:semicolon
id|ASCEBC
c_func
(paren
id|card-&gt;info.portname
op_plus
l_int|1
comma
l_int|8
)paren
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
r_static
id|DEVICE_ATTR
c_func
(paren
id|portname
comma
l_int|0644
comma
id|qeth_dev_portname_show
comma
id|qeth_dev_portname_store
)paren
suffix:semicolon
r_static
id|ssize_t
DECL|function|qeth_dev_checksum_show
id|qeth_dev_checksum_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s checksumming&bslash;n&quot;
comma
id|qeth_get_checksum_str
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_dev_checksum_store
id|qeth_dev_checksum_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_char
op_star
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
(paren
id|card-&gt;state
op_ne
id|CARD_STATE_DOWN
)paren
op_logical_and
(paren
id|card-&gt;state
op_ne
id|CARD_STATE_RECOVER
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
id|tmp
op_assign
id|strsep
c_func
(paren
(paren
r_char
op_star
op_star
)paren
op_amp
id|buf
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|tmp
comma
l_string|&quot;sw_checksumming&quot;
)paren
)paren
id|card-&gt;options.checksum_type
op_assign
id|SW_CHECKSUMMING
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|tmp
comma
l_string|&quot;hw_checksumming&quot;
)paren
)paren
id|card-&gt;options.checksum_type
op_assign
id|HW_CHECKSUMMING
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|tmp
comma
l_string|&quot;no_checksumming&quot;
)paren
)paren
id|card-&gt;options.checksum_type
op_assign
id|NO_CHECKSUMMING
suffix:semicolon
r_else
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;Unknown checksumming type &squot;%s&squot;&bslash;n&quot;
comma
id|tmp
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_return
id|count
suffix:semicolon
)brace
r_static
id|DEVICE_ATTR
c_func
(paren
id|checksumming
comma
l_int|0644
comma
id|qeth_dev_checksum_show
comma
id|qeth_dev_checksum_store
)paren
suffix:semicolon
r_static
id|ssize_t
DECL|function|qeth_dev_prioqing_show
id|qeth_dev_prioqing_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_switch
c_cond
(paren
id|card-&gt;qdio.do_prio_queueing
)paren
(brace
r_case
id|QETH_PRIO_Q_ING_PREC
suffix:colon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
l_string|&quot;by precedence&quot;
)paren
suffix:semicolon
r_case
id|QETH_PRIO_Q_ING_TOS
suffix:colon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
l_string|&quot;by type of service&quot;
)paren
suffix:semicolon
r_default
suffix:colon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;always queue %i&bslash;n&quot;
comma
id|card-&gt;qdio.default_out_queue
)paren
suffix:semicolon
)brace
)brace
r_static
id|ssize_t
DECL|function|qeth_dev_prioqing_store
id|qeth_dev_prioqing_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_char
op_star
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
(paren
id|card-&gt;state
op_ne
id|CARD_STATE_DOWN
)paren
op_logical_and
(paren
id|card-&gt;state
op_ne
id|CARD_STATE_RECOVER
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
id|tmp
op_assign
id|strsep
c_func
(paren
(paren
r_char
op_star
op_star
)paren
op_amp
id|buf
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|tmp
comma
l_string|&quot;prio_queueing_prec&quot;
)paren
)paren
id|card-&gt;qdio.do_prio_queueing
op_assign
id|QETH_PRIO_Q_ING_PREC
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|tmp
comma
l_string|&quot;prio_queueing_tos&quot;
)paren
)paren
id|card-&gt;qdio.do_prio_queueing
op_assign
id|QETH_PRIO_Q_ING_TOS
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|tmp
comma
l_string|&quot;no_prio_queueing:0&quot;
)paren
)paren
(brace
id|card-&gt;qdio.do_prio_queueing
op_assign
id|QETH_NO_PRIO_QUEUEING
suffix:semicolon
id|card-&gt;qdio.default_out_queue
op_assign
l_int|0
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|tmp
comma
l_string|&quot;no_prio_queueing:1&quot;
)paren
)paren
(brace
id|card-&gt;qdio.do_prio_queueing
op_assign
id|QETH_NO_PRIO_QUEUEING
suffix:semicolon
id|card-&gt;qdio.default_out_queue
op_assign
l_int|1
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|tmp
comma
l_string|&quot;no_prio_queueing:2&quot;
)paren
)paren
(brace
id|card-&gt;qdio.do_prio_queueing
op_assign
id|QETH_NO_PRIO_QUEUEING
suffix:semicolon
id|card-&gt;qdio.default_out_queue
op_assign
l_int|2
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|tmp
comma
l_string|&quot;no_prio_queueing:3&quot;
)paren
)paren
(brace
id|card-&gt;qdio.do_prio_queueing
op_assign
id|QETH_NO_PRIO_QUEUEING
suffix:semicolon
id|card-&gt;qdio.default_out_queue
op_assign
l_int|3
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|tmp
comma
l_string|&quot;no_prio_queueing&quot;
)paren
)paren
(brace
id|card-&gt;qdio.do_prio_queueing
op_assign
id|QETH_NO_PRIO_QUEUEING
suffix:semicolon
id|card-&gt;qdio.default_out_queue
op_assign
id|QETH_DEFAULT_QUEUE
suffix:semicolon
)brace
r_else
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;Unknown queueing type &squot;%s&squot;&bslash;n&quot;
comma
id|tmp
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_return
id|count
suffix:semicolon
)brace
r_static
id|DEVICE_ATTR
c_func
(paren
id|priority_queueing
comma
l_int|0644
comma
id|qeth_dev_prioqing_show
comma
id|qeth_dev_prioqing_store
)paren
suffix:semicolon
r_static
id|ssize_t
DECL|function|qeth_dev_bufcnt_show
id|qeth_dev_bufcnt_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%i&bslash;n&quot;
comma
id|card-&gt;qdio.in_buf_pool.buf_count
)paren
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_dev_bufcnt_store
id|qeth_dev_bufcnt_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_char
op_star
id|tmp
suffix:semicolon
r_int
id|cnt
comma
id|old_cnt
suffix:semicolon
r_int
id|rc
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
(paren
id|card-&gt;state
op_ne
id|CARD_STATE_DOWN
)paren
op_logical_and
(paren
id|card-&gt;state
op_ne
id|CARD_STATE_RECOVER
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
id|old_cnt
op_assign
id|card-&gt;qdio.in_buf_pool.buf_count
suffix:semicolon
id|cnt
op_assign
id|simple_strtoul
c_func
(paren
id|buf
comma
op_amp
id|tmp
comma
l_int|10
)paren
suffix:semicolon
id|cnt
op_assign
(paren
id|cnt
OL
id|QETH_IN_BUF_COUNT_MIN
)paren
ques
c_cond
id|QETH_IN_BUF_COUNT_MIN
suffix:colon
(paren
(paren
id|cnt
OG
id|QETH_IN_BUF_COUNT_MAX
)paren
ques
c_cond
id|QETH_IN_BUF_COUNT_MAX
suffix:colon
id|cnt
)paren
suffix:semicolon
r_if
c_cond
(paren
id|old_cnt
op_ne
id|cnt
)paren
(brace
r_if
c_cond
(paren
(paren
id|rc
op_assign
id|qeth_realloc_buffer_pool
c_func
(paren
id|card
comma
id|cnt
)paren
)paren
)paren
id|PRINT_WARN
c_func
(paren
l_string|&quot;Error (%d) while setting &quot;
l_string|&quot;buffer count.&bslash;n&quot;
comma
id|rc
)paren
suffix:semicolon
)brace
r_return
id|count
suffix:semicolon
)brace
r_static
id|DEVICE_ATTR
c_func
(paren
id|buffer_count
comma
l_int|0644
comma
id|qeth_dev_bufcnt_show
comma
id|qeth_dev_bufcnt_store
)paren
suffix:semicolon
r_static
r_inline
id|ssize_t
DECL|function|qeth_dev_route_show
id|qeth_dev_route_show
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_struct
id|qeth_routing_info
op_star
id|route
comma
r_char
op_star
id|buf
)paren
(brace
r_switch
c_cond
(paren
id|route-&gt;type
)paren
(brace
r_case
id|PRIMARY_ROUTER
suffix:colon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
l_string|&quot;primary router&quot;
)paren
suffix:semicolon
r_case
id|SECONDARY_ROUTER
suffix:colon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
l_string|&quot;secondary router&quot;
)paren
suffix:semicolon
r_case
id|MULTICAST_ROUTER
suffix:colon
r_if
c_cond
(paren
id|card-&gt;info.broadcast_capable
op_eq
id|QETH_BROADCAST_WITHOUT_ECHO
)paren
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
l_string|&quot;multicast router+&quot;
)paren
suffix:semicolon
r_else
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
l_string|&quot;multicast router&quot;
)paren
suffix:semicolon
r_case
id|PRIMARY_CONNECTOR
suffix:colon
r_if
c_cond
(paren
id|card-&gt;info.broadcast_capable
op_eq
id|QETH_BROADCAST_WITHOUT_ECHO
)paren
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
l_string|&quot;primary connector+&quot;
)paren
suffix:semicolon
r_else
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
l_string|&quot;primary connector&quot;
)paren
suffix:semicolon
r_case
id|SECONDARY_CONNECTOR
suffix:colon
r_if
c_cond
(paren
id|card-&gt;info.broadcast_capable
op_eq
id|QETH_BROADCAST_WITHOUT_ECHO
)paren
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
l_string|&quot;secondary connector+&quot;
)paren
suffix:semicolon
r_else
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
l_string|&quot;secondary connector&quot;
)paren
suffix:semicolon
r_default
suffix:colon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
l_string|&quot;no&quot;
)paren
suffix:semicolon
)brace
)brace
r_static
id|ssize_t
DECL|function|qeth_dev_route4_show
id|qeth_dev_route4_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|qeth_dev_route_show
c_func
(paren
id|card
comma
op_amp
id|card-&gt;options.route4
comma
id|buf
)paren
suffix:semicolon
)brace
r_static
r_inline
id|ssize_t
DECL|function|qeth_dev_route_store
id|qeth_dev_route_store
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
comma
r_struct
id|qeth_routing_info
op_star
id|route
comma
r_enum
id|qeth_prot_versions
id|prot
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_enum
id|qeth_routing_types
id|old_route_type
op_assign
id|route-&gt;type
suffix:semicolon
r_char
op_star
id|tmp
suffix:semicolon
r_int
id|rc
suffix:semicolon
id|tmp
op_assign
id|strsep
c_func
(paren
(paren
r_char
op_star
op_star
)paren
op_amp
id|buf
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|tmp
comma
l_string|&quot;no_router&quot;
)paren
)paren
(brace
id|route-&gt;type
op_assign
id|NO_ROUTER
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|tmp
comma
l_string|&quot;primary_connector&quot;
)paren
)paren
(brace
id|route-&gt;type
op_assign
id|PRIMARY_CONNECTOR
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|tmp
comma
l_string|&quot;secondary_connector&quot;
)paren
)paren
(brace
id|route-&gt;type
op_assign
id|SECONDARY_CONNECTOR
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|tmp
comma
l_string|&quot;multicast_router&quot;
)paren
)paren
(brace
id|route-&gt;type
op_assign
id|MULTICAST_ROUTER
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|tmp
comma
l_string|&quot;primary_router&quot;
)paren
)paren
(brace
id|route-&gt;type
op_assign
id|PRIMARY_ROUTER
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|tmp
comma
l_string|&quot;secondary_router&quot;
)paren
)paren
(brace
id|route-&gt;type
op_assign
id|SECONDARY_ROUTER
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|tmp
comma
l_string|&quot;multicast_router&quot;
)paren
)paren
(brace
id|route-&gt;type
op_assign
id|MULTICAST_ROUTER
suffix:semicolon
)brace
r_else
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;Invalid routing type &squot;%s&squot;.&bslash;n&quot;
comma
id|tmp
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
(paren
id|card-&gt;state
op_eq
id|CARD_STATE_SOFTSETUP
)paren
op_logical_or
(paren
id|card-&gt;state
op_eq
id|CARD_STATE_UP
)paren
)paren
op_logical_and
(paren
id|old_route_type
op_ne
id|route-&gt;type
)paren
)paren
(brace
r_if
c_cond
(paren
id|prot
op_eq
id|QETH_PROT_IPV4
)paren
id|rc
op_assign
id|qeth_setrouting_v4
c_func
(paren
id|card
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|prot
op_eq
id|QETH_PROT_IPV6
)paren
id|rc
op_assign
id|qeth_setrouting_v6
c_func
(paren
id|card
)paren
suffix:semicolon
)brace
r_return
id|count
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_dev_route4_store
id|qeth_dev_route4_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|qeth_dev_route_store
c_func
(paren
id|card
comma
op_amp
id|card-&gt;options.route4
comma
id|QETH_PROT_IPV4
comma
id|buf
comma
id|count
)paren
suffix:semicolon
)brace
r_static
id|DEVICE_ATTR
c_func
(paren
id|route4
comma
l_int|0644
comma
id|qeth_dev_route4_show
comma
id|qeth_dev_route4_store
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_QETH_IPV6
r_static
id|ssize_t
DECL|function|qeth_dev_route6_show
id|qeth_dev_route6_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|qeth_is_supported
c_func
(paren
id|card
comma
id|IPA_IPV6
)paren
)paren
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
l_string|&quot;n/a&quot;
)paren
suffix:semicolon
r_return
id|qeth_dev_route_show
c_func
(paren
id|card
comma
op_amp
id|card-&gt;options.route6
comma
id|buf
)paren
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_dev_route6_store
id|qeth_dev_route6_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|qeth_is_supported
c_func
(paren
id|card
comma
id|IPA_IPV6
)paren
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;IPv6 not supported for interface %s.&bslash;n&quot;
l_string|&quot;Routing status no changed.&bslash;n&quot;
comma
id|QETH_CARD_IFNAME
c_func
(paren
id|card
)paren
)paren
suffix:semicolon
r_return
op_minus
id|ENOTSUPP
suffix:semicolon
)brace
r_return
id|qeth_dev_route_store
c_func
(paren
id|card
comma
op_amp
id|card-&gt;options.route6
comma
id|QETH_PROT_IPV6
comma
id|buf
comma
id|count
)paren
suffix:semicolon
)brace
r_static
id|DEVICE_ATTR
c_func
(paren
id|route6
comma
l_int|0644
comma
id|qeth_dev_route6_show
comma
id|qeth_dev_route6_store
)paren
suffix:semicolon
macro_line|#endif
r_static
id|ssize_t
DECL|function|qeth_dev_add_hhlen_show
id|qeth_dev_add_hhlen_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%i&bslash;n&quot;
comma
id|card-&gt;options.add_hhlen
)paren
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_dev_add_hhlen_store
id|qeth_dev_add_hhlen_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_char
op_star
id|tmp
suffix:semicolon
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
(paren
id|card-&gt;state
op_ne
id|CARD_STATE_DOWN
)paren
op_logical_and
(paren
id|card-&gt;state
op_ne
id|CARD_STATE_RECOVER
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
id|i
op_assign
id|simple_strtoul
c_func
(paren
id|buf
comma
op_amp
id|tmp
comma
l_int|10
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|i
OL
l_int|0
)paren
op_logical_or
(paren
id|i
OG
id|MAX_ADD_HHLEN
)paren
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;add_hhlen out of range&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|card-&gt;options.add_hhlen
op_assign
id|i
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
r_static
id|DEVICE_ATTR
c_func
(paren
id|add_hhlen
comma
l_int|0644
comma
id|qeth_dev_add_hhlen_show
comma
id|qeth_dev_add_hhlen_store
)paren
suffix:semicolon
r_static
id|ssize_t
DECL|function|qeth_dev_fake_ll_show
id|qeth_dev_fake_ll_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%i&bslash;n&quot;
comma
id|card-&gt;options.fake_ll
ques
c_cond
l_int|1
suffix:colon
l_int|0
)paren
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_dev_fake_ll_store
id|qeth_dev_fake_ll_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_char
op_star
id|tmp
suffix:semicolon
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
(paren
id|card-&gt;state
op_ne
id|CARD_STATE_DOWN
)paren
op_logical_and
(paren
id|card-&gt;state
op_ne
id|CARD_STATE_RECOVER
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
id|i
op_assign
id|simple_strtoul
c_func
(paren
id|buf
comma
op_amp
id|tmp
comma
l_int|16
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|i
op_ne
l_int|0
)paren
op_logical_and
(paren
id|i
op_ne
l_int|1
)paren
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;fake_ll: write 0 or 1 to this file!&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|card-&gt;options.fake_ll
op_assign
id|i
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
r_static
id|DEVICE_ATTR
c_func
(paren
id|fake_ll
comma
l_int|0644
comma
id|qeth_dev_fake_ll_show
comma
id|qeth_dev_fake_ll_store
)paren
suffix:semicolon
r_static
id|ssize_t
DECL|function|qeth_dev_fake_broadcast_show
id|qeth_dev_fake_broadcast_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%i&bslash;n&quot;
comma
id|card-&gt;options.fake_broadcast
ques
c_cond
l_int|1
suffix:colon
l_int|0
)paren
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_dev_fake_broadcast_store
id|qeth_dev_fake_broadcast_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_char
op_star
id|tmp
suffix:semicolon
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
(paren
id|card-&gt;state
op_ne
id|CARD_STATE_DOWN
)paren
op_logical_and
(paren
id|card-&gt;state
op_ne
id|CARD_STATE_RECOVER
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
id|i
op_assign
id|simple_strtoul
c_func
(paren
id|buf
comma
op_amp
id|tmp
comma
l_int|16
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|i
op_eq
l_int|0
)paren
op_logical_or
(paren
id|i
op_eq
l_int|1
)paren
)paren
id|card-&gt;options.fake_broadcast
op_assign
id|i
suffix:semicolon
r_else
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;fake_broadcast: write 0 or 1 to this file!&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_return
id|count
suffix:semicolon
)brace
r_static
id|DEVICE_ATTR
c_func
(paren
id|fake_broadcast
comma
l_int|0644
comma
id|qeth_dev_fake_broadcast_show
comma
id|qeth_dev_fake_broadcast_store
)paren
suffix:semicolon
r_static
id|ssize_t
DECL|function|qeth_dev_recover_store
id|qeth_dev_recover_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_char
op_star
id|tmp
suffix:semicolon
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|card-&gt;state
op_ne
id|CARD_STATE_UP
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
id|i
op_assign
id|simple_strtoul
c_func
(paren
id|buf
comma
op_amp
id|tmp
comma
l_int|16
)paren
suffix:semicolon
r_if
c_cond
(paren
id|i
op_eq
l_int|1
)paren
id|qeth_schedule_recovery
c_func
(paren
id|card
)paren
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
r_static
id|DEVICE_ATTR
c_func
(paren
id|recover
comma
l_int|0200
comma
l_int|NULL
comma
id|qeth_dev_recover_store
)paren
suffix:semicolon
r_static
id|ssize_t
DECL|function|qeth_dev_broadcast_mode_show
id|qeth_dev_broadcast_mode_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
(paren
id|card-&gt;info.link_type
op_eq
id|QETH_LINK_TYPE_HSTR
)paren
op_logical_or
(paren
id|card-&gt;info.link_type
op_eq
id|QETH_LINK_TYPE_LANE_TR
)paren
)paren
)paren
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;n/a&bslash;n&quot;
)paren
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%s&bslash;n&quot;
comma
(paren
id|card-&gt;options.broadcast_mode
op_eq
id|QETH_TR_BROADCAST_ALLRINGS
)paren
ques
c_cond
l_string|&quot;all rings&quot;
suffix:colon
l_string|&quot;local&quot;
)paren
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_dev_broadcast_mode_store
id|qeth_dev_broadcast_mode_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_char
op_star
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
(paren
id|card-&gt;state
op_ne
id|CARD_STATE_DOWN
)paren
op_logical_and
(paren
id|card-&gt;state
op_ne
id|CARD_STATE_RECOVER
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
(paren
id|card-&gt;info.link_type
op_eq
id|QETH_LINK_TYPE_HSTR
)paren
op_logical_or
(paren
id|card-&gt;info.link_type
op_eq
id|QETH_LINK_TYPE_LANE_TR
)paren
)paren
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;Device is not a tokenring device!&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|tmp
op_assign
id|strsep
c_func
(paren
(paren
r_char
op_star
op_star
)paren
op_amp
id|buf
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|tmp
comma
l_string|&quot;local&quot;
)paren
)paren
(brace
id|card-&gt;options.broadcast_mode
op_assign
id|QETH_TR_BROADCAST_LOCAL
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|tmp
comma
l_string|&quot;all_rings&quot;
)paren
)paren
(brace
id|card-&gt;options.broadcast_mode
op_assign
id|QETH_TR_BROADCAST_ALLRINGS
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
r_else
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;broadcast_mode: invalid mode %s!&bslash;n&quot;
comma
id|tmp
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_return
id|count
suffix:semicolon
)brace
r_static
id|DEVICE_ATTR
c_func
(paren
id|broadcast_mode
comma
l_int|0644
comma
id|qeth_dev_broadcast_mode_show
comma
id|qeth_dev_broadcast_mode_store
)paren
suffix:semicolon
r_static
id|ssize_t
DECL|function|qeth_dev_canonical_macaddr_show
id|qeth_dev_canonical_macaddr_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
(paren
id|card-&gt;info.link_type
op_eq
id|QETH_LINK_TYPE_HSTR
)paren
op_logical_or
(paren
id|card-&gt;info.link_type
op_eq
id|QETH_LINK_TYPE_LANE_TR
)paren
)paren
)paren
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;n/a&bslash;n&quot;
)paren
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%i&bslash;n&quot;
comma
(paren
id|card-&gt;options.macaddr_mode
op_eq
id|QETH_TR_MACADDR_CANONICAL
)paren
ques
c_cond
l_int|1
suffix:colon
l_int|0
)paren
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_dev_canonical_macaddr_store
id|qeth_dev_canonical_macaddr_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_char
op_star
id|tmp
suffix:semicolon
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
(paren
id|card-&gt;state
op_ne
id|CARD_STATE_DOWN
)paren
op_logical_and
(paren
id|card-&gt;state
op_ne
id|CARD_STATE_RECOVER
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
(paren
id|card-&gt;info.link_type
op_eq
id|QETH_LINK_TYPE_HSTR
)paren
op_logical_or
(paren
id|card-&gt;info.link_type
op_eq
id|QETH_LINK_TYPE_LANE_TR
)paren
)paren
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;Device is not a tokenring device!&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|i
op_assign
id|simple_strtoul
c_func
(paren
id|buf
comma
op_amp
id|tmp
comma
l_int|16
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|i
op_eq
l_int|0
)paren
op_logical_or
(paren
id|i
op_eq
l_int|1
)paren
)paren
id|card-&gt;options.macaddr_mode
op_assign
id|i
ques
c_cond
id|QETH_TR_MACADDR_CANONICAL
suffix:colon
id|QETH_TR_MACADDR_NONCANONICAL
suffix:semicolon
r_else
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;canonical_macaddr: write 0 or 1 to this file!&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_return
id|count
suffix:semicolon
)brace
r_static
id|DEVICE_ATTR
c_func
(paren
id|canonical_macaddr
comma
l_int|0644
comma
id|qeth_dev_canonical_macaddr_show
comma
id|qeth_dev_canonical_macaddr_store
)paren
suffix:semicolon
r_static
id|ssize_t
DECL|function|qeth_dev_layer2_show
id|qeth_dev_layer2_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%i&bslash;n&quot;
comma
id|card-&gt;options.layer2
ques
c_cond
l_int|1
suffix:colon
l_int|0
)paren
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_dev_layer2_store
id|qeth_dev_layer2_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_char
op_star
id|tmp
suffix:semicolon
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
(paren
(paren
id|card-&gt;state
op_ne
id|CARD_STATE_DOWN
)paren
op_logical_and
(paren
id|card-&gt;state
op_ne
id|CARD_STATE_RECOVER
)paren
)paren
op_logical_or
(paren
id|card-&gt;info.type
op_ne
id|QETH_CARD_TYPE_OSAE
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
id|i
op_assign
id|simple_strtoul
c_func
(paren
id|buf
comma
op_amp
id|tmp
comma
l_int|16
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|i
op_eq
l_int|0
)paren
op_logical_or
(paren
id|i
op_eq
l_int|1
)paren
)paren
id|card-&gt;options.layer2
op_assign
id|i
suffix:semicolon
r_else
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;layer2: write 0 or 1 to this file!&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_return
id|count
suffix:semicolon
)brace
r_static
id|DEVICE_ATTR
c_func
(paren
id|layer2
comma
l_int|0644
comma
id|qeth_dev_layer2_show
comma
id|qeth_dev_layer2_store
)paren
suffix:semicolon
DECL|variable|qeth_device_attrs
r_static
r_struct
id|device_attribute
op_star
id|qeth_device_attrs
(braket
)braket
op_assign
(brace
op_amp
id|dev_attr_state
comma
op_amp
id|dev_attr_chpid
comma
op_amp
id|dev_attr_if_name
comma
op_amp
id|dev_attr_card_type
comma
op_amp
id|dev_attr_portno
comma
op_amp
id|dev_attr_portname
comma
op_amp
id|dev_attr_checksumming
comma
op_amp
id|dev_attr_priority_queueing
comma
op_amp
id|dev_attr_buffer_count
comma
op_amp
id|dev_attr_route4
comma
macro_line|#ifdef CONFIG_QETH_IPV6
op_amp
id|dev_attr_route6
comma
macro_line|#endif
op_amp
id|dev_attr_add_hhlen
comma
op_amp
id|dev_attr_fake_ll
comma
op_amp
id|dev_attr_fake_broadcast
comma
op_amp
id|dev_attr_recover
comma
op_amp
id|dev_attr_broadcast_mode
comma
op_amp
id|dev_attr_canonical_macaddr
comma
op_amp
id|dev_attr_layer2
comma
l_int|NULL
comma
)brace
suffix:semicolon
DECL|variable|qeth_device_attr_group
r_static
r_struct
id|attribute_group
id|qeth_device_attr_group
op_assign
(brace
dot
id|attrs
op_assign
(paren
r_struct
id|attribute
op_star
op_star
)paren
id|qeth_device_attrs
comma
)brace
suffix:semicolon
DECL|macro|QETH_DEVICE_ATTR
mdefine_line|#define QETH_DEVICE_ATTR(_id,_name,_mode,_show,_store)&t;&t;&t;     &bslash;&n;struct device_attribute dev_attr_##_id = {&t;&t;&t;&t;     &bslash;&n;&t;.attr = {.name=__stringify(_name), .mode=_mode, .owner=THIS_MODULE },&bslash;&n;&t;.show&t;= _show,&t;&t;&t;&t;&t;&t;     &bslash;&n;&t;.store&t;= _store,&t;&t;&t;&t;&t;&t;     &bslash;&n;};
r_int
DECL|function|qeth_check_layer2
id|qeth_check_layer2
c_func
(paren
r_struct
id|qeth_card
op_star
id|card
)paren
(brace
r_if
c_cond
(paren
id|card-&gt;options.layer2
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_dev_ipato_enable_show
id|qeth_dev_ipato_enable_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|qeth_check_layer2
c_func
(paren
id|card
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%i&bslash;n&quot;
comma
id|card-&gt;ipato.enabled
ques
c_cond
l_int|1
suffix:colon
l_int|0
)paren
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_dev_ipato_enable_store
id|qeth_dev_ipato_enable_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_char
op_star
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
(paren
id|card-&gt;state
op_ne
id|CARD_STATE_DOWN
)paren
op_logical_and
(paren
id|card-&gt;state
op_ne
id|CARD_STATE_RECOVER
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
r_if
c_cond
(paren
id|qeth_check_layer2
c_func
(paren
id|card
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
id|tmp
op_assign
id|strsep
c_func
(paren
(paren
r_char
op_star
op_star
)paren
op_amp
id|buf
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|tmp
comma
l_string|&quot;toggle&quot;
)paren
)paren
(brace
id|card-&gt;ipato.enabled
op_assign
(paren
id|card-&gt;ipato.enabled
)paren
ques
c_cond
l_int|0
suffix:colon
l_int|1
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|tmp
comma
l_string|&quot;1&quot;
)paren
)paren
(brace
id|card-&gt;ipato.enabled
op_assign
l_int|1
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|tmp
comma
l_string|&quot;0&quot;
)paren
)paren
(brace
id|card-&gt;ipato.enabled
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;ipato_enable: write 0, 1 or &squot;toggle&squot; to &quot;
l_string|&quot;this file&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_return
id|count
suffix:semicolon
)brace
r_static
id|QETH_DEVICE_ATTR
c_func
(paren
id|ipato_enable
comma
id|enable
comma
l_int|0644
comma
id|qeth_dev_ipato_enable_show
comma
id|qeth_dev_ipato_enable_store
)paren
suffix:semicolon
r_static
id|ssize_t
DECL|function|qeth_dev_ipato_invert4_show
id|qeth_dev_ipato_invert4_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|qeth_check_layer2
c_func
(paren
id|card
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%i&bslash;n&quot;
comma
id|card-&gt;ipato.invert4
ques
c_cond
l_int|1
suffix:colon
l_int|0
)paren
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_dev_ipato_invert4_store
id|qeth_dev_ipato_invert4_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_char
op_star
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|qeth_check_layer2
c_func
(paren
id|card
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
id|tmp
op_assign
id|strsep
c_func
(paren
(paren
r_char
op_star
op_star
)paren
op_amp
id|buf
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|tmp
comma
l_string|&quot;toggle&quot;
)paren
)paren
(brace
id|card-&gt;ipato.invert4
op_assign
(paren
id|card-&gt;ipato.invert4
)paren
ques
c_cond
l_int|0
suffix:colon
l_int|1
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|tmp
comma
l_string|&quot;1&quot;
)paren
)paren
(brace
id|card-&gt;ipato.invert4
op_assign
l_int|1
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|tmp
comma
l_string|&quot;0&quot;
)paren
)paren
(brace
id|card-&gt;ipato.invert4
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;ipato_invert4: write 0, 1 or &squot;toggle&squot; to &quot;
l_string|&quot;this file&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_return
id|count
suffix:semicolon
)brace
r_static
id|QETH_DEVICE_ATTR
c_func
(paren
id|ipato_invert4
comma
id|invert4
comma
l_int|0644
comma
id|qeth_dev_ipato_invert4_show
comma
id|qeth_dev_ipato_invert4_store
)paren
suffix:semicolon
r_static
r_inline
id|ssize_t
DECL|function|qeth_dev_ipato_add_show
id|qeth_dev_ipato_add_show
c_func
(paren
r_char
op_star
id|buf
comma
r_struct
id|qeth_card
op_star
id|card
comma
r_enum
id|qeth_prot_versions
id|proto
)paren
(brace
r_struct
id|qeth_ipato_entry
op_star
id|ipatoe
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_char
id|addr_str
(braket
l_int|40
)braket
suffix:semicolon
r_int
id|entry_len
suffix:semicolon
multiline_comment|/* length of 1 entry string, differs between v4 and v6 */
r_int
id|i
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|qeth_check_layer2
c_func
(paren
id|card
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
id|entry_len
op_assign
(paren
id|proto
op_eq
id|QETH_PROT_IPV4
)paren
ques
c_cond
l_int|12
suffix:colon
l_int|40
suffix:semicolon
multiline_comment|/* add strlen for &quot;/&lt;mask&gt;&bslash;n&quot; */
id|entry_len
op_add_assign
(paren
id|proto
op_eq
id|QETH_PROT_IPV4
)paren
ques
c_cond
l_int|5
suffix:colon
l_int|6
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|card-&gt;ip_lock
comma
id|flags
)paren
suffix:semicolon
(def_block
id|list_for_each_entry
c_func
(paren
id|ipatoe
comma
op_amp
id|card-&gt;ipato.entries
comma
id|entry
)paren
(brace
r_if
c_cond
(paren
id|ipatoe-&gt;proto
op_ne
id|proto
)paren
r_continue
suffix:semicolon
multiline_comment|/* String must not be longer than PAGE_SIZE. So we check if&n;&t;&t; * string length gets near PAGE_SIZE. Then we can savely display&n;&t;&t; * the next IPv6 address (worst case, compared to IPv4) */
r_if
c_cond
(paren
(paren
id|PAGE_SIZE
op_minus
id|i
)paren
op_le
id|entry_len
)paren
r_break
suffix:semicolon
id|qeth_ipaddr_to_string
c_func
(paren
id|proto
comma
id|ipatoe-&gt;addr
comma
id|addr_str
)paren
suffix:semicolon
id|i
op_add_assign
id|snprintf
c_func
(paren
id|buf
op_plus
id|i
comma
id|PAGE_SIZE
op_minus
id|i
comma
l_string|&quot;%s/%i&bslash;n&quot;
comma
id|addr_str
comma
id|ipatoe-&gt;mask_bits
)paren
suffix:semicolon
)brace
)def_block
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|card-&gt;ip_lock
comma
id|flags
)paren
suffix:semicolon
id|i
op_add_assign
id|snprintf
c_func
(paren
id|buf
op_plus
id|i
comma
id|PAGE_SIZE
op_minus
id|i
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
r_return
id|i
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_dev_ipato_add4_show
id|qeth_dev_ipato_add4_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|qeth_dev_ipato_add_show
c_func
(paren
id|buf
comma
id|card
comma
id|QETH_PROT_IPV4
)paren
suffix:semicolon
)brace
r_static
r_inline
r_int
DECL|function|qeth_parse_ipatoe
id|qeth_parse_ipatoe
c_func
(paren
r_const
r_char
op_star
id|buf
comma
r_enum
id|qeth_prot_versions
id|proto
comma
id|u8
op_star
id|addr
comma
r_int
op_star
id|mask_bits
)paren
(brace
r_const
r_char
op_star
id|start
comma
op_star
id|end
suffix:semicolon
r_char
op_star
id|tmp
suffix:semicolon
r_char
id|buffer
(braket
l_int|49
)braket
op_assign
(brace
l_int|0
comma
)brace
suffix:semicolon
id|start
op_assign
id|buf
suffix:semicolon
multiline_comment|/* get address string */
id|end
op_assign
id|strchr
c_func
(paren
id|start
comma
l_char|&squot;/&squot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|end
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;Invalid format for ipato_addx/delx. &quot;
l_string|&quot;Use &lt;ip addr&gt;/&lt;mask bits&gt;&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|strncpy
c_func
(paren
id|buffer
comma
id|start
comma
id|end
op_minus
id|start
)paren
suffix:semicolon
r_if
c_cond
(paren
id|qeth_string_to_ipaddr
c_func
(paren
id|buffer
comma
id|proto
comma
id|addr
)paren
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;Invalid IP address format!&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|start
op_assign
id|end
op_plus
l_int|1
suffix:semicolon
op_star
id|mask_bits
op_assign
id|simple_strtoul
c_func
(paren
id|start
comma
op_amp
id|tmp
comma
l_int|10
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_inline
id|ssize_t
DECL|function|qeth_dev_ipato_add_store
id|qeth_dev_ipato_add_store
c_func
(paren
r_const
r_char
op_star
id|buf
comma
r_int
id|count
comma
r_struct
id|qeth_card
op_star
id|card
comma
r_enum
id|qeth_prot_versions
id|proto
)paren
(brace
r_struct
id|qeth_ipato_entry
op_star
id|ipatoe
suffix:semicolon
id|u8
id|addr
(braket
l_int|16
)braket
suffix:semicolon
r_int
id|mask_bits
suffix:semicolon
r_int
id|rc
suffix:semicolon
r_if
c_cond
(paren
id|qeth_check_layer2
c_func
(paren
id|card
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
r_if
c_cond
(paren
(paren
id|rc
op_assign
id|qeth_parse_ipatoe
c_func
(paren
id|buf
comma
id|proto
comma
id|addr
comma
op_amp
id|mask_bits
)paren
)paren
)paren
r_return
id|rc
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|ipatoe
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|qeth_ipato_entry
)paren
comma
id|GFP_KERNEL
)paren
)paren
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;No memory to allocate ipato entry&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|memset
c_func
(paren
id|ipatoe
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|qeth_ipato_entry
)paren
)paren
suffix:semicolon
id|ipatoe-&gt;proto
op_assign
id|proto
suffix:semicolon
id|memcpy
c_func
(paren
id|ipatoe-&gt;addr
comma
id|addr
comma
(paren
id|proto
op_eq
id|QETH_PROT_IPV4
)paren
ques
c_cond
l_int|4
suffix:colon
l_int|16
)paren
suffix:semicolon
id|ipatoe-&gt;mask_bits
op_assign
id|mask_bits
suffix:semicolon
r_if
c_cond
(paren
(paren
id|rc
op_assign
id|qeth_add_ipato_entry
c_func
(paren
id|card
comma
id|ipatoe
)paren
)paren
)paren
(brace
id|kfree
c_func
(paren
id|ipatoe
)paren
suffix:semicolon
r_return
id|rc
suffix:semicolon
)brace
r_return
id|count
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_dev_ipato_add4_store
id|qeth_dev_ipato_add4_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|qeth_dev_ipato_add_store
c_func
(paren
id|buf
comma
id|count
comma
id|card
comma
id|QETH_PROT_IPV4
)paren
suffix:semicolon
)brace
r_static
id|QETH_DEVICE_ATTR
c_func
(paren
id|ipato_add4
comma
id|add4
comma
l_int|0644
comma
id|qeth_dev_ipato_add4_show
comma
id|qeth_dev_ipato_add4_store
)paren
suffix:semicolon
r_static
r_inline
id|ssize_t
DECL|function|qeth_dev_ipato_del_store
id|qeth_dev_ipato_del_store
c_func
(paren
r_const
r_char
op_star
id|buf
comma
r_int
id|count
comma
r_struct
id|qeth_card
op_star
id|card
comma
r_enum
id|qeth_prot_versions
id|proto
)paren
(brace
id|u8
id|addr
(braket
l_int|16
)braket
suffix:semicolon
r_int
id|mask_bits
suffix:semicolon
r_int
id|rc
suffix:semicolon
r_if
c_cond
(paren
id|qeth_check_layer2
c_func
(paren
id|card
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
r_if
c_cond
(paren
(paren
id|rc
op_assign
id|qeth_parse_ipatoe
c_func
(paren
id|buf
comma
id|proto
comma
id|addr
comma
op_amp
id|mask_bits
)paren
)paren
)paren
r_return
id|rc
suffix:semicolon
id|qeth_del_ipato_entry
c_func
(paren
id|card
comma
id|proto
comma
id|addr
comma
id|mask_bits
)paren
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_dev_ipato_del4_store
id|qeth_dev_ipato_del4_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|qeth_dev_ipato_del_store
c_func
(paren
id|buf
comma
id|count
comma
id|card
comma
id|QETH_PROT_IPV4
)paren
suffix:semicolon
)brace
r_static
id|QETH_DEVICE_ATTR
c_func
(paren
id|ipato_del4
comma
id|del4
comma
l_int|0200
comma
l_int|NULL
comma
id|qeth_dev_ipato_del4_store
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_QETH_IPV6
r_static
id|ssize_t
DECL|function|qeth_dev_ipato_invert6_show
id|qeth_dev_ipato_invert6_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|qeth_check_layer2
c_func
(paren
id|card
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%i&bslash;n&quot;
comma
id|card-&gt;ipato.invert6
ques
c_cond
l_int|1
suffix:colon
l_int|0
)paren
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_dev_ipato_invert6_store
id|qeth_dev_ipato_invert6_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_char
op_star
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|qeth_check_layer2
c_func
(paren
id|card
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
id|tmp
op_assign
id|strsep
c_func
(paren
(paren
r_char
op_star
op_star
)paren
op_amp
id|buf
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|tmp
comma
l_string|&quot;toggle&quot;
)paren
)paren
(brace
id|card-&gt;ipato.invert6
op_assign
(paren
id|card-&gt;ipato.invert6
)paren
ques
c_cond
l_int|0
suffix:colon
l_int|1
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|tmp
comma
l_string|&quot;1&quot;
)paren
)paren
(brace
id|card-&gt;ipato.invert6
op_assign
l_int|1
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|tmp
comma
l_string|&quot;0&quot;
)paren
)paren
(brace
id|card-&gt;ipato.invert6
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;ipato_invert6: write 0, 1 or &squot;toggle&squot; to &quot;
l_string|&quot;this file&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_return
id|count
suffix:semicolon
)brace
r_static
id|QETH_DEVICE_ATTR
c_func
(paren
id|ipato_invert6
comma
id|invert6
comma
l_int|0644
comma
id|qeth_dev_ipato_invert6_show
comma
id|qeth_dev_ipato_invert6_store
)paren
suffix:semicolon
r_static
id|ssize_t
DECL|function|qeth_dev_ipato_add6_show
id|qeth_dev_ipato_add6_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|qeth_dev_ipato_add_show
c_func
(paren
id|buf
comma
id|card
comma
id|QETH_PROT_IPV6
)paren
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_dev_ipato_add6_store
id|qeth_dev_ipato_add6_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|qeth_dev_ipato_add_store
c_func
(paren
id|buf
comma
id|count
comma
id|card
comma
id|QETH_PROT_IPV6
)paren
suffix:semicolon
)brace
r_static
id|QETH_DEVICE_ATTR
c_func
(paren
id|ipato_add6
comma
id|add6
comma
l_int|0644
comma
id|qeth_dev_ipato_add6_show
comma
id|qeth_dev_ipato_add6_store
)paren
suffix:semicolon
r_static
id|ssize_t
DECL|function|qeth_dev_ipato_del6_store
id|qeth_dev_ipato_del6_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|qeth_dev_ipato_del_store
c_func
(paren
id|buf
comma
id|count
comma
id|card
comma
id|QETH_PROT_IPV6
)paren
suffix:semicolon
)brace
r_static
id|QETH_DEVICE_ATTR
c_func
(paren
id|ipato_del6
comma
id|del6
comma
l_int|0200
comma
l_int|NULL
comma
id|qeth_dev_ipato_del6_store
)paren
suffix:semicolon
macro_line|#endif /* CONFIG_QETH_IPV6 */
DECL|variable|qeth_ipato_device_attrs
r_static
r_struct
id|device_attribute
op_star
id|qeth_ipato_device_attrs
(braket
)braket
op_assign
(brace
op_amp
id|dev_attr_ipato_enable
comma
op_amp
id|dev_attr_ipato_invert4
comma
op_amp
id|dev_attr_ipato_add4
comma
op_amp
id|dev_attr_ipato_del4
comma
macro_line|#ifdef CONFIG_QETH_IPV6
op_amp
id|dev_attr_ipato_invert6
comma
op_amp
id|dev_attr_ipato_add6
comma
op_amp
id|dev_attr_ipato_del6
comma
macro_line|#endif
l_int|NULL
comma
)brace
suffix:semicolon
DECL|variable|qeth_device_ipato_group
r_static
r_struct
id|attribute_group
id|qeth_device_ipato_group
op_assign
(brace
dot
id|name
op_assign
l_string|&quot;ipa_takeover&quot;
comma
dot
id|attrs
op_assign
(paren
r_struct
id|attribute
op_star
op_star
)paren
id|qeth_ipato_device_attrs
comma
)brace
suffix:semicolon
r_static
r_inline
id|ssize_t
DECL|function|qeth_dev_vipa_add_show
id|qeth_dev_vipa_add_show
c_func
(paren
r_char
op_star
id|buf
comma
r_struct
id|qeth_card
op_star
id|card
comma
r_enum
id|qeth_prot_versions
id|proto
)paren
(brace
r_struct
id|qeth_ipaddr
op_star
id|ipaddr
suffix:semicolon
r_char
id|addr_str
(braket
l_int|40
)braket
suffix:semicolon
r_int
id|entry_len
suffix:semicolon
multiline_comment|/* length of 1 entry string, differs between v4 and v6 */
r_int
r_int
id|flags
suffix:semicolon
r_int
id|i
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|qeth_check_layer2
c_func
(paren
id|card
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
id|entry_len
op_assign
(paren
id|proto
op_eq
id|QETH_PROT_IPV4
)paren
ques
c_cond
l_int|12
suffix:colon
l_int|40
suffix:semicolon
id|entry_len
op_add_assign
l_int|2
suffix:semicolon
multiline_comment|/* &bslash;n + terminator */
id|spin_lock_irqsave
c_func
(paren
op_amp
id|card-&gt;ip_lock
comma
id|flags
)paren
suffix:semicolon
(def_block
id|list_for_each_entry
c_func
(paren
id|ipaddr
comma
op_amp
id|card-&gt;ip_list
comma
id|entry
)paren
(brace
r_if
c_cond
(paren
id|ipaddr-&gt;proto
op_ne
id|proto
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|ipaddr-&gt;type
op_ne
id|QETH_IP_TYPE_VIPA
)paren
r_continue
suffix:semicolon
multiline_comment|/* String must not be longer than PAGE_SIZE. So we check if&n;&t;&t; * string length gets near PAGE_SIZE. Then we can savely display&n;&t;&t; * the next IPv6 address (worst case, compared to IPv4) */
r_if
c_cond
(paren
(paren
id|PAGE_SIZE
op_minus
id|i
)paren
op_le
id|entry_len
)paren
r_break
suffix:semicolon
id|qeth_ipaddr_to_string
c_func
(paren
id|proto
comma
(paren
r_const
id|u8
op_star
)paren
op_amp
id|ipaddr-&gt;u
comma
id|addr_str
)paren
suffix:semicolon
id|i
op_add_assign
id|snprintf
c_func
(paren
id|buf
op_plus
id|i
comma
id|PAGE_SIZE
op_minus
id|i
comma
l_string|&quot;%s&bslash;n&quot;
comma
id|addr_str
)paren
suffix:semicolon
)brace
)def_block
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|card-&gt;ip_lock
comma
id|flags
)paren
suffix:semicolon
id|i
op_add_assign
id|snprintf
c_func
(paren
id|buf
op_plus
id|i
comma
id|PAGE_SIZE
op_minus
id|i
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
r_return
id|i
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_dev_vipa_add4_show
id|qeth_dev_vipa_add4_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|qeth_dev_vipa_add_show
c_func
(paren
id|buf
comma
id|card
comma
id|QETH_PROT_IPV4
)paren
suffix:semicolon
)brace
r_static
r_inline
r_int
DECL|function|qeth_parse_vipae
id|qeth_parse_vipae
c_func
(paren
r_const
r_char
op_star
id|buf
comma
r_enum
id|qeth_prot_versions
id|proto
comma
id|u8
op_star
id|addr
)paren
(brace
r_if
c_cond
(paren
id|qeth_string_to_ipaddr
c_func
(paren
id|buf
comma
id|proto
comma
id|addr
)paren
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;Invalid IP address format!&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_inline
id|ssize_t
DECL|function|qeth_dev_vipa_add_store
id|qeth_dev_vipa_add_store
c_func
(paren
r_const
r_char
op_star
id|buf
comma
r_int
id|count
comma
r_struct
id|qeth_card
op_star
id|card
comma
r_enum
id|qeth_prot_versions
id|proto
)paren
(brace
id|u8
id|addr
(braket
l_int|16
)braket
op_assign
(brace
l_int|0
comma
)brace
suffix:semicolon
r_int
id|rc
suffix:semicolon
r_if
c_cond
(paren
id|qeth_check_layer2
c_func
(paren
id|card
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
r_if
c_cond
(paren
(paren
id|rc
op_assign
id|qeth_parse_vipae
c_func
(paren
id|buf
comma
id|proto
comma
id|addr
)paren
)paren
)paren
r_return
id|rc
suffix:semicolon
r_if
c_cond
(paren
(paren
id|rc
op_assign
id|qeth_add_vipa
c_func
(paren
id|card
comma
id|proto
comma
id|addr
)paren
)paren
)paren
r_return
id|rc
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_dev_vipa_add4_store
id|qeth_dev_vipa_add4_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|qeth_dev_vipa_add_store
c_func
(paren
id|buf
comma
id|count
comma
id|card
comma
id|QETH_PROT_IPV4
)paren
suffix:semicolon
)brace
r_static
id|QETH_DEVICE_ATTR
c_func
(paren
id|vipa_add4
comma
id|add4
comma
l_int|0644
comma
id|qeth_dev_vipa_add4_show
comma
id|qeth_dev_vipa_add4_store
)paren
suffix:semicolon
r_static
r_inline
id|ssize_t
DECL|function|qeth_dev_vipa_del_store
id|qeth_dev_vipa_del_store
c_func
(paren
r_const
r_char
op_star
id|buf
comma
r_int
id|count
comma
r_struct
id|qeth_card
op_star
id|card
comma
r_enum
id|qeth_prot_versions
id|proto
)paren
(brace
id|u8
id|addr
(braket
l_int|16
)braket
suffix:semicolon
r_int
id|rc
suffix:semicolon
r_if
c_cond
(paren
id|qeth_check_layer2
c_func
(paren
id|card
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
r_if
c_cond
(paren
(paren
id|rc
op_assign
id|qeth_parse_vipae
c_func
(paren
id|buf
comma
id|proto
comma
id|addr
)paren
)paren
)paren
r_return
id|rc
suffix:semicolon
id|qeth_del_vipa
c_func
(paren
id|card
comma
id|proto
comma
id|addr
)paren
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_dev_vipa_del4_store
id|qeth_dev_vipa_del4_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|qeth_dev_vipa_del_store
c_func
(paren
id|buf
comma
id|count
comma
id|card
comma
id|QETH_PROT_IPV4
)paren
suffix:semicolon
)brace
r_static
id|QETH_DEVICE_ATTR
c_func
(paren
id|vipa_del4
comma
id|del4
comma
l_int|0200
comma
l_int|NULL
comma
id|qeth_dev_vipa_del4_store
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_QETH_IPV6
r_static
id|ssize_t
DECL|function|qeth_dev_vipa_add6_show
id|qeth_dev_vipa_add6_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|qeth_dev_vipa_add_show
c_func
(paren
id|buf
comma
id|card
comma
id|QETH_PROT_IPV6
)paren
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_dev_vipa_add6_store
id|qeth_dev_vipa_add6_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|qeth_dev_vipa_add_store
c_func
(paren
id|buf
comma
id|count
comma
id|card
comma
id|QETH_PROT_IPV6
)paren
suffix:semicolon
)brace
r_static
id|QETH_DEVICE_ATTR
c_func
(paren
id|vipa_add6
comma
id|add6
comma
l_int|0644
comma
id|qeth_dev_vipa_add6_show
comma
id|qeth_dev_vipa_add6_store
)paren
suffix:semicolon
r_static
id|ssize_t
DECL|function|qeth_dev_vipa_del6_store
id|qeth_dev_vipa_del6_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|qeth_check_layer2
c_func
(paren
id|card
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
r_return
id|qeth_dev_vipa_del_store
c_func
(paren
id|buf
comma
id|count
comma
id|card
comma
id|QETH_PROT_IPV6
)paren
suffix:semicolon
)brace
r_static
id|QETH_DEVICE_ATTR
c_func
(paren
id|vipa_del6
comma
id|del6
comma
l_int|0200
comma
l_int|NULL
comma
id|qeth_dev_vipa_del6_store
)paren
suffix:semicolon
macro_line|#endif /* CONFIG_QETH_IPV6 */
DECL|variable|qeth_vipa_device_attrs
r_static
r_struct
id|device_attribute
op_star
id|qeth_vipa_device_attrs
(braket
)braket
op_assign
(brace
op_amp
id|dev_attr_vipa_add4
comma
op_amp
id|dev_attr_vipa_del4
comma
macro_line|#ifdef CONFIG_QETH_IPV6
op_amp
id|dev_attr_vipa_add6
comma
op_amp
id|dev_attr_vipa_del6
comma
macro_line|#endif
l_int|NULL
comma
)brace
suffix:semicolon
DECL|variable|qeth_device_vipa_group
r_static
r_struct
id|attribute_group
id|qeth_device_vipa_group
op_assign
(brace
dot
id|name
op_assign
l_string|&quot;vipa&quot;
comma
dot
id|attrs
op_assign
(paren
r_struct
id|attribute
op_star
op_star
)paren
id|qeth_vipa_device_attrs
comma
)brace
suffix:semicolon
r_static
r_inline
id|ssize_t
DECL|function|qeth_dev_rxip_add_show
id|qeth_dev_rxip_add_show
c_func
(paren
r_char
op_star
id|buf
comma
r_struct
id|qeth_card
op_star
id|card
comma
r_enum
id|qeth_prot_versions
id|proto
)paren
(brace
r_struct
id|qeth_ipaddr
op_star
id|ipaddr
suffix:semicolon
r_char
id|addr_str
(braket
l_int|40
)braket
suffix:semicolon
r_int
id|entry_len
suffix:semicolon
multiline_comment|/* length of 1 entry string, differs between v4 and v6 */
r_int
r_int
id|flags
suffix:semicolon
r_int
id|i
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|qeth_check_layer2
c_func
(paren
id|card
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
id|entry_len
op_assign
(paren
id|proto
op_eq
id|QETH_PROT_IPV4
)paren
ques
c_cond
l_int|12
suffix:colon
l_int|40
suffix:semicolon
id|entry_len
op_add_assign
l_int|2
suffix:semicolon
multiline_comment|/* &bslash;n + terminator */
id|spin_lock_irqsave
c_func
(paren
op_amp
id|card-&gt;ip_lock
comma
id|flags
)paren
suffix:semicolon
(def_block
id|list_for_each_entry
c_func
(paren
id|ipaddr
comma
op_amp
id|card-&gt;ip_list
comma
id|entry
)paren
(brace
r_if
c_cond
(paren
id|ipaddr-&gt;proto
op_ne
id|proto
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|ipaddr-&gt;type
op_ne
id|QETH_IP_TYPE_RXIP
)paren
r_continue
suffix:semicolon
multiline_comment|/* String must not be longer than PAGE_SIZE. So we check if&n;&t;&t; * string length gets near PAGE_SIZE. Then we can savely display&n;&t;&t; * the next IPv6 address (worst case, compared to IPv4) */
r_if
c_cond
(paren
(paren
id|PAGE_SIZE
op_minus
id|i
)paren
op_le
id|entry_len
)paren
r_break
suffix:semicolon
id|qeth_ipaddr_to_string
c_func
(paren
id|proto
comma
(paren
r_const
id|u8
op_star
)paren
op_amp
id|ipaddr-&gt;u
comma
id|addr_str
)paren
suffix:semicolon
id|i
op_add_assign
id|snprintf
c_func
(paren
id|buf
op_plus
id|i
comma
id|PAGE_SIZE
op_minus
id|i
comma
l_string|&quot;%s&bslash;n&quot;
comma
id|addr_str
)paren
suffix:semicolon
)brace
)def_block
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|card-&gt;ip_lock
comma
id|flags
)paren
suffix:semicolon
id|i
op_add_assign
id|snprintf
c_func
(paren
id|buf
op_plus
id|i
comma
id|PAGE_SIZE
op_minus
id|i
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
r_return
id|i
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_dev_rxip_add4_show
id|qeth_dev_rxip_add4_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|qeth_dev_rxip_add_show
c_func
(paren
id|buf
comma
id|card
comma
id|QETH_PROT_IPV4
)paren
suffix:semicolon
)brace
r_static
r_inline
r_int
DECL|function|qeth_parse_rxipe
id|qeth_parse_rxipe
c_func
(paren
r_const
r_char
op_star
id|buf
comma
r_enum
id|qeth_prot_versions
id|proto
comma
id|u8
op_star
id|addr
)paren
(brace
r_if
c_cond
(paren
id|qeth_string_to_ipaddr
c_func
(paren
id|buf
comma
id|proto
comma
id|addr
)paren
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;Invalid IP address format!&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_inline
id|ssize_t
DECL|function|qeth_dev_rxip_add_store
id|qeth_dev_rxip_add_store
c_func
(paren
r_const
r_char
op_star
id|buf
comma
r_int
id|count
comma
r_struct
id|qeth_card
op_star
id|card
comma
r_enum
id|qeth_prot_versions
id|proto
)paren
(brace
id|u8
id|addr
(braket
l_int|16
)braket
op_assign
(brace
l_int|0
comma
)brace
suffix:semicolon
r_int
id|rc
suffix:semicolon
r_if
c_cond
(paren
id|qeth_check_layer2
c_func
(paren
id|card
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
r_if
c_cond
(paren
(paren
id|rc
op_assign
id|qeth_parse_rxipe
c_func
(paren
id|buf
comma
id|proto
comma
id|addr
)paren
)paren
)paren
r_return
id|rc
suffix:semicolon
r_if
c_cond
(paren
(paren
id|rc
op_assign
id|qeth_add_rxip
c_func
(paren
id|card
comma
id|proto
comma
id|addr
)paren
)paren
)paren
r_return
id|rc
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_dev_rxip_add4_store
id|qeth_dev_rxip_add4_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|qeth_dev_rxip_add_store
c_func
(paren
id|buf
comma
id|count
comma
id|card
comma
id|QETH_PROT_IPV4
)paren
suffix:semicolon
)brace
r_static
id|QETH_DEVICE_ATTR
c_func
(paren
id|rxip_add4
comma
id|add4
comma
l_int|0644
comma
id|qeth_dev_rxip_add4_show
comma
id|qeth_dev_rxip_add4_store
)paren
suffix:semicolon
r_static
r_inline
id|ssize_t
DECL|function|qeth_dev_rxip_del_store
id|qeth_dev_rxip_del_store
c_func
(paren
r_const
r_char
op_star
id|buf
comma
r_int
id|count
comma
r_struct
id|qeth_card
op_star
id|card
comma
r_enum
id|qeth_prot_versions
id|proto
)paren
(brace
id|u8
id|addr
(braket
l_int|16
)braket
suffix:semicolon
r_int
id|rc
suffix:semicolon
r_if
c_cond
(paren
id|qeth_check_layer2
c_func
(paren
id|card
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
r_if
c_cond
(paren
(paren
id|rc
op_assign
id|qeth_parse_rxipe
c_func
(paren
id|buf
comma
id|proto
comma
id|addr
)paren
)paren
)paren
r_return
id|rc
suffix:semicolon
id|qeth_del_rxip
c_func
(paren
id|card
comma
id|proto
comma
id|addr
)paren
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_dev_rxip_del4_store
id|qeth_dev_rxip_del4_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|qeth_dev_rxip_del_store
c_func
(paren
id|buf
comma
id|count
comma
id|card
comma
id|QETH_PROT_IPV4
)paren
suffix:semicolon
)brace
r_static
id|QETH_DEVICE_ATTR
c_func
(paren
id|rxip_del4
comma
id|del4
comma
l_int|0200
comma
l_int|NULL
comma
id|qeth_dev_rxip_del4_store
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_QETH_IPV6
r_static
id|ssize_t
DECL|function|qeth_dev_rxip_add6_show
id|qeth_dev_rxip_add6_show
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|qeth_dev_rxip_add_show
c_func
(paren
id|buf
comma
id|card
comma
id|QETH_PROT_IPV6
)paren
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|qeth_dev_rxip_add6_store
id|qeth_dev_rxip_add6_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|qeth_dev_rxip_add_store
c_func
(paren
id|buf
comma
id|count
comma
id|card
comma
id|QETH_PROT_IPV6
)paren
suffix:semicolon
)brace
r_static
id|QETH_DEVICE_ATTR
c_func
(paren
id|rxip_add6
comma
id|add6
comma
l_int|0644
comma
id|qeth_dev_rxip_add6_show
comma
id|qeth_dev_rxip_add6_store
)paren
suffix:semicolon
r_static
id|ssize_t
DECL|function|qeth_dev_rxip_del6_store
id|qeth_dev_rxip_del6_store
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|qeth_card
op_star
id|card
op_assign
id|dev-&gt;driver_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|qeth_dev_rxip_del_store
c_func
(paren
id|buf
comma
id|count
comma
id|card
comma
id|QETH_PROT_IPV6
)paren
suffix:semicolon
)brace
r_static
id|QETH_DEVICE_ATTR
c_func
(paren
id|rxip_del6
comma
id|del6
comma
l_int|0200
comma
l_int|NULL
comma
id|qeth_dev_rxip_del6_store
)paren
suffix:semicolon
macro_line|#endif /* CONFIG_QETH_IPV6 */
DECL|variable|qeth_rxip_device_attrs
r_static
r_struct
id|device_attribute
op_star
id|qeth_rxip_device_attrs
(braket
)braket
op_assign
(brace
op_amp
id|dev_attr_rxip_add4
comma
op_amp
id|dev_attr_rxip_del4
comma
macro_line|#ifdef CONFIG_QETH_IPV6
op_amp
id|dev_attr_rxip_add6
comma
op_amp
id|dev_attr_rxip_del6
comma
macro_line|#endif
l_int|NULL
comma
)brace
suffix:semicolon
DECL|variable|qeth_device_rxip_group
r_static
r_struct
id|attribute_group
id|qeth_device_rxip_group
op_assign
(brace
dot
id|name
op_assign
l_string|&quot;rxip&quot;
comma
dot
id|attrs
op_assign
(paren
r_struct
id|attribute
op_star
op_star
)paren
id|qeth_rxip_device_attrs
comma
)brace
suffix:semicolon
r_int
DECL|function|qeth_create_device_attributes
id|qeth_create_device_attributes
c_func
(paren
r_struct
id|device
op_star
id|dev
)paren
(brace
r_int
id|ret
suffix:semicolon
r_if
c_cond
(paren
(paren
id|ret
op_assign
id|sysfs_create_group
c_func
(paren
op_amp
id|dev-&gt;kobj
comma
op_amp
id|qeth_device_attr_group
)paren
)paren
)paren
r_return
id|ret
suffix:semicolon
r_if
c_cond
(paren
(paren
id|ret
op_assign
id|sysfs_create_group
c_func
(paren
op_amp
id|dev-&gt;kobj
comma
op_amp
id|qeth_device_ipato_group
)paren
)paren
)paren
(brace
id|sysfs_remove_group
c_func
(paren
op_amp
id|dev-&gt;kobj
comma
op_amp
id|qeth_device_attr_group
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|ret
op_assign
id|sysfs_create_group
c_func
(paren
op_amp
id|dev-&gt;kobj
comma
op_amp
id|qeth_device_vipa_group
)paren
)paren
)paren
(brace
id|sysfs_remove_group
c_func
(paren
op_amp
id|dev-&gt;kobj
comma
op_amp
id|qeth_device_attr_group
)paren
suffix:semicolon
id|sysfs_remove_group
c_func
(paren
op_amp
id|dev-&gt;kobj
comma
op_amp
id|qeth_device_ipato_group
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|ret
op_assign
id|sysfs_create_group
c_func
(paren
op_amp
id|dev-&gt;kobj
comma
op_amp
id|qeth_device_rxip_group
)paren
)paren
)paren
(brace
id|sysfs_remove_group
c_func
(paren
op_amp
id|dev-&gt;kobj
comma
op_amp
id|qeth_device_attr_group
)paren
suffix:semicolon
id|sysfs_remove_group
c_func
(paren
op_amp
id|dev-&gt;kobj
comma
op_amp
id|qeth_device_ipato_group
)paren
suffix:semicolon
id|sysfs_remove_group
c_func
(paren
op_amp
id|dev-&gt;kobj
comma
op_amp
id|qeth_device_vipa_group
)paren
suffix:semicolon
)brace
r_return
id|ret
suffix:semicolon
)brace
r_void
DECL|function|qeth_remove_device_attributes
id|qeth_remove_device_attributes
c_func
(paren
r_struct
id|device
op_star
id|dev
)paren
(brace
id|sysfs_remove_group
c_func
(paren
op_amp
id|dev-&gt;kobj
comma
op_amp
id|qeth_device_attr_group
)paren
suffix:semicolon
id|sysfs_remove_group
c_func
(paren
op_amp
id|dev-&gt;kobj
comma
op_amp
id|qeth_device_ipato_group
)paren
suffix:semicolon
id|sysfs_remove_group
c_func
(paren
op_amp
id|dev-&gt;kobj
comma
op_amp
id|qeth_device_vipa_group
)paren
suffix:semicolon
id|sysfs_remove_group
c_func
(paren
op_amp
id|dev-&gt;kobj
comma
op_amp
id|qeth_device_rxip_group
)paren
suffix:semicolon
)brace
multiline_comment|/**********************/
multiline_comment|/* DRIVER ATTRIBUTES  */
multiline_comment|/**********************/
r_static
id|ssize_t
DECL|function|qeth_driver_group_store
id|qeth_driver_group_store
c_func
(paren
r_struct
id|device_driver
op_star
id|ddrv
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_const
r_char
op_star
id|start
comma
op_star
id|end
suffix:semicolon
r_char
id|bus_ids
(braket
l_int|3
)braket
(braket
id|BUS_ID_SIZE
)braket
comma
op_star
id|argv
(braket
l_int|3
)braket
suffix:semicolon
r_int
id|i
suffix:semicolon
r_int
id|err
suffix:semicolon
id|start
op_assign
id|buf
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|3
suffix:semicolon
id|i
op_increment
)paren
(brace
r_static
r_const
r_char
id|delim
(braket
)braket
op_assign
(brace
l_char|&squot;,&squot;
comma
l_char|&squot;,&squot;
comma
l_char|&squot;&bslash;n&squot;
)brace
suffix:semicolon
r_int
id|len
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|end
op_assign
id|strchr
c_func
(paren
id|start
comma
id|delim
(braket
id|i
)braket
)paren
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|len
op_assign
id|min_t
c_func
(paren
r_int
comma
id|BUS_ID_SIZE
comma
id|end
op_minus
id|start
)paren
suffix:semicolon
id|strncpy
c_func
(paren
id|bus_ids
(braket
id|i
)braket
comma
id|start
comma
id|len
)paren
suffix:semicolon
id|bus_ids
(braket
id|i
)braket
(braket
id|len
)braket
op_assign
l_char|&squot;&bslash;0&squot;
suffix:semicolon
id|start
op_assign
id|end
op_plus
l_int|1
suffix:semicolon
id|argv
(braket
id|i
)braket
op_assign
id|bus_ids
(braket
id|i
)braket
suffix:semicolon
)brace
id|err
op_assign
id|ccwgroup_create
c_func
(paren
id|qeth_root_dev
comma
id|qeth_ccwgroup_driver.driver_id
comma
op_amp
id|qeth_ccw_driver
comma
l_int|3
comma
id|argv
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
r_else
r_return
id|count
suffix:semicolon
)brace
r_static
id|DRIVER_ATTR
c_func
(paren
id|group
comma
l_int|0200
comma
l_int|0
comma
id|qeth_driver_group_store
)paren
suffix:semicolon
r_static
id|ssize_t
DECL|function|qeth_driver_notifier_register_store
id|qeth_driver_notifier_register_store
c_func
(paren
r_struct
id|device_driver
op_star
id|ddrv
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_int
id|rc
suffix:semicolon
r_int
id|signum
suffix:semicolon
r_char
op_star
id|tmp
comma
op_star
id|tmp2
suffix:semicolon
id|tmp
op_assign
id|strsep
c_func
(paren
(paren
r_char
op_star
op_star
)paren
op_amp
id|buf
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|tmp
comma
l_string|&quot;unregister&quot;
comma
l_int|10
)paren
)paren
(brace
r_if
c_cond
(paren
(paren
id|rc
op_assign
id|qeth_notifier_unregister
c_func
(paren
id|current
)paren
)paren
)paren
r_return
id|rc
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
id|signum
op_assign
id|simple_strtoul
c_func
(paren
id|tmp
comma
op_amp
id|tmp2
comma
l_int|10
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|signum
OL
l_int|0
)paren
op_logical_or
(paren
id|signum
OG
l_int|32
)paren
)paren
(brace
id|PRINT_WARN
c_func
(paren
l_string|&quot;Signal number %d is out of range&bslash;n&quot;
comma
id|signum
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|rc
op_assign
id|qeth_notifier_register
c_func
(paren
id|current
comma
id|signum
)paren
)paren
)paren
r_return
id|rc
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
r_static
id|DRIVER_ATTR
c_func
(paren
id|notifier_register
comma
l_int|0200
comma
l_int|0
comma
id|qeth_driver_notifier_register_store
)paren
suffix:semicolon
r_int
DECL|function|qeth_create_driver_attributes
id|qeth_create_driver_attributes
c_func
(paren
r_void
)paren
(brace
r_int
id|rc
suffix:semicolon
r_if
c_cond
(paren
(paren
id|rc
op_assign
id|driver_create_file
c_func
(paren
op_amp
id|qeth_ccwgroup_driver.driver
comma
op_amp
id|driver_attr_group
)paren
)paren
)paren
r_return
id|rc
suffix:semicolon
r_return
id|driver_create_file
c_func
(paren
op_amp
id|qeth_ccwgroup_driver.driver
comma
op_amp
id|driver_attr_notifier_register
)paren
suffix:semicolon
)brace
r_void
DECL|function|qeth_remove_driver_attributes
id|qeth_remove_driver_attributes
c_func
(paren
r_void
)paren
(brace
id|driver_remove_file
c_func
(paren
op_amp
id|qeth_ccwgroup_driver.driver
comma
op_amp
id|driver_attr_group
)paren
suffix:semicolon
id|driver_remove_file
c_func
(paren
op_amp
id|qeth_ccwgroup_driver.driver
comma
op_amp
id|driver_attr_notifier_register
)paren
suffix:semicolon
)brace
eof
