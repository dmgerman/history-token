macro_line|#ifndef S390_CIO_IOASM_H
DECL|macro|S390_CIO_IOASM_H
mdefine_line|#define S390_CIO_IOASM_H
multiline_comment|/*&n; * area for channel subsystem call&n; */
DECL|struct|chsc_area
r_struct
id|chsc_area
(brace
r_struct
(brace
multiline_comment|/* word 0 */
DECL|member|command_code1
id|__u16
id|command_code1
suffix:semicolon
DECL|member|command_code2
id|__u16
id|command_code2
suffix:semicolon
r_union
(brace
r_struct
(brace
multiline_comment|/* word 1 */
DECL|member|reserved1
id|__u32
id|reserved1
suffix:semicolon
multiline_comment|/* word 2 */
DECL|member|reserved2
id|__u32
id|reserved2
suffix:semicolon
DECL|member|sei_req
)brace
id|__attribute__
(paren
(paren
id|packed
comma
id|aligned
c_func
(paren
l_int|8
)paren
)paren
)paren
id|sei_req
suffix:semicolon
r_struct
(brace
multiline_comment|/* word 1 */
DECL|member|reserved1
id|__u16
id|reserved1
suffix:semicolon
DECL|member|f_sch
id|__u16
id|f_sch
suffix:semicolon
multiline_comment|/* first subchannel */
multiline_comment|/* word 2 */
DECL|member|reserved2
id|__u16
id|reserved2
suffix:semicolon
DECL|member|l_sch
id|__u16
id|l_sch
suffix:semicolon
multiline_comment|/* last subchannel */
DECL|member|ssd_req
)brace
id|__attribute__
(paren
(paren
id|packed
comma
id|aligned
c_func
(paren
l_int|8
)paren
)paren
)paren
id|ssd_req
suffix:semicolon
DECL|member|request_block_data
)brace
id|request_block_data
suffix:semicolon
multiline_comment|/* word 3 */
DECL|member|reserved3
id|__u32
id|reserved3
suffix:semicolon
DECL|member|request_block
)brace
id|__attribute__
(paren
(paren
id|packed
comma
id|aligned
c_func
(paren
l_int|8
)paren
)paren
)paren
id|request_block
suffix:semicolon
r_struct
(brace
multiline_comment|/* word 0 */
DECL|member|length
id|__u16
id|length
suffix:semicolon
DECL|member|response_code
id|__u16
id|response_code
suffix:semicolon
multiline_comment|/* word 1 */
DECL|member|reserved1
id|__u32
id|reserved1
suffix:semicolon
r_union
(brace
r_struct
(brace
multiline_comment|/* word 2 */
DECL|member|flags
id|__u8
id|flags
suffix:semicolon
DECL|member|vf
id|__u8
id|vf
suffix:semicolon
multiline_comment|/* validity flags */
DECL|member|rs
id|__u8
id|rs
suffix:semicolon
multiline_comment|/* reporting source */
DECL|member|cc
id|__u8
id|cc
suffix:semicolon
multiline_comment|/* content code */
multiline_comment|/* word 3 */
DECL|member|fla
id|__u16
id|fla
suffix:semicolon
multiline_comment|/* full link address */
DECL|member|rsid
id|__u16
id|rsid
suffix:semicolon
multiline_comment|/* reporting source id */
multiline_comment|/* word 4 */
DECL|member|reserved2
id|__u32
id|reserved2
suffix:semicolon
multiline_comment|/* word 5 */
DECL|member|reserved3
id|__u32
id|reserved3
suffix:semicolon
multiline_comment|/* word 6 */
DECL|member|ccdf
id|__u32
id|ccdf
suffix:semicolon
multiline_comment|/* content-code dependent field */
multiline_comment|/* word 7 */
DECL|member|reserved4
id|__u32
id|reserved4
suffix:semicolon
multiline_comment|/* word 8 */
DECL|member|reserved5
id|__u32
id|reserved5
suffix:semicolon
multiline_comment|/* word 9 */
DECL|member|reserved6
id|__u32
id|reserved6
suffix:semicolon
DECL|member|sei_res
)brace
id|__attribute__
(paren
(paren
id|packed
comma
id|aligned
c_func
(paren
l_int|8
)paren
)paren
)paren
id|sei_res
suffix:semicolon
r_struct
(brace
multiline_comment|/* word 2 */
DECL|member|sch_valid
id|__u8
id|sch_valid
suffix:colon
l_int|1
suffix:semicolon
DECL|member|dev_valid
id|__u8
id|dev_valid
suffix:colon
l_int|1
suffix:semicolon
DECL|member|st
id|__u8
id|st
suffix:colon
l_int|3
suffix:semicolon
multiline_comment|/* subchannel type */
DECL|member|zeroes
id|__u8
id|zeroes
suffix:colon
l_int|3
suffix:semicolon
DECL|member|unit_addr
id|__u8
id|unit_addr
suffix:semicolon
multiline_comment|/* unit address */
DECL|member|devno
id|__u16
id|devno
suffix:semicolon
multiline_comment|/* device number */
multiline_comment|/* word 3 */
DECL|member|path_mask
id|__u8
id|path_mask
suffix:semicolon
DECL|member|fla_valid_mask
id|__u8
id|fla_valid_mask
suffix:semicolon
DECL|member|sch
id|__u16
id|sch
suffix:semicolon
multiline_comment|/* subchannel */
multiline_comment|/* words 4-5 */
DECL|member|chpid
id|__u8
id|chpid
(braket
l_int|8
)braket
suffix:semicolon
multiline_comment|/* chpids 0-7 */
multiline_comment|/* words 6-9 */
DECL|member|fla
id|__u16
id|fla
(braket
l_int|8
)braket
suffix:semicolon
multiline_comment|/* full link addresses 0-7 */
DECL|member|ssd_res
)brace
id|__attribute__
(paren
(paren
id|packed
comma
id|aligned
c_func
(paren
l_int|8
)paren
)paren
)paren
id|ssd_res
suffix:semicolon
DECL|member|response_block_data
)brace
id|response_block_data
suffix:semicolon
DECL|member|response_block
)brace
id|__attribute__
(paren
(paren
id|packed
comma
id|aligned
c_func
(paren
l_int|8
)paren
)paren
)paren
id|response_block
suffix:semicolon
)brace
id|__attribute__
(paren
(paren
id|packed
comma
id|aligned
c_func
(paren
id|PAGE_SIZE
)paren
)paren
)paren
suffix:semicolon
multiline_comment|/*&n; * TPI info structure&n; */
DECL|struct|tpi_info
r_struct
id|tpi_info
(brace
DECL|member|reserved1
id|__u32
id|reserved1
suffix:colon
l_int|16
suffix:semicolon
multiline_comment|/* reserved 0x00000001 */
DECL|member|irq
id|__u32
id|irq
suffix:colon
l_int|16
suffix:semicolon
multiline_comment|/* aka. subchannel number */
DECL|member|intparm
id|__u32
id|intparm
suffix:semicolon
multiline_comment|/* interruption parameter */
DECL|member|adapter_IO
id|__u32
id|adapter_IO
suffix:colon
l_int|1
suffix:semicolon
DECL|member|reserved2
id|__u32
id|reserved2
suffix:colon
l_int|1
suffix:semicolon
DECL|member|isc
id|__u32
id|isc
suffix:colon
l_int|3
suffix:semicolon
DECL|member|reserved3
id|__u32
id|reserved3
suffix:colon
l_int|12
suffix:semicolon
DECL|member|int_type
id|__u32
id|int_type
suffix:colon
l_int|3
suffix:semicolon
DECL|member|reserved4
id|__u32
id|reserved4
suffix:colon
l_int|12
suffix:semicolon
)brace
id|__attribute__
(paren
(paren
id|packed
)paren
)paren
suffix:semicolon
multiline_comment|/*&n; * Some S390 specific IO instructions as inline&n; */
DECL|function|stsch
r_extern
id|__inline__
r_int
id|stsch
c_func
(paren
r_int
id|irq
comma
r_volatile
r_struct
id|schib
op_star
id|addr
)paren
(brace
r_int
id|ccode
suffix:semicolon
id|__asm__
id|__volatile__
c_func
(paren
l_string|&quot;   lr&t;  1,%1&bslash;n&quot;
l_string|&quot;   stsch 0(%2)&bslash;n&quot;
l_string|&quot;   ipm&t;  %0&bslash;n&quot;
l_string|&quot;   srl&t;  %0,28&quot;
suffix:colon
l_string|&quot;=d&quot;
(paren
id|ccode
)paren
suffix:colon
l_string|&quot;d&quot;
(paren
id|irq
op_or
l_int|0x10000
)paren
comma
l_string|&quot;a&quot;
(paren
id|addr
)paren
suffix:colon
l_string|&quot;cc&quot;
comma
l_string|&quot;1&quot;
)paren
suffix:semicolon
r_return
id|ccode
suffix:semicolon
)brace
DECL|function|msch
r_extern
id|__inline__
r_int
id|msch
c_func
(paren
r_int
id|irq
comma
r_volatile
r_struct
id|schib
op_star
id|addr
)paren
(brace
r_int
id|ccode
suffix:semicolon
id|__asm__
id|__volatile__
c_func
(paren
l_string|&quot;   lr&t;  1,%1&bslash;n&quot;
l_string|&quot;   msch  0(%2)&bslash;n&quot;
l_string|&quot;   ipm&t;  %0&bslash;n&quot;
l_string|&quot;   srl&t;  %0,28&quot;
suffix:colon
l_string|&quot;=d&quot;
(paren
id|ccode
)paren
suffix:colon
l_string|&quot;d&quot;
(paren
id|irq
op_or
l_int|0x10000L
)paren
comma
l_string|&quot;a&quot;
(paren
id|addr
)paren
suffix:colon
l_string|&quot;cc&quot;
comma
l_string|&quot;1&quot;
)paren
suffix:semicolon
r_return
id|ccode
suffix:semicolon
)brace
DECL|function|msch_err
r_extern
id|__inline__
r_int
id|msch_err
c_func
(paren
r_int
id|irq
comma
r_volatile
r_struct
id|schib
op_star
id|addr
)paren
(brace
r_int
id|ccode
suffix:semicolon
id|__asm__
id|__volatile__
c_func
(paren
l_string|&quot;    lhi  %0,%3&bslash;n&quot;
l_string|&quot;    lr&t;  1,%1&bslash;n&quot;
l_string|&quot;    msch 0(%2)&bslash;n&quot;
l_string|&quot;0:  ipm  %0&bslash;n&quot;
l_string|&quot;    srl  %0,28&bslash;n&quot;
l_string|&quot;1:&bslash;n&quot;
macro_line|#ifdef CONFIG_ARCH_S390X
l_string|&quot;.section __ex_table,&bslash;&quot;a&bslash;&quot;&bslash;n&quot;
l_string|&quot;   .align 8&bslash;n&quot;
l_string|&quot;   .quad 0b,1b&bslash;n&quot;
l_string|&quot;.previous&quot;
macro_line|#else
l_string|&quot;.section __ex_table,&bslash;&quot;a&bslash;&quot;&bslash;n&quot;
l_string|&quot;   .align 4&bslash;n&quot;
l_string|&quot;   .long 0b,1b&bslash;n&quot;
l_string|&quot;.previous&quot;
macro_line|#endif
suffix:colon
l_string|&quot;=&amp;d&quot;
(paren
id|ccode
)paren
suffix:colon
l_string|&quot;d&quot;
(paren
id|irq
op_or
l_int|0x10000L
)paren
comma
l_string|&quot;a&quot;
(paren
id|addr
)paren
comma
l_string|&quot;K&quot;
(paren
op_minus
id|EIO
)paren
suffix:colon
l_string|&quot;cc&quot;
comma
l_string|&quot;1&quot;
)paren
suffix:semicolon
r_return
id|ccode
suffix:semicolon
)brace
DECL|function|tsch
r_extern
id|__inline__
r_int
id|tsch
c_func
(paren
r_int
id|irq
comma
r_volatile
r_struct
id|irb
op_star
id|addr
)paren
(brace
r_int
id|ccode
suffix:semicolon
id|__asm__
id|__volatile__
c_func
(paren
l_string|&quot;   lr&t;  1,%1&bslash;n&quot;
l_string|&quot;   tsch  0(%2)&bslash;n&quot;
l_string|&quot;   ipm&t;  %0&bslash;n&quot;
l_string|&quot;   srl&t;  %0,28&quot;
suffix:colon
l_string|&quot;=d&quot;
(paren
id|ccode
)paren
suffix:colon
l_string|&quot;d&quot;
(paren
id|irq
op_or
l_int|0x10000L
)paren
comma
l_string|&quot;a&quot;
(paren
id|addr
)paren
suffix:colon
l_string|&quot;cc&quot;
comma
l_string|&quot;1&quot;
)paren
suffix:semicolon
r_return
id|ccode
suffix:semicolon
)brace
DECL|function|tpi
r_extern
id|__inline__
r_int
id|tpi
c_func
(paren
r_volatile
r_struct
id|tpi_info
op_star
id|addr
)paren
(brace
r_int
id|ccode
suffix:semicolon
id|__asm__
id|__volatile__
c_func
(paren
l_string|&quot;   tpi&t;  0(%1)&bslash;n&quot;
l_string|&quot;   ipm&t;  %0&bslash;n&quot;
l_string|&quot;   srl&t;  %0,28&quot;
suffix:colon
l_string|&quot;=d&quot;
(paren
id|ccode
)paren
suffix:colon
l_string|&quot;a&quot;
(paren
id|addr
)paren
suffix:colon
l_string|&quot;cc&quot;
comma
l_string|&quot;1&quot;
)paren
suffix:semicolon
r_return
id|ccode
suffix:semicolon
)brace
DECL|function|ssch
r_extern
id|__inline__
r_int
id|ssch
c_func
(paren
r_int
id|irq
comma
r_volatile
r_struct
id|orb
op_star
id|addr
)paren
(brace
r_int
id|ccode
suffix:semicolon
id|__asm__
id|__volatile__
c_func
(paren
l_string|&quot;   lr&t;  1,%1&bslash;n&quot;
l_string|&quot;   ssch  0(%2)&bslash;n&quot;
l_string|&quot;   ipm&t;  %0&bslash;n&quot;
l_string|&quot;   srl&t;  %0,28&quot;
suffix:colon
l_string|&quot;=d&quot;
(paren
id|ccode
)paren
suffix:colon
l_string|&quot;d&quot;
(paren
id|irq
op_or
l_int|0x10000L
)paren
comma
l_string|&quot;a&quot;
(paren
id|addr
)paren
suffix:colon
l_string|&quot;cc&quot;
comma
l_string|&quot;1&quot;
)paren
suffix:semicolon
r_return
id|ccode
suffix:semicolon
)brace
DECL|function|rsch
r_extern
id|__inline__
r_int
id|rsch
c_func
(paren
r_int
id|irq
)paren
(brace
r_int
id|ccode
suffix:semicolon
id|__asm__
id|__volatile__
c_func
(paren
l_string|&quot;   lr&t;  1,%1&bslash;n&quot;
l_string|&quot;   rsch&bslash;n&quot;
l_string|&quot;   ipm&t;  %0&bslash;n&quot;
l_string|&quot;   srl&t;  %0,28&quot;
suffix:colon
l_string|&quot;=d&quot;
(paren
id|ccode
)paren
suffix:colon
l_string|&quot;d&quot;
(paren
id|irq
op_or
l_int|0x10000L
)paren
suffix:colon
l_string|&quot;cc&quot;
comma
l_string|&quot;1&quot;
)paren
suffix:semicolon
r_return
id|ccode
suffix:semicolon
)brace
DECL|function|csch
r_extern
id|__inline__
r_int
id|csch
c_func
(paren
r_int
id|irq
)paren
(brace
r_int
id|ccode
suffix:semicolon
id|__asm__
id|__volatile__
c_func
(paren
l_string|&quot;   lr&t;  1,%1&bslash;n&quot;
l_string|&quot;   csch&bslash;n&quot;
l_string|&quot;   ipm&t;  %0&bslash;n&quot;
l_string|&quot;   srl&t;  %0,28&quot;
suffix:colon
l_string|&quot;=d&quot;
(paren
id|ccode
)paren
suffix:colon
l_string|&quot;d&quot;
(paren
id|irq
op_or
l_int|0x10000L
)paren
suffix:colon
l_string|&quot;cc&quot;
comma
l_string|&quot;1&quot;
)paren
suffix:semicolon
r_return
id|ccode
suffix:semicolon
)brace
DECL|function|hsch
r_extern
id|__inline__
r_int
id|hsch
c_func
(paren
r_int
id|irq
)paren
(brace
r_int
id|ccode
suffix:semicolon
id|__asm__
id|__volatile__
c_func
(paren
l_string|&quot;   lr&t;  1,%1&bslash;n&quot;
l_string|&quot;   hsch&bslash;n&quot;
l_string|&quot;   ipm&t;  %0&bslash;n&quot;
l_string|&quot;   srl&t;  %0,28&quot;
suffix:colon
l_string|&quot;=d&quot;
(paren
id|ccode
)paren
suffix:colon
l_string|&quot;d&quot;
(paren
id|irq
op_or
l_int|0x10000L
)paren
suffix:colon
l_string|&quot;cc&quot;
comma
l_string|&quot;1&quot;
)paren
suffix:semicolon
r_return
id|ccode
suffix:semicolon
)brace
DECL|function|xsch
r_extern
id|__inline__
r_int
id|xsch
c_func
(paren
r_int
id|irq
)paren
(brace
r_int
id|ccode
suffix:semicolon
id|__asm__
id|__volatile__
c_func
(paren
l_string|&quot;   lr&t;  1,%1&bslash;n&quot;
l_string|&quot;   .insn rre,0xb2760000,%1,0&bslash;n&quot;
l_string|&quot;   ipm&t;  %0&bslash;n&quot;
l_string|&quot;   srl&t;  %0,28&quot;
suffix:colon
l_string|&quot;=d&quot;
(paren
id|ccode
)paren
suffix:colon
l_string|&quot;d&quot;
(paren
id|irq
op_or
l_int|0x10000L
)paren
suffix:colon
l_string|&quot;cc&quot;
comma
l_string|&quot;1&quot;
)paren
suffix:semicolon
r_return
id|ccode
suffix:semicolon
)brace
DECL|function|chsc
r_extern
id|__inline__
r_int
id|chsc
c_func
(paren
r_void
op_star
id|chsc_area
)paren
(brace
r_int
id|cc
suffix:semicolon
id|__asm__
id|__volatile__
(paren
l_string|&quot;.insn&t;rre,0xb25f0000,%1,0&t;&bslash;n&bslash;t&quot;
l_string|&quot;ipm&t;%0&t;&bslash;n&bslash;t&quot;
l_string|&quot;srl&t;%0,28&t;&bslash;n&bslash;t&quot;
suffix:colon
l_string|&quot;=d&quot;
(paren
id|cc
)paren
suffix:colon
l_string|&quot;d&quot;
(paren
id|chsc_area
)paren
suffix:colon
l_string|&quot;cc&quot;
)paren
suffix:semicolon
r_return
id|cc
suffix:semicolon
)brace
DECL|function|iac
r_extern
id|__inline__
r_int
id|iac
c_func
(paren
r_void
)paren
(brace
r_int
id|ccode
suffix:semicolon
id|__asm__
id|__volatile__
c_func
(paren
l_string|&quot;   iac&t;  1&bslash;n&quot;
l_string|&quot;   ipm&t;  %0&bslash;n&quot;
l_string|&quot;   srl&t;  %0,28&quot;
suffix:colon
l_string|&quot;=d&quot;
(paren
id|ccode
)paren
suffix:colon
suffix:colon
l_string|&quot;cc&quot;
comma
l_string|&quot;1&quot;
)paren
suffix:semicolon
r_return
id|ccode
suffix:semicolon
)brace
DECL|function|rchp
r_extern
id|__inline__
r_int
id|rchp
c_func
(paren
r_int
id|chpid
)paren
(brace
r_int
id|ccode
suffix:semicolon
id|__asm__
id|__volatile__
c_func
(paren
l_string|&quot;   lr&t;  1,%1&bslash;n&quot;
l_string|&quot;   rchp&bslash;n&quot;
l_string|&quot;   ipm&t;  %0&bslash;n&quot;
l_string|&quot;   srl&t;  %0,28&quot;
suffix:colon
l_string|&quot;=d&quot;
(paren
id|ccode
)paren
suffix:colon
l_string|&quot;d&quot;
(paren
id|chpid
)paren
suffix:colon
l_string|&quot;cc&quot;
comma
l_string|&quot;1&quot;
)paren
suffix:semicolon
r_return
id|ccode
suffix:semicolon
)brace
macro_line|#endif
eof
