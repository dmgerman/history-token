multiline_comment|/*&n; * Driver for AVM Fritz!PCI, Fritz!PCI v2, Fritz!PnP ISDN cards&n; *&n; * Author       Kai Germaschewski&n; * Copyright    2001 by Kai Germaschewski  &lt;kai.germaschewski@gmx.de&gt;&n; *              2001 by Karsten Keil       &lt;keil@isdn4linux.de&gt;&n; * &n; * based upon Karsten Keil&squot;s original avm_pci.c driver&n; *&n; * This software may be used and distributed according to the terms&n; * of the GNU General Public License, incorporated herein by reference.&n; *&n; * Thanks to Wizard Computersysteme GmbH, Bremervoerde and&n; *           SoHaNet Technology GmbH, Berlin&n; * for supporting the development of this driver&n; */
multiline_comment|/* TODO:&n; *&n; * o POWER PC&n; * o clean up debugging&n; * o tx_skb at PH_DEACTIVATE time&n; */
macro_line|#include &lt;linux/version.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/pci.h&gt;
macro_line|#include &lt;linux/isapnp.h&gt;
macro_line|#include &lt;linux/kmod.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;linux/skbuff.h&gt;
macro_line|#include &lt;linux/netdevice.h&gt;
macro_line|#include &quot;hisax_fcpcipnp.h&quot;
singleline_comment|// debugging cruft
DECL|macro|__debug_variable
mdefine_line|#define __debug_variable debug
macro_line|#include &quot;hisax_debug.h&quot;
macro_line|#ifdef CONFIG_HISAX_DEBUG
DECL|variable|debug
r_static
r_int
id|debug
op_assign
l_int|0
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|debug
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
macro_line|#endif
id|MODULE_AUTHOR
c_func
(paren
l_string|&quot;Kai Germaschewski &lt;kai.germaschewski@gmx.de&gt;/Karsten Keil &lt;kkeil@suse.de&gt;&quot;
)paren
suffix:semicolon
id|MODULE_DESCRIPTION
c_func
(paren
l_string|&quot;AVM Fritz!PCI/PnP ISDN driver&quot;
)paren
suffix:semicolon
DECL|variable|__devinitdata
r_static
r_struct
id|pci_device_id
id|fcpci_ids
(braket
)braket
id|__devinitdata
op_assign
(brace
(brace
id|PCI_VENDOR_ID_AVM
comma
id|PCI_DEVICE_ID_AVM_A1
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
(paren
r_int
r_int
)paren
l_string|&quot;Fritz!Card PCI&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_AVM
comma
id|PCI_DEVICE_ID_AVM_A1_V2
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
(paren
r_int
r_int
)paren
l_string|&quot;Fritz!Card PCI v2&quot;
)brace
comma
(brace
)brace
)brace
suffix:semicolon
id|MODULE_DEVICE_TABLE
c_func
(paren
id|pci
comma
id|fcpci_ids
)paren
suffix:semicolon
DECL|variable|__devinitdata
r_static
r_struct
id|isapnp_device_id
id|fcpnp_ids
(braket
)braket
id|__devinitdata
op_assign
(brace
(brace
id|ISAPNP_VENDOR
c_func
(paren
l_char|&squot;A&squot;
comma
l_char|&squot;V&squot;
comma
l_char|&squot;M&squot;
)paren
comma
id|ISAPNP_FUNCTION
c_func
(paren
l_int|0x0900
)paren
comma
id|ISAPNP_VENDOR
c_func
(paren
l_char|&squot;A&squot;
comma
l_char|&squot;V&squot;
comma
l_char|&squot;M&squot;
)paren
comma
id|ISAPNP_FUNCTION
c_func
(paren
l_int|0x0900
)paren
comma
(paren
r_int
r_int
)paren
l_string|&quot;Fritz!Card PnP&quot;
)brace
comma
(brace
)brace
)brace
suffix:semicolon
id|MODULE_DEVICE_TABLE
c_func
(paren
id|isapnp
comma
id|fcpnp_ids
)paren
suffix:semicolon
DECL|variable|protocol
r_static
r_int
id|protocol
op_assign
l_int|2
suffix:semicolon
multiline_comment|/* EURO-ISDN Default */
id|MODULE_PARM
c_func
(paren
id|protocol
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
singleline_comment|// ----------------------------------------------------------------------
DECL|macro|AVM_INDEX
mdefine_line|#define  AVM_INDEX              0x04
DECL|macro|AVM_DATA
mdefine_line|#define  AVM_DATA               0x10
DECL|macro|AVM_IDX_HDLC_1
mdefine_line|#define&t; AVM_IDX_HDLC_1&t;&t;0x00
DECL|macro|AVM_IDX_HDLC_2
mdefine_line|#define&t; AVM_IDX_HDLC_2&t;&t;0x01
DECL|macro|AVM_IDX_ISAC_FIFO
mdefine_line|#define&t; AVM_IDX_ISAC_FIFO&t;0x02
DECL|macro|AVM_IDX_ISAC_REG_LOW
mdefine_line|#define&t; AVM_IDX_ISAC_REG_LOW&t;0x04
DECL|macro|AVM_IDX_ISAC_REG_HIGH
mdefine_line|#define&t; AVM_IDX_ISAC_REG_HIGH&t;0x06
DECL|macro|AVM_STATUS0
mdefine_line|#define  AVM_STATUS0            0x02
DECL|macro|AVM_STATUS0_IRQ_ISAC
mdefine_line|#define  AVM_STATUS0_IRQ_ISAC&t;0x01
DECL|macro|AVM_STATUS0_IRQ_HDLC
mdefine_line|#define  AVM_STATUS0_IRQ_HDLC&t;0x02
DECL|macro|AVM_STATUS0_IRQ_TIMER
mdefine_line|#define  AVM_STATUS0_IRQ_TIMER&t;0x04
DECL|macro|AVM_STATUS0_IRQ_MASK
mdefine_line|#define  AVM_STATUS0_IRQ_MASK&t;0x07
DECL|macro|AVM_STATUS0_RESET
mdefine_line|#define  AVM_STATUS0_RESET&t;0x01
DECL|macro|AVM_STATUS0_DIS_TIMER
mdefine_line|#define  AVM_STATUS0_DIS_TIMER&t;0x02
DECL|macro|AVM_STATUS0_RES_TIMER
mdefine_line|#define  AVM_STATUS0_RES_TIMER&t;0x04
DECL|macro|AVM_STATUS0_ENA_IRQ
mdefine_line|#define  AVM_STATUS0_ENA_IRQ&t;0x08
DECL|macro|AVM_STATUS0_TESTBIT
mdefine_line|#define  AVM_STATUS0_TESTBIT&t;0x10
DECL|macro|AVM_STATUS1
mdefine_line|#define  AVM_STATUS1            0x03
DECL|macro|AVM_STATUS1_ENA_IOM
mdefine_line|#define  AVM_STATUS1_ENA_IOM&t;0x80
DECL|macro|HDLC_FIFO
mdefine_line|#define  HDLC_FIFO&t;&t;0x0
DECL|macro|HDLC_STATUS
mdefine_line|#define  HDLC_STATUS&t;&t;0x4
DECL|macro|HDLC_CTRL
mdefine_line|#define  HDLC_CTRL&t;&t;0x4
DECL|macro|HDLC_MODE_ITF_FLG
mdefine_line|#define  HDLC_MODE_ITF_FLG&t;0x01
DECL|macro|HDLC_MODE_TRANS
mdefine_line|#define  HDLC_MODE_TRANS&t;0x02
DECL|macro|HDLC_MODE_CCR_7
mdefine_line|#define  HDLC_MODE_CCR_7&t;0x04
DECL|macro|HDLC_MODE_CCR_16
mdefine_line|#define  HDLC_MODE_CCR_16&t;0x08
DECL|macro|HDLC_MODE_TESTLOOP
mdefine_line|#define  HDLC_MODE_TESTLOOP&t;0x80
DECL|macro|HDLC_INT_XPR
mdefine_line|#define  HDLC_INT_XPR&t;&t;0x80
DECL|macro|HDLC_INT_XDU
mdefine_line|#define  HDLC_INT_XDU&t;&t;0x40
DECL|macro|HDLC_INT_RPR
mdefine_line|#define  HDLC_INT_RPR&t;&t;0x20
DECL|macro|HDLC_INT_MASK
mdefine_line|#define  HDLC_INT_MASK&t;&t;0xE0
DECL|macro|HDLC_STAT_RME
mdefine_line|#define  HDLC_STAT_RME&t;&t;0x01
DECL|macro|HDLC_STAT_RDO
mdefine_line|#define  HDLC_STAT_RDO&t;&t;0x10
DECL|macro|HDLC_STAT_CRCVFRRAB
mdefine_line|#define  HDLC_STAT_CRCVFRRAB&t;0x0E
DECL|macro|HDLC_STAT_CRCVFR
mdefine_line|#define  HDLC_STAT_CRCVFR&t;0x06
DECL|macro|HDLC_STAT_RML_MASK
mdefine_line|#define  HDLC_STAT_RML_MASK&t;0x3f00
DECL|macro|HDLC_CMD_XRS
mdefine_line|#define  HDLC_CMD_XRS&t;&t;0x80
DECL|macro|HDLC_CMD_XME
mdefine_line|#define  HDLC_CMD_XME&t;&t;0x01
DECL|macro|HDLC_CMD_RRS
mdefine_line|#define  HDLC_CMD_RRS&t;&t;0x20
DECL|macro|HDLC_CMD_XML_MASK
mdefine_line|#define  HDLC_CMD_XML_MASK&t;0x3f00
DECL|macro|AVM_HDLC_FIFO_1
mdefine_line|#define  AVM_HDLC_FIFO_1        0x10
DECL|macro|AVM_HDLC_FIFO_2
mdefine_line|#define  AVM_HDLC_FIFO_2        0x18
DECL|macro|AVM_HDLC_STATUS_1
mdefine_line|#define  AVM_HDLC_STATUS_1      0x14
DECL|macro|AVM_HDLC_STATUS_2
mdefine_line|#define  AVM_HDLC_STATUS_2      0x1c
DECL|macro|AVM_ISACSX_INDEX
mdefine_line|#define  AVM_ISACSX_INDEX       0x04
DECL|macro|AVM_ISACSX_DATA
mdefine_line|#define  AVM_ISACSX_DATA        0x08
singleline_comment|// ----------------------------------------------------------------------
singleline_comment|// Fritz!PCI
DECL|function|fcpci_read_isac
r_static
r_int
r_char
id|fcpci_read_isac
c_func
(paren
r_struct
id|isac
op_star
id|isac
comma
r_int
r_char
id|offset
)paren
(brace
r_struct
id|fritz_adapter
op_star
id|adapter
op_assign
id|isac-&gt;priv
suffix:semicolon
r_int
r_char
id|idx
op_assign
(paren
id|offset
OG
l_int|0x2f
)paren
ques
c_cond
id|AVM_IDX_ISAC_REG_HIGH
suffix:colon
id|AVM_IDX_ISAC_REG_LOW
suffix:semicolon
r_int
r_char
id|val
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|adapter-&gt;hw_lock
comma
id|flags
)paren
suffix:semicolon
id|outb
c_func
(paren
id|idx
comma
id|adapter-&gt;io
op_plus
id|AVM_INDEX
)paren
suffix:semicolon
id|val
op_assign
id|inb
c_func
(paren
id|adapter-&gt;io
op_plus
id|AVM_DATA
op_plus
(paren
id|offset
op_amp
l_int|0xf
)paren
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|adapter-&gt;hw_lock
comma
id|flags
)paren
suffix:semicolon
id|DBG
c_func
(paren
l_int|0x1000
comma
l_string|&quot; port %#x, value %#x&quot;
comma
id|offset
comma
id|val
)paren
suffix:semicolon
r_return
id|val
suffix:semicolon
)brace
DECL|function|fcpci_write_isac
r_static
r_void
id|fcpci_write_isac
c_func
(paren
r_struct
id|isac
op_star
id|isac
comma
r_int
r_char
id|offset
comma
r_int
r_char
id|value
)paren
(brace
r_struct
id|fritz_adapter
op_star
id|adapter
op_assign
id|isac-&gt;priv
suffix:semicolon
r_int
r_char
id|idx
op_assign
(paren
id|offset
OG
l_int|0x2f
)paren
ques
c_cond
id|AVM_IDX_ISAC_REG_HIGH
suffix:colon
id|AVM_IDX_ISAC_REG_LOW
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|DBG
c_func
(paren
l_int|0x1000
comma
l_string|&quot; port %#x, value %#x&quot;
comma
id|offset
comma
id|value
)paren
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|adapter-&gt;hw_lock
comma
id|flags
)paren
suffix:semicolon
id|outb
c_func
(paren
id|idx
comma
id|adapter-&gt;io
op_plus
id|AVM_INDEX
)paren
suffix:semicolon
id|outb
c_func
(paren
id|value
comma
id|adapter-&gt;io
op_plus
id|AVM_DATA
op_plus
(paren
id|offset
op_amp
l_int|0xf
)paren
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|adapter-&gt;hw_lock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|fcpci_read_isac_fifo
r_static
r_void
id|fcpci_read_isac_fifo
c_func
(paren
r_struct
id|isac
op_star
id|isac
comma
r_int
r_char
op_star
id|data
comma
r_int
id|size
)paren
(brace
r_struct
id|fritz_adapter
op_star
id|adapter
op_assign
id|isac-&gt;priv
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|adapter-&gt;hw_lock
comma
id|flags
)paren
suffix:semicolon
id|outb
c_func
(paren
id|AVM_IDX_ISAC_FIFO
comma
id|adapter-&gt;io
op_plus
id|AVM_INDEX
)paren
suffix:semicolon
id|insb
c_func
(paren
id|adapter-&gt;io
op_plus
id|AVM_DATA
comma
id|data
comma
id|size
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|adapter-&gt;hw_lock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|fcpci_write_isac_fifo
r_static
r_void
id|fcpci_write_isac_fifo
c_func
(paren
r_struct
id|isac
op_star
id|isac
comma
r_int
r_char
op_star
id|data
comma
r_int
id|size
)paren
(brace
r_struct
id|fritz_adapter
op_star
id|adapter
op_assign
id|isac-&gt;priv
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|adapter-&gt;hw_lock
comma
id|flags
)paren
suffix:semicolon
id|outb
c_func
(paren
id|AVM_IDX_ISAC_FIFO
comma
id|adapter-&gt;io
op_plus
id|AVM_INDEX
)paren
suffix:semicolon
id|outsb
c_func
(paren
id|adapter-&gt;io
op_plus
id|AVM_DATA
comma
id|data
comma
id|size
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|adapter-&gt;hw_lock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|fcpci_read_hdlc_status
r_static
id|u32
id|fcpci_read_hdlc_status
c_func
(paren
r_struct
id|fritz_adapter
op_star
id|adapter
comma
r_int
id|nr
)paren
(brace
id|u32
id|val
suffix:semicolon
r_int
id|idx
op_assign
id|nr
ques
c_cond
id|AVM_IDX_HDLC_2
suffix:colon
id|AVM_IDX_HDLC_1
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|adapter-&gt;hw_lock
comma
id|flags
)paren
suffix:semicolon
id|outl
c_func
(paren
id|idx
comma
id|adapter-&gt;io
op_plus
id|AVM_INDEX
)paren
suffix:semicolon
id|val
op_assign
id|inl
c_func
(paren
id|adapter-&gt;io
op_plus
id|AVM_DATA
op_plus
id|HDLC_STATUS
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|adapter-&gt;hw_lock
comma
id|flags
)paren
suffix:semicolon
r_return
id|val
suffix:semicolon
)brace
DECL|function|__fcpci_write_ctrl
r_static
r_void
id|__fcpci_write_ctrl
c_func
(paren
r_struct
id|fritz_bcs
op_star
id|bcs
comma
r_int
id|which
)paren
(brace
r_struct
id|fritz_adapter
op_star
id|adapter
op_assign
id|bcs-&gt;adapter
suffix:semicolon
r_int
id|idx
op_assign
id|bcs-&gt;channel
ques
c_cond
id|AVM_IDX_HDLC_2
suffix:colon
id|AVM_IDX_HDLC_1
suffix:semicolon
id|DBG
c_func
(paren
l_int|0x40
comma
l_string|&quot;hdlc %c wr%x ctrl %x&quot;
comma
l_char|&squot;A&squot;
op_plus
id|bcs-&gt;channel
comma
id|which
comma
id|bcs-&gt;ctrl.ctrl
)paren
suffix:semicolon
id|outl
c_func
(paren
id|idx
comma
id|adapter-&gt;io
op_plus
id|AVM_INDEX
)paren
suffix:semicolon
id|outl
c_func
(paren
id|bcs-&gt;ctrl.ctrl
comma
id|adapter-&gt;io
op_plus
id|AVM_DATA
op_plus
id|HDLC_CTRL
)paren
suffix:semicolon
)brace
DECL|function|fcpci_write_ctrl
r_static
r_void
id|fcpci_write_ctrl
c_func
(paren
r_struct
id|fritz_bcs
op_star
id|bcs
comma
r_int
id|which
)paren
(brace
r_struct
id|fritz_adapter
op_star
id|adapter
op_assign
id|bcs-&gt;adapter
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|adapter-&gt;hw_lock
comma
id|flags
)paren
suffix:semicolon
id|__fcpci_write_ctrl
c_func
(paren
id|bcs
comma
id|which
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|adapter-&gt;hw_lock
comma
id|flags
)paren
suffix:semicolon
)brace
singleline_comment|// ----------------------------------------------------------------------
singleline_comment|// Fritz!PCI v2
DECL|function|fcpci2_read_isac
r_static
r_int
r_char
id|fcpci2_read_isac
c_func
(paren
r_struct
id|isac
op_star
id|isac
comma
r_int
r_char
id|offset
)paren
(brace
r_struct
id|fritz_adapter
op_star
id|adapter
op_assign
id|isac-&gt;priv
suffix:semicolon
r_int
r_char
id|val
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|adapter-&gt;hw_lock
comma
id|flags
)paren
suffix:semicolon
id|outl
c_func
(paren
id|offset
comma
id|adapter-&gt;io
op_plus
id|AVM_ISACSX_INDEX
)paren
suffix:semicolon
id|val
op_assign
id|inl
c_func
(paren
id|adapter-&gt;io
op_plus
id|AVM_ISACSX_DATA
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|adapter-&gt;hw_lock
comma
id|flags
)paren
suffix:semicolon
id|DBG
c_func
(paren
l_int|0x1000
comma
l_string|&quot; port %#x, value %#x&quot;
comma
id|offset
comma
id|val
)paren
suffix:semicolon
r_return
id|val
suffix:semicolon
)brace
DECL|function|fcpci2_write_isac
r_static
r_void
id|fcpci2_write_isac
c_func
(paren
r_struct
id|isac
op_star
id|isac
comma
r_int
r_char
id|offset
comma
r_int
r_char
id|value
)paren
(brace
r_struct
id|fritz_adapter
op_star
id|adapter
op_assign
id|isac-&gt;priv
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|DBG
c_func
(paren
l_int|0x1000
comma
l_string|&quot; port %#x, value %#x&quot;
comma
id|offset
comma
id|value
)paren
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|adapter-&gt;hw_lock
comma
id|flags
)paren
suffix:semicolon
id|outl
c_func
(paren
id|offset
comma
id|adapter-&gt;io
op_plus
id|AVM_ISACSX_INDEX
)paren
suffix:semicolon
id|outl
c_func
(paren
id|value
comma
id|adapter-&gt;io
op_plus
id|AVM_ISACSX_DATA
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|adapter-&gt;hw_lock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|fcpci2_read_isac_fifo
r_static
r_void
id|fcpci2_read_isac_fifo
c_func
(paren
r_struct
id|isac
op_star
id|isac
comma
r_int
r_char
op_star
id|data
comma
r_int
id|size
)paren
(brace
r_struct
id|fritz_adapter
op_star
id|adapter
op_assign
id|isac-&gt;priv
suffix:semicolon
r_int
id|i
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|adapter-&gt;hw_lock
comma
id|flags
)paren
suffix:semicolon
id|outl
c_func
(paren
l_int|0
comma
id|adapter-&gt;io
op_plus
id|AVM_ISACSX_INDEX
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|size
suffix:semicolon
id|i
op_increment
)paren
id|data
(braket
id|i
)braket
op_assign
id|inl
c_func
(paren
id|adapter-&gt;io
op_plus
id|AVM_ISACSX_DATA
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|adapter-&gt;hw_lock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|fcpci2_write_isac_fifo
r_static
r_void
id|fcpci2_write_isac_fifo
c_func
(paren
r_struct
id|isac
op_star
id|isac
comma
r_int
r_char
op_star
id|data
comma
r_int
id|size
)paren
(brace
r_struct
id|fritz_adapter
op_star
id|adapter
op_assign
id|isac-&gt;priv
suffix:semicolon
r_int
id|i
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|adapter-&gt;hw_lock
comma
id|flags
)paren
suffix:semicolon
id|outl
c_func
(paren
l_int|0
comma
id|adapter-&gt;io
op_plus
id|AVM_ISACSX_INDEX
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|size
suffix:semicolon
id|i
op_increment
)paren
id|outl
c_func
(paren
id|data
(braket
id|i
)braket
comma
id|adapter-&gt;io
op_plus
id|AVM_ISACSX_DATA
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|adapter-&gt;hw_lock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|fcpci2_read_hdlc_status
r_static
id|u32
id|fcpci2_read_hdlc_status
c_func
(paren
r_struct
id|fritz_adapter
op_star
id|adapter
comma
r_int
id|nr
)paren
(brace
r_int
id|offset
op_assign
id|nr
ques
c_cond
id|AVM_HDLC_STATUS_2
suffix:colon
id|AVM_HDLC_STATUS_1
suffix:semicolon
r_return
id|inl
c_func
(paren
id|adapter-&gt;io
op_plus
id|offset
)paren
suffix:semicolon
)brace
DECL|function|fcpci2_write_ctrl
r_static
r_void
id|fcpci2_write_ctrl
c_func
(paren
r_struct
id|fritz_bcs
op_star
id|bcs
comma
r_int
id|which
)paren
(brace
r_struct
id|fritz_adapter
op_star
id|adapter
op_assign
id|bcs-&gt;adapter
suffix:semicolon
r_int
id|offset
op_assign
id|bcs-&gt;channel
ques
c_cond
id|AVM_HDLC_STATUS_2
suffix:colon
id|AVM_HDLC_STATUS_1
suffix:semicolon
id|DBG
c_func
(paren
l_int|0x40
comma
l_string|&quot;hdlc %c wr%x ctrl %x&quot;
comma
l_char|&squot;A&squot;
op_plus
id|bcs-&gt;channel
comma
id|which
comma
id|bcs-&gt;ctrl.ctrl
)paren
suffix:semicolon
id|outl
c_func
(paren
id|bcs-&gt;ctrl.ctrl
comma
id|adapter-&gt;io
op_plus
id|offset
)paren
suffix:semicolon
)brace
singleline_comment|// ----------------------------------------------------------------------
singleline_comment|// Fritz!PnP (ISAC access as for Fritz!PCI)
DECL|function|fcpnp_read_hdlc_status
r_static
id|u32
id|fcpnp_read_hdlc_status
c_func
(paren
r_struct
id|fritz_adapter
op_star
id|adapter
comma
r_int
id|nr
)paren
(brace
r_int
r_char
id|idx
op_assign
id|nr
ques
c_cond
id|AVM_IDX_HDLC_2
suffix:colon
id|AVM_IDX_HDLC_1
suffix:semicolon
id|u32
id|val
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|adapter-&gt;hw_lock
comma
id|flags
)paren
suffix:semicolon
id|outb
c_func
(paren
id|idx
comma
id|adapter-&gt;io
op_plus
id|AVM_INDEX
)paren
suffix:semicolon
id|val
op_assign
id|inb
c_func
(paren
id|adapter-&gt;io
op_plus
id|AVM_DATA
op_plus
id|HDLC_STATUS
)paren
suffix:semicolon
r_if
c_cond
(paren
id|val
op_amp
id|HDLC_INT_RPR
)paren
id|val
op_or_assign
id|inb
c_func
(paren
id|adapter-&gt;io
op_plus
id|AVM_DATA
op_plus
id|HDLC_STATUS
op_plus
l_int|1
)paren
op_lshift
l_int|8
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|adapter-&gt;hw_lock
comma
id|flags
)paren
suffix:semicolon
r_return
id|val
suffix:semicolon
)brace
DECL|function|__fcpnp_write_ctrl
r_static
r_void
id|__fcpnp_write_ctrl
c_func
(paren
r_struct
id|fritz_bcs
op_star
id|bcs
comma
r_int
id|which
)paren
(brace
r_struct
id|fritz_adapter
op_star
id|adapter
op_assign
id|bcs-&gt;adapter
suffix:semicolon
r_int
r_char
id|idx
op_assign
id|bcs-&gt;channel
ques
c_cond
id|AVM_IDX_HDLC_2
suffix:colon
id|AVM_IDX_HDLC_1
suffix:semicolon
id|DBG
c_func
(paren
l_int|0x40
comma
l_string|&quot;hdlc %c wr%x ctrl %x&quot;
comma
l_char|&squot;A&squot;
op_plus
id|bcs-&gt;channel
comma
id|which
comma
id|bcs-&gt;ctrl.ctrl
)paren
suffix:semicolon
id|outb
c_func
(paren
id|idx
comma
id|adapter-&gt;io
op_plus
id|AVM_INDEX
)paren
suffix:semicolon
r_if
c_cond
(paren
id|which
op_amp
l_int|4
)paren
id|outb
c_func
(paren
id|bcs-&gt;ctrl.sr.mode
comma
id|adapter-&gt;io
op_plus
id|AVM_DATA
op_plus
id|HDLC_STATUS
op_plus
l_int|2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|which
op_amp
l_int|2
)paren
id|outb
c_func
(paren
id|bcs-&gt;ctrl.sr.xml
comma
id|adapter-&gt;io
op_plus
id|AVM_DATA
op_plus
id|HDLC_STATUS
op_plus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|which
op_amp
l_int|1
)paren
id|outb
c_func
(paren
id|bcs-&gt;ctrl.sr.cmd
comma
id|adapter-&gt;io
op_plus
id|AVM_DATA
op_plus
id|HDLC_STATUS
op_plus
l_int|0
)paren
suffix:semicolon
)brace
DECL|function|fcpnp_write_ctrl
r_static
r_void
id|fcpnp_write_ctrl
c_func
(paren
r_struct
id|fritz_bcs
op_star
id|bcs
comma
r_int
id|which
)paren
(brace
r_struct
id|fritz_adapter
op_star
id|adapter
op_assign
id|bcs-&gt;adapter
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|adapter-&gt;hw_lock
comma
id|flags
)paren
suffix:semicolon
id|__fcpnp_write_ctrl
c_func
(paren
id|bcs
comma
id|which
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|adapter-&gt;hw_lock
comma
id|flags
)paren
suffix:semicolon
)brace
singleline_comment|// ----------------------------------------------------------------------
DECL|function|B_L1L2
r_static
r_inline
r_void
id|B_L1L2
c_func
(paren
r_struct
id|fritz_bcs
op_star
id|bcs
comma
r_int
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|hisax_if
op_star
id|ifc
op_assign
(paren
r_struct
id|hisax_if
op_star
)paren
op_amp
id|bcs-&gt;b_if
suffix:semicolon
id|DBG
c_func
(paren
l_int|2
comma
l_string|&quot;pr %#x&quot;
comma
id|pr
)paren
suffix:semicolon
id|ifc
op_member_access_from_pointer
id|l1l2
c_func
(paren
id|ifc
comma
id|pr
comma
id|arg
)paren
suffix:semicolon
)brace
DECL|function|hdlc_fill_fifo
r_static
r_void
id|hdlc_fill_fifo
c_func
(paren
r_struct
id|fritz_bcs
op_star
id|bcs
)paren
(brace
r_struct
id|fritz_adapter
op_star
id|adapter
op_assign
id|bcs-&gt;adapter
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|bcs-&gt;tx_skb
suffix:semicolon
r_int
id|count
suffix:semicolon
r_int
id|fifo_size
op_assign
l_int|32
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
r_char
op_star
id|p
suffix:semicolon
id|DBG
c_func
(paren
l_int|0x40
comma
l_string|&quot;hdlc_fill_fifo&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb-&gt;len
op_eq
l_int|0
)paren
id|BUG
c_func
(paren
)paren
suffix:semicolon
id|bcs-&gt;ctrl.sr.cmd
op_and_assign
op_complement
id|HDLC_CMD_XME
suffix:semicolon
r_if
c_cond
(paren
id|bcs-&gt;tx_skb-&gt;len
OG
id|fifo_size
)paren
(brace
id|count
op_assign
id|fifo_size
suffix:semicolon
)brace
r_else
(brace
id|count
op_assign
id|bcs-&gt;tx_skb-&gt;len
suffix:semicolon
r_if
c_cond
(paren
id|bcs-&gt;mode
op_ne
id|L1_MODE_TRANS
)paren
id|bcs-&gt;ctrl.sr.cmd
op_or_assign
id|HDLC_CMD_XME
suffix:semicolon
)brace
id|DBG
c_func
(paren
l_int|0x40
comma
l_string|&quot;hdlc_fill_fifo %d/%d&quot;
comma
id|count
comma
id|bcs-&gt;tx_skb-&gt;len
)paren
suffix:semicolon
id|p
op_assign
id|bcs-&gt;tx_skb-&gt;data
suffix:semicolon
id|skb_pull
c_func
(paren
id|bcs-&gt;tx_skb
comma
id|count
)paren
suffix:semicolon
id|bcs-&gt;tx_cnt
op_add_assign
id|count
suffix:semicolon
id|bcs-&gt;ctrl.sr.xml
op_assign
(paren
(paren
id|count
op_eq
id|fifo_size
)paren
ques
c_cond
l_int|0
suffix:colon
id|count
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|adapter-&gt;type
)paren
(brace
r_case
id|AVM_FRITZ_PCI
suffix:colon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|adapter-&gt;hw_lock
comma
id|flags
)paren
suffix:semicolon
singleline_comment|// sets the correct AVM_INDEX, too
id|__fcpci_write_ctrl
c_func
(paren
id|bcs
comma
l_int|3
)paren
suffix:semicolon
id|outsl
c_func
(paren
id|adapter-&gt;io
op_plus
id|AVM_DATA
op_plus
id|HDLC_FIFO
comma
id|p
comma
(paren
id|count
op_plus
l_int|3
)paren
op_div
l_int|4
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|adapter-&gt;hw_lock
comma
id|flags
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|AVM_FRITZ_PCIV2
suffix:colon
id|fcpci2_write_ctrl
c_func
(paren
id|bcs
comma
l_int|3
)paren
suffix:semicolon
id|outsl
c_func
(paren
id|adapter-&gt;io
op_plus
(paren
id|bcs-&gt;channel
ques
c_cond
id|AVM_HDLC_FIFO_2
suffix:colon
id|AVM_HDLC_FIFO_1
)paren
comma
id|p
comma
(paren
id|count
op_plus
l_int|3
)paren
op_div
l_int|4
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|AVM_FRITZ_PNP
suffix:colon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|adapter-&gt;hw_lock
comma
id|flags
)paren
suffix:semicolon
singleline_comment|// sets the correct AVM_INDEX, too
id|__fcpnp_write_ctrl
c_func
(paren
id|bcs
comma
l_int|3
)paren
suffix:semicolon
id|outsb
c_func
(paren
id|adapter-&gt;io
op_plus
id|AVM_DATA
comma
id|p
comma
id|count
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|adapter-&gt;hw_lock
comma
id|flags
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
DECL|function|hdlc_empty_fifo
r_static
r_inline
r_void
id|hdlc_empty_fifo
c_func
(paren
r_struct
id|fritz_bcs
op_star
id|bcs
comma
r_int
id|count
)paren
(brace
r_struct
id|fritz_adapter
op_star
id|adapter
op_assign
id|bcs-&gt;adapter
suffix:semicolon
r_int
r_char
op_star
id|p
suffix:semicolon
r_int
r_char
id|idx
op_assign
id|bcs-&gt;channel
ques
c_cond
id|AVM_IDX_HDLC_2
suffix:colon
id|AVM_IDX_HDLC_1
suffix:semicolon
id|DBG
c_func
(paren
l_int|0x10
comma
l_string|&quot;hdlc_empty_fifo %d&quot;
comma
id|count
)paren
suffix:semicolon
r_if
c_cond
(paren
id|bcs-&gt;rcvidx
op_plus
id|count
OG
id|HSCX_BUFMAX
)paren
(brace
id|DBG
c_func
(paren
l_int|0x10
comma
l_string|&quot;hdlc_empty_fifo: incoming packet too large&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|p
op_assign
id|bcs-&gt;rcvbuf
op_plus
id|bcs-&gt;rcvidx
suffix:semicolon
id|bcs-&gt;rcvidx
op_add_assign
id|count
suffix:semicolon
r_switch
c_cond
(paren
id|adapter-&gt;type
)paren
(brace
r_case
id|AVM_FRITZ_PCI
suffix:colon
id|spin_lock
c_func
(paren
op_amp
id|adapter-&gt;hw_lock
)paren
suffix:semicolon
id|outl
c_func
(paren
id|idx
comma
id|adapter-&gt;io
op_plus
id|AVM_INDEX
)paren
suffix:semicolon
id|insl
c_func
(paren
id|adapter-&gt;io
op_plus
id|AVM_DATA
op_plus
id|HDLC_FIFO
comma
id|p
comma
(paren
id|count
op_plus
l_int|3
)paren
op_div
l_int|4
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|adapter-&gt;hw_lock
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|AVM_FRITZ_PCIV2
suffix:colon
id|insl
c_func
(paren
id|adapter-&gt;io
op_plus
(paren
id|bcs-&gt;channel
ques
c_cond
id|AVM_HDLC_FIFO_2
suffix:colon
id|AVM_HDLC_FIFO_1
)paren
comma
id|p
comma
(paren
id|count
op_plus
l_int|3
)paren
op_div
l_int|4
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|AVM_FRITZ_PNP
suffix:colon
id|spin_lock
c_func
(paren
op_amp
id|adapter-&gt;hw_lock
)paren
suffix:semicolon
id|outb
c_func
(paren
id|idx
comma
id|adapter-&gt;io
op_plus
id|AVM_INDEX
)paren
suffix:semicolon
id|insb
c_func
(paren
id|adapter-&gt;io
op_plus
id|AVM_DATA
comma
id|p
comma
id|count
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|adapter-&gt;hw_lock
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
DECL|function|hdlc_rpr_irq
r_static
r_inline
r_void
id|hdlc_rpr_irq
c_func
(paren
r_struct
id|fritz_bcs
op_star
id|bcs
comma
id|u32
id|stat
)paren
(brace
r_struct
id|fritz_adapter
op_star
id|adapter
op_assign
id|bcs-&gt;adapter
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
r_int
id|len
suffix:semicolon
r_if
c_cond
(paren
id|stat
op_amp
id|HDLC_STAT_RDO
)paren
(brace
id|DBG
c_func
(paren
l_int|0x10
comma
l_string|&quot;RDO&quot;
)paren
suffix:semicolon
id|bcs-&gt;ctrl.sr.xml
op_assign
l_int|0
suffix:semicolon
id|bcs-&gt;ctrl.sr.cmd
op_or_assign
id|HDLC_CMD_RRS
suffix:semicolon
id|adapter
op_member_access_from_pointer
id|write_ctrl
c_func
(paren
id|bcs
comma
l_int|1
)paren
suffix:semicolon
id|bcs-&gt;ctrl.sr.cmd
op_and_assign
op_complement
id|HDLC_CMD_RRS
suffix:semicolon
id|adapter
op_member_access_from_pointer
id|write_ctrl
c_func
(paren
id|bcs
comma
l_int|1
)paren
suffix:semicolon
id|bcs-&gt;rcvidx
op_assign
l_int|0
suffix:semicolon
r_return
suffix:semicolon
)brace
id|len
op_assign
(paren
id|stat
op_amp
id|HDLC_STAT_RML_MASK
)paren
op_rshift
l_int|8
suffix:semicolon
r_if
c_cond
(paren
id|len
op_eq
l_int|0
)paren
id|len
op_assign
l_int|32
suffix:semicolon
id|hdlc_empty_fifo
c_func
(paren
id|bcs
comma
id|len
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|stat
op_amp
id|HDLC_STAT_RME
)paren
op_logical_or
(paren
id|bcs-&gt;mode
op_eq
id|L1_MODE_TRANS
)paren
)paren
(brace
r_if
c_cond
(paren
(paren
(paren
id|stat
op_amp
id|HDLC_STAT_CRCVFRRAB
)paren
op_eq
id|HDLC_STAT_CRCVFR
)paren
op_logical_or
(paren
id|bcs-&gt;mode
op_eq
id|L1_MODE_TRANS
)paren
)paren
(brace
id|skb
op_assign
id|dev_alloc_skb
c_func
(paren
id|bcs-&gt;rcvidx
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|skb
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;HDLC: receive out of memory&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
id|bcs-&gt;rcvidx
)paren
comma
id|bcs-&gt;rcvbuf
comma
id|bcs-&gt;rcvidx
)paren
suffix:semicolon
id|DBG_SKB
c_func
(paren
l_int|1
comma
id|skb
)paren
suffix:semicolon
id|B_L1L2
c_func
(paren
id|bcs
comma
id|PH_DATA
op_or
id|INDICATION
comma
id|skb
)paren
suffix:semicolon
)brace
id|bcs-&gt;rcvidx
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|DBG
c_func
(paren
l_int|0x10
comma
l_string|&quot;ch%d invalid frame %#x&quot;
comma
id|bcs-&gt;channel
comma
id|stat
)paren
suffix:semicolon
id|bcs-&gt;rcvidx
op_assign
l_int|0
suffix:semicolon
)brace
)brace
)brace
DECL|function|hdlc_xdu_irq
r_static
r_inline
r_void
id|hdlc_xdu_irq
c_func
(paren
r_struct
id|fritz_bcs
op_star
id|bcs
)paren
(brace
r_struct
id|fritz_adapter
op_star
id|adapter
op_assign
id|bcs-&gt;adapter
suffix:semicolon
multiline_comment|/* Here we lost an TX interrupt, so&n;&t; * restart transmitting the whole frame.&n;&t; */
id|bcs-&gt;ctrl.sr.xml
op_assign
l_int|0
suffix:semicolon
id|bcs-&gt;ctrl.sr.cmd
op_or_assign
id|HDLC_CMD_XRS
suffix:semicolon
id|adapter
op_member_access_from_pointer
id|write_ctrl
c_func
(paren
id|bcs
comma
l_int|1
)paren
suffix:semicolon
id|bcs-&gt;ctrl.sr.cmd
op_and_assign
op_complement
id|HDLC_CMD_XRS
suffix:semicolon
id|adapter
op_member_access_from_pointer
id|write_ctrl
c_func
(paren
id|bcs
comma
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|bcs-&gt;tx_skb
)paren
(brace
id|DBG
c_func
(paren
l_int|0x10
comma
l_string|&quot;XDU without skb&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|skb_push
c_func
(paren
id|bcs-&gt;tx_skb
comma
id|bcs-&gt;tx_cnt
)paren
suffix:semicolon
id|bcs-&gt;tx_cnt
op_assign
l_int|0
suffix:semicolon
)brace
DECL|function|hdlc_xpr_irq
r_static
r_inline
r_void
id|hdlc_xpr_irq
c_func
(paren
r_struct
id|fritz_bcs
op_star
id|bcs
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|skb
op_assign
id|bcs-&gt;tx_skb
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|skb
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|skb-&gt;len
)paren
(brace
id|hdlc_fill_fifo
c_func
(paren
id|bcs
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|bcs-&gt;tx_cnt
op_assign
l_int|0
suffix:semicolon
id|bcs-&gt;tx_skb
op_assign
l_int|NULL
suffix:semicolon
id|B_L1L2
c_func
(paren
id|bcs
comma
id|PH_DATA
op_or
id|CONFIRM
comma
(paren
r_void
op_star
)paren
id|skb-&gt;truesize
)paren
suffix:semicolon
id|dev_kfree_skb_irq
c_func
(paren
id|skb
)paren
suffix:semicolon
)brace
DECL|function|hdlc_irq_one
r_static
r_void
id|hdlc_irq_one
c_func
(paren
r_struct
id|fritz_bcs
op_star
id|bcs
comma
id|u32
id|stat
)paren
(brace
id|DBG
c_func
(paren
l_int|0x10
comma
l_string|&quot;ch%d stat %#x&quot;
comma
id|bcs-&gt;channel
comma
id|stat
)paren
suffix:semicolon
r_if
c_cond
(paren
id|stat
op_amp
id|HDLC_INT_RPR
)paren
(brace
id|DBG
c_func
(paren
l_int|0x10
comma
l_string|&quot;RPR&quot;
)paren
suffix:semicolon
id|hdlc_rpr_irq
c_func
(paren
id|bcs
comma
id|stat
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|stat
op_amp
id|HDLC_INT_XDU
)paren
(brace
id|DBG
c_func
(paren
l_int|0x10
comma
l_string|&quot;XDU&quot;
)paren
suffix:semicolon
id|hdlc_xdu_irq
c_func
(paren
id|bcs
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|stat
op_amp
id|HDLC_INT_XPR
)paren
(brace
id|DBG
c_func
(paren
l_int|0x10
comma
l_string|&quot;XPR&quot;
)paren
suffix:semicolon
id|hdlc_xpr_irq
c_func
(paren
id|bcs
)paren
suffix:semicolon
)brace
)brace
DECL|function|hdlc_irq
r_static
r_inline
r_void
id|hdlc_irq
c_func
(paren
r_struct
id|fritz_adapter
op_star
id|adapter
)paren
(brace
r_int
id|nr
suffix:semicolon
id|u32
id|stat
suffix:semicolon
r_for
c_loop
(paren
id|nr
op_assign
l_int|0
suffix:semicolon
id|nr
OL
l_int|2
suffix:semicolon
id|nr
op_increment
)paren
(brace
id|stat
op_assign
id|adapter
op_member_access_from_pointer
id|read_hdlc_status
c_func
(paren
id|adapter
comma
id|nr
)paren
suffix:semicolon
id|DBG
c_func
(paren
l_int|0x10
comma
l_string|&quot;HDLC %c stat %#x&quot;
comma
l_char|&squot;A&squot;
op_plus
id|nr
comma
id|stat
)paren
suffix:semicolon
r_if
c_cond
(paren
id|stat
op_amp
id|HDLC_INT_MASK
)paren
id|hdlc_irq_one
c_func
(paren
op_amp
id|adapter-&gt;bcs
(braket
id|nr
)braket
comma
id|stat
)paren
suffix:semicolon
)brace
)brace
DECL|function|modehdlc
r_static
r_void
id|modehdlc
c_func
(paren
r_struct
id|fritz_bcs
op_star
id|bcs
comma
r_int
id|mode
)paren
(brace
r_struct
id|fritz_adapter
op_star
id|adapter
op_assign
id|bcs-&gt;adapter
suffix:semicolon
id|DBG
c_func
(paren
l_int|0x40
comma
l_string|&quot;hdlc %c mode %d --&gt; %d&quot;
comma
l_char|&squot;A&squot;
op_plus
id|bcs-&gt;channel
comma
id|bcs-&gt;mode
comma
id|mode
)paren
suffix:semicolon
r_if
c_cond
(paren
id|bcs-&gt;mode
op_eq
id|mode
)paren
r_return
suffix:semicolon
id|bcs-&gt;ctrl.ctrl
op_assign
l_int|0
suffix:semicolon
id|bcs-&gt;ctrl.sr.cmd
op_assign
id|HDLC_CMD_XRS
op_or
id|HDLC_CMD_RRS
suffix:semicolon
r_switch
c_cond
(paren
id|mode
)paren
(brace
r_case
id|L1_MODE_NULL
suffix:colon
id|bcs-&gt;ctrl.sr.mode
op_assign
id|HDLC_MODE_TRANS
suffix:semicolon
id|adapter
op_member_access_from_pointer
id|write_ctrl
c_func
(paren
id|bcs
comma
l_int|5
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|L1_MODE_TRANS
suffix:colon
r_case
id|L1_MODE_HDLC
suffix:colon
id|bcs-&gt;rcvidx
op_assign
l_int|0
suffix:semicolon
id|bcs-&gt;tx_cnt
op_assign
l_int|0
suffix:semicolon
id|bcs-&gt;tx_skb
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
id|mode
op_eq
id|L1_MODE_TRANS
)paren
id|bcs-&gt;ctrl.sr.mode
op_assign
id|HDLC_MODE_TRANS
suffix:semicolon
r_else
id|bcs-&gt;ctrl.sr.mode
op_assign
id|HDLC_MODE_ITF_FLG
suffix:semicolon
id|adapter
op_member_access_from_pointer
id|write_ctrl
c_func
(paren
id|bcs
comma
l_int|5
)paren
suffix:semicolon
id|bcs-&gt;ctrl.sr.cmd
op_assign
id|HDLC_CMD_XRS
suffix:semicolon
id|adapter
op_member_access_from_pointer
id|write_ctrl
c_func
(paren
id|bcs
comma
l_int|1
)paren
suffix:semicolon
id|bcs-&gt;ctrl.sr.cmd
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
)brace
id|bcs-&gt;mode
op_assign
id|mode
suffix:semicolon
)brace
DECL|function|fritz_b_l2l1
r_static
r_void
id|fritz_b_l2l1
c_func
(paren
r_struct
id|hisax_if
op_star
id|ifc
comma
r_int
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|fritz_bcs
op_star
id|bcs
op_assign
id|ifc-&gt;priv
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_int
id|mode
suffix:semicolon
id|DBG
c_func
(paren
l_int|0x10
comma
l_string|&quot;pr %#x&quot;
comma
id|pr
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|pr
)paren
(brace
r_case
id|PH_DATA
op_or
id|REQUEST
suffix:colon
r_if
c_cond
(paren
id|bcs-&gt;tx_skb
)paren
id|BUG
c_func
(paren
)paren
suffix:semicolon
id|bcs-&gt;tx_skb
op_assign
id|skb
suffix:semicolon
id|DBG_SKB
c_func
(paren
l_int|1
comma
id|skb
)paren
suffix:semicolon
id|hdlc_fill_fifo
c_func
(paren
id|bcs
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|PH_ACTIVATE
op_or
id|REQUEST
suffix:colon
id|mode
op_assign
(paren
r_int
)paren
id|arg
suffix:semicolon
id|DBG
c_func
(paren
l_int|4
comma
l_string|&quot;B%d,PH_ACTIVATE_REQUEST %d&quot;
comma
id|bcs-&gt;channel
op_plus
l_int|1
comma
id|mode
)paren
suffix:semicolon
id|modehdlc
c_func
(paren
id|bcs
comma
id|mode
)paren
suffix:semicolon
id|B_L1L2
c_func
(paren
id|bcs
comma
id|PH_ACTIVATE
op_or
id|INDICATION
comma
l_int|NULL
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|PH_DEACTIVATE
op_or
id|REQUEST
suffix:colon
id|DBG
c_func
(paren
l_int|4
comma
l_string|&quot;B%d,PH_DEACTIVATE_REQUEST&quot;
comma
id|bcs-&gt;channel
op_plus
l_int|1
)paren
suffix:semicolon
id|modehdlc
c_func
(paren
id|bcs
comma
id|L1_MODE_NULL
)paren
suffix:semicolon
id|B_L1L2
c_func
(paren
id|bcs
comma
id|PH_DEACTIVATE
op_or
id|INDICATION
comma
l_int|NULL
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
singleline_comment|// ----------------------------------------------------------------------
DECL|function|fcpci2_irq
r_static
r_void
id|fcpci2_irq
c_func
(paren
r_int
id|intno
comma
r_void
op_star
id|dev
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
r_struct
id|fritz_adapter
op_star
id|adapter
op_assign
id|dev
suffix:semicolon
r_int
r_char
id|val
suffix:semicolon
id|val
op_assign
id|inb
c_func
(paren
id|adapter-&gt;io
op_plus
id|AVM_STATUS0
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|val
op_amp
id|AVM_STATUS0_IRQ_MASK
)paren
)paren
multiline_comment|/* hopefully a shared  IRQ reqest */
r_return
suffix:semicolon
id|DBG
c_func
(paren
l_int|2
comma
l_string|&quot;STATUS0 %#x&quot;
comma
id|val
)paren
suffix:semicolon
r_if
c_cond
(paren
id|val
op_amp
id|AVM_STATUS0_IRQ_ISAC
)paren
id|isacsx_irq
c_func
(paren
op_amp
id|adapter-&gt;isac
)paren
suffix:semicolon
r_if
c_cond
(paren
id|val
op_amp
id|AVM_STATUS0_IRQ_HDLC
)paren
id|hdlc_irq
c_func
(paren
id|adapter
)paren
suffix:semicolon
)brace
DECL|function|fcpci_irq
r_static
r_void
id|fcpci_irq
c_func
(paren
r_int
id|intno
comma
r_void
op_star
id|dev
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
r_struct
id|fritz_adapter
op_star
id|adapter
op_assign
id|dev
suffix:semicolon
r_int
r_char
id|sval
suffix:semicolon
id|sval
op_assign
id|inb
c_func
(paren
id|adapter-&gt;io
op_plus
l_int|2
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|sval
op_amp
id|AVM_STATUS0_IRQ_MASK
)paren
op_eq
id|AVM_STATUS0_IRQ_MASK
)paren
multiline_comment|/* possibly a shared  IRQ reqest */
r_return
suffix:semicolon
id|DBG
c_func
(paren
l_int|2
comma
l_string|&quot;sval %#x&quot;
comma
id|sval
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|sval
op_amp
id|AVM_STATUS0_IRQ_ISAC
)paren
)paren
id|isac_irq
c_func
(paren
op_amp
id|adapter-&gt;isac
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|sval
op_amp
id|AVM_STATUS0_IRQ_HDLC
)paren
)paren
id|hdlc_irq
c_func
(paren
id|adapter
)paren
suffix:semicolon
)brace
singleline_comment|// ----------------------------------------------------------------------
DECL|function|fcpci2_init
r_static
r_inline
r_void
id|fcpci2_init
c_func
(paren
r_struct
id|fritz_adapter
op_star
id|adapter
)paren
(brace
id|outb
c_func
(paren
id|AVM_STATUS0_RES_TIMER
comma
id|adapter-&gt;io
op_plus
id|AVM_STATUS0
)paren
suffix:semicolon
id|outb
c_func
(paren
id|AVM_STATUS0_ENA_IRQ
comma
id|adapter-&gt;io
op_plus
id|AVM_STATUS0
)paren
suffix:semicolon
)brace
DECL|function|fcpci_init
r_static
r_inline
r_void
id|fcpci_init
c_func
(paren
r_struct
id|fritz_adapter
op_star
id|adapter
)paren
(brace
id|outb
c_func
(paren
id|AVM_STATUS0_DIS_TIMER
op_or
id|AVM_STATUS0_RES_TIMER
op_or
id|AVM_STATUS0_ENA_IRQ
comma
id|adapter-&gt;io
op_plus
id|AVM_STATUS0
)paren
suffix:semicolon
id|outb
c_func
(paren
id|AVM_STATUS1_ENA_IOM
op_or
id|adapter-&gt;irq
comma
id|adapter-&gt;io
op_plus
id|AVM_STATUS1
)paren
suffix:semicolon
id|set_current_state
c_func
(paren
id|TASK_UNINTERRUPTIBLE
)paren
suffix:semicolon
id|schedule_timeout
c_func
(paren
l_int|50
op_star
id|HZ
op_div
l_int|1000
)paren
suffix:semicolon
multiline_comment|/* Timeout 50ms */
)brace
singleline_comment|// ----------------------------------------------------------------------
DECL|function|fcpcipnp_setup
r_static
r_int
id|__devinit
id|fcpcipnp_setup
c_func
(paren
r_struct
id|fritz_adapter
op_star
id|adapter
)paren
(brace
id|u32
id|val
op_assign
l_int|0
suffix:semicolon
r_int
id|retval
suffix:semicolon
id|DBG
c_func
(paren
l_int|1
comma
l_string|&quot;&quot;
)paren
suffix:semicolon
id|isac_init
c_func
(paren
op_amp
id|adapter-&gt;isac
)paren
suffix:semicolon
singleline_comment|// FIXME is this okay now
id|retval
op_assign
op_minus
id|EBUSY
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|request_region
c_func
(paren
id|adapter-&gt;io
comma
l_int|32
comma
l_string|&quot;fcpcipnp&quot;
)paren
)paren
r_goto
id|err
suffix:semicolon
r_switch
c_cond
(paren
id|adapter-&gt;type
)paren
(brace
r_case
id|AVM_FRITZ_PCIV2
suffix:colon
id|retval
op_assign
id|request_irq
c_func
(paren
id|adapter-&gt;irq
comma
id|fcpci2_irq
comma
id|SA_SHIRQ
comma
l_string|&quot;fcpcipnp&quot;
comma
id|adapter
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|AVM_FRITZ_PCI
suffix:colon
id|retval
op_assign
id|request_irq
c_func
(paren
id|adapter-&gt;irq
comma
id|fcpci_irq
comma
id|SA_SHIRQ
comma
l_string|&quot;fcpcipnp&quot;
comma
id|adapter
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|AVM_FRITZ_PNP
suffix:colon
id|retval
op_assign
id|request_irq
c_func
(paren
id|adapter-&gt;irq
comma
id|fcpci_irq
comma
l_int|0
comma
l_string|&quot;fcpcipnp&quot;
comma
id|adapter
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|retval
)paren
r_goto
id|err_region
suffix:semicolon
r_switch
c_cond
(paren
id|adapter-&gt;type
)paren
(brace
r_case
id|AVM_FRITZ_PCIV2
suffix:colon
r_case
id|AVM_FRITZ_PCI
suffix:colon
id|val
op_assign
id|inl
c_func
(paren
id|adapter-&gt;io
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|AVM_FRITZ_PNP
suffix:colon
id|val
op_assign
id|inb
c_func
(paren
id|adapter-&gt;io
)paren
suffix:semicolon
id|val
op_or_assign
id|inb
c_func
(paren
id|adapter-&gt;io
op_plus
l_int|1
)paren
op_lshift
l_int|8
suffix:semicolon
r_break
suffix:semicolon
)brace
id|DBG
c_func
(paren
l_int|1
comma
l_string|&quot;stat %#x Class %X Rev %d&quot;
comma
id|val
comma
id|val
op_amp
l_int|0xff
comma
(paren
id|val
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
)paren
suffix:semicolon
id|spin_lock_init
c_func
(paren
op_amp
id|adapter-&gt;hw_lock
)paren
suffix:semicolon
id|adapter-&gt;isac.priv
op_assign
id|adapter
suffix:semicolon
r_switch
c_cond
(paren
id|adapter-&gt;type
)paren
(brace
r_case
id|AVM_FRITZ_PCIV2
suffix:colon
id|adapter-&gt;isac.read_isac
op_assign
op_amp
id|fcpci2_read_isac
suffix:semicolon
suffix:semicolon
id|adapter-&gt;isac.write_isac
op_assign
op_amp
id|fcpci2_write_isac
suffix:semicolon
id|adapter-&gt;isac.read_isac_fifo
op_assign
op_amp
id|fcpci2_read_isac_fifo
suffix:semicolon
id|adapter-&gt;isac.write_isac_fifo
op_assign
op_amp
id|fcpci2_write_isac_fifo
suffix:semicolon
id|adapter-&gt;read_hdlc_status
op_assign
op_amp
id|fcpci2_read_hdlc_status
suffix:semicolon
id|adapter-&gt;write_ctrl
op_assign
op_amp
id|fcpci2_write_ctrl
suffix:semicolon
r_break
suffix:semicolon
r_case
id|AVM_FRITZ_PCI
suffix:colon
id|adapter-&gt;isac.read_isac
op_assign
op_amp
id|fcpci_read_isac
suffix:semicolon
suffix:semicolon
id|adapter-&gt;isac.write_isac
op_assign
op_amp
id|fcpci_write_isac
suffix:semicolon
id|adapter-&gt;isac.read_isac_fifo
op_assign
op_amp
id|fcpci_read_isac_fifo
suffix:semicolon
id|adapter-&gt;isac.write_isac_fifo
op_assign
op_amp
id|fcpci_write_isac_fifo
suffix:semicolon
id|adapter-&gt;read_hdlc_status
op_assign
op_amp
id|fcpci_read_hdlc_status
suffix:semicolon
id|adapter-&gt;write_ctrl
op_assign
op_amp
id|fcpci_write_ctrl
suffix:semicolon
r_break
suffix:semicolon
r_case
id|AVM_FRITZ_PNP
suffix:colon
id|adapter-&gt;isac.read_isac
op_assign
op_amp
id|fcpci_read_isac
suffix:semicolon
suffix:semicolon
id|adapter-&gt;isac.write_isac
op_assign
op_amp
id|fcpci_write_isac
suffix:semicolon
id|adapter-&gt;isac.read_isac_fifo
op_assign
op_amp
id|fcpci_read_isac_fifo
suffix:semicolon
id|adapter-&gt;isac.write_isac_fifo
op_assign
op_amp
id|fcpci_write_isac_fifo
suffix:semicolon
id|adapter-&gt;read_hdlc_status
op_assign
op_amp
id|fcpnp_read_hdlc_status
suffix:semicolon
id|adapter-&gt;write_ctrl
op_assign
op_amp
id|fcpnp_write_ctrl
suffix:semicolon
r_break
suffix:semicolon
)brace
singleline_comment|// Reset
id|outb
c_func
(paren
l_int|0
comma
id|adapter-&gt;io
op_plus
id|AVM_STATUS0
)paren
suffix:semicolon
id|set_current_state
c_func
(paren
id|TASK_UNINTERRUPTIBLE
)paren
suffix:semicolon
id|schedule_timeout
c_func
(paren
l_int|50
op_star
id|HZ
op_div
l_int|1000
)paren
suffix:semicolon
singleline_comment|// 50 msec
id|outb
c_func
(paren
id|AVM_STATUS0_RESET
comma
id|adapter-&gt;io
op_plus
id|AVM_STATUS0
)paren
suffix:semicolon
id|set_current_state
c_func
(paren
id|TASK_UNINTERRUPTIBLE
)paren
suffix:semicolon
id|schedule_timeout
c_func
(paren
l_int|50
op_star
id|HZ
op_div
l_int|1000
)paren
suffix:semicolon
singleline_comment|// 50 msec
id|outb
c_func
(paren
l_int|0
comma
id|adapter-&gt;io
op_plus
id|AVM_STATUS0
)paren
suffix:semicolon
id|set_current_state
c_func
(paren
id|TASK_UNINTERRUPTIBLE
)paren
suffix:semicolon
id|schedule_timeout
c_func
(paren
l_int|10
op_star
id|HZ
op_div
l_int|1000
)paren
suffix:semicolon
singleline_comment|// 10 msec
r_switch
c_cond
(paren
id|adapter-&gt;type
)paren
(brace
r_case
id|AVM_FRITZ_PCIV2
suffix:colon
id|fcpci2_init
c_func
(paren
id|adapter
)paren
suffix:semicolon
id|isacsx_setup
c_func
(paren
op_amp
id|adapter-&gt;isac
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|AVM_FRITZ_PCI
suffix:colon
r_case
id|AVM_FRITZ_PNP
suffix:colon
id|fcpci_init
c_func
(paren
id|adapter
)paren
suffix:semicolon
id|isac_setup
c_func
(paren
op_amp
id|adapter-&gt;isac
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|val
op_assign
id|adapter
op_member_access_from_pointer
id|read_hdlc_status
c_func
(paren
id|adapter
comma
l_int|0
)paren
suffix:semicolon
id|DBG
c_func
(paren
l_int|0x20
comma
l_string|&quot;HDLC A STA %x&quot;
comma
id|val
)paren
suffix:semicolon
id|val
op_assign
id|adapter
op_member_access_from_pointer
id|read_hdlc_status
c_func
(paren
id|adapter
comma
l_int|1
)paren
suffix:semicolon
id|DBG
c_func
(paren
l_int|0x20
comma
l_string|&quot;HDLC B STA %x&quot;
comma
id|val
)paren
suffix:semicolon
id|adapter-&gt;bcs
(braket
l_int|0
)braket
dot
id|mode
op_assign
op_minus
l_int|1
suffix:semicolon
id|adapter-&gt;bcs
(braket
l_int|1
)braket
dot
id|mode
op_assign
op_minus
l_int|1
suffix:semicolon
id|modehdlc
c_func
(paren
op_amp
id|adapter-&gt;bcs
(braket
l_int|0
)braket
comma
id|L1_MODE_NULL
)paren
suffix:semicolon
id|modehdlc
c_func
(paren
op_amp
id|adapter-&gt;bcs
(braket
l_int|1
)braket
comma
id|L1_MODE_NULL
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
id|err_region
suffix:colon
id|release_region
c_func
(paren
id|adapter-&gt;io
comma
l_int|32
)paren
suffix:semicolon
id|err
suffix:colon
r_return
id|retval
suffix:semicolon
)brace
DECL|function|fcpcipnp_release
r_static
r_void
id|__devexit
id|fcpcipnp_release
c_func
(paren
r_struct
id|fritz_adapter
op_star
id|adapter
)paren
(brace
id|DBG
c_func
(paren
l_int|1
comma
l_string|&quot;&quot;
)paren
suffix:semicolon
id|outb
c_func
(paren
l_int|0
comma
id|adapter-&gt;io
op_plus
id|AVM_STATUS0
)paren
suffix:semicolon
id|free_irq
c_func
(paren
id|adapter-&gt;irq
comma
id|adapter
)paren
suffix:semicolon
id|release_region
c_func
(paren
id|adapter-&gt;io
comma
l_int|32
)paren
suffix:semicolon
)brace
singleline_comment|// ----------------------------------------------------------------------
r_static
r_struct
id|fritz_adapter
op_star
id|__devinit
DECL|function|new_adapter
id|new_adapter
c_func
(paren
r_struct
id|pci_dev
op_star
id|pdev
)paren
(brace
r_struct
id|fritz_adapter
op_star
id|adapter
suffix:semicolon
r_struct
id|hisax_b_if
op_star
id|b_if
(braket
l_int|2
)braket
suffix:semicolon
r_int
id|i
suffix:semicolon
id|adapter
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|fritz_adapter
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|adapter
)paren
r_return
l_int|NULL
suffix:semicolon
id|memset
c_func
(paren
id|adapter
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|fritz_adapter
)paren
)paren
suffix:semicolon
id|SET_MODULE_OWNER
c_func
(paren
op_amp
id|adapter-&gt;isac.hisax_d_if
)paren
suffix:semicolon
id|adapter-&gt;isac.hisax_d_if.ifc.priv
op_assign
op_amp
id|adapter-&gt;isac
suffix:semicolon
id|adapter-&gt;isac.hisax_d_if.ifc.l2l1
op_assign
id|isac_d_l2l1
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|2
suffix:semicolon
id|i
op_increment
)paren
(brace
id|adapter-&gt;bcs
(braket
id|i
)braket
dot
id|adapter
op_assign
id|adapter
suffix:semicolon
id|adapter-&gt;bcs
(braket
id|i
)braket
dot
id|channel
op_assign
id|i
suffix:semicolon
id|adapter-&gt;bcs
(braket
id|i
)braket
dot
id|b_if.ifc.priv
op_assign
op_amp
id|adapter-&gt;bcs
(braket
id|i
)braket
suffix:semicolon
id|adapter-&gt;bcs
(braket
id|i
)braket
dot
id|b_if.ifc.l2l1
op_assign
id|fritz_b_l2l1
suffix:semicolon
)brace
id|pci_set_drvdata
c_func
(paren
id|pdev
comma
id|adapter
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|2
suffix:semicolon
id|i
op_increment
)paren
id|b_if
(braket
id|i
)braket
op_assign
op_amp
id|adapter-&gt;bcs
(braket
id|i
)braket
dot
id|b_if
suffix:semicolon
id|hisax_register
c_func
(paren
op_amp
id|adapter-&gt;isac.hisax_d_if
comma
id|b_if
comma
l_string|&quot;fcpcipnp&quot;
comma
id|protocol
)paren
suffix:semicolon
r_return
id|adapter
suffix:semicolon
)brace
DECL|function|delete_adapter
r_static
r_void
id|delete_adapter
c_func
(paren
r_struct
id|fritz_adapter
op_star
id|adapter
)paren
(brace
id|hisax_unregister
c_func
(paren
op_amp
id|adapter-&gt;isac.hisax_d_if
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|adapter
)paren
suffix:semicolon
)brace
DECL|function|fcpci_probe
r_static
r_int
id|__devinit
id|fcpci_probe
c_func
(paren
r_struct
id|pci_dev
op_star
id|pdev
comma
r_const
r_struct
id|pci_device_id
op_star
id|ent
)paren
(brace
r_struct
id|fritz_adapter
op_star
id|adapter
suffix:semicolon
r_int
id|retval
suffix:semicolon
id|retval
op_assign
op_minus
id|ENOMEM
suffix:semicolon
id|adapter
op_assign
id|new_adapter
c_func
(paren
id|pdev
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|adapter
)paren
r_goto
id|err
suffix:semicolon
r_if
c_cond
(paren
id|pdev-&gt;device
op_eq
id|PCI_DEVICE_ID_AVM_A1_V2
)paren
id|adapter-&gt;type
op_assign
id|AVM_FRITZ_PCIV2
suffix:semicolon
r_else
id|adapter-&gt;type
op_assign
id|AVM_FRITZ_PCI
suffix:semicolon
id|retval
op_assign
id|pci_enable_device
c_func
(paren
id|pdev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|retval
)paren
r_goto
id|err_free
suffix:semicolon
id|adapter-&gt;io
op_assign
id|pci_resource_start
c_func
(paren
id|pdev
comma
l_int|1
)paren
suffix:semicolon
id|adapter-&gt;irq
op_assign
id|pdev-&gt;irq
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;hisax_fcpcipnp: found adapter %s at %s&bslash;n&quot;
comma
(paren
r_char
op_star
)paren
id|ent-&gt;driver_data
comma
id|pdev-&gt;slot_name
)paren
suffix:semicolon
id|retval
op_assign
id|fcpcipnp_setup
c_func
(paren
id|adapter
)paren
suffix:semicolon
r_if
c_cond
(paren
id|retval
)paren
r_goto
id|err_free
suffix:semicolon
r_return
l_int|0
suffix:semicolon
id|err_free
suffix:colon
id|delete_adapter
c_func
(paren
id|adapter
)paren
suffix:semicolon
id|err
suffix:colon
r_return
id|retval
suffix:semicolon
)brace
DECL|function|fcpnp_probe
r_static
r_int
id|__devinit
id|fcpnp_probe
c_func
(paren
r_struct
id|pci_dev
op_star
id|pdev
comma
r_const
r_struct
id|isapnp_device_id
op_star
id|ent
)paren
(brace
r_struct
id|fritz_adapter
op_star
id|adapter
suffix:semicolon
r_int
id|retval
suffix:semicolon
id|retval
op_assign
op_minus
id|ENOMEM
suffix:semicolon
id|adapter
op_assign
id|new_adapter
c_func
(paren
id|pdev
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|adapter
)paren
r_goto
id|err
suffix:semicolon
id|adapter-&gt;type
op_assign
id|AVM_FRITZ_PNP
suffix:semicolon
id|pdev
op_member_access_from_pointer
id|prepare
c_func
(paren
id|pdev
)paren
suffix:semicolon
id|pdev
op_member_access_from_pointer
id|deactivate
c_func
(paren
id|pdev
)paren
suffix:semicolon
singleline_comment|// why?
id|pdev
op_member_access_from_pointer
id|activate
c_func
(paren
id|pdev
)paren
suffix:semicolon
id|adapter-&gt;io
op_assign
id|pdev-&gt;resource
(braket
l_int|0
)braket
dot
id|start
suffix:semicolon
id|adapter-&gt;irq
op_assign
id|pdev-&gt;irq_resource
(braket
l_int|0
)braket
dot
id|start
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;hisax_fcpcipnp: found adapter %s at IO %#x irq %d&bslash;n&quot;
comma
(paren
r_char
op_star
)paren
id|ent-&gt;driver_data
comma
id|adapter-&gt;io
comma
id|adapter-&gt;irq
)paren
suffix:semicolon
id|retval
op_assign
id|fcpcipnp_setup
c_func
(paren
id|adapter
)paren
suffix:semicolon
r_if
c_cond
(paren
id|retval
)paren
r_goto
id|err_free
suffix:semicolon
r_return
l_int|0
suffix:semicolon
id|err_free
suffix:colon
id|delete_adapter
c_func
(paren
id|adapter
)paren
suffix:semicolon
id|err
suffix:colon
r_return
id|retval
suffix:semicolon
)brace
DECL|function|fcpci_remove
r_static
r_void
id|__devexit
id|fcpci_remove
c_func
(paren
r_struct
id|pci_dev
op_star
id|pdev
)paren
(brace
r_struct
id|fritz_adapter
op_star
id|adapter
op_assign
id|pci_get_drvdata
c_func
(paren
id|pdev
)paren
suffix:semicolon
id|fcpcipnp_release
c_func
(paren
id|adapter
)paren
suffix:semicolon
id|pci_disable_device
c_func
(paren
id|pdev
)paren
suffix:semicolon
id|delete_adapter
c_func
(paren
id|adapter
)paren
suffix:semicolon
)brace
DECL|function|fcpnp_remove
r_static
r_void
id|__devexit
id|fcpnp_remove
c_func
(paren
r_struct
id|pci_dev
op_star
id|pdev
)paren
(brace
r_struct
id|fritz_adapter
op_star
id|adapter
op_assign
id|pci_get_drvdata
c_func
(paren
id|pdev
)paren
suffix:semicolon
id|fcpcipnp_release
c_func
(paren
id|adapter
)paren
suffix:semicolon
id|pdev
op_member_access_from_pointer
id|deactivate
c_func
(paren
id|pdev
)paren
suffix:semicolon
id|delete_adapter
c_func
(paren
id|adapter
)paren
suffix:semicolon
)brace
DECL|variable|fcpci_driver
r_static
r_struct
id|pci_driver
id|fcpci_driver
op_assign
(brace
id|name
suffix:colon
l_string|&quot;fcpci&quot;
comma
id|probe
suffix:colon
id|fcpci_probe
comma
id|remove
suffix:colon
id|__devexit_p
c_func
(paren
id|fcpci_remove
)paren
comma
id|id_table
suffix:colon
id|fcpci_ids
comma
)brace
suffix:semicolon
DECL|variable|fcpnp_driver
r_static
r_struct
id|isapnp_driver
id|fcpnp_driver
op_assign
(brace
id|name
suffix:colon
l_string|&quot;fcpnp&quot;
comma
id|probe
suffix:colon
id|fcpnp_probe
comma
id|remove
suffix:colon
id|__devexit_p
c_func
(paren
id|fcpnp_remove
)paren
comma
id|id_table
suffix:colon
id|fcpnp_ids
comma
)brace
suffix:semicolon
DECL|function|hisax_fcpcipnp_init
r_static
r_int
id|__init
id|hisax_fcpcipnp_init
c_func
(paren
r_void
)paren
(brace
r_int
id|retval
comma
id|pci_nr_found
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;hisax_fcpcipnp: Fritz!Card PCI/PCIv2/PnP ISDN driver v0.0.1&bslash;n&quot;
)paren
suffix:semicolon
id|retval
op_assign
id|pci_register_driver
c_func
(paren
op_amp
id|fcpci_driver
)paren
suffix:semicolon
r_if
c_cond
(paren
id|retval
OL
l_int|0
)paren
r_goto
id|out
suffix:semicolon
id|pci_nr_found
op_assign
id|retval
suffix:semicolon
id|retval
op_assign
id|isapnp_register_driver
c_func
(paren
op_amp
id|fcpnp_driver
)paren
suffix:semicolon
r_if
c_cond
(paren
id|retval
OL
l_int|0
)paren
r_goto
id|out_unregister_pci
suffix:semicolon
macro_line|#if !defined(CONFIG_HOTPLUG) || defined(MODULE)
r_if
c_cond
(paren
id|pci_nr_found
op_plus
id|retval
op_eq
l_int|0
)paren
(brace
id|retval
op_assign
op_minus
id|ENODEV
suffix:semicolon
r_goto
id|out_unregister_isapnp
suffix:semicolon
)brace
macro_line|#endif
r_return
l_int|0
suffix:semicolon
macro_line|#if !defined(CONFIG_HOTPLUG) || defined(MODULE)
id|out_unregister_isapnp
suffix:colon
id|isapnp_unregister_driver
c_func
(paren
op_amp
id|fcpnp_driver
)paren
suffix:semicolon
macro_line|#endif
id|out_unregister_pci
suffix:colon
id|pci_unregister_driver
c_func
(paren
op_amp
id|fcpci_driver
)paren
suffix:semicolon
id|out
suffix:colon
r_return
id|retval
suffix:semicolon
)brace
DECL|function|hisax_fcpcipnp_exit
r_static
r_void
id|__exit
id|hisax_fcpcipnp_exit
c_func
(paren
r_void
)paren
(brace
id|isapnp_unregister_driver
c_func
(paren
op_amp
id|fcpnp_driver
)paren
suffix:semicolon
id|pci_unregister_driver
c_func
(paren
op_amp
id|fcpci_driver
)paren
suffix:semicolon
)brace
DECL|variable|hisax_fcpcipnp_init
id|module_init
c_func
(paren
id|hisax_fcpcipnp_init
)paren
suffix:semicolon
DECL|variable|hisax_fcpcipnp_exit
id|module_exit
c_func
(paren
id|hisax_fcpcipnp_exit
)paren
suffix:semicolon
eof
