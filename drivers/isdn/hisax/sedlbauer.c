multiline_comment|/* $Id: sedlbauer.c,v 1.25.6.6 2001/09/23 22:24:51 kai Exp $&n; *&n; * low level stuff for Sedlbauer cards&n; * includes support for the Sedlbauer speed star (speed star II),&n; * support for the Sedlbauer speed fax+,&n; * support for the Sedlbauer ISDN-Controller PC/104 and&n; * support for the Sedlbauer speed pci&n; * derived from the original file asuscom.c from Karsten Keil&n; *&n; * Author       Marcus Niemann&n; * Copyright    by Marcus Niemann    &lt;niemann@www-bib.fh-bielefeld.de&gt;&n; * &n; * This software may be used and distributed according to the terms&n; * of the GNU General Public License, incorporated herein by reference.&n; *&n; * Thanks to  Karsten Keil&n; *            Sedlbauer AG for informations&n; *            Edgar Toernig&n; *&n; */
multiline_comment|/* Supported cards:&n; * Card:&t;Chip:&t;&t;Configuration:&t;Comment:&n; * ---------------------------------------------------------------------&n; * Speed Card&t;ISAC_HSCX&t;DIP-SWITCH&n; * Speed Win&t;ISAC_HSCX&t;ISAPNP&n; * Speed Fax+&t;ISAC_ISAR&t;ISAPNP&t;&t;Full analog support&n; * Speed Star&t;ISAC_HSCX&t;CARDMGR&n; * Speed Win2&t;IPAC&t;&t;ISAPNP&n; * ISDN PC/104&t;IPAC&t;&t;DIP-SWITCH&n; * Speed Star2&t;IPAC&t;&t;CARDMGR&n; * Speed PCI&t;IPAC&t;&t;PCI PNP&n; * Speed Fax+ &t;ISAC_ISAR&t;PCI PNP&t;&t;Full analog support&n; *&n; * Important:&n; * For the sedlbauer speed fax+ to work properly you have to download&n; * the firmware onto the card.&n; * For example: hisaxctrl &lt;DriverID&gt; 9 ISAR.BIN&n;*/
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &quot;hisax.h&quot;
macro_line|#include &quot;isac.h&quot;
macro_line|#include &quot;ipac.h&quot;
macro_line|#include &quot;hscx.h&quot;
macro_line|#include &quot;isar.h&quot;
macro_line|#include &quot;isdnl1.h&quot;
macro_line|#include &lt;linux/pci.h&gt;
macro_line|#include &lt;linux/isapnp.h&gt;
r_extern
r_const
r_char
op_star
id|CardType
(braket
)braket
suffix:semicolon
DECL|variable|sedlbauer_lock
r_static
id|spinlock_t
id|sedlbauer_lock
op_assign
id|SPIN_LOCK_UNLOCKED
suffix:semicolon
DECL|variable|Sedlbauer_revision
r_const
r_char
op_star
id|Sedlbauer_revision
op_assign
l_string|&quot;$Revision: 1.25.6.6 $&quot;
suffix:semicolon
DECL|variable|Sedlbauer_Types
r_const
r_char
op_star
id|Sedlbauer_Types
(braket
)braket
op_assign
(brace
l_string|&quot;None&quot;
comma
l_string|&quot;speed card/win&quot;
comma
l_string|&quot;speed star&quot;
comma
l_string|&quot;speed fax+&quot;
comma
l_string|&quot;speed win II / ISDN PC/104&quot;
comma
l_string|&quot;speed star II&quot;
comma
l_string|&quot;speed pci&quot;
comma
l_string|&quot;speed fax+ pyramid&quot;
comma
l_string|&quot;speed fax+ pci&quot;
)brace
suffix:semicolon
DECL|macro|PCI_SUBVENDOR_SPEEDFAX_PYRAMID
mdefine_line|#define PCI_SUBVENDOR_SPEEDFAX_PYRAMID&t;0x51
DECL|macro|PCI_SUBVENDOR_SEDLBAUER_PCI
mdefine_line|#define PCI_SUBVENDOR_SEDLBAUER_PCI&t;0x53
DECL|macro|PCI_SUBVENDOR_SPEEDFAX_PCI
mdefine_line|#define PCI_SUBVENDOR_SPEEDFAX_PCI&t;0x54
DECL|macro|PCI_SUB_ID_SEDLBAUER
mdefine_line|#define PCI_SUB_ID_SEDLBAUER&t;&t;0x01
DECL|macro|SEDL_SPEED_CARD_WIN
mdefine_line|#define SEDL_SPEED_CARD_WIN&t;1
DECL|macro|SEDL_SPEED_STAR
mdefine_line|#define SEDL_SPEED_STAR &t;2
DECL|macro|SEDL_SPEED_FAX
mdefine_line|#define SEDL_SPEED_FAX&t;&t;3
DECL|macro|SEDL_SPEED_WIN2_PC104
mdefine_line|#define SEDL_SPEED_WIN2_PC104 &t;4
DECL|macro|SEDL_SPEED_STAR2
mdefine_line|#define SEDL_SPEED_STAR2 &t;5
DECL|macro|SEDL_SPEED_PCI
mdefine_line|#define SEDL_SPEED_PCI   &t;6
DECL|macro|SEDL_SPEEDFAX_PYRAMID
mdefine_line|#define SEDL_SPEEDFAX_PYRAMID&t;7
DECL|macro|SEDL_SPEEDFAX_PCI
mdefine_line|#define SEDL_SPEEDFAX_PCI&t;8
DECL|macro|SEDL_CHIP_ISAC_HSCX
mdefine_line|#define SEDL_CHIP_ISAC_HSCX&t;1
DECL|macro|SEDL_CHIP_ISAC_ISAR
mdefine_line|#define SEDL_CHIP_ISAC_ISAR&t;2
DECL|macro|SEDL_CHIP_IPAC
mdefine_line|#define SEDL_CHIP_IPAC&t;&t;3
DECL|macro|SEDL_BUS_ISA
mdefine_line|#define SEDL_BUS_ISA&t;&t;1
DECL|macro|SEDL_BUS_PCI
mdefine_line|#define SEDL_BUS_PCI&t;&t;2
DECL|macro|SEDL_BUS_PCMCIA
mdefine_line|#define&t;SEDL_BUS_PCMCIA&t;&t;3
DECL|macro|byteout
mdefine_line|#define byteout(addr,val) outb(val,addr)
DECL|macro|bytein
mdefine_line|#define bytein(addr) inb(addr)
DECL|macro|SEDL_HSCX_ISA_RESET_ON
mdefine_line|#define SEDL_HSCX_ISA_RESET_ON&t;0
DECL|macro|SEDL_HSCX_ISA_RESET_OFF
mdefine_line|#define SEDL_HSCX_ISA_RESET_OFF&t;1
DECL|macro|SEDL_HSCX_ISA_ISAC
mdefine_line|#define SEDL_HSCX_ISA_ISAC&t;2
DECL|macro|SEDL_HSCX_ISA_HSCX
mdefine_line|#define SEDL_HSCX_ISA_HSCX&t;3
DECL|macro|SEDL_HSCX_ISA_ADR
mdefine_line|#define SEDL_HSCX_ISA_ADR&t;4
DECL|macro|SEDL_HSCX_PCMCIA_RESET
mdefine_line|#define SEDL_HSCX_PCMCIA_RESET&t;0
DECL|macro|SEDL_HSCX_PCMCIA_ISAC
mdefine_line|#define SEDL_HSCX_PCMCIA_ISAC&t;1
DECL|macro|SEDL_HSCX_PCMCIA_HSCX
mdefine_line|#define SEDL_HSCX_PCMCIA_HSCX&t;2
DECL|macro|SEDL_HSCX_PCMCIA_ADR
mdefine_line|#define SEDL_HSCX_PCMCIA_ADR&t;4
DECL|macro|SEDL_ISAR_ISA_ISAC
mdefine_line|#define SEDL_ISAR_ISA_ISAC&t;&t;4
DECL|macro|SEDL_ISAR_ISA_ISAR
mdefine_line|#define SEDL_ISAR_ISA_ISAR&t;&t;6
DECL|macro|SEDL_ISAR_ISA_ADR
mdefine_line|#define SEDL_ISAR_ISA_ADR&t;&t;8
DECL|macro|SEDL_ISAR_ISA_ISAR_RESET_ON
mdefine_line|#define SEDL_ISAR_ISA_ISAR_RESET_ON&t;10
DECL|macro|SEDL_ISAR_ISA_ISAR_RESET_OFF
mdefine_line|#define SEDL_ISAR_ISA_ISAR_RESET_OFF&t;12
DECL|macro|SEDL_IPAC_ANY_ADR
mdefine_line|#define SEDL_IPAC_ANY_ADR&t;&t;0
DECL|macro|SEDL_IPAC_ANY_IPAC
mdefine_line|#define SEDL_IPAC_ANY_IPAC&t;&t;2
DECL|macro|SEDL_IPAC_PCI_BASE
mdefine_line|#define SEDL_IPAC_PCI_BASE&t;&t;0
DECL|macro|SEDL_IPAC_PCI_ADR
mdefine_line|#define SEDL_IPAC_PCI_ADR&t;&t;0xc0
DECL|macro|SEDL_IPAC_PCI_IPAC
mdefine_line|#define SEDL_IPAC_PCI_IPAC&t;&t;0xc8
DECL|macro|SEDL_ISAR_PCI_ADR
mdefine_line|#define SEDL_ISAR_PCI_ADR&t;&t;0xc8
DECL|macro|SEDL_ISAR_PCI_ISAC
mdefine_line|#define SEDL_ISAR_PCI_ISAC&t;&t;0xd0
DECL|macro|SEDL_ISAR_PCI_ISAR
mdefine_line|#define SEDL_ISAR_PCI_ISAR&t;&t;0xe0
DECL|macro|SEDL_ISAR_PCI_ISAR_RESET_ON
mdefine_line|#define SEDL_ISAR_PCI_ISAR_RESET_ON&t;0x01
DECL|macro|SEDL_ISAR_PCI_ISAR_RESET_OFF
mdefine_line|#define SEDL_ISAR_PCI_ISAR_RESET_OFF&t;0x18
DECL|macro|SEDL_ISAR_PCI_LED1
mdefine_line|#define SEDL_ISAR_PCI_LED1&t;&t;0x08
DECL|macro|SEDL_ISAR_PCI_LED2
mdefine_line|#define SEDL_ISAR_PCI_LED2&t;&t;0x10
DECL|macro|SEDL_RESET
mdefine_line|#define SEDL_RESET      0x3&t;/* same as DOS driver */
r_static
r_inline
id|u8
DECL|function|readreg
id|readreg
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|cs
comma
r_int
r_int
id|adr
comma
id|u8
id|off
)paren
(brace
id|u8
id|ret
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|sedlbauer_lock
comma
id|flags
)paren
suffix:semicolon
id|byteout
c_func
(paren
id|cs-&gt;hw.sedl.adr
comma
id|off
)paren
suffix:semicolon
id|ret
op_assign
id|bytein
c_func
(paren
id|adr
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|sedlbauer_lock
comma
id|flags
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
r_static
r_inline
r_void
DECL|function|readfifo
id|readfifo
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|cs
comma
r_int
r_int
id|adr
comma
id|u8
id|off
comma
id|u8
op_star
id|data
comma
r_int
id|size
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|sedlbauer_lock
comma
id|flags
)paren
suffix:semicolon
id|byteout
c_func
(paren
id|cs-&gt;hw.sedl.adr
comma
id|off
)paren
suffix:semicolon
id|insb
c_func
(paren
id|adr
comma
id|data
comma
id|size
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|sedlbauer_lock
comma
id|flags
)paren
suffix:semicolon
)brace
r_static
r_inline
r_void
DECL|function|writereg
id|writereg
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|cs
comma
r_int
r_int
id|adr
comma
id|u8
id|off
comma
id|u8
id|data
)paren
(brace
id|byteout
c_func
(paren
id|cs-&gt;hw.sedl.adr
comma
id|off
)paren
suffix:semicolon
id|byteout
c_func
(paren
id|adr
comma
id|data
)paren
suffix:semicolon
)brace
r_static
r_inline
r_void
DECL|function|writefifo
id|writefifo
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|cs
comma
r_int
r_int
id|adr
comma
id|u8
id|off
comma
id|u8
op_star
id|data
comma
r_int
id|size
)paren
(brace
id|byteout
c_func
(paren
id|cs-&gt;hw.sedl.adr
comma
id|off
)paren
suffix:semicolon
id|outsb
c_func
(paren
id|adr
comma
id|data
comma
id|size
)paren
suffix:semicolon
)brace
r_static
id|u8
DECL|function|isac_read
id|isac_read
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|cs
comma
id|u8
id|offset
)paren
(brace
r_return
id|readreg
c_func
(paren
id|cs
comma
id|cs-&gt;hw.sedl.isac
comma
id|offset
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|isac_write
id|isac_write
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|cs
comma
id|u8
id|offset
comma
id|u8
id|value
)paren
(brace
id|writereg
c_func
(paren
id|cs
comma
id|cs-&gt;hw.sedl.isac
comma
id|offset
comma
id|value
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|isac_read_fifo
id|isac_read_fifo
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|cs
comma
id|u8
op_star
id|data
comma
r_int
id|size
)paren
(brace
id|readfifo
c_func
(paren
id|cs
comma
id|cs-&gt;hw.sedl.isac
comma
l_int|0
comma
id|data
comma
id|size
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|isac_write_fifo
id|isac_write_fifo
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|cs
comma
id|u8
op_star
id|data
comma
r_int
id|size
)paren
(brace
id|writefifo
c_func
(paren
id|cs
comma
id|cs-&gt;hw.sedl.isac
comma
l_int|0
comma
id|data
comma
id|size
)paren
suffix:semicolon
)brace
DECL|variable|isac_ops
r_static
r_struct
id|dc_hw_ops
id|isac_ops
op_assign
(brace
dot
id|read_reg
op_assign
id|isac_read
comma
dot
id|write_reg
op_assign
id|isac_write
comma
dot
id|read_fifo
op_assign
id|isac_read_fifo
comma
dot
id|write_fifo
op_assign
id|isac_write_fifo
comma
)brace
suffix:semicolon
r_static
id|u8
DECL|function|hscx_read
id|hscx_read
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|cs
comma
r_int
id|hscx
comma
id|u8
id|offset
)paren
(brace
r_return
id|readreg
c_func
(paren
id|cs
comma
id|cs-&gt;hw.sedl.hscx
comma
id|offset
op_plus
(paren
id|hscx
ques
c_cond
l_int|0x40
suffix:colon
l_int|0
)paren
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|hscx_write
id|hscx_write
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|cs
comma
r_int
id|hscx
comma
id|u8
id|offset
comma
id|u8
id|value
)paren
(brace
id|writereg
c_func
(paren
id|cs
comma
id|cs-&gt;hw.sedl.hscx
comma
id|offset
op_plus
(paren
id|hscx
ques
c_cond
l_int|0x40
suffix:colon
l_int|0
)paren
comma
id|value
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|hscx_read_fifo
id|hscx_read_fifo
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|cs
comma
r_int
id|hscx
comma
id|u8
op_star
id|data
comma
r_int
id|size
)paren
(brace
id|readfifo
c_func
(paren
id|cs
comma
id|cs-&gt;hw.sedl.hscx
comma
id|hscx
ques
c_cond
l_int|0x40
suffix:colon
l_int|0
comma
id|data
comma
id|size
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|hscx_write_fifo
id|hscx_write_fifo
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|cs
comma
r_int
id|hscx
comma
id|u8
op_star
id|data
comma
r_int
id|size
)paren
(brace
id|writefifo
c_func
(paren
id|cs
comma
id|cs-&gt;hw.sedl.hscx
comma
id|hscx
ques
c_cond
l_int|0x40
suffix:colon
l_int|0
comma
id|data
comma
id|size
)paren
suffix:semicolon
)brace
DECL|variable|hscx_ops
r_static
r_struct
id|bc_hw_ops
id|hscx_ops
op_assign
(brace
dot
id|read_reg
op_assign
id|hscx_read
comma
dot
id|write_reg
op_assign
id|hscx_write
comma
dot
id|read_fifo
op_assign
id|hscx_read_fifo
comma
dot
id|write_fifo
op_assign
id|hscx_write_fifo
comma
)brace
suffix:semicolon
r_static
r_inline
id|u8
DECL|function|ipac_read
id|ipac_read
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|cs
comma
id|u8
id|offset
)paren
(brace
r_return
id|readreg
c_func
(paren
id|cs
comma
id|cs-&gt;hw.sedl.isac
comma
id|offset
)paren
suffix:semicolon
)brace
r_static
r_inline
r_void
DECL|function|ipac_write
id|ipac_write
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|cs
comma
id|u8
id|offset
comma
id|u8
id|value
)paren
(brace
id|writereg
c_func
(paren
id|cs
comma
id|cs-&gt;hw.sedl.isac
comma
id|offset
comma
id|value
)paren
suffix:semicolon
)brace
r_static
r_inline
r_void
DECL|function|ipac_readfifo
id|ipac_readfifo
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|cs
comma
id|u8
id|offset
comma
id|u8
op_star
id|data
comma
r_int
id|size
)paren
(brace
id|readfifo
c_func
(paren
id|cs
comma
id|cs-&gt;hw.sedl.isac
comma
id|offset
comma
id|data
comma
id|size
)paren
suffix:semicolon
)brace
r_static
r_inline
r_void
DECL|function|ipac_writefifo
id|ipac_writefifo
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|cs
comma
id|u8
id|offset
comma
id|u8
op_star
id|data
comma
r_int
id|size
)paren
(brace
id|writefifo
c_func
(paren
id|cs
comma
id|cs-&gt;hw.sedl.isac
comma
id|offset
comma
id|data
comma
id|size
)paren
suffix:semicolon
)brace
multiline_comment|/* This will generate ipac_dc_ops and ipac_bc_ops using the functions&n; * above */
DECL|variable|ipac
id|BUILD_IPAC_OPS
c_func
(paren
id|ipac
)paren
suffix:semicolon
multiline_comment|/* ISAR access routines&n; * mode = 0 access with IRQ on&n; * mode = 1 access with IRQ off&n; * mode = 2 access with IRQ off and using last offset&n; */
r_static
id|u8
DECL|function|isar_read
id|isar_read
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|cs
comma
r_int
id|mode
comma
id|u8
id|offset
)paren
(brace
r_if
c_cond
(paren
id|mode
op_eq
l_int|0
)paren
r_return
id|readreg
c_func
(paren
id|cs
comma
id|cs-&gt;hw.sedl.hscx
comma
id|offset
)paren
suffix:semicolon
r_if
c_cond
(paren
id|mode
op_eq
l_int|1
)paren
id|byteout
c_func
(paren
id|cs-&gt;hw.sedl.adr
comma
id|offset
)paren
suffix:semicolon
r_return
id|bytein
c_func
(paren
id|cs-&gt;hw.sedl.hscx
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|isar_write
id|isar_write
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|cs
comma
r_int
id|mode
comma
id|u8
id|offset
comma
id|u8
id|value
)paren
(brace
r_if
c_cond
(paren
id|mode
op_eq
l_int|0
)paren
r_return
id|writereg
c_func
(paren
id|cs
comma
id|cs-&gt;hw.sedl.hscx
comma
id|offset
comma
id|value
)paren
suffix:semicolon
r_if
c_cond
(paren
id|mode
op_eq
l_int|1
)paren
id|byteout
c_func
(paren
id|cs-&gt;hw.sedl.adr
comma
id|offset
)paren
suffix:semicolon
id|byteout
c_func
(paren
id|cs-&gt;hw.sedl.hscx
comma
id|value
)paren
suffix:semicolon
)brace
DECL|variable|isar_ops
r_static
r_struct
id|bc_hw_ops
id|isar_ops
op_assign
(brace
dot
id|read_reg
op_assign
id|isar_read
comma
dot
id|write_reg
op_assign
id|isar_write
comma
)brace
suffix:semicolon
r_static
id|irqreturn_t
DECL|function|sedlbauer_interrupt
id|sedlbauer_interrupt
c_func
(paren
r_int
id|intno
comma
r_void
op_star
id|dev_id
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
r_struct
id|IsdnCardState
op_star
id|cs
op_assign
id|dev_id
suffix:semicolon
r_if
c_cond
(paren
(paren
id|cs-&gt;hw.sedl.bus
op_eq
id|SEDL_BUS_PCMCIA
)paren
op_logical_and
(paren
op_star
id|cs-&gt;busy_flag
op_eq
l_int|1
)paren
)paren
(brace
multiline_comment|/* The card tends to generate interrupts while being removed&n;&t;&t;   causing us to just crash the kernel. bad. */
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;Sedlbauer: card not available!&bslash;n&quot;
)paren
suffix:semicolon
r_return
id|IRQ_NONE
suffix:semicolon
)brace
r_return
id|hscxisac_irq
c_func
(paren
id|intno
comma
id|dev_id
comma
id|regs
)paren
suffix:semicolon
)brace
r_static
id|irqreturn_t
DECL|function|sedlbauer_isar_interrupt
id|sedlbauer_isar_interrupt
c_func
(paren
r_int
id|intno
comma
r_void
op_star
id|dev_id
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
r_struct
id|IsdnCardState
op_star
id|cs
op_assign
id|dev_id
suffix:semicolon
id|u8
id|val
suffix:semicolon
r_int
id|cnt
op_assign
l_int|5
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|cs-&gt;lock
)paren
suffix:semicolon
id|val
op_assign
id|isar_read
c_func
(paren
id|cs
comma
l_int|0
comma
id|ISAR_IRQBIT
)paren
suffix:semicolon
id|Start_ISAR
suffix:colon
r_if
c_cond
(paren
id|val
op_amp
id|ISAR_IRQSTA
)paren
id|isar_int_main
c_func
(paren
id|cs
)paren
suffix:semicolon
id|val
op_assign
id|isac_read
c_func
(paren
id|cs
comma
id|ISAC_ISTA
)paren
suffix:semicolon
id|Start_ISAC
suffix:colon
r_if
c_cond
(paren
id|val
)paren
id|isac_interrupt
c_func
(paren
id|cs
comma
id|val
)paren
suffix:semicolon
id|val
op_assign
id|isar_read
c_func
(paren
id|cs
comma
l_int|0
comma
id|ISAR_IRQBIT
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|val
op_amp
id|ISAR_IRQSTA
)paren
op_logical_and
op_decrement
id|cnt
)paren
(brace
r_if
c_cond
(paren
id|cs-&gt;debug
op_amp
id|L1_DEB_HSCX
)paren
id|debugl1
c_func
(paren
id|cs
comma
l_string|&quot;ISAR IntStat after IntRoutine&quot;
)paren
suffix:semicolon
r_goto
id|Start_ISAR
suffix:semicolon
)brace
id|val
op_assign
id|isac_read
c_func
(paren
id|cs
comma
id|ISAC_ISTA
)paren
suffix:semicolon
r_if
c_cond
(paren
id|val
op_logical_and
op_decrement
id|cnt
)paren
(brace
r_if
c_cond
(paren
id|cs-&gt;debug
op_amp
id|L1_DEB_ISAC
)paren
id|debugl1
c_func
(paren
id|cs
comma
l_string|&quot;ISAC IntStat after IntRoutine&quot;
)paren
suffix:semicolon
r_goto
id|Start_ISAC
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|cnt
)paren
r_if
c_cond
(paren
id|cs-&gt;debug
op_amp
id|L1_DEB_ISAC
)paren
id|debugl1
c_func
(paren
id|cs
comma
l_string|&quot;Sedlbauer IRQ LOOP&quot;
)paren
suffix:semicolon
id|isar_write
c_func
(paren
id|cs
comma
l_int|0
comma
id|ISAR_IRQBIT
comma
l_int|0
)paren
suffix:semicolon
id|isac_write
c_func
(paren
id|cs
comma
id|ISAC_MASK
comma
l_int|0xFF
)paren
suffix:semicolon
id|isac_write
c_func
(paren
id|cs
comma
id|ISAC_MASK
comma
l_int|0x0
)paren
suffix:semicolon
id|isar_write
c_func
(paren
id|cs
comma
l_int|0
comma
id|ISAR_IRQBIT
comma
id|ISAR_IRQMSK
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|cs-&gt;lock
)paren
suffix:semicolon
r_return
id|IRQ_HANDLED
suffix:semicolon
)brace
r_static
r_int
DECL|function|sedlbauer_ipac_reset
id|sedlbauer_ipac_reset
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|cs
)paren
(brace
id|writereg
c_func
(paren
id|cs
comma
id|cs-&gt;hw.sedl.isac
comma
id|IPAC_POTA2
comma
l_int|0x20
)paren
suffix:semicolon
id|set_current_state
c_func
(paren
id|TASK_UNINTERRUPTIBLE
)paren
suffix:semicolon
id|schedule_timeout
c_func
(paren
(paren
l_int|10
op_star
id|HZ
)paren
op_div
l_int|1000
)paren
suffix:semicolon
id|writereg
c_func
(paren
id|cs
comma
id|cs-&gt;hw.sedl.isac
comma
id|IPAC_POTA2
comma
l_int|0x0
)paren
suffix:semicolon
id|set_current_state
c_func
(paren
id|TASK_UNINTERRUPTIBLE
)paren
suffix:semicolon
id|schedule_timeout
c_func
(paren
(paren
l_int|10
op_star
id|HZ
)paren
op_div
l_int|1000
)paren
suffix:semicolon
id|writereg
c_func
(paren
id|cs
comma
id|cs-&gt;hw.sedl.isac
comma
id|IPAC_CONF
comma
l_int|0x0
)paren
suffix:semicolon
id|writereg
c_func
(paren
id|cs
comma
id|cs-&gt;hw.sedl.isac
comma
id|IPAC_ACFG
comma
l_int|0xff
)paren
suffix:semicolon
id|writereg
c_func
(paren
id|cs
comma
id|cs-&gt;hw.sedl.isac
comma
id|IPAC_AOE
comma
l_int|0x0
)paren
suffix:semicolon
id|writereg
c_func
(paren
id|cs
comma
id|cs-&gt;hw.sedl.isac
comma
id|IPAC_MASK
comma
l_int|0xc0
)paren
suffix:semicolon
id|writereg
c_func
(paren
id|cs
comma
id|cs-&gt;hw.sedl.isac
comma
id|IPAC_PCFG
comma
l_int|0x12
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|sedlbauer_isar_pci_reset
id|sedlbauer_isar_pci_reset
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|cs
)paren
(brace
id|byteout
c_func
(paren
id|cs-&gt;hw.sedl.cfg_reg
op_plus
l_int|3
comma
id|cs-&gt;hw.sedl.reset_on
)paren
suffix:semicolon
id|current-&gt;state
op_assign
id|TASK_UNINTERRUPTIBLE
suffix:semicolon
id|schedule_timeout
c_func
(paren
(paren
l_int|20
op_star
id|HZ
)paren
op_div
l_int|1000
)paren
suffix:semicolon
id|byteout
c_func
(paren
id|cs-&gt;hw.sedl.cfg_reg
op_plus
l_int|3
comma
id|cs-&gt;hw.sedl.reset_off
)paren
suffix:semicolon
id|current-&gt;state
op_assign
id|TASK_UNINTERRUPTIBLE
suffix:semicolon
id|schedule_timeout
c_func
(paren
(paren
l_int|20
op_star
id|HZ
)paren
op_div
l_int|1000
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|sedlbauer_reset
id|sedlbauer_reset
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|cs
)paren
(brace
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;Sedlbauer: resetting card&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|cs-&gt;hw.sedl.bus
op_eq
id|SEDL_BUS_PCMCIA
op_logical_and
id|cs-&gt;hw.sedl.chip
op_eq
id|SEDL_CHIP_ISAC_HSCX
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|cs-&gt;hw.sedl.chip
op_eq
id|SEDL_CHIP_IPAC
)paren
(brace
r_return
id|sedlbauer_ipac_reset
c_func
(paren
id|cs
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
(paren
id|cs-&gt;hw.sedl.chip
op_eq
id|SEDL_CHIP_ISAC_ISAR
)paren
op_logical_and
(paren
id|cs-&gt;hw.sedl.bus
op_eq
id|SEDL_BUS_PCI
)paren
)paren
(brace
r_return
id|sedlbauer_isar_pci_reset
c_func
(paren
id|cs
)paren
suffix:semicolon
)brace
r_else
(brace
id|byteout
c_func
(paren
id|cs-&gt;hw.sedl.reset_on
comma
id|SEDL_RESET
)paren
suffix:semicolon
multiline_comment|/* Reset On */
id|set_current_state
c_func
(paren
id|TASK_UNINTERRUPTIBLE
)paren
suffix:semicolon
id|schedule_timeout
c_func
(paren
(paren
l_int|10
op_star
id|HZ
)paren
op_div
l_int|1000
)paren
suffix:semicolon
id|byteout
c_func
(paren
id|cs-&gt;hw.sedl.reset_off
comma
l_int|0
)paren
suffix:semicolon
multiline_comment|/* Reset Off */
id|set_current_state
c_func
(paren
id|TASK_UNINTERRUPTIBLE
)paren
suffix:semicolon
id|schedule_timeout
c_func
(paren
(paren
l_int|10
op_star
id|HZ
)paren
op_div
l_int|1000
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_void
DECL|function|sedlbauer_isar_release
id|sedlbauer_isar_release
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|cs
)paren
(brace
id|isar_write
c_func
(paren
id|cs
comma
l_int|0
comma
id|ISAR_IRQBIT
comma
l_int|0
)paren
suffix:semicolon
id|isac_write
c_func
(paren
id|cs
comma
id|ISAC_MASK
comma
l_int|0xFF
)paren
suffix:semicolon
id|sedlbauer_reset
c_func
(paren
id|cs
)paren
suffix:semicolon
id|isar_write
c_func
(paren
id|cs
comma
l_int|0
comma
id|ISAR_IRQBIT
comma
l_int|0
)paren
suffix:semicolon
id|isac_write
c_func
(paren
id|cs
comma
id|ISAC_MASK
comma
l_int|0xFF
)paren
suffix:semicolon
id|hisax_release_resources
c_func
(paren
id|cs
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|sedlbauer_led_handler
id|sedlbauer_led_handler
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|cs
)paren
(brace
r_if
c_cond
(paren
id|cs-&gt;subtyp
op_ne
id|SEDL_SPEEDFAX_PYRAMID
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|cs-&gt;status
op_amp
l_int|0x2000
)paren
id|cs-&gt;hw.sedl.reset_off
op_and_assign
op_complement
id|SEDL_ISAR_PCI_LED2
suffix:semicolon
r_else
id|cs-&gt;hw.sedl.reset_off
op_or_assign
id|SEDL_ISAR_PCI_LED2
suffix:semicolon
r_if
c_cond
(paren
id|cs-&gt;status
op_amp
l_int|0x1000
)paren
id|cs-&gt;hw.sedl.reset_off
op_and_assign
op_complement
id|SEDL_ISAR_PCI_LED1
suffix:semicolon
r_else
id|cs-&gt;hw.sedl.reset_off
op_or_assign
id|SEDL_ISAR_PCI_LED1
suffix:semicolon
id|byteout
c_func
(paren
id|cs-&gt;hw.sedl.cfg_reg
op_plus
l_int|3
comma
id|cs-&gt;hw.sedl.reset_off
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|sedlbauer_isar_init
id|sedlbauer_isar_init
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|cs
)paren
(brace
id|isar_write
c_func
(paren
id|cs
comma
l_int|0
comma
id|ISAR_IRQBIT
comma
l_int|0
)paren
suffix:semicolon
id|initisac
c_func
(paren
id|cs
)paren
suffix:semicolon
id|initisar
c_func
(paren
id|cs
)paren
suffix:semicolon
)brace
DECL|variable|sedlbauer_ops
r_static
r_struct
id|card_ops
id|sedlbauer_ops
op_assign
(brace
dot
id|init
op_assign
id|inithscxisac
comma
dot
id|reset
op_assign
id|sedlbauer_reset
comma
dot
id|release
op_assign
id|hisax_release_resources
comma
dot
id|led_handler
op_assign
id|sedlbauer_led_handler
comma
dot
id|irq_func
op_assign
id|sedlbauer_interrupt
comma
)brace
suffix:semicolon
DECL|variable|sedlbauer_ipac_ops
r_static
r_struct
id|card_ops
id|sedlbauer_ipac_ops
op_assign
(brace
dot
id|init
op_assign
id|ipac_init
comma
dot
id|reset
op_assign
id|sedlbauer_reset
comma
dot
id|release
op_assign
id|hisax_release_resources
comma
dot
id|led_handler
op_assign
id|sedlbauer_led_handler
comma
dot
id|irq_func
op_assign
id|ipac_irq
comma
)brace
suffix:semicolon
DECL|variable|sedlbauer_isar_ops
r_static
r_struct
id|card_ops
id|sedlbauer_isar_ops
op_assign
(brace
dot
id|init
op_assign
id|sedlbauer_isar_init
comma
dot
id|reset
op_assign
id|sedlbauer_reset
comma
dot
id|release
op_assign
id|sedlbauer_isar_release
comma
dot
id|led_handler
op_assign
id|sedlbauer_led_handler
comma
dot
id|irq_func
op_assign
id|sedlbauer_isar_interrupt
comma
)brace
suffix:semicolon
r_static
r_int
id|__init
DECL|function|sedl_ipac_probe
id|sedl_ipac_probe
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|cs
)paren
(brace
id|u8
id|val
suffix:semicolon
id|cs-&gt;hw.sedl.adr
op_assign
id|cs-&gt;hw.sedl.cfg_reg
op_plus
id|SEDL_IPAC_ANY_ADR
suffix:semicolon
id|val
op_assign
id|readreg
c_func
(paren
id|cs
comma
id|cs-&gt;hw.sedl.cfg_reg
op_plus
id|SEDL_IPAC_ANY_IPAC
comma
id|IPAC_ID
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;Sedlbauer: testing IPAC version %x&bslash;n&quot;
comma
id|val
)paren
suffix:semicolon
r_return
(paren
id|val
op_eq
l_int|1
op_logical_or
id|val
op_eq
l_int|2
)paren
suffix:semicolon
)brace
r_static
r_int
id|__init
DECL|function|sedl_ipac_init
id|sedl_ipac_init
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|cs
)paren
(brace
id|cs-&gt;card_ops
op_assign
op_amp
id|sedlbauer_ipac_ops
suffix:semicolon
r_if
c_cond
(paren
id|ipac_setup
c_func
(paren
id|cs
comma
op_amp
id|ipac_dc_ops
comma
op_amp
id|ipac_bc_ops
)paren
)paren
r_return
op_minus
id|ENODEV
suffix:semicolon
id|sedlbauer_reset
c_func
(paren
id|cs
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
id|__init
DECL|function|sedl_isac_isar_init
id|sedl_isac_isar_init
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|cs
)paren
(brace
id|cs-&gt;bcs
(braket
l_int|0
)braket
dot
id|hw.isar.reg
op_assign
op_amp
id|cs-&gt;hw.sedl.isar
suffix:semicolon
id|cs-&gt;bcs
(braket
l_int|1
)braket
dot
id|hw.isar.reg
op_assign
op_amp
id|cs-&gt;hw.sedl.isar
suffix:semicolon
id|__set_bit
c_func
(paren
id|HW_ISAR
comma
op_amp
id|cs-&gt;HW_Flags
)paren
suffix:semicolon
id|cs-&gt;card_ops
op_assign
op_amp
id|sedlbauer_isar_ops
suffix:semicolon
id|cs-&gt;auxcmd
op_assign
op_amp
id|isar_auxcmd
suffix:semicolon
id|isac_setup
c_func
(paren
id|cs
comma
op_amp
id|isac_ops
)paren
suffix:semicolon
r_return
id|isar_setup
c_func
(paren
id|cs
comma
op_amp
id|isar_ops
)paren
suffix:semicolon
)brace
r_static
r_int
id|__init
DECL|function|sedl_isac_hscx_init
id|sedl_isac_hscx_init
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|cs
)paren
(brace
id|cs-&gt;card_ops
op_assign
op_amp
id|sedlbauer_ops
suffix:semicolon
r_if
c_cond
(paren
id|hscxisac_setup
c_func
(paren
id|cs
comma
op_amp
id|isac_ops
comma
op_amp
id|hscx_ops
)paren
)paren
r_return
op_minus
id|ENODEV
suffix:semicolon
id|sedlbauer_reset
c_func
(paren
id|cs
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
id|__init
DECL|function|sedl_card_win_probe
id|sedl_card_win_probe
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|cs
comma
r_struct
id|IsdnCard
op_star
id|card
)paren
(brace
id|cs-&gt;irq
op_assign
id|card-&gt;para
(braket
l_int|0
)braket
suffix:semicolon
id|cs-&gt;hw.sedl.cfg_reg
op_assign
id|card-&gt;para
(braket
l_int|1
)braket
suffix:semicolon
id|cs-&gt;hw.sedl.bus
op_assign
id|SEDL_BUS_ISA
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|request_io
c_func
(paren
op_amp
id|cs-&gt;rs
comma
id|cs-&gt;hw.sedl.cfg_reg
comma
l_int|8
comma
l_string|&quot;sedlbauer isdn&quot;
)paren
)paren
r_goto
id|err
suffix:semicolon
r_if
c_cond
(paren
id|sedl_ipac_probe
c_func
(paren
id|cs
)paren
)paren
(brace
id|cs-&gt;subtyp
op_assign
id|SEDL_SPEED_WIN2_PC104
suffix:semicolon
id|cs-&gt;hw.sedl.chip
op_assign
id|SEDL_CHIP_IPAC
suffix:semicolon
id|cs-&gt;hw.sedl.adr
op_assign
id|cs-&gt;hw.sedl.cfg_reg
op_plus
id|SEDL_IPAC_ANY_ADR
suffix:semicolon
id|cs-&gt;hw.sedl.isac
op_assign
id|cs-&gt;hw.sedl.cfg_reg
op_plus
id|SEDL_IPAC_ANY_IPAC
suffix:semicolon
r_if
c_cond
(paren
id|sedl_ipac_init
c_func
(paren
id|cs
)paren
)paren
r_goto
id|err
suffix:semicolon
)brace
r_else
(brace
id|cs-&gt;subtyp
op_assign
id|SEDL_SPEED_CARD_WIN
suffix:semicolon
id|cs-&gt;hw.sedl.chip
op_assign
id|SEDL_CHIP_ISAC_HSCX
suffix:semicolon
id|cs-&gt;hw.sedl.adr
op_assign
id|cs-&gt;hw.sedl.cfg_reg
op_plus
id|SEDL_HSCX_ISA_ADR
suffix:semicolon
id|cs-&gt;hw.sedl.isac
op_assign
id|cs-&gt;hw.sedl.cfg_reg
op_plus
id|SEDL_HSCX_ISA_ISAC
suffix:semicolon
id|cs-&gt;hw.sedl.hscx
op_assign
id|cs-&gt;hw.sedl.cfg_reg
op_plus
id|SEDL_HSCX_ISA_HSCX
suffix:semicolon
id|cs-&gt;hw.sedl.reset_on
op_assign
id|cs-&gt;hw.sedl.cfg_reg
op_plus
id|SEDL_HSCX_ISA_RESET_ON
suffix:semicolon
id|cs-&gt;hw.sedl.reset_off
op_assign
id|cs-&gt;hw.sedl.cfg_reg
op_plus
id|SEDL_HSCX_ISA_RESET_OFF
suffix:semicolon
r_if
c_cond
(paren
id|sedl_isac_hscx_init
c_func
(paren
id|cs
)paren
)paren
r_goto
id|err
suffix:semicolon
)brace
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;Sedlbauer %s: defined at 0x%x-0x%x IRQ %d&bslash;n&quot;
comma
id|Sedlbauer_Types
(braket
id|cs-&gt;subtyp
)braket
comma
id|cs-&gt;hw.sedl.cfg_reg
comma
id|cs-&gt;hw.sedl.cfg_reg
op_plus
l_int|8
comma
id|cs-&gt;irq
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
id|err
suffix:colon
id|hisax_release_resources
c_func
(paren
id|cs
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
r_static
r_int
id|__init
DECL|function|sedl_star_probe
id|sedl_star_probe
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|cs
comma
r_struct
id|IsdnCard
op_star
id|card
)paren
(brace
id|cs-&gt;hw.sedl.bus
op_assign
id|SEDL_BUS_PCMCIA
suffix:semicolon
r_if
c_cond
(paren
id|sedl_ipac_probe
c_func
(paren
id|cs
)paren
)paren
(brace
id|cs-&gt;subtyp
op_assign
id|SEDL_SPEED_STAR2
suffix:semicolon
id|cs-&gt;hw.sedl.chip
op_assign
id|SEDL_CHIP_IPAC
suffix:semicolon
id|cs-&gt;hw.sedl.adr
op_assign
id|cs-&gt;hw.sedl.cfg_reg
op_plus
id|SEDL_IPAC_ANY_ADR
suffix:semicolon
id|cs-&gt;hw.sedl.isac
op_assign
id|cs-&gt;hw.sedl.cfg_reg
op_plus
id|SEDL_IPAC_ANY_IPAC
suffix:semicolon
r_if
c_cond
(paren
id|sedl_ipac_init
c_func
(paren
id|cs
)paren
)paren
r_goto
id|err
suffix:semicolon
)brace
r_else
(brace
id|cs-&gt;subtyp
op_assign
id|SEDL_SPEED_STAR
suffix:semicolon
id|cs-&gt;hw.sedl.chip
op_assign
id|SEDL_CHIP_ISAC_HSCX
suffix:semicolon
id|cs-&gt;hw.sedl.adr
op_assign
id|cs-&gt;hw.sedl.cfg_reg
op_plus
id|SEDL_HSCX_PCMCIA_ADR
suffix:semicolon
id|cs-&gt;hw.sedl.isac
op_assign
id|cs-&gt;hw.sedl.cfg_reg
op_plus
id|SEDL_HSCX_PCMCIA_ISAC
suffix:semicolon
id|cs-&gt;hw.sedl.hscx
op_assign
id|cs-&gt;hw.sedl.cfg_reg
op_plus
id|SEDL_HSCX_PCMCIA_HSCX
suffix:semicolon
id|cs-&gt;hw.sedl.reset_on
op_assign
id|cs-&gt;hw.sedl.cfg_reg
op_plus
id|SEDL_HSCX_PCMCIA_RESET
suffix:semicolon
id|cs-&gt;hw.sedl.reset_off
op_assign
id|cs-&gt;hw.sedl.cfg_reg
op_plus
id|SEDL_HSCX_PCMCIA_RESET
suffix:semicolon
r_if
c_cond
(paren
id|sedl_isac_hscx_init
c_func
(paren
id|cs
)paren
)paren
r_goto
id|err
suffix:semicolon
)brace
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;Sedlbauer %s: defined at 0x%x-0x%x IRQ %d&bslash;n&quot;
comma
id|Sedlbauer_Types
(braket
id|cs-&gt;subtyp
)braket
comma
id|cs-&gt;hw.sedl.cfg_reg
comma
id|cs-&gt;hw.sedl.cfg_reg
op_plus
l_int|8
comma
id|cs-&gt;irq
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
id|err
suffix:colon
id|hisax_release_resources
c_func
(paren
id|cs
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
r_static
r_int
id|__init
DECL|function|sedl_fax_probe
id|sedl_fax_probe
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|cs
comma
r_struct
id|IsdnCard
op_star
id|card
)paren
(brace
id|cs-&gt;subtyp
op_assign
id|SEDL_SPEED_FAX
suffix:semicolon
id|cs-&gt;hw.sedl.bus
op_assign
id|SEDL_BUS_ISA
suffix:semicolon
id|cs-&gt;hw.sedl.chip
op_assign
id|SEDL_CHIP_ISAC_ISAR
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|request_io
c_func
(paren
op_amp
id|cs-&gt;rs
comma
id|cs-&gt;hw.sedl.cfg_reg
comma
l_int|16
comma
l_string|&quot;sedlbauer isdn&quot;
)paren
)paren
r_goto
id|err
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;Sedlbauer %s: defined at 0x%x-0x%x IRQ %d&bslash;n&quot;
comma
id|Sedlbauer_Types
(braket
id|cs-&gt;subtyp
)braket
comma
id|cs-&gt;hw.sedl.cfg_reg
comma
id|cs-&gt;hw.sedl.cfg_reg
op_plus
l_int|16
comma
id|cs-&gt;irq
)paren
suffix:semicolon
id|cs-&gt;hw.sedl.adr
op_assign
id|cs-&gt;hw.sedl.cfg_reg
op_plus
id|SEDL_ISAR_ISA_ADR
suffix:semicolon
id|cs-&gt;hw.sedl.isac
op_assign
id|cs-&gt;hw.sedl.cfg_reg
op_plus
id|SEDL_ISAR_ISA_ISAC
suffix:semicolon
id|cs-&gt;hw.sedl.hscx
op_assign
id|cs-&gt;hw.sedl.cfg_reg
op_plus
id|SEDL_ISAR_ISA_ISAR
suffix:semicolon
id|cs-&gt;hw.sedl.reset_on
op_assign
id|cs-&gt;hw.sedl.cfg_reg
op_plus
id|SEDL_ISAR_ISA_ISAR_RESET_ON
suffix:semicolon
id|cs-&gt;hw.sedl.reset_off
op_assign
id|cs-&gt;hw.sedl.cfg_reg
op_plus
id|SEDL_ISAR_ISA_ISAR_RESET_OFF
suffix:semicolon
r_if
c_cond
(paren
id|sedl_isac_isar_init
c_func
(paren
id|cs
)paren
)paren
r_goto
id|err
suffix:semicolon
r_return
l_int|0
suffix:semicolon
id|err
suffix:colon
id|hisax_release_resources
c_func
(paren
id|cs
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
r_static
r_int
id|__init
DECL|function|sedl_pci_init
id|sedl_pci_init
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|cs
comma
r_struct
id|pci_dev
op_star
id|pdev
)paren
(brace
id|cs-&gt;irq
op_assign
id|pdev-&gt;irq
suffix:semicolon
id|cs-&gt;irq_flags
op_or_assign
id|SA_SHIRQ
suffix:semicolon
id|cs-&gt;hw.sedl.cfg_reg
op_assign
id|pci_resource_start
c_func
(paren
id|pdev
comma
l_int|0
)paren
suffix:semicolon
id|cs-&gt;hw.sedl.bus
op_assign
id|SEDL_BUS_PCI
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|request_io
c_func
(paren
op_amp
id|cs-&gt;rs
comma
id|cs-&gt;hw.sedl.cfg_reg
comma
l_int|256
comma
l_string|&quot;sedlbauer isdn&quot;
)paren
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;Sedlbauer %s: defined at 0x%x-0x%x IRQ %d&bslash;n&quot;
comma
id|Sedlbauer_Types
(braket
id|cs-&gt;subtyp
)braket
comma
id|cs-&gt;hw.sedl.cfg_reg
comma
id|cs-&gt;hw.sedl.cfg_reg
op_plus
l_int|256
comma
id|cs-&gt;irq
)paren
suffix:semicolon
id|cs-&gt;hw.sedl.reset_on
op_assign
id|SEDL_ISAR_PCI_ISAR_RESET_ON
suffix:semicolon
id|cs-&gt;hw.sedl.reset_off
op_assign
id|SEDL_ISAR_PCI_ISAR_RESET_OFF
suffix:semicolon
id|byteout
c_func
(paren
id|cs-&gt;hw.sedl.cfg_reg
comma
l_int|0xff
)paren
suffix:semicolon
id|byteout
c_func
(paren
id|cs-&gt;hw.sedl.cfg_reg
comma
l_int|0x00
)paren
suffix:semicolon
id|byteout
c_func
(paren
id|cs-&gt;hw.sedl.cfg_reg
op_plus
l_int|2
comma
l_int|0xdd
)paren
suffix:semicolon
id|byteout
c_func
(paren
id|cs-&gt;hw.sedl.cfg_reg
op_plus
l_int|5
comma
l_int|0x02
)paren
suffix:semicolon
id|byteout
c_func
(paren
id|cs-&gt;hw.sedl.cfg_reg
op_plus
l_int|3
comma
id|cs-&gt;hw.sedl.reset_on
)paren
suffix:semicolon
id|current-&gt;state
op_assign
id|TASK_UNINTERRUPTIBLE
suffix:semicolon
id|schedule_timeout
c_func
(paren
(paren
l_int|10
op_star
id|HZ
)paren
op_div
l_int|1000
)paren
suffix:semicolon
id|byteout
c_func
(paren
id|cs-&gt;hw.sedl.cfg_reg
op_plus
l_int|3
comma
id|cs-&gt;hw.sedl.reset_off
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
id|__init
DECL|function|sedl_fax_pyramid_probe
id|sedl_fax_pyramid_probe
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|cs
comma
r_struct
id|pci_dev
op_star
id|pdev
)paren
(brace
r_if
c_cond
(paren
id|pci_enable_device
c_func
(paren
id|pdev
)paren
)paren
r_goto
id|err
suffix:semicolon
id|cs-&gt;subtyp
op_assign
id|SEDL_SPEEDFAX_PYRAMID
suffix:semicolon
id|cs-&gt;hw.sedl.chip
op_assign
id|SEDL_CHIP_ISAC_ISAR
suffix:semicolon
r_if
c_cond
(paren
id|sedl_pci_init
c_func
(paren
id|cs
comma
id|pdev
)paren
)paren
r_goto
id|err
suffix:semicolon
id|cs-&gt;hw.sedl.adr
op_assign
id|cs-&gt;hw.sedl.cfg_reg
op_plus
id|SEDL_ISAR_PCI_ADR
suffix:semicolon
id|cs-&gt;hw.sedl.isac
op_assign
id|cs-&gt;hw.sedl.cfg_reg
op_plus
id|SEDL_ISAR_PCI_ISAC
suffix:semicolon
id|cs-&gt;hw.sedl.hscx
op_assign
id|cs-&gt;hw.sedl.cfg_reg
op_plus
id|SEDL_ISAR_PCI_ISAR
suffix:semicolon
r_if
c_cond
(paren
id|sedl_isac_isar_init
c_func
(paren
id|cs
)paren
)paren
r_goto
id|err
suffix:semicolon
r_return
l_int|0
suffix:semicolon
id|err
suffix:colon
id|hisax_release_resources
c_func
(paren
id|cs
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
r_static
r_int
id|__init
DECL|function|sedl_fax_pci_probe
id|sedl_fax_pci_probe
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|cs
comma
r_struct
id|pci_dev
op_star
id|pdev
)paren
(brace
r_if
c_cond
(paren
id|pci_enable_device
c_func
(paren
id|pdev
)paren
)paren
r_goto
id|err
suffix:semicolon
id|cs-&gt;subtyp
op_assign
id|SEDL_SPEEDFAX_PCI
suffix:semicolon
id|cs-&gt;hw.sedl.chip
op_assign
id|SEDL_CHIP_ISAC_ISAR
suffix:semicolon
r_if
c_cond
(paren
id|sedl_pci_init
c_func
(paren
id|cs
comma
id|pdev
)paren
)paren
r_goto
id|err
suffix:semicolon
id|cs-&gt;hw.sedl.adr
op_assign
id|cs-&gt;hw.sedl.cfg_reg
op_plus
id|SEDL_ISAR_PCI_ADR
suffix:semicolon
id|cs-&gt;hw.sedl.isac
op_assign
id|cs-&gt;hw.sedl.cfg_reg
op_plus
id|SEDL_ISAR_PCI_ISAC
suffix:semicolon
id|cs-&gt;hw.sedl.hscx
op_assign
id|cs-&gt;hw.sedl.cfg_reg
op_plus
id|SEDL_ISAR_PCI_ISAR
suffix:semicolon
r_if
c_cond
(paren
id|sedl_isac_isar_init
c_func
(paren
id|cs
)paren
)paren
r_goto
id|err
suffix:semicolon
r_return
l_int|0
suffix:semicolon
id|err
suffix:colon
id|hisax_release_resources
c_func
(paren
id|cs
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
r_static
r_int
id|__init
DECL|function|sedl_pci_probe
id|sedl_pci_probe
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|cs
comma
r_struct
id|pci_dev
op_star
id|pdev
)paren
(brace
r_if
c_cond
(paren
id|pci_enable_device
c_func
(paren
id|pdev
)paren
)paren
r_goto
id|err
suffix:semicolon
id|cs-&gt;subtyp
op_assign
id|SEDL_SPEED_PCI
suffix:semicolon
id|cs-&gt;hw.sedl.chip
op_assign
id|SEDL_CHIP_IPAC
suffix:semicolon
r_if
c_cond
(paren
id|sedl_pci_init
c_func
(paren
id|cs
comma
id|pdev
)paren
)paren
r_goto
id|err
suffix:semicolon
id|cs-&gt;hw.sedl.adr
op_assign
id|cs-&gt;hw.sedl.cfg_reg
op_plus
id|SEDL_IPAC_PCI_ADR
suffix:semicolon
id|cs-&gt;hw.sedl.isac
op_assign
id|cs-&gt;hw.sedl.cfg_reg
op_plus
id|SEDL_IPAC_PCI_IPAC
suffix:semicolon
r_if
c_cond
(paren
id|sedl_ipac_init
c_func
(paren
id|cs
)paren
)paren
r_goto
id|err
suffix:semicolon
r_return
l_int|0
suffix:semicolon
id|err
suffix:colon
id|hisax_release_resources
c_func
(paren
id|cs
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
DECL|variable|__devinitdata
r_static
r_struct
id|pci_dev
op_star
id|dev_sedl
id|__devinitdata
op_assign
l_int|NULL
suffix:semicolon
macro_line|#ifdef __ISAPNP__
DECL|variable|__initdata
r_static
r_struct
id|isapnp_device_id
id|sedl_ids
(braket
)braket
id|__initdata
op_assign
(brace
(brace
id|ISAPNP_VENDOR
c_func
(paren
l_char|&squot;S&squot;
comma
l_char|&squot;A&squot;
comma
l_char|&squot;G&squot;
)paren
comma
id|ISAPNP_FUNCTION
c_func
(paren
l_int|0x01
)paren
comma
id|ISAPNP_VENDOR
c_func
(paren
l_char|&squot;S&squot;
comma
l_char|&squot;A&squot;
comma
l_char|&squot;G&squot;
)paren
comma
id|ISAPNP_FUNCTION
c_func
(paren
l_int|0x01
)paren
comma
(paren
r_int
r_int
)paren
l_string|&quot;Speed win&quot;
)brace
comma
(brace
id|ISAPNP_VENDOR
c_func
(paren
l_char|&squot;S&squot;
comma
l_char|&squot;A&squot;
comma
l_char|&squot;G&squot;
)paren
comma
id|ISAPNP_FUNCTION
c_func
(paren
l_int|0x02
)paren
comma
id|ISAPNP_VENDOR
c_func
(paren
l_char|&squot;S&squot;
comma
l_char|&squot;A&squot;
comma
l_char|&squot;G&squot;
)paren
comma
id|ISAPNP_FUNCTION
c_func
(paren
l_int|0x02
)paren
comma
(paren
r_int
r_int
)paren
l_string|&quot;Speed Fax+&quot;
)brace
comma
(brace
l_int|0
comma
)brace
)brace
suffix:semicolon
DECL|variable|pdev
r_static
r_struct
id|isapnp_device_id
op_star
id|pdev
op_assign
op_amp
id|sedl_ids
(braket
l_int|0
)braket
suffix:semicolon
DECL|variable|__devinitdata
r_static
r_struct
id|pnp_card
op_star
id|pnp_c
id|__devinitdata
op_assign
l_int|NULL
suffix:semicolon
macro_line|#endif
r_int
id|__devinit
DECL|function|setup_sedlbauer
id|setup_sedlbauer
c_func
(paren
r_struct
id|IsdnCard
op_star
id|card
)paren
(brace
r_struct
id|IsdnCardState
op_star
id|cs
op_assign
id|card-&gt;cs
suffix:semicolon
r_char
id|tmp
(braket
l_int|64
)braket
suffix:semicolon
id|u16
id|sub_vendor_id
comma
id|sub_id
suffix:semicolon
id|strcpy
c_func
(paren
id|tmp
comma
id|Sedlbauer_revision
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;HiSax: Sedlbauer driver Rev. %s&bslash;n&quot;
comma
id|HiSax_getrev
c_func
(paren
id|tmp
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|card-&gt;para
(braket
l_int|1
)braket
)paren
(brace
r_if
c_cond
(paren
id|cs-&gt;typ
op_eq
id|ISDN_CTYPE_SEDLBAUER
)paren
(brace
r_if
c_cond
(paren
id|sedl_card_win_probe
c_func
(paren
id|card-&gt;cs
comma
id|card
)paren
OL
l_int|0
)paren
r_return
l_int|0
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|cs-&gt;typ
op_eq
id|ISDN_CTYPE_SEDLBAUER_PCMCIA
)paren
(brace
r_if
c_cond
(paren
id|sedl_star_probe
c_func
(paren
id|card-&gt;cs
comma
id|card
)paren
OL
l_int|0
)paren
r_return
l_int|0
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|cs-&gt;typ
op_eq
id|ISDN_CTYPE_SEDLBAUER_FAX
)paren
(brace
r_if
c_cond
(paren
id|sedl_fax_probe
c_func
(paren
id|card-&gt;cs
comma
id|card
)paren
OL
l_int|0
)paren
r_return
l_int|0
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
)brace
macro_line|#ifdef __ISAPNP__
r_if
c_cond
(paren
id|isapnp_present
c_func
(paren
)paren
)paren
(brace
r_struct
id|pnp_card
op_star
id|pb
suffix:semicolon
r_struct
id|pnp_dev
op_star
id|pd
suffix:semicolon
r_while
c_loop
(paren
id|pdev-&gt;card_vendor
)paren
(brace
r_if
c_cond
(paren
(paren
id|pb
op_assign
id|pnp_find_card
c_func
(paren
id|pdev-&gt;card_vendor
comma
id|pdev-&gt;card_device
comma
id|pnp_c
)paren
)paren
)paren
(brace
id|pnp_c
op_assign
id|pb
suffix:semicolon
id|pd
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
(paren
id|pd
op_assign
id|pnp_find_dev
c_func
(paren
id|pnp_c
comma
id|pdev-&gt;vendor
comma
id|pdev-&gt;function
comma
id|pd
)paren
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;HiSax: %s detected&bslash;n&quot;
comma
(paren
r_char
op_star
)paren
id|pdev-&gt;driver_data
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pnp_device_attach
c_func
(paren
id|pd
)paren
OL
l_int|0
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;Sedlbauer PnP: attach failed&bslash;n&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|pnp_activate_dev
c_func
(paren
id|pd
)paren
OL
l_int|0
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;Sedlbauer PnP: activate failed&bslash;n&quot;
)paren
suffix:semicolon
id|pnp_device_detach
c_func
(paren
id|pd
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|pnp_irq_valid
c_func
(paren
id|pd
comma
l_int|0
)paren
op_logical_or
op_logical_neg
id|pnp_port_valid
c_func
(paren
id|pd
comma
l_int|0
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;Sedlbauer PnP:some resources are missing %ld/%lx&bslash;n&quot;
comma
id|pnp_irq
c_func
(paren
id|pd
comma
l_int|0
)paren
comma
id|pnp_port_start
c_func
(paren
id|pd
comma
l_int|0
)paren
)paren
suffix:semicolon
id|pnp_device_detach
c_func
(paren
id|pd
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|card-&gt;para
(braket
l_int|1
)braket
op_assign
id|pnp_port_start
c_func
(paren
id|pd
comma
l_int|0
)paren
suffix:semicolon
id|card-&gt;para
(braket
l_int|0
)braket
op_assign
id|pnp_irq
c_func
(paren
id|pd
comma
l_int|0
)paren
suffix:semicolon
id|cs-&gt;hw.sedl.cfg_reg
op_assign
id|card-&gt;para
(braket
l_int|1
)braket
suffix:semicolon
id|cs-&gt;irq
op_assign
id|card-&gt;para
(braket
l_int|0
)braket
suffix:semicolon
r_if
c_cond
(paren
id|pdev-&gt;function
op_eq
id|ISAPNP_FUNCTION
c_func
(paren
l_int|0x2
)paren
)paren
(brace
r_if
c_cond
(paren
id|sedl_fax_probe
c_func
(paren
id|card-&gt;cs
comma
id|card
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|sedl_card_win_probe
c_func
(paren
id|card-&gt;cs
comma
id|card
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
)brace
r_else
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;Sedlbauer PnP: PnP error card found, no device&bslash;n&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
)brace
id|pdev
op_increment
suffix:semicolon
id|pnp_c
op_assign
l_int|NULL
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|pdev-&gt;card_vendor
)paren
(brace
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;Sedlbauer PnP: no ISAPnP card found&bslash;n&quot;
)paren
suffix:semicolon
)brace
)brace
macro_line|#endif
multiline_comment|/* Probe for Sedlbauer speed pci */
macro_line|#ifdef CONFIG_PCI
id|dev_sedl
op_assign
id|pci_find_device
c_func
(paren
id|PCI_VENDOR_ID_TIGERJET
comma
id|PCI_DEVICE_ID_TIGERJET_100
comma
id|dev_sedl
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dev_sedl
)paren
(brace
id|sub_vendor_id
op_assign
id|dev_sedl-&gt;subsystem_vendor
suffix:semicolon
id|sub_id
op_assign
id|dev_sedl-&gt;subsystem_device
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;Sedlbauer: PCI subvendor:%x subid %x&bslash;n&quot;
comma
id|sub_vendor_id
comma
id|sub_id
)paren
suffix:semicolon
r_if
c_cond
(paren
id|sub_id
op_ne
id|PCI_SUB_ID_SEDLBAUER
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;Sedlbauer: unknown sub id %#x&bslash;n&quot;
comma
id|sub_id
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|sub_vendor_id
op_eq
id|PCI_SUBVENDOR_SPEEDFAX_PYRAMID
)paren
(brace
r_if
c_cond
(paren
id|sedl_fax_pyramid_probe
c_func
(paren
id|cs
comma
id|dev_sedl
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|sub_vendor_id
op_eq
id|PCI_SUBVENDOR_SPEEDFAX_PCI
)paren
(brace
r_if
c_cond
(paren
id|sedl_fax_pci_probe
c_func
(paren
id|cs
comma
id|dev_sedl
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|sub_vendor_id
op_eq
id|PCI_SUBVENDOR_SEDLBAUER_PCI
)paren
(brace
r_if
c_cond
(paren
id|sedl_pci_probe
c_func
(paren
id|cs
comma
id|dev_sedl
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;Sedlbauer: unknown sub vendor id %#x&bslash;n&quot;
comma
id|sub_vendor_id
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#endif /* CONFIG_PCI */
r_return
l_int|0
suffix:semicolon
)brace
eof
