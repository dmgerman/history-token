multiline_comment|/*&n; * Driver for HSCX&n; * High-Level Serial Communcation Controller Extended&n; *&n; * Author       Kai Germaschewski&n; * Copyright    2001 by Kai Germaschewski  &lt;kai.germaschewski@gmx.de&gt;&n; *              2001 by Karsten Keil       &lt;keil@isdn4linux.de&gt;&n; * &n; * based upon Karsten Keil&squot;s original isac.c driver&n; *&n; * This software may be used and distributed according to the terms&n; * of the GNU General Public License, incorporated herein by reference.&n; */
multiline_comment|/* TODO:&n; * comments in .h&n; */
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/netdevice.h&gt;
macro_line|#include &quot;hisax_hscx.h&quot;
singleline_comment|// debugging cruft
DECL|macro|__debug_variable
mdefine_line|#define __debug_variable debug
macro_line|#include &quot;hisax_debug.h&quot;
macro_line|#ifdef CONFIG_HISAX_DEBUG
DECL|variable|debug
r_static
r_int
id|debug
op_assign
l_int|1
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|debug
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
DECL|variable|HSCXVer
r_static
r_char
op_star
id|HSCXVer
(braket
)braket
op_assign
(brace
l_string|&quot;A1&quot;
comma
l_string|&quot;?1&quot;
comma
l_string|&quot;A2&quot;
comma
l_string|&quot;?3&quot;
comma
l_string|&quot;A3&quot;
comma
l_string|&quot;V2.1&quot;
comma
l_string|&quot;?6&quot;
comma
l_string|&quot;?7&quot;
comma
l_string|&quot;?8&quot;
comma
l_string|&quot;?9&quot;
comma
l_string|&quot;?10&quot;
comma
l_string|&quot;?11&quot;
comma
l_string|&quot;?12&quot;
comma
l_string|&quot;?13&quot;
comma
l_string|&quot;?14&quot;
comma
l_string|&quot;???&quot;
)brace
suffix:semicolon
macro_line|#endif
id|MODULE_AUTHOR
c_func
(paren
l_string|&quot;Kai Germaschewski &lt;kai.germaschewski@gmx.de&gt;/Karsten Keil &lt;kkeil@suse.de&gt;&quot;
)paren
suffix:semicolon
id|MODULE_DESCRIPTION
c_func
(paren
l_string|&quot;HSCX driver&quot;
)paren
suffix:semicolon
DECL|macro|DBG_WARN
mdefine_line|#define DBG_WARN      0x0001
DECL|macro|DBG_IRQ
mdefine_line|#define DBG_IRQ       0x0002
DECL|macro|DBG_L1M
mdefine_line|#define DBG_L1M       0x0004
DECL|macro|DBG_PR
mdefine_line|#define DBG_PR        0x0008
DECL|macro|DBG_RFIFO
mdefine_line|#define DBG_RFIFO     0x0100
DECL|macro|DBG_RPACKET
mdefine_line|#define DBG_RPACKET   0x0200
DECL|macro|DBG_XFIFO
mdefine_line|#define DBG_XFIFO     0x1000
DECL|macro|DBG_XPACKET
mdefine_line|#define DBG_XPACKET   0x2000
DECL|macro|HSCX_ISTA
mdefine_line|#define HSCX_ISTA      0x20
DECL|macro|HSCX_ISTA_EXB
mdefine_line|#define HSCX_ISTA_EXB  0x01
DECL|macro|HSCX_ISTA_EXA
mdefine_line|#define HSCX_ISTA_EXA  0x02
DECL|macro|HSCX_ISTA_ICA
mdefine_line|#define HSCX_ISTA_ICA  0x04
DECL|macro|HSCX_ISTA_TIN
mdefine_line|#define HSCX_ISTA_TIN  0x08
DECL|macro|HSCX_ISTA_XPR
mdefine_line|#define HSCX_ISTA_XPR  0x10
DECL|macro|HSCX_ISTA_RSC
mdefine_line|#define HSCX_ISTA_RSC  0x20
DECL|macro|HSCX_ISTA_RPF
mdefine_line|#define HSCX_ISTA_RPF  0x40
DECL|macro|HSCX_ISTA_RME
mdefine_line|#define HSCX_ISTA_RME  0x80
DECL|macro|HSCX_CMDR
mdefine_line|#define HSCX_CMDR      0x21
DECL|macro|HSCX_CMDR_RMC
mdefine_line|#define HSCX_CMDR_RMC  0x80
DECL|macro|HSCX_CMDR_RHR
mdefine_line|#define HSCX_CMDR_RHR  0x40
DECL|macro|HSCX_CMDR_RNR
mdefine_line|#define HSCX_CMDR_RNR  0x20
DECL|macro|HSCX_CMDR_STI
mdefine_line|#define HSCX_CMDR_STI  0x10
DECL|macro|HSCX_CMDR_XTF
mdefine_line|#define HSCX_CMDR_XTF  0x08
DECL|macro|HSCX_CMDR_XIF
mdefine_line|#define HSCX_CMDR_XIF  0x04
DECL|macro|HSCX_CMDR_XME
mdefine_line|#define HSCX_CMDR_XME  0x02
DECL|macro|HSCX_CMDR_XRES
mdefine_line|#define HSCX_CMDR_XRES 0x01
DECL|macro|HSCX_EXIR
mdefine_line|#define HSCX_EXIR      0x24
DECL|macro|HSCX_EXIR_XDU
mdefine_line|#define HSCX_EXIR_XDU  0x40
DECL|macro|HSCX_RSTA
mdefine_line|#define HSCX_RSTA      0x27
DECL|macro|HSCX_RSTA_VFR
mdefine_line|#define HSCX_RSTA_VFR  0x80
DECL|macro|HSCX_RSTA_RDO
mdefine_line|#define HSCX_RSTA_RDO  0x40
DECL|macro|HSCX_RSTA_CRC
mdefine_line|#define HSCX_RSTA_CRC  0x20
DECL|macro|HSCX_RSTA_RAB
mdefine_line|#define HSCX_RSTA_RAB  0x10
DECL|macro|HSCX_CCR1
mdefine_line|#define HSCX_CCR1 0x2f
DECL|macro|HSCX_CCR2
mdefine_line|#define HSCX_CCR2 0x2c
DECL|macro|HSCX_TSAR
mdefine_line|#define HSCX_TSAR 0x31
DECL|macro|HSCX_TSAX
mdefine_line|#define HSCX_TSAX 0x30
DECL|macro|HSCX_XCCR
mdefine_line|#define HSCX_XCCR 0x32
DECL|macro|HSCX_RCCR
mdefine_line|#define HSCX_RCCR 0x33
DECL|macro|HSCX_MODE
mdefine_line|#define HSCX_MODE 0x22
DECL|macro|HSCX_XAD1
mdefine_line|#define HSCX_XAD1 0x24
DECL|macro|HSCX_XAD2
mdefine_line|#define HSCX_XAD2 0x25
DECL|macro|HSCX_RAH2
mdefine_line|#define HSCX_RAH2 0x27
DECL|macro|HSCX_TIMR
mdefine_line|#define HSCX_TIMR 0x23
DECL|macro|HSCX_STAR
mdefine_line|#define HSCX_STAR 0x21
DECL|macro|HSCX_RBCL
mdefine_line|#define HSCX_RBCL 0x25
DECL|macro|HSCX_XBCH
mdefine_line|#define HSCX_XBCH 0x2d
DECL|macro|HSCX_VSTR
mdefine_line|#define HSCX_VSTR 0x2e
DECL|macro|HSCX_RLCR
mdefine_line|#define HSCX_RLCR 0x2e
DECL|macro|HSCX_MASK
mdefine_line|#define HSCX_MASK 0x20
DECL|function|B_L1L2
r_static
r_inline
r_void
id|B_L1L2
c_func
(paren
r_struct
id|hscx
op_star
id|hscx
comma
r_int
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|hisax_if
op_star
id|ifc
op_assign
(paren
r_struct
id|hisax_if
op_star
)paren
op_amp
id|hscx-&gt;b_if
suffix:semicolon
id|DBG
c_func
(paren
l_int|0x10
comma
l_string|&quot;pr %#x&quot;
comma
id|pr
)paren
suffix:semicolon
id|ifc
op_member_access_from_pointer
id|l1l2
c_func
(paren
id|ifc
comma
id|pr
comma
id|arg
)paren
suffix:semicolon
)brace
DECL|function|hscx_version
r_static
r_void
id|hscx_version
c_func
(paren
r_struct
id|hscx
op_star
id|hscx
)paren
(brace
r_int
id|val
suffix:semicolon
id|val
op_assign
id|hscx
op_member_access_from_pointer
id|read_hscx
c_func
(paren
id|hscx
comma
id|HSCX_VSTR
)paren
op_amp
l_int|0xf
suffix:semicolon
id|DBG
c_func
(paren
l_int|1
comma
l_string|&quot;HSCX version (%x): %s&quot;
comma
id|val
comma
id|HSCXVer
(braket
id|val
)braket
)paren
suffix:semicolon
)brace
DECL|function|hscx_empty_fifo
r_static
r_void
id|hscx_empty_fifo
c_func
(paren
r_struct
id|hscx
op_star
id|hscx
comma
r_int
id|count
)paren
(brace
id|u_char
op_star
id|ptr
suffix:semicolon
id|DBG
c_func
(paren
id|DBG_IRQ
comma
l_string|&quot;count %d&quot;
comma
id|count
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|hscx-&gt;rcvidx
op_plus
id|count
)paren
op_ge
id|HSCX_BUFMAX
)paren
(brace
id|DBG
c_func
(paren
id|DBG_WARN
comma
l_string|&quot;overrun %d&quot;
comma
id|hscx-&gt;rcvidx
op_plus
id|count
)paren
suffix:semicolon
id|hscx
op_member_access_from_pointer
id|write_hscx
c_func
(paren
id|hscx
comma
id|HSCX_CMDR
comma
id|HSCX_CMDR_RMC
)paren
suffix:semicolon
id|hscx-&gt;rcvidx
op_assign
l_int|0
suffix:semicolon
r_return
suffix:semicolon
)brace
id|ptr
op_assign
id|hscx-&gt;rcvbuf
op_plus
id|hscx-&gt;rcvidx
suffix:semicolon
id|hscx-&gt;rcvidx
op_add_assign
id|count
suffix:semicolon
id|hscx
op_member_access_from_pointer
id|read_hscx_fifo
c_func
(paren
id|hscx
comma
id|ptr
comma
id|count
)paren
suffix:semicolon
id|hscx
op_member_access_from_pointer
id|write_hscx
c_func
(paren
id|hscx
comma
id|HSCX_CMDR
comma
id|HSCX_CMDR_RMC
)paren
suffix:semicolon
id|DBG_PACKET
c_func
(paren
id|DBG_RFIFO
comma
id|ptr
comma
id|count
)paren
suffix:semicolon
)brace
DECL|function|hscx_fill_fifo
r_static
r_void
id|hscx_fill_fifo
c_func
(paren
r_struct
id|hscx
op_star
id|hscx
)paren
(brace
r_int
id|count
suffix:semicolon
r_int
r_char
id|cmd
suffix:semicolon
r_int
id|fifo_size
op_assign
id|test_bit
c_func
(paren
id|HSCX_IPAC
comma
op_amp
id|hscx-&gt;flags
)paren
ques
c_cond
l_int|64
suffix:colon
l_int|32
suffix:semicolon
r_int
r_char
op_star
id|ptr
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|hscx-&gt;tx_skb
)paren
id|BUG
c_func
(paren
)paren
suffix:semicolon
id|count
op_assign
id|hscx-&gt;tx_skb-&gt;len
suffix:semicolon
r_if
c_cond
(paren
id|count
op_le
l_int|0
)paren
id|BUG
c_func
(paren
)paren
suffix:semicolon
id|DBG
c_func
(paren
id|DBG_IRQ
comma
l_string|&quot;count %d&quot;
comma
id|count
)paren
suffix:semicolon
r_if
c_cond
(paren
id|count
OG
id|fifo_size
op_logical_or
id|hscx-&gt;mode
op_eq
id|L1_MODE_TRANS
)paren
(brace
id|count
op_assign
id|fifo_size
suffix:semicolon
id|cmd
op_assign
l_int|0x8
suffix:semicolon
)brace
r_else
(brace
id|cmd
op_assign
l_int|0xa
suffix:semicolon
)brace
id|ptr
op_assign
id|hscx-&gt;tx_skb-&gt;data
suffix:semicolon
id|skb_pull
c_func
(paren
id|hscx-&gt;tx_skb
comma
id|count
)paren
suffix:semicolon
id|hscx-&gt;tx_cnt
op_add_assign
id|count
suffix:semicolon
id|DBG_PACKET
c_func
(paren
id|DBG_XFIFO
comma
id|ptr
comma
id|count
)paren
suffix:semicolon
id|hscx
op_member_access_from_pointer
id|write_hscx_fifo
c_func
(paren
id|hscx
comma
id|ptr
comma
id|count
)paren
suffix:semicolon
id|hscx
op_member_access_from_pointer
id|write_hscx
c_func
(paren
id|hscx
comma
id|HSCX_CMDR
comma
id|cmd
)paren
suffix:semicolon
)brace
DECL|function|hscx_retransmit
r_static
r_void
id|hscx_retransmit
c_func
(paren
r_struct
id|hscx
op_star
id|hscx
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|hscx-&gt;tx_skb
)paren
(brace
id|DBG
c_func
(paren
id|DBG_WARN
comma
l_string|&quot;no skb&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|skb_push
c_func
(paren
id|hscx-&gt;tx_skb
comma
id|hscx-&gt;tx_cnt
)paren
suffix:semicolon
id|hscx-&gt;tx_cnt
op_assign
l_int|0
suffix:semicolon
id|hscx
op_member_access_from_pointer
id|write_hscx
c_func
(paren
id|hscx
comma
id|HSCX_CMDR
comma
l_int|0x01
)paren
suffix:semicolon
)brace
DECL|function|hscx_rme_interrupt
r_static
r_inline
r_void
id|hscx_rme_interrupt
c_func
(paren
r_struct
id|hscx
op_star
id|hscx
)paren
(brace
r_int
r_char
id|val
suffix:semicolon
r_int
id|count
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
r_int
id|fifo_size
op_assign
id|test_bit
c_func
(paren
id|HSCX_IPAC
comma
op_amp
id|hscx-&gt;flags
)paren
ques
c_cond
l_int|64
suffix:colon
l_int|32
suffix:semicolon
id|val
op_assign
id|hscx
op_member_access_from_pointer
id|read_hscx
c_func
(paren
id|hscx
comma
id|HSCX_RSTA
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|val
op_amp
(paren
id|HSCX_RSTA_VFR
op_or
id|HSCX_RSTA_RDO
op_or
id|HSCX_RSTA_CRC
op_or
id|HSCX_RSTA_RAB
)paren
)paren
op_ne
(paren
id|HSCX_RSTA_VFR
op_or
id|HSCX_RSTA_CRC
)paren
)paren
(brace
id|DBG
c_func
(paren
id|DBG_WARN
comma
l_string|&quot;RSTA %#x, dropped&quot;
comma
id|val
)paren
suffix:semicolon
id|hscx
op_member_access_from_pointer
id|write_hscx
c_func
(paren
id|hscx
comma
id|HSCX_CMDR
comma
id|HSCX_CMDR_RMC
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|count
op_assign
id|hscx
op_member_access_from_pointer
id|read_hscx
c_func
(paren
id|hscx
comma
id|HSCX_RBCL
)paren
op_amp
(paren
id|fifo_size
op_minus
l_int|1
)paren
suffix:semicolon
id|DBG
c_func
(paren
id|DBG_IRQ
comma
l_string|&quot;RBCL %#x&quot;
comma
id|count
)paren
suffix:semicolon
r_if
c_cond
(paren
id|count
op_eq
l_int|0
)paren
id|count
op_assign
id|fifo_size
suffix:semicolon
id|hscx_empty_fifo
c_func
(paren
id|hscx
comma
id|count
)paren
suffix:semicolon
id|count
op_assign
id|hscx-&gt;rcvidx
suffix:semicolon
r_if
c_cond
(paren
id|count
OL
l_int|1
)paren
(brace
id|DBG
c_func
(paren
id|DBG_WARN
comma
l_string|&quot;count %d &lt; 1&quot;
comma
id|count
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|skb
op_assign
id|alloc_skb
c_func
(paren
id|count
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|skb
)paren
(brace
id|DBG
c_func
(paren
id|DBG_WARN
comma
l_string|&quot;no memory, dropping&bslash;n&quot;
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
id|count
)paren
comma
id|hscx-&gt;rcvbuf
comma
id|count
)paren
suffix:semicolon
id|DBG_SKB
c_func
(paren
id|DBG_RPACKET
comma
id|skb
)paren
suffix:semicolon
id|B_L1L2
c_func
(paren
id|hscx
comma
id|PH_DATA
op_or
id|INDICATION
comma
id|skb
)paren
suffix:semicolon
id|out
suffix:colon
id|hscx-&gt;rcvidx
op_assign
l_int|0
suffix:semicolon
)brace
DECL|function|hscx_xpr_interrupt
r_static
r_inline
r_void
id|hscx_xpr_interrupt
c_func
(paren
r_struct
id|hscx
op_star
id|hscx
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|skb
op_assign
id|hscx-&gt;tx_skb
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|skb
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|skb-&gt;len
OG
l_int|0
)paren
(brace
id|hscx_fill_fifo
c_func
(paren
id|hscx
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|hscx-&gt;tx_cnt
op_assign
l_int|0
suffix:semicolon
id|hscx-&gt;tx_skb
op_assign
l_int|NULL
suffix:semicolon
id|B_L1L2
c_func
(paren
id|hscx
comma
id|PH_DATA
op_or
id|CONFIRM
comma
(paren
r_void
op_star
)paren
id|skb-&gt;truesize
)paren
suffix:semicolon
id|dev_kfree_skb_irq
c_func
(paren
id|skb
)paren
suffix:semicolon
)brace
DECL|function|hscx_exi_interrupt
r_static
r_inline
r_void
id|hscx_exi_interrupt
c_func
(paren
r_struct
id|hscx
op_star
id|hscx
)paren
(brace
r_int
r_char
id|val
suffix:semicolon
id|val
op_assign
id|hscx
op_member_access_from_pointer
id|read_hscx
c_func
(paren
id|hscx
comma
id|HSCX_EXIR
)paren
suffix:semicolon
id|DBG
c_func
(paren
l_int|2
comma
l_string|&quot;EXIR %#x&quot;
comma
id|val
)paren
suffix:semicolon
r_if
c_cond
(paren
id|val
op_amp
id|HSCX_EXIR_XDU
)paren
(brace
id|DBG
c_func
(paren
id|DBG_WARN
comma
l_string|&quot;HSCX XDU&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hscx-&gt;mode
op_eq
id|L1_MODE_TRANS
)paren
(brace
id|hscx_fill_fifo
c_func
(paren
id|hscx
)paren
suffix:semicolon
)brace
r_else
(brace
id|hscx_retransmit
c_func
(paren
id|hscx
)paren
suffix:semicolon
)brace
)brace
)brace
DECL|function|hscx_reg_interrupt
r_static
r_void
id|hscx_reg_interrupt
c_func
(paren
r_struct
id|hscx
op_star
id|hscx
comma
r_int
r_char
id|val
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
r_if
c_cond
(paren
id|val
op_amp
id|HSCX_ISTA_XPR
)paren
(brace
id|DBG
c_func
(paren
id|DBG_IRQ
comma
l_string|&quot;XPR&quot;
)paren
suffix:semicolon
id|hscx_xpr_interrupt
c_func
(paren
id|hscx
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|val
op_amp
id|HSCX_ISTA_RME
)paren
(brace
id|DBG
c_func
(paren
id|DBG_IRQ
comma
l_string|&quot;RME&quot;
)paren
suffix:semicolon
id|hscx_rme_interrupt
c_func
(paren
id|hscx
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|val
op_amp
id|HSCX_ISTA_RPF
)paren
(brace
r_int
id|fifo_size
op_assign
id|test_bit
c_func
(paren
id|HSCX_IPAC
comma
op_amp
id|hscx-&gt;flags
)paren
ques
c_cond
l_int|64
suffix:colon
l_int|32
suffix:semicolon
id|DBG
c_func
(paren
id|DBG_IRQ
comma
l_string|&quot;RPF&quot;
)paren
suffix:semicolon
id|hscx_empty_fifo
c_func
(paren
id|hscx
comma
id|fifo_size
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hscx-&gt;mode
op_eq
id|L1_MODE_TRANS
)paren
(brace
id|skb
op_assign
id|dev_alloc_skb
c_func
(paren
id|fifo_size
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|skb
)paren
(brace
id|DBG
c_func
(paren
id|DBG_WARN
comma
l_string|&quot;no memory, dropping&bslash;n&quot;
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
id|fifo_size
)paren
comma
id|hscx-&gt;rcvbuf
comma
id|fifo_size
)paren
suffix:semicolon
id|DBG_SKB
c_func
(paren
id|DBG_RPACKET
comma
id|skb
)paren
suffix:semicolon
id|B_L1L2
c_func
(paren
id|hscx
comma
id|PH_DATA
op_or
id|INDICATION
comma
id|skb
)paren
suffix:semicolon
id|out
suffix:colon
id|hscx-&gt;rcvidx
op_assign
l_int|0
suffix:semicolon
)brace
)brace
)brace
DECL|function|hscx_irq
r_void
id|hscx_irq
c_func
(paren
r_struct
id|hscx
op_star
id|hscx_a
)paren
(brace
r_struct
id|hscx
op_star
id|hscx_b
op_assign
id|hscx_a
op_plus
l_int|1
suffix:semicolon
r_int
r_char
id|val
suffix:semicolon
id|val
op_assign
id|hscx_b
op_member_access_from_pointer
id|read_hscx
c_func
(paren
id|hscx_b
comma
id|HSCX_ISTA
)paren
suffix:semicolon
id|DBG
c_func
(paren
id|DBG_IRQ
comma
l_string|&quot;ISTA B %#x&quot;
comma
id|val
)paren
suffix:semicolon
r_if
c_cond
(paren
id|val
op_amp
id|HSCX_ISTA_EXB
)paren
(brace
id|DBG
c_func
(paren
id|DBG_IRQ
comma
l_string|&quot;EXI B&quot;
)paren
suffix:semicolon
id|hscx_exi_interrupt
c_func
(paren
id|hscx_b
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|val
op_amp
id|HSCX_ISTA_EXA
)paren
(brace
id|DBG
c_func
(paren
id|DBG_IRQ
comma
l_string|&quot;EXI A&quot;
)paren
suffix:semicolon
id|hscx_exi_interrupt
c_func
(paren
id|hscx_a
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|val
op_amp
l_int|0xf8
)paren
(brace
id|hscx_reg_interrupt
c_func
(paren
id|hscx_b
comma
id|val
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|val
op_amp
id|HSCX_ISTA_ICA
)paren
(brace
id|val
op_assign
id|hscx_a
op_member_access_from_pointer
id|read_hscx
c_func
(paren
id|hscx_a
comma
id|HSCX_ISTA
)paren
suffix:semicolon
id|DBG
c_func
(paren
id|DBG_IRQ
comma
l_string|&quot;ISTA A %#x&quot;
comma
id|val
)paren
suffix:semicolon
id|hscx_reg_interrupt
c_func
(paren
id|hscx_a
comma
id|val
)paren
suffix:semicolon
id|hscx_a
op_member_access_from_pointer
id|write_hscx
c_func
(paren
id|hscx_a
comma
id|HSCX_MASK
comma
l_int|0xff
)paren
suffix:semicolon
id|hscx_a
op_member_access_from_pointer
id|write_hscx
c_func
(paren
id|hscx_a
comma
id|HSCX_MASK
comma
l_int|0x00
)paren
suffix:semicolon
)brace
id|hscx_b
op_member_access_from_pointer
id|write_hscx
c_func
(paren
id|hscx_b
comma
id|HSCX_MASK
comma
l_int|0xff
)paren
suffix:semicolon
id|hscx_b
op_member_access_from_pointer
id|write_hscx
c_func
(paren
id|hscx_b
comma
id|HSCX_MASK
comma
l_int|0x00
)paren
suffix:semicolon
)brace
DECL|function|modehscx
r_static
r_void
id|modehscx
c_func
(paren
r_struct
id|hscx
op_star
id|hscx
comma
r_int
id|mode
)paren
(brace
r_int
id|bc
op_assign
id|hscx-&gt;channel
suffix:semicolon
id|DBG
c_func
(paren
l_int|0x40
comma
l_string|&quot;hscx %c mode %d --&gt; %d&quot;
comma
l_char|&squot;A&squot;
op_plus
id|hscx-&gt;channel
comma
id|hscx-&gt;mode
comma
id|mode
)paren
suffix:semicolon
id|hscx-&gt;mode
op_assign
id|mode
suffix:semicolon
id|hscx
op_member_access_from_pointer
id|write_hscx
c_func
(paren
id|hscx
comma
id|HSCX_XAD1
comma
l_int|0xFF
)paren
suffix:semicolon
id|hscx
op_member_access_from_pointer
id|write_hscx
c_func
(paren
id|hscx
comma
id|HSCX_XAD2
comma
l_int|0xFF
)paren
suffix:semicolon
id|hscx
op_member_access_from_pointer
id|write_hscx
c_func
(paren
id|hscx
comma
id|HSCX_RAH2
comma
l_int|0xFF
)paren
suffix:semicolon
id|hscx
op_member_access_from_pointer
id|write_hscx
c_func
(paren
id|hscx
comma
id|HSCX_XBCH
comma
l_int|0x0
)paren
suffix:semicolon
id|hscx
op_member_access_from_pointer
id|write_hscx
c_func
(paren
id|hscx
comma
id|HSCX_RLCR
comma
l_int|0x0
)paren
suffix:semicolon
id|hscx
op_member_access_from_pointer
id|write_hscx
c_func
(paren
id|hscx
comma
id|HSCX_CCR1
comma
id|test_bit
c_func
(paren
id|HSCX_IPAC
comma
op_amp
id|hscx-&gt;flags
)paren
ques
c_cond
l_int|0x82
suffix:colon
l_int|0x85
)paren
suffix:semicolon
id|hscx
op_member_access_from_pointer
id|write_hscx
c_func
(paren
id|hscx
comma
id|HSCX_CCR2
comma
l_int|0x30
)paren
suffix:semicolon
id|hscx
op_member_access_from_pointer
id|write_hscx
c_func
(paren
id|hscx
comma
id|HSCX_XCCR
comma
l_int|7
)paren
suffix:semicolon
id|hscx
op_member_access_from_pointer
id|write_hscx
c_func
(paren
id|hscx
comma
id|HSCX_RCCR
comma
l_int|7
)paren
suffix:semicolon
multiline_comment|/* Switch IOM 1 SSI */
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|HSCX_IOM1
comma
op_amp
id|hscx-&gt;flags
)paren
)paren
id|bc
op_assign
l_int|1
suffix:semicolon
id|hscx
op_member_access_from_pointer
id|write_hscx
c_func
(paren
id|hscx
comma
id|HSCX_TSAX
comma
id|hscx-&gt;tsaxr
)paren
suffix:semicolon
id|hscx
op_member_access_from_pointer
id|write_hscx
c_func
(paren
id|hscx
comma
id|HSCX_TSAR
comma
id|hscx-&gt;tsaxr
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|mode
)paren
(brace
r_case
(paren
id|L1_MODE_NULL
)paren
suffix:colon
id|hscx
op_member_access_from_pointer
id|write_hscx
c_func
(paren
id|hscx
comma
id|HSCX_TSAX
comma
l_int|0x1f
)paren
suffix:semicolon
id|hscx
op_member_access_from_pointer
id|write_hscx
c_func
(paren
id|hscx
comma
id|HSCX_TSAR
comma
l_int|0x1f
)paren
suffix:semicolon
id|hscx
op_member_access_from_pointer
id|write_hscx
c_func
(paren
id|hscx
comma
id|HSCX_MODE
comma
l_int|0x84
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|L1_MODE_TRANS
)paren
suffix:colon
id|hscx
op_member_access_from_pointer
id|write_hscx
c_func
(paren
id|hscx
comma
id|HSCX_MODE
comma
l_int|0xe4
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|L1_MODE_HDLC
)paren
suffix:colon
id|hscx
op_member_access_from_pointer
id|write_hscx
c_func
(paren
id|hscx
comma
id|HSCX_CCR1
comma
id|test_bit
c_func
(paren
id|HSCX_IPAC
comma
op_amp
id|hscx-&gt;flags
)paren
ques
c_cond
l_int|0x8a
suffix:colon
l_int|0x8d
)paren
suffix:semicolon
id|hscx
op_member_access_from_pointer
id|write_hscx
c_func
(paren
id|hscx
comma
id|HSCX_MODE
comma
l_int|0x8c
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|mode
)paren
id|hscx
op_member_access_from_pointer
id|write_hscx
c_func
(paren
id|hscx
comma
id|HSCX_CMDR
comma
l_int|0x41
)paren
suffix:semicolon
id|hscx
op_member_access_from_pointer
id|write_hscx
c_func
(paren
id|hscx
comma
id|HSCX_ISTA
comma
l_int|0x00
)paren
suffix:semicolon
)brace
DECL|function|hscx_init
r_void
id|hscx_init
c_func
(paren
r_struct
id|hscx
op_star
id|hscx
)paren
(brace
r_if
c_cond
(paren
id|hscx-&gt;channel
)paren
id|hscx-&gt;tsaxr
op_assign
l_int|0x03
suffix:semicolon
r_else
id|hscx-&gt;tsaxr
op_assign
l_int|0x2f
suffix:semicolon
)brace
DECL|function|hscx_setup
r_void
id|hscx_setup
c_func
(paren
r_struct
id|hscx
op_star
id|hscx
)paren
(brace
id|hscx_version
c_func
(paren
id|hscx
)paren
suffix:semicolon
id|hscx-&gt;mode
op_assign
op_minus
l_int|1
suffix:semicolon
id|modehscx
c_func
(paren
id|hscx
comma
id|L1_MODE_NULL
)paren
suffix:semicolon
)brace
DECL|function|hscx_b_l2l1
r_void
id|hscx_b_l2l1
c_func
(paren
r_struct
id|hisax_if
op_star
id|ifc
comma
r_int
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|hscx
op_star
id|hscx
op_assign
id|ifc-&gt;priv
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_int
id|mode
suffix:semicolon
id|DBG
c_func
(paren
l_int|0x10
comma
l_string|&quot;pr %#x&quot;
comma
id|pr
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|pr
)paren
(brace
r_case
id|PH_DATA
op_or
id|REQUEST
suffix:colon
r_if
c_cond
(paren
id|hscx-&gt;tx_skb
)paren
id|BUG
c_func
(paren
)paren
suffix:semicolon
id|hscx-&gt;tx_skb
op_assign
id|skb
suffix:semicolon
id|DBG_SKB
c_func
(paren
l_int|1
comma
id|skb
)paren
suffix:semicolon
id|hscx_fill_fifo
c_func
(paren
id|hscx
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|PH_ACTIVATE
op_or
id|REQUEST
suffix:colon
id|mode
op_assign
(paren
r_int
)paren
id|arg
suffix:semicolon
id|DBG
c_func
(paren
l_int|4
comma
l_string|&quot;B%d,PH_ACTIVATE_REQUEST %d&quot;
comma
id|hscx-&gt;channel
op_plus
l_int|1
comma
id|mode
)paren
suffix:semicolon
id|modehscx
c_func
(paren
id|hscx
comma
id|mode
)paren
suffix:semicolon
id|B_L1L2
c_func
(paren
id|hscx
comma
id|PH_ACTIVATE
op_or
id|INDICATION
comma
l_int|NULL
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|PH_DEACTIVATE
op_or
id|REQUEST
suffix:colon
id|DBG
c_func
(paren
l_int|4
comma
l_string|&quot;B%d,PH_DEACTIVATE_REQUEST&quot;
comma
id|hscx-&gt;channel
op_plus
l_int|1
)paren
suffix:semicolon
id|modehscx
c_func
(paren
id|hscx
comma
id|L1_MODE_NULL
)paren
suffix:semicolon
id|B_L1L2
c_func
(paren
id|hscx
comma
id|PH_DEACTIVATE
op_or
id|INDICATION
comma
l_int|NULL
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
DECL|function|hisax_hscx_init
r_static
r_int
id|__init
id|hisax_hscx_init
c_func
(paren
r_void
)paren
(brace
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;hisax_hscx: HSCX ISDN driver v0.1.0&bslash;n&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|hisax_hscx_exit
r_static
r_void
id|__exit
id|hisax_hscx_exit
c_func
(paren
r_void
)paren
(brace
)brace
DECL|variable|hscx_init
id|EXPORT_SYMBOL
c_func
(paren
id|hscx_init
)paren
suffix:semicolon
DECL|variable|hscx_b_l2l1
id|EXPORT_SYMBOL
c_func
(paren
id|hscx_b_l2l1
)paren
suffix:semicolon
DECL|variable|hscx_setup
id|EXPORT_SYMBOL
c_func
(paren
id|hscx_setup
)paren
suffix:semicolon
DECL|variable|hscx_irq
id|EXPORT_SYMBOL
c_func
(paren
id|hscx_irq
)paren
suffix:semicolon
DECL|variable|hisax_hscx_init
id|module_init
c_func
(paren
id|hisax_hscx_init
)paren
suffix:semicolon
DECL|variable|hisax_hscx_exit
id|module_exit
c_func
(paren
id|hisax_hscx_exit
)paren
suffix:semicolon
eof
