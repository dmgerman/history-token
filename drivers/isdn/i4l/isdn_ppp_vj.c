macro_line|#include &quot;isdn_ppp_vj.h&quot;
macro_line|#include &quot;isdn_common.h&quot;
macro_line|#include &quot;isdn_net.h&quot;
macro_line|#include &quot;isdn_ppp.h&quot;
multiline_comment|/* ====================================================================== */
multiline_comment|/* VJ header compression                                                  */
multiline_comment|/* ====================================================================== */
r_struct
id|slcompress
op_star
DECL|function|ippp_vj_alloc
id|ippp_vj_alloc
c_func
(paren
r_void
)paren
(brace
r_return
id|slhc_init
c_func
(paren
l_int|16
comma
l_int|16
)paren
suffix:semicolon
)brace
r_void
DECL|function|ippp_vj_free
id|ippp_vj_free
c_func
(paren
r_struct
id|slcompress
op_star
id|slcomp
)paren
(brace
id|slhc_free
c_func
(paren
id|slcomp
)paren
suffix:semicolon
)brace
r_int
DECL|function|ippp_vj_set_maxcid
id|ippp_vj_set_maxcid
c_func
(paren
id|isdn_net_dev
op_star
id|idev
comma
r_int
id|val
)paren
(brace
r_struct
id|slcompress
op_star
id|sltmp
suffix:semicolon
id|sltmp
op_assign
id|slhc_init
c_func
(paren
l_int|16
comma
id|val
op_plus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|sltmp
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
r_if
c_cond
(paren
id|idev-&gt;mlp-&gt;slcomp
)paren
id|slhc_free
c_func
(paren
id|idev-&gt;mlp-&gt;slcomp
)paren
suffix:semicolon
id|idev-&gt;mlp-&gt;slcomp
op_assign
id|sltmp
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_struct
id|sk_buff
op_star
DECL|function|ippp_vj_decompress
id|ippp_vj_decompress
c_func
(paren
r_struct
id|slcompress
op_star
id|slcomp
comma
r_struct
id|sk_buff
op_star
id|skb_old
comma
id|u16
id|proto
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
r_int
id|len
suffix:semicolon
r_switch
c_cond
(paren
id|proto
)paren
(brace
r_case
id|PPP_VJC_UNCOMP
suffix:colon
r_if
c_cond
(paren
id|slhc_remember
c_func
(paren
id|slcomp
comma
id|skb_old-&gt;data
comma
id|skb_old-&gt;len
)paren
op_le
l_int|0
)paren
r_goto
id|drop
suffix:semicolon
id|skb
op_assign
id|skb_old
suffix:semicolon
r_break
suffix:semicolon
r_case
id|PPP_VJC_COMP
suffix:colon
id|skb
op_assign
id|dev_alloc_skb
c_func
(paren
id|skb_old-&gt;len
op_plus
l_int|128
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|skb
)paren
r_goto
id|drop
suffix:semicolon
id|memcpy
c_func
(paren
id|skb-&gt;data
comma
id|skb_old-&gt;data
comma
id|skb_old-&gt;len
)paren
suffix:semicolon
id|len
op_assign
id|slhc_uncompress
c_func
(paren
id|slcomp
comma
id|skb-&gt;data
comma
id|skb_old-&gt;len
)paren
suffix:semicolon
r_if
c_cond
(paren
id|len
OL
l_int|0
)paren
r_goto
id|drop_both
suffix:semicolon
id|skb_put
c_func
(paren
id|skb
comma
id|len
)paren
suffix:semicolon
id|kfree_skb
c_func
(paren
id|skb_old
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|isdn_BUG
c_func
(paren
)paren
suffix:semicolon
r_goto
id|drop
suffix:semicolon
)brace
id|skb-&gt;protocol
op_assign
id|htons
c_func
(paren
id|ETH_P_IP
)paren
suffix:semicolon
r_return
id|skb
suffix:semicolon
id|drop_both
suffix:colon
id|kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
id|drop
suffix:colon
id|kfree_skb
c_func
(paren
id|skb_old
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
r_struct
id|sk_buff
op_star
DECL|function|ippp_vj_compress
id|ippp_vj_compress
c_func
(paren
id|isdn_net_dev
op_star
id|idev
comma
r_struct
id|sk_buff
op_star
id|skb_old
comma
id|u16
op_star
id|proto
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
r_int
r_char
op_star
id|buf
suffix:semicolon
r_int
id|len
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|idev-&gt;pppcfg
op_amp
id|SC_COMP_TCP
)paren
op_logical_or
op_star
id|proto
op_ne
id|PPP_IP
)paren
r_return
id|skb_old
suffix:semicolon
id|skb
op_assign
id|isdn_ppp_dev_alloc_skb
c_func
(paren
id|idev
comma
id|skb_old-&gt;len
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|skb
)paren
r_return
id|skb_old
suffix:semicolon
id|skb_put
c_func
(paren
id|skb
comma
id|skb_old-&gt;len
)paren
suffix:semicolon
id|buf
op_assign
id|skb_old-&gt;data
suffix:semicolon
id|len
op_assign
id|slhc_compress
c_func
(paren
id|idev-&gt;mlp-&gt;slcomp
comma
id|skb_old-&gt;data
comma
id|skb_old-&gt;len
comma
id|skb-&gt;data
comma
op_amp
id|buf
comma
op_logical_neg
(paren
id|idev-&gt;pppcfg
op_amp
id|SC_NO_TCP_CCID
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|buf
op_eq
id|skb_old-&gt;data
)paren
(brace
id|kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
id|skb
op_assign
id|skb_old
suffix:semicolon
)brace
r_else
(brace
id|kfree_skb
c_func
(paren
id|skb_old
)paren
suffix:semicolon
)brace
id|skb_trim
c_func
(paren
id|skb
comma
id|len
)paren
suffix:semicolon
multiline_comment|/* cslip style -&gt; PPP */
r_if
c_cond
(paren
(paren
id|skb-&gt;data
(braket
l_int|0
)braket
op_amp
id|SL_TYPE_COMPRESSED_TCP
)paren
op_eq
id|SL_TYPE_COMPRESSED_TCP
)paren
(brace
id|skb-&gt;data
(braket
l_int|0
)braket
op_and_assign
op_complement
id|SL_TYPE_COMPRESSED_TCP
suffix:semicolon
op_star
id|proto
op_assign
id|PPP_VJC_COMP
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
(paren
id|skb-&gt;data
(braket
l_int|0
)braket
op_amp
id|SL_TYPE_UNCOMPRESSED_TCP
)paren
op_eq
id|SL_TYPE_UNCOMPRESSED_TCP
)paren
(brace
id|skb-&gt;data
(braket
l_int|0
)braket
op_and_assign
op_complement
id|SL_TYPE_UNCOMPRESSED_TCP
suffix:semicolon
id|skb-&gt;data
(braket
l_int|0
)braket
op_or_assign
id|SL_TYPE_IP
suffix:semicolon
op_star
id|proto
op_assign
id|PPP_VJC_UNCOMP
suffix:semicolon
)brace
r_return
id|skb
suffix:semicolon
)brace
eof
