multiline_comment|/* Linux ISDN subsystem, PPP CCP support&n; *&n; * Copyright 1994-1998  by Fritz Elfert (fritz@isdn4linux.de)&n; *           1995,96    by Thinking Objects Software GmbH Wuerzburg&n; *           1995,96    by Michael Hipp (Michael.Hipp@student.uni-tuebingen.de)&n; *           1999-2002  by Kai Germaschewski &lt;kai@germaschewski.name&gt;&n; *&n; * This software may be used and distributed according to the terms&n; * of the GNU General Public License, incorporated herein by reference.&n; */
macro_line|#include &quot;isdn_ppp_mp.h&quot;
macro_line|#include &quot;isdn_ppp_ccp.h&quot;
macro_line|#include &quot;isdn_common.h&quot;
macro_line|#include &quot;isdn_net_lib.h&quot;
macro_line|#include &quot;isdn_ppp.h&quot;
multiline_comment|/* ====================================================================== */
DECL|macro|MP_END_FRAG
mdefine_line|#define MP_END_FRAG             0x40
DECL|macro|MP_BEGIN_FRAG
mdefine_line|#define MP_BEGIN_FRAG           0x80
DECL|macro|MP_MAX_QUEUE_LEN
mdefine_line|#define MP_MAX_QUEUE_LEN&t;16
multiline_comment|/* ====================================================================== */
r_int
DECL|function|ippp_mp_bind
id|ippp_mp_bind
c_func
(paren
id|isdn_net_dev
op_star
id|idev
)paren
(brace
r_struct
id|ind_ppp
op_star
id|ind_ppp
op_assign
id|idev-&gt;ind_priv
suffix:semicolon
r_struct
id|inl_ppp
op_star
id|inl_ppp
op_assign
id|idev-&gt;mlp-&gt;inl_priv
suffix:semicolon
multiline_comment|/* seq no last seen, maybe set to bundle min, when joining? */
id|ind_ppp-&gt;mp_rxseq
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|list_empty
c_func
(paren
op_amp
id|idev-&gt;mlp-&gt;online
)paren
)paren
r_return
l_int|0
suffix:semicolon
multiline_comment|/* first channel for this link, do some setup */
id|inl_ppp-&gt;mp_cfg
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* MPPP configuration */
id|inl_ppp-&gt;mp_txseq
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* MPPP tx sequence number */
id|inl_ppp-&gt;mp_rxseq
op_assign
(paren
id|u32
)paren
op_minus
l_int|1
suffix:semicolon
id|skb_queue_head_init
c_func
(paren
op_amp
id|inl_ppp-&gt;mp_frags
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_int
DECL|function|ippp_mp_bundle
id|ippp_mp_bundle
c_func
(paren
id|isdn_net_dev
op_star
id|idev
comma
r_int
id|unit
)paren
(brace
id|isdn_net_local
op_star
id|lp
op_assign
id|idev-&gt;mlp
suffix:semicolon
r_char
id|ifn
(braket
id|IFNAMSIZ
op_plus
l_int|1
)braket
suffix:semicolon
id|isdn_net_dev
op_star
id|n_idev
suffix:semicolon
r_struct
id|ind_ppp
op_star
id|ind_ppp
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;%s: %s: slave unit: %d&bslash;n&quot;
comma
id|__FUNCTION__
comma
id|idev-&gt;name
comma
id|unit
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|ifn
comma
l_string|&quot;ippp%d&quot;
comma
id|unit
)paren
suffix:semicolon
id|list_for_each_entry
c_func
(paren
id|n_idev
comma
op_amp
id|lp-&gt;slaves
comma
id|slaves
)paren
(brace
r_if
c_cond
(paren
id|strcmp
c_func
(paren
id|n_idev-&gt;name
comma
id|ifn
)paren
op_eq
l_int|0
)paren
r_goto
id|found
suffix:semicolon
)brace
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;%s: cannot find %s&bslash;n&quot;
comma
id|__FUNCTION__
comma
id|ifn
)paren
suffix:semicolon
r_return
op_minus
id|ENODEV
suffix:semicolon
id|found
suffix:colon
id|ind_ppp
op_assign
id|n_idev-&gt;ind_priv
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ind_ppp-&gt;ipppd
)paren
(brace
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;%s: no ipppd?&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_return
op_minus
id|ENXIO
suffix:semicolon
)brace
id|ind_ppp-&gt;pppcfg
op_or_assign
id|SC_ENABLE_IP
suffix:semicolon
id|isdn_net_online
c_func
(paren
id|n_idev
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_void
DECL|function|ippp_mp_disconnected
id|ippp_mp_disconnected
c_func
(paren
id|isdn_net_dev
op_star
id|idev
)paren
(brace
r_struct
id|inl_ppp
op_star
id|inl_ppp
op_assign
id|idev-&gt;mlp-&gt;inl_priv
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|list_empty
c_func
(paren
op_amp
id|idev-&gt;mlp-&gt;online
)paren
)paren
r_return
suffix:semicolon
multiline_comment|/* we&squot;re the last link going down */
id|skb_queue_purge
c_func
(paren
op_amp
id|inl_ppp-&gt;mp_frags
)paren
suffix:semicolon
)brace
r_void
DECL|function|ippp_mp_xmit
id|ippp_mp_xmit
c_func
(paren
id|isdn_net_dev
op_star
id|idev
comma
r_struct
id|sk_buff
op_star
id|skb
)paren
(brace
r_struct
id|ind_ppp
op_star
id|ind_ppp
op_assign
id|idev-&gt;ind_priv
suffix:semicolon
r_struct
id|inl_ppp
op_star
id|inl_ppp
op_assign
id|idev-&gt;mlp-&gt;inl_priv
suffix:semicolon
r_int
r_char
op_star
id|p
suffix:semicolon
id|u32
id|txseq
suffix:semicolon
id|u16
id|proto
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|inl_ppp-&gt;mp_cfg
op_amp
id|SC_MP_PROT
)paren
)paren
(brace
r_return
id|ippp_xmit
c_func
(paren
id|idev
comma
id|skb
)paren
suffix:semicolon
)brace
multiline_comment|/* we could do something smarter than just sending&n;&t; * the complete packet as fragment... */
id|txseq
op_assign
id|inl_ppp-&gt;mp_txseq
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|inl_ppp-&gt;mp_cfg
op_amp
id|SC_OUT_SHORT_SEQ
)paren
(brace
multiline_comment|/* sequence number: 12bit */
id|p
op_assign
id|skb_push
c_func
(paren
id|skb
comma
l_int|2
)paren
suffix:semicolon
id|p
(braket
l_int|0
)braket
op_assign
id|MP_BEGIN_FRAG
op_or
id|MP_END_FRAG
op_or
(paren
(paren
id|txseq
op_rshift
l_int|8
)paren
op_amp
l_int|0xf
)paren
suffix:semicolon
id|p
(braket
l_int|1
)braket
op_assign
id|txseq
op_amp
l_int|0xff
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* sequence number: 24bit */
id|p
op_assign
id|skb_push
c_func
(paren
id|skb
comma
l_int|4
)paren
suffix:semicolon
id|p
(braket
l_int|0
)braket
op_assign
id|MP_BEGIN_FRAG
op_or
id|MP_END_FRAG
suffix:semicolon
id|p
(braket
l_int|1
)braket
op_assign
(paren
id|txseq
op_rshift
l_int|16
)paren
op_amp
l_int|0xff
suffix:semicolon
id|p
(braket
l_int|2
)braket
op_assign
(paren
id|txseq
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
suffix:semicolon
id|p
(braket
l_int|3
)braket
op_assign
(paren
id|txseq
op_rshift
l_int|0
)paren
op_amp
l_int|0xff
suffix:semicolon
)brace
id|proto
op_assign
id|PPP_MP
suffix:semicolon
id|skb
op_assign
id|ippp_ccp_compress
c_func
(paren
id|ind_ppp-&gt;ccp
comma
id|skb
comma
op_amp
id|proto
)paren
suffix:semicolon
id|ippp_push_proto
c_func
(paren
id|ind_ppp
comma
id|skb
comma
id|proto
)paren
suffix:semicolon
id|ippp_xmit
c_func
(paren
id|idev
comma
id|skb
)paren
suffix:semicolon
)brace
r_static
r_void
id|mp_receive
c_func
(paren
id|isdn_net_dev
op_star
id|idev
comma
r_struct
id|sk_buff
op_star
id|skb
)paren
suffix:semicolon
r_void
DECL|function|ippp_mp_receive
id|ippp_mp_receive
c_func
(paren
id|isdn_net_dev
op_star
id|idev
comma
r_struct
id|sk_buff
op_star
id|skb
comma
id|u16
id|proto
)paren
(brace
r_struct
id|ind_ppp
op_star
id|ind_ppp
op_assign
id|idev-&gt;ind_priv
suffix:semicolon
r_struct
id|inl_ppp
op_star
id|inl_ppp
op_assign
id|idev-&gt;mlp-&gt;inl_priv
suffix:semicolon
r_if
c_cond
(paren
id|inl_ppp-&gt;mp_cfg
op_amp
id|SC_REJ_MP_PROT
)paren
r_goto
id|out
suffix:semicolon
id|skb
op_assign
id|ippp_ccp_decompress
c_func
(paren
id|ind_ppp-&gt;ccp
comma
id|skb
comma
op_amp
id|proto
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|skb
)paren
r_goto
id|drop
suffix:semicolon
r_if
c_cond
(paren
id|proto
op_eq
id|PPP_MP
)paren
r_return
id|mp_receive
c_func
(paren
id|idev
comma
id|skb
)paren
suffix:semicolon
id|out
suffix:colon
r_return
id|ippp_receive
c_func
(paren
id|idev
comma
id|skb
comma
id|proto
)paren
suffix:semicolon
id|drop
suffix:colon
id|idev-&gt;mlp-&gt;stats.rx_errors
op_increment
suffix:semicolon
id|kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
)brace
DECL|macro|MP_LONGSEQ_MASK
mdefine_line|#define MP_LONGSEQ_MASK&t;&t;0x00ffffff
DECL|macro|MP_SHORTSEQ_MASK
mdefine_line|#define MP_SHORTSEQ_MASK&t;0x00000fff
DECL|macro|MP_LONGSEQ_MAX
mdefine_line|#define MP_LONGSEQ_MAX&t;&t;MP_LONGSEQ_MASK
DECL|macro|MP_SHORTSEQ_MAX
mdefine_line|#define MP_SHORTSEQ_MAX&t;&t;MP_SHORTSEQ_MASK
DECL|macro|MP_LONGSEQ_MAXBIT
mdefine_line|#define MP_LONGSEQ_MAXBIT&t;((MP_LONGSEQ_MASK+1)&gt;&gt;1)
DECL|macro|MP_SHORTSEQ_MAXBIT
mdefine_line|#define MP_SHORTSEQ_MAXBIT&t;((MP_SHORTSEQ_MASK+1)&gt;&gt;1)
multiline_comment|/* sequence-wrap safe comparisions (for long sequence)*/
DECL|macro|MP_LT
mdefine_line|#define MP_LT(a,b)&t;((a-b)&amp;MP_LONGSEQ_MAXBIT)
DECL|macro|MP_LE
mdefine_line|#define MP_LE(a,b) &t;!((b-a)&amp;MP_LONGSEQ_MAXBIT)
DECL|macro|MP_GT
mdefine_line|#define MP_GT(a,b) &t;((b-a)&amp;MP_LONGSEQ_MAXBIT)
DECL|macro|MP_GE
mdefine_line|#define MP_GE(a,b)&t;!((a-b)&amp;MP_LONGSEQ_MAXBIT)
DECL|macro|MP_SEQUENCE
mdefine_line|#define MP_SEQUENCE(skb) (skb)-&gt;priority
DECL|macro|MP_FLAGS
mdefine_line|#define MP_FLAGS(skb)    (skb)-&gt;cb[0]
r_static
id|u32
DECL|function|get_seq
id|get_seq
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
id|u32
id|last_seq
comma
r_int
id|short_seq
)paren
(brace
id|u32
id|seq
suffix:semicolon
id|u16
id|shseq
suffix:semicolon
id|u8
id|flags
suffix:semicolon
r_int
id|delta
suffix:semicolon
id|get_u8
c_func
(paren
id|skb-&gt;data
comma
op_amp
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|short_seq
)paren
(brace
multiline_comment|/* convert 12-bit short seq number to 24-bit long one */
id|get_u16
c_func
(paren
id|skb-&gt;data
comma
op_amp
id|shseq
)paren
suffix:semicolon
id|delta
op_assign
(paren
id|shseq
op_amp
id|MP_SHORTSEQ_MASK
)paren
op_minus
(paren
id|last_seq
op_amp
id|MP_SHORTSEQ_MASK
)paren
suffix:semicolon
multiline_comment|/* check for seqence wrap */
r_if
c_cond
(paren
id|delta
OL
l_int|0
)paren
id|delta
op_add_assign
id|MP_SHORTSEQ_MAX
op_plus
l_int|1
suffix:semicolon
id|seq
op_assign
id|last_seq
op_plus
id|delta
suffix:semicolon
id|skb_pull
c_func
(paren
id|skb
comma
l_int|2
)paren
suffix:semicolon
)brace
r_else
(brace
id|get_u32
c_func
(paren
id|skb-&gt;data
comma
op_amp
id|seq
)paren
suffix:semicolon
id|skb_pull
c_func
(paren
id|skb
comma
l_int|4
)paren
suffix:semicolon
)brace
id|seq
op_and_assign
id|MP_LONGSEQ_MASK
suffix:semicolon
id|MP_SEQUENCE
c_func
(paren
id|skb
)paren
op_assign
id|seq
suffix:semicolon
id|MP_FLAGS
c_func
(paren
id|skb
)paren
op_assign
id|flags
suffix:semicolon
r_return
id|seq
suffix:semicolon
)brace
r_static
r_int
DECL|function|mp_insert_frag
id|mp_insert_frag
c_func
(paren
r_struct
id|sk_buff_head
op_star
id|frags
comma
r_struct
id|sk_buff
op_star
id|skb
)paren
(brace
r_struct
id|sk_buff
op_star
id|p
suffix:semicolon
multiline_comment|/* If our queue of not yet reassembled fragments grows too&n;&t;   large, throw away the oldest fragment */
r_if
c_cond
(paren
id|skb_queue_len
c_func
(paren
id|frags
)paren
OG
id|MP_MAX_QUEUE_LEN
)paren
id|kfree_skb
c_func
(paren
id|skb_dequeue
c_func
(paren
id|frags
)paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|p
op_assign
id|frags-&gt;next
suffix:semicolon
id|p
op_ne
(paren
r_struct
id|sk_buff
op_star
)paren
id|frags
suffix:semicolon
id|p
op_assign
id|p-&gt;next
)paren
(brace
r_if
c_cond
(paren
id|MP_LE
c_func
(paren
id|MP_SEQUENCE
c_func
(paren
id|skb
)paren
comma
id|MP_SEQUENCE
c_func
(paren
id|p
)paren
)paren
)paren
r_break
suffix:semicolon
)brace
multiline_comment|/* duplicate ? */
r_if
c_cond
(paren
id|MP_SEQUENCE
c_func
(paren
id|skb
)paren
op_eq
id|MP_SEQUENCE
c_func
(paren
id|p
)paren
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
id|__skb_insert
c_func
(paren
id|skb
comma
id|p-&gt;prev
comma
id|p
comma
id|frags
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_struct
id|sk_buff
op_star
DECL|function|mp_complete_seq
id|mp_complete_seq
c_func
(paren
id|isdn_net_local
op_star
id|lp
comma
r_struct
id|sk_buff
op_star
id|b
comma
r_struct
id|sk_buff
op_star
id|e
)paren
(brace
r_struct
id|sk_buff
op_star
id|p
comma
op_star
id|n
comma
op_star
id|skb
suffix:semicolon
r_int
id|len
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|b-&gt;next
op_eq
id|e
)paren
(brace
multiline_comment|/* sequence with only one frag */
id|skb_unlink
c_func
(paren
id|b
)paren
suffix:semicolon
r_return
id|b
suffix:semicolon
)brace
r_for
c_loop
(paren
id|p
op_assign
id|b
comma
id|n
op_assign
id|p-&gt;next
suffix:semicolon
id|p
op_ne
id|e
suffix:semicolon
id|p
op_assign
id|n
comma
id|n
op_assign
id|p-&gt;next
)paren
(brace
id|len
op_add_assign
id|p-&gt;len
suffix:semicolon
)brace
singleline_comment|// FIXME check against mrru?
id|skb
op_assign
id|dev_alloc_skb
c_func
(paren
id|len
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|skb
)paren
id|lp-&gt;stats.rx_errors
op_increment
suffix:semicolon
r_for
c_loop
(paren
id|p
op_assign
id|b
comma
id|n
op_assign
id|p-&gt;next
suffix:semicolon
id|p
op_ne
id|e
suffix:semicolon
id|p
op_assign
id|n
comma
id|n
op_assign
id|p-&gt;next
)paren
(brace
r_if
c_cond
(paren
id|skb
)paren
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
id|p-&gt;len
)paren
comma
id|p-&gt;data
comma
id|p-&gt;len
)paren
suffix:semicolon
id|skb_unlink
c_func
(paren
id|p
)paren
suffix:semicolon
id|kfree_skb
c_func
(paren
id|p
)paren
suffix:semicolon
)brace
r_return
id|skb
suffix:semicolon
)brace
r_struct
id|sk_buff
op_star
DECL|function|mp_reassemble
id|mp_reassemble
c_func
(paren
id|isdn_net_local
op_star
id|lp
)paren
(brace
r_struct
id|inl_ppp
op_star
id|inl_ppp
op_assign
id|lp-&gt;inl_priv
suffix:semicolon
r_struct
id|sk_buff_head
op_star
id|frags
op_assign
op_amp
id|inl_ppp-&gt;mp_frags
suffix:semicolon
r_struct
id|sk_buff
op_star
id|p
comma
op_star
id|n
comma
op_star
id|pp
comma
op_star
id|start
suffix:semicolon
id|u32
id|min_seq
op_assign
id|inl_ppp-&gt;mp_rxseq
suffix:semicolon
id|u32
id|next_seq
op_assign
l_int|0
suffix:semicolon
id|again
suffix:colon
id|start
op_assign
l_int|NULL
suffix:semicolon
r_for
c_loop
(paren
id|p
op_assign
id|frags-&gt;next
comma
id|n
op_assign
id|p-&gt;next
suffix:semicolon
id|p
op_ne
(paren
r_struct
id|sk_buff
op_star
)paren
id|frags
suffix:semicolon
id|p
op_assign
id|n
comma
id|n
op_assign
id|p-&gt;next
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|start
)paren
(brace
r_if
c_cond
(paren
id|MP_FLAGS
c_func
(paren
id|p
)paren
op_amp
id|MP_BEGIN_FRAG
)paren
(brace
id|start
op_assign
id|p
suffix:semicolon
id|next_seq
op_assign
id|MP_SEQUENCE
c_func
(paren
id|p
)paren
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* start frag is missing */
r_goto
id|frag_missing
suffix:semicolon
)brace
)brace
multiline_comment|/* we&squot;ve seen the first fragment of this series */
r_if
c_cond
(paren
id|MP_SEQUENCE
c_func
(paren
id|p
)paren
op_ne
id|next_seq
)paren
(brace
multiline_comment|/* previous frag is missing */
r_goto
id|frag_missing
suffix:semicolon
)brace
r_if
c_cond
(paren
id|MP_FLAGS
c_func
(paren
id|p
)paren
op_amp
id|MP_END_FRAG
)paren
(brace
multiline_comment|/* we got a full sequence */
r_return
id|mp_complete_seq
c_func
(paren
id|lp
comma
id|start
comma
id|p-&gt;next
)paren
suffix:semicolon
)brace
id|next_seq
op_assign
id|MP_SEQUENCE
c_func
(paren
id|p
)paren
op_plus
l_int|1
suffix:semicolon
)brace
r_return
l_int|NULL
suffix:semicolon
id|frag_missing
suffix:colon
r_if
c_cond
(paren
id|MP_SEQUENCE
c_func
(paren
id|p
)paren
op_minus
l_int|1
OG
id|min_seq
)paren
multiline_comment|/* may come later */
r_return
l_int|NULL
suffix:semicolon
multiline_comment|/* for all fragments up to p */
id|p
op_assign
id|p-&gt;next
suffix:semicolon
r_for
c_loop
(paren
id|pp
op_assign
id|frags-&gt;next
comma
id|n
op_assign
id|pp-&gt;next
suffix:semicolon
id|pp
op_ne
id|p
suffix:semicolon
id|pp
op_assign
id|n
comma
id|n
op_assign
id|pp-&gt;next
)paren
(brace
id|skb_unlink
c_func
(paren
id|pp
)paren
suffix:semicolon
id|kfree_skb
c_func
(paren
id|pp
)paren
suffix:semicolon
id|lp-&gt;stats.rx_errors
op_increment
suffix:semicolon
)brace
r_goto
id|again
suffix:semicolon
)brace
r_static
r_void
DECL|function|mp_receive
id|mp_receive
c_func
(paren
id|isdn_net_dev
op_star
id|idev
comma
r_struct
id|sk_buff
op_star
id|skb
)paren
(brace
id|isdn_net_local
op_star
id|lp
op_assign
id|idev-&gt;mlp
suffix:semicolon
r_struct
id|inl_ppp
op_star
id|inl_ppp
op_assign
id|lp-&gt;inl_priv
suffix:semicolon
r_struct
id|ind_ppp
op_star
id|ind_ppp
op_assign
id|idev-&gt;ind_priv
suffix:semicolon
id|isdn_net_dev
op_star
id|qdev
suffix:semicolon
r_struct
id|sk_buff_head
op_star
id|frags
op_assign
op_amp
id|inl_ppp-&gt;mp_frags
suffix:semicolon
id|u32
id|seq
suffix:semicolon
id|u16
id|proto
suffix:semicolon
r_if
c_cond
(paren
id|skb-&gt;len
OL
(paren
id|inl_ppp-&gt;mp_cfg
op_amp
id|SC_IN_SHORT_SEQ
ques
c_cond
l_int|2
suffix:colon
l_int|4
)paren
)paren
r_goto
id|drop
suffix:semicolon
id|seq
op_assign
id|get_seq
c_func
(paren
id|skb
comma
id|ind_ppp-&gt;mp_rxseq
comma
id|inl_ppp-&gt;mp_cfg
op_amp
id|SC_IN_SHORT_SEQ
)paren
suffix:semicolon
id|ind_ppp-&gt;mp_rxseq
op_assign
id|seq
suffix:semicolon
r_if
c_cond
(paren
id|inl_ppp-&gt;mp_rxseq
op_eq
(paren
id|u32
)paren
op_minus
l_int|1
)paren
(brace
multiline_comment|/* first packet */
id|inl_ppp-&gt;mp_rxseq
op_assign
id|seq
suffix:semicolon
)brace
r_if
c_cond
(paren
id|MP_LT
c_func
(paren
id|seq
comma
id|inl_ppp-&gt;mp_rxseq
)paren
)paren
(brace
r_goto
id|drop
suffix:semicolon
)brace
multiline_comment|/* Find the minimum sequence number received over all channels.&n;&t; * No fragments with numbers lower than this will arrive later. */
id|inl_ppp-&gt;mp_rxseq
op_assign
id|seq
suffix:semicolon
id|list_for_each_entry
c_func
(paren
id|qdev
comma
op_amp
id|lp-&gt;online
comma
id|online
)paren
(brace
r_struct
id|ind_ppp
op_star
id|ind_ppp
op_assign
id|qdev-&gt;ind_priv
suffix:semicolon
r_if
c_cond
(paren
id|MP_LT
c_func
(paren
id|ind_ppp-&gt;mp_rxseq
comma
id|inl_ppp-&gt;mp_rxseq
)paren
)paren
id|inl_ppp-&gt;mp_rxseq
op_assign
id|ind_ppp-&gt;mp_rxseq
suffix:semicolon
)brace
multiline_comment|/* Insert the skb into the list of received fragments, ordered by&n;&t; * sequence number */
r_if
c_cond
(paren
id|mp_insert_frag
c_func
(paren
id|frags
comma
id|skb
)paren
)paren
r_goto
id|drop
suffix:semicolon
r_while
c_loop
(paren
(paren
id|skb
op_assign
id|mp_reassemble
c_func
(paren
id|lp
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
id|isdn_ppp_strip_proto
c_func
(paren
id|skb
comma
op_amp
id|proto
)paren
)paren
(brace
id|kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_continue
suffix:semicolon
)brace
id|ippp_receive
c_func
(paren
id|idev
comma
id|skb
comma
id|proto
)paren
suffix:semicolon
)brace
r_return
suffix:semicolon
id|drop
suffix:colon
id|lp-&gt;stats.rx_errors
op_increment
suffix:semicolon
id|kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
)brace
eof
