multiline_comment|/*&n; *&n;  Copyright (c) Eicon Networks, 2002.&n; *&n;  This source file is supplied for the use with&n;  Eicon Networks range of DIVA Server Adapters.&n; *&n;  Eicon File Revision :    2.1&n; *&n;  This program is free software; you can redistribute it and/or modify&n;  it under the terms of the GNU General Public License as published by&n;  the Free Software Foundation; either version 2, or (at your option)&n;  any later version.&n; *&n;  This program is distributed in the hope that it will be useful,&n;  but WITHOUT ANY WARRANTY OF ANY KIND WHATSOEVER INCLUDING ANY&n;  implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.&n;  See the GNU General Public License for more details.&n; *&n;  You should have received a copy of the GNU General Public License&n;  along with this program; if not, write to the Free Software&n;  Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.&n; *&n; */
macro_line|#include &quot;platform.h&quot;
macro_line|#include &quot;di_defs.h&quot;
macro_line|#include &quot;pc.h&quot;
macro_line|#include &quot;pr_pc.h&quot;
macro_line|#include &quot;divasync.h&quot;
DECL|macro|MIPS_SCOM
mdefine_line|#define MIPS_SCOM
macro_line|#include &quot;pkmaint.h&quot; /* pc_main.h, packed in os-dependent fashion */
macro_line|#include &quot;di.h&quot;
macro_line|#include &quot;mi_pc.h&quot;
macro_line|#include &quot;io.h&quot;
r_extern
id|ADAPTER
op_star
id|adapter
(braket
id|MAX_ADAPTER
)braket
suffix:semicolon
r_extern
id|PISDN_ADAPTER
id|IoAdapters
(braket
id|MAX_ADAPTER
)braket
suffix:semicolon
r_void
id|request
(paren
id|PISDN_ADAPTER
comma
id|ENTITY
op_star
)paren
suffix:semicolon
r_void
id|pcm_req
(paren
id|PISDN_ADAPTER
comma
id|ENTITY
op_star
)paren
suffix:semicolon
multiline_comment|/* --------------------------------------------------------------------------&n;  local functions&n;  -------------------------------------------------------------------------- */
DECL|macro|ReqFunc
mdefine_line|#define ReqFunc(N) &bslash;&n;static void Request##N(ENTITY *e) &bslash;&n;{ if ( IoAdapters[N] ) (* IoAdapters[N]-&gt;DIRequest)(IoAdapters[N], e) ; }
id|ReqFunc
c_func
(paren
l_int|0
)paren
id|ReqFunc
c_func
(paren
l_int|1
)paren
id|ReqFunc
c_func
(paren
l_int|2
)paren
id|ReqFunc
c_func
(paren
l_int|3
)paren
id|ReqFunc
c_func
(paren
l_int|4
)paren
id|ReqFunc
c_func
(paren
l_int|5
)paren
id|ReqFunc
c_func
(paren
l_int|6
)paren
id|ReqFunc
c_func
(paren
l_int|7
)paren
id|ReqFunc
c_func
(paren
l_int|8
)paren
id|ReqFunc
c_func
(paren
l_int|9
)paren
id|ReqFunc
c_func
(paren
l_int|10
)paren
id|ReqFunc
c_func
(paren
l_int|11
)paren
id|ReqFunc
c_func
(paren
l_int|12
)paren
id|ReqFunc
c_func
(paren
l_int|13
)paren
id|ReqFunc
c_func
(paren
l_int|14
)paren
id|ReqFunc
c_func
(paren
l_int|15
)paren
DECL|variable|Requests
id|IDI_CALL
id|Requests
(braket
id|MAX_ADAPTER
)braket
op_assign
(brace
op_amp
id|Request0
comma
op_amp
id|Request1
comma
op_amp
id|Request2
comma
op_amp
id|Request3
comma
op_amp
id|Request4
comma
op_amp
id|Request5
comma
op_amp
id|Request6
comma
op_amp
id|Request7
comma
op_amp
id|Request8
comma
op_amp
id|Request9
comma
op_amp
id|Request10
comma
op_amp
id|Request11
comma
op_amp
id|Request12
comma
op_amp
id|Request13
comma
op_amp
id|Request14
comma
op_amp
id|Request15
)brace
suffix:semicolon
multiline_comment|/*****************************************************************************/
multiline_comment|/*&n;  This array should indicate all new services, that this version of XDI&n;  is able to provide to his clients&n;  */
DECL|variable|extended_xdi_features
r_static
id|byte
id|extended_xdi_features
(braket
id|DIVA_XDI_EXTENDED_FEATURES_MAX_SZ
op_plus
l_int|1
)braket
op_assign
(brace
(paren
id|DIVA_XDI_EXTENDED_FEATURES_VALID
op_or
id|DIVA_XDI_EXTENDED_FEATURE_CMA
op_or
id|DIVA_XDI_EXTENDED_FEATURE_SDRAM_BAR
op_or
id|DIVA_XDI_EXTENDED_FEATURE_CAPI_PRMS
op_or
macro_line|#if defined(DIVA_IDI_RX_DMA)
id|DIVA_XDI_EXTENDED_FEATURE_RX_DMA
op_or
macro_line|#endif
id|DIVA_XDI_EXTENDED_FEATURE_NO_CANCEL_RC
)paren
comma
l_int|0
)brace
suffix:semicolon
multiline_comment|/*****************************************************************************/
r_void
DECL|function|dump_xlog_buffer
id|dump_xlog_buffer
(paren
id|PISDN_ADAPTER
id|IoAdapter
comma
id|Xdesc
op_star
id|xlogDesc
)paren
(brace
id|dword
id|logLen
suffix:semicolon
id|word
op_star
id|Xlog
op_assign
id|xlogDesc-&gt;buf
suffix:semicolon
id|word
id|logCnt
op_assign
id|xlogDesc-&gt;cnt
suffix:semicolon
id|word
id|logOut
op_assign
id|xlogDesc-&gt;out
op_div
r_sizeof
(paren
op_star
id|Xlog
)paren
suffix:semicolon
id|DBG_FTL
c_func
(paren
(paren
l_string|&quot;%s: ************* XLOG recovery (%d) *************&quot;
comma
op_amp
id|IoAdapter-&gt;Name
(braket
l_int|0
)braket
comma
(paren
r_int
)paren
id|logCnt
)paren
)paren
id|DBG_FTL
c_func
(paren
(paren
l_string|&quot;Microcode: %s&quot;
comma
op_amp
id|IoAdapter-&gt;ProtocolIdString
(braket
l_int|0
)braket
)paren
)paren
r_for
c_loop
(paren
suffix:semicolon
id|logCnt
OG
l_int|0
suffix:semicolon
op_decrement
id|logCnt
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|READ_WORD
c_func
(paren
op_amp
id|Xlog
(braket
id|logOut
)braket
)paren
)paren
(brace
r_if
c_cond
(paren
op_decrement
id|logCnt
op_eq
l_int|0
)paren
r_break
suffix:semicolon
id|logOut
op_assign
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|READ_WORD
c_func
(paren
op_amp
id|Xlog
(braket
id|logOut
)braket
)paren
op_le
(paren
id|logOut
op_star
r_sizeof
(paren
op_star
id|Xlog
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
id|logCnt
OG
l_int|2
)paren
(brace
id|DBG_FTL
c_func
(paren
(paren
l_string|&quot;Possibly corrupted XLOG: %d entries left&quot;
comma
(paren
r_int
)paren
id|logCnt
)paren
)paren
)brace
r_break
suffix:semicolon
)brace
id|logLen
op_assign
(paren
id|dword
)paren
(paren
id|READ_WORD
c_func
(paren
op_amp
id|Xlog
(braket
id|logOut
)braket
)paren
op_minus
(paren
id|logOut
op_star
r_sizeof
(paren
op_star
id|Xlog
)paren
)paren
)paren
suffix:semicolon
id|DBG_FTL_MXLOG
c_func
(paren
(paren
(paren
r_char
op_star
)paren
op_amp
id|Xlog
(braket
id|logOut
op_plus
l_int|1
)braket
comma
(paren
id|dword
)paren
(paren
id|logLen
op_minus
l_int|2
)paren
)paren
)paren
id|logOut
op_assign
(paren
id|READ_WORD
c_func
(paren
op_amp
id|Xlog
(braket
id|logOut
)braket
)paren
op_plus
l_int|1
)paren
op_div
r_sizeof
(paren
op_star
id|Xlog
)paren
suffix:semicolon
)brace
id|DBG_FTL
c_func
(paren
(paren
l_string|&quot;%s: ***************** end of XLOG *****************&quot;
comma
op_amp
id|IoAdapter-&gt;Name
(braket
l_int|0
)braket
)paren
)paren
)brace
multiline_comment|/*****************************************************************************/
DECL|variable|ExceptionCauseTable
r_char
op_star
(paren
id|ExceptionCauseTable
(braket
)braket
)paren
op_assign
(brace
l_string|&quot;Interrupt&quot;
comma
l_string|&quot;TLB mod /IBOUND&quot;
comma
l_string|&quot;TLB load /DBOUND&quot;
comma
l_string|&quot;TLB store&quot;
comma
l_string|&quot;Address error load&quot;
comma
l_string|&quot;Address error store&quot;
comma
l_string|&quot;Instruction load bus error&quot;
comma
l_string|&quot;Data load/store bus error&quot;
comma
l_string|&quot;Syscall&quot;
comma
l_string|&quot;Breakpoint&quot;
comma
l_string|&quot;Reverd instruction&quot;
comma
l_string|&quot;Coprocessor unusable&quot;
comma
l_string|&quot;Overflow&quot;
comma
l_string|&quot;TRAP&quot;
comma
l_string|&quot;VCEI&quot;
comma
l_string|&quot;Floating Point Exception&quot;
comma
l_string|&quot;CP2&quot;
comma
l_string|&quot;Reserved 17&quot;
comma
l_string|&quot;Reserved 18&quot;
comma
l_string|&quot;Reserved 19&quot;
comma
l_string|&quot;Reserved 20&quot;
comma
l_string|&quot;Reserved 21&quot;
comma
l_string|&quot;Reserved 22&quot;
comma
l_string|&quot;WATCH&quot;
comma
l_string|&quot;Reserved 24&quot;
comma
l_string|&quot;Reserved 25&quot;
comma
l_string|&quot;Reserved 26&quot;
comma
l_string|&quot;Reserved 27&quot;
comma
l_string|&quot;Reserved 28&quot;
comma
l_string|&quot;Reserved 29&quot;
comma
l_string|&quot;Reserved 30&quot;
comma
l_string|&quot;VCED&quot;
)brace
suffix:semicolon
r_void
DECL|function|dump_trap_frame
id|dump_trap_frame
(paren
id|PISDN_ADAPTER
id|IoAdapter
comma
id|byte
op_star
id|exceptionFrame
)paren
(brace
id|MP_XCPTC
op_star
id|xcept
op_assign
(paren
id|MP_XCPTC
op_star
)paren
id|exceptionFrame
suffix:semicolon
id|dword
op_star
id|regs
op_assign
op_amp
id|xcept-&gt;regs
(braket
l_int|0
)braket
suffix:semicolon
id|DBG_FTL
c_func
(paren
(paren
l_string|&quot;%s: ***************** CPU TRAPPED *****************&quot;
comma
op_amp
id|IoAdapter-&gt;Name
(braket
l_int|0
)braket
)paren
)paren
id|DBG_FTL
c_func
(paren
(paren
l_string|&quot;Microcode: %s&quot;
comma
op_amp
id|IoAdapter-&gt;ProtocolIdString
(braket
l_int|0
)braket
)paren
)paren
id|DBG_FTL
c_func
(paren
(paren
l_string|&quot;Cause: %s&quot;
comma
id|ExceptionCauseTable
(braket
(paren
id|READ_DWORD
c_func
(paren
op_amp
id|xcept-&gt;cr
)paren
op_amp
l_int|0x0000007c
)paren
op_rshift
l_int|2
)braket
)paren
)paren
id|DBG_FTL
c_func
(paren
(paren
l_string|&quot;sr    0x%08x cr    0x%08x epc   0x%08x vaddr 0x%08x&quot;
comma
id|READ_DWORD
c_func
(paren
op_amp
id|xcept-&gt;sr
)paren
comma
id|READ_DWORD
c_func
(paren
op_amp
id|xcept-&gt;cr
)paren
comma
id|READ_DWORD
c_func
(paren
op_amp
id|xcept-&gt;epc
)paren
comma
id|READ_DWORD
c_func
(paren
op_amp
id|xcept-&gt;vaddr
)paren
)paren
)paren
id|DBG_FTL
c_func
(paren
(paren
l_string|&quot;zero  0x%08x at    0x%08x v0    0x%08x v1    0x%08x&quot;
comma
id|READ_DWORD
c_func
(paren
op_amp
id|regs
(braket
l_int|0
)braket
)paren
comma
id|READ_DWORD
c_func
(paren
op_amp
id|regs
(braket
l_int|1
)braket
)paren
comma
id|READ_DWORD
c_func
(paren
op_amp
id|regs
(braket
l_int|2
)braket
)paren
comma
id|READ_DWORD
c_func
(paren
op_amp
id|regs
(braket
l_int|3
)braket
)paren
)paren
)paren
id|DBG_FTL
c_func
(paren
(paren
l_string|&quot;a0    0x%08x a1    0x%08x a2    0x%08x a3    0x%08x&quot;
comma
id|READ_DWORD
c_func
(paren
op_amp
id|regs
(braket
l_int|4
)braket
)paren
comma
id|READ_DWORD
c_func
(paren
op_amp
id|regs
(braket
l_int|5
)braket
)paren
comma
id|READ_DWORD
c_func
(paren
op_amp
id|regs
(braket
l_int|6
)braket
)paren
comma
id|READ_DWORD
c_func
(paren
op_amp
id|regs
(braket
l_int|7
)braket
)paren
)paren
)paren
id|DBG_FTL
c_func
(paren
(paren
l_string|&quot;t0    0x%08x t1    0x%08x t2    0x%08x t3    0x%08x&quot;
comma
id|READ_DWORD
c_func
(paren
op_amp
id|regs
(braket
l_int|8
)braket
)paren
comma
id|READ_DWORD
c_func
(paren
op_amp
id|regs
(braket
l_int|9
)braket
)paren
comma
id|READ_DWORD
c_func
(paren
op_amp
id|regs
(braket
l_int|10
)braket
)paren
comma
id|READ_DWORD
c_func
(paren
op_amp
id|regs
(braket
l_int|11
)braket
)paren
)paren
)paren
id|DBG_FTL
c_func
(paren
(paren
l_string|&quot;t4    0x%08x t5    0x%08x t6    0x%08x t7    0x%08x&quot;
comma
id|READ_DWORD
c_func
(paren
op_amp
id|regs
(braket
l_int|12
)braket
)paren
comma
id|READ_DWORD
c_func
(paren
op_amp
id|regs
(braket
l_int|13
)braket
)paren
comma
id|READ_DWORD
c_func
(paren
op_amp
id|regs
(braket
l_int|14
)braket
)paren
comma
id|READ_DWORD
c_func
(paren
op_amp
id|regs
(braket
l_int|15
)braket
)paren
)paren
)paren
id|DBG_FTL
c_func
(paren
(paren
l_string|&quot;s0    0x%08x s1    0x%08x s2    0x%08x s3    0x%08x&quot;
comma
id|READ_DWORD
c_func
(paren
op_amp
id|regs
(braket
l_int|16
)braket
)paren
comma
id|READ_DWORD
c_func
(paren
op_amp
id|regs
(braket
l_int|17
)braket
)paren
comma
id|READ_DWORD
c_func
(paren
op_amp
id|regs
(braket
l_int|18
)braket
)paren
comma
id|READ_DWORD
c_func
(paren
op_amp
id|regs
(braket
l_int|19
)braket
)paren
)paren
)paren
id|DBG_FTL
c_func
(paren
(paren
l_string|&quot;s4    0x%08x s5    0x%08x s6    0x%08x s7    0x%08x&quot;
comma
id|READ_DWORD
c_func
(paren
op_amp
id|regs
(braket
l_int|20
)braket
)paren
comma
id|READ_DWORD
c_func
(paren
op_amp
id|regs
(braket
l_int|21
)braket
)paren
comma
id|READ_DWORD
c_func
(paren
op_amp
id|regs
(braket
l_int|22
)braket
)paren
comma
id|READ_DWORD
c_func
(paren
op_amp
id|regs
(braket
l_int|23
)braket
)paren
)paren
)paren
id|DBG_FTL
c_func
(paren
(paren
l_string|&quot;t8    0x%08x t9    0x%08x k0    0x%08x k1    0x%08x&quot;
comma
id|READ_DWORD
c_func
(paren
op_amp
id|regs
(braket
l_int|24
)braket
)paren
comma
id|READ_DWORD
c_func
(paren
op_amp
id|regs
(braket
l_int|25
)braket
)paren
comma
id|READ_DWORD
c_func
(paren
op_amp
id|regs
(braket
l_int|26
)braket
)paren
comma
id|READ_DWORD
c_func
(paren
op_amp
id|regs
(braket
l_int|27
)braket
)paren
)paren
)paren
id|DBG_FTL
c_func
(paren
(paren
l_string|&quot;gp    0x%08x sp    0x%08x s8    0x%08x ra    0x%08x&quot;
comma
id|READ_DWORD
c_func
(paren
op_amp
id|regs
(braket
l_int|28
)braket
)paren
comma
id|READ_DWORD
c_func
(paren
op_amp
id|regs
(braket
l_int|29
)braket
)paren
comma
id|READ_DWORD
c_func
(paren
op_amp
id|regs
(braket
l_int|30
)braket
)paren
comma
id|READ_DWORD
c_func
(paren
op_amp
id|regs
(braket
l_int|31
)braket
)paren
)paren
)paren
id|DBG_FTL
c_func
(paren
(paren
l_string|&quot;md    0x%08x|%08x         resvd 0x%08x class 0x%08x&quot;
comma
id|READ_DWORD
c_func
(paren
op_amp
id|xcept-&gt;mdhi
)paren
comma
id|READ_DWORD
c_func
(paren
op_amp
id|xcept-&gt;mdlo
)paren
comma
id|READ_DWORD
c_func
(paren
op_amp
id|xcept-&gt;reseverd
)paren
comma
id|READ_DWORD
c_func
(paren
op_amp
id|xcept-&gt;xclass
)paren
)paren
)paren
)brace
multiline_comment|/* --------------------------------------------------------------------------&n;  Real XDI Request function&n;  -------------------------------------------------------------------------- */
DECL|function|request
r_void
id|request
c_func
(paren
id|PISDN_ADAPTER
id|IoAdapter
comma
id|ENTITY
op_star
id|e
)paren
(brace
id|byte
id|i
suffix:semicolon
id|diva_os_spin_lock_magic_t
id|irql
suffix:semicolon
multiline_comment|/*&n; * if the Req field in the entity structure is 0,&n; * we treat this request as a special function call&n; */
r_if
c_cond
(paren
op_logical_neg
id|e-&gt;Req
)paren
(brace
id|IDI_SYNC_REQ
op_star
id|syncReq
op_assign
(paren
id|IDI_SYNC_REQ
op_star
)paren
id|e
suffix:semicolon
r_switch
c_cond
(paren
id|e-&gt;Rc
)paren
(brace
macro_line|#if defined(DIVA_IDI_RX_DMA)
r_case
id|IDI_SYNC_REQ_DMA_DESCRIPTOR_OPERATION
suffix:colon
(brace
id|diva_xdi_dma_descriptor_operation_t
op_star
id|pI
op_assign
"&bslash;"
op_amp
id|syncReq-&gt;xdi_dma_descriptor_operation.info
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|IoAdapter-&gt;dma_map
)paren
(brace
id|pI-&gt;operation
op_assign
op_minus
l_int|1
suffix:semicolon
id|pI-&gt;descriptor_number
op_assign
op_minus
l_int|1
suffix:semicolon
r_return
suffix:semicolon
)brace
id|diva_os_enter_spin_lock
(paren
op_amp
id|IoAdapter-&gt;data_spin_lock
comma
op_amp
id|irql
comma
l_string|&quot;dma_op&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pI-&gt;operation
op_eq
id|IDI_SYNC_REQ_DMA_DESCRIPTOR_ALLOC
)paren
(brace
id|pI-&gt;descriptor_number
op_assign
id|diva_alloc_dma_map_entry
(paren
"&bslash;"
(paren
r_struct
id|_diva_dma_map_entry
op_star
)paren
id|IoAdapter-&gt;dma_map
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pI-&gt;descriptor_number
op_ge
l_int|0
)paren
(brace
id|dword
id|dma_magic
suffix:semicolon
r_void
op_star
id|local_addr
suffix:semicolon
id|DBG_TRC
c_func
(paren
(paren
l_string|&quot;A(%d) dma_alloc(%d)&quot;
comma
id|IoAdapter-&gt;ANum
comma
id|pI-&gt;descriptor_number
)paren
)paren
id|diva_get_dma_map_entry
(paren
"&bslash;"
(paren
r_struct
id|_diva_dma_map_entry
op_star
)paren
id|IoAdapter-&gt;dma_map
comma
id|pI-&gt;descriptor_number
comma
op_amp
id|local_addr
comma
op_amp
id|dma_magic
)paren
suffix:semicolon
id|pI-&gt;descriptor_address
op_assign
id|local_addr
suffix:semicolon
id|pI-&gt;descriptor_magic
op_assign
id|dma_magic
suffix:semicolon
id|pI-&gt;operation
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|pI-&gt;operation
op_assign
op_minus
l_int|1
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
(paren
id|pI-&gt;operation
op_eq
id|IDI_SYNC_REQ_DMA_DESCRIPTOR_FREE
)paren
op_logical_and
(paren
id|pI-&gt;descriptor_number
op_ge
l_int|0
)paren
)paren
(brace
id|DBG_TRC
c_func
(paren
(paren
l_string|&quot;A(%d) dma_free(%d)&quot;
comma
id|IoAdapter-&gt;ANum
comma
id|pI-&gt;descriptor_number
)paren
)paren
id|diva_free_dma_map_entry
c_func
(paren
(paren
r_struct
id|_diva_dma_map_entry
op_star
)paren
id|IoAdapter-&gt;dma_map
comma
id|pI-&gt;descriptor_number
)paren
suffix:semicolon
id|pI-&gt;descriptor_number
op_assign
op_minus
l_int|1
suffix:semicolon
id|pI-&gt;operation
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|pI-&gt;descriptor_number
op_assign
op_minus
l_int|1
suffix:semicolon
id|pI-&gt;operation
op_assign
op_minus
l_int|1
suffix:semicolon
)brace
id|diva_os_leave_spin_lock
(paren
op_amp
id|IoAdapter-&gt;data_spin_lock
comma
op_amp
id|irql
comma
l_string|&quot;dma_op&quot;
)paren
suffix:semicolon
)brace
r_return
suffix:semicolon
macro_line|#endif
r_case
id|IDI_SYNC_REQ_XDI_GET_LOGICAL_ADAPTER_NUMBER
suffix:colon
(brace
id|diva_xdi_get_logical_adapter_number_s_t
op_star
id|pI
op_assign
"&bslash;"
op_amp
id|syncReq-&gt;xdi_logical_adapter_number.info
suffix:semicolon
id|pI-&gt;logical_adapter_number
op_assign
id|IoAdapter-&gt;ANum
suffix:semicolon
id|pI-&gt;controller
op_assign
id|IoAdapter-&gt;ControllerNumber
suffix:semicolon
)brace
r_return
suffix:semicolon
r_case
id|IDI_SYNC_REQ_XDI_GET_CAPI_PARAMS
suffix:colon
(brace
id|diva_xdi_get_capi_parameters_t
id|prms
comma
op_star
id|pI
op_assign
op_amp
id|syncReq-&gt;xdi_capi_prms.info
suffix:semicolon
id|memset
(paren
op_amp
id|prms
comma
l_int|0x00
comma
r_sizeof
(paren
id|prms
)paren
)paren
suffix:semicolon
id|prms.structure_length
op_assign
id|MIN
c_func
(paren
r_sizeof
(paren
id|prms
)paren
comma
id|pI-&gt;structure_length
)paren
suffix:semicolon
id|memset
(paren
id|pI
comma
l_int|0x00
comma
id|pI-&gt;structure_length
)paren
suffix:semicolon
id|prms.flag_dynamic_l1_down
op_assign
(paren
id|IoAdapter-&gt;capi_cfg.cfg_1
op_amp
"&bslash;"
id|DIVA_XDI_CAPI_CFG_1_DYNAMIC_L1_ON
)paren
ques
c_cond
l_int|1
suffix:colon
l_int|0
suffix:semicolon
id|prms.group_optimization_enabled
op_assign
(paren
id|IoAdapter-&gt;capi_cfg.cfg_1
op_amp
"&bslash;"
id|DIVA_XDI_CAPI_CFG_1_GROUP_POPTIMIZATION_ON
)paren
ques
c_cond
l_int|1
suffix:colon
l_int|0
suffix:semicolon
id|memcpy
(paren
id|pI
comma
op_amp
id|prms
comma
id|prms.structure_length
)paren
suffix:semicolon
)brace
r_return
suffix:semicolon
r_case
id|IDI_SYNC_REQ_XDI_GET_ADAPTER_SDRAM_BAR
suffix:colon
id|syncReq-&gt;xdi_sdram_bar.info.bar
op_assign
id|IoAdapter-&gt;sdram_bar
suffix:semicolon
r_return
suffix:semicolon
r_case
id|IDI_SYNC_REQ_XDI_GET_EXTENDED_FEATURES
suffix:colon
(brace
id|dword
id|i
suffix:semicolon
id|diva_xdi_get_extended_xdi_features_t
op_star
id|pI
op_assign
"&bslash;"
op_amp
id|syncReq-&gt;xdi_extended_features.info
suffix:semicolon
id|pI-&gt;buffer_length_in_bytes
op_and_assign
op_complement
l_int|0x80000000
suffix:semicolon
r_if
c_cond
(paren
id|pI-&gt;buffer_length_in_bytes
op_logical_and
id|pI-&gt;features
)paren
(brace
id|memset
(paren
id|pI-&gt;features
comma
l_int|0x00
comma
id|pI-&gt;buffer_length_in_bytes
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
(paren
(paren
id|pI-&gt;features
)paren
op_logical_and
(paren
id|i
OL
id|pI-&gt;buffer_length_in_bytes
)paren
op_logical_and
(paren
id|i
OL
id|DIVA_XDI_EXTENDED_FEATURES_MAX_SZ
)paren
)paren
suffix:semicolon
id|i
op_increment
)paren
(brace
id|pI-&gt;features
(braket
id|i
)braket
op_assign
id|extended_xdi_features
(braket
id|i
)braket
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|pI-&gt;buffer_length_in_bytes
OL
id|DIVA_XDI_EXTENDED_FEATURES_MAX_SZ
)paren
op_logical_or
(paren
op_logical_neg
id|pI-&gt;features
)paren
)paren
(brace
id|pI-&gt;buffer_length_in_bytes
op_assign
"&bslash;"
(paren
l_int|0x80000000
op_or
id|DIVA_XDI_EXTENDED_FEATURES_MAX_SZ
)paren
suffix:semicolon
)brace
)brace
r_return
suffix:semicolon
r_case
id|IDI_SYNC_REQ_XDI_GET_STREAM
suffix:colon
r_if
c_cond
(paren
id|IoAdapter
)paren
(brace
id|diva_xdi_provide_istream_info
(paren
op_amp
id|IoAdapter-&gt;a
comma
op_amp
id|syncReq-&gt;xdi_stream_info.info
)paren
suffix:semicolon
)brace
r_else
(brace
id|syncReq-&gt;xdi_stream_info.info.provided_service
op_assign
l_int|0
suffix:semicolon
)brace
r_return
suffix:semicolon
r_case
id|IDI_SYNC_REQ_GET_NAME
suffix:colon
r_if
c_cond
(paren
id|IoAdapter
)paren
(brace
id|strcpy
(paren
op_amp
id|syncReq-&gt;GetName.name
(braket
l_int|0
)braket
comma
id|IoAdapter-&gt;Name
)paren
suffix:semicolon
id|DBG_TRC
c_func
(paren
(paren
l_string|&quot;xdi: Adapter %d / Name &squot;%s&squot;&quot;
comma
id|IoAdapter-&gt;ANum
comma
id|IoAdapter-&gt;Name
)paren
)paren
r_return
suffix:semicolon
)brace
id|syncReq-&gt;GetName.name
(braket
l_int|0
)braket
op_assign
l_char|&squot;&bslash;0&squot;
suffix:semicolon
r_break
suffix:semicolon
r_case
id|IDI_SYNC_REQ_GET_SERIAL
suffix:colon
r_if
c_cond
(paren
id|IoAdapter
)paren
(brace
id|syncReq-&gt;GetSerial.serial
op_assign
id|IoAdapter-&gt;serialNo
suffix:semicolon
id|DBG_TRC
c_func
(paren
(paren
l_string|&quot;xdi: Adapter %d / SerialNo %ld&quot;
comma
id|IoAdapter-&gt;ANum
comma
id|IoAdapter-&gt;serialNo
)paren
)paren
r_return
suffix:semicolon
)brace
id|syncReq-&gt;GetSerial.serial
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
id|IDI_SYNC_REQ_GET_XLOG
suffix:colon
r_if
c_cond
(paren
id|IoAdapter
)paren
(brace
id|pcm_req
(paren
id|IoAdapter
comma
id|e
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|e-&gt;Ind
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
id|IDI_SYNC_REQ_GET_FEATURES
suffix:colon
r_if
c_cond
(paren
id|IoAdapter
)paren
(brace
id|syncReq-&gt;GetFeatures.features
op_assign
(paren
r_int
r_int
)paren
id|IoAdapter-&gt;features
suffix:semicolon
r_return
suffix:semicolon
)brace
id|syncReq-&gt;GetFeatures.features
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
id|IDI_SYNC_REQ_PORTDRV_HOOK
suffix:colon
r_if
c_cond
(paren
id|IoAdapter
)paren
(brace
id|DBG_TRC
c_func
(paren
(paren
l_string|&quot;Xdi:IDI_SYNC_REQ_PORTDRV_HOOK - ignored&quot;
)paren
)paren
r_return
suffix:semicolon
)brace
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|IoAdapter
)paren
(brace
id|DBG_FTL
c_func
(paren
(paren
l_string|&quot;xdi: unknown Req 0 / Rc %d !&quot;
comma
id|e-&gt;Rc
)paren
)paren
r_return
suffix:semicolon
)brace
)brace
id|DBG_TRC
c_func
(paren
(paren
l_string|&quot;xdi: Id 0x%x / Req 0x%x / Rc 0x%x&quot;
comma
id|e-&gt;Id
comma
id|e-&gt;Req
comma
id|e-&gt;Rc
)paren
)paren
r_if
c_cond
(paren
op_logical_neg
id|IoAdapter
)paren
(brace
id|DBG_FTL
c_func
(paren
(paren
l_string|&quot;xdi: uninitialized Adapter used - ignore request&quot;
)paren
)paren
r_return
suffix:semicolon
)brace
id|diva_os_enter_spin_lock
(paren
op_amp
id|IoAdapter-&gt;data_spin_lock
comma
op_amp
id|irql
comma
l_string|&quot;data_req&quot;
)paren
suffix:semicolon
multiline_comment|/*&n; * assign an entity&n; */
r_if
c_cond
(paren
op_logical_neg
(paren
id|e-&gt;Id
op_amp
l_int|0x1f
)paren
)paren
(brace
r_if
c_cond
(paren
id|IoAdapter-&gt;e_count
op_ge
id|IoAdapter-&gt;e_max
)paren
(brace
id|DBG_FTL
c_func
(paren
(paren
l_string|&quot;xdi: all Ids in use (max=%d) --&gt; Req ignored&quot;
comma
id|IoAdapter-&gt;e_max
)paren
)paren
id|diva_os_leave_spin_lock
(paren
op_amp
id|IoAdapter-&gt;data_spin_lock
comma
op_amp
id|irql
comma
l_string|&quot;data_req&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
multiline_comment|/*&n; * find a new free id&n; */
r_for
c_loop
(paren
id|i
op_assign
l_int|1
suffix:semicolon
id|IoAdapter-&gt;e_tbl
(braket
id|i
)braket
dot
id|e
suffix:semicolon
op_increment
id|i
)paren
suffix:semicolon
id|IoAdapter-&gt;e_tbl
(braket
id|i
)braket
dot
id|e
op_assign
id|e
suffix:semicolon
id|IoAdapter-&gt;e_count
op_increment
suffix:semicolon
id|e-&gt;No
op_assign
(paren
id|byte
)paren
id|i
suffix:semicolon
id|e-&gt;More
op_assign
l_int|0
suffix:semicolon
id|e-&gt;RCurrent
op_assign
l_int|0xff
suffix:semicolon
)brace
r_else
(brace
id|i
op_assign
id|e-&gt;No
suffix:semicolon
)brace
multiline_comment|/*&n; * if the entity is still busy, ignore the request call&n; */
r_if
c_cond
(paren
id|e-&gt;More
op_amp
id|XBUSY
)paren
(brace
id|DBG_FTL
c_func
(paren
(paren
l_string|&quot;xdi: Id 0x%x busy --&gt; Req 0x%x ignored&quot;
comma
id|e-&gt;Id
comma
id|e-&gt;Req
)paren
)paren
r_if
c_cond
(paren
op_logical_neg
id|IoAdapter-&gt;trapped
op_logical_and
id|IoAdapter-&gt;trapFnc
)paren
(brace
id|IoAdapter-&gt;trapFnc
(paren
id|IoAdapter
)paren
suffix:semicolon
multiline_comment|/*&n;        Firs trap, also notify user if supported&n;       */
r_if
c_cond
(paren
id|IoAdapter-&gt;trapped
op_logical_and
id|IoAdapter-&gt;os_trap_nfy_Fnc
)paren
(brace
(paren
op_star
(paren
id|IoAdapter-&gt;os_trap_nfy_Fnc
)paren
)paren
(paren
id|IoAdapter
comma
id|IoAdapter-&gt;ANum
)paren
suffix:semicolon
)brace
)brace
id|diva_os_leave_spin_lock
(paren
op_amp
id|IoAdapter-&gt;data_spin_lock
comma
op_amp
id|irql
comma
l_string|&quot;data_req&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
multiline_comment|/*&n; * initialize transmit status variables&n; */
id|e-&gt;More
op_or_assign
id|XBUSY
suffix:semicolon
id|e-&gt;More
op_and_assign
op_complement
id|XMOREF
suffix:semicolon
id|e-&gt;XCurrent
op_assign
l_int|0
suffix:semicolon
id|e-&gt;XOffset
op_assign
l_int|0
suffix:semicolon
multiline_comment|/*&n; * queue this entity in the adapter request queue&n; */
id|IoAdapter-&gt;e_tbl
(braket
id|i
)braket
dot
id|next
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|IoAdapter-&gt;head
)paren
(brace
id|IoAdapter-&gt;e_tbl
(braket
id|IoAdapter-&gt;tail
)braket
dot
id|next
op_assign
id|i
suffix:semicolon
id|IoAdapter-&gt;tail
op_assign
id|i
suffix:semicolon
)brace
r_else
(brace
id|IoAdapter-&gt;head
op_assign
id|i
suffix:semicolon
id|IoAdapter-&gt;tail
op_assign
id|i
suffix:semicolon
)brace
multiline_comment|/*&n; * queue the DPC to process the request&n; */
id|diva_os_schedule_soft_isr
(paren
op_amp
id|IoAdapter-&gt;req_soft_isr
)paren
suffix:semicolon
id|diva_os_leave_spin_lock
(paren
op_amp
id|IoAdapter-&gt;data_spin_lock
comma
op_amp
id|irql
comma
l_string|&quot;data_req&quot;
)paren
suffix:semicolon
)brace
multiline_comment|/* ---------------------------------------------------------------------&n;  Main DPC routine&n;   --------------------------------------------------------------------- */
DECL|function|DIDpcRoutine
r_void
id|DIDpcRoutine
(paren
r_struct
id|_diva_os_soft_isr
op_star
id|psoft_isr
comma
r_void
op_star
id|Context
)paren
(brace
id|PISDN_ADAPTER
id|IoAdapter
op_assign
(paren
id|PISDN_ADAPTER
)paren
id|Context
suffix:semicolon
id|ADAPTER
op_star
id|a
op_assign
op_amp
id|IoAdapter-&gt;a
suffix:semicolon
id|diva_os_atomic_t
op_star
id|pin_dpc
op_assign
op_amp
id|IoAdapter-&gt;in_dpc
suffix:semicolon
r_if
c_cond
(paren
id|diva_os_atomic_increment
(paren
id|pin_dpc
)paren
op_eq
l_int|1
)paren
(brace
r_do
(brace
r_if
c_cond
(paren
id|IoAdapter-&gt;tst_irq
(paren
id|a
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|IoAdapter-&gt;Unavailable
)paren
id|IoAdapter-&gt;dpc
(paren
id|a
)paren
suffix:semicolon
id|IoAdapter-&gt;clr_irq
(paren
id|a
)paren
suffix:semicolon
)brace
id|IoAdapter-&gt;out
(paren
id|a
)paren
suffix:semicolon
)brace
r_while
c_loop
(paren
id|diva_os_atomic_decrement
(paren
id|pin_dpc
)paren
OG
l_int|0
)paren
suffix:semicolon
multiline_comment|/* ----------------------------------------------------------------&n;    Look for XLOG request (cards with indirect addressing)&n;    ---------------------------------------------------------------- */
r_if
c_cond
(paren
id|IoAdapter-&gt;pcm_pending
)paren
(brace
r_struct
id|pc_maint
op_star
id|pcm
suffix:semicolon
id|diva_os_spin_lock_magic_t
id|OldIrql
suffix:semicolon
id|diva_os_enter_spin_lock
(paren
op_amp
id|IoAdapter-&gt;data_spin_lock
comma
op_amp
id|OldIrql
comma
l_string|&quot;data_dpc&quot;
)paren
suffix:semicolon
id|pcm
op_assign
(paren
r_struct
id|pc_maint
op_star
)paren
id|IoAdapter-&gt;pcm_data
suffix:semicolon
r_switch
c_cond
(paren
id|IoAdapter-&gt;pcm_pending
)paren
(brace
r_case
l_int|1
suffix:colon
multiline_comment|/* ask card for XLOG */
id|a-&gt;ram_out
(paren
id|a
comma
op_amp
id|IoAdapter-&gt;pcm-&gt;rc
comma
l_int|0
)paren
suffix:semicolon
id|a-&gt;ram_out
(paren
id|a
comma
op_amp
id|IoAdapter-&gt;pcm-&gt;req
comma
id|pcm-&gt;req
)paren
suffix:semicolon
id|IoAdapter-&gt;pcm_pending
op_assign
l_int|2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
multiline_comment|/* Try to get XLOG from the card */
r_if
c_cond
(paren
(paren
r_int
)paren
(paren
id|a-&gt;ram_in
(paren
id|a
comma
op_amp
id|IoAdapter-&gt;pcm-&gt;rc
)paren
)paren
)paren
(brace
id|a-&gt;ram_in_buffer
(paren
id|a
comma
id|IoAdapter-&gt;pcm
comma
id|pcm
comma
r_sizeof
(paren
op_star
id|pcm
)paren
)paren
suffix:semicolon
id|IoAdapter-&gt;pcm_pending
op_assign
l_int|3
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
multiline_comment|/* let XDI recovery XLOG */
r_break
suffix:semicolon
)brace
id|diva_os_leave_spin_lock
(paren
op_amp
id|IoAdapter-&gt;data_spin_lock
comma
op_amp
id|OldIrql
comma
l_string|&quot;data_dpc&quot;
)paren
suffix:semicolon
)brace
multiline_comment|/* ---------------------------------------------------------------- */
)brace
)brace
multiline_comment|/* --------------------------------------------------------------------------&n;  XLOG interface&n;  -------------------------------------------------------------------------- */
r_void
DECL|function|pcm_req
id|pcm_req
(paren
id|PISDN_ADAPTER
id|IoAdapter
comma
id|ENTITY
op_star
id|e
)paren
(brace
id|diva_os_spin_lock_magic_t
id|OldIrql
suffix:semicolon
r_int
id|i
comma
id|rc
suffix:semicolon
id|ADAPTER
op_star
id|a
op_assign
op_amp
id|IoAdapter-&gt;a
suffix:semicolon
r_struct
id|pc_maint
op_star
id|pcm
op_assign
(paren
r_struct
id|pc_maint
op_star
)paren
op_amp
id|e-&gt;Ind
suffix:semicolon
multiline_comment|/*&n; * special handling of I/O based card interface&n; * the memory access isn&squot;t an atomic operation !&n; */
r_if
c_cond
(paren
id|IoAdapter-&gt;Properties.Card
op_eq
id|CARD_MAE
)paren
(brace
id|diva_os_enter_spin_lock
(paren
op_amp
id|IoAdapter-&gt;data_spin_lock
comma
op_amp
id|OldIrql
comma
l_string|&quot;data_pcm_1&quot;
)paren
suffix:semicolon
id|IoAdapter-&gt;pcm_data
op_assign
(paren
r_int
r_int
)paren
id|pcm
suffix:semicolon
id|IoAdapter-&gt;pcm_pending
op_assign
l_int|1
suffix:semicolon
id|diva_os_schedule_soft_isr
(paren
op_amp
id|IoAdapter-&gt;req_soft_isr
)paren
suffix:semicolon
id|diva_os_leave_spin_lock
(paren
op_amp
id|IoAdapter-&gt;data_spin_lock
comma
op_amp
id|OldIrql
comma
l_string|&quot;data_pcm_1&quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|rc
op_assign
l_int|0
comma
id|i
op_assign
(paren
id|IoAdapter-&gt;trapped
ques
c_cond
l_int|3000
suffix:colon
l_int|250
)paren
suffix:semicolon
op_logical_neg
id|rc
op_logical_and
(paren
id|i
OG
l_int|0
)paren
suffix:semicolon
op_decrement
id|i
)paren
(brace
id|diva_os_sleep
(paren
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|IoAdapter-&gt;pcm_pending
op_eq
l_int|3
)paren
(brace
id|diva_os_enter_spin_lock
(paren
op_amp
id|IoAdapter-&gt;data_spin_lock
comma
op_amp
id|OldIrql
comma
l_string|&quot;data_pcm_3&quot;
)paren
suffix:semicolon
id|IoAdapter-&gt;pcm_pending
op_assign
l_int|0
suffix:semicolon
id|IoAdapter-&gt;pcm_data
op_assign
l_int|0
suffix:semicolon
id|diva_os_leave_spin_lock
(paren
op_amp
id|IoAdapter-&gt;data_spin_lock
comma
op_amp
id|OldIrql
comma
l_string|&quot;data_pcm_3&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|diva_os_enter_spin_lock
(paren
op_amp
id|IoAdapter-&gt;data_spin_lock
comma
op_amp
id|OldIrql
comma
l_string|&quot;data_pcm_2&quot;
)paren
suffix:semicolon
id|diva_os_schedule_soft_isr
(paren
op_amp
id|IoAdapter-&gt;req_soft_isr
)paren
suffix:semicolon
id|diva_os_leave_spin_lock
(paren
op_amp
id|IoAdapter-&gt;data_spin_lock
comma
op_amp
id|OldIrql
comma
l_string|&quot;data_pcm_2&quot;
)paren
suffix:semicolon
)brace
id|diva_os_enter_spin_lock
(paren
op_amp
id|IoAdapter-&gt;data_spin_lock
comma
op_amp
id|OldIrql
comma
l_string|&quot;data_pcm_4&quot;
)paren
suffix:semicolon
id|IoAdapter-&gt;pcm_pending
op_assign
l_int|0
suffix:semicolon
id|IoAdapter-&gt;pcm_data
op_assign
l_int|0
suffix:semicolon
id|diva_os_leave_spin_lock
(paren
op_amp
id|IoAdapter-&gt;data_spin_lock
comma
op_amp
id|OldIrql
comma
l_string|&quot;data_pcm_4&quot;
)paren
suffix:semicolon
r_goto
id|Trapped
suffix:semicolon
)brace
multiline_comment|/*&n; * memory based shared ram is accessible from different&n; * processors without disturbing concurrent processes.&n; */
id|a-&gt;ram_out
(paren
id|a
comma
op_amp
id|IoAdapter-&gt;pcm-&gt;rc
comma
l_int|0
)paren
suffix:semicolon
id|a-&gt;ram_out
(paren
id|a
comma
op_amp
id|IoAdapter-&gt;pcm-&gt;req
comma
id|pcm-&gt;req
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
(paren
id|IoAdapter-&gt;trapped
ques
c_cond
l_int|3000
suffix:colon
l_int|250
)paren
suffix:semicolon
op_decrement
id|i
OG
l_int|0
suffix:semicolon
)paren
(brace
id|diva_os_sleep
(paren
l_int|1
)paren
suffix:semicolon
id|rc
op_assign
(paren
r_int
)paren
(paren
id|a-&gt;ram_in
(paren
id|a
comma
op_amp
id|IoAdapter-&gt;pcm-&gt;rc
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rc
)paren
(brace
id|a-&gt;ram_in_buffer
(paren
id|a
comma
id|IoAdapter-&gt;pcm
comma
id|pcm
comma
r_sizeof
(paren
op_star
id|pcm
)paren
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
)brace
id|Trapped
suffix:colon
r_if
c_cond
(paren
id|IoAdapter-&gt;trapFnc
)paren
(brace
r_int
id|trapped
op_assign
id|IoAdapter-&gt;trapped
suffix:semicolon
id|IoAdapter-&gt;trapFnc
(paren
id|IoAdapter
)paren
suffix:semicolon
multiline_comment|/*&n;      Firs trap, also notify user if supported&n;     */
r_if
c_cond
(paren
op_logical_neg
id|trapped
op_logical_and
id|IoAdapter-&gt;trapped
op_logical_and
id|IoAdapter-&gt;os_trap_nfy_Fnc
)paren
(brace
(paren
op_star
(paren
id|IoAdapter-&gt;os_trap_nfy_Fnc
)paren
)paren
(paren
id|IoAdapter
comma
id|IoAdapter-&gt;ANum
)paren
suffix:semicolon
)brace
)brace
)brace
multiline_comment|/*------------------------------------------------------------------*/
multiline_comment|/* ram access functions for memory mapped cards                     */
multiline_comment|/*------------------------------------------------------------------*/
DECL|function|mem_in
id|byte
id|mem_in
(paren
id|ADAPTER
op_star
id|a
comma
r_void
op_star
id|addr
)paren
(brace
id|byte
op_star
id|Base
op_assign
(paren
id|byte
op_star
)paren
op_amp
(paren
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
)paren
op_member_access_from_pointer
id|ram
(braket
(paren
r_int
r_int
)paren
id|addr
)braket
suffix:semicolon
r_return
(paren
op_star
id|Base
)paren
suffix:semicolon
)brace
DECL|function|mem_inw
id|word
id|mem_inw
(paren
id|ADAPTER
op_star
id|a
comma
r_void
op_star
id|addr
)paren
(brace
id|word
op_star
id|Base
op_assign
(paren
id|word
op_star
)paren
op_amp
(paren
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
)paren
op_member_access_from_pointer
id|ram
(braket
(paren
r_int
r_int
)paren
id|addr
)braket
suffix:semicolon
r_return
(paren
id|READ_WORD
c_func
(paren
id|Base
)paren
)paren
suffix:semicolon
)brace
DECL|function|mem_in_dw
r_void
id|mem_in_dw
(paren
id|ADAPTER
op_star
id|a
comma
r_void
op_star
id|addr
comma
id|dword
op_star
id|data
comma
r_int
id|dwords
)paren
(brace
r_volatile
id|dword
op_star
id|Base
op_assign
(paren
id|dword
op_star
)paren
op_amp
(paren
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
)paren
op_member_access_from_pointer
id|ram
(braket
(paren
r_int
r_int
)paren
id|addr
)braket
suffix:semicolon
r_while
c_loop
(paren
id|dwords
op_decrement
)paren
(brace
op_star
id|data
op_increment
op_assign
id|READ_DWORD
c_func
(paren
id|Base
)paren
suffix:semicolon
id|Base
op_increment
suffix:semicolon
)brace
)brace
DECL|function|mem_in_buffer
r_void
id|mem_in_buffer
(paren
id|ADAPTER
op_star
id|a
comma
r_void
op_star
id|addr
comma
r_void
op_star
id|buffer
comma
id|word
id|length
)paren
(brace
id|byte
op_star
id|Base
op_assign
(paren
id|byte
op_star
)paren
op_amp
(paren
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
)paren
op_member_access_from_pointer
id|ram
(braket
(paren
r_int
r_int
)paren
id|addr
)braket
suffix:semicolon
id|memcpy
(paren
id|buffer
comma
id|Base
comma
id|length
)paren
suffix:semicolon
)brace
DECL|function|mem_look_ahead
r_void
id|mem_look_ahead
(paren
id|ADAPTER
op_star
id|a
comma
id|PBUFFER
op_star
id|RBuffer
comma
id|ENTITY
op_star
id|e
)paren
(brace
id|PISDN_ADAPTER
id|IoAdapter
op_assign
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
suffix:semicolon
id|IoAdapter-&gt;RBuffer.length
op_assign
id|mem_inw
(paren
id|a
comma
op_amp
id|RBuffer-&gt;length
)paren
suffix:semicolon
id|mem_in_buffer
(paren
id|a
comma
id|RBuffer-&gt;P
comma
id|IoAdapter-&gt;RBuffer.P
comma
id|IoAdapter-&gt;RBuffer.length
)paren
suffix:semicolon
id|e-&gt;RBuffer
op_assign
(paren
id|DBUFFER
op_star
)paren
op_amp
id|IoAdapter-&gt;RBuffer
suffix:semicolon
)brace
DECL|function|mem_out
r_void
id|mem_out
(paren
id|ADAPTER
op_star
id|a
comma
r_void
op_star
id|addr
comma
id|byte
id|data
)paren
(brace
id|byte
op_star
id|Base
op_assign
(paren
id|byte
op_star
)paren
op_amp
(paren
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
)paren
op_member_access_from_pointer
id|ram
(braket
(paren
r_int
r_int
)paren
id|addr
)braket
suffix:semicolon
op_star
id|Base
op_assign
id|data
suffix:semicolon
)brace
DECL|function|mem_outw
r_void
id|mem_outw
(paren
id|ADAPTER
op_star
id|a
comma
r_void
op_star
id|addr
comma
id|word
id|data
)paren
(brace
id|word
op_star
id|Base
op_assign
(paren
id|word
op_star
)paren
op_amp
(paren
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
)paren
op_member_access_from_pointer
id|ram
(braket
(paren
r_int
r_int
)paren
id|addr
)braket
suffix:semicolon
id|WRITE_WORD
c_func
(paren
id|Base
comma
id|data
)paren
suffix:semicolon
)brace
DECL|function|mem_out_dw
r_void
id|mem_out_dw
(paren
id|ADAPTER
op_star
id|a
comma
r_void
op_star
id|addr
comma
r_const
id|dword
op_star
id|data
comma
r_int
id|dwords
)paren
(brace
r_volatile
id|dword
op_star
id|Base
op_assign
(paren
id|dword
op_star
)paren
op_amp
(paren
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
)paren
op_member_access_from_pointer
id|ram
(braket
(paren
r_int
r_int
)paren
id|addr
)braket
suffix:semicolon
r_while
c_loop
(paren
id|dwords
op_decrement
)paren
(brace
id|WRITE_DWORD
c_func
(paren
id|Base
comma
op_star
id|data
)paren
suffix:semicolon
id|Base
op_increment
suffix:semicolon
id|data
op_increment
suffix:semicolon
)brace
)brace
DECL|function|mem_out_buffer
r_void
id|mem_out_buffer
(paren
id|ADAPTER
op_star
id|a
comma
r_void
op_star
id|addr
comma
r_void
op_star
id|buffer
comma
id|word
id|length
)paren
(brace
id|byte
op_star
id|Base
op_assign
(paren
id|byte
op_star
)paren
op_amp
(paren
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
)paren
op_member_access_from_pointer
id|ram
(braket
(paren
r_int
r_int
)paren
id|addr
)braket
suffix:semicolon
id|memcpy
(paren
id|Base
comma
id|buffer
comma
id|length
)paren
suffix:semicolon
)brace
DECL|function|mem_inc
r_void
id|mem_inc
(paren
id|ADAPTER
op_star
id|a
comma
r_void
op_star
id|addr
)paren
(brace
id|byte
op_star
id|Base
op_assign
(paren
id|byte
op_star
)paren
op_amp
(paren
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
)paren
op_member_access_from_pointer
id|ram
(braket
(paren
r_int
r_int
)paren
id|addr
)braket
suffix:semicolon
id|byte
id|x
op_assign
op_star
id|Base
suffix:semicolon
op_star
id|Base
op_assign
id|x
op_plus
l_int|1
suffix:semicolon
)brace
multiline_comment|/*------------------------------------------------------------------*/
multiline_comment|/* ram access functions for io-mapped cards                         */
multiline_comment|/*------------------------------------------------------------------*/
DECL|function|io_in
id|byte
id|io_in
c_func
(paren
id|ADAPTER
op_star
id|a
comma
r_void
op_star
id|adr
)paren
(brace
id|outppw
c_func
(paren
(paren
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
)paren
op_member_access_from_pointer
id|port
op_plus
l_int|4
comma
(paren
id|word
)paren
(paren
r_int
r_int
)paren
id|adr
)paren
suffix:semicolon
r_return
id|inpp
c_func
(paren
(paren
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
)paren
op_member_access_from_pointer
id|port
)paren
suffix:semicolon
)brace
DECL|function|io_inw
id|word
id|io_inw
c_func
(paren
id|ADAPTER
op_star
id|a
comma
r_void
op_star
id|adr
)paren
(brace
id|outppw
c_func
(paren
(paren
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
)paren
op_member_access_from_pointer
id|port
op_plus
l_int|4
comma
(paren
id|word
)paren
(paren
r_int
r_int
)paren
id|adr
)paren
suffix:semicolon
r_return
id|inppw
c_func
(paren
(paren
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
)paren
op_member_access_from_pointer
id|port
)paren
suffix:semicolon
)brace
DECL|function|io_in_buffer
r_void
id|io_in_buffer
c_func
(paren
id|ADAPTER
op_star
id|a
comma
r_void
op_star
id|adr
comma
r_void
op_star
id|buffer
comma
id|word
id|len
)paren
(brace
id|byte
op_star
id|P
op_assign
(paren
id|byte
op_star
)paren
id|buffer
suffix:semicolon
r_if
c_cond
(paren
(paren
r_int
)paren
id|adr
op_amp
l_int|1
)paren
(brace
id|outppw
c_func
(paren
(paren
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
)paren
op_member_access_from_pointer
id|port
op_plus
l_int|4
comma
(paren
id|word
)paren
(paren
r_int
r_int
)paren
id|adr
)paren
suffix:semicolon
op_star
id|P
op_assign
id|inpp
c_func
(paren
(paren
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
)paren
op_member_access_from_pointer
id|port
)paren
suffix:semicolon
id|P
op_increment
suffix:semicolon
id|adr
op_assign
(paren
(paren
id|byte
op_star
)paren
id|adr
)paren
op_plus
l_int|1
suffix:semicolon
id|len
op_decrement
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|len
)paren
r_return
suffix:semicolon
)brace
id|outppw
c_func
(paren
(paren
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
)paren
op_member_access_from_pointer
id|port
op_plus
l_int|4
comma
(paren
id|word
)paren
(paren
r_int
r_int
)paren
id|adr
)paren
suffix:semicolon
id|inppw_buffer
(paren
(paren
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
)paren
op_member_access_from_pointer
id|port
comma
id|P
comma
id|len
op_plus
l_int|1
)paren
suffix:semicolon
)brace
DECL|function|io_look_ahead
r_void
id|io_look_ahead
c_func
(paren
id|ADAPTER
op_star
id|a
comma
id|PBUFFER
op_star
id|RBuffer
comma
id|ENTITY
op_star
id|e
)paren
(brace
id|outppw
c_func
(paren
(paren
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
)paren
op_member_access_from_pointer
id|port
op_plus
l_int|4
comma
(paren
id|word
)paren
(paren
r_int
r_int
)paren
id|RBuffer
)paren
suffix:semicolon
(paren
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
)paren
op_member_access_from_pointer
id|RBuffer.length
op_assign
id|inppw
c_func
(paren
(paren
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
)paren
op_member_access_from_pointer
id|port
)paren
suffix:semicolon
id|inppw_buffer
(paren
(paren
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
)paren
op_member_access_from_pointer
id|port
comma
(paren
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
)paren
op_member_access_from_pointer
id|RBuffer.P
comma
(paren
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
)paren
op_member_access_from_pointer
id|RBuffer.length
op_plus
l_int|1
)paren
suffix:semicolon
id|e-&gt;RBuffer
op_assign
(paren
id|DBUFFER
op_star
)paren
op_amp
(paren
(paren
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
)paren
op_member_access_from_pointer
id|RBuffer
)paren
suffix:semicolon
)brace
DECL|function|io_out
r_void
id|io_out
c_func
(paren
id|ADAPTER
op_star
id|a
comma
r_void
op_star
id|adr
comma
id|byte
id|data
)paren
(brace
id|outppw
c_func
(paren
(paren
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
)paren
op_member_access_from_pointer
id|port
op_plus
l_int|4
comma
(paren
id|word
)paren
(paren
r_int
r_int
)paren
id|adr
)paren
suffix:semicolon
id|outpp
c_func
(paren
(paren
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
)paren
op_member_access_from_pointer
id|port
comma
id|data
)paren
suffix:semicolon
)brace
DECL|function|io_outw
r_void
id|io_outw
c_func
(paren
id|ADAPTER
op_star
id|a
comma
r_void
op_star
id|adr
comma
id|word
id|data
)paren
(brace
id|outppw
c_func
(paren
(paren
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
)paren
op_member_access_from_pointer
id|port
op_plus
l_int|4
comma
(paren
id|word
)paren
(paren
r_int
r_int
)paren
id|adr
)paren
suffix:semicolon
id|outppw
c_func
(paren
(paren
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
)paren
op_member_access_from_pointer
id|port
comma
id|data
)paren
suffix:semicolon
)brace
DECL|function|io_out_buffer
r_void
id|io_out_buffer
c_func
(paren
id|ADAPTER
op_star
id|a
comma
r_void
op_star
id|adr
comma
r_void
op_star
id|buffer
comma
id|word
id|len
)paren
(brace
id|byte
op_star
id|P
op_assign
(paren
id|byte
op_star
)paren
id|buffer
suffix:semicolon
r_if
c_cond
(paren
(paren
r_int
)paren
id|adr
op_amp
l_int|1
)paren
(brace
id|outppw
c_func
(paren
(paren
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
)paren
op_member_access_from_pointer
id|port
op_plus
l_int|4
comma
(paren
id|word
)paren
(paren
r_int
r_int
)paren
id|adr
)paren
suffix:semicolon
id|outpp
c_func
(paren
(paren
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
)paren
op_member_access_from_pointer
id|port
comma
op_star
id|P
)paren
suffix:semicolon
id|P
op_increment
suffix:semicolon
id|adr
op_assign
(paren
(paren
id|byte
op_star
)paren
id|adr
)paren
op_plus
l_int|1
suffix:semicolon
id|len
op_decrement
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|len
)paren
r_return
suffix:semicolon
)brace
id|outppw
c_func
(paren
(paren
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
)paren
op_member_access_from_pointer
id|port
op_plus
l_int|4
comma
(paren
id|word
)paren
(paren
r_int
r_int
)paren
id|adr
)paren
suffix:semicolon
id|outppw_buffer
(paren
(paren
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
)paren
op_member_access_from_pointer
id|port
comma
id|P
comma
id|len
op_plus
l_int|1
)paren
suffix:semicolon
)brace
DECL|function|io_inc
r_void
id|io_inc
c_func
(paren
id|ADAPTER
op_star
id|a
comma
r_void
op_star
id|adr
)paren
(brace
id|byte
id|x
suffix:semicolon
id|outppw
c_func
(paren
(paren
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
)paren
op_member_access_from_pointer
id|port
op_plus
l_int|4
comma
(paren
id|word
)paren
(paren
r_int
r_int
)paren
id|adr
)paren
suffix:semicolon
id|x
op_assign
id|inpp
c_func
(paren
(paren
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
)paren
op_member_access_from_pointer
id|port
)paren
suffix:semicolon
id|outppw
c_func
(paren
(paren
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
)paren
op_member_access_from_pointer
id|port
op_plus
l_int|4
comma
(paren
id|word
)paren
(paren
r_int
r_int
)paren
id|adr
)paren
suffix:semicolon
id|outpp
c_func
(paren
(paren
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
)paren
op_member_access_from_pointer
id|port
comma
id|x
op_plus
l_int|1
)paren
suffix:semicolon
)brace
multiline_comment|/*------------------------------------------------------------------*/
multiline_comment|/* OS specific functions related to queuing of entities             */
multiline_comment|/*------------------------------------------------------------------*/
DECL|function|free_entity
r_void
id|free_entity
c_func
(paren
id|ADAPTER
op_star
id|a
comma
id|byte
id|e_no
)paren
(brace
id|PISDN_ADAPTER
id|IoAdapter
suffix:semicolon
id|diva_os_spin_lock_magic_t
id|irql
suffix:semicolon
id|IoAdapter
op_assign
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
suffix:semicolon
id|diva_os_enter_spin_lock
(paren
op_amp
id|IoAdapter-&gt;data_spin_lock
comma
op_amp
id|irql
comma
l_string|&quot;data_free&quot;
)paren
suffix:semicolon
id|IoAdapter-&gt;e_tbl
(braket
id|e_no
)braket
dot
id|e
op_assign
l_int|NULL
suffix:semicolon
id|IoAdapter-&gt;e_count
op_decrement
suffix:semicolon
id|diva_os_leave_spin_lock
(paren
op_amp
id|IoAdapter-&gt;data_spin_lock
comma
op_amp
id|irql
comma
l_string|&quot;data_free&quot;
)paren
suffix:semicolon
)brace
DECL|function|assign_queue
r_void
id|assign_queue
c_func
(paren
id|ADAPTER
op_star
id|a
comma
id|byte
id|e_no
comma
id|word
id|ref
)paren
(brace
id|PISDN_ADAPTER
id|IoAdapter
suffix:semicolon
id|diva_os_spin_lock_magic_t
id|irql
suffix:semicolon
id|IoAdapter
op_assign
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
suffix:semicolon
id|diva_os_enter_spin_lock
(paren
op_amp
id|IoAdapter-&gt;data_spin_lock
comma
op_amp
id|irql
comma
l_string|&quot;data_assign&quot;
)paren
suffix:semicolon
id|IoAdapter-&gt;e_tbl
(braket
id|e_no
)braket
dot
id|assign_ref
op_assign
id|ref
suffix:semicolon
id|IoAdapter-&gt;e_tbl
(braket
id|e_no
)braket
dot
id|next
op_assign
(paren
id|byte
)paren
id|IoAdapter-&gt;assign
suffix:semicolon
id|IoAdapter-&gt;assign
op_assign
id|e_no
suffix:semicolon
id|diva_os_leave_spin_lock
(paren
op_amp
id|IoAdapter-&gt;data_spin_lock
comma
op_amp
id|irql
comma
l_string|&quot;data_assign&quot;
)paren
suffix:semicolon
)brace
DECL|function|get_assign
id|byte
id|get_assign
c_func
(paren
id|ADAPTER
op_star
id|a
comma
id|word
id|ref
)paren
(brace
id|PISDN_ADAPTER
id|IoAdapter
suffix:semicolon
id|diva_os_spin_lock_magic_t
id|irql
suffix:semicolon
id|byte
id|e_no
suffix:semicolon
id|IoAdapter
op_assign
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
suffix:semicolon
id|diva_os_enter_spin_lock
(paren
op_amp
id|IoAdapter-&gt;data_spin_lock
comma
op_amp
id|irql
comma
l_string|&quot;data_assign_get&quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|e_no
op_assign
(paren
id|byte
)paren
id|IoAdapter-&gt;assign
suffix:semicolon
id|e_no
op_logical_and
id|IoAdapter-&gt;e_tbl
(braket
id|e_no
)braket
dot
id|assign_ref
op_ne
id|ref
suffix:semicolon
id|e_no
op_assign
id|IoAdapter-&gt;e_tbl
(braket
id|e_no
)braket
dot
id|next
)paren
(brace
suffix:semicolon
)brace
id|diva_os_leave_spin_lock
(paren
op_amp
id|IoAdapter-&gt;data_spin_lock
comma
op_amp
id|irql
comma
l_string|&quot;data_assign_get&quot;
)paren
suffix:semicolon
r_return
id|e_no
suffix:semicolon
)brace
DECL|function|req_queue
r_void
id|req_queue
c_func
(paren
id|ADAPTER
op_star
id|a
comma
id|byte
id|e_no
)paren
(brace
id|PISDN_ADAPTER
id|IoAdapter
suffix:semicolon
id|diva_os_spin_lock_magic_t
id|irql
suffix:semicolon
id|IoAdapter
op_assign
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
suffix:semicolon
id|diva_os_enter_spin_lock
(paren
op_amp
id|IoAdapter-&gt;data_spin_lock
comma
op_amp
id|irql
comma
l_string|&quot;data_req_q&quot;
)paren
suffix:semicolon
id|IoAdapter-&gt;e_tbl
(braket
id|e_no
)braket
dot
id|next
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|IoAdapter-&gt;head
)paren
(brace
id|IoAdapter-&gt;e_tbl
(braket
id|IoAdapter-&gt;tail
)braket
dot
id|next
op_assign
id|e_no
suffix:semicolon
id|IoAdapter-&gt;tail
op_assign
id|e_no
suffix:semicolon
)brace
r_else
(brace
id|IoAdapter-&gt;head
op_assign
id|e_no
suffix:semicolon
id|IoAdapter-&gt;tail
op_assign
id|e_no
suffix:semicolon
)brace
id|diva_os_leave_spin_lock
(paren
op_amp
id|IoAdapter-&gt;data_spin_lock
comma
op_amp
id|irql
comma
l_string|&quot;data_req_q&quot;
)paren
suffix:semicolon
)brace
DECL|function|look_req
id|byte
id|look_req
c_func
(paren
id|ADAPTER
op_star
id|a
)paren
(brace
id|PISDN_ADAPTER
id|IoAdapter
suffix:semicolon
id|IoAdapter
op_assign
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
suffix:semicolon
r_return
(paren
(paren
id|byte
)paren
id|IoAdapter-&gt;head
)paren
suffix:semicolon
)brace
DECL|function|next_req
r_void
id|next_req
c_func
(paren
id|ADAPTER
op_star
id|a
)paren
(brace
id|PISDN_ADAPTER
id|IoAdapter
suffix:semicolon
id|diva_os_spin_lock_magic_t
id|irql
suffix:semicolon
id|IoAdapter
op_assign
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
suffix:semicolon
id|diva_os_enter_spin_lock
(paren
op_amp
id|IoAdapter-&gt;data_spin_lock
comma
op_amp
id|irql
comma
l_string|&quot;data_req_next&quot;
)paren
suffix:semicolon
id|IoAdapter-&gt;head
op_assign
id|IoAdapter-&gt;e_tbl
(braket
id|IoAdapter-&gt;head
)braket
dot
id|next
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|IoAdapter-&gt;head
)paren
(brace
id|IoAdapter-&gt;tail
op_assign
l_int|0
suffix:semicolon
)brace
id|diva_os_leave_spin_lock
(paren
op_amp
id|IoAdapter-&gt;data_spin_lock
comma
op_amp
id|irql
comma
l_string|&quot;data_req_next&quot;
)paren
suffix:semicolon
)brace
multiline_comment|/*------------------------------------------------------------------*/
multiline_comment|/* memory map functions                                             */
multiline_comment|/*------------------------------------------------------------------*/
DECL|function|entity_ptr
id|ENTITY
op_star
id|entity_ptr
c_func
(paren
id|ADAPTER
op_star
id|a
comma
id|byte
id|e_no
)paren
(brace
id|PISDN_ADAPTER
id|IoAdapter
suffix:semicolon
id|IoAdapter
op_assign
(paren
id|PISDN_ADAPTER
)paren
id|a-&gt;io
suffix:semicolon
r_return
(paren
id|IoAdapter-&gt;e_tbl
(braket
id|e_no
)braket
dot
id|e
)paren
suffix:semicolon
)brace
DECL|function|PTR_X
r_void
op_star
id|PTR_X
c_func
(paren
id|ADAPTER
op_star
id|a
comma
id|ENTITY
op_star
id|e
)paren
(brace
r_return
(paren
(paren
r_void
op_star
)paren
id|e-&gt;X
)paren
suffix:semicolon
)brace
DECL|function|PTR_R
r_void
op_star
id|PTR_R
c_func
(paren
id|ADAPTER
op_star
id|a
comma
id|ENTITY
op_star
id|e
)paren
(brace
r_return
(paren
(paren
r_void
op_star
)paren
id|e-&gt;R
)paren
suffix:semicolon
)brace
DECL|function|PTR_P
r_void
op_star
id|PTR_P
c_func
(paren
id|ADAPTER
op_star
id|a
comma
id|ENTITY
op_star
id|e
comma
r_void
op_star
id|P
)paren
(brace
r_return
id|P
suffix:semicolon
)brace
DECL|function|CALLBACK
r_void
id|CALLBACK
c_func
(paren
id|ADAPTER
op_star
id|a
comma
id|ENTITY
op_star
id|e
)paren
(brace
r_if
c_cond
(paren
id|e
op_logical_and
id|e-&gt;callback
)paren
id|e-&gt;callback
(paren
id|e
)paren
suffix:semicolon
)brace
multiline_comment|/* --------------------------------------------------------------------------&n;  routines for aligned reading and writing on RISC&n;  -------------------------------------------------------------------------- */
DECL|function|outp_words_from_buffer
r_void
id|outp_words_from_buffer
(paren
id|word
op_star
id|adr
comma
id|byte
op_star
id|P
comma
id|word
id|len
)paren
(brace
id|word
id|i
op_assign
l_int|0
suffix:semicolon
id|word
id|w
suffix:semicolon
r_while
c_loop
(paren
id|i
OL
(paren
id|len
op_amp
l_int|0xfffe
)paren
)paren
(brace
id|w
op_assign
id|P
(braket
id|i
op_increment
)braket
suffix:semicolon
id|w
op_add_assign
(paren
id|P
(braket
id|i
op_increment
)braket
)paren
op_lshift
l_int|8
suffix:semicolon
id|outppw
(paren
id|adr
comma
id|w
)paren
suffix:semicolon
)brace
)brace
DECL|function|inp_words_to_buffer
r_void
id|inp_words_to_buffer
(paren
id|word
op_star
id|adr
comma
id|byte
op_star
id|P
comma
id|word
id|len
)paren
(brace
id|word
id|i
op_assign
l_int|0
suffix:semicolon
id|word
id|w
suffix:semicolon
r_while
c_loop
(paren
id|i
OL
(paren
id|len
op_amp
l_int|0xfffe
)paren
)paren
(brace
id|w
op_assign
id|inppw
(paren
id|adr
)paren
suffix:semicolon
id|P
(braket
id|i
op_increment
)braket
op_assign
(paren
id|byte
)paren
(paren
id|w
)paren
suffix:semicolon
id|P
(braket
id|i
op_increment
)braket
op_assign
(paren
id|byte
)paren
(paren
id|w
op_rshift
l_int|8
)paren
suffix:semicolon
)brace
)brace
eof
