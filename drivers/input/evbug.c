multiline_comment|/*&n; * $Id: evbug.c,v 1.10 2001/09/25 10:12:07 vojtech Exp $&n; *&n; *  Copyright (c) 1999-2001 Vojtech Pavlik&n; */
multiline_comment|/*&n; *  Input driver event debug module - dumps all events into syslog&n; */
multiline_comment|/*&n; * This program is free software; you can redistribute it and/or modify&n; * it under the terms of the GNU General Public License as published by&n; * the Free Software Foundation; either version 2 of the License, or &n; * (at your option) any later version.&n; * &n; * This program is distributed in the hope that it will be useful,&n; * but WITHOUT ANY WARRANTY; without even the implied warranty of&n; * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; * GNU General Public License for more details.&n; * &n; * You should have received a copy of the GNU General Public License&n; * along with this program; if not, write to the Free Software&n; * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA&n; * &n; * Should you need to contact me, the author, you can do so either by&n; * e-mail - mail your message to &lt;vojtech@ucw.cz&gt;, or by paper mail:&n; * Vojtech Pavlik, Simunkova 1594, Prague 8, 182 00 Czech Republic&n; */
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/input.h&gt;
macro_line|#include &lt;linux/init.h&gt;
id|MODULE_AUTHOR
c_func
(paren
l_string|&quot;Vojtech Pavlik &lt;vojtech@ucw.cz&gt;&quot;
)paren
suffix:semicolon
id|MODULE_DESCRIPTION
c_func
(paren
l_string|&quot;Input driver event debug module&quot;
)paren
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
DECL|variable|evbug_name
r_static
r_char
id|evbug_name
(braket
)braket
op_assign
l_string|&quot;evbug&quot;
suffix:semicolon
DECL|function|evbug_event
r_static
r_void
id|evbug_event
c_func
(paren
r_struct
id|input_handle
op_star
id|handle
comma
r_int
r_int
id|type
comma
r_int
r_int
id|code
comma
r_int
id|value
)paren
(brace
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;evbug.c: Event. Dev: %s, Type: %d, Code: %d, Value: %d&bslash;n&quot;
comma
id|handle-&gt;dev-&gt;phys
comma
id|type
comma
id|code
comma
id|value
)paren
suffix:semicolon
)brace
DECL|function|evbug_connect
r_static
r_struct
id|input_handle
op_star
id|evbug_connect
c_func
(paren
r_struct
id|input_handler
op_star
id|handler
comma
r_struct
id|input_dev
op_star
id|dev
comma
r_struct
id|input_device_id
op_star
id|id
)paren
(brace
r_struct
id|input_handle
op_star
id|handle
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|handle
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|input_handle
)paren
comma
id|GFP_KERNEL
)paren
)paren
)paren
r_return
l_int|NULL
suffix:semicolon
id|memset
c_func
(paren
id|handle
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|input_handle
)paren
)paren
suffix:semicolon
id|handle-&gt;dev
op_assign
id|dev
suffix:semicolon
id|handle-&gt;handler
op_assign
id|handler
suffix:semicolon
id|handle-&gt;name
op_assign
id|evbug_name
suffix:semicolon
id|input_open_device
c_func
(paren
id|handle
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;evbug.c: Connected device: &bslash;&quot;%s&bslash;&quot;, %s&bslash;n&quot;
comma
id|dev-&gt;name
comma
id|dev-&gt;phys
)paren
suffix:semicolon
r_return
id|handle
suffix:semicolon
)brace
DECL|function|evbug_disconnect
r_static
r_void
id|evbug_disconnect
c_func
(paren
r_struct
id|input_handle
op_star
id|handle
)paren
(brace
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;evbug.c: Disconnected device: %s&bslash;n&quot;
comma
id|handle-&gt;dev-&gt;phys
)paren
suffix:semicolon
id|input_close_device
c_func
(paren
id|handle
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|handle
)paren
suffix:semicolon
)brace
DECL|variable|evbug_ids
r_static
r_struct
id|input_device_id
id|evbug_ids
(braket
)braket
op_assign
(brace
(brace
id|driver_info
suffix:colon
l_int|1
)brace
comma
multiline_comment|/* Matches all devices */
(brace
)brace
comma
multiline_comment|/* Terminating zero entry */
)brace
suffix:semicolon
id|MODULE_DEVICE_TABLE
c_func
(paren
id|input
comma
id|evbug_ids
)paren
suffix:semicolon
DECL|variable|evbug_handler
r_static
r_struct
id|input_handler
id|evbug_handler
op_assign
(brace
dot
id|event
op_assign
id|evbug_event
comma
dot
id|connect
op_assign
id|evbug_connect
comma
dot
id|disconnect
op_assign
id|evbug_disconnect
comma
dot
id|name
op_assign
l_string|&quot;evbug&quot;
comma
dot
id|id_table
op_assign
id|evbug_ids
comma
)brace
suffix:semicolon
DECL|function|evbug_init
r_int
id|__init
id|evbug_init
c_func
(paren
r_void
)paren
(brace
id|input_register_handler
c_func
(paren
op_amp
id|evbug_handler
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|evbug_exit
r_void
id|__exit
id|evbug_exit
c_func
(paren
r_void
)paren
(brace
id|input_unregister_handler
c_func
(paren
op_amp
id|evbug_handler
)paren
suffix:semicolon
)brace
DECL|variable|evbug_init
id|module_init
c_func
(paren
id|evbug_init
)paren
suffix:semicolon
DECL|variable|evbug_exit
id|module_exit
c_func
(paren
id|evbug_exit
)paren
suffix:semicolon
eof
