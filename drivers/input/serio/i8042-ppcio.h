macro_line|#ifndef _I8042_PPCIO_H
DECL|macro|_I8042_PPCIO_H
mdefine_line|#define _I8042_PPCIO_H
multiline_comment|/*&n; * This program is free software; you can redistribute it and/or modify it&n; * under the terms of the GNU General Public License version 2 as published by&n; * the Free Software Foundation.&n; */
macro_line|#if defined(CONFIG_WALNUT)
DECL|macro|I8042_KBD_IRQ
mdefine_line|#define I8042_KBD_IRQ 25
DECL|macro|I8042_AUX_IRQ
mdefine_line|#define I8042_AUX_IRQ 26
DECL|macro|I8042_KBD_PHYS_DESC
mdefine_line|#define I8042_KBD_PHYS_DESC &quot;walnutps2/serio0&quot;
DECL|macro|I8042_AUX_PHYS_DESC
mdefine_line|#define I8042_AUX_PHYS_DESC &quot;walnutps2/serio1&quot;
r_extern
r_void
op_star
id|kb_cs
suffix:semicolon
r_extern
r_void
op_star
id|kb_data
suffix:semicolon
DECL|macro|I8042_COMMAND_REG
mdefine_line|#define I8042_COMMAND_REG (*(int *)kb_cs)
DECL|macro|I8042_DATA_REG
mdefine_line|#define I8042_DATA_REG (*(int *)kb_data)
DECL|function|i8042_read_data
r_static
r_inline
r_int
id|i8042_read_data
c_func
(paren
r_void
)paren
(brace
r_return
id|readb
c_func
(paren
id|kb_data
)paren
suffix:semicolon
)brace
DECL|function|i8042_read_status
r_static
r_inline
r_int
id|i8042_read_status
c_func
(paren
r_void
)paren
(brace
r_return
id|readb
c_func
(paren
id|kb_cs
)paren
suffix:semicolon
)brace
DECL|function|i8042_write_data
r_static
r_inline
r_void
id|i8042_write_data
c_func
(paren
r_int
id|val
)paren
(brace
id|writeb
c_func
(paren
id|val
comma
id|kb_data
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
DECL|function|i8042_write_command
r_static
r_inline
r_void
id|i8042_write_command
c_func
(paren
r_int
id|val
)paren
(brace
id|writeb
c_func
(paren
id|val
comma
id|kb_cs
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
DECL|function|i8042_platform_init
r_static
r_inline
r_int
id|i8042_platform_init
c_func
(paren
r_void
)paren
(brace
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|i8042_platform_exit
r_static
r_inline
r_void
id|i8042_platform_exit
c_func
(paren
r_void
)paren
(brace
)brace
macro_line|#elif defined(CONFIG_SPRUCE)
DECL|macro|I8042_KBD_IRQ
mdefine_line|#define I8042_KBD_IRQ 22
DECL|macro|I8042_AUX_IRQ
mdefine_line|#define I8042_AUX_IRQ 21
DECL|macro|I8042_KBD_PHYS_DESC
mdefine_line|#define I8042_KBD_PHYS_DESC &quot;spruceps2/serio0&quot;
DECL|macro|I8042_AUX_PHYS_DESC
mdefine_line|#define I8042_AUX_PHYS_DESC &quot;spruceps2/serio1&quot;
DECL|macro|I8042_COMMAND_REG
mdefine_line|#define I8042_COMMAND_REG 0xff810000
DECL|macro|I8042_DATA_REG
mdefine_line|#define I8042_DATA_REG 0xff810001
DECL|function|i8042_read_data
r_static
r_inline
r_int
id|i8042_read_data
c_func
(paren
r_void
)paren
(brace
r_int
r_int
id|kbd_data
suffix:semicolon
id|__raw_writel
c_func
(paren
l_int|0x00000088
comma
l_int|0xff500008
)paren
suffix:semicolon
id|eieio
c_func
(paren
)paren
suffix:semicolon
id|__raw_writel
c_func
(paren
l_int|0x03000000
comma
l_int|0xff50000c
)paren
suffix:semicolon
id|eieio
c_func
(paren
)paren
suffix:semicolon
id|asm
r_volatile
(paren
l_string|&quot;lis     7,0xff88        &bslash;n&bslash;&n;&t;&t;      lswi    6,7,0x8         &bslash;n&bslash;&n;&t;&t;      mr      %0,6&quot;
suffix:colon
l_string|&quot;=r&quot;
(paren
id|kbd_data
)paren
op_scope_resolution
l_string|&quot;6&quot;
comma
l_string|&quot;7&quot;
)paren
suffix:semicolon
id|__raw_writel
c_func
(paren
l_int|0x00000000
comma
l_int|0xff50000c
)paren
suffix:semicolon
id|eieio
c_func
(paren
)paren
suffix:semicolon
r_return
(paren
r_int
r_char
)paren
(paren
id|kbd_data
op_rshift
l_int|24
)paren
suffix:semicolon
)brace
DECL|function|i8042_read_status
r_static
r_inline
r_int
id|i8042_read_status
c_func
(paren
r_void
)paren
(brace
r_int
r_int
id|kbd_status
suffix:semicolon
id|__raw_writel
c_func
(paren
l_int|0x00000088
comma
l_int|0xff500008
)paren
suffix:semicolon
id|eieio
c_func
(paren
)paren
suffix:semicolon
id|__raw_writel
c_func
(paren
l_int|0x03000000
comma
l_int|0xff50000c
)paren
suffix:semicolon
id|eieio
c_func
(paren
)paren
suffix:semicolon
id|asm
r_volatile
(paren
l_string|&quot;lis     7,0xff88        &bslash;n&bslash;&n;&t;&t;      ori     7,7,0x8         &bslash;n&bslash;&n;&t;&t;      lswi    6,7,0x8         &bslash;n&bslash;&n;&t;&t;      mr      %0,6&quot;
suffix:colon
l_string|&quot;=r&quot;
(paren
id|kbd_status
)paren
op_scope_resolution
l_string|&quot;6&quot;
comma
l_string|&quot;7&quot;
)paren
suffix:semicolon
id|__raw_writel
c_func
(paren
l_int|0x00000000
comma
l_int|0xff50000c
)paren
suffix:semicolon
id|eieio
c_func
(paren
)paren
suffix:semicolon
r_return
(paren
r_int
r_char
)paren
(paren
id|kbd_status
op_rshift
l_int|24
)paren
suffix:semicolon
)brace
DECL|function|i8042_write_data
r_static
r_inline
r_void
id|i8042_write_data
c_func
(paren
r_int
id|val
)paren
(brace
op_star
(paren
(paren
r_int
r_char
op_star
)paren
l_int|0xff810000
)paren
op_assign
(paren
r_char
)paren
id|val
suffix:semicolon
r_return
suffix:semicolon
)brace
DECL|function|i8042_write_command
r_static
r_inline
r_void
id|i8042_write_command
c_func
(paren
r_int
id|val
)paren
(brace
op_star
(paren
(paren
r_int
r_char
op_star
)paren
l_int|0xff810001
)paren
op_assign
(paren
r_char
)paren
id|val
suffix:semicolon
r_return
suffix:semicolon
)brace
DECL|function|i8042_platform_init
r_static
r_inline
r_int
id|i8042_platform_init
c_func
(paren
r_void
)paren
(brace
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|i8042_platform_exit
r_static
r_inline
r_void
id|i8042_platform_exit
c_func
(paren
r_void
)paren
(brace
)brace
macro_line|#else
macro_line|#include &quot;i8042-io.h&quot;
macro_line|#endif
macro_line|#endif /* _I8042_PPCIO_H */
eof
