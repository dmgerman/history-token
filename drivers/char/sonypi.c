multiline_comment|/*&n; * Sony Programmable I/O Control Device driver for VAIO&n; *&n; * Copyright (C) 2001-2004 Stelian Pop &lt;stelian@popies.net&gt;&n; *&n; * Copyright (C) 2001-2002 Alc&#xfffd;ve &lt;www.alcove.com&gt;&n; *&n; * Copyright (C) 2001 Michael Ashley &lt;m.ashley@unsw.edu.au&gt;&n; *&n; * Copyright (C) 2001 Junichi Morita &lt;jun1m@mars.dti.ne.jp&gt;&n; *&n; * Copyright (C) 2000 Takaya Kinjo &lt;t-kinjo@tc4.so-net.ne.jp&gt;&n; *&n; * Copyright (C) 2000 Andrew Tridgell &lt;tridge@valinux.com&gt;&n; *&n; * Earlier work by Werner Almesberger, Paul `Rusty&squot; Russell and Paul Mackerras.&n; *&n; * This program is free software; you can redistribute it and/or modify&n; * it under the terms of the GNU General Public License as published by&n; * the Free Software Foundation; either version 2 of the License, or&n; * (at your option) any later version.&n; *&n; * This program is distributed in the hope that it will be useful,&n; * but WITHOUT ANY WARRANTY; without even the implied warranty of&n; * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; * GNU General Public License for more details.&n; *&n; * You should have received a copy of the GNU General Public License&n; * along with this program; if not, write to the Free Software&n; * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.&n; *&n; */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/input.h&gt;
macro_line|#include &lt;linux/pci.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/interrupt.h&gt;
macro_line|#include &lt;linux/miscdevice.h&gt;
macro_line|#include &lt;linux/poll.h&gt;
macro_line|#include &lt;linux/delay.h&gt;
macro_line|#include &lt;linux/wait.h&gt;
macro_line|#include &lt;linux/acpi.h&gt;
macro_line|#include &lt;linux/dmi.h&gt;
macro_line|#include &lt;linux/err.h&gt;
macro_line|#include &lt;asm/uaccess.h&gt;
macro_line|#include &lt;asm/io.h&gt;
macro_line|#include &lt;asm/system.h&gt;
macro_line|#include &quot;sonypi.h&quot;
macro_line|#include &lt;linux/sonypi.h&gt;
id|MODULE_AUTHOR
c_func
(paren
l_string|&quot;Stelian Pop &lt;stelian@popies.net&gt;&quot;
)paren
suffix:semicolon
id|MODULE_DESCRIPTION
c_func
(paren
l_string|&quot;Sony Programmable I/O Control Device driver&quot;
)paren
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
DECL|variable|SONYPI_DRIVER_VERSION
id|MODULE_VERSION
c_func
(paren
id|SONYPI_DRIVER_VERSION
)paren
suffix:semicolon
DECL|variable|minor
r_static
r_int
id|minor
op_assign
op_minus
l_int|1
suffix:semicolon
id|module_param
c_func
(paren
id|minor
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|minor
comma
l_string|&quot;minor number of the misc device, default is -1 (automatic)&quot;
)paren
suffix:semicolon
DECL|variable|verbose
r_static
r_int
id|verbose
suffix:semicolon
multiline_comment|/* = 0 */
id|module_param
c_func
(paren
id|verbose
comma
r_int
comma
l_int|0644
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|verbose
comma
l_string|&quot;be verbose, default is 0 (no)&quot;
)paren
suffix:semicolon
DECL|variable|fnkeyinit
r_static
r_int
id|fnkeyinit
suffix:semicolon
multiline_comment|/* = 0 */
id|module_param
c_func
(paren
id|fnkeyinit
comma
r_int
comma
l_int|0444
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|fnkeyinit
comma
l_string|&quot;set this if your Fn keys do not generate any event&quot;
)paren
suffix:semicolon
DECL|variable|camera
r_static
r_int
id|camera
suffix:semicolon
multiline_comment|/* = 0 */
id|module_param
c_func
(paren
id|camera
comma
r_int
comma
l_int|0444
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|camera
comma
l_string|&quot;set this if you have a MotionEye camera (PictureBook series)&quot;
)paren
suffix:semicolon
DECL|variable|compat
r_static
r_int
id|compat
suffix:semicolon
multiline_comment|/* = 0 */
id|module_param
c_func
(paren
id|compat
comma
r_int
comma
l_int|0444
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|compat
comma
l_string|&quot;set this if you want to enable backward compatibility mode&quot;
)paren
suffix:semicolon
DECL|variable|mask
r_static
r_int
r_int
id|mask
op_assign
l_int|0xffffffff
suffix:semicolon
id|module_param
c_func
(paren
id|mask
comma
id|ulong
comma
l_int|0644
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|mask
comma
l_string|&quot;set this to the mask of event you want to enable (see doc)&quot;
)paren
suffix:semicolon
DECL|variable|useinput
r_static
r_int
id|useinput
op_assign
l_int|1
suffix:semicolon
id|module_param
c_func
(paren
id|useinput
comma
r_int
comma
l_int|0444
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|useinput
comma
l_string|&quot;set this if you would like sonypi to feed events to the input subsystem&quot;
)paren
suffix:semicolon
DECL|variable|sonypi_device
r_static
r_struct
id|sonypi_device
id|sonypi_device
suffix:semicolon
DECL|function|sonypi_ec_write
r_static
r_int
id|sonypi_ec_write
c_func
(paren
id|u8
id|addr
comma
id|u8
id|value
)paren
(brace
macro_line|#ifdef CONFIG_ACPI_EC
r_if
c_cond
(paren
id|SONYPI_ACPI_ACTIVE
)paren
r_return
id|ec_write
c_func
(paren
id|addr
comma
id|value
)paren
suffix:semicolon
macro_line|#endif
id|wait_on_command
c_func
(paren
l_int|1
comma
id|inb_p
c_func
(paren
id|SONYPI_CST_IOPORT
)paren
op_amp
l_int|3
comma
id|ITERATIONS_LONG
)paren
suffix:semicolon
id|outb_p
c_func
(paren
l_int|0x81
comma
id|SONYPI_CST_IOPORT
)paren
suffix:semicolon
id|wait_on_command
c_func
(paren
l_int|0
comma
id|inb_p
c_func
(paren
id|SONYPI_CST_IOPORT
)paren
op_amp
l_int|2
comma
id|ITERATIONS_LONG
)paren
suffix:semicolon
id|outb_p
c_func
(paren
id|addr
comma
id|SONYPI_DATA_IOPORT
)paren
suffix:semicolon
id|wait_on_command
c_func
(paren
l_int|0
comma
id|inb_p
c_func
(paren
id|SONYPI_CST_IOPORT
)paren
op_amp
l_int|2
comma
id|ITERATIONS_LONG
)paren
suffix:semicolon
id|outb_p
c_func
(paren
id|value
comma
id|SONYPI_DATA_IOPORT
)paren
suffix:semicolon
id|wait_on_command
c_func
(paren
l_int|0
comma
id|inb_p
c_func
(paren
id|SONYPI_CST_IOPORT
)paren
op_amp
l_int|2
comma
id|ITERATIONS_LONG
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|sonypi_ec_read
r_static
r_int
id|sonypi_ec_read
c_func
(paren
id|u8
id|addr
comma
id|u8
op_star
id|value
)paren
(brace
macro_line|#ifdef CONFIG_ACPI_EC
r_if
c_cond
(paren
id|SONYPI_ACPI_ACTIVE
)paren
r_return
id|ec_read
c_func
(paren
id|addr
comma
id|value
)paren
suffix:semicolon
macro_line|#endif
id|wait_on_command
c_func
(paren
l_int|1
comma
id|inb_p
c_func
(paren
id|SONYPI_CST_IOPORT
)paren
op_amp
l_int|3
comma
id|ITERATIONS_LONG
)paren
suffix:semicolon
id|outb_p
c_func
(paren
l_int|0x80
comma
id|SONYPI_CST_IOPORT
)paren
suffix:semicolon
id|wait_on_command
c_func
(paren
l_int|0
comma
id|inb_p
c_func
(paren
id|SONYPI_CST_IOPORT
)paren
op_amp
l_int|2
comma
id|ITERATIONS_LONG
)paren
suffix:semicolon
id|outb_p
c_func
(paren
id|addr
comma
id|SONYPI_DATA_IOPORT
)paren
suffix:semicolon
id|wait_on_command
c_func
(paren
l_int|0
comma
id|inb_p
c_func
(paren
id|SONYPI_CST_IOPORT
)paren
op_amp
l_int|2
comma
id|ITERATIONS_LONG
)paren
suffix:semicolon
op_star
id|value
op_assign
id|inb_p
c_func
(paren
id|SONYPI_DATA_IOPORT
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|ec_read16
r_static
r_int
id|ec_read16
c_func
(paren
id|u8
id|addr
comma
id|u16
op_star
id|value
)paren
(brace
id|u8
id|val_lb
comma
id|val_hb
suffix:semicolon
r_if
c_cond
(paren
id|sonypi_ec_read
c_func
(paren
id|addr
comma
op_amp
id|val_lb
)paren
)paren
r_return
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|sonypi_ec_read
c_func
(paren
id|addr
op_plus
l_int|1
comma
op_amp
id|val_hb
)paren
)paren
r_return
op_minus
l_int|1
suffix:semicolon
op_star
id|value
op_assign
id|val_lb
op_or
(paren
id|val_hb
op_lshift
l_int|8
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* Initializes the device - this comes from the AML code in the ACPI bios */
DECL|function|sonypi_type1_srs
r_static
r_void
id|sonypi_type1_srs
c_func
(paren
r_void
)paren
(brace
id|u32
id|v
suffix:semicolon
id|pci_read_config_dword
c_func
(paren
id|sonypi_device.dev
comma
id|SONYPI_G10A
comma
op_amp
id|v
)paren
suffix:semicolon
id|v
op_assign
(paren
id|v
op_amp
l_int|0xFFFF0000
)paren
op_or
(paren
(paren
id|u32
)paren
id|sonypi_device.ioport1
)paren
suffix:semicolon
id|pci_write_config_dword
c_func
(paren
id|sonypi_device.dev
comma
id|SONYPI_G10A
comma
id|v
)paren
suffix:semicolon
id|pci_read_config_dword
c_func
(paren
id|sonypi_device.dev
comma
id|SONYPI_G10A
comma
op_amp
id|v
)paren
suffix:semicolon
id|v
op_assign
(paren
id|v
op_amp
l_int|0xFFF0FFFF
)paren
op_or
(paren
(paren
(paren
id|u32
)paren
id|sonypi_device.ioport1
op_xor
id|sonypi_device.ioport2
)paren
op_lshift
l_int|16
)paren
suffix:semicolon
id|pci_write_config_dword
c_func
(paren
id|sonypi_device.dev
comma
id|SONYPI_G10A
comma
id|v
)paren
suffix:semicolon
id|v
op_assign
id|inl
c_func
(paren
id|SONYPI_IRQ_PORT
)paren
suffix:semicolon
id|v
op_and_assign
op_complement
(paren
(paren
(paren
id|u32
)paren
l_int|0x3
)paren
op_lshift
id|SONYPI_IRQ_SHIFT
)paren
suffix:semicolon
id|v
op_or_assign
(paren
(paren
(paren
id|u32
)paren
id|sonypi_device.bits
)paren
op_lshift
id|SONYPI_IRQ_SHIFT
)paren
suffix:semicolon
id|outl
c_func
(paren
id|v
comma
id|SONYPI_IRQ_PORT
)paren
suffix:semicolon
id|pci_read_config_dword
c_func
(paren
id|sonypi_device.dev
comma
id|SONYPI_G10A
comma
op_amp
id|v
)paren
suffix:semicolon
id|v
op_assign
(paren
id|v
op_amp
l_int|0xFF1FFFFF
)paren
op_or
l_int|0x00C00000
suffix:semicolon
id|pci_write_config_dword
c_func
(paren
id|sonypi_device.dev
comma
id|SONYPI_G10A
comma
id|v
)paren
suffix:semicolon
)brace
DECL|function|sonypi_type2_srs
r_static
r_void
id|sonypi_type2_srs
c_func
(paren
r_void
)paren
(brace
r_if
c_cond
(paren
id|sonypi_ec_write
c_func
(paren
id|SONYPI_SHIB
comma
(paren
id|sonypi_device.ioport1
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
)paren
)paren
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;ec_write failed&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|sonypi_ec_write
c_func
(paren
id|SONYPI_SLOB
comma
id|sonypi_device.ioport1
op_amp
l_int|0x00FF
)paren
)paren
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;ec_write failed&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|sonypi_ec_write
c_func
(paren
id|SONYPI_SIRQ
comma
id|sonypi_device.bits
)paren
)paren
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;ec_write failed&bslash;n&quot;
)paren
suffix:semicolon
id|udelay
c_func
(paren
l_int|10
)paren
suffix:semicolon
)brace
multiline_comment|/* Disables the device - this comes from the AML code in the ACPI bios */
DECL|function|sonypi_type1_dis
r_static
r_void
id|sonypi_type1_dis
c_func
(paren
r_void
)paren
(brace
id|u32
id|v
suffix:semicolon
id|pci_read_config_dword
c_func
(paren
id|sonypi_device.dev
comma
id|SONYPI_G10A
comma
op_amp
id|v
)paren
suffix:semicolon
id|v
op_assign
id|v
op_amp
l_int|0xFF3FFFFF
suffix:semicolon
id|pci_write_config_dword
c_func
(paren
id|sonypi_device.dev
comma
id|SONYPI_G10A
comma
id|v
)paren
suffix:semicolon
id|v
op_assign
id|inl
c_func
(paren
id|SONYPI_IRQ_PORT
)paren
suffix:semicolon
id|v
op_or_assign
(paren
l_int|0x3
op_lshift
id|SONYPI_IRQ_SHIFT
)paren
suffix:semicolon
id|outl
c_func
(paren
id|v
comma
id|SONYPI_IRQ_PORT
)paren
suffix:semicolon
)brace
DECL|function|sonypi_type2_dis
r_static
r_void
id|sonypi_type2_dis
c_func
(paren
r_void
)paren
(brace
r_if
c_cond
(paren
id|sonypi_ec_write
c_func
(paren
id|SONYPI_SHIB
comma
l_int|0
)paren
)paren
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;ec_write failed&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|sonypi_ec_write
c_func
(paren
id|SONYPI_SLOB
comma
l_int|0
)paren
)paren
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;ec_write failed&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|sonypi_ec_write
c_func
(paren
id|SONYPI_SIRQ
comma
l_int|0
)paren
)paren
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;ec_write failed&bslash;n&quot;
)paren
suffix:semicolon
)brace
DECL|function|sonypi_call1
r_static
id|u8
id|sonypi_call1
c_func
(paren
id|u8
id|dev
)paren
(brace
id|u8
id|v1
comma
id|v2
suffix:semicolon
id|wait_on_command
c_func
(paren
l_int|0
comma
id|inb_p
c_func
(paren
id|sonypi_device.ioport2
)paren
op_amp
l_int|2
comma
id|ITERATIONS_LONG
)paren
suffix:semicolon
id|outb
c_func
(paren
id|dev
comma
id|sonypi_device.ioport2
)paren
suffix:semicolon
id|v1
op_assign
id|inb_p
c_func
(paren
id|sonypi_device.ioport2
)paren
suffix:semicolon
id|v2
op_assign
id|inb_p
c_func
(paren
id|sonypi_device.ioport1
)paren
suffix:semicolon
r_return
id|v2
suffix:semicolon
)brace
DECL|function|sonypi_call2
r_static
id|u8
id|sonypi_call2
c_func
(paren
id|u8
id|dev
comma
id|u8
id|fn
)paren
(brace
id|u8
id|v1
suffix:semicolon
id|wait_on_command
c_func
(paren
l_int|0
comma
id|inb_p
c_func
(paren
id|sonypi_device.ioport2
)paren
op_amp
l_int|2
comma
id|ITERATIONS_LONG
)paren
suffix:semicolon
id|outb
c_func
(paren
id|dev
comma
id|sonypi_device.ioport2
)paren
suffix:semicolon
id|wait_on_command
c_func
(paren
l_int|0
comma
id|inb_p
c_func
(paren
id|sonypi_device.ioport2
)paren
op_amp
l_int|2
comma
id|ITERATIONS_LONG
)paren
suffix:semicolon
id|outb
c_func
(paren
id|fn
comma
id|sonypi_device.ioport1
)paren
suffix:semicolon
id|v1
op_assign
id|inb_p
c_func
(paren
id|sonypi_device.ioport1
)paren
suffix:semicolon
r_return
id|v1
suffix:semicolon
)brace
DECL|function|sonypi_call3
r_static
id|u8
id|sonypi_call3
c_func
(paren
id|u8
id|dev
comma
id|u8
id|fn
comma
id|u8
id|v
)paren
(brace
id|u8
id|v1
suffix:semicolon
id|wait_on_command
c_func
(paren
l_int|0
comma
id|inb_p
c_func
(paren
id|sonypi_device.ioport2
)paren
op_amp
l_int|2
comma
id|ITERATIONS_LONG
)paren
suffix:semicolon
id|outb
c_func
(paren
id|dev
comma
id|sonypi_device.ioport2
)paren
suffix:semicolon
id|wait_on_command
c_func
(paren
l_int|0
comma
id|inb_p
c_func
(paren
id|sonypi_device.ioport2
)paren
op_amp
l_int|2
comma
id|ITERATIONS_LONG
)paren
suffix:semicolon
id|outb
c_func
(paren
id|fn
comma
id|sonypi_device.ioport1
)paren
suffix:semicolon
id|wait_on_command
c_func
(paren
l_int|0
comma
id|inb_p
c_func
(paren
id|sonypi_device.ioport2
)paren
op_amp
l_int|2
comma
id|ITERATIONS_LONG
)paren
suffix:semicolon
id|outb
c_func
(paren
id|v
comma
id|sonypi_device.ioport1
)paren
suffix:semicolon
id|v1
op_assign
id|inb_p
c_func
(paren
id|sonypi_device.ioport1
)paren
suffix:semicolon
r_return
id|v1
suffix:semicolon
)brace
macro_line|#if 0
multiline_comment|/* Get brightness, hue etc. Unreliable... */
r_static
id|u8
id|sonypi_read
c_func
(paren
id|u8
id|fn
)paren
(brace
id|u8
id|v1
comma
id|v2
suffix:semicolon
r_int
id|n
op_assign
l_int|100
suffix:semicolon
r_while
c_loop
(paren
id|n
op_decrement
)paren
(brace
id|v1
op_assign
id|sonypi_call2
c_func
(paren
l_int|0x8f
comma
id|fn
)paren
suffix:semicolon
id|v2
op_assign
id|sonypi_call2
c_func
(paren
l_int|0x8f
comma
id|fn
)paren
suffix:semicolon
r_if
c_cond
(paren
id|v1
op_eq
id|v2
op_logical_and
id|v1
op_ne
l_int|0xff
)paren
r_return
id|v1
suffix:semicolon
)brace
r_return
l_int|0xff
suffix:semicolon
)brace
macro_line|#endif
multiline_comment|/* Set brightness, hue etc */
DECL|function|sonypi_set
r_static
r_void
id|sonypi_set
c_func
(paren
id|u8
id|fn
comma
id|u8
id|v
)paren
(brace
id|wait_on_command
c_func
(paren
l_int|0
comma
id|sonypi_call3
c_func
(paren
l_int|0x90
comma
id|fn
comma
id|v
)paren
comma
id|ITERATIONS_SHORT
)paren
suffix:semicolon
)brace
multiline_comment|/* Tests if the camera is ready */
DECL|function|sonypi_camera_ready
r_static
r_int
id|sonypi_camera_ready
c_func
(paren
r_void
)paren
(brace
id|u8
id|v
suffix:semicolon
id|v
op_assign
id|sonypi_call2
c_func
(paren
l_int|0x8f
comma
id|SONYPI_CAMERA_STATUS
)paren
suffix:semicolon
r_return
(paren
id|v
op_ne
l_int|0xff
op_logical_and
(paren
id|v
op_amp
id|SONYPI_CAMERA_STATUS_READY
)paren
)paren
suffix:semicolon
)brace
multiline_comment|/* Turns the camera off */
DECL|function|sonypi_camera_off
r_static
r_void
id|sonypi_camera_off
c_func
(paren
r_void
)paren
(brace
id|sonypi_set
c_func
(paren
id|SONYPI_CAMERA_PICTURE
comma
id|SONYPI_CAMERA_MUTE_MASK
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|sonypi_device.camera_power
)paren
r_return
suffix:semicolon
id|sonypi_call2
c_func
(paren
l_int|0x91
comma
l_int|0
)paren
suffix:semicolon
id|sonypi_device.camera_power
op_assign
l_int|0
suffix:semicolon
)brace
multiline_comment|/* Turns the camera on */
DECL|function|sonypi_camera_on
r_static
r_void
id|sonypi_camera_on
c_func
(paren
r_void
)paren
(brace
r_int
id|i
comma
id|j
suffix:semicolon
r_if
c_cond
(paren
id|sonypi_device.camera_power
)paren
r_return
suffix:semicolon
r_for
c_loop
(paren
id|j
op_assign
l_int|5
suffix:semicolon
id|j
OG
l_int|0
suffix:semicolon
id|j
op_decrement
)paren
(brace
r_while
c_loop
(paren
id|sonypi_call2
c_func
(paren
l_int|0x91
comma
l_int|0x1
)paren
)paren
(brace
id|set_current_state
c_func
(paren
id|TASK_UNINTERRUPTIBLE
)paren
suffix:semicolon
id|schedule_timeout
c_func
(paren
l_int|1
)paren
suffix:semicolon
)brace
id|sonypi_call1
c_func
(paren
l_int|0x93
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|400
suffix:semicolon
id|i
OG
l_int|0
suffix:semicolon
id|i
op_decrement
)paren
(brace
r_if
c_cond
(paren
id|sonypi_camera_ready
c_func
(paren
)paren
)paren
r_break
suffix:semicolon
id|set_current_state
c_func
(paren
id|TASK_UNINTERRUPTIBLE
)paren
suffix:semicolon
id|schedule_timeout
c_func
(paren
l_int|1
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|i
)paren
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|j
op_eq
l_int|0
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;sonypi: failed to power on camera&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|sonypi_set
c_func
(paren
l_int|0x10
comma
l_int|0x5a
)paren
suffix:semicolon
id|sonypi_device.camera_power
op_assign
l_int|1
suffix:semicolon
)brace
multiline_comment|/* sets the bluetooth subsystem power state */
DECL|function|sonypi_setbluetoothpower
r_static
r_void
id|sonypi_setbluetoothpower
c_func
(paren
id|u8
id|state
)paren
(brace
id|state
op_assign
op_logical_neg
op_logical_neg
id|state
suffix:semicolon
r_if
c_cond
(paren
id|sonypi_device.bluetooth_power
op_eq
id|state
)paren
r_return
suffix:semicolon
id|sonypi_call2
c_func
(paren
l_int|0x96
comma
id|state
)paren
suffix:semicolon
id|sonypi_call1
c_func
(paren
l_int|0x82
)paren
suffix:semicolon
id|sonypi_device.bluetooth_power
op_assign
id|state
suffix:semicolon
)brace
DECL|function|input_keyrelease
r_static
r_void
id|input_keyrelease
c_func
(paren
r_void
op_star
id|data
)paren
(brace
r_struct
id|input_dev
op_star
id|input_dev
suffix:semicolon
r_int
id|key
suffix:semicolon
r_while
c_loop
(paren
l_int|1
)paren
(brace
r_if
c_cond
(paren
id|kfifo_get
c_func
(paren
id|sonypi_device.input_fifo
comma
(paren
r_int
r_char
op_star
)paren
op_amp
id|input_dev
comma
r_sizeof
(paren
id|input_dev
)paren
)paren
op_ne
r_sizeof
(paren
id|input_dev
)paren
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|kfifo_get
c_func
(paren
id|sonypi_device.input_fifo
comma
(paren
r_int
r_char
op_star
)paren
op_amp
id|key
comma
r_sizeof
(paren
id|key
)paren
)paren
op_ne
r_sizeof
(paren
id|key
)paren
)paren
r_return
suffix:semicolon
id|msleep
c_func
(paren
l_int|10
)paren
suffix:semicolon
id|input_report_key
c_func
(paren
id|input_dev
comma
id|key
comma
l_int|0
)paren
suffix:semicolon
id|input_sync
c_func
(paren
id|input_dev
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/* Interrupt handler: some event is available */
DECL|function|sonypi_irq
r_static
id|irqreturn_t
id|sonypi_irq
c_func
(paren
r_int
id|irq
comma
r_void
op_star
id|dev_id
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|u8
id|v1
comma
id|v2
comma
id|event
op_assign
l_int|0
suffix:semicolon
r_int
id|i
comma
id|j
suffix:semicolon
id|v1
op_assign
id|inb_p
c_func
(paren
id|sonypi_device.ioport1
)paren
suffix:semicolon
id|v2
op_assign
id|inb_p
c_func
(paren
id|sonypi_device.ioport1
op_plus
id|sonypi_device.evtype_offset
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|sonypi_eventtypes
(braket
id|i
)braket
dot
id|model
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|sonypi_device.model
op_ne
id|sonypi_eventtypes
(braket
id|i
)braket
dot
id|model
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
(paren
id|v2
op_amp
id|sonypi_eventtypes
(braket
id|i
)braket
dot
id|data
)paren
op_ne
id|sonypi_eventtypes
(braket
id|i
)braket
dot
id|data
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|mask
op_amp
id|sonypi_eventtypes
(braket
id|i
)braket
dot
id|mask
)paren
)paren
r_continue
suffix:semicolon
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|sonypi_eventtypes
(braket
id|i
)braket
dot
id|events
(braket
id|j
)braket
dot
id|event
suffix:semicolon
id|j
op_increment
)paren
(brace
r_if
c_cond
(paren
id|v1
op_eq
id|sonypi_eventtypes
(braket
id|i
)braket
dot
id|events
(braket
id|j
)braket
dot
id|data
)paren
(brace
id|event
op_assign
id|sonypi_eventtypes
(braket
id|i
)braket
dot
id|events
(braket
id|j
)braket
dot
id|event
suffix:semicolon
r_goto
id|found
suffix:semicolon
)brace
)brace
)brace
r_if
c_cond
(paren
id|verbose
)paren
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;sonypi: unknown event port1=0x%02x,port2=0x%02x&bslash;n&quot;
comma
id|v1
comma
id|v2
)paren
suffix:semicolon
multiline_comment|/* We need to return IRQ_HANDLED here because there *are*&n;&t; * events belonging to the sonypi device we don&squot;t know about,&n;&t; * but we still don&squot;t want those to pollute the logs... */
r_return
id|IRQ_HANDLED
suffix:semicolon
id|found
suffix:colon
r_if
c_cond
(paren
id|verbose
OG
l_int|1
)paren
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;sonypi: event port1=0x%02x,port2=0x%02x&bslash;n&quot;
comma
id|v1
comma
id|v2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|useinput
)paren
(brace
r_struct
id|input_dev
op_star
id|input_jog_dev
op_assign
op_amp
id|sonypi_device.input_jog_dev
suffix:semicolon
r_struct
id|input_dev
op_star
id|input_key_dev
op_assign
op_amp
id|sonypi_device.input_key_dev
suffix:semicolon
r_switch
c_cond
(paren
id|event
)paren
(brace
r_case
id|SONYPI_EVENT_JOGDIAL_UP
suffix:colon
r_case
id|SONYPI_EVENT_JOGDIAL_UP_PRESSED
suffix:colon
id|input_report_rel
c_func
(paren
id|input_jog_dev
comma
id|REL_WHEEL
comma
l_int|1
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SONYPI_EVENT_JOGDIAL_DOWN
suffix:colon
r_case
id|SONYPI_EVENT_JOGDIAL_DOWN_PRESSED
suffix:colon
id|input_report_rel
c_func
(paren
id|input_jog_dev
comma
id|REL_WHEEL
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SONYPI_EVENT_JOGDIAL_PRESSED
suffix:colon
(brace
r_int
id|key
op_assign
id|BTN_MIDDLE
suffix:semicolon
id|input_report_key
c_func
(paren
id|input_jog_dev
comma
id|key
comma
l_int|1
)paren
suffix:semicolon
id|kfifo_put
c_func
(paren
id|sonypi_device.input_fifo
comma
(paren
r_int
r_char
op_star
)paren
op_amp
id|input_jog_dev
comma
r_sizeof
(paren
id|input_jog_dev
)paren
)paren
suffix:semicolon
id|kfifo_put
c_func
(paren
id|sonypi_device.input_fifo
comma
(paren
r_int
r_char
op_star
)paren
op_amp
id|key
comma
r_sizeof
(paren
id|key
)paren
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|SONYPI_EVENT_FNKEY_RELEASED
suffix:colon
multiline_comment|/* Nothing, not all VAIOs generate this event */
r_break
suffix:semicolon
)brace
id|input_sync
c_func
(paren
id|input_jog_dev
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|sonypi_inputkeys
(braket
id|i
)braket
dot
id|sonypiev
suffix:semicolon
id|i
op_increment
)paren
(brace
r_int
id|key
suffix:semicolon
r_if
c_cond
(paren
id|event
op_ne
id|sonypi_inputkeys
(braket
id|i
)braket
dot
id|sonypiev
)paren
r_continue
suffix:semicolon
id|key
op_assign
id|sonypi_inputkeys
(braket
id|i
)braket
dot
id|inputev
suffix:semicolon
id|input_report_key
c_func
(paren
id|input_key_dev
comma
id|key
comma
l_int|1
)paren
suffix:semicolon
id|kfifo_put
c_func
(paren
id|sonypi_device.input_fifo
comma
(paren
r_int
r_char
op_star
)paren
op_amp
id|input_key_dev
comma
r_sizeof
(paren
id|input_key_dev
)paren
)paren
suffix:semicolon
id|kfifo_put
c_func
(paren
id|sonypi_device.input_fifo
comma
(paren
r_int
r_char
op_star
)paren
op_amp
id|key
comma
r_sizeof
(paren
id|key
)paren
)paren
suffix:semicolon
)brace
id|input_sync
c_func
(paren
id|input_key_dev
)paren
suffix:semicolon
id|schedule_work
c_func
(paren
op_amp
id|sonypi_device.input_work
)paren
suffix:semicolon
)brace
id|kfifo_put
c_func
(paren
id|sonypi_device.fifo
comma
(paren
r_int
r_char
op_star
)paren
op_amp
id|event
comma
r_sizeof
(paren
id|event
)paren
)paren
suffix:semicolon
id|kill_fasync
c_func
(paren
op_amp
id|sonypi_device.fifo_async
comma
id|SIGIO
comma
id|POLL_IN
)paren
suffix:semicolon
id|wake_up_interruptible
c_func
(paren
op_amp
id|sonypi_device.fifo_proc_list
)paren
suffix:semicolon
r_return
id|IRQ_HANDLED
suffix:semicolon
)brace
multiline_comment|/* External camera command (exported to the motion eye v4l driver) */
DECL|function|sonypi_camera_command
r_int
id|sonypi_camera_command
c_func
(paren
r_int
id|command
comma
id|u8
id|value
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|camera
)paren
r_return
op_minus
id|EIO
suffix:semicolon
id|down
c_func
(paren
op_amp
id|sonypi_device.lock
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|command
)paren
(brace
r_case
id|SONYPI_COMMAND_SETCAMERA
suffix:colon
r_if
c_cond
(paren
id|value
)paren
id|sonypi_camera_on
c_func
(paren
)paren
suffix:semicolon
r_else
id|sonypi_camera_off
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SONYPI_COMMAND_SETCAMERABRIGHTNESS
suffix:colon
id|sonypi_set
c_func
(paren
id|SONYPI_CAMERA_BRIGHTNESS
comma
id|value
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SONYPI_COMMAND_SETCAMERACONTRAST
suffix:colon
id|sonypi_set
c_func
(paren
id|SONYPI_CAMERA_CONTRAST
comma
id|value
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SONYPI_COMMAND_SETCAMERAHUE
suffix:colon
id|sonypi_set
c_func
(paren
id|SONYPI_CAMERA_HUE
comma
id|value
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SONYPI_COMMAND_SETCAMERACOLOR
suffix:colon
id|sonypi_set
c_func
(paren
id|SONYPI_CAMERA_COLOR
comma
id|value
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SONYPI_COMMAND_SETCAMERASHARPNESS
suffix:colon
id|sonypi_set
c_func
(paren
id|SONYPI_CAMERA_SHARPNESS
comma
id|value
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SONYPI_COMMAND_SETCAMERAPICTURE
suffix:colon
id|sonypi_set
c_func
(paren
id|SONYPI_CAMERA_PICTURE
comma
id|value
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SONYPI_COMMAND_SETCAMERAAGC
suffix:colon
id|sonypi_set
c_func
(paren
id|SONYPI_CAMERA_AGC
comma
id|value
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;sonypi: sonypi_camera_command invalid: %d&bslash;n&quot;
comma
id|command
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|up
c_func
(paren
op_amp
id|sonypi_device.lock
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|sonypi_camera_command
id|EXPORT_SYMBOL
c_func
(paren
id|sonypi_camera_command
)paren
suffix:semicolon
DECL|function|sonypi_misc_fasync
r_static
r_int
id|sonypi_misc_fasync
c_func
(paren
r_int
id|fd
comma
r_struct
id|file
op_star
id|filp
comma
r_int
id|on
)paren
(brace
r_int
id|retval
suffix:semicolon
id|retval
op_assign
id|fasync_helper
c_func
(paren
id|fd
comma
id|filp
comma
id|on
comma
op_amp
id|sonypi_device.fifo_async
)paren
suffix:semicolon
r_if
c_cond
(paren
id|retval
OL
l_int|0
)paren
r_return
id|retval
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|sonypi_misc_release
r_static
r_int
id|sonypi_misc_release
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
id|sonypi_misc_fasync
c_func
(paren
op_minus
l_int|1
comma
id|file
comma
l_int|0
)paren
suffix:semicolon
id|down
c_func
(paren
op_amp
id|sonypi_device.lock
)paren
suffix:semicolon
id|sonypi_device.open_count
op_decrement
suffix:semicolon
id|up
c_func
(paren
op_amp
id|sonypi_device.lock
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|sonypi_misc_open
r_static
r_int
id|sonypi_misc_open
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
id|down
c_func
(paren
op_amp
id|sonypi_device.lock
)paren
suffix:semicolon
multiline_comment|/* Flush input queue on first open */
r_if
c_cond
(paren
op_logical_neg
id|sonypi_device.open_count
)paren
id|kfifo_reset
c_func
(paren
id|sonypi_device.fifo
)paren
suffix:semicolon
id|sonypi_device.open_count
op_increment
suffix:semicolon
id|up
c_func
(paren
op_amp
id|sonypi_device.lock
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|sonypi_misc_read
r_static
id|ssize_t
id|sonypi_misc_read
c_func
(paren
r_struct
id|file
op_star
id|file
comma
r_char
id|__user
op_star
id|buf
comma
r_int
id|count
comma
id|loff_t
op_star
id|pos
)paren
(brace
id|ssize_t
id|ret
suffix:semicolon
r_int
r_char
id|c
suffix:semicolon
r_if
c_cond
(paren
(paren
id|kfifo_len
c_func
(paren
id|sonypi_device.fifo
)paren
op_eq
l_int|0
)paren
op_logical_and
(paren
id|file-&gt;f_flags
op_amp
id|O_NONBLOCK
)paren
)paren
r_return
op_minus
id|EAGAIN
suffix:semicolon
id|ret
op_assign
id|wait_event_interruptible
c_func
(paren
id|sonypi_device.fifo_proc_list
comma
id|kfifo_len
c_func
(paren
id|sonypi_device.fifo
)paren
op_ne
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
r_return
id|ret
suffix:semicolon
r_while
c_loop
(paren
id|ret
OL
id|count
op_logical_and
(paren
id|kfifo_get
c_func
(paren
id|sonypi_device.fifo
comma
op_amp
id|c
comma
r_sizeof
(paren
id|c
)paren
)paren
op_eq
r_sizeof
(paren
id|c
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
id|put_user
c_func
(paren
id|c
comma
id|buf
op_increment
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|ret
op_increment
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ret
OG
l_int|0
)paren
(brace
r_struct
id|inode
op_star
id|inode
op_assign
id|file-&gt;f_dentry-&gt;d_inode
suffix:semicolon
id|inode-&gt;i_atime
op_assign
id|current_fs_time
c_func
(paren
id|inode-&gt;i_sb
)paren
suffix:semicolon
)brace
r_return
id|ret
suffix:semicolon
)brace
DECL|function|sonypi_misc_poll
r_static
r_int
r_int
id|sonypi_misc_poll
c_func
(paren
r_struct
id|file
op_star
id|file
comma
id|poll_table
op_star
id|wait
)paren
(brace
id|poll_wait
c_func
(paren
id|file
comma
op_amp
id|sonypi_device.fifo_proc_list
comma
id|wait
)paren
suffix:semicolon
r_if
c_cond
(paren
id|kfifo_len
c_func
(paren
id|sonypi_device.fifo
)paren
)paren
r_return
id|POLLIN
op_or
id|POLLRDNORM
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|sonypi_misc_ioctl
r_static
r_int
id|sonypi_misc_ioctl
c_func
(paren
r_struct
id|inode
op_star
id|ip
comma
r_struct
id|file
op_star
id|fp
comma
r_int
r_int
id|cmd
comma
r_int
r_int
id|arg
)paren
(brace
r_int
id|ret
op_assign
l_int|0
suffix:semicolon
r_void
id|__user
op_star
id|argp
op_assign
(paren
r_void
id|__user
op_star
)paren
id|arg
suffix:semicolon
id|u8
id|val8
suffix:semicolon
id|u16
id|val16
suffix:semicolon
id|down
c_func
(paren
op_amp
id|sonypi_device.lock
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|SONYPI_IOCGBRT
suffix:colon
r_if
c_cond
(paren
id|sonypi_ec_read
c_func
(paren
id|SONYPI_LCD_LIGHT
comma
op_amp
id|val8
)paren
)paren
(brace
id|ret
op_assign
op_minus
id|EIO
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|argp
comma
op_amp
id|val8
comma
r_sizeof
(paren
id|val8
)paren
)paren
)paren
id|ret
op_assign
op_minus
id|EFAULT
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SONYPI_IOCSBRT
suffix:colon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|val8
comma
id|argp
comma
r_sizeof
(paren
id|val8
)paren
)paren
)paren
(brace
id|ret
op_assign
op_minus
id|EFAULT
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|sonypi_ec_write
c_func
(paren
id|SONYPI_LCD_LIGHT
comma
id|val8
)paren
)paren
id|ret
op_assign
op_minus
id|EIO
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SONYPI_IOCGBAT1CAP
suffix:colon
r_if
c_cond
(paren
id|ec_read16
c_func
(paren
id|SONYPI_BAT1_FULL
comma
op_amp
id|val16
)paren
)paren
(brace
id|ret
op_assign
op_minus
id|EIO
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|argp
comma
op_amp
id|val16
comma
r_sizeof
(paren
id|val16
)paren
)paren
)paren
id|ret
op_assign
op_minus
id|EFAULT
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SONYPI_IOCGBAT1REM
suffix:colon
r_if
c_cond
(paren
id|ec_read16
c_func
(paren
id|SONYPI_BAT1_LEFT
comma
op_amp
id|val16
)paren
)paren
(brace
id|ret
op_assign
op_minus
id|EIO
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|argp
comma
op_amp
id|val16
comma
r_sizeof
(paren
id|val16
)paren
)paren
)paren
id|ret
op_assign
op_minus
id|EFAULT
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SONYPI_IOCGBAT2CAP
suffix:colon
r_if
c_cond
(paren
id|ec_read16
c_func
(paren
id|SONYPI_BAT2_FULL
comma
op_amp
id|val16
)paren
)paren
(brace
id|ret
op_assign
op_minus
id|EIO
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|argp
comma
op_amp
id|val16
comma
r_sizeof
(paren
id|val16
)paren
)paren
)paren
id|ret
op_assign
op_minus
id|EFAULT
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SONYPI_IOCGBAT2REM
suffix:colon
r_if
c_cond
(paren
id|ec_read16
c_func
(paren
id|SONYPI_BAT2_LEFT
comma
op_amp
id|val16
)paren
)paren
(brace
id|ret
op_assign
op_minus
id|EIO
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|argp
comma
op_amp
id|val16
comma
r_sizeof
(paren
id|val16
)paren
)paren
)paren
id|ret
op_assign
op_minus
id|EFAULT
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SONYPI_IOCGBATFLAGS
suffix:colon
r_if
c_cond
(paren
id|sonypi_ec_read
c_func
(paren
id|SONYPI_BAT_FLAGS
comma
op_amp
id|val8
)paren
)paren
(brace
id|ret
op_assign
op_minus
id|EIO
suffix:semicolon
r_break
suffix:semicolon
)brace
id|val8
op_and_assign
l_int|0x07
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|argp
comma
op_amp
id|val8
comma
r_sizeof
(paren
id|val8
)paren
)paren
)paren
id|ret
op_assign
op_minus
id|EFAULT
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SONYPI_IOCGBLUE
suffix:colon
id|val8
op_assign
id|sonypi_device.bluetooth_power
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|argp
comma
op_amp
id|val8
comma
r_sizeof
(paren
id|val8
)paren
)paren
)paren
id|ret
op_assign
op_minus
id|EFAULT
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SONYPI_IOCSBLUE
suffix:colon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|val8
comma
id|argp
comma
r_sizeof
(paren
id|val8
)paren
)paren
)paren
(brace
id|ret
op_assign
op_minus
id|EFAULT
suffix:semicolon
r_break
suffix:semicolon
)brace
id|sonypi_setbluetoothpower
c_func
(paren
id|val8
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|ret
op_assign
op_minus
id|EINVAL
suffix:semicolon
)brace
id|up
c_func
(paren
op_amp
id|sonypi_device.lock
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
DECL|variable|sonypi_misc_fops
r_static
r_struct
id|file_operations
id|sonypi_misc_fops
op_assign
(brace
dot
id|owner
op_assign
id|THIS_MODULE
comma
dot
id|read
op_assign
id|sonypi_misc_read
comma
dot
id|poll
op_assign
id|sonypi_misc_poll
comma
dot
id|open
op_assign
id|sonypi_misc_open
comma
dot
id|release
op_assign
id|sonypi_misc_release
comma
dot
id|fasync
op_assign
id|sonypi_misc_fasync
comma
dot
id|ioctl
op_assign
id|sonypi_misc_ioctl
comma
)brace
suffix:semicolon
DECL|variable|sonypi_misc_device
r_struct
id|miscdevice
id|sonypi_misc_device
op_assign
(brace
dot
id|minor
op_assign
op_minus
l_int|1
comma
dot
id|name
op_assign
l_string|&quot;sonypi&quot;
comma
dot
id|fops
op_assign
op_amp
id|sonypi_misc_fops
comma
)brace
suffix:semicolon
DECL|function|sonypi_enable
r_static
r_void
id|sonypi_enable
c_func
(paren
r_int
r_int
id|camera_on
)paren
(brace
r_if
c_cond
(paren
id|sonypi_device.model
op_eq
id|SONYPI_DEVICE_MODEL_TYPE2
)paren
id|sonypi_type2_srs
c_func
(paren
)paren
suffix:semicolon
r_else
id|sonypi_type1_srs
c_func
(paren
)paren
suffix:semicolon
id|sonypi_call1
c_func
(paren
l_int|0x82
)paren
suffix:semicolon
id|sonypi_call2
c_func
(paren
l_int|0x81
comma
l_int|0xff
)paren
suffix:semicolon
id|sonypi_call1
c_func
(paren
id|compat
ques
c_cond
l_int|0x92
suffix:colon
l_int|0x82
)paren
suffix:semicolon
multiline_comment|/* Enable ACPI mode to get Fn key events */
r_if
c_cond
(paren
op_logical_neg
id|SONYPI_ACPI_ACTIVE
op_logical_and
id|fnkeyinit
)paren
id|outb
c_func
(paren
l_int|0xf0
comma
l_int|0xb2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|camera
op_logical_and
id|camera_on
)paren
id|sonypi_camera_on
c_func
(paren
)paren
suffix:semicolon
)brace
DECL|function|sonypi_disable
r_static
r_int
id|sonypi_disable
c_func
(paren
r_void
)paren
(brace
id|sonypi_call2
c_func
(paren
l_int|0x81
comma
l_int|0
)paren
suffix:semicolon
multiline_comment|/* make sure we don&squot;t get any more events */
r_if
c_cond
(paren
id|camera
)paren
id|sonypi_camera_off
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/* disable ACPI mode */
r_if
c_cond
(paren
op_logical_neg
id|SONYPI_ACPI_ACTIVE
op_logical_and
id|fnkeyinit
)paren
id|outb
c_func
(paren
l_int|0xf1
comma
l_int|0xb2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|sonypi_device.model
op_eq
id|SONYPI_DEVICE_MODEL_TYPE2
)paren
id|sonypi_type2_dis
c_func
(paren
)paren
suffix:semicolon
r_else
id|sonypi_type1_dis
c_func
(paren
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_PM
DECL|variable|old_camera_power
r_static
r_int
id|old_camera_power
suffix:semicolon
DECL|function|sonypi_suspend
r_static
r_int
id|sonypi_suspend
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
id|u32
id|state
comma
id|u32
id|level
)paren
(brace
r_if
c_cond
(paren
id|level
op_eq
id|SUSPEND_DISABLE
)paren
(brace
id|old_camera_power
op_assign
id|sonypi_device.camera_power
suffix:semicolon
id|sonypi_disable
c_func
(paren
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|sonypi_resume
r_static
r_int
id|sonypi_resume
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
id|u32
id|level
)paren
(brace
r_if
c_cond
(paren
id|level
op_eq
id|RESUME_ENABLE
)paren
id|sonypi_enable
c_func
(paren
id|old_camera_power
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#endif
DECL|function|sonypi_shutdown
r_static
r_void
id|sonypi_shutdown
c_func
(paren
r_struct
id|device
op_star
id|dev
)paren
(brace
id|sonypi_disable
c_func
(paren
)paren
suffix:semicolon
)brace
DECL|variable|sonypi_driver
r_static
r_struct
id|device_driver
id|sonypi_driver
op_assign
(brace
dot
id|name
op_assign
l_string|&quot;sonypi&quot;
comma
dot
id|bus
op_assign
op_amp
id|platform_bus_type
comma
macro_line|#ifdef CONFIG_PM
dot
id|suspend
op_assign
id|sonypi_suspend
comma
dot
id|resume
op_assign
id|sonypi_resume
comma
macro_line|#endif
dot
id|shutdown
op_assign
id|sonypi_shutdown
comma
)brace
suffix:semicolon
DECL|function|sonypi_probe
r_static
r_int
id|__devinit
id|sonypi_probe
c_func
(paren
r_void
)paren
(brace
r_int
id|i
comma
id|ret
suffix:semicolon
r_struct
id|sonypi_ioport_list
op_star
id|ioport_list
suffix:semicolon
r_struct
id|sonypi_irq_list
op_star
id|irq_list
suffix:semicolon
r_struct
id|pci_dev
op_star
id|pcidev
suffix:semicolon
id|pcidev
op_assign
id|pci_get_device
c_func
(paren
id|PCI_VENDOR_ID_INTEL
comma
id|PCI_DEVICE_ID_INTEL_82371AB_3
comma
l_int|NULL
)paren
suffix:semicolon
id|sonypi_device.dev
op_assign
id|pcidev
suffix:semicolon
id|sonypi_device.model
op_assign
id|pcidev
ques
c_cond
id|SONYPI_DEVICE_MODEL_TYPE1
suffix:colon
id|SONYPI_DEVICE_MODEL_TYPE2
suffix:semicolon
id|sonypi_device.fifo_lock
op_assign
id|SPIN_LOCK_UNLOCKED
suffix:semicolon
id|sonypi_device.fifo
op_assign
id|kfifo_alloc
c_func
(paren
id|SONYPI_BUF_SIZE
comma
id|GFP_KERNEL
comma
op_amp
id|sonypi_device.fifo_lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|IS_ERR
c_func
(paren
id|sonypi_device.fifo
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;sonypi: kfifo_alloc failed&bslash;n&quot;
)paren
suffix:semicolon
id|ret
op_assign
id|PTR_ERR
c_func
(paren
id|sonypi_device.fifo
)paren
suffix:semicolon
r_goto
id|out_fifo
suffix:semicolon
)brace
id|init_waitqueue_head
c_func
(paren
op_amp
id|sonypi_device.fifo_proc_list
)paren
suffix:semicolon
id|init_MUTEX
c_func
(paren
op_amp
id|sonypi_device.lock
)paren
suffix:semicolon
id|sonypi_device.bluetooth_power
op_assign
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|pcidev
op_logical_and
id|pci_enable_device
c_func
(paren
id|pcidev
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;sonypi: pci_enable_device failed&bslash;n&quot;
)paren
suffix:semicolon
id|ret
op_assign
op_minus
id|EIO
suffix:semicolon
r_goto
id|out_pcienable
suffix:semicolon
)brace
id|sonypi_misc_device.minor
op_assign
(paren
id|minor
op_eq
op_minus
l_int|1
)paren
ques
c_cond
id|MISC_DYNAMIC_MINOR
suffix:colon
id|minor
suffix:semicolon
r_if
c_cond
(paren
(paren
id|ret
op_assign
id|misc_register
c_func
(paren
op_amp
id|sonypi_misc_device
)paren
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;sonypi: misc_register failed&bslash;n&quot;
)paren
suffix:semicolon
r_goto
id|out_miscreg
suffix:semicolon
)brace
r_if
c_cond
(paren
id|sonypi_device.model
op_eq
id|SONYPI_DEVICE_MODEL_TYPE2
)paren
(brace
id|ioport_list
op_assign
id|sonypi_type2_ioport_list
suffix:semicolon
id|sonypi_device.region_size
op_assign
id|SONYPI_TYPE2_REGION_SIZE
suffix:semicolon
id|sonypi_device.evtype_offset
op_assign
id|SONYPI_TYPE2_EVTYPE_OFFSET
suffix:semicolon
id|irq_list
op_assign
id|sonypi_type2_irq_list
suffix:semicolon
)brace
r_else
(brace
id|ioport_list
op_assign
id|sonypi_type1_ioport_list
suffix:semicolon
id|sonypi_device.region_size
op_assign
id|SONYPI_TYPE1_REGION_SIZE
suffix:semicolon
id|sonypi_device.evtype_offset
op_assign
id|SONYPI_TYPE1_EVTYPE_OFFSET
suffix:semicolon
id|irq_list
op_assign
id|sonypi_type1_irq_list
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|ioport_list
(braket
id|i
)braket
dot
id|port1
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|request_region
c_func
(paren
id|ioport_list
(braket
id|i
)braket
dot
id|port1
comma
id|sonypi_device.region_size
comma
l_string|&quot;Sony Programable I/O Device&quot;
)paren
)paren
(brace
multiline_comment|/* get the ioport */
id|sonypi_device.ioport1
op_assign
id|ioport_list
(braket
id|i
)braket
dot
id|port1
suffix:semicolon
id|sonypi_device.ioport2
op_assign
id|ioport_list
(braket
id|i
)braket
dot
id|port2
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
op_logical_neg
id|sonypi_device.ioport1
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;sonypi: request_region failed&bslash;n&quot;
)paren
suffix:semicolon
id|ret
op_assign
op_minus
id|ENODEV
suffix:semicolon
r_goto
id|out_reqreg
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|irq_list
(braket
id|i
)braket
dot
id|irq
suffix:semicolon
id|i
op_increment
)paren
(brace
id|sonypi_device.irq
op_assign
id|irq_list
(braket
id|i
)braket
dot
id|irq
suffix:semicolon
id|sonypi_device.bits
op_assign
id|irq_list
(braket
id|i
)braket
dot
id|bits
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|request_irq
c_func
(paren
id|sonypi_device.irq
comma
id|sonypi_irq
comma
id|SA_SHIRQ
comma
l_string|&quot;sonypi&quot;
comma
id|sonypi_irq
)paren
)paren
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|irq_list
(braket
id|i
)braket
dot
id|irq
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;sonypi: request_irq failed&bslash;n&quot;
)paren
suffix:semicolon
id|ret
op_assign
op_minus
id|ENODEV
suffix:semicolon
r_goto
id|out_reqirq
suffix:semicolon
)brace
r_if
c_cond
(paren
id|useinput
)paren
(brace
multiline_comment|/* Initialize the Input Drivers: jogdial */
r_int
id|i
suffix:semicolon
id|sonypi_device.input_jog_dev.evbit
(braket
l_int|0
)braket
op_assign
id|BIT
c_func
(paren
id|EV_KEY
)paren
op_or
id|BIT
c_func
(paren
id|EV_REL
)paren
suffix:semicolon
id|sonypi_device.input_jog_dev.keybit
(braket
id|LONG
c_func
(paren
id|BTN_MOUSE
)paren
)braket
op_assign
id|BIT
c_func
(paren
id|BTN_MIDDLE
)paren
suffix:semicolon
id|sonypi_device.input_jog_dev.relbit
(braket
l_int|0
)braket
op_assign
id|BIT
c_func
(paren
id|REL_WHEEL
)paren
suffix:semicolon
id|sonypi_device.input_jog_dev.name
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
id|SONYPI_JOG_INPUTNAME
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|sonypi_device.input_jog_dev.name
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;sonypi: kmalloc failed&bslash;n&quot;
)paren
suffix:semicolon
id|ret
op_assign
op_minus
id|ENOMEM
suffix:semicolon
r_goto
id|out_inkmallocinput1
suffix:semicolon
)brace
id|sprintf
c_func
(paren
id|sonypi_device.input_jog_dev.name
comma
id|SONYPI_JOG_INPUTNAME
)paren
suffix:semicolon
id|sonypi_device.input_jog_dev.id.bustype
op_assign
id|BUS_ISA
suffix:semicolon
id|sonypi_device.input_jog_dev.id.vendor
op_assign
id|PCI_VENDOR_ID_SONY
suffix:semicolon
id|input_register_device
c_func
(paren
op_amp
id|sonypi_device.input_jog_dev
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;%s input method installed.&bslash;n&quot;
comma
id|sonypi_device.input_jog_dev.name
)paren
suffix:semicolon
multiline_comment|/* Initialize the Input Drivers: special keys */
id|sonypi_device.input_key_dev.evbit
(braket
l_int|0
)braket
op_assign
id|BIT
c_func
(paren
id|EV_KEY
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|sonypi_inputkeys
(braket
id|i
)braket
dot
id|sonypiev
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|sonypi_inputkeys
(braket
id|i
)braket
dot
id|inputev
)paren
id|set_bit
c_func
(paren
id|sonypi_inputkeys
(braket
id|i
)braket
dot
id|inputev
comma
id|sonypi_device.input_key_dev.keybit
)paren
suffix:semicolon
id|sonypi_device.input_key_dev.name
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
id|SONYPI_KEY_INPUTNAME
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|sonypi_device.input_key_dev.name
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;sonypi: kmalloc failed&bslash;n&quot;
)paren
suffix:semicolon
id|ret
op_assign
op_minus
id|ENOMEM
suffix:semicolon
r_goto
id|out_inkmallocinput2
suffix:semicolon
)brace
id|sprintf
c_func
(paren
id|sonypi_device.input_key_dev.name
comma
id|SONYPI_KEY_INPUTNAME
)paren
suffix:semicolon
id|sonypi_device.input_key_dev.id.bustype
op_assign
id|BUS_ISA
suffix:semicolon
id|sonypi_device.input_key_dev.id.vendor
op_assign
id|PCI_VENDOR_ID_SONY
suffix:semicolon
id|input_register_device
c_func
(paren
op_amp
id|sonypi_device.input_key_dev
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;%s input method installed.&bslash;n&quot;
comma
id|sonypi_device.input_key_dev.name
)paren
suffix:semicolon
id|sonypi_device.input_fifo_lock
op_assign
id|SPIN_LOCK_UNLOCKED
suffix:semicolon
id|sonypi_device.input_fifo
op_assign
id|kfifo_alloc
c_func
(paren
id|SONYPI_BUF_SIZE
comma
id|GFP_KERNEL
comma
op_amp
id|sonypi_device.input_fifo_lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|IS_ERR
c_func
(paren
id|sonypi_device.input_fifo
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;sonypi: kfifo_alloc failed&bslash;n&quot;
)paren
suffix:semicolon
id|ret
op_assign
id|PTR_ERR
c_func
(paren
id|sonypi_device.input_fifo
)paren
suffix:semicolon
r_goto
id|out_infifo
suffix:semicolon
)brace
id|INIT_WORK
c_func
(paren
op_amp
id|sonypi_device.input_work
comma
id|input_keyrelease
comma
l_int|NULL
)paren
suffix:semicolon
)brace
id|sonypi_device.pdev
op_assign
id|platform_device_register_simple
c_func
(paren
l_string|&quot;sonypi&quot;
comma
op_minus
l_int|1
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|IS_ERR
c_func
(paren
id|sonypi_device.pdev
)paren
)paren
(brace
id|ret
op_assign
id|PTR_ERR
c_func
(paren
id|sonypi_device.pdev
)paren
suffix:semicolon
r_goto
id|out_platformdev
suffix:semicolon
)brace
id|sonypi_enable
c_func
(paren
l_int|0
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;sonypi: Sony Programmable I/O Controller Driver&quot;
l_string|&quot;v%s.&bslash;n&quot;
comma
id|SONYPI_DRIVER_VERSION
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;sonypi: detected %s model, &quot;
l_string|&quot;verbose = %d, fnkeyinit = %s, camera = %s, &quot;
l_string|&quot;compat = %s, mask = 0x%08lx, useinput = %s, acpi = %s&bslash;n&quot;
comma
(paren
id|sonypi_device.model
op_eq
id|SONYPI_DEVICE_MODEL_TYPE1
)paren
ques
c_cond
l_string|&quot;type1&quot;
suffix:colon
l_string|&quot;type2&quot;
comma
id|verbose
comma
id|fnkeyinit
ques
c_cond
l_string|&quot;on&quot;
suffix:colon
l_string|&quot;off&quot;
comma
id|camera
ques
c_cond
l_string|&quot;on&quot;
suffix:colon
l_string|&quot;off&quot;
comma
id|compat
ques
c_cond
l_string|&quot;on&quot;
suffix:colon
l_string|&quot;off&quot;
comma
id|mask
comma
id|useinput
ques
c_cond
l_string|&quot;on&quot;
suffix:colon
l_string|&quot;off&quot;
comma
id|SONYPI_ACPI_ACTIVE
ques
c_cond
l_string|&quot;on&quot;
suffix:colon
l_string|&quot;off&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;sonypi: enabled at irq=%d, port1=0x%x, port2=0x%x&bslash;n&quot;
comma
id|sonypi_device.irq
comma
id|sonypi_device.ioport1
comma
id|sonypi_device.ioport2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|minor
op_eq
op_minus
l_int|1
)paren
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;sonypi: device allocated minor is %d&bslash;n&quot;
comma
id|sonypi_misc_device.minor
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
id|out_platformdev
suffix:colon
id|kfifo_free
c_func
(paren
id|sonypi_device.input_fifo
)paren
suffix:semicolon
id|out_infifo
suffix:colon
id|input_unregister_device
c_func
(paren
op_amp
id|sonypi_device.input_key_dev
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|sonypi_device.input_key_dev.name
)paren
suffix:semicolon
id|out_inkmallocinput2
suffix:colon
id|input_unregister_device
c_func
(paren
op_amp
id|sonypi_device.input_jog_dev
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|sonypi_device.input_jog_dev.name
)paren
suffix:semicolon
id|out_inkmallocinput1
suffix:colon
id|free_irq
c_func
(paren
id|sonypi_device.irq
comma
id|sonypi_irq
)paren
suffix:semicolon
id|out_reqirq
suffix:colon
id|release_region
c_func
(paren
id|sonypi_device.ioport1
comma
id|sonypi_device.region_size
)paren
suffix:semicolon
id|out_reqreg
suffix:colon
id|misc_deregister
c_func
(paren
op_amp
id|sonypi_misc_device
)paren
suffix:semicolon
id|out_miscreg
suffix:colon
r_if
c_cond
(paren
id|pcidev
)paren
id|pci_disable_device
c_func
(paren
id|pcidev
)paren
suffix:semicolon
id|out_pcienable
suffix:colon
id|kfifo_free
c_func
(paren
id|sonypi_device.fifo
)paren
suffix:semicolon
id|out_fifo
suffix:colon
id|pci_dev_put
c_func
(paren
id|sonypi_device.dev
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
DECL|function|sonypi_remove
r_static
r_void
id|__devexit
id|sonypi_remove
c_func
(paren
r_void
)paren
(brace
id|sonypi_disable
c_func
(paren
)paren
suffix:semicolon
id|platform_device_unregister
c_func
(paren
id|sonypi_device.pdev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|useinput
)paren
(brace
id|input_unregister_device
c_func
(paren
op_amp
id|sonypi_device.input_key_dev
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|sonypi_device.input_key_dev.name
)paren
suffix:semicolon
id|input_unregister_device
c_func
(paren
op_amp
id|sonypi_device.input_jog_dev
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|sonypi_device.input_jog_dev.name
)paren
suffix:semicolon
id|kfifo_free
c_func
(paren
id|sonypi_device.input_fifo
)paren
suffix:semicolon
)brace
id|free_irq
c_func
(paren
id|sonypi_device.irq
comma
id|sonypi_irq
)paren
suffix:semicolon
id|release_region
c_func
(paren
id|sonypi_device.ioport1
comma
id|sonypi_device.region_size
)paren
suffix:semicolon
id|misc_deregister
c_func
(paren
op_amp
id|sonypi_misc_device
)paren
suffix:semicolon
r_if
c_cond
(paren
id|sonypi_device.dev
)paren
id|pci_disable_device
c_func
(paren
id|sonypi_device.dev
)paren
suffix:semicolon
id|kfifo_free
c_func
(paren
id|sonypi_device.fifo
)paren
suffix:semicolon
id|pci_dev_put
c_func
(paren
id|sonypi_device.dev
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;sonypi: removed.&bslash;n&quot;
)paren
suffix:semicolon
)brace
DECL|variable|sonypi_dmi_table
r_static
r_struct
id|dmi_system_id
id|__initdata
id|sonypi_dmi_table
(braket
)braket
op_assign
(brace
(brace
dot
id|ident
op_assign
l_string|&quot;Sony Vaio&quot;
comma
dot
id|matches
op_assign
(brace
id|DMI_MATCH
c_func
(paren
id|DMI_SYS_VENDOR
comma
l_string|&quot;Sony Corporation&quot;
)paren
comma
id|DMI_MATCH
c_func
(paren
id|DMI_PRODUCT_NAME
comma
l_string|&quot;PCG-&quot;
)paren
comma
)brace
comma
)brace
comma
(brace
dot
id|ident
op_assign
l_string|&quot;Sony Vaio&quot;
comma
dot
id|matches
op_assign
(brace
id|DMI_MATCH
c_func
(paren
id|DMI_SYS_VENDOR
comma
l_string|&quot;Sony Corporation&quot;
)paren
comma
id|DMI_MATCH
c_func
(paren
id|DMI_PRODUCT_NAME
comma
l_string|&quot;VGN-&quot;
)paren
comma
)brace
comma
)brace
comma
(brace
)brace
)brace
suffix:semicolon
DECL|function|sonypi_init
r_static
r_int
id|__init
id|sonypi_init
c_func
(paren
r_void
)paren
(brace
r_int
id|ret
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dmi_check_system
c_func
(paren
id|sonypi_dmi_table
)paren
)paren
r_return
op_minus
id|ENODEV
suffix:semicolon
id|ret
op_assign
id|driver_register
c_func
(paren
op_amp
id|sonypi_driver
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
r_return
id|ret
suffix:semicolon
id|ret
op_assign
id|sonypi_probe
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
id|driver_unregister
c_func
(paren
op_amp
id|sonypi_driver
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
DECL|function|sonypi_exit
r_static
r_void
id|__exit
id|sonypi_exit
c_func
(paren
r_void
)paren
(brace
id|driver_unregister
c_func
(paren
op_amp
id|sonypi_driver
)paren
suffix:semicolon
id|sonypi_remove
c_func
(paren
)paren
suffix:semicolon
)brace
DECL|variable|sonypi_init
id|module_init
c_func
(paren
id|sonypi_init
)paren
suffix:semicolon
DECL|variable|sonypi_exit
id|module_exit
c_func
(paren
id|sonypi_exit
)paren
suffix:semicolon
eof
