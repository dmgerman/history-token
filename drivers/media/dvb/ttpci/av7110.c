multiline_comment|/*&n; * av7110.c: driver for the SAA7146 based AV110 cards (like the Fujitsu-Siemens DVB)&n; *&n; * Copyright (C) 1999-2002 Ralph  Metzler &n; *                       &amp; Marcus Metzler for convergence integrated media GmbH&n; *&n; * originally based on code by:&n; * Copyright (C) 1998,1999 Christian Theiss &lt;mistert@rz.fh-augsburg.de&gt;&n; *&n; * This program is free software; you can redistribute it and/or&n; * modify it under the terms of the GNU General Public License&n; * as published by the Free Software Foundation; either version 2&n; * of the License, or (at your option) any later version.&n; * &n; *&n; * This program is distributed in the hope that it will be useful,&n; * but WITHOUT ANY WARRANTY; without even the implied warranty of&n; * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; * GNU General Public License for more details.&n; * &n; *&n; * You should have received a copy of the GNU General Public License&n; * along with this program; if not, write to the Free Software&n; * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.&n; * Or, point your browser to http://www.gnu.org/copyleft/gpl.html&n; * &n; *&n; * the project&squot;s page is at http://www.linuxtv.org/dvb/&n; */
DECL|macro|NEW_CI
mdefine_line|#define NEW_CI 1
multiline_comment|/* for debugging ARM communication: */
singleline_comment|//#define COM_DEBUG
DECL|macro|__KERNEL_SYSCALLS__
mdefine_line|#define __KERNEL_SYSCALLS__
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/kmod.h&gt;
macro_line|#include &lt;linux/delay.h&gt;
macro_line|#include &lt;linux/fs.h&gt;
macro_line|#include &lt;linux/timer.h&gt;
macro_line|#include &lt;linux/poll.h&gt;
macro_line|#include &lt;linux/unistd.h&gt;
macro_line|#include &lt;linux/byteorder/swabb.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;linux/smp_lock.h&gt;
macro_line|#include &lt;stdarg.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/types.h&gt;
macro_line|#include &lt;linux/fcntl.h&gt;
macro_line|#include &lt;linux/interrupt.h&gt;
macro_line|#include &lt;linux/ptrace.h&gt;
macro_line|#include &lt;linux/ioport.h&gt;
macro_line|#include &lt;linux/in.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;linux/string.h&gt;
macro_line|#include &lt;linux/pci.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/vmalloc.h&gt;
macro_line|#include &lt;linux/netdevice.h&gt;
macro_line|#include &lt;linux/inetdevice.h&gt;
macro_line|#include &lt;linux/etherdevice.h&gt;
macro_line|#include &lt;linux/skbuff.h&gt;
macro_line|#include &lt;asm/system.h&gt;
macro_line|#include &lt;asm/bitops.h&gt;
macro_line|#include &lt;asm/io.h&gt;
macro_line|#include &lt;asm/dma.h&gt;
macro_line|#include &lt;asm/semaphore.h&gt;
macro_line|#include &lt;linux/dvb/frontend.h&gt;
macro_line|#include &quot;dvb_i2c.h&quot;
macro_line|#include &quot;dvb_frontend.h&quot;
macro_line|#include &quot;dvb_functions.h&quot;
macro_line|#if 1 
DECL|macro|DEBUG_VARIABLE
mdefine_line|#define DEBUG_VARIABLE av7110_debug
macro_line|#else
DECL|macro|DEB_S
mdefine_line|#define DEB_S(x) 
DECL|macro|DEB_D
mdefine_line|#define DEB_D(x) 
DECL|macro|DEB_EE
mdefine_line|#define DEB_EE(x)
macro_line|#endif
macro_line|#include &quot;ttpci-eeprom.h&quot;
macro_line|#include &quot;av7110.h&quot;
macro_line|#include &quot;av7110_ipack.h&quot;
r_static
r_int
id|AV_StartPlay
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
r_int
id|av
)paren
suffix:semicolon
r_static
r_void
id|restart_feeds
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
)paren
suffix:semicolon
r_static
r_int
id|bootarm
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
)paren
suffix:semicolon
r_static
r_inline
r_int
id|i2c_writereg
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u8
id|id
comma
id|u8
id|reg
comma
id|u8
id|val
)paren
suffix:semicolon
r_static
r_inline
id|u8
id|i2c_readreg
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u8
id|id
comma
id|u8
id|reg
)paren
suffix:semicolon
r_static
r_int
id|outcom
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
r_int
id|type
comma
r_int
id|com
comma
r_int
id|num
comma
dot
dot
dot
)paren
suffix:semicolon
r_static
r_void
id|SetMode
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
r_int
id|mode
)paren
suffix:semicolon
r_static
r_void
id|dvb_video_add_event
(paren
r_struct
id|av7110
op_star
id|av7110
comma
r_struct
id|video_event
op_star
id|event
)paren
suffix:semicolon
r_void
id|pes_to_ts
c_func
(paren
id|u8
r_const
op_star
id|buf
comma
r_int
r_int
id|length
comma
id|u16
id|pid
comma
r_struct
id|av7110_p2t
op_star
id|p
)paren
suffix:semicolon
r_void
id|p_to_t
c_func
(paren
id|u8
r_const
op_star
id|buf
comma
r_int
r_int
id|length
comma
id|u16
id|pid
comma
id|u8
op_star
id|counter
comma
r_struct
id|dvb_demux_feed
op_star
id|feed
)paren
suffix:semicolon
DECL|variable|av7110_debug
r_static
r_int
id|av7110_debug
op_assign
l_int|0
suffix:semicolon
DECL|variable|vidmode
r_static
r_int
id|vidmode
op_assign
id|CVBS_RGB_OUT
suffix:semicolon
DECL|variable|pids_off
r_static
r_int
id|pids_off
suffix:semicolon
DECL|variable|adac
r_static
r_int
id|adac
op_assign
id|DVB_ADAC_TI
suffix:semicolon
DECL|variable|hw_sections
r_static
r_int
id|hw_sections
op_assign
l_int|1
suffix:semicolon
DECL|variable|av7110_num
r_int
id|av7110_num
op_assign
l_int|0
suffix:semicolon
DECL|macro|FW_CI_LL_SUPPORT
mdefine_line|#define FW_CI_LL_SUPPORT(arm_app) ((arm_app) &amp; 0x80000000)
DECL|macro|FW_VERSION
mdefine_line|#define FW_VERSION(arm_app)       ((arm_app) &amp; 0x0000FFFF)
multiline_comment|/****************************************************************************&n; * DEBI functions&n; ****************************************************************************/
multiline_comment|/* This DEBI code is based on the Stradis driver &n;   by Nathan Laredo &lt;laredo@gnu.org&gt; */
DECL|function|wait_for_debi_done
r_static
r_int
id|wait_for_debi_done
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
)paren
(brace
r_struct
id|saa7146_dev
op_star
id|dev
op_assign
id|av7110-&gt;dev
suffix:semicolon
r_int
id|start
suffix:semicolon
multiline_comment|/* wait for registers to be programmed */
id|start
op_assign
id|jiffies
suffix:semicolon
r_while
c_loop
(paren
l_int|1
)paren
(brace
r_if
c_cond
(paren
id|saa7146_read
c_func
(paren
id|dev
comma
id|MC2
)paren
op_amp
l_int|2
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
id|jiffies
op_minus
id|start
OG
id|HZ
op_div
l_int|20
)paren
(brace
id|printk
(paren
l_string|&quot;%s: timed out while waiting for registers &quot;
l_string|&quot;getting programmed&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_return
op_minus
id|ETIMEDOUT
suffix:semicolon
)brace
)brace
multiline_comment|/* wait for transfer to complete */
id|start
op_assign
id|jiffies
suffix:semicolon
r_while
c_loop
(paren
l_int|1
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|saa7146_read
c_func
(paren
id|dev
comma
id|PSR
)paren
op_amp
id|SPCI_DEBI_S
)paren
)paren
r_break
suffix:semicolon
id|saa7146_read
c_func
(paren
id|dev
comma
id|MC2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|jiffies
op_minus
id|start
OG
id|HZ
op_div
l_int|4
)paren
(brace
id|printk
(paren
l_string|&quot;%s: timed out while waiting for transfer &quot;
l_string|&quot;completion&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_return
op_minus
id|ETIMEDOUT
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|debiwrite
r_static
r_int
id|debiwrite
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u32
id|config
comma
r_int
id|addr
comma
id|u32
id|val
comma
r_int
id|count
)paren
(brace
r_struct
id|saa7146_dev
op_star
id|dev
op_assign
id|av7110-&gt;dev
suffix:semicolon
id|u32
id|cmd
suffix:semicolon
r_if
c_cond
(paren
id|count
op_le
l_int|0
op_logical_or
id|count
OG
l_int|32764
)paren
r_return
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|wait_for_debi_done
c_func
(paren
id|av7110
)paren
OL
l_int|0
)paren
r_return
op_minus
l_int|1
suffix:semicolon
id|saa7146_write
c_func
(paren
id|dev
comma
id|DEBI_CONFIG
comma
id|config
)paren
suffix:semicolon
r_if
c_cond
(paren
id|count
op_le
l_int|4
)paren
multiline_comment|/* immediate transfer */
id|saa7146_write
c_func
(paren
id|dev
comma
id|DEBI_AD
comma
id|val
)paren
suffix:semicolon
r_else
multiline_comment|/* block transfer */
id|saa7146_write
c_func
(paren
id|dev
comma
id|DEBI_AD
comma
id|av7110-&gt;debi_bus
)paren
suffix:semicolon
id|saa7146_write
c_func
(paren
id|dev
comma
id|DEBI_COMMAND
comma
(paren
id|cmd
op_assign
(paren
id|count
op_lshift
l_int|17
)paren
op_or
(paren
id|addr
op_amp
l_int|0xffff
)paren
)paren
)paren
suffix:semicolon
id|saa7146_write
c_func
(paren
id|dev
comma
id|MC2
comma
(paren
l_int|2
op_lshift
l_int|16
)paren
op_or
l_int|2
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|debiread
r_static
id|u32
id|debiread
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u32
id|config
comma
r_int
id|addr
comma
r_int
id|count
)paren
(brace
r_struct
id|saa7146_dev
op_star
id|dev
op_assign
id|av7110-&gt;dev
suffix:semicolon
id|u32
id|result
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|count
OG
l_int|32764
op_logical_or
id|count
op_le
l_int|0
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|wait_for_debi_done
c_func
(paren
id|av7110
)paren
OL
l_int|0
)paren
r_return
l_int|0
suffix:semicolon
id|saa7146_write
c_func
(paren
id|dev
comma
id|DEBI_AD
comma
id|av7110-&gt;debi_bus
)paren
suffix:semicolon
id|saa7146_write
c_func
(paren
id|dev
comma
id|DEBI_COMMAND
comma
(paren
id|count
op_lshift
l_int|17
)paren
op_or
l_int|0x10000
op_or
(paren
id|addr
op_amp
l_int|0xffff
)paren
)paren
suffix:semicolon
id|saa7146_write
c_func
(paren
id|dev
comma
id|DEBI_CONFIG
comma
id|config
)paren
suffix:semicolon
id|saa7146_write
c_func
(paren
id|dev
comma
id|MC2
comma
(paren
l_int|2
op_lshift
l_int|16
)paren
op_or
l_int|2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|count
OG
l_int|4
)paren
r_return
id|count
suffix:semicolon
id|wait_for_debi_done
c_func
(paren
id|av7110
)paren
suffix:semicolon
id|result
op_assign
id|saa7146_read
c_func
(paren
id|dev
comma
id|DEBI_AD
)paren
suffix:semicolon
id|result
op_and_assign
(paren
l_int|0xffffffffUL
op_rshift
(paren
(paren
l_int|4
op_minus
id|count
)paren
op_star
l_int|8
)paren
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
multiline_comment|/* DEBI during interrupt */
multiline_comment|/* single word writes */
DECL|function|iwdebi
r_static
r_inline
r_void
id|iwdebi
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u32
id|config
comma
r_int
id|addr
comma
id|u32
id|val
comma
r_int
id|count
)paren
(brace
id|debiwrite
c_func
(paren
id|av7110
comma
id|config
comma
id|addr
comma
id|val
comma
id|count
)paren
suffix:semicolon
)brace
multiline_comment|/* buffer writes */
DECL|function|mwdebi
r_static
r_inline
r_void
id|mwdebi
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u32
id|config
comma
r_int
id|addr
comma
r_char
op_star
id|val
comma
r_int
id|count
)paren
(brace
id|memcpy
c_func
(paren
id|av7110-&gt;debi_virt
comma
id|val
comma
id|count
)paren
suffix:semicolon
id|debiwrite
c_func
(paren
id|av7110
comma
id|config
comma
id|addr
comma
l_int|0
comma
id|count
)paren
suffix:semicolon
)brace
DECL|function|irdebi
r_static
r_inline
id|u32
id|irdebi
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u32
id|config
comma
r_int
id|addr
comma
id|u32
id|val
comma
r_int
id|count
)paren
(brace
id|u32
id|res
suffix:semicolon
id|res
op_assign
id|debiread
c_func
(paren
id|av7110
comma
id|config
comma
id|addr
comma
id|count
)paren
suffix:semicolon
r_if
c_cond
(paren
id|count
op_le
l_int|4
)paren
id|memcpy
c_func
(paren
id|av7110-&gt;debi_virt
comma
(paren
r_char
op_star
)paren
op_amp
id|res
comma
id|count
)paren
suffix:semicolon
r_return
id|res
suffix:semicolon
)brace
multiline_comment|/* DEBI outside interrupts, only for count&lt;=4! */
DECL|function|wdebi
r_static
r_inline
r_void
id|wdebi
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u32
id|config
comma
r_int
id|addr
comma
id|u32
id|val
comma
r_int
id|count
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|av7110-&gt;debilock
comma
id|flags
)paren
suffix:semicolon
id|debiwrite
c_func
(paren
id|av7110
comma
id|config
comma
id|addr
comma
id|val
comma
id|count
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|av7110-&gt;debilock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|rdebi
r_static
r_inline
id|u32
id|rdebi
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u32
id|config
comma
r_int
id|addr
comma
id|u32
id|val
comma
r_int
id|count
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
id|u32
id|res
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|av7110-&gt;debilock
comma
id|flags
)paren
suffix:semicolon
id|res
op_assign
id|debiread
c_func
(paren
id|av7110
comma
id|config
comma
id|addr
comma
id|count
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|av7110-&gt;debilock
comma
id|flags
)paren
suffix:semicolon
r_return
id|res
suffix:semicolon
)brace
DECL|function|chtrans
r_static
r_inline
r_char
id|chtrans
c_func
(paren
r_char
id|c
)paren
(brace
r_if
c_cond
(paren
id|c
l_int|126
)paren
id|c
op_assign
l_int|0x20
suffix:semicolon
r_return
id|c
suffix:semicolon
)brace
multiline_comment|/* handle mailbox registers of the dual ported RAM */
DECL|function|ARM_ResetMailBox
r_static
r_inline
r_void
id|ARM_ResetMailBox
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|av7110-&gt;debilock
comma
id|flags
)paren
suffix:semicolon
id|debiread
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|IRQ_RX
comma
l_int|2
)paren
suffix:semicolon
singleline_comment|//printk(&quot;dvb: IRQ_RX=%d&bslash;n&quot;, debiread(av7110, DEBINOSWAP, IRQ_RX, 2));
id|debiwrite
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|IRQ_RX
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|av7110-&gt;debilock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|ARM_ClearMailBox
r_static
r_inline
r_void
id|ARM_ClearMailBox
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
)paren
(brace
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|IRQ_RX
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
)brace
DECL|function|ARM_ClearIrq
r_static
r_inline
r_void
id|ARM_ClearIrq
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
)paren
(brace
id|irdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|IRQ_RX
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
)brace
DECL|function|reset_arm
r_static
r_void
id|reset_arm
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
)paren
(brace
id|saa7146_setgpio
c_func
(paren
id|av7110-&gt;dev
comma
id|RESET_LINE
comma
id|SAA7146_GPIO_OUTLO
)paren
suffix:semicolon
multiline_comment|/* Disable DEBI and GPIO irq */
id|IER_DISABLE
c_func
(paren
id|av7110-&gt;dev
comma
(paren
id|MASK_19
op_or
id|MASK_03
)paren
)paren
suffix:semicolon
singleline_comment|//        saa7146_write(av7110-&gt;dev, IER, 
singleline_comment|//                      saa7146_read(av7110-&gt;dev, IER) &amp; ~(MASK_19 | MASK_03));
id|saa7146_write
c_func
(paren
id|av7110-&gt;dev
comma
id|ISR
comma
(paren
id|MASK_19
op_or
id|MASK_03
)paren
)paren
suffix:semicolon
id|mdelay
c_func
(paren
l_int|800
)paren
suffix:semicolon
id|saa7146_setgpio
c_func
(paren
id|av7110-&gt;dev
comma
id|RESET_LINE
comma
id|SAA7146_GPIO_OUTHI
)paren
suffix:semicolon
id|mdelay
c_func
(paren
l_int|800
)paren
suffix:semicolon
id|ARM_ResetMailBox
c_func
(paren
id|av7110
)paren
suffix:semicolon
id|saa7146_write
c_func
(paren
id|av7110-&gt;dev
comma
id|ISR
comma
(paren
id|MASK_19
op_or
id|MASK_03
)paren
)paren
suffix:semicolon
id|IER_ENABLE
c_func
(paren
id|av7110-&gt;dev
comma
id|MASK_03
)paren
suffix:semicolon
singleline_comment|//        saa7146_write(av7110-&gt;dev, IER, 
singleline_comment|//                      saa7146_read(av7110-&gt;dev, IER) | MASK_03 );
id|av7110-&gt;arm_ready
op_assign
l_int|1
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;av7110: ARM RESET&bslash;n&quot;
)paren
suffix:semicolon
)brace
DECL|function|recover_arm
r_static
r_void
id|recover_arm
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
)paren
(brace
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|current-&gt;files
)paren
id|bootarm
c_func
(paren
id|av7110
)paren
suffix:semicolon
r_else
(brace
id|printk
c_func
(paren
l_string|&quot;OOPS, no current-&gt;files&bslash;n&quot;
)paren
suffix:semicolon
id|reset_arm
c_func
(paren
id|av7110
)paren
suffix:semicolon
)brace
id|dvb_delay
c_func
(paren
l_int|100
)paren
suffix:semicolon
id|restart_feeds
c_func
(paren
id|av7110
)paren
suffix:semicolon
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_PIDFILTER
comma
id|SetIR
comma
l_int|1
comma
id|av7110-&gt;ir_config
)paren
suffix:semicolon
)brace
DECL|function|arm_error
r_static
r_void
id|arm_error
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
)paren
(brace
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
id|av7110-&gt;arm_errors
op_increment
suffix:semicolon
id|av7110-&gt;arm_ready
op_assign
l_int|0
suffix:semicolon
id|recover_arm
c_func
(paren
id|av7110
)paren
suffix:semicolon
)brace
DECL|function|arm_thread
r_static
r_int
id|arm_thread
c_func
(paren
r_void
op_star
id|data
)paren
(brace
r_struct
id|av7110
op_star
id|av7110
op_assign
id|data
suffix:semicolon
id|u16
id|newloops
op_assign
l_int|0
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
id|dvb_kernel_thread_setup
(paren
l_string|&quot;arm_mon&quot;
)paren
suffix:semicolon
id|av7110-&gt;arm_thread
op_assign
id|current
suffix:semicolon
r_while
c_loop
(paren
op_logical_neg
id|av7110-&gt;arm_rmmod
op_logical_and
op_logical_neg
id|signal_pending
c_func
(paren
id|current
)paren
)paren
(brace
id|interruptible_sleep_on_timeout
c_func
(paren
op_amp
id|av7110-&gt;arm_wait
comma
l_int|5
op_star
id|HZ
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|av7110-&gt;arm_ready
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|down_interruptible
c_func
(paren
op_amp
id|av7110-&gt;dcomlock
)paren
)paren
r_break
suffix:semicolon
id|newloops
op_assign
id|rdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|STATUS_LOOPS
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|av7110-&gt;dcomlock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|newloops
op_eq
id|av7110-&gt;arm_loops
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;av7110%d: ARM crashed!&bslash;n&quot;
comma
id|av7110-&gt;dvb_adapter-&gt;num
)paren
suffix:semicolon
id|arm_error
c_func
(paren
id|av7110
)paren
suffix:semicolon
r_if
c_cond
(paren
id|down_interruptible
c_func
(paren
op_amp
id|av7110-&gt;dcomlock
)paren
)paren
r_break
suffix:semicolon
id|newloops
op_assign
id|rdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|STATUS_LOOPS
comma
l_int|0
comma
l_int|2
)paren
op_minus
l_int|1
suffix:semicolon
id|up
c_func
(paren
op_amp
id|av7110-&gt;dcomlock
)paren
suffix:semicolon
)brace
id|av7110-&gt;arm_loops
op_assign
id|newloops
suffix:semicolon
)brace
id|av7110-&gt;arm_thread
op_assign
l_int|NULL
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|record_cb
r_static
r_int
id|record_cb
c_func
(paren
r_struct
id|dvb_filter_pes2ts
op_star
id|p2t
comma
id|u8
op_star
id|buf
comma
r_int
id|len
)paren
(brace
r_struct
id|dvb_demux_feed
op_star
id|dvbdmxfeed
op_assign
(paren
r_struct
id|dvb_demux_feed
op_star
)paren
id|p2t-&gt;priv
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;struct dvb_filter_pes2ts:%p&bslash;n&quot;
comma
id|p2t
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|dvbdmxfeed-&gt;ts_type
op_amp
id|TS_PACKET
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|buf
(braket
l_int|3
)braket
op_eq
l_int|0xe0
)paren
singleline_comment|// video PES do not have a length in TS
id|buf
(braket
l_int|4
)braket
op_assign
id|buf
(braket
l_int|5
)braket
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|dvbdmxfeed-&gt;ts_type
op_amp
id|TS_PAYLOAD_ONLY
)paren
r_return
id|dvbdmxfeed-&gt;cb
dot
id|ts
c_func
(paren
id|buf
comma
id|len
comma
l_int|0
comma
l_int|0
comma
op_amp
id|dvbdmxfeed-&gt;feed.ts
comma
id|DMX_OK
)paren
suffix:semicolon
r_else
r_return
id|dvb_filter_pes2ts
c_func
(paren
id|p2t
comma
id|buf
comma
id|len
)paren
suffix:semicolon
)brace
DECL|function|dvb_filter_pes2ts_cb
r_static
r_int
id|dvb_filter_pes2ts_cb
c_func
(paren
r_void
op_star
id|priv
comma
r_int
r_char
op_star
id|data
)paren
(brace
r_struct
id|dvb_demux_feed
op_star
id|dvbdmxfeed
op_assign
(paren
r_struct
id|dvb_demux_feed
op_star
)paren
id|priv
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;dvb_demux_feed:%p&bslash;n&quot;
comma
id|dvbdmxfeed
)paren
)paren
suffix:semicolon
id|dvbdmxfeed-&gt;cb
dot
id|ts
c_func
(paren
id|data
comma
l_int|188
comma
l_int|0
comma
l_int|0
comma
op_amp
id|dvbdmxfeed-&gt;feed.ts
comma
id|DMX_OK
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|AV_StartRecord
r_static
r_int
id|AV_StartRecord
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
r_int
id|av
comma
r_struct
id|dvb_demux_feed
op_star
id|dvbdmxfeed
)paren
(brace
r_struct
id|dvb_demux
op_star
id|dvbdmx
op_assign
id|dvbdmxfeed-&gt;demux
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p, dvb_demux_feed:%p&bslash;n&quot;
comma
id|av7110
comma
id|dvbdmxfeed
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|av7110-&gt;playing
op_logical_or
(paren
id|av7110-&gt;rec_mode
op_amp
id|av
)paren
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_REC_PLAY
comma
id|__Stop
comma
l_int|0
)paren
suffix:semicolon
id|dvbdmx-&gt;recording
op_assign
l_int|1
suffix:semicolon
id|av7110-&gt;rec_mode
op_or_assign
id|av
suffix:semicolon
r_switch
c_cond
(paren
id|av7110-&gt;rec_mode
)paren
(brace
r_case
id|RP_AUDIO
suffix:colon
id|dvb_filter_pes2ts_init
(paren
op_amp
id|av7110-&gt;p2t
(braket
l_int|0
)braket
comma
id|dvbdmx-&gt;pesfilter
(braket
l_int|0
)braket
op_member_access_from_pointer
id|pid
comma
id|dvb_filter_pes2ts_cb
comma
(paren
r_void
op_star
)paren
id|dvbdmx-&gt;pesfilter
(braket
l_int|0
)braket
)paren
suffix:semicolon
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_REC_PLAY
comma
id|__Record
comma
l_int|2
comma
id|AudioPES
comma
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|RP_VIDEO
suffix:colon
id|dvb_filter_pes2ts_init
(paren
op_amp
id|av7110-&gt;p2t
(braket
l_int|1
)braket
comma
id|dvbdmx-&gt;pesfilter
(braket
l_int|1
)braket
op_member_access_from_pointer
id|pid
comma
id|dvb_filter_pes2ts_cb
comma
(paren
r_void
op_star
)paren
id|dvbdmx-&gt;pesfilter
(braket
l_int|1
)braket
)paren
suffix:semicolon
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_REC_PLAY
comma
id|__Record
comma
l_int|2
comma
id|VideoPES
comma
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|RP_AV
suffix:colon
id|dvb_filter_pes2ts_init
(paren
op_amp
id|av7110-&gt;p2t
(braket
l_int|0
)braket
comma
id|dvbdmx-&gt;pesfilter
(braket
l_int|0
)braket
op_member_access_from_pointer
id|pid
comma
id|dvb_filter_pes2ts_cb
comma
(paren
r_void
op_star
)paren
id|dvbdmx-&gt;pesfilter
(braket
l_int|0
)braket
)paren
suffix:semicolon
id|dvb_filter_pes2ts_init
(paren
op_amp
id|av7110-&gt;p2t
(braket
l_int|1
)braket
comma
id|dvbdmx-&gt;pesfilter
(braket
l_int|1
)braket
op_member_access_from_pointer
id|pid
comma
id|dvb_filter_pes2ts_cb
comma
(paren
r_void
op_star
)paren
id|dvbdmx-&gt;pesfilter
(braket
l_int|1
)braket
)paren
suffix:semicolon
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_REC_PLAY
comma
id|__Record
comma
l_int|2
comma
id|AV_PES
comma
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|AV_StartPlay
r_static
r_int
id|AV_StartPlay
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
r_int
id|av
)paren
(brace
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|av7110-&gt;rec_mode
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
r_if
c_cond
(paren
id|av7110-&gt;playing
op_amp
id|av
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_REC_PLAY
comma
id|__Stop
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|av7110-&gt;playing
op_eq
id|RP_NONE
)paren
(brace
id|av7110_ipack_reset
c_func
(paren
op_amp
id|av7110-&gt;ipack
(braket
l_int|0
)braket
)paren
suffix:semicolon
id|av7110_ipack_reset
c_func
(paren
op_amp
id|av7110-&gt;ipack
(braket
l_int|1
)braket
)paren
suffix:semicolon
)brace
id|av7110-&gt;playing
op_or_assign
id|av
suffix:semicolon
r_switch
c_cond
(paren
id|av7110-&gt;playing
)paren
(brace
r_case
id|RP_AUDIO
suffix:colon
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_REC_PLAY
comma
id|__Play
comma
l_int|2
comma
id|AudioPES
comma
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|RP_VIDEO
suffix:colon
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_REC_PLAY
comma
id|__Play
comma
l_int|2
comma
id|VideoPES
comma
l_int|0
)paren
suffix:semicolon
id|av7110-&gt;sinfo
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
id|RP_AV
suffix:colon
id|av7110-&gt;sinfo
op_assign
l_int|0
suffix:semicolon
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_REC_PLAY
comma
id|__Play
comma
l_int|2
comma
id|AV_PES
comma
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_return
id|av7110-&gt;playing
suffix:semicolon
)brace
DECL|function|AV_Stop
r_static
r_void
id|AV_Stop
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
r_int
id|av
)paren
(brace
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|av7110-&gt;playing
op_amp
id|av
)paren
op_logical_and
op_logical_neg
(paren
id|av7110-&gt;rec_mode
op_amp
id|av
)paren
)paren
r_return
suffix:semicolon
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_REC_PLAY
comma
id|__Stop
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|av7110-&gt;playing
)paren
(brace
id|av7110-&gt;playing
op_and_assign
op_complement
id|av
suffix:semicolon
r_switch
c_cond
(paren
id|av7110-&gt;playing
)paren
(brace
r_case
id|RP_AUDIO
suffix:colon
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_REC_PLAY
comma
id|__Play
comma
l_int|2
comma
id|AudioPES
comma
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|RP_VIDEO
suffix:colon
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_REC_PLAY
comma
id|__Play
comma
l_int|2
comma
id|VideoPES
comma
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|RP_NONE
suffix:colon
id|SetMode
c_func
(paren
id|av7110
comma
id|av7110-&gt;vidmode
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_else
(brace
id|av7110-&gt;rec_mode
op_and_assign
op_complement
id|av
suffix:semicolon
r_switch
c_cond
(paren
id|av7110-&gt;rec_mode
)paren
(brace
r_case
id|RP_AUDIO
suffix:colon
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_REC_PLAY
comma
id|__Record
comma
l_int|2
comma
id|AudioPES
comma
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|RP_VIDEO
suffix:colon
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_REC_PLAY
comma
id|__Record
comma
l_int|2
comma
id|VideoPES
comma
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|RP_NONE
suffix:colon
r_break
suffix:semicolon
)brace
)brace
)brace
multiline_comment|/**&n; *  Hack! we save the last av7110 ptr. This should be ok, since&n; *  you rarely will use more then one IR control. &n; *&n; *  If we want to support multiple controls we would have to do much more...&n; */
DECL|function|av7110_setup_irc_config
r_void
id|av7110_setup_irc_config
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u32
id|ir_config
)paren
(brace
r_static
r_struct
id|av7110
op_star
id|last
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|av7110
)paren
id|av7110
op_assign
id|last
suffix:semicolon
r_else
id|last
op_assign
id|av7110
suffix:semicolon
r_if
c_cond
(paren
id|av7110
)paren
(brace
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_PIDFILTER
comma
id|SetIR
comma
l_int|1
comma
id|ir_config
)paren
suffix:semicolon
id|av7110-&gt;ir_config
op_assign
id|ir_config
suffix:semicolon
)brace
)brace
DECL|variable|irc_handler
r_static
r_void
(paren
op_star
id|irc_handler
)paren
(paren
id|u32
)paren
suffix:semicolon
DECL|function|av7110_register_irc_handler
r_void
id|av7110_register_irc_handler
c_func
(paren
r_void
(paren
op_star
id|func
)paren
(paren
id|u32
)paren
)paren
(brace
singleline_comment|//DEB_EE((&quot;registering %08x&bslash;n&quot;,func));
id|irc_handler
op_assign
id|func
suffix:semicolon
)brace
DECL|function|av7110_unregister_irc_handler
r_void
id|av7110_unregister_irc_handler
c_func
(paren
r_void
(paren
op_star
id|func
)paren
(paren
id|u32
)paren
)paren
(brace
singleline_comment|//DEB_EE((&quot;unregistering %08x&bslash;n&quot;,func));
id|irc_handler
op_assign
l_int|NULL
suffix:semicolon
)brace
DECL|function|run_handlers
r_void
id|run_handlers
c_func
(paren
r_int
r_int
id|ircom
)paren
(brace
r_if
c_cond
(paren
id|irc_handler
op_ne
l_int|NULL
)paren
(paren
op_star
id|irc_handler
)paren
(paren
(paren
id|u32
)paren
id|ircom
)paren
suffix:semicolon
)brace
id|DECLARE_TASKLET
c_func
(paren
id|irtask
comma
id|run_handlers
comma
l_int|0
)paren
suffix:semicolon
DECL|function|IR_handle
r_void
id|IR_handle
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u32
id|ircom
)paren
(brace
id|DEB_S
c_func
(paren
(paren
l_string|&quot;av7110: ircommand = %08x&bslash;n&quot;
comma
id|ircom
)paren
)paren
suffix:semicolon
id|irtask.data
op_assign
(paren
r_int
r_int
)paren
id|ircom
suffix:semicolon
id|tasklet_schedule
c_func
(paren
op_amp
id|irtask
)paren
suffix:semicolon
)brace
multiline_comment|/****************************************************************************&n; * IRQ handling&n; ****************************************************************************/
DECL|function|CI_handle
r_void
id|CI_handle
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u8
op_star
id|data
comma
id|u16
id|len
)paren
(brace
singleline_comment|//CI_out(av7110, data, len);
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|len
OL
l_int|3
)paren
r_return
suffix:semicolon
r_switch
c_cond
(paren
id|data
(braket
l_int|0
)braket
)paren
(brace
r_case
id|CI_MSG_CI_INFO
suffix:colon
r_if
c_cond
(paren
id|data
(braket
l_int|2
)braket
op_ne
l_int|1
op_logical_and
id|data
(braket
l_int|2
)braket
op_ne
l_int|2
)paren
r_break
suffix:semicolon
r_switch
c_cond
(paren
id|data
(braket
l_int|1
)braket
)paren
(brace
r_case
l_int|0
suffix:colon
id|av7110-&gt;ci_slot
(braket
id|data
(braket
l_int|2
)braket
op_minus
l_int|1
)braket
dot
id|flags
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|av7110-&gt;ci_slot
(braket
id|data
(braket
l_int|2
)braket
op_minus
l_int|1
)braket
dot
id|flags
op_or_assign
id|CA_CI_MODULE_PRESENT
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|av7110-&gt;ci_slot
(braket
id|data
(braket
l_int|2
)braket
op_minus
l_int|1
)braket
dot
id|flags
op_or_assign
id|CA_CI_MODULE_READY
suffix:semicolon
r_break
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|CI_SWITCH_PRG_REPLY
suffix:colon
singleline_comment|//av7110-&gt;ci_stat=data[1];
r_break
suffix:semicolon
r_default
suffix:colon
r_break
suffix:semicolon
)brace
)brace
DECL|function|DvbDmxFilterCallback
r_static
r_inline
r_int
id|DvbDmxFilterCallback
c_func
(paren
id|u8
op_star
id|buffer1
comma
r_int
id|buffer1_len
comma
id|u8
op_star
id|buffer2
comma
r_int
id|buffer2_len
comma
r_struct
id|dvb_demux_filter
op_star
id|dvbdmxfilter
comma
r_enum
id|dmx_success
id|success
comma
r_struct
id|av7110
op_star
id|av7110
)paren
(brace
id|DEB_INT
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dvbdmxfilter-&gt;feed-&gt;demux-&gt;dmx.frontend
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|dvbdmxfilter-&gt;feed-&gt;demux-&gt;dmx.frontend-&gt;source
op_eq
id|DMX_MEMORY_FE
)paren
r_return
l_int|0
suffix:semicolon
r_switch
c_cond
(paren
id|dvbdmxfilter-&gt;type
)paren
(brace
r_case
id|DMX_TYPE_SEC
suffix:colon
r_if
c_cond
(paren
(paren
(paren
(paren
id|buffer1
(braket
l_int|1
)braket
op_lshift
l_int|8
)paren
op_or
id|buffer1
(braket
l_int|2
)braket
)paren
op_amp
l_int|0xfff
)paren
op_plus
l_int|3
op_ne
id|buffer1_len
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|dvbdmxfilter-&gt;doneq
)paren
(brace
r_struct
id|dmx_section_filter
op_star
id|filter
op_assign
op_amp
id|dvbdmxfilter-&gt;filter
suffix:semicolon
r_int
id|i
suffix:semicolon
id|u8
op_xor
comma
id|neq
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|DVB_DEMUX_MASK_MAX
suffix:semicolon
id|i
op_increment
)paren
(brace
op_xor
op_assign
id|filter-&gt;filter_value
(braket
id|i
)braket
op_xor
id|buffer1
(braket
id|i
)braket
suffix:semicolon
id|neq
op_or_assign
id|dvbdmxfilter-&gt;maskandnotmode
(braket
id|i
)braket
op_amp
op_xor
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|neq
)paren
r_return
l_int|0
suffix:semicolon
)brace
r_return
id|dvbdmxfilter-&gt;feed-&gt;cb
dot
id|sec
c_func
(paren
id|buffer1
comma
id|buffer1_len
comma
id|buffer2
comma
id|buffer2_len
comma
op_amp
id|dvbdmxfilter-&gt;filter
comma
id|DMX_OK
)paren
suffix:semicolon
r_case
id|DMX_TYPE_TS
suffix:colon
r_if
c_cond
(paren
op_logical_neg
(paren
id|dvbdmxfilter-&gt;feed-&gt;ts_type
op_amp
id|TS_PACKET
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|dvbdmxfilter-&gt;feed-&gt;ts_type
op_amp
id|TS_PAYLOAD_ONLY
)paren
r_return
id|dvbdmxfilter-&gt;feed-&gt;cb
dot
id|ts
c_func
(paren
id|buffer1
comma
id|buffer1_len
comma
id|buffer2
comma
id|buffer2_len
comma
op_amp
id|dvbdmxfilter-&gt;feed-&gt;feed.ts
comma
id|DMX_OK
)paren
suffix:semicolon
r_else
id|pes_to_ts
c_func
(paren
id|buffer1
comma
id|buffer1_len
comma
id|dvbdmxfilter-&gt;feed-&gt;pid
comma
op_amp
id|av7110-&gt;p2t_filter
(braket
id|dvbdmxfilter-&gt;index
)braket
)paren
suffix:semicolon
r_default
suffix:colon
r_return
l_int|0
suffix:semicolon
)brace
)brace
DECL|variable|pshead
id|u8
id|pshead
(braket
l_int|0x26
)braket
op_assign
(brace
l_int|0x00
comma
l_int|0x00
comma
l_int|0x01
comma
l_int|0xba
comma
l_int|0x5f
comma
l_int|0xff
comma
l_int|0xfe
comma
l_int|0xe6
comma
l_int|0xc4
comma
l_int|0x01
comma
l_int|0x01
comma
l_int|0x89
comma
l_int|0xc3
comma
l_int|0xf8
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x01
comma
l_int|0xbb
comma
l_int|0x00
comma
l_int|0x12
comma
l_int|0x80
comma
l_int|0xc4
comma
l_int|0xe1
comma
l_int|0x00
comma
l_int|0xe1
comma
l_int|0xff
comma
l_int|0xb9
comma
l_int|0xe0
comma
l_int|0xe8
comma
l_int|0xb8
comma
l_int|0xc0
comma
l_int|0x20
comma
l_int|0xbd
comma
l_int|0xe0
comma
l_int|0x44
comma
l_int|0xbf
comma
l_int|0xe0
comma
l_int|0x02
comma
)brace
suffix:semicolon
singleline_comment|//#define DEBUG_TIMING
DECL|function|print_time
r_static
r_inline
r_void
id|print_time
c_func
(paren
r_char
op_star
id|s
)paren
(brace
macro_line|#ifdef DEBUG_TIMING
r_struct
id|timeval
id|tv
suffix:semicolon
id|do_gettimeofday
c_func
(paren
op_amp
id|tv
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s: %d.%d&bslash;n&quot;
comma
id|s
comma
(paren
r_int
)paren
id|tv.tv_sec
comma
(paren
r_int
)paren
id|tv.tv_usec
)paren
suffix:semicolon
macro_line|#endif
)brace
DECL|function|ci_get_data
r_static
r_void
id|ci_get_data
c_func
(paren
r_struct
id|dvb_ringbuffer
op_star
id|cibuf
comma
id|u8
op_star
id|data
comma
r_int
id|len
)paren
(brace
r_if
c_cond
(paren
id|dvb_ringbuffer_free
c_func
(paren
id|cibuf
)paren
OL
id|len
op_plus
l_int|2
)paren
r_return
suffix:semicolon
id|DVB_RINGBUFFER_WRITE_BYTE
c_func
(paren
id|cibuf
comma
id|len
op_rshift
l_int|8
)paren
suffix:semicolon
id|DVB_RINGBUFFER_WRITE_BYTE
c_func
(paren
id|cibuf
comma
id|len
op_amp
l_int|0xff
)paren
suffix:semicolon
id|dvb_ringbuffer_write
c_func
(paren
id|cibuf
comma
id|data
comma
id|len
comma
l_int|0
)paren
suffix:semicolon
id|wake_up_interruptible
c_func
(paren
op_amp
id|cibuf-&gt;queue
)paren
suffix:semicolon
)brace
DECL|function|debiirq
r_static
r_void
id|debiirq
(paren
r_int
r_int
id|data
)paren
(brace
r_struct
id|av7110
op_star
id|av7110
op_assign
(paren
r_struct
id|av7110
op_star
)paren
id|data
suffix:semicolon
r_int
id|type
op_assign
id|av7110-&gt;debitype
suffix:semicolon
r_int
id|handle
op_assign
(paren
id|type
op_rshift
l_int|8
)paren
op_amp
l_int|0x1f
suffix:semicolon
singleline_comment|//&t;DEB_EE((&quot;av7110: %p&bslash;n&quot;,av7110));
id|print_time
c_func
(paren
l_string|&quot;debi&quot;
)paren
suffix:semicolon
id|saa7146_write
c_func
(paren
id|av7110-&gt;dev
comma
id|IER
comma
id|saa7146_read
c_func
(paren
id|av7110-&gt;dev
comma
id|IER
)paren
op_amp
op_complement
id|MASK_19
)paren
suffix:semicolon
id|saa7146_write
c_func
(paren
id|av7110-&gt;dev
comma
id|ISR
comma
id|MASK_19
)paren
suffix:semicolon
r_if
c_cond
(paren
id|type
op_eq
op_minus
l_int|1
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;DEBI irq oops @ %ld, psr:0x%08x, ssr:0x%08x&bslash;n&quot;
comma
id|jiffies
comma
id|saa7146_read
c_func
(paren
id|av7110-&gt;dev
comma
id|PSR
)paren
comma
id|saa7146_read
c_func
(paren
id|av7110-&gt;dev
comma
id|SSR
)paren
)paren
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|av7110-&gt;debilock
)paren
suffix:semicolon
id|ARM_ClearMailBox
c_func
(paren
id|av7110
)paren
suffix:semicolon
id|ARM_ClearIrq
c_func
(paren
id|av7110
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|av7110-&gt;debilock
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|av7110-&gt;debitype
op_assign
op_minus
l_int|1
suffix:semicolon
r_switch
c_cond
(paren
id|type
op_amp
l_int|0xff
)paren
(brace
r_case
id|DATA_TS_RECORD
suffix:colon
id|dvb_dmx_swfilter_packets
c_func
(paren
op_amp
id|av7110-&gt;demux
comma
(paren
r_const
id|u8
op_star
)paren
id|av7110-&gt;debi_virt
comma
id|av7110-&gt;debilen
op_div
l_int|188
)paren
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|av7110-&gt;debilock
)paren
suffix:semicolon
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|RX_BUFF
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
id|ARM_ClearMailBox
c_func
(paren
id|av7110
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|av7110-&gt;debilock
)paren
suffix:semicolon
r_return
suffix:semicolon
r_case
id|DATA_PES_RECORD
suffix:colon
r_if
c_cond
(paren
id|av7110-&gt;demux.recording
)paren
id|record_cb
c_func
(paren
op_amp
id|av7110-&gt;p2t
(braket
id|handle
)braket
comma
(paren
id|u8
op_star
)paren
id|av7110-&gt;debi_virt
comma
id|av7110-&gt;debilen
)paren
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|av7110-&gt;debilock
)paren
suffix:semicolon
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|RX_BUFF
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
id|ARM_ClearMailBox
c_func
(paren
id|av7110
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|av7110-&gt;debilock
)paren
suffix:semicolon
r_return
suffix:semicolon
r_case
id|DATA_IPMPE
suffix:colon
r_case
id|DATA_FSECTION
suffix:colon
r_case
id|DATA_PIPING
suffix:colon
r_if
c_cond
(paren
id|av7110-&gt;handle2filter
(braket
id|handle
)braket
)paren
id|DvbDmxFilterCallback
c_func
(paren
(paren
id|u8
op_star
)paren
id|av7110-&gt;debi_virt
comma
id|av7110-&gt;debilen
comma
l_int|0
comma
l_int|0
comma
id|av7110-&gt;handle2filter
(braket
id|handle
)braket
comma
id|DMX_OK
comma
id|av7110
)paren
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|av7110-&gt;debilock
)paren
suffix:semicolon
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|RX_BUFF
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
id|ARM_ClearMailBox
c_func
(paren
id|av7110
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|av7110-&gt;debilock
)paren
suffix:semicolon
r_return
suffix:semicolon
r_case
id|DATA_CI_GET
suffix:colon
(brace
id|u8
op_star
id|data
op_assign
id|av7110-&gt;debi_virt
suffix:semicolon
r_if
c_cond
(paren
(paren
id|data
(braket
l_int|0
)braket
OL
l_int|2
)paren
op_logical_and
id|data
(braket
l_int|2
)braket
op_eq
l_int|0xff
)paren
(brace
r_int
id|flags
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|data
(braket
l_int|5
)braket
OG
l_int|0
)paren
id|flags
op_or_assign
id|CA_CI_MODULE_PRESENT
suffix:semicolon
r_if
c_cond
(paren
id|data
(braket
l_int|5
)braket
OG
l_int|5
)paren
id|flags
op_or_assign
id|CA_CI_MODULE_READY
suffix:semicolon
id|av7110-&gt;ci_slot
(braket
id|data
(braket
l_int|0
)braket
)braket
dot
id|flags
op_assign
id|flags
suffix:semicolon
)brace
r_else
id|ci_get_data
c_func
(paren
op_amp
id|av7110-&gt;ci_rbuffer
comma
id|av7110-&gt;debi_virt
comma
id|av7110-&gt;debilen
)paren
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|av7110-&gt;debilock
)paren
suffix:semicolon
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|RX_BUFF
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
id|ARM_ClearMailBox
c_func
(paren
id|av7110
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|av7110-&gt;debilock
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_case
id|DATA_COMMON_INTERFACE
suffix:colon
id|CI_handle
c_func
(paren
id|av7110
comma
(paren
id|u8
op_star
)paren
id|av7110-&gt;debi_virt
comma
id|av7110-&gt;debilen
)paren
suffix:semicolon
macro_line|#if 0
(brace
r_int
id|i
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;av7110%d: &quot;
comma
id|av7110-&gt;num
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%02x &quot;
comma
op_star
(paren
id|u8
op_star
)paren
id|av7110-&gt;debi_virt
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%02x &quot;
comma
op_star
(paren
l_int|1
op_plus
(paren
id|u8
op_star
)paren
id|av7110-&gt;debi_virt
)paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|2
suffix:semicolon
id|i
OL
id|av7110-&gt;debilen
suffix:semicolon
id|i
op_increment
)paren
id|printk
c_func
(paren
l_string|&quot;%02x &quot;
comma
(paren
op_star
(paren
id|i
op_plus
(paren
r_int
r_char
op_star
)paren
id|av7110-&gt;debi_virt
)paren
)paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|2
suffix:semicolon
id|i
OL
id|av7110-&gt;debilen
suffix:semicolon
id|i
op_increment
)paren
id|printk
c_func
(paren
l_string|&quot;%c&quot;
comma
id|chtrans
c_func
(paren
op_star
(paren
id|i
op_plus
(paren
r_int
r_char
op_star
)paren
id|av7110-&gt;debi_virt
)paren
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
)brace
macro_line|#endif
id|spin_lock
c_func
(paren
op_amp
id|av7110-&gt;debilock
)paren
suffix:semicolon
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|RX_BUFF
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
id|ARM_ClearMailBox
c_func
(paren
id|av7110
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|av7110-&gt;debilock
)paren
suffix:semicolon
r_return
suffix:semicolon
r_case
id|DATA_DEBUG_MESSAGE
suffix:colon
(paren
(paren
id|s8
op_star
)paren
id|av7110-&gt;debi_virt
)paren
(braket
id|Reserved_SIZE
op_minus
l_int|1
)braket
op_assign
l_int|0
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
(paren
id|s8
op_star
)paren
id|av7110-&gt;debi_virt
)paren
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|av7110-&gt;debilock
)paren
suffix:semicolon
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|RX_BUFF
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
id|ARM_ClearMailBox
c_func
(paren
id|av7110
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|av7110-&gt;debilock
)paren
suffix:semicolon
r_return
suffix:semicolon
r_case
id|DATA_CI_PUT
suffix:colon
r_case
id|DATA_MPEG_PLAY
suffix:colon
r_case
id|DATA_BMP_LOAD
suffix:colon
id|spin_lock
c_func
(paren
op_amp
id|av7110-&gt;debilock
)paren
suffix:semicolon
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|TX_BUFF
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
id|ARM_ClearMailBox
c_func
(paren
id|av7110
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|av7110-&gt;debilock
)paren
suffix:semicolon
r_return
suffix:semicolon
r_default
suffix:colon
r_break
suffix:semicolon
)brace
id|spin_lock
c_func
(paren
op_amp
id|av7110-&gt;debilock
)paren
suffix:semicolon
id|ARM_ClearMailBox
c_func
(paren
id|av7110
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|av7110-&gt;debilock
)paren
suffix:semicolon
)brace
DECL|function|pes_play
r_static
r_int
id|pes_play
c_func
(paren
r_void
op_star
id|dest
comma
r_struct
id|dvb_ringbuffer
op_star
id|buf
comma
r_int
id|dlen
)paren
(brace
r_int
id|len
suffix:semicolon
id|u32
id|sync
suffix:semicolon
id|u16
id|blen
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;dvb_ring_buffer_t: %p&bslash;n&quot;
comma
id|buf
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dlen
)paren
(brace
id|wake_up
c_func
(paren
op_amp
id|buf-&gt;queue
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_while
c_loop
(paren
l_int|1
)paren
(brace
r_if
c_cond
(paren
(paren
id|len
op_assign
id|dvb_ringbuffer_avail
c_func
(paren
id|buf
)paren
)paren
OL
l_int|6
)paren
r_return
op_minus
l_int|1
suffix:semicolon
id|sync
op_assign
id|DVB_RINGBUFFER_PEEK
c_func
(paren
id|buf
comma
l_int|0
)paren
op_lshift
l_int|24
suffix:semicolon
id|sync
op_or_assign
id|DVB_RINGBUFFER_PEEK
c_func
(paren
id|buf
comma
l_int|1
)paren
op_lshift
l_int|16
suffix:semicolon
id|sync
op_or_assign
id|DVB_RINGBUFFER_PEEK
c_func
(paren
id|buf
comma
l_int|2
)paren
op_lshift
l_int|8
suffix:semicolon
id|sync
op_or_assign
id|DVB_RINGBUFFER_PEEK
c_func
(paren
id|buf
comma
l_int|3
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
(paren
id|sync
op_amp
op_complement
l_int|0x0f
)paren
op_eq
l_int|0x000001e0
)paren
op_logical_or
(paren
(paren
id|sync
op_amp
op_complement
l_int|0x1f
)paren
op_eq
l_int|0x000001c0
)paren
op_logical_or
(paren
id|sync
op_eq
l_int|0x000001bd
)paren
)paren
r_break
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;resync&bslash;n&quot;
)paren
suffix:semicolon
id|DVB_RINGBUFFER_SKIP
c_func
(paren
id|buf
comma
l_int|1
)paren
suffix:semicolon
)brace
id|blen
op_assign
id|DVB_RINGBUFFER_PEEK
c_func
(paren
id|buf
comma
l_int|4
)paren
op_lshift
l_int|8
suffix:semicolon
id|blen
op_or_assign
id|DVB_RINGBUFFER_PEEK
c_func
(paren
id|buf
comma
l_int|5
)paren
suffix:semicolon
id|blen
op_add_assign
l_int|6
suffix:semicolon
r_if
c_cond
(paren
id|len
id|dlen
)paren
(brace
singleline_comment|//printk(&quot;buffer empty - avail %d blen %u dlen %d&bslash;n&quot;,len,blen,dlen);
id|wake_up
c_func
(paren
op_amp
id|buf-&gt;queue
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
(paren
r_void
)paren
id|dvb_ringbuffer_read
c_func
(paren
id|buf
comma
id|dest
comma
(paren
r_int
)paren
id|blen
comma
l_int|0
)paren
suffix:semicolon
id|DEB_S
c_func
(paren
(paren
l_string|&quot;pread=0x%08lx, pwrite=0x%08lx&bslash;n&quot;
comma
(paren
r_int
r_int
)paren
id|buf-&gt;pread
comma
(paren
r_int
r_int
)paren
id|buf-&gt;pwrite
)paren
)paren
suffix:semicolon
id|wake_up
c_func
(paren
op_amp
id|buf-&gt;queue
)paren
suffix:semicolon
r_return
id|blen
suffix:semicolon
)brace
DECL|function|gpioirq
r_static
r_void
id|gpioirq
(paren
r_int
r_int
id|data
)paren
(brace
r_struct
id|av7110
op_star
id|av7110
op_assign
(paren
r_struct
id|av7110
op_star
)paren
id|data
suffix:semicolon
id|u32
id|rxbuf
comma
id|txbuf
suffix:semicolon
r_int
id|len
suffix:semicolon
singleline_comment|//printk(&quot;GPIO0 irq&bslash;n&quot;);        
r_if
c_cond
(paren
id|av7110-&gt;debitype
op_ne
op_minus
l_int|1
)paren
id|printk
c_func
(paren
l_string|&quot;GPIO0 irq oops @ %ld, psr:0x%08x, ssr:0x%08x&bslash;n&quot;
comma
id|jiffies
comma
id|saa7146_read
c_func
(paren
id|av7110-&gt;dev
comma
id|PSR
)paren
comma
id|saa7146_read
c_func
(paren
id|av7110-&gt;dev
comma
id|SSR
)paren
)paren
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|av7110-&gt;debilock
)paren
suffix:semicolon
id|ARM_ClearIrq
c_func
(paren
id|av7110
)paren
suffix:semicolon
id|saa7146_write
c_func
(paren
id|av7110-&gt;dev
comma
id|IER
comma
id|saa7146_read
c_func
(paren
id|av7110-&gt;dev
comma
id|IER
)paren
op_amp
op_complement
id|MASK_19
)paren
suffix:semicolon
id|saa7146_write
c_func
(paren
id|av7110-&gt;dev
comma
id|ISR
comma
id|MASK_19
)paren
suffix:semicolon
id|av7110-&gt;debitype
op_assign
id|irdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|IRQ_STATE
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
id|av7110-&gt;debilen
op_assign
id|irdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|IRQ_STATE_EXT
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
id|av7110-&gt;debibuf
op_assign
l_int|0
suffix:semicolon
id|rxbuf
op_assign
id|irdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|RX_BUFF
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
id|txbuf
op_assign
id|irdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|TX_BUFF
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
id|len
op_assign
(paren
id|av7110-&gt;debilen
op_plus
l_int|3
)paren
op_amp
(paren
op_complement
l_int|3
)paren
suffix:semicolon
id|DEB_D
c_func
(paren
(paren
l_string|&quot;GPIO0 irq %d %d&bslash;n&quot;
comma
id|av7110-&gt;debitype
comma
id|av7110-&gt;debilen
)paren
)paren
suffix:semicolon
id|print_time
c_func
(paren
l_string|&quot;gpio&quot;
)paren
suffix:semicolon
id|DEB_D
c_func
(paren
(paren
l_string|&quot;GPIO0 irq %02x&bslash;n&quot;
comma
id|av7110-&gt;debitype
op_amp
l_int|0xff
)paren
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|av7110-&gt;debitype
op_amp
l_int|0xff
)paren
(brace
r_case
id|DATA_TS_PLAY
suffix:colon
r_case
id|DATA_PES_PLAY
suffix:colon
r_break
suffix:semicolon
r_case
id|DATA_MPEG_VIDEO_EVENT
suffix:colon
(brace
id|u32
id|h_ar
suffix:semicolon
r_struct
id|video_event
id|event
suffix:semicolon
id|av7110-&gt;video_size.w
op_assign
id|irdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|STATUS_MPEG_WIDTH
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
id|h_ar
op_assign
id|irdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|STATUS_MPEG_HEIGHT_AR
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|IRQ_STATE_EXT
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|RX_BUFF
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
id|av7110-&gt;video_size.h
op_assign
id|h_ar
op_amp
l_int|0xfff
suffix:semicolon
id|DEB_D
c_func
(paren
(paren
l_string|&quot;GPIO0 irq: DATA_MPEG_VIDEO_EVENT: w/h/ar = %u/%u/%u&bslash;n&quot;
comma
id|av7110-&gt;video_size.w
comma
id|av7110-&gt;video_size.h
comma
id|av7110-&gt;video_size.aspect_ratio
)paren
)paren
suffix:semicolon
id|event.type
op_assign
id|VIDEO_EVENT_SIZE_CHANGED
suffix:semicolon
id|event.u.size.w
op_assign
id|av7110-&gt;video_size.w
suffix:semicolon
id|event.u.size.h
op_assign
id|av7110-&gt;video_size.h
suffix:semicolon
r_switch
c_cond
(paren
(paren
id|h_ar
op_rshift
l_int|12
)paren
op_amp
l_int|0xf
)paren
(brace
r_case
l_int|3
suffix:colon
id|av7110-&gt;video_size.aspect_ratio
op_assign
id|VIDEO_FORMAT_16_9
suffix:semicolon
id|event.u.size.aspect_ratio
op_assign
id|VIDEO_FORMAT_16_9
suffix:semicolon
id|av7110-&gt;videostate.video_format
op_assign
id|VIDEO_FORMAT_16_9
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|4
suffix:colon
id|av7110-&gt;video_size.aspect_ratio
op_assign
id|VIDEO_FORMAT_221_1
suffix:semicolon
id|event.u.size.aspect_ratio
op_assign
id|VIDEO_FORMAT_221_1
suffix:semicolon
id|av7110-&gt;videostate.video_format
op_assign
id|VIDEO_FORMAT_221_1
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|av7110-&gt;video_size.aspect_ratio
op_assign
id|VIDEO_FORMAT_4_3
suffix:semicolon
id|event.u.size.aspect_ratio
op_assign
id|VIDEO_FORMAT_4_3
suffix:semicolon
id|av7110-&gt;videostate.video_format
op_assign
id|VIDEO_FORMAT_4_3
suffix:semicolon
)brace
id|dvb_video_add_event
c_func
(paren
id|av7110
comma
op_amp
id|event
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|DATA_CI_PUT
suffix:colon
(brace
r_int
id|avail
suffix:semicolon
r_struct
id|dvb_ringbuffer
op_star
id|cibuf
op_assign
op_amp
id|av7110-&gt;ci_wbuffer
suffix:semicolon
id|avail
op_assign
id|dvb_ringbuffer_avail
c_func
(paren
id|cibuf
)paren
suffix:semicolon
r_if
c_cond
(paren
id|avail
op_le
l_int|2
)paren
(brace
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|IRQ_STATE_EXT
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|TX_LEN
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|TX_BUFF
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|len
op_assign
id|DVB_RINGBUFFER_PEEK
c_func
(paren
id|cibuf
comma
l_int|0
)paren
op_lshift
l_int|8
suffix:semicolon
id|len
op_or_assign
id|DVB_RINGBUFFER_PEEK
c_func
(paren
id|cibuf
comma
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|avail
OL
id|len
op_plus
l_int|2
)paren
(brace
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|IRQ_STATE_EXT
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|TX_LEN
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|TX_BUFF
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|DVB_RINGBUFFER_SKIP
c_func
(paren
id|cibuf
comma
l_int|2
)paren
suffix:semicolon
id|dvb_ringbuffer_read
c_func
(paren
id|cibuf
comma
id|av7110-&gt;debi_virt
comma
id|len
comma
l_int|0
)paren
suffix:semicolon
id|wake_up
c_func
(paren
op_amp
id|cibuf-&gt;queue
)paren
suffix:semicolon
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|TX_LEN
comma
id|len
comma
l_int|2
)paren
suffix:semicolon
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|IRQ_STATE_EXT
comma
id|len
comma
l_int|2
)paren
suffix:semicolon
id|wait_for_debi_done
c_func
(paren
id|av7110
)paren
suffix:semicolon
id|saa7146_write
c_func
(paren
id|av7110-&gt;dev
comma
id|IER
comma
id|saa7146_read
c_func
(paren
id|av7110-&gt;dev
comma
id|IER
)paren
op_or
id|MASK_19
)paren
suffix:semicolon
r_if
c_cond
(paren
id|len
OL
l_int|5
)paren
id|len
op_assign
l_int|5
suffix:semicolon
multiline_comment|/* we want a real DEBI DMA */
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBISWAB
comma
id|DPRAM_BASE
op_plus
id|txbuf
comma
l_int|0
comma
(paren
id|len
op_plus
l_int|3
)paren
op_amp
op_complement
l_int|3
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|av7110-&gt;debilock
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_case
id|DATA_MPEG_PLAY
suffix:colon
r_if
c_cond
(paren
op_logical_neg
id|av7110-&gt;playing
)paren
(brace
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|IRQ_STATE_EXT
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|TX_LEN
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|TX_BUFF
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|len
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|av7110-&gt;debitype
op_amp
l_int|0x100
)paren
(brace
id|spin_lock
c_func
(paren
op_amp
id|av7110-&gt;aout.lock
)paren
suffix:semicolon
id|len
op_assign
id|pes_play
c_func
(paren
id|av7110-&gt;debi_virt
comma
op_amp
id|av7110-&gt;aout
comma
l_int|2048
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|av7110-&gt;aout.lock
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|len
op_le
l_int|0
op_logical_and
(paren
id|av7110-&gt;debitype
op_amp
l_int|0x200
)paren
op_logical_and
id|av7110-&gt;videostate.play_state
op_ne
id|VIDEO_FREEZED
)paren
(brace
id|spin_lock
c_func
(paren
op_amp
id|av7110-&gt;avout.lock
)paren
suffix:semicolon
id|len
op_assign
id|pes_play
c_func
(paren
id|av7110-&gt;debi_virt
comma
op_amp
id|av7110-&gt;avout
comma
l_int|2048
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|av7110-&gt;avout.lock
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|len
op_le
l_int|0
)paren
(brace
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|IRQ_STATE_EXT
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|TX_LEN
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|TX_BUFF
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|DEB_D
c_func
(paren
(paren
l_string|&quot;GPIO0 PES_PLAY len=%04x&bslash;n&quot;
comma
id|len
)paren
)paren
suffix:semicolon
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|TX_LEN
comma
id|len
comma
l_int|2
)paren
suffix:semicolon
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|IRQ_STATE_EXT
comma
id|len
comma
l_int|2
)paren
suffix:semicolon
id|wait_for_debi_done
c_func
(paren
id|av7110
)paren
suffix:semicolon
id|saa7146_write
c_func
(paren
id|av7110-&gt;dev
comma
id|IER
comma
id|saa7146_read
c_func
(paren
id|av7110-&gt;dev
comma
id|IER
)paren
op_or
id|MASK_19
)paren
suffix:semicolon
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBISWAB
comma
id|DPRAM_BASE
op_plus
id|txbuf
comma
l_int|0
comma
(paren
id|len
op_plus
l_int|3
)paren
op_amp
op_complement
l_int|3
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|av7110-&gt;debilock
)paren
suffix:semicolon
r_return
suffix:semicolon
r_case
id|DATA_BMP_LOAD
suffix:colon
id|len
op_assign
id|av7110-&gt;debilen
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|len
)paren
(brace
id|av7110-&gt;bmp_state
op_assign
id|BMP_LOADED
suffix:semicolon
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|IRQ_STATE_EXT
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|TX_LEN
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|TX_BUFF
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
id|wake_up
c_func
(paren
op_amp
id|av7110-&gt;bmpq
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|len
OG
id|av7110-&gt;bmplen
)paren
id|len
op_assign
id|av7110-&gt;bmplen
suffix:semicolon
r_if
c_cond
(paren
id|len
OG
l_int|2
op_star
l_int|1024
)paren
id|len
op_assign
l_int|2
op_star
l_int|1024
suffix:semicolon
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|TX_LEN
comma
id|len
comma
l_int|2
)paren
suffix:semicolon
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|IRQ_STATE_EXT
comma
id|len
comma
l_int|2
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|av7110-&gt;debi_virt
comma
id|av7110-&gt;bmpbuf
op_plus
id|av7110-&gt;bmpp
comma
id|len
)paren
suffix:semicolon
id|av7110-&gt;bmpp
op_add_assign
id|len
suffix:semicolon
id|av7110-&gt;bmplen
op_sub_assign
id|len
suffix:semicolon
id|wait_for_debi_done
c_func
(paren
id|av7110
)paren
suffix:semicolon
id|saa7146_write
c_func
(paren
id|av7110-&gt;dev
comma
id|IER
comma
id|saa7146_read
c_func
(paren
id|av7110-&gt;dev
comma
id|IER
)paren
op_or
id|MASK_19
)paren
suffix:semicolon
r_if
c_cond
(paren
id|len
OL
l_int|5
)paren
id|len
op_assign
l_int|5
suffix:semicolon
multiline_comment|/* we want a real DEBI DMA */
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBISWAB
comma
id|DPRAM_BASE
op_plus
id|txbuf
comma
l_int|0
comma
(paren
id|len
op_plus
l_int|3
)paren
op_amp
op_complement
l_int|3
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|av7110-&gt;debilock
)paren
suffix:semicolon
r_return
suffix:semicolon
r_case
id|DATA_CI_GET
suffix:colon
r_case
id|DATA_COMMON_INTERFACE
suffix:colon
r_case
id|DATA_FSECTION
suffix:colon
r_case
id|DATA_IPMPE
suffix:colon
r_case
id|DATA_PIPING
suffix:colon
r_if
c_cond
(paren
op_logical_neg
id|len
op_logical_or
id|len
OG
l_int|4
op_star
l_int|1024
)paren
(brace
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|RX_BUFF
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
multiline_comment|/* yes, fall through */
r_case
id|DATA_TS_RECORD
suffix:colon
r_case
id|DATA_PES_RECORD
suffix:colon
id|wait_for_debi_done
c_func
(paren
id|av7110
)paren
suffix:semicolon
id|saa7146_write
c_func
(paren
id|av7110-&gt;dev
comma
id|IER
comma
id|saa7146_read
c_func
(paren
id|av7110-&gt;dev
comma
id|IER
)paren
op_or
id|MASK_19
)paren
suffix:semicolon
id|irdebi
c_func
(paren
id|av7110
comma
id|DEBISWAB
comma
id|DPRAM_BASE
op_plus
id|rxbuf
comma
l_int|0
comma
id|len
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|av7110-&gt;debilock
)paren
suffix:semicolon
r_return
suffix:semicolon
r_case
id|DATA_DEBUG_MESSAGE
suffix:colon
id|wait_for_debi_done
c_func
(paren
id|av7110
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|len
op_logical_or
id|len
OG
l_int|0xff
)paren
(brace
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|RX_BUFF
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|saa7146_write
c_func
(paren
id|av7110-&gt;dev
comma
id|IER
comma
id|saa7146_read
c_func
(paren
id|av7110-&gt;dev
comma
id|IER
)paren
op_or
id|MASK_19
)paren
suffix:semicolon
id|irdebi
c_func
(paren
id|av7110
comma
id|DEBISWAB
comma
id|Reserved
comma
l_int|0
comma
id|len
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|av7110-&gt;debilock
)paren
suffix:semicolon
r_return
suffix:semicolon
r_case
id|DATA_IRCOMMAND
suffix:colon
id|IR_handle
c_func
(paren
id|av7110
comma
id|swahw32
c_func
(paren
id|irdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|Reserved
comma
l_int|0
comma
l_int|4
)paren
)paren
)paren
suffix:semicolon
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|RX_BUFF
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|printk
c_func
(paren
l_string|&quot;gpioirq unknown type=%d len=%d&bslash;n&quot;
comma
id|av7110-&gt;debitype
comma
id|av7110-&gt;debilen
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|ARM_ClearMailBox
c_func
(paren
id|av7110
)paren
suffix:semicolon
id|av7110-&gt;debitype
op_assign
op_minus
l_int|1
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|av7110-&gt;debilock
)paren
suffix:semicolon
)brace
multiline_comment|/****************************************************************************&n; * DEBI command polling &n; ****************************************************************************/
DECL|function|OutCommand
r_static
r_int
id|OutCommand
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u16
op_star
id|buf
comma
r_int
id|length
)paren
(brace
r_int
id|i
suffix:semicolon
id|u32
id|start
suffix:semicolon
macro_line|#ifdef COM_DEBUG
id|u32
id|stat
suffix:semicolon
macro_line|#endif
singleline_comment|//&t;DEB_EE((&quot;av7110: %p&bslash;n&quot;,av7110));
r_if
c_cond
(paren
op_logical_neg
id|av7110-&gt;arm_ready
)paren
(brace
id|DEB_D
c_func
(paren
(paren
l_string|&quot;arm not ready.&bslash;n&quot;
)paren
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
id|start
op_assign
id|jiffies
suffix:semicolon
r_while
c_loop
(paren
id|rdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|COMMAND
comma
l_int|0
comma
l_int|2
)paren
)paren
(brace
id|dvb_delay
c_func
(paren
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|jiffies
op_minus
id|start
)paren
OG
id|ARM_WAIT_FREE
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;%s: timeout waiting for COMMAND idle&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
)brace
macro_line|#ifndef _NOHANDSHAKE
id|start
op_assign
id|jiffies
suffix:semicolon
r_while
c_loop
(paren
id|rdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|HANDSHAKE_REG
comma
l_int|0
comma
l_int|2
)paren
)paren
(brace
id|dvb_delay
c_func
(paren
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|jiffies
op_minus
id|start
)paren
OG
id|ARM_WAIT_SHAKE
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;%s: timeout waiting for HANDSHAKE_REG&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
)brace
macro_line|#endif
id|start
op_assign
id|jiffies
suffix:semicolon
r_while
c_loop
(paren
id|rdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|MSGSTATE
comma
l_int|0
comma
l_int|2
)paren
op_amp
id|OSDQFull
)paren
(brace
id|dvb_delay
c_func
(paren
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|jiffies
op_minus
id|start
)paren
OG
id|ARM_WAIT_OSD
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;%s: timeout waiting for !OSDQFull&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|2
suffix:semicolon
id|i
OL
id|length
suffix:semicolon
id|i
op_increment
)paren
id|wdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|COMMAND
op_plus
l_int|2
op_star
id|i
comma
(paren
id|u32
)paren
id|buf
(braket
id|i
)braket
comma
l_int|2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|length
)paren
id|wdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|COMMAND
op_plus
l_int|2
comma
(paren
id|u32
)paren
id|buf
(braket
l_int|1
)braket
comma
l_int|2
)paren
suffix:semicolon
r_else
id|wdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|COMMAND
op_plus
l_int|2
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
id|wdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|COMMAND
comma
(paren
id|u32
)paren
id|buf
(braket
l_int|0
)braket
comma
l_int|2
)paren
suffix:semicolon
macro_line|#ifdef COM_DEBUG
id|start
op_assign
id|jiffies
suffix:semicolon
r_while
c_loop
(paren
id|rdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|COMMAND
comma
l_int|0
comma
l_int|2
)paren
)paren
(brace
id|dvb_delay
c_func
(paren
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|jiffies
op_minus
id|start
)paren
OG
id|ARM_WAIT_FREE
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;%s: timeout waiting for COMMAND to complete&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
)brace
id|stat
op_assign
id|rdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|MSGSTATE
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|stat
op_amp
id|GPMQOver
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;%s: GPMQOver&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|stat
op_amp
id|OSDQOver
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;%s: OSDQOver&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
macro_line|#endif
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|SOutCommand
r_static
r_inline
r_int
id|SOutCommand
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u16
op_star
id|buf
comma
r_int
id|length
)paren
(brace
r_int
id|ret
suffix:semicolon
singleline_comment|// &t;DEB_EE((&quot;av7110: %p&bslash;n&quot;,av7110));
r_if
c_cond
(paren
op_logical_neg
id|av7110-&gt;arm_ready
)paren
(brace
id|DEB_D
c_func
(paren
(paren
l_string|&quot;arm not ready.&bslash;n&quot;
)paren
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|down_interruptible
c_func
(paren
op_amp
id|av7110-&gt;dcomlock
)paren
)paren
r_return
op_minus
id|ERESTARTSYS
suffix:semicolon
id|ret
op_assign
id|OutCommand
c_func
(paren
id|av7110
comma
id|buf
comma
id|length
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|av7110-&gt;dcomlock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
id|printk
c_func
(paren
l_string|&quot;SOutCommand error&bslash;n&quot;
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
DECL|function|outcom
r_static
r_int
id|outcom
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
r_int
id|type
comma
r_int
id|com
comma
r_int
id|num
comma
dot
dot
dot
)paren
(brace
id|va_list
id|args
suffix:semicolon
id|u16
id|buf
(braket
id|num
op_plus
l_int|2
)braket
suffix:semicolon
r_int
id|i
comma
id|ret
suffix:semicolon
singleline_comment|// &t;DEB_EE((&quot;av7110: %p&bslash;n&quot;,av7110));
id|buf
(braket
l_int|0
)braket
op_assign
(paren
(paren
id|type
op_lshift
l_int|8
)paren
op_or
id|com
)paren
suffix:semicolon
id|buf
(braket
l_int|1
)braket
op_assign
id|num
suffix:semicolon
r_if
c_cond
(paren
id|num
)paren
(brace
id|va_start
c_func
(paren
id|args
comma
id|num
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|num
suffix:semicolon
id|i
op_increment
)paren
id|buf
(braket
id|i
op_plus
l_int|2
)braket
op_assign
id|va_arg
c_func
(paren
id|args
comma
id|u32
)paren
suffix:semicolon
id|va_end
c_func
(paren
id|args
)paren
suffix:semicolon
)brace
id|ret
op_assign
id|SOutCommand
c_func
(paren
id|av7110
comma
id|buf
comma
id|num
op_plus
l_int|2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
id|printk
c_func
(paren
l_string|&quot;outcom error&bslash;n&quot;
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
DECL|function|SendCICommand
r_int
id|SendCICommand
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u8
id|subcom
comma
id|u8
op_star
id|Params
comma
id|u8
id|ParamLen
)paren
(brace
r_int
id|i
comma
id|ret
suffix:semicolon
id|u16
id|CommandBuffer
(braket
l_int|18
)braket
op_assign
(brace
(paren
(paren
id|COMTYPE_COMMON_IF
op_lshift
l_int|8
)paren
op_plus
id|subcom
)paren
comma
l_int|16
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
(paren
id|i
OL
id|ParamLen
)paren
op_logical_and
(paren
id|i
OL
l_int|32
)paren
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|i
op_mod
l_int|2
op_eq
l_int|0
)paren
(brace
id|CommandBuffer
(braket
(paren
id|i
op_div
l_int|2
)paren
op_plus
l_int|2
)braket
op_assign
(paren
id|u16
)paren
(paren
id|Params
(braket
id|i
)braket
)paren
op_lshift
l_int|8
suffix:semicolon
)brace
r_else
id|CommandBuffer
(braket
(paren
id|i
op_div
l_int|2
)paren
op_plus
l_int|2
)braket
op_or_assign
id|Params
(braket
id|i
)braket
suffix:semicolon
)brace
id|ret
op_assign
id|SOutCommand
c_func
(paren
id|av7110
comma
id|CommandBuffer
comma
l_int|18
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
id|printk
c_func
(paren
l_string|&quot;SendCICommand error&bslash;n&quot;
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
DECL|function|CommandRequest
r_static
r_int
id|CommandRequest
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u16
op_star
id|Buff
comma
r_int
id|length
comma
id|u16
op_star
id|buf
comma
r_int
id|n
)paren
(brace
r_int
id|err
suffix:semicolon
id|s16
id|i
suffix:semicolon
id|u32
id|start
suffix:semicolon
macro_line|#ifdef COM_DEBUG
id|u32
id|stat
suffix:semicolon
macro_line|#endif
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|av7110-&gt;arm_ready
)paren
(brace
id|DEB_D
c_func
(paren
(paren
l_string|&quot;arm not ready.&bslash;n&quot;
)paren
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|down_interruptible
c_func
(paren
op_amp
id|av7110-&gt;dcomlock
)paren
)paren
r_return
op_minus
id|ERESTARTSYS
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|OutCommand
c_func
(paren
id|av7110
comma
id|Buff
comma
id|length
)paren
)paren
OL
l_int|0
)paren
(brace
id|up
c_func
(paren
op_amp
id|av7110-&gt;dcomlock
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;CommandRequest error&bslash;n&quot;
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
id|start
op_assign
id|jiffies
suffix:semicolon
r_while
c_loop
(paren
id|rdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|COMMAND
comma
l_int|0
comma
l_int|2
)paren
)paren
(brace
macro_line|#ifdef _NOHANDSHAKE
id|dvb_delay
c_func
(paren
l_int|1
)paren
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
(paren
id|jiffies
op_minus
id|start
)paren
OG
id|ARM_WAIT_FREE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: timeout waiting for COMMAND to complete&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|av7110-&gt;dcomlock
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
)brace
macro_line|#ifndef _NOHANDSHAKE
id|start
op_assign
id|jiffies
suffix:semicolon
r_while
c_loop
(paren
id|rdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|HANDSHAKE_REG
comma
l_int|0
comma
l_int|2
)paren
)paren
(brace
id|dvb_delay
c_func
(paren
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|jiffies
op_minus
id|start
)paren
OG
id|ARM_WAIT_SHAKE
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;%s: timeout waiting for HANDSHAKE_REG&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|av7110-&gt;dcomlock
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
)brace
macro_line|#endif
macro_line|#ifdef COM_DEBUG
id|stat
op_assign
id|rdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|MSGSTATE
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|stat
op_amp
id|GPMQOver
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;%s: GPMQOver&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|av7110-&gt;dcomlock
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|stat
op_amp
id|OSDQOver
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;%s: OSDQOver&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|av7110-&gt;dcomlock
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
macro_line|#endif
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|n
suffix:semicolon
id|i
op_increment
)paren
id|buf
(braket
id|i
)braket
op_assign
id|rdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|COM_BUFF
op_plus
l_int|2
op_star
id|i
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|av7110-&gt;dcomlock
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|RequestParameter
r_static
r_inline
r_int
id|RequestParameter
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u16
id|tag
comma
id|u16
op_star
id|Buff
comma
id|s16
id|length
)paren
(brace
r_int
id|ret
suffix:semicolon
id|ret
op_assign
id|CommandRequest
c_func
(paren
id|av7110
comma
op_amp
id|tag
comma
l_int|0
comma
id|Buff
comma
id|length
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
id|printk
c_func
(paren
l_string|&quot;RequestParameter error&bslash;n&quot;
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
multiline_comment|/****************************************************************************&n; * Firmware commands &n; ****************************************************************************/
multiline_comment|/* msp3400 i2c subaddresses */
DECL|macro|MSP_WR_DEM
mdefine_line|#define MSP_WR_DEM 0x10
DECL|macro|MSP_RD_DEM
mdefine_line|#define MSP_RD_DEM 0x11
DECL|macro|MSP_WR_DSP
mdefine_line|#define MSP_WR_DSP 0x12
DECL|macro|MSP_RD_DSP
mdefine_line|#define MSP_RD_DSP 0x13
DECL|function|msp_writereg
r_static
r_inline
r_int
id|msp_writereg
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u8
id|dev
comma
id|u16
id|reg
comma
id|u16
id|val
)paren
(brace
id|u8
id|msg
(braket
l_int|5
)braket
op_assign
initialization_block
suffix:semicolon
r_struct
id|dvb_i2c_bus
op_star
id|i2c
op_assign
id|av7110-&gt;i2c_bus
suffix:semicolon
r_struct
id|i2c_msg
id|msgs
op_assign
(brace
dot
id|flags
op_assign
l_int|0
comma
dot
id|addr
op_assign
l_int|0x40
comma
dot
id|len
op_assign
l_int|5
comma
dot
id|buf
op_assign
id|msg
)brace
suffix:semicolon
r_if
c_cond
(paren
id|i2c
op_member_access_from_pointer
id|xfer
c_func
(paren
id|i2c
comma
op_amp
id|msgs
comma
l_int|1
)paren
op_ne
l_int|1
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;av7110(%d): %s(%u = %u) failed&bslash;n&quot;
comma
id|av7110-&gt;dvb_adapter-&gt;num
comma
id|__FUNCTION__
comma
id|reg
comma
id|val
)paren
suffix:semicolon
r_return
op_minus
id|EIO
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|msp_readreg
r_static
r_inline
r_int
id|msp_readreg
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u8
id|dev
comma
id|u16
id|reg
comma
id|u16
op_star
id|val
)paren
(brace
id|u8
id|msg1
(braket
l_int|3
)braket
op_assign
initialization_block
suffix:semicolon
id|u8
id|msg2
(braket
l_int|2
)braket
suffix:semicolon
r_struct
id|dvb_i2c_bus
op_star
id|i2c
op_assign
id|av7110-&gt;i2c_bus
suffix:semicolon
r_struct
id|i2c_msg
id|msgs
(braket
l_int|2
)braket
op_assign
(brace
(brace
dot
id|flags
op_assign
l_int|0
comma
dot
id|addr
op_assign
l_int|0x40
comma
dot
id|len
op_assign
l_int|3
comma
dot
id|buf
op_assign
id|msg1
)brace
comma
(brace
dot
id|flags
op_assign
id|I2C_M_RD
comma
dot
id|addr
op_assign
l_int|0x40
comma
dot
id|len
op_assign
l_int|2
comma
dot
id|buf
op_assign
id|msg2
)brace
)brace
suffix:semicolon
r_if
c_cond
(paren
id|i2c
op_member_access_from_pointer
id|xfer
c_func
(paren
id|i2c
comma
id|msgs
comma
l_int|2
)paren
op_ne
l_int|2
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;av7110(%d): %s(%u) failed&bslash;n&quot;
comma
id|av7110-&gt;dvb_adapter-&gt;num
comma
id|__FUNCTION__
comma
id|reg
)paren
suffix:semicolon
r_return
op_minus
id|EIO
suffix:semicolon
)brace
op_star
id|val
op_assign
(paren
id|msg2
(braket
l_int|0
)braket
op_lshift
l_int|8
)paren
op_or
id|msg2
(braket
l_int|1
)braket
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|SendDAC
r_static
r_inline
r_int
id|SendDAC
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u8
id|addr
comma
id|u8
id|data
)paren
(brace
singleline_comment|// &t;DEB_EE((&quot;av7110: %p&bslash;n&quot;,av7110));
r_return
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_AUDIODAC
comma
id|AudioDAC
comma
l_int|2
comma
id|addr
comma
id|data
)paren
suffix:semicolon
)brace
DECL|function|SetVolume
r_static
r_int
id|SetVolume
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
r_int
id|volleft
comma
r_int
id|volright
)paren
(brace
r_int
id|err
comma
id|vol
comma
id|val
comma
id|balance
op_assign
l_int|0
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|av7110-&gt;adac_type
)paren
(brace
r_case
id|DVB_ADAC_TI
suffix:colon
id|volleft
op_assign
(paren
id|volleft
op_star
l_int|256
)paren
op_div
l_int|1036
suffix:semicolon
id|volright
op_assign
(paren
id|volright
op_star
l_int|256
)paren
op_div
l_int|1036
suffix:semicolon
r_if
c_cond
(paren
id|volleft
OG
l_int|0x3f
)paren
id|volleft
op_assign
l_int|0x3f
suffix:semicolon
r_if
c_cond
(paren
id|volright
OG
l_int|0x3f
)paren
id|volright
op_assign
l_int|0x3f
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|SendDAC
c_func
(paren
id|av7110
comma
l_int|3
comma
l_int|0x80
op_plus
id|volleft
)paren
)paren
)paren
r_return
id|err
suffix:semicolon
r_return
id|SendDAC
c_func
(paren
id|av7110
comma
l_int|4
comma
id|volright
)paren
suffix:semicolon
r_case
id|DVB_ADAC_CRYSTAL
suffix:colon
id|volleft
op_assign
l_int|127
op_minus
id|volleft
op_div
l_int|2
suffix:semicolon
id|volright
op_assign
l_int|127
op_minus
id|volright
op_div
l_int|2
suffix:semicolon
id|i2c_writereg
c_func
(paren
id|av7110
comma
l_int|0x20
comma
l_int|0x03
comma
id|volleft
)paren
suffix:semicolon
id|i2c_writereg
c_func
(paren
id|av7110
comma
l_int|0x20
comma
l_int|0x04
comma
id|volright
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_case
id|DVB_ADAC_MSP
suffix:colon
id|vol
op_assign
(paren
id|volleft
OG
id|volright
)paren
ques
c_cond
id|volleft
suffix:colon
id|volright
suffix:semicolon
id|val
op_assign
(paren
id|vol
op_star
l_int|0x73
op_div
l_int|255
)paren
op_lshift
l_int|8
suffix:semicolon
r_if
c_cond
(paren
id|vol
OG
l_int|0
)paren
(brace
id|balance
op_assign
(paren
(paren
id|volright
op_minus
id|volleft
)paren
op_star
l_int|127
)paren
op_div
id|vol
suffix:semicolon
)brace
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DSP
comma
l_int|0x0001
comma
id|balance
op_lshift
l_int|8
)paren
suffix:semicolon
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DSP
comma
l_int|0x0000
comma
id|val
)paren
suffix:semicolon
multiline_comment|/* loudspeaker */
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DSP
comma
l_int|0x0006
comma
id|val
)paren
suffix:semicolon
multiline_comment|/* headphonesr */
r_return
l_int|0
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_DVB_AV7110_OSD
DECL|function|ResetBlend
r_static
r_inline
r_int
id|ResetBlend
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u8
id|windownr
)paren
(brace
r_return
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_OSD
comma
id|SetNonBlend
comma
l_int|1
comma
id|windownr
)paren
suffix:semicolon
)brace
DECL|function|SetColorBlend
r_static
r_inline
r_int
id|SetColorBlend
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u8
id|windownr
)paren
(brace
r_return
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_OSD
comma
id|SetCBlend
comma
l_int|1
comma
id|windownr
)paren
suffix:semicolon
)brace
DECL|function|SetWindowBlend
r_static
r_inline
r_int
id|SetWindowBlend
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u8
id|windownr
comma
id|u8
id|blending
)paren
(brace
r_return
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_OSD
comma
id|SetWBlend
comma
l_int|2
comma
id|windownr
comma
id|blending
)paren
suffix:semicolon
)brace
DECL|function|SetBlend_
r_static
r_inline
r_int
id|SetBlend_
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u8
id|windownr
comma
r_enum
id|av7110_osd_palette_type
id|colordepth
comma
id|u16
id|index
comma
id|u8
id|blending
)paren
(brace
r_return
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_OSD
comma
id|SetBlend
comma
l_int|4
comma
id|windownr
comma
id|colordepth
comma
id|index
comma
id|blending
)paren
suffix:semicolon
)brace
DECL|function|SetColor_
r_static
r_inline
r_int
id|SetColor_
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u8
id|windownr
comma
r_enum
id|av7110_osd_palette_type
id|colordepth
comma
id|u16
id|index
comma
id|u16
id|colorhi
comma
id|u16
id|colorlo
)paren
(brace
r_return
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_OSD
comma
id|SetColor
comma
l_int|5
comma
id|windownr
comma
id|colordepth
comma
id|index
comma
id|colorhi
comma
id|colorlo
)paren
suffix:semicolon
)brace
DECL|function|BringToTop
r_static
r_inline
r_int
id|BringToTop
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u8
id|windownr
)paren
(brace
r_return
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_OSD
comma
id|WTop
comma
l_int|1
comma
id|windownr
)paren
suffix:semicolon
)brace
DECL|function|SetFont
r_static
r_inline
r_int
id|SetFont
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u8
id|windownr
comma
id|u8
id|fontsize
comma
id|u16
id|colorfg
comma
id|u16
id|colorbg
)paren
(brace
r_return
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_OSD
comma
id|Set_Font
comma
l_int|4
comma
id|windownr
comma
id|fontsize
comma
id|colorfg
comma
id|colorbg
)paren
suffix:semicolon
)brace
DECL|function|FlushText
r_static
r_int
id|FlushText
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
)paren
(brace
id|u32
id|start
suffix:semicolon
r_if
c_cond
(paren
id|down_interruptible
c_func
(paren
op_amp
id|av7110-&gt;dcomlock
)paren
)paren
r_return
op_minus
id|ERESTARTSYS
suffix:semicolon
id|start
op_assign
id|jiffies
suffix:semicolon
r_while
c_loop
(paren
id|rdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|BUFF1_BASE
comma
l_int|0
comma
l_int|2
)paren
)paren
(brace
id|dvb_delay
c_func
(paren
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|jiffies
op_minus
id|start
)paren
OG
id|ARM_WAIT_OSD
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;%s: timeout waiting for BUFF1_BASE == 0&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|av7110-&gt;dcomlock
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
)brace
id|up
c_func
(paren
op_amp
id|av7110-&gt;dcomlock
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|WriteText
r_static
r_int
id|WriteText
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u8
id|win
comma
id|u16
id|x
comma
id|u16
id|y
comma
id|u8
op_star
id|buf
)paren
(brace
r_int
id|i
comma
id|ret
suffix:semicolon
id|u32
id|start
suffix:semicolon
r_int
id|length
op_assign
id|strlen
c_func
(paren
id|buf
)paren
op_plus
l_int|1
suffix:semicolon
id|u16
id|cbuf
(braket
l_int|5
)braket
op_assign
(brace
(paren
id|COMTYPE_OSD
op_lshift
l_int|8
)paren
op_plus
id|DText
comma
l_int|3
comma
id|win
comma
id|x
comma
id|y
)brace
suffix:semicolon
r_if
c_cond
(paren
id|down_interruptible
c_func
(paren
op_amp
id|av7110-&gt;dcomlock
)paren
)paren
r_return
op_minus
id|ERESTARTSYS
suffix:semicolon
id|start
op_assign
id|jiffies
suffix:semicolon
r_while
c_loop
(paren
id|rdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|BUFF1_BASE
comma
l_int|0
comma
l_int|2
)paren
)paren
(brace
id|dvb_delay
c_func
(paren
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|jiffies
op_minus
id|start
)paren
OG
id|ARM_WAIT_OSD
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;%s: timeout waiting for BUFF1_BASE == 0&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|av7110-&gt;dcomlock
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
)brace
macro_line|#ifndef _NOHANDSHAKE
id|start
op_assign
id|jiffies
suffix:semicolon
r_while
c_loop
(paren
id|rdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|HANDSHAKE_REG
comma
l_int|0
comma
l_int|2
)paren
)paren
(brace
id|dvb_delay
c_func
(paren
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|jiffies
op_minus
id|start
)paren
OG
id|ARM_WAIT_SHAKE
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;%s: timeout waiting for HANDSHAKE_REG&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|av7110-&gt;dcomlock
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
)brace
macro_line|#endif
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|length
op_div
l_int|2
suffix:semicolon
id|i
op_increment
)paren
id|wdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|BUFF1_BASE
op_plus
id|i
op_star
l_int|2
comma
id|swab16
c_func
(paren
op_star
(paren
id|u16
op_star
)paren
(paren
id|buf
op_plus
l_int|2
op_star
id|i
)paren
)paren
comma
l_int|2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|length
op_amp
l_int|1
)paren
id|wdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|BUFF1_BASE
op_plus
id|i
op_star
l_int|2
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
id|ret
op_assign
id|OutCommand
c_func
(paren
id|av7110
comma
id|cbuf
comma
l_int|5
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|av7110-&gt;dcomlock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
id|printk
c_func
(paren
l_string|&quot;WriteText error&bslash;n&quot;
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
DECL|function|DrawLine
r_static
r_inline
r_int
id|DrawLine
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u8
id|windownr
comma
id|u16
id|x
comma
id|u16
id|y
comma
id|u16
id|dx
comma
id|u16
id|dy
comma
id|u16
id|color
)paren
(brace
r_return
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_OSD
comma
id|DLine
comma
l_int|6
comma
id|windownr
comma
id|x
comma
id|y
comma
id|dx
comma
id|dy
comma
id|color
)paren
suffix:semicolon
)brace
DECL|function|DrawBlock
r_static
r_inline
r_int
id|DrawBlock
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u8
id|windownr
comma
id|u16
id|x
comma
id|u16
id|y
comma
id|u16
id|dx
comma
id|u16
id|dy
comma
id|u16
id|color
)paren
(brace
r_return
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_OSD
comma
id|DBox
comma
l_int|6
comma
id|windownr
comma
id|x
comma
id|y
comma
id|dx
comma
id|dy
comma
id|color
)paren
suffix:semicolon
)brace
DECL|function|HideWindow
r_static
r_inline
r_int
id|HideWindow
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u8
id|windownr
)paren
(brace
r_return
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_OSD
comma
id|WHide
comma
l_int|1
comma
id|windownr
)paren
suffix:semicolon
)brace
DECL|function|MoveWindowRel
r_static
r_inline
r_int
id|MoveWindowRel
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u8
id|windownr
comma
id|u16
id|x
comma
id|u16
id|y
)paren
(brace
r_return
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_OSD
comma
id|WMoveD
comma
l_int|3
comma
id|windownr
comma
id|x
comma
id|y
)paren
suffix:semicolon
)brace
DECL|function|MoveWindowAbs
r_static
r_inline
r_int
id|MoveWindowAbs
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u8
id|windownr
comma
id|u16
id|x
comma
id|u16
id|y
)paren
(brace
r_return
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_OSD
comma
id|WMoveA
comma
l_int|3
comma
id|windownr
comma
id|x
comma
id|y
)paren
suffix:semicolon
)brace
DECL|function|DestroyOSDWindow
r_static
r_inline
r_int
id|DestroyOSDWindow
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u8
id|windownr
)paren
(brace
r_return
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_OSD
comma
id|WDestroy
comma
l_int|1
comma
id|windownr
)paren
suffix:semicolon
)brace
macro_line|#if 0
r_static
r_void
id|DestroyOSDWindows
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|1
suffix:semicolon
id|i
OL
l_int|7
suffix:semicolon
id|i
op_increment
)paren
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_OSD
comma
id|WDestroy
comma
l_int|1
comma
id|i
)paren
suffix:semicolon
)brace
macro_line|#endif
DECL|function|CreateOSDWindow
r_static
r_inline
r_int
id|CreateOSDWindow
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u8
id|windownr
comma
r_enum
id|av7110_window_display_type
id|disptype
comma
id|u16
id|width
comma
id|u16
id|height
)paren
(brace
r_return
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_OSD
comma
id|WCreate
comma
l_int|4
comma
id|windownr
comma
id|disptype
comma
id|width
comma
id|height
)paren
suffix:semicolon
)brace
DECL|variable|bpp2pal
r_static
r_enum
id|av7110_osd_palette_type
id|bpp2pal
(braket
l_int|8
)braket
op_assign
initialization_block
suffix:semicolon
DECL|variable|bpp2bit
r_static
r_enum
id|av7110_window_display_type
id|bpp2bit
(braket
l_int|8
)braket
op_assign
initialization_block
suffix:semicolon
DECL|function|LoadBitmap
r_static
r_inline
r_int
id|LoadBitmap
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u16
id|format
comma
id|u16
id|dx
comma
id|u16
id|dy
comma
r_int
id|inc
comma
id|u8
op_star
id|data
)paren
(brace
r_int
id|bpp
suffix:semicolon
r_int
id|i
suffix:semicolon
r_int
id|d
comma
id|delta
suffix:semicolon
id|u8
id|c
suffix:semicolon
id|DECLARE_WAITQUEUE
c_func
(paren
id|wait
comma
id|current
)paren
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|av7110-&gt;bmp_state
op_eq
id|BMP_LOADING
)paren
(brace
id|add_wait_queue
c_func
(paren
op_amp
id|av7110-&gt;bmpq
comma
op_amp
id|wait
)paren
suffix:semicolon
r_while
c_loop
(paren
l_int|1
)paren
(brace
id|set_current_state
c_func
(paren
id|TASK_INTERRUPTIBLE
)paren
suffix:semicolon
r_if
c_cond
(paren
id|av7110-&gt;bmp_state
op_ne
id|BMP_LOADING
op_logical_or
id|signal_pending
c_func
(paren
id|current
)paren
)paren
r_break
suffix:semicolon
id|schedule
c_func
(paren
)paren
suffix:semicolon
)brace
id|set_current_state
c_func
(paren
id|TASK_RUNNING
)paren
suffix:semicolon
id|remove_wait_queue
c_func
(paren
op_amp
id|av7110-&gt;bmpq
comma
op_amp
id|wait
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|av7110-&gt;bmp_state
op_eq
id|BMP_LOADING
)paren
r_return
op_minus
l_int|1
suffix:semicolon
id|av7110-&gt;bmp_state
op_assign
id|BMP_LOADING
suffix:semicolon
r_if
c_cond
(paren
id|format
op_eq
id|BITMAP8
)paren
(brace
id|bpp
op_assign
l_int|8
suffix:semicolon
id|delta
op_assign
l_int|1
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|format
op_eq
id|BITMAP4
)paren
(brace
id|bpp
op_assign
l_int|4
suffix:semicolon
id|delta
op_assign
l_int|2
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|format
op_eq
id|BITMAP2
)paren
(brace
id|bpp
op_assign
l_int|2
suffix:semicolon
id|delta
op_assign
l_int|4
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|format
op_eq
id|BITMAP1
)paren
(brace
id|bpp
op_assign
l_int|1
suffix:semicolon
id|delta
op_assign
l_int|8
suffix:semicolon
)brace
r_else
(brace
id|av7110-&gt;bmp_state
op_assign
id|BMP_NONE
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
id|av7110-&gt;bmplen
op_assign
(paren
(paren
id|dx
op_star
id|dy
op_star
id|bpp
op_plus
l_int|7
)paren
op_amp
op_complement
l_int|7
)paren
op_div
l_int|8
suffix:semicolon
id|av7110-&gt;bmpp
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|av7110-&gt;bmplen
OG
l_int|32768
)paren
(brace
id|av7110-&gt;bmp_state
op_assign
id|BMP_NONE
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|dy
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
id|av7110-&gt;bmpbuf
op_plus
l_int|1024
op_plus
id|i
op_star
id|dx
comma
id|data
op_plus
id|i
op_star
id|inc
comma
id|dx
)paren
)paren
(brace
id|av7110-&gt;bmp_state
op_assign
id|BMP_NONE
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|format
op_ne
id|BITMAP8
)paren
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|dx
op_star
id|dy
op_div
id|delta
suffix:semicolon
id|i
op_increment
)paren
(brace
id|c
op_assign
(paren
(paren
id|u8
op_star
)paren
id|av7110-&gt;bmpbuf
)paren
(braket
l_int|1024
op_plus
id|i
op_star
id|delta
op_plus
id|delta
op_minus
l_int|1
)braket
suffix:semicolon
r_for
c_loop
(paren
id|d
op_assign
id|delta
op_minus
l_int|2
suffix:semicolon
id|d
op_ge
l_int|0
suffix:semicolon
id|d
op_decrement
)paren
(brace
id|c
op_or_assign
(paren
(paren
(paren
id|u8
op_star
)paren
id|av7110-&gt;bmpbuf
)paren
(braket
l_int|1024
op_plus
id|i
op_star
id|delta
op_plus
id|d
)braket
op_lshift
(paren
(paren
id|delta
op_minus
id|d
op_minus
l_int|1
)paren
op_star
id|bpp
)paren
)paren
suffix:semicolon
(paren
(paren
id|u8
op_star
)paren
id|av7110-&gt;bmpbuf
)paren
(braket
l_int|1024
op_plus
id|i
)braket
op_assign
id|c
suffix:semicolon
)brace
)brace
)brace
id|av7110-&gt;bmplen
op_add_assign
l_int|1024
suffix:semicolon
r_return
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_OSD
comma
id|LoadBmp
comma
l_int|3
comma
id|format
comma
id|dx
comma
id|dy
)paren
suffix:semicolon
)brace
DECL|function|BlitBitmap
r_static
r_int
id|BlitBitmap
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u16
id|win
comma
id|u16
id|x
comma
id|u16
id|y
comma
id|u16
id|trans
)paren
(brace
id|DECLARE_WAITQUEUE
c_func
(paren
id|wait
comma
id|current
)paren
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|av7110-&gt;bmp_state
op_eq
id|BMP_NONE
)paren
r_return
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|av7110-&gt;bmp_state
op_eq
id|BMP_LOADING
)paren
(brace
id|add_wait_queue
c_func
(paren
op_amp
id|av7110-&gt;bmpq
comma
op_amp
id|wait
)paren
suffix:semicolon
r_while
c_loop
(paren
l_int|1
)paren
(brace
id|set_current_state
c_func
(paren
id|TASK_INTERRUPTIBLE
)paren
suffix:semicolon
r_if
c_cond
(paren
id|av7110-&gt;bmp_state
op_ne
id|BMP_LOADING
op_logical_or
id|signal_pending
c_func
(paren
id|current
)paren
)paren
r_break
suffix:semicolon
id|schedule
c_func
(paren
)paren
suffix:semicolon
)brace
id|set_current_state
c_func
(paren
id|TASK_RUNNING
)paren
suffix:semicolon
id|remove_wait_queue
c_func
(paren
op_amp
id|av7110-&gt;bmpq
comma
op_amp
id|wait
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|av7110-&gt;bmp_state
op_eq
id|BMP_LOADED
)paren
r_return
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_OSD
comma
id|BlitBmp
comma
l_int|4
comma
id|win
comma
id|x
comma
id|y
comma
id|trans
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
DECL|function|ReleaseBitmap
r_static
r_inline
r_int
id|ReleaseBitmap
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
)paren
(brace
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|av7110-&gt;bmp_state
op_ne
id|BMP_LOADED
)paren
r_return
op_minus
l_int|1
suffix:semicolon
id|av7110-&gt;bmp_state
op_assign
id|BMP_NONE
suffix:semicolon
r_return
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_OSD
comma
id|ReleaseBmp
comma
l_int|0
)paren
suffix:semicolon
)brace
DECL|function|RGB2YUV
r_static
id|u32
id|RGB2YUV
c_func
(paren
id|u16
id|R
comma
id|u16
id|G
comma
id|u16
id|B
)paren
(brace
id|u16
id|y
comma
id|u
comma
id|v
suffix:semicolon
id|u16
id|Y
comma
id|Cr
comma
id|Cb
suffix:semicolon
id|y
op_assign
id|R
op_star
l_int|77
op_plus
id|G
op_star
l_int|150
op_plus
id|B
op_star
l_int|29
suffix:semicolon
singleline_comment|// Luma=0.299R+0.587G+0.114B 0..65535
id|u
op_assign
l_int|2048
op_plus
id|B
op_star
l_int|8
op_minus
(paren
id|y
op_rshift
l_int|5
)paren
suffix:semicolon
singleline_comment|// Cr 0..4095
id|v
op_assign
l_int|2048
op_plus
id|R
op_star
l_int|8
op_minus
(paren
id|y
op_rshift
l_int|5
)paren
suffix:semicolon
singleline_comment|// Cb 0..4095
id|Y
op_assign
id|y
op_div
l_int|256
suffix:semicolon
id|Cb
op_assign
id|u
op_div
l_int|16
suffix:semicolon
id|Cr
op_assign
id|v
op_div
l_int|16
suffix:semicolon
r_return
id|Cr
op_or
(paren
id|Cb
op_lshift
l_int|16
)paren
op_or
(paren
id|Y
op_lshift
l_int|8
)paren
suffix:semicolon
)brace
DECL|function|OSDSetColor
r_static
r_void
id|OSDSetColor
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u8
id|color
comma
id|u8
id|r
comma
id|u8
id|g
comma
id|u8
id|b
comma
id|u8
id|blend
)paren
(brace
id|u16
id|ch
comma
id|cl
suffix:semicolon
id|u32
id|yuv
suffix:semicolon
id|yuv
op_assign
id|blend
ques
c_cond
id|RGB2YUV
c_func
(paren
id|r
comma
id|g
comma
id|b
)paren
suffix:colon
l_int|0
suffix:semicolon
id|cl
op_assign
(paren
id|yuv
op_amp
l_int|0xffff
)paren
suffix:semicolon
id|ch
op_assign
(paren
(paren
id|yuv
op_rshift
l_int|16
)paren
op_amp
l_int|0xffff
)paren
suffix:semicolon
id|SetColor_
c_func
(paren
id|av7110
comma
id|av7110-&gt;osdwin
comma
id|bpp2pal
(braket
id|av7110-&gt;osdbpp
(braket
id|av7110-&gt;osdwin
)braket
)braket
comma
id|color
comma
id|ch
comma
id|cl
)paren
suffix:semicolon
id|SetBlend_
c_func
(paren
id|av7110
comma
id|av7110-&gt;osdwin
comma
id|bpp2pal
(braket
id|av7110-&gt;osdbpp
(braket
id|av7110-&gt;osdwin
)braket
)braket
comma
id|color
comma
(paren
(paren
id|blend
op_rshift
l_int|4
)paren
op_amp
l_int|0x0f
)paren
)paren
suffix:semicolon
)brace
DECL|function|OSDSetPalette
r_static
r_int
id|OSDSetPalette
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u32
op_star
id|colors
comma
id|u8
id|first
comma
id|u8
id|last
)paren
(brace
r_int
id|i
suffix:semicolon
r_int
id|length
op_assign
id|last
op_minus
id|first
op_plus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|length
op_star
l_int|4
OG
id|DATA_BUFF3_SIZE
)paren
r_return
op_minus
l_int|1
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|length
suffix:semicolon
id|i
op_increment
)paren
(brace
id|u32
id|blend
op_assign
(paren
id|colors
(braket
id|i
)braket
op_amp
l_int|0xF0000000
)paren
op_rshift
l_int|4
suffix:semicolon
id|u32
id|yuv
op_assign
id|blend
ques
c_cond
id|RGB2YUV
c_func
(paren
id|colors
(braket
id|i
)braket
op_amp
l_int|0xFF
comma
(paren
id|colors
(braket
id|i
)braket
op_rshift
l_int|8
)paren
op_amp
l_int|0xFF
comma
(paren
id|colors
(braket
id|i
)braket
op_rshift
l_int|16
)paren
op_amp
l_int|0xFF
)paren
op_or
id|blend
suffix:colon
l_int|0
suffix:semicolon
id|yuv
op_assign
(paren
(paren
id|yuv
op_amp
l_int|0xFFFF0000
)paren
op_rshift
l_int|16
)paren
op_or
(paren
(paren
id|yuv
op_amp
l_int|0x0000FFFF
)paren
op_lshift
l_int|16
)paren
suffix:semicolon
singleline_comment|// TODO kls2003-06-15: not sure if this is endian-proof
id|wdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|DATA_BUFF3_BASE
op_plus
id|i
op_star
l_int|4
comma
id|yuv
comma
l_int|4
)paren
suffix:semicolon
)brace
r_return
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_OSD
comma
id|Set_Palette
comma
l_int|4
comma
id|av7110-&gt;osdwin
comma
id|bpp2pal
(braket
id|av7110-&gt;osdbpp
(braket
id|av7110-&gt;osdwin
)braket
)braket
comma
id|first
comma
id|last
)paren
suffix:semicolon
)brace
DECL|function|OSDSetBlock
r_static
r_int
id|OSDSetBlock
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
r_int
id|x0
comma
r_int
id|y0
comma
r_int
id|x1
comma
r_int
id|y1
comma
r_int
id|inc
comma
id|u8
op_star
id|data
)paren
(brace
id|uint
id|w
comma
id|h
comma
id|bpp
comma
id|bpl
comma
id|size
comma
id|lpb
comma
id|bnum
comma
id|brest
suffix:semicolon
r_int
id|i
suffix:semicolon
id|w
op_assign
id|x1
op_minus
id|x0
op_plus
l_int|1
suffix:semicolon
id|h
op_assign
id|y1
op_minus
id|y0
op_plus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|inc
op_le
l_int|0
)paren
id|inc
op_assign
id|w
suffix:semicolon
r_if
c_cond
(paren
id|w
op_le
l_int|0
op_logical_or
id|w
OG
l_int|720
op_logical_or
id|h
op_le
l_int|0
op_logical_or
id|h
OG
l_int|576
)paren
r_return
op_minus
l_int|1
suffix:semicolon
id|bpp
op_assign
id|av7110-&gt;osdbpp
(braket
id|av7110-&gt;osdwin
)braket
op_plus
l_int|1
suffix:semicolon
id|bpl
op_assign
(paren
(paren
id|w
op_star
id|bpp
op_plus
l_int|7
)paren
op_amp
op_complement
l_int|7
)paren
op_div
l_int|8
suffix:semicolon
id|size
op_assign
id|h
op_star
id|bpl
suffix:semicolon
id|lpb
op_assign
(paren
l_int|32
op_star
l_int|1024
)paren
op_div
id|bpl
suffix:semicolon
id|bnum
op_assign
id|size
op_div
(paren
id|lpb
op_star
id|bpl
)paren
suffix:semicolon
id|brest
op_assign
id|size
op_minus
id|bnum
op_star
id|lpb
op_star
id|bpl
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|bnum
suffix:semicolon
id|i
op_increment
)paren
(brace
id|LoadBitmap
c_func
(paren
id|av7110
comma
id|bpp2bit
(braket
id|av7110-&gt;osdbpp
(braket
id|av7110-&gt;osdwin
)braket
)braket
comma
id|w
comma
id|lpb
comma
id|inc
comma
id|data
)paren
suffix:semicolon
id|BlitBitmap
c_func
(paren
id|av7110
comma
id|av7110-&gt;osdwin
comma
id|x0
comma
id|y0
op_plus
id|i
op_star
id|lpb
comma
l_int|0
)paren
suffix:semicolon
id|data
op_add_assign
id|lpb
op_star
id|inc
suffix:semicolon
)brace
r_if
c_cond
(paren
id|brest
)paren
(brace
id|LoadBitmap
c_func
(paren
id|av7110
comma
id|bpp2bit
(braket
id|av7110-&gt;osdbpp
(braket
id|av7110-&gt;osdwin
)braket
)braket
comma
id|w
comma
id|brest
op_div
id|bpl
comma
id|inc
comma
id|data
)paren
suffix:semicolon
id|BlitBitmap
c_func
(paren
id|av7110
comma
id|av7110-&gt;osdwin
comma
id|x0
comma
id|y0
op_plus
id|bnum
op_star
id|lpb
comma
l_int|0
)paren
suffix:semicolon
)brace
id|ReleaseBitmap
c_func
(paren
id|av7110
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|OSD_DrawCommand
r_static
r_int
id|OSD_DrawCommand
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|osd_cmd_t
op_star
id|dc
)paren
(brace
r_switch
c_cond
(paren
id|dc-&gt;cmd
)paren
(brace
r_case
id|OSD_Close
suffix:colon
id|DestroyOSDWindow
c_func
(paren
id|av7110
comma
id|av7110-&gt;osdwin
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_case
id|OSD_Open
suffix:colon
id|av7110-&gt;osdbpp
(braket
id|av7110-&gt;osdwin
)braket
op_assign
(paren
id|dc-&gt;color
op_minus
l_int|1
)paren
op_amp
l_int|7
suffix:semicolon
id|CreateOSDWindow
c_func
(paren
id|av7110
comma
id|av7110-&gt;osdwin
comma
id|bpp2bit
(braket
id|av7110-&gt;osdbpp
(braket
id|av7110-&gt;osdwin
)braket
)braket
comma
id|dc-&gt;x1
op_minus
id|dc-&gt;x0
op_plus
l_int|1
comma
id|dc-&gt;y1
op_minus
id|dc-&gt;y0
op_plus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dc-&gt;data
)paren
(brace
id|MoveWindowAbs
c_func
(paren
id|av7110
comma
id|av7110-&gt;osdwin
comma
id|dc-&gt;x0
comma
id|dc-&gt;y0
)paren
suffix:semicolon
id|SetColorBlend
c_func
(paren
id|av7110
comma
id|av7110-&gt;osdwin
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
r_case
id|OSD_Show
suffix:colon
id|MoveWindowRel
c_func
(paren
id|av7110
comma
id|av7110-&gt;osdwin
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_case
id|OSD_Hide
suffix:colon
id|HideWindow
c_func
(paren
id|av7110
comma
id|av7110-&gt;osdwin
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_case
id|OSD_Clear
suffix:colon
id|DrawBlock
c_func
(paren
id|av7110
comma
id|av7110-&gt;osdwin
comma
l_int|0
comma
l_int|0
comma
l_int|720
comma
l_int|576
comma
l_int|0
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_case
id|OSD_Fill
suffix:colon
id|DrawBlock
c_func
(paren
id|av7110
comma
id|av7110-&gt;osdwin
comma
l_int|0
comma
l_int|0
comma
l_int|720
comma
l_int|576
comma
id|dc-&gt;color
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_case
id|OSD_SetColor
suffix:colon
id|OSDSetColor
c_func
(paren
id|av7110
comma
id|dc-&gt;color
comma
id|dc-&gt;x0
comma
id|dc-&gt;y0
comma
id|dc-&gt;x1
comma
id|dc-&gt;y1
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_case
id|OSD_SetPalette
suffix:colon
(brace
r_if
c_cond
(paren
id|FW_VERSION
c_func
(paren
id|av7110-&gt;arm_app
)paren
op_ge
l_int|0x2618
)paren
id|OSDSetPalette
c_func
(paren
id|av7110
comma
(paren
id|u32
op_star
)paren
id|dc-&gt;data
comma
id|dc-&gt;color
comma
id|dc-&gt;x0
)paren
suffix:semicolon
r_else
(brace
r_int
id|i
comma
id|len
op_assign
id|dc-&gt;x0
op_minus
id|dc-&gt;color
op_plus
l_int|1
suffix:semicolon
id|u8
op_star
id|colors
op_assign
(paren
id|u8
op_star
)paren
id|dc-&gt;data
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|len
suffix:semicolon
id|i
op_increment
)paren
id|OSDSetColor
c_func
(paren
id|av7110
comma
id|dc-&gt;color
op_plus
id|i
comma
id|colors
(braket
id|i
op_star
l_int|4
)braket
comma
id|colors
(braket
id|i
op_star
l_int|4
op_plus
l_int|1
)braket
comma
id|colors
(braket
id|i
op_star
l_int|4
op_plus
l_int|2
)braket
comma
id|colors
(braket
id|i
op_star
l_int|4
op_plus
l_int|3
)braket
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
r_case
id|OSD_SetTrans
suffix:colon
r_return
l_int|0
suffix:semicolon
r_case
id|OSD_SetPixel
suffix:colon
id|DrawLine
c_func
(paren
id|av7110
comma
id|av7110-&gt;osdwin
comma
id|dc-&gt;x0
comma
id|dc-&gt;y0
comma
l_int|0
comma
l_int|0
comma
id|dc-&gt;color
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_case
id|OSD_GetPixel
suffix:colon
r_return
l_int|0
suffix:semicolon
r_case
id|OSD_SetRow
suffix:colon
id|dc-&gt;y1
op_assign
id|dc-&gt;y0
suffix:semicolon
r_case
id|OSD_SetBlock
suffix:colon
id|OSDSetBlock
c_func
(paren
id|av7110
comma
id|dc-&gt;x0
comma
id|dc-&gt;y0
comma
id|dc-&gt;x1
comma
id|dc-&gt;y1
comma
id|dc-&gt;color
comma
id|dc-&gt;data
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_case
id|OSD_FillRow
suffix:colon
id|DrawBlock
c_func
(paren
id|av7110
comma
id|av7110-&gt;osdwin
comma
id|dc-&gt;x0
comma
id|dc-&gt;y0
comma
id|dc-&gt;x1
op_minus
id|dc-&gt;x0
op_plus
l_int|1
comma
id|dc-&gt;y1
comma
id|dc-&gt;color
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_case
id|OSD_FillBlock
suffix:colon
id|DrawBlock
c_func
(paren
id|av7110
comma
id|av7110-&gt;osdwin
comma
id|dc-&gt;x0
comma
id|dc-&gt;y0
comma
id|dc-&gt;x1
op_minus
id|dc-&gt;x0
op_plus
l_int|1
comma
id|dc-&gt;y1
op_minus
id|dc-&gt;y0
op_plus
l_int|1
comma
id|dc-&gt;color
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_case
id|OSD_Line
suffix:colon
id|DrawLine
c_func
(paren
id|av7110
comma
id|av7110-&gt;osdwin
comma
id|dc-&gt;x0
comma
id|dc-&gt;y0
comma
id|dc-&gt;x1
op_minus
id|dc-&gt;x0
comma
id|dc-&gt;y1
op_minus
id|dc-&gt;y0
comma
id|dc-&gt;color
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_case
id|OSD_Query
suffix:colon
r_return
l_int|0
suffix:semicolon
r_case
id|OSD_Test
suffix:colon
r_return
l_int|0
suffix:semicolon
r_case
id|OSD_Text
suffix:colon
(brace
r_char
id|textbuf
(braket
l_int|240
)braket
suffix:semicolon
r_if
c_cond
(paren
id|strncpy_from_user
c_func
(paren
id|textbuf
comma
id|dc-&gt;data
comma
l_int|240
)paren
OL
l_int|0
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|textbuf
(braket
l_int|239
)braket
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|dc-&gt;x1
OG
l_int|3
)paren
id|dc-&gt;x1
op_assign
l_int|3
suffix:semicolon
id|SetFont
c_func
(paren
id|av7110
comma
id|av7110-&gt;osdwin
comma
id|dc-&gt;x1
comma
(paren
id|u16
)paren
(paren
id|dc-&gt;color
op_amp
l_int|0xffff
)paren
comma
(paren
id|u16
)paren
(paren
id|dc-&gt;color
op_rshift
l_int|16
)paren
)paren
suffix:semicolon
id|FlushText
c_func
(paren
id|av7110
)paren
suffix:semicolon
id|WriteText
c_func
(paren
id|av7110
comma
id|av7110-&gt;osdwin
comma
id|dc-&gt;x0
comma
id|dc-&gt;y0
comma
id|textbuf
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_case
id|OSD_SetWindow
suffix:colon
r_if
c_cond
(paren
id|dc-&gt;x0
l_int|7
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|av7110-&gt;osdwin
op_assign
id|dc-&gt;x0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_case
id|OSD_MoveWindow
suffix:colon
id|MoveWindowAbs
c_func
(paren
id|av7110
comma
id|av7110-&gt;osdwin
comma
id|dc-&gt;x0
comma
id|dc-&gt;y0
)paren
suffix:semicolon
id|SetColorBlend
c_func
(paren
id|av7110
comma
id|av7110-&gt;osdwin
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
)brace
DECL|function|dvb_osd_ioctl
r_static
r_int
id|dvb_osd_ioctl
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
comma
r_int
r_int
id|cmd
comma
r_void
op_star
id|parg
)paren
(brace
r_struct
id|dvb_device
op_star
id|dvbdev
op_assign
(paren
r_struct
id|dvb_device
op_star
)paren
id|file-&gt;private_data
suffix:semicolon
r_struct
id|av7110
op_star
id|av7110
op_assign
(paren
r_struct
id|av7110
op_star
)paren
id|dvbdev-&gt;priv
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|cmd
op_eq
id|OSD_SEND_CMD
)paren
r_return
id|OSD_DrawCommand
c_func
(paren
id|av7110
comma
(paren
id|osd_cmd_t
op_star
)paren
id|parg
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
DECL|variable|dvb_osd_fops
r_static
r_struct
id|file_operations
id|dvb_osd_fops
op_assign
(brace
dot
id|owner
op_assign
id|THIS_MODULE
comma
dot
id|ioctl
op_assign
id|dvb_generic_ioctl
comma
dot
id|open
op_assign
id|dvb_generic_open
comma
dot
id|release
op_assign
id|dvb_generic_release
comma
)brace
suffix:semicolon
DECL|variable|dvbdev_osd
r_static
r_struct
id|dvb_device
id|dvbdev_osd
op_assign
(brace
dot
id|priv
op_assign
l_int|0
comma
dot
id|users
op_assign
l_int|1
comma
dot
id|writers
op_assign
l_int|1
comma
dot
id|fops
op_assign
op_amp
id|dvb_osd_fops
comma
dot
id|kernel_ioctl
op_assign
id|dvb_osd_ioctl
comma
)brace
suffix:semicolon
macro_line|#endif /* CONFIG_DVB_AV7110_OSD */
multiline_comment|/* get version of the firmware ROM, RTSL, video ucode and ARM application  */
DECL|function|firmversion
r_static
r_void
id|firmversion
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
)paren
(brace
id|u16
id|buf
(braket
l_int|20
)braket
suffix:semicolon
id|u16
id|tag
op_assign
(paren
(paren
id|COMTYPE_REQUEST
op_lshift
l_int|8
)paren
op_plus
id|ReqVersion
)paren
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
id|RequestParameter
c_func
(paren
id|av7110
comma
id|tag
comma
id|buf
comma
l_int|16
)paren
suffix:semicolon
id|av7110-&gt;arm_fw
op_assign
(paren
id|buf
(braket
l_int|0
)braket
op_lshift
l_int|16
)paren
op_plus
id|buf
(braket
l_int|1
)braket
suffix:semicolon
id|av7110-&gt;arm_rtsl
op_assign
(paren
id|buf
(braket
l_int|2
)braket
op_lshift
l_int|16
)paren
op_plus
id|buf
(braket
l_int|3
)braket
suffix:semicolon
id|av7110-&gt;arm_vid
op_assign
(paren
id|buf
(braket
l_int|4
)braket
op_lshift
l_int|16
)paren
op_plus
id|buf
(braket
l_int|5
)braket
suffix:semicolon
id|av7110-&gt;arm_app
op_assign
(paren
id|buf
(braket
l_int|6
)braket
op_lshift
l_int|16
)paren
op_plus
id|buf
(braket
l_int|7
)braket
suffix:semicolon
id|av7110-&gt;avtype
op_assign
(paren
id|buf
(braket
l_int|8
)braket
op_lshift
l_int|16
)paren
op_plus
id|buf
(braket
l_int|9
)braket
suffix:semicolon
id|printk
(paren
l_string|&quot;DVB: AV711%d(%d) - firm %08x, rtsl %08x, vid %08x, app %08x&bslash;n&quot;
comma
id|av7110-&gt;avtype
comma
id|av7110-&gt;dvb_adapter-&gt;num
comma
id|av7110-&gt;arm_fw
comma
id|av7110-&gt;arm_rtsl
comma
id|av7110-&gt;arm_vid
comma
id|av7110-&gt;arm_app
)paren
suffix:semicolon
multiline_comment|/* print firmware capabilities */
r_if
c_cond
(paren
id|FW_CI_LL_SUPPORT
c_func
(paren
id|av7110-&gt;arm_app
)paren
)paren
id|printk
(paren
l_string|&quot;DVB: AV711%d(%d) - firmware supports CI link layer interface&bslash;n&quot;
comma
id|av7110-&gt;avtype
comma
id|av7110-&gt;dvb_adapter-&gt;num
)paren
suffix:semicolon
r_else
id|printk
(paren
l_string|&quot;DVB: AV711%d(%d) - no firmware support for CI link layer interface&bslash;n&quot;
comma
id|av7110-&gt;avtype
comma
id|av7110-&gt;dvb_adapter-&gt;num
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
DECL|function|waitdebi
r_static
r_int
id|waitdebi
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
r_int
id|adr
comma
r_int
id|state
)paren
(brace
r_int
id|k
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|k
op_assign
l_int|0
suffix:semicolon
id|k
OL
l_int|100
suffix:semicolon
id|k
op_increment
comma
id|udelay
c_func
(paren
l_int|500
)paren
)paren
(brace
r_if
c_cond
(paren
id|irdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|adr
comma
l_int|0
comma
l_int|2
)paren
op_eq
id|state
)paren
r_return
l_int|0
suffix:semicolon
)brace
r_return
op_minus
l_int|1
suffix:semicolon
)brace
DECL|function|load_dram
r_static
r_int
id|load_dram
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u32
op_star
id|data
comma
r_int
id|len
)paren
(brace
r_int
id|i
suffix:semicolon
r_int
id|blocks
comma
id|rest
suffix:semicolon
id|u32
id|base
comma
id|bootblock
op_assign
id|BOOT_BLOCK
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
id|blocks
op_assign
id|len
op_div
id|BOOT_MAX_SIZE
suffix:semicolon
id|rest
op_assign
id|len
op_mod
id|BOOT_MAX_SIZE
suffix:semicolon
id|base
op_assign
id|DRAM_START_CODE
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|blocks
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|waitdebi
c_func
(paren
id|av7110
comma
id|BOOT_STATE
comma
id|BOOTSTATE_BUFFER_EMPTY
)paren
OL
l_int|0
)paren
r_return
op_minus
l_int|1
suffix:semicolon
id|DEB_D
c_func
(paren
(paren
l_string|&quot;Writing DRAM block %d&bslash;n&quot;
comma
id|i
)paren
)paren
suffix:semicolon
id|mwdebi
c_func
(paren
id|av7110
comma
id|DEBISWAB
comma
id|bootblock
comma
(paren
(paren
r_char
op_star
)paren
id|data
)paren
op_plus
id|i
op_star
(paren
id|BOOT_MAX_SIZE
)paren
comma
id|BOOT_MAX_SIZE
)paren
suffix:semicolon
id|bootblock
op_xor_assign
l_int|0x1400
suffix:semicolon
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBISWAB
comma
id|BOOT_BASE
comma
id|swab32
c_func
(paren
id|base
)paren
comma
l_int|4
)paren
suffix:semicolon
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|BOOT_SIZE
comma
id|BOOT_MAX_SIZE
comma
l_int|2
)paren
suffix:semicolon
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|BOOT_STATE
comma
id|BOOTSTATE_BUFFER_FULL
comma
l_int|2
)paren
suffix:semicolon
id|base
op_add_assign
id|BOOT_MAX_SIZE
suffix:semicolon
)brace
r_if
c_cond
(paren
id|rest
OG
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|waitdebi
c_func
(paren
id|av7110
comma
id|BOOT_STATE
comma
id|BOOTSTATE_BUFFER_EMPTY
)paren
OL
l_int|0
)paren
r_return
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|rest
OG
l_int|4
)paren
id|mwdebi
c_func
(paren
id|av7110
comma
id|DEBISWAB
comma
id|bootblock
comma
(paren
(paren
r_char
op_star
)paren
id|data
)paren
op_plus
id|i
op_star
(paren
id|BOOT_MAX_SIZE
)paren
comma
id|rest
)paren
suffix:semicolon
r_else
id|mwdebi
c_func
(paren
id|av7110
comma
id|DEBISWAB
comma
id|bootblock
comma
(paren
(paren
r_char
op_star
)paren
id|data
)paren
op_plus
id|i
op_star
(paren
id|BOOT_MAX_SIZE
)paren
op_minus
l_int|4
comma
id|rest
op_plus
l_int|4
)paren
suffix:semicolon
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBISWAB
comma
id|BOOT_BASE
comma
id|swab32
c_func
(paren
id|base
)paren
comma
l_int|4
)paren
suffix:semicolon
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|BOOT_SIZE
comma
id|rest
comma
l_int|2
)paren
suffix:semicolon
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|BOOT_STATE
comma
id|BOOTSTATE_BUFFER_FULL
comma
l_int|2
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|waitdebi
c_func
(paren
id|av7110
comma
id|BOOT_STATE
comma
id|BOOTSTATE_BUFFER_EMPTY
)paren
OL
l_int|0
)paren
r_return
op_minus
l_int|1
suffix:semicolon
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|BOOT_SIZE
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|BOOT_STATE
comma
id|BOOTSTATE_BUFFER_FULL
comma
l_int|2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|waitdebi
c_func
(paren
id|av7110
comma
id|BOOT_STATE
comma
id|BOOTSTATE_BOOT_COMPLETE
)paren
OL
l_int|0
)paren
r_return
op_minus
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|bootcode
r_static
id|u8
id|bootcode
(braket
)braket
op_assign
(brace
l_int|0xea
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x0e
comma
l_int|0xe1
comma
l_int|0xb0
comma
l_int|0xf0
comma
l_int|0x0e
comma
multiline_comment|/* 0x0000 */
l_int|0xe2
comma
l_int|0x5e
comma
l_int|0xf0
comma
l_int|0x04
comma
l_int|0xe2
comma
l_int|0x5e
comma
l_int|0xf0
comma
l_int|0x04
comma
l_int|0xe2
comma
l_int|0x5e
comma
l_int|0xf0
comma
l_int|0x08
comma
l_int|0xe2
comma
l_int|0x5e
comma
l_int|0xf0
comma
l_int|0x04
comma
l_int|0xe2
comma
l_int|0x5e
comma
l_int|0xf0
comma
l_int|0x04
comma
l_int|0xe2
comma
l_int|0x5e
comma
l_int|0xf0
comma
l_int|0x04
comma
l_int|0x2c
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x24
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x0c
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x2c
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x34
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0xa5
comma
l_int|0xa5
comma
l_int|0x5a
comma
l_int|0x5a
comma
l_int|0x00
comma
l_int|0x1f
comma
l_int|0x15
comma
l_int|0x55
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x09
comma
l_int|0xe5
comma
l_int|0x9f
comma
l_int|0xd0
comma
l_int|0x5c
comma
l_int|0xe5
comma
l_int|0x9f
comma
l_int|0x40
comma
l_int|0x54
comma
multiline_comment|/* 0x0040 */
l_int|0xe3
comma
l_int|0xa0
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0xe5
comma
l_int|0x84
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0xe5
comma
l_int|0x84
comma
l_int|0x00
comma
l_int|0x04
comma
l_int|0xe1
comma
l_int|0xd4
comma
l_int|0x10
comma
l_int|0xb0
comma
l_int|0xe3
comma
l_int|0x51
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x0a
comma
l_int|0xff
comma
l_int|0xff
comma
l_int|0xfc
comma
l_int|0xe1
comma
l_int|0xa0
comma
l_int|0x10
comma
l_int|0x0d
comma
l_int|0xe5
comma
l_int|0x94
comma
l_int|0x30
comma
l_int|0x04
comma
l_int|0xe1
comma
l_int|0xd4
comma
l_int|0x20
comma
l_int|0xb2
comma
l_int|0xe2
comma
l_int|0x82
comma
l_int|0x20
comma
l_int|0x3f
comma
l_int|0xe1
comma
l_int|0xb0
comma
l_int|0x23
comma
l_int|0x22
comma
l_int|0x03
comma
l_int|0xa0
comma
l_int|0x00
comma
l_int|0x02
comma
l_int|0xe1
comma
l_int|0xc4
comma
l_int|0x00
comma
l_int|0xb0
comma
l_int|0x0a
comma
l_int|0xff
comma
l_int|0xff
comma
l_int|0xf4
comma
l_int|0xe8
comma
l_int|0xb1
comma
l_int|0x1f
comma
l_int|0xe0
comma
l_int|0xe8
comma
l_int|0xa3
comma
l_int|0x1f
comma
l_int|0xe0
comma
multiline_comment|/* 0x0080 */
l_int|0xe8
comma
l_int|0xb1
comma
l_int|0x1f
comma
l_int|0xe0
comma
l_int|0xe8
comma
l_int|0xa3
comma
l_int|0x1f
comma
l_int|0xe0
comma
l_int|0xe2
comma
l_int|0x52
comma
l_int|0x20
comma
l_int|0x01
comma
l_int|0x1a
comma
l_int|0xff
comma
l_int|0xff
comma
l_int|0xf9
comma
l_int|0xe2
comma
l_int|0x2d
comma
l_int|0xdb
comma
l_int|0x05
comma
l_int|0xea
comma
l_int|0xff
comma
l_int|0xff
comma
l_int|0xec
comma
l_int|0x2c
comma
l_int|0x00
comma
l_int|0x03
comma
l_int|0xf8
comma
l_int|0x2c
comma
l_int|0x00
comma
l_int|0x04
comma
l_int|0x00
comma
)brace
suffix:semicolon
macro_line|#include &quot;av7110_firm.h&quot;
DECL|function|bootarm
r_static
r_int
id|bootarm
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
)paren
(brace
r_struct
id|saa7146_dev
op_star
id|dev
op_assign
id|av7110-&gt;dev
suffix:semicolon
id|u32
id|ret
suffix:semicolon
r_int
id|i
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
id|saa7146_setgpio
c_func
(paren
id|dev
comma
id|RESET_LINE
comma
id|SAA7146_GPIO_OUTLO
)paren
suffix:semicolon
multiline_comment|/* Disable DEBI and GPIO irq */
id|IER_DISABLE
c_func
(paren
id|av7110-&gt;dev
comma
id|MASK_03
op_or
id|MASK_19
)paren
suffix:semicolon
multiline_comment|/*&n;        saa7146_write(av7110-&gt;dev, IER, &n;                      saa7146_read(av7110-&gt;dev, IER) &amp; &n;                      ~(MASK_19 | MASK_03));&n;*/
id|saa7146_write
c_func
(paren
id|av7110-&gt;dev
comma
id|ISR
comma
(paren
id|MASK_19
op_or
id|MASK_03
)paren
)paren
suffix:semicolon
multiline_comment|/* enable DEBI */
id|saa7146_write
c_func
(paren
id|av7110-&gt;dev
comma
id|MC1
comma
l_int|0x08800880
)paren
suffix:semicolon
id|saa7146_write
c_func
(paren
id|av7110-&gt;dev
comma
id|DD1_STREAM_B
comma
l_int|0x00000000
)paren
suffix:semicolon
id|saa7146_write
c_func
(paren
id|av7110-&gt;dev
comma
id|MC2
comma
(paren
id|MASK_09
op_or
id|MASK_25
op_or
id|MASK_10
op_or
id|MASK_26
)paren
)paren
suffix:semicolon
multiline_comment|/* test DEBI */
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBISWAP
comma
id|DPRAM_BASE
comma
l_int|0x76543210
comma
l_int|4
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|ret
op_assign
id|irdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|DPRAM_BASE
comma
l_int|0
comma
l_int|4
)paren
)paren
op_ne
l_int|0x10325476
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;dvb: debi test in bootarm() failed: &quot;
l_string|&quot;%08x != %08x&bslash;n&quot;
comma
id|ret
comma
l_int|0x10325476
)paren
suffix:semicolon
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|8192
suffix:semicolon
id|i
op_add_assign
l_int|4
)paren
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBISWAP
comma
id|DPRAM_BASE
op_plus
id|i
comma
l_int|0x00
comma
l_int|4
)paren
suffix:semicolon
id|DEB_D
c_func
(paren
(paren
l_string|&quot;bootarm: debi test OK&bslash;n&quot;
)paren
)paren
suffix:semicolon
multiline_comment|/* boot */
id|DEB_D
c_func
(paren
(paren
l_string|&quot;bootarm: load boot code&bslash;n&quot;
)paren
)paren
suffix:semicolon
id|saa7146_setgpio
c_func
(paren
id|dev
comma
id|ARM_IRQ_LINE
comma
id|SAA7146_GPIO_IRQLO
)paren
suffix:semicolon
singleline_comment|//saa7146_setgpio(dev, DEBI_DONE_LINE, SAA7146_GPIO_INPUT);
singleline_comment|//saa7146_setgpio(dev, 3, SAA7146_GPIO_INPUT);
id|mwdebi
c_func
(paren
id|av7110
comma
id|DEBISWAB
comma
id|DPRAM_BASE
comma
id|bootcode
comma
r_sizeof
(paren
id|bootcode
)paren
)paren
suffix:semicolon
id|iwdebi
c_func
(paren
id|av7110
comma
id|DEBINOSWAP
comma
id|BOOT_STATE
comma
id|BOOTSTATE_BUFFER_FULL
comma
l_int|2
)paren
suffix:semicolon
id|wait_for_debi_done
c_func
(paren
id|av7110
)paren
suffix:semicolon
id|saa7146_setgpio
c_func
(paren
id|dev
comma
id|RESET_LINE
comma
id|SAA7146_GPIO_OUTHI
)paren
suffix:semicolon
id|set_current_state
c_func
(paren
id|TASK_INTERRUPTIBLE
)paren
suffix:semicolon
id|schedule_timeout
c_func
(paren
id|HZ
)paren
suffix:semicolon
id|DEB_D
c_func
(paren
(paren
l_string|&quot;bootarm: load dram code&bslash;n&quot;
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|load_dram
c_func
(paren
id|av7110
comma
(paren
id|u32
op_star
)paren
id|Root
comma
r_sizeof
(paren
id|Root
)paren
)paren
OL
l_int|0
)paren
r_return
op_minus
l_int|1
suffix:semicolon
id|saa7146_setgpio
c_func
(paren
id|dev
comma
id|RESET_LINE
comma
id|SAA7146_GPIO_OUTLO
)paren
suffix:semicolon
id|mdelay
c_func
(paren
l_int|1
)paren
suffix:semicolon
id|DEB_D
c_func
(paren
(paren
l_string|&quot;bootarm: load dpram code&bslash;n&quot;
)paren
)paren
suffix:semicolon
id|mwdebi
c_func
(paren
id|av7110
comma
id|DEBISWAB
comma
id|DPRAM_BASE
comma
id|Dpram
comma
r_sizeof
(paren
id|Dpram
)paren
)paren
suffix:semicolon
id|wait_for_debi_done
c_func
(paren
id|av7110
)paren
suffix:semicolon
id|saa7146_setgpio
c_func
(paren
id|dev
comma
id|RESET_LINE
comma
id|SAA7146_GPIO_OUTHI
)paren
suffix:semicolon
id|mdelay
c_func
(paren
l_int|800
)paren
suffix:semicolon
singleline_comment|//ARM_ClearIrq(av7110); 
id|ARM_ResetMailBox
c_func
(paren
id|av7110
)paren
suffix:semicolon
id|saa7146_write
c_func
(paren
id|av7110-&gt;dev
comma
id|ISR
comma
(paren
id|MASK_19
op_or
id|MASK_03
)paren
)paren
suffix:semicolon
id|IER_ENABLE
c_func
(paren
id|av7110-&gt;dev
comma
id|MASK_03
)paren
suffix:semicolon
singleline_comment|//      saa7146_write(av7110-&gt;dev, IER, 
singleline_comment|//                      saa7146_read(av7110-&gt;dev, IER) | MASK_03 );
id|av7110-&gt;arm_errors
op_assign
l_int|0
suffix:semicolon
id|av7110-&gt;arm_ready
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|SetPIDs
r_static
r_inline
r_int
id|SetPIDs
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u16
id|vpid
comma
id|u16
id|apid
comma
id|u16
id|ttpid
comma
id|u16
id|subpid
comma
id|u16
id|pcrpid
)paren
(brace
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|vpid
op_eq
l_int|0x1fff
op_logical_or
id|apid
op_eq
l_int|0x1fff
op_logical_or
id|ttpid
op_eq
l_int|0x1fff
op_logical_or
id|subpid
op_eq
l_int|0x1fff
op_logical_or
id|pcrpid
op_eq
l_int|0x1fff
)paren
(brace
id|vpid
op_assign
id|apid
op_assign
id|ttpid
op_assign
id|subpid
op_assign
id|pcrpid
op_assign
l_int|0
suffix:semicolon
id|av7110-&gt;pids
(braket
id|DMX_PES_VIDEO
)braket
op_assign
l_int|0
suffix:semicolon
id|av7110-&gt;pids
(braket
id|DMX_PES_AUDIO
)braket
op_assign
l_int|0
suffix:semicolon
id|av7110-&gt;pids
(braket
id|DMX_PES_TELETEXT
)braket
op_assign
l_int|0
suffix:semicolon
id|av7110-&gt;pids
(braket
id|DMX_PES_PCR
)braket
op_assign
l_int|0
suffix:semicolon
)brace
r_return
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_PIDFILTER
comma
id|MultiPID
comma
l_int|5
comma
id|pcrpid
comma
id|vpid
comma
id|apid
comma
id|ttpid
comma
id|subpid
)paren
suffix:semicolon
)brace
DECL|function|ChangePIDs
r_static
r_void
id|ChangePIDs
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u16
id|vpid
comma
id|u16
id|apid
comma
id|u16
id|ttpid
comma
id|u16
id|subpid
comma
id|u16
id|pcrpid
)paren
(brace
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|down_interruptible
c_func
(paren
op_amp
id|av7110-&gt;pid_mutex
)paren
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|vpid
op_amp
l_int|0x8000
)paren
)paren
id|av7110-&gt;pids
(braket
id|DMX_PES_VIDEO
)braket
op_assign
id|vpid
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|apid
op_amp
l_int|0x8000
)paren
)paren
id|av7110-&gt;pids
(braket
id|DMX_PES_AUDIO
)braket
op_assign
id|apid
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|ttpid
op_amp
l_int|0x8000
)paren
)paren
id|av7110-&gt;pids
(braket
id|DMX_PES_TELETEXT
)braket
op_assign
id|ttpid
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|pcrpid
op_amp
l_int|0x8000
)paren
)paren
id|av7110-&gt;pids
(braket
id|DMX_PES_PCR
)braket
op_assign
id|pcrpid
suffix:semicolon
id|av7110-&gt;pids
(braket
id|DMX_PES_SUBTITLE
)braket
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|av7110-&gt;fe_synced
)paren
(brace
id|pcrpid
op_assign
id|av7110-&gt;pids
(braket
id|DMX_PES_PCR
)braket
suffix:semicolon
id|SetPIDs
c_func
(paren
id|av7110
comma
id|vpid
comma
id|apid
comma
id|ttpid
comma
id|subpid
comma
id|pcrpid
)paren
suffix:semicolon
)brace
id|up
c_func
(paren
op_amp
id|av7110-&gt;pid_mutex
)paren
suffix:semicolon
)brace
DECL|function|SetMode
r_static
r_void
id|SetMode
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
r_int
id|mode
)paren
(brace
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_ENCODER
comma
id|LoadVidCode
comma
l_int|1
comma
id|mode
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|av7110-&gt;playing
)paren
(brace
id|ChangePIDs
c_func
(paren
id|av7110
comma
id|av7110-&gt;pids
(braket
id|DMX_PES_VIDEO
)braket
comma
id|av7110-&gt;pids
(braket
id|DMX_PES_AUDIO
)braket
comma
id|av7110-&gt;pids
(braket
id|DMX_PES_TELETEXT
)braket
comma
l_int|0
comma
id|av7110-&gt;pids
(braket
id|DMX_PES_PCR
)braket
)paren
suffix:semicolon
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_PIDFILTER
comma
id|Scan
comma
l_int|0
)paren
suffix:semicolon
)brace
)brace
DECL|function|TestMode
r_static
r_inline
r_void
id|TestMode
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
r_int
id|mode
)paren
(brace
singleline_comment|//&t;DEB_EE((&quot;av7110: %p&bslash;n&quot;,av7110));
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_ENCODER
comma
id|SetTestMode
comma
l_int|1
comma
id|mode
)paren
suffix:semicolon
)brace
DECL|function|VidMode
r_static
r_inline
r_void
id|VidMode
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
r_int
id|mode
)paren
(brace
singleline_comment|// &t;DEB_EE((&quot;av7110: %p&bslash;n&quot;,av7110));
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_ENCODER
comma
id|SetVidMode
comma
l_int|1
comma
id|mode
)paren
suffix:semicolon
)brace
DECL|function|vidcom
r_static
r_int
r_inline
id|vidcom
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u32
id|com
comma
id|u32
id|arg
)paren
(brace
singleline_comment|// &t;DEB_EE((&quot;av7110: %p&bslash;n&quot;,av7110));
r_return
id|outcom
c_func
(paren
id|av7110
comma
l_int|0x80
comma
l_int|0x02
comma
l_int|4
comma
(paren
id|com
op_rshift
l_int|16
)paren
comma
(paren
id|com
op_amp
l_int|0xffff
)paren
comma
(paren
id|arg
op_rshift
l_int|16
)paren
comma
(paren
id|arg
op_amp
l_int|0xffff
)paren
)paren
suffix:semicolon
)brace
DECL|function|audcom
r_static
r_int
r_inline
id|audcom
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u32
id|com
)paren
(brace
singleline_comment|//&t;DEB_EE((&quot;av7110: %p&bslash;n&quot;,av7110));
r_return
id|outcom
c_func
(paren
id|av7110
comma
l_int|0x80
comma
l_int|0x03
comma
l_int|4
comma
(paren
id|com
op_rshift
l_int|16
)paren
comma
(paren
id|com
op_amp
l_int|0xffff
)paren
)paren
suffix:semicolon
)brace
DECL|function|Set22K
r_static
r_inline
r_void
id|Set22K
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
r_int
id|state
)paren
(brace
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_AUDIODAC
comma
(paren
id|state
ques
c_cond
id|ON22K
suffix:colon
id|OFF22K
)paren
comma
l_int|0
)paren
suffix:semicolon
)brace
DECL|function|SendDiSEqCMsg
r_static
r_int
id|SendDiSEqCMsg
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
r_int
id|len
comma
id|u8
op_star
id|msg
comma
r_int
r_int
id|burst
)paren
(brace
r_int
id|i
suffix:semicolon
id|u16
id|buf
(braket
l_int|18
)braket
op_assign
(brace
(paren
(paren
id|COMTYPE_AUDIODAC
op_lshift
l_int|8
)paren
op_plus
id|SendDiSEqC
)paren
comma
l_int|16
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|len
OG
l_int|10
)paren
id|len
op_assign
l_int|10
suffix:semicolon
id|buf
(braket
l_int|1
)braket
op_assign
id|len
op_plus
l_int|2
suffix:semicolon
id|buf
(braket
l_int|2
)braket
op_assign
id|len
suffix:semicolon
r_if
c_cond
(paren
id|burst
op_ne
op_minus
l_int|1
)paren
id|buf
(braket
l_int|3
)braket
op_assign
id|burst
ques
c_cond
l_int|0x01
suffix:colon
l_int|0x00
suffix:semicolon
r_else
id|buf
(braket
l_int|3
)braket
op_assign
l_int|0xffff
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|len
suffix:semicolon
id|i
op_increment
)paren
id|buf
(braket
id|i
op_plus
l_int|4
)braket
op_assign
id|msg
(braket
id|i
)braket
suffix:semicolon
r_if
c_cond
(paren
id|SOutCommand
c_func
(paren
id|av7110
comma
id|buf
comma
l_int|18
)paren
)paren
id|printk
c_func
(paren
l_string|&quot;SendDiSEqCMsg error&bslash;n&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/****************************************************************************&n; * I2C client commands&n; ****************************************************************************/
DECL|function|i2c_writereg
r_static
r_inline
r_int
id|i2c_writereg
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u8
id|id
comma
id|u8
id|reg
comma
id|u8
id|val
)paren
(brace
id|u8
id|msg
(braket
l_int|2
)braket
op_assign
initialization_block
suffix:semicolon
r_struct
id|dvb_i2c_bus
op_star
id|i2c
op_assign
id|av7110-&gt;i2c_bus
suffix:semicolon
r_struct
id|i2c_msg
id|msgs
suffix:semicolon
id|msgs.flags
op_assign
l_int|0
suffix:semicolon
id|msgs.addr
op_assign
id|id
op_div
l_int|2
suffix:semicolon
id|msgs.len
op_assign
l_int|2
suffix:semicolon
id|msgs.buf
op_assign
id|msg
suffix:semicolon
r_return
id|i2c-&gt;xfer
(paren
id|i2c
comma
op_amp
id|msgs
comma
l_int|1
)paren
suffix:semicolon
)brace
DECL|function|i2c_readreg
r_static
r_inline
id|u8
id|i2c_readreg
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u8
id|id
comma
id|u8
id|reg
)paren
(brace
r_struct
id|dvb_i2c_bus
op_star
id|i2c
op_assign
id|av7110-&gt;i2c_bus
suffix:semicolon
id|u8
id|mm1
(braket
)braket
op_assign
(brace
l_int|0x00
)brace
suffix:semicolon
id|u8
id|mm2
(braket
)braket
op_assign
(brace
l_int|0x00
)brace
suffix:semicolon
r_struct
id|i2c_msg
id|msgs
(braket
l_int|2
)braket
suffix:semicolon
id|msgs
(braket
l_int|0
)braket
dot
id|flags
op_assign
l_int|0
suffix:semicolon
id|msgs
(braket
l_int|1
)braket
dot
id|flags
op_assign
id|I2C_M_RD
suffix:semicolon
id|msgs
(braket
l_int|0
)braket
dot
id|addr
op_assign
id|msgs
(braket
l_int|1
)braket
dot
id|addr
op_assign
id|id
op_div
l_int|2
suffix:semicolon
id|mm1
(braket
l_int|0
)braket
op_assign
id|reg
suffix:semicolon
id|msgs
(braket
l_int|0
)braket
dot
id|len
op_assign
l_int|1
suffix:semicolon
id|msgs
(braket
l_int|1
)braket
dot
id|len
op_assign
l_int|1
suffix:semicolon
id|msgs
(braket
l_int|0
)braket
dot
id|buf
op_assign
id|mm1
suffix:semicolon
id|msgs
(braket
l_int|1
)braket
dot
id|buf
op_assign
id|mm2
suffix:semicolon
id|i2c
op_member_access_from_pointer
id|xfer
c_func
(paren
id|i2c
comma
id|msgs
comma
l_int|2
)paren
suffix:semicolon
r_return
id|mm2
(braket
l_int|0
)braket
suffix:semicolon
)brace
multiline_comment|/****************************************************************************&n; * I/O buffer management and control&n; ****************************************************************************/
DECL|variable|sw2mode
r_static
r_int
id|sw2mode
(braket
l_int|16
)braket
op_assign
(brace
id|VIDEO_MODE_PAL
comma
id|VIDEO_MODE_NTSC
comma
id|VIDEO_MODE_NTSC
comma
id|VIDEO_MODE_PAL
comma
id|VIDEO_MODE_NTSC
comma
id|VIDEO_MODE_NTSC
comma
id|VIDEO_MODE_PAL
comma
id|VIDEO_MODE_NTSC
comma
id|VIDEO_MODE_PAL
comma
id|VIDEO_MODE_PAL
comma
id|VIDEO_MODE_PAL
comma
id|VIDEO_MODE_PAL
comma
id|VIDEO_MODE_PAL
comma
id|VIDEO_MODE_PAL
comma
id|VIDEO_MODE_PAL
comma
id|VIDEO_MODE_PAL
comma
)brace
suffix:semicolon
DECL|function|get_video_format
r_static
r_void
id|get_video_format
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u8
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_int
id|i
suffix:semicolon
r_int
id|hsize
comma
id|vsize
suffix:semicolon
r_int
id|sw
suffix:semicolon
id|u8
op_star
id|p
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|av7110-&gt;sinfo
)paren
r_return
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|7
suffix:semicolon
id|i
OL
id|count
op_minus
l_int|10
suffix:semicolon
id|i
op_increment
)paren
(brace
id|p
op_assign
id|buf
op_plus
id|i
suffix:semicolon
r_if
c_cond
(paren
id|p
(braket
l_int|0
)braket
op_logical_or
id|p
(braket
l_int|1
)braket
op_logical_or
id|p
(braket
l_int|2
)braket
op_ne
l_int|0x01
op_logical_or
id|p
(braket
l_int|3
)braket
op_ne
l_int|0xb3
)paren
r_continue
suffix:semicolon
id|p
op_add_assign
l_int|4
suffix:semicolon
id|hsize
op_assign
(paren
(paren
id|p
(braket
l_int|1
)braket
op_amp
l_int|0xF0
)paren
op_rshift
l_int|4
)paren
op_or
(paren
id|p
(braket
l_int|0
)braket
op_lshift
l_int|4
)paren
suffix:semicolon
id|vsize
op_assign
(paren
(paren
id|p
(braket
l_int|1
)braket
op_amp
l_int|0x0F
)paren
op_lshift
l_int|8
)paren
op_or
(paren
id|p
(braket
l_int|2
)braket
)paren
suffix:semicolon
id|sw
op_assign
(paren
id|p
(braket
l_int|3
)braket
op_amp
l_int|0x0F
)paren
suffix:semicolon
id|SetMode
c_func
(paren
id|av7110
comma
id|sw2mode
(braket
id|sw
)braket
)paren
suffix:semicolon
id|DEB_S
c_func
(paren
(paren
l_string|&quot;dvb: playback %dx%d fr=%d&bslash;n&quot;
comma
id|hsize
comma
id|vsize
comma
id|sw
)paren
)paren
suffix:semicolon
id|av7110-&gt;sinfo
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
DECL|function|aux_ring_buffer_write
r_static
r_inline
r_int
id|aux_ring_buffer_write
c_func
(paren
r_struct
id|dvb_ringbuffer
op_star
id|rbuf
comma
r_const
r_char
op_star
id|buf
comma
r_int
r_int
id|count
)paren
(brace
r_int
r_int
id|todo
op_assign
id|count
suffix:semicolon
r_int
id|free
suffix:semicolon
r_while
c_loop
(paren
id|todo
OG
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|dvb_ringbuffer_free
c_func
(paren
id|rbuf
)paren
OL
l_int|2048
)paren
(brace
r_if
c_cond
(paren
id|wait_event_interruptible
c_func
(paren
id|rbuf-&gt;queue
comma
(paren
id|dvb_ringbuffer_free
c_func
(paren
id|rbuf
)paren
op_ge
l_int|2048
)paren
)paren
)paren
r_return
id|count
op_minus
id|todo
suffix:semicolon
)brace
id|free
op_assign
id|dvb_ringbuffer_free
c_func
(paren
id|rbuf
)paren
suffix:semicolon
r_if
c_cond
(paren
id|free
OG
id|todo
)paren
id|free
op_assign
id|todo
suffix:semicolon
(paren
r_void
)paren
id|dvb_ringbuffer_write
c_func
(paren
id|rbuf
comma
id|buf
comma
id|free
comma
l_int|0
)paren
suffix:semicolon
id|todo
op_sub_assign
id|free
suffix:semicolon
id|buf
op_add_assign
id|free
suffix:semicolon
)brace
r_return
id|count
op_minus
id|todo
suffix:semicolon
)brace
DECL|function|play_video_cb
r_static
r_void
id|play_video_cb
c_func
(paren
id|u8
op_star
id|buf
comma
r_int
id|count
comma
r_void
op_star
id|priv
)paren
(brace
r_struct
id|av7110
op_star
id|av7110
op_assign
(paren
r_struct
id|av7110
op_star
)paren
id|priv
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|buf
(braket
l_int|3
)braket
op_amp
l_int|0xe0
)paren
op_eq
l_int|0xe0
)paren
(brace
id|get_video_format
c_func
(paren
id|av7110
comma
id|buf
comma
id|count
)paren
suffix:semicolon
id|aux_ring_buffer_write
c_func
(paren
op_amp
id|av7110-&gt;avout
comma
id|buf
comma
id|count
)paren
suffix:semicolon
)brace
r_else
id|aux_ring_buffer_write
c_func
(paren
op_amp
id|av7110-&gt;aout
comma
id|buf
comma
id|count
)paren
suffix:semicolon
)brace
DECL|function|play_audio_cb
r_static
r_void
id|play_audio_cb
c_func
(paren
id|u8
op_star
id|buf
comma
r_int
id|count
comma
r_void
op_star
id|priv
)paren
(brace
r_struct
id|av7110
op_star
id|av7110
op_assign
(paren
r_struct
id|av7110
op_star
)paren
id|priv
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
id|aux_ring_buffer_write
c_func
(paren
op_amp
id|av7110-&gt;aout
comma
id|buf
comma
id|count
)paren
suffix:semicolon
)brace
DECL|macro|FREE_COND
mdefine_line|#define FREE_COND (dvb_ringbuffer_free(&amp;av7110-&gt;avout)&gt;=20*1024 &amp;&amp; dvb_ringbuffer_free(&amp;av7110-&gt;aout)&gt;=20*1024)
DECL|function|dvb_play
r_static
id|ssize_t
id|dvb_play
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
r_const
id|u8
op_star
id|buf
comma
r_int
r_int
id|count
comma
r_int
id|nonblock
comma
r_int
id|type
comma
r_int
id|umem
)paren
(brace
r_int
r_int
id|todo
op_assign
id|count
comma
id|n
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|av7110-&gt;kbuf
(braket
id|type
)braket
)paren
r_return
op_minus
id|ENOBUFS
suffix:semicolon
r_if
c_cond
(paren
id|nonblock
op_logical_and
op_logical_neg
id|FREE_COND
)paren
r_return
op_minus
id|EWOULDBLOCK
suffix:semicolon
r_while
c_loop
(paren
id|todo
OG
l_int|0
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|FREE_COND
)paren
(brace
r_if
c_cond
(paren
id|nonblock
)paren
r_return
id|count
op_minus
id|todo
suffix:semicolon
r_if
c_cond
(paren
id|wait_event_interruptible
c_func
(paren
id|av7110-&gt;avout.queue
comma
id|FREE_COND
)paren
)paren
r_return
id|count
op_minus
id|todo
suffix:semicolon
)brace
id|n
op_assign
id|todo
suffix:semicolon
r_if
c_cond
(paren
id|n
OG
id|IPACKS
op_star
l_int|2
)paren
id|n
op_assign
id|IPACKS
op_star
l_int|2
suffix:semicolon
r_if
c_cond
(paren
id|umem
)paren
(brace
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
id|av7110-&gt;kbuf
(braket
id|type
)braket
comma
id|buf
comma
id|n
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|av7110_ipack_instant_repack
c_func
(paren
id|av7110-&gt;kbuf
(braket
id|type
)braket
comma
id|n
comma
op_amp
id|av7110-&gt;ipack
(braket
id|type
)braket
)paren
suffix:semicolon
)brace
r_else
(brace
id|av7110_ipack_instant_repack
c_func
(paren
id|buf
comma
id|n
comma
op_amp
id|av7110-&gt;ipack
(braket
id|type
)braket
)paren
suffix:semicolon
)brace
id|todo
op_sub_assign
id|n
suffix:semicolon
id|buf
op_add_assign
id|n
suffix:semicolon
)brace
r_return
id|count
op_minus
id|todo
suffix:semicolon
)brace
DECL|function|dvb_aplay
r_static
id|ssize_t
id|dvb_aplay
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
r_const
id|u8
op_star
id|buf
comma
r_int
r_int
id|count
comma
r_int
id|nonblock
comma
r_int
id|type
)paren
(brace
r_int
r_int
id|todo
op_assign
id|count
comma
id|n
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|av7110-&gt;kbuf
(braket
id|type
)braket
)paren
r_return
op_minus
id|ENOBUFS
suffix:semicolon
r_if
c_cond
(paren
id|nonblock
op_logical_and
id|dvb_ringbuffer_free
c_func
(paren
op_amp
id|av7110-&gt;aout
)paren
OL
l_int|20
op_star
l_int|1024
)paren
r_return
op_minus
id|EWOULDBLOCK
suffix:semicolon
r_while
c_loop
(paren
id|todo
OG
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|dvb_ringbuffer_free
c_func
(paren
op_amp
id|av7110-&gt;aout
)paren
OL
l_int|20
op_star
l_int|1024
)paren
(brace
r_if
c_cond
(paren
id|nonblock
)paren
r_return
id|count
op_minus
id|todo
suffix:semicolon
r_if
c_cond
(paren
id|wait_event_interruptible
c_func
(paren
id|av7110-&gt;aout.queue
comma
(paren
id|dvb_ringbuffer_free
c_func
(paren
op_amp
id|av7110-&gt;aout
)paren
op_ge
l_int|20
op_star
l_int|1024
)paren
)paren
)paren
r_return
id|count
op_minus
id|todo
suffix:semicolon
)brace
id|n
op_assign
id|todo
suffix:semicolon
r_if
c_cond
(paren
id|n
OG
id|IPACKS
op_star
l_int|2
)paren
id|n
op_assign
id|IPACKS
op_star
l_int|2
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
id|av7110-&gt;kbuf
(braket
id|type
)braket
comma
id|buf
comma
id|n
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|av7110_ipack_instant_repack
c_func
(paren
id|av7110-&gt;kbuf
(braket
id|type
)braket
comma
id|n
comma
op_amp
id|av7110-&gt;ipack
(braket
id|type
)braket
)paren
suffix:semicolon
singleline_comment|//                        memcpy(dvb-&gt;kbuf[type], buf, n); 
id|todo
op_sub_assign
id|n
suffix:semicolon
id|buf
op_add_assign
id|n
suffix:semicolon
)brace
r_return
id|count
op_minus
id|todo
suffix:semicolon
)brace
DECL|function|init_p2t
r_void
id|init_p2t
c_func
(paren
r_struct
id|av7110_p2t
op_star
id|p
comma
r_struct
id|dvb_demux_feed
op_star
id|feed
)paren
(brace
id|memset
c_func
(paren
id|p-&gt;pes
comma
l_int|0
comma
id|TS_SIZE
)paren
suffix:semicolon
id|p-&gt;counter
op_assign
l_int|0
suffix:semicolon
id|p-&gt;pos
op_assign
l_int|0
suffix:semicolon
id|p-&gt;frags
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|feed
)paren
id|p-&gt;feed
op_assign
id|feed
suffix:semicolon
)brace
DECL|function|clear_p2t
r_void
id|clear_p2t
c_func
(paren
r_struct
id|av7110_p2t
op_star
id|p
)paren
(brace
id|memset
c_func
(paren
id|p-&gt;pes
comma
l_int|0
comma
id|TS_SIZE
)paren
suffix:semicolon
singleline_comment|//&t;p-&gt;counter = 0;
id|p-&gt;pos
op_assign
l_int|0
suffix:semicolon
id|p-&gt;frags
op_assign
l_int|0
suffix:semicolon
)brace
DECL|function|find_pes_header
r_int
r_int
id|find_pes_header
c_func
(paren
id|u8
r_const
op_star
id|buf
comma
r_int
r_int
id|length
comma
r_int
op_star
id|frags
)paren
(brace
r_int
id|c
op_assign
l_int|0
suffix:semicolon
r_int
id|found
op_assign
l_int|0
suffix:semicolon
op_star
id|frags
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
id|c
OL
id|length
op_minus
l_int|3
op_logical_and
op_logical_neg
id|found
)paren
(brace
r_if
c_cond
(paren
id|buf
(braket
id|c
)braket
op_eq
l_int|0x00
op_logical_and
id|buf
(braket
id|c
op_plus
l_int|1
)braket
op_eq
l_int|0x00
op_logical_and
id|buf
(braket
id|c
op_plus
l_int|2
)braket
op_eq
l_int|0x01
)paren
(brace
r_switch
c_cond
(paren
id|buf
(braket
id|c
op_plus
l_int|3
)braket
)paren
(brace
r_case
id|PROG_STREAM_MAP
suffix:colon
r_case
id|PRIVATE_STREAM2
suffix:colon
r_case
id|PROG_STREAM_DIR
suffix:colon
r_case
id|ECM_STREAM
suffix:colon
r_case
id|EMM_STREAM
suffix:colon
r_case
id|PADDING_STREAM
suffix:colon
r_case
id|DSM_CC_STREAM
suffix:colon
r_case
id|ISO13522_STREAM
suffix:colon
r_case
id|PRIVATE_STREAM1
suffix:colon
r_case
id|AUDIO_STREAM_S
dot
dot
dot
id|AUDIO_STREAM_E
suffix:colon
r_case
id|VIDEO_STREAM_S
dot
dot
dot
id|VIDEO_STREAM_E
suffix:colon
id|found
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|c
op_increment
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_else
id|c
op_increment
suffix:semicolon
)brace
r_if
c_cond
(paren
id|c
op_eq
id|length
op_minus
l_int|3
op_logical_and
op_logical_neg
id|found
)paren
(brace
r_if
c_cond
(paren
id|buf
(braket
id|length
op_minus
l_int|1
)braket
op_eq
l_int|0x00
)paren
op_star
id|frags
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|buf
(braket
id|length
op_minus
l_int|2
)braket
op_eq
l_int|0x00
op_logical_and
id|buf
(braket
id|length
op_minus
l_int|1
)braket
op_eq
l_int|0x00
)paren
op_star
id|frags
op_assign
l_int|2
suffix:semicolon
r_if
c_cond
(paren
id|buf
(braket
id|length
op_minus
l_int|3
)braket
op_eq
l_int|0x00
op_logical_and
id|buf
(braket
id|length
op_minus
l_int|2
)braket
op_eq
l_int|0x00
op_logical_and
id|buf
(braket
id|length
op_minus
l_int|1
)braket
op_eq
l_int|0x01
)paren
op_star
id|frags
op_assign
l_int|3
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_return
id|c
suffix:semicolon
)brace
DECL|function|pes_to_ts
r_void
id|pes_to_ts
c_func
(paren
id|u8
r_const
op_star
id|buf
comma
r_int
r_int
id|length
comma
id|u16
id|pid
comma
r_struct
id|av7110_p2t
op_star
id|p
)paren
(brace
r_int
id|c
comma
id|c2
comma
id|l
comma
id|add
suffix:semicolon
r_int
id|check
comma
id|rest
suffix:semicolon
id|c
op_assign
l_int|0
suffix:semicolon
id|c2
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|p-&gt;frags
)paren
(brace
id|check
op_assign
l_int|0
suffix:semicolon
r_switch
c_cond
(paren
id|p-&gt;frags
)paren
(brace
r_case
l_int|1
suffix:colon
r_if
c_cond
(paren
id|buf
(braket
id|c
)braket
op_eq
l_int|0x00
op_logical_and
id|buf
(braket
id|c
op_plus
l_int|1
)braket
op_eq
l_int|0x01
)paren
(brace
id|check
op_assign
l_int|1
suffix:semicolon
id|c
op_add_assign
l_int|2
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
r_if
c_cond
(paren
id|buf
(braket
id|c
)braket
op_eq
l_int|0x01
)paren
(brace
id|check
op_assign
l_int|1
suffix:semicolon
id|c
op_increment
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
id|check
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|check
)paren
(brace
r_switch
c_cond
(paren
id|buf
(braket
id|c
)braket
)paren
(brace
r_case
id|PROG_STREAM_MAP
suffix:colon
r_case
id|PRIVATE_STREAM2
suffix:colon
r_case
id|PROG_STREAM_DIR
suffix:colon
r_case
id|ECM_STREAM
suffix:colon
r_case
id|EMM_STREAM
suffix:colon
r_case
id|PADDING_STREAM
suffix:colon
r_case
id|DSM_CC_STREAM
suffix:colon
r_case
id|ISO13522_STREAM
suffix:colon
r_case
id|PRIVATE_STREAM1
suffix:colon
r_case
id|AUDIO_STREAM_S
dot
dot
dot
id|AUDIO_STREAM_E
suffix:colon
r_case
id|VIDEO_STREAM_S
dot
dot
dot
id|VIDEO_STREAM_E
suffix:colon
id|p-&gt;pes
(braket
l_int|0
)braket
op_assign
l_int|0x00
suffix:semicolon
id|p-&gt;pes
(braket
l_int|1
)braket
op_assign
l_int|0x00
suffix:semicolon
id|p-&gt;pes
(braket
l_int|2
)braket
op_assign
l_int|0x01
suffix:semicolon
id|p-&gt;pes
(braket
l_int|3
)braket
op_assign
id|buf
(braket
id|c
)braket
suffix:semicolon
id|p-&gt;pos
op_assign
l_int|4
suffix:semicolon
id|memcpy
c_func
(paren
id|p-&gt;pes
op_plus
id|p-&gt;pos
comma
id|buf
op_plus
id|c
comma
(paren
id|TS_SIZE
op_minus
l_int|4
)paren
op_minus
id|p-&gt;pos
)paren
suffix:semicolon
id|c
op_add_assign
(paren
id|TS_SIZE
op_minus
l_int|4
)paren
op_minus
id|p-&gt;pos
suffix:semicolon
id|p_to_t
c_func
(paren
id|p-&gt;pes
comma
(paren
id|TS_SIZE
op_minus
l_int|4
)paren
comma
id|pid
comma
op_amp
id|p-&gt;counter
comma
id|p-&gt;feed
)paren
suffix:semicolon
id|clear_p2t
c_func
(paren
id|p
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|c
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
id|p-&gt;frags
op_assign
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|p-&gt;pos
)paren
(brace
id|c2
op_assign
id|find_pes_header
c_func
(paren
id|buf
op_plus
id|c
comma
id|length
op_minus
id|c
comma
op_amp
id|p-&gt;frags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|c2
op_ge
l_int|0
op_logical_and
id|c2
OL
(paren
id|TS_SIZE
op_minus
l_int|4
)paren
op_minus
id|p-&gt;pos
)paren
(brace
id|l
op_assign
id|c2
op_plus
id|c
suffix:semicolon
)brace
r_else
id|l
op_assign
(paren
id|TS_SIZE
op_minus
l_int|4
)paren
op_minus
id|p-&gt;pos
suffix:semicolon
id|memcpy
c_func
(paren
id|p-&gt;pes
op_plus
id|p-&gt;pos
comma
id|buf
comma
id|l
)paren
suffix:semicolon
id|c
op_add_assign
id|l
suffix:semicolon
id|p-&gt;pos
op_add_assign
id|l
suffix:semicolon
id|p_to_t
c_func
(paren
id|p-&gt;pes
comma
id|p-&gt;pos
comma
id|pid
comma
op_amp
id|p-&gt;counter
comma
id|p-&gt;feed
)paren
suffix:semicolon
id|clear_p2t
c_func
(paren
id|p
)paren
suffix:semicolon
)brace
id|add
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
id|c
OL
id|length
)paren
(brace
id|c2
op_assign
id|find_pes_header
c_func
(paren
id|buf
op_plus
id|c
op_plus
id|add
comma
id|length
op_minus
id|c
op_minus
id|add
comma
op_amp
id|p-&gt;frags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|c2
op_ge
l_int|0
)paren
(brace
id|c2
op_add_assign
id|c
op_plus
id|add
suffix:semicolon
r_if
c_cond
(paren
id|c2
OG
id|c
)paren
(brace
id|p_to_t
c_func
(paren
id|buf
op_plus
id|c
comma
id|c2
op_minus
id|c
comma
id|pid
comma
op_amp
id|p-&gt;counter
comma
id|p-&gt;feed
)paren
suffix:semicolon
id|c
op_assign
id|c2
suffix:semicolon
id|clear_p2t
c_func
(paren
id|p
)paren
suffix:semicolon
id|add
op_assign
l_int|0
suffix:semicolon
)brace
r_else
id|add
op_assign
l_int|1
suffix:semicolon
)brace
r_else
(brace
id|l
op_assign
id|length
op_minus
id|c
suffix:semicolon
id|rest
op_assign
id|l
op_mod
(paren
id|TS_SIZE
op_minus
l_int|4
)paren
suffix:semicolon
id|l
op_sub_assign
id|rest
suffix:semicolon
id|p_to_t
c_func
(paren
id|buf
op_plus
id|c
comma
id|l
comma
id|pid
comma
op_amp
id|p-&gt;counter
comma
id|p-&gt;feed
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|p-&gt;pes
comma
id|buf
op_plus
id|c
op_plus
id|l
comma
id|rest
)paren
suffix:semicolon
id|p-&gt;pos
op_assign
id|rest
suffix:semicolon
id|c
op_assign
id|length
suffix:semicolon
)brace
)brace
)brace
DECL|function|write_ts_header2
r_int
id|write_ts_header2
c_func
(paren
id|u16
id|pid
comma
id|u8
op_star
id|counter
comma
r_int
id|pes_start
comma
id|u8
op_star
id|buf
comma
id|u8
id|length
)paren
(brace
r_int
id|i
suffix:semicolon
r_int
id|c
op_assign
l_int|0
suffix:semicolon
r_int
id|fill
suffix:semicolon
id|u8
id|tshead
(braket
l_int|4
)braket
op_assign
(brace
l_int|0x47
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x10
)brace
suffix:semicolon
id|fill
op_assign
(paren
id|TS_SIZE
op_minus
l_int|4
)paren
op_minus
id|length
suffix:semicolon
r_if
c_cond
(paren
id|pes_start
)paren
id|tshead
(braket
l_int|1
)braket
op_assign
l_int|0x40
suffix:semicolon
r_if
c_cond
(paren
id|fill
)paren
id|tshead
(braket
l_int|3
)braket
op_assign
l_int|0x30
suffix:semicolon
id|tshead
(braket
l_int|1
)braket
op_or_assign
(paren
id|u8
)paren
(paren
(paren
id|pid
op_amp
l_int|0x1F00
)paren
op_rshift
l_int|8
)paren
suffix:semicolon
id|tshead
(braket
l_int|2
)braket
op_or_assign
(paren
id|u8
)paren
(paren
id|pid
op_amp
l_int|0x00FF
)paren
suffix:semicolon
id|tshead
(braket
l_int|3
)braket
op_or_assign
(paren
(paren
op_star
id|counter
)paren
op_increment
op_amp
l_int|0x0F
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|buf
comma
id|tshead
comma
l_int|4
)paren
suffix:semicolon
id|c
op_add_assign
l_int|4
suffix:semicolon
r_if
c_cond
(paren
id|fill
)paren
(brace
id|buf
(braket
l_int|4
)braket
op_assign
id|fill
op_minus
l_int|1
suffix:semicolon
id|c
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|fill
OG
l_int|1
)paren
(brace
id|buf
(braket
l_int|5
)braket
op_assign
l_int|0x00
suffix:semicolon
id|c
op_increment
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|6
suffix:semicolon
id|i
OL
id|fill
op_plus
l_int|4
suffix:semicolon
id|i
op_increment
)paren
(brace
id|buf
(braket
id|i
)braket
op_assign
l_int|0xFF
suffix:semicolon
id|c
op_increment
suffix:semicolon
)brace
)brace
r_return
id|c
suffix:semicolon
)brace
DECL|function|p_to_t
r_void
id|p_to_t
c_func
(paren
id|u8
r_const
op_star
id|buf
comma
r_int
r_int
id|length
comma
id|u16
id|pid
comma
id|u8
op_star
id|counter
comma
r_struct
id|dvb_demux_feed
op_star
id|feed
)paren
(brace
r_int
id|l
comma
id|pes_start
suffix:semicolon
id|u8
id|obuf
(braket
id|TS_SIZE
)braket
suffix:semicolon
r_int
r_int
id|c
op_assign
l_int|0
suffix:semicolon
id|pes_start
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|length
OG
l_int|3
op_logical_and
id|buf
(braket
l_int|0
)braket
op_eq
l_int|0x00
op_logical_and
id|buf
(braket
l_int|1
)braket
op_eq
l_int|0x00
op_logical_and
id|buf
(braket
l_int|2
)braket
op_eq
l_int|0x01
)paren
r_switch
c_cond
(paren
id|buf
(braket
l_int|3
)braket
)paren
(brace
r_case
id|PROG_STREAM_MAP
suffix:colon
r_case
id|PRIVATE_STREAM2
suffix:colon
r_case
id|PROG_STREAM_DIR
suffix:colon
r_case
id|ECM_STREAM
suffix:colon
r_case
id|EMM_STREAM
suffix:colon
r_case
id|PADDING_STREAM
suffix:colon
r_case
id|DSM_CC_STREAM
suffix:colon
r_case
id|ISO13522_STREAM
suffix:colon
r_case
id|PRIVATE_STREAM1
suffix:colon
r_case
id|AUDIO_STREAM_S
dot
dot
dot
id|AUDIO_STREAM_E
suffix:colon
r_case
id|VIDEO_STREAM_S
dot
dot
dot
id|VIDEO_STREAM_E
suffix:colon
id|pes_start
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_break
suffix:semicolon
)brace
r_while
c_loop
(paren
id|c
OL
id|length
)paren
(brace
id|memset
c_func
(paren
id|obuf
comma
l_int|0
comma
id|TS_SIZE
)paren
suffix:semicolon
r_if
c_cond
(paren
id|length
op_minus
id|c
op_ge
(paren
id|TS_SIZE
op_minus
l_int|4
)paren
)paren
(brace
id|l
op_assign
id|write_ts_header2
c_func
(paren
id|pid
comma
id|counter
comma
id|pes_start
comma
id|obuf
comma
(paren
id|TS_SIZE
op_minus
l_int|4
)paren
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|obuf
op_plus
id|l
comma
id|buf
op_plus
id|c
comma
id|TS_SIZE
op_minus
id|l
)paren
suffix:semicolon
id|c
op_add_assign
id|TS_SIZE
op_minus
id|l
suffix:semicolon
)brace
r_else
(brace
id|l
op_assign
id|write_ts_header2
c_func
(paren
id|pid
comma
id|counter
comma
id|pes_start
comma
id|obuf
comma
id|length
op_minus
id|c
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|obuf
op_plus
id|l
comma
id|buf
op_plus
id|c
comma
id|TS_SIZE
op_minus
id|l
)paren
suffix:semicolon
id|c
op_assign
id|length
suffix:semicolon
)brace
id|feed-&gt;cb
dot
id|ts
c_func
(paren
id|obuf
comma
l_int|188
comma
l_int|0
comma
l_int|0
comma
op_amp
id|feed-&gt;feed.ts
comma
id|DMX_OK
)paren
suffix:semicolon
id|pes_start
op_assign
l_int|0
suffix:semicolon
)brace
)brace
multiline_comment|/****************************************************************************&n; * V4L SECTION&n; ****************************************************************************/
DECL|variable|inputs
r_static
r_struct
id|v4l2_input
id|inputs
(braket
l_int|2
)braket
op_assign
(brace
(brace
dot
id|index
op_assign
l_int|0
comma
dot
id|name
op_assign
l_string|&quot;DVB&quot;
comma
dot
id|type
op_assign
id|V4L2_INPUT_TYPE_CAMERA
comma
dot
id|audioset
op_assign
l_int|1
comma
dot
id|tuner
op_assign
l_int|0
comma
multiline_comment|/* ignored */
dot
id|std
op_assign
id|V4L2_STD_PAL_BG
op_or
id|V4L2_STD_NTSC_M
comma
dot
id|status
op_assign
l_int|0
comma
)brace
comma
(brace
dot
id|index
op_assign
l_int|1
comma
dot
id|name
op_assign
l_string|&quot;Television&quot;
comma
dot
id|type
op_assign
id|V4L2_INPUT_TYPE_TUNER
comma
dot
id|audioset
op_assign
l_int|2
comma
dot
id|tuner
op_assign
l_int|0
comma
dot
id|std
op_assign
id|V4L2_STD_PAL_BG
op_or
id|V4L2_STD_NTSC_M
comma
dot
id|status
op_assign
l_int|0
comma
)brace
)brace
suffix:semicolon
multiline_comment|/* taken from ves1820.c */
DECL|function|ves1820_writereg
r_static
r_int
id|ves1820_writereg
c_func
(paren
r_struct
id|saa7146_dev
op_star
id|dev
comma
id|u8
id|reg
comma
id|u8
id|data
)paren
(brace
id|u8
id|addr
op_assign
l_int|0x09
suffix:semicolon
id|u8
id|buf
(braket
)braket
op_assign
(brace
l_int|0x00
comma
id|reg
comma
id|data
)brace
suffix:semicolon
r_struct
id|i2c_msg
id|msg
op_assign
(brace
dot
id|addr
op_assign
id|addr
comma
dot
id|flags
op_assign
l_int|0
comma
dot
id|buf
op_assign
id|buf
comma
dot
id|len
op_assign
l_int|3
)brace
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7710: dev: %p&bslash;n&quot;
comma
id|dev
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
l_int|1
op_ne
id|saa7146_i2c_transfer
c_func
(paren
id|dev
comma
op_amp
id|msg
comma
l_int|1
comma
l_int|1
)paren
)paren
(brace
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|tuner_write
r_static
r_int
id|tuner_write
c_func
(paren
r_struct
id|saa7146_dev
op_star
id|dev
comma
id|u8
id|addr
comma
id|u8
id|data
(braket
l_int|4
)braket
)paren
(brace
r_struct
id|i2c_msg
id|msg
op_assign
(brace
dot
id|addr
op_assign
id|addr
comma
dot
id|flags
op_assign
l_int|0
comma
dot
id|buf
op_assign
id|data
comma
dot
id|len
op_assign
l_int|4
)brace
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7710: dev: %p&bslash;n&quot;
comma
id|dev
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
l_int|1
op_ne
id|saa7146_i2c_transfer
c_func
(paren
id|dev
comma
op_amp
id|msg
comma
l_int|1
comma
l_int|1
)paren
)paren
(brace
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; *   set up the downconverter frequency divisor for a&n; *   reference clock comparision frequency of 62.5 kHz.&n; */
DECL|function|tuner_set_tv_freq
r_static
r_int
id|tuner_set_tv_freq
(paren
r_struct
id|saa7146_dev
op_star
id|dev
comma
id|u32
id|freq
)paren
(brace
id|u32
id|div
suffix:semicolon
id|u8
id|config
suffix:semicolon
id|u8
id|buf
(braket
l_int|4
)braket
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7710: freq: 0x%08x&bslash;n&quot;
comma
id|freq
)paren
)paren
suffix:semicolon
multiline_comment|/* magic number: 614. tuning with the frequency given by v4l2&n;&t;   is always off by 614*62.5 = 38375 kHz...*/
id|div
op_assign
id|freq
op_plus
l_int|614
suffix:semicolon
id|buf
(braket
l_int|0
)braket
op_assign
(paren
id|div
op_rshift
l_int|8
)paren
op_amp
l_int|0x7f
suffix:semicolon
id|buf
(braket
l_int|1
)braket
op_assign
id|div
op_amp
l_int|0xff
suffix:semicolon
id|buf
(braket
l_int|2
)braket
op_assign
l_int|0x8e
suffix:semicolon
r_if
c_cond
(paren
id|freq
OL
(paren
id|u32
)paren
(paren
l_int|16
op_star
l_float|168.25
)paren
)paren
id|config
op_assign
l_int|0xa0
suffix:semicolon
r_else
r_if
c_cond
(paren
id|freq
OL
(paren
id|u32
)paren
(paren
l_int|16
op_star
l_float|447.25
)paren
)paren
id|config
op_assign
l_int|0x90
suffix:semicolon
r_else
id|config
op_assign
l_int|0x30
suffix:semicolon
id|config
op_and_assign
op_complement
l_int|0x02
suffix:semicolon
id|buf
(braket
l_int|3
)braket
op_assign
id|config
suffix:semicolon
r_return
id|tuner_write
(paren
id|dev
comma
l_int|0x61
comma
id|buf
)paren
suffix:semicolon
)brace
DECL|variable|analog_standard
r_static
r_struct
id|saa7146_standard
id|analog_standard
(braket
)braket
suffix:semicolon
DECL|variable|dvb_standard
r_static
r_struct
id|saa7146_standard
id|dvb_standard
(braket
)braket
suffix:semicolon
DECL|variable|standard
r_static
r_struct
id|saa7146_standard
id|standard
(braket
)braket
suffix:semicolon
DECL|variable|msp3400_v4l2_audio
r_static
r_struct
id|v4l2_audio
id|msp3400_v4l2_audio
op_assign
(brace
dot
id|index
op_assign
l_int|0
comma
dot
id|name
op_assign
l_string|&quot;Television&quot;
comma
dot
id|capability
op_assign
id|V4L2_AUDCAP_STEREO
)brace
suffix:semicolon
DECL|function|av7110_dvb_c_switch
r_int
id|av7110_dvb_c_switch
c_func
(paren
r_struct
id|saa7146_fh
op_star
id|fh
)paren
(brace
r_struct
id|saa7146_dev
op_star
id|dev
op_assign
id|fh-&gt;dev
suffix:semicolon
r_struct
id|saa7146_vv
op_star
id|vv
op_assign
id|dev-&gt;vv_data
suffix:semicolon
r_struct
id|av7110
op_star
id|av7110
op_assign
(paren
r_struct
id|av7110
op_star
)paren
id|dev-&gt;ext_priv
suffix:semicolon
id|u16
id|adswitch
suffix:semicolon
id|u8
id|band
op_assign
l_int|0
suffix:semicolon
r_int
id|source
comma
id|sync
suffix:semicolon
r_struct
id|saa7146_fh
op_star
id|ov_fh
op_assign
l_int|NULL
suffix:semicolon
r_int
id|restart_overlay
op_assign
l_int|0
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|vv-&gt;ov_data
op_ne
l_int|NULL
)paren
(brace
id|ov_fh
op_assign
id|vv-&gt;ov_data-&gt;fh
suffix:semicolon
id|saa7146_stop_preview
c_func
(paren
id|ov_fh
)paren
suffix:semicolon
id|restart_overlay
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
l_int|0
op_ne
id|av7110-&gt;current_input
)paren
(brace
id|adswitch
op_assign
l_int|1
suffix:semicolon
id|band
op_assign
l_int|0x68
suffix:semicolon
multiline_comment|/* analog band */
id|source
op_assign
id|SAA7146_HPS_SOURCE_PORT_B
suffix:semicolon
id|sync
op_assign
id|SAA7146_HPS_SYNC_PORT_B
suffix:semicolon
id|memcpy
c_func
(paren
id|standard
comma
id|analog_standard
comma
r_sizeof
(paren
r_struct
id|saa7146_standard
)paren
op_star
l_int|2
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;av7110: switching to analog TV&bslash;n&quot;
)paren
suffix:semicolon
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DSP
comma
l_int|0x0008
comma
l_int|0x0000
)paren
suffix:semicolon
singleline_comment|// loudspeaker source
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DSP
comma
l_int|0x0009
comma
l_int|0x0000
)paren
suffix:semicolon
singleline_comment|// headphone source
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DSP
comma
l_int|0x000a
comma
l_int|0x0000
)paren
suffix:semicolon
singleline_comment|// SCART 1 source
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DSP
comma
l_int|0x000e
comma
l_int|0x3000
)paren
suffix:semicolon
singleline_comment|// FM matrix, mono
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DSP
comma
l_int|0x0000
comma
l_int|0x4f00
)paren
suffix:semicolon
singleline_comment|// loudspeaker + headphone
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DSP
comma
l_int|0x0007
comma
l_int|0x4f00
)paren
suffix:semicolon
singleline_comment|// SCART 1 volume
)brace
r_else
(brace
id|adswitch
op_assign
l_int|0
suffix:semicolon
id|band
op_assign
l_int|0x28
suffix:semicolon
multiline_comment|/* digital band */
id|source
op_assign
id|SAA7146_HPS_SOURCE_PORT_A
suffix:semicolon
id|sync
op_assign
id|SAA7146_HPS_SYNC_PORT_A
suffix:semicolon
id|memcpy
c_func
(paren
id|standard
comma
id|dvb_standard
comma
r_sizeof
(paren
r_struct
id|saa7146_standard
)paren
op_star
l_int|2
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;av7110: switching DVB mode&bslash;n&quot;
)paren
suffix:semicolon
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DSP
comma
l_int|0x0008
comma
l_int|0x0220
)paren
suffix:semicolon
singleline_comment|// loudspeaker source
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DSP
comma
l_int|0x0009
comma
l_int|0x0220
)paren
suffix:semicolon
singleline_comment|// headphone source
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DSP
comma
l_int|0x000a
comma
l_int|0x0220
)paren
suffix:semicolon
singleline_comment|// SCART 1 source
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DSP
comma
l_int|0x000e
comma
l_int|0x3000
)paren
suffix:semicolon
singleline_comment|// FM matrix, mono
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DSP
comma
l_int|0x0000
comma
l_int|0x7f00
)paren
suffix:semicolon
singleline_comment|// loudspeaker + headphone
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DSP
comma
l_int|0x0007
comma
l_int|0x7f00
)paren
suffix:semicolon
singleline_comment|// SCART 1 volume
)brace
multiline_comment|/* hmm, this does not do anything!? */
r_if
c_cond
(paren
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_AUDIODAC
comma
id|ADSwitch
comma
l_int|1
comma
id|adswitch
)paren
)paren
id|printk
c_func
(paren
l_string|&quot;ADSwitch error&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
l_int|0
op_ne
id|ves1820_writereg
c_func
(paren
id|dev
comma
l_int|0x0f
comma
id|band
)paren
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;setting band in demodulator failed.&bslash;n&quot;
)paren
suffix:semicolon
)brace
id|saa7146_set_hps_source_and_sync
c_func
(paren
id|dev
comma
id|source
comma
id|sync
)paren
suffix:semicolon
multiline_comment|/* restart overlay if it was active before */
r_if
c_cond
(paren
l_int|0
op_ne
id|restart_overlay
)paren
(brace
id|saa7146_start_preview
c_func
(paren
id|ov_fh
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|av7110_ioctl
r_int
id|av7110_ioctl
c_func
(paren
r_struct
id|saa7146_fh
op_star
id|fh
comma
r_int
r_int
id|cmd
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|saa7146_dev
op_star
id|dev
op_assign
id|fh-&gt;dev
suffix:semicolon
r_struct
id|av7110
op_star
id|av7110
op_assign
(paren
r_struct
id|av7110
op_star
)paren
id|dev-&gt;ext_priv
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;saa7146_dev: %p&bslash;n&quot;
comma
id|dev
)paren
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|VIDIOC_G_TUNER
suffix:colon
(brace
r_struct
id|v4l2_tuner
op_star
id|t
op_assign
id|arg
suffix:semicolon
id|u16
id|stereo_det
suffix:semicolon
id|s8
id|stereo
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;VIDIOC_G_TUNER: %d&bslash;n&quot;
comma
id|t-&gt;index
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
l_int|0
op_eq
id|av7110-&gt;has_analog_tuner
op_logical_or
id|t-&gt;index
op_ne
l_int|0
)paren
(brace
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|memset
c_func
(paren
id|t
comma
l_int|0
comma
r_sizeof
(paren
op_star
id|t
)paren
)paren
suffix:semicolon
id|strcpy
c_func
(paren
id|t-&gt;name
comma
l_string|&quot;Television&quot;
)paren
suffix:semicolon
id|t-&gt;type
op_assign
id|V4L2_TUNER_ANALOG_TV
suffix:semicolon
id|t-&gt;capability
op_assign
id|V4L2_TUNER_CAP_NORM
op_or
id|V4L2_TUNER_CAP_STEREO
op_or
id|V4L2_TUNER_CAP_LANG1
op_or
id|V4L2_TUNER_CAP_LANG2
op_or
id|V4L2_TUNER_CAP_SAP
suffix:semicolon
id|t-&gt;rangelow
op_assign
l_int|772
suffix:semicolon
multiline_comment|/* 48.25 MHZ / 62.5 kHz = 772, see fi1216mk2-specs, page 2 */
id|t-&gt;rangehigh
op_assign
l_int|13684
suffix:semicolon
multiline_comment|/* 855.25 MHz / 62.5 kHz = 13684 */
multiline_comment|/* FIXME: add the real signal strength here */
id|t-&gt;signal
op_assign
l_int|0xffff
suffix:semicolon
id|t-&gt;afc
op_assign
l_int|0
suffix:semicolon
id|msp_readreg
c_func
(paren
id|av7110
comma
id|MSP_RD_DEM
comma
l_int|0x007e
comma
op_amp
id|stereo_det
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;VIDIOC_G_TUNER: msp3400 TV standard detection: 0x%04x&bslash;n&quot;
comma
id|stereo_det
)paren
suffix:semicolon
id|msp_readreg
c_func
(paren
id|av7110
comma
id|MSP_RD_DSP
comma
l_int|0x0018
comma
op_amp
id|stereo_det
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;VIDIOC_G_TUNER: msp3400 stereo detection: 0x%04x&bslash;n&quot;
comma
id|stereo_det
)paren
suffix:semicolon
id|stereo
op_assign
(paren
id|s8
)paren
(paren
id|stereo_det
op_rshift
l_int|8
)paren
suffix:semicolon
r_if
c_cond
(paren
id|stereo
OG
l_int|0x10
)paren
(brace
multiline_comment|/* stereo */
id|t-&gt;rxsubchans
op_assign
id|V4L2_TUNER_SUB_STEREO
op_or
id|V4L2_TUNER_SUB_MONO
suffix:semicolon
id|t-&gt;audmode
op_assign
id|V4L2_TUNER_MODE_STEREO
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|stereo
OL
op_minus
l_int|0x10
)paren
(brace
multiline_comment|/* bilingual*/
id|t-&gt;rxsubchans
op_assign
id|V4L2_TUNER_SUB_LANG1
op_or
id|V4L2_TUNER_SUB_LANG2
suffix:semicolon
id|t-&gt;audmode
op_assign
id|V4L2_TUNER_MODE_LANG1
suffix:semicolon
)brace
r_else
multiline_comment|/* mono */
id|t-&gt;rxsubchans
op_assign
id|V4L2_TUNER_SUB_MONO
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_case
id|VIDIOC_S_TUNER
suffix:colon
(brace
r_struct
id|v4l2_tuner
op_star
id|t
op_assign
id|arg
suffix:semicolon
id|u16
id|fm_matrix
comma
id|src
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;VIDIOC_S_TUNER: %d&bslash;n&quot;
comma
id|t-&gt;index
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
l_int|0
op_eq
id|av7110-&gt;has_analog_tuner
op_logical_or
id|av7110-&gt;current_input
op_ne
l_int|1
)paren
(brace
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|t-&gt;audmode
)paren
(brace
r_case
id|V4L2_TUNER_MODE_STEREO
suffix:colon
id|DEB_D
c_func
(paren
(paren
l_string|&quot;VIDIOC_S_TUNER: V4L2_TUNER_MODE_STEREO&bslash;n&quot;
)paren
)paren
suffix:semicolon
id|fm_matrix
op_assign
l_int|0x3001
suffix:semicolon
singleline_comment|// stereo
id|src
op_assign
l_int|0x0020
suffix:semicolon
r_break
suffix:semicolon
r_case
id|V4L2_TUNER_MODE_LANG1
suffix:colon
id|DEB_D
c_func
(paren
(paren
l_string|&quot;VIDIOC_S_TUNER: V4L2_TUNER_MODE_LANG1&bslash;n&quot;
)paren
)paren
suffix:semicolon
id|fm_matrix
op_assign
l_int|0x3000
suffix:semicolon
singleline_comment|// mono
id|src
op_assign
l_int|0x0000
suffix:semicolon
r_break
suffix:semicolon
r_case
id|V4L2_TUNER_MODE_LANG2
suffix:colon
id|DEB_D
c_func
(paren
(paren
l_string|&quot;VIDIOC_S_TUNER: V4L2_TUNER_MODE_LANG2&bslash;n&quot;
)paren
)paren
suffix:semicolon
id|fm_matrix
op_assign
l_int|0x3000
suffix:semicolon
singleline_comment|// mono
id|src
op_assign
l_int|0x0010
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
multiline_comment|/* case V4L2_TUNER_MODE_MONO: {*/
id|DEB_D
c_func
(paren
(paren
l_string|&quot;VIDIOC_S_TUNER: TDA9840_SET_MONO&bslash;n&quot;
)paren
)paren
suffix:semicolon
id|fm_matrix
op_assign
l_int|0x3000
suffix:semicolon
singleline_comment|// mono
id|src
op_assign
l_int|0x0030
suffix:semicolon
r_break
suffix:semicolon
)brace
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DSP
comma
l_int|0x000e
comma
id|fm_matrix
)paren
suffix:semicolon
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DSP
comma
l_int|0x0008
comma
id|src
)paren
suffix:semicolon
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DSP
comma
l_int|0x0009
comma
id|src
)paren
suffix:semicolon
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DSP
comma
l_int|0x000a
comma
id|src
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_case
id|VIDIOC_G_FREQUENCY
suffix:colon
(brace
r_struct
id|v4l2_frequency
op_star
id|f
op_assign
id|arg
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;VIDIOC_G_FREQ: freq:0x%08x.&bslash;n&quot;
comma
id|f-&gt;frequency
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
l_int|0
op_eq
id|av7110-&gt;has_analog_tuner
op_logical_or
id|av7110-&gt;current_input
op_ne
l_int|1
)paren
(brace
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|memset
c_func
(paren
id|f
comma
l_int|0
comma
r_sizeof
(paren
op_star
id|f
)paren
)paren
suffix:semicolon
id|f-&gt;type
op_assign
id|V4L2_TUNER_ANALOG_TV
suffix:semicolon
id|f-&gt;frequency
op_assign
id|av7110-&gt;current_freq
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_case
id|VIDIOC_S_FREQUENCY
suffix:colon
(brace
r_struct
id|v4l2_frequency
op_star
id|f
op_assign
id|arg
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;VIDIOC_S_FREQUENCY: freq:0x%08x.&bslash;n&quot;
comma
id|f-&gt;frequency
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
l_int|0
op_eq
id|av7110-&gt;has_analog_tuner
op_logical_or
id|av7110-&gt;current_input
op_ne
l_int|1
)paren
(brace
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|V4L2_TUNER_ANALOG_TV
op_ne
id|f-&gt;type
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DSP
comma
l_int|0x0000
comma
l_int|0xffe0
)paren
suffix:semicolon
singleline_comment|// fast mute
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DSP
comma
l_int|0x0007
comma
l_int|0xffe0
)paren
suffix:semicolon
multiline_comment|/* tune in desired frequency */
id|tuner_set_tv_freq
c_func
(paren
id|dev
comma
id|f-&gt;frequency
)paren
suffix:semicolon
id|av7110-&gt;current_freq
op_assign
id|f-&gt;frequency
suffix:semicolon
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DSP
comma
l_int|0x0015
comma
l_int|0x003f
)paren
suffix:semicolon
singleline_comment|// start stereo detection
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DSP
comma
l_int|0x0015
comma
l_int|0x0000
)paren
suffix:semicolon
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DSP
comma
l_int|0x0000
comma
l_int|0x4f00
)paren
suffix:semicolon
singleline_comment|// loudspeaker + headphone
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DSP
comma
l_int|0x0007
comma
l_int|0x4f00
)paren
suffix:semicolon
singleline_comment|// SCART 1 volume
r_return
l_int|0
suffix:semicolon
)brace
r_case
id|VIDIOC_ENUMINPUT
suffix:colon
(brace
r_struct
id|v4l2_input
op_star
id|i
op_assign
id|arg
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;VIDIOC_ENUMINPUT: %d&bslash;n&quot;
comma
id|i-&gt;index
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
l_int|0
op_ne
id|av7110-&gt;has_analog_tuner
)paren
(brace
r_if
c_cond
(paren
id|i-&gt;index
OL
l_int|0
op_logical_or
id|i-&gt;index
op_ge
l_int|2
)paren
(brace
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|i-&gt;index
op_ne
l_int|0
)paren
(brace
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
)brace
id|memcpy
c_func
(paren
id|i
comma
op_amp
id|inputs
(braket
id|i-&gt;index
)braket
comma
r_sizeof
(paren
r_struct
id|v4l2_input
)paren
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_case
id|VIDIOC_G_INPUT
suffix:colon
(brace
r_int
op_star
id|input
op_assign
(paren
r_int
op_star
)paren
id|arg
suffix:semicolon
op_star
id|input
op_assign
id|av7110-&gt;current_input
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;VIDIOC_G_INPUT: %d&bslash;n&quot;
comma
op_star
id|input
)paren
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_case
id|VIDIOC_S_INPUT
suffix:colon
(brace
r_int
id|input
op_assign
op_star
(paren
r_int
op_star
)paren
id|arg
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;VIDIOC_S_INPUT: %d&bslash;n&quot;
comma
id|input
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
l_int|0
op_eq
id|av7110-&gt;has_analog_tuner
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|input
OL
l_int|0
op_logical_or
id|input
op_ge
l_int|2
)paren
(brace
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
multiline_comment|/* fixme: switch inputs here */
id|av7110-&gt;current_input
op_assign
id|input
suffix:semicolon
r_return
id|av7110_dvb_c_switch
c_func
(paren
id|fh
)paren
suffix:semicolon
)brace
r_case
id|VIDIOC_G_AUDIO
suffix:colon
(brace
r_struct
id|v4l2_audio
op_star
id|a
op_assign
id|arg
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;VIDIOC_G_AUDIO: %d&bslash;n&quot;
comma
id|a-&gt;index
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|a-&gt;index
op_ne
l_int|0
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|memcpy
c_func
(paren
id|a
comma
op_amp
id|msp3400_v4l2_audio
comma
r_sizeof
(paren
r_struct
id|v4l2_audio
)paren
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|VIDIOC_S_AUDIO
suffix:colon
(brace
r_struct
id|v4l2_audio
op_star
id|a
op_assign
id|arg
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;VIDIOC_S_AUDIO: %d&bslash;n&quot;
comma
id|a-&gt;index
)paren
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_default
suffix:colon
id|printk
c_func
(paren
l_string|&quot;no such ioctl&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|ENOIOCTLCMD
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dvb_audio_poll
r_static
r_int
r_int
id|dvb_audio_poll
c_func
(paren
r_struct
id|file
op_star
id|file
comma
id|poll_table
op_star
id|wait
)paren
(brace
r_struct
id|dvb_device
op_star
id|dvbdev
op_assign
(paren
r_struct
id|dvb_device
op_star
)paren
id|file-&gt;private_data
suffix:semicolon
r_struct
id|av7110
op_star
id|av7110
op_assign
(paren
r_struct
id|av7110
op_star
)paren
id|dvbdev-&gt;priv
suffix:semicolon
r_int
r_int
id|mask
op_assign
l_int|0
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
id|poll_wait
c_func
(paren
id|file
comma
op_amp
id|av7110-&gt;aout.queue
comma
id|wait
)paren
suffix:semicolon
r_if
c_cond
(paren
id|av7110-&gt;playing
)paren
(brace
r_if
c_cond
(paren
id|dvb_ringbuffer_free
c_func
(paren
op_amp
id|av7110-&gt;aout
)paren
op_ge
l_int|20
op_star
l_int|1024
)paren
id|mask
op_or_assign
(paren
id|POLLOUT
op_or
id|POLLWRNORM
)paren
suffix:semicolon
)brace
r_else
multiline_comment|/* if not playing: may play if asked for */
id|mask
op_assign
(paren
id|POLLOUT
op_or
id|POLLWRNORM
)paren
suffix:semicolon
r_return
id|mask
suffix:semicolon
)brace
multiline_comment|/****************************************************************************&n; * END OF V4L SECTION&n; ****************************************************************************/
multiline_comment|/****************************************************************************&n; * DVB API SECTION&n; ****************************************************************************/
multiline_comment|/******************************************************************************&n; * hardware filter functions&n; ******************************************************************************/
DECL|function|StartHWFilter
r_static
r_int
id|StartHWFilter
c_func
(paren
r_struct
id|dvb_demux_filter
op_star
id|dvbdmxfilter
)paren
(brace
r_struct
id|dvb_demux_feed
op_star
id|dvbdmxfeed
op_assign
id|dvbdmxfilter-&gt;feed
suffix:semicolon
r_struct
id|av7110
op_star
id|av7110
op_assign
(paren
r_struct
id|av7110
op_star
)paren
id|dvbdmxfeed-&gt;demux-&gt;priv
suffix:semicolon
id|u16
id|buf
(braket
l_int|20
)braket
suffix:semicolon
r_int
id|ret
comma
id|i
suffix:semicolon
id|u16
id|handle
suffix:semicolon
singleline_comment|//        u16 mode=0x0320;
id|u16
id|mode
op_assign
l_int|0xb96a
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dvbdmxfilter-&gt;type
op_eq
id|DMX_TYPE_SEC
)paren
(brace
r_if
c_cond
(paren
id|hw_sections
)paren
(brace
id|buf
(braket
l_int|4
)braket
op_assign
(paren
id|dvbdmxfilter-&gt;filter.filter_value
(braket
l_int|0
)braket
op_lshift
l_int|8
)paren
op_or
id|dvbdmxfilter-&gt;maskandmode
(braket
l_int|0
)braket
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|3
suffix:semicolon
id|i
OL
l_int|18
suffix:semicolon
id|i
op_increment
)paren
id|buf
(braket
id|i
op_plus
l_int|4
op_minus
l_int|2
)braket
op_assign
(paren
id|dvbdmxfilter-&gt;filter.filter_value
(braket
id|i
)braket
op_lshift
l_int|8
)paren
op_or
id|dvbdmxfilter-&gt;maskandmode
(braket
id|i
)braket
suffix:semicolon
id|mode
op_assign
l_int|4
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
(paren
id|dvbdmxfeed-&gt;ts_type
op_amp
id|TS_PACKET
)paren
op_logical_and
op_logical_neg
(paren
id|dvbdmxfeed-&gt;ts_type
op_amp
id|TS_PAYLOAD_ONLY
)paren
)paren
id|init_p2t
c_func
(paren
op_amp
id|av7110-&gt;p2t_filter
(braket
id|dvbdmxfilter-&gt;index
)braket
comma
id|dvbdmxfeed
)paren
suffix:semicolon
id|buf
(braket
l_int|0
)braket
op_assign
(paren
id|COMTYPE_PID_FILTER
op_lshift
l_int|8
)paren
op_plus
id|AddPIDFilter
suffix:semicolon
id|buf
(braket
l_int|1
)braket
op_assign
l_int|16
suffix:semicolon
id|buf
(braket
l_int|2
)braket
op_assign
id|dvbdmxfeed-&gt;pid
suffix:semicolon
id|buf
(braket
l_int|3
)braket
op_assign
id|mode
suffix:semicolon
id|ret
op_assign
id|CommandRequest
c_func
(paren
id|av7110
comma
id|buf
comma
l_int|20
comma
op_amp
id|handle
comma
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
OL
l_int|0
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;StartHWFilter error&bslash;n&quot;
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
id|av7110-&gt;handle2filter
(braket
id|handle
)braket
op_assign
id|dvbdmxfilter
suffix:semicolon
id|dvbdmxfilter-&gt;hw_handle
op_assign
id|handle
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
DECL|function|StopHWFilter
r_static
r_int
id|StopHWFilter
c_func
(paren
r_struct
id|dvb_demux_filter
op_star
id|dvbdmxfilter
)paren
(brace
r_struct
id|av7110
op_star
id|av7110
op_assign
(paren
r_struct
id|av7110
op_star
)paren
id|dvbdmxfilter-&gt;feed-&gt;demux-&gt;priv
suffix:semicolon
id|u16
id|buf
(braket
l_int|3
)braket
suffix:semicolon
id|u16
id|answ
(braket
l_int|2
)braket
suffix:semicolon
r_int
id|ret
suffix:semicolon
id|u16
id|handle
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
id|handle
op_assign
id|dvbdmxfilter-&gt;hw_handle
suffix:semicolon
r_if
c_cond
(paren
id|handle
OG
l_int|32
)paren
(brace
id|DEB_S
c_func
(paren
(paren
l_string|&quot;dvb: StopHWFilter tried to stop invalid filter %d.&bslash;n&quot;
comma
id|handle
)paren
)paren
suffix:semicolon
id|DEB_S
c_func
(paren
(paren
l_string|&quot;dvb: filter type = %d&bslash;n&quot;
comma
id|dvbdmxfilter-&gt;type
)paren
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|av7110-&gt;handle2filter
(braket
id|handle
)braket
op_assign
l_int|NULL
suffix:semicolon
id|buf
(braket
l_int|0
)braket
op_assign
(paren
id|COMTYPE_PID_FILTER
op_lshift
l_int|8
)paren
op_plus
id|DelPIDFilter
suffix:semicolon
id|buf
(braket
l_int|1
)braket
op_assign
l_int|1
suffix:semicolon
id|buf
(braket
l_int|2
)braket
op_assign
id|handle
suffix:semicolon
id|ret
op_assign
id|CommandRequest
c_func
(paren
id|av7110
comma
id|buf
comma
l_int|3
comma
id|answ
comma
l_int|2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
id|printk
c_func
(paren
l_string|&quot;StopHWFilter error&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|answ
(braket
l_int|1
)braket
op_ne
id|handle
)paren
(brace
id|DEB_S
c_func
(paren
(paren
l_string|&quot;dvb: filter %d shutdown error :%d&bslash;n&quot;
comma
id|handle
comma
id|answ
(braket
l_int|1
)braket
)paren
)paren
suffix:semicolon
id|ret
op_assign
op_minus
l_int|1
suffix:semicolon
)brace
r_return
id|ret
suffix:semicolon
)brace
DECL|function|av7110_write_to_decoder
r_static
r_int
id|av7110_write_to_decoder
c_func
(paren
r_struct
id|dvb_demux_feed
op_star
id|feed
comma
r_const
id|u8
op_star
id|buf
comma
r_int
id|len
)paren
(brace
r_struct
id|dvb_demux
op_star
id|demux
op_assign
id|feed-&gt;demux
suffix:semicolon
r_struct
id|av7110
op_star
id|av7110
op_assign
(paren
r_struct
id|av7110
op_star
)paren
id|demux-&gt;priv
suffix:semicolon
r_struct
id|ipack
op_star
id|ipack
op_assign
op_amp
id|av7110-&gt;ipack
(braket
id|feed-&gt;pes_type
)braket
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|feed-&gt;pes_type
)paren
(brace
r_case
l_int|0
suffix:colon
r_if
c_cond
(paren
id|av7110-&gt;audiostate.stream_source
op_eq
id|AUDIO_SOURCE_MEMORY
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
r_if
c_cond
(paren
id|av7110-&gt;videostate.stream_source
op_eq
id|VIDEO_SOURCE_MEMORY
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|buf
(braket
l_int|3
)braket
op_amp
l_int|0x10
)paren
)paren
(brace
singleline_comment|// no payload?
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|buf
(braket
l_int|1
)braket
op_amp
l_int|0x40
)paren
id|av7110_ipack_flush
c_func
(paren
id|ipack
)paren
suffix:semicolon
r_if
c_cond
(paren
id|buf
(braket
l_int|3
)braket
op_amp
l_int|0x20
)paren
(brace
singleline_comment|// adaptation field?
id|len
op_sub_assign
id|buf
(braket
l_int|4
)braket
op_plus
l_int|1
suffix:semicolon
id|buf
op_add_assign
id|buf
(braket
l_int|4
)braket
op_plus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|len
)paren
r_return
l_int|0
suffix:semicolon
)brace
id|av7110_ipack_instant_repack
c_func
(paren
id|buf
op_plus
l_int|4
comma
id|len
op_minus
l_int|4
comma
op_amp
id|av7110-&gt;ipack
(braket
id|feed-&gt;pes_type
)braket
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dvb_feed_start_pid
r_static
r_void
id|dvb_feed_start_pid
c_func
(paren
r_struct
id|dvb_demux_feed
op_star
id|dvbdmxfeed
)paren
(brace
r_struct
id|dvb_demux
op_star
id|dvbdmx
op_assign
id|dvbdmxfeed-&gt;demux
suffix:semicolon
r_struct
id|av7110
op_star
id|av7110
op_assign
(paren
r_struct
id|av7110
op_star
)paren
id|dvbdmx-&gt;priv
suffix:semicolon
id|u16
op_star
id|pid
op_assign
id|dvbdmx-&gt;pids
comma
id|npids
(braket
l_int|5
)braket
suffix:semicolon
r_int
id|i
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
id|npids
(braket
l_int|0
)braket
op_assign
id|npids
(braket
l_int|1
)braket
op_assign
id|npids
(braket
l_int|2
)braket
op_assign
id|npids
(braket
l_int|3
)braket
op_assign
l_int|0xffff
suffix:semicolon
id|npids
(braket
l_int|4
)braket
op_assign
l_int|0xffff
suffix:semicolon
id|i
op_assign
id|dvbdmxfeed-&gt;pes_type
suffix:semicolon
id|npids
(braket
id|i
)braket
op_assign
(paren
id|pid
(braket
id|i
)braket
op_amp
l_int|0x8000
)paren
ques
c_cond
l_int|0
suffix:colon
id|pid
(braket
id|i
)braket
suffix:semicolon
r_if
c_cond
(paren
(paren
id|i
op_eq
l_int|2
)paren
op_logical_and
id|npids
(braket
id|i
)braket
op_logical_and
(paren
id|dvbdmxfeed-&gt;ts_type
op_amp
id|TS_PACKET
)paren
)paren
(brace
id|npids
(braket
id|i
)braket
op_assign
l_int|0
suffix:semicolon
id|ChangePIDs
c_func
(paren
id|av7110
comma
id|npids
(braket
l_int|1
)braket
comma
id|npids
(braket
l_int|0
)braket
comma
id|npids
(braket
l_int|2
)braket
comma
id|npids
(braket
l_int|3
)braket
comma
id|npids
(braket
l_int|4
)braket
)paren
suffix:semicolon
id|StartHWFilter
c_func
(paren
id|dvbdmxfeed-&gt;filter
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|dvbdmxfeed-&gt;pes_type
op_le
l_int|2
op_logical_or
id|dvbdmxfeed-&gt;pes_type
op_eq
l_int|4
)paren
id|ChangePIDs
c_func
(paren
id|av7110
comma
id|npids
(braket
l_int|1
)braket
comma
id|npids
(braket
l_int|0
)braket
comma
id|npids
(braket
l_int|2
)braket
comma
id|npids
(braket
l_int|3
)braket
comma
id|npids
(braket
l_int|4
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dvbdmxfeed-&gt;pes_type
OL
l_int|2
op_logical_and
id|npids
(braket
l_int|0
)braket
)paren
r_if
c_cond
(paren
id|av7110-&gt;fe_synced
)paren
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_PIDFILTER
comma
id|Scan
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|dvbdmxfeed-&gt;ts_type
op_amp
id|TS_PACKET
)paren
)paren
(brace
r_if
c_cond
(paren
id|dvbdmxfeed-&gt;pes_type
op_eq
l_int|0
op_logical_and
op_logical_neg
(paren
id|dvbdmx-&gt;pids
(braket
l_int|0
)braket
op_amp
l_int|0x8000
)paren
)paren
id|AV_StartRecord
c_func
(paren
id|av7110
comma
id|RP_AUDIO
comma
id|dvbdmxfeed
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dvbdmxfeed-&gt;pes_type
op_eq
l_int|1
op_logical_and
op_logical_neg
(paren
id|dvbdmx-&gt;pids
(braket
l_int|1
)braket
op_amp
l_int|0x8000
)paren
)paren
id|AV_StartRecord
c_func
(paren
id|av7110
comma
id|RP_VIDEO
comma
id|dvbdmxfeed
)paren
suffix:semicolon
)brace
)brace
DECL|function|dvb_feed_stop_pid
r_static
r_void
id|dvb_feed_stop_pid
c_func
(paren
r_struct
id|dvb_demux_feed
op_star
id|dvbdmxfeed
)paren
(brace
r_struct
id|dvb_demux
op_star
id|dvbdmx
op_assign
id|dvbdmxfeed-&gt;demux
suffix:semicolon
r_struct
id|av7110
op_star
id|av7110
op_assign
(paren
r_struct
id|av7110
op_star
)paren
id|dvbdmx-&gt;priv
suffix:semicolon
id|u16
op_star
id|pid
op_assign
id|dvbdmx-&gt;pids
comma
id|npids
(braket
l_int|5
)braket
suffix:semicolon
r_int
id|i
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dvbdmxfeed-&gt;pes_type
op_le
l_int|1
)paren
(brace
id|AV_Stop
c_func
(paren
id|av7110
comma
id|dvbdmxfeed-&gt;pes_type
ques
c_cond
id|RP_VIDEO
suffix:colon
id|RP_AUDIO
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|av7110-&gt;rec_mode
)paren
id|dvbdmx-&gt;recording
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|av7110-&gt;playing
)paren
id|dvbdmx-&gt;playing
op_assign
l_int|0
suffix:semicolon
)brace
id|npids
(braket
l_int|0
)braket
op_assign
id|npids
(braket
l_int|1
)braket
op_assign
id|npids
(braket
l_int|2
)braket
op_assign
id|npids
(braket
l_int|3
)braket
op_assign
l_int|0xffff
suffix:semicolon
id|npids
(braket
l_int|4
)braket
op_assign
l_int|0xffff
suffix:semicolon
id|i
op_assign
id|dvbdmxfeed-&gt;pes_type
suffix:semicolon
r_switch
c_cond
(paren
id|i
)paren
(brace
r_case
l_int|2
suffix:colon
singleline_comment|//teletext
r_if
c_cond
(paren
id|dvbdmxfeed-&gt;ts_type
op_amp
id|TS_PACKET
)paren
id|StopHWFilter
c_func
(paren
id|dvbdmxfeed-&gt;filter
)paren
suffix:semicolon
id|npids
(braket
l_int|2
)braket
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0
suffix:colon
r_case
l_int|1
suffix:colon
r_case
l_int|4
suffix:colon
r_if
c_cond
(paren
op_logical_neg
id|pids_off
)paren
r_return
suffix:semicolon
id|npids
(braket
id|i
)braket
op_assign
(paren
id|pid
(braket
id|i
)braket
op_amp
l_int|0x8000
)paren
ques
c_cond
l_int|0
suffix:colon
id|pid
(braket
id|i
)braket
suffix:semicolon
r_break
suffix:semicolon
)brace
id|ChangePIDs
c_func
(paren
id|av7110
comma
id|npids
(braket
l_int|1
)braket
comma
id|npids
(braket
l_int|0
)braket
comma
id|npids
(braket
l_int|2
)braket
comma
id|npids
(braket
l_int|3
)braket
comma
id|npids
(braket
l_int|4
)braket
)paren
suffix:semicolon
)brace
DECL|function|av7110_start_feed
r_static
r_int
id|av7110_start_feed
c_func
(paren
r_struct
id|dvb_demux_feed
op_star
id|feed
)paren
(brace
r_struct
id|dvb_demux
op_star
id|demux
op_assign
id|feed-&gt;demux
suffix:semicolon
r_struct
id|av7110
op_star
id|av7110
op_assign
(paren
r_struct
id|av7110
op_star
)paren
id|demux-&gt;priv
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|demux-&gt;dmx.frontend
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|feed-&gt;pid
OG
l_int|0x1fff
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|feed-&gt;type
op_eq
id|DMX_TYPE_TS
)paren
(brace
r_if
c_cond
(paren
(paren
id|feed-&gt;ts_type
op_amp
id|TS_DECODER
)paren
op_logical_and
(paren
id|feed-&gt;pes_type
OL
id|DMX_TS_PES_OTHER
)paren
)paren
(brace
r_switch
c_cond
(paren
id|demux-&gt;dmx.frontend-&gt;source
)paren
(brace
r_case
id|DMX_MEMORY_FE
suffix:colon
r_if
c_cond
(paren
id|feed-&gt;ts_type
op_amp
id|TS_DECODER
)paren
r_if
c_cond
(paren
id|feed-&gt;pes_type
OL
l_int|2
op_logical_and
op_logical_neg
(paren
id|demux-&gt;pids
(braket
l_int|0
)braket
op_amp
l_int|0x8000
)paren
op_logical_and
op_logical_neg
(paren
id|demux-&gt;pids
(braket
l_int|1
)braket
op_amp
l_int|0x8000
)paren
)paren
(brace
id|dvb_ringbuffer_flush_spinlock_wakeup
c_func
(paren
op_amp
id|av7110-&gt;avout
)paren
suffix:semicolon
id|dvb_ringbuffer_flush_spinlock_wakeup
c_func
(paren
op_amp
id|av7110-&gt;aout
)paren
suffix:semicolon
id|AV_StartPlay
c_func
(paren
id|av7110
comma
id|RP_AV
)paren
suffix:semicolon
id|demux-&gt;playing
op_assign
l_int|1
suffix:semicolon
)brace
r_break
suffix:semicolon
r_default
suffix:colon
id|dvb_feed_start_pid
c_func
(paren
id|feed
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
(paren
id|feed-&gt;ts_type
op_amp
id|TS_PACKET
)paren
op_logical_and
(paren
id|demux-&gt;dmx.frontend-&gt;source
op_ne
id|DMX_MEMORY_FE
)paren
)paren
id|StartHWFilter
c_func
(paren
id|feed-&gt;filter
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|feed-&gt;type
op_eq
id|DMX_TYPE_SEC
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|demux-&gt;filternum
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|demux-&gt;filter
(braket
id|i
)braket
dot
id|state
op_ne
id|DMX_STATE_READY
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|demux-&gt;filter
(braket
id|i
)braket
dot
id|type
op_ne
id|DMX_TYPE_SEC
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|demux-&gt;filter
(braket
id|i
)braket
dot
id|filter.parent
op_ne
op_amp
id|feed-&gt;feed.sec
)paren
r_continue
suffix:semicolon
id|demux-&gt;filter
(braket
id|i
)braket
dot
id|state
op_assign
id|DMX_STATE_GO
suffix:semicolon
r_if
c_cond
(paren
id|demux-&gt;dmx.frontend-&gt;source
op_ne
id|DMX_MEMORY_FE
)paren
id|StartHWFilter
c_func
(paren
op_amp
id|demux-&gt;filter
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|av7110_stop_feed
r_static
r_int
id|av7110_stop_feed
c_func
(paren
r_struct
id|dvb_demux_feed
op_star
id|feed
)paren
(brace
r_struct
id|dvb_demux
op_star
id|demux
op_assign
id|feed-&gt;demux
suffix:semicolon
r_struct
id|av7110
op_star
id|av7110
op_assign
(paren
r_struct
id|av7110
op_star
)paren
id|demux-&gt;priv
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|feed-&gt;type
op_eq
id|DMX_TYPE_TS
)paren
(brace
r_if
c_cond
(paren
id|feed-&gt;ts_type
op_amp
id|TS_DECODER
)paren
(brace
r_if
c_cond
(paren
id|feed-&gt;pes_type
op_ge
id|DMX_TS_PES_OTHER
op_logical_or
op_logical_neg
id|demux-&gt;pesfilter
(braket
id|feed-&gt;pes_type
)braket
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|demux-&gt;pids
(braket
id|feed-&gt;pes_type
)braket
op_or_assign
l_int|0x8000
suffix:semicolon
id|demux-&gt;pesfilter
(braket
id|feed-&gt;pes_type
)braket
op_assign
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|feed-&gt;ts_type
op_amp
id|TS_DECODER
op_logical_and
id|feed-&gt;pes_type
OL
id|DMX_TS_PES_OTHER
)paren
(brace
id|dvb_feed_stop_pid
c_func
(paren
id|feed
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
(paren
id|feed-&gt;ts_type
op_amp
id|TS_PACKET
)paren
op_logical_and
(paren
id|demux-&gt;dmx.frontend-&gt;source
op_ne
id|DMX_MEMORY_FE
)paren
)paren
id|StopHWFilter
c_func
(paren
id|feed-&gt;filter
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|feed-&gt;type
op_eq
id|DMX_TYPE_SEC
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|demux-&gt;filternum
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|demux-&gt;filter
(braket
id|i
)braket
dot
id|state
op_eq
id|DMX_STATE_GO
op_logical_and
id|demux-&gt;filter
(braket
id|i
)braket
dot
id|filter.parent
op_eq
op_amp
id|feed-&gt;feed.sec
)paren
(brace
id|demux-&gt;filter
(braket
id|i
)braket
dot
id|state
op_assign
id|DMX_STATE_READY
suffix:semicolon
r_if
c_cond
(paren
id|demux-&gt;dmx.frontend-&gt;source
op_ne
id|DMX_MEMORY_FE
)paren
id|StopHWFilter
c_func
(paren
op_amp
id|demux-&gt;filter
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|restart_feeds
r_static
r_void
id|restart_feeds
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
)paren
(brace
r_struct
id|dvb_demux
op_star
id|dvbdmx
op_assign
op_amp
id|av7110-&gt;demux
suffix:semicolon
r_struct
id|dvb_demux_feed
op_star
id|feed
suffix:semicolon
r_int
id|mode
suffix:semicolon
r_int
id|i
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
id|mode
op_assign
id|av7110-&gt;playing
suffix:semicolon
id|av7110-&gt;playing
op_assign
l_int|0
suffix:semicolon
id|av7110-&gt;rec_mode
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|dvbdmx-&gt;filternum
suffix:semicolon
id|i
op_increment
)paren
(brace
id|feed
op_assign
op_amp
id|dvbdmx-&gt;feed
(braket
id|i
)braket
suffix:semicolon
r_if
c_cond
(paren
id|feed-&gt;state
op_eq
id|DMX_STATE_GO
)paren
id|av7110_start_feed
c_func
(paren
id|feed
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|mode
)paren
id|AV_StartPlay
c_func
(paren
id|av7110
comma
id|mode
)paren
suffix:semicolon
)brace
DECL|function|dvb_get_stc
r_static
r_int
id|dvb_get_stc
c_func
(paren
r_struct
id|dmx_demux
op_star
id|demux
comma
r_int
r_int
id|num
comma
r_uint64
op_star
id|stc
comma
r_int
r_int
op_star
id|base
)paren
(brace
r_int
id|ret
suffix:semicolon
id|u16
id|fwstc
(braket
l_int|4
)braket
suffix:semicolon
id|u16
id|tag
op_assign
(paren
(paren
id|COMTYPE_REQUEST
op_lshift
l_int|8
)paren
op_plus
id|ReqSTC
)paren
suffix:semicolon
r_struct
id|dvb_demux
op_star
id|dvbdemux
suffix:semicolon
r_struct
id|av7110
op_star
id|av7110
suffix:semicolon
multiline_comment|/* pointer casting paranoia... */
r_if
c_cond
(paren
op_logical_neg
id|demux
)paren
id|BUG
c_func
(paren
)paren
suffix:semicolon
id|dvbdemux
op_assign
(paren
r_struct
id|dvb_demux
op_star
)paren
id|demux-&gt;priv
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dvbdemux
)paren
id|BUG
c_func
(paren
)paren
suffix:semicolon
id|av7110
op_assign
(paren
r_struct
id|av7110
op_star
)paren
id|dvbdemux-&gt;priv
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|num
op_ne
l_int|0
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|ret
op_assign
id|CommandRequest
c_func
(paren
id|av7110
comma
op_amp
id|tag
comma
l_int|0
comma
id|fwstc
comma
l_int|4
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;%s: CommandRequest error&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_return
op_minus
id|EIO
suffix:semicolon
)brace
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: fwstc = %04hx %04hx %04hx %04hx&bslash;n&quot;
comma
id|fwstc
(braket
l_int|0
)braket
comma
id|fwstc
(braket
l_int|1
)braket
comma
id|fwstc
(braket
l_int|2
)braket
comma
id|fwstc
(braket
l_int|3
)braket
)paren
)paren
suffix:semicolon
op_star
id|stc
op_assign
(paren
(paren
(paren
r_uint64
)paren
(paren
(paren
id|fwstc
(braket
l_int|3
)braket
op_amp
l_int|0x8000
)paren
op_rshift
l_int|15
)paren
)paren
op_lshift
l_int|32
)paren
op_or
(paren
(paren
(paren
r_uint64
)paren
id|fwstc
(braket
l_int|1
)braket
)paren
op_lshift
l_int|16
)paren
op_or
(paren
(paren
r_uint64
)paren
id|fwstc
(braket
l_int|0
)braket
)paren
suffix:semicolon
op_star
id|base
op_assign
l_int|1
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: stc = %lu&bslash;n&quot;
comma
(paren
r_int
r_int
)paren
op_star
id|stc
)paren
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/******************************************************************************&n; * SEC device file operations&n; ******************************************************************************/
DECL|function|av7110_diseqc_ioctl
r_static
r_int
id|av7110_diseqc_ioctl
(paren
r_struct
id|dvb_frontend
op_star
id|fe
comma
r_int
r_int
id|cmd
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|av7110
op_star
id|av7110
op_assign
id|fe-&gt;before_after_data
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|FE_SET_TONE
suffix:colon
r_switch
c_cond
(paren
(paren
id|fe_sec_tone_mode_t
)paren
id|arg
)paren
(brace
r_case
id|SEC_TONE_ON
suffix:colon
id|Set22K
(paren
id|av7110
comma
l_int|1
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SEC_TONE_OFF
suffix:colon
id|Set22K
(paren
id|av7110
comma
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FE_DISEQC_SEND_MASTER_CMD
suffix:colon
(brace
r_struct
id|dvb_diseqc_master_cmd
op_star
id|cmd
op_assign
id|arg
suffix:semicolon
id|SendDiSEqCMsg
(paren
id|av7110
comma
id|cmd-&gt;msg_len
comma
id|cmd-&gt;msg
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|FE_DISEQC_SEND_BURST
suffix:colon
id|SendDiSEqCMsg
(paren
id|av7110
comma
l_int|0
comma
l_int|NULL
comma
(paren
r_int
r_int
)paren
id|arg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
id|EOPNOTSUPP
suffix:semicolon
)brace
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/******************************************************************************&n; * CI link layer file ops (FIXME: move this to separate module later)&n; ******************************************************************************/
DECL|function|ci_ll_init
r_int
id|ci_ll_init
c_func
(paren
r_struct
id|dvb_ringbuffer
op_star
id|cirbuf
comma
r_struct
id|dvb_ringbuffer
op_star
id|ciwbuf
comma
r_int
id|size
)paren
(brace
id|dvb_ringbuffer_init
c_func
(paren
id|cirbuf
comma
id|vmalloc
c_func
(paren
id|size
)paren
comma
id|size
)paren
suffix:semicolon
id|dvb_ringbuffer_init
c_func
(paren
id|ciwbuf
comma
id|vmalloc
c_func
(paren
id|size
)paren
comma
id|size
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|ci_ll_flush
r_void
id|ci_ll_flush
c_func
(paren
r_struct
id|dvb_ringbuffer
op_star
id|cirbuf
comma
r_struct
id|dvb_ringbuffer
op_star
id|ciwbuf
)paren
(brace
id|dvb_ringbuffer_flush_spinlock_wakeup
c_func
(paren
id|cirbuf
)paren
suffix:semicolon
id|dvb_ringbuffer_flush_spinlock_wakeup
c_func
(paren
id|ciwbuf
)paren
suffix:semicolon
)brace
DECL|function|ci_ll_release
r_void
id|ci_ll_release
c_func
(paren
r_struct
id|dvb_ringbuffer
op_star
id|cirbuf
comma
r_struct
id|dvb_ringbuffer
op_star
id|ciwbuf
)paren
(brace
id|vfree
c_func
(paren
id|cirbuf-&gt;data
)paren
suffix:semicolon
id|cirbuf-&gt;data
op_assign
l_int|0
suffix:semicolon
id|vfree
c_func
(paren
id|ciwbuf-&gt;data
)paren
suffix:semicolon
id|ciwbuf-&gt;data
op_assign
l_int|0
suffix:semicolon
)brace
DECL|function|ci_ll_reset
r_int
id|ci_ll_reset
c_func
(paren
r_struct
id|dvb_ringbuffer
op_star
id|cibuf
comma
r_struct
id|file
op_star
id|file
comma
r_int
id|slots
comma
id|ca_slot_info_t
op_star
id|slot
)paren
(brace
r_int
id|i
suffix:semicolon
r_int
id|len
op_assign
l_int|0
suffix:semicolon
id|u8
id|msg
(braket
l_int|8
)braket
op_assign
initialization_block
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|2
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|slots
op_amp
(paren
l_int|1
op_lshift
id|i
)paren
)paren
id|len
op_add_assign
l_int|8
suffix:semicolon
)brace
r_if
c_cond
(paren
id|dvb_ringbuffer_free
c_func
(paren
id|cibuf
)paren
OL
id|len
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|2
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|slots
op_amp
(paren
l_int|1
op_lshift
id|i
)paren
)paren
(brace
id|msg
(braket
l_int|2
)braket
op_assign
id|i
suffix:semicolon
id|dvb_ringbuffer_write
c_func
(paren
id|cibuf
comma
id|msg
comma
l_int|8
comma
l_int|0
)paren
suffix:semicolon
id|slot
(braket
id|i
)braket
dot
id|flags
op_assign
l_int|0
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|ci_ll_write
r_static
id|ssize_t
id|ci_ll_write
c_func
(paren
r_struct
id|dvb_ringbuffer
op_star
id|cibuf
comma
r_struct
id|file
op_star
id|file
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
comma
id|loff_t
op_star
id|ppos
)paren
(brace
r_int
id|free
suffix:semicolon
r_int
id|non_blocking
op_assign
id|file-&gt;f_flags
op_amp
id|O_NONBLOCK
suffix:semicolon
r_if
c_cond
(paren
id|count
OG
l_int|2048
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|free
op_assign
id|dvb_ringbuffer_free
c_func
(paren
id|cibuf
)paren
suffix:semicolon
r_if
c_cond
(paren
id|count
op_plus
l_int|2
OG
id|free
)paren
(brace
r_if
c_cond
(paren
id|non_blocking
)paren
r_return
op_minus
id|EWOULDBLOCK
suffix:semicolon
r_if
c_cond
(paren
id|wait_event_interruptible
c_func
(paren
id|cibuf-&gt;queue
comma
(paren
id|dvb_ringbuffer_free
c_func
(paren
id|cibuf
)paren
op_ge
id|count
op_plus
l_int|2
)paren
)paren
)paren
r_return
l_int|0
suffix:semicolon
)brace
id|DVB_RINGBUFFER_WRITE_BYTE
c_func
(paren
id|cibuf
comma
id|count
op_rshift
l_int|8
)paren
suffix:semicolon
id|DVB_RINGBUFFER_WRITE_BYTE
c_func
(paren
id|cibuf
comma
id|count
op_amp
l_int|0xff
)paren
suffix:semicolon
r_return
id|dvb_ringbuffer_write
c_func
(paren
id|cibuf
comma
id|buf
comma
id|count
comma
l_int|1
)paren
suffix:semicolon
)brace
DECL|function|ci_ll_read
r_static
id|ssize_t
id|ci_ll_read
c_func
(paren
r_struct
id|dvb_ringbuffer
op_star
id|cibuf
comma
r_struct
id|file
op_star
id|file
comma
r_char
op_star
id|buf
comma
r_int
id|count
comma
id|loff_t
op_star
id|ppos
)paren
(brace
r_int
id|avail
suffix:semicolon
r_int
id|non_blocking
op_assign
id|file-&gt;f_flags
op_amp
id|O_NONBLOCK
suffix:semicolon
id|ssize_t
id|len
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|cibuf-&gt;data
op_logical_or
op_logical_neg
id|count
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|non_blocking
op_logical_and
(paren
id|dvb_ringbuffer_empty
c_func
(paren
id|cibuf
)paren
)paren
)paren
r_return
op_minus
id|EWOULDBLOCK
suffix:semicolon
r_if
c_cond
(paren
id|wait_event_interruptible
c_func
(paren
id|cibuf-&gt;queue
comma
op_logical_neg
id|dvb_ringbuffer_empty
c_func
(paren
id|cibuf
)paren
)paren
)paren
r_return
l_int|0
suffix:semicolon
id|avail
op_assign
id|dvb_ringbuffer_avail
c_func
(paren
id|cibuf
)paren
suffix:semicolon
r_if
c_cond
(paren
id|avail
OL
l_int|4
)paren
r_return
l_int|0
suffix:semicolon
id|len
op_assign
id|DVB_RINGBUFFER_PEEK
c_func
(paren
id|cibuf
comma
l_int|0
)paren
op_lshift
l_int|8
suffix:semicolon
id|len
op_or_assign
id|DVB_RINGBUFFER_PEEK
c_func
(paren
id|cibuf
comma
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|avail
OL
id|len
op_plus
l_int|2
op_logical_or
id|count
OL
id|len
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|DVB_RINGBUFFER_SKIP
c_func
(paren
id|cibuf
comma
l_int|2
)paren
suffix:semicolon
r_return
id|dvb_ringbuffer_read
c_func
(paren
id|cibuf
comma
id|buf
comma
id|len
comma
l_int|1
)paren
suffix:semicolon
)brace
DECL|function|dvb_ca_open
r_static
r_int
id|dvb_ca_open
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_struct
id|dvb_device
op_star
id|dvbdev
op_assign
(paren
r_struct
id|dvb_device
op_star
)paren
id|file-&gt;private_data
suffix:semicolon
r_struct
id|av7110
op_star
id|av7110
op_assign
(paren
r_struct
id|av7110
op_star
)paren
id|dvbdev-&gt;priv
suffix:semicolon
r_int
id|err
op_assign
id|dvb_generic_open
c_func
(paren
id|inode
comma
id|file
)paren
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|ci_ll_flush
c_func
(paren
op_amp
id|av7110-&gt;ci_rbuffer
comma
op_amp
id|av7110-&gt;ci_wbuffer
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dvb_ca_poll
r_static
r_int
r_int
id|dvb_ca_poll
(paren
r_struct
id|file
op_star
id|file
comma
id|poll_table
op_star
id|wait
)paren
(brace
r_struct
id|dvb_device
op_star
id|dvbdev
op_assign
(paren
r_struct
id|dvb_device
op_star
)paren
id|file-&gt;private_data
suffix:semicolon
r_struct
id|av7110
op_star
id|av7110
op_assign
(paren
r_struct
id|av7110
op_star
)paren
id|dvbdev-&gt;priv
suffix:semicolon
r_struct
id|dvb_ringbuffer
op_star
id|rbuf
op_assign
op_amp
id|av7110-&gt;ci_rbuffer
suffix:semicolon
r_struct
id|dvb_ringbuffer
op_star
id|wbuf
op_assign
op_amp
id|av7110-&gt;ci_wbuffer
suffix:semicolon
r_int
r_int
id|mask
op_assign
l_int|0
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
id|poll_wait
(paren
id|file
comma
op_amp
id|rbuf-&gt;queue
comma
id|wait
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dvb_ringbuffer_empty
c_func
(paren
id|rbuf
)paren
)paren
id|mask
op_or_assign
id|POLLIN
suffix:semicolon
r_if
c_cond
(paren
id|dvb_ringbuffer_avail
c_func
(paren
id|wbuf
)paren
OG
l_int|1024
)paren
id|mask
op_or_assign
id|POLLOUT
suffix:semicolon
r_return
id|mask
suffix:semicolon
)brace
DECL|function|dvb_ca_ioctl
r_static
r_int
id|dvb_ca_ioctl
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
comma
r_int
r_int
id|cmd
comma
r_void
op_star
id|parg
)paren
(brace
r_struct
id|dvb_device
op_star
id|dvbdev
op_assign
(paren
r_struct
id|dvb_device
op_star
)paren
id|file-&gt;private_data
suffix:semicolon
r_struct
id|av7110
op_star
id|av7110
op_assign
(paren
r_struct
id|av7110
op_star
)paren
id|dvbdev-&gt;priv
suffix:semicolon
r_int
r_int
id|arg
op_assign
(paren
r_int
r_int
)paren
id|parg
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|CA_RESET
suffix:colon
macro_line|#ifdef NEW_CI
r_return
id|ci_ll_reset
c_func
(paren
op_amp
id|av7110-&gt;ci_wbuffer
comma
id|file
comma
id|arg
comma
op_amp
id|av7110-&gt;ci_slot
(braket
l_int|0
)braket
)paren
suffix:semicolon
macro_line|#endif                        
r_break
suffix:semicolon
r_case
id|CA_GET_CAP
suffix:colon
(brace
id|ca_caps_t
id|cap
suffix:semicolon
id|cap.slot_num
op_assign
l_int|2
suffix:semicolon
macro_line|#ifdef NEW_CI
id|cap.slot_type
op_assign
(paren
id|FW_CI_LL_SUPPORT
c_func
(paren
id|av7110-&gt;arm_app
)paren
ques
c_cond
id|CA_CI_LINK
suffix:colon
id|CA_CI
)paren
op_or
id|CA_DESCR
suffix:semicolon
macro_line|#else
id|cap.slot_type
op_assign
id|CA_CI
op_or
id|CA_DESCR
suffix:semicolon
macro_line|#endif
id|cap.descr_num
op_assign
l_int|16
suffix:semicolon
id|cap.descr_type
op_assign
id|CA_ECD
suffix:semicolon
id|memcpy
c_func
(paren
id|parg
comma
op_amp
id|cap
comma
r_sizeof
(paren
id|cap
)paren
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|CA_GET_SLOT_INFO
suffix:colon
(brace
id|ca_slot_info_t
op_star
id|info
op_assign
(paren
id|ca_slot_info_t
op_star
)paren
id|parg
suffix:semicolon
r_if
c_cond
(paren
id|info-&gt;num
OG
l_int|1
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|av7110-&gt;ci_slot
(braket
id|info-&gt;num
)braket
dot
id|num
op_assign
id|info-&gt;num
suffix:semicolon
macro_line|#ifdef NEW_CI
id|av7110-&gt;ci_slot
(braket
id|info-&gt;num
)braket
dot
id|type
op_assign
id|FW_CI_LL_SUPPORT
c_func
(paren
id|av7110-&gt;arm_app
)paren
ques
c_cond
id|CA_CI_LINK
suffix:colon
id|CA_CI
suffix:semicolon
macro_line|#else
id|av7110-&gt;ci_slot
(braket
id|info-&gt;num
)braket
dot
id|type
op_assign
id|CA_CI
suffix:semicolon
macro_line|#endif
id|memcpy
c_func
(paren
id|info
comma
op_amp
id|av7110-&gt;ci_slot
(braket
id|info-&gt;num
)braket
comma
r_sizeof
(paren
id|ca_slot_info_t
)paren
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|CA_GET_MSG
suffix:colon
r_break
suffix:semicolon
r_case
id|CA_SEND_MSG
suffix:colon
r_break
suffix:semicolon
r_case
id|CA_GET_DESCR_INFO
suffix:colon
(brace
id|ca_descr_info_t
id|info
suffix:semicolon
id|info.num
op_assign
l_int|16
suffix:semicolon
id|info.type
op_assign
id|CA_ECD
suffix:semicolon
id|memcpy
(paren
id|parg
comma
op_amp
id|info
comma
r_sizeof
(paren
id|info
)paren
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|CA_SET_DESCR
suffix:colon
(brace
id|ca_descr_t
op_star
id|descr
op_assign
(paren
id|ca_descr_t
op_star
)paren
id|parg
suffix:semicolon
r_if
c_cond
(paren
id|descr-&gt;index
op_ge
l_int|16
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|descr-&gt;parity
OG
l_int|1
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_PIDFILTER
comma
id|SetDescr
comma
l_int|5
comma
(paren
id|descr-&gt;index
op_lshift
l_int|8
)paren
op_or
id|descr-&gt;parity
comma
(paren
id|descr-&gt;cw
(braket
l_int|0
)braket
op_lshift
l_int|8
)paren
op_or
id|descr-&gt;cw
(braket
l_int|1
)braket
comma
(paren
id|descr-&gt;cw
(braket
l_int|2
)braket
op_lshift
l_int|8
)paren
op_or
id|descr-&gt;cw
(braket
l_int|3
)braket
comma
(paren
id|descr-&gt;cw
(braket
l_int|4
)braket
op_lshift
l_int|8
)paren
op_or
id|descr-&gt;cw
(braket
l_int|5
)braket
comma
(paren
id|descr-&gt;cw
(braket
l_int|6
)braket
op_lshift
l_int|8
)paren
op_or
id|descr-&gt;cw
(braket
l_int|7
)braket
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dvb_ca_write
r_static
id|ssize_t
id|dvb_ca_write
c_func
(paren
r_struct
id|file
op_star
id|file
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
comma
id|loff_t
op_star
id|ppos
)paren
(brace
r_struct
id|dvb_device
op_star
id|dvbdev
op_assign
(paren
r_struct
id|dvb_device
op_star
)paren
id|file-&gt;private_data
suffix:semicolon
r_struct
id|av7110
op_star
id|av7110
op_assign
(paren
r_struct
id|av7110
op_star
)paren
id|dvbdev-&gt;priv
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_return
id|ci_ll_write
c_func
(paren
op_amp
id|av7110-&gt;ci_wbuffer
comma
id|file
comma
id|buf
comma
id|count
comma
id|ppos
)paren
suffix:semicolon
)brace
DECL|function|dvb_ca_read
r_static
id|ssize_t
id|dvb_ca_read
c_func
(paren
r_struct
id|file
op_star
id|file
comma
r_char
op_star
id|buf
comma
r_int
id|count
comma
id|loff_t
op_star
id|ppos
)paren
(brace
r_struct
id|dvb_device
op_star
id|dvbdev
op_assign
(paren
r_struct
id|dvb_device
op_star
)paren
id|file-&gt;private_data
suffix:semicolon
r_struct
id|av7110
op_star
id|av7110
op_assign
(paren
r_struct
id|av7110
op_star
)paren
id|dvbdev-&gt;priv
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_return
id|ci_ll_read
c_func
(paren
op_amp
id|av7110-&gt;ci_rbuffer
comma
id|file
comma
id|buf
comma
id|count
comma
id|ppos
)paren
suffix:semicolon
)brace
multiline_comment|/******************************************************************************&n; * Video MPEG decoder events&n; ******************************************************************************/
DECL|function|dvb_video_add_event
r_static
r_void
id|dvb_video_add_event
(paren
r_struct
id|av7110
op_star
id|av7110
comma
r_struct
id|video_event
op_star
id|event
)paren
(brace
r_struct
id|dvb_video_events
op_star
id|events
op_assign
op_amp
id|av7110-&gt;video_events
suffix:semicolon
r_int
id|wp
suffix:semicolon
id|DEB_D
c_func
(paren
(paren
l_string|&quot;&bslash;n&quot;
)paren
)paren
suffix:semicolon
id|spin_lock_bh
c_func
(paren
op_amp
id|events-&gt;lock
)paren
suffix:semicolon
id|wp
op_assign
(paren
id|events-&gt;eventw
op_plus
l_int|1
)paren
op_mod
id|MAX_VIDEO_EVENT
suffix:semicolon
r_if
c_cond
(paren
id|wp
op_eq
id|events-&gt;eventr
)paren
(brace
id|events-&gt;overflow
op_assign
l_int|1
suffix:semicolon
id|events-&gt;eventr
op_assign
(paren
id|events-&gt;eventr
op_plus
l_int|1
)paren
op_mod
id|MAX_VIDEO_EVENT
suffix:semicolon
)brace
singleline_comment|//FIXME: timestamp?
id|memcpy
c_func
(paren
op_amp
id|events-&gt;events
(braket
id|events-&gt;eventw
)braket
comma
id|event
comma
r_sizeof
(paren
r_struct
id|video_event
)paren
)paren
suffix:semicolon
id|events-&gt;eventw
op_assign
id|wp
suffix:semicolon
id|spin_unlock_bh
c_func
(paren
op_amp
id|events-&gt;lock
)paren
suffix:semicolon
id|wake_up_interruptible
(paren
op_amp
id|events-&gt;wait_queue
)paren
suffix:semicolon
)brace
DECL|function|dvb_video_get_event
r_static
r_int
id|dvb_video_get_event
(paren
r_struct
id|av7110
op_star
id|av7110
comma
r_struct
id|video_event
op_star
id|event
comma
r_int
id|flags
)paren
(brace
r_struct
id|dvb_video_events
op_star
id|events
op_assign
op_amp
id|av7110-&gt;video_events
suffix:semicolon
id|DEB_D
c_func
(paren
(paren
l_string|&quot;&bslash;n&quot;
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|events-&gt;overflow
)paren
(brace
id|events-&gt;overflow
op_assign
l_int|0
suffix:semicolon
r_return
op_minus
id|EOVERFLOW
suffix:semicolon
)brace
r_if
c_cond
(paren
id|events-&gt;eventw
op_eq
id|events-&gt;eventr
)paren
(brace
r_int
id|ret
suffix:semicolon
r_if
c_cond
(paren
id|flags
op_amp
id|O_NONBLOCK
)paren
r_return
op_minus
id|EWOULDBLOCK
suffix:semicolon
id|ret
op_assign
id|wait_event_interruptible
(paren
id|events-&gt;wait_queue
comma
id|events-&gt;eventw
op_ne
id|events-&gt;eventr
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
OL
l_int|0
)paren
r_return
id|ret
suffix:semicolon
)brace
id|spin_lock_bh
c_func
(paren
op_amp
id|events-&gt;lock
)paren
suffix:semicolon
id|memcpy
(paren
id|event
comma
op_amp
id|events-&gt;events
(braket
id|events-&gt;eventr
)braket
comma
r_sizeof
(paren
r_struct
id|video_event
)paren
)paren
suffix:semicolon
id|events-&gt;eventr
op_assign
(paren
id|events-&gt;eventr
op_plus
l_int|1
)paren
op_mod
id|MAX_VIDEO_EVENT
suffix:semicolon
id|spin_unlock_bh
c_func
(paren
op_amp
id|events-&gt;lock
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/******************************************************************************&n; * DVB device file operations&n; ******************************************************************************/
DECL|function|dvb_video_poll
r_static
r_int
r_int
id|dvb_video_poll
c_func
(paren
r_struct
id|file
op_star
id|file
comma
id|poll_table
op_star
id|wait
)paren
(brace
r_struct
id|dvb_device
op_star
id|dvbdev
op_assign
(paren
r_struct
id|dvb_device
op_star
)paren
id|file-&gt;private_data
suffix:semicolon
r_struct
id|av7110
op_star
id|av7110
op_assign
(paren
r_struct
id|av7110
op_star
)paren
id|dvbdev-&gt;priv
suffix:semicolon
r_int
r_int
id|mask
op_assign
l_int|0
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|file-&gt;f_flags
op_amp
id|O_ACCMODE
)paren
op_ne
id|O_RDONLY
)paren
(brace
id|poll_wait
c_func
(paren
id|file
comma
op_amp
id|av7110-&gt;avout.queue
comma
id|wait
)paren
suffix:semicolon
)brace
id|poll_wait
c_func
(paren
id|file
comma
op_amp
id|av7110-&gt;video_events.wait_queue
comma
id|wait
)paren
suffix:semicolon
r_if
c_cond
(paren
id|av7110-&gt;video_events.eventw
op_ne
id|av7110-&gt;video_events.eventr
)paren
id|mask
op_assign
id|POLLPRI
suffix:semicolon
r_if
c_cond
(paren
(paren
id|file-&gt;f_flags
op_amp
id|O_ACCMODE
)paren
op_ne
id|O_RDONLY
)paren
(brace
r_if
c_cond
(paren
id|av7110-&gt;playing
)paren
(brace
r_if
c_cond
(paren
id|FREE_COND
)paren
id|mask
op_or_assign
(paren
id|POLLOUT
op_or
id|POLLWRNORM
)paren
suffix:semicolon
)brace
r_else
multiline_comment|/* if not playing: may play if asked for */
id|mask
op_or_assign
(paren
id|POLLOUT
op_or
id|POLLWRNORM
)paren
suffix:semicolon
)brace
r_return
id|mask
suffix:semicolon
)brace
DECL|function|dvb_video_write
r_static
id|ssize_t
id|dvb_video_write
c_func
(paren
r_struct
id|file
op_star
id|file
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
comma
id|loff_t
op_star
id|ppos
)paren
(brace
r_struct
id|dvb_device
op_star
id|dvbdev
op_assign
(paren
r_struct
id|dvb_device
op_star
)paren
id|file-&gt;private_data
suffix:semicolon
r_struct
id|av7110
op_star
id|av7110
op_assign
(paren
r_struct
id|av7110
op_star
)paren
id|dvbdev-&gt;priv
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|file-&gt;f_flags
op_amp
id|O_ACCMODE
)paren
op_eq
id|O_RDONLY
)paren
(brace
r_return
op_minus
id|EPERM
suffix:semicolon
)brace
r_if
c_cond
(paren
id|av7110-&gt;videostate.stream_source
op_ne
id|VIDEO_SOURCE_MEMORY
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
r_return
id|dvb_play
c_func
(paren
id|av7110
comma
id|buf
comma
id|count
comma
id|file-&gt;f_flags
op_amp
id|O_NONBLOCK
comma
l_int|1
comma
l_int|1
)paren
suffix:semicolon
)brace
DECL|function|dvb_audio_write
r_static
id|ssize_t
id|dvb_audio_write
c_func
(paren
r_struct
id|file
op_star
id|file
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
comma
id|loff_t
op_star
id|ppos
)paren
(brace
r_struct
id|dvb_device
op_star
id|dvbdev
op_assign
(paren
r_struct
id|dvb_device
op_star
)paren
id|file-&gt;private_data
suffix:semicolon
r_struct
id|av7110
op_star
id|av7110
op_assign
(paren
r_struct
id|av7110
op_star
)paren
id|dvbdev-&gt;priv
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|av7110-&gt;audiostate.stream_source
op_ne
id|AUDIO_SOURCE_MEMORY
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;not audio source memory&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EPERM
suffix:semicolon
)brace
r_return
id|dvb_aplay
c_func
(paren
id|av7110
comma
id|buf
comma
id|count
comma
id|file-&gt;f_flags
op_amp
id|O_NONBLOCK
comma
l_int|0
)paren
suffix:semicolon
)brace
DECL|variable|iframe_header
id|u8
id|iframe_header
(braket
)braket
op_assign
(brace
l_int|0x00
comma
l_int|0x00
comma
l_int|0x01
comma
l_int|0xe0
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x80
comma
l_int|0x00
comma
l_int|0x00
)brace
suffix:semicolon
DECL|macro|MIN_IFRAME
mdefine_line|#define MIN_IFRAME 400000
DECL|function|play_iframe
r_static
r_int
id|play_iframe
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u8
op_star
id|buf
comma
r_int
r_int
id|len
comma
r_int
id|nonblock
)paren
(brace
r_int
id|i
comma
id|n
op_assign
l_int|1
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|av7110-&gt;playing
op_amp
id|RP_VIDEO
)paren
)paren
(brace
r_if
c_cond
(paren
id|AV_StartPlay
c_func
(paren
id|av7110
comma
id|RP_VIDEO
)paren
OL
l_int|0
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
id|n
op_assign
id|MIN_IFRAME
op_div
id|len
op_plus
l_int|1
suffix:semicolon
)brace
multiline_comment|/* setting n always &gt; 1, fixes problems when playing stillframes&n;&t;   consisting of I- and P-Frames */
id|n
op_assign
id|MIN_IFRAME
op_div
id|len
op_plus
l_int|1
suffix:semicolon
multiline_comment|/* FIXME: nonblock? */
id|dvb_play
c_func
(paren
id|av7110
comma
id|iframe_header
comma
r_sizeof
(paren
id|iframe_header
)paren
comma
l_int|0
comma
l_int|1
comma
l_int|0
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|n
suffix:semicolon
id|i
op_increment
)paren
id|dvb_play
c_func
(paren
id|av7110
comma
id|buf
comma
id|len
comma
l_int|0
comma
l_int|1
comma
l_int|1
)paren
suffix:semicolon
id|av7110_ipack_flush
c_func
(paren
op_amp
id|av7110-&gt;ipack
(braket
l_int|1
)braket
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dvb_video_ioctl
r_static
r_int
id|dvb_video_ioctl
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
comma
r_int
r_int
id|cmd
comma
r_void
op_star
id|parg
)paren
(brace
r_struct
id|dvb_device
op_star
id|dvbdev
op_assign
(paren
r_struct
id|dvb_device
op_star
)paren
id|file-&gt;private_data
suffix:semicolon
r_struct
id|av7110
op_star
id|av7110
op_assign
(paren
r_struct
id|av7110
op_star
)paren
id|dvbdev-&gt;priv
suffix:semicolon
r_int
r_int
id|arg
op_assign
(paren
r_int
r_int
)paren
id|parg
suffix:semicolon
r_int
id|ret
op_assign
l_int|0
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|file-&gt;f_flags
op_amp
id|O_ACCMODE
)paren
op_eq
id|O_RDONLY
)paren
(brace
r_if
c_cond
(paren
id|cmd
op_ne
id|VIDEO_GET_STATUS
op_logical_and
id|cmd
op_ne
id|VIDEO_GET_EVENT
op_logical_and
id|cmd
op_ne
id|VIDEO_GET_SIZE
)paren
(brace
r_return
op_minus
id|EPERM
suffix:semicolon
)brace
)brace
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|VIDEO_STOP
suffix:colon
id|av7110-&gt;videostate.play_state
op_assign
id|VIDEO_STOPPED
suffix:semicolon
r_if
c_cond
(paren
id|av7110-&gt;videostate.stream_source
op_eq
id|VIDEO_SOURCE_MEMORY
)paren
id|AV_Stop
c_func
(paren
id|av7110
comma
id|RP_VIDEO
)paren
suffix:semicolon
r_else
id|vidcom
c_func
(paren
id|av7110
comma
l_int|0x000e
comma
id|av7110-&gt;videostate.video_blank
ques
c_cond
l_int|0
suffix:colon
l_int|1
)paren
suffix:semicolon
id|av7110-&gt;trickmode
op_assign
id|TRICK_NONE
suffix:semicolon
r_break
suffix:semicolon
r_case
id|VIDEO_PLAY
suffix:colon
id|av7110-&gt;trickmode
op_assign
id|TRICK_NONE
suffix:semicolon
r_if
c_cond
(paren
id|av7110-&gt;videostate.play_state
op_eq
id|VIDEO_FREEZED
)paren
(brace
id|av7110-&gt;videostate.play_state
op_assign
id|VIDEO_PLAYING
suffix:semicolon
id|vidcom
c_func
(paren
id|av7110
comma
l_int|0x000d
comma
l_int|0
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|av7110-&gt;videostate.stream_source
op_eq
id|VIDEO_SOURCE_MEMORY
)paren
(brace
r_if
c_cond
(paren
id|av7110-&gt;playing
op_eq
id|RP_AV
)paren
(brace
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_REC_PLAY
comma
id|__Stop
comma
l_int|0
)paren
suffix:semicolon
id|av7110-&gt;playing
op_and_assign
op_complement
id|RP_VIDEO
suffix:semicolon
)brace
id|AV_StartPlay
c_func
(paren
id|av7110
comma
id|RP_VIDEO
)paren
suffix:semicolon
id|vidcom
c_func
(paren
id|av7110
comma
l_int|0x000d
comma
l_int|0
)paren
suffix:semicolon
)brace
r_else
(brace
singleline_comment|//AV_Stop(av7110, RP_VIDEO);
id|vidcom
c_func
(paren
id|av7110
comma
l_int|0x000d
comma
l_int|0
)paren
suffix:semicolon
)brace
id|av7110-&gt;videostate.play_state
op_assign
id|VIDEO_PLAYING
suffix:semicolon
r_break
suffix:semicolon
r_case
id|VIDEO_FREEZE
suffix:colon
id|av7110-&gt;videostate.play_state
op_assign
id|VIDEO_FREEZED
suffix:semicolon
r_if
c_cond
(paren
id|av7110-&gt;playing
op_amp
id|RP_VIDEO
)paren
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_REC_PLAY
comma
id|__Pause
comma
l_int|0
)paren
suffix:semicolon
r_else
id|vidcom
c_func
(paren
id|av7110
comma
l_int|0x0102
comma
l_int|1
)paren
suffix:semicolon
id|av7110-&gt;trickmode
op_assign
id|TRICK_FREEZE
suffix:semicolon
r_break
suffix:semicolon
r_case
id|VIDEO_CONTINUE
suffix:colon
r_if
c_cond
(paren
id|av7110-&gt;playing
op_amp
id|RP_VIDEO
)paren
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_REC_PLAY
comma
id|__Continue
comma
l_int|0
)paren
suffix:semicolon
id|vidcom
c_func
(paren
id|av7110
comma
l_int|0x000d
comma
l_int|0
)paren
suffix:semicolon
id|av7110-&gt;videostate.play_state
op_assign
id|VIDEO_PLAYING
suffix:semicolon
id|av7110-&gt;trickmode
op_assign
id|TRICK_NONE
suffix:semicolon
r_break
suffix:semicolon
r_case
id|VIDEO_SELECT_SOURCE
suffix:colon
id|av7110-&gt;videostate.stream_source
op_assign
(paren
id|video_stream_source_t
)paren
id|arg
suffix:semicolon
r_break
suffix:semicolon
r_case
id|VIDEO_SET_BLANK
suffix:colon
id|av7110-&gt;videostate.video_blank
op_assign
(paren
r_int
)paren
id|arg
suffix:semicolon
r_break
suffix:semicolon
r_case
id|VIDEO_GET_STATUS
suffix:colon
id|memcpy
c_func
(paren
id|parg
comma
op_amp
id|av7110-&gt;videostate
comma
r_sizeof
(paren
r_struct
id|video_status
)paren
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|VIDEO_GET_EVENT
suffix:colon
id|ret
op_assign
id|dvb_video_get_event
c_func
(paren
id|av7110
comma
id|parg
comma
id|file-&gt;f_flags
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|VIDEO_GET_SIZE
suffix:colon
id|memcpy
c_func
(paren
id|parg
comma
op_amp
id|av7110-&gt;video_size
comma
r_sizeof
(paren
id|video_size_t
)paren
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|VIDEO_SET_DISPLAY_FORMAT
suffix:colon
(brace
id|video_displayformat_t
id|format
op_assign
(paren
id|video_displayformat_t
)paren
id|arg
suffix:semicolon
id|u16
id|val
op_assign
l_int|0
suffix:semicolon
r_switch
c_cond
(paren
id|format
)paren
(brace
r_case
id|VIDEO_PAN_SCAN
suffix:colon
id|val
op_assign
id|VID_PAN_SCAN_PREF
suffix:semicolon
r_break
suffix:semicolon
r_case
id|VIDEO_LETTER_BOX
suffix:colon
id|val
op_assign
id|VID_VC_AND_PS_PREF
suffix:semicolon
r_break
suffix:semicolon
r_case
id|VIDEO_CENTER_CUT_OUT
suffix:colon
id|val
op_assign
id|VID_CENTRE_CUT_PREF
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|ret
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ret
OL
l_int|0
)paren
r_break
suffix:semicolon
id|av7110-&gt;videostate.video_format
op_assign
id|format
suffix:semicolon
id|ret
op_assign
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_ENCODER
comma
id|SetPanScanType
comma
l_int|1
comma
(paren
id|u16
)paren
id|val
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|VIDEO_SET_FORMAT
suffix:colon
r_if
c_cond
(paren
id|arg
OG
l_int|1
)paren
(brace
id|ret
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_break
suffix:semicolon
)brace
id|av7110-&gt;display_ar
op_assign
id|arg
suffix:semicolon
id|ret
op_assign
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_ENCODER
comma
id|SetMonitorType
comma
l_int|1
comma
(paren
id|u16
)paren
id|arg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|VIDEO_STILLPICTURE
suffix:colon
(brace
r_struct
id|video_still_picture
op_star
id|pic
op_assign
(paren
r_struct
id|video_still_picture
op_star
)paren
id|parg
suffix:semicolon
id|av7110-&gt;videostate.stream_source
op_assign
id|VIDEO_SOURCE_MEMORY
suffix:semicolon
id|dvb_ringbuffer_flush_spinlock_wakeup
c_func
(paren
op_amp
id|av7110-&gt;avout
)paren
suffix:semicolon
id|ret
op_assign
id|play_iframe
c_func
(paren
id|av7110
comma
id|pic-&gt;iFrame
comma
id|pic-&gt;size
comma
id|file-&gt;f_flags
op_amp
id|O_NONBLOCK
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|VIDEO_FAST_FORWARD
suffix:colon
singleline_comment|//note: arg is ignored by firmware
r_if
c_cond
(paren
id|av7110-&gt;playing
op_amp
id|RP_VIDEO
)paren
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_REC_PLAY
comma
id|__Scan_I
comma
l_int|2
comma
id|AV_PES
comma
l_int|0
)paren
suffix:semicolon
r_else
id|vidcom
c_func
(paren
id|av7110
comma
l_int|0x16
comma
id|arg
)paren
suffix:semicolon
id|av7110-&gt;trickmode
op_assign
id|TRICK_FAST
suffix:semicolon
id|av7110-&gt;videostate.play_state
op_assign
id|VIDEO_PLAYING
suffix:semicolon
r_break
suffix:semicolon
r_case
id|VIDEO_SLOWMOTION
suffix:colon
r_if
c_cond
(paren
id|av7110-&gt;playing
op_amp
id|RP_VIDEO
)paren
(brace
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_REC_PLAY
comma
id|__Slow
comma
l_int|2
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
id|vidcom
c_func
(paren
id|av7110
comma
l_int|0x22
comma
id|arg
)paren
suffix:semicolon
)brace
r_else
(brace
id|vidcom
c_func
(paren
id|av7110
comma
l_int|0x0d
comma
l_int|0
)paren
suffix:semicolon
id|vidcom
c_func
(paren
id|av7110
comma
l_int|0x0e
comma
l_int|0
)paren
suffix:semicolon
id|vidcom
c_func
(paren
id|av7110
comma
l_int|0x22
comma
id|arg
)paren
suffix:semicolon
)brace
id|av7110-&gt;trickmode
op_assign
id|TRICK_SLOW
suffix:semicolon
id|av7110-&gt;videostate.play_state
op_assign
id|VIDEO_PLAYING
suffix:semicolon
r_break
suffix:semicolon
r_case
id|VIDEO_GET_CAPABILITIES
suffix:colon
op_star
(paren
r_int
op_star
)paren
id|parg
op_assign
id|VIDEO_CAP_MPEG1
op_or
id|VIDEO_CAP_MPEG2
op_or
id|VIDEO_CAP_SYS
op_or
id|VIDEO_CAP_PROG
suffix:semicolon
r_break
suffix:semicolon
r_case
id|VIDEO_CLEAR_BUFFER
suffix:colon
id|dvb_ringbuffer_flush_spinlock_wakeup
c_func
(paren
op_amp
id|av7110-&gt;avout
)paren
suffix:semicolon
id|av7110_ipack_reset
c_func
(paren
op_amp
id|av7110-&gt;ipack
(braket
l_int|1
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
id|av7110-&gt;playing
op_eq
id|RP_AV
)paren
(brace
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_REC_PLAY
comma
id|__Play
comma
l_int|2
comma
id|AV_PES
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|av7110-&gt;trickmode
op_eq
id|TRICK_FAST
)paren
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_REC_PLAY
comma
id|__Scan_I
comma
l_int|2
comma
id|AV_PES
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|av7110-&gt;trickmode
op_eq
id|TRICK_SLOW
)paren
(brace
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_REC_PLAY
comma
id|__Slow
comma
l_int|2
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
id|vidcom
c_func
(paren
id|av7110
comma
l_int|0x22
comma
id|arg
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|av7110-&gt;trickmode
op_eq
id|TRICK_FREEZE
)paren
id|vidcom
c_func
(paren
id|av7110
comma
l_int|0x000e
comma
l_int|1
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|VIDEO_SET_STREAMTYPE
suffix:colon
r_break
suffix:semicolon
r_default
suffix:colon
id|ret
op_assign
op_minus
id|ENOIOCTLCMD
suffix:semicolon
r_break
suffix:semicolon
)brace
r_return
id|ret
suffix:semicolon
)brace
DECL|function|dvb_audio_ioctl
r_static
r_int
id|dvb_audio_ioctl
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
comma
r_int
r_int
id|cmd
comma
r_void
op_star
id|parg
)paren
(brace
r_struct
id|dvb_device
op_star
id|dvbdev
op_assign
(paren
r_struct
id|dvb_device
op_star
)paren
id|file-&gt;private_data
suffix:semicolon
r_struct
id|av7110
op_star
id|av7110
op_assign
(paren
r_struct
id|av7110
op_star
)paren
id|dvbdev-&gt;priv
suffix:semicolon
r_int
r_int
id|arg
op_assign
(paren
r_int
r_int
)paren
id|parg
suffix:semicolon
r_int
id|ret
op_assign
l_int|0
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
(paren
id|file-&gt;f_flags
op_amp
id|O_ACCMODE
)paren
op_eq
id|O_RDONLY
)paren
op_logical_and
(paren
id|cmd
op_ne
id|AUDIO_GET_STATUS
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|AUDIO_STOP
suffix:colon
r_if
c_cond
(paren
id|av7110-&gt;audiostate.stream_source
op_eq
id|AUDIO_SOURCE_MEMORY
)paren
id|AV_Stop
c_func
(paren
id|av7110
comma
id|RP_AUDIO
)paren
suffix:semicolon
r_else
id|audcom
c_func
(paren
id|av7110
comma
l_int|1
)paren
suffix:semicolon
id|av7110-&gt;audiostate.play_state
op_assign
id|AUDIO_STOPPED
suffix:semicolon
r_break
suffix:semicolon
r_case
id|AUDIO_PLAY
suffix:colon
r_if
c_cond
(paren
id|av7110-&gt;audiostate.stream_source
op_eq
id|AUDIO_SOURCE_MEMORY
)paren
id|AV_StartPlay
c_func
(paren
id|av7110
comma
id|RP_AUDIO
)paren
suffix:semicolon
id|audcom
c_func
(paren
id|av7110
comma
l_int|2
)paren
suffix:semicolon
id|av7110-&gt;audiostate.play_state
op_assign
id|AUDIO_PLAYING
suffix:semicolon
r_break
suffix:semicolon
r_case
id|AUDIO_PAUSE
suffix:colon
id|audcom
c_func
(paren
id|av7110
comma
l_int|1
)paren
suffix:semicolon
id|av7110-&gt;audiostate.play_state
op_assign
id|AUDIO_PAUSED
suffix:semicolon
r_break
suffix:semicolon
r_case
id|AUDIO_CONTINUE
suffix:colon
r_if
c_cond
(paren
id|av7110-&gt;audiostate.play_state
op_eq
id|AUDIO_PAUSED
)paren
(brace
id|av7110-&gt;audiostate.play_state
op_assign
id|AUDIO_PLAYING
suffix:semicolon
id|audcom
c_func
(paren
id|av7110
comma
l_int|0x12
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|AUDIO_SELECT_SOURCE
suffix:colon
id|av7110-&gt;audiostate.stream_source
op_assign
(paren
id|audio_stream_source_t
)paren
id|arg
suffix:semicolon
r_break
suffix:semicolon
r_case
id|AUDIO_SET_MUTE
suffix:colon
(brace
id|audcom
c_func
(paren
id|av7110
comma
id|arg
ques
c_cond
l_int|1
suffix:colon
l_int|2
)paren
suffix:semicolon
id|av7110-&gt;audiostate.mute_state
op_assign
(paren
r_int
)paren
id|arg
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|AUDIO_SET_AV_SYNC
suffix:colon
id|av7110-&gt;audiostate.AV_sync_state
op_assign
(paren
r_int
)paren
id|arg
suffix:semicolon
id|audcom
c_func
(paren
id|av7110
comma
id|arg
ques
c_cond
l_int|0x0f
suffix:colon
l_int|0x0e
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|AUDIO_SET_BYPASS_MODE
suffix:colon
id|ret
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_break
suffix:semicolon
r_case
id|AUDIO_CHANNEL_SELECT
suffix:colon
id|av7110-&gt;audiostate.channel_select
op_assign
(paren
id|audio_channel_select_t
)paren
id|arg
suffix:semicolon
r_switch
c_cond
(paren
id|av7110-&gt;audiostate.channel_select
)paren
(brace
r_case
id|AUDIO_STEREO
suffix:colon
id|audcom
c_func
(paren
id|av7110
comma
l_int|0x80
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|AUDIO_MONO_LEFT
suffix:colon
id|audcom
c_func
(paren
id|av7110
comma
l_int|0x100
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|AUDIO_MONO_RIGHT
suffix:colon
id|audcom
c_func
(paren
id|av7110
comma
l_int|0x200
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|ret
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_break
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|AUDIO_GET_STATUS
suffix:colon
id|memcpy
c_func
(paren
id|parg
comma
op_amp
id|av7110-&gt;audiostate
comma
r_sizeof
(paren
r_struct
id|audio_status
)paren
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|AUDIO_GET_CAPABILITIES
suffix:colon
op_star
(paren
r_int
op_star
)paren
id|parg
op_assign
id|AUDIO_CAP_LPCM
op_or
id|AUDIO_CAP_MP1
op_or
id|AUDIO_CAP_MP2
suffix:semicolon
r_break
suffix:semicolon
r_case
id|AUDIO_CLEAR_BUFFER
suffix:colon
id|dvb_ringbuffer_flush_spinlock_wakeup
c_func
(paren
op_amp
id|av7110-&gt;aout
)paren
suffix:semicolon
id|av7110_ipack_reset
c_func
(paren
op_amp
id|av7110-&gt;ipack
(braket
l_int|0
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
id|av7110-&gt;playing
op_eq
id|RP_AV
)paren
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_REC_PLAY
comma
id|__Play
comma
l_int|2
comma
id|AV_PES
comma
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|AUDIO_SET_ID
suffix:colon
r_break
suffix:semicolon
r_case
id|AUDIO_SET_MIXER
suffix:colon
(brace
r_struct
id|audio_mixer
op_star
id|amix
op_assign
(paren
r_struct
id|audio_mixer
op_star
)paren
id|parg
suffix:semicolon
id|SetVolume
c_func
(paren
id|av7110
comma
id|amix-&gt;volume_left
comma
id|amix-&gt;volume_right
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|AUDIO_SET_STREAMTYPE
suffix:colon
r_break
suffix:semicolon
r_default
suffix:colon
id|ret
op_assign
op_minus
id|ENOIOCTLCMD
suffix:semicolon
r_break
suffix:semicolon
)brace
r_return
id|ret
suffix:semicolon
)brace
DECL|function|dvb_video_open
r_static
r_int
id|dvb_video_open
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_struct
id|dvb_device
op_star
id|dvbdev
op_assign
(paren
r_struct
id|dvb_device
op_star
)paren
id|file-&gt;private_data
suffix:semicolon
r_struct
id|av7110
op_star
id|av7110
op_assign
(paren
r_struct
id|av7110
op_star
)paren
id|dvbdev-&gt;priv
suffix:semicolon
r_int
id|err
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|dvb_generic_open
c_func
(paren
id|inode
comma
id|file
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_if
c_cond
(paren
(paren
id|file-&gt;f_flags
op_amp
id|O_ACCMODE
)paren
op_ne
id|O_RDONLY
)paren
(brace
id|dvb_ringbuffer_flush_spinlock_wakeup
c_func
(paren
op_amp
id|av7110-&gt;aout
)paren
suffix:semicolon
id|dvb_ringbuffer_flush_spinlock_wakeup
c_func
(paren
op_amp
id|av7110-&gt;avout
)paren
suffix:semicolon
id|av7110-&gt;video_blank
op_assign
l_int|1
suffix:semicolon
id|av7110-&gt;audiostate.AV_sync_state
op_assign
l_int|1
suffix:semicolon
id|av7110-&gt;videostate.stream_source
op_assign
id|VIDEO_SOURCE_DEMUX
suffix:semicolon
multiline_comment|/*  empty event queue */
id|av7110-&gt;video_events.eventr
op_assign
id|av7110-&gt;video_events.eventw
op_assign
l_int|0
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dvb_video_release
r_static
r_int
id|dvb_video_release
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_struct
id|dvb_device
op_star
id|dvbdev
op_assign
(paren
r_struct
id|dvb_device
op_star
)paren
id|file-&gt;private_data
suffix:semicolon
r_struct
id|av7110
op_star
id|av7110
op_assign
(paren
r_struct
id|av7110
op_star
)paren
id|dvbdev-&gt;priv
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|file-&gt;f_flags
op_amp
id|O_ACCMODE
)paren
op_ne
id|O_RDONLY
)paren
(brace
id|AV_Stop
c_func
(paren
id|av7110
comma
id|RP_VIDEO
)paren
suffix:semicolon
)brace
r_return
id|dvb_generic_release
c_func
(paren
id|inode
comma
id|file
)paren
suffix:semicolon
)brace
DECL|function|dvb_audio_open
r_static
r_int
id|dvb_audio_open
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_struct
id|dvb_device
op_star
id|dvbdev
op_assign
(paren
r_struct
id|dvb_device
op_star
)paren
id|file-&gt;private_data
suffix:semicolon
r_struct
id|av7110
op_star
id|av7110
op_assign
(paren
r_struct
id|av7110
op_star
)paren
id|dvbdev-&gt;priv
suffix:semicolon
r_int
id|err
op_assign
id|dvb_generic_open
c_func
(paren
id|inode
comma
id|file
)paren
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|dvb_ringbuffer_flush_spinlock_wakeup
c_func
(paren
op_amp
id|av7110-&gt;aout
)paren
suffix:semicolon
id|av7110-&gt;audiostate.stream_source
op_assign
id|AUDIO_SOURCE_DEMUX
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dvb_audio_release
r_static
r_int
id|dvb_audio_release
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_struct
id|dvb_device
op_star
id|dvbdev
op_assign
(paren
r_struct
id|dvb_device
op_star
)paren
id|file-&gt;private_data
suffix:semicolon
r_struct
id|av7110
op_star
id|av7110
op_assign
(paren
r_struct
id|av7110
op_star
)paren
id|dvbdev-&gt;priv
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
id|AV_Stop
c_func
(paren
id|av7110
comma
id|RP_AUDIO
)paren
suffix:semicolon
r_return
id|dvb_generic_release
c_func
(paren
id|inode
comma
id|file
)paren
suffix:semicolon
)brace
multiline_comment|/******************************************************************************&n; * driver registration &n; ******************************************************************************/
DECL|variable|dvb_video_fops
r_static
r_struct
id|file_operations
id|dvb_video_fops
op_assign
(brace
dot
id|owner
op_assign
id|THIS_MODULE
comma
dot
id|write
op_assign
id|dvb_video_write
comma
dot
id|ioctl
op_assign
id|dvb_generic_ioctl
comma
dot
id|open
op_assign
id|dvb_video_open
comma
dot
id|release
op_assign
id|dvb_video_release
comma
dot
id|poll
op_assign
id|dvb_video_poll
comma
)brace
suffix:semicolon
DECL|variable|dvbdev_video
r_static
r_struct
id|dvb_device
id|dvbdev_video
op_assign
(brace
dot
id|priv
op_assign
l_int|0
comma
dot
id|users
op_assign
l_int|6
comma
dot
id|readers
op_assign
l_int|5
comma
multiline_comment|/* arbitrary */
dot
id|writers
op_assign
l_int|1
comma
dot
id|fops
op_assign
op_amp
id|dvb_video_fops
comma
dot
id|kernel_ioctl
op_assign
id|dvb_video_ioctl
comma
)brace
suffix:semicolon
DECL|variable|dvb_audio_fops
r_static
r_struct
id|file_operations
id|dvb_audio_fops
op_assign
(brace
dot
id|owner
op_assign
id|THIS_MODULE
comma
dot
id|write
op_assign
id|dvb_audio_write
comma
dot
id|ioctl
op_assign
id|dvb_generic_ioctl
comma
dot
id|open
op_assign
id|dvb_audio_open
comma
dot
id|release
op_assign
id|dvb_audio_release
comma
dot
id|poll
op_assign
id|dvb_audio_poll
comma
)brace
suffix:semicolon
DECL|variable|dvbdev_audio
r_static
r_struct
id|dvb_device
id|dvbdev_audio
op_assign
(brace
dot
id|priv
op_assign
l_int|0
comma
dot
id|users
op_assign
l_int|1
comma
dot
id|writers
op_assign
l_int|1
comma
dot
id|fops
op_assign
op_amp
id|dvb_audio_fops
comma
dot
id|kernel_ioctl
op_assign
id|dvb_audio_ioctl
comma
)brace
suffix:semicolon
DECL|variable|dvb_ca_fops
r_static
r_struct
id|file_operations
id|dvb_ca_fops
op_assign
(brace
dot
id|owner
op_assign
id|THIS_MODULE
comma
dot
id|read
op_assign
id|dvb_ca_read
comma
dot
id|write
op_assign
id|dvb_ca_write
comma
dot
id|ioctl
op_assign
id|dvb_generic_ioctl
comma
dot
id|open
op_assign
id|dvb_ca_open
comma
dot
id|release
op_assign
id|dvb_generic_release
comma
dot
id|poll
op_assign
id|dvb_ca_poll
comma
)brace
suffix:semicolon
DECL|variable|dvbdev_ca
r_static
r_struct
id|dvb_device
id|dvbdev_ca
op_assign
(brace
dot
id|priv
op_assign
l_int|0
comma
dot
id|users
op_assign
l_int|1
comma
dot
id|writers
op_assign
l_int|1
comma
dot
id|fops
op_assign
op_amp
id|dvb_ca_fops
comma
dot
id|kernel_ioctl
op_assign
id|dvb_ca_ioctl
comma
)brace
suffix:semicolon
DECL|function|av7110_before_after_tune
r_static
r_void
id|av7110_before_after_tune
(paren
id|fe_status_t
id|s
comma
r_void
op_star
id|data
)paren
(brace
r_struct
id|av7110
op_star
id|av7110
op_assign
id|data
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
id|av7110-&gt;fe_synced
op_assign
(paren
id|s
op_amp
id|FE_HAS_LOCK
)paren
ques
c_cond
l_int|1
suffix:colon
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|av7110-&gt;playing
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|down_interruptible
c_func
(paren
op_amp
id|av7110-&gt;pid_mutex
)paren
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|av7110-&gt;fe_synced
)paren
(brace
id|SetPIDs
c_func
(paren
id|av7110
comma
id|av7110-&gt;pids
(braket
id|DMX_PES_VIDEO
)braket
comma
id|av7110-&gt;pids
(braket
id|DMX_PES_AUDIO
)braket
comma
id|av7110-&gt;pids
(braket
id|DMX_PES_TELETEXT
)braket
comma
l_int|0
comma
id|av7110-&gt;pids
(braket
id|DMX_PES_PCR
)braket
)paren
suffix:semicolon
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_PIDFILTER
comma
id|Scan
comma
l_int|0
)paren
suffix:semicolon
)brace
r_else
id|SetPIDs
c_func
(paren
id|av7110
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|av7110-&gt;pid_mutex
)paren
suffix:semicolon
)brace
DECL|function|av7110_register
r_static
r_int
id|av7110_register
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
)paren
(brace
r_int
id|ret
comma
id|i
suffix:semicolon
r_struct
id|dvb_demux
op_star
id|dvbdemux
op_assign
op_amp
id|av7110-&gt;demux
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|av7110-&gt;registered
)paren
r_return
op_minus
l_int|1
suffix:semicolon
id|av7110-&gt;registered
op_assign
l_int|1
suffix:semicolon
id|dvb_add_frontend_notifier
(paren
id|av7110-&gt;dvb_adapter
comma
id|av7110_before_after_tune
comma
id|av7110
)paren
suffix:semicolon
multiline_comment|/**&n;&t; *   init DiSEqC stuff&n;&t; */
id|dvb_add_frontend_ioctls
(paren
id|av7110-&gt;dvb_adapter
comma
id|av7110_diseqc_ioctl
comma
l_int|NULL
comma
id|av7110
)paren
suffix:semicolon
id|av7110-&gt;audiostate.AV_sync_state
op_assign
l_int|0
suffix:semicolon
id|av7110-&gt;audiostate.mute_state
op_assign
l_int|0
suffix:semicolon
id|av7110-&gt;audiostate.play_state
op_assign
id|AUDIO_STOPPED
suffix:semicolon
id|av7110-&gt;audiostate.stream_source
op_assign
id|AUDIO_SOURCE_DEMUX
suffix:semicolon
id|av7110-&gt;audiostate.channel_select
op_assign
id|AUDIO_STEREO
suffix:semicolon
id|av7110-&gt;audiostate.bypass_mode
op_assign
l_int|0
suffix:semicolon
id|av7110-&gt;videostate.video_blank
op_assign
l_int|0
suffix:semicolon
id|av7110-&gt;videostate.play_state
op_assign
id|VIDEO_STOPPED
suffix:semicolon
id|av7110-&gt;videostate.stream_source
op_assign
id|VIDEO_SOURCE_DEMUX
suffix:semicolon
id|av7110-&gt;videostate.video_format
op_assign
id|VIDEO_FORMAT_4_3
suffix:semicolon
id|av7110-&gt;videostate.display_format
op_assign
id|VIDEO_CENTER_CUT_OUT
suffix:semicolon
id|av7110-&gt;display_ar
op_assign
id|VIDEO_FORMAT_4_3
suffix:semicolon
id|dvbdemux-&gt;priv
op_assign
(paren
r_void
op_star
)paren
id|av7110
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|32
suffix:semicolon
id|i
op_increment
)paren
id|av7110-&gt;handle2filter
(braket
id|i
)braket
op_assign
l_int|NULL
suffix:semicolon
id|dvbdemux-&gt;filternum
op_assign
l_int|32
suffix:semicolon
id|dvbdemux-&gt;feednum
op_assign
l_int|32
suffix:semicolon
id|dvbdemux-&gt;start_feed
op_assign
id|av7110_start_feed
suffix:semicolon
id|dvbdemux-&gt;stop_feed
op_assign
id|av7110_stop_feed
suffix:semicolon
id|dvbdemux-&gt;write_to_decoder
op_assign
id|av7110_write_to_decoder
suffix:semicolon
id|dvbdemux-&gt;dmx.capabilities
op_assign
(paren
id|DMX_TS_FILTERING
op_or
id|DMX_SECTION_FILTERING
op_or
id|DMX_MEMORY_BASED_FILTERING
)paren
suffix:semicolon
id|dvb_dmx_init
c_func
(paren
op_amp
id|av7110-&gt;demux
)paren
suffix:semicolon
id|av7110-&gt;demux.dmx.get_stc
op_assign
id|dvb_get_stc
suffix:semicolon
id|av7110-&gt;dmxdev.filternum
op_assign
l_int|32
suffix:semicolon
id|av7110-&gt;dmxdev.demux
op_assign
op_amp
id|dvbdemux-&gt;dmx
suffix:semicolon
id|av7110-&gt;dmxdev.capabilities
op_assign
l_int|0
suffix:semicolon
id|dvb_dmxdev_init
c_func
(paren
op_amp
id|av7110-&gt;dmxdev
comma
id|av7110-&gt;dvb_adapter
)paren
suffix:semicolon
id|av7110-&gt;hw_frontend.source
op_assign
id|DMX_FRONTEND_0
suffix:semicolon
id|ret
op_assign
id|dvbdemux-&gt;dmx
dot
id|add_frontend
c_func
(paren
op_amp
id|dvbdemux-&gt;dmx
comma
op_amp
id|av7110-&gt;hw_frontend
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
OL
l_int|0
)paren
r_return
id|ret
suffix:semicolon
id|av7110-&gt;mem_frontend.source
op_assign
id|DMX_MEMORY_FE
suffix:semicolon
id|ret
op_assign
id|dvbdemux-&gt;dmx
dot
id|add_frontend
c_func
(paren
op_amp
id|dvbdemux-&gt;dmx
comma
op_amp
id|av7110-&gt;mem_frontend
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
OL
l_int|0
)paren
r_return
id|ret
suffix:semicolon
id|ret
op_assign
id|dvbdemux-&gt;dmx
dot
id|connect_frontend
c_func
(paren
op_amp
id|dvbdemux-&gt;dmx
comma
op_amp
id|av7110-&gt;hw_frontend
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
OL
l_int|0
)paren
r_return
id|ret
suffix:semicolon
id|init_waitqueue_head
c_func
(paren
op_amp
id|av7110-&gt;video_events.wait_queue
)paren
suffix:semicolon
id|spin_lock_init
c_func
(paren
op_amp
id|av7110-&gt;video_events.lock
)paren
suffix:semicolon
id|av7110-&gt;video_events.eventw
op_assign
id|av7110-&gt;video_events.eventr
op_assign
l_int|0
suffix:semicolon
id|av7110-&gt;video_events.overflow
op_assign
l_int|0
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|av7110-&gt;video_size
comma
l_int|0
comma
r_sizeof
(paren
id|video_size_t
)paren
)paren
suffix:semicolon
id|dvb_register_device
c_func
(paren
id|av7110-&gt;dvb_adapter
comma
op_amp
id|av7110-&gt;video_dev
comma
op_amp
id|dvbdev_video
comma
id|av7110
comma
id|DVB_DEVICE_VIDEO
)paren
suffix:semicolon
id|dvb_register_device
c_func
(paren
id|av7110-&gt;dvb_adapter
comma
op_amp
id|av7110-&gt;audio_dev
comma
op_amp
id|dvbdev_audio
comma
id|av7110
comma
id|DVB_DEVICE_AUDIO
)paren
suffix:semicolon
id|dvb_register_device
c_func
(paren
id|av7110-&gt;dvb_adapter
comma
op_amp
id|av7110-&gt;ca_dev
comma
op_amp
id|dvbdev_ca
comma
id|av7110
comma
id|DVB_DEVICE_CA
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_DVB_AV7110_OSD
id|dvb_register_device
c_func
(paren
id|av7110-&gt;dvb_adapter
comma
op_amp
id|av7110-&gt;osd_dev
comma
op_amp
id|dvbdev_osd
comma
id|av7110
comma
id|DVB_DEVICE_OSD
)paren
suffix:semicolon
macro_line|#endif
macro_line|#ifdef USE_DVB_DSP
id|dvb-&gt;dsp_dev
op_assign
id|dvb_register_dsp
c_func
(paren
id|dvb_audio_open
comma
id|dvb_audio_release
comma
id|dvb_audio_ioctl
comma
id|dvb_audio_write
comma
id|av7110-&gt;audio_dev
)paren
suffix:semicolon
macro_line|#endif
singleline_comment|//        }
id|dvb_net_init
c_func
(paren
id|av7110-&gt;dvb_adapter
comma
op_amp
id|av7110-&gt;dvb_net
comma
op_amp
id|dvbdemux-&gt;dmx
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dvb_unregister
r_static
r_void
id|dvb_unregister
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
)paren
(brace
r_struct
id|dvb_demux
op_star
id|dvbdemux
op_assign
op_amp
id|av7110-&gt;demux
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|av7110-&gt;registered
)paren
r_return
suffix:semicolon
id|dvb_net_release
c_func
(paren
op_amp
id|av7110-&gt;dvb_net
)paren
suffix:semicolon
id|dvbdemux-&gt;dmx
dot
id|close
c_func
(paren
op_amp
id|dvbdemux-&gt;dmx
)paren
suffix:semicolon
id|dvbdemux-&gt;dmx
dot
id|remove_frontend
c_func
(paren
op_amp
id|dvbdemux-&gt;dmx
comma
op_amp
id|av7110-&gt;hw_frontend
)paren
suffix:semicolon
id|dvbdemux-&gt;dmx
dot
id|remove_frontend
c_func
(paren
op_amp
id|dvbdemux-&gt;dmx
comma
op_amp
id|av7110-&gt;mem_frontend
)paren
suffix:semicolon
id|dvb_dmxdev_release
c_func
(paren
op_amp
id|av7110-&gt;dmxdev
)paren
suffix:semicolon
id|dvb_dmx_release
c_func
(paren
op_amp
id|av7110-&gt;demux
)paren
suffix:semicolon
id|dvb_remove_frontend_notifier
(paren
id|av7110-&gt;dvb_adapter
comma
id|av7110_before_after_tune
)paren
suffix:semicolon
id|dvb_remove_frontend_ioctls
(paren
id|av7110-&gt;dvb_adapter
comma
id|av7110_diseqc_ioctl
comma
l_int|NULL
)paren
suffix:semicolon
id|dvb_unregister_device
c_func
(paren
id|av7110-&gt;audio_dev
)paren
suffix:semicolon
id|dvb_unregister_device
c_func
(paren
id|av7110-&gt;video_dev
)paren
suffix:semicolon
id|dvb_unregister_device
c_func
(paren
id|av7110-&gt;osd_dev
)paren
suffix:semicolon
id|dvb_unregister_device
c_func
(paren
id|av7110-&gt;ca_dev
)paren
suffix:semicolon
macro_line|#ifdef USE_DVB_DSP
id|dvb_unregister_dsp
c_func
(paren
id|av7110-&gt;dsp_dev
)paren
suffix:semicolon
macro_line|#endif
singleline_comment|//        }
)brace
DECL|function|master_xfer
r_static
r_int
id|master_xfer
(paren
r_struct
id|dvb_i2c_bus
op_star
id|i2c
comma
r_const
r_struct
id|i2c_msg
id|msgs
(braket
)braket
comma
r_int
id|num
)paren
(brace
r_struct
id|saa7146_dev
op_star
id|dev
op_assign
id|i2c-&gt;data
suffix:semicolon
r_return
id|saa7146_i2c_transfer
c_func
(paren
id|dev
comma
id|msgs
comma
id|num
comma
l_int|6
)paren
suffix:semicolon
)brace
multiline_comment|/****************************************************************************&n; * INITIALIZATION&n; ****************************************************************************/
DECL|variable|ioctls
r_struct
id|saa7146_extension_ioctls
id|ioctls
(braket
)braket
op_assign
(brace
(brace
id|VIDIOC_ENUMINPUT
comma
id|SAA7146_EXCLUSIVE
)brace
comma
(brace
id|VIDIOC_G_INPUT
comma
id|SAA7146_EXCLUSIVE
)brace
comma
(brace
id|VIDIOC_S_INPUT
comma
id|SAA7146_EXCLUSIVE
)brace
comma
(brace
id|VIDIOC_G_FREQUENCY
comma
id|SAA7146_EXCLUSIVE
)brace
comma
(brace
id|VIDIOC_S_FREQUENCY
comma
id|SAA7146_EXCLUSIVE
)brace
comma
(brace
id|VIDIOC_G_TUNER
comma
id|SAA7146_EXCLUSIVE
)brace
comma
(brace
id|VIDIOC_S_TUNER
comma
id|SAA7146_EXCLUSIVE
)brace
comma
(brace
id|VIDIOC_G_AUDIO
comma
id|SAA7146_EXCLUSIVE
)brace
comma
(brace
id|VIDIOC_S_AUDIO
comma
id|SAA7146_EXCLUSIVE
)brace
comma
(brace
l_int|0
comma
l_int|0
)brace
)brace
suffix:semicolon
DECL|variable|saa7113_init_regs
r_static
id|u8
id|saa7113_init_regs
(braket
)braket
op_assign
(brace
l_int|0x02
comma
l_int|0xd0
comma
l_int|0x03
comma
l_int|0x23
comma
l_int|0x04
comma
l_int|0x00
comma
l_int|0x05
comma
l_int|0x00
comma
l_int|0x06
comma
l_int|0xe9
comma
l_int|0x07
comma
l_int|0x0d
comma
l_int|0x08
comma
l_int|0x98
comma
l_int|0x09
comma
l_int|0x02
comma
l_int|0x0a
comma
l_int|0x80
comma
l_int|0x0b
comma
l_int|0x40
comma
l_int|0x0c
comma
l_int|0x40
comma
l_int|0x0d
comma
l_int|0x00
comma
l_int|0x0e
comma
l_int|0x01
comma
l_int|0x0f
comma
l_int|0x7c
comma
l_int|0x10
comma
l_int|0x48
comma
l_int|0x11
comma
l_int|0x0c
comma
l_int|0x12
comma
l_int|0x8b
comma
l_int|0x13
comma
l_int|0x1a
comma
l_int|0x14
comma
l_int|0x00
comma
l_int|0x15
comma
l_int|0x00
comma
l_int|0x16
comma
l_int|0x00
comma
l_int|0x17
comma
l_int|0x00
comma
l_int|0x18
comma
l_int|0x00
comma
l_int|0x19
comma
l_int|0x00
comma
l_int|0x1a
comma
l_int|0x00
comma
l_int|0x1b
comma
l_int|0x00
comma
l_int|0x1c
comma
l_int|0x00
comma
l_int|0x1d
comma
l_int|0x00
comma
l_int|0x1e
comma
l_int|0x00
comma
l_int|0x41
comma
l_int|0x77
comma
l_int|0x42
comma
l_int|0x77
comma
l_int|0x43
comma
l_int|0x77
comma
l_int|0x44
comma
l_int|0x77
comma
l_int|0x45
comma
l_int|0x77
comma
l_int|0x46
comma
l_int|0x77
comma
l_int|0x47
comma
l_int|0x77
comma
l_int|0x48
comma
l_int|0x77
comma
l_int|0x49
comma
l_int|0x77
comma
l_int|0x4a
comma
l_int|0x77
comma
l_int|0x4b
comma
l_int|0x77
comma
l_int|0x4c
comma
l_int|0x77
comma
l_int|0x4d
comma
l_int|0x77
comma
l_int|0x4e
comma
l_int|0x77
comma
l_int|0x4f
comma
l_int|0x77
comma
l_int|0x50
comma
l_int|0x77
comma
l_int|0x51
comma
l_int|0x77
comma
l_int|0x52
comma
l_int|0x77
comma
l_int|0x53
comma
l_int|0x77
comma
l_int|0x54
comma
l_int|0x77
comma
l_int|0x55
comma
l_int|0x77
comma
l_int|0x56
comma
l_int|0x77
comma
l_int|0x57
comma
l_int|0xff
comma
l_int|0xff
)brace
suffix:semicolon
DECL|variable|av7110_vv_data_st
r_static
r_struct
id|saa7146_ext_vv
id|av7110_vv_data_st
suffix:semicolon
DECL|variable|av7110_vv_data_c
r_static
r_struct
id|saa7146_ext_vv
id|av7110_vv_data_c
suffix:semicolon
DECL|function|av7110_attach
r_static
r_int
id|av7110_attach
(paren
r_struct
id|saa7146_dev
op_star
id|dev
comma
r_struct
id|saa7146_pci_extension_data
op_star
id|pci_ext
)paren
(brace
r_struct
id|av7110
op_star
id|av7110
op_assign
l_int|NULL
suffix:semicolon
r_int
id|ret
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|av7110
op_assign
id|kmalloc
(paren
r_sizeof
(paren
r_struct
id|av7110
)paren
comma
id|GFP_KERNEL
)paren
)paren
)paren
(brace
id|printk
(paren
l_string|&quot;%s: out of memory!&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|memset
c_func
(paren
id|av7110
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|av7110
)paren
)paren
suffix:semicolon
id|av7110-&gt;card_name
op_assign
(paren
r_char
op_star
)paren
id|pci_ext-&gt;ext_priv
suffix:semicolon
(paren
r_struct
id|av7110
op_star
)paren
id|dev-&gt;ext_priv
op_assign
id|av7110
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;dev: %p, av7110: %p&bslash;n&quot;
comma
id|dev
comma
id|av7110
)paren
)paren
suffix:semicolon
id|av7110-&gt;dev
op_assign
(paren
r_struct
id|saa7146_dev
op_star
)paren
id|dev
suffix:semicolon
id|dvb_register_adapter
c_func
(paren
op_amp
id|av7110-&gt;dvb_adapter
comma
id|av7110-&gt;card_name
)paren
suffix:semicolon
multiline_comment|/* the Siemens DVB needs this if you want to have the i2c chips&n;&t;   get recognized before the main driver is fully loaded */
id|saa7146_write
c_func
(paren
id|dev
comma
id|GPIO_CTRL
comma
l_int|0x500000
)paren
suffix:semicolon
id|saa7146_i2c_adapter_prepare
c_func
(paren
id|dev
comma
l_int|NULL
comma
id|SAA7146_I2C_BUS_BIT_RATE_3200
)paren
suffix:semicolon
id|av7110-&gt;i2c_bus
op_assign
id|dvb_register_i2c_bus
(paren
id|master_xfer
comma
id|dev
comma
id|av7110-&gt;dvb_adapter
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|av7110-&gt;i2c_bus
)paren
(brace
id|dvb_unregister_adapter
(paren
id|av7110-&gt;dvb_adapter
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|av7110
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|ttpci_eeprom_parse_mac
c_func
(paren
id|av7110-&gt;i2c_bus
)paren
suffix:semicolon
id|saa7146_write
c_func
(paren
id|dev
comma
id|PCI_BT_V1
comma
l_int|0x1c00101f
)paren
suffix:semicolon
id|saa7146_write
c_func
(paren
id|dev
comma
id|BCS_CTRL
comma
l_int|0x80400040
)paren
suffix:semicolon
multiline_comment|/* set dd1 stream a &amp; b */
id|saa7146_write
c_func
(paren
id|dev
comma
id|DD1_STREAM_B
comma
l_int|0x00000000
)paren
suffix:semicolon
id|saa7146_write
c_func
(paren
id|dev
comma
id|DD1_INIT
comma
l_int|0x02000000
)paren
suffix:semicolon
id|saa7146_write
c_func
(paren
id|dev
comma
id|MC2
comma
(paren
id|MASK_09
op_or
id|MASK_25
op_or
id|MASK_10
op_or
id|MASK_26
)paren
)paren
suffix:semicolon
multiline_comment|/* upload all */
id|saa7146_write
c_func
(paren
id|dev
comma
id|MC2
comma
l_int|0x077c077c
)paren
suffix:semicolon
id|saa7146_write
c_func
(paren
id|dev
comma
id|GPIO_CTRL
comma
l_int|0x000000
)paren
suffix:semicolon
id|tasklet_init
(paren
op_amp
id|av7110-&gt;debi_tasklet
comma
id|debiirq
comma
(paren
r_int
r_int
)paren
id|av7110
)paren
suffix:semicolon
id|tasklet_init
(paren
op_amp
id|av7110-&gt;gpio_tasklet
comma
id|gpioirq
comma
(paren
r_int
r_int
)paren
id|av7110
)paren
suffix:semicolon
id|sema_init
c_func
(paren
op_amp
id|av7110-&gt;pid_mutex
comma
l_int|1
)paren
suffix:semicolon
multiline_comment|/* locks for data transfers from/to AV7110 */
id|spin_lock_init
(paren
op_amp
id|av7110-&gt;debilock
)paren
suffix:semicolon
id|sema_init
c_func
(paren
op_amp
id|av7110-&gt;dcomlock
comma
l_int|1
)paren
suffix:semicolon
id|av7110-&gt;debilock
op_assign
id|SPIN_LOCK_UNLOCKED
suffix:semicolon
id|av7110-&gt;debitype
op_assign
op_minus
l_int|1
suffix:semicolon
multiline_comment|/* default OSD window */
id|av7110-&gt;osdwin
op_assign
l_int|1
suffix:semicolon
multiline_comment|/* ARM &quot;watchdog&quot; */
id|init_waitqueue_head
c_func
(paren
op_amp
id|av7110-&gt;arm_wait
)paren
suffix:semicolon
id|av7110-&gt;arm_thread
op_assign
l_int|0
suffix:semicolon
id|av7110-&gt;vidmode
op_assign
id|VIDEO_MODE_PAL
suffix:semicolon
id|av7110_ipack_init
c_func
(paren
op_amp
id|av7110-&gt;ipack
(braket
l_int|0
)braket
comma
id|IPACKS
comma
id|play_audio_cb
)paren
suffix:semicolon
id|av7110-&gt;ipack
(braket
l_int|0
)braket
dot
id|data
op_assign
(paren
r_void
op_star
)paren
id|av7110
suffix:semicolon
id|av7110_ipack_init
c_func
(paren
op_amp
id|av7110-&gt;ipack
(braket
l_int|1
)braket
comma
id|IPACKS
comma
id|play_video_cb
)paren
suffix:semicolon
id|av7110-&gt;ipack
(braket
l_int|1
)braket
dot
id|data
op_assign
(paren
r_void
op_star
)paren
id|av7110
suffix:semicolon
multiline_comment|/* allocate and init buffers */
id|av7110-&gt;debi_virt
op_assign
id|pci_alloc_consistent
c_func
(paren
id|dev-&gt;pci
comma
l_int|8192
comma
op_amp
id|av7110-&gt;debi_bus
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|av7110-&gt;debi_virt
)paren
(brace
id|ret
op_assign
op_minus
id|ENOMEM
suffix:semicolon
r_goto
id|err
suffix:semicolon
)brace
id|av7110-&gt;iobuf
op_assign
id|vmalloc
c_func
(paren
id|AVOUTLEN
op_plus
id|AOUTLEN
op_plus
id|BMPLEN
op_plus
l_int|4
op_star
id|IPACKS
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|av7110-&gt;iobuf
)paren
(brace
id|ret
op_assign
op_minus
id|ENOMEM
suffix:semicolon
r_goto
id|err
suffix:semicolon
)brace
id|dvb_ringbuffer_init
c_func
(paren
op_amp
id|av7110-&gt;avout
comma
id|av7110-&gt;iobuf
comma
id|AVOUTLEN
)paren
suffix:semicolon
id|dvb_ringbuffer_init
c_func
(paren
op_amp
id|av7110-&gt;aout
comma
id|av7110-&gt;iobuf
op_plus
id|AVOUTLEN
comma
id|AOUTLEN
)paren
suffix:semicolon
multiline_comment|/* init BMP buffer */
id|av7110-&gt;bmpbuf
op_assign
id|av7110-&gt;iobuf
op_plus
id|AVOUTLEN
op_plus
id|AOUTLEN
suffix:semicolon
id|init_waitqueue_head
c_func
(paren
op_amp
id|av7110-&gt;bmpq
)paren
suffix:semicolon
id|av7110-&gt;kbuf
(braket
l_int|0
)braket
op_assign
(paren
id|u8
op_star
)paren
(paren
id|av7110-&gt;iobuf
op_plus
id|AVOUTLEN
op_plus
id|AOUTLEN
op_plus
id|BMPLEN
)paren
suffix:semicolon
id|av7110-&gt;kbuf
(braket
l_int|1
)braket
op_assign
id|av7110-&gt;kbuf
(braket
l_int|0
)braket
op_plus
l_int|2
op_star
id|IPACKS
suffix:semicolon
multiline_comment|/* CI link layer buffers */
id|ci_ll_init
c_func
(paren
op_amp
id|av7110-&gt;ci_rbuffer
comma
op_amp
id|av7110-&gt;ci_wbuffer
comma
l_int|8192
)paren
suffix:semicolon
multiline_comment|/* handle different card types */
multiline_comment|/* load firmware into AV7110 cards */
id|bootarm
c_func
(paren
id|av7110
)paren
suffix:semicolon
id|firmversion
c_func
(paren
id|av7110
)paren
suffix:semicolon
r_if
c_cond
(paren
id|FW_VERSION
c_func
(paren
id|av7110-&gt;arm_app
)paren
OL
l_int|0x2501
)paren
id|printk
(paren
l_string|&quot;av7110: Warning, firmware version 0x%04x is too old. &quot;
l_string|&quot;System might be unstable!&bslash;n&quot;
comma
id|FW_VERSION
c_func
(paren
id|av7110-&gt;arm_app
)paren
)paren
suffix:semicolon
id|kernel_thread
c_func
(paren
id|arm_thread
comma
(paren
r_void
op_star
)paren
id|av7110
comma
l_int|0
)paren
suffix:semicolon
multiline_comment|/* set internal volume control to maximum */
id|av7110-&gt;adac_type
op_assign
id|DVB_ADAC_TI
suffix:semicolon
id|SetVolume
c_func
(paren
id|av7110
comma
l_int|0xff
comma
l_int|0xff
)paren
suffix:semicolon
id|VidMode
c_func
(paren
id|av7110
comma
id|vidmode
)paren
suffix:semicolon
multiline_comment|/* remaining inits according to card and frontend type */
id|av7110-&gt;has_analog_tuner
op_assign
l_int|0
suffix:semicolon
id|av7110-&gt;current_input
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|i2c_writereg
c_func
(paren
id|av7110
comma
l_int|0x20
comma
l_int|0x00
comma
l_int|0x00
)paren
op_eq
l_int|1
)paren
(brace
id|printk
(paren
l_string|&quot;av7110(%d): Crystal audio DAC detected&bslash;n&quot;
comma
id|av7110-&gt;dvb_adapter-&gt;num
)paren
suffix:semicolon
id|av7110-&gt;adac_type
op_assign
id|DVB_ADAC_CRYSTAL
suffix:semicolon
id|i2c_writereg
c_func
(paren
id|av7110
comma
l_int|0x20
comma
l_int|0x01
comma
l_int|0xd2
)paren
suffix:semicolon
id|i2c_writereg
c_func
(paren
id|av7110
comma
l_int|0x20
comma
l_int|0x02
comma
l_int|0x49
)paren
suffix:semicolon
id|i2c_writereg
c_func
(paren
id|av7110
comma
l_int|0x20
comma
l_int|0x03
comma
l_int|0x00
)paren
suffix:semicolon
id|i2c_writereg
c_func
(paren
id|av7110
comma
l_int|0x20
comma
l_int|0x04
comma
l_int|0x00
)paren
suffix:semicolon
multiline_comment|/**&n;&t; * some special handling for the Siemens DVB-C cards...&n;&t; */
)brace
r_else
r_if
c_cond
(paren
id|i2c_writereg
c_func
(paren
id|av7110
comma
l_int|0x80
comma
l_int|0x0
comma
l_int|0x80
)paren
op_eq
l_int|1
op_logical_and
id|i2c_writereg
c_func
(paren
id|av7110
comma
l_int|0x80
comma
l_int|0x0
comma
l_int|0
)paren
op_eq
l_int|1
)paren
(brace
id|u16
id|version1
comma
id|version2
suffix:semicolon
id|printk
(paren
l_string|&quot;av7110(%d): DVB-C analog module detected, &quot;
l_string|&quot;initializing MSP3400&bslash;n&quot;
comma
id|av7110-&gt;dvb_adapter-&gt;num
)paren
suffix:semicolon
id|av7110-&gt;adac_type
op_assign
id|DVB_ADAC_MSP
suffix:semicolon
id|dvb_delay
c_func
(paren
l_int|100
)paren
suffix:semicolon
singleline_comment|// the probing above resets the msp...
id|msp_readreg
c_func
(paren
id|av7110
comma
id|MSP_RD_DSP
comma
l_int|0x001e
comma
op_amp
id|version1
)paren
suffix:semicolon
id|msp_readreg
c_func
(paren
id|av7110
comma
id|MSP_RD_DSP
comma
l_int|0x001f
comma
op_amp
id|version2
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;av7110(%d): MSP3400 version 0x%04x 0x%04x&bslash;n&quot;
comma
id|av7110-&gt;dvb_adapter-&gt;num
comma
id|version1
comma
id|version2
)paren
suffix:semicolon
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DSP
comma
l_int|0x0013
comma
l_int|0x0c00
)paren
suffix:semicolon
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DSP
comma
l_int|0x0000
comma
l_int|0x7f00
)paren
suffix:semicolon
singleline_comment|// loudspeaker + headphone
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DSP
comma
l_int|0x0008
comma
l_int|0x0220
)paren
suffix:semicolon
singleline_comment|// loudspeaker source
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DSP
comma
l_int|0x0009
comma
l_int|0x0220
)paren
suffix:semicolon
singleline_comment|// headphone source
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DSP
comma
l_int|0x0004
comma
l_int|0x7f00
)paren
suffix:semicolon
singleline_comment|// loudspeaker volume
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DSP
comma
l_int|0x000a
comma
l_int|0x0220
)paren
suffix:semicolon
singleline_comment|// SCART 1 source
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DSP
comma
l_int|0x0007
comma
l_int|0x7f00
)paren
suffix:semicolon
singleline_comment|// SCART 1 volume
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DSP
comma
l_int|0x000d
comma
l_int|0x4800
)paren
suffix:semicolon
singleline_comment|// prescale SCART
r_if
c_cond
(paren
id|i2c_writereg
c_func
(paren
id|av7110
comma
l_int|0x48
comma
l_int|0x01
comma
l_int|0x00
)paren
op_ne
l_int|1
)paren
(brace
id|INFO
c_func
(paren
(paren
l_string|&quot;saa7113 not accessible.&bslash;n&quot;
)paren
)paren
suffix:semicolon
)brace
r_else
(brace
id|u8
op_star
id|i
op_assign
id|saa7113_init_regs
suffix:semicolon
id|av7110-&gt;has_analog_tuner
op_assign
l_int|1
suffix:semicolon
multiline_comment|/* init the saa7113 */
r_while
c_loop
(paren
op_star
id|i
op_ne
l_int|0xff
)paren
(brace
r_if
c_cond
(paren
id|i2c_writereg
c_func
(paren
id|av7110
comma
l_int|0x48
comma
id|i
(braket
l_int|0
)braket
comma
id|i
(braket
l_int|1
)braket
)paren
op_ne
l_int|1
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;av7110(%d): saa7113 initialization failed&quot;
comma
id|av7110-&gt;dvb_adapter-&gt;num
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|i
op_add_assign
l_int|2
suffix:semicolon
)brace
multiline_comment|/* setup msp for analog sound: B/G Dual-FM */
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DEM
comma
l_int|0x00bb
comma
l_int|0x02d0
)paren
suffix:semicolon
singleline_comment|// AD_CV
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DEM
comma
l_int|0x0001
comma
l_int|3
)paren
suffix:semicolon
singleline_comment|// FIR1
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DEM
comma
l_int|0x0001
comma
l_int|18
)paren
suffix:semicolon
singleline_comment|// FIR1
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DEM
comma
l_int|0x0001
comma
l_int|27
)paren
suffix:semicolon
singleline_comment|// FIR1
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DEM
comma
l_int|0x0001
comma
l_int|48
)paren
suffix:semicolon
singleline_comment|// FIR1
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DEM
comma
l_int|0x0001
comma
l_int|66
)paren
suffix:semicolon
singleline_comment|// FIR1
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DEM
comma
l_int|0x0001
comma
l_int|72
)paren
suffix:semicolon
singleline_comment|// FIR1
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DEM
comma
l_int|0x0005
comma
l_int|4
)paren
suffix:semicolon
singleline_comment|// FIR2
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DEM
comma
l_int|0x0005
comma
l_int|64
)paren
suffix:semicolon
singleline_comment|// FIR2
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DEM
comma
l_int|0x0005
comma
l_int|0
)paren
suffix:semicolon
singleline_comment|// FIR2
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DEM
comma
l_int|0x0005
comma
l_int|3
)paren
suffix:semicolon
singleline_comment|// FIR2
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DEM
comma
l_int|0x0005
comma
l_int|18
)paren
suffix:semicolon
singleline_comment|// FIR2
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DEM
comma
l_int|0x0005
comma
l_int|27
)paren
suffix:semicolon
singleline_comment|// FIR2
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DEM
comma
l_int|0x0005
comma
l_int|48
)paren
suffix:semicolon
singleline_comment|// FIR2
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DEM
comma
l_int|0x0005
comma
l_int|66
)paren
suffix:semicolon
singleline_comment|// FIR2
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DEM
comma
l_int|0x0005
comma
l_int|72
)paren
suffix:semicolon
singleline_comment|// FIR2
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DEM
comma
l_int|0x0083
comma
l_int|0xa000
)paren
suffix:semicolon
singleline_comment|// MODE_REG
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DEM
comma
l_int|0x0093
comma
l_int|0x00aa
)paren
suffix:semicolon
singleline_comment|// DCO1_LO 5.74MHz
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DEM
comma
l_int|0x009b
comma
l_int|0x04fc
)paren
suffix:semicolon
singleline_comment|// DCO1_HI
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DEM
comma
l_int|0x00a3
comma
l_int|0x038e
)paren
suffix:semicolon
singleline_comment|// DCO2_LO 5.5MHz
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DEM
comma
l_int|0x00ab
comma
l_int|0x04c6
)paren
suffix:semicolon
singleline_comment|// DCO2_HI
id|msp_writereg
c_func
(paren
id|av7110
comma
id|MSP_WR_DEM
comma
l_int|0x0056
comma
l_int|0
)paren
suffix:semicolon
singleline_comment|// LOAD_REG 1/2
)brace
id|memcpy
c_func
(paren
id|standard
comma
id|dvb_standard
comma
r_sizeof
(paren
r_struct
id|saa7146_standard
)paren
op_star
l_int|2
)paren
suffix:semicolon
multiline_comment|/* set dd1 stream a &amp; b */
id|saa7146_write
c_func
(paren
id|dev
comma
id|DD1_STREAM_B
comma
l_int|0x00000000
)paren
suffix:semicolon
id|saa7146_write
c_func
(paren
id|dev
comma
id|DD1_INIT
comma
l_int|0x02000700
)paren
suffix:semicolon
id|saa7146_write
c_func
(paren
id|dev
comma
id|MC2
comma
(paren
id|MASK_09
op_or
id|MASK_25
op_or
id|MASK_10
op_or
id|MASK_26
)paren
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|dev-&gt;pci-&gt;subsystem_vendor
op_eq
l_int|0x110a
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;av7110(%d): DVB-C w/o analog module detected&bslash;n&quot;
comma
id|av7110-&gt;dvb_adapter-&gt;num
)paren
suffix:semicolon
id|av7110-&gt;adac_type
op_assign
id|DVB_ADAC_NONE
suffix:semicolon
)brace
r_else
(brace
id|av7110-&gt;adac_type
op_assign
id|adac
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;av7110(%d): adac type set to %d&bslash;n&quot;
comma
id|av7110-&gt;dvb_adapter-&gt;num
comma
id|av7110-&gt;adac_type
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|av7110-&gt;adac_type
op_eq
id|DVB_ADAC_NONE
op_logical_or
id|av7110-&gt;adac_type
op_eq
id|DVB_ADAC_MSP
)paren
(brace
singleline_comment|// switch DVB SCART on
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_AUDIODAC
comma
id|MainSwitch
comma
l_int|1
comma
l_int|0
)paren
suffix:semicolon
id|outcom
c_func
(paren
id|av7110
comma
id|COMTYPE_AUDIODAC
comma
id|ADSwitch
comma
l_int|1
comma
l_int|1
)paren
suffix:semicolon
singleline_comment|//saa7146_setgpio(dev, 1, SAA7146_GPIO_OUTHI); // RGB on, SCART pin 16
singleline_comment|//saa7146_setgpio(dev, 3, SAA7146_GPIO_OUTLO); // SCARTpin 8
)brace
id|SetVolume
c_func
(paren
id|av7110
comma
l_int|0xff
comma
l_int|0xff
)paren
suffix:semicolon
id|av7110_setup_irc_config
(paren
id|av7110
comma
l_int|0
)paren
suffix:semicolon
id|av7110_register
c_func
(paren
id|av7110
)paren
suffix:semicolon
multiline_comment|/* special case DVB-C: these cards have an analog tuner&n;&t;   plus need some special handling, so we have separate&n;&t;   saa7146_ext_vv data for these... */
r_if
c_cond
(paren
l_int|0
op_ne
id|av7110-&gt;has_analog_tuner
)paren
(brace
id|ret
op_assign
id|saa7146_vv_init
c_func
(paren
id|dev
comma
op_amp
id|av7110_vv_data_c
)paren
suffix:semicolon
)brace
r_else
(brace
id|ret
op_assign
id|saa7146_vv_init
c_func
(paren
id|dev
comma
op_amp
id|av7110_vv_data_st
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
l_int|0
op_ne
id|ret
)paren
(brace
id|ERR
c_func
(paren
(paren
l_string|&quot;cannot init capture device. skipping.&bslash;n&quot;
)paren
)paren
suffix:semicolon
id|ret
op_assign
op_minus
id|ENODEV
suffix:semicolon
r_goto
id|err
suffix:semicolon
)brace
r_if
c_cond
(paren
id|saa7146_register_device
c_func
(paren
op_amp
id|av7110-&gt;v4l_dev
comma
id|dev
comma
l_string|&quot;av7110&quot;
comma
id|VFL_TYPE_GRABBER
)paren
)paren
(brace
id|ERR
c_func
(paren
(paren
l_string|&quot;cannot register capture device. skipping.&bslash;n&quot;
)paren
)paren
suffix:semicolon
id|ret
op_assign
op_minus
id|ENODEV
suffix:semicolon
r_goto
id|video_err
suffix:semicolon
)brace
r_if
c_cond
(paren
l_int|0
op_ne
id|av7110-&gt;has_analog_tuner
)paren
(brace
r_if
c_cond
(paren
l_int|0
op_ne
id|saa7146_register_device
c_func
(paren
op_amp
id|av7110-&gt;vbi_dev
comma
id|dev
comma
l_string|&quot;av7110&quot;
comma
id|VFL_TYPE_VBI
)paren
)paren
(brace
id|ERR
c_func
(paren
(paren
l_string|&quot;cannot register vbi v4l2 device. skipping.&bslash;n&quot;
)paren
)paren
suffix:semicolon
)brace
multiline_comment|/* we use this to remember that this dvb-c card cannot do vbi */
id|av7110-&gt;has_analog_tuner
op_assign
l_int|2
suffix:semicolon
)brace
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;av7110: found av7110-%d.&bslash;n&quot;
comma
id|av7110_num
)paren
suffix:semicolon
id|av7110_num
op_increment
suffix:semicolon
r_return
l_int|0
suffix:semicolon
id|video_err
suffix:colon
id|saa7146_vv_release
c_func
(paren
id|dev
)paren
suffix:semicolon
id|err
suffix:colon
r_if
c_cond
(paren
l_int|NULL
op_ne
id|av7110
)paren
(brace
id|kfree
c_func
(paren
id|av7110
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
l_int|NULL
op_ne
id|av7110-&gt;debi_virt
)paren
(brace
id|pci_free_consistent
c_func
(paren
id|dev-&gt;pci
comma
l_int|8192
comma
id|av7110-&gt;debi_virt
comma
id|av7110-&gt;debi_bus
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
l_int|NULL
op_ne
id|av7110-&gt;iobuf
)paren
(brace
id|vfree
c_func
(paren
id|av7110-&gt;iobuf
)paren
suffix:semicolon
)brace
id|dvb_unregister_i2c_bus
(paren
id|master_xfer
comma
id|av7110-&gt;i2c_bus-&gt;adapter
comma
id|av7110-&gt;i2c_bus-&gt;id
)paren
suffix:semicolon
id|dvb_unregister_adapter
(paren
id|av7110-&gt;dvb_adapter
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
DECL|function|av7110_detach
r_static
r_int
id|av7110_detach
(paren
r_struct
id|saa7146_dev
op_star
id|saa
)paren
(brace
r_struct
id|av7110
op_star
id|av7110
op_assign
(paren
r_struct
id|av7110
op_star
)paren
id|saa-&gt;ext_priv
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
id|saa7146_unregister_device
c_func
(paren
op_amp
id|av7110-&gt;v4l_dev
comma
id|saa
)paren
suffix:semicolon
r_if
c_cond
(paren
l_int|2
op_eq
id|av7110-&gt;has_analog_tuner
)paren
(brace
id|saa7146_unregister_device
c_func
(paren
op_amp
id|av7110-&gt;vbi_dev
comma
id|saa
)paren
suffix:semicolon
)brace
id|av7110-&gt;arm_rmmod
op_assign
l_int|1
suffix:semicolon
id|wake_up_interruptible
c_func
(paren
op_amp
id|av7110-&gt;arm_wait
)paren
suffix:semicolon
r_while
c_loop
(paren
id|av7110-&gt;arm_thread
)paren
id|dvb_delay
c_func
(paren
l_int|1
)paren
suffix:semicolon
id|dvb_unregister
c_func
(paren
id|av7110
)paren
suffix:semicolon
id|IER_DISABLE
c_func
(paren
id|saa
comma
(paren
id|MASK_19
op_or
id|MASK_03
)paren
)paren
suffix:semicolon
singleline_comment|//&t;saa7146_write (av7110-&gt;dev, IER, 
singleline_comment|//&t;&t;     saa7146_read(av7110-&gt;dev, IER) &amp; ~(MASK_19 | MASK_03));
id|saa7146_write
c_func
(paren
id|av7110-&gt;dev
comma
id|ISR
comma
(paren
id|MASK_19
op_or
id|MASK_03
)paren
)paren
suffix:semicolon
id|ci_ll_release
c_func
(paren
op_amp
id|av7110-&gt;ci_rbuffer
comma
op_amp
id|av7110-&gt;ci_wbuffer
)paren
suffix:semicolon
id|av7110_ipack_free
c_func
(paren
op_amp
id|av7110-&gt;ipack
(braket
l_int|0
)braket
)paren
suffix:semicolon
id|av7110_ipack_free
c_func
(paren
op_amp
id|av7110-&gt;ipack
(braket
l_int|1
)braket
)paren
suffix:semicolon
id|vfree
c_func
(paren
id|av7110-&gt;iobuf
)paren
suffix:semicolon
id|pci_free_consistent
c_func
(paren
id|saa-&gt;pci
comma
l_int|8192
comma
id|av7110-&gt;debi_virt
comma
id|av7110-&gt;debi_bus
)paren
suffix:semicolon
id|dvb_unregister_i2c_bus
(paren
id|master_xfer
comma
id|av7110-&gt;i2c_bus-&gt;adapter
comma
id|av7110-&gt;i2c_bus-&gt;id
)paren
suffix:semicolon
id|dvb_unregister_adapter
(paren
id|av7110-&gt;dvb_adapter
)paren
suffix:semicolon
id|kfree
(paren
id|av7110
)paren
suffix:semicolon
id|saa-&gt;ext_priv
op_assign
l_int|NULL
suffix:semicolon
id|av7110_num
op_decrement
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|av7110_irq
r_static
r_void
id|av7110_irq
c_func
(paren
r_struct
id|saa7146_dev
op_star
id|dev
comma
id|u32
op_star
id|isr
)paren
(brace
r_struct
id|av7110
op_star
id|av7110
op_assign
(paren
r_struct
id|av7110
op_star
)paren
id|dev-&gt;ext_priv
suffix:semicolon
id|DEB_INT
c_func
(paren
(paren
l_string|&quot;dev: %p, av7110: %p&bslash;n&quot;
comma
id|dev
comma
id|av7110
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_star
id|isr
op_amp
id|MASK_19
)paren
id|tasklet_schedule
(paren
op_amp
id|av7110-&gt;debi_tasklet
)paren
suffix:semicolon
r_if
c_cond
(paren
op_star
id|isr
op_amp
id|MASK_03
)paren
id|tasklet_schedule
(paren
op_amp
id|av7110-&gt;gpio_tasklet
)paren
suffix:semicolon
)brace
multiline_comment|/* FIXME: these values are experimental values that look better than the&n;   values from the latest &quot;official&quot; driver -- at least for me... (MiHu) */
DECL|variable|standard
r_static
r_struct
id|saa7146_standard
id|standard
(braket
)braket
op_assign
(brace
(brace
dot
id|name
op_assign
l_string|&quot;PAL&quot;
comma
dot
id|id
op_assign
id|V4L2_STD_PAL_BG
comma
dot
id|v_offset
op_assign
l_int|0x15
comma
dot
id|v_field
op_assign
l_int|288
comma
dot
id|v_calc
op_assign
l_int|576
comma
dot
id|h_offset
op_assign
l_int|0x4a
comma
dot
id|h_pixels
op_assign
l_int|708
comma
dot
id|h_calc
op_assign
l_int|709
comma
dot
id|v_max_out
op_assign
l_int|576
comma
dot
id|h_max_out
op_assign
l_int|768
comma
)brace
comma
(brace
dot
id|name
op_assign
l_string|&quot;NTSC&quot;
comma
dot
id|id
op_assign
id|V4L2_STD_NTSC
comma
dot
id|v_offset
op_assign
l_int|0x10
comma
dot
id|v_field
op_assign
l_int|244
comma
dot
id|v_calc
op_assign
l_int|480
comma
dot
id|h_offset
op_assign
l_int|0x40
comma
dot
id|h_pixels
op_assign
l_int|708
comma
dot
id|h_calc
op_assign
l_int|709
comma
dot
id|v_max_out
op_assign
l_int|480
comma
dot
id|h_max_out
op_assign
l_int|640
comma
)brace
)brace
suffix:semicolon
DECL|variable|analog_standard
r_static
r_struct
id|saa7146_standard
id|analog_standard
(braket
)braket
op_assign
(brace
(brace
dot
id|name
op_assign
l_string|&quot;PAL&quot;
comma
dot
id|id
op_assign
id|V4L2_STD_PAL_BG
comma
dot
id|v_offset
op_assign
l_int|0x18
comma
dot
id|v_field
op_assign
l_int|288
comma
dot
id|v_calc
op_assign
l_int|576
comma
dot
id|h_offset
op_assign
l_int|0x08
comma
dot
id|h_pixels
op_assign
l_int|708
comma
dot
id|h_calc
op_assign
l_int|709
comma
dot
id|v_max_out
op_assign
l_int|576
comma
dot
id|h_max_out
op_assign
l_int|768
comma
)brace
comma
(brace
dot
id|name
op_assign
l_string|&quot;NTSC&quot;
comma
dot
id|id
op_assign
id|V4L2_STD_NTSC
comma
dot
id|v_offset
op_assign
l_int|0x10
comma
dot
id|v_field
op_assign
l_int|244
comma
dot
id|v_calc
op_assign
l_int|480
comma
dot
id|h_offset
op_assign
l_int|0x40
comma
dot
id|h_pixels
op_assign
l_int|708
comma
dot
id|h_calc
op_assign
l_int|709
comma
dot
id|v_max_out
op_assign
l_int|480
comma
dot
id|h_max_out
op_assign
l_int|640
comma
)brace
)brace
suffix:semicolon
DECL|variable|dvb_standard
r_static
r_struct
id|saa7146_standard
id|dvb_standard
(braket
)braket
op_assign
(brace
(brace
dot
id|name
op_assign
l_string|&quot;PAL&quot;
comma
dot
id|id
op_assign
id|V4L2_STD_PAL_BG
comma
dot
id|v_offset
op_assign
l_int|0x14
comma
dot
id|v_field
op_assign
l_int|288
comma
dot
id|v_calc
op_assign
l_int|576
comma
dot
id|h_offset
op_assign
l_int|0x4a
comma
dot
id|h_pixels
op_assign
l_int|708
comma
dot
id|h_calc
op_assign
l_int|709
comma
dot
id|v_max_out
op_assign
l_int|576
comma
dot
id|h_max_out
op_assign
l_int|768
comma
)brace
comma
(brace
dot
id|name
op_assign
l_string|&quot;NTSC&quot;
comma
dot
id|id
op_assign
id|V4L2_STD_NTSC
comma
dot
id|v_offset
op_assign
l_int|0x10
comma
dot
id|v_field
op_assign
l_int|244
comma
dot
id|v_calc
op_assign
l_int|480
comma
dot
id|h_offset
op_assign
l_int|0x40
comma
dot
id|h_pixels
op_assign
l_int|708
comma
dot
id|h_calc
op_assign
l_int|709
comma
dot
id|v_max_out
op_assign
l_int|480
comma
dot
id|h_max_out
op_assign
l_int|640
comma
)brace
)brace
suffix:semicolon
DECL|variable|av7110_extension
r_static
r_struct
id|saa7146_extension
id|av7110_extension
suffix:semicolon
DECL|macro|MAKE_AV7110_INFO
mdefine_line|#define MAKE_AV7110_INFO(x_var,x_name) &bslash;&n;static struct saa7146_pci_extension_data x_var = { &bslash;&n;&t;.ext_priv = x_name, &bslash;&n;&t;.ext = &amp;av7110_extension }
id|MAKE_AV7110_INFO
c_func
(paren
id|fs_1_5
comma
l_string|&quot;Siemens cable card PCI rev1.5&quot;
)paren
suffix:semicolon
id|MAKE_AV7110_INFO
c_func
(paren
id|fs_1_3
comma
l_string|&quot;Siemens/Technotrend/Hauppauge PCI rev1.3&quot;
)paren
suffix:semicolon
id|MAKE_AV7110_INFO
c_func
(paren
id|tt_1_6
comma
l_string|&quot;Technotrend/Hauppauge PCI rev1.3 or 1.6&quot;
)paren
suffix:semicolon
id|MAKE_AV7110_INFO
c_func
(paren
id|tt_2_1
comma
l_string|&quot;Technotrend/Hauppauge PCI rev2.1&quot;
)paren
suffix:semicolon
id|MAKE_AV7110_INFO
c_func
(paren
id|tt_t
comma
l_string|&quot;Technotrend/Hauppauge PCI DVB-T&quot;
)paren
suffix:semicolon
id|MAKE_AV7110_INFO
c_func
(paren
id|unkwn0
comma
l_string|&quot;Technotrend/Hauppauge PCI rev?(unknown0)?&quot;
)paren
suffix:semicolon
id|MAKE_AV7110_INFO
c_func
(paren
id|unkwn1
comma
l_string|&quot;Technotrend/Hauppauge PCI rev?(unknown1)?&quot;
)paren
suffix:semicolon
id|MAKE_AV7110_INFO
c_func
(paren
id|unkwn2
comma
l_string|&quot;Technotrend/Hauppauge PCI rev?(unknown2)?&quot;
)paren
suffix:semicolon
id|MAKE_AV7110_INFO
c_func
(paren
id|nexus
comma
l_string|&quot;Technotrend/Hauppauge Nexus PCI DVB-S&quot;
)paren
suffix:semicolon
id|MAKE_AV7110_INFO
c_func
(paren
id|dvboc11
comma
l_string|&quot;Octal/Technotrend DVB-C for iTV&quot;
)paren
suffix:semicolon
DECL|variable|pci_tbl
r_static
r_struct
id|pci_device_id
id|pci_tbl
(braket
)braket
op_assign
(brace
id|MAKE_EXTENSION_PCI
c_func
(paren
id|fs_1_5
comma
l_int|0x110a
comma
l_int|0xffff
)paren
comma
id|MAKE_EXTENSION_PCI
c_func
(paren
id|fs_1_5
comma
l_int|0x110a
comma
l_int|0x0000
)paren
comma
id|MAKE_EXTENSION_PCI
c_func
(paren
id|fs_1_3
comma
l_int|0x13c2
comma
l_int|0x0000
)paren
comma
id|MAKE_EXTENSION_PCI
c_func
(paren
id|unkwn0
comma
l_int|0x13c2
comma
l_int|0x1002
)paren
comma
id|MAKE_EXTENSION_PCI
c_func
(paren
id|tt_1_6
comma
l_int|0x13c2
comma
l_int|0x0001
)paren
comma
id|MAKE_EXTENSION_PCI
c_func
(paren
id|tt_2_1
comma
l_int|0x13c2
comma
l_int|0x0002
)paren
comma
id|MAKE_EXTENSION_PCI
c_func
(paren
id|tt_2_1
comma
l_int|0x13c2
comma
l_int|0x0003
)paren
comma
id|MAKE_EXTENSION_PCI
c_func
(paren
id|tt_2_1
comma
l_int|0x13c2
comma
l_int|0x0004
)paren
comma
id|MAKE_EXTENSION_PCI
c_func
(paren
id|tt_1_6
comma
l_int|0x13c2
comma
l_int|0x0006
)paren
comma
id|MAKE_EXTENSION_PCI
c_func
(paren
id|tt_t
comma
l_int|0x13c2
comma
l_int|0x0008
)paren
comma
id|MAKE_EXTENSION_PCI
c_func
(paren
id|tt_2_1
comma
l_int|0x13c2
comma
l_int|0x1102
)paren
comma
id|MAKE_EXTENSION_PCI
c_func
(paren
id|unkwn1
comma
l_int|0xffc2
comma
l_int|0x0000
)paren
comma
id|MAKE_EXTENSION_PCI
c_func
(paren
id|unkwn2
comma
l_int|0x00a1
comma
l_int|0x00a1
)paren
comma
id|MAKE_EXTENSION_PCI
c_func
(paren
id|nexus
comma
l_int|0x00a1
comma
l_int|0xa1a0
)paren
comma
id|MAKE_EXTENSION_PCI
c_func
(paren
id|dvboc11
comma
l_int|0x13c2
comma
l_int|0x000a
)paren
comma
(brace
dot
id|vendor
op_assign
l_int|0
comma
)brace
)brace
suffix:semicolon
id|MODULE_DEVICE_TABLE
c_func
(paren
id|pci
comma
id|pci_tbl
)paren
suffix:semicolon
DECL|function|std_callback
r_static
r_int
id|std_callback
c_func
(paren
r_struct
id|saa7146_dev
op_star
id|dev
comma
r_struct
id|saa7146_standard
op_star
id|std
)paren
(brace
r_struct
id|av7110
op_star
id|av7110
op_assign
(paren
r_struct
id|av7110
op_star
)paren
id|dev-&gt;ext_priv
suffix:semicolon
r_if
c_cond
(paren
id|std-&gt;id
op_eq
id|V4L2_STD_PAL
)paren
(brace
id|av7110-&gt;vidmode
op_assign
id|VIDEO_MODE_PAL
suffix:semicolon
id|SetMode
c_func
(paren
id|av7110
comma
id|av7110-&gt;vidmode
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|std-&gt;id
op_eq
id|V4L2_STD_NTSC
)paren
(brace
id|av7110-&gt;vidmode
op_assign
id|VIDEO_MODE_NTSC
suffix:semicolon
id|SetMode
c_func
(paren
id|av7110
comma
id|av7110-&gt;vidmode
)paren
suffix:semicolon
)brace
r_else
r_return
op_minus
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|av7110_vv_data_st
r_static
r_struct
id|saa7146_ext_vv
id|av7110_vv_data_st
op_assign
(brace
dot
id|inputs
op_assign
l_int|1
comma
dot
id|audios
op_assign
l_int|1
comma
dot
id|capabilities
op_assign
l_int|0
comma
dot
id|flags
op_assign
id|SAA7146_EXT_SWAP_ODD_EVEN
comma
dot
id|stds
op_assign
op_amp
id|standard
(braket
l_int|0
)braket
comma
dot
id|num_stds
op_assign
r_sizeof
(paren
id|standard
)paren
op_div
r_sizeof
(paren
r_struct
id|saa7146_standard
)paren
comma
dot
id|std_callback
op_assign
op_amp
id|std_callback
comma
dot
id|ioctls
op_assign
op_amp
id|ioctls
(braket
l_int|0
)braket
comma
dot
id|ioctl
op_assign
id|av7110_ioctl
comma
)brace
suffix:semicolon
DECL|variable|av7110_vv_data_c
r_static
r_struct
id|saa7146_ext_vv
id|av7110_vv_data_c
op_assign
(brace
dot
id|inputs
op_assign
l_int|1
comma
dot
id|audios
op_assign
l_int|1
comma
dot
id|capabilities
op_assign
id|V4L2_CAP_TUNER
op_or
id|V4L2_CAP_VBI_CAPTURE
comma
dot
id|flags
op_assign
id|SAA7146_USE_PORT_B_FOR_VBI
comma
dot
id|stds
op_assign
op_amp
id|standard
(braket
l_int|0
)braket
comma
dot
id|num_stds
op_assign
r_sizeof
(paren
id|standard
)paren
op_div
r_sizeof
(paren
r_struct
id|saa7146_standard
)paren
comma
dot
id|std_callback
op_assign
op_amp
id|std_callback
comma
dot
id|ioctls
op_assign
op_amp
id|ioctls
(braket
l_int|0
)braket
comma
dot
id|ioctl
op_assign
id|av7110_ioctl
comma
)brace
suffix:semicolon
DECL|variable|av7110_extension
r_static
r_struct
id|saa7146_extension
id|av7110_extension
op_assign
(brace
dot
id|name
op_assign
l_string|&quot;dvb&bslash;0&quot;
comma
dot
id|module
op_assign
id|THIS_MODULE
comma
dot
id|pci_tbl
op_assign
op_amp
id|pci_tbl
(braket
l_int|0
)braket
comma
dot
id|attach
op_assign
id|av7110_attach
comma
dot
id|detach
op_assign
id|av7110_detach
comma
dot
id|irq_mask
op_assign
id|MASK_19
op_or
id|MASK_03
comma
dot
id|irq_func
op_assign
id|av7110_irq
comma
)brace
suffix:semicolon
DECL|function|av7110_init
r_static
r_int
id|__init
id|av7110_init
c_func
(paren
r_void
)paren
(brace
r_int
id|retval
suffix:semicolon
id|retval
op_assign
id|saa7146_register_extension
c_func
(paren
op_amp
id|av7110_extension
)paren
suffix:semicolon
r_if
c_cond
(paren
id|retval
)paren
r_goto
id|failed_saa7146_register
suffix:semicolon
id|retval
op_assign
id|av7110_ir_init
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|retval
)paren
r_goto
id|failed_av7110_ir_init
suffix:semicolon
r_return
l_int|0
suffix:semicolon
id|failed_av7110_ir_init
suffix:colon
id|saa7146_unregister_extension
c_func
(paren
op_amp
id|av7110_extension
)paren
suffix:semicolon
id|failed_saa7146_register
suffix:colon
r_return
id|retval
suffix:semicolon
)brace
DECL|function|av7110_exit
r_static
r_void
id|__exit
id|av7110_exit
c_func
(paren
r_void
)paren
(brace
id|av7110_ir_exit
c_func
(paren
)paren
suffix:semicolon
id|saa7146_unregister_extension
c_func
(paren
op_amp
id|av7110_extension
)paren
suffix:semicolon
)brace
DECL|variable|av7110_init
id|module_init
c_func
(paren
id|av7110_init
)paren
suffix:semicolon
DECL|variable|av7110_exit
id|module_exit
c_func
(paren
id|av7110_exit
)paren
suffix:semicolon
id|MODULE_DESCRIPTION
c_func
(paren
l_string|&quot;driver for the SAA7146 based AV110 PCI DVB cards by &quot;
l_string|&quot;Siemens, Technotrend, Hauppauge&quot;
)paren
suffix:semicolon
id|MODULE_AUTHOR
c_func
(paren
l_string|&quot;Ralph Metzler, Marcus Metzler, others&quot;
)paren
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|av7110_debug
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|vidmode
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|vidmode
comma
l_string|&quot;analog video out: 0 off, 1 CVBS+RGB (default), 2 CVBS+YC, 3 YC&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|pids_off
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|pids_off
comma
l_string|&quot;clear video/audio/PCR PID filters when demux is closed&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|adac
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|adac
comma
l_string|&quot;audio DAC type: 0 TI, 1 CRYSTAL, 2 MSP (use if autodetection fails)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|hw_sections
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|hw_sections
comma
l_string|&quot;0 use software section filter, 1 use hardware&quot;
)paren
suffix:semicolon
eof
