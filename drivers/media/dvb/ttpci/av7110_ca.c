multiline_comment|/*&n; * av7110_ca.c: CA and CI stuff&n; *&n; * Copyright (C) 1999-2002 Ralph  Metzler&n; *                       &amp; Marcus Metzler for convergence integrated media GmbH&n; *&n; * originally based on code by:&n; * Copyright (C) 1998,1999 Christian Theiss &lt;mistert@rz.fh-augsburg.de&gt;&n; *&n; * This program is free software; you can redistribute it and/or&n; * modify it under the terms of the GNU General Public License&n; * as published by the Free Software Foundation; either version 2&n; * of the License, or (at your option) any later version.&n; *&n; *&n; * This program is distributed in the hope that it will be useful,&n; * but WITHOUT ANY WARRANTY; without even the implied warranty of&n; * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; * GNU General Public License for more details.&n; *&n; *&n; * You should have received a copy of the GNU General Public License&n; * along with this program; if not, write to the Free Software&n; * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.&n; * Or, point your browser to http://www.gnu.org/copyleft/gpl.html&n; *&n; *&n; * the project&squot;s page is at http://www.linuxtv.org/dvb/&n; */
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/types.h&gt;
macro_line|#include &lt;linux/delay.h&gt;
macro_line|#include &lt;linux/fs.h&gt;
macro_line|#include &lt;linux/timer.h&gt;
macro_line|#include &lt;linux/poll.h&gt;
macro_line|#include &lt;linux/byteorder/swabb.h&gt;
macro_line|#include &lt;linux/smp_lock.h&gt;
DECL|macro|DEBUG_VARIABLE
mdefine_line|#define DEBUG_VARIABLE av7110_debug
r_extern
r_int
id|av7110_debug
suffix:semicolon
macro_line|#include &quot;dvb_i2c.h&quot;
macro_line|#include &quot;av7110.h&quot;
macro_line|#include &quot;av7110_hw.h&quot;
macro_line|#include &quot;dvb_functions.h&quot;
DECL|function|CI_handle
r_void
id|CI_handle
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
comma
id|u8
op_star
id|data
comma
id|u16
id|len
)paren
(brace
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|len
OL
l_int|3
)paren
r_return
suffix:semicolon
r_switch
c_cond
(paren
id|data
(braket
l_int|0
)braket
)paren
(brace
r_case
id|CI_MSG_CI_INFO
suffix:colon
r_if
c_cond
(paren
id|data
(braket
l_int|2
)braket
op_ne
l_int|1
op_logical_and
id|data
(braket
l_int|2
)braket
op_ne
l_int|2
)paren
r_break
suffix:semicolon
r_switch
c_cond
(paren
id|data
(braket
l_int|1
)braket
)paren
(brace
r_case
l_int|0
suffix:colon
id|av7110-&gt;ci_slot
(braket
id|data
(braket
l_int|2
)braket
op_minus
l_int|1
)braket
dot
id|flags
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|av7110-&gt;ci_slot
(braket
id|data
(braket
l_int|2
)braket
op_minus
l_int|1
)braket
dot
id|flags
op_or_assign
id|CA_CI_MODULE_PRESENT
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|av7110-&gt;ci_slot
(braket
id|data
(braket
l_int|2
)braket
op_minus
l_int|1
)braket
dot
id|flags
op_or_assign
id|CA_CI_MODULE_READY
suffix:semicolon
r_break
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|CI_SWITCH_PRG_REPLY
suffix:colon
singleline_comment|//av7110-&gt;ci_stat=data[1];
r_break
suffix:semicolon
r_default
suffix:colon
r_break
suffix:semicolon
)brace
)brace
DECL|function|ci_get_data
r_void
id|ci_get_data
c_func
(paren
r_struct
id|dvb_ringbuffer
op_star
id|cibuf
comma
id|u8
op_star
id|data
comma
r_int
id|len
)paren
(brace
r_if
c_cond
(paren
id|dvb_ringbuffer_free
c_func
(paren
id|cibuf
)paren
OL
id|len
op_plus
l_int|2
)paren
r_return
suffix:semicolon
id|DVB_RINGBUFFER_WRITE_BYTE
c_func
(paren
id|cibuf
comma
id|len
op_rshift
l_int|8
)paren
suffix:semicolon
id|DVB_RINGBUFFER_WRITE_BYTE
c_func
(paren
id|cibuf
comma
id|len
op_amp
l_int|0xff
)paren
suffix:semicolon
id|dvb_ringbuffer_write
c_func
(paren
id|cibuf
comma
id|data
comma
id|len
)paren
suffix:semicolon
id|wake_up_interruptible
c_func
(paren
op_amp
id|cibuf-&gt;queue
)paren
suffix:semicolon
)brace
multiline_comment|/******************************************************************************&n; * CI link layer file ops&n; ******************************************************************************/
DECL|function|ci_ll_init
r_int
id|ci_ll_init
c_func
(paren
r_struct
id|dvb_ringbuffer
op_star
id|cirbuf
comma
r_struct
id|dvb_ringbuffer
op_star
id|ciwbuf
comma
r_int
id|size
)paren
(brace
id|dvb_ringbuffer_init
c_func
(paren
id|cirbuf
comma
id|vmalloc
c_func
(paren
id|size
)paren
comma
id|size
)paren
suffix:semicolon
id|dvb_ringbuffer_init
c_func
(paren
id|ciwbuf
comma
id|vmalloc
c_func
(paren
id|size
)paren
comma
id|size
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|ci_ll_flush
r_void
id|ci_ll_flush
c_func
(paren
r_struct
id|dvb_ringbuffer
op_star
id|cirbuf
comma
r_struct
id|dvb_ringbuffer
op_star
id|ciwbuf
)paren
(brace
id|dvb_ringbuffer_flush_spinlock_wakeup
c_func
(paren
id|cirbuf
)paren
suffix:semicolon
id|dvb_ringbuffer_flush_spinlock_wakeup
c_func
(paren
id|ciwbuf
)paren
suffix:semicolon
)brace
DECL|function|ci_ll_release
r_void
id|ci_ll_release
c_func
(paren
r_struct
id|dvb_ringbuffer
op_star
id|cirbuf
comma
r_struct
id|dvb_ringbuffer
op_star
id|ciwbuf
)paren
(brace
id|vfree
c_func
(paren
id|cirbuf-&gt;data
)paren
suffix:semicolon
id|cirbuf-&gt;data
op_assign
l_int|0
suffix:semicolon
id|vfree
c_func
(paren
id|ciwbuf-&gt;data
)paren
suffix:semicolon
id|ciwbuf-&gt;data
op_assign
l_int|0
suffix:semicolon
)brace
DECL|function|ci_ll_reset
r_int
id|ci_ll_reset
c_func
(paren
r_struct
id|dvb_ringbuffer
op_star
id|cibuf
comma
r_struct
id|file
op_star
id|file
comma
r_int
id|slots
comma
id|ca_slot_info_t
op_star
id|slot
)paren
(brace
r_int
id|i
suffix:semicolon
r_int
id|len
op_assign
l_int|0
suffix:semicolon
id|u8
id|msg
(braket
l_int|8
)braket
op_assign
(brace
l_int|0x00
comma
l_int|0x06
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0xff
comma
l_int|0x02
comma
l_int|0x00
comma
l_int|0x00
)brace
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|2
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|slots
op_amp
(paren
l_int|1
op_lshift
id|i
)paren
)paren
id|len
op_add_assign
l_int|8
suffix:semicolon
)brace
r_if
c_cond
(paren
id|dvb_ringbuffer_free
c_func
(paren
id|cibuf
)paren
OL
id|len
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|2
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|slots
op_amp
(paren
l_int|1
op_lshift
id|i
)paren
)paren
(brace
id|msg
(braket
l_int|2
)braket
op_assign
id|i
suffix:semicolon
id|dvb_ringbuffer_write
c_func
(paren
id|cibuf
comma
id|msg
comma
l_int|8
)paren
suffix:semicolon
id|slot
(braket
id|i
)braket
dot
id|flags
op_assign
l_int|0
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|ci_ll_write
r_static
id|ssize_t
id|ci_ll_write
c_func
(paren
r_struct
id|dvb_ringbuffer
op_star
id|cibuf
comma
r_struct
id|file
op_star
id|file
comma
r_const
r_char
id|__user
op_star
id|buf
comma
r_int
id|count
comma
id|loff_t
op_star
id|ppos
)paren
(brace
r_int
id|free
suffix:semicolon
r_int
id|non_blocking
op_assign
id|file-&gt;f_flags
op_amp
id|O_NONBLOCK
suffix:semicolon
r_char
op_star
id|page
op_assign
(paren
r_char
op_star
)paren
id|__get_free_page
c_func
(paren
id|GFP_USER
)paren
suffix:semicolon
r_int
id|res
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|page
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|res
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|count
OG
l_int|2048
)paren
r_goto
id|out
suffix:semicolon
id|res
op_assign
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
id|page
comma
id|buf
comma
id|count
)paren
)paren
r_goto
id|out
suffix:semicolon
id|free
op_assign
id|dvb_ringbuffer_free
c_func
(paren
id|cibuf
)paren
suffix:semicolon
r_if
c_cond
(paren
id|count
op_plus
l_int|2
OG
id|free
)paren
(brace
id|res
op_assign
op_minus
id|EWOULDBLOCK
suffix:semicolon
r_if
c_cond
(paren
id|non_blocking
)paren
r_goto
id|out
suffix:semicolon
id|res
op_assign
op_minus
id|ERESTARTSYS
suffix:semicolon
r_if
c_cond
(paren
id|wait_event_interruptible
c_func
(paren
id|cibuf-&gt;queue
comma
(paren
id|dvb_ringbuffer_free
c_func
(paren
id|cibuf
)paren
op_ge
id|count
op_plus
l_int|2
)paren
)paren
)paren
r_goto
id|out
suffix:semicolon
)brace
id|DVB_RINGBUFFER_WRITE_BYTE
c_func
(paren
id|cibuf
comma
id|count
op_rshift
l_int|8
)paren
suffix:semicolon
id|DVB_RINGBUFFER_WRITE_BYTE
c_func
(paren
id|cibuf
comma
id|count
op_amp
l_int|0xff
)paren
suffix:semicolon
id|res
op_assign
id|dvb_ringbuffer_write
c_func
(paren
id|cibuf
comma
id|page
comma
id|count
)paren
suffix:semicolon
id|out
suffix:colon
id|free_page
c_func
(paren
(paren
r_int
r_int
)paren
id|page
)paren
suffix:semicolon
r_return
id|res
suffix:semicolon
)brace
DECL|function|ci_ll_read
r_static
id|ssize_t
id|ci_ll_read
c_func
(paren
r_struct
id|dvb_ringbuffer
op_star
id|cibuf
comma
r_struct
id|file
op_star
id|file
comma
r_char
id|__user
op_star
id|buf
comma
r_int
id|count
comma
id|loff_t
op_star
id|ppos
)paren
(brace
r_int
id|avail
suffix:semicolon
r_int
id|non_blocking
op_assign
id|file-&gt;f_flags
op_amp
id|O_NONBLOCK
suffix:semicolon
id|ssize_t
id|len
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|cibuf-&gt;data
op_logical_or
op_logical_neg
id|count
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|non_blocking
op_logical_and
(paren
id|dvb_ringbuffer_empty
c_func
(paren
id|cibuf
)paren
)paren
)paren
r_return
op_minus
id|EWOULDBLOCK
suffix:semicolon
r_if
c_cond
(paren
id|wait_event_interruptible
c_func
(paren
id|cibuf-&gt;queue
comma
op_logical_neg
id|dvb_ringbuffer_empty
c_func
(paren
id|cibuf
)paren
)paren
)paren
r_return
op_minus
id|ERESTARTSYS
suffix:semicolon
id|avail
op_assign
id|dvb_ringbuffer_avail
c_func
(paren
id|cibuf
)paren
suffix:semicolon
r_if
c_cond
(paren
id|avail
OL
l_int|4
)paren
r_return
l_int|0
suffix:semicolon
id|len
op_assign
id|DVB_RINGBUFFER_PEEK
c_func
(paren
id|cibuf
comma
l_int|0
)paren
op_lshift
l_int|8
suffix:semicolon
id|len
op_or_assign
id|DVB_RINGBUFFER_PEEK
c_func
(paren
id|cibuf
comma
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|avail
OL
id|len
op_plus
l_int|2
op_logical_or
id|count
OL
id|len
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|DVB_RINGBUFFER_SKIP
c_func
(paren
id|cibuf
comma
l_int|2
)paren
suffix:semicolon
r_return
id|dvb_ringbuffer_read
c_func
(paren
id|cibuf
comma
id|buf
comma
id|len
comma
l_int|1
)paren
suffix:semicolon
)brace
DECL|function|dvb_ca_open
r_static
r_int
id|dvb_ca_open
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_struct
id|dvb_device
op_star
id|dvbdev
op_assign
(paren
r_struct
id|dvb_device
op_star
)paren
id|file-&gt;private_data
suffix:semicolon
r_struct
id|av7110
op_star
id|av7110
op_assign
(paren
r_struct
id|av7110
op_star
)paren
id|dvbdev-&gt;priv
suffix:semicolon
r_int
id|err
op_assign
id|dvb_generic_open
c_func
(paren
id|inode
comma
id|file
)paren
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|ci_ll_flush
c_func
(paren
op_amp
id|av7110-&gt;ci_rbuffer
comma
op_amp
id|av7110-&gt;ci_wbuffer
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dvb_ca_poll
r_static
r_int
r_int
id|dvb_ca_poll
(paren
r_struct
id|file
op_star
id|file
comma
id|poll_table
op_star
id|wait
)paren
(brace
r_struct
id|dvb_device
op_star
id|dvbdev
op_assign
(paren
r_struct
id|dvb_device
op_star
)paren
id|file-&gt;private_data
suffix:semicolon
r_struct
id|av7110
op_star
id|av7110
op_assign
(paren
r_struct
id|av7110
op_star
)paren
id|dvbdev-&gt;priv
suffix:semicolon
r_struct
id|dvb_ringbuffer
op_star
id|rbuf
op_assign
op_amp
id|av7110-&gt;ci_rbuffer
suffix:semicolon
r_struct
id|dvb_ringbuffer
op_star
id|wbuf
op_assign
op_amp
id|av7110-&gt;ci_wbuffer
suffix:semicolon
r_int
r_int
id|mask
op_assign
l_int|0
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
id|poll_wait
c_func
(paren
id|file
comma
op_amp
id|rbuf-&gt;queue
comma
id|wait
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dvb_ringbuffer_empty
c_func
(paren
id|rbuf
)paren
)paren
id|mask
op_or_assign
id|POLLIN
suffix:semicolon
r_if
c_cond
(paren
id|dvb_ringbuffer_avail
c_func
(paren
id|wbuf
)paren
OG
l_int|1024
)paren
id|mask
op_or_assign
id|POLLOUT
suffix:semicolon
r_return
id|mask
suffix:semicolon
)brace
DECL|function|dvb_ca_ioctl
r_static
r_int
id|dvb_ca_ioctl
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
comma
r_int
r_int
id|cmd
comma
r_void
op_star
id|parg
)paren
(brace
r_struct
id|dvb_device
op_star
id|dvbdev
op_assign
(paren
r_struct
id|dvb_device
op_star
)paren
id|file-&gt;private_data
suffix:semicolon
r_struct
id|av7110
op_star
id|av7110
op_assign
(paren
r_struct
id|av7110
op_star
)paren
id|dvbdev-&gt;priv
suffix:semicolon
r_int
r_int
id|arg
op_assign
(paren
r_int
r_int
)paren
id|parg
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|CA_RESET
suffix:colon
r_return
id|ci_ll_reset
c_func
(paren
op_amp
id|av7110-&gt;ci_wbuffer
comma
id|file
comma
id|arg
comma
op_amp
id|av7110-&gt;ci_slot
(braket
l_int|0
)braket
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|CA_GET_CAP
suffix:colon
(brace
id|ca_caps_t
id|cap
suffix:semicolon
id|cap.slot_num
op_assign
l_int|2
suffix:semicolon
id|cap.slot_type
op_assign
(paren
id|FW_CI_LL_SUPPORT
c_func
(paren
id|av7110-&gt;arm_app
)paren
ques
c_cond
id|CA_CI_LINK
suffix:colon
id|CA_CI
)paren
op_or
id|CA_DESCR
suffix:semicolon
id|cap.descr_num
op_assign
l_int|16
suffix:semicolon
id|cap.descr_type
op_assign
id|CA_ECD
suffix:semicolon
id|memcpy
c_func
(paren
id|parg
comma
op_amp
id|cap
comma
r_sizeof
(paren
id|cap
)paren
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|CA_GET_SLOT_INFO
suffix:colon
(brace
id|ca_slot_info_t
op_star
id|info
op_assign
(paren
id|ca_slot_info_t
op_star
)paren
id|parg
suffix:semicolon
r_if
c_cond
(paren
id|info-&gt;num
OG
l_int|1
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|av7110-&gt;ci_slot
(braket
id|info-&gt;num
)braket
dot
id|num
op_assign
id|info-&gt;num
suffix:semicolon
id|av7110-&gt;ci_slot
(braket
id|info-&gt;num
)braket
dot
id|type
op_assign
id|FW_CI_LL_SUPPORT
c_func
(paren
id|av7110-&gt;arm_app
)paren
ques
c_cond
id|CA_CI_LINK
suffix:colon
id|CA_CI
suffix:semicolon
id|memcpy
c_func
(paren
id|info
comma
op_amp
id|av7110-&gt;ci_slot
(braket
id|info-&gt;num
)braket
comma
r_sizeof
(paren
id|ca_slot_info_t
)paren
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|CA_GET_MSG
suffix:colon
r_break
suffix:semicolon
r_case
id|CA_SEND_MSG
suffix:colon
r_break
suffix:semicolon
r_case
id|CA_GET_DESCR_INFO
suffix:colon
(brace
id|ca_descr_info_t
id|info
suffix:semicolon
id|info.num
op_assign
l_int|16
suffix:semicolon
id|info.type
op_assign
id|CA_ECD
suffix:semicolon
id|memcpy
c_func
(paren
id|parg
comma
op_amp
id|info
comma
r_sizeof
(paren
id|info
)paren
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|CA_SET_DESCR
suffix:colon
(brace
id|ca_descr_t
op_star
id|descr
op_assign
(paren
id|ca_descr_t
op_star
)paren
id|parg
suffix:semicolon
r_if
c_cond
(paren
id|descr-&gt;index
op_ge
l_int|16
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|descr-&gt;parity
OG
l_int|1
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|av7110_fw_cmd
c_func
(paren
id|av7110
comma
id|COMTYPE_PIDFILTER
comma
id|SetDescr
comma
l_int|5
comma
(paren
id|descr-&gt;index
op_lshift
l_int|8
)paren
op_or
id|descr-&gt;parity
comma
(paren
id|descr-&gt;cw
(braket
l_int|0
)braket
op_lshift
l_int|8
)paren
op_or
id|descr-&gt;cw
(braket
l_int|1
)braket
comma
(paren
id|descr-&gt;cw
(braket
l_int|2
)braket
op_lshift
l_int|8
)paren
op_or
id|descr-&gt;cw
(braket
l_int|3
)braket
comma
(paren
id|descr-&gt;cw
(braket
l_int|4
)braket
op_lshift
l_int|8
)paren
op_or
id|descr-&gt;cw
(braket
l_int|5
)braket
comma
(paren
id|descr-&gt;cw
(braket
l_int|6
)braket
op_lshift
l_int|8
)paren
op_or
id|descr-&gt;cw
(braket
l_int|7
)braket
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_default
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dvb_ca_write
r_static
id|ssize_t
id|dvb_ca_write
c_func
(paren
r_struct
id|file
op_star
id|file
comma
r_const
r_char
id|__user
op_star
id|buf
comma
r_int
id|count
comma
id|loff_t
op_star
id|ppos
)paren
(brace
r_struct
id|dvb_device
op_star
id|dvbdev
op_assign
(paren
r_struct
id|dvb_device
op_star
)paren
id|file-&gt;private_data
suffix:semicolon
r_struct
id|av7110
op_star
id|av7110
op_assign
(paren
r_struct
id|av7110
op_star
)paren
id|dvbdev-&gt;priv
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_return
id|ci_ll_write
c_func
(paren
op_amp
id|av7110-&gt;ci_wbuffer
comma
id|file
comma
id|buf
comma
id|count
comma
id|ppos
)paren
suffix:semicolon
)brace
DECL|function|dvb_ca_read
r_static
id|ssize_t
id|dvb_ca_read
c_func
(paren
r_struct
id|file
op_star
id|file
comma
r_char
id|__user
op_star
id|buf
comma
r_int
id|count
comma
id|loff_t
op_star
id|ppos
)paren
(brace
r_struct
id|dvb_device
op_star
id|dvbdev
op_assign
(paren
r_struct
id|dvb_device
op_star
)paren
id|file-&gt;private_data
suffix:semicolon
r_struct
id|av7110
op_star
id|av7110
op_assign
(paren
r_struct
id|av7110
op_star
)paren
id|dvbdev-&gt;priv
suffix:semicolon
id|DEB_EE
c_func
(paren
(paren
l_string|&quot;av7110: %p&bslash;n&quot;
comma
id|av7110
)paren
)paren
suffix:semicolon
r_return
id|ci_ll_read
c_func
(paren
op_amp
id|av7110-&gt;ci_rbuffer
comma
id|file
comma
id|buf
comma
id|count
comma
id|ppos
)paren
suffix:semicolon
)brace
DECL|variable|dvb_ca_fops
r_static
r_struct
id|file_operations
id|dvb_ca_fops
op_assign
(brace
dot
id|owner
op_assign
id|THIS_MODULE
comma
dot
id|read
op_assign
id|dvb_ca_read
comma
dot
id|write
op_assign
id|dvb_ca_write
comma
dot
id|ioctl
op_assign
id|dvb_generic_ioctl
comma
dot
id|open
op_assign
id|dvb_ca_open
comma
dot
id|release
op_assign
id|dvb_generic_release
comma
dot
id|poll
op_assign
id|dvb_ca_poll
comma
)brace
suffix:semicolon
DECL|variable|dvbdev_ca
r_static
r_struct
id|dvb_device
id|dvbdev_ca
op_assign
(brace
dot
id|priv
op_assign
l_int|0
comma
dot
id|users
op_assign
l_int|1
comma
dot
id|writers
op_assign
l_int|1
comma
dot
id|fops
op_assign
op_amp
id|dvb_ca_fops
comma
dot
id|kernel_ioctl
op_assign
id|dvb_ca_ioctl
comma
)brace
suffix:semicolon
DECL|function|av7110_ca_register
r_int
id|av7110_ca_register
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
)paren
(brace
r_return
id|dvb_register_device
c_func
(paren
id|av7110-&gt;dvb_adapter
comma
op_amp
id|av7110-&gt;ca_dev
comma
op_amp
id|dvbdev_ca
comma
id|av7110
comma
id|DVB_DEVICE_CA
)paren
suffix:semicolon
)brace
DECL|function|av7110_ca_unregister
r_void
id|av7110_ca_unregister
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
)paren
(brace
id|dvb_unregister_device
c_func
(paren
id|av7110-&gt;ca_dev
)paren
suffix:semicolon
)brace
DECL|function|av7110_ca_init
r_void
id|av7110_ca_init
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
)paren
(brace
id|ci_ll_init
c_func
(paren
op_amp
id|av7110-&gt;ci_rbuffer
comma
op_amp
id|av7110-&gt;ci_wbuffer
comma
l_int|8192
)paren
suffix:semicolon
)brace
DECL|function|av7110_ca_exit
r_void
id|av7110_ca_exit
c_func
(paren
r_struct
id|av7110
op_star
id|av7110
)paren
(brace
id|ci_ll_release
c_func
(paren
op_amp
id|av7110-&gt;ci_rbuffer
comma
op_amp
id|av7110-&gt;ci_wbuffer
)paren
suffix:semicolon
)brace
eof
