multiline_comment|/*&n; * TerraTec Cinergy T&#xfffd;/qanu USB2 DVB-T adapter.&n; *&n; * Copyright (C) 2004 Daniel Mack &lt;daniel@qanu.de&gt; and&n; *&t;&t;    Holger Waechtler &lt;holger@qanu.de&gt;&n; *&n; *  Protocol Spec published on http://qanu.de/specs/terratec_cinergyT2.pdf&n; *&n; * This program is free software; you can redistribute it and/or modify&n; * it under the terms of the GNU General Public License as published by&n; * the Free Software Foundation; either version 2 of the License, or&n; * (at your option) any later version.&n; *&n; * This program is distributed in the hope that it will be useful,&n; * but WITHOUT ANY WARRANTY; without even the implied warranty of&n; * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; * GNU General Public License for more details.&n; *&n; * You should have received a copy of the GNU General Public License&n; * along with this program; if not, write to the Free Software&n; * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.&n; *&n; */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;linux/usb.h&gt;
macro_line|#include &lt;linux/pci.h&gt;
macro_line|#include &lt;linux/input.h&gt;
macro_line|#include &lt;linux/dvb/frontend.h&gt;
macro_line|#include &quot;dmxdev.h&quot;
macro_line|#include &quot;dvb_demux.h&quot;
macro_line|#include &quot;dvb_net.h&quot;
macro_line|#ifdef CONFIG_DVB_CINERGYT2_TUNING
DECL|macro|STREAM_URB_COUNT
mdefine_line|#define STREAM_URB_COUNT (CONFIG_DVB_CINERGYT2_STREAM_URB_COUNT)
DECL|macro|STREAM_BUF_SIZE
mdefine_line|#define STREAM_BUF_SIZE (CONFIG_DVB_CINERGYT2_STREAM_BUF_SIZE)
macro_line|#ifdef CONFIG_DVB_CINERGYT2_ENABLE_RC_INPUT_DEVICE
DECL|macro|ENABLE_RC
mdefine_line|#define ENABLE_RC (1)
macro_line|#endif
macro_line|#else
DECL|macro|STREAM_URB_COUNT
mdefine_line|#define STREAM_URB_COUNT (32)
DECL|macro|STREAM_BUF_SIZE
mdefine_line|#define STREAM_BUF_SIZE (512)
DECL|macro|ENABLE_RC
mdefine_line|#define ENABLE_RC (1)
macro_line|#endif
DECL|macro|DRIVER_NAME
mdefine_line|#define DRIVER_NAME &quot;TerraTec/qanu USB2.0 Highspeed DVB-T Receiver&quot;
DECL|variable|debug
r_static
r_int
id|debug
suffix:semicolon
id|module_param_named
c_func
(paren
id|debug
comma
id|debug
comma
r_int
comma
l_int|0644
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|debug
comma
l_string|&quot;Turn on/off debugging (default:off).&quot;
)paren
suffix:semicolon
DECL|macro|dprintk
mdefine_line|#define dprintk(level, args...) &bslash;&n;            do { if ((debug &amp; level)) { printk(&quot;%s: %s(): &quot;,__stringify(KBUILD_MODNAME), __FUNCTION__); printk(args); } } while (0)
DECL|enum|cinergyt2_ep1_cmd
r_enum
id|cinergyt2_ep1_cmd
(brace
DECL|enumerator|CINERGYT2_EP1_PID_TABLE_RESET
id|CINERGYT2_EP1_PID_TABLE_RESET
op_assign
l_int|0x01
comma
DECL|enumerator|CINERGYT2_EP1_PID_SETUP
id|CINERGYT2_EP1_PID_SETUP
op_assign
l_int|0x02
comma
DECL|enumerator|CINERGYT2_EP1_CONTROL_STREAM_TRANSFER
id|CINERGYT2_EP1_CONTROL_STREAM_TRANSFER
op_assign
l_int|0x03
comma
DECL|enumerator|CINERGYT2_EP1_SET_TUNER_PARAMETERS
id|CINERGYT2_EP1_SET_TUNER_PARAMETERS
op_assign
l_int|0x04
comma
DECL|enumerator|CINERGYT2_EP1_GET_TUNER_STATUS
id|CINERGYT2_EP1_GET_TUNER_STATUS
op_assign
l_int|0x05
comma
DECL|enumerator|CINERGYT2_EP1_START_SCAN
id|CINERGYT2_EP1_START_SCAN
op_assign
l_int|0x06
comma
DECL|enumerator|CINERGYT2_EP1_CONTINUE_SCAN
id|CINERGYT2_EP1_CONTINUE_SCAN
op_assign
l_int|0x07
comma
DECL|enumerator|CINERGYT2_EP1_GET_RC_EVENTS
id|CINERGYT2_EP1_GET_RC_EVENTS
op_assign
l_int|0x08
comma
DECL|enumerator|CINERGYT2_EP1_SLEEP_MODE
id|CINERGYT2_EP1_SLEEP_MODE
op_assign
l_int|0x09
)brace
suffix:semicolon
DECL|variable|cinergyt2_fe_info
r_static
r_struct
id|dvb_frontend_info
id|cinergyt2_fe_info
op_assign
(brace
dot
id|name
op_assign
id|DRIVER_NAME
comma
dot
id|type
op_assign
id|FE_OFDM
comma
dot
id|frequency_min
op_assign
l_int|174000000
comma
dot
id|frequency_max
op_assign
l_int|862000000
comma
dot
id|frequency_stepsize
op_assign
l_int|166667
comma
dot
id|notifier_delay
op_assign
l_int|0
comma
dot
id|caps
op_assign
id|FE_CAN_INVERSION_AUTO
op_or
id|FE_CAN_FEC_1_2
op_or
id|FE_CAN_FEC_2_3
op_or
id|FE_CAN_FEC_3_4
op_or
id|FE_CAN_FEC_5_6
op_or
id|FE_CAN_FEC_7_8
op_or
id|FE_CAN_FEC_AUTO
op_or
id|FE_CAN_QPSK
op_or
id|FE_CAN_QAM_16
op_or
id|FE_CAN_QAM_64
op_or
id|FE_CAN_QAM_AUTO
op_or
id|FE_CAN_TRANSMISSION_MODE_AUTO
op_or
id|FE_CAN_GUARD_INTERVAL_AUTO
op_or
id|FE_CAN_HIERARCHY_AUTO
op_or
id|FE_CAN_RECOVER
op_or
id|FE_CAN_MUTE_TS
)brace
suffix:semicolon
DECL|struct|cinergyt2
r_struct
id|cinergyt2
(brace
DECL|member|demux
r_struct
id|dvb_demux
id|demux
suffix:semicolon
DECL|member|udev
r_struct
id|usb_device
op_star
id|udev
suffix:semicolon
DECL|member|sem
r_struct
id|semaphore
id|sem
suffix:semicolon
DECL|member|adapter
r_struct
id|dvb_adapter
op_star
id|adapter
suffix:semicolon
DECL|member|fedev
r_struct
id|dvb_device
op_star
id|fedev
suffix:semicolon
DECL|member|dmxdev
r_struct
id|dmxdev
id|dmxdev
suffix:semicolon
DECL|member|dvbnet
r_struct
id|dvb_net
id|dvbnet
suffix:semicolon
DECL|member|streaming
r_int
id|streaming
suffix:semicolon
DECL|member|streambuf
r_void
op_star
id|streambuf
suffix:semicolon
DECL|member|streambuf_dmahandle
id|dma_addr_t
id|streambuf_dmahandle
suffix:semicolon
DECL|member|stream_urb
r_struct
id|urb
op_star
id|stream_urb
(braket
id|STREAM_URB_COUNT
)braket
suffix:semicolon
macro_line|#ifdef ENABLE_RC
DECL|member|rc_input_dev
r_struct
id|input_dev
id|rc_input_dev
suffix:semicolon
DECL|member|rc_query_work
r_struct
id|work_struct
id|rc_query_work
suffix:semicolon
DECL|member|rc_input_event
r_int
id|rc_input_event
suffix:semicolon
macro_line|#endif
)brace
suffix:semicolon
r_enum
(brace
DECL|enumerator|CINERGYT2_RC_EVENT_TYPE_NONE
id|CINERGYT2_RC_EVENT_TYPE_NONE
op_assign
l_int|0x00
comma
DECL|enumerator|CINERGYT2_RC_EVENT_TYPE_NEC
id|CINERGYT2_RC_EVENT_TYPE_NEC
op_assign
l_int|0x01
comma
DECL|enumerator|CINERGYT2_RC_EVENT_TYPE_RC5
id|CINERGYT2_RC_EVENT_TYPE_RC5
op_assign
l_int|0x02
)brace
suffix:semicolon
DECL|struct|cinergyt2_rc_event
r_struct
id|cinergyt2_rc_event
(brace
DECL|member|type
r_char
id|type
suffix:semicolon
DECL|member|value
r_uint32
id|value
suffix:semicolon
)brace
id|__attribute__
c_func
(paren
(paren
id|packed
)paren
)paren
suffix:semicolon
DECL|variable|rc_keys
r_static
r_const
r_uint32
id|rc_keys
(braket
)braket
op_assign
(brace
id|CINERGYT2_RC_EVENT_TYPE_NEC
comma
l_int|0xfe01eb04
comma
id|KEY_POWER
comma
id|CINERGYT2_RC_EVENT_TYPE_NEC
comma
l_int|0xfd02eb04
comma
id|KEY_1
comma
id|CINERGYT2_RC_EVENT_TYPE_NEC
comma
l_int|0xfc03eb04
comma
id|KEY_2
comma
id|CINERGYT2_RC_EVENT_TYPE_NEC
comma
l_int|0xfb04eb04
comma
id|KEY_3
comma
id|CINERGYT2_RC_EVENT_TYPE_NEC
comma
l_int|0xfa05eb04
comma
id|KEY_4
comma
id|CINERGYT2_RC_EVENT_TYPE_NEC
comma
l_int|0xf906eb04
comma
id|KEY_5
comma
id|CINERGYT2_RC_EVENT_TYPE_NEC
comma
l_int|0xf807eb04
comma
id|KEY_6
comma
id|CINERGYT2_RC_EVENT_TYPE_NEC
comma
l_int|0xf708eb04
comma
id|KEY_7
comma
id|CINERGYT2_RC_EVENT_TYPE_NEC
comma
l_int|0xf609eb04
comma
id|KEY_8
comma
id|CINERGYT2_RC_EVENT_TYPE_NEC
comma
l_int|0xf50aeb04
comma
id|KEY_9
comma
id|CINERGYT2_RC_EVENT_TYPE_NEC
comma
l_int|0xf30ceb04
comma
id|KEY_0
comma
id|CINERGYT2_RC_EVENT_TYPE_NEC
comma
l_int|0xf40beb04
comma
id|KEY_VIDEO
comma
id|CINERGYT2_RC_EVENT_TYPE_NEC
comma
l_int|0xf20deb04
comma
id|KEY_REFRESH
comma
id|CINERGYT2_RC_EVENT_TYPE_NEC
comma
l_int|0xf10eeb04
comma
id|KEY_SELECT
comma
id|CINERGYT2_RC_EVENT_TYPE_NEC
comma
l_int|0xf00feb04
comma
id|KEY_EPG
comma
id|CINERGYT2_RC_EVENT_TYPE_NEC
comma
l_int|0xef10eb04
comma
id|KEY_UP
comma
id|CINERGYT2_RC_EVENT_TYPE_NEC
comma
l_int|0xeb14eb04
comma
id|KEY_DOWN
comma
id|CINERGYT2_RC_EVENT_TYPE_NEC
comma
l_int|0xee11eb04
comma
id|KEY_LEFT
comma
id|CINERGYT2_RC_EVENT_TYPE_NEC
comma
l_int|0xec13eb04
comma
id|KEY_RIGHT
comma
id|CINERGYT2_RC_EVENT_TYPE_NEC
comma
l_int|0xed12eb04
comma
id|KEY_OK
comma
id|CINERGYT2_RC_EVENT_TYPE_NEC
comma
l_int|0xea15eb04
comma
id|KEY_TEXT
comma
id|CINERGYT2_RC_EVENT_TYPE_NEC
comma
l_int|0xe916eb04
comma
id|KEY_INFO
comma
id|CINERGYT2_RC_EVENT_TYPE_NEC
comma
l_int|0xe817eb04
comma
id|KEY_RED
comma
id|CINERGYT2_RC_EVENT_TYPE_NEC
comma
l_int|0xe718eb04
comma
id|KEY_GREEN
comma
id|CINERGYT2_RC_EVENT_TYPE_NEC
comma
l_int|0xe619eb04
comma
id|KEY_YELLOW
comma
id|CINERGYT2_RC_EVENT_TYPE_NEC
comma
l_int|0xe51aeb04
comma
id|KEY_BLUE
comma
id|CINERGYT2_RC_EVENT_TYPE_NEC
comma
l_int|0xe31ceb04
comma
id|KEY_VOLUMEUP
comma
id|CINERGYT2_RC_EVENT_TYPE_NEC
comma
l_int|0xe11eeb04
comma
id|KEY_VOLUMEDOWN
comma
id|CINERGYT2_RC_EVENT_TYPE_NEC
comma
l_int|0xe21deb04
comma
id|KEY_MUTE
comma
id|CINERGYT2_RC_EVENT_TYPE_NEC
comma
l_int|0xe41beb04
comma
id|KEY_CHANNELUP
comma
id|CINERGYT2_RC_EVENT_TYPE_NEC
comma
l_int|0xe01feb04
comma
id|KEY_CHANNELDOWN
comma
id|CINERGYT2_RC_EVENT_TYPE_NEC
comma
l_int|0xbf40eb04
comma
id|KEY_PAUSE
comma
id|CINERGYT2_RC_EVENT_TYPE_NEC
comma
l_int|0xb34ceb04
comma
id|KEY_PLAY
comma
id|CINERGYT2_RC_EVENT_TYPE_NEC
comma
l_int|0xa758eb04
comma
id|KEY_RECORD
comma
id|CINERGYT2_RC_EVENT_TYPE_NEC
comma
l_int|0xab54eb04
comma
id|KEY_PREVIOUS
comma
id|CINERGYT2_RC_EVENT_TYPE_NEC
comma
l_int|0xb748eb04
comma
id|KEY_STOP
comma
id|CINERGYT2_RC_EVENT_TYPE_NEC
comma
l_int|0xa35ceb04
comma
id|KEY_NEXT
)brace
suffix:semicolon
r_static
r_void
id|cinergyt2_stream_irq
(paren
r_struct
id|urb
op_star
id|urb
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
suffix:semicolon
DECL|function|cinergyt2_submit_stream_urb
r_static
r_int
id|cinergyt2_submit_stream_urb
(paren
r_struct
id|cinergyt2
op_star
id|cinergyt2
comma
r_struct
id|urb
op_star
id|urb
)paren
(brace
r_int
id|err
suffix:semicolon
id|usb_fill_bulk_urb
c_func
(paren
id|urb
comma
id|cinergyt2-&gt;udev
comma
id|usb_rcvbulkpipe
c_func
(paren
id|cinergyt2-&gt;udev
comma
l_int|0x2
)paren
comma
id|urb-&gt;transfer_buffer
comma
id|STREAM_BUF_SIZE
comma
id|cinergyt2_stream_irq
comma
id|cinergyt2
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|usb_submit_urb
c_func
(paren
id|urb
comma
id|GFP_ATOMIC
)paren
)paren
)paren
id|dprintk
c_func
(paren
l_int|1
comma
l_string|&quot;urb submission failed (err = %i)!&bslash;n&quot;
comma
id|err
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|function|cinergyt2_stream_irq
r_static
r_void
id|cinergyt2_stream_irq
(paren
r_struct
id|urb
op_star
id|urb
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
r_struct
id|cinergyt2
op_star
id|cinergyt2
op_assign
id|urb-&gt;context
suffix:semicolon
r_if
c_cond
(paren
id|urb-&gt;actual_length
OG
l_int|0
)paren
id|dvb_dmx_swfilter
c_func
(paren
op_amp
id|cinergyt2-&gt;demux
comma
id|urb-&gt;transfer_buffer
comma
id|urb-&gt;actual_length
)paren
suffix:semicolon
r_if
c_cond
(paren
id|cinergyt2-&gt;streaming
)paren
id|cinergyt2_submit_stream_urb
c_func
(paren
id|cinergyt2
comma
id|urb
)paren
suffix:semicolon
)brace
DECL|function|cinergyt2_free_stream_urbs
r_static
r_void
id|cinergyt2_free_stream_urbs
(paren
r_struct
id|cinergyt2
op_star
id|cinergyt2
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|STREAM_URB_COUNT
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|cinergyt2-&gt;stream_urb
(braket
id|i
)braket
)paren
id|usb_free_urb
c_func
(paren
id|cinergyt2-&gt;stream_urb
(braket
id|i
)braket
)paren
suffix:semicolon
id|pci_free_consistent
c_func
(paren
l_int|NULL
comma
id|STREAM_URB_COUNT
op_star
id|STREAM_BUF_SIZE
comma
id|cinergyt2-&gt;streambuf
comma
id|cinergyt2-&gt;streambuf_dmahandle
)paren
suffix:semicolon
)brace
DECL|function|cinergyt2_alloc_stream_urbs
r_static
r_int
id|cinergyt2_alloc_stream_urbs
(paren
r_struct
id|cinergyt2
op_star
id|cinergyt2
)paren
(brace
r_int
id|i
suffix:semicolon
id|cinergyt2-&gt;streambuf
op_assign
id|pci_alloc_consistent
c_func
(paren
l_int|NULL
comma
id|STREAM_URB_COUNT
op_star
id|STREAM_BUF_SIZE
comma
op_amp
id|cinergyt2-&gt;streambuf_dmahandle
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|cinergyt2-&gt;streambuf
)paren
(brace
id|dprintk
c_func
(paren
l_int|1
comma
l_string|&quot;failed to alloc consistent stream memory area, bailing out!&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|memset
c_func
(paren
id|cinergyt2-&gt;streambuf
comma
l_int|0
comma
id|STREAM_URB_COUNT
op_star
id|STREAM_BUF_SIZE
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|STREAM_URB_COUNT
suffix:semicolon
id|i
op_increment
)paren
(brace
r_struct
id|urb
op_star
id|urb
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|urb
op_assign
id|usb_alloc_urb
c_func
(paren
l_int|0
comma
id|GFP_ATOMIC
)paren
)paren
)paren
(brace
id|dprintk
c_func
(paren
l_int|1
comma
l_string|&quot;failed to alloc consistent stream urbs, bailing out!&bslash;n&quot;
)paren
suffix:semicolon
id|cinergyt2_free_stream_urbs
c_func
(paren
id|cinergyt2
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|urb-&gt;transfer_buffer
op_assign
id|cinergyt2-&gt;streambuf
op_plus
id|i
op_star
id|STREAM_BUF_SIZE
suffix:semicolon
id|urb-&gt;transfer_buffer_length
op_assign
id|STREAM_BUF_SIZE
suffix:semicolon
id|cinergyt2-&gt;stream_urb
(braket
id|i
)braket
op_assign
id|urb
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|cinergyt2_stop_stream_xfer
r_static
r_void
id|cinergyt2_stop_stream_xfer
(paren
r_struct
id|cinergyt2
op_star
id|cinergyt2
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|STREAM_URB_COUNT
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|cinergyt2-&gt;stream_urb
(braket
id|i
)braket
)paren
id|usb_unlink_urb
c_func
(paren
id|cinergyt2-&gt;stream_urb
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
DECL|function|cinergyt2_start_stream_xfer
r_static
r_int
id|cinergyt2_start_stream_xfer
(paren
r_struct
id|cinergyt2
op_star
id|cinergyt2
)paren
(brace
r_int
id|i
comma
id|err
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|STREAM_URB_COUNT
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|cinergyt2_submit_stream_urb
c_func
(paren
id|cinergyt2
comma
id|cinergyt2-&gt;stream_urb
(braket
id|i
)braket
)paren
)paren
)paren
(brace
id|cinergyt2_stop_stream_xfer
c_func
(paren
id|cinergyt2
)paren
suffix:semicolon
id|dprintk
c_func
(paren
l_int|1
comma
l_string|&quot;failed urb submission (%i: err = %i)!&bslash;n&quot;
comma
id|i
comma
id|err
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|cinergyt2_command
r_static
r_int
id|cinergyt2_command
(paren
r_struct
id|cinergyt2
op_star
id|cinergyt2
comma
r_char
op_star
id|send_buf
comma
r_int
id|send_buf_len
comma
r_char
op_star
id|rec_buf
comma
r_int
id|rec_buf_len
)paren
(brace
r_int
id|ret
suffix:semicolon
r_int
id|actual_len
suffix:semicolon
r_char
id|dummy
suffix:semicolon
r_if
c_cond
(paren
id|down_interruptible
c_func
(paren
op_amp
id|cinergyt2-&gt;sem
)paren
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
id|ret
op_assign
id|usb_bulk_msg
c_func
(paren
id|cinergyt2-&gt;udev
comma
id|usb_sndbulkpipe
c_func
(paren
id|cinergyt2-&gt;udev
comma
l_int|1
)paren
comma
id|send_buf
comma
id|send_buf_len
comma
op_amp
id|actual_len
comma
id|HZ
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
id|dprintk
c_func
(paren
l_int|1
comma
l_string|&quot;usb_bulk_msg() (send) failed, err %i&bslash;n&quot;
comma
id|ret
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|rec_buf
)paren
id|rec_buf
op_assign
op_amp
id|dummy
suffix:semicolon
id|ret
op_assign
id|usb_bulk_msg
c_func
(paren
id|cinergyt2-&gt;udev
comma
id|usb_rcvbulkpipe
c_func
(paren
id|cinergyt2-&gt;udev
comma
l_int|1
)paren
comma
id|rec_buf
comma
id|rec_buf_len
comma
op_amp
id|actual_len
comma
id|HZ
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
id|dprintk
c_func
(paren
l_int|1
comma
l_string|&quot;usb_bulk_msg() (read) failed, err %i&bslash;n&quot;
comma
id|ret
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|cinergyt2-&gt;sem
)paren
suffix:semicolon
r_return
id|ret
ques
c_cond
id|ret
suffix:colon
id|actual_len
suffix:semicolon
)brace
DECL|function|cinergyt2_control_stream_transfer
r_static
r_void
id|cinergyt2_control_stream_transfer
(paren
r_struct
id|cinergyt2
op_star
id|cinergyt2
comma
r_int
id|enable
)paren
(brace
r_char
id|buf
(braket
)braket
op_assign
(brace
id|CINERGYT2_EP1_CONTROL_STREAM_TRANSFER
comma
id|enable
ques
c_cond
l_int|1
suffix:colon
l_int|0
)brace
suffix:semicolon
id|cinergyt2_command
c_func
(paren
id|cinergyt2
comma
id|buf
comma
r_sizeof
(paren
id|buf
)paren
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
)brace
DECL|function|cinergyt2_control_sleep_mode
r_static
r_void
id|cinergyt2_control_sleep_mode
(paren
r_struct
id|cinergyt2
op_star
id|cinergyt2
comma
r_int
id|sleep
)paren
(brace
r_char
id|buf
(braket
)braket
op_assign
(brace
id|CINERGYT2_EP1_SLEEP_MODE
comma
id|sleep
ques
c_cond
l_int|1
suffix:colon
l_int|0
)brace
suffix:semicolon
id|cinergyt2_command
c_func
(paren
id|cinergyt2
comma
id|buf
comma
r_sizeof
(paren
id|buf
)paren
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
)brace
DECL|function|cinergyt2_start_feed
r_static
r_int
id|cinergyt2_start_feed
c_func
(paren
r_struct
id|dvb_demux_feed
op_star
id|dvbdmxfeed
)paren
(brace
r_struct
id|dvb_demux
op_star
id|demux
op_assign
id|dvbdmxfeed-&gt;demux
suffix:semicolon
r_struct
id|cinergyt2
op_star
id|cinergyt2
op_assign
id|demux-&gt;priv
suffix:semicolon
r_if
c_cond
(paren
id|cinergyt2-&gt;streaming
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|cinergyt2_start_stream_xfer
(paren
id|cinergyt2
)paren
op_eq
l_int|0
)paren
id|cinergyt2_control_stream_transfer
(paren
id|cinergyt2
comma
l_int|1
)paren
suffix:semicolon
)brace
id|cinergyt2-&gt;streaming
op_increment
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|cinergyt2_stop_feed
r_static
r_int
id|cinergyt2_stop_feed
c_func
(paren
r_struct
id|dvb_demux_feed
op_star
id|dvbdmxfeed
)paren
(brace
r_struct
id|dvb_demux
op_star
id|demux
op_assign
id|dvbdmxfeed-&gt;demux
suffix:semicolon
r_struct
id|cinergyt2
op_star
id|cinergyt2
op_assign
id|demux-&gt;priv
suffix:semicolon
r_if
c_cond
(paren
op_decrement
id|cinergyt2-&gt;streaming
op_eq
l_int|0
)paren
(brace
id|cinergyt2_control_stream_transfer
c_func
(paren
id|cinergyt2
comma
l_int|0
)paren
suffix:semicolon
id|cinergyt2_stop_stream_xfer
c_func
(paren
id|cinergyt2
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; *  convert linux-dvb frontend parameter set into TPS.&n; *  See ETSI ETS-300744, section 4.6.2, table 9 for details.&n; *&n; *  This function is probably reusable and may better get placed in a support&n; *  library.&n; *&n; *  We replace errornous fields by default TPS fields (the ones with value 0).&n; */
DECL|function|compute_tps
r_static
r_uint16
id|compute_tps
(paren
r_struct
id|dvb_frontend_parameters
op_star
id|param
)paren
(brace
r_uint16
id|tps
op_assign
l_int|0
suffix:semicolon
r_struct
id|dvb_ofdm_parameters
op_star
id|op
op_assign
op_amp
id|param-&gt;u.ofdm
suffix:semicolon
r_switch
c_cond
(paren
id|op-&gt;code_rate_HP
)paren
(brace
r_case
id|FEC_2_3
suffix:colon
id|tps
op_or_assign
(paren
l_int|1
op_lshift
l_int|7
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FEC_3_4
suffix:colon
id|tps
op_or_assign
(paren
l_int|2
op_lshift
l_int|7
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FEC_5_6
suffix:colon
id|tps
op_or_assign
(paren
l_int|3
op_lshift
l_int|7
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FEC_7_8
suffix:colon
id|tps
op_or_assign
(paren
l_int|4
op_lshift
l_int|7
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FEC_1_2
suffix:colon
r_case
id|FEC_AUTO
suffix:colon
r_default
suffix:colon
multiline_comment|/* tps |= (0 &lt;&lt; 7) */
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|op-&gt;code_rate_LP
)paren
(brace
r_case
id|FEC_2_3
suffix:colon
id|tps
op_or_assign
(paren
l_int|1
op_lshift
l_int|4
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FEC_3_4
suffix:colon
id|tps
op_or_assign
(paren
l_int|2
op_lshift
l_int|4
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FEC_5_6
suffix:colon
id|tps
op_or_assign
(paren
l_int|3
op_lshift
l_int|4
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FEC_7_8
suffix:colon
id|tps
op_or_assign
(paren
l_int|4
op_lshift
l_int|4
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FEC_1_2
suffix:colon
r_case
id|FEC_AUTO
suffix:colon
r_default
suffix:colon
multiline_comment|/* tps |= (0 &lt;&lt; 4) */
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|op-&gt;constellation
)paren
(brace
r_case
id|QAM_16
suffix:colon
id|tps
op_or_assign
(paren
l_int|1
op_lshift
l_int|13
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|QAM_64
suffix:colon
id|tps
op_or_assign
(paren
l_int|2
op_lshift
l_int|13
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|QPSK
suffix:colon
r_default
suffix:colon
multiline_comment|/* tps |= (0 &lt;&lt; 13) */
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|op-&gt;transmission_mode
)paren
(brace
r_case
id|TRANSMISSION_MODE_8K
suffix:colon
id|tps
op_or_assign
(paren
l_int|1
op_lshift
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|TRANSMISSION_MODE_2K
suffix:colon
r_default
suffix:colon
multiline_comment|/* tps |= (0 &lt;&lt; 0) */
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|op-&gt;guard_interval
)paren
(brace
r_case
id|GUARD_INTERVAL_1_16
suffix:colon
id|tps
op_or_assign
(paren
l_int|1
op_lshift
l_int|2
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|GUARD_INTERVAL_1_8
suffix:colon
id|tps
op_or_assign
(paren
l_int|2
op_lshift
l_int|2
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|GUARD_INTERVAL_1_4
suffix:colon
id|tps
op_or_assign
(paren
l_int|3
op_lshift
l_int|2
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|GUARD_INTERVAL_1_32
suffix:colon
r_default
suffix:colon
multiline_comment|/* tps |= (0 &lt;&lt; 2) */
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|op-&gt;hierarchy_information
)paren
(brace
r_case
id|HIERARCHY_1
suffix:colon
id|tps
op_or_assign
(paren
l_int|1
op_lshift
l_int|10
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HIERARCHY_2
suffix:colon
id|tps
op_or_assign
(paren
l_int|2
op_lshift
l_int|10
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HIERARCHY_4
suffix:colon
id|tps
op_or_assign
(paren
l_int|3
op_lshift
l_int|10
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HIERARCHY_NONE
suffix:colon
r_default
suffix:colon
multiline_comment|/* tps |= (0 &lt;&lt; 10) */
suffix:semicolon
)brace
r_return
id|tps
suffix:semicolon
)brace
DECL|struct|dvbt_set_parameters_msg
r_struct
id|dvbt_set_parameters_msg
(brace
DECL|member|cmd
r_uint8
id|cmd
suffix:semicolon
DECL|member|freq
r_uint32
id|freq
suffix:semicolon
DECL|member|bandwidth
r_uint8
id|bandwidth
suffix:semicolon
DECL|member|tps
r_uint16
id|tps
suffix:semicolon
DECL|member|flags
r_uint8
id|flags
suffix:semicolon
)brace
id|__attribute__
c_func
(paren
(paren
id|packed
)paren
)paren
suffix:semicolon
DECL|struct|dvbt_get_parameters_msg
r_struct
id|dvbt_get_parameters_msg
(brace
DECL|member|freq
r_uint32
id|freq
suffix:semicolon
DECL|member|bandwidth
r_uint8
id|bandwidth
suffix:semicolon
DECL|member|tps
r_uint16
id|tps
suffix:semicolon
DECL|member|flags
r_uint8
id|flags
suffix:semicolon
DECL|member|gain
r_uint16
id|gain
suffix:semicolon
DECL|member|snr
r_uint8
id|snr
suffix:semicolon
DECL|member|viterbi_error_rate
r_uint32
id|viterbi_error_rate
suffix:semicolon
DECL|member|rs_error_rate
r_uint32
id|rs_error_rate
suffix:semicolon
DECL|member|uncorrected_block_count
r_uint32
id|uncorrected_block_count
suffix:semicolon
DECL|member|lock_bits
r_uint8
id|lock_bits
suffix:semicolon
DECL|member|prev_lock_bits
r_uint8
id|prev_lock_bits
suffix:semicolon
)brace
id|__attribute__
c_func
(paren
(paren
id|packed
)paren
)paren
suffix:semicolon
DECL|function|cinergyt2_fe_open
r_static
r_int
id|cinergyt2_fe_open
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_struct
id|dvb_device
op_star
id|dvbdev
op_assign
id|file-&gt;private_data
suffix:semicolon
id|cinergyt2_control_sleep_mode
c_func
(paren
(paren
r_struct
id|cinergyt2
op_star
)paren
id|dvbdev-&gt;priv
comma
l_int|0
)paren
suffix:semicolon
r_return
id|dvb_generic_open
c_func
(paren
id|inode
comma
id|file
)paren
suffix:semicolon
)brace
DECL|function|cinergyt2_fe_release
r_static
r_int
id|cinergyt2_fe_release
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_struct
id|dvb_device
op_star
id|dvbdev
op_assign
id|file-&gt;private_data
suffix:semicolon
id|cinergyt2_control_sleep_mode
c_func
(paren
(paren
r_struct
id|cinergyt2
op_star
)paren
id|dvbdev-&gt;priv
comma
l_int|1
)paren
suffix:semicolon
r_return
id|dvb_generic_release
(paren
id|inode
comma
id|file
)paren
suffix:semicolon
)brace
DECL|function|cinergyt2_fe_ioctl
r_static
r_int
id|cinergyt2_fe_ioctl
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
comma
r_int
r_int
id|cmd
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|dvb_device
op_star
id|dvbdev
op_assign
id|file-&gt;private_data
suffix:semicolon
r_struct
id|cinergyt2
op_star
id|cinergyt2
op_assign
id|dvbdev-&gt;priv
suffix:semicolon
r_int
id|ret
op_assign
l_int|0
suffix:semicolon
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|FE_GET_INFO
suffix:colon
id|memcpy
(paren
id|arg
comma
op_amp
id|cinergyt2_fe_info
comma
r_sizeof
(paren
r_struct
id|dvb_frontend_info
)paren
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FE_READ_STATUS
suffix:colon
(brace
r_struct
id|dvbt_get_parameters_msg
id|msg
suffix:semicolon
r_char
id|cmd
op_assign
id|CINERGYT2_EP1_GET_TUNER_STATUS
suffix:semicolon
id|fe_status_t
op_star
id|status
op_assign
id|arg
suffix:semicolon
op_star
id|status
op_assign
l_int|0
suffix:semicolon
id|cinergyt2_command
c_func
(paren
id|cinergyt2
comma
op_amp
id|cmd
comma
l_int|1
comma
(paren
r_char
op_star
)paren
op_amp
id|msg
comma
r_sizeof
(paren
id|msg
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|msg.lock_bits
op_amp
(paren
l_int|1
op_lshift
l_int|6
)paren
)paren
op_star
id|status
op_or_assign
id|FE_HAS_LOCK
suffix:semicolon
r_if
c_cond
(paren
id|msg.lock_bits
op_amp
(paren
l_int|1
op_lshift
l_int|5
)paren
)paren
op_star
id|status
op_or_assign
id|FE_HAS_SYNC
suffix:semicolon
r_if
c_cond
(paren
id|msg.lock_bits
op_amp
(paren
l_int|1
op_lshift
l_int|4
)paren
)paren
op_star
id|status
op_or_assign
id|FE_HAS_CARRIER
suffix:semicolon
r_if
c_cond
(paren
id|msg.lock_bits
op_amp
(paren
l_int|1
op_lshift
l_int|1
)paren
)paren
op_star
id|status
op_or_assign
id|FE_HAS_VITERBI
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|FE_READ_BER
suffix:colon
(brace
r_struct
id|dvbt_get_parameters_msg
id|msg
suffix:semicolon
r_char
id|cmd
op_assign
id|CINERGYT2_EP1_GET_TUNER_STATUS
suffix:semicolon
id|u32
op_star
id|ber
op_assign
(paren
id|u32
op_star
)paren
id|arg
suffix:semicolon
id|cinergyt2_command
c_func
(paren
id|cinergyt2
comma
op_amp
id|cmd
comma
l_int|1
comma
(paren
r_char
op_star
)paren
op_amp
id|msg
comma
r_sizeof
(paren
id|msg
)paren
)paren
suffix:semicolon
op_star
id|ber
op_assign
id|le32_to_cpu
c_func
(paren
id|msg.viterbi_error_rate
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|FE_READ_SIGNAL_STRENGTH
suffix:colon
(brace
r_struct
id|dvbt_get_parameters_msg
id|msg
suffix:semicolon
r_char
id|cmd
op_assign
id|CINERGYT2_EP1_GET_TUNER_STATUS
suffix:semicolon
id|u16
op_star
id|signal
op_assign
(paren
id|u16
op_star
)paren
id|arg
suffix:semicolon
id|cinergyt2_command
c_func
(paren
id|cinergyt2
comma
op_amp
id|cmd
comma
l_int|1
comma
(paren
r_char
op_star
)paren
op_amp
id|msg
comma
r_sizeof
(paren
id|msg
)paren
)paren
suffix:semicolon
op_star
id|signal
op_assign
op_complement
(paren
id|le16_to_cpu
c_func
(paren
id|msg.gain
)paren
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|FE_READ_SNR
suffix:colon
(brace
r_struct
id|dvbt_get_parameters_msg
id|msg
suffix:semicolon
r_char
id|cmd
op_assign
id|CINERGYT2_EP1_GET_TUNER_STATUS
suffix:semicolon
id|u16
op_star
id|snr
op_assign
(paren
id|u16
op_star
)paren
id|arg
suffix:semicolon
id|cinergyt2_command
c_func
(paren
id|cinergyt2
comma
op_amp
id|cmd
comma
l_int|1
comma
(paren
r_char
op_star
)paren
op_amp
id|msg
comma
r_sizeof
(paren
id|msg
)paren
)paren
suffix:semicolon
op_star
id|snr
op_assign
(paren
id|msg.snr
op_lshift
l_int|8
)paren
op_or
id|msg.snr
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|FE_READ_UNCORRECTED_BLOCKS
suffix:colon
(brace
r_struct
id|dvbt_get_parameters_msg
id|msg
suffix:semicolon
r_char
id|cmd
op_assign
id|CINERGYT2_EP1_GET_TUNER_STATUS
suffix:semicolon
id|u32
op_star
id|ubc
op_assign
(paren
id|u32
op_star
)paren
id|arg
suffix:semicolon
id|cinergyt2_command
c_func
(paren
id|cinergyt2
comma
op_amp
id|cmd
comma
l_int|1
comma
(paren
r_char
op_star
)paren
op_amp
id|msg
comma
r_sizeof
(paren
id|msg
)paren
)paren
suffix:semicolon
op_star
id|ubc
op_assign
id|le32_to_cpu
c_func
(paren
id|msg.uncorrected_block_count
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|FE_SET_FRONTEND
suffix:colon
(brace
r_struct
id|dvb_frontend_parameters
op_star
id|p
op_assign
(paren
r_void
op_star
)paren
id|arg
suffix:semicolon
r_struct
id|dvb_ofdm_parameters
op_star
id|op
op_assign
op_amp
id|p-&gt;u.ofdm
suffix:semicolon
r_struct
id|dvbt_set_parameters_msg
id|msg
suffix:semicolon
id|msg.cmd
op_assign
id|CINERGYT2_EP1_SET_TUNER_PARAMETERS
suffix:semicolon
id|msg.tps
op_assign
id|cpu_to_le16
c_func
(paren
id|compute_tps
c_func
(paren
id|p
)paren
)paren
suffix:semicolon
id|msg.freq
op_assign
id|cpu_to_le32
c_func
(paren
id|p-&gt;frequency
op_div
l_int|1000
)paren
suffix:semicolon
id|msg.bandwidth
op_assign
l_int|8
op_minus
id|op-&gt;bandwidth
op_minus
id|BANDWIDTH_8_MHZ
suffix:semicolon
id|cinergyt2_command
c_func
(paren
id|cinergyt2
comma
(paren
r_char
op_star
)paren
op_amp
id|msg
comma
r_sizeof
(paren
id|msg
)paren
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|FE_GET_FRONTEND
suffix:colon
multiline_comment|/**&n;&t;&t; *  trivial to implement (see struct dvbt_get_parameters_msg).&n;&t;&t; *  equivalent to FE_READ ioctls, but needs &n;&t;&t; *  TPS -&gt; linux-dvb parameter set conversion. Feel free&n;&t;&t; *  to implement this and send us a patch if you need this&n;&t;&t; *  functionality.&n;&t;&t; */
r_break
suffix:semicolon
r_default
suffix:colon
id|ret
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_break
suffix:semicolon
)brace
r_return
id|ret
suffix:semicolon
)brace
r_static
DECL|variable|cinergyt2_fe_fops
r_struct
id|file_operations
id|cinergyt2_fe_fops
op_assign
(brace
dot
id|owner
op_assign
id|THIS_MODULE
comma
dot
id|ioctl
op_assign
id|dvb_generic_ioctl
comma
multiline_comment|/**&n;&t; * do we really need this? If so, let&squot;s implement it via &n;&t; * schedule_delayed_work() similiar to the IR code.&n;&t; */
multiline_comment|/*.poll           = cinergyt2_fe_poll, */
dot
id|open
op_assign
id|cinergyt2_fe_open
comma
dot
id|release
op_assign
id|cinergyt2_fe_release
)brace
suffix:semicolon
DECL|variable|cinergyt2_fe_template
r_static
r_struct
id|dvb_device
id|cinergyt2_fe_template
op_assign
(brace
dot
id|users
op_assign
op_complement
l_int|0
comma
dot
id|writers
op_assign
l_int|1
comma
dot
id|readers
op_assign
(paren
op_complement
l_int|0
)paren
op_minus
l_int|1
comma
dot
id|fops
op_assign
op_amp
id|cinergyt2_fe_fops
comma
dot
id|kernel_ioctl
op_assign
id|cinergyt2_fe_ioctl
)brace
suffix:semicolon
macro_line|#ifdef ENABLE_RC
DECL|function|cinergyt2_query_rc
r_static
r_void
id|cinergyt2_query_rc
(paren
r_void
op_star
id|data
)paren
(brace
r_struct
id|cinergyt2
op_star
id|cinergyt2
op_assign
(paren
r_struct
id|cinergyt2
op_star
)paren
id|data
suffix:semicolon
r_char
id|buf
(braket
l_int|1
)braket
op_assign
(brace
id|CINERGYT2_EP1_GET_RC_EVENTS
)brace
suffix:semicolon
r_struct
id|cinergyt2_rc_event
id|rc_events
(braket
l_int|12
)braket
suffix:semicolon
r_int
id|n
comma
id|len
suffix:semicolon
id|len
op_assign
id|cinergyt2_command
c_func
(paren
id|cinergyt2
comma
id|buf
comma
r_sizeof
(paren
id|buf
)paren
comma
(paren
r_char
op_star
)paren
id|rc_events
comma
r_sizeof
(paren
id|rc_events
)paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|n
op_assign
l_int|0
suffix:semicolon
id|len
OG
l_int|0
op_logical_and
id|n
OL
(paren
id|len
op_div
r_sizeof
(paren
id|rc_events
(braket
l_int|0
)braket
)paren
)paren
suffix:semicolon
id|n
op_increment
)paren
(brace
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
id|rc_events
(braket
id|n
)braket
dot
id|type
op_eq
id|CINERGYT2_RC_EVENT_TYPE_NEC
op_logical_and
id|rc_events
(braket
id|n
)braket
dot
id|value
op_eq
op_complement
l_int|0
)paren
(brace
multiline_comment|/**&n;&t;&t;&t; * keyrepeat bit. If we would handle this properly&n;&t;&t;&t; * we would need to emit down events as long the&n;&t;&t;&t; * keyrepeat goes, a up event if no further &n;&t;&t;&t; * repeat bits occur. Would need a timer to implement&n;&t;&t;&t; * and no other driver does this, so we simply&n;&t;&t;&t; * emit the last key up/down sequence again.&n;&t;&t;&t; */
)brace
r_else
(brace
id|cinergyt2-&gt;rc_input_event
op_assign
id|KEY_MAX
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
r_sizeof
(paren
id|rc_keys
)paren
op_div
r_sizeof
(paren
id|rc_keys
(braket
l_int|0
)braket
)paren
suffix:semicolon
id|i
op_add_assign
l_int|3
)paren
(brace
r_if
c_cond
(paren
id|rc_keys
(braket
id|i
op_plus
l_int|0
)braket
op_eq
id|rc_events
(braket
id|n
)braket
dot
id|type
op_logical_and
id|rc_keys
(braket
id|i
op_plus
l_int|1
)braket
op_eq
id|rc_events
(braket
id|n
)braket
dot
id|value
)paren
(brace
id|cinergyt2-&gt;rc_input_event
op_assign
id|rc_keys
(braket
id|i
op_plus
l_int|2
)braket
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
)brace
r_if
c_cond
(paren
id|cinergyt2-&gt;rc_input_event
op_ne
id|KEY_MAX
)paren
(brace
id|input_report_key
c_func
(paren
op_amp
id|cinergyt2-&gt;rc_input_dev
comma
id|cinergyt2-&gt;rc_input_event
comma
l_int|1
)paren
suffix:semicolon
id|input_report_key
c_func
(paren
op_amp
id|cinergyt2-&gt;rc_input_dev
comma
id|cinergyt2-&gt;rc_input_event
comma
l_int|0
)paren
suffix:semicolon
id|input_sync
c_func
(paren
op_amp
id|cinergyt2-&gt;rc_input_dev
)paren
suffix:semicolon
)brace
)brace
id|schedule_delayed_work
c_func
(paren
op_amp
id|cinergyt2-&gt;rc_query_work
comma
(paren
id|HZ
op_div
l_int|5
)paren
)paren
suffix:semicolon
)brace
macro_line|#endif
DECL|function|cinergyt2_probe
r_static
r_int
id|cinergyt2_probe
(paren
r_struct
id|usb_interface
op_star
id|intf
comma
r_const
r_struct
id|usb_device_id
op_star
id|id
)paren
(brace
r_struct
id|cinergyt2
op_star
id|cinergyt2
suffix:semicolon
r_int
id|i
comma
id|err
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|cinergyt2
op_assign
id|kmalloc
(paren
r_sizeof
(paren
r_struct
id|cinergyt2
)paren
comma
id|GFP_KERNEL
)paren
)paren
)paren
(brace
id|dprintk
c_func
(paren
l_int|1
comma
l_string|&quot;out of memory?!?&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|memset
(paren
id|cinergyt2
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|cinergyt2
)paren
)paren
suffix:semicolon
id|usb_set_intfdata
(paren
id|intf
comma
(paren
r_void
op_star
)paren
id|cinergyt2
)paren
suffix:semicolon
id|init_MUTEX
c_func
(paren
op_amp
id|cinergyt2-&gt;sem
)paren
suffix:semicolon
id|cinergyt2-&gt;udev
op_assign
id|interface_to_usbdev
c_func
(paren
id|intf
)paren
suffix:semicolon
r_if
c_cond
(paren
id|cinergyt2_alloc_stream_urbs
(paren
id|cinergyt2
)paren
OL
l_int|0
)paren
(brace
id|dprintk
c_func
(paren
l_int|1
comma
l_string|&quot;unable to allocate stream urbs&bslash;n&quot;
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|cinergyt2
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|dvb_register_adapter
c_func
(paren
op_amp
id|cinergyt2-&gt;adapter
comma
id|DRIVER_NAME
comma
id|THIS_MODULE
)paren
suffix:semicolon
id|cinergyt2-&gt;demux.priv
op_assign
id|cinergyt2
suffix:semicolon
id|cinergyt2-&gt;demux.filternum
op_assign
l_int|256
suffix:semicolon
id|cinergyt2-&gt;demux.feednum
op_assign
l_int|256
suffix:semicolon
id|cinergyt2-&gt;demux.start_feed
op_assign
id|cinergyt2_start_feed
suffix:semicolon
id|cinergyt2-&gt;demux.stop_feed
op_assign
id|cinergyt2_stop_feed
suffix:semicolon
id|cinergyt2-&gt;demux.dmx.capabilities
op_assign
id|DMX_TS_FILTERING
op_or
id|DMX_SECTION_FILTERING
op_or
id|DMX_MEMORY_BASED_FILTERING
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|dvb_dmx_init
c_func
(paren
op_amp
id|cinergyt2-&gt;demux
)paren
)paren
OL
l_int|0
)paren
(brace
id|dprintk
c_func
(paren
l_int|1
comma
l_string|&quot;dvb_dmx_init() failed (err = %d)&bslash;n&quot;
comma
id|err
)paren
suffix:semicolon
r_goto
id|bailout
suffix:semicolon
)brace
id|cinergyt2-&gt;dmxdev.filternum
op_assign
id|cinergyt2-&gt;demux.filternum
suffix:semicolon
id|cinergyt2-&gt;dmxdev.demux
op_assign
op_amp
id|cinergyt2-&gt;demux.dmx
suffix:semicolon
id|cinergyt2-&gt;dmxdev.capabilities
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|dvb_dmxdev_init
c_func
(paren
op_amp
id|cinergyt2-&gt;dmxdev
comma
id|cinergyt2-&gt;adapter
)paren
)paren
OL
l_int|0
)paren
(brace
id|dprintk
c_func
(paren
l_int|1
comma
l_string|&quot;dvb_dmxdev_init() failed (err = %d)&bslash;n&quot;
comma
id|err
)paren
suffix:semicolon
r_goto
id|bailout
suffix:semicolon
)brace
r_if
c_cond
(paren
id|dvb_net_init
c_func
(paren
id|cinergyt2-&gt;adapter
comma
op_amp
id|cinergyt2-&gt;dvbnet
comma
op_amp
id|cinergyt2-&gt;demux.dmx
)paren
)paren
id|dprintk
c_func
(paren
l_int|1
comma
l_string|&quot;dvb_net_init() failed!&bslash;n&quot;
)paren
suffix:semicolon
id|dvb_register_device
c_func
(paren
id|cinergyt2-&gt;adapter
comma
op_amp
id|cinergyt2-&gt;fedev
comma
op_amp
id|cinergyt2_fe_template
comma
id|cinergyt2
comma
id|DVB_DEVICE_FRONTEND
)paren
suffix:semicolon
macro_line|#ifdef ENABLE_RC
id|init_input_dev
c_func
(paren
op_amp
id|cinergyt2-&gt;rc_input_dev
)paren
suffix:semicolon
id|cinergyt2-&gt;rc_input_dev.evbit
(braket
l_int|0
)braket
op_assign
id|BIT
c_func
(paren
id|EV_KEY
)paren
suffix:semicolon
id|cinergyt2-&gt;rc_input_dev.keycodesize
op_assign
r_sizeof
(paren
r_int
r_char
)paren
suffix:semicolon
id|cinergyt2-&gt;rc_input_dev.keycodemax
op_assign
id|KEY_MAX
suffix:semicolon
id|cinergyt2-&gt;rc_input_dev.name
op_assign
id|DRIVER_NAME
l_string|&quot; remote control&quot;
suffix:semicolon
id|cinergyt2-&gt;rc_input_dev.id.bustype
op_assign
id|BUS_USB
suffix:semicolon
id|cinergyt2-&gt;rc_input_dev.id.vendor
op_assign
l_int|0x0001
suffix:semicolon
id|cinergyt2-&gt;rc_input_dev.id.product
op_assign
l_int|0x0001
suffix:semicolon
id|cinergyt2-&gt;rc_input_dev.id.version
op_assign
l_int|0x0100
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
r_sizeof
(paren
id|rc_keys
)paren
op_div
r_sizeof
(paren
id|rc_keys
(braket
l_int|0
)braket
)paren
suffix:semicolon
id|i
op_add_assign
l_int|3
)paren
id|set_bit
c_func
(paren
id|rc_keys
(braket
id|i
op_plus
l_int|2
)braket
comma
id|cinergyt2-&gt;rc_input_dev.keybit
)paren
suffix:semicolon
id|input_register_device
c_func
(paren
op_amp
id|cinergyt2-&gt;rc_input_dev
)paren
suffix:semicolon
id|cinergyt2-&gt;rc_input_event
op_assign
id|KEY_MAX
suffix:semicolon
id|INIT_WORK
c_func
(paren
op_amp
id|cinergyt2-&gt;rc_query_work
comma
id|cinergyt2_query_rc
comma
id|cinergyt2
)paren
suffix:semicolon
id|schedule_delayed_work
c_func
(paren
op_amp
id|cinergyt2-&gt;rc_query_work
comma
id|HZ
)paren
suffix:semicolon
macro_line|#endif
r_return
l_int|0
suffix:semicolon
id|bailout
suffix:colon
id|dvb_dmxdev_release
c_func
(paren
op_amp
id|cinergyt2-&gt;dmxdev
)paren
suffix:semicolon
id|dvb_dmx_release
c_func
(paren
op_amp
id|cinergyt2-&gt;demux
)paren
suffix:semicolon
id|dvb_unregister_adapter
(paren
id|cinergyt2-&gt;adapter
)paren
suffix:semicolon
id|cinergyt2_free_stream_urbs
(paren
id|cinergyt2
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|cinergyt2
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
DECL|function|cinergyt2_disconnect
r_static
r_void
id|cinergyt2_disconnect
(paren
r_struct
id|usb_interface
op_star
id|intf
)paren
(brace
r_struct
id|cinergyt2
op_star
id|cinergyt2
op_assign
id|usb_get_intfdata
(paren
id|intf
)paren
suffix:semicolon
macro_line|#ifdef ENABLE_RC
id|cancel_delayed_work
c_func
(paren
op_amp
id|cinergyt2-&gt;rc_query_work
)paren
suffix:semicolon
id|flush_scheduled_work
c_func
(paren
)paren
suffix:semicolon
id|input_unregister_device
c_func
(paren
op_amp
id|cinergyt2-&gt;rc_input_dev
)paren
suffix:semicolon
macro_line|#endif
id|cinergyt2-&gt;demux.dmx
dot
id|close
c_func
(paren
op_amp
id|cinergyt2-&gt;demux.dmx
)paren
suffix:semicolon
id|dvb_net_release
c_func
(paren
op_amp
id|cinergyt2-&gt;dvbnet
)paren
suffix:semicolon
id|dvb_dmxdev_release
c_func
(paren
op_amp
id|cinergyt2-&gt;dmxdev
)paren
suffix:semicolon
id|dvb_dmx_release
c_func
(paren
op_amp
id|cinergyt2-&gt;demux
)paren
suffix:semicolon
id|dvb_unregister_device
c_func
(paren
id|cinergyt2-&gt;fedev
)paren
suffix:semicolon
id|dvb_unregister_adapter
c_func
(paren
id|cinergyt2-&gt;adapter
)paren
suffix:semicolon
id|cinergyt2_free_stream_urbs
c_func
(paren
id|cinergyt2
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|cinergyt2
)paren
suffix:semicolon
)brace
DECL|variable|__devinitdata
r_static
r_const
r_struct
id|usb_device_id
id|cinergyt2_table
(braket
)braket
id|__devinitdata
op_assign
(brace
(brace
id|USB_DEVICE
c_func
(paren
l_int|0x0ccd
comma
l_int|0x0038
)paren
)brace
comma
(brace
l_int|0
)brace
)brace
suffix:semicolon
id|MODULE_DEVICE_TABLE
c_func
(paren
id|usb
comma
id|cinergyt2_table
)paren
suffix:semicolon
DECL|variable|cinergyt2_driver
r_static
r_struct
id|usb_driver
id|cinergyt2_driver
op_assign
(brace
dot
id|owner
op_assign
id|THIS_MODULE
comma
dot
id|name
op_assign
l_string|&quot;cinergyt2&quot;
comma
dot
id|probe
op_assign
id|cinergyt2_probe
comma
dot
id|disconnect
op_assign
id|cinergyt2_disconnect
comma
dot
id|id_table
op_assign
id|cinergyt2_table
)brace
suffix:semicolon
DECL|function|cinergyt2_init
r_static
r_int
id|__init
id|cinergyt2_init
(paren
r_void
)paren
(brace
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|usb_register
c_func
(paren
op_amp
id|cinergyt2_driver
)paren
)paren
OL
l_int|0
)paren
(brace
id|dprintk
c_func
(paren
l_int|1
comma
l_string|&quot;usb_register() failed! (err %i)&bslash;n&quot;
comma
id|err
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|cinergyt2_exit
r_static
r_void
id|__exit
id|cinergyt2_exit
(paren
r_void
)paren
(brace
id|usb_deregister
c_func
(paren
op_amp
id|cinergyt2_driver
)paren
suffix:semicolon
)brace
DECL|variable|cinergyt2_init
id|module_init
(paren
id|cinergyt2_init
)paren
suffix:semicolon
DECL|variable|cinergyt2_exit
id|module_exit
(paren
id|cinergyt2_exit
)paren
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
id|MODULE_AUTHOR
c_func
(paren
l_string|&quot;Holger Waechtler, Daniel Mack&quot;
)paren
suffix:semicolon
eof
