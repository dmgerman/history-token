multiline_comment|/*&n; * TTUSB DEC Driver&n; *&n; * Copyright (C) 2003-2004 Alex Woods &lt;linux-dvb@giblets.org&gt;&n; *&n; * This program is free software; you can redistribute it and/or modify&n; * it under the terms of the GNU General Public License as published by&n; * the Free Software Foundation; either version 2 of the License, or&n; * (at your option) any later version.&n; *&n; * This program is distributed in the hope that it will be useful,&n; * but WITHOUT ANY WARRANTY; without even the implied warranty of&n; * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; * GNU General Public License for more details.&n; *&n; * You should have received a copy of the GNU General Public License&n; * along with this program; if not, write to the Free Software&n; * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.&n; *&n; */
macro_line|#include &lt;asm/semaphore.h&gt;
macro_line|#include &lt;linux/list.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/moduleparam.h&gt;
macro_line|#include &lt;linux/pci.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;linux/spinlock.h&gt;
macro_line|#include &lt;linux/usb.h&gt;
macro_line|#include &lt;linux/version.h&gt;
macro_line|#include &lt;linux/interrupt.h&gt;
macro_line|#include &lt;linux/firmware.h&gt;
macro_line|#include &lt;linux/crc32.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &quot;dmxdev.h&quot;
macro_line|#include &quot;dvb_demux.h&quot;
macro_line|#include &quot;dvb_filter.h&quot;
macro_line|#include &quot;dvb_frontend.h&quot;
macro_line|#include &quot;dvb_net.h&quot;
macro_line|#include &quot;ttusbdecfe.h&quot;
DECL|variable|debug
r_static
r_int
id|debug
suffix:semicolon
DECL|variable|output_pva
r_static
r_int
id|output_pva
suffix:semicolon
id|module_param
c_func
(paren
id|debug
comma
r_int
comma
l_int|0644
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|debug
comma
l_string|&quot;Turn on/off debugging (default:off).&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|output_pva
comma
r_int
comma
l_int|0444
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|output_pva
comma
l_string|&quot;Output PVA from dvr device (default:off)&quot;
)paren
suffix:semicolon
DECL|macro|dprintk
mdefine_line|#define dprintk&t;if (debug) printk
DECL|macro|DRIVER_NAME
mdefine_line|#define DRIVER_NAME&t;&t;&quot;TechnoTrend/Hauppauge DEC USB&quot;
DECL|macro|COMMAND_PIPE
mdefine_line|#define COMMAND_PIPE&t;&t;0x03
DECL|macro|RESULT_PIPE
mdefine_line|#define RESULT_PIPE&t;&t;0x84
DECL|macro|IN_PIPE
mdefine_line|#define IN_PIPE&t;&t;&t;0x88
DECL|macro|OUT_PIPE
mdefine_line|#define OUT_PIPE&t;&t;0x07
DECL|macro|COMMAND_PACKET_SIZE
mdefine_line|#define COMMAND_PACKET_SIZE&t;0x3c
DECL|macro|ARM_PACKET_SIZE
mdefine_line|#define ARM_PACKET_SIZE&t;&t;0x1000
DECL|macro|ISO_BUF_COUNT
mdefine_line|#define ISO_BUF_COUNT&t;&t;0x04
DECL|macro|FRAMES_PER_ISO_BUF
mdefine_line|#define FRAMES_PER_ISO_BUF&t;0x04
DECL|macro|ISO_FRAME_SIZE
mdefine_line|#define ISO_FRAME_SIZE&t;&t;0x03FF
DECL|macro|MAX_PVA_LENGTH
mdefine_line|#define&t;MAX_PVA_LENGTH&t;&t;6144
DECL|enum|ttusb_dec_model
r_enum
id|ttusb_dec_model
(brace
DECL|enumerator|TTUSB_DEC2000T
id|TTUSB_DEC2000T
comma
DECL|enumerator|TTUSB_DEC2540T
id|TTUSB_DEC2540T
comma
DECL|enumerator|TTUSB_DEC3000S
id|TTUSB_DEC3000S
)brace
suffix:semicolon
DECL|enum|ttusb_dec_packet_type
r_enum
id|ttusb_dec_packet_type
(brace
DECL|enumerator|TTUSB_DEC_PACKET_PVA
id|TTUSB_DEC_PACKET_PVA
comma
DECL|enumerator|TTUSB_DEC_PACKET_SECTION
id|TTUSB_DEC_PACKET_SECTION
comma
DECL|enumerator|TTUSB_DEC_PACKET_EMPTY
id|TTUSB_DEC_PACKET_EMPTY
)brace
suffix:semicolon
DECL|enum|ttusb_dec_interface
r_enum
id|ttusb_dec_interface
(brace
DECL|enumerator|TTUSB_DEC_INTERFACE_INITIAL
id|TTUSB_DEC_INTERFACE_INITIAL
comma
DECL|enumerator|TTUSB_DEC_INTERFACE_IN
id|TTUSB_DEC_INTERFACE_IN
comma
DECL|enumerator|TTUSB_DEC_INTERFACE_OUT
id|TTUSB_DEC_INTERFACE_OUT
)brace
suffix:semicolon
DECL|struct|ttusb_dec
r_struct
id|ttusb_dec
(brace
DECL|member|model
r_enum
id|ttusb_dec_model
id|model
suffix:semicolon
DECL|member|model_name
r_char
op_star
id|model_name
suffix:semicolon
DECL|member|firmware_name
r_char
op_star
id|firmware_name
suffix:semicolon
DECL|member|can_playback
r_int
id|can_playback
suffix:semicolon
multiline_comment|/* DVB bits */
DECL|member|adapter
r_struct
id|dvb_adapter
op_star
id|adapter
suffix:semicolon
DECL|member|dmxdev
r_struct
id|dmxdev
id|dmxdev
suffix:semicolon
DECL|member|demux
r_struct
id|dvb_demux
id|demux
suffix:semicolon
DECL|member|frontend
r_struct
id|dmx_frontend
id|frontend
suffix:semicolon
DECL|member|dvb_net
r_struct
id|dvb_net
id|dvb_net
suffix:semicolon
DECL|member|fe
r_struct
id|dvb_frontend
op_star
id|fe
suffix:semicolon
DECL|member|pid
id|u16
id|pid
(braket
id|DMX_PES_OTHER
)braket
suffix:semicolon
multiline_comment|/* USB bits */
DECL|member|udev
r_struct
id|usb_device
op_star
id|udev
suffix:semicolon
DECL|member|trans_count
id|u8
id|trans_count
suffix:semicolon
DECL|member|command_pipe
r_int
r_int
id|command_pipe
suffix:semicolon
DECL|member|result_pipe
r_int
r_int
id|result_pipe
suffix:semicolon
DECL|member|in_pipe
r_int
r_int
id|in_pipe
suffix:semicolon
DECL|member|out_pipe
r_int
r_int
id|out_pipe
suffix:semicolon
DECL|member|interface
r_enum
id|ttusb_dec_interface
id|interface
suffix:semicolon
DECL|member|usb_sem
r_struct
id|semaphore
id|usb_sem
suffix:semicolon
DECL|member|iso_buffer
r_void
op_star
id|iso_buffer
suffix:semicolon
DECL|member|iso_dma_handle
id|dma_addr_t
id|iso_dma_handle
suffix:semicolon
DECL|member|iso_urb
r_struct
id|urb
op_star
id|iso_urb
(braket
id|ISO_BUF_COUNT
)braket
suffix:semicolon
DECL|member|iso_stream_count
r_int
id|iso_stream_count
suffix:semicolon
DECL|member|iso_sem
r_struct
id|semaphore
id|iso_sem
suffix:semicolon
DECL|member|packet
id|u8
id|packet
(braket
id|MAX_PVA_LENGTH
op_plus
l_int|4
)braket
suffix:semicolon
DECL|member|packet_type
r_enum
id|ttusb_dec_packet_type
id|packet_type
suffix:semicolon
DECL|member|packet_state
r_int
id|packet_state
suffix:semicolon
DECL|member|packet_length
r_int
id|packet_length
suffix:semicolon
DECL|member|packet_payload_length
r_int
id|packet_payload_length
suffix:semicolon
DECL|member|next_packet_id
id|u16
id|next_packet_id
suffix:semicolon
DECL|member|pva_stream_count
r_int
id|pva_stream_count
suffix:semicolon
DECL|member|filter_stream_count
r_int
id|filter_stream_count
suffix:semicolon
DECL|member|a_pes2ts
r_struct
id|dvb_filter_pes2ts
id|a_pes2ts
suffix:semicolon
DECL|member|v_pes2ts
r_struct
id|dvb_filter_pes2ts
id|v_pes2ts
suffix:semicolon
DECL|member|v_pes
id|u8
id|v_pes
(braket
l_int|16
op_plus
id|MAX_PVA_LENGTH
)braket
suffix:semicolon
DECL|member|v_pes_length
r_int
id|v_pes_length
suffix:semicolon
DECL|member|v_pes_postbytes
r_int
id|v_pes_postbytes
suffix:semicolon
DECL|member|urb_frame_list
r_struct
id|list_head
id|urb_frame_list
suffix:semicolon
DECL|member|urb_tasklet
r_struct
id|tasklet_struct
id|urb_tasklet
suffix:semicolon
DECL|member|urb_frame_list_lock
id|spinlock_t
id|urb_frame_list_lock
suffix:semicolon
DECL|member|audio_filter
r_struct
id|dvb_demux_filter
op_star
id|audio_filter
suffix:semicolon
DECL|member|video_filter
r_struct
id|dvb_demux_filter
op_star
id|video_filter
suffix:semicolon
DECL|member|filter_info_list
r_struct
id|list_head
id|filter_info_list
suffix:semicolon
DECL|member|filter_info_list_lock
id|spinlock_t
id|filter_info_list_lock
suffix:semicolon
DECL|member|active
r_int
id|active
suffix:semicolon
multiline_comment|/* Loaded successfully */
)brace
suffix:semicolon
DECL|struct|urb_frame
r_struct
id|urb_frame
(brace
DECL|member|data
id|u8
id|data
(braket
id|ISO_FRAME_SIZE
)braket
suffix:semicolon
DECL|member|length
r_int
id|length
suffix:semicolon
DECL|member|urb_frame_list
r_struct
id|list_head
id|urb_frame_list
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|filter_info
r_struct
id|filter_info
(brace
DECL|member|stream_id
id|u8
id|stream_id
suffix:semicolon
DECL|member|filter
r_struct
id|dvb_demux_filter
op_star
id|filter
suffix:semicolon
DECL|member|filter_info_list
r_struct
id|list_head
id|filter_info_list
suffix:semicolon
)brace
suffix:semicolon
r_static
r_void
id|ttusb_dec_set_model
c_func
(paren
r_struct
id|ttusb_dec
op_star
id|dec
comma
r_enum
id|ttusb_dec_model
id|model
)paren
suffix:semicolon
DECL|function|crc16
r_static
id|u16
id|crc16
c_func
(paren
id|u16
id|crc
comma
r_const
id|u8
op_star
id|buf
comma
r_int
id|len
)paren
(brace
id|u16
id|tmp
suffix:semicolon
r_while
c_loop
(paren
id|len
op_decrement
)paren
(brace
id|crc
op_xor_assign
op_star
id|buf
op_increment
suffix:semicolon
id|crc
op_xor_assign
(paren
id|u8
)paren
id|crc
op_rshift
l_int|4
suffix:semicolon
id|tmp
op_assign
(paren
id|u8
)paren
id|crc
suffix:semicolon
id|crc
op_xor_assign
(paren
id|tmp
op_xor
(paren
id|tmp
op_lshift
l_int|1
)paren
)paren
op_lshift
l_int|4
suffix:semicolon
)brace
r_return
id|crc
suffix:semicolon
)brace
DECL|function|ttusb_dec_send_command
r_static
r_int
id|ttusb_dec_send_command
c_func
(paren
r_struct
id|ttusb_dec
op_star
id|dec
comma
r_const
id|u8
id|command
comma
r_int
id|param_length
comma
r_const
id|u8
id|params
(braket
)braket
comma
r_int
op_star
id|result_length
comma
id|u8
id|cmd_result
(braket
)braket
)paren
(brace
r_int
id|result
comma
id|actual_len
comma
id|i
suffix:semicolon
id|u8
op_star
id|b
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
id|b
op_assign
id|kmalloc
c_func
(paren
id|COMMAND_PACKET_SIZE
op_plus
l_int|4
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|b
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
r_if
c_cond
(paren
(paren
id|result
op_assign
id|down_interruptible
c_func
(paren
op_amp
id|dec-&gt;usb_sem
)paren
)paren
)paren
(brace
id|kfree
c_func
(paren
id|b
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s: Failed to down usb semaphore.&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
id|b
(braket
l_int|0
)braket
op_assign
l_int|0xaa
suffix:semicolon
id|b
(braket
l_int|1
)braket
op_assign
op_increment
id|dec-&gt;trans_count
suffix:semicolon
id|b
(braket
l_int|2
)braket
op_assign
id|command
suffix:semicolon
id|b
(braket
l_int|3
)braket
op_assign
id|param_length
suffix:semicolon
r_if
c_cond
(paren
id|params
)paren
id|memcpy
c_func
(paren
op_amp
id|b
(braket
l_int|4
)braket
comma
id|params
comma
id|param_length
)paren
suffix:semicolon
r_if
c_cond
(paren
id|debug
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: command: &quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|param_length
op_plus
l_int|4
suffix:semicolon
id|i
op_increment
)paren
id|printk
c_func
(paren
l_string|&quot;0x%02X &quot;
comma
id|b
(braket
id|i
)braket
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
)brace
id|result
op_assign
id|usb_bulk_msg
c_func
(paren
id|dec-&gt;udev
comma
id|dec-&gt;command_pipe
comma
id|b
comma
id|COMMAND_PACKET_SIZE
op_plus
l_int|4
comma
op_amp
id|actual_len
comma
id|HZ
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: command bulk message failed: error %d&bslash;n&quot;
comma
id|__FUNCTION__
comma
id|result
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|dec-&gt;usb_sem
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|b
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
id|result
op_assign
id|usb_bulk_msg
c_func
(paren
id|dec-&gt;udev
comma
id|dec-&gt;result_pipe
comma
id|b
comma
id|COMMAND_PACKET_SIZE
op_plus
l_int|4
comma
op_amp
id|actual_len
comma
id|HZ
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: result bulk message failed: error %d&bslash;n&quot;
comma
id|__FUNCTION__
comma
id|result
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|dec-&gt;usb_sem
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|b
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|debug
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: result: &quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|actual_len
suffix:semicolon
id|i
op_increment
)paren
id|printk
c_func
(paren
l_string|&quot;0x%02X &quot;
comma
id|b
(braket
id|i
)braket
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|result_length
)paren
op_star
id|result_length
op_assign
id|b
(braket
l_int|3
)braket
suffix:semicolon
r_if
c_cond
(paren
id|cmd_result
op_logical_and
id|b
(braket
l_int|3
)braket
OG
l_int|0
)paren
id|memcpy
c_func
(paren
id|cmd_result
comma
op_amp
id|b
(braket
l_int|4
)braket
comma
id|b
(braket
l_int|3
)braket
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|dec-&gt;usb_sem
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|b
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
)brace
DECL|function|ttusb_dec_get_stb_state
r_static
r_int
id|ttusb_dec_get_stb_state
(paren
r_struct
id|ttusb_dec
op_star
id|dec
comma
r_int
r_int
op_star
id|mode
comma
r_int
r_int
op_star
id|model
comma
r_int
r_int
op_star
id|version
)paren
(brace
id|u8
id|c
(braket
id|COMMAND_PACKET_SIZE
)braket
suffix:semicolon
r_int
id|c_length
suffix:semicolon
r_int
id|result
suffix:semicolon
r_int
r_int
id|tmp
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
id|result
op_assign
id|ttusb_dec_send_command
c_func
(paren
id|dec
comma
l_int|0x08
comma
l_int|0
comma
l_int|NULL
comma
op_amp
id|c_length
comma
id|c
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
r_return
id|result
suffix:semicolon
r_if
c_cond
(paren
id|c_length
op_ge
l_int|0x0c
)paren
(brace
r_if
c_cond
(paren
id|mode
op_ne
l_int|NULL
)paren
(brace
id|memcpy
c_func
(paren
op_amp
id|tmp
comma
id|c
comma
l_int|4
)paren
suffix:semicolon
op_star
id|mode
op_assign
id|ntohl
c_func
(paren
id|tmp
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|model
op_ne
l_int|NULL
)paren
(brace
id|memcpy
c_func
(paren
op_amp
id|tmp
comma
op_amp
id|c
(braket
l_int|4
)braket
comma
l_int|4
)paren
suffix:semicolon
op_star
id|model
op_assign
id|ntohl
c_func
(paren
id|tmp
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|version
op_ne
l_int|NULL
)paren
(brace
id|memcpy
c_func
(paren
op_amp
id|tmp
comma
op_amp
id|c
(braket
l_int|8
)braket
comma
l_int|4
)paren
suffix:semicolon
op_star
id|version
op_assign
id|ntohl
c_func
(paren
id|tmp
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
r_else
(brace
r_return
op_minus
l_int|1
suffix:semicolon
)brace
)brace
DECL|function|ttusb_dec_audio_pes2ts_cb
r_static
r_int
id|ttusb_dec_audio_pes2ts_cb
c_func
(paren
r_void
op_star
id|priv
comma
r_int
r_char
op_star
id|data
)paren
(brace
r_struct
id|ttusb_dec
op_star
id|dec
op_assign
(paren
r_struct
id|ttusb_dec
op_star
)paren
id|priv
suffix:semicolon
id|dec-&gt;audio_filter-&gt;feed-&gt;cb
dot
id|ts
c_func
(paren
id|data
comma
l_int|188
comma
l_int|NULL
comma
l_int|0
comma
op_amp
id|dec-&gt;audio_filter-&gt;feed-&gt;feed.ts
comma
id|DMX_OK
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|ttusb_dec_video_pes2ts_cb
r_static
r_int
id|ttusb_dec_video_pes2ts_cb
c_func
(paren
r_void
op_star
id|priv
comma
r_int
r_char
op_star
id|data
)paren
(brace
r_struct
id|ttusb_dec
op_star
id|dec
op_assign
(paren
r_struct
id|ttusb_dec
op_star
)paren
id|priv
suffix:semicolon
id|dec-&gt;video_filter-&gt;feed-&gt;cb
dot
id|ts
c_func
(paren
id|data
comma
l_int|188
comma
l_int|NULL
comma
l_int|0
comma
op_amp
id|dec-&gt;video_filter-&gt;feed-&gt;feed.ts
comma
id|DMX_OK
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|ttusb_dec_set_pids
r_static
r_void
id|ttusb_dec_set_pids
c_func
(paren
r_struct
id|ttusb_dec
op_star
id|dec
)paren
(brace
id|u8
id|b
(braket
)braket
op_assign
(brace
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0xff
comma
l_int|0xff
comma
l_int|0xff
comma
l_int|0xff
comma
l_int|0xff
comma
l_int|0xff
)brace
suffix:semicolon
id|u16
id|pcr
op_assign
id|htons
c_func
(paren
id|dec-&gt;pid
(braket
id|DMX_PES_PCR
)braket
)paren
suffix:semicolon
id|u16
id|audio
op_assign
id|htons
c_func
(paren
id|dec-&gt;pid
(braket
id|DMX_PES_AUDIO
)braket
)paren
suffix:semicolon
id|u16
id|video
op_assign
id|htons
c_func
(paren
id|dec-&gt;pid
(braket
id|DMX_PES_VIDEO
)braket
)paren
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|b
(braket
l_int|0
)braket
comma
op_amp
id|pcr
comma
l_int|2
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|b
(braket
l_int|2
)braket
comma
op_amp
id|audio
comma
l_int|2
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|b
(braket
l_int|4
)braket
comma
op_amp
id|video
comma
l_int|2
)paren
suffix:semicolon
id|ttusb_dec_send_command
c_func
(paren
id|dec
comma
l_int|0x50
comma
r_sizeof
(paren
id|b
)paren
comma
id|b
comma
l_int|NULL
comma
l_int|NULL
)paren
suffix:semicolon
id|dvb_filter_pes2ts_init
c_func
(paren
op_amp
id|dec-&gt;a_pes2ts
comma
id|dec-&gt;pid
(braket
id|DMX_PES_AUDIO
)braket
comma
id|ttusb_dec_audio_pes2ts_cb
comma
id|dec
)paren
suffix:semicolon
id|dvb_filter_pes2ts_init
c_func
(paren
op_amp
id|dec-&gt;v_pes2ts
comma
id|dec-&gt;pid
(braket
id|DMX_PES_VIDEO
)braket
comma
id|ttusb_dec_video_pes2ts_cb
comma
id|dec
)paren
suffix:semicolon
id|dec-&gt;v_pes_length
op_assign
l_int|0
suffix:semicolon
id|dec-&gt;v_pes_postbytes
op_assign
l_int|0
suffix:semicolon
)brace
DECL|function|ttusb_dec_process_pva
r_static
r_void
id|ttusb_dec_process_pva
c_func
(paren
r_struct
id|ttusb_dec
op_star
id|dec
comma
id|u8
op_star
id|pva
comma
r_int
id|length
)paren
(brace
r_if
c_cond
(paren
id|length
OL
l_int|8
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: packet too short - discarding&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|length
OG
l_int|8
op_plus
id|MAX_PVA_LENGTH
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: packet too long - discarding&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|pva
(braket
l_int|2
)braket
)paren
(brace
r_case
l_int|0x01
suffix:colon
(brace
multiline_comment|/* VideoStream */
r_int
id|prebytes
op_assign
id|pva
(braket
l_int|5
)braket
op_amp
l_int|0x03
suffix:semicolon
r_int
id|postbytes
op_assign
(paren
id|pva
(braket
l_int|5
)braket
op_amp
l_int|0x0c
)paren
op_rshift
l_int|2
suffix:semicolon
id|u16
id|v_pes_payload_length
suffix:semicolon
r_if
c_cond
(paren
id|output_pva
)paren
(brace
id|dec-&gt;video_filter-&gt;feed-&gt;cb
dot
id|ts
c_func
(paren
id|pva
comma
id|length
comma
l_int|NULL
comma
l_int|0
comma
op_amp
id|dec-&gt;video_filter-&gt;feed-&gt;feed.ts
comma
id|DMX_OK
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|dec-&gt;v_pes_postbytes
OG
l_int|0
op_logical_and
id|dec-&gt;v_pes_postbytes
op_eq
id|prebytes
)paren
(brace
id|memcpy
c_func
(paren
op_amp
id|dec-&gt;v_pes
(braket
id|dec-&gt;v_pes_length
)braket
comma
op_amp
id|pva
(braket
l_int|12
)braket
comma
id|prebytes
)paren
suffix:semicolon
id|dvb_filter_pes2ts
c_func
(paren
op_amp
id|dec-&gt;v_pes2ts
comma
id|dec-&gt;v_pes
comma
id|dec-&gt;v_pes_length
op_plus
id|prebytes
comma
l_int|1
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|pva
(braket
l_int|5
)braket
op_amp
l_int|0x10
)paren
(brace
id|dec-&gt;v_pes
(braket
l_int|7
)braket
op_assign
l_int|0x80
suffix:semicolon
id|dec-&gt;v_pes
(braket
l_int|8
)braket
op_assign
l_int|0x05
suffix:semicolon
id|dec-&gt;v_pes
(braket
l_int|9
)braket
op_assign
l_int|0x21
op_or
(paren
(paren
id|pva
(braket
l_int|8
)braket
op_amp
l_int|0xc0
)paren
op_rshift
l_int|5
)paren
suffix:semicolon
id|dec-&gt;v_pes
(braket
l_int|10
)braket
op_assign
(paren
(paren
id|pva
(braket
l_int|8
)braket
op_amp
l_int|0x3f
)paren
op_lshift
l_int|2
)paren
op_or
(paren
(paren
id|pva
(braket
l_int|9
)braket
op_amp
l_int|0xc0
)paren
op_rshift
l_int|6
)paren
suffix:semicolon
id|dec-&gt;v_pes
(braket
l_int|11
)braket
op_assign
l_int|0x01
op_or
(paren
(paren
id|pva
(braket
l_int|9
)braket
op_amp
l_int|0x3f
)paren
op_lshift
l_int|2
)paren
op_or
(paren
(paren
id|pva
(braket
l_int|10
)braket
op_amp
l_int|0x80
)paren
op_rshift
l_int|6
)paren
suffix:semicolon
id|dec-&gt;v_pes
(braket
l_int|12
)braket
op_assign
(paren
(paren
id|pva
(braket
l_int|10
)braket
op_amp
l_int|0x7f
)paren
op_lshift
l_int|1
)paren
op_or
(paren
(paren
id|pva
(braket
l_int|11
)braket
op_amp
l_int|0xc0
)paren
op_rshift
l_int|7
)paren
suffix:semicolon
id|dec-&gt;v_pes
(braket
l_int|13
)braket
op_assign
l_int|0x01
op_or
(paren
(paren
id|pva
(braket
l_int|11
)braket
op_amp
l_int|0x7f
)paren
op_lshift
l_int|1
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|dec-&gt;v_pes
(braket
l_int|14
)braket
comma
op_amp
id|pva
(braket
l_int|12
op_plus
id|prebytes
)braket
comma
id|length
op_minus
l_int|12
op_minus
id|prebytes
)paren
suffix:semicolon
id|dec-&gt;v_pes_length
op_assign
l_int|14
op_plus
id|length
op_minus
l_int|12
op_minus
id|prebytes
suffix:semicolon
)brace
r_else
(brace
id|dec-&gt;v_pes
(braket
l_int|7
)braket
op_assign
l_int|0x00
suffix:semicolon
id|dec-&gt;v_pes
(braket
l_int|8
)braket
op_assign
l_int|0x00
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|dec-&gt;v_pes
(braket
l_int|9
)braket
comma
op_amp
id|pva
(braket
l_int|8
)braket
comma
id|length
op_minus
l_int|8
)paren
suffix:semicolon
id|dec-&gt;v_pes_length
op_assign
l_int|9
op_plus
id|length
op_minus
l_int|8
suffix:semicolon
)brace
id|dec-&gt;v_pes_postbytes
op_assign
id|postbytes
suffix:semicolon
r_if
c_cond
(paren
id|dec-&gt;v_pes
(braket
l_int|9
op_plus
id|dec-&gt;v_pes
(braket
l_int|8
)braket
)braket
op_eq
l_int|0x00
op_logical_and
id|dec-&gt;v_pes
(braket
l_int|10
op_plus
id|dec-&gt;v_pes
(braket
l_int|8
)braket
)braket
op_eq
l_int|0x00
op_logical_and
id|dec-&gt;v_pes
(braket
l_int|11
op_plus
id|dec-&gt;v_pes
(braket
l_int|8
)braket
)braket
op_eq
l_int|0x01
)paren
id|dec-&gt;v_pes
(braket
l_int|6
)braket
op_assign
l_int|0x84
suffix:semicolon
r_else
id|dec-&gt;v_pes
(braket
l_int|6
)braket
op_assign
l_int|0x80
suffix:semicolon
id|v_pes_payload_length
op_assign
id|htons
c_func
(paren
id|dec-&gt;v_pes_length
op_minus
l_int|6
op_plus
id|postbytes
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|dec-&gt;v_pes
(braket
l_int|4
)braket
comma
op_amp
id|v_pes_payload_length
comma
l_int|2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|postbytes
op_eq
l_int|0
)paren
id|dvb_filter_pes2ts
c_func
(paren
op_amp
id|dec-&gt;v_pes2ts
comma
id|dec-&gt;v_pes
comma
id|dec-&gt;v_pes_length
comma
l_int|1
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
l_int|0x02
suffix:colon
multiline_comment|/* MainAudioStream */
r_if
c_cond
(paren
id|output_pva
)paren
(brace
id|dec-&gt;audio_filter-&gt;feed-&gt;cb
dot
id|ts
c_func
(paren
id|pva
comma
id|length
comma
l_int|NULL
comma
l_int|0
comma
op_amp
id|dec-&gt;audio_filter-&gt;feed-&gt;feed.ts
comma
id|DMX_OK
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|dvb_filter_pes2ts
c_func
(paren
op_amp
id|dec-&gt;a_pes2ts
comma
op_amp
id|pva
(braket
l_int|8
)braket
comma
id|length
op_minus
l_int|8
comma
id|pva
(braket
l_int|5
)braket
op_amp
l_int|0x10
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|printk
c_func
(paren
l_string|&quot;%s: unknown PVA type: %02x.&bslash;n&quot;
comma
id|__FUNCTION__
comma
id|pva
(braket
l_int|2
)braket
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
DECL|function|ttusb_dec_process_filter
r_static
r_void
id|ttusb_dec_process_filter
c_func
(paren
r_struct
id|ttusb_dec
op_star
id|dec
comma
id|u8
op_star
id|packet
comma
r_int
id|length
)paren
(brace
r_struct
id|list_head
op_star
id|item
suffix:semicolon
r_struct
id|filter_info
op_star
id|finfo
suffix:semicolon
r_struct
id|dvb_demux_filter
op_star
id|filter
op_assign
l_int|NULL
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|u8
id|sid
suffix:semicolon
id|sid
op_assign
id|packet
(braket
l_int|1
)braket
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|dec-&gt;filter_info_list_lock
comma
id|flags
)paren
suffix:semicolon
r_for
c_loop
(paren
id|item
op_assign
id|dec-&gt;filter_info_list.next
suffix:semicolon
id|item
op_ne
op_amp
id|dec-&gt;filter_info_list
suffix:semicolon
id|item
op_assign
id|item-&gt;next
)paren
(brace
id|finfo
op_assign
id|list_entry
c_func
(paren
id|item
comma
r_struct
id|filter_info
comma
id|filter_info_list
)paren
suffix:semicolon
r_if
c_cond
(paren
id|finfo-&gt;stream_id
op_eq
id|sid
)paren
(brace
id|filter
op_assign
id|finfo-&gt;filter
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|dec-&gt;filter_info_list_lock
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|filter
)paren
id|filter-&gt;feed-&gt;cb
dot
id|sec
c_func
(paren
op_amp
id|packet
(braket
l_int|2
)braket
comma
id|length
op_minus
l_int|2
comma
l_int|NULL
comma
l_int|0
comma
op_amp
id|filter-&gt;filter
comma
id|DMX_OK
)paren
suffix:semicolon
)brace
DECL|function|ttusb_dec_process_packet
r_static
r_void
id|ttusb_dec_process_packet
c_func
(paren
r_struct
id|ttusb_dec
op_star
id|dec
)paren
(brace
r_int
id|i
suffix:semicolon
id|u16
id|csum
op_assign
l_int|0
suffix:semicolon
id|u16
id|packet_id
suffix:semicolon
r_if
c_cond
(paren
id|dec-&gt;packet_length
op_mod
l_int|2
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: odd sized packet - discarding&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|dec-&gt;packet_length
suffix:semicolon
id|i
op_add_assign
l_int|2
)paren
id|csum
op_xor_assign
(paren
(paren
id|dec-&gt;packet
(braket
id|i
)braket
op_lshift
l_int|8
)paren
op_plus
id|dec-&gt;packet
(braket
id|i
op_plus
l_int|1
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
id|csum
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: checksum failed - discarding&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|packet_id
op_assign
id|dec-&gt;packet
(braket
id|dec-&gt;packet_length
op_minus
l_int|4
)braket
op_lshift
l_int|8
suffix:semicolon
id|packet_id
op_add_assign
id|dec-&gt;packet
(braket
id|dec-&gt;packet_length
op_minus
l_int|3
)braket
suffix:semicolon
r_if
c_cond
(paren
(paren
id|packet_id
op_ne
id|dec-&gt;next_packet_id
)paren
op_logical_and
id|dec-&gt;next_packet_id
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: warning: lost packets between %u and %u&bslash;n&quot;
comma
id|__FUNCTION__
comma
id|dec-&gt;next_packet_id
op_minus
l_int|1
comma
id|packet_id
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|packet_id
op_eq
l_int|0xffff
)paren
id|dec-&gt;next_packet_id
op_assign
l_int|0x8000
suffix:semicolon
r_else
id|dec-&gt;next_packet_id
op_assign
id|packet_id
op_plus
l_int|1
suffix:semicolon
r_switch
c_cond
(paren
id|dec-&gt;packet_type
)paren
(brace
r_case
id|TTUSB_DEC_PACKET_PVA
suffix:colon
r_if
c_cond
(paren
id|dec-&gt;pva_stream_count
)paren
id|ttusb_dec_process_pva
c_func
(paren
id|dec
comma
id|dec-&gt;packet
comma
id|dec-&gt;packet_payload_length
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|TTUSB_DEC_PACKET_SECTION
suffix:colon
r_if
c_cond
(paren
id|dec-&gt;filter_stream_count
)paren
id|ttusb_dec_process_filter
c_func
(paren
id|dec
comma
id|dec-&gt;packet
comma
id|dec-&gt;packet_payload_length
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|TTUSB_DEC_PACKET_EMPTY
suffix:colon
r_break
suffix:semicolon
)brace
)brace
DECL|function|swap_bytes
r_static
r_void
id|swap_bytes
c_func
(paren
id|u8
op_star
id|b
comma
r_int
id|length
)paren
(brace
id|u8
id|c
suffix:semicolon
id|length
op_sub_assign
id|length
op_mod
l_int|2
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
id|length
suffix:semicolon
id|b
op_add_assign
l_int|2
comma
id|length
op_sub_assign
l_int|2
)paren
(brace
id|c
op_assign
op_star
id|b
suffix:semicolon
op_star
id|b
op_assign
op_star
(paren
id|b
op_plus
l_int|1
)paren
suffix:semicolon
op_star
(paren
id|b
op_plus
l_int|1
)paren
op_assign
id|c
suffix:semicolon
)brace
)brace
DECL|function|ttusb_dec_process_urb_frame
r_static
r_void
id|ttusb_dec_process_urb_frame
c_func
(paren
r_struct
id|ttusb_dec
op_star
id|dec
comma
id|u8
op_star
id|b
comma
r_int
id|length
)paren
(brace
id|swap_bytes
c_func
(paren
id|b
comma
id|length
)paren
suffix:semicolon
r_while
c_loop
(paren
id|length
)paren
(brace
r_switch
c_cond
(paren
id|dec-&gt;packet_state
)paren
(brace
r_case
l_int|0
suffix:colon
r_case
l_int|1
suffix:colon
r_case
l_int|2
suffix:colon
r_if
c_cond
(paren
op_star
id|b
op_increment
op_eq
l_int|0xaa
)paren
id|dec-&gt;packet_state
op_increment
suffix:semicolon
r_else
id|dec-&gt;packet_state
op_assign
l_int|0
suffix:semicolon
id|length
op_decrement
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
r_if
c_cond
(paren
op_star
id|b
op_eq
l_int|0x00
)paren
(brace
id|dec-&gt;packet_state
op_increment
suffix:semicolon
id|dec-&gt;packet_length
op_assign
l_int|0
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_star
id|b
op_ne
l_int|0xaa
)paren
(brace
id|dec-&gt;packet_state
op_assign
l_int|0
suffix:semicolon
)brace
id|b
op_increment
suffix:semicolon
id|length
op_decrement
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|4
suffix:colon
id|dec-&gt;packet
(braket
id|dec-&gt;packet_length
op_increment
)braket
op_assign
op_star
id|b
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|dec-&gt;packet_length
op_eq
l_int|2
)paren
(brace
r_if
c_cond
(paren
id|dec-&gt;packet
(braket
l_int|0
)braket
op_eq
l_char|&squot;A&squot;
op_logical_and
id|dec-&gt;packet
(braket
l_int|1
)braket
op_eq
l_char|&squot;V&squot;
)paren
(brace
id|dec-&gt;packet_type
op_assign
id|TTUSB_DEC_PACKET_PVA
suffix:semicolon
id|dec-&gt;packet_state
op_increment
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|dec-&gt;packet
(braket
l_int|0
)braket
op_eq
l_char|&squot;S&squot;
)paren
(brace
id|dec-&gt;packet_type
op_assign
id|TTUSB_DEC_PACKET_SECTION
suffix:semicolon
id|dec-&gt;packet_state
op_increment
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|dec-&gt;packet
(braket
l_int|0
)braket
op_eq
l_int|0x00
)paren
(brace
id|dec-&gt;packet_type
op_assign
id|TTUSB_DEC_PACKET_EMPTY
suffix:semicolon
id|dec-&gt;packet_payload_length
op_assign
l_int|2
suffix:semicolon
id|dec-&gt;packet_state
op_assign
l_int|7
suffix:semicolon
)brace
r_else
(brace
id|printk
c_func
(paren
l_string|&quot;%s: unknown packet type: &quot;
l_string|&quot;%02x%02x&bslash;n&quot;
comma
id|__FUNCTION__
comma
id|dec-&gt;packet
(braket
l_int|0
)braket
comma
id|dec-&gt;packet
(braket
l_int|1
)braket
)paren
suffix:semicolon
id|dec-&gt;packet_state
op_assign
l_int|0
suffix:semicolon
)brace
)brace
id|length
op_decrement
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|5
suffix:colon
id|dec-&gt;packet
(braket
id|dec-&gt;packet_length
op_increment
)braket
op_assign
op_star
id|b
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|dec-&gt;packet_type
op_eq
id|TTUSB_DEC_PACKET_PVA
op_logical_and
id|dec-&gt;packet_length
op_eq
l_int|8
)paren
(brace
id|dec-&gt;packet_state
op_increment
suffix:semicolon
id|dec-&gt;packet_payload_length
op_assign
l_int|8
op_plus
(paren
id|dec-&gt;packet
(braket
l_int|6
)braket
op_lshift
l_int|8
)paren
op_plus
id|dec-&gt;packet
(braket
l_int|7
)braket
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|dec-&gt;packet_type
op_eq
id|TTUSB_DEC_PACKET_SECTION
op_logical_and
id|dec-&gt;packet_length
op_eq
l_int|5
)paren
(brace
id|dec-&gt;packet_state
op_increment
suffix:semicolon
id|dec-&gt;packet_payload_length
op_assign
l_int|5
op_plus
(paren
(paren
id|dec-&gt;packet
(braket
l_int|3
)braket
op_amp
l_int|0x0f
)paren
op_lshift
l_int|8
)paren
op_plus
id|dec-&gt;packet
(braket
l_int|4
)braket
suffix:semicolon
)brace
id|length
op_decrement
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|6
suffix:colon
(brace
r_int
id|remainder
op_assign
id|dec-&gt;packet_payload_length
op_minus
id|dec-&gt;packet_length
suffix:semicolon
r_if
c_cond
(paren
id|length
op_ge
id|remainder
)paren
(brace
id|memcpy
c_func
(paren
id|dec-&gt;packet
op_plus
id|dec-&gt;packet_length
comma
id|b
comma
id|remainder
)paren
suffix:semicolon
id|dec-&gt;packet_length
op_add_assign
id|remainder
suffix:semicolon
id|b
op_add_assign
id|remainder
suffix:semicolon
id|length
op_sub_assign
id|remainder
suffix:semicolon
id|dec-&gt;packet_state
op_increment
suffix:semicolon
)brace
r_else
(brace
id|memcpy
c_func
(paren
op_amp
id|dec-&gt;packet
(braket
id|dec-&gt;packet_length
)braket
comma
id|b
comma
id|length
)paren
suffix:semicolon
id|dec-&gt;packet_length
op_add_assign
id|length
suffix:semicolon
id|length
op_assign
l_int|0
suffix:semicolon
)brace
r_break
suffix:semicolon
)brace
r_case
l_int|7
suffix:colon
(brace
r_int
id|tail
op_assign
l_int|4
suffix:semicolon
id|dec-&gt;packet
(braket
id|dec-&gt;packet_length
op_increment
)braket
op_assign
op_star
id|b
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|dec-&gt;packet_type
op_eq
id|TTUSB_DEC_PACKET_SECTION
op_logical_and
id|dec-&gt;packet_payload_length
op_mod
l_int|2
)paren
id|tail
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|dec-&gt;packet_length
op_eq
id|dec-&gt;packet_payload_length
op_plus
id|tail
)paren
(brace
id|ttusb_dec_process_packet
c_func
(paren
id|dec
)paren
suffix:semicolon
id|dec-&gt;packet_state
op_assign
l_int|0
suffix:semicolon
)brace
id|length
op_decrement
suffix:semicolon
r_break
suffix:semicolon
)brace
r_default
suffix:colon
id|printk
c_func
(paren
l_string|&quot;%s: illegal packet state encountered.&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
id|dec-&gt;packet_state
op_assign
l_int|0
suffix:semicolon
)brace
)brace
)brace
DECL|function|ttusb_dec_process_urb_frame_list
r_static
r_void
id|ttusb_dec_process_urb_frame_list
c_func
(paren
r_int
r_int
id|data
)paren
(brace
r_struct
id|ttusb_dec
op_star
id|dec
op_assign
(paren
r_struct
id|ttusb_dec
op_star
)paren
id|data
suffix:semicolon
r_struct
id|list_head
op_star
id|item
suffix:semicolon
r_struct
id|urb_frame
op_star
id|frame
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_while
c_loop
(paren
l_int|1
)paren
(brace
id|spin_lock_irqsave
c_func
(paren
op_amp
id|dec-&gt;urb_frame_list_lock
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|item
op_assign
id|dec-&gt;urb_frame_list.next
)paren
op_ne
op_amp
id|dec-&gt;urb_frame_list
)paren
(brace
id|frame
op_assign
id|list_entry
c_func
(paren
id|item
comma
r_struct
id|urb_frame
comma
id|urb_frame_list
)paren
suffix:semicolon
id|list_del
c_func
(paren
op_amp
id|frame-&gt;urb_frame_list
)paren
suffix:semicolon
)brace
r_else
(brace
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|dec-&gt;urb_frame_list_lock
comma
id|flags
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|dec-&gt;urb_frame_list_lock
comma
id|flags
)paren
suffix:semicolon
id|ttusb_dec_process_urb_frame
c_func
(paren
id|dec
comma
id|frame-&gt;data
comma
id|frame-&gt;length
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|frame
)paren
suffix:semicolon
)brace
)brace
DECL|function|ttusb_dec_process_urb
r_static
r_void
id|ttusb_dec_process_urb
c_func
(paren
r_struct
id|urb
op_star
id|urb
comma
r_struct
id|pt_regs
op_star
id|ptregs
)paren
(brace
r_struct
id|ttusb_dec
op_star
id|dec
op_assign
id|urb-&gt;context
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|urb-&gt;status
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|FRAMES_PER_ISO_BUF
suffix:semicolon
id|i
op_increment
)paren
(brace
r_struct
id|usb_iso_packet_descriptor
op_star
id|d
suffix:semicolon
id|u8
op_star
id|b
suffix:semicolon
r_int
id|length
suffix:semicolon
r_struct
id|urb_frame
op_star
id|frame
suffix:semicolon
id|d
op_assign
op_amp
id|urb-&gt;iso_frame_desc
(braket
id|i
)braket
suffix:semicolon
id|b
op_assign
id|urb-&gt;transfer_buffer
op_plus
id|d-&gt;offset
suffix:semicolon
id|length
op_assign
id|d-&gt;actual_length
suffix:semicolon
r_if
c_cond
(paren
(paren
id|frame
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|urb_frame
)paren
comma
id|GFP_ATOMIC
)paren
)paren
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
id|memcpy
c_func
(paren
id|frame-&gt;data
comma
id|b
comma
id|length
)paren
suffix:semicolon
id|frame-&gt;length
op_assign
id|length
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|dec-&gt;urb_frame_list_lock
comma
id|flags
)paren
suffix:semicolon
id|list_add_tail
c_func
(paren
op_amp
id|frame-&gt;urb_frame_list
comma
op_amp
id|dec-&gt;urb_frame_list
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|dec-&gt;urb_frame_list_lock
comma
id|flags
)paren
suffix:semicolon
id|tasklet_schedule
c_func
(paren
op_amp
id|dec-&gt;urb_tasklet
)paren
suffix:semicolon
)brace
)brace
)brace
r_else
(brace
multiline_comment|/* -ENOENT is expected when unlinking urbs */
r_if
c_cond
(paren
id|urb-&gt;status
op_ne
op_minus
id|ENOENT
)paren
id|dprintk
c_func
(paren
l_string|&quot;%s: urb error: %d&bslash;n&quot;
comma
id|__FUNCTION__
comma
id|urb-&gt;status
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|dec-&gt;iso_stream_count
)paren
id|usb_submit_urb
c_func
(paren
id|urb
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
)brace
DECL|function|ttusb_dec_setup_urbs
r_static
r_void
id|ttusb_dec_setup_urbs
c_func
(paren
r_struct
id|ttusb_dec
op_star
id|dec
)paren
(brace
r_int
id|i
comma
id|j
comma
id|buffer_offset
op_assign
l_int|0
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|ISO_BUF_COUNT
suffix:semicolon
id|i
op_increment
)paren
(brace
r_int
id|frame_offset
op_assign
l_int|0
suffix:semicolon
r_struct
id|urb
op_star
id|urb
op_assign
id|dec-&gt;iso_urb
(braket
id|i
)braket
suffix:semicolon
id|urb-&gt;dev
op_assign
id|dec-&gt;udev
suffix:semicolon
id|urb-&gt;context
op_assign
id|dec
suffix:semicolon
id|urb-&gt;complete
op_assign
id|ttusb_dec_process_urb
suffix:semicolon
id|urb-&gt;pipe
op_assign
id|dec-&gt;in_pipe
suffix:semicolon
id|urb-&gt;transfer_flags
op_assign
id|URB_ISO_ASAP
suffix:semicolon
id|urb-&gt;interval
op_assign
l_int|1
suffix:semicolon
id|urb-&gt;number_of_packets
op_assign
id|FRAMES_PER_ISO_BUF
suffix:semicolon
id|urb-&gt;transfer_buffer_length
op_assign
id|ISO_FRAME_SIZE
op_star
id|FRAMES_PER_ISO_BUF
suffix:semicolon
id|urb-&gt;transfer_buffer
op_assign
id|dec-&gt;iso_buffer
op_plus
id|buffer_offset
suffix:semicolon
id|buffer_offset
op_add_assign
id|ISO_FRAME_SIZE
op_star
id|FRAMES_PER_ISO_BUF
suffix:semicolon
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
id|FRAMES_PER_ISO_BUF
suffix:semicolon
id|j
op_increment
)paren
(brace
id|urb-&gt;iso_frame_desc
(braket
id|j
)braket
dot
id|offset
op_assign
id|frame_offset
suffix:semicolon
id|urb-&gt;iso_frame_desc
(braket
id|j
)braket
dot
id|length
op_assign
id|ISO_FRAME_SIZE
suffix:semicolon
id|frame_offset
op_add_assign
id|ISO_FRAME_SIZE
suffix:semicolon
)brace
)brace
)brace
DECL|function|ttusb_dec_stop_iso_xfer
r_static
r_void
id|ttusb_dec_stop_iso_xfer
c_func
(paren
r_struct
id|ttusb_dec
op_star
id|dec
)paren
(brace
r_int
id|i
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_if
c_cond
(paren
id|down_interruptible
c_func
(paren
op_amp
id|dec-&gt;iso_sem
)paren
)paren
r_return
suffix:semicolon
id|dec-&gt;iso_stream_count
op_decrement
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dec-&gt;iso_stream_count
)paren
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|ISO_BUF_COUNT
suffix:semicolon
id|i
op_increment
)paren
id|usb_unlink_urb
c_func
(paren
id|dec-&gt;iso_urb
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
id|up
c_func
(paren
op_amp
id|dec-&gt;iso_sem
)paren
suffix:semicolon
)brace
multiline_comment|/* Setting the interface of the DEC tends to take down the USB communications&n; * for a short period, so it&squot;s important not to call this function just before&n; * trying to talk to it.&n; */
DECL|function|ttusb_dec_set_interface
r_static
r_int
id|ttusb_dec_set_interface
c_func
(paren
r_struct
id|ttusb_dec
op_star
id|dec
comma
r_enum
id|ttusb_dec_interface
id|interface
)paren
(brace
r_int
id|result
op_assign
l_int|0
suffix:semicolon
id|u8
id|b
(braket
)braket
op_assign
(brace
l_int|0x05
)brace
suffix:semicolon
r_if
c_cond
(paren
id|interface
op_ne
id|dec-&gt;interface
)paren
(brace
r_switch
c_cond
(paren
id|interface
)paren
(brace
r_case
id|TTUSB_DEC_INTERFACE_INITIAL
suffix:colon
id|result
op_assign
id|usb_set_interface
c_func
(paren
id|dec-&gt;udev
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|TTUSB_DEC_INTERFACE_IN
suffix:colon
id|result
op_assign
id|ttusb_dec_send_command
c_func
(paren
id|dec
comma
l_int|0x80
comma
r_sizeof
(paren
id|b
)paren
comma
id|b
comma
l_int|NULL
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
r_return
id|result
suffix:semicolon
id|result
op_assign
id|usb_set_interface
c_func
(paren
id|dec-&gt;udev
comma
l_int|0
comma
l_int|7
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|TTUSB_DEC_INTERFACE_OUT
suffix:colon
id|result
op_assign
id|usb_set_interface
c_func
(paren
id|dec-&gt;udev
comma
l_int|0
comma
l_int|1
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|result
)paren
r_return
id|result
suffix:semicolon
id|dec-&gt;interface
op_assign
id|interface
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|ttusb_dec_start_iso_xfer
r_static
r_int
id|ttusb_dec_start_iso_xfer
c_func
(paren
r_struct
id|ttusb_dec
op_star
id|dec
)paren
(brace
r_int
id|i
comma
id|result
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_if
c_cond
(paren
id|down_interruptible
c_func
(paren
op_amp
id|dec-&gt;iso_sem
)paren
)paren
r_return
op_minus
id|EAGAIN
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dec-&gt;iso_stream_count
)paren
(brace
id|ttusb_dec_setup_urbs
c_func
(paren
id|dec
)paren
suffix:semicolon
id|dec-&gt;packet_state
op_assign
l_int|0
suffix:semicolon
id|dec-&gt;v_pes_postbytes
op_assign
l_int|0
suffix:semicolon
id|dec-&gt;next_packet_id
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|ISO_BUF_COUNT
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
(paren
id|result
op_assign
id|usb_submit_urb
c_func
(paren
id|dec-&gt;iso_urb
(braket
id|i
)braket
comma
id|GFP_ATOMIC
)paren
)paren
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: failed urb submission %d: &quot;
l_string|&quot;error %d&bslash;n&quot;
comma
id|__FUNCTION__
comma
id|i
comma
id|result
)paren
suffix:semicolon
r_while
c_loop
(paren
id|i
)paren
(brace
id|usb_unlink_urb
c_func
(paren
id|dec-&gt;iso_urb
(braket
id|i
op_minus
l_int|1
)braket
)paren
suffix:semicolon
id|i
op_decrement
suffix:semicolon
)brace
id|up
c_func
(paren
op_amp
id|dec-&gt;iso_sem
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
)brace
)brace
id|dec-&gt;iso_stream_count
op_increment
suffix:semicolon
id|up
c_func
(paren
op_amp
id|dec-&gt;iso_sem
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|ttusb_dec_start_ts_feed
r_static
r_int
id|ttusb_dec_start_ts_feed
c_func
(paren
r_struct
id|dvb_demux_feed
op_star
id|dvbdmxfeed
)paren
(brace
r_struct
id|dvb_demux
op_star
id|dvbdmx
op_assign
id|dvbdmxfeed-&gt;demux
suffix:semicolon
r_struct
id|ttusb_dec
op_star
id|dec
op_assign
id|dvbdmx-&gt;priv
suffix:semicolon
id|u8
id|b0
(braket
)braket
op_assign
(brace
l_int|0x05
)brace
suffix:semicolon
r_int
id|result
op_assign
l_int|0
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;  ts_type:&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dvbdmxfeed-&gt;ts_type
op_amp
id|TS_DECODER
)paren
id|dprintk
c_func
(paren
l_string|&quot; TS_DECODER&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dvbdmxfeed-&gt;ts_type
op_amp
id|TS_PACKET
)paren
id|dprintk
c_func
(paren
l_string|&quot; TS_PACKET&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dvbdmxfeed-&gt;ts_type
op_amp
id|TS_PAYLOAD_ONLY
)paren
id|dprintk
c_func
(paren
l_string|&quot; TS_PAYLOAD_ONLY&quot;
)paren
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|dvbdmxfeed-&gt;pes_type
)paren
(brace
r_case
id|DMX_TS_PES_VIDEO
suffix:colon
id|dprintk
c_func
(paren
l_string|&quot;  pes_type: DMX_TS_PES_VIDEO&bslash;n&quot;
)paren
suffix:semicolon
id|dec-&gt;pid
(braket
id|DMX_PES_PCR
)braket
op_assign
id|dvbdmxfeed-&gt;pid
suffix:semicolon
id|dec-&gt;pid
(braket
id|DMX_PES_VIDEO
)braket
op_assign
id|dvbdmxfeed-&gt;pid
suffix:semicolon
id|dec-&gt;video_filter
op_assign
id|dvbdmxfeed-&gt;filter
suffix:semicolon
id|ttusb_dec_set_pids
c_func
(paren
id|dec
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|DMX_TS_PES_AUDIO
suffix:colon
id|dprintk
c_func
(paren
l_string|&quot;  pes_type: DMX_TS_PES_AUDIO&bslash;n&quot;
)paren
suffix:semicolon
id|dec-&gt;pid
(braket
id|DMX_PES_AUDIO
)braket
op_assign
id|dvbdmxfeed-&gt;pid
suffix:semicolon
id|dec-&gt;audio_filter
op_assign
id|dvbdmxfeed-&gt;filter
suffix:semicolon
id|ttusb_dec_set_pids
c_func
(paren
id|dec
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|DMX_TS_PES_TELETEXT
suffix:colon
id|dec-&gt;pid
(braket
id|DMX_PES_TELETEXT
)braket
op_assign
id|dvbdmxfeed-&gt;pid
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;  pes_type: DMX_TS_PES_TELETEXT&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|DMX_TS_PES_PCR
suffix:colon
id|dprintk
c_func
(paren
l_string|&quot;  pes_type: DMX_TS_PES_PCR&bslash;n&quot;
)paren
suffix:semicolon
id|dec-&gt;pid
(braket
id|DMX_PES_PCR
)braket
op_assign
id|dvbdmxfeed-&gt;pid
suffix:semicolon
id|ttusb_dec_set_pids
c_func
(paren
id|dec
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|DMX_TS_PES_OTHER
suffix:colon
id|dprintk
c_func
(paren
l_string|&quot;  pes_type: DMX_TS_PES_OTHER&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|dprintk
c_func
(paren
l_string|&quot;  pes_type: unknown (%d)&bslash;n&quot;
comma
id|dvbdmxfeed-&gt;pes_type
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|result
op_assign
id|ttusb_dec_send_command
c_func
(paren
id|dec
comma
l_int|0x80
comma
r_sizeof
(paren
id|b0
)paren
comma
id|b0
comma
l_int|NULL
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
r_return
id|result
suffix:semicolon
id|dec-&gt;pva_stream_count
op_increment
suffix:semicolon
r_return
id|ttusb_dec_start_iso_xfer
c_func
(paren
id|dec
)paren
suffix:semicolon
)brace
DECL|function|ttusb_dec_start_sec_feed
r_static
r_int
id|ttusb_dec_start_sec_feed
c_func
(paren
r_struct
id|dvb_demux_feed
op_star
id|dvbdmxfeed
)paren
(brace
r_struct
id|ttusb_dec
op_star
id|dec
op_assign
id|dvbdmxfeed-&gt;demux-&gt;priv
suffix:semicolon
id|u8
id|b0
(braket
)braket
op_assign
(brace
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x01
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0xff
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
)brace
suffix:semicolon
id|u16
id|pid
suffix:semicolon
id|u8
id|c
(braket
id|COMMAND_PACKET_SIZE
)braket
suffix:semicolon
r_int
id|c_length
suffix:semicolon
r_int
id|result
suffix:semicolon
r_struct
id|filter_info
op_star
id|finfo
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|u8
id|x
op_assign
l_int|1
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
id|pid
op_assign
id|htons
c_func
(paren
id|dvbdmxfeed-&gt;pid
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|b0
(braket
l_int|0
)braket
comma
op_amp
id|pid
comma
l_int|2
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|b0
(braket
l_int|4
)braket
comma
op_amp
id|x
comma
l_int|1
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|b0
(braket
l_int|5
)braket
comma
op_amp
id|dvbdmxfeed-&gt;filter-&gt;filter.filter_value
(braket
l_int|0
)braket
comma
l_int|1
)paren
suffix:semicolon
id|result
op_assign
id|ttusb_dec_send_command
c_func
(paren
id|dec
comma
l_int|0x60
comma
r_sizeof
(paren
id|b0
)paren
comma
id|b0
comma
op_amp
id|c_length
comma
id|c
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|result
)paren
(brace
r_if
c_cond
(paren
id|c_length
op_eq
l_int|2
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|finfo
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|filter_info
)paren
comma
id|GFP_ATOMIC
)paren
)paren
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|finfo-&gt;stream_id
op_assign
id|c
(braket
l_int|1
)braket
suffix:semicolon
id|finfo-&gt;filter
op_assign
id|dvbdmxfeed-&gt;filter
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|dec-&gt;filter_info_list_lock
comma
id|flags
)paren
suffix:semicolon
id|list_add_tail
c_func
(paren
op_amp
id|finfo-&gt;filter_info_list
comma
op_amp
id|dec-&gt;filter_info_list
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|dec-&gt;filter_info_list_lock
comma
id|flags
)paren
suffix:semicolon
id|dvbdmxfeed-&gt;priv
op_assign
id|finfo
suffix:semicolon
id|dec-&gt;filter_stream_count
op_increment
suffix:semicolon
r_return
id|ttusb_dec_start_iso_xfer
c_func
(paren
id|dec
)paren
suffix:semicolon
)brace
r_return
op_minus
id|EAGAIN
suffix:semicolon
)brace
r_else
r_return
id|result
suffix:semicolon
)brace
DECL|function|ttusb_dec_start_feed
r_static
r_int
id|ttusb_dec_start_feed
c_func
(paren
r_struct
id|dvb_demux_feed
op_star
id|dvbdmxfeed
)paren
(brace
r_struct
id|dvb_demux
op_star
id|dvbdmx
op_assign
id|dvbdmxfeed-&gt;demux
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dvbdmx-&gt;dmx.frontend
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;  pid: 0x%04X&bslash;n&quot;
comma
id|dvbdmxfeed-&gt;pid
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|dvbdmxfeed-&gt;type
)paren
(brace
r_case
id|DMX_TYPE_TS
suffix:colon
r_return
id|ttusb_dec_start_ts_feed
c_func
(paren
id|dvbdmxfeed
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|DMX_TYPE_SEC
suffix:colon
r_return
id|ttusb_dec_start_sec_feed
c_func
(paren
id|dvbdmxfeed
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|dprintk
c_func
(paren
l_string|&quot;  type: unknown (%d)&bslash;n&quot;
comma
id|dvbdmxfeed-&gt;type
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
)brace
DECL|function|ttusb_dec_stop_ts_feed
r_static
r_int
id|ttusb_dec_stop_ts_feed
c_func
(paren
r_struct
id|dvb_demux_feed
op_star
id|dvbdmxfeed
)paren
(brace
r_struct
id|ttusb_dec
op_star
id|dec
op_assign
id|dvbdmxfeed-&gt;demux-&gt;priv
suffix:semicolon
id|u8
id|b0
(braket
)braket
op_assign
(brace
l_int|0x00
)brace
suffix:semicolon
id|ttusb_dec_send_command
c_func
(paren
id|dec
comma
l_int|0x81
comma
r_sizeof
(paren
id|b0
)paren
comma
id|b0
comma
l_int|NULL
comma
l_int|NULL
)paren
suffix:semicolon
id|dec-&gt;pva_stream_count
op_decrement
suffix:semicolon
id|ttusb_dec_stop_iso_xfer
c_func
(paren
id|dec
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|ttusb_dec_stop_sec_feed
r_static
r_int
id|ttusb_dec_stop_sec_feed
c_func
(paren
r_struct
id|dvb_demux_feed
op_star
id|dvbdmxfeed
)paren
(brace
r_struct
id|ttusb_dec
op_star
id|dec
op_assign
id|dvbdmxfeed-&gt;demux-&gt;priv
suffix:semicolon
id|u8
id|b0
(braket
)braket
op_assign
(brace
l_int|0x00
comma
l_int|0x00
)brace
suffix:semicolon
r_struct
id|filter_info
op_star
id|finfo
op_assign
(paren
r_struct
id|filter_info
op_star
)paren
id|dvbdmxfeed-&gt;priv
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|b0
(braket
l_int|1
)braket
op_assign
id|finfo-&gt;stream_id
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|dec-&gt;filter_info_list_lock
comma
id|flags
)paren
suffix:semicolon
id|list_del
c_func
(paren
op_amp
id|finfo-&gt;filter_info_list
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|dec-&gt;filter_info_list_lock
comma
id|flags
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|finfo
)paren
suffix:semicolon
id|ttusb_dec_send_command
c_func
(paren
id|dec
comma
l_int|0x62
comma
r_sizeof
(paren
id|b0
)paren
comma
id|b0
comma
l_int|NULL
comma
l_int|NULL
)paren
suffix:semicolon
id|dec-&gt;filter_stream_count
op_decrement
suffix:semicolon
id|ttusb_dec_stop_iso_xfer
c_func
(paren
id|dec
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|ttusb_dec_stop_feed
r_static
r_int
id|ttusb_dec_stop_feed
c_func
(paren
r_struct
id|dvb_demux_feed
op_star
id|dvbdmxfeed
)paren
(brace
id|dprintk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|dvbdmxfeed-&gt;type
)paren
(brace
r_case
id|DMX_TYPE_TS
suffix:colon
r_return
id|ttusb_dec_stop_ts_feed
c_func
(paren
id|dvbdmxfeed
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|DMX_TYPE_SEC
suffix:colon
r_return
id|ttusb_dec_stop_sec_feed
c_func
(paren
id|dvbdmxfeed
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|ttusb_dec_free_iso_urbs
r_static
r_void
id|ttusb_dec_free_iso_urbs
c_func
(paren
r_struct
id|ttusb_dec
op_star
id|dec
)paren
(brace
r_int
id|i
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|ISO_BUF_COUNT
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|dec-&gt;iso_urb
(braket
id|i
)braket
)paren
id|usb_free_urb
c_func
(paren
id|dec-&gt;iso_urb
(braket
id|i
)braket
)paren
suffix:semicolon
id|pci_free_consistent
c_func
(paren
l_int|NULL
comma
id|ISO_FRAME_SIZE
op_star
(paren
id|FRAMES_PER_ISO_BUF
op_star
id|ISO_BUF_COUNT
)paren
comma
id|dec-&gt;iso_buffer
comma
id|dec-&gt;iso_dma_handle
)paren
suffix:semicolon
)brace
DECL|function|ttusb_dec_alloc_iso_urbs
r_static
r_int
id|ttusb_dec_alloc_iso_urbs
c_func
(paren
r_struct
id|ttusb_dec
op_star
id|dec
)paren
(brace
r_int
id|i
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
id|dec-&gt;iso_buffer
op_assign
id|pci_alloc_consistent
c_func
(paren
l_int|NULL
comma
id|ISO_FRAME_SIZE
op_star
(paren
id|FRAMES_PER_ISO_BUF
op_star
id|ISO_BUF_COUNT
)paren
comma
op_amp
id|dec-&gt;iso_dma_handle
)paren
suffix:semicolon
id|memset
c_func
(paren
id|dec-&gt;iso_buffer
comma
l_int|0
comma
id|ISO_FRAME_SIZE
op_star
(paren
id|FRAMES_PER_ISO_BUF
op_star
id|ISO_BUF_COUNT
)paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|ISO_BUF_COUNT
suffix:semicolon
id|i
op_increment
)paren
(brace
r_struct
id|urb
op_star
id|urb
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|urb
op_assign
id|usb_alloc_urb
c_func
(paren
id|FRAMES_PER_ISO_BUF
comma
id|GFP_ATOMIC
)paren
)paren
)paren
(brace
id|ttusb_dec_free_iso_urbs
c_func
(paren
id|dec
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|dec-&gt;iso_urb
(braket
id|i
)braket
op_assign
id|urb
suffix:semicolon
)brace
id|ttusb_dec_setup_urbs
c_func
(paren
id|dec
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|ttusb_dec_init_tasklet
r_static
r_void
id|ttusb_dec_init_tasklet
c_func
(paren
r_struct
id|ttusb_dec
op_star
id|dec
)paren
(brace
id|spin_lock_init
c_func
(paren
op_amp
id|dec-&gt;urb_frame_list_lock
)paren
suffix:semicolon
id|INIT_LIST_HEAD
c_func
(paren
op_amp
id|dec-&gt;urb_frame_list
)paren
suffix:semicolon
id|tasklet_init
c_func
(paren
op_amp
id|dec-&gt;urb_tasklet
comma
id|ttusb_dec_process_urb_frame_list
comma
(paren
r_int
r_int
)paren
id|dec
)paren
suffix:semicolon
)brace
DECL|function|ttusb_dec_init_v_pes
r_static
r_void
id|ttusb_dec_init_v_pes
c_func
(paren
r_struct
id|ttusb_dec
op_star
id|dec
)paren
(brace
id|dprintk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
id|dec-&gt;v_pes
(braket
l_int|0
)braket
op_assign
l_int|0x00
suffix:semicolon
id|dec-&gt;v_pes
(braket
l_int|1
)braket
op_assign
l_int|0x00
suffix:semicolon
id|dec-&gt;v_pes
(braket
l_int|2
)braket
op_assign
l_int|0x01
suffix:semicolon
id|dec-&gt;v_pes
(braket
l_int|3
)braket
op_assign
l_int|0xe0
suffix:semicolon
)brace
DECL|function|ttusb_dec_init_usb
r_static
r_void
id|ttusb_dec_init_usb
c_func
(paren
r_struct
id|ttusb_dec
op_star
id|dec
)paren
(brace
id|dprintk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
id|sema_init
c_func
(paren
op_amp
id|dec-&gt;usb_sem
comma
l_int|1
)paren
suffix:semicolon
id|sema_init
c_func
(paren
op_amp
id|dec-&gt;iso_sem
comma
l_int|1
)paren
suffix:semicolon
id|dec-&gt;command_pipe
op_assign
id|usb_sndbulkpipe
c_func
(paren
id|dec-&gt;udev
comma
id|COMMAND_PIPE
)paren
suffix:semicolon
id|dec-&gt;result_pipe
op_assign
id|usb_rcvbulkpipe
c_func
(paren
id|dec-&gt;udev
comma
id|RESULT_PIPE
)paren
suffix:semicolon
id|dec-&gt;in_pipe
op_assign
id|usb_rcvisocpipe
c_func
(paren
id|dec-&gt;udev
comma
id|IN_PIPE
)paren
suffix:semicolon
id|dec-&gt;out_pipe
op_assign
id|usb_sndisocpipe
c_func
(paren
id|dec-&gt;udev
comma
id|OUT_PIPE
)paren
suffix:semicolon
id|ttusb_dec_alloc_iso_urbs
c_func
(paren
id|dec
)paren
suffix:semicolon
)brace
DECL|function|ttusb_dec_boot_dsp
r_static
r_int
id|ttusb_dec_boot_dsp
c_func
(paren
r_struct
id|ttusb_dec
op_star
id|dec
)paren
(brace
r_int
id|i
comma
id|j
comma
id|actual_len
comma
id|result
comma
id|size
comma
id|trans_count
suffix:semicolon
id|u8
id|b0
(braket
)braket
op_assign
(brace
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x61
comma
l_int|0x00
)brace
suffix:semicolon
id|u8
id|b1
(braket
)braket
op_assign
(brace
l_int|0x61
)brace
suffix:semicolon
id|u8
op_star
id|b
suffix:semicolon
r_char
id|idstring
(braket
l_int|21
)braket
suffix:semicolon
id|u8
op_star
id|firmware
op_assign
l_int|NULL
suffix:semicolon
r_int
id|firmware_size
op_assign
l_int|0
suffix:semicolon
id|u16
id|firmware_csum
op_assign
l_int|0
suffix:semicolon
id|u16
id|firmware_csum_ns
suffix:semicolon
id|u32
id|firmware_size_nl
suffix:semicolon
id|u32
id|crc32_csum
comma
id|crc32_check
comma
id|tmp
suffix:semicolon
r_const
r_struct
id|firmware
op_star
id|fw_entry
op_assign
l_int|NULL
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_if
c_cond
(paren
id|request_firmware
c_func
(paren
op_amp
id|fw_entry
comma
id|dec-&gt;firmware_name
comma
op_amp
id|dec-&gt;udev-&gt;dev
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;%s: Firmware (%s) unavailable.&bslash;n&quot;
comma
id|__FUNCTION__
comma
id|dec-&gt;firmware_name
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
id|firmware
op_assign
id|fw_entry-&gt;data
suffix:semicolon
id|firmware_size
op_assign
id|fw_entry-&gt;size
suffix:semicolon
r_if
c_cond
(paren
id|firmware_size
OL
l_int|60
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: firmware size too small for DSP code (%zu &lt; 60).&bslash;n&quot;
comma
id|__FUNCTION__
comma
id|firmware_size
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
multiline_comment|/* a 32 bit checksum over the first 56 bytes of the DSP Code is stored&n;&t;   at offset 56 of file, so use it to check if the firmware file is&n;&t;   valid. */
id|crc32_csum
op_assign
id|crc32
c_func
(paren
op_complement
l_int|0L
comma
id|firmware
comma
l_int|56
)paren
op_xor
op_complement
l_int|0L
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|tmp
comma
op_amp
id|firmware
(braket
l_int|56
)braket
comma
l_int|4
)paren
suffix:semicolon
id|crc32_check
op_assign
id|htonl
c_func
(paren
id|tmp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|crc32_csum
op_ne
id|crc32_check
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: crc32 check of DSP code failed (calculated &quot;
l_string|&quot;0x%08x != 0x%08x in file), file invalid.&bslash;n&quot;
comma
id|__FUNCTION__
comma
id|crc32_csum
comma
id|crc32_check
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|idstring
comma
op_amp
id|firmware
(braket
l_int|36
)braket
comma
l_int|20
)paren
suffix:semicolon
id|idstring
(braket
l_int|20
)braket
op_assign
l_char|&squot;&bslash;0&squot;
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;ttusb_dec: found DSP code &bslash;&quot;%s&bslash;&quot;.&bslash;n&quot;
comma
id|idstring
)paren
suffix:semicolon
id|firmware_size_nl
op_assign
id|htonl
c_func
(paren
id|firmware_size
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|b0
comma
op_amp
id|firmware_size_nl
comma
l_int|4
)paren
suffix:semicolon
id|firmware_csum
op_assign
id|crc16
c_func
(paren
op_complement
l_int|0
comma
id|firmware
comma
id|firmware_size
)paren
op_xor
op_complement
l_int|0
suffix:semicolon
id|firmware_csum_ns
op_assign
id|htons
c_func
(paren
id|firmware_csum
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|b0
(braket
l_int|6
)braket
comma
op_amp
id|firmware_csum_ns
comma
l_int|2
)paren
suffix:semicolon
id|result
op_assign
id|ttusb_dec_send_command
c_func
(paren
id|dec
comma
l_int|0x41
comma
r_sizeof
(paren
id|b0
)paren
comma
id|b0
comma
l_int|NULL
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
r_return
id|result
suffix:semicolon
id|trans_count
op_assign
l_int|0
suffix:semicolon
id|j
op_assign
l_int|0
suffix:semicolon
id|b
op_assign
id|kmalloc
c_func
(paren
id|ARM_PACKET_SIZE
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|b
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|firmware_size
suffix:semicolon
id|i
op_add_assign
id|COMMAND_PACKET_SIZE
)paren
(brace
id|size
op_assign
id|firmware_size
op_minus
id|i
suffix:semicolon
r_if
c_cond
(paren
id|size
OG
id|COMMAND_PACKET_SIZE
)paren
id|size
op_assign
id|COMMAND_PACKET_SIZE
suffix:semicolon
id|b
(braket
id|j
op_plus
l_int|0
)braket
op_assign
l_int|0xaa
suffix:semicolon
id|b
(braket
id|j
op_plus
l_int|1
)braket
op_assign
id|trans_count
op_increment
suffix:semicolon
id|b
(braket
id|j
op_plus
l_int|2
)braket
op_assign
l_int|0xf0
suffix:semicolon
id|b
(braket
id|j
op_plus
l_int|3
)braket
op_assign
id|size
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|b
(braket
id|j
op_plus
l_int|4
)braket
comma
op_amp
id|firmware
(braket
id|i
)braket
comma
id|size
)paren
suffix:semicolon
id|j
op_add_assign
id|COMMAND_PACKET_SIZE
op_plus
l_int|4
suffix:semicolon
r_if
c_cond
(paren
id|j
op_ge
id|ARM_PACKET_SIZE
)paren
(brace
id|result
op_assign
id|usb_bulk_msg
c_func
(paren
id|dec-&gt;udev
comma
id|dec-&gt;command_pipe
comma
id|b
comma
id|ARM_PACKET_SIZE
comma
op_amp
id|actual_len
comma
id|HZ
op_div
l_int|10
)paren
suffix:semicolon
id|j
op_assign
l_int|0
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|size
OL
id|COMMAND_PACKET_SIZE
)paren
(brace
id|result
op_assign
id|usb_bulk_msg
c_func
(paren
id|dec-&gt;udev
comma
id|dec-&gt;command_pipe
comma
id|b
comma
id|j
op_minus
id|COMMAND_PACKET_SIZE
op_plus
id|size
comma
op_amp
id|actual_len
comma
id|HZ
op_div
l_int|10
)paren
suffix:semicolon
)brace
)brace
id|result
op_assign
id|ttusb_dec_send_command
c_func
(paren
id|dec
comma
l_int|0x43
comma
r_sizeof
(paren
id|b1
)paren
comma
id|b1
comma
l_int|NULL
comma
l_int|NULL
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|b
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
DECL|function|ttusb_dec_init_stb
r_static
r_int
id|ttusb_dec_init_stb
c_func
(paren
r_struct
id|ttusb_dec
op_star
id|dec
)paren
(brace
r_int
id|result
suffix:semicolon
r_int
r_int
id|mode
comma
id|model
comma
id|version
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
id|result
op_assign
id|ttusb_dec_get_stb_state
c_func
(paren
id|dec
comma
op_amp
id|mode
comma
op_amp
id|model
comma
op_amp
id|version
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|result
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|mode
)paren
(brace
r_if
c_cond
(paren
id|version
op_eq
l_int|0xABCDEFAB
)paren
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;ttusb_dec: no version &quot;
l_string|&quot;info in Firmware&bslash;n&quot;
)paren
suffix:semicolon
r_else
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;ttusb_dec: Firmware &quot;
l_string|&quot;%x.%02x%c%c&bslash;n&quot;
comma
id|version
op_rshift
l_int|24
comma
(paren
id|version
op_rshift
l_int|16
)paren
op_amp
l_int|0xff
comma
(paren
id|version
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
comma
id|version
op_amp
l_int|0xff
)paren
suffix:semicolon
id|result
op_assign
id|ttusb_dec_boot_dsp
c_func
(paren
id|dec
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
r_return
id|result
suffix:semicolon
r_else
r_return
l_int|1
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* We can&squot;t trust the USB IDs that some firmwares&n;&t;&t;&t;   give the box */
r_switch
c_cond
(paren
id|model
)paren
(brace
r_case
l_int|0x00070008
suffix:colon
r_case
l_int|0x0007000c
suffix:colon
id|ttusb_dec_set_model
c_func
(paren
id|dec
comma
id|TTUSB_DEC3000S
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x00070009
suffix:colon
r_case
l_int|0x00070013
suffix:colon
id|ttusb_dec_set_model
c_func
(paren
id|dec
comma
id|TTUSB_DEC2000T
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x00070011
suffix:colon
id|ttusb_dec_set_model
c_func
(paren
id|dec
comma
id|TTUSB_DEC2540T
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;%s: unknown model returned &quot;
l_string|&quot;by firmware (%08x) - please report&bslash;n&quot;
comma
id|__FUNCTION__
comma
id|model
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|version
op_ge
l_int|0x01770000
)paren
id|dec-&gt;can_playback
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
)brace
r_else
r_return
id|result
suffix:semicolon
)brace
DECL|function|ttusb_dec_init_dvb
r_static
r_int
id|ttusb_dec_init_dvb
c_func
(paren
r_struct
id|ttusb_dec
op_star
id|dec
)paren
(brace
r_int
id|result
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|result
op_assign
id|dvb_register_adapter
c_func
(paren
op_amp
id|dec-&gt;adapter
comma
id|dec-&gt;model_name
comma
id|THIS_MODULE
)paren
)paren
OL
l_int|0
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: dvb_register_adapter failed: error %d&bslash;n&quot;
comma
id|__FUNCTION__
comma
id|result
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
id|dec-&gt;demux.dmx.capabilities
op_assign
id|DMX_TS_FILTERING
op_or
id|DMX_SECTION_FILTERING
suffix:semicolon
id|dec-&gt;demux.priv
op_assign
(paren
r_void
op_star
)paren
id|dec
suffix:semicolon
id|dec-&gt;demux.filternum
op_assign
l_int|31
suffix:semicolon
id|dec-&gt;demux.feednum
op_assign
l_int|31
suffix:semicolon
id|dec-&gt;demux.start_feed
op_assign
id|ttusb_dec_start_feed
suffix:semicolon
id|dec-&gt;demux.stop_feed
op_assign
id|ttusb_dec_stop_feed
suffix:semicolon
id|dec-&gt;demux.write_to_decoder
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
(paren
id|result
op_assign
id|dvb_dmx_init
c_func
(paren
op_amp
id|dec-&gt;demux
)paren
)paren
OL
l_int|0
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: dvb_dmx_init failed: error %d&bslash;n&quot;
comma
id|__FUNCTION__
comma
id|result
)paren
suffix:semicolon
id|dvb_unregister_adapter
c_func
(paren
id|dec-&gt;adapter
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
id|dec-&gt;dmxdev.filternum
op_assign
l_int|32
suffix:semicolon
id|dec-&gt;dmxdev.demux
op_assign
op_amp
id|dec-&gt;demux.dmx
suffix:semicolon
id|dec-&gt;dmxdev.capabilities
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
(paren
id|result
op_assign
id|dvb_dmxdev_init
c_func
(paren
op_amp
id|dec-&gt;dmxdev
comma
id|dec-&gt;adapter
)paren
)paren
OL
l_int|0
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: dvb_dmxdev_init failed: error %d&bslash;n&quot;
comma
id|__FUNCTION__
comma
id|result
)paren
suffix:semicolon
id|dvb_dmx_release
c_func
(paren
op_amp
id|dec-&gt;demux
)paren
suffix:semicolon
id|dvb_unregister_adapter
c_func
(paren
id|dec-&gt;adapter
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
id|dec-&gt;frontend.source
op_assign
id|DMX_FRONTEND_0
suffix:semicolon
r_if
c_cond
(paren
(paren
id|result
op_assign
id|dec-&gt;demux.dmx
dot
id|add_frontend
c_func
(paren
op_amp
id|dec-&gt;demux.dmx
comma
op_amp
id|dec-&gt;frontend
)paren
)paren
OL
l_int|0
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: dvb_dmx_init failed: error %d&bslash;n&quot;
comma
id|__FUNCTION__
comma
id|result
)paren
suffix:semicolon
id|dvb_dmxdev_release
c_func
(paren
op_amp
id|dec-&gt;dmxdev
)paren
suffix:semicolon
id|dvb_dmx_release
c_func
(paren
op_amp
id|dec-&gt;demux
)paren
suffix:semicolon
id|dvb_unregister_adapter
c_func
(paren
id|dec-&gt;adapter
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|result
op_assign
id|dec-&gt;demux.dmx
dot
id|connect_frontend
c_func
(paren
op_amp
id|dec-&gt;demux.dmx
comma
op_amp
id|dec-&gt;frontend
)paren
)paren
OL
l_int|0
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: dvb_dmx_init failed: error %d&bslash;n&quot;
comma
id|__FUNCTION__
comma
id|result
)paren
suffix:semicolon
id|dec-&gt;demux.dmx
dot
id|remove_frontend
c_func
(paren
op_amp
id|dec-&gt;demux.dmx
comma
op_amp
id|dec-&gt;frontend
)paren
suffix:semicolon
id|dvb_dmxdev_release
c_func
(paren
op_amp
id|dec-&gt;dmxdev
)paren
suffix:semicolon
id|dvb_dmx_release
c_func
(paren
op_amp
id|dec-&gt;demux
)paren
suffix:semicolon
id|dvb_unregister_adapter
c_func
(paren
id|dec-&gt;adapter
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
id|dvb_net_init
c_func
(paren
id|dec-&gt;adapter
comma
op_amp
id|dec-&gt;dvb_net
comma
op_amp
id|dec-&gt;demux.dmx
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|ttusb_dec_exit_dvb
r_static
r_void
id|ttusb_dec_exit_dvb
c_func
(paren
r_struct
id|ttusb_dec
op_star
id|dec
)paren
(brace
id|dprintk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
id|dvb_net_release
c_func
(paren
op_amp
id|dec-&gt;dvb_net
)paren
suffix:semicolon
id|dec-&gt;demux.dmx
dot
id|close
c_func
(paren
op_amp
id|dec-&gt;demux.dmx
)paren
suffix:semicolon
id|dec-&gt;demux.dmx
dot
id|remove_frontend
c_func
(paren
op_amp
id|dec-&gt;demux.dmx
comma
op_amp
id|dec-&gt;frontend
)paren
suffix:semicolon
id|dvb_dmxdev_release
c_func
(paren
op_amp
id|dec-&gt;dmxdev
)paren
suffix:semicolon
id|dvb_dmx_release
c_func
(paren
op_amp
id|dec-&gt;demux
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dec-&gt;fe
)paren
id|dvb_unregister_frontend
c_func
(paren
id|dec-&gt;fe
)paren
suffix:semicolon
id|dvb_unregister_adapter
c_func
(paren
id|dec-&gt;adapter
)paren
suffix:semicolon
)brace
DECL|function|ttusb_dec_exit_usb
r_static
r_void
id|ttusb_dec_exit_usb
c_func
(paren
r_struct
id|ttusb_dec
op_star
id|dec
)paren
(brace
r_int
id|i
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
id|dec-&gt;iso_stream_count
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|ISO_BUF_COUNT
suffix:semicolon
id|i
op_increment
)paren
id|usb_unlink_urb
c_func
(paren
id|dec-&gt;iso_urb
(braket
id|i
)braket
)paren
suffix:semicolon
id|ttusb_dec_free_iso_urbs
c_func
(paren
id|dec
)paren
suffix:semicolon
)brace
DECL|function|ttusb_dec_exit_tasklet
r_static
r_void
id|ttusb_dec_exit_tasklet
c_func
(paren
r_struct
id|ttusb_dec
op_star
id|dec
)paren
(brace
r_struct
id|list_head
op_star
id|item
suffix:semicolon
r_struct
id|urb_frame
op_star
id|frame
suffix:semicolon
id|tasklet_kill
c_func
(paren
op_amp
id|dec-&gt;urb_tasklet
)paren
suffix:semicolon
r_while
c_loop
(paren
(paren
id|item
op_assign
id|dec-&gt;urb_frame_list.next
)paren
op_ne
op_amp
id|dec-&gt;urb_frame_list
)paren
(brace
id|frame
op_assign
id|list_entry
c_func
(paren
id|item
comma
r_struct
id|urb_frame
comma
id|urb_frame_list
)paren
suffix:semicolon
id|list_del
c_func
(paren
op_amp
id|frame-&gt;urb_frame_list
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|frame
)paren
suffix:semicolon
)brace
)brace
DECL|function|ttusb_dec_init_filters
r_static
r_void
id|ttusb_dec_init_filters
c_func
(paren
r_struct
id|ttusb_dec
op_star
id|dec
)paren
(brace
id|INIT_LIST_HEAD
c_func
(paren
op_amp
id|dec-&gt;filter_info_list
)paren
suffix:semicolon
id|spin_lock_init
c_func
(paren
op_amp
id|dec-&gt;filter_info_list_lock
)paren
suffix:semicolon
)brace
DECL|function|ttusb_dec_exit_filters
r_static
r_void
id|ttusb_dec_exit_filters
c_func
(paren
r_struct
id|ttusb_dec
op_star
id|dec
)paren
(brace
r_struct
id|list_head
op_star
id|item
suffix:semicolon
r_struct
id|filter_info
op_star
id|finfo
suffix:semicolon
r_while
c_loop
(paren
(paren
id|item
op_assign
id|dec-&gt;filter_info_list.next
)paren
op_ne
op_amp
id|dec-&gt;filter_info_list
)paren
(brace
id|finfo
op_assign
id|list_entry
c_func
(paren
id|item
comma
r_struct
id|filter_info
comma
id|filter_info_list
)paren
suffix:semicolon
id|list_del
c_func
(paren
op_amp
id|finfo-&gt;filter_info_list
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|finfo
)paren
suffix:semicolon
)brace
)brace
DECL|function|fe_send_command
r_int
id|fe_send_command
c_func
(paren
r_struct
id|dvb_frontend
op_star
id|fe
comma
r_const
id|u8
id|command
comma
r_int
id|param_length
comma
r_const
id|u8
id|params
(braket
)braket
comma
r_int
op_star
id|result_length
comma
id|u8
id|cmd_result
(braket
)braket
)paren
(brace
r_struct
id|ttusb_dec
op_star
id|dec
op_assign
(paren
r_struct
id|ttusb_dec
op_star
)paren
id|fe-&gt;dvb-&gt;priv
suffix:semicolon
r_return
id|ttusb_dec_send_command
c_func
(paren
id|dec
comma
id|command
comma
id|param_length
comma
id|params
comma
id|result_length
comma
id|cmd_result
)paren
suffix:semicolon
)brace
DECL|variable|fe_config
r_struct
id|ttusbdecfe_config
id|fe_config
op_assign
(brace
dot
id|send_command
op_assign
id|fe_send_command
)brace
suffix:semicolon
DECL|function|ttusb_dec_probe
r_static
r_int
id|ttusb_dec_probe
c_func
(paren
r_struct
id|usb_interface
op_star
id|intf
comma
r_const
r_struct
id|usb_device_id
op_star
id|id
)paren
(brace
r_struct
id|usb_device
op_star
id|udev
suffix:semicolon
r_struct
id|ttusb_dec
op_star
id|dec
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
id|udev
op_assign
id|interface_to_usbdev
c_func
(paren
id|intf
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|dec
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|ttusb_dec
)paren
comma
id|GFP_KERNEL
)paren
)paren
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: couldn&squot;t allocate memory.&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|usb_set_intfdata
c_func
(paren
id|intf
comma
(paren
r_void
op_star
)paren
id|dec
)paren
suffix:semicolon
id|memset
c_func
(paren
id|dec
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|ttusb_dec
)paren
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|le16_to_cpu
c_func
(paren
id|id-&gt;idProduct
)paren
)paren
(brace
r_case
l_int|0x1006
suffix:colon
id|ttusb_dec_set_model
c_func
(paren
id|dec
comma
id|TTUSB_DEC3000S
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x1008
suffix:colon
id|ttusb_dec_set_model
c_func
(paren
id|dec
comma
id|TTUSB_DEC2000T
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x1009
suffix:colon
id|ttusb_dec_set_model
c_func
(paren
id|dec
comma
id|TTUSB_DEC2540T
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|dec-&gt;udev
op_assign
id|udev
suffix:semicolon
id|ttusb_dec_init_usb
c_func
(paren
id|dec
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ttusb_dec_init_stb
c_func
(paren
id|dec
)paren
)paren
(brace
id|ttusb_dec_exit_usb
c_func
(paren
id|dec
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|ttusb_dec_init_dvb
c_func
(paren
id|dec
)paren
suffix:semicolon
id|dec-&gt;adapter-&gt;priv
op_assign
id|dec
suffix:semicolon
r_switch
c_cond
(paren
id|le16_to_cpu
c_func
(paren
id|id-&gt;idProduct
)paren
)paren
(brace
r_case
l_int|0x1006
suffix:colon
id|dec-&gt;fe
op_assign
id|ttusbdecfe_dvbs_attach
c_func
(paren
op_amp
id|fe_config
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x1008
suffix:colon
r_case
l_int|0x1009
suffix:colon
id|dec-&gt;fe
op_assign
id|ttusbdecfe_dvbt_attach
c_func
(paren
op_amp
id|fe_config
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|dec-&gt;fe
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;dvb-ttusb-dec: A frontend driver was not found for device %04x/%04x&bslash;n&quot;
comma
id|le16_to_cpu
c_func
(paren
id|dec-&gt;udev-&gt;descriptor.idVendor
)paren
comma
id|le16_to_cpu
c_func
(paren
id|dec-&gt;udev-&gt;descriptor.idProduct
)paren
)paren
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|dvb_register_frontend
c_func
(paren
id|dec-&gt;adapter
comma
id|dec-&gt;fe
)paren
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;budget-ci: Frontend registration failed!&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dec-&gt;fe-&gt;ops-&gt;release
)paren
id|dec-&gt;fe-&gt;ops
op_member_access_from_pointer
id|release
c_func
(paren
id|dec-&gt;fe
)paren
suffix:semicolon
id|dec-&gt;fe
op_assign
l_int|NULL
suffix:semicolon
)brace
)brace
id|ttusb_dec_init_v_pes
c_func
(paren
id|dec
)paren
suffix:semicolon
id|ttusb_dec_init_filters
c_func
(paren
id|dec
)paren
suffix:semicolon
id|ttusb_dec_init_tasklet
c_func
(paren
id|dec
)paren
suffix:semicolon
id|dec-&gt;active
op_assign
l_int|1
suffix:semicolon
id|ttusb_dec_set_interface
c_func
(paren
id|dec
comma
id|TTUSB_DEC_INTERFACE_IN
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|ttusb_dec_disconnect
r_static
r_void
id|ttusb_dec_disconnect
c_func
(paren
r_struct
id|usb_interface
op_star
id|intf
)paren
(brace
r_struct
id|ttusb_dec
op_star
id|dec
op_assign
id|usb_get_intfdata
c_func
(paren
id|intf
)paren
suffix:semicolon
id|usb_set_intfdata
c_func
(paren
id|intf
comma
l_int|NULL
)paren
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dec-&gt;active
)paren
(brace
id|ttusb_dec_exit_tasklet
c_func
(paren
id|dec
)paren
suffix:semicolon
id|ttusb_dec_exit_filters
c_func
(paren
id|dec
)paren
suffix:semicolon
id|ttusb_dec_exit_usb
c_func
(paren
id|dec
)paren
suffix:semicolon
id|ttusb_dec_exit_dvb
c_func
(paren
id|dec
)paren
suffix:semicolon
)brace
id|kfree
c_func
(paren
id|dec
)paren
suffix:semicolon
)brace
DECL|function|ttusb_dec_set_model
r_static
r_void
id|ttusb_dec_set_model
c_func
(paren
r_struct
id|ttusb_dec
op_star
id|dec
comma
r_enum
id|ttusb_dec_model
id|model
)paren
(brace
id|dec-&gt;model
op_assign
id|model
suffix:semicolon
r_switch
c_cond
(paren
id|model
)paren
(brace
r_case
id|TTUSB_DEC2000T
suffix:colon
id|dec-&gt;model_name
op_assign
l_string|&quot;DEC2000-t&quot;
suffix:semicolon
id|dec-&gt;firmware_name
op_assign
l_string|&quot;dvb-ttusb-dec-2000t.fw&quot;
suffix:semicolon
r_break
suffix:semicolon
r_case
id|TTUSB_DEC2540T
suffix:colon
id|dec-&gt;model_name
op_assign
l_string|&quot;DEC2540-t&quot;
suffix:semicolon
id|dec-&gt;firmware_name
op_assign
l_string|&quot;dvb-ttusb-dec-2540t.fw&quot;
suffix:semicolon
r_break
suffix:semicolon
r_case
id|TTUSB_DEC3000S
suffix:colon
id|dec-&gt;model_name
op_assign
l_string|&quot;DEC3000-s&quot;
suffix:semicolon
id|dec-&gt;firmware_name
op_assign
l_string|&quot;dvb-ttusb-dec-3000s.fw&quot;
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
DECL|variable|ttusb_dec_table
r_static
r_struct
id|usb_device_id
id|ttusb_dec_table
(braket
)braket
op_assign
(brace
(brace
id|USB_DEVICE
c_func
(paren
l_int|0x0b48
comma
l_int|0x1006
)paren
)brace
comma
multiline_comment|/* DEC3000-s */
multiline_comment|/*{USB_DEVICE(0x0b48, 0x1007)},&t;   Unconfirmed */
(brace
id|USB_DEVICE
c_func
(paren
l_int|0x0b48
comma
l_int|0x1008
)paren
)brace
comma
multiline_comment|/* DEC2000-t */
(brace
id|USB_DEVICE
c_func
(paren
l_int|0x0b48
comma
l_int|0x1009
)paren
)brace
comma
multiline_comment|/* DEC2540-t */
(brace
)brace
)brace
suffix:semicolon
DECL|variable|ttusb_dec_driver
r_static
r_struct
id|usb_driver
id|ttusb_dec_driver
op_assign
(brace
dot
id|name
op_assign
l_string|&quot;ttusb-dec&quot;
comma
dot
id|probe
op_assign
id|ttusb_dec_probe
comma
dot
id|disconnect
op_assign
id|ttusb_dec_disconnect
comma
dot
id|id_table
op_assign
id|ttusb_dec_table
comma
)brace
suffix:semicolon
DECL|function|ttusb_dec_init
r_static
r_int
id|__init
id|ttusb_dec_init
c_func
(paren
r_void
)paren
(brace
r_int
id|result
suffix:semicolon
r_if
c_cond
(paren
(paren
id|result
op_assign
id|usb_register
c_func
(paren
op_amp
id|ttusb_dec_driver
)paren
)paren
OL
l_int|0
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: initialisation failed: error %d.&bslash;n&quot;
comma
id|__FUNCTION__
comma
id|result
)paren
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|ttusb_dec_exit
r_static
r_void
id|__exit
id|ttusb_dec_exit
c_func
(paren
r_void
)paren
(brace
id|usb_deregister
c_func
(paren
op_amp
id|ttusb_dec_driver
)paren
suffix:semicolon
)brace
DECL|variable|ttusb_dec_init
id|module_init
c_func
(paren
id|ttusb_dec_init
)paren
suffix:semicolon
DECL|variable|ttusb_dec_exit
id|module_exit
c_func
(paren
id|ttusb_dec_exit
)paren
suffix:semicolon
id|MODULE_AUTHOR
c_func
(paren
l_string|&quot;Alex Woods &lt;linux-dvb@giblets.org&gt;&quot;
)paren
suffix:semicolon
DECL|variable|DRIVER_NAME
id|MODULE_DESCRIPTION
c_func
(paren
id|DRIVER_NAME
)paren
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
id|MODULE_DEVICE_TABLE
c_func
(paren
id|usb
comma
id|ttusb_dec_table
)paren
suffix:semicolon
eof
