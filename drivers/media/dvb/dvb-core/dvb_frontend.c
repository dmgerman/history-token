multiline_comment|/*&n; * dvb_frontend.c: DVB frontend tuning interface/thread&n; *&n; *&n; * Copyright (C) 1999-2001 Ralph  Metzler&n; *                         Marcus Metzler&n; *                         Holger Waechtler &n; *                                    for convergence integrated media GmbH&n; *&n; * Copyright (C) 2004 Andrew de Quincey (tuning thread cleanup)&n; *&n; * This program is free software; you can redistribute it and/or&n; * modify it under the terms of the GNU General Public License&n; * as published by the Free Software Foundation; either version 2&n; * of the License, or (at your option) any later version.&n; *&n; * This program is distributed in the hope that it will be useful,&n; * but WITHOUT ANY WARRANTY; without even the implied warranty of&n; * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; * GNU General Public License for more details.&n; *&n; * You should have received a copy of the GNU General Public License&n; * along with this program; if not, write to the Free Software&n; * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.&n; * Or, point your browser to http://www.gnu.org/copyleft/gpl.html&n; */
macro_line|#include &lt;linux/string.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/wait.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;linux/poll.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/moduleparam.h&gt;
macro_line|#include &lt;linux/list.h&gt;
macro_line|#include &lt;linux/suspend.h&gt;
macro_line|#include &lt;asm/processor.h&gt;
macro_line|#include &lt;asm/semaphore.h&gt;
macro_line|#include &quot;dvb_frontend.h&quot;
macro_line|#include &quot;dvbdev.h&quot;
DECL|variable|dvb_frontend_debug
r_static
r_int
id|dvb_frontend_debug
suffix:semicolon
DECL|variable|dvb_shutdown_timeout
r_static
r_int
id|dvb_shutdown_timeout
op_assign
l_int|5
suffix:semicolon
DECL|variable|dvb_override_frequency_bending
r_static
r_int
id|dvb_override_frequency_bending
suffix:semicolon
DECL|variable|dvb_force_auto_inversion
r_static
r_int
id|dvb_force_auto_inversion
suffix:semicolon
DECL|variable|dvb_override_tune_delay
r_static
r_int
id|dvb_override_tune_delay
suffix:semicolon
DECL|variable|dvb_powerdown_on_sleep
r_static
r_int
id|dvb_powerdown_on_sleep
op_assign
l_int|1
suffix:semicolon
DECL|variable|do_frequency_bending
r_static
r_int
id|do_frequency_bending
suffix:semicolon
id|module_param_named
c_func
(paren
id|frontend_debug
comma
id|dvb_frontend_debug
comma
r_int
comma
l_int|0644
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|dvb_frontend_debug
comma
l_string|&quot;Turn on/off frontend core debugging (default:off).&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|dvb_shutdown_timeout
comma
r_int
comma
l_int|0444
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|dvb_shutdown_timeout
comma
l_string|&quot;wait &lt;shutdown_timeout&gt; seconds after close() before suspending hardware&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|dvb_override_frequency_bending
comma
r_int
comma
l_int|0444
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|dvb_override_frequency_bending
comma
l_string|&quot;0: normal (default), 1: never use frequency bending, 2: always use frequency bending&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|dvb_force_auto_inversion
comma
r_int
comma
l_int|0444
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|dvb_force_auto_inversion
comma
l_string|&quot;0: normal (default), 1: INVERSION_AUTO forced always&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|dvb_override_tune_delay
comma
r_int
comma
l_int|0444
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|dvb_override_tune_delay
comma
l_string|&quot;0: normal (default), &gt;0 =&gt; delay in milliseconds to wait for lock after a tune attempt&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|dvb_powerdown_on_sleep
comma
r_int
comma
l_int|0444
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|dvb_powerdown_on_sleep
comma
l_string|&quot;0: do not power down, 1: turn LNB volatage off on sleep (default)&quot;
)paren
suffix:semicolon
DECL|macro|dprintk
mdefine_line|#define dprintk if (dvb_frontend_debug) printk
DECL|macro|FESTATE_IDLE
mdefine_line|#define FESTATE_IDLE 1
DECL|macro|FESTATE_RETUNE
mdefine_line|#define FESTATE_RETUNE 2
DECL|macro|FESTATE_TUNING_FAST
mdefine_line|#define FESTATE_TUNING_FAST 4
DECL|macro|FESTATE_TUNING_SLOW
mdefine_line|#define FESTATE_TUNING_SLOW 8
DECL|macro|FESTATE_TUNED
mdefine_line|#define FESTATE_TUNED 16
DECL|macro|FESTATE_ZIGZAG_FAST
mdefine_line|#define FESTATE_ZIGZAG_FAST 32
DECL|macro|FESTATE_ZIGZAG_SLOW
mdefine_line|#define FESTATE_ZIGZAG_SLOW 64
DECL|macro|FESTATE_DISEQC
mdefine_line|#define FESTATE_DISEQC 128
DECL|macro|FESTATE_WAITFORLOCK
mdefine_line|#define FESTATE_WAITFORLOCK (FESTATE_TUNING_FAST | FESTATE_TUNING_SLOW | FESTATE_ZIGZAG_FAST | FESTATE_ZIGZAG_SLOW | FESTATE_DISEQC)
DECL|macro|FESTATE_SEARCHING_FAST
mdefine_line|#define FESTATE_SEARCHING_FAST (FESTATE_TUNING_FAST | FESTATE_ZIGZAG_FAST)
DECL|macro|FESTATE_SEARCHING_SLOW
mdefine_line|#define FESTATE_SEARCHING_SLOW (FESTATE_TUNING_SLOW | FESTATE_ZIGZAG_SLOW)
DECL|macro|FESTATE_LOSTLOCK
mdefine_line|#define FESTATE_LOSTLOCK (FESTATE_ZIGZAG_FAST | FESTATE_ZIGZAG_SLOW)
multiline_comment|/*&n; * FESTATE_IDLE. No tuning parameters have been supplied and the loop is idling.&n; * FESTATE_RETUNE. Parameters have been supplied, but we have not yet performed the first tune.&n; * FESTATE_TUNING_FAST. Tuning parameters have been supplied and fast zigzag scan is in progress.&n; * FESTATE_TUNING_SLOW. Tuning parameters have been supplied. Fast zigzag failed, so we&squot;re trying again, but slower.&n; * FESTATE_TUNED. The frontend has successfully locked on.&n; * FESTATE_ZIGZAG_FAST. The lock has been lost, and a fast zigzag has been initiated to try and regain it.&n; * FESTATE_ZIGZAG_SLOW. The lock has been lost. Fast zigzag has been failed, so we&squot;re trying again, but slower.&n; * FESTATE_DISEQC. A DISEQC command has just been issued.&n; * FESTATE_WAITFORLOCK. When we&squot;re waiting for a lock.&n; * FESTATE_SEARCHING_FAST. When we&squot;re searching for a signal using a fast zigzag scan.&n; * FESTATE_SEARCHING_SLOW. When we&squot;re searching for a signal using a slow zigzag scan.&n; * FESTATE_LOSTLOCK. When the lock has been lost, and we&squot;re searching it again.&n; */
DECL|macro|MAX_EVENT
mdefine_line|#define MAX_EVENT 8
DECL|struct|dvb_fe_events
r_struct
id|dvb_fe_events
(brace
DECL|member|events
r_struct
id|dvb_frontend_event
id|events
(braket
id|MAX_EVENT
)braket
suffix:semicolon
DECL|member|eventw
r_int
id|eventw
suffix:semicolon
DECL|member|eventr
r_int
id|eventr
suffix:semicolon
DECL|member|overflow
r_int
id|overflow
suffix:semicolon
DECL|member|wait_queue
id|wait_queue_head_t
id|wait_queue
suffix:semicolon
DECL|member|sem
r_struct
id|semaphore
id|sem
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|dvb_frontend_data
r_struct
id|dvb_frontend_data
(brace
DECL|member|frontend
r_struct
id|dvb_frontend
op_star
id|frontend
suffix:semicolon
DECL|member|dvbdev
r_struct
id|dvb_device
op_star
id|dvbdev
suffix:semicolon
DECL|member|parameters
r_struct
id|dvb_frontend_parameters
id|parameters
suffix:semicolon
DECL|member|events
r_struct
id|dvb_fe_events
id|events
suffix:semicolon
DECL|member|sem
r_struct
id|semaphore
id|sem
suffix:semicolon
DECL|member|list_head
r_struct
id|list_head
id|list_head
suffix:semicolon
DECL|member|wait_queue
id|wait_queue_head_t
id|wait_queue
suffix:semicolon
DECL|member|thread_pid
id|pid_t
id|thread_pid
suffix:semicolon
DECL|member|release_jiffies
r_int
r_int
id|release_jiffies
suffix:semicolon
DECL|member|state
r_int
id|state
suffix:semicolon
DECL|member|bending
r_int
id|bending
suffix:semicolon
DECL|member|lnb_drift
r_int
id|lnb_drift
suffix:semicolon
DECL|member|inversion
r_int
id|inversion
suffix:semicolon
DECL|member|auto_step
r_int
id|auto_step
suffix:semicolon
DECL|member|auto_sub_step
r_int
id|auto_sub_step
suffix:semicolon
DECL|member|started_auto_step
r_int
id|started_auto_step
suffix:semicolon
DECL|member|min_delay
r_int
id|min_delay
suffix:semicolon
DECL|member|max_drift
r_int
id|max_drift
suffix:semicolon
DECL|member|step_size
r_int
id|step_size
suffix:semicolon
DECL|member|exit
r_int
m_exit
suffix:semicolon
DECL|member|wakeup
r_int
id|wakeup
suffix:semicolon
DECL|member|status
id|fe_status_t
id|status
suffix:semicolon
)brace
suffix:semicolon
r_static
id|LIST_HEAD
c_func
(paren
id|frontend_list
)paren
suffix:semicolon
r_static
id|DECLARE_MUTEX
c_func
(paren
id|frontend_mutex
)paren
suffix:semicolon
multiline_comment|/**&n; *  if 2 tuners are located side by side you can get interferences when&n; *  they try to tune to the same frequency, so both lose sync.&n; *  We will slightly mistune in this case. The AFC of the demodulator&n; *  should make it still possible to receive the requested transponder &n; *  on both tuners...&n; */
DECL|function|dvb_bend_frequency
r_static
r_void
id|dvb_bend_frequency
(paren
r_struct
id|dvb_frontend_data
op_star
id|this_fe
comma
r_int
id|recursive
)paren
(brace
r_struct
id|list_head
op_star
id|entry
suffix:semicolon
r_int
id|stepsize
op_assign
id|this_fe-&gt;frontend-&gt;ops-&gt;info.frequency_stepsize
suffix:semicolon
r_int
id|this_fe_adap_num
op_assign
id|this_fe-&gt;frontend-&gt;dvb-&gt;num
suffix:semicolon
r_int
id|frequency
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|stepsize
op_logical_or
id|recursive
OG
l_int|10
)paren
(brace
id|printk
(paren
l_string|&quot;%s: too deep recursion, check frequency_stepsize &quot;
l_string|&quot;in your frontend code!&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|dprintk
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|recursive
)paren
(brace
r_if
c_cond
(paren
id|down_interruptible
(paren
op_amp
id|frontend_mutex
)paren
)paren
r_return
suffix:semicolon
id|this_fe-&gt;bending
op_assign
l_int|0
suffix:semicolon
)brace
id|list_for_each
(paren
id|entry
comma
op_amp
id|frontend_list
)paren
(brace
r_struct
id|dvb_frontend_data
op_star
id|fe
suffix:semicolon
r_int
id|f
suffix:semicolon
id|fe
op_assign
id|list_entry
(paren
id|entry
comma
r_struct
id|dvb_frontend_data
comma
id|list_head
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fe-&gt;frontend-&gt;dvb-&gt;num
op_ne
id|this_fe_adap_num
)paren
r_continue
suffix:semicolon
id|f
op_assign
id|fe-&gt;parameters.frequency
suffix:semicolon
id|f
op_add_assign
id|fe-&gt;lnb_drift
suffix:semicolon
id|f
op_add_assign
id|fe-&gt;bending
suffix:semicolon
id|frequency
op_assign
id|this_fe-&gt;parameters.frequency
suffix:semicolon
id|frequency
op_add_assign
id|this_fe-&gt;lnb_drift
suffix:semicolon
id|frequency
op_add_assign
id|this_fe-&gt;bending
suffix:semicolon
r_if
c_cond
(paren
id|this_fe
op_ne
id|fe
op_logical_and
(paren
id|fe-&gt;state
op_ne
id|FESTATE_IDLE
)paren
op_logical_and
id|frequency
OG
id|f
op_minus
id|stepsize
op_logical_and
id|frequency
OL
id|f
op_plus
id|stepsize
)paren
(brace
r_if
c_cond
(paren
id|recursive
op_mod
l_int|2
)paren
id|this_fe-&gt;bending
op_add_assign
id|stepsize
suffix:semicolon
r_else
id|this_fe-&gt;bending
op_assign
op_minus
id|this_fe-&gt;bending
suffix:semicolon
id|dvb_bend_frequency
(paren
id|this_fe
comma
id|recursive
op_plus
l_int|1
)paren
suffix:semicolon
r_goto
id|done
suffix:semicolon
)brace
)brace
id|done
suffix:colon
r_if
c_cond
(paren
op_logical_neg
id|recursive
)paren
id|up
(paren
op_amp
id|frontend_mutex
)paren
suffix:semicolon
)brace
DECL|function|dvb_frontend_add_event
r_static
r_void
id|dvb_frontend_add_event
(paren
r_struct
id|dvb_frontend_data
op_star
id|fe
comma
id|fe_status_t
id|status
)paren
(brace
r_struct
id|dvb_fe_events
op_star
id|events
op_assign
op_amp
id|fe-&gt;events
suffix:semicolon
r_struct
id|dvb_frontend_event
op_star
id|e
suffix:semicolon
r_int
id|wp
suffix:semicolon
id|dprintk
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_if
c_cond
(paren
id|down_interruptible
(paren
op_amp
id|events-&gt;sem
)paren
)paren
r_return
suffix:semicolon
id|wp
op_assign
(paren
id|events-&gt;eventw
op_plus
l_int|1
)paren
op_mod
id|MAX_EVENT
suffix:semicolon
r_if
c_cond
(paren
id|wp
op_eq
id|events-&gt;eventr
)paren
(brace
id|events-&gt;overflow
op_assign
l_int|1
suffix:semicolon
id|events-&gt;eventr
op_assign
(paren
id|events-&gt;eventr
op_plus
l_int|1
)paren
op_mod
id|MAX_EVENT
suffix:semicolon
)brace
id|e
op_assign
op_amp
id|events-&gt;events
(braket
id|events-&gt;eventw
)braket
suffix:semicolon
id|memcpy
(paren
op_amp
id|e-&gt;parameters
comma
op_amp
id|fe-&gt;parameters
comma
r_sizeof
(paren
r_struct
id|dvb_frontend_parameters
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|status
op_amp
id|FE_HAS_LOCK
)paren
r_if
c_cond
(paren
id|fe-&gt;frontend-&gt;ops-&gt;get_frontend
)paren
id|fe-&gt;frontend-&gt;ops
op_member_access_from_pointer
id|get_frontend
c_func
(paren
id|fe-&gt;frontend
comma
op_amp
id|e-&gt;parameters
)paren
suffix:semicolon
id|events-&gt;eventw
op_assign
id|wp
suffix:semicolon
id|up
(paren
op_amp
id|events-&gt;sem
)paren
suffix:semicolon
id|e-&gt;status
op_assign
id|status
suffix:semicolon
id|wake_up_interruptible
(paren
op_amp
id|events-&gt;wait_queue
)paren
suffix:semicolon
)brace
DECL|function|dvb_frontend_get_event
r_static
r_int
id|dvb_frontend_get_event
(paren
r_struct
id|dvb_frontend_data
op_star
id|fe
comma
r_struct
id|dvb_frontend_event
op_star
id|event
comma
r_int
id|flags
)paren
(brace
r_struct
id|dvb_fe_events
op_star
id|events
op_assign
op_amp
id|fe-&gt;events
suffix:semicolon
id|dprintk
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_if
c_cond
(paren
id|events-&gt;overflow
)paren
(brace
id|events-&gt;overflow
op_assign
l_int|0
suffix:semicolon
r_return
op_minus
id|EOVERFLOW
suffix:semicolon
)brace
r_if
c_cond
(paren
id|events-&gt;eventw
op_eq
id|events-&gt;eventr
)paren
(brace
r_int
id|ret
suffix:semicolon
r_if
c_cond
(paren
id|flags
op_amp
id|O_NONBLOCK
)paren
r_return
op_minus
id|EWOULDBLOCK
suffix:semicolon
id|up
c_func
(paren
op_amp
id|fe-&gt;sem
)paren
suffix:semicolon
id|ret
op_assign
id|wait_event_interruptible
(paren
id|events-&gt;wait_queue
comma
id|events-&gt;eventw
op_ne
id|events-&gt;eventr
)paren
suffix:semicolon
r_if
c_cond
(paren
id|down_interruptible
(paren
op_amp
id|fe-&gt;sem
)paren
)paren
r_return
op_minus
id|ERESTARTSYS
suffix:semicolon
r_if
c_cond
(paren
id|ret
OL
l_int|0
)paren
r_return
id|ret
suffix:semicolon
)brace
r_if
c_cond
(paren
id|down_interruptible
(paren
op_amp
id|events-&gt;sem
)paren
)paren
r_return
op_minus
id|ERESTARTSYS
suffix:semicolon
id|memcpy
(paren
id|event
comma
op_amp
id|events-&gt;events
(braket
id|events-&gt;eventr
)braket
comma
r_sizeof
(paren
r_struct
id|dvb_frontend_event
)paren
)paren
suffix:semicolon
id|events-&gt;eventr
op_assign
(paren
id|events-&gt;eventr
op_plus
l_int|1
)paren
op_mod
id|MAX_EVENT
suffix:semicolon
id|up
(paren
op_amp
id|events-&gt;sem
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dvb_frontend_init
r_static
r_void
id|dvb_frontend_init
(paren
r_struct
id|dvb_frontend_data
op_star
id|fe
)paren
(brace
id|dprintk
(paren
l_string|&quot;DVB: initialising frontend %i (%s)...&bslash;n&quot;
comma
id|fe-&gt;frontend-&gt;dvb-&gt;num
comma
id|fe-&gt;frontend-&gt;ops-&gt;info.name
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fe-&gt;frontend-&gt;ops-&gt;init
)paren
id|fe-&gt;frontend-&gt;ops
op_member_access_from_pointer
id|init
c_func
(paren
id|fe-&gt;frontend
)paren
suffix:semicolon
)brace
DECL|function|update_delay
r_static
r_void
id|update_delay
(paren
r_int
op_star
id|quality
comma
r_int
op_star
id|delay
comma
r_int
id|min_delay
comma
r_int
id|locked
)paren
(brace
r_int
id|q2
suffix:semicolon
id|dprintk
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_if
c_cond
(paren
id|locked
)paren
(paren
op_star
id|quality
)paren
op_assign
(paren
op_star
id|quality
op_star
l_int|220
op_plus
l_int|36
op_star
l_int|256
)paren
op_div
l_int|256
suffix:semicolon
r_else
(paren
op_star
id|quality
)paren
op_assign
(paren
op_star
id|quality
op_star
l_int|220
op_plus
l_int|0
)paren
op_div
l_int|256
suffix:semicolon
id|q2
op_assign
op_star
id|quality
op_minus
l_int|128
suffix:semicolon
id|q2
op_mul_assign
id|q2
suffix:semicolon
op_star
id|delay
op_assign
id|min_delay
op_plus
id|q2
op_star
id|HZ
op_div
(paren
l_int|128
op_star
l_int|128
)paren
suffix:semicolon
)brace
multiline_comment|/**&n; * Performs automatic twiddling of frontend parameters.&n; * &n; * @param fe The frontend concerned.&n; * @param check_wrapped Checks if an iteration has completed. DO NOT SET ON THE FIRST ATTEMPT&n; * @returns Number of complete iterations that have been performed.&n; */
DECL|function|dvb_frontend_autotune
r_static
r_int
id|dvb_frontend_autotune
c_func
(paren
r_struct
id|dvb_frontend_data
op_star
id|fe
comma
r_int
id|check_wrapped
)paren
(brace
r_int
id|autoinversion
suffix:semicolon
r_int
id|ready
op_assign
l_int|0
suffix:semicolon
r_int
id|original_inversion
op_assign
id|fe-&gt;parameters.inversion
suffix:semicolon
id|u32
id|original_frequency
op_assign
id|fe-&gt;parameters.frequency
suffix:semicolon
multiline_comment|/* are we using autoinversion? */
id|autoinversion
op_assign
(paren
(paren
op_logical_neg
(paren
id|fe-&gt;frontend-&gt;ops-&gt;info.caps
op_amp
id|FE_CAN_INVERSION_AUTO
)paren
)paren
op_logical_and
(paren
id|fe-&gt;parameters.inversion
op_eq
id|INVERSION_AUTO
)paren
)paren
suffix:semicolon
multiline_comment|/* setup parameters correctly */
r_while
c_loop
(paren
op_logical_neg
id|ready
)paren
(brace
multiline_comment|/* calculate the lnb_drift */
id|fe-&gt;lnb_drift
op_assign
id|fe-&gt;auto_step
op_star
id|fe-&gt;step_size
suffix:semicolon
multiline_comment|/* wrap the auto_step if we&squot;ve exceeded the maximum drift */
r_if
c_cond
(paren
id|fe-&gt;lnb_drift
OG
id|fe-&gt;max_drift
)paren
(brace
id|fe-&gt;auto_step
op_assign
l_int|0
suffix:semicolon
id|fe-&gt;auto_sub_step
op_assign
l_int|0
suffix:semicolon
id|fe-&gt;lnb_drift
op_assign
l_int|0
suffix:semicolon
)brace
multiline_comment|/* perform inversion and +/- zigzag */
r_switch
c_cond
(paren
id|fe-&gt;auto_sub_step
)paren
(brace
r_case
l_int|0
suffix:colon
multiline_comment|/* try with the current inversion and current drift setting */
id|ready
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
r_if
c_cond
(paren
op_logical_neg
id|autoinversion
)paren
r_break
suffix:semicolon
id|fe-&gt;inversion
op_assign
(paren
id|fe-&gt;inversion
op_eq
id|INVERSION_OFF
)paren
ques
c_cond
id|INVERSION_ON
suffix:colon
id|INVERSION_OFF
suffix:semicolon
id|ready
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
r_if
c_cond
(paren
id|fe-&gt;lnb_drift
op_eq
l_int|0
)paren
r_break
suffix:semicolon
id|fe-&gt;lnb_drift
op_assign
op_minus
id|fe-&gt;lnb_drift
suffix:semicolon
id|ready
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
r_if
c_cond
(paren
id|fe-&gt;lnb_drift
op_eq
l_int|0
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|autoinversion
)paren
r_break
suffix:semicolon
id|fe-&gt;inversion
op_assign
(paren
id|fe-&gt;inversion
op_eq
id|INVERSION_OFF
)paren
ques
c_cond
id|INVERSION_ON
suffix:colon
id|INVERSION_OFF
suffix:semicolon
id|fe-&gt;lnb_drift
op_assign
op_minus
id|fe-&gt;lnb_drift
suffix:semicolon
id|ready
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|fe-&gt;auto_step
op_increment
suffix:semicolon
id|fe-&gt;auto_sub_step
op_assign
op_minus
l_int|1
suffix:semicolon
multiline_comment|/* it&squot;ll be incremented to 0 in a moment */
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|ready
)paren
id|fe-&gt;auto_sub_step
op_increment
suffix:semicolon
)brace
multiline_comment|/* if this attempt would hit where we started, indicate a complete&n;&t; * iteration has occurred */
r_if
c_cond
(paren
(paren
id|fe-&gt;auto_step
op_eq
id|fe-&gt;started_auto_step
)paren
op_logical_and
(paren
id|fe-&gt;auto_sub_step
op_eq
l_int|0
)paren
op_logical_and
id|check_wrapped
)paren
(brace
r_return
l_int|1
suffix:semicolon
)brace
multiline_comment|/* perform frequency bending if necessary */
r_if
c_cond
(paren
(paren
id|dvb_override_frequency_bending
op_ne
l_int|1
)paren
op_logical_and
id|do_frequency_bending
)paren
id|dvb_bend_frequency
c_func
(paren
id|fe
comma
l_int|0
)paren
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;%s: drift:%i bending:%i inversion:%i auto_step:%i &quot;
l_string|&quot;auto_sub_step:%i started_auto_step:%i&bslash;n&quot;
comma
id|__FUNCTION__
comma
id|fe-&gt;lnb_drift
comma
id|fe-&gt;bending
comma
id|fe-&gt;inversion
comma
id|fe-&gt;auto_step
comma
id|fe-&gt;auto_sub_step
comma
id|fe-&gt;started_auto_step
)paren
suffix:semicolon
multiline_comment|/* set the frontend itself */
id|fe-&gt;parameters.frequency
op_add_assign
id|fe-&gt;lnb_drift
op_plus
id|fe-&gt;bending
suffix:semicolon
r_if
c_cond
(paren
id|autoinversion
)paren
id|fe-&gt;parameters.inversion
op_assign
id|fe-&gt;inversion
suffix:semicolon
r_if
c_cond
(paren
id|fe-&gt;frontend-&gt;ops-&gt;set_frontend
)paren
id|fe-&gt;frontend-&gt;ops
op_member_access_from_pointer
id|set_frontend
c_func
(paren
id|fe-&gt;frontend
comma
op_amp
id|fe-&gt;parameters
)paren
suffix:semicolon
id|fe-&gt;parameters.frequency
op_assign
id|original_frequency
suffix:semicolon
id|fe-&gt;parameters.inversion
op_assign
id|original_inversion
suffix:semicolon
id|fe-&gt;auto_sub_step
op_increment
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dvb_frontend_is_exiting
r_static
r_int
id|dvb_frontend_is_exiting
(paren
r_struct
id|dvb_frontend_data
op_star
id|fe
)paren
(brace
r_if
c_cond
(paren
id|fe
op_member_access_from_pointer
m_exit
)paren
r_return
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|fe-&gt;dvbdev-&gt;writers
op_eq
l_int|1
)paren
r_if
c_cond
(paren
id|jiffies
op_minus
id|fe-&gt;release_jiffies
OG
id|dvb_shutdown_timeout
op_star
id|HZ
)paren
r_return
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dvb_frontend_should_wakeup
r_static
r_int
id|dvb_frontend_should_wakeup
(paren
r_struct
id|dvb_frontend_data
op_star
id|fe
)paren
(brace
r_if
c_cond
(paren
id|fe-&gt;wakeup
)paren
(brace
id|fe-&gt;wakeup
op_assign
l_int|0
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
r_return
id|dvb_frontend_is_exiting
c_func
(paren
id|fe
)paren
suffix:semicolon
)brace
DECL|function|dvb_frontend_wakeup
r_static
r_void
id|dvb_frontend_wakeup
(paren
r_struct
id|dvb_frontend_data
op_star
id|fe
)paren
(brace
id|fe-&gt;wakeup
op_assign
l_int|1
suffix:semicolon
id|wake_up_interruptible
c_func
(paren
op_amp
id|fe-&gt;wait_queue
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * FIXME: use linux/kthread.h&n; */
DECL|function|dvb_frontend_thread
r_static
r_int
id|dvb_frontend_thread
(paren
r_void
op_star
id|data
)paren
(brace
r_struct
id|dvb_frontend_data
op_star
id|fe
op_assign
(paren
r_struct
id|dvb_frontend_data
op_star
)paren
id|data
suffix:semicolon
r_int
r_int
id|timeout
suffix:semicolon
r_char
id|name
(braket
l_int|15
)braket
suffix:semicolon
r_int
id|quality
op_assign
l_int|0
comma
id|delay
op_assign
l_int|3
op_star
id|HZ
suffix:semicolon
id|fe_status_t
id|s
suffix:semicolon
r_int
id|check_wrapped
op_assign
l_int|0
suffix:semicolon
id|dprintk
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
id|snprintf
(paren
id|name
comma
r_sizeof
(paren
id|name
)paren
comma
l_string|&quot;kdvb-fe-%i&quot;
comma
id|fe-&gt;frontend-&gt;dvb-&gt;num
)paren
suffix:semicolon
id|lock_kernel
(paren
)paren
suffix:semicolon
id|daemonize
(paren
id|name
)paren
suffix:semicolon
id|sigfillset
(paren
op_amp
id|current-&gt;blocked
)paren
suffix:semicolon
id|unlock_kernel
(paren
)paren
suffix:semicolon
id|fe-&gt;status
op_assign
l_int|0
suffix:semicolon
id|dvb_frontend_init
(paren
id|fe
)paren
suffix:semicolon
id|fe-&gt;wakeup
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
l_int|1
)paren
(brace
id|up
(paren
op_amp
id|fe-&gt;sem
)paren
suffix:semicolon
multiline_comment|/* is locked when we enter the thread... */
id|timeout
op_assign
id|wait_event_interruptible_timeout
c_func
(paren
id|fe-&gt;wait_queue
comma
l_int|0
op_ne
id|dvb_frontend_should_wakeup
(paren
id|fe
)paren
comma
id|delay
)paren
suffix:semicolon
r_if
c_cond
(paren
l_int|0
op_ne
id|dvb_frontend_is_exiting
(paren
id|fe
)paren
)paren
(brace
multiline_comment|/* got signal or quitting */
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|current-&gt;flags
op_amp
id|PF_FREEZE
)paren
id|refrigerator
c_func
(paren
id|PF_FREEZE
)paren
suffix:semicolon
r_if
c_cond
(paren
id|down_interruptible
(paren
op_amp
id|fe-&gt;sem
)paren
)paren
r_break
suffix:semicolon
multiline_comment|/* if we&squot;ve got no parameters, just keep idling */
r_if
c_cond
(paren
id|fe-&gt;state
op_amp
id|FESTATE_IDLE
)paren
(brace
id|delay
op_assign
l_int|3
op_star
id|HZ
suffix:semicolon
id|quality
op_assign
l_int|0
suffix:semicolon
r_continue
suffix:semicolon
)brace
multiline_comment|/* get the frontend status */
r_if
c_cond
(paren
id|fe-&gt;state
op_amp
id|FESTATE_RETUNE
)paren
(brace
id|s
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|fe-&gt;frontend-&gt;ops-&gt;read_status
)paren
id|fe-&gt;frontend-&gt;ops
op_member_access_from_pointer
id|read_status
c_func
(paren
id|fe-&gt;frontend
comma
op_amp
id|s
)paren
suffix:semicolon
r_if
c_cond
(paren
id|s
op_ne
id|fe-&gt;status
)paren
(brace
id|dvb_frontend_add_event
(paren
id|fe
comma
id|s
)paren
suffix:semicolon
id|fe-&gt;status
op_assign
id|s
suffix:semicolon
)brace
)brace
multiline_comment|/* if we&squot;re not tuned, and we have a lock, move to the TUNED state */
r_if
c_cond
(paren
(paren
id|fe-&gt;state
op_amp
id|FESTATE_WAITFORLOCK
)paren
op_logical_and
(paren
id|s
op_amp
id|FE_HAS_LOCK
)paren
)paren
(brace
id|update_delay
c_func
(paren
op_amp
id|quality
comma
op_amp
id|delay
comma
id|fe-&gt;min_delay
comma
id|s
op_amp
id|FE_HAS_LOCK
)paren
suffix:semicolon
id|fe-&gt;state
op_assign
id|FESTATE_TUNED
suffix:semicolon
multiline_comment|/* if we&squot;re tuned, then we have determined the correct inversion */
r_if
c_cond
(paren
(paren
op_logical_neg
(paren
id|fe-&gt;frontend-&gt;ops-&gt;info.caps
op_amp
id|FE_CAN_INVERSION_AUTO
)paren
)paren
op_logical_and
(paren
id|fe-&gt;parameters.inversion
op_eq
id|INVERSION_AUTO
)paren
)paren
(brace
id|fe-&gt;parameters.inversion
op_assign
id|fe-&gt;inversion
suffix:semicolon
)brace
r_continue
suffix:semicolon
)brace
multiline_comment|/* if we are tuned already, check we&squot;re still locked */
r_if
c_cond
(paren
id|fe-&gt;state
op_amp
id|FESTATE_TUNED
)paren
(brace
id|update_delay
c_func
(paren
op_amp
id|quality
comma
op_amp
id|delay
comma
id|fe-&gt;min_delay
comma
id|s
op_amp
id|FE_HAS_LOCK
)paren
suffix:semicolon
multiline_comment|/* we&squot;re tuned, and the lock is still good... */
r_if
c_cond
(paren
id|s
op_amp
id|FE_HAS_LOCK
)paren
r_continue
suffix:semicolon
r_else
(brace
multiline_comment|/* if we _WERE_ tuned, but now don&squot;t have a lock,&n;&t;&t;&t;&t; * need to zigzag */
id|fe-&gt;state
op_assign
id|FESTATE_ZIGZAG_FAST
suffix:semicolon
id|fe-&gt;started_auto_step
op_assign
id|fe-&gt;auto_step
suffix:semicolon
id|check_wrapped
op_assign
l_int|0
suffix:semicolon
)brace
)brace
multiline_comment|/* don&squot;t actually do anything if we&squot;re in the LOSTLOCK state,&n;&t;&t; * the frontend is set to FE_CAN_RECOVER, and the max_drift is 0 */
r_if
c_cond
(paren
(paren
id|fe-&gt;state
op_amp
id|FESTATE_LOSTLOCK
)paren
op_logical_and
(paren
id|fe-&gt;frontend-&gt;ops-&gt;info.caps
op_amp
id|FE_CAN_RECOVER
)paren
op_logical_and
(paren
id|fe-&gt;max_drift
op_eq
l_int|0
)paren
)paren
(brace
id|update_delay
c_func
(paren
op_amp
id|quality
comma
op_amp
id|delay
comma
id|fe-&gt;min_delay
comma
id|s
op_amp
id|FE_HAS_LOCK
)paren
suffix:semicolon
r_continue
suffix:semicolon
)brace
multiline_comment|/* don&squot;t do anything if we&squot;re in the DISEQC state, since this&n;&t;&t; * might be someone with a motorized dish controlled by DISEQC.&n;&t;&t; * If its actually a re-tune, there will be a SET_FRONTEND soon enough.&t;*/
r_if
c_cond
(paren
id|fe-&gt;state
op_amp
id|FESTATE_DISEQC
)paren
(brace
id|update_delay
c_func
(paren
op_amp
id|quality
comma
op_amp
id|delay
comma
id|fe-&gt;min_delay
comma
id|s
op_amp
id|FE_HAS_LOCK
)paren
suffix:semicolon
r_continue
suffix:semicolon
)brace
multiline_comment|/* if we&squot;re in the RETUNE state, set everything up for a brand&n;&t;&t; * new scan, keeping the current inversion setting, as the next&n;&t;&t; * tune is _very_ likely to require the same */
r_if
c_cond
(paren
id|fe-&gt;state
op_amp
id|FESTATE_RETUNE
)paren
(brace
id|fe-&gt;lnb_drift
op_assign
l_int|0
suffix:semicolon
id|fe-&gt;auto_step
op_assign
l_int|0
suffix:semicolon
id|fe-&gt;auto_sub_step
op_assign
l_int|0
suffix:semicolon
id|fe-&gt;started_auto_step
op_assign
l_int|0
suffix:semicolon
id|check_wrapped
op_assign
l_int|0
suffix:semicolon
)brace
multiline_comment|/* fast zigzag. */
r_if
c_cond
(paren
(paren
id|fe-&gt;state
op_amp
id|FESTATE_SEARCHING_FAST
)paren
op_logical_or
(paren
id|fe-&gt;state
op_amp
id|FESTATE_RETUNE
)paren
)paren
(brace
id|delay
op_assign
id|fe-&gt;min_delay
suffix:semicolon
multiline_comment|/* peform a tune */
r_if
c_cond
(paren
id|dvb_frontend_autotune
c_func
(paren
id|fe
comma
id|check_wrapped
)paren
)paren
(brace
multiline_comment|/* OK, if we&squot;ve run out of trials at the fast speed.&n;&t;&t;&t;&t; * Drop back to slow for the _next_ attempt */
id|fe-&gt;state
op_assign
id|FESTATE_SEARCHING_SLOW
suffix:semicolon
id|fe-&gt;started_auto_step
op_assign
id|fe-&gt;auto_step
suffix:semicolon
r_continue
suffix:semicolon
)brace
id|check_wrapped
op_assign
l_int|1
suffix:semicolon
multiline_comment|/* if we&squot;ve just retuned, enter the ZIGZAG_FAST state.&n;&t;&t;&t; * This ensures we cannot return from an&n;&t;&t;&t; * FE_SET_FRONTEND ioctl before the first frontend tune&n;&t;&t;&t; * occurs */
r_if
c_cond
(paren
id|fe-&gt;state
op_amp
id|FESTATE_RETUNE
)paren
(brace
id|fe-&gt;state
op_assign
id|FESTATE_TUNING_FAST
suffix:semicolon
id|wake_up_interruptible
c_func
(paren
op_amp
id|fe-&gt;wait_queue
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/* slow zigzag */
r_if
c_cond
(paren
id|fe-&gt;state
op_amp
id|FESTATE_SEARCHING_SLOW
)paren
(brace
id|update_delay
c_func
(paren
op_amp
id|quality
comma
op_amp
id|delay
comma
id|fe-&gt;min_delay
comma
id|s
op_amp
id|FE_HAS_LOCK
)paren
suffix:semicolon
multiline_comment|/* Note: don&squot;t bother checking for wrapping; we stay in this&n;&t;&t;&t; * state until we get a lock */
id|dvb_frontend_autotune
c_func
(paren
id|fe
comma
l_int|0
)paren
suffix:semicolon
)brace
)brace
suffix:semicolon
r_if
c_cond
(paren
id|dvb_shutdown_timeout
)paren
(brace
r_if
c_cond
(paren
id|dvb_powerdown_on_sleep
)paren
r_if
c_cond
(paren
id|fe-&gt;frontend-&gt;ops-&gt;set_voltage
)paren
id|fe-&gt;frontend-&gt;ops
op_member_access_from_pointer
id|set_voltage
c_func
(paren
id|fe-&gt;frontend
comma
id|SEC_VOLTAGE_OFF
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fe-&gt;frontend-&gt;ops-&gt;sleep
)paren
id|fe-&gt;frontend-&gt;ops
op_member_access_from_pointer
id|sleep
c_func
(paren
id|fe-&gt;frontend
)paren
suffix:semicolon
)brace
id|fe-&gt;thread_pid
op_assign
l_int|0
suffix:semicolon
id|mb
c_func
(paren
)paren
suffix:semicolon
id|dvb_frontend_wakeup
c_func
(paren
id|fe
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dvb_frontend_stop
r_static
r_void
id|dvb_frontend_stop
(paren
r_struct
id|dvb_frontend_data
op_star
id|fe
)paren
(brace
r_int
r_int
id|ret
suffix:semicolon
id|dprintk
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
id|fe
op_member_access_from_pointer
m_exit
op_assign
l_int|1
suffix:semicolon
id|mb
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|fe-&gt;thread_pid
)paren
r_return
suffix:semicolon
multiline_comment|/* check if the thread is really alive */
r_if
c_cond
(paren
id|kill_proc
c_func
(paren
id|fe-&gt;thread_pid
comma
l_int|0
comma
l_int|1
)paren
op_eq
op_minus
id|ESRCH
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;dvb_frontend_stop: thread PID %d already died&bslash;n&quot;
comma
id|fe-&gt;thread_pid
)paren
suffix:semicolon
multiline_comment|/* make sure the mutex was not held by the thread */
id|init_MUTEX
(paren
op_amp
id|fe-&gt;sem
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
multiline_comment|/* wake up the frontend thread, so it notices that fe-&gt;exit == 1 */
id|dvb_frontend_wakeup
c_func
(paren
id|fe
)paren
suffix:semicolon
multiline_comment|/* wait until the frontend thread has exited */
id|ret
op_assign
id|wait_event_interruptible
c_func
(paren
id|fe-&gt;wait_queue
comma
l_int|0
op_eq
id|fe-&gt;thread_pid
)paren
suffix:semicolon
r_if
c_cond
(paren
op_minus
id|ERESTARTSYS
op_ne
id|ret
)paren
(brace
id|fe-&gt;state
op_assign
id|FESTATE_IDLE
suffix:semicolon
r_return
suffix:semicolon
)brace
id|fe-&gt;state
op_assign
id|FESTATE_IDLE
suffix:semicolon
multiline_comment|/* paranoia check in case a signal arrived */
r_if
c_cond
(paren
id|fe-&gt;thread_pid
)paren
id|printk
c_func
(paren
l_string|&quot;dvb_frontend_stop: warning: thread PID %d won&squot;t exit&bslash;n&quot;
comma
id|fe-&gt;thread_pid
)paren
suffix:semicolon
)brace
DECL|function|dvb_frontend_start
r_static
r_int
id|dvb_frontend_start
(paren
r_struct
id|dvb_frontend_data
op_star
id|fe
)paren
(brace
r_int
id|ret
suffix:semicolon
id|dprintk
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fe-&gt;thread_pid
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|fe
op_member_access_from_pointer
m_exit
)paren
r_return
l_int|0
suffix:semicolon
r_else
id|dvb_frontend_stop
(paren
id|fe
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|signal_pending
c_func
(paren
id|current
)paren
)paren
r_return
op_minus
id|EINTR
suffix:semicolon
r_if
c_cond
(paren
id|down_interruptible
(paren
op_amp
id|fe-&gt;sem
)paren
)paren
r_return
op_minus
id|EINTR
suffix:semicolon
id|fe-&gt;state
op_assign
id|FESTATE_IDLE
suffix:semicolon
id|fe
op_member_access_from_pointer
m_exit
op_assign
l_int|0
suffix:semicolon
id|fe-&gt;thread_pid
op_assign
l_int|0
suffix:semicolon
id|mb
c_func
(paren
)paren
suffix:semicolon
id|ret
op_assign
id|kernel_thread
(paren
id|dvb_frontend_thread
comma
id|fe
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
OL
l_int|0
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;dvb_frontend_start: failed to start kernel_thread (%d)&bslash;n&quot;
comma
id|ret
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|fe-&gt;sem
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
id|fe-&gt;thread_pid
op_assign
id|ret
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dvb_frontend_ioctl
r_static
r_int
id|dvb_frontend_ioctl
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
comma
r_int
r_int
id|cmd
comma
r_void
op_star
id|parg
)paren
(brace
r_struct
id|dvb_device
op_star
id|dvbdev
op_assign
id|file-&gt;private_data
suffix:semicolon
r_struct
id|dvb_frontend_data
op_star
id|fe
op_assign
id|dvbdev-&gt;priv
suffix:semicolon
r_int
id|err
op_assign
op_minus
id|EOPNOTSUPP
suffix:semicolon
id|dprintk
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|fe
op_logical_or
id|fe
op_member_access_from_pointer
m_exit
)paren
r_return
op_minus
id|ENODEV
suffix:semicolon
r_if
c_cond
(paren
(paren
id|file-&gt;f_flags
op_amp
id|O_ACCMODE
)paren
op_eq
id|O_RDONLY
op_logical_and
(paren
id|_IOC_DIR
c_func
(paren
id|cmd
)paren
op_ne
id|_IOC_READ
op_logical_or
id|cmd
op_eq
id|FE_GET_EVENT
op_logical_or
id|cmd
op_eq
id|FE_DISEQC_RECV_SLAVE_REPLY
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
r_if
c_cond
(paren
id|down_interruptible
(paren
op_amp
id|fe-&gt;sem
)paren
)paren
r_return
op_minus
id|ERESTARTSYS
suffix:semicolon
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|FE_GET_INFO
suffix:colon
(brace
r_struct
id|dvb_frontend_info
op_star
id|info
op_assign
(paren
r_struct
id|dvb_frontend_info
op_star
)paren
id|parg
suffix:semicolon
id|memcpy
c_func
(paren
id|info
comma
op_amp
id|fe-&gt;frontend-&gt;ops-&gt;info
comma
r_sizeof
(paren
r_struct
id|dvb_frontend_info
)paren
)paren
suffix:semicolon
multiline_comment|/* Force the CAN_INVERSION_AUTO bit on. If the frontend doesn&squot;t&n;&t;&t; * do it, it is done for it. */
id|info-&gt;caps
op_or_assign
id|FE_CAN_INVERSION_AUTO
suffix:semicolon
id|err
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|FE_READ_STATUS
suffix:colon
r_if
c_cond
(paren
id|fe-&gt;frontend-&gt;ops-&gt;read_status
)paren
id|err
op_assign
id|fe-&gt;frontend-&gt;ops
op_member_access_from_pointer
id|read_status
c_func
(paren
id|fe-&gt;frontend
comma
(paren
id|fe_status_t
op_star
)paren
id|parg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FE_READ_BER
suffix:colon
r_if
c_cond
(paren
id|fe-&gt;frontend-&gt;ops-&gt;read_ber
)paren
id|err
op_assign
id|fe-&gt;frontend-&gt;ops
op_member_access_from_pointer
id|read_ber
c_func
(paren
id|fe-&gt;frontend
comma
(paren
id|__u32
op_star
)paren
id|parg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FE_READ_SIGNAL_STRENGTH
suffix:colon
r_if
c_cond
(paren
id|fe-&gt;frontend-&gt;ops-&gt;read_signal_strength
)paren
id|err
op_assign
id|fe-&gt;frontend-&gt;ops
op_member_access_from_pointer
id|read_signal_strength
c_func
(paren
id|fe-&gt;frontend
comma
(paren
id|__u16
op_star
)paren
id|parg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FE_READ_SNR
suffix:colon
r_if
c_cond
(paren
id|fe-&gt;frontend-&gt;ops-&gt;read_snr
)paren
id|err
op_assign
id|fe-&gt;frontend-&gt;ops
op_member_access_from_pointer
id|read_snr
c_func
(paren
id|fe-&gt;frontend
comma
(paren
id|__u16
op_star
)paren
id|parg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FE_READ_UNCORRECTED_BLOCKS
suffix:colon
r_if
c_cond
(paren
id|fe-&gt;frontend-&gt;ops-&gt;read_ucblocks
)paren
id|err
op_assign
id|fe-&gt;frontend-&gt;ops
op_member_access_from_pointer
id|read_ucblocks
c_func
(paren
id|fe-&gt;frontend
comma
(paren
id|__u32
op_star
)paren
id|parg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FE_DISEQC_RESET_OVERLOAD
suffix:colon
r_if
c_cond
(paren
id|fe-&gt;frontend-&gt;ops-&gt;diseqc_reset_overload
)paren
(brace
id|err
op_assign
id|fe-&gt;frontend-&gt;ops
op_member_access_from_pointer
id|diseqc_reset_overload
c_func
(paren
id|fe-&gt;frontend
)paren
suffix:semicolon
id|fe-&gt;state
op_assign
id|FESTATE_DISEQC
suffix:semicolon
id|fe-&gt;status
op_assign
l_int|0
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|FE_DISEQC_SEND_MASTER_CMD
suffix:colon
r_if
c_cond
(paren
id|fe-&gt;frontend-&gt;ops-&gt;diseqc_send_master_cmd
)paren
(brace
id|err
op_assign
id|fe-&gt;frontend-&gt;ops
op_member_access_from_pointer
id|diseqc_send_master_cmd
c_func
(paren
id|fe-&gt;frontend
comma
(paren
r_struct
id|dvb_diseqc_master_cmd
op_star
)paren
id|parg
)paren
suffix:semicolon
id|fe-&gt;state
op_assign
id|FESTATE_DISEQC
suffix:semicolon
id|fe-&gt;status
op_assign
l_int|0
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|FE_DISEQC_SEND_BURST
suffix:colon
r_if
c_cond
(paren
id|fe-&gt;frontend-&gt;ops-&gt;diseqc_send_burst
)paren
(brace
id|err
op_assign
id|fe-&gt;frontend-&gt;ops
op_member_access_from_pointer
id|diseqc_send_burst
c_func
(paren
id|fe-&gt;frontend
comma
(paren
id|fe_sec_mini_cmd_t
)paren
id|parg
)paren
suffix:semicolon
id|fe-&gt;state
op_assign
id|FESTATE_DISEQC
suffix:semicolon
id|fe-&gt;status
op_assign
l_int|0
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|FE_SET_TONE
suffix:colon
r_if
c_cond
(paren
id|fe-&gt;frontend-&gt;ops-&gt;set_tone
)paren
(brace
id|err
op_assign
id|fe-&gt;frontend-&gt;ops
op_member_access_from_pointer
id|set_tone
c_func
(paren
id|fe-&gt;frontend
comma
(paren
id|fe_sec_tone_mode_t
)paren
id|parg
)paren
suffix:semicolon
id|fe-&gt;state
op_assign
id|FESTATE_DISEQC
suffix:semicolon
id|fe-&gt;status
op_assign
l_int|0
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|FE_SET_VOLTAGE
suffix:colon
r_if
c_cond
(paren
id|fe-&gt;frontend-&gt;ops-&gt;set_voltage
)paren
(brace
id|err
op_assign
id|fe-&gt;frontend-&gt;ops
op_member_access_from_pointer
id|set_voltage
c_func
(paren
id|fe-&gt;frontend
comma
(paren
id|fe_sec_voltage_t
)paren
id|parg
)paren
suffix:semicolon
id|fe-&gt;state
op_assign
id|FESTATE_DISEQC
suffix:semicolon
id|fe-&gt;status
op_assign
l_int|0
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|FE_DISHNETWORK_SEND_LEGACY_CMD
suffix:colon
r_if
c_cond
(paren
id|fe-&gt;frontend-&gt;ops-&gt;dishnetwork_send_legacy_command
)paren
(brace
id|err
op_assign
id|fe-&gt;frontend-&gt;ops
op_member_access_from_pointer
id|dishnetwork_send_legacy_command
c_func
(paren
id|fe-&gt;frontend
comma
(paren
r_int
r_int
)paren
id|parg
)paren
suffix:semicolon
id|fe-&gt;state
op_assign
id|FESTATE_DISEQC
suffix:semicolon
id|fe-&gt;status
op_assign
l_int|0
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|FE_DISEQC_RECV_SLAVE_REPLY
suffix:colon
r_if
c_cond
(paren
id|fe-&gt;frontend-&gt;ops-&gt;diseqc_recv_slave_reply
)paren
id|err
op_assign
id|fe-&gt;frontend-&gt;ops
op_member_access_from_pointer
id|diseqc_recv_slave_reply
c_func
(paren
id|fe-&gt;frontend
comma
(paren
r_struct
id|dvb_diseqc_slave_reply
op_star
)paren
id|parg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FE_ENABLE_HIGH_LNB_VOLTAGE
suffix:colon
r_if
c_cond
(paren
id|fe-&gt;frontend-&gt;ops-&gt;enable_high_lnb_voltage
)paren
suffix:semicolon
id|err
op_assign
id|fe-&gt;frontend-&gt;ops
op_member_access_from_pointer
id|enable_high_lnb_voltage
c_func
(paren
id|fe-&gt;frontend
comma
(paren
r_int
)paren
id|parg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FE_SET_FRONTEND
suffix:colon
(brace
r_struct
id|dvb_frontend_tune_settings
id|fetunesettings
suffix:semicolon
id|memcpy
(paren
op_amp
id|fe-&gt;parameters
comma
id|parg
comma
r_sizeof
(paren
r_struct
id|dvb_frontend_parameters
)paren
)paren
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|fetunesettings
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|dvb_frontend_tune_settings
)paren
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|fetunesettings.parameters
comma
id|parg
comma
r_sizeof
(paren
r_struct
id|dvb_frontend_parameters
)paren
)paren
suffix:semicolon
multiline_comment|/* force auto frequency inversion if requested */
r_if
c_cond
(paren
id|dvb_force_auto_inversion
)paren
(brace
id|fe-&gt;parameters.inversion
op_assign
id|INVERSION_AUTO
suffix:semicolon
id|fetunesettings.parameters.inversion
op_assign
id|INVERSION_AUTO
suffix:semicolon
)brace
r_if
c_cond
(paren
id|fe-&gt;frontend-&gt;ops-&gt;info.type
op_eq
id|FE_OFDM
)paren
(brace
multiline_comment|/* without hierachical coding code_rate_LP is irrelevant,&n;&t;&t;&t; * so we tolerate the otherwise invalid FEC_NONE setting */
r_if
c_cond
(paren
id|fe-&gt;parameters.u.ofdm.hierarchy_information
op_eq
id|HIERARCHY_NONE
op_logical_and
id|fe-&gt;parameters.u.ofdm.code_rate_LP
op_eq
id|FEC_NONE
)paren
id|fe-&gt;parameters.u.ofdm.code_rate_LP
op_assign
id|FEC_AUTO
suffix:semicolon
)brace
multiline_comment|/* get frontend-specific tuning settings */
r_if
c_cond
(paren
id|fe-&gt;frontend-&gt;ops-&gt;get_tune_settings
op_logical_and
(paren
id|fe-&gt;frontend-&gt;ops
op_member_access_from_pointer
id|get_tune_settings
c_func
(paren
id|fe-&gt;frontend
comma
op_amp
id|fetunesettings
)paren
op_eq
l_int|0
)paren
)paren
(brace
id|fe-&gt;min_delay
op_assign
(paren
id|fetunesettings.min_delay_ms
op_star
id|HZ
)paren
op_div
l_int|1000
suffix:semicolon
id|fe-&gt;max_drift
op_assign
id|fetunesettings.max_drift
suffix:semicolon
id|fe-&gt;step_size
op_assign
id|fetunesettings.step_size
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* default values */
r_switch
c_cond
(paren
id|fe-&gt;frontend-&gt;ops-&gt;info.type
)paren
(brace
r_case
id|FE_QPSK
suffix:colon
id|fe-&gt;min_delay
op_assign
id|HZ
op_div
l_int|20
suffix:semicolon
id|fe-&gt;step_size
op_assign
id|fe-&gt;parameters.u.qpsk.symbol_rate
op_div
l_int|16000
suffix:semicolon
id|fe-&gt;max_drift
op_assign
id|fe-&gt;parameters.u.qpsk.symbol_rate
op_div
l_int|2000
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FE_QAM
suffix:colon
id|fe-&gt;min_delay
op_assign
id|HZ
op_div
l_int|20
suffix:semicolon
id|fe-&gt;step_size
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* no zigzag */
id|fe-&gt;max_drift
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FE_OFDM
suffix:colon
id|fe-&gt;min_delay
op_assign
id|HZ
op_div
l_int|20
suffix:semicolon
id|fe-&gt;step_size
op_assign
id|fe-&gt;frontend-&gt;ops-&gt;info.frequency_stepsize
op_star
l_int|2
suffix:semicolon
id|fe-&gt;max_drift
op_assign
(paren
id|fe-&gt;frontend-&gt;ops-&gt;info.frequency_stepsize
op_star
l_int|2
)paren
op_plus
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FE_ATSC
suffix:colon
id|printk
c_func
(paren
l_string|&quot;dvb-core: FE_ATSC not handled yet.&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|dvb_override_tune_delay
OG
l_int|0
)paren
(brace
id|fe-&gt;min_delay
op_assign
(paren
id|dvb_override_tune_delay
op_star
id|HZ
)paren
op_div
l_int|1000
suffix:semicolon
)brace
id|fe-&gt;state
op_assign
id|FESTATE_RETUNE
suffix:semicolon
id|dvb_frontend_wakeup
c_func
(paren
id|fe
)paren
suffix:semicolon
id|dvb_frontend_add_event
(paren
id|fe
comma
l_int|0
)paren
suffix:semicolon
id|fe-&gt;status
op_assign
l_int|0
suffix:semicolon
id|err
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|FE_GET_EVENT
suffix:colon
id|err
op_assign
id|dvb_frontend_get_event
(paren
id|fe
comma
id|parg
comma
id|file-&gt;f_flags
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FE_GET_FRONTEND
suffix:colon
r_if
c_cond
(paren
id|fe-&gt;frontend-&gt;ops-&gt;get_frontend
)paren
(brace
id|memcpy
(paren
id|parg
comma
op_amp
id|fe-&gt;parameters
comma
r_sizeof
(paren
r_struct
id|dvb_frontend_parameters
)paren
)paren
suffix:semicolon
id|err
op_assign
id|fe-&gt;frontend-&gt;ops
op_member_access_from_pointer
id|get_frontend
c_func
(paren
id|fe-&gt;frontend
comma
(paren
r_struct
id|dvb_frontend_parameters
op_star
)paren
id|parg
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
)brace
suffix:semicolon
id|up
(paren
op_amp
id|fe-&gt;sem
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|function|dvb_frontend_poll
r_static
r_int
r_int
id|dvb_frontend_poll
(paren
r_struct
id|file
op_star
id|file
comma
r_struct
id|poll_table_struct
op_star
id|wait
)paren
(brace
r_struct
id|dvb_device
op_star
id|dvbdev
op_assign
id|file-&gt;private_data
suffix:semicolon
r_struct
id|dvb_frontend_data
op_star
id|fe
op_assign
id|dvbdev-&gt;priv
suffix:semicolon
id|dprintk
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
id|poll_wait
(paren
id|file
comma
op_amp
id|fe-&gt;events.wait_queue
comma
id|wait
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fe-&gt;events.eventw
op_ne
id|fe-&gt;events.eventr
)paren
r_return
(paren
id|POLLIN
op_or
id|POLLRDNORM
op_or
id|POLLPRI
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dvb_frontend_open
r_static
r_int
id|dvb_frontend_open
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_struct
id|dvb_device
op_star
id|dvbdev
op_assign
id|file-&gt;private_data
suffix:semicolon
r_struct
id|dvb_frontend_data
op_star
id|fe
op_assign
id|dvbdev-&gt;priv
suffix:semicolon
r_int
id|ret
suffix:semicolon
id|dprintk
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|ret
op_assign
id|dvb_generic_open
(paren
id|inode
comma
id|file
)paren
)paren
OL
l_int|0
)paren
r_return
id|ret
suffix:semicolon
r_if
c_cond
(paren
(paren
id|file-&gt;f_flags
op_amp
id|O_ACCMODE
)paren
op_ne
id|O_RDONLY
)paren
(brace
id|ret
op_assign
id|dvb_frontend_start
(paren
id|fe
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
id|dvb_generic_release
(paren
id|inode
comma
id|file
)paren
suffix:semicolon
multiline_comment|/*  empty event queue */
id|fe-&gt;events.eventr
op_assign
id|fe-&gt;events.eventw
op_assign
l_int|0
suffix:semicolon
)brace
r_return
id|ret
suffix:semicolon
)brace
DECL|function|dvb_frontend_release
r_static
r_int
id|dvb_frontend_release
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_struct
id|dvb_device
op_star
id|dvbdev
op_assign
id|file-&gt;private_data
suffix:semicolon
r_struct
id|dvb_frontend_data
op_star
id|fe
op_assign
id|dvbdev-&gt;priv
suffix:semicolon
id|dprintk
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|file-&gt;f_flags
op_amp
id|O_ACCMODE
)paren
op_ne
id|O_RDONLY
)paren
id|fe-&gt;release_jiffies
op_assign
id|jiffies
suffix:semicolon
r_return
id|dvb_generic_release
(paren
id|inode
comma
id|file
)paren
suffix:semicolon
)brace
DECL|variable|dvb_frontend_fops
r_static
r_struct
id|file_operations
id|dvb_frontend_fops
op_assign
(brace
dot
id|owner
op_assign
id|THIS_MODULE
comma
dot
id|ioctl
op_assign
id|dvb_generic_ioctl
comma
dot
id|poll
op_assign
id|dvb_frontend_poll
comma
dot
id|open
op_assign
id|dvb_frontend_open
comma
dot
id|release
op_assign
id|dvb_frontend_release
)brace
suffix:semicolon
DECL|function|dvb_register_frontend
r_int
id|dvb_register_frontend
c_func
(paren
r_struct
id|dvb_adapter
op_star
id|dvb
comma
r_struct
id|dvb_frontend
op_star
id|frontend
)paren
(brace
r_struct
id|dvb_frontend_data
op_star
id|fe
suffix:semicolon
r_static
r_const
r_struct
id|dvb_device
id|dvbdev_template
op_assign
(brace
dot
id|users
op_assign
op_complement
l_int|0
comma
dot
id|writers
op_assign
l_int|1
comma
dot
id|readers
op_assign
(paren
op_complement
l_int|0
)paren
op_minus
l_int|1
comma
dot
id|fops
op_assign
op_amp
id|dvb_frontend_fops
comma
dot
id|kernel_ioctl
op_assign
id|dvb_frontend_ioctl
)brace
suffix:semicolon
id|dprintk
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_if
c_cond
(paren
id|down_interruptible
(paren
op_amp
id|frontend_mutex
)paren
)paren
r_return
op_minus
id|ERESTARTSYS
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|fe
op_assign
id|kmalloc
(paren
r_sizeof
(paren
r_struct
id|dvb_frontend_data
)paren
comma
id|GFP_KERNEL
)paren
)paren
)paren
(brace
id|up
(paren
op_amp
id|frontend_mutex
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|memset
(paren
id|fe
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|dvb_frontend_data
)paren
)paren
suffix:semicolon
id|init_MUTEX
(paren
op_amp
id|fe-&gt;sem
)paren
suffix:semicolon
id|init_waitqueue_head
(paren
op_amp
id|fe-&gt;wait_queue
)paren
suffix:semicolon
id|init_waitqueue_head
(paren
op_amp
id|fe-&gt;events.wait_queue
)paren
suffix:semicolon
id|init_MUTEX
(paren
op_amp
id|fe-&gt;events.sem
)paren
suffix:semicolon
id|fe-&gt;events.eventw
op_assign
id|fe-&gt;events.eventr
op_assign
l_int|0
suffix:semicolon
id|fe-&gt;events.overflow
op_assign
l_int|0
suffix:semicolon
id|fe-&gt;frontend
op_assign
id|frontend
suffix:semicolon
id|fe-&gt;frontend-&gt;dvb
op_assign
id|dvb
suffix:semicolon
id|fe-&gt;inversion
op_assign
id|INVERSION_OFF
suffix:semicolon
id|list_add_tail
(paren
op_amp
id|fe-&gt;list_head
comma
op_amp
id|frontend_list
)paren
suffix:semicolon
id|printk
(paren
l_string|&quot;DVB: registering frontend %i (%s)...&bslash;n&quot;
comma
id|fe-&gt;frontend-&gt;dvb-&gt;num
comma
id|fe-&gt;frontend-&gt;ops-&gt;info.name
)paren
suffix:semicolon
id|dvb_register_device
(paren
id|fe-&gt;frontend-&gt;dvb
comma
op_amp
id|fe-&gt;dvbdev
comma
op_amp
id|dvbdev_template
comma
id|fe
comma
id|DVB_DEVICE_FRONTEND
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|fe-&gt;frontend-&gt;ops-&gt;info.caps
op_amp
id|FE_NEEDS_BENDING
)paren
op_logical_or
(paren
id|dvb_override_frequency_bending
op_eq
l_int|2
)paren
)paren
id|do_frequency_bending
op_assign
l_int|1
suffix:semicolon
id|up
(paren
op_amp
id|frontend_mutex
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|dvb_register_frontend
id|EXPORT_SYMBOL
c_func
(paren
id|dvb_register_frontend
)paren
suffix:semicolon
DECL|function|dvb_unregister_frontend
r_int
id|dvb_unregister_frontend
(paren
r_struct
id|dvb_frontend
op_star
id|frontend
)paren
(brace
r_struct
id|list_head
op_star
id|entry
comma
op_star
id|n
suffix:semicolon
id|dprintk
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
id|down
(paren
op_amp
id|frontend_mutex
)paren
suffix:semicolon
id|list_for_each_safe
(paren
id|entry
comma
id|n
comma
op_amp
id|frontend_list
)paren
(brace
r_struct
id|dvb_frontend_data
op_star
id|fe
suffix:semicolon
id|fe
op_assign
id|list_entry
(paren
id|entry
comma
r_struct
id|dvb_frontend_data
comma
id|list_head
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fe-&gt;frontend
op_eq
id|frontend
)paren
(brace
id|dvb_unregister_device
(paren
id|fe-&gt;dvbdev
)paren
suffix:semicolon
id|list_del
(paren
id|entry
)paren
suffix:semicolon
id|up
(paren
op_amp
id|frontend_mutex
)paren
suffix:semicolon
id|dvb_frontend_stop
(paren
id|fe
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fe-&gt;frontend-&gt;ops-&gt;release
)paren
(brace
id|fe-&gt;frontend-&gt;ops
op_member_access_from_pointer
id|release
c_func
(paren
id|fe-&gt;frontend
)paren
suffix:semicolon
)brace
r_else
(brace
id|printk
c_func
(paren
l_string|&quot;dvb_frontend: Demodulator (%s) does not have a release callback!&bslash;n&quot;
comma
id|fe-&gt;frontend-&gt;ops-&gt;info.name
)paren
suffix:semicolon
)brace
id|kfree
(paren
id|fe
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
)brace
id|up
(paren
op_amp
id|frontend_mutex
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
DECL|variable|dvb_unregister_frontend
id|EXPORT_SYMBOL
c_func
(paren
id|dvb_unregister_frontend
)paren
suffix:semicolon
eof
