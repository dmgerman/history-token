multiline_comment|/*&n; * $Id: cx88-dvb.c,v 1.12 2004/10/12 07:33:22 kraxel Exp $&n; *&n; * device driver for Conexant 2388x based TV cards&n; * MPEG Transport Stream (DVB) routines&n; *&n; * (c) 2004 Chris Pascoe &lt;c.pascoe@itee.uq.edu.au&gt;&n; * (c) 2004 Gerd Knorr &lt;kraxel@bytesex.org&gt; [SuSE Labs]&n; *&n; *  This program is free software; you can redistribute it and/or modify&n; *  it under the terms of the GNU General Public License as published by&n; *  the Free Software Foundation; either version 2 of the License, or&n; *  (at your option) any later version.&n; *&n; *  This program is distributed in the hope that it will be useful,&n; *  but WITHOUT ANY WARRANTY; without even the implied warranty of&n; *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; *  GNU General Public License for more details.&n; *&n; *  You should have received a copy of the GNU General Public License&n; *  along with this program; if not, write to the Free Software&n; *  Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.&n; */
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/device.h&gt;
macro_line|#include &lt;linux/fs.h&gt;
macro_line|#include &lt;linux/kthread.h&gt;
macro_line|#include &lt;linux/file.h&gt;
macro_line|#include &lt;linux/suspend.h&gt;
macro_line|#include &quot;cx88.h&quot;
macro_line|#include &quot;cx22702.h&quot;
id|MODULE_DESCRIPTION
c_func
(paren
l_string|&quot;driver for cx2388x based DVB cards&quot;
)paren
suffix:semicolon
id|MODULE_AUTHOR
c_func
(paren
l_string|&quot;Chris Pascoe &lt;c.pascoe@itee.uq.edu.au&gt;&quot;
)paren
suffix:semicolon
id|MODULE_AUTHOR
c_func
(paren
l_string|&quot;Gerd Knorr &lt;kraxel@bytesex.org&gt; [SuSE Labs]&quot;
)paren
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
DECL|variable|debug
r_static
r_int
r_int
id|debug
op_assign
l_int|0
suffix:semicolon
id|module_param
c_func
(paren
id|debug
comma
r_int
comma
l_int|0644
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|debug
comma
l_string|&quot;enable debug messages [dvb]&quot;
)paren
suffix:semicolon
DECL|macro|dprintk
mdefine_line|#define dprintk(level,fmt, arg...)&t;if (debug &gt;= level) &bslash;&n;&t;printk(KERN_DEBUG &quot;%s/2-dvb: &quot; fmt, dev-&gt;core-&gt;name , ## arg)
multiline_comment|/* ------------------------------------------------------------------ */
DECL|function|dvb_buf_setup
r_static
r_int
id|dvb_buf_setup
c_func
(paren
r_void
op_star
id|priv
comma
r_int
r_int
op_star
id|count
comma
r_int
r_int
op_star
id|size
)paren
(brace
r_struct
id|cx8802_dev
op_star
id|dev
op_assign
id|priv
suffix:semicolon
id|dev-&gt;ts_packet_size
op_assign
l_int|188
op_star
l_int|4
suffix:semicolon
id|dev-&gt;ts_packet_count
op_assign
l_int|32
suffix:semicolon
op_star
id|size
op_assign
id|dev-&gt;ts_packet_size
op_star
id|dev-&gt;ts_packet_count
suffix:semicolon
op_star
id|count
op_assign
l_int|32
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dvb_buf_prepare
r_static
r_int
id|dvb_buf_prepare
c_func
(paren
r_void
op_star
id|priv
comma
r_struct
id|videobuf_buffer
op_star
id|vb
comma
r_enum
id|v4l2_field
id|field
)paren
(brace
r_struct
id|cx8802_dev
op_star
id|dev
op_assign
id|priv
suffix:semicolon
r_return
id|cx8802_buf_prepare
c_func
(paren
id|dev
comma
(paren
r_struct
id|cx88_buffer
op_star
)paren
id|vb
)paren
suffix:semicolon
)brace
DECL|function|dvb_buf_queue
r_static
r_void
id|dvb_buf_queue
c_func
(paren
r_void
op_star
id|priv
comma
r_struct
id|videobuf_buffer
op_star
id|vb
)paren
(brace
r_struct
id|cx8802_dev
op_star
id|dev
op_assign
id|priv
suffix:semicolon
id|cx8802_buf_queue
c_func
(paren
id|dev
comma
(paren
r_struct
id|cx88_buffer
op_star
)paren
id|vb
)paren
suffix:semicolon
)brace
DECL|function|dvb_buf_release
r_static
r_void
id|dvb_buf_release
c_func
(paren
r_void
op_star
id|priv
comma
r_struct
id|videobuf_buffer
op_star
id|vb
)paren
(brace
r_struct
id|cx8802_dev
op_star
id|dev
op_assign
id|priv
suffix:semicolon
id|cx88_free_buffer
c_func
(paren
id|dev-&gt;pci
comma
(paren
r_struct
id|cx88_buffer
op_star
)paren
id|vb
)paren
suffix:semicolon
)brace
DECL|variable|dvb_qops
r_struct
id|videobuf_queue_ops
id|dvb_qops
op_assign
(brace
dot
id|buf_setup
op_assign
id|dvb_buf_setup
comma
dot
id|buf_prepare
op_assign
id|dvb_buf_prepare
comma
dot
id|buf_queue
op_assign
id|dvb_buf_queue
comma
dot
id|buf_release
op_assign
id|dvb_buf_release
comma
)brace
suffix:semicolon
DECL|function|dvb_thread
r_static
r_int
id|dvb_thread
c_func
(paren
r_void
op_star
id|data
)paren
(brace
r_struct
id|cx8802_dev
op_star
id|dev
op_assign
id|data
suffix:semicolon
r_struct
id|videobuf_buffer
op_star
id|buf
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
id|err
suffix:semicolon
id|dprintk
c_func
(paren
l_int|1
comma
l_string|&quot;dvb thread started&bslash;n&quot;
)paren
suffix:semicolon
id|videobuf_read_start
c_func
(paren
id|dev
comma
op_amp
id|dev-&gt;dvbq
)paren
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
suffix:semicolon
)paren
(brace
multiline_comment|/* fetch next buffer */
id|buf
op_assign
id|list_entry
c_func
(paren
id|dev-&gt;dvbq.stream.next
comma
r_struct
id|videobuf_buffer
comma
id|stream
)paren
suffix:semicolon
id|list_del
c_func
(paren
op_amp
id|buf-&gt;stream
)paren
suffix:semicolon
id|err
op_assign
id|videobuf_waiton
c_func
(paren
id|buf
comma
l_int|0
comma
l_int|1
)paren
suffix:semicolon
id|BUG_ON
c_func
(paren
l_int|0
op_ne
id|err
)paren
suffix:semicolon
multiline_comment|/* no more feeds left or stop_feed() asked us to quit */
r_if
c_cond
(paren
l_int|0
op_eq
id|dev-&gt;nfeeds
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
id|kthread_should_stop
c_func
(paren
)paren
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
id|current-&gt;flags
op_amp
id|PF_FREEZE
)paren
id|refrigerator
c_func
(paren
id|PF_FREEZE
)paren
suffix:semicolon
multiline_comment|/* feed buffer data to demux */
r_if
c_cond
(paren
id|buf-&gt;state
op_eq
id|STATE_DONE
)paren
id|dvb_dmx_swfilter
c_func
(paren
op_amp
id|dev-&gt;demux
comma
id|buf-&gt;dma.vmalloc
comma
id|buf-&gt;size
)paren
suffix:semicolon
multiline_comment|/* requeue buffer */
id|list_add_tail
c_func
(paren
op_amp
id|buf-&gt;stream
comma
op_amp
id|dev-&gt;dvbq.stream
)paren
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
id|dev-&gt;dvbq.irqlock
comma
id|flags
)paren
suffix:semicolon
id|dev-&gt;dvbq.ops
op_member_access_from_pointer
id|buf_queue
c_func
(paren
id|dev
comma
id|buf
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
id|dev-&gt;dvbq.irqlock
comma
id|flags
)paren
suffix:semicolon
multiline_comment|/* log errors if any */
r_if
c_cond
(paren
id|dev-&gt;error_count
op_logical_or
id|dev-&gt;stopper_count
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: error=%d stopper=%d&bslash;n&quot;
comma
id|dev-&gt;core-&gt;name
comma
id|dev-&gt;error_count
comma
id|dev-&gt;stopper_count
)paren
suffix:semicolon
id|dev-&gt;error_count
op_assign
l_int|0
suffix:semicolon
id|dev-&gt;stopper_count
op_assign
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|debug
op_logical_and
id|dev-&gt;timeout_count
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: timeout=%d (FE not locked?)&bslash;n&quot;
comma
id|dev-&gt;core-&gt;name
comma
id|dev-&gt;timeout_count
)paren
suffix:semicolon
id|dev-&gt;timeout_count
op_assign
l_int|0
suffix:semicolon
)brace
)brace
id|videobuf_read_stop
c_func
(paren
id|dev
comma
op_amp
id|dev-&gt;dvbq
)paren
suffix:semicolon
id|dprintk
c_func
(paren
l_int|1
comma
l_string|&quot;dvb thread stopped&bslash;n&quot;
)paren
suffix:semicolon
multiline_comment|/* Hmm, linux becomes *very* unhappy without this ... */
r_while
c_loop
(paren
op_logical_neg
id|kthread_should_stop
c_func
(paren
)paren
)paren
(brace
id|set_current_state
c_func
(paren
id|TASK_UNINTERRUPTIBLE
)paren
suffix:semicolon
id|schedule
c_func
(paren
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* ---------------------------------------------------------------------------- */
DECL|function|dvb_start_feed
r_static
r_int
id|dvb_start_feed
c_func
(paren
r_struct
id|dvb_demux_feed
op_star
id|feed
)paren
(brace
r_struct
id|dvb_demux
op_star
id|demux
op_assign
id|feed-&gt;demux
suffix:semicolon
r_struct
id|cx8802_dev
op_star
id|dev
op_assign
id|demux-&gt;priv
suffix:semicolon
r_int
id|rc
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|demux-&gt;dmx.frontend
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|down
c_func
(paren
op_amp
id|dev-&gt;lock
)paren
suffix:semicolon
id|dev-&gt;nfeeds
op_increment
suffix:semicolon
id|rc
op_assign
id|dev-&gt;nfeeds
suffix:semicolon
r_if
c_cond
(paren
l_int|NULL
op_ne
id|dev-&gt;dvb_thread
)paren
r_goto
id|out
suffix:semicolon
id|dev-&gt;dvb_thread
op_assign
id|kthread_run
c_func
(paren
id|dvb_thread
comma
id|dev
comma
l_string|&quot;%s dvb&quot;
comma
id|dev-&gt;core-&gt;name
)paren
suffix:semicolon
r_if
c_cond
(paren
id|IS_ERR
c_func
(paren
id|dev-&gt;dvb_thread
)paren
)paren
(brace
id|rc
op_assign
id|PTR_ERR
c_func
(paren
id|dev-&gt;dvb_thread
)paren
suffix:semicolon
id|dev-&gt;dvb_thread
op_assign
l_int|NULL
suffix:semicolon
)brace
id|out
suffix:colon
id|up
c_func
(paren
op_amp
id|dev-&gt;lock
)paren
suffix:semicolon
id|dprintk
c_func
(paren
l_int|2
comma
l_string|&quot;%s rc=%d&bslash;n&quot;
comma
id|__FUNCTION__
comma
id|rc
)paren
suffix:semicolon
r_return
id|rc
suffix:semicolon
)brace
DECL|function|dvb_stop_feed
r_static
r_int
id|dvb_stop_feed
c_func
(paren
r_struct
id|dvb_demux_feed
op_star
id|feed
)paren
(brace
r_struct
id|dvb_demux
op_star
id|demux
op_assign
id|feed-&gt;demux
suffix:semicolon
r_struct
id|cx8802_dev
op_star
id|dev
op_assign
id|demux-&gt;priv
suffix:semicolon
r_int
id|err
op_assign
l_int|0
suffix:semicolon
id|dprintk
c_func
(paren
l_int|2
comma
l_string|&quot;%s&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
id|down
c_func
(paren
op_amp
id|dev-&gt;lock
)paren
suffix:semicolon
id|dev-&gt;nfeeds
op_decrement
suffix:semicolon
r_if
c_cond
(paren
l_int|0
op_eq
id|dev-&gt;nfeeds
op_logical_and
l_int|NULL
op_ne
id|dev-&gt;dvb_thread
)paren
(brace
id|cx8802_cancel_buffers
c_func
(paren
id|dev
)paren
suffix:semicolon
id|err
op_assign
id|kthread_stop
c_func
(paren
id|dev-&gt;dvb_thread
)paren
suffix:semicolon
id|dev-&gt;dvb_thread
op_assign
l_int|NULL
suffix:semicolon
)brace
id|up
c_func
(paren
op_amp
id|dev-&gt;lock
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|function|dvb_unregister
r_static
r_void
id|dvb_unregister
c_func
(paren
r_struct
id|cx8802_dev
op_star
id|dev
)paren
(brace
macro_line|#if 1 /* really needed? */
id|down
c_func
(paren
op_amp
id|dev-&gt;lock
)paren
suffix:semicolon
r_if
c_cond
(paren
l_int|NULL
op_ne
id|dev-&gt;dvb_thread
)paren
(brace
id|kthread_stop
c_func
(paren
id|dev-&gt;dvb_thread
)paren
suffix:semicolon
id|BUG
c_func
(paren
)paren
suffix:semicolon
)brace
id|up
c_func
(paren
op_amp
id|dev-&gt;lock
)paren
suffix:semicolon
macro_line|#endif
id|dvb_net_release
c_func
(paren
op_amp
id|dev-&gt;dvbnet
)paren
suffix:semicolon
id|dev-&gt;demux.dmx
dot
id|remove_frontend
c_func
(paren
op_amp
id|dev-&gt;demux.dmx
comma
op_amp
id|dev-&gt;fe_mem
)paren
suffix:semicolon
id|dev-&gt;demux.dmx
dot
id|remove_frontend
c_func
(paren
op_amp
id|dev-&gt;demux.dmx
comma
op_amp
id|dev-&gt;fe_hw
)paren
suffix:semicolon
id|dvb_dmxdev_release
c_func
(paren
op_amp
id|dev-&gt;dmxdev
)paren
suffix:semicolon
id|dvb_dmx_release
c_func
(paren
op_amp
id|dev-&gt;demux
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dev-&gt;fe_handle
)paren
id|dev
op_member_access_from_pointer
id|fe_release
c_func
(paren
id|dev-&gt;fe_handle
)paren
suffix:semicolon
id|dvb_unregister_adapter
c_func
(paren
id|dev-&gt;dvb_adapter
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
DECL|function|dvb_register
r_static
r_int
id|dvb_register
c_func
(paren
r_struct
id|cx8802_dev
op_star
id|dev
)paren
(brace
r_int
id|result
suffix:semicolon
multiline_comment|/* adapter */
id|result
op_assign
id|dvb_register_adapter
c_func
(paren
op_amp
id|dev-&gt;dvb_adapter
comma
id|dev-&gt;core-&gt;name
comma
id|THIS_MODULE
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
OL
l_int|0
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;%s: dvb_register_adapter failed (errno = %d)&bslash;n&quot;
comma
id|dev-&gt;core-&gt;name
comma
id|result
)paren
suffix:semicolon
r_goto
id|fail1
suffix:semicolon
)brace
multiline_comment|/* frontend */
r_switch
c_cond
(paren
id|dev-&gt;core-&gt;board
)paren
(brace
r_case
id|CX88_BOARD_HAUPPAUGE_DVB_T1
suffix:colon
r_case
id|CX88_BOARD_CONEXANT_DVB_T1
suffix:colon
id|dev-&gt;fe_handle
op_assign
id|cx22702_create
c_func
(paren
op_amp
id|dev-&gt;core-&gt;i2c_adap
comma
id|dev-&gt;dvb_adapter
comma
id|dev-&gt;core-&gt;pll_addr
comma
id|dev-&gt;core-&gt;pll_type
comma
id|dev-&gt;core-&gt;demod_addr
)paren
suffix:semicolon
id|dev-&gt;fe_release
op_assign
id|cx22702_destroy
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|printk
c_func
(paren
l_string|&quot;%s: FIXME: frontend handing not here yet ...&bslash;n&quot;
comma
id|dev-&gt;core-&gt;name
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
multiline_comment|/* demux */
id|dev-&gt;demux.dmx.capabilities
op_assign
id|DMX_TS_FILTERING
op_or
id|DMX_SECTION_FILTERING
op_or
id|DMX_MEMORY_BASED_FILTERING
suffix:semicolon
id|dev-&gt;demux.priv
op_assign
id|dev
suffix:semicolon
id|dev-&gt;demux.filternum
op_assign
l_int|256
suffix:semicolon
id|dev-&gt;demux.feednum
op_assign
l_int|256
suffix:semicolon
id|dev-&gt;demux.start_feed
op_assign
id|dvb_start_feed
suffix:semicolon
id|dev-&gt;demux.stop_feed
op_assign
id|dvb_stop_feed
suffix:semicolon
id|result
op_assign
id|dvb_dmx_init
c_func
(paren
op_amp
id|dev-&gt;demux
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
OL
l_int|0
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;%s: dvb_dmx_init failed (errno = %d)&bslash;n&quot;
comma
id|dev-&gt;core-&gt;name
comma
id|result
)paren
suffix:semicolon
r_goto
id|fail2
suffix:semicolon
)brace
id|dev-&gt;dmxdev.filternum
op_assign
l_int|256
suffix:semicolon
id|dev-&gt;dmxdev.demux
op_assign
op_amp
id|dev-&gt;demux.dmx
suffix:semicolon
id|dev-&gt;dmxdev.capabilities
op_assign
l_int|0
suffix:semicolon
id|result
op_assign
id|dvb_dmxdev_init
c_func
(paren
op_amp
id|dev-&gt;dmxdev
comma
id|dev-&gt;dvb_adapter
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
OL
l_int|0
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;%s: dvb_dmxdev_init failed (errno = %d)&bslash;n&quot;
comma
id|dev-&gt;core-&gt;name
comma
id|result
)paren
suffix:semicolon
r_goto
id|fail3
suffix:semicolon
)brace
id|dev-&gt;fe_hw.source
op_assign
id|DMX_FRONTEND_0
suffix:semicolon
id|result
op_assign
id|dev-&gt;demux.dmx
dot
id|add_frontend
c_func
(paren
op_amp
id|dev-&gt;demux.dmx
comma
op_amp
id|dev-&gt;fe_hw
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
OL
l_int|0
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;%s: add_frontend failed (DMX_FRONTEND_0, errno = %d)&bslash;n&quot;
comma
id|dev-&gt;core-&gt;name
comma
id|result
)paren
suffix:semicolon
r_goto
id|fail4
suffix:semicolon
)brace
id|dev-&gt;fe_mem.source
op_assign
id|DMX_MEMORY_FE
suffix:semicolon
id|result
op_assign
id|dev-&gt;demux.dmx
dot
id|add_frontend
c_func
(paren
op_amp
id|dev-&gt;demux.dmx
comma
op_amp
id|dev-&gt;fe_mem
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
OL
l_int|0
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;%s: add_frontend failed (DMX_MEMORY_FE, errno = %d)&bslash;n&quot;
comma
id|dev-&gt;core-&gt;name
comma
id|result
)paren
suffix:semicolon
r_goto
id|fail5
suffix:semicolon
)brace
id|result
op_assign
id|dev-&gt;demux.dmx
dot
id|connect_frontend
c_func
(paren
op_amp
id|dev-&gt;demux.dmx
comma
op_amp
id|dev-&gt;fe_hw
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
OL
l_int|0
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;%s: connect_frontend failed (errno = %d)&bslash;n&quot;
comma
id|dev-&gt;core-&gt;name
comma
id|result
)paren
suffix:semicolon
r_goto
id|fail6
suffix:semicolon
)brace
id|dvb_net_init
c_func
(paren
id|dev-&gt;dvb_adapter
comma
op_amp
id|dev-&gt;dvbnet
comma
op_amp
id|dev-&gt;demux.dmx
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
id|fail6
suffix:colon
id|dev-&gt;demux.dmx
dot
id|remove_frontend
c_func
(paren
op_amp
id|dev-&gt;demux.dmx
comma
op_amp
id|dev-&gt;fe_mem
)paren
suffix:semicolon
id|fail5
suffix:colon
id|dev-&gt;demux.dmx
dot
id|remove_frontend
c_func
(paren
op_amp
id|dev-&gt;demux.dmx
comma
op_amp
id|dev-&gt;fe_hw
)paren
suffix:semicolon
id|fail4
suffix:colon
id|dvb_dmxdev_release
c_func
(paren
op_amp
id|dev-&gt;dmxdev
)paren
suffix:semicolon
id|fail3
suffix:colon
id|dvb_dmx_release
c_func
(paren
op_amp
id|dev-&gt;demux
)paren
suffix:semicolon
id|fail2
suffix:colon
id|dvb_unregister_adapter
c_func
(paren
id|dev-&gt;dvb_adapter
)paren
suffix:semicolon
id|fail1
suffix:colon
r_return
id|result
suffix:semicolon
)brace
multiline_comment|/* ----------------------------------------------------------- */
DECL|function|dvb_probe
r_static
r_int
id|__devinit
id|dvb_probe
c_func
(paren
r_struct
id|pci_dev
op_star
id|pci_dev
comma
r_const
r_struct
id|pci_device_id
op_star
id|pci_id
)paren
(brace
r_struct
id|cx8802_dev
op_star
id|dev
suffix:semicolon
r_struct
id|cx88_core
op_star
id|core
suffix:semicolon
r_int
id|err
suffix:semicolon
multiline_comment|/* general setup */
id|core
op_assign
id|cx88_core_get
c_func
(paren
id|pci_dev
)paren
suffix:semicolon
r_if
c_cond
(paren
l_int|NULL
op_eq
id|core
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|err
op_assign
op_minus
id|ENODEV
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|cx88_boards
(braket
id|core-&gt;board
)braket
dot
id|dvb
)paren
r_goto
id|fail_core
suffix:semicolon
id|err
op_assign
op_minus
id|ENOMEM
suffix:semicolon
id|dev
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
op_star
id|dev
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
l_int|NULL
op_eq
id|dev
)paren
r_goto
id|fail_core
suffix:semicolon
id|memset
c_func
(paren
id|dev
comma
l_int|0
comma
r_sizeof
(paren
op_star
id|dev
)paren
)paren
suffix:semicolon
id|dev-&gt;pci
op_assign
id|pci_dev
suffix:semicolon
id|dev-&gt;core
op_assign
id|core
suffix:semicolon
id|err
op_assign
id|cx8802_init_common
c_func
(paren
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
l_int|0
op_ne
id|err
)paren
r_goto
id|fail_free
suffix:semicolon
multiline_comment|/* dvb stuff */
id|printk
c_func
(paren
l_string|&quot;%s/2: cx2388x based dvb card&bslash;n&quot;
comma
id|core-&gt;name
)paren
suffix:semicolon
id|videobuf_queue_init
c_func
(paren
op_amp
id|dev-&gt;dvbq
comma
op_amp
id|dvb_qops
comma
id|dev-&gt;pci
comma
op_amp
id|dev-&gt;slock
comma
id|V4L2_BUF_TYPE_VIDEO_CAPTURE
comma
id|V4L2_FIELD_TOP
comma
r_sizeof
(paren
r_struct
id|cx88_buffer
)paren
)paren
suffix:semicolon
id|init_MUTEX
c_func
(paren
op_amp
id|dev-&gt;dvbq.lock
)paren
suffix:semicolon
id|err
op_assign
id|dvb_register
c_func
(paren
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
l_int|0
op_ne
id|err
)paren
r_goto
id|fail_free
suffix:semicolon
r_return
l_int|0
suffix:semicolon
id|fail_free
suffix:colon
id|kfree
c_func
(paren
id|dev
)paren
suffix:semicolon
id|fail_core
suffix:colon
id|cx88_core_put
c_func
(paren
id|core
comma
id|pci_dev
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|function|dvb_remove
r_static
r_void
id|__devexit
id|dvb_remove
c_func
(paren
r_struct
id|pci_dev
op_star
id|pci_dev
)paren
(brace
r_struct
id|cx8802_dev
op_star
id|dev
op_assign
id|pci_get_drvdata
c_func
(paren
id|pci_dev
)paren
suffix:semicolon
multiline_comment|/* dvb */
id|dvb_unregister
c_func
(paren
id|dev
)paren
suffix:semicolon
multiline_comment|/* common */
id|cx8802_fini_common
c_func
(paren
id|dev
)paren
suffix:semicolon
id|cx88_core_put
c_func
(paren
id|dev-&gt;core
comma
id|dev-&gt;pci
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|dev
)paren
suffix:semicolon
)brace
DECL|variable|cx8802_pci_tbl
r_static
r_struct
id|pci_device_id
id|cx8802_pci_tbl
(braket
)braket
op_assign
(brace
(brace
dot
id|vendor
op_assign
l_int|0x14f1
comma
dot
id|device
op_assign
l_int|0x8802
comma
dot
id|subvendor
op_assign
id|PCI_ANY_ID
comma
dot
id|subdevice
op_assign
id|PCI_ANY_ID
comma
)brace
comma
(brace
multiline_comment|/* --- end of list --- */
)brace
)brace
suffix:semicolon
id|MODULE_DEVICE_TABLE
c_func
(paren
id|pci
comma
id|cx8802_pci_tbl
)paren
suffix:semicolon
DECL|variable|dvb_pci_driver
r_static
r_struct
id|pci_driver
id|dvb_pci_driver
op_assign
(brace
dot
id|name
op_assign
l_string|&quot;cx88-dvb&quot;
comma
dot
id|id_table
op_assign
id|cx8802_pci_tbl
comma
dot
id|probe
op_assign
id|dvb_probe
comma
dot
id|remove
op_assign
id|dvb_remove
comma
dot
id|suspend
op_assign
id|cx8802_suspend_common
comma
dot
id|resume
op_assign
id|cx8802_resume_common
comma
)brace
suffix:semicolon
DECL|function|dvb_init
r_static
r_int
id|dvb_init
c_func
(paren
r_void
)paren
(brace
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;cx2388x dvb driver version %d.%d.%d loaded&bslash;n&quot;
comma
(paren
id|CX88_VERSION_CODE
op_rshift
l_int|16
)paren
op_amp
l_int|0xff
comma
(paren
id|CX88_VERSION_CODE
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
comma
id|CX88_VERSION_CODE
op_amp
l_int|0xff
)paren
suffix:semicolon
macro_line|#ifdef SNAPSHOT
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;cx2388x: snapshot date %04d-%02d-%02d&bslash;n&quot;
comma
id|SNAPSHOT
op_div
l_int|10000
comma
(paren
id|SNAPSHOT
op_div
l_int|100
)paren
op_mod
l_int|100
comma
id|SNAPSHOT
op_mod
l_int|100
)paren
suffix:semicolon
macro_line|#endif
r_return
id|pci_module_init
c_func
(paren
op_amp
id|dvb_pci_driver
)paren
suffix:semicolon
)brace
DECL|function|dvb_fini
r_static
r_void
id|dvb_fini
c_func
(paren
r_void
)paren
(brace
id|pci_unregister_driver
c_func
(paren
op_amp
id|dvb_pci_driver
)paren
suffix:semicolon
)brace
DECL|variable|dvb_init
id|module_init
c_func
(paren
id|dvb_init
)paren
suffix:semicolon
DECL|variable|dvb_fini
id|module_exit
c_func
(paren
id|dvb_fini
)paren
suffix:semicolon
multiline_comment|/*&n; * Local variables:&n; * c-basic-offset: 8&n; * End:&n; */
eof
