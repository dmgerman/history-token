multiline_comment|/*&n; * drivers/base/power/runtime.c - Handling dynamic device power management.&n; *&n; * Copyright (c) 2003 Patrick Mochel&n; * Copyright (c) 2003 Open Source Development Lab&n; *&n; */
macro_line|#include &lt;linux/device.h&gt;
macro_line|#include &quot;power.h&quot;
DECL|function|runtime_resume
r_static
r_void
id|runtime_resume
c_func
(paren
r_struct
id|device
op_star
id|dev
)paren
(brace
id|dev_dbg
c_func
(paren
id|dev
comma
l_string|&quot;resuming&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dev-&gt;power.power_state
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|resume_device
c_func
(paren
id|dev
)paren
)paren
id|dev-&gt;power.power_state
op_assign
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;dpm_runtime_resume - Power one device back on.&n; *&t;@dev:&t;Device.&n; *&n; *&t;Bring one device back to the on state by first powering it&n; *&t;on, then restoring state. We only operate on devices that aren&squot;t&n; *&t;already on.&n; *&t;FIXME: We need to handle devices that are in an unknown state.&n; */
DECL|function|dpm_runtime_resume
r_void
id|dpm_runtime_resume
c_func
(paren
r_struct
id|device
op_star
id|dev
)paren
(brace
id|down
c_func
(paren
op_amp
id|dpm_sem
)paren
suffix:semicolon
id|runtime_resume
c_func
(paren
id|dev
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|dpm_sem
)paren
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;dpm_runtime_suspend - Put one device in low-power state.&n; *&t;@dev:&t;Device.&n; *&t;@state:&t;State to enter.&n; */
DECL|function|dpm_runtime_suspend
r_int
id|dpm_runtime_suspend
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
id|pm_message_t
id|state
)paren
(brace
r_int
id|error
op_assign
l_int|0
suffix:semicolon
id|down
c_func
(paren
op_amp
id|dpm_sem
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dev-&gt;power.power_state
op_eq
id|state
)paren
r_goto
id|Done
suffix:semicolon
r_if
c_cond
(paren
id|dev-&gt;power.power_state
)paren
id|runtime_resume
c_func
(paren
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|error
op_assign
id|suspend_device
c_func
(paren
id|dev
comma
id|state
)paren
)paren
)paren
id|dev-&gt;power.power_state
op_assign
id|state
suffix:semicolon
id|Done
suffix:colon
id|up
c_func
(paren
op_amp
id|dpm_sem
)paren
suffix:semicolon
r_return
id|error
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;dpm_set_power_state - Update power_state field.&n; *&t;@dev:&t;Device.&n; *&t;@state:&t;Power state device is in.&n; *&n; *&t;This is an update mechanism for drivers to notify the core&n; *&t;what power state a device is in. Device probing code may not&n; *&t;always be able to tell, but we need accurate information to&n; *&t;work reliably.&n; */
DECL|function|dpm_set_power_state
r_void
id|dpm_set_power_state
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
id|pm_message_t
id|state
)paren
(brace
id|down
c_func
(paren
op_amp
id|dpm_sem
)paren
suffix:semicolon
id|dev-&gt;power.power_state
op_assign
id|state
suffix:semicolon
id|up
c_func
(paren
op_amp
id|dpm_sem
)paren
suffix:semicolon
)brace
eof
