multiline_comment|/*&n; * IEEE 1394 for Linux&n; *&n; * Core support: hpsb_packet management, packet handling and forwarding to&n; *               highlevel or lowlevel code&n; *&n; * Copyright (C) 1999, 2000 Andreas E. Bombe&n; *                     2002 Manfred Weihs &lt;weihs@ict.tuwien.ac.at&gt;&n; *&n; * This code is licensed under the GPL.  See the file COPYING in the root&n; * directory of the kernel sources for details.&n; *&n; *&n; * Contributions:&n; *&n; * Manfred Weihs &lt;weihs@ict.tuwien.ac.at&gt;&n; *        loopback functionality in hpsb_send_packet&n; *        allow highlevel drivers to disable automatic response generation&n; *              and to generate responses themselves (deferred)&n; *&n; */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/list.h&gt;
macro_line|#include &lt;linux/string.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;linux/interrupt.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/moduleparam.h&gt;
macro_line|#include &lt;linux/bitops.h&gt;
macro_line|#include &lt;linux/kdev_t.h&gt;
macro_line|#include &lt;linux/skbuff.h&gt;
macro_line|#include &lt;linux/suspend.h&gt;
macro_line|#include &lt;asm/byteorder.h&gt;
macro_line|#include &lt;asm/semaphore.h&gt;
macro_line|#include &quot;ieee1394_types.h&quot;
macro_line|#include &quot;ieee1394.h&quot;
macro_line|#include &quot;hosts.h&quot;
macro_line|#include &quot;ieee1394_core.h&quot;
macro_line|#include &quot;highlevel.h&quot;
macro_line|#include &quot;ieee1394_transactions.h&quot;
macro_line|#include &quot;csr.h&quot;
macro_line|#include &quot;nodemgr.h&quot;
macro_line|#include &quot;dma.h&quot;
macro_line|#include &quot;iso.h&quot;
macro_line|#include &quot;config_roms.h&quot;
multiline_comment|/*&n; * Disable the nodemgr detection and config rom reading functionality.&n; */
DECL|variable|disable_nodemgr
r_static
r_int
id|disable_nodemgr
op_assign
l_int|0
suffix:semicolon
id|module_param
c_func
(paren
id|disable_nodemgr
comma
r_int
comma
l_int|0444
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|disable_nodemgr
comma
l_string|&quot;Disable nodemgr functionality.&quot;
)paren
suffix:semicolon
multiline_comment|/* We are GPL, so treat us special */
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
multiline_comment|/* Some globals used */
DECL|variable|hpsb_speedto_str
r_const
r_char
op_star
id|hpsb_speedto_str
(braket
)braket
op_assign
(brace
l_string|&quot;S100&quot;
comma
l_string|&quot;S200&quot;
comma
l_string|&quot;S400&quot;
comma
l_string|&quot;S800&quot;
comma
l_string|&quot;S1600&quot;
comma
l_string|&quot;S3200&quot;
)brace
suffix:semicolon
DECL|variable|hpsb_protocol_class
r_struct
id|class_simple
op_star
id|hpsb_protocol_class
suffix:semicolon
macro_line|#ifdef CONFIG_IEEE1394_VERBOSEDEBUG
DECL|function|dump_packet
r_static
r_void
id|dump_packet
c_func
(paren
r_const
r_char
op_star
id|text
comma
id|quadlet_t
op_star
id|data
comma
r_int
id|size
)paren
(brace
r_int
id|i
suffix:semicolon
id|size
op_div_assign
l_int|4
suffix:semicolon
id|size
op_assign
(paren
id|size
OG
l_int|4
ques
c_cond
l_int|4
suffix:colon
id|size
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;ieee1394: %s&quot;
comma
id|text
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|size
suffix:semicolon
id|i
op_increment
)paren
id|printk
c_func
(paren
l_string|&quot; %08x&quot;
comma
id|data
(braket
id|i
)braket
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
)brace
macro_line|#else
DECL|macro|dump_packet
mdefine_line|#define dump_packet(x,y,z)
macro_line|#endif
r_static
r_void
id|abort_requests
c_func
(paren
r_struct
id|hpsb_host
op_star
id|host
)paren
suffix:semicolon
r_static
r_void
id|queue_packet_complete
c_func
(paren
r_struct
id|hpsb_packet
op_star
id|packet
)paren
suffix:semicolon
multiline_comment|/**&n; * hpsb_set_packet_complete_task - set the task that runs when a packet&n; * completes. You cannot call this more than once on a single packet&n; * before it is sent.&n; *&n; * @packet: the packet whose completion we want the task added to&n; * @routine: function to call&n; * @data: data (if any) to pass to the above function&n; */
DECL|function|hpsb_set_packet_complete_task
r_void
id|hpsb_set_packet_complete_task
c_func
(paren
r_struct
id|hpsb_packet
op_star
id|packet
comma
r_void
(paren
op_star
id|routine
)paren
(paren
r_void
op_star
)paren
comma
r_void
op_star
id|data
)paren
(brace
id|WARN_ON
c_func
(paren
id|packet-&gt;complete_routine
op_ne
l_int|NULL
)paren
suffix:semicolon
id|packet-&gt;complete_routine
op_assign
id|routine
suffix:semicolon
id|packet-&gt;complete_data
op_assign
id|data
suffix:semicolon
r_return
suffix:semicolon
)brace
multiline_comment|/**&n; * hpsb_alloc_packet - allocate new packet structure&n; * @data_size: size of the data block to be allocated&n; *&n; * This function allocates, initializes and returns a new &amp;struct hpsb_packet.&n; * It can be used in interrupt context.  A header block is always included, its&n; * size is big enough to contain all possible 1394 headers.  The data block is&n; * only allocated when @data_size is not zero.&n; *&n; * For packets for which responses will be received the @data_size has to be big&n; * enough to contain the response&squot;s data block since no further allocation&n; * occurs at response matching time.&n; *&n; * The packet&squot;s generation value will be set to the current generation number&n; * for ease of use.  Remember to overwrite it with your own recorded generation&n; * number if you can not be sure that your code will not race with a bus reset.&n; *&n; * Return value: A pointer to a &amp;struct hpsb_packet or NULL on allocation&n; * failure.&n; */
DECL|function|hpsb_alloc_packet
r_struct
id|hpsb_packet
op_star
id|hpsb_alloc_packet
c_func
(paren
r_int
id|data_size
)paren
(brace
r_struct
id|hpsb_packet
op_star
id|packet
op_assign
l_int|NULL
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|data_size
op_assign
(paren
(paren
id|data_size
op_plus
l_int|3
)paren
op_amp
op_complement
l_int|3
)paren
suffix:semicolon
id|skb
op_assign
id|alloc_skb
c_func
(paren
id|data_size
op_plus
r_sizeof
(paren
op_star
id|packet
)paren
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb
op_eq
l_int|NULL
)paren
r_return
l_int|NULL
suffix:semicolon
id|memset
c_func
(paren
id|skb-&gt;data
comma
l_int|0
comma
id|data_size
op_plus
r_sizeof
(paren
op_star
id|packet
)paren
)paren
suffix:semicolon
id|packet
op_assign
(paren
r_struct
id|hpsb_packet
op_star
)paren
id|skb-&gt;data
suffix:semicolon
id|packet-&gt;skb
op_assign
id|skb
suffix:semicolon
id|packet-&gt;header
op_assign
id|packet-&gt;embedded_header
suffix:semicolon
id|packet-&gt;state
op_assign
id|hpsb_unused
suffix:semicolon
id|packet-&gt;generation
op_assign
op_minus
l_int|1
suffix:semicolon
id|INIT_LIST_HEAD
c_func
(paren
op_amp
id|packet-&gt;driver_list
)paren
suffix:semicolon
id|atomic_set
c_func
(paren
op_amp
id|packet-&gt;refcnt
comma
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|data_size
)paren
(brace
id|packet-&gt;data
op_assign
(paren
id|quadlet_t
op_star
)paren
(paren
id|skb-&gt;data
op_plus
r_sizeof
(paren
op_star
id|packet
)paren
)paren
suffix:semicolon
id|packet-&gt;data_size
op_assign
id|data_size
suffix:semicolon
)brace
r_return
id|packet
suffix:semicolon
)brace
multiline_comment|/**&n; * hpsb_free_packet - free packet and data associated with it&n; * @packet: packet to free (is NULL safe)&n; *&n; * This function will free packet-&gt;data and finally the packet itself.&n; */
DECL|function|hpsb_free_packet
r_void
id|hpsb_free_packet
c_func
(paren
r_struct
id|hpsb_packet
op_star
id|packet
)paren
(brace
r_if
c_cond
(paren
id|packet
op_logical_and
id|atomic_dec_and_test
c_func
(paren
op_amp
id|packet-&gt;refcnt
)paren
)paren
(brace
id|BUG_ON
c_func
(paren
op_logical_neg
id|list_empty
c_func
(paren
op_amp
id|packet-&gt;driver_list
)paren
)paren
suffix:semicolon
id|kfree_skb
c_func
(paren
id|packet-&gt;skb
)paren
suffix:semicolon
)brace
)brace
DECL|function|hpsb_reset_bus
r_int
id|hpsb_reset_bus
c_func
(paren
r_struct
id|hpsb_host
op_star
id|host
comma
r_int
id|type
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|host-&gt;in_bus_reset
)paren
(brace
id|host-&gt;driver
op_member_access_from_pointer
id|devctl
c_func
(paren
id|host
comma
id|RESET_BUS
comma
id|type
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_else
(brace
r_return
l_int|1
suffix:semicolon
)brace
)brace
DECL|function|hpsb_bus_reset
r_int
id|hpsb_bus_reset
c_func
(paren
r_struct
id|hpsb_host
op_star
id|host
)paren
(brace
r_if
c_cond
(paren
id|host-&gt;in_bus_reset
)paren
(brace
id|HPSB_NOTICE
c_func
(paren
l_string|&quot;%s called while bus reset already in progress&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
id|abort_requests
c_func
(paren
id|host
)paren
suffix:semicolon
id|host-&gt;in_bus_reset
op_assign
l_int|1
suffix:semicolon
id|host-&gt;irm_id
op_assign
op_minus
l_int|1
suffix:semicolon
id|host-&gt;is_irm
op_assign
l_int|0
suffix:semicolon
id|host-&gt;busmgr_id
op_assign
op_minus
l_int|1
suffix:semicolon
id|host-&gt;is_busmgr
op_assign
l_int|0
suffix:semicolon
id|host-&gt;is_cycmst
op_assign
l_int|0
suffix:semicolon
id|host-&gt;node_count
op_assign
l_int|0
suffix:semicolon
id|host-&gt;selfid_count
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * Verify num_of_selfids SelfIDs and return number of nodes.  Return zero in&n; * case verification failed.&n; */
DECL|function|check_selfids
r_static
r_int
id|check_selfids
c_func
(paren
r_struct
id|hpsb_host
op_star
id|host
)paren
(brace
r_int
id|nodeid
op_assign
op_minus
l_int|1
suffix:semicolon
r_int
id|rest_of_selfids
op_assign
id|host-&gt;selfid_count
suffix:semicolon
r_struct
id|selfid
op_star
id|sid
op_assign
(paren
r_struct
id|selfid
op_star
)paren
id|host-&gt;topology_map
suffix:semicolon
r_struct
id|ext_selfid
op_star
id|esid
suffix:semicolon
r_int
id|esid_seq
op_assign
l_int|23
suffix:semicolon
id|host-&gt;nodes_active
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
id|rest_of_selfids
op_decrement
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|sid-&gt;extended
)paren
(brace
id|nodeid
op_increment
suffix:semicolon
id|esid_seq
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|sid-&gt;phy_id
op_ne
id|nodeid
)paren
(brace
id|HPSB_INFO
c_func
(paren
l_string|&quot;SelfIDs failed monotony check with &quot;
l_string|&quot;%d&quot;
comma
id|sid-&gt;phy_id
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|sid-&gt;link_active
)paren
(brace
id|host-&gt;nodes_active
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|sid-&gt;contender
)paren
id|host-&gt;irm_id
op_assign
id|LOCAL_BUS
op_or
id|sid-&gt;phy_id
suffix:semicolon
)brace
)brace
r_else
(brace
id|esid
op_assign
(paren
r_struct
id|ext_selfid
op_star
)paren
id|sid
suffix:semicolon
r_if
c_cond
(paren
(paren
id|esid-&gt;phy_id
op_ne
id|nodeid
)paren
op_logical_or
(paren
id|esid-&gt;seq_nr
op_ne
id|esid_seq
)paren
)paren
(brace
id|HPSB_INFO
c_func
(paren
l_string|&quot;SelfIDs failed monotony check with &quot;
l_string|&quot;%d/%d&quot;
comma
id|esid-&gt;phy_id
comma
id|esid-&gt;seq_nr
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|esid_seq
op_increment
suffix:semicolon
)brace
id|sid
op_increment
suffix:semicolon
)brace
id|esid
op_assign
(paren
r_struct
id|ext_selfid
op_star
)paren
(paren
id|sid
op_minus
l_int|1
)paren
suffix:semicolon
r_while
c_loop
(paren
id|esid-&gt;extended
)paren
(brace
r_if
c_cond
(paren
(paren
id|esid-&gt;porta
op_eq
l_int|0x2
)paren
op_logical_or
(paren
id|esid-&gt;portb
op_eq
l_int|0x2
)paren
op_logical_or
(paren
id|esid-&gt;portc
op_eq
l_int|0x2
)paren
op_logical_or
(paren
id|esid-&gt;portd
op_eq
l_int|0x2
)paren
op_logical_or
(paren
id|esid-&gt;porte
op_eq
l_int|0x2
)paren
op_logical_or
(paren
id|esid-&gt;portf
op_eq
l_int|0x2
)paren
op_logical_or
(paren
id|esid-&gt;portg
op_eq
l_int|0x2
)paren
op_logical_or
(paren
id|esid-&gt;porth
op_eq
l_int|0x2
)paren
)paren
(brace
id|HPSB_INFO
c_func
(paren
l_string|&quot;SelfIDs failed root check on &quot;
l_string|&quot;extended SelfID&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|esid
op_decrement
suffix:semicolon
)brace
id|sid
op_assign
(paren
r_struct
id|selfid
op_star
)paren
id|esid
suffix:semicolon
r_if
c_cond
(paren
(paren
id|sid-&gt;port0
op_eq
l_int|0x2
)paren
op_logical_or
(paren
id|sid-&gt;port1
op_eq
l_int|0x2
)paren
op_logical_or
(paren
id|sid-&gt;port2
op_eq
l_int|0x2
)paren
)paren
(brace
id|HPSB_INFO
c_func
(paren
l_string|&quot;SelfIDs failed root check&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|host-&gt;node_count
op_assign
id|nodeid
op_plus
l_int|1
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|build_speed_map
r_static
r_void
id|build_speed_map
c_func
(paren
r_struct
id|hpsb_host
op_star
id|host
comma
r_int
id|nodecount
)paren
(brace
id|u8
id|speedcap
(braket
id|nodecount
)braket
suffix:semicolon
id|u8
id|cldcnt
(braket
id|nodecount
)braket
suffix:semicolon
id|u8
op_star
id|map
op_assign
id|host-&gt;speed_map
suffix:semicolon
r_struct
id|selfid
op_star
id|sid
suffix:semicolon
r_struct
id|ext_selfid
op_star
id|esid
suffix:semicolon
r_int
id|i
comma
id|j
comma
id|n
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
(paren
id|nodecount
op_star
l_int|64
)paren
suffix:semicolon
id|i
op_add_assign
l_int|64
)paren
(brace
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
id|nodecount
suffix:semicolon
id|j
op_increment
)paren
(brace
id|map
(braket
id|i
op_plus
id|j
)braket
op_assign
id|IEEE1394_SPEED_MAX
suffix:semicolon
)brace
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|nodecount
suffix:semicolon
id|i
op_increment
)paren
(brace
id|cldcnt
(braket
id|i
)braket
op_assign
l_int|0
suffix:semicolon
)brace
multiline_comment|/* find direct children count and speed */
r_for
c_loop
(paren
id|sid
op_assign
(paren
r_struct
id|selfid
op_star
)paren
op_amp
id|host-&gt;topology_map
(braket
id|host-&gt;selfid_count
op_minus
l_int|1
)braket
comma
id|n
op_assign
id|nodecount
op_minus
l_int|1
suffix:semicolon
(paren
r_void
op_star
)paren
id|sid
op_ge
(paren
r_void
op_star
)paren
id|host-&gt;topology_map
suffix:semicolon
id|sid
op_decrement
)paren
(brace
r_if
c_cond
(paren
id|sid-&gt;extended
)paren
(brace
id|esid
op_assign
(paren
r_struct
id|ext_selfid
op_star
)paren
id|sid
suffix:semicolon
r_if
c_cond
(paren
id|esid-&gt;porta
op_eq
l_int|0x3
)paren
id|cldcnt
(braket
id|n
)braket
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|esid-&gt;portb
op_eq
l_int|0x3
)paren
id|cldcnt
(braket
id|n
)braket
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|esid-&gt;portc
op_eq
l_int|0x3
)paren
id|cldcnt
(braket
id|n
)braket
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|esid-&gt;portd
op_eq
l_int|0x3
)paren
id|cldcnt
(braket
id|n
)braket
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|esid-&gt;porte
op_eq
l_int|0x3
)paren
id|cldcnt
(braket
id|n
)braket
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|esid-&gt;portf
op_eq
l_int|0x3
)paren
id|cldcnt
(braket
id|n
)braket
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|esid-&gt;portg
op_eq
l_int|0x3
)paren
id|cldcnt
(braket
id|n
)braket
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|esid-&gt;porth
op_eq
l_int|0x3
)paren
id|cldcnt
(braket
id|n
)braket
op_increment
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|sid-&gt;port0
op_eq
l_int|0x3
)paren
id|cldcnt
(braket
id|n
)braket
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|sid-&gt;port1
op_eq
l_int|0x3
)paren
id|cldcnt
(braket
id|n
)braket
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|sid-&gt;port2
op_eq
l_int|0x3
)paren
id|cldcnt
(braket
id|n
)braket
op_increment
suffix:semicolon
id|speedcap
(braket
id|n
)braket
op_assign
id|sid-&gt;speed
suffix:semicolon
id|n
op_decrement
suffix:semicolon
)brace
)brace
multiline_comment|/* set self mapping */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|nodecount
suffix:semicolon
id|i
op_increment
)paren
(brace
id|map
(braket
l_int|64
op_star
id|i
op_plus
id|i
)braket
op_assign
id|speedcap
(braket
id|i
)braket
suffix:semicolon
)brace
multiline_comment|/* fix up direct children count to total children count;&n;         * also fix up speedcaps for sibling and parent communication */
r_for
c_loop
(paren
id|i
op_assign
l_int|1
suffix:semicolon
id|i
OL
id|nodecount
suffix:semicolon
id|i
op_increment
)paren
(brace
r_for
c_loop
(paren
id|j
op_assign
id|cldcnt
(braket
id|i
)braket
comma
id|n
op_assign
id|i
op_minus
l_int|1
suffix:semicolon
id|j
OG
l_int|0
suffix:semicolon
id|j
op_decrement
)paren
(brace
id|cldcnt
(braket
id|i
)braket
op_add_assign
id|cldcnt
(braket
id|n
)braket
suffix:semicolon
id|speedcap
(braket
id|n
)braket
op_assign
id|min
c_func
(paren
id|speedcap
(braket
id|n
)braket
comma
id|speedcap
(braket
id|i
)braket
)paren
suffix:semicolon
id|n
op_sub_assign
id|cldcnt
(braket
id|n
)braket
op_plus
l_int|1
suffix:semicolon
)brace
)brace
r_for
c_loop
(paren
id|n
op_assign
l_int|0
suffix:semicolon
id|n
OL
id|nodecount
suffix:semicolon
id|n
op_increment
)paren
(brace
r_for
c_loop
(paren
id|i
op_assign
id|n
op_minus
id|cldcnt
(braket
id|n
)braket
suffix:semicolon
id|i
op_le
id|n
suffix:semicolon
id|i
op_increment
)paren
(brace
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
(paren
id|n
op_minus
id|cldcnt
(braket
id|n
)braket
)paren
suffix:semicolon
id|j
op_increment
)paren
(brace
id|map
(braket
id|j
op_star
l_int|64
op_plus
id|i
)braket
op_assign
id|map
(braket
id|i
op_star
l_int|64
op_plus
id|j
)braket
op_assign
id|min
c_func
(paren
id|map
(braket
id|i
op_star
l_int|64
op_plus
id|j
)braket
comma
id|speedcap
(braket
id|n
)braket
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|j
op_assign
id|n
op_plus
l_int|1
suffix:semicolon
id|j
OL
id|nodecount
suffix:semicolon
id|j
op_increment
)paren
(brace
id|map
(braket
id|j
op_star
l_int|64
op_plus
id|i
)braket
op_assign
id|map
(braket
id|i
op_star
l_int|64
op_plus
id|j
)braket
op_assign
id|min
c_func
(paren
id|map
(braket
id|i
op_star
l_int|64
op_plus
id|j
)braket
comma
id|speedcap
(braket
id|n
)braket
)paren
suffix:semicolon
)brace
)brace
)brace
)brace
DECL|function|hpsb_selfid_received
r_void
id|hpsb_selfid_received
c_func
(paren
r_struct
id|hpsb_host
op_star
id|host
comma
id|quadlet_t
id|sid
)paren
(brace
r_if
c_cond
(paren
id|host-&gt;in_bus_reset
)paren
(brace
id|HPSB_VERBOSE
c_func
(paren
l_string|&quot;Including SelfID 0x%x&quot;
comma
id|sid
)paren
suffix:semicolon
id|host-&gt;topology_map
(braket
id|host-&gt;selfid_count
op_increment
)braket
op_assign
id|sid
suffix:semicolon
)brace
r_else
(brace
id|HPSB_NOTICE
c_func
(paren
l_string|&quot;Spurious SelfID packet (0x%08x) received from bus %d&quot;
comma
id|sid
comma
id|NODEID_TO_BUS
c_func
(paren
id|host-&gt;node_id
)paren
)paren
suffix:semicolon
)brace
)brace
DECL|function|hpsb_selfid_complete
r_void
id|hpsb_selfid_complete
c_func
(paren
r_struct
id|hpsb_host
op_star
id|host
comma
r_int
id|phyid
comma
r_int
id|isroot
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|host-&gt;in_bus_reset
)paren
id|HPSB_NOTICE
c_func
(paren
l_string|&quot;SelfID completion called outside of bus reset!&quot;
)paren
suffix:semicolon
id|host-&gt;node_id
op_assign
id|LOCAL_BUS
op_or
id|phyid
suffix:semicolon
id|host-&gt;is_root
op_assign
id|isroot
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|check_selfids
c_func
(paren
id|host
)paren
)paren
(brace
r_if
c_cond
(paren
id|host-&gt;reset_retries
op_increment
OL
l_int|20
)paren
(brace
multiline_comment|/* selfid stage did not complete without error */
id|HPSB_NOTICE
c_func
(paren
l_string|&quot;Error in SelfID stage, resetting&quot;
)paren
suffix:semicolon
id|host-&gt;in_bus_reset
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* this should work from ohci1394 now... */
id|hpsb_reset_bus
c_func
(paren
id|host
comma
id|LONG_RESET
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_else
(brace
id|HPSB_NOTICE
c_func
(paren
l_string|&quot;Stopping out-of-control reset loop&quot;
)paren
suffix:semicolon
id|HPSB_NOTICE
c_func
(paren
l_string|&quot;Warning - topology map and speed map will not be valid&quot;
)paren
suffix:semicolon
id|host-&gt;reset_retries
op_assign
l_int|0
suffix:semicolon
)brace
)brace
r_else
(brace
id|host-&gt;reset_retries
op_assign
l_int|0
suffix:semicolon
id|build_speed_map
c_func
(paren
id|host
comma
id|host-&gt;node_count
)paren
suffix:semicolon
)brace
id|HPSB_VERBOSE
c_func
(paren
l_string|&quot;selfid_complete called with successful SelfID stage &quot;
l_string|&quot;... irm_id: 0x%X node_id: 0x%X&quot;
comma
id|host-&gt;irm_id
comma
id|host-&gt;node_id
)paren
suffix:semicolon
multiline_comment|/* irm_id is kept up to date by check_selfids() */
r_if
c_cond
(paren
id|host-&gt;irm_id
op_eq
id|host-&gt;node_id
)paren
(brace
id|host-&gt;is_irm
op_assign
l_int|1
suffix:semicolon
)brace
r_else
(brace
id|host-&gt;is_busmgr
op_assign
l_int|0
suffix:semicolon
id|host-&gt;is_irm
op_assign
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|isroot
)paren
(brace
id|host-&gt;driver
op_member_access_from_pointer
id|devctl
c_func
(paren
id|host
comma
id|ACT_CYCLE_MASTER
comma
l_int|1
)paren
suffix:semicolon
id|host-&gt;is_cycmst
op_assign
l_int|1
suffix:semicolon
)brace
id|atomic_inc
c_func
(paren
op_amp
id|host-&gt;generation
)paren
suffix:semicolon
id|host-&gt;in_bus_reset
op_assign
l_int|0
suffix:semicolon
id|highlevel_host_reset
c_func
(paren
id|host
)paren
suffix:semicolon
)brace
DECL|function|hpsb_packet_sent
r_void
id|hpsb_packet_sent
c_func
(paren
r_struct
id|hpsb_host
op_star
id|host
comma
r_struct
id|hpsb_packet
op_star
id|packet
comma
r_int
id|ackcode
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|host-&gt;pending_packet_queue.lock
comma
id|flags
)paren
suffix:semicolon
id|packet-&gt;ack_code
op_assign
id|ackcode
suffix:semicolon
r_if
c_cond
(paren
id|packet-&gt;no_waiter
op_logical_or
id|packet-&gt;state
op_eq
id|hpsb_complete
)paren
(brace
multiline_comment|/* if packet-&gt;no_waiter, must not have a tlabel allocated */
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|host-&gt;pending_packet_queue.lock
comma
id|flags
)paren
suffix:semicolon
id|hpsb_free_packet
c_func
(paren
id|packet
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|atomic_dec
c_func
(paren
op_amp
id|packet-&gt;refcnt
)paren
suffix:semicolon
multiline_comment|/* drop HC&squot;s reference */
multiline_comment|/* here the packet must be on the host-&gt;pending_packet_queue */
r_if
c_cond
(paren
id|ackcode
op_ne
id|ACK_PENDING
op_logical_or
op_logical_neg
id|packet-&gt;expect_response
)paren
(brace
id|packet-&gt;state
op_assign
id|hpsb_complete
suffix:semicolon
id|__skb_unlink
c_func
(paren
id|packet-&gt;skb
comma
op_amp
id|host-&gt;pending_packet_queue
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|host-&gt;pending_packet_queue.lock
comma
id|flags
)paren
suffix:semicolon
id|queue_packet_complete
c_func
(paren
id|packet
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|packet-&gt;state
op_assign
id|hpsb_pending
suffix:semicolon
id|packet-&gt;sendtime
op_assign
id|jiffies
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|host-&gt;pending_packet_queue.lock
comma
id|flags
)paren
suffix:semicolon
id|mod_timer
c_func
(paren
op_amp
id|host-&gt;timeout
comma
id|jiffies
op_plus
id|host-&gt;timeout_interval
)paren
suffix:semicolon
)brace
multiline_comment|/**&n; * hpsb_send_phy_config - transmit a PHY configuration packet on the bus&n; * @host: host that PHY config packet gets sent through&n; * @rootid: root whose force_root bit should get set (-1 = don&squot;t set force_root)&n; * @gapcnt: gap count value to set (-1 = don&squot;t set gap count)&n; *&n; * This function sends a PHY config packet on the bus through the specified host.&n; *&n; * Return value: 0 for success or error number otherwise.&n; */
DECL|function|hpsb_send_phy_config
r_int
id|hpsb_send_phy_config
c_func
(paren
r_struct
id|hpsb_host
op_star
id|host
comma
r_int
id|rootid
comma
r_int
id|gapcnt
)paren
(brace
r_struct
id|hpsb_packet
op_star
id|packet
suffix:semicolon
r_int
id|retval
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|rootid
op_ge
id|ALL_NODES
op_logical_or
id|rootid
template_param
l_int|0x3f
op_logical_or
id|gapcnt
OL
op_minus
l_int|1
op_logical_or
(paren
id|rootid
op_eq
op_minus
l_int|1
op_logical_and
id|gapcnt
op_eq
op_minus
l_int|1
)paren
)paren
(brace
id|HPSB_DEBUG
c_func
(paren
l_string|&quot;Invalid Parameter: rootid = %d   gapcnt = %d&quot;
comma
id|rootid
comma
id|gapcnt
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|packet
op_assign
id|hpsb_alloc_packet
c_func
(paren
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|packet
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|packet-&gt;host
op_assign
id|host
suffix:semicolon
id|packet-&gt;header_size
op_assign
l_int|8
suffix:semicolon
id|packet-&gt;data_size
op_assign
l_int|0
suffix:semicolon
id|packet-&gt;expect_response
op_assign
l_int|0
suffix:semicolon
id|packet-&gt;no_waiter
op_assign
l_int|0
suffix:semicolon
id|packet-&gt;type
op_assign
id|hpsb_raw
suffix:semicolon
id|packet-&gt;header
(braket
l_int|0
)braket
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|rootid
op_ne
op_minus
l_int|1
)paren
id|packet-&gt;header
(braket
l_int|0
)braket
op_or_assign
id|rootid
op_lshift
l_int|24
op_or
l_int|1
op_lshift
l_int|23
suffix:semicolon
r_if
c_cond
(paren
id|gapcnt
op_ne
op_minus
l_int|1
)paren
id|packet-&gt;header
(braket
l_int|0
)braket
op_or_assign
id|gapcnt
op_lshift
l_int|16
op_or
l_int|1
op_lshift
l_int|22
suffix:semicolon
id|packet-&gt;header
(braket
l_int|1
)braket
op_assign
op_complement
id|packet-&gt;header
(braket
l_int|0
)braket
suffix:semicolon
id|packet-&gt;generation
op_assign
id|get_hpsb_generation
c_func
(paren
id|host
)paren
suffix:semicolon
id|retval
op_assign
id|hpsb_send_packet_and_wait
c_func
(paren
id|packet
)paren
suffix:semicolon
id|hpsb_free_packet
c_func
(paren
id|packet
)paren
suffix:semicolon
r_return
id|retval
suffix:semicolon
)brace
multiline_comment|/**&n; * hpsb_send_packet - transmit a packet on the bus&n; * @packet: packet to send&n; *&n; * The packet is sent through the host specified in the packet-&gt;host field.&n; * Before sending, the packet&squot;s transmit speed is automatically determined&n; * using the local speed map when it is an async, non-broadcast packet.&n; *&n; * Possibilities for failure are that host is either not initialized, in bus&n; * reset, the packet&squot;s generation number doesn&squot;t match the current generation&n; * number or the host reports a transmit error.&n; *&n; * Return value: 0 on success, negative errno on failure.&n; */
DECL|function|hpsb_send_packet
r_int
id|hpsb_send_packet
c_func
(paren
r_struct
id|hpsb_packet
op_star
id|packet
)paren
(brace
r_struct
id|hpsb_host
op_star
id|host
op_assign
id|packet-&gt;host
suffix:semicolon
r_if
c_cond
(paren
id|host-&gt;is_shutdown
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|host-&gt;in_bus_reset
op_logical_or
(paren
id|packet-&gt;generation
op_ne
id|get_hpsb_generation
c_func
(paren
id|host
)paren
)paren
)paren
r_return
op_minus
id|EAGAIN
suffix:semicolon
id|packet-&gt;state
op_assign
id|hpsb_queued
suffix:semicolon
multiline_comment|/* This just seems silly to me */
id|WARN_ON
c_func
(paren
id|packet-&gt;no_waiter
op_logical_and
id|packet-&gt;expect_response
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|packet-&gt;no_waiter
op_logical_or
id|packet-&gt;expect_response
)paren
(brace
id|atomic_inc
c_func
(paren
op_amp
id|packet-&gt;refcnt
)paren
suffix:semicolon
id|packet-&gt;sendtime
op_assign
id|jiffies
suffix:semicolon
id|skb_queue_tail
c_func
(paren
op_amp
id|host-&gt;pending_packet_queue
comma
id|packet-&gt;skb
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|packet-&gt;node_id
op_eq
id|host-&gt;node_id
)paren
(brace
multiline_comment|/* it is a local request, so handle it locally */
id|quadlet_t
op_star
id|data
suffix:semicolon
r_int
id|size
op_assign
id|packet-&gt;data_size
op_plus
id|packet-&gt;header_size
suffix:semicolon
id|data
op_assign
id|kmalloc
c_func
(paren
id|size
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|data
)paren
(brace
id|HPSB_ERR
c_func
(paren
l_string|&quot;unable to allocate memory for concatenating header and data&quot;
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|data
comma
id|packet-&gt;header
comma
id|packet-&gt;header_size
)paren
suffix:semicolon
r_if
c_cond
(paren
id|packet-&gt;data_size
)paren
id|memcpy
c_func
(paren
(paren
(paren
id|u8
op_star
)paren
id|data
)paren
op_plus
id|packet-&gt;header_size
comma
id|packet-&gt;data
comma
id|packet-&gt;data_size
)paren
suffix:semicolon
id|dump_packet
c_func
(paren
l_string|&quot;send packet local:&quot;
comma
id|packet-&gt;header
comma
id|packet-&gt;header_size
)paren
suffix:semicolon
id|hpsb_packet_sent
c_func
(paren
id|host
comma
id|packet
comma
id|packet-&gt;expect_response
ques
c_cond
id|ACK_PENDING
suffix:colon
id|ACK_COMPLETE
)paren
suffix:semicolon
id|hpsb_packet_received
c_func
(paren
id|host
comma
id|data
comma
id|size
comma
l_int|0
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|data
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|packet-&gt;type
op_eq
id|hpsb_async
op_logical_and
id|packet-&gt;node_id
op_ne
id|ALL_NODES
)paren
(brace
id|packet-&gt;speed_code
op_assign
id|host-&gt;speed_map
(braket
id|NODEID_TO_NODE
c_func
(paren
id|host-&gt;node_id
)paren
op_star
l_int|64
op_plus
id|NODEID_TO_NODE
c_func
(paren
id|packet-&gt;node_id
)paren
)braket
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_IEEE1394_VERBOSEDEBUG
r_switch
c_cond
(paren
id|packet-&gt;speed_code
)paren
(brace
r_case
l_int|2
suffix:colon
id|dump_packet
c_func
(paren
l_string|&quot;send packet 400:&quot;
comma
id|packet-&gt;header
comma
id|packet-&gt;header_size
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|dump_packet
c_func
(paren
l_string|&quot;send packet 200:&quot;
comma
id|packet-&gt;header
comma
id|packet-&gt;header_size
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|dump_packet
c_func
(paren
l_string|&quot;send packet 100:&quot;
comma
id|packet-&gt;header
comma
id|packet-&gt;header_size
)paren
suffix:semicolon
)brace
macro_line|#endif
r_return
id|host-&gt;driver
op_member_access_from_pointer
id|transmit_packet
c_func
(paren
id|host
comma
id|packet
)paren
suffix:semicolon
)brace
multiline_comment|/* We could just use complete() directly as the packet complete&n; * callback, but this is more typesafe, in the sense that we get a&n; * compiler error if the prototype for complete() changes. */
DECL|function|complete_packet
r_static
r_void
id|complete_packet
c_func
(paren
r_void
op_star
id|data
)paren
(brace
id|complete
c_func
(paren
(paren
r_struct
id|completion
op_star
)paren
id|data
)paren
suffix:semicolon
)brace
DECL|function|hpsb_send_packet_and_wait
r_int
id|hpsb_send_packet_and_wait
c_func
(paren
r_struct
id|hpsb_packet
op_star
id|packet
)paren
(brace
r_struct
id|completion
id|done
suffix:semicolon
r_int
id|retval
suffix:semicolon
id|init_completion
c_func
(paren
op_amp
id|done
)paren
suffix:semicolon
id|hpsb_set_packet_complete_task
c_func
(paren
id|packet
comma
id|complete_packet
comma
op_amp
id|done
)paren
suffix:semicolon
id|retval
op_assign
id|hpsb_send_packet
c_func
(paren
id|packet
)paren
suffix:semicolon
r_if
c_cond
(paren
id|retval
op_eq
l_int|0
)paren
id|wait_for_completion
c_func
(paren
op_amp
id|done
)paren
suffix:semicolon
r_return
id|retval
suffix:semicolon
)brace
DECL|function|send_packet_nocare
r_static
r_void
id|send_packet_nocare
c_func
(paren
r_struct
id|hpsb_packet
op_star
id|packet
)paren
(brace
r_if
c_cond
(paren
id|hpsb_send_packet
c_func
(paren
id|packet
)paren
OL
l_int|0
)paren
(brace
id|hpsb_free_packet
c_func
(paren
id|packet
)paren
suffix:semicolon
)brace
)brace
DECL|function|handle_packet_response
r_static
r_void
id|handle_packet_response
c_func
(paren
r_struct
id|hpsb_host
op_star
id|host
comma
r_int
id|tcode
comma
id|quadlet_t
op_star
id|data
comma
r_int
id|size
)paren
(brace
r_struct
id|hpsb_packet
op_star
id|packet
op_assign
l_int|NULL
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
r_int
id|tcode_match
op_assign
l_int|0
suffix:semicolon
r_int
id|tlabel
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|tlabel
op_assign
(paren
id|data
(braket
l_int|0
)braket
op_rshift
l_int|10
)paren
op_amp
l_int|0x3f
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|host-&gt;pending_packet_queue.lock
comma
id|flags
)paren
suffix:semicolon
id|skb_queue_walk
c_func
(paren
op_amp
id|host-&gt;pending_packet_queue
comma
id|skb
)paren
(brace
id|packet
op_assign
(paren
r_struct
id|hpsb_packet
op_star
)paren
id|skb-&gt;data
suffix:semicolon
r_if
c_cond
(paren
(paren
id|packet-&gt;tlabel
op_eq
id|tlabel
)paren
op_logical_and
(paren
id|packet-&gt;node_id
op_eq
(paren
id|data
(braket
l_int|1
)braket
op_rshift
l_int|16
)paren
)paren
)paren
(brace
r_break
suffix:semicolon
)brace
id|packet
op_assign
l_int|NULL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|packet
op_eq
l_int|NULL
)paren
(brace
id|HPSB_DEBUG
c_func
(paren
l_string|&quot;unsolicited response packet received - no tlabel match&quot;
)paren
suffix:semicolon
id|dump_packet
c_func
(paren
l_string|&quot;contents:&quot;
comma
id|data
comma
l_int|16
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|host-&gt;pending_packet_queue.lock
comma
id|flags
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|packet-&gt;tcode
)paren
(brace
r_case
id|TCODE_WRITEQ
suffix:colon
r_case
id|TCODE_WRITEB
suffix:colon
r_if
c_cond
(paren
id|tcode
op_ne
id|TCODE_WRITE_RESPONSE
)paren
r_break
suffix:semicolon
id|tcode_match
op_assign
l_int|1
suffix:semicolon
id|memcpy
c_func
(paren
id|packet-&gt;header
comma
id|data
comma
l_int|12
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|TCODE_READQ
suffix:colon
r_if
c_cond
(paren
id|tcode
op_ne
id|TCODE_READQ_RESPONSE
)paren
r_break
suffix:semicolon
id|tcode_match
op_assign
l_int|1
suffix:semicolon
id|memcpy
c_func
(paren
id|packet-&gt;header
comma
id|data
comma
l_int|16
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|TCODE_READB
suffix:colon
r_if
c_cond
(paren
id|tcode
op_ne
id|TCODE_READB_RESPONSE
)paren
r_break
suffix:semicolon
id|tcode_match
op_assign
l_int|1
suffix:semicolon
id|BUG_ON
c_func
(paren
id|packet-&gt;skb-&gt;len
op_minus
r_sizeof
(paren
op_star
id|packet
)paren
OL
id|size
op_minus
l_int|16
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|packet-&gt;header
comma
id|data
comma
l_int|16
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|packet-&gt;data
comma
id|data
op_plus
l_int|4
comma
id|size
op_minus
l_int|16
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|TCODE_LOCK_REQUEST
suffix:colon
r_if
c_cond
(paren
id|tcode
op_ne
id|TCODE_LOCK_RESPONSE
)paren
r_break
suffix:semicolon
id|tcode_match
op_assign
l_int|1
suffix:semicolon
id|size
op_assign
id|min
c_func
(paren
(paren
id|size
op_minus
l_int|16
)paren
comma
(paren
r_int
)paren
l_int|8
)paren
suffix:semicolon
id|BUG_ON
c_func
(paren
id|packet-&gt;skb-&gt;len
op_minus
r_sizeof
(paren
op_star
id|packet
)paren
OL
id|size
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|packet-&gt;header
comma
id|data
comma
l_int|16
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|packet-&gt;data
comma
id|data
op_plus
l_int|4
comma
id|size
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|tcode_match
)paren
(brace
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|host-&gt;pending_packet_queue.lock
comma
id|flags
)paren
suffix:semicolon
id|HPSB_INFO
c_func
(paren
l_string|&quot;unsolicited response packet received - tcode mismatch&quot;
)paren
suffix:semicolon
id|dump_packet
c_func
(paren
l_string|&quot;contents:&quot;
comma
id|data
comma
l_int|16
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|__skb_unlink
c_func
(paren
id|skb
comma
id|skb-&gt;list
)paren
suffix:semicolon
r_if
c_cond
(paren
id|packet-&gt;state
op_eq
id|hpsb_queued
)paren
(brace
id|packet-&gt;sendtime
op_assign
id|jiffies
suffix:semicolon
id|packet-&gt;ack_code
op_assign
id|ACK_PENDING
suffix:semicolon
)brace
id|packet-&gt;state
op_assign
id|hpsb_complete
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|host-&gt;pending_packet_queue.lock
comma
id|flags
)paren
suffix:semicolon
id|queue_packet_complete
c_func
(paren
id|packet
)paren
suffix:semicolon
)brace
DECL|function|create_reply_packet
r_static
r_struct
id|hpsb_packet
op_star
id|create_reply_packet
c_func
(paren
r_struct
id|hpsb_host
op_star
id|host
comma
id|quadlet_t
op_star
id|data
comma
r_int
id|dsize
)paren
(brace
r_struct
id|hpsb_packet
op_star
id|p
suffix:semicolon
id|p
op_assign
id|hpsb_alloc_packet
c_func
(paren
id|dsize
)paren
suffix:semicolon
r_if
c_cond
(paren
id|unlikely
c_func
(paren
id|p
op_eq
l_int|NULL
)paren
)paren
(brace
multiline_comment|/* FIXME - send data_error response */
r_return
l_int|NULL
suffix:semicolon
)brace
id|p-&gt;type
op_assign
id|hpsb_async
suffix:semicolon
id|p-&gt;state
op_assign
id|hpsb_unused
suffix:semicolon
id|p-&gt;host
op_assign
id|host
suffix:semicolon
id|p-&gt;node_id
op_assign
id|data
(braket
l_int|1
)braket
op_rshift
l_int|16
suffix:semicolon
id|p-&gt;tlabel
op_assign
(paren
id|data
(braket
l_int|0
)braket
op_rshift
l_int|10
)paren
op_amp
l_int|0x3f
suffix:semicolon
id|p-&gt;no_waiter
op_assign
l_int|1
suffix:semicolon
id|p-&gt;generation
op_assign
id|get_hpsb_generation
c_func
(paren
id|host
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dsize
op_mod
l_int|4
)paren
id|p-&gt;data
(braket
id|dsize
op_div
l_int|4
)braket
op_assign
l_int|0
suffix:semicolon
r_return
id|p
suffix:semicolon
)brace
DECL|macro|PREP_ASYNC_HEAD_RCODE
mdefine_line|#define PREP_ASYNC_HEAD_RCODE(tc) &bslash;&n;&t;packet-&gt;tcode = tc; &bslash;&n;&t;packet-&gt;header[0] = (packet-&gt;node_id &lt;&lt; 16) | (packet-&gt;tlabel &lt;&lt; 10) &bslash;&n;&t;&t;| (1 &lt;&lt; 8) | (tc &lt;&lt; 4); &bslash;&n;&t;packet-&gt;header[1] = (packet-&gt;host-&gt;node_id &lt;&lt; 16) | (rcode &lt;&lt; 12); &bslash;&n;&t;packet-&gt;header[2] = 0
DECL|function|fill_async_readquad_resp
r_static
r_void
id|fill_async_readquad_resp
c_func
(paren
r_struct
id|hpsb_packet
op_star
id|packet
comma
r_int
id|rcode
comma
id|quadlet_t
id|data
)paren
(brace
id|PREP_ASYNC_HEAD_RCODE
c_func
(paren
id|TCODE_READQ_RESPONSE
)paren
suffix:semicolon
id|packet-&gt;header
(braket
l_int|3
)braket
op_assign
id|data
suffix:semicolon
id|packet-&gt;header_size
op_assign
l_int|16
suffix:semicolon
id|packet-&gt;data_size
op_assign
l_int|0
suffix:semicolon
)brace
DECL|function|fill_async_readblock_resp
r_static
r_void
id|fill_async_readblock_resp
c_func
(paren
r_struct
id|hpsb_packet
op_star
id|packet
comma
r_int
id|rcode
comma
r_int
id|length
)paren
(brace
r_if
c_cond
(paren
id|rcode
op_ne
id|RCODE_COMPLETE
)paren
id|length
op_assign
l_int|0
suffix:semicolon
id|PREP_ASYNC_HEAD_RCODE
c_func
(paren
id|TCODE_READB_RESPONSE
)paren
suffix:semicolon
id|packet-&gt;header
(braket
l_int|3
)braket
op_assign
id|length
op_lshift
l_int|16
suffix:semicolon
id|packet-&gt;header_size
op_assign
l_int|16
suffix:semicolon
id|packet-&gt;data_size
op_assign
id|length
op_plus
(paren
id|length
op_mod
l_int|4
ques
c_cond
l_int|4
op_minus
(paren
id|length
op_mod
l_int|4
)paren
suffix:colon
l_int|0
)paren
suffix:semicolon
)brace
DECL|function|fill_async_write_resp
r_static
r_void
id|fill_async_write_resp
c_func
(paren
r_struct
id|hpsb_packet
op_star
id|packet
comma
r_int
id|rcode
)paren
(brace
id|PREP_ASYNC_HEAD_RCODE
c_func
(paren
id|TCODE_WRITE_RESPONSE
)paren
suffix:semicolon
id|packet-&gt;header
(braket
l_int|2
)braket
op_assign
l_int|0
suffix:semicolon
id|packet-&gt;header_size
op_assign
l_int|12
suffix:semicolon
id|packet-&gt;data_size
op_assign
l_int|0
suffix:semicolon
)brace
DECL|function|fill_async_lock_resp
r_static
r_void
id|fill_async_lock_resp
c_func
(paren
r_struct
id|hpsb_packet
op_star
id|packet
comma
r_int
id|rcode
comma
r_int
id|extcode
comma
r_int
id|length
)paren
(brace
r_if
c_cond
(paren
id|rcode
op_ne
id|RCODE_COMPLETE
)paren
id|length
op_assign
l_int|0
suffix:semicolon
id|PREP_ASYNC_HEAD_RCODE
c_func
(paren
id|TCODE_LOCK_RESPONSE
)paren
suffix:semicolon
id|packet-&gt;header
(braket
l_int|3
)braket
op_assign
(paren
id|length
op_lshift
l_int|16
)paren
op_or
id|extcode
suffix:semicolon
id|packet-&gt;header_size
op_assign
l_int|16
suffix:semicolon
id|packet-&gt;data_size
op_assign
id|length
suffix:semicolon
)brace
DECL|macro|PREP_REPLY_PACKET
mdefine_line|#define PREP_REPLY_PACKET(length) &bslash;&n;                packet = create_reply_packet(host, data, length); &bslash;&n;                if (packet == NULL) break
DECL|function|handle_incoming_packet
r_static
r_void
id|handle_incoming_packet
c_func
(paren
r_struct
id|hpsb_host
op_star
id|host
comma
r_int
id|tcode
comma
id|quadlet_t
op_star
id|data
comma
r_int
id|size
comma
r_int
id|write_acked
)paren
(brace
r_struct
id|hpsb_packet
op_star
id|packet
suffix:semicolon
r_int
id|length
comma
id|rcode
comma
id|extcode
suffix:semicolon
id|quadlet_t
id|buffer
suffix:semicolon
id|nodeid_t
id|source
op_assign
id|data
(braket
l_int|1
)braket
op_rshift
l_int|16
suffix:semicolon
id|nodeid_t
id|dest
op_assign
id|data
(braket
l_int|0
)braket
op_rshift
l_int|16
suffix:semicolon
id|u16
id|flags
op_assign
(paren
id|u16
)paren
id|data
(braket
l_int|0
)braket
suffix:semicolon
id|u64
id|addr
suffix:semicolon
multiline_comment|/* big FIXME - no error checking is done for an out of bounds length */
r_switch
c_cond
(paren
id|tcode
)paren
(brace
r_case
id|TCODE_WRITEQ
suffix:colon
id|addr
op_assign
(paren
(paren
(paren
id|u64
)paren
(paren
id|data
(braket
l_int|1
)braket
op_amp
l_int|0xffff
)paren
)paren
op_lshift
l_int|32
)paren
op_or
id|data
(braket
l_int|2
)braket
suffix:semicolon
id|rcode
op_assign
id|highlevel_write
c_func
(paren
id|host
comma
id|source
comma
id|dest
comma
id|data
op_plus
l_int|3
comma
id|addr
comma
l_int|4
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|write_acked
op_logical_and
(paren
id|NODEID_TO_NODE
c_func
(paren
id|data
(braket
l_int|0
)braket
op_rshift
l_int|16
)paren
op_ne
id|NODE_MASK
)paren
op_logical_and
(paren
id|rcode
op_ge
l_int|0
)paren
)paren
(brace
multiline_comment|/* not a broadcast write, reply */
id|PREP_REPLY_PACKET
c_func
(paren
l_int|0
)paren
suffix:semicolon
id|fill_async_write_resp
c_func
(paren
id|packet
comma
id|rcode
)paren
suffix:semicolon
id|send_packet_nocare
c_func
(paren
id|packet
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|TCODE_WRITEB
suffix:colon
id|addr
op_assign
(paren
(paren
(paren
id|u64
)paren
(paren
id|data
(braket
l_int|1
)braket
op_amp
l_int|0xffff
)paren
)paren
op_lshift
l_int|32
)paren
op_or
id|data
(braket
l_int|2
)braket
suffix:semicolon
id|rcode
op_assign
id|highlevel_write
c_func
(paren
id|host
comma
id|source
comma
id|dest
comma
id|data
op_plus
l_int|4
comma
id|addr
comma
id|data
(braket
l_int|3
)braket
op_rshift
l_int|16
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|write_acked
op_logical_and
(paren
id|NODEID_TO_NODE
c_func
(paren
id|data
(braket
l_int|0
)braket
op_rshift
l_int|16
)paren
op_ne
id|NODE_MASK
)paren
op_logical_and
(paren
id|rcode
op_ge
l_int|0
)paren
)paren
(brace
multiline_comment|/* not a broadcast write, reply */
id|PREP_REPLY_PACKET
c_func
(paren
l_int|0
)paren
suffix:semicolon
id|fill_async_write_resp
c_func
(paren
id|packet
comma
id|rcode
)paren
suffix:semicolon
id|send_packet_nocare
c_func
(paren
id|packet
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|TCODE_READQ
suffix:colon
id|addr
op_assign
(paren
(paren
(paren
id|u64
)paren
(paren
id|data
(braket
l_int|1
)braket
op_amp
l_int|0xffff
)paren
)paren
op_lshift
l_int|32
)paren
op_or
id|data
(braket
l_int|2
)braket
suffix:semicolon
id|rcode
op_assign
id|highlevel_read
c_func
(paren
id|host
comma
id|source
comma
op_amp
id|buffer
comma
id|addr
comma
l_int|4
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rcode
op_ge
l_int|0
)paren
(brace
id|PREP_REPLY_PACKET
c_func
(paren
l_int|0
)paren
suffix:semicolon
id|fill_async_readquad_resp
c_func
(paren
id|packet
comma
id|rcode
comma
id|buffer
)paren
suffix:semicolon
id|send_packet_nocare
c_func
(paren
id|packet
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|TCODE_READB
suffix:colon
id|length
op_assign
id|data
(braket
l_int|3
)braket
op_rshift
l_int|16
suffix:semicolon
id|PREP_REPLY_PACKET
c_func
(paren
id|length
)paren
suffix:semicolon
id|addr
op_assign
(paren
(paren
(paren
id|u64
)paren
(paren
id|data
(braket
l_int|1
)braket
op_amp
l_int|0xffff
)paren
)paren
op_lshift
l_int|32
)paren
op_or
id|data
(braket
l_int|2
)braket
suffix:semicolon
id|rcode
op_assign
id|highlevel_read
c_func
(paren
id|host
comma
id|source
comma
id|packet-&gt;data
comma
id|addr
comma
id|length
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rcode
op_ge
l_int|0
)paren
(brace
id|fill_async_readblock_resp
c_func
(paren
id|packet
comma
id|rcode
comma
id|length
)paren
suffix:semicolon
id|send_packet_nocare
c_func
(paren
id|packet
)paren
suffix:semicolon
)brace
r_else
(brace
id|hpsb_free_packet
c_func
(paren
id|packet
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|TCODE_LOCK_REQUEST
suffix:colon
id|length
op_assign
id|data
(braket
l_int|3
)braket
op_rshift
l_int|16
suffix:semicolon
id|extcode
op_assign
id|data
(braket
l_int|3
)braket
op_amp
l_int|0xffff
suffix:semicolon
id|addr
op_assign
(paren
(paren
(paren
id|u64
)paren
(paren
id|data
(braket
l_int|1
)braket
op_amp
l_int|0xffff
)paren
)paren
op_lshift
l_int|32
)paren
op_or
id|data
(braket
l_int|2
)braket
suffix:semicolon
id|PREP_REPLY_PACKET
c_func
(paren
l_int|8
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|extcode
op_eq
l_int|0
)paren
op_logical_or
(paren
id|extcode
op_ge
l_int|7
)paren
)paren
(brace
multiline_comment|/* let switch default handle error */
id|length
op_assign
l_int|0
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|length
)paren
(brace
r_case
l_int|4
suffix:colon
id|rcode
op_assign
id|highlevel_lock
c_func
(paren
id|host
comma
id|source
comma
id|packet-&gt;data
comma
id|addr
comma
id|data
(braket
l_int|4
)braket
comma
l_int|0
comma
id|extcode
comma
id|flags
)paren
suffix:semicolon
id|fill_async_lock_resp
c_func
(paren
id|packet
comma
id|rcode
comma
id|extcode
comma
l_int|4
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|8
suffix:colon
r_if
c_cond
(paren
(paren
id|extcode
op_ne
id|EXTCODE_FETCH_ADD
)paren
op_logical_and
(paren
id|extcode
op_ne
id|EXTCODE_LITTLE_ADD
)paren
)paren
(brace
id|rcode
op_assign
id|highlevel_lock
c_func
(paren
id|host
comma
id|source
comma
id|packet-&gt;data
comma
id|addr
comma
id|data
(braket
l_int|5
)braket
comma
id|data
(braket
l_int|4
)braket
comma
id|extcode
comma
id|flags
)paren
suffix:semicolon
id|fill_async_lock_resp
c_func
(paren
id|packet
comma
id|rcode
comma
id|extcode
comma
l_int|4
)paren
suffix:semicolon
)brace
r_else
(brace
id|rcode
op_assign
id|highlevel_lock64
c_func
(paren
id|host
comma
id|source
comma
(paren
id|octlet_t
op_star
)paren
id|packet-&gt;data
comma
id|addr
comma
op_star
(paren
id|octlet_t
op_star
)paren
(paren
id|data
op_plus
l_int|4
)paren
comma
l_int|0ULL
comma
id|extcode
comma
id|flags
)paren
suffix:semicolon
id|fill_async_lock_resp
c_func
(paren
id|packet
comma
id|rcode
comma
id|extcode
comma
l_int|8
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
l_int|16
suffix:colon
id|rcode
op_assign
id|highlevel_lock64
c_func
(paren
id|host
comma
id|source
comma
(paren
id|octlet_t
op_star
)paren
id|packet-&gt;data
comma
id|addr
comma
op_star
(paren
id|octlet_t
op_star
)paren
(paren
id|data
op_plus
l_int|6
)paren
comma
op_star
(paren
id|octlet_t
op_star
)paren
(paren
id|data
op_plus
l_int|4
)paren
comma
id|extcode
comma
id|flags
)paren
suffix:semicolon
id|fill_async_lock_resp
c_func
(paren
id|packet
comma
id|rcode
comma
id|extcode
comma
l_int|8
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|rcode
op_assign
id|RCODE_TYPE_ERROR
suffix:semicolon
id|fill_async_lock_resp
c_func
(paren
id|packet
comma
id|rcode
comma
id|extcode
comma
l_int|0
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|rcode
op_ge
l_int|0
)paren
(brace
id|send_packet_nocare
c_func
(paren
id|packet
)paren
suffix:semicolon
)brace
r_else
(brace
id|hpsb_free_packet
c_func
(paren
id|packet
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
)brace
)brace
DECL|macro|PREP_REPLY_PACKET
macro_line|#undef PREP_REPLY_PACKET
DECL|function|hpsb_packet_received
r_void
id|hpsb_packet_received
c_func
(paren
r_struct
id|hpsb_host
op_star
id|host
comma
id|quadlet_t
op_star
id|data
comma
r_int
id|size
comma
r_int
id|write_acked
)paren
(brace
r_int
id|tcode
suffix:semicolon
r_if
c_cond
(paren
id|host-&gt;in_bus_reset
)paren
(brace
id|HPSB_INFO
c_func
(paren
l_string|&quot;received packet during reset; ignoring&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|dump_packet
c_func
(paren
l_string|&quot;received packet:&quot;
comma
id|data
comma
id|size
)paren
suffix:semicolon
id|tcode
op_assign
(paren
id|data
(braket
l_int|0
)braket
op_rshift
l_int|4
)paren
op_amp
l_int|0xf
suffix:semicolon
r_switch
c_cond
(paren
id|tcode
)paren
(brace
r_case
id|TCODE_WRITE_RESPONSE
suffix:colon
r_case
id|TCODE_READQ_RESPONSE
suffix:colon
r_case
id|TCODE_READB_RESPONSE
suffix:colon
r_case
id|TCODE_LOCK_RESPONSE
suffix:colon
id|handle_packet_response
c_func
(paren
id|host
comma
id|tcode
comma
id|data
comma
id|size
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|TCODE_WRITEQ
suffix:colon
r_case
id|TCODE_WRITEB
suffix:colon
r_case
id|TCODE_READQ
suffix:colon
r_case
id|TCODE_READB
suffix:colon
r_case
id|TCODE_LOCK_REQUEST
suffix:colon
id|handle_incoming_packet
c_func
(paren
id|host
comma
id|tcode
comma
id|data
comma
id|size
comma
id|write_acked
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|TCODE_ISO_DATA
suffix:colon
id|highlevel_iso_receive
c_func
(paren
id|host
comma
id|data
comma
id|size
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|TCODE_CYCLE_START
suffix:colon
multiline_comment|/* simply ignore this packet if it is passed on */
r_break
suffix:semicolon
r_default
suffix:colon
id|HPSB_NOTICE
c_func
(paren
l_string|&quot;received packet with bogus transaction code %d&quot;
comma
id|tcode
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
DECL|function|abort_requests
r_static
r_void
id|abort_requests
c_func
(paren
r_struct
id|hpsb_host
op_star
id|host
)paren
(brace
r_struct
id|hpsb_packet
op_star
id|packet
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|host-&gt;driver
op_member_access_from_pointer
id|devctl
c_func
(paren
id|host
comma
id|CANCEL_REQUESTS
comma
l_int|0
)paren
suffix:semicolon
r_while
c_loop
(paren
(paren
id|skb
op_assign
id|skb_dequeue
c_func
(paren
op_amp
id|host-&gt;pending_packet_queue
)paren
)paren
op_ne
l_int|NULL
)paren
(brace
id|packet
op_assign
(paren
r_struct
id|hpsb_packet
op_star
)paren
id|skb-&gt;data
suffix:semicolon
id|packet-&gt;state
op_assign
id|hpsb_complete
suffix:semicolon
id|packet-&gt;ack_code
op_assign
id|ACKX_ABORTED
suffix:semicolon
id|queue_packet_complete
c_func
(paren
id|packet
)paren
suffix:semicolon
)brace
)brace
DECL|function|abort_timedouts
r_void
id|abort_timedouts
c_func
(paren
r_int
r_int
id|__opaque
)paren
(brace
r_struct
id|hpsb_host
op_star
id|host
op_assign
(paren
r_struct
id|hpsb_host
op_star
)paren
id|__opaque
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_struct
id|hpsb_packet
op_star
id|packet
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
r_int
r_int
id|expire
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|host-&gt;csr.lock
comma
id|flags
)paren
suffix:semicolon
id|expire
op_assign
id|host-&gt;csr.expire
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|host-&gt;csr.lock
comma
id|flags
)paren
suffix:semicolon
multiline_comment|/* Hold the lock around this, since we aren&squot;t dequeuing all&n;&t; * packets, just ones we need. */
id|spin_lock_irqsave
c_func
(paren
op_amp
id|host-&gt;pending_packet_queue.lock
comma
id|flags
)paren
suffix:semicolon
r_while
c_loop
(paren
op_logical_neg
id|skb_queue_empty
c_func
(paren
op_amp
id|host-&gt;pending_packet_queue
)paren
)paren
(brace
id|skb
op_assign
id|skb_peek
c_func
(paren
op_amp
id|host-&gt;pending_packet_queue
)paren
suffix:semicolon
id|packet
op_assign
(paren
r_struct
id|hpsb_packet
op_star
)paren
id|skb-&gt;data
suffix:semicolon
r_if
c_cond
(paren
id|time_before
c_func
(paren
id|packet-&gt;sendtime
op_plus
id|expire
comma
id|jiffies
)paren
)paren
(brace
id|__skb_unlink
c_func
(paren
id|skb
comma
id|skb-&gt;list
)paren
suffix:semicolon
id|packet-&gt;state
op_assign
id|hpsb_complete
suffix:semicolon
id|packet-&gt;ack_code
op_assign
id|ACKX_TIMEOUT
suffix:semicolon
id|queue_packet_complete
c_func
(paren
id|packet
)paren
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* Since packets are added to the tail, the oldest&n;&t;&t;&t; * ones are first, always. When we get to one that&n;&t;&t;&t; * isn&squot;t timed out, the rest aren&squot;t either. */
r_break
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
op_logical_neg
id|skb_queue_empty
c_func
(paren
op_amp
id|host-&gt;pending_packet_queue
)paren
)paren
id|mod_timer
c_func
(paren
op_amp
id|host-&gt;timeout
comma
id|jiffies
op_plus
id|host-&gt;timeout_interval
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|host-&gt;pending_packet_queue.lock
comma
id|flags
)paren
suffix:semicolon
)brace
multiline_comment|/* Kernel thread and vars, which handles packets that are completed. Only&n; * packets that have a &quot;complete&quot; function are sent here. This way, the&n; * completion is run out of kernel context, and doesn&squot;t block the rest of&n; * the stack. */
DECL|variable|khpsbpkt_pid
DECL|variable|khpsbpkt_kill
r_static
r_int
id|khpsbpkt_pid
op_assign
op_minus
l_int|1
comma
id|khpsbpkt_kill
suffix:semicolon
r_static
id|DECLARE_COMPLETION
c_func
(paren
id|khpsbpkt_complete
)paren
suffix:semicolon
DECL|variable|hpsbpkt_queue
r_static
r_struct
id|sk_buff_head
id|hpsbpkt_queue
suffix:semicolon
r_static
id|DECLARE_MUTEX_LOCKED
c_func
(paren
id|khpsbpkt_sig
)paren
suffix:semicolon
DECL|function|queue_packet_complete
r_static
r_void
id|queue_packet_complete
c_func
(paren
r_struct
id|hpsb_packet
op_star
id|packet
)paren
(brace
r_if
c_cond
(paren
id|packet-&gt;no_waiter
)paren
(brace
id|hpsb_free_packet
c_func
(paren
id|packet
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|packet-&gt;complete_routine
op_ne
l_int|NULL
)paren
(brace
id|skb_queue_tail
c_func
(paren
op_amp
id|hpsbpkt_queue
comma
id|packet-&gt;skb
)paren
suffix:semicolon
multiline_comment|/* Signal the kernel thread to handle this */
id|up
c_func
(paren
op_amp
id|khpsbpkt_sig
)paren
suffix:semicolon
)brace
r_return
suffix:semicolon
)brace
DECL|function|hpsbpkt_thread
r_static
r_int
id|hpsbpkt_thread
c_func
(paren
r_void
op_star
id|__hi
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
r_struct
id|hpsb_packet
op_star
id|packet
suffix:semicolon
r_void
(paren
op_star
id|complete_routine
)paren
(paren
r_void
op_star
)paren
suffix:semicolon
r_void
op_star
id|complete_data
suffix:semicolon
id|daemonize
c_func
(paren
l_string|&quot;khpsbpkt&quot;
)paren
suffix:semicolon
r_while
c_loop
(paren
l_int|1
)paren
(brace
r_if
c_cond
(paren
id|down_interruptible
c_func
(paren
op_amp
id|khpsbpkt_sig
)paren
)paren
(brace
r_if
c_cond
(paren
id|current-&gt;flags
op_amp
id|PF_FREEZE
)paren
(brace
id|refrigerator
c_func
(paren
l_int|0
)paren
suffix:semicolon
r_continue
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;khpsbpkt: received unexpected signal?!&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|khpsbpkt_kill
)paren
r_break
suffix:semicolon
r_while
c_loop
(paren
(paren
id|skb
op_assign
id|skb_dequeue
c_func
(paren
op_amp
id|hpsbpkt_queue
)paren
)paren
op_ne
l_int|NULL
)paren
(brace
id|packet
op_assign
(paren
r_struct
id|hpsb_packet
op_star
)paren
id|skb-&gt;data
suffix:semicolon
id|complete_routine
op_assign
id|packet-&gt;complete_routine
suffix:semicolon
id|complete_data
op_assign
id|packet-&gt;complete_data
suffix:semicolon
id|packet-&gt;complete_routine
op_assign
id|packet-&gt;complete_data
op_assign
l_int|NULL
suffix:semicolon
id|complete_routine
c_func
(paren
id|complete_data
)paren
suffix:semicolon
)brace
)brace
id|complete_and_exit
c_func
(paren
op_amp
id|khpsbpkt_complete
comma
l_int|0
)paren
suffix:semicolon
)brace
DECL|function|ieee1394_init
r_static
r_int
id|__init
id|ieee1394_init
c_func
(paren
r_void
)paren
(brace
r_int
id|i
comma
id|ret
suffix:semicolon
id|skb_queue_head_init
c_func
(paren
op_amp
id|hpsbpkt_queue
)paren
suffix:semicolon
multiline_comment|/* non-fatal error */
r_if
c_cond
(paren
id|hpsb_init_config_roms
c_func
(paren
)paren
)paren
(brace
id|HPSB_ERR
c_func
(paren
l_string|&quot;Failed to initialize some config rom entries.&bslash;n&quot;
)paren
suffix:semicolon
id|HPSB_ERR
c_func
(paren
l_string|&quot;Some features may not be available&bslash;n&quot;
)paren
suffix:semicolon
)brace
id|khpsbpkt_pid
op_assign
id|kernel_thread
c_func
(paren
id|hpsbpkt_thread
comma
l_int|NULL
comma
id|CLONE_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|khpsbpkt_pid
OL
l_int|0
)paren
(brace
id|HPSB_ERR
c_func
(paren
l_string|&quot;Failed to start hpsbpkt thread!&bslash;n&quot;
)paren
suffix:semicolon
id|ret
op_assign
op_minus
id|ENOMEM
suffix:semicolon
r_goto
id|exit_cleanup_config_roms
suffix:semicolon
)brace
r_if
c_cond
(paren
id|register_chrdev_region
c_func
(paren
id|IEEE1394_CORE_DEV
comma
l_int|256
comma
l_string|&quot;ieee1394&quot;
)paren
)paren
(brace
id|HPSB_ERR
c_func
(paren
l_string|&quot;unable to register character device major %d!&bslash;n&quot;
comma
id|IEEE1394_MAJOR
)paren
suffix:semicolon
id|ret
op_assign
op_minus
id|ENODEV
suffix:semicolon
r_goto
id|exit_release_kernel_thread
suffix:semicolon
)brace
multiline_comment|/* actually this is a non-fatal error */
id|ret
op_assign
id|devfs_mk_dir
c_func
(paren
l_string|&quot;ieee1394&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
OL
l_int|0
)paren
(brace
id|HPSB_ERR
c_func
(paren
l_string|&quot;unable to make devfs dir for device major %d!&bslash;n&quot;
comma
id|IEEE1394_MAJOR
)paren
suffix:semicolon
r_goto
id|release_chrdev
suffix:semicolon
)brace
id|ret
op_assign
id|bus_register
c_func
(paren
op_amp
id|ieee1394_bus_type
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
OL
l_int|0
)paren
(brace
id|HPSB_INFO
c_func
(paren
l_string|&quot;bus register failed&quot;
)paren
suffix:semicolon
r_goto
id|release_devfs
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|fw_bus_attrs
(braket
id|i
)braket
suffix:semicolon
id|i
op_increment
)paren
(brace
id|ret
op_assign
id|bus_create_file
c_func
(paren
op_amp
id|ieee1394_bus_type
comma
id|fw_bus_attrs
(braket
id|i
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
OL
l_int|0
)paren
(brace
r_while
c_loop
(paren
id|i
op_ge
l_int|0
)paren
(brace
id|bus_remove_file
c_func
(paren
op_amp
id|ieee1394_bus_type
comma
id|fw_bus_attrs
(braket
id|i
op_decrement
)braket
)paren
suffix:semicolon
)brace
id|bus_unregister
c_func
(paren
op_amp
id|ieee1394_bus_type
)paren
suffix:semicolon
r_goto
id|release_devfs
suffix:semicolon
)brace
)brace
id|ret
op_assign
id|class_register
c_func
(paren
op_amp
id|hpsb_host_class
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
OL
l_int|0
)paren
r_goto
id|release_all_bus
suffix:semicolon
id|hpsb_protocol_class
op_assign
id|class_simple_create
c_func
(paren
id|THIS_MODULE
comma
l_string|&quot;ieee1394_protocol&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|IS_ERR
c_func
(paren
id|hpsb_protocol_class
)paren
)paren
(brace
id|ret
op_assign
id|PTR_ERR
c_func
(paren
id|hpsb_protocol_class
)paren
suffix:semicolon
r_goto
id|release_class_host
suffix:semicolon
)brace
id|ret
op_assign
id|init_csr
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|HPSB_INFO
c_func
(paren
l_string|&quot;init csr failed&quot;
)paren
suffix:semicolon
id|ret
op_assign
op_minus
id|ENOMEM
suffix:semicolon
r_goto
id|release_class_protocol
suffix:semicolon
)brace
r_if
c_cond
(paren
id|disable_nodemgr
)paren
(brace
id|HPSB_INFO
c_func
(paren
l_string|&quot;nodemgr functionality disabled&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|ret
op_assign
id|init_ieee1394_nodemgr
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
OL
l_int|0
)paren
(brace
id|HPSB_INFO
c_func
(paren
l_string|&quot;init nodemgr failed&quot;
)paren
suffix:semicolon
r_goto
id|cleanup_csr
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
id|cleanup_csr
suffix:colon
id|cleanup_csr
c_func
(paren
)paren
suffix:semicolon
id|release_class_protocol
suffix:colon
id|class_simple_destroy
c_func
(paren
id|hpsb_protocol_class
)paren
suffix:semicolon
id|release_class_host
suffix:colon
id|class_unregister
c_func
(paren
op_amp
id|hpsb_host_class
)paren
suffix:semicolon
id|release_all_bus
suffix:colon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|fw_bus_attrs
(braket
id|i
)braket
suffix:semicolon
id|i
op_increment
)paren
id|bus_remove_file
c_func
(paren
op_amp
id|ieee1394_bus_type
comma
id|fw_bus_attrs
(braket
id|i
)braket
)paren
suffix:semicolon
id|bus_unregister
c_func
(paren
op_amp
id|ieee1394_bus_type
)paren
suffix:semicolon
id|release_devfs
suffix:colon
id|devfs_remove
c_func
(paren
l_string|&quot;ieee1394&quot;
)paren
suffix:semicolon
id|release_chrdev
suffix:colon
id|unregister_chrdev_region
c_func
(paren
id|IEEE1394_CORE_DEV
comma
l_int|256
)paren
suffix:semicolon
id|exit_release_kernel_thread
suffix:colon
r_if
c_cond
(paren
id|khpsbpkt_pid
op_ge
l_int|0
)paren
(brace
id|kill_proc
c_func
(paren
id|khpsbpkt_pid
comma
id|SIGTERM
comma
l_int|1
)paren
suffix:semicolon
id|wait_for_completion
c_func
(paren
op_amp
id|khpsbpkt_complete
)paren
suffix:semicolon
)brace
id|exit_cleanup_config_roms
suffix:colon
id|hpsb_cleanup_config_roms
c_func
(paren
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
DECL|function|ieee1394_cleanup
r_static
r_void
id|__exit
id|ieee1394_cleanup
c_func
(paren
r_void
)paren
(brace
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|disable_nodemgr
)paren
id|cleanup_ieee1394_nodemgr
c_func
(paren
)paren
suffix:semicolon
id|cleanup_csr
c_func
(paren
)paren
suffix:semicolon
id|class_simple_destroy
c_func
(paren
id|hpsb_protocol_class
)paren
suffix:semicolon
id|class_unregister
c_func
(paren
op_amp
id|hpsb_host_class
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|fw_bus_attrs
(braket
id|i
)braket
suffix:semicolon
id|i
op_increment
)paren
id|bus_remove_file
c_func
(paren
op_amp
id|ieee1394_bus_type
comma
id|fw_bus_attrs
(braket
id|i
)braket
)paren
suffix:semicolon
id|bus_unregister
c_func
(paren
op_amp
id|ieee1394_bus_type
)paren
suffix:semicolon
r_if
c_cond
(paren
id|khpsbpkt_pid
op_ge
l_int|0
)paren
(brace
id|khpsbpkt_kill
op_assign
l_int|1
suffix:semicolon
id|mb
c_func
(paren
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|khpsbpkt_sig
)paren
suffix:semicolon
id|wait_for_completion
c_func
(paren
op_amp
id|khpsbpkt_complete
)paren
suffix:semicolon
)brace
id|hpsb_cleanup_config_roms
c_func
(paren
)paren
suffix:semicolon
id|unregister_chrdev_region
c_func
(paren
id|IEEE1394_CORE_DEV
comma
l_int|256
)paren
suffix:semicolon
id|devfs_remove
c_func
(paren
l_string|&quot;ieee1394&quot;
)paren
suffix:semicolon
)brace
DECL|variable|ieee1394_init
id|module_init
c_func
(paren
id|ieee1394_init
)paren
suffix:semicolon
DECL|variable|ieee1394_cleanup
id|module_exit
c_func
(paren
id|ieee1394_cleanup
)paren
suffix:semicolon
multiline_comment|/* Exported symbols */
multiline_comment|/** hosts.c **/
DECL|variable|hpsb_alloc_host
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_alloc_host
)paren
suffix:semicolon
DECL|variable|hpsb_add_host
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_add_host
)paren
suffix:semicolon
DECL|variable|hpsb_remove_host
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_remove_host
)paren
suffix:semicolon
DECL|variable|hpsb_update_config_rom_image
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_update_config_rom_image
)paren
suffix:semicolon
multiline_comment|/** ieee1394_core.c **/
DECL|variable|hpsb_speedto_str
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_speedto_str
)paren
suffix:semicolon
DECL|variable|hpsb_protocol_class
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_protocol_class
)paren
suffix:semicolon
DECL|variable|hpsb_set_packet_complete_task
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_set_packet_complete_task
)paren
suffix:semicolon
DECL|variable|hpsb_alloc_packet
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_alloc_packet
)paren
suffix:semicolon
DECL|variable|hpsb_free_packet
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_free_packet
)paren
suffix:semicolon
DECL|variable|hpsb_send_phy_config
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_send_phy_config
)paren
suffix:semicolon
DECL|variable|hpsb_send_packet
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_send_packet
)paren
suffix:semicolon
DECL|variable|hpsb_send_packet_and_wait
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_send_packet_and_wait
)paren
suffix:semicolon
DECL|variable|hpsb_reset_bus
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_reset_bus
)paren
suffix:semicolon
DECL|variable|hpsb_bus_reset
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_bus_reset
)paren
suffix:semicolon
DECL|variable|hpsb_selfid_received
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_selfid_received
)paren
suffix:semicolon
DECL|variable|hpsb_selfid_complete
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_selfid_complete
)paren
suffix:semicolon
DECL|variable|hpsb_packet_sent
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_packet_sent
)paren
suffix:semicolon
DECL|variable|hpsb_packet_received
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_packet_received
)paren
suffix:semicolon
multiline_comment|/** ieee1394_transactions.c **/
DECL|variable|hpsb_get_tlabel
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_get_tlabel
)paren
suffix:semicolon
DECL|variable|hpsb_free_tlabel
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_free_tlabel
)paren
suffix:semicolon
DECL|variable|hpsb_make_readpacket
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_make_readpacket
)paren
suffix:semicolon
DECL|variable|hpsb_make_writepacket
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_make_writepacket
)paren
suffix:semicolon
DECL|variable|hpsb_make_streampacket
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_make_streampacket
)paren
suffix:semicolon
DECL|variable|hpsb_make_lockpacket
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_make_lockpacket
)paren
suffix:semicolon
DECL|variable|hpsb_make_lock64packet
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_make_lock64packet
)paren
suffix:semicolon
DECL|variable|hpsb_make_phypacket
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_make_phypacket
)paren
suffix:semicolon
DECL|variable|hpsb_make_isopacket
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_make_isopacket
)paren
suffix:semicolon
DECL|variable|hpsb_read
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_read
)paren
suffix:semicolon
DECL|variable|hpsb_write
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_write
)paren
suffix:semicolon
DECL|variable|hpsb_lock
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_lock
)paren
suffix:semicolon
DECL|variable|hpsb_packet_success
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_packet_success
)paren
suffix:semicolon
multiline_comment|/** highlevel.c **/
DECL|variable|hpsb_register_highlevel
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_register_highlevel
)paren
suffix:semicolon
DECL|variable|hpsb_unregister_highlevel
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_unregister_highlevel
)paren
suffix:semicolon
DECL|variable|hpsb_register_addrspace
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_register_addrspace
)paren
suffix:semicolon
DECL|variable|hpsb_unregister_addrspace
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_unregister_addrspace
)paren
suffix:semicolon
DECL|variable|hpsb_allocate_and_register_addrspace
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_allocate_and_register_addrspace
)paren
suffix:semicolon
DECL|variable|hpsb_listen_channel
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_listen_channel
)paren
suffix:semicolon
DECL|variable|hpsb_unlisten_channel
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_unlisten_channel
)paren
suffix:semicolon
DECL|variable|hpsb_get_hostinfo
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_get_hostinfo
)paren
suffix:semicolon
DECL|variable|hpsb_create_hostinfo
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_create_hostinfo
)paren
suffix:semicolon
DECL|variable|hpsb_destroy_hostinfo
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_destroy_hostinfo
)paren
suffix:semicolon
DECL|variable|hpsb_set_hostinfo_key
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_set_hostinfo_key
)paren
suffix:semicolon
DECL|variable|hpsb_get_hostinfo_bykey
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_get_hostinfo_bykey
)paren
suffix:semicolon
DECL|variable|hpsb_set_hostinfo
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_set_hostinfo
)paren
suffix:semicolon
DECL|variable|highlevel_add_host
id|EXPORT_SYMBOL
c_func
(paren
id|highlevel_add_host
)paren
suffix:semicolon
DECL|variable|highlevel_remove_host
id|EXPORT_SYMBOL
c_func
(paren
id|highlevel_remove_host
)paren
suffix:semicolon
DECL|variable|highlevel_host_reset
id|EXPORT_SYMBOL
c_func
(paren
id|highlevel_host_reset
)paren
suffix:semicolon
multiline_comment|/** nodemgr.c **/
DECL|variable|hpsb_node_fill_packet
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_node_fill_packet
)paren
suffix:semicolon
DECL|variable|hpsb_node_write
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_node_write
)paren
suffix:semicolon
DECL|variable|hpsb_register_protocol
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_register_protocol
)paren
suffix:semicolon
DECL|variable|hpsb_unregister_protocol
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_unregister_protocol
)paren
suffix:semicolon
DECL|variable|ieee1394_bus_type
id|EXPORT_SYMBOL
c_func
(paren
id|ieee1394_bus_type
)paren
suffix:semicolon
DECL|variable|nodemgr_for_each_host
id|EXPORT_SYMBOL
c_func
(paren
id|nodemgr_for_each_host
)paren
suffix:semicolon
multiline_comment|/** csr.c **/
DECL|variable|hpsb_update_config_rom
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_update_config_rom
)paren
suffix:semicolon
multiline_comment|/** dma.c **/
DECL|variable|dma_prog_region_init
id|EXPORT_SYMBOL
c_func
(paren
id|dma_prog_region_init
)paren
suffix:semicolon
DECL|variable|dma_prog_region_alloc
id|EXPORT_SYMBOL
c_func
(paren
id|dma_prog_region_alloc
)paren
suffix:semicolon
DECL|variable|dma_prog_region_free
id|EXPORT_SYMBOL
c_func
(paren
id|dma_prog_region_free
)paren
suffix:semicolon
DECL|variable|dma_region_init
id|EXPORT_SYMBOL
c_func
(paren
id|dma_region_init
)paren
suffix:semicolon
DECL|variable|dma_region_alloc
id|EXPORT_SYMBOL
c_func
(paren
id|dma_region_alloc
)paren
suffix:semicolon
DECL|variable|dma_region_free
id|EXPORT_SYMBOL
c_func
(paren
id|dma_region_free
)paren
suffix:semicolon
DECL|variable|dma_region_sync_for_cpu
id|EXPORT_SYMBOL
c_func
(paren
id|dma_region_sync_for_cpu
)paren
suffix:semicolon
DECL|variable|dma_region_sync_for_device
id|EXPORT_SYMBOL
c_func
(paren
id|dma_region_sync_for_device
)paren
suffix:semicolon
DECL|variable|dma_region_mmap
id|EXPORT_SYMBOL
c_func
(paren
id|dma_region_mmap
)paren
suffix:semicolon
DECL|variable|dma_region_offset_to_bus
id|EXPORT_SYMBOL
c_func
(paren
id|dma_region_offset_to_bus
)paren
suffix:semicolon
multiline_comment|/** iso.c **/
DECL|variable|hpsb_iso_xmit_init
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_iso_xmit_init
)paren
suffix:semicolon
DECL|variable|hpsb_iso_recv_init
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_iso_recv_init
)paren
suffix:semicolon
DECL|variable|hpsb_iso_xmit_start
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_iso_xmit_start
)paren
suffix:semicolon
DECL|variable|hpsb_iso_recv_start
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_iso_recv_start
)paren
suffix:semicolon
DECL|variable|hpsb_iso_recv_listen_channel
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_iso_recv_listen_channel
)paren
suffix:semicolon
DECL|variable|hpsb_iso_recv_unlisten_channel
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_iso_recv_unlisten_channel
)paren
suffix:semicolon
DECL|variable|hpsb_iso_recv_set_channel_mask
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_iso_recv_set_channel_mask
)paren
suffix:semicolon
DECL|variable|hpsb_iso_stop
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_iso_stop
)paren
suffix:semicolon
DECL|variable|hpsb_iso_shutdown
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_iso_shutdown
)paren
suffix:semicolon
DECL|variable|hpsb_iso_xmit_queue_packet
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_iso_xmit_queue_packet
)paren
suffix:semicolon
DECL|variable|hpsb_iso_xmit_sync
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_iso_xmit_sync
)paren
suffix:semicolon
DECL|variable|hpsb_iso_recv_release_packets
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_iso_recv_release_packets
)paren
suffix:semicolon
DECL|variable|hpsb_iso_n_ready
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_iso_n_ready
)paren
suffix:semicolon
DECL|variable|hpsb_iso_packet_sent
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_iso_packet_sent
)paren
suffix:semicolon
DECL|variable|hpsb_iso_packet_received
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_iso_packet_received
)paren
suffix:semicolon
DECL|variable|hpsb_iso_wake
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_iso_wake
)paren
suffix:semicolon
DECL|variable|hpsb_iso_recv_flush
id|EXPORT_SYMBOL
c_func
(paren
id|hpsb_iso_recv_flush
)paren
suffix:semicolon
multiline_comment|/** csr1212.c **/
DECL|variable|csr1212_create_csr
id|EXPORT_SYMBOL
c_func
(paren
id|csr1212_create_csr
)paren
suffix:semicolon
DECL|variable|csr1212_init_local_csr
id|EXPORT_SYMBOL
c_func
(paren
id|csr1212_init_local_csr
)paren
suffix:semicolon
DECL|variable|csr1212_new_immediate
id|EXPORT_SYMBOL
c_func
(paren
id|csr1212_new_immediate
)paren
suffix:semicolon
DECL|variable|csr1212_new_directory
id|EXPORT_SYMBOL
c_func
(paren
id|csr1212_new_directory
)paren
suffix:semicolon
DECL|variable|csr1212_associate_keyval
id|EXPORT_SYMBOL
c_func
(paren
id|csr1212_associate_keyval
)paren
suffix:semicolon
DECL|variable|csr1212_attach_keyval_to_directory
id|EXPORT_SYMBOL
c_func
(paren
id|csr1212_attach_keyval_to_directory
)paren
suffix:semicolon
DECL|variable|csr1212_new_string_descriptor_leaf
id|EXPORT_SYMBOL
c_func
(paren
id|csr1212_new_string_descriptor_leaf
)paren
suffix:semicolon
DECL|variable|csr1212_detach_keyval_from_directory
id|EXPORT_SYMBOL
c_func
(paren
id|csr1212_detach_keyval_from_directory
)paren
suffix:semicolon
DECL|variable|csr1212_release_keyval
id|EXPORT_SYMBOL
c_func
(paren
id|csr1212_release_keyval
)paren
suffix:semicolon
DECL|variable|csr1212_destroy_csr
id|EXPORT_SYMBOL
c_func
(paren
id|csr1212_destroy_csr
)paren
suffix:semicolon
DECL|variable|csr1212_read
id|EXPORT_SYMBOL
c_func
(paren
id|csr1212_read
)paren
suffix:semicolon
DECL|variable|csr1212_generate_csr_image
id|EXPORT_SYMBOL
c_func
(paren
id|csr1212_generate_csr_image
)paren
suffix:semicolon
DECL|variable|csr1212_parse_keyval
id|EXPORT_SYMBOL
c_func
(paren
id|csr1212_parse_keyval
)paren
suffix:semicolon
DECL|variable|csr1212_parse_csr
id|EXPORT_SYMBOL
c_func
(paren
id|csr1212_parse_csr
)paren
suffix:semicolon
DECL|variable|_csr1212_read_keyval
id|EXPORT_SYMBOL
c_func
(paren
id|_csr1212_read_keyval
)paren
suffix:semicolon
DECL|variable|_csr1212_destroy_keyval
id|EXPORT_SYMBOL
c_func
(paren
id|_csr1212_destroy_keyval
)paren
suffix:semicolon
eof
