multiline_comment|/*&n; * drivers/pci/pci-sysfs.c&n; *&n; * (C) Copyright 2002 Greg Kroah-Hartman&n; * (C) Copyright 2002 IBM Corp.&n; *&n; * File attributes for PCI devices&n; *&n; * Modeled after usb&squot;s driverfs.c &n; *&n; */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/pci.h&gt;
macro_line|#include &lt;linux/stat.h&gt;
macro_line|#include &quot;pci.h&quot;
multiline_comment|/* show configuration fields */
DECL|macro|pci_config_attr
mdefine_line|#define pci_config_attr(field, format_string)&t;&t;&t;&t;&bslash;&n;static ssize_t&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;show_##field (struct device *dev, char *buf)&t;&t;&t;&t;&bslash;&n;{&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;&t;struct pci_dev *pdev;&t;&t;&t;&t;&t;&t;&bslash;&n;&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;&t;pdev = to_pci_dev (dev);&t;&t;&t;&t;&t;&bslash;&n;&t;return sprintf (buf, format_string, pdev-&gt;field);&t;&t;&bslash;&n;}&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;static DEVICE_ATTR(field, S_IRUGO, show_##field, NULL);
id|pci_config_attr
c_func
(paren
id|vendor
comma
l_string|&quot;0x%04x&bslash;n&quot;
)paren
suffix:semicolon
id|pci_config_attr
c_func
(paren
id|device
comma
l_string|&quot;0x%04x&bslash;n&quot;
)paren
suffix:semicolon
id|pci_config_attr
c_func
(paren
id|subsystem_vendor
comma
l_string|&quot;0x%04x&bslash;n&quot;
)paren
suffix:semicolon
id|pci_config_attr
c_func
(paren
id|subsystem_device
comma
l_string|&quot;0x%04x&bslash;n&quot;
)paren
suffix:semicolon
id|pci_config_attr
c_func
(paren
r_class
comma
l_string|&quot;0x%06x&bslash;n&quot;
)paren
suffix:semicolon
id|pci_config_attr
c_func
(paren
id|irq
comma
l_string|&quot;%u&bslash;n&quot;
)paren
suffix:semicolon
multiline_comment|/* show resources */
r_static
id|ssize_t
DECL|function|pci_show_resources
id|pci_show_resources
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|pci_dev
op_star
id|pci_dev
op_assign
id|to_pci_dev
c_func
(paren
id|dev
)paren
suffix:semicolon
r_char
op_star
id|str
op_assign
id|buf
suffix:semicolon
r_int
id|i
suffix:semicolon
r_int
id|max
op_assign
l_int|7
suffix:semicolon
r_if
c_cond
(paren
id|pci_dev-&gt;subordinate
)paren
id|max
op_assign
id|DEVICE_COUNT_RESOURCE
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|max
suffix:semicolon
id|i
op_increment
)paren
(brace
id|str
op_add_assign
id|sprintf
c_func
(paren
id|str
comma
l_string|&quot;0x%016lx 0x%016lx 0x%016lx&bslash;n&quot;
comma
id|pci_resource_start
c_func
(paren
id|pci_dev
comma
id|i
)paren
comma
id|pci_resource_end
c_func
(paren
id|pci_dev
comma
id|i
)paren
comma
id|pci_resource_flags
c_func
(paren
id|pci_dev
comma
id|i
)paren
)paren
suffix:semicolon
)brace
r_return
(paren
id|str
op_minus
id|buf
)paren
suffix:semicolon
)brace
r_static
id|DEVICE_ATTR
c_func
(paren
id|resource
comma
id|S_IRUGO
comma
id|pci_show_resources
comma
l_int|NULL
)paren
suffix:semicolon
DECL|function|pci_create_sysfs_dev_files
r_void
id|pci_create_sysfs_dev_files
(paren
r_struct
id|pci_dev
op_star
id|pdev
)paren
(brace
r_struct
id|device
op_star
id|dev
op_assign
op_amp
id|pdev-&gt;dev
suffix:semicolon
multiline_comment|/* current configuration&squot;s attributes */
id|device_create_file
(paren
id|dev
comma
op_amp
id|dev_attr_vendor
)paren
suffix:semicolon
id|device_create_file
(paren
id|dev
comma
op_amp
id|dev_attr_device
)paren
suffix:semicolon
id|device_create_file
(paren
id|dev
comma
op_amp
id|dev_attr_subsystem_vendor
)paren
suffix:semicolon
id|device_create_file
(paren
id|dev
comma
op_amp
id|dev_attr_subsystem_device
)paren
suffix:semicolon
id|device_create_file
(paren
id|dev
comma
op_amp
id|dev_attr_class
)paren
suffix:semicolon
id|device_create_file
(paren
id|dev
comma
op_amp
id|dev_attr_irq
)paren
suffix:semicolon
id|device_create_file
(paren
id|dev
comma
op_amp
id|dev_attr_resource
)paren
suffix:semicolon
)brace
eof
