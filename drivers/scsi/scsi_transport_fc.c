multiline_comment|/* &n; *  FiberChannel transport specific attributes exported to sysfs.&n; *&n; *  Copyright (c) 2003 Silicon Graphics, Inc.  All rights reserved.&n; *&n; *  This program is free software; you can redistribute it and/or modify&n; *  it under the terms of the GNU General Public License as published by&n; *  the Free Software Foundation; either version 2 of the License, or&n; *  (at your option) any later version.&n; *&n; *  This program is distributed in the hope that it will be useful,&n; *  but WITHOUT ANY WARRANTY; without even the implied warranty of&n; *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; *  GNU General Public License for more details.&n; *&n; *  You should have received a copy of the GNU General Public License&n; *  along with this program; if not, write to the Free Software&n; *  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA&n; */
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;scsi/scsi_device.h&gt;
macro_line|#include &lt;scsi/scsi_host.h&gt;
macro_line|#include &lt;scsi/scsi_transport.h&gt;
macro_line|#include &lt;scsi/scsi_transport_fc.h&gt;
r_static
r_void
id|transport_class_release
c_func
(paren
r_struct
id|class_device
op_star
id|class_dev
)paren
suffix:semicolon
DECL|variable|fc_transport_class
r_struct
r_class
id|fc_transport_class
op_assign
(brace
dot
id|name
op_assign
l_string|&quot;fc_transport&quot;
comma
dot
id|release
op_assign
id|transport_class_release
comma
)brace
suffix:semicolon
DECL|function|fc_transport_init
r_static
id|__init
r_int
id|fc_transport_init
c_func
(paren
r_void
)paren
(brace
r_return
id|class_register
c_func
(paren
op_amp
id|fc_transport_class
)paren
suffix:semicolon
)brace
DECL|function|fc_transport_exit
r_static
r_void
id|__exit
id|fc_transport_exit
c_func
(paren
r_void
)paren
(brace
id|class_unregister
c_func
(paren
op_amp
id|fc_transport_class
)paren
suffix:semicolon
)brace
DECL|function|fc_setup_transport_attrs
r_static
r_int
id|fc_setup_transport_attrs
c_func
(paren
r_struct
id|scsi_device
op_star
id|sdev
)paren
(brace
multiline_comment|/* FIXME: Callback into the driver */
id|fc_node_name
c_func
(paren
id|sdev
)paren
op_assign
op_minus
l_int|1
suffix:semicolon
id|fc_port_name
c_func
(paren
id|sdev
)paren
op_assign
op_minus
l_int|1
suffix:semicolon
id|fc_port_id
c_func
(paren
id|sdev
)paren
op_assign
op_minus
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|transport_class_release
r_static
r_void
id|transport_class_release
c_func
(paren
r_struct
id|class_device
op_star
id|class_dev
)paren
(brace
r_struct
id|scsi_device
op_star
id|sdev
op_assign
id|transport_class_to_sdev
c_func
(paren
id|class_dev
)paren
suffix:semicolon
id|put_device
c_func
(paren
op_amp
id|sdev-&gt;sdev_gendev
)paren
suffix:semicolon
)brace
DECL|macro|fc_transport_show_function
mdefine_line|#define fc_transport_show_function(field, format_string, cast)&t;&t;&t;&bslash;&n;static ssize_t&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;show_fc_transport_##field (struct class_device *cdev, char *buf)&t;&t;&bslash;&n;{&t;&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;&t;struct scsi_device *sdev = transport_class_to_sdev(cdev);&t;&t;&bslash;&n;&t;struct fc_transport_attrs *tp;&t;&t;&t;&t;&t;&t;&bslash;&n;&t;tp = (struct fc_transport_attrs *)&amp;sdev-&gt;transport_data;&t;&t;&bslash;&n;&t;return snprintf(buf, 20, format_string, cast tp-&gt;field);&t;&t;&bslash;&n;}
DECL|macro|fc_transport_rd_attr
mdefine_line|#define fc_transport_rd_attr(field, format_string)&t;&t;&t;&t;&bslash;&n;&t;fc_transport_show_function(field, format_string, )&t;&t;&t;&bslash;&n;static CLASS_DEVICE_ATTR( field, S_IRUGO, show_fc_transport_##field, NULL)
DECL|macro|fc_transport_rd_attr_cast
mdefine_line|#define fc_transport_rd_attr_cast(field, format_string, cast)&t;&t;&t;&bslash;&n;&t;fc_transport_show_function(field, format_string, (cast))&t;&t;&bslash;&n;static CLASS_DEVICE_ATTR( field, S_IRUGO, show_fc_transport_##field, NULL)
multiline_comment|/* the FiberChannel Tranport Attributes: */
id|fc_transport_rd_attr_cast
c_func
(paren
id|node_name
comma
l_string|&quot;0x%llx&bslash;n&quot;
comma
r_int
r_int
r_int
)paren
suffix:semicolon
id|fc_transport_rd_attr_cast
c_func
(paren
id|port_name
comma
l_string|&quot;0x%llx&bslash;n&quot;
comma
r_int
r_int
r_int
)paren
suffix:semicolon
id|fc_transport_rd_attr
c_func
(paren
id|port_id
comma
l_string|&quot;0x%06x&bslash;n&quot;
)paren
suffix:semicolon
DECL|variable|fc_transport_attrs
r_struct
id|class_device_attribute
op_star
id|fc_transport_attrs
(braket
)braket
op_assign
(brace
op_amp
id|class_device_attr_node_name
comma
op_amp
id|class_device_attr_port_name
comma
op_amp
id|class_device_attr_port_id
comma
l_int|NULL
)brace
suffix:semicolon
DECL|variable|fc_transport_template
r_struct
id|scsi_transport_template
id|fc_transport_template
op_assign
(brace
dot
id|attrs
op_assign
id|fc_transport_attrs
comma
dot
r_class
op_assign
op_amp
id|fc_transport_class
comma
dot
id|setup
op_assign
op_amp
id|fc_setup_transport_attrs
comma
dot
id|cleanup
op_assign
l_int|NULL
comma
dot
id|size
op_assign
r_sizeof
(paren
r_struct
id|fc_transport_attrs
)paren
op_minus
r_sizeof
(paren
r_int
r_int
)paren
comma
)brace
suffix:semicolon
DECL|variable|fc_transport_template
id|EXPORT_SYMBOL
c_func
(paren
id|fc_transport_template
)paren
suffix:semicolon
id|MODULE_AUTHOR
c_func
(paren
l_string|&quot;Martin Hicks&quot;
)paren
suffix:semicolon
id|MODULE_DESCRIPTION
c_func
(paren
l_string|&quot;FC Transport Attributes&quot;
)paren
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
DECL|variable|fc_transport_init
id|module_init
c_func
(paren
id|fc_transport_init
)paren
suffix:semicolon
DECL|variable|fc_transport_exit
id|module_exit
c_func
(paren
id|fc_transport_exit
)paren
suffix:semicolon
eof
