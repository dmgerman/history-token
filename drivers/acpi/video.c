multiline_comment|/*&n; *  video.c - ACPI Video Driver ($Revision:$)&n; *&n; *  Copyright (C) 2004 Luming Yu &lt;luming.yu@intel.com&gt;&n; *  Copyright (C) 2004 Bruno Ducrot &lt;ducrot@poupinou.org&gt;&n; *&n; * ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~&n; *&n; *  This program is free software; you can redistribute it and/or modify&n; *  it under the terms of the GNU General Public License as published by&n; *  the Free Software Foundation; either version 2 of the License, or (at&n; *  your option) any later version.&n; *&n; *  This program is distributed in the hope that it will be useful, but&n; *  WITHOUT ANY WARRANTY; without even the implied warranty of&n; *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU&n; *  General Public License for more details.&n; *&n; *  You should have received a copy of the GNU General Public License along&n; *  with this program; if not, write to the Free Software Foundation, Inc.,&n; *  59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.&n; *&n; * ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~&n; */
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/types.h&gt;
macro_line|#include &lt;linux/list.h&gt;
macro_line|#include &lt;linux/proc_fs.h&gt;
macro_line|#include &lt;linux/seq_file.h&gt;
macro_line|#include &lt;asm/uaccess.h&gt;
macro_line|#include &lt;acpi/acpi_bus.h&gt;
macro_line|#include &lt;acpi/acpi_drivers.h&gt;
DECL|macro|ACPI_VIDEO_COMPONENT
mdefine_line|#define ACPI_VIDEO_COMPONENT&t;&t;0x08000000
DECL|macro|ACPI_VIDEO_CLASS
mdefine_line|#define ACPI_VIDEO_CLASS&t;&t;&quot;video&quot;
DECL|macro|ACPI_VIDEO_DRIVER_NAME
mdefine_line|#define ACPI_VIDEO_DRIVER_NAME&t;&t;&quot;ACPI Video Driver&quot;
DECL|macro|ACPI_VIDEO_BUS_NAME
mdefine_line|#define ACPI_VIDEO_BUS_NAME&t;&t;&quot;Video Bus&quot;
DECL|macro|ACPI_VIDEO_DEVICE_NAME
mdefine_line|#define ACPI_VIDEO_DEVICE_NAME&t;&t;&quot;Video Device&quot;
DECL|macro|ACPI_VIDEO_NOTIFY_SWITCH
mdefine_line|#define ACPI_VIDEO_NOTIFY_SWITCH&t;0x80
DECL|macro|ACPI_VIDEO_NOTIFY_PROBE
mdefine_line|#define ACPI_VIDEO_NOTIFY_PROBE&t;&t;0x81
DECL|macro|ACPI_VIDEO_NOTIFY_CYCLE
mdefine_line|#define ACPI_VIDEO_NOTIFY_CYCLE&t;&t;0x82
DECL|macro|ACPI_VIDEO_NOTIFY_NEXT_OUTPUT
mdefine_line|#define ACPI_VIDEO_NOTIFY_NEXT_OUTPUT&t;0x83
DECL|macro|ACPI_VIDEO_NOTIFY_PREV_OUTPUT
mdefine_line|#define ACPI_VIDEO_NOTIFY_PREV_OUTPUT&t;0x84
DECL|macro|ACPI_VIDEO_NOTIFY_CYCLE_BRIGHTNESS
mdefine_line|#define ACPI_VIDEO_NOTIFY_CYCLE_BRIGHTNESS&t;0x82
DECL|macro|ACPI_VIDEO_NOTIFY_INC_BRIGHTNESS
mdefine_line|#define&t;ACPI_VIDEO_NOTIFY_INC_BRIGHTNESS&t;0x83
DECL|macro|ACPI_VIDEO_NOTIFY_DEC_BRIGHTNESS
mdefine_line|#define ACPI_VIDEO_NOTIFY_DEC_BRIGHTNESS&t;0x84
DECL|macro|ACPI_VIDEO_NOTIFY_ZERO_BRIGHTNESS
mdefine_line|#define ACPI_VIDEO_NOTIFY_ZERO_BRIGHTNESS&t;0x85
DECL|macro|ACPI_VIDEO_NOTIFY_DISPLAY_OFF
mdefine_line|#define ACPI_VIDEO_NOTIFY_DISPLAY_OFF&t;&t;0x86
DECL|macro|ACPI_VIDEO_HEAD_INVALID
mdefine_line|#define ACPI_VIDEO_HEAD_INVALID&t;&t;(~0ul - 1)
DECL|macro|ACPI_VIDEO_HEAD_END
mdefine_line|#define ACPI_VIDEO_HEAD_END&t;&t;(~0ul)
DECL|macro|_COMPONENT
mdefine_line|#define _COMPONENT&t;&t;ACPI_VIDEO_COMPONENT
id|ACPI_MODULE_NAME
(paren
l_string|&quot;acpi_video&quot;
)paren
id|MODULE_AUTHOR
c_func
(paren
l_string|&quot;Bruno Ducrot&quot;
)paren
suffix:semicolon
DECL|variable|ACPI_VIDEO_DRIVER_NAME
id|MODULE_DESCRIPTION
c_func
(paren
id|ACPI_VIDEO_DRIVER_NAME
)paren
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
r_static
r_int
id|acpi_video_bus_add
(paren
r_struct
id|acpi_device
op_star
id|device
)paren
suffix:semicolon
r_static
r_int
id|acpi_video_bus_remove
(paren
r_struct
id|acpi_device
op_star
id|device
comma
r_int
id|type
)paren
suffix:semicolon
r_static
r_int
id|acpi_video_bus_match
(paren
r_struct
id|acpi_device
op_star
id|device
comma
r_struct
id|acpi_driver
op_star
id|driver
)paren
suffix:semicolon
DECL|variable|acpi_video_bus
r_static
r_struct
id|acpi_driver
id|acpi_video_bus
op_assign
(brace
dot
id|name
op_assign
id|ACPI_VIDEO_DRIVER_NAME
comma
dot
r_class
op_assign
id|ACPI_VIDEO_CLASS
comma
dot
id|ops
op_assign
(brace
dot
id|add
op_assign
id|acpi_video_bus_add
comma
dot
id|remove
op_assign
id|acpi_video_bus_remove
comma
dot
id|match
op_assign
id|acpi_video_bus_match
comma
)brace
comma
)brace
suffix:semicolon
DECL|struct|acpi_video_bus_flags
r_struct
id|acpi_video_bus_flags
(brace
DECL|member|multihead
id|u8
id|multihead
suffix:colon
l_int|1
suffix:semicolon
multiline_comment|/* can switch video heads */
DECL|member|rom
id|u8
id|rom
suffix:colon
l_int|1
suffix:semicolon
multiline_comment|/* can retrieve a video rom */
DECL|member|post
id|u8
id|post
suffix:colon
l_int|1
suffix:semicolon
multiline_comment|/* can configure the head to */
DECL|member|reserved
id|u8
id|reserved
suffix:colon
l_int|5
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|acpi_video_bus_cap
r_struct
id|acpi_video_bus_cap
(brace
DECL|member|_DOS
id|u8
id|_DOS
suffix:colon
l_int|1
suffix:semicolon
multiline_comment|/*Enable/Disable output switching*/
DECL|member|_DOD
id|u8
id|_DOD
suffix:colon
l_int|1
suffix:semicolon
multiline_comment|/*Enumerate all devices attached to display adapter*/
DECL|member|_ROM
id|u8
id|_ROM
suffix:colon
l_int|1
suffix:semicolon
multiline_comment|/*Get ROM Data*/
DECL|member|_GPD
id|u8
id|_GPD
suffix:colon
l_int|1
suffix:semicolon
multiline_comment|/*Get POST Device*/
DECL|member|_SPD
id|u8
id|_SPD
suffix:colon
l_int|1
suffix:semicolon
multiline_comment|/*Set POST Device*/
DECL|member|_VPO
id|u8
id|_VPO
suffix:colon
l_int|1
suffix:semicolon
multiline_comment|/*Video POST Options*/
DECL|member|reserved
id|u8
id|reserved
suffix:colon
l_int|2
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|acpi_video_device_attrib
r_struct
id|acpi_video_device_attrib
(brace
DECL|member|display_index
id|u32
id|display_index
suffix:colon
l_int|4
suffix:semicolon
multiline_comment|/* A zero-based instance of the Display*/
DECL|member|display_port_attachment
id|u32
id|display_port_attachment
suffix:colon
l_int|4
suffix:semicolon
multiline_comment|/*This field differenates displays type*/
DECL|member|display_type
id|u32
id|display_type
suffix:colon
l_int|4
suffix:semicolon
multiline_comment|/*Describe the specific type in use*/
DECL|member|vendor_specific
id|u32
id|vendor_specific
suffix:colon
l_int|4
suffix:semicolon
multiline_comment|/*Chipset Vendor Specifi*/
DECL|member|bios_can_detect
id|u32
id|bios_can_detect
suffix:colon
l_int|1
suffix:semicolon
multiline_comment|/*BIOS can detect the device*/
DECL|member|depend_on_vga
id|u32
id|depend_on_vga
suffix:colon
l_int|1
suffix:semicolon
multiline_comment|/*Non-VGA output device whose power is related to &n;&t;&t;&t;&t;   the VGA device.*/
DECL|member|pipe_id
id|u32
id|pipe_id
suffix:colon
l_int|3
suffix:semicolon
multiline_comment|/*For VGA multiple-head devices.*/
DECL|member|reserved
id|u32
id|reserved
suffix:colon
l_int|10
suffix:semicolon
multiline_comment|/*Must be 0*/
DECL|member|device_id_scheme
id|u32
id|device_id_scheme
suffix:colon
l_int|1
suffix:semicolon
multiline_comment|/*Device ID Scheme*/
)brace
suffix:semicolon
DECL|struct|acpi_video_enumerated_device
r_struct
id|acpi_video_enumerated_device
(brace
r_union
(brace
DECL|member|int_val
id|u32
id|int_val
suffix:semicolon
DECL|member|attrib
r_struct
id|acpi_video_device_attrib
id|attrib
suffix:semicolon
DECL|member|value
)brace
id|value
suffix:semicolon
DECL|member|bind_info
r_struct
id|acpi_video_device
op_star
id|bind_info
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|acpi_video_bus
r_struct
id|acpi_video_bus
(brace
DECL|member|handle
id|acpi_handle
id|handle
suffix:semicolon
DECL|member|dos_setting
id|u8
id|dos_setting
suffix:semicolon
DECL|member|attached_array
r_struct
id|acpi_video_enumerated_device
op_star
id|attached_array
suffix:semicolon
DECL|member|attached_count
id|u8
id|attached_count
suffix:semicolon
DECL|member|cap
r_struct
id|acpi_video_bus_cap
id|cap
suffix:semicolon
DECL|member|flags
r_struct
id|acpi_video_bus_flags
id|flags
suffix:semicolon
DECL|member|sem
r_struct
id|semaphore
id|sem
suffix:semicolon
DECL|member|video_device_list
r_struct
id|list_head
id|video_device_list
suffix:semicolon
DECL|member|dir
r_struct
id|proc_dir_entry
op_star
id|dir
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|acpi_video_device_flags
r_struct
id|acpi_video_device_flags
(brace
DECL|member|crt
id|u8
id|crt
suffix:colon
l_int|1
suffix:semicolon
DECL|member|lcd
id|u8
id|lcd
suffix:colon
l_int|1
suffix:semicolon
DECL|member|tvout
id|u8
id|tvout
suffix:colon
l_int|1
suffix:semicolon
DECL|member|bios
id|u8
id|bios
suffix:colon
l_int|1
suffix:semicolon
DECL|member|unknown
id|u8
id|unknown
suffix:colon
l_int|1
suffix:semicolon
DECL|member|reserved
id|u8
id|reserved
suffix:colon
l_int|3
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|acpi_video_device_cap
r_struct
id|acpi_video_device_cap
(brace
DECL|member|_ADR
id|u8
id|_ADR
suffix:colon
l_int|1
suffix:semicolon
multiline_comment|/*Return the unique ID */
DECL|member|_BCL
id|u8
id|_BCL
suffix:colon
l_int|1
suffix:semicolon
multiline_comment|/*Query list of brightness control levels supported*/
DECL|member|_BCM
id|u8
id|_BCM
suffix:colon
l_int|1
suffix:semicolon
multiline_comment|/*Set the brightness level*/
DECL|member|_DDC
id|u8
id|_DDC
suffix:colon
l_int|1
suffix:semicolon
multiline_comment|/*Return the EDID for this device*/
DECL|member|_DCS
id|u8
id|_DCS
suffix:colon
l_int|1
suffix:semicolon
multiline_comment|/*Return status of output device*/
DECL|member|_DGS
id|u8
id|_DGS
suffix:colon
l_int|1
suffix:semicolon
multiline_comment|/*Query graphics state*/
DECL|member|_DSS
id|u8
id|_DSS
suffix:colon
l_int|1
suffix:semicolon
multiline_comment|/*Device state set*/
DECL|member|_reserved
id|u8
id|_reserved
suffix:colon
l_int|1
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|acpi_video_device_brightness
r_struct
id|acpi_video_device_brightness
(brace
DECL|member|curr
r_int
id|curr
suffix:semicolon
DECL|member|count
r_int
id|count
suffix:semicolon
DECL|member|levels
r_int
op_star
id|levels
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|acpi_video_device
r_struct
id|acpi_video_device
(brace
DECL|member|handle
id|acpi_handle
id|handle
suffix:semicolon
DECL|member|device_id
r_int
r_int
id|device_id
suffix:semicolon
DECL|member|flags
r_struct
id|acpi_video_device_flags
id|flags
suffix:semicolon
DECL|member|cap
r_struct
id|acpi_video_device_cap
id|cap
suffix:semicolon
DECL|member|entry
r_struct
id|list_head
id|entry
suffix:semicolon
DECL|member|video
r_struct
id|acpi_video_bus
op_star
id|video
suffix:semicolon
DECL|member|dev
r_struct
id|acpi_device
op_star
id|dev
suffix:semicolon
DECL|member|brightness
r_struct
id|acpi_video_device_brightness
op_star
id|brightness
suffix:semicolon
)brace
suffix:semicolon
multiline_comment|/* bus */
r_static
r_int
id|acpi_video_bus_info_open_fs
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
suffix:semicolon
DECL|variable|acpi_video_bus_info_fops
r_static
r_struct
id|file_operations
id|acpi_video_bus_info_fops
op_assign
(brace
dot
id|open
op_assign
id|acpi_video_bus_info_open_fs
comma
dot
id|read
op_assign
id|seq_read
comma
dot
id|llseek
op_assign
id|seq_lseek
comma
dot
id|release
op_assign
id|single_release
comma
)brace
suffix:semicolon
r_static
r_int
id|acpi_video_bus_ROM_open_fs
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
suffix:semicolon
DECL|variable|acpi_video_bus_ROM_fops
r_static
r_struct
id|file_operations
id|acpi_video_bus_ROM_fops
op_assign
(brace
dot
id|open
op_assign
id|acpi_video_bus_ROM_open_fs
comma
dot
id|read
op_assign
id|seq_read
comma
dot
id|llseek
op_assign
id|seq_lseek
comma
dot
id|release
op_assign
id|single_release
comma
)brace
suffix:semicolon
r_static
r_int
id|acpi_video_bus_POST_info_open_fs
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
suffix:semicolon
DECL|variable|acpi_video_bus_POST_info_fops
r_static
r_struct
id|file_operations
id|acpi_video_bus_POST_info_fops
op_assign
(brace
dot
id|open
op_assign
id|acpi_video_bus_POST_info_open_fs
comma
dot
id|read
op_assign
id|seq_read
comma
dot
id|llseek
op_assign
id|seq_lseek
comma
dot
id|release
op_assign
id|single_release
comma
)brace
suffix:semicolon
r_static
r_int
id|acpi_video_bus_POST_open_fs
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
suffix:semicolon
DECL|variable|acpi_video_bus_POST_fops
r_static
r_struct
id|file_operations
id|acpi_video_bus_POST_fops
op_assign
(brace
dot
id|open
op_assign
id|acpi_video_bus_POST_open_fs
comma
dot
id|read
op_assign
id|seq_read
comma
dot
id|llseek
op_assign
id|seq_lseek
comma
dot
id|release
op_assign
id|single_release
comma
)brace
suffix:semicolon
r_static
r_int
id|acpi_video_bus_DOS_open_fs
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
suffix:semicolon
DECL|variable|acpi_video_bus_DOS_fops
r_static
r_struct
id|file_operations
id|acpi_video_bus_DOS_fops
op_assign
(brace
dot
id|open
op_assign
id|acpi_video_bus_DOS_open_fs
comma
dot
id|read
op_assign
id|seq_read
comma
dot
id|llseek
op_assign
id|seq_lseek
comma
dot
id|release
op_assign
id|single_release
comma
)brace
suffix:semicolon
multiline_comment|/* device */
r_static
r_int
id|acpi_video_device_info_open_fs
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
suffix:semicolon
DECL|variable|acpi_video_device_info_fops
r_static
r_struct
id|file_operations
id|acpi_video_device_info_fops
op_assign
(brace
dot
id|open
op_assign
id|acpi_video_device_info_open_fs
comma
dot
id|read
op_assign
id|seq_read
comma
dot
id|llseek
op_assign
id|seq_lseek
comma
dot
id|release
op_assign
id|single_release
comma
)brace
suffix:semicolon
r_static
r_int
id|acpi_video_device_state_open_fs
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
suffix:semicolon
DECL|variable|acpi_video_device_state_fops
r_static
r_struct
id|file_operations
id|acpi_video_device_state_fops
op_assign
(brace
dot
id|open
op_assign
id|acpi_video_device_state_open_fs
comma
dot
id|read
op_assign
id|seq_read
comma
dot
id|llseek
op_assign
id|seq_lseek
comma
dot
id|release
op_assign
id|single_release
comma
)brace
suffix:semicolon
r_static
r_int
id|acpi_video_device_brightness_open_fs
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
suffix:semicolon
DECL|variable|acpi_video_device_brightness_fops
r_static
r_struct
id|file_operations
id|acpi_video_device_brightness_fops
op_assign
(brace
dot
id|open
op_assign
id|acpi_video_device_brightness_open_fs
comma
dot
id|read
op_assign
id|seq_read
comma
dot
id|llseek
op_assign
id|seq_lseek
comma
dot
id|release
op_assign
id|single_release
comma
)brace
suffix:semicolon
r_static
r_int
id|acpi_video_device_EDID_open_fs
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
suffix:semicolon
DECL|variable|acpi_video_device_EDID_fops
r_static
r_struct
id|file_operations
id|acpi_video_device_EDID_fops
op_assign
(brace
dot
id|open
op_assign
id|acpi_video_device_EDID_open_fs
comma
dot
id|read
op_assign
id|seq_read
comma
dot
id|llseek
op_assign
id|seq_lseek
comma
dot
id|release
op_assign
id|single_release
comma
)brace
suffix:semicolon
r_static
r_void
id|acpi_video_device_notify
(paren
id|acpi_handle
id|handle
comma
id|u32
id|event
comma
r_void
op_star
id|data
)paren
suffix:semicolon
r_static
r_void
id|acpi_video_device_rebind
c_func
(paren
r_struct
id|acpi_video_bus
op_star
id|video
)paren
suffix:semicolon
r_static
r_void
id|acpi_video_device_bind
c_func
(paren
r_struct
id|acpi_video_bus
op_star
id|video
comma
r_struct
id|acpi_video_device
op_star
id|device
)paren
suffix:semicolon
r_static
r_int
id|acpi_video_device_enumerate
c_func
(paren
r_struct
id|acpi_video_bus
op_star
id|video
)paren
suffix:semicolon
r_static
r_int
id|acpi_video_switch_output
c_func
(paren
r_struct
id|acpi_video_bus
op_star
id|video
comma
r_int
id|event
)paren
suffix:semicolon
r_static
r_int
id|acpi_video_get_next_level
c_func
(paren
r_struct
id|acpi_video_device
op_star
id|device
comma
id|u32
id|level_current
comma
id|u32
id|event
)paren
suffix:semicolon
r_static
r_void
id|acpi_video_switch_brightness
(paren
r_struct
id|acpi_video_device
op_star
id|device
comma
r_int
id|event
)paren
suffix:semicolon
multiline_comment|/* --------------------------------------------------------------------------&n;                               Video Management&n;   -------------------------------------------------------------------------- */
multiline_comment|/* device */
r_static
r_int
DECL|function|acpi_video_device_query
id|acpi_video_device_query
(paren
r_struct
id|acpi_video_device
op_star
id|device
comma
r_int
r_int
op_star
id|state
)paren
(brace
r_int
id|status
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_device_query&quot;
)paren
suffix:semicolon
id|status
op_assign
id|acpi_evaluate_integer
c_func
(paren
id|device-&gt;handle
comma
l_string|&quot;_DGS&quot;
comma
l_int|NULL
comma
id|state
)paren
suffix:semicolon
id|return_VALUE
c_func
(paren
id|status
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|acpi_video_device_get_state
id|acpi_video_device_get_state
(paren
r_struct
id|acpi_video_device
op_star
id|device
comma
r_int
r_int
op_star
id|state
)paren
(brace
r_int
id|status
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_device_get_state&quot;
)paren
suffix:semicolon
id|status
op_assign
id|acpi_evaluate_integer
c_func
(paren
id|device-&gt;handle
comma
l_string|&quot;_DCS&quot;
comma
l_int|NULL
comma
id|state
)paren
suffix:semicolon
id|return_VALUE
c_func
(paren
id|status
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|acpi_video_device_set_state
id|acpi_video_device_set_state
(paren
r_struct
id|acpi_video_device
op_star
id|device
comma
r_int
id|state
)paren
(brace
r_int
id|status
suffix:semicolon
r_union
id|acpi_object
id|arg0
op_assign
(brace
id|ACPI_TYPE_INTEGER
)brace
suffix:semicolon
r_struct
id|acpi_object_list
id|args
op_assign
(brace
l_int|1
comma
op_amp
id|arg0
)brace
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_device_set_state&quot;
)paren
suffix:semicolon
id|arg0.integer.value
op_assign
id|state
suffix:semicolon
id|status
op_assign
id|acpi_evaluate_integer
c_func
(paren
id|device-&gt;handle
comma
l_string|&quot;_DSS&quot;
comma
op_amp
id|args
comma
l_int|NULL
)paren
suffix:semicolon
id|return_VALUE
c_func
(paren
id|status
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|acpi_video_device_lcd_query_levels
id|acpi_video_device_lcd_query_levels
(paren
r_struct
id|acpi_video_device
op_star
id|device
comma
r_union
id|acpi_object
op_star
op_star
id|levels
)paren
(brace
r_int
id|status
suffix:semicolon
r_struct
id|acpi_buffer
id|buffer
op_assign
(brace
id|ACPI_ALLOCATE_BUFFER
comma
l_int|NULL
)brace
suffix:semicolon
r_union
id|acpi_object
op_star
id|obj
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_device_lcd_query_levels&quot;
)paren
suffix:semicolon
op_star
id|levels
op_assign
l_int|NULL
suffix:semicolon
id|status
op_assign
id|acpi_evaluate_object
c_func
(paren
id|device-&gt;handle
comma
l_string|&quot;_BCL&quot;
comma
l_int|NULL
comma
op_amp
id|buffer
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ACPI_SUCCESS
c_func
(paren
id|status
)paren
)paren
id|return_VALUE
c_func
(paren
id|status
)paren
suffix:semicolon
id|obj
op_assign
(paren
r_union
id|acpi_object
op_star
)paren
id|buffer.pointer
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|obj
op_logical_and
(paren
id|obj-&gt;type
op_ne
id|ACPI_TYPE_PACKAGE
)paren
)paren
(brace
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_ERROR
comma
l_string|&quot;Invalid _BCL data&bslash;n&quot;
)paren
)paren
suffix:semicolon
id|status
op_assign
op_minus
id|EFAULT
suffix:semicolon
r_goto
id|err
suffix:semicolon
)brace
op_star
id|levels
op_assign
id|obj
suffix:semicolon
id|return_VALUE
c_func
(paren
l_int|0
)paren
suffix:semicolon
id|err
suffix:colon
r_if
c_cond
(paren
id|buffer.pointer
)paren
id|kfree
c_func
(paren
id|buffer.pointer
)paren
suffix:semicolon
id|return_VALUE
c_func
(paren
id|status
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|acpi_video_device_lcd_set_level
id|acpi_video_device_lcd_set_level
(paren
r_struct
id|acpi_video_device
op_star
id|device
comma
r_int
id|level
)paren
(brace
r_int
id|status
suffix:semicolon
r_union
id|acpi_object
id|arg0
op_assign
(brace
id|ACPI_TYPE_INTEGER
)brace
suffix:semicolon
r_struct
id|acpi_object_list
id|args
op_assign
(brace
l_int|1
comma
op_amp
id|arg0
)brace
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_device_lcd_set_level&quot;
)paren
suffix:semicolon
id|arg0.integer.value
op_assign
id|level
suffix:semicolon
id|status
op_assign
id|acpi_evaluate_object
c_func
(paren
id|device-&gt;handle
comma
l_string|&quot;_BCM&quot;
comma
op_amp
id|args
comma
l_int|NULL
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;set_level status: %x&bslash;n&quot;
comma
id|status
)paren
suffix:semicolon
id|return_VALUE
c_func
(paren
id|status
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|acpi_video_device_lcd_get_level_current
id|acpi_video_device_lcd_get_level_current
(paren
r_struct
id|acpi_video_device
op_star
id|device
comma
r_int
r_int
op_star
id|level
)paren
(brace
r_int
id|status
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_device_lcd_get_level_current&quot;
)paren
suffix:semicolon
id|status
op_assign
id|acpi_evaluate_integer
c_func
(paren
id|device-&gt;handle
comma
l_string|&quot;_BQC&quot;
comma
l_int|NULL
comma
id|level
)paren
suffix:semicolon
id|return_VALUE
c_func
(paren
id|status
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|acpi_video_device_EDID
id|acpi_video_device_EDID
(paren
r_struct
id|acpi_video_device
op_star
id|device
comma
r_union
id|acpi_object
op_star
op_star
id|edid
comma
id|ssize_t
id|length
)paren
(brace
r_int
id|status
suffix:semicolon
r_struct
id|acpi_buffer
id|buffer
op_assign
(brace
id|ACPI_ALLOCATE_BUFFER
comma
l_int|NULL
)brace
suffix:semicolon
r_union
id|acpi_object
op_star
id|obj
suffix:semicolon
r_union
id|acpi_object
id|arg0
op_assign
(brace
id|ACPI_TYPE_INTEGER
)brace
suffix:semicolon
r_struct
id|acpi_object_list
id|args
op_assign
(brace
l_int|1
comma
op_amp
id|arg0
)brace
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_device_get_EDID&quot;
)paren
suffix:semicolon
op_star
id|edid
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|device
)paren
id|return_VALUE
c_func
(paren
op_minus
id|ENODEV
)paren
suffix:semicolon
r_if
c_cond
(paren
id|length
op_eq
l_int|128
)paren
id|arg0.integer.value
op_assign
l_int|1
suffix:semicolon
r_else
r_if
c_cond
(paren
id|length
op_eq
l_int|256
)paren
id|arg0.integer.value
op_assign
l_int|2
suffix:semicolon
r_else
id|return_VALUE
c_func
(paren
op_minus
id|EINVAL
)paren
suffix:semicolon
id|status
op_assign
id|acpi_evaluate_object
c_func
(paren
id|device-&gt;handle
comma
l_string|&quot;_DDC&quot;
comma
op_amp
id|args
comma
op_amp
id|buffer
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACPI_FAILURE
c_func
(paren
id|status
)paren
)paren
id|return_VALUE
c_func
(paren
op_minus
id|ENODEV
)paren
suffix:semicolon
id|obj
op_assign
(paren
r_union
id|acpi_object
op_star
)paren
id|buffer.pointer
suffix:semicolon
r_if
c_cond
(paren
id|obj
op_logical_and
id|obj-&gt;type
op_eq
id|ACPI_TYPE_BUFFER
)paren
op_star
id|edid
op_assign
id|obj
suffix:semicolon
r_else
(brace
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_ERROR
comma
l_string|&quot;Invalid _DDC data&bslash;n&quot;
)paren
)paren
suffix:semicolon
id|status
op_assign
op_minus
id|EFAULT
suffix:semicolon
id|kfree
c_func
(paren
id|obj
)paren
suffix:semicolon
)brace
id|return_VALUE
c_func
(paren
id|status
)paren
suffix:semicolon
)brace
multiline_comment|/* bus */
r_static
r_int
DECL|function|acpi_video_bus_set_POST
id|acpi_video_bus_set_POST
(paren
r_struct
id|acpi_video_bus
op_star
id|video
comma
r_int
r_int
id|option
)paren
(brace
r_int
id|status
suffix:semicolon
r_int
r_int
id|tmp
suffix:semicolon
r_union
id|acpi_object
id|arg0
op_assign
(brace
id|ACPI_TYPE_INTEGER
)brace
suffix:semicolon
r_struct
id|acpi_object_list
id|args
op_assign
(brace
l_int|1
comma
op_amp
id|arg0
)brace
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_bus_set_POST&quot;
)paren
suffix:semicolon
id|arg0.integer.value
op_assign
id|option
suffix:semicolon
id|status
op_assign
id|acpi_evaluate_integer
c_func
(paren
id|video-&gt;handle
comma
l_string|&quot;_SPD&quot;
comma
op_amp
id|args
comma
op_amp
id|tmp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACPI_SUCCESS
c_func
(paren
id|status
)paren
)paren
id|status
op_assign
id|tmp
ques
c_cond
(paren
op_minus
id|EINVAL
)paren
suffix:colon
(paren
id|AE_OK
)paren
suffix:semicolon
id|return_VALUE
c_func
(paren
id|status
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|acpi_video_bus_get_POST
id|acpi_video_bus_get_POST
(paren
r_struct
id|acpi_video_bus
op_star
id|video
comma
r_int
r_int
op_star
id|id
)paren
(brace
r_int
id|status
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_bus_get_POST&quot;
)paren
suffix:semicolon
id|status
op_assign
id|acpi_evaluate_integer
c_func
(paren
id|video-&gt;handle
comma
l_string|&quot;_GPD&quot;
comma
l_int|NULL
comma
id|id
)paren
suffix:semicolon
id|return_VALUE
c_func
(paren
id|status
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|acpi_video_bus_POST_options
id|acpi_video_bus_POST_options
(paren
r_struct
id|acpi_video_bus
op_star
id|video
comma
r_int
r_int
op_star
id|options
)paren
(brace
r_int
id|status
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_bus_POST_options&quot;
)paren
suffix:semicolon
id|status
op_assign
id|acpi_evaluate_integer
c_func
(paren
id|video-&gt;handle
comma
l_string|&quot;_VPO&quot;
comma
l_int|NULL
comma
id|options
)paren
suffix:semicolon
op_star
id|options
op_and_assign
l_int|3
suffix:semicolon
id|return_VALUE
c_func
(paren
id|status
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; *  Arg:&n; *  &t;video&t;&t;: video bus device pointer&n; *&t;bios_flag&t;: &n; *&t;&t;0.&t;The system BIOS should NOT automatically switch(toggle)&n; *&t;&t;&t;the active display output.&n; *&t;&t;1.&t;The system BIOS should automatically switch (toggle) the&n; *&t;&t;&t;active display output. No swich event.&n; *&t;&t;2.&t;The _DGS value should be locked.&n; *&t;&t;3.&t;The system BIOS should not automatically switch (toggle) the&n; *&t;&t;&t;active display output, but instead generate the display switch&n; *&t;&t;&t;event notify code.&n; *&t;lcd_flag&t;:&n; *&t;&t;0.&t;The system BIOS should automatically control the brightness level&n; *&t;&t;&t;of the LCD, when the power changes from AC to DC&n; *&t;&t;1. &t;The system BIOS should NOT automatically control the brightness &n; *&t;&t;&t;level of the LCD, when the power changes from AC to DC.&n; * Return Value:&n; * &t;&t;-1&t;wrong arg.&n; */
r_static
r_int
DECL|function|acpi_video_bus_DOS
id|acpi_video_bus_DOS
c_func
(paren
r_struct
id|acpi_video_bus
op_star
id|video
comma
r_int
id|bios_flag
comma
r_int
id|lcd_flag
)paren
(brace
id|acpi_integer
id|status
op_assign
l_int|0
suffix:semicolon
r_union
id|acpi_object
id|arg0
op_assign
(brace
id|ACPI_TYPE_INTEGER
)brace
suffix:semicolon
r_struct
id|acpi_object_list
id|args
op_assign
(brace
l_int|1
comma
op_amp
id|arg0
)brace
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_bus_DOS&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|bios_flag
template_param
l_int|3
op_logical_or
id|lcd_flag
template_param
l_int|1
)paren
(brace
id|status
op_assign
op_minus
l_int|1
suffix:semicolon
r_goto
id|Failed
suffix:semicolon
)brace
id|arg0.integer.value
op_assign
(paren
id|lcd_flag
op_lshift
l_int|2
)paren
op_or
id|bios_flag
suffix:semicolon
id|video-&gt;dos_setting
op_assign
id|arg0.integer.value
suffix:semicolon
id|acpi_evaluate_object
c_func
(paren
id|video-&gt;handle
comma
l_string|&quot;_DOS&quot;
comma
op_amp
id|args
comma
l_int|NULL
)paren
suffix:semicolon
id|Failed
suffix:colon
id|return_VALUE
c_func
(paren
id|status
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; *  Arg:&t;&n; *  &t;device&t;: video output device (LCD, CRT, ..)&n; *&n; *  Return Value:&n; *  &t;None&n; *&n; *  Find out all required AML method defined under the output&n; *  device.&n; */
r_static
r_void
DECL|function|acpi_video_device_find_cap
id|acpi_video_device_find_cap
(paren
r_struct
id|acpi_video_device
op_star
id|device
)paren
(brace
id|acpi_integer
id|status
suffix:semicolon
id|acpi_handle
id|h_dummy1
suffix:semicolon
r_int
id|i
suffix:semicolon
r_union
id|acpi_object
op_star
id|obj
op_assign
l_int|NULL
suffix:semicolon
r_struct
id|acpi_video_device_brightness
op_star
id|br
op_assign
l_int|NULL
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_device_find_cap&quot;
)paren
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|device-&gt;cap
comma
l_int|0
comma
l_int|4
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACPI_SUCCESS
c_func
(paren
id|acpi_get_handle
c_func
(paren
id|device-&gt;handle
comma
l_string|&quot;_ADR&quot;
comma
op_amp
id|h_dummy1
)paren
)paren
)paren
(brace
id|device-&gt;cap._ADR
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ACPI_SUCCESS
c_func
(paren
id|acpi_get_handle
c_func
(paren
id|device-&gt;handle
comma
l_string|&quot;_BCL&quot;
comma
op_amp
id|h_dummy1
)paren
)paren
)paren
(brace
id|device-&gt;cap._BCL
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ACPI_SUCCESS
c_func
(paren
id|acpi_get_handle
c_func
(paren
id|device-&gt;handle
comma
l_string|&quot;_BCM&quot;
comma
op_amp
id|h_dummy1
)paren
)paren
)paren
(brace
id|device-&gt;cap._BCM
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ACPI_SUCCESS
c_func
(paren
id|acpi_get_handle
c_func
(paren
id|device-&gt;handle
comma
l_string|&quot;_DDC&quot;
comma
op_amp
id|h_dummy1
)paren
)paren
)paren
(brace
id|device-&gt;cap._DDC
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ACPI_SUCCESS
c_func
(paren
id|acpi_get_handle
c_func
(paren
id|device-&gt;handle
comma
l_string|&quot;_DCS&quot;
comma
op_amp
id|h_dummy1
)paren
)paren
)paren
(brace
id|device-&gt;cap._DCS
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ACPI_SUCCESS
c_func
(paren
id|acpi_get_handle
c_func
(paren
id|device-&gt;handle
comma
l_string|&quot;_DGS&quot;
comma
op_amp
id|h_dummy1
)paren
)paren
)paren
(brace
id|device-&gt;cap._DGS
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ACPI_SUCCESS
c_func
(paren
id|acpi_get_handle
c_func
(paren
id|device-&gt;handle
comma
l_string|&quot;_DSS&quot;
comma
op_amp
id|h_dummy1
)paren
)paren
)paren
(brace
id|device-&gt;cap._DSS
op_assign
l_int|1
suffix:semicolon
)brace
id|status
op_assign
id|acpi_video_device_lcd_query_levels
c_func
(paren
id|device
comma
op_amp
id|obj
)paren
suffix:semicolon
r_if
c_cond
(paren
id|obj
op_logical_and
id|obj-&gt;type
op_eq
id|ACPI_TYPE_PACKAGE
op_logical_and
id|obj-&gt;package.count
op_ge
l_int|2
)paren
(brace
r_int
id|count
op_assign
l_int|0
suffix:semicolon
r_union
id|acpi_object
op_star
id|o
suffix:semicolon
id|br
op_assign
id|kmalloc
c_func
(paren
r_sizeof
op_amp
id|br
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|br
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;can&squot;t allocate memory&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|memset
c_func
(paren
id|br
comma
l_int|0
comma
r_sizeof
op_amp
id|br
)paren
suffix:semicolon
id|br-&gt;levels
op_assign
id|kmalloc
c_func
(paren
id|obj-&gt;package.count
op_star
r_sizeof
op_amp
id|br-&gt;levels
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|br-&gt;levels
)paren
r_goto
id|out
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|obj-&gt;package.count
suffix:semicolon
id|i
op_increment
)paren
(brace
id|o
op_assign
(paren
r_union
id|acpi_object
op_star
)paren
op_amp
id|obj-&gt;package.elements
(braket
id|i
)braket
suffix:semicolon
r_if
c_cond
(paren
id|o-&gt;type
op_ne
id|ACPI_TYPE_INTEGER
)paren
(brace
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_ERROR
comma
l_string|&quot;Invalid data&bslash;n&quot;
)paren
)paren
suffix:semicolon
r_continue
suffix:semicolon
)brace
id|br-&gt;levels
(braket
id|count
)braket
op_assign
(paren
id|u32
)paren
id|o-&gt;integer.value
suffix:semicolon
id|count
op_increment
suffix:semicolon
)brace
id|out
suffix:colon
r_if
c_cond
(paren
id|count
OL
l_int|2
)paren
(brace
r_if
c_cond
(paren
id|br-&gt;levels
)paren
id|kfree
c_func
(paren
id|br-&gt;levels
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|br
)paren
suffix:semicolon
)brace
r_else
(brace
id|br-&gt;count
op_assign
id|count
suffix:semicolon
id|device-&gt;brightness
op_assign
id|br
suffix:semicolon
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_INFO
comma
l_string|&quot;found %d brightness levels&bslash;n&quot;
comma
id|count
)paren
)paren
suffix:semicolon
)brace
)brace
)brace
r_if
c_cond
(paren
id|obj
)paren
id|kfree
c_func
(paren
id|obj
)paren
suffix:semicolon
id|return_VOID
suffix:semicolon
)brace
multiline_comment|/*&n; *  Arg:&t;&n; *  &t;device&t;: video output device (VGA)&n; *&n; *  Return Value:&n; *  &t;None&n; *&n; *  Find out all required AML method defined under the video bus device.&n; */
r_static
r_void
DECL|function|acpi_video_bus_find_cap
id|acpi_video_bus_find_cap
(paren
r_struct
id|acpi_video_bus
op_star
id|video
)paren
(brace
id|acpi_handle
id|h_dummy1
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|video-&gt;cap
comma
l_int|0
comma
l_int|4
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACPI_SUCCESS
c_func
(paren
id|acpi_get_handle
c_func
(paren
id|video-&gt;handle
comma
l_string|&quot;_DOS&quot;
comma
op_amp
id|h_dummy1
)paren
)paren
)paren
(brace
id|video-&gt;cap._DOS
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ACPI_SUCCESS
c_func
(paren
id|acpi_get_handle
c_func
(paren
id|video-&gt;handle
comma
l_string|&quot;_DOD&quot;
comma
op_amp
id|h_dummy1
)paren
)paren
)paren
(brace
id|video-&gt;cap._DOD
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ACPI_SUCCESS
c_func
(paren
id|acpi_get_handle
c_func
(paren
id|video-&gt;handle
comma
l_string|&quot;_ROM&quot;
comma
op_amp
id|h_dummy1
)paren
)paren
)paren
(brace
id|video-&gt;cap._ROM
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ACPI_SUCCESS
c_func
(paren
id|acpi_get_handle
c_func
(paren
id|video-&gt;handle
comma
l_string|&quot;_GPD&quot;
comma
op_amp
id|h_dummy1
)paren
)paren
)paren
(brace
id|video-&gt;cap._GPD
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ACPI_SUCCESS
c_func
(paren
id|acpi_get_handle
c_func
(paren
id|video-&gt;handle
comma
l_string|&quot;_SPD&quot;
comma
op_amp
id|h_dummy1
)paren
)paren
)paren
(brace
id|video-&gt;cap._SPD
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ACPI_SUCCESS
c_func
(paren
id|acpi_get_handle
c_func
(paren
id|video-&gt;handle
comma
l_string|&quot;_VPO&quot;
comma
op_amp
id|h_dummy1
)paren
)paren
)paren
(brace
id|video-&gt;cap._VPO
op_assign
l_int|1
suffix:semicolon
)brace
)brace
multiline_comment|/*&n; * Check whether the video bus device has required AML method to&n; * support the desired features&n; */
r_static
r_int
DECL|function|acpi_video_bus_check
id|acpi_video_bus_check
(paren
r_struct
id|acpi_video_bus
op_star
id|video
)paren
(brace
id|acpi_status
id|status
op_assign
op_minus
id|ENOENT
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_bus_check&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|video
)paren
id|return_VALUE
c_func
(paren
op_minus
id|EINVAL
)paren
suffix:semicolon
multiline_comment|/* Since there is no HID, CID and so on for VGA driver, we have&n;&t; * to check well known required nodes.&n;&t; */
multiline_comment|/* Does this device able to support video switching ? */
r_if
c_cond
(paren
id|video-&gt;cap._DOS
)paren
(brace
id|video-&gt;flags.multihead
op_assign
l_int|1
suffix:semicolon
id|status
op_assign
l_int|0
suffix:semicolon
)brace
multiline_comment|/* Does this device able to retrieve a retrieve a video ROM ? */
r_if
c_cond
(paren
id|video-&gt;cap._ROM
)paren
(brace
id|video-&gt;flags.rom
op_assign
l_int|1
suffix:semicolon
id|status
op_assign
l_int|0
suffix:semicolon
)brace
multiline_comment|/* Does this device able to configure which video device to POST ? */
r_if
c_cond
(paren
id|video-&gt;cap._GPD
op_logical_and
id|video-&gt;cap._SPD
op_logical_and
id|video-&gt;cap._VPO
)paren
(brace
id|video-&gt;flags.post
op_assign
l_int|1
suffix:semicolon
id|status
op_assign
l_int|0
suffix:semicolon
)brace
id|return_VALUE
c_func
(paren
id|status
)paren
suffix:semicolon
)brace
multiline_comment|/* --------------------------------------------------------------------------&n;                              FS Interface (/proc)&n;   -------------------------------------------------------------------------- */
DECL|variable|acpi_video_dir
r_struct
id|proc_dir_entry
op_star
id|acpi_video_dir
suffix:semicolon
multiline_comment|/* video devices */
r_static
id|ssize_t
DECL|function|acpi_video_device_info_seq_show
id|acpi_video_device_info_seq_show
(paren
r_struct
id|seq_file
op_star
id|seq
comma
r_void
op_star
id|offset
)paren
(brace
r_struct
id|acpi_video_device
op_star
id|dev
op_assign
(paren
r_struct
id|acpi_video_device
op_star
)paren
id|seq
op_member_access_from_pointer
r_private
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_device_info_seq_show&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dev
)paren
r_goto
id|end
suffix:semicolon
id|seq_printf
c_func
(paren
id|seq
comma
l_string|&quot;device_id:    0x%04x&bslash;n&quot;
comma
(paren
id|u32
)paren
id|dev-&gt;device_id
)paren
suffix:semicolon
id|seq_printf
c_func
(paren
id|seq
comma
l_string|&quot;type:         &quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dev-&gt;flags.crt
)paren
id|seq_printf
c_func
(paren
id|seq
comma
l_string|&quot;CRT&bslash;n&quot;
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|dev-&gt;flags.lcd
)paren
id|seq_printf
c_func
(paren
id|seq
comma
l_string|&quot;LCD&bslash;n&quot;
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|dev-&gt;flags.tvout
)paren
id|seq_printf
c_func
(paren
id|seq
comma
l_string|&quot;TVOUT&bslash;n&quot;
)paren
suffix:semicolon
r_else
id|seq_printf
c_func
(paren
id|seq
comma
l_string|&quot;UNKNOWN&bslash;n&quot;
)paren
suffix:semicolon
id|seq_printf
c_func
(paren
id|seq
comma
l_string|&quot;known by bios: %s&bslash;n&quot;
comma
id|dev-&gt;flags.bios
ques
c_cond
l_string|&quot;yes&quot;
suffix:colon
l_string|&quot;no&quot;
)paren
suffix:semicolon
id|end
suffix:colon
id|return_VALUE
c_func
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|acpi_video_device_info_open_fs
id|acpi_video_device_info_open_fs
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_return
id|single_open
c_func
(paren
id|file
comma
id|acpi_video_device_info_seq_show
comma
id|PDE
c_func
(paren
id|inode
)paren
op_member_access_from_pointer
id|data
)paren
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|acpi_video_device_state_seq_show
id|acpi_video_device_state_seq_show
(paren
r_struct
id|seq_file
op_star
id|seq
comma
r_void
op_star
id|offset
)paren
(brace
r_int
id|status
suffix:semicolon
r_struct
id|acpi_video_device
op_star
id|dev
op_assign
(paren
r_struct
id|acpi_video_device
op_star
)paren
id|seq
op_member_access_from_pointer
r_private
suffix:semicolon
r_int
r_int
id|state
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_device_state_seq_show&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dev
)paren
r_goto
id|end
suffix:semicolon
id|status
op_assign
id|acpi_video_device_get_state
c_func
(paren
id|dev
comma
op_amp
id|state
)paren
suffix:semicolon
id|seq_printf
c_func
(paren
id|seq
comma
l_string|&quot;state:     &quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACPI_SUCCESS
c_func
(paren
id|status
)paren
)paren
id|seq_printf
c_func
(paren
id|seq
comma
l_string|&quot;0x%02lx&bslash;n&quot;
comma
id|state
)paren
suffix:semicolon
r_else
id|seq_printf
c_func
(paren
id|seq
comma
l_string|&quot;&lt;not supported&gt;&bslash;n&quot;
)paren
suffix:semicolon
id|status
op_assign
id|acpi_video_device_query
c_func
(paren
id|dev
comma
op_amp
id|state
)paren
suffix:semicolon
id|seq_printf
c_func
(paren
id|seq
comma
l_string|&quot;query:     &quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACPI_SUCCESS
c_func
(paren
id|status
)paren
)paren
id|seq_printf
c_func
(paren
id|seq
comma
l_string|&quot;0x%02lx&bslash;n&quot;
comma
id|state
)paren
suffix:semicolon
r_else
id|seq_printf
c_func
(paren
id|seq
comma
l_string|&quot;&lt;not supported&gt;&bslash;n&quot;
)paren
suffix:semicolon
id|end
suffix:colon
id|return_VALUE
c_func
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|acpi_video_device_state_open_fs
id|acpi_video_device_state_open_fs
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_return
id|single_open
c_func
(paren
id|file
comma
id|acpi_video_device_state_seq_show
comma
id|PDE
c_func
(paren
id|inode
)paren
op_member_access_from_pointer
id|data
)paren
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|acpi_video_device_write_state
id|acpi_video_device_write_state
(paren
r_struct
id|file
op_star
id|file
comma
r_const
r_char
id|__user
op_star
id|buffer
comma
r_int
id|count
comma
id|loff_t
op_star
id|data
)paren
(brace
r_int
id|status
suffix:semicolon
r_struct
id|seq_file
op_star
id|m
op_assign
(paren
r_struct
id|seq_file
op_star
)paren
id|file-&gt;private_data
suffix:semicolon
r_struct
id|acpi_video_device
op_star
id|dev
op_assign
(paren
r_struct
id|acpi_video_device
op_star
)paren
id|m
op_member_access_from_pointer
r_private
suffix:semicolon
r_char
id|str
(braket
l_int|12
)braket
op_assign
(brace
l_int|0
)brace
suffix:semicolon
id|u32
id|state
op_assign
l_int|0
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_device_write_state&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dev
op_logical_or
id|count
op_plus
l_int|1
OG
r_sizeof
id|str
)paren
id|return_VALUE
c_func
(paren
op_minus
id|EINVAL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
id|str
comma
id|buffer
comma
id|count
)paren
)paren
id|return_VALUE
c_func
(paren
op_minus
id|EFAULT
)paren
suffix:semicolon
id|str
(braket
id|count
)braket
op_assign
l_int|0
suffix:semicolon
id|state
op_assign
id|simple_strtoul
c_func
(paren
id|str
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
id|state
op_and_assign
(paren
(paren
l_int|1ul
op_lshift
l_int|31
)paren
op_or
(paren
l_int|1ul
op_lshift
l_int|30
)paren
op_or
(paren
l_int|1ul
op_lshift
l_int|0
)paren
)paren
suffix:semicolon
id|status
op_assign
id|acpi_video_device_set_state
c_func
(paren
id|dev
comma
id|state
)paren
suffix:semicolon
r_if
c_cond
(paren
id|status
)paren
id|return_VALUE
c_func
(paren
op_minus
id|EFAULT
)paren
suffix:semicolon
id|return_VALUE
c_func
(paren
id|count
)paren
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|acpi_video_device_brightness_seq_show
id|acpi_video_device_brightness_seq_show
(paren
r_struct
id|seq_file
op_star
id|seq
comma
r_void
op_star
id|offset
)paren
(brace
r_struct
id|acpi_video_device
op_star
id|dev
op_assign
(paren
r_struct
id|acpi_video_device
op_star
)paren
id|seq
op_member_access_from_pointer
r_private
suffix:semicolon
r_int
id|i
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_device_brightness_seq_show&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dev
op_logical_or
op_logical_neg
id|dev-&gt;brightness
)paren
(brace
id|seq_printf
c_func
(paren
id|seq
comma
l_string|&quot;&lt;not supported&gt;&bslash;n&quot;
)paren
suffix:semicolon
id|return_VALUE
c_func
(paren
l_int|0
)paren
suffix:semicolon
)brace
id|seq_printf
c_func
(paren
id|seq
comma
l_string|&quot;levels: &quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|dev-&gt;brightness-&gt;count
suffix:semicolon
id|i
op_increment
)paren
id|seq_printf
c_func
(paren
id|seq
comma
l_string|&quot; %d&quot;
comma
id|dev-&gt;brightness-&gt;levels
(braket
id|i
)braket
)paren
suffix:semicolon
id|seq_printf
c_func
(paren
id|seq
comma
l_string|&quot;&bslash;ncurrent: %d&bslash;n&quot;
comma
id|dev-&gt;brightness-&gt;curr
)paren
suffix:semicolon
id|return_VALUE
c_func
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|acpi_video_device_brightness_open_fs
id|acpi_video_device_brightness_open_fs
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_return
id|single_open
c_func
(paren
id|file
comma
id|acpi_video_device_brightness_seq_show
comma
id|PDE
c_func
(paren
id|inode
)paren
op_member_access_from_pointer
id|data
)paren
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|acpi_video_device_write_brightness
id|acpi_video_device_write_brightness
(paren
r_struct
id|file
op_star
id|file
comma
r_const
r_char
id|__user
op_star
id|buffer
comma
r_int
id|count
comma
id|loff_t
op_star
id|data
)paren
(brace
r_struct
id|seq_file
op_star
id|m
op_assign
(paren
r_struct
id|seq_file
op_star
)paren
id|file-&gt;private_data
suffix:semicolon
r_struct
id|acpi_video_device
op_star
id|dev
op_assign
(paren
r_struct
id|acpi_video_device
op_star
)paren
id|m
op_member_access_from_pointer
r_private
suffix:semicolon
r_char
id|str
(braket
l_int|4
)braket
op_assign
(brace
l_int|0
)brace
suffix:semicolon
r_int
r_int
id|level
op_assign
l_int|0
suffix:semicolon
r_int
id|i
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_device_write_brightness&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dev
op_logical_or
id|count
op_plus
l_int|1
OG
r_sizeof
id|str
)paren
id|return_VALUE
c_func
(paren
op_minus
id|EINVAL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
id|str
comma
id|buffer
comma
id|count
)paren
)paren
id|return_VALUE
c_func
(paren
op_minus
id|EFAULT
)paren
suffix:semicolon
id|str
(braket
id|count
)braket
op_assign
l_int|0
suffix:semicolon
id|level
op_assign
id|simple_strtoul
c_func
(paren
id|str
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|level
OG
l_int|100
)paren
id|return_VALUE
c_func
(paren
op_minus
id|EFAULT
)paren
suffix:semicolon
multiline_comment|/* validate though the list of available levels */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|dev-&gt;brightness-&gt;count
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|level
op_eq
id|dev-&gt;brightness-&gt;levels
(braket
id|i
)braket
)paren
(brace
r_if
c_cond
(paren
id|ACPI_SUCCESS
c_func
(paren
id|acpi_video_device_lcd_set_level
c_func
(paren
id|dev
comma
id|level
)paren
)paren
)paren
id|dev-&gt;brightness-&gt;curr
op_assign
id|level
suffix:semicolon
r_break
suffix:semicolon
)brace
id|return_VALUE
c_func
(paren
id|count
)paren
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|acpi_video_device_EDID_seq_show
id|acpi_video_device_EDID_seq_show
(paren
r_struct
id|seq_file
op_star
id|seq
comma
r_void
op_star
id|offset
)paren
(brace
r_struct
id|acpi_video_device
op_star
id|dev
op_assign
(paren
r_struct
id|acpi_video_device
op_star
)paren
id|seq
op_member_access_from_pointer
r_private
suffix:semicolon
r_int
id|status
suffix:semicolon
r_int
id|i
suffix:semicolon
r_union
id|acpi_object
op_star
id|edid
op_assign
l_int|NULL
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_device_EDID_seq_show&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dev
)paren
r_goto
id|out
suffix:semicolon
id|status
op_assign
id|acpi_video_device_EDID
(paren
id|dev
comma
op_amp
id|edid
comma
l_int|128
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACPI_FAILURE
c_func
(paren
id|status
)paren
)paren
(brace
id|status
op_assign
id|acpi_video_device_EDID
(paren
id|dev
comma
op_amp
id|edid
comma
l_int|256
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ACPI_FAILURE
c_func
(paren
id|status
)paren
)paren
(brace
r_goto
id|out
suffix:semicolon
)brace
r_if
c_cond
(paren
id|edid
op_logical_and
id|edid-&gt;type
op_eq
id|ACPI_TYPE_BUFFER
)paren
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|edid-&gt;buffer.length
suffix:semicolon
id|i
op_increment
)paren
id|seq_putc
c_func
(paren
id|seq
comma
id|edid-&gt;buffer.pointer
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
id|out
suffix:colon
r_if
c_cond
(paren
op_logical_neg
id|edid
)paren
id|seq_printf
c_func
(paren
id|seq
comma
l_string|&quot;&lt;not supported&gt;&bslash;n&quot;
)paren
suffix:semicolon
r_else
id|kfree
c_func
(paren
id|edid
)paren
suffix:semicolon
id|return_VALUE
c_func
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|acpi_video_device_EDID_open_fs
id|acpi_video_device_EDID_open_fs
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_return
id|single_open
c_func
(paren
id|file
comma
id|acpi_video_device_EDID_seq_show
comma
id|PDE
c_func
(paren
id|inode
)paren
op_member_access_from_pointer
id|data
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|acpi_video_device_add_fs
id|acpi_video_device_add_fs
(paren
r_struct
id|acpi_device
op_star
id|device
)paren
(brace
r_struct
id|proc_dir_entry
op_star
id|entry
op_assign
l_int|NULL
suffix:semicolon
r_struct
id|acpi_video_device
op_star
id|vid_dev
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_device_add_fs&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|device
)paren
id|return_VALUE
c_func
(paren
op_minus
id|ENODEV
)paren
suffix:semicolon
id|vid_dev
op_assign
(paren
r_struct
id|acpi_video_device
op_star
)paren
id|acpi_driver_data
c_func
(paren
id|device
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|vid_dev
)paren
id|return_VALUE
c_func
(paren
op_minus
id|ENODEV
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|acpi_device_dir
c_func
(paren
id|device
)paren
)paren
(brace
id|acpi_device_dir
c_func
(paren
id|device
)paren
op_assign
id|proc_mkdir
c_func
(paren
id|acpi_device_bid
c_func
(paren
id|device
)paren
comma
id|vid_dev-&gt;video-&gt;dir
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|acpi_device_dir
c_func
(paren
id|device
)paren
)paren
id|return_VALUE
c_func
(paren
op_minus
id|ENODEV
)paren
suffix:semicolon
id|acpi_device_dir
c_func
(paren
id|device
)paren
op_member_access_from_pointer
id|owner
op_assign
id|THIS_MODULE
suffix:semicolon
)brace
multiline_comment|/* &squot;info&squot; [R] */
id|entry
op_assign
id|create_proc_entry
c_func
(paren
l_string|&quot;info&quot;
comma
id|S_IRUGO
comma
id|acpi_device_dir
c_func
(paren
id|device
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|entry
)paren
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_ERROR
comma
l_string|&quot;Unable to create &squot;info&squot; fs entry&bslash;n&quot;
)paren
)paren
suffix:semicolon
r_else
(brace
id|entry-&gt;proc_fops
op_assign
op_amp
id|acpi_video_device_info_fops
suffix:semicolon
id|entry-&gt;data
op_assign
id|acpi_driver_data
c_func
(paren
id|device
)paren
suffix:semicolon
id|entry-&gt;owner
op_assign
id|THIS_MODULE
suffix:semicolon
)brace
multiline_comment|/* &squot;state&squot; [R/W] */
id|entry
op_assign
id|create_proc_entry
c_func
(paren
l_string|&quot;state&quot;
comma
id|S_IFREG
op_or
id|S_IRUGO
op_or
id|S_IWUSR
comma
id|acpi_device_dir
c_func
(paren
id|device
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|entry
)paren
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_ERROR
comma
l_string|&quot;Unable to create &squot;state&squot; fs entry&bslash;n&quot;
)paren
)paren
suffix:semicolon
r_else
(brace
id|entry-&gt;proc_fops
op_assign
op_amp
id|acpi_video_device_state_fops
suffix:semicolon
id|entry-&gt;proc_fops-&gt;write
op_assign
id|acpi_video_device_write_state
suffix:semicolon
id|entry-&gt;data
op_assign
id|acpi_driver_data
c_func
(paren
id|device
)paren
suffix:semicolon
id|entry-&gt;owner
op_assign
id|THIS_MODULE
suffix:semicolon
)brace
multiline_comment|/* &squot;brightness&squot; [R/W] */
id|entry
op_assign
id|create_proc_entry
c_func
(paren
l_string|&quot;brightness&quot;
comma
id|S_IFREG
op_or
id|S_IRUGO
op_or
id|S_IWUSR
comma
id|acpi_device_dir
c_func
(paren
id|device
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|entry
)paren
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_ERROR
comma
l_string|&quot;Unable to create &squot;brightness&squot; fs entry&bslash;n&quot;
)paren
)paren
suffix:semicolon
r_else
(brace
id|entry-&gt;proc_fops
op_assign
op_amp
id|acpi_video_device_brightness_fops
suffix:semicolon
id|entry-&gt;proc_fops-&gt;write
op_assign
id|acpi_video_device_write_brightness
suffix:semicolon
id|entry-&gt;data
op_assign
id|acpi_driver_data
c_func
(paren
id|device
)paren
suffix:semicolon
id|entry-&gt;owner
op_assign
id|THIS_MODULE
suffix:semicolon
)brace
multiline_comment|/* &squot;EDID&squot; [R] */
id|entry
op_assign
id|create_proc_entry
c_func
(paren
l_string|&quot;EDID&quot;
comma
id|S_IRUGO
comma
id|acpi_device_dir
c_func
(paren
id|device
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|entry
)paren
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_ERROR
comma
l_string|&quot;Unable to create &squot;brightness&squot; fs entry&bslash;n&quot;
)paren
)paren
suffix:semicolon
r_else
(brace
id|entry-&gt;proc_fops
op_assign
op_amp
id|acpi_video_device_EDID_fops
suffix:semicolon
id|entry-&gt;data
op_assign
id|acpi_driver_data
c_func
(paren
id|device
)paren
suffix:semicolon
id|entry-&gt;owner
op_assign
id|THIS_MODULE
suffix:semicolon
)brace
id|return_VALUE
c_func
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|acpi_video_device_remove_fs
id|acpi_video_device_remove_fs
(paren
r_struct
id|acpi_device
op_star
id|device
)paren
(brace
r_struct
id|acpi_video_device
op_star
id|vid_dev
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_device_remove_fs&quot;
)paren
suffix:semicolon
id|vid_dev
op_assign
(paren
r_struct
id|acpi_video_device
op_star
)paren
id|acpi_driver_data
c_func
(paren
id|device
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|vid_dev
op_logical_or
op_logical_neg
id|vid_dev-&gt;video
op_logical_or
op_logical_neg
id|vid_dev-&gt;video-&gt;dir
)paren
id|return_VALUE
c_func
(paren
op_minus
id|ENODEV
)paren
suffix:semicolon
r_if
c_cond
(paren
id|acpi_device_dir
c_func
(paren
id|device
)paren
)paren
(brace
id|remove_proc_entry
c_func
(paren
l_string|&quot;info&quot;
comma
id|acpi_device_dir
c_func
(paren
id|device
)paren
)paren
suffix:semicolon
id|remove_proc_entry
c_func
(paren
l_string|&quot;state&quot;
comma
id|acpi_device_dir
c_func
(paren
id|device
)paren
)paren
suffix:semicolon
id|remove_proc_entry
c_func
(paren
l_string|&quot;brightness&quot;
comma
id|acpi_device_dir
c_func
(paren
id|device
)paren
)paren
suffix:semicolon
id|remove_proc_entry
c_func
(paren
l_string|&quot;EDID&quot;
comma
id|acpi_device_dir
c_func
(paren
id|device
)paren
)paren
suffix:semicolon
id|remove_proc_entry
c_func
(paren
id|acpi_device_bid
c_func
(paren
id|device
)paren
comma
id|vid_dev-&gt;video-&gt;dir
)paren
suffix:semicolon
id|acpi_device_dir
c_func
(paren
id|device
)paren
op_assign
l_int|NULL
suffix:semicolon
)brace
id|return_VALUE
c_func
(paren
l_int|0
)paren
suffix:semicolon
)brace
multiline_comment|/* video bus */
r_static
id|ssize_t
DECL|function|acpi_video_bus_info_seq_show
id|acpi_video_bus_info_seq_show
(paren
r_struct
id|seq_file
op_star
id|seq
comma
r_void
op_star
id|offset
)paren
(brace
r_struct
id|acpi_video_bus
op_star
id|video
op_assign
(paren
r_struct
id|acpi_video_bus
op_star
)paren
id|seq
op_member_access_from_pointer
r_private
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_bus_info_seq_show&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|video
)paren
r_goto
id|end
suffix:semicolon
id|seq_printf
c_func
(paren
id|seq
comma
l_string|&quot;Switching heads:              %s&bslash;n&quot;
comma
id|video-&gt;flags.multihead
ques
c_cond
l_string|&quot;yes&quot;
suffix:colon
l_string|&quot;no&quot;
)paren
suffix:semicolon
id|seq_printf
c_func
(paren
id|seq
comma
l_string|&quot;Video ROM:                    %s&bslash;n&quot;
comma
id|video-&gt;flags.rom
ques
c_cond
l_string|&quot;yes&quot;
suffix:colon
l_string|&quot;no&quot;
)paren
suffix:semicolon
id|seq_printf
c_func
(paren
id|seq
comma
l_string|&quot;Device to be POSTed on boot:  %s&bslash;n&quot;
comma
id|video-&gt;flags.post
ques
c_cond
l_string|&quot;yes&quot;
suffix:colon
l_string|&quot;no&quot;
)paren
suffix:semicolon
id|end
suffix:colon
id|return_VALUE
c_func
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|acpi_video_bus_info_open_fs
id|acpi_video_bus_info_open_fs
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_return
id|single_open
c_func
(paren
id|file
comma
id|acpi_video_bus_info_seq_show
comma
id|PDE
c_func
(paren
id|inode
)paren
op_member_access_from_pointer
id|data
)paren
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|acpi_video_bus_ROM_seq_show
id|acpi_video_bus_ROM_seq_show
(paren
r_struct
id|seq_file
op_star
id|seq
comma
r_void
op_star
id|offset
)paren
(brace
r_struct
id|acpi_video_bus
op_star
id|video
op_assign
(paren
r_struct
id|acpi_video_bus
op_star
)paren
id|seq
op_member_access_from_pointer
r_private
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_bus_ROM_seq_show&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|video
)paren
r_goto
id|end
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
id|PREFIX
l_string|&quot;Please implement %s&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
id|seq_printf
c_func
(paren
id|seq
comma
l_string|&quot;&lt;TODO&gt;&bslash;n&quot;
)paren
suffix:semicolon
id|end
suffix:colon
id|return_VALUE
c_func
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|acpi_video_bus_ROM_open_fs
id|acpi_video_bus_ROM_open_fs
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_return
id|single_open
c_func
(paren
id|file
comma
id|acpi_video_bus_ROM_seq_show
comma
id|PDE
c_func
(paren
id|inode
)paren
op_member_access_from_pointer
id|data
)paren
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|acpi_video_bus_POST_info_seq_show
id|acpi_video_bus_POST_info_seq_show
(paren
r_struct
id|seq_file
op_star
id|seq
comma
r_void
op_star
id|offset
)paren
(brace
r_struct
id|acpi_video_bus
op_star
id|video
op_assign
(paren
r_struct
id|acpi_video_bus
op_star
)paren
id|seq
op_member_access_from_pointer
r_private
suffix:semicolon
r_int
r_int
id|options
suffix:semicolon
r_int
id|status
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_bus_POST_info_seq_show&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|video
)paren
r_goto
id|end
suffix:semicolon
id|status
op_assign
id|acpi_video_bus_POST_options
c_func
(paren
id|video
comma
op_amp
id|options
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACPI_SUCCESS
c_func
(paren
id|status
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|options
op_amp
l_int|1
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
id|PREFIX
l_string|&quot;The motherboard VGA device is not listed as a possible POST device.&bslash;n&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_WARNING
id|PREFIX
l_string|&quot;This indicate a BIOS bug.  Please contact the manufacturer.&bslash;n&quot;
)paren
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;%lx&bslash;n&quot;
comma
id|options
)paren
suffix:semicolon
id|seq_printf
c_func
(paren
id|seq
comma
l_string|&quot;can POST: &lt;intgrated video&gt;&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|options
op_amp
l_int|2
)paren
id|seq_printf
c_func
(paren
id|seq
comma
l_string|&quot; &lt;PCI video&gt;&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|options
op_amp
l_int|4
)paren
id|seq_printf
c_func
(paren
id|seq
comma
l_string|&quot; &lt;AGP video&gt;&quot;
)paren
suffix:semicolon
id|seq_putc
c_func
(paren
id|seq
comma
l_char|&squot;&bslash;n&squot;
)paren
suffix:semicolon
)brace
r_else
id|seq_printf
c_func
(paren
id|seq
comma
l_string|&quot;&lt;not supported&gt;&bslash;n&quot;
)paren
suffix:semicolon
id|end
suffix:colon
id|return_VALUE
c_func
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|acpi_video_bus_POST_info_open_fs
id|acpi_video_bus_POST_info_open_fs
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_return
id|single_open
c_func
(paren
id|file
comma
id|acpi_video_bus_POST_info_seq_show
comma
id|PDE
c_func
(paren
id|inode
)paren
op_member_access_from_pointer
id|data
)paren
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|acpi_video_bus_POST_seq_show
id|acpi_video_bus_POST_seq_show
(paren
r_struct
id|seq_file
op_star
id|seq
comma
r_void
op_star
id|offset
)paren
(brace
r_struct
id|acpi_video_bus
op_star
id|video
op_assign
(paren
r_struct
id|acpi_video_bus
op_star
)paren
id|seq
op_member_access_from_pointer
r_private
suffix:semicolon
r_int
id|status
suffix:semicolon
r_int
r_int
id|id
suffix:semicolon
r_char
id|device_decode
(braket
)braket
(braket
l_int|30
)braket
op_assign
(brace
l_string|&quot;motherboard VGA device&quot;
comma
l_string|&quot;PCI VGA device&quot;
comma
l_string|&quot;AGP VGA device&quot;
comma
l_string|&quot;UNKNOWN&quot;
comma
)brace
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_bus_POST_seq_show&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|video
)paren
r_goto
id|end
suffix:semicolon
id|status
op_assign
id|acpi_video_bus_get_POST
(paren
id|video
comma
op_amp
id|id
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ACPI_SUCCESS
c_func
(paren
id|status
)paren
)paren
(brace
id|seq_printf
c_func
(paren
id|seq
comma
l_string|&quot;&lt;not supported&gt;&bslash;n&quot;
)paren
suffix:semicolon
r_goto
id|end
suffix:semicolon
)brace
id|seq_printf
c_func
(paren
id|seq
comma
l_string|&quot;device posted is &lt;%s&gt;&bslash;n&quot;
comma
id|device_decode
(braket
id|id
op_amp
l_int|3
)braket
)paren
suffix:semicolon
id|end
suffix:colon
id|return_VALUE
c_func
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|acpi_video_bus_DOS_seq_show
id|acpi_video_bus_DOS_seq_show
(paren
r_struct
id|seq_file
op_star
id|seq
comma
r_void
op_star
id|offset
)paren
(brace
r_struct
id|acpi_video_bus
op_star
id|video
op_assign
(paren
r_struct
id|acpi_video_bus
op_star
)paren
id|seq
op_member_access_from_pointer
r_private
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_bus_DOS_seq_show&quot;
)paren
suffix:semicolon
id|seq_printf
c_func
(paren
id|seq
comma
l_string|&quot;DOS setting: &lt;%d&gt;&bslash;n&quot;
comma
id|video-&gt;dos_setting
)paren
suffix:semicolon
id|return_VALUE
c_func
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|acpi_video_bus_POST_open_fs
id|acpi_video_bus_POST_open_fs
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_return
id|single_open
c_func
(paren
id|file
comma
id|acpi_video_bus_POST_seq_show
comma
id|PDE
c_func
(paren
id|inode
)paren
op_member_access_from_pointer
id|data
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|acpi_video_bus_DOS_open_fs
id|acpi_video_bus_DOS_open_fs
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_return
id|single_open
c_func
(paren
id|file
comma
id|acpi_video_bus_DOS_seq_show
comma
id|PDE
c_func
(paren
id|inode
)paren
op_member_access_from_pointer
id|data
)paren
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|acpi_video_bus_write_POST
id|acpi_video_bus_write_POST
(paren
r_struct
id|file
op_star
id|file
comma
r_const
r_char
id|__user
op_star
id|buffer
comma
r_int
id|count
comma
id|loff_t
op_star
id|data
)paren
(brace
r_int
id|status
suffix:semicolon
r_struct
id|seq_file
op_star
id|m
op_assign
(paren
r_struct
id|seq_file
op_star
)paren
id|file-&gt;private_data
suffix:semicolon
r_struct
id|acpi_video_bus
op_star
id|video
op_assign
(paren
r_struct
id|acpi_video_bus
op_star
)paren
id|m
op_member_access_from_pointer
r_private
suffix:semicolon
r_char
id|str
(braket
l_int|12
)braket
op_assign
(brace
l_int|0
)brace
suffix:semicolon
r_int
r_int
id|opt
comma
id|options
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_bus_write_POST&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|video
op_logical_or
id|count
op_plus
l_int|1
OG
r_sizeof
id|str
)paren
id|return_VALUE
c_func
(paren
op_minus
id|EINVAL
)paren
suffix:semicolon
id|status
op_assign
id|acpi_video_bus_POST_options
c_func
(paren
id|video
comma
op_amp
id|options
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ACPI_SUCCESS
c_func
(paren
id|status
)paren
)paren
id|return_VALUE
c_func
(paren
op_minus
id|EINVAL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
id|str
comma
id|buffer
comma
id|count
)paren
)paren
id|return_VALUE
c_func
(paren
op_minus
id|EFAULT
)paren
suffix:semicolon
id|str
(braket
id|count
)braket
op_assign
l_int|0
suffix:semicolon
id|opt
op_assign
id|strtoul
c_func
(paren
id|str
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|opt
OG
l_int|3
)paren
id|return_VALUE
c_func
(paren
op_minus
id|EFAULT
)paren
suffix:semicolon
multiline_comment|/* just in case an OEM &squot;forget&squot; the motherboard... */
id|options
op_or_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|options
op_amp
(paren
l_int|1ul
op_lshift
id|opt
)paren
)paren
(brace
id|status
op_assign
id|acpi_video_bus_set_POST
(paren
id|video
comma
id|opt
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ACPI_SUCCESS
c_func
(paren
id|status
)paren
)paren
id|return_VALUE
c_func
(paren
op_minus
id|EFAULT
)paren
suffix:semicolon
)brace
id|return_VALUE
c_func
(paren
id|count
)paren
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|acpi_video_bus_write_DOS
id|acpi_video_bus_write_DOS
(paren
r_struct
id|file
op_star
id|file
comma
r_const
r_char
id|__user
op_star
id|buffer
comma
r_int
id|count
comma
id|loff_t
op_star
id|data
)paren
(brace
r_int
id|status
suffix:semicolon
r_struct
id|seq_file
op_star
id|m
op_assign
(paren
r_struct
id|seq_file
op_star
)paren
id|file-&gt;private_data
suffix:semicolon
r_struct
id|acpi_video_bus
op_star
id|video
op_assign
(paren
r_struct
id|acpi_video_bus
op_star
)paren
id|m
op_member_access_from_pointer
r_private
suffix:semicolon
r_char
id|str
(braket
l_int|12
)braket
op_assign
(brace
l_int|0
)brace
suffix:semicolon
r_int
r_int
id|opt
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_bus_write_DOS&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|video
op_logical_or
id|count
op_plus
l_int|1
OG
r_sizeof
id|str
)paren
id|return_VALUE
c_func
(paren
op_minus
id|EINVAL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
id|str
comma
id|buffer
comma
id|count
)paren
)paren
id|return_VALUE
c_func
(paren
op_minus
id|EFAULT
)paren
suffix:semicolon
id|str
(braket
id|count
)braket
op_assign
l_int|0
suffix:semicolon
id|opt
op_assign
id|strtoul
c_func
(paren
id|str
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|opt
OG
l_int|7
)paren
id|return_VALUE
c_func
(paren
op_minus
id|EFAULT
)paren
suffix:semicolon
id|status
op_assign
id|acpi_video_bus_DOS
(paren
id|video
comma
id|opt
op_amp
l_int|0x3
comma
(paren
id|opt
op_amp
l_int|0x4
)paren
op_rshift
l_int|2
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ACPI_SUCCESS
c_func
(paren
id|status
)paren
)paren
id|return_VALUE
c_func
(paren
op_minus
id|EFAULT
)paren
suffix:semicolon
id|return_VALUE
c_func
(paren
id|count
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|acpi_video_bus_add_fs
id|acpi_video_bus_add_fs
(paren
r_struct
id|acpi_device
op_star
id|device
)paren
(brace
r_struct
id|proc_dir_entry
op_star
id|entry
op_assign
l_int|NULL
suffix:semicolon
r_struct
id|acpi_video_bus
op_star
id|video
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_bus_add_fs&quot;
)paren
suffix:semicolon
id|video
op_assign
(paren
r_struct
id|acpi_video_bus
op_star
)paren
id|acpi_driver_data
c_func
(paren
id|device
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|acpi_device_dir
c_func
(paren
id|device
)paren
)paren
(brace
id|acpi_device_dir
c_func
(paren
id|device
)paren
op_assign
id|proc_mkdir
c_func
(paren
id|acpi_device_bid
c_func
(paren
id|device
)paren
comma
id|acpi_video_dir
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|acpi_device_dir
c_func
(paren
id|device
)paren
)paren
id|return_VALUE
c_func
(paren
op_minus
id|ENODEV
)paren
suffix:semicolon
id|video-&gt;dir
op_assign
id|acpi_device_dir
c_func
(paren
id|device
)paren
suffix:semicolon
id|acpi_device_dir
c_func
(paren
id|device
)paren
op_member_access_from_pointer
id|owner
op_assign
id|THIS_MODULE
suffix:semicolon
)brace
multiline_comment|/* &squot;info&squot; [R] */
id|entry
op_assign
id|create_proc_entry
c_func
(paren
l_string|&quot;info&quot;
comma
id|S_IRUGO
comma
id|acpi_device_dir
c_func
(paren
id|device
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|entry
)paren
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_ERROR
comma
l_string|&quot;Unable to create &squot;info&squot; fs entry&bslash;n&quot;
)paren
)paren
suffix:semicolon
r_else
(brace
id|entry-&gt;proc_fops
op_assign
op_amp
id|acpi_video_bus_info_fops
suffix:semicolon
id|entry-&gt;data
op_assign
id|acpi_driver_data
c_func
(paren
id|device
)paren
suffix:semicolon
id|entry-&gt;owner
op_assign
id|THIS_MODULE
suffix:semicolon
)brace
multiline_comment|/* &squot;ROM&squot; [R] */
id|entry
op_assign
id|create_proc_entry
c_func
(paren
l_string|&quot;ROM&quot;
comma
id|S_IRUGO
comma
id|acpi_device_dir
c_func
(paren
id|device
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|entry
)paren
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_ERROR
comma
l_string|&quot;Unable to create &squot;ROM&squot; fs entry&bslash;n&quot;
)paren
)paren
suffix:semicolon
r_else
(brace
id|entry-&gt;proc_fops
op_assign
op_amp
id|acpi_video_bus_ROM_fops
suffix:semicolon
id|entry-&gt;data
op_assign
id|acpi_driver_data
c_func
(paren
id|device
)paren
suffix:semicolon
id|entry-&gt;owner
op_assign
id|THIS_MODULE
suffix:semicolon
)brace
multiline_comment|/* &squot;POST_info&squot; [R] */
id|entry
op_assign
id|create_proc_entry
c_func
(paren
l_string|&quot;POST_info&quot;
comma
id|S_IRUGO
comma
id|acpi_device_dir
c_func
(paren
id|device
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|entry
)paren
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_ERROR
comma
l_string|&quot;Unable to create &squot;POST_info&squot; fs entry&bslash;n&quot;
)paren
)paren
suffix:semicolon
r_else
(brace
id|entry-&gt;proc_fops
op_assign
op_amp
id|acpi_video_bus_POST_info_fops
suffix:semicolon
id|entry-&gt;data
op_assign
id|acpi_driver_data
c_func
(paren
id|device
)paren
suffix:semicolon
id|entry-&gt;owner
op_assign
id|THIS_MODULE
suffix:semicolon
)brace
multiline_comment|/* &squot;POST&squot; [R/W] */
id|entry
op_assign
id|create_proc_entry
c_func
(paren
l_string|&quot;POST&quot;
comma
id|S_IFREG
op_or
id|S_IRUGO
op_or
id|S_IRUSR
comma
id|acpi_device_dir
c_func
(paren
id|device
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|entry
)paren
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_ERROR
comma
l_string|&quot;Unable to create &squot;POST&squot; fs entry&bslash;n&quot;
)paren
)paren
suffix:semicolon
r_else
(brace
id|entry-&gt;proc_fops
op_assign
op_amp
id|acpi_video_bus_POST_fops
suffix:semicolon
id|entry-&gt;proc_fops-&gt;write
op_assign
id|acpi_video_bus_write_POST
suffix:semicolon
id|entry-&gt;data
op_assign
id|acpi_driver_data
c_func
(paren
id|device
)paren
suffix:semicolon
id|entry-&gt;owner
op_assign
id|THIS_MODULE
suffix:semicolon
)brace
multiline_comment|/* &squot;DOS&squot; [R/W] */
id|entry
op_assign
id|create_proc_entry
c_func
(paren
l_string|&quot;DOS&quot;
comma
id|S_IFREG
op_or
id|S_IRUGO
op_or
id|S_IRUSR
comma
id|acpi_device_dir
c_func
(paren
id|device
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|entry
)paren
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_ERROR
comma
l_string|&quot;Unable to create &squot;DOS&squot; fs entry&bslash;n&quot;
)paren
)paren
suffix:semicolon
r_else
(brace
id|entry-&gt;proc_fops
op_assign
op_amp
id|acpi_video_bus_DOS_fops
suffix:semicolon
id|entry-&gt;proc_fops-&gt;write
op_assign
id|acpi_video_bus_write_DOS
suffix:semicolon
id|entry-&gt;data
op_assign
id|acpi_driver_data
c_func
(paren
id|device
)paren
suffix:semicolon
id|entry-&gt;owner
op_assign
id|THIS_MODULE
suffix:semicolon
)brace
id|return_VALUE
c_func
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|acpi_video_bus_remove_fs
id|acpi_video_bus_remove_fs
(paren
r_struct
id|acpi_device
op_star
id|device
)paren
(brace
r_struct
id|acpi_video_bus
op_star
id|video
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_bus_remove_fs&quot;
)paren
suffix:semicolon
id|video
op_assign
(paren
r_struct
id|acpi_video_bus
op_star
)paren
id|acpi_driver_data
c_func
(paren
id|device
)paren
suffix:semicolon
r_if
c_cond
(paren
id|acpi_device_dir
c_func
(paren
id|device
)paren
)paren
(brace
id|remove_proc_entry
c_func
(paren
l_string|&quot;info&quot;
comma
id|acpi_device_dir
c_func
(paren
id|device
)paren
)paren
suffix:semicolon
id|remove_proc_entry
c_func
(paren
l_string|&quot;ROM&quot;
comma
id|acpi_device_dir
c_func
(paren
id|device
)paren
)paren
suffix:semicolon
id|remove_proc_entry
c_func
(paren
l_string|&quot;POST_info&quot;
comma
id|acpi_device_dir
c_func
(paren
id|device
)paren
)paren
suffix:semicolon
id|remove_proc_entry
c_func
(paren
l_string|&quot;POST&quot;
comma
id|acpi_device_dir
c_func
(paren
id|device
)paren
)paren
suffix:semicolon
id|remove_proc_entry
c_func
(paren
l_string|&quot;DOS&quot;
comma
id|acpi_device_dir
c_func
(paren
id|device
)paren
)paren
suffix:semicolon
id|remove_proc_entry
c_func
(paren
id|acpi_device_bid
c_func
(paren
id|device
)paren
comma
id|acpi_video_dir
)paren
suffix:semicolon
id|acpi_device_dir
c_func
(paren
id|device
)paren
op_assign
l_int|NULL
suffix:semicolon
)brace
id|return_VALUE
c_func
(paren
l_int|0
)paren
suffix:semicolon
)brace
multiline_comment|/* --------------------------------------------------------------------------&n;                                 Driver Interface&n;   -------------------------------------------------------------------------- */
multiline_comment|/* device interface */
r_static
r_int
DECL|function|acpi_video_bus_get_one_device
id|acpi_video_bus_get_one_device
(paren
r_struct
id|acpi_device
op_star
id|device
comma
r_struct
id|acpi_video_bus
op_star
id|video
)paren
(brace
r_int
r_int
id|device_id
suffix:semicolon
r_int
id|status
comma
id|result
suffix:semicolon
r_struct
id|acpi_video_device
op_star
id|data
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_bus_get_one_device&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|device
op_logical_or
op_logical_neg
id|video
)paren
id|return_VALUE
c_func
(paren
op_minus
id|EINVAL
)paren
suffix:semicolon
id|status
op_assign
id|acpi_evaluate_integer
c_func
(paren
id|device-&gt;handle
comma
l_string|&quot;_ADR&quot;
comma
l_int|NULL
comma
op_amp
id|device_id
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACPI_SUCCESS
c_func
(paren
id|status
)paren
)paren
(brace
id|data
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|acpi_video_device
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|data
)paren
id|return_VALUE
c_func
(paren
op_minus
id|ENOMEM
)paren
suffix:semicolon
id|memset
c_func
(paren
id|data
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|acpi_video_device
)paren
)paren
suffix:semicolon
id|data-&gt;handle
op_assign
id|device-&gt;handle
suffix:semicolon
id|strcpy
c_func
(paren
id|acpi_device_name
c_func
(paren
id|device
)paren
comma
id|ACPI_VIDEO_DEVICE_NAME
)paren
suffix:semicolon
id|strcpy
c_func
(paren
id|acpi_device_class
c_func
(paren
id|device
)paren
comma
id|ACPI_VIDEO_CLASS
)paren
suffix:semicolon
id|acpi_driver_data
c_func
(paren
id|device
)paren
op_assign
id|data
suffix:semicolon
id|data-&gt;device_id
op_assign
id|device_id
suffix:semicolon
id|data-&gt;video
op_assign
id|video
suffix:semicolon
id|data-&gt;dev
op_assign
id|device
suffix:semicolon
r_switch
c_cond
(paren
id|device_id
op_amp
l_int|0xffff
)paren
(brace
r_case
l_int|0x0100
suffix:colon
id|data-&gt;flags.crt
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x0400
suffix:colon
id|data-&gt;flags.lcd
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x0200
suffix:colon
id|data-&gt;flags.tvout
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|data-&gt;flags.unknown
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
)brace
id|acpi_video_device_bind
c_func
(paren
id|video
comma
id|data
)paren
suffix:semicolon
id|acpi_video_device_find_cap
c_func
(paren
id|data
)paren
suffix:semicolon
id|status
op_assign
id|acpi_install_notify_handler
c_func
(paren
id|data-&gt;handle
comma
id|ACPI_DEVICE_NOTIFY
comma
id|acpi_video_device_notify
comma
id|data
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACPI_FAILURE
c_func
(paren
id|status
)paren
)paren
(brace
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_ERROR
comma
l_string|&quot;Error installing notify handler&bslash;n&quot;
)paren
)paren
suffix:semicolon
id|result
op_assign
op_minus
id|ENODEV
suffix:semicolon
r_goto
id|end
suffix:semicolon
)brace
id|down
c_func
(paren
op_amp
id|video-&gt;sem
)paren
suffix:semicolon
id|list_add_tail
c_func
(paren
op_amp
id|data-&gt;entry
comma
op_amp
id|video-&gt;video_device_list
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|video-&gt;sem
)paren
suffix:semicolon
id|acpi_video_device_add_fs
c_func
(paren
id|device
)paren
suffix:semicolon
id|return_VALUE
c_func
(paren
l_int|0
)paren
suffix:semicolon
)brace
id|end
suffix:colon
id|return_VALUE
c_func
(paren
op_minus
id|ENOENT
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; *  Arg:&n; *  &t;video&t;: video bus device &n; *&n; *  Return:&n; *  &t;none&n; *  &n; *  Enumerate the video device list of the video bus, &n; *  bind the ids with the corresponding video devices&n; *  under the video bus.&n; */
r_static
r_void
DECL|function|acpi_video_device_rebind
id|acpi_video_device_rebind
c_func
(paren
r_struct
id|acpi_video_bus
op_star
id|video
)paren
(brace
r_struct
id|list_head
op_star
id|node
comma
op_star
id|next
suffix:semicolon
id|list_for_each_safe
c_func
(paren
id|node
comma
id|next
comma
op_amp
id|video-&gt;video_device_list
)paren
(brace
r_struct
id|acpi_video_device
op_star
id|dev
op_assign
id|container_of
c_func
(paren
id|node
comma
r_struct
id|acpi_video_device
comma
id|entry
)paren
suffix:semicolon
id|acpi_video_device_bind
c_func
(paren
id|video
comma
id|dev
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/*&n; *  Arg:&n; *  &t;video&t;: video bus device &n; *  &t;device&t;: video output device under the video &n; *  &t;&t;bus&n; *&n; *  Return:&n; *  &t;none&n; *  &n; *  Bind the ids with the corresponding video devices&n; *  under the video bus.&n; */
r_static
r_void
DECL|function|acpi_video_device_bind
id|acpi_video_device_bind
c_func
(paren
r_struct
id|acpi_video_bus
op_star
id|video
comma
r_struct
id|acpi_video_device
op_star
id|device
)paren
(brace
r_int
id|i
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_device_bind&quot;
)paren
suffix:semicolon
DECL|macro|IDS_VAL
mdefine_line|#define IDS_VAL(i) video-&gt;attached_array[i].value.int_val
DECL|macro|IDS_BIND
mdefine_line|#define IDS_BIND(i) video-&gt;attached_array[i].bind_info
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|IDS_VAL
c_func
(paren
id|i
)paren
op_ne
id|ACPI_VIDEO_HEAD_INVALID
op_logical_and
id|i
OL
id|video-&gt;attached_count
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|device-&gt;device_id
op_eq
(paren
id|IDS_VAL
c_func
(paren
id|i
)paren
op_amp
l_int|0xffff
)paren
)paren
(brace
id|IDS_BIND
c_func
(paren
id|i
)paren
op_assign
id|device
suffix:semicolon
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_INFO
comma
l_string|&quot;device_bind %d&bslash;n&quot;
comma
id|i
)paren
)paren
suffix:semicolon
)brace
)brace
DECL|macro|IDS_VAL
macro_line|#undef IDS_VAL
DECL|macro|IDS_BIND
macro_line|#undef IDS_BIND
)brace
multiline_comment|/*&n; *  Arg:&n; *  &t;video&t;: video bus device &n; *&n; *  Return:&n; *  &t;&lt; 0&t;: error&n; *  &n; *  Call _DOD to enumerate all devices attached to display adapter&n; *&n; */
DECL|function|acpi_video_device_enumerate
r_static
r_int
id|acpi_video_device_enumerate
c_func
(paren
r_struct
id|acpi_video_bus
op_star
id|video
)paren
(brace
r_int
id|status
suffix:semicolon
r_int
id|count
suffix:semicolon
r_int
id|i
suffix:semicolon
r_struct
id|acpi_video_enumerated_device
op_star
id|active_device_list
suffix:semicolon
r_struct
id|acpi_buffer
id|buffer
op_assign
(brace
id|ACPI_ALLOCATE_BUFFER
comma
l_int|NULL
)brace
suffix:semicolon
r_union
id|acpi_object
op_star
id|dod
op_assign
l_int|NULL
suffix:semicolon
r_union
id|acpi_object
op_star
id|obj
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_device_enumerate&quot;
)paren
suffix:semicolon
id|status
op_assign
id|acpi_evaluate_object
c_func
(paren
id|video-&gt;handle
comma
l_string|&quot;_DOD&quot;
comma
l_int|NULL
comma
op_amp
id|buffer
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ACPI_SUCCESS
c_func
(paren
id|status
)paren
)paren
(brace
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_ERROR
comma
l_string|&quot;Error evaluating _DOD&bslash;n&quot;
)paren
)paren
suffix:semicolon
id|return_VALUE
c_func
(paren
id|status
)paren
suffix:semicolon
)brace
id|dod
op_assign
(paren
r_union
id|acpi_object
op_star
)paren
id|buffer.pointer
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dod
op_logical_or
(paren
id|dod-&gt;type
op_ne
id|ACPI_TYPE_PACKAGE
)paren
)paren
(brace
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_ERROR
comma
l_string|&quot;Invalid _DOD data&bslash;n&quot;
)paren
)paren
suffix:semicolon
id|status
op_assign
op_minus
id|EFAULT
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_INFO
comma
l_string|&quot;Found %d video heads in _DOD&bslash;n&quot;
comma
id|dod-&gt;package.count
)paren
)paren
suffix:semicolon
id|active_device_list
op_assign
id|kmalloc
c_func
(paren
id|dod-&gt;package.count
op_star
r_sizeof
(paren
r_struct
id|acpi_video_enumerated_device
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|active_device_list
)paren
(brace
id|status
op_assign
op_minus
id|ENOMEM
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|count
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|dod-&gt;package.count
suffix:semicolon
id|i
op_increment
)paren
(brace
id|obj
op_assign
(paren
r_union
id|acpi_object
op_star
)paren
op_amp
id|dod-&gt;package.elements
(braket
id|i
)braket
suffix:semicolon
r_if
c_cond
(paren
id|obj-&gt;type
op_ne
id|ACPI_TYPE_INTEGER
)paren
(brace
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_ERROR
comma
l_string|&quot;Invalid _DOD data&bslash;n&quot;
)paren
)paren
suffix:semicolon
id|active_device_list
(braket
id|i
)braket
dot
id|value.int_val
op_assign
id|ACPI_VIDEO_HEAD_INVALID
suffix:semicolon
)brace
id|active_device_list
(braket
id|i
)braket
dot
id|value.int_val
op_assign
id|obj-&gt;integer.value
suffix:semicolon
id|active_device_list
(braket
id|i
)braket
dot
id|bind_info
op_assign
l_int|NULL
suffix:semicolon
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_INFO
comma
l_string|&quot;dod element[%d] = %d&bslash;n&quot;
comma
id|i
comma
(paren
r_int
)paren
id|obj-&gt;integer.value
)paren
)paren
suffix:semicolon
id|count
op_increment
suffix:semicolon
)brace
id|active_device_list
(braket
id|count
)braket
dot
id|value.int_val
op_assign
id|ACPI_VIDEO_HEAD_END
suffix:semicolon
r_if
c_cond
(paren
id|video-&gt;attached_array
)paren
(brace
id|kfree
c_func
(paren
id|video-&gt;attached_array
)paren
suffix:semicolon
)brace
id|video-&gt;attached_array
op_assign
id|active_device_list
suffix:semicolon
id|video-&gt;attached_count
op_assign
id|count
suffix:semicolon
id|out
suffix:colon
id|acpi_os_free
c_func
(paren
id|buffer.pointer
)paren
suffix:semicolon
id|return_VALUE
c_func
(paren
id|status
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; *  Arg:&n; *  &t;video&t;: video bus device &n; *  &t;event&t;: Nontify Event&n; *&n; *  Return:&n; *  &t;&lt; 0&t;: error&n; *  &n; *&t;1. Find out the current active output device.&n; *&t;2. Identify the next output device to switch&n; *&t;3. call _DSS to do actual switch.&n; */
r_static
r_int
DECL|function|acpi_video_switch_output
id|acpi_video_switch_output
c_func
(paren
r_struct
id|acpi_video_bus
op_star
id|video
comma
r_int
id|event
)paren
(brace
r_struct
id|list_head
op_star
id|node
comma
op_star
id|next
suffix:semicolon
r_struct
id|acpi_video_device
op_star
id|dev
op_assign
l_int|NULL
suffix:semicolon
r_struct
id|acpi_video_device
op_star
id|dev_next
op_assign
l_int|NULL
suffix:semicolon
r_struct
id|acpi_video_device
op_star
id|dev_prev
op_assign
l_int|NULL
suffix:semicolon
r_int
r_int
id|state
suffix:semicolon
r_int
id|status
op_assign
l_int|0
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_switch_output&quot;
)paren
suffix:semicolon
id|list_for_each_safe
c_func
(paren
id|node
comma
id|next
comma
op_amp
id|video-&gt;video_device_list
)paren
(brace
r_struct
id|acpi_video_device
op_star
id|dev
op_assign
id|container_of
c_func
(paren
id|node
comma
r_struct
id|acpi_video_device
comma
id|entry
)paren
suffix:semicolon
id|status
op_assign
id|acpi_video_device_get_state
c_func
(paren
id|dev
comma
op_amp
id|state
)paren
suffix:semicolon
r_if
c_cond
(paren
id|state
op_amp
l_int|0x2
)paren
(brace
id|dev_next
op_assign
id|container_of
c_func
(paren
id|node-&gt;next
comma
r_struct
id|acpi_video_device
comma
id|entry
)paren
suffix:semicolon
id|dev_prev
op_assign
id|container_of
c_func
(paren
id|node-&gt;prev
comma
r_struct
id|acpi_video_device
comma
id|entry
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
)brace
id|dev_next
op_assign
id|container_of
c_func
(paren
id|node-&gt;next
comma
r_struct
id|acpi_video_device
comma
id|entry
)paren
suffix:semicolon
id|dev_prev
op_assign
id|container_of
c_func
(paren
id|node-&gt;prev
comma
r_struct
id|acpi_video_device
comma
id|entry
)paren
suffix:semicolon
id|out
suffix:colon
r_switch
c_cond
(paren
id|event
)paren
(brace
r_case
id|ACPI_VIDEO_NOTIFY_CYCLE
suffix:colon
r_case
id|ACPI_VIDEO_NOTIFY_NEXT_OUTPUT
suffix:colon
id|acpi_video_device_set_state
c_func
(paren
id|dev
comma
l_int|0
)paren
suffix:semicolon
id|acpi_video_device_set_state
c_func
(paren
id|dev_next
comma
l_int|0x80000001
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ACPI_VIDEO_NOTIFY_PREV_OUTPUT
suffix:colon
id|acpi_video_device_set_state
c_func
(paren
id|dev
comma
l_int|0
)paren
suffix:semicolon
id|acpi_video_device_set_state
c_func
(paren
id|dev_prev
comma
l_int|0x80000001
)paren
suffix:semicolon
r_default
suffix:colon
r_break
suffix:semicolon
)brace
id|return_VALUE
c_func
(paren
id|status
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|acpi_video_get_next_level
id|acpi_video_get_next_level
c_func
(paren
r_struct
id|acpi_video_device
op_star
id|device
comma
id|u32
id|level_current
comma
id|u32
id|event
)paren
(brace
multiline_comment|/*Fix me*/
r_return
id|level_current
suffix:semicolon
)brace
r_static
r_void
DECL|function|acpi_video_switch_brightness
id|acpi_video_switch_brightness
(paren
r_struct
id|acpi_video_device
op_star
id|device
comma
r_int
id|event
)paren
(brace
r_int
r_int
id|level_current
comma
id|level_next
suffix:semicolon
id|acpi_video_device_lcd_get_level_current
c_func
(paren
id|device
comma
op_amp
id|level_current
)paren
suffix:semicolon
id|level_next
op_assign
id|acpi_video_get_next_level
c_func
(paren
id|device
comma
id|level_current
comma
id|event
)paren
suffix:semicolon
id|acpi_video_device_lcd_set_level
c_func
(paren
id|device
comma
id|level_next
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|acpi_video_bus_get_devices
id|acpi_video_bus_get_devices
(paren
r_struct
id|acpi_video_bus
op_star
id|video
comma
r_struct
id|acpi_device
op_star
id|device
)paren
(brace
r_int
id|status
op_assign
l_int|0
suffix:semicolon
r_struct
id|list_head
op_star
id|node
comma
op_star
id|next
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_get_devices&quot;
)paren
suffix:semicolon
id|acpi_video_device_enumerate
c_func
(paren
id|video
)paren
suffix:semicolon
id|list_for_each_safe
c_func
(paren
id|node
comma
id|next
comma
op_amp
id|device-&gt;children
)paren
(brace
r_struct
id|acpi_device
op_star
id|dev
op_assign
id|list_entry
c_func
(paren
id|node
comma
r_struct
id|acpi_device
comma
id|node
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dev
)paren
r_continue
suffix:semicolon
id|status
op_assign
id|acpi_video_bus_get_one_device
c_func
(paren
id|dev
comma
id|video
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACPI_FAILURE
c_func
(paren
id|status
)paren
)paren
(brace
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_ERROR
comma
l_string|&quot;Cant attach device&bslash;n&quot;
)paren
)paren
suffix:semicolon
r_continue
suffix:semicolon
)brace
)brace
id|return_VALUE
c_func
(paren
id|status
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|acpi_video_bus_put_one_device
id|acpi_video_bus_put_one_device
c_func
(paren
r_struct
id|acpi_video_device
op_star
id|device
)paren
(brace
r_struct
id|acpi_video_bus
op_star
id|video
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_bus_put_one_device&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|device
op_logical_or
op_logical_neg
id|device-&gt;video
)paren
r_return
(paren
op_minus
id|ENOENT
)paren
suffix:semicolon
id|video
op_assign
id|device-&gt;video
suffix:semicolon
id|down
c_func
(paren
op_amp
id|video-&gt;sem
)paren
suffix:semicolon
id|list_del
c_func
(paren
op_amp
id|device-&gt;entry
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|video-&gt;sem
)paren
suffix:semicolon
id|acpi_video_device_remove_fs
c_func
(paren
id|device-&gt;dev
)paren
suffix:semicolon
id|return_VALUE
c_func
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|acpi_video_bus_put_devices
id|acpi_video_bus_put_devices
(paren
r_struct
id|acpi_video_bus
op_star
id|video
)paren
(brace
r_int
id|status
suffix:semicolon
r_struct
id|list_head
op_star
id|node
comma
op_star
id|next
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_bus_put_devices&quot;
)paren
suffix:semicolon
id|list_for_each_safe
c_func
(paren
id|node
comma
id|next
comma
op_amp
id|video-&gt;video_device_list
)paren
(brace
r_struct
id|acpi_video_device
op_star
id|data
op_assign
id|list_entry
c_func
(paren
id|node
comma
r_struct
id|acpi_video_device
comma
id|entry
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|data
)paren
r_continue
suffix:semicolon
id|status
op_assign
id|acpi_video_bus_put_one_device
c_func
(paren
id|data
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACPI_FAILURE
c_func
(paren
id|status
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
id|PREFIX
l_string|&quot;hhuuhhuu bug in acpi video driver.&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|data-&gt;brightness
)paren
id|kfree
c_func
(paren
id|data-&gt;brightness
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|data
)paren
suffix:semicolon
)brace
id|return_VALUE
c_func
(paren
l_int|0
)paren
suffix:semicolon
)brace
multiline_comment|/* acpi_video interface */
r_static
r_int
DECL|function|acpi_video_bus_start_devices
id|acpi_video_bus_start_devices
c_func
(paren
r_struct
id|acpi_video_bus
op_star
id|video
)paren
(brace
r_return
id|acpi_video_bus_DOS
c_func
(paren
id|video
comma
l_int|1
comma
l_int|0
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|acpi_video_bus_stop_devices
id|acpi_video_bus_stop_devices
c_func
(paren
r_struct
id|acpi_video_bus
op_star
id|video
)paren
(brace
r_return
id|acpi_video_bus_DOS
c_func
(paren
id|video
comma
l_int|0
comma
l_int|1
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|acpi_video_bus_notify
id|acpi_video_bus_notify
(paren
id|acpi_handle
id|handle
comma
id|u32
id|event
comma
r_void
op_star
id|data
)paren
(brace
r_struct
id|acpi_video_bus
op_star
id|video
op_assign
(paren
r_struct
id|acpi_video_bus
op_star
)paren
id|data
suffix:semicolon
r_struct
id|acpi_device
op_star
id|device
op_assign
l_int|NULL
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_bus_notify&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;video bus notify&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|video
)paren
id|return_VOID
suffix:semicolon
r_if
c_cond
(paren
id|acpi_bus_get_device
c_func
(paren
id|handle
comma
op_amp
id|device
)paren
)paren
id|return_VOID
suffix:semicolon
r_switch
c_cond
(paren
id|event
)paren
(brace
r_case
id|ACPI_VIDEO_NOTIFY_SWITCH
suffix:colon
multiline_comment|/* User request that a switch occur,&n;&t;&t;&t;&t;&t; * most likely via hotkey. */
id|acpi_bus_generate_event
c_func
(paren
id|device
comma
id|event
comma
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ACPI_VIDEO_NOTIFY_PROBE
suffix:colon
multiline_comment|/* User plug or remove a video&n;&t;&t;&t;&t;&t; * connector. */
id|acpi_video_device_enumerate
c_func
(paren
id|video
)paren
suffix:semicolon
id|acpi_video_device_rebind
c_func
(paren
id|video
)paren
suffix:semicolon
id|acpi_video_switch_output
c_func
(paren
id|video
comma
id|event
)paren
suffix:semicolon
id|acpi_bus_generate_event
c_func
(paren
id|device
comma
id|event
comma
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ACPI_VIDEO_NOTIFY_CYCLE
suffix:colon
multiline_comment|/* Cycle Display output hotkey pressed.*/
r_case
id|ACPI_VIDEO_NOTIFY_NEXT_OUTPUT
suffix:colon
multiline_comment|/* Next Display output hotkey pressed. */
r_case
id|ACPI_VIDEO_NOTIFY_PREV_OUTPUT
suffix:colon
multiline_comment|/* previous Display output hotkey pressed. */
id|acpi_video_switch_output
c_func
(paren
id|video
comma
id|event
)paren
suffix:semicolon
id|acpi_bus_generate_event
c_func
(paren
id|device
comma
id|event
comma
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_INFO
comma
l_string|&quot;Unsupported event [0x%x]&bslash;n&quot;
comma
id|event
)paren
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|return_VOID
suffix:semicolon
)brace
r_static
r_void
DECL|function|acpi_video_device_notify
id|acpi_video_device_notify
(paren
id|acpi_handle
id|handle
comma
id|u32
id|event
comma
r_void
op_star
id|data
)paren
(brace
r_struct
id|acpi_video_device
op_star
id|video_device
op_assign
(paren
r_struct
id|acpi_video_device
op_star
)paren
id|data
suffix:semicolon
r_struct
id|acpi_device
op_star
id|device
op_assign
l_int|NULL
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_device_notify&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;video device notify&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|video_device
)paren
id|return_VOID
suffix:semicolon
r_if
c_cond
(paren
id|acpi_bus_get_device
c_func
(paren
id|handle
comma
op_amp
id|device
)paren
)paren
id|return_VOID
suffix:semicolon
r_switch
c_cond
(paren
id|event
)paren
(brace
r_case
id|ACPI_VIDEO_NOTIFY_SWITCH
suffix:colon
multiline_comment|/* change in status (cycle output device) */
r_case
id|ACPI_VIDEO_NOTIFY_PROBE
suffix:colon
multiline_comment|/* change in status (output device status) */
id|acpi_bus_generate_event
c_func
(paren
id|device
comma
id|event
comma
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ACPI_VIDEO_NOTIFY_CYCLE_BRIGHTNESS
suffix:colon
multiline_comment|/* Cycle brightness */
r_case
id|ACPI_VIDEO_NOTIFY_INC_BRIGHTNESS
suffix:colon
multiline_comment|/* Increase brightness */
r_case
id|ACPI_VIDEO_NOTIFY_DEC_BRIGHTNESS
suffix:colon
multiline_comment|/* Decrease brightness */
r_case
id|ACPI_VIDEO_NOTIFY_ZERO_BRIGHTNESS
suffix:colon
multiline_comment|/* zero brightnesss */
r_case
id|ACPI_VIDEO_NOTIFY_DISPLAY_OFF
suffix:colon
multiline_comment|/* display device off */
id|acpi_video_switch_brightness
(paren
id|video_device
comma
id|event
)paren
suffix:semicolon
id|acpi_bus_generate_event
c_func
(paren
id|device
comma
id|event
comma
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_INFO
comma
l_string|&quot;Unsupported event [0x%x]&bslash;n&quot;
comma
id|event
)paren
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|return_VOID
suffix:semicolon
)brace
r_static
r_int
DECL|function|acpi_video_bus_add
id|acpi_video_bus_add
(paren
r_struct
id|acpi_device
op_star
id|device
)paren
(brace
r_int
id|result
op_assign
l_int|0
suffix:semicolon
id|acpi_status
id|status
op_assign
l_int|0
suffix:semicolon
r_struct
id|acpi_video_bus
op_star
id|video
op_assign
l_int|NULL
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_bus_add&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|device
)paren
id|return_VALUE
c_func
(paren
op_minus
id|EINVAL
)paren
suffix:semicolon
id|video
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|acpi_video_bus
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|video
)paren
id|return_VALUE
c_func
(paren
op_minus
id|ENOMEM
)paren
suffix:semicolon
id|memset
c_func
(paren
id|video
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|acpi_video_bus
)paren
)paren
suffix:semicolon
id|video-&gt;handle
op_assign
id|device-&gt;handle
suffix:semicolon
id|strcpy
c_func
(paren
id|acpi_device_name
c_func
(paren
id|device
)paren
comma
id|ACPI_VIDEO_BUS_NAME
)paren
suffix:semicolon
id|strcpy
c_func
(paren
id|acpi_device_class
c_func
(paren
id|device
)paren
comma
id|ACPI_VIDEO_CLASS
)paren
suffix:semicolon
id|acpi_driver_data
c_func
(paren
id|device
)paren
op_assign
id|video
suffix:semicolon
id|acpi_video_bus_find_cap
c_func
(paren
id|video
)paren
suffix:semicolon
id|result
op_assign
id|acpi_video_bus_check
c_func
(paren
id|video
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
r_goto
id|end
suffix:semicolon
id|result
op_assign
id|acpi_video_bus_add_fs
c_func
(paren
id|device
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
)paren
r_goto
id|end
suffix:semicolon
id|init_MUTEX
c_func
(paren
op_amp
id|video-&gt;sem
)paren
suffix:semicolon
id|INIT_LIST_HEAD
c_func
(paren
op_amp
id|video-&gt;video_device_list
)paren
suffix:semicolon
id|acpi_video_bus_get_devices
c_func
(paren
id|video
comma
id|device
)paren
suffix:semicolon
id|acpi_video_bus_start_devices
c_func
(paren
id|video
)paren
suffix:semicolon
id|status
op_assign
id|acpi_install_notify_handler
c_func
(paren
id|video-&gt;handle
comma
id|ACPI_DEVICE_NOTIFY
comma
id|acpi_video_bus_notify
comma
id|video
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACPI_FAILURE
c_func
(paren
id|status
)paren
)paren
(brace
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_ERROR
comma
l_string|&quot;Error installing notify handler&bslash;n&quot;
)paren
)paren
suffix:semicolon
id|result
op_assign
op_minus
id|ENODEV
suffix:semicolon
r_goto
id|end
suffix:semicolon
)brace
id|printk
c_func
(paren
id|KERN_INFO
id|PREFIX
l_string|&quot;%s [%s] (multi-head: %s  rom: %s  post: %s)&bslash;n&quot;
comma
id|ACPI_VIDEO_DEVICE_NAME
comma
id|acpi_device_bid
c_func
(paren
id|device
)paren
comma
id|video-&gt;flags.multihead
ques
c_cond
l_string|&quot;yes&quot;
suffix:colon
l_string|&quot;no&quot;
comma
id|video-&gt;flags.rom
ques
c_cond
l_string|&quot;yes&quot;
suffix:colon
l_string|&quot;no&quot;
comma
id|video-&gt;flags.post
ques
c_cond
l_string|&quot;yes&quot;
suffix:colon
l_string|&quot;no&quot;
)paren
suffix:semicolon
id|end
suffix:colon
r_if
c_cond
(paren
id|result
)paren
(brace
id|acpi_video_bus_remove_fs
c_func
(paren
id|device
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|video
)paren
suffix:semicolon
)brace
id|return_VALUE
c_func
(paren
id|result
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|acpi_video_bus_remove
id|acpi_video_bus_remove
(paren
r_struct
id|acpi_device
op_star
id|device
comma
r_int
id|type
)paren
(brace
id|acpi_status
id|status
op_assign
l_int|0
suffix:semicolon
r_struct
id|acpi_video_bus
op_star
id|video
op_assign
l_int|NULL
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_bus_remove&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|device
op_logical_or
op_logical_neg
id|acpi_driver_data
c_func
(paren
id|device
)paren
)paren
id|return_VALUE
c_func
(paren
op_minus
id|EINVAL
)paren
suffix:semicolon
id|video
op_assign
(paren
r_struct
id|acpi_video_bus
op_star
)paren
id|acpi_driver_data
c_func
(paren
id|device
)paren
suffix:semicolon
id|acpi_video_bus_stop_devices
c_func
(paren
id|video
)paren
suffix:semicolon
id|status
op_assign
id|acpi_remove_notify_handler
c_func
(paren
id|video-&gt;handle
comma
id|ACPI_DEVICE_NOTIFY
comma
id|acpi_video_bus_notify
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACPI_FAILURE
c_func
(paren
id|status
)paren
)paren
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_ERROR
comma
l_string|&quot;Error removing notify handler&bslash;n&quot;
)paren
)paren
suffix:semicolon
id|acpi_video_bus_put_devices
c_func
(paren
id|video
)paren
suffix:semicolon
id|acpi_video_bus_remove_fs
c_func
(paren
id|device
)paren
suffix:semicolon
r_if
c_cond
(paren
id|video-&gt;attached_array
)paren
id|kfree
c_func
(paren
id|video-&gt;attached_array
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|video
)paren
suffix:semicolon
id|return_VALUE
c_func
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|acpi_video_bus_match
id|acpi_video_bus_match
(paren
r_struct
id|acpi_device
op_star
id|device
comma
r_struct
id|acpi_driver
op_star
id|driver
)paren
(brace
id|acpi_handle
id|h_dummy1
suffix:semicolon
id|acpi_handle
id|h_dummy2
suffix:semicolon
id|acpi_handle
id|h_dummy3
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_bus_match&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|device
op_logical_or
op_logical_neg
id|driver
)paren
id|return_VALUE
c_func
(paren
op_minus
id|EINVAL
)paren
suffix:semicolon
multiline_comment|/* Since there is no HID, CID for ACPI Video drivers, we have&n;&t; * to check well known required nodes for each feature we support.&n;&t; */
multiline_comment|/* Does this device able to support video switching ? */
r_if
c_cond
(paren
id|ACPI_SUCCESS
c_func
(paren
id|acpi_get_handle
c_func
(paren
id|device-&gt;handle
comma
l_string|&quot;_DOD&quot;
comma
op_amp
id|h_dummy1
)paren
)paren
op_logical_and
id|ACPI_SUCCESS
c_func
(paren
id|acpi_get_handle
c_func
(paren
id|device-&gt;handle
comma
l_string|&quot;_DOS&quot;
comma
op_amp
id|h_dummy2
)paren
)paren
)paren
id|return_VALUE
c_func
(paren
l_int|0
)paren
suffix:semicolon
multiline_comment|/* Does this device able to retrieve a video ROM ? */
r_if
c_cond
(paren
id|ACPI_SUCCESS
c_func
(paren
id|acpi_get_handle
c_func
(paren
id|device-&gt;handle
comma
l_string|&quot;_ROM&quot;
comma
op_amp
id|h_dummy1
)paren
)paren
)paren
id|return_VALUE
c_func
(paren
l_int|0
)paren
suffix:semicolon
multiline_comment|/* Does this device able to configure which video head to be POSTed ? */
r_if
c_cond
(paren
id|ACPI_SUCCESS
c_func
(paren
id|acpi_get_handle
c_func
(paren
id|device-&gt;handle
comma
l_string|&quot;_VPO&quot;
comma
op_amp
id|h_dummy1
)paren
)paren
op_logical_and
id|ACPI_SUCCESS
c_func
(paren
id|acpi_get_handle
c_func
(paren
id|device-&gt;handle
comma
l_string|&quot;_GPD&quot;
comma
op_amp
id|h_dummy2
)paren
)paren
op_logical_and
id|ACPI_SUCCESS
c_func
(paren
id|acpi_get_handle
c_func
(paren
id|device-&gt;handle
comma
l_string|&quot;_SPD&quot;
comma
op_amp
id|h_dummy3
)paren
)paren
)paren
id|return_VALUE
c_func
(paren
l_int|0
)paren
suffix:semicolon
id|return_VALUE
c_func
(paren
op_minus
id|ENODEV
)paren
suffix:semicolon
)brace
r_static
r_int
id|__init
DECL|function|acpi_video_init
id|acpi_video_init
(paren
r_void
)paren
(brace
r_int
id|result
op_assign
l_int|0
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_init&quot;
)paren
suffix:semicolon
multiline_comment|/*&n;&t;acpi_dbg_level = 0xFFFFFFFF;&n;&t;acpi_dbg_layer = 0x08000000;&n;&t;*/
id|acpi_video_dir
op_assign
id|proc_mkdir
c_func
(paren
id|ACPI_VIDEO_CLASS
comma
id|acpi_root_dir
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|acpi_video_dir
)paren
id|return_VALUE
c_func
(paren
op_minus
id|ENODEV
)paren
suffix:semicolon
id|acpi_video_dir-&gt;owner
op_assign
id|THIS_MODULE
suffix:semicolon
id|result
op_assign
id|acpi_bus_register_driver
c_func
(paren
op_amp
id|acpi_video_bus
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
OL
l_int|0
)paren
(brace
id|remove_proc_entry
c_func
(paren
id|ACPI_VIDEO_CLASS
comma
id|acpi_root_dir
)paren
suffix:semicolon
id|return_VALUE
c_func
(paren
op_minus
id|ENODEV
)paren
suffix:semicolon
)brace
id|return_VALUE
c_func
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_static
r_void
id|__exit
DECL|function|acpi_video_exit
id|acpi_video_exit
(paren
r_void
)paren
(brace
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_video_exit&quot;
)paren
suffix:semicolon
id|acpi_bus_unregister_driver
c_func
(paren
op_amp
id|acpi_video_bus
)paren
suffix:semicolon
id|remove_proc_entry
c_func
(paren
id|ACPI_VIDEO_CLASS
comma
id|acpi_root_dir
)paren
suffix:semicolon
id|return_VOID
suffix:semicolon
)brace
DECL|variable|acpi_video_init
id|module_init
c_func
(paren
id|acpi_video_init
)paren
suffix:semicolon
DECL|variable|acpi_video_exit
id|module_exit
c_func
(paren
id|acpi_video_exit
)paren
suffix:semicolon
eof
