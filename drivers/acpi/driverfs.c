multiline_comment|/*&n; * driverfs.c - ACPI bindings for driverfs.&n; *&n; * Copyright (c) 2002 Patrick Mochel&n; * Copyright (c) 2002 The Open Source Development Lab&n; *&n; */
macro_line|#include &lt;linux/stat.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/driverfs_fs.h&gt;
macro_line|#include &quot;acpi_bus.h&quot;
DECL|variable|acpi_dir
r_static
r_struct
id|driver_dir_entry
id|acpi_dir
op_assign
(brace
dot
id|name
op_assign
l_string|&quot;acpi&quot;
comma
dot
id|mode
op_assign
(paren
id|S_IRWXU
op_or
id|S_IRUGO
op_or
id|S_IXUGO
)paren
comma
)brace
suffix:semicolon
multiline_comment|/* driverfs ops for ACPI attribute files go here, when/if&n; * there are ACPI attribute files. &n; * For now, we just have directory creation and removal.&n; */
DECL|function|acpi_remove_dir
r_void
id|acpi_remove_dir
c_func
(paren
r_struct
id|acpi_device
op_star
id|dev
)paren
(brace
r_if
c_cond
(paren
id|dev
)paren
id|driverfs_remove_dir
c_func
(paren
op_amp
id|dev-&gt;driverfs_dir
)paren
suffix:semicolon
)brace
DECL|function|acpi_create_dir
r_int
id|acpi_create_dir
c_func
(paren
r_struct
id|acpi_device
op_star
id|dev
)paren
(brace
r_struct
id|driver_dir_entry
op_star
id|parent
suffix:semicolon
id|parent
op_assign
id|dev-&gt;parent
ques
c_cond
op_amp
id|dev-&gt;parent-&gt;driverfs_dir
suffix:colon
op_amp
id|acpi_dir
suffix:semicolon
id|dev-&gt;driverfs_dir.name
op_assign
id|dev-&gt;pnp.bus_id
suffix:semicolon
id|dev-&gt;driverfs_dir.mode
op_assign
(paren
id|S_IFDIR
op_or
id|S_IRWXU
op_or
id|S_IRUGO
op_or
id|S_IXUGO
)paren
suffix:semicolon
r_return
id|driverfs_create_dir
c_func
(paren
op_amp
id|dev-&gt;driverfs_dir
comma
id|parent
)paren
suffix:semicolon
)brace
DECL|function|acpi_driverfs_init
r_static
r_int
id|__init
id|acpi_driverfs_init
c_func
(paren
r_void
)paren
(brace
r_return
id|driverfs_create_dir
c_func
(paren
op_amp
id|acpi_dir
comma
l_int|NULL
)paren
suffix:semicolon
)brace
DECL|variable|acpi_driverfs_init
id|subsys_initcall
c_func
(paren
id|acpi_driverfs_init
)paren
suffix:semicolon
eof
