multiline_comment|/*&n; *  acpi_pci_root.c - ACPI PCI Root Bridge Driver ($Revision: 30 $)&n; *&n; *  Copyright (C) 2001, 2002 Andy Grover &lt;andrew.grover@intel.com&gt;&n; *  Copyright (C) 2001, 2002 Paul Diefenbaugh &lt;paul.s.diefenbaugh@intel.com&gt;&n; *&n; * ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~&n; *&n; *  This program is free software; you can redistribute it and/or modify&n; *  it under the terms of the GNU General Public License as published by&n; *  the Free Software Foundation; either version 2 of the License, or (at&n; *  your option) any later version.&n; *&n; *  This program is distributed in the hope that it will be useful, but&n; *  WITHOUT ANY WARRANTY; without even the implied warranty of&n; *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU&n; *  General Public License for more details.&n; *&n; *  You should have received a copy of the GNU General Public License along&n; *  with this program; if not, write to the Free Software Foundation, Inc.,&n; *  59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.&n; *&n; * ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~&n; */
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/types.h&gt;
macro_line|#include &lt;linux/proc_fs.h&gt;
macro_line|#include &lt;linux/spinlock.h&gt;
macro_line|#include &lt;linux/pm.h&gt;
macro_line|#include &lt;linux/pci.h&gt;
macro_line|#include &lt;linux/acpi.h&gt;
macro_line|#include &quot;acpi_bus.h&quot;
macro_line|#include &quot;acpi_drivers.h&quot;
DECL|macro|_COMPONENT
mdefine_line|#define _COMPONENT&t;&t;ACPI_PCI_ROOT_COMPONENT
id|ACPI_MODULE_NAME
(paren
l_string|&quot;pci_root&quot;
)paren
id|MODULE_AUTHOR
c_func
(paren
l_string|&quot;Paul Diefenbaugh&quot;
)paren
suffix:semicolon
DECL|variable|ACPI_PCI_ROOT_DRIVER_NAME
id|MODULE_DESCRIPTION
c_func
(paren
id|ACPI_PCI_ROOT_DRIVER_NAME
)paren
suffix:semicolon
r_extern
r_struct
id|pci_ops
op_star
id|pci_root_ops
suffix:semicolon
DECL|macro|PREFIX
mdefine_line|#define PREFIX&t;&t;&t;&quot;ACPI: &quot;
r_static
r_int
id|acpi_pci_root_add
(paren
r_struct
id|acpi_device
op_star
id|device
)paren
suffix:semicolon
r_static
r_int
id|acpi_pci_root_remove
(paren
r_struct
id|acpi_device
op_star
id|device
comma
r_int
id|type
)paren
suffix:semicolon
r_static
r_int
id|acpi_pci_root_bind
(paren
r_struct
id|acpi_device
op_star
id|device
)paren
suffix:semicolon
DECL|variable|acpi_pci_root_driver
r_static
r_struct
id|acpi_driver
id|acpi_pci_root_driver
op_assign
(brace
id|name
suffix:colon
id|ACPI_PCI_ROOT_DRIVER_NAME
comma
r_class
suffix:colon
id|ACPI_PCI_ROOT_CLASS
comma
id|ids
suffix:colon
id|ACPI_PCI_ROOT_HID
comma
id|ops
suffix:colon
(brace
id|add
suffix:colon
id|acpi_pci_root_add
comma
id|remove
suffix:colon
id|acpi_pci_root_remove
comma
id|bind
suffix:colon
id|acpi_pci_root_bind
comma
)brace
comma
)brace
suffix:semicolon
DECL|struct|acpi_pci_data
r_struct
id|acpi_pci_data
(brace
DECL|member|id
id|acpi_pci_id
id|id
suffix:semicolon
DECL|member|dev
r_struct
id|pci_dev
op_star
id|dev
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|acpi_pci_root
r_struct
id|acpi_pci_root
(brace
DECL|member|handle
id|acpi_handle
id|handle
suffix:semicolon
DECL|member|data
r_struct
id|acpi_pci_data
id|data
suffix:semicolon
)brace
suffix:semicolon
DECL|variable|acpi_prts
r_struct
id|acpi_prt_list
id|acpi_prts
suffix:semicolon
multiline_comment|/* --------------------------------------------------------------------------&n;                        PCI Routing Table (PRT) Support&n;   -------------------------------------------------------------------------- */
r_static
r_int
DECL|function|acpi_prt_find_entry
id|acpi_prt_find_entry
(paren
id|acpi_pci_id
op_star
id|id
comma
id|u8
id|pin
comma
r_struct
id|acpi_prt_entry
op_star
op_star
id|entry
)paren
(brace
r_struct
id|list_head
op_star
id|node
op_assign
l_int|NULL
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_prt_find_entry&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|id
op_logical_or
op_logical_neg
id|entry
)paren
id|return_VALUE
c_func
(paren
op_minus
id|ENODEV
)paren
suffix:semicolon
multiline_comment|/* TBD: Locking */
id|list_for_each
c_func
(paren
id|node
comma
op_amp
id|acpi_prts.entries
)paren
(brace
(paren
op_star
id|entry
)paren
op_assign
id|list_entry
c_func
(paren
id|node
comma
r_struct
id|acpi_prt_entry
comma
id|node
)paren
suffix:semicolon
multiline_comment|/* TBD: Include check for segment when supported by pci_dev */
r_if
c_cond
(paren
(paren
id|id-&gt;bus
op_eq
(paren
op_star
id|entry
)paren
op_member_access_from_pointer
id|id.bus
)paren
op_logical_and
(paren
id|id-&gt;device
op_eq
(paren
op_star
id|entry
)paren
op_member_access_from_pointer
id|id.dev
)paren
op_logical_and
(paren
id|pin
op_eq
(paren
op_star
id|entry
)paren
op_member_access_from_pointer
id|id.pin
)paren
)paren
(brace
id|return_VALUE
c_func
(paren
l_int|0
)paren
suffix:semicolon
)brace
)brace
(paren
op_star
id|entry
)paren
op_assign
l_int|NULL
suffix:semicolon
id|return_VALUE
c_func
(paren
op_minus
id|ENODEV
)paren
suffix:semicolon
)brace
r_int
DECL|function|acpi_prt_get_irq
id|acpi_prt_get_irq
(paren
r_struct
id|pci_dev
op_star
id|dev
comma
id|u8
id|pin
comma
r_int
op_star
id|irq
)paren
(brace
r_int
id|result
op_assign
l_int|0
suffix:semicolon
r_struct
id|acpi_prt_entry
op_star
id|entry
op_assign
l_int|NULL
suffix:semicolon
id|acpi_pci_id
id|id
op_assign
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_prt_get_irq&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dev
op_logical_or
op_logical_neg
id|irq
)paren
id|return_VALUE
c_func
(paren
op_minus
id|ENODEV
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dev-&gt;bus
)paren
(brace
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_ERROR
comma
l_string|&quot;Device has invalid &squot;bus&squot; field&bslash;n&quot;
)paren
)paren
suffix:semicolon
id|return_VALUE
c_func
(paren
op_minus
id|EFAULT
)paren
suffix:semicolon
)brace
id|id.segment
op_assign
l_int|0
suffix:semicolon
id|id.bus
op_assign
id|dev-&gt;bus-&gt;number
suffix:semicolon
id|id.device
op_assign
id|PCI_SLOT
c_func
(paren
id|dev-&gt;devfn
)paren
suffix:semicolon
id|id.function
op_assign
id|PCI_FUNC
c_func
(paren
id|dev-&gt;devfn
)paren
suffix:semicolon
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_INFO
comma
l_string|&quot;Resolving IRQ for %02x:%02x:%02x.%02x[%c]&bslash;n&quot;
comma
id|id.segment
comma
id|id.bus
comma
id|id.device
comma
id|id.function
comma
(paren
l_char|&squot;A&squot;
op_plus
id|pin
)paren
)paren
)paren
suffix:semicolon
id|result
op_assign
id|acpi_prt_find_entry
c_func
(paren
op_amp
id|id
comma
id|pin
comma
op_amp
id|entry
)paren
suffix:semicolon
r_if
c_cond
(paren
l_int|0
op_ne
id|result
)paren
id|return_VALUE
c_func
(paren
id|result
)paren
suffix:semicolon
multiline_comment|/* Type 1: Dynamic (e.g. PCI Link Device) */
r_if
c_cond
(paren
id|entry-&gt;source.handle
)paren
id|result
op_assign
id|acpi_pci_link_get_irq
c_func
(paren
id|entry
comma
id|irq
)paren
suffix:semicolon
multiline_comment|/* Type 2: Static (e.g. I/O [S]APIC Direct) */
r_else
(brace
r_if
c_cond
(paren
id|entry-&gt;source.index
)paren
op_star
id|irq
op_assign
id|entry-&gt;source.index
suffix:semicolon
r_else
id|result
op_assign
op_minus
id|ENODEV
suffix:semicolon
)brace
r_if
c_cond
(paren
l_int|0
op_eq
id|result
)paren
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_INFO
comma
l_string|&quot;Found IRQ %d&bslash;n&quot;
comma
op_star
id|irq
)paren
)paren
suffix:semicolon
r_else
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_ERROR
comma
l_string|&quot;Unable to reslove IRQ&bslash;n&quot;
)paren
)paren
suffix:semicolon
id|return_VALUE
c_func
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_int
DECL|function|acpi_prt_set_irq
id|acpi_prt_set_irq
(paren
r_struct
id|pci_dev
op_star
id|dev
comma
id|u8
id|pin
comma
r_int
id|irq
)paren
(brace
r_int
id|result
op_assign
l_int|0
suffix:semicolon
r_struct
id|acpi_prt_entry
op_star
id|entry
op_assign
l_int|NULL
suffix:semicolon
id|acpi_pci_id
id|id
op_assign
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_pci_set_irq&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dev
op_logical_or
op_logical_neg
id|irq
)paren
id|return_VALUE
c_func
(paren
op_minus
id|EINVAL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dev-&gt;bus
)paren
(brace
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_ERROR
comma
l_string|&quot;Device has invalid &squot;bus&squot; field&bslash;n&quot;
)paren
)paren
suffix:semicolon
id|return_VALUE
c_func
(paren
op_minus
id|EFAULT
)paren
suffix:semicolon
)brace
id|id.segment
op_assign
l_int|0
suffix:semicolon
id|id.bus
op_assign
id|dev-&gt;bus-&gt;number
suffix:semicolon
id|id.device
op_assign
id|PCI_SLOT
c_func
(paren
id|dev-&gt;devfn
)paren
suffix:semicolon
id|id.function
op_assign
id|PCI_FUNC
c_func
(paren
id|dev-&gt;devfn
)paren
suffix:semicolon
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_INFO
comma
l_string|&quot;Setting %02x:%02x:%02x.%02x[%c] to IRQ%d&bslash;n&quot;
comma
id|id.segment
comma
id|id.bus
comma
id|id.device
comma
id|id.function
comma
(paren
l_char|&squot;A&squot;
op_plus
id|pin
)paren
comma
id|irq
)paren
)paren
suffix:semicolon
id|result
op_assign
id|acpi_prt_find_entry
c_func
(paren
op_amp
id|id
comma
id|pin
comma
op_amp
id|entry
)paren
suffix:semicolon
r_if
c_cond
(paren
l_int|0
op_ne
id|result
)paren
id|return_VALUE
c_func
(paren
id|result
)paren
suffix:semicolon
multiline_comment|/* Type 1: Dynamic (e.g. PCI Link Device) */
r_if
c_cond
(paren
id|entry-&gt;source.handle
)paren
id|result
op_assign
id|acpi_pci_link_set_irq
c_func
(paren
id|entry
comma
id|irq
)paren
suffix:semicolon
multiline_comment|/* Type 2: Static (e.g. I/O [S]APIC Direct) */
r_else
id|result
op_assign
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
l_int|0
op_eq
id|result
)paren
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_INFO
comma
l_string|&quot;IRQ set&bslash;n&quot;
)paren
)paren
suffix:semicolon
r_else
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_ERROR
comma
l_string|&quot;Unable to set IRQ&bslash;n&quot;
)paren
)paren
suffix:semicolon
id|return_VALUE
c_func
(paren
id|result
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|acpi_prt_add_entry
id|acpi_prt_add_entry
(paren
id|acpi_handle
id|handle
comma
id|u8
id|seg
comma
id|u8
id|bus
comma
id|acpi_pci_routing_table
op_star
id|prt
)paren
(brace
r_struct
id|acpi_prt_entry
op_star
id|entry
op_assign
l_int|NULL
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_prt_add_entry&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|prt
)paren
id|return_VALUE
c_func
(paren
op_minus
id|EINVAL
)paren
suffix:semicolon
id|entry
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|acpi_prt_entry
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|entry
)paren
id|return_VALUE
c_func
(paren
op_minus
id|ENOMEM
)paren
suffix:semicolon
id|memset
c_func
(paren
id|entry
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|acpi_prt_entry
)paren
)paren
suffix:semicolon
id|entry-&gt;id.seg
op_assign
id|seg
suffix:semicolon
id|entry-&gt;id.bus
op_assign
id|bus
suffix:semicolon
id|entry-&gt;id.dev
op_assign
id|prt-&gt;address
op_rshift
l_int|16
suffix:semicolon
id|entry-&gt;id.pin
op_assign
id|prt-&gt;pin
suffix:semicolon
multiline_comment|/*&n;&t; * Type 1: Dynamic&n;&t; * ---------------&n;&t; * The &squot;source&squot; field specifies the PCI interrupt link device used to&n;&t; * configure the IRQ assigned to this slot|dev|pin.  The &squot;source_index&squot;&n;&t; * indicates which resource descriptor in the resource template (of&n;&t; * the link device) this interrupt is allocated from.&n;&t; */
r_if
c_cond
(paren
id|prt-&gt;source
)paren
id|acpi_get_handle
c_func
(paren
id|handle
comma
id|prt-&gt;source
comma
op_amp
id|entry-&gt;source.handle
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * Type 2: Static&n;&t; * --------------&n;&t; * The &squot;source&squot; field is NULL, and the &squot;source_index&squot; field specifies&n;&t; * the IRQ value, which is hardwired to specific interrupt inputs on&n;&t; * the interrupt controller.&n;&t; */
r_else
id|entry-&gt;source.handle
op_assign
l_int|NULL
suffix:semicolon
id|entry-&gt;source.index
op_assign
id|prt-&gt;source_index
suffix:semicolon
multiline_comment|/* &n;&t; * NOTE: Don&squot;t query the Link Device for IRQ information at this time&n;&t; *       because Link Device enumeration may not have occurred yet&n;&t; *       (e.g. exists somewhere &squot;below&squot; this _PRT entry in the ACPI&n;&t; *       namespace).&n;&t; */
id|ACPI_DEBUG_PRINT_RAW
c_func
(paren
(paren
id|ACPI_DB_OK
comma
l_string|&quot;      %02X:%02X:%02X[%c] -&gt; %s[%d]&bslash;n&quot;
comma
id|entry-&gt;id.seg
comma
id|entry-&gt;id.bus
comma
id|entry-&gt;id.dev
comma
(paren
l_char|&squot;A&squot;
op_plus
id|entry-&gt;id.pin
)paren
comma
id|prt-&gt;source
comma
id|entry-&gt;source.index
)paren
)paren
suffix:semicolon
multiline_comment|/* TBD: Acquire/release lock */
id|list_add_tail
c_func
(paren
op_amp
id|entry-&gt;node
comma
op_amp
id|acpi_prts.entries
)paren
suffix:semicolon
id|acpi_prts.count
op_increment
suffix:semicolon
id|return_VALUE
c_func
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|acpi_prt_parse
id|acpi_prt_parse
(paren
id|acpi_handle
id|handle
comma
id|u8
id|seg
comma
id|u8
id|bus
)paren
(brace
id|acpi_status
id|status
op_assign
id|AE_OK
suffix:semicolon
r_char
id|pathname
(braket
id|PATHNAME_MAX
)braket
op_assign
(brace
l_int|0
)brace
suffix:semicolon
id|acpi_buffer
id|buffer
op_assign
(brace
l_int|0
comma
l_int|NULL
)brace
suffix:semicolon
id|acpi_pci_routing_table
op_star
id|prt
op_assign
l_int|NULL
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_prt_parse&quot;
)paren
suffix:semicolon
id|buffer.length
op_assign
r_sizeof
(paren
id|pathname
)paren
suffix:semicolon
id|buffer.pointer
op_assign
id|pathname
suffix:semicolon
id|acpi_get_name
c_func
(paren
id|handle
comma
id|ACPI_FULL_PATHNAME
comma
op_amp
id|buffer
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
id|PREFIX
l_string|&quot;%s [%s._PRT]&bslash;n&quot;
comma
id|ACPI_PCI_PRT_DEVICE_NAME
comma
id|pathname
)paren
suffix:semicolon
multiline_comment|/* &n;&t; * Evaluate this _PRT and add all entries to our global list.&n;&t; */
id|buffer.length
op_assign
l_int|0
suffix:semicolon
id|buffer.pointer
op_assign
l_int|NULL
suffix:semicolon
id|status
op_assign
id|acpi_get_irq_routing_table
c_func
(paren
id|handle
comma
op_amp
id|buffer
)paren
suffix:semicolon
r_if
c_cond
(paren
id|status
op_ne
id|AE_BUFFER_OVERFLOW
)paren
(brace
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_ERROR
comma
l_string|&quot;Error evaluating _PRT [%s]&bslash;n&quot;
comma
id|acpi_format_exception
c_func
(paren
id|status
)paren
)paren
)paren
suffix:semicolon
id|return_VALUE
c_func
(paren
op_minus
id|ENODEV
)paren
suffix:semicolon
)brace
id|prt
op_assign
id|kmalloc
c_func
(paren
id|buffer.length
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|prt
)paren
id|return_VALUE
c_func
(paren
op_minus
id|ENOMEM
)paren
suffix:semicolon
id|memset
c_func
(paren
id|prt
comma
l_int|0
comma
id|buffer.length
)paren
suffix:semicolon
id|buffer.pointer
op_assign
id|prt
suffix:semicolon
id|status
op_assign
id|acpi_get_irq_routing_table
c_func
(paren
id|handle
comma
op_amp
id|buffer
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACPI_FAILURE
c_func
(paren
id|status
)paren
)paren
(brace
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_ERROR
comma
l_string|&quot;Error evaluating _PRT [%s]&bslash;n&quot;
comma
id|acpi_format_exception
c_func
(paren
id|status
)paren
)paren
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|buffer.pointer
)paren
suffix:semicolon
id|return_VALUE
c_func
(paren
op_minus
id|ENODEV
)paren
suffix:semicolon
)brace
r_while
c_loop
(paren
id|prt
op_logical_and
(paren
id|prt-&gt;length
OG
l_int|0
)paren
)paren
(brace
id|acpi_prt_add_entry
c_func
(paren
id|handle
comma
id|seg
comma
id|bus
comma
id|prt
)paren
suffix:semicolon
id|prt
op_assign
(paren
id|acpi_pci_routing_table
op_star
)paren
(paren
(paren
r_int
r_int
)paren
id|prt
op_plus
id|prt-&gt;length
)paren
suffix:semicolon
)brace
id|return_VALUE
c_func
(paren
l_int|0
)paren
suffix:semicolon
)brace
multiline_comment|/* --------------------------------------------------------------------------&n;                             PCI Device Binding&n;   -------------------------------------------------------------------------- */
r_static
r_void
DECL|function|acpi_pci_data_handler
id|acpi_pci_data_handler
(paren
id|acpi_handle
id|handle
comma
id|u32
id|function
comma
r_void
op_star
id|context
)paren
(brace
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_pci_data_handler&quot;
)paren
suffix:semicolon
multiline_comment|/* TBD: Anything we need to do here? */
id|return_VOID
suffix:semicolon
)brace
multiline_comment|/**&n; * acpi_os_get_pci_id&n; * ------------------&n; * This function gets used by the ACPI Interpreter (a.k.a. Core Subsystem)&n; * to resolve PCI information for ACPI-PCI devices defined in the namespace.&n; */
id|acpi_status
DECL|function|acpi_os_get_pci_id
id|acpi_os_get_pci_id
(paren
id|acpi_handle
id|handle
comma
id|acpi_pci_id
op_star
id|id
)paren
(brace
r_int
id|result
op_assign
l_int|0
suffix:semicolon
id|acpi_status
id|status
op_assign
id|AE_OK
suffix:semicolon
r_struct
id|acpi_device
op_star
id|device
op_assign
l_int|NULL
suffix:semicolon
r_struct
id|acpi_pci_data
op_star
id|data
op_assign
l_int|NULL
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_os_get_pci_id&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|id
)paren
id|return_ACPI_STATUS
c_func
(paren
id|AE_BAD_PARAMETER
)paren
suffix:semicolon
id|result
op_assign
id|acpi_bus_get_device
c_func
(paren
id|handle
comma
op_amp
id|device
)paren
suffix:semicolon
r_if
c_cond
(paren
l_int|0
op_ne
id|result
)paren
(brace
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_ERROR
comma
l_string|&quot;Invalid ACPI Bus context for device %s&bslash;n&quot;
comma
id|acpi_device_bid
c_func
(paren
id|device
)paren
)paren
)paren
suffix:semicolon
id|return_ACPI_STATUS
c_func
(paren
id|AE_NOT_EXIST
)paren
suffix:semicolon
)brace
id|status
op_assign
id|acpi_get_data
c_func
(paren
id|handle
comma
id|acpi_pci_data_handler
comma
(paren
r_void
op_star
op_star
)paren
op_amp
id|data
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACPI_FAILURE
c_func
(paren
id|status
)paren
op_logical_or
op_logical_neg
id|data
op_logical_or
op_logical_neg
id|data-&gt;dev
)paren
(brace
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_ERROR
comma
l_string|&quot;Invalid ACPI-PCI context for device %s&bslash;n&quot;
comma
id|acpi_device_bid
c_func
(paren
id|device
)paren
)paren
)paren
suffix:semicolon
id|return_ACPI_STATUS
c_func
(paren
id|status
)paren
suffix:semicolon
)brace
id|id-&gt;segment
op_assign
id|data-&gt;id.segment
suffix:semicolon
id|id-&gt;bus
op_assign
id|data-&gt;id.bus
suffix:semicolon
id|id-&gt;device
op_assign
id|data-&gt;id.device
suffix:semicolon
id|id-&gt;function
op_assign
id|data-&gt;id.function
suffix:semicolon
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_INFO
comma
l_string|&quot;Device %s has PCI address %02x:%02x:%02x.%02x&bslash;n&quot;
comma
id|acpi_device_bid
c_func
(paren
id|device
)paren
comma
id|id-&gt;segment
comma
id|id-&gt;bus
comma
id|id-&gt;device
comma
id|id-&gt;function
)paren
)paren
suffix:semicolon
id|return_ACPI_STATUS
c_func
(paren
id|AE_OK
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|acpi_pci_root_bind
id|acpi_pci_root_bind
(paren
r_struct
id|acpi_device
op_star
id|device
)paren
(brace
r_int
id|result
op_assign
l_int|0
suffix:semicolon
id|acpi_status
id|status
op_assign
id|AE_OK
suffix:semicolon
r_struct
id|acpi_pci_data
op_star
id|data
op_assign
l_int|NULL
suffix:semicolon
r_struct
id|acpi_pci_data
op_star
id|parent_data
op_assign
l_int|NULL
suffix:semicolon
id|acpi_handle
id|handle
op_assign
l_int|NULL
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_pci_root_bind&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|device
op_logical_or
op_logical_neg
id|device-&gt;parent
)paren
id|return_VALUE
c_func
(paren
op_minus
id|EINVAL
)paren
suffix:semicolon
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_INFO
comma
l_string|&quot;Attempting to bind PCI device %s.%s&bslash;n&quot;
comma
id|acpi_device_bid
c_func
(paren
id|device-&gt;parent
)paren
comma
id|acpi_device_bid
c_func
(paren
id|device
)paren
)paren
)paren
suffix:semicolon
id|data
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|acpi_pci_data
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|data
)paren
id|return_VALUE
c_func
(paren
op_minus
id|ENOMEM
)paren
suffix:semicolon
id|memset
c_func
(paren
id|data
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|acpi_pci_data
)paren
)paren
suffix:semicolon
multiline_comment|/* &n;&t; * Segment &amp; Bus&n;&t; * -------------&n;&t; * These are obtained via the parent device&squot;s ACPI-PCI context..&n;&t; * Note that PCI root bridge devices don&squot;t have a &squot;dev-&gt;subordinate&squot;.&n;&t; */
id|status
op_assign
id|acpi_get_data
c_func
(paren
id|device-&gt;parent-&gt;handle
comma
id|acpi_pci_data_handler
comma
(paren
r_void
op_star
op_star
)paren
op_amp
id|parent_data
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACPI_FAILURE
c_func
(paren
id|status
)paren
op_logical_or
op_logical_neg
id|parent_data
op_logical_or
op_logical_neg
id|parent_data-&gt;dev
)paren
(brace
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_ERROR
comma
l_string|&quot;Invalid ACPI-PCI context for parent device %s&bslash;n&quot;
comma
id|acpi_device_bid
c_func
(paren
id|device-&gt;parent
)paren
)paren
)paren
suffix:semicolon
id|result
op_assign
op_minus
id|ENODEV
suffix:semicolon
r_goto
id|end
suffix:semicolon
)brace
id|data-&gt;id.segment
op_assign
id|parent_data-&gt;id.segment
suffix:semicolon
r_if
c_cond
(paren
id|parent_data-&gt;dev-&gt;subordinate
)paren
multiline_comment|/* e.g. PCI-PCI bridge */
id|data-&gt;id.bus
op_assign
id|parent_data-&gt;dev-&gt;subordinate-&gt;number
suffix:semicolon
r_else
r_if
c_cond
(paren
id|parent_data-&gt;dev-&gt;bus
)paren
multiline_comment|/* PCI root bridge */
id|data-&gt;id.bus
op_assign
id|parent_data-&gt;dev-&gt;bus-&gt;number
suffix:semicolon
r_else
(brace
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_ERROR
comma
l_string|&quot;Parent device %s is not a PCI bridge&bslash;n&quot;
comma
id|acpi_device_bid
c_func
(paren
id|device-&gt;parent
)paren
)paren
)paren
suffix:semicolon
id|result
op_assign
op_minus
id|ENODEV
suffix:semicolon
r_goto
id|end
suffix:semicolon
)brace
multiline_comment|/*&n;&t; * Device &amp; Function&n;&t; * -----------------&n;&t; * These are simply obtained from the device&squot;s _ADR method.  Note&n;&t; * that a value of zero is valid.&n;&t; */
id|data-&gt;id.device
op_assign
id|device-&gt;pnp.bus_address
op_rshift
l_int|16
suffix:semicolon
id|data-&gt;id.function
op_assign
id|device-&gt;pnp.bus_address
op_amp
l_int|0xFFFF
suffix:semicolon
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_INFO
comma
l_string|&quot;Binding device %s.%s to %02x:%02x:%02x.%02x&bslash;n&quot;
comma
id|acpi_device_bid
c_func
(paren
id|device-&gt;parent
)paren
comma
id|acpi_device_bid
c_func
(paren
id|device
)paren
comma
id|data-&gt;id.segment
comma
id|data-&gt;id.bus
comma
id|data-&gt;id.device
comma
id|data-&gt;id.function
)paren
)paren
suffix:semicolon
multiline_comment|/* &n;&t; * Locate PCI Device&n;&t; * -----------------&n;&t; * Locate matching device in PCI namespace.  If it doesn&squot;t exist&n;&t; * this typically means that the device isn&squot;t currently inserted&n;&t; * (e.g. docking station, port replicator, etc.).&n;&t; */
id|data-&gt;dev
op_assign
id|pci_find_slot
c_func
(paren
id|data-&gt;id.bus
comma
id|PCI_DEVFN
c_func
(paren
id|data-&gt;id.device
comma
id|data-&gt;id.function
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|data-&gt;dev
)paren
(brace
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_ERROR
comma
l_string|&quot;Device %02x:%02x:%02x.%02x not present in PCI namespace&bslash;n&quot;
comma
id|data-&gt;id.segment
comma
id|data-&gt;id.bus
comma
id|data-&gt;id.device
comma
id|data-&gt;id.function
)paren
)paren
suffix:semicolon
id|result
op_assign
op_minus
id|ENODEV
suffix:semicolon
r_goto
id|end
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|data-&gt;dev-&gt;bus
)paren
(brace
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_ERROR
comma
l_string|&quot;Device %02x:%02x:%02x.%02x has invalid &squot;bus&squot; field&bslash;n&quot;
comma
id|data-&gt;id.segment
comma
id|data-&gt;id.bus
comma
id|data-&gt;id.device
comma
id|data-&gt;id.function
)paren
)paren
suffix:semicolon
id|result
op_assign
op_minus
id|ENODEV
suffix:semicolon
r_goto
id|end
suffix:semicolon
)brace
multiline_comment|/*&n;&t; * Attach ACPI-PCI Context&n;&t; * -----------------------&n;&t; * Thus binding the ACPI and PCI devices.&n;&t; */
id|status
op_assign
id|acpi_attach_data
c_func
(paren
id|device-&gt;handle
comma
id|acpi_pci_data_handler
comma
id|data
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACPI_FAILURE
c_func
(paren
id|status
)paren
)paren
(brace
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_ERROR
comma
l_string|&quot;Unable to attach ACPI-PCI context to device %s&bslash;n&quot;
comma
id|acpi_device_bid
c_func
(paren
id|device
)paren
)paren
)paren
suffix:semicolon
id|result
op_assign
op_minus
id|ENODEV
suffix:semicolon
r_goto
id|end
suffix:semicolon
)brace
multiline_comment|/*&n;&t; * PCI Bridge?&n;&t; * -----------&n;&t; * If so, install the &squot;bind&squot; function to facilitate callbacks for&n;&t; * all of its children.&n;&t; */
r_if
c_cond
(paren
id|data-&gt;dev-&gt;subordinate
)paren
id|device-&gt;ops.bind
op_assign
id|acpi_pci_root_bind
suffix:semicolon
multiline_comment|/*&n;&t; * PCI Routing Table&n;&t; * -----------------&n;&t; * Evaluate and parse _PRT, if exists.  This code is independent of &n;&t; * PCI bridges (above) to allow parsing of _PRT objects within the&n;&t; * scope of non-bridge devices.  Note that _PRTs within the scope of&n;&t; * a PCI bridge assume the bridge&squot;s subordinate bus number.&n;&t; *&n;&t; * TBD: Can _PRTs exist within the scope of non-bridge PCI devices?&n;&t; */
id|status
op_assign
id|acpi_get_handle
c_func
(paren
id|device-&gt;handle
comma
id|METHOD_NAME__PRT
comma
op_amp
id|handle
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACPI_SUCCESS
c_func
(paren
id|status
)paren
)paren
(brace
r_if
c_cond
(paren
id|data-&gt;dev-&gt;subordinate
)paren
multiline_comment|/* PCI-PCI bridge */
id|acpi_prt_parse
c_func
(paren
id|device-&gt;handle
comma
id|data-&gt;id.segment
comma
id|data-&gt;dev-&gt;subordinate-&gt;number
)paren
suffix:semicolon
r_else
multiline_comment|/* non-bridge PCI device */
id|acpi_prt_parse
c_func
(paren
id|device-&gt;handle
comma
id|data-&gt;id.segment
comma
id|data-&gt;id.bus
)paren
suffix:semicolon
)brace
id|end
suffix:colon
r_if
c_cond
(paren
l_int|0
op_ne
id|result
)paren
id|kfree
c_func
(paren
id|data
)paren
suffix:semicolon
id|return_VALUE
c_func
(paren
id|result
)paren
suffix:semicolon
)brace
multiline_comment|/* --------------------------------------------------------------------------&n;                                Driver Interface&n;   -------------------------------------------------------------------------- */
r_static
r_int
DECL|function|acpi_pci_root_add
id|acpi_pci_root_add
(paren
r_struct
id|acpi_device
op_star
id|device
)paren
(brace
r_int
id|result
op_assign
l_int|0
suffix:semicolon
r_struct
id|acpi_pci_root
op_star
id|root
op_assign
l_int|NULL
suffix:semicolon
id|acpi_status
id|status
op_assign
id|AE_OK
suffix:semicolon
r_int
r_int
id|value
op_assign
l_int|0
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_pci_root_add&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|device
)paren
id|return_VALUE
c_func
(paren
op_minus
id|EINVAL
)paren
suffix:semicolon
id|root
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|acpi_pci_root
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|root
)paren
id|return_VALUE
c_func
(paren
op_minus
id|ENOMEM
)paren
suffix:semicolon
id|memset
c_func
(paren
id|root
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|acpi_pci_root
)paren
)paren
suffix:semicolon
id|root-&gt;handle
op_assign
id|device-&gt;handle
suffix:semicolon
id|sprintf
c_func
(paren
id|acpi_device_name
c_func
(paren
id|device
)paren
comma
l_string|&quot;%s&quot;
comma
id|ACPI_PCI_ROOT_DEVICE_NAME
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|acpi_device_class
c_func
(paren
id|device
)paren
comma
l_string|&quot;%s&quot;
comma
id|ACPI_PCI_ROOT_CLASS
)paren
suffix:semicolon
id|acpi_driver_data
c_func
(paren
id|device
)paren
op_assign
id|root
suffix:semicolon
multiline_comment|/*&n;&t; * TBD: Doesn&squot;t the bus driver automatically set this?&n;&t; */
id|device-&gt;ops.bind
op_assign
id|acpi_pci_root_bind
suffix:semicolon
multiline_comment|/* &n;&t; * Segment&n;&t; * -------&n;&t; * Obtained via _SEG, if exists, otherwise assumed to be zero (0).&n;&t; */
id|status
op_assign
id|acpi_evaluate_integer
c_func
(paren
id|root-&gt;handle
comma
id|METHOD_NAME__SEG
comma
l_int|NULL
comma
op_amp
id|value
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|status
)paren
(brace
r_case
id|AE_OK
suffix:colon
id|root-&gt;data.id.segment
op_assign
(paren
id|u16
)paren
id|value
suffix:semicolon
r_break
suffix:semicolon
r_case
id|AE_NOT_FOUND
suffix:colon
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_INFO
comma
l_string|&quot;Assuming segment 0 (no _SEG)&bslash;n&quot;
)paren
)paren
suffix:semicolon
id|root-&gt;data.id.segment
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_ERROR
comma
l_string|&quot;Error evaluating _SEG&bslash;n&quot;
)paren
)paren
suffix:semicolon
id|result
op_assign
op_minus
id|ENODEV
suffix:semicolon
r_goto
id|end
suffix:semicolon
)brace
multiline_comment|/* &n;&t; * Bus&n;&t; * ---&n;&t; * Obtained via _BBN, if exists, otherwise assumed to be zero (0).&n;&t; */
id|status
op_assign
id|acpi_evaluate_integer
c_func
(paren
id|root-&gt;handle
comma
id|METHOD_NAME__BBN
comma
l_int|NULL
comma
op_amp
id|value
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|status
)paren
(brace
r_case
id|AE_OK
suffix:colon
id|root-&gt;data.id.bus
op_assign
(paren
id|u16
)paren
id|value
suffix:semicolon
r_break
suffix:semicolon
r_case
id|AE_NOT_FOUND
suffix:colon
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_INFO
comma
l_string|&quot;Assuming bus 0 (no _BBN)&bslash;n&quot;
)paren
)paren
suffix:semicolon
id|root-&gt;data.id.bus
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_ERROR
comma
l_string|&quot;Error evaluating _BBN&bslash;n&quot;
)paren
)paren
suffix:semicolon
id|result
op_assign
op_minus
id|ENODEV
suffix:semicolon
r_goto
id|end
suffix:semicolon
)brace
multiline_comment|/*&n;&t; * Device &amp; Function&n;&t; * -----------------&n;&t; * Obtained from _ADR (which has already been evaluated for us).&n;&t; */
id|root-&gt;data.id.device
op_assign
id|device-&gt;pnp.bus_address
op_rshift
l_int|16
suffix:semicolon
id|root-&gt;data.id.function
op_assign
id|device-&gt;pnp.bus_address
op_amp
l_int|0xFFFF
suffix:semicolon
multiline_comment|/*&n;&t; * TBD: Evaluate _CRS to get root bridge resources&n;&t; * TBD: Need PCI interface for enumeration/configuration of roots.&n;&t; */
id|printk
c_func
(paren
id|KERN_INFO
id|PREFIX
l_string|&quot;%s [%s] (%02x:%02x:%02x.%02x)&bslash;n&quot;
comma
id|acpi_device_name
c_func
(paren
id|device
)paren
comma
id|acpi_device_bid
c_func
(paren
id|device
)paren
comma
id|root-&gt;data.id.segment
comma
id|root-&gt;data.id.bus
comma
id|root-&gt;data.id.device
comma
id|root-&gt;data.id.function
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * Scan the Root Bridge&n;&t; * --------------------&n;&t; * Must do this prior to any attempt to bind the root device, as the&n;&t; * PCI namespace does not get created until this call is made (and &n;&t; * thus the root bridge&squot;s pci_dev does not exist).&n;&t; */
id|pci_scan_bus
c_func
(paren
id|root-&gt;data.id.bus
comma
id|pci_root_ops
comma
l_int|NULL
)paren
suffix:semicolon
multiline_comment|/* &n;&t; * Locate PCI Device&n;&t; * -----------------&n;&t; * Locate the matching PCI root bridge device in the PCI namespace.&n;&t; */
id|root-&gt;data.dev
op_assign
id|pci_find_slot
c_func
(paren
id|root-&gt;data.id.bus
comma
id|PCI_DEVFN
c_func
(paren
id|root-&gt;data.id.device
comma
id|root-&gt;data.id.function
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|root-&gt;data.dev
)paren
(brace
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_ERROR
comma
l_string|&quot;Device %02x:%02x:%02x.%02x not present&bslash;n&quot;
comma
id|root-&gt;data.id.segment
comma
id|root-&gt;data.id.bus
comma
id|root-&gt;data.id.device
comma
id|root-&gt;data.id.function
)paren
)paren
suffix:semicolon
id|result
op_assign
op_minus
id|ENODEV
suffix:semicolon
r_goto
id|end
suffix:semicolon
)brace
multiline_comment|/*&n;&t; * Attach ACPI-PCI Context&n;&t; * -----------------------&n;&t; * Thus binding the ACPI and PCI devices.&n;&t; */
id|status
op_assign
id|acpi_attach_data
c_func
(paren
id|root-&gt;handle
comma
id|acpi_pci_data_handler
comma
op_amp
id|root-&gt;data
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACPI_FAILURE
c_func
(paren
id|status
)paren
)paren
(brace
id|ACPI_DEBUG_PRINT
c_func
(paren
(paren
id|ACPI_DB_ERROR
comma
l_string|&quot;Unable to attach ACPI-PCI context to device %s&bslash;n&quot;
comma
id|acpi_device_bid
c_func
(paren
id|device
)paren
)paren
)paren
suffix:semicolon
id|result
op_assign
op_minus
id|ENODEV
suffix:semicolon
r_goto
id|end
suffix:semicolon
)brace
multiline_comment|/*&n;&t; * PCI Routing Table&n;&t; * -----------------&n;&t; * Evaluate and parse _PRT, if exists.  Note that root bridges&n;&t; * must have a _PRT (optional for subordinate bridges).&n;&t; */
id|result
op_assign
id|acpi_prt_parse
c_func
(paren
id|device-&gt;handle
comma
id|root-&gt;data.id.segment
comma
id|root-&gt;data.id.bus
)paren
suffix:semicolon
id|end
suffix:colon
r_if
c_cond
(paren
l_int|0
op_ne
id|result
)paren
id|kfree
c_func
(paren
id|root
)paren
suffix:semicolon
id|return_VALUE
c_func
(paren
id|result
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|acpi_pci_root_remove
id|acpi_pci_root_remove
(paren
r_struct
id|acpi_device
op_star
id|device
comma
r_int
id|type
)paren
(brace
r_struct
id|acpi_pci_root
op_star
id|root
op_assign
l_int|NULL
suffix:semicolon
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_pci_root_remove&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|device
op_logical_or
op_logical_neg
id|acpi_driver_data
c_func
(paren
id|device
)paren
)paren
id|return_VALUE
c_func
(paren
op_minus
id|EINVAL
)paren
suffix:semicolon
id|root
op_assign
(paren
r_struct
id|acpi_pci_root
op_star
)paren
id|acpi_driver_data
c_func
(paren
id|device
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|root
)paren
suffix:semicolon
id|return_VALUE
c_func
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_int
id|__init
DECL|function|acpi_pci_root_init
id|acpi_pci_root_init
(paren
r_void
)paren
(brace
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_pci_root_init&quot;
)paren
suffix:semicolon
id|acpi_prts.count
op_assign
l_int|0
suffix:semicolon
id|INIT_LIST_HEAD
c_func
(paren
op_amp
id|acpi_prts.entries
)paren
suffix:semicolon
r_if
c_cond
(paren
l_int|0
OG
id|acpi_bus_register_driver
c_func
(paren
op_amp
id|acpi_pci_root_driver
)paren
)paren
id|return_VALUE
c_func
(paren
op_minus
id|ENODEV
)paren
suffix:semicolon
id|return_VALUE
c_func
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_void
id|__exit
DECL|function|acpi_pci_root_exit
id|acpi_pci_root_exit
(paren
r_void
)paren
(brace
id|ACPI_FUNCTION_TRACE
c_func
(paren
l_string|&quot;acpi_pci_root_exit&quot;
)paren
suffix:semicolon
id|acpi_bus_unregister_driver
c_func
(paren
op_amp
id|acpi_pci_root_driver
)paren
suffix:semicolon
id|return_VOID
suffix:semicolon
)brace
eof
