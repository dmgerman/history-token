multiline_comment|/*&n; *  ATI Mach64 Hardware Acceleration&n; */
macro_line|#include &lt;linux/delay.h&gt;
macro_line|#include &lt;linux/fb.h&gt;
macro_line|#include &lt;video/fbcon.h&gt;
macro_line|#include &lt;video/fbcon-cfb8.h&gt;
macro_line|#include &lt;video/fbcon-cfb16.h&gt;
macro_line|#include &lt;video/fbcon-cfb24.h&gt;
macro_line|#include &lt;video/fbcon-cfb32.h&gt;
macro_line|#include &quot;mach64.h&quot;
macro_line|#include &quot;atyfb.h&quot;
multiline_comment|/*&n;     *  Text console acceleration&n;     */
r_static
r_void
id|fbcon_aty_bmove
c_func
(paren
r_struct
id|display
op_star
id|p
comma
r_int
id|sy
comma
r_int
id|sx
comma
r_int
id|dy
comma
r_int
id|dx
comma
r_int
id|height
comma
r_int
id|width
)paren
suffix:semicolon
r_static
r_void
id|fbcon_aty_clear
c_func
(paren
r_struct
id|vc_data
op_star
id|conp
comma
r_struct
id|display
op_star
id|p
comma
r_int
id|sy
comma
r_int
id|sx
comma
r_int
id|height
comma
r_int
id|width
)paren
suffix:semicolon
multiline_comment|/*&n;     *  Generic Mach64 routines&n;     */
DECL|function|aty_reset_engine
r_void
id|aty_reset_engine
c_func
(paren
r_const
r_struct
id|fb_info_aty
op_star
id|info
)paren
(brace
multiline_comment|/* reset engine */
id|aty_st_le32
c_func
(paren
id|GEN_TEST_CNTL
comma
id|aty_ld_le32
c_func
(paren
id|GEN_TEST_CNTL
comma
id|info
)paren
op_amp
op_complement
id|GUI_ENGINE_ENABLE
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* enable engine */
id|aty_st_le32
c_func
(paren
id|GEN_TEST_CNTL
comma
id|aty_ld_le32
c_func
(paren
id|GEN_TEST_CNTL
comma
id|info
)paren
op_or
id|GUI_ENGINE_ENABLE
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* ensure engine is not locked up by clearing any FIFO or */
multiline_comment|/* HOST errors */
id|aty_st_le32
c_func
(paren
id|BUS_CNTL
comma
id|aty_ld_le32
c_func
(paren
id|BUS_CNTL
comma
id|info
)paren
op_or
id|BUS_HOST_ERR_ACK
op_or
id|BUS_FIFO_ERR_ACK
comma
id|info
)paren
suffix:semicolon
)brace
DECL|function|reset_GTC_3D_engine
r_static
r_void
id|reset_GTC_3D_engine
c_func
(paren
r_const
r_struct
id|fb_info_aty
op_star
id|info
)paren
(brace
id|aty_st_le32
c_func
(paren
id|SCALE_3D_CNTL
comma
l_int|0xc0
comma
id|info
)paren
suffix:semicolon
id|mdelay
c_func
(paren
id|GTC_3D_RESET_DELAY
)paren
suffix:semicolon
id|aty_st_le32
c_func
(paren
id|SETUP_CNTL
comma
l_int|0x00
comma
id|info
)paren
suffix:semicolon
id|mdelay
c_func
(paren
id|GTC_3D_RESET_DELAY
)paren
suffix:semicolon
id|aty_st_le32
c_func
(paren
id|SCALE_3D_CNTL
comma
l_int|0x00
comma
id|info
)paren
suffix:semicolon
id|mdelay
c_func
(paren
id|GTC_3D_RESET_DELAY
)paren
suffix:semicolon
)brace
DECL|function|aty_init_engine
r_void
id|aty_init_engine
c_func
(paren
r_const
r_struct
id|atyfb_par
op_star
id|par
comma
r_struct
id|fb_info_aty
op_star
id|info
)paren
(brace
id|u32
id|pitch_value
suffix:semicolon
multiline_comment|/* determine modal information from global mode structure */
id|pitch_value
op_assign
id|par-&gt;crtc.vxres
suffix:semicolon
r_if
c_cond
(paren
id|par-&gt;crtc.bpp
op_eq
l_int|24
)paren
(brace
multiline_comment|/* In 24 bpp, the engine is in 8 bpp - this requires that all */
multiline_comment|/* horizontal coordinates and widths must be adjusted */
id|pitch_value
op_assign
id|pitch_value
op_star
l_int|3
suffix:semicolon
)brace
multiline_comment|/* On GTC (RagePro), we need to reset the 3D engine before */
r_if
c_cond
(paren
id|M64_HAS
c_func
(paren
id|RESET_3D
)paren
)paren
id|reset_GTC_3D_engine
c_func
(paren
id|info
)paren
suffix:semicolon
multiline_comment|/* Reset engine, enable, and clear any engine errors */
id|aty_reset_engine
c_func
(paren
id|info
)paren
suffix:semicolon
multiline_comment|/* Ensure that vga page pointers are set to zero - the upper */
multiline_comment|/* page pointers are set to 1 to handle overflows in the */
multiline_comment|/* lower page */
id|aty_st_le32
c_func
(paren
id|MEM_VGA_WP_SEL
comma
l_int|0x00010000
comma
id|info
)paren
suffix:semicolon
id|aty_st_le32
c_func
(paren
id|MEM_VGA_RP_SEL
comma
l_int|0x00010000
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* ---- Setup standard engine context ---- */
multiline_comment|/* All GUI registers here are FIFOed - therefore, wait for */
multiline_comment|/* the appropriate number of empty FIFO entries */
id|wait_for_fifo
c_func
(paren
l_int|14
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* enable all registers to be loaded for context loads */
id|aty_st_le32
c_func
(paren
id|CONTEXT_MASK
comma
l_int|0xFFFFFFFF
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* set destination pitch to modal pitch, set offset to zero */
id|aty_st_le32
c_func
(paren
id|DST_OFF_PITCH
comma
(paren
id|pitch_value
op_div
l_int|8
)paren
op_lshift
l_int|22
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* zero these registers (set them to a known state) */
id|aty_st_le32
c_func
(paren
id|DST_Y_X
comma
l_int|0
comma
id|info
)paren
suffix:semicolon
id|aty_st_le32
c_func
(paren
id|DST_HEIGHT
comma
l_int|0
comma
id|info
)paren
suffix:semicolon
id|aty_st_le32
c_func
(paren
id|DST_BRES_ERR
comma
l_int|0
comma
id|info
)paren
suffix:semicolon
id|aty_st_le32
c_func
(paren
id|DST_BRES_INC
comma
l_int|0
comma
id|info
)paren
suffix:semicolon
id|aty_st_le32
c_func
(paren
id|DST_BRES_DEC
comma
l_int|0
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* set destination drawing attributes */
id|aty_st_le32
c_func
(paren
id|DST_CNTL
comma
id|DST_LAST_PEL
op_or
id|DST_Y_TOP_TO_BOTTOM
op_or
id|DST_X_LEFT_TO_RIGHT
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* set source pitch to modal pitch, set offset to zero */
id|aty_st_le32
c_func
(paren
id|SRC_OFF_PITCH
comma
(paren
id|pitch_value
op_div
l_int|8
)paren
op_lshift
l_int|22
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* set these registers to a known state */
id|aty_st_le32
c_func
(paren
id|SRC_Y_X
comma
l_int|0
comma
id|info
)paren
suffix:semicolon
id|aty_st_le32
c_func
(paren
id|SRC_HEIGHT1_WIDTH1
comma
l_int|1
comma
id|info
)paren
suffix:semicolon
id|aty_st_le32
c_func
(paren
id|SRC_Y_X_START
comma
l_int|0
comma
id|info
)paren
suffix:semicolon
id|aty_st_le32
c_func
(paren
id|SRC_HEIGHT2_WIDTH2
comma
l_int|1
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* set source pixel retrieving attributes */
id|aty_st_le32
c_func
(paren
id|SRC_CNTL
comma
id|SRC_LINE_X_LEFT_TO_RIGHT
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* set host attributes */
id|wait_for_fifo
c_func
(paren
l_int|13
comma
id|info
)paren
suffix:semicolon
id|aty_st_le32
c_func
(paren
id|HOST_CNTL
comma
l_int|0
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* set pattern attributes */
id|aty_st_le32
c_func
(paren
id|PAT_REG0
comma
l_int|0
comma
id|info
)paren
suffix:semicolon
id|aty_st_le32
c_func
(paren
id|PAT_REG1
comma
l_int|0
comma
id|info
)paren
suffix:semicolon
id|aty_st_le32
c_func
(paren
id|PAT_CNTL
comma
l_int|0
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* set scissors to modal size */
id|aty_st_le32
c_func
(paren
id|SC_LEFT
comma
l_int|0
comma
id|info
)paren
suffix:semicolon
id|aty_st_le32
c_func
(paren
id|SC_TOP
comma
l_int|0
comma
id|info
)paren
suffix:semicolon
id|aty_st_le32
c_func
(paren
id|SC_BOTTOM
comma
id|par-&gt;crtc.vyres
op_minus
l_int|1
comma
id|info
)paren
suffix:semicolon
id|aty_st_le32
c_func
(paren
id|SC_RIGHT
comma
id|pitch_value
op_minus
l_int|1
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* set background color to minimum value (usually BLACK) */
id|aty_st_le32
c_func
(paren
id|DP_BKGD_CLR
comma
l_int|0
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* set foreground color to maximum value (usually WHITE) */
id|aty_st_le32
c_func
(paren
id|DP_FRGD_CLR
comma
l_int|0xFFFFFFFF
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* set write mask to effect all pixel bits */
id|aty_st_le32
c_func
(paren
id|DP_WRITE_MASK
comma
l_int|0xFFFFFFFF
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* set foreground mix to overpaint and background mix to */
multiline_comment|/* no-effect */
id|aty_st_le32
c_func
(paren
id|DP_MIX
comma
id|FRGD_MIX_S
op_or
id|BKGD_MIX_D
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* set primary source pixel channel to foreground color */
multiline_comment|/* register */
id|aty_st_le32
c_func
(paren
id|DP_SRC
comma
id|FRGD_SRC_FRGD_CLR
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* set compare functionality to false (no-effect on */
multiline_comment|/* destination) */
id|wait_for_fifo
c_func
(paren
l_int|3
comma
id|info
)paren
suffix:semicolon
id|aty_st_le32
c_func
(paren
id|CLR_CMP_CLR
comma
l_int|0
comma
id|info
)paren
suffix:semicolon
id|aty_st_le32
c_func
(paren
id|CLR_CMP_MASK
comma
l_int|0xFFFFFFFF
comma
id|info
)paren
suffix:semicolon
id|aty_st_le32
c_func
(paren
id|CLR_CMP_CNTL
comma
l_int|0
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* set pixel depth */
id|wait_for_fifo
c_func
(paren
l_int|2
comma
id|info
)paren
suffix:semicolon
id|aty_st_le32
c_func
(paren
id|DP_PIX_WIDTH
comma
id|par-&gt;crtc.dp_pix_width
comma
id|info
)paren
suffix:semicolon
id|aty_st_le32
c_func
(paren
id|DP_CHAIN_MASK
comma
id|par-&gt;crtc.dp_chain_mask
comma
id|info
)paren
suffix:semicolon
id|wait_for_fifo
c_func
(paren
l_int|5
comma
id|info
)paren
suffix:semicolon
id|aty_st_le32
c_func
(paren
id|SCALE_3D_CNTL
comma
l_int|0
comma
id|info
)paren
suffix:semicolon
id|aty_st_le32
c_func
(paren
id|Z_CNTL
comma
l_int|0
comma
id|info
)paren
suffix:semicolon
id|aty_st_le32
c_func
(paren
id|CRTC_INT_CNTL
comma
id|aty_ld_le32
c_func
(paren
id|CRTC_INT_CNTL
comma
id|info
)paren
op_amp
op_complement
l_int|0x20
comma
id|info
)paren
suffix:semicolon
id|aty_st_le32
c_func
(paren
id|GUI_TRAJ_CNTL
comma
l_int|0x100023
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* insure engine is idle before leaving */
id|wait_for_idle
c_func
(paren
id|info
)paren
suffix:semicolon
)brace
multiline_comment|/*&n;     *  Accelerated functions&n;     */
DECL|function|draw_rect
r_static
r_inline
r_void
id|draw_rect
c_func
(paren
id|s16
id|x
comma
id|s16
id|y
comma
id|u16
id|width
comma
id|u16
id|height
comma
r_struct
id|fb_info_aty
op_star
id|info
)paren
(brace
multiline_comment|/* perform rectangle fill */
id|wait_for_fifo
c_func
(paren
l_int|2
comma
id|info
)paren
suffix:semicolon
id|aty_st_le32
c_func
(paren
id|DST_Y_X
comma
(paren
id|x
op_lshift
l_int|16
)paren
op_or
id|y
comma
id|info
)paren
suffix:semicolon
id|aty_st_le32
c_func
(paren
id|DST_HEIGHT_WIDTH
comma
(paren
id|width
op_lshift
l_int|16
)paren
op_or
id|height
comma
id|info
)paren
suffix:semicolon
id|info-&gt;blitter_may_be_busy
op_assign
l_int|1
suffix:semicolon
)brace
DECL|function|aty_rectcopy
r_static
r_inline
r_void
id|aty_rectcopy
c_func
(paren
r_int
id|srcx
comma
r_int
id|srcy
comma
r_int
id|dstx
comma
r_int
id|dsty
comma
id|u_int
id|width
comma
id|u_int
id|height
comma
r_struct
id|fb_info_aty
op_star
id|info
)paren
(brace
id|u32
id|direction
op_assign
id|DST_LAST_PEL
suffix:semicolon
id|u32
id|pitch_value
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|width
op_logical_or
op_logical_neg
id|height
)paren
r_return
suffix:semicolon
id|pitch_value
op_assign
id|info-&gt;current_par.crtc.vxres
suffix:semicolon
r_if
c_cond
(paren
id|info-&gt;current_par.crtc.bpp
op_eq
l_int|24
)paren
(brace
multiline_comment|/* In 24 bpp, the engine is in 8 bpp - this requires that all */
multiline_comment|/* horizontal coordinates and widths must be adjusted */
id|pitch_value
op_mul_assign
l_int|3
suffix:semicolon
id|srcx
op_mul_assign
l_int|3
suffix:semicolon
id|dstx
op_mul_assign
l_int|3
suffix:semicolon
id|width
op_mul_assign
l_int|3
suffix:semicolon
)brace
r_if
c_cond
(paren
id|srcy
OL
id|dsty
)paren
(brace
id|dsty
op_add_assign
id|height
op_minus
l_int|1
suffix:semicolon
id|srcy
op_add_assign
id|height
op_minus
l_int|1
suffix:semicolon
)brace
r_else
id|direction
op_or_assign
id|DST_Y_TOP_TO_BOTTOM
suffix:semicolon
r_if
c_cond
(paren
id|srcx
OL
id|dstx
)paren
(brace
id|dstx
op_add_assign
id|width
op_minus
l_int|1
suffix:semicolon
id|srcx
op_add_assign
id|width
op_minus
l_int|1
suffix:semicolon
)brace
r_else
id|direction
op_or_assign
id|DST_X_LEFT_TO_RIGHT
suffix:semicolon
id|wait_for_fifo
c_func
(paren
l_int|4
comma
id|info
)paren
suffix:semicolon
id|aty_st_le32
c_func
(paren
id|DP_SRC
comma
id|FRGD_SRC_BLIT
comma
id|info
)paren
suffix:semicolon
id|aty_st_le32
c_func
(paren
id|SRC_Y_X
comma
(paren
id|srcx
op_lshift
l_int|16
)paren
op_or
id|srcy
comma
id|info
)paren
suffix:semicolon
id|aty_st_le32
c_func
(paren
id|SRC_HEIGHT1_WIDTH1
comma
(paren
id|width
op_lshift
l_int|16
)paren
op_or
id|height
comma
id|info
)paren
suffix:semicolon
id|aty_st_le32
c_func
(paren
id|DST_CNTL
comma
id|direction
comma
id|info
)paren
suffix:semicolon
id|draw_rect
c_func
(paren
id|dstx
comma
id|dsty
comma
id|width
comma
id|height
comma
id|info
)paren
suffix:semicolon
)brace
DECL|function|aty_rectfill
r_void
id|aty_rectfill
c_func
(paren
r_int
id|dstx
comma
r_int
id|dsty
comma
id|u_int
id|width
comma
id|u_int
id|height
comma
id|u_int
id|color
comma
r_struct
id|fb_info_aty
op_star
id|info
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|width
op_logical_or
op_logical_neg
id|height
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|info-&gt;current_par.crtc.bpp
op_eq
l_int|24
)paren
(brace
multiline_comment|/* In 24 bpp, the engine is in 8 bpp - this requires that all */
multiline_comment|/* horizontal coordinates and widths must be adjusted */
id|dstx
op_mul_assign
l_int|3
suffix:semicolon
id|width
op_mul_assign
l_int|3
suffix:semicolon
)brace
id|wait_for_fifo
c_func
(paren
l_int|3
comma
id|info
)paren
suffix:semicolon
id|aty_st_le32
c_func
(paren
id|DP_FRGD_CLR
comma
id|color
comma
id|info
)paren
suffix:semicolon
id|aty_st_le32
c_func
(paren
id|DP_SRC
comma
id|BKGD_SRC_BKGD_CLR
op_or
id|FRGD_SRC_FRGD_CLR
op_or
id|MONO_SRC_ONE
comma
id|info
)paren
suffix:semicolon
id|aty_st_le32
c_func
(paren
id|DST_CNTL
comma
id|DST_LAST_PEL
op_or
id|DST_Y_TOP_TO_BOTTOM
op_or
id|DST_X_LEFT_TO_RIGHT
comma
id|info
)paren
suffix:semicolon
id|draw_rect
c_func
(paren
id|dstx
comma
id|dsty
comma
id|width
comma
id|height
comma
id|info
)paren
suffix:semicolon
)brace
multiline_comment|/*&n;     *  Text console acceleration&n;     */
DECL|function|fbcon_aty_bmove
r_static
r_void
id|fbcon_aty_bmove
c_func
(paren
r_struct
id|display
op_star
id|p
comma
r_int
id|sy
comma
r_int
id|sx
comma
r_int
id|dy
comma
r_int
id|dx
comma
r_int
id|height
comma
r_int
id|width
)paren
(brace
macro_line|#ifdef __sparc__
r_struct
id|fb_info_aty
op_star
id|fb
op_assign
(paren
r_struct
id|fb_info_aty
op_star
)paren
(paren
id|p-&gt;fb_info
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fb-&gt;mmaped
op_logical_and
(paren
op_logical_neg
id|fb-&gt;fb_info.display_fg
op_logical_or
id|fb-&gt;fb_info.display_fg-&gt;vc_num
op_eq
id|fb-&gt;vtconsole
)paren
)paren
r_return
suffix:semicolon
macro_line|#endif
id|sx
op_mul_assign
id|fontwidth
c_func
(paren
id|p
)paren
suffix:semicolon
id|sy
op_mul_assign
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
id|dx
op_mul_assign
id|fontwidth
c_func
(paren
id|p
)paren
suffix:semicolon
id|dy
op_mul_assign
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
id|width
op_mul_assign
id|fontwidth
c_func
(paren
id|p
)paren
suffix:semicolon
id|height
op_mul_assign
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
id|aty_rectcopy
c_func
(paren
id|sx
comma
id|sy
comma
id|dx
comma
id|dy
comma
id|width
comma
id|height
comma
(paren
r_struct
id|fb_info_aty
op_star
)paren
id|p-&gt;fb_info
)paren
suffix:semicolon
)brace
DECL|function|fbcon_aty_clear
r_static
r_void
id|fbcon_aty_clear
c_func
(paren
r_struct
id|vc_data
op_star
id|conp
comma
r_struct
id|display
op_star
id|p
comma
r_int
id|sy
comma
r_int
id|sx
comma
r_int
id|height
comma
r_int
id|width
)paren
(brace
id|u32
id|bgx
suffix:semicolon
macro_line|#ifdef __sparc__
r_struct
id|fb_info_aty
op_star
id|fb
op_assign
(paren
r_struct
id|fb_info_aty
op_star
)paren
(paren
id|p-&gt;fb_info
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fb-&gt;mmaped
op_logical_and
(paren
op_logical_neg
id|fb-&gt;fb_info.display_fg
op_logical_or
id|fb-&gt;fb_info.display_fg-&gt;vc_num
op_eq
id|fb-&gt;vtconsole
)paren
)paren
r_return
suffix:semicolon
macro_line|#endif
id|bgx
op_assign
id|attr_bgcol_ec
c_func
(paren
id|p
comma
id|conp
)paren
suffix:semicolon
id|bgx
op_or_assign
(paren
id|bgx
op_lshift
l_int|8
)paren
suffix:semicolon
id|bgx
op_or_assign
(paren
id|bgx
op_lshift
l_int|16
)paren
suffix:semicolon
id|sx
op_mul_assign
id|fontwidth
c_func
(paren
id|p
)paren
suffix:semicolon
id|sy
op_mul_assign
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
id|width
op_mul_assign
id|fontwidth
c_func
(paren
id|p
)paren
suffix:semicolon
id|height
op_mul_assign
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
id|aty_rectfill
c_func
(paren
id|sx
comma
id|sy
comma
id|width
comma
id|height
comma
id|bgx
comma
(paren
r_struct
id|fb_info_aty
op_star
)paren
id|p-&gt;fb_info
)paren
suffix:semicolon
)brace
macro_line|#ifdef __sparc__
DECL|macro|check_access
mdefine_line|#define check_access &bslash;&n;    if (fb-&gt;mmaped &amp;&amp; (!fb-&gt;fb_info.display_fg &bslash;&n;&t;|| fb-&gt;fb_info.display_fg-&gt;vc_num == fb-&gt;vtconsole)) &bslash;&n;&t;return;
macro_line|#else
DECL|macro|check_access
mdefine_line|#define check_access do { } while (0)
macro_line|#endif
DECL|macro|DEF_FBCON_ATY_OP
mdefine_line|#define DEF_FBCON_ATY_OP(name, call, args...) &bslash;&n;static void name(struct vc_data *conp, struct display *p, args) &bslash;&n;{ &bslash;&n;    struct fb_info_aty *fb = (struct fb_info_aty *)(p-&gt;fb_info); &bslash;&n;    check_access; &bslash;&n;    if (fb-&gt;blitter_may_be_busy) &bslash;&n;&t;wait_for_idle((struct fb_info_aty *)p-&gt;fb_info); &bslash;&n;    call; &bslash;&n;}
DECL|macro|DEF_FBCON_ATY
mdefine_line|#define DEF_FBCON_ATY(width) &bslash;&n;    DEF_FBCON_ATY_OP(fbcon_aty##width##_putc, &bslash;&n;&t;&t;     fbcon_cfb##width##_putc(conp, p, c, yy, xx), &bslash;&n;&t;&t;     int c, int yy, int xx) &bslash;&n;    DEF_FBCON_ATY_OP(fbcon_aty##width##_putcs, &bslash;&n;&t;&t;     fbcon_cfb##width##_putcs(conp, p, s, count, yy, xx), &bslash;&n;&t;&t;     const unsigned short *s, int count, int yy, int xx) &bslash;&n;    DEF_FBCON_ATY_OP(fbcon_aty##width##_clear_margins, &bslash;&n;&t;&t;     fbcon_cfb##width##_clear_margins(conp, p, bottom_only), &bslash;&n;&t;&t;     int bottom_only) &bslash;&n; &bslash;&n;const struct display_switch fbcon_aty##width = { &bslash;&n;    setup:&t;&t;fbcon_cfb##width##_setup, &bslash;&n;    bmove:&t;&t;fbcon_aty_bmove, &bslash;&n;    clear:&t;&t;fbcon_aty_clear, &bslash;&n;    putc:&t;&t;fbcon_aty##width##_putc, &bslash;&n;    putcs:&t;&t;fbcon_aty##width##_putcs, &bslash;&n;    revc:&t;&t;fbcon_cfb##width##_revc, &bslash;&n;    clear_margins:&t;fbcon_aty##width##_clear_margins, &bslash;&n;    fontwidthmask:&t;FONTWIDTH(4)|FONTWIDTH(8)|FONTWIDTH(12)|FONTWIDTH(16) &bslash;&n;};
macro_line|#ifdef FBCON_HAS_CFB8
id|DEF_FBCON_ATY
c_func
(paren
l_int|8
)paren
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB16
id|DEF_FBCON_ATY
c_func
(paren
l_int|16
)paren
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB24
id|DEF_FBCON_ATY
c_func
(paren
l_int|24
)paren
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB32
id|DEF_FBCON_ATY
c_func
(paren
l_int|32
)paren
macro_line|#endif
eof
