macro_line|#include &quot;radeonfb.h&quot;
multiline_comment|/* the accelerated functions here are patterned after the &n; * &quot;ACCEL_MMIO&quot; ifdef branches in XFree86&n; * --dte&n; */
DECL|function|radeon_fixup_offset
r_static
r_void
id|radeon_fixup_offset
c_func
(paren
r_struct
id|radeonfb_info
op_star
id|rinfo
)paren
(brace
id|u32
id|local_base
suffix:semicolon
multiline_comment|/* *** Ugly workaround *** */
multiline_comment|/*&n;&t; * On some platforms, the video memory is mapped at 0 in radeon chip space&n;&t; * (like PPCs) by the firmware. X will always move it up so that it&squot;s seen&n;&t; * by the chip to be at the same address as the PCI BAR.&n;&t; * That means that when switching back from X, there is a mismatch between&n;&t; * the offsets programmed into the engine. This means that potentially,&n;&t; * accel operations done before radeonfb has a chance to re-init the engine&n;&t; * will have incorrect offsets, and potentially trash system memory !&n;&t; *&n;&t; * The correct fix is for fbcon to never call any accel op before the engine&n;&t; * has properly been re-initialized (by a call to set_var), but this is a&n;&t; * complex fix. This workaround in the meantime, called before every accel&n;&t; * operation, makes sure the offsets are in sync.&n;&t; */
id|radeon_fifo_wait
(paren
l_int|1
)paren
suffix:semicolon
id|local_base
op_assign
id|INREG
c_func
(paren
id|MC_FB_LOCATION
)paren
op_lshift
l_int|16
suffix:semicolon
r_if
c_cond
(paren
id|local_base
op_eq
id|rinfo-&gt;fb_local_base
)paren
r_return
suffix:semicolon
id|rinfo-&gt;fb_local_base
op_assign
id|local_base
suffix:semicolon
id|radeon_fifo_wait
(paren
l_int|3
)paren
suffix:semicolon
id|OUTREG
c_func
(paren
id|DEFAULT_PITCH_OFFSET
comma
(paren
id|rinfo-&gt;pitch
op_lshift
l_int|0x16
)paren
op_or
(paren
id|rinfo-&gt;fb_local_base
op_rshift
l_int|10
)paren
)paren
suffix:semicolon
id|OUTREG
c_func
(paren
id|DST_PITCH_OFFSET
comma
(paren
id|rinfo-&gt;pitch
op_lshift
l_int|0x16
)paren
op_or
(paren
id|rinfo-&gt;fb_local_base
op_rshift
l_int|10
)paren
)paren
suffix:semicolon
id|OUTREG
c_func
(paren
id|SRC_PITCH_OFFSET
comma
(paren
id|rinfo-&gt;pitch
op_lshift
l_int|0x16
)paren
op_or
(paren
id|rinfo-&gt;fb_local_base
op_rshift
l_int|10
)paren
)paren
suffix:semicolon
)brace
DECL|function|radeonfb_prim_fillrect
r_static
r_void
id|radeonfb_prim_fillrect
c_func
(paren
r_struct
id|radeonfb_info
op_star
id|rinfo
comma
r_const
r_struct
id|fb_fillrect
op_star
id|region
)paren
(brace
id|radeon_fifo_wait
c_func
(paren
l_int|4
)paren
suffix:semicolon
id|OUTREG
c_func
(paren
id|DP_GUI_MASTER_CNTL
comma
id|rinfo-&gt;dp_gui_master_cntl
multiline_comment|/* contains, like GMC_DST_32BPP */
op_or
id|GMC_BRUSH_SOLID_COLOR
op_or
id|ROP3_P
)paren
suffix:semicolon
r_if
c_cond
(paren
id|radeon_get_dstbpp
c_func
(paren
id|rinfo-&gt;depth
)paren
op_ne
id|DST_8BPP
)paren
id|OUTREG
c_func
(paren
id|DP_BRUSH_FRGD_CLR
comma
id|rinfo-&gt;pseudo_palette
(braket
id|region-&gt;color
)braket
)paren
suffix:semicolon
r_else
id|OUTREG
c_func
(paren
id|DP_BRUSH_FRGD_CLR
comma
id|region-&gt;color
)paren
suffix:semicolon
id|OUTREG
c_func
(paren
id|DP_WRITE_MSK
comma
l_int|0xffffffff
)paren
suffix:semicolon
id|OUTREG
c_func
(paren
id|DP_CNTL
comma
(paren
id|DST_X_LEFT_TO_RIGHT
op_or
id|DST_Y_TOP_TO_BOTTOM
)paren
)paren
suffix:semicolon
id|radeon_fifo_wait
c_func
(paren
l_int|2
)paren
suffix:semicolon
id|OUTREG
c_func
(paren
id|DST_Y_X
comma
(paren
id|region-&gt;dy
op_lshift
l_int|16
)paren
op_or
id|region-&gt;dx
)paren
suffix:semicolon
id|OUTREG
c_func
(paren
id|DST_WIDTH_HEIGHT
comma
(paren
id|region-&gt;width
op_lshift
l_int|16
)paren
op_or
id|region-&gt;height
)paren
suffix:semicolon
)brace
DECL|function|radeonfb_fillrect
r_void
id|radeonfb_fillrect
c_func
(paren
r_struct
id|fb_info
op_star
id|info
comma
r_const
r_struct
id|fb_fillrect
op_star
id|region
)paren
(brace
r_struct
id|radeonfb_info
op_star
id|rinfo
op_assign
id|info-&gt;par
suffix:semicolon
r_struct
id|fb_fillrect
id|modded
suffix:semicolon
r_int
id|vxres
comma
id|vyres
suffix:semicolon
r_if
c_cond
(paren
id|info-&gt;state
op_ne
id|FBINFO_STATE_RUNNING
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|info-&gt;flags
op_amp
id|FBINFO_HWACCEL_DISABLED
)paren
(brace
id|cfb_fillrect
c_func
(paren
id|info
comma
id|region
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|radeon_fixup_offset
c_func
(paren
id|rinfo
)paren
suffix:semicolon
id|vxres
op_assign
id|info-&gt;var.xres_virtual
suffix:semicolon
id|vyres
op_assign
id|info-&gt;var.yres_virtual
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|modded
comma
id|region
comma
r_sizeof
(paren
r_struct
id|fb_fillrect
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|modded.width
op_logical_or
op_logical_neg
id|modded.height
op_logical_or
id|modded.dx
op_ge
id|vxres
op_logical_or
id|modded.dy
op_ge
id|vyres
)paren
(brace
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|modded.dx
op_plus
id|modded.width
OG
id|vxres
)paren
(brace
id|modded.width
op_assign
id|vxres
op_minus
id|modded.dx
suffix:semicolon
)brace
r_if
c_cond
(paren
id|modded.dy
op_plus
id|modded.height
OG
id|vyres
)paren
(brace
id|modded.height
op_assign
id|vyres
op_minus
id|modded.dy
suffix:semicolon
)brace
id|radeonfb_prim_fillrect
c_func
(paren
id|rinfo
comma
op_amp
id|modded
)paren
suffix:semicolon
)brace
DECL|function|radeonfb_prim_copyarea
r_static
r_void
id|radeonfb_prim_copyarea
c_func
(paren
r_struct
id|radeonfb_info
op_star
id|rinfo
comma
r_const
r_struct
id|fb_copyarea
op_star
id|area
)paren
(brace
r_int
id|xdir
comma
id|ydir
suffix:semicolon
id|u32
id|sx
comma
id|sy
comma
id|dx
comma
id|dy
comma
id|w
comma
id|h
suffix:semicolon
id|w
op_assign
id|area-&gt;width
suffix:semicolon
id|h
op_assign
id|area-&gt;height
suffix:semicolon
id|dx
op_assign
id|area-&gt;dx
suffix:semicolon
id|dy
op_assign
id|area-&gt;dy
suffix:semicolon
id|sx
op_assign
id|area-&gt;sx
suffix:semicolon
id|sy
op_assign
id|area-&gt;sy
suffix:semicolon
id|xdir
op_assign
id|sx
op_minus
id|dx
suffix:semicolon
id|ydir
op_assign
id|sy
op_minus
id|dy
suffix:semicolon
r_if
c_cond
(paren
id|xdir
OL
l_int|0
)paren
(brace
id|sx
op_add_assign
id|w
op_minus
l_int|1
suffix:semicolon
id|dx
op_add_assign
id|w
op_minus
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ydir
OL
l_int|0
)paren
(brace
id|sy
op_add_assign
id|h
op_minus
l_int|1
suffix:semicolon
id|dy
op_add_assign
id|h
op_minus
l_int|1
suffix:semicolon
)brace
id|radeon_fifo_wait
c_func
(paren
l_int|3
)paren
suffix:semicolon
id|OUTREG
c_func
(paren
id|DP_GUI_MASTER_CNTL
comma
id|rinfo-&gt;dp_gui_master_cntl
multiline_comment|/* i.e. GMC_DST_32BPP */
op_or
id|GMC_BRUSH_NONE
op_or
id|GMC_SRC_DSTCOLOR
op_or
id|ROP3_S
op_or
id|DP_SRC_SOURCE_MEMORY
)paren
suffix:semicolon
id|OUTREG
c_func
(paren
id|DP_WRITE_MSK
comma
l_int|0xffffffff
)paren
suffix:semicolon
id|OUTREG
c_func
(paren
id|DP_CNTL
comma
(paren
id|xdir
op_ge
l_int|0
ques
c_cond
id|DST_X_LEFT_TO_RIGHT
suffix:colon
l_int|0
)paren
op_or
(paren
id|ydir
op_ge
l_int|0
ques
c_cond
id|DST_Y_TOP_TO_BOTTOM
suffix:colon
l_int|0
)paren
)paren
suffix:semicolon
id|radeon_fifo_wait
c_func
(paren
l_int|3
)paren
suffix:semicolon
id|OUTREG
c_func
(paren
id|SRC_Y_X
comma
(paren
id|sy
op_lshift
l_int|16
)paren
op_or
id|sx
)paren
suffix:semicolon
id|OUTREG
c_func
(paren
id|DST_Y_X
comma
(paren
id|dy
op_lshift
l_int|16
)paren
op_or
id|dx
)paren
suffix:semicolon
id|OUTREG
c_func
(paren
id|DST_HEIGHT_WIDTH
comma
(paren
id|h
op_lshift
l_int|16
)paren
op_or
id|w
)paren
suffix:semicolon
)brace
DECL|function|radeonfb_copyarea
r_void
id|radeonfb_copyarea
c_func
(paren
r_struct
id|fb_info
op_star
id|info
comma
r_const
r_struct
id|fb_copyarea
op_star
id|area
)paren
(brace
r_struct
id|radeonfb_info
op_star
id|rinfo
op_assign
id|info-&gt;par
suffix:semicolon
r_struct
id|fb_copyarea
id|modded
suffix:semicolon
id|u32
id|vxres
comma
id|vyres
suffix:semicolon
id|modded.sx
op_assign
id|area-&gt;sx
suffix:semicolon
id|modded.sy
op_assign
id|area-&gt;sy
suffix:semicolon
id|modded.dx
op_assign
id|area-&gt;dx
suffix:semicolon
id|modded.dy
op_assign
id|area-&gt;dy
suffix:semicolon
id|modded.width
op_assign
id|area-&gt;width
suffix:semicolon
id|modded.height
op_assign
id|area-&gt;height
suffix:semicolon
r_if
c_cond
(paren
id|info-&gt;state
op_ne
id|FBINFO_STATE_RUNNING
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|info-&gt;flags
op_amp
id|FBINFO_HWACCEL_DISABLED
)paren
(brace
id|cfb_copyarea
c_func
(paren
id|info
comma
id|area
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|radeon_fixup_offset
c_func
(paren
id|rinfo
)paren
suffix:semicolon
id|vxres
op_assign
id|info-&gt;var.xres_virtual
suffix:semicolon
id|vyres
op_assign
id|info-&gt;var.yres_virtual
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|modded.width
op_logical_or
op_logical_neg
id|modded.height
op_logical_or
id|modded.sx
op_ge
id|vxres
op_logical_or
id|modded.sy
op_ge
id|vyres
op_logical_or
id|modded.dx
op_ge
id|vxres
op_logical_or
id|modded.dy
op_ge
id|vyres
)paren
(brace
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|modded.sx
op_plus
id|modded.width
OG
id|vxres
)paren
(brace
id|modded.width
op_assign
id|vxres
op_minus
id|modded.sx
suffix:semicolon
)brace
r_if
c_cond
(paren
id|modded.dx
op_plus
id|modded.width
OG
id|vxres
)paren
(brace
id|modded.width
op_assign
id|vxres
op_minus
id|modded.dx
suffix:semicolon
)brace
r_if
c_cond
(paren
id|modded.sy
op_plus
id|modded.height
OG
id|vyres
)paren
(brace
id|modded.height
op_assign
id|vyres
op_minus
id|modded.sy
suffix:semicolon
)brace
r_if
c_cond
(paren
id|modded.dy
op_plus
id|modded.height
OG
id|vyres
)paren
(brace
id|modded.height
op_assign
id|vyres
op_minus
id|modded.dy
suffix:semicolon
)brace
id|radeonfb_prim_copyarea
c_func
(paren
id|rinfo
comma
op_amp
id|modded
)paren
suffix:semicolon
)brace
DECL|function|radeonfb_imageblit
r_void
id|radeonfb_imageblit
c_func
(paren
r_struct
id|fb_info
op_star
id|info
comma
r_const
r_struct
id|fb_image
op_star
id|image
)paren
(brace
r_struct
id|radeonfb_info
op_star
id|rinfo
op_assign
id|info-&gt;par
suffix:semicolon
r_if
c_cond
(paren
id|info-&gt;state
op_ne
id|FBINFO_STATE_RUNNING
)paren
r_return
suffix:semicolon
id|radeon_engine_idle
c_func
(paren
)paren
suffix:semicolon
id|cfb_imageblit
c_func
(paren
id|info
comma
id|image
)paren
suffix:semicolon
)brace
DECL|function|radeonfb_sync
r_int
id|radeonfb_sync
c_func
(paren
r_struct
id|fb_info
op_star
id|info
)paren
(brace
r_struct
id|radeonfb_info
op_star
id|rinfo
op_assign
id|info-&gt;par
suffix:semicolon
r_if
c_cond
(paren
id|info-&gt;state
op_ne
id|FBINFO_STATE_RUNNING
)paren
r_return
l_int|0
suffix:semicolon
id|radeon_engine_idle
c_func
(paren
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|radeonfb_engine_reset
r_void
id|radeonfb_engine_reset
c_func
(paren
r_struct
id|radeonfb_info
op_star
id|rinfo
)paren
(brace
id|u32
id|clock_cntl_index
comma
id|mclk_cntl
comma
id|rbbm_soft_reset
suffix:semicolon
id|u32
id|host_path_cntl
suffix:semicolon
id|radeon_engine_flush
(paren
id|rinfo
)paren
suffix:semicolon
multiline_comment|/* Some ASICs have bugs with dynamic-on feature, which are  &n;     &t; * ASIC-version dependent, so we force all blocks on for now&n;     &t; * -- from XFree86&n;     &t; * We don&squot;t do that on macs, things just work here with dynamic&n;     &t; * clocking... --BenH&n;&t; */
macro_line|#ifdef CONFIG_ALL_PPC
r_if
c_cond
(paren
id|_machine
op_ne
id|_MACH_Pmac
op_logical_and
id|rinfo-&gt;hasCRTC2
)paren
macro_line|#else
r_if
c_cond
(paren
id|rinfo-&gt;has_CRTC2
)paren
macro_line|#endif&t;
(brace
id|u32
id|tmp
suffix:semicolon
id|tmp
op_assign
id|INPLL
c_func
(paren
id|SCLK_CNTL
)paren
suffix:semicolon
id|OUTPLL
c_func
(paren
id|SCLK_CNTL
comma
(paren
(paren
id|tmp
op_amp
op_complement
id|DYN_STOP_LAT_MASK
)paren
op_or
id|CP_MAX_DYN_STOP_LAT
op_or
id|SCLK_FORCEON_MASK
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rinfo-&gt;family
op_eq
id|CHIP_FAMILY_RV200
)paren
(brace
id|tmp
op_assign
id|INPLL
c_func
(paren
id|SCLK_MORE_CNTL
)paren
suffix:semicolon
id|OUTPLL
c_func
(paren
id|SCLK_MORE_CNTL
comma
id|tmp
op_or
id|SCLK_MORE_FORCEON
)paren
suffix:semicolon
)brace
)brace
id|clock_cntl_index
op_assign
id|INREG
c_func
(paren
id|CLOCK_CNTL_INDEX
)paren
suffix:semicolon
id|mclk_cntl
op_assign
id|INPLL
c_func
(paren
id|MCLK_CNTL
)paren
suffix:semicolon
id|OUTPLL
c_func
(paren
id|MCLK_CNTL
comma
(paren
id|mclk_cntl
op_or
id|FORCEON_MCLKA
op_or
id|FORCEON_MCLKB
op_or
id|FORCEON_YCLKA
op_or
id|FORCEON_YCLKB
op_or
id|FORCEON_MC
op_or
id|FORCEON_AIC
)paren
)paren
suffix:semicolon
id|host_path_cntl
op_assign
id|INREG
c_func
(paren
id|HOST_PATH_CNTL
)paren
suffix:semicolon
id|rbbm_soft_reset
op_assign
id|INREG
c_func
(paren
id|RBBM_SOFT_RESET
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rinfo-&gt;family
op_eq
id|CHIP_FAMILY_R300
op_logical_or
id|rinfo-&gt;family
op_eq
id|CHIP_FAMILY_R350
op_logical_or
id|rinfo-&gt;family
op_eq
id|CHIP_FAMILY_RV350
)paren
(brace
id|u32
id|tmp
suffix:semicolon
id|OUTREG
c_func
(paren
id|RBBM_SOFT_RESET
comma
(paren
id|rbbm_soft_reset
op_or
id|SOFT_RESET_CP
op_or
id|SOFT_RESET_HI
op_or
id|SOFT_RESET_E2
)paren
)paren
suffix:semicolon
id|INREG
c_func
(paren
id|RBBM_SOFT_RESET
)paren
suffix:semicolon
id|OUTREG
c_func
(paren
id|RBBM_SOFT_RESET
comma
l_int|0
)paren
suffix:semicolon
id|tmp
op_assign
id|INREG
c_func
(paren
id|RB2D_DSTCACHE_MODE
)paren
suffix:semicolon
id|OUTREG
c_func
(paren
id|RB2D_DSTCACHE_MODE
comma
id|tmp
op_or
(paren
l_int|1
op_lshift
l_int|17
)paren
)paren
suffix:semicolon
multiline_comment|/* FIXME */
)brace
r_else
(brace
id|OUTREG
c_func
(paren
id|RBBM_SOFT_RESET
comma
id|rbbm_soft_reset
op_or
id|SOFT_RESET_CP
op_or
id|SOFT_RESET_HI
op_or
id|SOFT_RESET_SE
op_or
id|SOFT_RESET_RE
op_or
id|SOFT_RESET_PP
op_or
id|SOFT_RESET_E2
op_or
id|SOFT_RESET_RB
)paren
suffix:semicolon
id|INREG
c_func
(paren
id|RBBM_SOFT_RESET
)paren
suffix:semicolon
id|OUTREG
c_func
(paren
id|RBBM_SOFT_RESET
comma
id|rbbm_soft_reset
op_amp
(paren
id|u32
)paren
op_complement
(paren
id|SOFT_RESET_CP
op_or
id|SOFT_RESET_HI
op_or
id|SOFT_RESET_SE
op_or
id|SOFT_RESET_RE
op_or
id|SOFT_RESET_PP
op_or
id|SOFT_RESET_E2
op_or
id|SOFT_RESET_RB
)paren
)paren
suffix:semicolon
id|INREG
c_func
(paren
id|RBBM_SOFT_RESET
)paren
suffix:semicolon
)brace
id|OUTREG
c_func
(paren
id|HOST_PATH_CNTL
comma
id|host_path_cntl
op_or
id|HDP_SOFT_RESET
)paren
suffix:semicolon
id|INREG
c_func
(paren
id|HOST_PATH_CNTL
)paren
suffix:semicolon
id|OUTREG
c_func
(paren
id|HOST_PATH_CNTL
comma
id|host_path_cntl
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rinfo-&gt;family
op_ne
id|CHIP_FAMILY_R300
op_logical_or
id|rinfo-&gt;family
op_ne
id|CHIP_FAMILY_R350
op_logical_or
id|rinfo-&gt;family
op_ne
id|CHIP_FAMILY_RV350
)paren
id|OUTREG
c_func
(paren
id|RBBM_SOFT_RESET
comma
id|rbbm_soft_reset
)paren
suffix:semicolon
id|OUTREG
c_func
(paren
id|CLOCK_CNTL_INDEX
comma
id|clock_cntl_index
)paren
suffix:semicolon
id|OUTPLL
c_func
(paren
id|MCLK_CNTL
comma
id|mclk_cntl
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rinfo-&gt;R300_cg_workaround
)paren
id|R300_cg_workardound
c_func
(paren
id|rinfo
)paren
suffix:semicolon
)brace
DECL|function|radeonfb_engine_init
r_void
id|radeonfb_engine_init
(paren
r_struct
id|radeonfb_info
op_star
id|rinfo
)paren
(brace
r_int
r_int
id|temp
suffix:semicolon
multiline_comment|/* disable 3D engine */
id|OUTREG
c_func
(paren
id|RB3D_CNTL
comma
l_int|0
)paren
suffix:semicolon
id|radeonfb_engine_reset
c_func
(paren
id|rinfo
)paren
suffix:semicolon
id|radeon_fifo_wait
(paren
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|rinfo-&gt;family
op_ne
id|CHIP_FAMILY_R300
)paren
op_logical_and
(paren
id|rinfo-&gt;family
op_ne
id|CHIP_FAMILY_R350
)paren
op_logical_and
(paren
id|rinfo-&gt;family
op_ne
id|CHIP_FAMILY_RV350
)paren
)paren
id|OUTREG
c_func
(paren
id|RB2D_DSTCACHE_MODE
comma
l_int|0
)paren
suffix:semicolon
id|radeon_fifo_wait
(paren
l_int|3
)paren
suffix:semicolon
multiline_comment|/* We re-read MC_FB_LOCATION from card as it can have been&n;&t; * modified by XFree drivers (ouch !)&n;&t; */
id|rinfo-&gt;fb_local_base
op_assign
id|INREG
c_func
(paren
id|MC_FB_LOCATION
)paren
op_lshift
l_int|16
suffix:semicolon
id|OUTREG
c_func
(paren
id|DEFAULT_PITCH_OFFSET
comma
(paren
id|rinfo-&gt;pitch
op_lshift
l_int|0x16
)paren
op_or
(paren
id|rinfo-&gt;fb_local_base
op_rshift
l_int|10
)paren
)paren
suffix:semicolon
id|OUTREG
c_func
(paren
id|DST_PITCH_OFFSET
comma
(paren
id|rinfo-&gt;pitch
op_lshift
l_int|0x16
)paren
op_or
(paren
id|rinfo-&gt;fb_local_base
op_rshift
l_int|10
)paren
)paren
suffix:semicolon
id|OUTREG
c_func
(paren
id|SRC_PITCH_OFFSET
comma
(paren
id|rinfo-&gt;pitch
op_lshift
l_int|0x16
)paren
op_or
(paren
id|rinfo-&gt;fb_local_base
op_rshift
l_int|10
)paren
)paren
suffix:semicolon
id|radeon_fifo_wait
(paren
l_int|1
)paren
suffix:semicolon
macro_line|#if defined(__BIG_ENDIAN)
id|OUTREGP
c_func
(paren
id|DP_DATATYPE
comma
id|HOST_BIG_ENDIAN_EN
comma
op_complement
id|HOST_BIG_ENDIAN_EN
)paren
suffix:semicolon
macro_line|#else
id|OUTREGP
c_func
(paren
id|DP_DATATYPE
comma
l_int|0
comma
op_complement
id|HOST_BIG_ENDIAN_EN
)paren
suffix:semicolon
macro_line|#endif
id|radeon_fifo_wait
(paren
l_int|2
)paren
suffix:semicolon
id|OUTREG
c_func
(paren
id|DEFAULT_SC_TOP_LEFT
comma
l_int|0
)paren
suffix:semicolon
id|OUTREG
c_func
(paren
id|DEFAULT_SC_BOTTOM_RIGHT
comma
(paren
id|DEFAULT_SC_RIGHT_MAX
op_or
id|DEFAULT_SC_BOTTOM_MAX
)paren
)paren
suffix:semicolon
id|temp
op_assign
id|radeon_get_dstbpp
c_func
(paren
id|rinfo-&gt;depth
)paren
suffix:semicolon
id|rinfo-&gt;dp_gui_master_cntl
op_assign
(paren
(paren
id|temp
op_lshift
l_int|8
)paren
op_or
id|GMC_CLR_CMP_CNTL_DIS
)paren
suffix:semicolon
id|radeon_fifo_wait
(paren
l_int|1
)paren
suffix:semicolon
id|OUTREG
c_func
(paren
id|DP_GUI_MASTER_CNTL
comma
(paren
id|rinfo-&gt;dp_gui_master_cntl
op_or
id|GMC_BRUSH_SOLID_COLOR
op_or
id|GMC_SRC_DATATYPE_COLOR
)paren
)paren
suffix:semicolon
id|radeon_fifo_wait
(paren
l_int|7
)paren
suffix:semicolon
multiline_comment|/* clear line drawing regs */
id|OUTREG
c_func
(paren
id|DST_LINE_START
comma
l_int|0
)paren
suffix:semicolon
id|OUTREG
c_func
(paren
id|DST_LINE_END
comma
l_int|0
)paren
suffix:semicolon
multiline_comment|/* set brush color regs */
id|OUTREG
c_func
(paren
id|DP_BRUSH_FRGD_CLR
comma
l_int|0xffffffff
)paren
suffix:semicolon
id|OUTREG
c_func
(paren
id|DP_BRUSH_BKGD_CLR
comma
l_int|0x00000000
)paren
suffix:semicolon
multiline_comment|/* set source color regs */
id|OUTREG
c_func
(paren
id|DP_SRC_FRGD_CLR
comma
l_int|0xffffffff
)paren
suffix:semicolon
id|OUTREG
c_func
(paren
id|DP_SRC_BKGD_CLR
comma
l_int|0x00000000
)paren
suffix:semicolon
multiline_comment|/* default write mask */
id|OUTREG
c_func
(paren
id|DP_WRITE_MSK
comma
l_int|0xffffffff
)paren
suffix:semicolon
id|radeon_engine_idle
(paren
)paren
suffix:semicolon
)brace
eof
