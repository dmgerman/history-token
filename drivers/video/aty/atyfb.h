multiline_comment|/*&n; *  ATI Frame Buffer Device Driver Core Definitions&n; */
macro_line|#include &lt;linux/config.h&gt;
multiline_comment|/*&n;     *  Elements of the hardware specific atyfb_par structure&n;     */
DECL|struct|crtc
r_struct
id|crtc
(brace
DECL|member|vxres
id|u32
id|vxres
suffix:semicolon
DECL|member|vyres
id|u32
id|vyres
suffix:semicolon
DECL|member|xoffset
id|u32
id|xoffset
suffix:semicolon
DECL|member|yoffset
id|u32
id|yoffset
suffix:semicolon
DECL|member|bpp
id|u32
id|bpp
suffix:semicolon
DECL|member|h_tot_disp
id|u32
id|h_tot_disp
suffix:semicolon
DECL|member|h_sync_strt_wid
id|u32
id|h_sync_strt_wid
suffix:semicolon
DECL|member|v_tot_disp
id|u32
id|v_tot_disp
suffix:semicolon
DECL|member|v_sync_strt_wid
id|u32
id|v_sync_strt_wid
suffix:semicolon
DECL|member|off_pitch
id|u32
id|off_pitch
suffix:semicolon
DECL|member|gen_cntl
id|u32
id|gen_cntl
suffix:semicolon
DECL|member|dp_pix_width
id|u32
id|dp_pix_width
suffix:semicolon
multiline_comment|/* acceleration */
DECL|member|dp_chain_mask
id|u32
id|dp_chain_mask
suffix:semicolon
multiline_comment|/* acceleration */
)brace
suffix:semicolon
DECL|struct|pll_514
r_struct
id|pll_514
(brace
DECL|member|m
id|u8
id|m
suffix:semicolon
DECL|member|n
id|u8
id|n
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|pll_18818
r_struct
id|pll_18818
(brace
DECL|member|program_bits
id|u32
id|program_bits
suffix:semicolon
DECL|member|locationAddr
id|u32
id|locationAddr
suffix:semicolon
DECL|member|period_in_ps
id|u32
id|period_in_ps
suffix:semicolon
DECL|member|post_divider
id|u32
id|post_divider
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|pll_ct
r_struct
id|pll_ct
(brace
DECL|member|pll_ref_div
id|u8
id|pll_ref_div
suffix:semicolon
DECL|member|pll_gen_cntl
id|u8
id|pll_gen_cntl
suffix:semicolon
DECL|member|mclk_fb_div
id|u8
id|mclk_fb_div
suffix:semicolon
DECL|member|pll_vclk_cntl
id|u8
id|pll_vclk_cntl
suffix:semicolon
DECL|member|vclk_post_div
id|u8
id|vclk_post_div
suffix:semicolon
DECL|member|vclk_fb_div
id|u8
id|vclk_fb_div
suffix:semicolon
DECL|member|pll_ext_cntl
id|u8
id|pll_ext_cntl
suffix:semicolon
DECL|member|dsp_config
id|u32
id|dsp_config
suffix:semicolon
multiline_comment|/* Mach64 GTB DSP */
DECL|member|dsp_on_off
id|u32
id|dsp_on_off
suffix:semicolon
multiline_comment|/* Mach64 GTB DSP */
DECL|member|mclk_post_div_real
id|u8
id|mclk_post_div_real
suffix:semicolon
DECL|member|vclk_post_div_real
id|u8
id|vclk_post_div_real
suffix:semicolon
)brace
suffix:semicolon
DECL|union|aty_pll
r_union
id|aty_pll
(brace
DECL|member|ct
r_struct
id|pll_ct
id|ct
suffix:semicolon
DECL|member|ibm514
r_struct
id|pll_514
id|ibm514
suffix:semicolon
DECL|member|ics2595
r_struct
id|pll_18818
id|ics2595
suffix:semicolon
)brace
suffix:semicolon
multiline_comment|/*&n;     *  The hardware parameters for each card&n;     */
DECL|struct|atyfb_par
r_struct
id|atyfb_par
(brace
DECL|member|crtc
r_struct
id|crtc
id|crtc
suffix:semicolon
DECL|member|pll
r_union
id|aty_pll
id|pll
suffix:semicolon
DECL|member|accel_flags
id|u32
id|accel_flags
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|aty_cursor
r_struct
id|aty_cursor
(brace
DECL|member|enable
r_int
id|enable
suffix:semicolon
DECL|member|on
r_int
id|on
suffix:semicolon
DECL|member|vbl_cnt
r_int
id|vbl_cnt
suffix:semicolon
DECL|member|blink_rate
r_int
id|blink_rate
suffix:semicolon
DECL|member|offset
id|u32
id|offset
suffix:semicolon
r_struct
(brace
DECL|member|x
DECL|member|y
id|u16
id|x
comma
id|y
suffix:semicolon
DECL|member|pos
DECL|member|hot
DECL|member|size
)brace
id|pos
comma
id|hot
comma
id|size
suffix:semicolon
DECL|member|color
id|u32
id|color
(braket
l_int|2
)braket
suffix:semicolon
DECL|member|bits
id|u8
id|bits
(braket
l_int|8
)braket
(braket
l_int|64
)braket
suffix:semicolon
DECL|member|mask
id|u8
id|mask
(braket
l_int|8
)braket
(braket
l_int|64
)braket
suffix:semicolon
DECL|member|ram
id|u8
op_star
id|ram
suffix:semicolon
DECL|member|timer
r_struct
id|timer_list
op_star
id|timer
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|fb_info_aty
r_struct
id|fb_info_aty
(brace
DECL|member|fb_info
r_struct
id|fb_info
id|fb_info
suffix:semicolon
DECL|member|next
r_struct
id|fb_info_aty
op_star
id|next
suffix:semicolon
DECL|member|ati_regbase_phys
r_int
r_int
id|ati_regbase_phys
suffix:semicolon
DECL|member|ati_regbase
r_int
r_int
id|ati_regbase
suffix:semicolon
DECL|member|frame_buffer_phys
r_int
r_int
id|frame_buffer_phys
suffix:semicolon
DECL|member|frame_buffer
r_int
r_int
id|frame_buffer
suffix:semicolon
DECL|member|clk_wr_offset
r_int
r_int
id|clk_wr_offset
suffix:semicolon
DECL|member|mmap_map
r_struct
id|pci_mmap_map
op_star
id|mmap_map
suffix:semicolon
DECL|member|cursor
r_struct
id|aty_cursor
op_star
id|cursor
suffix:semicolon
DECL|member|aty_cmap_regs
r_struct
id|aty_cmap_regs
op_star
id|aty_cmap_regs
suffix:semicolon
DECL|member|red
DECL|member|green
DECL|member|blue
DECL|member|pad
DECL|member|palette
r_struct
(brace
id|u8
id|red
comma
id|green
comma
id|blue
comma
id|pad
suffix:semicolon
)brace
id|palette
(braket
l_int|256
)braket
suffix:semicolon
DECL|member|default_par
r_struct
id|atyfb_par
id|default_par
suffix:semicolon
DECL|member|current_par
r_struct
id|atyfb_par
id|current_par
suffix:semicolon
DECL|member|features
id|u32
id|features
suffix:semicolon
DECL|member|total_vram
id|u32
id|total_vram
suffix:semicolon
DECL|member|ref_clk_per
id|u32
id|ref_clk_per
suffix:semicolon
DECL|member|pll_per
id|u32
id|pll_per
suffix:semicolon
DECL|member|mclk_per
id|u32
id|mclk_per
suffix:semicolon
DECL|member|bus_type
id|u8
id|bus_type
suffix:semicolon
DECL|member|ram_type
id|u8
id|ram_type
suffix:semicolon
DECL|member|mem_refresh_rate
id|u8
id|mem_refresh_rate
suffix:semicolon
DECL|member|dac_ops
r_const
r_struct
id|aty_dac_ops
op_star
id|dac_ops
suffix:semicolon
DECL|member|pll_ops
r_const
r_struct
id|aty_pll_ops
op_star
id|pll_ops
suffix:semicolon
DECL|member|disp
r_struct
id|display
id|disp
suffix:semicolon
DECL|member|dispsw
r_struct
id|display_switch
id|dispsw
suffix:semicolon
r_union
(brace
macro_line|#ifdef FBCON_HAS_CFB16
DECL|member|cfb16
id|u16
id|cfb16
(braket
l_int|16
)braket
suffix:semicolon
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB24
DECL|member|cfb24
id|u32
id|cfb24
(braket
l_int|16
)braket
suffix:semicolon
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB32
DECL|member|cfb32
id|u32
id|cfb32
(braket
l_int|16
)braket
suffix:semicolon
macro_line|#endif
DECL|member|fbcon_cmap
)brace
id|fbcon_cmap
suffix:semicolon
DECL|member|blitter_may_be_busy
id|u8
id|blitter_may_be_busy
suffix:semicolon
macro_line|#ifdef __sparc__
DECL|member|mmaped
id|u8
id|mmaped
suffix:semicolon
DECL|member|open
r_int
id|open
suffix:semicolon
DECL|member|vtconsole
r_int
id|vtconsole
suffix:semicolon
DECL|member|consolecnt
r_int
id|consolecnt
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_PMAC_PBOOK
DECL|member|save_framebuffer
r_int
r_char
op_star
id|save_framebuffer
suffix:semicolon
DECL|member|save_pll
r_int
r_int
id|save_pll
(braket
l_int|64
)braket
suffix:semicolon
macro_line|#endif
)brace
suffix:semicolon
multiline_comment|/*&n;     *  ATI Mach64 features&n;     */
DECL|macro|M64_HAS
mdefine_line|#define M64_HAS(feature)&t;((info)-&gt;features &amp; (M64F_##feature))
DECL|macro|M64F_RESET_3D
mdefine_line|#define M64F_RESET_3D&t;&t;0x00000001
DECL|macro|M64F_MAGIC_FIFO
mdefine_line|#define M64F_MAGIC_FIFO&t;&t;0x00000002
DECL|macro|M64F_GTB_DSP
mdefine_line|#define M64F_GTB_DSP&t;&t;0x00000004
DECL|macro|M64F_FIFO_24
mdefine_line|#define M64F_FIFO_24&t;&t;0x00000008
DECL|macro|M64F_SDRAM_MAGIC_PLL
mdefine_line|#define M64F_SDRAM_MAGIC_PLL&t;0x00000010
DECL|macro|M64F_MAGIC_POSTDIV
mdefine_line|#define M64F_MAGIC_POSTDIV&t;0x00000020
DECL|macro|M64F_INTEGRATED
mdefine_line|#define M64F_INTEGRATED&t;&t;0x00000040
DECL|macro|M64F_CT_BUS
mdefine_line|#define M64F_CT_BUS&t;&t;0x00000080
DECL|macro|M64F_VT_BUS
mdefine_line|#define M64F_VT_BUS&t;&t;0x00000100
DECL|macro|M64F_MOBIL_BUS
mdefine_line|#define M64F_MOBIL_BUS&t;&t;0x00000200
DECL|macro|M64F_GX
mdefine_line|#define M64F_GX&t;&t;&t;0x00000400
DECL|macro|M64F_CT
mdefine_line|#define M64F_CT&t;&t;&t;0x00000800
DECL|macro|M64F_VT
mdefine_line|#define M64F_VT&t;&t;&t;0x00001000
DECL|macro|M64F_GT
mdefine_line|#define M64F_GT&t;&t;&t;0x00002000
DECL|macro|M64F_MAGIC_VRAM_SIZE
mdefine_line|#define M64F_MAGIC_VRAM_SIZE&t;0x00004000
DECL|macro|M64F_G3_PB_1_1
mdefine_line|#define M64F_G3_PB_1_1&t;&t;0x00008000
DECL|macro|M64F_G3_PB_1024x768
mdefine_line|#define M64F_G3_PB_1024x768&t;0x00010000
DECL|macro|M64F_EXTRA_BRIGHT
mdefine_line|#define M64F_EXTRA_BRIGHT&t;0x00020000
DECL|macro|M64F_LT_SLEEP
mdefine_line|#define M64F_LT_SLEEP&t;&t;0x00040000
DECL|macro|M64F_XL_DLL
mdefine_line|#define M64F_XL_DLL&t;&t;0x00080000
multiline_comment|/*&n;     *  Register access&n;     */
DECL|function|aty_ld_le32
r_static
r_inline
id|u32
id|aty_ld_le32
c_func
(paren
r_int
id|regindex
comma
r_const
r_struct
id|fb_info_aty
op_star
id|info
)paren
(brace
multiline_comment|/* Hack for bloc 1, should be cleanly optimized by compiler */
r_if
c_cond
(paren
id|regindex
op_ge
l_int|0x400
)paren
id|regindex
op_sub_assign
l_int|0x800
suffix:semicolon
macro_line|#if defined(__mc68000__)
r_return
id|le32_to_cpu
c_func
(paren
op_star
(paren
(paren
r_volatile
id|u32
op_star
)paren
(paren
id|info-&gt;ati_regbase
op_plus
id|regindex
)paren
)paren
)paren
suffix:semicolon
macro_line|#else
r_return
id|readl
(paren
id|info-&gt;ati_regbase
op_plus
id|regindex
)paren
suffix:semicolon
macro_line|#endif
)brace
DECL|function|aty_st_le32
r_static
r_inline
r_void
id|aty_st_le32
c_func
(paren
r_int
id|regindex
comma
id|u32
id|val
comma
r_const
r_struct
id|fb_info_aty
op_star
id|info
)paren
(brace
multiline_comment|/* Hack for bloc 1, should be cleanly optimized by compiler */
r_if
c_cond
(paren
id|regindex
op_ge
l_int|0x400
)paren
id|regindex
op_sub_assign
l_int|0x800
suffix:semicolon
macro_line|#if defined(__mc68000__)
op_star
(paren
(paren
r_volatile
id|u32
op_star
)paren
(paren
id|info-&gt;ati_regbase
op_plus
id|regindex
)paren
)paren
op_assign
id|cpu_to_le32
c_func
(paren
id|val
)paren
suffix:semicolon
macro_line|#else
id|writel
(paren
id|val
comma
id|info-&gt;ati_regbase
op_plus
id|regindex
)paren
suffix:semicolon
macro_line|#endif
)brace
DECL|function|aty_ld_8
r_static
r_inline
id|u8
id|aty_ld_8
c_func
(paren
r_int
id|regindex
comma
r_const
r_struct
id|fb_info_aty
op_star
id|info
)paren
(brace
multiline_comment|/* Hack for bloc 1, should be cleanly optimized by compiler */
r_if
c_cond
(paren
id|regindex
op_ge
l_int|0x400
)paren
id|regindex
op_sub_assign
l_int|0x800
suffix:semicolon
r_return
id|readb
(paren
id|info-&gt;ati_regbase
op_plus
id|regindex
)paren
suffix:semicolon
)brace
DECL|function|aty_st_8
r_static
r_inline
r_void
id|aty_st_8
c_func
(paren
r_int
id|regindex
comma
id|u8
id|val
comma
r_const
r_struct
id|fb_info_aty
op_star
id|info
)paren
(brace
multiline_comment|/* Hack for bloc 1, should be cleanly optimized by compiler */
r_if
c_cond
(paren
id|regindex
op_ge
l_int|0x400
)paren
id|regindex
op_sub_assign
l_int|0x800
suffix:semicolon
id|writeb
(paren
id|val
comma
id|info-&gt;ati_regbase
op_plus
id|regindex
)paren
suffix:semicolon
)brace
DECL|function|aty_ld_pll
r_static
r_inline
id|u8
id|aty_ld_pll
c_func
(paren
r_int
id|offset
comma
r_const
r_struct
id|fb_info_aty
op_star
id|info
)paren
(brace
id|u8
id|res
suffix:semicolon
multiline_comment|/* write addr byte */
id|aty_st_8
c_func
(paren
id|CLOCK_CNTL
op_plus
l_int|1
comma
(paren
id|offset
op_lshift
l_int|2
)paren
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* read the register value */
id|res
op_assign
id|aty_ld_8
c_func
(paren
id|CLOCK_CNTL
op_plus
l_int|2
comma
id|info
)paren
suffix:semicolon
r_return
id|res
suffix:semicolon
)brace
multiline_comment|/*&n;     *  DAC operations&n;     */
DECL|struct|aty_dac_ops
r_struct
id|aty_dac_ops
(brace
DECL|member|set_dac
r_int
(paren
op_star
id|set_dac
)paren
(paren
r_const
r_struct
id|fb_info_aty
op_star
id|info
comma
r_const
r_union
id|aty_pll
op_star
id|pll
comma
id|u32
id|bpp
comma
id|u32
id|accel
)paren
suffix:semicolon
)brace
suffix:semicolon
r_extern
r_const
r_struct
id|aty_dac_ops
id|aty_dac_ibm514
suffix:semicolon
multiline_comment|/* IBM RGB514 */
r_extern
r_const
r_struct
id|aty_dac_ops
id|aty_dac_ati68860b
suffix:semicolon
multiline_comment|/* ATI 68860-B */
r_extern
r_const
r_struct
id|aty_dac_ops
id|aty_dac_att21c498
suffix:semicolon
multiline_comment|/* AT&amp;T 21C498 */
r_extern
r_const
r_struct
id|aty_dac_ops
id|aty_dac_unsupported
suffix:semicolon
multiline_comment|/* unsupported */
r_extern
r_const
r_struct
id|aty_dac_ops
id|aty_dac_ct
suffix:semicolon
multiline_comment|/* Integrated */
multiline_comment|/*&n;     *  Clock operations&n;     */
DECL|struct|aty_pll_ops
r_struct
id|aty_pll_ops
(brace
DECL|member|var_to_pll
r_int
(paren
op_star
id|var_to_pll
)paren
(paren
r_const
r_struct
id|fb_info_aty
op_star
id|info
comma
id|u32
id|vclk_per
comma
id|u8
id|bpp
comma
r_union
id|aty_pll
op_star
id|pll
)paren
suffix:semicolon
DECL|member|pll_to_var
id|u32
(paren
op_star
id|pll_to_var
)paren
(paren
r_const
r_struct
id|fb_info_aty
op_star
id|info
comma
r_const
r_union
id|aty_pll
op_star
id|pll
)paren
suffix:semicolon
DECL|member|set_pll
r_void
(paren
op_star
id|set_pll
)paren
(paren
r_const
r_struct
id|fb_info_aty
op_star
id|info
comma
r_const
r_union
id|aty_pll
op_star
id|pll
)paren
suffix:semicolon
)brace
suffix:semicolon
r_extern
r_const
r_struct
id|aty_pll_ops
id|aty_pll_ati18818_1
suffix:semicolon
multiline_comment|/* ATI 18818 */
r_extern
r_const
r_struct
id|aty_pll_ops
id|aty_pll_stg1703
suffix:semicolon
multiline_comment|/* STG 1703 */
r_extern
r_const
r_struct
id|aty_pll_ops
id|aty_pll_ch8398
suffix:semicolon
multiline_comment|/* Chrontel 8398 */
r_extern
r_const
r_struct
id|aty_pll_ops
id|aty_pll_att20c408
suffix:semicolon
multiline_comment|/* AT&amp;T 20C408 */
r_extern
r_const
r_struct
id|aty_pll_ops
id|aty_pll_ibm514
suffix:semicolon
multiline_comment|/* IBM RGB514 */
r_extern
r_const
r_struct
id|aty_pll_ops
id|aty_pll_unsupported
suffix:semicolon
multiline_comment|/* unsupported */
r_extern
r_const
r_struct
id|aty_pll_ops
id|aty_pll_ct
suffix:semicolon
multiline_comment|/* Integrated */
r_extern
r_void
id|aty_set_pll_ct
c_func
(paren
r_const
r_struct
id|fb_info_aty
op_star
id|info
comma
r_const
r_union
id|aty_pll
op_star
id|pll
)paren
suffix:semicolon
r_extern
r_void
id|aty_calc_pll_ct
c_func
(paren
r_const
r_struct
id|fb_info_aty
op_star
id|info
comma
r_struct
id|pll_ct
op_star
id|pll
)paren
suffix:semicolon
multiline_comment|/*&n;     *  Hardware cursor support&n;     */
r_extern
r_struct
id|aty_cursor
op_star
id|aty_init_cursor
c_func
(paren
r_struct
id|fb_info_aty
op_star
id|fb
)paren
suffix:semicolon
r_extern
r_void
id|atyfb_cursor
c_func
(paren
r_struct
id|display
op_star
id|p
comma
r_int
id|mode
comma
r_int
id|x
comma
r_int
id|y
)paren
suffix:semicolon
r_extern
r_void
id|aty_set_cursor_color
c_func
(paren
r_struct
id|fb_info_aty
op_star
id|fb
)paren
suffix:semicolon
r_extern
r_void
id|aty_set_cursor_shape
c_func
(paren
r_struct
id|fb_info_aty
op_star
id|fb
)paren
suffix:semicolon
r_extern
r_int
id|atyfb_set_font
c_func
(paren
r_struct
id|display
op_star
id|d
comma
r_int
id|width
comma
r_int
id|height
)paren
suffix:semicolon
multiline_comment|/*&n;     *  Hardware acceleration&n;     */
DECL|function|wait_for_fifo
r_static
r_inline
r_void
id|wait_for_fifo
c_func
(paren
id|u16
id|entries
comma
r_const
r_struct
id|fb_info_aty
op_star
id|info
)paren
(brace
r_while
c_loop
(paren
(paren
id|aty_ld_le32
c_func
(paren
id|FIFO_STAT
comma
id|info
)paren
op_amp
l_int|0xffff
)paren
OG
(paren
(paren
id|u32
)paren
(paren
l_int|0x8000
op_rshift
id|entries
)paren
)paren
)paren
suffix:semicolon
)brace
DECL|function|wait_for_idle
r_static
r_inline
r_void
id|wait_for_idle
c_func
(paren
r_struct
id|fb_info_aty
op_star
id|info
)paren
(brace
id|wait_for_fifo
c_func
(paren
l_int|16
comma
id|info
)paren
suffix:semicolon
r_while
c_loop
(paren
(paren
id|aty_ld_le32
c_func
(paren
id|GUI_STAT
comma
id|info
)paren
op_amp
l_int|1
)paren
op_ne
l_int|0
)paren
suffix:semicolon
id|info-&gt;blitter_may_be_busy
op_assign
l_int|0
suffix:semicolon
)brace
r_extern
r_void
id|aty_reset_engine
c_func
(paren
r_const
r_struct
id|fb_info_aty
op_star
id|info
)paren
suffix:semicolon
r_extern
r_void
id|aty_init_engine
c_func
(paren
r_const
r_struct
id|atyfb_par
op_star
id|par
comma
r_struct
id|fb_info_aty
op_star
id|info
)paren
suffix:semicolon
r_extern
r_void
id|aty_rectfill
c_func
(paren
r_int
id|dstx
comma
r_int
id|dsty
comma
id|u_int
id|width
comma
id|u_int
id|height
comma
id|u_int
id|color
comma
r_struct
id|fb_info_aty
op_star
id|info
)paren
suffix:semicolon
multiline_comment|/*&n;     *  Text console acceleration&n;     */
r_extern
r_const
r_struct
id|display_switch
id|fbcon_aty8
suffix:semicolon
r_extern
r_const
r_struct
id|display_switch
id|fbcon_aty16
suffix:semicolon
r_extern
r_const
r_struct
id|display_switch
id|fbcon_aty24
suffix:semicolon
r_extern
r_const
r_struct
id|display_switch
id|fbcon_aty32
suffix:semicolon
eof
