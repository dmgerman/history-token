multiline_comment|/*&n; *  linux/drivers/video/fbmem.c&n; *&n; *  Copyright (C) 1994 Martin Schaller&n; *&n; *&t;2001 - Documented with DocBook&n; *&t;- Brad Douglas &lt;brad@neruo.com&gt;&n; *&n; * This file is subject to the terms and conditions of the GNU General Public&n; * License.  See the file COPYING in the main directory of this archive&n; * for more details.&n; */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/types.h&gt;
macro_line|#include &lt;linux/errno.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/smp_lock.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/major.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;linux/mman.h&gt;
macro_line|#include &lt;linux/tty.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/linux_logo.h&gt;
macro_line|#include &lt;linux/proc_fs.h&gt;
macro_line|#include &lt;linux/console.h&gt;
macro_line|#ifdef CONFIG_KMOD
macro_line|#include &lt;linux/kmod.h&gt;
macro_line|#endif
macro_line|#include &lt;linux/devfs_fs_kernel.h&gt;
macro_line|#include &lt;linux/err.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/device.h&gt;
macro_line|#if defined(__mc68000__) || defined(CONFIG_APUS)
macro_line|#include &lt;asm/setup.h&gt;
macro_line|#endif
macro_line|#include &lt;asm/io.h&gt;
macro_line|#include &lt;asm/uaccess.h&gt;
macro_line|#include &lt;asm/page.h&gt;
macro_line|#include &lt;asm/pgtable.h&gt;
macro_line|#include &lt;linux/fb.h&gt;
macro_line|#ifdef CONFIG_FRAMEBUFFER_CONSOLE
macro_line|#include &quot;console/fbcon.h&quot;
macro_line|#endif
multiline_comment|/*&n;     *  Frame buffer device initialization and setup routines&n;     */
r_extern
r_int
id|acornfb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|acornfb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|amifb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|amifb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|atafb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|atafb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|macfb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|macfb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|cyberfb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|cyberfb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|pm2fb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|pm2fb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|pm3fb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|pm3fb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|clps711xfb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|cyber2000fb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|cyber2000fb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|retz3fb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|retz3fb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|cirrusfb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|cirrusfb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|hitfb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|vfb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|vfb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|offb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|atyfb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|atyfb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|aty128fb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|aty128fb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|neofb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|neofb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|igafb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|igafb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|imsttfb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|imsttfb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|dnfb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|tgafb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|tgafb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|virgefb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|virgefb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|resolver_video_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|s3triofb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|vesafb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|vesafb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|vga16fb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|vga16fb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|hgafb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|hgafb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|matroxfb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|matroxfb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|hpfb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|platinumfb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|platinumfb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|control_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|control_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|valkyriefb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|valkyriefb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|chips_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|g364fb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|sa1100fb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|pxafb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|pxafb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|fm2fb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|fm2fb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|q40fb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|sun3fb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|sun3fb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|sgivwfb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|sgivwfb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|gbefb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|gbefb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|rivafb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|rivafb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|tdfxfb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|tdfxfb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|tridentfb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|tridentfb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|sisfb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|sisfb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|stifb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|stifb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|pmagbafb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|pmagbbfb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|maxinefb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|tx3912fb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|tx3912fb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|radeonfb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|radeonfb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|radeonfb_old_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|radeonfb_old_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|e1355fb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|e1355fb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|pvr2fb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|pvr2fb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|sstfb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|sstfb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|i810fb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|i810fb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|ffb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|ffb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|cg6_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|cg6_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|cg3_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|cg3_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|bw2_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|bw2_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|cg14_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|cg14_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|p9100_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|p9100_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|tcx_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|tcx_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|leo_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|leo_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|kyrofb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|kyrofb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|mc68x328fb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|mc68x328fb_setup
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|asiliantfb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_static
r_struct
(brace
DECL|member|name
r_const
r_char
op_star
id|name
suffix:semicolon
DECL|member|init
r_int
(paren
op_star
id|init
)paren
(paren
r_void
)paren
suffix:semicolon
DECL|member|setup
r_int
(paren
op_star
id|setup
)paren
(paren
r_char
op_star
)paren
suffix:semicolon
DECL|variable|__initdata
)brace
id|fb_drivers
(braket
)braket
id|__initdata
op_assign
(brace
multiline_comment|/*&n;&t; * Chipset specific drivers that use resource management&n;&t; */
macro_line|#ifdef CONFIG_FB_RETINAZ3
(brace
l_string|&quot;retz3fb&quot;
comma
id|retz3fb_init
comma
id|retz3fb_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_AMIGA
(brace
l_string|&quot;amifb&quot;
comma
id|amifb_init
comma
id|amifb_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_CLPS711X
(brace
l_string|&quot;clps711xfb&quot;
comma
id|clps711xfb_init
comma
l_int|NULL
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_CYBER
(brace
l_string|&quot;cyberfb&quot;
comma
id|cyberfb_init
comma
id|cyberfb_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_CYBER2000
(brace
l_string|&quot;cyber2000fb&quot;
comma
id|cyber2000fb_init
comma
id|cyber2000fb_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_PM2
(brace
l_string|&quot;pm2fb&quot;
comma
id|pm2fb_init
comma
id|pm2fb_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_PM3
(brace
l_string|&quot;pm3fb&quot;
comma
id|pm3fb_init
comma
id|pm3fb_setup
)brace
comma
macro_line|#endif           
macro_line|#ifdef CONFIG_FB_CIRRUS
(brace
l_string|&quot;cirrusfb&quot;
comma
id|cirrusfb_init
comma
id|cirrusfb_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_ATY
(brace
l_string|&quot;atyfb&quot;
comma
id|atyfb_init
comma
id|atyfb_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_MATROX
(brace
l_string|&quot;matroxfb&quot;
comma
id|matroxfb_init
comma
id|matroxfb_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_ATY128
(brace
l_string|&quot;aty128fb&quot;
comma
id|aty128fb_init
comma
id|aty128fb_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_NEOMAGIC
(brace
l_string|&quot;neofb&quot;
comma
id|neofb_init
comma
id|neofb_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_VIRGE
(brace
l_string|&quot;virgefb&quot;
comma
id|virgefb_init
comma
id|virgefb_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_RIVA
(brace
l_string|&quot;rivafb&quot;
comma
id|rivafb_init
comma
id|rivafb_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_3DFX
(brace
l_string|&quot;tdfxfb&quot;
comma
id|tdfxfb_init
comma
id|tdfxfb_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_RADEON
(brace
l_string|&quot;radeonfb&quot;
comma
id|radeonfb_init
comma
id|radeonfb_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_RADEON_OLD
(brace
l_string|&quot;radeonfb_old&quot;
comma
id|radeonfb_old_init
comma
id|radeonfb_old_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_CONTROL
(brace
l_string|&quot;controlfb&quot;
comma
id|control_init
comma
id|control_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_PLATINUM
(brace
l_string|&quot;platinumfb&quot;
comma
id|platinumfb_init
comma
id|platinumfb_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_VALKYRIE
(brace
l_string|&quot;valkyriefb&quot;
comma
id|valkyriefb_init
comma
id|valkyriefb_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_CT65550
(brace
l_string|&quot;chipsfb&quot;
comma
id|chips_init
comma
l_int|NULL
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_IMSTT
(brace
l_string|&quot;imsttfb&quot;
comma
id|imsttfb_init
comma
id|imsttfb_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_S3TRIO
(brace
l_string|&quot;s3triofb&quot;
comma
id|s3triofb_init
comma
l_int|NULL
)brace
comma
macro_line|#endif 
macro_line|#ifdef CONFIG_FB_FM2
(brace
l_string|&quot;fm2fb&quot;
comma
id|fm2fb_init
comma
id|fm2fb_setup
)brace
comma
macro_line|#endif 
macro_line|#ifdef CONFIG_FB_SIS
(brace
l_string|&quot;sisfb&quot;
comma
id|sisfb_init
comma
id|sisfb_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_TRIDENT
(brace
l_string|&quot;tridentfb&quot;
comma
id|tridentfb_init
comma
id|tridentfb_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_I810
(brace
l_string|&quot;i810fb&quot;
comma
id|i810fb_init
comma
id|i810fb_setup
)brace
comma
macro_line|#endif&t;
macro_line|#ifdef CONFIG_FB_STI
(brace
l_string|&quot;stifb&quot;
comma
id|stifb_init
comma
id|stifb_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_FFB
(brace
l_string|&quot;ffb&quot;
comma
id|ffb_init
comma
id|ffb_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_CG6
(brace
l_string|&quot;cg6fb&quot;
comma
id|cg6_init
comma
id|cg6_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_CG3
(brace
l_string|&quot;cg3fb&quot;
comma
id|cg3_init
comma
id|cg3_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_BW2
(brace
l_string|&quot;bw2fb&quot;
comma
id|bw2_init
comma
id|bw2_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_CG14
(brace
l_string|&quot;cg14fb&quot;
comma
id|cg14_init
comma
id|cg14_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_P9100
(brace
l_string|&quot;p9100fb&quot;
comma
id|p9100_init
comma
id|p9100_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_TCX
(brace
l_string|&quot;tcxfb&quot;
comma
id|tcx_init
comma
id|tcx_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_LEO
(brace
l_string|&quot;leofb&quot;
comma
id|leo_init
comma
id|leo_setup
)brace
comma
macro_line|#endif
multiline_comment|/*&n;&t; * Generic drivers that are used as fallbacks&n;&t; * &n;&t; * These depend on resource management and must be initialized&n;&t; * _after_ all other frame buffer devices that use resource&n;&t; * management!&n;&t; */
macro_line|#ifdef CONFIG_FB_OF
(brace
l_string|&quot;offb&quot;
comma
id|offb_init
comma
l_int|NULL
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_VESA
(brace
l_string|&quot;vesafb&quot;
comma
id|vesafb_init
comma
id|vesafb_setup
)brace
comma
macro_line|#endif 
multiline_comment|/*&n;&t; * Chipset specific drivers that don&squot;t use resource management (yet)&n;&t; */
macro_line|#ifdef CONFIG_FB_SGIVW
(brace
l_string|&quot;sgivwfb&quot;
comma
id|sgivwfb_init
comma
id|sgivwfb_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_GBE
(brace
l_string|&quot;gbefb&quot;
comma
id|gbefb_init
comma
id|gbefb_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_ACORN
(brace
l_string|&quot;acornfb&quot;
comma
id|acornfb_init
comma
id|acornfb_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_ATARI
(brace
l_string|&quot;atafb&quot;
comma
id|atafb_init
comma
id|atafb_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_MAC
(brace
l_string|&quot;macfb&quot;
comma
id|macfb_init
comma
id|macfb_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_HGA
(brace
l_string|&quot;hgafb&quot;
comma
id|hgafb_init
comma
id|hgafb_setup
)brace
comma
macro_line|#endif 
macro_line|#ifdef CONFIG_FB_IGA
(brace
l_string|&quot;igafb&quot;
comma
id|igafb_init
comma
id|igafb_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_APOLLO
(brace
l_string|&quot;apollofb&quot;
comma
id|dnfb_init
comma
l_int|NULL
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_Q40
(brace
l_string|&quot;q40fb&quot;
comma
id|q40fb_init
comma
l_int|NULL
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_TGA
(brace
l_string|&quot;tgafb&quot;
comma
id|tgafb_init
comma
id|tgafb_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_HP300
(brace
l_string|&quot;hpfb&quot;
comma
id|hpfb_init
comma
l_int|NULL
)brace
comma
macro_line|#endif 
macro_line|#ifdef CONFIG_FB_G364
(brace
l_string|&quot;g364fb&quot;
comma
id|g364fb_init
comma
l_int|NULL
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_SA1100
(brace
l_string|&quot;sa1100fb&quot;
comma
id|sa1100fb_init
comma
l_int|NULL
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_PXA
(brace
l_string|&quot;pxafb&quot;
comma
id|pxafb_init
comma
id|pxafb_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_SUN3
(brace
l_string|&quot;sun3fb&quot;
comma
id|sun3fb_init
comma
id|sun3fb_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_HIT
(brace
l_string|&quot;hitfb&quot;
comma
id|hitfb_init
comma
l_int|NULL
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_TX3912
(brace
l_string|&quot;tx3912fb&quot;
comma
id|tx3912fb_init
comma
id|tx3912fb_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_E1355
(brace
l_string|&quot;e1355fb&quot;
comma
id|e1355fb_init
comma
id|e1355fb_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_PVR2
(brace
l_string|&quot;pvr2fb&quot;
comma
id|pvr2fb_init
comma
id|pvr2fb_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_PMAG_BA
(brace
l_string|&quot;pmagbafb&quot;
comma
id|pmagbafb_init
comma
l_int|NULL
)brace
comma
macro_line|#endif          
macro_line|#ifdef CONFIG_FB_PMAGB_B
(brace
l_string|&quot;pmagbbfb&quot;
comma
id|pmagbbfb_init
comma
l_int|NULL
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_MAXINE
(brace
l_string|&quot;maxinefb&quot;
comma
id|maxinefb_init
comma
l_int|NULL
)brace
comma
macro_line|#endif            
macro_line|#ifdef CONFIG_FB_VOODOO1
(brace
l_string|&quot;sstfb&quot;
comma
id|sstfb_init
comma
id|sstfb_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_KYRO
(brace
l_string|&quot;kyrofb&quot;
comma
id|kyrofb_init
comma
id|kyrofb_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_68328
(brace
l_string|&quot;68328fb&quot;
comma
id|mc68x328fb_init
comma
id|mc68x328fb_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_ASILIANT
(brace
l_string|&quot;asiliantfb&quot;
comma
id|asiliantfb_init
comma
l_int|NULL
)brace
comma
macro_line|#endif
multiline_comment|/*&n;&t; * Generic drivers that don&squot;t use resource management (yet)&n;&t; */
macro_line|#ifdef CONFIG_FB_VGA16
(brace
l_string|&quot;vga16fb&quot;
comma
id|vga16fb_init
comma
id|vga16fb_setup
)brace
comma
macro_line|#endif 
macro_line|#ifdef CONFIG_GSP_RESOLVER
multiline_comment|/* Not a real frame buffer device... */
(brace
l_string|&quot;resolverfb&quot;
comma
l_int|NULL
comma
id|resolver_video_setup
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_VIRTUAL
multiline_comment|/*&n;&t; * Vfb must be last to avoid that it becomes your primary display if&n;&t; * other display devices are present&n;&t; */
(brace
l_string|&quot;vfb&quot;
comma
id|vfb_init
comma
id|vfb_setup
)brace
comma
macro_line|#endif
)brace
suffix:semicolon
DECL|macro|NUM_FB_DRIVERS
mdefine_line|#define NUM_FB_DRIVERS&t;(sizeof(fb_drivers)/sizeof(*fb_drivers))
DECL|macro|FBPIXMAPSIZE
mdefine_line|#define FBPIXMAPSIZE&t;16384
r_extern
r_const
r_char
op_star
id|global_mode_option
suffix:semicolon
DECL|variable|pref_init_funcs
r_static
id|initcall_t
id|pref_init_funcs
(braket
id|FB_MAX
)braket
suffix:semicolon
DECL|variable|__initdata
r_static
r_int
id|num_pref_init_funcs
id|__initdata
op_assign
l_int|0
suffix:semicolon
DECL|variable|fb_notifier_list
r_static
r_struct
id|notifier_block
op_star
id|fb_notifier_list
suffix:semicolon
DECL|variable|registered_fb
r_struct
id|fb_info
op_star
id|registered_fb
(braket
id|FB_MAX
)braket
suffix:semicolon
DECL|variable|num_registered_fb
r_int
id|num_registered_fb
suffix:semicolon
macro_line|#ifdef CONFIG_FB_OF
DECL|variable|__initdata
r_static
r_int
id|ofonly
id|__initdata
op_assign
l_int|0
suffix:semicolon
macro_line|#endif
multiline_comment|/*&n; * Drawing helpers.&n; */
DECL|function|fb_iomove_buf_aligned
r_void
id|fb_iomove_buf_aligned
c_func
(paren
r_struct
id|fb_info
op_star
id|info
comma
r_struct
id|fb_pixmap
op_star
id|buf
comma
id|u8
op_star
id|dst
comma
id|u32
id|d_pitch
comma
id|u8
op_star
id|src
comma
id|u32
id|s_pitch
comma
id|u32
id|height
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
id|height
suffix:semicolon
id|i
op_decrement
suffix:semicolon
)paren
(brace
id|buf
op_member_access_from_pointer
id|outbuf
c_func
(paren
id|info
comma
id|dst
comma
id|src
comma
id|s_pitch
)paren
suffix:semicolon
id|src
op_add_assign
id|s_pitch
suffix:semicolon
id|dst
op_add_assign
id|d_pitch
suffix:semicolon
)brace
)brace
DECL|function|fb_sysmove_buf_aligned
r_void
id|fb_sysmove_buf_aligned
c_func
(paren
r_struct
id|fb_info
op_star
id|info
comma
r_struct
id|fb_pixmap
op_star
id|buf
comma
id|u8
op_star
id|dst
comma
id|u32
id|d_pitch
comma
id|u8
op_star
id|src
comma
id|u32
id|s_pitch
comma
id|u32
id|height
)paren
(brace
r_int
id|i
comma
id|j
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
id|height
suffix:semicolon
id|i
op_decrement
suffix:semicolon
)paren
(brace
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
id|s_pitch
suffix:semicolon
id|j
op_increment
)paren
id|dst
(braket
id|j
)braket
op_assign
id|src
(braket
id|j
)braket
suffix:semicolon
id|src
op_add_assign
id|s_pitch
suffix:semicolon
id|dst
op_add_assign
id|d_pitch
suffix:semicolon
)brace
)brace
DECL|function|fb_iomove_buf_unaligned
r_void
id|fb_iomove_buf_unaligned
c_func
(paren
r_struct
id|fb_info
op_star
id|info
comma
r_struct
id|fb_pixmap
op_star
id|buf
comma
id|u8
op_star
id|dst
comma
id|u32
id|d_pitch
comma
id|u8
op_star
id|src
comma
id|u32
id|idx
comma
id|u32
id|height
comma
id|u32
id|shift_high
comma
id|u32
id|shift_low
comma
id|u32
id|mod
)paren
(brace
id|u8
id|mask
op_assign
(paren
id|u8
)paren
(paren
l_int|0xfff
op_lshift
id|shift_high
)paren
comma
id|tmp
suffix:semicolon
r_int
id|i
comma
id|j
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
id|height
suffix:semicolon
id|i
op_decrement
suffix:semicolon
)paren
(brace
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
id|idx
suffix:semicolon
id|j
op_increment
)paren
(brace
id|tmp
op_assign
id|buf
op_member_access_from_pointer
id|inbuf
c_func
(paren
id|info
comma
id|dst
op_plus
id|j
)paren
suffix:semicolon
id|tmp
op_and_assign
id|mask
suffix:semicolon
id|tmp
op_or_assign
op_star
id|src
op_rshift
id|shift_low
suffix:semicolon
id|buf
op_member_access_from_pointer
id|outbuf
c_func
(paren
id|info
comma
id|dst
op_plus
id|j
comma
op_amp
id|tmp
comma
l_int|1
)paren
suffix:semicolon
id|tmp
op_assign
op_star
id|src
op_lshift
id|shift_high
suffix:semicolon
id|buf
op_member_access_from_pointer
id|outbuf
c_func
(paren
id|info
comma
id|dst
op_plus
id|j
op_plus
l_int|1
comma
op_amp
id|tmp
comma
l_int|1
)paren
suffix:semicolon
id|src
op_increment
suffix:semicolon
)brace
id|tmp
op_assign
id|buf
op_member_access_from_pointer
id|inbuf
c_func
(paren
id|info
comma
id|dst
op_plus
id|idx
)paren
suffix:semicolon
id|tmp
op_and_assign
id|mask
suffix:semicolon
id|tmp
op_or_assign
op_star
id|src
op_rshift
id|shift_low
suffix:semicolon
id|buf
op_member_access_from_pointer
id|outbuf
c_func
(paren
id|info
comma
id|dst
op_plus
id|idx
comma
op_amp
id|tmp
comma
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|shift_high
OL
id|mod
)paren
(brace
id|tmp
op_assign
op_star
id|src
op_lshift
id|shift_high
suffix:semicolon
id|buf
op_member_access_from_pointer
id|outbuf
c_func
(paren
id|info
comma
id|dst
op_plus
id|idx
op_plus
l_int|1
comma
op_amp
id|tmp
comma
l_int|1
)paren
suffix:semicolon
)brace
id|src
op_increment
suffix:semicolon
id|dst
op_add_assign
id|d_pitch
suffix:semicolon
)brace
)brace
DECL|function|fb_sysmove_buf_unaligned
r_void
id|fb_sysmove_buf_unaligned
c_func
(paren
r_struct
id|fb_info
op_star
id|info
comma
r_struct
id|fb_pixmap
op_star
id|buf
comma
id|u8
op_star
id|dst
comma
id|u32
id|d_pitch
comma
id|u8
op_star
id|src
comma
id|u32
id|idx
comma
id|u32
id|height
comma
id|u32
id|shift_high
comma
id|u32
id|shift_low
comma
id|u32
id|mod
)paren
(brace
id|u8
id|mask
op_assign
(paren
id|u8
)paren
(paren
l_int|0xfff
op_lshift
id|shift_high
)paren
comma
id|tmp
suffix:semicolon
r_int
id|i
comma
id|j
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
id|height
suffix:semicolon
id|i
op_decrement
suffix:semicolon
)paren
(brace
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
id|idx
suffix:semicolon
id|j
op_increment
)paren
(brace
id|tmp
op_assign
id|dst
(braket
id|j
)braket
suffix:semicolon
id|tmp
op_and_assign
id|mask
suffix:semicolon
id|tmp
op_or_assign
op_star
id|src
op_rshift
id|shift_low
suffix:semicolon
id|dst
(braket
id|j
)braket
op_assign
id|tmp
suffix:semicolon
id|tmp
op_assign
op_star
id|src
op_lshift
id|shift_high
suffix:semicolon
id|dst
(braket
id|j
op_plus
l_int|1
)braket
op_assign
id|tmp
suffix:semicolon
id|src
op_increment
suffix:semicolon
)brace
id|tmp
op_assign
id|dst
(braket
id|idx
)braket
suffix:semicolon
id|tmp
op_and_assign
id|mask
suffix:semicolon
id|tmp
op_or_assign
op_star
id|src
op_rshift
id|shift_low
suffix:semicolon
id|dst
(braket
id|idx
)braket
op_assign
id|tmp
suffix:semicolon
r_if
c_cond
(paren
id|shift_high
OL
id|mod
)paren
(brace
id|tmp
op_assign
op_star
id|src
op_lshift
id|shift_high
suffix:semicolon
id|dst
(braket
id|idx
op_plus
l_int|1
)braket
op_assign
id|tmp
suffix:semicolon
)brace
id|src
op_increment
suffix:semicolon
id|dst
op_add_assign
id|d_pitch
suffix:semicolon
)brace
)brace
multiline_comment|/*&n; * we need to lock this section since fb_cursor&n; * may use fb_imageblit()&n; */
DECL|function|fb_get_buffer_offset
r_char
op_star
id|fb_get_buffer_offset
c_func
(paren
r_struct
id|fb_info
op_star
id|info
comma
r_struct
id|fb_pixmap
op_star
id|buf
comma
id|u32
id|size
)paren
(brace
id|u32
id|align
op_assign
id|buf-&gt;buf_align
op_minus
l_int|1
comma
id|offset
suffix:semicolon
r_char
op_star
id|addr
op_assign
id|buf-&gt;addr
suffix:semicolon
multiline_comment|/* If IO mapped, we need to sync before access, no sharing of&n;&t; * the pixmap is done&n;&t; */
r_if
c_cond
(paren
id|buf-&gt;flags
op_amp
id|FB_PIXMAP_IO
)paren
(brace
r_if
c_cond
(paren
id|info-&gt;fbops-&gt;fb_sync
op_logical_and
(paren
id|buf-&gt;flags
op_amp
id|FB_PIXMAP_SYNC
)paren
)paren
id|info-&gt;fbops
op_member_access_from_pointer
id|fb_sync
c_func
(paren
id|info
)paren
suffix:semicolon
r_return
id|addr
suffix:semicolon
)brace
multiline_comment|/* See if we fit in the remaining pixmap space */
id|offset
op_assign
id|buf-&gt;offset
op_plus
id|align
suffix:semicolon
id|offset
op_and_assign
op_complement
id|align
suffix:semicolon
r_if
c_cond
(paren
id|offset
op_plus
id|size
OG
id|buf-&gt;size
)paren
(brace
multiline_comment|/* We do not fit. In order to be able to re-use the buffer,&n;&t;&t; * we must ensure no asynchronous DMA&squot;ing or whatever operation&n;&t;&t; * is in progress, we sync for that.&n;&t;&t; */
r_if
c_cond
(paren
id|info-&gt;fbops-&gt;fb_sync
op_logical_and
(paren
id|buf-&gt;flags
op_amp
id|FB_PIXMAP_SYNC
)paren
)paren
id|info-&gt;fbops
op_member_access_from_pointer
id|fb_sync
c_func
(paren
id|info
)paren
suffix:semicolon
id|offset
op_assign
l_int|0
suffix:semicolon
)brace
id|buf-&gt;offset
op_assign
id|offset
op_plus
id|size
suffix:semicolon
id|addr
op_add_assign
id|offset
suffix:semicolon
r_return
id|addr
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_LOGO
macro_line|#include &lt;linux/linux_logo.h&gt;
DECL|function|safe_shift
r_static
r_inline
r_int
id|safe_shift
c_func
(paren
r_int
id|d
comma
r_int
id|n
)paren
(brace
r_return
id|n
OL
l_int|0
ques
c_cond
id|d
op_rshift
op_minus
id|n
suffix:colon
id|d
op_lshift
id|n
suffix:semicolon
)brace
DECL|function|fb_set_logocmap
r_static
r_void
id|__init
id|fb_set_logocmap
c_func
(paren
r_struct
id|fb_info
op_star
id|info
comma
r_const
r_struct
id|linux_logo
op_star
id|logo
)paren
(brace
r_struct
id|fb_cmap
id|palette_cmap
suffix:semicolon
id|u16
id|palette_green
(braket
l_int|16
)braket
suffix:semicolon
id|u16
id|palette_blue
(braket
l_int|16
)braket
suffix:semicolon
id|u16
id|palette_red
(braket
l_int|16
)braket
suffix:semicolon
r_int
id|i
comma
id|j
comma
id|n
suffix:semicolon
r_const
r_int
r_char
op_star
id|clut
op_assign
id|logo-&gt;clut
suffix:semicolon
id|palette_cmap.start
op_assign
l_int|0
suffix:semicolon
id|palette_cmap.len
op_assign
l_int|16
suffix:semicolon
id|palette_cmap.red
op_assign
id|palette_red
suffix:semicolon
id|palette_cmap.green
op_assign
id|palette_green
suffix:semicolon
id|palette_cmap.blue
op_assign
id|palette_blue
suffix:semicolon
id|palette_cmap.transp
op_assign
l_int|NULL
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|logo-&gt;clutsize
suffix:semicolon
id|i
op_add_assign
id|n
)paren
(brace
id|n
op_assign
id|logo-&gt;clutsize
op_minus
id|i
suffix:semicolon
multiline_comment|/* palette_cmap provides space for only 16 colors at once */
r_if
c_cond
(paren
id|n
OG
l_int|16
)paren
id|n
op_assign
l_int|16
suffix:semicolon
id|palette_cmap.start
op_assign
l_int|32
op_plus
id|i
suffix:semicolon
id|palette_cmap.len
op_assign
id|n
suffix:semicolon
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
id|n
suffix:semicolon
op_increment
id|j
)paren
(brace
id|palette_cmap.red
(braket
id|j
)braket
op_assign
id|clut
(braket
l_int|0
)braket
op_lshift
l_int|8
op_or
id|clut
(braket
l_int|0
)braket
suffix:semicolon
id|palette_cmap.green
(braket
id|j
)braket
op_assign
id|clut
(braket
l_int|1
)braket
op_lshift
l_int|8
op_or
id|clut
(braket
l_int|1
)braket
suffix:semicolon
id|palette_cmap.blue
(braket
id|j
)braket
op_assign
id|clut
(braket
l_int|2
)braket
op_lshift
l_int|8
op_or
id|clut
(braket
l_int|2
)braket
suffix:semicolon
id|clut
op_add_assign
l_int|3
suffix:semicolon
)brace
id|fb_set_cmap
c_func
(paren
op_amp
id|palette_cmap
comma
l_int|1
comma
id|info
)paren
suffix:semicolon
)brace
)brace
DECL|function|fb_set_logo_truepalette
r_static
r_void
id|__init
id|fb_set_logo_truepalette
c_func
(paren
r_struct
id|fb_info
op_star
id|info
comma
r_const
r_struct
id|linux_logo
op_star
id|logo
comma
id|u32
op_star
id|palette
)paren
(brace
r_int
r_char
id|mask
(braket
l_int|9
)braket
op_assign
(brace
l_int|0
comma
l_int|0x80
comma
l_int|0xc0
comma
l_int|0xe0
comma
l_int|0xf0
comma
l_int|0xf8
comma
l_int|0xfc
comma
l_int|0xfe
comma
l_int|0xff
)brace
suffix:semicolon
r_int
r_char
id|redmask
comma
id|greenmask
comma
id|bluemask
suffix:semicolon
r_int
id|redshift
comma
id|greenshift
comma
id|blueshift
suffix:semicolon
r_int
id|i
suffix:semicolon
r_const
r_int
r_char
op_star
id|clut
op_assign
id|logo-&gt;clut
suffix:semicolon
multiline_comment|/*&n;&t; * We have to create a temporary palette since console palette is only&n;&t; * 16 colors long.&n;&t; */
multiline_comment|/* Bug: Doesn&squot;t obey msb_right ... (who needs that?) */
id|redmask
op_assign
id|mask
(braket
id|info-&gt;var.red.length
OL
l_int|8
ques
c_cond
id|info-&gt;var.red.length
suffix:colon
l_int|8
)braket
suffix:semicolon
id|greenmask
op_assign
id|mask
(braket
id|info-&gt;var.green.length
OL
l_int|8
ques
c_cond
id|info-&gt;var.green.length
suffix:colon
l_int|8
)braket
suffix:semicolon
id|bluemask
op_assign
id|mask
(braket
id|info-&gt;var.blue.length
OL
l_int|8
ques
c_cond
id|info-&gt;var.blue.length
suffix:colon
l_int|8
)braket
suffix:semicolon
id|redshift
op_assign
id|info-&gt;var.red.offset
op_minus
(paren
l_int|8
op_minus
id|info-&gt;var.red.length
)paren
suffix:semicolon
id|greenshift
op_assign
id|info-&gt;var.green.offset
op_minus
(paren
l_int|8
op_minus
id|info-&gt;var.green.length
)paren
suffix:semicolon
id|blueshift
op_assign
id|info-&gt;var.blue.offset
op_minus
(paren
l_int|8
op_minus
id|info-&gt;var.blue.length
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|logo-&gt;clutsize
suffix:semicolon
id|i
op_increment
)paren
(brace
id|palette
(braket
id|i
op_plus
l_int|32
)braket
op_assign
(paren
id|safe_shift
c_func
(paren
(paren
id|clut
(braket
l_int|0
)braket
op_amp
id|redmask
)paren
comma
id|redshift
)paren
op_or
id|safe_shift
c_func
(paren
(paren
id|clut
(braket
l_int|1
)braket
op_amp
id|greenmask
)paren
comma
id|greenshift
)paren
op_or
id|safe_shift
c_func
(paren
(paren
id|clut
(braket
l_int|2
)braket
op_amp
id|bluemask
)paren
comma
id|blueshift
)paren
)paren
suffix:semicolon
id|clut
op_add_assign
l_int|3
suffix:semicolon
)brace
)brace
DECL|function|fb_set_logo_directpalette
r_static
r_void
id|__init
id|fb_set_logo_directpalette
c_func
(paren
r_struct
id|fb_info
op_star
id|info
comma
r_const
r_struct
id|linux_logo
op_star
id|logo
comma
id|u32
op_star
id|palette
)paren
(brace
r_int
id|redshift
comma
id|greenshift
comma
id|blueshift
suffix:semicolon
r_int
id|i
suffix:semicolon
id|redshift
op_assign
id|info-&gt;var.red.offset
suffix:semicolon
id|greenshift
op_assign
id|info-&gt;var.green.offset
suffix:semicolon
id|blueshift
op_assign
id|info-&gt;var.blue.offset
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|32
suffix:semicolon
id|i
OL
id|logo-&gt;clutsize
suffix:semicolon
id|i
op_increment
)paren
id|palette
(braket
id|i
)braket
op_assign
id|i
op_lshift
id|redshift
op_or
id|i
op_lshift
id|greenshift
op_or
id|i
op_lshift
id|blueshift
suffix:semicolon
)brace
DECL|function|fb_set_logo
r_static
r_void
id|__init
id|fb_set_logo
c_func
(paren
r_struct
id|fb_info
op_star
id|info
comma
r_const
r_struct
id|linux_logo
op_star
id|logo
comma
id|u8
op_star
id|dst
comma
r_int
id|depth
)paren
(brace
r_int
id|i
comma
id|j
comma
id|shift
suffix:semicolon
r_const
id|u8
op_star
id|src
op_assign
id|logo-&gt;data
suffix:semicolon
id|u8
id|d
comma
op_xor
op_assign
l_int|0
suffix:semicolon
r_switch
c_cond
(paren
id|depth
)paren
(brace
r_case
l_int|4
suffix:colon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|logo-&gt;height
suffix:semicolon
id|i
op_increment
)paren
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
id|logo-&gt;width
suffix:semicolon
id|src
op_increment
)paren
(brace
op_star
id|dst
op_increment
op_assign
op_star
id|src
op_rshift
l_int|4
suffix:semicolon
id|j
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|j
OL
id|logo-&gt;width
)paren
(brace
op_star
id|dst
op_increment
op_assign
op_star
id|src
op_amp
l_int|0x0f
suffix:semicolon
id|j
op_increment
suffix:semicolon
)brace
)brace
r_break
suffix:semicolon
r_case
op_complement
l_int|1
suffix:colon
op_xor
op_assign
l_int|0xff
suffix:semicolon
r_case
l_int|1
suffix:colon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|logo-&gt;height
suffix:semicolon
id|i
op_increment
)paren
(brace
id|shift
op_assign
l_int|7
suffix:semicolon
id|d
op_assign
op_star
id|src
op_increment
op_xor
op_xor
suffix:semicolon
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
id|logo-&gt;width
suffix:semicolon
id|j
op_increment
)paren
(brace
op_star
id|dst
op_increment
op_assign
(paren
id|d
op_rshift
id|shift
)paren
op_amp
l_int|1
suffix:semicolon
id|shift
op_assign
(paren
id|shift
op_minus
l_int|1
)paren
op_amp
l_int|7
suffix:semicolon
r_if
c_cond
(paren
id|shift
op_eq
l_int|7
)paren
id|d
op_assign
op_star
id|src
op_increment
op_xor
op_xor
suffix:semicolon
)brace
)brace
r_break
suffix:semicolon
)brace
)brace
multiline_comment|/*&n; * Three (3) kinds of logo maps exist.  linux_logo_clut224 (&gt;16 colors),&n; * linux_logo_vga16 (16 colors) and linux_logo_mono (2 colors).  Depending on&n; * the visual format and color depth of the framebuffer, the DAC, the&n; * pseudo_palette, and the logo data will be adjusted accordingly.&n; *&n; * Case 1 - linux_logo_clut224:&n; * Color exceeds the number of console colors (16), thus we set the hardware DAC&n; * using fb_set_cmap() appropriately.  The &quot;needs_cmapreset&quot;  flag will be set.&n; *&n; * For visuals that require color info from the pseudo_palette, we also construct&n; * one for temporary use. The &quot;needs_directpalette&quot; or &quot;needs_truepalette&quot; flags&n; * will be set.&n; *&n; * Case 2 - linux_logo_vga16:&n; * The number of colors just matches the console colors, thus there is no need&n; * to set the DAC or the pseudo_palette.  However, the bitmap is packed, ie,&n; * each byte contains color information for two pixels (upper and lower nibble).&n; * To be consistent with fb_imageblit() usage, we therefore separate the two&n; * nibbles into separate bytes. The &quot;depth&quot; flag will be set to 4.&n; *&n; * Case 3 - linux_logo_mono:&n; * This is similar with Case 2.  Each byte contains information for 8 pixels.&n; * We isolate each bit and expand each into a byte. The &quot;depth&quot; flag will&n; * be set to 1.&n; */
DECL|struct|logo_data
r_static
r_struct
id|logo_data
(brace
DECL|member|depth
r_int
id|depth
suffix:semicolon
DECL|member|needs_directpalette
r_int
id|needs_directpalette
suffix:semicolon
DECL|member|needs_truepalette
r_int
id|needs_truepalette
suffix:semicolon
DECL|member|needs_cmapreset
r_int
id|needs_cmapreset
suffix:semicolon
DECL|member|logo
r_const
r_struct
id|linux_logo
op_star
id|logo
suffix:semicolon
DECL|variable|fb_logo
)brace
id|fb_logo
suffix:semicolon
DECL|function|fb_prepare_logo
r_int
id|fb_prepare_logo
c_func
(paren
r_struct
id|fb_info
op_star
id|info
)paren
(brace
id|memset
c_func
(paren
op_amp
id|fb_logo
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|logo_data
)paren
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|info-&gt;fix.visual
)paren
(brace
r_case
id|FB_VISUAL_TRUECOLOR
suffix:colon
r_if
c_cond
(paren
id|info-&gt;var.bits_per_pixel
op_ge
l_int|8
)paren
id|fb_logo.needs_truepalette
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FB_VISUAL_DIRECTCOLOR
suffix:colon
r_if
c_cond
(paren
id|info-&gt;var.bits_per_pixel
op_ge
l_int|24
)paren
(brace
id|fb_logo.needs_directpalette
op_assign
l_int|1
suffix:semicolon
id|fb_logo.needs_cmapreset
op_assign
l_int|1
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|FB_VISUAL_PSEUDOCOLOR
suffix:colon
id|fb_logo.needs_cmapreset
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
)brace
multiline_comment|/* Return if no suitable logo was found */
id|fb_logo.logo
op_assign
id|fb_find_logo
c_func
(paren
id|info-&gt;var.bits_per_pixel
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|fb_logo.logo
op_logical_or
id|fb_logo.logo-&gt;height
OG
id|info-&gt;var.yres
)paren
(brace
id|fb_logo.logo
op_assign
l_int|NULL
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* What depth we asked for might be different from what we get */
r_if
c_cond
(paren
id|fb_logo.logo-&gt;type
op_eq
id|LINUX_LOGO_CLUT224
)paren
id|fb_logo.depth
op_assign
l_int|8
suffix:semicolon
r_else
r_if
c_cond
(paren
id|fb_logo.logo-&gt;type
op_eq
id|LINUX_LOGO_VGA16
)paren
id|fb_logo.depth
op_assign
l_int|4
suffix:semicolon
r_else
id|fb_logo.depth
op_assign
l_int|1
suffix:semicolon
r_return
id|fb_logo.logo-&gt;height
suffix:semicolon
)brace
DECL|function|fb_show_logo
r_int
id|fb_show_logo
c_func
(paren
r_struct
id|fb_info
op_star
id|info
)paren
(brace
id|u32
op_star
id|palette
op_assign
l_int|NULL
comma
op_star
id|saved_pseudo_palette
op_assign
l_int|NULL
suffix:semicolon
r_int
r_char
op_star
id|logo_new
op_assign
l_int|NULL
suffix:semicolon
r_struct
id|fb_image
id|image
suffix:semicolon
r_int
id|x
suffix:semicolon
multiline_comment|/* Return if the frame buffer is not mapped or suspended */
r_if
c_cond
(paren
id|fb_logo.logo
op_eq
l_int|NULL
op_logical_or
id|info-&gt;state
op_ne
id|FBINFO_STATE_RUNNING
)paren
r_return
l_int|0
suffix:semicolon
id|image.depth
op_assign
id|fb_logo.depth
suffix:semicolon
id|image.data
op_assign
id|fb_logo.logo-&gt;data
suffix:semicolon
r_if
c_cond
(paren
id|fb_logo.needs_cmapreset
)paren
id|fb_set_logocmap
c_func
(paren
id|info
comma
id|fb_logo.logo
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fb_logo.needs_truepalette
op_logical_or
id|fb_logo.needs_directpalette
)paren
(brace
id|palette
op_assign
id|kmalloc
c_func
(paren
l_int|256
op_star
l_int|4
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|palette
op_eq
l_int|NULL
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|fb_logo.needs_truepalette
)paren
id|fb_set_logo_truepalette
c_func
(paren
id|info
comma
id|fb_logo.logo
comma
id|palette
)paren
suffix:semicolon
r_else
id|fb_set_logo_directpalette
c_func
(paren
id|info
comma
id|fb_logo.logo
comma
id|palette
)paren
suffix:semicolon
id|saved_pseudo_palette
op_assign
id|info-&gt;pseudo_palette
suffix:semicolon
id|info-&gt;pseudo_palette
op_assign
id|palette
suffix:semicolon
)brace
r_if
c_cond
(paren
id|fb_logo.depth
op_eq
l_int|4
)paren
(brace
id|logo_new
op_assign
id|kmalloc
c_func
(paren
id|fb_logo.logo-&gt;width
op_star
id|fb_logo.logo-&gt;height
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|logo_new
op_eq
l_int|NULL
)paren
(brace
r_if
c_cond
(paren
id|palette
)paren
id|kfree
c_func
(paren
id|palette
)paren
suffix:semicolon
r_if
c_cond
(paren
id|saved_pseudo_palette
)paren
id|info-&gt;pseudo_palette
op_assign
id|saved_pseudo_palette
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|image.data
op_assign
id|logo_new
suffix:semicolon
id|fb_set_logo
c_func
(paren
id|info
comma
id|fb_logo.logo
comma
id|logo_new
comma
id|fb_logo.depth
)paren
suffix:semicolon
)brace
id|image.width
op_assign
id|fb_logo.logo-&gt;width
suffix:semicolon
id|image.height
op_assign
id|fb_logo.logo-&gt;height
suffix:semicolon
id|image.dy
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|x
op_assign
l_int|0
suffix:semicolon
id|x
OL
id|num_online_cpus
c_func
(paren
)paren
op_star
(paren
id|fb_logo.logo-&gt;width
op_plus
l_int|8
)paren
op_logical_and
id|x
op_le
id|info-&gt;var.xres
op_minus
id|fb_logo.logo-&gt;width
suffix:semicolon
id|x
op_add_assign
(paren
id|fb_logo.logo-&gt;width
op_plus
l_int|8
)paren
)paren
(brace
id|image.dx
op_assign
id|x
suffix:semicolon
id|info-&gt;fbops
op_member_access_from_pointer
id|fb_imageblit
c_func
(paren
id|info
comma
op_amp
id|image
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|palette
op_ne
l_int|NULL
)paren
id|kfree
c_func
(paren
id|palette
)paren
suffix:semicolon
r_if
c_cond
(paren
id|saved_pseudo_palette
op_ne
l_int|NULL
)paren
id|info-&gt;pseudo_palette
op_assign
id|saved_pseudo_palette
suffix:semicolon
r_if
c_cond
(paren
id|logo_new
op_ne
l_int|NULL
)paren
id|kfree
c_func
(paren
id|logo_new
)paren
suffix:semicolon
r_return
id|fb_logo.logo-&gt;height
suffix:semicolon
)brace
macro_line|#else
DECL|function|fb_prepare_logo
r_int
id|fb_prepare_logo
c_func
(paren
r_struct
id|fb_info
op_star
id|info
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|fb_show_logo
r_int
id|fb_show_logo
c_func
(paren
r_struct
id|fb_info
op_star
id|info
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#endif /* CONFIG_LOGO */
DECL|function|fbmem_read_proc
r_static
r_int
id|fbmem_read_proc
c_func
(paren
r_char
op_star
id|buf
comma
r_char
op_star
op_star
id|start
comma
id|off_t
id|offset
comma
r_int
id|len
comma
r_int
op_star
id|eof
comma
r_void
op_star
r_private
)paren
(brace
r_struct
id|fb_info
op_star
op_star
id|fi
suffix:semicolon
r_int
id|clen
suffix:semicolon
id|clen
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|fi
op_assign
id|registered_fb
suffix:semicolon
id|fi
OL
op_amp
id|registered_fb
(braket
id|FB_MAX
)braket
op_logical_and
id|len
OL
l_int|4000
suffix:semicolon
id|fi
op_increment
)paren
r_if
c_cond
(paren
op_star
id|fi
)paren
id|clen
op_add_assign
id|sprintf
c_func
(paren
id|buf
op_plus
id|clen
comma
l_string|&quot;%d %s&bslash;n&quot;
comma
(paren
op_star
id|fi
)paren
op_member_access_from_pointer
id|node
comma
(paren
op_star
id|fi
)paren
op_member_access_from_pointer
id|fix.id
)paren
suffix:semicolon
op_star
id|start
op_assign
id|buf
op_plus
id|offset
suffix:semicolon
r_if
c_cond
(paren
id|clen
OG
id|offset
)paren
id|clen
op_sub_assign
id|offset
suffix:semicolon
r_else
id|clen
op_assign
l_int|0
suffix:semicolon
r_return
id|clen
OL
id|len
ques
c_cond
id|clen
suffix:colon
id|len
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|fb_read
id|fb_read
c_func
(paren
r_struct
id|file
op_star
id|file
comma
r_char
id|__user
op_star
id|buf
comma
r_int
id|count
comma
id|loff_t
op_star
id|ppos
)paren
(brace
r_int
r_int
id|p
op_assign
op_star
id|ppos
suffix:semicolon
r_struct
id|inode
op_star
id|inode
op_assign
id|file-&gt;f_dentry-&gt;d_inode
suffix:semicolon
r_int
id|fbidx
op_assign
id|iminor
c_func
(paren
id|inode
)paren
suffix:semicolon
r_struct
id|fb_info
op_star
id|info
op_assign
id|registered_fb
(braket
id|fbidx
)braket
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|info
op_logical_or
op_logical_neg
id|info-&gt;screen_base
)paren
r_return
op_minus
id|ENODEV
suffix:semicolon
r_if
c_cond
(paren
id|info-&gt;state
op_ne
id|FBINFO_STATE_RUNNING
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
r_if
c_cond
(paren
id|info-&gt;fbops-&gt;fb_read
)paren
r_return
id|info-&gt;fbops
op_member_access_from_pointer
id|fb_read
c_func
(paren
id|file
comma
id|buf
comma
id|count
comma
id|ppos
)paren
suffix:semicolon
r_if
c_cond
(paren
id|p
op_ge
id|info-&gt;fix.smem_len
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|count
op_ge
id|info-&gt;fix.smem_len
)paren
id|count
op_assign
id|info-&gt;fix.smem_len
suffix:semicolon
r_if
c_cond
(paren
id|count
op_plus
id|p
OG
id|info-&gt;fix.smem_len
)paren
id|count
op_assign
id|info-&gt;fix.smem_len
op_minus
id|p
suffix:semicolon
r_if
c_cond
(paren
id|info-&gt;fbops-&gt;fb_sync
)paren
id|info-&gt;fbops
op_member_access_from_pointer
id|fb_sync
c_func
(paren
id|info
)paren
suffix:semicolon
r_if
c_cond
(paren
id|count
)paren
(brace
r_char
op_star
id|base_addr
suffix:semicolon
id|base_addr
op_assign
id|info-&gt;screen_base
suffix:semicolon
id|count
op_sub_assign
id|copy_to_user
c_func
(paren
id|buf
comma
id|base_addr
op_plus
id|p
comma
id|count
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|count
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
op_star
id|ppos
op_add_assign
id|count
suffix:semicolon
)brace
r_return
id|count
suffix:semicolon
)brace
r_static
id|ssize_t
DECL|function|fb_write
id|fb_write
c_func
(paren
r_struct
id|file
op_star
id|file
comma
r_const
r_char
id|__user
op_star
id|buf
comma
r_int
id|count
comma
id|loff_t
op_star
id|ppos
)paren
(brace
r_int
r_int
id|p
op_assign
op_star
id|ppos
suffix:semicolon
r_struct
id|inode
op_star
id|inode
op_assign
id|file-&gt;f_dentry-&gt;d_inode
suffix:semicolon
r_int
id|fbidx
op_assign
id|iminor
c_func
(paren
id|inode
)paren
suffix:semicolon
r_struct
id|fb_info
op_star
id|info
op_assign
id|registered_fb
(braket
id|fbidx
)braket
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|info
op_logical_or
op_logical_neg
id|info-&gt;screen_base
)paren
r_return
op_minus
id|ENODEV
suffix:semicolon
r_if
c_cond
(paren
id|info-&gt;state
op_ne
id|FBINFO_STATE_RUNNING
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
r_if
c_cond
(paren
id|info-&gt;fbops-&gt;fb_write
)paren
r_return
id|info-&gt;fbops
op_member_access_from_pointer
id|fb_write
c_func
(paren
id|file
comma
id|buf
comma
id|count
comma
id|ppos
)paren
suffix:semicolon
r_if
c_cond
(paren
id|p
OG
id|info-&gt;fix.smem_len
)paren
r_return
op_minus
id|ENOSPC
suffix:semicolon
r_if
c_cond
(paren
id|count
op_ge
id|info-&gt;fix.smem_len
)paren
id|count
op_assign
id|info-&gt;fix.smem_len
suffix:semicolon
id|err
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|count
op_plus
id|p
OG
id|info-&gt;fix.smem_len
)paren
(brace
id|count
op_assign
id|info-&gt;fix.smem_len
op_minus
id|p
suffix:semicolon
id|err
op_assign
op_minus
id|ENOSPC
suffix:semicolon
)brace
r_if
c_cond
(paren
id|info-&gt;fbops-&gt;fb_sync
)paren
id|info-&gt;fbops
op_member_access_from_pointer
id|fb_sync
c_func
(paren
id|info
)paren
suffix:semicolon
r_if
c_cond
(paren
id|count
)paren
(brace
r_char
op_star
id|base_addr
suffix:semicolon
id|base_addr
op_assign
id|info-&gt;screen_base
suffix:semicolon
id|count
op_sub_assign
id|copy_from_user
c_func
(paren
id|base_addr
op_plus
id|p
comma
id|buf
comma
id|count
)paren
suffix:semicolon
op_star
id|ppos
op_add_assign
id|count
suffix:semicolon
id|err
op_assign
op_minus
id|EFAULT
suffix:semicolon
)brace
r_if
c_cond
(paren
id|count
)paren
r_return
id|count
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_KMOD
DECL|function|try_to_load
r_static
r_void
id|try_to_load
c_func
(paren
r_int
id|fb
)paren
(brace
id|request_module
c_func
(paren
l_string|&quot;fb%d&quot;
comma
id|fb
)paren
suffix:semicolon
)brace
macro_line|#endif /* CONFIG_KMOD */
r_void
DECL|function|fb_load_cursor_image
id|fb_load_cursor_image
c_func
(paren
r_struct
id|fb_info
op_star
id|info
)paren
(brace
r_int
r_int
id|width
op_assign
(paren
id|info-&gt;cursor.image.width
op_plus
l_int|7
)paren
op_rshift
l_int|3
suffix:semicolon
id|u8
op_star
id|data
op_assign
(paren
id|u8
op_star
)paren
id|info-&gt;cursor.image.data
suffix:semicolon
r_if
c_cond
(paren
id|info-&gt;sprite.outbuf
)paren
id|info-&gt;sprite
dot
id|outbuf
c_func
(paren
id|info
comma
id|info-&gt;sprite.addr
comma
id|data
comma
id|width
)paren
suffix:semicolon
r_else
id|memcpy
c_func
(paren
id|info-&gt;sprite.addr
comma
id|data
comma
id|width
)paren
suffix:semicolon
)brace
r_int
DECL|function|fb_cursor
id|fb_cursor
c_func
(paren
r_struct
id|fb_info
op_star
id|info
comma
r_struct
id|fb_cursor
id|__user
op_star
id|sprite
)paren
(brace
r_struct
id|fb_cursor
id|cursor
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|cursor
comma
id|sprite
comma
r_sizeof
(paren
r_struct
id|fb_cursor
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
id|cursor.set
op_amp
id|FB_CUR_SETCUR
)paren
id|info-&gt;cursor.enable
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|cursor.set
op_amp
id|FB_CUR_SETCMAP
)paren
(brace
id|err
op_assign
id|fb_copy_cmap
c_func
(paren
op_amp
id|cursor.image.cmap
comma
op_amp
id|sprite-&gt;image.cmap
comma
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
)brace
r_if
c_cond
(paren
id|cursor.set
op_amp
id|FB_CUR_SETSHAPE
)paren
(brace
r_int
id|size
op_assign
(paren
(paren
id|cursor.image.width
op_plus
l_int|7
)paren
op_rshift
l_int|3
)paren
op_star
id|cursor.image.height
suffix:semicolon
r_char
op_star
id|data
comma
op_star
id|mask
suffix:semicolon
r_if
c_cond
(paren
(paren
id|cursor.image.height
op_ne
id|info-&gt;cursor.image.height
)paren
op_logical_or
(paren
id|cursor.image.width
op_ne
id|info-&gt;cursor.image.width
)paren
)paren
id|cursor.set
op_or_assign
id|FB_CUR_SETSIZE
suffix:semicolon
id|data
op_assign
id|kmalloc
c_func
(paren
id|size
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|data
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|mask
op_assign
id|kmalloc
c_func
(paren
id|size
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|mask
)paren
(brace
id|kfree
c_func
(paren
id|data
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
id|data
comma
id|cursor.image.data
comma
id|size
)paren
op_logical_or
id|copy_from_user
c_func
(paren
id|mask
comma
id|cursor.mask
comma
id|size
)paren
)paren
(brace
id|kfree
c_func
(paren
id|data
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|mask
)paren
suffix:semicolon
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
id|cursor.image.data
op_assign
id|data
suffix:semicolon
id|cursor.mask
op_assign
id|mask
suffix:semicolon
)brace
id|info-&gt;cursor.set
op_assign
id|cursor.set
suffix:semicolon
id|info-&gt;cursor.rop
op_assign
id|cursor.rop
suffix:semicolon
id|err
op_assign
id|info-&gt;fbops
op_member_access_from_pointer
id|fb_cursor
c_func
(paren
id|info
comma
op_amp
id|cursor
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
r_int
DECL|function|fb_pan_display
id|fb_pan_display
c_func
(paren
r_struct
id|fb_info
op_star
id|info
comma
r_struct
id|fb_var_screeninfo
op_star
id|var
)paren
(brace
r_int
id|xoffset
op_assign
id|var-&gt;xoffset
suffix:semicolon
r_int
id|yoffset
op_assign
id|var-&gt;yoffset
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
id|xoffset
template_param
id|info-&gt;var.yres_virtual
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|info-&gt;fbops
op_member_access_from_pointer
id|fb_pan_display
c_func
(paren
id|var
comma
id|info
)paren
)paren
)paren
r_return
id|err
suffix:semicolon
id|info-&gt;var.xoffset
op_assign
id|var-&gt;xoffset
suffix:semicolon
id|info-&gt;var.yoffset
op_assign
id|var-&gt;yoffset
suffix:semicolon
r_if
c_cond
(paren
id|var-&gt;vmode
op_amp
id|FB_VMODE_YWRAP
)paren
id|info-&gt;var.vmode
op_or_assign
id|FB_VMODE_YWRAP
suffix:semicolon
r_else
id|info-&gt;var.vmode
op_and_assign
op_complement
id|FB_VMODE_YWRAP
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_int
DECL|function|fb_set_var
id|fb_set_var
c_func
(paren
r_struct
id|fb_info
op_star
id|info
comma
r_struct
id|fb_var_screeninfo
op_star
id|var
)paren
(brace
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
(paren
id|var-&gt;activate
op_amp
id|FB_ACTIVATE_FORCE
)paren
op_logical_or
id|memcmp
c_func
(paren
op_amp
id|info-&gt;var
comma
id|var
comma
r_sizeof
(paren
r_struct
id|fb_var_screeninfo
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|info-&gt;fbops-&gt;fb_check_var
)paren
(brace
op_star
id|var
op_assign
id|info-&gt;var
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|info-&gt;fbops
op_member_access_from_pointer
id|fb_check_var
c_func
(paren
id|var
comma
id|info
)paren
)paren
)paren
r_return
id|err
suffix:semicolon
r_if
c_cond
(paren
(paren
id|var-&gt;activate
op_amp
id|FB_ACTIVATE_MASK
)paren
op_eq
id|FB_ACTIVATE_NOW
)paren
(brace
id|info-&gt;var
op_assign
op_star
id|var
suffix:semicolon
r_if
c_cond
(paren
id|info-&gt;fbops-&gt;fb_set_par
)paren
id|info-&gt;fbops
op_member_access_from_pointer
id|fb_set_par
c_func
(paren
id|info
)paren
suffix:semicolon
id|fb_pan_display
c_func
(paren
id|info
comma
op_amp
id|info-&gt;var
)paren
suffix:semicolon
id|fb_set_cmap
c_func
(paren
op_amp
id|info-&gt;cmap
comma
l_int|1
comma
id|info
)paren
suffix:semicolon
r_if
c_cond
(paren
id|info-&gt;flags
op_amp
id|FBINFO_MISC_MODECHANGEUSER
)paren
(brace
id|info-&gt;flags
op_and_assign
op_complement
id|FBINFO_MISC_MODECHANGEUSER
suffix:semicolon
id|notifier_call_chain
c_func
(paren
op_amp
id|fb_notifier_list
comma
id|FB_EVENT_MODE_CHANGE
comma
id|info
)paren
suffix:semicolon
)brace
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
r_int
DECL|function|fb_blank
id|fb_blank
c_func
(paren
r_struct
id|fb_info
op_star
id|info
comma
r_int
id|blank
)paren
(brace
multiline_comment|/* ??? Variable sized stack allocation.  */
id|u16
id|black
(braket
id|info-&gt;cmap.len
)braket
suffix:semicolon
r_struct
id|fb_cmap
id|cmap
suffix:semicolon
r_if
c_cond
(paren
id|info-&gt;fbops-&gt;fb_blank
op_logical_and
op_logical_neg
id|info-&gt;fbops
op_member_access_from_pointer
id|fb_blank
c_func
(paren
id|blank
comma
id|info
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|blank
)paren
(brace
id|memset
c_func
(paren
id|black
comma
l_int|0
comma
id|info-&gt;cmap.len
op_star
r_sizeof
(paren
id|u16
)paren
)paren
suffix:semicolon
id|cmap.red
op_assign
id|cmap.green
op_assign
id|cmap.blue
op_assign
id|black
suffix:semicolon
id|cmap.transp
op_assign
id|info-&gt;cmap.transp
ques
c_cond
id|black
suffix:colon
l_int|NULL
suffix:semicolon
id|cmap.start
op_assign
id|info-&gt;cmap.start
suffix:semicolon
id|cmap.len
op_assign
id|info-&gt;cmap.len
suffix:semicolon
)brace
r_else
id|cmap
op_assign
id|info-&gt;cmap
suffix:semicolon
r_return
id|fb_set_cmap
c_func
(paren
op_amp
id|cmap
comma
l_int|1
comma
id|info
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|fb_ioctl
id|fb_ioctl
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
comma
r_int
r_int
id|cmd
comma
r_int
r_int
id|arg
)paren
(brace
r_int
id|fbidx
op_assign
id|iminor
c_func
(paren
id|inode
)paren
suffix:semicolon
r_struct
id|fb_info
op_star
id|info
op_assign
id|registered_fb
(braket
id|fbidx
)braket
suffix:semicolon
r_struct
id|fb_ops
op_star
id|fb
op_assign
id|info-&gt;fbops
suffix:semicolon
r_struct
id|fb_var_screeninfo
id|var
suffix:semicolon
r_struct
id|fb_fix_screeninfo
id|fix
suffix:semicolon
macro_line|#ifdef CONFIG_FRAMEBUFFER_CONSOLE
r_struct
id|fb_con2fbmap
id|con2fb
suffix:semicolon
macro_line|#endif
r_struct
id|fb_cmap
id|cmap
suffix:semicolon
r_void
id|__user
op_star
id|argp
op_assign
(paren
r_void
id|__user
op_star
)paren
id|arg
suffix:semicolon
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|fb
)paren
r_return
op_minus
id|ENODEV
suffix:semicolon
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|FBIOGET_VSCREENINFO
suffix:colon
r_return
id|copy_to_user
c_func
(paren
id|argp
comma
op_amp
id|info-&gt;var
comma
r_sizeof
(paren
id|var
)paren
)paren
ques
c_cond
op_minus
id|EFAULT
suffix:colon
l_int|0
suffix:semicolon
r_case
id|FBIOPUT_VSCREENINFO
suffix:colon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|var
comma
id|argp
comma
r_sizeof
(paren
id|var
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|acquire_console_sem
c_func
(paren
)paren
suffix:semicolon
id|info-&gt;flags
op_or_assign
id|FBINFO_MISC_MODECHANGEUSER
suffix:semicolon
id|i
op_assign
id|fb_set_var
c_func
(paren
id|info
comma
op_amp
id|var
)paren
suffix:semicolon
id|info-&gt;flags
op_and_assign
op_complement
id|FBINFO_MISC_MODECHANGEUSER
suffix:semicolon
id|release_console_sem
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|i
)paren
r_return
id|i
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|argp
comma
op_amp
id|var
comma
r_sizeof
(paren
id|var
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_case
id|FBIOGET_FSCREENINFO
suffix:colon
r_return
id|copy_to_user
c_func
(paren
id|argp
comma
op_amp
id|info-&gt;fix
comma
r_sizeof
(paren
id|fix
)paren
)paren
ques
c_cond
op_minus
id|EFAULT
suffix:colon
l_int|0
suffix:semicolon
r_case
id|FBIOPUTCMAP
suffix:colon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|cmap
comma
id|argp
comma
r_sizeof
(paren
id|cmap
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
(paren
id|fb_set_cmap
c_func
(paren
op_amp
id|cmap
comma
l_int|0
comma
id|info
)paren
)paren
suffix:semicolon
r_case
id|FBIOGETCMAP
suffix:colon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|cmap
comma
id|argp
comma
r_sizeof
(paren
id|cmap
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
(paren
id|fb_copy_cmap
c_func
(paren
op_amp
id|info-&gt;cmap
comma
op_amp
id|cmap
comma
l_int|2
)paren
)paren
suffix:semicolon
r_case
id|FBIOPAN_DISPLAY
suffix:colon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|var
comma
id|argp
comma
r_sizeof
(paren
id|var
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|acquire_console_sem
c_func
(paren
)paren
suffix:semicolon
id|i
op_assign
id|fb_pan_display
c_func
(paren
id|info
comma
op_amp
id|var
)paren
suffix:semicolon
id|release_console_sem
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|i
)paren
r_return
id|i
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|argp
comma
op_amp
id|var
comma
r_sizeof
(paren
id|var
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_case
id|FBIO_CURSOR
suffix:colon
id|acquire_console_sem
c_func
(paren
)paren
suffix:semicolon
id|i
op_assign
id|fb_cursor
c_func
(paren
id|info
comma
id|argp
)paren
suffix:semicolon
id|release_console_sem
c_func
(paren
)paren
suffix:semicolon
r_return
id|i
suffix:semicolon
macro_line|#ifdef CONFIG_FRAMEBUFFER_CONSOLE
r_case
id|FBIOGET_CON2FBMAP
suffix:colon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|con2fb
comma
id|argp
comma
r_sizeof
(paren
id|con2fb
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
id|con2fb.console
template_param
id|MAX_NR_CONSOLES
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|con2fb.framebuffer
op_assign
id|con2fb_map
(braket
id|con2fb.console
op_minus
l_int|1
)braket
suffix:semicolon
r_return
id|copy_to_user
c_func
(paren
id|argp
comma
op_amp
id|con2fb
comma
r_sizeof
(paren
id|con2fb
)paren
)paren
ques
c_cond
op_minus
id|EFAULT
suffix:colon
l_int|0
suffix:semicolon
r_case
id|FBIOPUT_CON2FBMAP
suffix:colon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|con2fb
comma
id|argp
comma
r_sizeof
(paren
id|con2fb
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
id|con2fb.console
template_param
id|MAX_NR_CONSOLES
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|con2fb.framebuffer
OL
l_int|0
op_logical_or
id|con2fb.framebuffer
op_ge
id|FB_MAX
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
macro_line|#ifdef CONFIG_KMOD
r_if
c_cond
(paren
op_logical_neg
id|registered_fb
(braket
id|con2fb.framebuffer
)braket
)paren
id|try_to_load
c_func
(paren
id|con2fb.framebuffer
)paren
suffix:semicolon
macro_line|#endif /* CONFIG_KMOD */
r_if
c_cond
(paren
op_logical_neg
id|registered_fb
(braket
id|con2fb.framebuffer
)braket
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|con2fb.console
OG
l_int|0
op_logical_and
id|con2fb.console
OL
id|MAX_NR_CONSOLES
)paren
r_return
id|set_con2fb_map
c_func
(paren
id|con2fb.console
op_minus
l_int|1
comma
id|con2fb.framebuffer
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
macro_line|#endif&t;/* CONFIG_FRAMEBUFFER_CONSOLE */
r_case
id|FBIOBLANK
suffix:colon
id|acquire_console_sem
c_func
(paren
)paren
suffix:semicolon
id|i
op_assign
id|fb_blank
c_func
(paren
id|info
comma
id|arg
)paren
suffix:semicolon
id|release_console_sem
c_func
(paren
)paren
suffix:semicolon
r_return
id|i
suffix:semicolon
r_default
suffix:colon
(brace
)brace
r_if
c_cond
(paren
id|fb-&gt;fb_ioctl
op_eq
l_int|NULL
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|fb
op_member_access_from_pointer
id|fb_ioctl
c_func
(paren
id|inode
comma
id|file
comma
id|cmd
comma
id|arg
comma
id|info
)paren
suffix:semicolon
)brace
)brace
r_static
r_int
DECL|function|fb_mmap
id|fb_mmap
c_func
(paren
r_struct
id|file
op_star
id|file
comma
r_struct
id|vm_area_struct
op_star
id|vma
)paren
(brace
r_int
id|fbidx
op_assign
id|iminor
c_func
(paren
id|file-&gt;f_dentry-&gt;d_inode
)paren
suffix:semicolon
r_struct
id|fb_info
op_star
id|info
op_assign
id|registered_fb
(braket
id|fbidx
)braket
suffix:semicolon
r_struct
id|fb_ops
op_star
id|fb
op_assign
id|info-&gt;fbops
suffix:semicolon
r_int
r_int
id|off
suffix:semicolon
macro_line|#if !defined(__sparc__) || defined(__sparc_v9__)
r_int
r_int
id|start
suffix:semicolon
id|u32
id|len
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
id|vma-&gt;vm_pgoff
OG
(paren
op_complement
l_int|0UL
op_rshift
id|PAGE_SHIFT
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|off
op_assign
id|vma-&gt;vm_pgoff
op_lshift
id|PAGE_SHIFT
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|fb
)paren
r_return
op_minus
id|ENODEV
suffix:semicolon
r_if
c_cond
(paren
id|fb-&gt;fb_mmap
)paren
(brace
r_int
id|res
suffix:semicolon
id|lock_kernel
c_func
(paren
)paren
suffix:semicolon
id|res
op_assign
id|fb
op_member_access_from_pointer
id|fb_mmap
c_func
(paren
id|info
comma
id|file
comma
id|vma
)paren
suffix:semicolon
id|unlock_kernel
c_func
(paren
)paren
suffix:semicolon
r_return
id|res
suffix:semicolon
)brace
macro_line|#if defined(__sparc__) &amp;&amp; !defined(__sparc_v9__)
multiline_comment|/* Should never get here, all fb drivers should have their own&n;&t;   mmap routines */
r_return
op_minus
id|EINVAL
suffix:semicolon
macro_line|#else
multiline_comment|/* !sparc32... */
id|lock_kernel
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/* frame buffer memory */
id|start
op_assign
id|info-&gt;fix.smem_start
suffix:semicolon
id|len
op_assign
id|PAGE_ALIGN
c_func
(paren
(paren
id|start
op_amp
op_complement
id|PAGE_MASK
)paren
op_plus
id|info-&gt;fix.smem_len
)paren
suffix:semicolon
r_if
c_cond
(paren
id|off
op_ge
id|len
)paren
(brace
multiline_comment|/* memory mapped io */
id|off
op_sub_assign
id|len
suffix:semicolon
r_if
c_cond
(paren
id|info-&gt;var.accel_flags
)paren
(brace
id|unlock_kernel
c_func
(paren
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|start
op_assign
id|info-&gt;fix.mmio_start
suffix:semicolon
id|len
op_assign
id|PAGE_ALIGN
c_func
(paren
(paren
id|start
op_amp
op_complement
id|PAGE_MASK
)paren
op_plus
id|info-&gt;fix.mmio_len
)paren
suffix:semicolon
)brace
id|unlock_kernel
c_func
(paren
)paren
suffix:semicolon
id|start
op_and_assign
id|PAGE_MASK
suffix:semicolon
r_if
c_cond
(paren
(paren
id|vma-&gt;vm_end
op_minus
id|vma-&gt;vm_start
op_plus
id|off
)paren
OG
id|len
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|off
op_add_assign
id|start
suffix:semicolon
id|vma-&gt;vm_pgoff
op_assign
id|off
op_rshift
id|PAGE_SHIFT
suffix:semicolon
multiline_comment|/* This is an IO map - tell maydump to skip this VMA */
id|vma-&gt;vm_flags
op_or_assign
id|VM_IO
suffix:semicolon
macro_line|#if defined(__sparc_v9__)
id|vma-&gt;vm_flags
op_or_assign
(paren
id|VM_SHM
op_or
id|VM_LOCKED
)paren
suffix:semicolon
r_if
c_cond
(paren
id|io_remap_page_range
c_func
(paren
id|vma
comma
id|vma-&gt;vm_start
comma
id|off
comma
id|vma-&gt;vm_end
op_minus
id|vma-&gt;vm_start
comma
id|vma-&gt;vm_page_prot
comma
l_int|0
)paren
)paren
r_return
op_minus
id|EAGAIN
suffix:semicolon
macro_line|#else
macro_line|#if defined(__mc68000__)
macro_line|#if defined(CONFIG_SUN3)
id|pgprot_val
c_func
(paren
id|vma-&gt;vm_page_prot
)paren
op_or_assign
id|SUN3_PAGE_NOCACHE
suffix:semicolon
macro_line|#elif defined(CONFIG_MMU)
r_if
c_cond
(paren
id|CPU_IS_020_OR_030
)paren
id|pgprot_val
c_func
(paren
id|vma-&gt;vm_page_prot
)paren
op_or_assign
id|_PAGE_NOCACHE030
suffix:semicolon
r_if
c_cond
(paren
id|CPU_IS_040_OR_060
)paren
(brace
id|pgprot_val
c_func
(paren
id|vma-&gt;vm_page_prot
)paren
op_and_assign
id|_CACHEMASK040
suffix:semicolon
multiline_comment|/* Use no-cache mode, serialized */
id|pgprot_val
c_func
(paren
id|vma-&gt;vm_page_prot
)paren
op_or_assign
id|_PAGE_NOCACHE_S
suffix:semicolon
)brace
macro_line|#endif
macro_line|#elif defined(__powerpc__)
id|pgprot_val
c_func
(paren
id|vma-&gt;vm_page_prot
)paren
op_or_assign
id|_PAGE_NO_CACHE
op_or
id|_PAGE_GUARDED
suffix:semicolon
macro_line|#elif defined(__alpha__)
multiline_comment|/* Caching is off in the I/O space quadrant by design.  */
macro_line|#elif defined(__i386__) || defined(__x86_64__)
r_if
c_cond
(paren
id|boot_cpu_data.x86
OG
l_int|3
)paren
id|pgprot_val
c_func
(paren
id|vma-&gt;vm_page_prot
)paren
op_or_assign
id|_PAGE_PCD
suffix:semicolon
macro_line|#elif defined(__mips__)
id|vma-&gt;vm_page_prot
op_assign
id|pgprot_noncached
c_func
(paren
id|vma-&gt;vm_page_prot
)paren
suffix:semicolon
macro_line|#elif defined(__hppa__)
id|pgprot_val
c_func
(paren
id|vma-&gt;vm_page_prot
)paren
op_or_assign
id|_PAGE_NO_CACHE
suffix:semicolon
macro_line|#elif defined(__ia64__) || defined(__arm__) || defined(__sh__)
id|vma-&gt;vm_page_prot
op_assign
id|pgprot_writecombine
c_func
(paren
id|vma-&gt;vm_page_prot
)paren
suffix:semicolon
macro_line|#else
macro_line|#warning What do we have to do here??
macro_line|#endif
r_if
c_cond
(paren
id|io_remap_page_range
c_func
(paren
id|vma
comma
id|vma-&gt;vm_start
comma
id|off
comma
id|vma-&gt;vm_end
op_minus
id|vma-&gt;vm_start
comma
id|vma-&gt;vm_page_prot
)paren
)paren
r_return
op_minus
id|EAGAIN
suffix:semicolon
macro_line|#endif /* !__sparc_v9__ */
r_return
l_int|0
suffix:semicolon
macro_line|#endif /* !sparc32 */
)brace
r_static
r_int
DECL|function|fb_open
id|fb_open
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_int
id|fbidx
op_assign
id|iminor
c_func
(paren
id|inode
)paren
suffix:semicolon
r_struct
id|fb_info
op_star
id|info
suffix:semicolon
r_int
id|res
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|fbidx
op_ge
id|FB_MAX
)paren
r_return
op_minus
id|ENODEV
suffix:semicolon
macro_line|#ifdef CONFIG_KMOD
r_if
c_cond
(paren
op_logical_neg
(paren
id|info
op_assign
id|registered_fb
(braket
id|fbidx
)braket
)paren
)paren
id|try_to_load
c_func
(paren
id|fbidx
)paren
suffix:semicolon
macro_line|#endif /* CONFIG_KMOD */
r_if
c_cond
(paren
op_logical_neg
(paren
id|info
op_assign
id|registered_fb
(braket
id|fbidx
)braket
)paren
)paren
r_return
op_minus
id|ENODEV
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|try_module_get
c_func
(paren
id|info-&gt;fbops-&gt;owner
)paren
)paren
r_return
op_minus
id|ENODEV
suffix:semicolon
r_if
c_cond
(paren
id|info-&gt;fbops-&gt;fb_open
)paren
(brace
id|res
op_assign
id|info-&gt;fbops
op_member_access_from_pointer
id|fb_open
c_func
(paren
id|info
comma
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|res
)paren
id|module_put
c_func
(paren
id|info-&gt;fbops-&gt;owner
)paren
suffix:semicolon
)brace
r_return
id|res
suffix:semicolon
)brace
r_static
r_int
DECL|function|fb_release
id|fb_release
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_int
id|fbidx
op_assign
id|iminor
c_func
(paren
id|inode
)paren
suffix:semicolon
r_struct
id|fb_info
op_star
id|info
suffix:semicolon
id|lock_kernel
c_func
(paren
)paren
suffix:semicolon
id|info
op_assign
id|registered_fb
(braket
id|fbidx
)braket
suffix:semicolon
r_if
c_cond
(paren
id|info-&gt;fbops-&gt;fb_release
)paren
id|info-&gt;fbops
op_member_access_from_pointer
id|fb_release
c_func
(paren
id|info
comma
l_int|1
)paren
suffix:semicolon
id|module_put
c_func
(paren
id|info-&gt;fbops-&gt;owner
)paren
suffix:semicolon
id|unlock_kernel
c_func
(paren
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|fb_fops
r_static
r_struct
id|file_operations
id|fb_fops
op_assign
(brace
dot
id|owner
op_assign
id|THIS_MODULE
comma
dot
id|read
op_assign
id|fb_read
comma
dot
id|write
op_assign
id|fb_write
comma
dot
id|ioctl
op_assign
id|fb_ioctl
comma
dot
id|mmap
op_assign
id|fb_mmap
comma
dot
id|open
op_assign
id|fb_open
comma
dot
id|release
op_assign
id|fb_release
comma
macro_line|#ifdef HAVE_ARCH_FB_UNMAPPED_AREA
dot
id|get_unmapped_area
op_assign
id|get_fb_unmapped_area
comma
macro_line|#endif
)brace
suffix:semicolon
DECL|variable|fb_class
r_static
r_struct
id|class_simple
op_star
id|fb_class
suffix:semicolon
multiline_comment|/**&n; *&t;register_framebuffer - registers a frame buffer device&n; *&t;@fb_info: frame buffer info structure&n; *&n; *&t;Registers a frame buffer device @fb_info.&n; *&n; *&t;Returns negative errno on error, or zero for success.&n; *&n; */
r_int
DECL|function|register_framebuffer
id|register_framebuffer
c_func
(paren
r_struct
id|fb_info
op_star
id|fb_info
)paren
(brace
r_int
id|i
suffix:semicolon
r_struct
id|class_device
op_star
id|c
suffix:semicolon
r_if
c_cond
(paren
id|num_registered_fb
op_eq
id|FB_MAX
)paren
r_return
op_minus
id|ENXIO
suffix:semicolon
id|num_registered_fb
op_increment
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|FB_MAX
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
op_logical_neg
id|registered_fb
(braket
id|i
)braket
)paren
r_break
suffix:semicolon
id|fb_info-&gt;node
op_assign
id|i
suffix:semicolon
id|c
op_assign
id|class_simple_device_add
c_func
(paren
id|fb_class
comma
id|MKDEV
c_func
(paren
id|FB_MAJOR
comma
id|i
)paren
comma
l_int|NULL
comma
l_string|&quot;fb%d&quot;
comma
id|i
)paren
suffix:semicolon
r_if
c_cond
(paren
id|IS_ERR
c_func
(paren
id|c
)paren
)paren
(brace
multiline_comment|/* Not fatal */
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;Unable to create class_device for framebuffer %d; errno = %ld&bslash;n&quot;
comma
id|i
comma
id|PTR_ERR
c_func
(paren
id|c
)paren
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|fb_info-&gt;pixmap.addr
op_eq
l_int|NULL
)paren
(brace
id|fb_info-&gt;pixmap.addr
op_assign
id|kmalloc
c_func
(paren
id|FBPIXMAPSIZE
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fb_info-&gt;pixmap.addr
)paren
(brace
id|fb_info-&gt;pixmap.size
op_assign
id|FBPIXMAPSIZE
suffix:semicolon
id|fb_info-&gt;pixmap.buf_align
op_assign
l_int|1
suffix:semicolon
id|fb_info-&gt;pixmap.scan_align
op_assign
l_int|1
suffix:semicolon
id|fb_info-&gt;pixmap.access_align
op_assign
l_int|4
suffix:semicolon
id|fb_info-&gt;pixmap.flags
op_assign
id|FB_PIXMAP_DEFAULT
suffix:semicolon
)brace
)brace
id|fb_info-&gt;pixmap.offset
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|fb_info-&gt;sprite.addr
op_eq
l_int|NULL
)paren
(brace
id|fb_info-&gt;sprite.addr
op_assign
id|kmalloc
c_func
(paren
id|FBPIXMAPSIZE
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fb_info-&gt;sprite.addr
)paren
(brace
id|fb_info-&gt;sprite.size
op_assign
id|FBPIXMAPSIZE
suffix:semicolon
id|fb_info-&gt;sprite.buf_align
op_assign
l_int|1
suffix:semicolon
id|fb_info-&gt;sprite.scan_align
op_assign
l_int|1
suffix:semicolon
id|fb_info-&gt;sprite.access_align
op_assign
l_int|4
suffix:semicolon
id|fb_info-&gt;sprite.flags
op_assign
id|FB_PIXMAP_DEFAULT
suffix:semicolon
)brace
)brace
id|fb_info-&gt;sprite.offset
op_assign
l_int|0
suffix:semicolon
id|registered_fb
(braket
id|i
)braket
op_assign
id|fb_info
suffix:semicolon
id|devfs_mk_cdev
c_func
(paren
id|MKDEV
c_func
(paren
id|FB_MAJOR
comma
id|i
)paren
comma
id|S_IFCHR
op_or
id|S_IRUGO
op_or
id|S_IWUGO
comma
l_string|&quot;fb/%d&quot;
comma
id|i
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;unregister_framebuffer - releases a frame buffer device&n; *&t;@fb_info: frame buffer info structure&n; *&n; *&t;Unregisters a frame buffer device @fb_info.&n; *&n; *&t;Returns negative errno on error, or zero for success.&n; *&n; */
r_int
DECL|function|unregister_framebuffer
id|unregister_framebuffer
c_func
(paren
r_struct
id|fb_info
op_star
id|fb_info
)paren
(brace
r_int
id|i
suffix:semicolon
id|i
op_assign
id|fb_info-&gt;node
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|registered_fb
(braket
id|i
)braket
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|devfs_remove
c_func
(paren
l_string|&quot;fb/%d&quot;
comma
id|i
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fb_info-&gt;pixmap.addr
op_logical_and
(paren
id|fb_info-&gt;pixmap.flags
op_amp
id|FB_PIXMAP_DEFAULT
)paren
)paren
id|kfree
c_func
(paren
id|fb_info-&gt;pixmap.addr
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fb_info-&gt;sprite.addr
op_logical_and
(paren
id|fb_info-&gt;sprite.flags
op_amp
id|FB_PIXMAP_DEFAULT
)paren
)paren
id|kfree
c_func
(paren
id|fb_info-&gt;sprite.addr
)paren
suffix:semicolon
id|registered_fb
(braket
id|i
)braket
op_assign
l_int|NULL
suffix:semicolon
id|num_registered_fb
op_decrement
suffix:semicolon
id|class_simple_device_remove
c_func
(paren
id|MKDEV
c_func
(paren
id|FB_MAJOR
comma
id|i
)paren
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;fb_register_client - register a client notifier&n; *&t;@nb: notifier block to callback on events&n; */
DECL|function|fb_register_client
r_int
id|fb_register_client
c_func
(paren
r_struct
id|notifier_block
op_star
id|nb
)paren
(brace
r_return
id|notifier_chain_register
c_func
(paren
op_amp
id|fb_notifier_list
comma
id|nb
)paren
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;fb_unregister_client - unregister a client notifier&n; *&t;@nb: notifier block to callback on events&n; */
DECL|function|fb_unregister_client
r_int
id|fb_unregister_client
c_func
(paren
r_struct
id|notifier_block
op_star
id|nb
)paren
(brace
r_return
id|notifier_chain_unregister
c_func
(paren
op_amp
id|fb_notifier_list
comma
id|nb
)paren
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;fb_set_suspend - low level driver signals suspend&n; *&t;@info: framebuffer affected&n; *&t;@state: 0 = resuming, !=0 = suspending&n; *&n; *&t;This is meant to be used by low level drivers to&n; * &t;signal suspend/resume to the core &amp; clients.&n; *&t;It must be called with the console semaphore held&n; */
DECL|function|fb_set_suspend
r_void
id|fb_set_suspend
c_func
(paren
r_struct
id|fb_info
op_star
id|info
comma
r_int
id|state
)paren
(brace
r_if
c_cond
(paren
id|state
)paren
(brace
id|notifier_call_chain
c_func
(paren
op_amp
id|fb_notifier_list
comma
id|FB_EVENT_SUSPEND
comma
id|info
)paren
suffix:semicolon
id|info-&gt;state
op_assign
id|FBINFO_STATE_SUSPENDED
suffix:semicolon
)brace
r_else
(brace
id|info-&gt;state
op_assign
id|FBINFO_STATE_RUNNING
suffix:semicolon
id|notifier_call_chain
c_func
(paren
op_amp
id|fb_notifier_list
comma
id|FB_EVENT_RESUME
comma
id|info
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/**&n; *&t;fbmem_init - init frame buffer subsystem&n; *&n; *&t;Initialize the frame buffer subsystem.&n; *&n; *&t;NOTE: This function is _only_ to be called by drivers/char/mem.c.&n; *&n; */
r_void
id|__init
DECL|function|fbmem_init
id|fbmem_init
c_func
(paren
r_void
)paren
(brace
r_int
id|i
suffix:semicolon
id|create_proc_read_entry
c_func
(paren
l_string|&quot;fb&quot;
comma
l_int|0
comma
l_int|NULL
comma
id|fbmem_read_proc
comma
l_int|NULL
)paren
suffix:semicolon
id|devfs_mk_dir
c_func
(paren
l_string|&quot;fb&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|register_chrdev
c_func
(paren
id|FB_MAJOR
comma
l_string|&quot;fb&quot;
comma
op_amp
id|fb_fops
)paren
)paren
id|printk
c_func
(paren
l_string|&quot;unable to get major %d for fb devs&bslash;n&quot;
comma
id|FB_MAJOR
)paren
suffix:semicolon
id|fb_class
op_assign
id|class_simple_create
c_func
(paren
id|THIS_MODULE
comma
l_string|&quot;graphics&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|IS_ERR
c_func
(paren
id|fb_class
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;Unable to create fb class; errno = %ld&bslash;n&quot;
comma
id|PTR_ERR
c_func
(paren
id|fb_class
)paren
)paren
suffix:semicolon
id|fb_class
op_assign
l_int|NULL
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_FB_OF
r_if
c_cond
(paren
id|ofonly
)paren
(brace
id|offb_init
c_func
(paren
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
macro_line|#endif
multiline_comment|/*&n;&t; *  Probe for all builtin frame buffer devices&n;&t; */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|num_pref_init_funcs
suffix:semicolon
id|i
op_increment
)paren
id|pref_init_funcs
(braket
id|i
)braket
(paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|NUM_FB_DRIVERS
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|fb_drivers
(braket
id|i
)braket
dot
id|init
)paren
id|fb_drivers
(braket
id|i
)braket
dot
id|init
c_func
(paren
)paren
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;video_setup - process command line options&n; *&t;@options: string of options&n; *&n; *&t;Process command line options for frame buffer subsystem.&n; *&n; *&t;NOTE: This function is a __setup and __init function.&n; *&n; *&t;Returns zero.&n; *&n; */
DECL|function|video_setup
r_int
id|__init
id|video_setup
c_func
(paren
r_char
op_star
id|options
)paren
(brace
r_int
id|i
comma
id|j
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|options
op_logical_or
op_logical_neg
op_star
id|options
)paren
r_return
l_int|0
suffix:semicolon
macro_line|#ifdef CONFIG_FB_OF
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|options
comma
l_string|&quot;ofonly&quot;
)paren
)paren
(brace
id|ofonly
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#endif
r_if
c_cond
(paren
id|num_pref_init_funcs
op_eq
id|FB_MAX
)paren
r_return
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|NUM_FB_DRIVERS
suffix:semicolon
id|i
op_increment
)paren
(brace
id|j
op_assign
id|strlen
c_func
(paren
id|fb_drivers
(braket
id|i
)braket
dot
id|name
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|options
comma
id|fb_drivers
(braket
id|i
)braket
dot
id|name
comma
id|j
)paren
op_logical_and
id|options
(braket
id|j
)braket
op_eq
l_char|&squot;:&squot;
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|options
op_plus
id|j
op_plus
l_int|1
comma
l_string|&quot;off&quot;
)paren
)paren
id|fb_drivers
(braket
id|i
)braket
dot
id|init
op_assign
l_int|NULL
suffix:semicolon
r_else
(brace
r_if
c_cond
(paren
id|fb_drivers
(braket
id|i
)braket
dot
id|init
)paren
(brace
id|pref_init_funcs
(braket
id|num_pref_init_funcs
op_increment
)braket
op_assign
id|fb_drivers
(braket
id|i
)braket
dot
id|init
suffix:semicolon
id|fb_drivers
(braket
id|i
)braket
dot
id|init
op_assign
l_int|NULL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|fb_drivers
(braket
id|i
)braket
dot
id|setup
)paren
id|fb_drivers
(braket
id|i
)braket
dot
id|setup
c_func
(paren
id|options
op_plus
id|j
op_plus
l_int|1
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
)brace
multiline_comment|/*&n;&t; * If we get here no fb was specified.&n;&t; * We consider the argument to be a global video mode option.&n;&t; */
id|global_mode_option
op_assign
id|options
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|__setup
c_func
(paren
l_string|&quot;video=&quot;
comma
id|video_setup
)paren
suffix:semicolon
multiline_comment|/*&n;     *  Visible symbols for modules&n;     */
DECL|variable|register_framebuffer
id|EXPORT_SYMBOL
c_func
(paren
id|register_framebuffer
)paren
suffix:semicolon
DECL|variable|unregister_framebuffer
id|EXPORT_SYMBOL
c_func
(paren
id|unregister_framebuffer
)paren
suffix:semicolon
DECL|variable|num_registered_fb
id|EXPORT_SYMBOL
c_func
(paren
id|num_registered_fb
)paren
suffix:semicolon
DECL|variable|registered_fb
id|EXPORT_SYMBOL
c_func
(paren
id|registered_fb
)paren
suffix:semicolon
DECL|variable|fb_prepare_logo
id|EXPORT_SYMBOL
c_func
(paren
id|fb_prepare_logo
)paren
suffix:semicolon
DECL|variable|fb_show_logo
id|EXPORT_SYMBOL
c_func
(paren
id|fb_show_logo
)paren
suffix:semicolon
DECL|variable|fb_set_var
id|EXPORT_SYMBOL
c_func
(paren
id|fb_set_var
)paren
suffix:semicolon
DECL|variable|fb_blank
id|EXPORT_SYMBOL
c_func
(paren
id|fb_blank
)paren
suffix:semicolon
DECL|variable|fb_pan_display
id|EXPORT_SYMBOL
c_func
(paren
id|fb_pan_display
)paren
suffix:semicolon
DECL|variable|fb_get_buffer_offset
id|EXPORT_SYMBOL
c_func
(paren
id|fb_get_buffer_offset
)paren
suffix:semicolon
DECL|variable|fb_iomove_buf_unaligned
id|EXPORT_SYMBOL
c_func
(paren
id|fb_iomove_buf_unaligned
)paren
suffix:semicolon
DECL|variable|fb_iomove_buf_aligned
id|EXPORT_SYMBOL
c_func
(paren
id|fb_iomove_buf_aligned
)paren
suffix:semicolon
DECL|variable|fb_sysmove_buf_unaligned
id|EXPORT_SYMBOL
c_func
(paren
id|fb_sysmove_buf_unaligned
)paren
suffix:semicolon
DECL|variable|fb_sysmove_buf_aligned
id|EXPORT_SYMBOL
c_func
(paren
id|fb_sysmove_buf_aligned
)paren
suffix:semicolon
DECL|variable|fb_load_cursor_image
id|EXPORT_SYMBOL
c_func
(paren
id|fb_load_cursor_image
)paren
suffix:semicolon
DECL|variable|fb_set_suspend
id|EXPORT_SYMBOL
c_func
(paren
id|fb_set_suspend
)paren
suffix:semicolon
DECL|variable|fb_register_client
id|EXPORT_SYMBOL
c_func
(paren
id|fb_register_client
)paren
suffix:semicolon
DECL|variable|fb_unregister_client
id|EXPORT_SYMBOL
c_func
(paren
id|fb_unregister_client
)paren
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
eof
