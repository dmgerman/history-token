multiline_comment|/*&n; *&n; * Hardware accelerated Matrox Millennium I, II, Mystique, G100, G200 and G400&n; *&n; * (c) 1998-2002 Petr Vandrovec &lt;vandrove@vc.cvut.cz&gt;&n; *&n; * Portions Copyright (c) 2001 Matrox Graphics Inc.&n; *&n; * Version: 1.65 2002/08/14&n; *&n; * MTRR stuff: 1998 Tom Rini &lt;trini@kernel.crashing.org&gt;&n; *&n; * Contributors: &quot;menion?&quot; &lt;menion@mindless.com&gt;&n; *                     Betatesting, fixes, ideas&n; *&n; *               &quot;Kurt Garloff&quot; &lt;garloff@suse.de&gt;&n; *                     Betatesting, fixes, ideas, videomodes, videomodes timmings&n; *&n; *               &quot;Tom Rini&quot; &lt;trini@kernel.crashing.org&gt;&n; *                     MTRR stuff, PPC cleanups, betatesting, fixes, ideas&n; *&n; *               &quot;Bibek Sahu&quot; &lt;scorpio@dodds.net&gt;&n; *                     Access device through readb|w|l and write b|w|l&n; *                     Extensive debugging stuff&n; *&n; *               &quot;Daniel Haun&quot; &lt;haund@usa.net&gt;&n; *                     Testing, hardware cursor fixes&n; *&n; *               &quot;Scott Wood&quot; &lt;sawst46+@pitt.edu&gt;&n; *                     Fixes&n; *&n; *               &quot;Gerd Knorr&quot; &lt;kraxel@goldbach.isdn.cs.tu-berlin.de&gt;&n; *                     Betatesting&n; *&n; *               &quot;Kelly French&quot; &lt;targon@hazmat.com&gt;&n; *               &quot;Fernando Herrera&quot; &lt;fherrera@eurielec.etsit.upm.es&gt;&n; *                     Betatesting, bug reporting&n; *&n; *               &quot;Pablo Bianucci&quot; &lt;pbian@pccp.com.ar&gt;&n; *                     Fixes, ideas, betatesting&n; *&n; *               &quot;Inaky Perez Gonzalez&quot; &lt;inaky@peloncho.fis.ucm.es&gt;&n; *                     Fixes, enhandcements, ideas, betatesting&n; *&n; *               &quot;Ryuichi Oikawa&quot; &lt;roikawa@rr.iiij4u.or.jp&gt;&n; *                     PPC betatesting, PPC support, backward compatibility&n; *&n; *               &quot;Paul Womar&quot; &lt;Paul@pwomar.demon.co.uk&gt;&n; *               &quot;Owen Waller&quot; &lt;O.Waller@ee.qub.ac.uk&gt;&n; *                     PPC betatesting&n; *&n; *               &quot;Thomas Pornin&quot; &lt;pornin@bolet.ens.fr&gt;&n; *                     Alpha betatesting&n; *&n; *               &quot;Pieter van Leuven&quot; &lt;pvl@iae.nl&gt;&n; *               &quot;Ulf Jaenicke-Roessler&quot; &lt;ujr@physik.phy.tu-dresden.de&gt;&n; *                     G100 testing&n; *&n; *               &quot;H. Peter Arvin&quot; &lt;hpa@transmeta.com&gt;&n; *                     Ideas&n; *&n; *               &quot;Cort Dougan&quot; &lt;cort@cs.nmt.edu&gt;&n; *                     CHRP fixes and PReP cleanup&n; *&n; *               &quot;Mark Vojkovich&quot; &lt;mvojkovi@ucsd.edu&gt;&n; *                     G400 support&n; *&n; *               &quot;Samuel Hocevar&quot; &lt;sam@via.ecp.fr&gt;&n; *                     Fixes&n; *&n; *               &quot;Anton Altaparmakov&quot; &lt;AntonA@bigfoot.com&gt;&n; *                     G400 MAX/non-MAX distinction&n; *&n; *               &quot;Ken Aaker&quot; &lt;kdaaker@rchland.vnet.ibm.com&gt;&n; *                     memtype extension (needed for GXT130P RS/6000 adapter)&n; *&n; *               &quot;Uns Lider&quot; &lt;unslider@miranda.org&gt;&n; *                     G100 PLNWT fixes&n; *&n; *               &quot;Denis Zaitsev&quot; &lt;zzz@cd-club.ru&gt;&n; *                     Fixes&n; *&n; *               &quot;Mike Pieper&quot; &lt;mike@pieper-family.de&gt;&n; *                     TVOut enhandcements, V4L2 control interface.&n; *&n; *               &quot;Diego Biurrun&quot; &lt;diego@biurrun.de&gt;&n; *                     DFP testing&n; *&n; * (following author is not in any relation with this code, but his code&n; *  is included in this driver)&n; *&n; * Based on framebuffer driver for VBE 2.0 compliant graphic boards&n; *     (c) 1998 Gerd Knorr &lt;kraxel@cs.tu-berlin.de&gt;&n; *&n; * (following author is not in any relation with this code, but his ideas&n; *  were used when writting this driver)&n; *&n; *&t;&t; FreeVBE/AF (Matrox), &quot;Shawn Hargreaves&quot; &lt;shawn@talula.demon.co.uk&gt;&n; *&n; */
multiline_comment|/* make checkconfig does not check included files... */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/version.h&gt;
macro_line|#include &quot;matroxfb_base.h&quot;
macro_line|#include &quot;matroxfb_misc.h&quot;
macro_line|#include &quot;matroxfb_accel.h&quot;
macro_line|#include &quot;matroxfb_DAC1064.h&quot;
macro_line|#include &quot;matroxfb_Ti3026.h&quot;
macro_line|#include &quot;matroxfb_maven.h&quot;
macro_line|#include &quot;matroxfb_crtc2.h&quot;
macro_line|#include &quot;matroxfb_g450.h&quot;
macro_line|#include &lt;linux/matroxfb.h&gt;
macro_line|#include &lt;linux/interrupt.h&gt;
macro_line|#include &lt;asm/uaccess.h&gt;
macro_line|#ifdef CONFIG_PPC_PMAC
r_int
r_char
id|nvram_read_byte
c_func
(paren
r_int
)paren
suffix:semicolon
DECL|variable|default_vmode
r_static
r_int
id|default_vmode
op_assign
id|VMODE_NVRAM
suffix:semicolon
DECL|variable|default_cmode
r_static
r_int
id|default_cmode
op_assign
id|CMODE_NVRAM
suffix:semicolon
macro_line|#endif
r_static
r_void
id|matroxfb_unregister_device
c_func
(paren
r_struct
id|matrox_fb_info
op_star
id|minfo
)paren
suffix:semicolon
multiline_comment|/* --------------------------------------------------------------------- */
multiline_comment|/*&n; * card parameters&n; */
multiline_comment|/* --------------------------------------------------------------------- */
DECL|variable|vesafb_defined
r_static
r_struct
id|fb_var_screeninfo
id|vesafb_defined
op_assign
(brace
l_int|640
comma
l_int|480
comma
l_int|640
comma
l_int|480
comma
multiline_comment|/* W,H, W, H (virtual) load xres,xres_virtual*/
l_int|0
comma
l_int|0
comma
multiline_comment|/* virtual -&gt; visible no offset */
l_int|8
comma
multiline_comment|/* depth -&gt; load bits_per_pixel */
l_int|0
comma
multiline_comment|/* greyscale ? */
(brace
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
multiline_comment|/* R */
(brace
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
multiline_comment|/* G */
(brace
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
multiline_comment|/* B */
(brace
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
multiline_comment|/* transparency */
l_int|0
comma
multiline_comment|/* standard pixel format */
id|FB_ACTIVATE_NOW
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
id|FB_ACCELF_TEXT
comma
multiline_comment|/* accel flags */
l_int|39721L
comma
l_int|48L
comma
l_int|16L
comma
l_int|33L
comma
l_int|10L
comma
l_int|96L
comma
l_int|2L
comma
op_complement
l_int|0
comma
multiline_comment|/* No sync info */
id|FB_VMODE_NONINTERLACED
comma
l_int|0
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
)brace
suffix:semicolon
multiline_comment|/* --------------------------------------------------------------------- */
DECL|function|update_crtc2
r_static
r_void
id|update_crtc2
c_func
(paren
id|WPMINFO
r_int
r_int
id|pos
)paren
(brace
r_struct
id|matroxfb_dh_fb_info
op_star
id|info
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|crtc2.info
)paren
suffix:semicolon
multiline_comment|/* Make sure that displays are compatible */
r_if
c_cond
(paren
id|info
op_logical_and
(paren
id|info-&gt;fbcon.var.bits_per_pixel
op_eq
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
dot
id|var.bits_per_pixel
)paren
op_logical_and
(paren
id|info-&gt;fbcon.var.xres_virtual
op_eq
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
dot
id|var.xres_virtual
)paren
op_logical_and
(paren
id|info-&gt;fbcon.var.green.length
op_eq
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
dot
id|var.green.length
)paren
)paren
(brace
r_switch
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
dot
id|var.bits_per_pixel
)paren
(brace
r_case
l_int|16
suffix:colon
r_case
l_int|32
suffix:colon
id|pos
op_assign
id|pos
op_star
l_int|8
suffix:semicolon
r_if
c_cond
(paren
id|info-&gt;interlaced
)paren
(brace
id|mga_outl
c_func
(paren
l_int|0x3C2C
comma
id|pos
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
l_int|0x3C28
comma
id|pos
op_plus
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
dot
id|var.xres_virtual
op_star
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
dot
id|var.bits_per_pixel
op_div
l_int|8
)paren
suffix:semicolon
)brace
r_else
(brace
id|mga_outl
c_func
(paren
l_int|0x3C28
comma
id|pos
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
)brace
)brace
)brace
DECL|function|matroxfb_crtc1_panpos
r_static
r_void
id|matroxfb_crtc1_panpos
c_func
(paren
id|WPMINFO2
)paren
(brace
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|crtc1.panpos
)paren
op_ge
l_int|0
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
r_int
id|panpos
suffix:semicolon
id|matroxfb_DAC_lock_irqsave
c_func
(paren
id|flags
)paren
suffix:semicolon
id|panpos
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|crtc1.panpos
)paren
suffix:semicolon
r_if
c_cond
(paren
id|panpos
op_ge
l_int|0
)paren
(brace
r_int
r_int
id|extvga_reg
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|crtc1.panpos
)paren
op_assign
op_minus
l_int|1
suffix:semicolon
multiline_comment|/* No update pending anymore */
id|extvga_reg
op_assign
id|mga_inb
c_func
(paren
id|M_EXTVGA_INDEX
)paren
suffix:semicolon
id|mga_setr
c_func
(paren
id|M_EXTVGA_INDEX
comma
l_int|0x00
comma
id|panpos
)paren
suffix:semicolon
r_if
c_cond
(paren
id|extvga_reg
op_ne
l_int|0x00
)paren
(brace
id|mga_outb
c_func
(paren
id|M_EXTVGA_INDEX
comma
id|extvga_reg
)paren
suffix:semicolon
)brace
)brace
id|matroxfb_DAC_unlock_irqrestore
c_func
(paren
id|flags
)paren
suffix:semicolon
)brace
)brace
DECL|function|matrox_irq
r_static
id|irqreturn_t
id|matrox_irq
c_func
(paren
r_int
id|irq
comma
r_void
op_star
id|dev_id
comma
r_struct
id|pt_regs
op_star
id|fp
)paren
(brace
id|u_int32_t
id|status
suffix:semicolon
r_int
id|handled
op_assign
l_int|0
suffix:semicolon
id|MINFO_FROM
c_func
(paren
id|dev_id
)paren
suffix:semicolon
id|status
op_assign
id|mga_inl
c_func
(paren
id|M_STATUS
)paren
suffix:semicolon
r_if
c_cond
(paren
id|status
op_amp
l_int|0x20
)paren
(brace
id|mga_outl
c_func
(paren
id|M_ICLEAR
comma
l_int|0x20
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|crtc1.vsync.cnt
)paren
op_increment
suffix:semicolon
id|matroxfb_crtc1_panpos
c_func
(paren
id|PMINFO2
)paren
suffix:semicolon
id|wake_up_interruptible
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|crtc1.vsync.wait
)paren
)paren
suffix:semicolon
id|handled
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|status
op_amp
l_int|0x200
)paren
(brace
id|mga_outl
c_func
(paren
id|M_ICLEAR
comma
l_int|0x200
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|crtc2.vsync.cnt
)paren
op_increment
suffix:semicolon
id|wake_up_interruptible
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|crtc2.vsync.wait
)paren
)paren
suffix:semicolon
id|handled
op_assign
l_int|1
suffix:semicolon
)brace
r_return
id|IRQ_RETVAL
c_func
(paren
id|handled
)paren
suffix:semicolon
)brace
DECL|function|matroxfb_enable_irq
r_int
id|matroxfb_enable_irq
c_func
(paren
id|WPMINFO
r_int
id|reenable
)paren
(brace
id|u_int32_t
id|bm
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.accelerator
)paren
op_eq
id|FB_ACCEL_MATROX_MGAG400
)paren
id|bm
op_assign
l_int|0x220
suffix:semicolon
r_else
id|bm
op_assign
l_int|0x020
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|test_and_set_bit
c_func
(paren
l_int|0
comma
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|irq_flags
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
id|request_irq
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
op_member_access_from_pointer
id|irq
comma
id|matrox_irq
comma
id|SA_SHIRQ
comma
l_string|&quot;matroxfb&quot;
comma
id|MINFO
)paren
)paren
(brace
id|clear_bit
c_func
(paren
l_int|0
comma
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|irq_flags
)paren
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
multiline_comment|/* Clear any pending field interrupts */
id|mga_outl
c_func
(paren
id|M_ICLEAR
comma
id|bm
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_IEN
comma
id|mga_inl
c_func
(paren
id|M_IEN
)paren
op_or
id|bm
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|reenable
)paren
(brace
id|u_int32_t
id|ien
suffix:semicolon
id|ien
op_assign
id|mga_inl
c_func
(paren
id|M_IEN
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|ien
op_amp
id|bm
)paren
op_ne
id|bm
)paren
(brace
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;matroxfb: someone disabled IRQ [%08X]&bslash;n&quot;
comma
id|ien
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_IEN
comma
id|ien
op_or
id|bm
)paren
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|matroxfb_disable_irq
r_static
r_void
id|matroxfb_disable_irq
c_func
(paren
id|WPMINFO2
)paren
(brace
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
l_int|0
comma
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|irq_flags
)paren
)paren
)paren
(brace
multiline_comment|/* Flush pending pan-at-vbl request... */
id|matroxfb_crtc1_panpos
c_func
(paren
id|PMINFO2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.accelerator
)paren
op_eq
id|FB_ACCEL_MATROX_MGAG400
)paren
id|mga_outl
c_func
(paren
id|M_IEN
comma
id|mga_inl
c_func
(paren
id|M_IEN
)paren
op_amp
op_complement
l_int|0x220
)paren
suffix:semicolon
r_else
id|mga_outl
c_func
(paren
id|M_IEN
comma
id|mga_inl
c_func
(paren
id|M_IEN
)paren
op_amp
op_complement
l_int|0x20
)paren
suffix:semicolon
id|free_irq
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
op_member_access_from_pointer
id|irq
comma
id|MINFO
)paren
suffix:semicolon
)brace
)brace
DECL|function|matroxfb_wait_for_sync
r_int
id|matroxfb_wait_for_sync
c_func
(paren
id|WPMINFO
id|u_int32_t
id|crtc
)paren
(brace
id|wait_queue_t
id|__wait
suffix:semicolon
r_struct
id|matrox_vsync
op_star
id|vs
suffix:semicolon
r_int
r_int
id|cnt
suffix:semicolon
r_int
id|ret
suffix:semicolon
r_switch
c_cond
(paren
id|crtc
)paren
(brace
r_case
l_int|0
suffix:colon
id|vs
op_assign
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|crtc1.vsync
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.accelerator
)paren
op_ne
id|FB_ACCEL_MATROX_MGAG400
)paren
(brace
r_return
op_minus
id|ENODEV
suffix:semicolon
)brace
id|vs
op_assign
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|crtc2.vsync
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
id|ENODEV
suffix:semicolon
)brace
id|ret
op_assign
id|matroxfb_enable_irq
c_func
(paren
id|PMINFO
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
r_return
id|ret
suffix:semicolon
)brace
id|init_waitqueue_entry
c_func
(paren
op_amp
id|__wait
comma
id|current
)paren
suffix:semicolon
id|cnt
op_assign
id|vs-&gt;cnt
suffix:semicolon
id|ret
op_assign
id|wait_event_interruptible_timeout
c_func
(paren
id|vs-&gt;wait
comma
id|cnt
op_ne
id|vs-&gt;cnt
comma
id|HZ
op_div
l_int|10
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
OL
l_int|0
)paren
(brace
r_return
id|ret
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ret
op_eq
l_int|0
)paren
(brace
id|matroxfb_enable_irq
c_func
(paren
id|PMINFO
l_int|1
)paren
suffix:semicolon
r_return
op_minus
id|ETIMEDOUT
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* --------------------------------------------------------------------- */
DECL|function|matrox_pan_var
r_static
r_void
id|matrox_pan_var
c_func
(paren
id|WPMINFO
r_struct
id|fb_var_screeninfo
op_star
id|var
)paren
(brace
r_int
r_int
id|pos
suffix:semicolon
r_int
r_int
id|p0
comma
id|p1
comma
id|p2
suffix:semicolon
macro_line|#ifdef CONFIG_FB_MATROX_32MB
r_int
r_int
id|p3
suffix:semicolon
macro_line|#endif
r_int
id|vbl
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|CRITFLAGS
id|DBG
c_func
(paren
id|__FUNCTION__
)paren
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|dead
)paren
)paren
r_return
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
dot
id|var.xoffset
op_assign
id|var-&gt;xoffset
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
dot
id|var.yoffset
op_assign
id|var-&gt;yoffset
suffix:semicolon
id|pos
op_assign
(paren
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
dot
id|var.yoffset
op_star
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
dot
id|var.xres_virtual
op_plus
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
dot
id|var.xoffset
)paren
op_star
id|ACCESS_FBINFO
c_func
(paren
id|curr.final_bppShift
)paren
op_div
l_int|32
suffix:semicolon
id|pos
op_add_assign
id|ACCESS_FBINFO
c_func
(paren
id|curr.ydstorg.chunks
)paren
suffix:semicolon
id|p0
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|hw
)paren
dot
id|CRTC
(braket
l_int|0x0D
)braket
op_assign
id|pos
op_amp
l_int|0xFF
suffix:semicolon
id|p1
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|hw
)paren
dot
id|CRTC
(braket
l_int|0x0C
)braket
op_assign
(paren
id|pos
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
suffix:semicolon
id|p2
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|hw
)paren
dot
id|CRTCEXT
(braket
l_int|0
)braket
op_assign
(paren
id|ACCESS_FBINFO
c_func
(paren
id|hw
)paren
dot
id|CRTCEXT
(braket
l_int|0
)braket
op_amp
l_int|0xB0
)paren
op_or
(paren
(paren
id|pos
op_rshift
l_int|16
)paren
op_amp
l_int|0x0F
)paren
op_or
(paren
(paren
id|pos
op_rshift
l_int|14
)paren
op_amp
l_int|0x40
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_FB_MATROX_32MB
id|p3
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|hw
)paren
dot
id|CRTCEXT
(braket
l_int|8
)braket
op_assign
id|pos
op_rshift
l_int|21
suffix:semicolon
macro_line|#endif
multiline_comment|/* FB_ACTIVATE_VBL and we can acquire interrupts? Honor FB_ACTIVATE_VBL then... */
id|vbl
op_assign
(paren
id|var-&gt;activate
op_amp
id|FB_ACTIVATE_VBL
)paren
op_logical_and
(paren
id|matroxfb_enable_irq
c_func
(paren
id|PMINFO
l_int|0
)paren
op_eq
l_int|0
)paren
suffix:semicolon
id|CRITBEGIN
id|matroxfb_DAC_lock_irqsave
c_func
(paren
id|flags
)paren
suffix:semicolon
id|mga_setr
c_func
(paren
id|M_CRTC_INDEX
comma
l_int|0x0D
comma
id|p0
)paren
suffix:semicolon
id|mga_setr
c_func
(paren
id|M_CRTC_INDEX
comma
l_int|0x0C
comma
id|p1
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_FB_MATROX_32MB
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.support32MB
)paren
)paren
id|mga_setr
c_func
(paren
id|M_EXTVGA_INDEX
comma
l_int|0x08
comma
id|p3
)paren
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
id|vbl
)paren
(brace
id|ACCESS_FBINFO
c_func
(paren
id|crtc1.panpos
)paren
op_assign
id|p2
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* Abort any pending change */
id|ACCESS_FBINFO
c_func
(paren
id|crtc1.panpos
)paren
op_assign
op_minus
l_int|1
suffix:semicolon
id|mga_setr
c_func
(paren
id|M_EXTVGA_INDEX
comma
l_int|0x00
comma
id|p2
)paren
suffix:semicolon
)brace
id|matroxfb_DAC_unlock_irqrestore
c_func
(paren
id|flags
)paren
suffix:semicolon
id|update_crtc2
c_func
(paren
id|PMINFO
id|pos
)paren
suffix:semicolon
id|CRITEND
)brace
DECL|function|matroxfb_remove
r_static
r_void
id|matroxfb_remove
c_func
(paren
id|WPMINFO
r_int
id|dummy
)paren
(brace
multiline_comment|/* Currently we are holding big kernel lock on all dead &amp; usecount updates.&n;&t; * Destroy everything after all users release it. Especially do not unregister&n;&t; * framebuffer and iounmap memory, neither fbmem nor fbcon-cfb* does not check&n;&t; * for device unplugged when in use.&n;&t; * In future we should point mmio.vbase &amp; video.vbase somewhere where we can&n;&t; * write data without causing too much damage...&n;&t; */
id|ACCESS_FBINFO
c_func
(paren
id|dead
)paren
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|usecount
)paren
)paren
(brace
multiline_comment|/* destroy it later */
r_return
suffix:semicolon
)brace
id|matroxfb_unregister_device
c_func
(paren
id|MINFO
)paren
suffix:semicolon
id|unregister_framebuffer
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
)paren
suffix:semicolon
id|matroxfb_g450_shutdown
c_func
(paren
id|PMINFO2
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_MTRR
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|mtrr.vram_valid
)paren
)paren
id|mtrr_del
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|mtrr.vram
)paren
comma
id|ACCESS_FBINFO
c_func
(paren
id|video.base
)paren
comma
id|ACCESS_FBINFO
c_func
(paren
id|video.len
)paren
)paren
suffix:semicolon
macro_line|#endif
id|mga_iounmap
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|mmio.vbase
)paren
)paren
suffix:semicolon
id|mga_iounmap
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
)paren
suffix:semicolon
id|release_mem_region
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|video.base
)paren
comma
id|ACCESS_FBINFO
c_func
(paren
id|video.len_maximum
)paren
)paren
suffix:semicolon
id|release_mem_region
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|mmio.base
)paren
comma
l_int|16384
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_FB_MATROX_MULTIHEAD
id|kfree
c_func
(paren
id|minfo
)paren
suffix:semicolon
macro_line|#endif
)brace
multiline_comment|/*&n;&t; * Open/Release the frame buffer device&n;&t; */
DECL|function|matroxfb_open
r_static
r_int
id|matroxfb_open
c_func
(paren
r_struct
id|fb_info
op_star
id|info
comma
r_int
id|user
)paren
(brace
id|MINFO_FROM_INFO
c_func
(paren
id|info
)paren
suffix:semicolon
id|DBG_LOOP
c_func
(paren
id|__FUNCTION__
)paren
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|dead
)paren
)paren
(brace
r_return
op_minus
id|ENXIO
suffix:semicolon
)brace
id|ACCESS_FBINFO
c_func
(paren
id|usecount
)paren
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|user
)paren
(brace
id|ACCESS_FBINFO
c_func
(paren
id|userusecount
)paren
op_increment
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|matroxfb_release
r_static
r_int
id|matroxfb_release
c_func
(paren
r_struct
id|fb_info
op_star
id|info
comma
r_int
id|user
)paren
(brace
id|MINFO_FROM_INFO
c_func
(paren
id|info
)paren
suffix:semicolon
id|DBG_LOOP
c_func
(paren
id|__FUNCTION__
)paren
r_if
c_cond
(paren
id|user
)paren
(brace
r_if
c_cond
(paren
l_int|0
op_eq
op_decrement
id|ACCESS_FBINFO
c_func
(paren
id|userusecount
)paren
)paren
(brace
id|matroxfb_disable_irq
c_func
(paren
id|PMINFO2
)paren
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
op_decrement
id|ACCESS_FBINFO
c_func
(paren
id|usecount
)paren
)paren
op_logical_and
id|ACCESS_FBINFO
c_func
(paren
id|dead
)paren
)paren
(brace
id|matroxfb_remove
c_func
(paren
id|PMINFO
l_int|0
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|matroxfb_pan_display
r_static
r_int
id|matroxfb_pan_display
c_func
(paren
r_struct
id|fb_var_screeninfo
op_star
id|var
comma
r_struct
id|fb_info
op_star
id|info
)paren
(brace
id|MINFO_FROM_INFO
c_func
(paren
id|info
)paren
suffix:semicolon
id|DBG
c_func
(paren
id|__FUNCTION__
)paren
id|matrox_pan_var
c_func
(paren
id|PMINFO
id|var
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|matroxfb_get_final_bppShift
r_static
r_int
id|matroxfb_get_final_bppShift
c_func
(paren
id|CPMINFO
r_int
id|bpp
)paren
(brace
r_int
id|bppshft2
suffix:semicolon
id|DBG
c_func
(paren
id|__FUNCTION__
)paren
id|bppshft2
op_assign
id|bpp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|bppshft2
)paren
(brace
r_return
l_int|8
suffix:semicolon
)brace
r_if
c_cond
(paren
id|isInterleave
c_func
(paren
id|MINFO
)paren
)paren
id|bppshft2
op_rshift_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.video64bits
)paren
)paren
id|bppshft2
op_rshift_assign
l_int|1
suffix:semicolon
r_return
id|bppshft2
suffix:semicolon
)brace
DECL|function|matroxfb_test_and_set_rounding
r_static
r_int
id|matroxfb_test_and_set_rounding
c_func
(paren
id|CPMINFO
r_int
id|xres
comma
r_int
id|bpp
)paren
(brace
r_int
id|over
suffix:semicolon
r_int
id|rounding
suffix:semicolon
id|DBG
c_func
(paren
id|__FUNCTION__
)paren
r_switch
c_cond
(paren
id|bpp
)paren
(brace
r_case
l_int|0
suffix:colon
r_return
id|xres
suffix:semicolon
r_case
l_int|4
suffix:colon
id|rounding
op_assign
l_int|128
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|8
suffix:colon
id|rounding
op_assign
l_int|64
suffix:semicolon
multiline_comment|/* doc says 64; 32 is OK for G400 */
r_break
suffix:semicolon
r_case
l_int|16
suffix:colon
id|rounding
op_assign
l_int|32
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|24
suffix:colon
id|rounding
op_assign
l_int|64
suffix:semicolon
multiline_comment|/* doc says 64; 32 is OK for G400 */
r_break
suffix:semicolon
r_default
suffix:colon
id|rounding
op_assign
l_int|16
suffix:semicolon
multiline_comment|/* on G400, 16 really does not work */
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.accelerator
)paren
op_eq
id|FB_ACCEL_MATROX_MGAG400
)paren
id|rounding
op_assign
l_int|32
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|isInterleave
c_func
(paren
id|MINFO
)paren
)paren
(brace
id|rounding
op_mul_assign
l_int|2
suffix:semicolon
)brace
id|over
op_assign
id|xres
op_mod
id|rounding
suffix:semicolon
r_if
c_cond
(paren
id|over
)paren
id|xres
op_add_assign
id|rounding
op_minus
id|over
suffix:semicolon
r_return
id|xres
suffix:semicolon
)brace
DECL|function|matroxfb_pitch_adjust
r_static
r_int
id|matroxfb_pitch_adjust
c_func
(paren
id|CPMINFO
r_int
id|xres
comma
r_int
id|bpp
)paren
(brace
r_const
r_int
op_star
id|width
suffix:semicolon
r_int
id|xres_new
suffix:semicolon
id|DBG
c_func
(paren
id|__FUNCTION__
)paren
r_if
c_cond
(paren
op_logical_neg
id|bpp
)paren
r_return
id|xres
suffix:semicolon
id|width
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|capable.vxres
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.precise_width
)paren
)paren
(brace
r_while
c_loop
(paren
op_star
id|width
)paren
(brace
r_if
c_cond
(paren
(paren
op_star
id|width
op_ge
id|xres
)paren
op_logical_and
(paren
id|matroxfb_test_and_set_rounding
c_func
(paren
id|PMINFO
op_star
id|width
comma
id|bpp
)paren
op_eq
op_star
id|width
)paren
)paren
(brace
r_break
suffix:semicolon
)brace
id|width
op_increment
suffix:semicolon
)brace
id|xres_new
op_assign
op_star
id|width
suffix:semicolon
)brace
r_else
(brace
id|xres_new
op_assign
id|matroxfb_test_and_set_rounding
c_func
(paren
id|PMINFO
id|xres
comma
id|bpp
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|xres_new
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|xres
op_ne
id|xres_new
)paren
(brace
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;matroxfb: cannot set xres to %d, rounded up to %d&bslash;n&quot;
comma
id|xres
comma
id|xres_new
)paren
suffix:semicolon
)brace
r_return
id|xres_new
suffix:semicolon
)brace
DECL|function|matroxfb_get_cmap_len
r_static
r_int
id|matroxfb_get_cmap_len
c_func
(paren
r_struct
id|fb_var_screeninfo
op_star
id|var
)paren
(brace
id|DBG
c_func
(paren
id|__FUNCTION__
)paren
r_switch
c_cond
(paren
id|var-&gt;bits_per_pixel
)paren
(brace
r_case
l_int|4
suffix:colon
r_return
l_int|16
suffix:semicolon
multiline_comment|/* pseudocolor... 16 entries HW palette */
r_case
l_int|8
suffix:colon
r_return
l_int|256
suffix:semicolon
multiline_comment|/* pseudocolor... 256 entries HW palette */
r_case
l_int|16
suffix:colon
r_return
l_int|16
suffix:semicolon
multiline_comment|/* directcolor... 16 entries SW palette */
multiline_comment|/* Mystique: truecolor, 16 entries SW palette, HW palette hardwired into 1:1 mapping */
r_case
l_int|24
suffix:colon
r_return
l_int|16
suffix:semicolon
multiline_comment|/* directcolor... 16 entries SW palette */
multiline_comment|/* Mystique: truecolor, 16 entries SW palette, HW palette hardwired into 1:1 mapping */
r_case
l_int|32
suffix:colon
r_return
l_int|16
suffix:semicolon
multiline_comment|/* directcolor... 16 entries SW palette */
multiline_comment|/* Mystique: truecolor, 16 entries SW palette, HW palette hardwired into 1:1 mapping */
)brace
r_return
l_int|16
suffix:semicolon
multiline_comment|/* return something reasonable... or panic()? */
)brace
DECL|function|matroxfb_decode_var
r_static
r_int
id|matroxfb_decode_var
c_func
(paren
id|CPMINFO
r_struct
id|fb_var_screeninfo
op_star
id|var
comma
r_int
op_star
id|visual
comma
r_int
op_star
id|video_cmap_len
comma
r_int
r_int
op_star
id|ydstorg
)paren
(brace
r_struct
id|RGBT
(brace
r_int
r_char
id|bpp
suffix:semicolon
r_struct
(brace
r_int
r_char
id|offset
comma
id|length
suffix:semicolon
)brace
id|red
comma
id|green
comma
id|blue
comma
id|transp
suffix:semicolon
r_int
r_char
id|visual
suffix:semicolon
)brace
suffix:semicolon
r_static
r_const
r_struct
id|RGBT
id|table
(braket
)braket
op_assign
(brace
(brace
l_int|8
comma
(brace
l_int|0
comma
l_int|8
)brace
comma
(brace
l_int|0
comma
l_int|8
)brace
comma
(brace
l_int|0
comma
l_int|8
)brace
comma
(brace
l_int|0
comma
l_int|0
)brace
comma
id|MX_VISUAL_PSEUDOCOLOR
)brace
comma
(brace
l_int|15
comma
(brace
l_int|10
comma
l_int|5
)brace
comma
(brace
l_int|5
comma
l_int|5
)brace
comma
(brace
l_int|0
comma
l_int|5
)brace
comma
(brace
l_int|15
comma
l_int|1
)brace
comma
id|MX_VISUAL_DIRECTCOLOR
)brace
comma
(brace
l_int|16
comma
(brace
l_int|11
comma
l_int|5
)brace
comma
(brace
l_int|5
comma
l_int|6
)brace
comma
(brace
l_int|0
comma
l_int|5
)brace
comma
(brace
l_int|0
comma
l_int|0
)brace
comma
id|MX_VISUAL_DIRECTCOLOR
)brace
comma
(brace
l_int|24
comma
(brace
l_int|16
comma
l_int|8
)brace
comma
(brace
l_int|8
comma
l_int|8
)brace
comma
(brace
l_int|0
comma
l_int|8
)brace
comma
(brace
l_int|0
comma
l_int|0
)brace
comma
id|MX_VISUAL_DIRECTCOLOR
)brace
comma
(brace
l_int|32
comma
(brace
l_int|16
comma
l_int|8
)brace
comma
(brace
l_int|8
comma
l_int|8
)brace
comma
(brace
l_int|0
comma
l_int|8
)brace
comma
(brace
l_int|24
comma
l_int|8
)brace
comma
id|MX_VISUAL_DIRECTCOLOR
)brace
)brace
suffix:semicolon
r_struct
id|RGBT
r_const
op_star
id|rgbt
suffix:semicolon
r_int
r_int
id|bpp
op_assign
id|var-&gt;bits_per_pixel
suffix:semicolon
r_int
r_int
id|vramlen
suffix:semicolon
r_int
r_int
id|memlen
suffix:semicolon
id|DBG
c_func
(paren
id|__FUNCTION__
)paren
r_switch
c_cond
(paren
id|bpp
)paren
(brace
r_case
l_int|4
suffix:colon
r_if
c_cond
(paren
op_logical_neg
id|ACCESS_FBINFO
c_func
(paren
id|capable.cfb4
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|8
suffix:colon
r_break
suffix:semicolon
r_case
l_int|16
suffix:colon
r_break
suffix:semicolon
r_case
l_int|24
suffix:colon
r_break
suffix:semicolon
r_case
l_int|32
suffix:colon
r_break
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
op_star
id|ydstorg
op_assign
l_int|0
suffix:semicolon
id|vramlen
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|video.len_usable
)paren
suffix:semicolon
r_if
c_cond
(paren
id|var-&gt;yres_virtual
OL
id|var-&gt;yres
)paren
id|var-&gt;yres_virtual
op_assign
id|var-&gt;yres
suffix:semicolon
r_if
c_cond
(paren
id|var-&gt;xres_virtual
OL
id|var-&gt;xres
)paren
id|var-&gt;xres_virtual
op_assign
id|var-&gt;xres
suffix:semicolon
id|var-&gt;xres_virtual
op_assign
id|matroxfb_pitch_adjust
c_func
(paren
id|PMINFO
id|var-&gt;xres_virtual
comma
id|bpp
)paren
suffix:semicolon
id|memlen
op_assign
id|var-&gt;xres_virtual
op_star
id|bpp
op_star
id|var-&gt;yres_virtual
op_div
l_int|8
suffix:semicolon
r_if
c_cond
(paren
id|memlen
OG
id|vramlen
)paren
(brace
id|var-&gt;yres_virtual
op_assign
id|vramlen
op_star
l_int|8
op_div
(paren
id|var-&gt;xres_virtual
op_star
id|bpp
)paren
suffix:semicolon
id|memlen
op_assign
id|var-&gt;xres_virtual
op_star
id|bpp
op_star
id|var-&gt;yres_virtual
op_div
l_int|8
suffix:semicolon
)brace
multiline_comment|/* There is hardware bug that no line can cross 4MB boundary */
multiline_comment|/* give up for CFB24, it is impossible to easy workaround it */
multiline_comment|/* for other try to do something */
r_if
c_cond
(paren
op_logical_neg
id|ACCESS_FBINFO
c_func
(paren
id|capable.cross4MB
)paren
op_logical_and
(paren
id|memlen
OG
l_int|0x400000
)paren
)paren
(brace
r_if
c_cond
(paren
id|bpp
op_eq
l_int|24
)paren
(brace
multiline_comment|/* sorry */
)brace
r_else
(brace
r_int
r_int
id|linelen
suffix:semicolon
r_int
r_int
id|m1
op_assign
id|linelen
op_assign
id|var-&gt;xres_virtual
op_star
id|bpp
op_div
l_int|8
suffix:semicolon
r_int
r_int
id|m2
op_assign
id|PAGE_SIZE
suffix:semicolon
multiline_comment|/* or 128 if you do not need PAGE ALIGNED address */
r_int
r_int
id|max_yres
suffix:semicolon
r_while
c_loop
(paren
id|m1
)paren
(brace
r_int
id|t
suffix:semicolon
r_while
c_loop
(paren
id|m2
op_ge
id|m1
)paren
id|m2
op_sub_assign
id|m1
suffix:semicolon
id|t
op_assign
id|m1
suffix:semicolon
id|m1
op_assign
id|m2
suffix:semicolon
id|m2
op_assign
id|t
suffix:semicolon
)brace
id|m2
op_assign
id|linelen
op_star
id|PAGE_SIZE
op_div
id|m2
suffix:semicolon
op_star
id|ydstorg
op_assign
id|m2
op_assign
l_int|0x400000
op_mod
id|m2
suffix:semicolon
id|max_yres
op_assign
(paren
id|vramlen
op_minus
id|m2
)paren
op_div
id|linelen
suffix:semicolon
r_if
c_cond
(paren
id|var-&gt;yres_virtual
OG
id|max_yres
)paren
id|var-&gt;yres_virtual
op_assign
id|max_yres
suffix:semicolon
)brace
)brace
multiline_comment|/* YDSTLEN contains only signed 16bit value */
r_if
c_cond
(paren
id|var-&gt;yres_virtual
OG
l_int|32767
)paren
id|var-&gt;yres_virtual
op_assign
l_int|32767
suffix:semicolon
multiline_comment|/* we must round yres/xres down, we already rounded y/xres_virtual up&n;&t;   if it was possible. We should return -EINVAL, but I disagree */
r_if
c_cond
(paren
id|var-&gt;yres_virtual
OL
id|var-&gt;yres
)paren
id|var-&gt;yres
op_assign
id|var-&gt;yres_virtual
suffix:semicolon
r_if
c_cond
(paren
id|var-&gt;xres_virtual
OL
id|var-&gt;xres
)paren
id|var-&gt;xres
op_assign
id|var-&gt;xres_virtual
suffix:semicolon
r_if
c_cond
(paren
id|var-&gt;xoffset
op_plus
id|var-&gt;xres
OG
id|var-&gt;xres_virtual
)paren
id|var-&gt;xoffset
op_assign
id|var-&gt;xres_virtual
op_minus
id|var-&gt;xres
suffix:semicolon
r_if
c_cond
(paren
id|var-&gt;yoffset
op_plus
id|var-&gt;yres
OG
id|var-&gt;yres_virtual
)paren
id|var-&gt;yoffset
op_assign
id|var-&gt;yres_virtual
op_minus
id|var-&gt;yres
suffix:semicolon
r_if
c_cond
(paren
id|bpp
op_eq
l_int|16
op_logical_and
id|var-&gt;green.length
op_eq
l_int|5
)paren
(brace
id|bpp
op_decrement
suffix:semicolon
multiline_comment|/* an artifical value - 15 */
)brace
r_for
c_loop
(paren
id|rgbt
op_assign
id|table
suffix:semicolon
id|rgbt-&gt;bpp
OL
id|bpp
suffix:semicolon
id|rgbt
op_increment
)paren
suffix:semicolon
DECL|macro|SETCLR
mdefine_line|#define&t;SETCLR(clr)&bslash;&n;&t;var-&gt;clr.offset = rgbt-&gt;clr.offset;&bslash;&n;&t;var-&gt;clr.length = rgbt-&gt;clr.length
id|SETCLR
c_func
(paren
id|red
)paren
suffix:semicolon
id|SETCLR
c_func
(paren
id|green
)paren
suffix:semicolon
id|SETCLR
c_func
(paren
id|blue
)paren
suffix:semicolon
id|SETCLR
c_func
(paren
id|transp
)paren
suffix:semicolon
DECL|macro|SETCLR
macro_line|#undef&t;SETCLR
op_star
id|visual
op_assign
id|rgbt-&gt;visual
suffix:semicolon
r_if
c_cond
(paren
id|bpp
OG
l_int|8
)paren
id|dprintk
c_func
(paren
l_string|&quot;matroxfb: truecolor: &quot;
l_string|&quot;size=%d:%d:%d:%d, shift=%d:%d:%d:%d&bslash;n&quot;
comma
id|var-&gt;transp.length
comma
id|var-&gt;red.length
comma
id|var-&gt;green.length
comma
id|var-&gt;blue.length
comma
id|var-&gt;transp.offset
comma
id|var-&gt;red.offset
comma
id|var-&gt;green.offset
comma
id|var-&gt;blue.offset
)paren
suffix:semicolon
op_star
id|video_cmap_len
op_assign
id|matroxfb_get_cmap_len
c_func
(paren
id|var
)paren
suffix:semicolon
id|dprintk
c_func
(paren
id|KERN_INFO
l_string|&quot;requested %d*%d/%dbpp (%d*%d)&bslash;n&quot;
comma
id|var-&gt;xres
comma
id|var-&gt;yres
comma
id|var-&gt;bits_per_pixel
comma
id|var-&gt;xres_virtual
comma
id|var-&gt;yres_virtual
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|matroxfb_setcolreg
r_static
r_int
id|matroxfb_setcolreg
c_func
(paren
r_int
id|regno
comma
r_int
id|red
comma
r_int
id|green
comma
r_int
id|blue
comma
r_int
id|transp
comma
r_struct
id|fb_info
op_star
id|fb_info
)paren
(brace
macro_line|#ifdef CONFIG_FB_MATROX_MULTIHEAD
r_struct
id|matrox_fb_info
op_star
id|minfo
op_assign
id|container_of
c_func
(paren
id|fb_info
comma
r_struct
id|matrox_fb_info
comma
id|fbcon
)paren
suffix:semicolon
macro_line|#endif
id|DBG
c_func
(paren
id|__FUNCTION__
)paren
multiline_comment|/*&n;&t; *  Set a single color register. The values supplied are&n;&t; *  already rounded down to the hardware&squot;s capabilities&n;&t; *  (according to the entries in the `var&squot; structure). Return&n;&t; *  != 0 for invalid regno.&n;&t; */
r_if
c_cond
(paren
id|regno
op_ge
id|ACCESS_FBINFO
c_func
(paren
id|curr.cmap_len
)paren
)paren
r_return
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
dot
id|var.grayscale
)paren
(brace
multiline_comment|/* gray = 0.30*R + 0.59*G + 0.11*B */
id|red
op_assign
id|green
op_assign
id|blue
op_assign
(paren
id|red
op_star
l_int|77
op_plus
id|green
op_star
l_int|151
op_plus
id|blue
op_star
l_int|28
)paren
op_rshift
l_int|8
suffix:semicolon
)brace
id|red
op_assign
id|CNVT_TOHW
c_func
(paren
id|red
comma
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
dot
id|var.red.length
)paren
suffix:semicolon
id|green
op_assign
id|CNVT_TOHW
c_func
(paren
id|green
comma
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
dot
id|var.green.length
)paren
suffix:semicolon
id|blue
op_assign
id|CNVT_TOHW
c_func
(paren
id|blue
comma
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
dot
id|var.blue.length
)paren
suffix:semicolon
id|transp
op_assign
id|CNVT_TOHW
c_func
(paren
id|transp
comma
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
dot
id|var.transp.length
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
dot
id|var.bits_per_pixel
)paren
(brace
r_case
l_int|4
suffix:colon
r_case
l_int|8
suffix:colon
id|mga_outb
c_func
(paren
id|M_DAC_REG
comma
id|regno
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_DAC_VAL
comma
id|red
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_DAC_VAL
comma
id|green
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_DAC_VAL
comma
id|blue
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|16
suffix:colon
(brace
id|u_int16_t
id|col
op_assign
(paren
id|red
op_lshift
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
dot
id|var.red.offset
)paren
op_or
(paren
id|green
op_lshift
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
dot
id|var.green.offset
)paren
op_or
(paren
id|blue
op_lshift
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
dot
id|var.blue.offset
)paren
op_or
(paren
id|transp
op_lshift
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
dot
id|var.transp.offset
)paren
suffix:semicolon
multiline_comment|/* for 1:5:5:5 */
id|ACCESS_FBINFO
c_func
(paren
id|cmap
(braket
id|regno
)braket
)paren
op_assign
id|col
op_or
(paren
id|col
op_lshift
l_int|16
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
l_int|24
suffix:colon
r_case
l_int|32
suffix:colon
id|ACCESS_FBINFO
c_func
(paren
id|cmap
(braket
id|regno
)braket
)paren
op_assign
(paren
id|red
op_lshift
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
dot
id|var.red.offset
)paren
op_or
(paren
id|green
op_lshift
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
dot
id|var.green.offset
)paren
op_or
(paren
id|blue
op_lshift
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
dot
id|var.blue.offset
)paren
op_or
(paren
id|transp
op_lshift
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
dot
id|var.transp.offset
)paren
suffix:semicolon
multiline_comment|/* 8:8:8:8 */
r_break
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|matroxfb_init_fix
r_static
r_void
id|matroxfb_init_fix
c_func
(paren
id|WPMINFO2
)paren
(brace
r_struct
id|fb_fix_screeninfo
op_star
id|fix
op_assign
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
dot
id|fix
suffix:semicolon
id|DBG
c_func
(paren
id|__FUNCTION__
)paren
id|strcpy
c_func
(paren
id|fix-&gt;id
comma
l_string|&quot;MATROX&quot;
)paren
suffix:semicolon
id|fix-&gt;xpanstep
op_assign
l_int|8
suffix:semicolon
multiline_comment|/* 8 for 8bpp, 4 for 16bpp, 2 for 32bpp */
id|fix-&gt;ypanstep
op_assign
l_int|1
suffix:semicolon
id|fix-&gt;ywrapstep
op_assign
l_int|0
suffix:semicolon
id|fix-&gt;mmio_start
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|mmio.base
)paren
suffix:semicolon
id|fix-&gt;mmio_len
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|mmio.len
)paren
suffix:semicolon
id|fix-&gt;accel
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|devflags.accelerator
)paren
suffix:semicolon
)brace
DECL|function|matroxfb_update_fix
r_static
r_void
id|matroxfb_update_fix
c_func
(paren
id|WPMINFO2
)paren
(brace
r_struct
id|fb_fix_screeninfo
op_star
id|fix
op_assign
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
dot
id|fix
suffix:semicolon
id|DBG
c_func
(paren
id|__FUNCTION__
)paren
id|fix-&gt;smem_start
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|video.base
)paren
op_plus
id|ACCESS_FBINFO
c_func
(paren
id|curr.ydstorg.bytes
)paren
suffix:semicolon
id|fix-&gt;smem_len
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|video.len_usable
)paren
op_minus
id|ACCESS_FBINFO
c_func
(paren
id|curr.ydstorg.bytes
)paren
suffix:semicolon
)brace
DECL|function|matroxfb_check_var
r_static
r_int
id|matroxfb_check_var
c_func
(paren
r_struct
id|fb_var_screeninfo
op_star
id|var
comma
r_struct
id|fb_info
op_star
id|info
)paren
(brace
r_int
id|err
suffix:semicolon
r_int
id|visual
suffix:semicolon
r_int
id|cmap_len
suffix:semicolon
r_int
r_int
id|ydstorg
suffix:semicolon
id|MINFO_FROM_INFO
c_func
(paren
id|info
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|dead
)paren
)paren
(brace
r_return
op_minus
id|ENXIO
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|matroxfb_decode_var
c_func
(paren
id|PMINFO
id|var
comma
op_amp
id|visual
comma
op_amp
id|cmap_len
comma
op_amp
id|ydstorg
)paren
)paren
op_ne
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|matroxfb_set_par
r_static
r_int
id|matroxfb_set_par
c_func
(paren
r_struct
id|fb_info
op_star
id|info
)paren
(brace
r_int
id|err
suffix:semicolon
r_int
id|visual
suffix:semicolon
r_int
id|cmap_len
suffix:semicolon
r_int
r_int
id|ydstorg
suffix:semicolon
r_struct
id|fb_var_screeninfo
op_star
id|var
suffix:semicolon
id|MINFO_FROM_INFO
c_func
(paren
id|info
)paren
suffix:semicolon
id|DBG
c_func
(paren
id|__FUNCTION__
)paren
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|dead
)paren
)paren
(brace
r_return
op_minus
id|ENXIO
suffix:semicolon
)brace
id|var
op_assign
op_amp
id|info-&gt;var
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|matroxfb_decode_var
c_func
(paren
id|PMINFO
id|var
comma
op_amp
id|visual
comma
op_amp
id|cmap_len
comma
op_amp
id|ydstorg
)paren
)paren
op_ne
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.screen_base
)paren
op_assign
id|vaddr_va
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
)paren
op_plus
id|ydstorg
suffix:semicolon
id|matroxfb_update_fix
c_func
(paren
id|PMINFO2
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
dot
id|fix.visual
op_assign
id|visual
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
dot
id|fix.type
op_assign
id|FB_TYPE_PACKED_PIXELS
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
dot
id|fix.type_aux
op_assign
l_int|0
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
dot
id|fix.line_length
op_assign
(paren
id|var-&gt;xres_virtual
op_star
id|var-&gt;bits_per_pixel
)paren
op_rshift
l_int|3
suffix:semicolon
(brace
r_int
r_int
id|pos
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|curr.cmap_len
)paren
op_assign
id|cmap_len
suffix:semicolon
id|ydstorg
op_add_assign
id|ACCESS_FBINFO
c_func
(paren
id|devflags.ydstorg
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|curr.ydstorg.bytes
)paren
op_assign
id|ydstorg
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|curr.ydstorg.chunks
)paren
op_assign
id|ydstorg
op_rshift
(paren
id|isInterleave
c_func
(paren
id|MINFO
)paren
ques
c_cond
l_int|3
suffix:colon
l_int|2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|var-&gt;bits_per_pixel
op_eq
l_int|4
)paren
id|ACCESS_FBINFO
c_func
(paren
id|curr.ydstorg.pixels
)paren
op_assign
id|ydstorg
suffix:semicolon
r_else
id|ACCESS_FBINFO
c_func
(paren
id|curr.ydstorg.pixels
)paren
op_assign
(paren
id|ydstorg
op_star
l_int|8
)paren
op_div
id|var-&gt;bits_per_pixel
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|curr.final_bppShift
)paren
op_assign
id|matroxfb_get_final_bppShift
c_func
(paren
id|PMINFO
id|var-&gt;bits_per_pixel
)paren
suffix:semicolon
(brace
r_struct
id|my_timming
id|mt
suffix:semicolon
r_struct
id|matrox_hw_state
op_star
id|hw
suffix:semicolon
r_int
id|out
suffix:semicolon
id|matroxfb_var2my
c_func
(paren
id|var
comma
op_amp
id|mt
)paren
suffix:semicolon
id|mt.crtc
op_assign
id|MATROXFB_SRC_CRTC1
suffix:semicolon
multiline_comment|/* CRTC1 delays */
r_switch
c_cond
(paren
id|var-&gt;bits_per_pixel
)paren
(brace
r_case
l_int|0
suffix:colon
id|mt.delay
op_assign
l_int|31
op_plus
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|16
suffix:colon
id|mt.delay
op_assign
l_int|21
op_plus
l_int|8
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|24
suffix:colon
id|mt.delay
op_assign
l_int|17
op_plus
l_int|8
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|32
suffix:colon
id|mt.delay
op_assign
l_int|16
op_plus
l_int|8
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|mt.delay
op_assign
l_int|31
op_plus
l_int|8
suffix:semicolon
r_break
suffix:semicolon
)brace
id|hw
op_assign
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|hw
)paren
suffix:semicolon
id|down_read
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|altout
)paren
dot
id|lock
)paren
suffix:semicolon
r_for
c_loop
(paren
id|out
op_assign
l_int|0
suffix:semicolon
id|out
OL
id|MATROXFB_MAX_OUTPUTS
suffix:semicolon
id|out
op_increment
)paren
(brace
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
id|out
)braket
)paren
dot
id|src
op_eq
id|MATROXFB_SRC_CRTC1
op_logical_and
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
id|out
)braket
)paren
dot
id|output-&gt;compute
)paren
(brace
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
id|out
)braket
)paren
dot
id|output
op_member_access_from_pointer
id|compute
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
id|out
)braket
)paren
dot
id|data
comma
op_amp
id|mt
)paren
suffix:semicolon
)brace
)brace
id|up_read
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|altout
)paren
dot
id|lock
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|crtc1
)paren
dot
id|pixclock
op_assign
id|mt.pixclock
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|crtc1
)paren
dot
id|mnp
op_assign
id|mt.mnp
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|hw_switch
op_member_access_from_pointer
id|init
c_func
(paren
id|PMINFO
op_amp
id|mt
)paren
)paren
suffix:semicolon
id|pos
op_assign
(paren
id|var-&gt;yoffset
op_star
id|var-&gt;xres_virtual
op_plus
id|var-&gt;xoffset
)paren
op_star
id|ACCESS_FBINFO
c_func
(paren
id|curr.final_bppShift
)paren
op_div
l_int|32
suffix:semicolon
id|pos
op_add_assign
id|ACCESS_FBINFO
c_func
(paren
id|curr.ydstorg.chunks
)paren
suffix:semicolon
id|hw-&gt;CRTC
(braket
l_int|0x0D
)braket
op_assign
id|pos
op_amp
l_int|0xFF
suffix:semicolon
id|hw-&gt;CRTC
(braket
l_int|0x0C
)braket
op_assign
(paren
id|pos
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
suffix:semicolon
id|hw-&gt;CRTCEXT
(braket
l_int|0
)braket
op_assign
(paren
id|hw-&gt;CRTCEXT
(braket
l_int|0
)braket
op_amp
l_int|0xF0
)paren
op_or
(paren
(paren
id|pos
op_rshift
l_int|16
)paren
op_amp
l_int|0x0F
)paren
op_or
(paren
(paren
id|pos
op_rshift
l_int|14
)paren
op_amp
l_int|0x40
)paren
suffix:semicolon
id|hw-&gt;CRTCEXT
(braket
l_int|8
)braket
op_assign
id|pos
op_rshift
l_int|21
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|hw_switch
op_member_access_from_pointer
id|restore
c_func
(paren
id|PMINFO2
)paren
)paren
suffix:semicolon
id|update_crtc2
c_func
(paren
id|PMINFO
id|pos
)paren
suffix:semicolon
id|down_read
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|altout
)paren
dot
id|lock
)paren
suffix:semicolon
r_for
c_loop
(paren
id|out
op_assign
l_int|0
suffix:semicolon
id|out
OL
id|MATROXFB_MAX_OUTPUTS
suffix:semicolon
id|out
op_increment
)paren
(brace
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
id|out
)braket
)paren
dot
id|src
op_eq
id|MATROXFB_SRC_CRTC1
op_logical_and
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
id|out
)braket
)paren
dot
id|output-&gt;program
)paren
(brace
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
id|out
)braket
)paren
dot
id|output
op_member_access_from_pointer
id|program
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
id|out
)braket
)paren
dot
id|data
)paren
suffix:semicolon
)brace
)brace
r_for
c_loop
(paren
id|out
op_assign
l_int|0
suffix:semicolon
id|out
OL
id|MATROXFB_MAX_OUTPUTS
suffix:semicolon
id|out
op_increment
)paren
(brace
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
id|out
)braket
)paren
dot
id|src
op_eq
id|MATROXFB_SRC_CRTC1
op_logical_and
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
id|out
)braket
)paren
dot
id|output-&gt;start
)paren
(brace
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
id|out
)braket
)paren
dot
id|output
op_member_access_from_pointer
id|start
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
id|out
)braket
)paren
dot
id|data
)paren
suffix:semicolon
)brace
)brace
id|up_read
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|altout
)paren
dot
id|lock
)paren
suffix:semicolon
id|matrox_cfbX_init
c_func
(paren
id|PMINFO2
)paren
suffix:semicolon
)brace
)brace
id|ACCESS_FBINFO
c_func
(paren
id|initialized
)paren
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|matroxfb_get_vblank
r_static
r_int
id|matroxfb_get_vblank
c_func
(paren
id|WPMINFO
r_struct
id|fb_vblank
op_star
id|vblank
)paren
(brace
r_int
r_int
id|sts1
suffix:semicolon
id|matroxfb_enable_irq
c_func
(paren
id|PMINFO
l_int|0
)paren
suffix:semicolon
id|memset
c_func
(paren
id|vblank
comma
l_int|0
comma
r_sizeof
(paren
op_star
id|vblank
)paren
)paren
suffix:semicolon
id|vblank-&gt;flags
op_assign
id|FB_VBLANK_HAVE_VCOUNT
op_or
id|FB_VBLANK_HAVE_VSYNC
op_or
id|FB_VBLANK_HAVE_VBLANK
op_or
id|FB_VBLANK_HAVE_HBLANK
suffix:semicolon
id|sts1
op_assign
id|mga_inb
c_func
(paren
id|M_INSTS1
)paren
suffix:semicolon
id|vblank-&gt;vcount
op_assign
id|mga_inl
c_func
(paren
id|M_VCOUNT
)paren
suffix:semicolon
multiline_comment|/* BTW, on my PIII/450 with G400, reading M_INSTS1&n;&t;   byte makes this call about 12% slower (1.70 vs. 2.05 us&n;&t;   per ioctl()) */
r_if
c_cond
(paren
id|sts1
op_amp
l_int|1
)paren
id|vblank-&gt;flags
op_or_assign
id|FB_VBLANK_HBLANKING
suffix:semicolon
r_if
c_cond
(paren
id|sts1
op_amp
l_int|8
)paren
id|vblank-&gt;flags
op_or_assign
id|FB_VBLANK_VSYNCING
suffix:semicolon
r_if
c_cond
(paren
id|vblank-&gt;vcount
op_ge
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
dot
id|var.yres
)paren
id|vblank-&gt;flags
op_or_assign
id|FB_VBLANK_VBLANKING
suffix:semicolon
r_if
c_cond
(paren
id|test_bit
c_func
(paren
l_int|0
comma
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|irq_flags
)paren
)paren
)paren
(brace
id|vblank-&gt;flags
op_or_assign
id|FB_VBLANK_HAVE_COUNT
suffix:semicolon
multiline_comment|/* Only one writer, aligned int value... &n;&t;&t;   it should work without lock and without atomic_t */
id|vblank-&gt;count
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|crtc1
)paren
dot
id|vsync.cnt
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|panellink_output
r_static
r_struct
id|matrox_altout
id|panellink_output
op_assign
(brace
dot
id|name
op_assign
l_string|&quot;Panellink output&quot;
comma
)brace
suffix:semicolon
DECL|function|matroxfb_ioctl
r_static
r_int
id|matroxfb_ioctl
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
comma
r_int
r_int
id|cmd
comma
r_int
r_int
id|arg
comma
r_struct
id|fb_info
op_star
id|info
)paren
(brace
r_void
id|__user
op_star
id|argp
op_assign
(paren
r_void
id|__user
op_star
)paren
id|arg
suffix:semicolon
id|MINFO_FROM_INFO
c_func
(paren
id|info
)paren
suffix:semicolon
id|DBG
c_func
(paren
id|__FUNCTION__
)paren
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|dead
)paren
)paren
(brace
r_return
op_minus
id|ENXIO
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|FBIOGET_VBLANK
suffix:colon
(brace
r_struct
id|fb_vblank
id|vblank
suffix:semicolon
r_int
id|err
suffix:semicolon
id|err
op_assign
id|matroxfb_get_vblank
c_func
(paren
id|PMINFO
op_amp
id|vblank
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|argp
comma
op_amp
id|vblank
comma
r_sizeof
(paren
id|vblank
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_case
id|FBIO_WAITFORVSYNC
suffix:colon
(brace
id|u_int32_t
id|crt
suffix:semicolon
r_if
c_cond
(paren
id|get_user
c_func
(paren
id|crt
comma
(paren
id|u_int32_t
id|__user
op_star
)paren
id|arg
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
id|matroxfb_wait_for_sync
c_func
(paren
id|PMINFO
id|crt
)paren
suffix:semicolon
)brace
r_case
id|MATROXFB_SET_OUTPUT_MODE
suffix:colon
(brace
r_struct
id|matroxioc_output_mode
id|mom
suffix:semicolon
r_struct
id|matrox_altout
op_star
id|oproc
suffix:semicolon
r_int
id|val
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|mom
comma
id|argp
comma
r_sizeof
(paren
id|mom
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
id|mom.output
op_ge
id|MATROXFB_MAX_OUTPUTS
)paren
r_return
op_minus
id|ENXIO
suffix:semicolon
id|down_read
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|altout.lock
)paren
)paren
suffix:semicolon
id|oproc
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
id|mom.output
)braket
)paren
dot
id|output
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|oproc
)paren
(brace
id|val
op_assign
op_minus
id|ENXIO
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|oproc-&gt;verifymode
)paren
(brace
r_if
c_cond
(paren
id|mom.mode
op_eq
id|MATROXFB_OUTPUT_MODE_MONITOR
)paren
(brace
id|val
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|val
op_assign
op_minus
id|EINVAL
suffix:semicolon
)brace
)brace
r_else
(brace
id|val
op_assign
id|oproc
op_member_access_from_pointer
id|verifymode
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
id|mom.output
)braket
)paren
dot
id|data
comma
id|mom.mode
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|val
)paren
(brace
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
id|mom.output
)braket
)paren
dot
id|mode
op_ne
id|mom.mode
)paren
(brace
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
id|mom.output
)braket
)paren
dot
id|mode
op_assign
id|mom.mode
suffix:semicolon
id|val
op_assign
l_int|1
suffix:semicolon
)brace
)brace
id|up_read
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|altout.lock
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|val
op_ne
l_int|1
)paren
r_return
id|val
suffix:semicolon
r_switch
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
id|mom.output
)braket
)paren
dot
id|src
)paren
(brace
r_case
id|MATROXFB_SRC_CRTC1
suffix:colon
id|matroxfb_set_par
c_func
(paren
id|info
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|MATROXFB_SRC_CRTC2
suffix:colon
(brace
r_struct
id|matroxfb_dh_fb_info
op_star
id|crtc2
suffix:semicolon
id|down_read
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|crtc2.lock
)paren
)paren
suffix:semicolon
id|crtc2
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|crtc2.info
)paren
suffix:semicolon
r_if
c_cond
(paren
id|crtc2
)paren
id|crtc2-&gt;fbcon.fbops
op_member_access_from_pointer
id|fb_set_par
c_func
(paren
op_amp
id|crtc2-&gt;fbcon
)paren
suffix:semicolon
id|up_read
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|crtc2.lock
)paren
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
r_case
id|MATROXFB_GET_OUTPUT_MODE
suffix:colon
(brace
r_struct
id|matroxioc_output_mode
id|mom
suffix:semicolon
r_struct
id|matrox_altout
op_star
id|oproc
suffix:semicolon
r_int
id|val
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|mom
comma
id|argp
comma
r_sizeof
(paren
id|mom
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
id|mom.output
op_ge
id|MATROXFB_MAX_OUTPUTS
)paren
r_return
op_minus
id|ENXIO
suffix:semicolon
id|down_read
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|altout.lock
)paren
)paren
suffix:semicolon
id|oproc
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
id|mom.output
)braket
)paren
dot
id|output
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|oproc
)paren
(brace
id|val
op_assign
op_minus
id|ENXIO
suffix:semicolon
)brace
r_else
(brace
id|mom.mode
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
id|mom.output
)braket
)paren
dot
id|mode
suffix:semicolon
id|val
op_assign
l_int|0
suffix:semicolon
)brace
id|up_read
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|altout.lock
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|val
)paren
r_return
id|val
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|argp
comma
op_amp
id|mom
comma
r_sizeof
(paren
id|mom
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_case
id|MATROXFB_SET_OUTPUT_CONNECTION
suffix:colon
(brace
id|u_int32_t
id|tmp
suffix:semicolon
r_int
id|i
suffix:semicolon
r_int
id|changes
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|tmp
comma
id|argp
comma
r_sizeof
(paren
id|tmp
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|32
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|tmp
op_amp
(paren
l_int|1
op_lshift
id|i
)paren
)paren
(brace
r_if
c_cond
(paren
id|i
op_ge
id|MATROXFB_MAX_OUTPUTS
)paren
r_return
op_minus
id|ENXIO
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
id|i
)braket
)paren
dot
id|output
)paren
r_return
op_minus
id|ENXIO
suffix:semicolon
r_switch
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
id|i
)braket
)paren
dot
id|src
)paren
(brace
r_case
id|MATROXFB_SRC_NONE
suffix:colon
r_case
id|MATROXFB_SRC_CRTC1
suffix:colon
r_break
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
)brace
)brace
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.panellink
)paren
)paren
(brace
r_if
c_cond
(paren
id|tmp
op_amp
id|MATROXFB_OUTPUT_CONN_DFP
)paren
(brace
r_if
c_cond
(paren
id|tmp
op_amp
id|MATROXFB_OUTPUT_CONN_SECONDARY
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|MATROXFB_MAX_OUTPUTS
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
id|i
)braket
)paren
dot
id|src
op_eq
id|MATROXFB_SRC_CRTC2
)paren
(brace
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
)brace
)brace
)brace
id|changes
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|MATROXFB_MAX_OUTPUTS
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|tmp
op_amp
(paren
l_int|1
op_lshift
id|i
)paren
)paren
(brace
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
id|i
)braket
)paren
dot
id|src
op_ne
id|MATROXFB_SRC_CRTC1
)paren
(brace
id|changes
op_assign
l_int|1
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
id|i
)braket
)paren
dot
id|src
op_assign
id|MATROXFB_SRC_CRTC1
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
id|i
)braket
)paren
dot
id|src
op_eq
id|MATROXFB_SRC_CRTC1
)paren
(brace
id|changes
op_assign
l_int|1
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
id|i
)braket
)paren
dot
id|src
op_assign
id|MATROXFB_SRC_NONE
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
op_logical_neg
id|changes
)paren
r_return
l_int|0
suffix:semicolon
id|matroxfb_set_par
c_func
(paren
id|info
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_case
id|MATROXFB_GET_OUTPUT_CONNECTION
suffix:colon
(brace
id|u_int32_t
id|conn
op_assign
l_int|0
suffix:semicolon
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|MATROXFB_MAX_OUTPUTS
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
id|i
)braket
)paren
dot
id|src
op_eq
id|MATROXFB_SRC_CRTC1
)paren
(brace
id|conn
op_or_assign
l_int|1
op_lshift
id|i
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|put_user
c_func
(paren
id|conn
comma
(paren
id|u_int32_t
id|__user
op_star
)paren
id|arg
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_case
id|MATROXFB_GET_AVAILABLE_OUTPUTS
suffix:colon
(brace
id|u_int32_t
id|conn
op_assign
l_int|0
suffix:semicolon
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|MATROXFB_MAX_OUTPUTS
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
id|i
)braket
)paren
dot
id|output
)paren
(brace
r_switch
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
id|i
)braket
)paren
dot
id|src
)paren
(brace
r_case
id|MATROXFB_SRC_NONE
suffix:colon
r_case
id|MATROXFB_SRC_CRTC1
suffix:colon
id|conn
op_or_assign
l_int|1
op_lshift
id|i
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
)brace
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.panellink
)paren
)paren
(brace
r_if
c_cond
(paren
id|conn
op_amp
id|MATROXFB_OUTPUT_CONN_DFP
)paren
id|conn
op_and_assign
op_complement
id|MATROXFB_OUTPUT_CONN_SECONDARY
suffix:semicolon
r_if
c_cond
(paren
id|conn
op_amp
id|MATROXFB_OUTPUT_CONN_SECONDARY
)paren
id|conn
op_and_assign
op_complement
id|MATROXFB_OUTPUT_CONN_DFP
suffix:semicolon
)brace
r_if
c_cond
(paren
id|put_user
c_func
(paren
id|conn
comma
(paren
id|u_int32_t
id|__user
op_star
)paren
id|arg
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_case
id|MATROXFB_GET_ALL_OUTPUTS
suffix:colon
(brace
id|u_int32_t
id|conn
op_assign
l_int|0
suffix:semicolon
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|MATROXFB_MAX_OUTPUTS
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
id|i
)braket
)paren
dot
id|output
)paren
(brace
id|conn
op_or_assign
l_int|1
op_lshift
id|i
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|put_user
c_func
(paren
id|conn
comma
(paren
id|u_int32_t
id|__user
op_star
)paren
id|arg
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_case
id|VIDIOC_QUERYCAP
suffix:colon
(brace
r_struct
id|v4l2_capability
id|r
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|r
comma
l_int|0
comma
r_sizeof
(paren
id|r
)paren
)paren
suffix:semicolon
id|strcpy
c_func
(paren
id|r.driver
comma
l_string|&quot;matroxfb&quot;
)paren
suffix:semicolon
id|strcpy
c_func
(paren
id|r.card
comma
l_string|&quot;Matrox&quot;
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|r.bus_info
comma
l_string|&quot;PCI:%s&quot;
comma
id|pci_name
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
)paren
)paren
suffix:semicolon
id|r.version
op_assign
id|KERNEL_VERSION
c_func
(paren
l_int|1
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
id|r.capabilities
op_assign
id|V4L2_CAP_VIDEO_OUTPUT
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|argp
comma
op_amp
id|r
comma
r_sizeof
(paren
id|r
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_case
id|VIDIOC_QUERYCTRL
suffix:colon
(brace
r_struct
id|v4l2_queryctrl
id|qctrl
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|qctrl
comma
id|argp
comma
r_sizeof
(paren
id|qctrl
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|down_read
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|altout
)paren
dot
id|lock
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
l_int|1
)braket
)paren
dot
id|output
)paren
(brace
id|err
op_assign
op_minus
id|ENXIO
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
l_int|1
)braket
)paren
dot
id|output-&gt;getqueryctrl
)paren
(brace
id|err
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
l_int|1
)braket
)paren
dot
id|output
op_member_access_from_pointer
id|getqueryctrl
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
l_int|1
)braket
)paren
dot
id|data
comma
op_amp
id|qctrl
)paren
suffix:semicolon
)brace
r_else
(brace
id|err
op_assign
op_minus
id|EINVAL
suffix:semicolon
)brace
id|up_read
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|altout
)paren
dot
id|lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
op_ge
l_int|0
op_logical_and
id|copy_to_user
c_func
(paren
id|argp
comma
op_amp
id|qctrl
comma
r_sizeof
(paren
id|qctrl
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
r_case
id|VIDIOC_G_CTRL
suffix:colon
(brace
r_struct
id|v4l2_control
id|ctrl
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|ctrl
comma
id|argp
comma
r_sizeof
(paren
id|ctrl
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|down_read
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|altout
)paren
dot
id|lock
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
l_int|1
)braket
)paren
dot
id|output
)paren
(brace
id|err
op_assign
op_minus
id|ENXIO
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
l_int|1
)braket
)paren
dot
id|output-&gt;getctrl
)paren
(brace
id|err
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
l_int|1
)braket
)paren
dot
id|output
op_member_access_from_pointer
id|getctrl
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
l_int|1
)braket
)paren
dot
id|data
comma
op_amp
id|ctrl
)paren
suffix:semicolon
)brace
r_else
(brace
id|err
op_assign
op_minus
id|EINVAL
suffix:semicolon
)brace
id|up_read
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|altout
)paren
dot
id|lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
op_ge
l_int|0
op_logical_and
id|copy_to_user
c_func
(paren
id|argp
comma
op_amp
id|ctrl
comma
r_sizeof
(paren
id|ctrl
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
r_case
id|VIDIOC_S_CTRL_OLD
suffix:colon
r_case
id|VIDIOC_S_CTRL
suffix:colon
(brace
r_struct
id|v4l2_control
id|ctrl
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|ctrl
comma
id|argp
comma
r_sizeof
(paren
id|ctrl
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|down_read
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|altout
)paren
dot
id|lock
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
l_int|1
)braket
)paren
dot
id|output
)paren
(brace
id|err
op_assign
op_minus
id|ENXIO
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
l_int|1
)braket
)paren
dot
id|output-&gt;setctrl
)paren
(brace
id|err
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
l_int|1
)braket
)paren
dot
id|output
op_member_access_from_pointer
id|setctrl
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
l_int|1
)braket
)paren
dot
id|data
comma
op_amp
id|ctrl
)paren
suffix:semicolon
)brace
r_else
(brace
id|err
op_assign
op_minus
id|EINVAL
suffix:semicolon
)brace
id|up_read
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|altout
)paren
dot
id|lock
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
)brace
r_return
op_minus
id|ENOTTY
suffix:semicolon
)brace
multiline_comment|/* 0 unblank, 1 blank, 2 no vsync, 3 no hsync, 4 off */
DECL|function|matroxfb_blank
r_static
r_int
id|matroxfb_blank
c_func
(paren
r_int
id|blank
comma
r_struct
id|fb_info
op_star
id|info
)paren
(brace
r_int
id|seq
suffix:semicolon
r_int
id|crtc
suffix:semicolon
id|CRITFLAGS
id|MINFO_FROM_INFO
c_func
(paren
id|info
)paren
suffix:semicolon
id|DBG
c_func
(paren
id|__FUNCTION__
)paren
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|dead
)paren
)paren
r_return
l_int|1
suffix:semicolon
r_switch
c_cond
(paren
id|blank
)paren
(brace
r_case
id|FB_BLANK_NORMAL
suffix:colon
id|seq
op_assign
l_int|0x20
suffix:semicolon
id|crtc
op_assign
l_int|0x00
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* works ??? */
r_case
id|FB_BLANK_VSYNC_SUSPEND
suffix:colon
id|seq
op_assign
l_int|0x20
suffix:semicolon
id|crtc
op_assign
l_int|0x10
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FB_BLANK_HSYNC_SUSPEND
suffix:colon
id|seq
op_assign
l_int|0x20
suffix:semicolon
id|crtc
op_assign
l_int|0x20
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FB_BLANK_POWERDOWN
suffix:colon
id|seq
op_assign
l_int|0x20
suffix:semicolon
id|crtc
op_assign
l_int|0x30
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|seq
op_assign
l_int|0x00
suffix:semicolon
id|crtc
op_assign
l_int|0x00
suffix:semicolon
r_break
suffix:semicolon
)brace
id|CRITBEGIN
id|mga_outb
c_func
(paren
id|M_SEQ_INDEX
comma
l_int|1
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_SEQ_DATA
comma
(paren
id|mga_inb
c_func
(paren
id|M_SEQ_DATA
)paren
op_amp
op_complement
l_int|0x20
)paren
op_or
id|seq
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_EXTVGA_INDEX
comma
l_int|1
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_EXTVGA_DATA
comma
(paren
id|mga_inb
c_func
(paren
id|M_EXTVGA_DATA
)paren
op_amp
op_complement
l_int|0x30
)paren
op_or
id|crtc
)paren
suffix:semicolon
id|CRITEND
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|matroxfb_ops
r_static
r_struct
id|fb_ops
id|matroxfb_ops
op_assign
(brace
dot
id|owner
op_assign
id|THIS_MODULE
comma
dot
id|fb_open
op_assign
id|matroxfb_open
comma
dot
id|fb_release
op_assign
id|matroxfb_release
comma
dot
id|fb_check_var
op_assign
id|matroxfb_check_var
comma
dot
id|fb_set_par
op_assign
id|matroxfb_set_par
comma
dot
id|fb_setcolreg
op_assign
id|matroxfb_setcolreg
comma
dot
id|fb_pan_display
op_assign
id|matroxfb_pan_display
comma
dot
id|fb_blank
op_assign
id|matroxfb_blank
comma
dot
id|fb_ioctl
op_assign
id|matroxfb_ioctl
comma
multiline_comment|/*&t;.fb_fillrect =&t;&lt;set by matrox_cfbX_init&gt;, */
multiline_comment|/*&t;.fb_copyarea =&t;&lt;set by matrox_cfbX_init&gt;, */
multiline_comment|/*&t;.fb_imageblit =&t;&lt;set by matrox_cfbX_init&gt;, */
multiline_comment|/*&t;.fb_cursor =&t;&lt;set by matrox_cfbX_init&gt;, */
)brace
suffix:semicolon
DECL|macro|RSDepth
mdefine_line|#define RSDepth(X)&t;(((X) &gt;&gt; 8) &amp; 0x0F)
DECL|macro|RS8bpp
mdefine_line|#define RS8bpp&t;&t;0x1
DECL|macro|RS15bpp
mdefine_line|#define RS15bpp&t;&t;0x2
DECL|macro|RS16bpp
mdefine_line|#define RS16bpp&t;&t;0x3
DECL|macro|RS32bpp
mdefine_line|#define RS32bpp&t;&t;0x4
DECL|macro|RS4bpp
mdefine_line|#define RS4bpp&t;&t;0x5
DECL|macro|RS24bpp
mdefine_line|#define RS24bpp&t;&t;0x6
DECL|macro|RSText
mdefine_line|#define RSText&t;&t;0x7
DECL|macro|RSText8
mdefine_line|#define RSText8&t;&t;0x8
multiline_comment|/* 9-F */
DECL|member|red
DECL|member|green
DECL|member|blue
DECL|member|transp
DECL|member|bits_per_pixel
DECL|variable|colors
r_static
r_struct
(brace
r_struct
id|fb_bitfield
id|red
comma
id|green
comma
id|blue
comma
id|transp
suffix:semicolon
r_int
id|bits_per_pixel
suffix:semicolon
)brace
id|colors
(braket
)braket
op_assign
(brace
(brace
(brace
l_int|0
comma
l_int|8
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|8
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|8
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
l_int|8
)brace
comma
(brace
(brace
l_int|10
comma
l_int|5
comma
l_int|0
)brace
comma
(brace
l_int|5
comma
l_int|5
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|5
comma
l_int|0
)brace
comma
(brace
l_int|15
comma
l_int|1
comma
l_int|0
)brace
comma
l_int|16
)brace
comma
(brace
(brace
l_int|11
comma
l_int|5
comma
l_int|0
)brace
comma
(brace
l_int|5
comma
l_int|6
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|5
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
l_int|16
)brace
comma
(brace
(brace
l_int|16
comma
l_int|8
comma
l_int|0
)brace
comma
(brace
l_int|8
comma
l_int|8
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|8
comma
l_int|0
)brace
comma
(brace
l_int|24
comma
l_int|8
comma
l_int|0
)brace
comma
l_int|32
)brace
comma
(brace
(brace
l_int|0
comma
l_int|8
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|8
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|8
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
l_int|4
)brace
comma
(brace
(brace
l_int|16
comma
l_int|8
comma
l_int|0
)brace
comma
(brace
l_int|8
comma
l_int|8
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|8
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
l_int|24
)brace
comma
(brace
(brace
l_int|0
comma
l_int|6
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|6
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|6
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
l_int|0
)brace
comma
multiline_comment|/* textmode with (default) VGA8x16 */
(brace
(brace
l_int|0
comma
l_int|6
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|6
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|6
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
l_int|0
)brace
comma
multiline_comment|/* textmode hardwired to VGA8x8 */
)brace
suffix:semicolon
multiline_comment|/* initialized by setup, see explanation at end of file (search for MODULE_PARM_DESC) */
DECL|variable|mem
r_static
r_int
r_int
id|mem
suffix:semicolon
multiline_comment|/* &quot;matrox:mem:xxxxxM&quot; */
DECL|variable|option_precise_width
r_static
r_int
id|option_precise_width
op_assign
l_int|1
suffix:semicolon
multiline_comment|/* cannot be changed, option_precise_width==0 must imply noaccel */
DECL|variable|inv24
r_static
r_int
id|inv24
suffix:semicolon
multiline_comment|/* &quot;matrox:inv24&quot; */
DECL|variable|cross4MB
r_static
r_int
id|cross4MB
op_assign
op_minus
l_int|1
suffix:semicolon
multiline_comment|/* &quot;matrox:cross4MB&quot; */
DECL|variable|disabled
r_static
r_int
id|disabled
suffix:semicolon
multiline_comment|/* &quot;matrox:disabled&quot; */
DECL|variable|noaccel
r_static
r_int
id|noaccel
suffix:semicolon
multiline_comment|/* &quot;matrox:noaccel&quot; */
DECL|variable|nopan
r_static
r_int
id|nopan
suffix:semicolon
multiline_comment|/* &quot;matrox:nopan&quot; */
DECL|variable|no_pci_retry
r_static
r_int
id|no_pci_retry
suffix:semicolon
multiline_comment|/* &quot;matrox:nopciretry&quot; */
DECL|variable|novga
r_static
r_int
id|novga
suffix:semicolon
multiline_comment|/* &quot;matrox:novga&quot; */
DECL|variable|nobios
r_static
r_int
id|nobios
suffix:semicolon
multiline_comment|/* &quot;matrox:nobios&quot; */
DECL|variable|noinit
r_static
r_int
id|noinit
op_assign
l_int|1
suffix:semicolon
multiline_comment|/* &quot;matrox:init&quot; */
DECL|variable|inverse
r_static
r_int
id|inverse
suffix:semicolon
multiline_comment|/* &quot;matrox:inverse&quot; */
DECL|variable|sgram
r_static
r_int
id|sgram
suffix:semicolon
multiline_comment|/* &quot;matrox:sgram&quot; */
macro_line|#ifdef CONFIG_MTRR
DECL|variable|mtrr
r_static
r_int
id|mtrr
op_assign
l_int|1
suffix:semicolon
multiline_comment|/* &quot;matrox:nomtrr&quot; */
macro_line|#endif
DECL|variable|grayscale
r_static
r_int
id|grayscale
suffix:semicolon
multiline_comment|/* &quot;matrox:grayscale&quot; */
DECL|variable|dev
r_static
r_int
id|dev
op_assign
op_minus
l_int|1
suffix:semicolon
multiline_comment|/* &quot;matrox:dev:xxxxx&quot; */
DECL|variable|vesa
r_static
r_int
r_int
id|vesa
op_assign
op_complement
l_int|0
suffix:semicolon
multiline_comment|/* &quot;matrox:vesa:xxxxx&quot; */
DECL|variable|depth
r_static
r_int
id|depth
op_assign
op_minus
l_int|1
suffix:semicolon
multiline_comment|/* &quot;matrox:depth:xxxxx&quot; */
DECL|variable|xres
r_static
r_int
r_int
id|xres
suffix:semicolon
multiline_comment|/* &quot;matrox:xres:xxxxx&quot; */
DECL|variable|yres
r_static
r_int
r_int
id|yres
suffix:semicolon
multiline_comment|/* &quot;matrox:yres:xxxxx&quot; */
DECL|variable|upper
r_static
r_int
r_int
id|upper
op_assign
op_complement
l_int|0
suffix:semicolon
multiline_comment|/* &quot;matrox:upper:xxxxx&quot; */
DECL|variable|lower
r_static
r_int
r_int
id|lower
op_assign
op_complement
l_int|0
suffix:semicolon
multiline_comment|/* &quot;matrox:lower:xxxxx&quot; */
DECL|variable|vslen
r_static
r_int
r_int
id|vslen
suffix:semicolon
multiline_comment|/* &quot;matrox:vslen:xxxxx&quot; */
DECL|variable|left
r_static
r_int
r_int
id|left
op_assign
op_complement
l_int|0
suffix:semicolon
multiline_comment|/* &quot;matrox:left:xxxxx&quot; */
DECL|variable|right
r_static
r_int
r_int
id|right
op_assign
op_complement
l_int|0
suffix:semicolon
multiline_comment|/* &quot;matrox:right:xxxxx&quot; */
DECL|variable|hslen
r_static
r_int
r_int
id|hslen
suffix:semicolon
multiline_comment|/* &quot;matrox:hslen:xxxxx&quot; */
DECL|variable|pixclock
r_static
r_int
r_int
id|pixclock
suffix:semicolon
multiline_comment|/* &quot;matrox:pixclock:xxxxx&quot; */
DECL|variable|sync
r_static
r_int
id|sync
op_assign
op_minus
l_int|1
suffix:semicolon
multiline_comment|/* &quot;matrox:sync:xxxxx&quot; */
DECL|variable|fv
r_static
r_int
r_int
id|fv
suffix:semicolon
multiline_comment|/* &quot;matrox:fv:xxxxx&quot; */
DECL|variable|fh
r_static
r_int
r_int
id|fh
suffix:semicolon
multiline_comment|/* &quot;matrox:fh:xxxxxk&quot; */
DECL|variable|maxclk
r_static
r_int
r_int
id|maxclk
suffix:semicolon
multiline_comment|/* &quot;matrox:maxclk:xxxxM&quot; */
DECL|variable|dfp
r_static
r_int
id|dfp
suffix:semicolon
multiline_comment|/* &quot;matrox:dfp */
DECL|variable|dfp_type
r_static
r_int
id|dfp_type
op_assign
op_minus
l_int|1
suffix:semicolon
multiline_comment|/* &quot;matrox:dfp:xxx */
DECL|variable|memtype
r_static
r_int
id|memtype
op_assign
op_minus
l_int|1
suffix:semicolon
multiline_comment|/* &quot;matrox:memtype:xxx&quot; */
DECL|variable|outputs
r_static
r_char
id|outputs
(braket
l_int|8
)braket
suffix:semicolon
multiline_comment|/* &quot;matrox:outputs:xxx&quot; */
macro_line|#ifndef MODULE
DECL|variable|videomode
r_static
r_char
id|videomode
(braket
l_int|64
)braket
suffix:semicolon
multiline_comment|/* &quot;matrox:mode:xxxxx&quot; or &quot;matrox:xxxxx&quot; */
macro_line|#endif
DECL|function|matroxfb_getmemory
r_static
r_int
(def_block
id|matroxfb_getmemory
c_func
(paren
id|WPMINFO
r_int
r_int
id|maxSize
comma
r_int
r_int
op_star
id|realSize
)paren
(brace
id|vaddr_t
id|vm
suffix:semicolon
r_int
r_int
id|offs
suffix:semicolon
r_int
r_int
id|offs2
suffix:semicolon
r_int
r_char
id|store
suffix:semicolon
r_int
r_char
id|bytes
(braket
l_int|32
)braket
suffix:semicolon
r_int
r_char
op_star
id|tmp
suffix:semicolon
id|DBG
c_func
(paren
id|__FUNCTION__
)paren
id|vm
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
suffix:semicolon
id|maxSize
op_and_assign
op_complement
l_int|0x1FFFFF
suffix:semicolon
multiline_comment|/* must be X*2MB (really it must be 2 or X*4MB) */
multiline_comment|/* at least 2MB */
r_if
c_cond
(paren
id|maxSize
OL
l_int|0x0200000
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|maxSize
OG
l_int|0x2000000
)paren
id|maxSize
op_assign
l_int|0x2000000
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_EXTVGA_INDEX
comma
l_int|0x03
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_EXTVGA_DATA
comma
id|mga_inb
c_func
(paren
id|M_EXTVGA_DATA
)paren
op_or
l_int|0x80
)paren
suffix:semicolon
id|store
op_assign
id|mga_readb
c_func
(paren
id|vm
comma
l_int|0x1234
)paren
suffix:semicolon
id|tmp
op_assign
id|bytes
suffix:semicolon
r_for
c_loop
(paren
id|offs
op_assign
l_int|0x100000
suffix:semicolon
id|offs
OL
id|maxSize
suffix:semicolon
id|offs
op_add_assign
l_int|0x200000
)paren
op_star
id|tmp
op_increment
op_assign
id|mga_readb
c_func
(paren
id|vm
comma
id|offs
)paren
suffix:semicolon
r_for
c_loop
(paren
id|offs
op_assign
l_int|0x100000
suffix:semicolon
id|offs
OL
id|maxSize
suffix:semicolon
id|offs
op_add_assign
l_int|0x200000
)paren
id|mga_writeb
c_func
(paren
id|vm
comma
id|offs
comma
l_int|0x02
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|features.accel.has_cacheflush
)paren
)paren
id|mga_outb
c_func
(paren
id|M_CACHEFLUSH
comma
l_int|0x00
)paren
suffix:semicolon
r_else
id|mga_writeb
c_func
(paren
id|vm
comma
l_int|0x1234
comma
l_int|0x99
)paren
suffix:semicolon
r_for
c_loop
(paren
id|offs
op_assign
l_int|0x100000
suffix:semicolon
id|offs
OL
id|maxSize
suffix:semicolon
id|offs
op_add_assign
l_int|0x200000
)paren
(brace
r_if
c_cond
(paren
id|mga_readb
c_func
(paren
id|vm
comma
id|offs
)paren
op_ne
l_int|0x02
)paren
r_break
suffix:semicolon
id|mga_writeb
c_func
(paren
id|vm
comma
id|offs
comma
id|mga_readb
c_func
(paren
id|vm
comma
id|offs
)paren
op_minus
l_int|0x02
)paren
suffix:semicolon
r_if
c_cond
(paren
id|mga_readb
c_func
(paren
id|vm
comma
id|offs
)paren
)paren
r_break
suffix:semicolon
)brace
id|tmp
op_assign
id|bytes
suffix:semicolon
r_for
c_loop
(paren
id|offs2
op_assign
l_int|0x100000
suffix:semicolon
id|offs2
OL
id|maxSize
suffix:semicolon
id|offs2
op_add_assign
l_int|0x200000
)paren
id|mga_writeb
c_func
(paren
id|vm
comma
id|offs2
comma
op_star
id|tmp
op_increment
)paren
suffix:semicolon
id|mga_writeb
c_func
(paren
id|vm
comma
l_int|0x1234
comma
id|store
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_EXTVGA_INDEX
comma
l_int|0x03
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_EXTVGA_DATA
comma
id|mga_inb
c_func
(paren
id|M_EXTVGA_DATA
)paren
op_amp
op_complement
l_int|0x80
)paren
suffix:semicolon
op_star
id|realSize
op_assign
id|offs
op_minus
l_int|0x100000
suffix:semicolon
macro_line|#ifdef CONFIG_FB_MATROX_MILLENIUM
id|ACCESS_FBINFO
c_func
(paren
id|interleave
)paren
op_assign
op_logical_neg
(paren
op_logical_neg
id|isMillenium
c_func
(paren
id|MINFO
)paren
op_logical_or
(paren
(paren
id|offs
op_minus
l_int|0x100000
)paren
op_amp
l_int|0x3FFFFF
)paren
)paren
suffix:semicolon
macro_line|#endif
r_return
l_int|1
suffix:semicolon
)brace
)def_block
DECL|struct|video_board
r_struct
id|video_board
(brace
DECL|member|maxvram
r_int
id|maxvram
suffix:semicolon
DECL|member|maxdisplayable
r_int
id|maxdisplayable
suffix:semicolon
DECL|member|accelID
r_int
id|accelID
suffix:semicolon
DECL|member|lowlevel
r_struct
id|matrox_switch
op_star
id|lowlevel
suffix:semicolon
)brace
suffix:semicolon
macro_line|#ifdef CONFIG_FB_MATROX_MILLENIUM
DECL|variable|vbMillennium
r_static
r_struct
id|video_board
id|vbMillennium
op_assign
(brace
l_int|0x0800000
comma
l_int|0x0800000
comma
id|FB_ACCEL_MATROX_MGA2064W
comma
op_amp
id|matrox_millennium
)brace
suffix:semicolon
DECL|variable|vbMillennium2
r_static
r_struct
id|video_board
id|vbMillennium2
op_assign
(brace
l_int|0x1000000
comma
l_int|0x0800000
comma
id|FB_ACCEL_MATROX_MGA2164W
comma
op_amp
id|matrox_millennium
)brace
suffix:semicolon
DECL|variable|vbMillennium2A
r_static
r_struct
id|video_board
id|vbMillennium2A
op_assign
(brace
l_int|0x1000000
comma
l_int|0x0800000
comma
id|FB_ACCEL_MATROX_MGA2164W_AGP
comma
op_amp
id|matrox_millennium
)brace
suffix:semicolon
macro_line|#endif&t;/* CONFIG_FB_MATROX_MILLENIUM */
macro_line|#ifdef CONFIG_FB_MATROX_MYSTIQUE
DECL|variable|vbMystique
r_static
r_struct
id|video_board
id|vbMystique
op_assign
(brace
l_int|0x0800000
comma
l_int|0x0800000
comma
id|FB_ACCEL_MATROX_MGA1064SG
comma
op_amp
id|matrox_mystique
)brace
suffix:semicolon
macro_line|#endif&t;/* CONFIG_FB_MATROX_MYSTIQUE */
macro_line|#ifdef CONFIG_FB_MATROX_G100
DECL|variable|vbG100
r_static
r_struct
id|video_board
id|vbG100
op_assign
(brace
l_int|0x0800000
comma
l_int|0x0800000
comma
id|FB_ACCEL_MATROX_MGAG100
comma
op_amp
id|matrox_G100
)brace
suffix:semicolon
DECL|variable|vbG200
r_static
r_struct
id|video_board
id|vbG200
op_assign
(brace
l_int|0x1000000
comma
l_int|0x1000000
comma
id|FB_ACCEL_MATROX_MGAG200
comma
op_amp
id|matrox_G100
)brace
suffix:semicolon
macro_line|#ifdef CONFIG_FB_MATROX_32MB
multiline_comment|/* from doc it looks like that accelerator can draw only to low 16MB :-( Direct accesses &amp; displaying are OK for&n;   whole 32MB */
DECL|variable|vbG400
r_static
r_struct
id|video_board
id|vbG400
op_assign
(brace
l_int|0x2000000
comma
l_int|0x1000000
comma
id|FB_ACCEL_MATROX_MGAG400
comma
op_amp
id|matrox_G100
)brace
suffix:semicolon
macro_line|#else
DECL|variable|vbG400
r_static
r_struct
id|video_board
id|vbG400
op_assign
(brace
l_int|0x2000000
comma
l_int|0x1000000
comma
id|FB_ACCEL_MATROX_MGAG400
comma
op_amp
id|matrox_G100
)brace
suffix:semicolon
macro_line|#endif
macro_line|#endif
DECL|macro|DEVF_VIDEO64BIT
mdefine_line|#define DEVF_VIDEO64BIT&t;&t;0x0001
DECL|macro|DEVF_SWAPS
mdefine_line|#define&t;DEVF_SWAPS&t;&t;0x0002
DECL|macro|DEVF_SRCORG
mdefine_line|#define DEVF_SRCORG&t;&t;0x0004
DECL|macro|DEVF_DUALHEAD
mdefine_line|#define DEVF_DUALHEAD&t;&t;0x0008
DECL|macro|DEVF_CROSS4MB
mdefine_line|#define DEVF_CROSS4MB&t;&t;0x0010
DECL|macro|DEVF_TEXT4B
mdefine_line|#define DEVF_TEXT4B&t;&t;0x0020
multiline_comment|/* #define DEVF_recycled&t;0x0040&t;*/
multiline_comment|/* #define DEVF_recycled&t;0x0080&t;*/
DECL|macro|DEVF_SUPPORT32MB
mdefine_line|#define DEVF_SUPPORT32MB&t;0x0100
DECL|macro|DEVF_ANY_VXRES
mdefine_line|#define DEVF_ANY_VXRES&t;&t;0x0200
DECL|macro|DEVF_TEXT16B
mdefine_line|#define DEVF_TEXT16B&t;&t;0x0400
DECL|macro|DEVF_CRTC2
mdefine_line|#define DEVF_CRTC2&t;&t;0x0800
DECL|macro|DEVF_MAVEN_CAPABLE
mdefine_line|#define DEVF_MAVEN_CAPABLE&t;0x1000
DECL|macro|DEVF_PANELLINK_CAPABLE
mdefine_line|#define DEVF_PANELLINK_CAPABLE&t;0x2000
DECL|macro|DEVF_G450DAC
mdefine_line|#define DEVF_G450DAC&t;&t;0x4000
DECL|macro|DEVF_GCORE
mdefine_line|#define DEVF_GCORE&t;(DEVF_VIDEO64BIT | DEVF_SWAPS | DEVF_CROSS4MB)
DECL|macro|DEVF_G2CORE
mdefine_line|#define DEVF_G2CORE&t;(DEVF_GCORE | DEVF_ANY_VXRES | DEVF_MAVEN_CAPABLE | DEVF_PANELLINK_CAPABLE | DEVF_SRCORG | DEVF_DUALHEAD)
DECL|macro|DEVF_G100
mdefine_line|#define DEVF_G100&t;(DEVF_GCORE) /* no doc, no vxres... */
DECL|macro|DEVF_G200
mdefine_line|#define DEVF_G200&t;(DEVF_G2CORE)
DECL|macro|DEVF_G400
mdefine_line|#define DEVF_G400&t;(DEVF_G2CORE | DEVF_SUPPORT32MB | DEVF_TEXT16B | DEVF_CRTC2)
multiline_comment|/* if you&squot;ll find how to drive DFP... */
DECL|macro|DEVF_G450
mdefine_line|#define DEVF_G450&t;(DEVF_GCORE | DEVF_ANY_VXRES | DEVF_SUPPORT32MB | DEVF_TEXT16B | DEVF_CRTC2 | DEVF_G450DAC | DEVF_SRCORG | DEVF_DUALHEAD)
DECL|macro|DEVF_G550
mdefine_line|#define DEVF_G550&t;(DEVF_G450)
DECL|struct|board
r_static
r_struct
id|board
(brace
DECL|member|vendor
DECL|member|device
DECL|member|rev
DECL|member|svid
DECL|member|sid
r_int
r_int
id|vendor
comma
id|device
comma
id|rev
comma
id|svid
comma
id|sid
suffix:semicolon
DECL|member|flags
r_int
r_int
id|flags
suffix:semicolon
DECL|member|maxclk
r_int
r_int
id|maxclk
suffix:semicolon
DECL|member|chip
r_enum
id|mga_chip
id|chip
suffix:semicolon
DECL|member|base
r_struct
id|video_board
op_star
id|base
suffix:semicolon
DECL|member|name
r_const
r_char
op_star
id|name
suffix:semicolon
DECL|variable|dev_list
)brace
id|dev_list
(braket
)braket
op_assign
(brace
macro_line|#ifdef CONFIG_FB_MATROX_MILLENIUM
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_MIL
comma
l_int|0xFF
comma
l_int|0
comma
l_int|0
comma
id|DEVF_TEXT4B
comma
l_int|230000
comma
id|MGA_2064
comma
op_amp
id|vbMillennium
comma
l_string|&quot;Millennium (PCI)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_MIL_2
comma
l_int|0xFF
comma
l_int|0
comma
l_int|0
comma
id|DEVF_SWAPS
comma
l_int|220000
comma
id|MGA_2164
comma
op_amp
id|vbMillennium2
comma
l_string|&quot;Millennium II (PCI)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_MIL_2_AGP
comma
l_int|0xFF
comma
l_int|0
comma
l_int|0
comma
id|DEVF_SWAPS
comma
l_int|250000
comma
id|MGA_2164
comma
op_amp
id|vbMillennium2A
comma
l_string|&quot;Millennium II (AGP)&quot;
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_MATROX_MYSTIQUE
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_MYS
comma
l_int|0x02
comma
l_int|0
comma
l_int|0
comma
id|DEVF_VIDEO64BIT
op_or
id|DEVF_CROSS4MB
comma
l_int|180000
comma
id|MGA_1064
comma
op_amp
id|vbMystique
comma
l_string|&quot;Mystique (PCI)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_MYS
comma
l_int|0xFF
comma
l_int|0
comma
l_int|0
comma
id|DEVF_VIDEO64BIT
op_or
id|DEVF_SWAPS
op_or
id|DEVF_CROSS4MB
comma
l_int|220000
comma
id|MGA_1164
comma
op_amp
id|vbMystique
comma
l_string|&quot;Mystique 220 (PCI)&quot;
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_MATROX_G100
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G100_MM
comma
l_int|0xFF
comma
l_int|0
comma
l_int|0
comma
id|DEVF_G100
comma
l_int|230000
comma
id|MGA_G100
comma
op_amp
id|vbG100
comma
l_string|&quot;MGA-G100 (PCI)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G100_AGP
comma
l_int|0xFF
comma
l_int|0
comma
l_int|0
comma
id|DEVF_G100
comma
l_int|230000
comma
id|MGA_G100
comma
op_amp
id|vbG100
comma
l_string|&quot;MGA-G100 (AGP)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G200_PCI
comma
l_int|0xFF
comma
l_int|0
comma
l_int|0
comma
id|DEVF_G200
comma
l_int|250000
comma
id|MGA_G200
comma
op_amp
id|vbG200
comma
l_string|&quot;MGA-G200 (PCI)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G200_AGP
comma
l_int|0xFF
comma
id|PCI_SS_VENDOR_ID_MATROX
comma
id|PCI_SS_ID_MATROX_GENERIC
comma
id|DEVF_G200
comma
l_int|220000
comma
id|MGA_G200
comma
op_amp
id|vbG200
comma
l_string|&quot;MGA-G200 (AGP)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G200_AGP
comma
l_int|0xFF
comma
id|PCI_SS_VENDOR_ID_MATROX
comma
id|PCI_SS_ID_MATROX_MYSTIQUE_G200_AGP
comma
id|DEVF_G200
comma
l_int|230000
comma
id|MGA_G200
comma
op_amp
id|vbG200
comma
l_string|&quot;Mystique G200 (AGP)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G200_AGP
comma
l_int|0xFF
comma
id|PCI_SS_VENDOR_ID_MATROX
comma
id|PCI_SS_ID_MATROX_MILLENIUM_G200_AGP
comma
id|DEVF_G200
comma
l_int|250000
comma
id|MGA_G200
comma
op_amp
id|vbG200
comma
l_string|&quot;Millennium G200 (AGP)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G200_AGP
comma
l_int|0xFF
comma
id|PCI_SS_VENDOR_ID_MATROX
comma
id|PCI_SS_ID_MATROX_MARVEL_G200_AGP
comma
id|DEVF_G200
comma
l_int|230000
comma
id|MGA_G200
comma
op_amp
id|vbG200
comma
l_string|&quot;Marvel G200 (AGP)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G200_AGP
comma
l_int|0xFF
comma
id|PCI_SS_VENDOR_ID_SIEMENS_NIXDORF
comma
id|PCI_SS_ID_SIEMENS_MGA_G200_AGP
comma
id|DEVF_G200
comma
l_int|230000
comma
id|MGA_G200
comma
op_amp
id|vbG200
comma
l_string|&quot;MGA-G200 (AGP)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G200_AGP
comma
l_int|0xFF
comma
l_int|0
comma
l_int|0
comma
id|DEVF_G200
comma
l_int|230000
comma
id|MGA_G200
comma
op_amp
id|vbG200
comma
l_string|&quot;G200 (AGP)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G400
comma
l_int|0x80
comma
id|PCI_SS_VENDOR_ID_MATROX
comma
id|PCI_SS_ID_MATROX_MILLENNIUM_G400_MAX_AGP
comma
id|DEVF_G400
comma
l_int|360000
comma
id|MGA_G400
comma
op_amp
id|vbG400
comma
l_string|&quot;Millennium G400 MAX (AGP)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G400
comma
l_int|0x80
comma
l_int|0
comma
l_int|0
comma
id|DEVF_G400
comma
l_int|300000
comma
id|MGA_G400
comma
op_amp
id|vbG400
comma
l_string|&quot;G400 (AGP)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G400
comma
l_int|0xFF
comma
l_int|0
comma
l_int|0
comma
id|DEVF_G450
comma
l_int|360000
comma
id|MGA_G450
comma
op_amp
id|vbG400
comma
l_string|&quot;G450&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G550
comma
l_int|0xFF
comma
l_int|0
comma
l_int|0
comma
id|DEVF_G550
comma
l_int|360000
comma
id|MGA_G550
comma
op_amp
id|vbG400
comma
l_string|&quot;G550&quot;
)brace
comma
macro_line|#endif
(brace
l_int|0
comma
l_int|0
comma
l_int|0xFF
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|NULL
comma
l_int|NULL
)brace
)brace
suffix:semicolon
macro_line|#ifndef MODULE
DECL|variable|defaultmode
r_static
r_struct
id|fb_videomode
id|defaultmode
op_assign
(brace
multiline_comment|/* 640x480 @ 60Hz, 31.5 kHz */
l_int|NULL
comma
l_int|60
comma
l_int|640
comma
l_int|480
comma
l_int|39721
comma
l_int|40
comma
l_int|24
comma
l_int|32
comma
l_int|11
comma
l_int|96
comma
l_int|2
comma
l_int|0
comma
id|FB_VMODE_NONINTERLACED
)brace
suffix:semicolon
macro_line|#endif /* !MODULE */
DECL|variable|hotplug
r_static
r_int
id|hotplug
op_assign
l_int|0
suffix:semicolon
DECL|function|setDefaultOutputs
r_static
r_void
id|setDefaultOutputs
c_func
(paren
id|WPMINFO2
)paren
(brace
r_int
r_int
id|i
suffix:semicolon
r_const
r_char
op_star
id|ptr
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
l_int|0
)braket
)paren
dot
id|default_src
op_assign
id|MATROXFB_SRC_CRTC1
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.g450dac
)paren
)paren
(brace
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
l_int|1
)braket
)paren
dot
id|default_src
op_assign
id|MATROXFB_SRC_CRTC1
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
l_int|2
)braket
)paren
dot
id|default_src
op_assign
id|MATROXFB_SRC_CRTC1
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|dfp
)paren
(brace
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
l_int|2
)braket
)paren
dot
id|default_src
op_assign
id|MATROXFB_SRC_CRTC1
suffix:semicolon
)brace
id|ptr
op_assign
id|outputs
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|MATROXFB_MAX_OUTPUTS
suffix:semicolon
id|i
op_increment
)paren
(brace
r_char
id|c
op_assign
op_star
id|ptr
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|c
op_eq
l_int|0
)paren
(brace
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|c
op_eq
l_char|&squot;0&squot;
)paren
(brace
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
id|i
)braket
)paren
dot
id|default_src
op_assign
id|MATROXFB_SRC_NONE
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|c
op_eq
l_char|&squot;1&squot;
)paren
(brace
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
id|i
)braket
)paren
dot
id|default_src
op_assign
id|MATROXFB_SRC_CRTC1
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|c
op_eq
l_char|&squot;2&squot;
op_logical_and
id|ACCESS_FBINFO
c_func
(paren
id|devflags.crtc2
)paren
)paren
(brace
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
id|i
)braket
)paren
dot
id|default_src
op_assign
id|MATROXFB_SRC_CRTC2
suffix:semicolon
)brace
r_else
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;matroxfb: Unknown outputs setting&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
multiline_comment|/* Nullify this option for subsequent adapters */
id|outputs
(braket
l_int|0
)braket
op_assign
l_int|0
suffix:semicolon
)brace
DECL|function|initMatrox2
r_static
r_int
(def_block
id|initMatrox2
c_func
(paren
id|WPMINFO
r_struct
id|board
op_star
id|b
)paren
(brace
r_int
r_int
id|ctrlptr_phys
op_assign
l_int|0
suffix:semicolon
r_int
r_int
id|video_base_phys
op_assign
l_int|0
suffix:semicolon
r_int
r_int
id|memsize
suffix:semicolon
r_int
id|err
suffix:semicolon
r_static
r_struct
id|pci_device_id
id|intel_82437
(braket
)braket
op_assign
(brace
(brace
id|PCI_DEVICE
c_func
(paren
id|PCI_VENDOR_ID_INTEL
comma
id|PCI_DEVICE_ID_INTEL_82437
)paren
)brace
comma
(brace
)brace
comma
)brace
suffix:semicolon
id|DBG
c_func
(paren
id|__FUNCTION__
)paren
multiline_comment|/* set default values... */
id|vesafb_defined.accel_flags
op_assign
id|FB_ACCELF_TEXT
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|hw_switch
)paren
op_assign
id|b-&gt;base-&gt;lowlevel
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.accelerator
)paren
op_assign
id|b-&gt;base-&gt;accelID
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|max_pixel_clock
)paren
op_assign
id|b-&gt;maxclk
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;matroxfb: Matrox %s detected&bslash;n&quot;
comma
id|b-&gt;name
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|capable.plnwt
)paren
op_assign
l_int|1
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|chip
)paren
op_assign
id|b-&gt;chip
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|capable.srcorg
)paren
op_assign
id|b-&gt;flags
op_amp
id|DEVF_SRCORG
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.video64bits
)paren
op_assign
id|b-&gt;flags
op_amp
id|DEVF_VIDEO64BIT
suffix:semicolon
r_if
c_cond
(paren
id|b-&gt;flags
op_amp
id|DEVF_TEXT4B
)paren
(brace
id|ACCESS_FBINFO
c_func
(paren
id|devflags.vgastep
)paren
op_assign
l_int|4
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.textmode
)paren
op_assign
l_int|4
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.text_type_aux
)paren
op_assign
id|FB_AUX_TEXT_MGA_STEP16
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|b-&gt;flags
op_amp
id|DEVF_TEXT16B
)paren
(brace
id|ACCESS_FBINFO
c_func
(paren
id|devflags.vgastep
)paren
op_assign
l_int|16
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.textmode
)paren
op_assign
l_int|1
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.text_type_aux
)paren
op_assign
id|FB_AUX_TEXT_MGA_STEP16
suffix:semicolon
)brace
r_else
(brace
id|ACCESS_FBINFO
c_func
(paren
id|devflags.vgastep
)paren
op_assign
l_int|8
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.textmode
)paren
op_assign
l_int|1
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.text_type_aux
)paren
op_assign
id|FB_AUX_TEXT_MGA_STEP8
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_FB_MATROX_32MB
id|ACCESS_FBINFO
c_func
(paren
id|devflags.support32MB
)paren
op_assign
(paren
id|b-&gt;flags
op_amp
id|DEVF_SUPPORT32MB
)paren
op_ne
l_int|0
suffix:semicolon
macro_line|#endif
id|ACCESS_FBINFO
c_func
(paren
id|devflags.precise_width
)paren
op_assign
op_logical_neg
(paren
id|b-&gt;flags
op_amp
id|DEVF_ANY_VXRES
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.crtc2
)paren
op_assign
(paren
id|b-&gt;flags
op_amp
id|DEVF_CRTC2
)paren
op_ne
l_int|0
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.maven_capable
)paren
op_assign
(paren
id|b-&gt;flags
op_amp
id|DEVF_MAVEN_CAPABLE
)paren
op_ne
l_int|0
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.dualhead
)paren
op_assign
(paren
id|b-&gt;flags
op_amp
id|DEVF_DUALHEAD
)paren
op_ne
l_int|0
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.dfp_type
)paren
op_assign
id|dfp_type
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.g450dac
)paren
op_assign
(paren
id|b-&gt;flags
op_amp
id|DEVF_G450DAC
)paren
op_ne
l_int|0
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.textstep
)paren
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|devflags.vgastep
)paren
op_star
id|ACCESS_FBINFO
c_func
(paren
id|devflags.textmode
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.textvram
)paren
op_assign
l_int|65536
op_div
id|ACCESS_FBINFO
c_func
(paren
id|devflags.textmode
)paren
suffix:semicolon
id|setDefaultOutputs
c_func
(paren
id|PMINFO2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|b-&gt;flags
op_amp
id|DEVF_PANELLINK_CAPABLE
)paren
(brace
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
l_int|2
)braket
)paren
dot
id|data
op_assign
id|MINFO
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
l_int|2
)braket
)paren
dot
id|output
op_assign
op_amp
id|panellink_output
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
l_int|2
)braket
)paren
dot
id|src
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
l_int|2
)braket
)paren
dot
id|default_src
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|outputs
(braket
l_int|2
)braket
)paren
dot
id|mode
op_assign
id|MATROXFB_OUTPUT_MODE_MONITOR
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.panellink
)paren
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|capable.cross4MB
)paren
OL
l_int|0
)paren
id|ACCESS_FBINFO
c_func
(paren
id|capable.cross4MB
)paren
op_assign
id|b-&gt;flags
op_amp
id|DEVF_CROSS4MB
suffix:semicolon
r_if
c_cond
(paren
id|b-&gt;flags
op_amp
id|DEVF_SWAPS
)paren
(brace
id|ctrlptr_phys
op_assign
id|pci_resource_start
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
l_int|1
)paren
suffix:semicolon
id|video_base_phys
op_assign
id|pci_resource_start
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
l_int|0
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.fbResource
)paren
op_assign
id|PCI_BASE_ADDRESS_0
suffix:semicolon
)brace
r_else
(brace
id|ctrlptr_phys
op_assign
id|pci_resource_start
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
l_int|0
)paren
suffix:semicolon
id|video_base_phys
op_assign
id|pci_resource_start
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
l_int|1
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.fbResource
)paren
op_assign
id|PCI_BASE_ADDRESS_1
suffix:semicolon
)brace
id|err
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ctrlptr_phys
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;matroxfb: control registers are not available, matroxfb disabled&bslash;n&quot;
)paren
suffix:semicolon
r_goto
id|fail
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|video_base_phys
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;matroxfb: video RAM is not available in PCI address space, matroxfb disabled&bslash;n&quot;
)paren
suffix:semicolon
r_goto
id|fail
suffix:semicolon
)brace
id|memsize
op_assign
id|b-&gt;base-&gt;maxvram
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|request_mem_region
c_func
(paren
id|ctrlptr_phys
comma
l_int|16384
comma
l_string|&quot;matroxfb MMIO&quot;
)paren
)paren
(brace
r_goto
id|fail
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|request_mem_region
c_func
(paren
id|video_base_phys
comma
id|memsize
comma
l_string|&quot;matroxfb FB&quot;
)paren
)paren
(brace
r_goto
id|failCtrlMR
suffix:semicolon
)brace
id|ACCESS_FBINFO
c_func
(paren
id|video.len_maximum
)paren
op_assign
id|memsize
suffix:semicolon
multiline_comment|/* convert mem (autodetect k, M) */
r_if
c_cond
(paren
id|mem
OL
l_int|1024
)paren
id|mem
op_mul_assign
l_int|1024
suffix:semicolon
r_if
c_cond
(paren
id|mem
OL
l_int|0x00100000
)paren
id|mem
op_mul_assign
l_int|1024
suffix:semicolon
r_if
c_cond
(paren
id|mem
op_logical_and
(paren
id|mem
OL
id|memsize
)paren
)paren
id|memsize
op_assign
id|mem
suffix:semicolon
id|err
op_assign
op_minus
id|ENOMEM
suffix:semicolon
r_if
c_cond
(paren
id|mga_ioremap
c_func
(paren
id|ctrlptr_phys
comma
l_int|16384
comma
id|MGA_IOREMAP_MMIO
comma
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|mmio.vbase
)paren
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;matroxfb: cannot ioremap(%lX, 16384), matroxfb disabled&bslash;n&quot;
comma
id|ctrlptr_phys
)paren
suffix:semicolon
r_goto
id|failVideoMR
suffix:semicolon
)brace
id|ACCESS_FBINFO
c_func
(paren
id|mmio.base
)paren
op_assign
id|ctrlptr_phys
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|mmio.len
)paren
op_assign
l_int|16384
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|video.base
)paren
op_assign
id|video_base_phys
suffix:semicolon
r_if
c_cond
(paren
id|mga_ioremap
c_func
(paren
id|video_base_phys
comma
id|memsize
comma
id|MGA_IOREMAP_FB
comma
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;matroxfb: cannot ioremap(%lX, %d), matroxfb disabled&bslash;n&quot;
comma
id|video_base_phys
comma
id|memsize
)paren
suffix:semicolon
r_goto
id|failCtrlIO
suffix:semicolon
)brace
(brace
id|u_int32_t
id|cmd
suffix:semicolon
id|u_int32_t
id|mga_option
suffix:semicolon
id|pci_read_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_OPTION_REG
comma
op_amp
id|mga_option
)paren
suffix:semicolon
id|pci_read_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_COMMAND
comma
op_amp
id|cmd
)paren
suffix:semicolon
id|mga_option
op_and_assign
l_int|0x7FFFFFFF
suffix:semicolon
multiline_comment|/* clear BIG_ENDIAN */
id|mga_option
op_or_assign
id|MX_OPTION_BSWAP
suffix:semicolon
multiline_comment|/* disable palette snooping */
id|cmd
op_and_assign
op_complement
id|PCI_COMMAND_VGA_PALETTE
suffix:semicolon
r_if
c_cond
(paren
id|pci_dev_present
c_func
(paren
id|intel_82437
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|mga_option
op_amp
l_int|0x20000000
)paren
op_logical_and
op_logical_neg
id|ACCESS_FBINFO
c_func
(paren
id|devflags.nopciretry
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;matroxfb: Disabling PCI retries due to i82437 present&bslash;n&quot;
)paren
suffix:semicolon
)brace
id|mga_option
op_or_assign
l_int|0x20000000
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.nopciretry
)paren
op_assign
l_int|1
suffix:semicolon
)brace
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_COMMAND
comma
id|cmd
)paren
suffix:semicolon
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_OPTION_REG
comma
id|mga_option
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|hw
)paren
dot
id|MXoptionReg
op_assign
id|mga_option
suffix:semicolon
multiline_comment|/* select non-DMA memory for PCI_MGA_DATA, otherwise dump of PCI cfg space can lock PCI bus */
multiline_comment|/* maybe preinit() candidate, but it is same... for all devices... at this time... */
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_MGA_INDEX
comma
l_int|0x00003C00
)paren
suffix:semicolon
)brace
id|err
op_assign
op_minus
id|ENXIO
suffix:semicolon
id|matroxfb_read_pins
c_func
(paren
id|PMINFO2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|hw_switch
)paren
op_member_access_from_pointer
id|preinit
c_func
(paren
id|PMINFO2
)paren
)paren
(brace
r_goto
id|failVideoIO
suffix:semicolon
)brace
id|err
op_assign
op_minus
id|ENOMEM
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|matroxfb_getmemory
c_func
(paren
id|PMINFO
id|memsize
comma
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|video.len
)paren
)paren
op_logical_or
op_logical_neg
id|ACCESS_FBINFO
c_func
(paren
id|video.len
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;matroxfb: cannot determine memory size&bslash;n&quot;
)paren
suffix:semicolon
r_goto
id|failVideoIO
suffix:semicolon
)brace
id|ACCESS_FBINFO
c_func
(paren
id|devflags.ydstorg
)paren
op_assign
l_int|0
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|video.base
)paren
op_assign
id|video_base_phys
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|video.len_usable
)paren
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|video.len
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|video.len_usable
)paren
OG
id|b-&gt;base-&gt;maxdisplayable
)paren
id|ACCESS_FBINFO
c_func
(paren
id|video.len_usable
)paren
op_assign
id|b-&gt;base-&gt;maxdisplayable
suffix:semicolon
macro_line|#ifdef CONFIG_MTRR
r_if
c_cond
(paren
id|mtrr
)paren
(brace
id|ACCESS_FBINFO
c_func
(paren
id|mtrr.vram
)paren
op_assign
id|mtrr_add
c_func
(paren
id|video_base_phys
comma
id|ACCESS_FBINFO
c_func
(paren
id|video.len
)paren
comma
id|MTRR_TYPE_WRCOMB
comma
l_int|1
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|mtrr.vram_valid
)paren
op_assign
l_int|1
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;matroxfb: MTRR&squot;s turned on&bslash;n&quot;
)paren
suffix:semicolon
)brace
macro_line|#endif&t;/* CONFIG_MTRR */
r_if
c_cond
(paren
op_logical_neg
id|ACCESS_FBINFO
c_func
(paren
id|devflags.novga
)paren
)paren
id|request_region
c_func
(paren
l_int|0x3C0
comma
l_int|32
comma
l_string|&quot;matrox&quot;
)paren
suffix:semicolon
id|matroxfb_g450_connect
c_func
(paren
id|PMINFO2
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|hw_switch
op_member_access_from_pointer
id|reset
c_func
(paren
id|PMINFO2
)paren
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.monspecs.hfmin
)paren
op_assign
l_int|0
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.monspecs.hfmax
)paren
op_assign
id|fh
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.monspecs.vfmin
)paren
op_assign
l_int|0
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.monspecs.vfmax
)paren
op_assign
id|fv
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.monspecs.dpms
)paren
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* TBD */
multiline_comment|/* static settings */
id|vesafb_defined.red
op_assign
id|colors
(braket
id|depth
op_minus
l_int|1
)braket
dot
id|red
suffix:semicolon
id|vesafb_defined.green
op_assign
id|colors
(braket
id|depth
op_minus
l_int|1
)braket
dot
id|green
suffix:semicolon
id|vesafb_defined.blue
op_assign
id|colors
(braket
id|depth
op_minus
l_int|1
)braket
dot
id|blue
suffix:semicolon
id|vesafb_defined.bits_per_pixel
op_assign
id|colors
(braket
id|depth
op_minus
l_int|1
)braket
dot
id|bits_per_pixel
suffix:semicolon
id|vesafb_defined.grayscale
op_assign
id|grayscale
suffix:semicolon
id|vesafb_defined.vmode
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|noaccel
)paren
id|vesafb_defined.accel_flags
op_and_assign
op_complement
id|FB_ACCELF_TEXT
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fbops
)paren
op_assign
id|matroxfb_ops
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.fbops
)paren
op_assign
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|fbops
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.pseudo_palette
)paren
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|cmap
)paren
suffix:semicolon
multiline_comment|/* after __init time we are like module... no logo */
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.flags
)paren
op_assign
id|hotplug
ques
c_cond
id|FBINFO_FLAG_MODULE
suffix:colon
id|FBINFO_FLAG_DEFAULT
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.flags
)paren
op_or_assign
id|FBINFO_PARTIAL_PAN_OK
op_or
multiline_comment|/* Prefer panning for scroll under MC viewer/edit */
id|FBINFO_HWACCEL_COPYAREA
op_or
multiline_comment|/* We have hw-assisted bmove */
id|FBINFO_HWACCEL_FILLRECT
op_or
multiline_comment|/* And fillrect */
id|FBINFO_HWACCEL_IMAGEBLIT
op_or
multiline_comment|/* And imageblit */
id|FBINFO_HWACCEL_XPAN
op_or
multiline_comment|/* And we support both horizontal */
id|FBINFO_HWACCEL_YPAN
suffix:semicolon
multiline_comment|/* And vertical panning */
id|ACCESS_FBINFO
c_func
(paren
id|video.len_usable
)paren
op_and_assign
id|PAGE_MASK
suffix:semicolon
id|fb_alloc_cmap
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.cmap
)paren
comma
l_int|256
comma
l_int|1
)paren
suffix:semicolon
macro_line|#ifndef MODULE
multiline_comment|/* mode database is marked __init!!! */
r_if
c_cond
(paren
op_logical_neg
id|hotplug
)paren
(brace
id|fb_find_mode
c_func
(paren
op_amp
id|vesafb_defined
comma
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
comma
id|videomode
(braket
l_int|0
)braket
ques
c_cond
id|videomode
suffix:colon
l_int|NULL
comma
l_int|NULL
comma
l_int|0
comma
op_amp
id|defaultmode
comma
id|vesafb_defined.bits_per_pixel
)paren
suffix:semicolon
)brace
macro_line|#endif /* !MODULE */
multiline_comment|/* mode modifiers */
r_if
c_cond
(paren
id|hslen
)paren
id|vesafb_defined.hsync_len
op_assign
id|hslen
suffix:semicolon
r_if
c_cond
(paren
id|vslen
)paren
id|vesafb_defined.vsync_len
op_assign
id|vslen
suffix:semicolon
r_if
c_cond
(paren
id|left
op_ne
op_complement
l_int|0
)paren
id|vesafb_defined.left_margin
op_assign
id|left
suffix:semicolon
r_if
c_cond
(paren
id|right
op_ne
op_complement
l_int|0
)paren
id|vesafb_defined.right_margin
op_assign
id|right
suffix:semicolon
r_if
c_cond
(paren
id|upper
op_ne
op_complement
l_int|0
)paren
id|vesafb_defined.upper_margin
op_assign
id|upper
suffix:semicolon
r_if
c_cond
(paren
id|lower
op_ne
op_complement
l_int|0
)paren
id|vesafb_defined.lower_margin
op_assign
id|lower
suffix:semicolon
r_if
c_cond
(paren
id|xres
)paren
id|vesafb_defined.xres
op_assign
id|xres
suffix:semicolon
r_if
c_cond
(paren
id|yres
)paren
id|vesafb_defined.yres
op_assign
id|yres
suffix:semicolon
r_if
c_cond
(paren
id|sync
op_ne
op_minus
l_int|1
)paren
id|vesafb_defined.sync
op_assign
id|sync
suffix:semicolon
r_else
r_if
c_cond
(paren
id|vesafb_defined.sync
op_eq
op_complement
l_int|0
)paren
(brace
id|vesafb_defined.sync
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|yres
OL
l_int|400
)paren
id|vesafb_defined.sync
op_or_assign
id|FB_SYNC_HOR_HIGH_ACT
suffix:semicolon
r_else
r_if
c_cond
(paren
id|yres
OL
l_int|480
)paren
id|vesafb_defined.sync
op_or_assign
id|FB_SYNC_VERT_HIGH_ACT
suffix:semicolon
)brace
multiline_comment|/* fv, fh, maxclk limits was specified */
(brace
r_int
r_int
id|tmp
suffix:semicolon
r_if
c_cond
(paren
id|fv
)paren
(brace
id|tmp
op_assign
id|fv
op_star
(paren
id|vesafb_defined.upper_margin
op_plus
id|vesafb_defined.yres
op_plus
id|vesafb_defined.lower_margin
op_plus
id|vesafb_defined.vsync_len
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|tmp
OL
id|fh
)paren
op_logical_or
(paren
id|fh
op_eq
l_int|0
)paren
)paren
id|fh
op_assign
id|tmp
suffix:semicolon
)brace
r_if
c_cond
(paren
id|fh
)paren
(brace
id|tmp
op_assign
id|fh
op_star
(paren
id|vesafb_defined.left_margin
op_plus
id|vesafb_defined.xres
op_plus
id|vesafb_defined.right_margin
op_plus
id|vesafb_defined.hsync_len
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|tmp
OL
id|maxclk
)paren
op_logical_or
(paren
id|maxclk
op_eq
l_int|0
)paren
)paren
id|maxclk
op_assign
id|tmp
suffix:semicolon
)brace
id|tmp
op_assign
(paren
id|maxclk
op_plus
l_int|499
)paren
op_div
l_int|500
suffix:semicolon
r_if
c_cond
(paren
id|tmp
)paren
(brace
id|tmp
op_assign
(paren
l_int|2000000000
op_plus
id|tmp
)paren
op_div
id|tmp
suffix:semicolon
r_if
c_cond
(paren
id|tmp
OG
id|pixclock
)paren
id|pixclock
op_assign
id|tmp
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|pixclock
)paren
(brace
r_if
c_cond
(paren
id|pixclock
OL
l_int|2000
)paren
multiline_comment|/* &gt; 500MHz */
id|pixclock
op_assign
l_int|4000
suffix:semicolon
multiline_comment|/* 250MHz */
r_if
c_cond
(paren
id|pixclock
OG
l_int|1000000
)paren
id|pixclock
op_assign
l_int|1000000
suffix:semicolon
multiline_comment|/* 1MHz */
id|vesafb_defined.pixclock
op_assign
id|pixclock
suffix:semicolon
)brace
multiline_comment|/* FIXME: Where to move this?! */
macro_line|#if defined(CONFIG_PPC_PMAC)
macro_line|#ifndef MODULE
r_if
c_cond
(paren
id|_machine
op_eq
id|_MACH_Pmac
)paren
(brace
r_struct
id|fb_var_screeninfo
id|var
suffix:semicolon
r_if
c_cond
(paren
id|default_vmode
op_le
l_int|0
op_logical_or
id|default_vmode
OG
id|VMODE_MAX
)paren
id|default_vmode
op_assign
id|VMODE_640_480_60
suffix:semicolon
macro_line|#ifdef CONFIG_NVRAM
r_if
c_cond
(paren
id|default_cmode
op_eq
id|CMODE_NVRAM
)paren
id|default_cmode
op_assign
id|nvram_read_byte
c_func
(paren
id|NV_CMODE
)paren
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
id|default_cmode
template_param
id|CMODE_32
)paren
id|default_cmode
op_assign
id|CMODE_8
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|mac_vmode_to_var
c_func
(paren
id|default_vmode
comma
id|default_cmode
comma
op_amp
id|var
)paren
)paren
(brace
id|var.accel_flags
op_assign
id|vesafb_defined.accel_flags
suffix:semicolon
id|var.xoffset
op_assign
id|var.yoffset
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* Note: mac_vmode_to_var() does not set all parameters */
id|vesafb_defined
op_assign
id|var
suffix:semicolon
)brace
)brace
macro_line|#endif /* !MODULE */
macro_line|#endif /* CONFIG_PPC_PMAC */
id|vesafb_defined.xres_virtual
op_assign
id|vesafb_defined.xres
suffix:semicolon
r_if
c_cond
(paren
id|nopan
)paren
(brace
id|vesafb_defined.yres_virtual
op_assign
id|vesafb_defined.yres
suffix:semicolon
)brace
r_else
(brace
id|vesafb_defined.yres_virtual
op_assign
l_int|65536
suffix:semicolon
multiline_comment|/* large enough to be INF, but small enough&n;&t;&t;&t;&t;&t;&t;&t;to yres_virtual * xres_virtual &lt; 2^32 */
)brace
id|matroxfb_init_fix
c_func
(paren
id|PMINFO2
)paren
suffix:semicolon
multiline_comment|/* Normalize values (namely yres_virtual) */
id|matroxfb_check_var
c_func
(paren
op_amp
id|vesafb_defined
comma
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
)paren
suffix:semicolon
multiline_comment|/* And put it into &quot;current&quot; var. Do NOT program hardware yet, or we&squot;ll not take over&n;&t; * vgacon correctly. fbcon_startup will call fb_set_par for us, WITHOUT check_var,&n;&t; * and unfortunately it will do it BEFORE vgacon contents is saved, so it won&squot;t work&n;&t; * anyway. But we at least tried... */
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.var
)paren
op_assign
id|vesafb_defined
suffix:semicolon
id|err
op_assign
op_minus
id|EINVAL
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;matroxfb: %dx%dx%dbpp (virtual: %dx%d)&bslash;n&quot;
comma
id|vesafb_defined.xres
comma
id|vesafb_defined.yres
comma
id|vesafb_defined.bits_per_pixel
comma
id|vesafb_defined.xres_virtual
comma
id|vesafb_defined.yres_virtual
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;matroxfb: framebuffer at 0x%lX, mapped to 0x%p, size %d&bslash;n&quot;
comma
id|ACCESS_FBINFO
c_func
(paren
id|video.base
)paren
comma
id|vaddr_va
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
)paren
comma
id|ACCESS_FBINFO
c_func
(paren
id|video.len
)paren
)paren
suffix:semicolon
multiline_comment|/* We do not have to set currcon to 0... register_framebuffer do it for us on first console&n; * and we do not want currcon == 0 for subsequent framebuffers */
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
dot
id|device
op_assign
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
op_member_access_from_pointer
id|dev
suffix:semicolon
r_if
c_cond
(paren
id|register_framebuffer
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
)paren
OL
l_int|0
)paren
(brace
r_goto
id|failVideoIO
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;fb%d: %s frame buffer device&bslash;n&quot;
comma
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.node
)paren
comma
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.fix.id
)paren
)paren
suffix:semicolon
multiline_comment|/* there is no console on this fb... but we have to initialize hardware&n;&t; * until someone tells me what is proper thing to do */
r_if
c_cond
(paren
op_logical_neg
id|ACCESS_FBINFO
c_func
(paren
id|initialized
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;fb%d: initializing hardware&bslash;n&quot;
comma
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.node
)paren
)paren
suffix:semicolon
multiline_comment|/* We have to use FB_ACTIVATE_FORCE, as we had to put vesafb_defined to the fbcon.var&n; &t;&t; * already before, so register_framebuffer works correctly. */
id|vesafb_defined.activate
op_or_assign
id|FB_ACTIVATE_FORCE
suffix:semicolon
id|fb_set_var
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
comma
op_amp
id|vesafb_defined
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
id|failVideoIO
suffix:colon
suffix:semicolon
id|matroxfb_g450_shutdown
c_func
(paren
id|PMINFO2
)paren
suffix:semicolon
id|mga_iounmap
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
)paren
suffix:semicolon
id|failCtrlIO
suffix:colon
suffix:semicolon
id|mga_iounmap
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|mmio.vbase
)paren
)paren
suffix:semicolon
id|failVideoMR
suffix:colon
suffix:semicolon
id|release_mem_region
c_func
(paren
id|video_base_phys
comma
id|ACCESS_FBINFO
c_func
(paren
id|video.len_maximum
)paren
)paren
suffix:semicolon
id|failCtrlMR
suffix:colon
suffix:semicolon
id|release_mem_region
c_func
(paren
id|ctrlptr_phys
comma
l_int|16384
)paren
suffix:semicolon
id|fail
suffix:colon
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
)def_block
DECL|variable|matroxfb_list
id|LIST_HEAD
c_func
(paren
id|matroxfb_list
)paren
suffix:semicolon
DECL|variable|matroxfb_driver_list
id|LIST_HEAD
c_func
(paren
id|matroxfb_driver_list
)paren
suffix:semicolon
DECL|macro|matroxfb_l
mdefine_line|#define matroxfb_l(x) list_entry(x, struct matrox_fb_info, next_fb)
DECL|macro|matroxfb_driver_l
mdefine_line|#define matroxfb_driver_l(x) list_entry(x, struct matroxfb_driver, node)
DECL|function|matroxfb_register_driver
r_int
id|matroxfb_register_driver
c_func
(paren
r_struct
id|matroxfb_driver
op_star
id|drv
)paren
(brace
r_struct
id|matrox_fb_info
op_star
id|minfo
suffix:semicolon
id|list_add
c_func
(paren
op_amp
id|drv-&gt;node
comma
op_amp
id|matroxfb_driver_list
)paren
suffix:semicolon
r_for
c_loop
(paren
id|minfo
op_assign
id|matroxfb_l
c_func
(paren
id|matroxfb_list.next
)paren
suffix:semicolon
id|minfo
op_ne
id|matroxfb_l
c_func
(paren
op_amp
id|matroxfb_list
)paren
suffix:semicolon
id|minfo
op_assign
id|matroxfb_l
c_func
(paren
id|minfo-&gt;next_fb.next
)paren
)paren
(brace
r_void
op_star
id|p
suffix:semicolon
r_if
c_cond
(paren
id|minfo-&gt;drivers_count
op_eq
id|MATROXFB_MAX_FB_DRIVERS
)paren
r_continue
suffix:semicolon
id|p
op_assign
id|drv
op_member_access_from_pointer
id|probe
c_func
(paren
id|minfo
)paren
suffix:semicolon
r_if
c_cond
(paren
id|p
)paren
(brace
id|minfo-&gt;drivers_data
(braket
id|minfo-&gt;drivers_count
)braket
op_assign
id|p
suffix:semicolon
id|minfo-&gt;drivers
(braket
id|minfo-&gt;drivers_count
op_increment
)braket
op_assign
id|drv
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|matroxfb_unregister_driver
r_void
id|matroxfb_unregister_driver
c_func
(paren
r_struct
id|matroxfb_driver
op_star
id|drv
)paren
(brace
r_struct
id|matrox_fb_info
op_star
id|minfo
suffix:semicolon
id|list_del
c_func
(paren
op_amp
id|drv-&gt;node
)paren
suffix:semicolon
r_for
c_loop
(paren
id|minfo
op_assign
id|matroxfb_l
c_func
(paren
id|matroxfb_list.next
)paren
suffix:semicolon
id|minfo
op_ne
id|matroxfb_l
c_func
(paren
op_amp
id|matroxfb_list
)paren
suffix:semicolon
id|minfo
op_assign
id|matroxfb_l
c_func
(paren
id|minfo-&gt;next_fb.next
)paren
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|minfo-&gt;drivers_count
suffix:semicolon
)paren
(brace
r_if
c_cond
(paren
id|minfo-&gt;drivers
(braket
id|i
)braket
op_eq
id|drv
)paren
(brace
r_if
c_cond
(paren
id|drv
op_logical_and
id|drv-&gt;remove
)paren
id|drv
op_member_access_from_pointer
id|remove
c_func
(paren
id|minfo
comma
id|minfo-&gt;drivers_data
(braket
id|i
)braket
)paren
suffix:semicolon
id|minfo-&gt;drivers
(braket
id|i
)braket
op_assign
id|minfo-&gt;drivers
(braket
op_decrement
id|minfo-&gt;drivers_count
)braket
suffix:semicolon
id|minfo-&gt;drivers_data
(braket
id|i
)braket
op_assign
id|minfo-&gt;drivers_data
(braket
id|minfo-&gt;drivers_count
)braket
suffix:semicolon
)brace
r_else
id|i
op_increment
suffix:semicolon
)brace
)brace
)brace
DECL|function|matroxfb_register_device
r_static
r_void
id|matroxfb_register_device
c_func
(paren
r_struct
id|matrox_fb_info
op_star
id|minfo
)paren
(brace
r_struct
id|matroxfb_driver
op_star
id|drv
suffix:semicolon
r_int
id|i
op_assign
l_int|0
suffix:semicolon
id|list_add
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|next_fb
)paren
comma
op_amp
id|matroxfb_list
)paren
suffix:semicolon
r_for
c_loop
(paren
id|drv
op_assign
id|matroxfb_driver_l
c_func
(paren
id|matroxfb_driver_list.next
)paren
suffix:semicolon
id|drv
op_ne
id|matroxfb_driver_l
c_func
(paren
op_amp
id|matroxfb_driver_list
)paren
suffix:semicolon
id|drv
op_assign
id|matroxfb_driver_l
c_func
(paren
id|drv-&gt;node.next
)paren
)paren
(brace
r_if
c_cond
(paren
id|drv
op_logical_and
id|drv-&gt;probe
)paren
(brace
r_void
op_star
id|p
op_assign
id|drv
op_member_access_from_pointer
id|probe
c_func
(paren
id|minfo
)paren
suffix:semicolon
r_if
c_cond
(paren
id|p
)paren
(brace
id|minfo-&gt;drivers_data
(braket
id|i
)braket
op_assign
id|p
suffix:semicolon
id|minfo-&gt;drivers
(braket
id|i
op_increment
)braket
op_assign
id|drv
suffix:semicolon
r_if
c_cond
(paren
id|i
op_eq
id|MATROXFB_MAX_FB_DRIVERS
)paren
r_break
suffix:semicolon
)brace
)brace
)brace
id|minfo-&gt;drivers_count
op_assign
id|i
suffix:semicolon
)brace
DECL|function|matroxfb_unregister_device
r_static
r_void
id|matroxfb_unregister_device
c_func
(paren
r_struct
id|matrox_fb_info
op_star
id|minfo
)paren
(brace
r_int
id|i
suffix:semicolon
id|list_del
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|next_fb
)paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|minfo-&gt;drivers_count
suffix:semicolon
id|i
op_increment
)paren
(brace
r_struct
id|matroxfb_driver
op_star
id|drv
op_assign
id|minfo-&gt;drivers
(braket
id|i
)braket
suffix:semicolon
r_if
c_cond
(paren
id|drv
op_logical_and
id|drv-&gt;remove
)paren
id|drv
op_member_access_from_pointer
id|remove
c_func
(paren
id|minfo
comma
id|minfo-&gt;drivers_data
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
)brace
DECL|function|matroxfb_probe
r_static
r_int
id|matroxfb_probe
c_func
(paren
r_struct
id|pci_dev
op_star
id|pdev
comma
r_const
r_struct
id|pci_device_id
op_star
id|dummy
)paren
(brace
r_struct
id|board
op_star
id|b
suffix:semicolon
id|u_int8_t
id|rev
suffix:semicolon
id|u_int16_t
id|svid
suffix:semicolon
id|u_int16_t
id|sid
suffix:semicolon
r_struct
id|matrox_fb_info
op_star
id|minfo
suffix:semicolon
r_int
id|err
suffix:semicolon
id|u_int32_t
id|cmd
suffix:semicolon
macro_line|#ifndef CONFIG_FB_MATROX_MULTIHEAD
r_static
r_int
id|registered
op_assign
l_int|0
suffix:semicolon
macro_line|#endif
id|DBG
c_func
(paren
id|__FUNCTION__
)paren
id|pci_read_config_byte
c_func
(paren
id|pdev
comma
id|PCI_REVISION_ID
comma
op_amp
id|rev
)paren
suffix:semicolon
id|svid
op_assign
id|pdev-&gt;subsystem_vendor
suffix:semicolon
id|sid
op_assign
id|pdev-&gt;subsystem_device
suffix:semicolon
r_for
c_loop
(paren
id|b
op_assign
id|dev_list
suffix:semicolon
id|b-&gt;vendor
suffix:semicolon
id|b
op_increment
)paren
(brace
r_if
c_cond
(paren
(paren
id|b-&gt;vendor
op_ne
id|pdev-&gt;vendor
)paren
op_logical_or
(paren
id|b-&gt;device
op_ne
id|pdev-&gt;device
)paren
op_logical_or
(paren
id|b-&gt;rev
OL
id|rev
)paren
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|b-&gt;svid
)paren
r_if
c_cond
(paren
(paren
id|b-&gt;svid
op_ne
id|svid
)paren
op_logical_or
(paren
id|b-&gt;sid
op_ne
id|sid
)paren
)paren
r_continue
suffix:semicolon
r_break
suffix:semicolon
)brace
multiline_comment|/* not match... */
r_if
c_cond
(paren
op_logical_neg
id|b-&gt;vendor
)paren
r_return
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|dev
OG
l_int|0
)paren
(brace
multiline_comment|/* not requested one... */
id|dev
op_decrement
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
id|pci_read_config_dword
c_func
(paren
id|pdev
comma
id|PCI_COMMAND
comma
op_amp
id|cmd
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pci_enable_device
c_func
(paren
id|pdev
)paren
)paren
(brace
r_return
op_minus
l_int|1
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_FB_MATROX_MULTIHEAD
id|minfo
op_assign
(paren
r_struct
id|matrox_fb_info
op_star
)paren
id|kmalloc
c_func
(paren
r_sizeof
(paren
op_star
id|minfo
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|minfo
)paren
r_return
op_minus
l_int|1
suffix:semicolon
macro_line|#else
r_if
c_cond
(paren
id|registered
)paren
multiline_comment|/* singlehead driver... */
r_return
op_minus
l_int|1
suffix:semicolon
id|minfo
op_assign
op_amp
id|matroxfb_global_mxinfo
suffix:semicolon
macro_line|#endif
id|memset
c_func
(paren
id|MINFO
comma
l_int|0
comma
r_sizeof
(paren
op_star
id|MINFO
)paren
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
op_assign
id|pdev
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|dead
)paren
op_assign
l_int|0
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|usecount
)paren
op_assign
l_int|0
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|userusecount
)paren
op_assign
l_int|0
suffix:semicolon
id|pci_set_drvdata
c_func
(paren
id|pdev
comma
id|MINFO
)paren
suffix:semicolon
multiline_comment|/* DEVFLAGS */
id|ACCESS_FBINFO
c_func
(paren
id|devflags.memtype
)paren
op_assign
id|memtype
suffix:semicolon
r_if
c_cond
(paren
id|memtype
op_ne
op_minus
l_int|1
)paren
id|noinit
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|cmd
op_amp
id|PCI_COMMAND_MEMORY
)paren
(brace
id|ACCESS_FBINFO
c_func
(paren
id|devflags.novga
)paren
op_assign
id|novga
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.nobios
)paren
op_assign
id|nobios
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.noinit
)paren
op_assign
id|noinit
suffix:semicolon
multiline_comment|/* subsequent heads always needs initialization and must not enable BIOS */
id|novga
op_assign
l_int|1
suffix:semicolon
id|nobios
op_assign
l_int|1
suffix:semicolon
id|noinit
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|ACCESS_FBINFO
c_func
(paren
id|devflags.novga
)paren
op_assign
l_int|1
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.nobios
)paren
op_assign
l_int|1
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.noinit
)paren
op_assign
l_int|0
suffix:semicolon
)brace
id|ACCESS_FBINFO
c_func
(paren
id|devflags.nopciretry
)paren
op_assign
id|no_pci_retry
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.mga_24bpp_fix
)paren
op_assign
id|inv24
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.precise_width
)paren
op_assign
id|option_precise_width
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.sgram
)paren
op_assign
id|sgram
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|capable.cross4MB
)paren
op_assign
id|cross4MB
suffix:semicolon
id|spin_lock_init
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|lock.DAC
)paren
)paren
suffix:semicolon
id|spin_lock_init
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|lock.accel
)paren
)paren
suffix:semicolon
id|init_rwsem
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|crtc2.lock
)paren
)paren
suffix:semicolon
id|init_rwsem
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|altout.lock
)paren
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|irq_flags
)paren
op_assign
l_int|0
suffix:semicolon
id|init_waitqueue_head
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|crtc1.vsync.wait
)paren
)paren
suffix:semicolon
id|init_waitqueue_head
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|crtc2.vsync.wait
)paren
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|crtc1.panpos
)paren
op_assign
op_minus
l_int|1
suffix:semicolon
id|err
op_assign
id|initMatrox2
c_func
(paren
id|PMINFO
id|b
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|err
)paren
(brace
macro_line|#ifndef CONFIG_FB_MATROX_MULTIHEAD
id|registered
op_assign
l_int|1
suffix:semicolon
macro_line|#endif
id|matroxfb_register_device
c_func
(paren
id|MINFO
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_FB_MATROX_MULTIHEAD
id|kfree
c_func
(paren
id|minfo
)paren
suffix:semicolon
macro_line|#endif
r_return
op_minus
l_int|1
suffix:semicolon
)brace
DECL|function|pci_remove_matrox
r_static
r_void
id|pci_remove_matrox
c_func
(paren
r_struct
id|pci_dev
op_star
id|pdev
)paren
(brace
r_struct
id|matrox_fb_info
op_star
id|minfo
suffix:semicolon
id|minfo
op_assign
id|pci_get_drvdata
c_func
(paren
id|pdev
)paren
suffix:semicolon
id|matroxfb_remove
c_func
(paren
id|PMINFO
l_int|1
)paren
suffix:semicolon
)brace
DECL|variable|matroxfb_devices
r_static
r_struct
id|pci_device_id
id|matroxfb_devices
(braket
)braket
op_assign
(brace
macro_line|#ifdef CONFIG_FB_MATROX_MILLENIUM
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_MIL
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_MIL_2
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_MIL_2_AGP
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_MATROX_MYSTIQUE
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_MYS
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_MATROX_G100
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G100_MM
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G100_AGP
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G200_PCI
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G200_AGP
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G400
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G550
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
macro_line|#endif
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
)brace
suffix:semicolon
id|MODULE_DEVICE_TABLE
c_func
(paren
id|pci
comma
id|matroxfb_devices
)paren
suffix:semicolon
DECL|variable|matroxfb_driver
r_static
r_struct
id|pci_driver
id|matroxfb_driver
op_assign
(brace
dot
id|name
op_assign
l_string|&quot;matroxfb&quot;
comma
dot
id|id_table
op_assign
id|matroxfb_devices
comma
dot
id|probe
op_assign
id|matroxfb_probe
comma
dot
id|remove
op_assign
id|pci_remove_matrox
comma
)brace
suffix:semicolon
multiline_comment|/* **************************** init-time only **************************** */
DECL|macro|RSResolution
mdefine_line|#define RSResolution(X)&t;((X) &amp; 0x0F)
DECL|macro|RS640x400
mdefine_line|#define RS640x400&t;1
DECL|macro|RS640x480
mdefine_line|#define RS640x480&t;2
DECL|macro|RS800x600
mdefine_line|#define RS800x600&t;3
DECL|macro|RS1024x768
mdefine_line|#define RS1024x768&t;4
DECL|macro|RS1280x1024
mdefine_line|#define RS1280x1024&t;5
DECL|macro|RS1600x1200
mdefine_line|#define RS1600x1200&t;6
DECL|macro|RS768x576
mdefine_line|#define RS768x576&t;7
DECL|macro|RS960x720
mdefine_line|#define RS960x720&t;8
DECL|macro|RS1152x864
mdefine_line|#define RS1152x864&t;9
DECL|macro|RS1408x1056
mdefine_line|#define RS1408x1056&t;10
DECL|macro|RS640x350
mdefine_line|#define RS640x350&t;11
DECL|macro|RS1056x344
mdefine_line|#define RS1056x344&t;12&t;/* 132 x 43 text */
DECL|macro|RS1056x400
mdefine_line|#define RS1056x400&t;13&t;/* 132 x 50 text */
DECL|macro|RS1056x480
mdefine_line|#define RS1056x480&t;14&t;/* 132 x 60 text */
DECL|macro|RSNoxNo
mdefine_line|#define RSNoxNo&t;&t;15
multiline_comment|/* 10-FF */
DECL|member|xres
DECL|member|yres
DECL|member|left
DECL|member|right
DECL|member|upper
DECL|member|lower
DECL|member|hslen
DECL|member|vslen
DECL|member|vfreq
DECL|variable|__initdata
r_static
r_struct
(brace
r_int
id|xres
comma
id|yres
comma
id|left
comma
id|right
comma
id|upper
comma
id|lower
comma
id|hslen
comma
id|vslen
comma
id|vfreq
suffix:semicolon
)brace
id|timmings
(braket
)braket
id|__initdata
op_assign
(brace
(brace
l_int|640
comma
l_int|400
comma
l_int|48
comma
l_int|16
comma
l_int|39
comma
l_int|8
comma
l_int|96
comma
l_int|2
comma
l_int|70
)brace
comma
(brace
l_int|640
comma
l_int|480
comma
l_int|48
comma
l_int|16
comma
l_int|33
comma
l_int|10
comma
l_int|96
comma
l_int|2
comma
l_int|60
)brace
comma
(brace
l_int|800
comma
l_int|600
comma
l_int|144
comma
l_int|24
comma
l_int|28
comma
l_int|8
comma
l_int|112
comma
l_int|6
comma
l_int|60
)brace
comma
(brace
l_int|1024
comma
l_int|768
comma
l_int|160
comma
l_int|32
comma
l_int|30
comma
l_int|4
comma
l_int|128
comma
l_int|4
comma
l_int|60
)brace
comma
(brace
l_int|1280
comma
l_int|1024
comma
l_int|224
comma
l_int|32
comma
l_int|32
comma
l_int|4
comma
l_int|136
comma
l_int|4
comma
l_int|60
)brace
comma
(brace
l_int|1600
comma
l_int|1200
comma
l_int|272
comma
l_int|48
comma
l_int|32
comma
l_int|5
comma
l_int|152
comma
l_int|5
comma
l_int|60
)brace
comma
(brace
l_int|768
comma
l_int|576
comma
l_int|144
comma
l_int|16
comma
l_int|28
comma
l_int|6
comma
l_int|112
comma
l_int|4
comma
l_int|60
)brace
comma
(brace
l_int|960
comma
l_int|720
comma
l_int|144
comma
l_int|24
comma
l_int|28
comma
l_int|8
comma
l_int|112
comma
l_int|4
comma
l_int|60
)brace
comma
(brace
l_int|1152
comma
l_int|864
comma
l_int|192
comma
l_int|32
comma
l_int|30
comma
l_int|4
comma
l_int|128
comma
l_int|4
comma
l_int|60
)brace
comma
(brace
l_int|1408
comma
l_int|1056
comma
l_int|256
comma
l_int|40
comma
l_int|32
comma
l_int|5
comma
l_int|144
comma
l_int|5
comma
l_int|60
)brace
comma
(brace
l_int|640
comma
l_int|350
comma
l_int|48
comma
l_int|16
comma
l_int|39
comma
l_int|8
comma
l_int|96
comma
l_int|2
comma
l_int|70
)brace
comma
(brace
l_int|1056
comma
l_int|344
comma
l_int|96
comma
l_int|24
comma
l_int|59
comma
l_int|44
comma
l_int|160
comma
l_int|2
comma
l_int|70
)brace
comma
(brace
l_int|1056
comma
l_int|400
comma
l_int|96
comma
l_int|24
comma
l_int|39
comma
l_int|8
comma
l_int|160
comma
l_int|2
comma
l_int|70
)brace
comma
(brace
l_int|1056
comma
l_int|480
comma
l_int|96
comma
l_int|24
comma
l_int|36
comma
l_int|12
comma
l_int|160
comma
l_int|3
comma
l_int|60
)brace
comma
(brace
l_int|0
comma
l_int|0
comma
op_complement
l_int|0
comma
op_complement
l_int|0
comma
op_complement
l_int|0
comma
op_complement
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
)brace
suffix:semicolon
DECL|macro|RSCreate
mdefine_line|#define RSCreate(X,Y)&t;((X) | ((Y) &lt;&lt; 8))
DECL|member|vesa
DECL|member|info
DECL|variable|RSptr
DECL|variable|__initdata
r_static
r_struct
(brace
r_int
r_int
id|vesa
suffix:semicolon
r_int
r_int
id|info
suffix:semicolon
)brace
op_star
id|RSptr
comma
id|vesamap
(braket
)braket
id|__initdata
op_assign
(brace
multiline_comment|/* default must be first */
(brace
op_complement
l_int|0
comma
id|RSCreate
c_func
(paren
id|RSNoxNo
comma
id|RS8bpp
)paren
)brace
comma
(brace
l_int|0x101
comma
id|RSCreate
c_func
(paren
id|RS640x480
comma
id|RS8bpp
)paren
)brace
comma
(brace
l_int|0x100
comma
id|RSCreate
c_func
(paren
id|RS640x400
comma
id|RS8bpp
)paren
)brace
comma
(brace
l_int|0x180
comma
id|RSCreate
c_func
(paren
id|RS768x576
comma
id|RS8bpp
)paren
)brace
comma
(brace
l_int|0x103
comma
id|RSCreate
c_func
(paren
id|RS800x600
comma
id|RS8bpp
)paren
)brace
comma
(brace
l_int|0x188
comma
id|RSCreate
c_func
(paren
id|RS960x720
comma
id|RS8bpp
)paren
)brace
comma
(brace
l_int|0x105
comma
id|RSCreate
c_func
(paren
id|RS1024x768
comma
id|RS8bpp
)paren
)brace
comma
(brace
l_int|0x190
comma
id|RSCreate
c_func
(paren
id|RS1152x864
comma
id|RS8bpp
)paren
)brace
comma
(brace
l_int|0x107
comma
id|RSCreate
c_func
(paren
id|RS1280x1024
comma
id|RS8bpp
)paren
)brace
comma
(brace
l_int|0x198
comma
id|RSCreate
c_func
(paren
id|RS1408x1056
comma
id|RS8bpp
)paren
)brace
comma
(brace
l_int|0x11C
comma
id|RSCreate
c_func
(paren
id|RS1600x1200
comma
id|RS8bpp
)paren
)brace
comma
(brace
l_int|0x110
comma
id|RSCreate
c_func
(paren
id|RS640x480
comma
id|RS15bpp
)paren
)brace
comma
(brace
l_int|0x181
comma
id|RSCreate
c_func
(paren
id|RS768x576
comma
id|RS15bpp
)paren
)brace
comma
(brace
l_int|0x113
comma
id|RSCreate
c_func
(paren
id|RS800x600
comma
id|RS15bpp
)paren
)brace
comma
(brace
l_int|0x189
comma
id|RSCreate
c_func
(paren
id|RS960x720
comma
id|RS15bpp
)paren
)brace
comma
(brace
l_int|0x116
comma
id|RSCreate
c_func
(paren
id|RS1024x768
comma
id|RS15bpp
)paren
)brace
comma
(brace
l_int|0x191
comma
id|RSCreate
c_func
(paren
id|RS1152x864
comma
id|RS15bpp
)paren
)brace
comma
(brace
l_int|0x119
comma
id|RSCreate
c_func
(paren
id|RS1280x1024
comma
id|RS15bpp
)paren
)brace
comma
(brace
l_int|0x199
comma
id|RSCreate
c_func
(paren
id|RS1408x1056
comma
id|RS15bpp
)paren
)brace
comma
(brace
l_int|0x11D
comma
id|RSCreate
c_func
(paren
id|RS1600x1200
comma
id|RS15bpp
)paren
)brace
comma
(brace
l_int|0x111
comma
id|RSCreate
c_func
(paren
id|RS640x480
comma
id|RS16bpp
)paren
)brace
comma
(brace
l_int|0x182
comma
id|RSCreate
c_func
(paren
id|RS768x576
comma
id|RS16bpp
)paren
)brace
comma
(brace
l_int|0x114
comma
id|RSCreate
c_func
(paren
id|RS800x600
comma
id|RS16bpp
)paren
)brace
comma
(brace
l_int|0x18A
comma
id|RSCreate
c_func
(paren
id|RS960x720
comma
id|RS16bpp
)paren
)brace
comma
(brace
l_int|0x117
comma
id|RSCreate
c_func
(paren
id|RS1024x768
comma
id|RS16bpp
)paren
)brace
comma
(brace
l_int|0x192
comma
id|RSCreate
c_func
(paren
id|RS1152x864
comma
id|RS16bpp
)paren
)brace
comma
(brace
l_int|0x11A
comma
id|RSCreate
c_func
(paren
id|RS1280x1024
comma
id|RS16bpp
)paren
)brace
comma
(brace
l_int|0x19A
comma
id|RSCreate
c_func
(paren
id|RS1408x1056
comma
id|RS16bpp
)paren
)brace
comma
(brace
l_int|0x11E
comma
id|RSCreate
c_func
(paren
id|RS1600x1200
comma
id|RS16bpp
)paren
)brace
comma
(brace
l_int|0x1B2
comma
id|RSCreate
c_func
(paren
id|RS640x480
comma
id|RS24bpp
)paren
)brace
comma
(brace
l_int|0x184
comma
id|RSCreate
c_func
(paren
id|RS768x576
comma
id|RS24bpp
)paren
)brace
comma
(brace
l_int|0x1B5
comma
id|RSCreate
c_func
(paren
id|RS800x600
comma
id|RS24bpp
)paren
)brace
comma
(brace
l_int|0x18C
comma
id|RSCreate
c_func
(paren
id|RS960x720
comma
id|RS24bpp
)paren
)brace
comma
(brace
l_int|0x1B8
comma
id|RSCreate
c_func
(paren
id|RS1024x768
comma
id|RS24bpp
)paren
)brace
comma
(brace
l_int|0x194
comma
id|RSCreate
c_func
(paren
id|RS1152x864
comma
id|RS24bpp
)paren
)brace
comma
(brace
l_int|0x1BB
comma
id|RSCreate
c_func
(paren
id|RS1280x1024
comma
id|RS24bpp
)paren
)brace
comma
(brace
l_int|0x19C
comma
id|RSCreate
c_func
(paren
id|RS1408x1056
comma
id|RS24bpp
)paren
)brace
comma
(brace
l_int|0x1BF
comma
id|RSCreate
c_func
(paren
id|RS1600x1200
comma
id|RS24bpp
)paren
)brace
comma
(brace
l_int|0x112
comma
id|RSCreate
c_func
(paren
id|RS640x480
comma
id|RS32bpp
)paren
)brace
comma
(brace
l_int|0x183
comma
id|RSCreate
c_func
(paren
id|RS768x576
comma
id|RS32bpp
)paren
)brace
comma
(brace
l_int|0x115
comma
id|RSCreate
c_func
(paren
id|RS800x600
comma
id|RS32bpp
)paren
)brace
comma
(brace
l_int|0x18B
comma
id|RSCreate
c_func
(paren
id|RS960x720
comma
id|RS32bpp
)paren
)brace
comma
(brace
l_int|0x118
comma
id|RSCreate
c_func
(paren
id|RS1024x768
comma
id|RS32bpp
)paren
)brace
comma
(brace
l_int|0x193
comma
id|RSCreate
c_func
(paren
id|RS1152x864
comma
id|RS32bpp
)paren
)brace
comma
(brace
l_int|0x11B
comma
id|RSCreate
c_func
(paren
id|RS1280x1024
comma
id|RS32bpp
)paren
)brace
comma
(brace
l_int|0x19B
comma
id|RSCreate
c_func
(paren
id|RS1408x1056
comma
id|RS32bpp
)paren
)brace
comma
(brace
l_int|0x11F
comma
id|RSCreate
c_func
(paren
id|RS1600x1200
comma
id|RS32bpp
)paren
)brace
comma
(brace
l_int|0x010
comma
id|RSCreate
c_func
(paren
id|RS640x350
comma
id|RS4bpp
)paren
)brace
comma
(brace
l_int|0x012
comma
id|RSCreate
c_func
(paren
id|RS640x480
comma
id|RS4bpp
)paren
)brace
comma
(brace
l_int|0x102
comma
id|RSCreate
c_func
(paren
id|RS800x600
comma
id|RS4bpp
)paren
)brace
comma
(brace
l_int|0x104
comma
id|RSCreate
c_func
(paren
id|RS1024x768
comma
id|RS4bpp
)paren
)brace
comma
(brace
l_int|0x106
comma
id|RSCreate
c_func
(paren
id|RS1280x1024
comma
id|RS4bpp
)paren
)brace
comma
(brace
l_int|0
comma
l_int|0
)brace
)brace
suffix:semicolon
DECL|function|matroxfb_init_params
r_static
r_void
id|__init
id|matroxfb_init_params
c_func
(paren
r_void
)paren
(brace
multiline_comment|/* fh from kHz to Hz */
r_if
c_cond
(paren
id|fh
OL
l_int|1000
)paren
id|fh
op_mul_assign
l_int|1000
suffix:semicolon
multiline_comment|/* 1kHz minimum */
multiline_comment|/* maxclk */
r_if
c_cond
(paren
id|maxclk
OL
l_int|1000
)paren
id|maxclk
op_mul_assign
l_int|1000
suffix:semicolon
multiline_comment|/* kHz -&gt; Hz, MHz -&gt; kHz */
r_if
c_cond
(paren
id|maxclk
OL
l_int|1000000
)paren
id|maxclk
op_mul_assign
l_int|1000
suffix:semicolon
multiline_comment|/* kHz -&gt; Hz, 1MHz minimum */
multiline_comment|/* fix VESA number */
r_if
c_cond
(paren
id|vesa
op_ne
op_complement
l_int|0
)paren
id|vesa
op_and_assign
l_int|0x1DFF
suffix:semicolon
multiline_comment|/* mask out clearscreen, acceleration and so on */
multiline_comment|/* static settings */
r_for
c_loop
(paren
id|RSptr
op_assign
id|vesamap
suffix:semicolon
id|RSptr-&gt;vesa
suffix:semicolon
id|RSptr
op_increment
)paren
(brace
r_if
c_cond
(paren
id|RSptr-&gt;vesa
op_eq
id|vesa
)paren
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|RSptr-&gt;vesa
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;Invalid vesa mode 0x%04X&bslash;n&quot;
comma
id|vesa
)paren
suffix:semicolon
id|RSptr
op_assign
id|vesamap
suffix:semicolon
)brace
(brace
r_int
id|res
op_assign
id|RSResolution
c_func
(paren
id|RSptr-&gt;info
)paren
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|left
op_eq
op_complement
l_int|0
)paren
id|left
op_assign
id|timmings
(braket
id|res
)braket
dot
id|left
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|xres
)paren
id|xres
op_assign
id|timmings
(braket
id|res
)braket
dot
id|xres
suffix:semicolon
r_if
c_cond
(paren
id|right
op_eq
op_complement
l_int|0
)paren
id|right
op_assign
id|timmings
(braket
id|res
)braket
dot
id|right
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|hslen
)paren
id|hslen
op_assign
id|timmings
(braket
id|res
)braket
dot
id|hslen
suffix:semicolon
r_if
c_cond
(paren
id|upper
op_eq
op_complement
l_int|0
)paren
id|upper
op_assign
id|timmings
(braket
id|res
)braket
dot
id|upper
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|yres
)paren
id|yres
op_assign
id|timmings
(braket
id|res
)braket
dot
id|yres
suffix:semicolon
r_if
c_cond
(paren
id|lower
op_eq
op_complement
l_int|0
)paren
id|lower
op_assign
id|timmings
(braket
id|res
)braket
dot
id|lower
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|vslen
)paren
id|vslen
op_assign
id|timmings
(braket
id|res
)braket
dot
id|vslen
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|fv
op_logical_or
id|fh
op_logical_or
id|maxclk
op_logical_or
id|pixclock
)paren
)paren
id|fv
op_assign
id|timmings
(braket
id|res
)braket
dot
id|vfreq
suffix:semicolon
r_if
c_cond
(paren
id|depth
op_eq
op_minus
l_int|1
)paren
id|depth
op_assign
id|RSDepth
c_func
(paren
id|RSptr-&gt;info
)paren
suffix:semicolon
)brace
)brace
DECL|function|matrox_init
r_static
r_void
id|__init
id|matrox_init
c_func
(paren
r_void
)paren
(brace
id|matroxfb_init_params
c_func
(paren
)paren
suffix:semicolon
id|pci_register_driver
c_func
(paren
op_amp
id|matroxfb_driver
)paren
suffix:semicolon
id|dev
op_assign
op_minus
l_int|1
suffix:semicolon
multiline_comment|/* accept all new devices... */
)brace
multiline_comment|/* **************************** exit-time only **************************** */
DECL|function|matrox_done
r_static
r_void
id|__exit
id|matrox_done
c_func
(paren
r_void
)paren
(brace
id|pci_unregister_driver
c_func
(paren
op_amp
id|matroxfb_driver
)paren
suffix:semicolon
)brace
macro_line|#ifndef MODULE
multiline_comment|/* ************************* init in-kernel code ************************** */
DECL|function|matroxfb_setup
r_int
id|__init
id|matroxfb_setup
c_func
(paren
r_char
op_star
id|options
)paren
(brace
r_char
op_star
id|this_opt
suffix:semicolon
id|DBG
c_func
(paren
id|__FUNCTION__
)paren
r_if
c_cond
(paren
op_logical_neg
id|options
op_logical_or
op_logical_neg
op_star
id|options
)paren
r_return
l_int|0
suffix:semicolon
r_while
c_loop
(paren
(paren
id|this_opt
op_assign
id|strsep
c_func
(paren
op_amp
id|options
comma
l_string|&quot;,&quot;
)paren
)paren
op_ne
l_int|NULL
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
op_star
id|this_opt
)paren
r_continue
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;matroxfb_setup: option %s&bslash;n&quot;
comma
id|this_opt
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;dev:&quot;
comma
l_int|4
)paren
)paren
id|dev
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|4
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;depth:&quot;
comma
l_int|6
)paren
)paren
(brace
r_switch
c_cond
(paren
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|6
comma
l_int|NULL
comma
l_int|0
)paren
)paren
(brace
r_case
l_int|0
suffix:colon
id|depth
op_assign
id|RSText
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|4
suffix:colon
id|depth
op_assign
id|RS4bpp
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|8
suffix:colon
id|depth
op_assign
id|RS8bpp
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|15
suffix:colon
id|depth
op_assign
id|RS15bpp
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|16
suffix:colon
id|depth
op_assign
id|RS16bpp
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|24
suffix:colon
id|depth
op_assign
id|RS24bpp
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|32
suffix:colon
id|depth
op_assign
id|RS32bpp
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;matroxfb: unsupported color depth&bslash;n&quot;
)paren
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;xres:&quot;
comma
l_int|5
)paren
)paren
id|xres
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|5
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;yres:&quot;
comma
l_int|5
)paren
)paren
id|yres
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|5
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;vslen:&quot;
comma
l_int|6
)paren
)paren
id|vslen
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|6
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;hslen:&quot;
comma
l_int|6
)paren
)paren
id|hslen
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|6
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;left:&quot;
comma
l_int|5
)paren
)paren
id|left
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|5
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;right:&quot;
comma
l_int|6
)paren
)paren
id|right
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|6
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;upper:&quot;
comma
l_int|6
)paren
)paren
id|upper
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|6
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;lower:&quot;
comma
l_int|6
)paren
)paren
id|lower
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|6
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;pixclock:&quot;
comma
l_int|9
)paren
)paren
id|pixclock
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|9
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;sync:&quot;
comma
l_int|5
)paren
)paren
id|sync
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|5
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;vesa:&quot;
comma
l_int|5
)paren
)paren
id|vesa
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|5
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;maxclk:&quot;
comma
l_int|7
)paren
)paren
id|maxclk
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|7
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;fh:&quot;
comma
l_int|3
)paren
)paren
id|fh
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|3
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;fv:&quot;
comma
l_int|3
)paren
)paren
id|fv
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|3
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;mem:&quot;
comma
l_int|4
)paren
)paren
id|mem
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|4
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;mode:&quot;
comma
l_int|5
)paren
)paren
id|strlcpy
c_func
(paren
id|videomode
comma
id|this_opt
op_plus
l_int|5
comma
r_sizeof
(paren
id|videomode
)paren
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;outputs:&quot;
comma
l_int|8
)paren
)paren
id|strlcpy
c_func
(paren
id|outputs
comma
id|this_opt
op_plus
l_int|8
comma
r_sizeof
(paren
id|outputs
)paren
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;dfp:&quot;
comma
l_int|4
)paren
)paren
(brace
id|dfp_type
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|4
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
id|dfp
op_assign
l_int|1
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_PPC_PMAC
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;vmode:&quot;
comma
l_int|6
)paren
)paren
(brace
r_int
r_int
id|vmode
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|6
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|vmode
OG
l_int|0
op_logical_and
id|vmode
op_le
id|VMODE_MAX
)paren
id|default_vmode
op_assign
id|vmode
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;cmode:&quot;
comma
l_int|6
)paren
)paren
(brace
r_int
r_int
id|cmode
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|6
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|cmode
)paren
(brace
r_case
l_int|0
suffix:colon
r_case
l_int|8
suffix:colon
id|default_cmode
op_assign
id|CMODE_8
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|15
suffix:colon
r_case
l_int|16
suffix:colon
id|default_cmode
op_assign
id|CMODE_16
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|24
suffix:colon
r_case
l_int|32
suffix:colon
id|default_cmode
op_assign
id|CMODE_32
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
macro_line|#endif
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;disabled&quot;
)paren
)paren
multiline_comment|/* nodisabled does not exist */
id|disabled
op_assign
l_int|1
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;enabled&quot;
)paren
)paren
multiline_comment|/* noenabled does not exist */
id|disabled
op_assign
l_int|0
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;sgram&quot;
)paren
)paren
multiline_comment|/* nosgram == sdram */
id|sgram
op_assign
l_int|1
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;sdram&quot;
)paren
)paren
id|sgram
op_assign
l_int|0
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;memtype:&quot;
comma
l_int|8
)paren
)paren
id|memtype
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|8
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
(brace
r_int
id|value
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;no&quot;
comma
l_int|2
)paren
)paren
(brace
id|value
op_assign
l_int|0
suffix:semicolon
id|this_opt
op_add_assign
l_int|2
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;inverse&quot;
)paren
)paren
id|inverse
op_assign
id|value
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;accel&quot;
)paren
)paren
id|noaccel
op_assign
op_logical_neg
id|value
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;pan&quot;
)paren
)paren
id|nopan
op_assign
op_logical_neg
id|value
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;pciretry&quot;
)paren
)paren
id|no_pci_retry
op_assign
op_logical_neg
id|value
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;vga&quot;
)paren
)paren
id|novga
op_assign
op_logical_neg
id|value
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;bios&quot;
)paren
)paren
id|nobios
op_assign
op_logical_neg
id|value
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;init&quot;
)paren
)paren
id|noinit
op_assign
op_logical_neg
id|value
suffix:semicolon
macro_line|#ifdef CONFIG_MTRR
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;mtrr&quot;
)paren
)paren
id|mtrr
op_assign
id|value
suffix:semicolon
macro_line|#endif
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;inv24&quot;
)paren
)paren
id|inv24
op_assign
id|value
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;cross4MB&quot;
)paren
)paren
id|cross4MB
op_assign
id|value
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;grayscale&quot;
)paren
)paren
id|grayscale
op_assign
id|value
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;dfp&quot;
)paren
)paren
id|dfp
op_assign
id|value
suffix:semicolon
r_else
(brace
id|strlcpy
c_func
(paren
id|videomode
comma
id|this_opt
comma
r_sizeof
(paren
id|videomode
)paren
)paren
suffix:semicolon
)brace
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|initialized
r_static
r_int
id|__initdata
id|initialized
op_assign
l_int|0
suffix:semicolon
DECL|function|matroxfb_init
r_int
id|__init
id|matroxfb_init
c_func
(paren
r_void
)paren
(brace
r_char
op_star
id|option
op_assign
l_int|NULL
suffix:semicolon
id|DBG
c_func
(paren
id|__FUNCTION__
)paren
r_if
c_cond
(paren
id|fb_get_options
c_func
(paren
l_string|&quot;matroxfb&quot;
comma
op_amp
id|option
)paren
)paren
r_return
op_minus
id|ENODEV
suffix:semicolon
id|matroxfb_setup
c_func
(paren
id|option
)paren
suffix:semicolon
r_if
c_cond
(paren
id|disabled
)paren
r_return
op_minus
id|ENXIO
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|initialized
)paren
(brace
id|initialized
op_assign
l_int|1
suffix:semicolon
id|matrox_init
c_func
(paren
)paren
suffix:semicolon
)brace
id|hotplug
op_assign
l_int|1
suffix:semicolon
multiline_comment|/* never return failure, user can hotplug matrox later... */
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|matroxfb_init
id|module_init
c_func
(paren
id|matroxfb_init
)paren
suffix:semicolon
macro_line|#else
multiline_comment|/* *************************** init module code **************************** */
id|MODULE_AUTHOR
c_func
(paren
l_string|&quot;(c) 1998-2002 Petr Vandrovec &lt;vandrove@vc.cvut.cz&gt;&quot;
)paren
suffix:semicolon
id|MODULE_DESCRIPTION
c_func
(paren
l_string|&quot;Accelerated FBDev driver for Matrox Millennium/Mystique/G100/G200/G400/G450/G550&quot;
)paren
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|mem
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|mem
comma
l_string|&quot;Size of available memory in MB, KB or B (2,4,8,12,16MB, default=autodetect)&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|disabled
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|disabled
comma
l_string|&quot;Disabled (0 or 1=disabled) (default=0)&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|noaccel
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|noaccel
comma
l_string|&quot;Do not use accelerating engine (0 or 1=disabled) (default=0)&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|nopan
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|nopan
comma
l_string|&quot;Disable pan on startup (0 or 1=disabled) (default=0)&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|no_pci_retry
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|no_pci_retry
comma
l_string|&quot;PCI retries enabled (0 or 1=disabled) (default=0)&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|novga
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|novga
comma
l_string|&quot;VGA I/O (0x3C0-0x3DF) disabled (0 or 1=disabled) (default=0)&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|nobios
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|nobios
comma
l_string|&quot;Disables ROM BIOS (0 or 1=disabled) (default=do not change BIOS state)&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|noinit
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|noinit
comma
l_string|&quot;Disables W/SG/SD-RAM and bus interface initialization (0 or 1=do not initialize) (default=0)&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|memtype
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|memtype
comma
l_string|&quot;Memory type for G200/G400 (see Documentation/fb/matroxfb.txt for explanation) (default=3 for G200, 0 for G400)&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|mtrr
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|mtrr
comma
l_string|&quot;This speeds up video memory accesses (0=disabled or 1) (default=1)&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|sgram
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|sgram
comma
l_string|&quot;Indicates that G100/G200/G400 has SGRAM memory (0=SDRAM, 1=SGRAM) (default=0)&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|inv24
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|inv24
comma
l_string|&quot;Inverts clock polarity for 24bpp and loop frequency &gt; 100MHz (default=do not invert polarity)&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|inverse
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|inverse
comma
l_string|&quot;Inverse (0 or 1) (default=0)&quot;
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_FB_MATROX_MULTIHEAD
id|module_param
c_func
(paren
id|dev
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|dev
comma
l_string|&quot;Multihead support, attach to device ID (0..N) (default=all working)&quot;
)paren
suffix:semicolon
macro_line|#else
id|module_param
c_func
(paren
id|dev
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|dev
comma
l_string|&quot;Multihead support, attach to device ID (0..N) (default=first working)&quot;
)paren
suffix:semicolon
macro_line|#endif
id|module_param
c_func
(paren
id|vesa
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|vesa
comma
l_string|&quot;Startup videomode (0x000-0x1FF) (default=0x101)&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|xres
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|xres
comma
l_string|&quot;Horizontal resolution (px), overrides xres from vesa (default=vesa)&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|yres
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|yres
comma
l_string|&quot;Vertical resolution (scans), overrides yres from vesa (default=vesa)&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|upper
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|upper
comma
l_string|&quot;Upper blank space (scans), overrides upper from vesa (default=vesa)&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|lower
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|lower
comma
l_string|&quot;Lower blank space (scans), overrides lower from vesa (default=vesa)&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|vslen
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|vslen
comma
l_string|&quot;Vertical sync length (scans), overrides lower from vesa (default=vesa)&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|left
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|left
comma
l_string|&quot;Left blank space (px), overrides left from vesa (default=vesa)&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|right
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|right
comma
l_string|&quot;Right blank space (px), overrides right from vesa (default=vesa)&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|hslen
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|hslen
comma
l_string|&quot;Horizontal sync length (px), overrides hslen from vesa (default=vesa)&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|pixclock
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|pixclock
comma
l_string|&quot;Pixelclock (ns), overrides pixclock from vesa (default=vesa)&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|sync
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|sync
comma
l_string|&quot;Sync polarity, overrides sync from vesa (default=vesa)&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|depth
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|depth
comma
l_string|&quot;Color depth (0=text,8,15,16,24,32) (default=vesa)&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|maxclk
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|maxclk
comma
l_string|&quot;Startup maximal clock, 0-999MHz, 1000-999999kHz, 1000000-INF Hz&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|fh
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|fh
comma
l_string|&quot;Startup horizontal frequency, 0-999kHz, 1000-INF Hz&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|fv
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|fv
comma
l_string|&quot;Startup vertical frequency, 0-INF Hz&bslash;n&quot;
l_string|&quot;You should specify &bslash;&quot;fv:max_monitor_vsync,fh:max_monitor_hsync,maxclk:max_monitor_dotclock&bslash;&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|grayscale
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|grayscale
comma
l_string|&quot;Sets display into grayscale. Works perfectly with paletized videomode (4, 8bpp), some limitations apply to 16, 24 and 32bpp videomodes (default=nograyscale)&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|cross4MB
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|cross4MB
comma
l_string|&quot;Specifies that 4MB boundary can be in middle of line. (default=autodetected)&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|dfp
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|dfp
comma
l_string|&quot;Specifies whether to use digital flat panel interface of G200/G400 (0 or 1) (default=0)&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|dfp_type
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|dfp_type
comma
l_string|&quot;Specifies DFP interface type (0 to 255) (default=read from hardware)&quot;
)paren
suffix:semicolon
id|module_param_string
c_func
(paren
id|outputs
comma
id|outputs
comma
r_sizeof
(paren
id|outputs
)paren
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|outputs
comma
l_string|&quot;Specifies which CRTC is mapped to which output (string of up to three letters, consisting of 0 (disabled), 1 (CRTC1), 2 (CRTC2)) (default=111 for Gx50, 101 for G200/G400 with DFP, and 100 for all other devices)&quot;
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_PPC_PMAC
id|module_param
c_func
(paren
id|vmode
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|vmode
comma
l_string|&quot;Specify the vmode mode number that should be used (640x480 default)&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|cmode
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|cmode
comma
l_string|&quot;Specify the video depth that should be used (8bit default)&quot;
)paren
suffix:semicolon
macro_line|#endif
DECL|function|init_module
r_int
id|__init
(def_block
id|init_module
c_func
(paren
r_void
)paren
(brace
id|DBG
c_func
(paren
id|__FUNCTION__
)paren
r_if
c_cond
(paren
id|disabled
)paren
r_return
op_minus
id|ENXIO
suffix:semicolon
r_if
c_cond
(paren
id|depth
op_eq
l_int|0
)paren
id|depth
op_assign
id|RSText
suffix:semicolon
r_else
r_if
c_cond
(paren
id|depth
op_eq
l_int|4
)paren
id|depth
op_assign
id|RS4bpp
suffix:semicolon
r_else
r_if
c_cond
(paren
id|depth
op_eq
l_int|8
)paren
id|depth
op_assign
id|RS8bpp
suffix:semicolon
r_else
r_if
c_cond
(paren
id|depth
op_eq
l_int|15
)paren
id|depth
op_assign
id|RS15bpp
suffix:semicolon
r_else
r_if
c_cond
(paren
id|depth
op_eq
l_int|16
)paren
id|depth
op_assign
id|RS16bpp
suffix:semicolon
r_else
r_if
c_cond
(paren
id|depth
op_eq
l_int|24
)paren
id|depth
op_assign
id|RS24bpp
suffix:semicolon
r_else
r_if
c_cond
(paren
id|depth
op_eq
l_int|32
)paren
id|depth
op_assign
id|RS32bpp
suffix:semicolon
r_else
r_if
c_cond
(paren
id|depth
op_ne
op_minus
l_int|1
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;matroxfb: depth %d is not supported, using default&bslash;n&quot;
comma
id|depth
)paren
suffix:semicolon
id|depth
op_assign
op_minus
l_int|1
suffix:semicolon
)brace
id|matrox_init
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/* never return failure; user can hotplug matrox later... */
r_return
l_int|0
suffix:semicolon
)brace
)def_block
macro_line|#endif&t;/* MODULE */
DECL|variable|matrox_done
id|module_exit
c_func
(paren
id|matrox_done
)paren
suffix:semicolon
DECL|variable|matroxfb_register_driver
id|EXPORT_SYMBOL
c_func
(paren
id|matroxfb_register_driver
)paren
suffix:semicolon
DECL|variable|matroxfb_unregister_driver
id|EXPORT_SYMBOL
c_func
(paren
id|matroxfb_unregister_driver
)paren
suffix:semicolon
DECL|variable|matroxfb_wait_for_sync
id|EXPORT_SYMBOL
c_func
(paren
id|matroxfb_wait_for_sync
)paren
suffix:semicolon
DECL|variable|matroxfb_enable_irq
id|EXPORT_SYMBOL
c_func
(paren
id|matroxfb_enable_irq
)paren
suffix:semicolon
multiline_comment|/*&n; * Overrides for Emacs so that we follow Linus&squot;s tabbing style.&n; * ---------------------------------------------------------------------------&n; * Local variables:&n; * c-basic-offset: 8&n; * End:&n; */
eof
