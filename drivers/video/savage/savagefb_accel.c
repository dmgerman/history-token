multiline_comment|/*-*- linux-c -*-&n; *  linux/drivers/video/savage/savage_accel.c -- Hardware Acceleration&n; *&n; *      Copyright (C) 2004 Antonino Daplas&lt;adaplas@pol.net&gt;&n; *      All Rights Reserved&n; *&n; *  This file is subject to the terms and conditions of the GNU General Public&n; *  License. See the file COPYING in the main directory of this archive for&n; *  more details.&n; */
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/string.h&gt;
macro_line|#include &lt;linux/fb.h&gt;
macro_line|#include &quot;savagefb.h&quot;
DECL|variable|savagefb_rop
r_static
id|u32
id|savagefb_rop
(braket
)braket
op_assign
(brace
l_int|0xCC
comma
multiline_comment|/* ROP_COPY */
l_int|0x5A
multiline_comment|/* ROP_XOR  */
)brace
suffix:semicolon
DECL|function|savagefb_sync
r_int
id|savagefb_sync
c_func
(paren
r_struct
id|fb_info
op_star
id|info
)paren
(brace
r_struct
id|savagefb_par
op_star
id|par
op_assign
(paren
r_struct
id|savagefb_par
op_star
)paren
id|info-&gt;par
suffix:semicolon
id|par
op_member_access_from_pointer
id|SavageWaitIdle
c_func
(paren
id|par
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|savagefb_sync
id|EXPORT_SYMBOL
c_func
(paren
id|savagefb_sync
)paren
suffix:semicolon
DECL|function|savagefb_copyarea
r_void
id|savagefb_copyarea
c_func
(paren
r_struct
id|fb_info
op_star
id|info
comma
r_const
r_struct
id|fb_copyarea
op_star
id|region
)paren
(brace
r_struct
id|savagefb_par
op_star
id|par
op_assign
(paren
r_struct
id|savagefb_par
op_star
)paren
id|info-&gt;par
suffix:semicolon
r_int
id|sx
op_assign
id|region-&gt;sx
comma
id|dx
op_assign
id|region-&gt;dx
suffix:semicolon
r_int
id|sy
op_assign
id|region-&gt;sy
comma
id|dy
op_assign
id|region-&gt;dy
suffix:semicolon
r_int
id|cmd
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|region-&gt;width
op_logical_or
op_logical_neg
id|region-&gt;height
)paren
r_return
suffix:semicolon
id|par-&gt;bci_ptr
op_assign
l_int|0
suffix:semicolon
id|cmd
op_assign
id|BCI_CMD_RECT
op_or
id|BCI_CMD_DEST_GBD
op_or
id|BCI_CMD_SRC_GBD
suffix:semicolon
id|BCI_CMD_SET_ROP
c_func
(paren
id|cmd
comma
id|savagefb_rop
(braket
l_int|0
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dx
op_le
id|sx
)paren
(brace
id|cmd
op_or_assign
id|BCI_CMD_RECT_XP
suffix:semicolon
)brace
r_else
(brace
id|sx
op_add_assign
id|region-&gt;width
op_minus
l_int|1
suffix:semicolon
id|dx
op_add_assign
id|region-&gt;width
op_minus
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|dy
op_le
id|sy
)paren
(brace
id|cmd
op_or_assign
id|BCI_CMD_RECT_YP
suffix:semicolon
)brace
r_else
(brace
id|sy
op_add_assign
id|region-&gt;height
op_minus
l_int|1
suffix:semicolon
id|dy
op_add_assign
id|region-&gt;height
op_minus
l_int|1
suffix:semicolon
)brace
id|par
op_member_access_from_pointer
id|SavageWaitFifo
c_func
(paren
id|par
comma
l_int|4
)paren
suffix:semicolon
id|BCI_SEND
c_func
(paren
id|cmd
)paren
suffix:semicolon
id|BCI_SEND
c_func
(paren
id|BCI_X_Y
c_func
(paren
id|sx
comma
id|sy
)paren
)paren
suffix:semicolon
id|BCI_SEND
c_func
(paren
id|BCI_X_Y
c_func
(paren
id|dx
comma
id|dy
)paren
)paren
suffix:semicolon
id|BCI_SEND
c_func
(paren
id|BCI_W_H
c_func
(paren
id|region-&gt;width
comma
id|region-&gt;height
)paren
)paren
suffix:semicolon
)brace
DECL|variable|savagefb_copyarea
id|EXPORT_SYMBOL
c_func
(paren
id|savagefb_copyarea
)paren
suffix:semicolon
DECL|function|savagefb_fillrect
r_void
id|savagefb_fillrect
c_func
(paren
r_struct
id|fb_info
op_star
id|info
comma
r_const
r_struct
id|fb_fillrect
op_star
id|rect
)paren
(brace
r_struct
id|savagefb_par
op_star
id|par
op_assign
(paren
r_struct
id|savagefb_par
op_star
)paren
id|info-&gt;par
suffix:semicolon
r_int
id|cmd
comma
id|color
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|rect-&gt;width
op_logical_or
op_logical_neg
id|rect-&gt;height
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|info-&gt;fix.visual
op_eq
id|FB_VISUAL_PSEUDOCOLOR
)paren
id|color
op_assign
id|rect-&gt;color
suffix:semicolon
r_else
id|color
op_assign
(paren
(paren
id|u32
op_star
)paren
id|info-&gt;pseudo_palette
)paren
(braket
id|rect-&gt;color
)braket
suffix:semicolon
id|cmd
op_assign
id|BCI_CMD_RECT
op_or
id|BCI_CMD_RECT_XP
op_or
id|BCI_CMD_RECT_YP
op_or
id|BCI_CMD_DEST_GBD
op_or
id|BCI_CMD_SRC_SOLID
op_or
id|BCI_CMD_SEND_COLOR
suffix:semicolon
id|par-&gt;bci_ptr
op_assign
l_int|0
suffix:semicolon
id|BCI_CMD_SET_ROP
c_func
(paren
id|cmd
comma
id|savagefb_rop
(braket
id|rect-&gt;rop
)braket
)paren
suffix:semicolon
id|par
op_member_access_from_pointer
id|SavageWaitFifo
c_func
(paren
id|par
comma
l_int|4
)paren
suffix:semicolon
id|BCI_SEND
c_func
(paren
id|cmd
)paren
suffix:semicolon
id|BCI_SEND
c_func
(paren
id|color
)paren
suffix:semicolon
id|BCI_SEND
c_func
(paren
id|BCI_X_Y
c_func
(paren
id|rect-&gt;dx
comma
id|rect-&gt;dy
)paren
)paren
suffix:semicolon
id|BCI_SEND
c_func
(paren
id|BCI_W_H
c_func
(paren
id|rect-&gt;width
comma
id|rect-&gt;height
)paren
)paren
suffix:semicolon
)brace
DECL|variable|savagefb_fillrect
id|EXPORT_SYMBOL
c_func
(paren
id|savagefb_fillrect
)paren
suffix:semicolon
DECL|function|savagefb_imageblit
r_void
id|savagefb_imageblit
c_func
(paren
r_struct
id|fb_info
op_star
id|info
comma
r_const
r_struct
id|fb_image
op_star
id|image
)paren
(brace
r_struct
id|savagefb_par
op_star
id|par
op_assign
(paren
r_struct
id|savagefb_par
op_star
)paren
id|info-&gt;par
suffix:semicolon
r_int
id|fg
comma
id|bg
comma
id|size
comma
id|i
comma
id|width
suffix:semicolon
r_int
id|cmd
suffix:semicolon
id|u32
op_star
id|src
op_assign
(paren
id|u32
op_star
)paren
id|image-&gt;data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|image-&gt;width
op_logical_or
op_logical_neg
id|image-&gt;height
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|image-&gt;depth
op_ne
l_int|1
)paren
(brace
id|cfb_imageblit
c_func
(paren
id|info
comma
id|image
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|info-&gt;fix.visual
op_eq
id|FB_VISUAL_PSEUDOCOLOR
)paren
(brace
id|fg
op_assign
id|image-&gt;fg_color
suffix:semicolon
id|bg
op_assign
id|image-&gt;bg_color
suffix:semicolon
)brace
r_else
(brace
id|fg
op_assign
(paren
(paren
id|u32
op_star
)paren
id|info-&gt;pseudo_palette
)paren
(braket
id|image-&gt;fg_color
)braket
suffix:semicolon
id|bg
op_assign
(paren
(paren
id|u32
op_star
)paren
id|info-&gt;pseudo_palette
)paren
(braket
id|image-&gt;bg_color
)braket
suffix:semicolon
)brace
id|cmd
op_assign
id|BCI_CMD_RECT
op_or
id|BCI_CMD_RECT_XP
op_or
id|BCI_CMD_RECT_YP
op_or
id|BCI_CMD_CLIP_LR
op_or
id|BCI_CMD_DEST_GBD
op_or
id|BCI_CMD_SRC_MONO
op_or
id|BCI_CMD_SEND_COLOR
suffix:semicolon
id|par-&gt;bci_ptr
op_assign
l_int|0
suffix:semicolon
id|BCI_CMD_SET_ROP
c_func
(paren
id|cmd
comma
id|savagefb_rop
(braket
l_int|0
)braket
)paren
suffix:semicolon
id|width
op_assign
(paren
id|image-&gt;width
op_plus
l_int|31
)paren
op_amp
op_complement
l_int|31
suffix:semicolon
id|size
op_assign
(paren
id|width
op_star
id|image-&gt;height
)paren
op_div
l_int|8
suffix:semicolon
id|size
op_rshift_assign
l_int|2
suffix:semicolon
id|par
op_member_access_from_pointer
id|SavageWaitFifo
c_func
(paren
id|par
comma
id|size
op_plus
l_int|5
)paren
suffix:semicolon
id|BCI_SEND
c_func
(paren
id|cmd
)paren
suffix:semicolon
id|BCI_SEND
c_func
(paren
id|BCI_CLIP_LR
c_func
(paren
id|image-&gt;dx
comma
id|image-&gt;dx
op_plus
id|image-&gt;width
op_minus
l_int|1
)paren
)paren
suffix:semicolon
id|BCI_SEND
c_func
(paren
id|fg
)paren
suffix:semicolon
id|BCI_SEND
c_func
(paren
id|bg
)paren
suffix:semicolon
id|BCI_SEND
c_func
(paren
id|BCI_X_Y
c_func
(paren
id|image-&gt;dx
comma
id|image-&gt;dy
)paren
)paren
suffix:semicolon
id|BCI_SEND
c_func
(paren
id|BCI_W_H
c_func
(paren
id|width
comma
id|image-&gt;height
)paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|size
suffix:semicolon
id|i
op_increment
)paren
id|BCI_SEND
c_func
(paren
id|src
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
DECL|variable|savagefb_imageblit
id|EXPORT_SYMBOL
c_func
(paren
id|savagefb_imageblit
)paren
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
eof
