multiline_comment|/*&n; * linux/drivers/video/fbmon.c&n; *&n; * Copyright (C) 2002 James Simmons &lt;jsimmons@users.sf.net&gt;&n; *&n; * Credits:&n; * &n; * The EDID Parser is a conglomeration from the following sources:&n; *&n; *   1. SciTech SNAP Graphics Architecture&n; *      Copyright (C) 1991-2002 SciTech Software, Inc. All rights reserved.&n; *&n; *   2. XFree86 4.3.0, interpret_edid.c&n; *      Copyright 1998 by Egbert Eich &lt;Egbert.Eich@Physik.TU-Darmstadt.DE&gt;&n; * &n; *   3. John Fremlin &lt;vii@users.sourceforge.net&gt; and &n; *      Ani Joshi &lt;ajoshi@unixbox.com&gt;&n; *  &n; * Generalized Timing Formula is derived from:&n; *&n; *      GTF Spreadsheet by Andy Morrish (1/5/97) &n; *      available at http://www.vesa.org&n; *&n; * This file is subject to the terms and conditions of the GNU General Public&n; * License.  See the file COPYING in the main directory of this archive&n; * for more details.&n; *&n; */
macro_line|#include &lt;linux/tty.h&gt;
macro_line|#include &lt;linux/fb.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#ifdef CONFIG_PPC_OF
macro_line|#include &lt;linux/pci.h&gt;
macro_line|#include &lt;asm/prom.h&gt;
macro_line|#include &lt;asm/pci-bridge.h&gt;
macro_line|#endif
macro_line|#include &lt;video/edid.h&gt;
macro_line|#include &quot;edid.h&quot;
multiline_comment|/* &n; * EDID parser&n; */
DECL|macro|DEBUG
macro_line|#undef DEBUG  /* define this for verbose EDID parsing output */
macro_line|#ifdef DEBUG
DECL|macro|DPRINTK
mdefine_line|#define DPRINTK(fmt, args...) printk(fmt,## args)
macro_line|#else
DECL|macro|DPRINTK
mdefine_line|#define DPRINTK(fmt, args...)
macro_line|#endif
DECL|macro|FBMON_FIX_HEADER
mdefine_line|#define FBMON_FIX_HEADER 1
macro_line|#ifdef CONFIG_FB_MODE_HELPERS
DECL|struct|broken_edid
r_struct
id|broken_edid
(brace
DECL|member|manufacturer
id|u8
id|manufacturer
(braket
l_int|4
)braket
suffix:semicolon
DECL|member|model
id|u32
id|model
suffix:semicolon
DECL|member|fix
id|u32
id|fix
suffix:semicolon
)brace
suffix:semicolon
DECL|variable|brokendb
r_static
r_struct
id|broken_edid
id|brokendb
(braket
)braket
op_assign
(brace
multiline_comment|/* DEC FR-PCXAV-YZ */
(brace
dot
id|manufacturer
op_assign
l_string|&quot;DEC&quot;
comma
dot
id|model
op_assign
l_int|0x073a
comma
dot
id|fix
op_assign
id|FBMON_FIX_HEADER
comma
)brace
comma
)brace
suffix:semicolon
DECL|variable|edid_v1_header
r_const
r_int
r_char
id|edid_v1_header
(braket
)braket
op_assign
(brace
l_int|0x00
comma
l_int|0xff
comma
l_int|0xff
comma
l_int|0xff
comma
l_int|0xff
comma
l_int|0xff
comma
l_int|0xff
comma
l_int|0x00
)brace
suffix:semicolon
DECL|variable|edid_v1_descriptor_flag
r_const
r_int
r_char
id|edid_v1_descriptor_flag
(braket
)braket
op_assign
(brace
l_int|0x00
comma
l_int|0x00
)brace
suffix:semicolon
DECL|function|copy_string
r_static
r_void
id|copy_string
c_func
(paren
r_int
r_char
op_star
id|c
comma
r_int
r_char
op_star
id|s
)paren
(brace
r_int
id|i
suffix:semicolon
id|c
op_assign
id|c
op_plus
l_int|5
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
(paren
id|i
OL
l_int|13
op_logical_and
op_star
id|c
op_ne
l_int|0x0A
)paren
suffix:semicolon
id|i
op_increment
)paren
op_star
(paren
id|s
op_increment
)paren
op_assign
op_star
(paren
id|c
op_increment
)paren
suffix:semicolon
op_star
id|s
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
id|i
op_decrement
op_logical_and
(paren
op_star
op_decrement
id|s
op_eq
l_int|0x20
)paren
)paren
op_star
id|s
op_assign
l_int|0
suffix:semicolon
)brace
DECL|function|fix_broken_edid
r_static
r_void
id|fix_broken_edid
c_func
(paren
r_int
r_char
op_star
id|edid
)paren
(brace
r_int
r_char
op_star
id|block
op_assign
id|edid
op_plus
id|ID_MANUFACTURER_NAME
comma
id|manufacturer
(braket
l_int|4
)braket
suffix:semicolon
id|u32
id|model
comma
id|i
suffix:semicolon
id|manufacturer
(braket
l_int|0
)braket
op_assign
(paren
(paren
id|block
(braket
l_int|0
)braket
op_amp
l_int|0x7c
)paren
op_rshift
l_int|2
)paren
op_plus
l_char|&squot;@&squot;
suffix:semicolon
id|manufacturer
(braket
l_int|1
)braket
op_assign
(paren
(paren
id|block
(braket
l_int|0
)braket
op_amp
l_int|0x03
)paren
op_lshift
l_int|3
)paren
op_plus
(paren
(paren
id|block
(braket
l_int|1
)braket
op_amp
l_int|0xe0
)paren
op_rshift
l_int|5
)paren
op_plus
l_char|&squot;@&squot;
suffix:semicolon
id|manufacturer
(braket
l_int|2
)braket
op_assign
(paren
id|block
(braket
l_int|1
)braket
op_amp
l_int|0x1f
)paren
op_plus
l_char|&squot;@&squot;
suffix:semicolon
id|manufacturer
(braket
l_int|3
)braket
op_assign
l_int|0
suffix:semicolon
id|model
op_assign
id|block
(braket
l_int|2
)braket
op_plus
(paren
id|block
(braket
l_int|3
)braket
op_lshift
l_int|8
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|ARRAY_SIZE
c_func
(paren
id|brokendb
)paren
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|manufacturer
comma
id|brokendb
(braket
id|i
)braket
dot
id|manufacturer
comma
l_int|4
)paren
op_logical_and
id|brokendb
(braket
id|i
)braket
dot
id|model
op_eq
id|model
)paren
(brace
r_switch
c_cond
(paren
id|brokendb
(braket
id|i
)braket
dot
id|fix
)paren
(brace
r_case
id|FBMON_FIX_HEADER
suffix:colon
id|printk
c_func
(paren
l_string|&quot;fbmon: The EDID header of &quot;
l_string|&quot;Manufacturer: %s Model: 0x%x is &quot;
l_string|&quot;known to be broken,&bslash;n&quot;
l_string|&quot;fbmon: trying a header &quot;
l_string|&quot;reconstruct&bslash;n&quot;
comma
id|manufacturer
comma
id|model
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|edid
comma
id|edid_v1_header
comma
l_int|8
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
)brace
)brace
DECL|function|edid_checksum
r_static
r_int
id|edid_checksum
c_func
(paren
r_int
r_char
op_star
id|edid
)paren
(brace
r_int
r_char
id|i
comma
id|csum
op_assign
l_int|0
comma
id|all_null
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|EDID_LENGTH
suffix:semicolon
id|i
op_increment
)paren
(brace
id|csum
op_add_assign
id|edid
(braket
id|i
)braket
suffix:semicolon
id|all_null
op_or_assign
id|edid
(braket
id|i
)braket
suffix:semicolon
)brace
r_if
c_cond
(paren
id|csum
op_eq
l_int|0x00
op_logical_and
id|all_null
)paren
(brace
multiline_comment|/* checksum passed, everything&squot;s good */
r_return
l_int|1
suffix:semicolon
)brace
id|fix_broken_edid
c_func
(paren
id|edid
)paren
suffix:semicolon
id|csum
op_assign
id|all_null
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|EDID_LENGTH
suffix:semicolon
id|i
op_increment
)paren
(brace
id|csum
op_add_assign
id|edid
(braket
id|i
)braket
suffix:semicolon
id|all_null
op_or_assign
id|edid
(braket
id|i
)braket
suffix:semicolon
)brace
r_if
c_cond
(paren
id|csum
op_ne
l_int|0x00
op_logical_or
op_logical_neg
id|all_null
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;EDID checksum failed, aborting&bslash;n&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|edid_check_header
r_static
r_int
id|edid_check_header
c_func
(paren
r_int
r_char
op_star
id|edid
)paren
(brace
r_int
id|i
comma
id|fix
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|8
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|edid
(braket
id|i
)braket
op_ne
id|edid_v1_header
(braket
id|i
)braket
)paren
id|fix
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|fix
)paren
r_return
l_int|1
suffix:semicolon
id|fix_broken_edid
c_func
(paren
id|edid
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|8
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|edid
(braket
id|i
)braket
op_ne
id|edid_v1_header
(braket
id|i
)braket
)paren
r_return
l_int|0
suffix:semicolon
)brace
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|parse_vendor_block
r_static
r_void
id|parse_vendor_block
c_func
(paren
r_int
r_char
op_star
id|block
comma
r_struct
id|fb_monspecs
op_star
id|specs
)paren
(brace
id|specs-&gt;manufacturer
(braket
l_int|0
)braket
op_assign
(paren
(paren
id|block
(braket
l_int|0
)braket
op_amp
l_int|0x7c
)paren
op_rshift
l_int|2
)paren
op_plus
l_char|&squot;@&squot;
suffix:semicolon
id|specs-&gt;manufacturer
(braket
l_int|1
)braket
op_assign
(paren
(paren
id|block
(braket
l_int|0
)braket
op_amp
l_int|0x03
)paren
op_lshift
l_int|3
)paren
op_plus
(paren
(paren
id|block
(braket
l_int|1
)braket
op_amp
l_int|0xe0
)paren
op_rshift
l_int|5
)paren
op_plus
l_char|&squot;@&squot;
suffix:semicolon
id|specs-&gt;manufacturer
(braket
l_int|2
)braket
op_assign
(paren
id|block
(braket
l_int|1
)braket
op_amp
l_int|0x1f
)paren
op_plus
l_char|&squot;@&squot;
suffix:semicolon
id|specs-&gt;manufacturer
(braket
l_int|3
)braket
op_assign
l_int|0
suffix:semicolon
id|specs-&gt;model
op_assign
id|block
(braket
l_int|2
)braket
op_plus
(paren
id|block
(braket
l_int|3
)braket
op_lshift
l_int|8
)paren
suffix:semicolon
id|specs-&gt;serial
op_assign
id|block
(braket
l_int|4
)braket
op_plus
(paren
id|block
(braket
l_int|5
)braket
op_lshift
l_int|8
)paren
op_plus
(paren
id|block
(braket
l_int|6
)braket
op_lshift
l_int|16
)paren
op_plus
(paren
id|block
(braket
l_int|7
)braket
op_lshift
l_int|24
)paren
suffix:semicolon
id|specs-&gt;year
op_assign
id|block
(braket
l_int|9
)braket
op_plus
l_int|1990
suffix:semicolon
id|specs-&gt;week
op_assign
id|block
(braket
l_int|8
)braket
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;   Manufacturer: %s&bslash;n&quot;
comma
id|specs-&gt;manufacturer
)paren
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;   Model: %x&bslash;n&quot;
comma
id|specs-&gt;model
)paren
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;   Serial#: %u&bslash;n&quot;
comma
id|specs-&gt;serial
)paren
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;   Year: %u Week %u&bslash;n&quot;
comma
id|specs-&gt;year
comma
id|specs-&gt;week
)paren
suffix:semicolon
)brace
DECL|function|get_dpms_capabilities
r_static
r_void
id|get_dpms_capabilities
c_func
(paren
r_int
r_char
id|flags
comma
r_struct
id|fb_monspecs
op_star
id|specs
)paren
(brace
id|specs-&gt;dpms
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|flags
op_amp
id|DPMS_ACTIVE_OFF
)paren
id|specs-&gt;dpms
op_or_assign
id|FB_DPMS_ACTIVE_OFF
suffix:semicolon
r_if
c_cond
(paren
id|flags
op_amp
id|DPMS_SUSPEND
)paren
id|specs-&gt;dpms
op_or_assign
id|FB_DPMS_SUSPEND
suffix:semicolon
r_if
c_cond
(paren
id|flags
op_amp
id|DPMS_STANDBY
)paren
id|specs-&gt;dpms
op_or_assign
id|FB_DPMS_STANDBY
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;      DPMS: Active %s, Suspend %s, Standby %s&bslash;n&quot;
comma
(paren
id|flags
op_amp
id|DPMS_ACTIVE_OFF
)paren
ques
c_cond
l_string|&quot;yes&quot;
suffix:colon
l_string|&quot;no&quot;
comma
(paren
id|flags
op_amp
id|DPMS_SUSPEND
)paren
ques
c_cond
l_string|&quot;yes&quot;
suffix:colon
l_string|&quot;no&quot;
comma
(paren
id|flags
op_amp
id|DPMS_STANDBY
)paren
ques
c_cond
l_string|&quot;yes&quot;
suffix:colon
l_string|&quot;no&quot;
)paren
suffix:semicolon
)brace
DECL|function|get_chroma
r_static
r_void
id|get_chroma
c_func
(paren
r_int
r_char
op_star
id|block
comma
r_struct
id|fb_monspecs
op_star
id|specs
)paren
(brace
r_int
id|tmp
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;      Chroma&bslash;n&quot;
)paren
suffix:semicolon
multiline_comment|/* Chromaticity data */
id|tmp
op_assign
(paren
(paren
id|block
(braket
l_int|5
)braket
op_amp
(paren
l_int|3
op_lshift
l_int|6
)paren
)paren
op_rshift
l_int|6
)paren
op_or
(paren
id|block
(braket
l_int|0x7
)braket
op_lshift
l_int|2
)paren
suffix:semicolon
id|tmp
op_mul_assign
l_int|1000
suffix:semicolon
id|tmp
op_add_assign
l_int|512
suffix:semicolon
id|specs-&gt;chroma.redx
op_assign
id|tmp
op_div
l_int|1024
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;         RedX:     0.%03d &quot;
comma
id|specs-&gt;chroma.redx
)paren
suffix:semicolon
id|tmp
op_assign
(paren
(paren
id|block
(braket
l_int|5
)braket
op_amp
(paren
l_int|3
op_lshift
l_int|4
)paren
)paren
op_rshift
l_int|4
)paren
op_or
(paren
id|block
(braket
l_int|0x8
)braket
op_lshift
l_int|2
)paren
suffix:semicolon
id|tmp
op_mul_assign
l_int|1000
suffix:semicolon
id|tmp
op_add_assign
l_int|512
suffix:semicolon
id|specs-&gt;chroma.redy
op_assign
id|tmp
op_div
l_int|1024
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;RedY:     0.%03d&bslash;n&quot;
comma
id|specs-&gt;chroma.redy
)paren
suffix:semicolon
id|tmp
op_assign
(paren
(paren
id|block
(braket
l_int|5
)braket
op_amp
(paren
l_int|3
op_lshift
l_int|2
)paren
)paren
op_rshift
l_int|2
)paren
op_or
(paren
id|block
(braket
l_int|0x9
)braket
op_lshift
l_int|2
)paren
suffix:semicolon
id|tmp
op_mul_assign
l_int|1000
suffix:semicolon
id|tmp
op_add_assign
l_int|512
suffix:semicolon
id|specs-&gt;chroma.greenx
op_assign
id|tmp
op_div
l_int|1024
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;         GreenX:   0.%03d &quot;
comma
id|specs-&gt;chroma.greenx
)paren
suffix:semicolon
id|tmp
op_assign
(paren
id|block
(braket
l_int|5
)braket
op_amp
l_int|3
)paren
op_or
(paren
id|block
(braket
l_int|0xa
)braket
op_lshift
l_int|2
)paren
suffix:semicolon
id|tmp
op_mul_assign
l_int|1000
suffix:semicolon
id|tmp
op_add_assign
l_int|512
suffix:semicolon
id|specs-&gt;chroma.greeny
op_assign
id|tmp
op_div
l_int|1024
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;GreenY:   0.%03d&bslash;n&quot;
comma
id|specs-&gt;chroma.greeny
)paren
suffix:semicolon
id|tmp
op_assign
(paren
(paren
id|block
(braket
l_int|6
)braket
op_amp
(paren
l_int|3
op_lshift
l_int|6
)paren
)paren
op_rshift
l_int|6
)paren
op_or
(paren
id|block
(braket
l_int|0xb
)braket
op_lshift
l_int|2
)paren
suffix:semicolon
id|tmp
op_mul_assign
l_int|1000
suffix:semicolon
id|tmp
op_add_assign
l_int|512
suffix:semicolon
id|specs-&gt;chroma.bluex
op_assign
id|tmp
op_div
l_int|1024
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;         BlueX:    0.%03d &quot;
comma
id|specs-&gt;chroma.bluex
)paren
suffix:semicolon
id|tmp
op_assign
(paren
(paren
id|block
(braket
l_int|6
)braket
op_amp
(paren
l_int|3
op_lshift
l_int|4
)paren
)paren
op_rshift
l_int|4
)paren
op_or
(paren
id|block
(braket
l_int|0xc
)braket
op_lshift
l_int|2
)paren
suffix:semicolon
id|tmp
op_mul_assign
l_int|1000
suffix:semicolon
id|tmp
op_add_assign
l_int|512
suffix:semicolon
id|specs-&gt;chroma.bluey
op_assign
id|tmp
op_div
l_int|1024
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;BlueY:    0.%03d&bslash;n&quot;
comma
id|specs-&gt;chroma.bluey
)paren
suffix:semicolon
id|tmp
op_assign
(paren
(paren
id|block
(braket
l_int|6
)braket
op_amp
(paren
l_int|3
op_lshift
l_int|2
)paren
)paren
op_rshift
l_int|2
)paren
op_or
(paren
id|block
(braket
l_int|0xd
)braket
op_lshift
l_int|2
)paren
suffix:semicolon
id|tmp
op_mul_assign
l_int|1000
suffix:semicolon
id|tmp
op_add_assign
l_int|512
suffix:semicolon
id|specs-&gt;chroma.whitex
op_assign
id|tmp
op_div
l_int|1024
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;         WhiteX:   0.%03d &quot;
comma
id|specs-&gt;chroma.whitex
)paren
suffix:semicolon
id|tmp
op_assign
(paren
id|block
(braket
l_int|6
)braket
op_amp
l_int|3
)paren
op_or
(paren
id|block
(braket
l_int|0xe
)braket
op_lshift
l_int|2
)paren
suffix:semicolon
id|tmp
op_mul_assign
l_int|1000
suffix:semicolon
id|tmp
op_add_assign
l_int|512
suffix:semicolon
id|specs-&gt;chroma.whitey
op_assign
id|tmp
op_div
l_int|1024
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;WhiteY:   0.%03d&bslash;n&quot;
comma
id|specs-&gt;chroma.whitey
)paren
suffix:semicolon
)brace
DECL|function|edid_is_serial_block
r_static
r_int
id|edid_is_serial_block
c_func
(paren
r_int
r_char
op_star
id|block
)paren
(brace
r_if
c_cond
(paren
(paren
id|block
(braket
l_int|0
)braket
op_eq
l_int|0x00
)paren
op_logical_and
(paren
id|block
(braket
l_int|1
)braket
op_eq
l_int|0x00
)paren
op_logical_and
(paren
id|block
(braket
l_int|2
)braket
op_eq
l_int|0x00
)paren
op_logical_and
(paren
id|block
(braket
l_int|3
)braket
op_eq
l_int|0xff
)paren
op_logical_and
(paren
id|block
(braket
l_int|4
)braket
op_eq
l_int|0x00
)paren
)paren
r_return
l_int|1
suffix:semicolon
r_else
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|edid_is_ascii_block
r_static
r_int
id|edid_is_ascii_block
c_func
(paren
r_int
r_char
op_star
id|block
)paren
(brace
r_if
c_cond
(paren
(paren
id|block
(braket
l_int|0
)braket
op_eq
l_int|0x00
)paren
op_logical_and
(paren
id|block
(braket
l_int|1
)braket
op_eq
l_int|0x00
)paren
op_logical_and
(paren
id|block
(braket
l_int|2
)braket
op_eq
l_int|0x00
)paren
op_logical_and
(paren
id|block
(braket
l_int|3
)braket
op_eq
l_int|0xfe
)paren
op_logical_and
(paren
id|block
(braket
l_int|4
)braket
op_eq
l_int|0x00
)paren
)paren
r_return
l_int|1
suffix:semicolon
r_else
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|edid_is_limits_block
r_static
r_int
id|edid_is_limits_block
c_func
(paren
r_int
r_char
op_star
id|block
)paren
(brace
r_if
c_cond
(paren
(paren
id|block
(braket
l_int|0
)braket
op_eq
l_int|0x00
)paren
op_logical_and
(paren
id|block
(braket
l_int|1
)braket
op_eq
l_int|0x00
)paren
op_logical_and
(paren
id|block
(braket
l_int|2
)braket
op_eq
l_int|0x00
)paren
op_logical_and
(paren
id|block
(braket
l_int|3
)braket
op_eq
l_int|0xfd
)paren
op_logical_and
(paren
id|block
(braket
l_int|4
)braket
op_eq
l_int|0x00
)paren
)paren
r_return
l_int|1
suffix:semicolon
r_else
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|edid_is_monitor_block
r_static
r_int
id|edid_is_monitor_block
c_func
(paren
r_int
r_char
op_star
id|block
)paren
(brace
r_if
c_cond
(paren
(paren
id|block
(braket
l_int|0
)braket
op_eq
l_int|0x00
)paren
op_logical_and
(paren
id|block
(braket
l_int|1
)braket
op_eq
l_int|0x00
)paren
op_logical_and
(paren
id|block
(braket
l_int|2
)braket
op_eq
l_int|0x00
)paren
op_logical_and
(paren
id|block
(braket
l_int|3
)braket
op_eq
l_int|0xfc
)paren
op_logical_and
(paren
id|block
(braket
l_int|4
)braket
op_eq
l_int|0x00
)paren
)paren
r_return
l_int|1
suffix:semicolon
r_else
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|calc_mode_timings
r_static
r_void
id|calc_mode_timings
c_func
(paren
r_int
id|xres
comma
r_int
id|yres
comma
r_int
id|refresh
comma
r_struct
id|fb_videomode
op_star
id|mode
)paren
(brace
r_struct
id|fb_var_screeninfo
id|var
suffix:semicolon
r_struct
id|fb_info
id|info
suffix:semicolon
id|var.xres
op_assign
id|xres
suffix:semicolon
id|var.yres
op_assign
id|yres
suffix:semicolon
id|fb_get_mode
c_func
(paren
id|FB_VSYNCTIMINGS
op_or
id|FB_IGNOREMON
comma
id|refresh
comma
op_amp
id|var
comma
op_amp
id|info
)paren
suffix:semicolon
id|mode-&gt;xres
op_assign
id|xres
suffix:semicolon
id|mode-&gt;yres
op_assign
id|yres
suffix:semicolon
id|mode-&gt;pixclock
op_assign
id|var.pixclock
suffix:semicolon
id|mode-&gt;refresh
op_assign
id|refresh
suffix:semicolon
id|mode-&gt;left_margin
op_assign
id|var.left_margin
suffix:semicolon
id|mode-&gt;right_margin
op_assign
id|var.right_margin
suffix:semicolon
id|mode-&gt;upper_margin
op_assign
id|var.upper_margin
suffix:semicolon
id|mode-&gt;lower_margin
op_assign
id|var.lower_margin
suffix:semicolon
id|mode-&gt;hsync_len
op_assign
id|var.hsync_len
suffix:semicolon
id|mode-&gt;vsync_len
op_assign
id|var.vsync_len
suffix:semicolon
id|mode-&gt;vmode
op_assign
l_int|0
suffix:semicolon
id|mode-&gt;sync
op_assign
l_int|0
suffix:semicolon
)brace
DECL|function|get_est_timing
r_static
r_int
id|get_est_timing
c_func
(paren
r_int
r_char
op_star
id|block
comma
r_struct
id|fb_videomode
op_star
id|mode
)paren
(brace
r_int
id|num
op_assign
l_int|0
suffix:semicolon
r_int
r_char
id|c
suffix:semicolon
id|c
op_assign
id|block
(braket
l_int|0
)braket
suffix:semicolon
r_if
c_cond
(paren
id|c
op_amp
l_int|0x80
)paren
(brace
id|calc_mode_timings
c_func
(paren
l_int|720
comma
l_int|400
comma
l_int|70
comma
op_amp
id|mode
(braket
id|num
)braket
)paren
suffix:semicolon
id|mode
(braket
id|num
op_increment
)braket
dot
id|flag
op_assign
id|FB_MODE_IS_CALCULATED
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;      720x400@70Hz&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|c
op_amp
l_int|0x40
)paren
(brace
id|calc_mode_timings
c_func
(paren
l_int|720
comma
l_int|400
comma
l_int|88
comma
op_amp
id|mode
(braket
id|num
)braket
)paren
suffix:semicolon
id|mode
(braket
id|num
op_increment
)braket
dot
id|flag
op_assign
id|FB_MODE_IS_CALCULATED
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;      720x400@88Hz&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|c
op_amp
l_int|0x20
)paren
(brace
id|mode
(braket
id|num
op_increment
)braket
op_assign
id|vesa_modes
(braket
l_int|3
)braket
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;      640x480@60Hz&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|c
op_amp
l_int|0x10
)paren
(brace
id|calc_mode_timings
c_func
(paren
l_int|640
comma
l_int|480
comma
l_int|67
comma
op_amp
id|mode
(braket
id|num
)braket
)paren
suffix:semicolon
id|mode
(braket
id|num
op_increment
)braket
dot
id|flag
op_assign
id|FB_MODE_IS_CALCULATED
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;      640x480@67Hz&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|c
op_amp
l_int|0x08
)paren
(brace
id|mode
(braket
id|num
op_increment
)braket
op_assign
id|vesa_modes
(braket
l_int|4
)braket
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;      640x480@72Hz&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|c
op_amp
l_int|0x04
)paren
(brace
id|mode
(braket
id|num
op_increment
)braket
op_assign
id|vesa_modes
(braket
l_int|5
)braket
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;      640x480@75Hz&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|c
op_amp
l_int|0x02
)paren
(brace
id|mode
(braket
id|num
op_increment
)braket
op_assign
id|vesa_modes
(braket
l_int|7
)braket
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;      800x600@56Hz&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|c
op_amp
l_int|0x01
)paren
(brace
id|mode
(braket
id|num
op_increment
)braket
op_assign
id|vesa_modes
(braket
l_int|8
)braket
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;      800x600@60Hz&bslash;n&quot;
)paren
suffix:semicolon
)brace
id|c
op_assign
id|block
(braket
l_int|1
)braket
suffix:semicolon
r_if
c_cond
(paren
id|c
op_amp
l_int|0x80
)paren
(brace
id|mode
(braket
id|num
op_increment
)braket
op_assign
id|vesa_modes
(braket
l_int|9
)braket
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;      800x600@72Hz&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|c
op_amp
l_int|0x40
)paren
(brace
id|mode
(braket
id|num
op_increment
)braket
op_assign
id|vesa_modes
(braket
l_int|10
)braket
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;      800x600@75Hz&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|c
op_amp
l_int|0x20
)paren
(brace
id|calc_mode_timings
c_func
(paren
l_int|832
comma
l_int|624
comma
l_int|75
comma
op_amp
id|mode
(braket
id|num
)braket
)paren
suffix:semicolon
id|mode
(braket
id|num
op_increment
)braket
dot
id|flag
op_assign
id|FB_MODE_IS_CALCULATED
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;      832x624@75Hz&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|c
op_amp
l_int|0x10
)paren
(brace
id|mode
(braket
id|num
op_increment
)braket
op_assign
id|vesa_modes
(braket
l_int|12
)braket
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;      1024x768@87Hz Interlaced&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|c
op_amp
l_int|0x08
)paren
(brace
id|mode
(braket
id|num
op_increment
)braket
op_assign
id|vesa_modes
(braket
l_int|13
)braket
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;      1024x768@60Hz&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|c
op_amp
l_int|0x04
)paren
(brace
id|mode
(braket
id|num
op_increment
)braket
op_assign
id|vesa_modes
(braket
l_int|14
)braket
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;      1024x768@70Hz&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|c
op_amp
l_int|0x02
)paren
(brace
id|mode
(braket
id|num
op_increment
)braket
op_assign
id|vesa_modes
(braket
l_int|15
)braket
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;      1024x768@75Hz&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|c
op_amp
l_int|0x01
)paren
(brace
id|mode
(braket
id|num
op_increment
)braket
op_assign
id|vesa_modes
(braket
l_int|21
)braket
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;      1280x1024@75Hz&bslash;n&quot;
)paren
suffix:semicolon
)brace
id|c
op_assign
id|block
(braket
l_int|2
)braket
suffix:semicolon
r_if
c_cond
(paren
id|c
op_amp
l_int|0x80
)paren
(brace
id|mode
(braket
id|num
op_increment
)braket
op_assign
id|vesa_modes
(braket
l_int|17
)braket
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;      1152x870@75Hz&bslash;n&quot;
)paren
suffix:semicolon
)brace
id|DPRINTK
c_func
(paren
l_string|&quot;      Manufacturer&squot;s mask: %x&bslash;n&quot;
comma
id|c
op_amp
l_int|0x7F
)paren
suffix:semicolon
r_return
id|num
suffix:semicolon
)brace
DECL|function|get_std_timing
r_static
r_int
id|get_std_timing
c_func
(paren
r_int
r_char
op_star
id|block
comma
r_struct
id|fb_videomode
op_star
id|mode
)paren
(brace
r_int
id|xres
comma
id|yres
op_assign
l_int|0
comma
id|refresh
comma
id|ratio
comma
id|i
suffix:semicolon
id|xres
op_assign
(paren
id|block
(braket
l_int|0
)braket
op_plus
l_int|31
)paren
op_star
l_int|8
suffix:semicolon
r_if
c_cond
(paren
id|xres
op_le
l_int|256
)paren
r_return
l_int|0
suffix:semicolon
id|ratio
op_assign
(paren
id|block
(braket
l_int|1
)braket
op_amp
l_int|0xc0
)paren
op_rshift
l_int|6
suffix:semicolon
r_switch
c_cond
(paren
id|ratio
)paren
(brace
r_case
l_int|0
suffix:colon
id|yres
op_assign
id|xres
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|yres
op_assign
(paren
id|xres
op_star
l_int|3
)paren
op_div
l_int|4
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|yres
op_assign
(paren
id|xres
op_star
l_int|4
)paren
op_div
l_int|5
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
id|yres
op_assign
(paren
id|xres
op_star
l_int|9
)paren
op_div
l_int|16
suffix:semicolon
r_break
suffix:semicolon
)brace
id|refresh
op_assign
(paren
id|block
(braket
l_int|1
)braket
op_amp
l_int|0x3f
)paren
op_plus
l_int|60
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;      %dx%d@%dHz&bslash;n&quot;
comma
id|xres
comma
id|yres
comma
id|refresh
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|VESA_MODEDB_SIZE
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|vesa_modes
(braket
id|i
)braket
dot
id|xres
op_eq
id|xres
op_logical_and
id|vesa_modes
(braket
id|i
)braket
dot
id|yres
op_eq
id|yres
op_logical_and
id|vesa_modes
(braket
id|i
)braket
dot
id|refresh
op_eq
id|refresh
)paren
(brace
op_star
id|mode
op_assign
id|vesa_modes
(braket
id|i
)braket
suffix:semicolon
id|mode-&gt;flag
op_or_assign
id|FB_MODE_IS_STANDARD
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
)brace
id|calc_mode_timings
c_func
(paren
id|xres
comma
id|yres
comma
id|refresh
comma
id|mode
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|get_dst_timing
r_static
r_int
id|get_dst_timing
c_func
(paren
r_int
r_char
op_star
id|block
comma
r_struct
id|fb_videomode
op_star
id|mode
)paren
(brace
r_int
id|j
comma
id|num
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
l_int|6
suffix:semicolon
id|j
op_increment
comma
id|block
op_add_assign
id|STD_TIMING_DESCRIPTION_SIZE
)paren
id|num
op_add_assign
id|get_std_timing
c_func
(paren
id|block
comma
op_amp
id|mode
(braket
id|num
)braket
)paren
suffix:semicolon
r_return
id|num
suffix:semicolon
)brace
DECL|function|get_detailed_timing
r_static
r_void
id|get_detailed_timing
c_func
(paren
r_int
r_char
op_star
id|block
comma
r_struct
id|fb_videomode
op_star
id|mode
)paren
(brace
id|mode-&gt;xres
op_assign
id|H_ACTIVE
suffix:semicolon
id|mode-&gt;yres
op_assign
id|V_ACTIVE
suffix:semicolon
id|mode-&gt;pixclock
op_assign
id|PIXEL_CLOCK
suffix:semicolon
id|mode-&gt;pixclock
op_div_assign
l_int|1000
suffix:semicolon
id|mode-&gt;pixclock
op_assign
id|KHZ2PICOS
c_func
(paren
id|mode-&gt;pixclock
)paren
suffix:semicolon
id|mode-&gt;right_margin
op_assign
id|H_SYNC_OFFSET
suffix:semicolon
id|mode-&gt;left_margin
op_assign
(paren
id|H_ACTIVE
op_plus
id|H_BLANKING
)paren
op_minus
(paren
id|H_ACTIVE
op_plus
id|H_SYNC_OFFSET
op_plus
id|H_SYNC_WIDTH
)paren
suffix:semicolon
id|mode-&gt;upper_margin
op_assign
id|V_BLANKING
op_minus
id|V_SYNC_OFFSET
op_minus
id|V_SYNC_WIDTH
suffix:semicolon
id|mode-&gt;lower_margin
op_assign
id|V_SYNC_OFFSET
suffix:semicolon
id|mode-&gt;hsync_len
op_assign
id|H_SYNC_WIDTH
suffix:semicolon
id|mode-&gt;vsync_len
op_assign
id|V_SYNC_WIDTH
suffix:semicolon
r_if
c_cond
(paren
id|HSYNC_POSITIVE
)paren
id|mode-&gt;sync
op_or_assign
id|FB_SYNC_HOR_HIGH_ACT
suffix:semicolon
r_if
c_cond
(paren
id|VSYNC_POSITIVE
)paren
id|mode-&gt;sync
op_or_assign
id|FB_SYNC_VERT_HIGH_ACT
suffix:semicolon
id|mode-&gt;refresh
op_assign
id|PIXEL_CLOCK
op_div
(paren
(paren
id|H_ACTIVE
op_plus
id|H_BLANKING
)paren
op_star
(paren
id|V_ACTIVE
op_plus
id|V_BLANKING
)paren
)paren
suffix:semicolon
id|mode-&gt;vmode
op_assign
l_int|0
suffix:semicolon
id|mode-&gt;flag
op_assign
id|FB_MODE_IS_DETAILED
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;      %d MHz &quot;
comma
id|PIXEL_CLOCK
op_div
l_int|1000000
)paren
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;%d %d %d %d &quot;
comma
id|H_ACTIVE
comma
id|H_ACTIVE
op_plus
id|H_SYNC_OFFSET
comma
id|H_ACTIVE
op_plus
id|H_SYNC_OFFSET
op_plus
id|H_SYNC_WIDTH
comma
id|H_ACTIVE
op_plus
id|H_BLANKING
)paren
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;%d %d %d %d &quot;
comma
id|V_ACTIVE
comma
id|V_ACTIVE
op_plus
id|V_SYNC_OFFSET
comma
id|V_ACTIVE
op_plus
id|V_SYNC_OFFSET
op_plus
id|V_SYNC_WIDTH
comma
id|V_ACTIVE
op_plus
id|V_BLANKING
)paren
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;%sHSync %sVSync&bslash;n&bslash;n&quot;
comma
(paren
id|HSYNC_POSITIVE
)paren
ques
c_cond
l_string|&quot;+&quot;
suffix:colon
l_string|&quot;-&quot;
comma
(paren
id|VSYNC_POSITIVE
)paren
ques
c_cond
l_string|&quot;+&quot;
suffix:colon
l_string|&quot;-&quot;
)paren
suffix:semicolon
)brace
multiline_comment|/**&n; * fb_create_modedb - create video mode database&n; * @edid: EDID data&n; * @dbsize: database size&n; *&n; * RETURNS: struct fb_videomode, @dbsize contains length of database&n; *&n; * DESCRIPTION:&n; * This function builds a mode database using the contents of the EDID&n; * data&n; */
DECL|function|fb_create_modedb
r_struct
id|fb_videomode
op_star
id|fb_create_modedb
c_func
(paren
r_int
r_char
op_star
id|edid
comma
r_int
op_star
id|dbsize
)paren
(brace
r_struct
id|fb_videomode
op_star
id|mode
comma
op_star
id|m
suffix:semicolon
r_int
r_char
op_star
id|block
suffix:semicolon
r_int
id|num
op_assign
l_int|0
comma
id|i
suffix:semicolon
id|mode
op_assign
id|kmalloc
c_func
(paren
l_int|50
op_star
r_sizeof
(paren
r_struct
id|fb_videomode
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|mode
op_eq
l_int|NULL
)paren
r_return
l_int|NULL
suffix:semicolon
id|memset
c_func
(paren
id|mode
comma
l_int|0
comma
l_int|50
op_star
r_sizeof
(paren
r_struct
id|fb_videomode
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|edid
op_eq
l_int|NULL
op_logical_or
op_logical_neg
id|edid_checksum
c_func
(paren
id|edid
)paren
op_logical_or
op_logical_neg
id|edid_check_header
c_func
(paren
id|edid
)paren
)paren
(brace
id|kfree
c_func
(paren
id|mode
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
op_star
id|dbsize
op_assign
l_int|0
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;   Supported VESA Modes&bslash;n&quot;
)paren
suffix:semicolon
id|block
op_assign
id|edid
op_plus
id|ESTABLISHED_TIMING_1
suffix:semicolon
id|num
op_add_assign
id|get_est_timing
c_func
(paren
id|block
comma
op_amp
id|mode
(braket
id|num
)braket
)paren
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;   Standard Timings&bslash;n&quot;
)paren
suffix:semicolon
id|block
op_assign
id|edid
op_plus
id|STD_TIMING_DESCRIPTIONS_START
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|STD_TIMING
suffix:semicolon
id|i
op_increment
comma
id|block
op_add_assign
id|STD_TIMING_DESCRIPTION_SIZE
)paren
id|num
op_add_assign
id|get_std_timing
c_func
(paren
id|block
comma
op_amp
id|mode
(braket
id|num
)braket
)paren
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;   Detailed Timings&bslash;n&quot;
)paren
suffix:semicolon
id|block
op_assign
id|edid
op_plus
id|DETAILED_TIMING_DESCRIPTIONS_START
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|4
suffix:semicolon
id|i
op_increment
comma
id|block
op_add_assign
id|DETAILED_TIMING_DESCRIPTION_SIZE
)paren
(brace
r_int
id|first
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|block
(braket
l_int|0
)braket
op_eq
l_int|0x00
op_logical_and
id|block
(braket
l_int|1
)braket
op_eq
l_int|0x00
)paren
(brace
r_if
c_cond
(paren
id|block
(braket
l_int|3
)braket
op_eq
l_int|0xfa
)paren
(brace
id|num
op_add_assign
id|get_dst_timing
c_func
(paren
id|block
op_plus
l_int|5
comma
op_amp
id|mode
(braket
id|num
)braket
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
id|get_detailed_timing
c_func
(paren
id|block
comma
op_amp
id|mode
(braket
id|num
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
id|first
)paren
(brace
id|mode
(braket
id|num
)braket
dot
id|flag
op_or_assign
id|FB_MODE_IS_FIRST
suffix:semicolon
id|first
op_assign
l_int|0
suffix:semicolon
)brace
id|num
op_increment
suffix:semicolon
)brace
)brace
multiline_comment|/* Yikes, EDID data is totally useless */
r_if
c_cond
(paren
op_logical_neg
id|num
)paren
(brace
id|kfree
c_func
(paren
id|mode
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
op_star
id|dbsize
op_assign
id|num
suffix:semicolon
id|m
op_assign
id|kmalloc
c_func
(paren
id|num
op_star
r_sizeof
(paren
r_struct
id|fb_videomode
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|m
)paren
r_return
id|mode
suffix:semicolon
id|memmove
c_func
(paren
id|m
comma
id|mode
comma
id|num
op_star
r_sizeof
(paren
r_struct
id|fb_videomode
)paren
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|mode
)paren
suffix:semicolon
r_return
id|m
suffix:semicolon
)brace
multiline_comment|/**&n; * fb_destroy_modedb - destroys mode database&n; * @modedb: mode database to destroy&n; *&n; * DESCRIPTION:&n; * Destroy mode database created by fb_create_modedb&n; */
DECL|function|fb_destroy_modedb
r_void
id|fb_destroy_modedb
c_func
(paren
r_struct
id|fb_videomode
op_star
id|modedb
)paren
(brace
r_if
c_cond
(paren
id|modedb
)paren
id|kfree
c_func
(paren
id|modedb
)paren
suffix:semicolon
)brace
DECL|function|fb_get_monitor_limits
r_int
id|fb_get_monitor_limits
c_func
(paren
r_int
r_char
op_star
id|edid
comma
r_struct
id|fb_monspecs
op_star
id|specs
)paren
(brace
r_int
id|i
comma
id|retval
op_assign
l_int|1
suffix:semicolon
r_int
r_char
op_star
id|block
suffix:semicolon
id|block
op_assign
id|edid
op_plus
id|DETAILED_TIMING_DESCRIPTIONS_START
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;      Monitor Operating Limits: &quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|4
suffix:semicolon
id|i
op_increment
comma
id|block
op_add_assign
id|DETAILED_TIMING_DESCRIPTION_SIZE
)paren
(brace
r_if
c_cond
(paren
id|edid_is_limits_block
c_func
(paren
id|block
)paren
)paren
(brace
id|specs-&gt;hfmin
op_assign
id|H_MIN_RATE
op_star
l_int|1000
suffix:semicolon
id|specs-&gt;hfmax
op_assign
id|H_MAX_RATE
op_star
l_int|1000
suffix:semicolon
id|specs-&gt;vfmin
op_assign
id|V_MIN_RATE
suffix:semicolon
id|specs-&gt;vfmax
op_assign
id|V_MAX_RATE
suffix:semicolon
id|specs-&gt;dclkmax
op_assign
id|MAX_PIXEL_CLOCK
op_star
l_int|1000000
suffix:semicolon
id|specs-&gt;gtf
op_assign
(paren
id|GTF_SUPPORT
)paren
ques
c_cond
l_int|1
suffix:colon
l_int|0
suffix:semicolon
id|retval
op_assign
l_int|0
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;From EDID&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
multiline_comment|/* estimate monitor limits based on modes supported */
r_if
c_cond
(paren
id|retval
)paren
(brace
r_struct
id|fb_videomode
op_star
id|modes
suffix:semicolon
r_int
id|num_modes
comma
id|i
comma
id|hz
comma
id|hscan
comma
id|pixclock
suffix:semicolon
id|modes
op_assign
id|fb_create_modedb
c_func
(paren
id|edid
comma
op_amp
id|num_modes
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|modes
)paren
(brace
id|DPRINTK
c_func
(paren
l_string|&quot;None Available&bslash;n&quot;
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
id|retval
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|num_modes
suffix:semicolon
id|i
op_increment
)paren
(brace
id|hz
op_assign
id|modes
(braket
id|i
)braket
dot
id|refresh
suffix:semicolon
id|pixclock
op_assign
id|PICOS2KHZ
c_func
(paren
id|modes
(braket
id|i
)braket
dot
id|pixclock
)paren
op_star
l_int|1000
suffix:semicolon
id|hscan
op_assign
(paren
id|modes
(braket
id|i
)braket
dot
id|yres
op_star
l_int|105
op_star
id|hz
op_plus
l_int|5000
)paren
op_div
l_int|100
suffix:semicolon
r_if
c_cond
(paren
id|specs-&gt;dclkmax
op_eq
l_int|0
op_logical_or
id|specs-&gt;dclkmax
OL
id|pixclock
)paren
id|specs-&gt;dclkmax
op_assign
id|pixclock
suffix:semicolon
r_if
c_cond
(paren
id|specs-&gt;dclkmin
op_eq
l_int|0
op_logical_or
id|specs-&gt;dclkmin
OG
id|pixclock
)paren
id|specs-&gt;dclkmin
op_assign
id|pixclock
suffix:semicolon
r_if
c_cond
(paren
id|specs-&gt;hfmax
op_eq
l_int|0
op_logical_or
id|specs-&gt;hfmax
OL
id|hscan
)paren
id|specs-&gt;hfmax
op_assign
id|hscan
suffix:semicolon
r_if
c_cond
(paren
id|specs-&gt;hfmin
op_eq
l_int|0
op_logical_or
id|specs-&gt;hfmin
OG
id|hscan
)paren
id|specs-&gt;hfmin
op_assign
id|hscan
suffix:semicolon
r_if
c_cond
(paren
id|specs-&gt;vfmax
op_eq
l_int|0
op_logical_or
id|specs-&gt;vfmax
OL
id|hz
)paren
id|specs-&gt;vfmax
op_assign
id|hz
suffix:semicolon
r_if
c_cond
(paren
id|specs-&gt;vfmin
op_eq
l_int|0
op_logical_or
id|specs-&gt;vfmin
OG
id|hz
)paren
id|specs-&gt;vfmin
op_assign
id|hz
suffix:semicolon
)brace
id|DPRINTK
c_func
(paren
l_string|&quot;Extrapolated&bslash;n&quot;
)paren
suffix:semicolon
id|fb_destroy_modedb
c_func
(paren
id|modes
)paren
suffix:semicolon
)brace
id|DPRINTK
c_func
(paren
l_string|&quot;           H: %d-%dKHz V: %d-%dHz DCLK: %dMHz&bslash;n&quot;
comma
id|specs-&gt;hfmin
op_div
l_int|1000
comma
id|specs-&gt;hfmax
op_div
l_int|1000
comma
id|specs-&gt;vfmin
comma
id|specs-&gt;vfmax
comma
id|specs-&gt;dclkmax
op_div
l_int|1000000
)paren
suffix:semicolon
r_return
id|retval
suffix:semicolon
)brace
DECL|function|get_monspecs
r_static
r_void
id|get_monspecs
c_func
(paren
r_int
r_char
op_star
id|edid
comma
r_struct
id|fb_monspecs
op_star
id|specs
)paren
(brace
r_int
r_char
id|c
comma
op_star
id|block
suffix:semicolon
id|block
op_assign
id|edid
op_plus
id|EDID_STRUCT_DISPLAY
suffix:semicolon
id|fb_get_monitor_limits
c_func
(paren
id|edid
comma
id|specs
)paren
suffix:semicolon
id|c
op_assign
(paren
id|block
(braket
l_int|0
)braket
op_amp
l_int|0x80
)paren
op_rshift
l_int|7
suffix:semicolon
id|specs-&gt;input
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|c
)paren
(brace
id|specs-&gt;input
op_or_assign
id|FB_DISP_DDI
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;      Digital Display Input&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|DPRINTK
c_func
(paren
l_string|&quot;      Analog Display Input: Input Voltage - &quot;
)paren
suffix:semicolon
r_switch
c_cond
(paren
(paren
id|block
(braket
l_int|0
)braket
op_amp
l_int|0x60
)paren
op_rshift
l_int|5
)paren
(brace
r_case
l_int|0
suffix:colon
id|DPRINTK
c_func
(paren
l_string|&quot;0.700V/0.300V&quot;
)paren
suffix:semicolon
id|specs-&gt;input
op_or_assign
id|FB_DISP_ANA_700_300
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|DPRINTK
c_func
(paren
l_string|&quot;0.714V/0.286V&quot;
)paren
suffix:semicolon
id|specs-&gt;input
op_or_assign
id|FB_DISP_ANA_714_286
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|DPRINTK
c_func
(paren
l_string|&quot;1.000V/0.400V&quot;
)paren
suffix:semicolon
id|specs-&gt;input
op_or_assign
id|FB_DISP_ANA_1000_400
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
id|DPRINTK
c_func
(paren
l_string|&quot;0.700V/0.000V&quot;
)paren
suffix:semicolon
id|specs-&gt;input
op_or_assign
id|FB_DISP_ANA_700_000
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|DPRINTK
c_func
(paren
l_string|&quot;unknown&quot;
)paren
suffix:semicolon
id|specs-&gt;input
op_or_assign
id|FB_DISP_UNKNOWN
suffix:semicolon
)brace
)brace
id|DPRINTK
c_func
(paren
l_string|&quot;&bslash;n      Sync: &quot;
)paren
suffix:semicolon
id|c
op_assign
(paren
id|block
(braket
l_int|0
)braket
op_amp
l_int|0x10
)paren
op_rshift
l_int|4
suffix:semicolon
r_if
c_cond
(paren
id|c
)paren
id|DPRINTK
c_func
(paren
l_string|&quot;      Configurable signal level&bslash;n&quot;
)paren
suffix:semicolon
id|c
op_assign
id|block
(braket
l_int|0
)braket
op_amp
l_int|0x0f
suffix:semicolon
id|specs-&gt;signal
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|c
op_amp
l_int|0x10
)paren
(brace
id|DPRINTK
c_func
(paren
l_string|&quot;Blank to Blank &quot;
)paren
suffix:semicolon
id|specs-&gt;signal
op_or_assign
id|FB_SIGNAL_BLANK_BLANK
suffix:semicolon
)brace
r_if
c_cond
(paren
id|c
op_amp
l_int|0x08
)paren
(brace
id|DPRINTK
c_func
(paren
l_string|&quot;Separate &quot;
)paren
suffix:semicolon
id|specs-&gt;signal
op_or_assign
id|FB_SIGNAL_SEPARATE
suffix:semicolon
)brace
r_if
c_cond
(paren
id|c
op_amp
l_int|0x04
)paren
(brace
id|DPRINTK
c_func
(paren
l_string|&quot;Composite &quot;
)paren
suffix:semicolon
id|specs-&gt;signal
op_or_assign
id|FB_SIGNAL_COMPOSITE
suffix:semicolon
)brace
r_if
c_cond
(paren
id|c
op_amp
l_int|0x02
)paren
(brace
id|DPRINTK
c_func
(paren
l_string|&quot;Sync on Green &quot;
)paren
suffix:semicolon
id|specs-&gt;signal
op_or_assign
id|FB_SIGNAL_SYNC_ON_GREEN
suffix:semicolon
)brace
r_if
c_cond
(paren
id|c
op_amp
l_int|0x01
)paren
(brace
id|DPRINTK
c_func
(paren
l_string|&quot;Serration on &quot;
)paren
suffix:semicolon
id|specs-&gt;signal
op_or_assign
id|FB_SIGNAL_SERRATION_ON
suffix:semicolon
)brace
id|DPRINTK
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|specs-&gt;max_x
op_assign
id|block
(braket
l_int|1
)braket
suffix:semicolon
id|specs-&gt;max_y
op_assign
id|block
(braket
l_int|2
)braket
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;      Max H-size in cm: &quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|specs-&gt;max_x
)paren
id|DPRINTK
c_func
(paren
l_string|&quot;%d&bslash;n&quot;
comma
id|specs-&gt;max_x
)paren
suffix:semicolon
r_else
id|DPRINTK
c_func
(paren
l_string|&quot;variable&bslash;n&quot;
)paren
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;      Max V-size in cm: &quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|specs-&gt;max_y
)paren
id|DPRINTK
c_func
(paren
l_string|&quot;%d&bslash;n&quot;
comma
id|specs-&gt;max_y
)paren
suffix:semicolon
r_else
id|DPRINTK
c_func
(paren
l_string|&quot;variable&bslash;n&quot;
)paren
suffix:semicolon
id|c
op_assign
id|block
(braket
l_int|3
)braket
suffix:semicolon
id|specs-&gt;gamma
op_assign
id|c
op_plus
l_int|100
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;      Gamma: &quot;
)paren
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;%d.%d&bslash;n&quot;
comma
id|specs-&gt;gamma
op_div
l_int|100
comma
id|specs-&gt;gamma
op_mod
l_int|100
)paren
suffix:semicolon
id|get_dpms_capabilities
c_func
(paren
id|block
(braket
l_int|4
)braket
comma
id|specs
)paren
suffix:semicolon
r_switch
c_cond
(paren
(paren
id|block
(braket
l_int|4
)braket
op_amp
l_int|0x18
)paren
op_rshift
l_int|3
)paren
(brace
r_case
l_int|0
suffix:colon
id|DPRINTK
c_func
(paren
l_string|&quot;      Monochrome/Grayscale&bslash;n&quot;
)paren
suffix:semicolon
id|specs-&gt;input
op_or_assign
id|FB_DISP_MONO
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|DPRINTK
c_func
(paren
l_string|&quot;      RGB Color Display&bslash;n&quot;
)paren
suffix:semicolon
id|specs-&gt;input
op_or_assign
id|FB_DISP_RGB
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|DPRINTK
c_func
(paren
l_string|&quot;      Non-RGB Multicolor Display&bslash;n&quot;
)paren
suffix:semicolon
id|specs-&gt;input
op_or_assign
id|FB_DISP_MULTI
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|DPRINTK
c_func
(paren
l_string|&quot;      Unknown&bslash;n&quot;
)paren
suffix:semicolon
id|specs-&gt;input
op_or_assign
id|FB_DISP_UNKNOWN
suffix:semicolon
r_break
suffix:semicolon
)brace
id|get_chroma
c_func
(paren
id|block
comma
id|specs
)paren
suffix:semicolon
id|specs-&gt;misc
op_assign
l_int|0
suffix:semicolon
id|c
op_assign
id|block
(braket
l_int|4
)braket
op_amp
l_int|0x7
suffix:semicolon
r_if
c_cond
(paren
id|c
op_amp
l_int|0x04
)paren
(brace
id|DPRINTK
c_func
(paren
l_string|&quot;      Default color format is primary&bslash;n&quot;
)paren
suffix:semicolon
id|specs-&gt;misc
op_or_assign
id|FB_MISC_PRIM_COLOR
suffix:semicolon
)brace
r_if
c_cond
(paren
id|c
op_amp
l_int|0x02
)paren
(brace
id|DPRINTK
c_func
(paren
l_string|&quot;      First DETAILED Timing is preferred&bslash;n&quot;
)paren
suffix:semicolon
id|specs-&gt;misc
op_or_assign
id|FB_MISC_1ST_DETAIL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|c
op_amp
l_int|0x01
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;      Display is GTF capable&bslash;n&quot;
)paren
suffix:semicolon
id|specs-&gt;gtf
op_assign
l_int|1
suffix:semicolon
)brace
)brace
DECL|function|edid_is_timing_block
r_static
r_int
id|edid_is_timing_block
c_func
(paren
r_int
r_char
op_star
id|block
)paren
(brace
r_if
c_cond
(paren
(paren
id|block
(braket
l_int|0
)braket
op_ne
l_int|0x00
)paren
op_logical_or
(paren
id|block
(braket
l_int|1
)braket
op_ne
l_int|0x00
)paren
op_logical_or
(paren
id|block
(braket
l_int|2
)braket
op_ne
l_int|0x00
)paren
op_logical_or
(paren
id|block
(braket
l_int|4
)braket
op_ne
l_int|0x00
)paren
)paren
r_return
l_int|1
suffix:semicolon
r_else
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|fb_parse_edid
r_int
id|fb_parse_edid
c_func
(paren
r_int
r_char
op_star
id|edid
comma
r_struct
id|fb_var_screeninfo
op_star
id|var
)paren
(brace
r_int
id|i
suffix:semicolon
r_int
r_char
op_star
id|block
suffix:semicolon
r_if
c_cond
(paren
id|edid
op_eq
l_int|NULL
op_logical_or
id|var
op_eq
l_int|NULL
)paren
r_return
l_int|1
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|edid_checksum
c_func
(paren
id|edid
)paren
)paren
)paren
r_return
l_int|1
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|edid_check_header
c_func
(paren
id|edid
)paren
)paren
)paren
r_return
l_int|1
suffix:semicolon
id|block
op_assign
id|edid
op_plus
id|DETAILED_TIMING_DESCRIPTIONS_START
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|4
suffix:semicolon
id|i
op_increment
comma
id|block
op_add_assign
id|DETAILED_TIMING_DESCRIPTION_SIZE
)paren
(brace
r_if
c_cond
(paren
id|edid_is_timing_block
c_func
(paren
id|block
)paren
)paren
(brace
id|var-&gt;xres
op_assign
id|var-&gt;xres_virtual
op_assign
id|H_ACTIVE
suffix:semicolon
id|var-&gt;yres
op_assign
id|var-&gt;yres_virtual
op_assign
id|V_ACTIVE
suffix:semicolon
id|var-&gt;height
op_assign
id|var-&gt;width
op_assign
op_minus
l_int|1
suffix:semicolon
id|var-&gt;right_margin
op_assign
id|H_SYNC_OFFSET
suffix:semicolon
id|var-&gt;left_margin
op_assign
(paren
id|H_ACTIVE
op_plus
id|H_BLANKING
)paren
op_minus
(paren
id|H_ACTIVE
op_plus
id|H_SYNC_OFFSET
op_plus
id|H_SYNC_WIDTH
)paren
suffix:semicolon
id|var-&gt;upper_margin
op_assign
id|V_BLANKING
op_minus
id|V_SYNC_OFFSET
op_minus
id|V_SYNC_WIDTH
suffix:semicolon
id|var-&gt;lower_margin
op_assign
id|V_SYNC_OFFSET
suffix:semicolon
id|var-&gt;hsync_len
op_assign
id|H_SYNC_WIDTH
suffix:semicolon
id|var-&gt;vsync_len
op_assign
id|V_SYNC_WIDTH
suffix:semicolon
id|var-&gt;pixclock
op_assign
id|PIXEL_CLOCK
suffix:semicolon
id|var-&gt;pixclock
op_div_assign
l_int|1000
suffix:semicolon
id|var-&gt;pixclock
op_assign
id|KHZ2PICOS
c_func
(paren
id|var-&gt;pixclock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|HSYNC_POSITIVE
)paren
id|var-&gt;sync
op_or_assign
id|FB_SYNC_HOR_HIGH_ACT
suffix:semicolon
r_if
c_cond
(paren
id|VSYNC_POSITIVE
)paren
id|var-&gt;sync
op_or_assign
id|FB_SYNC_VERT_HIGH_ACT
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
)brace
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|fb_edid_to_monspecs
r_void
id|fb_edid_to_monspecs
c_func
(paren
r_int
r_char
op_star
id|edid
comma
r_struct
id|fb_monspecs
op_star
id|specs
)paren
(brace
r_int
r_char
op_star
id|block
suffix:semicolon
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
id|edid
op_eq
l_int|NULL
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|edid_checksum
c_func
(paren
id|edid
)paren
)paren
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|edid_check_header
c_func
(paren
id|edid
)paren
)paren
)paren
r_return
suffix:semicolon
id|memset
c_func
(paren
id|specs
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|fb_monspecs
)paren
)paren
suffix:semicolon
id|specs-&gt;version
op_assign
id|edid
(braket
id|EDID_STRUCT_VERSION
)braket
suffix:semicolon
id|specs-&gt;revision
op_assign
id|edid
(braket
id|EDID_STRUCT_REVISION
)braket
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;========================================&bslash;n&quot;
)paren
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;Display Information (EDID)&bslash;n&quot;
)paren
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;========================================&bslash;n&quot;
)paren
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;   EDID Version %d.%d&bslash;n&quot;
comma
(paren
r_int
)paren
id|specs-&gt;version
comma
(paren
r_int
)paren
id|specs-&gt;revision
)paren
suffix:semicolon
id|parse_vendor_block
c_func
(paren
id|edid
op_plus
id|ID_MANUFACTURER_NAME
comma
id|specs
)paren
suffix:semicolon
id|block
op_assign
id|edid
op_plus
id|DETAILED_TIMING_DESCRIPTIONS_START
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|4
suffix:semicolon
id|i
op_increment
comma
id|block
op_add_assign
id|DETAILED_TIMING_DESCRIPTION_SIZE
)paren
(brace
r_if
c_cond
(paren
id|edid_is_serial_block
c_func
(paren
id|block
)paren
)paren
(brace
id|copy_string
c_func
(paren
id|block
comma
id|specs-&gt;serial_no
)paren
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;   Serial Number: %s&bslash;n&quot;
comma
id|specs-&gt;serial_no
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|edid_is_ascii_block
c_func
(paren
id|block
)paren
)paren
(brace
id|copy_string
c_func
(paren
id|block
comma
id|specs-&gt;ascii
)paren
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;   ASCII Block: %s&bslash;n&quot;
comma
id|specs-&gt;ascii
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|edid_is_monitor_block
c_func
(paren
id|block
)paren
)paren
(brace
id|copy_string
c_func
(paren
id|block
comma
id|specs-&gt;monitor
)paren
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;   Monitor Name: %s&bslash;n&quot;
comma
id|specs-&gt;monitor
)paren
suffix:semicolon
)brace
)brace
id|DPRINTK
c_func
(paren
l_string|&quot;   Display Characteristics:&bslash;n&quot;
)paren
suffix:semicolon
id|get_monspecs
c_func
(paren
id|edid
comma
id|specs
)paren
suffix:semicolon
id|specs-&gt;modedb
op_assign
id|fb_create_modedb
c_func
(paren
id|edid
comma
op_amp
id|specs-&gt;modedb_len
)paren
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;========================================&bslash;n&quot;
)paren
suffix:semicolon
)brace
DECL|function|get_EDID_from_firmware
r_char
op_star
id|get_EDID_from_firmware
c_func
(paren
r_struct
id|device
op_star
id|dev
)paren
(brace
r_int
r_char
op_star
id|pedid
op_assign
l_int|NULL
suffix:semicolon
macro_line|#if defined(CONFIG_EDID_FIRMWARE) &amp;&amp; defined(CONFIG_X86)
id|pedid
op_assign
id|edid_info.dummy
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|pedid
)paren
r_return
l_int|NULL
suffix:semicolon
macro_line|#endif
r_return
id|pedid
suffix:semicolon
)brace
multiline_comment|/* &n; * VESA Generalized Timing Formula (GTF) &n; */
DECL|macro|FLYBACK
mdefine_line|#define FLYBACK                     550
DECL|macro|V_FRONTPORCH
mdefine_line|#define V_FRONTPORCH                1
DECL|macro|H_OFFSET
mdefine_line|#define H_OFFSET                    40
DECL|macro|H_SCALEFACTOR
mdefine_line|#define H_SCALEFACTOR               20
DECL|macro|H_BLANKSCALE
mdefine_line|#define H_BLANKSCALE                128
DECL|macro|H_GRADIENT
mdefine_line|#define H_GRADIENT                  600
DECL|macro|C_VAL
mdefine_line|#define C_VAL                       30
DECL|macro|M_VAL
mdefine_line|#define M_VAL                       300
DECL|struct|__fb_timings
r_struct
id|__fb_timings
(brace
DECL|member|dclk
id|u32
id|dclk
suffix:semicolon
DECL|member|hfreq
id|u32
id|hfreq
suffix:semicolon
DECL|member|vfreq
id|u32
id|vfreq
suffix:semicolon
DECL|member|hactive
id|u32
id|hactive
suffix:semicolon
DECL|member|vactive
id|u32
id|vactive
suffix:semicolon
DECL|member|hblank
id|u32
id|hblank
suffix:semicolon
DECL|member|vblank
id|u32
id|vblank
suffix:semicolon
DECL|member|htotal
id|u32
id|htotal
suffix:semicolon
DECL|member|vtotal
id|u32
id|vtotal
suffix:semicolon
)brace
suffix:semicolon
multiline_comment|/**&n; * fb_get_vblank - get vertical blank time&n; * @hfreq: horizontal freq&n; *&n; * DESCRIPTION:&n; * vblank = right_margin + vsync_len + left_margin &n; *&n; *    given: right_margin = 1 (V_FRONTPORCH)&n; *           vsync_len    = 3&n; *           flyback      = 550&n; *&n; *                          flyback * hfreq&n; *           left_margin  = --------------- - vsync_len&n; *                           1000000&n; */
DECL|function|fb_get_vblank
r_static
id|u32
id|fb_get_vblank
c_func
(paren
id|u32
id|hfreq
)paren
(brace
id|u32
id|vblank
suffix:semicolon
id|vblank
op_assign
(paren
id|hfreq
op_star
id|FLYBACK
)paren
op_div
l_int|1000
suffix:semicolon
id|vblank
op_assign
(paren
id|vblank
op_plus
l_int|500
)paren
op_div
l_int|1000
suffix:semicolon
r_return
(paren
id|vblank
op_plus
id|V_FRONTPORCH
)paren
suffix:semicolon
)brace
multiline_comment|/** &n; * fb_get_hblank_by_freq - get horizontal blank time given hfreq&n; * @hfreq: horizontal freq&n; * @xres: horizontal resolution in pixels&n; *&n; * DESCRIPTION:&n; *&n; *           xres * duty_cycle&n; * hblank = ------------------&n; *           100 - duty_cycle&n; *&n; * duty cycle = percent of htotal assigned to inactive display&n; * duty cycle = C - (M/Hfreq)&n; *&n; * where: C = ((offset - scale factor) * blank_scale)&n; *            -------------------------------------- + scale factor&n; *                        256 &n; *        M = blank_scale * gradient&n; *&n; */
DECL|function|fb_get_hblank_by_hfreq
r_static
id|u32
id|fb_get_hblank_by_hfreq
c_func
(paren
id|u32
id|hfreq
comma
id|u32
id|xres
)paren
(brace
id|u32
id|c_val
comma
id|m_val
comma
id|duty_cycle
comma
id|hblank
suffix:semicolon
id|c_val
op_assign
(paren
(paren
(paren
id|H_OFFSET
op_minus
id|H_SCALEFACTOR
)paren
op_star
id|H_BLANKSCALE
)paren
op_div
l_int|256
op_plus
id|H_SCALEFACTOR
)paren
op_star
l_int|1000
suffix:semicolon
id|m_val
op_assign
(paren
id|H_BLANKSCALE
op_star
id|H_GRADIENT
)paren
op_div
l_int|256
suffix:semicolon
id|m_val
op_assign
(paren
id|m_val
op_star
l_int|1000000
)paren
op_div
id|hfreq
suffix:semicolon
id|duty_cycle
op_assign
id|c_val
op_minus
id|m_val
suffix:semicolon
id|hblank
op_assign
(paren
id|xres
op_star
id|duty_cycle
)paren
op_div
(paren
l_int|100000
op_minus
id|duty_cycle
)paren
suffix:semicolon
r_return
(paren
id|hblank
)paren
suffix:semicolon
)brace
multiline_comment|/** &n; * fb_get_hblank_by_dclk - get horizontal blank time given pixelclock&n; * @dclk: pixelclock in Hz&n; * @xres: horizontal resolution in pixels&n; *&n; * DESCRIPTION:&n; *&n; *           xres * duty_cycle&n; * hblank = ------------------&n; *           100 - duty_cycle&n; *&n; * duty cycle = percent of htotal assigned to inactive display&n; * duty cycle = C - (M * h_period)&n; * &n; * where: h_period = SQRT(100 - C + (0.4 * xres * M)/dclk) + C - 100&n; *                   -----------------------------------------------&n; *                                    2 * M&n; *        M = 300;&n; *        C = 30;&n;&n; */
DECL|function|fb_get_hblank_by_dclk
r_static
id|u32
id|fb_get_hblank_by_dclk
c_func
(paren
id|u32
id|dclk
comma
id|u32
id|xres
)paren
(brace
id|u32
id|duty_cycle
comma
id|h_period
comma
id|hblank
suffix:semicolon
id|dclk
op_div_assign
l_int|1000
suffix:semicolon
id|h_period
op_assign
l_int|100
op_minus
id|C_VAL
suffix:semicolon
id|h_period
op_mul_assign
id|h_period
suffix:semicolon
id|h_period
op_add_assign
(paren
id|M_VAL
op_star
id|xres
op_star
l_int|2
op_star
l_int|1000
)paren
op_div
(paren
l_int|5
op_star
id|dclk
)paren
suffix:semicolon
id|h_period
op_mul_assign
l_int|10000
suffix:semicolon
id|h_period
op_assign
id|int_sqrt
c_func
(paren
id|h_period
)paren
suffix:semicolon
id|h_period
op_sub_assign
(paren
l_int|100
op_minus
id|C_VAL
)paren
op_star
l_int|100
suffix:semicolon
id|h_period
op_mul_assign
l_int|1000
suffix:semicolon
id|h_period
op_div_assign
l_int|2
op_star
id|M_VAL
suffix:semicolon
id|duty_cycle
op_assign
id|C_VAL
op_star
l_int|1000
op_minus
(paren
id|M_VAL
op_star
id|h_period
)paren
op_div
l_int|100
suffix:semicolon
id|hblank
op_assign
(paren
id|xres
op_star
id|duty_cycle
)paren
op_div
(paren
l_int|100000
op_minus
id|duty_cycle
)paren
op_plus
l_int|8
suffix:semicolon
id|hblank
op_and_assign
op_complement
l_int|15
suffix:semicolon
r_return
(paren
id|hblank
)paren
suffix:semicolon
)brace
multiline_comment|/**&n; * fb_get_hfreq - estimate hsync&n; * @vfreq: vertical refresh rate&n; * @yres: vertical resolution&n; *&n; * DESCRIPTION:&n; *&n; *          (yres + front_port) * vfreq * 1000000&n; * hfreq = -------------------------------------&n; *          (1000000 - (vfreq * FLYBACK)&n; * &n; */
DECL|function|fb_get_hfreq
r_static
id|u32
id|fb_get_hfreq
c_func
(paren
id|u32
id|vfreq
comma
id|u32
id|yres
)paren
(brace
id|u32
id|divisor
comma
id|hfreq
suffix:semicolon
id|divisor
op_assign
(paren
l_int|1000000
op_minus
(paren
id|vfreq
op_star
id|FLYBACK
)paren
)paren
op_div
l_int|1000
suffix:semicolon
id|hfreq
op_assign
(paren
id|yres
op_plus
id|V_FRONTPORCH
)paren
op_star
id|vfreq
op_star
l_int|1000
suffix:semicolon
r_return
(paren
id|hfreq
op_div
id|divisor
)paren
suffix:semicolon
)brace
DECL|function|fb_timings_vfreq
r_static
r_void
id|fb_timings_vfreq
c_func
(paren
r_struct
id|__fb_timings
op_star
id|timings
)paren
(brace
id|timings-&gt;hfreq
op_assign
id|fb_get_hfreq
c_func
(paren
id|timings-&gt;vfreq
comma
id|timings-&gt;vactive
)paren
suffix:semicolon
id|timings-&gt;vblank
op_assign
id|fb_get_vblank
c_func
(paren
id|timings-&gt;hfreq
)paren
suffix:semicolon
id|timings-&gt;vtotal
op_assign
id|timings-&gt;vactive
op_plus
id|timings-&gt;vblank
suffix:semicolon
id|timings-&gt;hblank
op_assign
id|fb_get_hblank_by_hfreq
c_func
(paren
id|timings-&gt;hfreq
comma
id|timings-&gt;hactive
)paren
suffix:semicolon
id|timings-&gt;htotal
op_assign
id|timings-&gt;hactive
op_plus
id|timings-&gt;hblank
suffix:semicolon
id|timings-&gt;dclk
op_assign
id|timings-&gt;htotal
op_star
id|timings-&gt;hfreq
suffix:semicolon
)brace
DECL|function|fb_timings_hfreq
r_static
r_void
id|fb_timings_hfreq
c_func
(paren
r_struct
id|__fb_timings
op_star
id|timings
)paren
(brace
id|timings-&gt;vblank
op_assign
id|fb_get_vblank
c_func
(paren
id|timings-&gt;hfreq
)paren
suffix:semicolon
id|timings-&gt;vtotal
op_assign
id|timings-&gt;vactive
op_plus
id|timings-&gt;vblank
suffix:semicolon
id|timings-&gt;vfreq
op_assign
id|timings-&gt;hfreq
op_div
id|timings-&gt;vtotal
suffix:semicolon
id|timings-&gt;hblank
op_assign
id|fb_get_hblank_by_hfreq
c_func
(paren
id|timings-&gt;hfreq
comma
id|timings-&gt;hactive
)paren
suffix:semicolon
id|timings-&gt;htotal
op_assign
id|timings-&gt;hactive
op_plus
id|timings-&gt;hblank
suffix:semicolon
id|timings-&gt;dclk
op_assign
id|timings-&gt;htotal
op_star
id|timings-&gt;hfreq
suffix:semicolon
)brace
DECL|function|fb_timings_dclk
r_static
r_void
id|fb_timings_dclk
c_func
(paren
r_struct
id|__fb_timings
op_star
id|timings
)paren
(brace
id|timings-&gt;hblank
op_assign
id|fb_get_hblank_by_dclk
c_func
(paren
id|timings-&gt;dclk
comma
id|timings-&gt;hactive
)paren
suffix:semicolon
id|timings-&gt;htotal
op_assign
id|timings-&gt;hactive
op_plus
id|timings-&gt;hblank
suffix:semicolon
id|timings-&gt;hfreq
op_assign
id|timings-&gt;dclk
op_div
id|timings-&gt;htotal
suffix:semicolon
id|timings-&gt;vblank
op_assign
id|fb_get_vblank
c_func
(paren
id|timings-&gt;hfreq
)paren
suffix:semicolon
id|timings-&gt;vtotal
op_assign
id|timings-&gt;vactive
op_plus
id|timings-&gt;vblank
suffix:semicolon
id|timings-&gt;vfreq
op_assign
id|timings-&gt;hfreq
op_div
id|timings-&gt;vtotal
suffix:semicolon
)brace
multiline_comment|/*&n; * fb_get_mode - calculates video mode using VESA GTF&n; * @flags: if: 0 - maximize vertical refresh rate&n; *             1 - vrefresh-driven calculation;&n; *             2 - hscan-driven calculation;&n; *             3 - pixelclock-driven calculation;&n; * @val: depending on @flags, ignored, vrefresh, hsync or pixelclock&n; * @var: pointer to fb_var_screeninfo&n; * @info: pointer to fb_info&n; *&n; * DESCRIPTION:&n; * Calculates video mode based on monitor specs using VESA GTF. &n; * The GTF is best for VESA GTF compliant monitors but is &n; * specifically formulated to work for older monitors as well.&n; *&n; * If @flag==0, the function will attempt to maximize the &n; * refresh rate.  Otherwise, it will calculate timings based on&n; * the flag and accompanying value.  &n; *&n; * If FB_IGNOREMON bit is set in @flags, monitor specs will be &n; * ignored and @var will be filled with the calculated timings.&n; *&n; * All calculations are based on the VESA GTF Spreadsheet&n; * available at VESA&squot;s public ftp (http://www.vesa.org).&n; * &n; * NOTES:&n; * The timings generated by the GTF will be different from VESA&n; * DMT.  It might be a good idea to keep a table of standard&n; * VESA modes as well.  The GTF may also not work for some displays,&n; * such as, and especially, analog TV.&n; *   &n; * REQUIRES:&n; * A valid info-&gt;monspecs, otherwise &squot;safe numbers&squot; will be used.&n; */
DECL|function|fb_get_mode
r_int
id|fb_get_mode
c_func
(paren
r_int
id|flags
comma
id|u32
id|val
comma
r_struct
id|fb_var_screeninfo
op_star
id|var
comma
r_struct
id|fb_info
op_star
id|info
)paren
(brace
r_struct
id|__fb_timings
id|timings
suffix:semicolon
id|u32
id|interlace
op_assign
l_int|1
comma
id|dscan
op_assign
l_int|1
suffix:semicolon
id|u32
id|hfmin
comma
id|hfmax
comma
id|vfmin
comma
id|vfmax
comma
id|dclkmin
comma
id|dclkmax
suffix:semicolon
multiline_comment|/* &n;&t; * If monspecs are invalid, use values that are enough&n;&t; * for 640x480@60&n;&t; */
r_if
c_cond
(paren
op_logical_neg
id|info-&gt;monspecs.hfmax
op_logical_or
op_logical_neg
id|info-&gt;monspecs.vfmax
op_logical_or
op_logical_neg
id|info-&gt;monspecs.dclkmax
op_logical_or
id|info-&gt;monspecs.hfmax
OL
id|info-&gt;monspecs.hfmin
op_logical_or
id|info-&gt;monspecs.vfmax
OL
id|info-&gt;monspecs.vfmin
op_logical_or
id|info-&gt;monspecs.dclkmax
OL
id|info-&gt;monspecs.dclkmin
)paren
(brace
id|hfmin
op_assign
l_int|29000
suffix:semicolon
id|hfmax
op_assign
l_int|30000
suffix:semicolon
id|vfmin
op_assign
l_int|60
suffix:semicolon
id|vfmax
op_assign
l_int|60
suffix:semicolon
id|dclkmin
op_assign
l_int|0
suffix:semicolon
id|dclkmax
op_assign
l_int|25000000
suffix:semicolon
)brace
r_else
(brace
id|hfmin
op_assign
id|info-&gt;monspecs.hfmin
suffix:semicolon
id|hfmax
op_assign
id|info-&gt;monspecs.hfmax
suffix:semicolon
id|vfmin
op_assign
id|info-&gt;monspecs.vfmin
suffix:semicolon
id|vfmax
op_assign
id|info-&gt;monspecs.vfmax
suffix:semicolon
id|dclkmin
op_assign
id|info-&gt;monspecs.dclkmin
suffix:semicolon
id|dclkmax
op_assign
id|info-&gt;monspecs.dclkmax
suffix:semicolon
)brace
id|memset
c_func
(paren
op_amp
id|timings
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|__fb_timings
)paren
)paren
suffix:semicolon
id|timings.hactive
op_assign
id|var-&gt;xres
suffix:semicolon
id|timings.vactive
op_assign
id|var-&gt;yres
suffix:semicolon
r_if
c_cond
(paren
id|var-&gt;vmode
op_amp
id|FB_VMODE_INTERLACED
)paren
(brace
id|timings.vactive
op_div_assign
l_int|2
suffix:semicolon
id|interlace
op_assign
l_int|2
suffix:semicolon
)brace
r_if
c_cond
(paren
id|var-&gt;vmode
op_amp
id|FB_VMODE_DOUBLE
)paren
(brace
id|timings.vactive
op_mul_assign
l_int|2
suffix:semicolon
id|dscan
op_assign
l_int|2
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|flags
op_amp
op_complement
id|FB_IGNOREMON
)paren
(brace
r_case
id|FB_MAXTIMINGS
suffix:colon
multiline_comment|/* maximize refresh rate */
id|timings.hfreq
op_assign
id|hfmax
suffix:semicolon
id|fb_timings_hfreq
c_func
(paren
op_amp
id|timings
)paren
suffix:semicolon
r_if
c_cond
(paren
id|timings.vfreq
OG
id|vfmax
)paren
(brace
id|timings.vfreq
op_assign
id|vfmax
suffix:semicolon
id|fb_timings_vfreq
c_func
(paren
op_amp
id|timings
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|timings.dclk
OG
id|dclkmax
)paren
(brace
id|timings.dclk
op_assign
id|dclkmax
suffix:semicolon
id|fb_timings_dclk
c_func
(paren
op_amp
id|timings
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|FB_VSYNCTIMINGS
suffix:colon
multiline_comment|/* vrefresh driven */
id|timings.vfreq
op_assign
id|val
suffix:semicolon
id|fb_timings_vfreq
c_func
(paren
op_amp
id|timings
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FB_HSYNCTIMINGS
suffix:colon
multiline_comment|/* hsync driven */
id|timings.hfreq
op_assign
id|val
suffix:semicolon
id|fb_timings_hfreq
c_func
(paren
op_amp
id|timings
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FB_DCLKTIMINGS
suffix:colon
multiline_comment|/* pixelclock driven */
id|timings.dclk
op_assign
id|PICOS2KHZ
c_func
(paren
id|val
)paren
op_star
l_int|1000
suffix:semicolon
id|fb_timings_dclk
c_func
(paren
op_amp
id|timings
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|flags
op_amp
id|FB_IGNOREMON
)paren
op_logical_and
(paren
id|timings.vfreq
template_param
id|vfmax
op_logical_or
id|timings.hfreq
template_param
id|hfmax
op_logical_or
id|timings.dclk
template_param
id|dclkmax
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|var-&gt;pixclock
op_assign
id|KHZ2PICOS
c_func
(paren
id|timings.dclk
op_div
l_int|1000
)paren
suffix:semicolon
id|var-&gt;hsync_len
op_assign
(paren
id|timings.htotal
op_star
l_int|8
)paren
op_div
l_int|100
suffix:semicolon
id|var-&gt;right_margin
op_assign
(paren
id|timings.hblank
op_div
l_int|2
)paren
op_minus
id|var-&gt;hsync_len
suffix:semicolon
id|var-&gt;left_margin
op_assign
id|timings.hblank
op_minus
id|var-&gt;right_margin
op_minus
id|var-&gt;hsync_len
suffix:semicolon
id|var-&gt;vsync_len
op_assign
(paren
l_int|3
op_star
id|interlace
)paren
op_div
id|dscan
suffix:semicolon
id|var-&gt;lower_margin
op_assign
(paren
l_int|1
op_star
id|interlace
)paren
op_div
id|dscan
suffix:semicolon
id|var-&gt;upper_margin
op_assign
(paren
id|timings.vblank
op_star
id|interlace
)paren
op_div
id|dscan
op_minus
(paren
id|var-&gt;vsync_len
op_plus
id|var-&gt;lower_margin
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#else
DECL|function|fb_parse_edid
r_int
id|fb_parse_edid
c_func
(paren
r_int
r_char
op_star
id|edid
comma
r_struct
id|fb_var_screeninfo
op_star
id|var
)paren
(brace
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|fb_edid_to_monspecs
r_void
id|fb_edid_to_monspecs
c_func
(paren
r_int
r_char
op_star
id|edid
comma
r_struct
id|fb_monspecs
op_star
id|specs
)paren
(brace
id|specs
op_assign
l_int|NULL
suffix:semicolon
)brace
DECL|function|get_EDID_from_firmware
r_char
op_star
id|get_EDID_from_firmware
c_func
(paren
r_struct
id|device
op_star
id|dev
)paren
(brace
r_return
l_int|NULL
suffix:semicolon
)brace
DECL|function|fb_create_modedb
r_struct
id|fb_videomode
op_star
id|fb_create_modedb
c_func
(paren
r_int
r_char
op_star
id|edid
comma
r_int
op_star
id|dbsize
)paren
(brace
r_return
l_int|NULL
suffix:semicolon
)brace
DECL|function|fb_destroy_modedb
r_void
id|fb_destroy_modedb
c_func
(paren
r_struct
id|fb_videomode
op_star
id|modedb
)paren
(brace
)brace
DECL|function|fb_get_monitor_limits
r_int
id|fb_get_monitor_limits
c_func
(paren
r_int
r_char
op_star
id|edid
comma
r_struct
id|fb_monspecs
op_star
id|specs
)paren
(brace
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|fb_get_mode
r_int
id|fb_get_mode
c_func
(paren
r_int
id|flags
comma
id|u32
id|val
comma
r_struct
id|fb_var_screeninfo
op_star
id|var
comma
r_struct
id|fb_info
op_star
id|info
)paren
(brace
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
macro_line|#endif /* CONFIG_FB_MODE_HELPERS */
multiline_comment|/*&n; * fb_validate_mode - validates var against monitor capabilities&n; * @var: pointer to fb_var_screeninfo&n; * @info: pointer to fb_info&n; *&n; * DESCRIPTION:&n; * Validates video mode against monitor capabilities specified in&n; * info-&gt;monspecs.&n; *&n; * REQUIRES:&n; * A valid info-&gt;monspecs.&n; */
DECL|function|fb_validate_mode
r_int
id|fb_validate_mode
c_func
(paren
r_const
r_struct
id|fb_var_screeninfo
op_star
id|var
comma
r_struct
id|fb_info
op_star
id|info
)paren
(brace
id|u32
id|hfreq
comma
id|vfreq
comma
id|htotal
comma
id|vtotal
comma
id|pixclock
suffix:semicolon
id|u32
id|hfmin
comma
id|hfmax
comma
id|vfmin
comma
id|vfmax
comma
id|dclkmin
comma
id|dclkmax
suffix:semicolon
multiline_comment|/* &n;&t; * If monspecs are invalid, use values that are enough&n;&t; * for 640x480@60&n;&t; */
r_if
c_cond
(paren
op_logical_neg
id|info-&gt;monspecs.hfmax
op_logical_or
op_logical_neg
id|info-&gt;monspecs.vfmax
op_logical_or
op_logical_neg
id|info-&gt;monspecs.dclkmax
op_logical_or
id|info-&gt;monspecs.hfmax
OL
id|info-&gt;monspecs.hfmin
op_logical_or
id|info-&gt;monspecs.vfmax
OL
id|info-&gt;monspecs.vfmin
op_logical_or
id|info-&gt;monspecs.dclkmax
OL
id|info-&gt;monspecs.dclkmin
)paren
(brace
id|hfmin
op_assign
l_int|29000
suffix:semicolon
id|hfmax
op_assign
l_int|30000
suffix:semicolon
id|vfmin
op_assign
l_int|60
suffix:semicolon
id|vfmax
op_assign
l_int|60
suffix:semicolon
id|dclkmin
op_assign
l_int|0
suffix:semicolon
id|dclkmax
op_assign
l_int|25000000
suffix:semicolon
)brace
r_else
(brace
id|hfmin
op_assign
id|info-&gt;monspecs.hfmin
suffix:semicolon
id|hfmax
op_assign
id|info-&gt;monspecs.hfmax
suffix:semicolon
id|vfmin
op_assign
id|info-&gt;monspecs.vfmin
suffix:semicolon
id|vfmax
op_assign
id|info-&gt;monspecs.vfmax
suffix:semicolon
id|dclkmin
op_assign
id|info-&gt;monspecs.dclkmin
suffix:semicolon
id|dclkmax
op_assign
id|info-&gt;monspecs.dclkmax
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|var-&gt;pixclock
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|pixclock
op_assign
id|PICOS2KHZ
c_func
(paren
id|var-&gt;pixclock
)paren
op_star
l_int|1000
suffix:semicolon
id|htotal
op_assign
id|var-&gt;xres
op_plus
id|var-&gt;right_margin
op_plus
id|var-&gt;hsync_len
op_plus
id|var-&gt;left_margin
suffix:semicolon
id|vtotal
op_assign
id|var-&gt;yres
op_plus
id|var-&gt;lower_margin
op_plus
id|var-&gt;vsync_len
op_plus
id|var-&gt;upper_margin
suffix:semicolon
r_if
c_cond
(paren
id|var-&gt;vmode
op_amp
id|FB_VMODE_INTERLACED
)paren
id|vtotal
op_div_assign
l_int|2
suffix:semicolon
r_if
c_cond
(paren
id|var-&gt;vmode
op_amp
id|FB_VMODE_DOUBLE
)paren
id|vtotal
op_mul_assign
l_int|2
suffix:semicolon
id|hfreq
op_assign
id|pixclock
op_div
id|htotal
suffix:semicolon
id|vfreq
op_assign
id|hfreq
op_div
id|vtotal
suffix:semicolon
r_return
(paren
id|vfreq
template_param
id|vfmax
op_logical_or
id|hfreq
template_param
id|hfmax
op_logical_or
id|pixclock
template_param
id|dclkmax
)paren
ques
c_cond
op_minus
id|EINVAL
suffix:colon
l_int|0
suffix:semicolon
)brace
DECL|variable|fb_parse_edid
id|EXPORT_SYMBOL
c_func
(paren
id|fb_parse_edid
)paren
suffix:semicolon
DECL|variable|fb_edid_to_monspecs
id|EXPORT_SYMBOL
c_func
(paren
id|fb_edid_to_monspecs
)paren
suffix:semicolon
DECL|variable|get_EDID_from_firmware
id|EXPORT_SYMBOL
c_func
(paren
id|get_EDID_from_firmware
)paren
suffix:semicolon
DECL|variable|fb_get_mode
id|EXPORT_SYMBOL
c_func
(paren
id|fb_get_mode
)paren
suffix:semicolon
DECL|variable|fb_validate_mode
id|EXPORT_SYMBOL
c_func
(paren
id|fb_validate_mode
)paren
suffix:semicolon
DECL|variable|fb_create_modedb
id|EXPORT_SYMBOL
c_func
(paren
id|fb_create_modedb
)paren
suffix:semicolon
DECL|variable|fb_destroy_modedb
id|EXPORT_SYMBOL
c_func
(paren
id|fb_destroy_modedb
)paren
suffix:semicolon
DECL|variable|fb_get_monitor_limits
id|EXPORT_SYMBOL
c_func
(paren
id|fb_get_monitor_limits
)paren
suffix:semicolon
eof
