multiline_comment|/* $XFree86: xc/programs/Xserver/hw/xfree86/drivers/sis/init301.c,v 1.3 2002/22/04 01:16:16 dawes Exp $ */
multiline_comment|/*&n; * Mode switching code (CRT2 section) for SiS 300/540/630/730/315/550/650/740&n; * (Universal module for Linux kernel framebuffer, XFree86 4.x)&n; *&n; * Assembler-To-C translation&n; * Parts Copyright 2002 by Thomas Winischhofer &lt;thomas@winischhofer.net&gt;&n; *&n; * Based on BIOS&n; *     1.10.07, 1.10a for SiS650/LVDS+CH7019&n; *     1.07.1b for SiS650/301(B/LV)&n; *     2.04.50 (I) and 2.04.5c (II) for SiS630/301(B)&n; *     2.02.3b, 2.03.02, 2.04.2c and 2.04.5c for 630/LVDS/LVDS+CH7005&n; *     1.09b for 315/301(B)&n; *&n; * Permission to use, copy, modify, distribute, and sell this software and its&n; * documentation for any purpose is hereby granted without fee, provided that&n; * the above copyright notice appear in all copies and that both that&n; * copyright notice and this permission notice appear in supporting&n; * documentation, and that the name of the copyright holder not be used in&n; * advertising or publicity pertaining to distribution of the software without&n; * specific, written prior permission.  The copyright holder makes no representations&n; * about the suitability of this software for any purpose.  It is provided&n; * &quot;as is&quot; without express or implied warranty.&n; *&n; * THE COPYRIGHT HOLDER DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE,&n; * INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS, IN NO&n; * EVENT SHALL THE COPYRIGHT HOLDER BE LIABLE FOR ANY SPECIAL, INDIRECT OR&n; * CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE,&n; * DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER&n; * TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR&n; * PERFORMANCE OF THIS SOFTWARE.&n; *&n; */
macro_line|#include &quot;init301.h&quot;
macro_line|#if 0
mdefine_line|#define TWPANEL
macro_line|#endif
macro_line|#if 0&t;/* TW: Emulate 650/LVDS BIOS 1.10a (1) or 1.10.07 (0) */
mdefine_line|#define TEST1400
macro_line|#endif
macro_line|#ifdef SIS300
macro_line|#include &quot;oem300.h&quot;
macro_line|#endif
macro_line|#ifdef SIS315H
macro_line|#include &quot;oem310.h&quot;
macro_line|#endif
DECL|macro|SiS_I2CDELAY
mdefine_line|#define SiS_I2CDELAY 1000
DECL|macro|SiS_I2CDELAYSHORT
mdefine_line|#define SiS_I2CDELAYSHORT 333
id|BOOLEAN
DECL|function|SiS_SetCRT2Group301
id|SiS_SetCRT2Group301
c_func
(paren
id|USHORT
id|BaseAddr
comma
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
)paren
(brace
id|USHORT
id|ModeIdIndex
suffix:semicolon
id|USHORT
id|RefreshRateTableIndex
suffix:semicolon
id|SiS_SetFlag
op_or_assign
id|ProgrammingCRT2
suffix:semicolon
id|SiS_SearchModeID
c_func
(paren
id|ROMAddr
comma
op_amp
id|ModeNo
comma
op_amp
id|ModeIdIndex
)paren
suffix:semicolon
multiline_comment|/* TW: Used for shifting CR33 */
id|SiS_SelectCRT2Rate
op_assign
l_int|4
suffix:semicolon
id|SiS_UnLockCRT2
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
suffix:semicolon
id|RefreshRateTableIndex
op_assign
id|SiS_GetRatePtrCRT2
c_func
(paren
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
)paren
suffix:semicolon
id|SiS_SaveCRT2Info
c_func
(paren
id|ModeNo
)paren
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LowModeStuff
c_func
(paren
id|ModeNo
comma
id|HwDeviceExtension
)paren
)paren
(brace
id|SiS_DisableBridge
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
suffix:semicolon
id|SiS_SetCRT2ModeRegs
c_func
(paren
id|BaseAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|HwDeviceExtension
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|DisableCRT2Display
)paren
(brace
id|SiS_LockCRT2
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
suffix:semicolon
id|SiS_DisplayOn
c_func
(paren
)paren
suffix:semicolon
r_return
id|FALSE
suffix:semicolon
)brace
id|SiS_GetCRT2Data
c_func
(paren
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|RefreshRateTableIndex
comma
id|HwDeviceExtension
)paren
suffix:semicolon
multiline_comment|/* LVDS, 650/301LV(LCDA) and 630/301B BIOS set up Panel Link */
r_if
c_cond
(paren
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|1
)paren
op_logical_or
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
)paren
(brace
id|SiS_GetLVDSDesData
c_func
(paren
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|RefreshRateTableIndex
comma
id|HwDeviceExtension
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_LowModeStuff
c_func
(paren
id|ModeNo
comma
id|HwDeviceExtension
)paren
)paren
(brace
id|SiS_SetGroup1
c_func
(paren
id|BaseAddr
comma
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|HwDeviceExtension
comma
id|RefreshRateTableIndex
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
op_logical_and
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCDA
)paren
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBType
op_amp
(paren
id|VB_SIS301LV
op_or
id|VB_SIS302LV
)paren
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x24
comma
l_int|0x0e
)paren
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|0
)paren
op_logical_and
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCDA
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
id|SiS_LowModeStuff
c_func
(paren
id|ModeNo
comma
id|HwDeviceExtension
)paren
)paren
(brace
id|SiS_SetGroup2
c_func
(paren
id|BaseAddr
comma
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|RefreshRateTableIndex
comma
id|HwDeviceExtension
)paren
suffix:semicolon
id|SiS_SetGroup3
c_func
(paren
id|BaseAddr
comma
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|HwDeviceExtension
)paren
suffix:semicolon
id|SiS_SetGroup4
c_func
(paren
id|BaseAddr
comma
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|RefreshRateTableIndex
comma
id|HwDeviceExtension
)paren
suffix:semicolon
id|SiS_SetGroup5
c_func
(paren
id|BaseAddr
comma
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
)paren
suffix:semicolon
multiline_comment|/* TW: 630/301B BIOS does all this: */
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCD
)paren
(brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_ne
id|Panel640x480
)paren
(brace
id|SiS_ModCRT1CRTC
c_func
(paren
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|RefreshRateTableIndex
comma
id|HwDeviceExtension
)paren
suffix:semicolon
)brace
id|SiS_SetCRT2ECLK
c_func
(paren
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|RefreshRateTableIndex
comma
id|HwDeviceExtension
)paren
suffix:semicolon
)brace
)brace
)brace
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_ne
id|Panel640x480
)paren
(brace
r_if
c_cond
(paren
id|SiS_IF_DEF_TRUMPION
op_eq
l_int|0
)paren
(brace
id|SiS_ModCRT1CRTC
c_func
(paren
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|RefreshRateTableIndex
comma
id|HwDeviceExtension
)paren
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|SiS_IF_DEF_FSTN
op_eq
l_int|0
)paren
(brace
id|SiS_SetCRT2ECLK
c_func
(paren
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|RefreshRateTableIndex
comma
id|HwDeviceExtension
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_LowModeStuff
c_func
(paren
id|ModeNo
comma
id|HwDeviceExtension
)paren
)paren
(brace
r_if
c_cond
(paren
id|SiS_IF_DEF_CH70xx
op_ne
l_int|0
)paren
(brace
multiline_comment|/* TW: Inserted from 650/LVDS BIOS */
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
(paren
id|SetCRT2ToLCD
op_or
id|SetCRT2ToLCDA
)paren
)paren
(brace
r_if
c_cond
(paren
id|SiS_IF_DEF_CH70xx
op_eq
l_int|2
)paren
(brace
id|SiS_SetCHTVForLCD
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
(brace
multiline_comment|/* TW: Set Chrontel registers only if CRT2 is TV */
id|SiS_SetCHTVReg
c_func
(paren
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|RefreshRateTableIndex
)paren
suffix:semicolon
)brace
)brace
)brace
)brace
macro_line|#ifdef SIS300
r_if
c_cond
(paren
(paren
id|HwDeviceExtension-&gt;jChipType
op_eq
id|SIS_540
)paren
op_logical_or
(paren
id|HwDeviceExtension-&gt;jChipType
op_eq
id|SIS_630
)paren
op_logical_or
(paren
id|HwDeviceExtension-&gt;jChipType
op_eq
id|SIS_730
)paren
op_logical_or
(paren
id|HwDeviceExtension-&gt;jChipType
op_eq
id|SIS_300
)paren
)paren
(brace
r_if
c_cond
(paren
id|SiS_LowModeStuff
c_func
(paren
id|ModeNo
comma
id|HwDeviceExtension
)paren
)paren
(brace
id|SiS_OEM300Setting
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
comma
id|ROMAddr
comma
id|ModeNo
)paren
suffix:semicolon
)brace
)brace
macro_line|#endif
macro_line|#ifdef SIS315H
r_if
c_cond
(paren
(paren
id|HwDeviceExtension-&gt;jChipType
op_eq
id|SIS_315H
)paren
op_logical_or
(paren
id|HwDeviceExtension-&gt;jChipType
op_eq
id|SIS_315PRO
)paren
op_logical_or
(paren
id|HwDeviceExtension-&gt;jChipType
op_eq
id|SIS_550
)paren
op_logical_or
(paren
id|HwDeviceExtension-&gt;jChipType
op_eq
id|SIS_640
)paren
op_logical_or
(paren
id|HwDeviceExtension-&gt;jChipType
op_eq
id|SIS_740
)paren
op_logical_or
(paren
id|HwDeviceExtension-&gt;jChipType
op_eq
id|SIS_650
)paren
)paren
(brace
r_if
c_cond
(paren
id|SiS_LowModeStuff
c_func
(paren
id|ModeNo
comma
id|HwDeviceExtension
)paren
)paren
(brace
id|SiS_OEMLCD
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
comma
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
)paren
suffix:semicolon
id|SiS_OEM310Setting
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
comma
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
)paren
suffix:semicolon
id|SiS_CRT2AutoThreshold
c_func
(paren
id|BaseAddr
)paren
suffix:semicolon
)brace
)brace
macro_line|#endif
r_if
c_cond
(paren
id|SiS_LowModeStuff
c_func
(paren
id|ModeNo
comma
id|HwDeviceExtension
)paren
)paren
(brace
id|SiS_DisplayOn
c_func
(paren
)paren
suffix:semicolon
id|SiS_EnableBridge
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_IF_DEF_CH70xx
op_eq
l_int|1
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
(brace
multiline_comment|/* TW: Disable LCD panel when using TV */
id|SiS_SetRegOR
c_func
(paren
id|SiS_P3c4
comma
l_int|0x11
comma
l_int|0x0C
)paren
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* TW: Disable TV when using LCD */
id|SiS_SetCH70xxANDOR
c_func
(paren
l_int|0x010E
comma
l_int|0xF8
)paren
suffix:semicolon
)brace
)brace
id|SiS_DisplayOn
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LowModeStuff
c_func
(paren
id|ModeNo
comma
id|HwDeviceExtension
)paren
)paren
(brace
id|SiS_LockCRT2
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
suffix:semicolon
)brace
r_return
l_int|1
suffix:semicolon
)brace
multiline_comment|/* TW: Checked with 650/LVDS (1.10.07) and 630+301B/LVDS BIOS */
id|BOOLEAN
DECL|function|SiS_LowModeStuff
id|SiS_LowModeStuff
c_func
(paren
id|USHORT
id|ModeNo
comma
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
)paren
(brace
id|USHORT
id|temp
comma
id|temp1
comma
id|temp2
suffix:semicolon
r_if
c_cond
(paren
(paren
id|ModeNo
op_ne
l_int|0x03
)paren
op_logical_and
(paren
id|ModeNo
op_ne
l_int|0x10
)paren
op_logical_and
(paren
id|ModeNo
op_ne
l_int|0x12
)paren
)paren
(brace
r_return
l_int|1
suffix:semicolon
)brace
id|temp
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x11
)paren
suffix:semicolon
id|SiS_SetRegOR
c_func
(paren
id|SiS_P3d4
comma
l_int|0x11
comma
l_int|0x80
)paren
suffix:semicolon
id|temp1
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x00
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x00
comma
l_int|0x55
)paren
suffix:semicolon
id|temp2
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x00
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x00
comma
id|temp1
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x11
comma
id|temp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
r_if
c_cond
(paren
id|temp2
op_eq
l_int|0x55
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
r_else
r_return
l_int|1
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|temp2
op_ne
l_int|0x55
)paren
(brace
r_return
l_int|1
suffix:semicolon
)brace
r_else
(brace
id|SiS_SetRegOR
c_func
(paren
id|SiS_P3d4
comma
l_int|0x35
comma
l_int|0x01
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
)brace
)brace
multiline_comment|/* TW: Set Part1 registers */
multiline_comment|/* TW: Checked with 650/LVDS (1.10.07), 650/301LV (II) and 630/301B (II) BIOS */
r_void
DECL|function|SiS_SetGroup1
id|SiS_SetGroup1
c_func
(paren
id|USHORT
id|BaseAddr
comma
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
comma
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
comma
id|USHORT
id|RefreshRateTableIndex
)paren
(brace
id|USHORT
id|temp
op_assign
l_int|0
comma
id|tempax
op_assign
l_int|0
comma
id|tempbx
op_assign
l_int|0
comma
id|tempcx
op_assign
l_int|0
comma
id|tempbl
op_assign
l_int|0
suffix:semicolon
id|USHORT
id|pushbx
op_assign
l_int|0
comma
id|CRT1Index
op_assign
l_int|0
suffix:semicolon
id|USHORT
id|modeflag
comma
id|resinfo
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|ModeNo
op_le
l_int|0x13
)paren
(brace
id|modeflag
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_ModeFlag
suffix:semicolon
)brace
r_else
(brace
id|CRT1Index
op_assign
id|SiS_RefIndex
(braket
id|RefreshRateTableIndex
)braket
dot
id|Ext_CRT1CRTC
suffix:semicolon
id|resinfo
op_assign
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|Ext_RESINFO
suffix:semicolon
id|modeflag
op_assign
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|Ext_ModeFlag
suffix:semicolon
)brace
multiline_comment|/* TW: Removed 301B301LV.. check here; LCDA exists with LVDS as well */
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCDA
)paren
(brace
multiline_comment|/* TW: From 650/LVDS BIOS; 301(B+LV) version does not set Sync  */
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|1
)paren
(brace
id|SiS_SetCRT2Sync
c_func
(paren
id|BaseAddr
comma
id|ROMAddr
comma
id|ModeNo
comma
id|RefreshRateTableIndex
comma
id|HwDeviceExtension
)paren
suffix:semicolon
)brace
id|SiS_SetGroup1_LCDA
c_func
(paren
id|BaseAddr
comma
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|HwDeviceExtension
comma
id|RefreshRateTableIndex
)paren
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
op_logical_and
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|1
)paren
op_logical_and
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
)paren
(brace
id|SiS_SetCRT2Sync
c_func
(paren
id|BaseAddr
comma
id|ROMAddr
comma
id|ModeNo
comma
id|RefreshRateTableIndex
comma
id|HwDeviceExtension
)paren
suffix:semicolon
)brace
r_else
(brace
id|SiS_SetCRT2Offset
c_func
(paren
id|SiS_Part1Port
comma
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|RefreshRateTableIndex
comma
id|HwDeviceExtension
)paren
suffix:semicolon
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
macro_line|#ifdef SIS300
id|SiS_SetCRT2FIFO_300
c_func
(paren
id|ROMAddr
comma
id|ModeNo
comma
id|HwDeviceExtension
)paren
suffix:semicolon
macro_line|#endif
)brace
r_else
(brace
macro_line|#ifdef SIS315H
id|SiS_SetCRT2FIFO_310
c_func
(paren
id|ROMAddr
comma
id|ModeNo
comma
id|HwDeviceExtension
)paren
suffix:semicolon
macro_line|#endif
)brace
id|SiS_SetCRT2Sync
c_func
(paren
id|BaseAddr
comma
id|ROMAddr
comma
id|ModeNo
comma
id|RefreshRateTableIndex
comma
id|HwDeviceExtension
)paren
suffix:semicolon
multiline_comment|/* 1. Horizontal setup */
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
multiline_comment|/* ------------- 300 series --------------*/
id|temp
op_assign
(paren
id|SiS_VGAHT
op_minus
l_int|1
)paren
op_amp
l_int|0x0FF
suffix:semicolon
multiline_comment|/* BTVGA2HT 0x08,0x09 */
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x08
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* TW: CRT2 Horizontal Total */
id|temp
op_assign
(paren
(paren
(paren
id|SiS_VGAHT
op_minus
l_int|1
)paren
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
)paren
op_lshift
l_int|4
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x09
comma
l_int|0x0f
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* TW: CRT2 Horizontal Total Overflow [7:4] */
id|temp
op_assign
(paren
id|SiS_VGAHDE
op_plus
l_int|12
)paren
op_amp
l_int|0x0FF
suffix:semicolon
multiline_comment|/* BTVGA2HDEE 0x0A,0x0C */
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x0A
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* TW: CRT2 Horizontal Display Enable End */
id|pushbx
op_assign
id|SiS_VGAHDE
op_plus
l_int|12
suffix:semicolon
multiline_comment|/* bx  BTVGA@HRS 0x0B,0x0C */
id|tempcx
op_assign
(paren
id|SiS_VGAHT
op_minus
id|SiS_VGAHDE
)paren
op_rshift
l_int|2
suffix:semicolon
id|tempbx
op_assign
id|pushbx
op_plus
id|tempcx
suffix:semicolon
id|tempcx
op_lshift_assign
l_int|1
suffix:semicolon
id|tempcx
op_add_assign
id|tempbx
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToRAMDAC
)paren
(brace
id|CRT1Index
op_and_assign
l_int|0x3F
suffix:semicolon
id|tempbx
op_assign
id|SiS_CRT1Table
(braket
id|CRT1Index
)braket
dot
id|CR
(braket
l_int|4
)braket
suffix:semicolon
id|tempbx
op_or_assign
(paren
(paren
id|SiS_CRT1Table
(braket
id|CRT1Index
)braket
dot
id|CR
(braket
l_int|14
)braket
op_amp
l_int|0xC0
)paren
op_lshift
l_int|2
)paren
suffix:semicolon
id|tempbx
op_assign
(paren
id|tempbx
op_minus
l_int|1
)paren
op_lshift
l_int|3
suffix:semicolon
id|tempcx
op_assign
id|SiS_CRT1Table
(braket
id|CRT1Index
)braket
dot
id|CR
(braket
l_int|5
)braket
suffix:semicolon
id|tempcx
op_and_assign
l_int|0x1F
suffix:semicolon
id|temp
op_assign
id|SiS_CRT1Table
(braket
id|CRT1Index
)braket
dot
id|CR
(braket
l_int|15
)braket
suffix:semicolon
id|temp
op_assign
(paren
id|temp
op_amp
l_int|0x04
)paren
op_lshift
(paren
l_int|6
op_minus
l_int|2
)paren
suffix:semicolon
id|tempcx
op_assign
(paren
(paren
id|tempcx
op_or
id|temp
)paren
op_minus
l_int|1
)paren
op_lshift
l_int|3
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
op_logical_and
(paren
id|resinfo
op_eq
l_int|0x08
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetPALTV
)paren
)paren
(brace
id|tempbx
op_assign
l_int|1040
suffix:semicolon
id|tempcx
op_assign
l_int|1042
suffix:semicolon
)brace
)brace
)brace
id|temp
op_assign
id|tempbx
op_amp
l_int|0x00FF
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x0B
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* TW: CRT2 Horizontal Retrace Start */
)brace
r_else
(brace
multiline_comment|/* ---------------------- 310 series ------------------*/
multiline_comment|/* (BIOS label Gr1_301) */
r_if
c_cond
(paren
id|modeflag
op_amp
id|HalfDCLK
)paren
(brace
multiline_comment|/* for low resolution modes */
id|temp
op_assign
(paren
(paren
id|SiS_VGAHT
op_div
l_int|2
)paren
op_minus
l_int|1
)paren
op_amp
l_int|0xFF
suffix:semicolon
multiline_comment|/* BTVGA2HT 0x08,0x09 */
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x08
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* TW: CRT2 Horizontal Total */
id|temp
op_assign
(paren
(paren
(paren
(paren
id|SiS_VGAHT
op_div
l_int|2
)paren
op_minus
l_int|1
)paren
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
)paren
op_lshift
l_int|4
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x09
comma
l_int|0x0F
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* TW: CRT2 Horizontal Total Overflow [7:4] */
id|temp
op_assign
(paren
(paren
id|SiS_VGAHDE
op_div
l_int|2
)paren
op_plus
l_int|16
)paren
op_amp
l_int|0xFF
suffix:semicolon
multiline_comment|/* BTVGA2HDEE 0x0A,0x0C */
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x0A
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* TW: CRT2 Horizontal Display Enable End */
id|pushbx
op_assign
(paren
id|SiS_VGAHDE
op_div
l_int|2
)paren
op_plus
l_int|16
suffix:semicolon
id|tempcx
op_assign
(paren
(paren
id|SiS_VGAHT
op_minus
id|SiS_VGAHDE
)paren
op_div
l_int|2
)paren
op_rshift
l_int|2
suffix:semicolon
multiline_comment|/* cx */
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|1
)paren
(brace
id|tempcx
op_rshift_assign
l_int|1
suffix:semicolon
)brace
multiline_comment|/* TW: From LVDS 1.10.07; not done on 301(LV) */
id|tempbx
op_assign
id|pushbx
op_plus
id|tempcx
suffix:semicolon
multiline_comment|/* bx  BTVGA@HRS 0x0B,0x0C */
id|tempcx
op_add_assign
id|tempbx
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToRAMDAC
)paren
(brace
id|tempbx
op_assign
id|SiS_CRT1Table
(braket
id|CRT1Index
)braket
dot
id|CR
(braket
l_int|4
)braket
suffix:semicolon
id|tempbx
op_or_assign
(paren
(paren
id|SiS_CRT1Table
(braket
id|CRT1Index
)braket
dot
id|CR
(braket
l_int|14
)braket
op_amp
l_int|0xC0
)paren
op_lshift
l_int|2
)paren
suffix:semicolon
id|tempbx
op_assign
(paren
id|tempbx
op_minus
l_int|3
)paren
op_lshift
l_int|3
suffix:semicolon
multiline_comment|/*(VGAHRS-3)*8 */
id|tempcx
op_assign
id|SiS_CRT1Table
(braket
id|CRT1Index
)braket
dot
id|CR
(braket
l_int|5
)braket
suffix:semicolon
id|tempcx
op_and_assign
l_int|0x1F
suffix:semicolon
id|temp
op_assign
id|SiS_CRT1Table
(braket
id|CRT1Index
)braket
dot
id|CR
(braket
l_int|15
)braket
suffix:semicolon
id|temp
op_assign
(paren
id|temp
op_amp
l_int|0x04
)paren
op_lshift
(paren
l_int|5
op_minus
l_int|2
)paren
suffix:semicolon
multiline_comment|/* VGAHRE D[5]  */
id|tempcx
op_assign
(paren
(paren
id|tempcx
op_or
id|temp
)paren
op_minus
l_int|3
)paren
op_lshift
l_int|3
suffix:semicolon
multiline_comment|/* (VGAHRE-3)*8 */
)brace
multiline_comment|/* TW: The following is not done in 650/LVDS BIOS  */
id|tempbx
op_add_assign
l_int|4
suffix:semicolon
id|tempcx
op_add_assign
l_int|4
suffix:semicolon
r_if
c_cond
(paren
id|tempcx
OG
(paren
id|SiS_VGAHT
op_div
l_int|2
)paren
)paren
id|tempcx
op_assign
id|SiS_VGAHT
op_div
l_int|2
suffix:semicolon
)brace
id|temp
op_assign
id|tempbx
op_amp
l_int|0x00FF
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x0B
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* TW: CRT2 Horizontal Retrace Start */
)brace
r_else
(brace
multiline_comment|/* for high resolution modes */
id|temp
op_assign
(paren
id|SiS_VGAHT
op_minus
l_int|1
)paren
op_amp
l_int|0xFF
suffix:semicolon
multiline_comment|/* BTVGA2HT 0x08,0x09 */
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x08
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* TW: CRT2 Horizontal Total */
id|temp
op_assign
(paren
(paren
(paren
id|SiS_VGAHT
op_minus
l_int|1
)paren
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
)paren
op_lshift
l_int|4
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x09
comma
l_int|0x0F
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* TW: CRT2 Horizontal Total Overflow [7:4] */
id|temp
op_assign
(paren
id|SiS_VGAHDE
op_plus
l_int|16
)paren
op_amp
l_int|0xFF
suffix:semicolon
multiline_comment|/* BTVGA2HDEE 0x0A,0x0C */
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x0A
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* TW: CRT2 Horizontal Display Enable End */
id|pushbx
op_assign
id|SiS_VGAHDE
op_plus
l_int|16
suffix:semicolon
id|tempcx
op_assign
(paren
id|SiS_VGAHT
op_minus
id|SiS_VGAHDE
)paren
op_rshift
l_int|2
suffix:semicolon
multiline_comment|/* cx */
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|1
)paren
(brace
id|tempcx
op_rshift_assign
l_int|1
suffix:semicolon
)brace
multiline_comment|/* TW: From LVDS 1.10.07; not done on 301(LV) */
id|tempbx
op_assign
id|pushbx
op_plus
id|tempcx
suffix:semicolon
multiline_comment|/* bx  BTVGA@HRS 0x0B,0x0C */
id|tempcx
op_add_assign
id|tempbx
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToRAMDAC
)paren
(brace
id|tempbx
op_assign
id|SiS_CRT1Table
(braket
id|CRT1Index
)braket
dot
id|CR
(braket
l_int|4
)braket
suffix:semicolon
id|tempbx
op_or_assign
(paren
(paren
id|SiS_CRT1Table
(braket
id|CRT1Index
)braket
dot
id|CR
(braket
l_int|14
)braket
op_amp
l_int|0xC0
)paren
op_lshift
l_int|2
)paren
suffix:semicolon
id|tempbx
op_assign
(paren
id|tempbx
op_minus
l_int|3
)paren
op_lshift
l_int|3
suffix:semicolon
multiline_comment|/*(VGAHRS-3)*8 */
id|tempcx
op_assign
id|SiS_CRT1Table
(braket
id|CRT1Index
)braket
dot
id|CR
(braket
l_int|5
)braket
suffix:semicolon
id|tempcx
op_and_assign
l_int|0x1F
suffix:semicolon
id|temp
op_assign
id|SiS_CRT1Table
(braket
id|CRT1Index
)braket
dot
id|CR
(braket
l_int|15
)braket
suffix:semicolon
id|temp
op_assign
(paren
id|temp
op_amp
l_int|0x04
)paren
op_lshift
(paren
l_int|5
op_minus
l_int|2
)paren
suffix:semicolon
multiline_comment|/* VGAHRE D[5] */
id|tempcx
op_assign
(paren
(paren
id|tempcx
op_or
id|temp
)paren
op_minus
l_int|3
)paren
op_lshift
l_int|3
suffix:semicolon
multiline_comment|/* (VGAHRE-3)*8 */
id|tempbx
op_add_assign
l_int|16
suffix:semicolon
id|tempcx
op_add_assign
l_int|16
suffix:semicolon
)brace
multiline_comment|/* TW: The entire following section is not done in 650/LVDS BIOS */
r_if
c_cond
(paren
id|tempcx
OG
id|SiS_VGAHT
)paren
id|tempcx
op_assign
id|SiS_VGAHT
suffix:semicolon
r_if
c_cond
(paren
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
op_logical_and
(paren
id|resinfo
op_eq
l_int|0x08
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetPALTV
)paren
)paren
(brace
id|tempbx
op_assign
l_int|1040
suffix:semicolon
id|tempcx
op_assign
l_int|1042
suffix:semicolon
)brace
)brace
)brace
id|temp
op_assign
id|tempbx
op_amp
l_int|0x00FF
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x0B
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* TW: CRT2 Horizontal Retrace Start */
)brace
multiline_comment|/* halfdclk */
)brace
multiline_comment|/* 310 series */
multiline_comment|/* TW: The following is done for all bridge/chip types/series */
id|tempax
op_assign
id|tempbx
op_amp
l_int|0xFF00
suffix:semicolon
id|tempbx
op_assign
id|pushbx
suffix:semicolon
id|tempbx
op_assign
(paren
id|tempbx
op_amp
l_int|0x00FF
)paren
op_or
(paren
(paren
id|tempbx
op_amp
l_int|0xFF00
)paren
op_lshift
l_int|4
)paren
suffix:semicolon
id|tempax
op_or_assign
(paren
id|tempbx
op_amp
l_int|0xFF00
)paren
suffix:semicolon
id|temp
op_assign
(paren
id|tempax
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x0C
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* TW: Overflow */
id|temp
op_assign
id|tempcx
op_amp
l_int|0x00FF
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x0D
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* TW: CRT2 Horizontal Retrace End */
multiline_comment|/* 2. Vertical setup */
id|tempcx
op_assign
id|SiS_VGAVT
op_minus
l_int|1
suffix:semicolon
id|temp
op_assign
id|tempcx
op_amp
l_int|0x00FF
suffix:semicolon
multiline_comment|/* TW: Matches 650/301LV, 650/LVDS, 630/LVDS(CLEVO), 630/LVDS(no-Ch7005) */
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|1
)paren
(brace
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
r_if
c_cond
(paren
id|SiS_IF_DEF_CH70xx
op_ne
l_int|0
)paren
(brace
macro_line|#ifndef TWPANEL
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
(paren
id|SetCRT2ToSVIDEO
op_or
id|SetCRT2ToAVIDEO
)paren
)paren
(brace
id|temp
op_decrement
suffix:semicolon
)brace
macro_line|#else
id|temp
op_decrement
suffix:semicolon
macro_line|#endif
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|SiS_IF_DEF_CH70xx
op_ne
l_int|0
)paren
(brace
id|temp
op_decrement
suffix:semicolon
)brace
)brace
)brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x0E
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* TW: CRT2 Vertical Total */
id|tempbx
op_assign
id|SiS_VGAVDE
op_minus
l_int|1
suffix:semicolon
id|temp
op_assign
id|tempbx
op_amp
l_int|0x00FF
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x0F
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* TW: CRT2 Vertical Display Enable End */
id|temp
op_assign
(paren
(paren
id|tempbx
op_amp
l_int|0xFF00
)paren
op_lshift
l_int|3
)paren
op_rshift
l_int|8
suffix:semicolon
id|temp
op_or_assign
(paren
(paren
id|tempcx
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x12
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* TW: Overflow (and HWCursor Test Mode) */
multiline_comment|/* TW: For 650/LVDS */
r_if
c_cond
(paren
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
op_logical_and
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|1
)paren
)paren
(brace
id|tempbx
op_increment
suffix:semicolon
id|tempax
op_assign
id|tempbx
suffix:semicolon
id|tempcx
op_increment
suffix:semicolon
id|tempcx
op_assign
id|tempcx
op_minus
id|tempax
suffix:semicolon
id|tempcx
op_rshift_assign
l_int|2
suffix:semicolon
id|tempbx
op_assign
id|tempbx
op_plus
id|tempcx
suffix:semicolon
r_if
c_cond
(paren
id|tempcx
OL
l_int|4
)paren
(brace
id|tempcx
op_assign
l_int|4
suffix:semicolon
)brace
id|tempcx
op_rshift_assign
l_int|2
suffix:semicolon
id|tempcx
op_assign
id|tempcx
op_plus
id|tempbx
suffix:semicolon
id|tempcx
op_increment
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* TW: For 630/LVDS/301B and 650/301LV: */
id|tempbx
op_assign
(paren
id|SiS_VGAVT
op_plus
id|SiS_VGAVDE
)paren
op_rshift
l_int|1
suffix:semicolon
multiline_comment|/*  BTVGA2VRS     0x10,0x11   */
id|tempcx
op_assign
(paren
(paren
id|SiS_VGAVT
op_minus
id|SiS_VGAVDE
)paren
op_rshift
l_int|4
)paren
op_plus
id|tempbx
op_plus
l_int|1
suffix:semicolon
multiline_comment|/*  BTVGA2VRE     0x11        */
)brace
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToRAMDAC
)paren
(brace
id|tempbx
op_assign
id|SiS_CRT1Table
(braket
id|CRT1Index
)braket
dot
id|CR
(braket
l_int|8
)braket
suffix:semicolon
id|temp
op_assign
id|SiS_CRT1Table
(braket
id|CRT1Index
)braket
dot
id|CR
(braket
l_int|7
)braket
suffix:semicolon
r_if
c_cond
(paren
id|temp
op_amp
l_int|0x04
)paren
(brace
id|tempbx
op_or_assign
l_int|0x0100
suffix:semicolon
)brace
r_if
c_cond
(paren
id|temp
op_amp
l_int|0x80
)paren
(brace
id|tempbx
op_or_assign
l_int|0x0200
suffix:semicolon
)brace
id|temp
op_assign
id|SiS_CRT1Table
(braket
id|CRT1Index
)braket
dot
id|CR
(braket
l_int|13
)braket
suffix:semicolon
r_if
c_cond
(paren
id|temp
op_amp
l_int|0x08
)paren
(brace
id|tempbx
op_or_assign
l_int|0x0400
suffix:semicolon
)brace
id|temp
op_assign
id|SiS_CRT1Table
(braket
id|CRT1Index
)braket
dot
id|CR
(braket
l_int|9
)braket
suffix:semicolon
id|tempcx
op_assign
(paren
id|tempcx
op_amp
l_int|0xFF00
)paren
op_or
(paren
id|temp
op_amp
l_int|0x00FF
)paren
suffix:semicolon
)brace
)brace
id|temp
op_assign
id|tempbx
op_amp
l_int|0x00FF
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x10
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* TW: CRT2 Vertical Retrace Start */
id|temp
op_assign
(paren
(paren
id|tempbx
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
)paren
op_lshift
l_int|4
suffix:semicolon
id|temp
op_or_assign
(paren
id|tempcx
op_amp
l_int|0x000F
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x11
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* TW: CRT2 Vert. Retrace End; Overflow; &quot;Enable CRTC Check&quot; */
multiline_comment|/* 3. Paneldelay */
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
multiline_comment|/* ---------- 300 series -------------- */
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|0
)paren
(brace
id|temp
op_assign
l_int|0x20
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1280x960
)paren
(brace
id|temp
op_assign
l_int|0x24
suffix:semicolon
)brace
multiline_comment|/* TW: Not in 630/301B BIOS */
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
(brace
id|temp
op_assign
l_int|0x08
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToHiVisionTV
)paren
(brace
multiline_comment|/* TW: Not in 630/301B BIOS */
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
(brace
id|temp
op_assign
l_int|0x2c
suffix:semicolon
)brace
multiline_comment|/* TW: Not in 630/301B BIOS */
r_else
id|temp
op_assign
l_int|0x20
suffix:semicolon
multiline_comment|/* TW: Not in 630/301B BIOS */
)brace
r_if
c_cond
(paren
(paren
id|ROMAddr
)paren
op_logical_and
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
)paren
(brace
r_if
c_cond
(paren
id|ROMAddr
(braket
l_int|0x220
)braket
op_amp
l_int|0x80
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
(paren
id|SetCRT2ToTV
op_minus
id|SetCRT2ToHiVisionTV
)paren
)paren
(brace
id|temp
op_assign
id|ROMAddr
(braket
l_int|0x221
)braket
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToHiVisionTV
)paren
(brace
id|temp
op_assign
id|ROMAddr
(braket
l_int|0x222
)braket
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1280x1024
)paren
(brace
id|temp
op_assign
id|ROMAddr
(braket
l_int|0x223
)braket
suffix:semicolon
)brace
r_else
id|temp
op_assign
id|ROMAddr
(braket
l_int|0x224
)braket
suffix:semicolon
id|temp
op_and_assign
l_int|0x3c
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;pdc
)paren
(brace
id|temp
op_assign
id|HwDeviceExtension-&gt;pdc
op_amp
l_int|0x3c
suffix:semicolon
)brace
)brace
r_else
(brace
id|temp
op_assign
l_int|0x20
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel640x480
)paren
(brace
id|temp
op_assign
l_int|0x04
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ROMAddr
)paren
(brace
r_if
c_cond
(paren
id|ROMAddr
(braket
l_int|0x220
)braket
op_amp
l_int|0x80
)paren
(brace
id|temp
op_assign
id|ROMAddr
(braket
l_int|0x220
)braket
op_amp
l_int|0x3c
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;pdc
)paren
(brace
id|temp
op_assign
id|HwDeviceExtension-&gt;pdc
op_amp
l_int|0x3c
suffix:semicolon
)brace
)brace
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x13
comma
op_complement
l_int|0x03C
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* TW: Panel Link Delay Compensation; (Software Command Reset; Power Saving) */
multiline_comment|/* TW: This register will be adapted according to LCD&n;&t;    *     panel type later in the OEM setup functions.&n;&t;    *     (Various panel types require a different delay&n;&t;    *     such as Clevo 2202; however, on most panels,&n;&t;    *     0x20 does nicely.)&n;&t;    */
)brace
r_else
(brace
multiline_comment|/* ----------- 310/325 series ---------------*/
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|0
)paren
(brace
id|temp
op_assign
l_int|0x10
suffix:semicolon
multiline_comment|/* TW: Modified (650/301 BIOS) */
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1024x768
)paren
(brace
id|temp
op_assign
l_int|0x2c
suffix:semicolon
)brace
multiline_comment|/* TW: Modified (650/301 BIOS) */
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1280x1024
)paren
(brace
id|temp
op_assign
l_int|0x20
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1280x960
)paren
(brace
id|temp
op_assign
l_int|0x24
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToHiVisionTV
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
(brace
id|temp
op_assign
l_int|0x2c
suffix:semicolon
)brace
r_else
id|temp
op_assign
l_int|0x20
suffix:semicolon
)brace
id|tempbl
op_assign
l_int|0xF0
suffix:semicolon
)brace
r_else
(brace
id|temp
op_assign
l_int|0x00
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
(brace
id|temp
op_assign
l_int|0x0a
suffix:semicolon
)brace
id|tempbl
op_assign
l_int|0xF0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
)paren
(brace
id|tempbl
op_assign
l_int|0x0F
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|0
)paren
(brace
id|temp
op_rshift_assign
l_int|2
suffix:semicolon
multiline_comment|/* TW: Only in 650/301LV BIOS */
)brace
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x2D
comma
id|tempbl
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* TW: Panel Link Delay Compensation */
multiline_comment|/* TW: This register will be adapted according to LCD&n;&t;    *     panel type later in the OEM setup functions.&n;&t;    *     (Various panel types require a different delay)&n;&t;    */
id|tempax
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|modeflag
op_amp
id|DoubleScanMode
)paren
id|tempax
op_or_assign
l_int|0x80
suffix:semicolon
r_if
c_cond
(paren
id|modeflag
op_amp
id|HalfDCLK
)paren
id|tempax
op_or_assign
l_int|0x40
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x2C
comma
l_int|0x3f
comma
id|tempax
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/* Slavemode */
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|0
)paren
(brace
multiline_comment|/* TW: 630/301B BIOS sets up Panel Link, too! (650/LV does not) */
r_if
c_cond
(paren
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
op_logical_and
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCD
)paren
op_logical_and
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
)paren
(brace
id|SiS_SetGroup1_LVDS
c_func
(paren
id|BaseAddr
comma
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|HwDeviceExtension
comma
id|RefreshRateTableIndex
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
(brace
multiline_comment|/* Inserted (650/301 BIOS) */
id|SiS_SetGroup1_301
c_func
(paren
id|BaseAddr
comma
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|HwDeviceExtension
comma
id|RefreshRateTableIndex
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
id|SiS_SetGroup1_LVDS
c_func
(paren
id|BaseAddr
comma
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|HwDeviceExtension
comma
id|RefreshRateTableIndex
)paren
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* TW: For 650/LVDS */
r_if
c_cond
(paren
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
)paren
op_logical_or
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
)paren
(brace
id|SiS_SetGroup1_LVDS
c_func
(paren
id|BaseAddr
comma
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|HwDeviceExtension
comma
id|RefreshRateTableIndex
)paren
suffix:semicolon
)brace
)brace
)brace
)brace
multiline_comment|/* LCDA */
)brace
multiline_comment|/* TW: Checked against 650/301LV and 630/301B (II) BIOS */
r_void
DECL|function|SiS_SetGroup1_301
id|SiS_SetGroup1_301
c_func
(paren
id|USHORT
id|BaseAddr
comma
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
comma
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
comma
id|USHORT
id|RefreshRateTableIndex
)paren
(brace
id|USHORT
id|push1
comma
id|push2
suffix:semicolon
id|USHORT
id|tempax
comma
id|tempbx
comma
id|tempcx
comma
id|temp
suffix:semicolon
id|USHORT
id|resinfo
comma
id|modeflag
suffix:semicolon
r_if
c_cond
(paren
id|ModeNo
op_le
l_int|0x13
)paren
(brace
id|modeflag
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_ModeFlag
suffix:semicolon
id|resinfo
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_ResInfo
suffix:semicolon
)brace
r_else
(brace
id|modeflag
op_assign
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|Ext_ModeFlag
suffix:semicolon
id|resinfo
op_assign
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|Ext_RESINFO
suffix:semicolon
)brace
multiline_comment|/* TW: The following is only done if bridge is in slave mode: */
id|tempax
op_assign
l_int|0xFFFF
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
)paren
(brace
id|tempax
op_assign
id|SiS_GetVGAHT2
c_func
(paren
)paren
suffix:semicolon
)brace
multiline_comment|/* TW: 630/301B does not check this flag, assumes it is set */
multiline_comment|/*     650/LV BIOS does not check this either; so we set it... */
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
(brace
id|modeflag
op_or_assign
id|Charx8Dot
suffix:semicolon
)brace
r_if
c_cond
(paren
id|modeflag
op_amp
id|Charx8Dot
)paren
(brace
id|tempcx
op_assign
l_int|0x08
suffix:semicolon
)brace
r_else
id|tempcx
op_assign
l_int|0x09
suffix:semicolon
r_if
c_cond
(paren
id|tempax
op_ge
id|SiS_VGAHT
)paren
(brace
id|tempax
op_assign
id|SiS_VGAHT
suffix:semicolon
)brace
r_if
c_cond
(paren
id|modeflag
op_amp
id|HalfDCLK
)paren
(brace
id|tempax
op_rshift_assign
l_int|1
suffix:semicolon
)brace
id|tempax
op_assign
(paren
id|tempax
op_div
id|tempcx
)paren
op_minus
l_int|5
suffix:semicolon
id|tempbx
op_assign
id|tempax
op_amp
l_int|0xFF
suffix:semicolon
id|temp
op_assign
l_int|0xFF
suffix:semicolon
multiline_comment|/* set MAX HT */
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x03
comma
id|temp
)paren
suffix:semicolon
id|tempax
op_assign
id|SiS_VGAHDE
suffix:semicolon
multiline_comment|/* 0x04 Horizontal Display End */
r_if
c_cond
(paren
id|modeflag
op_amp
id|HalfDCLK
)paren
(brace
id|tempax
op_rshift_assign
l_int|1
suffix:semicolon
)brace
id|tempax
op_assign
(paren
id|tempax
op_div
id|tempcx
)paren
op_minus
l_int|1
suffix:semicolon
id|tempbx
op_or_assign
(paren
(paren
id|tempax
op_amp
l_int|0x00FF
)paren
op_lshift
l_int|8
)paren
suffix:semicolon
id|temp
op_assign
id|tempax
op_amp
l_int|0xFF
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x04
comma
id|temp
)paren
suffix:semicolon
id|temp
op_assign
(paren
id|tempbx
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
)paren
(brace
multiline_comment|/* TW: Inserted from 650/301, 630/301 BIOS */
id|temp
op_add_assign
l_int|2
suffix:semicolon
)brace
multiline_comment|/* TW: Inserted from 650/301, 630/301 BIOS */
macro_line|#ifdef oldHV
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToHiVisionTV
)paren
(brace
r_if
c_cond
(paren
id|resinfo
op_eq
l_int|7
)paren
(brace
id|temp
op_sub_assign
l_int|2
suffix:semicolon
)brace
)brace
macro_line|#endif
)brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x05
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* 0x05 Horizontal Display Start */
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x06
comma
l_int|0x03
)paren
suffix:semicolon
multiline_comment|/* 0x06 Horizontal Blank end     */
macro_line|#ifdef oldHV
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToHiVisionTV
)paren
(brace
id|temp
op_assign
(paren
id|tempbx
op_amp
l_int|0x00FF
)paren
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|modeflag
op_amp
id|HalfDCLK
)paren
)paren
(brace
id|temp
op_sub_assign
l_int|6
suffix:semicolon
r_if
c_cond
(paren
id|SiS_SetFlag
op_amp
id|TVSimuMode
)paren
(brace
id|temp
op_sub_assign
l_int|2
suffix:semicolon
multiline_comment|/* Modified according to 650/301 BIOS; was 4 */
r_if
c_cond
(paren
id|ModeNo
OG
l_int|0x13
)paren
(brace
id|temp
op_sub_assign
l_int|10
suffix:semicolon
)brace
)brace
)brace
)brace
r_else
(brace
macro_line|#endif
id|tempcx
op_assign
id|tempbx
op_amp
l_int|0x00FF
suffix:semicolon
id|tempbx
op_assign
(paren
id|tempbx
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
suffix:semicolon
id|tempcx
op_assign
(paren
id|tempcx
op_plus
id|tempbx
)paren
op_rshift
l_int|1
suffix:semicolon
id|temp
op_assign
(paren
id|tempcx
op_amp
l_int|0x00FF
)paren
op_plus
l_int|2
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
(brace
id|temp
op_decrement
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|modeflag
op_amp
id|HalfDCLK
)paren
)paren
(brace
r_if
c_cond
(paren
(paren
id|modeflag
op_amp
id|Charx8Dot
)paren
)paren
(brace
id|temp
op_add_assign
l_int|4
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VGAHDE
op_ge
l_int|800
)paren
(brace
id|temp
op_sub_assign
l_int|6
suffix:semicolon
)brace
multiline_comment|/* TW: Inserted from 650/301 BIOS, 630/301B/301 don&squot;t do this */
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
r_if
c_cond
(paren
id|SiS_VGAHDE
op_eq
l_int|800
)paren
(brace
id|temp
op_add_assign
l_int|2
suffix:semicolon
)brace
)brace
)brace
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|modeflag
op_amp
id|HalfDCLK
)paren
)paren
(brace
id|temp
op_sub_assign
l_int|4
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_ne
id|Panel1280x960
)paren
(brace
r_if
c_cond
(paren
id|SiS_VGAHDE
op_ge
l_int|800
)paren
(brace
id|temp
op_sub_assign
l_int|7
suffix:semicolon
r_if
c_cond
(paren
id|SiS_ModeType
op_eq
id|ModeEGA
)paren
(brace
multiline_comment|/* 650/301LV does not do this */
r_if
c_cond
(paren
id|SiS_VGAVDE
op_eq
l_int|1024
)paren
(brace
multiline_comment|/* 650/301LV does not do this */
id|temp
op_add_assign
l_int|15
suffix:semicolon
multiline_comment|/* 650/301LV does not do this */
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_ne
id|Panel1280x1024
)paren
(brace
id|temp
op_add_assign
l_int|7
suffix:semicolon
)brace
multiline_comment|/* 650/301LV does not do this */
)brace
)brace
r_if
c_cond
(paren
id|SiS_VGAHDE
op_ge
l_int|1280
)paren
(brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_ne
id|Panel1280x960
)paren
(brace
r_if
c_cond
(paren
id|SiS_LCDInfo
op_amp
id|LCDNonExpanding
)paren
(brace
id|temp
op_add_assign
l_int|28
suffix:semicolon
)brace
)brace
)brace
)brace
)brace
)brace
)brace
macro_line|#ifdef oldHV
)brace
macro_line|#endif
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x07
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* 0x07 Horizontal Retrace Start */
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x08
comma
l_int|0x00
)paren
suffix:semicolon
multiline_comment|/* 0x08 Horizontal Retrace End   */
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
(brace
r_if
c_cond
(paren
id|SiS_SetFlag
op_amp
id|TVSimuMode
)paren
(brace
r_if
c_cond
(paren
(paren
id|ModeNo
op_eq
l_int|0x06
)paren
op_logical_or
(paren
id|ModeNo
op_eq
l_int|0x10
)paren
op_logical_or
(paren
id|ModeNo
op_eq
l_int|0x11
)paren
op_logical_or
(paren
id|ModeNo
op_eq
l_int|0x13
)paren
op_logical_or
(paren
id|ModeNo
op_eq
l_int|0x0F
)paren
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x07
comma
l_int|0x5b
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x08
comma
l_int|0x03
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|ModeNo
op_eq
l_int|0x00
)paren
op_logical_or
(paren
id|ModeNo
op_eq
l_int|0x01
)paren
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetNTSCTV
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x07
comma
l_int|0x2A
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x08
comma
l_int|0x61
)paren
suffix:semicolon
)brace
r_else
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x07
comma
l_int|0x2A
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x08
comma
l_int|0x41
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x0C
comma
l_int|0xF0
)paren
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
(paren
id|ModeNo
op_eq
l_int|0x02
)paren
op_logical_or
(paren
id|ModeNo
op_eq
l_int|0x03
)paren
op_logical_or
(paren
id|ModeNo
op_eq
l_int|0x07
)paren
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetNTSCTV
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x07
comma
l_int|0x54
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x08
comma
l_int|0x00
)paren
suffix:semicolon
)brace
r_else
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x07
comma
l_int|0x55
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x08
comma
l_int|0x00
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x0C
comma
l_int|0xF0
)paren
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
(paren
id|ModeNo
op_eq
l_int|0x04
)paren
op_logical_or
(paren
id|ModeNo
op_eq
l_int|0x05
)paren
op_logical_or
(paren
id|ModeNo
op_eq
l_int|0x0D
)paren
op_logical_or
(paren
id|ModeNo
op_eq
l_int|0x50
)paren
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetNTSCTV
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x07
comma
l_int|0x30
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x08
comma
l_int|0x03
)paren
suffix:semicolon
)brace
r_else
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x07
comma
l_int|0x2f
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x08
comma
l_int|0x02
)paren
suffix:semicolon
)brace
)brace
)brace
)brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x18
comma
l_int|0x03
)paren
suffix:semicolon
multiline_comment|/* 0x18 SR08    */
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x19
comma
l_int|0xF0
comma
l_int|0x00
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x09
comma
l_int|0xFF
)paren
suffix:semicolon
multiline_comment|/* 0x09 Set Max VT    */
id|tempbx
op_assign
id|SiS_VGAVT
suffix:semicolon
id|push1
op_assign
id|tempbx
suffix:semicolon
id|tempcx
op_assign
l_int|0x121
suffix:semicolon
id|tempbx
op_assign
id|SiS_VGAVDE
suffix:semicolon
multiline_comment|/* 0x0E Vertical Display End */
r_if
c_cond
(paren
id|tempbx
op_eq
l_int|357
)paren
(brace
id|tempbx
op_assign
l_int|350
suffix:semicolon
)brace
r_if
c_cond
(paren
id|tempbx
op_eq
l_int|360
)paren
(brace
id|tempbx
op_assign
l_int|350
suffix:semicolon
)brace
r_if
c_cond
(paren
id|tempbx
op_eq
l_int|375
)paren
(brace
id|tempbx
op_assign
l_int|350
suffix:semicolon
)brace
r_if
c_cond
(paren
id|tempbx
op_eq
l_int|405
)paren
(brace
id|tempbx
op_assign
l_int|400
suffix:semicolon
)brace
r_if
c_cond
(paren
id|tempbx
op_eq
l_int|420
)paren
(brace
id|tempbx
op_assign
l_int|400
suffix:semicolon
)brace
r_if
c_cond
(paren
id|tempbx
op_eq
l_int|525
)paren
(brace
id|tempbx
op_assign
l_int|480
suffix:semicolon
)brace
id|push2
op_assign
id|tempbx
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCD
)paren
(brace
multiline_comment|/* TW: Entire if statement not in 630/301 BIOS */
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1024x768
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_SetFlag
op_amp
id|LCDVESATiming
)paren
)paren
(brace
r_if
c_cond
(paren
id|tempbx
op_eq
l_int|350
)paren
(brace
id|tempbx
op_add_assign
l_int|5
suffix:semicolon
)brace
r_if
c_cond
(paren
id|tempbx
op_eq
l_int|480
)paren
(brace
id|tempbx
op_add_assign
l_int|5
suffix:semicolon
)brace
)brace
)brace
)brace
id|tempbx
op_decrement
suffix:semicolon
id|temp
op_assign
id|tempbx
op_amp
l_int|0x00FF
suffix:semicolon
id|tempbx
op_decrement
suffix:semicolon
multiline_comment|/* Not in 630/301 BIOS */
id|temp
op_assign
id|tempbx
op_amp
l_int|0x00FF
suffix:semicolon
multiline_comment|/* Not in 630/301 BIOS */
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x10
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* 0x10 vertical Blank Start */
id|tempbx
op_assign
id|push2
suffix:semicolon
id|tempbx
op_decrement
suffix:semicolon
id|temp
op_assign
id|tempbx
op_amp
l_int|0x00FF
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x0E
comma
id|temp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tempbx
op_amp
l_int|0x0100
)paren
(brace
id|tempcx
op_or_assign
l_int|0x0002
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301
)paren
(brace
id|tempcx
op_or_assign
l_int|0x000a
suffix:semicolon
)brace
)brace
id|tempax
op_assign
l_int|0x000B
suffix:semicolon
r_if
c_cond
(paren
id|modeflag
op_amp
id|DoubleScanMode
)paren
(brace
id|tempax
op_or_assign
l_int|0x8000
suffix:semicolon
)brace
r_if
c_cond
(paren
id|tempbx
op_amp
l_int|0x0200
)paren
(brace
id|tempcx
op_or_assign
l_int|0x0040
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301
)paren
(brace
id|tempax
op_or_assign
l_int|0x2000
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetPALTV
)paren
(brace
r_if
c_cond
(paren
id|SiS_VGAVDE
op_eq
l_int|480
)paren
(brace
id|tempax
op_assign
(paren
id|tempax
op_amp
l_int|0x00ff
)paren
op_or
l_int|0x2000
suffix:semicolon
r_if
c_cond
(paren
id|modeflag
op_amp
id|DoubleScanMode
)paren
(brace
id|tempax
op_or_assign
l_int|0x8000
suffix:semicolon
)brace
)brace
)brace
)brace
id|temp
op_assign
(paren
id|tempax
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x0B
comma
id|temp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tempbx
op_amp
l_int|0x0400
)paren
(brace
id|tempcx
op_or_assign
l_int|0x0600
suffix:semicolon
)brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x11
comma
l_int|0x00
)paren
suffix:semicolon
multiline_comment|/* 0x11 Vertical Blank End */
id|tempax
op_assign
id|push1
suffix:semicolon
id|tempax
op_sub_assign
id|tempbx
suffix:semicolon
id|tempax
op_rshift_assign
l_int|2
suffix:semicolon
id|push1
op_assign
id|tempax
suffix:semicolon
r_if
c_cond
(paren
(paren
id|resinfo
op_ne
l_int|0x09
)paren
op_logical_or
(paren
id|SiS_VBType
op_amp
id|VB_SIS301
)paren
)paren
(brace
id|tempax
op_lshift_assign
l_int|1
suffix:semicolon
id|tempbx
op_add_assign
id|tempax
suffix:semicolon
)brace
macro_line|#ifdef oldHV
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToHiVisionTV
)paren
(brace
id|tempbx
op_sub_assign
l_int|10
suffix:semicolon
)brace
r_else
(brace
macro_line|#endif
r_if
c_cond
(paren
id|SiS_SetFlag
op_amp
id|TVSimuMode
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetPALTV
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_HiVision
op_amp
l_int|0x03
)paren
)paren
(brace
id|tempbx
op_add_assign
l_int|40
suffix:semicolon
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
r_if
c_cond
(paren
id|SiS_VGAHDE
op_eq
l_int|800
)paren
(brace
id|tempbx
op_add_assign
l_int|10
suffix:semicolon
)brace
)brace
)brace
)brace
)brace
macro_line|#ifdef oldHV
)brace
macro_line|#endif
id|tempax
op_assign
id|push1
suffix:semicolon
id|tempax
op_rshift_assign
l_int|2
suffix:semicolon
id|tempax
op_increment
suffix:semicolon
id|tempax
op_add_assign
id|tempbx
suffix:semicolon
id|push1
op_assign
id|tempax
suffix:semicolon
r_if
c_cond
(paren
(paren
id|SiS_VBInfo
op_amp
id|SetPALTV
)paren
)paren
(brace
r_if
c_cond
(paren
id|tempbx
op_le
l_int|513
)paren
(brace
r_if
c_cond
(paren
id|tempax
op_ge
l_int|513
)paren
(brace
id|tempbx
op_assign
l_int|513
suffix:semicolon
)brace
)brace
)brace
id|temp
op_assign
id|tempbx
op_amp
l_int|0x00FF
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x0C
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* 0x0C Vertical Retrace Start */
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBType
op_amp
id|VB_SIS301
)paren
)paren
(brace
id|tempbx
op_decrement
suffix:semicolon
id|temp
op_assign
id|tempbx
op_amp
l_int|0x00FF
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x10
comma
id|temp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tempbx
op_amp
l_int|0x0100
)paren
(brace
id|tempcx
op_or_assign
l_int|0x0008
suffix:semicolon
)brace
r_if
c_cond
(paren
id|tempbx
op_amp
l_int|0x0200
)paren
(brace
id|SiS_SetRegOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x0B
comma
l_int|0x20
)paren
suffix:semicolon
)brace
id|tempbx
op_increment
suffix:semicolon
)brace
r_if
c_cond
(paren
id|tempbx
op_amp
l_int|0x0100
)paren
(brace
id|tempcx
op_or_assign
l_int|0x0004
suffix:semicolon
)brace
r_if
c_cond
(paren
id|tempbx
op_amp
l_int|0x0200
)paren
(brace
id|tempcx
op_or_assign
l_int|0x0080
suffix:semicolon
)brace
r_if
c_cond
(paren
id|tempbx
op_amp
l_int|0x0400
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301
)paren
(brace
id|tempcx
op_or_assign
l_int|0x0800
suffix:semicolon
)brace
r_else
id|tempcx
op_or_assign
l_int|0x0C00
suffix:semicolon
)brace
id|tempbx
op_assign
id|push1
suffix:semicolon
id|temp
op_assign
id|tempbx
op_amp
l_int|0x00FF
suffix:semicolon
id|temp
op_and_assign
l_int|0x0F
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x0D
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* 0x0D vertical Retrace End */
r_if
c_cond
(paren
id|tempbx
op_amp
l_int|0x0010
)paren
(brace
id|tempcx
op_or_assign
l_int|0x2000
suffix:semicolon
)brace
id|temp
op_assign
id|tempcx
op_amp
l_int|0x00FF
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetPALTV
)paren
(brace
r_if
c_cond
(paren
id|SiS_VGAVDE
op_eq
l_int|480
)paren
(brace
id|temp
op_assign
l_int|0xa3
suffix:semicolon
)brace
)brace
)brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x0A
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* 0x0A CR07 */
id|temp
op_assign
(paren
id|tempcx
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x17
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* 0x17 SR0A */
id|tempax
op_assign
id|modeflag
suffix:semicolon
id|temp
op_assign
(paren
id|tempax
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
suffix:semicolon
id|temp
op_assign
(paren
id|temp
op_rshift
l_int|1
)paren
op_amp
l_int|0x09
suffix:semicolon
multiline_comment|/* TW: Inserted from 650/301 BIOS; not in 630/301B+301 BIOS */
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
id|temp
op_or_assign
l_int|0x01
suffix:semicolon
)brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x16
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* 0x16 SR01 */
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x0F
comma
l_int|0x00
)paren
suffix:semicolon
multiline_comment|/* 0x0F CR14 */
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x12
comma
l_int|0x00
)paren
suffix:semicolon
multiline_comment|/* 0x12 CR17 */
r_if
c_cond
(paren
id|SiS_LCDInfo
op_amp
id|LCDRGB18Bit
)paren
(brace
id|temp
op_assign
l_int|0x80
suffix:semicolon
)brace
r_else
id|temp
op_assign
l_int|0x00
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x1A
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* 0x1A SR0E */
r_return
suffix:semicolon
)brace
multiline_comment|/* TW: Checked against 650/LVDS 1.10.07, 630/301B (I,II) and 630/LVDS BIOS */
r_void
DECL|function|SiS_SetGroup1_LVDS
id|SiS_SetGroup1_LVDS
c_func
(paren
id|USHORT
id|BaseAddr
comma
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
comma
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
comma
id|USHORT
id|RefreshRateTableIndex
)paren
(brace
id|USHORT
id|modeflag
comma
id|resinfo
suffix:semicolon
id|USHORT
id|push1
comma
id|push2
comma
id|tempax
comma
id|tempbx
comma
id|tempcx
comma
id|temp
comma
id|pushcx
suffix:semicolon
id|ULONG
id|tempeax
op_assign
l_int|0
comma
id|tempebx
comma
id|tempecx
comma
id|tempvcfact
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|ModeNo
op_le
l_int|0x13
)paren
(brace
id|modeflag
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_ModeFlag
suffix:semicolon
id|resinfo
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_ResInfo
suffix:semicolon
)brace
r_else
(brace
id|modeflag
op_assign
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|Ext_ModeFlag
suffix:semicolon
id|resinfo
op_assign
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|Ext_RESINFO
suffix:semicolon
)brace
macro_line|#ifdef LINUX_XF86
macro_line|#ifdef TWDEBUG
id|xf86DrvMsg
c_func
(paren
l_int|0
comma
id|X_INFO
comma
l_string|&quot;(init301: LCDHDES 0x%03x LCDVDES 0x%03x)&bslash;n&quot;
comma
id|SiS_LCDHDES
comma
id|SiS_LCDVDES
)paren
suffix:semicolon
id|xf86DrvMsg
c_func
(paren
l_int|0
comma
id|X_INFO
comma
l_string|&quot;(init301: HDE     0x%03x VDE     0x%03x)&bslash;n&quot;
comma
id|SiS_HDE
comma
id|SiS_VDE
)paren
suffix:semicolon
id|xf86DrvMsg
c_func
(paren
l_int|0
comma
id|X_INFO
comma
l_string|&quot;(init301: VGAHDE  0x%03x VGAVDE  0x%03x)&bslash;n&quot;
comma
id|SiS_VGAHDE
comma
id|SiS_VGAVDE
)paren
suffix:semicolon
id|xf86DrvMsg
c_func
(paren
l_int|0
comma
id|X_INFO
comma
l_string|&quot;(init301: HT      0x%03x VT      0x%03x)&bslash;n&quot;
comma
id|SiS_HT
comma
id|SiS_VT
)paren
suffix:semicolon
id|xf86DrvMsg
c_func
(paren
l_int|0
comma
id|X_INFO
comma
l_string|&quot;(init301: VGAHT   0x%03x VGAVT   0x%03x)&bslash;n&quot;
comma
id|SiS_VGAHT
comma
id|SiS_VGAVT
)paren
suffix:semicolon
macro_line|#endif
macro_line|#endif
multiline_comment|/* TW: Set up Panel Link */
multiline_comment|/* 1. Horizontal setup */
id|tempax
op_assign
id|SiS_LCDHDES
suffix:semicolon
multiline_comment|/* TW: Inserted (650/LVDS,630/301B/LVDS) BIOS) */
r_if
c_cond
(paren
(paren
id|SiS_LCDResInfo
op_eq
id|Panel640x480
)paren
op_logical_and
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
)paren
)paren
(brace
id|tempax
op_sub_assign
l_int|8
suffix:semicolon
)brace
id|tempcx
op_assign
id|SiS_HT
suffix:semicolon
multiline_comment|/* Horiz. Total */
id|tempbx
op_assign
id|SiS_HDE
suffix:semicolon
multiline_comment|/* Horiz. Display End */
r_if
c_cond
(paren
id|SiS_LCDInfo
op_amp
id|LCDNonExpanding
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|SiS_IF_DEF_DSTN
)paren
(brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel800x600
)paren
(brace
id|tempbx
op_assign
l_int|800
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1024x768
)paren
(brace
id|tempbx
op_assign
l_int|1024
suffix:semicolon
)brace
multiline_comment|/*&t;else if(SiS_LCDResInfo == Panel1024x600)  tempbx = 1024;  - not done in BIOS */
multiline_comment|/*&t;else if(SiS_LCDResInfo == Panel1152x768)  tempbx = 1152;  - not done in BIOS */
r_else
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1280x1024
)paren
(brace
id|tempbx
op_assign
l_int|1280
suffix:semicolon
)brace
multiline_comment|/* TW */
r_else
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_ne
id|Panel640x480
)paren
(brace
id|tempbx
op_assign
l_int|1400
suffix:semicolon
)brace
multiline_comment|/* TW */
)brace
)brace
id|tempcx
op_assign
(paren
id|tempcx
op_minus
id|tempbx
)paren
op_rshift
l_int|2
suffix:semicolon
multiline_comment|/* HT-HDE / 4 */
id|push1
op_assign
id|tempax
suffix:semicolon
id|tempax
op_add_assign
id|tempbx
suffix:semicolon
r_if
c_cond
(paren
id|tempax
op_ge
id|SiS_HT
)paren
(brace
id|tempax
op_sub_assign
id|SiS_HT
suffix:semicolon
)brace
id|push2
op_assign
id|tempax
suffix:semicolon
multiline_comment|/* TW: Inserted this entire &quot;if&quot;-section from 650/LVDS, 630/301B and 630/LVDS BIOS */
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCD
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|SiS_IF_DEF_DSTN
)paren
(brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel800x600
)paren
(brace
id|tempcx
op_assign
l_int|0x0028
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1400x1050
)paren
(brace
id|tempcx
op_assign
l_int|0x0030
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1024x768
)paren
op_logical_or
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1024x600
)paren
op_logical_or
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1152x768
)paren
)paren
(brace
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|1
)paren
(brace
id|tempcx
op_assign
l_int|0x0017
suffix:semicolon
macro_line|#ifdef TWPANEL
id|tempcx
op_increment
suffix:semicolon
macro_line|#endif
)brace
r_else
(brace
id|tempcx
op_assign
l_int|0x0017
suffix:semicolon
multiline_comment|/* A901; other 301B BIOS 0x0018; */
)brace
)brace
r_else
(brace
id|tempcx
op_assign
l_int|0x0018
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_ne
id|Panel640x480
)paren
(brace
id|tempcx
op_assign
l_int|0x0030
suffix:semicolon
)brace
)brace
)brace
id|tempcx
op_add_assign
id|tempax
suffix:semicolon
multiline_comment|/* lcdhrs  */
r_if
c_cond
(paren
id|tempcx
op_ge
id|SiS_HT
)paren
(brace
id|tempcx
op_sub_assign
id|SiS_HT
suffix:semicolon
)brace
id|tempax
op_assign
id|tempcx
op_rshift
l_int|3
suffix:semicolon
multiline_comment|/* BPLHRS */
id|temp
op_assign
id|tempax
op_amp
l_int|0x00FF
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x14
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* Part1_14h; TW: Panel Link Horizontal Retrace Start  */
id|temp
op_assign
(paren
id|tempax
op_amp
l_int|0x00FF
)paren
op_plus
l_int|10
suffix:semicolon
multiline_comment|/* TW: Inserted this entire &quot;if&quot;-section from 650/LVDS BIOS */
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCD
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|SiS_IF_DEF_DSTN
)paren
(brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_ne
id|Panel640x480
)paren
(brace
id|temp
op_add_assign
l_int|6
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_ne
id|Panel800x600
)paren
(brace
id|temp
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OG
id|SIS_315H
)paren
(brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_ne
id|Panel1024x768
)paren
(brace
id|temp
op_sub_assign
l_int|3
suffix:semicolon
macro_line|#ifdef TEST1400
id|temp
op_assign
l_int|0x0e
suffix:semicolon
macro_line|#endif
)brace
)brace
)brace
)brace
)brace
)brace
id|temp
op_and_assign
l_int|0x1F
suffix:semicolon
id|temp
op_or_assign
(paren
(paren
id|tempcx
op_amp
l_int|0x0007
)paren
op_lshift
l_int|5
)paren
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_FSTN
)paren
(brace
id|temp
op_assign
l_int|0x20
suffix:semicolon
)brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x15
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* Part1_15h; TW: Panel Link Horizontal Retrace End/Skew */
id|tempbx
op_assign
id|push2
suffix:semicolon
id|tempcx
op_assign
id|push1
suffix:semicolon
multiline_comment|/* lcdhdes  */
id|temp
op_assign
(paren
id|tempcx
op_amp
l_int|0x0007
)paren
suffix:semicolon
multiline_comment|/* BPLHDESKEW  */
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x1A
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* Part1_1Ah; TW: Panel Link Vertical Retrace Start (2:0) */
id|tempcx
op_rshift_assign
l_int|3
suffix:semicolon
multiline_comment|/* BPLHDES */
id|temp
op_assign
(paren
id|tempcx
op_amp
l_int|0x00FF
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ModeNo
op_eq
l_int|0x5b
)paren
(brace
id|temp
op_decrement
suffix:semicolon
)brace
multiline_comment|/* fix fstn mode=5b */
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x16
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* Part1_16h; TW: Panel Link Horizontal Display Enable Start  */
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
multiline_comment|/* TW: Not done in LVDS BIOS 1.10.07 */
r_if
c_cond
(paren
id|tempbx
op_amp
l_int|0x07
)paren
(brace
id|tempbx
op_add_assign
l_int|8
suffix:semicolon
)brace
multiline_comment|/* TW: Done in 630/301B and 630/LVDS BIOSes */
)brace
id|tempbx
op_rshift_assign
l_int|3
suffix:semicolon
multiline_comment|/* BPLHDEE  */
id|temp
op_assign
id|tempbx
op_amp
l_int|0x00FF
suffix:semicolon
r_if
c_cond
(paren
id|ModeNo
op_eq
l_int|0x5b
)paren
(brace
id|temp
op_decrement
suffix:semicolon
)brace
multiline_comment|/* fix fstn mode=5b */
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x17
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* Part1_17h; TW: Panel Link Horizontal Display Enable End  */
multiline_comment|/* 2. Vertical setup */
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
multiline_comment|/* TW: This entire section from 630/301B and 630/LVDS/LVDS+CH BIOS */
id|tempcx
op_assign
id|SiS_VGAVT
suffix:semicolon
id|tempbx
op_assign
id|SiS_VGAVDE
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDInfo
op_amp
id|LCDNonExpanding
)paren
(brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_ne
id|Panel640x480
)paren
(brace
id|tempbx
op_assign
l_int|600
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_ne
id|Panel800x600
)paren
(brace
id|tempbx
op_assign
l_int|768
suffix:semicolon
r_if
c_cond
(paren
(paren
id|SiS_LCDResInfo
op_ne
id|Panel1024x768
)paren
op_logical_and
(paren
id|SiS_LCDResInfo
op_ne
id|Panel1152x768
)paren
)paren
(brace
id|tempbx
op_assign
l_int|600
suffix:semicolon
)brace
)brace
)brace
)brace
id|tempcx
op_sub_assign
id|tempbx
suffix:semicolon
)brace
r_else
(brace
id|tempcx
op_assign
id|SiS_VGAVT
op_minus
id|SiS_VGAVDE
suffix:semicolon
multiline_comment|/* VGAVT-VGAVDE  */
)brace
id|tempbx
op_assign
id|SiS_LCDVDES
suffix:semicolon
multiline_comment|/* VGAVDES  */
id|push1
op_assign
id|tempbx
suffix:semicolon
id|tempax
op_assign
id|SiS_VGAVDE
suffix:semicolon
r_if
c_cond
(paren
(paren
id|SiS_IF_DEF_TRUMPION
op_eq
l_int|0
)paren
op_logical_and
(paren
op_logical_neg
(paren
id|SiS_LCDInfo
op_amp
l_int|0x0100
)paren
)paren
op_logical_and
(paren
id|SiS_LCDResInfo
op_ne
id|Panel640x480
)paren
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCD
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|SiS_IF_DEF_DSTN
)paren
(brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel800x600
)paren
(brace
id|tempax
op_assign
l_int|600
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1024x768
)paren
(brace
id|tempax
op_assign
l_int|768
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1024x600
)paren
(brace
id|tempax
op_assign
l_int|600
suffix:semicolon
)brace
multiline_comment|/* TW */
r_else
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1152x768
)paren
(brace
id|tempax
op_assign
l_int|768
suffix:semicolon
)brace
multiline_comment|/* TW */
r_else
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1280x1024
)paren
(brace
id|tempax
op_assign
l_int|1024
suffix:semicolon
)brace
multiline_comment|/* TW */
r_else
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1400x1050
)paren
(brace
id|tempax
op_assign
l_int|1050
suffix:semicolon
)brace
multiline_comment|/* TW */
r_else
id|tempax
op_assign
l_int|600
suffix:semicolon
)brace
)brace
)brace
id|tempbx
op_assign
id|tempbx
op_plus
id|tempax
suffix:semicolon
r_if
c_cond
(paren
id|tempbx
op_ge
id|SiS_VT
)paren
(brace
id|tempbx
op_sub_assign
id|SiS_VT
suffix:semicolon
)brace
id|push2
op_assign
id|tempbx
suffix:semicolon
multiline_comment|/* push bx  temppush  */
id|tempcx
op_rshift_assign
l_int|1
suffix:semicolon
multiline_comment|/* TW: Inserted this entire &quot;if&quot; section (650/LVDS; 630/301B; 630/LVDS) */
r_if
c_cond
(paren
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCD
)paren
op_logical_and
(paren
id|SiS_LCDResInfo
op_ne
id|Panel640x480
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|SiS_IF_DEF_DSTN
)paren
(brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel800x600
)paren
(brace
id|tempcx
op_assign
l_int|0x0001
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1024x768
)paren
op_logical_or
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1152x768
)paren
)paren
(brace
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|1
)paren
(brace
id|tempcx
op_assign
l_int|0x0002
suffix:semicolon
macro_line|#ifdef TWPANEL
id|tempcx
op_increment
suffix:semicolon
macro_line|#endif
)brace
r_else
(brace
id|tempcx
op_assign
l_int|0x0002
suffix:semicolon
multiline_comment|/* TW: A901; other 301B BIOS sets 0x0003; */
)brace
)brace
r_else
id|tempcx
op_assign
l_int|0x0003
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1280x768
)paren
(brace
id|tempcx
op_assign
l_int|0x0003
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1280x1024
)paren
(brace
id|tempcx
op_assign
l_int|0x0001
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1400x1050
)paren
(brace
id|tempcx
op_assign
l_int|0x0001
suffix:semicolon
)brace
r_else
id|tempcx
op_assign
l_int|0x0057
suffix:semicolon
)brace
)brace
id|tempbx
op_add_assign
id|tempcx
suffix:semicolon
multiline_comment|/* BPLVRS  */
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
macro_line|#ifdef TWPANEL
r_if
c_cond
(paren
id|SiS_IF_DEF_CH70xx
op_eq
l_int|0
)paren
(brace
macro_line|#endif
id|tempbx
op_increment
suffix:semicolon
)brace
)brace
macro_line|#ifdef TEST1400  /* Not done on 650/LVDS 1.10.07, done in 650/LVDS 1.10a */
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
id|tempbx
op_increment
suffix:semicolon
)brace
macro_line|#endif
r_if
c_cond
(paren
id|tempbx
op_ge
id|SiS_VT
)paren
(brace
id|tempbx
op_sub_assign
id|SiS_VT
suffix:semicolon
)brace
id|temp
op_assign
id|tempbx
op_amp
l_int|0x00FF
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x18
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* Part1_18h; TW: Panel Link Vertical Retrace Start  */
id|tempcx
op_rshift_assign
l_int|3
suffix:semicolon
multiline_comment|/* TW: Inserted this entire &quot;if&quot; section (650/LVDS, 630/LVDS, 630/301B) */
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCD
)paren
(brace
r_if
c_cond
(paren
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
op_logical_and
(paren
id|SiS_LCDResInfo
op_eq
id|Panel640x480
)paren
)paren
(brace
id|tempcx
op_assign
l_int|0x0001
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1400x1050
)paren
(brace
id|tempcx
op_assign
l_int|0x0002
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel800x600
)paren
(brace
id|tempcx
op_assign
l_int|0x0003
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_ne
id|Panel640x480
)paren
(brace
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|1
)paren
(brace
id|tempcx
op_assign
l_int|0x0004
suffix:semicolon
macro_line|#ifdef TWPANEL
id|tempcx
op_increment
suffix:semicolon
macro_line|#endif
)brace
r_else
(brace
id|tempcx
op_assign
l_int|0x0004
suffix:semicolon
multiline_comment|/* A901; Other BIOS sets 0x0005; */
)brace
)brace
r_else
(brace
id|tempcx
op_assign
l_int|0x0005
suffix:semicolon
)brace
)brace
)brace
id|tempcx
op_assign
id|tempcx
op_plus
id|tempbx
op_plus
l_int|1
suffix:semicolon
multiline_comment|/* BPLVRE  */
id|temp
op_assign
id|tempcx
op_amp
l_int|0x000F
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x19
comma
l_int|0xf0
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* Part1_19h; TW: Panel Link Vertical Retrace End (3:0); Misc.  */
id|temp
op_assign
(paren
(paren
id|tempbx
op_amp
l_int|0x0700
)paren
op_rshift
l_int|8
)paren
op_lshift
l_int|3
suffix:semicolon
multiline_comment|/* BPLDESKEW =0 */
r_if
c_cond
(paren
id|SiS_VGAVDE
op_ne
id|SiS_VDE
)paren
(brace
id|temp
op_or_assign
l_int|0x40
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_SetFlag
op_amp
id|EnableLVDSDDA
)paren
(brace
id|temp
op_or_assign
l_int|0x40
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_LCDInfo
op_amp
id|LCDRGB18Bit
)paren
(brace
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
r_if
c_cond
(paren
id|SiS_GetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x00
)paren
op_amp
l_int|0x01
)paren
(brace
multiline_comment|/* TW: Inserted from 650/LVDS 1.10.07 */
id|temp
op_or_assign
l_int|0x80
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
(paren
id|HwDeviceExtension-&gt;jChipType
op_eq
id|SIS_630
)paren
op_logical_or
(paren
id|HwDeviceExtension-&gt;jChipType
op_eq
id|SIS_730
)paren
)paren
(brace
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipRevision
op_ge
l_int|0x30
)paren
(brace
id|temp
op_or_assign
l_int|0x80
suffix:semicolon
)brace
)brace
)brace
)brace
multiline_comment|/* TW: in follwing line, 0x87 was 0x07 (modified according to 650/LVDS BIOS) */
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x1A
comma
l_int|0x87
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* Part1_1Ah; TW: Panel Link Control Signal (7:3); Vertical Retrace Start (2:0) */
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
multiline_comment|/* 300 series */
id|tempeax
op_assign
id|SiS_VGAVDE
op_lshift
l_int|6
suffix:semicolon
id|temp
op_assign
(paren
id|USHORT
)paren
(paren
id|tempeax
op_mod
(paren
id|ULONG
)paren
id|SiS_VDE
)paren
suffix:semicolon
id|tempeax
op_assign
id|tempeax
op_div
(paren
id|ULONG
)paren
id|SiS_VDE
suffix:semicolon
r_if
c_cond
(paren
id|temp
op_ne
l_int|0
)paren
(brace
id|tempeax
op_increment
suffix:semicolon
)brace
id|tempebx
op_assign
id|tempeax
suffix:semicolon
multiline_comment|/* BPLVCFACT  */
r_if
c_cond
(paren
id|SiS_SetFlag
op_amp
id|EnableLVDSDDA
)paren
(brace
id|tempebx
op_assign
l_int|0x003F
suffix:semicolon
)brace
id|temp
op_assign
(paren
id|USHORT
)paren
(paren
id|tempebx
op_amp
l_int|0x00FF
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x1E
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* Part1_1Eh; TW: Panel Link Vertical Scaling Factor */
)brace
r_else
(brace
multiline_comment|/* 310 series */
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x1E
comma
l_int|0x23
)paren
suffix:semicolon
multiline_comment|/* Inserted from 650/LVDS BIOS */
id|tempeax
op_assign
id|SiS_VGAVDE
op_lshift
l_int|18
suffix:semicolon
id|temp
op_assign
(paren
id|USHORT
)paren
(paren
id|tempeax
op_mod
(paren
id|ULONG
)paren
id|SiS_VDE
)paren
suffix:semicolon
id|tempeax
op_assign
id|tempeax
op_div
id|SiS_VDE
suffix:semicolon
r_if
c_cond
(paren
id|temp
op_ne
l_int|0
)paren
(brace
id|tempeax
op_increment
suffix:semicolon
)brace
id|tempebx
op_assign
id|tempeax
suffix:semicolon
multiline_comment|/* BPLVCFACT  */
id|tempvcfact
op_assign
id|tempeax
suffix:semicolon
id|temp
op_assign
(paren
id|USHORT
)paren
(paren
id|tempebx
op_amp
l_int|0x00FF
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x37
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* Part1_37h; TW: Panel Link Vertical Scaling Factor */
id|temp
op_assign
(paren
id|USHORT
)paren
(paren
(paren
id|tempebx
op_amp
l_int|0x00FF00
)paren
op_rshift
l_int|8
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x36
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* Part1_36h; TW: Panel Link Vertical Scaling Factor */
id|temp
op_assign
(paren
id|USHORT
)paren
(paren
(paren
id|tempebx
op_amp
l_int|0x00030000
)paren
op_rshift
l_int|16
)paren
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VDE
op_eq
id|SiS_VGAVDE
)paren
(brace
id|temp
op_or_assign
l_int|0x04
suffix:semicolon
)brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x35
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* Part1_35h; TW: Panel Link Vertical Scaling Factor */
)brace
id|tempbx
op_assign
id|push2
suffix:semicolon
multiline_comment|/* p bx temppush1 BPLVDEE  */
id|tempcx
op_assign
id|push1
suffix:semicolon
id|push1
op_assign
id|temp
suffix:semicolon
multiline_comment|/* TW: For 630/301B and 630/LVDS */
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|SiS_IF_DEF_DSTN
)paren
(brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel800x600
)paren
(brace
r_if
c_cond
(paren
id|resinfo
op_eq
l_int|7
)paren
(brace
id|tempcx
op_increment
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
multiline_comment|/* TW: Not done in 650/LVDS 1.10.07 */
r_if
c_cond
(paren
id|resinfo
op_eq
l_int|8
)paren
(brace
id|tempcx
op_increment
suffix:semicolon
)brace
multiline_comment|/* TW: But in 630/301B and 630/LVDS */
)brace
)brace
)brace
multiline_comment|/* TW: Inserted (650/LVDS, 630/LVDS, 630/301B) */
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel640x480
)paren
(brace
id|tempcx
op_assign
id|SiS_VGAVDE
suffix:semicolon
id|tempbx
op_assign
id|SiS_VGAVDE
op_minus
l_int|1
suffix:semicolon
)brace
id|temp
op_assign
(paren
(paren
id|tempbx
op_amp
l_int|0x0700
)paren
op_rshift
l_int|8
)paren
op_lshift
l_int|3
suffix:semicolon
id|temp
op_or_assign
(paren
(paren
id|tempcx
op_amp
l_int|0x0700
)paren
op_rshift
l_int|8
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x1D
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* Part1_1Dh; TW: Vertical Display Overflow; Control Signal */
id|temp
op_assign
id|tempbx
op_amp
l_int|0x00FF
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_FSTN
)paren
(brace
id|temp
op_increment
suffix:semicolon
)brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x1C
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* Part1_1Ch; TW: Panel Link Vertical Display Enable End  */
id|temp
op_assign
id|tempcx
op_amp
l_int|0x00FF
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x1B
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* Part1_1Bh; TW: Panel Link Vertical Display Enable Start  */
multiline_comment|/* 3. Additional horizontal setup (scaling, etc) */
id|tempecx
op_assign
id|SiS_VGAHDE
suffix:semicolon
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
r_if
c_cond
(paren
id|modeflag
op_amp
id|HalfDCLK
)paren
(brace
multiline_comment|/* TW: Added this entire if statement */
id|tempecx
op_rshift_assign
l_int|1
suffix:semicolon
)brace
)brace
id|tempebx
op_assign
id|SiS_HDE
suffix:semicolon
r_if
c_cond
(paren
id|tempecx
op_eq
id|tempebx
)paren
(brace
id|tempeax
op_assign
l_int|0xFFFF
suffix:semicolon
)brace
r_else
(brace
id|tempeax
op_assign
id|tempecx
suffix:semicolon
id|tempeax
op_lshift_assign
l_int|16
suffix:semicolon
id|temp
op_assign
(paren
id|USHORT
)paren
(paren
id|tempeax
op_mod
id|tempebx
)paren
suffix:semicolon
id|tempeax
op_assign
id|tempeax
op_div
id|tempebx
suffix:semicolon
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
r_if
c_cond
(paren
id|temp
)paren
(brace
id|tempeax
op_increment
suffix:semicolon
)brace
multiline_comment|/* TW: Not done in 630/301B or 630/LVDS, but for 650/LVDS */
)brace
)brace
id|tempecx
op_assign
id|tempeax
suffix:semicolon
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
id|tempeax
op_assign
id|SiS_VGAHDE
suffix:semicolon
r_if
c_cond
(paren
id|modeflag
op_amp
id|HalfDCLK
)paren
(brace
multiline_comment|/* TW: Added this entire if statement */
id|tempeax
op_rshift_assign
l_int|1
suffix:semicolon
)brace
id|tempeax
op_lshift_assign
l_int|16
suffix:semicolon
id|tempeax
op_assign
(paren
id|tempeax
op_div
id|tempecx
)paren
op_minus
l_int|1
suffix:semicolon
)brace
r_else
(brace
id|tempeax
op_assign
(paren
(paren
id|SiS_VGAHT
op_lshift
l_int|16
)paren
op_div
id|tempecx
)paren
op_minus
l_int|1
suffix:semicolon
)brace
id|tempecx
op_lshift_assign
l_int|16
suffix:semicolon
id|tempecx
op_or_assign
(paren
id|tempeax
op_amp
l_int|0xFFFF
)paren
suffix:semicolon
id|temp
op_assign
(paren
id|USHORT
)paren
(paren
id|tempecx
op_amp
l_int|0x00FF
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x1F
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* Part1_1Fh; TW: Panel Link DDA Operational Number in each horiz. line */
id|tempbx
op_assign
id|SiS_VDE
suffix:semicolon
multiline_comment|/* TW: added following if statement */
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
id|tempeax
op_assign
(paren
id|SiS_VGAVDE
op_lshift
l_int|18
)paren
op_div
id|tempvcfact
suffix:semicolon
id|tempbx
op_assign
(paren
id|USHORT
)paren
(paren
id|tempeax
op_amp
l_int|0x0FFFF
)paren
suffix:semicolon
)brace
r_else
(brace
id|tempax
op_assign
id|SiS_VGAVDE
op_lshift
l_int|6
suffix:semicolon
id|tempbx
op_assign
id|push1
suffix:semicolon
id|tempbx
op_and_assign
l_int|0x3f
suffix:semicolon
r_if
c_cond
(paren
id|tempbx
op_eq
l_int|0
)paren
(brace
id|tempbx
op_assign
l_int|64
suffix:semicolon
)brace
id|tempax
op_assign
id|tempax
op_div
id|tempbx
suffix:semicolon
id|tempbx
op_assign
id|tempax
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1024x768
)paren
(brace
id|tempbx
op_decrement
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_SetFlag
op_amp
id|EnableLVDSDDA
)paren
(brace
id|tempbx
op_assign
l_int|1
suffix:semicolon
)brace
id|temp
op_assign
(paren
(paren
id|tempbx
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
)paren
op_lshift
l_int|3
suffix:semicolon
id|temp
op_or_assign
(paren
id|USHORT
)paren
(paren
(paren
id|tempecx
op_amp
l_int|0x0700
)paren
op_rshift
l_int|8
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x20
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* Part1_20h; TW: Overflow register */
id|temp
op_assign
id|tempbx
op_amp
l_int|0x00FF
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x21
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* Part1_21h; TW: Panel Link Vertical Accumulator Register */
id|tempecx
op_rshift_assign
l_int|16
suffix:semicolon
multiline_comment|/* BPLHCFACT  */
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
multiline_comment|/* TW: Added this entire if statement from 630/301B+LVDS BIOSes */
r_if
c_cond
(paren
id|modeflag
op_amp
id|HalfDCLK
)paren
(brace
id|tempecx
op_rshift_assign
l_int|1
suffix:semicolon
)brace
)brace
id|temp
op_assign
(paren
id|USHORT
)paren
(paren
(paren
id|tempecx
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x22
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* Part1_22h; TW: Panel Link Horizontal Scaling Factor High */
id|temp
op_assign
(paren
id|USHORT
)paren
(paren
id|tempecx
op_amp
l_int|0x00FF
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x23
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* Part1_22h; TW: Panel Link Horizontal Scaling Factor Low */
multiline_comment|/* 630/301B and 630/LVDS do something for 640x480 panels here */
multiline_comment|/* add dstn new register */
r_if
c_cond
(paren
id|SiS_IF_DEF_DSTN
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x1E
comma
l_int|0x01
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x25
comma
l_int|0x00
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x26
comma
l_int|0x00
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x27
comma
l_int|0x00
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x28
comma
l_int|0x87
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x29
comma
l_int|0x5A
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x2A
comma
l_int|0x4B
)paren
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x44
comma
op_complement
l_int|0x007
comma
l_int|0x03
)paren
suffix:semicolon
id|tempbx
op_assign
id|SiS_HDE
op_plus
l_int|64
suffix:semicolon
multiline_comment|/*Blps = lcdhdee(lcdhdes+HDE) + 64*/
id|temp
op_assign
id|tempbx
op_amp
l_int|0x00FF
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x38
comma
id|temp
)paren
suffix:semicolon
id|temp
op_assign
(paren
(paren
id|tempbx
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
)paren
op_lshift
l_int|3
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x35
comma
op_complement
l_int|0x078
comma
id|temp
)paren
suffix:semicolon
id|tempbx
op_add_assign
l_int|32
suffix:semicolon
multiline_comment|/*Blpe=lBlps+32*/
id|temp
op_assign
id|tempbx
op_amp
l_int|0x00FF
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_FSTN
)paren
(brace
id|temp
op_assign
l_int|0
suffix:semicolon
)brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x39
comma
id|temp
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x3A
comma
l_int|0x00
)paren
suffix:semicolon
multiline_comment|/*Bflml=0*/
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x3C
comma
op_complement
l_int|0x007
comma
l_int|0x00
)paren
suffix:semicolon
id|tempbx
op_assign
id|SiS_VDE
op_div
l_int|2
suffix:semicolon
id|temp
op_assign
id|tempbx
op_amp
l_int|0x00FF
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x3B
comma
id|temp
)paren
suffix:semicolon
id|temp
op_assign
(paren
(paren
id|tempbx
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
)paren
op_lshift
l_int|3
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x3C
comma
op_complement
l_int|0x038
comma
id|temp
)paren
suffix:semicolon
id|tempeax
op_assign
id|SiS_HDE
op_lshift
l_int|2
suffix:semicolon
multiline_comment|/* BDxFIFOSTOP = (HDE*4)/128 */
id|tempebx
op_assign
l_int|128
suffix:semicolon
id|temp
op_assign
(paren
id|USHORT
)paren
(paren
id|tempeax
op_mod
id|tempebx
)paren
suffix:semicolon
id|tempeax
op_assign
id|tempeax
op_div
id|tempebx
suffix:semicolon
r_if
c_cond
(paren
id|temp
op_ne
l_int|0
)paren
(brace
id|tempeax
op_increment
suffix:semicolon
)brace
id|temp
op_assign
(paren
id|USHORT
)paren
(paren
id|tempeax
op_amp
l_int|0x003F
)paren
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x45
comma
op_complement
l_int|0x0FF
comma
id|temp
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x3F
comma
l_int|0x00
)paren
suffix:semicolon
multiline_comment|/* BDxWadrst0 */
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x3E
comma
l_int|0x00
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x3D
comma
l_int|0x10
)paren
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x3C
comma
op_complement
l_int|0x040
comma
l_int|0x00
)paren
suffix:semicolon
id|tempax
op_assign
id|SiS_HDE
op_rshift
l_int|4
suffix:semicolon
multiline_comment|/* BDxWadroff = HDE*4/8/8 */
id|pushcx
op_assign
id|tempax
suffix:semicolon
id|temp
op_assign
id|tempax
op_amp
l_int|0x00FF
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x43
comma
id|temp
)paren
suffix:semicolon
id|temp
op_assign
(paren
(paren
id|tempax
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
)paren
op_lshift
l_int|3
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x44
comma
op_complement
l_int|0x0F8
comma
id|temp
)paren
suffix:semicolon
id|tempax
op_assign
id|SiS_VDE
suffix:semicolon
multiline_comment|/*BDxWadrst1 = BDxWadrst0 + BDxWadroff * VDE */
id|tempeax
op_assign
(paren
id|tempax
op_star
id|pushcx
)paren
suffix:semicolon
id|tempebx
op_assign
l_int|0x00100000
op_plus
id|tempeax
suffix:semicolon
id|temp
op_assign
(paren
id|USHORT
)paren
id|tempebx
op_amp
l_int|0x000000FF
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x42
comma
id|temp
)paren
suffix:semicolon
id|temp
op_assign
(paren
id|USHORT
)paren
(paren
(paren
id|tempebx
op_amp
l_int|0x0000FF00
)paren
op_rshift
l_int|8
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x41
comma
id|temp
)paren
suffix:semicolon
id|temp
op_assign
(paren
id|USHORT
)paren
(paren
(paren
id|tempebx
op_amp
l_int|0x00FF0000
)paren
op_rshift
l_int|16
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x40
comma
id|temp
)paren
suffix:semicolon
id|temp
op_assign
(paren
id|USHORT
)paren
(paren
(paren
(paren
id|tempebx
op_amp
l_int|0x01000000
)paren
op_rshift
l_int|24
)paren
op_lshift
l_int|7
)paren
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x3C
comma
op_complement
l_int|0x080
comma
id|temp
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x2F
comma
l_int|0x03
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x03
comma
l_int|0x50
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x04
comma
l_int|0x00
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x2F
comma
l_int|0x01
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x13
comma
l_int|0x00
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x05
comma
l_int|0x86
)paren
suffix:semicolon
multiline_comment|/* Unlock */
id|SiS_SetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x1e
comma
l_int|0x62
)paren
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_FSTN
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x2b
comma
l_int|0x1b
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x2c
comma
l_int|0xe3
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x1e
comma
l_int|0x62
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x2e
comma
l_int|0x04
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x2f
comma
l_int|0x42
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x32
comma
l_int|0x01
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x2b
comma
l_int|0x02
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x2c
comma
l_int|0x00
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x2d
comma
l_int|0x00
)paren
suffix:semicolon
)brace
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x19
comma
l_int|0x0f
comma
l_int|0x30
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x1e
comma
l_int|0x7d
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x2e
comma
l_int|0xe0
)paren
suffix:semicolon
)brace
r_return
suffix:semicolon
)brace
macro_line|#ifdef SIS315H
r_void
DECL|function|SiS_CRT2AutoThreshold
id|SiS_CRT2AutoThreshold
c_func
(paren
id|USHORT
id|BaseAddr
)paren
(brace
id|SiS_SetRegOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x01
comma
l_int|0x40
)paren
suffix:semicolon
)brace
macro_line|#endif
multiline_comment|/* TW: For LVDS / 302b/lv - LCDA (this must only be called on 310/325 series!) */
multiline_comment|/* TW: Double-checked against 650/LVDS and 650/301 BIOS */
r_void
DECL|function|SiS_SetGroup1_LCDA
id|SiS_SetGroup1_LCDA
c_func
(paren
id|USHORT
id|BaseAddr
comma
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
comma
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
comma
id|USHORT
id|RefreshRateTableIndex
)paren
(brace
id|USHORT
id|modeflag
comma
id|resinfo
suffix:semicolon
id|USHORT
id|push1
comma
id|push2
comma
id|tempax
comma
id|tempbx
comma
id|tempcx
comma
id|temp
suffix:semicolon
id|ULONG
id|tempeax
op_assign
l_int|0
comma
id|tempebx
comma
id|tempecx
comma
id|tempvcfact
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|1
)paren
(brace
multiline_comment|/* TW: From 650/LVDS BIOS */
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x13
comma
l_int|0xfb
comma
l_int|0x04
)paren
suffix:semicolon
)brace
multiline_comment|/* TW: From 650/LVDS BIOS */
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|1
)paren
(brace
multiline_comment|/* TW: From 650/LVDS 1.10.07 */
id|SiS_SetRegOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x2D
comma
l_int|0x00
)paren
suffix:semicolon
)brace
multiline_comment|/* TW: From 650/LVDS 1.10.07 */
r_else
id|SiS_SetRegOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x2D
comma
l_int|0x20
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ModeNo
op_le
l_int|0x13
)paren
(brace
id|modeflag
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_ModeFlag
suffix:semicolon
id|resinfo
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_ResInfo
suffix:semicolon
)brace
r_else
(brace
id|modeflag
op_assign
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|Ext_ModeFlag
suffix:semicolon
id|resinfo
op_assign
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|Ext_RESINFO
suffix:semicolon
)brace
id|tempax
op_assign
id|SiS_LCDHDES
suffix:semicolon
id|tempbx
op_assign
id|SiS_HDE
suffix:semicolon
id|tempcx
op_assign
id|SiS_HT
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDInfo
op_amp
id|LCDNonExpanding
)paren
(brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1280x1024
)paren
(brace
id|tempbx
op_assign
l_int|1280
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1024x768
)paren
(brace
id|tempbx
op_assign
l_int|1024
suffix:semicolon
)brace
r_else
id|tempbx
op_assign
l_int|1400
suffix:semicolon
multiline_comment|/* TW: From 650/LVDS BIOS; OK with 650/301 */
)brace
id|tempcx
op_assign
id|tempcx
op_minus
id|tempbx
suffix:semicolon
multiline_comment|/* HT-HDE  */
id|push1
op_assign
id|tempax
suffix:semicolon
id|tempax
op_assign
id|tempax
op_plus
id|tempbx
suffix:semicolon
multiline_comment|/* lcdhdee  */
id|tempbx
op_assign
id|SiS_HT
suffix:semicolon
r_if
c_cond
(paren
id|tempax
op_ge
id|tempbx
)paren
(brace
id|tempax
op_assign
id|tempax
op_minus
id|tempbx
suffix:semicolon
)brace
id|push2
op_assign
id|tempax
suffix:semicolon
multiline_comment|/* push ax   lcdhdee  */
id|tempcx
op_rshift_assign
l_int|2
suffix:semicolon
multiline_comment|/* temp  */
id|tempcx
op_assign
id|tempcx
op_plus
id|tempax
suffix:semicolon
multiline_comment|/* lcdhrs  */
r_if
c_cond
(paren
id|tempcx
op_ge
id|tempbx
)paren
(brace
id|tempcx
op_assign
id|tempcx
op_minus
id|tempbx
suffix:semicolon
)brace
multiline_comment|/* v ah,cl  */
id|tempax
op_assign
id|tempcx
suffix:semicolon
id|tempax
op_assign
id|tempax
op_rshift
l_int|3
suffix:semicolon
multiline_comment|/* BPLHRS */
id|temp
op_assign
id|tempax
op_amp
l_int|0x00FF
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x14
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* Part1_14h  */
id|temp
op_assign
(paren
id|tempax
op_amp
l_int|0x00FF
)paren
op_plus
l_int|10
suffix:semicolon
id|temp
op_assign
id|temp
op_amp
l_int|0x01F
suffix:semicolon
id|temp
op_assign
id|temp
op_or
(paren
(paren
(paren
id|tempcx
op_amp
l_int|0x00ff
)paren
op_amp
l_int|0x07
)paren
op_lshift
l_int|5
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x15
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* Part1_15h  */
id|tempbx
op_assign
id|push2
suffix:semicolon
multiline_comment|/* lcdhdee  */
id|tempcx
op_assign
id|push1
suffix:semicolon
multiline_comment|/* lcdhdes  */
id|temp
op_assign
(paren
id|tempcx
op_amp
l_int|0x00FF
)paren
suffix:semicolon
id|temp
op_assign
id|temp
op_amp
l_int|0x07
suffix:semicolon
multiline_comment|/* BPLHDESKEW  */
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x1A
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* Part1_1Ah  */
id|tempcx
op_assign
id|tempcx
op_rshift
l_int|3
suffix:semicolon
multiline_comment|/* BPLHDES */
id|temp
op_assign
(paren
id|tempcx
op_amp
l_int|0x00FF
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x16
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* Part1_16h  */
r_if
c_cond
(paren
id|tempbx
op_amp
l_int|0x07
)paren
(brace
id|tempbx
op_add_assign
l_int|8
suffix:semicolon
)brace
id|tempbx
op_rshift_assign
l_int|3
suffix:semicolon
multiline_comment|/* BPLHDEE  */
id|temp
op_assign
id|tempbx
op_amp
l_int|0x00FF
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x17
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* Part1_17h  */
id|tempcx
op_assign
id|SiS_VGAVT
suffix:semicolon
id|tempbx
op_assign
id|SiS_VGAVDE
suffix:semicolon
id|tempcx
op_assign
id|tempcx
op_minus
id|tempbx
suffix:semicolon
multiline_comment|/* GAVT-VGAVDE  */
id|tempbx
op_assign
id|SiS_LCDVDES
suffix:semicolon
multiline_comment|/* VGAVDES  */
id|push1
op_assign
id|tempbx
suffix:semicolon
multiline_comment|/* push bx temppush1 */
r_if
c_cond
(paren
id|SiS_IF_DEF_TRUMPION
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1024x768
)paren
(brace
id|tempax
op_assign
l_int|768
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1280x1024
)paren
(brace
id|tempax
op_assign
l_int|1024
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1400x1050
)paren
(brace
id|tempax
op_assign
l_int|1050
suffix:semicolon
)brace
multiline_comment|/* TW: Inserted from 650/LVDS BIOS */
r_else
id|tempax
op_assign
l_int|960
suffix:semicolon
multiline_comment|/* TW: Inserted from 650/301 BIOS */
macro_line|#if 0                                                           /* TW: Removed (650/LVDS BIOS) */
r_if
c_cond
(paren
id|SiS_IF_DEF_CH70xx
op_eq
l_int|1
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
(brace
id|tempax
op_assign
id|SiS_VGAVDE
suffix:semicolon
)brace
)brace
macro_line|#endif
)brace
r_else
id|tempax
op_assign
id|SiS_VGAVDE
suffix:semicolon
multiline_comment|/* Trumpion */
id|tempbx
op_assign
id|tempbx
op_plus
id|tempax
suffix:semicolon
id|tempax
op_assign
id|SiS_VT
suffix:semicolon
multiline_comment|/* VT  */
r_if
c_cond
(paren
id|tempbx
op_ge
id|SiS_VT
)paren
(brace
id|tempbx
op_assign
id|tempbx
op_minus
id|tempax
suffix:semicolon
)brace
id|push2
op_assign
id|tempbx
suffix:semicolon
multiline_comment|/* push bx  temppush2  */
id|tempcx
op_rshift_assign
l_int|1
suffix:semicolon
id|tempbx
op_assign
id|tempbx
op_plus
id|tempcx
suffix:semicolon
id|tempbx
op_increment
suffix:semicolon
multiline_comment|/* BPLVRS  */
r_if
c_cond
(paren
id|tempbx
op_ge
id|tempax
)paren
(brace
id|tempbx
op_assign
id|tempbx
op_minus
id|tempax
suffix:semicolon
)brace
id|temp
op_assign
id|tempbx
op_amp
l_int|0x00FF
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x18
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* Part1_18h  */
id|tempcx
op_rshift_assign
l_int|3
suffix:semicolon
id|tempcx
op_assign
id|tempcx
op_plus
id|tempbx
suffix:semicolon
id|tempcx
op_increment
suffix:semicolon
multiline_comment|/* BPLVRE  */
id|temp
op_assign
id|tempcx
op_amp
l_int|0x00FF
suffix:semicolon
id|temp
op_and_assign
l_int|0x0F
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|1
)paren
(brace
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x19
comma
l_int|0xf0
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* TW: Inserted from 650/LVDS BIOS */
)brace
r_else
(brace
id|temp
op_or_assign
l_int|0x30
suffix:semicolon
multiline_comment|/* TW: Inserted from 650/301 BIOS */
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x19
comma
l_int|0xC0
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* Part1_19h  (Was ~0x0f) */
)brace
id|temp
op_assign
(paren
id|tempbx
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
suffix:semicolon
id|temp
op_and_assign
l_int|0x07
suffix:semicolon
id|temp
op_lshift_assign
l_int|3
suffix:semicolon
multiline_comment|/* BPLDESKEW =0 */
id|tempbx
op_assign
id|SiS_VGAVDE
suffix:semicolon
r_if
c_cond
(paren
id|tempbx
op_ne
id|SiS_VDE
)paren
(brace
id|temp
op_or_assign
l_int|0x40
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_SetFlag
op_amp
id|EnableLVDSDDA
)paren
(brace
id|temp
op_or_assign
l_int|0x40
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|1
)paren
(brace
r_if
c_cond
(paren
id|SiS_LCDInfo
op_amp
id|LCDRGB18Bit
)paren
(brace
id|temp
op_or_assign
l_int|0x80
suffix:semicolon
)brace
multiline_comment|/* TW: 650/301 BIOS does not check this! */
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x1A
comma
l_int|0x87
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* Part1_1Ah */
)brace
r_else
(brace
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x1A
comma
l_int|0x07
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* Part1_1Ah */
)brace
id|tempbx
op_assign
id|push2
suffix:semicolon
multiline_comment|/* p bx temppush2 BPLVDEE  */
id|tempcx
op_assign
id|push1
suffix:semicolon
multiline_comment|/* pop cx temppush1 NPLVDES */
id|push1
op_assign
(paren
id|USHORT
)paren
(paren
id|tempeax
op_amp
l_int|0xFFFF
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
)paren
(brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel800x600
)paren
(brace
r_if
c_cond
(paren
id|resinfo
op_eq
l_int|7
)paren
(brace
id|tempcx
op_increment
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|0
)paren
(brace
multiline_comment|/* TW: Inserted from 650/LVDS BIOS */
r_if
c_cond
(paren
id|resinfo
op_eq
l_int|8
)paren
(brace
id|tempcx
op_increment
suffix:semicolon
)brace
multiline_comment|/* TW: Modified according to 650/301 BIOSes */
)brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel640x480
)paren
(brace
multiline_comment|/* TW: Inserted from 650/301+LVDS BIOSes */
id|tempbx
op_assign
id|SiS_VGAVDE
suffix:semicolon
multiline_comment|/* TW: Inserted from 650/301+LVDS BIOS */
id|tempcx
op_assign
id|tempbx
suffix:semicolon
multiline_comment|/* TW: Inserted from 650/301+LVDS BIOS */
id|tempbx
op_decrement
suffix:semicolon
multiline_comment|/* TW: Inserted from 650/301+LVDS BIOS */
)brace
)brace
id|temp
op_assign
(paren
id|tempbx
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
suffix:semicolon
id|temp
op_and_assign
l_int|0x07
suffix:semicolon
id|temp
op_lshift_assign
l_int|3
suffix:semicolon
id|temp
op_assign
id|temp
op_or
(paren
(paren
(paren
id|tempcx
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
)paren
op_amp
l_int|0x07
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x1D
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* Part1_1Dh */
id|temp
op_assign
id|tempbx
op_amp
l_int|0x00FF
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x1C
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* Part1_1Ch  */
id|temp
op_assign
id|tempcx
op_amp
l_int|0x00FF
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x1B
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* Part1_1Bh  */
id|tempecx
op_assign
id|SiS_VGAVT
suffix:semicolon
id|tempebx
op_assign
id|SiS_VDE
suffix:semicolon
id|tempeax
op_assign
id|SiS_VGAVDE
suffix:semicolon
id|tempecx
op_assign
id|tempecx
op_minus
id|tempeax
suffix:semicolon
multiline_comment|/* VGAVT-VGAVDE  */
id|tempeax
op_lshift_assign
l_int|18
suffix:semicolon
id|temp
op_assign
(paren
id|USHORT
)paren
(paren
id|tempeax
op_mod
id|tempebx
)paren
suffix:semicolon
id|tempeax
op_assign
id|tempeax
op_div
id|tempebx
suffix:semicolon
r_if
c_cond
(paren
id|temp
op_ne
l_int|0
)paren
(brace
id|tempeax
op_increment
suffix:semicolon
)brace
id|tempebx
op_assign
id|tempeax
suffix:semicolon
multiline_comment|/* BPLVCFACT  */
id|tempvcfact
op_assign
id|tempeax
suffix:semicolon
id|temp
op_assign
(paren
id|USHORT
)paren
(paren
id|tempebx
op_amp
l_int|0x00FF
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x37
comma
id|temp
)paren
suffix:semicolon
id|temp
op_assign
(paren
id|USHORT
)paren
(paren
(paren
id|tempebx
op_amp
l_int|0x00FF00
)paren
op_rshift
l_int|8
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x36
comma
id|temp
)paren
suffix:semicolon
id|temp
op_assign
(paren
id|USHORT
)paren
(paren
(paren
id|tempebx
op_amp
l_int|0x00030000
)paren
op_rshift
l_int|16
)paren
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VDE
op_eq
id|SiS_VGAVDE
)paren
(brace
id|temp
op_or_assign
l_int|0x04
suffix:semicolon
)brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x35
comma
id|temp
)paren
suffix:semicolon
id|tempecx
op_assign
id|SiS_VGAHDE
suffix:semicolon
id|tempebx
op_assign
id|SiS_HDE
suffix:semicolon
id|tempeax
op_assign
id|tempecx
suffix:semicolon
id|tempeax
op_lshift_assign
l_int|16
suffix:semicolon
id|tempeax
op_assign
id|tempeax
op_div
id|tempebx
suffix:semicolon
r_if
c_cond
(paren
id|tempebx
op_eq
id|tempecx
)paren
(brace
id|tempeax
op_assign
l_int|0xFFFF
suffix:semicolon
)brace
id|tempecx
op_assign
id|tempeax
suffix:semicolon
id|tempeax
op_assign
id|SiS_VGAHDE
suffix:semicolon
id|tempeax
op_lshift_assign
l_int|16
suffix:semicolon
id|tempeax
op_assign
id|tempeax
op_div
id|tempecx
suffix:semicolon
id|tempecx
op_lshift_assign
l_int|16
suffix:semicolon
id|tempeax
op_decrement
suffix:semicolon
id|tempecx
op_assign
id|tempecx
op_or
(paren
id|tempeax
op_amp
l_int|0xFFFF
)paren
suffix:semicolon
id|temp
op_assign
(paren
id|USHORT
)paren
(paren
id|tempecx
op_amp
l_int|0x00FF
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x1F
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* Part1_1Fh  */
id|tempeax
op_assign
id|SiS_VGAVDE
suffix:semicolon
id|tempeax
op_lshift_assign
l_int|18
suffix:semicolon
id|tempeax
op_assign
id|tempeax
op_div
id|tempvcfact
suffix:semicolon
id|tempbx
op_assign
(paren
id|USHORT
)paren
(paren
id|tempeax
op_amp
l_int|0x0FFFF
)paren
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1024x768
)paren
(brace
id|tempbx
op_decrement
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_SetFlag
op_amp
id|EnableLVDSDDA
)paren
(brace
id|tempbx
op_assign
l_int|1
suffix:semicolon
)brace
id|temp
op_assign
(paren
(paren
id|tempbx
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
)paren
op_lshift
l_int|3
suffix:semicolon
id|temp
op_assign
id|temp
op_or
(paren
id|USHORT
)paren
(paren
(paren
(paren
id|tempecx
op_amp
l_int|0x0000FF00
)paren
op_rshift
l_int|8
)paren
op_amp
l_int|0x07
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x20
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* Part1_20h */
id|temp
op_assign
id|tempbx
op_amp
l_int|0x00FF
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x21
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* Part1_21h */
id|tempecx
op_rshift_assign
l_int|16
suffix:semicolon
multiline_comment|/* BPLHCFACT  */
r_if
c_cond
(paren
op_logical_neg
(paren
id|modeflag
op_amp
id|HalfDCLK
)paren
)paren
(brace
id|tempecx
op_rshift_assign
l_int|1
suffix:semicolon
)brace
multiline_comment|/* TW: Inserted from BIOS */
id|temp
op_assign
(paren
id|USHORT
)paren
(paren
(paren
id|tempecx
op_amp
l_int|0x0000FF00
)paren
op_rshift
l_int|8
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x22
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* Part1_22h */
id|temp
op_assign
(paren
id|USHORT
)paren
(paren
id|tempecx
op_amp
l_int|0x000000FF
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x23
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* TW: Only for 650/LVDS and 301LV/302LV */
r_if
c_cond
(paren
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|1
)paren
op_logical_or
(paren
id|SiS_VBInfo
op_amp
(paren
id|VB_SIS301LV
op_or
id|VB_SIS302LV
)paren
)paren
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x1e
comma
l_int|0x20
)paren
suffix:semicolon
)brace
r_return
suffix:semicolon
)brace
multiline_comment|/* TW: Double-checked against 650/LVDS (1.10.07) and 650/301 BIOS */
DECL|function|SiS_SetCRT2Offset
r_void
id|SiS_SetCRT2Offset
c_func
(paren
id|USHORT
id|SiS_Part1Port
comma
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
comma
id|USHORT
id|RefreshRateTableIndex
comma
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
)paren
(brace
id|USHORT
id|offset
suffix:semicolon
id|UCHAR
id|temp
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
(brace
r_return
suffix:semicolon
)brace
id|offset
op_assign
id|SiS_GetOffset
c_func
(paren
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|RefreshRateTableIndex
comma
id|HwDeviceExtension
)paren
suffix:semicolon
id|temp
op_assign
(paren
id|UCHAR
)paren
(paren
id|offset
op_amp
l_int|0xFF
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x07
comma
id|temp
)paren
suffix:semicolon
id|temp
op_assign
(paren
id|UCHAR
)paren
(paren
(paren
id|offset
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x09
comma
id|temp
)paren
suffix:semicolon
id|temp
op_assign
(paren
id|UCHAR
)paren
(paren
(paren
(paren
id|offset
op_rshift
l_int|3
)paren
op_amp
l_int|0xFF
)paren
op_plus
l_int|1
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x03
comma
id|temp
)paren
suffix:semicolon
)brace
multiline_comment|/* TW: Checked with 650/LVDS and 650/301 BIOS */
id|USHORT
DECL|function|SiS_GetOffset
id|SiS_GetOffset
c_func
(paren
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
comma
id|USHORT
id|RefreshRateTableIndex
comma
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
)paren
(brace
id|USHORT
id|temp
comma
id|colordepth
suffix:semicolon
id|USHORT
id|modeinfo
comma
id|index
comma
id|infoflag
suffix:semicolon
id|USHORT
id|mode960low
comma
id|mode960high
suffix:semicolon
macro_line|#if 0
id|USHORT
id|ColorDepth
(braket
)braket
op_assign
(brace
l_int|0x01
comma
l_int|0x02
comma
l_int|0x04
)brace
suffix:semicolon
macro_line|#endif
id|modeinfo
op_assign
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|Ext_ModeInfo
suffix:semicolon
id|infoflag
op_assign
id|SiS_RefIndex
(braket
id|RefreshRateTableIndex
)braket
dot
id|Ext_InfoFlag
suffix:semicolon
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
id|index
op_assign
(paren
id|modeinfo
op_rshift
l_int|4
)paren
op_amp
l_int|0xFF
suffix:semicolon
multiline_comment|/* TW: Modes 1280x960 changed number, so this is redundant */
id|mode960low
op_assign
l_int|0x7c
suffix:semicolon
id|mode960high
op_assign
l_int|0x7e
suffix:semicolon
)brace
r_else
(brace
id|index
op_assign
(paren
id|modeinfo
op_rshift
l_int|8
)paren
op_amp
l_int|0xFF
suffix:semicolon
multiline_comment|/* TW: In 650 BIOS (LVDS AND 301), 1280x960 modes are 7b-7d! */
id|mode960low
op_assign
l_int|0x7c
suffix:semicolon
multiline_comment|/* TW: This is a bug in both BIOS versions ! */
id|mode960high
op_assign
l_int|0x7e
suffix:semicolon
multiline_comment|/* TW: Corrected here in LVDS BIOS 1.10.07, but not in tables! */
)brace
macro_line|#if 0
multiline_comment|/* TW: Not doing this strange stuff makes 1280x960 at least work on CRT1 */
r_if
c_cond
(paren
(paren
id|ModeNo
op_ge
id|mode960low
)paren
op_logical_and
(paren
id|ModeNo
op_le
id|mode960high
)paren
)paren
(brace
id|temp
op_assign
id|ModeNo
op_minus
id|mode960low
suffix:semicolon
id|colordepth
op_assign
id|ColorDepth
(braket
id|temp
)braket
suffix:semicolon
id|temp
op_assign
l_int|0x6b
suffix:semicolon
multiline_comment|/* TW: Why the heck? */
)brace
r_else
(brace
macro_line|#endif
id|temp
op_assign
id|SiS_ScreenOffset
(braket
id|index
)braket
suffix:semicolon
id|colordepth
op_assign
id|SiS_GetColorDepth
c_func
(paren
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
)paren
suffix:semicolon
macro_line|#if 0
)brace
macro_line|#endif
r_if
c_cond
(paren
id|infoflag
op_amp
id|InterlaceMode
)paren
(brace
id|temp
op_lshift_assign
l_int|1
suffix:semicolon
)brace
id|temp
op_mul_assign
id|colordepth
suffix:semicolon
multiline_comment|/* TW: Added this entire &quot;if&quot;-section from 650/LVDS BIOS */
r_if
c_cond
(paren
(paren
id|ModeNo
op_ge
l_int|0x26
)paren
op_logical_and
(paren
id|ModeNo
op_le
l_int|0x28
)paren
)paren
(brace
id|colordepth
op_rshift_assign
l_int|1
suffix:semicolon
id|temp
op_add_assign
id|colordepth
suffix:semicolon
)brace
r_return
id|temp
suffix:semicolon
)brace
multiline_comment|/* Checked with 650/LVDS BIOS */
id|USHORT
DECL|function|SiS_GetColorDepth
id|SiS_GetColorDepth
c_func
(paren
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
)paren
(brace
id|USHORT
id|ColorDepth
(braket
l_int|6
)braket
op_assign
(brace
l_int|1
comma
l_int|2
comma
l_int|4
comma
l_int|4
comma
l_int|6
comma
l_int|8
)brace
suffix:semicolon
id|SHORT
id|index
suffix:semicolon
id|USHORT
id|modeflag
suffix:semicolon
r_if
c_cond
(paren
id|ModeNo
op_le
l_int|0x13
)paren
(brace
id|modeflag
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_ModeFlag
suffix:semicolon
)brace
r_else
id|modeflag
op_assign
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|Ext_ModeFlag
suffix:semicolon
id|index
op_assign
(paren
id|modeflag
op_amp
id|ModeInfoFlag
)paren
op_minus
id|ModeEGA
suffix:semicolon
r_if
c_cond
(paren
id|index
OL
l_int|0
)paren
(brace
id|index
op_assign
l_int|0
suffix:semicolon
)brace
r_return
id|ColorDepth
(braket
id|index
)braket
suffix:semicolon
)brace
multiline_comment|/* TW: Checked against 650/LVDS (1.10.07), 650/301 and 630/301B BIOS */
r_void
DECL|function|SiS_SetCRT2Sync
id|SiS_SetCRT2Sync
c_func
(paren
id|USHORT
id|BaseAddr
comma
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|RefreshRateTableIndex
comma
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
)paren
(brace
id|USHORT
id|tempah
op_assign
l_int|0
comma
id|tempbl
comma
id|infoflag
comma
id|flag
suffix:semicolon
id|flag
op_assign
l_int|0
suffix:semicolon
id|tempbl
op_assign
l_int|0xC0
suffix:semicolon
multiline_comment|/* TW: Severe BIOS bug in all BIOSes except 650/LVDS 1.10.07 */
id|infoflag
op_assign
id|SiS_RefIndex
(braket
id|RefreshRateTableIndex
)braket
dot
id|Ext_InfoFlag
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|1
)paren
(brace
multiline_comment|/* LVDS */
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCD
)paren
(brace
id|tempah
op_assign
id|SiS_LCDInfo
suffix:semicolon
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
id|tempbl
op_assign
id|tempah
op_amp
l_int|0xc0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_LCDInfo
op_amp
id|LCDSync
)paren
(brace
id|flag
op_assign
l_int|1
suffix:semicolon
)brace
)brace
)brace
r_else
r_if
c_cond
(paren
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
op_logical_and
multiline_comment|/* 630/301B */
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCD
)paren
(brace
id|tempah
op_assign
id|SiS_LCDInfo
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDInfo
op_amp
id|LCDSync
)paren
(brace
id|flag
op_assign
l_int|1
suffix:semicolon
)brace
)brace
)brace
r_else
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
multiline_comment|/* 630/301 */
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCD
)paren
(brace
id|tempah
op_assign
id|SiS_LCDInfo
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDInfo
op_amp
id|LCDNonExpandingShift
)paren
(brace
id|flag
op_assign
l_int|1
suffix:semicolon
)brace
)brace
)brace
r_if
c_cond
(paren
id|flag
op_ne
l_int|1
)paren
(brace
id|tempah
op_assign
id|infoflag
op_rshift
l_int|8
suffix:semicolon
)brace
id|tempah
op_and_assign
l_int|0xC0
suffix:semicolon
id|tempah
op_or_assign
l_int|0x20
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_LCDInfo
op_amp
id|LCDRGB18Bit
)paren
)paren
(brace
id|tempah
op_or_assign
l_int|0x10
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel640x480
)paren
(brace
multiline_comment|/* TW: BIOS does something here (301, 301LV and LVDS) @@@ */
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBType
op_amp
id|VB_SIS301
)paren
)paren
(brace
id|tempah
op_and_assign
l_int|0x3f
suffix:semicolon
id|tempah
op_or_assign
id|tempbl
suffix:semicolon
)brace
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x19
comma
l_int|0x3F
comma
id|tempah
)paren
suffix:semicolon
)brace
multiline_comment|/* TW: Set FIFO on 300 series */
multiline_comment|/* TW: Checked against 630/301B BIOS; does not set PCI registers */
r_void
DECL|function|SiS_SetCRT2FIFO_300
id|SiS_SetCRT2FIFO_300
c_func
(paren
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
)paren
(brace
id|USHORT
id|temp
comma
id|index
suffix:semicolon
id|USHORT
id|modeidindex
comma
id|refreshratetableindex
suffix:semicolon
id|USHORT
id|VCLK
comma
id|MCLK
comma
id|colorth
op_assign
l_int|0
comma
id|data2
suffix:semicolon
id|ULONG
id|data
comma
id|eax
suffix:semicolon
id|UCHAR
id|LatencyFactor
(braket
)braket
op_assign
(brace
l_int|97
comma
l_int|88
comma
l_int|86
comma
l_int|79
comma
l_int|77
comma
l_int|00
comma
multiline_comment|/*; 64  bit    BQ=2   */
l_int|00
comma
l_int|87
comma
l_int|85
comma
l_int|78
comma
l_int|76
comma
l_int|54
comma
multiline_comment|/*; 64  bit    BQ=1   */
l_int|97
comma
l_int|88
comma
l_int|86
comma
l_int|79
comma
l_int|77
comma
l_int|00
comma
multiline_comment|/*; 128 bit    BQ=2   */
l_int|00
comma
l_int|79
comma
l_int|77
comma
l_int|70
comma
l_int|68
comma
l_int|48
comma
multiline_comment|/*; 128 bit    BQ=1   */
l_int|80
comma
l_int|72
comma
l_int|69
comma
l_int|63
comma
l_int|61
comma
l_int|00
comma
multiline_comment|/*; 64  bit    BQ=2   */
l_int|00
comma
l_int|70
comma
l_int|68
comma
l_int|61
comma
l_int|59
comma
l_int|37
comma
multiline_comment|/*; 64  bit    BQ=1   */
l_int|86
comma
l_int|77
comma
l_int|75
comma
l_int|68
comma
l_int|66
comma
l_int|00
comma
multiline_comment|/*; 128 bit    BQ=2   */
l_int|00
comma
l_int|68
comma
l_int|66
comma
l_int|59
comma
l_int|57
comma
l_int|37
)brace
suffix:semicolon
multiline_comment|/*; 128 bit    BQ=1   */
id|SiS_SearchModeID
c_func
(paren
id|ROMAddr
comma
op_amp
id|ModeNo
comma
op_amp
id|modeidindex
)paren
suffix:semicolon
id|SiS_SetFlag
op_and_assign
(paren
op_complement
id|ProgrammingCRT2
)paren
suffix:semicolon
id|SiS_SelectCRT2Rate
op_assign
l_int|0
suffix:semicolon
id|refreshratetableindex
op_assign
id|SiS_GetRatePtrCRT2
c_func
(paren
id|ROMAddr
comma
id|ModeNo
comma
id|modeidindex
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ModeNo
op_ge
l_int|0x13
)paren
(brace
id|index
op_assign
id|SiS_RefIndex
(braket
id|refreshratetableindex
)braket
dot
id|Ext_CRTVCLK
suffix:semicolon
id|index
op_and_assign
l_int|0x3F
suffix:semicolon
id|VCLK
op_assign
id|SiS_VCLKData
(braket
id|index
)braket
dot
id|CLOCK
suffix:semicolon
id|index
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x1A
)paren
suffix:semicolon
id|index
op_and_assign
l_int|0x07
suffix:semicolon
id|MCLK
op_assign
id|SiS_MCLKData_0
(braket
id|index
)braket
dot
id|CLOCK
suffix:semicolon
id|data2
op_assign
id|SiS_ModeType
op_minus
l_int|0x02
suffix:semicolon
r_switch
c_cond
(paren
id|data2
)paren
(brace
r_case
l_int|0
suffix:colon
id|colorth
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|colorth
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|colorth
op_assign
l_int|2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
id|colorth
op_assign
l_int|2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|4
suffix:colon
id|colorth
op_assign
l_int|3
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|5
suffix:colon
id|colorth
op_assign
l_int|4
suffix:semicolon
r_break
suffix:semicolon
)brace
multiline_comment|/* data2=(data2*VCLK)/MCLK;   */
multiline_comment|/*  bx */
id|data2
op_assign
(paren
id|colorth
op_star
id|VCLK
)paren
op_div
id|MCLK
suffix:semicolon
multiline_comment|/* TW */
id|temp
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x14
)paren
suffix:semicolon
id|temp
op_assign
(paren
(paren
id|temp
op_amp
l_int|0x00FF
)paren
op_rshift
l_int|6
)paren
op_lshift
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|temp
op_eq
l_int|0
)paren
(brace
id|temp
op_assign
l_int|1
suffix:semicolon
)brace
id|temp
op_lshift_assign
l_int|2
suffix:semicolon
id|data2
op_assign
id|temp
op_minus
id|data2
suffix:semicolon
multiline_comment|/*  if(data2%(28*16)) {&t;&t; TW: WRONG&n;      &t;data2=data2/(28*16);&n;      &t;data2++;&n;    } else {&n;      &t;data2=data2/(28*16);&n;    } */
r_if
c_cond
(paren
(paren
l_int|28
op_star
l_int|16
)paren
op_mod
id|data2
)paren
(brace
multiline_comment|/* TW */
id|data2
op_assign
(paren
l_int|28
op_star
l_int|16
)paren
op_div
id|data2
suffix:semicolon
id|data2
op_increment
suffix:semicolon
)brace
r_else
(brace
id|data2
op_assign
(paren
l_int|28
op_star
l_int|16
)paren
op_div
id|data2
suffix:semicolon
)brace
id|index
op_assign
l_int|0
suffix:semicolon
id|temp
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x14
)paren
suffix:semicolon
r_if
c_cond
(paren
id|temp
op_amp
l_int|0x0080
)paren
(brace
id|index
op_add_assign
l_int|12
suffix:semicolon
)brace
macro_line|#ifndef LINUX_XF86
id|SiS_SetReg4
c_func
(paren
l_int|0xcf8
comma
l_int|0x800000A0
)paren
suffix:semicolon
id|eax
op_assign
id|SiS_GetReg3
c_func
(paren
l_int|0xcfc
)paren
suffix:semicolon
macro_line|#else
multiline_comment|/* TW: We use pci functions X offers. We use tag 0, because&n;   * we want to read/write to the host bridge (which is always&n;   * 00:00.0 on 630, 730 and 540), not the VGA device.&n;   */
id|eax
op_assign
id|pciReadLong
c_func
(paren
l_int|0x00000000
comma
l_int|0xA0
)paren
suffix:semicolon
macro_line|#endif
id|temp
op_assign
(paren
id|USHORT
)paren
(paren
id|eax
op_rshift
l_int|24
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|temp
op_amp
l_int|0x01
)paren
)paren
(brace
id|index
op_add_assign
l_int|24
suffix:semicolon
)brace
macro_line|#ifndef LINUX_XF86
id|SiS_SetReg4
c_func
(paren
l_int|0xcf8
comma
l_int|0x80000050
)paren
suffix:semicolon
id|eax
op_assign
id|SiS_GetReg3
c_func
(paren
l_int|0xcfc
)paren
suffix:semicolon
macro_line|#else
id|eax
op_assign
id|pciReadLong
c_func
(paren
l_int|0x00000000
comma
l_int|0x50
)paren
suffix:semicolon
macro_line|#endif
id|temp
op_assign
(paren
id|USHORT
)paren
(paren
id|eax
op_rshift
l_int|24
)paren
suffix:semicolon
r_if
c_cond
(paren
id|temp
op_amp
l_int|0x01
)paren
(brace
id|index
op_add_assign
l_int|6
suffix:semicolon
)brace
id|temp
op_assign
(paren
id|temp
op_amp
l_int|0x0F
)paren
op_rshift
l_int|1
suffix:semicolon
id|index
op_add_assign
id|temp
suffix:semicolon
id|data
op_assign
id|LatencyFactor
(braket
id|index
)braket
suffix:semicolon
id|data
op_add_assign
l_int|15
suffix:semicolon
id|temp
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x14
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|temp
op_amp
l_int|0x80
)paren
)paren
(brace
id|data
op_add_assign
l_int|5
suffix:semicolon
)brace
id|data
op_add_assign
id|data2
suffix:semicolon
id|SiS_SetFlag
op_or_assign
id|ProgrammingCRT2
suffix:semicolon
id|data
op_assign
id|data
op_star
id|VCLK
op_star
id|colorth
suffix:semicolon
r_if
c_cond
(paren
id|data
op_mod
(paren
id|MCLK
op_lshift
l_int|4
)paren
)paren
(brace
id|data
op_assign
id|data
op_div
(paren
id|MCLK
op_lshift
l_int|4
)paren
suffix:semicolon
id|data
op_increment
suffix:semicolon
)brace
r_else
(brace
id|data
op_assign
id|data
op_div
(paren
id|MCLK
op_lshift
l_int|4
)paren
suffix:semicolon
)brace
multiline_comment|/* TW: Inserted this entire section */
id|temp
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x01
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
(paren
id|HwDeviceExtension-&gt;jChipType
op_eq
id|SIS_630
)paren
op_logical_or
(paren
id|HwDeviceExtension-&gt;jChipType
op_eq
id|SIS_730
)paren
)paren
op_logical_and
(paren
id|HwDeviceExtension-&gt;jChipRevision
op_ge
l_int|0x30
)paren
)paren
multiline_comment|/* 630s or 730(s?) */
(brace
id|temp
op_assign
(paren
id|temp
op_amp
(paren
op_complement
l_int|0x1F
)paren
)paren
op_or
l_int|0x1b
suffix:semicolon
)brace
r_else
(brace
id|temp
op_assign
(paren
id|temp
op_amp
(paren
op_complement
l_int|0x1F
)paren
)paren
op_or
l_int|0x16
suffix:semicolon
)brace
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x01
comma
l_int|0xe0
comma
id|temp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|data
op_le
l_int|6
)paren
(brace
id|data
op_assign
l_int|6
suffix:semicolon
)brace
r_if
c_cond
(paren
id|data
OG
l_int|0x14
)paren
(brace
id|data
op_assign
l_int|0x14
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|HwDeviceExtension-&gt;jChipType
op_eq
id|SIS_630
)paren
op_logical_and
(paren
id|HwDeviceExtension-&gt;jChipRevision
op_ge
l_int|0x30
)paren
)paren
multiline_comment|/* 630s, NOT 730 */
(brace
r_if
c_cond
(paren
id|data
OG
l_int|0x13
)paren
(brace
id|data
op_assign
l_int|0x13
suffix:semicolon
)brace
)brace
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x02
comma
op_complement
l_int|0x01F
comma
id|data
)paren
suffix:semicolon
multiline_comment|/* TW end */
)brace
)brace
multiline_comment|/* TW: Set FIFO on 310 series */
macro_line|#ifdef SIS315H
r_void
DECL|function|SiS_SetCRT2FIFO_310
id|SiS_SetCRT2FIFO_310
c_func
(paren
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
)paren
(brace
id|UCHAR
id|CombCode
(braket
)braket
op_assign
(brace
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|4
comma
l_int|3
comma
l_int|1
comma
l_int|3
comma
l_int|4
comma
l_int|4
comma
l_int|1
comma
l_int|4
comma
l_int|4
comma
l_int|5
comma
l_int|1
comma
l_int|5
comma
l_int|4
)brace
suffix:semicolon
id|UCHAR
id|CRT2ThLow
(braket
)braket
op_assign
(brace
l_int|39
comma
l_int|63
comma
l_int|55
comma
l_int|79
comma
l_int|78
comma
l_int|102
comma
l_int|90
comma
l_int|114
comma
l_int|55
comma
l_int|87
comma
l_int|84
comma
l_int|116
comma
l_int|103
comma
l_int|135
comma
l_int|119
comma
l_int|151
)brace
suffix:semicolon
id|USHORT
id|temp3
comma
id|tempax
comma
id|tempbx
comma
id|tempcx
suffix:semicolon
id|USHORT
id|tempcl
comma
id|tempch
suffix:semicolon
id|USHORT
id|index
suffix:semicolon
id|USHORT
id|CRT1ModeNo
comma
id|CRT2ModeNo
suffix:semicolon
id|USHORT
id|ModeIdIndex
suffix:semicolon
id|USHORT
id|RefreshRateTableIndex
suffix:semicolon
id|USHORT
id|SelectRate_backup
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x01
comma
l_int|0x3B
)paren
suffix:semicolon
id|CRT1ModeNo
op_assign
id|SiS_CRT1Mode
suffix:semicolon
multiline_comment|/* get CRT1 ModeNo */
id|SiS_SearchModeID
c_func
(paren
id|ROMAddr
comma
op_amp
id|CRT1ModeNo
comma
op_amp
id|ModeIdIndex
)paren
suffix:semicolon
id|SiS_SetFlag
op_and_assign
(paren
op_complement
id|ProgrammingCRT2
)paren
suffix:semicolon
id|SelectRate_backup
op_assign
id|SiS_SelectCRT2Rate
suffix:semicolon
id|SiS_SelectCRT2Rate
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* Set REFIndex for crt1 refreshrate */
id|RefreshRateTableIndex
op_assign
id|SiS_GetRatePtrCRT2
c_func
(paren
id|ROMAddr
comma
id|CRT1ModeNo
comma
id|ModeIdIndex
)paren
suffix:semicolon
id|index
op_assign
id|SiS_GetVCLK2Ptr
c_func
(paren
id|ROMAddr
comma
id|CRT1ModeNo
comma
id|ModeIdIndex
comma
id|RefreshRateTableIndex
comma
id|HwDeviceExtension
)paren
suffix:semicolon
id|tempax
op_assign
id|SiS_VCLKData
(braket
id|index
)braket
dot
id|CLOCK
suffix:semicolon
multiline_comment|/* Get DCLK (VCLK?) */
id|tempbx
op_assign
id|SiS_GetColorDepth
c_func
(paren
id|ROMAddr
comma
id|CRT1ModeNo
comma
id|ModeIdIndex
)paren
suffix:semicolon
multiline_comment|/* Get colordepth */
id|tempbx
op_rshift_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|tempbx
)paren
(brace
id|tempbx
op_increment
suffix:semicolon
)brace
id|tempax
op_mul_assign
id|tempbx
suffix:semicolon
id|tempbx
op_assign
id|SiS_GetMCLK
c_func
(paren
id|ROMAddr
comma
id|HwDeviceExtension
)paren
suffix:semicolon
multiline_comment|/* Get MCLK */
id|tempax
op_div_assign
id|tempbx
suffix:semicolon
id|tempbx
op_assign
id|tempax
suffix:semicolon
macro_line|#if 0 /* TW: BIOS code is skrewed */
r_if
c_cond
(paren
id|SiS_GetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x14
)paren
op_amp
l_int|0x02
)paren
(brace
id|tempax
op_assign
l_int|16
suffix:semicolon
)brace
r_else
(brace
id|tempax
op_assign
l_int|8
suffix:semicolon
)brace
macro_line|#endif
id|tempax
op_assign
l_int|16
suffix:semicolon
id|tempax
op_sub_assign
id|tempbx
suffix:semicolon
id|tempbx
op_assign
id|tempax
suffix:semicolon
multiline_comment|/* tempbx = 16-DRamBus - DCLK*BytePerPixel/MCLK */
id|tempax
op_assign
(paren
(paren
l_int|52
op_star
l_int|16
)paren
op_div
id|tempbx
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
l_int|52
op_star
l_int|16
op_mod
id|tempbx
)paren
op_ne
l_int|0
)paren
(brace
id|tempax
op_increment
suffix:semicolon
)brace
id|tempcx
op_assign
id|tempax
suffix:semicolon
id|tempcx
op_add_assign
l_int|40
suffix:semicolon
multiline_comment|/* get DRAM latency */
id|tempcl
op_assign
(paren
id|SiS_GetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x17
)paren
op_rshift
l_int|3
)paren
op_amp
l_int|0x7
suffix:semicolon
multiline_comment|/* SR17[5:3] DRAM Queue depth */
id|tempch
op_assign
(paren
id|SiS_GetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x17
)paren
op_rshift
l_int|6
)paren
op_amp
l_int|0x3
suffix:semicolon
multiline_comment|/* SR17[7:6] DRAM Grant length */
r_for
c_loop
(paren
id|temp3
op_assign
l_int|0
suffix:semicolon
id|temp3
OL
l_int|16
suffix:semicolon
id|temp3
op_add_assign
l_int|2
)paren
(brace
r_if
c_cond
(paren
(paren
id|CombCode
(braket
id|temp3
)braket
op_eq
id|tempcl
)paren
op_logical_and
(paren
id|CombCode
(braket
id|temp3
op_plus
l_int|1
)braket
op_eq
id|tempch
)paren
)paren
(brace
id|temp3
op_assign
id|CRT2ThLow
(braket
id|temp3
op_rshift
l_int|1
)braket
suffix:semicolon
)brace
)brace
id|tempcx
op_add_assign
id|temp3
suffix:semicolon
multiline_comment|/* CRT1 Request Period */
id|CRT2ModeNo
op_assign
id|ModeNo
suffix:semicolon
multiline_comment|/* get CRT2 ModeNo */
id|SiS_SearchModeID
c_func
(paren
id|ROMAddr
comma
op_amp
id|CRT2ModeNo
comma
op_amp
id|ModeIdIndex
)paren
suffix:semicolon
multiline_comment|/* Get ModeID Table */
id|SiS_SetFlag
op_or_assign
id|ProgrammingCRT2
suffix:semicolon
id|SiS_SelectCRT2Rate
op_assign
id|SelectRate_backup
suffix:semicolon
id|RefreshRateTableIndex
op_assign
id|SiS_GetRatePtrCRT2
c_func
(paren
id|ROMAddr
comma
id|CRT1ModeNo
comma
id|ModeIdIndex
)paren
suffix:semicolon
id|index
op_assign
id|SiS_GetVCLK2Ptr
c_func
(paren
id|ROMAddr
comma
id|CRT2ModeNo
comma
id|ModeIdIndex
comma
id|RefreshRateTableIndex
comma
id|HwDeviceExtension
)paren
suffix:semicolon
id|tempax
op_assign
id|SiS_VCLKData
(braket
id|index
)braket
dot
id|CLOCK
suffix:semicolon
multiline_comment|/* Get VCLK  */
id|tempbx
op_assign
id|SiS_GetColorDepth
c_func
(paren
id|ROMAddr
comma
id|CRT2ModeNo
comma
id|ModeIdIndex
)paren
suffix:semicolon
multiline_comment|/* Get colordepth */
id|tempbx
op_rshift_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|tempbx
)paren
(brace
id|tempbx
op_increment
suffix:semicolon
)brace
id|tempax
op_mul_assign
id|tempbx
suffix:semicolon
id|tempax
op_mul_assign
id|tempcx
suffix:semicolon
id|tempbx
op_assign
id|SiS_GetMCLK
c_func
(paren
id|ROMAddr
comma
id|HwDeviceExtension
)paren
suffix:semicolon
multiline_comment|/* Get MCLK */
id|tempbx
op_lshift_assign
l_int|4
suffix:semicolon
id|tempcx
op_assign
id|tempax
suffix:semicolon
id|tempax
op_div_assign
id|tempbx
suffix:semicolon
r_if
c_cond
(paren
id|tempcx
op_mod
id|tempbx
)paren
(brace
id|tempax
op_increment
suffix:semicolon
)brace
multiline_comment|/* CRT1 Request period * TCLK * BytePerPixel / (MCLK*16) */
r_if
c_cond
(paren
id|tempax
OG
l_int|0x37
)paren
id|tempax
op_assign
l_int|0x37
suffix:semicolon
multiline_comment|/* TW: 650/LVDS (1.10.07, 1.10.00), 650/301LV overrule calculated value; 315 does not */
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_eq
id|SIS_650
)paren
(brace
id|tempax
op_assign
l_int|0x04
suffix:semicolon
)brace
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x02
comma
op_complement
l_int|0x3F
comma
id|tempax
)paren
suffix:semicolon
)brace
id|USHORT
DECL|function|SiS_GetMCLK
id|SiS_GetMCLK
c_func
(paren
id|UCHAR
op_star
id|ROMAddr
comma
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
)paren
(brace
id|USHORT
id|index
suffix:semicolon
id|index
op_assign
id|SiS_Get310DRAMType
c_func
(paren
id|ROMAddr
comma
id|HwDeviceExtension
)paren
suffix:semicolon
r_if
c_cond
(paren
id|index
op_ge
l_int|4
)paren
(brace
id|index
op_sub_assign
l_int|4
suffix:semicolon
r_return
id|SiS_MCLKData_1
(braket
id|index
)braket
dot
id|CLOCK
suffix:semicolon
)brace
r_else
(brace
r_return
id|SiS_MCLKData_0
(braket
id|index
)braket
dot
id|CLOCK
suffix:semicolon
)brace
)brace
macro_line|#endif
multiline_comment|/* TW: Checked against 650/LVDS 1.10.07 BIOS */
r_void
DECL|function|SiS_GetLVDSDesData
id|SiS_GetLVDSDesData
c_func
(paren
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
comma
id|USHORT
id|RefreshRateTableIndex
comma
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
)paren
(brace
id|USHORT
id|modeflag
suffix:semicolon
id|USHORT
id|PanelIndex
comma
id|ResIndex
suffix:semicolon
id|SiS_LVDSDesStruct
op_star
id|PanelDesPtr
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
op_logical_and
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCDA
)paren
)paren
(brace
id|SiS_GetLVDSDesPtrA
c_func
(paren
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|RefreshRateTableIndex
comma
op_amp
id|PanelIndex
comma
op_amp
id|ResIndex
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|PanelIndex
)paren
(brace
r_case
l_int|0
suffix:colon
id|PanelDesPtr
op_assign
id|LVDS1024x768Des_1
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* --- expanding --- */
r_case
l_int|1
suffix:colon
id|PanelDesPtr
op_assign
id|LVDS1280x1024Des_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|PanelDesPtr
op_assign
id|LVDS1280x960Des_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
id|PanelDesPtr
op_assign
id|LVDS1024x768Des_2
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* --- non expanding --- */
r_case
l_int|4
suffix:colon
id|PanelDesPtr
op_assign
id|LVDS1280x1024Des_2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|5
suffix:colon
id|PanelDesPtr
op_assign
id|LVDS1280x960Des_2
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_else
(brace
id|SiS_GetLVDSDesPtr
c_func
(paren
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|RefreshRateTableIndex
comma
op_amp
id|PanelIndex
comma
op_amp
id|ResIndex
comma
id|HwDeviceExtension
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|PanelIndex
)paren
(brace
r_case
l_int|0
suffix:colon
id|PanelDesPtr
op_assign
id|SiS_PanelType00_1
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* --- expanding --- | Gericom 1st supersonic (310) */
r_case
l_int|1
suffix:colon
id|PanelDesPtr
op_assign
id|SiS_PanelType01_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|PanelDesPtr
op_assign
id|SiS_PanelType02_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
id|PanelDesPtr
op_assign
id|SiS_PanelType03_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|4
suffix:colon
id|PanelDesPtr
op_assign
id|SiS_PanelType04_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|5
suffix:colon
id|PanelDesPtr
op_assign
id|SiS_PanelType05_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|6
suffix:colon
id|PanelDesPtr
op_assign
id|SiS_PanelType06_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|7
suffix:colon
id|PanelDesPtr
op_assign
id|SiS_PanelType07_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|8
suffix:colon
id|PanelDesPtr
op_assign
id|SiS_PanelType08_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|9
suffix:colon
id|PanelDesPtr
op_assign
id|SiS_PanelType09_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|10
suffix:colon
id|PanelDesPtr
op_assign
id|SiS_PanelType0a_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|11
suffix:colon
id|PanelDesPtr
op_assign
id|SiS_PanelType0b_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|12
suffix:colon
id|PanelDesPtr
op_assign
id|SiS_PanelType0c_1
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* TW: Clevo 2202 (300)  */
r_case
l_int|13
suffix:colon
id|PanelDesPtr
op_assign
id|SiS_PanelType0d_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|14
suffix:colon
id|PanelDesPtr
op_assign
id|SiS_PanelType0e_1
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* TW: Uniwill N271S2 (300) */
r_case
l_int|15
suffix:colon
id|PanelDesPtr
op_assign
id|SiS_PanelType0f_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|16
suffix:colon
id|PanelDesPtr
op_assign
id|SiS_PanelType00_2
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* --- non-expanding --- */
r_case
l_int|17
suffix:colon
id|PanelDesPtr
op_assign
id|SiS_PanelType01_2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|18
suffix:colon
id|PanelDesPtr
op_assign
id|SiS_PanelType02_2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|19
suffix:colon
id|PanelDesPtr
op_assign
id|SiS_PanelType03_2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|20
suffix:colon
id|PanelDesPtr
op_assign
id|SiS_PanelType04_2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|21
suffix:colon
id|PanelDesPtr
op_assign
id|SiS_PanelType05_2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|22
suffix:colon
id|PanelDesPtr
op_assign
id|SiS_PanelType06_2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|23
suffix:colon
id|PanelDesPtr
op_assign
id|SiS_PanelType07_2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|24
suffix:colon
id|PanelDesPtr
op_assign
id|SiS_PanelType08_2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|25
suffix:colon
id|PanelDesPtr
op_assign
id|SiS_PanelType09_2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|26
suffix:colon
id|PanelDesPtr
op_assign
id|SiS_PanelType0a_2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|27
suffix:colon
id|PanelDesPtr
op_assign
id|SiS_PanelType0b_2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|28
suffix:colon
id|PanelDesPtr
op_assign
id|SiS_PanelType0c_2
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* TW: Gericom 2200C (300) */
r_case
l_int|29
suffix:colon
id|PanelDesPtr
op_assign
id|SiS_PanelType0d_2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|30
suffix:colon
id|PanelDesPtr
op_assign
id|SiS_PanelType0e_2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|31
suffix:colon
id|PanelDesPtr
op_assign
id|SiS_PanelType0f_2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|32
suffix:colon
id|PanelDesPtr
op_assign
id|SiS_CHTVUNTSCDesData
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|33
suffix:colon
id|PanelDesPtr
op_assign
id|SiS_CHTVONTSCDesData
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|34
suffix:colon
id|PanelDesPtr
op_assign
id|SiS_CHTVUPALDesData
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|35
suffix:colon
id|PanelDesPtr
op_assign
id|SiS_CHTVOPALDesData
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
id|SiS_LCDHDES
op_assign
(paren
id|PanelDesPtr
op_plus
id|ResIndex
)paren
op_member_access_from_pointer
id|LCDHDES
suffix:semicolon
id|SiS_LCDVDES
op_assign
(paren
id|PanelDesPtr
op_plus
id|ResIndex
)paren
op_member_access_from_pointer
id|LCDVDES
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDInfo
op_amp
id|LCDNonExpanding
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_SetFlag
op_amp
id|CRT2IsVGA
)paren
)paren
(brace
r_if
c_cond
(paren
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
op_logical_or
(paren
id|SiS_LCDResInfo
op_ne
id|Panel1280x1024
)paren
)paren
(brace
multiline_comment|/* TW: New from 650/LVDS 1.10.07 */
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_ge
id|Panel1024x768
)paren
(brace
r_if
c_cond
(paren
id|ModeNo
op_le
l_int|0x13
)paren
(brace
id|modeflag
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_ModeFlag
suffix:semicolon
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|modeflag
op_amp
id|HalfDCLK
)paren
)paren
(brace
id|SiS_LCDHDES
op_assign
l_int|320
suffix:semicolon
)brace
)brace
r_else
(brace
multiline_comment|/* TW: New from 650/LVDS 1.10.07 */
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1024x768
)paren
(brace
id|SiS_LCDHDES
op_assign
l_int|480
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1400x1050
)paren
(brace
id|SiS_LCDHDES
op_assign
l_int|804
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|modeflag
op_amp
id|HalfDCLK
)paren
)paren
(brace
id|SiS_LCDHDES
op_assign
l_int|320
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1400x1050
)paren
(brace
id|SiS_LCDHDES
op_assign
l_int|632
suffix:semicolon
)brace
)brace
)brace
)brace
)brace
)brace
)brace
)brace
r_return
suffix:semicolon
)brace
multiline_comment|/* TW: Checked against 630/LVDS (2.04.5c) and 650/LVDS (1.10.07) BIOS */
r_void
DECL|function|SiS_GetLVDSDesPtr
id|SiS_GetLVDSDesPtr
c_func
(paren
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
comma
id|USHORT
id|RefreshRateTableIndex
comma
id|USHORT
op_star
id|PanelIndex
comma
id|USHORT
op_star
id|ResIndex
comma
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
)paren
(brace
id|USHORT
id|tempbx
comma
id|tempal
comma
id|modeflag
suffix:semicolon
r_if
c_cond
(paren
id|ModeNo
op_le
l_int|0x13
)paren
(brace
id|modeflag
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_ModeFlag
suffix:semicolon
id|tempal
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_CRT2CRTC
suffix:semicolon
)brace
r_else
(brace
id|modeflag
op_assign
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|Ext_ModeFlag
suffix:semicolon
id|tempal
op_assign
id|SiS_RefIndex
(braket
id|RefreshRateTableIndex
)braket
dot
id|Ext_CRT2CRTC
suffix:semicolon
)brace
id|tempbx
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_CH70xx
op_ne
l_int|0
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCD
)paren
)paren
(brace
id|tempbx
op_assign
l_int|32
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetPALTV
)paren
(brace
id|tempbx
op_add_assign
l_int|2
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCHTVOverScan
)paren
(brace
id|tempbx
op_add_assign
l_int|1
suffix:semicolon
)brace
)brace
)brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCD
)paren
(brace
id|tempbx
op_assign
id|SiS_LCDTypeInfo
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDInfo
op_amp
id|LCDNonExpanding
)paren
(brace
id|tempbx
op_add_assign
l_int|16
suffix:semicolon
)brace
multiline_comment|/* TW: Inserted from 650/LVDS (1.10.07) BIOS */
r_if
c_cond
(paren
id|SiS_LCDInfo
op_amp
l_int|0x0100
)paren
(brace
r_if
c_cond
(paren
id|modeflag
op_amp
id|HalfDCLK
)paren
(brace
id|tempbx
op_add_assign
l_int|16
suffix:semicolon
)brace
)brace
)brace
multiline_comment|/* TW: Inserted from 630/LVDS and 650/LVDS (1.10.07) BIOS */
r_if
c_cond
(paren
id|SiS_SetFlag
op_amp
id|CRT2IsVGA
)paren
(brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_ne
id|Panel640x480
)paren
(brace
id|tempal
op_assign
l_int|0x07
suffix:semicolon
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
r_if
c_cond
(paren
id|SiS_GetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x13
)paren
op_amp
l_int|0x80
)paren
(brace
id|tempal
op_increment
suffix:semicolon
)brace
)brace
)brace
)brace
op_star
id|PanelIndex
op_assign
id|tempbx
suffix:semicolon
op_star
id|ResIndex
op_assign
id|tempal
op_amp
l_int|0x1F
suffix:semicolon
)brace
r_void
DECL|function|SiS_GetLVDSDesPtrA
id|SiS_GetLVDSDesPtrA
c_func
(paren
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
comma
id|USHORT
id|RefreshRateTableIndex
comma
id|USHORT
op_star
id|PanelIndex
comma
id|USHORT
op_star
id|ResIndex
)paren
(brace
id|USHORT
id|tempbx
op_assign
l_int|0
comma
id|tempal
suffix:semicolon
id|tempbx
op_assign
id|SiS_LCDResInfo
op_minus
id|PanelMin301
suffix:semicolon
multiline_comment|/* TW: *not* PanelMinLVDS! */
r_if
c_cond
(paren
id|SiS_LCDInfo
op_amp
id|LCDNonExpanding
)paren
(brace
id|tempbx
op_add_assign
l_int|3
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ModeNo
op_le
l_int|0x13
)paren
(brace
id|tempal
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_CRT2CRTC
suffix:semicolon
)brace
r_else
id|tempal
op_assign
id|SiS_RefIndex
(braket
id|RefreshRateTableIndex
)braket
dot
id|Ext_CRT2CRTC
suffix:semicolon
op_star
id|PanelIndex
op_assign
id|tempbx
suffix:semicolon
op_star
id|ResIndex
op_assign
id|tempal
op_amp
l_int|0x1F
suffix:semicolon
)brace
multiline_comment|/* TW: Checked against 650/LVDS (1.10.07), 650/301LV, 630/301 and 630/301B (II) BIOS */
r_void
DECL|function|SiS_SetCRT2ModeRegs
id|SiS_SetCRT2ModeRegs
c_func
(paren
id|USHORT
id|BaseAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
comma
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
)paren
(brace
id|USHORT
id|i
comma
id|j
comma
id|modeflag
suffix:semicolon
id|USHORT
id|tempcl
comma
id|tempah
comma
id|tempbl
comma
id|temp
suffix:semicolon
r_if
c_cond
(paren
id|ModeNo
op_le
l_int|0x13
)paren
(brace
id|modeflag
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_ModeFlag
suffix:semicolon
)brace
r_else
(brace
id|modeflag
op_assign
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|Ext_ModeFlag
suffix:semicolon
)brace
multiline_comment|/* TW: BIOS does not do this (neither 301 nor LVDS) */
multiline_comment|/*     (But it&squot;s harmless; see SetCRT2Offset) */
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x03
comma
l_int|0x00
)paren
suffix:semicolon
multiline_comment|/* fix write part1 index 0  BTDRAM bit Bug */
multiline_comment|/* TW: Removed 301B302B301LV302LV check here to match 650/LVDS BIOS */
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCDA
)paren
(brace
multiline_comment|/* TW:   1. for LVDS/302B/302LV **LCDA** */
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x00
comma
l_int|0xAF
comma
l_int|0x40
)paren
suffix:semicolon
multiline_comment|/* FUNCTION CONTROL */
id|SiS_SetRegAND
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x2E
comma
l_int|0xF7
)paren
suffix:semicolon
macro_line|#if 0  /* TW: Not done in 650/301, 650/LVDS or 650/301LV BIOS*/
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x13
comma
l_int|0xFB
comma
l_int|0x04
)paren
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x2c
comma
l_int|0xCF
comma
l_int|0x30
)paren
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x21
comma
l_int|0x3F
comma
l_int|0xC0
)paren
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x23
comma
l_int|0x7F
comma
l_int|0x00
)paren
suffix:semicolon
macro_line|#endif
)brace
r_else
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
comma
id|j
op_assign
l_int|4
suffix:semicolon
id|i
OL
l_int|3
suffix:semicolon
id|i
op_increment
comma
id|j
op_increment
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
id|j
comma
l_int|0
)paren
suffix:semicolon
)brace
id|tempcl
op_assign
id|SiS_ModeType
suffix:semicolon
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
multiline_comment|/* ---- 300 series ---- */
multiline_comment|/* TW: Inserted entire if-section from 630/301B BIOS */
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
(brace
id|temp
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x32
)paren
suffix:semicolon
id|temp
op_and_assign
l_int|0xef
suffix:semicolon
id|temp
op_or_assign
l_int|0x02
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
(brace
id|temp
op_or_assign
l_int|0x10
suffix:semicolon
id|temp
op_and_assign
l_int|0xfd
suffix:semicolon
)brace
id|SiS_SetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x32
comma
id|temp
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ModeNo
OG
l_int|0x13
)paren
(brace
id|tempcl
op_sub_assign
id|ModeVGA
suffix:semicolon
r_if
c_cond
(paren
(paren
id|tempcl
OG
l_int|0
)paren
op_logical_or
(paren
id|tempcl
op_eq
l_int|0
)paren
)paren
(brace
multiline_comment|/* TW: tempcl is USHORT -&gt; always true! */
id|tempah
op_assign
(paren
(paren
l_int|0x010
op_rshift
id|tempcl
)paren
op_or
l_int|0x080
)paren
suffix:semicolon
)brace
)brace
r_else
id|tempah
op_assign
l_int|0x080
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
(brace
id|tempah
op_assign
(paren
id|tempah
op_xor
l_int|0x0A0
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
multiline_comment|/* ---- 310 series ---- */
multiline_comment|/* TW: Inserted from 650/301/301LV BIOS */
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|CRT2DisplayFlag
)paren
(brace
id|SiS_SetRegOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x2e
comma
l_int|0x08
)paren
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|ModeNo
OG
l_int|0x13
)paren
(brace
id|tempcl
op_sub_assign
id|ModeVGA
suffix:semicolon
r_if
c_cond
(paren
(paren
id|tempcl
OG
l_int|0
)paren
op_logical_or
(paren
id|tempcl
op_eq
l_int|0
)paren
)paren
(brace
multiline_comment|/* TW: tempcl is USHORT -&gt; always true! */
id|tempah
op_assign
(paren
l_int|0x008
op_rshift
id|tempcl
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tempah
op_eq
l_int|0
)paren
id|tempah
op_assign
l_int|1
suffix:semicolon
id|tempah
op_or_assign
l_int|0x040
suffix:semicolon
)brace
)brace
r_else
id|tempah
op_assign
l_int|0x040
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
(brace
id|tempah
op_assign
(paren
id|tempah
op_xor
l_int|0x050
)paren
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|CRT2DisplayFlag
)paren
(brace
id|tempah
op_assign
l_int|0
suffix:semicolon
)brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x00
comma
id|tempah
)paren
suffix:semicolon
multiline_comment|/* FUNCTION CONTROL */
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|0
)paren
(brace
multiline_comment|/* TW:   2. for 301 (301B, 302B 301LV, 302LV non-LCDA) */
id|tempah
op_assign
l_int|0x01
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
)paren
(brace
id|tempah
op_or_assign
l_int|0x02
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToRAMDAC
)paren
)paren
(brace
id|tempah
op_assign
(paren
id|tempah
op_xor
l_int|0x05
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCD
)paren
)paren
(brace
id|tempah
op_assign
(paren
id|tempah
op_xor
l_int|0x01
)paren
suffix:semicolon
)brace
)brace
id|tempcl
op_assign
id|tempah
suffix:semicolon
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
multiline_comment|/* --- 300 series --- */
id|tempah
op_assign
(paren
id|tempah
op_lshift
l_int|5
)paren
op_amp
l_int|0xFF
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|CRT2DisplayFlag
)paren
(brace
id|tempah
op_assign
l_int|0
suffix:semicolon
)brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x01
comma
id|tempah
)paren
suffix:semicolon
id|tempah
op_assign
id|tempcl
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* --- 310 series --- */
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|CRT2DisplayFlag
)paren
(brace
id|tempah
op_assign
l_int|0
suffix:semicolon
)brace
id|tempah
op_assign
(paren
id|SiS_GetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x2E
)paren
op_amp
l_int|0xF8
)paren
op_or
id|tempah
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x2E
comma
id|tempah
)paren
suffix:semicolon
id|tempah
op_assign
id|tempcl
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|SiS_ModeType
op_eq
id|ModeVGA
)paren
op_logical_and
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
)paren
)paren
(brace
id|tempah
op_or_assign
l_int|0x010
suffix:semicolon
)brace
multiline_comment|/* TW: Inserted from 630/301 BIOS */
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301
)paren
(brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1280x1024
)paren
(brace
id|tempah
op_or_assign
l_int|0x80
suffix:semicolon
)brace
)brace
r_else
(brace
id|tempah
op_or_assign
l_int|0x80
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
(paren
id|SetCRT2ToTV
op_minus
id|SetCRT2ToHiVisionTV
)paren
)paren
(brace
multiline_comment|/* TW: Added -HiVision like in BIOS (650+630) */
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
(brace
id|tempah
op_or_assign
l_int|0x20
suffix:semicolon
)brace
)brace
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x0D
comma
l_int|0x40
comma
id|tempah
)paren
suffix:semicolon
id|tempah
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
(brace
id|SiS_SetFlag
op_or_assign
id|RPLLDIV2XO
suffix:semicolon
id|tempah
op_or_assign
l_int|0x40
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_SetFlag
op_amp
id|TVSimuMode
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToHiVisionTV
)paren
)paren
(brace
id|SiS_SetFlag
op_or_assign
id|RPLLDIV2XO
suffix:semicolon
id|tempah
op_or_assign
l_int|0x40
suffix:semicolon
)brace
)brace
)brace
)brace
r_else
(brace
id|SiS_SetFlag
op_or_assign
id|RPLLDIV2XO
suffix:semicolon
id|tempah
op_or_assign
l_int|0x40
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1280x1024
op_logical_or
id|SiS_LCDResInfo
op_eq
id|Panel1280x960
)paren
(brace
id|tempah
op_or_assign
l_int|0x80
suffix:semicolon
)brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x0C
comma
id|tempah
)paren
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* TW: 3. for LVDS */
multiline_comment|/* TW: Inserted if-statement - Part1Port 0x2e not assigned on 300 series */
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
multiline_comment|/* TW: Inserted this entire section (BIOS 650/LVDS); added ModeType check&n;&t;    *     (LVDS can only be slave in 8bpp modes)&n;&t;    */
id|tempah
op_assign
l_int|0x80
suffix:semicolon
r_if
c_cond
(paren
(paren
id|modeflag
op_amp
id|CRT2Mode
)paren
op_logical_and
(paren
id|SiS_ModeType
OG
id|ModeVGA
)paren
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|DriverMode
)paren
(brace
id|tempah
op_or_assign
l_int|0x02
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
)paren
(brace
id|tempah
op_or_assign
l_int|0x02
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
(brace
id|tempah
op_assign
id|tempah
op_xor
l_int|0x01
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|DisableCRT2Display
)paren
(brace
id|tempah
op_assign
l_int|1
suffix:semicolon
)brace
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x2e
comma
l_int|0xF0
comma
id|tempah
)paren
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* TW: Inserted entire section from 630/LVDS BIOS (added ModeType check) */
id|tempah
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
)paren
op_logical_and
(paren
id|SiS_ModeType
OG
id|ModeVGA
)paren
)paren
(brace
id|tempah
op_or_assign
l_int|0x02
suffix:semicolon
)brace
id|tempah
op_lshift_assign
l_int|5
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|DisableCRT2Display
)paren
(brace
id|tempah
op_assign
l_int|0
suffix:semicolon
)brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x01
comma
id|tempah
)paren
suffix:semicolon
)brace
)brace
)brace
multiline_comment|/* TW: Inserted the entire following section */
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
multiline_comment|/* TW: From 650/301 BIOS */
macro_line|#if 0    /* TW: This is not done in 650/301LV BIOS */
id|tempah
op_assign
l_int|0x04
suffix:semicolon
id|tempbl
op_assign
l_int|0xfb
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCDA
)paren
)paren
(brace
id|tempah
op_assign
l_int|0x00
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IsDualEdge
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
(brace
id|tempbl
op_assign
l_int|0xff
suffix:semicolon
)brace
)brace
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x13
comma
id|tempbl
comma
id|tempah
)paren
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x2c
comma
l_int|0xCF
comma
l_int|0x30
)paren
suffix:semicolon
macro_line|#endif
multiline_comment|/* This is done instead: */
id|tempah
op_assign
l_int|0x30
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|DisableCRT2Display
)paren
(brace
id|tempah
op_assign
l_int|0
suffix:semicolon
)brace
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x2c
comma
l_int|0xcf
comma
id|tempah
)paren
suffix:semicolon
macro_line|#if 0    /* TW: This is not done in 650/301LV BIOS */
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x21
comma
l_int|0x3f
comma
l_int|0xc0
)paren
suffix:semicolon
macro_line|#endif
multiline_comment|/* This is done instead: */
id|tempah
op_assign
l_int|0xc0
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|DisableCRT2Display
)paren
(brace
id|tempah
op_assign
l_int|0
suffix:semicolon
)brace
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x21
comma
l_int|0x3f
comma
id|tempah
)paren
suffix:semicolon
macro_line|#if 0    /* TW: This is not done in 650/301LV BIOS */
id|tempah
op_assign
l_int|0x00
suffix:semicolon
id|tempbl
op_assign
l_int|0x7f
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCDA
)paren
)paren
(brace
id|tempbl
op_assign
l_int|0xff
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_IsDualEdge
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
)paren
(brace
id|tempah
op_assign
l_int|0x80
suffix:semicolon
)brace
)brace
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x23
comma
id|tempbl
comma
id|tempah
)paren
suffix:semicolon
macro_line|#endif
multiline_comment|/* This is done instead: */
id|tempah
op_assign
l_int|0x80
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|DisableCRT2Display
)paren
(brace
id|tempah
op_assign
l_int|0
suffix:semicolon
)brace
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x23
comma
l_int|0x7F
comma
id|tempah
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
(brace
multiline_comment|/* TW: From 630/301B BIOS */
id|SiS_SetRegAND
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x21
comma
l_int|0x3f
)paren
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
(paren
id|SetCRT2ToLCD
op_or
id|DisableCRT2Display
)paren
)paren
(brace
id|SiS_SetRegAND
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x23
comma
l_int|0x7F
)paren
suffix:semicolon
)brace
r_else
id|SiS_SetRegOR
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x23
comma
l_int|0x80
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
multiline_comment|/* TW: From 650/LVDS BIOS */
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
id|tempah
op_assign
l_int|0x04
suffix:semicolon
id|tempbl
op_assign
l_int|0xfb
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCDA
)paren
)paren
(brace
id|tempah
op_assign
l_int|0x00
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IsDualEdge
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
(brace
id|tempbl
op_assign
l_int|0xff
suffix:semicolon
)brace
)brace
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x13
comma
id|tempbl
comma
id|tempah
)paren
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|DisableCRT2Display
)paren
(brace
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x13
comma
l_int|0xfb
comma
l_int|0x00
)paren
suffix:semicolon
)brace
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x2c
comma
l_int|0xcf
comma
l_int|0x30
)paren
suffix:semicolon
)brace
)brace
)brace
r_void
DECL|function|SiS_GetCRT2Data
id|SiS_GetCRT2Data
c_func
(paren
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
comma
id|USHORT
id|RefreshRateTableIndex
comma
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
)paren
(brace
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCDA
)paren
(brace
id|SiS_GetCRT2DataLVDS
c_func
(paren
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|RefreshRateTableIndex
comma
id|HwDeviceExtension
)paren
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
op_logical_and
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCD
)paren
)paren
(brace
id|SiS_GetCRT2Data301
c_func
(paren
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|RefreshRateTableIndex
comma
id|HwDeviceExtension
)paren
suffix:semicolon
multiline_comment|/* TW: Need LVDS Data for LCD on 630/301B! */
id|SiS_GetCRT2DataLVDS
c_func
(paren
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|RefreshRateTableIndex
comma
id|HwDeviceExtension
)paren
suffix:semicolon
)brace
r_else
(brace
id|SiS_GetCRT2Data301
c_func
(paren
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|RefreshRateTableIndex
comma
id|HwDeviceExtension
)paren
suffix:semicolon
)brace
)brace
)brace
r_else
id|SiS_GetCRT2Data301
c_func
(paren
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|RefreshRateTableIndex
comma
id|HwDeviceExtension
)paren
suffix:semicolon
)brace
r_else
(brace
id|SiS_GetCRT2DataLVDS
c_func
(paren
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|RefreshRateTableIndex
comma
id|HwDeviceExtension
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/* Checked with 650/LVDS 1.10.07 BIOS */
r_void
DECL|function|SiS_GetCRT2DataLVDS
id|SiS_GetCRT2DataLVDS
c_func
(paren
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
comma
id|USHORT
id|RefreshRateTableIndex
comma
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
)paren
(brace
id|USHORT
id|CRT2Index
comma
id|ResIndex
suffix:semicolon
id|SiS_LVDSDataStruct
op_star
id|LVDSData
op_assign
l_int|NULL
suffix:semicolon
id|SiS_GetCRT2ResInfo
c_func
(paren
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|HwDeviceExtension
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
op_logical_and
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCDA
)paren
)paren
(brace
id|SiS_GetCRT2PtrA
c_func
(paren
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|RefreshRateTableIndex
comma
op_amp
id|CRT2Index
comma
op_amp
id|ResIndex
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|CRT2Index
)paren
(brace
r_case
l_int|0
suffix:colon
id|LVDSData
op_assign
id|SiS_LVDS1024x768Data_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|LVDSData
op_assign
id|SiS_LVDS1280x1024Data_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|LVDSData
op_assign
id|SiS_LVDS1280x960Data_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
id|LVDSData
op_assign
id|SiS_LVDS1024x768Data_2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|4
suffix:colon
id|LVDSData
op_assign
id|SiS_LVDS1280x1024Data_2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|5
suffix:colon
id|LVDSData
op_assign
id|SiS_LVDS1280x960Data_2
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_else
(brace
multiline_comment|/* TW: SiS630/301B needs LVDS Data! */
r_if
c_cond
(paren
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
op_logical_and
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
op_logical_and
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCD
)paren
)paren
(brace
id|SiS_IF_DEF_LVDS
op_assign
l_int|1
suffix:semicolon
)brace
id|SiS_GetCRT2Ptr
c_func
(paren
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|RefreshRateTableIndex
comma
op_amp
id|CRT2Index
comma
op_amp
id|ResIndex
comma
id|HwDeviceExtension
)paren
suffix:semicolon
multiline_comment|/* TW: SiS630/301B needs LVDS Data! */
r_if
c_cond
(paren
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
op_logical_and
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
op_logical_and
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCD
)paren
)paren
(brace
id|SiS_IF_DEF_LVDS
op_assign
l_int|0
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|CRT2Index
)paren
(brace
r_case
l_int|0
suffix:colon
id|LVDSData
op_assign
id|SiS_LVDS800x600Data_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|LVDSData
op_assign
id|SiS_LVDS1024x768Data_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|LVDSData
op_assign
id|SiS_LVDS1280x1024Data_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
id|LVDSData
op_assign
id|SiS_LVDS800x600Data_2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|4
suffix:colon
id|LVDSData
op_assign
id|SiS_LVDS1024x768Data_2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|5
suffix:colon
id|LVDSData
op_assign
id|SiS_LVDS1280x1024Data_2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|6
suffix:colon
id|LVDSData
op_assign
id|SiS_LVDS640x480Data_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|7
suffix:colon
id|LVDSData
op_assign
id|SiS_LVDSXXXxXXXData_1
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* TW: New */
r_case
l_int|8
suffix:colon
id|LVDSData
op_assign
id|SiS_LVDS1400x1050Data_1
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* TW: New */
r_case
l_int|9
suffix:colon
id|LVDSData
op_assign
id|SiS_LVDS1400x1050Data_2
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* TW: New */
r_case
l_int|10
suffix:colon
id|LVDSData
op_assign
id|SiS_CHTVUNTSCData
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|11
suffix:colon
id|LVDSData
op_assign
id|SiS_CHTVONTSCData
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|12
suffix:colon
id|LVDSData
op_assign
id|SiS_CHTVUPALData
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|13
suffix:colon
id|LVDSData
op_assign
id|SiS_CHTVOPALData
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|14
suffix:colon
id|LVDSData
op_assign
id|SiS_LVDS320x480Data_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|15
suffix:colon
id|LVDSData
op_assign
id|SiS_LVDS1024x600Data_1
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* TW: New */
r_case
l_int|16
suffix:colon
id|LVDSData
op_assign
id|SiS_LVDS1152x768Data_1
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* TW: New */
r_case
l_int|17
suffix:colon
id|LVDSData
op_assign
id|SiS_LVDS1024x600Data_2
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* TW: New */
r_case
l_int|18
suffix:colon
id|LVDSData
op_assign
id|SiS_LVDS1152x768Data_2
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* TW: New */
)brace
)brace
id|SiS_VGAHT
op_assign
(paren
id|LVDSData
op_plus
id|ResIndex
)paren
op_member_access_from_pointer
id|VGAHT
suffix:semicolon
id|SiS_VGAVT
op_assign
(paren
id|LVDSData
op_plus
id|ResIndex
)paren
op_member_access_from_pointer
id|VGAVT
suffix:semicolon
id|SiS_HT
op_assign
(paren
id|LVDSData
op_plus
id|ResIndex
)paren
op_member_access_from_pointer
id|LCDHT
suffix:semicolon
id|SiS_VT
op_assign
(paren
id|LVDSData
op_plus
id|ResIndex
)paren
op_member_access_from_pointer
id|LCDVT
suffix:semicolon
r_if
c_cond
(paren
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|0
)paren
op_logical_and
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_LCDInfo
op_amp
id|LCDNonExpanding
)paren
)paren
(brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1024x768
)paren
(brace
id|SiS_HDE
op_assign
l_int|1024
suffix:semicolon
id|SiS_VDE
op_assign
l_int|768
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1280x1024
)paren
(brace
id|SiS_HDE
op_assign
l_int|1280
suffix:semicolon
id|SiS_VDE
op_assign
l_int|1024
suffix:semicolon
)brace
r_else
(brace
id|SiS_HDE
op_assign
l_int|1280
suffix:semicolon
id|SiS_VDE
op_assign
l_int|960
suffix:semicolon
)brace
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|SiS_IF_DEF_TRUMPION
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCD
)paren
op_logical_and
(paren
op_logical_neg
(paren
id|SiS_LCDInfo
op_amp
l_int|0x0100
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_ne
id|Panel640x480
)paren
(brace
r_if
c_cond
(paren
(paren
op_logical_neg
(paren
id|SiS_LCDInfo
op_amp
id|LCDNonExpanding
)paren
)paren
op_logical_or
(paren
id|SiS_SetFlag
op_amp
id|CRT2IsVGA
)paren
)paren
(brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel800x600
)paren
(brace
id|SiS_HDE
op_assign
l_int|800
suffix:semicolon
id|SiS_VDE
op_assign
l_int|600
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1024x768
)paren
(brace
id|SiS_HDE
op_assign
l_int|1024
suffix:semicolon
id|SiS_VDE
op_assign
l_int|768
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1280x1024
)paren
(brace
id|SiS_HDE
op_assign
l_int|1280
suffix:semicolon
id|SiS_VDE
op_assign
l_int|1024
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1024x600
)paren
(brace
id|SiS_HDE
op_assign
l_int|1024
suffix:semicolon
id|SiS_VDE
op_assign
l_int|600
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1400x1050
)paren
(brace
id|SiS_HDE
op_assign
l_int|1400
suffix:semicolon
id|SiS_VDE
op_assign
l_int|1050
suffix:semicolon
)brace
r_else
(brace
id|SiS_HDE
op_assign
l_int|1152
suffix:semicolon
id|SiS_VDE
op_assign
l_int|768
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_IF_DEF_FSTN
)paren
(brace
id|SiS_HDE
op_assign
l_int|320
suffix:semicolon
id|SiS_VDE
op_assign
l_int|480
suffix:semicolon
)brace
)brace
)brace
)brace
)brace
)brace
)brace
multiline_comment|/* TW: Checked against 630/301B BIOS; does not check VDE values for LCD */
r_void
DECL|function|SiS_GetCRT2Data301
id|SiS_GetCRT2Data301
c_func
(paren
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
comma
id|USHORT
id|RefreshRateTableIndex
comma
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
)paren
(brace
id|USHORT
id|tempax
comma
id|tempbx
comma
id|modeflag
suffix:semicolon
id|USHORT
id|resinfo
suffix:semicolon
id|USHORT
id|CRT2Index
comma
id|ResIndex
suffix:semicolon
id|SiS_LCDDataStruct
op_star
id|LCDPtr
op_assign
l_int|NULL
suffix:semicolon
id|SiS_TVDataStruct
op_star
id|TVPtr
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
id|ModeNo
op_le
l_int|0x13
)paren
(brace
id|modeflag
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_ModeFlag
suffix:semicolon
id|resinfo
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_ResInfo
suffix:semicolon
)brace
r_else
(brace
id|modeflag
op_assign
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|Ext_ModeFlag
suffix:semicolon
id|resinfo
op_assign
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|Ext_RESINFO
suffix:semicolon
)brace
id|SiS_NewFlickerMode
op_assign
l_int|0
suffix:semicolon
id|SiS_RVBHRS
op_assign
l_int|50
suffix:semicolon
id|SiS_RY1COE
op_assign
l_int|0
suffix:semicolon
id|SiS_RY2COE
op_assign
l_int|0
suffix:semicolon
id|SiS_RY3COE
op_assign
l_int|0
suffix:semicolon
id|SiS_RY4COE
op_assign
l_int|0
suffix:semicolon
id|SiS_GetCRT2ResInfo
c_func
(paren
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|HwDeviceExtension
)paren
suffix:semicolon
multiline_comment|/* TW: For VGA2 (&quot;RAMDAC2&quot;) */
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToRAMDAC
)paren
(brace
id|SiS_GetRAMDAC2DATA
c_func
(paren
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|RefreshRateTableIndex
comma
id|HwDeviceExtension
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
multiline_comment|/* TW: For TV */
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
(brace
id|SiS_GetCRT2Ptr
c_func
(paren
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|RefreshRateTableIndex
comma
op_amp
id|CRT2Index
comma
op_amp
id|ResIndex
comma
id|HwDeviceExtension
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|CRT2Index
)paren
(brace
r_case
l_int|2
suffix:colon
id|TVPtr
op_assign
id|SiS_ExtHiTVData
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
id|TVPtr
op_assign
id|SiS_ExtPALData
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|4
suffix:colon
id|TVPtr
op_assign
id|SiS_ExtNTSCData
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|7
suffix:colon
id|TVPtr
op_assign
id|SiS_St1HiTVData
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|8
suffix:colon
id|TVPtr
op_assign
id|SiS_StPALData
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|9
suffix:colon
id|TVPtr
op_assign
id|SiS_StNTSCData
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|12
suffix:colon
id|TVPtr
op_assign
id|SiS_St2HiTVData
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|TVPtr
op_assign
id|SiS_StPALData
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* TW: Just to avoid a crash */
)brace
id|SiS_RVBHCMAX
op_assign
(paren
id|TVPtr
op_plus
id|ResIndex
)paren
op_member_access_from_pointer
id|RVBHCMAX
suffix:semicolon
id|SiS_RVBHCFACT
op_assign
(paren
id|TVPtr
op_plus
id|ResIndex
)paren
op_member_access_from_pointer
id|RVBHCFACT
suffix:semicolon
id|SiS_VGAHT
op_assign
(paren
id|TVPtr
op_plus
id|ResIndex
)paren
op_member_access_from_pointer
id|VGAHT
suffix:semicolon
id|SiS_VGAVT
op_assign
(paren
id|TVPtr
op_plus
id|ResIndex
)paren
op_member_access_from_pointer
id|VGAVT
suffix:semicolon
id|SiS_HDE
op_assign
(paren
id|TVPtr
op_plus
id|ResIndex
)paren
op_member_access_from_pointer
id|TVHDE
suffix:semicolon
id|SiS_VDE
op_assign
(paren
id|TVPtr
op_plus
id|ResIndex
)paren
op_member_access_from_pointer
id|TVVDE
suffix:semicolon
id|SiS_RVBHRS
op_assign
(paren
id|TVPtr
op_plus
id|ResIndex
)paren
op_member_access_from_pointer
id|RVBHRS
suffix:semicolon
id|SiS_NewFlickerMode
op_assign
(paren
id|TVPtr
op_plus
id|ResIndex
)paren
op_member_access_from_pointer
id|FlickerMode
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToHiVisionTV
)paren
(brace
r_if
c_cond
(paren
id|resinfo
op_eq
l_int|0x08
)paren
(brace
id|SiS_NewFlickerMode
op_assign
l_int|0x40
suffix:semicolon
)brace
r_if
c_cond
(paren
id|resinfo
op_eq
l_int|0x09
)paren
(brace
id|SiS_NewFlickerMode
op_assign
l_int|0x40
suffix:semicolon
)brace
r_if
c_cond
(paren
id|resinfo
op_eq
l_int|0x12
)paren
(brace
id|SiS_NewFlickerMode
op_assign
l_int|0x40
suffix:semicolon
)brace
multiline_comment|/* TW: Was resinfo == 0x10 */
r_if
c_cond
(paren
id|SiS_VGAVDE
op_eq
l_int|350
)paren
(brace
id|SiS_SetFlag
op_or_assign
id|TVSimuMode
suffix:semicolon
)brace
id|SiS_HT
op_assign
id|ExtHiTVHT
suffix:semicolon
id|SiS_VT
op_assign
id|ExtHiTVVT
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
(brace
r_if
c_cond
(paren
id|SiS_SetFlag
op_amp
id|TVSimuMode
)paren
(brace
id|SiS_HT
op_assign
id|StHiTVHT
suffix:semicolon
id|SiS_VT
op_assign
id|StHiTVVT
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|modeflag
op_amp
id|Charx8Dot
)paren
)paren
(brace
id|SiS_HT
op_assign
id|StHiTextTVHT
suffix:semicolon
id|SiS_VT
op_assign
id|StHiTextTVVT
suffix:semicolon
)brace
)brace
)brace
)brace
r_else
(brace
id|SiS_RY1COE
op_assign
(paren
id|TVPtr
op_plus
id|ResIndex
)paren
op_member_access_from_pointer
id|RY1COE
suffix:semicolon
id|SiS_RY2COE
op_assign
(paren
id|TVPtr
op_plus
id|ResIndex
)paren
op_member_access_from_pointer
id|RY2COE
suffix:semicolon
id|SiS_RY3COE
op_assign
(paren
id|TVPtr
op_plus
id|ResIndex
)paren
op_member_access_from_pointer
id|RY3COE
suffix:semicolon
id|SiS_RY4COE
op_assign
(paren
id|TVPtr
op_plus
id|ResIndex
)paren
op_member_access_from_pointer
id|RY4COE
suffix:semicolon
r_if
c_cond
(paren
id|modeflag
op_amp
id|HalfDCLK
)paren
(brace
id|SiS_RY1COE
op_assign
l_int|0x00
suffix:semicolon
id|SiS_RY2COE
op_assign
l_int|0xf4
suffix:semicolon
id|SiS_RY3COE
op_assign
l_int|0x10
suffix:semicolon
id|SiS_RY4COE
op_assign
l_int|0x38
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetPALTV
)paren
)paren
(brace
id|SiS_HT
op_assign
id|NTSCHT
suffix:semicolon
r_if
c_cond
(paren
(paren
id|ModeNo
op_eq
l_int|0x4a
)paren
op_logical_or
(paren
id|ModeNo
op_eq
l_int|0x38
)paren
)paren
(brace
id|SiS_HT
op_assign
id|NTSC2HT
suffix:semicolon
)brace
id|SiS_VT
op_assign
id|NTSCVT
suffix:semicolon
)brace
r_else
(brace
id|SiS_HT
op_assign
id|PALHT
suffix:semicolon
id|SiS_VT
op_assign
id|PALVT
suffix:semicolon
)brace
)brace
r_return
suffix:semicolon
)brace
multiline_comment|/* TW: For LCD */
multiline_comment|/* TW: Checked against 650/301LV; CRT2Index different (but does not matter) */
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCD
)paren
(brace
id|SiS_GetCRT2Ptr
c_func
(paren
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|RefreshRateTableIndex
comma
op_amp
id|CRT2Index
comma
op_amp
id|ResIndex
comma
id|HwDeviceExtension
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|CRT2Index
)paren
(brace
r_case
l_int|0
suffix:colon
id|LCDPtr
op_assign
id|SiS_ExtLCD1024x768Data
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* VESA Timing */
r_case
l_int|1
suffix:colon
id|LCDPtr
op_assign
id|SiS_ExtLCD1280x1024Data
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* VESA Timing */
r_case
l_int|5
suffix:colon
id|LCDPtr
op_assign
id|SiS_StLCD1024x768Data
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* Obviously unused */
r_case
l_int|6
suffix:colon
id|LCDPtr
op_assign
id|SiS_StLCD1280x1024Data
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* Obviously unused */
r_case
l_int|10
suffix:colon
id|LCDPtr
op_assign
id|SiS_St2LCD1024x768Data
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* Non-VESA Timing */
r_case
l_int|11
suffix:colon
id|LCDPtr
op_assign
id|SiS_St2LCD1280x1024Data
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* Non-VESA Timing */
r_case
l_int|13
suffix:colon
id|LCDPtr
op_assign
id|SiS_NoScaleData1024x768
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* Non-expanding */
r_case
l_int|14
suffix:colon
id|LCDPtr
op_assign
id|SiS_NoScaleData1280x1024
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* Non-expanding */
r_case
l_int|15
suffix:colon
id|LCDPtr
op_assign
id|SiS_LCD1280x960Data
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* 1280x960 */
r_default
suffix:colon
id|LCDPtr
op_assign
id|SiS_ExtLCD1024x768Data
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* Just to avoid a crash */
)brace
id|SiS_RVBHCMAX
op_assign
(paren
id|LCDPtr
op_plus
id|ResIndex
)paren
op_member_access_from_pointer
id|RVBHCMAX
suffix:semicolon
id|SiS_RVBHCFACT
op_assign
(paren
id|LCDPtr
op_plus
id|ResIndex
)paren
op_member_access_from_pointer
id|RVBHCFACT
suffix:semicolon
id|SiS_VGAHT
op_assign
(paren
id|LCDPtr
op_plus
id|ResIndex
)paren
op_member_access_from_pointer
id|VGAHT
suffix:semicolon
id|SiS_VGAVT
op_assign
(paren
id|LCDPtr
op_plus
id|ResIndex
)paren
op_member_access_from_pointer
id|VGAVT
suffix:semicolon
id|SiS_HT
op_assign
(paren
id|LCDPtr
op_plus
id|ResIndex
)paren
op_member_access_from_pointer
id|LCDHT
suffix:semicolon
id|SiS_VT
op_assign
(paren
id|LCDPtr
op_plus
id|ResIndex
)paren
op_member_access_from_pointer
id|LCDVT
suffix:semicolon
id|tempax
op_assign
l_int|1024
suffix:semicolon
r_if
c_cond
(paren
id|SiS_SetFlag
op_amp
id|LCDVESATiming
)paren
(brace
r_if
c_cond
(paren
id|SiS_VGAVDE
op_eq
l_int|350
)paren
id|tempbx
op_assign
l_int|560
suffix:semicolon
r_else
r_if
c_cond
(paren
id|SiS_VGAVDE
op_eq
l_int|400
)paren
(brace
id|tempbx
op_assign
l_int|640
suffix:semicolon
)brace
r_else
id|tempbx
op_assign
l_int|768
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|SiS_VGAVDE
op_eq
l_int|357
)paren
id|tempbx
op_assign
l_int|527
suffix:semicolon
r_else
r_if
c_cond
(paren
id|SiS_VGAVDE
op_eq
l_int|420
)paren
(brace
id|tempbx
op_assign
l_int|620
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_VGAVDE
op_eq
l_int|525
)paren
(brace
id|tempbx
op_assign
l_int|775
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_VGAVDE
op_eq
l_int|600
)paren
(brace
id|tempbx
op_assign
l_int|775
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_VGAVDE
op_eq
l_int|350
)paren
(brace
id|tempbx
op_assign
l_int|560
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_VGAVDE
op_eq
l_int|400
)paren
(brace
id|tempbx
op_assign
l_int|640
suffix:semicolon
)brace
r_else
id|tempbx
op_assign
l_int|768
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1280x1024
)paren
(brace
id|tempax
op_assign
l_int|1280
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VGAVDE
op_eq
l_int|360
)paren
id|tempbx
op_assign
l_int|768
suffix:semicolon
r_else
r_if
c_cond
(paren
id|SiS_VGAVDE
op_eq
l_int|375
)paren
(brace
id|tempbx
op_assign
l_int|800
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_VGAVDE
op_eq
l_int|405
)paren
(brace
id|tempbx
op_assign
l_int|864
suffix:semicolon
)brace
r_else
id|tempbx
op_assign
l_int|1024
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1280x960
)paren
(brace
id|tempax
op_assign
l_int|1280
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VGAVDE
op_eq
l_int|350
)paren
id|tempbx
op_assign
l_int|700
suffix:semicolon
r_else
r_if
c_cond
(paren
id|SiS_VGAVDE
op_eq
l_int|400
)paren
(brace
id|tempbx
op_assign
l_int|800
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_VGAVDE
op_eq
l_int|1024
)paren
(brace
id|tempbx
op_assign
l_int|960
suffix:semicolon
)brace
r_else
id|tempbx
op_assign
l_int|960
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_LCDInfo
op_amp
id|LCDNonExpanding
)paren
(brace
id|tempax
op_assign
id|SiS_VGAHDE
suffix:semicolon
id|tempbx
op_assign
id|SiS_VGAVDE
suffix:semicolon
)brace
id|SiS_HDE
op_assign
id|tempax
suffix:semicolon
id|SiS_VDE
op_assign
id|tempbx
suffix:semicolon
r_return
suffix:semicolon
)brace
)brace
id|USHORT
DECL|function|SiS_GetResInfo
id|SiS_GetResInfo
c_func
(paren
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
)paren
(brace
id|USHORT
id|resindex
suffix:semicolon
r_if
c_cond
(paren
id|ModeNo
op_le
l_int|0x13
)paren
(brace
id|resindex
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_ResInfo
suffix:semicolon
)brace
r_else
id|resindex
op_assign
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|Ext_RESINFO
suffix:semicolon
r_return
id|resindex
suffix:semicolon
)brace
multiline_comment|/* TW: Checked against 650/301LV, 650/LVDS, 630/LVDS, 630/301 and 630/301B BIOS */
r_void
DECL|function|SiS_GetCRT2ResInfo
id|SiS_GetCRT2ResInfo
c_func
(paren
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
comma
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
)paren
(brace
id|USHORT
id|xres
comma
id|yres
comma
id|modeflag
op_assign
l_int|0
comma
id|resindex
suffix:semicolon
id|resindex
op_assign
id|SiS_GetResInfo
c_func
(paren
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ModeNo
op_le
l_int|0x13
)paren
(brace
id|xres
op_assign
id|SiS_StResInfo
(braket
id|resindex
)braket
dot
id|HTotal
suffix:semicolon
id|yres
op_assign
id|SiS_StResInfo
(braket
id|resindex
)braket
dot
id|VTotal
suffix:semicolon
)brace
r_else
(brace
id|xres
op_assign
id|SiS_ModeResInfo
(braket
id|resindex
)braket
dot
id|HTotal
suffix:semicolon
id|yres
op_assign
id|SiS_ModeResInfo
(braket
id|resindex
)braket
dot
id|VTotal
suffix:semicolon
id|modeflag
op_assign
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|Ext_ModeFlag
suffix:semicolon
)brace
multiline_comment|/* TW: Inserted entire if-section from 650/LVDS BIOS 1.10.07: */
r_if
c_cond
(paren
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
op_logical_and
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|1
)paren
)paren
(brace
r_if
c_cond
(paren
(paren
id|ModeNo
op_ne
l_int|0x03
)paren
op_logical_and
(paren
id|SiS_SetFlag
op_amp
id|CRT2IsVGA
)paren
)paren
(brace
r_if
c_cond
(paren
id|yres
op_eq
l_int|350
)paren
(brace
id|yres
op_assign
l_int|400
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x3a
)paren
op_amp
l_int|0x01
)paren
(brace
r_if
c_cond
(paren
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x34
)paren
op_eq
l_int|0x12
)paren
(brace
id|yres
op_assign
l_int|400
suffix:semicolon
)brace
)brace
)brace
r_if
c_cond
(paren
id|ModeNo
OG
l_int|0x13
)paren
(brace
r_if
c_cond
(paren
id|SiS_IF_DEF_FSTN
op_eq
l_int|1
)paren
(brace
id|xres
op_mul_assign
l_int|2
suffix:semicolon
id|yres
op_mul_assign
l_int|2
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|modeflag
op_amp
id|HalfDCLK
)paren
(brace
id|xres
op_mul_assign
l_int|2
suffix:semicolon
)brace
r_if
c_cond
(paren
id|modeflag
op_amp
id|DoubleScanMode
)paren
(brace
id|yres
op_mul_assign
l_int|2
suffix:semicolon
)brace
)brace
)brace
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|0
)paren
(brace
multiline_comment|/* TW: Inserted from 650/301LV BIOS */
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCDA
)paren
(brace
r_if
c_cond
(paren
id|xres
op_eq
l_int|720
)paren
(brace
id|xres
op_assign
l_int|640
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|xres
op_eq
l_int|720
)paren
(brace
id|xres
op_assign
l_int|640
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1280x1024
)paren
(brace
r_if
c_cond
(paren
id|yres
op_eq
l_int|400
)paren
(brace
id|yres
op_assign
l_int|405
suffix:semicolon
)brace
r_if
c_cond
(paren
id|yres
op_eq
l_int|350
)paren
(brace
id|yres
op_assign
l_int|360
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_SetFlag
op_amp
id|LCDVESATiming
)paren
(brace
r_if
c_cond
(paren
id|yres
op_eq
l_int|360
)paren
(brace
id|yres
op_assign
l_int|375
suffix:semicolon
)brace
)brace
)brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1024x768
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_SetFlag
op_amp
id|LCDVESATiming
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_LCDInfo
op_amp
id|LCDNonExpanding
)paren
)paren
(brace
r_if
c_cond
(paren
id|yres
op_eq
l_int|350
)paren
(brace
id|yres
op_assign
l_int|357
suffix:semicolon
)brace
r_if
c_cond
(paren
id|yres
op_eq
l_int|400
)paren
(brace
id|yres
op_assign
l_int|420
suffix:semicolon
)brace
r_if
c_cond
(paren
id|yres
op_eq
l_int|480
)paren
(brace
id|yres
op_assign
l_int|525
suffix:semicolon
)brace
)brace
)brace
)brace
multiline_comment|/* TW: Inserted for 630/301B */
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
(brace
r_if
c_cond
(paren
id|xres
op_eq
l_int|720
)paren
(brace
id|xres
op_assign
l_int|640
suffix:semicolon
)brace
)brace
)brace
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|xres
op_eq
l_int|720
)paren
(brace
id|xres
op_assign
l_int|640
suffix:semicolon
)brace
multiline_comment|/* TW: Inserted from 650/LVDS and 630/LVDS BIOS */
r_if
c_cond
(paren
id|SiS_SetFlag
op_amp
id|CRT2IsVGA
)paren
(brace
id|yres
op_assign
l_int|400
suffix:semicolon
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
r_if
c_cond
(paren
id|SiS_GetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x17
)paren
op_amp
l_int|0x80
)paren
(brace
id|yres
op_assign
l_int|480
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|SiS_GetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x13
)paren
op_amp
l_int|0x80
)paren
(brace
id|yres
op_assign
l_int|480
suffix:semicolon
)brace
)brace
)brace
)brace
id|SiS_VGAHDE
op_assign
id|SiS_HDE
op_assign
id|xres
suffix:semicolon
id|SiS_VGAVDE
op_assign
id|SiS_VDE
op_assign
id|yres
suffix:semicolon
)brace
multiline_comment|/* TW: Checked against 650/301 and 650/LVDS (1.10.07) BIOS; modified for new panel resolutions */
multiline_comment|/* TW: Done differently in 630/301B BIOS; but same effect; checked against 630/301 */
r_void
DECL|function|SiS_GetCRT2Ptr
id|SiS_GetCRT2Ptr
c_func
(paren
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
comma
id|USHORT
id|RefreshRateTableIndex
comma
id|USHORT
op_star
id|CRT2Index
comma
id|USHORT
op_star
id|ResIndex
comma
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
)paren
(brace
id|USHORT
id|tempbx
op_assign
l_int|0
comma
id|tempal
op_assign
l_int|0
suffix:semicolon
id|USHORT
id|Flag
comma
id|resinfo
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCD
)paren
(brace
multiline_comment|/* LCD */
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1280x960
)paren
(brace
id|tempbx
op_assign
l_int|14
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_LCDInfo
op_amp
id|LCDNonExpanding
)paren
(brace
id|tempbx
op_assign
l_int|13
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1280x1024
)paren
(brace
id|tempbx
op_increment
suffix:semicolon
)brace
)brace
r_else
(brace
id|tempbx
op_assign
id|SiS_LCDResInfo
op_minus
id|Panel1024x768
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_SetFlag
op_amp
id|LCDVESATiming
)paren
)paren
(brace
id|tempbx
op_add_assign
l_int|5
suffix:semicolon
multiline_comment|/* GetRevisionID();  */
multiline_comment|/* TW: BIOS only adds 5 once */
id|tempbx
op_add_assign
l_int|5
suffix:semicolon
)brace
)brace
)brace
r_else
(brace
multiline_comment|/* TV */
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToHiVisionTV
)paren
(brace
r_if
c_cond
(paren
id|SiS_VGAVDE
OG
l_int|480
)paren
(brace
id|SiS_SetFlag
op_and_assign
(paren
op_complement
id|TVSimuMode
)paren
suffix:semicolon
)brace
multiline_comment|/* TW: Was &quot;(!TVSimuMode)&quot; - WRONG */
id|tempbx
op_assign
l_int|2
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_SetFlag
op_amp
id|TVSimuMode
)paren
)paren
(brace
id|tempbx
op_assign
l_int|12
suffix:semicolon
)brace
multiline_comment|/* TW: Was 10! - WRONG */
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetPALTV
)paren
(brace
id|tempbx
op_assign
l_int|3
suffix:semicolon
)brace
r_else
id|tempbx
op_assign
l_int|4
suffix:semicolon
r_if
c_cond
(paren
id|SiS_SetFlag
op_amp
id|TVSimuMode
)paren
(brace
id|tempbx
op_add_assign
l_int|5
suffix:semicolon
)brace
)brace
)brace
r_if
c_cond
(paren
id|ModeNo
op_le
l_int|0x13
)paren
(brace
id|tempal
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_CRT2CRTC
suffix:semicolon
)brace
r_else
id|tempal
op_assign
id|SiS_RefIndex
(braket
id|RefreshRateTableIndex
)braket
dot
id|Ext_CRT2CRTC
suffix:semicolon
id|tempal
op_and_assign
l_int|0x3F
suffix:semicolon
r_if
c_cond
(paren
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
op_logical_and
(paren
id|SiS_VBInfo
op_amp
(paren
id|SetCRT2ToTV
op_minus
id|SetCRT2ToHiVisionTV
)paren
)paren
)paren
(brace
multiline_comment|/* TW: Added -Hivision (BIOS) */
r_if
c_cond
(paren
id|tempal
op_eq
l_int|0x06
)paren
(brace
id|tempal
op_assign
l_int|0x07
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
(brace
r_if
c_cond
(paren
(paren
id|ModeNo
op_eq
l_int|0x31
)paren
op_logical_or
(paren
id|ModeNo
op_eq
l_int|0x32
)paren
)paren
(brace
id|tempal
op_assign
l_int|6
suffix:semicolon
)brace
)brace
op_star
id|CRT2Index
op_assign
id|tempbx
suffix:semicolon
op_star
id|ResIndex
op_assign
id|tempal
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* LVDS */
id|Flag
op_assign
l_int|1
suffix:semicolon
id|tempbx
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_CH70xx
op_ne
l_int|0
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCD
)paren
)paren
(brace
id|Flag
op_assign
l_int|0
suffix:semicolon
id|tempbx
op_assign
l_int|10
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetPALTV
)paren
(brace
id|tempbx
op_add_assign
l_int|2
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCHTVOverScan
)paren
(brace
id|tempbx
op_add_assign
l_int|1
suffix:semicolon
)brace
)brace
)brace
r_if
c_cond
(paren
id|Flag
op_eq
l_int|1
)paren
(brace
id|tempbx
op_assign
id|SiS_LCDResInfo
op_minus
id|PanelMinLVDS
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_le
id|Panel1280x1024
)paren
(brace
r_if
c_cond
(paren
id|SiS_LCDInfo
op_amp
id|LCDNonExpanding
)paren
(brace
id|tempbx
op_add_assign
l_int|3
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1400x1050
)paren
(brace
id|tempbx
op_assign
l_int|8
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDInfo
op_amp
id|LCDNonExpanding
)paren
(brace
id|tempbx
op_increment
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|SiS_LCDInfo
op_amp
l_int|0x0100
)paren
(brace
id|tempbx
op_assign
l_int|7
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel640x480
)paren
(brace
id|tempbx
op_assign
l_int|6
suffix:semicolon
)brace
multiline_comment|/* TW: Inserted from 630/LVDS 2.04.5c BIOS */
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1024x600
)paren
(brace
id|tempbx
op_assign
l_int|15
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDInfo
op_amp
id|LCDNonExpanding
)paren
(brace
id|tempbx
op_add_assign
l_int|2
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1152x768
)paren
(brace
id|tempbx
op_assign
l_int|16
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDInfo
op_amp
id|LCDNonExpanding
)paren
(brace
id|tempbx
op_add_assign
l_int|2
suffix:semicolon
)brace
)brace
)brace
)brace
r_if
c_cond
(paren
id|ModeNo
op_le
l_int|0x13
)paren
(brace
id|tempal
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_CRT2CRTC
suffix:semicolon
)brace
r_else
(brace
id|tempal
op_assign
id|SiS_RefIndex
(braket
id|RefreshRateTableIndex
)braket
dot
id|Ext_CRT2CRTC
suffix:semicolon
id|resinfo
op_assign
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|Ext_RESINFO
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_IF_DEF_FSTN
)paren
(brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel320x480
)paren
(brace
id|tempbx
op_assign
l_int|14
suffix:semicolon
id|tempal
op_assign
l_int|6
suffix:semicolon
)brace
)brace
multiline_comment|/* TW: Inserted from 650/LVDS BIOS */
r_if
c_cond
(paren
id|SiS_SetFlag
op_amp
id|CRT2IsVGA
)paren
(brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_ne
id|Panel640x480
)paren
(brace
id|tempal
op_assign
l_int|7
suffix:semicolon
)brace
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
multiline_comment|/* TW: Inserted from 630/LVDS (2.04.5c) and 630/301B (II) BIOS */
r_if
c_cond
(paren
id|SiS_GetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x13
)paren
op_amp
l_int|0x80
)paren
(brace
id|tempal
op_increment
suffix:semicolon
)brace
)brace
)brace
multiline_comment|/* TW: Inserted from 630/301B BIOS */
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
(brace
r_if
c_cond
(paren
id|ModeNo
OG
l_int|0x13
)paren
(brace
r_if
c_cond
(paren
(paren
id|resinfo
op_eq
l_int|0x0c
)paren
op_logical_or
(paren
id|resinfo
op_eq
l_int|0x0d
)paren
)paren
(brace
id|tempal
op_assign
l_int|6
suffix:semicolon
)brace
)brace
)brace
op_star
id|CRT2Index
op_assign
id|tempbx
suffix:semicolon
op_star
id|ResIndex
op_assign
id|tempal
op_amp
l_int|0x1F
suffix:semicolon
)brace
)brace
r_void
DECL|function|SiS_GetCRT2PtrA
id|SiS_GetCRT2PtrA
c_func
(paren
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
comma
id|USHORT
id|RefreshRateTableIndex
comma
id|USHORT
op_star
id|CRT2Index
comma
id|USHORT
op_star
id|ResIndex
)paren
(brace
id|USHORT
id|tempbx
comma
id|tempal
suffix:semicolon
id|tempbx
op_assign
id|SiS_LCDResInfo
op_minus
id|Panel1024x768
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDInfo
op_amp
id|LCDNonExpanding
)paren
(brace
id|tempbx
op_add_assign
l_int|3
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ModeNo
op_le
l_int|0x13
)paren
(brace
id|tempal
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_CRT2CRTC
suffix:semicolon
)brace
r_else
id|tempal
op_assign
id|SiS_RefIndex
(braket
id|RefreshRateTableIndex
)braket
dot
id|Ext_CRT2CRTC
suffix:semicolon
op_star
id|CRT2Index
op_assign
id|tempbx
suffix:semicolon
op_star
id|ResIndex
op_assign
id|tempal
op_amp
l_int|0x1F
suffix:semicolon
)brace
multiline_comment|/* TW: New from 650/301LV BIOS */
r_void
DECL|function|SiS_GetCRT2Part2Ptr
id|SiS_GetCRT2Part2Ptr
c_func
(paren
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
comma
id|USHORT
id|RefreshRateTableIndex
comma
id|USHORT
op_star
id|CRT2Index
comma
id|USHORT
op_star
id|ResIndex
)paren
(brace
id|USHORT
id|tempbx
comma
id|tempal
suffix:semicolon
r_if
c_cond
(paren
id|ModeNo
op_le
l_int|0x13
)paren
(brace
id|tempal
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_CRT2CRTC
suffix:semicolon
)brace
r_else
id|tempal
op_assign
id|SiS_RefIndex
(braket
id|RefreshRateTableIndex
)braket
dot
id|Ext_CRT2CRTC
suffix:semicolon
id|tempbx
op_assign
id|SiS_LCDResInfo
op_minus
id|Panel1024x768
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDInfo
op_amp
id|LCDNonExpanding
)paren
(brace
id|tempbx
op_add_assign
l_int|2
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_SetFlag
op_amp
id|LCDVESATiming
)paren
(brace
id|tempbx
op_add_assign
l_int|4
suffix:semicolon
)brace
op_star
id|CRT2Index
op_assign
id|tempbx
suffix:semicolon
op_star
id|ResIndex
op_assign
id|tempal
op_amp
l_int|0x3F
suffix:semicolon
)brace
multiline_comment|/* TW: Checked against 650/LVDS (1.10.07) and 630/301B BIOS */
id|USHORT
DECL|function|SiS_GetRatePtrCRT2
id|SiS_GetRatePtrCRT2
c_func
(paren
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
)paren
(brace
id|SHORT
id|LCDRefreshIndex
(braket
)braket
op_assign
(brace
l_int|0x00
comma
l_int|0x00
comma
l_int|0x03
comma
l_int|0x01
comma
l_int|0x01
comma
l_int|0x01
comma
l_int|0x01
comma
l_int|0x01
)brace
suffix:semicolon
id|USHORT
id|RefreshRateTableIndex
comma
id|i
comma
id|backup_i
suffix:semicolon
id|USHORT
id|modeflag
comma
id|index
comma
id|temp
suffix:semicolon
r_if
c_cond
(paren
id|ModeNo
op_le
l_int|0x13
)paren
id|modeflag
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_ModeFlag
suffix:semicolon
r_else
id|modeflag
op_assign
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|Ext_ModeFlag
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_CH70xx
op_ne
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
(brace
r_if
c_cond
(paren
id|modeflag
op_amp
id|HalfDCLK
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
)brace
)brace
r_if
c_cond
(paren
id|ModeNo
OL
l_int|0x14
)paren
(brace
r_return
l_int|0xFFFF
suffix:semicolon
)brace
multiline_comment|/* TW: CR33 holds refresh rate index for CRT1 [3:0] and CRT2 [7:4].&n;  *     On LVDS machines, CRT2 index is always 0 and will be&n;  *     set to 0 by the following code; this causes the function&n;  *     to take the first non-interlaced mode in SiS_Ext2Struct&n;  */
id|index
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x33
)paren
suffix:semicolon
id|index
op_rshift_assign
id|SiS_SelectCRT2Rate
suffix:semicolon
id|index
op_and_assign
l_int|0x0F
suffix:semicolon
r_if
c_cond
(paren
id|index
OG
l_int|0
)paren
(brace
id|index
op_decrement
suffix:semicolon
)brace
multiline_comment|/* TW: Added SetFlag and VBInfo checks; we don&squot;t care about index if we&n;   *     are setting CRT1 rate!&n;   */
r_if
c_cond
(paren
(paren
id|SiS_SetFlag
op_amp
id|ProgrammingCRT2
)paren
op_logical_and
(paren
id|SiS_VBInfo
op_amp
(paren
id|SetCRT2ToLCD
op_or
id|SetCRT2ToLCDA
)paren
)paren
)paren
(brace
id|index
op_assign
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_SetFlag
op_amp
id|ProgrammingCRT2
)paren
(brace
r_if
c_cond
(paren
id|SiS_IF_DEF_CH70xx
op_ne
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
(brace
id|index
op_assign
l_int|0
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
(paren
id|SetCRT2ToLCD
op_or
id|SetCRT2ToLCDA
)paren
)paren
(brace
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|0
)paren
(brace
multiline_comment|/* TW: This is not done in 630/301B BIOS */
id|temp
op_assign
id|LCDRefreshIndex
(braket
id|SiS_LCDResInfo
)braket
suffix:semicolon
r_if
c_cond
(paren
id|index
OG
id|temp
)paren
(brace
id|index
op_assign
id|temp
suffix:semicolon
)brace
)brace
r_else
(brace
id|index
op_assign
l_int|0
suffix:semicolon
)brace
)brace
)brace
id|RefreshRateTableIndex
op_assign
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|REFindex
suffix:semicolon
id|ModeNo
op_assign
id|SiS_RefIndex
(braket
id|RefreshRateTableIndex
)braket
dot
id|ModeID
suffix:semicolon
multiline_comment|/* TW: Inserted from 650/LVDS 1.10.07 */
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|1
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|DriverMode
)paren
)paren
(brace
r_if
c_cond
(paren
(paren
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|Ext_VESAID
op_eq
l_int|0x105
)paren
op_logical_or
(paren
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|Ext_VESAID
op_eq
l_int|0x107
)paren
)paren
(brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_le
id|Panel800x600
)paren
(brace
id|RefreshRateTableIndex
op_increment
suffix:semicolon
)brace
)brace
)brace
)brace
id|i
op_assign
l_int|0
suffix:semicolon
r_do
(brace
r_if
c_cond
(paren
id|SiS_RefIndex
(braket
id|RefreshRateTableIndex
op_plus
id|i
)braket
dot
id|ModeID
op_ne
id|ModeNo
)paren
r_break
suffix:semicolon
id|temp
op_assign
id|SiS_RefIndex
(braket
id|RefreshRateTableIndex
op_plus
id|i
)braket
dot
id|Ext_InfoFlag
suffix:semicolon
id|temp
op_and_assign
id|ModeInfoFlag
suffix:semicolon
r_if
c_cond
(paren
id|temp
OL
id|SiS_ModeType
)paren
(brace
r_break
suffix:semicolon
)brace
id|i
op_increment
suffix:semicolon
id|index
op_decrement
suffix:semicolon
)brace
r_while
c_loop
(paren
id|index
op_ne
l_int|0xFFFF
)paren
(brace
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToRAMDAC
)paren
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
(brace
id|temp
op_assign
id|SiS_RefIndex
(braket
id|RefreshRateTableIndex
op_plus
id|i
op_minus
l_int|1
)braket
dot
id|Ext_InfoFlag
suffix:semicolon
r_if
c_cond
(paren
id|temp
op_amp
id|InterlaceMode
)paren
(brace
id|i
op_increment
suffix:semicolon
)brace
)brace
)brace
id|i
op_decrement
suffix:semicolon
r_if
c_cond
(paren
(paren
id|SiS_SetFlag
op_amp
id|ProgrammingCRT2
)paren
op_logical_and
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|DisableCRT2Display
)paren
)paren
)paren
(brace
id|backup_i
op_assign
id|i
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_AdjustCRT2Rate
c_func
(paren
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|RefreshRateTableIndex
comma
op_amp
id|i
)paren
)paren
)paren
(brace
multiline_comment|/* TW: This is for avoiding random data to be used; i is&n;&t;&t; *     in an undefined state if no matching CRT2 mode is&n;&t;&t; *     found.&n;&t;&t; */
id|i
op_assign
id|backup_i
suffix:semicolon
)brace
)brace
r_return
id|RefreshRateTableIndex
op_plus
id|i
suffix:semicolon
)brace
multiline_comment|/* Checked against 650/LVDS (1.10.07) BIOS */
id|BOOLEAN
DECL|function|SiS_AdjustCRT2Rate
id|SiS_AdjustCRT2Rate
c_func
(paren
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
comma
id|USHORT
id|RefreshRateTableIndex
comma
id|USHORT
op_star
id|i
)paren
(brace
id|USHORT
id|tempax
comma
id|tempbx
comma
id|resinfo
suffix:semicolon
id|USHORT
id|modeflag
comma
id|infoflag
suffix:semicolon
r_if
c_cond
(paren
id|ModeNo
op_le
l_int|0x13
)paren
id|modeflag
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_ModeFlag
suffix:semicolon
r_else
id|modeflag
op_assign
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|Ext_ModeFlag
suffix:semicolon
id|resinfo
op_assign
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|Ext_RESINFO
suffix:semicolon
id|tempbx
op_assign
id|SiS_RefIndex
(braket
id|RefreshRateTableIndex
op_plus
(paren
op_star
id|i
)paren
)braket
dot
id|ModeID
suffix:semicolon
id|tempax
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|0
)paren
(brace
multiline_comment|/* TW: For 301, 301B, 302B, 301LV, 302LV */
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToRAMDAC
)paren
(brace
id|tempax
op_or_assign
id|SupportRAMDAC2
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
(paren
id|SetCRT2ToLCD
op_or
id|SetCRT2ToLCDA
)paren
)paren
(brace
id|tempax
op_or_assign
id|SupportLCD
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_ne
id|Panel1280x1024
)paren
(brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_ne
id|Panel1280x960
)paren
(brace
r_if
c_cond
(paren
id|SiS_LCDInfo
op_amp
id|LCDNonExpanding
)paren
(brace
r_if
c_cond
(paren
id|resinfo
op_ge
l_int|9
)paren
(brace
id|tempax
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
)brace
)brace
)brace
)brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToHiVisionTV
)paren
(brace
multiline_comment|/* for HiTV */
id|tempax
op_or_assign
id|SupportHiVisionTV
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
(brace
r_if
c_cond
(paren
id|resinfo
op_eq
l_int|4
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|resinfo
op_eq
l_int|3
)paren
(brace
r_if
c_cond
(paren
id|SiS_SetFlag
op_amp
id|TVSimuMode
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|resinfo
OG
l_int|7
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
(paren
id|SetCRT2ToAVIDEO
op_or
id|SetCRT2ToSVIDEO
op_or
id|SetCRT2ToSCART
)paren
)paren
(brace
id|tempax
op_or_assign
id|SupportTV
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
(brace
id|tempax
op_or_assign
id|SupportTV1024
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetPALTV
)paren
)paren
(brace
r_if
c_cond
(paren
id|modeflag
op_amp
id|NoSupportSimuTV
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetNotSimuMode
)paren
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
)brace
)brace
)brace
)brace
)brace
)brace
r_else
(brace
multiline_comment|/* TW: for LVDS  */
r_if
c_cond
(paren
id|SiS_IF_DEF_CH70xx
op_ne
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
(brace
id|tempax
op_or_assign
id|SupportCHTV
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCD
)paren
(brace
id|tempax
op_or_assign
id|SupportLCD
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1280x768
)paren
(brace
multiline_comment|/* TW: Bios code makes no sense */
)brace
r_else
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1400x1050
)paren
(brace
r_if
c_cond
(paren
(paren
id|resinfo
op_ne
l_int|0x15
)paren
op_logical_and
(paren
id|resinfo
OG
l_int|0x09
)paren
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1280x1024
)paren
(brace
r_if
c_cond
(paren
id|resinfo
OG
l_int|0x09
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1024x768
)paren
(brace
r_if
c_cond
(paren
id|resinfo
OG
l_int|0x08
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel800x600
)paren
(brace
r_if
c_cond
(paren
id|resinfo
OG
l_int|0x07
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|resinfo
op_eq
l_int|0x04
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
)brace
)brace
)brace
multiline_comment|/* TW: Look backwards in table for matching CRT2 mode */
r_for
c_loop
(paren
suffix:semicolon
id|SiS_RefIndex
(braket
id|RefreshRateTableIndex
op_plus
(paren
op_star
id|i
)paren
)braket
dot
id|ModeID
op_eq
id|tempbx
suffix:semicolon
(paren
op_star
id|i
)paren
op_decrement
)paren
(brace
id|infoflag
op_assign
id|SiS_RefIndex
(braket
id|RefreshRateTableIndex
op_plus
(paren
op_star
id|i
)paren
)braket
dot
id|Ext_InfoFlag
suffix:semicolon
r_if
c_cond
(paren
id|infoflag
op_amp
id|tempax
)paren
(brace
r_return
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
op_star
id|i
)paren
op_eq
l_int|0
)paren
r_break
suffix:semicolon
)brace
multiline_comment|/* TW: Look through the whole mode-section of the table from the beginning&n;   *     for a matching CRT2 mode if no mode was found yet.&n;   */
r_for
c_loop
(paren
(paren
op_star
id|i
)paren
op_assign
l_int|0
suffix:semicolon
suffix:semicolon
(paren
op_star
id|i
)paren
op_increment
)paren
(brace
id|infoflag
op_assign
id|SiS_RefIndex
(braket
id|RefreshRateTableIndex
op_plus
(paren
op_star
id|i
)paren
)braket
dot
id|Ext_InfoFlag
suffix:semicolon
r_if
c_cond
(paren
id|SiS_RefIndex
(braket
id|RefreshRateTableIndex
op_plus
(paren
op_star
id|i
)paren
)braket
dot
id|ModeID
op_ne
id|tempbx
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|infoflag
op_amp
id|tempax
)paren
(brace
r_return
l_int|1
suffix:semicolon
)brace
)brace
r_return
l_int|1
suffix:semicolon
)brace
multiline_comment|/* Checked against 650/LVDS (1.10.07) and 650/301LV BIOS */
r_void
DECL|function|SiS_SaveCRT2Info
id|SiS_SaveCRT2Info
c_func
(paren
id|USHORT
id|ModeNo
)paren
(brace
id|USHORT
id|temp1
comma
id|temp2
suffix:semicolon
multiline_comment|/* TW: We store CRT1 ModeNo in CR34 */
id|SiS_SetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x34
comma
id|ModeNo
)paren
suffix:semicolon
id|temp1
op_assign
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
op_rshift
l_int|8
suffix:semicolon
id|temp2
op_assign
op_complement
(paren
id|SetInSlaveMode
op_rshift
l_int|8
)paren
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_P3d4
comma
l_int|0x31
comma
id|temp2
comma
id|temp1
)paren
suffix:semicolon
)brace
multiline_comment|/* TW: Checked against 650+301, 650/LVDS (1.10.07) and 650/301LV BIOS */
r_void
DECL|function|SiS_GetVBInfo301
id|SiS_GetVBInfo301
c_func
(paren
id|USHORT
id|BaseAddr
comma
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
comma
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
)paren
(brace
id|USHORT
id|tempax
comma
id|tempbx
comma
id|temp
suffix:semicolon
id|USHORT
id|modeflag
comma
id|resinfo
op_assign
l_int|0
suffix:semicolon
id|UCHAR
id|OutputSelect
op_assign
op_star
id|pSiS_OutputSelect
suffix:semicolon
r_if
c_cond
(paren
id|ModeNo
op_le
l_int|0x13
)paren
id|modeflag
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_ModeFlag
suffix:semicolon
r_else
(brace
id|modeflag
op_assign
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|Ext_ModeFlag
suffix:semicolon
id|resinfo
op_assign
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|Ext_RESINFO
suffix:semicolon
)brace
id|SiS_SetFlag
op_assign
l_int|0
suffix:semicolon
id|SiS_ModeType
op_assign
id|modeflag
op_amp
id|ModeInfoFlag
suffix:semicolon
id|tempbx
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|SiS_BridgeIsOn
c_func
(paren
id|BaseAddr
comma
id|HwDeviceExtension
)paren
op_eq
l_int|0
)paren
(brace
multiline_comment|/* TW: &quot;== 0&quot; inserted from 630/301B BIOS */
id|temp
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x30
)paren
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBType
op_amp
(paren
id|VB_SIS301LV
op_or
id|VB_SIS302LV
)paren
)paren
(brace
multiline_comment|/* TW: Not in (301B) BIOS */
id|temp
op_and_assign
l_int|0xbf
suffix:semicolon
multiline_comment|/* 301lvds disable CRT2RAMDAC */
)brace
r_if
c_cond
(paren
id|SiS_IF_DEF_FSTN
)paren
(brace
multiline_comment|/* fstn must set CR30=0x21 */
id|temp
op_assign
l_int|0x21
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x30
comma
id|temp
)paren
suffix:semicolon
)brace
id|tempbx
op_or_assign
id|temp
suffix:semicolon
id|temp
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x31
)paren
suffix:semicolon
id|tempax
op_assign
id|temp
op_lshift
l_int|8
suffix:semicolon
id|tempax
op_and_assign
(paren
id|LoadDACFlag
op_or
id|DriverMode
op_or
id|SetDispDevSwitch
op_or
multiline_comment|/* TW: Inserted from 650/LVDS+301LV BIOS */
id|SetNotSimuMode
op_or
id|SetPALTV
)paren
suffix:semicolon
multiline_comment|/* TW: Inserted from 650/LVDS+301LV BIOS */
id|tempbx
op_or_assign
id|tempax
suffix:semicolon
id|temp
op_assign
id|SetCHTVOverScan
op_or
id|SetInSlaveMode
op_or
id|DisableCRT2Display
suffix:semicolon
id|temp
op_assign
l_int|0xFFFF
op_xor
id|temp
suffix:semicolon
id|tempbx
op_and_assign
id|temp
suffix:semicolon
macro_line|#ifdef SIS315H
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
multiline_comment|/* TW: Inserted this &quot;if&quot; */
id|temp
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x38
)paren
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBType
op_amp
(paren
id|VB_SIS302B
op_or
id|VB_SIS302LV
)paren
)paren
(brace
r_if
c_cond
(paren
(paren
id|temp
op_amp
(paren
id|EnableDualEdge
op_or
id|SetToLCDA
)paren
)paren
op_eq
(paren
id|EnableDualEdge
op_or
id|SetToLCDA
)paren
)paren
(brace
multiline_comment|/* TW: BIOS only tests these bits, added &quot;&amp; ...&quot; */
id|tempbx
op_or_assign
id|SetCRT2ToLCDA
suffix:semicolon
)brace
)brace
multiline_comment|/* TW: Inserted from 650/LVDS BIOS: */
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|1
)paren
(brace
r_if
c_cond
(paren
id|temp
op_amp
id|SetToLCDA
)paren
(brace
id|tempbx
op_or_assign
id|SetCRT2ToLCDA
suffix:semicolon
)brace
r_if
c_cond
(paren
id|temp
op_amp
l_int|0x08
)paren
(brace
id|tempbx
op_or_assign
id|SetCRT2ToHiVisionTV
suffix:semicolon
)brace
)brace
)brace
macro_line|#endif
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|0
)paren
(brace
id|temp
op_assign
id|SetCRT2ToLCDA
op_or
id|SetCRT2ToSCART
op_or
id|SetCRT2ToLCD
op_or
id|SetCRT2ToRAMDAC
op_or
id|SetCRT2ToSVIDEO
op_or
id|SetCRT2ToAVIDEO
suffix:semicolon
multiline_comment|/* = 0x807C; */
r_if
c_cond
(paren
id|SiS_IF_DEF_HiVision
op_eq
l_int|1
)paren
(brace
id|temp
op_or_assign
id|SetCRT2ToHiVisionTV
suffix:semicolon
)brace
multiline_comment|/* = 0x80FC; */
)brace
r_else
(brace
multiline_comment|/* TW: Inserted entire 315-section */
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
r_if
c_cond
(paren
id|SiS_IF_DEF_CH70xx
op_ne
l_int|0
)paren
(brace
id|temp
op_assign
id|SetCRT2ToLCDA
op_or
id|SetCRT2ToSCART
op_or
id|SetCRT2ToLCD
op_or
id|SetCRT2ToHiVisionTV
op_or
id|SetCRT2ToAVIDEO
op_or
id|SetCRT2ToSVIDEO
suffix:semicolon
)brace
multiline_comment|/* 0x80bc */
r_else
id|temp
op_assign
id|SetCRT2ToLCDA
op_or
id|SetCRT2ToLCD
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|SiS_IF_DEF_CH70xx
op_ne
l_int|0
)paren
(brace
id|temp
op_assign
id|SetCRT2ToTV
op_or
id|SetCRT2ToLCD
suffix:semicolon
)brace
r_else
id|temp
op_assign
id|SetCRT2ToLCD
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|tempbx
op_amp
id|temp
)paren
)paren
(brace
id|tempax
op_assign
id|DisableCRT2Display
suffix:semicolon
id|tempbx
op_assign
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|tempbx
op_amp
id|SetCRT2ToLCDA
)paren
(brace
id|tempbx
op_and_assign
(paren
l_int|0xFF00
op_or
id|SwitchToCRT2
op_or
id|SetSimuScanMode
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|tempbx
op_amp
id|SetCRT2ToRAMDAC
)paren
(brace
id|tempbx
op_and_assign
(paren
l_int|0xFF00
op_or
id|SetCRT2ToRAMDAC
op_or
id|SwitchToCRT2
op_or
id|SetSimuScanMode
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
(paren
id|tempbx
op_amp
id|SetCRT2ToLCD
)paren
op_logical_and
(paren
op_logical_neg
(paren
id|SiS_VBType
op_amp
id|VB_NoLCD
)paren
)paren
)paren
(brace
id|tempbx
op_and_assign
(paren
l_int|0xFF00
op_or
id|SetCRT2ToLCD
op_or
id|SwitchToCRT2
op_or
id|SetSimuScanMode
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|tempbx
op_amp
id|SetCRT2ToSCART
)paren
(brace
id|tempbx
op_and_assign
(paren
l_int|0xFF00
op_or
id|SetCRT2ToSCART
op_or
id|SwitchToCRT2
op_or
id|SetSimuScanMode
)paren
suffix:semicolon
id|tempbx
op_or_assign
id|SetPALTV
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|tempbx
op_amp
id|SetCRT2ToHiVisionTV
)paren
(brace
id|tempbx
op_and_assign
(paren
l_int|0xFF00
op_or
id|SetCRT2ToHiVisionTV
op_or
id|SwitchToCRT2
op_or
id|SetSimuScanMode
)paren
suffix:semicolon
id|tempbx
op_or_assign
id|SetPALTV
suffix:semicolon
)brace
)brace
r_else
(brace
multiline_comment|/* LVDS */
multiline_comment|/* TW: Inserted entire 315/325 section */
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
r_if
c_cond
(paren
id|tempbx
op_amp
id|SetCRT2ToLCDA
)paren
(brace
id|tempbx
op_and_assign
(paren
l_int|0xFF00
op_or
id|SwitchToCRT2
op_or
id|SetSimuScanMode
)paren
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|SiS_IF_DEF_CH70xx
op_ne
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|tempbx
op_amp
id|SetCRT2ToTV
)paren
(brace
id|tempbx
op_and_assign
(paren
l_int|0xFF00
op_or
id|SetCRT2ToTV
op_or
id|SwitchToCRT2
op_or
id|SetSimuScanMode
)paren
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|tempbx
op_amp
id|SetCRT2ToLCD
)paren
(brace
id|tempbx
op_and_assign
(paren
l_int|0xFF00
op_or
id|SetCRT2ToLCD
op_or
id|SwitchToCRT2
op_or
id|SetSimuScanMode
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
r_if
c_cond
(paren
id|tempbx
op_amp
id|SetCRT2ToLCDA
)paren
(brace
id|tempbx
op_or_assign
id|SetCRT2ToLCD
suffix:semicolon
)brace
)brace
)brace
r_if
c_cond
(paren
id|tempax
op_amp
id|DisableCRT2Display
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|tempbx
op_amp
(paren
id|SwitchToCRT2
op_or
id|SetSimuScanMode
)paren
)paren
)paren
(brace
id|tempbx
op_assign
id|SetSimuScanMode
op_or
id|DisableCRT2Display
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|tempbx
op_amp
id|DriverMode
)paren
)paren
(brace
id|tempbx
op_or_assign
id|SetSimuScanMode
suffix:semicolon
)brace
multiline_comment|/* TW: LVDS (LCD/TV) and 630+301B (LCD) can only be slave in 8bpp modes */
r_if
c_cond
(paren
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|1
)paren
op_logical_and
(paren
id|SiS_ModeType
op_le
id|ModeVGA
)paren
)paren
(brace
id|modeflag
op_and_assign
(paren
op_complement
id|CRT2Mode
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
op_logical_and
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
)paren
(brace
r_if
c_cond
(paren
id|SiS_ModeType
op_le
id|ModeVGA
)paren
(brace
r_if
c_cond
(paren
id|tempbx
op_amp
id|SetCRT2ToLCD
)paren
(brace
id|modeflag
op_and_assign
(paren
op_complement
id|CRT2Mode
)paren
suffix:semicolon
)brace
)brace
)brace
multiline_comment|/* TW end */
r_if
c_cond
(paren
op_logical_neg
(paren
id|tempbx
op_amp
id|SetSimuScanMode
)paren
)paren
(brace
r_if
c_cond
(paren
id|tempbx
op_amp
id|SwitchToCRT2
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|modeflag
op_amp
id|CRT2Mode
)paren
)paren
(brace
r_if
c_cond
(paren
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
op_logical_and
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
)paren
(brace
r_if
c_cond
(paren
id|resinfo
op_ne
l_int|0x0a
)paren
(brace
id|tempbx
op_or_assign
id|SetSimuScanMode
suffix:semicolon
)brace
)brace
r_else
(brace
id|tempbx
op_or_assign
id|SetSimuScanMode
suffix:semicolon
)brace
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_BridgeIsEnable
c_func
(paren
id|BaseAddr
comma
id|HwDeviceExtension
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|tempbx
op_amp
id|DriverMode
)paren
)paren
(brace
r_if
c_cond
(paren
id|SiS_BridgeInSlave
c_func
(paren
)paren
)paren
(brace
id|tempbx
op_or_assign
id|SetSimuScanMode
suffix:semicolon
multiline_comment|/* TW: from BIOS 650/301/301LV/LVDS */
)brace
)brace
)brace
)brace
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|tempbx
op_amp
id|DisableCRT2Display
)paren
)paren
(brace
r_if
c_cond
(paren
id|tempbx
op_amp
id|DriverMode
)paren
(brace
r_if
c_cond
(paren
id|tempbx
op_amp
id|SetSimuScanMode
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|modeflag
op_amp
id|CRT2Mode
)paren
)paren
(brace
r_if
c_cond
(paren
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
op_logical_and
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
)paren
(brace
r_if
c_cond
(paren
id|resinfo
op_ne
l_int|0x0a
)paren
(brace
multiline_comment|/* TW: Inserted from 650/301 BIOS */
id|tempbx
op_or_assign
id|SetInSlaveMode
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|tempbx
op_amp
id|SetCRT2ToTV
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|tempbx
op_amp
id|SetNotSimuMode
)paren
)paren
(brace
id|SiS_SetFlag
op_or_assign
id|TVSimuMode
suffix:semicolon
)brace
)brace
)brace
)brace
multiline_comment|/* TW: Inserted from 650/301 BIOS */
)brace
r_else
(brace
id|tempbx
op_or_assign
id|SetInSlaveMode
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|tempbx
op_amp
id|SetCRT2ToTV
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|tempbx
op_amp
id|SetNotSimuMode
)paren
)paren
(brace
id|SiS_SetFlag
op_or_assign
id|TVSimuMode
suffix:semicolon
)brace
)brace
)brace
)brace
)brace
)brace
)brace
r_else
(brace
id|tempbx
op_or_assign
id|SetInSlaveMode
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|tempbx
op_amp
id|SetCRT2ToTV
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|tempbx
op_amp
id|SetNotSimuMode
)paren
)paren
(brace
id|SiS_SetFlag
op_or_assign
id|TVSimuMode
suffix:semicolon
)brace
)brace
)brace
)brace
)brace
r_if
c_cond
(paren
id|SiS_IF_DEF_CH70xx
op_eq
l_int|1
)paren
(brace
id|temp
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x35
)paren
suffix:semicolon
r_if
c_cond
(paren
id|temp
op_amp
id|TVOverScan
)paren
(brace
id|tempbx
op_or_assign
id|SetCHTVOverScan
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|SiS_IF_DEF_CH70xx
op_eq
l_int|2
)paren
(brace
id|temp
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x79
)paren
suffix:semicolon
r_if
c_cond
(paren
id|temp
op_amp
l_int|0x80
)paren
(brace
id|tempbx
op_or_assign
id|SetCHTVOverScan
suffix:semicolon
)brace
)brace
)brace
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|0
)paren
(brace
macro_line|#ifdef SIS300
r_if
c_cond
(paren
(paren
id|HwDeviceExtension-&gt;jChipType
op_eq
id|SIS_630
)paren
op_logical_or
(paren
id|HwDeviceExtension-&gt;jChipType
op_eq
id|SIS_730
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|OutputSelect
op_amp
id|EnablePALMN
)paren
)paren
(brace
id|SiS_SetRegAND
c_func
(paren
id|SiS_P3d4
comma
l_int|0x35
comma
l_int|0x3F
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|tempbx
op_amp
id|SetCRT2ToTV
)paren
(brace
r_if
c_cond
(paren
id|tempbx
op_amp
id|SetPALTV
)paren
(brace
id|temp
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x35
)paren
suffix:semicolon
id|temp
op_and_assign
l_int|0xC0
suffix:semicolon
r_if
c_cond
(paren
id|temp
op_eq
l_int|0x40
)paren
(brace
id|tempbx
op_and_assign
(paren
op_complement
id|SetPALTV
)paren
suffix:semicolon
)brace
)brace
)brace
)brace
macro_line|#endif
macro_line|#ifdef SIS315H
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|OutputSelect
op_amp
id|EnablePALMN
)paren
)paren
(brace
id|SiS_SetRegAND
c_func
(paren
id|SiS_P3d4
comma
l_int|0x38
comma
l_int|0x3F
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|tempbx
op_amp
id|SetCRT2ToTV
)paren
(brace
r_if
c_cond
(paren
id|tempbx
op_amp
id|SetPALTV
)paren
(brace
id|temp
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x38
)paren
suffix:semicolon
multiline_comment|/* temp &amp;= 0xC0;  */
multiline_comment|/* TW: BIOS only tests 0x40, not 0x80 */
r_if
c_cond
(paren
id|temp
op_amp
l_int|0x40
)paren
(brace
id|tempbx
op_and_assign
(paren
op_complement
id|SetPALTV
)paren
suffix:semicolon
)brace
)brace
)brace
)brace
macro_line|#endif
)brace
id|SiS_VBInfo
op_assign
id|tempbx
suffix:semicolon
multiline_comment|/* TW: DevSwitch not supported here */
macro_line|#ifdef TWDEBUG
macro_line|#ifdef LINUX_KERNEL
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;sisfb: (VBInfo = %x, SetFlag = %x)&bslash;n&quot;
comma
id|SiS_VBInfo
comma
id|SiS_SetFlag
)paren
suffix:semicolon
macro_line|#endif
macro_line|#ifdef LINUX_XF86
id|xf86DrvMsg
c_func
(paren
l_int|0
comma
id|X_INFO
comma
l_string|&quot;(init301: VBInfo = %x, SetFlag = %x)&bslash;n&quot;
comma
id|SiS_VBInfo
comma
id|SiS_SetFlag
)paren
suffix:semicolon
macro_line|#endif
macro_line|#endif
macro_line|#if 0
multiline_comment|/* From 650/301LV BIOS: */
r_if
c_cond
(paren
id|ModeNo
op_eq
l_int|0x13
)paren
(brace
id|bp
op_plus
l_int|4
op_assign
l_int|0x03
r_else
id|bp
op_plus
l_int|4
op_assign
id|ModeNo
suffix:semicolon
)brace
macro_line|#endif
multiline_comment|/* TW: 630/301B and 650/301 (not 301LV!) BIOS do more here, but this seems for DOS mode */
)brace
r_void
DECL|function|SiS_GetRAMDAC2DATA
id|SiS_GetRAMDAC2DATA
c_func
(paren
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
comma
id|USHORT
id|RefreshRateTableIndex
comma
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
)paren
(brace
id|USHORT
id|tempax
comma
id|tempbx
comma
id|temp
suffix:semicolon
id|USHORT
id|temp1
comma
id|temp2
comma
id|modeflag
op_assign
l_int|0
comma
id|tempcx
suffix:semicolon
id|USHORT
id|StandTableIndex
comma
id|CRT1Index
suffix:semicolon
id|USHORT
id|ResInfo
comma
id|DisplayType
suffix:semicolon
id|SiS_LVDSCRT1DataStruct
op_star
id|LVDSCRT1Ptr
op_assign
l_int|NULL
suffix:semicolon
id|SiS_RVBHCMAX
op_assign
l_int|1
suffix:semicolon
id|SiS_RVBHCFACT
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|ModeNo
op_le
l_int|0x13
)paren
(brace
id|modeflag
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_ModeFlag
suffix:semicolon
id|StandTableIndex
op_assign
id|SiS_GetModePtr
c_func
(paren
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
)paren
suffix:semicolon
id|tempax
op_assign
id|SiS_StandTable
(braket
id|StandTableIndex
)braket
dot
id|CRTC
(braket
l_int|0
)braket
suffix:semicolon
id|tempbx
op_assign
id|SiS_StandTable
(braket
id|StandTableIndex
)braket
dot
id|CRTC
(braket
l_int|6
)braket
suffix:semicolon
id|temp1
op_assign
id|SiS_StandTable
(braket
id|StandTableIndex
)braket
dot
id|CRTC
(braket
l_int|7
)braket
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
op_logical_and
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCDA
)paren
)paren
(brace
id|temp
op_assign
id|SiS_GetLVDSCRT1Ptr
c_func
(paren
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|RefreshRateTableIndex
comma
op_amp
id|ResInfo
comma
op_amp
id|DisplayType
)paren
suffix:semicolon
r_if
c_cond
(paren
id|temp
op_eq
l_int|0
)paren
(brace
r_return
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|DisplayType
)paren
(brace
r_case
l_int|0
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT1800x600_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11024x768_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11280x1024_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT1800x600_1_H
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|4
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11024x768_1_H
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|5
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11280x1024_1_H
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|6
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT1800x600_2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|7
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11024x768_2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|8
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11280x1024_2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|9
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT1800x600_2_H
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|10
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11024x768_2_H
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|11
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11280x1024_2_H
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|12
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT1XXXxXXX_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|13
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT1XXXxXXX_1_H
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|14
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11400x1050_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|15
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11400x1050_1_H
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|16
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11400x1050_2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|17
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11400x1050_2_H
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|18
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_CHTVCRT1UNTSC
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|19
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_CHTVCRT1ONTSC
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|20
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_CHTVCRT1UPAL
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|21
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_CHTVCRT1OPAL
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|22
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT1320x480_1
suffix:semicolon
r_break
suffix:semicolon
)brace
id|temp1
op_assign
(paren
id|LVDSCRT1Ptr
op_plus
id|ResInfo
)paren
op_member_access_from_pointer
id|CR
(braket
l_int|0
)braket
suffix:semicolon
id|temp2
op_assign
(paren
id|LVDSCRT1Ptr
op_plus
id|ResInfo
)paren
op_member_access_from_pointer
id|CR
(braket
l_int|14
)braket
suffix:semicolon
id|tempax
op_assign
(paren
id|temp1
op_amp
l_int|0xFF
)paren
op_or
(paren
(paren
id|temp2
op_amp
l_int|0x03
)paren
op_lshift
l_int|8
)paren
suffix:semicolon
id|tempbx
op_assign
(paren
id|LVDSCRT1Ptr
op_plus
id|ResInfo
)paren
op_member_access_from_pointer
id|CR
(braket
l_int|6
)braket
suffix:semicolon
id|tempcx
op_assign
(paren
id|LVDSCRT1Ptr
op_plus
id|ResInfo
)paren
op_member_access_from_pointer
id|CR
(braket
l_int|13
)braket
op_lshift
l_int|8
suffix:semicolon
id|tempcx
op_assign
id|tempcx
op_amp
l_int|0x0100
suffix:semicolon
id|tempcx
op_assign
id|tempcx
op_lshift
l_int|2
suffix:semicolon
id|tempbx
op_assign
id|tempbx
op_or
id|tempcx
suffix:semicolon
id|temp1
op_assign
(paren
id|LVDSCRT1Ptr
op_plus
id|ResInfo
)paren
op_member_access_from_pointer
id|CR
(braket
l_int|7
)braket
suffix:semicolon
)brace
r_else
(brace
id|modeflag
op_assign
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|Ext_ModeFlag
suffix:semicolon
id|CRT1Index
op_assign
id|SiS_RefIndex
(braket
id|RefreshRateTableIndex
)braket
dot
id|Ext_CRT1CRTC
suffix:semicolon
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
id|CRT1Index
op_and_assign
l_int|0x3F
suffix:semicolon
)brace
id|temp1
op_assign
(paren
id|USHORT
)paren
id|SiS_CRT1Table
(braket
id|CRT1Index
)braket
dot
id|CR
(braket
l_int|0
)braket
suffix:semicolon
id|temp2
op_assign
(paren
id|USHORT
)paren
id|SiS_CRT1Table
(braket
id|CRT1Index
)braket
dot
id|CR
(braket
l_int|14
)braket
suffix:semicolon
id|tempax
op_assign
(paren
id|temp1
op_amp
l_int|0xFF
)paren
op_or
(paren
(paren
id|temp2
op_amp
l_int|0x03
)paren
op_lshift
l_int|8
)paren
suffix:semicolon
id|tempbx
op_assign
(paren
id|USHORT
)paren
id|SiS_CRT1Table
(braket
id|CRT1Index
)braket
dot
id|CR
(braket
l_int|6
)braket
suffix:semicolon
id|tempcx
op_assign
(paren
id|USHORT
)paren
id|SiS_CRT1Table
(braket
id|CRT1Index
)braket
dot
id|CR
(braket
l_int|13
)braket
op_lshift
l_int|8
suffix:semicolon
id|tempcx
op_assign
id|tempcx
op_amp
l_int|0x0100
suffix:semicolon
id|tempcx
op_assign
id|tempcx
op_lshift
l_int|2
suffix:semicolon
id|tempbx
op_assign
id|tempbx
op_or
id|tempcx
suffix:semicolon
id|temp1
op_assign
(paren
id|USHORT
)paren
id|SiS_CRT1Table
(braket
id|CRT1Index
)braket
dot
id|CR
(braket
l_int|7
)braket
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|temp1
op_amp
l_int|0x01
)paren
(brace
id|tempbx
op_or_assign
l_int|0x0100
suffix:semicolon
)brace
r_if
c_cond
(paren
id|temp1
op_amp
l_int|0x20
)paren
(brace
id|tempbx
op_or_assign
l_int|0x0200
suffix:semicolon
)brace
id|tempax
op_add_assign
l_int|5
suffix:semicolon
r_if
c_cond
(paren
id|modeflag
op_amp
id|Charx8Dot
)paren
(brace
id|tempax
op_mul_assign
l_int|8
suffix:semicolon
)brace
r_else
id|tempax
op_mul_assign
l_int|9
suffix:semicolon
id|SiS_VGAHT
op_assign
id|SiS_HT
op_assign
id|tempax
suffix:semicolon
id|tempbx
op_increment
suffix:semicolon
id|SiS_VGAVT
op_assign
id|SiS_VT
op_assign
id|tempbx
suffix:semicolon
)brace
r_void
DECL|function|SiS_UnLockCRT2
id|SiS_UnLockCRT2
c_func
(paren
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
comma
id|USHORT
id|BaseAddr
)paren
(brace
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
id|SiS_SetRegOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x2f
comma
l_int|0x01
)paren
suffix:semicolon
)brace
r_else
id|SiS_SetRegOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x24
comma
l_int|0x01
)paren
suffix:semicolon
)brace
r_void
DECL|function|SiS_LockCRT2
id|SiS_LockCRT2
c_func
(paren
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
comma
id|USHORT
id|BaseAddr
)paren
(brace
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
id|SiS_SetRegAND
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x2F
comma
l_int|0xFE
)paren
suffix:semicolon
)brace
r_else
id|SiS_SetRegAND
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x24
comma
l_int|0xFE
)paren
suffix:semicolon
)brace
r_void
DECL|function|SiS_EnableCRT2
id|SiS_EnableCRT2
c_func
(paren
)paren
(brace
id|SiS_SetRegOR
c_func
(paren
id|SiS_P3c4
comma
l_int|0x1E
comma
l_int|0x20
)paren
suffix:semicolon
)brace
multiline_comment|/* Checked against 650/LVDS(1.10.07)/301 and 630/301B BIOS */
r_void
DECL|function|SiS_DisableBridge
id|SiS_DisableBridge
c_func
(paren
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
comma
id|USHORT
id|BaseAddr
)paren
(brace
id|USHORT
id|tempah
comma
id|temp
suffix:semicolon
id|UCHAR
op_star
id|ROMAddr
op_assign
id|HwDeviceExtension-&gt;pjVirtualRomBase
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
(brace
multiline_comment|/* ===== TW: For 30xB/LV ===== */
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
multiline_comment|/* 300 series */
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_CR36BIOSWord23b
c_func
(paren
id|HwDeviceExtension
)paren
)paren
)paren
(brace
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_P3c4
comma
l_int|0x11
comma
l_int|0xF7
comma
l_int|0x08
)paren
suffix:semicolon
id|SiS_SetPanelDelay
c_func
(paren
id|ROMAddr
comma
id|HwDeviceExtension
comma
l_int|3
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_Is301B
c_func
(paren
id|BaseAddr
)paren
)paren
(brace
id|SiS_SetRegAND
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x1f
comma
l_int|0x3f
)paren
suffix:semicolon
id|SiS_ShortDelay
c_func
(paren
l_int|1
)paren
suffix:semicolon
)brace
id|SiS_SetRegAND
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x00
comma
l_int|0xDF
)paren
suffix:semicolon
id|SiS_DisplayOff
c_func
(paren
)paren
suffix:semicolon
id|SiS_SetRegAND
c_func
(paren
id|SiS_P3c4
comma
l_int|0x32
comma
l_int|0xDF
)paren
suffix:semicolon
id|SiS_SetRegAND
c_func
(paren
id|SiS_P3c4
comma
l_int|0x1E
comma
l_int|0xDF
)paren
suffix:semicolon
id|SiS_UnLockCRT2
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
suffix:semicolon
id|SiS_SetRegOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x01
comma
l_int|0x80
)paren
suffix:semicolon
id|SiS_SetRegOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x02
comma
l_int|0x40
)paren
suffix:semicolon
multiline_comment|/*&t;   SiS_DoSomeThingPCI();    */
multiline_comment|/* TW: Is this really required ? */
r_if
c_cond
(paren
(paren
op_logical_neg
(paren
id|SiS_CRT2IsLCD
c_func
(paren
id|BaseAddr
)paren
)paren
)paren
op_logical_or
(paren
op_logical_neg
(paren
id|SiS_CR36BIOSWord23d
c_func
(paren
id|HwDeviceExtension
)paren
)paren
)paren
)paren
(brace
id|SiS_SetPanelDelay
c_func
(paren
id|ROMAddr
comma
id|HwDeviceExtension
comma
l_int|2
)paren
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_P3c4
comma
l_int|0x11
comma
l_int|0xFB
comma
l_int|0x04
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
multiline_comment|/* 310 series */
macro_line|#if 0
r_if
c_cond
(paren
id|SiS_Is301B
c_func
(paren
id|BaseAddr
)paren
)paren
(brace
macro_line|#endif
multiline_comment|/* TW: Inserted from 650/301LV BIOS */
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_IsDualEdge
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
)paren
(brace
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x26
comma
l_int|0xFE
comma
l_int|0x00
)paren
suffix:semicolon
id|SiS_SetPanelDelay
c_func
(paren
id|ROMAddr
comma
id|HwDeviceExtension
comma
l_int|3
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_IsVAMode
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
(brace
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x26
comma
l_int|0xFE
comma
l_int|0x00
)paren
suffix:semicolon
id|SiS_SetPanelDelay
c_func
(paren
id|ROMAddr
comma
id|HwDeviceExtension
comma
l_int|3
)paren
suffix:semicolon
)brace
multiline_comment|/* TW end */
multiline_comment|/* TW: 301B dependent code starts here in 650/301LV BIOS */
r_if
c_cond
(paren
id|SiS_Is301B
c_func
(paren
id|BaseAddr
)paren
)paren
(brace
id|tempah
op_assign
l_int|0x3f
suffix:semicolon
macro_line|#if 0        /* TW: This is not done in 650/301LV BIOS, instead 0x3f is used in any case */
r_if
c_cond
(paren
id|SiS_IsDualEdge
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
(brace
id|tempah
op_assign
l_int|0x7f
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_IsVAMode
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
)paren
(brace
id|tempah
op_assign
l_int|0xbf
suffix:semicolon
)brace
)brace
macro_line|#endif
id|SiS_SetRegAND
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x1F
comma
id|tempah
)paren
suffix:semicolon
)brace
multiline_comment|/* 301B dependent code ends here in 650/301V BIOS */
macro_line|#if 0        /* TW: This is not done in 650/301LV BIOS */
r_if
c_cond
(paren
id|SiS_IsVAMode
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
(brace
id|SiS_SetRegAND
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x1E
comma
l_int|0xDF
)paren
suffix:semicolon
id|SiS_DisplayOff
c_func
(paren
)paren
suffix:semicolon
id|SiS_SetRegAND
c_func
(paren
id|SiS_P3c4
comma
l_int|0x32
comma
l_int|0xDF
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_IsDualEdge
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
)paren
(brace
id|SiS_SetRegAND
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x00
comma
l_int|0xDF
)paren
suffix:semicolon
id|SiS_DisplayOff
c_func
(paren
)paren
suffix:semicolon
)brace
)brace
)brace
r_else
(brace
macro_line|#endif
id|SiS_SetRegAND
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x00
comma
l_int|0xDF
)paren
suffix:semicolon
id|SiS_DisplayOff
c_func
(paren
)paren
suffix:semicolon
macro_line|#if 0
)brace
macro_line|#endif
id|SiS_SetRegOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x00
comma
l_int|0x80
)paren
suffix:semicolon
id|SiS_SetRegAND
c_func
(paren
id|SiS_P3c4
comma
l_int|0x32
comma
l_int|0xDF
)paren
suffix:semicolon
id|temp
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x00
)paren
suffix:semicolon
id|SiS_SetRegOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x00
comma
l_int|0x10
)paren
suffix:semicolon
id|SiS_SetRegAND
c_func
(paren
id|SiS_P3c4
comma
l_int|0x1E
comma
l_int|0xDF
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x00
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* TW: Inserted from 650/301LV BIOS */
r_if
c_cond
(paren
id|SiS_IsVAMode
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_WeHaveBacklightCtrl
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_IsDualEdge
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
)paren
(brace
id|SiS_SetPanelDelay
c_func
(paren
id|ROMAddr
comma
id|HwDeviceExtension
comma
l_int|2
)paren
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x26
comma
l_int|0xFD
comma
l_int|0x00
)paren
suffix:semicolon
id|SiS_SetPanelDelay
c_func
(paren
id|ROMAddr
comma
id|HwDeviceExtension
comma
l_int|4
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_IsVAMode
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
(brace
id|SiS_SetPanelDelay
c_func
(paren
id|ROMAddr
comma
id|HwDeviceExtension
comma
l_int|2
)paren
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x26
comma
l_int|0xFD
comma
l_int|0x00
)paren
suffix:semicolon
id|SiS_SetPanelDelay
c_func
(paren
id|ROMAddr
comma
id|HwDeviceExtension
comma
l_int|4
)paren
suffix:semicolon
)brace
)brace
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_IsDualEdge
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_CRT2IsLCD
c_func
(paren
id|BaseAddr
)paren
)paren
)paren
(brace
id|SiS_SetPanelDelay
c_func
(paren
id|ROMAddr
comma
id|HwDeviceExtension
comma
l_int|2
)paren
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x26
comma
l_int|0xFD
comma
l_int|0x00
)paren
suffix:semicolon
id|SiS_SetPanelDelay
c_func
(paren
id|ROMAddr
comma
id|HwDeviceExtension
comma
l_int|4
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_WeHaveBacklightCtrl
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_IsDualEdge
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
)paren
(brace
id|SiS_SetPanelDelay
c_func
(paren
id|ROMAddr
comma
id|HwDeviceExtension
comma
l_int|2
)paren
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x26
comma
l_int|0xFD
comma
l_int|0x00
)paren
suffix:semicolon
id|SiS_SetPanelDelay
c_func
(paren
id|ROMAddr
comma
id|HwDeviceExtension
comma
l_int|4
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_IsVAMode
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
(brace
id|SiS_SetPanelDelay
c_func
(paren
id|ROMAddr
comma
id|HwDeviceExtension
comma
l_int|2
)paren
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x26
comma
l_int|0xFD
comma
l_int|0x00
)paren
suffix:semicolon
id|SiS_SetPanelDelay
c_func
(paren
id|ROMAddr
comma
id|HwDeviceExtension
comma
l_int|4
)paren
suffix:semicolon
)brace
)brace
)brace
multiline_comment|/* TW: 650/301LV end */
)brace
)brace
r_else
(brace
multiline_comment|/* ============ TW: For 301 ================ */
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_P3c4
comma
l_int|0x11
comma
l_int|0xF7
comma
l_int|0x08
)paren
suffix:semicolon
)brace
id|SiS_SetRegAND
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x00
comma
l_int|0xDF
)paren
suffix:semicolon
multiline_comment|/* disable VB */
id|SiS_DisplayOff
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
id|SiS_SetRegOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x00
comma
l_int|0x80
)paren
suffix:semicolon
)brace
id|SiS_SetRegAND
c_func
(paren
id|SiS_P3c4
comma
l_int|0x32
comma
l_int|0xDF
)paren
suffix:semicolon
multiline_comment|/* disable lock mode */
id|temp
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x00
)paren
suffix:semicolon
id|SiS_SetRegOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x00
comma
l_int|0x10
)paren
suffix:semicolon
id|SiS_SetRegAND
c_func
(paren
id|SiS_P3c4
comma
l_int|0x1E
comma
l_int|0xDF
)paren
suffix:semicolon
multiline_comment|/* disable CRT2 */
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x00
comma
id|temp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_P3c4
comma
l_int|0x11
comma
l_int|0xFB
comma
l_int|0x04
)paren
suffix:semicolon
)brace
)brace
)brace
r_else
(brace
multiline_comment|/* ============ TW: For LVDS =============*/
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
multiline_comment|/* 300 series */
r_if
c_cond
(paren
id|SiS_IF_DEF_CH70xx
op_eq
l_int|1
)paren
(brace
r_if
c_cond
(paren
id|SiS_Backup70xx
op_eq
l_int|0xff
)paren
(brace
id|SiS_Backup70xx
op_assign
id|SiS_GetCH700x
c_func
(paren
l_int|0x0e
)paren
suffix:semicolon
)brace
id|SiS_SetCH700x
c_func
(paren
l_int|0x090E
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_GetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x11
)paren
op_amp
l_int|0x08
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_GetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x13
)paren
op_amp
l_int|0x40
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_CR36BIOSWord23b
c_func
(paren
id|HwDeviceExtension
)paren
)paren
)paren
(brace
id|SiS_WaitVBRetrace
c_func
(paren
id|HwDeviceExtension
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_GetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x06
)paren
op_amp
l_int|0x1c
)paren
)paren
(brace
id|SiS_DisplayOff
c_func
(paren
)paren
suffix:semicolon
)brace
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_P3c4
comma
l_int|0x11
comma
l_int|0xF7
comma
l_int|0x08
)paren
suffix:semicolon
id|SiS_SetPanelDelay
c_func
(paren
id|ROMAddr
comma
id|HwDeviceExtension
comma
l_int|3
)paren
suffix:semicolon
)brace
)brace
)brace
id|SiS_DisplayOff
c_func
(paren
)paren
suffix:semicolon
id|SiS_SetRegAND
c_func
(paren
id|SiS_P3c4
comma
l_int|0x32
comma
l_int|0xDF
)paren
suffix:semicolon
id|SiS_SetRegAND
c_func
(paren
id|SiS_P3c4
comma
l_int|0x1E
comma
l_int|0xDF
)paren
suffix:semicolon
id|SiS_UnLockCRT2
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
suffix:semicolon
id|SiS_SetRegOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x01
comma
l_int|0x80
)paren
suffix:semicolon
id|SiS_SetRegOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x02
comma
l_int|0x40
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
op_logical_neg
(paren
id|SiS_CRT2IsLCD
c_func
(paren
id|BaseAddr
)paren
)paren
)paren
op_logical_or
(paren
op_logical_neg
(paren
id|SiS_CR36BIOSWord23d
c_func
(paren
id|HwDeviceExtension
)paren
)paren
)paren
)paren
(brace
id|SiS_SetPanelDelay
c_func
(paren
id|ROMAddr
comma
id|HwDeviceExtension
comma
l_int|2
)paren
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_P3c4
comma
l_int|0x11
comma
l_int|0xFB
comma
l_int|0x04
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
multiline_comment|/* 310 series */
r_if
c_cond
(paren
id|SiS_IF_DEF_CH70xx
op_eq
l_int|2
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_IsDualEdge
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
)paren
(brace
id|SiS_Chrontel701xOff
c_func
(paren
)paren
suffix:semicolon
id|SiS_Chrontel701xOff2
c_func
(paren
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_IsVAMode
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
(brace
id|SiS_Chrontel701xOff
c_func
(paren
)paren
suffix:semicolon
id|SiS_Chrontel701xOff2
c_func
(paren
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_IsDualEdge
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
)paren
(brace
id|SiS_SetCH701x
c_func
(paren
l_int|0x0149
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_IsTVOrSomething
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
(brace
id|SiS_SetCH701x
c_func
(paren
l_int|0x0149
)paren
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_IsDualEdge
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
)paren
(brace
id|SiS_DisplayOff
c_func
(paren
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_IsTVOrSomething
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
)paren
(brace
id|SiS_DisplayOff
c_func
(paren
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_IsDualEdge
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
)paren
(brace
id|SiS_SetRegOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x00
comma
l_int|0x80
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_IsVAMode
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
)paren
(brace
id|SiS_SetRegOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x00
comma
l_int|0x80
)paren
suffix:semicolon
)brace
id|SiS_SetRegAND
c_func
(paren
id|SiS_P3c4
comma
l_int|0x32
comma
l_int|0xDF
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_IsDualEdge
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
)paren
(brace
id|SiS_SetRegAND
c_func
(paren
id|SiS_P3c4
comma
l_int|0x1E
comma
l_int|0xDF
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_IsVAMode
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
)paren
(brace
id|SiS_SetRegAND
c_func
(paren
id|SiS_P3c4
comma
l_int|0x1E
comma
l_int|0xDF
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_IsVAMode
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
(brace
id|SiS_SetRegAND
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x1e
comma
l_int|0xdf
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_IsDualEdge
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
(brace
id|SiS_SetRegAND
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x13
comma
l_int|0xff
)paren
suffix:semicolon
)brace
r_else
(brace
id|SiS_SetRegAND
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x13
comma
l_int|0xfb
)paren
suffix:semicolon
)brace
id|SiS_UnLockCRT2
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_IsDualEdge
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
)paren
(brace
id|SiS_SetRegAND
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x2e
comma
l_int|0xf7
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_IsVAMode
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
)paren
(brace
id|SiS_SetRegAND
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x2e
comma
l_int|0xf7
)paren
suffix:semicolon
)brace
macro_line|#if 0  /* TW: BIOS code makes no sense */
r_if
c_cond
(paren
id|SiS_IsVAMode
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_IsDualEdge
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
id|SiS_WeHaveBacklightCtrl
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
(brace
multiline_comment|/* Nothing there! */
)brace
)brace
)brace
macro_line|#endif
)brace
multiline_comment|/* 310 series */
)brace
multiline_comment|/* LVDS */
)brace
multiline_comment|/* TW: Checked against 650/LVDS(1.10.07)/301 and 630/301B BIOS */
r_void
DECL|function|SiS_EnableBridge
id|SiS_EnableBridge
c_func
(paren
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
comma
id|USHORT
id|BaseAddr
)paren
(brace
id|USHORT
id|temp
op_assign
l_int|0
comma
id|tempah
comma
id|temp1
suffix:semicolon
id|UCHAR
op_star
id|ROMAddr
op_assign
id|HwDeviceExtension-&gt;pjVirtualRomBase
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
(brace
multiline_comment|/* TW: ====== For 301B ====== */
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
multiline_comment|/* 300 series */
r_if
c_cond
(paren
id|SiS_CRT2IsLCD
c_func
(paren
id|BaseAddr
)paren
)paren
(brace
id|SiS_SetRegAND
c_func
(paren
id|SiS_P3c4
comma
l_int|0x11
comma
l_int|0xFB
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_CR36BIOSWord23d
c_func
(paren
id|HwDeviceExtension
)paren
)paren
)paren
(brace
id|SiS_SetPanelDelay
c_func
(paren
id|ROMAddr
comma
id|HwDeviceExtension
comma
l_int|0
)paren
suffix:semicolon
)brace
id|SiS_SetRegOR
c_func
(paren
id|SiS_P3c4
comma
l_int|0x1E
comma
l_int|0x20
)paren
suffix:semicolon
multiline_comment|/* Enable CRT2 */
multiline_comment|/*&t;    DoSomeThingPCI_On() */
id|SiS_DisplayOn
c_func
(paren
)paren
suffix:semicolon
id|SiS_UnLockCRT2
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
suffix:semicolon
id|SiS_SetRegAND
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x02
comma
l_int|0xBF
)paren
suffix:semicolon
r_if
c_cond
(paren
id|SiS_BridgeInSlave
c_func
(paren
)paren
)paren
(brace
id|SiS_SetRegAND
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x01
comma
l_int|0x1F
)paren
suffix:semicolon
)brace
r_else
(brace
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x01
comma
l_int|0x1F
comma
l_int|0x40
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_GetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x13
)paren
op_amp
l_int|0x40
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_GetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x16
)paren
op_amp
l_int|0x10
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_CR36BIOSWord23b
c_func
(paren
id|HwDeviceExtension
)paren
)paren
)paren
(brace
id|SiS_SetPanelDelay
c_func
(paren
id|ROMAddr
comma
id|HwDeviceExtension
comma
l_int|1
)paren
suffix:semicolon
)brace
id|SiS_WaitVBRetrace
c_func
(paren
id|HwDeviceExtension
)paren
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_P3c4
comma
l_int|0x11
comma
l_int|0xF7
comma
l_int|0x00
)paren
suffix:semicolon
)brace
)brace
)brace
r_else
(brace
id|temp
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x32
)paren
op_amp
l_int|0xDF
suffix:semicolon
multiline_comment|/* lock mode */
r_if
c_cond
(paren
id|SiS_BridgeInSlave
c_func
(paren
)paren
)paren
(brace
id|tempah
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x30
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|tempah
op_amp
id|SetCRT2ToRAMDAC
)paren
)paren
(brace
id|temp
op_or_assign
l_int|0x20
suffix:semicolon
)brace
)brace
id|SiS_SetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x32
comma
id|temp
)paren
suffix:semicolon
id|SiS_SetRegOR
c_func
(paren
id|SiS_P3c4
comma
l_int|0x1E
comma
l_int|0x20
)paren
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x00
comma
l_int|0x1F
comma
l_int|0x20
)paren
suffix:semicolon
multiline_comment|/* enable VB processor */
r_if
c_cond
(paren
id|SiS_Is301B
c_func
(paren
id|BaseAddr
)paren
)paren
(brace
id|SiS_SetRegOR
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x1F
comma
l_int|0xC0
)paren
suffix:semicolon
id|SiS_DisplayOn
c_func
(paren
)paren
suffix:semicolon
)brace
r_else
(brace
id|SiS_VBLongWait
c_func
(paren
)paren
suffix:semicolon
id|SiS_DisplayOn
c_func
(paren
)paren
suffix:semicolon
id|SiS_VBLongWait
c_func
(paren
)paren
suffix:semicolon
)brace
)brace
)brace
r_else
(brace
multiline_comment|/* 310 series */
multiline_comment|/* TW: Inserted from 650/301LV BIOS */
r_if
c_cond
(paren
id|SiS_IsVAMode
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
(brace
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x26
comma
l_int|0xfd
comma
l_int|0x02
)paren
suffix:semicolon
id|SiS_SetPanelDelay
c_func
(paren
id|ROMAddr
comma
id|HwDeviceExtension
comma
l_int|0
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_CRT2IsLCD
c_func
(paren
id|BaseAddr
)paren
)paren
(brace
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x26
comma
l_int|0xfd
comma
l_int|0x02
)paren
suffix:semicolon
id|SiS_SetPanelDelay
c_func
(paren
id|ROMAddr
comma
id|HwDeviceExtension
comma
l_int|0
)paren
suffix:semicolon
)brace
multiline_comment|/* TW: --- end --- */
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_IsVAMode
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
)paren
(brace
id|temp
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x32
)paren
op_amp
l_int|0xDF
suffix:semicolon
r_if
c_cond
(paren
id|SiS_BridgeInSlave
c_func
(paren
)paren
)paren
(brace
id|tempah
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x30
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|tempah
op_amp
id|SetCRT2ToRAMDAC
)paren
)paren
(brace
id|temp
op_or_assign
l_int|0x20
suffix:semicolon
)brace
)brace
id|SiS_SetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x32
comma
id|temp
)paren
suffix:semicolon
id|SiS_SetRegOR
c_func
(paren
id|SiS_P3c4
comma
l_int|0x1E
comma
l_int|0x20
)paren
suffix:semicolon
multiline_comment|/* enable CRT2 */
multiline_comment|/*          SiS_SetRegAND(SiS_Part1Port,0x2E,0x7F);   */
multiline_comment|/* TW: Not done in 650/301LV BIOS */
id|temp
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x2E
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|temp
op_amp
l_int|0x80
)paren
)paren
id|SiS_SetRegOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x2E
comma
l_int|0x80
)paren
suffix:semicolon
)brace
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x00
comma
l_int|0x1F
comma
l_int|0x20
)paren
suffix:semicolon
multiline_comment|/* enable VB processor */
r_if
c_cond
(paren
id|SiS_Is301B
c_func
(paren
id|BaseAddr
)paren
)paren
(brace
macro_line|#if 0&t;     /* TW: This is not done in 630/301LV BIOS */
r_if
c_cond
(paren
id|SiS_IsVAMode
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
(brace
id|SiS_SetRegOR
c_func
(paren
id|SiS_P3c4
comma
l_int|0x1E
comma
l_int|0x20
)paren
suffix:semicolon
multiline_comment|/* enable CRT2 */
)brace
macro_line|#endif
multiline_comment|/* TW: This is done instead: */
id|SiS_SetRegOR
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x1F
comma
l_int|0xc0
)paren
suffix:semicolon
macro_line|#if 0&t;     /* TW: This is not done in 630/301LV BIOS */
id|temp
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x2E
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|temp
op_amp
l_int|0x80
)paren
)paren
id|SiS_SetRegOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x2E
comma
l_int|0x80
)paren
suffix:semicolon
id|tempah
op_assign
l_int|0xC0
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IsDualEdge
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
(brace
id|tempah
op_assign
l_int|0x80
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_IsVAMode
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
)paren
(brace
id|tempah
op_assign
l_int|0x40
suffix:semicolon
)brace
)brace
id|SiS_SetRegOR
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x1F
comma
id|tempah
)paren
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_WeHaveBacklightCtrl
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
)paren
(brace
multiline_comment|/* TW: &quot;if&quot; new from 650/301LV BIOS */
id|SiS_SetRegAND
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x00
comma
l_int|0x7F
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
id|SiS_VBLongWait
c_func
(paren
)paren
suffix:semicolon
id|SiS_DisplayOn
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_WeHaveBacklightCtrl
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
)paren
(brace
multiline_comment|/* TW: &quot;if&quot; new from 650/301LV BIOS */
id|SiS_SetRegAND
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x00
comma
l_int|0x7F
)paren
suffix:semicolon
id|SiS_VBLongWait
c_func
(paren
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/* TW: Entire section from 650/301LV BIOS */
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_WeHaveBacklightCtrl
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
id|SiS_IsVAMode
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
(brace
multiline_comment|/*&t;        if (!(SiS_WeHaveBacklightCtrl(HwDeviceExtension, BaseAddr))) {  */
multiline_comment|/* TW: BIOS code makes no sense */
id|SiS_SetPanelDelay
c_func
(paren
id|ROMAddr
comma
id|HwDeviceExtension
comma
l_int|1
)paren
suffix:semicolon
id|SiS_WaitVBRetrace
c_func
(paren
id|HwDeviceExtension
)paren
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x26
comma
l_int|0xFE
comma
l_int|0x01
)paren
suffix:semicolon
multiline_comment|/*              }   */
)brace
r_else
r_if
c_cond
(paren
id|SiS_CRT2IsLCD
c_func
(paren
id|BaseAddr
)paren
)paren
(brace
multiline_comment|/*&t;        if (!(SiS_WeHaveBacklightCtrl(HwDeviceExtension, BaseAddr))) {  */
multiline_comment|/* TW: BIOS code makes no sense */
id|SiS_SetPanelDelay
c_func
(paren
id|ROMAddr
comma
id|HwDeviceExtension
comma
l_int|1
)paren
suffix:semicolon
id|SiS_WaitVBRetrace
c_func
(paren
id|HwDeviceExtension
)paren
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x26
comma
l_int|0xFE
comma
l_int|0x01
)paren
suffix:semicolon
multiline_comment|/*              }   */
)brace
)brace
multiline_comment|/* TW: --- end --- */
)brace
)brace
r_else
(brace
multiline_comment|/* ============  TW: For 301 ================ */
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_P3c4
comma
l_int|0x11
comma
l_int|0xFB
comma
l_int|0x00
)paren
suffix:semicolon
)brace
id|temp
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x32
)paren
op_amp
l_int|0xDF
suffix:semicolon
multiline_comment|/* lock mode */
r_if
c_cond
(paren
id|SiS_BridgeInSlave
c_func
(paren
)paren
)paren
(brace
id|tempah
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x30
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|tempah
op_amp
id|SetCRT2ToRAMDAC
)paren
)paren
(brace
id|temp
op_or_assign
l_int|0x20
suffix:semicolon
)brace
)brace
id|SiS_SetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x32
comma
id|temp
)paren
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_P3c4
comma
l_int|0x1E
comma
l_int|0xFF
comma
l_int|0x20
)paren
suffix:semicolon
multiline_comment|/* enable CRT2 */
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
multiline_comment|/* 310 series */
id|temp
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x2E
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|temp
op_amp
l_int|0x80
)paren
)paren
id|SiS_SetRegOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x2E
comma
l_int|0x80
)paren
suffix:semicolon
multiline_comment|/* by alan,BVBDOENABLE=1 */
)brace
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x00
comma
l_int|0x1F
comma
l_int|0x20
)paren
suffix:semicolon
multiline_comment|/* enable VB processor */
id|SiS_VBLongWait
c_func
(paren
)paren
suffix:semicolon
id|SiS_DisplayOn
c_func
(paren
)paren
suffix:semicolon
id|SiS_VBLongWait
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_P3c4
comma
l_int|0x11
comma
l_int|0xF7
comma
l_int|0x00
)paren
suffix:semicolon
)brace
)brace
)brace
r_else
(brace
multiline_comment|/* =================== TW: For LVDS ================== */
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
multiline_comment|/* 300 series */
r_if
c_cond
(paren
id|SiS_CRT2IsLCD
c_func
(paren
id|BaseAddr
)paren
)paren
(brace
id|SiS_SetRegAND
c_func
(paren
id|SiS_P3c4
comma
l_int|0x11
comma
l_int|0xFB
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_CR36BIOSWord23d
c_func
(paren
id|HwDeviceExtension
)paren
)paren
)paren
(brace
id|SiS_SetPanelDelay
c_func
(paren
id|ROMAddr
comma
id|HwDeviceExtension
comma
l_int|0
)paren
suffix:semicolon
)brace
)brace
id|SiS_EnableCRT2
c_func
(paren
)paren
suffix:semicolon
id|SiS_DisplayOn
c_func
(paren
)paren
suffix:semicolon
id|SiS_UnLockCRT2
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
suffix:semicolon
id|SiS_SetRegAND
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x02
comma
l_int|0xBF
)paren
suffix:semicolon
r_if
c_cond
(paren
id|SiS_BridgeInSlave
c_func
(paren
)paren
)paren
(brace
id|SiS_SetRegAND
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x01
comma
l_int|0x1F
)paren
suffix:semicolon
)brace
r_else
(brace
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x01
comma
l_int|0x1F
comma
l_int|0x40
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_IF_DEF_CH70xx
op_eq
l_int|1
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_CRT2IsLCD
c_func
(paren
id|BaseAddr
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
id|SiS_Backup70xx
op_ne
l_int|0xff
)paren
(brace
id|SiS_SetCH700x
c_func
(paren
(paren
(paren
id|SiS_Backup70xx
op_lshift
l_int|8
)paren
op_or
l_int|0x0E
)paren
)paren
suffix:semicolon
id|SiS_Backup70xx
op_assign
l_int|0xff
suffix:semicolon
)brace
r_else
id|SiS_SetCH700x
c_func
(paren
l_int|0x0B0E
)paren
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|SiS_CRT2IsLCD
c_func
(paren
id|BaseAddr
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_GetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x13
)paren
op_amp
l_int|0x40
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_GetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x16
)paren
op_amp
l_int|0x10
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_CR36BIOSWord23b
c_func
(paren
id|HwDeviceExtension
)paren
)paren
)paren
(brace
id|SiS_SetPanelDelay
c_func
(paren
id|ROMAddr
comma
id|HwDeviceExtension
comma
l_int|1
)paren
suffix:semicolon
id|SiS_SetPanelDelay
c_func
(paren
id|ROMAddr
comma
id|HwDeviceExtension
comma
l_int|1
)paren
suffix:semicolon
)brace
id|SiS_WaitVBRetrace
c_func
(paren
id|HwDeviceExtension
)paren
suffix:semicolon
id|SiS_SetRegAND
c_func
(paren
id|SiS_P3c4
comma
l_int|0x11
comma
l_int|0xF7
)paren
suffix:semicolon
)brace
)brace
)brace
)brace
r_else
(brace
multiline_comment|/* 310 series */
macro_line|#if 0  /* BIOS code makes no sense */
r_if
c_cond
(paren
id|SiS_IsVAMode
c_func
(paren
)paren
)paren
(brace
r_if
c_cond
(paren
id|SiS_IsLCDOrLCDA
c_func
(paren
)paren
)paren
(brace
)brace
)brace
macro_line|#endif
id|SiS_EnableCRT2
c_func
(paren
)paren
suffix:semicolon
id|SiS_UnLockCRT2
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
suffix:semicolon
id|SiS_SetRegAND
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x2e
comma
l_int|0xf7
)paren
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_CH70xx
op_eq
l_int|2
)paren
(brace
id|temp
op_assign
id|SiS_GetCH701x
c_func
(paren
l_int|0x66
)paren
suffix:semicolon
id|temp
op_and_assign
l_int|0x20
suffix:semicolon
id|SiS_Chrontel701xOff
c_func
(paren
)paren
suffix:semicolon
)brace
id|SiS_SetRegAND
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x2e
comma
l_int|0x7f
)paren
suffix:semicolon
id|temp1
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x2E
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|temp1
op_amp
l_int|0x80
)paren
)paren
id|SiS_SetRegOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x2E
comma
l_int|0x80
)paren
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_CH70xx
op_eq
l_int|2
)paren
(brace
r_if
c_cond
(paren
id|temp
)paren
(brace
id|SiS_Chrontel701xOn
c_func
(paren
)paren
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|SiS_IsVAMode
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
(brace
id|SiS_SetRegOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x1E
comma
l_int|0x20
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_WeHaveBacklightCtrl
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
)paren
(brace
id|SiS_SetRegAND
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x00
comma
l_int|0x7f
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_IF_DEF_CH70xx
op_eq
l_int|2
)paren
(brace
r_if
c_cond
(paren
id|SiS_IsTVOrSomething
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
(brace
id|SiS_Chrontel701xOn2
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_IsVAMode
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
(brace
id|SiS_ChrontelDoSomething1
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_IsLCDOrLCDA
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
(brace
id|SiS_ChrontelDoSomething1
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|SiS_IF_DEF_CH70xx
op_eq
l_int|2
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_WeHaveBacklightCtrl
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
id|SiS_IsVAMode
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
(brace
id|SiS_Chrontel701xOn
c_func
(paren
)paren
suffix:semicolon
id|SiS_ChrontelDoSomething4
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_IsLCDOrLCDA
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
(brace
multiline_comment|/*&t;      &t;&t;&t;if(!SiS_WeHaveBacklightCtrl(HwDeviceExtension, BaseAddr)) {  */
multiline_comment|/* TW: makes no sense */
id|SiS_Chrontel701xOn
c_func
(paren
)paren
suffix:semicolon
id|SiS_ChrontelDoSomething4
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
suffix:semicolon
multiline_comment|/*            &t;&t;&t;}   */
)brace
)brace
)brace
)brace
multiline_comment|/* 310 series */
)brace
multiline_comment|/* LVDS */
)brace
id|BOOLEAN
DECL|function|SiS_CR36BIOSWord23b
id|SiS_CR36BIOSWord23b
c_func
(paren
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
)paren
(brace
id|USHORT
id|temp
comma
id|temp1
suffix:semicolon
id|UCHAR
op_star
id|ROMAddr
suffix:semicolon
r_if
c_cond
(paren
(paren
id|ROMAddr
op_assign
(paren
id|UCHAR
op_star
)paren
id|HwDeviceExtension-&gt;pjVirtualRomBase
)paren
)paren
(brace
id|temp
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x36
)paren
op_amp
l_int|0xff
suffix:semicolon
id|temp
op_rshift_assign
l_int|4
suffix:semicolon
id|temp
op_assign
l_int|1
op_lshift
id|temp
suffix:semicolon
id|temp1
op_assign
(paren
id|ROMAddr
(braket
l_int|0x23c
)braket
op_lshift
l_int|8
)paren
op_or
id|ROMAddr
(braket
l_int|0x23b
)braket
suffix:semicolon
r_if
c_cond
(paren
id|temp1
op_amp
id|temp
)paren
(brace
r_return
l_int|1
suffix:semicolon
)brace
r_else
r_return
l_int|0
suffix:semicolon
)brace
r_else
(brace
r_return
l_int|0
suffix:semicolon
)brace
)brace
id|BOOLEAN
DECL|function|SiS_CR36BIOSWord23d
id|SiS_CR36BIOSWord23d
c_func
(paren
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
)paren
(brace
id|USHORT
id|temp
comma
id|temp1
suffix:semicolon
id|UCHAR
op_star
id|ROMAddr
suffix:semicolon
r_if
c_cond
(paren
(paren
id|ROMAddr
op_assign
(paren
id|UCHAR
op_star
)paren
id|HwDeviceExtension-&gt;pjVirtualRomBase
)paren
)paren
(brace
id|temp
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x36
)paren
op_amp
l_int|0xff
suffix:semicolon
id|temp
op_rshift_assign
l_int|4
suffix:semicolon
id|temp
op_assign
l_int|1
op_lshift
id|temp
suffix:semicolon
id|temp1
op_assign
(paren
id|ROMAddr
(braket
l_int|0x23e
)braket
op_lshift
l_int|8
)paren
op_or
id|ROMAddr
(braket
l_int|0x23d
)braket
suffix:semicolon
r_if
c_cond
(paren
id|temp1
op_amp
id|temp
)paren
(brace
r_return
l_int|1
suffix:semicolon
)brace
r_else
r_return
l_int|0
suffix:semicolon
)brace
r_else
(brace
r_return
l_int|0
suffix:semicolon
)brace
)brace
r_void
DECL|function|SiS_SetPanelDelay
id|SiS_SetPanelDelay
c_func
(paren
id|UCHAR
op_star
id|ROMAddr
comma
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
comma
id|USHORT
id|DelayTime
)paren
(brace
id|USHORT
id|PanelID
comma
id|DelayIndex
comma
id|Delay
comma
id|temp
suffix:semicolon
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
(brace
r_if
c_cond
(paren
id|ROMAddr
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|ROMAddr
(braket
l_int|0x235
)braket
op_amp
l_int|0x40
)paren
)paren
(brace
r_return
suffix:semicolon
)brace
)brace
)brace
)brace
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
id|temp
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x18
)paren
suffix:semicolon
)brace
r_else
(brace
id|temp
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x1b
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
op_logical_and
(paren
op_logical_neg
(paren
id|temp
op_amp
l_int|0x10
)paren
)paren
)paren
(brace
id|PanelID
op_assign
l_int|0x12
suffix:semicolon
)brace
r_else
(brace
id|PanelID
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x36
)paren
suffix:semicolon
)brace
id|DelayIndex
op_assign
id|PanelID
op_rshift
l_int|4
suffix:semicolon
r_if
c_cond
(paren
(paren
id|DelayTime
op_ge
l_int|2
)paren
op_logical_and
(paren
id|PanelID
op_amp
l_int|0x0f
)paren
op_eq
l_int|1
)paren
(brace
id|Delay
op_assign
l_int|3
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|DelayTime
op_ge
l_int|2
)paren
(brace
id|DelayTime
op_sub_assign
l_int|2
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|DelayTime
op_amp
l_int|0x01
)paren
)paren
(brace
id|Delay
op_assign
id|SiS_PanelDelayTbl
(braket
id|DelayIndex
)braket
dot
id|timer
(braket
l_int|0
)braket
suffix:semicolon
)brace
r_else
(brace
id|Delay
op_assign
id|SiS_PanelDelayTbl
(braket
id|DelayIndex
)braket
dot
id|timer
(braket
l_int|1
)braket
suffix:semicolon
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
r_if
c_cond
(paren
id|DelayTime
op_amp
l_int|0x04
)paren
(brace
id|Delay
op_assign
l_int|0x190
suffix:semicolon
)brace
)brace
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|DelayTime
op_amp
l_int|0x01
)paren
)paren
(brace
id|Delay
op_assign
id|SiS_PanelDelayTblLVDS
(braket
id|DelayIndex
)braket
dot
id|timer
(braket
l_int|0
)braket
suffix:semicolon
)brace
r_else
(brace
id|Delay
op_assign
id|SiS_PanelDelayTblLVDS
(braket
id|DelayIndex
)braket
dot
id|timer
(braket
l_int|1
)braket
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|ROMAddr
)paren
(brace
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
r_if
c_cond
(paren
id|ROMAddr
(braket
l_int|0x220
)braket
op_amp
l_int|0x40
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|DelayTime
op_amp
l_int|0x01
)paren
)paren
(brace
id|Delay
op_assign
(paren
id|USHORT
)paren
id|ROMAddr
(braket
l_int|0x225
)braket
suffix:semicolon
)brace
r_else
(brace
id|Delay
op_assign
(paren
id|USHORT
)paren
id|ROMAddr
(braket
l_int|0x226
)braket
suffix:semicolon
)brace
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|ROMAddr
(braket
l_int|0x13c
)braket
op_amp
l_int|0x40
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|DelayTime
op_amp
l_int|0x01
)paren
)paren
(brace
id|Delay
op_assign
(paren
id|USHORT
)paren
id|ROMAddr
(braket
l_int|0x141
)braket
suffix:semicolon
)brace
r_else
(brace
id|Delay
op_assign
(paren
id|USHORT
)paren
id|ROMAddr
(braket
l_int|0x142
)braket
suffix:semicolon
r_if
c_cond
(paren
id|DelayTime
op_amp
l_int|0x04
)paren
(brace
id|Delay
op_assign
l_int|0x190
suffix:semicolon
)brace
)brace
)brace
)brace
)brace
)brace
id|SiS_ShortDelay
c_func
(paren
id|Delay
)paren
suffix:semicolon
)brace
r_void
DECL|function|SiS_LongDelay
id|SiS_LongDelay
c_func
(paren
id|USHORT
id|delay
)paren
(brace
r_while
c_loop
(paren
id|delay
op_decrement
)paren
(brace
id|SiS_GenericDelay
c_func
(paren
l_int|0x19df
)paren
suffix:semicolon
multiline_comment|/* 6623 */
)brace
)brace
r_void
DECL|function|SiS_ShortDelay
id|SiS_ShortDelay
c_func
(paren
id|USHORT
id|delay
)paren
(brace
r_while
c_loop
(paren
id|delay
op_decrement
)paren
(brace
id|SiS_GenericDelay
c_func
(paren
l_int|0x42
)paren
suffix:semicolon
multiline_comment|/* 66 */
)brace
)brace
r_void
DECL|function|SiS_GenericDelay
id|SiS_GenericDelay
c_func
(paren
id|USHORT
id|delay
)paren
(brace
id|USHORT
id|temp
comma
id|flag
suffix:semicolon
id|flag
op_assign
id|SiS_GetReg3
c_func
(paren
l_int|0x61
)paren
op_amp
l_int|0x10
suffix:semicolon
r_while
c_loop
(paren
id|delay
)paren
(brace
id|temp
op_assign
id|SiS_GetReg3
c_func
(paren
l_int|0x61
)paren
op_amp
l_int|0x10
suffix:semicolon
r_if
c_cond
(paren
id|temp
op_eq
id|flag
)paren
(brace
r_continue
suffix:semicolon
)brace
id|flag
op_assign
id|temp
suffix:semicolon
id|delay
op_decrement
suffix:semicolon
)brace
)brace
id|BOOLEAN
DECL|function|SiS_Is301B
id|SiS_Is301B
c_func
(paren
id|USHORT
id|BaseAddr
)paren
(brace
id|USHORT
id|flag
suffix:semicolon
id|flag
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x01
)paren
suffix:semicolon
r_if
c_cond
(paren
id|flag
op_ge
l_int|0x0B0
)paren
(brace
r_return
l_int|1
suffix:semicolon
)brace
r_else
r_return
l_int|0
suffix:semicolon
)brace
id|BOOLEAN
DECL|function|SiS_CRT2IsLCD
id|SiS_CRT2IsLCD
c_func
(paren
id|USHORT
id|BaseAddr
)paren
(brace
id|USHORT
id|flag
suffix:semicolon
id|flag
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x30
)paren
suffix:semicolon
r_if
c_cond
(paren
id|flag
op_amp
l_int|0x20
)paren
(brace
r_return
l_int|1
suffix:semicolon
)brace
r_else
r_return
l_int|0
suffix:semicolon
)brace
id|BOOLEAN
DECL|function|SiS_IsDualEdge
id|SiS_IsDualEdge
c_func
(paren
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
comma
id|USHORT
id|BaseAddr
)paren
(brace
macro_line|#ifdef SIS315H
id|USHORT
id|flag
suffix:semicolon
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
id|flag
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x38
)paren
suffix:semicolon
r_if
c_cond
(paren
id|flag
op_amp
id|EnableDualEdge
)paren
(brace
r_return
l_int|1
suffix:semicolon
)brace
multiline_comment|/* TW: Inverted result */
r_else
r_return
l_int|0
suffix:semicolon
)brace
r_else
macro_line|#endif
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* TW: Inverted result! */
id|BOOLEAN
DECL|function|SiS_IsVAMode
id|SiS_IsVAMode
c_func
(paren
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
comma
id|USHORT
id|BaseAddr
)paren
(brace
macro_line|#ifdef SIS315H
id|USHORT
id|flag
suffix:semicolon
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
id|flag
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x38
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|flag
op_amp
id|EnableDualEdge
)paren
op_logical_and
(paren
id|flag
op_amp
id|SetToLCDA
)paren
)paren
(brace
r_return
l_int|1
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
(brace
multiline_comment|/* TW: Inserted from 650/301LV BIOS */
r_if
c_cond
(paren
id|flag
)paren
(brace
r_return
l_int|1
suffix:semicolon
)brace
multiline_comment|/* TW: Inserted from 650/301LV BIOS */
r_else
r_return
l_int|0
suffix:semicolon
multiline_comment|/* TW: Inserted from 650/301LV BIOS */
)brace
r_else
r_return
l_int|0
suffix:semicolon
)brace
r_else
macro_line|#endif
r_return
l_int|0
suffix:semicolon
)brace
id|BOOLEAN
DECL|function|SiS_WeHaveBacklightCtrl
id|SiS_WeHaveBacklightCtrl
c_func
(paren
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
comma
id|USHORT
id|BaseAddr
)paren
(brace
macro_line|#ifdef SIS315H
id|USHORT
id|flag
suffix:semicolon
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
id|flag
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x79
)paren
suffix:semicolon
r_if
c_cond
(paren
id|flag
op_amp
l_int|0x10
)paren
(brace
r_return
l_int|1
suffix:semicolon
)brace
r_else
r_return
l_int|0
suffix:semicolon
)brace
r_else
macro_line|#endif
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#if 0
id|BOOLEAN
id|SiS_Is315E
c_func
(paren
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
comma
id|USHORT
id|BaseAddr
)paren
(brace
macro_line|#ifdef SIS315H
id|USHORT
id|flag
suffix:semicolon
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
id|flag
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x5f
)paren
suffix:semicolon
r_if
c_cond
(paren
id|flag
op_amp
l_int|0x10
)paren
(brace
r_return
l_int|1
suffix:semicolon
)brace
r_else
r_return
l_int|0
suffix:semicolon
)brace
r_else
macro_line|#endif
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#endif
id|BOOLEAN
DECL|function|SiS_IsYPbPr
id|SiS_IsYPbPr
c_func
(paren
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
comma
id|USHORT
id|BaseAddr
)paren
(brace
macro_line|#ifdef SIS315H
id|USHORT
id|flag
suffix:semicolon
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
id|flag
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x38
)paren
suffix:semicolon
r_if
c_cond
(paren
id|flag
op_amp
l_int|0x08
)paren
(brace
r_return
l_int|1
suffix:semicolon
)brace
r_else
r_return
l_int|0
suffix:semicolon
)brace
r_else
macro_line|#endif
r_return
l_int|0
suffix:semicolon
)brace
id|BOOLEAN
DECL|function|SiS_IsTVOrSomething
id|SiS_IsTVOrSomething
c_func
(paren
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
comma
id|USHORT
id|BaseAddr
)paren
(brace
id|USHORT
id|flag
suffix:semicolon
macro_line|#ifdef SIS315H
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
id|flag
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x30
)paren
suffix:semicolon
r_if
c_cond
(paren
id|flag
op_amp
id|SetCRT2ToTV
)paren
(brace
r_return
l_int|1
suffix:semicolon
)brace
id|flag
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x38
)paren
suffix:semicolon
r_if
c_cond
(paren
id|flag
op_amp
l_int|0x08
)paren
(brace
r_return
l_int|1
suffix:semicolon
)brace
r_else
r_return
l_int|0
suffix:semicolon
)brace
r_else
macro_line|#endif
(brace
id|flag
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x30
)paren
suffix:semicolon
r_if
c_cond
(paren
id|flag
op_amp
id|SetCRT2ToTV
)paren
(brace
r_return
l_int|1
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
id|BOOLEAN
DECL|function|SiS_IsLCDOrLCDA
id|SiS_IsLCDOrLCDA
c_func
(paren
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
comma
id|USHORT
id|BaseAddr
)paren
(brace
id|USHORT
id|flag
suffix:semicolon
macro_line|#ifdef SIS315H
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
id|flag
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x30
)paren
suffix:semicolon
r_if
c_cond
(paren
id|flag
op_amp
id|SetCRT2ToLCD
)paren
(brace
r_return
l_int|1
suffix:semicolon
)brace
id|flag
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x38
)paren
suffix:semicolon
r_if
c_cond
(paren
id|flag
op_amp
id|SetToLCDA
)paren
(brace
r_return
l_int|1
suffix:semicolon
)brace
r_else
r_return
l_int|0
suffix:semicolon
)brace
r_else
macro_line|#endif
(brace
id|flag
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x30
)paren
suffix:semicolon
r_if
c_cond
(paren
id|flag
op_amp
id|SetCRT2ToLCD
)paren
(brace
r_return
l_int|1
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
id|BOOLEAN
DECL|function|SiS_IsDisableCRT2
id|SiS_IsDisableCRT2
c_func
(paren
id|USHORT
id|BaseAddr
)paren
(brace
id|USHORT
id|flag
suffix:semicolon
id|flag
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x30
)paren
suffix:semicolon
r_if
c_cond
(paren
id|flag
op_amp
l_int|0x20
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
r_else
r_return
l_int|1
suffix:semicolon
)brace
id|BOOLEAN
DECL|function|SiS_BridgeIsOn
id|SiS_BridgeIsOn
c_func
(paren
id|USHORT
id|BaseAddr
comma
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
)paren
(brace
id|USHORT
id|flag
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|1
)paren
(brace
r_return
l_int|0
suffix:semicolon
multiline_comment|/* TW: Changed from 1 to 0! */
)brace
r_else
(brace
macro_line|#if 0   /* TW: Commented for test on bridge-less systems */
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
multiline_comment|/* TW: New (from 630/301B BIOS - not done there) */
macro_line|#endif
id|flag
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x00
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|flag
op_eq
l_int|1
)paren
op_logical_or
(paren
id|flag
op_eq
l_int|2
)paren
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* TW: Changed from 1 to 0! */
r_else
r_return
l_int|1
suffix:semicolon
multiline_comment|/* TW: Changed from 0 to 1! */
macro_line|#if 0
)brace
r_else
r_return
l_int|0
suffix:semicolon
multiline_comment|/* TW: New (from 630/301B BIOS - always return 0) */
macro_line|#endif
)brace
)brace
id|BOOLEAN
DECL|function|SiS_BridgeIsEnable
id|SiS_BridgeIsEnable
c_func
(paren
id|USHORT
id|BaseAddr
comma
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
)paren
(brace
id|USHORT
id|flag
suffix:semicolon
r_if
c_cond
(paren
id|SiS_BridgeIsOn
c_func
(paren
id|BaseAddr
comma
id|HwDeviceExtension
)paren
op_eq
l_int|0
)paren
(brace
id|flag
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x00
)paren
suffix:semicolon
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
multiline_comment|/* 300 series */
r_if
c_cond
(paren
id|flag
op_amp
l_int|0x0a0
)paren
(brace
r_return
l_int|1
suffix:semicolon
)brace
r_else
r_return
l_int|0
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* 310 series */
r_if
c_cond
(paren
id|flag
op_amp
l_int|0x050
)paren
(brace
r_return
l_int|1
suffix:semicolon
)brace
r_else
r_return
l_int|0
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
id|BOOLEAN
DECL|function|SiS_BridgeInSlave
id|SiS_BridgeInSlave
c_func
(paren
)paren
(brace
id|USHORT
id|flag1
suffix:semicolon
id|flag1
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x31
)paren
suffix:semicolon
r_if
c_cond
(paren
id|flag1
op_amp
(paren
id|SetInSlaveMode
op_rshift
l_int|8
)paren
)paren
(brace
r_return
l_int|1
suffix:semicolon
)brace
r_else
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* TW: New from 650/301LV BIOS */
r_void
DECL|function|SiS_SetHiVision
id|SiS_SetHiVision
c_func
(paren
id|USHORT
id|BaseAddr
comma
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
)paren
(brace
id|SiS_HiVision
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToHiVisionTV
)paren
(brace
id|SiS_HiVision
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x38
)paren
suffix:semicolon
id|SiS_HiVision
op_and_assign
l_int|0x38
suffix:semicolon
id|SiS_HiVision
op_rshift_assign
l_int|3
suffix:semicolon
)brace
)brace
)brace
)brace
multiline_comment|/* TW: Checked against 650/LVDS and 650/301LV BIOS */
id|BOOLEAN
DECL|function|SiS_GetLCDResInfo301
id|SiS_GetLCDResInfo301
c_func
(paren
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|SiS_P3d4
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
comma
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
)paren
(brace
id|USHORT
id|temp
comma
id|modeflag
comma
id|resinfo
op_assign
l_int|0
suffix:semicolon
id|SiS_LCDResInfo
op_assign
l_int|0
suffix:semicolon
id|SiS_LCDTypeInfo
op_assign
l_int|0
suffix:semicolon
id|SiS_LCDInfo
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|ModeNo
op_le
l_int|0x13
)paren
(brace
id|modeflag
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_ModeFlag
suffix:semicolon
)brace
r_else
(brace
id|modeflag
op_assign
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|Ext_ModeFlag
suffix:semicolon
id|resinfo
op_assign
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|Ext_RESINFO
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
(paren
id|SetCRT2ToLCD
op_or
id|SetCRT2ToLCDA
)paren
)paren
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
(paren
id|SetSimuScanMode
op_or
id|SwitchToCRT2
)paren
)paren
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
id|temp
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x36
)paren
suffix:semicolon
multiline_comment|/*fstn*: Fake CR36 (TypeInfo 2, ResInfo Panel320x480) */
r_if
c_cond
(paren
id|SiS_IF_DEF_FSTN
)paren
(brace
id|temp
op_assign
l_int|0x20
op_or
id|Panel320x480
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x36
comma
id|temp
)paren
suffix:semicolon
)brace
id|SiS_LCDTypeInfo
op_assign
id|temp
op_rshift
l_int|4
suffix:semicolon
multiline_comment|/* BIOS uses entire CR36 - 1 */
id|SiS_LCDResInfo
op_assign
id|temp
op_amp
l_int|0x0F
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_FSTN
)paren
(brace
id|SiS_LCDResInfo
op_assign
id|Panel320x480
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
OL
id|PanelMin301
)paren
(brace
id|SiS_LCDResInfo
op_assign
id|PanelMin301
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
OL
id|PanelMinLVDS
)paren
(brace
id|SiS_LCDResInfo
op_assign
id|PanelMinLVDS
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
OG
id|PanelMax
)paren
(brace
id|SiS_LCDResInfo
op_assign
id|Panel1024x768
suffix:semicolon
)brace
id|temp
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x37
)paren
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_FSTN
)paren
(brace
multiline_comment|/* TW: Fake LVDS bridge for FSTN */
id|temp
op_assign
l_int|0x04
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x37
comma
id|temp
)paren
suffix:semicolon
)brace
id|SiS_LCDInfo
op_assign
id|temp
suffix:semicolon
multiline_comment|/* TW: Inserted entire 315-block from 650/LVDS BIOS */
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|1
)paren
(brace
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
id|temp
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x39
)paren
suffix:semicolon
r_if
c_cond
(paren
id|temp
op_amp
l_int|0x01
)paren
(brace
id|SiS_LCDInfo
op_and_assign
l_int|0xFFEF
suffix:semicolon
multiline_comment|/* TW: What is this? */
id|SiS_LCDInfo
op_or_assign
l_int|0x0100
suffix:semicolon
multiline_comment|/* TW: What is this? */
)brace
)brace
)brace
macro_line|#ifdef LINUX_KERNEL
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;sisfb: (LCDInfo = 0x%x LCDResInfo = 0x%x LCDTypeInfo = 0x%x)&bslash;n&quot;
comma
id|SiS_LCDInfo
comma
id|SiS_LCDResInfo
comma
id|SiS_LCDTypeInfo
)paren
suffix:semicolon
macro_line|#endif
macro_line|#ifdef LINUX_XF86
id|xf86DrvMsg
c_func
(paren
l_int|0
comma
id|X_INFO
comma
l_string|&quot;(init301: LCDInfo = 0x%x LCDResInfo = 0x%x LCDTypeInfo = 0x%x)&bslash;n&quot;
comma
id|SiS_LCDInfo
comma
id|SiS_LCDResInfo
comma
id|SiS_LCDTypeInfo
)paren
suffix:semicolon
macro_line|#endif
multiline_comment|/* TW: With Trumpion, always Expanding */
r_if
c_cond
(paren
id|SiS_IF_DEF_TRUMPION
op_ne
l_int|0
)paren
(brace
id|SiS_LCDInfo
op_and_assign
(paren
op_complement
id|LCDNonExpanding
)paren
suffix:semicolon
)brace
multiline_comment|/* TW: Removed LVDS==1 check here; done foe 301B BIOSes as well */
r_if
c_cond
(paren
id|modeflag
op_amp
id|HalfDCLK
)paren
(brace
r_if
c_cond
(paren
id|SiS_IF_DEF_TRUMPION
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
(paren
op_logical_neg
(paren
id|SiS_LCDInfo
op_amp
l_int|0x0100
)paren
)paren
op_logical_or
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|0
)paren
)paren
(brace
multiline_comment|/* TW: Inserted from 650/LVDS BIOS */
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_LCDInfo
op_amp
id|LCDNonExpanding
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|1
)paren
op_logical_and
(paren
id|SiS_LCDResInfo
op_eq
id|Panel640x480
)paren
)paren
)paren
(brace
multiline_comment|/* TW: Inserted from 650/LVDS BIOS */
r_if
c_cond
(paren
id|ModeNo
OG
l_int|0x13
)paren
(brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1024x768
)paren
(brace
r_if
c_cond
(paren
id|resinfo
op_eq
l_int|4
)paren
(brace
multiline_comment|/* 512x384  */
id|SiS_SetFlag
op_or_assign
id|EnableLVDSDDA
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel800x600
)paren
(brace
r_if
c_cond
(paren
id|resinfo
op_eq
l_int|3
)paren
(brace
multiline_comment|/* 400x300  */
id|SiS_SetFlag
op_or_assign
id|EnableLVDSDDA
suffix:semicolon
)brace
)brace
)brace
)brace
)brace
r_else
(brace
id|SiS_SetFlag
op_or_assign
id|EnableLVDSDDA
suffix:semicolon
)brace
)brace
r_else
(brace
multiline_comment|/* NonExpanding */
id|SiS_SetFlag
op_or_assign
id|EnableLVDSDDA
suffix:semicolon
)brace
)brace
r_else
(brace
multiline_comment|/* TW: Inserted from 650/LVDS BIOS */
id|SiS_SetFlag
op_or_assign
id|EnableLVDSDDA
suffix:semicolon
multiline_comment|/* TW: Inserted from 650/LVDS BIOS */
)brace
multiline_comment|/* TW: Inserted from 650/LVDS BIOS */
)brace
r_else
(brace
multiline_comment|/* TRUMPION */
id|SiS_SetFlag
op_or_assign
id|EnableLVDSDDA
suffix:semicolon
)brace
)brace
multiline_comment|/* TW: wdr: if (VBInfo &amp; LCD) &amp;&amp; (VBInfo &amp; (SetSimuScanMode | SwitchToCRT2)) { */
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetNotSimuMode
)paren
(brace
id|SiS_SetFlag
op_or_assign
id|LCDVESATiming
suffix:semicolon
)brace
)brace
r_else
(brace
id|SiS_SetFlag
op_or_assign
id|LCDVESATiming
suffix:semicolon
)brace
r_return
l_int|1
suffix:semicolon
)brace
r_void
DECL|function|SiS_PresetScratchregister
id|SiS_PresetScratchregister
c_func
(paren
id|USHORT
id|SiS_P3d4
comma
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
)paren
(brace
multiline_comment|/*SiS_SetReg1(SiS_P3d4,0x30,0x21);  */
multiline_comment|/*SiS_SetReg1(SiS_P3d4,0x31,0x41);  */
multiline_comment|/*SiS_SetReg1(SiS_P3d4,0x32,0x28);  */
multiline_comment|/*SiS_SetReg1(SiS_P3d4,0x33,0x22);  */
multiline_comment|/*SiS_SetReg1(SiS_P3d4,0x35,0x43);  */
multiline_comment|/*SiS_SetReg1(SiS_P3d4,0x36,0x01);  */
multiline_comment|/*SiS_SetReg1(SiS_P3d4,0x37,0x00);  */
)brace
r_void
DECL|function|SiS_LongWait
id|SiS_LongWait
c_func
(paren
)paren
(brace
id|USHORT
id|i
suffix:semicolon
id|i
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x1F
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|i
op_amp
l_int|0xC0
)paren
)paren
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|0xFFFF
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_GetReg2
c_func
(paren
id|SiS_P3da
)paren
op_amp
l_int|0x08
)paren
)paren
(brace
r_break
suffix:semicolon
)brace
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|0xFFFF
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
(paren
id|SiS_GetReg2
c_func
(paren
id|SiS_P3da
)paren
op_amp
l_int|0x08
)paren
)paren
(brace
r_break
suffix:semicolon
)brace
)brace
)brace
)brace
r_void
DECL|function|SiS_VBLongWait
id|SiS_VBLongWait
c_func
(paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
)paren
(brace
id|SiS_VBWait
c_func
(paren
)paren
suffix:semicolon
)brace
r_else
(brace
id|SiS_LongWait
c_func
(paren
)paren
suffix:semicolon
)brace
r_return
suffix:semicolon
)brace
r_void
DECL|function|SiS_VBWait
id|SiS_VBWait
c_func
(paren
r_void
)paren
(brace
id|USHORT
id|tempal
comma
id|temp
comma
id|i
comma
id|j
suffix:semicolon
id|temp
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|3
suffix:semicolon
id|i
op_increment
)paren
(brace
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
l_int|100
suffix:semicolon
id|j
op_increment
)paren
(brace
id|tempal
op_assign
id|SiS_GetReg2
c_func
(paren
id|SiS_P3da
)paren
suffix:semicolon
r_if
c_cond
(paren
id|temp
op_amp
l_int|0x01
)paren
(brace
r_if
c_cond
(paren
(paren
id|tempal
op_amp
l_int|0x08
)paren
)paren
(brace
r_continue
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|tempal
op_amp
l_int|0x08
)paren
)paren
(brace
r_break
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|tempal
op_amp
l_int|0x08
)paren
)paren
(brace
r_continue
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|tempal
op_amp
l_int|0x08
)paren
)paren
(brace
r_break
suffix:semicolon
)brace
)brace
)brace
id|temp
op_assign
id|temp
op_xor
l_int|0x01
suffix:semicolon
)brace
)brace
r_void
DECL|function|SiS_WaitVBRetrace
id|SiS_WaitVBRetrace
c_func
(paren
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
)paren
(brace
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_GetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x00
)paren
op_amp
l_int|0x20
)paren
)paren
(brace
r_return
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_GetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x00
)paren
op_amp
l_int|0x80
)paren
)paren
(brace
id|SiS_WaitRetrace1
c_func
(paren
id|HwDeviceExtension
)paren
suffix:semicolon
)brace
r_else
(brace
id|SiS_WaitRetrace2
c_func
(paren
id|HwDeviceExtension
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_GetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x00
)paren
op_amp
l_int|0x40
)paren
)paren
(brace
id|SiS_WaitRetrace1
c_func
(paren
id|HwDeviceExtension
)paren
suffix:semicolon
)brace
r_else
(brace
id|SiS_WaitRetrace2
c_func
(paren
id|HwDeviceExtension
)paren
suffix:semicolon
)brace
)brace
)brace
r_void
DECL|function|SiS_WaitRetrace1
id|SiS_WaitRetrace1
c_func
(paren
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
)paren
(brace
id|USHORT
id|i
comma
id|watchdog
suffix:semicolon
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
r_if
c_cond
(paren
id|SiS_GetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x1f
)paren
op_amp
l_int|0xc0
)paren
(brace
r_return
suffix:semicolon
)brace
id|watchdog
op_assign
l_int|65535
suffix:semicolon
r_while
c_loop
(paren
(paren
id|SiS_GetReg2
c_func
(paren
id|SiS_P3da
)paren
op_amp
l_int|0x08
)paren
op_logical_and
op_decrement
id|watchdog
)paren
(brace
suffix:semicolon
)brace
id|watchdog
op_assign
l_int|65535
suffix:semicolon
r_while
c_loop
(paren
(paren
op_logical_neg
(paren
id|SiS_GetReg2
c_func
(paren
id|SiS_P3da
)paren
op_amp
l_int|0x08
)paren
)paren
op_logical_and
op_decrement
id|watchdog
)paren
(brace
suffix:semicolon
)brace
)brace
r_else
(brace
macro_line|#if 0  /* TW: Not done in A901 BIOS */
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
(brace
r_if
c_cond
(paren
id|SiS_GetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x1f
)paren
op_amp
l_int|0xc0
)paren
(brace
r_return
suffix:semicolon
)brace
)brace
macro_line|#endif
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|10
suffix:semicolon
id|i
op_increment
)paren
(brace
id|watchdog
op_assign
l_int|65535
suffix:semicolon
r_while
c_loop
(paren
(paren
id|SiS_GetReg2
c_func
(paren
id|SiS_P3da
)paren
op_amp
l_int|0x08
)paren
op_logical_and
op_decrement
id|watchdog
)paren
(brace
suffix:semicolon
)brace
r_if
c_cond
(paren
id|watchdog
)paren
(brace
r_break
suffix:semicolon
)brace
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|10
suffix:semicolon
id|i
op_increment
)paren
(brace
id|watchdog
op_assign
l_int|65535
suffix:semicolon
r_while
c_loop
(paren
(paren
op_logical_neg
(paren
id|SiS_GetReg2
c_func
(paren
id|SiS_P3da
)paren
op_amp
l_int|0x08
)paren
)paren
op_logical_and
op_decrement
id|watchdog
)paren
(brace
suffix:semicolon
)brace
r_if
c_cond
(paren
id|watchdog
)paren
(brace
r_break
suffix:semicolon
)brace
)brace
)brace
)brace
r_void
DECL|function|SiS_WaitRetrace2
id|SiS_WaitRetrace2
c_func
(paren
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
)paren
(brace
id|USHORT
id|i
comma
id|watchdog
comma
id|temp
suffix:semicolon
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
id|watchdog
op_assign
l_int|65535
suffix:semicolon
r_while
c_loop
(paren
(paren
id|SiS_GetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x30
)paren
op_amp
l_int|0x02
)paren
op_logical_and
op_decrement
id|watchdog
)paren
(brace
suffix:semicolon
)brace
id|watchdog
op_assign
l_int|65535
suffix:semicolon
r_while
c_loop
(paren
(paren
op_logical_neg
(paren
id|SiS_GetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x30
)paren
op_amp
l_int|0x02
)paren
)paren
op_logical_and
op_decrement
id|watchdog
)paren
(brace
suffix:semicolon
)brace
)brace
r_else
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|10
suffix:semicolon
id|i
op_increment
)paren
(brace
id|watchdog
op_assign
l_int|65535
suffix:semicolon
r_while
c_loop
(paren
(paren
id|temp
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x25
)paren
op_amp
l_int|0x02
)paren
op_logical_and
op_decrement
id|watchdog
)paren
(brace
suffix:semicolon
)brace
r_if
c_cond
(paren
id|watchdog
)paren
(brace
r_break
suffix:semicolon
)brace
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|10
suffix:semicolon
id|i
op_increment
)paren
(brace
id|watchdog
op_assign
l_int|65535
suffix:semicolon
r_while
c_loop
(paren
(paren
op_logical_neg
(paren
id|temp
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x25
)paren
op_amp
l_int|0x02
)paren
)paren
op_logical_and
op_decrement
id|watchdog
)paren
(brace
suffix:semicolon
)brace
r_if
c_cond
(paren
id|watchdog
)paren
(brace
r_break
suffix:semicolon
)brace
)brace
)brace
)brace
multiline_comment|/* =========== Set and Get register routines ========== */
r_void
DECL|function|SiS_SetRegANDOR
id|SiS_SetRegANDOR
c_func
(paren
id|USHORT
id|Port
comma
id|USHORT
id|Index
comma
id|USHORT
id|DataAND
comma
id|USHORT
id|DataOR
)paren
(brace
id|USHORT
id|temp
suffix:semicolon
id|temp
op_assign
id|SiS_GetReg1
c_func
(paren
id|Port
comma
id|Index
)paren
suffix:semicolon
multiline_comment|/* SiS_Part1Port index 02 */
id|temp
op_assign
(paren
id|temp
op_amp
(paren
id|DataAND
)paren
)paren
op_or
id|DataOR
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|Port
comma
id|Index
comma
id|temp
)paren
suffix:semicolon
)brace
r_void
DECL|function|SiS_SetRegAND
id|SiS_SetRegAND
c_func
(paren
id|USHORT
id|Port
comma
id|USHORT
id|Index
comma
id|USHORT
id|DataAND
)paren
(brace
id|USHORT
id|temp
suffix:semicolon
id|temp
op_assign
id|SiS_GetReg1
c_func
(paren
id|Port
comma
id|Index
)paren
suffix:semicolon
multiline_comment|/* SiS_Part1Port index 02 */
id|temp
op_assign
id|temp
op_amp
id|DataAND
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|Port
comma
id|Index
comma
id|temp
)paren
suffix:semicolon
)brace
DECL|function|SiS_SetRegOR
r_void
id|SiS_SetRegOR
c_func
(paren
id|USHORT
id|Port
comma
id|USHORT
id|Index
comma
id|USHORT
id|DataOR
)paren
(brace
id|USHORT
id|temp
suffix:semicolon
id|temp
op_assign
id|SiS_GetReg1
c_func
(paren
id|Port
comma
id|Index
)paren
suffix:semicolon
multiline_comment|/* SiS_Part1Port index 02 */
id|temp
op_assign
id|temp
op_or
id|DataOR
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|Port
comma
id|Index
comma
id|temp
)paren
suffix:semicolon
)brace
multiline_comment|/* ========================================================= */
multiline_comment|/* TW: Set 301 TV Encoder (and some LCD relevant) registers */
multiline_comment|/* TW: Checked against 650/301LV and 630/301B (I+II) */
r_void
DECL|function|SiS_SetGroup2
id|SiS_SetGroup2
c_func
(paren
id|USHORT
id|BaseAddr
comma
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
comma
id|USHORT
id|RefreshRateTableIndex
comma
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
)paren
(brace
id|USHORT
id|i
comma
id|j
comma
id|tempax
comma
id|tempbx
comma
id|tempcx
comma
id|temp
comma
id|temp3
suffix:semicolon
id|USHORT
id|push1
comma
id|push2
comma
id|temp1
suffix:semicolon
id|UCHAR
op_star
id|PhasePoint
suffix:semicolon
id|UCHAR
op_star
id|TimingPoint
suffix:semicolon
id|SiS_Part2PortTblStruct
op_star
id|CRT2Part2Ptr
op_assign
l_int|NULL
suffix:semicolon
id|USHORT
id|modeflag
comma
id|resinfo
comma
id|crt2crtc
comma
id|resindex
comma
id|CRT2Index
suffix:semicolon
id|ULONG
id|longtemp
comma
id|tempeax
comma
id|tempebx
comma
id|temp2
comma
id|tempecx
suffix:semicolon
id|USHORT
id|SiS_RY1COE
op_assign
l_int|0
comma
id|SiS_RY2COE
op_assign
l_int|0
comma
id|SiS_RY3COE
op_assign
l_int|0
comma
id|SiS_RY4COE
op_assign
l_int|0
suffix:semicolon
id|UCHAR
id|atable
(braket
)braket
op_assign
(brace
l_int|0xc3
comma
l_int|0x9e
comma
l_int|0xc3
comma
l_int|0x9e
comma
l_int|0x02
comma
l_int|0x02
comma
l_int|0x02
comma
l_int|0xab
comma
l_int|0x87
comma
l_int|0xab
comma
l_int|0x9e
comma
l_int|0xe7
comma
l_int|0x02
comma
l_int|0x02
)brace
suffix:semicolon
multiline_comment|/* TW: Inserted from 650/301LV BIOS */
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCDA
)paren
(brace
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ModeNo
op_le
l_int|0x13
)paren
(brace
id|modeflag
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_ModeFlag
suffix:semicolon
multiline_comment|/* si+St_ResInfo */
id|resinfo
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_ResInfo
suffix:semicolon
id|crt2crtc
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_CRT2CRTC
suffix:semicolon
)brace
r_else
(brace
id|modeflag
op_assign
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|Ext_ModeFlag
suffix:semicolon
multiline_comment|/* si+Ext_ResInfo */
id|resinfo
op_assign
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|Ext_RESINFO
suffix:semicolon
id|crt2crtc
op_assign
id|SiS_RefIndex
(braket
id|RefreshRateTableIndex
)braket
dot
id|Ext_CRT2CRTC
suffix:semicolon
)brace
id|tempcx
op_assign
id|SiS_VBInfo
suffix:semicolon
id|tempax
op_assign
(paren
id|tempcx
op_amp
l_int|0x00FF
)paren
op_lshift
l_int|8
suffix:semicolon
id|tempbx
op_assign
(paren
id|tempcx
op_amp
l_int|0x00FF
)paren
op_or
(paren
(paren
id|tempcx
op_amp
l_int|0x00FF
)paren
op_lshift
l_int|8
)paren
suffix:semicolon
id|tempbx
op_and_assign
l_int|0x0410
suffix:semicolon
id|temp
op_assign
(paren
id|tempax
op_amp
l_int|0x0800
)paren
op_rshift
l_int|8
suffix:semicolon
id|temp
op_rshift_assign
l_int|1
suffix:semicolon
id|temp
op_or_assign
(paren
(paren
(paren
id|tempbx
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
)paren
op_lshift
l_int|1
)paren
suffix:semicolon
id|temp
op_or_assign
(paren
(paren
id|tempbx
op_amp
l_int|0x00FF
)paren
op_rshift
l_int|3
)paren
suffix:semicolon
id|temp
op_assign
id|temp
op_xor
l_int|0x0C
suffix:semicolon
id|PhasePoint
op_assign
id|SiS_PALPhase
suffix:semicolon
macro_line|#ifdef oldHV
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToHiVisionTV
)paren
(brace
multiline_comment|/* PALPhase */
id|temp
op_assign
id|temp
op_xor
l_int|0x01
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
(brace
id|TimingPoint
op_assign
id|SiS_HiTVSt2Timing
suffix:semicolon
r_if
c_cond
(paren
id|SiS_SetFlag
op_amp
id|TVSimuMode
)paren
(brace
r_if
c_cond
(paren
id|modeflag
op_amp
id|Charx8Dot
)paren
(brace
id|TimingPoint
op_assign
id|SiS_HiTVSt1Timing
suffix:semicolon
)brace
r_else
id|TimingPoint
op_assign
id|SiS_HiTVTextTiming
suffix:semicolon
)brace
)brace
r_else
id|TimingPoint
op_assign
id|SiS_HiTVExtTiming
suffix:semicolon
)brace
r_else
(brace
macro_line|#endif
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetPALTV
)paren
(brace
r_if
c_cond
(paren
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
op_logical_and
multiline_comment|/* TW: @@@ 650+301LV BIOS only tests 301B, 302B */
(paren
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
)paren
op_logical_or
(paren
id|SiS_SetFlag
op_amp
id|TVSimuMode
)paren
)paren
)paren
(brace
id|PhasePoint
op_assign
id|SiS_PALPhase2
suffix:semicolon
)brace
r_else
id|PhasePoint
op_assign
id|SiS_PALPhase
suffix:semicolon
id|TimingPoint
op_assign
id|SiS_PALTiming
suffix:semicolon
)brace
r_else
(brace
id|temp
op_or_assign
l_int|0x10
suffix:semicolon
r_if
c_cond
(paren
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
op_logical_and
multiline_comment|/* TW: @@@ 650+301LV BIOS only tests 301B, 302B */
(paren
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
)paren
op_logical_or
(paren
id|SiS_SetFlag
op_amp
id|TVSimuMode
)paren
)paren
)paren
(brace
id|PhasePoint
op_assign
id|SiS_NTSCPhase2
suffix:semicolon
)brace
r_else
id|PhasePoint
op_assign
id|SiS_NTSCPhase
suffix:semicolon
id|TimingPoint
op_assign
id|SiS_NTSCTiming
suffix:semicolon
)brace
macro_line|#ifdef oldHV
)brace
macro_line|#endif
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x00
comma
id|temp
)paren
suffix:semicolon
macro_line|#ifdef SIS300
r_if
c_cond
(paren
(paren
id|HwDeviceExtension-&gt;jChipType
op_eq
id|SIS_630
)paren
op_logical_or
(paren
id|HwDeviceExtension-&gt;jChipType
op_eq
id|SIS_730
)paren
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
(brace
r_if
c_cond
(paren
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x31
)paren
op_amp
l_int|0x01
)paren
(brace
id|temp1
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x35
)paren
suffix:semicolon
r_if
c_cond
(paren
id|temp1
op_amp
l_int|0x40
)paren
(brace
id|PhasePoint
op_assign
id|SiS_PALMPhase
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
op_logical_and
multiline_comment|/* TW: From 650/301LV BIOS (see note above) */
(paren
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
)paren
op_logical_or
(paren
id|SiS_SetFlag
op_amp
id|TVSimuMode
)paren
)paren
)paren
(brace
id|PhasePoint
op_assign
id|SiS_PALMPhase2
suffix:semicolon
)brace
r_if
c_cond
(paren
id|temp1
op_amp
l_int|0x80
)paren
(brace
id|PhasePoint
op_assign
id|SiS_PALNPhase
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
op_logical_and
multiline_comment|/* TW: From 650/301LV BIOS (see note above) */
(paren
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
)paren
op_logical_or
(paren
id|SiS_SetFlag
op_amp
id|TVSimuMode
)paren
)paren
)paren
(brace
id|PhasePoint
op_assign
id|SiS_PALNPhase2
suffix:semicolon
)brace
)brace
)brace
)brace
macro_line|#endif
macro_line|#ifdef SIS315H
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
(brace
r_if
c_cond
(paren
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x31
)paren
op_amp
l_int|0x01
)paren
(brace
id|temp1
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x38
)paren
suffix:semicolon
r_if
c_cond
(paren
id|temp1
op_amp
l_int|0x40
)paren
(brace
id|PhasePoint
op_assign
id|SiS_PALMPhase
suffix:semicolon
r_if
c_cond
(paren
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
op_logical_and
multiline_comment|/* TW: @@@ From 650/301LV BIOS (see above) */
(paren
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
)paren
op_logical_or
(paren
id|SiS_SetFlag
op_amp
id|TVSimuMode
)paren
)paren
)paren
(brace
id|PhasePoint
op_assign
id|SiS_PALMPhase2
suffix:semicolon
)brace
multiline_comment|/* TW: From 650/301LV BIOS */
)brace
r_if
c_cond
(paren
id|temp1
op_amp
l_int|0x80
)paren
(brace
id|PhasePoint
op_assign
id|SiS_PALNPhase
suffix:semicolon
r_if
c_cond
(paren
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
op_logical_and
multiline_comment|/* TW: @@@ From 650/301LV BIOS (see above) */
(paren
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
)paren
op_logical_or
(paren
id|SiS_SetFlag
op_amp
id|TVSimuMode
)paren
)paren
)paren
(brace
id|PhasePoint
op_assign
id|SiS_PALNPhase2
suffix:semicolon
)brace
multiline_comment|/* TW: From 650/301LV BIOS */
)brace
)brace
)brace
)brace
macro_line|#endif
r_for
c_loop
(paren
id|i
op_assign
l_int|0x31
comma
id|j
op_assign
l_int|0
suffix:semicolon
id|i
op_le
l_int|0x34
suffix:semicolon
id|i
op_increment
comma
id|j
op_increment
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
id|i
comma
id|PhasePoint
(braket
id|j
)braket
)paren
suffix:semicolon
)brace
multiline_comment|/* TW: Inserted from 650/301LV BIOS */
r_if
c_cond
(paren
id|SiS_VBType
op_amp
(paren
id|VB_SIS301LV
op_or
id|VB_SIS302LV
)paren
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetPALTV
)paren
)paren
(brace
r_if
c_cond
(paren
(paren
id|ModeNo
op_eq
l_int|0x4a
)paren
op_logical_or
(paren
id|ModeNo
op_eq
l_int|0x38
)paren
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x31
comma
l_int|0x1e
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x32
comma
l_int|0x8c
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x33
comma
l_int|0x5c
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x34
comma
l_int|0x7a
)paren
suffix:semicolon
)brace
)brace
)brace
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0x01
comma
id|j
op_assign
l_int|0
suffix:semicolon
id|i
op_le
l_int|0x2D
suffix:semicolon
id|i
op_increment
comma
id|j
op_increment
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
id|i
comma
id|TimingPoint
(braket
id|j
)braket
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0x39
suffix:semicolon
id|i
op_le
l_int|0x45
suffix:semicolon
id|i
op_increment
comma
id|j
op_increment
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
id|i
comma
id|TimingPoint
(braket
id|j
)braket
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
(brace
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_ModeType
op_amp
l_int|0x07
)paren
)paren
id|SiS_SetRegAND
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x3A
comma
l_int|0x1F
)paren
suffix:semicolon
)brace
r_else
(brace
id|SiS_SetRegAND
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x3A
comma
l_int|0x1F
)paren
suffix:semicolon
)brace
)brace
id|SiS_SetRegOR
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x0A
comma
id|SiS_NewFlickerMode
)paren
suffix:semicolon
macro_line|#if 0  /* TW: No BIOS does this */
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x35
comma
l_int|0x00
)paren
suffix:semicolon
multiline_comment|/*301b*/
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x36
comma
l_int|0x00
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x37
comma
l_int|0x00
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x38
comma
id|SiS_RY1COE
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x48
comma
id|SiS_RY2COE
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x49
comma
id|SiS_RY3COE
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x4a
comma
id|SiS_RY4COE
)paren
suffix:semicolon
multiline_comment|/*add to change 630+301b filter*/
id|resindex
op_assign
id|SiS_GetResInfo
c_func
(paren
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ModeNo
op_le
l_int|0x13
)paren
(brace
id|xres
op_assign
id|SiS_StResInfo
(braket
id|resindex
)braket
dot
id|HTotal
suffix:semicolon
)brace
r_else
id|xres
op_assign
id|SiS_ModeResInfo
(braket
id|resindex
)braket
dot
id|HTotal
suffix:semicolon
r_if
c_cond
(paren
id|xres
op_eq
l_int|640
)paren
(brace
id|SiS_RY1COE
op_assign
l_int|0xFF
suffix:semicolon
id|SiS_RY2COE
op_assign
l_int|0x03
suffix:semicolon
id|SiS_RY3COE
op_assign
l_int|0x02
suffix:semicolon
id|SiS_RY4COE
op_assign
l_int|0xF6
suffix:semicolon
id|SiS_RY5COE
op_assign
l_int|0xFC
suffix:semicolon
id|SiS_RY6COE
op_assign
l_int|0x27
suffix:semicolon
id|SiS_RY7COE
op_assign
l_int|0x46
suffix:semicolon
)brace
r_if
c_cond
(paren
id|xres
op_eq
l_int|800
)paren
(brace
id|SiS_RY1COE
op_assign
l_int|0x01
suffix:semicolon
id|SiS_RY2COE
op_assign
l_int|0x01
suffix:semicolon
id|SiS_RY3COE
op_assign
l_int|0xFC
suffix:semicolon
id|SiS_RY4COE
op_assign
l_int|0xF8
suffix:semicolon
id|SiS_RY5COE
op_assign
l_int|0x08
suffix:semicolon
id|SiS_RY6COE
op_assign
l_int|0x26
suffix:semicolon
id|SiS_RY7COE
op_assign
l_int|0x38
suffix:semicolon
)brace
r_if
c_cond
(paren
id|xres
op_eq
l_int|1024
)paren
(brace
id|SiS_RY1COE
op_assign
l_int|0xFF
suffix:semicolon
id|SiS_RY2COE
op_assign
l_int|0xFF
suffix:semicolon
id|SiS_RY3COE
op_assign
l_int|0xFC
suffix:semicolon
id|SiS_RY4COE
op_assign
l_int|0x00
suffix:semicolon
id|SiS_RY5COE
op_assign
l_int|0x0F
suffix:semicolon
id|SiS_RY6COE
op_assign
l_int|0x22
suffix:semicolon
id|SiS_RY7COE
op_assign
l_int|0x28
suffix:semicolon
)brace
r_if
c_cond
(paren
id|xres
op_eq
l_int|720
)paren
(brace
id|SiS_RY1COE
op_assign
l_int|0x01
suffix:semicolon
id|SiS_RY2COE
op_assign
l_int|0x02
suffix:semicolon
id|SiS_RY3COE
op_assign
l_int|0xFE
suffix:semicolon
id|SiS_RY4COE
op_assign
l_int|0xF7
suffix:semicolon
id|SiS_RY5COE
op_assign
l_int|0x03
suffix:semicolon
id|SiS_RY6COE
op_assign
l_int|0x27
suffix:semicolon
id|SiS_RY7COE
op_assign
l_int|0x3c
suffix:semicolon
)brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x35
comma
id|SiS_RY1COE
)paren
suffix:semicolon
multiline_comment|/*301b*/
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x36
comma
id|SiS_RY2COE
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x37
comma
id|SiS_RY3COE
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x38
comma
id|SiS_RY4COE
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x48
comma
id|SiS_RY5COE
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x49
comma
id|SiS_RY6COE
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x4a
comma
id|SiS_RY7COE
)paren
suffix:semicolon
multiline_comment|/*end add*/
macro_line|#endif
multiline_comment|/* TW: From 650/301LV and 630/301B BIOS: */
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x35
comma
id|SiS_RY1COE
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x36
comma
id|SiS_RY2COE
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x37
comma
id|SiS_RY3COE
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x38
comma
id|SiS_RY4COE
)paren
suffix:semicolon
macro_line|#ifdef oldHV
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToHiVisionTV
)paren
(brace
id|tempax
op_assign
l_int|950
suffix:semicolon
)brace
r_else
(brace
macro_line|#endif
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetPALTV
)paren
(brace
id|tempax
op_assign
l_int|520
suffix:semicolon
)brace
r_else
id|tempax
op_assign
l_int|440
suffix:semicolon
macro_line|#ifdef oldHV
)brace
macro_line|#endif
r_if
c_cond
(paren
id|SiS_VDE
op_le
id|tempax
)paren
(brace
id|tempax
op_sub_assign
id|SiS_VDE
suffix:semicolon
id|tempax
op_rshift_assign
l_int|2
suffix:semicolon
id|tempax
op_assign
(paren
id|tempax
op_amp
l_int|0x00FF
)paren
op_or
(paren
(paren
id|tempax
op_amp
l_int|0x00FF
)paren
op_lshift
l_int|8
)paren
suffix:semicolon
id|push1
op_assign
id|tempax
suffix:semicolon
id|temp
op_assign
(paren
id|tempax
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
suffix:semicolon
id|temp
op_add_assign
(paren
id|USHORT
)paren
id|TimingPoint
(braket
l_int|0
)braket
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x01
comma
id|temp
)paren
suffix:semicolon
id|tempax
op_assign
id|push1
suffix:semicolon
id|temp
op_assign
(paren
id|tempax
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
suffix:semicolon
id|temp
op_add_assign
id|TimingPoint
(braket
l_int|1
)braket
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x02
comma
id|temp
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
op_logical_and
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
op_logical_and
(paren
id|SiS_VGAHDE
op_ge
l_int|1024
)paren
op_logical_and
(paren
id|SiS_HiVision
op_ne
l_int|3
)paren
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetPALTV
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x01
comma
l_int|0x19
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x02
comma
l_int|0x52
)paren
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x01
comma
l_int|0x17
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x02
comma
l_int|0x1d
)paren
suffix:semicolon
)brace
r_else
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x01
comma
l_int|0x0b
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x02
comma
l_int|0x11
)paren
suffix:semicolon
)brace
)brace
)brace
id|tempcx
op_assign
id|SiS_HT
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
(brace
id|tempcx
op_decrement
suffix:semicolon
)brace
id|temp
op_assign
id|tempcx
op_amp
l_int|0x00FF
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x1B
comma
id|temp
)paren
suffix:semicolon
id|temp
op_assign
(paren
id|tempcx
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x1D
comma
l_int|0xF0
comma
id|temp
)paren
suffix:semicolon
id|tempcx
op_assign
id|SiS_HT
op_rshift
l_int|1
suffix:semicolon
id|push1
op_assign
id|tempcx
suffix:semicolon
multiline_comment|/* push cx */
id|tempcx
op_add_assign
l_int|7
suffix:semicolon
macro_line|#ifdef oldHV
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToHiVisionTV
)paren
(brace
id|tempcx
op_sub_assign
l_int|4
suffix:semicolon
)brace
multiline_comment|/* TW: @@@ not done in 301LV/630+301B BIOS */
macro_line|#endif
id|temp
op_assign
(paren
id|tempcx
op_amp
l_int|0x00FF
)paren
op_lshift
l_int|4
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x22
comma
l_int|0x0F
comma
id|temp
)paren
suffix:semicolon
id|tempbx
op_assign
id|TimingPoint
(braket
id|j
)braket
op_or
(paren
(paren
id|TimingPoint
(braket
id|j
op_plus
l_int|1
)braket
)paren
op_lshift
l_int|8
)paren
suffix:semicolon
id|tempbx
op_add_assign
id|tempcx
suffix:semicolon
id|push2
op_assign
id|tempbx
suffix:semicolon
id|temp
op_assign
id|tempbx
op_amp
l_int|0x00FF
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x24
comma
id|temp
)paren
suffix:semicolon
id|temp
op_assign
(paren
(paren
id|tempbx
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
)paren
op_lshift
l_int|4
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x25
comma
l_int|0x0F
comma
id|temp
)paren
suffix:semicolon
id|tempbx
op_assign
id|push2
suffix:semicolon
id|tempbx
op_add_assign
l_int|8
suffix:semicolon
macro_line|#ifdef oldHV
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToHiVisionTV
)paren
(brace
multiline_comment|/* TW: @@@ not done in 301LV/630+301B BIOS */
id|tempbx
op_sub_assign
l_int|4
suffix:semicolon
multiline_comment|/* TW: @@@ not done in 301LV/630+301B BIOS */
id|tempcx
op_assign
id|tempbx
suffix:semicolon
multiline_comment|/* TW: @@@ not done in 301LV/630+301B BIOS */
)brace
multiline_comment|/* TW: @@@ not done in 301LV/630+301B BIOS */
macro_line|#endif
id|temp
op_assign
(paren
id|tempbx
op_amp
l_int|0x00FF
)paren
op_lshift
l_int|4
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x29
comma
l_int|0x0F
comma
id|temp
)paren
suffix:semicolon
id|j
op_add_assign
l_int|2
suffix:semicolon
id|tempcx
op_add_assign
(paren
(paren
id|TimingPoint
(braket
id|j
)braket
op_or
(paren
(paren
id|TimingPoint
(braket
id|j
op_plus
l_int|1
)braket
)paren
op_lshift
l_int|8
)paren
)paren
)paren
suffix:semicolon
id|temp
op_assign
id|tempcx
op_amp
l_int|0x00FF
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x27
comma
id|temp
)paren
suffix:semicolon
id|temp
op_assign
(paren
(paren
id|tempcx
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
)paren
op_lshift
l_int|4
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x28
comma
l_int|0x0F
comma
id|temp
)paren
suffix:semicolon
id|tempcx
op_add_assign
l_int|8
suffix:semicolon
macro_line|#ifdef oldHV
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToHiVisionTV
)paren
(brace
id|tempcx
op_sub_assign
l_int|4
suffix:semicolon
)brace
multiline_comment|/* TW: @@@ not done in 301LV BIOS */
macro_line|#endif
id|temp
op_assign
(paren
id|tempcx
op_amp
l_int|0xFF
)paren
op_lshift
l_int|4
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x2A
comma
l_int|0x0F
comma
id|temp
)paren
suffix:semicolon
id|tempcx
op_assign
id|push1
suffix:semicolon
id|j
op_add_assign
l_int|2
suffix:semicolon
id|tempcx
op_sub_assign
(paren
id|TimingPoint
(braket
id|j
)braket
op_or
(paren
(paren
id|TimingPoint
(braket
id|j
op_plus
l_int|1
)braket
)paren
op_lshift
l_int|8
)paren
)paren
suffix:semicolon
id|temp
op_assign
(paren
id|tempcx
op_amp
l_int|0x00FF
)paren
op_lshift
l_int|4
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x2D
comma
l_int|0x0F
comma
id|temp
)paren
suffix:semicolon
id|tempcx
op_sub_assign
l_int|11
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
)paren
(brace
id|tempax
op_assign
id|SiS_GetVGAHT2
c_func
(paren
)paren
op_minus
l_int|1
suffix:semicolon
id|tempcx
op_assign
id|tempax
suffix:semicolon
)brace
id|temp
op_assign
id|tempcx
op_amp
l_int|0x00FF
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x2E
comma
id|temp
)paren
suffix:semicolon
id|tempbx
op_assign
id|SiS_VDE
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VGAVDE
op_eq
l_int|360
)paren
(brace
id|tempbx
op_assign
l_int|746
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_VGAVDE
op_eq
l_int|375
)paren
(brace
id|tempbx
op_assign
l_int|746
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_VGAVDE
op_eq
l_int|405
)paren
(brace
id|tempbx
op_assign
l_int|853
suffix:semicolon
)brace
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
(brace
id|tempbx
op_rshift_assign
l_int|1
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
op_logical_and
(paren
op_logical_neg
(paren
id|SiS_HiVision
op_amp
l_int|0x03
)paren
)paren
)paren
(brace
id|tempbx
op_rshift_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|SiS_SetFlag
op_amp
id|TVSimuMode
)paren
(brace
r_if
c_cond
(paren
id|ModeNo
op_le
l_int|0x13
)paren
(brace
r_if
c_cond
(paren
id|crt2crtc
op_eq
l_int|1
)paren
(brace
id|tempbx
op_increment
suffix:semicolon
)brace
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
(brace
r_if
c_cond
(paren
id|crt2crtc
op_eq
l_int|4
)paren
multiline_comment|/* TW: BIOS calls GetRatePtrCRT2 here - does not make sense */
r_if
c_cond
(paren
id|SiS_ModeType
op_le
l_int|3
)paren
(brace
id|tempbx
op_increment
suffix:semicolon
)brace
)brace
)brace
)brace
)brace
id|tempbx
op_sub_assign
l_int|2
suffix:semicolon
id|temp
op_assign
id|tempbx
op_amp
l_int|0x00FF
suffix:semicolon
macro_line|#ifdef oldHV
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToHiVisionTV
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
(brace
r_if
c_cond
(paren
id|ModeNo
op_eq
l_int|0x2f
)paren
(brace
id|temp
op_increment
suffix:semicolon
)brace
)brace
)brace
macro_line|#endif
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x2F
comma
id|temp
)paren
suffix:semicolon
id|temp
op_assign
(paren
id|tempcx
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
suffix:semicolon
id|temp
op_or_assign
(paren
(paren
(paren
id|tempbx
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
)paren
op_lshift
l_int|6
)paren
suffix:semicolon
macro_line|#ifdef oldHV
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToHiVisionTV
)paren
)paren
(brace
macro_line|#endif
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToSCART
)paren
)paren
(brace
multiline_comment|/* TW: New from 630/301B (II) BIOS */
id|temp
op_or_assign
l_int|0x10
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToSVIDEO
)paren
)paren
(brace
id|temp
op_or_assign
l_int|0x20
suffix:semicolon
)brace
)brace
macro_line|#ifdef oldHV
)brace
macro_line|#endif
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x30
comma
id|temp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
(brace
multiline_comment|/* tv gatingno */
id|tempbx
op_assign
id|SiS_VDE
suffix:semicolon
r_if
c_cond
(paren
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
op_logical_and
(paren
op_logical_neg
(paren
id|SiS_HiVision
op_amp
l_int|0x03
)paren
)paren
)paren
(brace
id|tempbx
op_rshift_assign
l_int|1
suffix:semicolon
)brace
id|temp
op_assign
(paren
(paren
(paren
id|tempbx
op_minus
l_int|3
)paren
op_amp
l_int|0x0300
)paren
op_rshift
l_int|8
)paren
op_lshift
l_int|5
suffix:semicolon
id|temp
op_or_assign
l_int|0x18
suffix:semicolon
multiline_comment|/* TW: Inserted from 650/301/301LV BIOS */
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x46
comma
id|temp
)paren
suffix:semicolon
id|temp
op_assign
(paren
id|tempbx
op_minus
l_int|3
)paren
op_amp
l_int|0x00FF
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x47
comma
id|temp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|SiS_HiVision
op_amp
l_int|0x03
)paren
(brace
r_if
c_cond
(paren
id|SiS_HiVision
op_amp
l_int|0x01
)paren
(brace
id|temp
op_assign
l_int|0x30
suffix:semicolon
)brace
r_else
id|temp
op_assign
l_int|0x50
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x4d
comma
id|temp
)paren
suffix:semicolon
)brace
)brace
id|tempbx
op_and_assign
l_int|0x00FF
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|modeflag
op_amp
id|HalfDCLK
)paren
)paren
(brace
id|tempcx
op_assign
id|SiS_VGAHDE
suffix:semicolon
r_if
c_cond
(paren
id|tempcx
op_ge
id|SiS_HDE
)paren
(brace
id|tempbx
op_or_assign
l_int|0x2000
suffix:semicolon
id|tempax
op_and_assign
l_int|0x00FF
suffix:semicolon
)brace
)brace
id|tempcx
op_assign
l_int|0x0101
suffix:semicolon
r_if
c_cond
(paren
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
op_logical_and
(paren
op_logical_neg
(paren
id|SiS_HiVision
op_amp
l_int|0x03
)paren
)paren
)paren
(brace
multiline_comment|/*301b- TW: BIOS BUG! */
r_if
c_cond
(paren
id|SiS_VGAHDE
op_ge
l_int|1024
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|modeflag
op_amp
id|HalfDCLK
)paren
)paren
(brace
multiline_comment|/* TW: &quot;if&quot; inserted from 650/301LV and 630/301B BIOS */
id|tempcx
op_assign
l_int|0x1920
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VGAHDE
op_ge
l_int|1280
)paren
(brace
id|tempcx
op_assign
l_int|0x1420
suffix:semicolon
id|tempbx
op_and_assign
l_int|0xDFFF
suffix:semicolon
)brace
)brace
)brace
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|tempbx
op_amp
l_int|0x2000
)paren
)paren
(brace
r_if
c_cond
(paren
id|modeflag
op_amp
id|HalfDCLK
)paren
(brace
id|tempcx
op_assign
(paren
id|tempcx
op_amp
l_int|0xFF00
)paren
op_or
(paren
(paren
(paren
id|tempcx
op_amp
l_int|0x00FF
)paren
op_lshift
l_int|1
)paren
op_amp
l_int|0xff
)paren
suffix:semicolon
)brace
id|push1
op_assign
id|tempbx
suffix:semicolon
id|tempeax
op_assign
id|SiS_VGAHDE
suffix:semicolon
id|tempebx
op_assign
(paren
id|tempcx
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
suffix:semicolon
id|longtemp
op_assign
id|tempeax
op_star
id|tempebx
suffix:semicolon
id|tempecx
op_assign
id|tempcx
op_amp
l_int|0x00FF
suffix:semicolon
id|longtemp
op_div_assign
id|tempecx
suffix:semicolon
id|longtemp
op_lshift_assign
l_int|0x0d
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
(brace
id|longtemp
op_lshift_assign
l_int|3
suffix:semicolon
)brace
id|tempecx
op_assign
id|SiS_HDE
suffix:semicolon
id|temp2
op_assign
id|longtemp
op_mod
id|tempecx
suffix:semicolon
id|tempeax
op_assign
id|longtemp
op_div
id|tempecx
suffix:semicolon
r_if
c_cond
(paren
id|temp2
op_ne
l_int|0
)paren
(brace
id|tempeax
op_increment
suffix:semicolon
)brace
id|tempax
op_assign
(paren
id|USHORT
)paren
id|tempeax
suffix:semicolon
id|tempbx
op_assign
id|push1
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
(brace
multiline_comment|/* TW: Done anyway in BIOS, but does not matter */
id|tempcx
op_assign
(paren
(paren
id|tempax
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|5
)paren
op_rshift
l_int|8
suffix:semicolon
)brace
id|tempbx
op_or_assign
(paren
id|tempax
op_amp
l_int|0x1F00
)paren
suffix:semicolon
id|tempax
op_assign
(paren
(paren
id|tempax
op_amp
l_int|0x00FF
)paren
op_lshift
l_int|8
)paren
op_or
(paren
id|tempax
op_amp
l_int|0x00FF
)paren
suffix:semicolon
)brace
id|temp
op_assign
(paren
id|tempax
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x44
comma
id|temp
)paren
suffix:semicolon
id|temp
op_assign
(paren
id|tempbx
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x45
comma
l_int|0xC0
comma
id|temp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
(brace
r_if
c_cond
(paren
id|tempbx
op_amp
l_int|0x2000
)paren
(brace
id|tempcx
op_assign
l_int|0x00
suffix:semicolon
)brace
id|temp
op_assign
id|tempcx
suffix:semicolon
id|temp
op_or_assign
l_int|0x18
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x46
comma
l_int|0xE0
comma
id|temp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetPALTV
)paren
(brace
id|tempbx
op_assign
l_int|0x0382
suffix:semicolon
multiline_comment|/* TW: BIOS; Was 0x0364; */
id|tempcx
op_assign
l_int|0x007e
suffix:semicolon
multiline_comment|/* TW: BIOS; Was 0x009c; */
)brace
r_else
(brace
id|tempbx
op_assign
l_int|0x0369
suffix:semicolon
multiline_comment|/* TW: BIOS; Was 0x0346; */
id|tempcx
op_assign
l_int|0x0061
suffix:semicolon
multiline_comment|/* TW: BIOS; Was 0x0078; */
)brace
id|temp
op_assign
(paren
id|tempbx
op_amp
l_int|0x00FF
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x4B
comma
id|temp
)paren
suffix:semicolon
id|temp
op_assign
(paren
id|tempcx
op_amp
l_int|0x00FF
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x4C
comma
id|temp
)paren
suffix:semicolon
id|tempbx
op_and_assign
l_int|0x0300
suffix:semicolon
id|temp
op_assign
(paren
id|tempcx
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
suffix:semicolon
id|temp
op_assign
(paren
id|temp
op_amp
l_int|0x0003
)paren
op_lshift
l_int|2
suffix:semicolon
id|temp
op_or_assign
(paren
id|tempbx
op_rshift
l_int|8
)paren
suffix:semicolon
id|SiS_SetRegOR
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x4D
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* TW: 650/LV - was SetReg1() (not 630/301B) */
id|temp
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x43
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x43
comma
(paren
id|USHORT
)paren
(paren
id|temp
op_minus
l_int|3
)paren
)paren
suffix:semicolon
)brace
macro_line|#ifdef SIS300
r_if
c_cond
(paren
(paren
id|HwDeviceExtension-&gt;jChipType
op_eq
id|SIS_630
)paren
op_logical_or
(paren
id|HwDeviceExtension-&gt;jChipType
op_eq
id|SIS_730
)paren
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
(brace
r_if
c_cond
(paren
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x31
)paren
op_amp
l_int|0x01
)paren
(brace
r_if
c_cond
(paren
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x35
)paren
op_amp
l_int|0x40
)paren
(brace
id|SiS_SetRegAND
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x00
comma
l_int|0xEF
)paren
suffix:semicolon
id|temp3
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x01
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x01
comma
id|temp3
op_minus
l_int|1
)paren
suffix:semicolon
)brace
)brace
)brace
)brace
macro_line|#endif
macro_line|#ifdef SIS315H
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
(brace
r_if
c_cond
(paren
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x31
)paren
op_amp
l_int|0x01
)paren
(brace
r_if
c_cond
(paren
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x38
)paren
op_amp
l_int|0x40
)paren
(brace
id|SiS_SetRegAND
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x00
comma
l_int|0xEF
)paren
suffix:semicolon
id|temp3
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x01
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x01
comma
id|temp3
op_minus
l_int|1
)paren
suffix:semicolon
)brace
)brace
)brace
)brace
multiline_comment|/*end add*/
macro_line|#endif
macro_line|#ifdef oldHV
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToHiVisionTV
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x0B
comma
l_int|0x00
)paren
suffix:semicolon
)brace
)brace
macro_line|#endif
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
(brace
r_return
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBType
op_amp
(paren
id|VB_SIS301LV
op_or
id|VB_SIS302LV
)paren
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetPALTV
)paren
)paren
(brace
r_if
c_cond
(paren
(paren
id|ModeNo
op_eq
l_int|0x4a
)paren
op_logical_or
(paren
id|ModeNo
op_eq
l_int|0x38
)paren
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x1c
comma
l_int|0xa7
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x1d
comma
l_int|0x07
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x1e
comma
l_int|0xf2
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x1f
comma
l_int|0x6e
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x20
comma
l_int|0x17
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x21
comma
l_int|0x8b
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x22
comma
l_int|0x73
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x23
comma
l_int|0x53
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x24
comma
l_int|0x13
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x25
comma
l_int|0x40
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x26
comma
l_int|0x34
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x27
comma
l_int|0xf4
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x28
comma
l_int|0x63
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x29
comma
l_int|0xbb
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x2a
comma
l_int|0xcc
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x2b
comma
l_int|0x7a
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x2c
comma
l_int|0x58
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x2d
comma
l_int|0xe4
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x2e
comma
l_int|0x73
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x2f
comma
l_int|0xda
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x30
comma
l_int|0x13
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x43
comma
l_int|0x72
)paren
suffix:semicolon
)brace
)brace
)brace
)brace
r_return
suffix:semicolon
)brace
)brace
multiline_comment|/* TW: From here: LCD Part2 group */
id|tempbx
op_assign
id|SiS_HDE
op_minus
l_int|1
suffix:semicolon
multiline_comment|/* RHACTE=HDE-1 */
id|temp
op_assign
id|tempbx
op_amp
l_int|0x00FF
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x2C
comma
id|temp
)paren
suffix:semicolon
id|temp
op_assign
(paren
id|tempbx
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
suffix:semicolon
id|temp
op_lshift_assign
l_int|4
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x2B
comma
l_int|0x0F
comma
id|temp
)paren
suffix:semicolon
id|temp
op_assign
l_int|0x01
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1280x1024
)paren
(brace
r_if
c_cond
(paren
id|SiS_ModeType
op_eq
id|ModeEGA
)paren
(brace
r_if
c_cond
(paren
id|SiS_VGAHDE
op_ge
l_int|1024
)paren
(brace
id|temp
op_assign
l_int|0x02
suffix:semicolon
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
r_if
c_cond
(paren
id|SiS_SetFlag
op_amp
id|LCDVESATiming
)paren
(brace
id|temp
op_assign
l_int|0x01
suffix:semicolon
)brace
)brace
)brace
)brace
)brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x0B
comma
id|temp
)paren
suffix:semicolon
id|tempbx
op_assign
id|SiS_VDE
suffix:semicolon
multiline_comment|/* RTVACTEO=(VDE-1)&amp;0xFF */
id|push1
op_assign
id|tempbx
suffix:semicolon
id|tempbx
op_decrement
suffix:semicolon
id|temp
op_assign
id|tempbx
op_amp
l_int|0x00FF
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x03
comma
id|temp
)paren
suffix:semicolon
id|temp
op_assign
(paren
(paren
id|tempbx
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
)paren
op_amp
l_int|0x07
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x0C
comma
l_int|0xF8
comma
id|temp
)paren
suffix:semicolon
id|tempcx
op_assign
id|SiS_VT
suffix:semicolon
id|push2
op_assign
id|tempcx
suffix:semicolon
id|tempcx
op_decrement
suffix:semicolon
id|temp
op_assign
id|tempcx
op_amp
l_int|0x00FF
suffix:semicolon
multiline_comment|/* RVTVT=VT-1 */
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x19
comma
id|temp
)paren
suffix:semicolon
id|temp
op_assign
(paren
id|tempcx
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
suffix:semicolon
id|temp
op_lshift_assign
l_int|5
suffix:semicolon
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
(brace
id|temp
op_or_assign
l_int|0x10
suffix:semicolon
)brace
r_else
(brace
macro_line|#if 0
r_if
c_cond
(paren
id|SiS_LCDInfo
op_amp
id|LCDRGB18Bit
)paren
multiline_comment|/* TW: 630/301B (II) BIOS does not check this!!! */
macro_line|#endif
r_if
c_cond
(paren
id|SiS_LCDInfo
op_amp
id|LCDSync
)paren
(brace
multiline_comment|/* TW: 630/301 BIOS checks this */
id|temp
op_or_assign
l_int|0x10
suffix:semicolon
)brace
)brace
)brace
r_else
id|temp
op_or_assign
l_int|0x10
suffix:semicolon
multiline_comment|/* 630/301 does not do all this */
r_if
c_cond
(paren
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
op_logical_and
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCD
)paren
)paren
(brace
id|tempbx
op_assign
(paren
id|tempbx
op_amp
l_int|0xFF00
)paren
op_or
(paren
id|SiS_LCDInfo
op_amp
l_int|0x0FF
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tempbx
op_amp
id|LCDSync
)paren
(brace
id|tempbx
op_and_assign
(paren
l_int|0xFF00
op_or
id|LCDSyncBit
)paren
suffix:semicolon
id|tempbx
op_assign
(paren
id|tempbx
op_amp
l_int|0xFF00
)paren
op_or
(paren
(paren
id|tempbx
op_amp
l_int|0x00FF
)paren
op_rshift
id|LCDSyncShift
)paren
suffix:semicolon
id|temp
op_or_assign
(paren
id|tempbx
op_amp
l_int|0x00FF
)paren
suffix:semicolon
)brace
)brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x1A
comma
id|temp
)paren
suffix:semicolon
id|SiS_SetRegAND
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x09
comma
l_int|0xF0
)paren
suffix:semicolon
id|SiS_SetRegAND
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x0A
comma
l_int|0xF0
)paren
suffix:semicolon
id|SiS_SetRegAND
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x17
comma
l_int|0xFB
)paren
suffix:semicolon
id|SiS_SetRegAND
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x18
comma
l_int|0xDF
)paren
suffix:semicolon
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
multiline_comment|/* 310 series */
multiline_comment|/* TW: Inserted this entire section from 650/301LV BIOS */
id|SiS_GetCRT2Part2Ptr
c_func
(paren
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|RefreshRateTableIndex
comma
op_amp
id|CRT2Index
comma
op_amp
id|resindex
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|CRT2Index
)paren
(brace
r_case
l_int|0
suffix:colon
id|CRT2Part2Ptr
op_assign
id|SiS_CRT2Part2_1024x768_1
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* &quot;Normal&quot; */
r_case
l_int|1
suffix:colon
id|CRT2Part2Ptr
op_assign
id|SiS_CRT2Part2_1280x1024_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|CRT2Part2Ptr
op_assign
id|SiS_CRT2Part2_1024x768_2
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* Non-Expanding */
r_case
l_int|3
suffix:colon
id|CRT2Part2Ptr
op_assign
id|SiS_CRT2Part2_1280x1024_2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|4
suffix:colon
id|CRT2Part2Ptr
op_assign
id|SiS_CRT2Part2_1024x768_3
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* VESA Timing */
r_case
l_int|5
suffix:colon
id|CRT2Part2Ptr
op_assign
id|SiS_CRT2Part2_1280x1024_3
suffix:semicolon
r_break
suffix:semicolon
)brace
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x01
comma
l_int|0x80
comma
(paren
id|CRT2Part2Ptr
op_plus
id|resindex
)paren
op_member_access_from_pointer
id|CR
(braket
l_int|0
)braket
)paren
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x02
comma
l_int|0x80
comma
(paren
id|CRT2Part2Ptr
op_plus
id|resindex
)paren
op_member_access_from_pointer
id|CR
(braket
l_int|1
)braket
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|2
comma
id|j
op_assign
l_int|0x04
suffix:semicolon
id|j
op_le
l_int|0x06
suffix:semicolon
id|i
op_increment
comma
id|j
op_increment
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
id|j
comma
(paren
id|CRT2Part2Ptr
op_plus
id|resindex
)paren
op_member_access_from_pointer
id|CR
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|j
op_assign
l_int|0x1c
suffix:semicolon
id|j
op_le
l_int|0x1d
suffix:semicolon
id|i
op_increment
comma
id|j
op_increment
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
id|j
comma
(paren
id|CRT2Part2Ptr
op_plus
id|resindex
)paren
op_member_access_from_pointer
id|CR
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|j
op_assign
l_int|0x1f
suffix:semicolon
id|j
op_le
l_int|0x21
suffix:semicolon
id|i
op_increment
comma
id|j
op_increment
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
id|j
comma
(paren
id|CRT2Part2Ptr
op_plus
id|resindex
)paren
op_member_access_from_pointer
id|CR
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x23
comma
(paren
id|CRT2Part2Ptr
op_plus
id|resindex
)paren
op_member_access_from_pointer
id|CR
(braket
l_int|10
)braket
)paren
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x25
comma
l_int|0x0f
comma
(paren
id|CRT2Part2Ptr
op_plus
id|resindex
)paren
op_member_access_from_pointer
id|CR
(braket
l_int|11
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_SetFlag
op_amp
id|LCDVESATiming
)paren
)paren
(brace
r_if
c_cond
(paren
id|SiS_VGAVDE
op_eq
l_int|0x20d
)paren
(brace
id|temp
op_assign
l_int|0xc3
suffix:semicolon
r_if
c_cond
(paren
id|SiS_ModeType
op_le
id|ModeVGA
)paren
(brace
id|temp
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
(brace
id|temp
op_add_assign
l_int|2
suffix:semicolon
)brace
)brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x2f
comma
id|temp
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x30
comma
l_int|0xb3
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_VGAVDE
op_eq
l_int|0x1a4
)paren
(brace
id|temp
op_assign
l_int|0x4d
suffix:semicolon
r_if
c_cond
(paren
id|SiS_ModeType
op_le
id|ModeVGA
)paren
(brace
id|temp
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
(brace
id|temp
op_increment
suffix:semicolon
)brace
)brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x2f
comma
id|temp
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/* 2f5d */
)brace
r_else
(brace
multiline_comment|/* 300 series */
id|tempcx
op_increment
suffix:semicolon
id|tempbx
op_assign
l_int|768
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_ne
id|Panel1024x768
)paren
(brace
id|tempbx
op_assign
l_int|1024
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_ne
id|Panel1280x1024
)paren
(brace
id|tempbx
op_assign
l_int|1200
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_ne
id|Panel1600x1200
)paren
(brace
r_if
c_cond
(paren
id|tempbx
op_ne
id|SiS_VDE
)paren
(brace
id|tempbx
op_assign
l_int|960
suffix:semicolon
)brace
)brace
)brace
)brace
r_if
c_cond
(paren
id|SiS_LCDInfo
op_amp
id|LCDNonExpanding
)paren
(brace
id|tempbx
op_assign
id|SiS_VDE
op_minus
l_int|1
suffix:semicolon
id|tempcx
op_decrement
suffix:semicolon
)brace
id|tempax
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_LCDInfo
op_amp
id|LCDNonExpanding
)paren
)paren
(brace
r_if
c_cond
(paren
id|tempbx
op_ne
id|SiS_VDE
)paren
(brace
id|tempax
op_assign
id|tempbx
suffix:semicolon
r_if
c_cond
(paren
id|tempax
OL
id|SiS_VDE
)paren
(brace
id|tempax
op_assign
l_int|0
suffix:semicolon
id|tempcx
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|tempax
op_sub_assign
id|SiS_VDE
suffix:semicolon
)brace
id|tempax
op_rshift_assign
l_int|1
suffix:semicolon
)brace
id|tempcx
op_sub_assign
id|tempax
suffix:semicolon
multiline_comment|/* lcdvdes */
id|tempbx
op_sub_assign
id|tempax
suffix:semicolon
multiline_comment|/* lcdvdee */
)brace
r_else
(brace
id|tempax
op_rshift_assign
l_int|1
suffix:semicolon
id|tempcx
op_sub_assign
id|tempax
suffix:semicolon
multiline_comment|/* lcdvdes */
id|tempbx
op_sub_assign
id|tempax
suffix:semicolon
multiline_comment|/* lcdvdee */
)brace
id|temp
op_assign
id|tempcx
op_amp
l_int|0x00FF
suffix:semicolon
multiline_comment|/* RVEQ1EQ=lcdvdes */
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x05
comma
id|temp
)paren
suffix:semicolon
id|temp
op_assign
id|tempbx
op_amp
l_int|0x00FF
suffix:semicolon
multiline_comment|/* RVEQ2EQ=lcdvdee */
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x06
comma
id|temp
)paren
suffix:semicolon
id|temp
op_assign
(paren
(paren
id|tempbx
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
)paren
op_lshift
l_int|3
suffix:semicolon
id|temp
op_or_assign
(paren
(paren
id|tempcx
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x02
comma
id|temp
)paren
suffix:semicolon
id|tempbx
op_assign
id|push2
suffix:semicolon
id|tempax
op_assign
id|push1
suffix:semicolon
id|tempcx
op_assign
id|tempbx
suffix:semicolon
id|tempcx
op_sub_assign
id|tempax
suffix:semicolon
id|tempcx
op_rshift_assign
l_int|4
suffix:semicolon
id|tempbx
op_add_assign
id|tempax
suffix:semicolon
id|tempbx
op_rshift_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDInfo
op_amp
id|LCDNonExpanding
)paren
(brace
id|tempbx
op_sub_assign
l_int|10
suffix:semicolon
)brace
id|temp
op_assign
id|tempbx
op_amp
l_int|0x00FF
suffix:semicolon
multiline_comment|/* RTVACTEE=lcdvrs */
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x04
comma
id|temp
)paren
suffix:semicolon
id|temp
op_assign
(paren
(paren
id|tempbx
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
)paren
op_lshift
l_int|4
suffix:semicolon
id|tempbx
op_add_assign
(paren
id|tempcx
op_plus
l_int|1
)paren
suffix:semicolon
id|temp
op_or_assign
(paren
id|tempbx
op_amp
l_int|0x000F
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x01
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* TW: Code from 630/301B (I+II) BIOS */
r_if
c_cond
(paren
(paren
(paren
(paren
id|HwDeviceExtension-&gt;jChipType
op_eq
id|SIS_630
)paren
op_logical_or
(paren
id|HwDeviceExtension-&gt;jChipType
op_eq
id|SIS_730
)paren
)paren
op_logical_and
(paren
id|HwDeviceExtension-&gt;jChipRevision
OG
l_int|2
)paren
)paren
op_logical_and
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1024x768
)paren
op_logical_and
(paren
op_logical_neg
(paren
id|SiS_SetFlag
op_amp
id|LCDVESATiming
)paren
)paren
op_logical_and
(paren
op_logical_neg
(paren
id|SiS_LCDInfo
op_amp
id|LCDNonExpanding
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
id|ModeNo
op_eq
l_int|0x13
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x04
comma
l_int|0xB9
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x05
comma
l_int|0xCC
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x06
comma
l_int|0xA6
)paren
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
(paren
id|crt2crtc
op_amp
l_int|0x3F
)paren
op_eq
l_int|4
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x01
comma
l_int|0x2B
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x02
comma
l_int|0x13
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x04
comma
l_int|0xE5
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x05
comma
l_int|0x08
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x06
comma
l_int|0xE2
)paren
suffix:semicolon
)brace
)brace
)brace
multiline_comment|/* TW: Inserted missing code from 630/301B BIOS: (II: 3258) */
r_if
c_cond
(paren
id|SiS_LCDTypeInfo
op_eq
l_int|0x0c
)paren
(brace
id|crt2crtc
op_and_assign
l_int|0x1f
suffix:semicolon
id|tempcx
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetNotSimuMode
)paren
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
(brace
id|tempcx
op_add_assign
l_int|7
suffix:semicolon
)brace
)brace
id|tempcx
op_add_assign
id|crt2crtc
suffix:semicolon
r_if
c_cond
(paren
id|crt2crtc
op_ge
l_int|4
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x06
comma
l_int|0xff
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetNotSimuMode
)paren
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
(brace
r_if
c_cond
(paren
id|crt2crtc
op_eq
l_int|4
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x01
comma
l_int|0x28
)paren
suffix:semicolon
)brace
)brace
)brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x02
comma
l_int|0x18
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x04
comma
id|atable
(braket
id|tempcx
)braket
)paren
suffix:semicolon
)brace
id|tempcx
op_assign
(paren
id|SiS_HT
op_minus
id|SiS_HDE
)paren
op_rshift
l_int|2
suffix:semicolon
multiline_comment|/* (HT-HDE)&gt;&gt;2     */
id|tempbx
op_assign
id|SiS_HDE
op_plus
l_int|7
suffix:semicolon
multiline_comment|/* lcdhdee         */
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
(brace
id|tempbx
op_add_assign
l_int|2
suffix:semicolon
)brace
id|push1
op_assign
id|tempbx
suffix:semicolon
id|temp
op_assign
id|tempbx
op_amp
l_int|0x00FF
suffix:semicolon
multiline_comment|/* RHEQPLE=lcdhdee */
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x23
comma
id|temp
)paren
suffix:semicolon
id|temp
op_assign
(paren
id|tempbx
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x25
comma
l_int|0xF0
comma
id|temp
)paren
suffix:semicolon
id|temp
op_assign
l_int|7
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
(brace
id|temp
op_add_assign
l_int|2
suffix:semicolon
)brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x1F
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* RHBLKE=lcdhdes */
id|SiS_SetRegAND
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x20
comma
l_int|0x0F
)paren
suffix:semicolon
id|tempbx
op_add_assign
id|tempcx
suffix:semicolon
id|push2
op_assign
id|tempbx
suffix:semicolon
id|temp
op_assign
id|tempbx
op_amp
l_int|0xFF
suffix:semicolon
multiline_comment|/* RHBURSTS=lcdhrs */
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1280x1024
)paren
(brace
r_if
c_cond
(paren
id|SiS_LCDInfo
op_amp
id|LCDNonExpanding
)paren
(brace
r_if
c_cond
(paren
id|SiS_HDE
op_eq
l_int|1280
)paren
(brace
id|temp
op_assign
l_int|0x47
suffix:semicolon
)brace
)brace
)brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x1C
comma
id|temp
)paren
suffix:semicolon
id|temp
op_assign
(paren
(paren
id|tempbx
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
)paren
op_lshift
l_int|4
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x1D
comma
l_int|0x0F
comma
id|temp
)paren
suffix:semicolon
id|tempbx
op_assign
id|push2
suffix:semicolon
id|tempcx
op_lshift_assign
l_int|1
suffix:semicolon
id|tempbx
op_add_assign
id|tempcx
suffix:semicolon
id|temp
op_assign
id|tempbx
op_amp
l_int|0x00FF
suffix:semicolon
multiline_comment|/* RHSYEXP2S=lcdhre */
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x21
comma
id|temp
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_SetFlag
op_amp
id|LCDVESATiming
)paren
)paren
(brace
r_if
c_cond
(paren
id|SiS_VGAVDE
op_eq
l_int|525
)paren
(brace
multiline_comment|/*      if(SiS_VBType &amp; VB_SIS301BLV302BLV)  */
multiline_comment|/* TW: 630/301B (I+II) */
r_if
c_cond
(paren
id|SiS_ModeType
op_le
id|ModeVGA
)paren
(brace
id|temp
op_assign
l_int|0xC6
suffix:semicolon
)brace
r_else
id|temp
op_assign
l_int|0xC3
suffix:semicolon
multiline_comment|/* 650: c4 */
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x2f
comma
id|temp
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x30
comma
l_int|0xB3
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_VGAVDE
op_eq
l_int|420
)paren
(brace
multiline_comment|/*      if(SiS_VBType &amp; VB_SIS301BLV302BLV)  */
multiline_comment|/* TW: 630/301B (I+II) */
r_if
c_cond
(paren
id|SiS_ModeType
op_le
id|ModeVGA
)paren
(brace
id|temp
op_assign
l_int|0x4F
suffix:semicolon
)brace
r_else
id|temp
op_assign
l_int|0x4D
suffix:semicolon
multiline_comment|/* 650: 4e */
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x2f
comma
id|temp
)paren
suffix:semicolon
)brace
)brace
)brace
multiline_comment|/* HwDeviceExtension */
)brace
id|USHORT
DECL|function|SiS_GetVGAHT2
id|SiS_GetVGAHT2
c_func
(paren
)paren
(brace
id|ULONG
id|tempax
comma
id|tempbx
suffix:semicolon
id|tempbx
op_assign
(paren
(paren
id|SiS_VGAVT
op_minus
id|SiS_VGAVDE
)paren
op_star
id|SiS_RVBHCMAX
)paren
op_amp
l_int|0xFFFF
suffix:semicolon
id|tempax
op_assign
(paren
id|SiS_VT
op_minus
id|SiS_VDE
)paren
op_star
id|SiS_RVBHCFACT
suffix:semicolon
id|tempax
op_assign
(paren
id|tempax
op_star
id|SiS_HT
)paren
op_div
id|tempbx
suffix:semicolon
r_return
(paren
id|USHORT
)paren
id|tempax
suffix:semicolon
)brace
multiline_comment|/* TW: Set 301 Macrovision(tm) registers */
multiline_comment|/* TW: Double-Checked against 650/301LV and 630/301B BIOS */
r_void
DECL|function|SiS_SetGroup3
id|SiS_SetGroup3
c_func
(paren
id|USHORT
id|BaseAddr
comma
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
comma
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
)paren
(brace
id|USHORT
id|i
suffix:semicolon
id|UCHAR
op_star
id|tempdi
suffix:semicolon
id|USHORT
id|modeflag
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCDA
)paren
(brace
r_return
suffix:semicolon
)brace
multiline_comment|/* TW: Inserted from BIOS */
r_if
c_cond
(paren
id|ModeNo
op_le
l_int|0x13
)paren
(brace
id|modeflag
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_ModeFlag
suffix:semicolon
)brace
r_else
id|modeflag
op_assign
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|Ext_ModeFlag
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part3Port
comma
l_int|0x00
comma
l_int|0x00
)paren
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetPALTV
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part3Port
comma
l_int|0x13
comma
l_int|0xFA
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part3Port
comma
l_int|0x14
comma
l_int|0xC8
)paren
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part3Port
comma
l_int|0x13
comma
l_int|0xF5
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part3Port
comma
l_int|0x14
comma
l_int|0xB7
)paren
suffix:semicolon
)brace
r_else
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part3Port
comma
l_int|0x13
comma
l_int|0xF6
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part3Port
comma
l_int|0x14
comma
l_int|0xBf
)paren
suffix:semicolon
)brace
)brace
macro_line|#ifdef SIS300
r_if
c_cond
(paren
(paren
id|HwDeviceExtension-&gt;jChipType
op_eq
id|SIS_630
)paren
op_logical_or
(paren
id|HwDeviceExtension-&gt;jChipType
op_eq
id|SIS_730
)paren
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
(brace
r_if
c_cond
(paren
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x31
)paren
op_amp
l_int|0x01
)paren
(brace
r_if
c_cond
(paren
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x35
)paren
op_amp
l_int|0x40
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part3Port
comma
l_int|0x13
comma
l_int|0xFA
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part3Port
comma
l_int|0x14
comma
l_int|0xC8
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part3Port
comma
l_int|0x3D
comma
l_int|0xA8
)paren
suffix:semicolon
)brace
)brace
)brace
)brace
macro_line|#endif
macro_line|#ifdef SIS315H
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
(brace
r_if
c_cond
(paren
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x31
)paren
op_amp
l_int|0x01
)paren
(brace
r_if
c_cond
(paren
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x38
)paren
op_amp
l_int|0x40
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part3Port
comma
l_int|0x13
comma
l_int|0xFA
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part3Port
comma
l_int|0x14
comma
l_int|0xC8
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part3Port
comma
l_int|0x3D
comma
l_int|0xA8
)paren
suffix:semicolon
)brace
)brace
)brace
)brace
macro_line|#endif
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToHiVisionTV
)paren
(brace
id|tempdi
op_assign
id|SiS_HiTVGroup3Data
suffix:semicolon
r_if
c_cond
(paren
id|SiS_SetFlag
op_amp
id|TVSimuMode
)paren
(brace
id|tempdi
op_assign
id|SiS_HiTVGroup3Simu
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|modeflag
op_amp
id|Charx8Dot
)paren
)paren
(brace
id|tempdi
op_assign
id|SiS_HiTVGroup3Text
suffix:semicolon
)brace
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
l_int|0x3E
suffix:semicolon
id|i
op_increment
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part3Port
comma
id|i
comma
id|tempdi
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
)brace
r_return
suffix:semicolon
)brace
multiline_comment|/* TW: Set 301 VGA2 registers */
multiline_comment|/* TW: Double-Checked against 650/301LV and 630/301B BIOS */
r_void
DECL|function|SiS_SetGroup4
id|SiS_SetGroup4
c_func
(paren
id|USHORT
id|BaseAddr
comma
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
comma
id|USHORT
id|RefreshRateTableIndex
comma
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
)paren
(brace
id|USHORT
id|tempax
comma
id|tempcx
comma
id|tempbx
comma
id|modeflag
comma
id|temp
comma
id|temp2
comma
id|push1
suffix:semicolon
id|ULONG
id|tempebx
comma
id|tempeax
comma
id|templong
suffix:semicolon
r_if
c_cond
(paren
id|ModeNo
op_le
l_int|0x13
)paren
(brace
id|modeflag
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_ModeFlag
suffix:semicolon
)brace
r_else
id|modeflag
op_assign
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|Ext_ModeFlag
suffix:semicolon
multiline_comment|/* TW: From 650/301LV BIOS (done above as well, but does not matter) */
r_if
c_cond
(paren
id|SiS_VBType
op_amp
(paren
id|VB_SIS301LV
op_or
id|VB_SIS302LV
)paren
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCDA
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x24
comma
l_int|0x0e
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/* TW: From 650/301LV BIOS */
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCDA
)paren
(brace
r_return
suffix:semicolon
)brace
id|temp
op_assign
id|SiS_RVBHCFACT
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x13
comma
id|temp
)paren
suffix:semicolon
id|tempbx
op_assign
id|SiS_RVBHCMAX
suffix:semicolon
id|temp
op_assign
id|tempbx
op_amp
l_int|0x00FF
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x14
comma
id|temp
)paren
suffix:semicolon
id|temp2
op_assign
(paren
(paren
(paren
id|tempbx
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
)paren
op_lshift
l_int|7
)paren
op_amp
l_int|0x00ff
suffix:semicolon
id|tempcx
op_assign
id|SiS_VGAHT
op_minus
l_int|1
suffix:semicolon
id|temp
op_assign
id|tempcx
op_amp
l_int|0x00FF
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x16
comma
id|temp
)paren
suffix:semicolon
id|temp
op_assign
(paren
(paren
(paren
id|tempcx
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
)paren
op_lshift
l_int|3
)paren
op_amp
l_int|0x00ff
suffix:semicolon
id|temp2
op_or_assign
id|temp
suffix:semicolon
id|tempcx
op_assign
id|SiS_VGAVT
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
)paren
(brace
id|tempcx
op_sub_assign
l_int|5
suffix:semicolon
)brace
id|temp
op_assign
id|tempcx
op_amp
l_int|0x00FF
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x17
comma
id|temp
)paren
suffix:semicolon
id|temp
op_assign
id|temp2
op_or
(paren
(paren
id|tempcx
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x15
comma
id|temp
)paren
suffix:semicolon
id|tempcx
op_assign
id|SiS_VBInfo
suffix:semicolon
id|tempbx
op_assign
id|SiS_VGAHDE
suffix:semicolon
r_if
c_cond
(paren
id|modeflag
op_amp
id|HalfDCLK
)paren
(brace
id|tempbx
op_rshift_assign
l_int|1
suffix:semicolon
)brace
multiline_comment|/* TW: New for 650/301LV and 630/301B */
id|temp
op_assign
l_int|0xA0
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToHiVisionTV
)paren
(brace
id|temp
op_assign
l_int|0xA0
suffix:semicolon
r_if
c_cond
(paren
id|tempbx
op_ne
l_int|1024
)paren
(brace
id|temp
op_assign
l_int|0xC0
suffix:semicolon
r_if
c_cond
(paren
id|tempbx
op_ne
l_int|1280
)paren
(brace
id|temp
op_assign
l_int|0
suffix:semicolon
)brace
)brace
)brace
r_else
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
(brace
r_if
c_cond
(paren
id|tempbx
op_le
l_int|800
)paren
(brace
id|temp
op_assign
l_int|0x80
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCD
)paren
(brace
id|temp
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|tempbx
OG
l_int|800
)paren
(brace
id|temp
op_assign
l_int|0x60
suffix:semicolon
)brace
)brace
)brace
)brace
r_else
(brace
id|temp
op_assign
l_int|0x80
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCD
)paren
(brace
id|temp
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|tempbx
OG
l_int|800
)paren
(brace
id|temp
op_assign
l_int|0x60
suffix:semicolon
)brace
)brace
)brace
r_if
c_cond
(paren
id|SiS_HiVision
op_amp
l_int|0x03
)paren
(brace
id|temp
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VGAHDE
op_eq
l_int|1024
)paren
(brace
id|temp
op_assign
l_int|0x20
suffix:semicolon
)brace
)brace
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x0E
comma
l_int|0x10
comma
id|temp
)paren
suffix:semicolon
id|tempebx
op_assign
id|SiS_VDE
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToHiVisionTV
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|temp
op_amp
l_int|0xE0
)paren
)paren
(brace
id|tempebx
op_rshift_assign
l_int|1
suffix:semicolon
)brace
)brace
id|tempcx
op_assign
id|SiS_RVBHRS
suffix:semicolon
id|temp
op_assign
id|tempcx
op_amp
l_int|0x00FF
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x18
comma
id|temp
)paren
suffix:semicolon
id|tempeax
op_assign
id|SiS_VGAVDE
suffix:semicolon
id|tempcx
op_or_assign
l_int|0x4000
suffix:semicolon
r_if
c_cond
(paren
id|tempeax
op_le
id|tempebx
)paren
(brace
id|tempcx
op_assign
(paren
(paren
id|tempcx
op_amp
l_int|0xFF00
)paren
op_xor
l_int|0x4000
)paren
op_or
(paren
id|tempcx
op_amp
l_int|0x00ff
)paren
suffix:semicolon
)brace
r_else
(brace
id|tempeax
op_sub_assign
id|tempebx
suffix:semicolon
)brace
id|push1
op_assign
id|tempcx
suffix:semicolon
id|templong
op_assign
(paren
id|tempeax
op_star
l_int|256
op_star
l_int|1024
)paren
op_mod
id|tempebx
suffix:semicolon
id|tempeax
op_assign
(paren
id|tempeax
op_star
l_int|256
op_star
l_int|1024
)paren
op_div
id|tempebx
suffix:semicolon
id|tempebx
op_assign
id|tempeax
suffix:semicolon
r_if
c_cond
(paren
id|templong
op_ne
l_int|0
)paren
(brace
id|tempebx
op_increment
suffix:semicolon
)brace
id|tempcx
op_assign
id|push1
suffix:semicolon
id|temp
op_assign
(paren
id|USHORT
)paren
(paren
id|tempebx
op_amp
l_int|0x000000FF
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x1B
comma
id|temp
)paren
suffix:semicolon
id|temp
op_assign
(paren
id|USHORT
)paren
(paren
(paren
id|tempebx
op_amp
l_int|0x0000FF00
)paren
op_rshift
l_int|8
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x1A
comma
id|temp
)paren
suffix:semicolon
id|tempbx
op_assign
(paren
id|USHORT
)paren
(paren
id|tempebx
op_rshift
l_int|16
)paren
suffix:semicolon
id|temp
op_assign
id|tempbx
op_amp
l_int|0x00FF
suffix:semicolon
id|temp
op_lshift_assign
l_int|4
suffix:semicolon
id|temp
op_or_assign
(paren
(paren
id|tempcx
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x19
comma
id|temp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x1C
comma
l_int|0x28
)paren
suffix:semicolon
id|tempbx
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* TW: From 630/301B and 650/301LV BIOS */
id|tempax
op_assign
id|SiS_VGAHDE
suffix:semicolon
r_if
c_cond
(paren
id|modeflag
op_amp
id|HalfDCLK
)paren
(brace
id|tempax
op_rshift_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCD
)paren
op_logical_or
(paren
id|SiS_HiVision
op_amp
l_int|0x03
)paren
)paren
(brace
r_if
c_cond
(paren
id|tempax
OG
l_int|800
)paren
(brace
id|tempax
op_sub_assign
l_int|800
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
(paren
id|SiS_VBInfo
op_amp
(paren
id|SetCRT2ToTV
op_or
id|SetCRT2ToHiVisionTV
)paren
)paren
op_logical_and
(paren
op_logical_neg
(paren
id|SiS_HiVision
op_amp
l_int|0x03
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
id|tempax
OG
l_int|800
)paren
(brace
id|tempbx
op_assign
l_int|8
suffix:semicolon
multiline_comment|/* TW: From 630/301B and 650/301LV BIOS */
r_if
c_cond
(paren
id|tempax
op_eq
l_int|1024
)paren
(brace
id|tempax
op_mul_assign
l_int|25
suffix:semicolon
)brace
r_else
id|tempax
op_mul_assign
l_int|20
suffix:semicolon
id|temp
op_assign
id|tempax
op_mod
l_int|32
suffix:semicolon
id|tempax
op_div_assign
l_int|32
suffix:semicolon
id|tempax
op_decrement
suffix:semicolon
r_if
c_cond
(paren
id|temp
op_ne
l_int|0
)paren
id|tempax
op_increment
suffix:semicolon
)brace
)brace
id|tempax
op_decrement
suffix:semicolon
id|temp
op_assign
(paren
id|tempax
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
suffix:semicolon
id|temp
op_and_assign
l_int|0x03
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x1D
comma
id|tempax
op_amp
l_int|0x00FF
)paren
suffix:semicolon
id|temp
op_lshift_assign
l_int|4
suffix:semicolon
id|temp
op_or_assign
id|tempbx
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x1E
comma
id|temp
)paren
suffix:semicolon
id|temp
op_assign
l_int|0x0036
suffix:semicolon
r_if
c_cond
(paren
(paren
id|SiS_VBInfo
op_amp
(paren
id|SetCRT2ToTV
op_minus
id|SetCRT2ToHiVisionTV
)paren
)paren
op_logical_and
(paren
op_logical_neg
(paren
id|SiS_HiVision
op_amp
l_int|0x03
)paren
)paren
)paren
(brace
multiline_comment|/* TW: From 650/301LV BIOS */
id|temp
op_or_assign
l_int|0x01
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
(brace
multiline_comment|/* TW: From 650/301LV BIOS */
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_SetFlag
op_amp
id|TVSimuMode
)paren
)paren
(brace
multiline_comment|/* TW: From 650/301LV BIOS */
id|temp
op_and_assign
l_int|0xFE
suffix:semicolon
)brace
multiline_comment|/* TW: From 650/301LV BIOS */
)brace
)brace
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x1F
comma
l_int|0xC0
comma
id|temp
)paren
suffix:semicolon
id|tempbx
op_assign
(paren
id|SiS_HT
op_rshift
l_int|1
)paren
op_minus
l_int|2
suffix:semicolon
id|temp
op_assign
(paren
(paren
id|tempbx
op_amp
l_int|0x0700
)paren
op_rshift
l_int|8
)paren
op_lshift
l_int|3
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x21
comma
l_int|0xC0
comma
id|temp
)paren
suffix:semicolon
id|temp
op_assign
id|tempbx
op_amp
l_int|0x00FF
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x22
comma
id|temp
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|SiS_VBType
op_amp
(paren
id|VB_SIS301LV
op_or
id|VB_SIS302LV
)paren
)paren
op_logical_and
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCD
)paren
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x24
comma
l_int|0x0e
)paren
suffix:semicolon
)brace
)brace
id|SiS_SetCRT2VCLK
c_func
(paren
id|BaseAddr
comma
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|RefreshRateTableIndex
comma
id|HwDeviceExtension
)paren
suffix:semicolon
)brace
multiline_comment|/* TW: Double-Checked against 650/301LV and 630/301B BIOS */
r_void
DECL|function|SiS_SetCRT2VCLK
id|SiS_SetCRT2VCLK
c_func
(paren
id|USHORT
id|BaseAddr
comma
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
comma
id|USHORT
id|RefreshRateTableIndex
comma
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
)paren
(brace
id|USHORT
id|vclkindex
suffix:semicolon
id|USHORT
id|tempah
comma
id|temp1
suffix:semicolon
id|vclkindex
op_assign
id|SiS_GetVCLK2Ptr
c_func
(paren
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|RefreshRateTableIndex
comma
id|HwDeviceExtension
)paren
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
(brace
id|tempah
op_assign
id|SiS_VBVCLKData
(braket
id|vclkindex
)braket
dot
id|Part4_A
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x0A
comma
id|tempah
)paren
suffix:semicolon
id|tempah
op_assign
id|SiS_VBVCLKData
(braket
id|vclkindex
)braket
dot
id|Part4_B
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x0B
comma
id|tempah
)paren
suffix:semicolon
multiline_comment|/* TW: New from 650/301LV BIOS */
r_if
c_cond
(paren
id|SiS_VBType
op_amp
(paren
id|VB_SIS301LV
op_or
id|VB_SIS302LV
)paren
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetPALTV
)paren
)paren
(brace
r_if
c_cond
(paren
(paren
id|ModeNo
op_eq
l_int|0x4a
)paren
op_logical_or
(paren
id|ModeNo
op_eq
l_int|0x38
)paren
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x0a
comma
l_int|0x57
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x0b
comma
l_int|0x46
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x1f
comma
l_int|0xf6
)paren
suffix:semicolon
)brace
)brace
)brace
)brace
)brace
r_else
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x0A
comma
l_int|0x01
)paren
suffix:semicolon
id|tempah
op_assign
id|SiS_VBVCLKData
(braket
id|vclkindex
)braket
dot
id|Part4_B
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x0B
comma
id|tempah
)paren
suffix:semicolon
id|tempah
op_assign
id|SiS_VBVCLKData
(braket
id|vclkindex
)braket
dot
id|Part4_A
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x0A
comma
id|tempah
)paren
suffix:semicolon
)brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x12
comma
l_int|0x00
)paren
suffix:semicolon
id|tempah
op_assign
l_int|0x08
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToRAMDAC
)paren
(brace
id|tempah
op_or_assign
l_int|0x020
suffix:semicolon
)brace
id|temp1
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x12
)paren
suffix:semicolon
id|tempah
op_or_assign
id|temp1
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x12
comma
id|tempah
)paren
suffix:semicolon
)brace
multiline_comment|/* TW: Double-checked against 650/LVDS (1.10.07), 630/301B/LVDS/LVDS+CH, 650/301LV BIOS */
id|USHORT
DECL|function|SiS_GetVCLK2Ptr
id|SiS_GetVCLK2Ptr
c_func
(paren
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
comma
id|USHORT
id|RefreshRateTableIndex
comma
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
)paren
(brace
id|USHORT
id|tempbx
suffix:semicolon
macro_line|#ifdef SIS300
id|USHORT
id|LCDXlat1VCLK300
(braket
l_int|4
)braket
op_assign
(brace
id|VCLK65
comma
id|VCLK65
comma
id|VCLK65
comma
id|VCLK65
)brace
suffix:semicolon
id|USHORT
id|LCDXlat2VCLK300
(braket
l_int|4
)braket
op_assign
(brace
id|VCLK108_2
comma
id|VCLK108_2
comma
id|VCLK108_2
comma
id|VCLK108_2
)brace
suffix:semicolon
id|USHORT
id|LVDSXlat2VCLK300
(braket
l_int|4
)braket
op_assign
(brace
id|VCLK65
comma
id|VCLK65
comma
id|VCLK65
comma
id|VCLK65
)brace
suffix:semicolon
id|USHORT
id|LVDSXlat3VCLK300
(braket
l_int|4
)braket
op_assign
(brace
id|VCLK65
comma
id|VCLK65
comma
id|VCLK65
comma
id|VCLK65
)brace
suffix:semicolon
macro_line|#endif
macro_line|#ifdef SIS315H
id|USHORT
id|LCDXlat1VCLK310
(braket
l_int|4
)braket
op_assign
(brace
id|VCLK65
op_plus
l_int|2
comma
id|VCLK65
op_plus
l_int|2
comma
id|VCLK65
op_plus
l_int|2
comma
id|VCLK65
op_plus
l_int|2
)brace
suffix:semicolon
id|USHORT
id|LCDXlat2VCLK310
(braket
l_int|4
)braket
op_assign
(brace
id|VCLK108_2
op_plus
l_int|5
comma
id|VCLK108_2
op_plus
l_int|5
comma
id|VCLK108_2
op_plus
l_int|5
comma
id|VCLK108_2
op_plus
l_int|5
)brace
suffix:semicolon
id|USHORT
id|LVDSXlat2VCLK310
(braket
l_int|4
)braket
op_assign
(brace
id|VCLK65
op_plus
l_int|2
comma
id|VCLK65
op_plus
l_int|2
comma
id|VCLK65
op_plus
l_int|2
comma
id|VCLK65
op_plus
l_int|2
)brace
suffix:semicolon
id|USHORT
id|LVDSXlat3VCLK310
(braket
l_int|4
)braket
op_assign
(brace
id|VCLK108_2
op_plus
l_int|5
comma
id|VCLK108_2
op_plus
l_int|5
comma
id|VCLK108_2
op_plus
l_int|5
comma
id|VCLK108_2
op_plus
l_int|5
)brace
suffix:semicolon
multiline_comment|/* {VCLK65+2,   VCLK65+2,   VCLK65+2,   VCLK65+2}; -  650/LVDS 1.10.07 */
macro_line|#endif
id|USHORT
id|LCDXlat0VCLK
(braket
l_int|4
)braket
op_assign
(brace
id|VCLK40
comma
id|VCLK40
comma
id|VCLK40
comma
id|VCLK40
)brace
suffix:semicolon
id|USHORT
id|LVDSXlat1VCLK
(braket
l_int|4
)braket
op_assign
(brace
id|VCLK40
comma
id|VCLK40
comma
id|VCLK40
comma
id|VCLK40
)brace
suffix:semicolon
id|USHORT
id|CRT2Index
comma
id|VCLKIndex
op_assign
l_int|0
suffix:semicolon
id|USHORT
id|modeflag
comma
id|resinfo
suffix:semicolon
id|UCHAR
op_star
id|CHTVVCLKPtr
op_assign
l_int|NULL
suffix:semicolon
id|USHORT
op_star
id|LCDXlatVCLK1
op_assign
l_int|NULL
suffix:semicolon
id|USHORT
op_star
id|LCDXlatVCLK2
op_assign
l_int|NULL
suffix:semicolon
id|USHORT
op_star
id|LVDSXlatVCLK2
op_assign
l_int|NULL
suffix:semicolon
id|USHORT
op_star
id|LVDSXlatVCLK3
op_assign
l_int|NULL
suffix:semicolon
macro_line|#ifdef SIS315H
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
id|LCDXlatVCLK1
op_assign
id|LCDXlat1VCLK310
suffix:semicolon
id|LCDXlatVCLK2
op_assign
id|LCDXlat2VCLK310
suffix:semicolon
id|LVDSXlatVCLK2
op_assign
id|LVDSXlat2VCLK310
suffix:semicolon
id|LVDSXlatVCLK3
op_assign
id|LVDSXlat3VCLK310
suffix:semicolon
)brace
r_else
(brace
macro_line|#endif
macro_line|#ifdef SIS300
id|LCDXlatVCLK1
op_assign
id|LCDXlat1VCLK300
suffix:semicolon
id|LCDXlatVCLK2
op_assign
id|LCDXlat2VCLK300
suffix:semicolon
id|LVDSXlatVCLK2
op_assign
id|LVDSXlat2VCLK300
suffix:semicolon
id|LVDSXlatVCLK3
op_assign
id|LVDSXlat3VCLK300
suffix:semicolon
macro_line|#endif
macro_line|#ifdef SIS315H
)brace
macro_line|#endif
r_if
c_cond
(paren
id|ModeNo
op_le
l_int|0x13
)paren
(brace
id|modeflag
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_ModeFlag
suffix:semicolon
id|resinfo
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_ResInfo
suffix:semicolon
id|CRT2Index
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_CRT2CRTC
suffix:semicolon
)brace
r_else
(brace
id|modeflag
op_assign
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|Ext_ModeFlag
suffix:semicolon
id|resinfo
op_assign
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|Ext_RESINFO
suffix:semicolon
id|CRT2Index
op_assign
id|SiS_RefIndex
(braket
id|RefreshRateTableIndex
)braket
dot
id|Ext_CRT2CRTC
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|0
)paren
(brace
multiline_comment|/* 301 */
r_if
c_cond
(paren
id|SiS_SetFlag
op_amp
id|ProgrammingCRT2
)paren
(brace
id|CRT2Index
op_rshift_assign
l_int|6
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
(paren
id|SetCRT2ToLCD
op_or
id|SetCRT2ToLCDA
)paren
)paren
(brace
multiline_comment|/*  LCD */
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
multiline_comment|/* TW: Inserted from 630/301B BIOS */
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel800x600
)paren
(brace
id|VCLKIndex
op_assign
id|LCDXlat0VCLK
(braket
id|CRT2Index
)braket
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1024x768
)paren
(brace
id|VCLKIndex
op_assign
id|LCDXlatVCLK1
(braket
id|CRT2Index
)braket
suffix:semicolon
)brace
r_else
id|VCLKIndex
op_assign
id|LCDXlatVCLK2
(braket
id|CRT2Index
)braket
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* TW: 650/301LV BIOS does not check expanding, 315 does  */
r_if
c_cond
(paren
(paren
id|HwDeviceExtension-&gt;jChipType
OG
id|SIS_315PRO
)paren
op_logical_or
(paren
op_logical_neg
(paren
id|SiS_LCDInfo
op_amp
id|LCDNonExpanding
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1024x768
)paren
(brace
id|VCLKIndex
op_assign
id|LCDXlatVCLK1
(braket
id|CRT2Index
)braket
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1280x960
)paren
(brace
id|VCLKIndex
op_assign
l_int|0x45
suffix:semicolon
r_if
c_cond
(paren
id|resinfo
op_eq
l_int|0x09
)paren
(brace
id|VCLKIndex
op_increment
suffix:semicolon
)brace
)brace
r_else
(brace
id|VCLKIndex
op_assign
id|LCDXlatVCLK2
(braket
id|CRT2Index
)braket
suffix:semicolon
)brace
)brace
r_else
(brace
id|VCLKIndex
op_assign
(paren
id|UCHAR
)paren
id|SiS_GetReg2
c_func
(paren
(paren
id|USHORT
)paren
(paren
id|SiS_P3ca
op_plus
l_int|0x02
)paren
)paren
suffix:semicolon
multiline_comment|/*  Port 3cch */
id|VCLKIndex
op_assign
(paren
(paren
id|VCLKIndex
op_rshift
l_int|2
)paren
op_amp
l_int|0x03
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ModeNo
OG
l_int|0x13
)paren
(brace
id|VCLKIndex
op_assign
id|SiS_RefIndex
(braket
id|RefreshRateTableIndex
)braket
dot
id|Ext_CRTVCLK
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ModeNo
op_le
l_int|0x13
)paren
(brace
multiline_comment|/* TW: Inserted from 315 BIOS */
r_if
c_cond
(paren
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_CRT2CRTC
op_eq
l_int|1
)paren
(brace
id|VCLKIndex
op_assign
l_int|0x42
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|VCLKIndex
op_eq
l_int|0
)paren
(brace
id|VCLKIndex
op_assign
l_int|0x41
suffix:semicolon
)brace
r_if
c_cond
(paren
id|VCLKIndex
op_eq
l_int|1
)paren
(brace
id|VCLKIndex
op_assign
l_int|0x43
suffix:semicolon
)brace
r_if
c_cond
(paren
id|VCLKIndex
op_eq
l_int|4
)paren
(brace
id|VCLKIndex
op_assign
l_int|0x44
suffix:semicolon
)brace
)brace
)brace
)brace
r_else
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
(brace
multiline_comment|/*  TV */
r_if
c_cond
(paren
(paren
id|SiS_IF_DEF_HiVision
op_eq
l_int|1
)paren
op_logical_and
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToHiVisionTV
)paren
)paren
(brace
r_if
c_cond
(paren
id|SiS_SetFlag
op_amp
id|RPLLDIV2XO
)paren
(brace
id|VCLKIndex
op_assign
id|HiTVVCLKDIV2
suffix:semicolon
)brace
r_else
id|VCLKIndex
op_assign
id|HiTVVCLK
suffix:semicolon
r_if
c_cond
(paren
id|SiS_SetFlag
op_amp
id|TVSimuMode
)paren
(brace
r_if
c_cond
(paren
id|modeflag
op_amp
id|Charx8Dot
)paren
(brace
id|VCLKIndex
op_assign
id|HiTVSimuVCLK
suffix:semicolon
)brace
r_else
id|VCLKIndex
op_assign
id|HiTVTextVCLK
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|SiS_SetFlag
op_amp
id|RPLLDIV2XO
)paren
(brace
id|VCLKIndex
op_assign
id|TVVCLKDIV2
suffix:semicolon
)brace
r_else
id|VCLKIndex
op_assign
id|TVVCLK
suffix:semicolon
)brace
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ge
id|SIS_315H
)paren
(brace
id|VCLKIndex
op_add_assign
l_int|25
suffix:semicolon
)brace
)brace
r_else
(brace
multiline_comment|/* RAMDAC2 */
id|VCLKIndex
op_assign
(paren
id|UCHAR
)paren
id|SiS_GetReg2
c_func
(paren
(paren
id|USHORT
)paren
(paren
id|SiS_P3ca
op_plus
l_int|0x02
)paren
)paren
suffix:semicolon
id|VCLKIndex
op_assign
(paren
(paren
id|VCLKIndex
op_rshift
l_int|2
)paren
op_amp
l_int|0x03
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ModeNo
OG
l_int|0x13
)paren
(brace
id|VCLKIndex
op_assign
id|SiS_RefIndex
(braket
id|RefreshRateTableIndex
)braket
dot
id|Ext_CRTVCLK
suffix:semicolon
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
id|VCLKIndex
op_and_assign
l_int|0x3f
suffix:semicolon
r_if
c_cond
(paren
(paren
id|HwDeviceExtension-&gt;jChipType
op_eq
id|SIS_630
)paren
op_logical_and
(paren
id|HwDeviceExtension-&gt;jChipRevision
op_ge
l_int|0x30
)paren
)paren
(brace
r_if
c_cond
(paren
id|VCLKIndex
op_eq
l_int|0x14
)paren
(brace
id|VCLKIndex
op_assign
l_int|0x2e
suffix:semicolon
)brace
)brace
)brace
)brace
)brace
)brace
r_else
(brace
multiline_comment|/* If not programming CRT2 */
id|VCLKIndex
op_assign
(paren
id|UCHAR
)paren
id|SiS_GetReg2
c_func
(paren
(paren
id|USHORT
)paren
(paren
id|SiS_P3ca
op_plus
l_int|0x02
)paren
)paren
suffix:semicolon
id|VCLKIndex
op_assign
(paren
(paren
id|VCLKIndex
op_rshift
l_int|2
)paren
op_amp
l_int|0x03
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ModeNo
OG
l_int|0x13
)paren
(brace
id|VCLKIndex
op_assign
id|SiS_RefIndex
(braket
id|RefreshRateTableIndex
)braket
dot
id|Ext_CRTVCLK
suffix:semicolon
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
id|VCLKIndex
op_and_assign
l_int|0x3f
suffix:semicolon
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ne
id|SIS_630
)paren
(brace
r_if
c_cond
(paren
id|VCLKIndex
op_eq
l_int|0x1b
)paren
(brace
id|VCLKIndex
op_assign
l_int|0x35
suffix:semicolon
)brace
)brace
)brace
)brace
)brace
)brace
r_else
(brace
multiline_comment|/*   LVDS  */
id|VCLKIndex
op_assign
id|CRT2Index
suffix:semicolon
r_if
c_cond
(paren
id|SiS_SetFlag
op_amp
id|ProgrammingCRT2
)paren
(brace
multiline_comment|/* programming CRT2 */
r_if
c_cond
(paren
(paren
id|SiS_IF_DEF_CH70xx
op_ne
l_int|0
)paren
op_logical_and
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
)paren
(brace
id|VCLKIndex
op_and_assign
l_int|0x1f
suffix:semicolon
id|tempbx
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetPALTV
)paren
(brace
id|tempbx
op_add_assign
l_int|2
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCHTVOverScan
)paren
(brace
id|tempbx
op_add_assign
l_int|1
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|tempbx
)paren
(brace
r_case
l_int|0
suffix:colon
id|CHTVVCLKPtr
op_assign
id|SiS_CHTVVCLKUNTSC
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|CHTVVCLKPtr
op_assign
id|SiS_CHTVVCLKONTSC
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|CHTVVCLKPtr
op_assign
id|SiS_CHTVVCLKUPAL
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
id|CHTVVCLKPtr
op_assign
id|SiS_CHTVVCLKOPAL
suffix:semicolon
r_break
suffix:semicolon
)brace
id|VCLKIndex
op_assign
id|CHTVVCLKPtr
(braket
id|VCLKIndex
)braket
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCD
)paren
(brace
id|VCLKIndex
op_rshift_assign
l_int|6
suffix:semicolon
r_if
c_cond
(paren
(paren
id|SiS_LCDResInfo
op_eq
id|Panel800x600
)paren
op_logical_or
(paren
id|SiS_LCDResInfo
op_eq
id|Panel320x480
)paren
)paren
(brace
id|VCLKIndex
op_assign
id|LVDSXlat1VCLK
(braket
id|VCLKIndex
)braket
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1024x768
)paren
(brace
id|VCLKIndex
op_assign
id|LVDSXlatVCLK2
(braket
id|VCLKIndex
)braket
suffix:semicolon
)brace
r_else
id|VCLKIndex
op_assign
id|LVDSXlatVCLK3
(braket
id|VCLKIndex
)braket
suffix:semicolon
)brace
r_else
(brace
id|VCLKIndex
op_assign
(paren
id|UCHAR
)paren
id|SiS_GetReg2
c_func
(paren
(paren
id|USHORT
)paren
(paren
id|SiS_P3ca
op_plus
l_int|0x02
)paren
)paren
suffix:semicolon
id|VCLKIndex
op_assign
(paren
(paren
id|VCLKIndex
op_rshift
l_int|2
)paren
op_amp
l_int|0x03
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ModeNo
OG
l_int|0x13
)paren
(brace
id|VCLKIndex
op_assign
id|SiS_RefIndex
(braket
id|RefreshRateTableIndex
)braket
dot
id|Ext_CRTVCLK
suffix:semicolon
r_if
c_cond
(paren
(paren
id|HwDeviceExtension-&gt;jChipType
op_eq
id|SIS_630
)paren
op_logical_and
(paren
id|HwDeviceExtension-&gt;jChipRevision
op_ge
l_int|0x30
)paren
)paren
(brace
r_if
c_cond
(paren
id|VCLKIndex
op_eq
l_int|0x14
)paren
(brace
id|VCLKIndex
op_assign
l_int|0x2e
suffix:semicolon
)brace
)brace
)brace
)brace
)brace
r_else
(brace
multiline_comment|/* if not programming CRT2 */
id|VCLKIndex
op_assign
(paren
id|UCHAR
)paren
id|SiS_GetReg2
c_func
(paren
(paren
id|USHORT
)paren
(paren
id|SiS_P3ca
op_plus
l_int|0x02
)paren
)paren
suffix:semicolon
id|VCLKIndex
op_assign
(paren
(paren
id|VCLKIndex
op_rshift
l_int|2
)paren
op_amp
l_int|0x03
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ModeNo
OG
l_int|0x13
)paren
(brace
id|VCLKIndex
op_assign
id|SiS_RefIndex
(braket
id|RefreshRateTableIndex
)braket
dot
id|Ext_CRTVCLK
suffix:semicolon
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
op_ne
id|SIS_630
)paren
(brace
r_if
c_cond
(paren
id|VCLKIndex
op_eq
l_int|0x1b
)paren
(brace
id|VCLKIndex
op_assign
l_int|0x35
suffix:semicolon
)brace
)brace
)brace
)brace
)brace
)brace
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
id|VCLKIndex
op_and_assign
l_int|0x3F
suffix:semicolon
)brace
r_return
(paren
id|VCLKIndex
)paren
suffix:semicolon
)brace
multiline_comment|/* TW: Set 301 Palette address port registers */
multiline_comment|/* TW: Checked against 650/301LV BIOS */
r_void
DECL|function|SiS_SetGroup5
id|SiS_SetGroup5
c_func
(paren
id|USHORT
id|BaseAddr
comma
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
)paren
(brace
r_if
c_cond
(paren
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
op_logical_and
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCDA
)paren
)paren
(brace
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_ModeType
op_eq
id|ModeVGA
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
(paren
id|SetInSlaveMode
op_or
id|LoadDACFlag
)paren
)paren
)paren
(brace
id|SiS_EnableCRT2
c_func
(paren
)paren
suffix:semicolon
id|SiS_LoadDAC2
c_func
(paren
id|ROMAddr
comma
id|SiS_Part5Port
comma
id|ModeNo
comma
id|ModeIdIndex
)paren
suffix:semicolon
)brace
)brace
r_return
suffix:semicolon
)brace
multiline_comment|/* TW: Checked against 650/301LV BIOS */
r_void
DECL|function|SiS_LoadDAC2
id|SiS_LoadDAC2
c_func
(paren
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|SiS_Part5Port
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
)paren
(brace
id|USHORT
id|data
comma
id|data2
suffix:semicolon
id|USHORT
id|time
comma
id|i
comma
id|j
comma
id|k
suffix:semicolon
id|USHORT
id|m
comma
id|n
comma
id|o
suffix:semicolon
id|USHORT
id|si
comma
id|di
comma
id|bx
comma
id|dl
suffix:semicolon
id|USHORT
id|al
comma
id|ah
comma
id|dh
suffix:semicolon
id|USHORT
op_star
id|table
op_assign
l_int|0
suffix:semicolon
id|USHORT
id|Pindex
comma
id|Pdata
comma
id|modeflag
suffix:semicolon
multiline_comment|/* if(SiS_SetFlag &amp; SetDispDevSwitchFlag) return;  - TW: Not needed */
r_if
c_cond
(paren
id|ModeNo
op_le
l_int|0x13
)paren
(brace
id|modeflag
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_ModeFlag
suffix:semicolon
)brace
multiline_comment|/* si+St_ResInfo */
r_else
id|modeflag
op_assign
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|Ext_ModeFlag
suffix:semicolon
multiline_comment|/* si+Ext_ResInfo */
macro_line|#if 0
r_if
c_cond
(paren
op_logical_neg
(paren
id|ds
suffix:colon
l_int|489
op_amp
l_int|0x08
)paren
)paren
(brace
macro_line|#endif
id|Pindex
op_assign
id|SiS_Part5Port
suffix:semicolon
id|Pdata
op_assign
id|SiS_Part5Port
op_plus
l_int|1
suffix:semicolon
id|data
op_assign
id|modeflag
op_amp
id|DACInfoFlag
suffix:semicolon
id|time
op_assign
l_int|64
suffix:semicolon
r_if
c_cond
(paren
id|data
op_eq
l_int|0x00
)paren
(brace
id|table
op_assign
id|SiS_MDA_DAC
suffix:semicolon
)brace
r_if
c_cond
(paren
id|data
op_eq
l_int|0x08
)paren
(brace
id|table
op_assign
id|SiS_CGA_DAC
suffix:semicolon
)brace
r_if
c_cond
(paren
id|data
op_eq
l_int|0x10
)paren
(brace
id|table
op_assign
id|SiS_EGA_DAC
suffix:semicolon
)brace
r_if
c_cond
(paren
id|data
op_eq
l_int|0x18
)paren
(brace
id|time
op_assign
l_int|256
suffix:semicolon
id|table
op_assign
id|SiS_VGA_DAC
suffix:semicolon
)brace
r_if
c_cond
(paren
id|time
op_eq
l_int|256
)paren
(brace
id|j
op_assign
l_int|16
suffix:semicolon
)brace
r_else
id|j
op_assign
id|time
suffix:semicolon
id|SiS_SetReg3
c_func
(paren
id|Pindex
comma
l_int|0x00
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|j
suffix:semicolon
id|i
op_increment
)paren
(brace
id|data
op_assign
id|table
(braket
id|i
)braket
suffix:semicolon
r_for
c_loop
(paren
id|k
op_assign
l_int|0
suffix:semicolon
id|k
OL
l_int|3
suffix:semicolon
id|k
op_increment
)paren
(brace
id|data2
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|data
op_amp
l_int|0x01
)paren
(brace
id|data2
op_assign
l_int|0x2A
suffix:semicolon
)brace
r_if
c_cond
(paren
id|data
op_amp
l_int|0x02
)paren
(brace
id|data2
op_add_assign
l_int|0x15
suffix:semicolon
)brace
id|data2
op_lshift_assign
l_int|2
suffix:semicolon
multiline_comment|/* TW: New from 650/301LV BIOS */
id|SiS_SetReg3
c_func
(paren
id|Pdata
comma
id|data2
)paren
suffix:semicolon
id|data
op_rshift_assign
l_int|2
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|time
op_eq
l_int|256
)paren
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|16
suffix:semicolon
id|i
OL
l_int|32
suffix:semicolon
id|i
op_increment
)paren
(brace
id|data
op_assign
id|table
(braket
id|i
)braket
suffix:semicolon
id|data
op_lshift_assign
l_int|2
suffix:semicolon
multiline_comment|/* TW: New from 650/301LV BIOS */
r_for
c_loop
(paren
id|k
op_assign
l_int|0
suffix:semicolon
id|k
OL
l_int|3
suffix:semicolon
id|k
op_increment
)paren
(brace
id|SiS_SetReg3
c_func
(paren
id|Pdata
comma
id|data
)paren
suffix:semicolon
)brace
)brace
id|si
op_assign
l_int|32
suffix:semicolon
r_for
c_loop
(paren
id|m
op_assign
l_int|0
suffix:semicolon
id|m
OL
l_int|9
suffix:semicolon
id|m
op_increment
)paren
(brace
id|di
op_assign
id|si
suffix:semicolon
id|bx
op_assign
id|si
op_plus
l_int|0x04
suffix:semicolon
id|dl
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|n
op_assign
l_int|0
suffix:semicolon
id|n
OL
l_int|3
suffix:semicolon
id|n
op_increment
)paren
(brace
r_for
c_loop
(paren
id|o
op_assign
l_int|0
suffix:semicolon
id|o
OL
l_int|5
suffix:semicolon
id|o
op_increment
)paren
(brace
id|dh
op_assign
id|table
(braket
id|si
)braket
suffix:semicolon
id|ah
op_assign
id|table
(braket
id|di
)braket
suffix:semicolon
id|al
op_assign
id|table
(braket
id|bx
)braket
suffix:semicolon
id|si
op_increment
suffix:semicolon
id|SiS_WriteDAC2
c_func
(paren
id|Pdata
comma
id|dl
comma
id|ah
comma
id|al
comma
id|dh
)paren
suffix:semicolon
)brace
multiline_comment|/* for 5 */
id|si
op_assign
id|si
op_minus
l_int|2
suffix:semicolon
r_for
c_loop
(paren
id|o
op_assign
l_int|0
suffix:semicolon
id|o
OL
l_int|3
suffix:semicolon
id|o
op_increment
)paren
(brace
id|dh
op_assign
id|table
(braket
id|bx
)braket
suffix:semicolon
id|ah
op_assign
id|table
(braket
id|di
)braket
suffix:semicolon
id|al
op_assign
id|table
(braket
id|si
)braket
suffix:semicolon
id|si
op_decrement
suffix:semicolon
id|SiS_WriteDAC2
c_func
(paren
id|Pdata
comma
id|dl
comma
id|ah
comma
id|al
comma
id|dh
)paren
suffix:semicolon
)brace
multiline_comment|/* for 3 */
id|dl
op_increment
suffix:semicolon
)brace
multiline_comment|/* for 3 */
id|si
op_assign
id|si
op_plus
l_int|5
suffix:semicolon
)brace
multiline_comment|/* for 9 */
)brace
macro_line|#if 0
)brace
multiline_comment|/* ds:489 &amp; 0x08 */
macro_line|#endif
)brace
multiline_comment|/* TW: Checked against 650/301LV BIOS */
r_void
DECL|function|SiS_WriteDAC2
id|SiS_WriteDAC2
c_func
(paren
id|USHORT
id|Pdata
comma
id|USHORT
id|dl
comma
id|USHORT
id|ah
comma
id|USHORT
id|al
comma
id|USHORT
id|dh
)paren
(brace
id|USHORT
id|temp
suffix:semicolon
id|USHORT
id|bh
comma
id|bl
suffix:semicolon
id|bh
op_assign
id|ah
suffix:semicolon
id|bl
op_assign
id|al
suffix:semicolon
r_if
c_cond
(paren
id|dl
op_ne
l_int|0
)paren
(brace
id|temp
op_assign
id|bh
suffix:semicolon
id|bh
op_assign
id|dh
suffix:semicolon
id|dh
op_assign
id|temp
suffix:semicolon
r_if
c_cond
(paren
id|dl
op_eq
l_int|1
)paren
(brace
id|temp
op_assign
id|bl
suffix:semicolon
id|bl
op_assign
id|dh
suffix:semicolon
id|dh
op_assign
id|temp
suffix:semicolon
)brace
r_else
(brace
id|temp
op_assign
id|bl
suffix:semicolon
id|bl
op_assign
id|bh
suffix:semicolon
id|bh
op_assign
id|temp
suffix:semicolon
)brace
)brace
id|dh
op_lshift_assign
l_int|2
suffix:semicolon
multiline_comment|/* TW: New from 650/301LV BIOS */
id|bh
op_lshift_assign
l_int|2
suffix:semicolon
multiline_comment|/* TW: New from 650/301LV BIOS */
id|bl
op_lshift_assign
l_int|2
suffix:semicolon
multiline_comment|/* TW: New from 650/301LV BIOS */
id|SiS_SetReg3
c_func
(paren
id|Pdata
comma
(paren
id|USHORT
)paren
id|dh
)paren
suffix:semicolon
id|SiS_SetReg3
c_func
(paren
id|Pdata
comma
(paren
id|USHORT
)paren
id|bh
)paren
suffix:semicolon
id|SiS_SetReg3
c_func
(paren
id|Pdata
comma
(paren
id|USHORT
)paren
id|bl
)paren
suffix:semicolon
)brace
multiline_comment|/* TW: Checked against 650/LVDS and 630/301B BIOS */
r_void
DECL|function|SiS_ModCRT1CRTC
id|SiS_ModCRT1CRTC
c_func
(paren
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
comma
id|USHORT
id|RefreshRateTableIndex
comma
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
)paren
(brace
id|USHORT
id|temp
comma
id|tempah
comma
id|i
comma
id|modeflag
comma
id|j
suffix:semicolon
id|USHORT
id|ResInfo
comma
id|DisplayType
suffix:semicolon
id|SiS_LVDSCRT1DataStruct
op_star
id|LVDSCRT1Ptr
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
id|ModeNo
op_le
l_int|0x13
)paren
(brace
id|modeflag
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_ModeFlag
suffix:semicolon
)brace
r_else
(brace
id|modeflag
op_assign
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|Ext_ModeFlag
suffix:semicolon
)brace
id|temp
op_assign
id|SiS_GetLVDSCRT1Ptr
c_func
(paren
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|RefreshRateTableIndex
comma
op_amp
id|ResInfo
comma
op_amp
id|DisplayType
)paren
suffix:semicolon
r_if
c_cond
(paren
id|temp
op_eq
l_int|0
)paren
(brace
r_return
suffix:semicolon
)brace
multiline_comment|/* TW: Inserted from 630/LVDS BIOS */
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
r_if
c_cond
(paren
id|SiS_SetFlag
op_amp
id|CRT2IsVGA
)paren
(brace
r_return
suffix:semicolon
)brace
)brace
r_switch
c_cond
(paren
id|DisplayType
)paren
(brace
r_case
l_int|0
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT1800x600_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11024x768_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11280x1024_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT1800x600_1_H
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|4
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11024x768_1_H
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|5
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11280x1024_1_H
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|6
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT1800x600_2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|7
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11024x768_2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|8
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11280x1024_2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|9
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT1800x600_2_H
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|10
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11024x768_2_H
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|11
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11280x1024_2_H
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|12
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT1XXXxXXX_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|13
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT1XXXxXXX_1_H
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|14
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11400x1050_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|15
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11400x1050_1_H
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|16
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11400x1050_2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|17
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11400x1050_2_H
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|18
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_CHTVCRT1UNTSC
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|19
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_CHTVCRT1ONTSC
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|20
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_CHTVCRT1UPAL
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|21
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_CHTVCRT1OPAL
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|22
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT1320x480_1
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* FSTN */
r_case
l_int|23
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11024x600_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|24
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11024x600_1_H
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|25
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11024x600_2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|26
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11024x600_2_H
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|27
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11152x768_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|28
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11152x768_1_H
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|29
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11152x768_2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|30
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11152x768_2_H
suffix:semicolon
r_break
suffix:semicolon
)brace
id|SiS_SetRegAND
c_func
(paren
id|SiS_P3d4
comma
l_int|0x11
comma
l_int|0x7f
)paren
suffix:semicolon
multiline_comment|/*unlock cr0-7  */
id|tempah
op_assign
(paren
id|LVDSCRT1Ptr
op_plus
id|ResInfo
)paren
op_member_access_from_pointer
id|CR
(braket
l_int|0
)braket
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x00
comma
id|tempah
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0x02
comma
id|j
op_assign
l_int|1
suffix:semicolon
id|i
op_le
l_int|0x05
suffix:semicolon
id|i
op_increment
comma
id|j
op_increment
)paren
(brace
id|tempah
op_assign
(paren
id|LVDSCRT1Ptr
op_plus
id|ResInfo
)paren
op_member_access_from_pointer
id|CR
(braket
id|j
)braket
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_P3d4
comma
id|i
comma
id|tempah
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0x06
comma
id|j
op_assign
l_int|5
suffix:semicolon
id|i
op_le
l_int|0x07
suffix:semicolon
id|i
op_increment
comma
id|j
op_increment
)paren
(brace
id|tempah
op_assign
(paren
id|LVDSCRT1Ptr
op_plus
id|ResInfo
)paren
op_member_access_from_pointer
id|CR
(braket
id|j
)braket
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_P3d4
comma
id|i
comma
id|tempah
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0x10
comma
id|j
op_assign
l_int|7
suffix:semicolon
id|i
op_le
l_int|0x11
suffix:semicolon
id|i
op_increment
comma
id|j
op_increment
)paren
(brace
id|tempah
op_assign
(paren
id|LVDSCRT1Ptr
op_plus
id|ResInfo
)paren
op_member_access_from_pointer
id|CR
(braket
id|j
)braket
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_P3d4
comma
id|i
comma
id|tempah
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0x15
comma
id|j
op_assign
l_int|9
suffix:semicolon
id|i
op_le
l_int|0x16
suffix:semicolon
id|i
op_increment
comma
id|j
op_increment
)paren
(brace
id|tempah
op_assign
(paren
id|LVDSCRT1Ptr
op_plus
id|ResInfo
)paren
op_member_access_from_pointer
id|CR
(braket
id|j
)braket
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_P3d4
comma
id|i
comma
id|tempah
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0x0A
comma
id|j
op_assign
l_int|11
suffix:semicolon
id|i
op_le
l_int|0x0C
suffix:semicolon
id|i
op_increment
comma
id|j
op_increment
)paren
(brace
id|tempah
op_assign
(paren
id|LVDSCRT1Ptr
op_plus
id|ResInfo
)paren
op_member_access_from_pointer
id|CR
(braket
id|j
)braket
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_P3c4
comma
id|i
comma
id|tempah
)paren
suffix:semicolon
)brace
id|tempah
op_assign
(paren
id|LVDSCRT1Ptr
op_plus
id|ResInfo
)paren
op_member_access_from_pointer
id|CR
(braket
l_int|14
)braket
suffix:semicolon
id|tempah
op_and_assign
l_int|0xE0
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_P3c4
comma
l_int|0x0E
comma
l_int|0x1f
comma
id|tempah
)paren
suffix:semicolon
multiline_comment|/* TW: Modfied (650/LVDS); Was SetReg(tempah) */
id|tempah
op_assign
(paren
id|LVDSCRT1Ptr
op_plus
id|ResInfo
)paren
op_member_access_from_pointer
id|CR
(braket
l_int|14
)braket
suffix:semicolon
id|tempah
op_and_assign
l_int|0x01
suffix:semicolon
id|tempah
op_lshift_assign
l_int|5
suffix:semicolon
r_if
c_cond
(paren
id|modeflag
op_amp
id|DoubleScanMode
)paren
(brace
id|tempah
op_or_assign
l_int|0x080
suffix:semicolon
)brace
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_P3d4
comma
l_int|0x09
comma
op_complement
l_int|0x020
comma
id|tempah
)paren
suffix:semicolon
multiline_comment|/* TW: Inserted from 650/LVDS BIOS */
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
(brace
r_if
c_cond
(paren
id|modeflag
op_amp
id|HalfDCLK
)paren
(brace
id|SiS_SetRegAND
c_func
(paren
id|SiS_P3d4
comma
l_int|0x11
comma
l_int|0x7f
)paren
suffix:semicolon
)brace
)brace
r_return
suffix:semicolon
)brace
macro_line|#if 0 /* TW: Unused */
multiline_comment|/*301b*/
r_void
id|SiS_CHACRT1CRTC
c_func
(paren
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
comma
id|USHORT
id|RefreshRateTableIndex
)paren
(brace
id|USHORT
id|temp
comma
id|tempah
comma
id|i
comma
id|modeflag
comma
id|j
suffix:semicolon
id|USHORT
id|ResInfo
comma
id|DisplayType
suffix:semicolon
id|SiS_LVDSCRT1DataStruct
op_star
id|LVDSCRT1Ptr
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
id|ModeNo
op_le
l_int|0x13
)paren
(brace
id|modeflag
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_ModeFlag
suffix:semicolon
multiline_comment|/* si+St_ResInfo */
)brace
r_else
(brace
id|modeflag
op_assign
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|Ext_ModeFlag
suffix:semicolon
multiline_comment|/* si+Ext_ResInfo */
)brace
id|temp
op_assign
id|SiS_GetLVDSCRT1Ptr
c_func
(paren
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|RefreshRateTableIndex
comma
op_amp
id|ResInfo
comma
op_amp
id|DisplayType
)paren
suffix:semicolon
r_if
c_cond
(paren
id|temp
op_eq
l_int|0
)paren
(brace
r_return
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|DisplayType
)paren
(brace
r_case
l_int|0
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT1800x600_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11024x768_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11280x1024_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT1800x600_1_H
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|4
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11024x768_1_H
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|5
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11280x1024_1_H
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|6
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT1800x600_2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|7
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11024x768_2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|8
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11280x1024_2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|9
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT1800x600_2_H
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|10
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11024x768_2_H
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|11
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11280x1024_2_H
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|12
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT1XXXxXXX_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|13
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT1XXXxXXX_1_H
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|14
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11400x1050_1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|15
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11400x1050_1_H
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|16
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11400x1050_2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|17
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT11400x1050_2_H
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|18
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_CHTVCRT1UNTSC
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|19
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_CHTVCRT1ONTSC
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|20
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_CHTVCRT1UPAL
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|21
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_CHTVCRT1OPAL
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|22
suffix:colon
id|LVDSCRT1Ptr
op_assign
id|SiS_LVDSCRT1320x480_1
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* FSTN */
)brace
id|tempah
op_assign
(paren
id|UCHAR
)paren
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x11
)paren
suffix:semicolon
multiline_comment|/*unlock cr0-7  */
id|tempah
op_assign
id|tempah
op_amp
l_int|0x7F
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x11
comma
id|tempah
)paren
suffix:semicolon
id|tempah
op_assign
(paren
id|LVDSCRT1Ptr
op_plus
id|ResInfo
)paren
op_member_access_from_pointer
id|CR
(braket
l_int|0
)braket
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x0
comma
id|tempah
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0x02
comma
id|j
op_assign
l_int|1
suffix:semicolon
id|i
op_le
l_int|0x05
suffix:semicolon
id|i
op_increment
comma
id|j
op_increment
)paren
(brace
id|tempah
op_assign
(paren
id|LVDSCRT1Ptr
op_plus
id|ResInfo
)paren
op_member_access_from_pointer
id|CR
(braket
id|j
)braket
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_P3d4
comma
id|i
comma
id|tempah
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0x06
comma
id|j
op_assign
l_int|5
suffix:semicolon
id|i
op_le
l_int|0x07
suffix:semicolon
id|i
op_increment
comma
id|j
op_increment
)paren
(brace
id|tempah
op_assign
(paren
id|LVDSCRT1Ptr
op_plus
id|ResInfo
)paren
op_member_access_from_pointer
id|CR
(braket
id|j
)braket
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_P3d4
comma
id|i
comma
id|tempah
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0x10
comma
id|j
op_assign
l_int|7
suffix:semicolon
id|i
op_le
l_int|0x11
suffix:semicolon
id|i
op_increment
comma
id|j
op_increment
)paren
(brace
id|tempah
op_assign
(paren
id|LVDSCRT1Ptr
op_plus
id|ResInfo
)paren
op_member_access_from_pointer
id|CR
(braket
id|j
)braket
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_P3d4
comma
id|i
comma
id|tempah
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0x15
comma
id|j
op_assign
l_int|9
suffix:semicolon
id|i
op_le
l_int|0x16
suffix:semicolon
id|i
op_increment
comma
id|j
op_increment
)paren
(brace
id|tempah
op_assign
(paren
id|LVDSCRT1Ptr
op_plus
id|ResInfo
)paren
op_member_access_from_pointer
id|CR
(braket
id|j
)braket
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_P3d4
comma
id|i
comma
id|tempah
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0x0A
comma
id|j
op_assign
l_int|11
suffix:semicolon
id|i
op_le
l_int|0x0C
suffix:semicolon
id|i
op_increment
comma
id|j
op_increment
)paren
(brace
id|tempah
op_assign
(paren
id|LVDSCRT1Ptr
op_plus
id|ResInfo
)paren
op_member_access_from_pointer
id|CR
(braket
id|j
)braket
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_P3c4
comma
id|i
comma
id|tempah
)paren
suffix:semicolon
)brace
id|tempah
op_assign
(paren
id|LVDSCRT1Ptr
op_plus
id|ResInfo
)paren
op_member_access_from_pointer
id|CR
(braket
l_int|14
)braket
suffix:semicolon
id|tempah
op_assign
id|tempah
op_amp
l_int|0x0E0
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x0E
comma
id|tempah
)paren
suffix:semicolon
id|tempah
op_assign
(paren
id|LVDSCRT1Ptr
op_plus
id|ResInfo
)paren
op_member_access_from_pointer
id|CR
(braket
l_int|14
)braket
suffix:semicolon
id|tempah
op_assign
id|tempah
op_amp
l_int|0x01
suffix:semicolon
id|tempah
op_assign
id|tempah
op_lshift
l_int|5
suffix:semicolon
r_if
c_cond
(paren
id|modeflag
op_amp
id|DoubleScanMode
)paren
(brace
id|tempah
op_assign
id|tempah
op_or
l_int|0x080
suffix:semicolon
)brace
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_P3d4
comma
l_int|0x09
comma
op_complement
l_int|0x020
comma
id|tempah
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
multiline_comment|/*add for LCDA*/
macro_line|#endif
id|BOOLEAN
DECL|function|SiS_GetLCDACRT1Ptr
id|SiS_GetLCDACRT1Ptr
c_func
(paren
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
comma
id|USHORT
id|RefreshRateTableIndex
comma
id|USHORT
op_star
id|ResInfo
comma
id|USHORT
op_star
id|DisplayType
)paren
(brace
id|USHORT
id|tempbx
op_assign
l_int|0
comma
id|modeflag
op_assign
l_int|0
suffix:semicolon
id|USHORT
id|CRT2CRTC
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|ModeNo
op_le
l_int|0x13
)paren
(brace
id|modeflag
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_ModeFlag
suffix:semicolon
id|CRT2CRTC
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_CRT2CRTC
suffix:semicolon
)brace
r_else
(brace
id|modeflag
op_assign
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|Ext_ModeFlag
suffix:semicolon
id|CRT2CRTC
op_assign
id|SiS_RefIndex
(braket
id|RefreshRateTableIndex
)braket
dot
id|Ext_CRT2CRTC
suffix:semicolon
)brace
id|tempbx
op_assign
id|SiS_LCDResInfo
op_minus
id|PanelMinLVDS
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDInfo
op_amp
id|LCDNonExpanding
)paren
(brace
id|tempbx
op_add_assign
l_int|6
suffix:semicolon
)brace
r_if
c_cond
(paren
id|modeflag
op_amp
id|HalfDCLK
)paren
(brace
id|tempbx
op_add_assign
l_int|3
suffix:semicolon
)brace
op_star
id|ResInfo
op_assign
id|CRT2CRTC
op_amp
l_int|0x3F
suffix:semicolon
op_star
id|DisplayType
op_assign
id|tempbx
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
multiline_comment|/* TW: Checked against 650/LVDS BIOS: modified for new panel resolutions */
id|BOOLEAN
DECL|function|SiS_GetLVDSCRT1Ptr
id|SiS_GetLVDSCRT1Ptr
c_func
(paren
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
comma
id|USHORT
id|RefreshRateTableIndex
comma
id|USHORT
op_star
id|ResInfo
comma
id|USHORT
op_star
id|DisplayType
)paren
(brace
id|USHORT
id|tempbx
comma
id|modeflag
op_assign
l_int|0
suffix:semicolon
id|USHORT
id|Flag
comma
id|CRT2CRTC
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCDA
)paren
)paren
(brace
multiline_comment|/* TW: Inserted from 650/LVDS BIOS */
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
)brace
multiline_comment|/* TW: Inserted from 650/LVDS BIOS */
r_if
c_cond
(paren
id|ModeNo
op_le
l_int|0x13
)paren
(brace
id|modeflag
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_ModeFlag
suffix:semicolon
id|CRT2CRTC
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_CRT2CRTC
suffix:semicolon
)brace
r_else
(brace
id|modeflag
op_assign
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|Ext_ModeFlag
suffix:semicolon
id|CRT2CRTC
op_assign
id|SiS_RefIndex
(braket
id|RefreshRateTableIndex
)braket
dot
id|Ext_CRT2CRTC
suffix:semicolon
)brace
id|Flag
op_assign
l_int|1
suffix:semicolon
id|tempbx
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_CH70xx
op_ne
l_int|0
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCD
)paren
)paren
(brace
id|Flag
op_assign
l_int|0
suffix:semicolon
id|tempbx
op_assign
l_int|18
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetPALTV
)paren
(brace
id|tempbx
op_add_assign
l_int|2
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCHTVOverScan
)paren
(brace
id|tempbx
op_increment
suffix:semicolon
)brace
)brace
)brace
r_if
c_cond
(paren
id|Flag
)paren
(brace
id|tempbx
op_assign
id|SiS_LCDResInfo
suffix:semicolon
id|tempbx
op_sub_assign
id|PanelMinLVDS
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_le
id|Panel1280x1024
)paren
(brace
r_if
c_cond
(paren
id|SiS_LCDInfo
op_amp
id|LCDNonExpanding
)paren
(brace
id|tempbx
op_add_assign
l_int|6
suffix:semicolon
)brace
r_if
c_cond
(paren
id|modeflag
op_amp
id|HalfDCLK
)paren
(brace
id|tempbx
op_add_assign
l_int|3
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1400x1050
)paren
(brace
id|tempbx
op_assign
l_int|14
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDInfo
op_amp
id|LCDNonExpanding
)paren
(brace
id|tempbx
op_add_assign
l_int|2
suffix:semicolon
)brace
r_if
c_cond
(paren
id|modeflag
op_amp
id|HalfDCLK
)paren
(brace
id|tempbx
op_increment
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|SiS_LCDInfo
op_amp
l_int|0x0100
)paren
(brace
id|tempbx
op_assign
l_int|12
suffix:semicolon
r_if
c_cond
(paren
id|modeflag
op_amp
id|HalfDCLK
)paren
(brace
id|tempbx
op_increment
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1024x600
)paren
(brace
id|tempbx
op_assign
l_int|23
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDInfo
op_amp
id|LCDNonExpanding
)paren
(brace
id|tempbx
op_add_assign
l_int|2
suffix:semicolon
)brace
r_if
c_cond
(paren
id|modeflag
op_amp
id|HalfDCLK
)paren
(brace
id|tempbx
op_increment
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1152x768
)paren
(brace
id|tempbx
op_assign
l_int|27
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDInfo
op_amp
id|LCDNonExpanding
)paren
(brace
id|tempbx
op_add_assign
l_int|2
suffix:semicolon
)brace
r_if
c_cond
(paren
id|modeflag
op_amp
id|HalfDCLK
)paren
(brace
id|tempbx
op_increment
suffix:semicolon
)brace
)brace
)brace
)brace
r_if
c_cond
(paren
id|SiS_IF_DEF_FSTN
)paren
(brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel320x480
)paren
(brace
id|tempbx
op_assign
l_int|22
suffix:semicolon
)brace
)brace
op_star
id|ResInfo
op_assign
id|CRT2CRTC
op_amp
l_int|0x3F
suffix:semicolon
op_star
id|DisplayType
op_assign
id|tempbx
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
multiline_comment|/* TW: Checked against 650/LVDS (1.10a, 1.10.07), 630/301B (I/II) and 630/LVDS BIOS */
r_void
DECL|function|SiS_SetCRT2ECLK
id|SiS_SetCRT2ECLK
c_func
(paren
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
comma
id|USHORT
id|RefreshRateTableIndex
comma
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
)paren
(brace
id|USHORT
id|tempah
comma
id|tempal
comma
id|pushax
suffix:semicolon
id|USHORT
id|vclkindex
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipType
OL
id|SIS_315H
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCD
)paren
)paren
(brace
r_return
suffix:semicolon
)brace
)brace
)brace
r_if
c_cond
(paren
(paren
id|SiS_LCDResInfo
op_eq
id|Panel640x480
)paren
op_logical_or
(paren
id|SiS_IF_DEF_TRUMPION
op_eq
l_int|1
)paren
)paren
(brace
id|SiS_SetFlag
op_and_assign
(paren
op_complement
id|ProgrammingCRT2
)paren
suffix:semicolon
id|tempal
op_assign
id|SiS_RefIndex
(braket
id|RefreshRateTableIndex
)braket
dot
id|Ext_CRTVCLK
suffix:semicolon
id|tempal
op_and_assign
l_int|0x3F
suffix:semicolon
r_if
c_cond
(paren
id|tempal
op_eq
l_int|2
)paren
(brace
id|RefreshRateTableIndex
op_decrement
suffix:semicolon
)brace
id|vclkindex
op_assign
id|SiS_GetVCLK2Ptr
c_func
(paren
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|RefreshRateTableIndex
comma
id|HwDeviceExtension
)paren
suffix:semicolon
id|SiS_SetFlag
op_or_assign
id|ProgrammingCRT2
suffix:semicolon
)brace
r_else
(brace
id|vclkindex
op_assign
id|SiS_GetVCLK2Ptr
c_func
(paren
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
comma
id|RefreshRateTableIndex
comma
id|HwDeviceExtension
)paren
suffix:semicolon
)brace
id|tempal
op_assign
l_int|0x02B
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCDA
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
)paren
(brace
id|tempal
op_add_assign
l_int|3
suffix:semicolon
)brace
)brace
id|SiS_SetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x05
comma
l_int|0x86
)paren
suffix:semicolon
id|pushax
op_assign
id|tempal
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x31
comma
l_int|0x20
)paren
suffix:semicolon
id|tempah
op_assign
id|SiS_VCLKData
(braket
id|vclkindex
)braket
dot
id|SR2B
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_P3c4
comma
id|tempal
comma
id|tempah
)paren
suffix:semicolon
id|tempal
op_increment
suffix:semicolon
id|tempah
op_assign
id|SiS_VCLKData
(braket
id|vclkindex
)braket
dot
id|SR2C
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_P3c4
comma
id|tempal
comma
id|tempah
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x31
comma
l_int|0x10
)paren
suffix:semicolon
id|tempal
op_assign
id|pushax
suffix:semicolon
id|tempah
op_assign
id|SiS_VCLKData
(braket
id|vclkindex
)braket
dot
id|SR2B
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_P3c4
comma
id|tempal
comma
id|tempah
)paren
suffix:semicolon
id|tempal
op_increment
suffix:semicolon
id|tempah
op_assign
id|SiS_VCLKData
(braket
id|vclkindex
)braket
dot
id|SR2C
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_P3c4
comma
id|tempal
comma
id|tempah
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x31
comma
l_int|0x00
)paren
suffix:semicolon
id|tempal
op_assign
id|pushax
suffix:semicolon
id|tempah
op_assign
id|SiS_VCLKData
(braket
id|vclkindex
)braket
dot
id|SR2B
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_P3c4
comma
id|tempal
comma
id|tempah
)paren
suffix:semicolon
id|tempal
op_increment
suffix:semicolon
id|tempah
op_assign
id|SiS_VCLKData
(braket
id|vclkindex
)braket
dot
id|SR2C
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_P3c4
comma
id|tempal
comma
id|tempah
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
macro_line|#if 0  /* TW: Not used */
r_void
id|SiS_SetDefCRT2ExtRegs
c_func
(paren
id|USHORT
id|BaseAddr
)paren
(brace
id|USHORT
id|temp
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|0
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x02
comma
l_int|0x40
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part4Port
comma
l_int|0x10
comma
l_int|0x80
)paren
suffix:semicolon
id|temp
op_assign
(paren
id|UCHAR
)paren
id|SiS_GetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x16
)paren
suffix:semicolon
id|temp
op_and_assign
l_int|0xC3
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x35
comma
id|temp
)paren
suffix:semicolon
)brace
r_else
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x32
comma
l_int|0x02
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x02
comma
l_int|0x00
)paren
suffix:semicolon
)brace
)brace
macro_line|#endif
multiline_comment|/* TW: Start of Chrontel 70xx functions ---------------------- */
multiline_comment|/* Set-up the Chrontel Registers */
r_void
DECL|function|SiS_SetCHTVReg
id|SiS_SetCHTVReg
c_func
(paren
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
comma
id|USHORT
id|RefreshRateTableIndex
)paren
(brace
id|USHORT
id|temp
comma
id|tempbx
comma
id|tempcl
suffix:semicolon
id|USHORT
id|TVType
comma
id|resindex
suffix:semicolon
id|SiS_CHTVRegDataStruct
op_star
id|CHTVRegData
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
id|ModeNo
op_le
l_int|0x13
)paren
(brace
id|tempcl
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|St_CRT2CRTC
suffix:semicolon
)brace
r_else
id|tempcl
op_assign
id|SiS_RefIndex
(braket
id|RefreshRateTableIndex
)braket
dot
id|Ext_CRT2CRTC
suffix:semicolon
id|TVType
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetPALTV
)paren
(brace
id|TVType
op_add_assign
l_int|2
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCHTVOverScan
)paren
(brace
id|TVType
op_add_assign
l_int|1
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|TVType
)paren
(brace
r_case
l_int|0
suffix:colon
id|CHTVRegData
op_assign
id|SiS_CHTVReg_UNTSC
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|CHTVRegData
op_assign
id|SiS_CHTVReg_ONTSC
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|CHTVRegData
op_assign
id|SiS_CHTVReg_UPAL
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
id|CHTVRegData
op_assign
id|SiS_CHTVReg_OPAL
suffix:semicolon
r_break
suffix:semicolon
)brace
id|resindex
op_assign
id|tempcl
op_amp
l_int|0x3F
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_CH70xx
op_eq
l_int|1
)paren
(brace
multiline_comment|/* Chrontel 7005 */
multiline_comment|/* TW: We don&squot;t support modes &gt;800x600 */
r_if
c_cond
(paren
id|resindex
OG
l_int|5
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetPALTV
)paren
(brace
id|SiS_SetCH700x
c_func
(paren
l_int|0x4304
)paren
suffix:semicolon
multiline_comment|/* TW: 0x40=76uA (PAL); 0x03=15bit non-multi RGB*/
id|SiS_SetCH700x
c_func
(paren
l_int|0x6909
)paren
suffix:semicolon
multiline_comment|/* TW: Black level for PAL (105)*/
)brace
r_else
(brace
id|SiS_SetCH700x
c_func
(paren
l_int|0x0304
)paren
suffix:semicolon
multiline_comment|/* TW: upper nibble=71uA (NTSC), 0x03=15bit non-multi RGB*/
id|SiS_SetCH700x
c_func
(paren
l_int|0x7109
)paren
suffix:semicolon
multiline_comment|/* TW: Black level for NTSC (113)*/
)brace
id|temp
op_assign
id|CHTVRegData
(braket
id|resindex
)braket
dot
id|Reg
(braket
l_int|0
)braket
suffix:semicolon
id|tempbx
op_assign
(paren
(paren
id|temp
op_amp
l_int|0x00FF
)paren
op_lshift
l_int|8
)paren
op_or
l_int|0x00
suffix:semicolon
multiline_comment|/* TW: Mode register */
id|SiS_SetCH700x
c_func
(paren
id|tempbx
)paren
suffix:semicolon
id|temp
op_assign
id|CHTVRegData
(braket
id|resindex
)braket
dot
id|Reg
(braket
l_int|1
)braket
suffix:semicolon
id|tempbx
op_assign
(paren
(paren
id|temp
op_amp
l_int|0x00FF
)paren
op_lshift
l_int|8
)paren
op_or
l_int|0x07
suffix:semicolon
multiline_comment|/* TW: Start active video register */
id|SiS_SetCH700x
c_func
(paren
id|tempbx
)paren
suffix:semicolon
id|temp
op_assign
id|CHTVRegData
(braket
id|resindex
)braket
dot
id|Reg
(braket
l_int|2
)braket
suffix:semicolon
id|tempbx
op_assign
(paren
(paren
id|temp
op_amp
l_int|0x00FF
)paren
op_lshift
l_int|8
)paren
op_or
l_int|0x08
suffix:semicolon
multiline_comment|/* TW: Position overflow register */
id|SiS_SetCH700x
c_func
(paren
id|tempbx
)paren
suffix:semicolon
id|temp
op_assign
id|CHTVRegData
(braket
id|resindex
)braket
dot
id|Reg
(braket
l_int|3
)braket
suffix:semicolon
id|tempbx
op_assign
(paren
(paren
id|temp
op_amp
l_int|0x00FF
)paren
op_lshift
l_int|8
)paren
op_or
l_int|0x0A
suffix:semicolon
multiline_comment|/* TW: Horiz Position register */
id|SiS_SetCH700x
c_func
(paren
id|tempbx
)paren
suffix:semicolon
id|temp
op_assign
id|CHTVRegData
(braket
id|resindex
)braket
dot
id|Reg
(braket
l_int|4
)braket
suffix:semicolon
id|tempbx
op_assign
(paren
(paren
id|temp
op_amp
l_int|0x00FF
)paren
op_lshift
l_int|8
)paren
op_or
l_int|0x0B
suffix:semicolon
multiline_comment|/* TW: Vertical Position register */
id|SiS_SetCH700x
c_func
(paren
id|tempbx
)paren
suffix:semicolon
multiline_comment|/* TW: Set minimum flicker filter for Luma channel (SR1-0=00),&n;                minimum text enhancement (S3-2=10),&n;   &t;        maximum flicker filter for Chroma channel (S5-4=10)&n;&t;        =00101000=0x28 (When reading, S1-0-&gt;S3-2, and S3-2-&gt;S1-0!)&n;      */
id|SiS_SetCH700x
c_func
(paren
l_int|0x2801
)paren
suffix:semicolon
multiline_comment|/* TW: Set video bandwidth&n;            High bandwith Luma composite video filter(S0=1)&n;            low bandwith Luma S-video filter (S2-1=00)&n;&t;    disable peak filter in S-video channel (S3=0)&n;&t;    high bandwidth Chroma Filter (S5-4=11)&n;&t;    =00110001=0x31&n;     */
id|SiS_SetCH700x
c_func
(paren
l_int|0xb103
)paren
suffix:semicolon
multiline_comment|/* old: 3103 */
multiline_comment|/* TW: Register 0x3D does not exist in non-macrovision register map&n;            (Maybe this is a macrovision register?)&n;      */
multiline_comment|/* SiS_SetCH70xx(0x003D); */
multiline_comment|/* TW: Register 0x10 only contains 1 writable bit (S0) for sensing,&n;            all other bits a read-only. Macrovision?&n;      */
id|SiS_SetCH70xxANDOR
c_func
(paren
l_int|0x0010
comma
l_int|0x1F
)paren
suffix:semicolon
multiline_comment|/* TW: Register 0x11 only contains 3 writable bits (S0-S2) for&n;            contrast enhancement (set to 010 -&gt; gain 2 Yout = 9/8*(Yin-57) )&n;      */
id|SiS_SetCH70xxANDOR
c_func
(paren
l_int|0x0211
comma
l_int|0xF8
)paren
suffix:semicolon
multiline_comment|/* TW: Clear DSEN&n;      */
id|SiS_SetCH70xxANDOR
c_func
(paren
l_int|0x001C
comma
l_int|0xEF
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetPALTV
)paren
)paren
(brace
multiline_comment|/* ---- NTSC ---- */
id|tempcl
op_assign
id|tempcl
op_amp
l_int|0x3F
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCHTVOverScan
)paren
(brace
r_if
c_cond
(paren
id|tempcl
op_eq
l_int|0x04
)paren
(brace
multiline_comment|/* 640x480 overscan: Mode 16 */
id|SiS_SetCH70xxANDOR
c_func
(paren
l_int|0x0020
comma
l_int|0xEF
)paren
suffix:semicolon
multiline_comment|/* loop filter off */
id|SiS_SetCH70xxANDOR
c_func
(paren
l_int|0x0121
comma
l_int|0xFE
)paren
suffix:semicolon
multiline_comment|/* ACIV on, no need to set FSCI */
)brace
r_else
(brace
r_if
c_cond
(paren
id|tempcl
op_eq
l_int|0x05
)paren
(brace
multiline_comment|/* 800x600 overscan: Mode 23 */
id|SiS_SetCH70xxANDOR
c_func
(paren
l_int|0x0118
comma
l_int|0xF0
)paren
suffix:semicolon
multiline_comment|/* 0x18-0x1f: FSCI 469,762,048 */
id|SiS_SetCH70xxANDOR
c_func
(paren
l_int|0x0C19
comma
l_int|0xF0
)paren
suffix:semicolon
id|SiS_SetCH70xxANDOR
c_func
(paren
l_int|0x001A
comma
l_int|0xF0
)paren
suffix:semicolon
id|SiS_SetCH70xxANDOR
c_func
(paren
l_int|0x001B
comma
l_int|0xF0
)paren
suffix:semicolon
id|SiS_SetCH70xxANDOR
c_func
(paren
l_int|0x001C
comma
l_int|0xF0
)paren
suffix:semicolon
id|SiS_SetCH70xxANDOR
c_func
(paren
l_int|0x001D
comma
l_int|0xF0
)paren
suffix:semicolon
id|SiS_SetCH70xxANDOR
c_func
(paren
l_int|0x001E
comma
l_int|0xF0
)paren
suffix:semicolon
id|SiS_SetCH70xxANDOR
c_func
(paren
l_int|0x001F
comma
l_int|0xF0
)paren
suffix:semicolon
id|SiS_SetCH70xxANDOR
c_func
(paren
l_int|0x1020
comma
l_int|0xEF
)paren
suffix:semicolon
multiline_comment|/* Loop filter on for mode 23 */
id|SiS_SetCH70xxANDOR
c_func
(paren
l_int|0x0021
comma
l_int|0xFE
)paren
suffix:semicolon
multiline_comment|/* ACIV off, need to set FSCI */
)brace
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|tempcl
op_eq
l_int|0x04
)paren
(brace
multiline_comment|/* ----- 640x480 underscan; Mode 17 */
id|SiS_SetCH70xxANDOR
c_func
(paren
l_int|0x0020
comma
l_int|0xEF
)paren
suffix:semicolon
multiline_comment|/* loop filter off */
id|SiS_SetCH70xxANDOR
c_func
(paren
l_int|0x0121
comma
l_int|0xFE
)paren
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|tempcl
op_eq
l_int|0x05
)paren
(brace
multiline_comment|/* ----- 800x600 underscan: Mode 24 */
id|SiS_SetCH70xxANDOR
c_func
(paren
l_int|0x0118
comma
l_int|0xF0
)paren
suffix:semicolon
multiline_comment|/* (FSCI was 0x1f1c71c7 - this is for mode 22) */
id|SiS_SetCH70xxANDOR
c_func
(paren
l_int|0x0919
comma
l_int|0xF0
)paren
suffix:semicolon
multiline_comment|/* FSCI for mode 24 is 428,554,851 */
id|SiS_SetCH70xxANDOR
c_func
(paren
l_int|0x081A
comma
l_int|0xF0
)paren
suffix:semicolon
id|SiS_SetCH70xxANDOR
c_func
(paren
l_int|0x0b1B
comma
l_int|0xF0
)paren
suffix:semicolon
id|SiS_SetCH70xxANDOR
c_func
(paren
l_int|0x031C
comma
l_int|0xF0
)paren
suffix:semicolon
id|SiS_SetCH70xxANDOR
c_func
(paren
l_int|0x0a1D
comma
l_int|0xF0
)paren
suffix:semicolon
id|SiS_SetCH70xxANDOR
c_func
(paren
l_int|0x061E
comma
l_int|0xF0
)paren
suffix:semicolon
id|SiS_SetCH70xxANDOR
c_func
(paren
l_int|0x031F
comma
l_int|0xF0
)paren
suffix:semicolon
id|SiS_SetCH70xxANDOR
c_func
(paren
l_int|0x0020
comma
l_int|0xEF
)paren
suffix:semicolon
multiline_comment|/* loop filter off for mode 24 */
id|SiS_SetCH70xxANDOR
c_func
(paren
l_int|0x0021
comma
l_int|0xFE
)paren
suffix:semicolon
multiline_comment|/* ACIV off, need to set FSCI */
)brace
)brace
)brace
)brace
r_else
(brace
multiline_comment|/* ---- PAL ---- */
multiline_comment|/* TW: We don&squot;t play around with FSCI in PAL mode */
r_if
c_cond
(paren
id|tempcl
op_eq
l_int|0x04
)paren
(brace
id|SiS_SetCH70xxANDOR
c_func
(paren
l_int|0x0020
comma
l_int|0xEF
)paren
suffix:semicolon
multiline_comment|/* loop filter off */
id|SiS_SetCH70xxANDOR
c_func
(paren
l_int|0x0121
comma
l_int|0xFE
)paren
suffix:semicolon
multiline_comment|/* ACIV on */
)brace
r_else
(brace
id|SiS_SetCH70xxANDOR
c_func
(paren
l_int|0x0020
comma
l_int|0xEF
)paren
suffix:semicolon
multiline_comment|/* loop filter off */
id|SiS_SetCH70xxANDOR
c_func
(paren
l_int|0x0121
comma
l_int|0xFE
)paren
suffix:semicolon
multiline_comment|/* ACIV on */
)brace
)brace
)brace
r_else
(brace
multiline_comment|/* Chrontel 7019 */
multiline_comment|/* TW: We don&squot;t support modes &gt;1024x768 */
r_if
c_cond
(paren
id|resindex
OG
l_int|6
)paren
r_return
suffix:semicolon
id|temp
op_assign
id|CHTVRegData
(braket
id|resindex
)braket
dot
id|Reg
(braket
l_int|0
)braket
suffix:semicolon
id|tempbx
op_assign
(paren
(paren
id|temp
op_amp
l_int|0x00FF
)paren
op_lshift
l_int|8
)paren
op_or
l_int|0x00
suffix:semicolon
id|SiS_SetCH701x
c_func
(paren
id|tempbx
)paren
suffix:semicolon
id|temp
op_assign
id|CHTVRegData
(braket
id|resindex
)braket
dot
id|Reg
(braket
l_int|1
)braket
suffix:semicolon
id|tempbx
op_assign
(paren
(paren
id|temp
op_amp
l_int|0x00FF
)paren
op_lshift
l_int|8
)paren
op_or
l_int|0x01
suffix:semicolon
id|SiS_SetCH701x
c_func
(paren
id|tempbx
)paren
suffix:semicolon
id|temp
op_assign
id|CHTVRegData
(braket
id|resindex
)braket
dot
id|Reg
(braket
l_int|2
)braket
suffix:semicolon
id|tempbx
op_assign
(paren
(paren
id|temp
op_amp
l_int|0x00FF
)paren
op_lshift
l_int|8
)paren
op_or
l_int|0x02
suffix:semicolon
id|SiS_SetCH701x
c_func
(paren
id|tempbx
)paren
suffix:semicolon
id|temp
op_assign
id|CHTVRegData
(braket
id|resindex
)braket
dot
id|Reg
(braket
l_int|3
)braket
suffix:semicolon
id|tempbx
op_assign
(paren
(paren
id|temp
op_amp
l_int|0x00FF
)paren
op_lshift
l_int|8
)paren
op_or
l_int|0x04
suffix:semicolon
id|SiS_SetCH701x
c_func
(paren
id|tempbx
)paren
suffix:semicolon
id|temp
op_assign
id|CHTVRegData
(braket
id|resindex
)braket
dot
id|Reg
(braket
l_int|4
)braket
suffix:semicolon
id|tempbx
op_assign
(paren
(paren
id|temp
op_amp
l_int|0x00FF
)paren
op_lshift
l_int|8
)paren
op_or
l_int|0x03
suffix:semicolon
id|SiS_SetCH701x
c_func
(paren
id|tempbx
)paren
suffix:semicolon
id|temp
op_assign
id|CHTVRegData
(braket
id|resindex
)braket
dot
id|Reg
(braket
l_int|5
)braket
suffix:semicolon
id|tempbx
op_assign
(paren
(paren
id|temp
op_amp
l_int|0x00FF
)paren
op_lshift
l_int|8
)paren
op_or
l_int|0x05
suffix:semicolon
id|SiS_SetCH701x
c_func
(paren
id|tempbx
)paren
suffix:semicolon
id|temp
op_assign
id|CHTVRegData
(braket
id|resindex
)braket
dot
id|Reg
(braket
l_int|6
)braket
suffix:semicolon
id|tempbx
op_assign
(paren
(paren
id|temp
op_amp
l_int|0x00FF
)paren
op_lshift
l_int|8
)paren
op_or
l_int|0x06
suffix:semicolon
id|SiS_SetCH701x
c_func
(paren
id|tempbx
)paren
suffix:semicolon
id|temp
op_assign
id|CHTVRegData
(braket
id|resindex
)braket
dot
id|Reg
(braket
l_int|7
)braket
suffix:semicolon
id|tempbx
op_assign
(paren
(paren
id|temp
op_amp
l_int|0x00FF
)paren
op_lshift
l_int|8
)paren
op_or
l_int|0x07
suffix:semicolon
id|SiS_SetCH701x
c_func
(paren
id|tempbx
)paren
suffix:semicolon
id|temp
op_assign
id|CHTVRegData
(braket
id|resindex
)braket
dot
id|Reg
(braket
l_int|8
)braket
suffix:semicolon
id|tempbx
op_assign
(paren
(paren
id|temp
op_amp
l_int|0x00FF
)paren
op_lshift
l_int|8
)paren
op_or
l_int|0x08
suffix:semicolon
id|SiS_SetCH701x
c_func
(paren
id|tempbx
)paren
suffix:semicolon
id|temp
op_assign
id|CHTVRegData
(braket
id|resindex
)braket
dot
id|Reg
(braket
l_int|9
)braket
suffix:semicolon
id|tempbx
op_assign
(paren
(paren
id|temp
op_amp
l_int|0x00FF
)paren
op_lshift
l_int|8
)paren
op_or
l_int|0x15
suffix:semicolon
id|SiS_SetCH701x
c_func
(paren
id|tempbx
)paren
suffix:semicolon
id|temp
op_assign
id|CHTVRegData
(braket
id|resindex
)braket
dot
id|Reg
(braket
l_int|10
)braket
suffix:semicolon
id|tempbx
op_assign
(paren
(paren
id|temp
op_amp
l_int|0x00FF
)paren
op_lshift
l_int|8
)paren
op_or
l_int|0x1f
suffix:semicolon
id|SiS_SetCH701x
c_func
(paren
id|tempbx
)paren
suffix:semicolon
id|temp
op_assign
id|CHTVRegData
(braket
id|resindex
)braket
dot
id|Reg
(braket
l_int|11
)braket
suffix:semicolon
id|tempbx
op_assign
(paren
(paren
id|temp
op_amp
l_int|0x00FF
)paren
op_lshift
l_int|8
)paren
op_or
l_int|0x0c
suffix:semicolon
id|SiS_SetCH701x
c_func
(paren
id|tempbx
)paren
suffix:semicolon
id|temp
op_assign
id|CHTVRegData
(braket
id|resindex
)braket
dot
id|Reg
(braket
l_int|12
)braket
suffix:semicolon
id|tempbx
op_assign
(paren
(paren
id|temp
op_amp
l_int|0x00FF
)paren
op_lshift
l_int|8
)paren
op_or
l_int|0x0d
suffix:semicolon
id|SiS_SetCH701x
c_func
(paren
id|tempbx
)paren
suffix:semicolon
id|temp
op_assign
id|CHTVRegData
(braket
id|resindex
)braket
dot
id|Reg
(braket
l_int|13
)braket
suffix:semicolon
id|tempbx
op_assign
(paren
(paren
id|temp
op_amp
l_int|0x00FF
)paren
op_lshift
l_int|8
)paren
op_or
l_int|0x0e
suffix:semicolon
id|SiS_SetCH701x
c_func
(paren
id|tempbx
)paren
suffix:semicolon
id|temp
op_assign
id|CHTVRegData
(braket
id|resindex
)braket
dot
id|Reg
(braket
l_int|14
)braket
suffix:semicolon
id|tempbx
op_assign
(paren
(paren
id|temp
op_amp
l_int|0x00FF
)paren
op_lshift
l_int|8
)paren
op_or
l_int|0x0f
suffix:semicolon
id|SiS_SetCH701x
c_func
(paren
id|tempbx
)paren
suffix:semicolon
id|temp
op_assign
id|CHTVRegData
(braket
id|resindex
)braket
dot
id|Reg
(braket
l_int|15
)braket
suffix:semicolon
id|tempbx
op_assign
(paren
(paren
id|temp
op_amp
l_int|0x00FF
)paren
op_lshift
l_int|8
)paren
op_or
l_int|0x10
suffix:semicolon
id|SiS_SetCH701x
c_func
(paren
id|tempbx
)paren
suffix:semicolon
macro_line|#if 0  /* TW: Not done in BIOS 1.10.07 */
id|SiS_SetCH701x
c_func
(paren
l_int|0x3848
)paren
suffix:semicolon
id|SiS_DDC2Delay
c_func
(paren
id|SiS_I2CDELAYSHORT
op_star
l_int|2
)paren
suffix:semicolon
id|SiS_SetCH701x
c_func
(paren
l_int|0x1848
)paren
suffix:semicolon
macro_line|#endif
)brace
)brace
r_void
DECL|function|SiS_SetCHTVForLCD
id|SiS_SetCHTVForLCD
c_func
(paren
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
comma
id|USHORT
id|BaseAddr
)paren
(brace
id|UCHAR
id|regtable
(braket
)braket
op_assign
(brace
l_int|0x1c
comma
l_int|0x5f
comma
l_int|0x64
comma
l_int|0x6f
comma
l_int|0x70
comma
l_int|0x71
comma
l_int|0x72
comma
l_int|0x73
comma
l_int|0x74
comma
l_int|0x76
comma
l_int|0x78
comma
l_int|0x7d
)brace
suffix:semicolon
id|UCHAR
id|table28b4
(braket
)braket
op_assign
(brace
l_int|0x60
comma
l_int|0x02
comma
l_int|0x00
comma
l_int|0x07
comma
l_int|0x40
comma
l_int|0xed
comma
l_int|0xa3
comma
l_int|0xc8
comma
l_int|0xc7
comma
l_int|0xac
comma
l_int|0x60
comma
l_int|0x02
)brace
suffix:semicolon
id|UCHAR
id|table28c0
(braket
)braket
op_assign
(brace
l_int|0x60
comma
l_int|0x03
comma
l_int|0x11
comma
l_int|0x00
comma
l_int|0x40
comma
l_int|0xef
comma
l_int|0xad
comma
l_int|0xdb
comma
l_int|0xf6
comma
l_int|0xac
comma
l_int|0x60
comma
l_int|0x02
)brace
suffix:semicolon
id|UCHAR
op_star
id|tableptr
op_assign
l_int|NULL
suffix:semicolon
id|USHORT
id|tempbh
suffix:semicolon
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1400x1050
)paren
(brace
id|tableptr
op_assign
id|table28c0
suffix:semicolon
)brace
r_else
(brace
id|tableptr
op_assign
id|table28b4
suffix:semicolon
)brace
id|tempbh
op_assign
id|SiS_GetCH701x
c_func
(paren
l_int|0x74
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|tempbh
op_eq
l_int|0xf6
)paren
op_logical_or
(paren
id|tempbh
op_eq
l_int|0xc7
)paren
)paren
(brace
id|tempbh
op_assign
id|SiS_GetCH701x
c_func
(paren
l_int|0x73
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tempbh
op_eq
l_int|0xc8
)paren
(brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_ne
id|Panel1400x1050
)paren
(brace
r_return
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|tempbh
op_eq
l_int|0xdb
)paren
(brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1400x1050
)paren
(brace
r_return
suffix:semicolon
)brace
)brace
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|0x0c
suffix:semicolon
id|i
op_increment
)paren
(brace
id|SiS_SetCH701x
c_func
(paren
(paren
id|tableptr
(braket
id|i
)braket
op_lshift
l_int|8
)paren
op_or
id|regtable
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
id|SiS_Chrontel19f2
c_func
(paren
)paren
suffix:semicolon
id|tempbh
op_assign
id|SiS_GetCH701x
c_func
(paren
l_int|0x1e
)paren
suffix:semicolon
multiline_comment|/* TW: NEW in BIOS 1.10.07 */
id|tempbh
op_or_assign
l_int|0xc0
suffix:semicolon
multiline_comment|/* TW: NEW in BIOS 1.10.07 */
id|SiS_SetCH701x
c_func
(paren
(paren
id|tempbh
op_lshift
l_int|8
)paren
op_or
l_int|0x1e
)paren
suffix:semicolon
multiline_comment|/* TW: NEW in BIOS 1.10.07 */
)brace
multiline_comment|/* TW: Chrontel 701x functions ================================= */
r_void
DECL|function|SiS_Chrontel19f2
id|SiS_Chrontel19f2
c_func
(paren
r_void
)paren
(brace
id|UCHAR
id|regtable
(braket
)braket
op_assign
(brace
l_int|0x67
comma
l_int|0x68
comma
l_int|0x69
comma
l_int|0x6a
comma
l_int|0x6b
)brace
suffix:semicolon
id|UCHAR
id|table19e8
(braket
)braket
op_assign
(brace
l_int|0x01
comma
l_int|0x02
comma
l_int|0x01
comma
l_int|0x01
comma
l_int|0x02
)brace
suffix:semicolon
id|UCHAR
id|table19ed
(braket
)braket
op_assign
(brace
l_int|0x01
comma
l_int|0x02
comma
l_int|0x01
comma
l_int|0x01
comma
l_int|0x02
)brace
suffix:semicolon
id|UCHAR
op_star
id|tableptr
op_assign
l_int|NULL
suffix:semicolon
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1400x1050
)paren
(brace
id|tableptr
op_assign
id|table19ed
suffix:semicolon
)brace
r_else
(brace
id|tableptr
op_assign
id|table19e8
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|5
suffix:semicolon
id|i
op_increment
)paren
(brace
id|SiS_SetCH701x
c_func
(paren
(paren
id|tableptr
(braket
id|i
)braket
op_lshift
l_int|8
)paren
op_or
id|regtable
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
)brace
r_void
DECL|function|SiS_Chrontel701xOn
id|SiS_Chrontel701xOn
c_func
(paren
)paren
(brace
id|USHORT
id|temp
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_CH70xx
op_eq
l_int|2
)paren
(brace
id|temp
op_assign
id|SiS_GetCH701x
c_func
(paren
l_int|0x66
)paren
suffix:semicolon
id|temp
op_or_assign
l_int|0x20
suffix:semicolon
id|SiS_SetCH701x
c_func
(paren
(paren
id|temp
op_lshift
l_int|8
)paren
op_or
l_int|0x66
)paren
suffix:semicolon
)brace
)brace
r_void
DECL|function|SiS_Chrontel701xOn2
id|SiS_Chrontel701xOn2
c_func
(paren
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
comma
id|USHORT
id|BaseAddr
)paren
(brace
id|USHORT
id|temp
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_CH70xx
op_eq
l_int|2
)paren
(brace
r_if
c_cond
(paren
id|SiS_IsYPbPr
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
(brace
id|temp
op_assign
id|SiS_GetCH701x
c_func
(paren
l_int|0x01
)paren
suffix:semicolon
id|temp
op_and_assign
l_int|0x3f
suffix:semicolon
id|temp
op_or_assign
l_int|0x80
suffix:semicolon
id|SiS_SetCH701x
c_func
(paren
(paren
id|temp
op_lshift
l_int|8
)paren
op_or
l_int|0x01
)paren
suffix:semicolon
)brace
id|SiS_SetCH701x
c_func
(paren
l_int|0x2049
)paren
suffix:semicolon
id|temp
op_assign
id|SiS_GetCH701x
c_func
(paren
l_int|0x49
)paren
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IsYPbPr
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
(brace
id|temp
op_assign
id|SiS_GetCH701x
c_func
(paren
l_int|0x73
)paren
suffix:semicolon
id|temp
op_or_assign
l_int|0x60
suffix:semicolon
id|SiS_SetCH701x
c_func
(paren
(paren
id|temp
op_lshift
l_int|8
)paren
op_or
l_int|0x73
)paren
suffix:semicolon
)brace
multiline_comment|/* TW: New from BIOS 1.10.07: */
id|temp
op_assign
id|SiS_GetCH701x
c_func
(paren
l_int|0x47
)paren
suffix:semicolon
id|temp
op_and_assign
l_int|0x7f
suffix:semicolon
id|SiS_SetCH701x
c_func
(paren
(paren
id|temp
op_lshift
l_int|8
)paren
op_or
l_int|0x47
)paren
suffix:semicolon
id|SiS_LongDelay
c_func
(paren
l_int|2
)paren
suffix:semicolon
id|temp
op_assign
id|SiS_GetCH701x
c_func
(paren
l_int|0x47
)paren
suffix:semicolon
id|temp
op_or_assign
l_int|0x80
suffix:semicolon
id|SiS_SetCH701x
c_func
(paren
(paren
id|temp
op_lshift
l_int|8
)paren
op_or
l_int|0x47
)paren
suffix:semicolon
)brace
)brace
r_void
DECL|function|SiS_Chrontel701xOff
id|SiS_Chrontel701xOff
c_func
(paren
)paren
(brace
id|USHORT
id|temp
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_CH70xx
op_eq
l_int|2
)paren
(brace
id|temp
op_assign
id|SiS_GetCH701x
c_func
(paren
l_int|0x66
)paren
suffix:semicolon
id|temp
op_and_assign
l_int|0xDF
suffix:semicolon
id|SiS_SetCH701x
c_func
(paren
(paren
id|temp
op_lshift
l_int|8
)paren
op_or
l_int|0x66
)paren
suffix:semicolon
)brace
)brace
r_void
DECL|function|SiS_Chrontel701xOff2
id|SiS_Chrontel701xOff2
c_func
(paren
)paren
(brace
id|USHORT
id|temp
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_CH70xx
op_eq
l_int|2
)paren
(brace
id|SiS_LongDelay
c_func
(paren
l_int|2
)paren
suffix:semicolon
id|temp
op_assign
id|SiS_GetCH701x
c_func
(paren
l_int|0x76
)paren
suffix:semicolon
id|temp
op_and_assign
l_int|0xfc
suffix:semicolon
id|SiS_SetCH701x
c_func
(paren
(paren
id|temp
op_lshift
l_int|8
)paren
op_or
l_int|0x76
)paren
suffix:semicolon
id|SiS_SetCH701x
c_func
(paren
l_int|0x0066
)paren
suffix:semicolon
)brace
)brace
r_void
DECL|function|SiS_ChrontelFlip0x48
id|SiS_ChrontelFlip0x48
c_func
(paren
)paren
(brace
id|SiS_SetCH701x
c_func
(paren
l_int|0x1048
)paren
suffix:semicolon
id|SiS_LongDelay
c_func
(paren
l_int|1
)paren
suffix:semicolon
id|SiS_SetCH701x
c_func
(paren
l_int|0x1848
)paren
suffix:semicolon
)brace
r_void
DECL|function|SiS_ChrontelDoSomething4
id|SiS_ChrontelDoSomething4
c_func
(paren
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
comma
id|USHORT
id|BaseAddr
)paren
(brace
id|USHORT
id|temp
suffix:semicolon
id|SiS_SetCH701x
c_func
(paren
l_int|0xaf76
)paren
suffix:semicolon
id|temp
op_assign
id|SiS_GetCH701x
c_func
(paren
l_int|0x49
)paren
suffix:semicolon
id|temp
op_and_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|temp
op_ne
l_int|1
)paren
(brace
id|temp
op_assign
id|SiS_GetCH701x
c_func
(paren
l_int|0x47
)paren
suffix:semicolon
id|temp
op_and_assign
l_int|0x70
suffix:semicolon
id|SiS_SetCH701x
c_func
(paren
(paren
id|temp
op_lshift
l_int|8
)paren
op_or
l_int|0x47
)paren
suffix:semicolon
id|SiS_LongDelay
c_func
(paren
l_int|3
)paren
suffix:semicolon
id|temp
op_assign
id|SiS_GetCH701x
c_func
(paren
l_int|0x47
)paren
suffix:semicolon
id|temp
op_or_assign
l_int|0x80
suffix:semicolon
id|SiS_SetCH701x
c_func
(paren
(paren
id|temp
op_lshift
l_int|8
)paren
op_or
l_int|0x47
)paren
suffix:semicolon
)brace
)brace
r_void
DECL|function|SiS_ChrontelDoSomething3
id|SiS_ChrontelDoSomething3
c_func
(paren
id|USHORT
id|ModeNo
comma
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
comma
id|USHORT
id|BaseAddr
)paren
(brace
id|USHORT
id|temp
comma
id|temp1
suffix:semicolon
id|temp1
op_assign
l_int|0
suffix:semicolon
id|temp
op_assign
id|SiS_GetCH701x
c_func
(paren
l_int|0x61
)paren
suffix:semicolon
r_if
c_cond
(paren
id|temp
OL
l_int|2
)paren
(brace
id|temp
op_increment
suffix:semicolon
id|SiS_SetCH701x
c_func
(paren
(paren
id|temp
op_lshift
l_int|8
)paren
op_or
l_int|0x61
)paren
suffix:semicolon
id|temp1
op_assign
l_int|1
suffix:semicolon
)brace
id|SiS_SetCH701x
c_func
(paren
l_int|0xac76
)paren
suffix:semicolon
id|temp
op_assign
id|SiS_GetCH701x
c_func
(paren
l_int|0x66
)paren
suffix:semicolon
id|temp
op_or_assign
l_int|0x5f
suffix:semicolon
id|SiS_SetCH701x
c_func
(paren
(paren
id|temp
op_lshift
l_int|8
)paren
op_or
l_int|0x66
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ModeNo
OG
l_int|0x13
)paren
(brace
r_if
c_cond
(paren
id|SiS_WeHaveBacklightCtrl
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
)paren
(brace
id|SiS_GenericDelay
c_func
(paren
l_int|0x3ff
)paren
suffix:semicolon
)brace
r_else
(brace
id|SiS_GenericDelay
c_func
(paren
l_int|0x2ff
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
op_logical_neg
id|temp1
)paren
(brace
id|SiS_GenericDelay
c_func
(paren
l_int|0x2ff
)paren
suffix:semicolon
)brace
)brace
id|temp
op_assign
id|SiS_GetCH701x
c_func
(paren
l_int|0x76
)paren
suffix:semicolon
id|temp
op_or_assign
l_int|0x03
suffix:semicolon
id|SiS_SetCH701x
c_func
(paren
(paren
id|temp
op_lshift
l_int|8
)paren
op_or
l_int|0x76
)paren
suffix:semicolon
id|temp
op_assign
id|SiS_GetCH701x
c_func
(paren
l_int|0x66
)paren
suffix:semicolon
id|temp
op_and_assign
l_int|0x7f
suffix:semicolon
id|SiS_SetCH701x
c_func
(paren
(paren
id|temp
op_lshift
l_int|8
)paren
op_or
l_int|0x66
)paren
suffix:semicolon
id|SiS_LongDelay
c_func
(paren
l_int|1
)paren
suffix:semicolon
)brace
r_void
DECL|function|SiS_ChrontelDoSomething2
id|SiS_ChrontelDoSomething2
c_func
(paren
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
comma
id|USHORT
id|BaseAddr
)paren
(brace
id|USHORT
id|temp
comma
id|tempcl
comma
id|tempch
suffix:semicolon
id|SiS_LongDelay
c_func
(paren
l_int|1
)paren
suffix:semicolon
id|tempcl
op_assign
l_int|3
suffix:semicolon
id|tempch
op_assign
l_int|0
suffix:semicolon
r_do
(brace
id|temp
op_assign
id|SiS_GetCH701x
c_func
(paren
l_int|0x66
)paren
suffix:semicolon
id|temp
op_and_assign
l_int|0x04
suffix:semicolon
r_if
c_cond
(paren
id|temp
op_eq
l_int|0x04
)paren
(brace
r_break
suffix:semicolon
)brace
id|SiS_SetCHTVForLCD
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tempcl
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|tempch
op_eq
l_int|3
)paren
(brace
r_break
suffix:semicolon
)brace
id|SiS_ChrontelFlip0x48
c_func
(paren
)paren
suffix:semicolon
id|tempcl
op_assign
l_int|3
suffix:semicolon
id|tempch
op_increment
suffix:semicolon
)brace
id|tempcl
op_decrement
suffix:semicolon
id|temp
op_assign
id|SiS_GetCH701x
c_func
(paren
l_int|0x76
)paren
suffix:semicolon
id|temp
op_and_assign
l_int|0xfb
suffix:semicolon
id|SiS_SetCH701x
c_func
(paren
(paren
id|temp
op_lshift
l_int|8
)paren
op_or
l_int|0x76
)paren
suffix:semicolon
id|SiS_LongDelay
c_func
(paren
l_int|2
)paren
suffix:semicolon
id|temp
op_assign
id|SiS_GetCH701x
c_func
(paren
l_int|0x76
)paren
suffix:semicolon
id|temp
op_or_assign
l_int|0x04
suffix:semicolon
id|SiS_SetCH701x
c_func
(paren
(paren
id|temp
op_lshift
l_int|8
)paren
op_or
l_int|0x76
)paren
suffix:semicolon
id|SiS_SetCH701x
c_func
(paren
l_int|0x6078
)paren
suffix:semicolon
id|SiS_LongDelay
c_func
(paren
l_int|2
)paren
suffix:semicolon
)brace
r_while
c_loop
(paren
l_int|0
)paren
(brace
suffix:semicolon
)brace
id|SiS_SetCH701x
c_func
(paren
l_int|0x0077
)paren
suffix:semicolon
)brace
r_void
DECL|function|SiS_ChrontelDoSomething1
id|SiS_ChrontelDoSomething1
c_func
(paren
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
comma
id|USHORT
id|BaseAddr
)paren
(brace
id|USHORT
id|temp
suffix:semicolon
id|temp
op_assign
id|SiS_GetCH701x
c_func
(paren
l_int|0x03
)paren
suffix:semicolon
id|temp
op_or_assign
l_int|0x80
suffix:semicolon
id|temp
op_and_assign
l_int|0xbf
suffix:semicolon
id|SiS_SetCH701x
c_func
(paren
(paren
id|temp
op_lshift
l_int|8
)paren
op_or
l_int|0x03
)paren
suffix:semicolon
id|SiS_ChrontelFlip0x48
c_func
(paren
)paren
suffix:semicolon
id|SiS_ChrontelDoSomething2
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
suffix:semicolon
id|temp
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x34
)paren
suffix:semicolon
id|SiS_ChrontelDoSomething3
c_func
(paren
id|temp
comma
id|HwDeviceExtension
comma
id|BaseAddr
)paren
suffix:semicolon
id|SiS_SetCH701x
c_func
(paren
l_int|0xaf76
)paren
suffix:semicolon
)brace
multiline_comment|/* TW: End of Chrontel 701x functions ==================================== */
multiline_comment|/* TW: Generic Read/write routines for Chrontel ========================== */
multiline_comment|/* The Chrontel seems to be connected to the 630/730 via&n; * the 630/730&squot;s DDC port (which is used as a I2C port here).&n; *&n; * On 630(S)T chipset, the port changed from 0x11 to 0x0a&n; */
r_void
DECL|function|SiS_SetCH70xx
id|SiS_SetCH70xx
c_func
(paren
id|USHORT
id|tempbx
)paren
(brace
r_if
c_cond
(paren
id|SiS_IF_DEF_CH70xx
op_eq
l_int|1
)paren
id|SiS_SetCH700x
c_func
(paren
id|tempbx
)paren
suffix:semicolon
r_else
id|SiS_SetCH701x
c_func
(paren
id|tempbx
)paren
suffix:semicolon
)brace
multiline_comment|/* TW: Write to Chrontel 700x */
multiline_comment|/* Parameter is [Data (S15-S8) | Register no (S7-S0)] */
r_void
DECL|function|SiS_SetCH700x
id|SiS_SetCH700x
c_func
(paren
id|USHORT
id|tempbx
)paren
(brace
id|USHORT
id|tempah
comma
id|temp
comma
id|i
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_ChrontelInit
)paren
)paren
(brace
id|SiS_DDC_Index
op_assign
l_int|0x11
suffix:semicolon
multiline_comment|/* TW: Bit 0 = SC;  Bit 1 = SD */
id|SiS_DDC_Data
op_assign
l_int|0x02
suffix:semicolon
multiline_comment|/* Bitmask in IndexReg for Data */
id|SiS_DDC_Clk
op_assign
l_int|0x01
suffix:semicolon
multiline_comment|/* Bitmask in IndexReg for Clk */
id|SiS_DDC_DataShift
op_assign
l_int|0x00
suffix:semicolon
id|SiS_DDC_DeviceAddr
op_assign
l_int|0xEA
suffix:semicolon
multiline_comment|/* TW: DAB (Device Address Byte) */
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|10
suffix:semicolon
id|i
op_increment
)paren
(brace
multiline_comment|/* TW: Do only 10 attempts to write */
id|SiS_SetSwitchDDC2
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|SiS_SetStart
c_func
(paren
)paren
)paren
r_continue
suffix:semicolon
multiline_comment|/* TW: Set start condition */
id|tempah
op_assign
id|SiS_DDC_DeviceAddr
suffix:semicolon
id|temp
op_assign
id|SiS_WriteDDC2Data
c_func
(paren
id|tempah
)paren
suffix:semicolon
multiline_comment|/* TW: Write DAB (S0=0=write) */
r_if
c_cond
(paren
id|temp
)paren
(brace
r_continue
suffix:semicolon
)brace
multiline_comment|/* TW:    (ERROR: no ack) */
id|tempah
op_assign
id|tempbx
op_amp
l_int|0x00FF
suffix:semicolon
id|temp
op_assign
id|SiS_WriteDDC2Data
c_func
(paren
id|tempah
)paren
suffix:semicolon
multiline_comment|/* TW: Write RAB */
r_if
c_cond
(paren
id|temp
)paren
(brace
r_continue
suffix:semicolon
)brace
multiline_comment|/* TW:    (ERROR: no ack) */
id|tempah
op_assign
(paren
id|tempbx
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
suffix:semicolon
id|temp
op_assign
id|SiS_WriteDDC2Data
c_func
(paren
id|tempah
)paren
suffix:semicolon
multiline_comment|/* TW: Write data */
r_if
c_cond
(paren
id|temp
)paren
(brace
r_continue
suffix:semicolon
)brace
multiline_comment|/* TW:    (ERROR: no ack) */
r_if
c_cond
(paren
id|SiS_SetStop
c_func
(paren
)paren
)paren
r_continue
suffix:semicolon
multiline_comment|/* TW: Set stop condition */
id|SiS_ChrontelInit
op_assign
l_int|1
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_ChrontelInit
)paren
)paren
(brace
id|SiS_DDC_Index
op_assign
l_int|0x0a
suffix:semicolon
multiline_comment|/* TW: Bit 0 = SC;  Bit 1 = SD */
id|SiS_DDC_Data
op_assign
l_int|0x80
suffix:semicolon
multiline_comment|/* Bitmask in IndexReg for Data */
id|SiS_DDC_Clk
op_assign
l_int|0x40
suffix:semicolon
multiline_comment|/* Bitmask in IndexReg for Clk */
id|SiS_DDC_DataShift
op_assign
l_int|0x00
suffix:semicolon
id|SiS_DDC_DeviceAddr
op_assign
l_int|0xEA
suffix:semicolon
multiline_comment|/* TW: DAB (Device Address Byte) */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|10
suffix:semicolon
id|i
op_increment
)paren
(brace
multiline_comment|/* TW: Do only 10 attempts to write */
id|SiS_SetSwitchDDC2
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|SiS_SetStart
c_func
(paren
)paren
)paren
r_continue
suffix:semicolon
multiline_comment|/* TW: Set start condition */
id|tempah
op_assign
id|SiS_DDC_DeviceAddr
suffix:semicolon
id|temp
op_assign
id|SiS_WriteDDC2Data
c_func
(paren
id|tempah
)paren
suffix:semicolon
multiline_comment|/* TW: Write DAB (S0=0=write) */
r_if
c_cond
(paren
id|temp
)paren
(brace
r_continue
suffix:semicolon
)brace
multiline_comment|/* TW:    (ERROR: no ack) */
id|tempah
op_assign
id|tempbx
op_amp
l_int|0x00FF
suffix:semicolon
id|temp
op_assign
id|SiS_WriteDDC2Data
c_func
(paren
id|tempah
)paren
suffix:semicolon
multiline_comment|/* TW: Write RAB */
r_if
c_cond
(paren
id|temp
)paren
(brace
r_continue
suffix:semicolon
)brace
multiline_comment|/* TW:    (ERROR: no ack) */
id|tempah
op_assign
(paren
id|tempbx
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
suffix:semicolon
id|temp
op_assign
id|SiS_WriteDDC2Data
c_func
(paren
id|tempah
)paren
suffix:semicolon
multiline_comment|/* TW: Write data */
r_if
c_cond
(paren
id|temp
)paren
(brace
r_continue
suffix:semicolon
)brace
multiline_comment|/* TW:    (ERROR: no ack) */
r_if
c_cond
(paren
id|SiS_SetStop
c_func
(paren
)paren
)paren
r_continue
suffix:semicolon
multiline_comment|/* TW: Set stop condition */
id|SiS_ChrontelInit
op_assign
l_int|1
suffix:semicolon
r_return
suffix:semicolon
)brace
)brace
)brace
multiline_comment|/* TW: Write to Chrontel 701x */
multiline_comment|/* Parameter is [Data (S15-S8) | Register no (S7-S0)] */
r_void
DECL|function|SiS_SetCH701x
id|SiS_SetCH701x
c_func
(paren
id|USHORT
id|tempbx
)paren
(brace
id|USHORT
id|tempah
comma
id|temp
comma
id|i
suffix:semicolon
multiline_comment|/* TW: Toggle to DDC port */
id|SiS_SetRegOR
c_func
(paren
id|SiS_P3c4
comma
l_int|0x38
comma
l_int|0x20
)paren
suffix:semicolon
id|SiS_DDC_Index
op_assign
l_int|0x11
suffix:semicolon
multiline_comment|/* TW: Bit 0 = SC;  Bit 1 = SD */
id|SiS_DDC_Data
op_assign
l_int|0x08
suffix:semicolon
multiline_comment|/* Bitmask in IndexReg for Data */
id|SiS_DDC_Clk
op_assign
l_int|0x04
suffix:semicolon
multiline_comment|/* Bitmask in IndexReg for Clk */
id|SiS_DDC_DataShift
op_assign
l_int|0x00
suffix:semicolon
id|SiS_DDC_DeviceAddr
op_assign
l_int|0xEA
suffix:semicolon
multiline_comment|/* TW: DAB (Device Address Byte) */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|10
suffix:semicolon
id|i
op_increment
)paren
(brace
multiline_comment|/* TW: Do only 10 attempts to write */
r_if
c_cond
(paren
id|SiS_SetStart
c_func
(paren
)paren
)paren
r_continue
suffix:semicolon
multiline_comment|/* TW: Set start condition */
id|tempah
op_assign
id|SiS_DDC_DeviceAddr
suffix:semicolon
id|temp
op_assign
id|SiS_WriteDDC2Data
c_func
(paren
id|tempah
)paren
suffix:semicolon
multiline_comment|/* TW: Write DAB (S0=0=write) */
r_if
c_cond
(paren
id|temp
)paren
(brace
r_continue
suffix:semicolon
)brace
multiline_comment|/* TW:    (ERROR: no ack) */
id|tempah
op_assign
id|tempbx
op_amp
l_int|0x00FF
suffix:semicolon
id|temp
op_assign
id|SiS_WriteDDC2Data
c_func
(paren
id|tempah
)paren
suffix:semicolon
multiline_comment|/* TW: Write RAB */
r_if
c_cond
(paren
id|temp
)paren
(brace
r_continue
suffix:semicolon
)brace
multiline_comment|/* TW:    (ERROR: no ack) */
id|tempah
op_assign
(paren
id|tempbx
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
suffix:semicolon
id|temp
op_assign
id|SiS_WriteDDC2Data
c_func
(paren
id|tempah
)paren
suffix:semicolon
multiline_comment|/* TW: Write data */
r_if
c_cond
(paren
id|temp
)paren
(brace
r_continue
suffix:semicolon
)brace
multiline_comment|/* TW:    (ERROR: no ack) */
r_if
c_cond
(paren
id|SiS_SetStop
c_func
(paren
)paren
)paren
r_continue
suffix:semicolon
multiline_comment|/* TW: Set stop condition */
r_return
suffix:semicolon
)brace
)brace
multiline_comment|/* TW: Read from Chrontel 70xx */
multiline_comment|/* Parameter is [Register no (S7-S0)] */
id|USHORT
DECL|function|SiS_GetCH70xx
id|SiS_GetCH70xx
c_func
(paren
id|USHORT
id|tempbx
)paren
(brace
r_if
c_cond
(paren
id|SiS_IF_DEF_CH70xx
op_eq
l_int|1
)paren
r_return
id|SiS_GetCH700x
c_func
(paren
id|tempbx
)paren
suffix:semicolon
r_else
r_return
id|SiS_GetCH701x
c_func
(paren
id|tempbx
)paren
suffix:semicolon
)brace
multiline_comment|/* TW: Read from Chrontel 700x */
multiline_comment|/* Parameter is [Register no (S7-S0)] */
id|USHORT
DECL|function|SiS_GetCH700x
id|SiS_GetCH700x
c_func
(paren
id|USHORT
id|tempbx
)paren
(brace
id|USHORT
id|tempah
comma
id|temp
comma
id|i
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_ChrontelInit
)paren
)paren
(brace
id|SiS_DDC_Index
op_assign
l_int|0x11
suffix:semicolon
multiline_comment|/* TW: Bit 0 = SC;  Bit 1 = SD */
id|SiS_DDC_Data
op_assign
l_int|0x02
suffix:semicolon
multiline_comment|/* Bitmask in IndexReg for Data */
id|SiS_DDC_Clk
op_assign
l_int|0x01
suffix:semicolon
multiline_comment|/* Bitmask in IndexReg for Clk */
id|SiS_DDC_DataShift
op_assign
l_int|0x00
suffix:semicolon
id|SiS_DDC_DeviceAddr
op_assign
l_int|0xEA
suffix:semicolon
multiline_comment|/* TW: DAB */
)brace
id|SiS_DDC_ReadAddr
op_assign
id|tempbx
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|20
suffix:semicolon
id|i
op_increment
)paren
(brace
multiline_comment|/* TW: Do only 20 attempts to read */
id|SiS_SetSwitchDDC2
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|SiS_SetStart
c_func
(paren
)paren
)paren
(brace
r_continue
suffix:semicolon
)brace
multiline_comment|/* TW: Set start condition */
id|tempah
op_assign
id|SiS_DDC_DeviceAddr
suffix:semicolon
id|temp
op_assign
id|SiS_WriteDDC2Data
c_func
(paren
id|tempah
)paren
suffix:semicolon
multiline_comment|/* TW: Write DAB (S0=0=write) */
r_if
c_cond
(paren
id|temp
)paren
(brace
r_continue
suffix:semicolon
)brace
multiline_comment|/* TW:        (ERROR: no ack) */
id|tempah
op_assign
id|SiS_DDC_ReadAddr
suffix:semicolon
multiline_comment|/* TW: Write RAB */
id|temp
op_assign
id|SiS_WriteDDC2Data
c_func
(paren
id|tempah
)paren
suffix:semicolon
r_if
c_cond
(paren
id|temp
)paren
(brace
r_continue
suffix:semicolon
)brace
multiline_comment|/* TW:        (ERROR: no ack) */
r_if
c_cond
(paren
id|SiS_SetStart
c_func
(paren
)paren
)paren
r_continue
suffix:semicolon
multiline_comment|/* TW: Re-start */
id|tempah
op_assign
id|SiS_DDC_DeviceAddr
op_or
l_int|0x01
suffix:semicolon
multiline_comment|/* DAB | 0x01 = Read */
id|temp
op_assign
id|SiS_WriteDDC2Data
c_func
(paren
id|tempah
)paren
suffix:semicolon
multiline_comment|/* TW: DAB (S0=1=read) */
r_if
c_cond
(paren
id|temp
)paren
(brace
r_continue
suffix:semicolon
)brace
multiline_comment|/* TW:        (ERROR: no ack) */
id|tempah
op_assign
id|SiS_ReadDDC2Data
c_func
(paren
id|tempah
)paren
suffix:semicolon
multiline_comment|/* TW: Read byte */
r_if
c_cond
(paren
id|SiS_SetStop
c_func
(paren
)paren
)paren
r_continue
suffix:semicolon
multiline_comment|/* TW: Stop condition */
id|SiS_ChrontelInit
op_assign
l_int|1
suffix:semicolon
r_return
id|tempah
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|SiS_ChrontelInit
)paren
(brace
id|SiS_DDC_Index
op_assign
l_int|0x0a
suffix:semicolon
multiline_comment|/* TW: Bit 0 = SC;  Bit 1 = SD */
id|SiS_DDC_Data
op_assign
l_int|0x80
suffix:semicolon
multiline_comment|/* Bitmask in IndexReg for Data */
id|SiS_DDC_Clk
op_assign
l_int|0x40
suffix:semicolon
multiline_comment|/* Bitmask in IndexReg for Clk */
id|SiS_DDC_DataShift
op_assign
l_int|0x00
suffix:semicolon
id|SiS_DDC_DeviceAddr
op_assign
l_int|0xEA
suffix:semicolon
multiline_comment|/* TW: DAB (Device Address Byte) */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|20
suffix:semicolon
id|i
op_increment
)paren
(brace
multiline_comment|/* TW: Do only 20 attempts to read */
id|SiS_SetSwitchDDC2
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|SiS_SetStart
c_func
(paren
)paren
)paren
(brace
r_continue
suffix:semicolon
)brace
multiline_comment|/* TW: Set start condition */
id|tempah
op_assign
id|SiS_DDC_DeviceAddr
suffix:semicolon
id|temp
op_assign
id|SiS_WriteDDC2Data
c_func
(paren
id|tempah
)paren
suffix:semicolon
multiline_comment|/* TW: Write DAB (S0=0=write) */
r_if
c_cond
(paren
id|temp
)paren
(brace
r_continue
suffix:semicolon
)brace
multiline_comment|/* TW:        (ERROR: no ack) */
id|tempah
op_assign
id|SiS_DDC_ReadAddr
suffix:semicolon
multiline_comment|/* TW: Write RAB */
id|temp
op_assign
id|SiS_WriteDDC2Data
c_func
(paren
id|tempah
)paren
suffix:semicolon
r_if
c_cond
(paren
id|temp
)paren
(brace
r_continue
suffix:semicolon
)brace
multiline_comment|/* TW:        (ERROR: no ack) */
r_if
c_cond
(paren
id|SiS_SetStart
c_func
(paren
)paren
)paren
r_continue
suffix:semicolon
multiline_comment|/* TW: Re-start */
id|tempah
op_assign
id|SiS_DDC_DeviceAddr
op_or
l_int|0x01
suffix:semicolon
multiline_comment|/* DAB | 0x01 = Read */
id|temp
op_assign
id|SiS_WriteDDC2Data
c_func
(paren
id|tempah
)paren
suffix:semicolon
multiline_comment|/* TW: DAB (S0=1=read) */
r_if
c_cond
(paren
id|temp
)paren
(brace
r_continue
suffix:semicolon
)brace
multiline_comment|/* TW:        (ERROR: no ack) */
id|tempah
op_assign
id|SiS_ReadDDC2Data
c_func
(paren
id|tempah
)paren
suffix:semicolon
multiline_comment|/* TW: Read byte */
r_if
c_cond
(paren
id|SiS_SetStop
c_func
(paren
)paren
)paren
r_continue
suffix:semicolon
multiline_comment|/* TW: Stop condition */
id|SiS_ChrontelInit
op_assign
l_int|1
suffix:semicolon
r_return
id|tempah
suffix:semicolon
)brace
)brace
r_return
l_int|0xFFFF
suffix:semicolon
)brace
multiline_comment|/* TW: Read from Chrontel 701x */
multiline_comment|/* Parameter is [Register no (S7-S0)] */
id|USHORT
DECL|function|SiS_GetCH701x
id|SiS_GetCH701x
c_func
(paren
id|USHORT
id|tempbx
)paren
(brace
id|USHORT
id|tempah
comma
id|temp
comma
id|i
suffix:semicolon
multiline_comment|/* TW: Toggle to DDC port */
id|SiS_SetRegOR
c_func
(paren
id|SiS_P3c4
comma
l_int|0x38
comma
l_int|0x20
)paren
suffix:semicolon
id|SiS_DDC_Index
op_assign
l_int|0x11
suffix:semicolon
multiline_comment|/* TW: Bit 0 = SC;  Bit 1 = SD */
id|SiS_DDC_Data
op_assign
l_int|0x08
suffix:semicolon
multiline_comment|/* Bitmask in IndexReg for Data */
id|SiS_DDC_Clk
op_assign
l_int|0x04
suffix:semicolon
multiline_comment|/* Bitmask in IndexReg for Clk */
id|SiS_DDC_DataShift
op_assign
l_int|0x00
suffix:semicolon
id|SiS_DDC_DeviceAddr
op_assign
l_int|0xEA
suffix:semicolon
multiline_comment|/* TW: DAB */
id|SiS_DDC_ReadAddr
op_assign
id|tempbx
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|20
suffix:semicolon
id|i
op_increment
)paren
(brace
multiline_comment|/* TW: Do only 20 attempts to read */
r_if
c_cond
(paren
id|SiS_SetStart
c_func
(paren
)paren
)paren
(brace
r_continue
suffix:semicolon
)brace
multiline_comment|/* TW: Set start condition */
id|tempah
op_assign
id|SiS_DDC_DeviceAddr
suffix:semicolon
id|temp
op_assign
id|SiS_WriteDDC2Data
c_func
(paren
id|tempah
)paren
suffix:semicolon
multiline_comment|/* TW: Write DAB (S0=0=write) */
r_if
c_cond
(paren
id|temp
)paren
(brace
r_continue
suffix:semicolon
)brace
multiline_comment|/* TW:        (ERROR: no ack) */
id|tempah
op_assign
id|SiS_DDC_ReadAddr
suffix:semicolon
multiline_comment|/* TW: Write RAB */
id|temp
op_assign
id|SiS_WriteDDC2Data
c_func
(paren
id|tempah
)paren
suffix:semicolon
r_if
c_cond
(paren
id|temp
)paren
(brace
r_continue
suffix:semicolon
)brace
multiline_comment|/* TW:        (ERROR: no ack) */
r_if
c_cond
(paren
id|SiS_SetStart
c_func
(paren
)paren
)paren
r_continue
suffix:semicolon
multiline_comment|/* TW: Re-start */
id|tempah
op_assign
id|SiS_DDC_DeviceAddr
op_or
l_int|0x01
suffix:semicolon
multiline_comment|/* DAB | 0x01 = Read */
id|temp
op_assign
id|SiS_WriteDDC2Data
c_func
(paren
id|tempah
)paren
suffix:semicolon
multiline_comment|/* TW: DAB (S0=1=read) */
r_if
c_cond
(paren
id|temp
)paren
(brace
r_continue
suffix:semicolon
)brace
multiline_comment|/* TW:        (ERROR: no ack) */
id|tempah
op_assign
id|SiS_ReadDDC2Data
c_func
(paren
id|tempah
)paren
suffix:semicolon
multiline_comment|/* TW: Read byte */
id|SiS_SetStop
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/* TW: Stop condition */
r_return
id|tempah
suffix:semicolon
)brace
r_return
l_int|0xFFFF
suffix:semicolon
)brace
r_void
DECL|function|SiS_SetCH70xxANDOR
id|SiS_SetCH70xxANDOR
c_func
(paren
id|USHORT
id|tempax
comma
id|USHORT
id|tempbh
)paren
(brace
id|USHORT
id|tempal
comma
id|tempah
comma
id|tempbl
suffix:semicolon
id|tempal
op_assign
id|tempax
op_amp
l_int|0x00FF
suffix:semicolon
id|tempah
op_assign
(paren
id|tempax
op_rshift
l_int|8
)paren
op_amp
l_int|0x00FF
suffix:semicolon
id|tempbl
op_assign
id|SiS_GetCH70xx
c_func
(paren
id|tempal
)paren
suffix:semicolon
id|tempbl
op_assign
(paren
(paren
(paren
id|tempbl
op_amp
id|tempbh
)paren
op_or
id|tempah
)paren
op_lshift
l_int|8
op_or
id|tempal
)paren
suffix:semicolon
id|SiS_SetCH70xx
c_func
(paren
id|tempbl
)paren
suffix:semicolon
)brace
multiline_comment|/* TW: Generic I2C functions for Chrontel --------- */
multiline_comment|/* I2C functions CHECKED FOR TV BUG */
r_void
DECL|function|SiS_SetSwitchDDC2
id|SiS_SetSwitchDDC2
c_func
(paren
r_void
)paren
(brace
id|SiS_SetSCLKHigh
c_func
(paren
)paren
suffix:semicolon
id|SiS_DDC2Delay
c_func
(paren
id|SiS_I2CDELAY
)paren
suffix:semicolon
id|SiS_SetSCLKLow
c_func
(paren
)paren
suffix:semicolon
id|SiS_DDC2Delay
c_func
(paren
id|SiS_I2CDELAY
)paren
suffix:semicolon
)brace
multiline_comment|/* TW: Set I2C start condition */
multiline_comment|/* TW: This is done by a SD high-to-low transition while SC is high */
id|USHORT
DECL|function|SiS_SetStart
id|SiS_SetStart
c_func
(paren
r_void
)paren
(brace
r_if
c_cond
(paren
id|SiS_SetSCLKLow
c_func
(paren
)paren
)paren
r_return
l_int|0xFFFF
suffix:semicolon
multiline_comment|/* TW: (SC-&gt;low)  */
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_DDC_Port
comma
id|SiS_DDC_Index
comma
op_complement
id|SiS_DDC_Data
comma
id|SiS_DDC_Data
)paren
suffix:semicolon
multiline_comment|/* TW: SD-&gt;high */
r_if
c_cond
(paren
id|SiS_SetSCLKHigh
c_func
(paren
)paren
)paren
r_return
l_int|0xFFFF
suffix:semicolon
multiline_comment|/* TW: SC-&gt;high */
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_DDC_Port
comma
id|SiS_DDC_Index
comma
op_complement
id|SiS_DDC_Data
comma
l_int|0x00
)paren
suffix:semicolon
multiline_comment|/* TW: SD-&gt;low = start condition */
r_if
c_cond
(paren
id|SiS_SetSCLKHigh
c_func
(paren
)paren
)paren
r_return
l_int|0xFFFF
suffix:semicolon
multiline_comment|/* TW: (SC-&gt;low) */
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* TW: Set I2C stop condition */
multiline_comment|/* TW: This is done by a SD low-to-high transition while SC is high */
id|USHORT
DECL|function|SiS_SetStop
id|SiS_SetStop
c_func
(paren
r_void
)paren
(brace
r_if
c_cond
(paren
id|SiS_SetSCLKLow
c_func
(paren
)paren
)paren
r_return
l_int|0xFFFF
suffix:semicolon
multiline_comment|/* TW: (SC-&gt;low) */
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_DDC_Port
comma
id|SiS_DDC_Index
comma
op_complement
id|SiS_DDC_Data
comma
l_int|0x00
)paren
suffix:semicolon
multiline_comment|/* TW: SD-&gt;low   */
r_if
c_cond
(paren
id|SiS_SetSCLKHigh
c_func
(paren
)paren
)paren
r_return
l_int|0xFFFF
suffix:semicolon
multiline_comment|/* TW: SC-&gt;high  */
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_DDC_Port
comma
id|SiS_DDC_Index
comma
op_complement
id|SiS_DDC_Data
comma
id|SiS_DDC_Data
)paren
suffix:semicolon
multiline_comment|/* TW: SD-&gt;high = stop condition */
r_if
c_cond
(paren
id|SiS_SetSCLKHigh
c_func
(paren
)paren
)paren
r_return
l_int|0xFFFF
suffix:semicolon
multiline_comment|/* TW: (SC-&gt;high) */
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* TW: Write 8 bits of data */
id|USHORT
DECL|function|SiS_WriteDDC2Data
id|SiS_WriteDDC2Data
c_func
(paren
id|USHORT
id|tempax
)paren
(brace
id|USHORT
id|i
comma
id|flag
comma
id|temp
suffix:semicolon
id|flag
op_assign
l_int|0x80
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|8
suffix:semicolon
id|i
op_increment
)paren
(brace
id|SiS_SetSCLKLow
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/* TW: SC-&gt;low */
r_if
c_cond
(paren
id|tempax
op_amp
id|flag
)paren
(brace
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_DDC_Port
comma
id|SiS_DDC_Index
comma
op_complement
id|SiS_DDC_Data
comma
id|SiS_DDC_Data
)paren
suffix:semicolon
multiline_comment|/* TW: Write bit (1) to SD */
)brace
r_else
(brace
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_DDC_Port
comma
id|SiS_DDC_Index
comma
op_complement
id|SiS_DDC_Data
comma
l_int|0x00
)paren
suffix:semicolon
multiline_comment|/* TW: Write bit (0) to SD */
)brace
id|SiS_SetSCLKHigh
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/* TW: SC-&gt;high */
id|flag
op_rshift_assign
l_int|1
suffix:semicolon
)brace
id|temp
op_assign
id|SiS_CheckACK
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/* TW: Check acknowledge */
r_return
id|temp
suffix:semicolon
)brace
id|USHORT
DECL|function|SiS_ReadDDC2Data
id|SiS_ReadDDC2Data
c_func
(paren
id|USHORT
id|tempax
)paren
(brace
id|USHORT
id|i
comma
id|temp
comma
id|getdata
suffix:semicolon
id|getdata
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|8
suffix:semicolon
id|i
op_increment
)paren
(brace
id|getdata
op_lshift_assign
l_int|1
suffix:semicolon
id|SiS_SetSCLKLow
c_func
(paren
)paren
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_DDC_Port
comma
id|SiS_DDC_Index
comma
op_complement
id|SiS_DDC_Data
comma
id|SiS_DDC_Data
)paren
suffix:semicolon
id|SiS_SetSCLKHigh
c_func
(paren
)paren
suffix:semicolon
id|temp
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_DDC_Port
comma
id|SiS_DDC_Index
)paren
suffix:semicolon
r_if
c_cond
(paren
id|temp
op_amp
id|SiS_DDC_Data
)paren
(brace
id|getdata
op_or_assign
l_int|0x01
suffix:semicolon
)brace
)brace
r_return
id|getdata
suffix:semicolon
)brace
id|USHORT
DECL|function|SiS_SetSCLKLow
id|SiS_SetSCLKLow
c_func
(paren
r_void
)paren
(brace
id|USHORT
id|temp
comma
id|watchdog
op_assign
l_int|50000
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_DDC_Port
comma
id|SiS_DDC_Index
comma
op_complement
id|SiS_DDC_Clk
comma
l_int|0x00
)paren
suffix:semicolon
multiline_comment|/* SetSCLKLow()  */
r_do
(brace
id|temp
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_DDC_Port
comma
id|SiS_DDC_Index
)paren
suffix:semicolon
)brace
r_while
c_loop
(paren
(paren
id|temp
op_amp
id|SiS_DDC_Clk
)paren
op_logical_and
op_decrement
id|watchdog
)paren
(brace
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|watchdog
)paren
r_return
l_int|0xFFFF
suffix:semicolon
id|SiS_DDC2Delay
c_func
(paren
id|SiS_I2CDELAYSHORT
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|USHORT
DECL|function|SiS_SetSCLKHigh
id|SiS_SetSCLKHigh
c_func
(paren
r_void
)paren
(brace
id|USHORT
id|temp
comma
id|watchdog
op_assign
l_int|50000
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_DDC_Port
comma
id|SiS_DDC_Index
comma
op_complement
id|SiS_DDC_Clk
comma
id|SiS_DDC_Clk
)paren
suffix:semicolon
multiline_comment|/* SetSCLKHigh()  */
r_do
(brace
id|temp
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_DDC_Port
comma
id|SiS_DDC_Index
)paren
suffix:semicolon
)brace
r_while
c_loop
(paren
(paren
op_logical_neg
(paren
id|temp
op_amp
id|SiS_DDC_Clk
)paren
)paren
op_logical_and
op_decrement
id|watchdog
)paren
(brace
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|watchdog
)paren
r_return
l_int|0xFFFF
suffix:semicolon
id|SiS_DDC2Delay
c_func
(paren
id|SiS_I2CDELAYSHORT
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_void
DECL|function|SiS_DDC2Delay
id|SiS_DDC2Delay
c_func
(paren
id|USHORT
id|delaytime
)paren
(brace
id|USHORT
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|delaytime
suffix:semicolon
id|i
op_increment
)paren
(brace
id|SiS_GetReg1
c_func
(paren
id|SiS_P3c4
comma
l_int|0x05
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/* TW: Check I2C acknowledge */
multiline_comment|/* Returns 0 if ack ok, non-0 if ack not ok */
id|USHORT
DECL|function|SiS_CheckACK
id|SiS_CheckACK
c_func
(paren
r_void
)paren
(brace
id|USHORT
id|tempah
suffix:semicolon
id|SiS_SetSCLKLow
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/* TW: (SC-&gt;low) */
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_DDC_Port
comma
id|SiS_DDC_Index
comma
op_complement
id|SiS_DDC_Data
comma
id|SiS_DDC_Data
)paren
suffix:semicolon
multiline_comment|/* TW: (SD-&gt;high) */
id|SiS_SetSCLKHigh
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/* TW: SC-&gt;high = clock impulse for ack */
id|tempah
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_DDC_Port
comma
id|SiS_DDC_Index
)paren
suffix:semicolon
multiline_comment|/* TW: Read SD */
id|SiS_SetSCLKLow
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/* TW: SC-&gt;low = end of clock impulse */
r_if
c_cond
(paren
id|tempah
op_amp
id|SiS_DDC_Data
)paren
(brace
r_return
l_int|1
suffix:semicolon
)brace
multiline_comment|/* TW: Ack OK if bit = 0 */
r_else
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* TW: End of I2C functions ----------------------- */
multiline_comment|/* =============== SiS 310 O.E.M. ================= */
macro_line|#ifdef SIS315H
multiline_comment|/*&n;---------------------------------------------------------&n;   LCDResInfo 1 : 800x600          TW: Table wrong for LVDS!&n;              2 : 1024x768&n;              3 : 1280x1024&n;              4 : 1280x960         TW: 1400x1050&n;              5 : 640x480          TW: 1600x1200&n;              6 : 1600x1200&n;              7 : 1920x1440&n;   VESA&n;   non-VESA&n;   non-Expanding&n;---------------------------------------------------------&n;*/
id|USHORT
DECL|function|GetLCDPtrIndex
id|GetLCDPtrIndex
(paren
r_void
)paren
(brace
id|USHORT
id|index
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|1
)paren
(brace
multiline_comment|/* TW: Inserted entire if statement */
id|index
op_assign
id|SiS_LCDResInfo
op_amp
l_int|0x0F
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1400x1050
)paren
(brace
id|index
op_sub_assign
l_int|5
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_LCDResInfo
op_eq
id|Panel1600x1200
)paren
(brace
id|index
op_sub_assign
l_int|6
suffix:semicolon
)brace
id|index
op_decrement
suffix:semicolon
id|index
op_mul_assign
l_int|3
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDInfo
op_amp
id|LCDNonExpanding
)paren
(brace
id|index
op_add_assign
l_int|2
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_SetFlag
op_amp
id|LCDVESATiming
)paren
)paren
(brace
id|index
op_increment
suffix:semicolon
)brace
)brace
r_else
(brace
id|index
op_assign
(paren
id|SiS_LCDResInfo
op_amp
l_int|0x0F
)paren
op_minus
l_int|1
suffix:semicolon
id|index
op_mul_assign
l_int|3
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDInfo
op_amp
id|LCDNonExpanding
)paren
id|index
op_add_assign
l_int|2
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_SetFlag
op_amp
id|LCDVESATiming
)paren
)paren
id|index
op_increment
suffix:semicolon
)brace
r_return
id|index
suffix:semicolon
)brace
multiline_comment|/*&n;---------------------------------------------------------&n;       GetTVPtrIndex()&n;          return       0 : NTSC Enhanced/Standard&n;                       1 : NTSC Standard TVSimuMode&n;                       2 : PAL Enhanced/Standard&n;                       3 : PAL Standard TVSimuMode&n;                       4 : HiVision Enhanced/Standard&n;                       5 : HiVision Standard TVSimuMode&n;---------------------------------------------------------&n;*/
id|USHORT
DECL|function|GetTVPtrIndex
id|GetTVPtrIndex
c_func
(paren
r_void
)paren
(brace
id|USHORT
id|index
suffix:semicolon
id|index
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetPALTV
)paren
id|index
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToHiVisionTV
)paren
multiline_comment|/* Hivision TV use PAL */
id|index
op_increment
suffix:semicolon
id|index
op_lshift_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
op_logical_and
(paren
id|SiS_SetFlag
op_amp
id|TVSimuMode
)paren
)paren
(brace
id|index
op_increment
suffix:semicolon
)brace
r_return
id|index
suffix:semicolon
)brace
multiline_comment|/* TW: Checked against 650/LVDS (1.10.07) and 650/301LV BIOS (including data) */
r_void
DECL|function|SetDelayComp
id|SetDelayComp
c_func
(paren
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
comma
id|USHORT
id|BaseAddr
comma
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
)paren
(brace
id|USHORT
id|Part1Port
suffix:semicolon
id|USHORT
id|delay
comma
id|index
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToRAMDAC
)paren
(brace
id|delay
op_assign
id|SiS310_CRT2DelayCompensation1
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBType
op_amp
(paren
id|VB_SIS301B
op_or
id|VB_SIS302B
)paren
)paren
id|delay
op_assign
id|SiS310_CRT2DelayCompensation2
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|1
)paren
(brace
id|delay
op_assign
id|SiS310_CRT2DelayCompensation3
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCD
)paren
(brace
id|index
op_assign
id|GetLCDPtrIndex
c_func
(paren
)paren
suffix:semicolon
id|delay
op_assign
id|SiS310_LCDDelayCompensation1
(braket
id|index
)braket
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBType
op_amp
(paren
id|VB_SIS301B
op_or
id|VB_SIS302B
op_or
id|VB_SIS301LV
)paren
)paren
id|delay
op_assign
id|SiS310_LCDDelayCompensation2
(braket
id|index
)braket
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|1
)paren
(brace
id|delay
op_assign
id|SiS310_LCDDelayCompensation3
(braket
id|index
)braket
suffix:semicolon
)brace
)brace
r_else
(brace
id|index
op_assign
id|GetTVPtrIndex
c_func
(paren
)paren
suffix:semicolon
id|delay
op_assign
id|SiS310_TVDelayCompensation1
(braket
id|index
)braket
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBType
op_amp
(paren
id|VB_SIS301B
op_or
id|VB_SIS302B
)paren
)paren
id|delay
op_assign
id|SiS310_TVDelayCompensation2
(braket
id|index
)braket
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|1
)paren
(brace
id|delay
op_assign
id|SiS310_TVDelayCompensation3
(braket
id|index
)braket
suffix:semicolon
)brace
)brace
id|Part1Port
op_assign
id|BaseAddr
op_plus
id|SIS_CRT2_PORT_04
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|1
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
(brace
id|SiS_SetRegANDOR
c_func
(paren
id|Part1Port
comma
l_int|0x2D
comma
l_int|0xF0
comma
id|delay
)paren
suffix:semicolon
)brace
r_else
(brace
id|delay
op_lshift_assign
l_int|4
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|Part1Port
comma
l_int|0x2D
comma
l_int|0x0F
comma
id|delay
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
id|SiS_SetRegANDOR
c_func
(paren
id|Part1Port
comma
l_int|0x2D
comma
l_int|0xF0
comma
id|delay
)paren
suffix:semicolon
multiline_comment|/* index 2D D[3:0] */
)brace
)brace
multiline_comment|/* TW: Checked against 650/301LV BIOS (including data) */
r_void
DECL|function|SetAntiFlicker
id|SetAntiFlicker
c_func
(paren
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
comma
id|USHORT
id|BaseAddr
comma
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
)paren
(brace
id|USHORT
id|Part2Port
suffix:semicolon
id|USHORT
id|index
comma
id|temp
suffix:semicolon
id|Part2Port
op_assign
id|BaseAddr
op_plus
id|SIS_CRT2_PORT_10
suffix:semicolon
id|temp
op_assign
id|GetTVPtrIndex
c_func
(paren
)paren
suffix:semicolon
id|temp
op_rshift_assign
l_int|1
suffix:semicolon
multiline_comment|/* 0: NTSC, 1 :PAL, 2:HiTV */
r_if
c_cond
(paren
id|ModeNo
op_le
l_int|0x13
)paren
id|index
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|VB_StTVFlickerIndex
suffix:semicolon
r_else
id|index
op_assign
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|VB_ExtTVFlickerIndex
suffix:semicolon
id|temp
op_assign
id|SiS310_TVAntiFlick1
(braket
id|temp
)braket
(braket
id|index
)braket
suffix:semicolon
id|temp
op_lshift_assign
l_int|4
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|Part2Port
comma
l_int|0x0A
comma
l_int|0x8f
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* index 0A D[6:4] */
)brace
multiline_comment|/* TW: Checked against 650/301LV BIOS (including data) */
r_void
DECL|function|SetEdgeEnhance
id|SetEdgeEnhance
c_func
(paren
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
comma
id|USHORT
id|BaseAddr
comma
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
)paren
(brace
id|USHORT
id|Part2Port
suffix:semicolon
id|USHORT
id|index
comma
id|temp
suffix:semicolon
id|Part2Port
op_assign
id|BaseAddr
op_plus
id|SIS_CRT2_PORT_10
suffix:semicolon
id|temp
op_assign
id|GetTVPtrIndex
c_func
(paren
)paren
suffix:semicolon
id|temp
op_rshift_assign
l_int|1
suffix:semicolon
multiline_comment|/* 0: NTSC, 1 :PAL, 2:HiTV */
r_if
c_cond
(paren
id|ModeNo
op_le
l_int|0x13
)paren
id|index
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|VB_StTVEdgeIndex
suffix:semicolon
r_else
id|index
op_assign
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|VB_ExtTVEdgeIndex
suffix:semicolon
id|temp
op_assign
id|SiS310_TVEdge1
(braket
id|temp
)braket
(braket
id|index
)braket
suffix:semicolon
id|temp
op_lshift_assign
l_int|5
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|Part2Port
comma
l_int|0x3A
comma
l_int|0x1F
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* index 0A D[7:5] */
)brace
multiline_comment|/* TW: Checked against 650/301LV BIOS */
r_void
DECL|function|SetYFilter
id|SetYFilter
c_func
(paren
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
comma
id|USHORT
id|BaseAddr
comma
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
)paren
(brace
id|USHORT
id|Part2Port
suffix:semicolon
id|USHORT
id|index
comma
id|temp
comma
id|i
comma
id|j
suffix:semicolon
id|UCHAR
id|OutputSelect
op_assign
op_star
id|pSiS_OutputSelect
suffix:semicolon
id|Part2Port
op_assign
id|BaseAddr
op_plus
id|SIS_CRT2_PORT_10
suffix:semicolon
id|temp
op_assign
id|GetTVPtrIndex
c_func
(paren
)paren
suffix:semicolon
id|temp
op_rshift_assign
l_int|1
suffix:semicolon
multiline_comment|/* 0: NTSC, 1 :PAL, 2:HiTV */
r_if
c_cond
(paren
id|ModeNo
op_le
l_int|0x13
)paren
(brace
id|index
op_assign
id|SiS_SModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|VB_StTVYFilterIndex
suffix:semicolon
)brace
r_else
(brace
id|index
op_assign
id|SiS_EModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|VB_ExtTVYFilterIndex
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToHiVisionTV
)paren
multiline_comment|/* Hivision TV uses PAL */
id|temp
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0x35
comma
id|j
op_assign
l_int|0
suffix:semicolon
id|i
op_le
l_int|0x38
suffix:semicolon
id|i
op_increment
comma
id|j
op_increment
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|Part2Port
comma
id|i
comma
id|SiS310_TVYFilter2
(braket
id|temp
)braket
(braket
id|index
)braket
(braket
id|j
)braket
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0x48
suffix:semicolon
id|i
op_le
l_int|0x4A
suffix:semicolon
id|i
op_increment
comma
id|j
op_increment
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|Part2Port
comma
id|i
comma
id|SiS310_TVYFilter2
(braket
id|temp
)braket
(braket
id|index
)braket
(braket
id|j
)braket
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0x35
comma
id|j
op_assign
l_int|0
suffix:semicolon
id|i
op_le
l_int|0x38
suffix:semicolon
id|i
op_increment
comma
id|j
op_increment
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|Part2Port
comma
id|i
comma
id|SiS310_TVYFilter1
(braket
id|temp
)braket
(braket
id|index
)braket
(braket
id|j
)braket
)paren
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|OutputSelect
op_amp
id|EnablePALMN
)paren
(brace
r_if
c_cond
(paren
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x31
)paren
op_amp
l_int|0x01
)paren
(brace
id|temp
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x38
)paren
suffix:semicolon
id|temp
op_and_assign
(paren
id|EnablePALMN
op_or
id|EnablePALN
)paren
suffix:semicolon
r_if
c_cond
(paren
id|temp
op_eq
id|EnablePALMN
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0x35
comma
id|j
op_assign
l_int|0
suffix:semicolon
id|i
op_le
l_int|0x38
suffix:semicolon
id|i
op_increment
comma
id|j
op_increment
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|Part2Port
comma
id|i
comma
id|SiS310_PALMFilter2
(braket
id|index
)braket
(braket
id|j
)braket
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0x48
suffix:semicolon
id|i
op_le
l_int|0x4A
suffix:semicolon
id|i
op_increment
comma
id|j
op_increment
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|Part2Port
comma
id|i
comma
id|SiS310_PALMFilter2
(braket
id|index
)braket
(braket
id|j
)braket
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0x35
comma
id|j
op_assign
l_int|0
suffix:semicolon
id|i
op_le
l_int|0x38
suffix:semicolon
id|i
op_increment
comma
id|j
op_increment
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|Part2Port
comma
id|i
comma
id|SiS310_PALMFilter
(braket
id|index
)braket
(braket
id|j
)braket
)paren
suffix:semicolon
)brace
)brace
)brace
r_if
c_cond
(paren
id|temp
op_eq
id|EnablePALN
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0x35
comma
id|j
op_assign
l_int|0
suffix:semicolon
id|i
op_le
l_int|0x38
suffix:semicolon
id|i
op_increment
comma
id|j
op_increment
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|Part2Port
comma
id|i
comma
id|SiS310_PALNFilter2
(braket
id|index
)braket
(braket
id|j
)braket
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0x48
comma
id|j
op_assign
l_int|0
suffix:semicolon
id|i
op_le
l_int|0x4A
suffix:semicolon
id|i
op_increment
comma
id|j
op_increment
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|Part2Port
comma
id|i
comma
id|SiS310_PALNFilter2
(braket
id|index
)braket
(braket
id|j
)braket
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0x35
comma
id|j
op_assign
l_int|0
suffix:semicolon
id|i
op_le
l_int|0x38
suffix:semicolon
id|i
op_increment
comma
id|j
op_increment
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|Part2Port
comma
id|i
comma
id|SiS310_PALNFilter
(braket
id|index
)braket
(braket
id|j
)braket
)paren
suffix:semicolon
)brace
)brace
)brace
)brace
)brace
)brace
multiline_comment|/* TW: Checked against 650/301LV BIOS (including data) */
r_void
DECL|function|SetPhaseIncr
id|SetPhaseIncr
c_func
(paren
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
comma
id|USHORT
id|BaseAddr
comma
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
)paren
(brace
id|USHORT
id|Part2Port
suffix:semicolon
id|USHORT
id|index
comma
id|temp
comma
id|temp1
comma
id|i
comma
id|j
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
)paren
(brace
r_return
suffix:semicolon
)brace
id|temp1
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x38
)paren
suffix:semicolon
multiline_comment|/* if PALM/N not set */
id|temp1
op_and_assign
(paren
id|EnablePALMN
op_or
id|EnablePALN
)paren
suffix:semicolon
r_if
c_cond
(paren
id|temp1
)paren
(brace
r_return
suffix:semicolon
)brace
id|Part2Port
op_assign
id|BaseAddr
op_plus
id|SIS_CRT2_PORT_10
suffix:semicolon
id|temp
op_assign
id|GetTVPtrIndex
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/* 0: NTSC Graphics, 1: NTSC Text,    2:PAL Graphics,&n;   * 3: PAL Text,      4: HiTV Graphics 5:HiTV Text&n;   */
id|index
op_assign
id|temp
op_mod
l_int|2
suffix:semicolon
id|temp
op_rshift_assign
l_int|1
suffix:semicolon
multiline_comment|/* 0:NTSC, 1:PAL, 2:HiTV */
r_for
c_loop
(paren
id|j
op_assign
l_int|0
comma
id|i
op_assign
l_int|0x31
suffix:semicolon
id|i
op_le
l_int|0x34
suffix:semicolon
id|i
op_increment
comma
id|j
op_increment
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|Part2Port
comma
id|i
comma
id|SiS310_TVPhaseIncr1
(braket
id|temp
)braket
(braket
id|index
)braket
(braket
id|j
)braket
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
)paren
op_logical_or
(paren
id|SiS_SetFlag
op_amp
id|TVSimuMode
)paren
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|Part2Port
comma
id|i
comma
id|SiS310_TVPhaseIncr2
(braket
id|temp
)braket
(braket
id|index
)braket
(braket
id|j
)braket
)paren
suffix:semicolon
)brace
r_else
id|SiS_SetReg1
c_func
(paren
id|Part2Port
comma
id|i
comma
id|SiS310_TVPhaseIncr1
(braket
id|temp
)braket
(braket
id|index
)braket
(braket
id|j
)braket
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_VBType
op_amp
(paren
id|VB_SIS301LV
op_or
id|VB_SIS302LV
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetPALTV
)paren
)paren
(brace
r_if
c_cond
(paren
(paren
id|ModeNo
op_eq
l_int|0x38
)paren
op_logical_or
(paren
id|ModeNo
op_eq
l_int|0x4a
)paren
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x31
comma
l_int|0x1e
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x32
comma
l_int|0x8c
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x33
comma
l_int|0x5c
)paren
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x34
comma
l_int|0x7a
)paren
suffix:semicolon
)brace
)brace
)brace
)brace
r_void
DECL|function|SiS_OEM310Setting
id|SiS_OEM310Setting
c_func
(paren
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
comma
id|USHORT
id|BaseAddr
comma
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
)paren
(brace
id|SetDelayComp
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
comma
id|ROMAddr
comma
id|ModeNo
)paren
suffix:semicolon
multiline_comment|/* TW: The TV funtions are not for LVDS */
r_if
c_cond
(paren
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|0
)paren
op_logical_and
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
)paren
(brace
id|SetAntiFlicker
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
comma
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
)paren
suffix:semicolon
id|SetPhaseIncr
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
comma
id|ROMAddr
comma
id|ModeNo
)paren
suffix:semicolon
id|SetYFilter
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
comma
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
)paren
(brace
id|SetEdgeEnhance
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
comma
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
)paren
suffix:semicolon
)brace
)brace
)brace
multiline_comment|/* TW: New and checked from 650/301LV BIOS */
r_void
DECL|function|SiS_OEMLCD
id|SiS_OEMLCD
c_func
(paren
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
comma
id|USHORT
id|BaseAddr
comma
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
)paren
(brace
id|USHORT
id|tempbx
comma
id|tempah
comma
id|tempbl
comma
id|tempbh
comma
id|tempcl
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|1
)paren
(brace
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCDA
)paren
(brace
id|SiS_UnLockCRT2
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
)paren
suffix:semicolon
id|tempbh
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x1a
)paren
suffix:semicolon
id|tempbh
op_and_assign
l_int|0x38
suffix:semicolon
id|tempbh
op_rshift_assign
l_int|3
suffix:semicolon
id|tempbl
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x18
)paren
suffix:semicolon
id|tempbx
op_assign
(paren
id|tempbh
op_lshift
l_int|8
)paren
op_or
id|tempbl
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDTypeInfo
op_eq
l_int|1
)paren
(brace
id|tempbx
op_sub_assign
l_int|0x12
suffix:semicolon
)brace
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x18
comma
id|tempbx
op_amp
l_int|0x00ff
)paren
suffix:semicolon
id|tempah
op_assign
(paren
id|tempbx
op_amp
l_int|0xff00
)paren
op_rshift
l_int|8
suffix:semicolon
id|tempah
op_and_assign
l_int|0x07
suffix:semicolon
id|tempah
op_lshift_assign
l_int|3
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x1a
comma
l_int|0xc7
comma
id|tempah
)paren
suffix:semicolon
id|tempah
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x19
)paren
suffix:semicolon
id|tempah
op_and_assign
l_int|0x0f
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDTypeInfo
op_eq
l_int|1
)paren
(brace
id|tempah
op_sub_assign
l_int|2
suffix:semicolon
)brace
id|tempah
op_and_assign
l_int|0x0f
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x19
comma
l_int|0xF0
comma
id|tempah
)paren
suffix:semicolon
id|tempah
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x14
)paren
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDTypeInfo
op_eq
l_int|1
)paren
(brace
id|tempah
op_increment
suffix:semicolon
)brace
id|tempah
op_sub_assign
l_int|8
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part1Port
comma
l_int|0x14
comma
id|tempah
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCD
)paren
(brace
id|tempcl
op_assign
id|tempbh
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x01
)paren
suffix:semicolon
id|tempbh
op_and_assign
l_int|0x70
suffix:semicolon
id|tempbh
op_rshift_assign
l_int|4
suffix:semicolon
id|tempbl
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x04
)paren
suffix:semicolon
id|tempbx
op_assign
(paren
id|tempbh
op_lshift
l_int|8
)paren
op_or
id|tempbl
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDTypeInfo
op_eq
l_int|1
)paren
(brace
id|tempbx
op_sub_assign
l_int|0x1e
suffix:semicolon
id|tempcl
op_and_assign
l_int|0x0f
suffix:semicolon
id|tempcl
op_sub_assign
l_int|4
suffix:semicolon
id|tempcl
op_and_assign
l_int|0x0f
suffix:semicolon
)brace
id|tempbl
op_assign
id|tempbx
op_amp
l_int|0x00ff
suffix:semicolon
id|tempbh
op_assign
(paren
id|tempbx
op_rshift
l_int|8
)paren
op_amp
l_int|0x00ff
suffix:semicolon
id|SiS_SetReg1
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x04
comma
id|tempbl
)paren
suffix:semicolon
id|tempbh
op_lshift_assign
l_int|4
suffix:semicolon
id|tempbh
op_or_assign
id|tempcl
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|SiS_Part2Port
comma
l_int|0x01
comma
l_int|0x80
comma
id|tempbh
)paren
suffix:semicolon
)brace
)brace
macro_line|#endif
multiline_comment|/*  =================  SiS 300 O.E.M. ================== */
macro_line|#ifdef SIS300
macro_line|#if 0   /* Not used */
id|USHORT
id|GetRevisionID
c_func
(paren
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
)paren
(brace
id|ULONG
id|temp1
suffix:semicolon
macro_line|#ifndef LINUX_XF86
id|ULONG
id|base
suffix:semicolon
macro_line|#endif
id|USHORT
id|temp2
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
(paren
id|HwDeviceExtension-&gt;jChipType
op_eq
id|SIS_540
)paren
op_logical_or
(paren
id|HwDeviceExtension-&gt;jChipType
op_eq
id|SIS_630
)paren
op_logical_or
(paren
id|HwDeviceExtension-&gt;jChipType
op_eq
id|SIS_730
)paren
)paren
(brace
macro_line|#ifndef LINUX_XF86
id|base
op_assign
l_int|0x80000008
suffix:semicolon
id|OutPortLong
c_func
(paren
id|base
comma
l_int|0xcf8
)paren
suffix:semicolon
id|temp1
op_assign
id|InPortLong
c_func
(paren
l_int|0xcfc
)paren
suffix:semicolon
macro_line|#else
id|temp1
op_assign
id|pciReadLong
c_func
(paren
l_int|0x00000000
comma
l_int|0x08
)paren
suffix:semicolon
macro_line|#endif
id|temp1
op_and_assign
l_int|0x000000FF
suffix:semicolon
id|temp2
op_assign
(paren
id|USHORT
)paren
(paren
id|temp1
)paren
suffix:semicolon
r_return
id|temp2
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#endif
multiline_comment|/* TW: Checked against 630/301B BIOS (incl data) */
id|USHORT
DECL|function|GetOEMLCDPtr
id|GetOEMLCDPtr
c_func
(paren
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
comma
r_int
id|Flag
)paren
(brace
id|USHORT
id|tempbx
op_assign
l_int|0
suffix:semicolon
id|UCHAR
id|customtable
(braket
)braket
op_assign
(brace
l_int|0xff
comma
l_int|0xff
comma
l_int|0xff
comma
l_int|0xff
comma
l_int|0xff
comma
l_int|0xff
comma
l_int|0xff
comma
l_int|0xff
comma
l_int|0xff
comma
l_int|0xff
comma
l_int|0xff
comma
l_int|0xff
comma
l_int|0xff
comma
l_int|0xff
comma
l_int|0xff
comma
l_int|0xff
)brace
suffix:semicolon
r_if
c_cond
(paren
id|Flag
)paren
(brace
r_if
c_cond
(paren
id|customtable
(braket
id|SiS_LCDTypeInfo
)braket
op_eq
l_int|0xFF
)paren
(brace
r_return
l_int|0xFFFF
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|0
)paren
(brace
id|tempbx
op_assign
id|SiS_LCDTypeInfo
op_lshift
l_int|2
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
(brace
id|tempbx
op_add_assign
l_int|2
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_LCDInfo
op_amp
id|LCDNonExpanding
)paren
(brace
id|tempbx
op_increment
suffix:semicolon
)brace
)brace
r_else
(brace
id|tempbx
op_assign
id|SiS_LCDTypeInfo
suffix:semicolon
r_if
c_cond
(paren
id|SiS_LCDInfo
op_amp
id|LCDNonExpanding
)paren
(brace
id|tempbx
op_add_assign
l_int|16
suffix:semicolon
)brace
)brace
r_return
id|tempbx
suffix:semicolon
)brace
multiline_comment|/* TW: Checked against 630/301B and 630/LVDS BIOS (incl data) */
r_void
DECL|function|SetOEMLCDDelay
id|SetOEMLCDDelay
c_func
(paren
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
comma
id|USHORT
id|BaseAddr
comma
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
)paren
(brace
id|USHORT
id|Part1Port
suffix:semicolon
id|USHORT
id|index
comma
id|temp
suffix:semicolon
multiline_comment|/* TW: The Panel Compensation Delay should be set according to tables&n;   *     here. Unfortunately, the different BIOS versions don&squot;t case about&n;   *     a uniform way using eg. ROM byte 0x220, but use different&n;   *     hard coded delays (0x04, 0x20, 0x18) in SetGroup1(). So we can&squot;t&n;   *     rely on the other OEM bits in 0x237, 0x238 here either.&n;   */
macro_line|#if 0
r_if
c_cond
(paren
id|ROMAddr
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|ROMAddr
(braket
l_int|0x237
)braket
op_amp
l_int|0x01
)paren
)paren
(brace
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|ROMAddr
(braket
l_int|0x237
)braket
op_amp
l_int|0x02
)paren
)paren
(brace
r_return
suffix:semicolon
)brace
)brace
macro_line|#endif
multiline_comment|/* TW: We just check if a non-standard delay has been set; if not,&n;   * we use our tables. Otherwise don&squot;t do anything here.&n;   */
r_if
c_cond
(paren
id|ROMAddr
)paren
(brace
r_if
c_cond
(paren
id|ROMAddr
(braket
l_int|0x220
)braket
op_amp
l_int|0x80
)paren
(brace
r_return
suffix:semicolon
)brace
)brace
multiline_comment|/* TW: We don&squot;t need to set this if the user select a custom pdc */
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;pdc
)paren
(brace
r_return
suffix:semicolon
)brace
id|Part1Port
op_assign
id|BaseAddr
op_plus
id|SIS_CRT2_PORT_04
suffix:semicolon
id|temp
op_assign
id|GetOEMLCDPtr
c_func
(paren
id|HwDeviceExtension
comma
l_int|0
)paren
suffix:semicolon
id|index
op_assign
id|SiS_VBModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|VB_LCDDelayIndex
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|0
)paren
(brace
id|temp
op_assign
id|SiS300_OEMLCDDelay2
(braket
id|temp
)braket
(braket
id|index
)braket
suffix:semicolon
)brace
r_else
(brace
id|temp
op_assign
id|SiS300_OEMLCDDelay3
(braket
id|temp
)braket
(braket
id|index
)braket
suffix:semicolon
)brace
id|temp
op_and_assign
l_int|0x3c
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|Part1Port
comma
l_int|0x13
comma
op_complement
l_int|0x3C
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* index 0A D[6:4] */
)brace
multiline_comment|/* TW: Checked against 630/301B and 630/LVDS BIOS */
id|USHORT
DECL|function|GetOEMTVPtr
id|GetOEMTVPtr
c_func
(paren
r_void
)paren
(brace
id|USHORT
id|index
suffix:semicolon
id|index
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|SiS_VBInfo
op_amp
id|SetInSlaveMode
)paren
)paren
(brace
id|index
op_add_assign
l_int|4
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToSCART
)paren
(brace
id|index
op_add_assign
l_int|2
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToHiVisionTV
)paren
id|index
op_add_assign
l_int|3
suffix:semicolon
r_else
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetPALTV
)paren
(brace
id|index
op_add_assign
l_int|1
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCHTVOverScan
)paren
(brace
id|index
op_add_assign
l_int|2
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetPALTV
)paren
(brace
id|index
op_add_assign
l_int|1
suffix:semicolon
)brace
)brace
r_return
id|index
suffix:semicolon
)brace
multiline_comment|/* TW: Checked against 630/301B and 630/LVDS BIOS (incl data) */
r_void
DECL|function|SetOEMTVDelay
id|SetOEMTVDelay
c_func
(paren
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
comma
id|USHORT
id|BaseAddr
comma
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
)paren
(brace
id|USHORT
id|Part1Port
suffix:semicolon
id|USHORT
id|index
comma
id|temp
suffix:semicolon
macro_line|#if 0
r_if
c_cond
(paren
id|ROMAddr
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|ROMAddr
(braket
l_int|0x238
)braket
op_amp
l_int|0x01
)paren
)paren
(brace
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|ROMAddr
(braket
l_int|0x238
)braket
op_amp
l_int|0x02
)paren
)paren
(brace
r_return
suffix:semicolon
)brace
)brace
macro_line|#endif
id|Part1Port
op_assign
id|BaseAddr
op_plus
id|SIS_CRT2_PORT_04
suffix:semicolon
id|temp
op_assign
id|GetOEMTVPtr
c_func
(paren
)paren
suffix:semicolon
id|index
op_assign
id|SiS_VBModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|VB_TVDelayIndex
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|0
)paren
(brace
id|temp
op_assign
id|SiS300_OEMTVDelay301
(braket
id|temp
)braket
(braket
id|index
)braket
suffix:semicolon
)brace
r_else
(brace
id|temp
op_assign
id|SiS300_OEMTVDelayLVDS
(braket
id|temp
)braket
(braket
id|index
)braket
suffix:semicolon
)brace
id|temp
op_and_assign
l_int|0x3c
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|Part1Port
comma
l_int|0x13
comma
op_complement
l_int|0x3C
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* index 0A D[6:4] */
)brace
multiline_comment|/* TW: Checked against 630/301B BIOS (incl data) */
r_void
DECL|function|SetOEMAntiFlicker
id|SetOEMAntiFlicker
c_func
(paren
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
comma
id|USHORT
id|BaseAddr
comma
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
)paren
(brace
id|USHORT
id|Part2Port
suffix:semicolon
id|USHORT
id|index
comma
id|temp
suffix:semicolon
id|Part2Port
op_assign
id|BaseAddr
op_plus
id|SIS_CRT2_PORT_10
suffix:semicolon
id|temp
op_assign
id|GetOEMTVPtr
c_func
(paren
)paren
suffix:semicolon
id|index
op_assign
id|SiS_VBModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|VB_TVFlickerIndex
suffix:semicolon
id|temp
op_assign
id|SiS300_OEMTVFlicker
(braket
id|temp
)braket
(braket
id|index
)braket
suffix:semicolon
id|temp
op_and_assign
l_int|0x70
suffix:semicolon
id|SiS_SetRegANDOR
c_func
(paren
id|Part2Port
comma
l_int|0x0A
comma
l_int|0x8F
comma
id|temp
)paren
suffix:semicolon
multiline_comment|/* index 0A D[6:4] */
)brace
multiline_comment|/* TW: Checked against 630/301B BIOS (incl data) */
r_void
DECL|function|SetOEMPhaseIncr
id|SetOEMPhaseIncr
c_func
(paren
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
comma
id|USHORT
id|BaseAddr
comma
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
)paren
(brace
id|USHORT
id|Part2Port
suffix:semicolon
id|USHORT
id|index
comma
id|i
comma
id|j
comma
id|temp
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToHiVisionTV
)paren
(brace
r_return
suffix:semicolon
)brace
id|Part2Port
op_assign
id|BaseAddr
op_plus
id|SIS_CRT2_PORT_10
suffix:semicolon
id|temp
op_assign
id|GetOEMTVPtr
c_func
(paren
)paren
suffix:semicolon
id|index
op_assign
id|SiS_VBModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|VB_TVPhaseIndex
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0x31
comma
id|j
op_assign
l_int|0
suffix:semicolon
id|i
op_le
l_int|0x34
suffix:semicolon
id|i
op_increment
comma
id|j
op_increment
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|Part2Port
comma
id|i
comma
id|SiS300_Phase2
(braket
id|temp
)braket
(braket
id|index
)braket
(braket
id|j
)braket
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0x31
comma
id|j
op_assign
l_int|0
suffix:semicolon
id|i
op_le
l_int|0x34
suffix:semicolon
id|i
op_increment
comma
id|j
op_increment
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|Part2Port
comma
id|i
comma
id|SiS300_Phase1
(braket
id|temp
)braket
(braket
id|index
)braket
(braket
id|j
)braket
)paren
suffix:semicolon
)brace
)brace
)brace
multiline_comment|/* TW: Checked against 630/301B BIOS (incl data) */
r_void
DECL|function|SetOEMYFilter
id|SetOEMYFilter
c_func
(paren
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
comma
id|USHORT
id|BaseAddr
comma
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
comma
id|USHORT
id|ModeIdIndex
)paren
(brace
id|USHORT
id|Part2Port
suffix:semicolon
id|USHORT
id|index
comma
id|temp
comma
id|temp1
comma
id|i
comma
id|j
suffix:semicolon
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
(paren
id|SetCRT2ToSCART
op_or
id|SetCRT2ToHiVisionTV
)paren
)paren
(brace
r_return
suffix:semicolon
)brace
id|Part2Port
op_assign
id|BaseAddr
op_plus
id|SIS_CRT2_PORT_10
suffix:semicolon
id|temp
op_assign
id|GetOEMTVPtr
c_func
(paren
)paren
suffix:semicolon
id|index
op_assign
id|SiS_VBModeIDTable
(braket
id|ModeIdIndex
)braket
dot
id|VB_TVYFilterIndex
suffix:semicolon
r_if
c_cond
(paren
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x31
)paren
op_amp
l_int|0x01
)paren
(brace
id|temp1
op_assign
id|SiS_GetReg1
c_func
(paren
id|SiS_P3d4
comma
l_int|0x35
)paren
suffix:semicolon
r_if
c_cond
(paren
id|temp1
op_amp
(paren
id|EnablePALMN
op_or
id|EnablePALN
)paren
)paren
(brace
id|temp
op_assign
l_int|16
suffix:semicolon
r_if
c_cond
(paren
id|temp1
op_amp
id|EnablePALN
)paren
(brace
id|temp
op_assign
l_int|18
suffix:semicolon
)brace
)brace
)brace
r_if
c_cond
(paren
id|SiS_VBType
op_amp
id|VB_SIS301BLV302BLV
)paren
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0x35
comma
id|j
op_assign
l_int|0
suffix:semicolon
id|i
op_le
l_int|0x38
suffix:semicolon
id|i
op_increment
comma
id|j
op_increment
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|Part2Port
comma
id|i
comma
id|SiS300_Filter2
(braket
id|temp
)braket
(braket
id|index
)braket
(braket
id|j
)braket
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0x48
suffix:semicolon
id|i
op_le
l_int|0x4A
suffix:semicolon
id|i
op_increment
comma
id|j
op_increment
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|Part2Port
comma
id|i
comma
id|SiS300_Filter2
(braket
id|temp
)braket
(braket
id|index
)braket
(braket
id|j
)braket
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0x35
comma
id|j
op_assign
l_int|0
suffix:semicolon
id|i
op_le
l_int|0x38
suffix:semicolon
id|i
op_increment
comma
id|j
op_increment
)paren
(brace
id|SiS_SetReg1
c_func
(paren
id|Part2Port
comma
id|i
comma
id|SiS300_Filter1
(braket
id|temp
)braket
(braket
id|index
)braket
(braket
id|j
)braket
)paren
suffix:semicolon
)brace
)brace
)brace
r_void
DECL|function|SiS_OEM300Setting
id|SiS_OEM300Setting
c_func
(paren
id|PSIS_HW_DEVICE_INFO
id|HwDeviceExtension
comma
id|USHORT
id|BaseAddr
comma
id|UCHAR
op_star
id|ROMAddr
comma
id|USHORT
id|ModeNo
)paren
(brace
id|USHORT
id|ModeIdIndex
suffix:semicolon
id|ModeIdIndex
op_assign
id|SiS_SearchVBModeID
c_func
(paren
id|ROMAddr
comma
op_amp
id|ModeNo
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|ModeIdIndex
)paren
)paren
(brace
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToLCD
)paren
(brace
id|SetOEMLCDDelay
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
comma
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|SiS_VBInfo
op_amp
id|SetCRT2ToTV
)paren
(brace
id|SetOEMTVDelay
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
comma
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
)paren
suffix:semicolon
r_if
c_cond
(paren
id|SiS_IF_DEF_LVDS
op_eq
l_int|0
)paren
(brace
id|SetOEMAntiFlicker
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
comma
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
)paren
suffix:semicolon
id|SetOEMPhaseIncr
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
comma
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
)paren
suffix:semicolon
id|SetOEMYFilter
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
comma
id|ROMAddr
comma
id|ModeNo
comma
id|ModeIdIndex
)paren
suffix:semicolon
)brace
)brace
)brace
macro_line|#endif
eof
