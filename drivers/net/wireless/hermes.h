multiline_comment|/* hermes.h&n; *&n; * Driver core for the &quot;Hermes&quot; wireless MAC controller, as used in&n; * the Lucent Orinoco and Cabletron RoamAbout cards. It should also&n; * work on the hfa3841 and hfa3842 MAC controller chips used in the&n; * Prism I &amp; II chipsets.&n; *&n; * This is not a complete driver, just low-level access routines for&n; * the MAC controller itself.&n; *&n; * Based on the prism2 driver from Absolute Value Systems&squot; linux-wlan&n; * project, the Linux wvlan_cs driver, Lucent&squot;s HCF-Light&n; * (wvlan_hcf.c) library, and the NetBSD wireless driver.&n; *&n; * Copyright (C) 2000, David Gibson, Linuxcare Australia &lt;hermes@gibson.dropbear.id.au&gt;&n; *&n; * Portions taken from hfa384x.h, Copyright (C) 1999 AbsoluteValue Systems, Inc. All Rights Reserved.&n; *&n; * This file distributed under the GPL, version 2.&n; */
macro_line|#ifndef _HERMES_H
DECL|macro|_HERMES_H
mdefine_line|#define _HERMES_H
multiline_comment|/* Notes on locking:&n; *&n; * As a module of low level hardware access routines, there is no&n; * locking. Users of this module should ensure that they serialize&n; * access to the hermes_t structure, and to the hardware&n;*/
macro_line|#include &lt;linux/delay.h&gt;
macro_line|#include &lt;linux/if_ether.h&gt;
multiline_comment|/*&n; * Limits and constants&n; */
DECL|macro|HERMES_ALLOC_LEN_MIN
mdefine_line|#define&t;&t;HERMES_ALLOC_LEN_MIN&t;&t;(4)
DECL|macro|HERMES_ALLOC_LEN_MAX
mdefine_line|#define&t;&t;HERMES_ALLOC_LEN_MAX&t;&t;(2400)
DECL|macro|HERMES_LTV_LEN_MAX
mdefine_line|#define&t;&t;HERMES_LTV_LEN_MAX&t;&t;(34)
DECL|macro|HERMES_BAP_DATALEN_MAX
mdefine_line|#define&t;&t;HERMES_BAP_DATALEN_MAX&t;&t;(4096)
DECL|macro|HERMES_BAP_OFFSET_MAX
mdefine_line|#define&t;&t;HERMES_BAP_OFFSET_MAX&t;&t;(4096)
DECL|macro|HERMES_PORTID_MAX
mdefine_line|#define&t;&t;HERMES_PORTID_MAX&t;&t;(7)
DECL|macro|HERMES_NUMPORTS_MAX
mdefine_line|#define&t;&t;HERMES_NUMPORTS_MAX&t;&t;(HERMES_PORTID_MAX+1)
DECL|macro|HERMES_PDR_LEN_MAX
mdefine_line|#define&t;&t;HERMES_PDR_LEN_MAX&t;&t;(260)&t;/* in bytes, from EK */
DECL|macro|HERMES_PDA_RECS_MAX
mdefine_line|#define&t;&t;HERMES_PDA_RECS_MAX&t;&t;(200)&t;/* a guess */
DECL|macro|HERMES_PDA_LEN_MAX
mdefine_line|#define&t;&t;HERMES_PDA_LEN_MAX&t;&t;(1024)&t;/* in bytes, from EK */
DECL|macro|HERMES_SCANRESULT_MAX
mdefine_line|#define&t;&t;HERMES_SCANRESULT_MAX&t;&t;(35)
DECL|macro|HERMES_CHINFORESULT_MAX
mdefine_line|#define&t;&t;HERMES_CHINFORESULT_MAX&t;&t;(8)
DECL|macro|HERMES_FRAME_LEN_MAX
mdefine_line|#define&t;&t;HERMES_FRAME_LEN_MAX&t;&t;(2304)
DECL|macro|HERMES_MAX_MULTICAST
mdefine_line|#define&t;&t;HERMES_MAX_MULTICAST&t;&t;(16)
DECL|macro|HERMES_MAGIC
mdefine_line|#define&t;&t;HERMES_MAGIC&t;&t;&t;(0x7d1f)
multiline_comment|/*&n; * Hermes register offsets&n; */
DECL|macro|HERMES_CMD
mdefine_line|#define&t;&t;HERMES_CMD&t;&t;&t;(0x00)
DECL|macro|HERMES_PARAM0
mdefine_line|#define&t;&t;HERMES_PARAM0&t;&t;&t;(0x02)
DECL|macro|HERMES_PARAM1
mdefine_line|#define&t;&t;HERMES_PARAM1&t;&t;&t;(0x04)
DECL|macro|HERMES_PARAM2
mdefine_line|#define&t;&t;HERMES_PARAM2&t;&t;&t;(0x06)
DECL|macro|HERMES_STATUS
mdefine_line|#define&t;&t;HERMES_STATUS&t;&t;&t;(0x08)
DECL|macro|HERMES_RESP0
mdefine_line|#define&t;&t;HERMES_RESP0&t;&t;&t;(0x0A)
DECL|macro|HERMES_RESP1
mdefine_line|#define&t;&t;HERMES_RESP1&t;&t;&t;(0x0C)
DECL|macro|HERMES_RESP2
mdefine_line|#define&t;&t;HERMES_RESP2&t;&t;&t;(0x0E)
DECL|macro|HERMES_INFOFID
mdefine_line|#define&t;&t;HERMES_INFOFID&t;&t;&t;(0x10)
DECL|macro|HERMES_RXFID
mdefine_line|#define&t;&t;HERMES_RXFID&t;&t;&t;(0x20)
DECL|macro|HERMES_ALLOCFID
mdefine_line|#define&t;&t;HERMES_ALLOCFID&t;&t;&t;(0x22)
DECL|macro|HERMES_TXCOMPLFID
mdefine_line|#define&t;&t;HERMES_TXCOMPLFID&t;&t;(0x24)
DECL|macro|HERMES_SELECT0
mdefine_line|#define&t;&t;HERMES_SELECT0&t;&t;&t;(0x18)
DECL|macro|HERMES_OFFSET0
mdefine_line|#define&t;&t;HERMES_OFFSET0&t;&t;&t;(0x1C)
DECL|macro|HERMES_DATA0
mdefine_line|#define&t;&t;HERMES_DATA0&t;&t;&t;(0x36)
DECL|macro|HERMES_SELECT1
mdefine_line|#define&t;&t;HERMES_SELECT1&t;&t;&t;(0x1A)
DECL|macro|HERMES_OFFSET1
mdefine_line|#define&t;&t;HERMES_OFFSET1&t;&t;&t;(0x1E)
DECL|macro|HERMES_DATA1
mdefine_line|#define&t;&t;HERMES_DATA1&t;&t;&t;(0x38)
DECL|macro|HERMES_EVSTAT
mdefine_line|#define&t;&t;HERMES_EVSTAT&t;&t;&t;(0x30)
DECL|macro|HERMES_INTEN
mdefine_line|#define&t;&t;HERMES_INTEN&t;&t;&t;(0x32)
DECL|macro|HERMES_EVACK
mdefine_line|#define&t;&t;HERMES_EVACK&t;&t;&t;(0x34)
DECL|macro|HERMES_CONTROL
mdefine_line|#define&t;&t;HERMES_CONTROL&t;&t;&t;(0x14)
DECL|macro|HERMES_SWSUPPORT0
mdefine_line|#define&t;&t;HERMES_SWSUPPORT0&t;&t;(0x28)
DECL|macro|HERMES_SWSUPPORT1
mdefine_line|#define&t;&t;HERMES_SWSUPPORT1&t;&t;(0x2A)
DECL|macro|HERMES_SWSUPPORT2
mdefine_line|#define&t;&t;HERMES_SWSUPPORT2&t;&t;(0x2C)
DECL|macro|HERMES_AUXPAGE
mdefine_line|#define&t;&t;HERMES_AUXPAGE&t;&t;&t;(0x3A)
DECL|macro|HERMES_AUXOFFSET
mdefine_line|#define&t;&t;HERMES_AUXOFFSET&t;&t;(0x3C)
DECL|macro|HERMES_AUXDATA
mdefine_line|#define&t;&t;HERMES_AUXDATA&t;&t;&t;(0x3E)
multiline_comment|/*&n; * CMD register bitmasks&n; */
DECL|macro|HERMES_CMD_BUSY
mdefine_line|#define&t;&t;HERMES_CMD_BUSY&t;&t;&t;(0x8000)
DECL|macro|HERMES_CMD_AINFO
mdefine_line|#define&t;&t;HERMES_CMD_AINFO&t;&t;(0x7f00)
DECL|macro|HERMES_CMD_MACPORT
mdefine_line|#define&t;&t;HERMES_CMD_MACPORT&t;&t;(0x0700)
DECL|macro|HERMES_CMD_RECL
mdefine_line|#define&t;&t;HERMES_CMD_RECL&t;&t;&t;(0x0100)
DECL|macro|HERMES_CMD_WRITE
mdefine_line|#define&t;&t;HERMES_CMD_WRITE&t;&t;(0x0100)
DECL|macro|HERMES_CMD_PROGMODE
mdefine_line|#define&t;&t;HERMES_CMD_PROGMODE&t;&t;(0x0300)
DECL|macro|HERMES_CMD_CMDCODE
mdefine_line|#define&t;&t;HERMES_CMD_CMDCODE&t;&t;(0x003f)
multiline_comment|/*&n; * STATUS register bitmasks&n; */
DECL|macro|HERMES_STATUS_RESULT
mdefine_line|#define&t;&t;HERMES_STATUS_RESULT&t;&t;(0x7f00)
DECL|macro|HERMES_STATUS_CMDCODE
mdefine_line|#define&t;&t;HERMES_STATUS_CMDCODE&t;&t;(0x003f)
multiline_comment|/*&n; * OFFSET refister bitmasks&n; */
DECL|macro|HERMES_OFFSET_BUSY
mdefine_line|#define&t;&t;HERMES_OFFSET_BUSY&t;&t;(0x8000)
DECL|macro|HERMES_OFFSET_ERR
mdefine_line|#define&t;&t;HERMES_OFFSET_ERR&t;&t;(0x4000)
DECL|macro|HERMES_OFFSET_DATAOFF
mdefine_line|#define&t;&t;HERMES_OFFSET_DATAOFF&t;&t;(0x0ffe)
multiline_comment|/*&n; * Event register bitmasks (INTEN, EVSTAT, EVACK)&n; */
DECL|macro|HERMES_EV_TICK
mdefine_line|#define&t;&t;HERMES_EV_TICK&t;&t;&t;(0x8000)
DECL|macro|HERMES_EV_WTERR
mdefine_line|#define&t;&t;HERMES_EV_WTERR&t;&t;&t;(0x4000)
DECL|macro|HERMES_EV_INFDROP
mdefine_line|#define&t;&t;HERMES_EV_INFDROP&t;&t;(0x2000)
DECL|macro|HERMES_EV_INFO
mdefine_line|#define&t;&t;HERMES_EV_INFO&t;&t;&t;(0x0080)
DECL|macro|HERMES_EV_DTIM
mdefine_line|#define&t;&t;HERMES_EV_DTIM&t;&t;&t;(0x0020)
DECL|macro|HERMES_EV_CMD
mdefine_line|#define&t;&t;HERMES_EV_CMD&t;&t;&t;(0x0010)
DECL|macro|HERMES_EV_ALLOC
mdefine_line|#define&t;&t;HERMES_EV_ALLOC&t;&t;&t;(0x0008)
DECL|macro|HERMES_EV_TXEXC
mdefine_line|#define&t;&t;HERMES_EV_TXEXC&t;&t;&t;(0x0004)
DECL|macro|HERMES_EV_TX
mdefine_line|#define&t;&t;HERMES_EV_TX&t;&t;&t;(0x0002)
DECL|macro|HERMES_EV_RX
mdefine_line|#define&t;&t;HERMES_EV_RX&t;&t;&t;(0x0001)
multiline_comment|/*&n; * Command codes&n; */
multiline_comment|/*--- Controller Commands --------------------------*/
DECL|macro|HERMES_CMD_INIT
mdefine_line|#define&t;&t;HERMES_CMD_INIT&t;&t;&t;(0x0000)
DECL|macro|HERMES_CMD_ENABLE
mdefine_line|#define&t;&t;HERMES_CMD_ENABLE&t;&t;(0x0001)
DECL|macro|HERMES_CMD_DISABLE
mdefine_line|#define&t;&t;HERMES_CMD_DISABLE&t;&t;(0x0002)
DECL|macro|HERMES_CMD_DIAG
mdefine_line|#define&t;&t;HERMES_CMD_DIAG&t;&t;&t;(0x0003)
multiline_comment|/*--- Buffer Mgmt Commands --------------------------*/
DECL|macro|HERMES_CMD_ALLOC
mdefine_line|#define&t;&t;HERMES_CMD_ALLOC&t;&t;(0x000A)
DECL|macro|HERMES_CMD_TX
mdefine_line|#define&t;&t;HERMES_CMD_TX&t;&t;&t;(0x000B)
DECL|macro|HERMES_CMD_CLRPRST
mdefine_line|#define&t;&t;HERMES_CMD_CLRPRST&t;&t;(0x0012)
multiline_comment|/*--- Regulate Commands --------------------------*/
DECL|macro|HERMES_CMD_NOTIFY
mdefine_line|#define&t;&t;HERMES_CMD_NOTIFY&t;&t;(0x0010)
DECL|macro|HERMES_CMD_INQ
mdefine_line|#define&t;&t;HERMES_CMD_INQ&t;&t;&t;(0x0011)
multiline_comment|/*--- Configure Commands --------------------------*/
DECL|macro|HERMES_CMD_ACCESS
mdefine_line|#define&t;&t;HERMES_CMD_ACCESS&t;&t;(0x0021)
DECL|macro|HERMES_CMD_DOWNLD
mdefine_line|#define&t;&t;HERMES_CMD_DOWNLD&t;&t;(0x0022)
multiline_comment|/*--- Debugging Commands -----------------------------*/
DECL|macro|HERMES_CMD_MONITOR
mdefine_line|#define &t;HERMES_CMD_MONITOR&t;&t;(0x0038)
DECL|macro|HERMES_MONITOR_ENABLE
mdefine_line|#define&t;&t;HERMES_MONITOR_ENABLE&t;&t;(0x000b)
DECL|macro|HERMES_MONITOR_DISABLE
mdefine_line|#define&t;&t;HERMES_MONITOR_DISABLE&t;&t;(0x000f)
multiline_comment|/*&n; * Configuration RIDs&n; */
DECL|macro|HERMES_RID_CNF_PORTTYPE
mdefine_line|#define&t;&t;HERMES_RID_CNF_PORTTYPE&t;&t;(0xfc00)
DECL|macro|HERMES_RID_CNF_MACADDR
mdefine_line|#define&t;&t;HERMES_RID_CNF_MACADDR&t;&t;(0xfc01)
DECL|macro|HERMES_RID_CNF_DESIRED_SSID
mdefine_line|#define&t;&t;HERMES_RID_CNF_DESIRED_SSID&t;(0xfc02)
DECL|macro|HERMES_RID_CNF_CHANNEL
mdefine_line|#define&t;&t;HERMES_RID_CNF_CHANNEL&t;&t;(0xfc03)
DECL|macro|HERMES_RID_CNF_OWN_SSID
mdefine_line|#define&t;&t;HERMES_RID_CNF_OWN_SSID&t;&t;(0xfc04)
DECL|macro|HERMES_RID_CNF_SYSTEM_SCALE
mdefine_line|#define&t;&t;HERMES_RID_CNF_SYSTEM_SCALE&t;(0xfc06)
DECL|macro|HERMES_RID_CNF_MAX_DATA_LEN
mdefine_line|#define&t;&t;HERMES_RID_CNF_MAX_DATA_LEN&t;(0xfc07)
DECL|macro|HERMES_RID_CNF_PM_ENABLE
mdefine_line|#define&t;&t;HERMES_RID_CNF_PM_ENABLE&t;(0xfc09)
DECL|macro|HERMES_RID_CNF_PM_MCAST_RX
mdefine_line|#define&t;&t;HERMES_RID_CNF_PM_MCAST_RX&t;(0xfc0b)
DECL|macro|HERMES_RID_CNF_PM_PERIOD
mdefine_line|#define&t;&t;HERMES_RID_CNF_PM_PERIOD&t;(0xfc0c)
DECL|macro|HERMES_RID_CNF_PM_HOLDOVER
mdefine_line|#define&t;&t;HERMES_RID_CNF_PM_HOLDOVER&t;(0xfc0d)
DECL|macro|HERMES_RID_CNF_NICKNAME
mdefine_line|#define&t;&t;HERMES_RID_CNF_NICKNAME&t;&t;(0xfc0e)
DECL|macro|HERMES_RID_CNF_WEP_ON
mdefine_line|#define&t;&t;HERMES_RID_CNF_WEP_ON&t;&t;(0xfc20)
DECL|macro|HERMES_RID_CNF_MWO_ROBUST
mdefine_line|#define&t;&t;HERMES_RID_CNF_MWO_ROBUST&t;(0xfc25)
DECL|macro|HERMES_RID_CNF_MULTICAST_LIST
mdefine_line|#define&t;&t;HERMES_RID_CNF_MULTICAST_LIST&t;(0xfc80)
DECL|macro|HERMES_RID_CNF_CREATEIBSS
mdefine_line|#define&t;&t;HERMES_RID_CNF_CREATEIBSS&t;(0xfc81)
DECL|macro|HERMES_RID_CNF_FRAG_THRESH
mdefine_line|#define&t;&t;HERMES_RID_CNF_FRAG_THRESH&t;(0xfc82)
DECL|macro|HERMES_RID_CNF_RTS_THRESH
mdefine_line|#define&t;&t;HERMES_RID_CNF_RTS_THRESH&t;(0xfc83)
DECL|macro|HERMES_RID_CNF_TX_RATE_CTRL
mdefine_line|#define&t;&t;HERMES_RID_CNF_TX_RATE_CTRL&t;(0xfc84)
DECL|macro|HERMES_RID_CNF_PROMISCUOUS
mdefine_line|#define&t;&t;HERMES_RID_CNF_PROMISCUOUS&t;(0xfc85)
DECL|macro|HERMES_RID_CNF_KEYS
mdefine_line|#define&t;&t;HERMES_RID_CNF_KEYS&t;&t;(0xfcb0)
DECL|macro|HERMES_RID_CNF_TX_KEY
mdefine_line|#define&t;&t;HERMES_RID_CNF_TX_KEY&t;&t;(0xfcb1)
DECL|macro|HERMES_RID_CNF_TICKTIME
mdefine_line|#define&t;&t;HERMES_RID_CNF_TICKTIME&t;&t;(0xfce0)
DECL|macro|HERMES_RID_CNF_PRISM2_WEP_ON
mdefine_line|#define&t;&t;HERMES_RID_CNF_PRISM2_WEP_ON&t;(0xfc28)
DECL|macro|HERMES_RID_CNF_PRISM2_TX_KEY
mdefine_line|#define&t;&t;HERMES_RID_CNF_PRISM2_TX_KEY&t;(0xfc23)
DECL|macro|HERMES_RID_CNF_PRISM2_KEY0
mdefine_line|#define&t;&t;HERMES_RID_CNF_PRISM2_KEY0&t;(0xfc24)
DECL|macro|HERMES_RID_CNF_PRISM2_KEY1
mdefine_line|#define&t;&t;HERMES_RID_CNF_PRISM2_KEY1&t;(0xfc25)
DECL|macro|HERMES_RID_CNF_PRISM2_KEY2
mdefine_line|#define&t;&t;HERMES_RID_CNF_PRISM2_KEY2&t;(0xfc26)
DECL|macro|HERMES_RID_CNF_PRISM2_KEY3
mdefine_line|#define&t;&t;HERMES_RID_CNF_PRISM2_KEY3&t;(0xfc27)
DECL|macro|HERMES_RID_CNF_SYMBOL_MANDATORY_BSSID
mdefine_line|#define&t;&t;HERMES_RID_CNF_SYMBOL_MANDATORY_BSSID&t;(0xfc21)
DECL|macro|HERMES_RID_CNF_SYMBOL_AUTH_TYPE
mdefine_line|#define&t;&t;HERMES_RID_CNF_SYMBOL_AUTH_TYPE&t;&t;(0xfc2A)
DECL|macro|HERMES_RID_CNF_SYMBOL_BASIC_RATES
mdefine_line|#define&t;&t;HERMES_RID_CNF_SYMBOL_BASIC_RATES&t;(0xfc8A)
DECL|macro|HERMES_RID_CNF_SYMBOL_PREAMBLE
mdefine_line|#define&t;&t;HERMES_RID_CNF_SYMBOL_PREAMBLE&t;&t;(0xfc8C)
multiline_comment|/*&n; * Information RIDs&n; */
DECL|macro|HERMES_RID_CHANNEL_LIST
mdefine_line|#define&t;&t;HERMES_RID_CHANNEL_LIST&t;&t;(0xfd10)
DECL|macro|HERMES_RID_STAIDENTITY
mdefine_line|#define&t;&t;HERMES_RID_STAIDENTITY&t;&t;(0xfd20)
DECL|macro|HERMES_RID_CURRENT_SSID
mdefine_line|#define&t;&t;HERMES_RID_CURRENT_SSID&t;&t;(0xfd41)
DECL|macro|HERMES_RID_CURRENT_BSSID
mdefine_line|#define&t;&t;HERMES_RID_CURRENT_BSSID&t;(0xfd42)
DECL|macro|HERMES_RID_COMMSQUALITY
mdefine_line|#define&t;&t;HERMES_RID_COMMSQUALITY&t;&t;(0xfd43)
DECL|macro|HERMES_RID_CURRENT_TX_RATE
mdefine_line|#define &t;HERMES_RID_CURRENT_TX_RATE&t;(0xfd44)
DECL|macro|HERMES_RID_SHORT_RETRY_LIMIT
mdefine_line|#define &t;HERMES_RID_SHORT_RETRY_LIMIT&t;(0xfd48)
DECL|macro|HERMES_RID_LONG_RETRY_LIMIT
mdefine_line|#define &t;HERMES_RID_LONG_RETRY_LIMIT&t;(0xfd49)
DECL|macro|HERMES_RID_MAX_TX_LIFETIME
mdefine_line|#define &t;HERMES_RID_MAX_TX_LIFETIME&t;(0xfd4A)
DECL|macro|HERMES_RID_WEP_AVAIL
mdefine_line|#define&t;&t;HERMES_RID_WEP_AVAIL&t;&t;(0xfd4f)
DECL|macro|HERMES_RID_CURRENT_CHANNEL
mdefine_line|#define&t;&t;HERMES_RID_CURRENT_CHANNEL&t;(0xfdc1)
DECL|macro|HERMES_RID_DATARATES
mdefine_line|#define&t;&t;HERMES_RID_DATARATES&t;&t;(0xfdc6)
DECL|macro|HERMES_RID_SYMBOL_PRIMARY_VER
mdefine_line|#define&t;&t;HERMES_RID_SYMBOL_PRIMARY_VER&t;(0xfd03)
DECL|macro|HERMES_RID_SYMBOL_SECONDARY_VER
mdefine_line|#define&t;&t;HERMES_RID_SYMBOL_SECONDARY_VER&t;(0xfd21)
DECL|macro|HERMES_RID_SYMBOL_KEY_LENGTH
mdefine_line|#define&t;&t;HERMES_RID_SYMBOL_KEY_LENGTH&t;(0xfc2B)
multiline_comment|/*&n; * Frame structures and constants&n; */
DECL|struct|hermes_frame_desc
r_typedef
r_struct
id|hermes_frame_desc
(brace
multiline_comment|/* Hermes - i.e. little-endian byte-order */
DECL|member|status
r_uint16
id|status
suffix:semicolon
multiline_comment|/* 0x0 */
DECL|member|res1
DECL|member|res2
r_uint16
id|res1
comma
id|res2
suffix:semicolon
multiline_comment|/* 0x2, 0x4 */
DECL|member|q_info
r_uint16
id|q_info
suffix:semicolon
multiline_comment|/* 0x6 */
DECL|member|res3
DECL|member|res4
r_uint16
id|res3
comma
id|res4
suffix:semicolon
multiline_comment|/* 0x8, 0xA */
DECL|member|tx_ctl
r_uint16
id|tx_ctl
suffix:semicolon
multiline_comment|/* 0xC */
DECL|typedef|hermes_frame_desc_t
)brace
id|__attribute__
(paren
(paren
id|packed
)paren
)paren
id|hermes_frame_desc_t
suffix:semicolon
DECL|macro|HERMES_RXSTAT_ERR
mdefine_line|#define&t;&t;HERMES_RXSTAT_ERR&t;&t;(0x0003)
DECL|macro|HERMES_RXSTAT_MACPORT
mdefine_line|#define&t;&t;HERMES_RXSTAT_MACPORT&t;&t;(0x0700)
DECL|macro|HERMES_RXSTAT_MSGTYPE
mdefine_line|#define&t;&t;HERMES_RXSTAT_MSGTYPE&t;&t;(0xE000)
DECL|macro|HERMES_RXSTAT_BADCRC
mdefine_line|#define&t;&t;HERMES_RXSTAT_BADCRC&t;&t;(0x0001)
DECL|macro|HERMES_RXSTAT_UNDECRYPTABLE
mdefine_line|#define&t;&t;HERMES_RXSTAT_UNDECRYPTABLE&t;(0x0002)
multiline_comment|/* RFC-1042 encoded frame */
DECL|macro|HERMES_RXSTAT_1042
mdefine_line|#define&t;&t;HERMES_RXSTAT_1042&t;&t;(0x2000)
multiline_comment|/* Bridge-tunnel encoded frame */
DECL|macro|HERMES_RXSTAT_TUNNEL
mdefine_line|#define&t;&t;HERMES_RXSTAT_TUNNEL&t;&t;(0x4000)
multiline_comment|/* Wavelan-II Management Protocol frame */
DECL|macro|HERMES_RXSTAT_WMP
mdefine_line|#define&t;&t;HERMES_RXSTAT_WMP&t;&t;(0x6000)
macro_line|#ifdef __KERNEL__
multiline_comment|/* Basic control structure */
DECL|struct|hermes
r_typedef
r_struct
id|hermes
(brace
DECL|member|iobase
id|uint
id|iobase
suffix:semicolon
DECL|member|inten
r_uint16
id|inten
suffix:semicolon
multiline_comment|/* Which interrupts should be enabled? */
DECL|typedef|hermes_t
)brace
id|hermes_t
suffix:semicolon
DECL|struct|hermes_response
r_typedef
r_struct
id|hermes_response
(brace
DECL|member|status
DECL|member|resp0
DECL|member|resp1
DECL|member|resp2
r_uint16
id|status
comma
id|resp0
comma
id|resp1
comma
id|resp2
suffix:semicolon
DECL|typedef|hermes_response_t
)brace
id|hermes_response_t
suffix:semicolon
multiline_comment|/* Firmware information structure */
DECL|struct|hermes_identity
r_typedef
r_struct
id|hermes_identity
(brace
DECL|member|id
DECL|member|vendor
DECL|member|major
DECL|member|minor
r_uint16
id|id
comma
id|vendor
comma
id|major
comma
id|minor
suffix:semicolon
DECL|typedef|hermes_identity_t
)brace
id|__attribute__
(paren
(paren
id|packed
)paren
)paren
id|hermes_identity_t
suffix:semicolon
multiline_comment|/* &quot;ID&quot; structure - used for ESSID and station nickname */
DECL|struct|hermes_id
r_typedef
r_struct
id|hermes_id
(brace
DECL|member|len
r_uint16
id|len
suffix:semicolon
DECL|member|val
r_uint16
id|val
(braket
l_int|16
)braket
suffix:semicolon
DECL|typedef|hermes_id_t
)brace
id|__attribute__
(paren
(paren
id|packed
)paren
)paren
id|hermes_id_t
suffix:semicolon
DECL|struct|hermes_commsqual
r_typedef
r_struct
id|hermes_commsqual
(brace
DECL|member|qual
DECL|member|signal
DECL|member|noise
r_uint16
id|qual
comma
id|signal
comma
id|noise
suffix:semicolon
DECL|typedef|hermes_commsqual_t
)brace
id|__attribute__
(paren
(paren
id|packed
)paren
)paren
id|hermes_commsqual_t
suffix:semicolon
DECL|struct|hermes_multicast
r_typedef
r_struct
id|hermes_multicast
(brace
DECL|member|addr
r_uint8
id|addr
(braket
id|HERMES_MAX_MULTICAST
)braket
(braket
id|ETH_ALEN
)braket
suffix:semicolon
DECL|typedef|hermes_multicast_t
)brace
id|__attribute__
(paren
(paren
id|packed
)paren
)paren
id|hermes_multicast_t
suffix:semicolon
multiline_comment|/* Register access convenience macros */
DECL|macro|hermes_read_reg
mdefine_line|#define hermes_read_reg(hw, off) (inw((hw)-&gt;iobase + (off)))
DECL|macro|hermes_write_reg
mdefine_line|#define hermes_write_reg(hw, off, val) (outw_p((val), (hw)-&gt;iobase + (off)))
DECL|macro|hermes_read_regn
mdefine_line|#define hermes_read_regn(hw, name) (hermes_read_reg((hw), HERMES_##name))
DECL|macro|hermes_write_regn
mdefine_line|#define hermes_write_regn(hw, name, val) (hermes_write_reg((hw), HERMES_##name, (val)))
multiline_comment|/* Note that for the next two, the count is in 16-bit words, not bytes */
DECL|macro|hermes_read_data
mdefine_line|#define hermes_read_data(hw, off, buf, count) (insw((hw)-&gt;iobase + (off), (buf), (count)))
DECL|macro|hermes_write_data
mdefine_line|#define hermes_write_data(hw, off, buf, count) (outsw((hw)-&gt;iobase + (off), (buf), (count)))
multiline_comment|/* Function prototypes */
r_void
id|hermes_struct_init
c_func
(paren
id|hermes_t
op_star
id|hw
comma
id|uint
id|io
)paren
suffix:semicolon
r_int
id|hermes_reset
c_func
(paren
id|hermes_t
op_star
id|hw
)paren
suffix:semicolon
r_int
id|hermes_docmd_wait
c_func
(paren
id|hermes_t
op_star
id|hw
comma
r_uint16
id|cmd
comma
r_uint16
id|parm0
comma
id|hermes_response_t
op_star
id|resp
)paren
suffix:semicolon
r_int
id|hermes_allocate
c_func
(paren
id|hermes_t
op_star
id|hw
comma
r_uint16
id|size
comma
r_uint16
op_star
id|fid
)paren
suffix:semicolon
r_int
id|hermes_bap_pread
c_func
(paren
id|hermes_t
op_star
id|hw
comma
r_int
id|bap
comma
r_void
op_star
id|buf
comma
r_uint16
id|len
comma
r_uint16
id|id
comma
r_uint16
id|offset
)paren
suffix:semicolon
r_int
id|hermes_bap_pwrite
c_func
(paren
id|hermes_t
op_star
id|hw
comma
r_int
id|bap
comma
r_const
r_void
op_star
id|buf
comma
r_uint16
id|len
comma
r_uint16
id|id
comma
r_uint16
id|offset
)paren
suffix:semicolon
r_int
id|hermes_read_ltv
c_func
(paren
id|hermes_t
op_star
id|hw
comma
r_int
id|bap
comma
r_uint16
id|rid
comma
r_int
id|buflen
comma
r_uint16
op_star
id|length
comma
r_void
op_star
id|buf
)paren
suffix:semicolon
r_int
id|hermes_write_ltv
c_func
(paren
id|hermes_t
op_star
id|hw
comma
r_int
id|bap
comma
r_uint16
id|rid
comma
r_uint16
id|length
comma
r_const
r_void
op_star
id|value
)paren
suffix:semicolon
multiline_comment|/* Inline functions */
DECL|function|hermes_present
r_static
r_inline
r_int
id|hermes_present
c_func
(paren
id|hermes_t
op_star
id|hw
)paren
(brace
r_return
id|hermes_read_regn
c_func
(paren
id|hw
comma
id|SWSUPPORT0
)paren
op_eq
id|HERMES_MAGIC
suffix:semicolon
)brace
DECL|function|hermes_enable_interrupt
r_static
r_inline
r_void
id|hermes_enable_interrupt
c_func
(paren
id|hermes_t
op_star
id|hw
comma
r_uint16
id|events
)paren
(brace
id|hw-&gt;inten
op_or_assign
id|events
suffix:semicolon
id|hermes_write_regn
c_func
(paren
id|hw
comma
id|INTEN
comma
id|hw-&gt;inten
)paren
suffix:semicolon
)brace
DECL|function|hermes_set_irqmask
r_static
r_inline
r_void
id|hermes_set_irqmask
c_func
(paren
id|hermes_t
op_star
id|hw
comma
r_uint16
id|events
)paren
(brace
id|hw-&gt;inten
op_assign
id|events
suffix:semicolon
id|hermes_write_regn
c_func
(paren
id|hw
comma
id|INTEN
comma
id|events
)paren
suffix:semicolon
)brace
DECL|function|hermes_enable_port
r_static
r_inline
r_int
id|hermes_enable_port
c_func
(paren
id|hermes_t
op_star
id|hw
comma
r_int
id|port
)paren
(brace
id|hermes_response_t
id|resp
suffix:semicolon
r_return
id|hermes_docmd_wait
c_func
(paren
id|hw
comma
id|HERMES_CMD_ENABLE
op_or
(paren
id|port
op_lshift
l_int|8
)paren
comma
l_int|0
comma
op_amp
id|resp
)paren
suffix:semicolon
)brace
DECL|function|hermes_disable_port
r_static
r_inline
r_int
id|hermes_disable_port
c_func
(paren
id|hermes_t
op_star
id|hw
comma
r_int
id|port
)paren
(brace
id|hermes_response_t
id|resp
suffix:semicolon
r_return
id|hermes_docmd_wait
c_func
(paren
id|hw
comma
id|HERMES_CMD_ENABLE
op_or
(paren
id|port
op_lshift
l_int|8
)paren
comma
l_int|0
comma
op_amp
id|resp
)paren
suffix:semicolon
)brace
DECL|macro|HERMES_BYTES_TO_RECLEN
mdefine_line|#define HERMES_BYTES_TO_RECLEN(n) ( ((n) % 2) ? (((n)+1)/2)+1 : ((n)/2)+1 )
DECL|macro|HERMES_RECLEN_TO_BYTES
mdefine_line|#define HERMES_RECLEN_TO_BYTES(n) ( ((n)-1) * 2 )
DECL|macro|HERMES_READ_RECORD
mdefine_line|#define HERMES_READ_RECORD(hw, bap, rid, buf) &bslash;&n;&t;(hermes_read_ltv((hw),(bap),(rid), sizeof(*buf), NULL, (buf)))
DECL|macro|HERMES_WRITE_RECORD
mdefine_line|#define HERMES_WRITE_RECORD(hw, bap, rid, buf) &bslash;&n;&t;(hermes_write_ltv((hw),(bap),(rid),HERMES_BYTES_TO_RECLEN(sizeof(*buf)),(buf)))
DECL|function|hermes_read_wordrec
r_static
r_inline
r_int
id|hermes_read_wordrec
c_func
(paren
id|hermes_t
op_star
id|hw
comma
r_int
id|bap
comma
r_uint16
id|rid
comma
r_uint16
op_star
id|word
)paren
(brace
r_uint16
id|rec
suffix:semicolon
r_int
id|err
suffix:semicolon
id|err
op_assign
id|HERMES_READ_RECORD
c_func
(paren
id|hw
comma
id|bap
comma
id|rid
comma
op_amp
id|rec
)paren
suffix:semicolon
op_star
id|word
op_assign
id|le16_to_cpu
c_func
(paren
id|rec
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|function|hermes_write_wordrec
r_static
r_inline
r_int
id|hermes_write_wordrec
c_func
(paren
id|hermes_t
op_star
id|hw
comma
r_int
id|bap
comma
r_uint16
id|rid
comma
r_uint16
id|word
)paren
(brace
r_uint16
id|rec
op_assign
id|cpu_to_le16
c_func
(paren
id|word
)paren
suffix:semicolon
r_return
id|HERMES_WRITE_RECORD
c_func
(paren
id|hw
comma
id|bap
comma
id|rid
comma
op_amp
id|rec
)paren
suffix:semicolon
)brace
DECL|function|hermes_read_staidentity
r_static
r_inline
r_int
id|hermes_read_staidentity
c_func
(paren
id|hermes_t
op_star
id|hw
comma
r_int
id|bap
comma
id|hermes_identity_t
op_star
id|buf
)paren
(brace
r_int
id|err
suffix:semicolon
id|err
op_assign
id|HERMES_READ_RECORD
c_func
(paren
id|hw
comma
id|bap
comma
id|HERMES_RID_STAIDENTITY
comma
id|buf
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
id|le16_to_cpus
c_func
(paren
op_amp
id|buf-&gt;id
)paren
suffix:semicolon
id|le16_to_cpus
c_func
(paren
op_amp
id|buf-&gt;vendor
)paren
suffix:semicolon
id|le16_to_cpus
c_func
(paren
op_amp
id|buf-&gt;major
)paren
suffix:semicolon
id|le16_to_cpus
c_func
(paren
op_amp
id|buf-&gt;minor
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|hermes_read_commsqual
r_static
r_inline
r_int
id|hermes_read_commsqual
c_func
(paren
id|hermes_t
op_star
id|hw
comma
r_int
id|bap
comma
id|hermes_commsqual_t
op_star
id|buf
)paren
(brace
r_int
id|err
suffix:semicolon
id|err
op_assign
id|HERMES_READ_RECORD
c_func
(paren
id|hw
comma
id|bap
comma
id|HERMES_RID_COMMSQUALITY
comma
id|buf
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
id|le16_to_cpus
c_func
(paren
op_amp
id|buf-&gt;qual
)paren
suffix:semicolon
id|le16_to_cpus
c_func
(paren
op_amp
id|buf-&gt;signal
)paren
suffix:semicolon
id|le16_to_cpus
c_func
(paren
op_amp
id|buf-&gt;noise
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#else /* ! __KERNEL__ */
multiline_comment|/* These are provided for the benefit of userspace drivers and testing programs&n;   which use ioperm() or iopl() */
DECL|macro|hermes_read_reg
mdefine_line|#define hermes_read_reg(base, off) (inw((base) + (off)))
DECL|macro|hermes_write_reg
mdefine_line|#define hermes_write_reg(base, off, val) (outw((val), (base) + (off)))
DECL|macro|hermes_read_regn
mdefine_line|#define hermes_read_regn(base, name) (hermes_read_reg((base), HERMES_##name))
DECL|macro|hermes_write_regn
mdefine_line|#define hermes_write_regn(base, name, val) (hermes_write_reg((base), HERMES_##name, (val)))
multiline_comment|/* Note that for the next two, the count is in 16-bit words, not bytes */
DECL|macro|hermes_read_data
mdefine_line|#define hermes_read_data(base, off, buf, count) (insw((base) + (off), (buf), (count)))
DECL|macro|hermes_write_data
mdefine_line|#define hermes_write_data(base, off, buf, count) (outsw((base) + (off), (buf), (count)))
macro_line|#endif /* ! __KERNEL__ */
macro_line|#endif  /* _HERMES_H */
eof
