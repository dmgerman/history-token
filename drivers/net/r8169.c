multiline_comment|/*&n;=========================================================================&n; r8169.c: A RealTek RTL-8169 Gigabit Ethernet driver for Linux kernel 2.4.x.&n; --------------------------------------------------------------------&n;&n; History:&n; Feb  4 2002&t;- created initially by ShuChen &lt;shuchen@realtek.com.tw&gt;.&n; May 20 2002&t;- Add link status force-mode and TBI mode support.&n;        2004&t;- Massive updates. See kernel SCM system for details.&n;=========================================================================&n;  1. [DEPRECATED: use ethtool instead] The media can be forced in 5 modes.&n;&t; Command: &squot;insmod r8169 media = SET_MEDIA&squot;&n;&t; Ex:&t;  &squot;insmod r8169 media = 0x04&squot; will force PHY to operate in 100Mpbs Half-duplex.&n;&t;&n;&t; SET_MEDIA can be:&n; &t;&t;_10_Half&t;= 0x01&n; &t;&t;_10_Full&t;= 0x02&n; &t;&t;_100_Half&t;= 0x04&n; &t;&t;_100_Full&t;= 0x08&n; &t;&t;_1000_Full&t;= 0x10&n;  &n;  2. Support TBI mode.&n;=========================================================================&n;VERSION 1.1&t;&lt;2002/10/4&gt;&n;&n;&t;The bit4:0 of MII register 4 is called &quot;selector field&quot;, and have to be&n;&t;00001b to indicate support of IEEE std 802.3 during NWay process of&n;&t;exchanging Link Code Word (FLP). &n;&n;VERSION 1.2&t;&lt;2002/11/30&gt;&n;&n;&t;- Large style cleanup&n;&t;- Use ether_crc in stock kernel (linux/crc32.h)&n;&t;- Copy mc_filter setup code from 8139cp&n;&t;  (includes an optimization, and avoids set_bit use)&n;&n;VERSION 1.6LK&t;&lt;2004/04/14&gt;&n;&n;&t;- Merge of Realtek&squot;s version 1.6&n;&t;- Conversion to DMA API&n;&t;- Suspend/resume&n;&t;- Endianness&n;&t;- Misc Rx/Tx bugs&n;*/
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/moduleparam.h&gt;
macro_line|#include &lt;linux/pci.h&gt;
macro_line|#include &lt;linux/netdevice.h&gt;
macro_line|#include &lt;linux/etherdevice.h&gt;
macro_line|#include &lt;linux/delay.h&gt;
macro_line|#include &lt;linux/ethtool.h&gt;
macro_line|#include &lt;linux/mii.h&gt;
macro_line|#include &lt;linux/if_vlan.h&gt;
macro_line|#include &lt;linux/crc32.h&gt;
macro_line|#include &lt;linux/in.h&gt;
macro_line|#include &lt;linux/ip.h&gt;
macro_line|#include &lt;linux/tcp.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/dma-mapping.h&gt;
macro_line|#include &lt;asm/io.h&gt;
DECL|macro|RTL8169_VERSION
mdefine_line|#define RTL8169_VERSION &quot;1.6LK&quot;
DECL|macro|MODULENAME
mdefine_line|#define MODULENAME &quot;r8169&quot;
DECL|macro|RTL8169_DRIVER_NAME
mdefine_line|#define RTL8169_DRIVER_NAME   MODULENAME &quot; Gigabit Ethernet driver &quot; RTL8169_VERSION
DECL|macro|PFX
mdefine_line|#define PFX MODULENAME &quot;: &quot;
macro_line|#ifdef RTL8169_DEBUG
DECL|macro|assert
mdefine_line|#define assert(expr) &bslash;&n;        if(!(expr)) {&t;&t;&t;&t;&t;&bslash;&n;&t;        printk( &quot;Assertion failed! %s,%s,%s,line=%d&bslash;n&quot;,&t;&bslash;&n;        &t;#expr,__FILE__,__FUNCTION__,__LINE__);&t;&t;&bslash;&n;        }
DECL|macro|dprintk
mdefine_line|#define dprintk(fmt, args...)&t;do { printk(PFX fmt, ## args) } while (0)
macro_line|#else
DECL|macro|assert
mdefine_line|#define assert(expr) do {} while (0)
DECL|macro|dprintk
mdefine_line|#define dprintk(fmt, args...)&t;do {} while (0)
macro_line|#endif /* RTL8169_DEBUG */
DECL|macro|TX_BUFFS_AVAIL
mdefine_line|#define TX_BUFFS_AVAIL(tp) &bslash;&n;&t;(tp-&gt;dirty_tx + NUM_TX_DESC - tp-&gt;cur_tx - 1)
macro_line|#ifdef CONFIG_R8169_NAPI
DECL|macro|rtl8169_rx_skb
mdefine_line|#define rtl8169_rx_skb&t;&t;&t;netif_receive_skb
DECL|macro|rtl8169_rx_hwaccel_skb
mdefine_line|#define rtl8169_rx_hwaccel_skb&t;&t;vlan_hwaccel_rx
DECL|macro|rtl8169_rx_quota
mdefine_line|#define rtl8169_rx_quota(count, quota)&t;min(count, quota)
macro_line|#else
DECL|macro|rtl8169_rx_skb
mdefine_line|#define rtl8169_rx_skb&t;&t;&t;netif_rx
DECL|macro|rtl8169_rx_hwaccel_skb
mdefine_line|#define rtl8169_rx_hwaccel_skb&t;&t;vlan_hwaccel_receive_skb
DECL|macro|rtl8169_rx_quota
mdefine_line|#define rtl8169_rx_quota(count, quota)&t;count
macro_line|#endif
multiline_comment|/* media options */
DECL|macro|MAX_UNITS
mdefine_line|#define MAX_UNITS 8
DECL|variable|media
r_static
r_int
id|media
(braket
id|MAX_UNITS
)braket
op_assign
(brace
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
)brace
suffix:semicolon
DECL|variable|num_media
r_static
r_int
id|num_media
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* Maximum events (Rx packets, etc.) to handle at each interrupt. */
DECL|variable|max_interrupt_work
r_static
r_int
id|max_interrupt_work
op_assign
l_int|20
suffix:semicolon
multiline_comment|/* Maximum number of multicast addresses to filter (vs. Rx-all-multicast).&n;   The RTL chips use a 64 element hash table based on the Ethernet CRC.  */
DECL|variable|multicast_filter_limit
r_static
r_int
id|multicast_filter_limit
op_assign
l_int|32
suffix:semicolon
multiline_comment|/* MAC address length*/
DECL|macro|MAC_ADDR_LEN
mdefine_line|#define MAC_ADDR_LEN&t;6
DECL|macro|TX_FIFO_THRESH
mdefine_line|#define TX_FIFO_THRESH 256&t;/* In bytes */
DECL|macro|RX_FIFO_THRESH
mdefine_line|#define RX_FIFO_THRESH&t;7&t;/* 7 means NO threshold, Rx buffer level before first PCI xfer.  */
DECL|macro|RX_DMA_BURST
mdefine_line|#define RX_DMA_BURST&t;6&t;/* Maximum PCI burst, &squot;6&squot; is 1024 */
DECL|macro|TX_DMA_BURST
mdefine_line|#define TX_DMA_BURST&t;6&t;/* Maximum PCI burst, &squot;6&squot; is 1024 */
DECL|macro|EarlyTxThld
mdefine_line|#define EarlyTxThld &t;0x3F&t;/* 0x3F means NO early transmit */
DECL|macro|RxPacketMaxSize
mdefine_line|#define RxPacketMaxSize&t;0x0800&t;/* Maximum size supported is 16K-1 */
DECL|macro|InterFrameGap
mdefine_line|#define InterFrameGap&t;0x03&t;/* 3 means InterFrameGap = the shortest one */
DECL|macro|R8169_REGS_SIZE
mdefine_line|#define R8169_REGS_SIZE&t;&t;256
DECL|macro|R8169_NAPI_WEIGHT
mdefine_line|#define R8169_NAPI_WEIGHT&t;64
DECL|macro|NUM_TX_DESC
mdefine_line|#define NUM_TX_DESC&t;64&t;/* Number of Tx descriptor registers */
DECL|macro|NUM_RX_DESC
mdefine_line|#define NUM_RX_DESC&t;256&t;/* Number of Rx descriptor registers */
DECL|macro|RX_BUF_SIZE
mdefine_line|#define RX_BUF_SIZE&t;1536&t;/* Rx Buffer size */
DECL|macro|R8169_TX_RING_BYTES
mdefine_line|#define R8169_TX_RING_BYTES&t;(NUM_TX_DESC * sizeof(struct TxDesc))
DECL|macro|R8169_RX_RING_BYTES
mdefine_line|#define R8169_RX_RING_BYTES&t;(NUM_RX_DESC * sizeof(struct RxDesc))
DECL|macro|RTL8169_TX_TIMEOUT
mdefine_line|#define RTL8169_TX_TIMEOUT&t;(6*HZ)
DECL|macro|RTL8169_PHY_TIMEOUT
mdefine_line|#define RTL8169_PHY_TIMEOUT&t;(10*HZ)
multiline_comment|/* write/read MMIO register */
DECL|macro|RTL_W8
mdefine_line|#define RTL_W8(reg, val8)&t;writeb ((val8), ioaddr + (reg))
DECL|macro|RTL_W16
mdefine_line|#define RTL_W16(reg, val16)&t;writew ((val16), ioaddr + (reg))
DECL|macro|RTL_W32
mdefine_line|#define RTL_W32(reg, val32)&t;writel ((val32), ioaddr + (reg))
DECL|macro|RTL_R8
mdefine_line|#define RTL_R8(reg)&t;&t;readb (ioaddr + (reg))
DECL|macro|RTL_R16
mdefine_line|#define RTL_R16(reg)&t;&t;readw (ioaddr + (reg))
DECL|macro|RTL_R32
mdefine_line|#define RTL_R32(reg)&t;&t;((unsigned long) readl (ioaddr + (reg)))
DECL|enum|mac_version
r_enum
id|mac_version
(brace
DECL|enumerator|RTL_GIGA_MAC_VER_B
id|RTL_GIGA_MAC_VER_B
op_assign
l_int|0x00
comma
multiline_comment|/* RTL_GIGA_MAC_VER_C = 0x03, */
DECL|enumerator|RTL_GIGA_MAC_VER_D
id|RTL_GIGA_MAC_VER_D
op_assign
l_int|0x01
comma
DECL|enumerator|RTL_GIGA_MAC_VER_E
id|RTL_GIGA_MAC_VER_E
op_assign
l_int|0x02
comma
DECL|enumerator|RTL_GIGA_MAC_VER_X
id|RTL_GIGA_MAC_VER_X
op_assign
l_int|0x04
multiline_comment|/* Greater than RTL_GIGA_MAC_VER_E */
)brace
suffix:semicolon
DECL|enum|phy_version
r_enum
id|phy_version
(brace
DECL|enumerator|RTL_GIGA_PHY_VER_C
id|RTL_GIGA_PHY_VER_C
op_assign
l_int|0x03
comma
multiline_comment|/* PHY Reg 0x03 bit0-3 == 0x0000 */
DECL|enumerator|RTL_GIGA_PHY_VER_D
id|RTL_GIGA_PHY_VER_D
op_assign
l_int|0x04
comma
multiline_comment|/* PHY Reg 0x03 bit0-3 == 0x0000 */
DECL|enumerator|RTL_GIGA_PHY_VER_E
id|RTL_GIGA_PHY_VER_E
op_assign
l_int|0x05
comma
multiline_comment|/* PHY Reg 0x03 bit0-3 == 0x0000 */
DECL|enumerator|RTL_GIGA_PHY_VER_F
id|RTL_GIGA_PHY_VER_F
op_assign
l_int|0x06
comma
multiline_comment|/* PHY Reg 0x03 bit0-3 == 0x0001 */
DECL|enumerator|RTL_GIGA_PHY_VER_G
id|RTL_GIGA_PHY_VER_G
op_assign
l_int|0x07
comma
multiline_comment|/* PHY Reg 0x03 bit0-3 == 0x0002 */
)brace
suffix:semicolon
DECL|macro|_R
mdefine_line|#define _R(NAME,MAC,MASK) &bslash;&n;&t;{ .name = NAME, .mac_version = MAC, .RxConfigMask = MASK }
r_const
r_static
r_struct
(brace
DECL|member|name
r_const
r_char
op_star
id|name
suffix:semicolon
DECL|member|mac_version
id|u8
id|mac_version
suffix:semicolon
DECL|member|RxConfigMask
id|u32
id|RxConfigMask
suffix:semicolon
multiline_comment|/* Clears the bits supported by this chip */
DECL|variable|rtl_chip_info
)brace
id|rtl_chip_info
(braket
)braket
op_assign
(brace
id|_R
c_func
(paren
l_string|&quot;RTL8169&quot;
comma
id|RTL_GIGA_MAC_VER_B
comma
l_int|0xff7e1880
)paren
comma
id|_R
c_func
(paren
l_string|&quot;RTL8169s/8110s&quot;
comma
id|RTL_GIGA_MAC_VER_D
comma
l_int|0xff7e1880
)paren
comma
id|_R
c_func
(paren
l_string|&quot;RTL8169s/8110s&quot;
comma
id|RTL_GIGA_MAC_VER_E
comma
l_int|0xff7e1880
)paren
)brace
suffix:semicolon
DECL|macro|_R
macro_line|#undef _R
DECL|variable|rtl8169_pci_tbl
r_static
r_struct
id|pci_device_id
id|rtl8169_pci_tbl
(braket
)braket
op_assign
(brace
(brace
l_int|0x10ec
comma
l_int|0x8169
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
)brace
comma
)brace
suffix:semicolon
id|MODULE_DEVICE_TABLE
c_func
(paren
id|pci
comma
id|rtl8169_pci_tbl
)paren
suffix:semicolon
DECL|variable|rx_copybreak
r_static
r_int
id|rx_copybreak
op_assign
l_int|200
suffix:semicolon
DECL|variable|use_dac
r_static
r_int
id|use_dac
suffix:semicolon
DECL|enum|RTL8169_registers
r_enum
id|RTL8169_registers
(brace
DECL|enumerator|MAC0
id|MAC0
op_assign
l_int|0
comma
multiline_comment|/* Ethernet hardware address. */
DECL|enumerator|MAR0
id|MAR0
op_assign
l_int|8
comma
multiline_comment|/* Multicast filter. */
DECL|enumerator|TxDescStartAddrLow
id|TxDescStartAddrLow
op_assign
l_int|0x20
comma
DECL|enumerator|TxDescStartAddrHigh
id|TxDescStartAddrHigh
op_assign
l_int|0x24
comma
DECL|enumerator|TxHDescStartAddrLow
id|TxHDescStartAddrLow
op_assign
l_int|0x28
comma
DECL|enumerator|TxHDescStartAddrHigh
id|TxHDescStartAddrHigh
op_assign
l_int|0x2c
comma
DECL|enumerator|FLASH
id|FLASH
op_assign
l_int|0x30
comma
DECL|enumerator|ERSR
id|ERSR
op_assign
l_int|0x36
comma
DECL|enumerator|ChipCmd
id|ChipCmd
op_assign
l_int|0x37
comma
DECL|enumerator|TxPoll
id|TxPoll
op_assign
l_int|0x38
comma
DECL|enumerator|IntrMask
id|IntrMask
op_assign
l_int|0x3C
comma
DECL|enumerator|IntrStatus
id|IntrStatus
op_assign
l_int|0x3E
comma
DECL|enumerator|TxConfig
id|TxConfig
op_assign
l_int|0x40
comma
DECL|enumerator|RxConfig
id|RxConfig
op_assign
l_int|0x44
comma
DECL|enumerator|RxMissed
id|RxMissed
op_assign
l_int|0x4C
comma
DECL|enumerator|Cfg9346
id|Cfg9346
op_assign
l_int|0x50
comma
DECL|enumerator|Config0
id|Config0
op_assign
l_int|0x51
comma
DECL|enumerator|Config1
id|Config1
op_assign
l_int|0x52
comma
DECL|enumerator|Config2
id|Config2
op_assign
l_int|0x53
comma
DECL|enumerator|Config3
id|Config3
op_assign
l_int|0x54
comma
DECL|enumerator|Config4
id|Config4
op_assign
l_int|0x55
comma
DECL|enumerator|Config5
id|Config5
op_assign
l_int|0x56
comma
DECL|enumerator|MultiIntr
id|MultiIntr
op_assign
l_int|0x5C
comma
DECL|enumerator|PHYAR
id|PHYAR
op_assign
l_int|0x60
comma
DECL|enumerator|TBICSR
id|TBICSR
op_assign
l_int|0x64
comma
DECL|enumerator|TBI_ANAR
id|TBI_ANAR
op_assign
l_int|0x68
comma
DECL|enumerator|TBI_LPAR
id|TBI_LPAR
op_assign
l_int|0x6A
comma
DECL|enumerator|PHYstatus
id|PHYstatus
op_assign
l_int|0x6C
comma
DECL|enumerator|RxMaxSize
id|RxMaxSize
op_assign
l_int|0xDA
comma
DECL|enumerator|CPlusCmd
id|CPlusCmd
op_assign
l_int|0xE0
comma
DECL|enumerator|RxDescAddrLow
id|RxDescAddrLow
op_assign
l_int|0xE4
comma
DECL|enumerator|RxDescAddrHigh
id|RxDescAddrHigh
op_assign
l_int|0xE8
comma
DECL|enumerator|EarlyTxThres
id|EarlyTxThres
op_assign
l_int|0xEC
comma
DECL|enumerator|FuncEvent
id|FuncEvent
op_assign
l_int|0xF0
comma
DECL|enumerator|FuncEventMask
id|FuncEventMask
op_assign
l_int|0xF4
comma
DECL|enumerator|FuncPresetState
id|FuncPresetState
op_assign
l_int|0xF8
comma
DECL|enumerator|FuncForceEvent
id|FuncForceEvent
op_assign
l_int|0xFC
comma
)brace
suffix:semicolon
DECL|enum|RTL8169_register_content
r_enum
id|RTL8169_register_content
(brace
multiline_comment|/*InterruptStatusBits */
DECL|enumerator|SYSErr
id|SYSErr
op_assign
l_int|0x8000
comma
DECL|enumerator|PCSTimeout
id|PCSTimeout
op_assign
l_int|0x4000
comma
DECL|enumerator|SWInt
id|SWInt
op_assign
l_int|0x0100
comma
DECL|enumerator|TxDescUnavail
id|TxDescUnavail
op_assign
l_int|0x80
comma
DECL|enumerator|RxFIFOOver
id|RxFIFOOver
op_assign
l_int|0x40
comma
DECL|enumerator|LinkChg
id|LinkChg
op_assign
l_int|0x20
comma
DECL|enumerator|RxOverflow
id|RxOverflow
op_assign
l_int|0x10
comma
DECL|enumerator|TxErr
id|TxErr
op_assign
l_int|0x08
comma
DECL|enumerator|TxOK
id|TxOK
op_assign
l_int|0x04
comma
DECL|enumerator|RxErr
id|RxErr
op_assign
l_int|0x02
comma
DECL|enumerator|RxOK
id|RxOK
op_assign
l_int|0x01
comma
multiline_comment|/*RxStatusDesc */
DECL|enumerator|RxRES
id|RxRES
op_assign
l_int|0x00200000
comma
DECL|enumerator|RxCRC
id|RxCRC
op_assign
l_int|0x00080000
comma
DECL|enumerator|RxRUNT
id|RxRUNT
op_assign
l_int|0x00100000
comma
DECL|enumerator|RxRWT
id|RxRWT
op_assign
l_int|0x00400000
comma
multiline_comment|/*ChipCmdBits */
DECL|enumerator|CmdReset
id|CmdReset
op_assign
l_int|0x10
comma
DECL|enumerator|CmdRxEnb
id|CmdRxEnb
op_assign
l_int|0x08
comma
DECL|enumerator|CmdTxEnb
id|CmdTxEnb
op_assign
l_int|0x04
comma
DECL|enumerator|RxBufEmpty
id|RxBufEmpty
op_assign
l_int|0x01
comma
multiline_comment|/*Cfg9346Bits */
DECL|enumerator|Cfg9346_Lock
id|Cfg9346_Lock
op_assign
l_int|0x00
comma
DECL|enumerator|Cfg9346_Unlock
id|Cfg9346_Unlock
op_assign
l_int|0xC0
comma
multiline_comment|/*rx_mode_bits */
DECL|enumerator|AcceptErr
id|AcceptErr
op_assign
l_int|0x20
comma
DECL|enumerator|AcceptRunt
id|AcceptRunt
op_assign
l_int|0x10
comma
DECL|enumerator|AcceptBroadcast
id|AcceptBroadcast
op_assign
l_int|0x08
comma
DECL|enumerator|AcceptMulticast
id|AcceptMulticast
op_assign
l_int|0x04
comma
DECL|enumerator|AcceptMyPhys
id|AcceptMyPhys
op_assign
l_int|0x02
comma
DECL|enumerator|AcceptAllPhys
id|AcceptAllPhys
op_assign
l_int|0x01
comma
multiline_comment|/*RxConfigBits */
DECL|enumerator|RxCfgFIFOShift
id|RxCfgFIFOShift
op_assign
l_int|13
comma
DECL|enumerator|RxCfgDMAShift
id|RxCfgDMAShift
op_assign
l_int|8
comma
multiline_comment|/*TxConfigBits */
DECL|enumerator|TxInterFrameGapShift
id|TxInterFrameGapShift
op_assign
l_int|24
comma
DECL|enumerator|TxDMAShift
id|TxDMAShift
op_assign
l_int|8
comma
multiline_comment|/* DMA burst value (0-7) is shift this many bits */
multiline_comment|/* TBICSR p.28 */
DECL|enumerator|TBIReset
id|TBIReset
op_assign
l_int|0x80000000
comma
DECL|enumerator|TBILoopback
id|TBILoopback
op_assign
l_int|0x40000000
comma
DECL|enumerator|TBINwEnable
id|TBINwEnable
op_assign
l_int|0x20000000
comma
DECL|enumerator|TBINwRestart
id|TBINwRestart
op_assign
l_int|0x10000000
comma
DECL|enumerator|TBILinkOk
id|TBILinkOk
op_assign
l_int|0x02000000
comma
DECL|enumerator|TBINwComplete
id|TBINwComplete
op_assign
l_int|0x01000000
comma
multiline_comment|/* CPlusCmd p.31 */
DECL|enumerator|RxVlan
id|RxVlan
op_assign
(paren
l_int|1
op_lshift
l_int|6
)paren
comma
DECL|enumerator|RxChkSum
id|RxChkSum
op_assign
(paren
l_int|1
op_lshift
l_int|5
)paren
comma
DECL|enumerator|PCIDAC
id|PCIDAC
op_assign
(paren
l_int|1
op_lshift
l_int|4
)paren
comma
DECL|enumerator|PCIMulRW
id|PCIMulRW
op_assign
(paren
l_int|1
op_lshift
l_int|3
)paren
comma
multiline_comment|/*rtl8169_PHYstatus */
DECL|enumerator|TBI_Enable
id|TBI_Enable
op_assign
l_int|0x80
comma
DECL|enumerator|TxFlowCtrl
id|TxFlowCtrl
op_assign
l_int|0x40
comma
DECL|enumerator|RxFlowCtrl
id|RxFlowCtrl
op_assign
l_int|0x20
comma
DECL|enumerator|_1000bpsF
id|_1000bpsF
op_assign
l_int|0x10
comma
DECL|enumerator|_100bps
id|_100bps
op_assign
l_int|0x08
comma
DECL|enumerator|_10bps
id|_10bps
op_assign
l_int|0x04
comma
DECL|enumerator|LinkStatus
id|LinkStatus
op_assign
l_int|0x02
comma
DECL|enumerator|FullDup
id|FullDup
op_assign
l_int|0x01
comma
multiline_comment|/*GIGABIT_PHY_registers */
DECL|enumerator|PHY_CTRL_REG
id|PHY_CTRL_REG
op_assign
l_int|0
comma
DECL|enumerator|PHY_STAT_REG
id|PHY_STAT_REG
op_assign
l_int|1
comma
DECL|enumerator|PHY_AUTO_NEGO_REG
id|PHY_AUTO_NEGO_REG
op_assign
l_int|4
comma
DECL|enumerator|PHY_1000_CTRL_REG
id|PHY_1000_CTRL_REG
op_assign
l_int|9
comma
multiline_comment|/*GIGABIT_PHY_REG_BIT */
DECL|enumerator|PHY_Restart_Auto_Nego
id|PHY_Restart_Auto_Nego
op_assign
l_int|0x0200
comma
DECL|enumerator|PHY_Enable_Auto_Nego
id|PHY_Enable_Auto_Nego
op_assign
l_int|0x1000
comma
singleline_comment|//PHY_STAT_REG = 1;
DECL|enumerator|PHY_Auto_Neco_Comp
id|PHY_Auto_Neco_Comp
op_assign
l_int|0x0020
comma
singleline_comment|//PHY_AUTO_NEGO_REG = 4;
DECL|enumerator|PHY_Cap_10_Half
id|PHY_Cap_10_Half
op_assign
l_int|0x0020
comma
DECL|enumerator|PHY_Cap_10_Full
id|PHY_Cap_10_Full
op_assign
l_int|0x0040
comma
DECL|enumerator|PHY_Cap_100_Half
id|PHY_Cap_100_Half
op_assign
l_int|0x0080
comma
DECL|enumerator|PHY_Cap_100_Full
id|PHY_Cap_100_Full
op_assign
l_int|0x0100
comma
singleline_comment|//PHY_1000_CTRL_REG = 9;
DECL|enumerator|PHY_Cap_1000_Full
id|PHY_Cap_1000_Full
op_assign
l_int|0x0200
comma
DECL|enumerator|PHY_Cap_Null
id|PHY_Cap_Null
op_assign
l_int|0x0
comma
multiline_comment|/*_MediaType*/
DECL|enumerator|_10_Half
id|_10_Half
op_assign
l_int|0x01
comma
DECL|enumerator|_10_Full
id|_10_Full
op_assign
l_int|0x02
comma
DECL|enumerator|_100_Half
id|_100_Half
op_assign
l_int|0x04
comma
DECL|enumerator|_100_Full
id|_100_Full
op_assign
l_int|0x08
comma
DECL|enumerator|_1000_Full
id|_1000_Full
op_assign
l_int|0x10
comma
multiline_comment|/*_TBICSRBit*/
DECL|enumerator|TBILinkOK
id|TBILinkOK
op_assign
l_int|0x02000000
comma
)brace
suffix:semicolon
DECL|enum|_DescStatusBit
r_enum
id|_DescStatusBit
(brace
DECL|enumerator|DescOwn
id|DescOwn
op_assign
(paren
l_int|1
op_lshift
l_int|31
)paren
comma
multiline_comment|/* Descriptor is owned by NIC */
DECL|enumerator|RingEnd
id|RingEnd
op_assign
(paren
l_int|1
op_lshift
l_int|30
)paren
comma
multiline_comment|/* End of descriptor ring */
DECL|enumerator|FirstFrag
id|FirstFrag
op_assign
(paren
l_int|1
op_lshift
l_int|29
)paren
comma
multiline_comment|/* First segment of a packet */
DECL|enumerator|LastFrag
id|LastFrag
op_assign
(paren
l_int|1
op_lshift
l_int|28
)paren
comma
multiline_comment|/* Final segment of a packet */
multiline_comment|/* Tx private */
DECL|enumerator|LargeSend
id|LargeSend
op_assign
(paren
l_int|1
op_lshift
l_int|27
)paren
comma
multiline_comment|/* TCP Large Send Offload (TSO) */
DECL|enumerator|MSSShift
id|MSSShift
op_assign
l_int|16
comma
multiline_comment|/* MSS value position */
DECL|enumerator|MSSMask
id|MSSMask
op_assign
l_int|0xfff
comma
multiline_comment|/* MSS value + LargeSend bit: 12 bits */
DECL|enumerator|IPCS
id|IPCS
op_assign
(paren
l_int|1
op_lshift
l_int|18
)paren
comma
multiline_comment|/* Calculate IP checksum */
DECL|enumerator|UDPCS
id|UDPCS
op_assign
(paren
l_int|1
op_lshift
l_int|17
)paren
comma
multiline_comment|/* Calculate UDP/IP checksum */
DECL|enumerator|TCPCS
id|TCPCS
op_assign
(paren
l_int|1
op_lshift
l_int|16
)paren
comma
multiline_comment|/* Calculate TCP/IP checksum */
DECL|enumerator|TxVlanTag
id|TxVlanTag
op_assign
(paren
l_int|1
op_lshift
l_int|17
)paren
comma
multiline_comment|/* Add VLAN tag */
multiline_comment|/* Rx private */
DECL|enumerator|PID1
id|PID1
op_assign
(paren
l_int|1
op_lshift
l_int|18
)paren
comma
multiline_comment|/* Protocol ID bit 1/2 */
DECL|enumerator|PID0
id|PID0
op_assign
(paren
l_int|1
op_lshift
l_int|17
)paren
comma
multiline_comment|/* Protocol ID bit 2/2 */
DECL|macro|RxProtoUDP
mdefine_line|#define RxProtoUDP&t;(PID1)
DECL|macro|RxProtoTCP
mdefine_line|#define RxProtoTCP&t;(PID0)
DECL|macro|RxProtoIP
mdefine_line|#define RxProtoIP&t;(PID1 | PID0)
DECL|macro|RxProtoMask
mdefine_line|#define RxProtoMask&t;RxProtoIP
DECL|enumerator|IPFail
id|IPFail
op_assign
(paren
l_int|1
op_lshift
l_int|16
)paren
comma
multiline_comment|/* IP checksum failed */
DECL|enumerator|UDPFail
id|UDPFail
op_assign
(paren
l_int|1
op_lshift
l_int|15
)paren
comma
multiline_comment|/* UDP/IP checksum failed */
DECL|enumerator|TCPFail
id|TCPFail
op_assign
(paren
l_int|1
op_lshift
l_int|14
)paren
comma
multiline_comment|/* TCP/IP checksum failed */
DECL|enumerator|RxVlanTag
id|RxVlanTag
op_assign
(paren
l_int|1
op_lshift
l_int|16
)paren
comma
multiline_comment|/* VLAN tag available */
)brace
suffix:semicolon
DECL|macro|RsvdMask
mdefine_line|#define RsvdMask&t;0x3fffc000
DECL|struct|TxDesc
r_struct
id|TxDesc
(brace
DECL|member|opts1
id|u32
id|opts1
suffix:semicolon
DECL|member|opts2
id|u32
id|opts2
suffix:semicolon
DECL|member|addr
id|u64
id|addr
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|RxDesc
r_struct
id|RxDesc
(brace
DECL|member|opts1
id|u32
id|opts1
suffix:semicolon
DECL|member|opts2
id|u32
id|opts2
suffix:semicolon
DECL|member|addr
id|u64
id|addr
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|ring_info
r_struct
id|ring_info
(brace
DECL|member|skb
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
DECL|member|len
id|u32
id|len
suffix:semicolon
DECL|member|__pad
id|u8
id|__pad
(braket
r_sizeof
(paren
r_void
op_star
)paren
op_minus
r_sizeof
(paren
id|u32
)paren
)braket
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|rtl8169_private
r_struct
id|rtl8169_private
(brace
DECL|member|mmio_addr
r_void
id|__iomem
op_star
id|mmio_addr
suffix:semicolon
multiline_comment|/* memory map physical address */
DECL|member|pci_dev
r_struct
id|pci_dev
op_star
id|pci_dev
suffix:semicolon
multiline_comment|/* Index of PCI device  */
DECL|member|stats
r_struct
id|net_device_stats
id|stats
suffix:semicolon
multiline_comment|/* statistics of net device */
DECL|member|lock
id|spinlock_t
id|lock
suffix:semicolon
multiline_comment|/* spin lock flag */
DECL|member|chipset
r_int
id|chipset
suffix:semicolon
DECL|member|mac_version
r_int
id|mac_version
suffix:semicolon
DECL|member|phy_version
r_int
id|phy_version
suffix:semicolon
DECL|member|cur_rx
id|u32
id|cur_rx
suffix:semicolon
multiline_comment|/* Index into the Rx descriptor buffer of next Rx pkt. */
DECL|member|cur_tx
id|u32
id|cur_tx
suffix:semicolon
multiline_comment|/* Index into the Tx descriptor buffer of next Rx pkt. */
DECL|member|dirty_rx
id|u32
id|dirty_rx
suffix:semicolon
DECL|member|dirty_tx
id|u32
id|dirty_tx
suffix:semicolon
DECL|member|TxDescArray
r_struct
id|TxDesc
op_star
id|TxDescArray
suffix:semicolon
multiline_comment|/* 256-aligned Tx descriptor ring */
DECL|member|RxDescArray
r_struct
id|RxDesc
op_star
id|RxDescArray
suffix:semicolon
multiline_comment|/* 256-aligned Rx descriptor ring */
DECL|member|TxPhyAddr
id|dma_addr_t
id|TxPhyAddr
suffix:semicolon
DECL|member|RxPhyAddr
id|dma_addr_t
id|RxPhyAddr
suffix:semicolon
DECL|member|Rx_skbuff
r_struct
id|sk_buff
op_star
id|Rx_skbuff
(braket
id|NUM_RX_DESC
)braket
suffix:semicolon
multiline_comment|/* Rx data buffers */
DECL|member|tx_skb
r_struct
id|ring_info
id|tx_skb
(braket
id|NUM_TX_DESC
)braket
suffix:semicolon
multiline_comment|/* Tx data buffers */
DECL|member|rx_buf_sz
r_int
id|rx_buf_sz
suffix:semicolon
DECL|member|timer
r_struct
id|timer_list
id|timer
suffix:semicolon
DECL|member|cp_cmd
id|u16
id|cp_cmd
suffix:semicolon
DECL|member|intr_mask
id|u16
id|intr_mask
suffix:semicolon
DECL|member|phy_auto_nego_reg
r_int
id|phy_auto_nego_reg
suffix:semicolon
DECL|member|phy_1000_ctrl_reg
r_int
id|phy_1000_ctrl_reg
suffix:semicolon
macro_line|#ifdef CONFIG_R8169_VLAN
DECL|member|vlgrp
r_struct
id|vlan_group
op_star
id|vlgrp
suffix:semicolon
macro_line|#endif
DECL|member|set_speed
r_int
(paren
op_star
id|set_speed
)paren
(paren
r_struct
id|net_device
op_star
comma
id|u8
id|autoneg
comma
id|u16
id|speed
comma
id|u8
id|duplex
)paren
suffix:semicolon
DECL|member|get_settings
r_void
(paren
op_star
id|get_settings
)paren
(paren
r_struct
id|net_device
op_star
comma
r_struct
id|ethtool_cmd
op_star
)paren
suffix:semicolon
DECL|member|phy_reset_enable
r_void
(paren
op_star
id|phy_reset_enable
)paren
(paren
r_void
id|__iomem
op_star
)paren
suffix:semicolon
DECL|member|phy_reset_pending
r_int
r_int
(paren
op_star
id|phy_reset_pending
)paren
(paren
r_void
id|__iomem
op_star
)paren
suffix:semicolon
DECL|member|link_ok
r_int
r_int
(paren
op_star
id|link_ok
)paren
(paren
r_void
id|__iomem
op_star
)paren
suffix:semicolon
DECL|member|task
r_struct
id|work_struct
id|task
suffix:semicolon
)brace
suffix:semicolon
id|MODULE_AUTHOR
c_func
(paren
l_string|&quot;Realtek&quot;
)paren
suffix:semicolon
id|MODULE_DESCRIPTION
c_func
(paren
l_string|&quot;RealTek RTL-8169 Gigabit Ethernet driver&quot;
)paren
suffix:semicolon
id|module_param_array
c_func
(paren
id|media
comma
r_int
comma
op_amp
id|num_media
comma
l_int|0
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|rx_copybreak
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|use_dac
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|use_dac
comma
l_string|&quot;Enable PCI DAC. Unsafe on 32 bit PCI slot.&quot;
)paren
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
r_static
r_int
id|rtl8169_open
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
suffix:semicolon
r_static
r_int
id|rtl8169_start_xmit
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|net_device
op_star
id|dev
)paren
suffix:semicolon
r_static
id|irqreturn_t
id|rtl8169_interrupt
c_func
(paren
r_int
id|irq
comma
r_void
op_star
id|dev_instance
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
suffix:semicolon
r_static
r_int
id|rtl8169_init_ring
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
suffix:semicolon
r_static
r_void
id|rtl8169_hw_start
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
suffix:semicolon
r_static
r_int
id|rtl8169_close
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
suffix:semicolon
r_static
r_void
id|rtl8169_set_rx_mode
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
suffix:semicolon
r_static
r_void
id|rtl8169_tx_timeout
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
suffix:semicolon
r_static
r_struct
id|net_device_stats
op_star
id|rtl8169_get_stats
c_func
(paren
r_struct
id|net_device
op_star
id|netdev
)paren
suffix:semicolon
r_static
r_int
id|rtl8169_rx_interrupt
c_func
(paren
r_struct
id|net_device
op_star
comma
r_struct
id|rtl8169_private
op_star
comma
r_void
id|__iomem
op_star
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_R8169_NAPI
r_static
r_int
id|rtl8169_poll
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_int
op_star
id|budget
)paren
suffix:semicolon
macro_line|#endif
DECL|variable|rtl8169_intr_mask
r_static
r_const
id|u16
id|rtl8169_intr_mask
op_assign
id|SYSErr
op_or
id|LinkChg
op_or
id|RxOverflow
op_or
id|RxFIFOOver
op_or
id|TxErr
op_or
id|TxOK
op_or
id|RxErr
op_or
id|RxOK
suffix:semicolon
DECL|variable|rtl8169_napi_event
r_static
r_const
id|u16
id|rtl8169_napi_event
op_assign
id|RxOK
op_or
id|RxOverflow
op_or
id|RxFIFOOver
op_or
id|TxOK
op_or
id|TxErr
suffix:semicolon
DECL|variable|rtl8169_rx_config
r_static
r_const
r_int
r_int
id|rtl8169_rx_config
op_assign
(paren
id|RX_FIFO_THRESH
op_lshift
id|RxCfgFIFOShift
)paren
op_or
(paren
id|RX_DMA_BURST
op_lshift
id|RxCfgDMAShift
)paren
suffix:semicolon
DECL|macro|PHY_Cap_10_Half_Or_Less
mdefine_line|#define PHY_Cap_10_Half_Or_Less PHY_Cap_10_Half
DECL|macro|PHY_Cap_10_Full_Or_Less
mdefine_line|#define PHY_Cap_10_Full_Or_Less PHY_Cap_10_Full | PHY_Cap_10_Half_Or_Less
DECL|macro|PHY_Cap_100_Half_Or_Less
mdefine_line|#define PHY_Cap_100_Half_Or_Less PHY_Cap_100_Half | PHY_Cap_10_Full_Or_Less
DECL|macro|PHY_Cap_100_Full_Or_Less
mdefine_line|#define PHY_Cap_100_Full_Or_Less PHY_Cap_100_Full | PHY_Cap_100_Half_Or_Less
DECL|function|mdio_write
r_static
r_void
id|mdio_write
c_func
(paren
r_void
id|__iomem
op_star
id|ioaddr
comma
r_int
id|RegAddr
comma
r_int
id|value
)paren
(brace
r_int
id|i
suffix:semicolon
id|RTL_W32
c_func
(paren
id|PHYAR
comma
l_int|0x80000000
op_or
(paren
id|RegAddr
op_amp
l_int|0xFF
)paren
op_lshift
l_int|16
op_or
id|value
)paren
suffix:semicolon
id|udelay
c_func
(paren
l_int|1000
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|2000
suffix:semicolon
id|i
OG
l_int|0
suffix:semicolon
id|i
op_decrement
)paren
(brace
singleline_comment|// Check if the RTL8169 has completed writing to the specified MII register
r_if
c_cond
(paren
op_logical_neg
(paren
id|RTL_R32
c_func
(paren
id|PHYAR
)paren
op_amp
l_int|0x80000000
)paren
)paren
r_break
suffix:semicolon
id|udelay
c_func
(paren
l_int|100
)paren
suffix:semicolon
)brace
)brace
DECL|function|mdio_read
r_static
r_int
id|mdio_read
c_func
(paren
r_void
id|__iomem
op_star
id|ioaddr
comma
r_int
id|RegAddr
)paren
(brace
r_int
id|i
comma
id|value
op_assign
op_minus
l_int|1
suffix:semicolon
id|RTL_W32
c_func
(paren
id|PHYAR
comma
l_int|0x0
op_or
(paren
id|RegAddr
op_amp
l_int|0xFF
)paren
op_lshift
l_int|16
)paren
suffix:semicolon
id|udelay
c_func
(paren
l_int|1000
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|2000
suffix:semicolon
id|i
OG
l_int|0
suffix:semicolon
id|i
op_decrement
)paren
(brace
singleline_comment|// Check if the RTL8169 has completed retrieving data from the specified MII register
r_if
c_cond
(paren
id|RTL_R32
c_func
(paren
id|PHYAR
)paren
op_amp
l_int|0x80000000
)paren
(brace
id|value
op_assign
(paren
r_int
)paren
(paren
id|RTL_R32
c_func
(paren
id|PHYAR
)paren
op_amp
l_int|0xFFFF
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|udelay
c_func
(paren
l_int|100
)paren
suffix:semicolon
)brace
r_return
id|value
suffix:semicolon
)brace
DECL|function|rtl8169_tbi_reset_pending
r_static
r_int
r_int
id|rtl8169_tbi_reset_pending
c_func
(paren
r_void
id|__iomem
op_star
id|ioaddr
)paren
(brace
r_return
id|RTL_R32
c_func
(paren
id|TBICSR
)paren
op_amp
id|TBIReset
suffix:semicolon
)brace
DECL|function|rtl8169_xmii_reset_pending
r_static
r_int
r_int
id|rtl8169_xmii_reset_pending
c_func
(paren
r_void
id|__iomem
op_star
id|ioaddr
)paren
(brace
r_return
id|mdio_read
c_func
(paren
id|ioaddr
comma
l_int|0
)paren
op_amp
l_int|0x8000
suffix:semicolon
)brace
DECL|function|rtl8169_tbi_link_ok
r_static
r_int
r_int
id|rtl8169_tbi_link_ok
c_func
(paren
r_void
id|__iomem
op_star
id|ioaddr
)paren
(brace
r_return
id|RTL_R32
c_func
(paren
id|TBICSR
)paren
op_amp
id|TBILinkOk
suffix:semicolon
)brace
DECL|function|rtl8169_xmii_link_ok
r_static
r_int
r_int
id|rtl8169_xmii_link_ok
c_func
(paren
r_void
id|__iomem
op_star
id|ioaddr
)paren
(brace
r_return
id|RTL_R8
c_func
(paren
id|PHYstatus
)paren
op_amp
id|LinkStatus
suffix:semicolon
)brace
DECL|function|rtl8169_tbi_reset_enable
r_static
r_void
id|rtl8169_tbi_reset_enable
c_func
(paren
r_void
id|__iomem
op_star
id|ioaddr
)paren
(brace
id|RTL_W32
c_func
(paren
id|TBICSR
comma
id|RTL_R32
c_func
(paren
id|TBICSR
)paren
op_or
id|TBIReset
)paren
suffix:semicolon
)brace
DECL|function|rtl8169_xmii_reset_enable
r_static
r_void
id|rtl8169_xmii_reset_enable
c_func
(paren
r_void
id|__iomem
op_star
id|ioaddr
)paren
(brace
r_int
r_int
id|val
suffix:semicolon
id|val
op_assign
(paren
id|mdio_read
c_func
(paren
id|ioaddr
comma
id|PHY_CTRL_REG
)paren
op_or
l_int|0x8000
)paren
op_amp
l_int|0xffff
suffix:semicolon
id|mdio_write
c_func
(paren
id|ioaddr
comma
id|PHY_CTRL_REG
comma
id|val
)paren
suffix:semicolon
)brace
DECL|function|rtl8169_check_link_status
r_static
r_void
id|rtl8169_check_link_status
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|rtl8169_private
op_star
id|tp
comma
r_void
id|__iomem
op_star
id|ioaddr
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|tp-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tp
op_member_access_from_pointer
id|link_ok
c_func
(paren
id|ioaddr
)paren
)paren
(brace
id|netif_carrier_on
c_func
(paren
id|dev
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
id|PFX
l_string|&quot;%s: link up&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
)brace
r_else
id|netif_carrier_off
c_func
(paren
id|dev
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|tp-&gt;lock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|rtl8169_link_option
r_static
r_void
id|rtl8169_link_option
c_func
(paren
r_int
id|idx
comma
id|u8
op_star
id|autoneg
comma
id|u16
op_star
id|speed
comma
id|u8
op_star
id|duplex
)paren
(brace
r_struct
(brace
id|u16
id|speed
suffix:semicolon
id|u8
id|duplex
suffix:semicolon
id|u8
id|autoneg
suffix:semicolon
id|u8
id|media
suffix:semicolon
)brace
id|link_settings
(braket
)braket
op_assign
(brace
(brace
id|SPEED_10
comma
id|DUPLEX_HALF
comma
id|AUTONEG_DISABLE
comma
id|_10_Half
)brace
comma
(brace
id|SPEED_10
comma
id|DUPLEX_FULL
comma
id|AUTONEG_DISABLE
comma
id|_10_Full
)brace
comma
(brace
id|SPEED_100
comma
id|DUPLEX_HALF
comma
id|AUTONEG_DISABLE
comma
id|_100_Half
)brace
comma
(brace
id|SPEED_100
comma
id|DUPLEX_FULL
comma
id|AUTONEG_DISABLE
comma
id|_100_Full
)brace
comma
(brace
id|SPEED_1000
comma
id|DUPLEX_FULL
comma
id|AUTONEG_DISABLE
comma
id|_1000_Full
)brace
comma
multiline_comment|/* Make TBI happy */
(brace
id|SPEED_1000
comma
id|DUPLEX_FULL
comma
id|AUTONEG_ENABLE
comma
l_int|0xff
)brace
)brace
comma
op_star
id|p
suffix:semicolon
r_int
r_char
id|option
suffix:semicolon
id|option
op_assign
(paren
(paren
id|idx
OL
id|MAX_UNITS
)paren
op_logical_and
(paren
id|idx
op_ge
l_int|0
)paren
)paren
ques
c_cond
id|media
(braket
id|idx
)braket
suffix:colon
l_int|0xff
suffix:semicolon
r_if
c_cond
(paren
(paren
id|option
op_ne
l_int|0xff
)paren
op_logical_and
op_logical_neg
id|idx
)paren
id|printk
c_func
(paren
id|KERN_WARNING
id|PFX
l_string|&quot;media option is deprecated.&bslash;n&quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|p
op_assign
id|link_settings
suffix:semicolon
id|p-&gt;media
op_ne
l_int|0xff
suffix:semicolon
id|p
op_increment
)paren
(brace
r_if
c_cond
(paren
id|p-&gt;media
op_eq
id|option
)paren
r_break
suffix:semicolon
)brace
op_star
id|autoneg
op_assign
id|p-&gt;autoneg
suffix:semicolon
op_star
id|speed
op_assign
id|p-&gt;speed
suffix:semicolon
op_star
id|duplex
op_assign
id|p-&gt;duplex
suffix:semicolon
)brace
DECL|function|rtl8169_get_drvinfo
r_static
r_void
id|rtl8169_get_drvinfo
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|ethtool_drvinfo
op_star
id|info
)paren
(brace
r_struct
id|rtl8169_private
op_star
id|tp
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
id|strcpy
c_func
(paren
id|info-&gt;driver
comma
id|RTL8169_DRIVER_NAME
)paren
suffix:semicolon
id|strcpy
c_func
(paren
id|info-&gt;version
comma
id|RTL8169_VERSION
)paren
suffix:semicolon
id|strcpy
c_func
(paren
id|info-&gt;bus_info
comma
id|pci_name
c_func
(paren
id|tp-&gt;pci_dev
)paren
)paren
suffix:semicolon
)brace
DECL|function|rtl8169_get_regs_len
r_static
r_int
id|rtl8169_get_regs_len
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_return
id|R8169_REGS_SIZE
suffix:semicolon
)brace
DECL|function|rtl8169_set_speed_tbi
r_static
r_int
id|rtl8169_set_speed_tbi
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
id|u8
id|autoneg
comma
id|u16
id|speed
comma
id|u8
id|duplex
)paren
(brace
r_struct
id|rtl8169_private
op_star
id|tp
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
r_void
id|__iomem
op_star
id|ioaddr
op_assign
id|tp-&gt;mmio_addr
suffix:semicolon
r_int
id|ret
op_assign
l_int|0
suffix:semicolon
id|u32
id|reg
suffix:semicolon
id|reg
op_assign
id|RTL_R32
c_func
(paren
id|TBICSR
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|autoneg
op_eq
id|AUTONEG_DISABLE
)paren
op_logical_and
(paren
id|speed
op_eq
id|SPEED_1000
)paren
op_logical_and
(paren
id|duplex
op_eq
id|DUPLEX_FULL
)paren
)paren
(brace
id|RTL_W32
c_func
(paren
id|TBICSR
comma
id|reg
op_amp
op_complement
(paren
id|TBINwEnable
op_or
id|TBINwRestart
)paren
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|autoneg
op_eq
id|AUTONEG_ENABLE
)paren
id|RTL_W32
c_func
(paren
id|TBICSR
comma
id|reg
op_or
id|TBINwEnable
op_or
id|TBINwRestart
)paren
suffix:semicolon
r_else
(brace
id|printk
c_func
(paren
id|KERN_WARNING
id|PFX
l_string|&quot;%s: incorrect speed setting refused in TBI mode&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
id|ret
op_assign
op_minus
id|EOPNOTSUPP
suffix:semicolon
)brace
r_return
id|ret
suffix:semicolon
)brace
DECL|function|rtl8169_set_speed_xmii
r_static
r_int
id|rtl8169_set_speed_xmii
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
id|u8
id|autoneg
comma
id|u16
id|speed
comma
id|u8
id|duplex
)paren
(brace
r_struct
id|rtl8169_private
op_star
id|tp
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
r_void
id|__iomem
op_star
id|ioaddr
op_assign
id|tp-&gt;mmio_addr
suffix:semicolon
r_int
id|auto_nego
comma
id|giga_ctrl
suffix:semicolon
id|auto_nego
op_assign
id|mdio_read
c_func
(paren
id|ioaddr
comma
id|PHY_AUTO_NEGO_REG
)paren
suffix:semicolon
id|auto_nego
op_and_assign
op_complement
(paren
id|PHY_Cap_10_Half
op_or
id|PHY_Cap_10_Full
op_or
id|PHY_Cap_100_Half
op_or
id|PHY_Cap_100_Full
)paren
suffix:semicolon
id|giga_ctrl
op_assign
id|mdio_read
c_func
(paren
id|ioaddr
comma
id|PHY_1000_CTRL_REG
)paren
suffix:semicolon
id|giga_ctrl
op_and_assign
op_complement
(paren
id|PHY_Cap_1000_Full
op_or
id|PHY_Cap_Null
)paren
suffix:semicolon
r_if
c_cond
(paren
id|autoneg
op_eq
id|AUTONEG_ENABLE
)paren
(brace
id|auto_nego
op_or_assign
(paren
id|PHY_Cap_10_Half
op_or
id|PHY_Cap_10_Full
op_or
id|PHY_Cap_100_Half
op_or
id|PHY_Cap_100_Full
)paren
suffix:semicolon
id|giga_ctrl
op_or_assign
id|PHY_Cap_1000_Full
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|speed
op_eq
id|SPEED_10
)paren
id|auto_nego
op_or_assign
id|PHY_Cap_10_Half
op_or
id|PHY_Cap_10_Full
suffix:semicolon
r_else
r_if
c_cond
(paren
id|speed
op_eq
id|SPEED_100
)paren
id|auto_nego
op_or_assign
id|PHY_Cap_100_Half
op_or
id|PHY_Cap_100_Full
suffix:semicolon
r_else
r_if
c_cond
(paren
id|speed
op_eq
id|SPEED_1000
)paren
id|giga_ctrl
op_or_assign
id|PHY_Cap_1000_Full
suffix:semicolon
r_if
c_cond
(paren
id|duplex
op_eq
id|DUPLEX_HALF
)paren
id|auto_nego
op_and_assign
op_complement
(paren
id|PHY_Cap_10_Full
op_or
id|PHY_Cap_100_Full
)paren
suffix:semicolon
)brace
id|tp-&gt;phy_auto_nego_reg
op_assign
id|auto_nego
suffix:semicolon
id|tp-&gt;phy_1000_ctrl_reg
op_assign
id|giga_ctrl
suffix:semicolon
id|mdio_write
c_func
(paren
id|ioaddr
comma
id|PHY_AUTO_NEGO_REG
comma
id|auto_nego
)paren
suffix:semicolon
id|mdio_write
c_func
(paren
id|ioaddr
comma
id|PHY_1000_CTRL_REG
comma
id|giga_ctrl
)paren
suffix:semicolon
id|mdio_write
c_func
(paren
id|ioaddr
comma
id|PHY_CTRL_REG
comma
id|PHY_Enable_Auto_Nego
op_or
id|PHY_Restart_Auto_Nego
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|rtl8169_set_speed
r_static
r_int
id|rtl8169_set_speed
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
id|u8
id|autoneg
comma
id|u16
id|speed
comma
id|u8
id|duplex
)paren
(brace
r_struct
id|rtl8169_private
op_star
id|tp
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
r_int
id|ret
suffix:semicolon
id|ret
op_assign
id|tp
op_member_access_from_pointer
id|set_speed
c_func
(paren
id|dev
comma
id|autoneg
comma
id|speed
comma
id|duplex
)paren
suffix:semicolon
r_if
c_cond
(paren
id|netif_running
c_func
(paren
id|dev
)paren
op_logical_and
(paren
id|tp-&gt;phy_1000_ctrl_reg
op_amp
id|PHY_Cap_1000_Full
)paren
)paren
id|mod_timer
c_func
(paren
op_amp
id|tp-&gt;timer
comma
id|jiffies
op_plus
id|RTL8169_PHY_TIMEOUT
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
DECL|function|rtl8169_set_settings
r_static
r_int
id|rtl8169_set_settings
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|ethtool_cmd
op_star
id|cmd
)paren
(brace
r_struct
id|rtl8169_private
op_star
id|tp
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
id|ret
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|tp-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|ret
op_assign
id|rtl8169_set_speed
c_func
(paren
id|dev
comma
id|cmd-&gt;autoneg
comma
id|cmd-&gt;speed
comma
id|cmd-&gt;duplex
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|tp-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
DECL|function|rtl8169_get_rx_csum
r_static
id|u32
id|rtl8169_get_rx_csum
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|rtl8169_private
op_star
id|tp
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
r_return
id|tp-&gt;cp_cmd
op_amp
id|RxChkSum
suffix:semicolon
)brace
DECL|function|rtl8169_set_rx_csum
r_static
r_int
id|rtl8169_set_rx_csum
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
id|u32
id|data
)paren
(brace
r_struct
id|rtl8169_private
op_star
id|tp
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
r_void
id|__iomem
op_star
id|ioaddr
op_assign
id|tp-&gt;mmio_addr
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|tp-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|data
)paren
id|tp-&gt;cp_cmd
op_or_assign
id|RxChkSum
suffix:semicolon
r_else
id|tp-&gt;cp_cmd
op_and_assign
op_complement
id|RxChkSum
suffix:semicolon
id|RTL_W16
c_func
(paren
id|CPlusCmd
comma
id|tp-&gt;cp_cmd
)paren
suffix:semicolon
id|RTL_R16
c_func
(paren
id|CPlusCmd
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|tp-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_R8169_VLAN
DECL|function|rtl8169_tx_vlan_tag
r_static
r_inline
id|u32
id|rtl8169_tx_vlan_tag
c_func
(paren
r_struct
id|rtl8169_private
op_star
id|tp
comma
r_struct
id|sk_buff
op_star
id|skb
)paren
(brace
r_return
(paren
id|tp-&gt;vlgrp
op_logical_and
id|vlan_tx_tag_present
c_func
(paren
id|skb
)paren
)paren
ques
c_cond
id|TxVlanTag
op_or
id|cpu_to_be16
c_func
(paren
id|vlan_tx_tag_get
c_func
(paren
id|skb
)paren
)paren
suffix:colon
l_int|0x00
suffix:semicolon
)brace
DECL|function|rtl8169_vlan_rx_register
r_static
r_void
id|rtl8169_vlan_rx_register
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|vlan_group
op_star
id|grp
)paren
(brace
r_struct
id|rtl8169_private
op_star
id|tp
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
r_void
id|__iomem
op_star
id|ioaddr
op_assign
id|tp-&gt;mmio_addr
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|tp-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|tp-&gt;vlgrp
op_assign
id|grp
)paren
)paren
id|tp-&gt;cp_cmd
op_or_assign
id|RxVlan
suffix:semicolon
r_else
id|tp-&gt;cp_cmd
op_and_assign
op_complement
id|RxVlan
suffix:semicolon
id|RTL_W16
c_func
(paren
id|CPlusCmd
comma
id|tp-&gt;cp_cmd
)paren
suffix:semicolon
id|RTL_R16
c_func
(paren
id|CPlusCmd
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|tp-&gt;lock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|rtl8169_vlan_rx_kill_vid
r_static
r_void
id|rtl8169_vlan_rx_kill_vid
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_int
r_int
id|vid
)paren
(brace
r_struct
id|rtl8169_private
op_star
id|tp
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|tp-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tp-&gt;vlgrp
)paren
id|tp-&gt;vlgrp-&gt;vlan_devices
(braket
id|vid
)braket
op_assign
l_int|NULL
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|tp-&gt;lock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|rtl8169_rx_vlan_skb
r_static
r_int
id|rtl8169_rx_vlan_skb
c_func
(paren
r_struct
id|rtl8169_private
op_star
id|tp
comma
r_struct
id|RxDesc
op_star
id|desc
comma
r_struct
id|sk_buff
op_star
id|skb
)paren
(brace
id|u32
id|opts2
op_assign
id|desc-&gt;opts2
suffix:semicolon
r_int
id|ret
suffix:semicolon
r_if
c_cond
(paren
id|tp-&gt;vlgrp
op_logical_and
(paren
id|opts2
op_amp
id|RxVlanTag
)paren
)paren
(brace
id|rtl8169_rx_hwaccel_skb
c_func
(paren
id|skb
comma
id|tp-&gt;vlgrp
comma
id|be16_to_cpu
c_func
(paren
id|opts2
op_amp
l_int|0xffff
)paren
)paren
suffix:semicolon
id|ret
op_assign
l_int|0
suffix:semicolon
)brace
r_else
id|ret
op_assign
op_minus
l_int|1
suffix:semicolon
id|desc-&gt;opts2
op_assign
l_int|0
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
macro_line|#else /* !CONFIG_R8169_VLAN */
DECL|function|rtl8169_tx_vlan_tag
r_static
r_inline
id|u32
id|rtl8169_tx_vlan_tag
c_func
(paren
r_struct
id|rtl8169_private
op_star
id|tp
comma
r_struct
id|sk_buff
op_star
id|skb
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|rtl8169_rx_vlan_skb
r_static
r_int
id|rtl8169_rx_vlan_skb
c_func
(paren
r_struct
id|rtl8169_private
op_star
id|tp
comma
r_struct
id|RxDesc
op_star
id|desc
comma
r_struct
id|sk_buff
op_star
id|skb
)paren
(brace
r_return
op_minus
l_int|1
suffix:semicolon
)brace
macro_line|#endif
DECL|function|rtl8169_gset_tbi
r_static
r_void
id|rtl8169_gset_tbi
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|ethtool_cmd
op_star
id|cmd
)paren
(brace
r_struct
id|rtl8169_private
op_star
id|tp
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
r_void
id|__iomem
op_star
id|ioaddr
op_assign
id|tp-&gt;mmio_addr
suffix:semicolon
id|u32
id|status
suffix:semicolon
id|cmd-&gt;supported
op_assign
id|SUPPORTED_1000baseT_Full
op_or
id|SUPPORTED_Autoneg
op_or
id|SUPPORTED_FIBRE
suffix:semicolon
id|cmd-&gt;port
op_assign
id|PORT_FIBRE
suffix:semicolon
id|cmd-&gt;transceiver
op_assign
id|XCVR_INTERNAL
suffix:semicolon
id|status
op_assign
id|RTL_R32
c_func
(paren
id|TBICSR
)paren
suffix:semicolon
id|cmd-&gt;advertising
op_assign
(paren
id|status
op_amp
id|TBINwEnable
)paren
ques
c_cond
id|ADVERTISED_Autoneg
suffix:colon
l_int|0
suffix:semicolon
id|cmd-&gt;autoneg
op_assign
op_logical_neg
op_logical_neg
(paren
id|status
op_amp
id|TBINwEnable
)paren
suffix:semicolon
id|cmd-&gt;speed
op_assign
id|SPEED_1000
suffix:semicolon
id|cmd-&gt;duplex
op_assign
id|DUPLEX_FULL
suffix:semicolon
multiline_comment|/* Always set */
)brace
DECL|function|rtl8169_gset_xmii
r_static
r_void
id|rtl8169_gset_xmii
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|ethtool_cmd
op_star
id|cmd
)paren
(brace
r_struct
id|rtl8169_private
op_star
id|tp
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
r_void
id|__iomem
op_star
id|ioaddr
op_assign
id|tp-&gt;mmio_addr
suffix:semicolon
id|u8
id|status
suffix:semicolon
id|cmd-&gt;supported
op_assign
id|SUPPORTED_10baseT_Half
op_or
id|SUPPORTED_10baseT_Full
op_or
id|SUPPORTED_100baseT_Half
op_or
id|SUPPORTED_100baseT_Full
op_or
id|SUPPORTED_1000baseT_Full
op_or
id|SUPPORTED_Autoneg
op_or
id|SUPPORTED_TP
suffix:semicolon
id|cmd-&gt;autoneg
op_assign
l_int|1
suffix:semicolon
id|cmd-&gt;advertising
op_assign
id|ADVERTISED_TP
op_or
id|ADVERTISED_Autoneg
suffix:semicolon
r_if
c_cond
(paren
id|tp-&gt;phy_auto_nego_reg
op_amp
id|PHY_Cap_10_Half
)paren
id|cmd-&gt;advertising
op_or_assign
id|ADVERTISED_10baseT_Half
suffix:semicolon
r_if
c_cond
(paren
id|tp-&gt;phy_auto_nego_reg
op_amp
id|PHY_Cap_10_Full
)paren
id|cmd-&gt;advertising
op_or_assign
id|ADVERTISED_10baseT_Full
suffix:semicolon
r_if
c_cond
(paren
id|tp-&gt;phy_auto_nego_reg
op_amp
id|PHY_Cap_100_Half
)paren
id|cmd-&gt;advertising
op_or_assign
id|ADVERTISED_100baseT_Half
suffix:semicolon
r_if
c_cond
(paren
id|tp-&gt;phy_auto_nego_reg
op_amp
id|PHY_Cap_100_Full
)paren
id|cmd-&gt;advertising
op_or_assign
id|ADVERTISED_100baseT_Full
suffix:semicolon
r_if
c_cond
(paren
id|tp-&gt;phy_1000_ctrl_reg
op_amp
id|PHY_Cap_1000_Full
)paren
id|cmd-&gt;advertising
op_or_assign
id|ADVERTISED_1000baseT_Full
suffix:semicolon
id|status
op_assign
id|RTL_R8
c_func
(paren
id|PHYstatus
)paren
suffix:semicolon
r_if
c_cond
(paren
id|status
op_amp
id|_1000bpsF
)paren
id|cmd-&gt;speed
op_assign
id|SPEED_1000
suffix:semicolon
r_else
r_if
c_cond
(paren
id|status
op_amp
id|_100bps
)paren
id|cmd-&gt;speed
op_assign
id|SPEED_100
suffix:semicolon
r_else
r_if
c_cond
(paren
id|status
op_amp
id|_10bps
)paren
id|cmd-&gt;speed
op_assign
id|SPEED_10
suffix:semicolon
id|cmd-&gt;duplex
op_assign
(paren
(paren
id|status
op_amp
id|_1000bpsF
)paren
op_logical_or
(paren
id|status
op_amp
id|FullDup
)paren
)paren
ques
c_cond
id|DUPLEX_FULL
suffix:colon
id|DUPLEX_HALF
suffix:semicolon
)brace
DECL|function|rtl8169_get_settings
r_static
r_int
id|rtl8169_get_settings
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|ethtool_cmd
op_star
id|cmd
)paren
(brace
r_struct
id|rtl8169_private
op_star
id|tp
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|tp-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|tp
op_member_access_from_pointer
id|get_settings
c_func
(paren
id|dev
comma
id|cmd
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|tp-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|rtl8169_get_regs
r_static
r_void
id|rtl8169_get_regs
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|ethtool_regs
op_star
id|regs
comma
r_void
op_star
id|p
)paren
(brace
r_struct
id|rtl8169_private
op_star
id|tp
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_if
c_cond
(paren
id|regs-&gt;len
OG
id|R8169_REGS_SIZE
)paren
id|regs-&gt;len
op_assign
id|R8169_REGS_SIZE
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|tp-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|memcpy_fromio
c_func
(paren
id|p
comma
id|tp-&gt;mmio_addr
comma
id|regs-&gt;len
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|tp-&gt;lock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|variable|rtl8169_ethtool_ops
r_static
r_struct
id|ethtool_ops
id|rtl8169_ethtool_ops
op_assign
(brace
dot
id|get_drvinfo
op_assign
id|rtl8169_get_drvinfo
comma
dot
id|get_regs_len
op_assign
id|rtl8169_get_regs_len
comma
dot
id|get_link
op_assign
id|ethtool_op_get_link
comma
dot
id|get_settings
op_assign
id|rtl8169_get_settings
comma
dot
id|set_settings
op_assign
id|rtl8169_set_settings
comma
dot
id|get_rx_csum
op_assign
id|rtl8169_get_rx_csum
comma
dot
id|set_rx_csum
op_assign
id|rtl8169_set_rx_csum
comma
dot
id|get_tx_csum
op_assign
id|ethtool_op_get_tx_csum
comma
dot
id|set_tx_csum
op_assign
id|ethtool_op_set_tx_csum
comma
dot
id|get_sg
op_assign
id|ethtool_op_get_sg
comma
dot
id|set_sg
op_assign
id|ethtool_op_set_sg
comma
dot
id|get_tso
op_assign
id|ethtool_op_get_tso
comma
dot
id|set_tso
op_assign
id|ethtool_op_set_tso
comma
dot
id|get_regs
op_assign
id|rtl8169_get_regs
comma
)brace
suffix:semicolon
DECL|function|rtl8169_write_gmii_reg_bit
r_static
r_void
id|rtl8169_write_gmii_reg_bit
c_func
(paren
r_void
id|__iomem
op_star
id|ioaddr
comma
r_int
id|reg
comma
r_int
id|bitnum
comma
r_int
id|bitval
)paren
(brace
r_int
id|val
suffix:semicolon
id|val
op_assign
id|mdio_read
c_func
(paren
id|ioaddr
comma
id|reg
)paren
suffix:semicolon
id|val
op_assign
(paren
id|bitval
op_eq
l_int|1
)paren
ques
c_cond
id|val
op_or
(paren
id|bitval
op_lshift
id|bitnum
)paren
suffix:colon
id|val
op_amp
op_complement
(paren
l_int|0x0001
op_lshift
id|bitnum
)paren
suffix:semicolon
id|mdio_write
c_func
(paren
id|ioaddr
comma
id|reg
comma
id|val
op_amp
l_int|0xffff
)paren
suffix:semicolon
)brace
DECL|function|rtl8169_get_mac_version
r_static
r_void
id|rtl8169_get_mac_version
c_func
(paren
r_struct
id|rtl8169_private
op_star
id|tp
comma
r_void
id|__iomem
op_star
id|ioaddr
)paren
(brace
r_const
r_struct
(brace
id|u32
id|mask
suffix:semicolon
r_int
id|mac_version
suffix:semicolon
)brace
id|mac_info
(braket
)braket
op_assign
(brace
(brace
l_int|0x1
op_lshift
l_int|28
comma
id|RTL_GIGA_MAC_VER_X
)brace
comma
(brace
l_int|0x1
op_lshift
l_int|26
comma
id|RTL_GIGA_MAC_VER_E
)brace
comma
(brace
l_int|0x1
op_lshift
l_int|23
comma
id|RTL_GIGA_MAC_VER_D
)brace
comma
(brace
l_int|0x00000000
comma
id|RTL_GIGA_MAC_VER_B
)brace
multiline_comment|/* Catch-all */
)brace
comma
op_star
id|p
op_assign
id|mac_info
suffix:semicolon
id|u32
id|reg
suffix:semicolon
id|reg
op_assign
id|RTL_R32
c_func
(paren
id|TxConfig
)paren
op_amp
l_int|0x7c800000
suffix:semicolon
r_while
c_loop
(paren
(paren
id|reg
op_amp
id|p-&gt;mask
)paren
op_ne
id|p-&gt;mask
)paren
id|p
op_increment
suffix:semicolon
id|tp-&gt;mac_version
op_assign
id|p-&gt;mac_version
suffix:semicolon
)brace
DECL|function|rtl8169_print_mac_version
r_static
r_void
id|rtl8169_print_mac_version
c_func
(paren
r_struct
id|rtl8169_private
op_star
id|tp
)paren
(brace
r_struct
(brace
r_int
id|version
suffix:semicolon
r_char
op_star
id|msg
suffix:semicolon
)brace
id|mac_print
(braket
)braket
op_assign
(brace
(brace
id|RTL_GIGA_MAC_VER_E
comma
l_string|&quot;RTL_GIGA_MAC_VER_E&quot;
)brace
comma
(brace
id|RTL_GIGA_MAC_VER_D
comma
l_string|&quot;RTL_GIGA_MAC_VER_D&quot;
)brace
comma
(brace
id|RTL_GIGA_MAC_VER_B
comma
l_string|&quot;RTL_GIGA_MAC_VER_B&quot;
)brace
comma
(brace
l_int|0
comma
l_int|NULL
)brace
)brace
comma
op_star
id|p
suffix:semicolon
r_for
c_loop
(paren
id|p
op_assign
id|mac_print
suffix:semicolon
id|p-&gt;msg
suffix:semicolon
id|p
op_increment
)paren
(brace
r_if
c_cond
(paren
id|tp-&gt;mac_version
op_eq
id|p-&gt;version
)paren
(brace
id|dprintk
c_func
(paren
l_string|&quot;mac_version == %s (%04d)&bslash;n&quot;
comma
id|p-&gt;msg
comma
id|p-&gt;version
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
)brace
id|dprintk
c_func
(paren
l_string|&quot;mac_version == Unknown&bslash;n&quot;
)paren
suffix:semicolon
)brace
DECL|function|rtl8169_get_phy_version
r_static
r_void
id|rtl8169_get_phy_version
c_func
(paren
r_struct
id|rtl8169_private
op_star
id|tp
comma
r_void
id|__iomem
op_star
id|ioaddr
)paren
(brace
r_const
r_struct
(brace
id|u16
id|mask
suffix:semicolon
id|u16
id|set
suffix:semicolon
r_int
id|phy_version
suffix:semicolon
)brace
id|phy_info
(braket
)braket
op_assign
(brace
(brace
l_int|0x000f
comma
l_int|0x0002
comma
id|RTL_GIGA_PHY_VER_G
)brace
comma
(brace
l_int|0x000f
comma
l_int|0x0001
comma
id|RTL_GIGA_PHY_VER_F
)brace
comma
(brace
l_int|0x000f
comma
l_int|0x0000
comma
id|RTL_GIGA_PHY_VER_E
)brace
comma
(brace
l_int|0x0000
comma
l_int|0x0000
comma
id|RTL_GIGA_PHY_VER_D
)brace
multiline_comment|/* Catch-all */
)brace
comma
op_star
id|p
op_assign
id|phy_info
suffix:semicolon
id|u16
id|reg
suffix:semicolon
id|reg
op_assign
id|mdio_read
c_func
(paren
id|ioaddr
comma
l_int|3
)paren
op_amp
l_int|0xffff
suffix:semicolon
r_while
c_loop
(paren
(paren
id|reg
op_amp
id|p-&gt;mask
)paren
op_ne
id|p-&gt;set
)paren
id|p
op_increment
suffix:semicolon
id|tp-&gt;phy_version
op_assign
id|p-&gt;phy_version
suffix:semicolon
)brace
DECL|function|rtl8169_print_phy_version
r_static
r_void
id|rtl8169_print_phy_version
c_func
(paren
r_struct
id|rtl8169_private
op_star
id|tp
)paren
(brace
r_struct
(brace
r_int
id|version
suffix:semicolon
r_char
op_star
id|msg
suffix:semicolon
id|u32
id|reg
suffix:semicolon
)brace
id|phy_print
(braket
)braket
op_assign
(brace
(brace
id|RTL_GIGA_PHY_VER_G
comma
l_string|&quot;RTL_GIGA_PHY_VER_G&quot;
comma
l_int|0x0002
)brace
comma
(brace
id|RTL_GIGA_PHY_VER_F
comma
l_string|&quot;RTL_GIGA_PHY_VER_F&quot;
comma
l_int|0x0001
)brace
comma
(brace
id|RTL_GIGA_PHY_VER_E
comma
l_string|&quot;RTL_GIGA_PHY_VER_E&quot;
comma
l_int|0x0000
)brace
comma
(brace
id|RTL_GIGA_PHY_VER_D
comma
l_string|&quot;RTL_GIGA_PHY_VER_D&quot;
comma
l_int|0x0000
)brace
comma
(brace
l_int|0
comma
l_int|NULL
comma
l_int|0x0000
)brace
)brace
comma
op_star
id|p
suffix:semicolon
r_for
c_loop
(paren
id|p
op_assign
id|phy_print
suffix:semicolon
id|p-&gt;msg
suffix:semicolon
id|p
op_increment
)paren
(brace
r_if
c_cond
(paren
id|tp-&gt;phy_version
op_eq
id|p-&gt;version
)paren
(brace
id|dprintk
c_func
(paren
l_string|&quot;phy_version == %s (%04x)&bslash;n&quot;
comma
id|p-&gt;msg
comma
id|p-&gt;reg
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
)brace
id|dprintk
c_func
(paren
l_string|&quot;phy_version == Unknown&bslash;n&quot;
)paren
suffix:semicolon
)brace
DECL|function|rtl8169_hw_phy_config
r_static
r_void
id|rtl8169_hw_phy_config
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|rtl8169_private
op_star
id|tp
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
r_void
id|__iomem
op_star
id|ioaddr
op_assign
id|tp-&gt;mmio_addr
suffix:semicolon
r_struct
(brace
id|u16
id|regs
(braket
l_int|5
)braket
suffix:semicolon
multiline_comment|/* Beware of bit-sign propagation */
)brace
id|phy_magic
(braket
l_int|5
)braket
op_assign
(brace
(brace
(brace
l_int|0x0000
comma
singleline_comment|//w 4 15 12 0
l_int|0x00a1
comma
singleline_comment|//w 3 15 0 00a1
l_int|0x0008
comma
singleline_comment|//w 2 15 0 0008
l_int|0x1020
comma
singleline_comment|//w 1 15 0 1020
l_int|0x1000
)brace
)brace
comma
(brace
singleline_comment|//w 0 15 0 1000
(brace
l_int|0x7000
comma
singleline_comment|//w 4 15 12 7
l_int|0xff41
comma
singleline_comment|//w 3 15 0 ff41
l_int|0xde60
comma
singleline_comment|//w 2 15 0 de60
l_int|0x0140
comma
singleline_comment|//w 1 15 0 0140
l_int|0x0077
)brace
)brace
comma
(brace
singleline_comment|//w 0 15 0 0077
(brace
l_int|0xa000
comma
singleline_comment|//w 4 15 12 a
l_int|0xdf01
comma
singleline_comment|//w 3 15 0 df01
l_int|0xdf20
comma
singleline_comment|//w 2 15 0 df20
l_int|0xff95
comma
singleline_comment|//w 1 15 0 ff95
l_int|0xfa00
)brace
)brace
comma
(brace
singleline_comment|//w 0 15 0 fa00
(brace
l_int|0xb000
comma
singleline_comment|//w 4 15 12 b
l_int|0xff41
comma
singleline_comment|//w 3 15 0 ff41
l_int|0xde20
comma
singleline_comment|//w 2 15 0 de20
l_int|0x0140
comma
singleline_comment|//w 1 15 0 0140
l_int|0x00bb
)brace
)brace
comma
(brace
singleline_comment|//w 0 15 0 00bb
(brace
l_int|0xf000
comma
singleline_comment|//w 4 15 12 f
l_int|0xdf01
comma
singleline_comment|//w 3 15 0 df01
l_int|0xdf20
comma
singleline_comment|//w 2 15 0 df20
l_int|0xff95
comma
singleline_comment|//w 1 15 0 ff95
l_int|0xbf00
)brace
singleline_comment|//w 0 15 0 bf00
)brace
)brace
comma
op_star
id|p
op_assign
id|phy_magic
suffix:semicolon
r_int
id|i
suffix:semicolon
id|rtl8169_print_mac_version
c_func
(paren
id|tp
)paren
suffix:semicolon
id|rtl8169_print_phy_version
c_func
(paren
id|tp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tp-&gt;mac_version
op_le
id|RTL_GIGA_MAC_VER_B
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|tp-&gt;phy_version
op_ge
id|RTL_GIGA_PHY_VER_F
)paren
r_return
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;MAC version != 0 &amp;&amp; PHY version == 0 or 1&bslash;n&quot;
)paren
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;Do final_reg2.cfg&bslash;n&quot;
)paren
suffix:semicolon
multiline_comment|/* Shazam ! */
singleline_comment|// phy config for RTL8169s mac_version C chip
id|mdio_write
c_func
(paren
id|ioaddr
comma
l_int|31
comma
l_int|0x0001
)paren
suffix:semicolon
singleline_comment|//w 31 2 0 1
id|mdio_write
c_func
(paren
id|ioaddr
comma
l_int|21
comma
l_int|0x1000
)paren
suffix:semicolon
singleline_comment|//w 21 15 0 1000
id|mdio_write
c_func
(paren
id|ioaddr
comma
l_int|24
comma
l_int|0x65c7
)paren
suffix:semicolon
singleline_comment|//w 24 15 0 65c7
id|rtl8169_write_gmii_reg_bit
c_func
(paren
id|ioaddr
comma
l_int|4
comma
l_int|11
comma
l_int|0
)paren
suffix:semicolon
singleline_comment|//w 4 11 11 0
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|ARRAY_SIZE
c_func
(paren
id|phy_magic
)paren
suffix:semicolon
id|i
op_increment
comma
id|p
op_increment
)paren
(brace
r_int
id|val
comma
id|pos
op_assign
l_int|4
suffix:semicolon
id|val
op_assign
(paren
id|mdio_read
c_func
(paren
id|ioaddr
comma
id|pos
)paren
op_amp
l_int|0x0fff
)paren
op_or
(paren
id|p-&gt;regs
(braket
l_int|0
)braket
op_amp
l_int|0xffff
)paren
suffix:semicolon
id|mdio_write
c_func
(paren
id|ioaddr
comma
id|pos
comma
id|val
)paren
suffix:semicolon
r_while
c_loop
(paren
op_decrement
id|pos
op_ge
l_int|0
)paren
id|mdio_write
c_func
(paren
id|ioaddr
comma
id|pos
comma
id|p-&gt;regs
(braket
l_int|4
op_minus
id|pos
)braket
op_amp
l_int|0xffff
)paren
suffix:semicolon
id|rtl8169_write_gmii_reg_bit
c_func
(paren
id|ioaddr
comma
l_int|4
comma
l_int|11
comma
l_int|1
)paren
suffix:semicolon
singleline_comment|//w 4 11 11 1
id|rtl8169_write_gmii_reg_bit
c_func
(paren
id|ioaddr
comma
l_int|4
comma
l_int|11
comma
l_int|0
)paren
suffix:semicolon
singleline_comment|//w 4 11 11 0
)brace
id|mdio_write
c_func
(paren
id|ioaddr
comma
l_int|31
comma
l_int|0x0000
)paren
suffix:semicolon
singleline_comment|//w 31 2 0 0
)brace
DECL|function|rtl8169_phy_timer
r_static
r_void
id|rtl8169_phy_timer
c_func
(paren
r_int
r_int
id|__opaque
)paren
(brace
r_struct
id|net_device
op_star
id|dev
op_assign
(paren
r_struct
id|net_device
op_star
)paren
id|__opaque
suffix:semicolon
r_struct
id|rtl8169_private
op_star
id|tp
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
r_struct
id|timer_list
op_star
id|timer
op_assign
op_amp
id|tp-&gt;timer
suffix:semicolon
r_void
id|__iomem
op_star
id|ioaddr
op_assign
id|tp-&gt;mmio_addr
suffix:semicolon
r_int
r_int
id|timeout
op_assign
id|RTL8169_PHY_TIMEOUT
suffix:semicolon
m_assert
(paren
id|tp-&gt;mac_version
OG
id|RTL_GIGA_MAC_VER_B
)paren
suffix:semicolon
m_assert
(paren
id|tp-&gt;phy_version
OL
id|RTL_GIGA_PHY_VER_G
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|tp-&gt;phy_1000_ctrl_reg
op_amp
id|PHY_Cap_1000_Full
)paren
)paren
r_return
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|tp-&gt;lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tp
op_member_access_from_pointer
id|phy_reset_pending
c_func
(paren
id|ioaddr
)paren
)paren
(brace
multiline_comment|/* &n;&t;&t; * A busy loop could burn quite a few cycles on nowadays CPU.&n;&t;&t; * Let&squot;s delay the execution of the timer for a few ticks.&n;&t;&t; */
id|timeout
op_assign
id|HZ
op_div
l_int|10
suffix:semicolon
r_goto
id|out_mod_timer
suffix:semicolon
)brace
r_if
c_cond
(paren
id|tp
op_member_access_from_pointer
id|link_ok
c_func
(paren
id|ioaddr
)paren
)paren
r_goto
id|out_unlock
suffix:semicolon
id|printk
c_func
(paren
id|KERN_WARNING
id|PFX
l_string|&quot;%s: PHY reset until link up&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
id|tp
op_member_access_from_pointer
id|phy_reset_enable
c_func
(paren
id|ioaddr
)paren
suffix:semicolon
id|out_mod_timer
suffix:colon
id|mod_timer
c_func
(paren
id|timer
comma
id|jiffies
op_plus
id|timeout
)paren
suffix:semicolon
id|out_unlock
suffix:colon
id|spin_unlock_irq
c_func
(paren
op_amp
id|tp-&gt;lock
)paren
suffix:semicolon
)brace
DECL|function|rtl8169_delete_timer
r_static
r_inline
r_void
id|rtl8169_delete_timer
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|rtl8169_private
op_star
id|tp
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
r_struct
id|timer_list
op_star
id|timer
op_assign
op_amp
id|tp-&gt;timer
suffix:semicolon
r_if
c_cond
(paren
(paren
id|tp-&gt;mac_version
op_le
id|RTL_GIGA_MAC_VER_B
)paren
op_logical_or
(paren
id|tp-&gt;phy_version
op_ge
id|RTL_GIGA_PHY_VER_G
)paren
)paren
r_return
suffix:semicolon
id|del_timer_sync
c_func
(paren
id|timer
)paren
suffix:semicolon
)brace
DECL|function|rtl8169_request_timer
r_static
r_inline
r_void
id|rtl8169_request_timer
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|rtl8169_private
op_star
id|tp
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
r_struct
id|timer_list
op_star
id|timer
op_assign
op_amp
id|tp-&gt;timer
suffix:semicolon
r_if
c_cond
(paren
(paren
id|tp-&gt;mac_version
op_le
id|RTL_GIGA_MAC_VER_B
)paren
op_logical_or
(paren
id|tp-&gt;phy_version
op_ge
id|RTL_GIGA_PHY_VER_G
)paren
)paren
r_return
suffix:semicolon
id|init_timer
c_func
(paren
id|timer
)paren
suffix:semicolon
id|timer-&gt;expires
op_assign
id|jiffies
op_plus
id|RTL8169_PHY_TIMEOUT
suffix:semicolon
id|timer-&gt;data
op_assign
(paren
r_int
r_int
)paren
(paren
id|dev
)paren
suffix:semicolon
id|timer-&gt;function
op_assign
id|rtl8169_phy_timer
suffix:semicolon
id|add_timer
c_func
(paren
id|timer
)paren
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_NET_POLL_CONTROLLER
multiline_comment|/*&n; * Polling &squot;interrupt&squot; - used by things like netconsole to send skbs&n; * without having to re-enable interrupts. It&squot;s not called while&n; * the interrupt routine is executing.&n; */
DECL|function|rtl8169_netpoll
r_static
r_void
id|rtl8169_netpoll
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|rtl8169_private
op_star
id|tp
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
r_struct
id|pci_dev
op_star
id|pdev
op_assign
id|tp-&gt;pci_dev
suffix:semicolon
id|disable_irq
c_func
(paren
id|pdev-&gt;irq
)paren
suffix:semicolon
id|rtl8169_interrupt
c_func
(paren
id|pdev-&gt;irq
comma
id|dev
comma
l_int|NULL
)paren
suffix:semicolon
id|enable_irq
c_func
(paren
id|pdev-&gt;irq
)paren
suffix:semicolon
)brace
macro_line|#endif
DECL|function|rtl8169_release_board
r_static
r_void
id|rtl8169_release_board
c_func
(paren
r_struct
id|pci_dev
op_star
id|pdev
comma
r_struct
id|net_device
op_star
id|dev
comma
r_void
id|__iomem
op_star
id|ioaddr
)paren
(brace
id|iounmap
c_func
(paren
id|ioaddr
)paren
suffix:semicolon
id|pci_release_regions
c_func
(paren
id|pdev
)paren
suffix:semicolon
id|pci_disable_device
c_func
(paren
id|pdev
)paren
suffix:semicolon
id|free_netdev
c_func
(paren
id|dev
)paren
suffix:semicolon
)brace
r_static
r_int
id|__devinit
DECL|function|rtl8169_init_board
id|rtl8169_init_board
c_func
(paren
r_struct
id|pci_dev
op_star
id|pdev
comma
r_struct
id|net_device
op_star
op_star
id|dev_out
comma
r_void
id|__iomem
op_star
op_star
id|ioaddr_out
)paren
(brace
r_void
id|__iomem
op_star
id|ioaddr
suffix:semicolon
r_struct
id|net_device
op_star
id|dev
suffix:semicolon
r_struct
id|rtl8169_private
op_star
id|tp
suffix:semicolon
r_int
id|rc
op_assign
op_minus
id|ENOMEM
comma
id|i
comma
id|acpi_idle_state
op_assign
l_int|0
comma
id|pm_cap
suffix:semicolon
m_assert
(paren
id|ioaddr_out
op_ne
l_int|NULL
)paren
suffix:semicolon
singleline_comment|// dev zeroed in alloc_etherdev 
id|dev
op_assign
id|alloc_etherdev
c_func
(paren
r_sizeof
(paren
op_star
id|tp
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dev
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
id|PFX
l_string|&quot;unable to alloc new ethernet&bslash;n&quot;
)paren
suffix:semicolon
r_goto
id|err_out
suffix:semicolon
)brace
id|SET_MODULE_OWNER
c_func
(paren
id|dev
)paren
suffix:semicolon
id|SET_NETDEV_DEV
c_func
(paren
id|dev
comma
op_amp
id|pdev-&gt;dev
)paren
suffix:semicolon
id|tp
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
singleline_comment|// enable device (incl. PCI PM wakeup and hotplug setup)
id|rc
op_assign
id|pci_enable_device
c_func
(paren
id|pdev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rc
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
id|PFX
l_string|&quot;%s: enable failure&bslash;n&quot;
comma
id|pdev-&gt;slot_name
)paren
suffix:semicolon
r_goto
id|err_out_free_dev
suffix:semicolon
)brace
id|rc
op_assign
id|pci_set_mwi
c_func
(paren
id|pdev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rc
OL
l_int|0
)paren
r_goto
id|err_out_disable
suffix:semicolon
multiline_comment|/* save power state before pci_enable_device overwrites it */
id|pm_cap
op_assign
id|pci_find_capability
c_func
(paren
id|pdev
comma
id|PCI_CAP_ID_PM
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pm_cap
)paren
(brace
id|u16
id|pwr_command
suffix:semicolon
id|pci_read_config_word
c_func
(paren
id|pdev
comma
id|pm_cap
op_plus
id|PCI_PM_CTRL
comma
op_amp
id|pwr_command
)paren
suffix:semicolon
id|acpi_idle_state
op_assign
id|pwr_command
op_amp
id|PCI_PM_CTRL_STATE_MASK
suffix:semicolon
)brace
r_else
(brace
id|printk
c_func
(paren
id|KERN_ERR
id|PFX
l_string|&quot;Cannot find PowerManagement capability, aborting.&bslash;n&quot;
)paren
suffix:semicolon
r_goto
id|err_out_mwi
suffix:semicolon
)brace
singleline_comment|// make sure PCI base addr 1 is MMIO
r_if
c_cond
(paren
op_logical_neg
(paren
id|pci_resource_flags
c_func
(paren
id|pdev
comma
l_int|1
)paren
op_amp
id|IORESOURCE_MEM
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
id|PFX
l_string|&quot;region #1 not an MMIO resource, aborting&bslash;n&quot;
)paren
suffix:semicolon
id|rc
op_assign
op_minus
id|ENODEV
suffix:semicolon
r_goto
id|err_out_mwi
suffix:semicolon
)brace
singleline_comment|// check for weird/broken PCI region reporting
r_if
c_cond
(paren
id|pci_resource_len
c_func
(paren
id|pdev
comma
l_int|1
)paren
OL
id|R8169_REGS_SIZE
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
id|PFX
l_string|&quot;Invalid PCI region size(s), aborting&bslash;n&quot;
)paren
suffix:semicolon
id|rc
op_assign
op_minus
id|ENODEV
suffix:semicolon
r_goto
id|err_out_mwi
suffix:semicolon
)brace
id|rc
op_assign
id|pci_request_regions
c_func
(paren
id|pdev
comma
id|MODULENAME
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rc
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
id|PFX
l_string|&quot;%s: could not request regions.&bslash;n&quot;
comma
id|pdev-&gt;slot_name
)paren
suffix:semicolon
r_goto
id|err_out_mwi
suffix:semicolon
)brace
id|tp-&gt;cp_cmd
op_assign
id|PCIMulRW
op_or
id|RxChkSum
suffix:semicolon
r_if
c_cond
(paren
(paren
r_sizeof
(paren
id|dma_addr_t
)paren
OG
l_int|4
)paren
op_logical_and
op_logical_neg
id|pci_set_dma_mask
c_func
(paren
id|pdev
comma
id|DMA_64BIT_MASK
)paren
op_logical_and
id|use_dac
)paren
(brace
id|tp-&gt;cp_cmd
op_or_assign
id|PCIDAC
suffix:semicolon
id|dev-&gt;features
op_or_assign
id|NETIF_F_HIGHDMA
suffix:semicolon
)brace
r_else
(brace
id|rc
op_assign
id|pci_set_dma_mask
c_func
(paren
id|pdev
comma
id|DMA_32BIT_MASK
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rc
OL
l_int|0
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
id|PFX
l_string|&quot;DMA configuration failed.&bslash;n&quot;
)paren
suffix:semicolon
r_goto
id|err_out_free_res
suffix:semicolon
)brace
)brace
id|pci_set_master
c_func
(paren
id|pdev
)paren
suffix:semicolon
singleline_comment|// ioremap MMIO region 
id|ioaddr
op_assign
id|ioremap
c_func
(paren
id|pci_resource_start
c_func
(paren
id|pdev
comma
l_int|1
)paren
comma
id|R8169_REGS_SIZE
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ioaddr
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
id|PFX
l_string|&quot;cannot remap MMIO, aborting&bslash;n&quot;
)paren
suffix:semicolon
id|rc
op_assign
op_minus
id|EIO
suffix:semicolon
r_goto
id|err_out_free_res
suffix:semicolon
)brace
singleline_comment|// Soft reset the chip. 
id|RTL_W8
c_func
(paren
id|ChipCmd
comma
id|CmdReset
)paren
suffix:semicolon
singleline_comment|// Check that the chip has finished the reset.
r_for
c_loop
(paren
id|i
op_assign
l_int|1000
suffix:semicolon
id|i
OG
l_int|0
suffix:semicolon
id|i
op_decrement
)paren
(brace
r_if
c_cond
(paren
(paren
id|RTL_R8
c_func
(paren
id|ChipCmd
)paren
op_amp
id|CmdReset
)paren
op_eq
l_int|0
)paren
r_break
suffix:semicolon
id|udelay
c_func
(paren
l_int|10
)paren
suffix:semicolon
)brace
singleline_comment|// Identify chip attached to board
id|rtl8169_get_mac_version
c_func
(paren
id|tp
comma
id|ioaddr
)paren
suffix:semicolon
id|rtl8169_get_phy_version
c_func
(paren
id|tp
comma
id|ioaddr
)paren
suffix:semicolon
id|rtl8169_print_mac_version
c_func
(paren
id|tp
)paren
suffix:semicolon
id|rtl8169_print_phy_version
c_func
(paren
id|tp
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
id|ARRAY_SIZE
c_func
(paren
id|rtl_chip_info
)paren
op_minus
l_int|1
suffix:semicolon
id|i
op_ge
l_int|0
suffix:semicolon
id|i
op_decrement
)paren
(brace
r_if
c_cond
(paren
id|tp-&gt;mac_version
op_eq
id|rtl_chip_info
(braket
id|i
)braket
dot
id|mac_version
)paren
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|i
OL
l_int|0
)paren
(brace
multiline_comment|/* Unknown chip: assume array element #0, original RTL-8169 */
id|printk
c_func
(paren
id|KERN_DEBUG
id|PFX
l_string|&quot;PCI device %s: unknown chip version, assuming %s&bslash;n&quot;
comma
id|pci_name
c_func
(paren
id|pdev
)paren
comma
id|rtl_chip_info
(braket
l_int|0
)braket
dot
id|name
)paren
suffix:semicolon
id|i
op_increment
suffix:semicolon
)brace
id|tp-&gt;chipset
op_assign
id|i
suffix:semicolon
id|tp-&gt;rx_buf_sz
op_assign
id|RX_BUF_SIZE
suffix:semicolon
op_star
id|ioaddr_out
op_assign
id|ioaddr
suffix:semicolon
op_star
id|dev_out
op_assign
id|dev
suffix:semicolon
id|out
suffix:colon
r_return
id|rc
suffix:semicolon
id|err_out_free_res
suffix:colon
id|pci_release_regions
c_func
(paren
id|pdev
)paren
suffix:semicolon
id|err_out_mwi
suffix:colon
id|pci_clear_mwi
c_func
(paren
id|pdev
)paren
suffix:semicolon
id|err_out_disable
suffix:colon
id|pci_disable_device
c_func
(paren
id|pdev
)paren
suffix:semicolon
id|err_out_free_dev
suffix:colon
id|free_netdev
c_func
(paren
id|dev
)paren
suffix:semicolon
id|err_out
suffix:colon
op_star
id|ioaddr_out
op_assign
l_int|NULL
suffix:semicolon
op_star
id|dev_out
op_assign
l_int|NULL
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
r_static
r_int
id|__devinit
DECL|function|rtl8169_init_one
id|rtl8169_init_one
c_func
(paren
r_struct
id|pci_dev
op_star
id|pdev
comma
r_const
r_struct
id|pci_device_id
op_star
id|ent
)paren
(brace
r_struct
id|net_device
op_star
id|dev
op_assign
l_int|NULL
suffix:semicolon
r_struct
id|rtl8169_private
op_star
id|tp
suffix:semicolon
r_void
id|__iomem
op_star
id|ioaddr
op_assign
l_int|NULL
suffix:semicolon
r_static
r_int
id|board_idx
op_assign
op_minus
l_int|1
suffix:semicolon
r_static
r_int
id|printed_version
op_assign
l_int|0
suffix:semicolon
id|u8
id|autoneg
comma
id|duplex
suffix:semicolon
id|u16
id|speed
suffix:semicolon
r_int
id|i
comma
id|rc
suffix:semicolon
m_assert
(paren
id|pdev
op_ne
l_int|NULL
)paren
suffix:semicolon
m_assert
(paren
id|ent
op_ne
l_int|NULL
)paren
suffix:semicolon
id|board_idx
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|printed_version
)paren
(brace
id|printk
c_func
(paren
id|KERN_INFO
id|RTL8169_DRIVER_NAME
l_string|&quot; loaded&bslash;n&quot;
)paren
suffix:semicolon
id|printed_version
op_assign
l_int|1
suffix:semicolon
)brace
id|rc
op_assign
id|rtl8169_init_board
c_func
(paren
id|pdev
comma
op_amp
id|dev
comma
op_amp
id|ioaddr
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rc
)paren
r_return
id|rc
suffix:semicolon
id|tp
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
m_assert
(paren
id|ioaddr
op_ne
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|RTL_R8
c_func
(paren
id|PHYstatus
)paren
op_amp
id|TBI_Enable
)paren
(brace
id|tp-&gt;set_speed
op_assign
id|rtl8169_set_speed_tbi
suffix:semicolon
id|tp-&gt;get_settings
op_assign
id|rtl8169_gset_tbi
suffix:semicolon
id|tp-&gt;phy_reset_enable
op_assign
id|rtl8169_tbi_reset_enable
suffix:semicolon
id|tp-&gt;phy_reset_pending
op_assign
id|rtl8169_tbi_reset_pending
suffix:semicolon
id|tp-&gt;link_ok
op_assign
id|rtl8169_tbi_link_ok
suffix:semicolon
id|tp-&gt;phy_1000_ctrl_reg
op_assign
id|PHY_Cap_1000_Full
suffix:semicolon
multiline_comment|/* Implied by TBI */
)brace
r_else
(brace
id|tp-&gt;set_speed
op_assign
id|rtl8169_set_speed_xmii
suffix:semicolon
id|tp-&gt;get_settings
op_assign
id|rtl8169_gset_xmii
suffix:semicolon
id|tp-&gt;phy_reset_enable
op_assign
id|rtl8169_xmii_reset_enable
suffix:semicolon
id|tp-&gt;phy_reset_pending
op_assign
id|rtl8169_xmii_reset_pending
suffix:semicolon
id|tp-&gt;link_ok
op_assign
id|rtl8169_xmii_link_ok
suffix:semicolon
)brace
singleline_comment|// Get MAC address.  FIXME: read EEPROM
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|MAC_ADDR_LEN
suffix:semicolon
id|i
op_increment
)paren
id|dev-&gt;dev_addr
(braket
id|i
)braket
op_assign
id|RTL_R8
c_func
(paren
id|MAC0
op_plus
id|i
)paren
suffix:semicolon
id|dev-&gt;open
op_assign
id|rtl8169_open
suffix:semicolon
id|dev-&gt;hard_start_xmit
op_assign
id|rtl8169_start_xmit
suffix:semicolon
id|dev-&gt;get_stats
op_assign
id|rtl8169_get_stats
suffix:semicolon
id|SET_ETHTOOL_OPS
c_func
(paren
id|dev
comma
op_amp
id|rtl8169_ethtool_ops
)paren
suffix:semicolon
id|dev-&gt;stop
op_assign
id|rtl8169_close
suffix:semicolon
id|dev-&gt;tx_timeout
op_assign
id|rtl8169_tx_timeout
suffix:semicolon
id|dev-&gt;set_multicast_list
op_assign
id|rtl8169_set_rx_mode
suffix:semicolon
id|dev-&gt;watchdog_timeo
op_assign
id|RTL8169_TX_TIMEOUT
suffix:semicolon
id|dev-&gt;irq
op_assign
id|pdev-&gt;irq
suffix:semicolon
id|dev-&gt;base_addr
op_assign
(paren
r_int
r_int
)paren
id|ioaddr
suffix:semicolon
macro_line|#ifdef CONFIG_R8169_NAPI
id|dev-&gt;poll
op_assign
id|rtl8169_poll
suffix:semicolon
id|dev-&gt;weight
op_assign
id|R8169_NAPI_WEIGHT
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
id|PFX
l_string|&quot;NAPI enabled&bslash;n&quot;
)paren
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_R8169_VLAN
id|dev-&gt;features
op_or_assign
id|NETIF_F_HW_VLAN_TX
op_or
id|NETIF_F_HW_VLAN_RX
suffix:semicolon
id|dev-&gt;vlan_rx_register
op_assign
id|rtl8169_vlan_rx_register
suffix:semicolon
id|dev-&gt;vlan_rx_kill_vid
op_assign
id|rtl8169_vlan_rx_kill_vid
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_NET_POLL_CONTROLLER
id|dev-&gt;poll_controller
op_assign
id|rtl8169_netpoll
suffix:semicolon
macro_line|#endif
id|tp-&gt;intr_mask
op_assign
l_int|0xffff
suffix:semicolon
id|tp-&gt;pci_dev
op_assign
id|pdev
suffix:semicolon
id|tp-&gt;mmio_addr
op_assign
id|ioaddr
suffix:semicolon
id|spin_lock_init
c_func
(paren
op_amp
id|tp-&gt;lock
)paren
suffix:semicolon
id|rc
op_assign
id|register_netdev
c_func
(paren
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rc
)paren
(brace
id|rtl8169_release_board
c_func
(paren
id|pdev
comma
id|dev
comma
id|ioaddr
)paren
suffix:semicolon
r_return
id|rc
suffix:semicolon
)brace
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;%s: Identified chip type is &squot;%s&squot;.&bslash;n&quot;
comma
id|dev-&gt;name
comma
id|rtl_chip_info
(braket
id|tp-&gt;chipset
)braket
dot
id|name
)paren
suffix:semicolon
id|pci_set_drvdata
c_func
(paren
id|pdev
comma
id|dev
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;%s: %s at 0x%lx, &quot;
l_string|&quot;%2.2x:%2.2x:%2.2x:%2.2x:%2.2x:%2.2x, &quot;
l_string|&quot;IRQ %d&bslash;n&quot;
comma
id|dev-&gt;name
comma
id|rtl_chip_info
(braket
id|ent-&gt;driver_data
)braket
dot
id|name
comma
id|dev-&gt;base_addr
comma
id|dev-&gt;dev_addr
(braket
l_int|0
)braket
comma
id|dev-&gt;dev_addr
(braket
l_int|1
)braket
comma
id|dev-&gt;dev_addr
(braket
l_int|2
)braket
comma
id|dev-&gt;dev_addr
(braket
l_int|3
)braket
comma
id|dev-&gt;dev_addr
(braket
l_int|4
)braket
comma
id|dev-&gt;dev_addr
(braket
l_int|5
)braket
comma
id|dev-&gt;irq
)paren
suffix:semicolon
id|rtl8169_hw_phy_config
c_func
(paren
id|dev
)paren
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;Set MAC Reg C+CR Offset 0x82h = 0x01h&bslash;n&quot;
)paren
suffix:semicolon
id|RTL_W8
c_func
(paren
l_int|0x82
comma
l_int|0x01
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tp-&gt;mac_version
OL
id|RTL_GIGA_MAC_VER_E
)paren
(brace
id|dprintk
c_func
(paren
l_string|&quot;Set PCI Latency=0x40&bslash;n&quot;
)paren
suffix:semicolon
id|pci_write_config_byte
c_func
(paren
id|pdev
comma
id|PCI_LATENCY_TIMER
comma
l_int|0x40
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|tp-&gt;mac_version
op_eq
id|RTL_GIGA_MAC_VER_D
)paren
(brace
id|dprintk
c_func
(paren
l_string|&quot;Set MAC Reg C+CR Offset 0x82h = 0x01h&bslash;n&quot;
)paren
suffix:semicolon
id|RTL_W8
c_func
(paren
l_int|0x82
comma
l_int|0x01
)paren
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;Set PHY Reg 0x0bh = 0x00h&bslash;n&quot;
)paren
suffix:semicolon
id|mdio_write
c_func
(paren
id|ioaddr
comma
l_int|0x0b
comma
l_int|0x0000
)paren
suffix:semicolon
singleline_comment|//w 0x0b 15 0 0
)brace
id|rtl8169_link_option
c_func
(paren
id|board_idx
comma
op_amp
id|autoneg
comma
op_amp
id|speed
comma
op_amp
id|duplex
)paren
suffix:semicolon
id|rtl8169_set_speed
c_func
(paren
id|dev
comma
id|autoneg
comma
id|speed
comma
id|duplex
)paren
suffix:semicolon
r_if
c_cond
(paren
id|RTL_R8
c_func
(paren
id|PHYstatus
)paren
op_amp
id|TBI_Enable
)paren
id|printk
c_func
(paren
id|KERN_INFO
id|PFX
l_string|&quot;%s: TBI auto-negotiating&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_void
id|__devexit
DECL|function|rtl8169_remove_one
id|rtl8169_remove_one
c_func
(paren
r_struct
id|pci_dev
op_star
id|pdev
)paren
(brace
r_struct
id|net_device
op_star
id|dev
op_assign
id|pci_get_drvdata
c_func
(paren
id|pdev
)paren
suffix:semicolon
r_struct
id|rtl8169_private
op_star
id|tp
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
m_assert
(paren
id|dev
op_ne
l_int|NULL
)paren
suffix:semicolon
m_assert
(paren
id|tp
op_ne
l_int|NULL
)paren
suffix:semicolon
id|unregister_netdev
c_func
(paren
id|dev
)paren
suffix:semicolon
id|rtl8169_release_board
c_func
(paren
id|pdev
comma
id|dev
comma
id|tp-&gt;mmio_addr
)paren
suffix:semicolon
id|pci_set_drvdata
c_func
(paren
id|pdev
comma
l_int|NULL
)paren
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_PM
DECL|function|rtl8169_suspend
r_static
r_int
id|rtl8169_suspend
c_func
(paren
r_struct
id|pci_dev
op_star
id|pdev
comma
id|u32
id|state
)paren
(brace
r_struct
id|net_device
op_star
id|dev
op_assign
id|pci_get_drvdata
c_func
(paren
id|pdev
)paren
suffix:semicolon
r_struct
id|rtl8169_private
op_star
id|tp
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
r_void
id|__iomem
op_star
id|ioaddr
op_assign
id|tp-&gt;mmio_addr
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|netif_running
c_func
(paren
id|dev
)paren
)paren
r_return
l_int|0
suffix:semicolon
id|netif_device_detach
c_func
(paren
id|dev
)paren
suffix:semicolon
id|netif_stop_queue
c_func
(paren
id|dev
)paren
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|tp-&gt;lock
comma
id|flags
)paren
suffix:semicolon
multiline_comment|/* Disable interrupts, stop Rx and Tx */
id|RTL_W16
c_func
(paren
id|IntrMask
comma
l_int|0
)paren
suffix:semicolon
id|RTL_W8
c_func
(paren
id|ChipCmd
comma
l_int|0
)paren
suffix:semicolon
multiline_comment|/* Update the error counts. */
id|tp-&gt;stats.rx_missed_errors
op_add_assign
id|RTL_R32
c_func
(paren
id|RxMissed
)paren
suffix:semicolon
id|RTL_W32
c_func
(paren
id|RxMissed
comma
l_int|0
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|tp-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|rtl8169_resume
r_static
r_int
id|rtl8169_resume
c_func
(paren
r_struct
id|pci_dev
op_star
id|pdev
)paren
(brace
r_struct
id|net_device
op_star
id|dev
op_assign
id|pci_get_drvdata
c_func
(paren
id|pdev
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|netif_running
c_func
(paren
id|dev
)paren
)paren
r_return
l_int|0
suffix:semicolon
id|netif_device_attach
c_func
(paren
id|dev
)paren
suffix:semicolon
id|rtl8169_hw_start
c_func
(paren
id|dev
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#endif /* CONFIG_PM */
r_static
r_int
DECL|function|rtl8169_open
id|rtl8169_open
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|rtl8169_private
op_star
id|tp
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
r_struct
id|pci_dev
op_star
id|pdev
op_assign
id|tp-&gt;pci_dev
suffix:semicolon
r_int
id|retval
suffix:semicolon
id|retval
op_assign
id|request_irq
c_func
(paren
id|dev-&gt;irq
comma
id|rtl8169_interrupt
comma
id|SA_SHIRQ
comma
id|dev-&gt;name
comma
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|retval
OL
l_int|0
)paren
r_goto
id|out
suffix:semicolon
id|retval
op_assign
op_minus
id|ENOMEM
suffix:semicolon
multiline_comment|/*&n;&t; * Rx and Tx desscriptors needs 256 bytes alignment.&n;&t; * pci_alloc_consistent provides more.&n;&t; */
id|tp-&gt;TxDescArray
op_assign
id|pci_alloc_consistent
c_func
(paren
id|pdev
comma
id|R8169_TX_RING_BYTES
comma
op_amp
id|tp-&gt;TxPhyAddr
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|tp-&gt;TxDescArray
)paren
r_goto
id|err_free_irq
suffix:semicolon
id|tp-&gt;RxDescArray
op_assign
id|pci_alloc_consistent
c_func
(paren
id|pdev
comma
id|R8169_RX_RING_BYTES
comma
op_amp
id|tp-&gt;RxPhyAddr
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|tp-&gt;RxDescArray
)paren
r_goto
id|err_free_tx
suffix:semicolon
id|retval
op_assign
id|rtl8169_init_ring
c_func
(paren
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|retval
OL
l_int|0
)paren
r_goto
id|err_free_rx
suffix:semicolon
id|INIT_WORK
c_func
(paren
op_amp
id|tp-&gt;task
comma
l_int|NULL
comma
id|dev
)paren
suffix:semicolon
id|rtl8169_hw_start
c_func
(paren
id|dev
)paren
suffix:semicolon
id|rtl8169_request_timer
c_func
(paren
id|dev
)paren
suffix:semicolon
id|rtl8169_check_link_status
c_func
(paren
id|dev
comma
id|tp
comma
id|tp-&gt;mmio_addr
)paren
suffix:semicolon
id|out
suffix:colon
r_return
id|retval
suffix:semicolon
id|err_free_rx
suffix:colon
id|pci_free_consistent
c_func
(paren
id|pdev
comma
id|R8169_RX_RING_BYTES
comma
id|tp-&gt;RxDescArray
comma
id|tp-&gt;RxPhyAddr
)paren
suffix:semicolon
id|err_free_tx
suffix:colon
id|pci_free_consistent
c_func
(paren
id|pdev
comma
id|R8169_TX_RING_BYTES
comma
id|tp-&gt;TxDescArray
comma
id|tp-&gt;TxPhyAddr
)paren
suffix:semicolon
id|err_free_irq
suffix:colon
id|free_irq
c_func
(paren
id|dev-&gt;irq
comma
id|dev
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
DECL|function|rtl8169_hw_reset
r_static
r_void
id|rtl8169_hw_reset
c_func
(paren
r_void
id|__iomem
op_star
id|ioaddr
)paren
(brace
multiline_comment|/* Disable interrupts */
id|RTL_W16
c_func
(paren
id|IntrMask
comma
l_int|0x0000
)paren
suffix:semicolon
multiline_comment|/* Reset the chipset */
id|RTL_W8
c_func
(paren
id|ChipCmd
comma
id|CmdReset
)paren
suffix:semicolon
multiline_comment|/* PCI commit */
id|RTL_R8
c_func
(paren
id|ChipCmd
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|rtl8169_hw_start
id|rtl8169_hw_start
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|rtl8169_private
op_star
id|tp
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
r_void
id|__iomem
op_star
id|ioaddr
op_assign
id|tp-&gt;mmio_addr
suffix:semicolon
id|u32
id|i
suffix:semicolon
multiline_comment|/* Soft reset the chip. */
id|RTL_W8
c_func
(paren
id|ChipCmd
comma
id|CmdReset
)paren
suffix:semicolon
multiline_comment|/* Check that the chip has finished the reset. */
r_for
c_loop
(paren
id|i
op_assign
l_int|1000
suffix:semicolon
id|i
OG
l_int|0
suffix:semicolon
id|i
op_decrement
)paren
(brace
r_if
c_cond
(paren
(paren
id|RTL_R8
c_func
(paren
id|ChipCmd
)paren
op_amp
id|CmdReset
)paren
op_eq
l_int|0
)paren
r_break
suffix:semicolon
id|udelay
c_func
(paren
l_int|10
)paren
suffix:semicolon
)brace
id|RTL_W8
c_func
(paren
id|Cfg9346
comma
id|Cfg9346_Unlock
)paren
suffix:semicolon
id|RTL_W8
c_func
(paren
id|ChipCmd
comma
id|CmdTxEnb
op_or
id|CmdRxEnb
)paren
suffix:semicolon
id|RTL_W8
c_func
(paren
id|EarlyTxThres
comma
id|EarlyTxThld
)paren
suffix:semicolon
singleline_comment|// For gigabit rtl8169
id|RTL_W16
c_func
(paren
id|RxMaxSize
comma
id|RxPacketMaxSize
)paren
suffix:semicolon
singleline_comment|// Set Rx Config register
id|i
op_assign
id|rtl8169_rx_config
op_or
(paren
id|RTL_R32
c_func
(paren
id|RxConfig
)paren
op_amp
id|rtl_chip_info
(braket
id|tp-&gt;chipset
)braket
dot
id|RxConfigMask
)paren
suffix:semicolon
id|RTL_W32
c_func
(paren
id|RxConfig
comma
id|i
)paren
suffix:semicolon
multiline_comment|/* Set DMA burst size and Interframe Gap Time */
id|RTL_W32
c_func
(paren
id|TxConfig
comma
(paren
id|TX_DMA_BURST
op_lshift
id|TxDMAShift
)paren
op_or
(paren
id|InterFrameGap
op_lshift
id|TxInterFrameGapShift
)paren
)paren
suffix:semicolon
id|tp-&gt;cp_cmd
op_or_assign
id|RTL_R16
c_func
(paren
id|CPlusCmd
)paren
suffix:semicolon
id|RTL_W16
c_func
(paren
id|CPlusCmd
comma
id|tp-&gt;cp_cmd
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tp-&gt;mac_version
op_eq
id|RTL_GIGA_MAC_VER_D
)paren
(brace
id|dprintk
c_func
(paren
id|KERN_INFO
id|PFX
l_string|&quot;Set MAC Reg C+CR Offset 0xE0. &quot;
l_string|&quot;Bit-3 and bit-14 MUST be 1&bslash;n&quot;
)paren
suffix:semicolon
id|tp-&gt;cp_cmd
op_or_assign
(paren
l_int|1
op_lshift
l_int|14
)paren
op_or
id|PCIMulRW
suffix:semicolon
id|RTL_W16
c_func
(paren
id|CPlusCmd
comma
id|tp-&gt;cp_cmd
)paren
suffix:semicolon
)brace
id|RTL_W32
c_func
(paren
id|TxDescStartAddrLow
comma
(paren
(paren
id|u64
)paren
id|tp-&gt;TxPhyAddr
op_amp
id|DMA_32BIT_MASK
)paren
)paren
suffix:semicolon
id|RTL_W32
c_func
(paren
id|TxDescStartAddrHigh
comma
(paren
(paren
id|u64
)paren
id|tp-&gt;TxPhyAddr
op_rshift
l_int|32
)paren
)paren
suffix:semicolon
id|RTL_W32
c_func
(paren
id|RxDescAddrLow
comma
(paren
(paren
id|u64
)paren
id|tp-&gt;RxPhyAddr
op_amp
id|DMA_32BIT_MASK
)paren
)paren
suffix:semicolon
id|RTL_W32
c_func
(paren
id|RxDescAddrHigh
comma
(paren
(paren
id|u64
)paren
id|tp-&gt;RxPhyAddr
op_rshift
l_int|32
)paren
)paren
suffix:semicolon
id|RTL_W8
c_func
(paren
id|Cfg9346
comma
id|Cfg9346_Lock
)paren
suffix:semicolon
id|udelay
c_func
(paren
l_int|10
)paren
suffix:semicolon
id|RTL_W32
c_func
(paren
id|RxMissed
comma
l_int|0
)paren
suffix:semicolon
id|rtl8169_set_rx_mode
c_func
(paren
id|dev
)paren
suffix:semicolon
multiline_comment|/* no early-rx interrupts */
id|RTL_W16
c_func
(paren
id|MultiIntr
comma
id|RTL_R16
c_func
(paren
id|MultiIntr
)paren
op_amp
l_int|0xF000
)paren
suffix:semicolon
multiline_comment|/* Enable all known interrupts by setting the interrupt mask. */
id|RTL_W16
c_func
(paren
id|IntrMask
comma
id|rtl8169_intr_mask
)paren
suffix:semicolon
id|netif_start_queue
c_func
(paren
id|dev
)paren
suffix:semicolon
)brace
DECL|function|rtl8169_make_unusable_by_asic
r_static
r_inline
r_void
id|rtl8169_make_unusable_by_asic
c_func
(paren
r_struct
id|RxDesc
op_star
id|desc
)paren
(brace
id|desc-&gt;addr
op_assign
l_int|0x0badbadbadbadbadull
suffix:semicolon
id|desc-&gt;opts1
op_and_assign
op_complement
id|cpu_to_le32
c_func
(paren
id|DescOwn
op_or
id|RsvdMask
)paren
suffix:semicolon
)brace
DECL|function|rtl8169_free_rx_skb
r_static
r_void
id|rtl8169_free_rx_skb
c_func
(paren
r_struct
id|rtl8169_private
op_star
id|tp
comma
r_struct
id|sk_buff
op_star
op_star
id|sk_buff
comma
r_struct
id|RxDesc
op_star
id|desc
)paren
(brace
r_struct
id|pci_dev
op_star
id|pdev
op_assign
id|tp-&gt;pci_dev
suffix:semicolon
id|pci_unmap_single
c_func
(paren
id|pdev
comma
id|le64_to_cpu
c_func
(paren
id|desc-&gt;addr
)paren
comma
id|tp-&gt;rx_buf_sz
comma
id|PCI_DMA_FROMDEVICE
)paren
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
op_star
id|sk_buff
)paren
suffix:semicolon
op_star
id|sk_buff
op_assign
l_int|NULL
suffix:semicolon
id|rtl8169_make_unusable_by_asic
c_func
(paren
id|desc
)paren
suffix:semicolon
)brace
DECL|function|rtl8169_return_to_asic
r_static
r_inline
r_void
id|rtl8169_return_to_asic
c_func
(paren
r_struct
id|RxDesc
op_star
id|desc
comma
r_int
id|rx_buf_sz
)paren
(brace
id|desc-&gt;opts1
op_or_assign
id|cpu_to_le32
c_func
(paren
id|DescOwn
op_plus
id|rx_buf_sz
)paren
suffix:semicolon
)brace
DECL|function|rtl8169_give_to_asic
r_static
r_inline
r_void
id|rtl8169_give_to_asic
c_func
(paren
r_struct
id|RxDesc
op_star
id|desc
comma
id|dma_addr_t
id|mapping
comma
r_int
id|rx_buf_sz
)paren
(brace
id|desc-&gt;addr
op_assign
id|cpu_to_le64
c_func
(paren
id|mapping
)paren
suffix:semicolon
id|desc-&gt;opts1
op_or_assign
id|cpu_to_le32
c_func
(paren
id|DescOwn
op_plus
id|rx_buf_sz
)paren
suffix:semicolon
)brace
DECL|function|rtl8169_alloc_rx_skb
r_static
r_int
id|rtl8169_alloc_rx_skb
c_func
(paren
r_struct
id|pci_dev
op_star
id|pdev
comma
r_struct
id|sk_buff
op_star
op_star
id|sk_buff
comma
r_struct
id|RxDesc
op_star
id|desc
comma
r_int
id|rx_buf_sz
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|dma_addr_t
id|mapping
suffix:semicolon
r_int
id|ret
op_assign
l_int|0
suffix:semicolon
id|skb
op_assign
id|dev_alloc_skb
c_func
(paren
id|rx_buf_sz
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|skb
)paren
r_goto
id|err_out
suffix:semicolon
id|skb_reserve
c_func
(paren
id|skb
comma
l_int|2
)paren
suffix:semicolon
op_star
id|sk_buff
op_assign
id|skb
suffix:semicolon
id|mapping
op_assign
id|pci_map_single
c_func
(paren
id|pdev
comma
id|skb-&gt;tail
comma
id|rx_buf_sz
comma
id|PCI_DMA_FROMDEVICE
)paren
suffix:semicolon
id|rtl8169_give_to_asic
c_func
(paren
id|desc
comma
id|mapping
comma
id|rx_buf_sz
)paren
suffix:semicolon
id|out
suffix:colon
r_return
id|ret
suffix:semicolon
id|err_out
suffix:colon
id|ret
op_assign
op_minus
id|ENOMEM
suffix:semicolon
id|rtl8169_make_unusable_by_asic
c_func
(paren
id|desc
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
DECL|function|rtl8169_rx_clear
r_static
r_void
id|rtl8169_rx_clear
c_func
(paren
r_struct
id|rtl8169_private
op_star
id|tp
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|NUM_RX_DESC
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|tp-&gt;Rx_skbuff
(braket
id|i
)braket
)paren
(brace
id|rtl8169_free_rx_skb
c_func
(paren
id|tp
comma
id|tp-&gt;Rx_skbuff
op_plus
id|i
comma
id|tp-&gt;RxDescArray
op_plus
id|i
)paren
suffix:semicolon
)brace
)brace
)brace
DECL|function|rtl8169_rx_fill
r_static
id|u32
id|rtl8169_rx_fill
c_func
(paren
r_struct
id|rtl8169_private
op_star
id|tp
comma
r_struct
id|net_device
op_star
id|dev
comma
id|u32
id|start
comma
id|u32
id|end
)paren
(brace
id|u32
id|cur
suffix:semicolon
r_for
c_loop
(paren
id|cur
op_assign
id|start
suffix:semicolon
id|end
op_minus
id|cur
OG
l_int|0
suffix:semicolon
id|cur
op_increment
)paren
(brace
r_int
id|ret
comma
id|i
op_assign
id|cur
op_mod
id|NUM_RX_DESC
suffix:semicolon
r_if
c_cond
(paren
id|tp-&gt;Rx_skbuff
(braket
id|i
)braket
)paren
r_continue
suffix:semicolon
id|ret
op_assign
id|rtl8169_alloc_rx_skb
c_func
(paren
id|tp-&gt;pci_dev
comma
id|tp-&gt;Rx_skbuff
op_plus
id|i
comma
id|tp-&gt;RxDescArray
op_plus
id|i
comma
id|tp-&gt;rx_buf_sz
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
OL
l_int|0
)paren
r_break
suffix:semicolon
)brace
r_return
id|cur
op_minus
id|start
suffix:semicolon
)brace
DECL|function|rtl8169_mark_as_last_descriptor
r_static
r_inline
r_void
id|rtl8169_mark_as_last_descriptor
c_func
(paren
r_struct
id|RxDesc
op_star
id|desc
)paren
(brace
id|desc-&gt;opts1
op_or_assign
id|cpu_to_le32
c_func
(paren
id|RingEnd
)paren
suffix:semicolon
)brace
DECL|function|rtl8169_init_ring_indexes
r_static
r_void
id|rtl8169_init_ring_indexes
c_func
(paren
r_struct
id|rtl8169_private
op_star
id|tp
)paren
(brace
id|tp-&gt;dirty_tx
op_assign
id|tp-&gt;dirty_rx
op_assign
id|tp-&gt;cur_tx
op_assign
id|tp-&gt;cur_rx
op_assign
l_int|0
suffix:semicolon
)brace
DECL|function|rtl8169_init_ring
r_static
r_int
id|rtl8169_init_ring
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|rtl8169_private
op_star
id|tp
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
id|rtl8169_init_ring_indexes
c_func
(paren
id|tp
)paren
suffix:semicolon
id|memset
c_func
(paren
id|tp-&gt;tx_skb
comma
l_int|0x0
comma
id|NUM_TX_DESC
op_star
r_sizeof
(paren
r_struct
id|ring_info
)paren
)paren
suffix:semicolon
id|memset
c_func
(paren
id|tp-&gt;Rx_skbuff
comma
l_int|0x0
comma
id|NUM_RX_DESC
op_star
r_sizeof
(paren
r_struct
id|sk_buff
op_star
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rtl8169_rx_fill
c_func
(paren
id|tp
comma
id|dev
comma
l_int|0
comma
id|NUM_RX_DESC
)paren
op_ne
id|NUM_RX_DESC
)paren
r_goto
id|err_out
suffix:semicolon
id|rtl8169_mark_as_last_descriptor
c_func
(paren
id|tp-&gt;RxDescArray
op_plus
id|NUM_RX_DESC
op_minus
l_int|1
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
id|err_out
suffix:colon
id|rtl8169_rx_clear
c_func
(paren
id|tp
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
DECL|function|rtl8169_unmap_tx_skb
r_static
r_void
id|rtl8169_unmap_tx_skb
c_func
(paren
r_struct
id|pci_dev
op_star
id|pdev
comma
r_struct
id|ring_info
op_star
id|tx_skb
comma
r_struct
id|TxDesc
op_star
id|desc
)paren
(brace
r_int
r_int
id|len
op_assign
id|tx_skb-&gt;len
suffix:semicolon
id|pci_unmap_single
c_func
(paren
id|pdev
comma
id|le64_to_cpu
c_func
(paren
id|desc-&gt;addr
)paren
comma
id|len
comma
id|PCI_DMA_TODEVICE
)paren
suffix:semicolon
id|desc-&gt;opts1
op_assign
l_int|0x00
suffix:semicolon
id|desc-&gt;opts2
op_assign
l_int|0x00
suffix:semicolon
id|desc-&gt;addr
op_assign
l_int|0x00
suffix:semicolon
id|tx_skb-&gt;len
op_assign
l_int|0
suffix:semicolon
)brace
DECL|function|rtl8169_tx_clear
r_static
r_void
id|rtl8169_tx_clear
c_func
(paren
r_struct
id|rtl8169_private
op_star
id|tp
)paren
(brace
r_int
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
id|tp-&gt;dirty_tx
suffix:semicolon
id|i
OL
id|tp-&gt;dirty_tx
op_plus
id|NUM_TX_DESC
suffix:semicolon
id|i
op_increment
)paren
(brace
r_int
r_int
id|entry
op_assign
id|i
op_mod
id|NUM_TX_DESC
suffix:semicolon
r_struct
id|ring_info
op_star
id|tx_skb
op_assign
id|tp-&gt;tx_skb
op_plus
id|entry
suffix:semicolon
r_int
r_int
id|len
op_assign
id|tx_skb-&gt;len
suffix:semicolon
r_if
c_cond
(paren
id|len
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|tx_skb-&gt;skb
suffix:semicolon
id|rtl8169_unmap_tx_skb
c_func
(paren
id|tp-&gt;pci_dev
comma
id|tx_skb
comma
id|tp-&gt;TxDescArray
op_plus
id|entry
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb
)paren
(brace
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
id|tx_skb-&gt;skb
op_assign
l_int|NULL
suffix:semicolon
)brace
id|tp-&gt;stats.tx_dropped
op_increment
suffix:semicolon
)brace
)brace
id|tp-&gt;cur_tx
op_assign
id|tp-&gt;dirty_tx
op_assign
l_int|0
suffix:semicolon
)brace
DECL|function|rtl8169_schedule_work
r_static
r_void
id|rtl8169_schedule_work
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_void
(paren
op_star
id|task
)paren
(paren
r_void
op_star
)paren
)paren
(brace
r_struct
id|rtl8169_private
op_star
id|tp
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
id|PREPARE_WORK
c_func
(paren
op_amp
id|tp-&gt;task
comma
id|task
comma
id|dev
)paren
suffix:semicolon
id|schedule_delayed_work
c_func
(paren
op_amp
id|tp-&gt;task
comma
l_int|4
)paren
suffix:semicolon
)brace
DECL|function|rtl8169_wait_for_quiescence
r_static
r_void
id|rtl8169_wait_for_quiescence
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
id|synchronize_irq
c_func
(paren
id|dev-&gt;irq
)paren
suffix:semicolon
multiline_comment|/* Wait for any pending NAPI task to complete */
id|netif_poll_disable
c_func
(paren
id|dev
)paren
suffix:semicolon
)brace
DECL|function|rtl8169_reinit_task
r_static
r_void
id|rtl8169_reinit_task
c_func
(paren
r_void
op_star
id|_data
)paren
(brace
r_struct
id|net_device
op_star
id|dev
op_assign
id|_data
suffix:semicolon
r_int
id|ret
suffix:semicolon
r_if
c_cond
(paren
id|netif_running
c_func
(paren
id|dev
)paren
)paren
(brace
id|rtl8169_wait_for_quiescence
c_func
(paren
id|dev
)paren
suffix:semicolon
id|rtl8169_close
c_func
(paren
id|dev
)paren
suffix:semicolon
)brace
id|ret
op_assign
id|rtl8169_open
c_func
(paren
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|unlikely
c_func
(paren
id|ret
OL
l_int|0
)paren
)paren
(brace
r_if
c_cond
(paren
id|net_ratelimit
c_func
(paren
)paren
)paren
(brace
id|printk
c_func
(paren
id|PFX
id|KERN_ERR
l_string|&quot;%s: reinit failure (status = %d).&quot;
l_string|&quot; Rescheduling.&bslash;n&quot;
comma
id|dev-&gt;name
comma
id|ret
)paren
suffix:semicolon
)brace
id|rtl8169_schedule_work
c_func
(paren
id|dev
comma
id|rtl8169_reinit_task
)paren
suffix:semicolon
)brace
)brace
DECL|function|rtl8169_reset_task
r_static
r_void
id|rtl8169_reset_task
c_func
(paren
r_void
op_star
id|_data
)paren
(brace
r_struct
id|net_device
op_star
id|dev
op_assign
id|_data
suffix:semicolon
r_struct
id|rtl8169_private
op_star
id|tp
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|netif_running
c_func
(paren
id|dev
)paren
)paren
r_return
suffix:semicolon
id|rtl8169_wait_for_quiescence
c_func
(paren
id|dev
)paren
suffix:semicolon
id|rtl8169_rx_interrupt
c_func
(paren
id|dev
comma
id|tp
comma
id|tp-&gt;mmio_addr
)paren
suffix:semicolon
id|rtl8169_tx_clear
c_func
(paren
id|tp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tp-&gt;dirty_rx
op_eq
id|tp-&gt;cur_rx
)paren
(brace
id|rtl8169_init_ring_indexes
c_func
(paren
id|tp
)paren
suffix:semicolon
id|rtl8169_hw_start
c_func
(paren
id|dev
)paren
suffix:semicolon
id|netif_wake_queue
c_func
(paren
id|dev
)paren
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|net_ratelimit
c_func
(paren
)paren
)paren
(brace
id|printk
c_func
(paren
id|PFX
id|KERN_EMERG
l_string|&quot;%s: Rx buffers shortage&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
)brace
id|rtl8169_schedule_work
c_func
(paren
id|dev
comma
id|rtl8169_reset_task
)paren
suffix:semicolon
)brace
)brace
DECL|function|rtl8169_tx_timeout
r_static
r_void
id|rtl8169_tx_timeout
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|rtl8169_private
op_star
id|tp
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
id|rtl8169_hw_reset
c_func
(paren
id|tp-&gt;mmio_addr
)paren
suffix:semicolon
multiline_comment|/* Let&squot;s wait a bit while any (async) irq lands on */
id|rtl8169_schedule_work
c_func
(paren
id|dev
comma
id|rtl8169_reset_task
)paren
suffix:semicolon
)brace
DECL|function|rtl8169_xmit_frags
r_static
r_int
id|rtl8169_xmit_frags
c_func
(paren
r_struct
id|rtl8169_private
op_star
id|tp
comma
r_struct
id|sk_buff
op_star
id|skb
comma
id|u32
id|opts1
)paren
(brace
r_struct
id|skb_shared_info
op_star
id|info
op_assign
id|skb_shinfo
c_func
(paren
id|skb
)paren
suffix:semicolon
r_int
r_int
id|cur_frag
comma
id|entry
suffix:semicolon
r_struct
id|TxDesc
op_star
id|txd
suffix:semicolon
id|entry
op_assign
id|tp-&gt;cur_tx
suffix:semicolon
r_for
c_loop
(paren
id|cur_frag
op_assign
l_int|0
suffix:semicolon
id|cur_frag
OL
id|info-&gt;nr_frags
suffix:semicolon
id|cur_frag
op_increment
)paren
(brace
id|skb_frag_t
op_star
id|frag
op_assign
id|info-&gt;frags
op_plus
id|cur_frag
suffix:semicolon
id|dma_addr_t
id|mapping
suffix:semicolon
id|u32
id|status
comma
id|len
suffix:semicolon
r_void
op_star
id|addr
suffix:semicolon
id|entry
op_assign
(paren
id|entry
op_plus
l_int|1
)paren
op_mod
id|NUM_TX_DESC
suffix:semicolon
id|txd
op_assign
id|tp-&gt;TxDescArray
op_plus
id|entry
suffix:semicolon
id|len
op_assign
id|frag-&gt;size
suffix:semicolon
id|addr
op_assign
(paren
(paren
r_void
op_star
)paren
id|page_address
c_func
(paren
id|frag-&gt;page
)paren
)paren
op_plus
id|frag-&gt;page_offset
suffix:semicolon
id|mapping
op_assign
id|pci_map_single
c_func
(paren
id|tp-&gt;pci_dev
comma
id|addr
comma
id|len
comma
id|PCI_DMA_TODEVICE
)paren
suffix:semicolon
multiline_comment|/* anti gcc 2.95.3 bugware (sic) */
id|status
op_assign
id|opts1
op_or
id|len
op_or
(paren
id|RingEnd
op_star
op_logical_neg
(paren
(paren
id|entry
op_plus
l_int|1
)paren
op_mod
id|NUM_TX_DESC
)paren
)paren
suffix:semicolon
id|txd-&gt;opts1
op_assign
id|cpu_to_le32
c_func
(paren
id|status
)paren
suffix:semicolon
id|txd-&gt;addr
op_assign
id|cpu_to_le64
c_func
(paren
id|mapping
)paren
suffix:semicolon
id|tp-&gt;tx_skb
(braket
id|entry
)braket
dot
id|len
op_assign
id|len
suffix:semicolon
)brace
r_if
c_cond
(paren
id|cur_frag
)paren
(brace
id|tp-&gt;tx_skb
(braket
id|entry
)braket
dot
id|skb
op_assign
id|skb
suffix:semicolon
id|txd-&gt;opts1
op_or_assign
id|cpu_to_le32
c_func
(paren
id|LastFrag
)paren
suffix:semicolon
)brace
r_return
id|cur_frag
suffix:semicolon
)brace
DECL|function|rtl8169_tso_csum
r_static
r_inline
id|u32
id|rtl8169_tso_csum
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_if
c_cond
(paren
id|dev-&gt;features
op_amp
id|NETIF_F_TSO
)paren
(brace
id|u32
id|mss
op_assign
id|skb_shinfo
c_func
(paren
id|skb
)paren
op_member_access_from_pointer
id|tso_size
suffix:semicolon
r_if
c_cond
(paren
id|mss
)paren
r_return
id|LargeSend
op_or
(paren
(paren
id|mss
op_amp
id|MSSMask
)paren
op_lshift
id|MSSShift
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|skb-&gt;ip_summed
op_eq
id|CHECKSUM_HW
)paren
(brace
r_const
r_struct
id|iphdr
op_star
id|ip
op_assign
id|skb-&gt;nh.iph
suffix:semicolon
r_if
c_cond
(paren
id|ip-&gt;protocol
op_eq
id|IPPROTO_TCP
)paren
r_return
id|IPCS
op_or
id|TCPCS
suffix:semicolon
r_else
r_if
c_cond
(paren
id|ip-&gt;protocol
op_eq
id|IPPROTO_UDP
)paren
r_return
id|IPCS
op_or
id|UDPCS
suffix:semicolon
id|WARN_ON
c_func
(paren
l_int|1
)paren
suffix:semicolon
multiline_comment|/* we need a WARN() */
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|rtl8169_start_xmit
r_static
r_int
id|rtl8169_start_xmit
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|rtl8169_private
op_star
id|tp
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
r_int
r_int
id|frags
comma
id|entry
op_assign
id|tp-&gt;cur_tx
op_mod
id|NUM_TX_DESC
suffix:semicolon
r_struct
id|TxDesc
op_star
id|txd
op_assign
id|tp-&gt;TxDescArray
op_plus
id|entry
suffix:semicolon
r_void
id|__iomem
op_star
id|ioaddr
op_assign
id|tp-&gt;mmio_addr
suffix:semicolon
id|dma_addr_t
id|mapping
suffix:semicolon
id|u32
id|status
comma
id|len
suffix:semicolon
id|u32
id|opts1
suffix:semicolon
r_int
id|ret
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|unlikely
c_func
(paren
id|TX_BUFFS_AVAIL
c_func
(paren
id|tp
)paren
OL
id|skb_shinfo
c_func
(paren
id|skb
)paren
op_member_access_from_pointer
id|nr_frags
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
id|PFX
l_string|&quot;%s: BUG! Tx Ring full when queue awake!&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
r_goto
id|err_stop
suffix:semicolon
)brace
r_if
c_cond
(paren
id|unlikely
c_func
(paren
id|le32_to_cpu
c_func
(paren
id|txd-&gt;opts1
)paren
op_amp
id|DescOwn
)paren
)paren
r_goto
id|err_stop
suffix:semicolon
id|opts1
op_assign
id|DescOwn
op_or
id|rtl8169_tso_csum
c_func
(paren
id|skb
comma
id|dev
)paren
suffix:semicolon
id|frags
op_assign
id|rtl8169_xmit_frags
c_func
(paren
id|tp
comma
id|skb
comma
id|opts1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|frags
)paren
(brace
id|len
op_assign
id|skb_headlen
c_func
(paren
id|skb
)paren
suffix:semicolon
id|opts1
op_or_assign
id|FirstFrag
suffix:semicolon
)brace
r_else
(brace
id|len
op_assign
id|skb-&gt;len
suffix:semicolon
r_if
c_cond
(paren
id|unlikely
c_func
(paren
id|len
OL
id|ETH_ZLEN
)paren
)paren
(brace
id|skb
op_assign
id|skb_padto
c_func
(paren
id|skb
comma
id|ETH_ZLEN
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|skb
)paren
r_goto
id|err_update_stats
suffix:semicolon
id|len
op_assign
id|ETH_ZLEN
suffix:semicolon
)brace
id|opts1
op_or_assign
id|FirstFrag
op_or
id|LastFrag
suffix:semicolon
id|tp-&gt;tx_skb
(braket
id|entry
)braket
dot
id|skb
op_assign
id|skb
suffix:semicolon
)brace
id|mapping
op_assign
id|pci_map_single
c_func
(paren
id|tp-&gt;pci_dev
comma
id|skb-&gt;data
comma
id|len
comma
id|PCI_DMA_TODEVICE
)paren
suffix:semicolon
id|tp-&gt;tx_skb
(braket
id|entry
)braket
dot
id|len
op_assign
id|len
suffix:semicolon
id|txd-&gt;addr
op_assign
id|cpu_to_le64
c_func
(paren
id|mapping
)paren
suffix:semicolon
id|txd-&gt;opts2
op_assign
id|cpu_to_le32
c_func
(paren
id|rtl8169_tx_vlan_tag
c_func
(paren
id|tp
comma
id|skb
)paren
)paren
suffix:semicolon
id|wmb
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/* anti gcc 2.95.3 bugware (sic) */
id|status
op_assign
id|opts1
op_or
id|len
op_or
(paren
id|RingEnd
op_star
op_logical_neg
(paren
(paren
id|entry
op_plus
l_int|1
)paren
op_mod
id|NUM_TX_DESC
)paren
)paren
suffix:semicolon
id|txd-&gt;opts1
op_assign
id|cpu_to_le32
c_func
(paren
id|status
)paren
suffix:semicolon
id|dev-&gt;trans_start
op_assign
id|jiffies
suffix:semicolon
id|tp-&gt;cur_tx
op_add_assign
id|frags
op_plus
l_int|1
suffix:semicolon
id|smp_wmb
c_func
(paren
)paren
suffix:semicolon
id|RTL_W8
c_func
(paren
id|TxPoll
comma
l_int|0x40
)paren
suffix:semicolon
singleline_comment|//set polling bit
r_if
c_cond
(paren
id|TX_BUFFS_AVAIL
c_func
(paren
id|tp
)paren
OL
id|MAX_SKB_FRAGS
)paren
(brace
id|netif_stop_queue
c_func
(paren
id|dev
)paren
suffix:semicolon
id|smp_rmb
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|TX_BUFFS_AVAIL
c_func
(paren
id|tp
)paren
op_ge
id|MAX_SKB_FRAGS
)paren
id|netif_wake_queue
c_func
(paren
id|dev
)paren
suffix:semicolon
)brace
id|out
suffix:colon
r_return
id|ret
suffix:semicolon
id|err_stop
suffix:colon
id|netif_stop_queue
c_func
(paren
id|dev
)paren
suffix:semicolon
id|ret
op_assign
l_int|1
suffix:semicolon
id|err_update_stats
suffix:colon
id|tp-&gt;stats.tx_dropped
op_increment
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
DECL|function|rtl8169_pcierr_interrupt
r_static
r_void
id|rtl8169_pcierr_interrupt
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|rtl8169_private
op_star
id|tp
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
r_struct
id|pci_dev
op_star
id|pdev
op_assign
id|tp-&gt;pci_dev
suffix:semicolon
r_void
id|__iomem
op_star
id|ioaddr
op_assign
id|tp-&gt;mmio_addr
suffix:semicolon
id|u16
id|pci_status
comma
id|pci_cmd
suffix:semicolon
id|pci_read_config_word
c_func
(paren
id|pdev
comma
id|PCI_COMMAND
comma
op_amp
id|pci_cmd
)paren
suffix:semicolon
id|pci_read_config_word
c_func
(paren
id|pdev
comma
id|PCI_STATUS
comma
op_amp
id|pci_status
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_ERR
id|PFX
l_string|&quot;%s: PCI error (cmd = 0x%04x, status = 0x%04x).&bslash;n&quot;
comma
id|dev-&gt;name
comma
id|pci_cmd
comma
id|pci_status
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * The recovery sequence below admits a very elaborated explanation:&n;&t; * - it seems to work;&n;&t; * - I did not see what else could be done.&n;&t; *&n;&t; * Feel free to adjust to your needs.&n;&t; */
id|pci_write_config_word
c_func
(paren
id|pdev
comma
id|PCI_COMMAND
comma
id|pci_cmd
op_or
id|PCI_COMMAND_SERR
op_or
id|PCI_COMMAND_PARITY
)paren
suffix:semicolon
id|pci_write_config_word
c_func
(paren
id|pdev
comma
id|PCI_STATUS
comma
id|pci_status
op_amp
(paren
id|PCI_STATUS_DETECTED_PARITY
op_or
id|PCI_STATUS_SIG_SYSTEM_ERROR
op_or
id|PCI_STATUS_REC_MASTER_ABORT
op_or
id|PCI_STATUS_REC_TARGET_ABORT
op_or
id|PCI_STATUS_SIG_TARGET_ABORT
)paren
)paren
suffix:semicolon
multiline_comment|/* The infamous DAC f*ckup only happens at boot time */
r_if
c_cond
(paren
(paren
id|tp-&gt;cp_cmd
op_amp
id|PCIDAC
)paren
op_logical_and
(paren
id|tp-&gt;dirty_rx
op_eq
id|tp-&gt;cur_rx
op_eq
l_int|0
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_INFO
id|PFX
l_string|&quot;%s: disabling PCI DAC.&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
id|tp-&gt;cp_cmd
op_and_assign
op_complement
id|PCIDAC
suffix:semicolon
id|RTL_W16
c_func
(paren
id|CPlusCmd
comma
id|tp-&gt;cp_cmd
)paren
suffix:semicolon
id|dev-&gt;features
op_and_assign
op_complement
id|NETIF_F_HIGHDMA
suffix:semicolon
id|rtl8169_schedule_work
c_func
(paren
id|dev
comma
id|rtl8169_reinit_task
)paren
suffix:semicolon
)brace
id|rtl8169_hw_reset
c_func
(paren
id|ioaddr
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|rtl8169_tx_interrupt
id|rtl8169_tx_interrupt
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|rtl8169_private
op_star
id|tp
comma
r_void
id|__iomem
op_star
id|ioaddr
)paren
(brace
r_int
r_int
id|dirty_tx
comma
id|tx_left
suffix:semicolon
m_assert
(paren
id|dev
op_ne
l_int|NULL
)paren
suffix:semicolon
m_assert
(paren
id|tp
op_ne
l_int|NULL
)paren
suffix:semicolon
m_assert
(paren
id|ioaddr
op_ne
l_int|NULL
)paren
suffix:semicolon
id|dirty_tx
op_assign
id|tp-&gt;dirty_tx
suffix:semicolon
id|smp_rmb
c_func
(paren
)paren
suffix:semicolon
id|tx_left
op_assign
id|tp-&gt;cur_tx
op_minus
id|dirty_tx
suffix:semicolon
r_while
c_loop
(paren
id|tx_left
OG
l_int|0
)paren
(brace
r_int
r_int
id|entry
op_assign
id|dirty_tx
op_mod
id|NUM_TX_DESC
suffix:semicolon
r_struct
id|ring_info
op_star
id|tx_skb
op_assign
id|tp-&gt;tx_skb
op_plus
id|entry
suffix:semicolon
id|u32
id|len
op_assign
id|tx_skb-&gt;len
suffix:semicolon
id|u32
id|status
suffix:semicolon
id|rmb
c_func
(paren
)paren
suffix:semicolon
id|status
op_assign
id|le32_to_cpu
c_func
(paren
id|tp-&gt;TxDescArray
(braket
id|entry
)braket
dot
id|opts1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|status
op_amp
id|DescOwn
)paren
r_break
suffix:semicolon
id|tp-&gt;stats.tx_bytes
op_add_assign
id|len
suffix:semicolon
id|tp-&gt;stats.tx_packets
op_increment
suffix:semicolon
id|rtl8169_unmap_tx_skb
c_func
(paren
id|tp-&gt;pci_dev
comma
id|tx_skb
comma
id|tp-&gt;TxDescArray
op_plus
id|entry
)paren
suffix:semicolon
r_if
c_cond
(paren
id|status
op_amp
id|LastFrag
)paren
(brace
id|dev_kfree_skb_irq
c_func
(paren
id|tx_skb-&gt;skb
)paren
suffix:semicolon
id|tx_skb-&gt;skb
op_assign
l_int|NULL
suffix:semicolon
)brace
id|dirty_tx
op_increment
suffix:semicolon
id|tx_left
op_decrement
suffix:semicolon
)brace
r_if
c_cond
(paren
id|tp-&gt;dirty_tx
op_ne
id|dirty_tx
)paren
(brace
id|tp-&gt;dirty_tx
op_assign
id|dirty_tx
suffix:semicolon
id|smp_wmb
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|netif_queue_stopped
c_func
(paren
id|dev
)paren
op_logical_and
(paren
id|TX_BUFFS_AVAIL
c_func
(paren
id|tp
)paren
op_ge
id|MAX_SKB_FRAGS
)paren
)paren
(brace
id|netif_wake_queue
c_func
(paren
id|dev
)paren
suffix:semicolon
)brace
)brace
)brace
DECL|function|rtl8169_rx_csum
r_static
r_inline
r_void
id|rtl8169_rx_csum
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|RxDesc
op_star
id|desc
)paren
(brace
id|u32
id|opts1
op_assign
id|desc-&gt;opts1
suffix:semicolon
id|u32
id|status
op_assign
id|opts1
op_amp
id|RxProtoMask
suffix:semicolon
r_if
c_cond
(paren
(paren
(paren
id|status
op_eq
id|RxProtoTCP
)paren
op_logical_and
op_logical_neg
(paren
id|opts1
op_amp
id|TCPFail
)paren
)paren
op_logical_or
(paren
(paren
id|status
op_eq
id|RxProtoUDP
)paren
op_logical_and
op_logical_neg
(paren
id|opts1
op_amp
id|UDPFail
)paren
)paren
op_logical_or
(paren
(paren
id|status
op_eq
id|RxProtoIP
)paren
op_logical_and
op_logical_neg
(paren
id|opts1
op_amp
id|IPFail
)paren
)paren
)paren
id|skb-&gt;ip_summed
op_assign
id|CHECKSUM_UNNECESSARY
suffix:semicolon
r_else
id|skb-&gt;ip_summed
op_assign
id|CHECKSUM_NONE
suffix:semicolon
)brace
DECL|function|rtl8169_try_rx_copy
r_static
r_inline
r_int
id|rtl8169_try_rx_copy
c_func
(paren
r_struct
id|sk_buff
op_star
op_star
id|sk_buff
comma
r_int
id|pkt_size
comma
r_struct
id|RxDesc
op_star
id|desc
comma
r_int
id|rx_buf_sz
)paren
(brace
r_int
id|ret
op_assign
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|pkt_size
OL
id|rx_copybreak
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|skb
op_assign
id|dev_alloc_skb
c_func
(paren
id|pkt_size
op_plus
l_int|2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb
)paren
(brace
id|skb_reserve
c_func
(paren
id|skb
comma
l_int|2
)paren
suffix:semicolon
id|eth_copy_and_sum
c_func
(paren
id|skb
comma
id|sk_buff
(braket
l_int|0
)braket
op_member_access_from_pointer
id|tail
comma
id|pkt_size
comma
l_int|0
)paren
suffix:semicolon
op_star
id|sk_buff
op_assign
id|skb
suffix:semicolon
id|rtl8169_return_to_asic
c_func
(paren
id|desc
comma
id|rx_buf_sz
)paren
suffix:semicolon
id|ret
op_assign
l_int|0
suffix:semicolon
)brace
)brace
r_return
id|ret
suffix:semicolon
)brace
r_static
r_int
DECL|function|rtl8169_rx_interrupt
id|rtl8169_rx_interrupt
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|rtl8169_private
op_star
id|tp
comma
r_void
id|__iomem
op_star
id|ioaddr
)paren
(brace
r_int
r_int
id|cur_rx
comma
id|rx_left
comma
id|count
suffix:semicolon
r_int
id|delta
suffix:semicolon
m_assert
(paren
id|dev
op_ne
l_int|NULL
)paren
suffix:semicolon
m_assert
(paren
id|tp
op_ne
l_int|NULL
)paren
suffix:semicolon
m_assert
(paren
id|ioaddr
op_ne
l_int|NULL
)paren
suffix:semicolon
id|cur_rx
op_assign
id|tp-&gt;cur_rx
suffix:semicolon
id|rx_left
op_assign
id|NUM_RX_DESC
op_plus
id|tp-&gt;dirty_rx
op_minus
id|cur_rx
suffix:semicolon
id|rx_left
op_assign
id|rtl8169_rx_quota
c_func
(paren
id|rx_left
comma
(paren
id|u32
)paren
id|dev-&gt;quota
)paren
suffix:semicolon
r_while
c_loop
(paren
id|rx_left
OG
l_int|0
)paren
(brace
r_int
r_int
id|entry
op_assign
id|cur_rx
op_mod
id|NUM_RX_DESC
suffix:semicolon
id|u32
id|status
suffix:semicolon
id|rmb
c_func
(paren
)paren
suffix:semicolon
id|status
op_assign
id|le32_to_cpu
c_func
(paren
id|tp-&gt;RxDescArray
(braket
id|entry
)braket
dot
id|opts1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|status
op_amp
id|DescOwn
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
id|status
op_amp
id|RxRES
)paren
(brace
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;%s: Rx ERROR!!!&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
id|tp-&gt;stats.rx_errors
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|status
op_amp
(paren
id|RxRWT
op_or
id|RxRUNT
)paren
)paren
id|tp-&gt;stats.rx_length_errors
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|status
op_amp
id|RxCRC
)paren
id|tp-&gt;stats.rx_crc_errors
op_increment
suffix:semicolon
)brace
r_else
(brace
r_struct
id|RxDesc
op_star
id|desc
op_assign
id|tp-&gt;RxDescArray
op_plus
id|entry
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|tp-&gt;Rx_skbuff
(braket
id|entry
)braket
suffix:semicolon
r_int
id|pkt_size
op_assign
(paren
id|status
op_amp
l_int|0x00001FFF
)paren
op_minus
l_int|4
suffix:semicolon
r_void
(paren
op_star
id|pci_action
)paren
(paren
r_struct
id|pci_dev
op_star
comma
id|dma_addr_t
comma
r_int
comma
r_int
)paren
op_assign
id|pci_dma_sync_single_for_device
suffix:semicolon
id|rtl8169_rx_csum
c_func
(paren
id|skb
comma
id|desc
)paren
suffix:semicolon
id|pci_dma_sync_single_for_cpu
c_func
(paren
id|tp-&gt;pci_dev
comma
id|le64_to_cpu
c_func
(paren
id|desc-&gt;addr
)paren
comma
id|tp-&gt;rx_buf_sz
comma
id|PCI_DMA_FROMDEVICE
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rtl8169_try_rx_copy
c_func
(paren
op_amp
id|skb
comma
id|pkt_size
comma
id|desc
comma
id|tp-&gt;rx_buf_sz
)paren
)paren
(brace
id|pci_action
op_assign
id|pci_unmap_single
suffix:semicolon
id|tp-&gt;Rx_skbuff
(braket
id|entry
)braket
op_assign
l_int|NULL
suffix:semicolon
)brace
id|pci_action
c_func
(paren
id|tp-&gt;pci_dev
comma
id|le64_to_cpu
c_func
(paren
id|desc-&gt;addr
)paren
comma
id|tp-&gt;rx_buf_sz
comma
id|PCI_DMA_FROMDEVICE
)paren
suffix:semicolon
id|skb-&gt;dev
op_assign
id|dev
suffix:semicolon
id|skb_put
c_func
(paren
id|skb
comma
id|pkt_size
)paren
suffix:semicolon
id|skb-&gt;protocol
op_assign
id|eth_type_trans
c_func
(paren
id|skb
comma
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rtl8169_rx_vlan_skb
c_func
(paren
id|tp
comma
id|desc
comma
id|skb
)paren
OL
l_int|0
)paren
id|rtl8169_rx_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
id|dev-&gt;last_rx
op_assign
id|jiffies
suffix:semicolon
id|tp-&gt;stats.rx_bytes
op_add_assign
id|pkt_size
suffix:semicolon
id|tp-&gt;stats.rx_packets
op_increment
suffix:semicolon
)brace
id|cur_rx
op_increment
suffix:semicolon
id|rx_left
op_decrement
suffix:semicolon
)brace
id|count
op_assign
id|cur_rx
op_minus
id|tp-&gt;cur_rx
suffix:semicolon
id|tp-&gt;cur_rx
op_assign
id|cur_rx
suffix:semicolon
id|delta
op_assign
id|rtl8169_rx_fill
c_func
(paren
id|tp
comma
id|dev
comma
id|tp-&gt;dirty_rx
comma
id|tp-&gt;cur_rx
)paren
suffix:semicolon
r_if
c_cond
(paren
id|delta
OL
l_int|0
)paren
(brace
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;%s: no Rx buffer allocated&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
id|delta
op_assign
l_int|0
suffix:semicolon
)brace
id|tp-&gt;dirty_rx
op_add_assign
id|delta
suffix:semicolon
multiline_comment|/*&n;&t; * FIXME: until there is periodic timer to try and refill the ring,&n;&t; * a temporary shortage may definitely kill the Rx process.&n;&t; * - disable the asic to try and avoid an overflow and kick it again&n;&t; *   after refill ?&n;&t; * - how do others driver handle this condition (Uh oh...).&n;&t; */
r_if
c_cond
(paren
id|tp-&gt;dirty_rx
op_plus
id|NUM_RX_DESC
op_eq
id|tp-&gt;cur_rx
)paren
id|printk
c_func
(paren
id|KERN_EMERG
l_string|&quot;%s: Rx buffers exhausted&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
multiline_comment|/* The interrupt handler does all of the Rx thread work and cleans up after the Tx thread. */
r_static
id|irqreturn_t
DECL|function|rtl8169_interrupt
id|rtl8169_interrupt
c_func
(paren
r_int
id|irq
comma
r_void
op_star
id|dev_instance
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
r_struct
id|net_device
op_star
id|dev
op_assign
(paren
r_struct
id|net_device
op_star
)paren
id|dev_instance
suffix:semicolon
r_struct
id|rtl8169_private
op_star
id|tp
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
r_int
id|boguscnt
op_assign
id|max_interrupt_work
suffix:semicolon
r_void
id|__iomem
op_star
id|ioaddr
op_assign
id|tp-&gt;mmio_addr
suffix:semicolon
r_int
id|status
op_assign
l_int|0
suffix:semicolon
r_int
id|handled
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|unlikely
c_func
(paren
op_logical_neg
id|netif_running
c_func
(paren
id|dev
)paren
)paren
)paren
r_goto
id|out
suffix:semicolon
r_do
(brace
id|status
op_assign
id|RTL_R16
c_func
(paren
id|IntrStatus
)paren
suffix:semicolon
multiline_comment|/* hotplug/major error/no more work/shared irq */
r_if
c_cond
(paren
(paren
id|status
op_eq
l_int|0xFFFF
)paren
op_logical_or
op_logical_neg
id|status
)paren
r_break
suffix:semicolon
id|handled
op_assign
l_int|1
suffix:semicolon
id|status
op_and_assign
id|tp-&gt;intr_mask
suffix:semicolon
id|RTL_W16
c_func
(paren
id|IntrStatus
comma
(paren
id|status
op_amp
id|RxFIFOOver
)paren
ques
c_cond
(paren
id|status
op_or
id|RxOverflow
)paren
suffix:colon
id|status
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|status
op_amp
id|rtl8169_intr_mask
)paren
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
id|unlikely
c_func
(paren
id|status
op_amp
id|SYSErr
)paren
)paren
(brace
id|rtl8169_pcierr_interrupt
c_func
(paren
id|dev
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|status
op_amp
id|LinkChg
)paren
id|rtl8169_check_link_status
c_func
(paren
id|dev
comma
id|tp
comma
id|ioaddr
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_R8169_NAPI
id|RTL_W16
c_func
(paren
id|IntrMask
comma
id|rtl8169_intr_mask
op_amp
op_complement
id|rtl8169_napi_event
)paren
suffix:semicolon
id|tp-&gt;intr_mask
op_assign
op_complement
id|rtl8169_napi_event
suffix:semicolon
r_if
c_cond
(paren
id|likely
c_func
(paren
id|netif_rx_schedule_prep
c_func
(paren
id|dev
)paren
)paren
)paren
id|__netif_rx_schedule
c_func
(paren
id|dev
)paren
suffix:semicolon
r_else
(brace
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;%s: interrupt %04x taken in poll&bslash;n&quot;
comma
id|dev-&gt;name
comma
id|status
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
macro_line|#else
singleline_comment|// Rx interrupt 
r_if
c_cond
(paren
id|status
op_amp
(paren
id|RxOK
op_or
id|RxOverflow
op_or
id|RxFIFOOver
)paren
)paren
(brace
id|rtl8169_rx_interrupt
c_func
(paren
id|dev
comma
id|tp
comma
id|ioaddr
)paren
suffix:semicolon
)brace
singleline_comment|// Tx interrupt
r_if
c_cond
(paren
id|status
op_amp
(paren
id|TxOK
op_or
id|TxErr
)paren
)paren
id|rtl8169_tx_interrupt
c_func
(paren
id|dev
comma
id|tp
comma
id|ioaddr
)paren
suffix:semicolon
macro_line|#endif
id|boguscnt
op_decrement
suffix:semicolon
)brace
r_while
c_loop
(paren
id|boguscnt
OG
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|boguscnt
op_le
l_int|0
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;%s: Too much work at interrupt!&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
multiline_comment|/* Clear all interrupt sources. */
id|RTL_W16
c_func
(paren
id|IntrStatus
comma
l_int|0xffff
)paren
suffix:semicolon
)brace
id|out
suffix:colon
r_return
id|IRQ_RETVAL
c_func
(paren
id|handled
)paren
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_R8169_NAPI
DECL|function|rtl8169_poll
r_static
r_int
id|rtl8169_poll
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_int
op_star
id|budget
)paren
(brace
r_int
r_int
id|work_done
comma
id|work_to_do
op_assign
id|min
c_func
(paren
op_star
id|budget
comma
id|dev-&gt;quota
)paren
suffix:semicolon
r_struct
id|rtl8169_private
op_star
id|tp
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
r_void
id|__iomem
op_star
id|ioaddr
op_assign
id|tp-&gt;mmio_addr
suffix:semicolon
id|work_done
op_assign
id|rtl8169_rx_interrupt
c_func
(paren
id|dev
comma
id|tp
comma
id|ioaddr
)paren
suffix:semicolon
id|rtl8169_tx_interrupt
c_func
(paren
id|dev
comma
id|tp
comma
id|ioaddr
)paren
suffix:semicolon
op_star
id|budget
op_sub_assign
id|work_done
suffix:semicolon
id|dev-&gt;quota
op_sub_assign
id|work_done
suffix:semicolon
r_if
c_cond
(paren
(paren
id|work_done
OL
id|work_to_do
)paren
op_logical_or
op_logical_neg
id|netif_running
c_func
(paren
id|dev
)paren
)paren
(brace
id|netif_rx_complete
c_func
(paren
id|dev
)paren
suffix:semicolon
id|tp-&gt;intr_mask
op_assign
l_int|0xffff
suffix:semicolon
multiline_comment|/*&n;&t;&t; * 20040426: the barrier is not strictly required but the&n;&t;&t; * behavior of the irq handler could be less predictable&n;&t;&t; * without it. Btw, the lack of flush for the posted pci&n;&t;&t; * write is safe - FR&n;&t;&t; */
id|smp_wmb
c_func
(paren
)paren
suffix:semicolon
id|RTL_W16
c_func
(paren
id|IntrMask
comma
id|rtl8169_intr_mask
)paren
suffix:semicolon
)brace
r_return
(paren
id|work_done
op_ge
id|work_to_do
)paren
suffix:semicolon
)brace
macro_line|#endif
r_static
r_int
DECL|function|rtl8169_close
id|rtl8169_close
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|rtl8169_private
op_star
id|tp
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
r_struct
id|pci_dev
op_star
id|pdev
op_assign
id|tp-&gt;pci_dev
suffix:semicolon
r_void
id|__iomem
op_star
id|ioaddr
op_assign
id|tp-&gt;mmio_addr
suffix:semicolon
id|netif_stop_queue
c_func
(paren
id|dev
)paren
suffix:semicolon
id|flush_scheduled_work
c_func
(paren
)paren
suffix:semicolon
id|rtl8169_delete_timer
c_func
(paren
id|dev
)paren
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|tp-&gt;lock
)paren
suffix:semicolon
multiline_comment|/* Stop the chip&squot;s Tx and Rx DMA processes. */
id|RTL_W8
c_func
(paren
id|ChipCmd
comma
l_int|0x00
)paren
suffix:semicolon
multiline_comment|/* Disable interrupts by clearing the interrupt mask. */
id|RTL_W16
c_func
(paren
id|IntrMask
comma
l_int|0x0000
)paren
suffix:semicolon
multiline_comment|/* Update the error counts. */
id|tp-&gt;stats.rx_missed_errors
op_add_assign
id|RTL_R32
c_func
(paren
id|RxMissed
)paren
suffix:semicolon
id|RTL_W32
c_func
(paren
id|RxMissed
comma
l_int|0
)paren
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|tp-&gt;lock
)paren
suffix:semicolon
id|free_irq
c_func
(paren
id|dev-&gt;irq
comma
id|dev
)paren
suffix:semicolon
id|netif_poll_disable
c_func
(paren
id|dev
)paren
suffix:semicolon
id|rtl8169_tx_clear
c_func
(paren
id|tp
)paren
suffix:semicolon
id|rtl8169_rx_clear
c_func
(paren
id|tp
)paren
suffix:semicolon
id|pci_free_consistent
c_func
(paren
id|pdev
comma
id|R8169_RX_RING_BYTES
comma
id|tp-&gt;RxDescArray
comma
id|tp-&gt;RxPhyAddr
)paren
suffix:semicolon
id|pci_free_consistent
c_func
(paren
id|pdev
comma
id|R8169_TX_RING_BYTES
comma
id|tp-&gt;TxDescArray
comma
id|tp-&gt;TxPhyAddr
)paren
suffix:semicolon
id|tp-&gt;TxDescArray
op_assign
l_int|NULL
suffix:semicolon
id|tp-&gt;RxDescArray
op_assign
l_int|NULL
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_void
DECL|function|rtl8169_set_rx_mode
id|rtl8169_set_rx_mode
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|rtl8169_private
op_star
id|tp
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
r_void
id|__iomem
op_star
id|ioaddr
op_assign
id|tp-&gt;mmio_addr
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|u32
id|mc_filter
(braket
l_int|2
)braket
suffix:semicolon
multiline_comment|/* Multicast hash filter */
r_int
id|i
comma
id|rx_mode
suffix:semicolon
id|u32
id|tmp
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|dev-&gt;flags
op_amp
id|IFF_PROMISC
)paren
(brace
multiline_comment|/* Unconditionally log net taps. */
id|printk
c_func
(paren
id|KERN_NOTICE
l_string|&quot;%s: Promiscuous mode enabled.&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
id|rx_mode
op_assign
id|AcceptBroadcast
op_or
id|AcceptMulticast
op_or
id|AcceptMyPhys
op_or
id|AcceptAllPhys
suffix:semicolon
id|mc_filter
(braket
l_int|1
)braket
op_assign
id|mc_filter
(braket
l_int|0
)braket
op_assign
l_int|0xffffffff
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
(paren
id|dev-&gt;mc_count
OG
id|multicast_filter_limit
)paren
op_logical_or
(paren
id|dev-&gt;flags
op_amp
id|IFF_ALLMULTI
)paren
)paren
(brace
multiline_comment|/* Too many to filter perfectly -- accept all multicasts. */
id|rx_mode
op_assign
id|AcceptBroadcast
op_or
id|AcceptMulticast
op_or
id|AcceptMyPhys
suffix:semicolon
id|mc_filter
(braket
l_int|1
)braket
op_assign
id|mc_filter
(braket
l_int|0
)braket
op_assign
l_int|0xffffffff
suffix:semicolon
)brace
r_else
(brace
r_struct
id|dev_mc_list
op_star
id|mclist
suffix:semicolon
id|rx_mode
op_assign
id|AcceptBroadcast
op_or
id|AcceptMyPhys
suffix:semicolon
id|mc_filter
(braket
l_int|1
)braket
op_assign
id|mc_filter
(braket
l_int|0
)braket
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
comma
id|mclist
op_assign
id|dev-&gt;mc_list
suffix:semicolon
id|mclist
op_logical_and
id|i
OL
id|dev-&gt;mc_count
suffix:semicolon
id|i
op_increment
comma
id|mclist
op_assign
id|mclist-&gt;next
)paren
(brace
r_int
id|bit_nr
op_assign
id|ether_crc
c_func
(paren
id|ETH_ALEN
comma
id|mclist-&gt;dmi_addr
)paren
op_rshift
l_int|26
suffix:semicolon
id|mc_filter
(braket
id|bit_nr
op_rshift
l_int|5
)braket
op_or_assign
l_int|1
op_lshift
(paren
id|bit_nr
op_amp
l_int|31
)paren
suffix:semicolon
id|rx_mode
op_or_assign
id|AcceptMulticast
suffix:semicolon
)brace
)brace
id|spin_lock_irqsave
c_func
(paren
op_amp
id|tp-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|tmp
op_assign
id|rtl8169_rx_config
op_or
id|rx_mode
op_or
(paren
id|RTL_R32
c_func
(paren
id|RxConfig
)paren
op_amp
id|rtl_chip_info
(braket
id|tp-&gt;chipset
)braket
dot
id|RxConfigMask
)paren
suffix:semicolon
id|RTL_W32
c_func
(paren
id|RxConfig
comma
id|tmp
)paren
suffix:semicolon
id|RTL_W32
c_func
(paren
id|MAR0
op_plus
l_int|0
comma
id|mc_filter
(braket
l_int|0
)braket
)paren
suffix:semicolon
id|RTL_W32
c_func
(paren
id|MAR0
op_plus
l_int|4
comma
id|mc_filter
(braket
l_int|1
)braket
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|tp-&gt;lock
comma
id|flags
)paren
suffix:semicolon
)brace
multiline_comment|/**&n; *  rtl8169_get_stats - Get rtl8169 read/write statistics&n; *  @dev: The Ethernet Device to get statistics for&n; *&n; *  Get TX/RX statistics for rtl8169&n; */
DECL|function|rtl8169_get_stats
r_static
r_struct
id|net_device_stats
op_star
id|rtl8169_get_stats
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|rtl8169_private
op_star
id|tp
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
r_void
id|__iomem
op_star
id|ioaddr
op_assign
id|tp-&gt;mmio_addr
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_if
c_cond
(paren
id|netif_running
c_func
(paren
id|dev
)paren
)paren
(brace
id|spin_lock_irqsave
c_func
(paren
op_amp
id|tp-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|tp-&gt;stats.rx_missed_errors
op_add_assign
id|RTL_R32
c_func
(paren
id|RxMissed
)paren
suffix:semicolon
id|RTL_W32
c_func
(paren
id|RxMissed
comma
l_int|0
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|tp-&gt;lock
comma
id|flags
)paren
suffix:semicolon
)brace
r_return
op_amp
id|tp-&gt;stats
suffix:semicolon
)brace
DECL|variable|rtl8169_pci_driver
r_static
r_struct
id|pci_driver
id|rtl8169_pci_driver
op_assign
(brace
dot
id|name
op_assign
id|MODULENAME
comma
dot
id|id_table
op_assign
id|rtl8169_pci_tbl
comma
dot
id|probe
op_assign
id|rtl8169_init_one
comma
dot
id|remove
op_assign
id|__devexit_p
c_func
(paren
id|rtl8169_remove_one
)paren
comma
macro_line|#ifdef CONFIG_PM
dot
id|suspend
op_assign
id|rtl8169_suspend
comma
dot
id|resume
op_assign
id|rtl8169_resume
comma
macro_line|#endif
)brace
suffix:semicolon
r_static
r_int
id|__init
DECL|function|rtl8169_init_module
id|rtl8169_init_module
c_func
(paren
r_void
)paren
(brace
r_return
id|pci_module_init
c_func
(paren
op_amp
id|rtl8169_pci_driver
)paren
suffix:semicolon
)brace
r_static
r_void
id|__exit
DECL|function|rtl8169_cleanup_module
id|rtl8169_cleanup_module
c_func
(paren
r_void
)paren
(brace
id|pci_unregister_driver
c_func
(paren
op_amp
id|rtl8169_pci_driver
)paren
suffix:semicolon
)brace
DECL|variable|rtl8169_init_module
id|module_init
c_func
(paren
id|rtl8169_init_module
)paren
suffix:semicolon
DECL|variable|rtl8169_cleanup_module
id|module_exit
c_func
(paren
id|rtl8169_cleanup_module
)paren
suffix:semicolon
eof
