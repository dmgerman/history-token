multiline_comment|/*******************************************************************************&n;&n;  &n;  Copyright(c) 1999 - 2003 Intel Corporation. All rights reserved.&n;  &n;  This program is free software; you can redistribute it and/or modify it &n;  under the terms of the GNU General Public License as published by the Free &n;  Software Foundation; either version 2 of the License, or (at your option) &n;  any later version.&n;  &n;  This program is distributed in the hope that it will be useful, but WITHOUT &n;  ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or &n;  FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for &n;  more details.&n;  &n;  You should have received a copy of the GNU General Public License along with&n;  this program; if not, write to the Free Software Foundation, Inc., 59 &n;  Temple Place - Suite 330, Boston, MA  02111-1307, USA.&n;  &n;  The full GNU General Public License is included in this distribution in the&n;  file called LICENSE.&n;  &n;  Contact Information:&n;  Linux NICS &lt;linux.nics@intel.com&gt;&n;  Intel Corporation, 5200 N.E. Elam Young Parkway, Hillsboro, OR 97124-6497&n;&n;*******************************************************************************/
multiline_comment|/* ethtool support for e1000 */
macro_line|#include &quot;e1000.h&quot;
macro_line|#include &lt;asm/uaccess.h&gt;
r_extern
r_char
id|e1000_driver_name
(braket
)braket
suffix:semicolon
r_extern
r_char
id|e1000_driver_version
(braket
)braket
suffix:semicolon
r_extern
r_int
id|e1000_up
c_func
(paren
r_struct
id|e1000_adapter
op_star
id|adapter
)paren
suffix:semicolon
r_extern
r_void
id|e1000_down
c_func
(paren
r_struct
id|e1000_adapter
op_star
id|adapter
)paren
suffix:semicolon
r_extern
r_void
id|e1000_reset
c_func
(paren
r_struct
id|e1000_adapter
op_star
id|adapter
)paren
suffix:semicolon
r_extern
r_int
id|e1000_set_spd_dplx
c_func
(paren
r_struct
id|e1000_adapter
op_star
id|adapter
comma
r_uint16
id|spddplx
)paren
suffix:semicolon
DECL|struct|e1000_stats
r_struct
id|e1000_stats
(brace
DECL|member|stat_string
r_char
id|stat_string
(braket
id|ETH_GSTRING_LEN
)braket
suffix:semicolon
DECL|member|sizeof_stat
r_int
id|sizeof_stat
suffix:semicolon
DECL|member|stat_offset
r_int
id|stat_offset
suffix:semicolon
)brace
suffix:semicolon
DECL|macro|E1000_STAT
mdefine_line|#define E1000_STAT(m) sizeof(((struct e1000_adapter *)0)-&gt;m), &bslash;&n;&t;&t;      offsetof(struct e1000_adapter, m)
DECL|variable|e1000_gstrings_stats
r_static
r_struct
id|e1000_stats
id|e1000_gstrings_stats
(braket
)braket
op_assign
(brace
(brace
l_string|&quot;rx_packets&quot;
comma
id|E1000_STAT
c_func
(paren
id|net_stats.rx_packets
)paren
)brace
comma
(brace
l_string|&quot;tx_packets&quot;
comma
id|E1000_STAT
c_func
(paren
id|net_stats.tx_packets
)paren
)brace
comma
(brace
l_string|&quot;rx_bytes&quot;
comma
id|E1000_STAT
c_func
(paren
id|net_stats.rx_bytes
)paren
)brace
comma
(brace
l_string|&quot;tx_bytes&quot;
comma
id|E1000_STAT
c_func
(paren
id|net_stats.tx_bytes
)paren
)brace
comma
(brace
l_string|&quot;rx_errors&quot;
comma
id|E1000_STAT
c_func
(paren
id|net_stats.rx_errors
)paren
)brace
comma
(brace
l_string|&quot;tx_errors&quot;
comma
id|E1000_STAT
c_func
(paren
id|net_stats.tx_errors
)paren
)brace
comma
(brace
l_string|&quot;rx_dropped&quot;
comma
id|E1000_STAT
c_func
(paren
id|net_stats.rx_dropped
)paren
)brace
comma
(brace
l_string|&quot;tx_dropped&quot;
comma
id|E1000_STAT
c_func
(paren
id|net_stats.tx_dropped
)paren
)brace
comma
(brace
l_string|&quot;multicast&quot;
comma
id|E1000_STAT
c_func
(paren
id|net_stats.multicast
)paren
)brace
comma
(brace
l_string|&quot;collisions&quot;
comma
id|E1000_STAT
c_func
(paren
id|net_stats.collisions
)paren
)brace
comma
(brace
l_string|&quot;rx_length_errors&quot;
comma
id|E1000_STAT
c_func
(paren
id|net_stats.rx_length_errors
)paren
)brace
comma
(brace
l_string|&quot;rx_over_errors&quot;
comma
id|E1000_STAT
c_func
(paren
id|net_stats.rx_over_errors
)paren
)brace
comma
(brace
l_string|&quot;rx_crc_errors&quot;
comma
id|E1000_STAT
c_func
(paren
id|net_stats.rx_crc_errors
)paren
)brace
comma
(brace
l_string|&quot;rx_frame_errors&quot;
comma
id|E1000_STAT
c_func
(paren
id|net_stats.rx_frame_errors
)paren
)brace
comma
(brace
l_string|&quot;rx_fifo_errors&quot;
comma
id|E1000_STAT
c_func
(paren
id|net_stats.rx_fifo_errors
)paren
)brace
comma
(brace
l_string|&quot;rx_missed_errors&quot;
comma
id|E1000_STAT
c_func
(paren
id|net_stats.rx_missed_errors
)paren
)brace
comma
(brace
l_string|&quot;tx_aborted_errors&quot;
comma
id|E1000_STAT
c_func
(paren
id|net_stats.tx_aborted_errors
)paren
)brace
comma
(brace
l_string|&quot;tx_carrier_errors&quot;
comma
id|E1000_STAT
c_func
(paren
id|net_stats.tx_carrier_errors
)paren
)brace
comma
(brace
l_string|&quot;tx_fifo_errors&quot;
comma
id|E1000_STAT
c_func
(paren
id|net_stats.tx_fifo_errors
)paren
)brace
comma
(brace
l_string|&quot;tx_heartbeat_errors&quot;
comma
id|E1000_STAT
c_func
(paren
id|net_stats.tx_heartbeat_errors
)paren
)brace
comma
(brace
l_string|&quot;tx_window_errors&quot;
comma
id|E1000_STAT
c_func
(paren
id|net_stats.tx_window_errors
)paren
)brace
comma
(brace
l_string|&quot;tx_abort_late_coll&quot;
comma
id|E1000_STAT
c_func
(paren
id|stats.latecol
)paren
)brace
comma
(brace
l_string|&quot;tx_deferred_ok&quot;
comma
id|E1000_STAT
c_func
(paren
id|stats.dc
)paren
)brace
comma
(brace
l_string|&quot;tx_single_coll_ok&quot;
comma
id|E1000_STAT
c_func
(paren
id|stats.scc
)paren
)brace
comma
(brace
l_string|&quot;tx_multi_coll_ok&quot;
comma
id|E1000_STAT
c_func
(paren
id|stats.mcc
)paren
)brace
comma
(brace
l_string|&quot;rx_long_length_errors&quot;
comma
id|E1000_STAT
c_func
(paren
id|stats.roc
)paren
)brace
comma
(brace
l_string|&quot;rx_short_length_errors&quot;
comma
id|E1000_STAT
c_func
(paren
id|stats.ruc
)paren
)brace
comma
(brace
l_string|&quot;rx_align_errors&quot;
comma
id|E1000_STAT
c_func
(paren
id|stats.algnerrc
)paren
)brace
comma
(brace
l_string|&quot;tx_tcp_seg_good&quot;
comma
id|E1000_STAT
c_func
(paren
id|stats.tsctc
)paren
)brace
comma
(brace
l_string|&quot;tx_tcp_seg_failed&quot;
comma
id|E1000_STAT
c_func
(paren
id|stats.tsctfc
)paren
)brace
comma
(brace
l_string|&quot;rx_flow_control_xon&quot;
comma
id|E1000_STAT
c_func
(paren
id|stats.xonrxc
)paren
)brace
comma
(brace
l_string|&quot;rx_flow_control_xoff&quot;
comma
id|E1000_STAT
c_func
(paren
id|stats.xoffrxc
)paren
)brace
comma
(brace
l_string|&quot;tx_flow_control_xon&quot;
comma
id|E1000_STAT
c_func
(paren
id|stats.xontxc
)paren
)brace
comma
(brace
l_string|&quot;tx_flow_control_xoff&quot;
comma
id|E1000_STAT
c_func
(paren
id|stats.xofftxc
)paren
)brace
comma
(brace
l_string|&quot;rx_csum_offload_good&quot;
comma
id|E1000_STAT
c_func
(paren
id|hw_csum_good
)paren
)brace
comma
(brace
l_string|&quot;rx_csum_offload_errors&quot;
comma
id|E1000_STAT
c_func
(paren
id|hw_csum_err
)paren
)brace
)brace
suffix:semicolon
DECL|macro|E1000_STATS_LEN
mdefine_line|#define E1000_STATS_LEN&t;&bslash;&n;&t;sizeof(e1000_gstrings_stats) / sizeof(struct e1000_stats)
DECL|variable|e1000_gstrings_test
r_static
r_char
id|e1000_gstrings_test
(braket
)braket
(braket
id|ETH_GSTRING_LEN
)braket
op_assign
(brace
l_string|&quot;Register test  (offline)&quot;
comma
l_string|&quot;Eeprom test    (offline)&quot;
comma
l_string|&quot;Interrupt test (offline)&quot;
comma
l_string|&quot;Loopback test  (offline)&quot;
comma
l_string|&quot;Link test   (on/offline)&quot;
)brace
suffix:semicolon
DECL|macro|E1000_TEST_LEN
mdefine_line|#define E1000_TEST_LEN sizeof(e1000_gstrings_test) / ETH_GSTRING_LEN
r_static
r_void
DECL|function|e1000_ethtool_gset
id|e1000_ethtool_gset
c_func
(paren
r_struct
id|e1000_adapter
op_star
id|adapter
comma
r_struct
id|ethtool_cmd
op_star
id|ecmd
)paren
(brace
r_struct
id|e1000_hw
op_star
id|hw
op_assign
op_amp
id|adapter-&gt;hw
suffix:semicolon
r_if
c_cond
(paren
id|hw-&gt;media_type
op_eq
id|e1000_media_type_copper
)paren
(brace
id|ecmd-&gt;supported
op_assign
(paren
id|SUPPORTED_10baseT_Half
op_or
id|SUPPORTED_10baseT_Full
op_or
id|SUPPORTED_100baseT_Half
op_or
id|SUPPORTED_100baseT_Full
op_or
id|SUPPORTED_1000baseT_Full
op_or
id|SUPPORTED_Autoneg
op_or
id|SUPPORTED_TP
)paren
suffix:semicolon
id|ecmd-&gt;advertising
op_assign
id|ADVERTISED_TP
suffix:semicolon
r_if
c_cond
(paren
id|hw-&gt;autoneg
op_eq
l_int|1
)paren
(brace
id|ecmd-&gt;advertising
op_or_assign
id|ADVERTISED_Autoneg
suffix:semicolon
multiline_comment|/* the e1000 autoneg seems to match ethtool nicely */
id|ecmd-&gt;advertising
op_or_assign
id|hw-&gt;autoneg_advertised
suffix:semicolon
)brace
id|ecmd-&gt;port
op_assign
id|PORT_TP
suffix:semicolon
id|ecmd-&gt;phy_address
op_assign
id|hw-&gt;phy_addr
suffix:semicolon
r_if
c_cond
(paren
id|hw-&gt;mac_type
op_eq
id|e1000_82543
)paren
(brace
id|ecmd-&gt;transceiver
op_assign
id|XCVR_EXTERNAL
suffix:semicolon
)brace
r_else
id|ecmd-&gt;transceiver
op_assign
id|XCVR_INTERNAL
suffix:semicolon
)brace
r_else
(brace
id|ecmd-&gt;supported
op_assign
(paren
id|SUPPORTED_1000baseT_Full
op_or
id|SUPPORTED_FIBRE
op_or
id|SUPPORTED_Autoneg
)paren
suffix:semicolon
id|ecmd-&gt;advertising
op_assign
(paren
id|SUPPORTED_1000baseT_Full
op_or
id|SUPPORTED_FIBRE
op_or
id|SUPPORTED_Autoneg
)paren
suffix:semicolon
id|ecmd-&gt;port
op_assign
id|PORT_FIBRE
suffix:semicolon
r_if
c_cond
(paren
id|hw-&gt;mac_type
op_ge
id|e1000_82545
)paren
(brace
id|ecmd-&gt;transceiver
op_assign
id|XCVR_INTERNAL
suffix:semicolon
)brace
r_else
id|ecmd-&gt;transceiver
op_assign
id|XCVR_EXTERNAL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|netif_carrier_ok
c_func
(paren
id|adapter-&gt;netdev
)paren
)paren
(brace
id|e1000_get_speed_and_duplex
c_func
(paren
id|hw
comma
op_amp
id|adapter-&gt;link_speed
comma
op_amp
id|adapter-&gt;link_duplex
)paren
suffix:semicolon
id|ecmd-&gt;speed
op_assign
id|adapter-&gt;link_speed
suffix:semicolon
multiline_comment|/* unfortunatly FULL_DUPLEX != DUPLEX_FULL&n;&t;&t; *          and HALF_DUPLEX != DUPLEX_HALF */
r_if
c_cond
(paren
id|adapter-&gt;link_duplex
op_eq
id|FULL_DUPLEX
)paren
(brace
id|ecmd-&gt;duplex
op_assign
id|DUPLEX_FULL
suffix:semicolon
)brace
r_else
id|ecmd-&gt;duplex
op_assign
id|DUPLEX_HALF
suffix:semicolon
)brace
r_else
(brace
id|ecmd-&gt;speed
op_assign
op_minus
l_int|1
suffix:semicolon
id|ecmd-&gt;duplex
op_assign
op_minus
l_int|1
suffix:semicolon
)brace
id|ecmd-&gt;autoneg
op_assign
(paren
id|hw-&gt;autoneg
ques
c_cond
id|AUTONEG_ENABLE
suffix:colon
id|AUTONEG_DISABLE
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|e1000_ethtool_sset
id|e1000_ethtool_sset
c_func
(paren
r_struct
id|e1000_adapter
op_star
id|adapter
comma
r_struct
id|ethtool_cmd
op_star
id|ecmd
)paren
(brace
r_struct
id|e1000_hw
op_star
id|hw
op_assign
op_amp
id|adapter-&gt;hw
suffix:semicolon
r_if
c_cond
(paren
id|ecmd-&gt;autoneg
op_eq
id|AUTONEG_ENABLE
)paren
(brace
id|hw-&gt;autoneg
op_assign
l_int|1
suffix:semicolon
id|hw-&gt;autoneg_advertised
op_assign
l_int|0x002F
suffix:semicolon
id|ecmd-&gt;advertising
op_assign
l_int|0x002F
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|e1000_set_spd_dplx
c_func
(paren
id|adapter
comma
id|ecmd-&gt;speed
op_plus
id|ecmd-&gt;duplex
)paren
)paren
(brace
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
multiline_comment|/* reset the link */
r_if
c_cond
(paren
id|netif_running
c_func
(paren
id|adapter-&gt;netdev
)paren
)paren
(brace
id|e1000_down
c_func
(paren
id|adapter
)paren
suffix:semicolon
id|e1000_up
c_func
(paren
id|adapter
)paren
suffix:semicolon
)brace
r_else
id|e1000_reset
c_func
(paren
id|adapter
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_void
DECL|function|e1000_ethtool_gdrvinfo
id|e1000_ethtool_gdrvinfo
c_func
(paren
r_struct
id|e1000_adapter
op_star
id|adapter
comma
r_struct
id|ethtool_drvinfo
op_star
id|drvinfo
)paren
(brace
id|strncpy
c_func
(paren
id|drvinfo-&gt;driver
comma
id|e1000_driver_name
comma
l_int|32
)paren
suffix:semicolon
id|strncpy
c_func
(paren
id|drvinfo-&gt;version
comma
id|e1000_driver_version
comma
l_int|32
)paren
suffix:semicolon
id|strncpy
c_func
(paren
id|drvinfo-&gt;fw_version
comma
l_string|&quot;N/A&quot;
comma
l_int|32
)paren
suffix:semicolon
id|strncpy
c_func
(paren
id|drvinfo-&gt;bus_info
comma
id|adapter-&gt;pdev-&gt;slot_name
comma
l_int|32
)paren
suffix:semicolon
id|drvinfo-&gt;n_stats
op_assign
id|E1000_STATS_LEN
suffix:semicolon
id|drvinfo-&gt;testinfo_len
op_assign
id|E1000_TEST_LEN
suffix:semicolon
DECL|macro|E1000_REGS_LEN
mdefine_line|#define E1000_REGS_LEN 32
id|drvinfo-&gt;regdump_len
op_assign
id|E1000_REGS_LEN
op_star
r_sizeof
(paren
r_uint32
)paren
suffix:semicolon
id|drvinfo-&gt;eedump_len
op_assign
id|adapter-&gt;hw.eeprom.word_size
op_star
l_int|2
suffix:semicolon
)brace
r_static
r_void
DECL|function|e1000_ethtool_gregs
id|e1000_ethtool_gregs
c_func
(paren
r_struct
id|e1000_adapter
op_star
id|adapter
comma
r_struct
id|ethtool_regs
op_star
id|regs
comma
r_uint32
op_star
id|regs_buff
)paren
(brace
r_struct
id|e1000_hw
op_star
id|hw
op_assign
op_amp
id|adapter-&gt;hw
suffix:semicolon
r_uint16
id|phy_data
suffix:semicolon
id|regs-&gt;version
op_assign
(paren
l_int|1
op_lshift
l_int|24
)paren
op_or
(paren
id|hw-&gt;revision_id
op_lshift
l_int|16
)paren
op_or
id|hw-&gt;device_id
suffix:semicolon
id|regs_buff
(braket
l_int|0
)braket
op_assign
id|E1000_READ_REG
c_func
(paren
id|hw
comma
id|CTRL
)paren
suffix:semicolon
id|regs_buff
(braket
l_int|1
)braket
op_assign
id|E1000_READ_REG
c_func
(paren
id|hw
comma
id|STATUS
)paren
suffix:semicolon
id|regs_buff
(braket
l_int|2
)braket
op_assign
id|E1000_READ_REG
c_func
(paren
id|hw
comma
id|RCTL
)paren
suffix:semicolon
id|regs_buff
(braket
l_int|3
)braket
op_assign
id|E1000_READ_REG
c_func
(paren
id|hw
comma
id|RDLEN
)paren
suffix:semicolon
id|regs_buff
(braket
l_int|4
)braket
op_assign
id|E1000_READ_REG
c_func
(paren
id|hw
comma
id|RDH
)paren
suffix:semicolon
id|regs_buff
(braket
l_int|5
)braket
op_assign
id|E1000_READ_REG
c_func
(paren
id|hw
comma
id|RDT
)paren
suffix:semicolon
id|regs_buff
(braket
l_int|6
)braket
op_assign
id|E1000_READ_REG
c_func
(paren
id|hw
comma
id|RDTR
)paren
suffix:semicolon
id|regs_buff
(braket
l_int|7
)braket
op_assign
id|E1000_READ_REG
c_func
(paren
id|hw
comma
id|TCTL
)paren
suffix:semicolon
id|regs_buff
(braket
l_int|8
)braket
op_assign
id|E1000_READ_REG
c_func
(paren
id|hw
comma
id|TDLEN
)paren
suffix:semicolon
id|regs_buff
(braket
l_int|9
)braket
op_assign
id|E1000_READ_REG
c_func
(paren
id|hw
comma
id|TDH
)paren
suffix:semicolon
id|regs_buff
(braket
l_int|10
)braket
op_assign
id|E1000_READ_REG
c_func
(paren
id|hw
comma
id|TDT
)paren
suffix:semicolon
id|regs_buff
(braket
l_int|11
)braket
op_assign
id|E1000_READ_REG
c_func
(paren
id|hw
comma
id|TIDV
)paren
suffix:semicolon
id|regs_buff
(braket
l_int|12
)braket
op_assign
id|adapter-&gt;hw.phy_type
suffix:semicolon
multiline_comment|/* PHY type (IGP=1, M88=0) */
r_if
c_cond
(paren
id|hw-&gt;phy_type
op_eq
id|e1000_phy_igp
)paren
(brace
id|e1000_write_phy_reg
c_func
(paren
id|hw
comma
id|IGP01E1000_PHY_PAGE_SELECT
comma
id|IGP01E1000_PHY_AGC_A
)paren
suffix:semicolon
id|e1000_read_phy_reg
c_func
(paren
id|hw
comma
id|IGP01E1000_PHY_AGC_A
op_amp
id|IGP01E1000_PHY_PAGE_SELECT
comma
op_amp
id|phy_data
)paren
suffix:semicolon
id|regs_buff
(braket
l_int|13
)braket
op_assign
(paren
r_uint32
)paren
id|phy_data
suffix:semicolon
multiline_comment|/* cable length */
id|e1000_write_phy_reg
c_func
(paren
id|hw
comma
id|IGP01E1000_PHY_PAGE_SELECT
comma
id|IGP01E1000_PHY_AGC_B
)paren
suffix:semicolon
id|e1000_read_phy_reg
c_func
(paren
id|hw
comma
id|IGP01E1000_PHY_AGC_B
op_amp
id|IGP01E1000_PHY_PAGE_SELECT
comma
op_amp
id|phy_data
)paren
suffix:semicolon
id|regs_buff
(braket
l_int|14
)braket
op_assign
(paren
r_uint32
)paren
id|phy_data
suffix:semicolon
multiline_comment|/* cable length */
id|e1000_write_phy_reg
c_func
(paren
id|hw
comma
id|IGP01E1000_PHY_PAGE_SELECT
comma
id|IGP01E1000_PHY_AGC_C
)paren
suffix:semicolon
id|e1000_read_phy_reg
c_func
(paren
id|hw
comma
id|IGP01E1000_PHY_AGC_C
op_amp
id|IGP01E1000_PHY_PAGE_SELECT
comma
op_amp
id|phy_data
)paren
suffix:semicolon
id|regs_buff
(braket
l_int|15
)braket
op_assign
(paren
r_uint32
)paren
id|phy_data
suffix:semicolon
multiline_comment|/* cable length */
id|e1000_write_phy_reg
c_func
(paren
id|hw
comma
id|IGP01E1000_PHY_PAGE_SELECT
comma
id|IGP01E1000_PHY_AGC_D
)paren
suffix:semicolon
id|e1000_read_phy_reg
c_func
(paren
id|hw
comma
id|IGP01E1000_PHY_AGC_D
op_amp
id|IGP01E1000_PHY_PAGE_SELECT
comma
op_amp
id|phy_data
)paren
suffix:semicolon
id|regs_buff
(braket
l_int|16
)braket
op_assign
(paren
r_uint32
)paren
id|phy_data
suffix:semicolon
multiline_comment|/* cable length */
id|regs_buff
(braket
l_int|17
)braket
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* extended 10bt distance (not needed) */
id|e1000_write_phy_reg
c_func
(paren
id|hw
comma
id|IGP01E1000_PHY_PAGE_SELECT
comma
l_int|0x0
)paren
suffix:semicolon
id|e1000_read_phy_reg
c_func
(paren
id|hw
comma
id|IGP01E1000_PHY_PORT_STATUS
op_amp
id|IGP01E1000_PHY_PAGE_SELECT
comma
op_amp
id|phy_data
)paren
suffix:semicolon
id|regs_buff
(braket
l_int|18
)braket
op_assign
(paren
r_uint32
)paren
id|phy_data
suffix:semicolon
multiline_comment|/* cable polarity */
id|e1000_write_phy_reg
c_func
(paren
id|hw
comma
id|IGP01E1000_PHY_PAGE_SELECT
comma
id|IGP01E1000_PHY_PCS_INIT_REG
)paren
suffix:semicolon
id|e1000_read_phy_reg
c_func
(paren
id|hw
comma
id|IGP01E1000_PHY_PCS_INIT_REG
op_amp
id|IGP01E1000_PHY_PAGE_SELECT
comma
op_amp
id|phy_data
)paren
suffix:semicolon
id|regs_buff
(braket
l_int|19
)braket
op_assign
(paren
r_uint32
)paren
id|phy_data
suffix:semicolon
multiline_comment|/* cable polarity */
id|regs_buff
(braket
l_int|20
)braket
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* polarity correction enabled (always) */
id|regs_buff
(braket
l_int|22
)braket
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* phy receive errors (unavailable) */
id|regs_buff
(braket
l_int|23
)braket
op_assign
id|regs_buff
(braket
l_int|18
)braket
suffix:semicolon
multiline_comment|/* mdix mode */
id|e1000_write_phy_reg
c_func
(paren
id|hw
comma
id|IGP01E1000_PHY_PAGE_SELECT
comma
l_int|0x0
)paren
suffix:semicolon
)brace
r_else
(brace
id|e1000_read_phy_reg
c_func
(paren
id|hw
comma
id|M88E1000_PHY_SPEC_STATUS
comma
op_amp
id|phy_data
)paren
suffix:semicolon
id|regs_buff
(braket
l_int|13
)braket
op_assign
(paren
r_uint32
)paren
id|phy_data
suffix:semicolon
multiline_comment|/* cable length */
id|regs_buff
(braket
l_int|14
)braket
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* Dummy (to align w/ IGP phy reg dump) */
id|regs_buff
(braket
l_int|15
)braket
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* Dummy (to align w/ IGP phy reg dump) */
id|regs_buff
(braket
l_int|16
)braket
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* Dummy (to align w/ IGP phy reg dump) */
id|e1000_read_phy_reg
c_func
(paren
id|hw
comma
id|M88E1000_PHY_SPEC_CTRL
comma
op_amp
id|phy_data
)paren
suffix:semicolon
id|regs_buff
(braket
l_int|17
)braket
op_assign
(paren
r_uint32
)paren
id|phy_data
suffix:semicolon
multiline_comment|/* extended 10bt distance */
id|regs_buff
(braket
l_int|18
)braket
op_assign
id|regs_buff
(braket
l_int|13
)braket
suffix:semicolon
multiline_comment|/* cable polarity */
id|regs_buff
(braket
l_int|19
)braket
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* Dummy (to align w/ IGP phy reg dump) */
id|regs_buff
(braket
l_int|20
)braket
op_assign
id|regs_buff
(braket
l_int|17
)braket
suffix:semicolon
multiline_comment|/* polarity correction */
multiline_comment|/* phy receive errors */
id|regs_buff
(braket
l_int|22
)braket
op_assign
id|adapter-&gt;phy_stats.receive_errors
suffix:semicolon
id|regs_buff
(braket
l_int|23
)braket
op_assign
id|regs_buff
(braket
l_int|13
)braket
suffix:semicolon
multiline_comment|/* mdix mode */
)brace
id|regs_buff
(braket
l_int|21
)braket
op_assign
id|adapter-&gt;phy_stats.idle_errors
suffix:semicolon
multiline_comment|/* phy idle errors */
id|e1000_read_phy_reg
c_func
(paren
id|hw
comma
id|PHY_1000T_STATUS
comma
op_amp
id|phy_data
)paren
suffix:semicolon
id|regs_buff
(braket
l_int|24
)braket
op_assign
(paren
r_uint32
)paren
id|phy_data
suffix:semicolon
multiline_comment|/* phy local receiver status */
id|regs_buff
(braket
l_int|25
)braket
op_assign
id|regs_buff
(braket
l_int|24
)braket
suffix:semicolon
multiline_comment|/* phy remote receiver status */
r_return
suffix:semicolon
)brace
r_static
r_int
DECL|function|e1000_ethtool_geeprom
id|e1000_ethtool_geeprom
c_func
(paren
r_struct
id|e1000_adapter
op_star
id|adapter
comma
r_struct
id|ethtool_eeprom
op_star
id|eeprom
comma
r_uint16
op_star
id|eeprom_buff
)paren
(brace
r_struct
id|e1000_hw
op_star
id|hw
op_assign
op_amp
id|adapter-&gt;hw
suffix:semicolon
r_int
id|first_word
comma
id|last_word
suffix:semicolon
r_int
id|ret_val
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|eeprom-&gt;len
op_eq
l_int|0
)paren
(brace
id|ret_val
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_goto
id|geeprom_error
suffix:semicolon
)brace
id|eeprom-&gt;magic
op_assign
id|hw-&gt;vendor_id
op_or
(paren
id|hw-&gt;device_id
op_lshift
l_int|16
)paren
suffix:semicolon
r_if
c_cond
(paren
id|eeprom-&gt;offset
OG
id|eeprom-&gt;offset
op_plus
id|eeprom-&gt;len
)paren
(brace
id|ret_val
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_goto
id|geeprom_error
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|eeprom-&gt;offset
op_plus
id|eeprom-&gt;len
)paren
OG
(paren
id|hw-&gt;eeprom.word_size
op_star
l_int|2
)paren
)paren
(brace
id|eeprom-&gt;len
op_assign
(paren
(paren
id|hw-&gt;eeprom.word_size
op_star
l_int|2
)paren
op_minus
id|eeprom-&gt;offset
)paren
suffix:semicolon
)brace
id|first_word
op_assign
id|eeprom-&gt;offset
op_rshift
l_int|1
suffix:semicolon
id|last_word
op_assign
(paren
id|eeprom-&gt;offset
op_plus
id|eeprom-&gt;len
op_minus
l_int|1
)paren
op_rshift
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|hw-&gt;eeprom.type
op_eq
id|e1000_eeprom_spi
)paren
(brace
id|ret_val
op_assign
id|e1000_read_eeprom
c_func
(paren
id|hw
comma
id|first_word
comma
id|last_word
op_minus
id|first_word
op_plus
l_int|1
comma
id|eeprom_buff
)paren
suffix:semicolon
)brace
r_else
(brace
r_uint16
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|last_word
op_minus
id|first_word
op_plus
l_int|1
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
(paren
id|ret_val
op_assign
id|e1000_read_eeprom
c_func
(paren
id|hw
comma
id|first_word
op_plus
id|i
comma
l_int|1
comma
op_amp
id|eeprom_buff
(braket
id|i
)braket
)paren
)paren
)paren
(brace
r_break
suffix:semicolon
)brace
)brace
id|geeprom_error
suffix:colon
r_return
id|ret_val
suffix:semicolon
)brace
r_static
r_int
DECL|function|e1000_ethtool_seeprom
id|e1000_ethtool_seeprom
c_func
(paren
r_struct
id|e1000_adapter
op_star
id|adapter
comma
r_struct
id|ethtool_eeprom
op_star
id|eeprom
comma
r_void
op_star
id|user_data
)paren
(brace
r_struct
id|e1000_hw
op_star
id|hw
op_assign
op_amp
id|adapter-&gt;hw
suffix:semicolon
r_uint16
op_star
id|eeprom_buff
suffix:semicolon
r_void
op_star
id|ptr
suffix:semicolon
r_int
id|max_len
comma
id|first_word
comma
id|last_word
comma
id|ret_val
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|eeprom-&gt;len
op_eq
l_int|0
)paren
(brace
r_return
op_minus
id|EOPNOTSUPP
suffix:semicolon
)brace
r_if
c_cond
(paren
id|eeprom-&gt;magic
op_ne
(paren
id|hw-&gt;vendor_id
op_or
(paren
id|hw-&gt;device_id
op_lshift
l_int|16
)paren
)paren
)paren
(brace
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
id|max_len
op_assign
id|hw-&gt;eeprom.word_size
op_star
l_int|2
suffix:semicolon
r_if
c_cond
(paren
(paren
id|eeprom-&gt;offset
op_plus
id|eeprom-&gt;len
)paren
OG
id|max_len
)paren
(brace
id|eeprom-&gt;len
op_assign
(paren
id|max_len
op_minus
id|eeprom-&gt;offset
)paren
suffix:semicolon
)brace
id|first_word
op_assign
id|eeprom-&gt;offset
op_rshift
l_int|1
suffix:semicolon
id|last_word
op_assign
(paren
id|eeprom-&gt;offset
op_plus
id|eeprom-&gt;len
op_minus
l_int|1
)paren
op_rshift
l_int|1
suffix:semicolon
id|eeprom_buff
op_assign
id|kmalloc
c_func
(paren
id|max_len
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|eeprom_buff
)paren
(brace
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|ptr
op_assign
(paren
r_void
op_star
)paren
id|eeprom_buff
suffix:semicolon
r_if
c_cond
(paren
id|eeprom-&gt;offset
op_amp
l_int|1
)paren
(brace
multiline_comment|/* need read/modify/write of first changed EEPROM word */
multiline_comment|/* only the second byte of the word is being modified */
id|ret_val
op_assign
id|e1000_read_eeprom
c_func
(paren
id|hw
comma
id|first_word
comma
l_int|1
comma
op_amp
id|eeprom_buff
(braket
l_int|0
)braket
)paren
suffix:semicolon
id|ptr
op_increment
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
(paren
id|eeprom-&gt;offset
op_plus
id|eeprom-&gt;len
)paren
op_amp
l_int|1
)paren
op_logical_and
(paren
id|ret_val
op_eq
l_int|0
)paren
)paren
(brace
multiline_comment|/* need read/modify/write of last changed EEPROM word */
multiline_comment|/* only the first byte of the word is being modified */
id|ret_val
op_assign
id|e1000_read_eeprom
c_func
(paren
id|hw
comma
id|last_word
comma
l_int|1
comma
op_amp
id|eeprom_buff
(braket
id|last_word
op_minus
id|first_word
)braket
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|ret_val
op_ne
l_int|0
)paren
op_logical_or
id|copy_from_user
c_func
(paren
id|ptr
comma
id|user_data
comma
id|eeprom-&gt;len
)paren
)paren
(brace
id|ret_val
op_assign
op_minus
id|EFAULT
suffix:semicolon
r_goto
id|seeprom_error
suffix:semicolon
)brace
id|ret_val
op_assign
id|e1000_write_eeprom
c_func
(paren
id|hw
comma
id|first_word
comma
id|last_word
op_minus
id|first_word
op_plus
l_int|1
comma
id|eeprom_buff
)paren
suffix:semicolon
multiline_comment|/* Update the checksum over the first part of the EEPROM if needed */
r_if
c_cond
(paren
(paren
id|ret_val
op_eq
l_int|0
)paren
op_logical_and
id|first_word
op_le
id|EEPROM_CHECKSUM_REG
)paren
(brace
id|e1000_update_eeprom_checksum
c_func
(paren
id|hw
)paren
suffix:semicolon
)brace
id|seeprom_error
suffix:colon
id|kfree
c_func
(paren
id|eeprom_buff
)paren
suffix:semicolon
r_return
id|ret_val
suffix:semicolon
)brace
DECL|macro|REG_PATTERN_TEST
mdefine_line|#define REG_PATTERN_TEST(R, M, W)                                              &bslash;&n;{                                                                              &bslash;&n;&t;uint32_t pat, value;                                                   &bslash;&n;&t;uint32_t test[] =                                                      &bslash;&n;&t;&t;{0x5A5A5A5A, 0xA5A5A5A5, 0x00000000, 0xFFFFFFFF};              &bslash;&n;&t;for(pat = 0; pat &lt; sizeof(test)/sizeof(test[0]); pat++) {              &bslash;&n;&t;&t;E1000_WRITE_REG(&amp;adapter-&gt;hw, R, (test[pat] &amp; W));             &bslash;&n;&t;&t;value = E1000_READ_REG(&amp;adapter-&gt;hw, R);                       &bslash;&n;&t;&t;if(value != (test[pat] &amp; W &amp; M)) {                             &bslash;&n;&t;&t;&t;*data = (adapter-&gt;hw.mac_type &lt; e1000_82543) ?         &bslash;&n;&t;&t;&t;&t;E1000_82542_##R : E1000_##R;                   &bslash;&n;&t;&t;&t;return 1;                                              &bslash;&n;&t;&t;}                                                              &bslash;&n;&t;}                                                                      &bslash;&n;}
DECL|macro|REG_SET_AND_CHECK
mdefine_line|#define REG_SET_AND_CHECK(R, M, W)                                             &bslash;&n;{                                                                              &bslash;&n;&t;uint32_t value;                                                        &bslash;&n;&t;E1000_WRITE_REG(&amp;adapter-&gt;hw, R, W &amp; M);                               &bslash;&n;&t;value = E1000_READ_REG(&amp;adapter-&gt;hw, R);                               &bslash;&n;&t;if ((W &amp; M) != (value &amp; M)) {                                          &bslash;&n;&t;&t;*data = (adapter-&gt;hw.mac_type &lt; e1000_82543) ?                 &bslash;&n;&t;&t;&t;E1000_82542_##R : E1000_##R;                           &bslash;&n;&t;&t;return 1;                                                      &bslash;&n;&t;}                                                                      &bslash;&n;}
r_static
r_int
DECL|function|e1000_reg_test
id|e1000_reg_test
c_func
(paren
r_struct
id|e1000_adapter
op_star
id|adapter
comma
r_uint64
op_star
id|data
)paren
(brace
r_uint32
id|value
suffix:semicolon
r_uint32
id|i
suffix:semicolon
multiline_comment|/* The status register is Read Only, so a write should fail.&n;&t; * Some bits that get toggled are ignored.&n;&t; */
id|value
op_assign
(paren
id|E1000_READ_REG
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|STATUS
)paren
op_amp
(paren
l_int|0xFFFFF833
)paren
)paren
suffix:semicolon
id|E1000_WRITE_REG
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|STATUS
comma
(paren
l_int|0xFFFFFFFF
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|value
op_ne
(paren
id|E1000_READ_REG
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|STATUS
)paren
op_amp
(paren
l_int|0xFFFFF833
)paren
)paren
)paren
(brace
op_star
id|data
op_assign
l_int|1
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
id|REG_PATTERN_TEST
c_func
(paren
id|FCAL
comma
l_int|0xFFFFFFFF
comma
l_int|0xFFFFFFFF
)paren
suffix:semicolon
id|REG_PATTERN_TEST
c_func
(paren
id|FCAH
comma
l_int|0x0000FFFF
comma
l_int|0xFFFFFFFF
)paren
suffix:semicolon
id|REG_PATTERN_TEST
c_func
(paren
id|FCT
comma
l_int|0x0000FFFF
comma
l_int|0xFFFFFFFF
)paren
suffix:semicolon
id|REG_PATTERN_TEST
c_func
(paren
id|VET
comma
l_int|0x0000FFFF
comma
l_int|0xFFFFFFFF
)paren
suffix:semicolon
id|REG_PATTERN_TEST
c_func
(paren
id|RDTR
comma
l_int|0x0000FFFF
comma
l_int|0xFFFFFFFF
)paren
suffix:semicolon
id|REG_PATTERN_TEST
c_func
(paren
id|RDBAH
comma
l_int|0xFFFFFFFF
comma
l_int|0xFFFFFFFF
)paren
suffix:semicolon
id|REG_PATTERN_TEST
c_func
(paren
id|RDLEN
comma
l_int|0x000FFF80
comma
l_int|0x000FFFFF
)paren
suffix:semicolon
id|REG_PATTERN_TEST
c_func
(paren
id|RDH
comma
l_int|0x0000FFFF
comma
l_int|0x0000FFFF
)paren
suffix:semicolon
id|REG_PATTERN_TEST
c_func
(paren
id|RDT
comma
l_int|0x0000FFFF
comma
l_int|0x0000FFFF
)paren
suffix:semicolon
id|REG_PATTERN_TEST
c_func
(paren
id|FCRTH
comma
l_int|0x0000FFF8
comma
l_int|0x0000FFF8
)paren
suffix:semicolon
id|REG_PATTERN_TEST
c_func
(paren
id|FCTTV
comma
l_int|0x0000FFFF
comma
l_int|0x0000FFFF
)paren
suffix:semicolon
id|REG_PATTERN_TEST
c_func
(paren
id|TIPG
comma
l_int|0x3FFFFFFF
comma
l_int|0x3FFFFFFF
)paren
suffix:semicolon
id|REG_PATTERN_TEST
c_func
(paren
id|TDBAH
comma
l_int|0xFFFFFFFF
comma
l_int|0xFFFFFFFF
)paren
suffix:semicolon
id|REG_PATTERN_TEST
c_func
(paren
id|TDLEN
comma
l_int|0x000FFF80
comma
l_int|0x000FFFFF
)paren
suffix:semicolon
id|REG_SET_AND_CHECK
c_func
(paren
id|RCTL
comma
l_int|0xFFFFFFFF
comma
l_int|0x00000000
)paren
suffix:semicolon
id|REG_SET_AND_CHECK
c_func
(paren
id|RCTL
comma
l_int|0x06DFB3FE
comma
l_int|0x003FFFFB
)paren
suffix:semicolon
id|REG_SET_AND_CHECK
c_func
(paren
id|TCTL
comma
l_int|0xFFFFFFFF
comma
l_int|0x00000000
)paren
suffix:semicolon
r_if
c_cond
(paren
id|adapter-&gt;hw.mac_type
op_ge
id|e1000_82543
)paren
(brace
id|REG_SET_AND_CHECK
c_func
(paren
id|RCTL
comma
l_int|0x06DFB3FE
comma
l_int|0xFFFFFFFF
)paren
suffix:semicolon
id|REG_PATTERN_TEST
c_func
(paren
id|RDBAL
comma
l_int|0xFFFFFFF0
comma
l_int|0xFFFFFFFF
)paren
suffix:semicolon
id|REG_PATTERN_TEST
c_func
(paren
id|TXCW
comma
l_int|0xC000FFFF
comma
l_int|0x0000FFFF
)paren
suffix:semicolon
id|REG_PATTERN_TEST
c_func
(paren
id|TDBAL
comma
l_int|0xFFFFFFF0
comma
l_int|0xFFFFFFFF
)paren
suffix:semicolon
id|REG_PATTERN_TEST
c_func
(paren
id|TIDV
comma
l_int|0x0000FFFF
comma
l_int|0x0000FFFF
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|E1000_RAR_ENTRIES
suffix:semicolon
id|i
op_increment
)paren
(brace
id|REG_PATTERN_TEST
c_func
(paren
id|RA
op_plus
(paren
(paren
id|i
op_lshift
l_int|1
)paren
op_lshift
l_int|2
)paren
comma
l_int|0xFFFFFFFF
comma
l_int|0xFFFFFFFF
)paren
suffix:semicolon
id|REG_PATTERN_TEST
c_func
(paren
id|RA
op_plus
(paren
(paren
(paren
id|i
op_lshift
l_int|1
)paren
op_plus
l_int|1
)paren
op_lshift
l_int|2
)paren
comma
l_int|0x8003FFFF
comma
l_int|0xFFFFFFFF
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
id|REG_SET_AND_CHECK
c_func
(paren
id|RCTL
comma
l_int|0xFFFFFFFF
comma
l_int|0x01FFFFFF
)paren
suffix:semicolon
id|REG_PATTERN_TEST
c_func
(paren
id|RDBAL
comma
l_int|0xFFFFF000
comma
l_int|0xFFFFFFFF
)paren
suffix:semicolon
id|REG_PATTERN_TEST
c_func
(paren
id|TXCW
comma
l_int|0x0000FFFF
comma
l_int|0x0000FFFF
)paren
suffix:semicolon
id|REG_PATTERN_TEST
c_func
(paren
id|TDBAL
comma
l_int|0xFFFFF000
comma
l_int|0xFFFFFFFF
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|E1000_MC_TBL_SIZE
suffix:semicolon
id|i
op_increment
)paren
(brace
id|REG_PATTERN_TEST
c_func
(paren
id|MTA
op_plus
(paren
id|i
op_lshift
l_int|2
)paren
comma
l_int|0xFFFFFFFF
comma
l_int|0xFFFFFFFF
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|e1000_eeprom_test
id|e1000_eeprom_test
c_func
(paren
r_struct
id|e1000_adapter
op_star
id|adapter
comma
r_uint64
op_star
id|data
)paren
(brace
r_uint16
id|temp
suffix:semicolon
r_uint16
id|checksum
op_assign
l_int|0
suffix:semicolon
r_uint16
id|i
suffix:semicolon
op_star
id|data
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* Read and add up the contents of the EEPROM */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
(paren
id|EEPROM_CHECKSUM_REG
op_plus
l_int|1
)paren
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
(paren
id|e1000_read_eeprom
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|i
comma
l_int|1
comma
op_amp
id|temp
)paren
)paren
OL
l_int|0
)paren
(brace
op_star
id|data
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
)brace
id|checksum
op_add_assign
id|temp
suffix:semicolon
)brace
multiline_comment|/* If Checksum is not Correct return error else test passed */
r_if
c_cond
(paren
(paren
id|checksum
op_ne
(paren
r_uint16
)paren
id|EEPROM_SUM
)paren
op_logical_and
op_logical_neg
(paren
op_star
id|data
)paren
)paren
(brace
op_star
id|data
op_assign
l_int|2
suffix:semicolon
)brace
r_return
op_star
id|data
suffix:semicolon
)brace
r_static
id|irqreturn_t
DECL|function|e1000_test_intr
id|e1000_test_intr
c_func
(paren
r_int
id|irq
comma
r_void
op_star
id|data
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
r_struct
id|net_device
op_star
id|netdev
op_assign
(paren
r_struct
id|net_device
op_star
)paren
id|data
suffix:semicolon
r_struct
id|e1000_adapter
op_star
id|adapter
op_assign
id|netdev-&gt;priv
suffix:semicolon
id|adapter-&gt;test_icr
op_or_assign
id|E1000_READ_REG
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|ICR
)paren
suffix:semicolon
r_return
id|IRQ_HANDLED
suffix:semicolon
)brace
r_static
r_int
DECL|function|e1000_intr_test
id|e1000_intr_test
c_func
(paren
r_struct
id|e1000_adapter
op_star
id|adapter
comma
r_uint64
op_star
id|data
)paren
(brace
r_struct
id|net_device
op_star
id|netdev
op_assign
id|adapter-&gt;netdev
suffix:semicolon
r_uint32
id|icr
comma
id|mask
comma
id|i
op_assign
l_int|0
suffix:semicolon
op_star
id|data
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* Hook up test interrupt handler just for this test */
r_if
c_cond
(paren
id|request_irq
(paren
id|netdev-&gt;irq
comma
op_amp
id|e1000_test_intr
comma
id|SA_SHIRQ
comma
id|netdev-&gt;name
comma
id|netdev
)paren
)paren
(brace
op_star
id|data
op_assign
l_int|1
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
multiline_comment|/* Disable all the interrupts */
id|E1000_WRITE_REG
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|IMC
comma
l_int|0xFFFFFFFF
)paren
suffix:semicolon
id|msec_delay
c_func
(paren
l_int|10
)paren
suffix:semicolon
multiline_comment|/* Interrupts are disabled, so read interrupt cause&n;&t; * register (icr) twice to verify that there are no interrupts&n;&t; * pending.  icr is clear on read.&n;&t; */
id|icr
op_assign
id|E1000_READ_REG
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|ICR
)paren
suffix:semicolon
id|icr
op_assign
id|E1000_READ_REG
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|ICR
)paren
suffix:semicolon
r_if
c_cond
(paren
id|icr
op_ne
l_int|0
)paren
(brace
multiline_comment|/* if icr is non-zero, there is no point&n;&t;&t; * running other interrupt tests.&n;&t;&t; */
op_star
id|data
op_assign
l_int|2
suffix:semicolon
id|i
op_assign
l_int|10
suffix:semicolon
)brace
multiline_comment|/* Test each interrupt */
r_for
c_loop
(paren
suffix:semicolon
id|i
OL
l_int|10
suffix:semicolon
id|i
op_increment
)paren
(brace
multiline_comment|/* Interrupt to test */
id|mask
op_assign
l_int|1
op_lshift
id|i
suffix:semicolon
multiline_comment|/* Disable the interrupt to be reported in&n;&t;&t; * the cause register and then force the same&n;&t;&t; * interrupt and see if one gets posted.  If&n;&t;&t; * an interrupt was posted to the bus, the&n;&t;&t; * test failed.&n;&t;&t; */
id|adapter-&gt;test_icr
op_assign
l_int|0
suffix:semicolon
id|E1000_WRITE_REG
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|IMC
comma
id|mask
)paren
suffix:semicolon
id|E1000_WRITE_REG
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|ICS
comma
id|mask
)paren
suffix:semicolon
id|msec_delay
c_func
(paren
l_int|10
)paren
suffix:semicolon
r_if
c_cond
(paren
id|adapter-&gt;test_icr
op_amp
id|mask
)paren
(brace
op_star
id|data
op_assign
l_int|3
suffix:semicolon
r_break
suffix:semicolon
)brace
multiline_comment|/* Enable the interrupt to be reported in&n;&t;&t; * the cause register and then force the same&n;&t;&t; * interrupt and see if one gets posted.  If&n;&t;&t; * an interrupt was not posted to the bus, the&n;&t;&t; * test failed.&n;&t;&t; */
id|adapter-&gt;test_icr
op_assign
l_int|0
suffix:semicolon
id|E1000_WRITE_REG
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|IMS
comma
id|mask
)paren
suffix:semicolon
id|E1000_WRITE_REG
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|ICS
comma
id|mask
)paren
suffix:semicolon
id|msec_delay
c_func
(paren
l_int|10
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|adapter-&gt;test_icr
op_amp
id|mask
)paren
)paren
(brace
op_star
id|data
op_assign
l_int|4
suffix:semicolon
r_break
suffix:semicolon
)brace
multiline_comment|/* Disable the other interrupts to be reported in&n;&t;&t; * the cause register and then force the other&n;&t;&t; * interrupts and see if any get posted.  If&n;&t;&t; * an interrupt was posted to the bus, the&n;&t;&t; * test failed.&n;&t;&t; */
id|adapter-&gt;test_icr
op_assign
l_int|0
suffix:semicolon
id|E1000_WRITE_REG
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|IMC
comma
op_complement
id|mask
)paren
suffix:semicolon
id|E1000_WRITE_REG
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|ICS
comma
op_complement
id|mask
)paren
suffix:semicolon
id|msec_delay
c_func
(paren
l_int|10
)paren
suffix:semicolon
r_if
c_cond
(paren
id|adapter-&gt;test_icr
)paren
(brace
op_star
id|data
op_assign
l_int|5
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
multiline_comment|/* Disable all the interrupts */
id|E1000_WRITE_REG
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|IMC
comma
l_int|0xFFFFFFFF
)paren
suffix:semicolon
id|msec_delay
c_func
(paren
l_int|10
)paren
suffix:semicolon
multiline_comment|/* Unhook test interrupt handler */
id|free_irq
c_func
(paren
id|netdev-&gt;irq
comma
id|netdev
)paren
suffix:semicolon
r_return
op_star
id|data
suffix:semicolon
)brace
r_static
r_void
DECL|function|e1000_free_desc_rings
id|e1000_free_desc_rings
c_func
(paren
r_struct
id|e1000_adapter
op_star
id|adapter
)paren
(brace
r_struct
id|e1000_desc_ring
op_star
id|txdr
op_assign
op_amp
id|adapter-&gt;test_tx_ring
suffix:semicolon
r_struct
id|e1000_desc_ring
op_star
id|rxdr
op_assign
op_amp
id|adapter-&gt;test_rx_ring
suffix:semicolon
r_struct
id|pci_dev
op_star
id|pdev
op_assign
id|adapter-&gt;pdev
suffix:semicolon
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
id|txdr-&gt;desc
op_logical_and
id|txdr-&gt;buffer_info
)paren
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|txdr-&gt;count
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|txdr-&gt;buffer_info
(braket
id|i
)braket
dot
id|dma
)paren
(brace
id|pci_unmap_single
c_func
(paren
id|pdev
comma
id|txdr-&gt;buffer_info
(braket
id|i
)braket
dot
id|dma
comma
id|txdr-&gt;buffer_info
(braket
id|i
)braket
dot
id|length
comma
id|PCI_DMA_TODEVICE
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|txdr-&gt;buffer_info
(braket
id|i
)braket
dot
id|skb
)paren
(brace
id|dev_kfree_skb
c_func
(paren
id|txdr-&gt;buffer_info
(braket
id|i
)braket
dot
id|skb
)paren
suffix:semicolon
)brace
)brace
)brace
r_if
c_cond
(paren
id|rxdr-&gt;desc
op_logical_and
id|rxdr-&gt;buffer_info
)paren
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|rxdr-&gt;count
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|rxdr-&gt;buffer_info
(braket
id|i
)braket
dot
id|dma
)paren
(brace
id|pci_unmap_single
c_func
(paren
id|pdev
comma
id|rxdr-&gt;buffer_info
(braket
id|i
)braket
dot
id|dma
comma
id|rxdr-&gt;buffer_info
(braket
id|i
)braket
dot
id|length
comma
id|PCI_DMA_FROMDEVICE
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|rxdr-&gt;buffer_info
(braket
id|i
)braket
dot
id|skb
)paren
(brace
id|dev_kfree_skb
c_func
(paren
id|rxdr-&gt;buffer_info
(braket
id|i
)braket
dot
id|skb
)paren
suffix:semicolon
)brace
)brace
)brace
r_if
c_cond
(paren
id|txdr-&gt;desc
)paren
(brace
id|pci_free_consistent
c_func
(paren
id|pdev
comma
id|txdr-&gt;size
comma
id|txdr-&gt;desc
comma
id|txdr-&gt;dma
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|rxdr-&gt;desc
)paren
(brace
id|pci_free_consistent
c_func
(paren
id|pdev
comma
id|rxdr-&gt;size
comma
id|rxdr-&gt;desc
comma
id|rxdr-&gt;dma
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|txdr-&gt;buffer_info
)paren
(brace
id|kfree
c_func
(paren
id|txdr-&gt;buffer_info
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|rxdr-&gt;buffer_info
)paren
(brace
id|kfree
c_func
(paren
id|rxdr-&gt;buffer_info
)paren
suffix:semicolon
)brace
r_return
suffix:semicolon
)brace
r_static
r_int
DECL|function|e1000_setup_desc_rings
id|e1000_setup_desc_rings
c_func
(paren
r_struct
id|e1000_adapter
op_star
id|adapter
)paren
(brace
r_struct
id|e1000_desc_ring
op_star
id|txdr
op_assign
op_amp
id|adapter-&gt;test_tx_ring
suffix:semicolon
r_struct
id|e1000_desc_ring
op_star
id|rxdr
op_assign
op_amp
id|adapter-&gt;test_rx_ring
suffix:semicolon
r_struct
id|pci_dev
op_star
id|pdev
op_assign
id|adapter-&gt;pdev
suffix:semicolon
r_uint32
id|rctl
suffix:semicolon
r_int
id|size
comma
id|i
comma
id|ret_val
suffix:semicolon
multiline_comment|/* Setup Tx descriptor ring and Tx buffers */
id|txdr-&gt;count
op_assign
l_int|80
suffix:semicolon
id|size
op_assign
id|txdr-&gt;count
op_star
r_sizeof
(paren
r_struct
id|e1000_buffer
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|txdr-&gt;buffer_info
op_assign
id|kmalloc
c_func
(paren
id|size
comma
id|GFP_KERNEL
)paren
)paren
)paren
(brace
id|ret_val
op_assign
l_int|1
suffix:semicolon
r_goto
id|err_nomem
suffix:semicolon
)brace
id|memset
c_func
(paren
id|txdr-&gt;buffer_info
comma
l_int|0
comma
id|size
)paren
suffix:semicolon
id|txdr-&gt;size
op_assign
id|txdr-&gt;count
op_star
r_sizeof
(paren
r_struct
id|e1000_tx_desc
)paren
suffix:semicolon
id|E1000_ROUNDUP
c_func
(paren
id|txdr-&gt;size
comma
l_int|4096
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|txdr-&gt;desc
op_assign
id|pci_alloc_consistent
c_func
(paren
id|pdev
comma
id|txdr-&gt;size
comma
op_amp
id|txdr-&gt;dma
)paren
)paren
)paren
(brace
id|ret_val
op_assign
l_int|2
suffix:semicolon
r_goto
id|err_nomem
suffix:semicolon
)brace
id|memset
c_func
(paren
id|txdr-&gt;desc
comma
l_int|0
comma
id|txdr-&gt;size
)paren
suffix:semicolon
id|txdr-&gt;next_to_use
op_assign
id|txdr-&gt;next_to_clean
op_assign
l_int|0
suffix:semicolon
id|E1000_WRITE_REG
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|TDBAL
comma
(paren
(paren
r_uint64
)paren
id|txdr-&gt;dma
op_amp
l_int|0x00000000FFFFFFFF
)paren
)paren
suffix:semicolon
id|E1000_WRITE_REG
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|TDBAH
comma
(paren
(paren
r_uint64
)paren
id|txdr-&gt;dma
op_rshift
l_int|32
)paren
)paren
suffix:semicolon
id|E1000_WRITE_REG
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|TDLEN
comma
id|txdr-&gt;count
op_star
r_sizeof
(paren
r_struct
id|e1000_tx_desc
)paren
)paren
suffix:semicolon
id|E1000_WRITE_REG
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|TDH
comma
l_int|0
)paren
suffix:semicolon
id|E1000_WRITE_REG
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|TDT
comma
l_int|0
)paren
suffix:semicolon
id|E1000_WRITE_REG
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|TCTL
comma
id|E1000_TCTL_PSP
op_or
id|E1000_TCTL_EN
op_or
id|E1000_COLLISION_THRESHOLD
op_lshift
id|E1000_CT_SHIFT
op_or
id|E1000_FDX_COLLISION_DISTANCE
op_lshift
id|E1000_COLD_SHIFT
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|txdr-&gt;count
suffix:semicolon
id|i
op_increment
)paren
(brace
r_struct
id|e1000_tx_desc
op_star
id|tx_desc
op_assign
id|E1000_TX_DESC
c_func
(paren
op_star
id|txdr
comma
id|i
)paren
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
r_int
r_int
id|size
op_assign
l_int|1024
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|skb
op_assign
id|alloc_skb
c_func
(paren
id|size
comma
id|GFP_KERNEL
)paren
)paren
)paren
(brace
id|ret_val
op_assign
l_int|3
suffix:semicolon
r_goto
id|err_nomem
suffix:semicolon
)brace
id|skb_put
c_func
(paren
id|skb
comma
id|size
)paren
suffix:semicolon
id|txdr-&gt;buffer_info
(braket
id|i
)braket
dot
id|skb
op_assign
id|skb
suffix:semicolon
id|txdr-&gt;buffer_info
(braket
id|i
)braket
dot
id|length
op_assign
id|skb-&gt;len
suffix:semicolon
id|txdr-&gt;buffer_info
(braket
id|i
)braket
dot
id|dma
op_assign
id|pci_map_single
c_func
(paren
id|pdev
comma
id|skb-&gt;data
comma
id|skb-&gt;len
comma
id|PCI_DMA_TODEVICE
)paren
suffix:semicolon
id|tx_desc-&gt;buffer_addr
op_assign
id|cpu_to_le64
c_func
(paren
id|txdr-&gt;buffer_info
(braket
id|i
)braket
dot
id|dma
)paren
suffix:semicolon
id|tx_desc-&gt;lower.data
op_assign
id|cpu_to_le32
c_func
(paren
id|skb-&gt;len
)paren
suffix:semicolon
id|tx_desc-&gt;lower.data
op_or_assign
id|E1000_TXD_CMD_EOP
suffix:semicolon
id|tx_desc-&gt;lower.data
op_or_assign
id|E1000_TXD_CMD_IFCS
suffix:semicolon
id|tx_desc-&gt;lower.data
op_or_assign
id|E1000_TXD_CMD_RPS
suffix:semicolon
id|tx_desc-&gt;upper.data
op_assign
l_int|0
suffix:semicolon
)brace
multiline_comment|/* Setup Rx descriptor ring and Rx buffers */
id|rxdr-&gt;count
op_assign
l_int|80
suffix:semicolon
id|size
op_assign
id|rxdr-&gt;count
op_star
r_sizeof
(paren
r_struct
id|e1000_buffer
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|rxdr-&gt;buffer_info
op_assign
id|kmalloc
c_func
(paren
id|size
comma
id|GFP_KERNEL
)paren
)paren
)paren
(brace
id|ret_val
op_assign
l_int|4
suffix:semicolon
r_goto
id|err_nomem
suffix:semicolon
)brace
id|memset
c_func
(paren
id|rxdr-&gt;buffer_info
comma
l_int|0
comma
id|size
)paren
suffix:semicolon
id|rxdr-&gt;size
op_assign
id|rxdr-&gt;count
op_star
r_sizeof
(paren
r_struct
id|e1000_rx_desc
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|rxdr-&gt;desc
op_assign
id|pci_alloc_consistent
c_func
(paren
id|pdev
comma
id|rxdr-&gt;size
comma
op_amp
id|rxdr-&gt;dma
)paren
)paren
)paren
(brace
id|ret_val
op_assign
l_int|5
suffix:semicolon
r_goto
id|err_nomem
suffix:semicolon
)brace
id|memset
c_func
(paren
id|rxdr-&gt;desc
comma
l_int|0
comma
id|rxdr-&gt;size
)paren
suffix:semicolon
id|rxdr-&gt;next_to_use
op_assign
id|rxdr-&gt;next_to_clean
op_assign
l_int|0
suffix:semicolon
id|rctl
op_assign
id|E1000_READ_REG
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|RCTL
)paren
suffix:semicolon
id|E1000_WRITE_REG
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|RCTL
comma
id|rctl
op_amp
op_complement
id|E1000_RCTL_EN
)paren
suffix:semicolon
id|E1000_WRITE_REG
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|RDBAL
comma
(paren
(paren
r_uint64
)paren
id|rxdr-&gt;dma
op_amp
l_int|0xFFFFFFFF
)paren
)paren
suffix:semicolon
id|E1000_WRITE_REG
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|RDBAH
comma
(paren
(paren
r_uint64
)paren
id|rxdr-&gt;dma
op_rshift
l_int|32
)paren
)paren
suffix:semicolon
id|E1000_WRITE_REG
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|RDLEN
comma
id|rxdr-&gt;size
)paren
suffix:semicolon
id|E1000_WRITE_REG
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|RDH
comma
l_int|0
)paren
suffix:semicolon
id|E1000_WRITE_REG
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|RDT
comma
l_int|0
)paren
suffix:semicolon
id|rctl
op_assign
id|E1000_RCTL_EN
op_or
id|E1000_RCTL_BAM
op_or
id|E1000_RCTL_SZ_2048
op_or
id|E1000_RCTL_LBM_NO
op_or
id|E1000_RCTL_RDMTS_HALF
op_or
(paren
id|adapter-&gt;hw.mc_filter_type
op_lshift
id|E1000_RCTL_MO_SHIFT
)paren
suffix:semicolon
id|E1000_WRITE_REG
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|RCTL
comma
id|rctl
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|rxdr-&gt;count
suffix:semicolon
id|i
op_increment
)paren
(brace
r_struct
id|e1000_rx_desc
op_star
id|rx_desc
op_assign
id|E1000_RX_DESC
c_func
(paren
op_star
id|rxdr
comma
id|i
)paren
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|skb
op_assign
id|alloc_skb
c_func
(paren
id|E1000_RXBUFFER_2048
op_plus
l_int|2
comma
id|GFP_KERNEL
)paren
)paren
)paren
(brace
id|ret_val
op_assign
l_int|6
suffix:semicolon
r_goto
id|err_nomem
suffix:semicolon
)brace
id|skb_reserve
c_func
(paren
id|skb
comma
l_int|2
)paren
suffix:semicolon
id|rxdr-&gt;buffer_info
(braket
id|i
)braket
dot
id|skb
op_assign
id|skb
suffix:semicolon
id|rxdr-&gt;buffer_info
(braket
id|i
)braket
dot
id|length
op_assign
id|E1000_RXBUFFER_2048
suffix:semicolon
id|rxdr-&gt;buffer_info
(braket
id|i
)braket
dot
id|dma
op_assign
id|pci_map_single
c_func
(paren
id|pdev
comma
id|skb-&gt;data
comma
id|E1000_RXBUFFER_2048
comma
id|PCI_DMA_FROMDEVICE
)paren
suffix:semicolon
id|rx_desc-&gt;buffer_addr
op_assign
id|cpu_to_le64
c_func
(paren
id|rxdr-&gt;buffer_info
(braket
id|i
)braket
dot
id|dma
)paren
suffix:semicolon
id|memset
c_func
(paren
id|skb-&gt;data
comma
l_int|0x00
comma
id|skb-&gt;len
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
id|err_nomem
suffix:colon
id|e1000_free_desc_rings
c_func
(paren
id|adapter
)paren
suffix:semicolon
r_return
id|ret_val
suffix:semicolon
)brace
r_static
r_void
DECL|function|e1000_phy_disable_receiver
id|e1000_phy_disable_receiver
c_func
(paren
r_struct
id|e1000_adapter
op_star
id|adapter
)paren
(brace
multiline_comment|/* Write out to PHY registers 29 and 30 to disable the Receiver. */
id|e1000_write_phy_reg
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
l_int|29
comma
l_int|0x001F
)paren
suffix:semicolon
id|e1000_write_phy_reg
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
l_int|30
comma
l_int|0x8FFC
)paren
suffix:semicolon
id|e1000_write_phy_reg
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
l_int|29
comma
l_int|0x001A
)paren
suffix:semicolon
id|e1000_write_phy_reg
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
l_int|30
comma
l_int|0x8FF0
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_static
r_void
DECL|function|e1000_phy_reset_clk_and_crs
id|e1000_phy_reset_clk_and_crs
c_func
(paren
r_struct
id|e1000_adapter
op_star
id|adapter
)paren
(brace
r_uint16
id|phy_reg
suffix:semicolon
multiline_comment|/* Because we reset the PHY above, we need to re-force TX_CLK in the&n;&t; * Extended PHY Specific Control Register to 25MHz clock.  This&n;&t; * value defaults back to a 2.5MHz clock when the PHY is reset.&n;&t; */
id|e1000_read_phy_reg
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|M88E1000_EXT_PHY_SPEC_CTRL
comma
op_amp
id|phy_reg
)paren
suffix:semicolon
id|phy_reg
op_or_assign
id|M88E1000_EPSCR_TX_CLK_25
suffix:semicolon
id|e1000_write_phy_reg
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|M88E1000_EXT_PHY_SPEC_CTRL
comma
id|phy_reg
)paren
suffix:semicolon
multiline_comment|/* In addition, because of the s/w reset above, we need to enable&n;&t; * CRS on TX.  This must be set for both full and half duplex&n;&t; * operation.&n;&t; */
id|e1000_read_phy_reg
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|M88E1000_PHY_SPEC_CTRL
comma
op_amp
id|phy_reg
)paren
suffix:semicolon
id|phy_reg
op_or_assign
id|M88E1000_PSCR_ASSERT_CRS_ON_TX
suffix:semicolon
id|e1000_write_phy_reg
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|M88E1000_PHY_SPEC_CTRL
comma
id|phy_reg
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|e1000_nonintegrated_phy_loopback
id|e1000_nonintegrated_phy_loopback
c_func
(paren
r_struct
id|e1000_adapter
op_star
id|adapter
)paren
(brace
r_uint32
id|ctrl_reg
suffix:semicolon
r_uint16
id|phy_reg
suffix:semicolon
multiline_comment|/* Setup the Device Control Register for PHY loopback test. */
id|ctrl_reg
op_assign
id|E1000_READ_REG
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|CTRL
)paren
suffix:semicolon
id|ctrl_reg
op_or_assign
(paren
id|E1000_CTRL_ILOS
op_or
multiline_comment|/* Invert Loss-Of-Signal */
id|E1000_CTRL_FRCSPD
op_or
multiline_comment|/* Set the Force Speed Bit */
id|E1000_CTRL_FRCDPX
op_or
multiline_comment|/* Set the Force Duplex Bit */
id|E1000_CTRL_SPD_1000
op_or
multiline_comment|/* Force Speed to 1000 */
id|E1000_CTRL_FD
)paren
suffix:semicolon
multiline_comment|/* Force Duplex to FULL */
id|E1000_WRITE_REG
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|CTRL
comma
id|ctrl_reg
)paren
suffix:semicolon
multiline_comment|/* Read the PHY Specific Control Register (0x10) */
id|e1000_read_phy_reg
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|M88E1000_PHY_SPEC_CTRL
comma
op_amp
id|phy_reg
)paren
suffix:semicolon
multiline_comment|/* Clear Auto-Crossover bits in PHY Specific Control Register&n;&t; * (bits 6:5).&n;&t; */
id|phy_reg
op_and_assign
op_complement
id|M88E1000_PSCR_AUTO_X_MODE
suffix:semicolon
id|e1000_write_phy_reg
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|M88E1000_PHY_SPEC_CTRL
comma
id|phy_reg
)paren
suffix:semicolon
multiline_comment|/* Perform software reset on the PHY */
id|e1000_phy_reset
c_func
(paren
op_amp
id|adapter-&gt;hw
)paren
suffix:semicolon
multiline_comment|/* Have to setup TX_CLK and TX_CRS after software reset */
id|e1000_phy_reset_clk_and_crs
c_func
(paren
id|adapter
)paren
suffix:semicolon
id|e1000_write_phy_reg
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|PHY_CTRL
comma
l_int|0x8100
)paren
suffix:semicolon
multiline_comment|/* Wait for reset to complete. */
id|udelay
c_func
(paren
l_int|500
)paren
suffix:semicolon
multiline_comment|/* Have to setup TX_CLK and TX_CRS after software reset */
id|e1000_phy_reset_clk_and_crs
c_func
(paren
id|adapter
)paren
suffix:semicolon
multiline_comment|/* Write out to PHY registers 29 and 30 to disable the Receiver. */
id|e1000_phy_disable_receiver
c_func
(paren
id|adapter
)paren
suffix:semicolon
multiline_comment|/* Set the loopback bit in the PHY control register. */
id|e1000_read_phy_reg
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|PHY_CTRL
comma
op_amp
id|phy_reg
)paren
suffix:semicolon
id|phy_reg
op_or_assign
id|MII_CR_LOOPBACK
suffix:semicolon
id|e1000_write_phy_reg
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|PHY_CTRL
comma
id|phy_reg
)paren
suffix:semicolon
multiline_comment|/* Setup TX_CLK and TX_CRS one more time. */
id|e1000_phy_reset_clk_and_crs
c_func
(paren
id|adapter
)paren
suffix:semicolon
multiline_comment|/* Check Phy Configuration */
id|e1000_read_phy_reg
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|PHY_CTRL
comma
op_amp
id|phy_reg
)paren
suffix:semicolon
r_if
c_cond
(paren
id|phy_reg
op_ne
l_int|0x4100
)paren
(brace
r_return
l_int|9
suffix:semicolon
)brace
id|e1000_read_phy_reg
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|M88E1000_EXT_PHY_SPEC_CTRL
comma
op_amp
id|phy_reg
)paren
suffix:semicolon
r_if
c_cond
(paren
id|phy_reg
op_ne
l_int|0x0070
)paren
(brace
r_return
l_int|10
suffix:semicolon
)brace
id|e1000_read_phy_reg
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
l_int|29
comma
op_amp
id|phy_reg
)paren
suffix:semicolon
r_if
c_cond
(paren
id|phy_reg
op_ne
l_int|0x001A
)paren
(brace
r_return
l_int|11
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|e1000_integrated_phy_loopback
id|e1000_integrated_phy_loopback
c_func
(paren
r_struct
id|e1000_adapter
op_star
id|adapter
)paren
(brace
r_uint32
id|ctrl_reg
op_assign
l_int|0
suffix:semicolon
r_uint32
id|stat_reg
op_assign
l_int|0
suffix:semicolon
id|adapter-&gt;hw.autoneg
op_assign
id|FALSE
suffix:semicolon
r_if
c_cond
(paren
id|adapter-&gt;hw.phy_type
op_eq
id|e1000_phy_m88
)paren
(brace
multiline_comment|/* Auto-MDI/MDIX Off */
id|e1000_write_phy_reg
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|M88E1000_PHY_SPEC_CTRL
comma
l_int|0x0808
)paren
suffix:semicolon
multiline_comment|/* reset to update Auto-MDI/MDIX */
id|e1000_write_phy_reg
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|PHY_CTRL
comma
l_int|0x9140
)paren
suffix:semicolon
multiline_comment|/* autoneg off */
id|e1000_write_phy_reg
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|PHY_CTRL
comma
l_int|0x8140
)paren
suffix:semicolon
)brace
multiline_comment|/* force 1000, set loopback */
id|e1000_write_phy_reg
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|PHY_CTRL
comma
l_int|0x4140
)paren
suffix:semicolon
multiline_comment|/* Now set up the MAC to the same speed/duplex as the PHY. */
id|ctrl_reg
op_assign
id|E1000_READ_REG
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|CTRL
)paren
suffix:semicolon
id|ctrl_reg
op_and_assign
op_complement
id|E1000_CTRL_SPD_SEL
suffix:semicolon
multiline_comment|/* Clear the speed sel bits */
id|ctrl_reg
op_or_assign
(paren
id|E1000_CTRL_FRCSPD
op_or
multiline_comment|/* Set the Force Speed Bit */
id|E1000_CTRL_FRCDPX
op_or
multiline_comment|/* Set the Force Duplex Bit */
id|E1000_CTRL_SPD_1000
op_or
multiline_comment|/* Force Speed to 1000 */
id|E1000_CTRL_FD
)paren
suffix:semicolon
multiline_comment|/* Force Duplex to FULL */
r_if
c_cond
(paren
id|adapter-&gt;hw.media_type
op_eq
id|e1000_media_type_copper
op_logical_and
id|adapter-&gt;hw.phy_type
op_eq
id|e1000_phy_m88
)paren
(brace
id|ctrl_reg
op_or_assign
id|E1000_CTRL_ILOS
suffix:semicolon
multiline_comment|/* Invert Loss of Signal */
)brace
r_else
(brace
multiline_comment|/* Set the ILOS bit on the fiber Nic is half&n;&t;&t; * duplex link is detected. */
id|stat_reg
op_assign
id|E1000_READ_REG
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|STATUS
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|stat_reg
op_amp
id|E1000_STATUS_FD
)paren
op_eq
l_int|0
)paren
(brace
id|ctrl_reg
op_or_assign
(paren
id|E1000_CTRL_ILOS
op_or
id|E1000_CTRL_SLU
)paren
suffix:semicolon
)brace
)brace
id|E1000_WRITE_REG
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|CTRL
comma
id|ctrl_reg
)paren
suffix:semicolon
multiline_comment|/* Disable the receiver on the PHY so when a cable is plugged in, the&n;&t; * PHY does not begin to autoneg when a cable is reconnected to the NIC.&n;&t; */
r_if
c_cond
(paren
id|adapter-&gt;hw.phy_type
op_eq
id|e1000_phy_m88
)paren
(brace
id|e1000_phy_disable_receiver
c_func
(paren
id|adapter
)paren
suffix:semicolon
)brace
id|udelay
c_func
(paren
l_int|500
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|e1000_set_phy_loopback
id|e1000_set_phy_loopback
c_func
(paren
r_struct
id|e1000_adapter
op_star
id|adapter
)paren
(brace
r_uint16
id|phy_reg
op_assign
l_int|0
suffix:semicolon
r_uint16
id|count
op_assign
l_int|0
suffix:semicolon
r_switch
c_cond
(paren
id|adapter-&gt;hw.mac_type
)paren
(brace
r_case
id|e1000_82543
suffix:colon
r_if
c_cond
(paren
id|adapter-&gt;hw.media_type
op_eq
id|e1000_media_type_copper
)paren
(brace
multiline_comment|/* Attempt to setup Loopback mode on Non-integrated PHY.&n;&t;&t;&t; * Some PHY registers get corrupted at random, so&n;&t;&t;&t; * attempt this 10 times.&n;&t;&t;&t; */
r_while
c_loop
(paren
id|e1000_nonintegrated_phy_loopback
c_func
(paren
id|adapter
)paren
op_logical_and
id|count
op_increment
OL
l_int|10
)paren
(brace
suffix:semicolon
)brace
r_if
c_cond
(paren
id|count
OL
l_int|11
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
)brace
r_break
suffix:semicolon
r_case
id|e1000_82544
suffix:colon
r_case
id|e1000_82540
suffix:colon
r_case
id|e1000_82545
suffix:colon
r_case
id|e1000_82546
suffix:colon
r_case
id|e1000_82541
suffix:colon
r_case
id|e1000_82547
suffix:colon
r_return
id|e1000_integrated_phy_loopback
c_func
(paren
id|adapter
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
multiline_comment|/* Default PHY loopback work is to read the MII&n;&t;&t; * control register and assert bit 14 (loopback mode).&n;&t;&t; */
id|e1000_read_phy_reg
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|PHY_CTRL
comma
op_amp
id|phy_reg
)paren
suffix:semicolon
id|phy_reg
op_or_assign
id|MII_CR_LOOPBACK
suffix:semicolon
id|e1000_write_phy_reg
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|PHY_CTRL
comma
id|phy_reg
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_break
suffix:semicolon
)brace
r_return
l_int|8
suffix:semicolon
)brace
r_static
r_int
DECL|function|e1000_setup_loopback_test
id|e1000_setup_loopback_test
c_func
(paren
r_struct
id|e1000_adapter
op_star
id|adapter
)paren
(brace
r_uint32
id|rctl
suffix:semicolon
r_if
c_cond
(paren
id|adapter-&gt;hw.media_type
op_eq
id|e1000_media_type_fiber
)paren
(brace
r_if
c_cond
(paren
id|adapter-&gt;hw.mac_type
op_eq
id|e1000_82545
op_logical_or
id|adapter-&gt;hw.mac_type
op_eq
id|e1000_82546
)paren
(brace
r_return
id|e1000_set_phy_loopback
c_func
(paren
id|adapter
)paren
suffix:semicolon
)brace
r_else
(brace
id|rctl
op_assign
id|E1000_READ_REG
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|RCTL
)paren
suffix:semicolon
id|rctl
op_or_assign
id|E1000_RCTL_LBM_TCVR
suffix:semicolon
id|E1000_WRITE_REG
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|RCTL
comma
id|rctl
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|adapter-&gt;hw.media_type
op_eq
id|e1000_media_type_copper
)paren
(brace
r_return
id|e1000_set_phy_loopback
c_func
(paren
id|adapter
)paren
suffix:semicolon
)brace
r_return
l_int|7
suffix:semicolon
)brace
r_static
r_void
DECL|function|e1000_loopback_cleanup
id|e1000_loopback_cleanup
c_func
(paren
r_struct
id|e1000_adapter
op_star
id|adapter
)paren
(brace
r_uint32
id|rctl
suffix:semicolon
r_uint16
id|phy_reg
suffix:semicolon
id|rctl
op_assign
id|E1000_READ_REG
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|RCTL
)paren
suffix:semicolon
id|rctl
op_and_assign
op_complement
(paren
id|E1000_RCTL_LBM_TCVR
op_or
id|E1000_RCTL_LBM_MAC
)paren
suffix:semicolon
id|E1000_WRITE_REG
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|RCTL
comma
id|rctl
)paren
suffix:semicolon
r_if
c_cond
(paren
id|adapter-&gt;hw.media_type
op_eq
id|e1000_media_type_copper
op_logical_or
(paren
id|adapter-&gt;hw.media_type
op_eq
id|e1000_media_type_fiber
op_logical_and
(paren
id|adapter-&gt;hw.mac_type
op_eq
id|e1000_82545
op_logical_or
id|adapter-&gt;hw.mac_type
op_eq
id|e1000_82546
)paren
)paren
)paren
(brace
id|adapter-&gt;hw.autoneg
op_assign
id|TRUE
suffix:semicolon
id|e1000_read_phy_reg
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|PHY_CTRL
comma
op_amp
id|phy_reg
)paren
suffix:semicolon
r_if
c_cond
(paren
id|phy_reg
op_amp
id|MII_CR_LOOPBACK
)paren
(brace
id|phy_reg
op_and_assign
op_complement
id|MII_CR_LOOPBACK
suffix:semicolon
id|e1000_write_phy_reg
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|PHY_CTRL
comma
id|phy_reg
)paren
suffix:semicolon
id|e1000_phy_reset
c_func
(paren
op_amp
id|adapter-&gt;hw
)paren
suffix:semicolon
)brace
)brace
)brace
r_static
r_void
DECL|function|e1000_create_lbtest_frame
id|e1000_create_lbtest_frame
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_int
r_int
id|frame_size
)paren
(brace
id|memset
c_func
(paren
id|skb-&gt;data
comma
l_int|0xFF
comma
id|frame_size
)paren
suffix:semicolon
id|frame_size
op_assign
(paren
id|frame_size
op_mod
l_int|2
)paren
ques
c_cond
(paren
id|frame_size
op_minus
l_int|1
)paren
suffix:colon
id|frame_size
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|skb-&gt;data
(braket
id|frame_size
op_div
l_int|2
)braket
comma
l_int|0xAA
comma
id|frame_size
op_div
l_int|2
op_minus
l_int|1
)paren
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|skb-&gt;data
(braket
id|frame_size
op_div
l_int|2
op_plus
l_int|10
)braket
comma
l_int|0xBE
comma
l_int|1
)paren
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|skb-&gt;data
(braket
id|frame_size
op_div
l_int|2
op_plus
l_int|12
)braket
comma
l_int|0xAF
comma
l_int|1
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|e1000_check_lbtest_frame
id|e1000_check_lbtest_frame
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_int
r_int
id|frame_size
)paren
(brace
id|frame_size
op_assign
(paren
id|frame_size
op_mod
l_int|2
)paren
ques
c_cond
(paren
id|frame_size
op_minus
l_int|1
)paren
suffix:colon
id|frame_size
suffix:semicolon
r_if
c_cond
(paren
op_star
(paren
id|skb-&gt;data
op_plus
l_int|3
)paren
op_eq
l_int|0xFF
)paren
(brace
r_if
c_cond
(paren
(paren
op_star
(paren
id|skb-&gt;data
op_plus
id|frame_size
op_div
l_int|2
op_plus
l_int|10
)paren
op_eq
l_int|0xBE
)paren
op_logical_and
(paren
op_star
(paren
id|skb-&gt;data
op_plus
id|frame_size
op_div
l_int|2
op_plus
l_int|12
)paren
op_eq
l_int|0xAF
)paren
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
)brace
r_return
l_int|13
suffix:semicolon
)brace
r_static
r_int
DECL|function|e1000_run_loopback_test
id|e1000_run_loopback_test
c_func
(paren
r_struct
id|e1000_adapter
op_star
id|adapter
)paren
(brace
r_struct
id|e1000_desc_ring
op_star
id|txdr
op_assign
op_amp
id|adapter-&gt;test_tx_ring
suffix:semicolon
r_struct
id|e1000_desc_ring
op_star
id|rxdr
op_assign
op_amp
id|adapter-&gt;test_rx_ring
suffix:semicolon
r_struct
id|pci_dev
op_star
id|pdev
op_assign
id|adapter-&gt;pdev
suffix:semicolon
r_int
id|i
suffix:semicolon
id|E1000_WRITE_REG
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|RDT
comma
id|rxdr-&gt;count
op_minus
l_int|1
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|64
suffix:semicolon
id|i
op_increment
)paren
(brace
id|e1000_create_lbtest_frame
c_func
(paren
id|txdr-&gt;buffer_info
(braket
id|i
)braket
dot
id|skb
comma
l_int|1024
)paren
suffix:semicolon
id|pci_dma_sync_single
c_func
(paren
id|pdev
comma
id|txdr-&gt;buffer_info
(braket
id|i
)braket
dot
id|dma
comma
id|txdr-&gt;buffer_info
(braket
id|i
)braket
dot
id|length
comma
id|PCI_DMA_TODEVICE
)paren
suffix:semicolon
)brace
id|E1000_WRITE_REG
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|TDT
comma
id|i
)paren
suffix:semicolon
id|msec_delay
c_func
(paren
l_int|200
)paren
suffix:semicolon
id|pci_dma_sync_single
c_func
(paren
id|pdev
comma
id|rxdr-&gt;buffer_info
(braket
l_int|0
)braket
dot
id|dma
comma
id|rxdr-&gt;buffer_info
(braket
l_int|0
)braket
dot
id|length
comma
id|PCI_DMA_FROMDEVICE
)paren
suffix:semicolon
r_return
id|e1000_check_lbtest_frame
c_func
(paren
id|rxdr-&gt;buffer_info
(braket
l_int|0
)braket
dot
id|skb
comma
l_int|1024
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|e1000_loopback_test
id|e1000_loopback_test
c_func
(paren
r_struct
id|e1000_adapter
op_star
id|adapter
comma
r_uint64
op_star
id|data
)paren
(brace
r_if
c_cond
(paren
(paren
op_star
id|data
op_assign
id|e1000_setup_desc_rings
c_func
(paren
id|adapter
)paren
)paren
)paren
(brace
r_goto
id|err_loopback
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
op_star
id|data
op_assign
id|e1000_setup_loopback_test
c_func
(paren
id|adapter
)paren
)paren
)paren
(brace
r_goto
id|err_loopback
suffix:semicolon
)brace
op_star
id|data
op_assign
id|e1000_run_loopback_test
c_func
(paren
id|adapter
)paren
suffix:semicolon
id|e1000_loopback_cleanup
c_func
(paren
id|adapter
)paren
suffix:semicolon
id|e1000_free_desc_rings
c_func
(paren
id|adapter
)paren
suffix:semicolon
id|err_loopback
suffix:colon
r_return
op_star
id|data
suffix:semicolon
)brace
r_static
r_int
DECL|function|e1000_link_test
id|e1000_link_test
c_func
(paren
r_struct
id|e1000_adapter
op_star
id|adapter
comma
r_uint64
op_star
id|data
)paren
(brace
op_star
id|data
op_assign
l_int|0
suffix:semicolon
id|e1000_check_for_link
c_func
(paren
op_amp
id|adapter-&gt;hw
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|E1000_READ_REG
c_func
(paren
op_amp
id|adapter-&gt;hw
comma
id|STATUS
)paren
op_amp
id|E1000_STATUS_LU
)paren
)paren
(brace
op_star
id|data
op_assign
l_int|1
suffix:semicolon
)brace
r_return
op_star
id|data
suffix:semicolon
)brace
r_static
r_int
DECL|function|e1000_ethtool_test
id|e1000_ethtool_test
c_func
(paren
r_struct
id|e1000_adapter
op_star
id|adapter
comma
r_struct
id|ethtool_test
op_star
id|eth_test
comma
r_uint64
op_star
id|data
)paren
(brace
id|boolean_t
id|if_running
op_assign
id|netif_running
c_func
(paren
id|adapter-&gt;netdev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|eth_test-&gt;flags
op_eq
id|ETH_TEST_FL_OFFLINE
)paren
(brace
multiline_comment|/* Offline tests */
multiline_comment|/* Link test performed before hardware reset so autoneg doesn&squot;t&n;&t;&t; * interfere with test result */
r_if
c_cond
(paren
id|e1000_link_test
c_func
(paren
id|adapter
comma
op_amp
id|data
(braket
l_int|4
)braket
)paren
)paren
(brace
id|eth_test-&gt;flags
op_or_assign
id|ETH_TEST_FL_FAILED
suffix:semicolon
)brace
r_if
c_cond
(paren
id|if_running
)paren
(brace
id|e1000_down
c_func
(paren
id|adapter
)paren
suffix:semicolon
)brace
id|e1000_reset
c_func
(paren
id|adapter
)paren
suffix:semicolon
r_if
c_cond
(paren
id|e1000_reg_test
c_func
(paren
id|adapter
comma
op_amp
id|data
(braket
l_int|0
)braket
)paren
)paren
(brace
id|eth_test-&gt;flags
op_or_assign
id|ETH_TEST_FL_FAILED
suffix:semicolon
)brace
id|e1000_reset
c_func
(paren
id|adapter
)paren
suffix:semicolon
r_if
c_cond
(paren
id|e1000_eeprom_test
c_func
(paren
id|adapter
comma
op_amp
id|data
(braket
l_int|1
)braket
)paren
)paren
(brace
id|eth_test-&gt;flags
op_or_assign
id|ETH_TEST_FL_FAILED
suffix:semicolon
)brace
id|e1000_reset
c_func
(paren
id|adapter
)paren
suffix:semicolon
r_if
c_cond
(paren
id|e1000_intr_test
c_func
(paren
id|adapter
comma
op_amp
id|data
(braket
l_int|2
)braket
)paren
)paren
(brace
id|eth_test-&gt;flags
op_or_assign
id|ETH_TEST_FL_FAILED
suffix:semicolon
)brace
id|e1000_reset
c_func
(paren
id|adapter
)paren
suffix:semicolon
r_if
c_cond
(paren
id|e1000_loopback_test
c_func
(paren
id|adapter
comma
op_amp
id|data
(braket
l_int|3
)braket
)paren
)paren
(brace
id|eth_test-&gt;flags
op_or_assign
id|ETH_TEST_FL_FAILED
suffix:semicolon
)brace
id|e1000_reset
c_func
(paren
id|adapter
)paren
suffix:semicolon
r_if
c_cond
(paren
id|if_running
)paren
(brace
id|e1000_up
c_func
(paren
id|adapter
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
multiline_comment|/* Online tests */
r_if
c_cond
(paren
id|e1000_link_test
c_func
(paren
id|adapter
comma
op_amp
id|data
(braket
l_int|4
)braket
)paren
)paren
(brace
id|eth_test-&gt;flags
op_or_assign
id|ETH_TEST_FL_FAILED
suffix:semicolon
)brace
multiline_comment|/* Offline tests aren&squot;t run; pass by default */
id|data
(braket
l_int|0
)braket
op_assign
l_int|0
suffix:semicolon
id|data
(braket
l_int|1
)braket
op_assign
l_int|0
suffix:semicolon
id|data
(braket
l_int|2
)braket
op_assign
l_int|0
suffix:semicolon
id|data
(braket
l_int|3
)braket
op_assign
l_int|0
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_void
DECL|function|e1000_ethtool_gwol
id|e1000_ethtool_gwol
c_func
(paren
r_struct
id|e1000_adapter
op_star
id|adapter
comma
r_struct
id|ethtool_wolinfo
op_star
id|wol
)paren
(brace
r_struct
id|e1000_hw
op_star
id|hw
op_assign
op_amp
id|adapter-&gt;hw
suffix:semicolon
r_switch
c_cond
(paren
id|adapter-&gt;hw.device_id
)paren
(brace
r_case
id|E1000_DEV_ID_82542
suffix:colon
r_case
id|E1000_DEV_ID_82543GC_FIBER
suffix:colon
r_case
id|E1000_DEV_ID_82543GC_COPPER
suffix:colon
r_case
id|E1000_DEV_ID_82544EI_FIBER
suffix:colon
id|wol-&gt;supported
op_assign
l_int|0
suffix:semicolon
id|wol-&gt;wolopts
op_assign
l_int|0
suffix:semicolon
r_return
suffix:semicolon
r_case
id|E1000_DEV_ID_82546EB_FIBER
suffix:colon
multiline_comment|/* Wake events only supported on port A for dual fiber */
r_if
c_cond
(paren
id|E1000_READ_REG
c_func
(paren
id|hw
comma
id|STATUS
)paren
op_amp
id|E1000_STATUS_FUNC_1
)paren
(brace
id|wol-&gt;supported
op_assign
l_int|0
suffix:semicolon
id|wol-&gt;wolopts
op_assign
l_int|0
suffix:semicolon
r_return
suffix:semicolon
)brace
multiline_comment|/* Fall Through */
r_default
suffix:colon
id|wol-&gt;supported
op_assign
id|WAKE_UCAST
op_or
id|WAKE_MCAST
op_or
id|WAKE_BCAST
op_or
id|WAKE_MAGIC
suffix:semicolon
id|wol-&gt;wolopts
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|adapter-&gt;wol
op_amp
id|E1000_WUFC_EX
)paren
(brace
id|wol-&gt;wolopts
op_or_assign
id|WAKE_UCAST
suffix:semicolon
)brace
r_if
c_cond
(paren
id|adapter-&gt;wol
op_amp
id|E1000_WUFC_MC
)paren
(brace
id|wol-&gt;wolopts
op_or_assign
id|WAKE_MCAST
suffix:semicolon
)brace
r_if
c_cond
(paren
id|adapter-&gt;wol
op_amp
id|E1000_WUFC_BC
)paren
(brace
id|wol-&gt;wolopts
op_or_assign
id|WAKE_BCAST
suffix:semicolon
)brace
r_if
c_cond
(paren
id|adapter-&gt;wol
op_amp
id|E1000_WUFC_MAG
)paren
(brace
id|wol-&gt;wolopts
op_or_assign
id|WAKE_MAGIC
suffix:semicolon
)brace
r_return
suffix:semicolon
)brace
)brace
r_static
r_int
DECL|function|e1000_ethtool_swol
id|e1000_ethtool_swol
c_func
(paren
r_struct
id|e1000_adapter
op_star
id|adapter
comma
r_struct
id|ethtool_wolinfo
op_star
id|wol
)paren
(brace
r_struct
id|e1000_hw
op_star
id|hw
op_assign
op_amp
id|adapter-&gt;hw
suffix:semicolon
r_switch
c_cond
(paren
id|adapter-&gt;hw.device_id
)paren
(brace
r_case
id|E1000_DEV_ID_82542
suffix:colon
r_case
id|E1000_DEV_ID_82543GC_FIBER
suffix:colon
r_case
id|E1000_DEV_ID_82543GC_COPPER
suffix:colon
r_case
id|E1000_DEV_ID_82544EI_FIBER
suffix:colon
r_return
id|wol-&gt;wolopts
ques
c_cond
op_minus
id|EOPNOTSUPP
suffix:colon
l_int|0
suffix:semicolon
r_case
id|E1000_DEV_ID_82546EB_FIBER
suffix:colon
multiline_comment|/* Wake events only supported on port A for dual fiber */
r_if
c_cond
(paren
id|E1000_READ_REG
c_func
(paren
id|hw
comma
id|STATUS
)paren
op_amp
id|E1000_STATUS_FUNC_1
)paren
(brace
r_return
id|wol-&gt;wolopts
ques
c_cond
op_minus
id|EOPNOTSUPP
suffix:colon
l_int|0
suffix:semicolon
)brace
multiline_comment|/* Fall Through */
r_default
suffix:colon
(brace
)brace
r_if
c_cond
(paren
id|wol-&gt;wolopts
op_amp
(paren
id|WAKE_PHY
op_or
id|WAKE_ARP
op_or
id|WAKE_MAGICSECURE
)paren
)paren
(brace
r_return
op_minus
id|EOPNOTSUPP
suffix:semicolon
)brace
id|adapter-&gt;wol
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|wol-&gt;wolopts
op_amp
id|WAKE_UCAST
)paren
(brace
id|adapter-&gt;wol
op_or_assign
id|E1000_WUFC_EX
suffix:semicolon
)brace
r_if
c_cond
(paren
id|wol-&gt;wolopts
op_amp
id|WAKE_MCAST
)paren
(brace
id|adapter-&gt;wol
op_or_assign
id|E1000_WUFC_MC
suffix:semicolon
)brace
r_if
c_cond
(paren
id|wol-&gt;wolopts
op_amp
id|WAKE_BCAST
)paren
(brace
id|adapter-&gt;wol
op_or_assign
id|E1000_WUFC_BC
suffix:semicolon
)brace
r_if
c_cond
(paren
id|wol-&gt;wolopts
op_amp
id|WAKE_MAGIC
)paren
(brace
id|adapter-&gt;wol
op_or_assign
id|E1000_WUFC_MAG
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* toggle LED 4 times per second = 2 &quot;blinks&quot; per second */
DECL|macro|E1000_ID_INTERVAL
mdefine_line|#define E1000_ID_INTERVAL&t;(HZ/4)
multiline_comment|/* bit defines for adapter-&gt;led_status */
DECL|macro|E1000_LED_ON
mdefine_line|#define E1000_LED_ON&t;&t;0
r_static
r_void
DECL|function|e1000_led_blink_callback
id|e1000_led_blink_callback
c_func
(paren
r_int
r_int
id|data
)paren
(brace
r_struct
id|e1000_adapter
op_star
id|adapter
op_assign
(paren
r_struct
id|e1000_adapter
op_star
)paren
id|data
suffix:semicolon
r_if
c_cond
(paren
id|test_and_change_bit
c_func
(paren
id|E1000_LED_ON
comma
op_amp
id|adapter-&gt;led_status
)paren
)paren
(brace
id|e1000_led_off
c_func
(paren
op_amp
id|adapter-&gt;hw
)paren
suffix:semicolon
)brace
r_else
id|e1000_led_on
c_func
(paren
op_amp
id|adapter-&gt;hw
)paren
suffix:semicolon
id|mod_timer
c_func
(paren
op_amp
id|adapter-&gt;blink_timer
comma
id|jiffies
op_plus
id|E1000_ID_INTERVAL
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|e1000_ethtool_led_blink
id|e1000_ethtool_led_blink
c_func
(paren
r_struct
id|e1000_adapter
op_star
id|adapter
comma
r_struct
id|ethtool_value
op_star
id|id
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|adapter-&gt;blink_timer.function
)paren
(brace
id|init_timer
c_func
(paren
op_amp
id|adapter-&gt;blink_timer
)paren
suffix:semicolon
id|adapter-&gt;blink_timer.function
op_assign
id|e1000_led_blink_callback
suffix:semicolon
id|adapter-&gt;blink_timer.data
op_assign
(paren
r_int
r_int
)paren
id|adapter
suffix:semicolon
)brace
id|e1000_setup_led
c_func
(paren
op_amp
id|adapter-&gt;hw
)paren
suffix:semicolon
id|mod_timer
c_func
(paren
op_amp
id|adapter-&gt;blink_timer
comma
id|jiffies
)paren
suffix:semicolon
id|set_current_state
c_func
(paren
id|TASK_INTERRUPTIBLE
)paren
suffix:semicolon
r_if
c_cond
(paren
id|id-&gt;data
)paren
(brace
id|schedule_timeout
c_func
(paren
id|id-&gt;data
op_star
id|HZ
)paren
suffix:semicolon
)brace
r_else
id|schedule_timeout
c_func
(paren
id|MAX_SCHEDULE_TIMEOUT
)paren
suffix:semicolon
id|del_timer_sync
c_func
(paren
op_amp
id|adapter-&gt;blink_timer
)paren
suffix:semicolon
id|e1000_led_off
c_func
(paren
op_amp
id|adapter-&gt;hw
)paren
suffix:semicolon
id|clear_bit
c_func
(paren
id|E1000_LED_ON
comma
op_amp
id|adapter-&gt;led_status
)paren
suffix:semicolon
id|e1000_cleanup_led
c_func
(paren
op_amp
id|adapter-&gt;hw
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_int
DECL|function|e1000_ethtool_ioctl
id|e1000_ethtool_ioctl
c_func
(paren
r_struct
id|net_device
op_star
id|netdev
comma
r_struct
id|ifreq
op_star
id|ifr
)paren
(brace
r_struct
id|e1000_adapter
op_star
id|adapter
op_assign
id|netdev-&gt;priv
suffix:semicolon
r_void
op_star
id|addr
op_assign
id|ifr-&gt;ifr_data
suffix:semicolon
r_uint32
id|cmd
suffix:semicolon
r_if
c_cond
(paren
id|get_user
c_func
(paren
id|cmd
comma
(paren
r_uint32
op_star
)paren
id|addr
)paren
)paren
(brace
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|ETHTOOL_GSET
suffix:colon
(brace
r_struct
id|ethtool_cmd
id|ecmd
op_assign
(brace
id|ETHTOOL_GSET
)brace
suffix:semicolon
id|e1000_ethtool_gset
c_func
(paren
id|adapter
comma
op_amp
id|ecmd
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|addr
comma
op_amp
id|ecmd
comma
r_sizeof
(paren
id|ecmd
)paren
)paren
)paren
(brace
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
r_case
id|ETHTOOL_SSET
suffix:colon
(brace
r_struct
id|ethtool_cmd
id|ecmd
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|capable
c_func
(paren
id|CAP_NET_ADMIN
)paren
)paren
(brace
r_return
op_minus
id|EPERM
suffix:semicolon
)brace
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|ecmd
comma
id|addr
comma
r_sizeof
(paren
id|ecmd
)paren
)paren
)paren
(brace
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
r_return
id|e1000_ethtool_sset
c_func
(paren
id|adapter
comma
op_amp
id|ecmd
)paren
suffix:semicolon
)brace
r_case
id|ETHTOOL_GDRVINFO
suffix:colon
(brace
r_struct
id|ethtool_drvinfo
id|drvinfo
op_assign
(brace
id|ETHTOOL_GDRVINFO
)brace
suffix:semicolon
id|e1000_ethtool_gdrvinfo
c_func
(paren
id|adapter
comma
op_amp
id|drvinfo
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|addr
comma
op_amp
id|drvinfo
comma
r_sizeof
(paren
id|drvinfo
)paren
)paren
)paren
(brace
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
r_case
id|ETHTOOL_GSTRINGS
suffix:colon
(brace
r_struct
id|ethtool_gstrings
id|gstrings
op_assign
(brace
id|ETHTOOL_GSTRINGS
)brace
suffix:semicolon
r_char
op_star
id|strings
op_assign
l_int|NULL
suffix:semicolon
r_int
id|err
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|gstrings
comma
id|addr
comma
r_sizeof
(paren
id|gstrings
)paren
)paren
)paren
(brace
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|gstrings.string_set
)paren
(brace
r_case
id|ETH_SS_TEST
suffix:colon
id|gstrings.len
op_assign
id|E1000_TEST_LEN
suffix:semicolon
id|strings
op_assign
id|kmalloc
c_func
(paren
id|E1000_TEST_LEN
op_star
id|ETH_GSTRING_LEN
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strings
)paren
(brace
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|strings
comma
id|e1000_gstrings_test
comma
id|E1000_TEST_LEN
op_star
id|ETH_GSTRING_LEN
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ETH_SS_STATS
suffix:colon
(brace
r_int
id|i
suffix:semicolon
id|gstrings.len
op_assign
id|E1000_STATS_LEN
suffix:semicolon
id|strings
op_assign
id|kmalloc
c_func
(paren
id|E1000_STATS_LEN
op_star
id|ETH_GSTRING_LEN
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strings
)paren
(brace
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|E1000_STATS_LEN
suffix:semicolon
id|i
op_increment
)paren
(brace
id|memcpy
c_func
(paren
op_amp
id|strings
(braket
id|i
op_star
id|ETH_GSTRING_LEN
)braket
comma
id|e1000_gstrings_stats
(braket
id|i
)braket
dot
id|stat_string
comma
id|ETH_GSTRING_LEN
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
)brace
r_default
suffix:colon
r_return
op_minus
id|EOPNOTSUPP
suffix:semicolon
)brace
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|addr
comma
op_amp
id|gstrings
comma
r_sizeof
(paren
id|gstrings
)paren
)paren
)paren
(brace
id|err
op_assign
op_minus
id|EFAULT
suffix:semicolon
)brace
id|addr
op_add_assign
m_offsetof
(paren
r_struct
id|ethtool_gstrings
comma
id|data
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|err
op_logical_and
id|copy_to_user
c_func
(paren
id|addr
comma
id|strings
comma
id|gstrings.len
op_star
id|ETH_GSTRING_LEN
)paren
)paren
(brace
id|err
op_assign
op_minus
id|EFAULT
suffix:semicolon
)brace
id|kfree
c_func
(paren
id|strings
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
r_case
id|ETHTOOL_GREGS
suffix:colon
(brace
r_struct
id|ethtool_regs
id|regs
op_assign
(brace
id|ETHTOOL_GREGS
)brace
suffix:semicolon
r_uint32
id|regs_buff
(braket
id|E1000_REGS_LEN
)braket
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|regs
comma
id|addr
comma
r_sizeof
(paren
id|regs
)paren
)paren
)paren
(brace
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
id|e1000_ethtool_gregs
c_func
(paren
id|adapter
comma
op_amp
id|regs
comma
id|regs_buff
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|addr
comma
op_amp
id|regs
comma
r_sizeof
(paren
id|regs
)paren
)paren
)paren
(brace
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
id|addr
op_add_assign
m_offsetof
(paren
r_struct
id|ethtool_regs
comma
id|data
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|addr
comma
id|regs_buff
comma
id|regs.len
)paren
)paren
(brace
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
r_case
id|ETHTOOL_NWAY_RST
suffix:colon
(brace
r_if
c_cond
(paren
op_logical_neg
id|capable
c_func
(paren
id|CAP_NET_ADMIN
)paren
)paren
(brace
r_return
op_minus
id|EPERM
suffix:semicolon
)brace
r_if
c_cond
(paren
id|netif_running
c_func
(paren
id|netdev
)paren
)paren
(brace
id|e1000_down
c_func
(paren
id|adapter
)paren
suffix:semicolon
id|e1000_up
c_func
(paren
id|adapter
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
r_case
id|ETHTOOL_PHYS_ID
suffix:colon
(brace
r_struct
id|ethtool_value
id|id
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|id
comma
id|addr
comma
r_sizeof
(paren
id|id
)paren
)paren
)paren
(brace
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
r_return
id|e1000_ethtool_led_blink
c_func
(paren
id|adapter
comma
op_amp
id|id
)paren
suffix:semicolon
)brace
r_case
id|ETHTOOL_GLINK
suffix:colon
(brace
r_struct
id|ethtool_value
id|link
op_assign
(brace
id|ETHTOOL_GLINK
)brace
suffix:semicolon
id|link.data
op_assign
id|netif_carrier_ok
c_func
(paren
id|netdev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|addr
comma
op_amp
id|link
comma
r_sizeof
(paren
id|link
)paren
)paren
)paren
(brace
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
r_case
id|ETHTOOL_GWOL
suffix:colon
(brace
r_struct
id|ethtool_wolinfo
id|wol
op_assign
(brace
id|ETHTOOL_GWOL
)brace
suffix:semicolon
id|e1000_ethtool_gwol
c_func
(paren
id|adapter
comma
op_amp
id|wol
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|addr
comma
op_amp
id|wol
comma
r_sizeof
(paren
id|wol
)paren
)paren
op_ne
l_int|0
)paren
(brace
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
r_case
id|ETHTOOL_SWOL
suffix:colon
(brace
r_struct
id|ethtool_wolinfo
id|wol
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|capable
c_func
(paren
id|CAP_NET_ADMIN
)paren
)paren
(brace
r_return
op_minus
id|EPERM
suffix:semicolon
)brace
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|wol
comma
id|addr
comma
r_sizeof
(paren
id|wol
)paren
)paren
op_ne
l_int|0
)paren
(brace
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
r_return
id|e1000_ethtool_swol
c_func
(paren
id|adapter
comma
op_amp
id|wol
)paren
suffix:semicolon
)brace
r_case
id|ETHTOOL_GEEPROM
suffix:colon
(brace
r_struct
id|ethtool_eeprom
id|eeprom
op_assign
(brace
id|ETHTOOL_GEEPROM
)brace
suffix:semicolon
r_struct
id|e1000_hw
op_star
id|hw
op_assign
op_amp
id|adapter-&gt;hw
suffix:semicolon
r_uint16
op_star
id|eeprom_buff
suffix:semicolon
r_void
op_star
id|ptr
suffix:semicolon
r_int
id|err
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|eeprom
comma
id|addr
comma
r_sizeof
(paren
id|eeprom
)paren
)paren
)paren
(brace
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
id|eeprom_buff
op_assign
id|kmalloc
c_func
(paren
id|hw-&gt;eeprom.word_size
op_star
l_int|2
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|eeprom_buff
)paren
(brace
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|e1000_ethtool_geeprom
c_func
(paren
id|adapter
comma
op_amp
id|eeprom
comma
id|eeprom_buff
)paren
)paren
)paren
(brace
r_goto
id|err_geeprom_ioctl
suffix:semicolon
)brace
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|addr
comma
op_amp
id|eeprom
comma
r_sizeof
(paren
id|eeprom
)paren
)paren
)paren
(brace
id|err
op_assign
op_minus
id|EFAULT
suffix:semicolon
r_goto
id|err_geeprom_ioctl
suffix:semicolon
)brace
id|addr
op_add_assign
m_offsetof
(paren
r_struct
id|ethtool_eeprom
comma
id|data
)paren
suffix:semicolon
id|ptr
op_assign
(paren
(paren
r_void
op_star
)paren
id|eeprom_buff
)paren
op_plus
(paren
id|eeprom.offset
op_amp
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|addr
comma
id|ptr
comma
id|eeprom.len
)paren
)paren
(brace
id|err
op_assign
op_minus
id|EFAULT
suffix:semicolon
)brace
id|err_geeprom_ioctl
suffix:colon
id|kfree
c_func
(paren
id|eeprom_buff
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
r_case
id|ETHTOOL_SEEPROM
suffix:colon
(brace
r_struct
id|ethtool_eeprom
id|eeprom
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|capable
c_func
(paren
id|CAP_NET_ADMIN
)paren
)paren
(brace
r_return
op_minus
id|EPERM
suffix:semicolon
)brace
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|eeprom
comma
id|addr
comma
r_sizeof
(paren
id|eeprom
)paren
)paren
)paren
(brace
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
id|addr
op_add_assign
m_offsetof
(paren
r_struct
id|ethtool_eeprom
comma
id|data
)paren
suffix:semicolon
r_return
id|e1000_ethtool_seeprom
c_func
(paren
id|adapter
comma
op_amp
id|eeprom
comma
id|addr
)paren
suffix:semicolon
)brace
r_case
id|ETHTOOL_GSTATS
suffix:colon
(brace
r_struct
(brace
r_struct
id|ethtool_stats
id|eth_stats
suffix:semicolon
r_uint64
id|data
(braket
id|E1000_STATS_LEN
)braket
suffix:semicolon
)brace
id|stats
op_assign
(brace
(brace
id|ETHTOOL_GSTATS
comma
id|E1000_STATS_LEN
)brace
)brace
suffix:semicolon
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|E1000_STATS_LEN
suffix:semicolon
id|i
op_increment
)paren
(brace
id|stats.data
(braket
id|i
)braket
op_assign
(paren
id|e1000_gstrings_stats
(braket
id|i
)braket
dot
id|sizeof_stat
op_eq
r_sizeof
(paren
r_uint64
)paren
)paren
ques
c_cond
op_star
(paren
r_uint64
op_star
)paren
(paren
(paren
r_char
op_star
)paren
id|adapter
op_plus
id|e1000_gstrings_stats
(braket
id|i
)braket
dot
id|stat_offset
)paren
suffix:colon
op_star
(paren
r_uint32
op_star
)paren
(paren
(paren
r_char
op_star
)paren
id|adapter
op_plus
id|e1000_gstrings_stats
(braket
id|i
)braket
dot
id|stat_offset
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|addr
comma
op_amp
id|stats
comma
r_sizeof
(paren
id|stats
)paren
)paren
)paren
(brace
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
r_case
id|ETHTOOL_TEST
suffix:colon
(brace
r_struct
(brace
r_struct
id|ethtool_test
id|eth_test
suffix:semicolon
r_uint64
id|data
(braket
id|E1000_TEST_LEN
)braket
suffix:semicolon
)brace
id|test
op_assign
(brace
(brace
id|ETHTOOL_TEST
)brace
)brace
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|capable
c_func
(paren
id|CAP_NET_ADMIN
)paren
)paren
(brace
r_return
op_minus
id|EPERM
suffix:semicolon
)brace
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|test.eth_test
comma
id|addr
comma
r_sizeof
(paren
id|test.eth_test
)paren
)paren
)paren
(brace
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
id|test.eth_test.len
op_assign
id|E1000_TEST_LEN
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|e1000_ethtool_test
c_func
(paren
id|adapter
comma
op_amp
id|test.eth_test
comma
id|test.data
)paren
)paren
)paren
(brace
r_return
id|err
suffix:semicolon
)brace
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|addr
comma
op_amp
id|test
comma
r_sizeof
(paren
id|test
)paren
)paren
op_ne
l_int|0
)paren
(brace
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
r_default
suffix:colon
r_return
op_minus
id|EOPNOTSUPP
suffix:semicolon
)brace
)brace
eof
