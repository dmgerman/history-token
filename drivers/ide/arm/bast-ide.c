multiline_comment|/* linux/drivers/ide/arm/bast-ide.c&n; *&n; * Copyright (c) 2003-2004 Simtec Electronics&n; *  Ben Dooks &lt;ben@simtec.co.uk&gt;&n; *&n; * This program is free software; you can redistribute it and/or modify&n; * it under the terms of the GNU General Public License version 2 as&n; * published by the Free Software Foundation.&n; *&n;*/
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/errno.h&gt;
macro_line|#include &lt;linux/ide.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;asm/mach-types.h&gt;
macro_line|#include &lt;asm/io.h&gt;
macro_line|#include &lt;asm/irq.h&gt;
macro_line|#include &lt;asm/arch/map.h&gt;
macro_line|#include &lt;asm/arch/bast-map.h&gt;
macro_line|#include &lt;asm/arch/bast-irq.h&gt;
multiline_comment|/* list of registered interfaces */
DECL|variable|ifs
r_static
id|ide_hwif_t
op_star
id|ifs
(braket
l_int|2
)braket
suffix:semicolon
r_static
r_int
id|__init
DECL|function|bastide_register
id|bastide_register
c_func
(paren
r_int
r_int
id|base
comma
r_int
r_int
id|aux
comma
r_int
id|irq
comma
id|ide_hwif_t
op_star
op_star
id|hwif
)paren
(brace
id|hw_regs_t
id|hw
suffix:semicolon
r_int
id|i
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|hw
comma
l_int|0
comma
r_sizeof
(paren
id|hw
)paren
)paren
suffix:semicolon
id|base
op_add_assign
id|BAST_IDE_CS
suffix:semicolon
id|aux
op_add_assign
id|BAST_IDE_CS
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
id|IDE_DATA_OFFSET
suffix:semicolon
id|i
op_le
id|IDE_STATUS_OFFSET
suffix:semicolon
id|i
op_increment
)paren
(brace
id|hw.io_ports
(braket
id|i
)braket
op_assign
(paren
r_int
r_int
)paren
id|base
suffix:semicolon
id|base
op_add_assign
l_int|0x20
suffix:semicolon
)brace
id|hw.io_ports
(braket
id|IDE_CONTROL_OFFSET
)braket
op_assign
id|aux
op_plus
(paren
l_int|6
op_star
l_int|0x20
)paren
suffix:semicolon
id|hw.irq
op_assign
id|irq
suffix:semicolon
id|ide_register_hw
c_func
(paren
op_amp
id|hw
comma
id|hwif
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|bastide_init
r_static
r_int
id|__init
id|bastide_init
c_func
(paren
r_void
)paren
(brace
multiline_comment|/* we can treat the VR1000 and the BAST the same */
r_if
c_cond
(paren
op_logical_neg
(paren
id|machine_is_bast
c_func
(paren
)paren
op_logical_or
id|machine_is_vr1000
c_func
(paren
)paren
)paren
)paren
r_return
l_int|0
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;BAST: IDE driver, (c) 2003-2004 Simtec Electronics&bslash;n&quot;
)paren
suffix:semicolon
id|bastide_register
c_func
(paren
id|BAST_VA_IDEPRI
comma
id|BAST_VA_IDEPRIAUX
comma
id|IRQ_IDE0
comma
op_amp
id|ifs
(braket
l_int|0
)braket
)paren
suffix:semicolon
id|bastide_register
c_func
(paren
id|BAST_VA_IDESEC
comma
id|BAST_VA_IDESECAUX
comma
id|IRQ_IDE1
comma
op_amp
id|ifs
(braket
l_int|1
)braket
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|bastide_init
id|module_init
c_func
(paren
id|bastide_init
)paren
suffix:semicolon
id|MODULE_AUTHOR
c_func
(paren
l_string|&quot;Ben Dooks &lt;ben@simtec.co.uk&gt;&quot;
)paren
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
id|MODULE_DESCRIPTION
c_func
(paren
l_string|&quot;Simtec BAST / Thorcom VR1000 IDE driver&quot;
)paren
suffix:semicolon
eof
