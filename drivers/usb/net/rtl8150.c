multiline_comment|/*&n; * Copyright (c) 2002 Petko Manolov (petkan@users.sourceforge.net)&n; *&n; *&t;This program is free software; you can redistribute it and/or&n; *&t;modify it under the terms of the GNU General Public License as&n; *&t;published by the Free Software Foundation; either version 2 of&n; *&t;the License, or (at your option) any later version.&n; *&n; */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/signal.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/netdevice.h&gt;
macro_line|#include &lt;linux/etherdevice.h&gt;
macro_line|#include &lt;linux/mii.h&gt;
macro_line|#include &lt;linux/ethtool.h&gt;
macro_line|#include &lt;linux/devfs_fs_kernel.h&gt;
macro_line|#include &lt;linux/usb.h&gt;
macro_line|#include &lt;asm/uaccess.h&gt;
multiline_comment|/* Version Information */
DECL|macro|DRIVER_VERSION
mdefine_line|#define DRIVER_VERSION &quot;v0.5.3 (2002/04/08)&quot;
DECL|macro|DRIVER_AUTHOR
mdefine_line|#define DRIVER_AUTHOR &quot;Petko Manolov &lt;petkan@users.sourceforge.net&gt;&quot;
DECL|macro|DRIVER_DESC
mdefine_line|#define DRIVER_DESC &quot;rtl8150 based usb-ethernet driver&quot;
DECL|macro|IRD
mdefine_line|#define&t;IRD&t;&t;&t;0x0120
DECL|macro|MAR
mdefine_line|#define&t;MAR&t;&t;&t;0x0126
DECL|macro|CR
mdefine_line|#define&t;CR&t;&t;&t;0x012e
DECL|macro|TCR
mdefine_line|#define&t;TCR&t;&t;&t;0x012f
DECL|macro|RCR
mdefine_line|#define&t;RCR&t;&t;&t;0x0130
DECL|macro|TSR
mdefine_line|#define&t;TSR&t;&t;&t;0x0132
DECL|macro|RSR
mdefine_line|#define&t;RSR&t;&t;&t;0x0133
DECL|macro|CON0
mdefine_line|#define&t;CON0&t;&t;&t;0x0135
DECL|macro|CON1
mdefine_line|#define&t;CON1&t;&t;&t;0x0136
DECL|macro|MSR
mdefine_line|#define&t;MSR&t;&t;&t;0x0137
DECL|macro|PHYADD
mdefine_line|#define&t;PHYADD&t;&t;&t;0x0138
DECL|macro|PHYDAT
mdefine_line|#define&t;PHYDAT&t;&t;&t;0x0139
DECL|macro|PHYCNT
mdefine_line|#define&t;PHYCNT&t;&t;&t;0x013b
DECL|macro|GPPC
mdefine_line|#define&t;GPPC&t;&t;&t;0x013d
DECL|macro|BMCR
mdefine_line|#define&t;BMCR&t;&t;&t;0x0140
DECL|macro|BMSR
mdefine_line|#define&t;BMSR&t;&t;&t;0x0142
DECL|macro|ANAR
mdefine_line|#define&t;ANAR&t;&t;&t;0x0144
DECL|macro|ANLP
mdefine_line|#define&t;ANLP&t;&t;&t;0x0146
DECL|macro|AER
mdefine_line|#define&t;AER&t;&t;&t;0x0148
DECL|macro|PHY_READ
mdefine_line|#define&t;PHY_READ&t;&t;0
DECL|macro|PHY_WRITE
mdefine_line|#define&t;PHY_WRITE&t;&t;0x20
DECL|macro|PHY_GO
mdefine_line|#define&t;PHY_GO&t;&t;&t;0x40
DECL|macro|MII_TIMEOUT
mdefine_line|#define&t;MII_TIMEOUT&t;&t;10
DECL|macro|RTL8150_REQT_READ
mdefine_line|#define&t;RTL8150_REQT_READ&t;0xc0
DECL|macro|RTL8150_REQT_WRITE
mdefine_line|#define&t;RTL8150_REQT_WRITE&t;0x40
DECL|macro|RTL8150_REQ_GET_REGS
mdefine_line|#define&t;RTL8150_REQ_GET_REGS&t;0x05
DECL|macro|RTL8150_REQ_SET_REGS
mdefine_line|#define&t;RTL8150_REQ_SET_REGS&t;0x05
DECL|macro|RTL8150_MTU
mdefine_line|#define&t;RTL8150_MTU&t;&t;1540
DECL|macro|RTL8150_TX_TIMEOUT
mdefine_line|#define&t;RTL8150_TX_TIMEOUT&t;(HZ)
DECL|macro|RX_SKB_POOL_SIZE
mdefine_line|#define&t;RX_SKB_POOL_SIZE&t;4
multiline_comment|/* rtl8150 flags */
DECL|macro|RTL8150_HW_CRC
mdefine_line|#define&t;RTL8150_HW_CRC&t;&t;0
DECL|macro|RX_REG_SET
mdefine_line|#define&t;RX_REG_SET&t;&t;1
DECL|macro|RTL8150_UNPLUG
mdefine_line|#define&t;RTL8150_UNPLUG&t;&t;2
multiline_comment|/* Define these values to match your device */
DECL|macro|VENDOR_ID_REALTEK
mdefine_line|#define VENDOR_ID_REALTEK&t;&t;0x0bda
DECL|macro|PRODUCT_ID_RTL8150
mdefine_line|#define PRODUCT_ID_RTL8150&t;&t;0x8150
multiline_comment|/* table of devices that work with this driver */
DECL|variable|rtl8150_table
r_static
r_struct
id|usb_device_id
id|rtl8150_table
(braket
)braket
op_assign
(brace
(brace
id|USB_DEVICE
c_func
(paren
id|VENDOR_ID_REALTEK
comma
id|PRODUCT_ID_RTL8150
)paren
)brace
comma
(brace
)brace
)brace
suffix:semicolon
id|MODULE_DEVICE_TABLE
c_func
(paren
id|usb
comma
id|rtl8150_table
)paren
suffix:semicolon
DECL|struct|rtl8150
r_struct
id|rtl8150
(brace
DECL|member|flags
r_int
r_int
id|flags
suffix:semicolon
DECL|member|udev
r_struct
id|usb_device
op_star
id|udev
suffix:semicolon
DECL|member|sem
r_struct
id|semaphore
id|sem
suffix:semicolon
DECL|member|tl
r_struct
id|tasklet_struct
id|tl
suffix:semicolon
DECL|member|stats
r_struct
id|net_device_stats
id|stats
suffix:semicolon
DECL|member|netdev
r_struct
id|net_device
op_star
id|netdev
suffix:semicolon
DECL|member|rx_urb
DECL|member|tx_urb
DECL|member|intr_urb
DECL|member|ctrl_urb
r_struct
id|urb
op_star
id|rx_urb
comma
op_star
id|tx_urb
comma
op_star
id|intr_urb
comma
op_star
id|ctrl_urb
suffix:semicolon
DECL|member|tx_skb
DECL|member|rx_skb
r_struct
id|sk_buff
op_star
id|tx_skb
comma
op_star
id|rx_skb
suffix:semicolon
DECL|member|rx_skb_pool
r_struct
id|sk_buff
op_star
id|rx_skb_pool
(braket
id|RX_SKB_POOL_SIZE
)braket
suffix:semicolon
DECL|member|rx_pool_lock
id|spinlock_t
id|rx_pool_lock
suffix:semicolon
DECL|member|dr
r_struct
id|usb_ctrlrequest
id|dr
suffix:semicolon
DECL|member|intr_interval
r_int
id|intr_interval
suffix:semicolon
DECL|member|rx_creg
id|u16
id|rx_creg
suffix:semicolon
DECL|member|intr_buff
id|u8
id|intr_buff
(braket
l_int|8
)braket
suffix:semicolon
DECL|member|phy
id|u8
id|phy
suffix:semicolon
)brace
suffix:semicolon
DECL|typedef|rtl8150_t
r_typedef
r_struct
id|rtl8150
id|rtl8150_t
suffix:semicolon
multiline_comment|/* the global usb devfs handle */
r_extern
id|devfs_handle_t
id|usb_devfs_handle
suffix:semicolon
DECL|variable|multicast_filter_limit
r_int
r_int
id|multicast_filter_limit
op_assign
l_int|32
suffix:semicolon
r_static
r_void
id|fill_skb_pool
c_func
(paren
id|rtl8150_t
op_star
)paren
suffix:semicolon
r_static
r_void
id|free_skb_pool
c_func
(paren
id|rtl8150_t
op_star
)paren
suffix:semicolon
r_static
r_struct
id|sk_buff
op_star
id|pull_skb
c_func
(paren
id|rtl8150_t
op_star
)paren
suffix:semicolon
r_static
r_void
id|rtl8150_disconnect
c_func
(paren
r_struct
id|usb_device
op_star
id|dev
comma
r_void
op_star
id|ptr
)paren
suffix:semicolon
r_static
r_void
op_star
id|rtl8150_probe
c_func
(paren
r_struct
id|usb_device
op_star
id|dev
comma
r_int
r_int
id|ifnum
comma
r_const
r_struct
id|usb_device_id
op_star
id|id
)paren
suffix:semicolon
DECL|variable|rtl8150_driver
r_static
r_struct
id|usb_driver
id|rtl8150_driver
op_assign
(brace
id|name
suffix:colon
l_string|&quot;rtl8150&quot;
comma
id|probe
suffix:colon
id|rtl8150_probe
comma
id|disconnect
suffix:colon
id|rtl8150_disconnect
comma
id|id_table
suffix:colon
id|rtl8150_table
comma
)brace
suffix:semicolon
multiline_comment|/*&n;**&n;**&t;device related part of the code&n;**&n;*/
DECL|function|get_registers
r_static
r_int
id|get_registers
c_func
(paren
id|rtl8150_t
op_star
id|dev
comma
id|u16
id|indx
comma
id|u16
id|size
comma
r_void
op_star
id|data
)paren
(brace
r_return
id|usb_control_msg
c_func
(paren
id|dev-&gt;udev
comma
id|usb_rcvctrlpipe
c_func
(paren
id|dev-&gt;udev
comma
l_int|0
)paren
comma
id|RTL8150_REQ_GET_REGS
comma
id|RTL8150_REQT_READ
comma
id|indx
comma
l_int|0
comma
id|data
comma
id|size
comma
id|HZ
op_div
l_int|2
)paren
suffix:semicolon
)brace
DECL|function|set_registers
r_static
r_int
id|set_registers
c_func
(paren
id|rtl8150_t
op_star
id|dev
comma
id|u16
id|indx
comma
id|u16
id|size
comma
r_void
op_star
id|data
)paren
(brace
r_return
id|usb_control_msg
c_func
(paren
id|dev-&gt;udev
comma
id|usb_sndctrlpipe
c_func
(paren
id|dev-&gt;udev
comma
l_int|0
)paren
comma
id|RTL8150_REQ_SET_REGS
comma
id|RTL8150_REQT_WRITE
comma
id|indx
comma
l_int|0
comma
id|data
comma
id|size
comma
id|HZ
op_div
l_int|2
)paren
suffix:semicolon
)brace
DECL|function|ctrl_callback
r_static
r_void
id|ctrl_callback
c_func
(paren
r_struct
id|urb
op_star
id|urb
)paren
(brace
id|rtl8150_t
op_star
id|dev
suffix:semicolon
r_switch
c_cond
(paren
id|urb-&gt;status
)paren
(brace
r_case
l_int|0
suffix:colon
r_break
suffix:semicolon
r_case
op_minus
id|EINPROGRESS
suffix:colon
r_break
suffix:semicolon
r_case
op_minus
id|ENOENT
suffix:colon
r_break
suffix:semicolon
r_default
suffix:colon
id|warn
c_func
(paren
l_string|&quot;ctrl urb status %d&quot;
comma
id|urb-&gt;status
)paren
suffix:semicolon
)brace
id|dev
op_assign
id|urb-&gt;context
suffix:semicolon
id|clear_bit
c_func
(paren
id|RX_REG_SET
comma
op_amp
id|dev-&gt;flags
)paren
suffix:semicolon
)brace
DECL|function|async_set_registers
r_static
r_int
id|async_set_registers
c_func
(paren
id|rtl8150_t
op_star
id|dev
comma
id|u16
id|indx
comma
id|u16
id|size
comma
r_void
op_star
id|data
)paren
(brace
r_int
id|ret
suffix:semicolon
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|RX_REG_SET
comma
op_amp
id|dev-&gt;flags
)paren
)paren
r_return
op_minus
id|EAGAIN
suffix:semicolon
id|dev-&gt;dr.bRequestType
op_assign
id|RTL8150_REQT_WRITE
suffix:semicolon
id|dev-&gt;dr.bRequest
op_assign
id|RTL8150_REQ_SET_REGS
suffix:semicolon
id|dev-&gt;dr.wValue
op_assign
id|cpu_to_le16
c_func
(paren
id|indx
)paren
suffix:semicolon
id|dev-&gt;dr.wIndex
op_assign
l_int|0
suffix:semicolon
id|dev-&gt;dr.wLength
op_assign
id|cpu_to_le16
c_func
(paren
id|size
)paren
suffix:semicolon
id|dev-&gt;ctrl_urb-&gt;transfer_buffer_length
op_assign
id|size
suffix:semicolon
id|FILL_CONTROL_URB
c_func
(paren
id|dev-&gt;ctrl_urb
comma
id|dev-&gt;udev
comma
id|usb_sndctrlpipe
c_func
(paren
id|dev-&gt;udev
comma
l_int|0
)paren
comma
(paren
r_char
op_star
)paren
op_amp
id|dev-&gt;dr
comma
op_amp
id|dev-&gt;rx_creg
comma
id|size
comma
id|ctrl_callback
comma
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|ret
op_assign
id|usb_submit_urb
c_func
(paren
id|dev-&gt;ctrl_urb
comma
id|GFP_ATOMIC
)paren
)paren
)paren
id|err
c_func
(paren
l_string|&quot;control request submission failed: %d&quot;
comma
id|ret
)paren
suffix:semicolon
r_else
id|set_bit
c_func
(paren
id|RX_REG_SET
comma
op_amp
id|dev-&gt;flags
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
DECL|function|read_mii_word
r_static
r_int
id|read_mii_word
c_func
(paren
id|rtl8150_t
op_star
id|dev
comma
id|u8
id|phy
comma
id|__u8
id|indx
comma
id|u16
op_star
id|reg
)paren
(brace
r_int
id|i
suffix:semicolon
id|u8
id|data
(braket
l_int|3
)braket
comma
id|tmp
suffix:semicolon
id|data
(braket
l_int|0
)braket
op_assign
id|phy
suffix:semicolon
id|data
(braket
l_int|1
)braket
op_assign
id|data
(braket
l_int|2
)braket
op_assign
l_int|0
suffix:semicolon
id|tmp
op_assign
id|indx
op_or
id|PHY_READ
op_or
id|PHY_GO
suffix:semicolon
id|i
op_assign
l_int|0
suffix:semicolon
id|set_registers
c_func
(paren
id|dev
comma
id|PHYADD
comma
r_sizeof
(paren
id|data
)paren
comma
id|data
)paren
suffix:semicolon
id|set_registers
c_func
(paren
id|dev
comma
id|PHYCNT
comma
l_int|1
comma
op_amp
id|tmp
)paren
suffix:semicolon
r_do
(brace
id|get_registers
c_func
(paren
id|dev
comma
id|PHYCNT
comma
l_int|1
comma
id|data
)paren
suffix:semicolon
)brace
r_while
c_loop
(paren
(paren
id|data
(braket
l_int|0
)braket
op_amp
id|PHY_GO
)paren
op_logical_and
(paren
id|i
op_increment
OL
id|MII_TIMEOUT
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|i
OL
id|MII_TIMEOUT
)paren
(brace
id|get_registers
c_func
(paren
id|dev
comma
id|PHYDAT
comma
l_int|2
comma
id|data
)paren
suffix:semicolon
op_star
id|reg
op_assign
id|le16_to_cpup
c_func
(paren
id|data
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_else
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|write_mii_word
r_static
r_int
id|write_mii_word
c_func
(paren
id|rtl8150_t
op_star
id|dev
comma
id|u8
id|phy
comma
id|__u8
id|indx
comma
id|u16
id|reg
)paren
(brace
r_int
id|i
suffix:semicolon
id|u8
id|data
(braket
l_int|3
)braket
comma
id|tmp
suffix:semicolon
id|data
(braket
l_int|0
)braket
op_assign
id|phy
suffix:semicolon
op_star
(paren
id|data
op_plus
l_int|1
)paren
op_assign
id|cpu_to_le16p
c_func
(paren
op_amp
id|reg
)paren
suffix:semicolon
id|tmp
op_assign
id|indx
op_or
id|PHY_WRITE
op_or
id|PHY_GO
suffix:semicolon
id|i
op_assign
l_int|0
suffix:semicolon
id|set_registers
c_func
(paren
id|dev
comma
id|PHYADD
comma
r_sizeof
(paren
id|data
)paren
comma
id|data
)paren
suffix:semicolon
id|set_registers
c_func
(paren
id|dev
comma
id|PHYCNT
comma
l_int|1
comma
op_amp
id|tmp
)paren
suffix:semicolon
r_do
(brace
id|get_registers
c_func
(paren
id|dev
comma
id|PHYCNT
comma
l_int|1
comma
id|data
)paren
suffix:semicolon
)brace
r_while
c_loop
(paren
(paren
id|data
(braket
l_int|0
)braket
op_amp
id|PHY_GO
)paren
op_logical_and
(paren
id|i
op_increment
OL
id|MII_TIMEOUT
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|i
OL
id|MII_TIMEOUT
)paren
r_return
l_int|0
suffix:semicolon
r_else
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|set_ethernet_addr
r_static
r_inline
r_void
id|set_ethernet_addr
c_func
(paren
id|rtl8150_t
op_star
id|dev
)paren
(brace
id|u8
id|node_id
(braket
l_int|6
)braket
suffix:semicolon
id|get_registers
c_func
(paren
id|dev
comma
id|IRD
comma
r_sizeof
(paren
id|node_id
)paren
comma
id|node_id
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|dev-&gt;netdev-&gt;dev_addr
comma
id|node_id
comma
r_sizeof
(paren
id|node_id
)paren
)paren
suffix:semicolon
)brace
DECL|function|rtl8150_reset
r_static
r_int
id|rtl8150_reset
c_func
(paren
id|rtl8150_t
op_star
id|dev
)paren
(brace
id|u8
id|data
op_assign
l_int|0x10
suffix:semicolon
r_int
id|i
op_assign
id|HZ
suffix:semicolon
id|set_registers
c_func
(paren
id|dev
comma
id|CR
comma
l_int|1
comma
op_amp
id|data
)paren
suffix:semicolon
r_do
(brace
id|get_registers
c_func
(paren
id|dev
comma
id|CR
comma
l_int|1
comma
op_amp
id|data
)paren
suffix:semicolon
)brace
r_while
c_loop
(paren
(paren
id|data
op_amp
l_int|0x10
)paren
op_logical_and
op_decrement
id|i
)paren
suffix:semicolon
r_return
(paren
id|i
OG
l_int|0
)paren
ques
c_cond
l_int|1
suffix:colon
l_int|0
suffix:semicolon
)brace
DECL|function|alloc_all_urbs
r_static
r_int
id|alloc_all_urbs
c_func
(paren
id|rtl8150_t
op_star
id|dev
)paren
(brace
id|dev-&gt;rx_urb
op_assign
id|usb_alloc_urb
c_func
(paren
l_int|0
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dev-&gt;rx_urb
)paren
r_return
l_int|0
suffix:semicolon
id|dev-&gt;tx_urb
op_assign
id|usb_alloc_urb
c_func
(paren
l_int|0
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dev-&gt;tx_urb
)paren
(brace
id|usb_free_urb
c_func
(paren
id|dev-&gt;rx_urb
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|dev-&gt;intr_urb
op_assign
id|usb_alloc_urb
c_func
(paren
l_int|0
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dev-&gt;intr_urb
)paren
(brace
id|usb_free_urb
c_func
(paren
id|dev-&gt;rx_urb
)paren
suffix:semicolon
id|usb_free_urb
c_func
(paren
id|dev-&gt;tx_urb
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|dev-&gt;ctrl_urb
op_assign
id|usb_alloc_urb
c_func
(paren
l_int|0
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dev-&gt;intr_urb
)paren
(brace
id|usb_free_urb
c_func
(paren
id|dev-&gt;rx_urb
)paren
suffix:semicolon
id|usb_free_urb
c_func
(paren
id|dev-&gt;tx_urb
)paren
suffix:semicolon
id|usb_free_urb
c_func
(paren
id|dev-&gt;intr_urb
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|free_all_urbs
r_static
r_void
id|free_all_urbs
c_func
(paren
id|rtl8150_t
op_star
id|dev
)paren
(brace
id|usb_free_urb
c_func
(paren
id|dev-&gt;rx_urb
)paren
suffix:semicolon
id|usb_free_urb
c_func
(paren
id|dev-&gt;tx_urb
)paren
suffix:semicolon
id|usb_free_urb
c_func
(paren
id|dev-&gt;intr_urb
)paren
suffix:semicolon
id|usb_free_urb
c_func
(paren
id|dev-&gt;ctrl_urb
)paren
suffix:semicolon
)brace
DECL|function|unlink_all_urbs
r_static
r_void
id|unlink_all_urbs
c_func
(paren
id|rtl8150_t
op_star
id|dev
)paren
(brace
id|usb_unlink_urb
c_func
(paren
id|dev-&gt;rx_urb
)paren
suffix:semicolon
id|usb_unlink_urb
c_func
(paren
id|dev-&gt;tx_urb
)paren
suffix:semicolon
id|usb_unlink_urb
c_func
(paren
id|dev-&gt;intr_urb
)paren
suffix:semicolon
id|usb_unlink_urb
c_func
(paren
id|dev-&gt;ctrl_urb
)paren
suffix:semicolon
)brace
DECL|function|read_bulk_callback
r_static
r_void
id|read_bulk_callback
c_func
(paren
r_struct
id|urb
op_star
id|urb
)paren
(brace
id|rtl8150_t
op_star
id|dev
suffix:semicolon
r_int
id|pkt_len
comma
id|res
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
r_struct
id|net_device
op_star
id|netdev
suffix:semicolon
id|u16
id|rx_stat
suffix:semicolon
id|dev
op_assign
id|urb-&gt;context
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dev
)paren
(brace
id|warn
c_func
(paren
l_string|&quot;!dev&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|netdev
op_assign
id|dev-&gt;netdev
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|netif_device_present
c_func
(paren
id|netdev
)paren
)paren
(brace
id|warn
c_func
(paren
l_string|&quot;the network device is not present&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|urb-&gt;status
)paren
(brace
r_case
l_int|0
suffix:colon
r_break
suffix:semicolon
r_case
op_minus
id|ENOENT
suffix:colon
r_return
suffix:semicolon
r_case
op_minus
id|ETIMEDOUT
suffix:colon
id|warn
c_func
(paren
l_string|&quot;reset needed may be?..&quot;
)paren
suffix:semicolon
r_goto
id|goon
suffix:semicolon
r_default
suffix:colon
id|warn
c_func
(paren
l_string|&quot;Rx status %d&quot;
comma
id|urb-&gt;status
)paren
suffix:semicolon
r_goto
id|goon
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|dev-&gt;rx_skb
)paren
(brace
multiline_comment|/* lost packets++ */
r_return
suffix:semicolon
)brace
id|res
op_assign
id|urb-&gt;actual_length
suffix:semicolon
id|rx_stat
op_assign
id|le16_to_cpu
c_func
(paren
op_star
(paren
r_int
op_star
)paren
(paren
id|urb-&gt;transfer_buffer
op_plus
id|res
op_minus
l_int|4
)paren
)paren
suffix:semicolon
id|pkt_len
op_assign
id|res
op_minus
l_int|4
suffix:semicolon
id|skb_put
c_func
(paren
id|dev-&gt;rx_skb
comma
id|pkt_len
)paren
suffix:semicolon
id|dev-&gt;rx_skb-&gt;protocol
op_assign
id|eth_type_trans
c_func
(paren
id|dev-&gt;rx_skb
comma
id|netdev
)paren
suffix:semicolon
id|netif_rx
c_func
(paren
id|dev-&gt;rx_skb
)paren
suffix:semicolon
id|dev-&gt;stats.rx_packets
op_increment
suffix:semicolon
id|dev-&gt;stats.rx_bytes
op_add_assign
id|pkt_len
suffix:semicolon
id|tasklet_schedule
c_func
(paren
op_amp
id|dev-&gt;tl
)paren
suffix:semicolon
id|skb
op_assign
id|pull_skb
c_func
(paren
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|skb
)paren
(brace
id|dev-&gt;rx_skb
op_assign
l_int|NULL
suffix:semicolon
r_return
suffix:semicolon
)brace
id|skb-&gt;dev
op_assign
id|netdev
suffix:semicolon
id|skb_reserve
c_func
(paren
id|skb
comma
l_int|2
)paren
suffix:semicolon
id|dev-&gt;rx_skb
op_assign
id|skb
suffix:semicolon
id|goon
suffix:colon
id|FILL_BULK_URB
c_func
(paren
id|dev-&gt;rx_urb
comma
id|dev-&gt;udev
comma
id|usb_rcvbulkpipe
c_func
(paren
id|dev-&gt;udev
comma
l_int|1
)paren
comma
id|dev-&gt;rx_skb-&gt;data
comma
id|RTL8150_MTU
comma
id|read_bulk_callback
comma
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|res
op_assign
id|usb_submit_urb
c_func
(paren
id|dev-&gt;rx_urb
comma
id|GFP_ATOMIC
)paren
)paren
)paren
id|warn
c_func
(paren
l_string|&quot;%s: Rx urb submission failed %d&quot;
comma
id|netdev-&gt;name
comma
id|res
)paren
suffix:semicolon
)brace
DECL|function|rx_fixup
r_static
r_void
id|rx_fixup
c_func
(paren
r_int
r_int
id|data
)paren
(brace
id|rtl8150_t
op_star
id|dev
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|dev
op_assign
(paren
id|rtl8150_t
op_star
)paren
id|data
suffix:semicolon
id|fill_skb_pool
c_func
(paren
id|dev
)paren
suffix:semicolon
id|skb
op_assign
id|pull_skb
c_func
(paren
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|skb
)paren
(brace
id|tasklet_schedule
c_func
(paren
op_amp
id|dev-&gt;tl
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|dev-&gt;rx_skb
)paren
r_return
suffix:semicolon
id|dev-&gt;rx_skb
op_assign
id|skb
suffix:semicolon
id|FILL_BULK_URB
c_func
(paren
id|dev-&gt;rx_urb
comma
id|dev-&gt;udev
comma
id|usb_rcvbulkpipe
c_func
(paren
id|dev-&gt;udev
comma
l_int|1
)paren
comma
id|dev-&gt;rx_skb-&gt;data
comma
id|RTL8150_MTU
comma
id|read_bulk_callback
comma
id|dev
)paren
suffix:semicolon
id|usb_submit_urb
c_func
(paren
id|dev-&gt;rx_urb
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
)brace
DECL|function|write_bulk_callback
r_static
r_void
id|write_bulk_callback
c_func
(paren
r_struct
id|urb
op_star
id|urb
)paren
(brace
id|rtl8150_t
op_star
id|dev
suffix:semicolon
id|dev
op_assign
id|urb-&gt;context
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dev
)paren
r_return
suffix:semicolon
id|dev_kfree_skb_irq
c_func
(paren
id|dev-&gt;tx_skb
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|netif_device_present
c_func
(paren
id|dev-&gt;netdev
)paren
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|urb-&gt;status
)paren
id|info
c_func
(paren
l_string|&quot;%s: Tx status %d&quot;
comma
id|dev-&gt;netdev-&gt;name
comma
id|urb-&gt;status
)paren
suffix:semicolon
id|dev-&gt;netdev-&gt;trans_start
op_assign
id|jiffies
suffix:semicolon
id|netif_wake_queue
c_func
(paren
id|dev-&gt;netdev
)paren
suffix:semicolon
)brace
DECL|function|intr_callback
r_void
id|intr_callback
c_func
(paren
r_struct
id|urb
op_star
id|urb
)paren
(brace
id|rtl8150_t
op_star
id|dev
suffix:semicolon
id|dev
op_assign
id|urb-&gt;context
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dev
)paren
r_return
suffix:semicolon
r_switch
c_cond
(paren
id|urb-&gt;status
)paren
(brace
r_case
l_int|0
suffix:colon
r_break
suffix:semicolon
r_case
op_minus
id|ENOENT
suffix:colon
r_return
suffix:semicolon
r_default
suffix:colon
id|info
c_func
(paren
l_string|&quot;%s: intr status %d&quot;
comma
id|dev-&gt;netdev-&gt;name
comma
id|urb-&gt;status
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/*&n;**&n;**&t;network related part of the code&n;**&n;*/
DECL|function|fill_skb_pool
r_static
r_void
id|fill_skb_pool
c_func
(paren
id|rtl8150_t
op_star
id|dev
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
r_int
id|i
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|dev-&gt;rx_pool_lock
comma
id|flags
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|RX_SKB_POOL_SIZE
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|dev-&gt;rx_skb_pool
(braket
id|i
)braket
)paren
r_continue
suffix:semicolon
id|skb
op_assign
id|dev_alloc_skb
c_func
(paren
id|RTL8150_MTU
op_plus
l_int|2
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|skb
)paren
(brace
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|dev-&gt;rx_pool_lock
comma
id|flags
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|skb-&gt;dev
op_assign
id|dev-&gt;netdev
suffix:semicolon
id|skb_reserve
c_func
(paren
id|skb
comma
l_int|2
)paren
suffix:semicolon
id|dev-&gt;rx_skb_pool
(braket
id|i
)braket
op_assign
id|skb
suffix:semicolon
)brace
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|dev-&gt;rx_pool_lock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|free_skb_pool
r_static
r_void
id|free_skb_pool
c_func
(paren
id|rtl8150_t
op_star
id|dev
)paren
(brace
r_int
id|i
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|dev-&gt;rx_pool_lock
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|RX_SKB_POOL_SIZE
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|dev-&gt;rx_skb_pool
(braket
id|i
)braket
)paren
id|dev_kfree_skb
c_func
(paren
id|dev-&gt;rx_skb_pool
(braket
id|i
)braket
)paren
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|dev-&gt;rx_pool_lock
)paren
suffix:semicolon
)brace
DECL|function|pull_skb
r_static
r_struct
id|sk_buff
op_star
id|pull_skb
c_func
(paren
id|rtl8150_t
op_star
id|dev
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
r_int
id|i
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|dev-&gt;rx_pool_lock
comma
id|flags
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|RX_SKB_POOL_SIZE
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|dev-&gt;rx_skb_pool
(braket
id|i
)braket
)paren
(brace
id|skb
op_assign
id|dev-&gt;rx_skb_pool
(braket
id|i
)braket
suffix:semicolon
id|dev-&gt;rx_skb_pool
(braket
id|i
)braket
op_assign
l_int|NULL
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|dev-&gt;rx_pool_lock
comma
id|flags
)paren
suffix:semicolon
r_return
id|skb
suffix:semicolon
)brace
)brace
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|dev-&gt;rx_pool_lock
comma
id|flags
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
DECL|function|enable_net_traffic
r_static
r_int
id|enable_net_traffic
c_func
(paren
id|rtl8150_t
op_star
id|dev
)paren
(brace
id|u8
id|cr
comma
id|tcr
comma
id|rcr
comma
id|msr
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|rtl8150_reset
c_func
(paren
id|dev
)paren
)paren
(brace
id|warn
c_func
(paren
l_string|&quot;%s - device reset failed&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
)brace
multiline_comment|/* RCR bit7=1 attach Rx info at the end;  =0 HW CRC (which is broken) */
id|dev-&gt;rx_creg
op_assign
id|rcr
op_assign
l_int|0x9e
suffix:semicolon
id|tcr
op_assign
l_int|0xd8
suffix:semicolon
id|cr
op_assign
l_int|0x0c
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|rcr
op_amp
l_int|0x80
)paren
)paren
id|set_bit
c_func
(paren
id|RTL8150_HW_CRC
comma
op_amp
id|dev-&gt;flags
)paren
suffix:semicolon
id|set_registers
c_func
(paren
id|dev
comma
id|RCR
comma
l_int|1
comma
op_amp
id|rcr
)paren
suffix:semicolon
id|set_registers
c_func
(paren
id|dev
comma
id|TCR
comma
l_int|1
comma
op_amp
id|tcr
)paren
suffix:semicolon
id|set_registers
c_func
(paren
id|dev
comma
id|CR
comma
l_int|1
comma
op_amp
id|cr
)paren
suffix:semicolon
id|get_registers
c_func
(paren
id|dev
comma
id|MSR
comma
l_int|1
comma
op_amp
id|msr
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|disable_net_traffic
r_static
r_void
id|disable_net_traffic
c_func
(paren
id|rtl8150_t
op_star
id|dev
)paren
(brace
id|u8
id|cr
suffix:semicolon
id|get_registers
c_func
(paren
id|dev
comma
id|CR
comma
l_int|1
comma
op_amp
id|cr
)paren
suffix:semicolon
id|cr
op_and_assign
l_int|0xf3
suffix:semicolon
id|set_registers
c_func
(paren
id|dev
comma
id|CR
comma
l_int|1
comma
op_amp
id|cr
)paren
suffix:semicolon
)brace
DECL|function|rtl8150_netdev_stats
r_static
r_struct
id|net_device_stats
op_star
id|rtl8150_netdev_stats
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_return
op_amp
(paren
(paren
id|rtl8150_t
op_star
)paren
id|dev-&gt;priv
)paren
op_member_access_from_pointer
id|stats
suffix:semicolon
)brace
DECL|function|rtl8150_tx_timeout
r_static
r_void
id|rtl8150_tx_timeout
c_func
(paren
r_struct
id|net_device
op_star
id|netdev
)paren
(brace
id|rtl8150_t
op_star
id|dev
suffix:semicolon
id|dev
op_assign
id|netdev-&gt;priv
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dev
)paren
r_return
suffix:semicolon
id|warn
c_func
(paren
l_string|&quot;%s: Tx timeout.&quot;
comma
id|netdev-&gt;name
)paren
suffix:semicolon
id|dev-&gt;tx_urb-&gt;transfer_flags
op_or_assign
id|USB_ASYNC_UNLINK
suffix:semicolon
id|usb_unlink_urb
c_func
(paren
id|dev-&gt;tx_urb
)paren
suffix:semicolon
id|dev-&gt;stats.tx_errors
op_increment
suffix:semicolon
)brace
DECL|function|rtl8150_set_multicast
r_static
r_void
id|rtl8150_set_multicast
c_func
(paren
r_struct
id|net_device
op_star
id|netdev
)paren
(brace
id|rtl8150_t
op_star
id|dev
suffix:semicolon
id|dev
op_assign
id|netdev-&gt;priv
suffix:semicolon
id|netif_stop_queue
c_func
(paren
id|netdev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|netdev-&gt;flags
op_amp
id|IFF_PROMISC
)paren
(brace
id|dev-&gt;rx_creg
op_or_assign
l_int|0x0001
suffix:semicolon
id|info
c_func
(paren
l_string|&quot;%s: promiscuous mode&quot;
comma
id|netdev-&gt;name
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
(paren
id|netdev-&gt;mc_count
OG
id|multicast_filter_limit
)paren
op_logical_or
(paren
id|netdev-&gt;flags
op_amp
id|IFF_ALLMULTI
)paren
)paren
(brace
id|dev-&gt;rx_creg
op_and_assign
l_int|0xfffe
suffix:semicolon
id|dev-&gt;rx_creg
op_or_assign
l_int|0x0002
suffix:semicolon
id|info
c_func
(paren
l_string|&quot;%s: allmulti set&quot;
comma
id|netdev-&gt;name
)paren
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* ~RX_MULTICAST, ~RX_PROMISCUOUS */
id|dev-&gt;rx_creg
op_and_assign
l_int|0x00fc
suffix:semicolon
)brace
id|async_set_registers
c_func
(paren
id|dev
comma
id|RCR
comma
l_int|2
comma
op_amp
id|dev-&gt;rx_creg
)paren
suffix:semicolon
id|netif_wake_queue
c_func
(paren
id|netdev
)paren
suffix:semicolon
)brace
DECL|function|rtl8150_start_xmit
r_static
r_int
id|rtl8150_start_xmit
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|net_device
op_star
id|netdev
)paren
(brace
id|rtl8150_t
op_star
id|dev
suffix:semicolon
r_int
id|count
comma
id|res
suffix:semicolon
id|netif_stop_queue
c_func
(paren
id|netdev
)paren
suffix:semicolon
id|dev
op_assign
id|netdev-&gt;priv
suffix:semicolon
id|count
op_assign
(paren
id|skb-&gt;len
OL
l_int|60
)paren
ques
c_cond
l_int|60
suffix:colon
id|skb-&gt;len
suffix:semicolon
id|count
op_assign
(paren
id|count
op_amp
l_int|0x3f
)paren
ques
c_cond
id|count
suffix:colon
id|count
op_plus
l_int|1
suffix:semicolon
id|dev-&gt;tx_skb
op_assign
id|skb
suffix:semicolon
id|FILL_BULK_URB
c_func
(paren
id|dev-&gt;tx_urb
comma
id|dev-&gt;udev
comma
id|usb_sndbulkpipe
c_func
(paren
id|dev-&gt;udev
comma
l_int|2
)paren
comma
id|skb-&gt;data
comma
id|count
comma
id|write_bulk_callback
comma
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|res
op_assign
id|usb_submit_urb
c_func
(paren
id|dev-&gt;tx_urb
comma
id|GFP_KERNEL
)paren
)paren
)paren
(brace
id|warn
c_func
(paren
l_string|&quot;failed tx_urb %d&bslash;n&quot;
comma
id|res
)paren
suffix:semicolon
id|dev-&gt;stats.tx_errors
op_increment
suffix:semicolon
id|netif_start_queue
c_func
(paren
id|netdev
)paren
suffix:semicolon
)brace
r_else
(brace
id|dev-&gt;stats.tx_packets
op_increment
suffix:semicolon
id|dev-&gt;stats.tx_bytes
op_add_assign
id|skb-&gt;len
suffix:semicolon
id|netdev-&gt;trans_start
op_assign
id|jiffies
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|rtl8150_open
r_static
r_int
id|rtl8150_open
c_func
(paren
r_struct
id|net_device
op_star
id|netdev
)paren
(brace
id|rtl8150_t
op_star
id|dev
suffix:semicolon
r_int
id|res
suffix:semicolon
id|dev
op_assign
id|netdev-&gt;priv
suffix:semicolon
r_if
c_cond
(paren
id|dev
op_eq
l_int|NULL
)paren
(brace
r_return
op_minus
id|ENODEV
suffix:semicolon
)brace
id|dev-&gt;rx_skb
op_assign
id|pull_skb
c_func
(paren
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dev-&gt;rx_skb
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|down
c_func
(paren
op_amp
id|dev-&gt;sem
)paren
suffix:semicolon
id|FILL_BULK_URB
c_func
(paren
id|dev-&gt;rx_urb
comma
id|dev-&gt;udev
comma
id|usb_rcvbulkpipe
c_func
(paren
id|dev-&gt;udev
comma
l_int|1
)paren
comma
id|dev-&gt;rx_skb-&gt;data
comma
id|RTL8150_MTU
comma
id|read_bulk_callback
comma
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|res
op_assign
id|usb_submit_urb
c_func
(paren
id|dev-&gt;rx_urb
comma
id|GFP_KERNEL
)paren
)paren
)paren
id|warn
c_func
(paren
l_string|&quot;%s: rx_urb submit failed: %d&quot;
comma
id|__FUNCTION__
comma
id|res
)paren
suffix:semicolon
id|FILL_INT_URB
c_func
(paren
id|dev-&gt;intr_urb
comma
id|dev-&gt;udev
comma
id|usb_rcvintpipe
c_func
(paren
id|dev-&gt;udev
comma
l_int|3
)paren
comma
id|dev-&gt;intr_buff
comma
r_sizeof
(paren
id|dev-&gt;intr_buff
)paren
comma
id|intr_callback
comma
id|dev
comma
id|dev-&gt;intr_interval
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|res
op_assign
id|usb_submit_urb
c_func
(paren
id|dev-&gt;intr_urb
comma
id|GFP_KERNEL
)paren
)paren
)paren
id|warn
c_func
(paren
l_string|&quot;%s: intr_urb submit failed: %d&quot;
comma
id|__FUNCTION__
comma
id|res
)paren
suffix:semicolon
id|netif_start_queue
c_func
(paren
id|netdev
)paren
suffix:semicolon
id|enable_net_traffic
c_func
(paren
id|dev
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|dev-&gt;sem
)paren
suffix:semicolon
r_return
id|res
suffix:semicolon
)brace
DECL|function|rtl8150_close
r_static
r_int
id|rtl8150_close
c_func
(paren
r_struct
id|net_device
op_star
id|netdev
)paren
(brace
id|rtl8150_t
op_star
id|dev
suffix:semicolon
r_int
id|res
op_assign
l_int|0
suffix:semicolon
id|dev
op_assign
id|netdev-&gt;priv
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dev
)paren
r_return
op_minus
id|ENODEV
suffix:semicolon
id|down
c_func
(paren
op_amp
id|dev-&gt;sem
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|test_bit
c_func
(paren
id|RTL8150_UNPLUG
comma
op_amp
id|dev-&gt;flags
)paren
)paren
id|disable_net_traffic
c_func
(paren
id|dev
)paren
suffix:semicolon
id|unlink_all_urbs
c_func
(paren
id|dev
)paren
suffix:semicolon
id|netif_stop_queue
c_func
(paren
id|netdev
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|dev-&gt;sem
)paren
suffix:semicolon
r_return
id|res
suffix:semicolon
)brace
DECL|function|rtl8150_ethtool_ioctl
r_static
r_int
id|rtl8150_ethtool_ioctl
c_func
(paren
r_struct
id|net_device
op_star
id|netdev
comma
r_void
op_star
id|uaddr
)paren
(brace
id|rtl8150_t
op_star
id|dev
suffix:semicolon
r_int
id|cmd
suffix:semicolon
id|dev
op_assign
id|netdev-&gt;priv
suffix:semicolon
r_if
c_cond
(paren
id|get_user
c_func
(paren
id|cmd
comma
(paren
r_int
op_star
)paren
id|uaddr
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|ETHTOOL_GDRVINFO
suffix:colon
(brace
r_struct
id|ethtool_drvinfo
id|info
op_assign
(brace
id|ETHTOOL_GDRVINFO
)brace
suffix:semicolon
id|strncpy
c_func
(paren
id|info.driver
comma
id|DRIVER_DESC
comma
id|ETHTOOL_BUSINFO_LEN
)paren
suffix:semicolon
id|strncpy
c_func
(paren
id|info.version
comma
id|DRIVER_VERSION
comma
id|ETHTOOL_BUSINFO_LEN
)paren
suffix:semicolon
id|usb_make_path
c_func
(paren
id|dev-&gt;udev
comma
id|info.bus_info
comma
r_sizeof
id|info.bus_info
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|uaddr
comma
op_amp
id|info
comma
r_sizeof
(paren
id|info
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_case
id|ETHTOOL_GSET
suffix:colon
(brace
r_struct
id|ethtool_cmd
id|ecmd
suffix:semicolon
r_int
id|lpa
comma
id|bmcr
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|ecmd
comma
id|uaddr
comma
r_sizeof
(paren
id|ecmd
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|ecmd.supported
op_assign
(paren
id|SUPPORTED_10baseT_Half
op_or
id|SUPPORTED_10baseT_Full
op_or
id|SUPPORTED_100baseT_Half
op_or
id|SUPPORTED_100baseT_Full
op_or
id|SUPPORTED_Autoneg
op_or
id|SUPPORTED_TP
op_or
id|SUPPORTED_MII
)paren
suffix:semicolon
id|ecmd.port
op_assign
id|PORT_TP
suffix:semicolon
id|ecmd.transceiver
op_assign
id|XCVR_INTERNAL
suffix:semicolon
id|ecmd.phy_address
op_assign
id|dev-&gt;phy
suffix:semicolon
id|get_registers
c_func
(paren
id|dev
comma
id|BMCR
comma
l_int|2
comma
op_amp
id|bmcr
)paren
suffix:semicolon
id|get_registers
c_func
(paren
id|dev
comma
id|ANLP
comma
l_int|2
comma
op_amp
id|lpa
)paren
suffix:semicolon
r_if
c_cond
(paren
id|bmcr
op_amp
id|BMCR_ANENABLE
)paren
(brace
id|ecmd.autoneg
op_assign
id|AUTONEG_ENABLE
suffix:semicolon
id|ecmd.speed
op_assign
(paren
id|lpa
op_amp
(paren
id|LPA_100HALF
op_or
id|LPA_100FULL
)paren
)paren
ques
c_cond
id|SPEED_100
suffix:colon
id|SPEED_10
suffix:semicolon
r_if
c_cond
(paren
id|ecmd.speed
op_eq
id|SPEED_100
)paren
id|ecmd.duplex
op_assign
(paren
id|lpa
op_amp
id|LPA_100FULL
)paren
ques
c_cond
id|DUPLEX_FULL
suffix:colon
id|DUPLEX_HALF
suffix:semicolon
r_else
id|ecmd.duplex
op_assign
(paren
id|lpa
op_amp
id|LPA_10FULL
)paren
ques
c_cond
id|DUPLEX_FULL
suffix:colon
id|DUPLEX_HALF
suffix:semicolon
)brace
r_else
(brace
id|ecmd.autoneg
op_assign
id|AUTONEG_DISABLE
suffix:semicolon
id|ecmd.speed
op_assign
(paren
id|bmcr
op_amp
id|BMCR_SPEED100
)paren
ques
c_cond
id|SPEED_100
suffix:colon
id|SPEED_10
suffix:semicolon
id|ecmd.duplex
op_assign
(paren
id|bmcr
op_amp
id|BMCR_FULLDPLX
)paren
ques
c_cond
id|DUPLEX_FULL
suffix:colon
id|DUPLEX_HALF
suffix:semicolon
)brace
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|uaddr
comma
op_amp
id|ecmd
comma
r_sizeof
(paren
id|ecmd
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_case
id|ETHTOOL_SSET
suffix:colon
r_return
op_minus
id|ENOTSUPP
suffix:semicolon
r_case
id|ETHTOOL_GLINK
suffix:colon
(brace
r_struct
id|ethtool_value
id|edata
op_assign
(brace
id|ETHTOOL_GLINK
)brace
suffix:semicolon
id|edata.data
op_assign
id|netif_carrier_ok
c_func
(paren
id|netdev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|uaddr
comma
op_amp
id|edata
comma
r_sizeof
(paren
id|edata
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_default
suffix:colon
r_return
op_minus
id|EOPNOTSUPP
suffix:semicolon
)brace
)brace
DECL|function|rtl8150_ioctl
r_static
r_int
id|rtl8150_ioctl
c_func
(paren
r_struct
id|net_device
op_star
id|netdev
comma
r_struct
id|ifreq
op_star
id|rq
comma
r_int
id|cmd
)paren
(brace
id|rtl8150_t
op_star
id|dev
suffix:semicolon
id|u16
op_star
id|data
suffix:semicolon
r_int
id|res
suffix:semicolon
id|dev
op_assign
id|netdev-&gt;priv
suffix:semicolon
id|data
op_assign
(paren
id|u16
op_star
)paren
op_amp
id|rq-&gt;ifr_data
suffix:semicolon
id|res
op_assign
l_int|0
suffix:semicolon
id|down
c_func
(paren
op_amp
id|dev-&gt;sem
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|SIOCETHTOOL
suffix:colon
id|res
op_assign
id|rtl8150_ethtool_ioctl
c_func
(paren
id|netdev
comma
id|rq-&gt;ifr_data
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SIOCDEVPRIVATE
suffix:colon
id|data
(braket
l_int|0
)braket
op_assign
id|dev-&gt;phy
suffix:semicolon
r_case
id|SIOCDEVPRIVATE
op_plus
l_int|1
suffix:colon
id|read_mii_word
c_func
(paren
id|dev
comma
id|dev-&gt;phy
comma
(paren
id|data
(braket
l_int|1
)braket
op_amp
l_int|0x1f
)paren
comma
op_amp
id|data
(braket
l_int|3
)braket
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SIOCDEVPRIVATE
op_plus
l_int|2
suffix:colon
r_if
c_cond
(paren
op_logical_neg
id|capable
c_func
(paren
id|CAP_NET_ADMIN
)paren
)paren
(brace
id|up
c_func
(paren
op_amp
id|dev-&gt;sem
)paren
suffix:semicolon
r_return
op_minus
id|EPERM
suffix:semicolon
)brace
id|write_mii_word
c_func
(paren
id|dev
comma
id|dev-&gt;phy
comma
(paren
id|data
(braket
l_int|1
)braket
op_amp
l_int|0x1f
)paren
comma
id|data
(braket
l_int|2
)braket
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|res
op_assign
op_minus
id|EOPNOTSUPP
suffix:semicolon
)brace
id|up
c_func
(paren
op_amp
id|dev-&gt;sem
)paren
suffix:semicolon
r_return
id|res
suffix:semicolon
)brace
DECL|function|rtl8150_probe
r_static
r_void
op_star
id|rtl8150_probe
c_func
(paren
r_struct
id|usb_device
op_star
id|udev
comma
r_int
r_int
id|ifnum
comma
r_const
r_struct
id|usb_device_id
op_star
id|id
)paren
(brace
id|rtl8150_t
op_star
id|dev
suffix:semicolon
r_struct
id|net_device
op_star
id|netdev
suffix:semicolon
r_if
c_cond
(paren
id|usb_set_configuration
c_func
(paren
id|udev
comma
id|udev-&gt;config
(braket
l_int|0
)braket
dot
id|bConfigurationValue
)paren
)paren
(brace
id|err
c_func
(paren
l_string|&quot;usb_set_configuration() failed&quot;
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|udev-&gt;descriptor.idVendor
op_ne
id|VENDOR_ID_REALTEK
)paren
op_logical_or
(paren
id|udev-&gt;descriptor.idProduct
op_ne
id|PRODUCT_ID_RTL8150
)paren
)paren
(brace
id|err
c_func
(paren
l_string|&quot;Not the one we are interested about&quot;
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
id|dev
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
id|rtl8150_t
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dev
)paren
(brace
id|err
c_func
(paren
l_string|&quot;Out of memory&quot;
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
r_else
id|memset
c_func
(paren
id|dev
comma
l_int|0
comma
r_sizeof
(paren
id|rtl8150_t
)paren
)paren
suffix:semicolon
id|netdev
op_assign
id|init_etherdev
c_func
(paren
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|netdev
)paren
(brace
id|kfree
c_func
(paren
id|dev
)paren
suffix:semicolon
id|err
c_func
(paren
l_string|&quot;Oh boy, out of memory again?!?&quot;
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
id|init_MUTEX
c_func
(paren
op_amp
id|dev-&gt;sem
)paren
suffix:semicolon
id|tasklet_init
c_func
(paren
op_amp
id|dev-&gt;tl
comma
id|rx_fixup
comma
(paren
r_int
r_int
)paren
id|dev
)paren
suffix:semicolon
id|spin_lock_init
c_func
(paren
op_amp
id|dev-&gt;rx_pool_lock
)paren
suffix:semicolon
id|down
c_func
(paren
op_amp
id|dev-&gt;sem
)paren
suffix:semicolon
id|dev-&gt;udev
op_assign
id|udev
suffix:semicolon
id|dev-&gt;netdev
op_assign
id|netdev
suffix:semicolon
id|SET_MODULE_OWNER
c_func
(paren
id|netdev
)paren
suffix:semicolon
id|netdev-&gt;priv
op_assign
id|dev
suffix:semicolon
id|netdev-&gt;open
op_assign
id|rtl8150_open
suffix:semicolon
id|netdev-&gt;stop
op_assign
id|rtl8150_close
suffix:semicolon
id|netdev-&gt;do_ioctl
op_assign
id|rtl8150_ioctl
suffix:semicolon
id|netdev-&gt;watchdog_timeo
op_assign
id|RTL8150_TX_TIMEOUT
suffix:semicolon
id|netdev-&gt;tx_timeout
op_assign
id|rtl8150_tx_timeout
suffix:semicolon
id|netdev-&gt;hard_start_xmit
op_assign
id|rtl8150_start_xmit
suffix:semicolon
id|netdev-&gt;set_multicast_list
op_assign
id|rtl8150_set_multicast
suffix:semicolon
id|netdev-&gt;get_stats
op_assign
id|rtl8150_netdev_stats
suffix:semicolon
id|netdev-&gt;mtu
op_assign
id|RTL8150_MTU
suffix:semicolon
id|dev-&gt;intr_interval
op_assign
l_int|100
suffix:semicolon
multiline_comment|/* 100ms */
r_if
c_cond
(paren
op_logical_neg
id|alloc_all_urbs
c_func
(paren
id|dev
)paren
)paren
(brace
id|err
c_func
(paren
l_string|&quot;out of memory&quot;
)paren
suffix:semicolon
r_goto
id|err
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|rtl8150_reset
c_func
(paren
id|dev
)paren
)paren
(brace
id|err
c_func
(paren
l_string|&quot;couldn&squot;t reset the device&quot;
)paren
suffix:semicolon
id|free_all_urbs
c_func
(paren
id|dev
)paren
suffix:semicolon
r_goto
id|err
suffix:semicolon
)brace
id|fill_skb_pool
c_func
(paren
id|dev
)paren
suffix:semicolon
id|set_ethernet_addr
c_func
(paren
id|dev
)paren
suffix:semicolon
id|info
c_func
(paren
l_string|&quot;%s: rtl8150 is detected&quot;
comma
id|netdev-&gt;name
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|dev-&gt;sem
)paren
suffix:semicolon
r_return
id|dev
suffix:semicolon
id|err
suffix:colon
id|unregister_netdev
c_func
(paren
id|dev-&gt;netdev
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|dev-&gt;sem
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|netdev
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|dev
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
DECL|function|rtl8150_disconnect
r_static
r_void
id|rtl8150_disconnect
c_func
(paren
r_struct
id|usb_device
op_star
id|udev
comma
r_void
op_star
id|ptr
)paren
(brace
id|rtl8150_t
op_star
id|dev
suffix:semicolon
id|dev
op_assign
id|ptr
suffix:semicolon
id|set_bit
c_func
(paren
id|RTL8150_UNPLUG
comma
op_amp
id|dev-&gt;flags
)paren
suffix:semicolon
id|unregister_netdev
c_func
(paren
id|dev-&gt;netdev
)paren
suffix:semicolon
id|unlink_all_urbs
c_func
(paren
id|dev
)paren
suffix:semicolon
id|free_all_urbs
c_func
(paren
id|dev
)paren
suffix:semicolon
id|free_skb_pool
c_func
(paren
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dev-&gt;rx_skb
)paren
id|dev_kfree_skb
c_func
(paren
id|dev-&gt;rx_skb
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|dev-&gt;netdev
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|dev
)paren
suffix:semicolon
id|dev-&gt;netdev
op_assign
l_int|NULL
suffix:semicolon
id|dev
op_assign
l_int|NULL
suffix:semicolon
)brace
DECL|function|usb_rtl8150_init
r_static
r_int
id|__init
id|usb_rtl8150_init
c_func
(paren
r_void
)paren
(brace
id|info
c_func
(paren
id|DRIVER_DESC
l_string|&quot; &quot;
id|DRIVER_VERSION
)paren
suffix:semicolon
r_return
id|usb_register
c_func
(paren
op_amp
id|rtl8150_driver
)paren
suffix:semicolon
)brace
DECL|function|usb_rtl8150_exit
r_static
r_void
id|__exit
id|usb_rtl8150_exit
c_func
(paren
r_void
)paren
(brace
id|usb_deregister
c_func
(paren
op_amp
id|rtl8150_driver
)paren
suffix:semicolon
)brace
DECL|variable|usb_rtl8150_init
id|module_init
c_func
(paren
id|usb_rtl8150_init
)paren
suffix:semicolon
DECL|variable|usb_rtl8150_exit
id|module_exit
c_func
(paren
id|usb_rtl8150_exit
)paren
suffix:semicolon
DECL|variable|DRIVER_AUTHOR
id|MODULE_AUTHOR
c_func
(paren
id|DRIVER_AUTHOR
)paren
suffix:semicolon
DECL|variable|DRIVER_DESC
id|MODULE_DESCRIPTION
c_func
(paren
id|DRIVER_DESC
)paren
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
eof
