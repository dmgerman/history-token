multiline_comment|/*&n; *  Copyright (c) 1999-2003 Petko Manolov (petkan@users.sourceforge.net)&n; *&n; * This program is free software; you can redistribute it and/or modify&n; * it under the terms of the GNU General Public License version 2 as&n; * published by the Free Software Foundation.&n; *&n; *&t;ChangeLog:&n; *&t;&t;....&t;Most of the time spent on reading sources &amp; docs.&n; *&t;&t;v0.2.x&t;First official release for the Linux kernel.&n; *&t;&t;v0.3.0&t;Beutified and structured, some bugs fixed.&n; *&t;&t;v0.3.x&t;URBifying bulk requests and bugfixing. First relatively&n; *&t;&t;&t;stable release. Still can touch device&squot;s registers only&n; *&t;&t;&t;from top-halves.&n; *&t;&t;v0.4.0&t;Control messages remained unurbified are now URBs.&n; *&t;&t;&t;Now we can touch the HW at any time.&n; *&t;&t;v0.4.9&t;Control urbs again use process context to wait. Argh...&n; *&t;&t;&t;Some long standing bugs (enable_net_traffic) fixed.&n; *&t;&t;&t;Also nasty trick about resubmiting control urb from&n; *&t;&t;&t;interrupt context used. Please let me know how it&n; *&t;&t;&t;behaves. Pegasus II support added since this version.&n; *&t;&t;&t;TODO: suppressing HCD warnings spewage on disconnect.&n; *&t;&t;v0.4.13&t;Ethernet address is now set at probe(), not at open()&n; *&t;&t;&t;time as this seems to break dhcpd. &n; *&t;&t;v0.5.0&t;branch to 2.5.x kernels&n; *&t;&t;v0.5.1&t;ethtool support added&n; *&t;&t;v0.5.5&t;rx socket buffers are in a pool and the their allocation&n; * &t;&t;&t;is out of the interrupt routine.&n; */
DECL|macro|DEBUG
macro_line|#undef&t;DEBUG
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/delay.h&gt;
macro_line|#include &lt;linux/netdevice.h&gt;
macro_line|#include &lt;linux/etherdevice.h&gt;
macro_line|#include &lt;linux/ethtool.h&gt;
macro_line|#include &lt;linux/mii.h&gt;
macro_line|#include &lt;linux/usb.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;asm/byteorder.h&gt;
macro_line|#include &lt;asm/uaccess.h&gt;
macro_line|#include &quot;pegasus.h&quot;
multiline_comment|/*&n; * Version Information&n; */
DECL|macro|DRIVER_VERSION
mdefine_line|#define DRIVER_VERSION &quot;v0.5.12 (2005/01/13)&quot;
DECL|macro|DRIVER_AUTHOR
mdefine_line|#define DRIVER_AUTHOR &quot;Petko Manolov &lt;petkan@users.sourceforge.net&gt;&quot;
DECL|macro|DRIVER_DESC
mdefine_line|#define DRIVER_DESC &quot;Pegasus/Pegasus II USB Ethernet driver&quot;
DECL|variable|driver_name
r_static
r_const
r_char
id|driver_name
(braket
)braket
op_assign
l_string|&quot;pegasus&quot;
suffix:semicolon
DECL|macro|PEGASUS_WRITE_EEPROM
macro_line|#undef&t;PEGASUS_WRITE_EEPROM
DECL|macro|BMSR_MEDIA
mdefine_line|#define&t;BMSR_MEDIA&t;(BMSR_10HALF | BMSR_10FULL | BMSR_100HALF | &bslash;&n;&t;&t;&t;BMSR_100FULL | BMSR_ANEGCAPABLE)
DECL|variable|loopback
r_static
r_int
id|loopback
op_assign
l_int|0
suffix:semicolon
DECL|variable|mii_mode
r_static
r_int
id|mii_mode
op_assign
l_int|0
suffix:semicolon
DECL|variable|multicast_filter_limit
r_static
r_int
id|multicast_filter_limit
op_assign
l_int|32
suffix:semicolon
DECL|variable|usb_dev_id
r_static
r_struct
id|usb_eth_dev
id|usb_dev_id
(braket
)braket
op_assign
(brace
DECL|macro|PEGASUS_DEV
mdefine_line|#define&t;PEGASUS_DEV(pn, vid, pid, flags)&t;&bslash;&n;&t;{.name = pn, .vendor = vid, .device = pid, .private = flags},
macro_line|#include &quot;pegasus.h&quot;
DECL|macro|PEGASUS_DEV
macro_line|#undef&t;PEGASUS_DEV
(brace
l_int|NULL
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
)brace
suffix:semicolon
DECL|variable|pegasus_ids
r_static
r_struct
id|usb_device_id
id|pegasus_ids
(braket
)braket
op_assign
(brace
DECL|macro|PEGASUS_DEV
mdefine_line|#define&t;PEGASUS_DEV(pn, vid, pid, flags) &bslash;&n;&t;{.match_flags = USB_DEVICE_ID_MATCH_DEVICE, .idVendor = vid, .idProduct = pid},
macro_line|#include &quot;pegasus.h&quot;
DECL|macro|PEGASUS_DEV
macro_line|#undef&t;PEGASUS_DEV
(brace
)brace
)brace
suffix:semicolon
DECL|variable|DRIVER_AUTHOR
id|MODULE_AUTHOR
c_func
(paren
id|DRIVER_AUTHOR
)paren
suffix:semicolon
DECL|variable|DRIVER_DESC
id|MODULE_DESCRIPTION
c_func
(paren
id|DRIVER_DESC
)paren
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|loopback
comma
r_bool
comma
l_int|0
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|mii_mode
comma
r_bool
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|loopback
comma
l_string|&quot;Enable MAC loopback mode (bit 0)&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|mii_mode
comma
l_string|&quot;Enable HomePNA mode (bit 0),default=MII mode = 0&quot;
)paren
suffix:semicolon
id|MODULE_DEVICE_TABLE
c_func
(paren
id|usb
comma
id|pegasus_ids
)paren
suffix:semicolon
r_static
r_int
id|update_eth_regs_async
c_func
(paren
id|pegasus_t
op_star
)paren
suffix:semicolon
multiline_comment|/* Aargh!!! I _really_ hate such tweaks */
DECL|function|ctrl_callback
r_static
r_void
id|ctrl_callback
c_func
(paren
r_struct
id|urb
op_star
id|urb
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|pegasus_t
op_star
id|pegasus
op_assign
id|urb-&gt;context
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|pegasus
)paren
r_return
suffix:semicolon
r_switch
c_cond
(paren
id|urb-&gt;status
)paren
(brace
r_case
l_int|0
suffix:colon
r_if
c_cond
(paren
id|pegasus-&gt;flags
op_amp
id|ETH_REGS_CHANGE
)paren
(brace
id|pegasus-&gt;flags
op_and_assign
op_complement
id|ETH_REGS_CHANGE
suffix:semicolon
id|pegasus-&gt;flags
op_or_assign
id|ETH_REGS_CHANGED
suffix:semicolon
id|update_eth_regs_async
c_func
(paren
id|pegasus
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
op_minus
id|EINPROGRESS
suffix:colon
r_return
suffix:semicolon
r_case
op_minus
id|ENOENT
suffix:colon
r_break
suffix:semicolon
r_default
suffix:colon
id|warn
c_func
(paren
l_string|&quot;%s: status %d&quot;
comma
id|__FUNCTION__
comma
id|urb-&gt;status
)paren
suffix:semicolon
)brace
id|pegasus-&gt;flags
op_and_assign
op_complement
id|ETH_REGS_CHANGED
suffix:semicolon
id|wake_up
c_func
(paren
op_amp
id|pegasus-&gt;ctrl_wait
)paren
suffix:semicolon
)brace
DECL|function|get_registers
r_static
r_int
id|get_registers
c_func
(paren
id|pegasus_t
op_star
id|pegasus
comma
id|__u16
id|indx
comma
id|__u16
id|size
comma
r_void
op_star
id|data
)paren
(brace
r_int
id|ret
suffix:semicolon
r_char
op_star
id|buffer
suffix:semicolon
id|DECLARE_WAITQUEUE
c_func
(paren
id|wait
comma
id|current
)paren
suffix:semicolon
id|buffer
op_assign
id|kmalloc
c_func
(paren
id|size
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|buffer
)paren
(brace
id|warn
c_func
(paren
l_string|&quot;%s: looks like we&squot;re out of memory&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|add_wait_queue
c_func
(paren
op_amp
id|pegasus-&gt;ctrl_wait
comma
op_amp
id|wait
)paren
suffix:semicolon
id|set_current_state
c_func
(paren
id|TASK_UNINTERRUPTIBLE
)paren
suffix:semicolon
r_while
c_loop
(paren
id|pegasus-&gt;flags
op_amp
id|ETH_REGS_CHANGED
)paren
id|schedule
c_func
(paren
)paren
suffix:semicolon
id|remove_wait_queue
c_func
(paren
op_amp
id|pegasus-&gt;ctrl_wait
comma
op_amp
id|wait
)paren
suffix:semicolon
id|set_current_state
c_func
(paren
id|TASK_RUNNING
)paren
suffix:semicolon
id|pegasus-&gt;dr.bRequestType
op_assign
id|PEGASUS_REQT_READ
suffix:semicolon
id|pegasus-&gt;dr.bRequest
op_assign
id|PEGASUS_REQ_GET_REGS
suffix:semicolon
id|pegasus-&gt;dr.wValue
op_assign
id|cpu_to_le16
c_func
(paren
l_int|0
)paren
suffix:semicolon
id|pegasus-&gt;dr.wIndex
op_assign
id|cpu_to_le16p
c_func
(paren
op_amp
id|indx
)paren
suffix:semicolon
id|pegasus-&gt;dr.wLength
op_assign
id|cpu_to_le16p
c_func
(paren
op_amp
id|size
)paren
suffix:semicolon
id|pegasus-&gt;ctrl_urb-&gt;transfer_buffer_length
op_assign
id|size
suffix:semicolon
id|usb_fill_control_urb
c_func
(paren
id|pegasus-&gt;ctrl_urb
comma
id|pegasus-&gt;usb
comma
id|usb_rcvctrlpipe
c_func
(paren
id|pegasus-&gt;usb
comma
l_int|0
)paren
comma
(paren
r_char
op_star
)paren
op_amp
id|pegasus-&gt;dr
comma
id|buffer
comma
id|size
comma
id|ctrl_callback
comma
id|pegasus
)paren
suffix:semicolon
id|add_wait_queue
c_func
(paren
op_amp
id|pegasus-&gt;ctrl_wait
comma
op_amp
id|wait
)paren
suffix:semicolon
id|set_current_state
c_func
(paren
id|TASK_UNINTERRUPTIBLE
)paren
suffix:semicolon
multiline_comment|/* using ATOMIC, we&squot;d never wake up if we slept */
r_if
c_cond
(paren
(paren
id|ret
op_assign
id|usb_submit_urb
c_func
(paren
id|pegasus-&gt;ctrl_urb
comma
id|GFP_ATOMIC
)paren
)paren
)paren
(brace
id|err
c_func
(paren
l_string|&quot;%s: BAD CTRLs %d&quot;
comma
id|__FUNCTION__
comma
id|ret
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|schedule
c_func
(paren
)paren
suffix:semicolon
id|out
suffix:colon
id|remove_wait_queue
c_func
(paren
op_amp
id|pegasus-&gt;ctrl_wait
comma
op_amp
id|wait
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|data
comma
id|buffer
comma
id|size
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|buffer
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
DECL|function|set_registers
r_static
r_int
id|set_registers
c_func
(paren
id|pegasus_t
op_star
id|pegasus
comma
id|__u16
id|indx
comma
id|__u16
id|size
comma
r_void
op_star
id|data
)paren
(brace
r_int
id|ret
suffix:semicolon
r_char
op_star
id|buffer
suffix:semicolon
id|DECLARE_WAITQUEUE
c_func
(paren
id|wait
comma
id|current
)paren
suffix:semicolon
id|buffer
op_assign
id|kmalloc
c_func
(paren
id|size
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|buffer
)paren
(brace
id|warn
c_func
(paren
l_string|&quot;%s: looks like we&squot;re out of memory&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|buffer
comma
id|data
comma
id|size
)paren
suffix:semicolon
id|add_wait_queue
c_func
(paren
op_amp
id|pegasus-&gt;ctrl_wait
comma
op_amp
id|wait
)paren
suffix:semicolon
id|set_current_state
c_func
(paren
id|TASK_UNINTERRUPTIBLE
)paren
suffix:semicolon
r_while
c_loop
(paren
id|pegasus-&gt;flags
op_amp
id|ETH_REGS_CHANGED
)paren
id|schedule
c_func
(paren
)paren
suffix:semicolon
id|remove_wait_queue
c_func
(paren
op_amp
id|pegasus-&gt;ctrl_wait
comma
op_amp
id|wait
)paren
suffix:semicolon
id|set_current_state
c_func
(paren
id|TASK_RUNNING
)paren
suffix:semicolon
id|pegasus-&gt;dr.bRequestType
op_assign
id|PEGASUS_REQT_WRITE
suffix:semicolon
id|pegasus-&gt;dr.bRequest
op_assign
id|PEGASUS_REQ_SET_REGS
suffix:semicolon
id|pegasus-&gt;dr.wValue
op_assign
id|cpu_to_le16
c_func
(paren
l_int|0
)paren
suffix:semicolon
id|pegasus-&gt;dr.wIndex
op_assign
id|cpu_to_le16p
c_func
(paren
op_amp
id|indx
)paren
suffix:semicolon
id|pegasus-&gt;dr.wLength
op_assign
id|cpu_to_le16p
c_func
(paren
op_amp
id|size
)paren
suffix:semicolon
id|pegasus-&gt;ctrl_urb-&gt;transfer_buffer_length
op_assign
id|size
suffix:semicolon
id|usb_fill_control_urb
c_func
(paren
id|pegasus-&gt;ctrl_urb
comma
id|pegasus-&gt;usb
comma
id|usb_sndctrlpipe
c_func
(paren
id|pegasus-&gt;usb
comma
l_int|0
)paren
comma
(paren
r_char
op_star
)paren
op_amp
id|pegasus-&gt;dr
comma
id|buffer
comma
id|size
comma
id|ctrl_callback
comma
id|pegasus
)paren
suffix:semicolon
id|add_wait_queue
c_func
(paren
op_amp
id|pegasus-&gt;ctrl_wait
comma
op_amp
id|wait
)paren
suffix:semicolon
id|set_current_state
c_func
(paren
id|TASK_UNINTERRUPTIBLE
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|ret
op_assign
id|usb_submit_urb
c_func
(paren
id|pegasus-&gt;ctrl_urb
comma
id|GFP_ATOMIC
)paren
)paren
)paren
(brace
id|err
c_func
(paren
l_string|&quot;%s: BAD CTRL %d&quot;
comma
id|__FUNCTION__
comma
id|ret
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|schedule
c_func
(paren
)paren
suffix:semicolon
id|out
suffix:colon
id|remove_wait_queue
c_func
(paren
op_amp
id|pegasus-&gt;ctrl_wait
comma
op_amp
id|wait
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|buffer
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
DECL|function|set_register
r_static
r_int
id|set_register
c_func
(paren
id|pegasus_t
op_star
id|pegasus
comma
id|__u16
id|indx
comma
id|__u8
id|data
)paren
(brace
r_int
id|ret
suffix:semicolon
r_char
op_star
id|tmp
suffix:semicolon
id|DECLARE_WAITQUEUE
c_func
(paren
id|wait
comma
id|current
)paren
suffix:semicolon
id|tmp
op_assign
id|kmalloc
c_func
(paren
l_int|1
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|tmp
)paren
(brace
id|warn
c_func
(paren
l_string|&quot;%s: looks like we&squot;re out of memory&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|tmp
comma
op_amp
id|data
comma
l_int|1
)paren
suffix:semicolon
id|add_wait_queue
c_func
(paren
op_amp
id|pegasus-&gt;ctrl_wait
comma
op_amp
id|wait
)paren
suffix:semicolon
id|set_current_state
c_func
(paren
id|TASK_UNINTERRUPTIBLE
)paren
suffix:semicolon
r_while
c_loop
(paren
id|pegasus-&gt;flags
op_amp
id|ETH_REGS_CHANGED
)paren
id|schedule
c_func
(paren
)paren
suffix:semicolon
id|remove_wait_queue
c_func
(paren
op_amp
id|pegasus-&gt;ctrl_wait
comma
op_amp
id|wait
)paren
suffix:semicolon
id|set_current_state
c_func
(paren
id|TASK_RUNNING
)paren
suffix:semicolon
id|pegasus-&gt;dr.bRequestType
op_assign
id|PEGASUS_REQT_WRITE
suffix:semicolon
id|pegasus-&gt;dr.bRequest
op_assign
id|PEGASUS_REQ_SET_REG
suffix:semicolon
id|pegasus-&gt;dr.wValue
op_assign
id|cpu_to_le16
c_func
(paren
id|data
)paren
suffix:semicolon
id|pegasus-&gt;dr.wIndex
op_assign
id|cpu_to_le16p
c_func
(paren
op_amp
id|indx
)paren
suffix:semicolon
id|pegasus-&gt;dr.wLength
op_assign
id|cpu_to_le16
c_func
(paren
l_int|1
)paren
suffix:semicolon
id|pegasus-&gt;ctrl_urb-&gt;transfer_buffer_length
op_assign
l_int|1
suffix:semicolon
id|usb_fill_control_urb
c_func
(paren
id|pegasus-&gt;ctrl_urb
comma
id|pegasus-&gt;usb
comma
id|usb_sndctrlpipe
c_func
(paren
id|pegasus-&gt;usb
comma
l_int|0
)paren
comma
(paren
r_char
op_star
)paren
op_amp
id|pegasus-&gt;dr
comma
op_amp
id|tmp
comma
l_int|1
comma
id|ctrl_callback
comma
id|pegasus
)paren
suffix:semicolon
id|add_wait_queue
c_func
(paren
op_amp
id|pegasus-&gt;ctrl_wait
comma
op_amp
id|wait
)paren
suffix:semicolon
id|set_current_state
c_func
(paren
id|TASK_UNINTERRUPTIBLE
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|ret
op_assign
id|usb_submit_urb
c_func
(paren
id|pegasus-&gt;ctrl_urb
comma
id|GFP_ATOMIC
)paren
)paren
)paren
(brace
id|err
c_func
(paren
l_string|&quot;%s: BAD CTRL %d&quot;
comma
id|__FUNCTION__
comma
id|ret
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|schedule
c_func
(paren
)paren
suffix:semicolon
id|out
suffix:colon
id|remove_wait_queue
c_func
(paren
op_amp
id|pegasus-&gt;ctrl_wait
comma
op_amp
id|wait
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|tmp
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
DECL|function|update_eth_regs_async
r_static
r_int
id|update_eth_regs_async
c_func
(paren
id|pegasus_t
op_star
id|pegasus
)paren
(brace
r_int
id|ret
suffix:semicolon
id|pegasus-&gt;dr.bRequestType
op_assign
id|PEGASUS_REQT_WRITE
suffix:semicolon
id|pegasus-&gt;dr.bRequest
op_assign
id|PEGASUS_REQ_SET_REGS
suffix:semicolon
id|pegasus-&gt;dr.wValue
op_assign
l_int|0
suffix:semicolon
id|pegasus-&gt;dr.wIndex
op_assign
id|cpu_to_le16
c_func
(paren
id|EthCtrl0
)paren
suffix:semicolon
id|pegasus-&gt;dr.wLength
op_assign
id|cpu_to_le16
c_func
(paren
l_int|3
)paren
suffix:semicolon
id|pegasus-&gt;ctrl_urb-&gt;transfer_buffer_length
op_assign
l_int|3
suffix:semicolon
id|usb_fill_control_urb
c_func
(paren
id|pegasus-&gt;ctrl_urb
comma
id|pegasus-&gt;usb
comma
id|usb_sndctrlpipe
c_func
(paren
id|pegasus-&gt;usb
comma
l_int|0
)paren
comma
(paren
r_char
op_star
)paren
op_amp
id|pegasus-&gt;dr
comma
id|pegasus-&gt;eth_regs
comma
l_int|3
comma
id|ctrl_callback
comma
id|pegasus
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|ret
op_assign
id|usb_submit_urb
c_func
(paren
id|pegasus-&gt;ctrl_urb
comma
id|GFP_ATOMIC
)paren
)paren
)paren
id|err
c_func
(paren
l_string|&quot;%s: BAD CTRL %d, flgs %x&quot;
comma
id|__FUNCTION__
comma
id|ret
comma
id|pegasus-&gt;flags
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
DECL|function|read_mii_word
r_static
r_int
id|read_mii_word
c_func
(paren
id|pegasus_t
op_star
id|pegasus
comma
id|__u8
id|phy
comma
id|__u8
id|indx
comma
id|__u16
op_star
id|regd
)paren
(brace
r_int
id|i
suffix:semicolon
id|__u8
id|data
(braket
l_int|4
)braket
op_assign
(brace
id|phy
comma
l_int|0
comma
l_int|0
comma
id|indx
)brace
suffix:semicolon
id|__le16
id|regdi
suffix:semicolon
id|set_register
c_func
(paren
id|pegasus
comma
id|PhyCtrl
comma
l_int|0
)paren
suffix:semicolon
id|set_registers
c_func
(paren
id|pegasus
comma
id|PhyAddr
comma
r_sizeof
(paren
id|data
)paren
comma
id|data
)paren
suffix:semicolon
id|set_register
c_func
(paren
id|pegasus
comma
id|PhyCtrl
comma
(paren
id|indx
op_or
id|PHY_READ
)paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|REG_TIMEOUT
suffix:semicolon
id|i
op_increment
)paren
(brace
id|get_registers
c_func
(paren
id|pegasus
comma
id|PhyCtrl
comma
l_int|1
comma
id|data
)paren
suffix:semicolon
r_if
c_cond
(paren
id|data
(braket
l_int|0
)braket
op_amp
id|PHY_DONE
)paren
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|i
OL
id|REG_TIMEOUT
)paren
(brace
id|get_registers
c_func
(paren
id|pegasus
comma
id|PhyData
comma
l_int|2
comma
op_amp
id|regdi
)paren
suffix:semicolon
op_star
id|regd
op_assign
id|le16_to_cpu
c_func
(paren
id|regdi
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|warn
c_func
(paren
l_string|&quot;%s: failed&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|mdio_read
r_static
r_int
id|mdio_read
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_int
id|phy_id
comma
r_int
id|loc
)paren
(brace
id|pegasus_t
op_star
id|pegasus
op_assign
(paren
id|pegasus_t
op_star
)paren
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
r_int
id|res
suffix:semicolon
id|read_mii_word
c_func
(paren
id|pegasus
comma
id|phy_id
comma
id|loc
comma
(paren
id|u16
op_star
)paren
op_amp
id|res
)paren
suffix:semicolon
r_return
id|res
op_amp
l_int|0xffff
suffix:semicolon
)brace
DECL|function|write_mii_word
r_static
r_int
id|write_mii_word
c_func
(paren
id|pegasus_t
op_star
id|pegasus
comma
id|__u8
id|phy
comma
id|__u8
id|indx
comma
id|__u16
id|regd
)paren
(brace
r_int
id|i
suffix:semicolon
id|__u8
id|data
(braket
l_int|4
)braket
op_assign
(brace
id|phy
comma
l_int|0
comma
l_int|0
comma
id|indx
)brace
suffix:semicolon
op_star
(paren
id|data
op_plus
l_int|1
)paren
op_assign
id|cpu_to_le16p
c_func
(paren
op_amp
id|regd
)paren
suffix:semicolon
id|set_register
c_func
(paren
id|pegasus
comma
id|PhyCtrl
comma
l_int|0
)paren
suffix:semicolon
id|set_registers
c_func
(paren
id|pegasus
comma
id|PhyAddr
comma
r_sizeof
(paren
id|data
)paren
comma
id|data
)paren
suffix:semicolon
id|set_register
c_func
(paren
id|pegasus
comma
id|PhyCtrl
comma
(paren
id|indx
op_or
id|PHY_WRITE
)paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|REG_TIMEOUT
suffix:semicolon
id|i
op_increment
)paren
(brace
id|get_registers
c_func
(paren
id|pegasus
comma
id|PhyCtrl
comma
l_int|1
comma
id|data
)paren
suffix:semicolon
r_if
c_cond
(paren
id|data
(braket
l_int|0
)braket
op_amp
id|PHY_DONE
)paren
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|i
OL
id|REG_TIMEOUT
)paren
r_return
l_int|0
suffix:semicolon
id|warn
c_func
(paren
l_string|&quot;%s: failed&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|mdio_write
r_static
r_void
id|mdio_write
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_int
id|phy_id
comma
r_int
id|loc
comma
r_int
id|val
)paren
(brace
id|pegasus_t
op_star
id|pegasus
op_assign
(paren
id|pegasus_t
op_star
)paren
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
id|write_mii_word
c_func
(paren
id|pegasus
comma
id|phy_id
comma
id|loc
comma
id|val
)paren
suffix:semicolon
)brace
DECL|function|read_eprom_word
r_static
r_int
id|read_eprom_word
c_func
(paren
id|pegasus_t
op_star
id|pegasus
comma
id|__u8
id|index
comma
id|__u16
op_star
id|retdata
)paren
(brace
r_int
id|i
suffix:semicolon
id|__u8
id|tmp
suffix:semicolon
id|__le16
id|retdatai
suffix:semicolon
id|set_register
c_func
(paren
id|pegasus
comma
id|EpromCtrl
comma
l_int|0
)paren
suffix:semicolon
id|set_register
c_func
(paren
id|pegasus
comma
id|EpromOffset
comma
id|index
)paren
suffix:semicolon
id|set_register
c_func
(paren
id|pegasus
comma
id|EpromCtrl
comma
id|EPROM_READ
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|REG_TIMEOUT
suffix:semicolon
id|i
op_increment
)paren
(brace
id|get_registers
c_func
(paren
id|pegasus
comma
id|EpromCtrl
comma
l_int|1
comma
op_amp
id|tmp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tmp
op_amp
id|EPROM_DONE
)paren
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|i
OL
id|REG_TIMEOUT
)paren
(brace
id|get_registers
c_func
(paren
id|pegasus
comma
id|EpromData
comma
l_int|2
comma
op_amp
id|retdatai
)paren
suffix:semicolon
op_star
id|retdata
op_assign
id|le16_to_cpu
c_func
(paren
id|retdatai
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|warn
c_func
(paren
l_string|&quot;%s: failed&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
macro_line|#ifdef&t;PEGASUS_WRITE_EEPROM
DECL|function|enable_eprom_write
r_static
r_inline
r_void
id|enable_eprom_write
c_func
(paren
id|pegasus_t
op_star
id|pegasus
)paren
(brace
id|__u8
id|tmp
suffix:semicolon
id|get_registers
c_func
(paren
id|pegasus
comma
id|EthCtrl2
comma
l_int|1
comma
op_amp
id|tmp
)paren
suffix:semicolon
id|set_register
c_func
(paren
id|pegasus
comma
id|EthCtrl2
comma
id|tmp
op_or
id|EPROM_WR_ENABLE
)paren
suffix:semicolon
)brace
DECL|function|disable_eprom_write
r_static
r_inline
r_void
id|disable_eprom_write
c_func
(paren
id|pegasus_t
op_star
id|pegasus
)paren
(brace
id|__u8
id|tmp
suffix:semicolon
id|get_registers
c_func
(paren
id|pegasus
comma
id|EthCtrl2
comma
l_int|1
comma
op_amp
id|tmp
)paren
suffix:semicolon
id|set_register
c_func
(paren
id|pegasus
comma
id|EpromCtrl
comma
l_int|0
)paren
suffix:semicolon
id|set_register
c_func
(paren
id|pegasus
comma
id|EthCtrl2
comma
id|tmp
op_amp
op_complement
id|EPROM_WR_ENABLE
)paren
suffix:semicolon
)brace
DECL|function|write_eprom_word
r_static
r_int
id|write_eprom_word
c_func
(paren
id|pegasus_t
op_star
id|pegasus
comma
id|__u8
id|index
comma
id|__u16
id|data
)paren
(brace
r_int
id|i
suffix:semicolon
id|__u8
id|tmp
comma
id|d
(braket
l_int|4
)braket
op_assign
(brace
l_int|0x3f
comma
l_int|0
comma
l_int|0
comma
id|EPROM_WRITE
)brace
suffix:semicolon
id|set_registers
c_func
(paren
id|pegasus
comma
id|EpromOffset
comma
l_int|4
comma
id|d
)paren
suffix:semicolon
id|enable_eprom_write
c_func
(paren
id|pegasus
)paren
suffix:semicolon
id|set_register
c_func
(paren
id|pegasus
comma
id|EpromOffset
comma
id|index
)paren
suffix:semicolon
id|set_registers
c_func
(paren
id|pegasus
comma
id|EpromData
comma
l_int|2
comma
op_amp
id|data
)paren
suffix:semicolon
id|set_register
c_func
(paren
id|pegasus
comma
id|EpromCtrl
comma
id|EPROM_WRITE
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|REG_TIMEOUT
suffix:semicolon
id|i
op_increment
)paren
(brace
id|get_registers
c_func
(paren
id|pegasus
comma
id|EpromCtrl
comma
l_int|1
comma
op_amp
id|tmp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tmp
op_amp
id|EPROM_DONE
)paren
r_break
suffix:semicolon
)brace
id|disable_eprom_write
c_func
(paren
id|pegasus
)paren
suffix:semicolon
r_if
c_cond
(paren
id|i
OL
id|REG_TIMEOUT
)paren
r_return
l_int|0
suffix:semicolon
id|warn
c_func
(paren
l_string|&quot;%s: failed&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
macro_line|#endif&t;&t;&t;&t;/* PEGASUS_WRITE_EEPROM */
DECL|function|get_node_id
r_static
r_inline
r_void
id|get_node_id
c_func
(paren
id|pegasus_t
op_star
id|pegasus
comma
id|__u8
op_star
id|id
)paren
(brace
r_int
id|i
suffix:semicolon
id|__u16
id|w16
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|3
suffix:semicolon
id|i
op_increment
)paren
(brace
id|read_eprom_word
c_func
(paren
id|pegasus
comma
id|i
comma
op_amp
id|w16
)paren
suffix:semicolon
(paren
(paren
id|__le16
op_star
)paren
id|id
)paren
(braket
id|i
)braket
op_assign
id|cpu_to_le16p
c_func
(paren
op_amp
id|w16
)paren
suffix:semicolon
)brace
)brace
DECL|function|set_ethernet_addr
r_static
r_void
id|set_ethernet_addr
c_func
(paren
id|pegasus_t
op_star
id|pegasus
)paren
(brace
id|__u8
id|node_id
(braket
l_int|6
)braket
suffix:semicolon
id|get_node_id
c_func
(paren
id|pegasus
comma
id|node_id
)paren
suffix:semicolon
id|set_registers
c_func
(paren
id|pegasus
comma
id|EthID
comma
r_sizeof
(paren
id|node_id
)paren
comma
id|node_id
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|pegasus-&gt;net-&gt;dev_addr
comma
id|node_id
comma
r_sizeof
(paren
id|node_id
)paren
)paren
suffix:semicolon
)brace
DECL|function|reset_mac
r_static
r_inline
r_int
id|reset_mac
c_func
(paren
id|pegasus_t
op_star
id|pegasus
)paren
(brace
id|__u8
id|data
op_assign
l_int|0x8
suffix:semicolon
r_int
id|i
suffix:semicolon
id|set_register
c_func
(paren
id|pegasus
comma
id|EthCtrl1
comma
id|data
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|REG_TIMEOUT
suffix:semicolon
id|i
op_increment
)paren
(brace
id|get_registers
c_func
(paren
id|pegasus
comma
id|EthCtrl1
comma
l_int|1
comma
op_amp
id|data
)paren
suffix:semicolon
r_if
c_cond
(paren
op_complement
id|data
op_amp
l_int|0x08
)paren
(brace
r_if
c_cond
(paren
id|loopback
op_amp
l_int|1
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
id|mii_mode
op_logical_and
(paren
id|pegasus-&gt;features
op_amp
id|HAS_HOME_PNA
)paren
)paren
id|set_register
c_func
(paren
id|pegasus
comma
id|Gpio1
comma
l_int|0x34
)paren
suffix:semicolon
r_else
id|set_register
c_func
(paren
id|pegasus
comma
id|Gpio1
comma
l_int|0x26
)paren
suffix:semicolon
id|set_register
c_func
(paren
id|pegasus
comma
id|Gpio0
comma
id|pegasus-&gt;features
)paren
suffix:semicolon
id|set_register
c_func
(paren
id|pegasus
comma
id|Gpio0
comma
id|DEFAULT_GPIO_SET
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|i
op_eq
id|REG_TIMEOUT
)paren
r_return
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|usb_dev_id
(braket
id|pegasus-&gt;dev_index
)braket
dot
id|vendor
op_eq
id|VENDOR_LINKSYS
op_logical_or
id|usb_dev_id
(braket
id|pegasus-&gt;dev_index
)braket
dot
id|vendor
op_eq
id|VENDOR_DLINK
)paren
(brace
id|set_register
c_func
(paren
id|pegasus
comma
id|Gpio0
comma
l_int|0x24
)paren
suffix:semicolon
id|set_register
c_func
(paren
id|pegasus
comma
id|Gpio0
comma
l_int|0x26
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|usb_dev_id
(braket
id|pegasus-&gt;dev_index
)braket
dot
id|vendor
op_eq
id|VENDOR_ELCON
)paren
(brace
id|__u16
id|auxmode
suffix:semicolon
id|read_mii_word
c_func
(paren
id|pegasus
comma
l_int|3
comma
l_int|0x1b
comma
op_amp
id|auxmode
)paren
suffix:semicolon
id|write_mii_word
c_func
(paren
id|pegasus
comma
l_int|3
comma
l_int|0x1b
comma
id|auxmode
op_or
l_int|4
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|enable_net_traffic
r_static
r_int
id|enable_net_traffic
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|usb_device
op_star
id|usb
)paren
(brace
id|__u16
id|linkpart
suffix:semicolon
id|__u8
id|data
(braket
l_int|4
)braket
suffix:semicolon
id|pegasus_t
op_star
id|pegasus
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
id|read_mii_word
c_func
(paren
id|pegasus
comma
id|pegasus-&gt;phy
comma
id|MII_LPA
comma
op_amp
id|linkpart
)paren
suffix:semicolon
id|data
(braket
l_int|0
)braket
op_assign
l_int|0xc9
suffix:semicolon
id|data
(braket
l_int|1
)braket
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|linkpart
op_amp
(paren
id|ADVERTISE_100FULL
op_or
id|ADVERTISE_10FULL
)paren
)paren
id|data
(braket
l_int|1
)braket
op_or_assign
l_int|0x20
suffix:semicolon
multiline_comment|/* set full duplex */
r_if
c_cond
(paren
id|linkpart
op_amp
(paren
id|ADVERTISE_100FULL
op_or
id|ADVERTISE_100HALF
)paren
)paren
id|data
(braket
l_int|1
)braket
op_or_assign
l_int|0x10
suffix:semicolon
multiline_comment|/* set 100 Mbps */
r_if
c_cond
(paren
id|mii_mode
)paren
id|data
(braket
l_int|1
)braket
op_assign
l_int|0
suffix:semicolon
id|data
(braket
l_int|2
)braket
op_assign
(paren
id|loopback
op_amp
l_int|1
)paren
ques
c_cond
l_int|0x09
suffix:colon
l_int|0x01
suffix:semicolon
id|memcpy
c_func
(paren
id|pegasus-&gt;eth_regs
comma
id|data
comma
r_sizeof
(paren
id|data
)paren
)paren
suffix:semicolon
id|set_registers
c_func
(paren
id|pegasus
comma
id|EthCtrl0
comma
l_int|3
comma
id|data
)paren
suffix:semicolon
r_if
c_cond
(paren
id|usb_dev_id
(braket
id|pegasus-&gt;dev_index
)braket
dot
id|vendor
op_eq
id|VENDOR_LINKSYS
op_logical_or
id|usb_dev_id
(braket
id|pegasus-&gt;dev_index
)braket
dot
id|vendor
op_eq
id|VENDOR_DLINK
)paren
(brace
id|u16
id|auxmode
suffix:semicolon
id|read_mii_word
c_func
(paren
id|pegasus
comma
l_int|0
comma
l_int|0x1b
comma
op_amp
id|auxmode
)paren
suffix:semicolon
id|write_mii_word
c_func
(paren
id|pegasus
comma
l_int|0
comma
l_int|0x1b
comma
id|auxmode
op_or
l_int|4
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|fill_skb_pool
r_static
r_void
id|fill_skb_pool
c_func
(paren
id|pegasus_t
op_star
id|pegasus
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|RX_SKBS
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|pegasus-&gt;rx_pool
(braket
id|i
)braket
)paren
r_continue
suffix:semicolon
id|pegasus-&gt;rx_pool
(braket
id|i
)braket
op_assign
id|dev_alloc_skb
c_func
(paren
id|PEGASUS_MTU
op_plus
l_int|2
)paren
suffix:semicolon
multiline_comment|/*&n;&t;&t; ** we give up if the allocation fail. the tasklet will be&n;&t;&t; ** rescheduled again anyway...&n;&t;&t; */
r_if
c_cond
(paren
id|pegasus-&gt;rx_pool
(braket
id|i
)braket
op_eq
l_int|NULL
)paren
r_return
suffix:semicolon
id|pegasus-&gt;rx_pool
(braket
id|i
)braket
op_member_access_from_pointer
id|dev
op_assign
id|pegasus-&gt;net
suffix:semicolon
id|skb_reserve
c_func
(paren
id|pegasus-&gt;rx_pool
(braket
id|i
)braket
comma
l_int|2
)paren
suffix:semicolon
)brace
)brace
DECL|function|free_skb_pool
r_static
r_void
id|free_skb_pool
c_func
(paren
id|pegasus_t
op_star
id|pegasus
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|RX_SKBS
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|pegasus-&gt;rx_pool
(braket
id|i
)braket
)paren
(brace
id|dev_kfree_skb
c_func
(paren
id|pegasus-&gt;rx_pool
(braket
id|i
)braket
)paren
suffix:semicolon
id|pegasus-&gt;rx_pool
(braket
id|i
)braket
op_assign
l_int|NULL
suffix:semicolon
)brace
)brace
)brace
DECL|function|pull_skb
r_static
r_inline
r_struct
id|sk_buff
op_star
id|pull_skb
c_func
(paren
id|pegasus_t
op_star
id|pegasus
)paren
(brace
r_int
id|i
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|RX_SKBS
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|likely
c_func
(paren
id|pegasus-&gt;rx_pool
(braket
id|i
)braket
op_ne
l_int|NULL
)paren
)paren
(brace
id|skb
op_assign
id|pegasus-&gt;rx_pool
(braket
id|i
)braket
suffix:semicolon
id|pegasus-&gt;rx_pool
(braket
id|i
)braket
op_assign
l_int|NULL
suffix:semicolon
r_return
id|skb
suffix:semicolon
)brace
)brace
r_return
l_int|NULL
suffix:semicolon
)brace
DECL|function|read_bulk_callback
r_static
r_void
id|read_bulk_callback
c_func
(paren
r_struct
id|urb
op_star
id|urb
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|pegasus_t
op_star
id|pegasus
op_assign
id|urb-&gt;context
suffix:semicolon
r_struct
id|net_device
op_star
id|net
suffix:semicolon
r_int
id|rx_status
comma
id|count
op_assign
id|urb-&gt;actual_length
suffix:semicolon
id|__u16
id|pkt_len
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|pegasus
op_logical_or
op_logical_neg
(paren
id|pegasus-&gt;flags
op_amp
id|PEGASUS_RUNNING
)paren
)paren
r_return
suffix:semicolon
id|net
op_assign
id|pegasus-&gt;net
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|netif_device_present
c_func
(paren
id|net
)paren
)paren
r_return
suffix:semicolon
r_switch
c_cond
(paren
id|urb-&gt;status
)paren
(brace
r_case
l_int|0
suffix:colon
r_break
suffix:semicolon
r_case
op_minus
id|ETIMEDOUT
suffix:colon
id|dbg
c_func
(paren
l_string|&quot;%s: reset MAC&quot;
comma
id|net-&gt;name
)paren
suffix:semicolon
id|pegasus-&gt;flags
op_and_assign
op_complement
id|PEGASUS_RX_BUSY
suffix:semicolon
r_break
suffix:semicolon
r_case
op_minus
id|EPIPE
suffix:colon
multiline_comment|/* stall, or disconnect from TT */
multiline_comment|/* FIXME schedule work to clear the halt */
id|warn
c_func
(paren
l_string|&quot;%s: no rx stall recovery&quot;
comma
id|net-&gt;name
)paren
suffix:semicolon
r_return
suffix:semicolon
r_case
op_minus
id|ENOENT
suffix:colon
r_case
op_minus
id|ECONNRESET
suffix:colon
r_case
op_minus
id|ESHUTDOWN
suffix:colon
id|dbg
c_func
(paren
l_string|&quot;%s: rx unlink, %d&quot;
comma
id|net-&gt;name
comma
id|urb-&gt;status
)paren
suffix:semicolon
r_return
suffix:semicolon
r_default
suffix:colon
id|dbg
c_func
(paren
l_string|&quot;%s: RX status %d&quot;
comma
id|net-&gt;name
comma
id|urb-&gt;status
)paren
suffix:semicolon
r_goto
id|goon
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|count
)paren
r_goto
id|goon
suffix:semicolon
id|rx_status
op_assign
id|le32_to_cpu
c_func
(paren
op_star
(paren
id|__le32
op_star
)paren
(paren
id|urb-&gt;transfer_buffer
op_plus
id|count
op_minus
l_int|4
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rx_status
op_amp
l_int|0x000e0000
)paren
(brace
id|dbg
c_func
(paren
l_string|&quot;%s: RX packet error %x&quot;
comma
id|net-&gt;name
comma
id|rx_status
op_amp
l_int|0xe0000
)paren
suffix:semicolon
id|pegasus-&gt;stats.rx_errors
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|rx_status
op_amp
l_int|0x060000
)paren
id|pegasus-&gt;stats.rx_length_errors
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|rx_status
op_amp
l_int|0x080000
)paren
id|pegasus-&gt;stats.rx_crc_errors
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|rx_status
op_amp
l_int|0x100000
)paren
id|pegasus-&gt;stats.rx_frame_errors
op_increment
suffix:semicolon
r_goto
id|goon
suffix:semicolon
)brace
r_if
c_cond
(paren
id|pegasus-&gt;chip
op_eq
l_int|0x8513
)paren
(brace
id|pkt_len
op_assign
id|le32_to_cpu
c_func
(paren
op_star
(paren
id|__le32
op_star
)paren
id|urb-&gt;transfer_buffer
)paren
suffix:semicolon
id|pkt_len
op_and_assign
l_int|0x0fff
suffix:semicolon
id|pegasus-&gt;rx_skb-&gt;data
op_add_assign
l_int|2
suffix:semicolon
)brace
r_else
(brace
id|pkt_len
op_assign
(paren
id|rx_status
op_amp
l_int|0xfff
)paren
op_minus
l_int|8
suffix:semicolon
)brace
multiline_comment|/*&n;&t; * at this point we are sure pegasus-&gt;rx_skb != NULL&n;&t; * so we go ahead and pass up the packet.&n;&t; */
id|skb_put
c_func
(paren
id|pegasus-&gt;rx_skb
comma
id|pkt_len
)paren
suffix:semicolon
id|pegasus-&gt;rx_skb-&gt;protocol
op_assign
id|eth_type_trans
c_func
(paren
id|pegasus-&gt;rx_skb
comma
id|net
)paren
suffix:semicolon
id|netif_rx
c_func
(paren
id|pegasus-&gt;rx_skb
)paren
suffix:semicolon
id|pegasus-&gt;stats.rx_packets
op_increment
suffix:semicolon
id|pegasus-&gt;stats.rx_bytes
op_add_assign
id|pkt_len
suffix:semicolon
r_if
c_cond
(paren
id|pegasus-&gt;flags
op_amp
id|PEGASUS_UNPLUG
)paren
r_return
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|pegasus-&gt;rx_pool_lock
)paren
suffix:semicolon
id|pegasus-&gt;rx_skb
op_assign
id|pull_skb
c_func
(paren
id|pegasus
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|pegasus-&gt;rx_pool_lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pegasus-&gt;rx_skb
op_eq
l_int|NULL
)paren
r_goto
id|tl_sched
suffix:semicolon
id|goon
suffix:colon
id|usb_fill_bulk_urb
c_func
(paren
id|pegasus-&gt;rx_urb
comma
id|pegasus-&gt;usb
comma
id|usb_rcvbulkpipe
c_func
(paren
id|pegasus-&gt;usb
comma
l_int|1
)paren
comma
id|pegasus-&gt;rx_skb-&gt;data
comma
id|PEGASUS_MTU
op_plus
l_int|8
comma
id|read_bulk_callback
comma
id|pegasus
)paren
suffix:semicolon
r_if
c_cond
(paren
id|usb_submit_urb
c_func
(paren
id|pegasus-&gt;rx_urb
comma
id|GFP_ATOMIC
)paren
)paren
(brace
id|pegasus-&gt;flags
op_or_assign
id|PEGASUS_RX_URB_FAIL
suffix:semicolon
r_goto
id|tl_sched
suffix:semicolon
)brace
r_else
(brace
id|pegasus-&gt;flags
op_and_assign
op_complement
id|PEGASUS_RX_URB_FAIL
suffix:semicolon
)brace
r_return
suffix:semicolon
id|tl_sched
suffix:colon
id|tasklet_schedule
c_func
(paren
op_amp
id|pegasus-&gt;rx_tl
)paren
suffix:semicolon
)brace
DECL|function|rx_fixup
r_static
r_void
id|rx_fixup
c_func
(paren
r_int
r_int
id|data
)paren
(brace
id|pegasus_t
op_star
id|pegasus
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|pegasus
op_assign
(paren
id|pegasus_t
op_star
)paren
id|data
suffix:semicolon
r_if
c_cond
(paren
id|pegasus-&gt;flags
op_amp
id|PEGASUS_UNPLUG
)paren
r_return
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|pegasus-&gt;rx_pool_lock
comma
id|flags
)paren
suffix:semicolon
id|fill_skb_pool
c_func
(paren
id|pegasus
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pegasus-&gt;flags
op_amp
id|PEGASUS_RX_URB_FAIL
)paren
r_if
c_cond
(paren
id|pegasus-&gt;rx_skb
)paren
r_goto
id|try_again
suffix:semicolon
r_if
c_cond
(paren
id|pegasus-&gt;rx_skb
op_eq
l_int|NULL
)paren
(brace
id|pegasus-&gt;rx_skb
op_assign
id|pull_skb
c_func
(paren
id|pegasus
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|pegasus-&gt;rx_skb
op_eq
l_int|NULL
)paren
(brace
id|warn
c_func
(paren
l_string|&quot;wow, low on memory&quot;
)paren
suffix:semicolon
id|tasklet_schedule
c_func
(paren
op_amp
id|pegasus-&gt;rx_tl
)paren
suffix:semicolon
r_goto
id|done
suffix:semicolon
)brace
id|usb_fill_bulk_urb
c_func
(paren
id|pegasus-&gt;rx_urb
comma
id|pegasus-&gt;usb
comma
id|usb_rcvbulkpipe
c_func
(paren
id|pegasus-&gt;usb
comma
l_int|1
)paren
comma
id|pegasus-&gt;rx_skb-&gt;data
comma
id|PEGASUS_MTU
op_plus
l_int|8
comma
id|read_bulk_callback
comma
id|pegasus
)paren
suffix:semicolon
id|try_again
suffix:colon
r_if
c_cond
(paren
id|usb_submit_urb
c_func
(paren
id|pegasus-&gt;rx_urb
comma
id|GFP_ATOMIC
)paren
)paren
(brace
id|pegasus-&gt;flags
op_or_assign
id|PEGASUS_RX_URB_FAIL
suffix:semicolon
id|tasklet_schedule
c_func
(paren
op_amp
id|pegasus-&gt;rx_tl
)paren
suffix:semicolon
)brace
r_else
(brace
id|pegasus-&gt;flags
op_and_assign
op_complement
id|PEGASUS_RX_URB_FAIL
suffix:semicolon
)brace
id|done
suffix:colon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|pegasus-&gt;rx_pool_lock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|write_bulk_callback
r_static
r_void
id|write_bulk_callback
c_func
(paren
r_struct
id|urb
op_star
id|urb
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|pegasus_t
op_star
id|pegasus
op_assign
id|urb-&gt;context
suffix:semicolon
r_struct
id|net_device
op_star
id|net
op_assign
id|pegasus-&gt;net
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|pegasus
op_logical_or
op_logical_neg
(paren
id|pegasus-&gt;flags
op_amp
id|PEGASUS_RUNNING
)paren
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|netif_device_present
c_func
(paren
id|net
)paren
)paren
r_return
suffix:semicolon
r_switch
c_cond
(paren
id|urb-&gt;status
)paren
(brace
r_case
op_minus
id|EPIPE
suffix:colon
multiline_comment|/* FIXME schedule_work() to clear the tx halt */
id|netif_stop_queue
c_func
(paren
id|net
)paren
suffix:semicolon
id|warn
c_func
(paren
l_string|&quot;%s: no tx stall recovery&quot;
comma
id|net-&gt;name
)paren
suffix:semicolon
r_return
suffix:semicolon
r_case
op_minus
id|ENOENT
suffix:colon
r_case
op_minus
id|ECONNRESET
suffix:colon
r_case
op_minus
id|ESHUTDOWN
suffix:colon
id|dbg
c_func
(paren
l_string|&quot;%s: tx unlink, %d&quot;
comma
id|net-&gt;name
comma
id|urb-&gt;status
)paren
suffix:semicolon
r_return
suffix:semicolon
r_default
suffix:colon
id|info
c_func
(paren
l_string|&quot;%s: TX status %d&quot;
comma
id|net-&gt;name
comma
id|urb-&gt;status
)paren
suffix:semicolon
multiline_comment|/* FALL THROUGH */
r_case
l_int|0
suffix:colon
r_break
suffix:semicolon
)brace
id|net-&gt;trans_start
op_assign
id|jiffies
suffix:semicolon
id|netif_wake_queue
c_func
(paren
id|net
)paren
suffix:semicolon
)brace
DECL|function|intr_callback
r_static
r_void
id|intr_callback
c_func
(paren
r_struct
id|urb
op_star
id|urb
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|pegasus_t
op_star
id|pegasus
op_assign
id|urb-&gt;context
suffix:semicolon
r_struct
id|net_device
op_star
id|net
suffix:semicolon
r_int
id|status
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|pegasus
)paren
r_return
suffix:semicolon
id|net
op_assign
id|pegasus-&gt;net
suffix:semicolon
r_switch
c_cond
(paren
id|urb-&gt;status
)paren
(brace
r_case
l_int|0
suffix:colon
r_break
suffix:semicolon
r_case
op_minus
id|ECONNRESET
suffix:colon
multiline_comment|/* unlink */
r_case
op_minus
id|ENOENT
suffix:colon
r_case
op_minus
id|ESHUTDOWN
suffix:colon
r_return
suffix:semicolon
r_default
suffix:colon
multiline_comment|/* some Pegasus-I products report LOTS of data&n;&t;&t; * toggle errors... avoid log spamming&n;&t;&t; */
id|pr_debug
c_func
(paren
l_string|&quot;%s: intr status %d&bslash;n&quot;
comma
id|net-&gt;name
comma
id|urb-&gt;status
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|urb-&gt;actual_length
op_ge
l_int|6
)paren
(brace
id|u8
op_star
id|d
op_assign
id|urb-&gt;transfer_buffer
suffix:semicolon
multiline_comment|/* byte 0 == tx_status1, reg 2B */
r_if
c_cond
(paren
id|d
(braket
l_int|0
)braket
op_amp
(paren
id|TX_UNDERRUN
op_or
id|EXCESSIVE_COL
op_or
id|LATE_COL
op_or
id|JABBER_TIMEOUT
)paren
)paren
(brace
id|pegasus-&gt;stats.tx_errors
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|d
(braket
l_int|0
)braket
op_amp
id|TX_UNDERRUN
)paren
id|pegasus-&gt;stats.tx_fifo_errors
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|d
(braket
l_int|0
)braket
op_amp
(paren
id|EXCESSIVE_COL
op_or
id|JABBER_TIMEOUT
)paren
)paren
id|pegasus-&gt;stats.tx_aborted_errors
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|d
(braket
l_int|0
)braket
op_amp
id|LATE_COL
)paren
id|pegasus-&gt;stats.tx_window_errors
op_increment
suffix:semicolon
)brace
multiline_comment|/* d[5].LINK_STATUS lies on some adapters.&n;&t;&t; * d[0].NO_CARRIER kicks in only with failed TX.&n;&t;&t; * ... so monitoring with MII may be safest.&n;&t;&t; */
r_if
c_cond
(paren
id|d
(braket
l_int|0
)braket
op_amp
id|NO_CARRIER
)paren
id|netif_carrier_off
c_func
(paren
id|net
)paren
suffix:semicolon
r_else
id|netif_carrier_on
c_func
(paren
id|net
)paren
suffix:semicolon
multiline_comment|/* bytes 3-4 == rx_lostpkt, reg 2E/2F */
id|pegasus-&gt;stats.rx_missed_errors
op_add_assign
(paren
(paren
id|d
(braket
l_int|3
)braket
op_amp
l_int|0x7f
)paren
op_lshift
l_int|8
)paren
op_or
id|d
(braket
l_int|4
)braket
suffix:semicolon
)brace
id|status
op_assign
id|usb_submit_urb
c_func
(paren
id|urb
comma
id|SLAB_ATOMIC
)paren
suffix:semicolon
r_if
c_cond
(paren
id|status
)paren
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;%s: can&squot;t resubmit interrupt urb, %d&bslash;n&quot;
comma
id|net-&gt;name
comma
id|status
)paren
suffix:semicolon
)brace
DECL|function|pegasus_tx_timeout
r_static
r_void
id|pegasus_tx_timeout
c_func
(paren
r_struct
id|net_device
op_star
id|net
)paren
(brace
id|pegasus_t
op_star
id|pegasus
op_assign
id|netdev_priv
c_func
(paren
id|net
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;%s: tx timeout&bslash;n&quot;
comma
id|net-&gt;name
)paren
suffix:semicolon
id|pegasus-&gt;tx_urb-&gt;transfer_flags
op_or_assign
id|URB_ASYNC_UNLINK
suffix:semicolon
id|usb_unlink_urb
c_func
(paren
id|pegasus-&gt;tx_urb
)paren
suffix:semicolon
id|pegasus-&gt;stats.tx_errors
op_increment
suffix:semicolon
)brace
DECL|function|pegasus_start_xmit
r_static
r_int
id|pegasus_start_xmit
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|net_device
op_star
id|net
)paren
(brace
id|pegasus_t
op_star
id|pegasus
op_assign
id|netdev_priv
c_func
(paren
id|net
)paren
suffix:semicolon
r_int
id|count
op_assign
(paren
(paren
id|skb-&gt;len
op_plus
l_int|2
)paren
op_amp
l_int|0x3f
)paren
ques
c_cond
id|skb-&gt;len
op_plus
l_int|2
suffix:colon
id|skb-&gt;len
op_plus
l_int|3
suffix:semicolon
r_int
id|res
suffix:semicolon
id|__u16
id|l16
op_assign
id|skb-&gt;len
suffix:semicolon
id|netif_stop_queue
c_func
(paren
id|net
)paren
suffix:semicolon
(paren
(paren
id|__le16
op_star
)paren
id|pegasus-&gt;tx_buff
)paren
(braket
l_int|0
)braket
op_assign
id|cpu_to_le16
c_func
(paren
id|l16
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|pegasus-&gt;tx_buff
op_plus
l_int|2
comma
id|skb-&gt;data
comma
id|skb-&gt;len
)paren
suffix:semicolon
id|usb_fill_bulk_urb
c_func
(paren
id|pegasus-&gt;tx_urb
comma
id|pegasus-&gt;usb
comma
id|usb_sndbulkpipe
c_func
(paren
id|pegasus-&gt;usb
comma
l_int|2
)paren
comma
id|pegasus-&gt;tx_buff
comma
id|count
comma
id|write_bulk_callback
comma
id|pegasus
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|res
op_assign
id|usb_submit_urb
c_func
(paren
id|pegasus-&gt;tx_urb
comma
id|GFP_ATOMIC
)paren
)paren
)paren
(brace
id|warn
c_func
(paren
l_string|&quot;failed tx_urb %d&quot;
comma
id|res
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|res
)paren
(brace
r_case
op_minus
id|EPIPE
suffix:colon
multiline_comment|/* stall, or disconnect from TT */
multiline_comment|/* cleanup should already have been scheduled */
r_break
suffix:semicolon
r_case
op_minus
id|ENODEV
suffix:colon
multiline_comment|/* disconnect() upcoming */
r_break
suffix:semicolon
r_default
suffix:colon
id|pegasus-&gt;stats.tx_errors
op_increment
suffix:semicolon
id|netif_start_queue
c_func
(paren
id|net
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
id|pegasus-&gt;stats.tx_packets
op_increment
suffix:semicolon
id|pegasus-&gt;stats.tx_bytes
op_add_assign
id|skb-&gt;len
suffix:semicolon
id|net-&gt;trans_start
op_assign
id|jiffies
suffix:semicolon
)brace
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|pegasus_netdev_stats
r_static
r_struct
id|net_device_stats
op_star
id|pegasus_netdev_stats
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_return
op_amp
(paren
(paren
id|pegasus_t
op_star
)paren
id|netdev_priv
c_func
(paren
id|dev
)paren
)paren
op_member_access_from_pointer
id|stats
suffix:semicolon
)brace
DECL|function|disable_net_traffic
r_static
r_inline
r_void
id|disable_net_traffic
c_func
(paren
id|pegasus_t
op_star
id|pegasus
)paren
(brace
r_int
id|tmp
op_assign
l_int|0
suffix:semicolon
id|set_registers
c_func
(paren
id|pegasus
comma
id|EthCtrl0
comma
l_int|2
comma
op_amp
id|tmp
)paren
suffix:semicolon
)brace
DECL|function|get_interrupt_interval
r_static
r_inline
r_void
id|get_interrupt_interval
c_func
(paren
id|pegasus_t
op_star
id|pegasus
)paren
(brace
id|__u8
id|data
(braket
l_int|2
)braket
suffix:semicolon
id|read_eprom_word
c_func
(paren
id|pegasus
comma
l_int|4
comma
(paren
id|__u16
op_star
)paren
id|data
)paren
suffix:semicolon
r_if
c_cond
(paren
id|data
(braket
l_int|1
)braket
OL
l_int|0x80
)paren
(brace
id|info
c_func
(paren
l_string|&quot;intr interval will be changed from %ums to %ums&quot;
comma
id|data
(braket
l_int|1
)braket
comma
l_int|0x80
)paren
suffix:semicolon
id|data
(braket
l_int|1
)braket
op_assign
l_int|0x80
suffix:semicolon
macro_line|#ifdef&t;PEGASUS_WRITE_EEPROM
id|write_eprom_word
c_func
(paren
id|pegasus
comma
l_int|4
comma
op_star
(paren
id|__u16
op_star
)paren
id|data
)paren
suffix:semicolon
macro_line|#endif
)brace
id|pegasus-&gt;intr_interval
op_assign
id|data
(braket
l_int|1
)braket
suffix:semicolon
)brace
DECL|function|set_carrier
r_static
r_void
id|set_carrier
c_func
(paren
r_struct
id|net_device
op_star
id|net
)paren
(brace
id|pegasus_t
op_star
id|pegasus
op_assign
id|netdev_priv
c_func
(paren
id|net
)paren
suffix:semicolon
r_int
id|tmp
suffix:semicolon
id|read_mii_word
c_func
(paren
id|pegasus
comma
id|pegasus-&gt;phy
comma
id|MII_BMSR
comma
op_amp
id|tmp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tmp
op_amp
id|BMSR_LSTATUS
)paren
id|netif_carrier_on
c_func
(paren
id|net
)paren
suffix:semicolon
r_else
id|netif_carrier_off
c_func
(paren
id|net
)paren
suffix:semicolon
)brace
DECL|function|free_all_urbs
r_static
r_void
id|free_all_urbs
c_func
(paren
id|pegasus_t
op_star
id|pegasus
)paren
(brace
id|usb_free_urb
c_func
(paren
id|pegasus-&gt;intr_urb
)paren
suffix:semicolon
id|usb_free_urb
c_func
(paren
id|pegasus-&gt;tx_urb
)paren
suffix:semicolon
id|usb_free_urb
c_func
(paren
id|pegasus-&gt;rx_urb
)paren
suffix:semicolon
id|usb_free_urb
c_func
(paren
id|pegasus-&gt;ctrl_urb
)paren
suffix:semicolon
)brace
DECL|function|unlink_all_urbs
r_static
r_void
id|unlink_all_urbs
c_func
(paren
id|pegasus_t
op_star
id|pegasus
)paren
(brace
id|usb_kill_urb
c_func
(paren
id|pegasus-&gt;intr_urb
)paren
suffix:semicolon
id|usb_kill_urb
c_func
(paren
id|pegasus-&gt;tx_urb
)paren
suffix:semicolon
id|usb_kill_urb
c_func
(paren
id|pegasus-&gt;rx_urb
)paren
suffix:semicolon
id|usb_kill_urb
c_func
(paren
id|pegasus-&gt;ctrl_urb
)paren
suffix:semicolon
)brace
DECL|function|alloc_urbs
r_static
r_int
id|alloc_urbs
c_func
(paren
id|pegasus_t
op_star
id|pegasus
)paren
(brace
id|pegasus-&gt;ctrl_urb
op_assign
id|usb_alloc_urb
c_func
(paren
l_int|0
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|pegasus-&gt;ctrl_urb
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
id|pegasus-&gt;rx_urb
op_assign
id|usb_alloc_urb
c_func
(paren
l_int|0
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|pegasus-&gt;rx_urb
)paren
(brace
id|usb_free_urb
c_func
(paren
id|pegasus-&gt;ctrl_urb
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|pegasus-&gt;tx_urb
op_assign
id|usb_alloc_urb
c_func
(paren
l_int|0
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|pegasus-&gt;tx_urb
)paren
(brace
id|usb_free_urb
c_func
(paren
id|pegasus-&gt;rx_urb
)paren
suffix:semicolon
id|usb_free_urb
c_func
(paren
id|pegasus-&gt;ctrl_urb
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|pegasus-&gt;intr_urb
op_assign
id|usb_alloc_urb
c_func
(paren
l_int|0
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|pegasus-&gt;intr_urb
)paren
(brace
id|usb_free_urb
c_func
(paren
id|pegasus-&gt;tx_urb
)paren
suffix:semicolon
id|usb_free_urb
c_func
(paren
id|pegasus-&gt;rx_urb
)paren
suffix:semicolon
id|usb_free_urb
c_func
(paren
id|pegasus-&gt;ctrl_urb
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|pegasus_open
r_static
r_int
id|pegasus_open
c_func
(paren
r_struct
id|net_device
op_star
id|net
)paren
(brace
id|pegasus_t
op_star
id|pegasus
op_assign
id|netdev_priv
c_func
(paren
id|net
)paren
suffix:semicolon
r_int
id|res
suffix:semicolon
r_if
c_cond
(paren
id|pegasus-&gt;rx_skb
op_eq
l_int|NULL
)paren
id|pegasus-&gt;rx_skb
op_assign
id|pull_skb
c_func
(paren
id|pegasus
)paren
suffix:semicolon
multiline_comment|/*&n;&t; ** Note: no point to free the pool.  it is empty :-)&n;&t; */
r_if
c_cond
(paren
op_logical_neg
id|pegasus-&gt;rx_skb
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|set_registers
c_func
(paren
id|pegasus
comma
id|EthID
comma
l_int|6
comma
id|net-&gt;dev_addr
)paren
suffix:semicolon
id|usb_fill_bulk_urb
c_func
(paren
id|pegasus-&gt;rx_urb
comma
id|pegasus-&gt;usb
comma
id|usb_rcvbulkpipe
c_func
(paren
id|pegasus-&gt;usb
comma
l_int|1
)paren
comma
id|pegasus-&gt;rx_skb-&gt;data
comma
id|PEGASUS_MTU
op_plus
l_int|8
comma
id|read_bulk_callback
comma
id|pegasus
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|res
op_assign
id|usb_submit_urb
c_func
(paren
id|pegasus-&gt;rx_urb
comma
id|GFP_KERNEL
)paren
)paren
)paren
id|warn
c_func
(paren
l_string|&quot;%s: failed rx_urb %d&quot;
comma
id|__FUNCTION__
comma
id|res
)paren
suffix:semicolon
id|usb_fill_int_urb
c_func
(paren
id|pegasus-&gt;intr_urb
comma
id|pegasus-&gt;usb
comma
id|usb_rcvintpipe
c_func
(paren
id|pegasus-&gt;usb
comma
l_int|3
)paren
comma
id|pegasus-&gt;intr_buff
comma
r_sizeof
(paren
id|pegasus-&gt;intr_buff
)paren
comma
id|intr_callback
comma
id|pegasus
comma
id|pegasus-&gt;intr_interval
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|res
op_assign
id|usb_submit_urb
c_func
(paren
id|pegasus-&gt;intr_urb
comma
id|GFP_KERNEL
)paren
)paren
)paren
id|warn
c_func
(paren
l_string|&quot;%s: failed intr_urb %d&quot;
comma
id|__FUNCTION__
comma
id|res
)paren
suffix:semicolon
id|netif_start_queue
c_func
(paren
id|net
)paren
suffix:semicolon
id|pegasus-&gt;flags
op_or_assign
id|PEGASUS_RUNNING
suffix:semicolon
r_if
c_cond
(paren
(paren
id|res
op_assign
id|enable_net_traffic
c_func
(paren
id|net
comma
id|pegasus-&gt;usb
)paren
)paren
)paren
(brace
id|err
c_func
(paren
l_string|&quot;can&squot;t enable_net_traffic() - %d&quot;
comma
id|res
)paren
suffix:semicolon
id|res
op_assign
op_minus
id|EIO
suffix:semicolon
id|usb_kill_urb
c_func
(paren
id|pegasus-&gt;rx_urb
)paren
suffix:semicolon
id|usb_kill_urb
c_func
(paren
id|pegasus-&gt;intr_urb
)paren
suffix:semicolon
id|free_skb_pool
c_func
(paren
id|pegasus
)paren
suffix:semicolon
r_goto
m_exit
suffix:semicolon
)brace
id|set_carrier
c_func
(paren
id|net
)paren
suffix:semicolon
id|res
op_assign
l_int|0
suffix:semicolon
m_exit
suffix:colon
r_return
id|res
suffix:semicolon
)brace
DECL|function|pegasus_close
r_static
r_int
id|pegasus_close
c_func
(paren
r_struct
id|net_device
op_star
id|net
)paren
(brace
id|pegasus_t
op_star
id|pegasus
op_assign
id|netdev_priv
c_func
(paren
id|net
)paren
suffix:semicolon
id|pegasus-&gt;flags
op_and_assign
op_complement
id|PEGASUS_RUNNING
suffix:semicolon
id|netif_stop_queue
c_func
(paren
id|net
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|pegasus-&gt;flags
op_amp
id|PEGASUS_UNPLUG
)paren
)paren
id|disable_net_traffic
c_func
(paren
id|pegasus
)paren
suffix:semicolon
id|tasklet_kill
c_func
(paren
op_amp
id|pegasus-&gt;rx_tl
)paren
suffix:semicolon
id|unlink_all_urbs
c_func
(paren
id|pegasus
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|pegasus_get_drvinfo
r_void
id|pegasus_get_drvinfo
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|ethtool_drvinfo
op_star
id|info
)paren
(brace
id|pegasus_t
op_star
id|pegasus
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
id|strncpy
c_func
(paren
id|info-&gt;driver
comma
id|driver_name
comma
r_sizeof
(paren
id|info-&gt;driver
)paren
op_minus
l_int|1
)paren
suffix:semicolon
id|strncpy
c_func
(paren
id|info-&gt;version
comma
id|DRIVER_VERSION
comma
r_sizeof
(paren
id|info-&gt;version
)paren
op_minus
l_int|1
)paren
suffix:semicolon
id|usb_make_path
c_func
(paren
id|pegasus-&gt;usb
comma
id|info-&gt;bus_info
comma
r_sizeof
(paren
id|info-&gt;bus_info
)paren
)paren
suffix:semicolon
)brace
multiline_comment|/* also handles three patterns of some kind in hardware */
DECL|macro|WOL_SUPPORTED
mdefine_line|#define&t;WOL_SUPPORTED&t;(WAKE_MAGIC|WAKE_PHY)
r_static
r_void
DECL|function|pegasus_get_wol
id|pegasus_get_wol
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|ethtool_wolinfo
op_star
id|wol
)paren
(brace
id|pegasus_t
op_star
id|pegasus
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
id|wol-&gt;supported
op_assign
id|WAKE_MAGIC
op_or
id|WAKE_PHY
suffix:semicolon
id|wol-&gt;wolopts
op_assign
id|pegasus-&gt;wolopts
suffix:semicolon
)brace
r_static
r_int
DECL|function|pegasus_set_wol
id|pegasus_set_wol
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|ethtool_wolinfo
op_star
id|wol
)paren
(brace
id|pegasus_t
op_star
id|pegasus
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
id|u8
id|reg78
op_assign
l_int|0x04
suffix:semicolon
r_if
c_cond
(paren
id|wol-&gt;wolopts
op_amp
op_complement
id|WOL_SUPPORTED
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|wol-&gt;wolopts
op_amp
id|WAKE_MAGIC
)paren
id|reg78
op_or_assign
l_int|0x80
suffix:semicolon
r_if
c_cond
(paren
id|wol-&gt;wolopts
op_amp
id|WAKE_PHY
)paren
id|reg78
op_or_assign
l_int|0x40
suffix:semicolon
r_if
c_cond
(paren
id|wol-&gt;wolopts
)paren
id|pegasus-&gt;eth_regs
(braket
l_int|0
)braket
op_or_assign
l_int|0x10
suffix:semicolon
r_else
id|pegasus-&gt;eth_regs
(braket
l_int|0
)braket
op_and_assign
op_complement
l_int|0x10
suffix:semicolon
id|pegasus-&gt;wolopts
op_assign
id|wol-&gt;wolopts
suffix:semicolon
r_return
id|set_register
c_func
(paren
id|pegasus
comma
id|WakeupControl
comma
id|reg78
)paren
suffix:semicolon
)brace
r_static
r_inline
r_void
DECL|function|pegasus_reset_wol
id|pegasus_reset_wol
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|ethtool_wolinfo
id|wol
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|wol
comma
l_int|0
comma
r_sizeof
id|wol
)paren
suffix:semicolon
(paren
r_void
)paren
id|pegasus_set_wol
c_func
(paren
id|dev
comma
op_amp
id|wol
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|pegasus_get_settings
id|pegasus_get_settings
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|ethtool_cmd
op_star
id|ecmd
)paren
(brace
id|pegasus_t
op_star
id|pegasus
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
id|mii_ethtool_gset
c_func
(paren
op_amp
id|pegasus-&gt;mii
comma
id|ecmd
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|pegasus_set_settings
id|pegasus_set_settings
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|ethtool_cmd
op_star
id|ecmd
)paren
(brace
id|pegasus_t
op_star
id|pegasus
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
r_return
id|mii_ethtool_sset
c_func
(paren
op_amp
id|pegasus-&gt;mii
comma
id|ecmd
)paren
suffix:semicolon
)brace
DECL|function|pegasus_nway_reset
r_static
r_int
id|pegasus_nway_reset
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
id|pegasus_t
op_star
id|pegasus
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
r_return
id|mii_nway_restart
c_func
(paren
op_amp
id|pegasus-&gt;mii
)paren
suffix:semicolon
)brace
DECL|function|pegasus_get_link
r_static
id|u32
id|pegasus_get_link
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
id|pegasus_t
op_star
id|pegasus
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
r_return
id|mii_link_ok
c_func
(paren
op_amp
id|pegasus-&gt;mii
)paren
suffix:semicolon
)brace
DECL|function|pegasus_get_msglevel
r_static
id|u32
id|pegasus_get_msglevel
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
id|pegasus_t
op_star
id|pegasus
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
r_return
id|pegasus-&gt;msg_level
suffix:semicolon
)brace
DECL|function|pegasus_set_msglevel
r_static
r_void
id|pegasus_set_msglevel
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
id|u32
id|v
)paren
(brace
id|pegasus_t
op_star
id|pegasus
op_assign
id|netdev_priv
c_func
(paren
id|dev
)paren
suffix:semicolon
id|pegasus-&gt;msg_level
op_assign
id|v
suffix:semicolon
)brace
DECL|variable|ops
r_static
r_struct
id|ethtool_ops
id|ops
op_assign
(brace
dot
id|get_drvinfo
op_assign
id|pegasus_get_drvinfo
comma
dot
id|get_settings
op_assign
id|pegasus_get_settings
comma
dot
id|set_settings
op_assign
id|pegasus_set_settings
comma
dot
id|nway_reset
op_assign
id|pegasus_nway_reset
comma
dot
id|get_link
op_assign
id|pegasus_get_link
comma
dot
id|get_msglevel
op_assign
id|pegasus_get_msglevel
comma
dot
id|set_msglevel
op_assign
id|pegasus_set_msglevel
comma
dot
id|get_wol
op_assign
id|pegasus_get_wol
comma
dot
id|set_wol
op_assign
id|pegasus_set_wol
comma
)brace
suffix:semicolon
DECL|function|pegasus_ioctl
r_static
r_int
id|pegasus_ioctl
c_func
(paren
r_struct
id|net_device
op_star
id|net
comma
r_struct
id|ifreq
op_star
id|rq
comma
r_int
id|cmd
)paren
(brace
id|__u16
op_star
id|data
op_assign
(paren
id|__u16
op_star
)paren
op_amp
id|rq-&gt;ifr_ifru
suffix:semicolon
id|pegasus_t
op_star
id|pegasus
op_assign
id|netdev_priv
c_func
(paren
id|net
)paren
suffix:semicolon
r_int
id|res
suffix:semicolon
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|SIOCDEVPRIVATE
suffix:colon
id|data
(braket
l_int|0
)braket
op_assign
id|pegasus-&gt;phy
suffix:semicolon
r_case
id|SIOCDEVPRIVATE
op_plus
l_int|1
suffix:colon
id|read_mii_word
c_func
(paren
id|pegasus
comma
id|data
(braket
l_int|0
)braket
comma
id|data
(braket
l_int|1
)braket
op_amp
l_int|0x1f
comma
op_amp
id|data
(braket
l_int|3
)braket
)paren
suffix:semicolon
id|res
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SIOCDEVPRIVATE
op_plus
l_int|2
suffix:colon
r_if
c_cond
(paren
op_logical_neg
id|capable
c_func
(paren
id|CAP_NET_ADMIN
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
id|write_mii_word
c_func
(paren
id|pegasus
comma
id|pegasus-&gt;phy
comma
id|data
(braket
l_int|1
)braket
op_amp
l_int|0x1f
comma
id|data
(braket
l_int|2
)braket
)paren
suffix:semicolon
id|res
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|res
op_assign
op_minus
id|EOPNOTSUPP
suffix:semicolon
)brace
r_return
id|res
suffix:semicolon
)brace
DECL|function|pegasus_set_multicast
r_static
r_void
id|pegasus_set_multicast
c_func
(paren
r_struct
id|net_device
op_star
id|net
)paren
(brace
id|pegasus_t
op_star
id|pegasus
op_assign
id|netdev_priv
c_func
(paren
id|net
)paren
suffix:semicolon
r_if
c_cond
(paren
id|net-&gt;flags
op_amp
id|IFF_PROMISC
)paren
(brace
id|pegasus-&gt;eth_regs
(braket
id|EthCtrl2
)braket
op_or_assign
id|RX_PROMISCUOUS
suffix:semicolon
id|pr_info
c_func
(paren
l_string|&quot;%s: Promiscuous mode enabled.&bslash;n&quot;
comma
id|net-&gt;name
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
(paren
id|net-&gt;mc_count
OG
id|multicast_filter_limit
)paren
op_logical_or
(paren
id|net-&gt;flags
op_amp
id|IFF_ALLMULTI
)paren
)paren
(brace
id|pegasus-&gt;eth_regs
(braket
id|EthCtrl0
)braket
op_or_assign
id|RX_MULTICAST
suffix:semicolon
id|pegasus-&gt;eth_regs
(braket
id|EthCtrl2
)braket
op_and_assign
op_complement
id|RX_PROMISCUOUS
suffix:semicolon
id|pr_info
c_func
(paren
l_string|&quot;%s: set allmulti&bslash;n&quot;
comma
id|net-&gt;name
)paren
suffix:semicolon
)brace
r_else
(brace
id|pegasus-&gt;eth_regs
(braket
id|EthCtrl0
)braket
op_and_assign
op_complement
id|RX_MULTICAST
suffix:semicolon
id|pegasus-&gt;eth_regs
(braket
id|EthCtrl2
)braket
op_and_assign
op_complement
id|RX_PROMISCUOUS
suffix:semicolon
)brace
id|pegasus-&gt;flags
op_or_assign
id|ETH_REGS_CHANGE
suffix:semicolon
id|ctrl_callback
c_func
(paren
id|pegasus-&gt;ctrl_urb
comma
l_int|NULL
)paren
suffix:semicolon
)brace
DECL|function|mii_phy_probe
r_static
id|__u8
id|mii_phy_probe
c_func
(paren
id|pegasus_t
op_star
id|pegasus
)paren
(brace
r_int
id|i
suffix:semicolon
id|__u16
id|tmp
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|32
suffix:semicolon
id|i
op_increment
)paren
(brace
id|read_mii_word
c_func
(paren
id|pegasus
comma
id|i
comma
id|MII_BMSR
comma
op_amp
id|tmp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tmp
op_eq
l_int|0
op_logical_or
id|tmp
op_eq
l_int|0xffff
op_logical_or
(paren
id|tmp
op_amp
id|BMSR_MEDIA
)paren
op_eq
l_int|0
)paren
r_continue
suffix:semicolon
r_else
r_return
id|i
suffix:semicolon
)brace
r_return
l_int|0xff
suffix:semicolon
)brace
DECL|function|setup_pegasus_II
r_static
r_inline
r_void
id|setup_pegasus_II
c_func
(paren
id|pegasus_t
op_star
id|pegasus
)paren
(brace
id|__u8
id|data
op_assign
l_int|0xa5
suffix:semicolon
id|set_register
c_func
(paren
id|pegasus
comma
id|Reg1d
comma
l_int|0
)paren
suffix:semicolon
id|set_register
c_func
(paren
id|pegasus
comma
id|Reg7b
comma
l_int|1
)paren
suffix:semicolon
id|mdelay
c_func
(paren
l_int|100
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|pegasus-&gt;features
op_amp
id|HAS_HOME_PNA
)paren
op_logical_and
id|mii_mode
)paren
id|set_register
c_func
(paren
id|pegasus
comma
id|Reg7b
comma
l_int|0
)paren
suffix:semicolon
r_else
id|set_register
c_func
(paren
id|pegasus
comma
id|Reg7b
comma
l_int|2
)paren
suffix:semicolon
id|set_register
c_func
(paren
id|pegasus
comma
l_int|0x83
comma
id|data
)paren
suffix:semicolon
id|get_registers
c_func
(paren
id|pegasus
comma
l_int|0x83
comma
l_int|1
comma
op_amp
id|data
)paren
suffix:semicolon
r_if
c_cond
(paren
id|data
op_eq
l_int|0xa5
)paren
(brace
id|pegasus-&gt;chip
op_assign
l_int|0x8513
suffix:semicolon
)brace
r_else
(brace
id|pegasus-&gt;chip
op_assign
l_int|0
suffix:semicolon
)brace
id|set_register
c_func
(paren
id|pegasus
comma
l_int|0x80
comma
l_int|0xc0
)paren
suffix:semicolon
id|set_register
c_func
(paren
id|pegasus
comma
l_int|0x83
comma
l_int|0xff
)paren
suffix:semicolon
id|set_register
c_func
(paren
id|pegasus
comma
l_int|0x84
comma
l_int|0x01
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pegasus-&gt;features
op_amp
id|HAS_HOME_PNA
op_logical_and
id|mii_mode
)paren
id|set_register
c_func
(paren
id|pegasus
comma
id|Reg81
comma
l_int|6
)paren
suffix:semicolon
r_else
id|set_register
c_func
(paren
id|pegasus
comma
id|Reg81
comma
l_int|2
)paren
suffix:semicolon
)brace
DECL|function|pegasus_probe
r_static
r_int
id|pegasus_probe
c_func
(paren
r_struct
id|usb_interface
op_star
id|intf
comma
r_const
r_struct
id|usb_device_id
op_star
id|id
)paren
(brace
r_struct
id|usb_device
op_star
id|dev
op_assign
id|interface_to_usbdev
c_func
(paren
id|intf
)paren
suffix:semicolon
r_struct
id|net_device
op_star
id|net
suffix:semicolon
id|pegasus_t
op_star
id|pegasus
suffix:semicolon
r_int
id|dev_index
op_assign
id|id
op_minus
id|pegasus_ids
suffix:semicolon
r_int
id|res
op_assign
op_minus
id|ENOMEM
suffix:semicolon
id|usb_get_dev
c_func
(paren
id|dev
)paren
suffix:semicolon
id|net
op_assign
id|alloc_etherdev
c_func
(paren
r_sizeof
(paren
r_struct
id|pegasus
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|net
)paren
(brace
id|err
c_func
(paren
l_string|&quot;out of memory allocating device structure&quot;
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|pegasus
op_assign
id|netdev_priv
c_func
(paren
id|net
)paren
suffix:semicolon
id|memset
c_func
(paren
id|pegasus
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|pegasus
)paren
)paren
suffix:semicolon
id|pegasus-&gt;dev_index
op_assign
id|dev_index
suffix:semicolon
id|init_waitqueue_head
c_func
(paren
op_amp
id|pegasus-&gt;ctrl_wait
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|alloc_urbs
c_func
(paren
id|pegasus
)paren
)paren
r_goto
id|out1
suffix:semicolon
id|tasklet_init
c_func
(paren
op_amp
id|pegasus-&gt;rx_tl
comma
id|rx_fixup
comma
(paren
r_int
r_int
)paren
id|pegasus
)paren
suffix:semicolon
id|pegasus-&gt;usb
op_assign
id|dev
suffix:semicolon
id|pegasus-&gt;net
op_assign
id|net
suffix:semicolon
id|SET_MODULE_OWNER
c_func
(paren
id|net
)paren
suffix:semicolon
id|net-&gt;open
op_assign
id|pegasus_open
suffix:semicolon
id|net-&gt;stop
op_assign
id|pegasus_close
suffix:semicolon
id|net-&gt;watchdog_timeo
op_assign
id|PEGASUS_TX_TIMEOUT
suffix:semicolon
id|net-&gt;tx_timeout
op_assign
id|pegasus_tx_timeout
suffix:semicolon
id|net-&gt;do_ioctl
op_assign
id|pegasus_ioctl
suffix:semicolon
id|net-&gt;hard_start_xmit
op_assign
id|pegasus_start_xmit
suffix:semicolon
id|net-&gt;set_multicast_list
op_assign
id|pegasus_set_multicast
suffix:semicolon
id|net-&gt;get_stats
op_assign
id|pegasus_netdev_stats
suffix:semicolon
id|SET_ETHTOOL_OPS
c_func
(paren
id|net
comma
op_amp
id|ops
)paren
suffix:semicolon
id|pegasus-&gt;mii.dev
op_assign
id|net
suffix:semicolon
id|pegasus-&gt;mii.mdio_read
op_assign
id|mdio_read
suffix:semicolon
id|pegasus-&gt;mii.mdio_write
op_assign
id|mdio_write
suffix:semicolon
id|pegasus-&gt;mii.phy_id_mask
op_assign
l_int|0x1f
suffix:semicolon
id|pegasus-&gt;mii.reg_num_mask
op_assign
l_int|0x1f
suffix:semicolon
id|spin_lock_init
c_func
(paren
op_amp
id|pegasus-&gt;rx_pool_lock
)paren
suffix:semicolon
id|pegasus-&gt;features
op_assign
id|usb_dev_id
(braket
id|dev_index
)braket
dot
r_private
suffix:semicolon
id|get_interrupt_interval
c_func
(paren
id|pegasus
)paren
suffix:semicolon
r_if
c_cond
(paren
id|reset_mac
c_func
(paren
id|pegasus
)paren
)paren
(brace
id|dev_err
c_func
(paren
op_amp
id|intf-&gt;dev
comma
l_string|&quot;can&squot;t reset MAC&bslash;n&quot;
)paren
suffix:semicolon
id|res
op_assign
op_minus
id|EIO
suffix:semicolon
r_goto
id|out2
suffix:semicolon
)brace
id|set_ethernet_addr
c_func
(paren
id|pegasus
)paren
suffix:semicolon
id|fill_skb_pool
c_func
(paren
id|pegasus
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pegasus-&gt;features
op_amp
id|PEGASUS_II
)paren
(brace
id|dev_info
c_func
(paren
op_amp
id|intf-&gt;dev
comma
l_string|&quot;setup Pegasus II specific registers&bslash;n&quot;
)paren
suffix:semicolon
id|setup_pegasus_II
c_func
(paren
id|pegasus
)paren
suffix:semicolon
)brace
id|pegasus-&gt;phy
op_assign
id|mii_phy_probe
c_func
(paren
id|pegasus
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pegasus-&gt;phy
op_eq
l_int|0xff
)paren
(brace
id|dev_warn
c_func
(paren
op_amp
id|intf-&gt;dev
comma
l_string|&quot;can&squot;t locate MII phy, using default&bslash;n&quot;
)paren
suffix:semicolon
id|pegasus-&gt;phy
op_assign
l_int|1
suffix:semicolon
)brace
id|usb_set_intfdata
c_func
(paren
id|intf
comma
id|pegasus
)paren
suffix:semicolon
id|SET_NETDEV_DEV
c_func
(paren
id|net
comma
op_amp
id|intf-&gt;dev
)paren
suffix:semicolon
id|pegasus_reset_wol
c_func
(paren
id|net
)paren
suffix:semicolon
id|res
op_assign
id|register_netdev
c_func
(paren
id|net
)paren
suffix:semicolon
r_if
c_cond
(paren
id|res
)paren
r_goto
id|out3
suffix:semicolon
id|pr_info
c_func
(paren
l_string|&quot;%s: %s&bslash;n&quot;
comma
id|net-&gt;name
comma
id|usb_dev_id
(braket
id|dev_index
)braket
dot
id|name
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
id|out3
suffix:colon
id|usb_set_intfdata
c_func
(paren
id|intf
comma
l_int|NULL
)paren
suffix:semicolon
id|free_skb_pool
c_func
(paren
id|pegasus
)paren
suffix:semicolon
id|out2
suffix:colon
id|free_all_urbs
c_func
(paren
id|pegasus
)paren
suffix:semicolon
id|out1
suffix:colon
id|free_netdev
c_func
(paren
id|net
)paren
suffix:semicolon
id|out
suffix:colon
id|usb_put_dev
c_func
(paren
id|dev
)paren
suffix:semicolon
r_return
id|res
suffix:semicolon
)brace
DECL|function|pegasus_disconnect
r_static
r_void
id|pegasus_disconnect
c_func
(paren
r_struct
id|usb_interface
op_star
id|intf
)paren
(brace
r_struct
id|pegasus
op_star
id|pegasus
op_assign
id|usb_get_intfdata
c_func
(paren
id|intf
)paren
suffix:semicolon
id|usb_set_intfdata
c_func
(paren
id|intf
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|pegasus
)paren
(brace
id|warn
c_func
(paren
l_string|&quot;unregistering non-existant device&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|pegasus-&gt;flags
op_or_assign
id|PEGASUS_UNPLUG
suffix:semicolon
id|unregister_netdev
c_func
(paren
id|pegasus-&gt;net
)paren
suffix:semicolon
id|usb_put_dev
c_func
(paren
id|interface_to_usbdev
c_func
(paren
id|intf
)paren
)paren
suffix:semicolon
id|free_all_urbs
c_func
(paren
id|pegasus
)paren
suffix:semicolon
id|free_skb_pool
c_func
(paren
id|pegasus
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pegasus-&gt;rx_skb
)paren
id|dev_kfree_skb
c_func
(paren
id|pegasus-&gt;rx_skb
)paren
suffix:semicolon
id|free_netdev
c_func
(paren
id|pegasus-&gt;net
)paren
suffix:semicolon
)brace
DECL|function|pegasus_suspend
r_static
r_int
id|pegasus_suspend
(paren
r_struct
id|usb_interface
op_star
id|intf
comma
id|u32
id|state
)paren
(brace
r_struct
id|pegasus
op_star
id|pegasus
op_assign
id|usb_get_intfdata
c_func
(paren
id|intf
)paren
suffix:semicolon
id|netif_device_detach
(paren
id|pegasus-&gt;net
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|pegasus_resume
r_static
r_int
id|pegasus_resume
(paren
r_struct
id|usb_interface
op_star
id|intf
)paren
(brace
r_struct
id|pegasus
op_star
id|pegasus
op_assign
id|usb_get_intfdata
c_func
(paren
id|intf
)paren
suffix:semicolon
id|netif_device_attach
(paren
id|pegasus-&gt;net
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|pegasus_driver
r_static
r_struct
id|usb_driver
id|pegasus_driver
op_assign
(brace
dot
id|name
op_assign
id|driver_name
comma
dot
id|probe
op_assign
id|pegasus_probe
comma
dot
id|disconnect
op_assign
id|pegasus_disconnect
comma
dot
id|id_table
op_assign
id|pegasus_ids
comma
dot
id|suspend
op_assign
id|pegasus_suspend
comma
dot
id|resume
op_assign
id|pegasus_resume
comma
)brace
suffix:semicolon
DECL|function|pegasus_init
r_static
r_int
id|__init
id|pegasus_init
c_func
(paren
r_void
)paren
(brace
id|pr_info
c_func
(paren
l_string|&quot;%s: %s, &quot;
id|DRIVER_DESC
l_string|&quot;&bslash;n&quot;
comma
id|driver_name
comma
id|DRIVER_VERSION
)paren
suffix:semicolon
r_return
id|usb_register
c_func
(paren
op_amp
id|pegasus_driver
)paren
suffix:semicolon
)brace
DECL|function|pegasus_exit
r_static
r_void
id|__exit
id|pegasus_exit
c_func
(paren
r_void
)paren
(brace
id|usb_deregister
c_func
(paren
op_amp
id|pegasus_driver
)paren
suffix:semicolon
)brace
DECL|variable|pegasus_init
id|module_init
c_func
(paren
id|pegasus_init
)paren
suffix:semicolon
DECL|variable|pegasus_exit
id|module_exit
c_func
(paren
id|pegasus_exit
)paren
suffix:semicolon
eof
