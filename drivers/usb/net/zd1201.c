multiline_comment|/*&n; *&t;Driver for ZyDAS zd1201 based wireless USB devices.&n; *&n; *&t;Copyright (c) 2004, 2005 Jeroen Vreeken (pe1rxq@amsat.org)&n; *&n; *&t;This program is free software; you can redistribute it and/or&n; *&t;modify it under the terms of the GNU General Public License&n; *&t;version 2 as published by the Free Software Foundation.&n; *&n; *&t;Parts of this driver have been derived from a wlan-ng version&n; *&t;modified by ZyDAS. They also made documentation available, thanks!&n; *&t;Copyright (C) 1999 AbsoluteValue Systems, Inc.  All Rights Reserved.&n; */
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/usb.h&gt;
macro_line|#include &lt;linux/netdevice.h&gt;
macro_line|#include &lt;linux/etherdevice.h&gt;
macro_line|#include &lt;linux/wireless.h&gt;
macro_line|#include &lt;net/iw_handler.h&gt;
macro_line|#include &lt;linux/string.h&gt;
macro_line|#include &lt;linux/if_arp.h&gt;
macro_line|#include &lt;linux/firmware.h&gt;
macro_line|#include &lt;ieee802_11.h&gt;
macro_line|#include &quot;zd1201.h&quot;
DECL|variable|zd1201_table
r_static
r_struct
id|usb_device_id
id|zd1201_table
(braket
)braket
op_assign
(brace
(brace
id|USB_DEVICE
c_func
(paren
l_int|0x0586
comma
l_int|0x3400
)paren
)brace
comma
multiline_comment|/* Peabird Wireless USB Adapter */
(brace
id|USB_DEVICE
c_func
(paren
l_int|0x0ace
comma
l_int|0x1201
)paren
)brace
comma
multiline_comment|/* ZyDAS ZD1201 Wireless USB Adapter */
(brace
id|USB_DEVICE
c_func
(paren
l_int|0x050d
comma
l_int|0x6051
)paren
)brace
comma
multiline_comment|/* Belkin F5D6051 usb  adapter */
(brace
id|USB_DEVICE
c_func
(paren
l_int|0x0db0
comma
l_int|0x6823
)paren
)brace
comma
multiline_comment|/* MSI UB11B usb  adapter */
(brace
)brace
)brace
suffix:semicolon
DECL|variable|ap
r_static
r_int
id|ap
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* Are we an AP or a normal station? */
DECL|macro|ZD1201_VERSION
mdefine_line|#define ZD1201_VERSION&t;&quot;0.15&quot;
id|MODULE_AUTHOR
c_func
(paren
l_string|&quot;Jeroen Vreeken &lt;pe1rxq@amsat.org&gt;&quot;
)paren
suffix:semicolon
id|MODULE_DESCRIPTION
c_func
(paren
l_string|&quot;Driver for ZyDAS ZD1201 based USB Wireless adapters&quot;
)paren
suffix:semicolon
DECL|variable|ZD1201_VERSION
id|MODULE_VERSION
c_func
(paren
id|ZD1201_VERSION
)paren
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|ap
comma
r_int
comma
l_int|0
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|ap
comma
l_string|&quot;If non-zero Access Point firmware will be loaded&quot;
)paren
suffix:semicolon
id|MODULE_DEVICE_TABLE
c_func
(paren
id|usb
comma
id|zd1201_table
)paren
suffix:semicolon
DECL|function|zd1201_fw_upload
r_int
id|zd1201_fw_upload
c_func
(paren
r_struct
id|usb_device
op_star
id|dev
comma
r_int
id|apfw
)paren
(brace
r_const
r_struct
id|firmware
op_star
id|fw_entry
suffix:semicolon
r_char
op_star
id|data
suffix:semicolon
r_int
r_int
id|len
suffix:semicolon
r_int
id|err
suffix:semicolon
r_int
r_char
id|ret
suffix:semicolon
r_char
op_star
id|buf
suffix:semicolon
r_char
op_star
id|fwfile
suffix:semicolon
r_if
c_cond
(paren
id|apfw
)paren
id|fwfile
op_assign
l_string|&quot;zd1201-ap.fw&quot;
suffix:semicolon
r_else
id|fwfile
op_assign
l_string|&quot;zd1201.fw&quot;
suffix:semicolon
id|err
op_assign
id|request_firmware
c_func
(paren
op_amp
id|fw_entry
comma
id|fwfile
comma
op_amp
id|dev-&gt;dev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
(brace
id|dev_err
c_func
(paren
op_amp
id|dev-&gt;dev
comma
l_string|&quot;Failed to load %s firmware file!&bslash;n&quot;
comma
id|fwfile
)paren
suffix:semicolon
id|dev_err
c_func
(paren
op_amp
id|dev-&gt;dev
comma
l_string|&quot;Make sure the hotplug firmware loader is installed.&bslash;n&quot;
)paren
suffix:semicolon
id|dev_err
c_func
(paren
op_amp
id|dev-&gt;dev
comma
l_string|&quot;Goto http://linux-lc100020.sourceforge.net for more info&bslash;n&quot;
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
id|data
op_assign
id|fw_entry-&gt;data
suffix:semicolon
id|len
op_assign
id|fw_entry-&gt;size
suffix:semicolon
id|buf
op_assign
id|kmalloc
c_func
(paren
l_int|1024
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|buf
)paren
r_goto
m_exit
suffix:semicolon
r_while
c_loop
(paren
id|len
OG
l_int|0
)paren
(brace
r_int
id|translen
op_assign
(paren
id|len
OG
l_int|1024
)paren
ques
c_cond
l_int|1024
suffix:colon
id|len
suffix:semicolon
id|memcpy
c_func
(paren
id|buf
comma
id|data
comma
id|translen
)paren
suffix:semicolon
id|err
op_assign
id|usb_control_msg
c_func
(paren
id|dev
comma
id|usb_sndctrlpipe
c_func
(paren
id|dev
comma
l_int|0
)paren
comma
l_int|0
comma
id|USB_DIR_OUT
op_or
l_int|0x40
comma
l_int|0
comma
l_int|0
comma
id|buf
comma
id|translen
comma
id|ZD1201_FW_TIMEOUT
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_goto
m_exit
suffix:semicolon
id|len
op_sub_assign
id|translen
suffix:semicolon
id|data
op_add_assign
id|translen
suffix:semicolon
)brace
id|err
op_assign
id|usb_control_msg
c_func
(paren
id|dev
comma
id|usb_sndctrlpipe
c_func
(paren
id|dev
comma
l_int|0
)paren
comma
l_int|0x2
comma
id|USB_DIR_OUT
op_or
l_int|0x40
comma
l_int|0
comma
l_int|0
comma
l_int|NULL
comma
l_int|0
comma
id|ZD1201_FW_TIMEOUT
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_goto
m_exit
suffix:semicolon
id|err
op_assign
id|usb_control_msg
c_func
(paren
id|dev
comma
id|usb_rcvctrlpipe
c_func
(paren
id|dev
comma
l_int|0
)paren
comma
l_int|0x4
comma
id|USB_DIR_IN
op_or
l_int|0x40
comma
l_int|0
comma
l_int|0
comma
op_amp
id|ret
comma
r_sizeof
(paren
id|ret
)paren
comma
id|ZD1201_FW_TIMEOUT
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OL
l_int|0
)paren
r_goto
m_exit
suffix:semicolon
r_if
c_cond
(paren
id|ret
op_amp
l_int|0x80
)paren
(brace
id|err
op_assign
op_minus
id|EIO
suffix:semicolon
r_goto
m_exit
suffix:semicolon
)brace
id|err
op_assign
l_int|0
suffix:semicolon
m_exit
suffix:colon
r_if
c_cond
(paren
id|buf
)paren
id|kfree
c_func
(paren
id|buf
)paren
suffix:semicolon
id|release_firmware
c_func
(paren
id|fw_entry
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|function|zd1201_usbfree
r_void
id|zd1201_usbfree
c_func
(paren
r_struct
id|urb
op_star
id|urb
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
r_struct
id|zd1201
op_star
id|zd
op_assign
id|urb-&gt;context
suffix:semicolon
r_switch
c_cond
(paren
id|urb-&gt;status
)paren
(brace
r_case
op_minus
id|EILSEQ
suffix:colon
r_case
op_minus
id|ENODEV
suffix:colon
r_case
op_minus
id|ETIMEDOUT
suffix:colon
r_case
op_minus
id|ENOENT
suffix:colon
r_case
op_minus
id|EPIPE
suffix:colon
r_case
op_minus
id|EOVERFLOW
suffix:colon
r_case
op_minus
id|ESHUTDOWN
suffix:colon
id|dev_warn
c_func
(paren
op_amp
id|zd-&gt;usb-&gt;dev
comma
l_string|&quot;%s: urb failed: %d&bslash;n&quot;
comma
id|zd-&gt;dev-&gt;name
comma
id|urb-&gt;status
)paren
suffix:semicolon
)brace
id|kfree
c_func
(paren
id|urb-&gt;transfer_buffer
)paren
suffix:semicolon
id|usb_free_urb
c_func
(paren
id|urb
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
multiline_comment|/* cmdreq message: &n;&t;u32 type&n;&t;u16 cmd&n;&t;u16 parm0&n;&t;u16 parm1&n;&t;u16 parm2&n;&t;u8  pad[4]&n;&n;&t;total: 4 + 2 + 2 + 2 + 2 + 4 = 16&n;*/
DECL|function|zd1201_docmd
r_int
id|zd1201_docmd
c_func
(paren
r_struct
id|zd1201
op_star
id|zd
comma
r_int
id|cmd
comma
r_int
id|parm0
comma
r_int
id|parm1
comma
r_int
id|parm2
)paren
(brace
r_int
r_char
op_star
id|command
suffix:semicolon
r_int
id|ret
suffix:semicolon
r_struct
id|urb
op_star
id|urb
suffix:semicolon
id|command
op_assign
id|kmalloc
c_func
(paren
l_int|16
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|command
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
op_star
(paren
(paren
id|__le32
op_star
)paren
id|command
)paren
op_assign
id|cpu_to_le32
c_func
(paren
id|ZD1201_USB_CMDREQ
)paren
suffix:semicolon
op_star
(paren
(paren
id|__le16
op_star
)paren
op_amp
id|command
(braket
l_int|4
)braket
)paren
op_assign
id|cpu_to_le16
c_func
(paren
id|cmd
)paren
suffix:semicolon
op_star
(paren
(paren
id|__le16
op_star
)paren
op_amp
id|command
(braket
l_int|6
)braket
)paren
op_assign
id|cpu_to_le16
c_func
(paren
id|parm0
)paren
suffix:semicolon
op_star
(paren
(paren
id|__le16
op_star
)paren
op_amp
id|command
(braket
l_int|8
)braket
)paren
op_assign
id|cpu_to_le16
c_func
(paren
id|parm1
)paren
suffix:semicolon
op_star
(paren
(paren
id|__le16
op_star
)paren
op_amp
id|command
(braket
l_int|10
)braket
)paren
op_assign
id|cpu_to_le16
c_func
(paren
id|parm2
)paren
suffix:semicolon
id|urb
op_assign
id|usb_alloc_urb
c_func
(paren
l_int|0
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|urb
)paren
(brace
id|kfree
c_func
(paren
id|command
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|usb_fill_bulk_urb
c_func
(paren
id|urb
comma
id|zd-&gt;usb
comma
id|usb_sndbulkpipe
c_func
(paren
id|zd-&gt;usb
comma
id|zd-&gt;endp_out2
)paren
comma
id|command
comma
l_int|16
comma
id|zd1201_usbfree
comma
id|zd
)paren
suffix:semicolon
id|ret
op_assign
id|usb_submit_urb
c_func
(paren
id|urb
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|kfree
c_func
(paren
id|command
)paren
suffix:semicolon
id|usb_free_urb
c_func
(paren
id|urb
)paren
suffix:semicolon
)brace
r_return
id|ret
suffix:semicolon
)brace
multiline_comment|/* Callback after sending out a packet */
DECL|function|zd1201_usbtx
r_void
id|zd1201_usbtx
c_func
(paren
r_struct
id|urb
op_star
id|urb
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
r_struct
id|zd1201
op_star
id|zd
op_assign
id|urb-&gt;context
suffix:semicolon
id|netif_wake_queue
c_func
(paren
id|zd-&gt;dev
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
multiline_comment|/* Incomming data */
DECL|function|zd1201_usbrx
r_void
id|zd1201_usbrx
c_func
(paren
r_struct
id|urb
op_star
id|urb
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
r_struct
id|zd1201
op_star
id|zd
op_assign
id|urb-&gt;context
suffix:semicolon
r_int
id|free
op_assign
l_int|0
suffix:semicolon
r_int
r_char
op_star
id|data
op_assign
id|urb-&gt;transfer_buffer
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
r_int
r_char
id|type
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|zd
)paren
(brace
id|free
op_assign
l_int|1
suffix:semicolon
r_goto
m_exit
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|urb-&gt;status
)paren
(brace
r_case
op_minus
id|EILSEQ
suffix:colon
r_case
op_minus
id|ENODEV
suffix:colon
r_case
op_minus
id|ETIMEDOUT
suffix:colon
r_case
op_minus
id|ENOENT
suffix:colon
r_case
op_minus
id|EPIPE
suffix:colon
r_case
op_minus
id|EOVERFLOW
suffix:colon
r_case
op_minus
id|ESHUTDOWN
suffix:colon
id|dev_warn
c_func
(paren
op_amp
id|zd-&gt;usb-&gt;dev
comma
l_string|&quot;%s: rx urb failed: %d&bslash;n&quot;
comma
id|zd-&gt;dev-&gt;name
comma
id|urb-&gt;status
)paren
suffix:semicolon
id|free
op_assign
l_int|1
suffix:semicolon
r_goto
m_exit
suffix:semicolon
)brace
r_if
c_cond
(paren
id|urb-&gt;status
op_ne
l_int|0
op_logical_or
id|urb-&gt;actual_length
op_eq
l_int|0
)paren
r_goto
id|resubmit
suffix:semicolon
id|type
op_assign
id|data
(braket
l_int|0
)braket
suffix:semicolon
r_if
c_cond
(paren
id|type
op_eq
id|ZD1201_PACKET_EVENTSTAT
op_logical_or
id|type
op_eq
id|ZD1201_PACKET_RESOURCE
)paren
(brace
id|memcpy
c_func
(paren
id|zd-&gt;rxdata
comma
id|data
comma
id|urb-&gt;actual_length
)paren
suffix:semicolon
id|zd-&gt;rxlen
op_assign
id|urb-&gt;actual_length
suffix:semicolon
id|zd-&gt;rxdatas
op_assign
l_int|1
suffix:semicolon
id|wake_up
c_func
(paren
op_amp
id|zd-&gt;rxdataq
)paren
suffix:semicolon
)brace
multiline_comment|/* Info frame */
r_if
c_cond
(paren
id|type
op_eq
id|ZD1201_PACKET_INQUIRE
)paren
(brace
r_int
id|i
op_assign
l_int|0
suffix:semicolon
r_int
r_int
id|infotype
comma
id|framelen
comma
id|copylen
suffix:semicolon
id|framelen
op_assign
id|le16_to_cpu
c_func
(paren
op_star
(paren
id|__le16
op_star
)paren
op_amp
id|data
(braket
l_int|4
)braket
)paren
suffix:semicolon
id|infotype
op_assign
id|le16_to_cpu
c_func
(paren
op_star
(paren
id|__le16
op_star
)paren
op_amp
id|data
(braket
l_int|6
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
id|infotype
op_eq
id|ZD1201_INF_LINKSTATUS
)paren
(brace
r_int
id|linkstatus
suffix:semicolon
id|linkstatus
op_assign
id|le16_to_cpu
c_func
(paren
op_star
(paren
id|__le16
op_star
)paren
op_amp
id|data
(braket
l_int|8
)braket
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|linkstatus
)paren
(brace
r_case
l_int|1
suffix:colon
id|netif_carrier_on
c_func
(paren
id|zd-&gt;dev
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|netif_carrier_off
c_func
(paren
id|zd-&gt;dev
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
id|netif_carrier_off
c_func
(paren
id|zd-&gt;dev
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|4
suffix:colon
id|netif_carrier_on
c_func
(paren
id|zd-&gt;dev
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|netif_carrier_off
c_func
(paren
id|zd-&gt;dev
)paren
suffix:semicolon
)brace
r_goto
id|resubmit
suffix:semicolon
)brace
r_if
c_cond
(paren
id|infotype
op_eq
id|ZD1201_INF_ASSOCSTATUS
)paren
(brace
r_int
id|status
op_assign
id|le16_to_cpu
c_func
(paren
op_star
(paren
id|__le16
op_star
)paren
(paren
id|data
op_plus
l_int|8
)paren
)paren
suffix:semicolon
r_int
id|event
suffix:semicolon
r_union
id|iwreq_data
id|wrqu
suffix:semicolon
r_switch
c_cond
(paren
id|status
)paren
(brace
r_case
id|ZD1201_ASSOCSTATUS_STAASSOC
suffix:colon
r_case
id|ZD1201_ASSOCSTATUS_REASSOC
suffix:colon
id|event
op_assign
id|IWEVREGISTERED
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ZD1201_ASSOCSTATUS_DISASSOC
suffix:colon
r_case
id|ZD1201_ASSOCSTATUS_ASSOCFAIL
suffix:colon
r_case
id|ZD1201_ASSOCSTATUS_AUTHFAIL
suffix:colon
r_default
suffix:colon
id|event
op_assign
id|IWEVEXPIRED
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|wrqu.addr.sa_data
comma
id|data
op_plus
l_int|10
comma
id|ETH_ALEN
)paren
suffix:semicolon
id|wrqu.addr.sa_family
op_assign
id|ARPHRD_ETHER
suffix:semicolon
multiline_comment|/* Send event to user space */
id|wireless_send_event
c_func
(paren
id|zd-&gt;dev
comma
id|event
comma
op_amp
id|wrqu
comma
l_int|NULL
)paren
suffix:semicolon
r_goto
id|resubmit
suffix:semicolon
)brace
r_if
c_cond
(paren
id|infotype
op_eq
id|ZD1201_INF_AUTHREQ
)paren
(brace
r_union
id|iwreq_data
id|wrqu
suffix:semicolon
id|memcpy
c_func
(paren
id|wrqu.addr.sa_data
comma
id|data
op_plus
l_int|8
comma
id|ETH_ALEN
)paren
suffix:semicolon
id|wrqu.addr.sa_family
op_assign
id|ARPHRD_ETHER
suffix:semicolon
multiline_comment|/* There isn&squot;t a event that trully fits this request.&n;&t;&t;&t;   We assume that userspace will be smart enough to&n;&t;&t;&t;   see a new station being expired and sends back a&n;&t;&t;&t;   authstation ioctl to authorize it. */
id|wireless_send_event
c_func
(paren
id|zd-&gt;dev
comma
id|IWEVEXPIRED
comma
op_amp
id|wrqu
comma
l_int|NULL
)paren
suffix:semicolon
r_goto
id|resubmit
suffix:semicolon
)brace
multiline_comment|/* Other infotypes are handled outside this handler */
id|zd-&gt;rxlen
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
id|i
OL
id|urb-&gt;actual_length
)paren
(brace
id|copylen
op_assign
id|le16_to_cpu
c_func
(paren
op_star
(paren
id|__le16
op_star
)paren
op_amp
id|data
(braket
id|i
op_plus
l_int|2
)braket
)paren
suffix:semicolon
multiline_comment|/* Sanity check, sometimes we get junk */
r_if
c_cond
(paren
id|copylen
op_plus
id|zd-&gt;rxlen
OG
r_sizeof
(paren
id|zd-&gt;rxdata
)paren
)paren
r_break
suffix:semicolon
id|memcpy
c_func
(paren
id|zd-&gt;rxdata
op_plus
id|zd-&gt;rxlen
comma
id|data
op_plus
id|i
op_plus
l_int|4
comma
id|copylen
)paren
suffix:semicolon
id|zd-&gt;rxlen
op_add_assign
id|copylen
suffix:semicolon
id|i
op_add_assign
l_int|64
suffix:semicolon
)brace
r_if
c_cond
(paren
id|i
op_ge
id|urb-&gt;actual_length
)paren
(brace
id|zd-&gt;rxdatas
op_assign
l_int|1
suffix:semicolon
id|wake_up
c_func
(paren
op_amp
id|zd-&gt;rxdataq
)paren
suffix:semicolon
)brace
r_goto
id|resubmit
suffix:semicolon
)brace
multiline_comment|/* Actual data */
r_if
c_cond
(paren
id|data
(braket
id|urb-&gt;actual_length
op_minus
l_int|1
)braket
op_eq
id|ZD1201_PACKET_RXDATA
)paren
(brace
r_int
id|datalen
op_assign
id|urb-&gt;actual_length
op_minus
l_int|1
suffix:semicolon
r_int
r_int
id|len
comma
id|fc
comma
id|seq
suffix:semicolon
r_struct
id|hlist_node
op_star
id|node
suffix:semicolon
id|len
op_assign
id|ntohs
c_func
(paren
op_star
(paren
id|__be16
op_star
)paren
op_amp
id|data
(braket
id|datalen
op_minus
l_int|2
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
id|len
OG
id|datalen
)paren
id|len
op_assign
id|datalen
suffix:semicolon
id|fc
op_assign
id|le16_to_cpu
c_func
(paren
op_star
(paren
id|__le16
op_star
)paren
op_amp
id|data
(braket
id|datalen
op_minus
l_int|16
)braket
)paren
suffix:semicolon
id|seq
op_assign
id|le16_to_cpu
c_func
(paren
op_star
(paren
id|__le16
op_star
)paren
op_amp
id|data
(braket
id|datalen
op_minus
l_int|24
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
id|zd-&gt;monitor
)paren
(brace
r_if
c_cond
(paren
id|datalen
OL
l_int|24
)paren
r_goto
id|resubmit
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|skb
op_assign
id|dev_alloc_skb
c_func
(paren
id|datalen
op_plus
l_int|24
)paren
)paren
)paren
r_goto
id|resubmit
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
l_int|2
)paren
comma
op_amp
id|data
(braket
id|datalen
op_minus
l_int|16
)braket
comma
l_int|2
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
l_int|2
)paren
comma
op_amp
id|data
(braket
id|datalen
op_minus
l_int|2
)braket
comma
l_int|2
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
l_int|6
)paren
comma
op_amp
id|data
(braket
id|datalen
op_minus
l_int|14
)braket
comma
l_int|6
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
l_int|6
)paren
comma
op_amp
id|data
(braket
id|datalen
op_minus
l_int|22
)braket
comma
l_int|6
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
l_int|6
)paren
comma
op_amp
id|data
(braket
id|datalen
op_minus
l_int|8
)braket
comma
l_int|6
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
l_int|2
)paren
comma
op_amp
id|data
(braket
id|datalen
op_minus
l_int|24
)braket
comma
l_int|2
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
id|len
)paren
comma
id|data
comma
id|len
)paren
suffix:semicolon
id|skb-&gt;dev
op_assign
id|zd-&gt;dev
suffix:semicolon
id|skb-&gt;dev-&gt;last_rx
op_assign
id|jiffies
suffix:semicolon
id|skb-&gt;protocol
op_assign
id|eth_type_trans
c_func
(paren
id|skb
comma
id|zd-&gt;dev
)paren
suffix:semicolon
id|zd-&gt;stats.rx_packets
op_increment
suffix:semicolon
id|zd-&gt;stats.rx_bytes
op_add_assign
id|skb-&gt;len
suffix:semicolon
id|netif_rx
c_func
(paren
id|skb
)paren
suffix:semicolon
r_goto
id|resubmit
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|seq
op_amp
id|IEEE802_11_SCTL_FRAG
)paren
op_logical_or
(paren
id|fc
op_amp
id|IEEE802_11_FCTL_MOREFRAGS
)paren
)paren
(brace
r_struct
id|zd1201_frag
op_star
id|frag
op_assign
l_int|NULL
suffix:semicolon
r_char
op_star
id|ptr
suffix:semicolon
r_if
c_cond
(paren
id|datalen
OL
l_int|14
)paren
r_goto
id|resubmit
suffix:semicolon
r_if
c_cond
(paren
(paren
id|seq
op_amp
id|IEEE802_11_SCTL_FRAG
)paren
op_eq
l_int|0
)paren
(brace
id|frag
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|zd1201_frag
op_star
)paren
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|frag
)paren
r_goto
id|resubmit
suffix:semicolon
id|skb
op_assign
id|dev_alloc_skb
c_func
(paren
id|IEEE802_11_DATA_LEN
op_plus
l_int|14
op_plus
l_int|2
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|skb
)paren
(brace
id|kfree
c_func
(paren
id|frag
)paren
suffix:semicolon
r_goto
id|resubmit
suffix:semicolon
)brace
id|frag-&gt;skb
op_assign
id|skb
suffix:semicolon
id|frag-&gt;seq
op_assign
id|seq
op_amp
id|IEEE802_11_SCTL_SEQ
suffix:semicolon
id|skb_reserve
c_func
(paren
id|skb
comma
l_int|2
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
l_int|12
)paren
comma
op_amp
id|data
(braket
id|datalen
op_minus
l_int|14
)braket
comma
l_int|12
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
l_int|2
)paren
comma
op_amp
id|data
(braket
l_int|6
)braket
comma
l_int|2
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
id|len
)paren
comma
id|data
op_plus
l_int|8
comma
id|len
)paren
suffix:semicolon
id|hlist_add_head
c_func
(paren
op_amp
id|frag-&gt;fnode
comma
op_amp
id|zd-&gt;fraglist
)paren
suffix:semicolon
r_goto
id|resubmit
suffix:semicolon
)brace
id|hlist_for_each_entry
c_func
(paren
id|frag
comma
id|node
comma
op_amp
id|zd-&gt;fraglist
comma
id|fnode
)paren
r_if
c_cond
(paren
id|frag-&gt;seq
op_eq
(paren
id|seq
op_amp
id|IEEE802_11_SCTL_SEQ
)paren
)paren
(brace
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|frag
)paren
r_goto
id|resubmit
suffix:semicolon
id|skb
op_assign
id|frag-&gt;skb
suffix:semicolon
id|ptr
op_assign
id|skb_put
c_func
(paren
id|skb
comma
id|len
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ptr
)paren
id|memcpy
c_func
(paren
id|ptr
comma
id|data
op_plus
l_int|8
comma
id|len
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fc
op_amp
id|IEEE802_11_FCTL_MOREFRAGS
)paren
r_goto
id|resubmit
suffix:semicolon
id|hlist_del_init
c_func
(paren
op_amp
id|frag-&gt;fnode
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|frag
)paren
suffix:semicolon
multiline_comment|/* Fallthrough */
)brace
r_else
(brace
r_if
c_cond
(paren
id|datalen
OL
l_int|14
)paren
r_goto
id|resubmit
suffix:semicolon
id|skb
op_assign
id|dev_alloc_skb
c_func
(paren
id|len
op_plus
l_int|14
op_plus
l_int|2
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|skb
)paren
r_goto
id|resubmit
suffix:semicolon
id|skb_reserve
c_func
(paren
id|skb
comma
l_int|2
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
l_int|12
)paren
comma
op_amp
id|data
(braket
id|datalen
op_minus
l_int|14
)braket
comma
l_int|12
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
l_int|2
)paren
comma
op_amp
id|data
(braket
l_int|6
)braket
comma
l_int|2
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
id|len
)paren
comma
id|data
op_plus
l_int|8
comma
id|len
)paren
suffix:semicolon
)brace
id|skb-&gt;dev
op_assign
id|zd-&gt;dev
suffix:semicolon
id|skb-&gt;dev-&gt;last_rx
op_assign
id|jiffies
suffix:semicolon
id|skb-&gt;protocol
op_assign
id|eth_type_trans
c_func
(paren
id|skb
comma
id|zd-&gt;dev
)paren
suffix:semicolon
id|zd-&gt;stats.rx_packets
op_increment
suffix:semicolon
id|zd-&gt;stats.rx_bytes
op_add_assign
id|skb-&gt;len
suffix:semicolon
id|netif_rx
c_func
(paren
id|skb
)paren
suffix:semicolon
)brace
id|resubmit
suffix:colon
id|memset
c_func
(paren
id|data
comma
l_int|0
comma
id|ZD1201_RXSIZE
)paren
suffix:semicolon
id|urb-&gt;status
op_assign
l_int|0
suffix:semicolon
id|urb-&gt;dev
op_assign
id|zd-&gt;usb
suffix:semicolon
r_if
c_cond
(paren
id|usb_submit_urb
c_func
(paren
id|urb
comma
id|GFP_ATOMIC
)paren
)paren
(brace
id|free
op_assign
l_int|1
suffix:semicolon
)brace
m_exit
suffix:colon
r_if
c_cond
(paren
id|free
)paren
(brace
id|zd-&gt;rxlen
op_assign
l_int|0
suffix:semicolon
id|zd-&gt;rxdatas
op_assign
l_int|1
suffix:semicolon
id|wake_up
c_func
(paren
op_amp
id|zd-&gt;rxdataq
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|urb-&gt;transfer_buffer
)paren
suffix:semicolon
)brace
r_return
suffix:semicolon
)brace
DECL|function|zd1201_getconfig
r_static
r_int
id|zd1201_getconfig
c_func
(paren
r_struct
id|zd1201
op_star
id|zd
comma
r_int
id|rid
comma
r_void
op_star
id|riddata
comma
r_int
r_int
id|riddatalen
)paren
(brace
r_int
id|err
suffix:semicolon
r_int
id|i
op_assign
l_int|0
suffix:semicolon
r_int
id|code
suffix:semicolon
r_int
id|rid_fid
suffix:semicolon
r_int
id|length
suffix:semicolon
r_int
r_char
op_star
id|pdata
suffix:semicolon
id|zd-&gt;rxdatas
op_assign
l_int|0
suffix:semicolon
id|err
op_assign
id|zd1201_docmd
c_func
(paren
id|zd
comma
id|ZD1201_CMDCODE_ACCESS
comma
id|rid
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
id|wait_event_interruptible
c_func
(paren
id|zd-&gt;rxdataq
comma
id|zd-&gt;rxdatas
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|zd-&gt;rxlen
)paren
r_return
op_minus
id|EIO
suffix:semicolon
id|code
op_assign
id|le16_to_cpu
c_func
(paren
op_star
(paren
id|__le16
op_star
)paren
(paren
op_amp
id|zd-&gt;rxdata
(braket
l_int|4
)braket
)paren
)paren
suffix:semicolon
id|rid_fid
op_assign
id|le16_to_cpu
c_func
(paren
op_star
(paren
id|__le16
op_star
)paren
(paren
op_amp
id|zd-&gt;rxdata
(braket
l_int|6
)braket
)paren
)paren
suffix:semicolon
id|length
op_assign
id|le16_to_cpu
c_func
(paren
op_star
(paren
id|__le16
op_star
)paren
(paren
op_amp
id|zd-&gt;rxdata
(braket
l_int|8
)braket
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|length
OG
id|zd-&gt;rxlen
)paren
id|length
op_assign
id|zd-&gt;rxlen
op_minus
l_int|6
suffix:semicolon
multiline_comment|/* If access bit is not on, then error */
r_if
c_cond
(paren
(paren
id|code
op_amp
id|ZD1201_ACCESSBIT
)paren
op_ne
id|ZD1201_ACCESSBIT
op_logical_or
id|rid_fid
op_ne
id|rid
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
multiline_comment|/* Not enough buffer for allocating data */
r_if
c_cond
(paren
id|riddatalen
op_ne
(paren
id|length
op_minus
l_int|4
)paren
)paren
(brace
id|dev_dbg
c_func
(paren
op_amp
id|zd-&gt;usb-&gt;dev
comma
l_string|&quot;riddatalen mismatches, expected=%u, (packet=%u) length=%u, rid=0x%04X, rid_fid=0x%04X&bslash;n&quot;
comma
id|riddatalen
comma
id|zd-&gt;rxlen
comma
id|length
comma
id|rid
comma
id|rid_fid
)paren
suffix:semicolon
r_return
op_minus
id|ENODATA
suffix:semicolon
)brace
id|zd-&gt;rxdatas
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* Issue SetRxRid commnd */
id|err
op_assign
id|zd1201_docmd
c_func
(paren
id|zd
comma
id|ZD1201_CMDCODE_SETRXRID
comma
id|rid
comma
l_int|0
comma
id|length
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
multiline_comment|/* Receive RID record from resource packets */
id|wait_event_interruptible
c_func
(paren
id|zd-&gt;rxdataq
comma
id|zd-&gt;rxdatas
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|zd-&gt;rxlen
)paren
r_return
op_minus
id|EIO
suffix:semicolon
r_if
c_cond
(paren
id|zd-&gt;rxdata
(braket
id|zd-&gt;rxlen
op_minus
l_int|1
)braket
op_ne
id|ZD1201_PACKET_RESOURCE
)paren
(brace
id|dev_dbg
c_func
(paren
op_amp
id|zd-&gt;usb-&gt;dev
comma
l_string|&quot;Packet type mismatch: 0x%x not 0x3&bslash;n&quot;
comma
id|zd-&gt;rxdata
(braket
id|zd-&gt;rxlen
op_minus
l_int|1
)braket
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
multiline_comment|/* Set the data pointer and received data length */
id|pdata
op_assign
id|zd-&gt;rxdata
suffix:semicolon
id|length
op_assign
id|zd-&gt;rxlen
suffix:semicolon
r_do
(brace
r_int
id|actual_length
suffix:semicolon
id|actual_length
op_assign
(paren
id|length
OG
l_int|64
)paren
ques
c_cond
l_int|64
suffix:colon
id|length
suffix:semicolon
r_if
c_cond
(paren
id|pdata
(braket
l_int|0
)braket
op_ne
l_int|0x3
)paren
(brace
id|dev_dbg
c_func
(paren
op_amp
id|zd-&gt;usb-&gt;dev
comma
l_string|&quot;Rx Resource packet type error: %02X&bslash;n&quot;
comma
id|pdata
(braket
l_int|0
)braket
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|actual_length
op_ne
l_int|64
)paren
(brace
multiline_comment|/* Trim the last packet type byte */
id|actual_length
op_decrement
suffix:semicolon
)brace
multiline_comment|/* Skip the 4 bytes header (RID length and RID) */
r_if
c_cond
(paren
id|i
op_eq
l_int|0
)paren
(brace
id|pdata
op_add_assign
l_int|8
suffix:semicolon
id|actual_length
op_sub_assign
l_int|8
suffix:semicolon
)brace
r_else
(brace
id|pdata
op_add_assign
l_int|4
suffix:semicolon
id|actual_length
op_sub_assign
l_int|4
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|riddata
comma
id|pdata
comma
id|actual_length
)paren
suffix:semicolon
id|riddata
op_add_assign
id|actual_length
suffix:semicolon
id|pdata
op_add_assign
id|actual_length
suffix:semicolon
id|length
op_sub_assign
l_int|64
suffix:semicolon
id|i
op_increment
suffix:semicolon
)brace
r_while
c_loop
(paren
id|length
OG
l_int|0
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; *&t;resreq:&n; *&t;&t;byte&t;type&n; *&t;&t;byte&t;sequence&n; *&t;&t;u16&t;reserved&n; *&t;&t;byte&t;data[12]&n; *&t;total: 16&n; */
DECL|function|zd1201_setconfig
r_static
r_int
id|zd1201_setconfig
c_func
(paren
r_struct
id|zd1201
op_star
id|zd
comma
r_int
id|rid
comma
r_void
op_star
id|buf
comma
r_int
id|len
comma
r_int
id|wait
)paren
(brace
r_int
id|err
suffix:semicolon
r_int
r_char
op_star
id|request
suffix:semicolon
r_int
id|reqlen
suffix:semicolon
r_char
id|seq
op_assign
l_int|0
suffix:semicolon
r_struct
id|urb
op_star
id|urb
suffix:semicolon
r_int
r_int
id|gfp_mask
op_assign
id|wait
ques
c_cond
id|GFP_NOIO
suffix:colon
id|GFP_ATOMIC
suffix:semicolon
id|len
op_add_assign
l_int|4
suffix:semicolon
multiline_comment|/* first 4 are for header */
id|zd-&gt;rxdatas
op_assign
l_int|0
suffix:semicolon
id|zd-&gt;rxlen
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|seq
op_assign
l_int|0
suffix:semicolon
id|len
OG
l_int|0
suffix:semicolon
id|seq
op_increment
)paren
(brace
id|request
op_assign
id|kmalloc
c_func
(paren
l_int|16
comma
id|gfp_mask
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|request
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|urb
op_assign
id|usb_alloc_urb
c_func
(paren
l_int|0
comma
id|gfp_mask
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|urb
)paren
(brace
id|kfree
c_func
(paren
id|request
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|memset
c_func
(paren
id|request
comma
l_int|0
comma
l_int|16
)paren
suffix:semicolon
id|reqlen
op_assign
id|len
OG
l_int|12
ques
c_cond
l_int|12
suffix:colon
id|len
suffix:semicolon
id|request
(braket
l_int|0
)braket
op_assign
id|ZD1201_USB_RESREQ
suffix:semicolon
id|request
(braket
l_int|1
)braket
op_assign
id|seq
suffix:semicolon
id|request
(braket
l_int|2
)braket
op_assign
l_int|0
suffix:semicolon
id|request
(braket
l_int|3
)braket
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|request
(braket
l_int|1
)braket
op_eq
l_int|0
)paren
(brace
multiline_comment|/* add header */
op_star
(paren
id|__le16
op_star
)paren
op_amp
id|request
(braket
l_int|4
)braket
op_assign
id|cpu_to_le16
c_func
(paren
(paren
id|len
op_minus
l_int|2
op_plus
l_int|1
)paren
op_div
l_int|2
)paren
suffix:semicolon
op_star
(paren
id|__le16
op_star
)paren
op_amp
id|request
(braket
l_int|6
)braket
op_assign
id|cpu_to_le16
c_func
(paren
id|rid
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|request
op_plus
l_int|8
comma
id|buf
comma
id|reqlen
op_minus
l_int|4
)paren
suffix:semicolon
id|buf
op_add_assign
id|reqlen
op_minus
l_int|4
suffix:semicolon
)brace
r_else
(brace
id|memcpy
c_func
(paren
id|request
op_plus
l_int|4
comma
id|buf
comma
id|reqlen
)paren
suffix:semicolon
id|buf
op_add_assign
id|reqlen
suffix:semicolon
)brace
id|len
op_sub_assign
id|reqlen
suffix:semicolon
id|usb_fill_bulk_urb
c_func
(paren
id|urb
comma
id|zd-&gt;usb
comma
id|usb_sndbulkpipe
c_func
(paren
id|zd-&gt;usb
comma
id|zd-&gt;endp_out2
)paren
comma
id|request
comma
l_int|16
comma
id|zd1201_usbfree
comma
id|zd
)paren
suffix:semicolon
id|err
op_assign
id|usb_submit_urb
c_func
(paren
id|urb
comma
id|gfp_mask
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_goto
id|err
suffix:semicolon
)brace
id|request
op_assign
id|kmalloc
c_func
(paren
l_int|16
comma
id|gfp_mask
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|request
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|urb
op_assign
id|usb_alloc_urb
c_func
(paren
l_int|0
comma
id|gfp_mask
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|urb
)paren
(brace
id|kfree
c_func
(paren
id|request
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
op_star
(paren
(paren
id|__le32
op_star
)paren
id|request
)paren
op_assign
id|cpu_to_le32
c_func
(paren
id|ZD1201_USB_CMDREQ
)paren
suffix:semicolon
op_star
(paren
(paren
id|__le16
op_star
)paren
op_amp
id|request
(braket
l_int|4
)braket
)paren
op_assign
id|cpu_to_le16
c_func
(paren
id|ZD1201_CMDCODE_ACCESS
op_or
id|ZD1201_ACCESSBIT
)paren
suffix:semicolon
op_star
(paren
(paren
id|__le16
op_star
)paren
op_amp
id|request
(braket
l_int|6
)braket
)paren
op_assign
id|cpu_to_le16
c_func
(paren
id|rid
)paren
suffix:semicolon
op_star
(paren
(paren
id|__le16
op_star
)paren
op_amp
id|request
(braket
l_int|8
)braket
)paren
op_assign
id|cpu_to_le16
c_func
(paren
l_int|0
)paren
suffix:semicolon
op_star
(paren
(paren
id|__le16
op_star
)paren
op_amp
id|request
(braket
l_int|10
)braket
)paren
op_assign
id|cpu_to_le16
c_func
(paren
l_int|0
)paren
suffix:semicolon
id|usb_fill_bulk_urb
c_func
(paren
id|urb
comma
id|zd-&gt;usb
comma
id|usb_sndbulkpipe
c_func
(paren
id|zd-&gt;usb
comma
id|zd-&gt;endp_out2
)paren
comma
id|request
comma
l_int|16
comma
id|zd1201_usbfree
comma
id|zd
)paren
suffix:semicolon
id|err
op_assign
id|usb_submit_urb
c_func
(paren
id|urb
comma
id|gfp_mask
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_goto
id|err
suffix:semicolon
r_if
c_cond
(paren
id|wait
)paren
(brace
id|wait_event_interruptible
c_func
(paren
id|zd-&gt;rxdataq
comma
id|zd-&gt;rxdatas
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|zd-&gt;rxlen
op_logical_or
id|le16_to_cpu
c_func
(paren
op_star
(paren
id|__le16
op_star
)paren
op_amp
id|zd-&gt;rxdata
(braket
l_int|6
)braket
)paren
op_ne
id|rid
)paren
(brace
id|dev_dbg
c_func
(paren
op_amp
id|zd-&gt;usb-&gt;dev
comma
l_string|&quot;wrong or no RID received&bslash;n&quot;
)paren
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
id|err
suffix:colon
id|kfree
c_func
(paren
id|request
)paren
suffix:semicolon
id|usb_free_urb
c_func
(paren
id|urb
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|function|zd1201_getconfig16
r_static
r_inline
r_int
id|zd1201_getconfig16
c_func
(paren
r_struct
id|zd1201
op_star
id|zd
comma
r_int
id|rid
comma
r_int
op_star
id|val
)paren
(brace
r_int
id|err
suffix:semicolon
id|__le16
id|zdval
suffix:semicolon
id|err
op_assign
id|zd1201_getconfig
c_func
(paren
id|zd
comma
id|rid
comma
op_amp
id|zdval
comma
r_sizeof
(paren
id|__le16
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
op_star
id|val
op_assign
id|le16_to_cpu
c_func
(paren
id|zdval
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|zd1201_setconfig16
r_static
r_inline
r_int
id|zd1201_setconfig16
c_func
(paren
r_struct
id|zd1201
op_star
id|zd
comma
r_int
id|rid
comma
r_int
id|val
)paren
(brace
id|__le16
id|zdval
op_assign
id|cpu_to_le16
c_func
(paren
id|val
)paren
suffix:semicolon
r_return
(paren
id|zd1201_setconfig
c_func
(paren
id|zd
comma
id|rid
comma
op_amp
id|zdval
comma
r_sizeof
(paren
id|__le16
)paren
comma
l_int|1
)paren
)paren
suffix:semicolon
)brace
DECL|function|zd1201_drvr_start
r_int
id|zd1201_drvr_start
c_func
(paren
r_struct
id|zd1201
op_star
id|zd
)paren
(brace
r_int
id|err
comma
id|i
suffix:semicolon
r_int
id|max
suffix:semicolon
id|__le16
id|zdmax
suffix:semicolon
r_int
r_char
op_star
id|buffer
suffix:semicolon
id|buffer
op_assign
id|kmalloc
c_func
(paren
id|ZD1201_RXSIZE
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|buffer
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|memset
c_func
(paren
id|buffer
comma
l_int|0
comma
id|ZD1201_RXSIZE
)paren
suffix:semicolon
id|usb_fill_bulk_urb
c_func
(paren
id|zd-&gt;rx_urb
comma
id|zd-&gt;usb
comma
id|usb_rcvbulkpipe
c_func
(paren
id|zd-&gt;usb
comma
id|zd-&gt;endp_in
)paren
comma
id|buffer
comma
id|ZD1201_RXSIZE
comma
id|zd1201_usbrx
comma
id|zd
)paren
suffix:semicolon
id|err
op_assign
id|usb_submit_urb
c_func
(paren
id|zd-&gt;rx_urb
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_goto
id|err_buffer
suffix:semicolon
id|err
op_assign
id|zd1201_docmd
c_func
(paren
id|zd
comma
id|ZD1201_CMDCODE_INIT
comma
l_int|0
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_goto
id|err_urb
suffix:semicolon
id|err
op_assign
id|zd1201_getconfig
c_func
(paren
id|zd
comma
id|ZD1201_RID_CNFMAXTXBUFFERNUMBER
comma
op_amp
id|zdmax
comma
r_sizeof
(paren
id|__le16
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_goto
id|err_urb
suffix:semicolon
id|max
op_assign
id|le16_to_cpu
c_func
(paren
id|zdmax
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|max
suffix:semicolon
id|i
op_increment
)paren
(brace
id|err
op_assign
id|zd1201_docmd
c_func
(paren
id|zd
comma
id|ZD1201_CMDCODE_ALLOC
comma
l_int|1514
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_goto
id|err_urb
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
id|err_urb
suffix:colon
id|usb_kill_urb
c_func
(paren
id|zd-&gt;rx_urb
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
id|err_buffer
suffix:colon
id|kfree
c_func
(paren
id|buffer
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
multiline_comment|/*&t;Magic alert: The firmware doesn&squot;t seem to like the MAC state being&n; *&t;toggled in promisc (aka monitor) mode.&n; *&t;(It works a number of times, but will halt eventually)&n; *&t;So we turn it of before disabling and on after enabling if needed.&n; */
DECL|function|zd1201_enable
r_static
r_int
id|zd1201_enable
c_func
(paren
r_struct
id|zd1201
op_star
id|zd
)paren
(brace
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
id|zd-&gt;mac_enabled
)paren
r_return
l_int|0
suffix:semicolon
id|err
op_assign
id|zd1201_docmd
c_func
(paren
id|zd
comma
id|ZD1201_CMDCODE_ENABLE
comma
l_int|0
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|err
)paren
id|zd-&gt;mac_enabled
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|zd-&gt;monitor
)paren
id|err
op_assign
id|zd1201_setconfig16
c_func
(paren
id|zd
comma
id|ZD1201_RID_PROMISCUOUSMODE
comma
l_int|1
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|function|zd1201_disable
r_static
r_int
id|zd1201_disable
c_func
(paren
r_struct
id|zd1201
op_star
id|zd
)paren
(brace
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|zd-&gt;mac_enabled
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|zd-&gt;monitor
)paren
(brace
id|err
op_assign
id|zd1201_setconfig16
c_func
(paren
id|zd
comma
id|ZD1201_RID_PROMISCUOUSMODE
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
)brace
id|err
op_assign
id|zd1201_docmd
c_func
(paren
id|zd
comma
id|ZD1201_CMDCODE_DISABLE
comma
l_int|0
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|err
)paren
id|zd-&gt;mac_enabled
op_assign
l_int|0
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|function|zd1201_mac_reset
r_static
r_int
id|zd1201_mac_reset
c_func
(paren
r_struct
id|zd1201
op_star
id|zd
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|zd-&gt;mac_enabled
)paren
r_return
l_int|0
suffix:semicolon
id|zd1201_disable
c_func
(paren
id|zd
)paren
suffix:semicolon
r_return
id|zd1201_enable
c_func
(paren
id|zd
)paren
suffix:semicolon
)brace
DECL|function|zd1201_join
r_static
r_int
id|zd1201_join
c_func
(paren
r_struct
id|zd1201
op_star
id|zd
comma
r_char
op_star
id|essid
comma
r_int
id|essidlen
)paren
(brace
r_int
id|err
comma
id|val
suffix:semicolon
r_char
id|buf
(braket
id|IW_ESSID_MAX_SIZE
op_plus
l_int|2
)braket
suffix:semicolon
id|err
op_assign
id|zd1201_disable
c_func
(paren
id|zd
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
id|val
op_assign
id|ZD1201_CNFAUTHENTICATION_OPENSYSTEM
suffix:semicolon
id|val
op_or_assign
id|ZD1201_CNFAUTHENTICATION_SHAREDKEY
suffix:semicolon
id|err
op_assign
id|zd1201_setconfig16
c_func
(paren
id|zd
comma
id|ZD1201_RID_CNFAUTHENTICATION
comma
id|val
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
op_star
(paren
id|__le16
op_star
)paren
id|buf
op_assign
id|cpu_to_le16
c_func
(paren
id|essidlen
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|buf
op_plus
l_int|2
comma
id|essid
comma
id|essidlen
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|zd-&gt;ap
)paren
(brace
multiline_comment|/* Normal station */
id|err
op_assign
id|zd1201_setconfig
c_func
(paren
id|zd
comma
id|ZD1201_RID_CNFDESIREDSSID
comma
id|buf
comma
id|IW_ESSID_MAX_SIZE
op_plus
l_int|2
comma
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* AP */
id|err
op_assign
id|zd1201_setconfig
c_func
(paren
id|zd
comma
id|ZD1201_RID_CNFOWNSSID
comma
id|buf
comma
id|IW_ESSID_MAX_SIZE
op_plus
l_int|2
comma
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
)brace
id|err
op_assign
id|zd1201_setconfig
c_func
(paren
id|zd
comma
id|ZD1201_RID_CNFOWNMACADDR
comma
id|zd-&gt;dev-&gt;dev_addr
comma
id|zd-&gt;dev-&gt;addr_len
comma
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|zd1201_enable
c_func
(paren
id|zd
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
id|msleep
c_func
(paren
l_int|100
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|zd1201_net_open
r_static
r_int
id|zd1201_net_open
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|zd1201
op_star
id|zd
op_assign
(paren
r_struct
id|zd1201
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
multiline_comment|/* Start MAC with wildcard if no essid set */
r_if
c_cond
(paren
op_logical_neg
id|zd-&gt;mac_enabled
)paren
id|zd1201_join
c_func
(paren
id|zd
comma
id|zd-&gt;essid
comma
id|zd-&gt;essidlen
)paren
suffix:semicolon
id|netif_start_queue
c_func
(paren
id|dev
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|zd1201_net_stop
r_static
r_int
id|zd1201_net_stop
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
id|netif_stop_queue
c_func
(paren
id|dev
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n;&t;RFC 1042 encapsulates Ethernet frames in 802.11 frames&n;&t;by prefixing them with 0xaa, 0xaa, 0x03) followed by a SNAP OID of 0&n;&t;(0x00, 0x00, 0x00). Zd requires an additionnal padding, copy&n;&t;of ethernet addresses, length of the standard RFC 1042 packet&n;&t;and a command byte (which is nul for tx).&n;&t;&n;&t;tx frame (from Wlan NG):&n;&t;RFC 1042:&n;&t;&t;llc&t;&t;0xAA 0xAA 0x03 (802.2 LLC)&n;&t;&t;snap&t;&t;0x00 0x00 0x00 (Ethernet encapsulated)&n;&t;&t;type&t;&t;2 bytes, Ethernet type field&n;&t;&t;payload&t;&t;(minus eth header)&n;&t;Zydas specific:&n;&t;&t;padding&t;&t;1B if (skb-&gt;len+8+1)%64==0&n;&t;&t;Eth MAC addr&t;12 bytes, Ethernet MAC addresses&n;&t;&t;length&t;&t;2 bytes, RFC 1042 packet length &n;&t;&t;&t;&t;(llc+snap+type+payload)&n;&t;&t;zd&t;&t;1 null byte, zd1201 packet type&n; */
DECL|function|zd1201_hard_start_xmit
r_static
r_int
id|zd1201_hard_start_xmit
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|zd1201
op_star
id|zd
op_assign
(paren
r_struct
id|zd1201
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_int
r_char
op_star
id|txbuf
op_assign
id|zd-&gt;txdata
suffix:semicolon
r_int
id|txbuflen
comma
id|pad
op_assign
l_int|0
comma
id|err
suffix:semicolon
r_struct
id|urb
op_star
id|urb
op_assign
id|zd-&gt;tx_urb
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|zd-&gt;mac_enabled
op_logical_or
id|zd-&gt;monitor
)paren
(brace
id|zd-&gt;stats.tx_dropped
op_increment
suffix:semicolon
id|kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|netif_stop_queue
c_func
(paren
id|dev
)paren
suffix:semicolon
id|txbuflen
op_assign
id|skb-&gt;len
op_plus
l_int|8
op_plus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|txbuflen
op_mod
l_int|64
op_eq
l_int|0
)paren
(brace
id|pad
op_assign
l_int|1
suffix:semicolon
id|txbuflen
op_increment
suffix:semicolon
)brace
id|txbuf
(braket
l_int|0
)braket
op_assign
l_int|0xAA
suffix:semicolon
id|txbuf
(braket
l_int|1
)braket
op_assign
l_int|0xAA
suffix:semicolon
id|txbuf
(braket
l_int|2
)braket
op_assign
l_int|0x03
suffix:semicolon
id|txbuf
(braket
l_int|3
)braket
op_assign
l_int|0x00
suffix:semicolon
multiline_comment|/* rfc1042 */
id|txbuf
(braket
l_int|4
)braket
op_assign
l_int|0x00
suffix:semicolon
id|txbuf
(braket
l_int|5
)braket
op_assign
l_int|0x00
suffix:semicolon
id|memcpy
c_func
(paren
id|txbuf
op_plus
l_int|6
comma
id|skb-&gt;data
op_plus
l_int|12
comma
id|skb-&gt;len
op_minus
l_int|12
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pad
)paren
id|txbuf
(braket
id|skb-&gt;len
op_minus
l_int|12
op_plus
l_int|6
)braket
op_assign
l_int|0
suffix:semicolon
id|memcpy
c_func
(paren
id|txbuf
op_plus
id|skb-&gt;len
op_minus
l_int|12
op_plus
l_int|6
op_plus
id|pad
comma
id|skb-&gt;data
comma
l_int|12
)paren
suffix:semicolon
op_star
(paren
id|__be16
op_star
)paren
op_amp
id|txbuf
(braket
id|skb-&gt;len
op_plus
l_int|6
op_plus
id|pad
)braket
op_assign
id|htons
c_func
(paren
id|skb-&gt;len
op_minus
l_int|12
op_plus
l_int|6
)paren
suffix:semicolon
id|txbuf
(braket
id|txbuflen
op_minus
l_int|1
)braket
op_assign
l_int|0
suffix:semicolon
id|usb_fill_bulk_urb
c_func
(paren
id|urb
comma
id|zd-&gt;usb
comma
id|usb_sndbulkpipe
c_func
(paren
id|zd-&gt;usb
comma
id|zd-&gt;endp_out
)paren
comma
id|txbuf
comma
id|txbuflen
comma
id|zd1201_usbtx
comma
id|zd
)paren
suffix:semicolon
id|err
op_assign
id|usb_submit_urb
c_func
(paren
id|zd-&gt;tx_urb
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
(brace
id|zd-&gt;stats.tx_errors
op_increment
suffix:semicolon
id|netif_start_queue
c_func
(paren
id|dev
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
id|zd-&gt;stats.tx_packets
op_increment
suffix:semicolon
id|zd-&gt;stats.tx_bytes
op_add_assign
id|skb-&gt;len
suffix:semicolon
id|dev-&gt;trans_start
op_assign
id|jiffies
suffix:semicolon
id|kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|zd1201_tx_timeout
r_static
r_void
id|zd1201_tx_timeout
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|zd1201
op_star
id|zd
op_assign
(paren
r_struct
id|zd1201
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|zd
)paren
r_return
suffix:semicolon
id|dev_warn
c_func
(paren
op_amp
id|zd-&gt;usb-&gt;dev
comma
l_string|&quot;%s: TX timeout, shooting down urb&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
id|zd-&gt;tx_urb-&gt;transfer_flags
op_or_assign
id|URB_ASYNC_UNLINK
suffix:semicolon
id|usb_unlink_urb
c_func
(paren
id|zd-&gt;tx_urb
)paren
suffix:semicolon
id|zd-&gt;stats.tx_errors
op_increment
suffix:semicolon
multiline_comment|/* Restart the timeout to quiet the watchdog: */
id|dev-&gt;trans_start
op_assign
id|jiffies
suffix:semicolon
)brace
DECL|function|zd1201_set_mac_address
r_static
r_int
id|zd1201_set_mac_address
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_void
op_star
id|p
)paren
(brace
r_struct
id|sockaddr
op_star
id|addr
op_assign
id|p
suffix:semicolon
r_struct
id|zd1201
op_star
id|zd
op_assign
(paren
r_struct
id|zd1201
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|zd
)paren
r_return
op_minus
id|ENODEV
suffix:semicolon
id|err
op_assign
id|zd1201_setconfig
c_func
(paren
id|zd
comma
id|ZD1201_RID_CNFOWNMACADDR
comma
id|addr-&gt;sa_data
comma
id|dev-&gt;addr_len
comma
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
id|memcpy
c_func
(paren
id|dev-&gt;dev_addr
comma
id|addr-&gt;sa_data
comma
id|dev-&gt;addr_len
)paren
suffix:semicolon
r_return
id|zd1201_mac_reset
c_func
(paren
id|zd
)paren
suffix:semicolon
)brace
DECL|function|zd1201_get_stats
r_static
r_struct
id|net_device_stats
op_star
id|zd1201_get_stats
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|zd1201
op_star
id|zd
op_assign
(paren
r_struct
id|zd1201
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_return
op_amp
id|zd-&gt;stats
suffix:semicolon
)brace
DECL|function|zd1201_get_wireless_stats
r_static
r_struct
id|iw_statistics
op_star
id|zd1201_get_wireless_stats
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|zd1201
op_star
id|zd
op_assign
(paren
r_struct
id|zd1201
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_return
op_amp
id|zd-&gt;iwstats
suffix:semicolon
)brace
DECL|function|zd1201_set_multicast
r_static
r_void
id|zd1201_set_multicast
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|zd1201
op_star
id|zd
op_assign
(paren
r_struct
id|zd1201
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_struct
id|dev_mc_list
op_star
id|mc
op_assign
id|dev-&gt;mc_list
suffix:semicolon
r_int
r_char
id|reqbuf
(braket
id|ETH_ALEN
op_star
id|ZD1201_MAXMULTI
)braket
suffix:semicolon
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
id|dev-&gt;mc_count
OG
id|ZD1201_MAXMULTI
)paren
r_return
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|dev-&gt;mc_count
suffix:semicolon
id|i
op_increment
)paren
(brace
id|memcpy
c_func
(paren
id|reqbuf
op_plus
id|i
op_star
id|ETH_ALEN
comma
id|mc-&gt;dmi_addr
comma
id|ETH_ALEN
)paren
suffix:semicolon
id|mc
op_assign
id|mc-&gt;next
suffix:semicolon
)brace
id|zd1201_setconfig
c_func
(paren
id|zd
comma
id|ZD1201_RID_CNFGROUPADDRESS
comma
id|reqbuf
comma
id|dev-&gt;mc_count
op_star
id|ETH_ALEN
comma
l_int|0
)paren
suffix:semicolon
)brace
DECL|function|zd1201_config_commit
r_static
r_int
id|zd1201_config_commit
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|iw_request_info
op_star
id|info
comma
r_struct
id|iw_point
op_star
id|data
comma
r_char
op_star
id|essid
)paren
(brace
r_struct
id|zd1201
op_star
id|zd
op_assign
(paren
r_struct
id|zd1201
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_return
id|zd1201_mac_reset
c_func
(paren
id|zd
)paren
suffix:semicolon
)brace
DECL|function|zd1201_get_name
r_static
r_int
id|zd1201_get_name
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|iw_request_info
op_star
id|info
comma
r_char
op_star
id|name
comma
r_char
op_star
id|extra
)paren
(brace
id|strcpy
c_func
(paren
id|name
comma
l_string|&quot;IEEE 802.11b&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|zd1201_set_freq
r_static
r_int
id|zd1201_set_freq
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|iw_request_info
op_star
id|info
comma
r_struct
id|iw_freq
op_star
id|freq
comma
r_char
op_star
id|extra
)paren
(brace
r_struct
id|zd1201
op_star
id|zd
op_assign
(paren
r_struct
id|zd1201
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_int
id|channel
op_assign
l_int|0
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
id|freq-&gt;e
op_eq
l_int|0
)paren
id|channel
op_assign
id|freq-&gt;m
suffix:semicolon
r_else
(brace
r_if
c_cond
(paren
id|freq-&gt;m
op_ge
l_int|2482
)paren
id|channel
op_assign
l_int|14
suffix:semicolon
r_if
c_cond
(paren
id|freq-&gt;m
op_ge
l_int|2407
)paren
id|channel
op_assign
(paren
id|freq-&gt;m
op_minus
l_int|2407
)paren
op_div
l_int|5
suffix:semicolon
)brace
id|err
op_assign
id|zd1201_setconfig16
c_func
(paren
id|zd
comma
id|ZD1201_RID_CNFOWNCHANNEL
comma
id|channel
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
id|zd1201_mac_reset
c_func
(paren
id|zd
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|zd1201_get_freq
r_static
r_int
id|zd1201_get_freq
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|iw_request_info
op_star
id|info
comma
r_struct
id|iw_freq
op_star
id|freq
comma
r_char
op_star
id|extra
)paren
(brace
r_struct
id|zd1201
op_star
id|zd
op_assign
(paren
r_struct
id|zd1201
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_int
id|channel
suffix:semicolon
r_int
id|err
suffix:semicolon
id|err
op_assign
id|zd1201_getconfig16
c_func
(paren
id|zd
comma
id|ZD1201_RID_CNFOWNCHANNEL
comma
op_amp
id|channel
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
id|freq-&gt;e
op_assign
l_int|0
suffix:semicolon
id|freq-&gt;m
op_assign
id|channel
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|zd1201_set_mode
r_static
r_int
id|zd1201_set_mode
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|iw_request_info
op_star
id|info
comma
id|__u32
op_star
id|mode
comma
r_char
op_star
id|extra
)paren
(brace
r_struct
id|zd1201
op_star
id|zd
op_assign
(paren
r_struct
id|zd1201
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_int
id|porttype
comma
id|monitor
op_assign
l_int|0
suffix:semicolon
r_int
r_char
id|buffer
(braket
id|IW_ESSID_MAX_SIZE
op_plus
l_int|2
)braket
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
id|zd-&gt;ap
)paren
(brace
r_if
c_cond
(paren
op_star
id|mode
op_ne
id|IW_MODE_MASTER
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|err
op_assign
id|zd1201_setconfig16
c_func
(paren
id|zd
comma
id|ZD1201_RID_PROMISCUOUSMODE
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
id|zd-&gt;dev-&gt;type
op_assign
id|ARPHRD_ETHER
suffix:semicolon
r_switch
c_cond
(paren
op_star
id|mode
)paren
(brace
r_case
id|IW_MODE_MONITOR
suffix:colon
id|monitor
op_assign
l_int|1
suffix:semicolon
id|zd-&gt;dev-&gt;type
op_assign
id|ARPHRD_IEEE80211
suffix:semicolon
multiline_comment|/* Make sure we are no longer associated with by&n;&t;&t;&t;   setting an &squot;impossible&squot; essid.&n;&t;&t;&t;   (otherwise we mess up firmware)&n;&t;&t;&t; */
id|zd1201_join
c_func
(paren
id|zd
comma
l_string|&quot;&bslash;0-*#&bslash;0&quot;
comma
l_int|5
)paren
suffix:semicolon
multiline_comment|/* Put port in pIBSS */
r_case
l_int|8
suffix:colon
multiline_comment|/* No pseudo-IBSS in wireless extensions (yet) */
id|porttype
op_assign
id|ZD1201_PORTTYPE_PSEUDOIBSS
suffix:semicolon
r_break
suffix:semicolon
r_case
id|IW_MODE_ADHOC
suffix:colon
id|porttype
op_assign
id|ZD1201_PORTTYPE_IBSS
suffix:semicolon
r_break
suffix:semicolon
r_case
id|IW_MODE_INFRA
suffix:colon
id|porttype
op_assign
id|ZD1201_PORTTYPE_BSS
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|err
op_assign
id|zd1201_setconfig16
c_func
(paren
id|zd
comma
id|ZD1201_RID_CNFPORTTYPE
comma
id|porttype
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
r_if
c_cond
(paren
id|zd-&gt;monitor
op_logical_and
op_logical_neg
id|monitor
)paren
(brace
id|zd1201_disable
c_func
(paren
id|zd
)paren
suffix:semicolon
op_star
(paren
id|__le16
op_star
)paren
id|buffer
op_assign
id|cpu_to_le16
c_func
(paren
id|zd-&gt;essidlen
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|buffer
op_plus
l_int|2
comma
id|zd-&gt;essid
comma
id|zd-&gt;essidlen
)paren
suffix:semicolon
id|err
op_assign
id|zd1201_setconfig
c_func
(paren
id|zd
comma
id|ZD1201_RID_CNFDESIREDSSID
comma
id|buffer
comma
id|IW_ESSID_MAX_SIZE
op_plus
l_int|2
comma
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
)brace
id|zd-&gt;monitor
op_assign
id|monitor
suffix:semicolon
multiline_comment|/* If monitor mode is set we don&squot;t actually turn it on here since it&n;&t; * is done during mac reset anyway (see zd1201_mac_enable).&n;&t; */
id|zd1201_mac_reset
c_func
(paren
id|zd
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|zd1201_get_mode
r_static
r_int
id|zd1201_get_mode
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|iw_request_info
op_star
id|info
comma
id|__u32
op_star
id|mode
comma
r_char
op_star
id|extra
)paren
(brace
r_struct
id|zd1201
op_star
id|zd
op_assign
(paren
r_struct
id|zd1201
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_int
id|porttype
suffix:semicolon
r_int
id|err
suffix:semicolon
id|err
op_assign
id|zd1201_getconfig16
c_func
(paren
id|zd
comma
id|ZD1201_RID_CNFPORTTYPE
comma
op_amp
id|porttype
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
r_switch
c_cond
(paren
id|porttype
)paren
(brace
r_case
id|ZD1201_PORTTYPE_IBSS
suffix:colon
op_star
id|mode
op_assign
id|IW_MODE_ADHOC
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ZD1201_PORTTYPE_BSS
suffix:colon
op_star
id|mode
op_assign
id|IW_MODE_INFRA
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ZD1201_PORTTYPE_WDS
suffix:colon
op_star
id|mode
op_assign
id|IW_MODE_REPEAT
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ZD1201_PORTTYPE_PSEUDOIBSS
suffix:colon
op_star
id|mode
op_assign
l_int|8
suffix:semicolon
multiline_comment|/* No Pseudo-IBSS... */
r_break
suffix:semicolon
r_case
id|ZD1201_PORTTYPE_AP
suffix:colon
op_star
id|mode
op_assign
id|IW_MODE_MASTER
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|dev_dbg
c_func
(paren
op_amp
id|zd-&gt;usb-&gt;dev
comma
l_string|&quot;Unknown porttype: %d&bslash;n&quot;
comma
id|porttype
)paren
suffix:semicolon
op_star
id|mode
op_assign
id|IW_MODE_AUTO
suffix:semicolon
)brace
r_if
c_cond
(paren
id|zd-&gt;monitor
)paren
op_star
id|mode
op_assign
id|IW_MODE_MONITOR
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|zd1201_get_range
r_static
r_int
id|zd1201_get_range
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|iw_request_info
op_star
id|info
comma
r_struct
id|iw_point
op_star
id|wrq
comma
r_char
op_star
id|extra
)paren
(brace
r_struct
id|iw_range
op_star
id|range
op_assign
(paren
r_struct
id|iw_range
op_star
)paren
id|extra
suffix:semicolon
id|wrq-&gt;length
op_assign
r_sizeof
(paren
r_struct
id|iw_range
)paren
suffix:semicolon
id|memset
c_func
(paren
id|range
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|iw_range
)paren
)paren
suffix:semicolon
id|range-&gt;we_version_compiled
op_assign
id|WIRELESS_EXT
suffix:semicolon
id|range-&gt;we_version_source
op_assign
id|WIRELESS_EXT
suffix:semicolon
id|range-&gt;max_qual.qual
op_assign
l_int|128
suffix:semicolon
id|range-&gt;max_qual.level
op_assign
l_int|128
suffix:semicolon
id|range-&gt;max_qual.noise
op_assign
l_int|128
suffix:semicolon
id|range-&gt;max_qual.updated
op_assign
l_int|7
suffix:semicolon
id|range-&gt;encoding_size
(braket
l_int|0
)braket
op_assign
l_int|5
suffix:semicolon
id|range-&gt;encoding_size
(braket
l_int|1
)braket
op_assign
l_int|13
suffix:semicolon
id|range-&gt;num_encoding_sizes
op_assign
l_int|2
suffix:semicolon
id|range-&gt;max_encoding_tokens
op_assign
id|ZD1201_NUMKEYS
suffix:semicolon
id|range-&gt;num_bitrates
op_assign
l_int|4
suffix:semicolon
id|range-&gt;bitrate
(braket
l_int|0
)braket
op_assign
l_int|1000000
suffix:semicolon
id|range-&gt;bitrate
(braket
l_int|1
)braket
op_assign
l_int|2000000
suffix:semicolon
id|range-&gt;bitrate
(braket
l_int|2
)braket
op_assign
l_int|5500000
suffix:semicolon
id|range-&gt;bitrate
(braket
l_int|3
)braket
op_assign
l_int|11000000
suffix:semicolon
id|range-&gt;min_rts
op_assign
l_int|0
suffix:semicolon
id|range-&gt;min_frag
op_assign
id|ZD1201_FRAGMIN
suffix:semicolon
id|range-&gt;max_rts
op_assign
id|ZD1201_RTSMAX
suffix:semicolon
id|range-&gt;min_frag
op_assign
id|ZD1201_FRAGMAX
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&t;Little bit of magic here: we only get the quality if we poll&n; *&t;for it, and we never get an actual request to trigger such&n; *&t;a poll. Therefore we &squot;asume&squot; that the user will soon ask for&n; *&t;the stats after asking the bssid.&n; */
DECL|function|zd1201_get_wap
r_static
r_int
id|zd1201_get_wap
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|iw_request_info
op_star
id|info
comma
r_struct
id|sockaddr
op_star
id|ap_addr
comma
r_char
op_star
id|extra
)paren
(brace
r_struct
id|zd1201
op_star
id|zd
op_assign
(paren
r_struct
id|zd1201
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_int
r_char
id|buffer
(braket
l_int|6
)braket
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|zd1201_getconfig
c_func
(paren
id|zd
comma
id|ZD1201_RID_COMMSQUALITY
comma
id|buffer
comma
l_int|6
)paren
)paren
(brace
multiline_comment|/* Unfortunatly the quality and noise reported is useless.&n;&t;&t;   they seem to be accumulators that increase until you&n;&t;&t;   read them, unless we poll on a fixed interval we can&squot;t&n;&t;&t;   use them&n;&t;&t; */
multiline_comment|/*zd-&gt;iwstats.qual.qual = le16_to_cpu(((__le16 *)buffer)[0]);*/
id|zd-&gt;iwstats.qual.level
op_assign
id|le16_to_cpu
c_func
(paren
(paren
(paren
id|__le16
op_star
)paren
id|buffer
)paren
(braket
l_int|1
)braket
)paren
suffix:semicolon
multiline_comment|/*zd-&gt;iwstats.qual.noise = le16_to_cpu(((__le16 *)buffer)[2]);*/
id|zd-&gt;iwstats.qual.updated
op_assign
l_int|2
suffix:semicolon
)brace
r_return
id|zd1201_getconfig
c_func
(paren
id|zd
comma
id|ZD1201_RID_CURRENTBSSID
comma
id|ap_addr-&gt;sa_data
comma
l_int|6
)paren
suffix:semicolon
)brace
DECL|function|zd1201_set_scan
r_static
r_int
id|zd1201_set_scan
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|iw_request_info
op_star
id|info
comma
r_struct
id|iw_point
op_star
id|srq
comma
r_char
op_star
id|extra
)paren
(brace
multiline_comment|/* We do everything in get_scan */
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|zd1201_get_scan
r_static
r_int
id|zd1201_get_scan
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|iw_request_info
op_star
id|info
comma
r_struct
id|iw_point
op_star
id|srq
comma
r_char
op_star
id|extra
)paren
(brace
r_struct
id|zd1201
op_star
id|zd
op_assign
(paren
r_struct
id|zd1201
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_int
id|err
comma
id|i
comma
id|j
comma
id|enabled_save
suffix:semicolon
r_struct
id|iw_event
id|iwe
suffix:semicolon
r_char
op_star
id|cev
op_assign
id|extra
suffix:semicolon
r_char
op_star
id|end_buf
op_assign
id|extra
op_plus
id|IW_SCAN_MAX_DATA
suffix:semicolon
multiline_comment|/* No scanning in AP mode */
r_if
c_cond
(paren
id|zd-&gt;ap
)paren
r_return
op_minus
id|EOPNOTSUPP
suffix:semicolon
multiline_comment|/* Scan doesn&squot;t seem to work if disabled */
id|enabled_save
op_assign
id|zd-&gt;mac_enabled
suffix:semicolon
id|zd1201_enable
c_func
(paren
id|zd
)paren
suffix:semicolon
id|zd-&gt;rxdatas
op_assign
l_int|0
suffix:semicolon
id|err
op_assign
id|zd1201_docmd
c_func
(paren
id|zd
comma
id|ZD1201_CMDCODE_INQUIRE
comma
id|ZD1201_INQ_SCANRESULTS
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
id|wait_event_interruptible
c_func
(paren
id|zd-&gt;rxdataq
comma
id|zd-&gt;rxdatas
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|zd-&gt;rxlen
)paren
r_return
op_minus
id|EIO
suffix:semicolon
r_if
c_cond
(paren
id|le16_to_cpu
c_func
(paren
op_star
(paren
id|__le16
op_star
)paren
op_amp
id|zd-&gt;rxdata
(braket
l_int|2
)braket
)paren
op_ne
id|ZD1201_INQ_SCANRESULTS
)paren
r_return
op_minus
id|EIO
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|8
suffix:semicolon
id|i
OL
id|zd-&gt;rxlen
suffix:semicolon
id|i
op_add_assign
l_int|62
)paren
(brace
id|iwe.cmd
op_assign
id|SIOCGIWAP
suffix:semicolon
id|iwe.u.ap_addr.sa_family
op_assign
id|ARPHRD_ETHER
suffix:semicolon
id|memcpy
c_func
(paren
id|iwe.u.ap_addr.sa_data
comma
id|zd-&gt;rxdata
op_plus
id|i
op_plus
l_int|6
comma
l_int|6
)paren
suffix:semicolon
id|cev
op_assign
id|iwe_stream_add_event
c_func
(paren
id|cev
comma
id|end_buf
comma
op_amp
id|iwe
comma
id|IW_EV_ADDR_LEN
)paren
suffix:semicolon
id|iwe.cmd
op_assign
id|SIOCGIWESSID
suffix:semicolon
id|iwe.u.data.length
op_assign
id|zd-&gt;rxdata
(braket
id|i
op_plus
l_int|16
)braket
suffix:semicolon
id|iwe.u.data.flags
op_assign
l_int|1
suffix:semicolon
id|cev
op_assign
id|iwe_stream_add_point
c_func
(paren
id|cev
comma
id|end_buf
comma
op_amp
id|iwe
comma
id|zd-&gt;rxdata
op_plus
id|i
op_plus
l_int|18
)paren
suffix:semicolon
id|iwe.cmd
op_assign
id|SIOCGIWMODE
suffix:semicolon
r_if
c_cond
(paren
id|zd-&gt;rxdata
(braket
id|i
op_plus
l_int|14
)braket
op_amp
l_int|0x01
)paren
id|iwe.u.mode
op_assign
id|IW_MODE_MASTER
suffix:semicolon
r_else
id|iwe.u.mode
op_assign
id|IW_MODE_ADHOC
suffix:semicolon
id|cev
op_assign
id|iwe_stream_add_event
c_func
(paren
id|cev
comma
id|end_buf
comma
op_amp
id|iwe
comma
id|IW_EV_UINT_LEN
)paren
suffix:semicolon
id|iwe.cmd
op_assign
id|SIOCGIWFREQ
suffix:semicolon
id|iwe.u.freq.m
op_assign
id|zd-&gt;rxdata
(braket
id|i
op_plus
l_int|0
)braket
suffix:semicolon
id|iwe.u.freq.e
op_assign
l_int|0
suffix:semicolon
id|cev
op_assign
id|iwe_stream_add_event
c_func
(paren
id|cev
comma
id|end_buf
comma
op_amp
id|iwe
comma
id|IW_EV_FREQ_LEN
)paren
suffix:semicolon
id|iwe.cmd
op_assign
id|SIOCGIWRATE
suffix:semicolon
id|iwe.u.bitrate.fixed
op_assign
l_int|0
suffix:semicolon
id|iwe.u.bitrate.disabled
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
l_int|10
suffix:semicolon
id|j
op_increment
)paren
r_if
c_cond
(paren
id|zd-&gt;rxdata
(braket
id|i
op_plus
l_int|50
op_plus
id|j
)braket
)paren
(brace
id|iwe.u.bitrate.value
op_assign
(paren
id|zd-&gt;rxdata
(braket
id|i
op_plus
l_int|50
op_plus
id|j
)braket
op_amp
l_int|0x7f
)paren
op_star
l_int|500000
suffix:semicolon
id|cev
op_assign
id|iwe_stream_add_event
c_func
(paren
id|cev
comma
id|end_buf
comma
op_amp
id|iwe
comma
id|IW_EV_PARAM_LEN
)paren
suffix:semicolon
)brace
id|iwe.cmd
op_assign
id|SIOCGIWENCODE
suffix:semicolon
id|iwe.u.data.length
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|zd-&gt;rxdata
(braket
id|i
op_plus
l_int|14
)braket
op_amp
l_int|0x10
)paren
id|iwe.u.data.flags
op_assign
id|IW_ENCODE_ENABLED
suffix:semicolon
r_else
id|iwe.u.data.flags
op_assign
id|IW_ENCODE_DISABLED
suffix:semicolon
id|cev
op_assign
id|iwe_stream_add_point
c_func
(paren
id|cev
comma
id|end_buf
comma
op_amp
id|iwe
comma
l_int|NULL
)paren
suffix:semicolon
id|iwe.cmd
op_assign
id|IWEVQUAL
suffix:semicolon
id|iwe.u.qual.qual
op_assign
id|zd-&gt;rxdata
(braket
id|i
op_plus
l_int|4
)braket
suffix:semicolon
id|iwe.u.qual.noise
op_assign
id|zd-&gt;rxdata
(braket
id|i
op_plus
l_int|2
)braket
op_div
l_int|10
op_minus
l_int|100
suffix:semicolon
id|iwe.u.qual.level
op_assign
(paren
l_int|256
op_plus
id|zd-&gt;rxdata
(braket
id|i
op_plus
l_int|4
)braket
op_star
l_int|100
)paren
op_div
l_int|255
op_minus
l_int|100
suffix:semicolon
id|iwe.u.qual.updated
op_assign
l_int|7
suffix:semicolon
id|cev
op_assign
id|iwe_stream_add_event
c_func
(paren
id|cev
comma
id|end_buf
comma
op_amp
id|iwe
comma
id|IW_EV_QUAL_LEN
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|enabled_save
)paren
id|zd1201_disable
c_func
(paren
id|zd
)paren
suffix:semicolon
id|srq-&gt;length
op_assign
id|cev
op_minus
id|extra
suffix:semicolon
id|srq-&gt;flags
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|zd1201_set_essid
r_static
r_int
id|zd1201_set_essid
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|iw_request_info
op_star
id|info
comma
r_struct
id|iw_point
op_star
id|data
comma
r_char
op_star
id|essid
)paren
(brace
r_struct
id|zd1201
op_star
id|zd
op_assign
(paren
r_struct
id|zd1201
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_if
c_cond
(paren
id|data-&gt;length
OG
id|IW_ESSID_MAX_SIZE
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|data-&gt;length
OL
l_int|1
)paren
id|data-&gt;length
op_assign
l_int|1
suffix:semicolon
id|zd-&gt;essidlen
op_assign
id|data-&gt;length
op_minus
l_int|1
suffix:semicolon
id|memset
c_func
(paren
id|zd-&gt;essid
comma
l_int|0
comma
id|IW_ESSID_MAX_SIZE
op_plus
l_int|1
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|zd-&gt;essid
comma
id|essid
comma
id|data-&gt;length
)paren
suffix:semicolon
r_return
id|zd1201_join
c_func
(paren
id|zd
comma
id|zd-&gt;essid
comma
id|zd-&gt;essidlen
)paren
suffix:semicolon
)brace
DECL|function|zd1201_get_essid
r_static
r_int
id|zd1201_get_essid
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|iw_request_info
op_star
id|info
comma
r_struct
id|iw_point
op_star
id|data
comma
r_char
op_star
id|essid
)paren
(brace
r_struct
id|zd1201
op_star
id|zd
op_assign
(paren
r_struct
id|zd1201
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
id|memcpy
c_func
(paren
id|essid
comma
id|zd-&gt;essid
comma
id|zd-&gt;essidlen
)paren
suffix:semicolon
id|data-&gt;flags
op_assign
l_int|1
suffix:semicolon
id|data-&gt;length
op_assign
id|zd-&gt;essidlen
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|zd1201_get_nick
r_static
r_int
id|zd1201_get_nick
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|iw_request_info
op_star
id|info
comma
r_struct
id|iw_point
op_star
id|data
comma
r_char
op_star
id|nick
)paren
(brace
id|strcpy
c_func
(paren
id|nick
comma
l_string|&quot;zd1201&quot;
)paren
suffix:semicolon
id|data-&gt;flags
op_assign
l_int|1
suffix:semicolon
id|data-&gt;length
op_assign
id|strlen
c_func
(paren
id|nick
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|zd1201_set_rate
r_static
r_int
id|zd1201_set_rate
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|iw_request_info
op_star
id|info
comma
r_struct
id|iw_param
op_star
id|rrq
comma
r_char
op_star
id|extra
)paren
(brace
r_struct
id|zd1201
op_star
id|zd
op_assign
(paren
r_struct
id|zd1201
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_int
id|rate
suffix:semicolon
r_int
id|err
suffix:semicolon
r_switch
c_cond
(paren
id|rrq-&gt;value
)paren
(brace
r_case
l_int|1000000
suffix:colon
id|rate
op_assign
id|ZD1201_RATEB1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2000000
suffix:colon
id|rate
op_assign
id|ZD1201_RATEB2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|5500000
suffix:colon
id|rate
op_assign
id|ZD1201_RATEB5
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|11000000
suffix:colon
r_default
suffix:colon
id|rate
op_assign
id|ZD1201_RATEB11
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|rrq-&gt;fixed
)paren
(brace
multiline_comment|/* Also enable all lower bitrates */
id|rate
op_or_assign
id|rate
op_minus
l_int|1
suffix:semicolon
)brace
id|err
op_assign
id|zd1201_setconfig16
c_func
(paren
id|zd
comma
id|ZD1201_RID_TXRATECNTL
comma
id|rate
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
r_return
id|zd1201_mac_reset
c_func
(paren
id|zd
)paren
suffix:semicolon
)brace
DECL|function|zd1201_get_rate
r_static
r_int
id|zd1201_get_rate
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|iw_request_info
op_star
id|info
comma
r_struct
id|iw_param
op_star
id|rrq
comma
r_char
op_star
id|extra
)paren
(brace
r_struct
id|zd1201
op_star
id|zd
op_assign
(paren
r_struct
id|zd1201
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_int
id|rate
suffix:semicolon
r_int
id|err
suffix:semicolon
id|err
op_assign
id|zd1201_getconfig16
c_func
(paren
id|zd
comma
id|ZD1201_RID_CURRENTTXRATE
comma
op_amp
id|rate
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
r_switch
c_cond
(paren
id|rate
)paren
(brace
r_case
l_int|1
suffix:colon
id|rrq-&gt;value
op_assign
l_int|1000000
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|rrq-&gt;value
op_assign
l_int|2000000
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|5
suffix:colon
id|rrq-&gt;value
op_assign
l_int|5500000
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|11
suffix:colon
id|rrq-&gt;value
op_assign
l_int|11000000
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|rrq-&gt;value
op_assign
l_int|0
suffix:semicolon
)brace
id|rrq-&gt;fixed
op_assign
l_int|0
suffix:semicolon
id|rrq-&gt;disabled
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|zd1201_set_rts
r_static
r_int
id|zd1201_set_rts
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|iw_request_info
op_star
id|info
comma
r_struct
id|iw_param
op_star
id|rts
comma
r_char
op_star
id|extra
)paren
(brace
r_struct
id|zd1201
op_star
id|zd
op_assign
(paren
r_struct
id|zd1201
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_int
id|err
suffix:semicolon
r_int
id|val
op_assign
id|rts-&gt;value
suffix:semicolon
r_if
c_cond
(paren
id|rts-&gt;disabled
op_logical_or
op_logical_neg
id|rts-&gt;fixed
)paren
id|val
op_assign
id|ZD1201_RTSMAX
suffix:semicolon
r_if
c_cond
(paren
id|val
OG
id|ZD1201_RTSMAX
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|val
OL
l_int|0
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|err
op_assign
id|zd1201_setconfig16
c_func
(paren
id|zd
comma
id|ZD1201_RID_CNFRTSTHRESHOLD
comma
id|val
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
r_return
id|zd1201_mac_reset
c_func
(paren
id|zd
)paren
suffix:semicolon
)brace
DECL|function|zd1201_get_rts
r_static
r_int
id|zd1201_get_rts
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|iw_request_info
op_star
id|info
comma
r_struct
id|iw_param
op_star
id|rts
comma
r_char
op_star
id|extra
)paren
(brace
r_struct
id|zd1201
op_star
id|zd
op_assign
(paren
r_struct
id|zd1201
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_int
id|rtst
suffix:semicolon
r_int
id|err
suffix:semicolon
id|err
op_assign
id|zd1201_getconfig16
c_func
(paren
id|zd
comma
id|ZD1201_RID_CNFRTSTHRESHOLD
comma
op_amp
id|rtst
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
id|rts-&gt;value
op_assign
id|rtst
suffix:semicolon
id|rts-&gt;disabled
op_assign
(paren
id|rts-&gt;value
op_eq
id|ZD1201_RTSMAX
)paren
suffix:semicolon
id|rts-&gt;fixed
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|zd1201_set_frag
r_static
r_int
id|zd1201_set_frag
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|iw_request_info
op_star
id|info
comma
r_struct
id|iw_param
op_star
id|frag
comma
r_char
op_star
id|extra
)paren
(brace
r_struct
id|zd1201
op_star
id|zd
op_assign
(paren
r_struct
id|zd1201
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_int
id|err
suffix:semicolon
r_int
id|val
op_assign
id|frag-&gt;value
suffix:semicolon
r_if
c_cond
(paren
id|frag-&gt;disabled
op_logical_or
op_logical_neg
id|frag-&gt;fixed
)paren
id|val
op_assign
id|ZD1201_FRAGMAX
suffix:semicolon
r_if
c_cond
(paren
id|val
OG
id|ZD1201_FRAGMAX
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|val
OL
id|ZD1201_FRAGMIN
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|val
op_amp
l_int|1
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|err
op_assign
id|zd1201_setconfig16
c_func
(paren
id|zd
comma
id|ZD1201_RID_CNFFRAGTHRESHOLD
comma
id|val
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
r_return
id|zd1201_mac_reset
c_func
(paren
id|zd
)paren
suffix:semicolon
)brace
DECL|function|zd1201_get_frag
r_static
r_int
id|zd1201_get_frag
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|iw_request_info
op_star
id|info
comma
r_struct
id|iw_param
op_star
id|frag
comma
r_char
op_star
id|extra
)paren
(brace
r_struct
id|zd1201
op_star
id|zd
op_assign
(paren
r_struct
id|zd1201
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_int
id|fragt
suffix:semicolon
r_int
id|err
suffix:semicolon
id|err
op_assign
id|zd1201_getconfig16
c_func
(paren
id|zd
comma
id|ZD1201_RID_CNFFRAGTHRESHOLD
comma
op_amp
id|fragt
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
id|frag-&gt;value
op_assign
id|fragt
suffix:semicolon
id|frag-&gt;disabled
op_assign
(paren
id|frag-&gt;value
op_eq
id|ZD1201_FRAGMAX
)paren
suffix:semicolon
id|frag-&gt;fixed
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|zd1201_set_retry
r_static
r_int
id|zd1201_set_retry
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|iw_request_info
op_star
id|info
comma
r_struct
id|iw_param
op_star
id|rrq
comma
r_char
op_star
id|extra
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|zd1201_get_retry
r_static
r_int
id|zd1201_get_retry
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|iw_request_info
op_star
id|info
comma
r_struct
id|iw_param
op_star
id|rrq
comma
r_char
op_star
id|extra
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|zd1201_set_encode
r_static
r_int
id|zd1201_set_encode
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|iw_request_info
op_star
id|info
comma
r_struct
id|iw_point
op_star
id|erq
comma
r_char
op_star
id|key
)paren
(brace
r_struct
id|zd1201
op_star
id|zd
op_assign
(paren
r_struct
id|zd1201
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_int
id|i
suffix:semicolon
r_int
id|err
comma
id|rid
suffix:semicolon
r_if
c_cond
(paren
id|erq-&gt;length
OG
id|ZD1201_MAXKEYLEN
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|i
op_assign
(paren
id|erq-&gt;flags
op_amp
id|IW_ENCODE_INDEX
)paren
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|i
op_eq
op_minus
l_int|1
)paren
(brace
id|err
op_assign
id|zd1201_getconfig16
c_func
(paren
id|zd
comma
id|ZD1201_RID_CNFDEFAULTKEYID
comma
op_amp
id|i
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
)brace
r_else
(brace
id|err
op_assign
id|zd1201_setconfig16
c_func
(paren
id|zd
comma
id|ZD1201_RID_CNFDEFAULTKEYID
comma
id|i
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
)brace
r_if
c_cond
(paren
id|i
OL
l_int|0
op_logical_or
id|i
op_ge
id|ZD1201_NUMKEYS
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|rid
op_assign
id|ZD1201_RID_CNFDEFAULTKEY0
op_plus
id|i
suffix:semicolon
id|err
op_assign
id|zd1201_setconfig
c_func
(paren
id|zd
comma
id|rid
comma
id|key
comma
id|erq-&gt;length
comma
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
id|zd-&gt;encode_keylen
(braket
id|i
)braket
op_assign
id|erq-&gt;length
suffix:semicolon
id|memcpy
c_func
(paren
id|zd-&gt;encode_keys
(braket
id|i
)braket
comma
id|key
comma
id|erq-&gt;length
)paren
suffix:semicolon
id|i
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|erq-&gt;flags
op_amp
id|IW_ENCODE_DISABLED
op_amp
id|IW_ENCODE_MODE
)paren
)paren
(brace
id|i
op_or_assign
l_int|0x01
suffix:semicolon
id|zd-&gt;encode_enabled
op_assign
l_int|1
suffix:semicolon
)brace
r_else
id|zd-&gt;encode_enabled
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|erq-&gt;flags
op_amp
id|IW_ENCODE_RESTRICTED
op_amp
id|IW_ENCODE_MODE
)paren
(brace
id|i
op_or_assign
l_int|0x02
suffix:semicolon
id|zd-&gt;encode_restricted
op_assign
l_int|1
suffix:semicolon
)brace
r_else
id|zd-&gt;encode_restricted
op_assign
l_int|0
suffix:semicolon
id|err
op_assign
id|zd1201_setconfig16
c_func
(paren
id|zd
comma
id|ZD1201_RID_CNFWEBFLAGS
comma
id|i
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
r_if
c_cond
(paren
id|zd-&gt;encode_enabled
)paren
id|i
op_assign
id|ZD1201_CNFAUTHENTICATION_SHAREDKEY
suffix:semicolon
r_else
id|i
op_assign
id|ZD1201_CNFAUTHENTICATION_OPENSYSTEM
suffix:semicolon
id|err
op_assign
id|zd1201_setconfig16
c_func
(paren
id|zd
comma
id|ZD1201_RID_CNFAUTHENTICATION
comma
id|i
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
r_return
id|zd1201_mac_reset
c_func
(paren
id|zd
)paren
suffix:semicolon
)brace
DECL|function|zd1201_get_encode
r_static
r_int
id|zd1201_get_encode
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|iw_request_info
op_star
id|info
comma
r_struct
id|iw_point
op_star
id|erq
comma
r_char
op_star
id|key
)paren
(brace
r_struct
id|zd1201
op_star
id|zd
op_assign
(paren
r_struct
id|zd1201
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_int
id|i
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
id|zd-&gt;encode_enabled
)paren
id|erq-&gt;flags
op_assign
id|IW_ENCODE_ENABLED
suffix:semicolon
r_else
id|erq-&gt;flags
op_assign
id|IW_ENCODE_DISABLED
suffix:semicolon
r_if
c_cond
(paren
id|zd-&gt;encode_restricted
)paren
id|erq-&gt;flags
op_or_assign
id|IW_ENCODE_RESTRICTED
suffix:semicolon
r_else
id|erq-&gt;flags
op_or_assign
id|IW_ENCODE_OPEN
suffix:semicolon
id|i
op_assign
(paren
id|erq-&gt;flags
op_amp
id|IW_ENCODE_INDEX
)paren
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|i
op_eq
op_minus
l_int|1
)paren
(brace
id|err
op_assign
id|zd1201_getconfig16
c_func
(paren
id|zd
comma
id|ZD1201_RID_CNFDEFAULTKEYID
comma
op_amp
id|i
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
)brace
r_if
c_cond
(paren
id|i
OL
l_int|0
op_logical_or
id|i
op_ge
id|ZD1201_NUMKEYS
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|erq-&gt;flags
op_or_assign
id|i
op_plus
l_int|1
suffix:semicolon
id|erq-&gt;length
op_assign
id|zd-&gt;encode_keylen
(braket
id|i
)braket
suffix:semicolon
id|memcpy
c_func
(paren
id|key
comma
id|zd-&gt;encode_keys
(braket
id|i
)braket
comma
id|erq-&gt;length
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|zd1201_set_power
r_static
r_int
id|zd1201_set_power
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|iw_request_info
op_star
id|info
comma
r_struct
id|iw_param
op_star
id|vwrq
comma
r_char
op_star
id|extra
)paren
(brace
r_struct
id|zd1201
op_star
id|zd
op_assign
(paren
r_struct
id|zd1201
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_int
id|enabled
comma
id|duration
comma
id|level
suffix:semicolon
r_int
id|err
suffix:semicolon
id|enabled
op_assign
id|vwrq-&gt;disabled
ques
c_cond
l_int|0
suffix:colon
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|enabled
)paren
(brace
r_if
c_cond
(paren
id|vwrq-&gt;flags
op_amp
id|IW_POWER_PERIOD
)paren
(brace
id|duration
op_assign
id|vwrq-&gt;value
suffix:semicolon
id|err
op_assign
id|zd1201_setconfig16
c_func
(paren
id|zd
comma
id|ZD1201_RID_CNFMAXSLEEPDURATION
comma
id|duration
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
r_if
c_cond
(paren
id|vwrq-&gt;flags
op_amp
id|IW_POWER_TIMEOUT
)paren
(brace
id|err
op_assign
id|zd1201_getconfig16
c_func
(paren
id|zd
comma
id|ZD1201_RID_CNFMAXSLEEPDURATION
comma
op_amp
id|duration
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
id|level
op_assign
id|vwrq-&gt;value
op_star
l_int|4
op_div
id|duration
suffix:semicolon
r_if
c_cond
(paren
id|level
OG
l_int|4
)paren
id|level
op_assign
l_int|4
suffix:semicolon
r_if
c_cond
(paren
id|level
OL
l_int|0
)paren
id|level
op_assign
l_int|0
suffix:semicolon
id|err
op_assign
id|zd1201_setconfig16
c_func
(paren
id|zd
comma
id|ZD1201_RID_CNFPMEPS
comma
id|level
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|out
suffix:colon
id|err
op_assign
id|zd1201_setconfig16
c_func
(paren
id|zd
comma
id|ZD1201_RID_CNFPMENABLED
comma
id|enabled
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|zd1201_get_power
r_static
r_int
id|zd1201_get_power
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|iw_request_info
op_star
id|info
comma
r_struct
id|iw_param
op_star
id|vwrq
comma
r_char
op_star
id|extra
)paren
(brace
r_struct
id|zd1201
op_star
id|zd
op_assign
(paren
r_struct
id|zd1201
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_int
id|enabled
comma
id|level
comma
id|duration
suffix:semicolon
r_int
id|err
suffix:semicolon
id|err
op_assign
id|zd1201_getconfig16
c_func
(paren
id|zd
comma
id|ZD1201_RID_CNFPMENABLED
comma
op_amp
id|enabled
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|zd1201_getconfig16
c_func
(paren
id|zd
comma
id|ZD1201_RID_CNFPMEPS
comma
op_amp
id|level
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
id|err
op_assign
id|zd1201_getconfig16
c_func
(paren
id|zd
comma
id|ZD1201_RID_CNFMAXSLEEPDURATION
comma
op_amp
id|duration
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
id|vwrq-&gt;disabled
op_assign
id|enabled
ques
c_cond
l_int|0
suffix:colon
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|vwrq-&gt;flags
op_amp
id|IW_POWER_TYPE
)paren
(brace
r_if
c_cond
(paren
id|vwrq-&gt;flags
op_amp
id|IW_POWER_PERIOD
)paren
(brace
id|vwrq-&gt;value
op_assign
id|duration
suffix:semicolon
id|vwrq-&gt;flags
op_assign
id|IW_POWER_PERIOD
suffix:semicolon
)brace
r_else
(brace
id|vwrq-&gt;value
op_assign
id|duration
op_star
id|level
op_div
l_int|4
suffix:semicolon
id|vwrq-&gt;flags
op_assign
id|IW_POWER_TIMEOUT
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|vwrq-&gt;flags
op_amp
id|IW_POWER_MODE
)paren
(brace
r_if
c_cond
(paren
id|enabled
op_logical_and
id|level
)paren
id|vwrq-&gt;flags
op_assign
id|IW_POWER_UNICAST_R
suffix:semicolon
r_else
id|vwrq-&gt;flags
op_assign
id|IW_POWER_ALL_R
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|zd1201_iw_handler
r_static
r_const
id|iw_handler
id|zd1201_iw_handler
(braket
)braket
op_assign
(brace
(paren
id|iw_handler
)paren
id|zd1201_config_commit
comma
multiline_comment|/* SIOCSIWCOMMIT */
(paren
id|iw_handler
)paren
id|zd1201_get_name
comma
multiline_comment|/* SIOCGIWNAME */
(paren
id|iw_handler
)paren
l_int|NULL
comma
multiline_comment|/* SIOCSIWNWID */
(paren
id|iw_handler
)paren
l_int|NULL
comma
multiline_comment|/* SIOCGIWNWID */
(paren
id|iw_handler
)paren
id|zd1201_set_freq
comma
multiline_comment|/* SIOCSIWFREQ */
(paren
id|iw_handler
)paren
id|zd1201_get_freq
comma
multiline_comment|/* SIOCGIWFREQ */
(paren
id|iw_handler
)paren
id|zd1201_set_mode
comma
multiline_comment|/* SIOCSIWMODE */
(paren
id|iw_handler
)paren
id|zd1201_get_mode
comma
multiline_comment|/* SIOCGIWMODE */
(paren
id|iw_handler
)paren
l_int|NULL
comma
multiline_comment|/* SIOCSIWSENS */
(paren
id|iw_handler
)paren
l_int|NULL
comma
multiline_comment|/* SIOCGIWSENS */
(paren
id|iw_handler
)paren
l_int|NULL
comma
multiline_comment|/* SIOCSIWRANGE */
(paren
id|iw_handler
)paren
id|zd1201_get_range
comma
multiline_comment|/* SIOCGIWRANGE */
(paren
id|iw_handler
)paren
l_int|NULL
comma
multiline_comment|/* SIOCSIWPRIV */
(paren
id|iw_handler
)paren
l_int|NULL
comma
multiline_comment|/* SIOCGIWPRIV */
(paren
id|iw_handler
)paren
l_int|NULL
comma
multiline_comment|/* SIOCSIWSTATS */
(paren
id|iw_handler
)paren
l_int|NULL
comma
multiline_comment|/* SIOCGIWSTATS */
(paren
id|iw_handler
)paren
l_int|NULL
comma
multiline_comment|/* SIOCSIWSPY */
(paren
id|iw_handler
)paren
l_int|NULL
comma
multiline_comment|/* SIOCGIWSPY */
(paren
id|iw_handler
)paren
l_int|NULL
comma
multiline_comment|/* -- hole -- */
(paren
id|iw_handler
)paren
l_int|NULL
comma
multiline_comment|/* -- hole -- */
(paren
id|iw_handler
)paren
l_int|NULL
multiline_comment|/*zd1201_set_wap*/
comma
multiline_comment|/* SIOCSIWAP */
(paren
id|iw_handler
)paren
id|zd1201_get_wap
comma
multiline_comment|/* SIOCGIWAP */
(paren
id|iw_handler
)paren
l_int|NULL
comma
multiline_comment|/* -- hole -- */
(paren
id|iw_handler
)paren
l_int|NULL
comma
multiline_comment|/* SIOCGIWAPLIST */
(paren
id|iw_handler
)paren
id|zd1201_set_scan
comma
multiline_comment|/* SIOCSIWSCAN */
(paren
id|iw_handler
)paren
id|zd1201_get_scan
comma
multiline_comment|/* SIOCGIWSCAN */
(paren
id|iw_handler
)paren
id|zd1201_set_essid
comma
multiline_comment|/* SIOCSIWESSID */
(paren
id|iw_handler
)paren
id|zd1201_get_essid
comma
multiline_comment|/* SIOCGIWESSID */
(paren
id|iw_handler
)paren
l_int|NULL
comma
multiline_comment|/* SIOCSIWNICKN */
(paren
id|iw_handler
)paren
id|zd1201_get_nick
comma
multiline_comment|/* SIOCGIWNICKN */
(paren
id|iw_handler
)paren
l_int|NULL
comma
multiline_comment|/* -- hole -- */
(paren
id|iw_handler
)paren
l_int|NULL
comma
multiline_comment|/* -- hole -- */
(paren
id|iw_handler
)paren
id|zd1201_set_rate
comma
multiline_comment|/* SIOCSIWRATE */
(paren
id|iw_handler
)paren
id|zd1201_get_rate
comma
multiline_comment|/* SIOCGIWRATE */
(paren
id|iw_handler
)paren
id|zd1201_set_rts
comma
multiline_comment|/* SIOCSIWRTS */
(paren
id|iw_handler
)paren
id|zd1201_get_rts
comma
multiline_comment|/* SIOCGIWRTS */
(paren
id|iw_handler
)paren
id|zd1201_set_frag
comma
multiline_comment|/* SIOCSIWFRAG */
(paren
id|iw_handler
)paren
id|zd1201_get_frag
comma
multiline_comment|/* SIOCGIWFRAG */
(paren
id|iw_handler
)paren
l_int|NULL
comma
multiline_comment|/* SIOCSIWTXPOW */
(paren
id|iw_handler
)paren
l_int|NULL
comma
multiline_comment|/* SIOCGIWTXPOW */
(paren
id|iw_handler
)paren
id|zd1201_set_retry
comma
multiline_comment|/* SIOCSIWRETRY */
(paren
id|iw_handler
)paren
id|zd1201_get_retry
comma
multiline_comment|/* SIOCGIWRETRY */
(paren
id|iw_handler
)paren
id|zd1201_set_encode
comma
multiline_comment|/* SIOCSIWENCODE */
(paren
id|iw_handler
)paren
id|zd1201_get_encode
comma
multiline_comment|/* SIOCGIWENCODE */
(paren
id|iw_handler
)paren
id|zd1201_set_power
comma
multiline_comment|/* SIOCSIWPOWER */
(paren
id|iw_handler
)paren
id|zd1201_get_power
comma
multiline_comment|/* SIOCGIWPOWER */
)brace
suffix:semicolon
DECL|function|zd1201_set_hostauth
r_static
r_int
id|zd1201_set_hostauth
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|iw_request_info
op_star
id|info
comma
r_struct
id|iw_param
op_star
id|rrq
comma
r_char
op_star
id|extra
)paren
(brace
r_struct
id|zd1201
op_star
id|zd
op_assign
(paren
r_struct
id|zd1201
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|zd-&gt;ap
)paren
r_return
op_minus
id|EOPNOTSUPP
suffix:semicolon
id|err
op_assign
id|zd1201_setconfig16
c_func
(paren
id|zd
comma
id|ZD1201_RID_CNFHOSTAUTH
comma
id|rrq-&gt;value
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|zd1201_get_hostauth
r_static
r_int
id|zd1201_get_hostauth
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|iw_request_info
op_star
id|info
comma
r_struct
id|iw_param
op_star
id|rrq
comma
r_char
op_star
id|extra
)paren
(brace
r_struct
id|zd1201
op_star
id|zd
op_assign
(paren
r_struct
id|zd1201
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_int
id|hostauth
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|zd-&gt;ap
)paren
r_return
op_minus
id|EOPNOTSUPP
suffix:semicolon
id|err
op_assign
id|zd1201_getconfig16
c_func
(paren
id|zd
comma
id|ZD1201_RID_CNFHOSTAUTH
comma
op_amp
id|hostauth
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
id|rrq-&gt;value
op_assign
id|hostauth
suffix:semicolon
id|rrq-&gt;fixed
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|zd1201_auth_sta
r_static
r_int
id|zd1201_auth_sta
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|iw_request_info
op_star
id|info
comma
r_struct
id|sockaddr
op_star
id|sta
comma
r_char
op_star
id|extra
)paren
(brace
r_struct
id|zd1201
op_star
id|zd
op_assign
(paren
r_struct
id|zd1201
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_int
r_char
id|buffer
(braket
l_int|10
)braket
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|zd-&gt;ap
)paren
r_return
op_minus
id|EOPNOTSUPP
suffix:semicolon
id|memcpy
c_func
(paren
id|buffer
comma
id|sta-&gt;sa_data
comma
id|ETH_ALEN
)paren
suffix:semicolon
op_star
(paren
r_int
op_star
)paren
(paren
id|buffer
op_plus
l_int|6
)paren
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* 0==success, 1==failure */
op_star
(paren
r_int
op_star
)paren
(paren
id|buffer
op_plus
l_int|8
)paren
op_assign
l_int|0
suffix:semicolon
r_return
id|zd1201_setconfig
c_func
(paren
id|zd
comma
id|ZD1201_RID_AUTHENTICATESTA
comma
id|buffer
comma
l_int|10
comma
l_int|1
)paren
suffix:semicolon
)brace
DECL|function|zd1201_set_maxassoc
r_static
r_int
id|zd1201_set_maxassoc
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|iw_request_info
op_star
id|info
comma
r_struct
id|iw_param
op_star
id|rrq
comma
r_char
op_star
id|extra
)paren
(brace
r_struct
id|zd1201
op_star
id|zd
op_assign
(paren
r_struct
id|zd1201
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|zd-&gt;ap
)paren
r_return
op_minus
id|EOPNOTSUPP
suffix:semicolon
id|err
op_assign
id|zd1201_setconfig16
c_func
(paren
id|zd
comma
id|ZD1201_RID_CNFMAXASSOCSTATIONS
comma
id|rrq-&gt;value
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|zd1201_get_maxassoc
r_static
r_int
id|zd1201_get_maxassoc
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|iw_request_info
op_star
id|info
comma
r_struct
id|iw_param
op_star
id|rrq
comma
r_char
op_star
id|extra
)paren
(brace
r_struct
id|zd1201
op_star
id|zd
op_assign
(paren
r_struct
id|zd1201
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_int
id|maxassoc
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|zd-&gt;ap
)paren
r_return
op_minus
id|EOPNOTSUPP
suffix:semicolon
id|err
op_assign
id|zd1201_getconfig16
c_func
(paren
id|zd
comma
id|ZD1201_RID_CNFMAXASSOCSTATIONS
comma
op_amp
id|maxassoc
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
id|rrq-&gt;value
op_assign
id|maxassoc
suffix:semicolon
id|rrq-&gt;fixed
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|zd1201_private_handler
r_static
r_const
id|iw_handler
id|zd1201_private_handler
(braket
)braket
op_assign
(brace
(paren
id|iw_handler
)paren
id|zd1201_set_hostauth
comma
multiline_comment|/* ZD1201SIWHOSTAUTH */
(paren
id|iw_handler
)paren
id|zd1201_get_hostauth
comma
multiline_comment|/* ZD1201GIWHOSTAUTH */
(paren
id|iw_handler
)paren
id|zd1201_auth_sta
comma
multiline_comment|/* ZD1201SIWAUTHSTA */
(paren
id|iw_handler
)paren
l_int|NULL
comma
multiline_comment|/* nothing to get */
(paren
id|iw_handler
)paren
id|zd1201_set_maxassoc
comma
multiline_comment|/* ZD1201SIMAXASSOC */
(paren
id|iw_handler
)paren
id|zd1201_get_maxassoc
comma
multiline_comment|/* ZD1201GIMAXASSOC */
)brace
suffix:semicolon
DECL|variable|zd1201_private_args
r_static
r_const
r_struct
id|iw_priv_args
id|zd1201_private_args
(braket
)braket
op_assign
(brace
(brace
id|ZD1201SIWHOSTAUTH
comma
id|IW_PRIV_TYPE_INT
op_or
id|IW_PRIV_SIZE_FIXED
op_or
l_int|1
comma
id|IW_PRIV_TYPE_NONE
comma
l_string|&quot;sethostauth&quot;
)brace
comma
(brace
id|ZD1201GIWHOSTAUTH
comma
id|IW_PRIV_TYPE_NONE
comma
id|IW_PRIV_TYPE_INT
op_or
id|IW_PRIV_SIZE_FIXED
op_or
l_int|1
comma
l_string|&quot;gethostauth&quot;
)brace
comma
(brace
id|ZD1201SIWAUTHSTA
comma
id|IW_PRIV_TYPE_ADDR
op_or
id|IW_PRIV_SIZE_FIXED
op_or
l_int|1
comma
id|IW_PRIV_TYPE_NONE
comma
l_string|&quot;authstation&quot;
)brace
comma
(brace
id|ZD1201SIWMAXASSOC
comma
id|IW_PRIV_TYPE_INT
op_or
id|IW_PRIV_SIZE_FIXED
op_or
l_int|1
comma
id|IW_PRIV_TYPE_NONE
comma
l_string|&quot;setmaxassoc&quot;
)brace
comma
(brace
id|ZD1201GIWMAXASSOC
comma
id|IW_PRIV_TYPE_NONE
comma
id|IW_PRIV_TYPE_INT
op_or
id|IW_PRIV_SIZE_FIXED
op_or
l_int|1
comma
l_string|&quot;getmaxassoc&quot;
)brace
comma
)brace
suffix:semicolon
DECL|variable|zd1201_iw_handlers
r_static
r_const
r_struct
id|iw_handler_def
id|zd1201_iw_handlers
op_assign
(brace
dot
id|num_standard
op_assign
r_sizeof
(paren
id|zd1201_iw_handler
)paren
op_div
r_sizeof
(paren
id|iw_handler
)paren
comma
dot
id|num_private
op_assign
r_sizeof
(paren
id|zd1201_private_handler
)paren
op_div
r_sizeof
(paren
id|iw_handler
)paren
comma
dot
id|num_private_args
op_assign
r_sizeof
(paren
id|zd1201_private_args
)paren
op_div
r_sizeof
(paren
r_struct
id|iw_priv_args
)paren
comma
dot
id|standard
op_assign
(paren
id|iw_handler
op_star
)paren
id|zd1201_iw_handler
comma
dot
r_private
op_assign
(paren
id|iw_handler
op_star
)paren
id|zd1201_private_handler
comma
dot
id|private_args
op_assign
(paren
r_struct
id|iw_priv_args
op_star
)paren
id|zd1201_private_args
comma
)brace
suffix:semicolon
DECL|function|zd1201_probe
r_int
id|zd1201_probe
c_func
(paren
r_struct
id|usb_interface
op_star
id|interface
comma
r_const
r_struct
id|usb_device_id
op_star
id|id
)paren
(brace
r_struct
id|zd1201
op_star
id|zd
suffix:semicolon
r_struct
id|usb_device
op_star
id|usb
suffix:semicolon
r_int
id|i
comma
id|err
suffix:semicolon
r_int
id|porttype
suffix:semicolon
r_char
id|buf
(braket
id|IW_ESSID_MAX_SIZE
op_plus
l_int|2
)braket
suffix:semicolon
id|usb
op_assign
id|interface_to_usbdev
c_func
(paren
id|interface
)paren
suffix:semicolon
id|zd
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|zd1201
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|zd
)paren
(brace
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|memset
c_func
(paren
id|zd
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|zd1201
)paren
)paren
suffix:semicolon
id|zd-&gt;ap
op_assign
id|ap
suffix:semicolon
id|zd-&gt;usb
op_assign
id|usb
suffix:semicolon
id|zd-&gt;removed
op_assign
l_int|0
suffix:semicolon
id|init_waitqueue_head
c_func
(paren
op_amp
id|zd-&gt;rxdataq
)paren
suffix:semicolon
id|INIT_HLIST_HEAD
c_func
(paren
op_amp
id|zd-&gt;fraglist
)paren
suffix:semicolon
id|err
op_assign
id|zd1201_fw_upload
c_func
(paren
id|usb
comma
id|zd-&gt;ap
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
(brace
id|dev_err
c_func
(paren
op_amp
id|usb-&gt;dev
comma
l_string|&quot;zd1201 firmware upload failed: %d&bslash;n&quot;
comma
id|err
)paren
suffix:semicolon
r_goto
id|err_zd
suffix:semicolon
)brace
id|zd-&gt;endp_in
op_assign
l_int|1
suffix:semicolon
id|zd-&gt;endp_out
op_assign
l_int|1
suffix:semicolon
id|zd-&gt;endp_out2
op_assign
l_int|2
suffix:semicolon
id|zd-&gt;rx_urb
op_assign
id|usb_alloc_urb
c_func
(paren
l_int|0
comma
id|GFP_KERNEL
)paren
suffix:semicolon
id|zd-&gt;tx_urb
op_assign
id|usb_alloc_urb
c_func
(paren
l_int|0
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|zd-&gt;rx_urb
op_logical_or
op_logical_neg
id|zd-&gt;tx_urb
)paren
r_goto
id|err_zd
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|100
suffix:semicolon
id|i
op_increment
)paren
(brace
id|udelay
c_func
(paren
l_int|1000
)paren
suffix:semicolon
)brace
id|err
op_assign
id|zd1201_drvr_start
c_func
(paren
id|zd
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_goto
id|err_zd
suffix:semicolon
id|err
op_assign
id|zd1201_setconfig16
c_func
(paren
id|zd
comma
id|ZD1201_RID_CNFMAXDATALEN
comma
l_int|2312
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_goto
id|err_start
suffix:semicolon
id|err
op_assign
id|zd1201_setconfig16
c_func
(paren
id|zd
comma
id|ZD1201_RID_TXRATECNTL
comma
id|ZD1201_RATEB1
op_or
id|ZD1201_RATEB2
op_or
id|ZD1201_RATEB5
op_or
id|ZD1201_RATEB11
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_goto
id|err_start
suffix:semicolon
id|zd-&gt;dev
op_assign
id|alloc_etherdev
c_func
(paren
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|zd-&gt;dev
)paren
r_goto
id|err_start
suffix:semicolon
id|zd-&gt;dev-&gt;priv
op_assign
id|zd
suffix:semicolon
id|zd-&gt;dev-&gt;open
op_assign
id|zd1201_net_open
suffix:semicolon
id|zd-&gt;dev-&gt;stop
op_assign
id|zd1201_net_stop
suffix:semicolon
id|zd-&gt;dev-&gt;get_stats
op_assign
id|zd1201_get_stats
suffix:semicolon
id|zd-&gt;dev-&gt;get_wireless_stats
op_assign
id|zd1201_get_wireless_stats
suffix:semicolon
id|zd-&gt;dev-&gt;wireless_handlers
op_assign
(paren
r_struct
id|iw_handler_def
op_star
)paren
op_amp
id|zd1201_iw_handlers
suffix:semicolon
id|zd-&gt;dev-&gt;hard_start_xmit
op_assign
id|zd1201_hard_start_xmit
suffix:semicolon
id|zd-&gt;dev-&gt;watchdog_timeo
op_assign
id|ZD1201_TX_TIMEOUT
suffix:semicolon
id|zd-&gt;dev-&gt;tx_timeout
op_assign
id|zd1201_tx_timeout
suffix:semicolon
id|zd-&gt;dev-&gt;set_multicast_list
op_assign
id|zd1201_set_multicast
suffix:semicolon
id|zd-&gt;dev-&gt;set_mac_address
op_assign
id|zd1201_set_mac_address
suffix:semicolon
id|strcpy
c_func
(paren
id|zd-&gt;dev-&gt;name
comma
l_string|&quot;wlan%d&quot;
)paren
suffix:semicolon
id|err
op_assign
id|zd1201_getconfig
c_func
(paren
id|zd
comma
id|ZD1201_RID_CNFOWNMACADDR
comma
id|zd-&gt;dev-&gt;dev_addr
comma
id|zd-&gt;dev-&gt;addr_len
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_goto
id|err_net
suffix:semicolon
multiline_comment|/* Set wildcard essid to match zd-&gt;essid */
op_star
(paren
id|__le16
op_star
)paren
id|buf
op_assign
id|cpu_to_le16
c_func
(paren
l_int|0
)paren
suffix:semicolon
id|err
op_assign
id|zd1201_setconfig
c_func
(paren
id|zd
comma
id|ZD1201_RID_CNFDESIREDSSID
comma
id|buf
comma
id|IW_ESSID_MAX_SIZE
op_plus
l_int|2
comma
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_goto
id|err_net
suffix:semicolon
r_if
c_cond
(paren
id|zd-&gt;ap
)paren
id|porttype
op_assign
id|ZD1201_PORTTYPE_AP
suffix:semicolon
r_else
id|porttype
op_assign
id|ZD1201_PORTTYPE_BSS
suffix:semicolon
id|err
op_assign
id|zd1201_setconfig16
c_func
(paren
id|zd
comma
id|ZD1201_RID_CNFPORTTYPE
comma
id|porttype
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_goto
id|err_net
suffix:semicolon
id|err
op_assign
id|register_netdev
c_func
(paren
id|zd-&gt;dev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_goto
id|err_net
suffix:semicolon
id|dev_info
c_func
(paren
op_amp
id|usb-&gt;dev
comma
l_string|&quot;%s: ZD1201 USB Wireless interface&bslash;n&quot;
comma
id|zd-&gt;dev-&gt;name
)paren
suffix:semicolon
id|usb_set_intfdata
c_func
(paren
id|interface
comma
id|zd
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
id|err_net
suffix:colon
id|free_netdev
c_func
(paren
id|zd-&gt;dev
)paren
suffix:semicolon
id|err_start
suffix:colon
multiline_comment|/* Leave the device in reset state */
id|zd1201_docmd
c_func
(paren
id|zd
comma
id|ZD1201_CMDCODE_INIT
comma
l_int|0
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
id|err_zd
suffix:colon
r_if
c_cond
(paren
id|zd-&gt;tx_urb
)paren
id|usb_free_urb
c_func
(paren
id|zd-&gt;tx_urb
)paren
suffix:semicolon
r_if
c_cond
(paren
id|zd-&gt;rx_urb
)paren
id|usb_free_urb
c_func
(paren
id|zd-&gt;rx_urb
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|zd
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|function|zd1201_disconnect
r_void
id|zd1201_disconnect
c_func
(paren
r_struct
id|usb_interface
op_star
id|interface
)paren
(brace
r_struct
id|zd1201
op_star
id|zd
op_assign
(paren
r_struct
id|zd1201
op_star
)paren
id|usb_get_intfdata
c_func
(paren
id|interface
)paren
suffix:semicolon
r_struct
id|hlist_node
op_star
id|node
comma
op_star
id|node2
suffix:semicolon
r_struct
id|zd1201_frag
op_star
id|frag
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|zd
)paren
r_return
suffix:semicolon
id|usb_set_intfdata
c_func
(paren
id|interface
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|zd-&gt;dev
)paren
(brace
id|unregister_netdev
c_func
(paren
id|zd-&gt;dev
)paren
suffix:semicolon
id|free_netdev
c_func
(paren
id|zd-&gt;dev
)paren
suffix:semicolon
)brace
id|hlist_for_each_entry_safe
c_func
(paren
id|frag
comma
id|node
comma
id|node2
comma
op_amp
id|zd-&gt;fraglist
comma
id|fnode
)paren
(brace
id|hlist_del_init
c_func
(paren
op_amp
id|frag-&gt;fnode
)paren
suffix:semicolon
id|kfree_skb
c_func
(paren
id|frag-&gt;skb
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|frag
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|zd-&gt;tx_urb
)paren
(brace
id|usb_kill_urb
c_func
(paren
id|zd-&gt;tx_urb
)paren
suffix:semicolon
id|usb_free_urb
c_func
(paren
id|zd-&gt;tx_urb
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|zd-&gt;rx_urb
)paren
(brace
id|usb_kill_urb
c_func
(paren
id|zd-&gt;rx_urb
)paren
suffix:semicolon
id|usb_free_urb
c_func
(paren
id|zd-&gt;rx_urb
)paren
suffix:semicolon
)brace
id|kfree
c_func
(paren
id|zd
)paren
suffix:semicolon
)brace
DECL|variable|zd1201_usb
r_struct
id|usb_driver
id|zd1201_usb
op_assign
(brace
dot
id|owner
op_assign
id|THIS_MODULE
comma
dot
id|name
op_assign
l_string|&quot;zd1201&quot;
comma
dot
id|probe
op_assign
id|zd1201_probe
comma
dot
id|disconnect
op_assign
id|zd1201_disconnect
comma
dot
id|id_table
op_assign
id|zd1201_table
comma
)brace
suffix:semicolon
DECL|function|zd1201_init
r_static
r_int
id|__init
id|zd1201_init
c_func
(paren
r_void
)paren
(brace
r_return
id|usb_register
c_func
(paren
op_amp
id|zd1201_usb
)paren
suffix:semicolon
)brace
DECL|function|zd1201_cleanup
r_static
r_void
id|__exit
id|zd1201_cleanup
c_func
(paren
r_void
)paren
(brace
id|usb_deregister
c_func
(paren
op_amp
id|zd1201_usb
)paren
suffix:semicolon
)brace
DECL|variable|zd1201_init
id|module_init
c_func
(paren
id|zd1201_init
)paren
suffix:semicolon
DECL|variable|zd1201_cleanup
id|module_exit
c_func
(paren
id|zd1201_cleanup
)paren
suffix:semicolon
eof
