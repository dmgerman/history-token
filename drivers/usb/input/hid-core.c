multiline_comment|/*&n; *  USB HID support for Linux&n; *&n; *  Copyright (c) 1999 Andreas Gal&n; *  Copyright (c) 2000-2001 Vojtech Pavlik &lt;vojtech@suse.cz&gt;&n; */
multiline_comment|/*&n; * This program is free software; you can redistribute it and/or modify it&n; * under the terms of the GNU General Public License as published by the Free&n; * Software Foundation; either version 2 of the License, or (at your option)&n; * any later version.&n; */
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/list.h&gt;
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;linux/smp_lock.h&gt;
macro_line|#include &lt;linux/spinlock.h&gt;
macro_line|#include &lt;asm/unaligned.h&gt;
macro_line|#include &lt;asm/byteorder.h&gt;
macro_line|#include &lt;linux/input.h&gt;
DECL|macro|DEBUG
macro_line|#undef DEBUG
DECL|macro|DEBUG_DATA
macro_line|#undef DEBUG_DATA
macro_line|#include &lt;linux/usb.h&gt;
macro_line|#include &quot;hid.h&quot;
macro_line|#include &lt;linux/hiddev.h&gt;
multiline_comment|/*&n; * Version Information&n; */
DECL|macro|DRIVER_VERSION
mdefine_line|#define DRIVER_VERSION &quot;v2.0&quot;
DECL|macro|DRIVER_AUTHOR
mdefine_line|#define DRIVER_AUTHOR &quot;Andreas Gal, Vojtech Pavlik&quot;
DECL|macro|DRIVER_DESC
mdefine_line|#define DRIVER_DESC &quot;USB HID core driver&quot;
DECL|macro|DRIVER_LICENSE
mdefine_line|#define DRIVER_LICENSE &quot;GPL&quot;
DECL|variable|hid_types
r_static
r_char
op_star
id|hid_types
(braket
)braket
op_assign
(brace
l_string|&quot;Device&quot;
comma
l_string|&quot;Pointer&quot;
comma
l_string|&quot;Mouse&quot;
comma
l_string|&quot;Device&quot;
comma
l_string|&quot;Joystick&quot;
comma
l_string|&quot;Gamepad&quot;
comma
l_string|&quot;Keyboard&quot;
comma
l_string|&quot;Keypad&quot;
comma
l_string|&quot;Multi-Axis Controller&quot;
)brace
suffix:semicolon
multiline_comment|/*&n; * Register a new report for a device.&n; */
DECL|function|hid_register_report
r_static
r_struct
id|hid_report
op_star
id|hid_register_report
c_func
(paren
r_struct
id|hid_device
op_star
id|device
comma
r_int
id|type
comma
r_int
id|id
)paren
(brace
r_struct
id|hid_report_enum
op_star
id|report_enum
op_assign
id|device-&gt;report_enum
op_plus
id|type
suffix:semicolon
r_struct
id|hid_report
op_star
id|report
suffix:semicolon
r_if
c_cond
(paren
id|report_enum-&gt;report_id_hash
(braket
id|id
)braket
)paren
r_return
id|report_enum-&gt;report_id_hash
(braket
id|id
)braket
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|report
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|hid_report
)paren
comma
id|GFP_KERNEL
)paren
)paren
)paren
r_return
l_int|NULL
suffix:semicolon
id|memset
c_func
(paren
id|report
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|hid_report
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|id
op_ne
l_int|0
)paren
id|report_enum-&gt;numbered
op_assign
l_int|1
suffix:semicolon
id|report-&gt;id
op_assign
id|id
suffix:semicolon
id|report-&gt;type
op_assign
id|type
suffix:semicolon
id|report-&gt;size
op_assign
l_int|0
suffix:semicolon
id|report-&gt;device
op_assign
id|device
suffix:semicolon
id|report_enum-&gt;report_id_hash
(braket
id|id
)braket
op_assign
id|report
suffix:semicolon
id|list_add_tail
c_func
(paren
op_amp
id|report-&gt;list
comma
op_amp
id|report_enum-&gt;report_list
)paren
suffix:semicolon
r_return
id|report
suffix:semicolon
)brace
multiline_comment|/*&n; * Register a new field for this report.&n; */
DECL|function|hid_register_field
r_static
r_struct
id|hid_field
op_star
id|hid_register_field
c_func
(paren
r_struct
id|hid_report
op_star
id|report
comma
r_int
id|usages
comma
r_int
id|values
)paren
(brace
r_struct
id|hid_field
op_star
id|field
suffix:semicolon
r_if
c_cond
(paren
id|report-&gt;maxfield
op_eq
id|HID_MAX_FIELDS
)paren
(brace
id|dbg
c_func
(paren
l_string|&quot;too many fields in report&quot;
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|field
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|hid_field
)paren
op_plus
id|usages
op_star
r_sizeof
(paren
r_struct
id|hid_usage
)paren
op_plus
id|values
op_star
r_sizeof
(paren
r_int
)paren
comma
id|GFP_KERNEL
)paren
)paren
)paren
r_return
l_int|NULL
suffix:semicolon
id|memset
c_func
(paren
id|field
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|hid_field
)paren
op_plus
id|usages
op_star
r_sizeof
(paren
r_struct
id|hid_usage
)paren
op_plus
id|values
op_star
r_sizeof
(paren
r_int
)paren
)paren
suffix:semicolon
id|report-&gt;field
(braket
id|report-&gt;maxfield
op_increment
)braket
op_assign
id|field
suffix:semicolon
id|field-&gt;usage
op_assign
(paren
r_struct
id|hid_usage
op_star
)paren
(paren
id|field
op_plus
l_int|1
)paren
suffix:semicolon
id|field-&gt;value
op_assign
(paren
r_int
op_star
)paren
(paren
id|field-&gt;usage
op_plus
id|usages
)paren
suffix:semicolon
id|field-&gt;report
op_assign
id|report
suffix:semicolon
r_return
id|field
suffix:semicolon
)brace
multiline_comment|/*&n; * Open a collection. The type/usage is pushed on the stack.&n; */
DECL|function|open_collection
r_static
r_int
id|open_collection
c_func
(paren
r_struct
id|hid_parser
op_star
id|parser
comma
r_int
id|type
)paren
(brace
r_struct
id|hid_collection
op_star
id|collection
suffix:semicolon
r_int
id|usage
suffix:semicolon
id|usage
op_assign
id|parser-&gt;local.usage
(braket
l_int|0
)braket
suffix:semicolon
r_if
c_cond
(paren
id|parser-&gt;collection_stack_ptr
op_eq
id|HID_COLLECTION_STACK_SIZE
)paren
(brace
id|dbg
c_func
(paren
l_string|&quot;collection stack overflow&quot;
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|parser-&gt;device-&gt;maxcollection
op_eq
id|parser-&gt;device-&gt;collection_size
)paren
(brace
id|collection
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|hid_collection
)paren
op_star
id|parser-&gt;device-&gt;collection_size
op_star
l_int|2
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|collection
op_eq
l_int|NULL
)paren
(brace
id|dbg
c_func
(paren
l_string|&quot;failed to reallocate collection array&quot;
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|collection
comma
id|parser-&gt;device-&gt;collection
comma
r_sizeof
(paren
r_struct
id|hid_collection
)paren
op_star
id|parser-&gt;device-&gt;collection_size
)paren
suffix:semicolon
id|memset
c_func
(paren
id|collection
op_plus
id|parser-&gt;device-&gt;collection_size
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|hid_collection
)paren
op_star
id|parser-&gt;device-&gt;collection_size
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|parser-&gt;device-&gt;collection
)paren
suffix:semicolon
id|parser-&gt;device-&gt;collection
op_assign
id|collection
suffix:semicolon
id|parser-&gt;device-&gt;collection_size
op_mul_assign
l_int|2
suffix:semicolon
)brace
id|parser-&gt;collection_stack
(braket
id|parser-&gt;collection_stack_ptr
op_increment
)braket
op_assign
id|parser-&gt;device-&gt;maxcollection
suffix:semicolon
id|collection
op_assign
id|parser-&gt;device-&gt;collection
op_plus
id|parser-&gt;device-&gt;maxcollection
op_increment
suffix:semicolon
id|collection-&gt;type
op_assign
id|type
suffix:semicolon
id|collection-&gt;usage
op_assign
id|usage
suffix:semicolon
id|collection-&gt;level
op_assign
id|parser-&gt;collection_stack_ptr
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|type
op_eq
id|HID_COLLECTION_APPLICATION
)paren
id|parser-&gt;device-&gt;maxapplication
op_increment
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * Close a collection.&n; */
DECL|function|close_collection
r_static
r_int
id|close_collection
c_func
(paren
r_struct
id|hid_parser
op_star
id|parser
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|parser-&gt;collection_stack_ptr
)paren
(brace
id|dbg
c_func
(paren
l_string|&quot;collection stack underflow&quot;
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
id|parser-&gt;collection_stack_ptr
op_decrement
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * Climb up the stack, search for the specified collection type&n; * and return the usage.&n; */
DECL|function|hid_lookup_collection
r_static
r_int
id|hid_lookup_collection
c_func
(paren
r_struct
id|hid_parser
op_star
id|parser
comma
r_int
id|type
)paren
(brace
r_int
id|n
suffix:semicolon
r_for
c_loop
(paren
id|n
op_assign
id|parser-&gt;collection_stack_ptr
op_minus
l_int|1
suffix:semicolon
id|n
op_ge
l_int|0
suffix:semicolon
id|n
op_decrement
)paren
r_if
c_cond
(paren
id|parser-&gt;device-&gt;collection
(braket
id|parser-&gt;collection_stack
(braket
id|n
)braket
)braket
dot
id|type
op_eq
id|type
)paren
r_return
id|parser-&gt;device-&gt;collection
(braket
id|parser-&gt;collection_stack
(braket
id|n
)braket
)braket
dot
id|usage
suffix:semicolon
r_return
l_int|0
suffix:semicolon
multiline_comment|/* we know nothing about this usage type */
)brace
multiline_comment|/*&n; * Add a usage to the temporary parser table.&n; */
DECL|function|hid_add_usage
r_static
r_int
id|hid_add_usage
c_func
(paren
r_struct
id|hid_parser
op_star
id|parser
comma
r_int
id|usage
)paren
(brace
r_if
c_cond
(paren
id|parser-&gt;local.usage_index
op_ge
id|HID_MAX_USAGES
)paren
(brace
id|dbg
c_func
(paren
l_string|&quot;usage index exceeded&quot;
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
id|parser-&gt;local.usage
(braket
id|parser-&gt;local.usage_index
)braket
op_assign
id|usage
suffix:semicolon
id|parser-&gt;local.collection_index
(braket
id|parser-&gt;local.usage_index
)braket
op_assign
id|parser-&gt;collection_stack_ptr
ques
c_cond
id|parser-&gt;collection_stack
(braket
id|parser-&gt;collection_stack_ptr
op_minus
l_int|1
)braket
suffix:colon
l_int|0
suffix:semicolon
id|parser-&gt;local.usage_index
op_increment
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * Register a new field for this report.&n; */
DECL|function|hid_add_field
r_static
r_int
id|hid_add_field
c_func
(paren
r_struct
id|hid_parser
op_star
id|parser
comma
r_int
id|report_type
comma
r_int
id|flags
)paren
(brace
r_struct
id|hid_report
op_star
id|report
suffix:semicolon
r_struct
id|hid_field
op_star
id|field
suffix:semicolon
r_int
id|usages
suffix:semicolon
r_int
id|offset
suffix:semicolon
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|report
op_assign
id|hid_register_report
c_func
(paren
id|parser-&gt;device
comma
id|report_type
comma
id|parser-&gt;global.report_id
)paren
)paren
)paren
(brace
id|dbg
c_func
(paren
l_string|&quot;hid_register_report failed&quot;
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|parser-&gt;global.logical_maximum
op_le
id|parser-&gt;global.logical_minimum
)paren
(brace
id|dbg
c_func
(paren
l_string|&quot;logical range invalid %d %d&quot;
comma
id|parser-&gt;global.logical_minimum
comma
id|parser-&gt;global.logical_maximum
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
id|usages
op_assign
id|parser-&gt;local.usage_index
suffix:semicolon
id|offset
op_assign
id|report-&gt;size
suffix:semicolon
id|report-&gt;size
op_add_assign
id|parser-&gt;global.report_size
op_star
id|parser-&gt;global.report_count
suffix:semicolon
r_if
c_cond
(paren
id|usages
op_eq
l_int|0
)paren
r_return
l_int|0
suffix:semicolon
multiline_comment|/* ignore padding fields */
r_if
c_cond
(paren
(paren
id|field
op_assign
id|hid_register_field
c_func
(paren
id|report
comma
id|usages
comma
id|parser-&gt;global.report_count
)paren
)paren
op_eq
l_int|NULL
)paren
r_return
l_int|0
suffix:semicolon
id|field-&gt;physical
op_assign
id|hid_lookup_collection
c_func
(paren
id|parser
comma
id|HID_COLLECTION_PHYSICAL
)paren
suffix:semicolon
id|field-&gt;logical
op_assign
id|hid_lookup_collection
c_func
(paren
id|parser
comma
id|HID_COLLECTION_LOGICAL
)paren
suffix:semicolon
id|field-&gt;application
op_assign
id|hid_lookup_collection
c_func
(paren
id|parser
comma
id|HID_COLLECTION_APPLICATION
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|usages
suffix:semicolon
id|i
op_increment
)paren
(brace
id|field-&gt;usage
(braket
id|i
)braket
dot
id|hid
op_assign
id|parser-&gt;local.usage
(braket
id|i
)braket
suffix:semicolon
id|field-&gt;usage
(braket
id|i
)braket
dot
id|collection_index
op_assign
id|parser-&gt;local.collection_index
(braket
id|i
)braket
suffix:semicolon
)brace
id|field-&gt;maxusage
op_assign
id|usages
suffix:semicolon
id|field-&gt;flags
op_assign
id|flags
suffix:semicolon
id|field-&gt;report_offset
op_assign
id|offset
suffix:semicolon
id|field-&gt;report_type
op_assign
id|report_type
suffix:semicolon
id|field-&gt;report_size
op_assign
id|parser-&gt;global.report_size
suffix:semicolon
id|field-&gt;report_count
op_assign
id|parser-&gt;global.report_count
suffix:semicolon
id|field-&gt;logical_minimum
op_assign
id|parser-&gt;global.logical_minimum
suffix:semicolon
id|field-&gt;logical_maximum
op_assign
id|parser-&gt;global.logical_maximum
suffix:semicolon
id|field-&gt;physical_minimum
op_assign
id|parser-&gt;global.physical_minimum
suffix:semicolon
id|field-&gt;physical_maximum
op_assign
id|parser-&gt;global.physical_maximum
suffix:semicolon
id|field-&gt;unit_exponent
op_assign
id|parser-&gt;global.unit_exponent
suffix:semicolon
id|field-&gt;unit
op_assign
id|parser-&gt;global.unit
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * Read data value from item.&n; */
DECL|function|item_udata
r_static
id|__inline__
id|__u32
id|item_udata
c_func
(paren
r_struct
id|hid_item
op_star
id|item
)paren
(brace
r_switch
c_cond
(paren
id|item-&gt;size
)paren
(brace
r_case
l_int|1
suffix:colon
r_return
id|item-&gt;data.u8
suffix:semicolon
r_case
l_int|2
suffix:colon
r_return
id|item-&gt;data.u16
suffix:semicolon
r_case
l_int|4
suffix:colon
r_return
id|item-&gt;data.u32
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|item_sdata
r_static
id|__inline__
id|__s32
id|item_sdata
c_func
(paren
r_struct
id|hid_item
op_star
id|item
)paren
(brace
r_switch
c_cond
(paren
id|item-&gt;size
)paren
(brace
r_case
l_int|1
suffix:colon
r_return
id|item-&gt;data.s8
suffix:semicolon
r_case
l_int|2
suffix:colon
r_return
id|item-&gt;data.s16
suffix:semicolon
r_case
l_int|4
suffix:colon
r_return
id|item-&gt;data.s32
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * Process a global item.&n; */
DECL|function|hid_parser_global
r_static
r_int
id|hid_parser_global
c_func
(paren
r_struct
id|hid_parser
op_star
id|parser
comma
r_struct
id|hid_item
op_star
id|item
)paren
(brace
r_switch
c_cond
(paren
id|item-&gt;tag
)paren
(brace
r_case
id|HID_GLOBAL_ITEM_TAG_PUSH
suffix:colon
r_if
c_cond
(paren
id|parser-&gt;global_stack_ptr
op_eq
id|HID_GLOBAL_STACK_SIZE
)paren
(brace
id|dbg
c_func
(paren
l_string|&quot;global enviroment stack overflow&quot;
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|parser-&gt;global_stack
op_plus
id|parser-&gt;global_stack_ptr
op_increment
comma
op_amp
id|parser-&gt;global
comma
r_sizeof
(paren
r_struct
id|hid_global
)paren
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_case
id|HID_GLOBAL_ITEM_TAG_POP
suffix:colon
r_if
c_cond
(paren
op_logical_neg
id|parser-&gt;global_stack_ptr
)paren
(brace
id|dbg
c_func
(paren
l_string|&quot;global enviroment stack underflow&quot;
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
id|memcpy
c_func
(paren
op_amp
id|parser-&gt;global
comma
id|parser-&gt;global_stack
op_plus
op_decrement
id|parser-&gt;global_stack_ptr
comma
r_sizeof
(paren
r_struct
id|hid_global
)paren
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_case
id|HID_GLOBAL_ITEM_TAG_USAGE_PAGE
suffix:colon
id|parser-&gt;global.usage_page
op_assign
id|item_udata
c_func
(paren
id|item
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_case
id|HID_GLOBAL_ITEM_TAG_LOGICAL_MINIMUM
suffix:colon
id|parser-&gt;global.logical_minimum
op_assign
id|item_sdata
c_func
(paren
id|item
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_case
id|HID_GLOBAL_ITEM_TAG_LOGICAL_MAXIMUM
suffix:colon
r_if
c_cond
(paren
id|parser-&gt;global.logical_minimum
OL
l_int|0
)paren
id|parser-&gt;global.logical_maximum
op_assign
id|item_sdata
c_func
(paren
id|item
)paren
suffix:semicolon
r_else
id|parser-&gt;global.logical_maximum
op_assign
id|item_udata
c_func
(paren
id|item
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_case
id|HID_GLOBAL_ITEM_TAG_PHYSICAL_MINIMUM
suffix:colon
id|parser-&gt;global.physical_minimum
op_assign
id|item_sdata
c_func
(paren
id|item
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_case
id|HID_GLOBAL_ITEM_TAG_PHYSICAL_MAXIMUM
suffix:colon
r_if
c_cond
(paren
id|parser-&gt;global.physical_minimum
OL
l_int|0
)paren
id|parser-&gt;global.physical_maximum
op_assign
id|item_sdata
c_func
(paren
id|item
)paren
suffix:semicolon
r_else
id|parser-&gt;global.physical_maximum
op_assign
id|item_udata
c_func
(paren
id|item
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_case
id|HID_GLOBAL_ITEM_TAG_UNIT_EXPONENT
suffix:colon
id|parser-&gt;global.unit_exponent
op_assign
id|item_sdata
c_func
(paren
id|item
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_case
id|HID_GLOBAL_ITEM_TAG_UNIT
suffix:colon
id|parser-&gt;global.unit
op_assign
id|item_udata
c_func
(paren
id|item
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_case
id|HID_GLOBAL_ITEM_TAG_REPORT_SIZE
suffix:colon
r_if
c_cond
(paren
(paren
id|parser-&gt;global.report_size
op_assign
id|item_udata
c_func
(paren
id|item
)paren
)paren
OG
l_int|32
)paren
(brace
id|dbg
c_func
(paren
l_string|&quot;invalid report_size %d&quot;
comma
id|parser-&gt;global.report_size
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
r_case
id|HID_GLOBAL_ITEM_TAG_REPORT_COUNT
suffix:colon
r_if
c_cond
(paren
(paren
id|parser-&gt;global.report_count
op_assign
id|item_udata
c_func
(paren
id|item
)paren
)paren
OG
id|HID_MAX_USAGES
)paren
(brace
id|dbg
c_func
(paren
l_string|&quot;invalid report_count %d&quot;
comma
id|parser-&gt;global.report_count
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
r_case
id|HID_GLOBAL_ITEM_TAG_REPORT_ID
suffix:colon
r_if
c_cond
(paren
(paren
id|parser-&gt;global.report_id
op_assign
id|item_udata
c_func
(paren
id|item
)paren
)paren
op_eq
l_int|0
)paren
(brace
id|dbg
c_func
(paren
l_string|&quot;report_id 0 is invalid&quot;
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
r_default
suffix:colon
id|dbg
c_func
(paren
l_string|&quot;unknown global tag 0x%x&quot;
comma
id|item-&gt;tag
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
)brace
multiline_comment|/*&n; * Process a local item.&n; */
DECL|function|hid_parser_local
r_static
r_int
id|hid_parser_local
c_func
(paren
r_struct
id|hid_parser
op_star
id|parser
comma
r_struct
id|hid_item
op_star
id|item
)paren
(brace
id|__u32
id|data
suffix:semicolon
r_int
id|n
suffix:semicolon
r_if
c_cond
(paren
id|item-&gt;size
op_eq
l_int|0
)paren
(brace
id|dbg
c_func
(paren
l_string|&quot;item data expected for local item&quot;
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
id|data
op_assign
id|item_udata
c_func
(paren
id|item
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|item-&gt;tag
)paren
(brace
r_case
id|HID_LOCAL_ITEM_TAG_DELIMITER
suffix:colon
r_if
c_cond
(paren
id|data
)paren
(brace
multiline_comment|/*&n;&t;&t;&t;&t; * We treat items before the first delimiter&n;&t;&t;&t;&t; * as global to all usage sets (branch 0).&n;&t;&t;&t;&t; * In the moment we process only these global&n;&t;&t;&t;&t; * items and the first delimiter set.&n;&t;&t;&t;&t; */
r_if
c_cond
(paren
id|parser-&gt;local.delimiter_depth
op_ne
l_int|0
)paren
(brace
id|dbg
c_func
(paren
l_string|&quot;nested delimiters&quot;
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
id|parser-&gt;local.delimiter_depth
op_increment
suffix:semicolon
id|parser-&gt;local.delimiter_branch
op_increment
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|parser-&gt;local.delimiter_depth
OL
l_int|1
)paren
(brace
id|dbg
c_func
(paren
l_string|&quot;bogus close delimiter&quot;
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
id|parser-&gt;local.delimiter_depth
op_decrement
suffix:semicolon
)brace
r_return
l_int|1
suffix:semicolon
r_case
id|HID_LOCAL_ITEM_TAG_USAGE
suffix:colon
r_if
c_cond
(paren
id|parser-&gt;local.delimiter_branch
OG
l_int|1
)paren
(brace
id|dbg
c_func
(paren
l_string|&quot;alternative usage ignored&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|item-&gt;size
op_le
l_int|2
)paren
id|data
op_assign
(paren
id|parser-&gt;global.usage_page
op_lshift
l_int|16
)paren
op_plus
id|data
suffix:semicolon
r_return
id|hid_add_usage
c_func
(paren
id|parser
comma
id|data
)paren
suffix:semicolon
r_case
id|HID_LOCAL_ITEM_TAG_USAGE_MINIMUM
suffix:colon
r_if
c_cond
(paren
id|parser-&gt;local.delimiter_branch
OG
l_int|1
)paren
(brace
id|dbg
c_func
(paren
l_string|&quot;alternative usage ignored&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|item-&gt;size
op_le
l_int|2
)paren
id|data
op_assign
(paren
id|parser-&gt;global.usage_page
op_lshift
l_int|16
)paren
op_plus
id|data
suffix:semicolon
id|parser-&gt;local.usage_minimum
op_assign
id|data
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_case
id|HID_LOCAL_ITEM_TAG_USAGE_MAXIMUM
suffix:colon
r_if
c_cond
(paren
id|parser-&gt;local.delimiter_branch
OG
l_int|1
)paren
(brace
id|dbg
c_func
(paren
l_string|&quot;alternative usage ignored&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|item-&gt;size
op_le
l_int|2
)paren
id|data
op_assign
(paren
id|parser-&gt;global.usage_page
op_lshift
l_int|16
)paren
op_plus
id|data
suffix:semicolon
r_for
c_loop
(paren
id|n
op_assign
id|parser-&gt;local.usage_minimum
suffix:semicolon
id|n
op_le
id|data
suffix:semicolon
id|n
op_increment
)paren
r_if
c_cond
(paren
id|hid_add_usage
c_func
(paren
id|parser
comma
id|n
)paren
)paren
(brace
id|dbg
c_func
(paren
l_string|&quot;hid_add_usage failed&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
r_default
suffix:colon
id|dbg
c_func
(paren
l_string|&quot;unknown local item tag 0x%x&quot;
comma
id|item-&gt;tag
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * Process a main item.&n; */
DECL|function|hid_parser_main
r_static
r_int
id|hid_parser_main
c_func
(paren
r_struct
id|hid_parser
op_star
id|parser
comma
r_struct
id|hid_item
op_star
id|item
)paren
(brace
id|__u32
id|data
suffix:semicolon
r_int
id|ret
suffix:semicolon
id|data
op_assign
id|item_udata
c_func
(paren
id|item
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|item-&gt;tag
)paren
(brace
r_case
id|HID_MAIN_ITEM_TAG_BEGIN_COLLECTION
suffix:colon
id|ret
op_assign
id|open_collection
c_func
(paren
id|parser
comma
id|data
op_amp
l_int|0xff
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HID_MAIN_ITEM_TAG_END_COLLECTION
suffix:colon
id|ret
op_assign
id|close_collection
c_func
(paren
id|parser
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HID_MAIN_ITEM_TAG_INPUT
suffix:colon
id|ret
op_assign
id|hid_add_field
c_func
(paren
id|parser
comma
id|HID_INPUT_REPORT
comma
id|data
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HID_MAIN_ITEM_TAG_OUTPUT
suffix:colon
id|ret
op_assign
id|hid_add_field
c_func
(paren
id|parser
comma
id|HID_OUTPUT_REPORT
comma
id|data
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HID_MAIN_ITEM_TAG_FEATURE
suffix:colon
id|ret
op_assign
id|hid_add_field
c_func
(paren
id|parser
comma
id|HID_FEATURE_REPORT
comma
id|data
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|dbg
c_func
(paren
l_string|&quot;unknown main item tag 0x%x&quot;
comma
id|item-&gt;tag
)paren
suffix:semicolon
id|ret
op_assign
l_int|0
suffix:semicolon
)brace
id|memset
c_func
(paren
op_amp
id|parser-&gt;local
comma
l_int|0
comma
r_sizeof
(paren
id|parser-&gt;local
)paren
)paren
suffix:semicolon
multiline_comment|/* Reset the local parser environment */
r_return
id|ret
suffix:semicolon
)brace
multiline_comment|/*&n; * Process a reserved item.&n; */
DECL|function|hid_parser_reserved
r_static
r_int
id|hid_parser_reserved
c_func
(paren
r_struct
id|hid_parser
op_star
id|parser
comma
r_struct
id|hid_item
op_star
id|item
)paren
(brace
id|dbg
c_func
(paren
l_string|&quot;reserved item type, tag 0x%x&quot;
comma
id|item-&gt;tag
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * Free a report and all registered fields. The field-&gt;usage and&n; * field-&gt;value table&squot;s are allocated behind the field, so we need&n; * only to free(field) itself.&n; */
DECL|function|hid_free_report
r_static
r_void
id|hid_free_report
c_func
(paren
r_struct
id|hid_report
op_star
id|report
)paren
(brace
r_int
id|n
suffix:semicolon
r_for
c_loop
(paren
id|n
op_assign
l_int|0
suffix:semicolon
id|n
OL
id|report-&gt;maxfield
suffix:semicolon
id|n
op_increment
)paren
id|kfree
c_func
(paren
id|report-&gt;field
(braket
id|n
)braket
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|report
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Free a device structure, all reports, and all fields.&n; */
DECL|function|hid_free_device
r_static
r_void
id|hid_free_device
c_func
(paren
r_struct
id|hid_device
op_star
id|device
)paren
(brace
r_int
id|i
comma
id|j
suffix:semicolon
id|hid_ff_exit
c_func
(paren
id|device
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|HID_REPORT_TYPES
suffix:semicolon
id|i
op_increment
)paren
(brace
r_struct
id|hid_report_enum
op_star
id|report_enum
op_assign
id|device-&gt;report_enum
op_plus
id|i
suffix:semicolon
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
l_int|256
suffix:semicolon
id|j
op_increment
)paren
(brace
r_struct
id|hid_report
op_star
id|report
op_assign
id|report_enum-&gt;report_id_hash
(braket
id|j
)braket
suffix:semicolon
r_if
c_cond
(paren
id|report
)paren
id|hid_free_report
c_func
(paren
id|report
)paren
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|device-&gt;rdesc
)paren
id|kfree
c_func
(paren
id|device-&gt;rdesc
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|device
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Fetch a report description item from the data stream. We support long&n; * items, though they are not used yet.&n; */
DECL|function|fetch_item
r_static
id|u8
op_star
id|fetch_item
c_func
(paren
id|__u8
op_star
id|start
comma
id|__u8
op_star
id|end
comma
r_struct
id|hid_item
op_star
id|item
)paren
(brace
id|u8
id|b
suffix:semicolon
r_if
c_cond
(paren
(paren
id|end
op_minus
id|start
)paren
op_le
l_int|0
)paren
r_return
l_int|NULL
suffix:semicolon
id|b
op_assign
op_star
id|start
op_increment
suffix:semicolon
id|item-&gt;type
op_assign
(paren
id|b
op_rshift
l_int|2
)paren
op_amp
l_int|3
suffix:semicolon
id|item-&gt;tag
op_assign
(paren
id|b
op_rshift
l_int|4
)paren
op_amp
l_int|15
suffix:semicolon
r_if
c_cond
(paren
id|item-&gt;tag
op_eq
id|HID_ITEM_TAG_LONG
)paren
(brace
id|item-&gt;format
op_assign
id|HID_ITEM_FORMAT_LONG
suffix:semicolon
r_if
c_cond
(paren
(paren
id|end
op_minus
id|start
)paren
OL
l_int|2
)paren
r_return
l_int|NULL
suffix:semicolon
id|item-&gt;size
op_assign
op_star
id|start
op_increment
suffix:semicolon
id|item-&gt;tag
op_assign
op_star
id|start
op_increment
suffix:semicolon
r_if
c_cond
(paren
(paren
id|end
op_minus
id|start
)paren
OL
id|item-&gt;size
)paren
r_return
l_int|NULL
suffix:semicolon
id|item-&gt;data.longdata
op_assign
id|start
suffix:semicolon
id|start
op_add_assign
id|item-&gt;size
suffix:semicolon
r_return
id|start
suffix:semicolon
)brace
id|item-&gt;format
op_assign
id|HID_ITEM_FORMAT_SHORT
suffix:semicolon
id|item-&gt;size
op_assign
id|b
op_amp
l_int|3
suffix:semicolon
r_switch
c_cond
(paren
id|item-&gt;size
)paren
(brace
r_case
l_int|0
suffix:colon
r_return
id|start
suffix:semicolon
r_case
l_int|1
suffix:colon
r_if
c_cond
(paren
(paren
id|end
op_minus
id|start
)paren
OL
l_int|1
)paren
r_return
l_int|NULL
suffix:semicolon
id|item-&gt;data.u8
op_assign
op_star
id|start
op_increment
suffix:semicolon
r_return
id|start
suffix:semicolon
r_case
l_int|2
suffix:colon
r_if
c_cond
(paren
(paren
id|end
op_minus
id|start
)paren
OL
l_int|2
)paren
r_return
l_int|NULL
suffix:semicolon
id|item-&gt;data.u16
op_assign
id|le16_to_cpu
c_func
(paren
id|get_unaligned
c_func
(paren
(paren
(paren
id|__u16
op_star
)paren
id|start
)paren
op_increment
)paren
)paren
suffix:semicolon
r_return
id|start
suffix:semicolon
r_case
l_int|3
suffix:colon
id|item-&gt;size
op_increment
suffix:semicolon
r_if
c_cond
(paren
(paren
id|end
op_minus
id|start
)paren
OL
l_int|4
)paren
r_return
l_int|NULL
suffix:semicolon
id|item-&gt;data.u32
op_assign
id|le32_to_cpu
c_func
(paren
id|get_unaligned
c_func
(paren
(paren
(paren
id|__u32
op_star
)paren
id|start
)paren
op_increment
)paren
)paren
suffix:semicolon
r_return
id|start
suffix:semicolon
)brace
r_return
l_int|NULL
suffix:semicolon
)brace
multiline_comment|/*&n; * Parse a report description into a hid_device structure. Reports are&n; * enumerated, fields are attached to these reports.&n; */
DECL|function|hid_parse_report
r_static
r_struct
id|hid_device
op_star
id|hid_parse_report
c_func
(paren
id|__u8
op_star
id|start
comma
r_int
id|size
)paren
(brace
r_struct
id|hid_device
op_star
id|device
suffix:semicolon
r_struct
id|hid_parser
op_star
id|parser
suffix:semicolon
r_struct
id|hid_item
id|item
suffix:semicolon
id|__u8
op_star
id|end
suffix:semicolon
r_int
id|i
suffix:semicolon
r_static
r_int
(paren
op_star
id|dispatch_type
(braket
)braket
)paren
(paren
r_struct
id|hid_parser
op_star
id|parser
comma
r_struct
id|hid_item
op_star
id|item
)paren
op_assign
(brace
id|hid_parser_main
comma
id|hid_parser_global
comma
id|hid_parser_local
comma
id|hid_parser_reserved
)brace
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|device
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|hid_device
)paren
comma
id|GFP_KERNEL
)paren
)paren
)paren
r_return
l_int|NULL
suffix:semicolon
id|memset
c_func
(paren
id|device
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|hid_device
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|device-&gt;collection
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|hid_collection
)paren
op_star
id|HID_DEFAULT_NUM_COLLECTIONS
comma
id|GFP_KERNEL
)paren
)paren
)paren
(brace
id|kfree
c_func
(paren
id|device
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
id|memset
c_func
(paren
id|device-&gt;collection
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|hid_collection
)paren
op_star
id|HID_DEFAULT_NUM_COLLECTIONS
)paren
suffix:semicolon
id|device-&gt;collection_size
op_assign
id|HID_DEFAULT_NUM_COLLECTIONS
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|HID_REPORT_TYPES
suffix:semicolon
id|i
op_increment
)paren
id|INIT_LIST_HEAD
c_func
(paren
op_amp
id|device-&gt;report_enum
(braket
id|i
)braket
dot
id|report_list
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|device-&gt;rdesc
op_assign
(paren
id|__u8
op_star
)paren
id|kmalloc
c_func
(paren
id|size
comma
id|GFP_KERNEL
)paren
)paren
)paren
(brace
id|kfree
c_func
(paren
id|device-&gt;collection
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|device
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|device-&gt;rdesc
comma
id|start
comma
id|size
)paren
suffix:semicolon
id|device-&gt;rsize
op_assign
id|size
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|parser
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|hid_parser
)paren
comma
id|GFP_KERNEL
)paren
)paren
)paren
(brace
id|kfree
c_func
(paren
id|device-&gt;rdesc
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|device-&gt;collection
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|device
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
id|memset
c_func
(paren
id|parser
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|hid_parser
)paren
)paren
suffix:semicolon
id|parser-&gt;device
op_assign
id|device
suffix:semicolon
id|end
op_assign
id|start
op_plus
id|size
suffix:semicolon
r_while
c_loop
(paren
(paren
id|start
op_assign
id|fetch_item
c_func
(paren
id|start
comma
id|end
comma
op_amp
id|item
)paren
)paren
op_ne
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|item.format
op_ne
id|HID_ITEM_FORMAT_SHORT
)paren
(brace
id|dbg
c_func
(paren
l_string|&quot;unexpected long global item&quot;
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|device-&gt;rdesc
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|device-&gt;collection
)paren
suffix:semicolon
id|hid_free_device
c_func
(paren
id|device
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|parser
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|dispatch_type
(braket
id|item.type
)braket
(paren
id|parser
comma
op_amp
id|item
)paren
)paren
(brace
id|dbg
c_func
(paren
l_string|&quot;item %u %u %u %u parsing failed&bslash;n&quot;
comma
id|item.format
comma
(paren
r_int
)paren
id|item.size
comma
(paren
r_int
)paren
id|item.type
comma
(paren
r_int
)paren
id|item.tag
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|device-&gt;rdesc
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|device-&gt;collection
)paren
suffix:semicolon
id|hid_free_device
c_func
(paren
id|device
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|parser
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|start
op_eq
id|end
)paren
(brace
r_if
c_cond
(paren
id|parser-&gt;collection_stack_ptr
)paren
(brace
id|dbg
c_func
(paren
l_string|&quot;unbalanced collection at end of report description&quot;
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|device-&gt;rdesc
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|device-&gt;collection
)paren
suffix:semicolon
id|hid_free_device
c_func
(paren
id|device
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|parser
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|parser-&gt;local.delimiter_depth
)paren
(brace
id|dbg
c_func
(paren
l_string|&quot;unbalanced delimiter at end of report description&quot;
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|device-&gt;rdesc
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|device-&gt;collection
)paren
suffix:semicolon
id|hid_free_device
c_func
(paren
id|device
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|parser
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
id|kfree
c_func
(paren
id|parser
)paren
suffix:semicolon
r_return
id|device
suffix:semicolon
)brace
)brace
id|dbg
c_func
(paren
l_string|&quot;item fetching failed at offset %d&bslash;n&quot;
comma
(paren
r_int
)paren
(paren
id|end
op_minus
id|start
)paren
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|device-&gt;rdesc
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|device-&gt;collection
)paren
suffix:semicolon
id|hid_free_device
c_func
(paren
id|device
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|parser
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
multiline_comment|/*&n; * Convert a signed n-bit integer to signed 32-bit integer. Common&n; * cases are done through the compiler, the screwed things has to be&n; * done by hand.&n; */
DECL|function|snto32
r_static
id|__inline__
id|__s32
id|snto32
c_func
(paren
id|__u32
id|value
comma
r_int
id|n
)paren
(brace
r_switch
c_cond
(paren
id|n
)paren
(brace
r_case
l_int|8
suffix:colon
r_return
(paren
(paren
id|__s8
)paren
id|value
)paren
suffix:semicolon
r_case
l_int|16
suffix:colon
r_return
(paren
(paren
id|__s16
)paren
id|value
)paren
suffix:semicolon
r_case
l_int|32
suffix:colon
r_return
(paren
(paren
id|__s32
)paren
id|value
)paren
suffix:semicolon
)brace
r_return
id|value
op_amp
(paren
l_int|1
op_lshift
(paren
id|n
op_minus
l_int|1
)paren
)paren
ques
c_cond
id|value
op_or
(paren
op_minus
l_int|1
op_lshift
id|n
)paren
suffix:colon
id|value
suffix:semicolon
)brace
multiline_comment|/*&n; * Convert a signed 32-bit integer to a signed n-bit integer.&n; */
DECL|function|s32ton
r_static
id|__inline__
id|__u32
id|s32ton
c_func
(paren
id|__s32
id|value
comma
r_int
id|n
)paren
(brace
id|__s32
id|a
op_assign
id|value
op_rshift
(paren
id|n
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|a
op_logical_and
id|a
op_ne
op_minus
l_int|1
)paren
r_return
id|value
OL
l_int|0
ques
c_cond
l_int|1
op_lshift
(paren
id|n
op_minus
l_int|1
)paren
suffix:colon
(paren
l_int|1
op_lshift
(paren
id|n
op_minus
l_int|1
)paren
)paren
op_minus
l_int|1
suffix:semicolon
r_return
id|value
op_amp
(paren
(paren
l_int|1
op_lshift
id|n
)paren
op_minus
l_int|1
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Extract/implement a data field from/to a report.&n; */
DECL|function|extract
r_static
id|__inline__
id|__u32
id|extract
c_func
(paren
id|__u8
op_star
id|report
comma
r_int
id|offset
comma
r_int
id|n
)paren
(brace
id|report
op_add_assign
(paren
id|offset
op_rshift
l_int|5
)paren
op_lshift
l_int|2
suffix:semicolon
id|offset
op_and_assign
l_int|31
suffix:semicolon
r_return
(paren
id|le64_to_cpu
c_func
(paren
id|get_unaligned
c_func
(paren
(paren
id|__u64
op_star
)paren
id|report
)paren
)paren
op_rshift
id|offset
)paren
op_amp
(paren
(paren
l_int|1
op_lshift
id|n
)paren
op_minus
l_int|1
)paren
suffix:semicolon
)brace
DECL|function|implement
r_static
id|__inline__
r_void
id|implement
c_func
(paren
id|__u8
op_star
id|report
comma
r_int
id|offset
comma
r_int
id|n
comma
id|__u32
id|value
)paren
(brace
id|report
op_add_assign
(paren
id|offset
op_rshift
l_int|5
)paren
op_lshift
l_int|2
suffix:semicolon
id|offset
op_and_assign
l_int|31
suffix:semicolon
id|put_unaligned
c_func
(paren
(paren
id|get_unaligned
c_func
(paren
(paren
id|__u64
op_star
)paren
id|report
)paren
op_amp
id|cpu_to_le64
c_func
(paren
op_complement
(paren
(paren
(paren
(paren
id|__u64
)paren
l_int|1
op_lshift
id|n
)paren
op_minus
l_int|1
)paren
op_lshift
id|offset
)paren
)paren
)paren
op_or
id|cpu_to_le64
c_func
(paren
(paren
id|__u64
)paren
id|value
op_lshift
id|offset
)paren
comma
(paren
id|__u64
op_star
)paren
id|report
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Search an array for a value.&n; */
DECL|function|search
r_static
id|__inline__
r_int
id|search
c_func
(paren
id|__s32
op_star
id|array
comma
id|__s32
id|value
comma
r_int
id|n
)paren
(brace
r_while
c_loop
(paren
id|n
op_decrement
)paren
r_if
c_cond
(paren
op_star
id|array
op_increment
op_eq
id|value
)paren
r_return
l_int|0
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
DECL|function|hid_process_event
r_static
r_void
id|hid_process_event
c_func
(paren
r_struct
id|hid_device
op_star
id|hid
comma
r_struct
id|hid_field
op_star
id|field
comma
r_struct
id|hid_usage
op_star
id|usage
comma
id|__s32
id|value
)paren
(brace
id|hid_dump_input
c_func
(paren
id|usage
comma
id|value
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hid-&gt;claimed
op_amp
id|HID_CLAIMED_INPUT
)paren
id|hidinput_hid_event
c_func
(paren
id|hid
comma
id|field
comma
id|usage
comma
id|value
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hid-&gt;claimed
op_amp
id|HID_CLAIMED_HIDDEV
)paren
id|hiddev_hid_event
c_func
(paren
id|hid
comma
id|field
comma
id|usage
comma
id|value
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Analyse a received field, and fetch the data from it. The field&n; * content is stored for next report processing (we do differential&n; * reporting to the layer).&n; */
DECL|function|hid_input_field
r_static
r_void
id|hid_input_field
c_func
(paren
r_struct
id|hid_device
op_star
id|hid
comma
r_struct
id|hid_field
op_star
id|field
comma
id|__u8
op_star
id|data
)paren
(brace
r_int
id|n
suffix:semicolon
r_int
id|count
op_assign
id|field-&gt;report_count
suffix:semicolon
r_int
id|offset
op_assign
id|field-&gt;report_offset
suffix:semicolon
r_int
id|size
op_assign
id|field-&gt;report_size
suffix:semicolon
id|__s32
id|min
op_assign
id|field-&gt;logical_minimum
suffix:semicolon
id|__s32
id|max
op_assign
id|field-&gt;logical_maximum
suffix:semicolon
id|__s32
id|value
(braket
id|count
)braket
suffix:semicolon
multiline_comment|/* WARNING: gcc specific */
r_for
c_loop
(paren
id|n
op_assign
l_int|0
suffix:semicolon
id|n
OL
id|count
suffix:semicolon
id|n
op_increment
)paren
(brace
id|value
(braket
id|n
)braket
op_assign
id|min
OL
l_int|0
ques
c_cond
id|snto32
c_func
(paren
id|extract
c_func
(paren
id|data
comma
id|offset
op_plus
id|n
op_star
id|size
comma
id|size
)paren
comma
id|size
)paren
suffix:colon
id|extract
c_func
(paren
id|data
comma
id|offset
op_plus
id|n
op_star
id|size
comma
id|size
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|field-&gt;flags
op_amp
id|HID_MAIN_ITEM_VARIABLE
)paren
multiline_comment|/* Ignore report if ErrorRollOver */
op_logical_and
id|value
(braket
id|n
)braket
op_ge
id|min
op_logical_and
id|value
(braket
id|n
)braket
op_le
id|max
op_logical_and
id|field-&gt;usage
(braket
id|value
(braket
id|n
)braket
op_minus
id|min
)braket
dot
id|hid
op_eq
id|HID_UP_KEYBOARD
op_plus
l_int|1
)paren
r_return
suffix:semicolon
)brace
r_for
c_loop
(paren
id|n
op_assign
l_int|0
suffix:semicolon
id|n
OL
id|count
suffix:semicolon
id|n
op_increment
)paren
(brace
r_if
c_cond
(paren
id|HID_MAIN_ITEM_VARIABLE
op_amp
id|field-&gt;flags
)paren
(brace
r_if
c_cond
(paren
id|field-&gt;flags
op_amp
id|HID_MAIN_ITEM_RELATIVE
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|value
(braket
id|n
)braket
)paren
r_continue
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|value
(braket
id|n
)braket
op_eq
id|field-&gt;value
(braket
id|n
)braket
)paren
r_continue
suffix:semicolon
)brace
id|hid_process_event
c_func
(paren
id|hid
comma
id|field
comma
op_amp
id|field-&gt;usage
(braket
id|n
)braket
comma
id|value
(braket
id|n
)braket
)paren
suffix:semicolon
r_continue
suffix:semicolon
)brace
r_if
c_cond
(paren
id|field-&gt;value
(braket
id|n
)braket
op_ge
id|min
op_logical_and
id|field-&gt;value
(braket
id|n
)braket
op_le
id|max
op_logical_and
id|field-&gt;usage
(braket
id|field-&gt;value
(braket
id|n
)braket
op_minus
id|min
)braket
dot
id|hid
op_logical_and
id|search
c_func
(paren
id|value
comma
id|field-&gt;value
(braket
id|n
)braket
comma
id|count
)paren
)paren
id|hid_process_event
c_func
(paren
id|hid
comma
id|field
comma
op_amp
id|field-&gt;usage
(braket
id|field-&gt;value
(braket
id|n
)braket
op_minus
id|min
)braket
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|value
(braket
id|n
)braket
op_ge
id|min
op_logical_and
id|value
(braket
id|n
)braket
op_le
id|max
op_logical_and
id|field-&gt;usage
(braket
id|value
(braket
id|n
)braket
op_minus
id|min
)braket
dot
id|hid
op_logical_and
id|search
c_func
(paren
id|field-&gt;value
comma
id|value
(braket
id|n
)braket
comma
id|count
)paren
)paren
id|hid_process_event
c_func
(paren
id|hid
comma
id|field
comma
op_amp
id|field-&gt;usage
(braket
id|value
(braket
id|n
)braket
op_minus
id|min
)braket
comma
l_int|1
)paren
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|field-&gt;value
comma
id|value
comma
id|count
op_star
r_sizeof
(paren
id|__s32
)paren
)paren
suffix:semicolon
)brace
DECL|function|hid_input_report
r_static
r_int
id|hid_input_report
c_func
(paren
r_int
id|type
comma
r_struct
id|urb
op_star
id|urb
)paren
(brace
r_struct
id|hid_device
op_star
id|hid
op_assign
id|urb-&gt;context
suffix:semicolon
r_struct
id|hid_report_enum
op_star
id|report_enum
op_assign
id|hid-&gt;report_enum
op_plus
id|type
suffix:semicolon
id|u8
op_star
id|data
op_assign
id|urb-&gt;transfer_buffer
suffix:semicolon
r_int
id|len
op_assign
id|urb-&gt;actual_length
suffix:semicolon
r_struct
id|hid_report
op_star
id|report
suffix:semicolon
r_int
id|n
comma
id|size
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|len
)paren
(brace
id|dbg
c_func
(paren
l_string|&quot;empty report&quot;
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
macro_line|#ifdef DEBUG_DATA
id|printk
c_func
(paren
id|KERN_DEBUG
id|__FILE__
l_string|&quot;: report (size %u) (%snumbered)&bslash;n&quot;
comma
id|len
comma
id|report_enum-&gt;numbered
ques
c_cond
l_string|&quot;&quot;
suffix:colon
l_string|&quot;un&quot;
)paren
suffix:semicolon
macro_line|#endif
id|n
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* Normally report number is 0 */
r_if
c_cond
(paren
id|report_enum-&gt;numbered
)paren
(brace
multiline_comment|/* Device uses numbered reports, data[0] is report number */
id|n
op_assign
op_star
id|data
op_increment
suffix:semicolon
id|len
op_decrement
suffix:semicolon
)brace
macro_line|#ifdef DEBUG_DATA
(brace
r_int
id|i
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
id|__FILE__
l_string|&quot;: report %d (size %u) = &quot;
comma
id|n
comma
id|len
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|len
suffix:semicolon
id|i
op_increment
)paren
id|printk
c_func
(paren
l_string|&quot; %02x&quot;
comma
id|data
(braket
id|i
)braket
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
)brace
macro_line|#endif
r_if
c_cond
(paren
op_logical_neg
(paren
id|report
op_assign
id|report_enum-&gt;report_id_hash
(braket
id|n
)braket
)paren
)paren
(brace
id|dbg
c_func
(paren
l_string|&quot;undefined report_id %d received&quot;
comma
id|n
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
id|size
op_assign
(paren
(paren
id|report-&gt;size
op_minus
l_int|1
)paren
op_rshift
l_int|3
)paren
op_plus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|len
OL
id|size
)paren
(brace
id|dbg
c_func
(paren
l_string|&quot;report %d is too short, (%d &lt; %d)&quot;
comma
id|report-&gt;id
comma
id|len
comma
id|size
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|hid-&gt;claimed
op_amp
id|HID_CLAIMED_HIDDEV
)paren
id|hiddev_report_event
c_func
(paren
id|hid
comma
id|report
)paren
suffix:semicolon
r_for
c_loop
(paren
id|n
op_assign
l_int|0
suffix:semicolon
id|n
OL
id|report-&gt;maxfield
suffix:semicolon
id|n
op_increment
)paren
id|hid_input_field
c_func
(paren
id|hid
comma
id|report-&gt;field
(braket
id|n
)braket
comma
id|data
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hid-&gt;claimed
op_amp
id|HID_CLAIMED_INPUT
)paren
id|hidinput_report_event
c_func
(paren
id|hid
comma
id|report
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * Input interrupt completion handler.&n; */
DECL|function|hid_irq_in
r_static
r_void
id|hid_irq_in
c_func
(paren
r_struct
id|urb
op_star
id|urb
)paren
(brace
r_if
c_cond
(paren
id|urb-&gt;status
)paren
(brace
id|dbg
c_func
(paren
l_string|&quot;nonzero status in input irq %d&quot;
comma
id|urb-&gt;status
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|hid_input_report
c_func
(paren
id|HID_INPUT_REPORT
comma
id|urb
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Output the field into the report.&n; */
DECL|function|hid_output_field
r_static
r_void
id|hid_output_field
c_func
(paren
r_struct
id|hid_field
op_star
id|field
comma
id|__u8
op_star
id|data
)paren
(brace
r_int
id|count
op_assign
id|field-&gt;report_count
suffix:semicolon
r_int
id|offset
op_assign
id|field-&gt;report_offset
suffix:semicolon
r_int
id|size
op_assign
id|field-&gt;report_size
suffix:semicolon
r_int
id|n
suffix:semicolon
r_for
c_loop
(paren
id|n
op_assign
l_int|0
suffix:semicolon
id|n
OL
id|count
suffix:semicolon
id|n
op_increment
)paren
(brace
r_if
c_cond
(paren
id|field-&gt;logical_minimum
OL
l_int|0
)paren
multiline_comment|/* signed values */
id|implement
c_func
(paren
id|data
comma
id|offset
op_plus
id|n
op_star
id|size
comma
id|size
comma
id|s32ton
c_func
(paren
id|field-&gt;value
(braket
id|n
)braket
comma
id|size
)paren
)paren
suffix:semicolon
r_else
multiline_comment|/* unsigned values */
id|implement
c_func
(paren
id|data
comma
id|offset
op_plus
id|n
op_star
id|size
comma
id|size
comma
id|field-&gt;value
(braket
id|n
)braket
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/*&n; * Create a report.&n; */
DECL|function|hid_output_report
r_void
id|hid_output_report
c_func
(paren
r_struct
id|hid_report
op_star
id|report
comma
id|__u8
op_star
id|data
)paren
(brace
r_int
id|n
suffix:semicolon
r_for
c_loop
(paren
id|n
op_assign
l_int|0
suffix:semicolon
id|n
OL
id|report-&gt;maxfield
suffix:semicolon
id|n
op_increment
)paren
id|hid_output_field
c_func
(paren
id|report-&gt;field
(braket
id|n
)braket
comma
id|data
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Set a field value. The report this field belongs to has to be&n; * created and transfered to the device, to set this value in the&n; * device.&n; */
DECL|function|hid_set_field
r_int
id|hid_set_field
c_func
(paren
r_struct
id|hid_field
op_star
id|field
comma
r_int
id|offset
comma
id|__s32
id|value
)paren
(brace
r_int
id|size
op_assign
id|field-&gt;report_size
suffix:semicolon
id|hid_dump_input
c_func
(paren
id|field-&gt;usage
op_plus
id|offset
comma
id|value
)paren
suffix:semicolon
r_if
c_cond
(paren
id|offset
op_ge
id|field-&gt;report_count
)paren
(brace
id|dbg
c_func
(paren
l_string|&quot;offset (%d) exceeds report_count (%d)&quot;
comma
id|offset
comma
id|field-&gt;report_count
)paren
suffix:semicolon
id|hid_dump_field
c_func
(paren
id|field
comma
l_int|8
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|field-&gt;logical_minimum
OL
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|value
op_ne
id|snto32
c_func
(paren
id|s32ton
c_func
(paren
id|value
comma
id|size
)paren
comma
id|size
)paren
)paren
(brace
id|dbg
c_func
(paren
l_string|&quot;value %d is out of range&quot;
comma
id|value
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
)brace
id|field-&gt;value
(braket
id|offset
)braket
op_assign
id|value
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|hid_find_field
r_int
id|hid_find_field
c_func
(paren
r_struct
id|hid_device
op_star
id|hid
comma
r_int
r_int
id|type
comma
r_int
r_int
id|code
comma
r_struct
id|hid_field
op_star
op_star
id|field
)paren
(brace
r_struct
id|hid_report_enum
op_star
id|report_enum
op_assign
id|hid-&gt;report_enum
op_plus
id|HID_OUTPUT_REPORT
suffix:semicolon
r_struct
id|list_head
op_star
id|list
op_assign
id|report_enum-&gt;report_list.next
suffix:semicolon
r_int
id|i
comma
id|j
suffix:semicolon
r_while
c_loop
(paren
id|list
op_ne
op_amp
id|report_enum-&gt;report_list
)paren
(brace
r_struct
id|hid_report
op_star
id|report
op_assign
(paren
r_struct
id|hid_report
op_star
)paren
id|list
suffix:semicolon
id|list
op_assign
id|list-&gt;next
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|report-&gt;maxfield
suffix:semicolon
id|i
op_increment
)paren
(brace
op_star
id|field
op_assign
id|report-&gt;field
(braket
id|i
)braket
suffix:semicolon
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
(paren
op_star
id|field
)paren
op_member_access_from_pointer
id|maxusage
suffix:semicolon
id|j
op_increment
)paren
r_if
c_cond
(paren
(paren
op_star
id|field
)paren
op_member_access_from_pointer
id|usage
(braket
id|j
)braket
dot
id|type
op_eq
id|type
op_logical_and
(paren
op_star
id|field
)paren
op_member_access_from_pointer
id|usage
(braket
id|j
)braket
dot
id|code
op_eq
id|code
)paren
r_return
id|j
suffix:semicolon
)brace
)brace
r_return
op_minus
l_int|1
suffix:semicolon
)brace
multiline_comment|/*&n; * Find a report with a specified HID usage.&n; */
DECL|function|hid_find_report_by_usage
r_int
id|hid_find_report_by_usage
c_func
(paren
r_struct
id|hid_device
op_star
id|hid
comma
id|__u32
id|wanted_usage
comma
r_struct
id|hid_report
op_star
op_star
id|report
comma
r_int
id|type
)paren
(brace
r_struct
id|hid_report_enum
op_star
id|report_enum
op_assign
id|hid-&gt;report_enum
op_plus
id|type
suffix:semicolon
r_struct
id|list_head
op_star
id|list
op_assign
id|report_enum-&gt;report_list.next
suffix:semicolon
r_int
id|i
comma
id|j
suffix:semicolon
r_while
c_loop
(paren
id|list
op_ne
op_amp
id|report_enum-&gt;report_list
)paren
(brace
op_star
id|report
op_assign
(paren
r_struct
id|hid_report
op_star
)paren
id|list
suffix:semicolon
id|list
op_assign
id|list-&gt;next
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
(paren
op_star
id|report
)paren
op_member_access_from_pointer
id|maxfield
suffix:semicolon
id|i
op_increment
)paren
(brace
r_struct
id|hid_field
op_star
id|field
op_assign
(paren
op_star
id|report
)paren
op_member_access_from_pointer
id|field
(braket
id|i
)braket
suffix:semicolon
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
id|field-&gt;maxusage
suffix:semicolon
id|j
op_increment
)paren
r_if
c_cond
(paren
id|field-&gt;logical
op_eq
id|wanted_usage
)paren
r_return
id|j
suffix:semicolon
)brace
)brace
r_return
op_minus
l_int|1
suffix:semicolon
)brace
DECL|function|hid_find_field_in_report
r_int
id|hid_find_field_in_report
c_func
(paren
r_struct
id|hid_report
op_star
id|report
comma
id|__u32
id|wanted_usage
comma
r_struct
id|hid_field
op_star
op_star
id|field
)paren
(brace
r_int
id|i
comma
id|j
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|report-&gt;maxfield
suffix:semicolon
id|i
op_increment
)paren
(brace
op_star
id|field
op_assign
id|report-&gt;field
(braket
id|i
)braket
suffix:semicolon
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
(paren
op_star
id|field
)paren
op_member_access_from_pointer
id|maxusage
suffix:semicolon
id|j
op_increment
)paren
r_if
c_cond
(paren
(paren
op_star
id|field
)paren
op_member_access_from_pointer
id|usage
(braket
id|j
)braket
dot
id|hid
op_eq
id|wanted_usage
)paren
r_return
id|j
suffix:semicolon
)brace
r_return
op_minus
l_int|1
suffix:semicolon
)brace
DECL|function|hid_submit_out
r_static
r_int
id|hid_submit_out
c_func
(paren
r_struct
id|hid_device
op_star
id|hid
)paren
(brace
r_struct
id|hid_report
op_star
id|report
suffix:semicolon
id|report
op_assign
id|hid-&gt;out
(braket
id|hid-&gt;outtail
)braket
suffix:semicolon
id|hid_output_report
c_func
(paren
id|report
comma
id|hid-&gt;outbuf
)paren
suffix:semicolon
id|hid-&gt;urbout-&gt;transfer_buffer_length
op_assign
(paren
(paren
id|report-&gt;size
op_minus
l_int|1
)paren
op_rshift
l_int|3
)paren
op_plus
l_int|1
suffix:semicolon
id|hid-&gt;urbout-&gt;dev
op_assign
id|hid-&gt;dev
suffix:semicolon
id|dbg
c_func
(paren
l_string|&quot;submitting out urb&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|usb_submit_urb
c_func
(paren
id|hid-&gt;urbout
comma
id|GFP_ATOMIC
)paren
)paren
(brace
id|err
c_func
(paren
l_string|&quot;usb_submit_urb(out) failed&quot;
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|hid_submit_ctrl
r_static
r_int
id|hid_submit_ctrl
c_func
(paren
r_struct
id|hid_device
op_star
id|hid
)paren
(brace
r_struct
id|hid_report
op_star
id|report
suffix:semicolon
r_int
r_char
id|dir
suffix:semicolon
id|report
op_assign
id|hid-&gt;ctrl
(braket
id|hid-&gt;ctrltail
)braket
dot
id|report
suffix:semicolon
id|dir
op_assign
id|hid-&gt;ctrl
(braket
id|hid-&gt;ctrltail
)braket
dot
id|dir
suffix:semicolon
r_if
c_cond
(paren
id|dir
op_eq
id|USB_DIR_OUT
)paren
id|hid_output_report
c_func
(paren
id|report
comma
id|hid-&gt;ctrlbuf
)paren
suffix:semicolon
id|hid-&gt;urbctrl-&gt;transfer_buffer_length
op_assign
(paren
(paren
id|report-&gt;size
op_minus
l_int|1
)paren
op_rshift
l_int|3
)paren
op_plus
l_int|1
op_plus
(paren
(paren
id|report-&gt;id
OG
l_int|0
)paren
op_logical_and
(paren
id|dir
op_ne
id|USB_DIR_OUT
)paren
)paren
suffix:semicolon
id|hid-&gt;urbctrl-&gt;pipe
op_assign
(paren
id|dir
op_eq
id|USB_DIR_OUT
)paren
ques
c_cond
id|usb_sndctrlpipe
c_func
(paren
id|hid-&gt;dev
comma
l_int|0
)paren
suffix:colon
id|usb_rcvctrlpipe
c_func
(paren
id|hid-&gt;dev
comma
l_int|0
)paren
suffix:semicolon
id|hid-&gt;urbctrl-&gt;dev
op_assign
id|hid-&gt;dev
suffix:semicolon
id|hid-&gt;cr-&gt;bRequestType
op_assign
id|USB_TYPE_CLASS
op_or
id|USB_RECIP_INTERFACE
op_or
id|dir
suffix:semicolon
id|hid-&gt;cr-&gt;bRequest
op_assign
(paren
id|dir
op_eq
id|USB_DIR_OUT
)paren
ques
c_cond
id|HID_REQ_SET_REPORT
suffix:colon
id|HID_REQ_GET_REPORT
suffix:semicolon
id|hid-&gt;cr-&gt;wValue
op_assign
id|cpu_to_le16
c_func
(paren
(paren
(paren
id|report-&gt;type
op_plus
l_int|1
)paren
op_lshift
l_int|8
)paren
op_or
id|report-&gt;id
)paren
suffix:semicolon
id|hid-&gt;cr-&gt;wIndex
op_assign
id|cpu_to_le16
c_func
(paren
id|hid-&gt;ifnum
)paren
suffix:semicolon
id|hid-&gt;cr-&gt;wLength
op_assign
id|cpu_to_le16
c_func
(paren
id|hid-&gt;urbctrl-&gt;transfer_buffer_length
)paren
suffix:semicolon
id|dbg
c_func
(paren
l_string|&quot;submitting ctrl urb&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|usb_submit_urb
c_func
(paren
id|hid-&gt;urbctrl
comma
id|GFP_ATOMIC
)paren
)paren
(brace
id|err
c_func
(paren
l_string|&quot;usb_submit_urb(ctrl) failed&quot;
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * Output interrupt completion handler.&n; */
DECL|function|hid_irq_out
r_static
r_void
id|hid_irq_out
c_func
(paren
r_struct
id|urb
op_star
id|urb
)paren
(brace
r_struct
id|hid_device
op_star
id|hid
op_assign
id|urb-&gt;context
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_if
c_cond
(paren
id|urb-&gt;status
)paren
id|warn
c_func
(paren
l_string|&quot;output irq status %d received&quot;
comma
id|urb-&gt;status
)paren
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|hid-&gt;outlock
comma
id|flags
)paren
suffix:semicolon
id|hid-&gt;outtail
op_assign
(paren
id|hid-&gt;outtail
op_plus
l_int|1
)paren
op_amp
(paren
id|HID_OUTPUT_FIFO_SIZE
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hid-&gt;outhead
op_ne
id|hid-&gt;outtail
)paren
(brace
id|hid_submit_out
c_func
(paren
id|hid
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|hid-&gt;outlock
comma
id|flags
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|clear_bit
c_func
(paren
id|HID_OUT_RUNNING
comma
op_amp
id|hid-&gt;iofl
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|hid-&gt;outlock
comma
id|flags
)paren
suffix:semicolon
id|wake_up
c_func
(paren
op_amp
id|hid-&gt;wait
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Control pipe completion handler.&n; */
DECL|function|hid_ctrl
r_static
r_void
id|hid_ctrl
c_func
(paren
r_struct
id|urb
op_star
id|urb
)paren
(brace
r_struct
id|hid_device
op_star
id|hid
op_assign
id|urb-&gt;context
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_if
c_cond
(paren
id|urb-&gt;status
)paren
id|warn
c_func
(paren
l_string|&quot;ctrl urb status %d received&quot;
comma
id|urb-&gt;status
)paren
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|hid-&gt;ctrllock
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hid-&gt;ctrl
(braket
id|hid-&gt;ctrltail
)braket
dot
id|dir
op_eq
id|USB_DIR_IN
)paren
id|hid_input_report
c_func
(paren
id|hid-&gt;ctrl
(braket
id|hid-&gt;ctrltail
)braket
dot
id|report-&gt;type
comma
id|urb
)paren
suffix:semicolon
id|hid-&gt;ctrltail
op_assign
(paren
id|hid-&gt;ctrltail
op_plus
l_int|1
)paren
op_amp
(paren
id|HID_CONTROL_FIFO_SIZE
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hid-&gt;ctrlhead
op_ne
id|hid-&gt;ctrltail
)paren
(brace
id|hid_submit_ctrl
c_func
(paren
id|hid
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|hid-&gt;ctrllock
comma
id|flags
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|clear_bit
c_func
(paren
id|HID_CTRL_RUNNING
comma
op_amp
id|hid-&gt;iofl
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|hid-&gt;ctrllock
comma
id|flags
)paren
suffix:semicolon
id|wake_up
c_func
(paren
op_amp
id|hid-&gt;wait
)paren
suffix:semicolon
)brace
DECL|function|hid_submit_report
r_void
id|hid_submit_report
c_func
(paren
r_struct
id|hid_device
op_star
id|hid
comma
r_struct
id|hid_report
op_star
id|report
comma
r_int
r_char
id|dir
)paren
(brace
r_int
id|head
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_if
c_cond
(paren
(paren
id|hid-&gt;quirks
op_amp
id|HID_QUIRK_NOGET
)paren
op_logical_and
id|dir
op_eq
id|USB_DIR_IN
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|hid-&gt;urbout
op_logical_and
id|dir
op_eq
id|USB_DIR_OUT
op_logical_and
id|report-&gt;type
op_eq
id|HID_OUTPUT_REPORT
)paren
(brace
id|spin_lock_irqsave
c_func
(paren
op_amp
id|hid-&gt;outlock
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|head
op_assign
(paren
id|hid-&gt;outhead
op_plus
l_int|1
)paren
op_amp
(paren
id|HID_OUTPUT_FIFO_SIZE
op_minus
l_int|1
)paren
)paren
op_eq
id|hid-&gt;outtail
)paren
(brace
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|hid-&gt;outlock
comma
id|flags
)paren
suffix:semicolon
id|warn
c_func
(paren
l_string|&quot;output queue full&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|hid-&gt;out
(braket
id|hid-&gt;outhead
)braket
op_assign
id|report
suffix:semicolon
id|hid-&gt;outhead
op_assign
id|head
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|test_and_set_bit
c_func
(paren
id|HID_OUT_RUNNING
comma
op_amp
id|hid-&gt;iofl
)paren
)paren
id|hid_submit_out
c_func
(paren
id|hid
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|hid-&gt;outlock
comma
id|flags
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|spin_lock_irqsave
c_func
(paren
op_amp
id|hid-&gt;ctrllock
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|head
op_assign
(paren
id|hid-&gt;ctrlhead
op_plus
l_int|1
)paren
op_amp
(paren
id|HID_CONTROL_FIFO_SIZE
op_minus
l_int|1
)paren
)paren
op_eq
id|hid-&gt;ctrltail
)paren
(brace
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|hid-&gt;ctrllock
comma
id|flags
)paren
suffix:semicolon
id|warn
c_func
(paren
l_string|&quot;control queue full&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|hid-&gt;ctrl
(braket
id|hid-&gt;ctrlhead
)braket
dot
id|report
op_assign
id|report
suffix:semicolon
id|hid-&gt;ctrl
(braket
id|hid-&gt;ctrlhead
)braket
dot
id|dir
op_assign
id|dir
suffix:semicolon
id|hid-&gt;ctrlhead
op_assign
id|head
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|test_and_set_bit
c_func
(paren
id|HID_CTRL_RUNNING
comma
op_amp
id|hid-&gt;iofl
)paren
)paren
id|hid_submit_ctrl
c_func
(paren
id|hid
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|hid-&gt;ctrllock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|hid_wait_io
r_int
id|hid_wait_io
c_func
(paren
r_struct
id|hid_device
op_star
id|hid
)paren
(brace
id|DECLARE_WAITQUEUE
c_func
(paren
id|wait
comma
id|current
)paren
suffix:semicolon
r_int
id|timeout
op_assign
l_int|10
op_star
id|HZ
suffix:semicolon
id|set_current_state
c_func
(paren
id|TASK_UNINTERRUPTIBLE
)paren
suffix:semicolon
id|add_wait_queue
c_func
(paren
op_amp
id|hid-&gt;wait
comma
op_amp
id|wait
)paren
suffix:semicolon
r_while
c_loop
(paren
id|timeout
op_logical_and
(paren
id|test_bit
c_func
(paren
id|HID_CTRL_RUNNING
comma
op_amp
id|hid-&gt;iofl
)paren
op_logical_or
id|test_bit
c_func
(paren
id|HID_OUT_RUNNING
comma
op_amp
id|hid-&gt;iofl
)paren
)paren
)paren
id|timeout
op_assign
id|schedule_timeout
c_func
(paren
id|timeout
)paren
suffix:semicolon
id|set_current_state
c_func
(paren
id|TASK_RUNNING
)paren
suffix:semicolon
id|remove_wait_queue
c_func
(paren
op_amp
id|hid-&gt;wait
comma
op_amp
id|wait
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|timeout
)paren
(brace
id|dbg
c_func
(paren
l_string|&quot;timeout waiting for ctrl or out queue to clear&quot;
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|hid_get_class_descriptor
r_static
r_int
id|hid_get_class_descriptor
c_func
(paren
r_struct
id|usb_device
op_star
id|dev
comma
r_int
id|ifnum
comma
r_int
r_char
id|type
comma
r_void
op_star
id|buf
comma
r_int
id|size
)paren
(brace
r_return
id|usb_control_msg
c_func
(paren
id|dev
comma
id|usb_rcvctrlpipe
c_func
(paren
id|dev
comma
l_int|0
)paren
comma
id|USB_REQ_GET_DESCRIPTOR
comma
id|USB_RECIP_INTERFACE
op_or
id|USB_DIR_IN
comma
(paren
id|type
op_lshift
l_int|8
)paren
comma
id|ifnum
comma
id|buf
comma
id|size
comma
id|HZ
op_star
id|USB_CTRL_GET_TIMEOUT
)paren
suffix:semicolon
)brace
DECL|function|hid_open
r_int
id|hid_open
c_func
(paren
r_struct
id|hid_device
op_star
id|hid
)paren
(brace
r_if
c_cond
(paren
id|hid-&gt;open
op_increment
)paren
r_return
l_int|0
suffix:semicolon
id|hid-&gt;urbin-&gt;dev
op_assign
id|hid-&gt;dev
suffix:semicolon
r_if
c_cond
(paren
id|usb_submit_urb
c_func
(paren
id|hid-&gt;urbin
comma
id|GFP_KERNEL
)paren
)paren
r_return
op_minus
id|EIO
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|hid_close
r_void
id|hid_close
c_func
(paren
r_struct
id|hid_device
op_star
id|hid
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
op_decrement
id|hid-&gt;open
)paren
id|usb_unlink_urb
c_func
(paren
id|hid-&gt;urbin
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Initialize all reports&n; */
DECL|function|hid_init_reports
r_void
id|hid_init_reports
c_func
(paren
r_struct
id|hid_device
op_star
id|hid
)paren
(brace
r_struct
id|hid_report_enum
op_star
id|report_enum
suffix:semicolon
r_struct
id|hid_report
op_star
id|report
suffix:semicolon
r_struct
id|list_head
op_star
id|list
suffix:semicolon
r_int
id|len
suffix:semicolon
r_int
id|err
comma
id|ret
suffix:semicolon
id|report_enum
op_assign
id|hid-&gt;report_enum
op_plus
id|HID_INPUT_REPORT
suffix:semicolon
id|list
op_assign
id|report_enum-&gt;report_list.next
suffix:semicolon
r_while
c_loop
(paren
id|list
op_ne
op_amp
id|report_enum-&gt;report_list
)paren
(brace
id|report
op_assign
(paren
r_struct
id|hid_report
op_star
)paren
id|list
suffix:semicolon
id|hid_submit_report
c_func
(paren
id|hid
comma
id|report
comma
id|USB_DIR_IN
)paren
suffix:semicolon
id|list
op_assign
id|list-&gt;next
suffix:semicolon
)brace
id|report_enum
op_assign
id|hid-&gt;report_enum
op_plus
id|HID_FEATURE_REPORT
suffix:semicolon
id|list
op_assign
id|report_enum-&gt;report_list.next
suffix:semicolon
r_while
c_loop
(paren
id|list
op_ne
op_amp
id|report_enum-&gt;report_list
)paren
(brace
id|report
op_assign
(paren
r_struct
id|hid_report
op_star
)paren
id|list
suffix:semicolon
id|hid_submit_report
c_func
(paren
id|hid
comma
id|report
comma
id|USB_DIR_IN
)paren
suffix:semicolon
id|list
op_assign
id|list-&gt;next
suffix:semicolon
)brace
id|err
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
(paren
id|ret
op_assign
id|hid_wait_io
c_func
(paren
id|hid
)paren
)paren
)paren
(brace
id|err
op_or_assign
id|ret
suffix:semicolon
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|HID_CTRL_RUNNING
comma
op_amp
id|hid-&gt;iofl
)paren
)paren
id|usb_unlink_urb
c_func
(paren
id|hid-&gt;urbctrl
)paren
suffix:semicolon
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|HID_OUT_RUNNING
comma
op_amp
id|hid-&gt;iofl
)paren
)paren
id|usb_unlink_urb
c_func
(paren
id|hid-&gt;urbout
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|err
)paren
id|warn
c_func
(paren
l_string|&quot;timeout initializing reports&bslash;n&quot;
)paren
suffix:semicolon
id|report_enum
op_assign
id|hid-&gt;report_enum
op_plus
id|HID_INPUT_REPORT
suffix:semicolon
id|list
op_assign
id|report_enum-&gt;report_list.next
suffix:semicolon
r_while
c_loop
(paren
id|list
op_ne
op_amp
id|report_enum-&gt;report_list
)paren
(brace
id|report
op_assign
(paren
r_struct
id|hid_report
op_star
)paren
id|list
suffix:semicolon
id|len
op_assign
(paren
(paren
id|report-&gt;size
op_minus
l_int|1
)paren
op_rshift
l_int|3
)paren
op_plus
l_int|1
op_plus
id|report_enum-&gt;numbered
suffix:semicolon
r_if
c_cond
(paren
id|len
OG
id|hid-&gt;urbin-&gt;transfer_buffer_length
)paren
id|hid-&gt;urbin-&gt;transfer_buffer_length
op_assign
id|len
OL
id|HID_BUFFER_SIZE
ques
c_cond
id|len
suffix:colon
id|HID_BUFFER_SIZE
suffix:semicolon
id|usb_control_msg
c_func
(paren
id|hid-&gt;dev
comma
id|usb_sndctrlpipe
c_func
(paren
id|hid-&gt;dev
comma
l_int|0
)paren
comma
l_int|0x0a
comma
id|USB_TYPE_CLASS
op_or
id|USB_RECIP_INTERFACE
comma
id|report-&gt;id
comma
id|hid-&gt;ifnum
comma
l_int|NULL
comma
l_int|0
comma
id|HZ
op_star
id|USB_CTRL_SET_TIMEOUT
)paren
suffix:semicolon
id|list
op_assign
id|list-&gt;next
suffix:semicolon
)brace
)brace
DECL|macro|USB_VENDOR_ID_WACOM
mdefine_line|#define USB_VENDOR_ID_WACOM&t;&t;0x056a
DECL|macro|USB_DEVICE_ID_WACOM_GRAPHIRE
mdefine_line|#define USB_DEVICE_ID_WACOM_GRAPHIRE&t;0x0010
DECL|macro|USB_DEVICE_ID_WACOM_INTUOS
mdefine_line|#define USB_DEVICE_ID_WACOM_INTUOS&t;0x0020
DECL|macro|USB_VENDOR_ID_GRIFFIN
mdefine_line|#define USB_VENDOR_ID_GRIFFIN&t;&t;0x077d
DECL|macro|USB_DEVICE_ID_POWERMATE
mdefine_line|#define USB_DEVICE_ID_POWERMATE&t;&t;0x0410
DECL|macro|USB_DEVICE_ID_SOUNDKNOB
mdefine_line|#define USB_DEVICE_ID_SOUNDKNOB&t;&t;0x04AA
DECL|macro|USB_VENDOR_ID_ATEN
mdefine_line|#define USB_VENDOR_ID_ATEN             0x0557  
DECL|macro|USB_DEVICE_ID_ATEN_UC100KM
mdefine_line|#define USB_DEVICE_ID_ATEN_UC100KM     0x2004
DECL|macro|USB_DEVICE_ID_ATEN_CS124U
mdefine_line|#define USB_DEVICE_ID_ATEN_CS124U      0x2202
DECL|macro|USB_DEVICE_ID_ATEN_2PORTKVM
mdefine_line|#define USB_DEVICE_ID_ATEN_2PORTKVM    0x2204
DECL|macro|USB_DEVICE_ID_ATEN_4PORTKVM
mdefine_line|#define USB_DEVICE_ID_ATEN_4PORTKVM    0x2205
DECL|macro|USB_VENDOR_ID_MGE
mdefine_line|#define USB_VENDOR_ID_MGE              0x0463
DECL|macro|USB_DEVICE_ID_MGE_UPS
mdefine_line|#define USB_DEVICE_ID_MGE_UPS          0xffff
DECL|macro|USB_DEVICE_ID_MGE_UPS1
mdefine_line|#define USB_DEVICE_ID_MGE_UPS1         0x0001
DECL|struct|hid_blacklist
r_struct
id|hid_blacklist
(brace
DECL|member|idVendor
id|__u16
id|idVendor
suffix:semicolon
DECL|member|idProduct
id|__u16
id|idProduct
suffix:semicolon
DECL|member|quirks
r_int
id|quirks
suffix:semicolon
DECL|variable|hid_blacklist
)brace
id|hid_blacklist
(braket
)braket
op_assign
(brace
(brace
id|USB_VENDOR_ID_WACOM
comma
id|USB_DEVICE_ID_WACOM_GRAPHIRE
comma
id|HID_QUIRK_IGNORE
)brace
comma
(brace
id|USB_VENDOR_ID_WACOM
comma
id|USB_DEVICE_ID_WACOM_INTUOS
comma
id|HID_QUIRK_IGNORE
)brace
comma
(brace
id|USB_VENDOR_ID_WACOM
comma
id|USB_DEVICE_ID_WACOM_INTUOS
op_plus
l_int|1
comma
id|HID_QUIRK_IGNORE
)brace
comma
(brace
id|USB_VENDOR_ID_WACOM
comma
id|USB_DEVICE_ID_WACOM_INTUOS
op_plus
l_int|2
comma
id|HID_QUIRK_IGNORE
)brace
comma
(brace
id|USB_VENDOR_ID_WACOM
comma
id|USB_DEVICE_ID_WACOM_INTUOS
op_plus
l_int|3
comma
id|HID_QUIRK_IGNORE
)brace
comma
(brace
id|USB_VENDOR_ID_WACOM
comma
id|USB_DEVICE_ID_WACOM_INTUOS
op_plus
l_int|4
comma
id|HID_QUIRK_IGNORE
)brace
comma
(brace
id|USB_VENDOR_ID_GRIFFIN
comma
id|USB_DEVICE_ID_POWERMATE
comma
id|HID_QUIRK_IGNORE
)brace
comma
(brace
id|USB_VENDOR_ID_GRIFFIN
comma
id|USB_DEVICE_ID_SOUNDKNOB
comma
id|HID_QUIRK_IGNORE
)brace
comma
(brace
id|USB_VENDOR_ID_ATEN
comma
id|USB_DEVICE_ID_ATEN_UC100KM
comma
id|HID_QUIRK_NOGET
)brace
comma
(brace
id|USB_VENDOR_ID_ATEN
comma
id|USB_DEVICE_ID_ATEN_CS124U
comma
id|HID_QUIRK_NOGET
)brace
comma
(brace
id|USB_VENDOR_ID_ATEN
comma
id|USB_DEVICE_ID_ATEN_2PORTKVM
comma
id|HID_QUIRK_NOGET
)brace
comma
(brace
id|USB_VENDOR_ID_ATEN
comma
id|USB_DEVICE_ID_ATEN_4PORTKVM
comma
id|HID_QUIRK_NOGET
)brace
comma
(brace
id|USB_VENDOR_ID_MGE
comma
id|USB_DEVICE_ID_MGE_UPS
comma
id|HID_QUIRK_HIDDEV
)brace
comma
(brace
id|USB_VENDOR_ID_MGE
comma
id|USB_DEVICE_ID_MGE_UPS1
comma
id|HID_QUIRK_HIDDEV
)brace
comma
(brace
l_int|0
comma
l_int|0
)brace
)brace
suffix:semicolon
DECL|function|hid_alloc_buffers
r_static
r_int
id|hid_alloc_buffers
c_func
(paren
r_struct
id|usb_device
op_star
id|dev
comma
r_struct
id|hid_device
op_star
id|hid
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|hid-&gt;inbuf
op_assign
id|usb_buffer_alloc
c_func
(paren
id|dev
comma
id|HID_BUFFER_SIZE
comma
id|SLAB_ATOMIC
comma
op_amp
id|hid-&gt;inbuf_dma
)paren
)paren
)paren
r_return
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|hid-&gt;outbuf
op_assign
id|usb_buffer_alloc
c_func
(paren
id|dev
comma
id|HID_BUFFER_SIZE
comma
id|SLAB_ATOMIC
comma
op_amp
id|hid-&gt;outbuf_dma
)paren
)paren
)paren
r_return
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|hid-&gt;cr
op_assign
id|usb_buffer_alloc
c_func
(paren
id|dev
comma
r_sizeof
(paren
op_star
(paren
id|hid-&gt;cr
)paren
)paren
comma
id|SLAB_ATOMIC
comma
op_amp
id|hid-&gt;cr_dma
)paren
)paren
)paren
r_return
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|hid-&gt;ctrlbuf
op_assign
id|usb_buffer_alloc
c_func
(paren
id|dev
comma
id|HID_BUFFER_SIZE
comma
id|SLAB_ATOMIC
comma
op_amp
id|hid-&gt;ctrlbuf_dma
)paren
)paren
)paren
r_return
op_minus
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|hid_free_buffers
r_static
r_void
id|hid_free_buffers
c_func
(paren
r_struct
id|usb_device
op_star
id|dev
comma
r_struct
id|hid_device
op_star
id|hid
)paren
(brace
r_if
c_cond
(paren
id|hid-&gt;inbuf
)paren
id|usb_buffer_free
c_func
(paren
id|dev
comma
id|HID_BUFFER_SIZE
comma
id|hid-&gt;inbuf
comma
id|hid-&gt;inbuf_dma
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hid-&gt;outbuf
)paren
id|usb_buffer_free
c_func
(paren
id|dev
comma
id|HID_BUFFER_SIZE
comma
id|hid-&gt;outbuf
comma
id|hid-&gt;outbuf_dma
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hid-&gt;cr
)paren
id|usb_buffer_free
c_func
(paren
id|dev
comma
r_sizeof
(paren
op_star
(paren
id|hid-&gt;cr
)paren
)paren
comma
id|hid-&gt;cr
comma
id|hid-&gt;cr_dma
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hid-&gt;ctrlbuf
)paren
id|usb_buffer_free
c_func
(paren
id|dev
comma
id|HID_BUFFER_SIZE
comma
id|hid-&gt;ctrlbuf
comma
id|hid-&gt;ctrlbuf_dma
)paren
suffix:semicolon
)brace
DECL|function|usb_hid_configure
r_static
r_struct
id|hid_device
op_star
id|usb_hid_configure
c_func
(paren
r_struct
id|usb_device
op_star
id|dev
comma
r_int
id|ifnum
)paren
(brace
r_struct
id|usb_interface_descriptor
op_star
id|interface
op_assign
id|dev-&gt;actconfig-&gt;interface
(braket
id|ifnum
)braket
dot
id|altsetting
op_plus
l_int|0
suffix:semicolon
r_struct
id|hid_descriptor
op_star
id|hdesc
suffix:semicolon
r_struct
id|hid_device
op_star
id|hid
suffix:semicolon
r_int
id|quirks
op_assign
l_int|0
comma
id|rsize
op_assign
l_int|0
suffix:semicolon
r_char
op_star
id|buf
comma
op_star
id|rdesc
suffix:semicolon
r_int
id|n
suffix:semicolon
r_for
c_loop
(paren
id|n
op_assign
l_int|0
suffix:semicolon
id|hid_blacklist
(braket
id|n
)braket
dot
id|idVendor
suffix:semicolon
id|n
op_increment
)paren
r_if
c_cond
(paren
(paren
id|hid_blacklist
(braket
id|n
)braket
dot
id|idVendor
op_eq
id|dev-&gt;descriptor.idVendor
)paren
op_logical_and
(paren
id|hid_blacklist
(braket
id|n
)braket
dot
id|idProduct
op_eq
id|dev-&gt;descriptor.idProduct
)paren
)paren
id|quirks
op_assign
id|hid_blacklist
(braket
id|n
)braket
dot
id|quirks
suffix:semicolon
r_if
c_cond
(paren
id|quirks
op_amp
id|HID_QUIRK_IGNORE
)paren
r_return
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
id|usb_get_extra_descriptor
c_func
(paren
id|interface
comma
id|HID_DT_HID
comma
op_amp
id|hdesc
)paren
op_logical_and
(paren
(paren
op_logical_neg
id|interface-&gt;bNumEndpoints
)paren
op_logical_or
id|usb_get_extra_descriptor
c_func
(paren
op_amp
id|interface-&gt;endpoint
(braket
l_int|0
)braket
comma
id|HID_DT_HID
comma
op_amp
id|hdesc
)paren
)paren
)paren
(brace
id|dbg
c_func
(paren
l_string|&quot;class descriptor not present&bslash;n&quot;
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
r_for
c_loop
(paren
id|n
op_assign
l_int|0
suffix:semicolon
id|n
OL
id|hdesc-&gt;bNumDescriptors
suffix:semicolon
id|n
op_increment
)paren
r_if
c_cond
(paren
id|hdesc-&gt;desc
(braket
id|n
)braket
dot
id|bDescriptorType
op_eq
id|HID_DT_REPORT
)paren
id|rsize
op_assign
id|le16_to_cpu
c_func
(paren
id|hdesc-&gt;desc
(braket
id|n
)braket
dot
id|wDescriptorLength
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|rsize
op_logical_or
id|rsize
OG
id|HID_MAX_DESCRIPTOR_SIZE
)paren
(brace
id|dbg
c_func
(paren
l_string|&quot;weird size of report descriptor (%u)&quot;
comma
id|rsize
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|rdesc
op_assign
id|kmalloc
c_func
(paren
id|rsize
comma
id|GFP_KERNEL
)paren
)paren
)paren
(brace
id|dbg
c_func
(paren
l_string|&quot;couldn&squot;t allocate rdesc memory&quot;
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|n
op_assign
id|hid_get_class_descriptor
c_func
(paren
id|dev
comma
id|interface-&gt;bInterfaceNumber
comma
id|HID_DT_REPORT
comma
id|rdesc
comma
id|rsize
)paren
)paren
OL
l_int|0
)paren
(brace
id|dbg
c_func
(paren
l_string|&quot;reading report descriptor failed&quot;
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|rdesc
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
macro_line|#ifdef DEBUG_DATA
id|printk
c_func
(paren
id|KERN_DEBUG
id|__FILE__
l_string|&quot;: report descriptor (size %u, read %d) = &quot;
comma
id|rsize
comma
id|n
)paren
suffix:semicolon
r_for
c_loop
(paren
id|n
op_assign
l_int|0
suffix:semicolon
id|n
OL
id|rsize
suffix:semicolon
id|n
op_increment
)paren
id|printk
c_func
(paren
l_string|&quot; %02x&quot;
comma
(paren
r_int
r_char
)paren
id|rdesc
(braket
id|n
)braket
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
op_logical_neg
(paren
id|hid
op_assign
id|hid_parse_report
c_func
(paren
id|rdesc
comma
id|rsize
)paren
)paren
)paren
(brace
id|dbg
c_func
(paren
l_string|&quot;parsing report descriptor failed&quot;
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|rdesc
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
id|kfree
c_func
(paren
id|rdesc
)paren
suffix:semicolon
id|hid-&gt;quirks
op_assign
id|quirks
suffix:semicolon
r_if
c_cond
(paren
id|hid_alloc_buffers
c_func
(paren
id|dev
comma
id|hid
)paren
)paren
(brace
id|hid_free_buffers
c_func
(paren
id|dev
comma
id|hid
)paren
suffix:semicolon
r_goto
id|fail
suffix:semicolon
)brace
r_for
c_loop
(paren
id|n
op_assign
l_int|0
suffix:semicolon
id|n
OL
id|interface-&gt;bNumEndpoints
suffix:semicolon
id|n
op_increment
)paren
(brace
r_struct
id|usb_endpoint_descriptor
op_star
id|endpoint
op_assign
op_amp
id|interface-&gt;endpoint
(braket
id|n
)braket
suffix:semicolon
r_int
id|pipe
suffix:semicolon
r_if
c_cond
(paren
(paren
id|endpoint-&gt;bmAttributes
op_amp
l_int|3
)paren
op_ne
l_int|3
)paren
multiline_comment|/* Not an interrupt endpoint */
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|endpoint-&gt;bEndpointAddress
op_amp
id|USB_DIR_IN
)paren
(brace
r_if
c_cond
(paren
id|hid-&gt;urbin
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|hid-&gt;urbin
op_assign
id|usb_alloc_urb
c_func
(paren
l_int|0
comma
id|GFP_KERNEL
)paren
)paren
)paren
r_goto
id|fail
suffix:semicolon
id|pipe
op_assign
id|usb_rcvintpipe
c_func
(paren
id|dev
comma
id|endpoint-&gt;bEndpointAddress
)paren
suffix:semicolon
id|usb_fill_int_urb
c_func
(paren
id|hid-&gt;urbin
comma
id|dev
comma
id|pipe
comma
id|hid-&gt;inbuf
comma
l_int|0
comma
id|hid_irq_in
comma
id|hid
comma
id|endpoint-&gt;bInterval
)paren
suffix:semicolon
id|hid-&gt;urbin-&gt;transfer_dma
op_assign
id|hid-&gt;inbuf_dma
suffix:semicolon
id|hid-&gt;urbin-&gt;transfer_flags
op_or_assign
id|URB_NO_DMA_MAP
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|hid-&gt;urbout
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|hid-&gt;urbout
op_assign
id|usb_alloc_urb
c_func
(paren
l_int|0
comma
id|GFP_KERNEL
)paren
)paren
)paren
r_goto
id|fail
suffix:semicolon
id|pipe
op_assign
id|usb_sndbulkpipe
c_func
(paren
id|dev
comma
id|endpoint-&gt;bEndpointAddress
)paren
suffix:semicolon
id|usb_fill_bulk_urb
c_func
(paren
id|hid-&gt;urbout
comma
id|dev
comma
id|pipe
comma
id|hid-&gt;outbuf
comma
l_int|0
comma
id|hid_irq_out
comma
id|hid
)paren
suffix:semicolon
id|hid-&gt;urbout-&gt;transfer_dma
op_assign
id|hid-&gt;outbuf_dma
suffix:semicolon
id|hid-&gt;urbout-&gt;transfer_flags
op_or_assign
id|URB_NO_DMA_MAP
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
op_logical_neg
id|hid-&gt;urbin
)paren
(brace
id|err
c_func
(paren
l_string|&quot;couldn&squot;t find an input interrupt endpoint&quot;
)paren
suffix:semicolon
r_goto
id|fail
suffix:semicolon
)brace
id|init_waitqueue_head
c_func
(paren
op_amp
id|hid-&gt;wait
)paren
suffix:semicolon
id|hid-&gt;outlock
op_assign
id|SPIN_LOCK_UNLOCKED
suffix:semicolon
id|hid-&gt;ctrllock
op_assign
id|SPIN_LOCK_UNLOCKED
suffix:semicolon
id|hid-&gt;version
op_assign
id|le16_to_cpu
c_func
(paren
id|hdesc-&gt;bcdHID
)paren
suffix:semicolon
id|hid-&gt;country
op_assign
id|hdesc-&gt;bCountryCode
suffix:semicolon
id|hid-&gt;dev
op_assign
id|dev
suffix:semicolon
id|hid-&gt;ifnum
op_assign
id|interface-&gt;bInterfaceNumber
suffix:semicolon
id|hid-&gt;name
(braket
l_int|0
)braket
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|buf
op_assign
id|kmalloc
c_func
(paren
l_int|64
comma
id|GFP_KERNEL
)paren
)paren
)paren
r_goto
id|fail
suffix:semicolon
r_if
c_cond
(paren
id|usb_string
c_func
(paren
id|dev
comma
id|dev-&gt;descriptor.iManufacturer
comma
id|buf
comma
l_int|64
)paren
OG
l_int|0
)paren
(brace
id|strcat
c_func
(paren
id|hid-&gt;name
comma
id|buf
)paren
suffix:semicolon
r_if
c_cond
(paren
id|usb_string
c_func
(paren
id|dev
comma
id|dev-&gt;descriptor.iProduct
comma
id|buf
comma
l_int|64
)paren
OG
l_int|0
)paren
id|snprintf
c_func
(paren
id|hid-&gt;name
comma
l_int|64
comma
l_string|&quot;%s %s&quot;
comma
id|hid-&gt;name
comma
id|buf
)paren
suffix:semicolon
)brace
r_else
id|snprintf
c_func
(paren
id|hid-&gt;name
comma
l_int|128
comma
l_string|&quot;%04x:%04x&quot;
comma
id|dev-&gt;descriptor.idVendor
comma
id|dev-&gt;descriptor.idProduct
)paren
suffix:semicolon
id|usb_make_path
c_func
(paren
id|dev
comma
id|buf
comma
l_int|64
)paren
suffix:semicolon
id|snprintf
c_func
(paren
id|hid-&gt;phys
comma
l_int|64
comma
l_string|&quot;%s/input%d&quot;
comma
id|buf
comma
id|ifnum
)paren
suffix:semicolon
r_if
c_cond
(paren
id|usb_string
c_func
(paren
id|dev
comma
id|dev-&gt;descriptor.iSerialNumber
comma
id|hid-&gt;uniq
comma
l_int|64
)paren
op_le
l_int|0
)paren
id|hid-&gt;uniq
(braket
l_int|0
)braket
op_assign
l_int|0
suffix:semicolon
id|kfree
c_func
(paren
id|buf
)paren
suffix:semicolon
id|hid-&gt;urbctrl
op_assign
id|usb_alloc_urb
c_func
(paren
l_int|0
comma
id|GFP_KERNEL
)paren
suffix:semicolon
id|usb_fill_control_urb
c_func
(paren
id|hid-&gt;urbctrl
comma
id|dev
comma
l_int|0
comma
(paren
r_void
op_star
)paren
id|hid-&gt;cr
comma
id|hid-&gt;ctrlbuf
comma
l_int|1
comma
id|hid_ctrl
comma
id|hid
)paren
suffix:semicolon
id|hid-&gt;urbctrl-&gt;setup_dma
op_assign
id|hid-&gt;cr_dma
suffix:semicolon
id|hid-&gt;urbctrl-&gt;transfer_dma
op_assign
id|hid-&gt;ctrlbuf_dma
suffix:semicolon
id|hid-&gt;urbctrl-&gt;transfer_flags
op_or_assign
id|URB_NO_DMA_MAP
suffix:semicolon
r_return
id|hid
suffix:semicolon
id|fail
suffix:colon
r_if
c_cond
(paren
id|hid-&gt;urbin
)paren
id|usb_free_urb
c_func
(paren
id|hid-&gt;urbin
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hid-&gt;urbout
)paren
id|usb_free_urb
c_func
(paren
id|hid-&gt;urbout
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hid-&gt;urbctrl
)paren
id|usb_free_urb
c_func
(paren
id|hid-&gt;urbctrl
)paren
suffix:semicolon
id|hid_free_buffers
c_func
(paren
id|dev
comma
id|hid
)paren
suffix:semicolon
id|hid_free_device
c_func
(paren
id|hid
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
DECL|function|hid_disconnect
r_static
r_void
id|hid_disconnect
c_func
(paren
r_struct
id|usb_device
op_star
id|dev
comma
r_void
op_star
id|ptr
)paren
(brace
r_struct
id|hid_device
op_star
id|hid
op_assign
id|ptr
suffix:semicolon
id|usb_unlink_urb
c_func
(paren
id|hid-&gt;urbin
)paren
suffix:semicolon
id|usb_unlink_urb
c_func
(paren
id|hid-&gt;urbout
)paren
suffix:semicolon
id|usb_unlink_urb
c_func
(paren
id|hid-&gt;urbctrl
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hid-&gt;claimed
op_amp
id|HID_CLAIMED_INPUT
)paren
id|hidinput_disconnect
c_func
(paren
id|hid
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hid-&gt;claimed
op_amp
id|HID_CLAIMED_HIDDEV
)paren
id|hiddev_disconnect
c_func
(paren
id|hid
)paren
suffix:semicolon
id|usb_free_urb
c_func
(paren
id|hid-&gt;urbin
)paren
suffix:semicolon
id|usb_free_urb
c_func
(paren
id|hid-&gt;urbctrl
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hid-&gt;urbout
)paren
id|usb_free_urb
c_func
(paren
id|hid-&gt;urbout
)paren
suffix:semicolon
id|hid_free_buffers
c_func
(paren
id|dev
comma
id|hid
)paren
suffix:semicolon
id|hid_free_device
c_func
(paren
id|hid
)paren
suffix:semicolon
)brace
DECL|function|hid_probe
r_static
r_void
op_star
id|hid_probe
c_func
(paren
r_struct
id|usb_device
op_star
id|dev
comma
r_int
r_int
id|ifnum
comma
r_const
r_struct
id|usb_device_id
op_star
id|id
)paren
(brace
r_struct
id|hid_device
op_star
id|hid
suffix:semicolon
r_char
id|path
(braket
l_int|64
)braket
suffix:semicolon
r_int
id|i
suffix:semicolon
r_char
op_star
id|c
suffix:semicolon
id|dbg
c_func
(paren
l_string|&quot;HID probe called for ifnum %d&quot;
comma
id|ifnum
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|hid
op_assign
id|usb_hid_configure
c_func
(paren
id|dev
comma
id|ifnum
)paren
)paren
)paren
r_return
l_int|NULL
suffix:semicolon
id|hid_init_reports
c_func
(paren
id|hid
)paren
suffix:semicolon
id|hid_dump_device
c_func
(paren
id|hid
)paren
suffix:semicolon
id|hid_ff_init
c_func
(paren
id|hid
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|hidinput_connect
c_func
(paren
id|hid
)paren
)paren
id|hid-&gt;claimed
op_or_assign
id|HID_CLAIMED_INPUT
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|hiddev_connect
c_func
(paren
id|hid
)paren
)paren
id|hid-&gt;claimed
op_or_assign
id|HID_CLAIMED_HIDDEV
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|hid-&gt;claimed
)paren
(brace
id|hid_disconnect
c_func
(paren
id|dev
comma
id|hid
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
id|printk
c_func
(paren
id|KERN_INFO
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hid-&gt;claimed
op_amp
id|HID_CLAIMED_INPUT
)paren
id|printk
c_func
(paren
l_string|&quot;input&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hid-&gt;claimed
op_eq
(paren
id|HID_CLAIMED_INPUT
op_or
id|HID_CLAIMED_HIDDEV
)paren
)paren
id|printk
c_func
(paren
l_string|&quot;,&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hid-&gt;claimed
op_amp
id|HID_CLAIMED_HIDDEV
)paren
id|printk
c_func
(paren
l_string|&quot;hiddev%d&quot;
comma
id|hid-&gt;minor
)paren
suffix:semicolon
id|c
op_assign
l_string|&quot;Device&quot;
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|hid-&gt;maxcollection
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|hid-&gt;collection
(braket
id|i
)braket
dot
id|type
op_eq
id|HID_COLLECTION_APPLICATION
op_logical_and
(paren
id|hid-&gt;collection
(braket
id|i
)braket
dot
id|usage
op_amp
id|HID_USAGE_PAGE
)paren
op_eq
id|HID_UP_GENDESK
op_logical_and
(paren
id|hid-&gt;collection
(braket
id|i
)braket
dot
id|usage
op_amp
l_int|0xffff
)paren
OL
id|ARRAY_SIZE
c_func
(paren
id|hid_types
)paren
)paren
(brace
id|c
op_assign
id|hid_types
(braket
id|hid-&gt;collection
(braket
id|i
)braket
dot
id|usage
op_amp
l_int|0xffff
)braket
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
id|usb_make_path
c_func
(paren
id|dev
comma
id|path
comma
l_int|63
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;: USB HID v%x.%02x %s [%s] on %s&bslash;n&quot;
comma
id|hid-&gt;version
op_rshift
l_int|8
comma
id|hid-&gt;version
op_amp
l_int|0xff
comma
id|c
comma
id|hid-&gt;name
comma
id|path
)paren
suffix:semicolon
r_return
id|hid
suffix:semicolon
)brace
DECL|variable|hid_usb_ids
r_static
r_struct
id|usb_device_id
id|hid_usb_ids
(braket
)braket
op_assign
(brace
(brace
dot
id|match_flags
op_assign
id|USB_DEVICE_ID_MATCH_INT_CLASS
comma
dot
id|bInterfaceClass
op_assign
id|USB_INTERFACE_CLASS_HID
)brace
comma
(brace
)brace
multiline_comment|/* Terminating entry */
)brace
suffix:semicolon
id|MODULE_DEVICE_TABLE
(paren
id|usb
comma
id|hid_usb_ids
)paren
suffix:semicolon
DECL|variable|hid_driver
r_static
r_struct
id|usb_driver
id|hid_driver
op_assign
(brace
dot
id|name
op_assign
l_string|&quot;hid&quot;
comma
dot
id|probe
op_assign
id|hid_probe
comma
dot
id|disconnect
op_assign
id|hid_disconnect
comma
dot
id|id_table
op_assign
id|hid_usb_ids
comma
)brace
suffix:semicolon
DECL|function|hid_init
r_static
r_int
id|__init
id|hid_init
c_func
(paren
r_void
)paren
(brace
id|hiddev_init
c_func
(paren
)paren
suffix:semicolon
id|usb_register
c_func
(paren
op_amp
id|hid_driver
)paren
suffix:semicolon
id|info
c_func
(paren
id|DRIVER_VERSION
l_string|&quot;:&quot;
id|DRIVER_DESC
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|hid_exit
r_static
r_void
id|__exit
id|hid_exit
c_func
(paren
r_void
)paren
(brace
id|hiddev_exit
c_func
(paren
)paren
suffix:semicolon
id|usb_deregister
c_func
(paren
op_amp
id|hid_driver
)paren
suffix:semicolon
)brace
DECL|variable|hid_init
id|module_init
c_func
(paren
id|hid_init
)paren
suffix:semicolon
DECL|variable|hid_exit
id|module_exit
c_func
(paren
id|hid_exit
)paren
suffix:semicolon
DECL|variable|DRIVER_AUTHOR
id|MODULE_AUTHOR
c_func
(paren
id|DRIVER_AUTHOR
)paren
suffix:semicolon
DECL|variable|DRIVER_DESC
id|MODULE_DESCRIPTION
c_func
(paren
id|DRIVER_DESC
)paren
suffix:semicolon
DECL|variable|DRIVER_LICENSE
id|MODULE_LICENSE
c_func
(paren
id|DRIVER_LICENSE
)paren
suffix:semicolon
eof
