multiline_comment|/*&n; * $Id: hid-input.c,v 1.2 2002/04/23 00:59:25 rdamazio Exp $&n; *&n; *  Copyright (c) 2000-2001 Vojtech Pavlik&n; *&n; *  USB HID to Linux Input mapping&n; */
multiline_comment|/*&n; * This program is free software; you can redistribute it and/or modify&n; * it under the terms of the GNU General Public License as published by&n; * the Free Software Foundation; either version 2 of the License, or&n; * (at your option) any later version.&n; *&n; * This program is distributed in the hope that it will be useful,&n; * but WITHOUT ANY WARRANTY; without even the implied warranty of&n; * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; * GNU General Public License for more details.&n; *&n; * You should have received a copy of the GNU General Public License&n; * along with this program; if not, write to the Free Software&n; * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA&n; *&n; * Should you need to contact me, the author, you can do so either by&n; * e-mail - mail your message to &lt;vojtech@ucw.cz&gt;, or by paper mail:&n; * Vojtech Pavlik, Simunkova 1594, Prague 8, 182 00 Czech Republic&n; */
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/input.h&gt;
macro_line|#include &lt;linux/usb.h&gt;
DECL|macro|DEBUG
macro_line|#undef DEBUG
macro_line|#include &quot;hid.h&quot;
DECL|macro|unk
mdefine_line|#define unk&t;KEY_UNKNOWN
DECL|variable|hid_keyboard
r_static
r_int
r_char
id|hid_keyboard
(braket
l_int|256
)braket
op_assign
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|30
comma
l_int|48
comma
l_int|46
comma
l_int|32
comma
l_int|18
comma
l_int|33
comma
l_int|34
comma
l_int|35
comma
l_int|23
comma
l_int|36
comma
l_int|37
comma
l_int|38
comma
l_int|50
comma
l_int|49
comma
l_int|24
comma
l_int|25
comma
l_int|16
comma
l_int|19
comma
l_int|31
comma
l_int|20
comma
l_int|22
comma
l_int|47
comma
l_int|17
comma
l_int|45
comma
l_int|21
comma
l_int|44
comma
l_int|2
comma
l_int|3
comma
l_int|4
comma
l_int|5
comma
l_int|6
comma
l_int|7
comma
l_int|8
comma
l_int|9
comma
l_int|10
comma
l_int|11
comma
l_int|28
comma
l_int|1
comma
l_int|14
comma
l_int|15
comma
l_int|57
comma
l_int|12
comma
l_int|13
comma
l_int|26
comma
l_int|27
comma
l_int|43
comma
l_int|43
comma
l_int|39
comma
l_int|40
comma
l_int|41
comma
l_int|51
comma
l_int|52
comma
l_int|53
comma
l_int|58
comma
l_int|59
comma
l_int|60
comma
l_int|61
comma
l_int|62
comma
l_int|63
comma
l_int|64
comma
l_int|65
comma
l_int|66
comma
l_int|67
comma
l_int|68
comma
l_int|87
comma
l_int|88
comma
l_int|99
comma
l_int|70
comma
l_int|119
comma
l_int|110
comma
l_int|102
comma
l_int|104
comma
l_int|111
comma
l_int|107
comma
l_int|109
comma
l_int|106
comma
l_int|105
comma
l_int|108
comma
l_int|103
comma
l_int|69
comma
l_int|98
comma
l_int|55
comma
l_int|74
comma
l_int|78
comma
l_int|96
comma
l_int|79
comma
l_int|80
comma
l_int|81
comma
l_int|75
comma
l_int|76
comma
l_int|77
comma
l_int|71
comma
l_int|72
comma
l_int|73
comma
l_int|82
comma
l_int|83
comma
l_int|86
comma
l_int|127
comma
l_int|116
comma
l_int|117
comma
l_int|183
comma
l_int|184
comma
l_int|185
comma
l_int|186
comma
l_int|187
comma
l_int|188
comma
l_int|189
comma
l_int|190
comma
l_int|191
comma
l_int|192
comma
l_int|193
comma
l_int|194
comma
l_int|134
comma
l_int|138
comma
l_int|130
comma
l_int|132
comma
l_int|128
comma
l_int|129
comma
l_int|131
comma
l_int|137
comma
l_int|133
comma
l_int|135
comma
l_int|136
comma
l_int|113
comma
l_int|115
comma
l_int|114
comma
id|unk
comma
id|unk
comma
id|unk
comma
l_int|121
comma
id|unk
comma
l_int|89
comma
l_int|93
comma
l_int|124
comma
l_int|92
comma
l_int|94
comma
l_int|95
comma
id|unk
comma
id|unk
comma
id|unk
comma
l_int|122
comma
l_int|123
comma
l_int|90
comma
l_int|91
comma
l_int|85
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
comma
l_int|29
comma
l_int|42
comma
l_int|56
comma
l_int|125
comma
l_int|97
comma
l_int|54
comma
l_int|100
comma
l_int|126
comma
l_int|164
comma
l_int|166
comma
l_int|165
comma
l_int|163
comma
l_int|161
comma
l_int|115
comma
l_int|114
comma
l_int|113
comma
l_int|150
comma
l_int|158
comma
l_int|159
comma
l_int|128
comma
l_int|136
comma
l_int|177
comma
l_int|178
comma
l_int|176
comma
l_int|142
comma
l_int|152
comma
l_int|173
comma
l_int|140
comma
id|unk
comma
id|unk
comma
id|unk
comma
id|unk
)brace
suffix:semicolon
r_static
r_struct
(brace
DECL|member|x
id|__s32
id|x
suffix:semicolon
DECL|member|y
id|__s32
id|y
suffix:semicolon
DECL|variable|hid_hat_to_axis
)brace
id|hid_hat_to_axis
(braket
)braket
op_assign
(brace
(brace
l_int|0
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
op_minus
l_int|1
)brace
comma
(brace
l_int|1
comma
op_minus
l_int|1
)brace
comma
(brace
l_int|1
comma
l_int|0
)brace
comma
(brace
l_int|1
comma
l_int|1
)brace
comma
(brace
l_int|0
comma
l_int|1
)brace
comma
(brace
op_minus
l_int|1
comma
l_int|1
)brace
comma
(brace
op_minus
l_int|1
comma
l_int|0
)brace
comma
(brace
op_minus
l_int|1
comma
op_minus
l_int|1
)brace
)brace
suffix:semicolon
DECL|macro|map_abs
mdefine_line|#define map_abs(c)&t;do { usage-&gt;code = c; usage-&gt;type = EV_ABS; bit = input-&gt;absbit; max = ABS_MAX; } while (0)
DECL|macro|map_rel
mdefine_line|#define map_rel(c)&t;do { usage-&gt;code = c; usage-&gt;type = EV_REL; bit = input-&gt;relbit; max = REL_MAX; } while (0)
DECL|macro|map_key
mdefine_line|#define map_key(c)&t;do { usage-&gt;code = c; usage-&gt;type = EV_KEY; bit = input-&gt;keybit; max = KEY_MAX; } while (0)
DECL|macro|map_led
mdefine_line|#define map_led(c)&t;do { usage-&gt;code = c; usage-&gt;type = EV_LED; bit = input-&gt;ledbit; max = LED_MAX; } while (0)
DECL|macro|map_ff
mdefine_line|#define map_ff(c)&t;do { usage-&gt;code = c; usage-&gt;type = EV_FF;  bit = input-&gt;ffbit;  max =  FF_MAX; } while (0)
DECL|macro|map_abs_clear
mdefine_line|#define map_abs_clear(c)&t;do { map_abs(c); clear_bit(c, bit); } while (0)
DECL|macro|map_key_clear
mdefine_line|#define map_key_clear(c)&t;do { map_key(c); clear_bit(c, bit); } while (0)
DECL|macro|map_ff_effect
mdefine_line|#define map_ff_effect(c)&t;do { set_bit(c, input-&gt;ffbit); } while (0)
DECL|function|hidinput_configure_usage
r_static
r_void
id|hidinput_configure_usage
c_func
(paren
r_struct
id|hid_input
op_star
id|hidinput
comma
r_struct
id|hid_field
op_star
id|field
comma
r_struct
id|hid_usage
op_star
id|usage
)paren
(brace
r_struct
id|input_dev
op_star
id|input
op_assign
op_amp
id|hidinput-&gt;input
suffix:semicolon
r_struct
id|hid_device
op_star
id|device
op_assign
id|hidinput-&gt;input
dot
r_private
suffix:semicolon
r_int
id|max
comma
id|code
suffix:semicolon
r_int
r_int
op_star
id|bit
suffix:semicolon
id|field-&gt;hidinput
op_assign
id|hidinput
suffix:semicolon
macro_line|#ifdef DEBUG
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;Mapping: &quot;
)paren
suffix:semicolon
id|resolv_usage
c_func
(paren
id|usage-&gt;hid
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot; ---&gt; &quot;
)paren
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
id|field-&gt;flags
op_amp
id|HID_MAIN_ITEM_CONSTANT
)paren
r_goto
id|ignore
suffix:semicolon
r_switch
c_cond
(paren
id|usage-&gt;hid
op_amp
id|HID_USAGE_PAGE
)paren
(brace
r_case
id|HID_UP_UNDEFINED
suffix:colon
r_goto
id|ignore
suffix:semicolon
r_case
id|HID_UP_KEYBOARD
suffix:colon
id|set_bit
c_func
(paren
id|EV_REP
comma
id|input-&gt;evbit
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|usage-&gt;hid
op_amp
id|HID_USAGE
)paren
OL
l_int|256
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|hid_keyboard
(braket
id|usage-&gt;hid
op_amp
id|HID_USAGE
)braket
)paren
r_goto
id|ignore
suffix:semicolon
id|map_key_clear
c_func
(paren
id|hid_keyboard
(braket
id|usage-&gt;hid
op_amp
id|HID_USAGE
)braket
)paren
suffix:semicolon
)brace
r_else
id|map_key
c_func
(paren
id|KEY_UNKNOWN
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HID_UP_BUTTON
suffix:colon
id|code
op_assign
(paren
(paren
id|usage-&gt;hid
op_minus
l_int|1
)paren
op_amp
l_int|0xf
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|field-&gt;application
)paren
(brace
r_case
id|HID_GD_MOUSE
suffix:colon
r_case
id|HID_GD_POINTER
suffix:colon
id|code
op_add_assign
l_int|0x110
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HID_GD_JOYSTICK
suffix:colon
id|code
op_add_assign
l_int|0x120
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HID_GD_GAMEPAD
suffix:colon
id|code
op_add_assign
l_int|0x130
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
(brace
)brace
r_switch
c_cond
(paren
id|field-&gt;physical
)paren
(brace
r_case
id|HID_GD_MOUSE
suffix:colon
r_case
id|HID_GD_POINTER
suffix:colon
id|code
op_add_assign
l_int|0x110
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HID_GD_JOYSTICK
suffix:colon
id|code
op_add_assign
l_int|0x120
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HID_GD_GAMEPAD
suffix:colon
id|code
op_add_assign
l_int|0x130
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|code
op_add_assign
l_int|0x100
suffix:semicolon
)brace
)brace
id|map_key
c_func
(paren
id|code
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HID_UP_GENDESK
suffix:colon
r_if
c_cond
(paren
(paren
id|usage-&gt;hid
op_amp
l_int|0xf0
)paren
op_eq
l_int|0x80
)paren
(brace
multiline_comment|/* SystemControl */
r_switch
c_cond
(paren
id|usage-&gt;hid
op_amp
l_int|0xf
)paren
(brace
r_case
l_int|0x1
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_POWER
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x2
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_SLEEP
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x3
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_WAKEUP
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_goto
id|unknown
suffix:semicolon
)brace
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|usage-&gt;hid
op_amp
l_int|0xf0
)paren
op_eq
l_int|0x90
)paren
(brace
multiline_comment|/* D-pad */
r_switch
c_cond
(paren
id|usage-&gt;hid
)paren
(brace
r_case
id|HID_GD_UP
suffix:colon
id|usage-&gt;hat_dir
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HID_GD_DOWN
suffix:colon
id|usage-&gt;hat_dir
op_assign
l_int|5
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HID_GD_RIGHT
suffix:colon
id|usage-&gt;hat_dir
op_assign
l_int|3
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HID_GD_LEFT
suffix:colon
id|usage-&gt;hat_dir
op_assign
l_int|7
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_goto
id|unknown
suffix:semicolon
)brace
r_if
c_cond
(paren
id|field-&gt;dpad
)paren
(brace
id|map_abs
c_func
(paren
id|field-&gt;dpad
)paren
suffix:semicolon
r_goto
id|ignore
suffix:semicolon
)brace
id|map_abs
c_func
(paren
id|ABS_HAT0X
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|usage-&gt;hid
)paren
(brace
multiline_comment|/* These usage IDs map directly to the usage codes. */
r_case
id|HID_GD_X
suffix:colon
r_case
id|HID_GD_Y
suffix:colon
r_case
id|HID_GD_Z
suffix:colon
r_case
id|HID_GD_RX
suffix:colon
r_case
id|HID_GD_RY
suffix:colon
r_case
id|HID_GD_RZ
suffix:colon
r_case
id|HID_GD_SLIDER
suffix:colon
r_case
id|HID_GD_DIAL
suffix:colon
r_case
id|HID_GD_WHEEL
suffix:colon
r_if
c_cond
(paren
id|field-&gt;flags
op_amp
id|HID_MAIN_ITEM_RELATIVE
)paren
id|map_rel
c_func
(paren
id|usage-&gt;hid
op_amp
l_int|0xf
)paren
suffix:semicolon
r_else
id|map_abs
c_func
(paren
id|usage-&gt;hid
op_amp
l_int|0xf
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HID_GD_HATSWITCH
suffix:colon
id|usage-&gt;hat_min
op_assign
id|field-&gt;logical_minimum
suffix:semicolon
id|usage-&gt;hat_max
op_assign
id|field-&gt;logical_maximum
suffix:semicolon
id|map_abs
c_func
(paren
id|ABS_HAT0X
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HID_GD_START
suffix:colon
id|map_key_clear
c_func
(paren
id|BTN_START
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HID_GD_SELECT
suffix:colon
id|map_key_clear
c_func
(paren
id|BTN_SELECT
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_goto
id|unknown
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|HID_UP_LED
suffix:colon
id|map_led
c_func
(paren
(paren
id|usage-&gt;hid
op_minus
l_int|1
)paren
op_amp
l_int|0xf
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|HID_UP_DIGITIZER
suffix:colon
r_switch
c_cond
(paren
id|usage-&gt;hid
op_amp
l_int|0xff
)paren
(brace
r_case
l_int|0x30
suffix:colon
multiline_comment|/* TipPressure */
r_if
c_cond
(paren
op_logical_neg
id|test_bit
c_func
(paren
id|BTN_TOUCH
comma
id|input-&gt;keybit
)paren
)paren
(brace
id|device-&gt;quirks
op_or_assign
id|HID_QUIRK_NOTOUCH
suffix:semicolon
id|set_bit
c_func
(paren
id|EV_KEY
comma
id|input-&gt;evbit
)paren
suffix:semicolon
id|set_bit
c_func
(paren
id|BTN_TOUCH
comma
id|input-&gt;keybit
)paren
suffix:semicolon
)brace
id|map_abs_clear
c_func
(paren
id|ABS_PRESSURE
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x32
suffix:colon
multiline_comment|/* InRange */
r_switch
c_cond
(paren
id|field-&gt;physical
op_amp
l_int|0xff
)paren
(brace
r_case
l_int|0x21
suffix:colon
id|map_key
c_func
(paren
id|BTN_TOOL_MOUSE
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x22
suffix:colon
id|map_key
c_func
(paren
id|BTN_TOOL_FINGER
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|map_key
c_func
(paren
id|BTN_TOOL_PEN
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
l_int|0x3c
suffix:colon
multiline_comment|/* Invert */
id|map_key_clear
c_func
(paren
id|BTN_TOOL_RUBBER
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x33
suffix:colon
multiline_comment|/* Touch */
r_case
l_int|0x42
suffix:colon
multiline_comment|/* TipSwitch */
r_case
l_int|0x43
suffix:colon
multiline_comment|/* TipSwitch2 */
id|device-&gt;quirks
op_and_assign
op_complement
id|HID_QUIRK_NOTOUCH
suffix:semicolon
id|map_key_clear
c_func
(paren
id|BTN_TOUCH
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x44
suffix:colon
multiline_comment|/* BarrelSwitch */
id|map_key_clear
c_func
(paren
id|BTN_STYLUS
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_goto
id|unknown
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|HID_UP_CONSUMER
suffix:colon
multiline_comment|/* USB HUT v1.1, pages 56-62 */
id|set_bit
c_func
(paren
id|EV_REP
comma
id|input-&gt;evbit
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|usage-&gt;hid
op_amp
id|HID_USAGE
)paren
(brace
r_case
l_int|0x000
suffix:colon
r_goto
id|ignore
suffix:semicolon
r_case
l_int|0x034
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_SLEEP
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x036
suffix:colon
id|map_key_clear
c_func
(paren
id|BTN_MISC
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x08a
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_WWW
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x095
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_HELP
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x0b0
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_PLAY
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x0b1
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_PAUSE
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x0b2
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_RECORD
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x0b3
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_FASTFORWARD
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x0b4
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_REWIND
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x0b5
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_NEXTSONG
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x0b6
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_PREVIOUSSONG
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x0b7
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_STOPCD
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x0b8
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_EJECTCD
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x0cd
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_PLAYPAUSE
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x0e0
suffix:colon
id|map_abs_clear
c_func
(paren
id|ABS_VOLUME
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x0e2
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_MUTE
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x0e5
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_BASSBOOST
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x0e9
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_VOLUMEUP
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x0ea
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_VOLUMEDOWN
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x183
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_CONFIG
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x18a
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_MAIL
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x192
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_CALC
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x194
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_FILE
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x21a
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_UNDO
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x21b
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_COPY
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x21c
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_CUT
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x21d
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_PASTE
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x221
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_FIND
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x223
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_HOMEPAGE
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x224
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_BACK
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x225
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_FORWARD
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x226
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_STOP
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x227
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_REFRESH
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x22a
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_BOOKMARKS
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_goto
id|unknown
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|HID_UP_HPVENDOR
suffix:colon
multiline_comment|/* Reported on a Dutch layout HP5308 */
id|set_bit
c_func
(paren
id|EV_REP
comma
id|input-&gt;evbit
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|usage-&gt;hid
op_amp
id|HID_USAGE
)paren
(brace
r_case
l_int|0x021
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_PRINT
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x070
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_HP
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x071
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_CAMERA
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x072
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_SOUND
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x073
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_QUESTION
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x080
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_EMAIL
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x081
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_CHAT
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x082
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_SEARCH
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x083
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_CONNECT
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x084
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_FINANCE
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x085
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_SPORT
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x086
suffix:colon
id|map_key_clear
c_func
(paren
id|KEY_SHOP
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_goto
id|unknown
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|HID_UP_PID
suffix:colon
id|set_bit
c_func
(paren
id|EV_FF
comma
id|input-&gt;evbit
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|usage-&gt;hid
op_amp
id|HID_USAGE
)paren
(brace
r_case
l_int|0x26
suffix:colon
id|map_ff_effect
c_func
(paren
id|FF_CONSTANT
)paren
suffix:semicolon
r_goto
id|ignore
suffix:semicolon
r_case
l_int|0x27
suffix:colon
id|map_ff_effect
c_func
(paren
id|FF_RAMP
)paren
suffix:semicolon
r_goto
id|ignore
suffix:semicolon
r_case
l_int|0x28
suffix:colon
id|map_ff_effect
c_func
(paren
id|FF_CUSTOM
)paren
suffix:semicolon
r_goto
id|ignore
suffix:semicolon
r_case
l_int|0x30
suffix:colon
id|map_ff_effect
c_func
(paren
id|FF_SQUARE
)paren
suffix:semicolon
id|map_ff_effect
c_func
(paren
id|FF_PERIODIC
)paren
suffix:semicolon
r_goto
id|ignore
suffix:semicolon
r_case
l_int|0x31
suffix:colon
id|map_ff_effect
c_func
(paren
id|FF_SINE
)paren
suffix:semicolon
id|map_ff_effect
c_func
(paren
id|FF_PERIODIC
)paren
suffix:semicolon
r_goto
id|ignore
suffix:semicolon
r_case
l_int|0x32
suffix:colon
id|map_ff_effect
c_func
(paren
id|FF_TRIANGLE
)paren
suffix:semicolon
id|map_ff_effect
c_func
(paren
id|FF_PERIODIC
)paren
suffix:semicolon
r_goto
id|ignore
suffix:semicolon
r_case
l_int|0x33
suffix:colon
id|map_ff_effect
c_func
(paren
id|FF_SAW_UP
)paren
suffix:semicolon
id|map_ff_effect
c_func
(paren
id|FF_PERIODIC
)paren
suffix:semicolon
r_goto
id|ignore
suffix:semicolon
r_case
l_int|0x34
suffix:colon
id|map_ff_effect
c_func
(paren
id|FF_SAW_DOWN
)paren
suffix:semicolon
id|map_ff_effect
c_func
(paren
id|FF_PERIODIC
)paren
suffix:semicolon
r_goto
id|ignore
suffix:semicolon
r_case
l_int|0x40
suffix:colon
id|map_ff_effect
c_func
(paren
id|FF_SPRING
)paren
suffix:semicolon
r_goto
id|ignore
suffix:semicolon
r_case
l_int|0x41
suffix:colon
id|map_ff_effect
c_func
(paren
id|FF_DAMPER
)paren
suffix:semicolon
r_goto
id|ignore
suffix:semicolon
r_case
l_int|0x42
suffix:colon
id|map_ff_effect
c_func
(paren
id|FF_INERTIA
)paren
suffix:semicolon
r_goto
id|ignore
suffix:semicolon
r_case
l_int|0x43
suffix:colon
id|map_ff_effect
c_func
(paren
id|FF_FRICTION
)paren
suffix:semicolon
r_goto
id|ignore
suffix:semicolon
r_case
l_int|0x7e
suffix:colon
id|map_ff
c_func
(paren
id|FF_GAIN
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x83
suffix:colon
id|input-&gt;ff_effects_max
op_assign
id|field-&gt;value
(braket
l_int|0
)braket
suffix:semicolon
r_goto
id|ignore
suffix:semicolon
r_case
l_int|0x98
suffix:colon
id|map_ff
c_func
(paren
id|FF_AUTOCENTER
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0xa4
suffix:colon
id|map_key_clear
c_func
(paren
id|BTN_DEAD
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_goto
id|ignore
suffix:semicolon
)brace
r_break
suffix:semicolon
r_default
suffix:colon
(brace
)brace
id|unknown
suffix:colon
r_if
c_cond
(paren
id|field-&gt;report_size
op_eq
l_int|1
)paren
(brace
r_if
c_cond
(paren
id|field-&gt;report-&gt;type
op_eq
id|HID_OUTPUT_REPORT
)paren
(brace
id|map_led
c_func
(paren
id|LED_MISC
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|map_key
c_func
(paren
id|BTN_MISC
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|field-&gt;flags
op_amp
id|HID_MAIN_ITEM_RELATIVE
)paren
(brace
id|map_rel
c_func
(paren
id|REL_MISC
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|map_abs
c_func
(paren
id|ABS_MISC
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|set_bit
c_func
(paren
id|usage-&gt;type
comma
id|input-&gt;evbit
)paren
suffix:semicolon
r_while
c_loop
(paren
id|usage-&gt;code
op_le
id|max
op_logical_and
id|test_and_set_bit
c_func
(paren
id|usage-&gt;code
comma
id|bit
)paren
)paren
id|usage-&gt;code
op_assign
id|find_next_zero_bit
c_func
(paren
id|bit
comma
id|max
op_plus
l_int|1
comma
id|usage-&gt;code
)paren
suffix:semicolon
r_if
c_cond
(paren
id|usage-&gt;code
OG
id|max
)paren
r_goto
id|ignore
suffix:semicolon
r_if
c_cond
(paren
(paren
id|device-&gt;quirks
op_amp
(paren
id|HID_QUIRK_2WHEEL_MOUSE_HACK_7
op_or
id|HID_QUIRK_2WHEEL_MOUSE_HACK_5
)paren
)paren
op_logical_and
(paren
id|usage-&gt;type
op_eq
id|EV_REL
)paren
op_logical_and
(paren
id|usage-&gt;code
op_eq
id|REL_WHEEL
)paren
)paren
id|set_bit
c_func
(paren
id|REL_HWHEEL
comma
id|bit
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
(paren
id|device-&gt;quirks
op_amp
id|HID_QUIRK_2WHEEL_MOUSE_HACK_5
)paren
op_logical_and
(paren
id|usage-&gt;hid
op_eq
l_int|0x00090005
)paren
)paren
op_logical_or
(paren
(paren
id|device-&gt;quirks
op_amp
id|HID_QUIRK_2WHEEL_MOUSE_HACK_7
)paren
op_logical_and
(paren
id|usage-&gt;hid
op_eq
l_int|0x00090007
)paren
)paren
)paren
r_goto
id|ignore
suffix:semicolon
r_if
c_cond
(paren
id|usage-&gt;type
op_eq
id|EV_ABS
)paren
(brace
r_int
id|a
op_assign
id|field-&gt;logical_minimum
suffix:semicolon
r_int
id|b
op_assign
id|field-&gt;logical_maximum
suffix:semicolon
r_if
c_cond
(paren
(paren
id|device-&gt;quirks
op_amp
id|HID_QUIRK_BADPAD
)paren
op_logical_and
(paren
id|usage-&gt;code
op_eq
id|ABS_X
op_logical_or
id|usage-&gt;code
op_eq
id|ABS_Y
)paren
)paren
(brace
id|a
op_assign
id|field-&gt;logical_minimum
op_assign
l_int|0
suffix:semicolon
id|b
op_assign
id|field-&gt;logical_maximum
op_assign
l_int|255
suffix:semicolon
)brace
r_if
c_cond
(paren
id|field-&gt;application
op_eq
id|HID_GD_GAMEPAD
op_logical_or
id|field-&gt;application
op_eq
id|HID_GD_JOYSTICK
)paren
id|input_set_abs_params
c_func
(paren
id|input
comma
id|usage-&gt;code
comma
id|a
comma
id|b
comma
(paren
id|b
op_minus
id|a
)paren
op_rshift
l_int|8
comma
(paren
id|b
op_minus
id|a
)paren
op_rshift
l_int|4
)paren
suffix:semicolon
r_else
id|input_set_abs_params
c_func
(paren
id|input
comma
id|usage-&gt;code
comma
id|a
comma
id|b
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|usage-&gt;hat_min
OL
id|usage-&gt;hat_max
op_logical_or
id|usage-&gt;hat_dir
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
id|usage-&gt;code
suffix:semicolon
id|i
OL
id|usage-&gt;code
op_plus
l_int|2
op_logical_and
id|i
op_le
id|max
suffix:semicolon
id|i
op_increment
)paren
(brace
id|input_set_abs_params
c_func
(paren
id|input
comma
id|i
comma
op_minus
l_int|1
comma
l_int|1
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
id|set_bit
c_func
(paren
id|i
comma
id|input-&gt;absbit
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|usage-&gt;hat_dir
op_logical_and
op_logical_neg
id|field-&gt;dpad
)paren
id|field-&gt;dpad
op_assign
id|usage-&gt;code
suffix:semicolon
)brace
macro_line|#ifdef DEBUG
id|resolv_event
c_func
(paren
id|usage-&gt;type
comma
id|usage-&gt;code
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
macro_line|#endif
r_return
suffix:semicolon
id|ignore
suffix:colon
macro_line|#ifdef DEBUG
id|printk
c_func
(paren
l_string|&quot;IGNORED&bslash;n&quot;
)paren
suffix:semicolon
macro_line|#endif
r_return
suffix:semicolon
)brace
DECL|function|hidinput_hid_event
r_void
id|hidinput_hid_event
c_func
(paren
r_struct
id|hid_device
op_star
id|hid
comma
r_struct
id|hid_field
op_star
id|field
comma
r_struct
id|hid_usage
op_star
id|usage
comma
id|__s32
id|value
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
r_struct
id|input_dev
op_star
id|input
op_assign
op_amp
id|field-&gt;hidinput-&gt;input
suffix:semicolon
r_int
op_star
id|quirks
op_assign
op_amp
id|hid-&gt;quirks
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|input
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|usage-&gt;type
)paren
r_return
suffix:semicolon
id|input_regs
c_func
(paren
id|input
comma
id|regs
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
(paren
id|hid-&gt;quirks
op_amp
id|HID_QUIRK_2WHEEL_MOUSE_HACK_5
)paren
op_logical_and
(paren
id|usage-&gt;hid
op_eq
l_int|0x00090005
)paren
)paren
op_logical_or
(paren
(paren
id|hid-&gt;quirks
op_amp
id|HID_QUIRK_2WHEEL_MOUSE_HACK_7
)paren
op_logical_and
(paren
id|usage-&gt;hid
op_eq
l_int|0x00090007
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
id|value
)paren
id|hid-&gt;quirks
op_or_assign
id|HID_QUIRK_2WHEEL_MOUSE_HACK_ON
suffix:semicolon
r_else
id|hid-&gt;quirks
op_and_assign
op_complement
id|HID_QUIRK_2WHEEL_MOUSE_HACK_ON
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|hid-&gt;quirks
op_amp
id|HID_QUIRK_2WHEEL_MOUSE_HACK_ON
)paren
op_logical_and
(paren
id|usage-&gt;code
op_eq
id|REL_WHEEL
)paren
)paren
(brace
id|input_event
c_func
(paren
id|input
comma
id|usage-&gt;type
comma
id|REL_HWHEEL
comma
id|value
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|usage-&gt;hat_min
OL
id|usage-&gt;hat_max
op_logical_or
id|usage-&gt;hat_dir
)paren
(brace
r_int
id|hat_dir
op_assign
id|usage-&gt;hat_dir
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|hat_dir
)paren
id|hat_dir
op_assign
(paren
id|value
op_minus
id|usage-&gt;hat_min
)paren
op_star
l_int|8
op_div
(paren
id|usage-&gt;hat_max
op_minus
id|usage-&gt;hat_min
op_plus
l_int|1
)paren
op_plus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|hat_dir
template_param
l_int|8
)paren
id|hat_dir
op_assign
l_int|0
suffix:semicolon
id|input_event
c_func
(paren
id|input
comma
id|usage-&gt;type
comma
id|usage-&gt;code
comma
id|hid_hat_to_axis
(braket
id|hat_dir
)braket
dot
id|x
)paren
suffix:semicolon
id|input_event
c_func
(paren
id|input
comma
id|usage-&gt;type
comma
id|usage-&gt;code
op_plus
l_int|1
comma
id|hid_hat_to_axis
(braket
id|hat_dir
)braket
dot
id|y
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|usage-&gt;hid
op_eq
(paren
id|HID_UP_DIGITIZER
op_or
l_int|0x003c
)paren
)paren
(brace
multiline_comment|/* Invert */
op_star
id|quirks
op_assign
id|value
ques
c_cond
(paren
op_star
id|quirks
op_or
id|HID_QUIRK_INVERT
)paren
suffix:colon
(paren
op_star
id|quirks
op_amp
op_complement
id|HID_QUIRK_INVERT
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|usage-&gt;hid
op_eq
(paren
id|HID_UP_DIGITIZER
op_or
l_int|0x0032
)paren
)paren
(brace
multiline_comment|/* InRange */
r_if
c_cond
(paren
id|value
)paren
(brace
id|input_event
c_func
(paren
id|input
comma
id|usage-&gt;type
comma
(paren
op_star
id|quirks
op_amp
id|HID_QUIRK_INVERT
)paren
ques
c_cond
id|BTN_TOOL_RUBBER
suffix:colon
id|usage-&gt;code
comma
l_int|1
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|input_event
c_func
(paren
id|input
comma
id|usage-&gt;type
comma
id|usage-&gt;code
comma
l_int|0
)paren
suffix:semicolon
id|input_event
c_func
(paren
id|input
comma
id|usage-&gt;type
comma
id|BTN_TOOL_RUBBER
comma
l_int|0
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|usage-&gt;hid
op_eq
(paren
id|HID_UP_DIGITIZER
op_or
l_int|0x0030
)paren
op_logical_and
(paren
op_star
id|quirks
op_amp
id|HID_QUIRK_NOTOUCH
)paren
)paren
(brace
multiline_comment|/* Pressure */
r_int
id|a
op_assign
id|field-&gt;logical_minimum
suffix:semicolon
r_int
id|b
op_assign
id|field-&gt;logical_maximum
suffix:semicolon
id|input_event
c_func
(paren
id|input
comma
id|EV_KEY
comma
id|BTN_TOUCH
comma
id|value
OG
id|a
op_plus
(paren
(paren
id|b
op_minus
id|a
)paren
op_rshift
l_int|3
)paren
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|usage-&gt;hid
op_eq
(paren
id|HID_UP_PID
op_or
l_int|0x83UL
)paren
)paren
(brace
multiline_comment|/* Simultaneous Effects Max */
id|input-&gt;ff_effects_max
op_assign
id|value
suffix:semicolon
id|dbg
c_func
(paren
l_string|&quot;Maximum Effects - %d&quot;
comma
id|input-&gt;ff_effects_max
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|usage-&gt;hid
op_eq
(paren
id|HID_UP_PID
op_or
l_int|0x7fUL
)paren
)paren
(brace
id|dbg
c_func
(paren
l_string|&quot;PID Pool Report&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|usage-&gt;type
op_eq
id|EV_KEY
)paren
op_logical_and
(paren
id|usage-&gt;code
op_eq
l_int|0
)paren
)paren
(brace
multiline_comment|/* Key 0 is &quot;unassigned&quot;, not KEY_UNKNOWN */
r_return
suffix:semicolon
)brace
id|input_event
c_func
(paren
id|input
comma
id|usage-&gt;type
comma
id|usage-&gt;code
comma
id|value
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|field-&gt;flags
op_amp
id|HID_MAIN_ITEM_RELATIVE
)paren
op_logical_and
(paren
id|usage-&gt;type
op_eq
id|EV_KEY
)paren
)paren
id|input_event
c_func
(paren
id|input
comma
id|usage-&gt;type
comma
id|usage-&gt;code
comma
l_int|0
)paren
suffix:semicolon
)brace
DECL|function|hidinput_report_event
r_void
id|hidinput_report_event
c_func
(paren
r_struct
id|hid_device
op_star
id|hid
comma
r_struct
id|hid_report
op_star
id|report
)paren
(brace
r_struct
id|list_head
op_star
id|lh
suffix:semicolon
r_struct
id|hid_input
op_star
id|hidinput
suffix:semicolon
id|list_for_each
(paren
id|lh
comma
op_amp
id|hid-&gt;inputs
)paren
(brace
id|hidinput
op_assign
id|list_entry
c_func
(paren
id|lh
comma
r_struct
id|hid_input
comma
id|list
)paren
suffix:semicolon
id|input_sync
c_func
(paren
op_amp
id|hidinput-&gt;input
)paren
suffix:semicolon
)brace
)brace
DECL|function|hidinput_input_event
r_static
r_int
id|hidinput_input_event
c_func
(paren
r_struct
id|input_dev
op_star
id|dev
comma
r_int
r_int
id|type
comma
r_int
r_int
id|code
comma
r_int
id|value
)paren
(brace
r_struct
id|hid_device
op_star
id|hid
op_assign
id|dev
op_member_access_from_pointer
r_private
suffix:semicolon
r_struct
id|hid_field
op_star
id|field
op_assign
l_int|NULL
suffix:semicolon
r_int
id|offset
suffix:semicolon
r_if
c_cond
(paren
id|type
op_eq
id|EV_FF
)paren
r_return
id|hid_ff_event
c_func
(paren
id|hid
comma
id|dev
comma
id|type
comma
id|code
comma
id|value
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|offset
op_assign
id|hid_find_field
c_func
(paren
id|hid
comma
id|type
comma
id|code
comma
op_amp
id|field
)paren
)paren
op_eq
op_minus
l_int|1
)paren
(brace
id|warn
c_func
(paren
l_string|&quot;event field not found&quot;
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
id|hid_set_field
c_func
(paren
id|field
comma
id|offset
comma
id|value
)paren
suffix:semicolon
id|hid_submit_report
c_func
(paren
id|hid
comma
id|field-&gt;report
comma
id|USB_DIR_OUT
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|hidinput_open
r_static
r_int
id|hidinput_open
c_func
(paren
r_struct
id|input_dev
op_star
id|dev
)paren
(brace
r_struct
id|hid_device
op_star
id|hid
op_assign
id|dev
op_member_access_from_pointer
r_private
suffix:semicolon
r_return
id|hid_open
c_func
(paren
id|hid
)paren
suffix:semicolon
)brace
DECL|function|hidinput_close
r_static
r_void
id|hidinput_close
c_func
(paren
r_struct
id|input_dev
op_star
id|dev
)paren
(brace
r_struct
id|hid_device
op_star
id|hid
op_assign
id|dev
op_member_access_from_pointer
r_private
suffix:semicolon
id|hid_close
c_func
(paren
id|hid
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Register the input device; print a message.&n; * Configure the input layer interface&n; * Read all reports and initialize the absolute field values.&n; */
DECL|function|hidinput_connect
r_int
id|hidinput_connect
c_func
(paren
r_struct
id|hid_device
op_star
id|hid
)paren
(brace
r_struct
id|usb_device
op_star
id|dev
op_assign
id|hid-&gt;dev
suffix:semicolon
r_struct
id|hid_report_enum
op_star
id|report_enum
suffix:semicolon
r_struct
id|hid_report
op_star
id|report
suffix:semicolon
r_struct
id|list_head
op_star
id|list
suffix:semicolon
r_struct
id|hid_input
op_star
id|hidinput
op_assign
l_int|NULL
suffix:semicolon
r_int
id|i
comma
id|j
comma
id|k
suffix:semicolon
id|INIT_LIST_HEAD
c_func
(paren
op_amp
id|hid-&gt;inputs
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|hid-&gt;maxcollection
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|hid-&gt;collection
(braket
id|i
)braket
dot
id|type
op_eq
id|HID_COLLECTION_APPLICATION
op_logical_or
id|hid-&gt;collection
(braket
id|i
)braket
dot
id|type
op_eq
id|HID_COLLECTION_PHYSICAL
)paren
r_if
c_cond
(paren
id|IS_INPUT_APPLICATION
c_func
(paren
id|hid-&gt;collection
(braket
id|i
)braket
dot
id|usage
)paren
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
id|i
op_eq
id|hid-&gt;maxcollection
)paren
r_return
op_minus
l_int|1
suffix:semicolon
r_for
c_loop
(paren
id|k
op_assign
id|HID_INPUT_REPORT
suffix:semicolon
id|k
op_le
id|HID_OUTPUT_REPORT
suffix:semicolon
id|k
op_increment
)paren
(brace
id|report_enum
op_assign
id|hid-&gt;report_enum
op_plus
id|k
suffix:semicolon
id|list
op_assign
id|report_enum-&gt;report_list.next
suffix:semicolon
r_while
c_loop
(paren
id|list
op_ne
op_amp
id|report_enum-&gt;report_list
)paren
(brace
id|report
op_assign
(paren
r_struct
id|hid_report
op_star
)paren
id|list
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|report-&gt;maxfield
)paren
(brace
id|list
op_assign
id|list-&gt;next
suffix:semicolon
r_continue
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|hidinput
)paren
(brace
id|hidinput
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
op_star
id|hidinput
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|hidinput
)paren
(brace
id|err
c_func
(paren
l_string|&quot;Out of memory during hid input probe&quot;
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
id|memset
c_func
(paren
id|hidinput
comma
l_int|0
comma
r_sizeof
(paren
op_star
id|hidinput
)paren
)paren
suffix:semicolon
id|list_add_tail
c_func
(paren
op_amp
id|hidinput-&gt;list
comma
op_amp
id|hid-&gt;inputs
)paren
suffix:semicolon
id|hidinput-&gt;input
dot
r_private
op_assign
id|hid
suffix:semicolon
id|hidinput-&gt;input.event
op_assign
id|hidinput_input_event
suffix:semicolon
id|hidinput-&gt;input.open
op_assign
id|hidinput_open
suffix:semicolon
id|hidinput-&gt;input.close
op_assign
id|hidinput_close
suffix:semicolon
id|hidinput-&gt;input.name
op_assign
id|hid-&gt;name
suffix:semicolon
id|hidinput-&gt;input.phys
op_assign
id|hid-&gt;phys
suffix:semicolon
id|hidinput-&gt;input.uniq
op_assign
id|hid-&gt;uniq
suffix:semicolon
id|hidinput-&gt;input.id.bustype
op_assign
id|BUS_USB
suffix:semicolon
id|hidinput-&gt;input.id.vendor
op_assign
id|le16_to_cpu
c_func
(paren
id|dev-&gt;descriptor.idVendor
)paren
suffix:semicolon
id|hidinput-&gt;input.id.product
op_assign
id|le16_to_cpu
c_func
(paren
id|dev-&gt;descriptor.idProduct
)paren
suffix:semicolon
id|hidinput-&gt;input.id.version
op_assign
id|le16_to_cpu
c_func
(paren
id|dev-&gt;descriptor.bcdDevice
)paren
suffix:semicolon
id|hidinput-&gt;input.dev
op_assign
op_amp
id|hid-&gt;intf-&gt;dev
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|report-&gt;maxfield
suffix:semicolon
id|i
op_increment
)paren
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
id|report-&gt;field
(braket
id|i
)braket
op_member_access_from_pointer
id|maxusage
suffix:semicolon
id|j
op_increment
)paren
id|hidinput_configure_usage
c_func
(paren
id|hidinput
comma
id|report-&gt;field
(braket
id|i
)braket
comma
id|report-&gt;field
(braket
id|i
)braket
op_member_access_from_pointer
id|usage
op_plus
id|j
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hid-&gt;quirks
op_amp
id|HID_QUIRK_MULTI_INPUT
)paren
(brace
multiline_comment|/* This will leave hidinput NULL, so that it&n;&t;&t;&t;&t; * allocates another one if we have more inputs on&n;&t;&t;&t;&t; * the same interface. Some devices (e.g. Happ&squot;s&n;&t;&t;&t;&t; * UGCI) cram a lot of unrelated inputs into the&n;&t;&t;&t;&t; * same interface. */
id|hidinput-&gt;report
op_assign
id|report
suffix:semicolon
id|input_register_device
c_func
(paren
op_amp
id|hidinput-&gt;input
)paren
suffix:semicolon
id|hidinput
op_assign
l_int|NULL
suffix:semicolon
)brace
id|list
op_assign
id|list-&gt;next
suffix:semicolon
)brace
)brace
multiline_comment|/* This only gets called when we are a single-input (most of the&n;&t; * time). IOW, not a HID_QUIRK_MULTI_INPUT. The hid_ff_init() is&n;&t; * only useful in this case, and not for multi-input quirks. */
r_if
c_cond
(paren
id|hidinput
)paren
(brace
id|hid_ff_init
c_func
(paren
id|hid
)paren
suffix:semicolon
id|input_register_device
c_func
(paren
op_amp
id|hidinput-&gt;input
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|hidinput_disconnect
r_void
id|hidinput_disconnect
c_func
(paren
r_struct
id|hid_device
op_star
id|hid
)paren
(brace
r_struct
id|list_head
op_star
id|lh
comma
op_star
id|next
suffix:semicolon
r_struct
id|hid_input
op_star
id|hidinput
suffix:semicolon
id|list_for_each_safe
(paren
id|lh
comma
id|next
comma
op_amp
id|hid-&gt;inputs
)paren
(brace
id|hidinput
op_assign
id|list_entry
c_func
(paren
id|lh
comma
r_struct
id|hid_input
comma
id|list
)paren
suffix:semicolon
id|input_unregister_device
c_func
(paren
op_amp
id|hidinput-&gt;input
)paren
suffix:semicolon
id|list_del
c_func
(paren
op_amp
id|hidinput-&gt;list
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|hidinput
)paren
suffix:semicolon
)brace
)brace
eof
