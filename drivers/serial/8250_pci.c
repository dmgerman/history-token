multiline_comment|/*&n; *  linux/drivers/char/8250_pci.c&n; *&n; *  Probe module for 8250/16550-type PCI serial ports.&n; *&n; *  Based on drivers/char/serial.c, by Linus Torvalds, Theodore Ts&squot;o.&n; *&n; *  Copyright (C) 2001 Russell King, All Rights Reserved.&n; *&n; * This program is free software; you can redistribute it and/or modify&n; * it under the terms of the GNU General Public License as published by&n; * the Free Software Foundation; either version 2 of the License.&n; *&n; *  $Id: 8250_pci.c,v 1.24 2002/07/29 14:39:56 rmk Exp $&n; */
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/pci.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/string.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;linux/serial.h&gt;
multiline_comment|/* 2.4.6 compatibility cruft - to be removed with the old serial.c code */
DECL|macro|pci_board
mdefine_line|#define pci_board __pci_board
macro_line|#include &lt;linux/serialP.h&gt;
DECL|macro|pci_board
macro_line|#undef pci_board
macro_line|#include &lt;asm/bitops.h&gt;
macro_line|#include &lt;asm/byteorder.h&gt;
macro_line|#include &lt;asm/serial.h&gt;
macro_line|#include &lt;asm/io.h&gt;
macro_line|#include &quot;8250.h&quot;
macro_line|#ifndef IS_PCI_REGION_IOPORT
DECL|macro|IS_PCI_REGION_IOPORT
mdefine_line|#define IS_PCI_REGION_IOPORT(dev, r) (pci_resource_flags((dev), (r)) &amp; &bslash;&n;&t;&t;&t;&t;      IORESOURCE_IO)
macro_line|#endif
macro_line|#ifndef IS_PCI_REGION_IOMEM
DECL|macro|IS_PCI_REGION_IOMEM
mdefine_line|#define IS_PCI_REGION_IOMEM(dev, r) (pci_resource_flags((dev), (r)) &amp; &bslash;&n;&t;&t;&t;&t;      IORESOURCE_MEM)
macro_line|#endif
macro_line|#ifndef PCI_IRQ_RESOURCE
DECL|macro|PCI_IRQ_RESOURCE
mdefine_line|#define PCI_IRQ_RESOURCE(dev, r) ((dev)-&gt;irq_resource[r].start)
macro_line|#endif
macro_line|#ifndef pci_get_subvendor
DECL|macro|pci_get_subvendor
mdefine_line|#define pci_get_subvendor(dev) ((dev)-&gt;subsystem_vendor)
DECL|macro|pci_get_subdevice
mdefine_line|#define pci_get_subdevice(dev)  ((dev)-&gt;subsystem_device)
macro_line|#endif
DECL|struct|serial_private
r_struct
id|serial_private
(brace
DECL|member|nr
r_int
r_int
id|nr
suffix:semicolon
DECL|member|board
r_struct
id|pci_board
op_star
id|board
suffix:semicolon
DECL|member|line
r_int
id|line
(braket
l_int|0
)braket
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|pci_board
r_struct
id|pci_board
(brace
DECL|member|flags
r_int
id|flags
suffix:semicolon
DECL|member|num_ports
r_int
id|num_ports
suffix:semicolon
DECL|member|base_baud
r_int
id|base_baud
suffix:semicolon
DECL|member|uart_offset
r_int
id|uart_offset
suffix:semicolon
DECL|member|reg_shift
r_int
id|reg_shift
suffix:semicolon
DECL|member|init_fn
r_int
(paren
op_star
id|init_fn
)paren
(paren
r_struct
id|pci_dev
op_star
id|dev
comma
r_struct
id|pci_board
op_star
id|board
comma
r_int
id|enable
)paren
suffix:semicolon
DECL|member|first_uart_offset
r_int
id|first_uart_offset
suffix:semicolon
)brace
suffix:semicolon
r_static
r_int
DECL|function|get_pci_port
id|get_pci_port
c_func
(paren
r_struct
id|pci_dev
op_star
id|dev
comma
r_struct
id|pci_board
op_star
id|board
comma
r_struct
id|serial_struct
op_star
id|req
comma
r_int
id|idx
)paren
(brace
r_int
r_int
id|port
suffix:semicolon
r_int
id|base_idx
suffix:semicolon
r_int
id|max_port
suffix:semicolon
r_int
id|offset
suffix:semicolon
id|base_idx
op_assign
id|SPCI_FL_GET_BASE
c_func
(paren
id|board-&gt;flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|board-&gt;flags
op_amp
id|SPCI_FL_BASE_TABLE
)paren
id|base_idx
op_add_assign
id|idx
suffix:semicolon
r_if
c_cond
(paren
id|board-&gt;flags
op_amp
id|SPCI_FL_REGION_SZ_CAP
)paren
(brace
id|max_port
op_assign
id|pci_resource_len
c_func
(paren
id|dev
comma
id|base_idx
)paren
op_div
l_int|8
suffix:semicolon
r_if
c_cond
(paren
id|idx
op_ge
id|max_port
)paren
r_return
l_int|1
suffix:semicolon
)brace
id|offset
op_assign
id|board-&gt;first_uart_offset
suffix:semicolon
multiline_comment|/*&n;&t; * Timedia/SUNIX uses a mixture of BARs and offsets&n;&t; * Ugh, this is ugly as all hell --- TYT&n;&t; */
r_if
c_cond
(paren
id|dev-&gt;vendor
op_eq
id|PCI_VENDOR_ID_TIMEDIA
)paren
r_switch
c_cond
(paren
id|idx
)paren
(brace
r_case
l_int|0
suffix:colon
id|base_idx
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|base_idx
op_assign
l_int|0
suffix:semicolon
id|offset
op_assign
l_int|8
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|base_idx
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
id|base_idx
op_assign
l_int|1
suffix:semicolon
id|offset
op_assign
l_int|8
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|4
suffix:colon
multiline_comment|/* BAR 2 */
r_case
l_int|5
suffix:colon
multiline_comment|/* BAR 3 */
r_case
l_int|6
suffix:colon
multiline_comment|/* BAR 4 */
r_case
l_int|7
suffix:colon
multiline_comment|/* BAR 5 */
id|base_idx
op_assign
id|idx
op_minus
l_int|2
suffix:semicolon
)brace
multiline_comment|/* AFAVLAB uses a different mixture of BARs and offsets */
multiline_comment|/* Not that ugly ;) -- HW */
r_if
c_cond
(paren
id|dev-&gt;vendor
op_eq
id|PCI_VENDOR_ID_AFAVLAB
op_logical_and
id|idx
op_ge
l_int|4
)paren
(brace
id|base_idx
op_assign
l_int|4
suffix:semicolon
id|offset
op_assign
(paren
id|idx
op_minus
l_int|4
)paren
op_star
l_int|8
suffix:semicolon
)brace
multiline_comment|/* Some Titan cards are also a little weird */
r_if
c_cond
(paren
id|dev-&gt;vendor
op_eq
id|PCI_VENDOR_ID_TITAN
op_logical_and
(paren
id|dev-&gt;device
op_eq
id|PCI_DEVICE_ID_TITAN_400L
op_logical_or
id|dev-&gt;device
op_eq
id|PCI_DEVICE_ID_TITAN_800L
)paren
)paren
(brace
r_switch
c_cond
(paren
id|idx
)paren
(brace
r_case
l_int|0
suffix:colon
id|base_idx
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|base_idx
op_assign
l_int|2
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|base_idx
op_assign
l_int|4
suffix:semicolon
id|offset
op_assign
l_int|8
op_star
(paren
id|idx
op_minus
l_int|2
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/* HP&squot;s Diva chip puts the 4th/5th serial port further out, and&n;&t; * some serial ports are supposed to be hidden on certain models.&n;&t; */
r_if
c_cond
(paren
id|dev-&gt;vendor
op_eq
id|PCI_VENDOR_ID_HP
op_logical_and
id|dev-&gt;device
op_eq
id|PCI_DEVICE_ID_HP_DIVA
)paren
(brace
r_switch
c_cond
(paren
id|dev-&gt;subsystem_device
)paren
(brace
r_case
id|PCI_DEVICE_ID_HP_DIVA_MAESTRO
suffix:colon
r_if
c_cond
(paren
id|idx
op_eq
l_int|3
)paren
id|idx
op_increment
suffix:semicolon
r_break
suffix:semicolon
r_case
id|PCI_DEVICE_ID_HP_DIVA_EVEREST
suffix:colon
r_if
c_cond
(paren
id|idx
OG
l_int|0
)paren
id|idx
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|idx
OG
l_int|2
)paren
id|idx
op_increment
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|idx
OG
l_int|2
)paren
(brace
id|offset
op_assign
l_int|0x18
suffix:semicolon
)brace
)brace
id|port
op_assign
id|pci_resource_start
c_func
(paren
id|dev
comma
id|base_idx
)paren
op_plus
id|offset
suffix:semicolon
r_if
c_cond
(paren
(paren
id|board-&gt;flags
op_amp
id|SPCI_FL_BASE_TABLE
)paren
op_eq
l_int|0
)paren
id|port
op_add_assign
id|idx
op_star
(paren
id|board-&gt;uart_offset
ques
c_cond
id|board-&gt;uart_offset
suffix:colon
l_int|8
)paren
suffix:semicolon
r_if
c_cond
(paren
id|IS_PCI_REGION_IOPORT
c_func
(paren
id|dev
comma
id|base_idx
)paren
)paren
(brace
id|req-&gt;port
op_assign
id|port
suffix:semicolon
r_if
c_cond
(paren
id|HIGH_BITS_OFFSET
)paren
id|req-&gt;port_high
op_assign
id|port
op_rshift
id|HIGH_BITS_OFFSET
suffix:semicolon
r_else
id|req-&gt;port_high
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|req-&gt;io_type
op_assign
id|SERIAL_IO_MEM
suffix:semicolon
id|req-&gt;iomem_base
op_assign
id|ioremap
c_func
(paren
id|port
comma
id|board-&gt;uart_offset
)paren
suffix:semicolon
r_if
c_cond
(paren
id|req-&gt;iomem_base
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|req-&gt;iomem_reg_shift
op_assign
id|board-&gt;reg_shift
suffix:semicolon
id|req-&gt;port
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
id|_INLINE_
r_int
DECL|function|get_pci_irq
id|get_pci_irq
c_func
(paren
r_struct
id|pci_dev
op_star
id|dev
comma
r_struct
id|pci_board
op_star
id|board
comma
r_int
id|idx
)paren
(brace
r_int
id|base_idx
suffix:semicolon
r_if
c_cond
(paren
(paren
id|board-&gt;flags
op_amp
id|SPCI_FL_IRQRESOURCE
)paren
op_eq
l_int|0
)paren
r_return
id|dev-&gt;irq
suffix:semicolon
id|base_idx
op_assign
id|SPCI_FL_GET_IRQBASE
c_func
(paren
id|board-&gt;flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|board-&gt;flags
op_amp
id|SPCI_FL_IRQ_TABLE
)paren
id|base_idx
op_add_assign
id|idx
suffix:semicolon
r_return
id|PCI_IRQ_RESOURCE
c_func
(paren
id|dev
comma
id|base_idx
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Some PCI serial cards using the PLX 9050 PCI interface chip require&n; * that the card interrupt be explicitly enabled or disabled.  This&n; * seems to be mainly needed on card using the PLX which also use I/O&n; * mapped memory.&n; */
r_static
r_int
id|__devinit
DECL|function|pci_plx9050_fn
id|pci_plx9050_fn
c_func
(paren
r_struct
id|pci_dev
op_star
id|dev
comma
r_struct
id|pci_board
op_star
id|board
comma
r_int
id|enable
)paren
(brace
id|u8
op_star
id|p
comma
id|irq_config
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|enable
)paren
(brace
id|irq_config
op_assign
l_int|0x41
suffix:semicolon
r_if
c_cond
(paren
id|dev-&gt;vendor
op_eq
id|PCI_VENDOR_ID_PANACOM
)paren
id|irq_config
op_assign
l_int|0x43
suffix:semicolon
r_if
c_cond
(paren
(paren
id|dev-&gt;vendor
op_eq
id|PCI_VENDOR_ID_PLX
)paren
op_logical_and
(paren
id|dev-&gt;device
op_eq
id|PCI_DEVICE_ID_PLX_ROMULUS
)paren
)paren
(brace
multiline_comment|/*&n;&t;&t;&t; * As the megawolf cards have the int pins active&n;&t;&t;&t; * high, and have 2 UART chips, both ints must be&n;&t;&t;&t; * enabled on the 9050. Also, the UARTS are set in&n;&t;&t;&t; * 16450 mode by default, so we have to enable the&n;&t;&t;&t; * 16C950 &squot;enhanced&squot; mode so that we can use the&n;&t;&t;&t; * deep FIFOs&n;&t;&t;&t; */
id|irq_config
op_assign
l_int|0x5b
suffix:semicolon
)brace
)brace
multiline_comment|/*&n;&t; * enable/disable interrupts&n;&t; */
id|p
op_assign
id|ioremap
c_func
(paren
id|pci_resource_start
c_func
(paren
id|dev
comma
l_int|0
)paren
comma
l_int|0x80
)paren
suffix:semicolon
r_if
c_cond
(paren
id|p
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|writel
c_func
(paren
id|irq_config
comma
(paren
r_int
r_int
)paren
id|p
op_plus
l_int|0x4c
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * Read the register back to ensure that it took effect.&n;&t; */
id|readl
c_func
(paren
(paren
r_int
r_int
)paren
id|p
op_plus
l_int|0x4c
)paren
suffix:semicolon
id|iounmap
c_func
(paren
id|p
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * SIIG serial cards have an PCI interface chip which also controls&n; * the UART clocking frequency. Each UART can be clocked independently&n; * (except cards equiped with 4 UARTs) and initial clocking settings&n; * are stored in the EEPROM chip. It can cause problems because this&n; * version of serial driver doesn&squot;t support differently clocked UART&squot;s&n; * on single PCI card. To prevent this, initialization functions set&n; * high frequency clocking for all UART&squot;s on given card. It is safe (I&n; * hope) because it doesn&squot;t touch EEPROM settings to prevent conflicts&n; * with other OSes (like M$ DOS).&n; *&n; *  SIIG support added by Andrey Panin &lt;pazke@mail.tp.ru&gt;, 10/1999&n; * &n; * There is two family of SIIG serial cards with different PCI&n; * interface chip and different configuration methods:&n; *     - 10x cards have control registers in IO and/or memory space;&n; *     - 20x cards have control registers in standard PCI configuration space.&n; */
DECL|macro|PCI_DEVICE_ID_SIIG_1S_10x
mdefine_line|#define PCI_DEVICE_ID_SIIG_1S_10x (PCI_DEVICE_ID_SIIG_1S_10x_550 &amp; 0xfffc)
DECL|macro|PCI_DEVICE_ID_SIIG_2S_10x
mdefine_line|#define PCI_DEVICE_ID_SIIG_2S_10x (PCI_DEVICE_ID_SIIG_2S_10x_550 &amp; 0xfff8)
r_static
r_int
id|__devinit
DECL|function|pci_siig10x_fn
id|pci_siig10x_fn
c_func
(paren
r_struct
id|pci_dev
op_star
id|dev
comma
r_struct
id|pci_board
op_star
id|board
comma
r_int
id|enable
)paren
(brace
id|u16
id|data
comma
op_star
id|p
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|enable
)paren
r_return
l_int|0
suffix:semicolon
r_switch
c_cond
(paren
id|dev-&gt;device
op_amp
l_int|0xfff8
)paren
(brace
r_case
id|PCI_DEVICE_ID_SIIG_1S_10x
suffix:colon
multiline_comment|/* 1S */
id|data
op_assign
l_int|0xffdf
suffix:semicolon
r_break
suffix:semicolon
r_case
id|PCI_DEVICE_ID_SIIG_2S_10x
suffix:colon
multiline_comment|/* 2S, 2S1P */
id|data
op_assign
l_int|0xf7ff
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
multiline_comment|/* 1S1P, 4S */
id|data
op_assign
l_int|0xfffb
suffix:semicolon
r_break
suffix:semicolon
)brace
id|p
op_assign
id|ioremap
c_func
(paren
id|pci_resource_start
c_func
(paren
id|dev
comma
l_int|0
)paren
comma
l_int|0x80
)paren
suffix:semicolon
r_if
c_cond
(paren
id|p
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|writew
c_func
(paren
id|readw
c_func
(paren
(paren
r_int
r_int
)paren
id|p
op_plus
l_int|0x28
)paren
op_amp
id|data
comma
(paren
r_int
r_int
)paren
id|p
op_plus
l_int|0x28
)paren
suffix:semicolon
id|iounmap
c_func
(paren
id|p
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|macro|PCI_DEVICE_ID_SIIG_2S_20x
mdefine_line|#define PCI_DEVICE_ID_SIIG_2S_20x (PCI_DEVICE_ID_SIIG_2S_20x_550 &amp; 0xfffc)
DECL|macro|PCI_DEVICE_ID_SIIG_2S1P_20x
mdefine_line|#define PCI_DEVICE_ID_SIIG_2S1P_20x (PCI_DEVICE_ID_SIIG_2S1P_20x_550 &amp; 0xfffc)
r_static
r_int
id|__devinit
DECL|function|pci_siig20x_fn
id|pci_siig20x_fn
c_func
(paren
r_struct
id|pci_dev
op_star
id|dev
comma
r_struct
id|pci_board
op_star
id|board
comma
r_int
id|enable
)paren
(brace
id|u8
id|data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|enable
)paren
r_return
l_int|0
suffix:semicolon
multiline_comment|/* Change clock frequency for the first UART. */
id|pci_read_config_byte
c_func
(paren
id|dev
comma
l_int|0x6f
comma
op_amp
id|data
)paren
suffix:semicolon
id|pci_write_config_byte
c_func
(paren
id|dev
comma
l_int|0x6f
comma
id|data
op_amp
l_int|0xef
)paren
suffix:semicolon
multiline_comment|/* If this card has 2 UART, we have to do the same with second UART. */
r_if
c_cond
(paren
(paren
(paren
id|dev-&gt;device
op_amp
l_int|0xfffc
)paren
op_eq
id|PCI_DEVICE_ID_SIIG_2S_20x
)paren
op_logical_or
(paren
(paren
id|dev-&gt;device
op_amp
l_int|0xfffc
)paren
op_eq
id|PCI_DEVICE_ID_SIIG_2S1P_20x
)paren
)paren
(brace
id|pci_read_config_byte
c_func
(paren
id|dev
comma
l_int|0x73
comma
op_amp
id|data
)paren
suffix:semicolon
id|pci_write_config_byte
c_func
(paren
id|dev
comma
l_int|0x73
comma
id|data
op_amp
l_int|0xef
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* Added for EKF Intel i960 serial boards */
r_static
r_int
id|__devinit
DECL|function|pci_inteli960ni_fn
id|pci_inteli960ni_fn
c_func
(paren
r_struct
id|pci_dev
op_star
id|dev
comma
r_struct
id|pci_board
op_star
id|board
comma
r_int
id|enable
)paren
(brace
r_int
r_int
id|oldval
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|pci_get_subdevice
c_func
(paren
id|dev
)paren
op_amp
l_int|0x1000
)paren
)paren
r_return
op_minus
id|ENODEV
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|enable
)paren
multiline_comment|/* is there something to deinit? */
r_return
l_int|0
suffix:semicolon
multiline_comment|/* is firmware started? */
id|pci_read_config_dword
c_func
(paren
id|dev
comma
l_int|0x44
comma
(paren
r_void
op_star
)paren
op_amp
id|oldval
)paren
suffix:semicolon
r_if
c_cond
(paren
id|oldval
op_eq
l_int|0x00001000L
)paren
(brace
multiline_comment|/* RESET value */
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;Local i960 firmware missing&quot;
)paren
suffix:semicolon
r_return
op_minus
id|ENODEV
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * Timedia has an explosion of boards, and to avoid the PCI table from&n; * growing *huge*, we use this function to collapse some 70 entries&n; * in the PCI table into one, for sanity&squot;s and compactness&squot;s sake.&n; */
DECL|variable|timedia_single_port
r_static
r_int
r_int
id|timedia_single_port
(braket
)braket
op_assign
(brace
l_int|0x4025
comma
l_int|0x4027
comma
l_int|0x4028
comma
l_int|0x5025
comma
l_int|0x5027
comma
l_int|0
)brace
suffix:semicolon
DECL|variable|timedia_dual_port
r_static
r_int
r_int
id|timedia_dual_port
(braket
)braket
op_assign
(brace
l_int|0x0002
comma
l_int|0x4036
comma
l_int|0x4037
comma
l_int|0x4038
comma
l_int|0x4078
comma
l_int|0x4079
comma
l_int|0x4085
comma
l_int|0x4088
comma
l_int|0x4089
comma
l_int|0x5037
comma
l_int|0x5078
comma
l_int|0x5079
comma
l_int|0x5085
comma
l_int|0x6079
comma
l_int|0x7079
comma
l_int|0x8079
comma
l_int|0x8137
comma
l_int|0x8138
comma
l_int|0x8237
comma
l_int|0x8238
comma
l_int|0x9079
comma
l_int|0x9137
comma
l_int|0x9138
comma
l_int|0x9237
comma
l_int|0x9238
comma
l_int|0xA079
comma
l_int|0xB079
comma
l_int|0xC079
comma
l_int|0xD079
comma
l_int|0
)brace
suffix:semicolon
DECL|variable|timedia_quad_port
r_static
r_int
r_int
id|timedia_quad_port
(braket
)braket
op_assign
(brace
l_int|0x4055
comma
l_int|0x4056
comma
l_int|0x4095
comma
l_int|0x4096
comma
l_int|0x5056
comma
l_int|0x8156
comma
l_int|0x8157
comma
l_int|0x8256
comma
l_int|0x8257
comma
l_int|0x9056
comma
l_int|0x9156
comma
l_int|0x9157
comma
l_int|0x9158
comma
l_int|0x9159
comma
l_int|0x9256
comma
l_int|0x9257
comma
l_int|0xA056
comma
l_int|0xA157
comma
l_int|0xA158
comma
l_int|0xA159
comma
l_int|0xB056
comma
l_int|0xB157
comma
l_int|0
)brace
suffix:semicolon
DECL|variable|timedia_eight_port
r_static
r_int
r_int
id|timedia_eight_port
(braket
)braket
op_assign
(brace
l_int|0x4065
comma
l_int|0x4066
comma
l_int|0x5065
comma
l_int|0x5066
comma
l_int|0x8166
comma
l_int|0x9066
comma
l_int|0x9166
comma
l_int|0x9167
comma
l_int|0x9168
comma
l_int|0xA066
comma
l_int|0xA167
comma
l_int|0xA168
comma
l_int|0
)brace
suffix:semicolon
DECL|struct|timedia_struct
r_static
r_struct
id|timedia_struct
(brace
DECL|member|num
r_int
id|num
suffix:semicolon
DECL|member|ids
r_int
r_int
op_star
id|ids
suffix:semicolon
DECL|variable|timedia_data
)brace
id|timedia_data
(braket
)braket
op_assign
(brace
(brace
l_int|1
comma
id|timedia_single_port
)brace
comma
(brace
l_int|2
comma
id|timedia_dual_port
)brace
comma
(brace
l_int|4
comma
id|timedia_quad_port
)brace
comma
(brace
l_int|8
comma
id|timedia_eight_port
)brace
comma
(brace
l_int|0
comma
l_int|0
)brace
)brace
suffix:semicolon
r_static
r_int
id|__devinit
DECL|function|pci_timedia_fn
id|pci_timedia_fn
c_func
(paren
r_struct
id|pci_dev
op_star
id|dev
comma
r_struct
id|pci_board
op_star
id|board
comma
r_int
id|enable
)paren
(brace
r_int
id|i
comma
id|j
suffix:semicolon
r_int
r_int
op_star
id|ids
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|enable
)paren
r_return
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|timedia_data
(braket
id|i
)braket
dot
id|num
suffix:semicolon
id|i
op_increment
)paren
(brace
id|ids
op_assign
id|timedia_data
(braket
id|i
)braket
dot
id|ids
suffix:semicolon
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|ids
(braket
id|j
)braket
suffix:semicolon
id|j
op_increment
)paren
(brace
r_if
c_cond
(paren
id|pci_get_subdevice
c_func
(paren
id|dev
)paren
op_eq
id|ids
(braket
id|j
)braket
)paren
(brace
id|board-&gt;num_ports
op_assign
id|timedia_data
(braket
id|i
)braket
dot
id|num
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * HP&squot;s Remote Management Console.  The Diva chip came in several&n; * different versions.  N-class, L2000 and A500 have two Diva chips, each&n; * with 3 UARTs (the third UART on the second chip is unused).  Superdome&n; * and Keystone have one Diva chip with 3 UARTs.  Some later machines have&n; * one Diva chip, but it has been expanded to 5 UARTs.&n; */
r_static
r_int
id|__devinit
DECL|function|pci_hp_diva
id|pci_hp_diva
c_func
(paren
r_struct
id|pci_dev
op_star
id|dev
comma
r_struct
id|pci_board
op_star
id|board
comma
r_int
id|enable
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|enable
)paren
r_return
l_int|0
suffix:semicolon
r_switch
c_cond
(paren
id|dev-&gt;subsystem_device
)paren
(brace
r_case
id|PCI_DEVICE_ID_HP_DIVA_TOSCA1
suffix:colon
r_case
id|PCI_DEVICE_ID_HP_DIVA_HALFDOME
suffix:colon
r_case
id|PCI_DEVICE_ID_HP_DIVA_KEYSTONE
suffix:colon
r_case
id|PCI_DEVICE_ID_HP_DIVA_EVEREST
suffix:colon
id|board-&gt;num_ports
op_assign
l_int|3
suffix:semicolon
r_break
suffix:semicolon
r_case
id|PCI_DEVICE_ID_HP_DIVA_TOSCA2
suffix:colon
id|board-&gt;num_ports
op_assign
l_int|2
suffix:semicolon
r_break
suffix:semicolon
r_case
id|PCI_DEVICE_ID_HP_DIVA_MAESTRO
suffix:colon
id|board-&gt;num_ports
op_assign
l_int|4
suffix:semicolon
r_break
suffix:semicolon
r_case
id|PCI_DEVICE_ID_HP_DIVA_POWERBAR
suffix:colon
id|board-&gt;num_ports
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
id|__devinit
DECL|function|pci_xircom_fn
id|pci_xircom_fn
c_func
(paren
r_struct
id|pci_dev
op_star
id|dev
comma
r_struct
id|pci_board
op_star
id|board
comma
r_int
id|enable
)paren
(brace
id|__set_current_state
c_func
(paren
id|TASK_UNINTERRUPTIBLE
)paren
suffix:semicolon
id|schedule_timeout
c_func
(paren
id|HZ
op_div
l_int|10
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * This is the configuration table for all of the PCI serial boards&n; * which we support.  It is directly indexed by the pci_board_num_t enum&n; * value, which is encoded in the pci_device_id PCI probe table&squot;s&n; * driver_data member.&n; */
DECL|enum|pci_board_num_t
r_enum
id|pci_board_num_t
(brace
DECL|enumerator|pbn_b0_1_115200
id|pbn_b0_1_115200
comma
DECL|enumerator|pbn_default
id|pbn_default
op_assign
l_int|0
comma
DECL|enumerator|pbn_b0_2_115200
id|pbn_b0_2_115200
comma
DECL|enumerator|pbn_b0_4_115200
id|pbn_b0_4_115200
comma
DECL|enumerator|pbn_b0_1_921600
id|pbn_b0_1_921600
comma
DECL|enumerator|pbn_b0_2_921600
id|pbn_b0_2_921600
comma
DECL|enumerator|pbn_b0_4_921600
id|pbn_b0_4_921600
comma
DECL|enumerator|pbn_b0_bt_1_115200
id|pbn_b0_bt_1_115200
comma
DECL|enumerator|pbn_b0_bt_2_115200
id|pbn_b0_bt_2_115200
comma
DECL|enumerator|pbn_b0_bt_8_115200
id|pbn_b0_bt_8_115200
comma
DECL|enumerator|pbn_b0_bt_1_460800
id|pbn_b0_bt_1_460800
comma
DECL|enumerator|pbn_b0_bt_2_460800
id|pbn_b0_bt_2_460800
comma
DECL|enumerator|pbn_b1_1_115200
id|pbn_b1_1_115200
comma
DECL|enumerator|pbn_b1_2_115200
id|pbn_b1_2_115200
comma
DECL|enumerator|pbn_b1_4_115200
id|pbn_b1_4_115200
comma
DECL|enumerator|pbn_b1_8_115200
id|pbn_b1_8_115200
comma
DECL|enumerator|pbn_b1_2_921600
id|pbn_b1_2_921600
comma
DECL|enumerator|pbn_b1_4_921600
id|pbn_b1_4_921600
comma
DECL|enumerator|pbn_b1_8_921600
id|pbn_b1_8_921600
comma
DECL|enumerator|pbn_b1_2_1382400
id|pbn_b1_2_1382400
comma
DECL|enumerator|pbn_b1_4_1382400
id|pbn_b1_4_1382400
comma
DECL|enumerator|pbn_b1_8_1382400
id|pbn_b1_8_1382400
comma
DECL|enumerator|pbn_b2_1_115200
id|pbn_b2_1_115200
comma
DECL|enumerator|pbn_b2_8_115200
id|pbn_b2_8_115200
comma
DECL|enumerator|pbn_b2_4_460800
id|pbn_b2_4_460800
comma
DECL|enumerator|pbn_b2_8_460800
id|pbn_b2_8_460800
comma
DECL|enumerator|pbn_b2_16_460800
id|pbn_b2_16_460800
comma
DECL|enumerator|pbn_b2_4_921600
id|pbn_b2_4_921600
comma
DECL|enumerator|pbn_b2_8_921600
id|pbn_b2_8_921600
comma
DECL|enumerator|pbn_b2_bt_1_115200
id|pbn_b2_bt_1_115200
comma
DECL|enumerator|pbn_b2_bt_2_115200
id|pbn_b2_bt_2_115200
comma
DECL|enumerator|pbn_b2_bt_4_115200
id|pbn_b2_bt_4_115200
comma
DECL|enumerator|pbn_b2_bt_2_921600
id|pbn_b2_bt_2_921600
comma
DECL|enumerator|pbn_panacom
id|pbn_panacom
comma
DECL|enumerator|pbn_panacom2
id|pbn_panacom2
comma
DECL|enumerator|pbn_panacom4
id|pbn_panacom4
comma
DECL|enumerator|pbn_plx_romulus
id|pbn_plx_romulus
comma
DECL|enumerator|pbn_oxsemi
id|pbn_oxsemi
comma
DECL|enumerator|pbn_timedia
id|pbn_timedia
comma
DECL|enumerator|pbn_intel_i960
id|pbn_intel_i960
comma
DECL|enumerator|pbn_sgi_ioc3
id|pbn_sgi_ioc3
comma
DECL|enumerator|pbn_hp_diva
id|pbn_hp_diva
comma
DECL|enumerator|pbn_nec_nile4
id|pbn_nec_nile4
comma
DECL|enumerator|pbn_dci_pccom4
id|pbn_dci_pccom4
comma
DECL|enumerator|pbn_dci_pccom8
id|pbn_dci_pccom8
comma
DECL|enumerator|pbn_xircom_combo
id|pbn_xircom_combo
comma
DECL|enumerator|pbn_siig10x_0
id|pbn_siig10x_0
comma
DECL|enumerator|pbn_siig10x_1
id|pbn_siig10x_1
comma
DECL|enumerator|pbn_siig10x_2
id|pbn_siig10x_2
comma
DECL|enumerator|pbn_siig10x_4
id|pbn_siig10x_4
comma
DECL|enumerator|pbn_siig20x_0
id|pbn_siig20x_0
comma
DECL|enumerator|pbn_siig20x_2
id|pbn_siig20x_2
comma
DECL|enumerator|pbn_siig20x_4
id|pbn_siig20x_4
comma
DECL|enumerator|pbn_computone_4
id|pbn_computone_4
comma
DECL|enumerator|pbn_computone_6
id|pbn_computone_6
comma
DECL|enumerator|pbn_computone_8
id|pbn_computone_8
comma
)brace
suffix:semicolon
DECL|variable|__devinitdata
r_static
r_struct
id|pci_board
id|pci_boards
(braket
)braket
id|__devinitdata
op_assign
(brace
multiline_comment|/*&n;&t; * PCI Flags, Number of Ports, Base (Maximum) Baud Rate,&n;&t; * Offset to get to next UART&squot;s registers,&n;&t; * Register shift to use for memory-mapped I/O,&n;&t; * Initialization function, first UART offset&n;&t; */
multiline_comment|/* Generic serial board, pbn_b0_1_115200, pbn_default */
(brace
id|SPCI_FL_BASE0
comma
l_int|1
comma
l_int|115200
)brace
comma
multiline_comment|/* pbn_b0_1_115200,&n;&t;&t;&t;&t;&t;&t;   pbn_default */
(brace
id|SPCI_FL_BASE0
comma
l_int|2
comma
l_int|115200
)brace
comma
multiline_comment|/* pbn_b0_2_115200 */
(brace
id|SPCI_FL_BASE0
comma
l_int|4
comma
l_int|115200
)brace
comma
multiline_comment|/* pbn_b0_4_115200 */
(brace
id|SPCI_FL_BASE0
comma
l_int|1
comma
l_int|921600
)brace
comma
multiline_comment|/* pbn_b0_1_921600 */
(brace
id|SPCI_FL_BASE0
comma
l_int|2
comma
l_int|921600
)brace
comma
multiline_comment|/* pbn_b0_2_921600 */
(brace
id|SPCI_FL_BASE0
comma
l_int|4
comma
l_int|921600
)brace
comma
multiline_comment|/* pbn_b0_4_921600 */
(brace
id|SPCI_FL_BASE0
op_or
id|SPCI_FL_BASE_TABLE
comma
l_int|1
comma
l_int|115200
)brace
comma
multiline_comment|/* pbn_b0_bt_1_115200 */
(brace
id|SPCI_FL_BASE0
op_or
id|SPCI_FL_BASE_TABLE
comma
l_int|2
comma
l_int|115200
)brace
comma
multiline_comment|/* pbn_b0_bt_2_115200 */
(brace
id|SPCI_FL_BASE0
op_or
id|SPCI_FL_BASE_TABLE
comma
l_int|8
comma
l_int|115200
)brace
comma
multiline_comment|/* pbn_b0_bt_8_115200 */
(brace
id|SPCI_FL_BASE0
op_or
id|SPCI_FL_BASE_TABLE
comma
l_int|1
comma
l_int|460800
)brace
comma
multiline_comment|/* pbn_b0_bt_1_460800 */
(brace
id|SPCI_FL_BASE0
op_or
id|SPCI_FL_BASE_TABLE
comma
l_int|2
comma
l_int|460800
)brace
comma
multiline_comment|/* pbn_b0_bt_2_460800 */
(brace
id|SPCI_FL_BASE1
comma
l_int|1
comma
l_int|115200
)brace
comma
multiline_comment|/* pbn_b1_1_115200 */
(brace
id|SPCI_FL_BASE1
comma
l_int|2
comma
l_int|115200
)brace
comma
multiline_comment|/* pbn_b1_2_115200 */
(brace
id|SPCI_FL_BASE1
comma
l_int|4
comma
l_int|115200
)brace
comma
multiline_comment|/* pbn_b1_4_115200 */
(brace
id|SPCI_FL_BASE1
comma
l_int|8
comma
l_int|115200
)brace
comma
multiline_comment|/* pbn_b1_8_115200 */
(brace
id|SPCI_FL_BASE1
comma
l_int|2
comma
l_int|921600
)brace
comma
multiline_comment|/* pbn_b1_2_921600 */
(brace
id|SPCI_FL_BASE1
comma
l_int|4
comma
l_int|921600
)brace
comma
multiline_comment|/* pbn_b1_4_921600 */
(brace
id|SPCI_FL_BASE1
comma
l_int|8
comma
l_int|921600
)brace
comma
multiline_comment|/* pbn_b1_8_921600 */
(brace
id|SPCI_FL_BASE1
comma
l_int|2
comma
l_int|1382400
)brace
comma
multiline_comment|/* pbn_b1_2_1382400 */
(brace
id|SPCI_FL_BASE1
comma
l_int|4
comma
l_int|1382400
)brace
comma
multiline_comment|/* pbn_b1_4_1382400 */
(brace
id|SPCI_FL_BASE1
comma
l_int|8
comma
l_int|1382400
)brace
comma
multiline_comment|/* pbn_b1_8_1382400 */
(brace
id|SPCI_FL_BASE2
comma
l_int|1
comma
l_int|115200
)brace
comma
multiline_comment|/* pbn_b2_1_115200 */
(brace
id|SPCI_FL_BASE2
comma
l_int|8
comma
l_int|115200
)brace
comma
multiline_comment|/* pbn_b2_8_115200 */
(brace
id|SPCI_FL_BASE2
comma
l_int|4
comma
l_int|460800
)brace
comma
multiline_comment|/* pbn_b2_4_460800 */
(brace
id|SPCI_FL_BASE2
comma
l_int|8
comma
l_int|460800
)brace
comma
multiline_comment|/* pbn_b2_8_460800 */
(brace
id|SPCI_FL_BASE2
comma
l_int|16
comma
l_int|460800
)brace
comma
multiline_comment|/* pbn_b2_16_460800 */
(brace
id|SPCI_FL_BASE2
comma
l_int|4
comma
l_int|921600
)brace
comma
multiline_comment|/* pbn_b2_4_921600 */
(brace
id|SPCI_FL_BASE2
comma
l_int|8
comma
l_int|921600
)brace
comma
multiline_comment|/* pbn_b2_8_921600 */
(brace
id|SPCI_FL_BASE2
op_or
id|SPCI_FL_BASE_TABLE
comma
l_int|1
comma
l_int|115200
)brace
comma
multiline_comment|/* pbn_b2_bt_1_115200 */
(brace
id|SPCI_FL_BASE2
op_or
id|SPCI_FL_BASE_TABLE
comma
l_int|2
comma
l_int|115200
)brace
comma
multiline_comment|/* pbn_b2_bt_2_115200 */
(brace
id|SPCI_FL_BASE2
op_or
id|SPCI_FL_BASE_TABLE
comma
l_int|4
comma
l_int|115200
)brace
comma
multiline_comment|/* pbn_b2_bt_4_115200 */
(brace
id|SPCI_FL_BASE2
op_or
id|SPCI_FL_BASE_TABLE
comma
l_int|2
comma
l_int|921600
)brace
comma
multiline_comment|/* pbn_b2_bt_2_921600 */
(brace
id|SPCI_FL_BASE2
comma
l_int|2
comma
l_int|921600
comma
multiline_comment|/* IOMEM */
multiline_comment|/* pbn_panacom */
l_int|0x400
comma
l_int|7
comma
id|pci_plx9050_fn
)brace
comma
(brace
id|SPCI_FL_BASE2
op_or
id|SPCI_FL_BASE_TABLE
comma
l_int|2
comma
l_int|921600
comma
multiline_comment|/* pbn_panacom2 */
l_int|0x400
comma
l_int|7
comma
id|pci_plx9050_fn
)brace
comma
(brace
id|SPCI_FL_BASE2
op_or
id|SPCI_FL_BASE_TABLE
comma
l_int|4
comma
l_int|921600
comma
multiline_comment|/* pbn_panacom4 */
l_int|0x400
comma
l_int|7
comma
id|pci_plx9050_fn
)brace
comma
(brace
id|SPCI_FL_BASE2
comma
l_int|4
comma
l_int|921600
comma
multiline_comment|/* pbn_plx_romulus */
l_int|0x20
comma
l_int|2
comma
id|pci_plx9050_fn
comma
l_int|0x03
)brace
comma
multiline_comment|/* This board uses the size of PCI Base region 0 to&n;&t;&t; * signal now many ports are available */
(brace
id|SPCI_FL_BASE0
op_or
id|SPCI_FL_REGION_SZ_CAP
comma
l_int|32
comma
l_int|115200
)brace
comma
multiline_comment|/* pbn_oxsemi */
(brace
id|SPCI_FL_BASE_TABLE
comma
l_int|1
comma
l_int|921600
comma
multiline_comment|/* pbn_timedia */
l_int|0
comma
l_int|0
comma
id|pci_timedia_fn
)brace
comma
multiline_comment|/* EKF addition for i960 Boards form EKF with serial port */
(brace
id|SPCI_FL_BASE0
comma
l_int|32
comma
l_int|921600
comma
multiline_comment|/* max 256 ports */
multiline_comment|/* pbn_intel_i960 */
l_int|8
op_lshift
l_int|2
comma
l_int|2
comma
id|pci_inteli960ni_fn
comma
l_int|0x10000
)brace
comma
(brace
id|SPCI_FL_BASE0
op_or
id|SPCI_FL_IRQRESOURCE
comma
multiline_comment|/* pbn_sgi_ioc3 */
l_int|1
comma
l_int|458333
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0x20178
)brace
comma
(brace
id|SPCI_FL_BASE0
comma
l_int|5
comma
l_int|115200
comma
l_int|8
comma
l_int|0
comma
id|pci_hp_diva
comma
l_int|0
)brace
comma
multiline_comment|/* pbn_hp_diva */
multiline_comment|/*&n;&t; * NEC Vrc-5074 (Nile 4) builtin UART.&n;&t; */
(brace
id|SPCI_FL_BASE0
comma
l_int|1
comma
l_int|520833
comma
multiline_comment|/* pbn_nec_nile4 */
l_int|64
comma
l_int|3
comma
l_int|NULL
comma
l_int|0x300
)brace
comma
(brace
id|SPCI_FL_BASE3
comma
l_int|4
comma
l_int|115200
comma
l_int|8
)brace
comma
multiline_comment|/* pbn_dci_pccom4 */
(brace
id|SPCI_FL_BASE3
comma
l_int|8
comma
l_int|115200
comma
l_int|8
)brace
comma
multiline_comment|/* pbn_dci_pccom8 */
(brace
id|SPCI_FL_BASE0
comma
l_int|1
comma
l_int|115200
comma
multiline_comment|/* pbn_xircom_combo */
l_int|0
comma
l_int|0
comma
id|pci_xircom_fn
)brace
comma
(brace
id|SPCI_FL_BASE2
comma
l_int|1
comma
l_int|460800
comma
multiline_comment|/* pbn_siig10x_0 */
l_int|0
comma
l_int|0
comma
id|pci_siig10x_fn
)brace
comma
(brace
id|SPCI_FL_BASE2
comma
l_int|1
comma
l_int|921600
comma
multiline_comment|/* pbn_siig10x_1 */
l_int|0
comma
l_int|0
comma
id|pci_siig10x_fn
)brace
comma
(brace
id|SPCI_FL_BASE2
op_or
id|SPCI_FL_BASE_TABLE
comma
l_int|2
comma
l_int|921600
comma
multiline_comment|/* pbn_siig10x_2 */
l_int|0
comma
l_int|0
comma
id|pci_siig10x_fn
)brace
comma
(brace
id|SPCI_FL_BASE2
op_or
id|SPCI_FL_BASE_TABLE
comma
l_int|4
comma
l_int|921600
comma
multiline_comment|/* pbn_siig10x_4 */
l_int|0
comma
l_int|0
comma
id|pci_siig10x_fn
)brace
comma
(brace
id|SPCI_FL_BASE0
comma
l_int|1
comma
l_int|921600
comma
multiline_comment|/* pbn_siix20x_0 */
l_int|0
comma
l_int|0
comma
id|pci_siig20x_fn
)brace
comma
(brace
id|SPCI_FL_BASE0
op_or
id|SPCI_FL_BASE_TABLE
comma
l_int|2
comma
l_int|921600
comma
multiline_comment|/* pbn_siix20x_2 */
l_int|0
comma
l_int|0
comma
id|pci_siig20x_fn
)brace
comma
(brace
id|SPCI_FL_BASE0
op_or
id|SPCI_FL_BASE_TABLE
comma
l_int|4
comma
l_int|921600
comma
multiline_comment|/* pbn_siix20x_4 */
l_int|0
comma
l_int|0
comma
id|pci_siig20x_fn
)brace
comma
(brace
id|SPCI_FL_BASE0
comma
l_int|4
comma
l_int|921600
comma
multiline_comment|/* IOMEM */
multiline_comment|/* pbn_computone_4 */
l_int|0x40
comma
l_int|2
comma
l_int|NULL
comma
l_int|0x200
)brace
comma
(brace
id|SPCI_FL_BASE0
comma
l_int|6
comma
l_int|921600
comma
multiline_comment|/* IOMEM */
multiline_comment|/* pbn_computone_6 */
l_int|0x40
comma
l_int|2
comma
l_int|NULL
comma
l_int|0x200
)brace
comma
(brace
id|SPCI_FL_BASE0
comma
l_int|8
comma
l_int|921600
comma
multiline_comment|/* IOMEM */
multiline_comment|/* pbn_computone_8 */
l_int|0x40
comma
l_int|2
comma
l_int|NULL
comma
l_int|0x200
)brace
comma
)brace
suffix:semicolon
multiline_comment|/*&n; * Given a complete unknown PCI device, try to use some heuristics to&n; * guess what the configuration might be, based on the pitiful PCI&n; * serial specs.  Returns 0 on success, 1 on failure.&n; */
r_static
r_int
id|__devinit
DECL|function|serial_pci_guess_board
id|serial_pci_guess_board
c_func
(paren
r_struct
id|pci_dev
op_star
id|dev
comma
r_struct
id|pci_board
op_star
id|board
)paren
(brace
r_int
id|num_iomem
op_assign
l_int|0
comma
id|num_port
op_assign
l_int|0
comma
id|first_port
op_assign
op_minus
l_int|1
suffix:semicolon
r_int
id|i
suffix:semicolon
multiline_comment|/*&n;&t; * If it is not a communications device or the programming&n;&t; * interface is greater than 6, give up.&n;&t; *&n;&t; * (Should we try to make guesses for multiport serial devices&n;&t; * later?) &n;&t; */
r_if
c_cond
(paren
(paren
(paren
(paren
id|dev
op_member_access_from_pointer
r_class
op_rshift
l_int|8
)paren
op_ne
id|PCI_CLASS_COMMUNICATION_SERIAL
)paren
op_logical_and
(paren
(paren
id|dev
op_member_access_from_pointer
r_class
op_rshift
l_int|8
)paren
op_ne
id|PCI_CLASS_COMMUNICATION_MODEM
)paren
)paren
op_logical_or
(paren
id|dev
op_member_access_from_pointer
r_class
op_amp
l_int|0xff
)paren
OG
l_int|6
)paren
r_return
l_int|1
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|6
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|IS_PCI_REGION_IOPORT
c_func
(paren
id|dev
comma
id|i
)paren
)paren
(brace
id|num_port
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|first_port
op_eq
op_minus
l_int|1
)paren
id|first_port
op_assign
id|i
suffix:semicolon
)brace
r_if
c_cond
(paren
id|IS_PCI_REGION_IOMEM
c_func
(paren
id|dev
comma
id|i
)paren
)paren
id|num_iomem
op_increment
suffix:semicolon
)brace
multiline_comment|/*&n;&t; * If there is 1 or 0 iomem regions, and exactly one port, use&n;&t; * it.&n;&t; */
r_if
c_cond
(paren
id|num_iomem
op_le
l_int|1
op_logical_and
id|num_port
op_eq
l_int|1
)paren
(brace
id|board-&gt;flags
op_assign
id|first_port
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_return
l_int|1
suffix:semicolon
)brace
multiline_comment|/*&n; * return an error code to refuse.&n; *&n; * serial_struct is 60 bytes.&n; */
DECL|function|pci_init_one
r_static
r_int
id|__devinit
id|pci_init_one
c_func
(paren
r_struct
id|pci_dev
op_star
id|dev
comma
r_const
r_struct
id|pci_device_id
op_star
id|ent
)paren
(brace
r_struct
id|serial_private
op_star
id|priv
suffix:semicolon
r_struct
id|pci_board
op_star
id|board
comma
id|tmp
suffix:semicolon
r_struct
id|serial_struct
id|serial_req
suffix:semicolon
r_int
id|base_baud
comma
id|rc
comma
id|k
suffix:semicolon
r_if
c_cond
(paren
id|ent-&gt;driver_data
op_ge
id|ARRAY_SIZE
c_func
(paren
id|pci_boards
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;pci_init_one: invalid driver_data: %ld&bslash;n&quot;
comma
id|ent-&gt;driver_data
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|board
op_assign
op_amp
id|pci_boards
(braket
id|ent-&gt;driver_data
)braket
suffix:semicolon
id|rc
op_assign
id|pci_enable_device
c_func
(paren
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rc
)paren
r_return
id|rc
suffix:semicolon
r_if
c_cond
(paren
id|ent-&gt;driver_data
op_eq
id|pbn_default
op_logical_and
id|serial_pci_guess_board
c_func
(paren
id|dev
comma
id|board
)paren
)paren
(brace
id|pci_disable_device
c_func
(paren
id|dev
)paren
suffix:semicolon
r_return
op_minus
id|ENODEV
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|serial_pci_guess_board
c_func
(paren
id|dev
comma
op_amp
id|tmp
)paren
op_eq
l_int|0
)paren
(brace
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;Redundant entry in serial pci_table.  &quot;
l_string|&quot;Please send the output of&bslash;n&quot;
l_string|&quot;lspci -vv, this message (%d,%d,%d,%d)&bslash;n&quot;
l_string|&quot;and the manufacturer and name of &quot;
l_string|&quot;serial board or modem board&bslash;n&quot;
l_string|&quot;to serial-pci-info@lists.sourceforge.net.&bslash;n&quot;
comma
id|dev-&gt;vendor
comma
id|dev-&gt;device
comma
id|pci_get_subvendor
c_func
(paren
id|dev
)paren
comma
id|pci_get_subdevice
c_func
(paren
id|dev
)paren
)paren
suffix:semicolon
)brace
id|priv
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|serial_private
)paren
op_plus
r_sizeof
(paren
r_int
r_int
)paren
op_star
id|board-&gt;num_ports
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|priv
)paren
(brace
id|pci_disable_device
c_func
(paren
id|dev
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
multiline_comment|/*&n;&t; * Run the initialization function, if any&n;&t; */
r_if
c_cond
(paren
id|board-&gt;init_fn
)paren
(brace
id|rc
op_assign
id|board
op_member_access_from_pointer
id|init_fn
c_func
(paren
id|dev
comma
id|board
comma
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rc
op_ne
l_int|0
)paren
(brace
id|pci_disable_device
c_func
(paren
id|dev
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|priv
)paren
suffix:semicolon
r_return
id|rc
suffix:semicolon
)brace
)brace
id|base_baud
op_assign
id|board-&gt;base_baud
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|base_baud
)paren
id|base_baud
op_assign
id|BASE_BAUD
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|serial_req
comma
l_int|0
comma
r_sizeof
(paren
id|serial_req
)paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|k
op_assign
l_int|0
suffix:semicolon
id|k
OL
id|board-&gt;num_ports
suffix:semicolon
id|k
op_increment
)paren
(brace
id|serial_req.irq
op_assign
id|get_pci_irq
c_func
(paren
id|dev
comma
id|board
comma
id|k
)paren
suffix:semicolon
r_if
c_cond
(paren
id|get_pci_port
c_func
(paren
id|dev
comma
id|board
comma
op_amp
id|serial_req
comma
id|k
)paren
)paren
r_break
suffix:semicolon
macro_line|#ifdef SERIAL_DEBUG_PCI
id|printk
c_func
(paren
l_string|&quot;Setup PCI/PNP port: port %x, irq %d, type %d&bslash;n&quot;
comma
id|serial_req.port
comma
id|serial_req.irq
comma
id|serial_req.io_type
)paren
suffix:semicolon
macro_line|#endif
id|serial_req.flags
op_assign
id|ASYNC_SKIP_TEST
op_or
id|ASYNC_AUTOPROBE
suffix:semicolon
id|serial_req.baud_base
op_assign
id|base_baud
suffix:semicolon
id|priv-&gt;line
(braket
id|k
)braket
op_assign
id|register_serial
c_func
(paren
op_amp
id|serial_req
)paren
suffix:semicolon
r_if
c_cond
(paren
id|priv-&gt;line
(braket
id|k
)braket
OL
l_int|0
)paren
r_break
suffix:semicolon
)brace
id|priv-&gt;board
op_assign
id|board
suffix:semicolon
id|priv-&gt;nr
op_assign
id|k
suffix:semicolon
id|pci_set_drvdata
c_func
(paren
id|dev
comma
id|priv
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|pci_remove_one
r_static
r_void
id|__devexit
id|pci_remove_one
c_func
(paren
r_struct
id|pci_dev
op_star
id|dev
)paren
(brace
r_struct
id|serial_private
op_star
id|priv
op_assign
id|pci_get_drvdata
c_func
(paren
id|dev
)paren
suffix:semicolon
r_int
id|i
suffix:semicolon
id|pci_set_drvdata
c_func
(paren
id|dev
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|priv
)paren
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|priv-&gt;nr
suffix:semicolon
id|i
op_increment
)paren
id|unregister_serial
c_func
(paren
id|priv-&gt;line
(braket
id|i
)braket
)paren
suffix:semicolon
id|priv-&gt;board
op_member_access_from_pointer
id|init_fn
c_func
(paren
id|dev
comma
id|priv-&gt;board
comma
l_int|0
)paren
suffix:semicolon
id|pci_disable_device
c_func
(paren
id|dev
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|priv
)paren
suffix:semicolon
)brace
)brace
DECL|variable|__devinitdata
r_static
r_struct
id|pci_device_id
id|serial_pci_tbl
(braket
)braket
id|__devinitdata
op_assign
(brace
(brace
id|PCI_VENDOR_ID_V3
comma
id|PCI_DEVICE_ID_V3_V960
comma
id|PCI_SUBVENDOR_ID_CONNECT_TECH
comma
id|PCI_SUBDEVICE_ID_CONNECT_TECH_BH8_232
comma
l_int|0
comma
l_int|0
comma
id|pbn_b1_8_1382400
)brace
comma
(brace
id|PCI_VENDOR_ID_V3
comma
id|PCI_DEVICE_ID_V3_V960
comma
id|PCI_SUBVENDOR_ID_CONNECT_TECH
comma
id|PCI_SUBDEVICE_ID_CONNECT_TECH_BH4_232
comma
l_int|0
comma
l_int|0
comma
id|pbn_b1_4_1382400
)brace
comma
(brace
id|PCI_VENDOR_ID_V3
comma
id|PCI_DEVICE_ID_V3_V960
comma
id|PCI_SUBVENDOR_ID_CONNECT_TECH
comma
id|PCI_SUBDEVICE_ID_CONNECT_TECH_BH2_232
comma
l_int|0
comma
l_int|0
comma
id|pbn_b1_2_1382400
)brace
comma
(brace
id|PCI_VENDOR_ID_V3
comma
id|PCI_DEVICE_ID_V3_V351
comma
id|PCI_SUBVENDOR_ID_CONNECT_TECH
comma
id|PCI_SUBDEVICE_ID_CONNECT_TECH_BH8_232
comma
l_int|0
comma
l_int|0
comma
id|pbn_b1_8_1382400
)brace
comma
(brace
id|PCI_VENDOR_ID_V3
comma
id|PCI_DEVICE_ID_V3_V351
comma
id|PCI_SUBVENDOR_ID_CONNECT_TECH
comma
id|PCI_SUBDEVICE_ID_CONNECT_TECH_BH4_232
comma
l_int|0
comma
l_int|0
comma
id|pbn_b1_4_1382400
)brace
comma
(brace
id|PCI_VENDOR_ID_V3
comma
id|PCI_DEVICE_ID_V3_V351
comma
id|PCI_SUBVENDOR_ID_CONNECT_TECH
comma
id|PCI_SUBDEVICE_ID_CONNECT_TECH_BH2_232
comma
l_int|0
comma
l_int|0
comma
id|pbn_b1_2_1382400
)brace
comma
(brace
id|PCI_VENDOR_ID_V3
comma
id|PCI_DEVICE_ID_V3_V351
comma
id|PCI_SUBVENDOR_ID_CONNECT_TECH
comma
id|PCI_SUBDEVICE_ID_CONNECT_TECH_BH8_485
comma
l_int|0
comma
l_int|0
comma
id|pbn_b1_8_921600
)brace
comma
(brace
id|PCI_VENDOR_ID_V3
comma
id|PCI_DEVICE_ID_V3_V351
comma
id|PCI_SUBVENDOR_ID_CONNECT_TECH
comma
id|PCI_SUBDEVICE_ID_CONNECT_TECH_BH8_485_4_4
comma
l_int|0
comma
l_int|0
comma
id|pbn_b1_8_921600
)brace
comma
(brace
id|PCI_VENDOR_ID_V3
comma
id|PCI_DEVICE_ID_V3_V351
comma
id|PCI_SUBVENDOR_ID_CONNECT_TECH
comma
id|PCI_SUBDEVICE_ID_CONNECT_TECH_BH4_485
comma
l_int|0
comma
l_int|0
comma
id|pbn_b1_4_921600
)brace
comma
(brace
id|PCI_VENDOR_ID_V3
comma
id|PCI_DEVICE_ID_V3_V351
comma
id|PCI_SUBVENDOR_ID_CONNECT_TECH
comma
id|PCI_SUBDEVICE_ID_CONNECT_TECH_BH4_485_2_2
comma
l_int|0
comma
l_int|0
comma
id|pbn_b1_4_921600
)brace
comma
(brace
id|PCI_VENDOR_ID_V3
comma
id|PCI_DEVICE_ID_V3_V351
comma
id|PCI_SUBVENDOR_ID_CONNECT_TECH
comma
id|PCI_SUBDEVICE_ID_CONNECT_TECH_BH2_485
comma
l_int|0
comma
l_int|0
comma
id|pbn_b1_2_921600
)brace
comma
(brace
id|PCI_VENDOR_ID_V3
comma
id|PCI_DEVICE_ID_V3_V351
comma
id|PCI_SUBVENDOR_ID_CONNECT_TECH
comma
id|PCI_SUBDEVICE_ID_CONNECT_TECH_BH8_485_2_6
comma
l_int|0
comma
l_int|0
comma
id|pbn_b1_8_921600
)brace
comma
(brace
id|PCI_VENDOR_ID_V3
comma
id|PCI_DEVICE_ID_V3_V351
comma
id|PCI_SUBVENDOR_ID_CONNECT_TECH
comma
id|PCI_SUBDEVICE_ID_CONNECT_TECH_BH081101V1
comma
l_int|0
comma
l_int|0
comma
id|pbn_b1_8_921600
)brace
comma
(brace
id|PCI_VENDOR_ID_V3
comma
id|PCI_DEVICE_ID_V3_V351
comma
id|PCI_SUBVENDOR_ID_CONNECT_TECH
comma
id|PCI_SUBDEVICE_ID_CONNECT_TECH_BH041101V1
comma
l_int|0
comma
l_int|0
comma
id|pbn_b1_4_921600
)brace
comma
(brace
id|PCI_VENDOR_ID_SEALEVEL
comma
id|PCI_DEVICE_ID_SEALEVEL_U530
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_b2_bt_1_115200
)brace
comma
(brace
id|PCI_VENDOR_ID_SEALEVEL
comma
id|PCI_DEVICE_ID_SEALEVEL_UCOMM2
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_b2_bt_2_115200
)brace
comma
(brace
id|PCI_VENDOR_ID_SEALEVEL
comma
id|PCI_DEVICE_ID_SEALEVEL_UCOMM422
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_b2_bt_4_115200
)brace
comma
(brace
id|PCI_VENDOR_ID_SEALEVEL
comma
id|PCI_DEVICE_ID_SEALEVEL_UCOMM232
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_b2_bt_2_115200
)brace
comma
(brace
id|PCI_VENDOR_ID_SEALEVEL
comma
id|PCI_DEVICE_ID_SEALEVEL_COMM4
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_b2_bt_4_115200
)brace
comma
(brace
id|PCI_VENDOR_ID_SEALEVEL
comma
id|PCI_DEVICE_ID_SEALEVEL_COMM8
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_b2_8_115200
)brace
comma
(brace
id|PCI_VENDOR_ID_PLX
comma
id|PCI_DEVICE_ID_PLX_GTEK_SERIAL2
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_b2_bt_2_115200
)brace
comma
(brace
id|PCI_VENDOR_ID_PLX
comma
id|PCI_DEVICE_ID_PLX_SPCOM200
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_b2_bt_2_921600
)brace
comma
multiline_comment|/* VScom SPCOM800, from sl@s.pl */
(brace
id|PCI_VENDOR_ID_PLX
comma
id|PCI_DEVICE_ID_PLX_SPCOM800
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_b2_8_921600
)brace
comma
(brace
id|PCI_VENDOR_ID_PLX
comma
id|PCI_DEVICE_ID_PLX_1077
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_b2_4_921600
)brace
comma
(brace
id|PCI_VENDOR_ID_PLX
comma
id|PCI_DEVICE_ID_PLX_9050
comma
id|PCI_SUBVENDOR_ID_KEYSPAN
comma
id|PCI_SUBDEVICE_ID_KEYSPAN_SX2
comma
l_int|0
comma
l_int|0
comma
id|pbn_panacom
)brace
comma
(brace
id|PCI_VENDOR_ID_PANACOM
comma
id|PCI_DEVICE_ID_PANACOM_QUADMODEM
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_panacom4
)brace
comma
(brace
id|PCI_VENDOR_ID_PANACOM
comma
id|PCI_DEVICE_ID_PANACOM_DUALMODEM
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_panacom2
)brace
comma
(brace
id|PCI_VENDOR_ID_PLX
comma
id|PCI_DEVICE_ID_PLX_9050
comma
id|PCI_SUBVENDOR_ID_CHASE_PCIFAST
comma
id|PCI_SUBDEVICE_ID_CHASE_PCIFAST4
comma
l_int|0
comma
l_int|0
comma
id|pbn_b2_4_460800
)brace
comma
(brace
id|PCI_VENDOR_ID_PLX
comma
id|PCI_DEVICE_ID_PLX_9050
comma
id|PCI_SUBVENDOR_ID_CHASE_PCIFAST
comma
id|PCI_SUBDEVICE_ID_CHASE_PCIFAST8
comma
l_int|0
comma
l_int|0
comma
id|pbn_b2_8_460800
)brace
comma
(brace
id|PCI_VENDOR_ID_PLX
comma
id|PCI_DEVICE_ID_PLX_9050
comma
id|PCI_SUBVENDOR_ID_CHASE_PCIFAST
comma
id|PCI_SUBDEVICE_ID_CHASE_PCIFAST16
comma
l_int|0
comma
l_int|0
comma
id|pbn_b2_16_460800
)brace
comma
(brace
id|PCI_VENDOR_ID_PLX
comma
id|PCI_DEVICE_ID_PLX_9050
comma
id|PCI_SUBVENDOR_ID_CHASE_PCIFAST
comma
id|PCI_SUBDEVICE_ID_CHASE_PCIFAST16FMC
comma
l_int|0
comma
l_int|0
comma
id|pbn_b2_16_460800
)brace
comma
(brace
id|PCI_VENDOR_ID_PLX
comma
id|PCI_DEVICE_ID_PLX_9050
comma
id|PCI_SUBVENDOR_ID_CHASE_PCIRAS
comma
id|PCI_SUBDEVICE_ID_CHASE_PCIRAS4
comma
l_int|0
comma
l_int|0
comma
id|pbn_b2_4_460800
)brace
comma
(brace
id|PCI_VENDOR_ID_PLX
comma
id|PCI_DEVICE_ID_PLX_9050
comma
id|PCI_SUBVENDOR_ID_CHASE_PCIRAS
comma
id|PCI_SUBDEVICE_ID_CHASE_PCIRAS8
comma
l_int|0
comma
l_int|0
comma
id|pbn_b2_8_460800
)brace
comma
multiline_comment|/* Megawolf Romulus PCI Serial Card, from Mike Hudson */
multiline_comment|/* (Exoray@isys.ca) */
(brace
id|PCI_VENDOR_ID_PLX
comma
id|PCI_DEVICE_ID_PLX_ROMULUS
comma
l_int|0x10b5
comma
l_int|0x106a
comma
l_int|0
comma
l_int|0
comma
id|pbn_plx_romulus
)brace
comma
(brace
id|PCI_VENDOR_ID_QUATECH
comma
id|PCI_DEVICE_ID_QUATECH_QSC100
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_b1_4_115200
)brace
comma
(brace
id|PCI_VENDOR_ID_QUATECH
comma
id|PCI_DEVICE_ID_QUATECH_DSC100
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_b1_2_115200
)brace
comma
(brace
id|PCI_VENDOR_ID_QUATECH
comma
id|PCI_DEVICE_ID_QUATECH_ESC100D
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_b1_8_115200
)brace
comma
(brace
id|PCI_VENDOR_ID_QUATECH
comma
id|PCI_DEVICE_ID_QUATECH_ESC100M
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_b1_8_115200
)brace
comma
(brace
id|PCI_VENDOR_ID_SPECIALIX
comma
id|PCI_DEVICE_ID_OXSEMI_16PCI954
comma
id|PCI_VENDOR_ID_SPECIALIX
comma
id|PCI_SUBDEVICE_ID_SPECIALIX_SPEED4
comma
l_int|0
comma
l_int|0
comma
id|pbn_b0_4_921600
)brace
comma
(brace
id|PCI_VENDOR_ID_OXSEMI
comma
id|PCI_DEVICE_ID_OXSEMI_16PCI954
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_b0_4_115200
)brace
comma
(brace
id|PCI_VENDOR_ID_OXSEMI
comma
id|PCI_DEVICE_ID_OXSEMI_16PCI952
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_b0_2_115200
)brace
comma
multiline_comment|/* Digitan DS560-558, from jimd@esoft.com */
(brace
id|PCI_VENDOR_ID_ATT
comma
id|PCI_DEVICE_ID_ATT_VENUS_MODEM
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_b1_1_115200
)brace
comma
multiline_comment|/* 3Com US Robotics 56k Voice Internal PCI model 5610 */
(brace
id|PCI_VENDOR_ID_USR
comma
l_int|0x1008
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
)brace
comma
multiline_comment|/* Titan Electronic cards */
(brace
id|PCI_VENDOR_ID_TITAN
comma
id|PCI_DEVICE_ID_TITAN_100
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_b0_1_921600
)brace
comma
(brace
id|PCI_VENDOR_ID_TITAN
comma
id|PCI_DEVICE_ID_TITAN_200
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_b0_2_921600
)brace
comma
(brace
id|PCI_VENDOR_ID_TITAN
comma
id|PCI_DEVICE_ID_TITAN_400
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_b0_4_921600
)brace
comma
(brace
id|PCI_VENDOR_ID_TITAN
comma
id|PCI_DEVICE_ID_TITAN_800B
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_b0_4_921600
)brace
comma
(brace
id|PCI_VENDOR_ID_TITAN
comma
id|PCI_DEVICE_ID_TITAN_100L
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
id|SPCI_FL_BASE1
comma
l_int|1
comma
l_int|921600
)brace
comma
(brace
id|PCI_VENDOR_ID_TITAN
comma
id|PCI_DEVICE_ID_TITAN_200L
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
id|SPCI_FL_BASE1
op_or
id|SPCI_FL_BASE_TABLE
comma
l_int|2
comma
l_int|921600
)brace
comma
multiline_comment|/* The 400L and 800L have a custom hack in get_pci_port */
(brace
id|PCI_VENDOR_ID_TITAN
comma
id|PCI_DEVICE_ID_TITAN_400L
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
id|SPCI_FL_BASE_TABLE
comma
l_int|4
comma
l_int|921600
)brace
comma
(brace
id|PCI_VENDOR_ID_TITAN
comma
id|PCI_DEVICE_ID_TITAN_800L
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
id|SPCI_FL_BASE_TABLE
comma
l_int|8
comma
l_int|921600
)brace
comma
(brace
id|PCI_VENDOR_ID_SIIG
comma
id|PCI_DEVICE_ID_SIIG_1S_10x_550
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_siig10x_0
)brace
comma
(brace
id|PCI_VENDOR_ID_SIIG
comma
id|PCI_DEVICE_ID_SIIG_1S_10x_650
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_siig10x_0
)brace
comma
(brace
id|PCI_VENDOR_ID_SIIG
comma
id|PCI_DEVICE_ID_SIIG_1S_10x_850
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_siig10x_0
)brace
comma
(brace
id|PCI_VENDOR_ID_SIIG
comma
id|PCI_DEVICE_ID_SIIG_1S1P_10x_550
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_siig10x_1
)brace
comma
(brace
id|PCI_VENDOR_ID_SIIG
comma
id|PCI_DEVICE_ID_SIIG_1S1P_10x_650
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_siig10x_1
)brace
comma
(brace
id|PCI_VENDOR_ID_SIIG
comma
id|PCI_DEVICE_ID_SIIG_1S1P_10x_850
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_siig10x_1
)brace
comma
(brace
id|PCI_VENDOR_ID_SIIG
comma
id|PCI_DEVICE_ID_SIIG_2S_10x_550
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_siig10x_2
)brace
comma
(brace
id|PCI_VENDOR_ID_SIIG
comma
id|PCI_DEVICE_ID_SIIG_2S_10x_650
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_siig10x_2
)brace
comma
(brace
id|PCI_VENDOR_ID_SIIG
comma
id|PCI_DEVICE_ID_SIIG_2S_10x_850
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_siig10x_2
)brace
comma
(brace
id|PCI_VENDOR_ID_SIIG
comma
id|PCI_DEVICE_ID_SIIG_2S1P_10x_550
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_siig10x_2
)brace
comma
(brace
id|PCI_VENDOR_ID_SIIG
comma
id|PCI_DEVICE_ID_SIIG_2S1P_10x_650
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_siig10x_2
)brace
comma
(brace
id|PCI_VENDOR_ID_SIIG
comma
id|PCI_DEVICE_ID_SIIG_2S1P_10x_850
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_siig10x_2
)brace
comma
(brace
id|PCI_VENDOR_ID_SIIG
comma
id|PCI_DEVICE_ID_SIIG_4S_10x_550
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_siig10x_4
)brace
comma
(brace
id|PCI_VENDOR_ID_SIIG
comma
id|PCI_DEVICE_ID_SIIG_4S_10x_650
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_siig10x_4
)brace
comma
(brace
id|PCI_VENDOR_ID_SIIG
comma
id|PCI_DEVICE_ID_SIIG_4S_10x_850
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_siig10x_4
)brace
comma
(brace
id|PCI_VENDOR_ID_SIIG
comma
id|PCI_DEVICE_ID_SIIG_1S_20x_550
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_siig20x_0
)brace
comma
(brace
id|PCI_VENDOR_ID_SIIG
comma
id|PCI_DEVICE_ID_SIIG_1S_20x_650
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_siig20x_0
)brace
comma
(brace
id|PCI_VENDOR_ID_SIIG
comma
id|PCI_DEVICE_ID_SIIG_1S_20x_850
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_siig20x_0
)brace
comma
(brace
id|PCI_VENDOR_ID_SIIG
comma
id|PCI_DEVICE_ID_SIIG_1S1P_20x_550
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_siig20x_0
)brace
comma
(brace
id|PCI_VENDOR_ID_SIIG
comma
id|PCI_DEVICE_ID_SIIG_1S1P_20x_650
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_siig20x_0
)brace
comma
(brace
id|PCI_VENDOR_ID_SIIG
comma
id|PCI_DEVICE_ID_SIIG_1S1P_20x_850
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_siig20x_0
)brace
comma
(brace
id|PCI_VENDOR_ID_SIIG
comma
id|PCI_DEVICE_ID_SIIG_2P1S_20x_550
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_siig20x_0
)brace
comma
(brace
id|PCI_VENDOR_ID_SIIG
comma
id|PCI_DEVICE_ID_SIIG_2P1S_20x_650
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_siig20x_0
)brace
comma
(brace
id|PCI_VENDOR_ID_SIIG
comma
id|PCI_DEVICE_ID_SIIG_2P1S_20x_850
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_siig20x_0
)brace
comma
(brace
id|PCI_VENDOR_ID_SIIG
comma
id|PCI_DEVICE_ID_SIIG_2S_20x_550
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_siig20x_2
)brace
comma
(brace
id|PCI_VENDOR_ID_SIIG
comma
id|PCI_DEVICE_ID_SIIG_2S_20x_650
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_siig20x_2
)brace
comma
(brace
id|PCI_VENDOR_ID_SIIG
comma
id|PCI_DEVICE_ID_SIIG_2S_20x_850
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_siig20x_2
)brace
comma
(brace
id|PCI_VENDOR_ID_SIIG
comma
id|PCI_DEVICE_ID_SIIG_2S1P_20x_550
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_siig20x_2
)brace
comma
(brace
id|PCI_VENDOR_ID_SIIG
comma
id|PCI_DEVICE_ID_SIIG_2S1P_20x_650
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_siig20x_2
)brace
comma
(brace
id|PCI_VENDOR_ID_SIIG
comma
id|PCI_DEVICE_ID_SIIG_2S1P_20x_850
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_siig20x_2
)brace
comma
(brace
id|PCI_VENDOR_ID_SIIG
comma
id|PCI_DEVICE_ID_SIIG_4S_20x_550
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_siig20x_4
)brace
comma
(brace
id|PCI_VENDOR_ID_SIIG
comma
id|PCI_DEVICE_ID_SIIG_4S_20x_650
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_siig20x_4
)brace
comma
(brace
id|PCI_VENDOR_ID_SIIG
comma
id|PCI_DEVICE_ID_SIIG_4S_20x_850
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_siig20x_4
)brace
comma
multiline_comment|/* Computone devices submitted by Doug McNash dmcnash@computone.com */
(brace
id|PCI_VENDOR_ID_COMPUTONE
comma
id|PCI_DEVICE_ID_COMPUTONE_PG
comma
id|PCI_SUBVENDOR_ID_COMPUTONE
comma
id|PCI_SUBDEVICE_ID_COMPUTONE_PG4
comma
l_int|0
comma
l_int|0
comma
id|pbn_computone_4
)brace
comma
(brace
id|PCI_VENDOR_ID_COMPUTONE
comma
id|PCI_DEVICE_ID_COMPUTONE_PG
comma
id|PCI_SUBVENDOR_ID_COMPUTONE
comma
id|PCI_SUBDEVICE_ID_COMPUTONE_PG8
comma
l_int|0
comma
l_int|0
comma
id|pbn_computone_8
)brace
comma
(brace
id|PCI_VENDOR_ID_COMPUTONE
comma
id|PCI_DEVICE_ID_COMPUTONE_PG
comma
id|PCI_SUBVENDOR_ID_COMPUTONE
comma
id|PCI_SUBDEVICE_ID_COMPUTONE_PG6
comma
l_int|0
comma
l_int|0
comma
id|pbn_computone_6
)brace
comma
(brace
id|PCI_VENDOR_ID_OXSEMI
comma
id|PCI_DEVICE_ID_OXSEMI_16PCI95N
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_oxsemi
)brace
comma
(brace
id|PCI_VENDOR_ID_TIMEDIA
comma
id|PCI_DEVICE_ID_TIMEDIA_1889
comma
id|PCI_VENDOR_ID_TIMEDIA
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_timedia
)brace
comma
(brace
id|PCI_VENDOR_ID_LAVA
comma
id|PCI_DEVICE_ID_LAVA_DSERIAL
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_b0_bt_2_115200
)brace
comma
multiline_comment|/* AFAVLAB serial card, from Harald Welte &lt;laforge@gnumonks.org&gt; */
(brace
id|PCI_VENDOR_ID_AFAVLAB
comma
id|PCI_DEVICE_ID_AFAVLAB_P028
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_b0_bt_8_115200
)brace
comma
(brace
id|PCI_VENDOR_ID_LAVA
comma
id|PCI_DEVICE_ID_LAVA_QUATRO_A
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_b0_bt_2_115200
)brace
comma
(brace
id|PCI_VENDOR_ID_LAVA
comma
id|PCI_DEVICE_ID_LAVA_QUATRO_B
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_b0_bt_2_115200
)brace
comma
(brace
id|PCI_VENDOR_ID_LAVA
comma
id|PCI_DEVICE_ID_LAVA_PORT_PLUS
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_b0_bt_2_460800
)brace
comma
(brace
id|PCI_VENDOR_ID_LAVA
comma
id|PCI_DEVICE_ID_LAVA_QUAD_A
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_b0_bt_2_460800
)brace
comma
(brace
id|PCI_VENDOR_ID_LAVA
comma
id|PCI_DEVICE_ID_LAVA_QUAD_B
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_b0_bt_2_460800
)brace
comma
(brace
id|PCI_VENDOR_ID_LAVA
comma
id|PCI_DEVICE_ID_LAVA_SSERIAL
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_b0_bt_1_115200
)brace
comma
(brace
id|PCI_VENDOR_ID_LAVA
comma
id|PCI_DEVICE_ID_LAVA_PORT_650
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_b0_bt_1_460800
)brace
comma
multiline_comment|/* RAStel 2 port modem, gerg@moreton.com.au */
(brace
id|PCI_VENDOR_ID_MORETON
comma
id|PCI_DEVICE_ID_RASTEL_2PORT
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_b2_bt_2_115200
)brace
comma
multiline_comment|/* EKF addition for i960 Boards form EKF with serial port */
(brace
id|PCI_VENDOR_ID_INTEL
comma
l_int|0x1960
comma
l_int|0xE4BF
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_intel_i960
)brace
comma
multiline_comment|/* Xircom Cardbus/Ethernet combos */
(brace
id|PCI_VENDOR_ID_XIRCOM
comma
id|PCI_DEVICE_ID_XIRCOM_X3201_MDM
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_xircom_combo
)brace
comma
multiline_comment|/*&n;&t; * Untested PCI modems, sent in from various folks...&n;&t; */
multiline_comment|/* Elsa Model 56K PCI Modem, from Andreas Rath &lt;arh@01019freenet.de&gt; */
(brace
id|PCI_VENDOR_ID_ROCKWELL
comma
l_int|0x1004
comma
l_int|0x1048
comma
l_int|0x1500
comma
l_int|0
comma
l_int|0
comma
id|pbn_b1_1_115200
)brace
comma
(brace
id|PCI_VENDOR_ID_SGI
comma
id|PCI_DEVICE_ID_SGI_IOC3
comma
l_int|0xFF00
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
id|pbn_sgi_ioc3
)brace
comma
multiline_comment|/* HP Diva card */
(brace
id|PCI_VENDOR_ID_HP
comma
id|PCI_DEVICE_ID_HP_DIVA
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_hp_diva
)brace
comma
(brace
id|PCI_VENDOR_ID_HP
comma
id|PCI_DEVICE_ID_HP_DIVA_AUX
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_b2_1_115200
)brace
comma
multiline_comment|/*&n;&t; * NEC Vrc-5074 (Nile 4) builtin UART.&n;&t; */
(brace
id|PCI_VENDOR_ID_NEC
comma
id|PCI_DEVICE_ID_NEC_NILE4
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_nec_nile4
)brace
comma
(brace
id|PCI_VENDOR_ID_DCI
comma
id|PCI_DEVICE_ID_DCI_PCCOM4
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_dci_pccom4
)brace
comma
(brace
id|PCI_VENDOR_ID_DCI
comma
id|PCI_DEVICE_ID_DCI_PCCOM8
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
id|pbn_dci_pccom8
)brace
comma
(brace
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
id|PCI_CLASS_COMMUNICATION_SERIAL
op_lshift
l_int|8
comma
l_int|0xffff00
comma
)brace
comma
(brace
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
id|PCI_CLASS_COMMUNICATION_MODEM
op_lshift
l_int|8
comma
l_int|0xffff00
comma
)brace
comma
(brace
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
id|PCI_CLASS_COMMUNICATION_MULTISERIAL
op_lshift
l_int|8
comma
l_int|0xffff00
comma
)brace
comma
(brace
l_int|0
comma
)brace
)brace
suffix:semicolon
DECL|variable|serial_pci_driver
r_static
r_struct
id|pci_driver
id|serial_pci_driver
op_assign
(brace
dot
id|name
op_assign
l_string|&quot;serial&quot;
comma
dot
id|probe
op_assign
id|pci_init_one
comma
dot
id|remove
op_assign
id|__devexit_p
c_func
(paren
id|pci_remove_one
)paren
comma
dot
id|id_table
op_assign
id|serial_pci_tbl
comma
)brace
suffix:semicolon
DECL|function|serial8250_pci_init
r_static
r_int
id|__init
id|serial8250_pci_init
c_func
(paren
r_void
)paren
(brace
r_return
id|pci_module_init
c_func
(paren
op_amp
id|serial_pci_driver
)paren
suffix:semicolon
)brace
DECL|function|serial8250_pci_exit
r_static
r_void
id|__exit
id|serial8250_pci_exit
c_func
(paren
r_void
)paren
(brace
id|pci_unregister_driver
c_func
(paren
op_amp
id|serial_pci_driver
)paren
suffix:semicolon
)brace
DECL|variable|serial8250_pci_init
id|module_init
c_func
(paren
id|serial8250_pci_init
)paren
suffix:semicolon
DECL|variable|serial8250_pci_exit
id|module_exit
c_func
(paren
id|serial8250_pci_exit
)paren
suffix:semicolon
id|EXPORT_NO_SYMBOLS
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
id|MODULE_DESCRIPTION
c_func
(paren
l_string|&quot;Generic 8250/16x50 PCI serial probe module&quot;
)paren
suffix:semicolon
id|MODULE_DEVICE_TABLE
c_func
(paren
id|pci
comma
id|serial_pci_tbl
)paren
suffix:semicolon
eof
