multiline_comment|/*&n;    lm85.c - Part of lm_sensors, Linux kernel modules for hardware&n;             monitoring&n;    Copyright (c) 1998, 1999  Frodo Looijaard &lt;frodol@dds.nl&gt; &n;    Copyright (c) 2002, 2003  Philip Pokorny &lt;ppokorny@penguincomputing.com&gt;&n;    Copyright (c) 2003        Margit Schubert-While &lt;margitsw@t-online.de&gt;&n;    Copyright (c) 2004        Justin Thiessen &lt;jthiessen@penguincomputing.com&gt;&n;&n;    Chip details at&t;      &lt;http://www.national.com/ds/LM/LM85.pdf&gt;&n;&n;    This program is free software; you can redistribute it and/or modify&n;    it under the terms of the GNU General Public License as published by&n;    the Free Software Foundation; either version 2 of the License, or&n;    (at your option) any later version.&n;&n;    This program is distributed in the hope that it will be useful,&n;    but WITHOUT ANY WARRANTY; without even the implied warranty of&n;    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n;    GNU General Public License for more details.&n;&n;    You should have received a copy of the GNU General Public License&n;    along with this program; if not, write to the Free Software&n;    Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.&n;*/
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;linux/i2c.h&gt;
macro_line|#include &lt;linux/i2c-sensor.h&gt;
macro_line|#include &lt;linux/i2c-vid.h&gt;
multiline_comment|/* Addresses to scan */
DECL|variable|normal_i2c
r_static
r_int
r_int
id|normal_i2c
(braket
)braket
op_assign
(brace
l_int|0x2c
comma
l_int|0x2d
comma
l_int|0x2e
comma
id|I2C_CLIENT_END
)brace
suffix:semicolon
DECL|variable|normal_isa
r_static
r_int
r_int
id|normal_isa
(braket
)braket
op_assign
(brace
id|I2C_CLIENT_ISA_END
)brace
suffix:semicolon
multiline_comment|/* Insmod parameters */
id|SENSORS_INSMOD_5
c_func
(paren
id|lm85b
comma
id|lm85c
comma
id|adm1027
comma
id|adt7463
comma
id|emc6d100
)paren
suffix:semicolon
multiline_comment|/* The LM85 registers */
DECL|macro|LM85_REG_IN
mdefine_line|#define&t;LM85_REG_IN(nr)&t;&t;&t;(0x20 + (nr))
DECL|macro|LM85_REG_IN_MIN
mdefine_line|#define&t;LM85_REG_IN_MIN(nr)&t;&t;(0x44 + (nr) * 2)
DECL|macro|LM85_REG_IN_MAX
mdefine_line|#define&t;LM85_REG_IN_MAX(nr)&t;&t;(0x45 + (nr) * 2)
DECL|macro|LM85_REG_TEMP
mdefine_line|#define&t;LM85_REG_TEMP(nr)&t;&t;(0x25 + (nr))
DECL|macro|LM85_REG_TEMP_MIN
mdefine_line|#define&t;LM85_REG_TEMP_MIN(nr)&t;&t;(0x4e + (nr) * 2)
DECL|macro|LM85_REG_TEMP_MAX
mdefine_line|#define&t;LM85_REG_TEMP_MAX(nr)&t;&t;(0x4f + (nr) * 2)
multiline_comment|/* Fan speeds are LSB, MSB (2 bytes) */
DECL|macro|LM85_REG_FAN
mdefine_line|#define&t;LM85_REG_FAN(nr)&t;&t;(0x28 + (nr) *2)
DECL|macro|LM85_REG_FAN_MIN
mdefine_line|#define&t;LM85_REG_FAN_MIN(nr)&t;&t;(0x54 + (nr) *2)
DECL|macro|LM85_REG_PWM
mdefine_line|#define&t;LM85_REG_PWM(nr)&t;&t;(0x30 + (nr))
DECL|macro|ADT7463_REG_OPPOINT
mdefine_line|#define&t;ADT7463_REG_OPPOINT(nr)&t;&t;(0x33 + (nr))
DECL|macro|ADT7463_REG_TMIN_CTL1
mdefine_line|#define&t;ADT7463_REG_TMIN_CTL1&t;&t;0x36
DECL|macro|ADT7463_REG_TMIN_CTL2
mdefine_line|#define&t;ADT7463_REG_TMIN_CTL2&t;&t;0x37
DECL|macro|LM85_REG_DEVICE
mdefine_line|#define&t;LM85_REG_DEVICE&t;&t;&t;0x3d
DECL|macro|LM85_REG_COMPANY
mdefine_line|#define&t;LM85_REG_COMPANY&t;&t;0x3e
DECL|macro|LM85_REG_VERSTEP
mdefine_line|#define&t;LM85_REG_VERSTEP&t;&t;0x3f
multiline_comment|/* These are the recognized values for the above regs */
DECL|macro|LM85_DEVICE_ADX
mdefine_line|#define&t;LM85_DEVICE_ADX&t;&t;&t;0x27
DECL|macro|LM85_COMPANY_NATIONAL
mdefine_line|#define&t;LM85_COMPANY_NATIONAL&t;&t;0x01
DECL|macro|LM85_COMPANY_ANALOG_DEV
mdefine_line|#define&t;LM85_COMPANY_ANALOG_DEV&t;&t;0x41
DECL|macro|LM85_COMPANY_SMSC
mdefine_line|#define&t;LM85_COMPANY_SMSC      &t;&t;0x5c
DECL|macro|LM85_VERSTEP_VMASK
mdefine_line|#define&t;LM85_VERSTEP_VMASK              0xf0
DECL|macro|LM85_VERSTEP_GENERIC
mdefine_line|#define&t;LM85_VERSTEP_GENERIC&t;&t;0x60
DECL|macro|LM85_VERSTEP_LM85C
mdefine_line|#define&t;LM85_VERSTEP_LM85C&t;&t;0x60
DECL|macro|LM85_VERSTEP_LM85B
mdefine_line|#define&t;LM85_VERSTEP_LM85B&t;&t;0x62
DECL|macro|LM85_VERSTEP_ADM1027
mdefine_line|#define&t;LM85_VERSTEP_ADM1027&t;&t;0x60
DECL|macro|LM85_VERSTEP_ADT7463
mdefine_line|#define&t;LM85_VERSTEP_ADT7463&t;&t;0x62
DECL|macro|LM85_VERSTEP_EMC6D100_A0
mdefine_line|#define&t;LM85_VERSTEP_EMC6D100_A0        0x60
DECL|macro|LM85_VERSTEP_EMC6D100_A1
mdefine_line|#define&t;LM85_VERSTEP_EMC6D100_A1        0x61
DECL|macro|LM85_REG_CONFIG
mdefine_line|#define&t;LM85_REG_CONFIG&t;&t;&t;0x40
DECL|macro|LM85_REG_ALARM1
mdefine_line|#define&t;LM85_REG_ALARM1&t;&t;&t;0x41
DECL|macro|LM85_REG_ALARM2
mdefine_line|#define&t;LM85_REG_ALARM2&t;&t;&t;0x42
DECL|macro|LM85_REG_VID
mdefine_line|#define&t;LM85_REG_VID&t;&t;&t;0x43
multiline_comment|/* Automated FAN control */
DECL|macro|LM85_REG_AFAN_CONFIG
mdefine_line|#define&t;LM85_REG_AFAN_CONFIG(nr)&t;(0x5c + (nr))
DECL|macro|LM85_REG_AFAN_RANGE
mdefine_line|#define&t;LM85_REG_AFAN_RANGE(nr)&t;&t;(0x5f + (nr))
DECL|macro|LM85_REG_AFAN_SPIKE1
mdefine_line|#define&t;LM85_REG_AFAN_SPIKE1&t;&t;0x62
DECL|macro|LM85_REG_AFAN_SPIKE2
mdefine_line|#define&t;LM85_REG_AFAN_SPIKE2&t;&t;0x63
DECL|macro|LM85_REG_AFAN_MINPWM
mdefine_line|#define&t;LM85_REG_AFAN_MINPWM(nr)&t;(0x64 + (nr))
DECL|macro|LM85_REG_AFAN_LIMIT
mdefine_line|#define&t;LM85_REG_AFAN_LIMIT(nr)&t;&t;(0x67 + (nr))
DECL|macro|LM85_REG_AFAN_CRITICAL
mdefine_line|#define&t;LM85_REG_AFAN_CRITICAL(nr)&t;(0x6a + (nr))
DECL|macro|LM85_REG_AFAN_HYST1
mdefine_line|#define&t;LM85_REG_AFAN_HYST1&t;&t;0x6d
DECL|macro|LM85_REG_AFAN_HYST2
mdefine_line|#define&t;LM85_REG_AFAN_HYST2&t;&t;0x6e
DECL|macro|LM85_REG_TACH_MODE
mdefine_line|#define&t;LM85_REG_TACH_MODE&t;&t;0x74
DECL|macro|LM85_REG_SPINUP_CTL
mdefine_line|#define&t;LM85_REG_SPINUP_CTL&t;&t;0x75
DECL|macro|ADM1027_REG_TEMP_OFFSET
mdefine_line|#define&t;ADM1027_REG_TEMP_OFFSET(nr)&t;(0x70 + (nr))
DECL|macro|ADM1027_REG_CONFIG2
mdefine_line|#define&t;ADM1027_REG_CONFIG2&t;&t;0x73
DECL|macro|ADM1027_REG_INTMASK1
mdefine_line|#define&t;ADM1027_REG_INTMASK1&t;&t;0x74
DECL|macro|ADM1027_REG_INTMASK2
mdefine_line|#define&t;ADM1027_REG_INTMASK2&t;&t;0x75
DECL|macro|ADM1027_REG_EXTEND_ADC1
mdefine_line|#define&t;ADM1027_REG_EXTEND_ADC1&t;&t;0x76
DECL|macro|ADM1027_REG_EXTEND_ADC2
mdefine_line|#define&t;ADM1027_REG_EXTEND_ADC2&t;&t;0x77
DECL|macro|ADM1027_REG_CONFIG3
mdefine_line|#define&t;ADM1027_REG_CONFIG3&t;&t;0x78
DECL|macro|ADM1027_REG_FAN_PPR
mdefine_line|#define&t;ADM1027_REG_FAN_PPR&t;&t;0x7b
DECL|macro|ADT7463_REG_THERM
mdefine_line|#define&t;ADT7463_REG_THERM&t;&t;0x79
DECL|macro|ADT7463_REG_THERM_LIMIT
mdefine_line|#define&t;ADT7463_REG_THERM_LIMIT&t;&t;0x7A
DECL|macro|EMC6D100_REG_ALARM3
mdefine_line|#define EMC6D100_REG_ALARM3             0x7d
multiline_comment|/* IN5, IN6 and IN7 */
DECL|macro|EMC6D100_REG_IN
mdefine_line|#define EMC6D100_REG_IN(nr)             (0x70 + ((nr)-5))
DECL|macro|EMC6D100_REG_IN_MIN
mdefine_line|#define EMC6D100_REG_IN_MIN(nr)         (0x73 + ((nr)-5) * 2)
DECL|macro|EMC6D100_REG_IN_MAX
mdefine_line|#define EMC6D100_REG_IN_MAX(nr)         (0x74 + ((nr)-5) * 2)
DECL|macro|LM85_ALARM_IN0
mdefine_line|#define&t;LM85_ALARM_IN0&t;&t;&t;0x0001
DECL|macro|LM85_ALARM_IN1
mdefine_line|#define&t;LM85_ALARM_IN1&t;&t;&t;0x0002
DECL|macro|LM85_ALARM_IN2
mdefine_line|#define&t;LM85_ALARM_IN2&t;&t;&t;0x0004
DECL|macro|LM85_ALARM_IN3
mdefine_line|#define&t;LM85_ALARM_IN3&t;&t;&t;0x0008
DECL|macro|LM85_ALARM_TEMP1
mdefine_line|#define&t;LM85_ALARM_TEMP1&t;&t;0x0010
DECL|macro|LM85_ALARM_TEMP2
mdefine_line|#define&t;LM85_ALARM_TEMP2&t;&t;0x0020
DECL|macro|LM85_ALARM_TEMP3
mdefine_line|#define&t;LM85_ALARM_TEMP3&t;&t;0x0040
DECL|macro|LM85_ALARM_ALARM2
mdefine_line|#define&t;LM85_ALARM_ALARM2&t;&t;0x0080
DECL|macro|LM85_ALARM_IN4
mdefine_line|#define&t;LM85_ALARM_IN4&t;&t;&t;0x0100
DECL|macro|LM85_ALARM_RESERVED
mdefine_line|#define&t;LM85_ALARM_RESERVED&t;&t;0x0200
DECL|macro|LM85_ALARM_FAN1
mdefine_line|#define&t;LM85_ALARM_FAN1&t;&t;&t;0x0400
DECL|macro|LM85_ALARM_FAN2
mdefine_line|#define&t;LM85_ALARM_FAN2&t;&t;&t;0x0800
DECL|macro|LM85_ALARM_FAN3
mdefine_line|#define&t;LM85_ALARM_FAN3&t;&t;&t;0x1000
DECL|macro|LM85_ALARM_FAN4
mdefine_line|#define&t;LM85_ALARM_FAN4&t;&t;&t;0x2000
DECL|macro|LM85_ALARM_TEMP1_FAULT
mdefine_line|#define&t;LM85_ALARM_TEMP1_FAULT&t;&t;0x4000
DECL|macro|LM85_ALARM_TEMP3_FAULT
mdefine_line|#define&t;LM85_ALARM_TEMP3_FAULT&t;&t;0x8000
multiline_comment|/* Conversions. Rounding and limit checking is only done on the TO_REG &n;   variants. Note that you should be a bit careful with which arguments&n;   these macros are called: arguments may be evaluated more than once.&n; */
multiline_comment|/* IN are scaled 1.000 == 0xc0, mag = 3 */
DECL|macro|IN_TO_REG
mdefine_line|#define IN_TO_REG(val)&t;&t;(SENSORS_LIMIT((((val)*0xc0+500)/1000),0,255))
DECL|macro|INEXT_FROM_REG
mdefine_line|#define INEXT_FROM_REG(val,ext) (((val)*1000 + (ext)*250 + 96)/0xc0)
DECL|macro|IN_FROM_REG
mdefine_line|#define IN_FROM_REG(val)&t;(INEXT_FROM_REG(val,0))
multiline_comment|/* IN are scaled acording to built-in resistors */
DECL|variable|lm85_scaling
r_static
r_int
id|lm85_scaling
(braket
)braket
op_assign
(brace
multiline_comment|/* .001 Volts */
l_int|2500
comma
l_int|2250
comma
l_int|3300
comma
l_int|5000
comma
l_int|12000
comma
l_int|3300
comma
l_int|1500
comma
l_int|1800
multiline_comment|/*EMC6D100*/
)brace
suffix:semicolon
DECL|macro|SCALE
mdefine_line|#define SCALE(val,from,to)&t;&t;(((val)*(to) + ((from)/2))/(from))
DECL|macro|INS_TO_REG
mdefine_line|#define INS_TO_REG(n,val)&t;&t;(SENSORS_LIMIT(SCALE(val,lm85_scaling[n],192),0,255))
DECL|macro|INSEXT_FROM_REG
mdefine_line|#define INSEXT_FROM_REG(n,val,ext)&t;(SCALE((val)*4 + (ext),192*4,lm85_scaling[n]))
DECL|macro|INS_FROM_REG
mdefine_line|#define INS_FROM_REG(n,val)&t;&t;(INSEXT_FROM_REG(n,val,0))
multiline_comment|/* FAN speed is measured using 90kHz clock */
DECL|macro|FAN_TO_REG
mdefine_line|#define FAN_TO_REG(val)&t;&t;(SENSORS_LIMIT( (val)&lt;=0?0: 5400000/(val),0,65534))
DECL|macro|FAN_FROM_REG
mdefine_line|#define FAN_FROM_REG(val)&t;((val)==0?-1:(val)==0xffff?0:5400000/(val))
multiline_comment|/* Temperature is reported in .001 degC increments */
DECL|macro|TEMP_TO_REG
mdefine_line|#define TEMP_TO_REG(val)&t;&t;(SENSORS_LIMIT(((val)+500)/1000,-127,127))
DECL|macro|TEMPEXT_FROM_REG
mdefine_line|#define TEMPEXT_FROM_REG(val,ext)&t;((val)*1000 + (ext)*250)
DECL|macro|TEMP_FROM_REG
mdefine_line|#define TEMP_FROM_REG(val)&t;&t;(TEMPEXT_FROM_REG(val,0))
DECL|macro|EXTTEMP_TO_REG
mdefine_line|#define EXTTEMP_TO_REG(val)&t;&t;(SENSORS_LIMIT((val)/250,-127,127))
DECL|macro|PWM_TO_REG
mdefine_line|#define PWM_TO_REG(val)&t;&t;&t;(SENSORS_LIMIT(val,0,255))
DECL|macro|PWM_FROM_REG
mdefine_line|#define PWM_FROM_REG(val)&t;&t;(val)
DECL|macro|EXT_FROM_REG
mdefine_line|#define EXT_FROM_REG(val,sensor)&t;(((val)&gt;&gt;(sensor * 2))&amp;0x03)
multiline_comment|/* ZONEs have the following parameters:&n; *    Limit (low) temp,           1. degC&n; *    Hysteresis (below limit),   1. degC (0-15)&n; *    Range of speed control,     .1 degC (2-80)&n; *    Critical (high) temp,       1. degC&n; *&n; * FAN PWMs have the following parameters:&n; *    Reference Zone,                 1, 2, 3, etc.&n; *    Spinup time,                    .05 sec&n; *    PWM value at limit/low temp,    1 count&n; *    PWM Frequency,                  1. Hz&n; *    PWM is Min or OFF below limit,  flag&n; *    Invert PWM output,              flag&n; *&n; * Some chips filter the temp, others the fan.&n; *    Filter constant (or disabled)   .1 seconds&n; */
multiline_comment|/* These are the zone temperature range encodings in .001 degree C */
DECL|variable|lm85_range_map
r_static
r_int
id|lm85_range_map
(braket
)braket
op_assign
(brace
l_int|2000
comma
l_int|2500
comma
l_int|3300
comma
l_int|4000
comma
l_int|5000
comma
l_int|6600
comma
l_int|8000
comma
l_int|10000
comma
l_int|13300
comma
l_int|16000
comma
l_int|20000
comma
l_int|26600
comma
l_int|32000
comma
l_int|40000
comma
l_int|53300
comma
l_int|80000
)brace
suffix:semicolon
DECL|function|RANGE_TO_REG
r_static
r_int
id|RANGE_TO_REG
c_func
(paren
r_int
id|range
)paren
(brace
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
id|range
OL
id|lm85_range_map
(braket
l_int|0
)braket
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|range
OG
id|lm85_range_map
(braket
l_int|15
)braket
)paren
(brace
r_return
l_int|15
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* find closest match */
r_for
c_loop
(paren
id|i
op_assign
l_int|14
suffix:semicolon
id|i
op_ge
l_int|0
suffix:semicolon
op_decrement
id|i
)paren
(brace
r_if
c_cond
(paren
id|range
OG
id|lm85_range_map
(braket
id|i
)braket
)paren
(brace
multiline_comment|/* range bracketed */
r_if
c_cond
(paren
(paren
id|lm85_range_map
(braket
id|i
op_plus
l_int|1
)braket
op_minus
id|range
)paren
OL
(paren
id|range
op_minus
id|lm85_range_map
(braket
id|i
)braket
)paren
)paren
(brace
id|i
op_increment
suffix:semicolon
r_break
suffix:semicolon
)brace
r_break
suffix:semicolon
)brace
)brace
)brace
r_return
id|i
op_amp
l_int|0x0f
suffix:semicolon
)brace
DECL|macro|RANGE_FROM_REG
mdefine_line|#define RANGE_FROM_REG(val) (lm85_range_map[(val)&amp;0x0f])
multiline_comment|/* These are the Acoustic Enhancement, or Temperature smoothing encodings&n; * NOTE: The enable/disable bit is INCLUDED in these encodings as the&n; *       MSB (bit 3, value 8).  If the enable bit is 0, the encoded value&n; *       is ignored, or set to 0.&n; */
multiline_comment|/* These are the PWM frequency encodings */
DECL|variable|lm85_freq_map
r_static
r_int
id|lm85_freq_map
(braket
)braket
op_assign
(brace
multiline_comment|/* .1 Hz */
l_int|100
comma
l_int|150
comma
l_int|230
comma
l_int|300
comma
l_int|380
comma
l_int|470
comma
l_int|620
comma
l_int|940
)brace
suffix:semicolon
DECL|function|FREQ_TO_REG
r_static
r_int
id|FREQ_TO_REG
c_func
(paren
r_int
id|freq
)paren
(brace
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
id|freq
op_ge
id|lm85_freq_map
(braket
l_int|7
)braket
)paren
(brace
r_return
l_int|7
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|7
suffix:semicolon
op_increment
id|i
)paren
r_if
c_cond
(paren
id|freq
op_le
id|lm85_freq_map
(braket
id|i
)braket
)paren
(brace
r_break
suffix:semicolon
)brace
r_return
id|i
op_amp
l_int|0x07
suffix:semicolon
)brace
DECL|macro|FREQ_FROM_REG
mdefine_line|#define FREQ_FROM_REG(val) (lm85_freq_map[(val)&amp;0x07])
multiline_comment|/* Since we can&squot;t use strings, I&squot;m abusing these numbers&n; *   to stand in for the following meanings:&n; *      1 -- PWM responds to Zone 1&n; *      2 -- PWM responds to Zone 2&n; *      3 -- PWM responds to Zone 3&n; *     23 -- PWM responds to the higher temp of Zone 2 or 3&n; *    123 -- PWM responds to highest of Zone 1, 2, or 3&n; *      0 -- PWM is always at 0% (ie, off)&n; *     -1 -- PWM is always at 100%&n; *     -2 -- PWM responds to manual control&n; */
DECL|variable|lm85_zone_map
r_static
r_int
id|lm85_zone_map
(braket
)braket
op_assign
(brace
l_int|1
comma
l_int|2
comma
l_int|3
comma
op_minus
l_int|1
comma
l_int|0
comma
l_int|23
comma
l_int|123
comma
op_minus
l_int|2
)brace
suffix:semicolon
DECL|macro|ZONE_FROM_REG
mdefine_line|#define ZONE_FROM_REG(val) (lm85_zone_map[((val)&gt;&gt;5)&amp;0x07])
DECL|function|ZONE_TO_REG
r_static
r_int
id|ZONE_TO_REG
c_func
(paren
r_int
id|zone
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
l_int|7
suffix:semicolon
op_increment
id|i
)paren
r_if
c_cond
(paren
id|zone
op_eq
id|lm85_zone_map
(braket
id|i
)braket
)paren
(brace
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|i
OG
l_int|7
)paren
(brace
multiline_comment|/* Not found. */
id|i
op_assign
l_int|3
suffix:semicolon
)brace
multiline_comment|/* Always 100% */
r_return
(paren
id|i
op_amp
l_int|0x07
)paren
op_lshift
l_int|5
suffix:semicolon
)brace
DECL|macro|HYST_TO_REG
mdefine_line|#define HYST_TO_REG(val) (SENSORS_LIMIT(((val)+500)/1000,0,15))
DECL|macro|HYST_FROM_REG
mdefine_line|#define HYST_FROM_REG(val) ((val)*1000)
DECL|macro|OFFSET_TO_REG
mdefine_line|#define OFFSET_TO_REG(val) (SENSORS_LIMIT((val)/25,-127,127))
DECL|macro|OFFSET_FROM_REG
mdefine_line|#define OFFSET_FROM_REG(val) ((val)*25)
DECL|macro|PPR_MASK
mdefine_line|#define PPR_MASK(fan) (0x03&lt;&lt;(fan *2))
DECL|macro|PPR_TO_REG
mdefine_line|#define PPR_TO_REG(val,fan) (SENSORS_LIMIT((val)-1,0,3)&lt;&lt;(fan *2))
DECL|macro|PPR_FROM_REG
mdefine_line|#define PPR_FROM_REG(val,fan) ((((val)&gt;&gt;(fan * 2))&amp;0x03)+1)
multiline_comment|/* i2c-vid.h defines vid_from_reg() */
DECL|macro|VID_FROM_REG
mdefine_line|#define VID_FROM_REG(val,vrm) (vid_from_reg((val),(vrm)))
DECL|macro|ALARMS_FROM_REG
mdefine_line|#define ALARMS_FROM_REG(val) (val)
multiline_comment|/* Unlike some other drivers we DO NOT set initial limits.  Use&n; * the config file to set limits.  Some users have reported&n; * motherboards shutting down when we set limits in a previous&n; * version of the driver.&n; */
multiline_comment|/* Chip sampling rates&n; *&n; * Some sensors are not updated more frequently than once per second&n; *    so it doesn&squot;t make sense to read them more often than that.&n; *    We cache the results and return the saved data if the driver&n; *    is called again before a second has elapsed.&n; *&n; * Also, there is significant configuration data for this chip&n; *    given the automatic PWM fan control that is possible.  There&n; *    are about 47 bytes of config data to only 22 bytes of actual&n; *    readings.  So, we keep the config data up to date in the cache&n; *    when it is written and only sample it once every 1 *minute*&n; */
DECL|macro|LM85_DATA_INTERVAL
mdefine_line|#define LM85_DATA_INTERVAL  (HZ + HZ / 2)
DECL|macro|LM85_CONFIG_INTERVAL
mdefine_line|#define LM85_CONFIG_INTERVAL  (1 * 60 * HZ)
multiline_comment|/* For each registered LM85, we need to keep some data in memory. That&n;   data is pointed to by lm85_list[NR]-&gt;data. The structure itself is&n;   dynamically allocated, at the same time when a new lm85 client is&n;   allocated. */
multiline_comment|/* LM85 can automatically adjust fan speeds based on temperature&n; * This structure encapsulates an entire Zone config.  There are&n; * three zones (one for each temperature input) on the lm85&n; */
DECL|struct|lm85_zone
r_struct
id|lm85_zone
(brace
DECL|member|limit
id|s8
id|limit
suffix:semicolon
multiline_comment|/* Low temp limit */
DECL|member|hyst
id|u8
id|hyst
suffix:semicolon
multiline_comment|/* Low limit hysteresis. (0-15) */
DECL|member|range
id|u8
id|range
suffix:semicolon
multiline_comment|/* Temp range, encoded */
DECL|member|critical
id|s8
id|critical
suffix:semicolon
multiline_comment|/* &quot;All fans ON&quot; temp limit */
DECL|member|off_desired
id|u8
id|off_desired
suffix:semicolon
multiline_comment|/* Actual &quot;off&quot; temperature specified.  Preserved &n;&t;&t;&t; * to prevent &quot;drift&quot; as other autofan control&n;&t;&t;&t; * values change.&n;&t;&t;&t; */
DECL|member|max_desired
id|u8
id|max_desired
suffix:semicolon
multiline_comment|/* Actual &quot;max&quot; temperature specified.  Preserved &n;&t;&t;&t; * to prevent &quot;drift&quot; as other autofan control&n;&t;&t;&t; * values change.&n;&t;&t;&t; */
)brace
suffix:semicolon
DECL|struct|lm85_autofan
r_struct
id|lm85_autofan
(brace
DECL|member|config
id|u8
id|config
suffix:semicolon
multiline_comment|/* Register value */
DECL|member|freq
id|u8
id|freq
suffix:semicolon
multiline_comment|/* PWM frequency, encoded */
DECL|member|min_pwm
id|u8
id|min_pwm
suffix:semicolon
multiline_comment|/* Minimum PWM value, encoded */
DECL|member|min_off
id|u8
id|min_off
suffix:semicolon
multiline_comment|/* Min PWM or OFF below &quot;limit&quot;, flag */
)brace
suffix:semicolon
DECL|struct|lm85_data
r_struct
id|lm85_data
(brace
DECL|member|client
r_struct
id|i2c_client
id|client
suffix:semicolon
DECL|member|lock
r_struct
id|semaphore
id|lock
suffix:semicolon
DECL|member|type
r_enum
id|chips
id|type
suffix:semicolon
DECL|member|update_lock
r_struct
id|semaphore
id|update_lock
suffix:semicolon
DECL|member|valid
r_int
id|valid
suffix:semicolon
multiline_comment|/* !=0 if following fields are valid */
DECL|member|last_reading
r_int
r_int
id|last_reading
suffix:semicolon
multiline_comment|/* In jiffies */
DECL|member|last_config
r_int
r_int
id|last_config
suffix:semicolon
multiline_comment|/* In jiffies */
DECL|member|in
id|u8
id|in
(braket
l_int|8
)braket
suffix:semicolon
multiline_comment|/* Register value */
DECL|member|in_max
id|u8
id|in_max
(braket
l_int|8
)braket
suffix:semicolon
multiline_comment|/* Register value */
DECL|member|in_min
id|u8
id|in_min
(braket
l_int|8
)braket
suffix:semicolon
multiline_comment|/* Register value */
DECL|member|temp
id|s8
id|temp
(braket
l_int|3
)braket
suffix:semicolon
multiline_comment|/* Register value */
DECL|member|temp_min
id|s8
id|temp_min
(braket
l_int|3
)braket
suffix:semicolon
multiline_comment|/* Register value */
DECL|member|temp_max
id|s8
id|temp_max
(braket
l_int|3
)braket
suffix:semicolon
multiline_comment|/* Register value */
DECL|member|temp_offset
id|s8
id|temp_offset
(braket
l_int|3
)braket
suffix:semicolon
multiline_comment|/* Register value */
DECL|member|fan
id|u16
id|fan
(braket
l_int|4
)braket
suffix:semicolon
multiline_comment|/* Register value */
DECL|member|fan_min
id|u16
id|fan_min
(braket
l_int|4
)braket
suffix:semicolon
multiline_comment|/* Register value */
DECL|member|pwm
id|u8
id|pwm
(braket
l_int|3
)braket
suffix:semicolon
multiline_comment|/* Register value */
DECL|member|spinup_ctl
id|u8
id|spinup_ctl
suffix:semicolon
multiline_comment|/* Register encoding, combined */
DECL|member|tach_mode
id|u8
id|tach_mode
suffix:semicolon
multiline_comment|/* Register encoding, combined */
DECL|member|extend_adc
id|u16
id|extend_adc
suffix:semicolon
multiline_comment|/* Register value */
DECL|member|fan_ppr
id|u8
id|fan_ppr
suffix:semicolon
multiline_comment|/* Register value */
DECL|member|smooth
id|u8
id|smooth
(braket
l_int|3
)braket
suffix:semicolon
multiline_comment|/* Register encoding */
DECL|member|vid
id|u8
id|vid
suffix:semicolon
multiline_comment|/* Register value */
DECL|member|vrm
id|u8
id|vrm
suffix:semicolon
multiline_comment|/* VRM version */
DECL|member|syncpwm3
id|u8
id|syncpwm3
suffix:semicolon
multiline_comment|/* Saved PWM3 for TACH 2,3,4 config */
DECL|member|oppoint
id|u8
id|oppoint
(braket
l_int|3
)braket
suffix:semicolon
multiline_comment|/* Register value */
DECL|member|tmin_ctl
id|u16
id|tmin_ctl
suffix:semicolon
multiline_comment|/* Register value */
DECL|member|therm_total
r_int
r_int
id|therm_total
suffix:semicolon
multiline_comment|/* Cummulative therm count */
DECL|member|therm_limit
id|u8
id|therm_limit
suffix:semicolon
multiline_comment|/* Register value */
DECL|member|alarms
id|u32
id|alarms
suffix:semicolon
multiline_comment|/* Register encoding, combined */
DECL|member|autofan
r_struct
id|lm85_autofan
id|autofan
(braket
l_int|3
)braket
suffix:semicolon
DECL|member|zone
r_struct
id|lm85_zone
id|zone
(braket
l_int|3
)braket
suffix:semicolon
)brace
suffix:semicolon
r_static
r_int
id|lm85_attach_adapter
c_func
(paren
r_struct
id|i2c_adapter
op_star
id|adapter
)paren
suffix:semicolon
r_static
r_int
id|lm85_detect
c_func
(paren
r_struct
id|i2c_adapter
op_star
id|adapter
comma
r_int
id|address
comma
r_int
id|kind
)paren
suffix:semicolon
r_static
r_int
id|lm85_detach_client
c_func
(paren
r_struct
id|i2c_client
op_star
id|client
)paren
suffix:semicolon
r_static
r_int
id|lm85_read_value
c_func
(paren
r_struct
id|i2c_client
op_star
id|client
comma
id|u8
r_register
)paren
suffix:semicolon
r_static
r_int
id|lm85_write_value
c_func
(paren
r_struct
id|i2c_client
op_star
id|client
comma
id|u8
r_register
comma
r_int
id|value
)paren
suffix:semicolon
r_static
r_struct
id|lm85_data
op_star
id|lm85_update_device
c_func
(paren
r_struct
id|device
op_star
id|dev
)paren
suffix:semicolon
r_static
r_void
id|lm85_init_client
c_func
(paren
r_struct
id|i2c_client
op_star
id|client
)paren
suffix:semicolon
DECL|variable|lm85_driver
r_static
r_struct
id|i2c_driver
id|lm85_driver
op_assign
(brace
dot
id|owner
op_assign
id|THIS_MODULE
comma
dot
id|name
op_assign
l_string|&quot;lm85&quot;
comma
dot
id|id
op_assign
id|I2C_DRIVERID_LM85
comma
dot
id|flags
op_assign
id|I2C_DF_NOTIFY
comma
dot
id|attach_adapter
op_assign
id|lm85_attach_adapter
comma
dot
id|detach_client
op_assign
id|lm85_detach_client
comma
)brace
suffix:semicolon
multiline_comment|/* Unique ID assigned to each LM85 detected */
DECL|variable|lm85_id
r_static
r_int
id|lm85_id
suffix:semicolon
multiline_comment|/* 4 Fans */
DECL|function|show_fan
r_static
id|ssize_t
id|show_fan
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
comma
r_int
id|nr
)paren
(brace
r_struct
id|lm85_data
op_star
id|data
op_assign
id|lm85_update_device
c_func
(paren
id|dev
)paren
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%d&bslash;n&quot;
comma
id|FAN_FROM_REG
c_func
(paren
id|data-&gt;fan
(braket
id|nr
)braket
)paren
)paren
suffix:semicolon
)brace
DECL|function|show_fan_min
r_static
id|ssize_t
id|show_fan_min
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
comma
r_int
id|nr
)paren
(brace
r_struct
id|lm85_data
op_star
id|data
op_assign
id|lm85_update_device
c_func
(paren
id|dev
)paren
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%d&bslash;n&quot;
comma
id|FAN_FROM_REG
c_func
(paren
id|data-&gt;fan_min
(braket
id|nr
)braket
)paren
)paren
suffix:semicolon
)brace
DECL|function|set_fan_min
r_static
id|ssize_t
id|set_fan_min
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
comma
r_int
id|nr
)paren
(brace
r_struct
id|i2c_client
op_star
id|client
op_assign
id|to_i2c_client
c_func
(paren
id|dev
)paren
suffix:semicolon
r_struct
id|lm85_data
op_star
id|data
op_assign
id|i2c_get_clientdata
c_func
(paren
id|client
)paren
suffix:semicolon
r_int
id|val
suffix:semicolon
id|down
c_func
(paren
op_amp
id|data-&gt;update_lock
)paren
suffix:semicolon
id|val
op_assign
id|simple_strtol
c_func
(paren
id|buf
comma
l_int|NULL
comma
l_int|10
)paren
suffix:semicolon
id|data-&gt;fan_min
(braket
id|nr
)braket
op_assign
id|FAN_TO_REG
c_func
(paren
id|val
)paren
suffix:semicolon
id|lm85_write_value
c_func
(paren
id|client
comma
id|LM85_REG_FAN_MIN
c_func
(paren
id|nr
)paren
comma
id|data-&gt;fan_min
(braket
id|nr
)braket
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|data-&gt;update_lock
)paren
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
DECL|macro|show_fan_offset
mdefine_line|#define show_fan_offset(offset)&t;&t;&t;&t;&t;&t;&bslash;&n;static ssize_t show_fan_##offset (struct device *dev, char *buf)&t;&bslash;&n;{&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;&t;return show_fan(dev, buf, offset - 1);&t;&t;&t;&t;&bslash;&n;}&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;static ssize_t show_fan_##offset##_min (struct device *dev, char *buf)&t;&bslash;&n;{&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;&t;return show_fan_min(dev, buf, offset - 1);&t;&t;&t;&bslash;&n;}&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;static ssize_t set_fan_##offset##_min (struct device *dev, &t;&t;&bslash;&n;&t;const char *buf, size_t count) &t;&t;&t;&t;&t;&bslash;&n;{&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;&t;return set_fan_min(dev, buf, count, offset - 1);&t;&t;&bslash;&n;}&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;static DEVICE_ATTR(fan##offset##_input, S_IRUGO, show_fan_##offset,&t;&bslash;&n;&t;&t;NULL);&t;&t;&t;&t;&t;&t;&t;&bslash;&n;static DEVICE_ATTR(fan##offset##_min, S_IRUGO | S_IWUSR, &t;&t;&bslash;&n;&t;&t;show_fan_##offset##_min, set_fan_##offset##_min);
id|show_fan_offset
c_func
(paren
l_int|1
)paren
suffix:semicolon
id|show_fan_offset
c_func
(paren
l_int|2
)paren
suffix:semicolon
id|show_fan_offset
c_func
(paren
l_int|3
)paren
suffix:semicolon
id|show_fan_offset
c_func
(paren
l_int|4
)paren
suffix:semicolon
multiline_comment|/* vid, vrm, alarms */
DECL|function|show_vid_reg
r_static
id|ssize_t
id|show_vid_reg
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|lm85_data
op_star
id|data
op_assign
id|lm85_update_device
c_func
(paren
id|dev
)paren
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%ld&bslash;n&quot;
comma
(paren
r_int
)paren
id|vid_from_reg
c_func
(paren
id|data-&gt;vid
comma
id|data-&gt;vrm
)paren
)paren
suffix:semicolon
)brace
r_static
id|DEVICE_ATTR
c_func
(paren
id|cpu0_vid
comma
id|S_IRUGO
comma
id|show_vid_reg
comma
l_int|NULL
)paren
suffix:semicolon
DECL|function|show_vrm_reg
r_static
id|ssize_t
id|show_vrm_reg
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|lm85_data
op_star
id|data
op_assign
id|lm85_update_device
c_func
(paren
id|dev
)paren
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%ld&bslash;n&quot;
comma
(paren
r_int
)paren
id|data-&gt;vrm
)paren
suffix:semicolon
)brace
DECL|function|store_vrm_reg
r_static
id|ssize_t
id|store_vrm_reg
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
)paren
(brace
r_struct
id|i2c_client
op_star
id|client
op_assign
id|to_i2c_client
c_func
(paren
id|dev
)paren
suffix:semicolon
r_struct
id|lm85_data
op_star
id|data
op_assign
id|i2c_get_clientdata
c_func
(paren
id|client
)paren
suffix:semicolon
id|u32
id|val
suffix:semicolon
id|val
op_assign
id|simple_strtoul
c_func
(paren
id|buf
comma
l_int|NULL
comma
l_int|10
)paren
suffix:semicolon
id|data-&gt;vrm
op_assign
id|val
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
r_static
id|DEVICE_ATTR
c_func
(paren
id|vrm
comma
id|S_IRUGO
op_or
id|S_IWUSR
comma
id|show_vrm_reg
comma
id|store_vrm_reg
)paren
suffix:semicolon
DECL|function|show_alarms_reg
r_static
id|ssize_t
id|show_alarms_reg
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
)paren
(brace
r_struct
id|lm85_data
op_star
id|data
op_assign
id|lm85_update_device
c_func
(paren
id|dev
)paren
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%ld&bslash;n&quot;
comma
(paren
r_int
)paren
id|ALARMS_FROM_REG
c_func
(paren
id|data-&gt;alarms
)paren
)paren
suffix:semicolon
)brace
r_static
id|DEVICE_ATTR
c_func
(paren
id|alarms
comma
id|S_IRUGO
comma
id|show_alarms_reg
comma
l_int|NULL
)paren
suffix:semicolon
multiline_comment|/* pwm */
DECL|function|show_pwm
r_static
id|ssize_t
id|show_pwm
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
comma
r_int
id|nr
)paren
(brace
r_struct
id|lm85_data
op_star
id|data
op_assign
id|lm85_update_device
c_func
(paren
id|dev
)paren
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%d&bslash;n&quot;
comma
id|PWM_FROM_REG
c_func
(paren
id|data-&gt;pwm
(braket
id|nr
)braket
)paren
)paren
suffix:semicolon
)brace
DECL|function|set_pwm
r_static
id|ssize_t
id|set_pwm
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
comma
r_int
id|nr
)paren
(brace
r_struct
id|i2c_client
op_star
id|client
op_assign
id|to_i2c_client
c_func
(paren
id|dev
)paren
suffix:semicolon
r_struct
id|lm85_data
op_star
id|data
op_assign
id|i2c_get_clientdata
c_func
(paren
id|client
)paren
suffix:semicolon
r_int
id|val
suffix:semicolon
id|down
c_func
(paren
op_amp
id|data-&gt;update_lock
)paren
suffix:semicolon
id|val
op_assign
id|simple_strtol
c_func
(paren
id|buf
comma
l_int|NULL
comma
l_int|10
)paren
suffix:semicolon
id|data-&gt;pwm
(braket
id|nr
)braket
op_assign
id|PWM_TO_REG
c_func
(paren
id|val
)paren
suffix:semicolon
id|lm85_write_value
c_func
(paren
id|client
comma
id|LM85_REG_PWM
c_func
(paren
id|nr
)paren
comma
id|data-&gt;pwm
(braket
id|nr
)braket
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|data-&gt;update_lock
)paren
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
DECL|function|show_pwm_enable
r_static
id|ssize_t
id|show_pwm_enable
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
comma
r_int
id|nr
)paren
(brace
r_struct
id|lm85_data
op_star
id|data
op_assign
id|lm85_update_device
c_func
(paren
id|dev
)paren
suffix:semicolon
r_int
id|pwm_zone
suffix:semicolon
id|pwm_zone
op_assign
id|ZONE_FROM_REG
c_func
(paren
id|data-&gt;autofan
(braket
id|nr
)braket
dot
id|config
)paren
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%d&bslash;n&quot;
comma
(paren
id|pwm_zone
op_ne
l_int|0
op_logical_and
id|pwm_zone
op_ne
op_minus
l_int|1
)paren
)paren
suffix:semicolon
)brace
DECL|macro|show_pwm_reg
mdefine_line|#define show_pwm_reg(offset)&t;&t;&t;&t;&t;&t;&bslash;&n;static ssize_t show_pwm_##offset (struct device *dev, char *buf)&t;&bslash;&n;{&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;&t;return show_pwm(dev, buf, offset - 1);&t;&t;&t;&t;&bslash;&n;}&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;static ssize_t set_pwm_##offset (struct device *dev,&t;&t;&t;&bslash;&n;&t;&t;&t;&t; const char *buf, size_t count)&t;&t;&bslash;&n;{&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;&t;return set_pwm(dev, buf, count, offset - 1);&t;&t;&t;&bslash;&n;}&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;static ssize_t show_pwm_enable##offset (struct device *dev, char *buf)&t;&bslash;&n;{&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;&t;return show_pwm_enable(dev, buf, offset - 1);&t;&t;&t;&bslash;&n;}&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;static DEVICE_ATTR(pwm##offset, S_IRUGO | S_IWUSR, &t;&t;&t;&bslash;&n;&t;&t;show_pwm_##offset, set_pwm_##offset);&t;&t;&t;&bslash;&n;static DEVICE_ATTR(pwm##offset##_enable, S_IRUGO, &t;&t;&t;&bslash;&n;&t;&t;show_pwm_enable##offset, NULL);
id|show_pwm_reg
c_func
(paren
l_int|1
)paren
suffix:semicolon
id|show_pwm_reg
c_func
(paren
l_int|2
)paren
suffix:semicolon
id|show_pwm_reg
c_func
(paren
l_int|3
)paren
suffix:semicolon
multiline_comment|/* Voltages */
DECL|function|show_in
r_static
id|ssize_t
id|show_in
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
comma
r_int
id|nr
)paren
(brace
r_struct
id|lm85_data
op_star
id|data
op_assign
id|lm85_update_device
c_func
(paren
id|dev
)paren
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%d&bslash;n&quot;
comma
id|INS_FROM_REG
c_func
(paren
id|nr
comma
id|data-&gt;in
(braket
id|nr
)braket
)paren
)paren
suffix:semicolon
)brace
DECL|function|show_in_min
r_static
id|ssize_t
id|show_in_min
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
comma
r_int
id|nr
)paren
(brace
r_struct
id|lm85_data
op_star
id|data
op_assign
id|lm85_update_device
c_func
(paren
id|dev
)paren
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%d&bslash;n&quot;
comma
id|INS_FROM_REG
c_func
(paren
id|nr
comma
id|data-&gt;in_min
(braket
id|nr
)braket
)paren
)paren
suffix:semicolon
)brace
DECL|function|set_in_min
r_static
id|ssize_t
id|set_in_min
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
comma
r_int
id|nr
)paren
(brace
r_struct
id|i2c_client
op_star
id|client
op_assign
id|to_i2c_client
c_func
(paren
id|dev
)paren
suffix:semicolon
r_struct
id|lm85_data
op_star
id|data
op_assign
id|i2c_get_clientdata
c_func
(paren
id|client
)paren
suffix:semicolon
r_int
id|val
suffix:semicolon
id|down
c_func
(paren
op_amp
id|data-&gt;update_lock
)paren
suffix:semicolon
id|val
op_assign
id|simple_strtol
c_func
(paren
id|buf
comma
l_int|NULL
comma
l_int|10
)paren
suffix:semicolon
id|data-&gt;in_min
(braket
id|nr
)braket
op_assign
id|INS_TO_REG
c_func
(paren
id|nr
comma
id|val
)paren
suffix:semicolon
id|lm85_write_value
c_func
(paren
id|client
comma
id|LM85_REG_IN_MIN
c_func
(paren
id|nr
)paren
comma
id|data-&gt;in_min
(braket
id|nr
)braket
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|data-&gt;update_lock
)paren
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
DECL|function|show_in_max
r_static
id|ssize_t
id|show_in_max
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
comma
r_int
id|nr
)paren
(brace
r_struct
id|lm85_data
op_star
id|data
op_assign
id|lm85_update_device
c_func
(paren
id|dev
)paren
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%d&bslash;n&quot;
comma
id|INS_FROM_REG
c_func
(paren
id|nr
comma
id|data-&gt;in_max
(braket
id|nr
)braket
)paren
)paren
suffix:semicolon
)brace
DECL|function|set_in_max
r_static
id|ssize_t
id|set_in_max
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
comma
r_int
id|nr
)paren
(brace
r_struct
id|i2c_client
op_star
id|client
op_assign
id|to_i2c_client
c_func
(paren
id|dev
)paren
suffix:semicolon
r_struct
id|lm85_data
op_star
id|data
op_assign
id|i2c_get_clientdata
c_func
(paren
id|client
)paren
suffix:semicolon
r_int
id|val
suffix:semicolon
id|down
c_func
(paren
op_amp
id|data-&gt;update_lock
)paren
suffix:semicolon
id|val
op_assign
id|simple_strtol
c_func
(paren
id|buf
comma
l_int|NULL
comma
l_int|10
)paren
suffix:semicolon
id|data-&gt;in_max
(braket
id|nr
)braket
op_assign
id|INS_TO_REG
c_func
(paren
id|nr
comma
id|val
)paren
suffix:semicolon
id|lm85_write_value
c_func
(paren
id|client
comma
id|LM85_REG_IN_MAX
c_func
(paren
id|nr
)paren
comma
id|data-&gt;in_max
(braket
id|nr
)braket
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|data-&gt;update_lock
)paren
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
DECL|macro|show_in_reg
mdefine_line|#define show_in_reg(offset)&t;&t;&t;&t;&t;&t;&bslash;&n;static ssize_t show_in_##offset (struct device *dev, char *buf)&t;&t;&bslash;&n;{&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;&t;return show_in(dev, buf, offset);&t;&t;&t;&t;&bslash;&n;}&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;static ssize_t show_in_##offset##_min (struct device *dev, char *buf)&t;&bslash;&n;{&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;&t;return show_in_min(dev, buf, offset);&t;&t;&t;&t;&bslash;&n;}&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;static ssize_t show_in_##offset##_max (struct device *dev, char *buf)&t;&bslash;&n;{&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;&t;return show_in_max(dev, buf, offset);&t;&t;&t;&t;&bslash;&n;}&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;static ssize_t set_in_##offset##_min (struct device *dev, &t;&t;&bslash;&n;&t;const char *buf, size_t count) &t;&t;&t;&t;&t;&bslash;&n;{&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;&t;return set_in_min(dev, buf, count, offset);&t;&t;&t;&bslash;&n;}&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;static ssize_t set_in_##offset##_max (struct device *dev, &t;&t;&bslash;&n;&t;const char *buf, size_t count) &t;&t;&t;&t;&t;&bslash;&n;{&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;&t;return set_in_max(dev, buf, count, offset);&t;&t;&t;&bslash;&n;}&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;static DEVICE_ATTR(in##offset##_input, S_IRUGO, show_in_##offset, &t;&bslash;&n;&t;&t;NULL);&t;&t;&t;&t;&t;&t;&t;&bslash;&n;static DEVICE_ATTR(in##offset##_min, S_IRUGO | S_IWUSR, &t;&t;&bslash;&n;&t;&t;show_in_##offset##_min, set_in_##offset##_min);&t;&t;&bslash;&n;static DEVICE_ATTR(in##offset##_max, S_IRUGO | S_IWUSR, &t;&t;&bslash;&n;&t;&t;show_in_##offset##_max, set_in_##offset##_max);
id|show_in_reg
c_func
(paren
l_int|0
)paren
suffix:semicolon
id|show_in_reg
c_func
(paren
l_int|1
)paren
suffix:semicolon
id|show_in_reg
c_func
(paren
l_int|2
)paren
suffix:semicolon
id|show_in_reg
c_func
(paren
l_int|3
)paren
suffix:semicolon
id|show_in_reg
c_func
(paren
l_int|4
)paren
suffix:semicolon
multiline_comment|/* Temps */
DECL|function|show_temp
r_static
id|ssize_t
id|show_temp
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
comma
r_int
id|nr
)paren
(brace
r_struct
id|lm85_data
op_star
id|data
op_assign
id|lm85_update_device
c_func
(paren
id|dev
)paren
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%d&bslash;n&quot;
comma
id|TEMP_FROM_REG
c_func
(paren
id|data-&gt;temp
(braket
id|nr
)braket
)paren
)paren
suffix:semicolon
)brace
DECL|function|show_temp_min
r_static
id|ssize_t
id|show_temp_min
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
comma
r_int
id|nr
)paren
(brace
r_struct
id|lm85_data
op_star
id|data
op_assign
id|lm85_update_device
c_func
(paren
id|dev
)paren
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%d&bslash;n&quot;
comma
id|TEMP_FROM_REG
c_func
(paren
id|data-&gt;temp_min
(braket
id|nr
)braket
)paren
)paren
suffix:semicolon
)brace
DECL|function|set_temp_min
r_static
id|ssize_t
id|set_temp_min
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
comma
r_int
id|nr
)paren
(brace
r_struct
id|i2c_client
op_star
id|client
op_assign
id|to_i2c_client
c_func
(paren
id|dev
)paren
suffix:semicolon
r_struct
id|lm85_data
op_star
id|data
op_assign
id|i2c_get_clientdata
c_func
(paren
id|client
)paren
suffix:semicolon
r_int
id|val
suffix:semicolon
id|down
c_func
(paren
op_amp
id|data-&gt;update_lock
)paren
suffix:semicolon
id|val
op_assign
id|simple_strtol
c_func
(paren
id|buf
comma
l_int|NULL
comma
l_int|10
)paren
suffix:semicolon
id|data-&gt;temp_min
(braket
id|nr
)braket
op_assign
id|TEMP_TO_REG
c_func
(paren
id|val
)paren
suffix:semicolon
id|lm85_write_value
c_func
(paren
id|client
comma
id|LM85_REG_TEMP_MIN
c_func
(paren
id|nr
)paren
comma
id|data-&gt;temp_min
(braket
id|nr
)braket
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|data-&gt;update_lock
)paren
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
DECL|function|show_temp_max
r_static
id|ssize_t
id|show_temp_max
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
comma
r_int
id|nr
)paren
(brace
r_struct
id|lm85_data
op_star
id|data
op_assign
id|lm85_update_device
c_func
(paren
id|dev
)paren
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%d&bslash;n&quot;
comma
id|TEMP_FROM_REG
c_func
(paren
id|data-&gt;temp_max
(braket
id|nr
)braket
)paren
)paren
suffix:semicolon
)brace
DECL|function|set_temp_max
r_static
id|ssize_t
id|set_temp_max
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
comma
r_int
id|nr
)paren
(brace
r_struct
id|i2c_client
op_star
id|client
op_assign
id|to_i2c_client
c_func
(paren
id|dev
)paren
suffix:semicolon
r_struct
id|lm85_data
op_star
id|data
op_assign
id|i2c_get_clientdata
c_func
(paren
id|client
)paren
suffix:semicolon
r_int
id|val
suffix:semicolon
id|down
c_func
(paren
op_amp
id|data-&gt;update_lock
)paren
suffix:semicolon
id|val
op_assign
id|simple_strtol
c_func
(paren
id|buf
comma
l_int|NULL
comma
l_int|10
)paren
suffix:semicolon
id|data-&gt;temp_max
(braket
id|nr
)braket
op_assign
id|TEMP_TO_REG
c_func
(paren
id|val
)paren
suffix:semicolon
id|lm85_write_value
c_func
(paren
id|client
comma
id|LM85_REG_TEMP_MAX
c_func
(paren
id|nr
)paren
comma
id|data-&gt;temp_max
(braket
id|nr
)braket
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|data-&gt;update_lock
)paren
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
DECL|macro|show_temp_reg
mdefine_line|#define show_temp_reg(offset)&t;&t;&t;&t;&t;&t;&bslash;&n;static ssize_t show_temp_##offset (struct device *dev, char *buf)&t;&bslash;&n;{&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;&t;return show_temp(dev, buf, offset - 1);&t;&t;&t;&t;&bslash;&n;}&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;static ssize_t show_temp_##offset##_min (struct device *dev, char *buf)&t;&bslash;&n;{&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;&t;return show_temp_min(dev, buf, offset - 1);&t;&t;&t;&bslash;&n;}&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;static ssize_t show_temp_##offset##_max (struct device *dev, char *buf)&t;&bslash;&n;{&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;&t;return show_temp_max(dev, buf, offset - 1);&t;&t;&t;&bslash;&n;}&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;static ssize_t set_temp_##offset##_min (struct device *dev, &t;&t;&bslash;&n;&t;const char *buf, size_t count) &t;&t;&t;&t;&t;&bslash;&n;{&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;&t;return set_temp_min(dev, buf, count, offset - 1);&t;&t;&bslash;&n;}&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;static ssize_t set_temp_##offset##_max (struct device *dev, &t;&t;&bslash;&n;&t;const char *buf, size_t count) &t;&t;&t;&t;&t;&bslash;&n;{&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;&t;return set_temp_max(dev, buf, count, offset - 1);&t;&t;&bslash;&n;}&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;static DEVICE_ATTR(temp##offset##_input, S_IRUGO, show_temp_##offset,&t;&bslash;&n;&t;&t;NULL);&t;&t;&t;&t;&t;&t;&t;&bslash;&n;static DEVICE_ATTR(temp##offset##_min, S_IRUGO | S_IWUSR, &t;&t;&bslash;&n;&t;&t;show_temp_##offset##_min, set_temp_##offset##_min);&t;&bslash;&n;static DEVICE_ATTR(temp##offset##_max, S_IRUGO | S_IWUSR, &t;&t;&bslash;&n;&t;&t;show_temp_##offset##_max, set_temp_##offset##_max);
id|show_temp_reg
c_func
(paren
l_int|1
)paren
suffix:semicolon
id|show_temp_reg
c_func
(paren
l_int|2
)paren
suffix:semicolon
id|show_temp_reg
c_func
(paren
l_int|3
)paren
suffix:semicolon
multiline_comment|/* Automatic PWM control */
DECL|function|show_pwm_auto_channels
r_static
id|ssize_t
id|show_pwm_auto_channels
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
comma
r_int
id|nr
)paren
(brace
r_struct
id|lm85_data
op_star
id|data
op_assign
id|lm85_update_device
c_func
(paren
id|dev
)paren
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%d&bslash;n&quot;
comma
id|ZONE_FROM_REG
c_func
(paren
id|data-&gt;autofan
(braket
id|nr
)braket
dot
id|config
)paren
)paren
suffix:semicolon
)brace
DECL|function|set_pwm_auto_channels
r_static
id|ssize_t
id|set_pwm_auto_channels
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
comma
r_int
id|nr
)paren
(brace
r_struct
id|i2c_client
op_star
id|client
op_assign
id|to_i2c_client
c_func
(paren
id|dev
)paren
suffix:semicolon
r_struct
id|lm85_data
op_star
id|data
op_assign
id|i2c_get_clientdata
c_func
(paren
id|client
)paren
suffix:semicolon
r_int
id|val
suffix:semicolon
id|down
c_func
(paren
op_amp
id|data-&gt;update_lock
)paren
suffix:semicolon
id|val
op_assign
id|simple_strtol
c_func
(paren
id|buf
comma
l_int|NULL
comma
l_int|10
)paren
suffix:semicolon
id|data-&gt;autofan
(braket
id|nr
)braket
dot
id|config
op_assign
(paren
id|data-&gt;autofan
(braket
id|nr
)braket
dot
id|config
op_amp
(paren
op_complement
l_int|0xe0
)paren
)paren
op_or
id|ZONE_TO_REG
c_func
(paren
id|val
)paren
suffix:semicolon
id|lm85_write_value
c_func
(paren
id|client
comma
id|LM85_REG_AFAN_CONFIG
c_func
(paren
id|nr
)paren
comma
id|data-&gt;autofan
(braket
id|nr
)braket
dot
id|config
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|data-&gt;update_lock
)paren
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
DECL|function|show_pwm_auto_pwm_min
r_static
id|ssize_t
id|show_pwm_auto_pwm_min
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
comma
r_int
id|nr
)paren
(brace
r_struct
id|lm85_data
op_star
id|data
op_assign
id|lm85_update_device
c_func
(paren
id|dev
)paren
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%d&bslash;n&quot;
comma
id|PWM_FROM_REG
c_func
(paren
id|data-&gt;autofan
(braket
id|nr
)braket
dot
id|min_pwm
)paren
)paren
suffix:semicolon
)brace
DECL|function|set_pwm_auto_pwm_min
r_static
id|ssize_t
id|set_pwm_auto_pwm_min
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
comma
r_int
id|nr
)paren
(brace
r_struct
id|i2c_client
op_star
id|client
op_assign
id|to_i2c_client
c_func
(paren
id|dev
)paren
suffix:semicolon
r_struct
id|lm85_data
op_star
id|data
op_assign
id|i2c_get_clientdata
c_func
(paren
id|client
)paren
suffix:semicolon
r_int
id|val
suffix:semicolon
id|down
c_func
(paren
op_amp
id|data-&gt;update_lock
)paren
suffix:semicolon
id|val
op_assign
id|simple_strtol
c_func
(paren
id|buf
comma
l_int|NULL
comma
l_int|10
)paren
suffix:semicolon
id|data-&gt;autofan
(braket
id|nr
)braket
dot
id|min_pwm
op_assign
id|PWM_TO_REG
c_func
(paren
id|val
)paren
suffix:semicolon
id|lm85_write_value
c_func
(paren
id|client
comma
id|LM85_REG_AFAN_MINPWM
c_func
(paren
id|nr
)paren
comma
id|data-&gt;autofan
(braket
id|nr
)braket
dot
id|min_pwm
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|data-&gt;update_lock
)paren
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
DECL|function|show_pwm_auto_pwm_minctl
r_static
id|ssize_t
id|show_pwm_auto_pwm_minctl
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
comma
r_int
id|nr
)paren
(brace
r_struct
id|lm85_data
op_star
id|data
op_assign
id|lm85_update_device
c_func
(paren
id|dev
)paren
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%d&bslash;n&quot;
comma
id|data-&gt;autofan
(braket
id|nr
)braket
dot
id|min_off
)paren
suffix:semicolon
)brace
DECL|function|set_pwm_auto_pwm_minctl
r_static
id|ssize_t
id|set_pwm_auto_pwm_minctl
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
comma
r_int
id|nr
)paren
(brace
r_struct
id|i2c_client
op_star
id|client
op_assign
id|to_i2c_client
c_func
(paren
id|dev
)paren
suffix:semicolon
r_struct
id|lm85_data
op_star
id|data
op_assign
id|i2c_get_clientdata
c_func
(paren
id|client
)paren
suffix:semicolon
r_int
id|val
suffix:semicolon
id|down
c_func
(paren
op_amp
id|data-&gt;update_lock
)paren
suffix:semicolon
id|val
op_assign
id|simple_strtol
c_func
(paren
id|buf
comma
l_int|NULL
comma
l_int|10
)paren
suffix:semicolon
id|data-&gt;autofan
(braket
id|nr
)braket
dot
id|min_off
op_assign
id|val
suffix:semicolon
id|lm85_write_value
c_func
(paren
id|client
comma
id|LM85_REG_AFAN_SPIKE1
comma
id|data-&gt;smooth
(braket
l_int|0
)braket
op_or
id|data-&gt;syncpwm3
op_or
(paren
id|data-&gt;autofan
(braket
l_int|0
)braket
dot
id|min_off
ques
c_cond
l_int|0x20
suffix:colon
l_int|0
)paren
op_or
(paren
id|data-&gt;autofan
(braket
l_int|1
)braket
dot
id|min_off
ques
c_cond
l_int|0x40
suffix:colon
l_int|0
)paren
op_or
(paren
id|data-&gt;autofan
(braket
l_int|2
)braket
dot
id|min_off
ques
c_cond
l_int|0x80
suffix:colon
l_int|0
)paren
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|data-&gt;update_lock
)paren
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
DECL|function|show_pwm_auto_pwm_freq
r_static
id|ssize_t
id|show_pwm_auto_pwm_freq
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
comma
r_int
id|nr
)paren
(brace
r_struct
id|lm85_data
op_star
id|data
op_assign
id|lm85_update_device
c_func
(paren
id|dev
)paren
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%d&bslash;n&quot;
comma
id|FREQ_FROM_REG
c_func
(paren
id|data-&gt;autofan
(braket
id|nr
)braket
dot
id|freq
)paren
)paren
suffix:semicolon
)brace
DECL|function|set_pwm_auto_pwm_freq
r_static
id|ssize_t
id|set_pwm_auto_pwm_freq
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
comma
r_int
id|nr
)paren
(brace
r_struct
id|i2c_client
op_star
id|client
op_assign
id|to_i2c_client
c_func
(paren
id|dev
)paren
suffix:semicolon
r_struct
id|lm85_data
op_star
id|data
op_assign
id|i2c_get_clientdata
c_func
(paren
id|client
)paren
suffix:semicolon
r_int
id|val
suffix:semicolon
id|down
c_func
(paren
op_amp
id|data-&gt;update_lock
)paren
suffix:semicolon
id|val
op_assign
id|simple_strtol
c_func
(paren
id|buf
comma
l_int|NULL
comma
l_int|10
)paren
suffix:semicolon
id|data-&gt;autofan
(braket
id|nr
)braket
dot
id|freq
op_assign
id|FREQ_TO_REG
c_func
(paren
id|val
)paren
suffix:semicolon
id|lm85_write_value
c_func
(paren
id|client
comma
id|LM85_REG_AFAN_RANGE
c_func
(paren
id|nr
)paren
comma
(paren
id|data-&gt;zone
(braket
id|nr
)braket
dot
id|range
op_lshift
l_int|4
)paren
op_or
id|data-&gt;autofan
(braket
id|nr
)braket
dot
id|freq
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|data-&gt;update_lock
)paren
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
DECL|macro|pwm_auto
mdefine_line|#define pwm_auto(offset)&t;&t;&t;&t;&t;&t;&bslash;&n;static ssize_t show_pwm##offset##_auto_channels (struct device *dev,&t;&bslash;&n;&t;char *buf)&t;&t;&t;&t;&t;&t;&t;&bslash;&n;{&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;&t;return show_pwm_auto_channels(dev, buf, offset - 1);&t;&t;&bslash;&n;}&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;static ssize_t set_pwm##offset##_auto_channels (struct device *dev,&t;&bslash;&n;&t;const char *buf, size_t count)&t;&t;&t;&t;&t;&bslash;&n;{&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;&t;return set_pwm_auto_channels(dev, buf, count, offset - 1);&t;&bslash;&n;}&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;static ssize_t show_pwm##offset##_auto_pwm_min (struct device *dev,&t;&bslash;&n;&t;char *buf)&t;&t;&t;&t;&t;&t;&t;&bslash;&n;{&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;&t;return show_pwm_auto_pwm_min(dev, buf, offset - 1);&t;&t;&bslash;&n;}&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;static ssize_t set_pwm##offset##_auto_pwm_min (struct device *dev,&t;&bslash;&n;&t;const char *buf, size_t count)&t;&t;&t;&t;&t;&bslash;&n;{&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;&t;return set_pwm_auto_pwm_min(dev, buf, count, offset - 1);&t;&bslash;&n;}&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;static ssize_t show_pwm##offset##_auto_pwm_minctl (struct device *dev,&t;&bslash;&n;&t;char *buf)&t;&t;&t;&t;&t;&t;&t;&bslash;&n;{&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;&t;return show_pwm_auto_pwm_minctl(dev, buf, offset - 1);&t;&t;&bslash;&n;}&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;static ssize_t set_pwm##offset##_auto_pwm_minctl (struct device *dev,&t;&bslash;&n;&t;const char *buf, size_t count)&t;&t;&t;&t;&t;&bslash;&n;{&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;&t;return set_pwm_auto_pwm_minctl(dev, buf, count, offset - 1);&t;&bslash;&n;}&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;static ssize_t show_pwm##offset##_auto_pwm_freq (struct device *dev,&t;&bslash;&n;&t;char *buf)&t;&t;&t;&t;&t;&t;&t;&bslash;&n;{&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;&t;return show_pwm_auto_pwm_freq(dev, buf, offset - 1);&t;&t;&bslash;&n;}&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;static ssize_t set_pwm##offset##_auto_pwm_freq(struct device *dev,&t;&bslash;&n;&t;const char *buf, size_t count)&t;&t;&t;&t;&t;&bslash;&n;{&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;&t;return set_pwm_auto_pwm_freq(dev, buf, count, offset - 1);&t;&bslash;&n;}&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;static DEVICE_ATTR(pwm##offset##_auto_channels, S_IRUGO | S_IWUSR,&t;&bslash;&n;&t;&t;show_pwm##offset##_auto_channels,&t;&t;&t;&bslash;&n;&t;&t;set_pwm##offset##_auto_channels);&t;&t;&t;&bslash;&n;static DEVICE_ATTR(pwm##offset##_auto_pwm_min, S_IRUGO | S_IWUSR,&t;&bslash;&n;&t;&t;show_pwm##offset##_auto_pwm_min,&t;&t;&t;&bslash;&n;&t;&t;set_pwm##offset##_auto_pwm_min);&t;&t;&t;&bslash;&n;static DEVICE_ATTR(pwm##offset##_auto_pwm_minctl, S_IRUGO | S_IWUSR,&t;&bslash;&n;&t;&t;show_pwm##offset##_auto_pwm_minctl,&t;&t;&t;&bslash;&n;&t;&t;set_pwm##offset##_auto_pwm_minctl);&t;&t;&t;&bslash;&n;static DEVICE_ATTR(pwm##offset##_auto_pwm_freq, S_IRUGO | S_IWUSR,&t;&bslash;&n;&t;&t;show_pwm##offset##_auto_pwm_freq,&t;&t;&t;&bslash;&n;&t;&t;set_pwm##offset##_auto_pwm_freq);              
id|pwm_auto
c_func
(paren
l_int|1
)paren
suffix:semicolon
id|pwm_auto
c_func
(paren
l_int|2
)paren
suffix:semicolon
id|pwm_auto
c_func
(paren
l_int|3
)paren
suffix:semicolon
multiline_comment|/* Temperature settings for automatic PWM control */
DECL|function|show_temp_auto_temp_off
r_static
id|ssize_t
id|show_temp_auto_temp_off
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
comma
r_int
id|nr
)paren
(brace
r_struct
id|lm85_data
op_star
id|data
op_assign
id|lm85_update_device
c_func
(paren
id|dev
)paren
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%d&bslash;n&quot;
comma
id|TEMP_FROM_REG
c_func
(paren
id|data-&gt;zone
(braket
id|nr
)braket
dot
id|limit
)paren
op_minus
id|HYST_FROM_REG
c_func
(paren
id|data-&gt;zone
(braket
id|nr
)braket
dot
id|hyst
)paren
)paren
suffix:semicolon
)brace
DECL|function|set_temp_auto_temp_off
r_static
id|ssize_t
id|set_temp_auto_temp_off
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
comma
r_int
id|nr
)paren
(brace
r_struct
id|i2c_client
op_star
id|client
op_assign
id|to_i2c_client
c_func
(paren
id|dev
)paren
suffix:semicolon
r_struct
id|lm85_data
op_star
id|data
op_assign
id|i2c_get_clientdata
c_func
(paren
id|client
)paren
suffix:semicolon
r_int
id|min
comma
id|val
suffix:semicolon
id|down
c_func
(paren
op_amp
id|data-&gt;update_lock
)paren
suffix:semicolon
id|val
op_assign
id|simple_strtol
c_func
(paren
id|buf
comma
l_int|NULL
comma
l_int|10
)paren
suffix:semicolon
id|min
op_assign
id|TEMP_FROM_REG
c_func
(paren
id|data-&gt;zone
(braket
id|nr
)braket
dot
id|limit
)paren
suffix:semicolon
id|data-&gt;zone
(braket
id|nr
)braket
dot
id|off_desired
op_assign
id|TEMP_TO_REG
c_func
(paren
id|val
)paren
suffix:semicolon
id|data-&gt;zone
(braket
id|nr
)braket
dot
id|hyst
op_assign
id|HYST_TO_REG
c_func
(paren
id|min
op_minus
id|val
)paren
suffix:semicolon
r_if
c_cond
(paren
id|nr
op_eq
l_int|0
op_logical_or
id|nr
op_eq
l_int|1
)paren
(brace
id|lm85_write_value
c_func
(paren
id|client
comma
id|LM85_REG_AFAN_HYST1
comma
(paren
id|data-&gt;zone
(braket
l_int|0
)braket
dot
id|hyst
op_lshift
l_int|4
)paren
op_or
id|data-&gt;zone
(braket
l_int|1
)braket
dot
id|hyst
)paren
suffix:semicolon
)brace
r_else
(brace
id|lm85_write_value
c_func
(paren
id|client
comma
id|LM85_REG_AFAN_HYST2
comma
(paren
id|data-&gt;zone
(braket
l_int|2
)braket
dot
id|hyst
op_lshift
l_int|4
)paren
)paren
suffix:semicolon
)brace
id|up
c_func
(paren
op_amp
id|data-&gt;update_lock
)paren
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
DECL|function|show_temp_auto_temp_min
r_static
id|ssize_t
id|show_temp_auto_temp_min
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
comma
r_int
id|nr
)paren
(brace
r_struct
id|lm85_data
op_star
id|data
op_assign
id|lm85_update_device
c_func
(paren
id|dev
)paren
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%d&bslash;n&quot;
comma
id|TEMP_FROM_REG
c_func
(paren
id|data-&gt;zone
(braket
id|nr
)braket
dot
id|limit
)paren
)paren
suffix:semicolon
)brace
DECL|function|set_temp_auto_temp_min
r_static
id|ssize_t
id|set_temp_auto_temp_min
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
comma
r_int
id|nr
)paren
(brace
r_struct
id|i2c_client
op_star
id|client
op_assign
id|to_i2c_client
c_func
(paren
id|dev
)paren
suffix:semicolon
r_struct
id|lm85_data
op_star
id|data
op_assign
id|i2c_get_clientdata
c_func
(paren
id|client
)paren
suffix:semicolon
r_int
id|val
suffix:semicolon
id|down
c_func
(paren
op_amp
id|data-&gt;update_lock
)paren
suffix:semicolon
id|val
op_assign
id|simple_strtol
c_func
(paren
id|buf
comma
l_int|NULL
comma
l_int|10
)paren
suffix:semicolon
id|data-&gt;zone
(braket
id|nr
)braket
dot
id|limit
op_assign
id|TEMP_TO_REG
c_func
(paren
id|val
)paren
suffix:semicolon
id|lm85_write_value
c_func
(paren
id|client
comma
id|LM85_REG_AFAN_LIMIT
c_func
(paren
id|nr
)paren
comma
id|data-&gt;zone
(braket
id|nr
)braket
dot
id|limit
)paren
suffix:semicolon
multiline_comment|/* Update temp_auto_max and temp_auto_range */
id|data-&gt;zone
(braket
id|nr
)braket
dot
id|range
op_assign
id|RANGE_TO_REG
c_func
(paren
id|TEMP_FROM_REG
c_func
(paren
id|data-&gt;zone
(braket
id|nr
)braket
dot
id|max_desired
)paren
op_minus
id|TEMP_FROM_REG
c_func
(paren
id|data-&gt;zone
(braket
id|nr
)braket
dot
id|limit
)paren
)paren
suffix:semicolon
id|lm85_write_value
c_func
(paren
id|client
comma
id|LM85_REG_AFAN_RANGE
c_func
(paren
id|nr
)paren
comma
(paren
(paren
id|data-&gt;zone
(braket
id|nr
)braket
dot
id|range
op_amp
l_int|0x0f
)paren
op_lshift
l_int|4
)paren
op_or
(paren
id|data-&gt;autofan
(braket
id|nr
)braket
dot
id|freq
op_amp
l_int|0x07
)paren
)paren
suffix:semicolon
multiline_comment|/* Update temp_auto_hyst and temp_auto_off */
id|data-&gt;zone
(braket
id|nr
)braket
dot
id|hyst
op_assign
id|HYST_TO_REG
c_func
(paren
id|TEMP_FROM_REG
c_func
(paren
id|data-&gt;zone
(braket
id|nr
)braket
dot
id|limit
)paren
op_minus
id|TEMP_FROM_REG
c_func
(paren
id|data-&gt;zone
(braket
id|nr
)braket
dot
id|off_desired
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|nr
op_eq
l_int|0
op_logical_or
id|nr
op_eq
l_int|1
)paren
(brace
id|lm85_write_value
c_func
(paren
id|client
comma
id|LM85_REG_AFAN_HYST1
comma
(paren
id|data-&gt;zone
(braket
l_int|0
)braket
dot
id|hyst
op_lshift
l_int|4
)paren
op_or
id|data-&gt;zone
(braket
l_int|1
)braket
dot
id|hyst
)paren
suffix:semicolon
)brace
r_else
(brace
id|lm85_write_value
c_func
(paren
id|client
comma
id|LM85_REG_AFAN_HYST2
comma
(paren
id|data-&gt;zone
(braket
l_int|2
)braket
dot
id|hyst
op_lshift
l_int|4
)paren
)paren
suffix:semicolon
)brace
id|up
c_func
(paren
op_amp
id|data-&gt;update_lock
)paren
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
DECL|function|show_temp_auto_temp_max
r_static
id|ssize_t
id|show_temp_auto_temp_max
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
comma
r_int
id|nr
)paren
(brace
r_struct
id|lm85_data
op_star
id|data
op_assign
id|lm85_update_device
c_func
(paren
id|dev
)paren
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%d&bslash;n&quot;
comma
id|TEMP_FROM_REG
c_func
(paren
id|data-&gt;zone
(braket
id|nr
)braket
dot
id|limit
)paren
op_plus
id|RANGE_FROM_REG
c_func
(paren
id|data-&gt;zone
(braket
id|nr
)braket
dot
id|range
)paren
)paren
suffix:semicolon
)brace
DECL|function|set_temp_auto_temp_max
r_static
id|ssize_t
id|set_temp_auto_temp_max
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
comma
r_int
id|nr
)paren
(brace
r_struct
id|i2c_client
op_star
id|client
op_assign
id|to_i2c_client
c_func
(paren
id|dev
)paren
suffix:semicolon
r_struct
id|lm85_data
op_star
id|data
op_assign
id|i2c_get_clientdata
c_func
(paren
id|client
)paren
suffix:semicolon
r_int
id|min
comma
id|val
suffix:semicolon
id|down
c_func
(paren
op_amp
id|data-&gt;update_lock
)paren
suffix:semicolon
id|min
op_assign
id|TEMP_FROM_REG
c_func
(paren
id|data-&gt;zone
(braket
id|nr
)braket
dot
id|limit
)paren
suffix:semicolon
id|val
op_assign
id|simple_strtol
c_func
(paren
id|buf
comma
l_int|NULL
comma
l_int|10
)paren
suffix:semicolon
id|data-&gt;zone
(braket
id|nr
)braket
dot
id|max_desired
op_assign
id|TEMP_TO_REG
c_func
(paren
id|val
)paren
suffix:semicolon
id|data-&gt;zone
(braket
id|nr
)braket
dot
id|range
op_assign
id|RANGE_TO_REG
c_func
(paren
id|val
op_minus
id|min
)paren
suffix:semicolon
id|lm85_write_value
c_func
(paren
id|client
comma
id|LM85_REG_AFAN_RANGE
c_func
(paren
id|nr
)paren
comma
(paren
(paren
id|data-&gt;zone
(braket
id|nr
)braket
dot
id|range
op_amp
l_int|0x0f
)paren
op_lshift
l_int|4
)paren
op_or
(paren
id|data-&gt;autofan
(braket
id|nr
)braket
dot
id|freq
op_amp
l_int|0x07
)paren
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|data-&gt;update_lock
)paren
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
DECL|function|show_temp_auto_temp_crit
r_static
id|ssize_t
id|show_temp_auto_temp_crit
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_char
op_star
id|buf
comma
r_int
id|nr
)paren
(brace
r_struct
id|lm85_data
op_star
id|data
op_assign
id|lm85_update_device
c_func
(paren
id|dev
)paren
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%d&bslash;n&quot;
comma
id|TEMP_FROM_REG
c_func
(paren
id|data-&gt;zone
(braket
id|nr
)braket
dot
id|critical
)paren
)paren
suffix:semicolon
)brace
DECL|function|set_temp_auto_temp_crit
r_static
id|ssize_t
id|set_temp_auto_temp_crit
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_const
r_char
op_star
id|buf
comma
r_int
id|count
comma
r_int
id|nr
)paren
(brace
r_struct
id|i2c_client
op_star
id|client
op_assign
id|to_i2c_client
c_func
(paren
id|dev
)paren
suffix:semicolon
r_struct
id|lm85_data
op_star
id|data
op_assign
id|i2c_get_clientdata
c_func
(paren
id|client
)paren
suffix:semicolon
r_int
id|val
suffix:semicolon
id|down
c_func
(paren
op_amp
id|data-&gt;update_lock
)paren
suffix:semicolon
id|val
op_assign
id|simple_strtol
c_func
(paren
id|buf
comma
l_int|NULL
comma
l_int|10
)paren
suffix:semicolon
id|data-&gt;zone
(braket
id|nr
)braket
dot
id|critical
op_assign
id|TEMP_TO_REG
c_func
(paren
id|val
)paren
suffix:semicolon
id|lm85_write_value
c_func
(paren
id|client
comma
id|LM85_REG_AFAN_CRITICAL
c_func
(paren
id|nr
)paren
comma
id|data-&gt;zone
(braket
id|nr
)braket
dot
id|critical
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|data-&gt;update_lock
)paren
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
DECL|macro|temp_auto
mdefine_line|#define temp_auto(offset)&t;&t;&t;&t;&t;&t;&bslash;&n;static ssize_t show_temp##offset##_auto_temp_off (struct device *dev,&t;&bslash;&n;&t;char *buf)&t;&t;&t;&t;&t;&t;&t;&bslash;&n;{&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;&t;return show_temp_auto_temp_off(dev, buf, offset - 1);&t;&t;&bslash;&n;}&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;static ssize_t set_temp##offset##_auto_temp_off (struct device *dev,&t;&bslash;&n;&t;const char *buf, size_t count)&t;&t;&t;&t;&t;&bslash;&n;{&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;&t;return set_temp_auto_temp_off(dev, buf, count, offset - 1);&t;&bslash;&n;}&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;static ssize_t show_temp##offset##_auto_temp_min (struct device *dev,&t;&bslash;&n;&t;char *buf)&t;&t;&t;&t;&t;&t;&t;&bslash;&n;{&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;&t;return show_temp_auto_temp_min(dev, buf, offset - 1);&t;&t;&bslash;&n;}&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;static ssize_t set_temp##offset##_auto_temp_min (struct device *dev,&t;&bslash;&n;&t;const char *buf, size_t count)&t;&t;&t;&t;&t;&bslash;&n;{&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;&t;return set_temp_auto_temp_min(dev, buf, count, offset - 1);&t;&bslash;&n;}&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;static ssize_t show_temp##offset##_auto_temp_max (struct device *dev,&t;&bslash;&n;&t;char *buf)&t;&t;&t;&t;&t;&t;&t;&bslash;&n;{&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;&t;return show_temp_auto_temp_max(dev, buf, offset - 1);&t;&t;&bslash;&n;}&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;static ssize_t set_temp##offset##_auto_temp_max (struct device *dev,&t;&bslash;&n;&t;const char *buf, size_t count)&t;&t;&t;&t;&t;&bslash;&n;{&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;&t;return set_temp_auto_temp_max(dev, buf, count, offset - 1);&t;&bslash;&n;}&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;static ssize_t show_temp##offset##_auto_temp_crit (struct device *dev,&t;&bslash;&n;&t;char *buf)&t;&t;&t;&t;&t;&t;&t;&bslash;&n;{&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;&t;return show_temp_auto_temp_crit(dev, buf, offset - 1);&t;&t;&bslash;&n;}&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;static ssize_t set_temp##offset##_auto_temp_crit (struct device *dev,&t;&bslash;&n;&t;const char *buf, size_t count)&t;&t;&t;&t;&t;&bslash;&n;{&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;&t;return set_temp_auto_temp_crit(dev, buf, count, offset - 1);&t;&bslash;&n;}&t;&t;&t;&t;&t;&t;&t;&t;&t;&bslash;&n;static DEVICE_ATTR(temp##offset##_auto_temp_off, S_IRUGO | S_IWUSR,&t;&bslash;&n;&t;&t;show_temp##offset##_auto_temp_off,&t;&t;&t;&bslash;&n;&t;&t;set_temp##offset##_auto_temp_off);&t;&t;&t;&bslash;&n;static DEVICE_ATTR(temp##offset##_auto_temp_min, S_IRUGO | S_IWUSR,&t;&bslash;&n;&t;&t;show_temp##offset##_auto_temp_min,&t;&t;&t;&bslash;&n;&t;&t;set_temp##offset##_auto_temp_min);&t;&t;&t;&bslash;&n;static DEVICE_ATTR(temp##offset##_auto_temp_max, S_IRUGO | S_IWUSR,&t;&bslash;&n;&t;&t;show_temp##offset##_auto_temp_max,&t;&t;&t;&bslash;&n;&t;&t;set_temp##offset##_auto_temp_max);&t;&t;&t;&bslash;&n;static DEVICE_ATTR(temp##offset##_auto_temp_crit, S_IRUGO | S_IWUSR,&t;&bslash;&n;&t;&t;show_temp##offset##_auto_temp_crit,&t;&t;&t;&bslash;&n;&t;&t;set_temp##offset##_auto_temp_crit);
id|temp_auto
c_func
(paren
l_int|1
)paren
suffix:semicolon
id|temp_auto
c_func
(paren
l_int|2
)paren
suffix:semicolon
id|temp_auto
c_func
(paren
l_int|3
)paren
suffix:semicolon
DECL|function|lm85_attach_adapter
r_int
id|lm85_attach_adapter
c_func
(paren
r_struct
id|i2c_adapter
op_star
id|adapter
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|adapter
op_member_access_from_pointer
r_class
op_amp
id|I2C_CLASS_HWMON
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_return
id|i2c_detect
c_func
(paren
id|adapter
comma
op_amp
id|addr_data
comma
id|lm85_detect
)paren
suffix:semicolon
)brace
DECL|function|lm85_detect
r_int
id|lm85_detect
c_func
(paren
r_struct
id|i2c_adapter
op_star
id|adapter
comma
r_int
id|address
comma
r_int
id|kind
)paren
(brace
r_int
id|company
comma
id|verstep
suffix:semicolon
r_struct
id|i2c_client
op_star
id|new_client
op_assign
l_int|NULL
suffix:semicolon
r_struct
id|lm85_data
op_star
id|data
suffix:semicolon
r_int
id|err
op_assign
l_int|0
suffix:semicolon
r_const
r_char
op_star
id|type_name
op_assign
l_string|&quot;&quot;
suffix:semicolon
r_if
c_cond
(paren
id|i2c_is_isa_adapter
c_func
(paren
id|adapter
)paren
)paren
(brace
multiline_comment|/* This chip has no ISA interface */
r_goto
id|ERROR0
suffix:semicolon
)brace
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|i2c_check_functionality
c_func
(paren
id|adapter
comma
id|I2C_FUNC_SMBUS_BYTE_DATA
)paren
)paren
(brace
multiline_comment|/* We need to be able to do byte I/O */
r_goto
id|ERROR0
suffix:semicolon
)brace
suffix:semicolon
multiline_comment|/* OK. For now, we presume we have a valid client. We now create the&n;&t;   client structure, even though we cannot fill it completely yet.&n;&t;   But it allows us to access lm85_{read,write}_value. */
r_if
c_cond
(paren
op_logical_neg
(paren
id|data
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|lm85_data
)paren
comma
id|GFP_KERNEL
)paren
)paren
)paren
(brace
id|err
op_assign
op_minus
id|ENOMEM
suffix:semicolon
r_goto
id|ERROR0
suffix:semicolon
)brace
id|memset
c_func
(paren
id|data
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|lm85_data
)paren
)paren
suffix:semicolon
id|new_client
op_assign
op_amp
id|data-&gt;client
suffix:semicolon
id|i2c_set_clientdata
c_func
(paren
id|new_client
comma
id|data
)paren
suffix:semicolon
id|new_client-&gt;addr
op_assign
id|address
suffix:semicolon
id|new_client-&gt;adapter
op_assign
id|adapter
suffix:semicolon
id|new_client-&gt;driver
op_assign
op_amp
id|lm85_driver
suffix:semicolon
id|new_client-&gt;flags
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* Now, we do the remaining detection. */
id|company
op_assign
id|lm85_read_value
c_func
(paren
id|new_client
comma
id|LM85_REG_COMPANY
)paren
suffix:semicolon
id|verstep
op_assign
id|lm85_read_value
c_func
(paren
id|new_client
comma
id|LM85_REG_VERSTEP
)paren
suffix:semicolon
id|dev_dbg
c_func
(paren
op_amp
id|adapter-&gt;dev
comma
l_string|&quot;Detecting device at %d,0x%02x with&quot;
l_string|&quot; COMPANY: 0x%02x and VERSTEP: 0x%02x&bslash;n&quot;
comma
id|i2c_adapter_id
c_func
(paren
id|new_client-&gt;adapter
)paren
comma
id|new_client-&gt;addr
comma
id|company
comma
id|verstep
)paren
suffix:semicolon
multiline_comment|/* If auto-detecting, Determine the chip type. */
r_if
c_cond
(paren
id|kind
op_le
l_int|0
)paren
(brace
id|dev_dbg
c_func
(paren
op_amp
id|adapter-&gt;dev
comma
l_string|&quot;Autodetecting device at %d,0x%02x ...&bslash;n&quot;
comma
id|i2c_adapter_id
c_func
(paren
id|adapter
)paren
comma
id|address
)paren
suffix:semicolon
r_if
c_cond
(paren
id|company
op_eq
id|LM85_COMPANY_NATIONAL
op_logical_and
id|verstep
op_eq
id|LM85_VERSTEP_LM85C
)paren
(brace
id|kind
op_assign
id|lm85c
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|company
op_eq
id|LM85_COMPANY_NATIONAL
op_logical_and
id|verstep
op_eq
id|LM85_VERSTEP_LM85B
)paren
(brace
id|kind
op_assign
id|lm85b
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|company
op_eq
id|LM85_COMPANY_NATIONAL
op_logical_and
(paren
id|verstep
op_amp
id|LM85_VERSTEP_VMASK
)paren
op_eq
id|LM85_VERSTEP_GENERIC
)paren
(brace
id|dev_err
c_func
(paren
op_amp
id|adapter-&gt;dev
comma
l_string|&quot;Unrecognized version/stepping 0x%02x&quot;
l_string|&quot; Defaulting to LM85.&bslash;n&quot;
comma
id|verstep
)paren
suffix:semicolon
id|kind
op_assign
id|any_chip
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|company
op_eq
id|LM85_COMPANY_ANALOG_DEV
op_logical_and
id|verstep
op_eq
id|LM85_VERSTEP_ADM1027
)paren
(brace
id|kind
op_assign
id|adm1027
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|company
op_eq
id|LM85_COMPANY_ANALOG_DEV
op_logical_and
id|verstep
op_eq
id|LM85_VERSTEP_ADT7463
)paren
(brace
id|kind
op_assign
id|adt7463
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|company
op_eq
id|LM85_COMPANY_ANALOG_DEV
op_logical_and
(paren
id|verstep
op_amp
id|LM85_VERSTEP_VMASK
)paren
op_eq
id|LM85_VERSTEP_GENERIC
)paren
(brace
id|dev_err
c_func
(paren
op_amp
id|adapter-&gt;dev
comma
l_string|&quot;Unrecognized version/stepping 0x%02x&quot;
l_string|&quot; Defaulting to Generic LM85.&bslash;n&quot;
comma
id|verstep
)paren
suffix:semicolon
id|kind
op_assign
id|any_chip
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|company
op_eq
id|LM85_COMPANY_SMSC
op_logical_and
(paren
id|verstep
op_eq
id|LM85_VERSTEP_EMC6D100_A0
op_logical_or
id|verstep
op_eq
id|LM85_VERSTEP_EMC6D100_A1
)paren
)paren
(brace
multiline_comment|/* Unfortunately, we can&squot;t tell a &squot;100 from a &squot;101&n;&t;&t;&t; * from the registers.  Since a &squot;101 is a &squot;100&n;&t;&t;&t; * in a package with fewer pins and therefore no&n;&t;&t;&t; * 3.3V, 1.5V or 1.8V inputs, perhaps if those&n;&t;&t;&t; * inputs read 0, then it&squot;s a &squot;101.&n;&t;&t;&t; */
id|kind
op_assign
id|emc6d100
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|company
op_eq
id|LM85_COMPANY_SMSC
op_logical_and
(paren
id|verstep
op_amp
id|LM85_VERSTEP_VMASK
)paren
op_eq
id|LM85_VERSTEP_GENERIC
)paren
(brace
id|dev_err
c_func
(paren
op_amp
id|adapter-&gt;dev
comma
l_string|&quot;lm85: Detected SMSC chip&bslash;n&quot;
)paren
suffix:semicolon
id|dev_err
c_func
(paren
op_amp
id|adapter-&gt;dev
comma
l_string|&quot;lm85: Unrecognized version/stepping 0x%02x&quot;
l_string|&quot; Defaulting to Generic LM85.&bslash;n&quot;
comma
id|verstep
)paren
suffix:semicolon
id|kind
op_assign
id|any_chip
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|kind
op_eq
id|any_chip
op_logical_and
(paren
id|verstep
op_amp
id|LM85_VERSTEP_VMASK
)paren
op_eq
id|LM85_VERSTEP_GENERIC
)paren
(brace
id|dev_err
c_func
(paren
op_amp
id|adapter-&gt;dev
comma
l_string|&quot;Generic LM85 Version 6 detected&bslash;n&quot;
)paren
suffix:semicolon
multiline_comment|/* Leave kind as &quot;any_chip&quot; */
)brace
r_else
(brace
id|dev_dbg
c_func
(paren
op_amp
id|adapter-&gt;dev
comma
l_string|&quot;Autodetection failed&bslash;n&quot;
)paren
suffix:semicolon
multiline_comment|/* Not an LM85 ... */
r_if
c_cond
(paren
id|kind
op_eq
id|any_chip
)paren
(brace
multiline_comment|/* User used force=x,y */
id|dev_err
c_func
(paren
op_amp
id|adapter-&gt;dev
comma
l_string|&quot;Generic LM85 Version 6 not&quot;
l_string|&quot; found at %d,0x%02x. Try force_lm85c.&bslash;n&quot;
comma
id|i2c_adapter_id
c_func
(paren
id|adapter
)paren
comma
id|address
)paren
suffix:semicolon
)brace
id|err
op_assign
l_int|0
suffix:semicolon
r_goto
id|ERROR1
suffix:semicolon
)brace
)brace
multiline_comment|/* Fill in the chip specific driver values */
r_if
c_cond
(paren
id|kind
op_eq
id|any_chip
)paren
(brace
id|type_name
op_assign
l_string|&quot;lm85&quot;
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|kind
op_eq
id|lm85b
)paren
(brace
id|type_name
op_assign
l_string|&quot;lm85b&quot;
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|kind
op_eq
id|lm85c
)paren
(brace
id|type_name
op_assign
l_string|&quot;lm85c&quot;
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|kind
op_eq
id|adm1027
)paren
(brace
id|type_name
op_assign
l_string|&quot;adm1027&quot;
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|kind
op_eq
id|adt7463
)paren
(brace
id|type_name
op_assign
l_string|&quot;adt7463&quot;
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|kind
op_eq
id|emc6d100
)paren
(brace
id|type_name
op_assign
l_string|&quot;emc6d100&quot;
suffix:semicolon
)brace
id|strlcpy
c_func
(paren
id|new_client-&gt;name
comma
id|type_name
comma
id|I2C_NAME_SIZE
)paren
suffix:semicolon
multiline_comment|/* Fill in the remaining client fields */
id|new_client-&gt;id
op_assign
id|lm85_id
op_increment
suffix:semicolon
id|data-&gt;type
op_assign
id|kind
suffix:semicolon
id|data-&gt;valid
op_assign
l_int|0
suffix:semicolon
id|init_MUTEX
c_func
(paren
op_amp
id|data-&gt;update_lock
)paren
suffix:semicolon
id|dev_dbg
c_func
(paren
op_amp
id|adapter-&gt;dev
comma
l_string|&quot;Assigning ID %d to %s at %d,0x%02x&bslash;n&quot;
comma
id|new_client-&gt;id
comma
id|new_client-&gt;name
comma
id|i2c_adapter_id
c_func
(paren
id|new_client-&gt;adapter
)paren
comma
id|new_client-&gt;addr
)paren
suffix:semicolon
multiline_comment|/* Tell the I2C layer a new client has arrived */
r_if
c_cond
(paren
(paren
id|err
op_assign
id|i2c_attach_client
c_func
(paren
id|new_client
)paren
)paren
)paren
r_goto
id|ERROR1
suffix:semicolon
multiline_comment|/* Set the VRM version */
id|data-&gt;vrm
op_assign
id|i2c_which_vrm
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/* Initialize the LM85 chip */
id|lm85_init_client
c_func
(paren
id|new_client
)paren
suffix:semicolon
multiline_comment|/* Register sysfs hooks */
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_fan1_input
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_fan2_input
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_fan3_input
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_fan4_input
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_fan1_min
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_fan2_min
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_fan3_min
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_fan4_min
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_pwm1
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_pwm2
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_pwm3
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_pwm1_enable
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_pwm2_enable
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_pwm3_enable
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_in0_input
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_in1_input
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_in2_input
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_in3_input
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_in4_input
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_in0_min
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_in1_min
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_in2_min
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_in3_min
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_in4_min
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_in0_max
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_in1_max
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_in2_max
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_in3_max
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_in4_max
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_temp1_input
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_temp2_input
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_temp3_input
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_temp1_min
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_temp2_min
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_temp3_min
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_temp1_max
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_temp2_max
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_temp3_max
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_vrm
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_cpu0_vid
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_alarms
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_pwm1_auto_channels
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_pwm2_auto_channels
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_pwm3_auto_channels
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_pwm1_auto_pwm_min
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_pwm2_auto_pwm_min
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_pwm3_auto_pwm_min
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_pwm1_auto_pwm_minctl
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_pwm2_auto_pwm_minctl
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_pwm3_auto_pwm_minctl
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_pwm1_auto_pwm_freq
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_pwm2_auto_pwm_freq
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_pwm3_auto_pwm_freq
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_temp1_auto_temp_off
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_temp2_auto_temp_off
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_temp3_auto_temp_off
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_temp1_auto_temp_min
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_temp2_auto_temp_min
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_temp3_auto_temp_min
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_temp1_auto_temp_max
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_temp2_auto_temp_max
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_temp3_auto_temp_max
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_temp1_auto_temp_crit
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_temp2_auto_temp_crit
)paren
suffix:semicolon
id|device_create_file
c_func
(paren
op_amp
id|new_client-&gt;dev
comma
op_amp
id|dev_attr_temp3_auto_temp_crit
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
multiline_comment|/* Error out and cleanup code */
id|ERROR1
suffix:colon
id|kfree
c_func
(paren
id|data
)paren
suffix:semicolon
id|ERROR0
suffix:colon
r_return
id|err
suffix:semicolon
)brace
DECL|function|lm85_detach_client
r_int
id|lm85_detach_client
c_func
(paren
r_struct
id|i2c_client
op_star
id|client
)paren
(brace
id|i2c_detach_client
c_func
(paren
id|client
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|i2c_get_clientdata
c_func
(paren
id|client
)paren
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|lm85_read_value
r_int
id|lm85_read_value
c_func
(paren
r_struct
id|i2c_client
op_star
id|client
comma
id|u8
id|reg
)paren
(brace
r_int
id|res
suffix:semicolon
multiline_comment|/* What size location is it? */
r_switch
c_cond
(paren
id|reg
)paren
(brace
r_case
id|LM85_REG_FAN
c_func
(paren
l_int|0
)paren
suffix:colon
multiline_comment|/* Read WORD data */
r_case
id|LM85_REG_FAN
c_func
(paren
l_int|1
)paren
suffix:colon
r_case
id|LM85_REG_FAN
c_func
(paren
l_int|2
)paren
suffix:colon
r_case
id|LM85_REG_FAN
c_func
(paren
l_int|3
)paren
suffix:colon
r_case
id|LM85_REG_FAN_MIN
c_func
(paren
l_int|0
)paren
suffix:colon
r_case
id|LM85_REG_FAN_MIN
c_func
(paren
l_int|1
)paren
suffix:colon
r_case
id|LM85_REG_FAN_MIN
c_func
(paren
l_int|2
)paren
suffix:colon
r_case
id|LM85_REG_FAN_MIN
c_func
(paren
l_int|3
)paren
suffix:colon
r_case
id|LM85_REG_ALARM1
suffix:colon
multiline_comment|/* Read both bytes at once */
r_case
id|ADM1027_REG_EXTEND_ADC1
suffix:colon
multiline_comment|/* Read two bytes at once */
id|res
op_assign
id|i2c_smbus_read_byte_data
c_func
(paren
id|client
comma
id|reg
)paren
op_amp
l_int|0xff
suffix:semicolon
id|res
op_or_assign
id|i2c_smbus_read_byte_data
c_func
(paren
id|client
comma
id|reg
op_plus
l_int|1
)paren
op_lshift
l_int|8
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ADT7463_REG_TMIN_CTL1
suffix:colon
multiline_comment|/* Read WORD MSB, LSB */
id|res
op_assign
id|i2c_smbus_read_byte_data
c_func
(paren
id|client
comma
id|reg
)paren
op_lshift
l_int|8
suffix:semicolon
id|res
op_or_assign
id|i2c_smbus_read_byte_data
c_func
(paren
id|client
comma
id|reg
op_plus
l_int|1
)paren
op_amp
l_int|0xff
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
multiline_comment|/* Read BYTE data */
id|res
op_assign
id|i2c_smbus_read_byte_data
c_func
(paren
id|client
comma
id|reg
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_return
id|res
suffix:semicolon
)brace
DECL|function|lm85_write_value
r_int
id|lm85_write_value
c_func
(paren
r_struct
id|i2c_client
op_star
id|client
comma
id|u8
id|reg
comma
r_int
id|value
)paren
(brace
r_int
id|res
suffix:semicolon
r_switch
c_cond
(paren
id|reg
)paren
(brace
r_case
id|LM85_REG_FAN
c_func
(paren
l_int|0
)paren
suffix:colon
multiline_comment|/* Write WORD data */
r_case
id|LM85_REG_FAN
c_func
(paren
l_int|1
)paren
suffix:colon
r_case
id|LM85_REG_FAN
c_func
(paren
l_int|2
)paren
suffix:colon
r_case
id|LM85_REG_FAN
c_func
(paren
l_int|3
)paren
suffix:colon
r_case
id|LM85_REG_FAN_MIN
c_func
(paren
l_int|0
)paren
suffix:colon
r_case
id|LM85_REG_FAN_MIN
c_func
(paren
l_int|1
)paren
suffix:colon
r_case
id|LM85_REG_FAN_MIN
c_func
(paren
l_int|2
)paren
suffix:colon
r_case
id|LM85_REG_FAN_MIN
c_func
(paren
l_int|3
)paren
suffix:colon
multiline_comment|/* NOTE: ALARM is read only, so not included here */
id|res
op_assign
id|i2c_smbus_write_byte_data
c_func
(paren
id|client
comma
id|reg
comma
id|value
op_amp
l_int|0xff
)paren
suffix:semicolon
id|res
op_or_assign
id|i2c_smbus_write_byte_data
c_func
(paren
id|client
comma
id|reg
op_plus
l_int|1
comma
(paren
id|value
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ADT7463_REG_TMIN_CTL1
suffix:colon
multiline_comment|/* Write WORD MSB, LSB */
id|res
op_assign
id|i2c_smbus_write_byte_data
c_func
(paren
id|client
comma
id|reg
comma
(paren
id|value
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
)paren
suffix:semicolon
id|res
op_or_assign
id|i2c_smbus_write_byte_data
c_func
(paren
id|client
comma
id|reg
op_plus
l_int|1
comma
id|value
op_amp
l_int|0xff
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
multiline_comment|/* Write BYTE data */
id|res
op_assign
id|i2c_smbus_write_byte_data
c_func
(paren
id|client
comma
id|reg
comma
id|value
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_return
id|res
suffix:semicolon
)brace
DECL|function|lm85_init_client
r_void
id|lm85_init_client
c_func
(paren
r_struct
id|i2c_client
op_star
id|client
)paren
(brace
r_int
id|value
suffix:semicolon
r_struct
id|lm85_data
op_star
id|data
op_assign
id|i2c_get_clientdata
c_func
(paren
id|client
)paren
suffix:semicolon
id|dev_dbg
c_func
(paren
op_amp
id|client-&gt;dev
comma
l_string|&quot;Initializing device&bslash;n&quot;
)paren
suffix:semicolon
multiline_comment|/* Warn if part was not &quot;READY&quot; */
id|value
op_assign
id|lm85_read_value
c_func
(paren
id|client
comma
id|LM85_REG_CONFIG
)paren
suffix:semicolon
id|dev_dbg
c_func
(paren
op_amp
id|client-&gt;dev
comma
l_string|&quot;LM85_REG_CONFIG is: 0x%02x&bslash;n&quot;
comma
id|value
)paren
suffix:semicolon
r_if
c_cond
(paren
id|value
op_amp
l_int|0x02
)paren
(brace
id|dev_err
c_func
(paren
op_amp
id|client-&gt;dev
comma
l_string|&quot;Client (%d,0x%02x) config is locked.&bslash;n&quot;
comma
id|i2c_adapter_id
c_func
(paren
id|client-&gt;adapter
)paren
comma
id|client-&gt;addr
)paren
suffix:semicolon
)brace
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|value
op_amp
l_int|0x04
)paren
)paren
(brace
id|dev_err
c_func
(paren
op_amp
id|client-&gt;dev
comma
l_string|&quot;Client (%d,0x%02x) is not ready.&bslash;n&quot;
comma
id|i2c_adapter_id
c_func
(paren
id|client-&gt;adapter
)paren
comma
id|client-&gt;addr
)paren
suffix:semicolon
)brace
suffix:semicolon
r_if
c_cond
(paren
id|value
op_amp
l_int|0x10
op_logical_and
(paren
id|data-&gt;type
op_eq
id|adm1027
op_logical_or
id|data-&gt;type
op_eq
id|adt7463
)paren
)paren
(brace
id|dev_err
c_func
(paren
op_amp
id|client-&gt;dev
comma
l_string|&quot;Client (%d,0x%02x) VxI mode is set.  &quot;
l_string|&quot;Please report this to the lm85 maintainer.&bslash;n&quot;
comma
id|i2c_adapter_id
c_func
(paren
id|client-&gt;adapter
)paren
comma
id|client-&gt;addr
)paren
suffix:semicolon
)brace
suffix:semicolon
multiline_comment|/* WE INTENTIONALLY make no changes to the limits,&n;&t; *   offsets, pwms, fans and zones.  If they were&n;&t; *   configured, we don&squot;t want to mess with them.&n;&t; *   If they weren&squot;t, the default is 100% PWM, no&n;&t; *   control and will suffice until &squot;sensors -s&squot;&n;&t; *   can be run by the user.&n;&t; */
multiline_comment|/* Start monitoring */
id|value
op_assign
id|lm85_read_value
c_func
(paren
id|client
comma
id|LM85_REG_CONFIG
)paren
suffix:semicolon
multiline_comment|/* Try to clear LOCK, Set START, save everything else */
id|value
op_assign
(paren
id|value
op_amp
op_complement
l_int|0x02
)paren
op_or
l_int|0x01
suffix:semicolon
id|dev_dbg
c_func
(paren
op_amp
id|client-&gt;dev
comma
l_string|&quot;Setting CONFIG to: 0x%02x&bslash;n&quot;
comma
id|value
)paren
suffix:semicolon
id|lm85_write_value
c_func
(paren
id|client
comma
id|LM85_REG_CONFIG
comma
id|value
)paren
suffix:semicolon
)brace
DECL|function|lm85_update_device
r_static
r_struct
id|lm85_data
op_star
id|lm85_update_device
c_func
(paren
r_struct
id|device
op_star
id|dev
)paren
(brace
r_struct
id|i2c_client
op_star
id|client
op_assign
id|to_i2c_client
c_func
(paren
id|dev
)paren
suffix:semicolon
r_struct
id|lm85_data
op_star
id|data
op_assign
id|i2c_get_clientdata
c_func
(paren
id|client
)paren
suffix:semicolon
r_int
id|i
suffix:semicolon
id|down
c_func
(paren
op_amp
id|data-&gt;update_lock
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|data-&gt;valid
op_logical_or
(paren
id|jiffies
op_minus
id|data-&gt;last_reading
OG
id|LM85_DATA_INTERVAL
)paren
)paren
(brace
multiline_comment|/* Things that change quickly */
id|dev_dbg
c_func
(paren
op_amp
id|client-&gt;dev
comma
l_string|&quot;Reading sensor values&bslash;n&quot;
)paren
suffix:semicolon
multiline_comment|/* Have to read extended bits first to &quot;freeze&quot; the&n;&t;&t; * more significant bits that are read later.&n;&t;&t; */
r_if
c_cond
(paren
(paren
id|data-&gt;type
op_eq
id|adm1027
)paren
op_logical_or
(paren
id|data-&gt;type
op_eq
id|adt7463
)paren
)paren
(brace
id|data-&gt;extend_adc
op_assign
id|lm85_read_value
c_func
(paren
id|client
comma
id|ADM1027_REG_EXTEND_ADC1
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
l_int|4
suffix:semicolon
op_increment
id|i
)paren
(brace
id|data-&gt;in
(braket
id|i
)braket
op_assign
id|lm85_read_value
c_func
(paren
id|client
comma
id|LM85_REG_IN
c_func
(paren
id|i
)paren
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
l_int|3
suffix:semicolon
op_increment
id|i
)paren
(brace
id|data-&gt;fan
(braket
id|i
)braket
op_assign
id|lm85_read_value
c_func
(paren
id|client
comma
id|LM85_REG_FAN
c_func
(paren
id|i
)paren
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
l_int|2
suffix:semicolon
op_increment
id|i
)paren
(brace
id|data-&gt;temp
(braket
id|i
)braket
op_assign
id|lm85_read_value
c_func
(paren
id|client
comma
id|LM85_REG_TEMP
c_func
(paren
id|i
)paren
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
l_int|2
suffix:semicolon
op_increment
id|i
)paren
(brace
id|data-&gt;pwm
(braket
id|i
)braket
op_assign
id|lm85_read_value
c_func
(paren
id|client
comma
id|LM85_REG_PWM
c_func
(paren
id|i
)paren
)paren
suffix:semicolon
)brace
id|data-&gt;alarms
op_assign
id|lm85_read_value
c_func
(paren
id|client
comma
id|LM85_REG_ALARM1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|data-&gt;type
op_eq
id|adt7463
)paren
(brace
r_if
c_cond
(paren
id|data-&gt;therm_total
OL
id|ULONG_MAX
op_minus
l_int|256
)paren
(brace
id|data-&gt;therm_total
op_add_assign
id|lm85_read_value
c_func
(paren
id|client
comma
id|ADT7463_REG_THERM
)paren
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|data-&gt;type
op_eq
id|emc6d100
)paren
(brace
multiline_comment|/* Three more voltage sensors */
r_for
c_loop
(paren
id|i
op_assign
l_int|5
suffix:semicolon
id|i
op_le
l_int|7
suffix:semicolon
op_increment
id|i
)paren
(brace
id|data-&gt;in
(braket
id|i
)braket
op_assign
id|lm85_read_value
c_func
(paren
id|client
comma
id|EMC6D100_REG_IN
c_func
(paren
id|i
)paren
)paren
suffix:semicolon
)brace
multiline_comment|/* More alarm bits */
id|data-&gt;alarms
op_or_assign
id|lm85_read_value
c_func
(paren
id|client
comma
id|EMC6D100_REG_ALARM3
)paren
op_lshift
l_int|16
suffix:semicolon
)brace
id|data-&gt;last_reading
op_assign
id|jiffies
suffix:semicolon
)brace
suffix:semicolon
multiline_comment|/* last_reading */
r_if
c_cond
(paren
op_logical_neg
id|data-&gt;valid
op_logical_or
(paren
id|jiffies
op_minus
id|data-&gt;last_config
OG
id|LM85_CONFIG_INTERVAL
)paren
)paren
(brace
multiline_comment|/* Things that don&squot;t change often */
id|dev_dbg
c_func
(paren
op_amp
id|client-&gt;dev
comma
l_string|&quot;Reading config values&bslash;n&quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
l_int|4
suffix:semicolon
op_increment
id|i
)paren
(brace
id|data-&gt;in_min
(braket
id|i
)braket
op_assign
id|lm85_read_value
c_func
(paren
id|client
comma
id|LM85_REG_IN_MIN
c_func
(paren
id|i
)paren
)paren
suffix:semicolon
id|data-&gt;in_max
(braket
id|i
)braket
op_assign
id|lm85_read_value
c_func
(paren
id|client
comma
id|LM85_REG_IN_MAX
c_func
(paren
id|i
)paren
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|data-&gt;type
op_eq
id|emc6d100
)paren
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|5
suffix:semicolon
id|i
op_le
l_int|7
suffix:semicolon
op_increment
id|i
)paren
(brace
id|data-&gt;in_min
(braket
id|i
)braket
op_assign
id|lm85_read_value
c_func
(paren
id|client
comma
id|EMC6D100_REG_IN_MIN
c_func
(paren
id|i
)paren
)paren
suffix:semicolon
id|data-&gt;in_max
(braket
id|i
)braket
op_assign
id|lm85_read_value
c_func
(paren
id|client
comma
id|EMC6D100_REG_IN_MAX
c_func
(paren
id|i
)paren
)paren
suffix:semicolon
)brace
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
l_int|3
suffix:semicolon
op_increment
id|i
)paren
(brace
id|data-&gt;fan_min
(braket
id|i
)braket
op_assign
id|lm85_read_value
c_func
(paren
id|client
comma
id|LM85_REG_FAN_MIN
c_func
(paren
id|i
)paren
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
l_int|2
suffix:semicolon
op_increment
id|i
)paren
(brace
id|data-&gt;temp_min
(braket
id|i
)braket
op_assign
id|lm85_read_value
c_func
(paren
id|client
comma
id|LM85_REG_TEMP_MIN
c_func
(paren
id|i
)paren
)paren
suffix:semicolon
id|data-&gt;temp_max
(braket
id|i
)braket
op_assign
id|lm85_read_value
c_func
(paren
id|client
comma
id|LM85_REG_TEMP_MAX
c_func
(paren
id|i
)paren
)paren
suffix:semicolon
)brace
id|data-&gt;vid
op_assign
id|lm85_read_value
c_func
(paren
id|client
comma
id|LM85_REG_VID
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
l_int|2
suffix:semicolon
op_increment
id|i
)paren
(brace
r_int
id|val
suffix:semicolon
id|data-&gt;autofan
(braket
id|i
)braket
dot
id|config
op_assign
id|lm85_read_value
c_func
(paren
id|client
comma
id|LM85_REG_AFAN_CONFIG
c_func
(paren
id|i
)paren
)paren
suffix:semicolon
id|val
op_assign
id|lm85_read_value
c_func
(paren
id|client
comma
id|LM85_REG_AFAN_RANGE
c_func
(paren
id|i
)paren
)paren
suffix:semicolon
id|data-&gt;autofan
(braket
id|i
)braket
dot
id|freq
op_assign
id|val
op_amp
l_int|0x07
suffix:semicolon
id|data-&gt;zone
(braket
id|i
)braket
dot
id|range
op_assign
(paren
id|val
op_rshift
l_int|4
)paren
op_amp
l_int|0x0f
suffix:semicolon
id|data-&gt;autofan
(braket
id|i
)braket
dot
id|min_pwm
op_assign
id|lm85_read_value
c_func
(paren
id|client
comma
id|LM85_REG_AFAN_MINPWM
c_func
(paren
id|i
)paren
)paren
suffix:semicolon
id|data-&gt;zone
(braket
id|i
)braket
dot
id|limit
op_assign
id|lm85_read_value
c_func
(paren
id|client
comma
id|LM85_REG_AFAN_LIMIT
c_func
(paren
id|i
)paren
)paren
suffix:semicolon
id|data-&gt;zone
(braket
id|i
)braket
dot
id|critical
op_assign
id|lm85_read_value
c_func
(paren
id|client
comma
id|LM85_REG_AFAN_CRITICAL
c_func
(paren
id|i
)paren
)paren
suffix:semicolon
)brace
id|i
op_assign
id|lm85_read_value
c_func
(paren
id|client
comma
id|LM85_REG_AFAN_SPIKE1
)paren
suffix:semicolon
id|data-&gt;smooth
(braket
l_int|0
)braket
op_assign
id|i
op_amp
l_int|0x0f
suffix:semicolon
id|data-&gt;syncpwm3
op_assign
id|i
op_amp
l_int|0x10
suffix:semicolon
multiline_comment|/* Save PWM3 config */
id|data-&gt;autofan
(braket
l_int|0
)braket
dot
id|min_off
op_assign
(paren
id|i
op_amp
l_int|0x20
)paren
op_ne
l_int|0
suffix:semicolon
id|data-&gt;autofan
(braket
l_int|1
)braket
dot
id|min_off
op_assign
(paren
id|i
op_amp
l_int|0x40
)paren
op_ne
l_int|0
suffix:semicolon
id|data-&gt;autofan
(braket
l_int|2
)braket
dot
id|min_off
op_assign
(paren
id|i
op_amp
l_int|0x80
)paren
op_ne
l_int|0
suffix:semicolon
id|i
op_assign
id|lm85_read_value
c_func
(paren
id|client
comma
id|LM85_REG_AFAN_SPIKE2
)paren
suffix:semicolon
id|data-&gt;smooth
(braket
l_int|1
)braket
op_assign
(paren
id|i
op_rshift
l_int|4
)paren
op_amp
l_int|0x0f
suffix:semicolon
id|data-&gt;smooth
(braket
l_int|2
)braket
op_assign
id|i
op_amp
l_int|0x0f
suffix:semicolon
id|i
op_assign
id|lm85_read_value
c_func
(paren
id|client
comma
id|LM85_REG_AFAN_HYST1
)paren
suffix:semicolon
id|data-&gt;zone
(braket
l_int|0
)braket
dot
id|hyst
op_assign
(paren
id|i
op_rshift
l_int|4
)paren
op_amp
l_int|0x0f
suffix:semicolon
id|data-&gt;zone
(braket
l_int|1
)braket
dot
id|hyst
op_assign
id|i
op_amp
l_int|0x0f
suffix:semicolon
id|i
op_assign
id|lm85_read_value
c_func
(paren
id|client
comma
id|LM85_REG_AFAN_HYST2
)paren
suffix:semicolon
id|data-&gt;zone
(braket
l_int|2
)braket
dot
id|hyst
op_assign
(paren
id|i
op_rshift
l_int|4
)paren
op_amp
l_int|0x0f
suffix:semicolon
r_if
c_cond
(paren
(paren
id|data-&gt;type
op_eq
id|lm85b
)paren
op_logical_or
(paren
id|data-&gt;type
op_eq
id|lm85c
)paren
)paren
(brace
id|data-&gt;tach_mode
op_assign
id|lm85_read_value
c_func
(paren
id|client
comma
id|LM85_REG_TACH_MODE
)paren
suffix:semicolon
id|data-&gt;spinup_ctl
op_assign
id|lm85_read_value
c_func
(paren
id|client
comma
id|LM85_REG_SPINUP_CTL
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
(paren
id|data-&gt;type
op_eq
id|adt7463
)paren
op_logical_or
(paren
id|data-&gt;type
op_eq
id|adm1027
)paren
)paren
(brace
r_if
c_cond
(paren
id|data-&gt;type
op_eq
id|adt7463
)paren
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
l_int|2
suffix:semicolon
op_increment
id|i
)paren
(brace
id|data-&gt;oppoint
(braket
id|i
)braket
op_assign
id|lm85_read_value
c_func
(paren
id|client
comma
id|ADT7463_REG_OPPOINT
c_func
(paren
id|i
)paren
)paren
suffix:semicolon
)brace
id|data-&gt;tmin_ctl
op_assign
id|lm85_read_value
c_func
(paren
id|client
comma
id|ADT7463_REG_TMIN_CTL1
)paren
suffix:semicolon
id|data-&gt;therm_limit
op_assign
id|lm85_read_value
c_func
(paren
id|client
comma
id|ADT7463_REG_THERM_LIMIT
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
l_int|2
suffix:semicolon
op_increment
id|i
)paren
(brace
id|data-&gt;temp_offset
(braket
id|i
)braket
op_assign
id|lm85_read_value
c_func
(paren
id|client
comma
id|ADM1027_REG_TEMP_OFFSET
c_func
(paren
id|i
)paren
)paren
suffix:semicolon
)brace
id|data-&gt;tach_mode
op_assign
id|lm85_read_value
c_func
(paren
id|client
comma
id|ADM1027_REG_CONFIG3
)paren
suffix:semicolon
id|data-&gt;fan_ppr
op_assign
id|lm85_read_value
c_func
(paren
id|client
comma
id|ADM1027_REG_FAN_PPR
)paren
suffix:semicolon
)brace
id|data-&gt;last_config
op_assign
id|jiffies
suffix:semicolon
)brace
suffix:semicolon
multiline_comment|/* last_config */
id|data-&gt;valid
op_assign
l_int|1
suffix:semicolon
id|up
c_func
(paren
op_amp
id|data-&gt;update_lock
)paren
suffix:semicolon
r_return
id|data
suffix:semicolon
)brace
DECL|function|sm_lm85_init
r_static
r_int
id|__init
id|sm_lm85_init
c_func
(paren
r_void
)paren
(brace
r_return
id|i2c_add_driver
c_func
(paren
op_amp
id|lm85_driver
)paren
suffix:semicolon
)brace
DECL|function|sm_lm85_exit
r_static
r_void
id|__exit
id|sm_lm85_exit
c_func
(paren
r_void
)paren
(brace
id|i2c_del_driver
c_func
(paren
op_amp
id|lm85_driver
)paren
suffix:semicolon
)brace
multiline_comment|/* Thanks to Richard Barrington for adding the LM85 to sensors-detect.&n; * Thanks to Margit Schubert-While &lt;margitsw@t-online.de&gt; for help with&n; *     post 2.7.0 CVS changes.&n; */
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
id|MODULE_AUTHOR
c_func
(paren
l_string|&quot;Philip Pokorny &lt;ppokorny@penguincomputing.com&gt;, Margit Schubert-While &lt;margitsw@t-online.de&gt;, Justin Thiessen &lt;jthiessen@penguincomputing.com&quot;
)paren
suffix:semicolon
id|MODULE_DESCRIPTION
c_func
(paren
l_string|&quot;LM85-B, LM85-C driver&quot;
)paren
suffix:semicolon
DECL|variable|sm_lm85_init
id|module_init
c_func
(paren
id|sm_lm85_init
)paren
suffix:semicolon
DECL|variable|sm_lm85_exit
id|module_exit
c_func
(paren
id|sm_lm85_exit
)paren
suffix:semicolon
eof
