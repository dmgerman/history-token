multiline_comment|/*&n; * drivers/i2c/busses/i2c-mv64xxx.c&n; * &n; * Driver for the i2c controller on the Marvell line of host bridges for MIPS&n; * and PPC (e.g, gt642[46]0, mv643[46]0, mv644[46]0).&n; *&n; * Author: Mark A. Greer &lt;mgreer@mvista.com&gt;&n; *&n; * 2005 (c) MontaVista, Software, Inc.  This file is licensed under&n; * the terms of the GNU General Public License version 2.  This program&n; * is licensed &quot;as is&quot; without any warranty of any kind, whether express&n; * or implied.&n; */
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/spinlock.h&gt;
macro_line|#include &lt;linux/i2c.h&gt;
macro_line|#include &lt;linux/interrupt.h&gt;
macro_line|#include &lt;linux/mv643xx.h&gt;
macro_line|#include &lt;asm/io.h&gt;
multiline_comment|/* Register defines */
DECL|macro|MV64XXX_I2C_REG_SLAVE_ADDR
mdefine_line|#define&t;MV64XXX_I2C_REG_SLAVE_ADDR&t;&t;&t;0x00
DECL|macro|MV64XXX_I2C_REG_DATA
mdefine_line|#define&t;MV64XXX_I2C_REG_DATA&t;&t;&t;&t;0x04
DECL|macro|MV64XXX_I2C_REG_CONTROL
mdefine_line|#define&t;MV64XXX_I2C_REG_CONTROL&t;&t;&t;&t;0x08
DECL|macro|MV64XXX_I2C_REG_STATUS
mdefine_line|#define&t;MV64XXX_I2C_REG_STATUS&t;&t;&t;&t;0x0c
DECL|macro|MV64XXX_I2C_REG_BAUD
mdefine_line|#define&t;MV64XXX_I2C_REG_BAUD&t;&t;&t;&t;0x0c
DECL|macro|MV64XXX_I2C_REG_EXT_SLAVE_ADDR
mdefine_line|#define&t;MV64XXX_I2C_REG_EXT_SLAVE_ADDR&t;&t;&t;0x10
DECL|macro|MV64XXX_I2C_REG_SOFT_RESET
mdefine_line|#define&t;MV64XXX_I2C_REG_SOFT_RESET&t;&t;&t;0x1c
DECL|macro|MV64XXX_I2C_REG_CONTROL_ACK
mdefine_line|#define&t;MV64XXX_I2C_REG_CONTROL_ACK&t;&t;&t;0x00000004
DECL|macro|MV64XXX_I2C_REG_CONTROL_IFLG
mdefine_line|#define&t;MV64XXX_I2C_REG_CONTROL_IFLG&t;&t;&t;0x00000008
DECL|macro|MV64XXX_I2C_REG_CONTROL_STOP
mdefine_line|#define&t;MV64XXX_I2C_REG_CONTROL_STOP&t;&t;&t;0x00000010
DECL|macro|MV64XXX_I2C_REG_CONTROL_START
mdefine_line|#define&t;MV64XXX_I2C_REG_CONTROL_START&t;&t;&t;0x00000020
DECL|macro|MV64XXX_I2C_REG_CONTROL_TWSIEN
mdefine_line|#define&t;MV64XXX_I2C_REG_CONTROL_TWSIEN&t;&t;&t;0x00000040
DECL|macro|MV64XXX_I2C_REG_CONTROL_INTEN
mdefine_line|#define&t;MV64XXX_I2C_REG_CONTROL_INTEN&t;&t;&t;0x00000080
multiline_comment|/* Ctlr status values */
DECL|macro|MV64XXX_I2C_STATUS_BUS_ERR
mdefine_line|#define&t;MV64XXX_I2C_STATUS_BUS_ERR&t;&t;&t;0x00
DECL|macro|MV64XXX_I2C_STATUS_MAST_START
mdefine_line|#define&t;MV64XXX_I2C_STATUS_MAST_START&t;&t;&t;0x08
DECL|macro|MV64XXX_I2C_STATUS_MAST_REPEAT_START
mdefine_line|#define&t;MV64XXX_I2C_STATUS_MAST_REPEAT_START&t;&t;0x10
DECL|macro|MV64XXX_I2C_STATUS_MAST_WR_ADDR_ACK
mdefine_line|#define&t;MV64XXX_I2C_STATUS_MAST_WR_ADDR_ACK&t;&t;0x18
DECL|macro|MV64XXX_I2C_STATUS_MAST_WR_ADDR_NO_ACK
mdefine_line|#define&t;MV64XXX_I2C_STATUS_MAST_WR_ADDR_NO_ACK&t;&t;0x20
DECL|macro|MV64XXX_I2C_STATUS_MAST_WR_ACK
mdefine_line|#define&t;MV64XXX_I2C_STATUS_MAST_WR_ACK&t;&t;&t;0x28
DECL|macro|MV64XXX_I2C_STATUS_MAST_WR_NO_ACK
mdefine_line|#define&t;MV64XXX_I2C_STATUS_MAST_WR_NO_ACK&t;&t;0x30
DECL|macro|MV64XXX_I2C_STATUS_MAST_LOST_ARB
mdefine_line|#define&t;MV64XXX_I2C_STATUS_MAST_LOST_ARB&t;&t;0x38
DECL|macro|MV64XXX_I2C_STATUS_MAST_RD_ADDR_ACK
mdefine_line|#define&t;MV64XXX_I2C_STATUS_MAST_RD_ADDR_ACK&t;&t;0x40
DECL|macro|MV64XXX_I2C_STATUS_MAST_RD_ADDR_NO_ACK
mdefine_line|#define&t;MV64XXX_I2C_STATUS_MAST_RD_ADDR_NO_ACK&t;&t;0x48
DECL|macro|MV64XXX_I2C_STATUS_MAST_RD_DATA_ACK
mdefine_line|#define&t;MV64XXX_I2C_STATUS_MAST_RD_DATA_ACK&t;&t;0x50
DECL|macro|MV64XXX_I2C_STATUS_MAST_RD_DATA_NO_ACK
mdefine_line|#define&t;MV64XXX_I2C_STATUS_MAST_RD_DATA_NO_ACK&t;&t;0x58
DECL|macro|MV64XXX_I2C_STATUS_MAST_WR_ADDR_2_ACK
mdefine_line|#define&t;MV64XXX_I2C_STATUS_MAST_WR_ADDR_2_ACK&t;&t;0xd0
DECL|macro|MV64XXX_I2C_STATUS_MAST_WR_ADDR_2_NO_ACK
mdefine_line|#define&t;MV64XXX_I2C_STATUS_MAST_WR_ADDR_2_NO_ACK&t;0xd8
DECL|macro|MV64XXX_I2C_STATUS_MAST_RD_ADDR_2_ACK
mdefine_line|#define&t;MV64XXX_I2C_STATUS_MAST_RD_ADDR_2_ACK&t;&t;0xe0
DECL|macro|MV64XXX_I2C_STATUS_MAST_RD_ADDR_2_NO_ACK
mdefine_line|#define&t;MV64XXX_I2C_STATUS_MAST_RD_ADDR_2_NO_ACK&t;0xe8
DECL|macro|MV64XXX_I2C_STATUS_NO_STATUS
mdefine_line|#define&t;MV64XXX_I2C_STATUS_NO_STATUS&t;&t;&t;0xf8
multiline_comment|/* Driver states */
r_enum
(brace
DECL|enumerator|MV64XXX_I2C_STATE_INVALID
id|MV64XXX_I2C_STATE_INVALID
comma
DECL|enumerator|MV64XXX_I2C_STATE_IDLE
id|MV64XXX_I2C_STATE_IDLE
comma
DECL|enumerator|MV64XXX_I2C_STATE_WAITING_FOR_START_COND
id|MV64XXX_I2C_STATE_WAITING_FOR_START_COND
comma
DECL|enumerator|MV64XXX_I2C_STATE_WAITING_FOR_ADDR_1_ACK
id|MV64XXX_I2C_STATE_WAITING_FOR_ADDR_1_ACK
comma
DECL|enumerator|MV64XXX_I2C_STATE_WAITING_FOR_ADDR_2_ACK
id|MV64XXX_I2C_STATE_WAITING_FOR_ADDR_2_ACK
comma
DECL|enumerator|MV64XXX_I2C_STATE_WAITING_FOR_SLAVE_ACK
id|MV64XXX_I2C_STATE_WAITING_FOR_SLAVE_ACK
comma
DECL|enumerator|MV64XXX_I2C_STATE_WAITING_FOR_SLAVE_DATA
id|MV64XXX_I2C_STATE_WAITING_FOR_SLAVE_DATA
comma
DECL|enumerator|MV64XXX_I2C_STATE_ABORTING
id|MV64XXX_I2C_STATE_ABORTING
comma
)brace
suffix:semicolon
multiline_comment|/* Driver actions */
r_enum
(brace
DECL|enumerator|MV64XXX_I2C_ACTION_INVALID
id|MV64XXX_I2C_ACTION_INVALID
comma
DECL|enumerator|MV64XXX_I2C_ACTION_CONTINUE
id|MV64XXX_I2C_ACTION_CONTINUE
comma
DECL|enumerator|MV64XXX_I2C_ACTION_SEND_START
id|MV64XXX_I2C_ACTION_SEND_START
comma
DECL|enumerator|MV64XXX_I2C_ACTION_SEND_ADDR_1
id|MV64XXX_I2C_ACTION_SEND_ADDR_1
comma
DECL|enumerator|MV64XXX_I2C_ACTION_SEND_ADDR_2
id|MV64XXX_I2C_ACTION_SEND_ADDR_2
comma
DECL|enumerator|MV64XXX_I2C_ACTION_SEND_DATA
id|MV64XXX_I2C_ACTION_SEND_DATA
comma
DECL|enumerator|MV64XXX_I2C_ACTION_RCV_DATA
id|MV64XXX_I2C_ACTION_RCV_DATA
comma
DECL|enumerator|MV64XXX_I2C_ACTION_RCV_DATA_STOP
id|MV64XXX_I2C_ACTION_RCV_DATA_STOP
comma
DECL|enumerator|MV64XXX_I2C_ACTION_SEND_STOP
id|MV64XXX_I2C_ACTION_SEND_STOP
comma
)brace
suffix:semicolon
DECL|struct|mv64xxx_i2c_data
r_struct
id|mv64xxx_i2c_data
(brace
DECL|member|irq
r_int
id|irq
suffix:semicolon
DECL|member|state
id|u32
id|state
suffix:semicolon
DECL|member|action
id|u32
id|action
suffix:semicolon
DECL|member|cntl_bits
id|u32
id|cntl_bits
suffix:semicolon
DECL|member|reg_base
r_void
id|__iomem
op_star
id|reg_base
suffix:semicolon
DECL|member|reg_base_p
id|u32
id|reg_base_p
suffix:semicolon
DECL|member|addr1
id|u32
id|addr1
suffix:semicolon
DECL|member|addr2
id|u32
id|addr2
suffix:semicolon
DECL|member|bytes_left
id|u32
id|bytes_left
suffix:semicolon
DECL|member|byte_posn
id|u32
id|byte_posn
suffix:semicolon
DECL|member|block
id|u32
id|block
suffix:semicolon
DECL|member|rc
r_int
id|rc
suffix:semicolon
DECL|member|freq_m
id|u32
id|freq_m
suffix:semicolon
DECL|member|freq_n
id|u32
id|freq_n
suffix:semicolon
DECL|member|waitq
id|wait_queue_head_t
id|waitq
suffix:semicolon
DECL|member|lock
id|spinlock_t
id|lock
suffix:semicolon
DECL|member|msg
r_struct
id|i2c_msg
op_star
id|msg
suffix:semicolon
DECL|member|adapter
r_struct
id|i2c_adapter
id|adapter
suffix:semicolon
)brace
suffix:semicolon
multiline_comment|/*&n; *****************************************************************************&n; *&n; *&t;Finite State Machine &amp; Interrupt Routines&n; *&n; *****************************************************************************&n; */
r_static
r_void
DECL|function|mv64xxx_i2c_fsm
id|mv64xxx_i2c_fsm
c_func
(paren
r_struct
id|mv64xxx_i2c_data
op_star
id|drv_data
comma
id|u32
id|status
)paren
(brace
multiline_comment|/*&n;&t; * If state is idle, then this is likely the remnants of an old&n;&t; * operation that driver has given up on or the user has killed.&n;&t; * If so, issue the stop condition and go to idle.&n;&t; */
r_if
c_cond
(paren
id|drv_data-&gt;state
op_eq
id|MV64XXX_I2C_STATE_IDLE
)paren
(brace
id|drv_data-&gt;action
op_assign
id|MV64XXX_I2C_ACTION_SEND_STOP
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|drv_data-&gt;state
op_eq
id|MV64XXX_I2C_STATE_ABORTING
)paren
(brace
id|drv_data-&gt;action
op_assign
id|MV64XXX_I2C_ACTION_SEND_STOP
suffix:semicolon
id|drv_data-&gt;state
op_assign
id|MV64XXX_I2C_STATE_IDLE
suffix:semicolon
r_return
suffix:semicolon
)brace
multiline_comment|/* The status from the ctlr [mostly] tells us what to do next */
r_switch
c_cond
(paren
id|status
)paren
(brace
multiline_comment|/* Start condition interrupt */
r_case
id|MV64XXX_I2C_STATUS_MAST_START
suffix:colon
multiline_comment|/* 0x08 */
r_case
id|MV64XXX_I2C_STATUS_MAST_REPEAT_START
suffix:colon
multiline_comment|/* 0x10 */
id|drv_data-&gt;action
op_assign
id|MV64XXX_I2C_ACTION_SEND_ADDR_1
suffix:semicolon
id|drv_data-&gt;state
op_assign
id|MV64XXX_I2C_STATE_WAITING_FOR_ADDR_1_ACK
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* Performing a write */
r_case
id|MV64XXX_I2C_STATUS_MAST_WR_ADDR_ACK
suffix:colon
multiline_comment|/* 0x18 */
r_if
c_cond
(paren
id|drv_data-&gt;msg-&gt;flags
op_amp
id|I2C_M_TEN
)paren
(brace
id|drv_data-&gt;action
op_assign
id|MV64XXX_I2C_ACTION_SEND_ADDR_2
suffix:semicolon
id|drv_data-&gt;state
op_assign
id|MV64XXX_I2C_STATE_WAITING_FOR_ADDR_2_ACK
suffix:semicolon
r_break
suffix:semicolon
)brace
multiline_comment|/* FALLTHRU */
r_case
id|MV64XXX_I2C_STATUS_MAST_WR_ADDR_2_ACK
suffix:colon
multiline_comment|/* 0xd0 */
r_case
id|MV64XXX_I2C_STATUS_MAST_WR_ACK
suffix:colon
multiline_comment|/* 0x28 */
r_if
c_cond
(paren
id|drv_data-&gt;bytes_left
OG
l_int|0
)paren
(brace
id|drv_data-&gt;action
op_assign
id|MV64XXX_I2C_ACTION_SEND_DATA
suffix:semicolon
id|drv_data-&gt;state
op_assign
id|MV64XXX_I2C_STATE_WAITING_FOR_SLAVE_ACK
suffix:semicolon
id|drv_data-&gt;bytes_left
op_decrement
suffix:semicolon
)brace
r_else
(brace
id|drv_data-&gt;action
op_assign
id|MV64XXX_I2C_ACTION_SEND_STOP
suffix:semicolon
id|drv_data-&gt;state
op_assign
id|MV64XXX_I2C_STATE_IDLE
suffix:semicolon
)brace
r_break
suffix:semicolon
multiline_comment|/* Performing a read */
r_case
id|MV64XXX_I2C_STATUS_MAST_RD_ADDR_ACK
suffix:colon
multiline_comment|/* 40 */
r_if
c_cond
(paren
id|drv_data-&gt;msg-&gt;flags
op_amp
id|I2C_M_TEN
)paren
(brace
id|drv_data-&gt;action
op_assign
id|MV64XXX_I2C_ACTION_SEND_ADDR_2
suffix:semicolon
id|drv_data-&gt;state
op_assign
id|MV64XXX_I2C_STATE_WAITING_FOR_ADDR_2_ACK
suffix:semicolon
r_break
suffix:semicolon
)brace
multiline_comment|/* FALLTHRU */
r_case
id|MV64XXX_I2C_STATUS_MAST_RD_ADDR_2_ACK
suffix:colon
multiline_comment|/* 0xe0 */
r_if
c_cond
(paren
id|drv_data-&gt;bytes_left
op_eq
l_int|0
)paren
(brace
id|drv_data-&gt;action
op_assign
id|MV64XXX_I2C_ACTION_SEND_STOP
suffix:semicolon
id|drv_data-&gt;state
op_assign
id|MV64XXX_I2C_STATE_IDLE
suffix:semicolon
r_break
suffix:semicolon
)brace
multiline_comment|/* FALLTHRU */
r_case
id|MV64XXX_I2C_STATUS_MAST_RD_DATA_ACK
suffix:colon
multiline_comment|/* 0x50 */
r_if
c_cond
(paren
id|status
op_ne
id|MV64XXX_I2C_STATUS_MAST_RD_DATA_ACK
)paren
id|drv_data-&gt;action
op_assign
id|MV64XXX_I2C_ACTION_CONTINUE
suffix:semicolon
r_else
(brace
id|drv_data-&gt;action
op_assign
id|MV64XXX_I2C_ACTION_RCV_DATA
suffix:semicolon
id|drv_data-&gt;bytes_left
op_decrement
suffix:semicolon
)brace
id|drv_data-&gt;state
op_assign
id|MV64XXX_I2C_STATE_WAITING_FOR_SLAVE_DATA
suffix:semicolon
r_if
c_cond
(paren
id|drv_data-&gt;bytes_left
op_eq
l_int|1
)paren
id|drv_data-&gt;cntl_bits
op_and_assign
op_complement
id|MV64XXX_I2C_REG_CONTROL_ACK
suffix:semicolon
r_break
suffix:semicolon
r_case
id|MV64XXX_I2C_STATUS_MAST_RD_DATA_NO_ACK
suffix:colon
multiline_comment|/* 0x58 */
id|drv_data-&gt;action
op_assign
id|MV64XXX_I2C_ACTION_RCV_DATA_STOP
suffix:semicolon
id|drv_data-&gt;state
op_assign
id|MV64XXX_I2C_STATE_IDLE
suffix:semicolon
r_break
suffix:semicolon
r_case
id|MV64XXX_I2C_STATUS_MAST_WR_ADDR_NO_ACK
suffix:colon
multiline_comment|/* 0x20 */
r_case
id|MV64XXX_I2C_STATUS_MAST_WR_NO_ACK
suffix:colon
multiline_comment|/* 30 */
r_case
id|MV64XXX_I2C_STATUS_MAST_RD_ADDR_NO_ACK
suffix:colon
multiline_comment|/* 48 */
multiline_comment|/* Doesn&squot;t seem to be a device at other end */
id|drv_data-&gt;action
op_assign
id|MV64XXX_I2C_ACTION_SEND_STOP
suffix:semicolon
id|drv_data-&gt;state
op_assign
id|MV64XXX_I2C_STATE_IDLE
suffix:semicolon
id|drv_data-&gt;rc
op_assign
op_minus
id|ENODEV
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|dev_err
c_func
(paren
op_amp
id|drv_data-&gt;adapter.dev
comma
l_string|&quot;mv64xxx_i2c_fsm: Ctlr Error -- state: 0x%x, &quot;
l_string|&quot;status: 0x%x, addr: 0x%x, flags: 0x%x&bslash;n&quot;
comma
id|drv_data-&gt;state
comma
id|status
comma
id|drv_data-&gt;msg-&gt;addr
comma
id|drv_data-&gt;msg-&gt;flags
)paren
suffix:semicolon
id|drv_data-&gt;action
op_assign
id|MV64XXX_I2C_ACTION_SEND_STOP
suffix:semicolon
id|drv_data-&gt;state
op_assign
id|MV64XXX_I2C_STATE_IDLE
suffix:semicolon
id|drv_data-&gt;rc
op_assign
op_minus
id|EIO
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|mv64xxx_i2c_do_action
id|mv64xxx_i2c_do_action
c_func
(paren
r_struct
id|mv64xxx_i2c_data
op_star
id|drv_data
)paren
(brace
r_switch
c_cond
(paren
id|drv_data-&gt;action
)paren
(brace
r_case
id|MV64XXX_I2C_ACTION_CONTINUE
suffix:colon
id|writel
c_func
(paren
id|drv_data-&gt;cntl_bits
comma
id|drv_data-&gt;reg_base
op_plus
id|MV64XXX_I2C_REG_CONTROL
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|MV64XXX_I2C_ACTION_SEND_START
suffix:colon
id|writel
c_func
(paren
id|drv_data-&gt;cntl_bits
op_or
id|MV64XXX_I2C_REG_CONTROL_START
comma
id|drv_data-&gt;reg_base
op_plus
id|MV64XXX_I2C_REG_CONTROL
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|MV64XXX_I2C_ACTION_SEND_ADDR_1
suffix:colon
id|writel
c_func
(paren
id|drv_data-&gt;addr1
comma
id|drv_data-&gt;reg_base
op_plus
id|MV64XXX_I2C_REG_DATA
)paren
suffix:semicolon
id|writel
c_func
(paren
id|drv_data-&gt;cntl_bits
comma
id|drv_data-&gt;reg_base
op_plus
id|MV64XXX_I2C_REG_CONTROL
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|MV64XXX_I2C_ACTION_SEND_ADDR_2
suffix:colon
id|writel
c_func
(paren
id|drv_data-&gt;addr2
comma
id|drv_data-&gt;reg_base
op_plus
id|MV64XXX_I2C_REG_DATA
)paren
suffix:semicolon
id|writel
c_func
(paren
id|drv_data-&gt;cntl_bits
comma
id|drv_data-&gt;reg_base
op_plus
id|MV64XXX_I2C_REG_CONTROL
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|MV64XXX_I2C_ACTION_SEND_DATA
suffix:colon
id|writel
c_func
(paren
id|drv_data-&gt;msg-&gt;buf
(braket
id|drv_data-&gt;byte_posn
op_increment
)braket
comma
id|drv_data-&gt;reg_base
op_plus
id|MV64XXX_I2C_REG_DATA
)paren
suffix:semicolon
id|writel
c_func
(paren
id|drv_data-&gt;cntl_bits
comma
id|drv_data-&gt;reg_base
op_plus
id|MV64XXX_I2C_REG_CONTROL
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|MV64XXX_I2C_ACTION_RCV_DATA
suffix:colon
id|drv_data-&gt;msg-&gt;buf
(braket
id|drv_data-&gt;byte_posn
op_increment
)braket
op_assign
id|readl
c_func
(paren
id|drv_data-&gt;reg_base
op_plus
id|MV64XXX_I2C_REG_DATA
)paren
suffix:semicolon
id|writel
c_func
(paren
id|drv_data-&gt;cntl_bits
comma
id|drv_data-&gt;reg_base
op_plus
id|MV64XXX_I2C_REG_CONTROL
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|MV64XXX_I2C_ACTION_RCV_DATA_STOP
suffix:colon
id|drv_data-&gt;msg-&gt;buf
(braket
id|drv_data-&gt;byte_posn
op_increment
)braket
op_assign
id|readl
c_func
(paren
id|drv_data-&gt;reg_base
op_plus
id|MV64XXX_I2C_REG_DATA
)paren
suffix:semicolon
id|drv_data-&gt;cntl_bits
op_and_assign
op_complement
id|MV64XXX_I2C_REG_CONTROL_INTEN
suffix:semicolon
id|writel
c_func
(paren
id|drv_data-&gt;cntl_bits
op_or
id|MV64XXX_I2C_REG_CONTROL_STOP
comma
id|drv_data-&gt;reg_base
op_plus
id|MV64XXX_I2C_REG_CONTROL
)paren
suffix:semicolon
id|drv_data-&gt;block
op_assign
l_int|0
suffix:semicolon
id|wake_up_interruptible
c_func
(paren
op_amp
id|drv_data-&gt;waitq
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|MV64XXX_I2C_ACTION_INVALID
suffix:colon
r_default
suffix:colon
id|dev_err
c_func
(paren
op_amp
id|drv_data-&gt;adapter.dev
comma
l_string|&quot;mv64xxx_i2c_do_action: Invalid action: %d&bslash;n&quot;
comma
id|drv_data-&gt;action
)paren
suffix:semicolon
id|drv_data-&gt;rc
op_assign
op_minus
id|EIO
suffix:semicolon
multiline_comment|/* FALLTHRU */
r_case
id|MV64XXX_I2C_ACTION_SEND_STOP
suffix:colon
id|drv_data-&gt;cntl_bits
op_and_assign
op_complement
id|MV64XXX_I2C_REG_CONTROL_INTEN
suffix:semicolon
id|writel
c_func
(paren
id|drv_data-&gt;cntl_bits
op_or
id|MV64XXX_I2C_REG_CONTROL_STOP
comma
id|drv_data-&gt;reg_base
op_plus
id|MV64XXX_I2C_REG_CONTROL
)paren
suffix:semicolon
id|drv_data-&gt;block
op_assign
l_int|0
suffix:semicolon
id|wake_up_interruptible
c_func
(paren
op_amp
id|drv_data-&gt;waitq
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_static
r_int
DECL|function|mv64xxx_i2c_intr
id|mv64xxx_i2c_intr
c_func
(paren
r_int
id|irq
comma
r_void
op_star
id|dev_id
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
r_struct
id|mv64xxx_i2c_data
op_star
id|drv_data
op_assign
id|dev_id
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|u32
id|status
suffix:semicolon
r_int
id|rc
op_assign
id|IRQ_NONE
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|drv_data-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_while
c_loop
(paren
id|readl
c_func
(paren
id|drv_data-&gt;reg_base
op_plus
id|MV64XXX_I2C_REG_CONTROL
)paren
op_amp
id|MV64XXX_I2C_REG_CONTROL_IFLG
)paren
(brace
id|status
op_assign
id|readl
c_func
(paren
id|drv_data-&gt;reg_base
op_plus
id|MV64XXX_I2C_REG_STATUS
)paren
suffix:semicolon
id|mv64xxx_i2c_fsm
c_func
(paren
id|drv_data
comma
id|status
)paren
suffix:semicolon
id|mv64xxx_i2c_do_action
c_func
(paren
id|drv_data
)paren
suffix:semicolon
id|rc
op_assign
id|IRQ_HANDLED
suffix:semicolon
)brace
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|drv_data-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_return
id|rc
suffix:semicolon
)brace
multiline_comment|/*&n; *****************************************************************************&n; *&n; *&t;I2C Msg Execution Routines&n; *&n; *****************************************************************************&n; */
r_static
r_void
DECL|function|mv64xxx_i2c_prepare_for_io
id|mv64xxx_i2c_prepare_for_io
c_func
(paren
r_struct
id|mv64xxx_i2c_data
op_star
id|drv_data
comma
r_struct
id|i2c_msg
op_star
id|msg
)paren
(brace
id|u32
id|dir
op_assign
l_int|0
suffix:semicolon
id|drv_data-&gt;msg
op_assign
id|msg
suffix:semicolon
id|drv_data-&gt;byte_posn
op_assign
l_int|0
suffix:semicolon
id|drv_data-&gt;bytes_left
op_assign
id|msg-&gt;len
suffix:semicolon
id|drv_data-&gt;rc
op_assign
l_int|0
suffix:semicolon
id|drv_data-&gt;cntl_bits
op_assign
id|MV64XXX_I2C_REG_CONTROL_ACK
op_or
id|MV64XXX_I2C_REG_CONTROL_INTEN
op_or
id|MV64XXX_I2C_REG_CONTROL_TWSIEN
suffix:semicolon
r_if
c_cond
(paren
id|msg-&gt;flags
op_amp
id|I2C_M_RD
)paren
id|dir
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|msg-&gt;flags
op_amp
id|I2C_M_REV_DIR_ADDR
)paren
id|dir
op_xor_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|msg-&gt;flags
op_amp
id|I2C_M_TEN
)paren
(brace
id|drv_data-&gt;addr1
op_assign
l_int|0xf0
op_or
(paren
(paren
(paren
id|u32
)paren
id|msg-&gt;addr
op_amp
l_int|0x300
)paren
op_rshift
l_int|7
)paren
op_or
id|dir
suffix:semicolon
id|drv_data-&gt;addr2
op_assign
(paren
id|u32
)paren
id|msg-&gt;addr
op_amp
l_int|0xff
suffix:semicolon
)brace
r_else
(brace
id|drv_data-&gt;addr1
op_assign
(paren
(paren
id|u32
)paren
id|msg-&gt;addr
op_amp
l_int|0x7f
)paren
op_lshift
l_int|1
op_or
id|dir
suffix:semicolon
id|drv_data-&gt;addr2
op_assign
l_int|0
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|mv64xxx_i2c_wait_for_completion
id|mv64xxx_i2c_wait_for_completion
c_func
(paren
r_struct
id|mv64xxx_i2c_data
op_star
id|drv_data
)paren
(brace
r_int
id|time_left
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_char
m_abort
op_assign
l_int|0
suffix:semicolon
id|time_left
op_assign
id|wait_event_interruptible_timeout
c_func
(paren
id|drv_data-&gt;waitq
comma
op_logical_neg
id|drv_data-&gt;block
comma
id|msecs_to_jiffies
c_func
(paren
id|drv_data-&gt;adapter.timeout
)paren
)paren
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|drv_data-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|time_left
)paren
(brace
multiline_comment|/* Timed out */
id|drv_data-&gt;rc
op_assign
op_minus
id|ETIMEDOUT
suffix:semicolon
m_abort
op_assign
l_int|1
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|time_left
OL
l_int|0
)paren
(brace
multiline_comment|/* Interrupted/Error */
id|drv_data-&gt;rc
op_assign
id|time_left
suffix:semicolon
multiline_comment|/* errno value */
m_abort
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
m_abort
op_logical_and
id|drv_data-&gt;block
)paren
(brace
id|drv_data-&gt;state
op_assign
id|MV64XXX_I2C_STATE_ABORTING
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|drv_data-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|time_left
op_assign
id|wait_event_timeout
c_func
(paren
id|drv_data-&gt;waitq
comma
op_logical_neg
id|drv_data-&gt;block
comma
id|msecs_to_jiffies
c_func
(paren
id|drv_data-&gt;adapter.timeout
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|time_left
op_le
l_int|0
)paren
(brace
id|drv_data-&gt;state
op_assign
id|MV64XXX_I2C_STATE_IDLE
suffix:semicolon
id|dev_err
c_func
(paren
op_amp
id|drv_data-&gt;adapter.dev
comma
l_string|&quot;mv64xxx: I2C bus locked&bslash;n&quot;
)paren
suffix:semicolon
)brace
)brace
r_else
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|drv_data-&gt;lock
comma
id|flags
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|mv64xxx_i2c_execute_msg
id|mv64xxx_i2c_execute_msg
c_func
(paren
r_struct
id|mv64xxx_i2c_data
op_star
id|drv_data
comma
r_struct
id|i2c_msg
op_star
id|msg
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|drv_data-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|mv64xxx_i2c_prepare_for_io
c_func
(paren
id|drv_data
comma
id|msg
)paren
suffix:semicolon
r_if
c_cond
(paren
id|unlikely
c_func
(paren
id|msg-&gt;flags
op_amp
id|I2C_M_NOSTART
)paren
)paren
(brace
multiline_comment|/* Skip start/addr phases */
r_if
c_cond
(paren
id|drv_data-&gt;msg-&gt;flags
op_amp
id|I2C_M_RD
)paren
(brace
multiline_comment|/* No action to do, wait for slave to send a byte */
id|drv_data-&gt;action
op_assign
id|MV64XXX_I2C_ACTION_CONTINUE
suffix:semicolon
id|drv_data-&gt;state
op_assign
id|MV64XXX_I2C_STATE_WAITING_FOR_SLAVE_DATA
suffix:semicolon
)brace
r_else
(brace
id|drv_data-&gt;action
op_assign
id|MV64XXX_I2C_ACTION_SEND_DATA
suffix:semicolon
id|drv_data-&gt;state
op_assign
id|MV64XXX_I2C_STATE_WAITING_FOR_SLAVE_ACK
suffix:semicolon
id|drv_data-&gt;bytes_left
op_decrement
suffix:semicolon
)brace
)brace
r_else
(brace
id|drv_data-&gt;action
op_assign
id|MV64XXX_I2C_ACTION_SEND_START
suffix:semicolon
id|drv_data-&gt;state
op_assign
id|MV64XXX_I2C_STATE_WAITING_FOR_START_COND
suffix:semicolon
)brace
id|drv_data-&gt;block
op_assign
l_int|1
suffix:semicolon
id|mv64xxx_i2c_do_action
c_func
(paren
id|drv_data
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|drv_data-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|mv64xxx_i2c_wait_for_completion
c_func
(paren
id|drv_data
)paren
suffix:semicolon
r_return
id|drv_data-&gt;rc
suffix:semicolon
)brace
multiline_comment|/*&n; *****************************************************************************&n; *&n; *&t;I2C Core Support Routines (Interface to higher level I2C code)&n; *&n; *****************************************************************************&n; */
r_static
id|u32
DECL|function|mv64xxx_i2c_functionality
id|mv64xxx_i2c_functionality
c_func
(paren
r_struct
id|i2c_adapter
op_star
id|adap
)paren
(brace
r_return
id|I2C_FUNC_I2C
op_or
id|I2C_FUNC_10BIT_ADDR
op_or
id|I2C_FUNC_SMBUS_EMUL
suffix:semicolon
)brace
r_static
r_int
DECL|function|mv64xxx_i2c_xfer
id|mv64xxx_i2c_xfer
c_func
(paren
r_struct
id|i2c_adapter
op_star
id|adap
comma
r_struct
id|i2c_msg
id|msgs
(braket
)braket
comma
r_int
id|num
)paren
(brace
r_struct
id|mv64xxx_i2c_data
op_star
id|drv_data
op_assign
id|i2c_get_adapdata
c_func
(paren
id|adap
)paren
suffix:semicolon
r_int
id|i
comma
id|rc
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|num
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
(paren
id|rc
op_assign
id|mv64xxx_i2c_execute_msg
c_func
(paren
id|drv_data
comma
op_amp
id|msgs
(braket
id|i
)braket
)paren
)paren
op_ne
l_int|0
)paren
r_break
suffix:semicolon
r_return
id|rc
suffix:semicolon
)brace
DECL|variable|mv64xxx_i2c_algo
r_static
r_struct
id|i2c_algorithm
id|mv64xxx_i2c_algo
op_assign
(brace
dot
id|name
op_assign
id|MV64XXX_I2C_CTLR_NAME
l_string|&quot; algorithm&quot;
comma
dot
id|id
op_assign
id|I2C_ALGO_MV64XXX
comma
dot
id|master_xfer
op_assign
id|mv64xxx_i2c_xfer
comma
dot
id|functionality
op_assign
id|mv64xxx_i2c_functionality
comma
)brace
suffix:semicolon
multiline_comment|/*&n; *****************************************************************************&n; *&n; *&t;Driver Interface &amp; Early Init Routines&n; *&n; *****************************************************************************&n; */
r_static
r_void
id|__devinit
DECL|function|mv64xxx_i2c_hw_init
id|mv64xxx_i2c_hw_init
c_func
(paren
r_struct
id|mv64xxx_i2c_data
op_star
id|drv_data
)paren
(brace
id|writel
c_func
(paren
l_int|0
comma
id|drv_data-&gt;reg_base
op_plus
id|MV64XXX_I2C_REG_SOFT_RESET
)paren
suffix:semicolon
id|writel
c_func
(paren
(paren
(paren
(paren
id|drv_data-&gt;freq_m
op_amp
l_int|0xf
)paren
op_lshift
l_int|3
)paren
op_or
(paren
id|drv_data-&gt;freq_n
op_amp
l_int|0x7
)paren
)paren
comma
id|drv_data-&gt;reg_base
op_plus
id|MV64XXX_I2C_REG_BAUD
)paren
suffix:semicolon
id|writel
c_func
(paren
l_int|0
comma
id|drv_data-&gt;reg_base
op_plus
id|MV64XXX_I2C_REG_SLAVE_ADDR
)paren
suffix:semicolon
id|writel
c_func
(paren
l_int|0
comma
id|drv_data-&gt;reg_base
op_plus
id|MV64XXX_I2C_REG_EXT_SLAVE_ADDR
)paren
suffix:semicolon
id|writel
c_func
(paren
id|MV64XXX_I2C_REG_CONTROL_TWSIEN
op_or
id|MV64XXX_I2C_REG_CONTROL_STOP
comma
id|drv_data-&gt;reg_base
op_plus
id|MV64XXX_I2C_REG_CONTROL
)paren
suffix:semicolon
id|drv_data-&gt;state
op_assign
id|MV64XXX_I2C_STATE_IDLE
suffix:semicolon
)brace
r_static
r_int
id|__devinit
DECL|function|mv64xxx_i2c_map_regs
id|mv64xxx_i2c_map_regs
c_func
(paren
r_struct
id|platform_device
op_star
id|pd
comma
r_struct
id|mv64xxx_i2c_data
op_star
id|drv_data
)paren
(brace
r_struct
id|resource
op_star
id|r
suffix:semicolon
r_if
c_cond
(paren
(paren
id|r
op_assign
id|platform_get_resource
c_func
(paren
id|pd
comma
id|IORESOURCE_MEM
comma
l_int|0
)paren
)paren
op_logical_and
id|request_mem_region
c_func
(paren
id|r-&gt;start
comma
id|MV64XXX_I2C_REG_BLOCK_SIZE
comma
id|drv_data-&gt;adapter.name
)paren
)paren
(brace
id|drv_data-&gt;reg_base
op_assign
id|ioremap
c_func
(paren
id|r-&gt;start
comma
id|MV64XXX_I2C_REG_BLOCK_SIZE
)paren
suffix:semicolon
id|drv_data-&gt;reg_base_p
op_assign
id|r-&gt;start
suffix:semicolon
)brace
r_else
r_return
op_minus
id|ENOMEM
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_void
id|__devexit
DECL|function|mv64xxx_i2c_unmap_regs
id|mv64xxx_i2c_unmap_regs
c_func
(paren
r_struct
id|mv64xxx_i2c_data
op_star
id|drv_data
)paren
(brace
r_if
c_cond
(paren
id|drv_data-&gt;reg_base
)paren
(brace
id|iounmap
c_func
(paren
id|drv_data-&gt;reg_base
)paren
suffix:semicolon
id|release_mem_region
c_func
(paren
id|drv_data-&gt;reg_base_p
comma
id|MV64XXX_I2C_REG_BLOCK_SIZE
)paren
suffix:semicolon
)brace
id|drv_data-&gt;reg_base
op_assign
l_int|NULL
suffix:semicolon
id|drv_data-&gt;reg_base_p
op_assign
l_int|0
suffix:semicolon
)brace
r_static
r_int
id|__devinit
DECL|function|mv64xxx_i2c_probe
id|mv64xxx_i2c_probe
c_func
(paren
r_struct
id|device
op_star
id|dev
)paren
(brace
r_struct
id|platform_device
op_star
id|pd
op_assign
id|to_platform_device
c_func
(paren
id|dev
)paren
suffix:semicolon
r_struct
id|mv64xxx_i2c_data
op_star
id|drv_data
suffix:semicolon
r_struct
id|mv64xxx_i2c_pdata
op_star
id|pdata
op_assign
id|dev-&gt;platform_data
suffix:semicolon
r_int
id|rc
suffix:semicolon
r_if
c_cond
(paren
(paren
id|pd-&gt;id
op_ne
l_int|0
)paren
op_logical_or
op_logical_neg
id|pdata
)paren
r_return
op_minus
id|ENODEV
suffix:semicolon
id|drv_data
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|mv64xxx_i2c_data
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|drv_data
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|memset
c_func
(paren
id|drv_data
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|mv64xxx_i2c_data
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|mv64xxx_i2c_map_regs
c_func
(paren
id|pd
comma
id|drv_data
)paren
)paren
(brace
id|rc
op_assign
op_minus
id|ENODEV
suffix:semicolon
r_goto
id|exit_kfree
suffix:semicolon
)brace
id|strncpy
c_func
(paren
id|drv_data-&gt;adapter.name
comma
id|MV64XXX_I2C_CTLR_NAME
l_string|&quot; adapter&quot;
comma
id|I2C_NAME_SIZE
)paren
suffix:semicolon
id|init_waitqueue_head
c_func
(paren
op_amp
id|drv_data-&gt;waitq
)paren
suffix:semicolon
id|spin_lock_init
c_func
(paren
op_amp
id|drv_data-&gt;lock
)paren
suffix:semicolon
id|drv_data-&gt;freq_m
op_assign
id|pdata-&gt;freq_m
suffix:semicolon
id|drv_data-&gt;freq_n
op_assign
id|pdata-&gt;freq_n
suffix:semicolon
id|drv_data-&gt;irq
op_assign
id|platform_get_irq
c_func
(paren
id|pd
comma
l_int|0
)paren
suffix:semicolon
id|drv_data-&gt;adapter.id
op_assign
id|I2C_ALGO_MV64XXX
op_or
id|I2C_HW_MV64XXX
suffix:semicolon
id|drv_data-&gt;adapter.algo
op_assign
op_amp
id|mv64xxx_i2c_algo
suffix:semicolon
id|drv_data-&gt;adapter.timeout
op_assign
id|pdata-&gt;timeout
suffix:semicolon
id|drv_data-&gt;adapter.retries
op_assign
id|pdata-&gt;retries
suffix:semicolon
id|dev_set_drvdata
c_func
(paren
id|dev
comma
id|drv_data
)paren
suffix:semicolon
id|i2c_set_adapdata
c_func
(paren
op_amp
id|drv_data-&gt;adapter
comma
id|drv_data
)paren
suffix:semicolon
r_if
c_cond
(paren
id|request_irq
c_func
(paren
id|drv_data-&gt;irq
comma
id|mv64xxx_i2c_intr
comma
l_int|0
comma
id|MV64XXX_I2C_CTLR_NAME
comma
id|drv_data
)paren
)paren
(brace
id|dev_err
c_func
(paren
id|dev
comma
l_string|&quot;mv64xxx: Can&squot;t register intr handler &quot;
l_string|&quot;irq: %d&bslash;n&quot;
comma
id|drv_data-&gt;irq
)paren
suffix:semicolon
id|rc
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_goto
id|exit_unmap_regs
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
(paren
id|rc
op_assign
id|i2c_add_adapter
c_func
(paren
op_amp
id|drv_data-&gt;adapter
)paren
)paren
op_ne
l_int|0
)paren
(brace
id|dev_err
c_func
(paren
id|dev
comma
l_string|&quot;mv64xxx: Can&squot;t add i2c adapter, rc: %d&bslash;n&quot;
comma
op_minus
id|rc
)paren
suffix:semicolon
r_goto
id|exit_free_irq
suffix:semicolon
)brace
id|mv64xxx_i2c_hw_init
c_func
(paren
id|drv_data
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
id|exit_free_irq
suffix:colon
id|free_irq
c_func
(paren
id|drv_data-&gt;irq
comma
id|drv_data
)paren
suffix:semicolon
id|exit_unmap_regs
suffix:colon
id|mv64xxx_i2c_unmap_regs
c_func
(paren
id|drv_data
)paren
suffix:semicolon
id|exit_kfree
suffix:colon
id|kfree
c_func
(paren
id|drv_data
)paren
suffix:semicolon
r_return
id|rc
suffix:semicolon
)brace
r_static
r_int
id|__devexit
DECL|function|mv64xxx_i2c_remove
id|mv64xxx_i2c_remove
c_func
(paren
r_struct
id|device
op_star
id|dev
)paren
(brace
r_struct
id|mv64xxx_i2c_data
op_star
id|drv_data
op_assign
id|dev_get_drvdata
c_func
(paren
id|dev
)paren
suffix:semicolon
r_int
id|rc
suffix:semicolon
id|rc
op_assign
id|i2c_del_adapter
c_func
(paren
op_amp
id|drv_data-&gt;adapter
)paren
suffix:semicolon
id|free_irq
c_func
(paren
id|drv_data-&gt;irq
comma
id|drv_data
)paren
suffix:semicolon
id|mv64xxx_i2c_unmap_regs
c_func
(paren
id|drv_data
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|drv_data
)paren
suffix:semicolon
r_return
id|rc
suffix:semicolon
)brace
DECL|variable|mv64xxx_i2c_driver
r_static
r_struct
id|device_driver
id|mv64xxx_i2c_driver
op_assign
(brace
dot
id|name
op_assign
id|MV64XXX_I2C_CTLR_NAME
comma
dot
id|bus
op_assign
op_amp
id|platform_bus_type
comma
dot
id|probe
op_assign
id|mv64xxx_i2c_probe
comma
dot
id|remove
op_assign
id|mv64xxx_i2c_remove
comma
)brace
suffix:semicolon
r_static
r_int
id|__init
DECL|function|mv64xxx_i2c_init
id|mv64xxx_i2c_init
c_func
(paren
r_void
)paren
(brace
r_return
id|driver_register
c_func
(paren
op_amp
id|mv64xxx_i2c_driver
)paren
suffix:semicolon
)brace
r_static
r_void
id|__exit
DECL|function|mv64xxx_i2c_exit
id|mv64xxx_i2c_exit
c_func
(paren
r_void
)paren
(brace
id|driver_unregister
c_func
(paren
op_amp
id|mv64xxx_i2c_driver
)paren
suffix:semicolon
)brace
DECL|variable|mv64xxx_i2c_init
id|module_init
c_func
(paren
id|mv64xxx_i2c_init
)paren
suffix:semicolon
DECL|variable|mv64xxx_i2c_exit
id|module_exit
c_func
(paren
id|mv64xxx_i2c_exit
)paren
suffix:semicolon
id|MODULE_AUTHOR
c_func
(paren
l_string|&quot;Mark A. Greer &lt;mgreer@mvista.com&gt;&quot;
)paren
suffix:semicolon
id|MODULE_DESCRIPTION
c_func
(paren
l_string|&quot;Marvell mv64xxx host bridge i2c ctlr driver&quot;
)paren
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
eof
