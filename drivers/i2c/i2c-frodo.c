multiline_comment|/*&n; * linux/drivers/i2c/i2c-frodo.c&n; *&n; * Author: Abraham van der Merwe &lt;abraham@2d3d.co.za&gt;&n; *&n; * An I2C adapter driver for the 2d3D, Inc. StrongARM SA-1110&n; * Development board (Frodo).&n; *&n; * This source code is free software; you can redistribute it and/or&n; * modify it under the terms of the GNU General Public License&n; * version 2 as published by the Free Software Foundation.&n; */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/version.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/delay.h&gt;
macro_line|#include &lt;asm/hardware.h&gt;
macro_line|#include &lt;linux/i2c.h&gt;
macro_line|#include &lt;linux/i2c-algo-bit.h&gt;
DECL|function|frodo_setsda
r_static
r_void
id|frodo_setsda
(paren
r_void
op_star
id|data
comma
r_int
id|state
)paren
(brace
r_if
c_cond
(paren
id|state
)paren
id|FRODO_CPLD_I2C
op_or_assign
id|FRODO_I2C_SDA_OUT
suffix:semicolon
r_else
id|FRODO_CPLD_I2C
op_and_assign
op_complement
id|FRODO_I2C_SDA_OUT
suffix:semicolon
)brace
DECL|function|frodo_setscl
r_static
r_void
id|frodo_setscl
(paren
r_void
op_star
id|data
comma
r_int
id|state
)paren
(brace
r_if
c_cond
(paren
id|state
)paren
id|FRODO_CPLD_I2C
op_or_assign
id|FRODO_I2C_SCL_OUT
suffix:semicolon
r_else
id|FRODO_CPLD_I2C
op_and_assign
op_complement
id|FRODO_I2C_SCL_OUT
suffix:semicolon
)brace
DECL|function|frodo_getsda
r_static
r_int
id|frodo_getsda
(paren
r_void
op_star
id|data
)paren
(brace
r_return
(paren
(paren
id|FRODO_CPLD_I2C
op_amp
id|FRODO_I2C_SDA_IN
)paren
op_ne
l_int|0
)paren
suffix:semicolon
)brace
DECL|function|frodo_getscl
r_static
r_int
id|frodo_getscl
(paren
r_void
op_star
id|data
)paren
(brace
r_return
(paren
(paren
id|FRODO_CPLD_I2C
op_amp
id|FRODO_I2C_SCL_IN
)paren
op_ne
l_int|0
)paren
suffix:semicolon
)brace
DECL|variable|bit_frodo_data
r_static
r_struct
id|i2c_algo_bit_data
id|bit_frodo_data
op_assign
(brace
dot
id|setsda
op_assign
id|frodo_setsda
comma
dot
id|setscl
op_assign
id|frodo_setscl
comma
dot
id|getsda
op_assign
id|frodo_getsda
comma
dot
id|getscl
op_assign
id|frodo_getscl
comma
dot
id|udelay
op_assign
l_int|80
comma
dot
id|mdelay
op_assign
l_int|80
comma
dot
id|timeout
op_assign
l_int|100
)brace
suffix:semicolon
DECL|function|frodo_client_register
r_static
r_int
id|frodo_client_register
(paren
r_struct
id|i2c_client
op_star
id|client
)paren
(brace
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
DECL|function|frodo_client_unregister
r_static
r_int
id|frodo_client_unregister
(paren
r_struct
id|i2c_client
op_star
id|client
)paren
(brace
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
DECL|function|frodo_inc_use
r_static
r_void
id|frodo_inc_use
(paren
r_struct
id|i2c_adapter
op_star
id|adapter
)paren
(brace
id|MOD_INC_USE_COUNT
suffix:semicolon
)brace
DECL|function|frodo_dec_use
r_static
r_void
id|frodo_dec_use
(paren
r_struct
id|i2c_adapter
op_star
id|adapter
)paren
(brace
id|MOD_DEC_USE_COUNT
suffix:semicolon
)brace
DECL|variable|frodo_ops
r_static
r_struct
id|i2c_adapter
id|frodo_ops
op_assign
(brace
dot
id|name
op_assign
l_string|&quot;Frodo adapter driver&quot;
comma
dot
id|id
op_assign
id|I2C_HW_B_FRODO
comma
dot
id|algo_data
op_assign
op_amp
id|bit_frodo_data
comma
dot
id|inc_use
op_assign
id|frodo_inc_use
comma
dot
id|dec_use
op_assign
id|frodo_dec_use
comma
dot
id|client_register
op_assign
id|frodo_client_register
comma
dot
id|client_unregister
op_assign
id|frodo_client_unregister
)brace
suffix:semicolon
DECL|function|i2c_frodo_init
r_static
r_int
id|__init
id|i2c_frodo_init
(paren
r_void
)paren
(brace
r_return
(paren
id|i2c_bit_add_bus
(paren
op_amp
id|frodo_ops
)paren
)paren
suffix:semicolon
)brace
id|EXPORT_NO_SYMBOLS
suffix:semicolon
DECL|function|i2c_frodo_exit
r_static
r_void
id|__exit
id|i2c_frodo_exit
(paren
r_void
)paren
(brace
id|i2c_bit_del_bus
(paren
op_amp
id|frodo_ops
)paren
suffix:semicolon
)brace
id|MODULE_AUTHOR
(paren
l_string|&quot;Abraham van der Merwe &lt;abraham@2d3d.co.za&gt;&quot;
)paren
suffix:semicolon
id|MODULE_DESCRIPTION
(paren
l_string|&quot;I2C-Bus adapter routines for Frodo&quot;
)paren
suffix:semicolon
macro_line|#ifdef MODULE_LICENSE
id|MODULE_LICENSE
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
macro_line|#endif&t;/* #ifdef MODULE_LICENSE */
id|EXPORT_NO_SYMBOLS
suffix:semicolon
DECL|variable|i2c_frodo_init
id|module_init
(paren
id|i2c_frodo_init
)paren
suffix:semicolon
DECL|variable|i2c_frodo_exit
id|module_exit
(paren
id|i2c_frodo_exit
)paren
suffix:semicolon
eof
