multiline_comment|/*&n; * support.c - provides standard pnp functions for the use of pnp protocol drivers,&n; *&n; * Copyright 2003 Adam Belay &lt;ambx1@neo.rr.com&gt;&n; *&n; * Resource parsing functions are based on those in the linux pnpbios driver.&n; * Copyright Christian Schmidt, Tom Lees, David Hinds, Alan Cox, Thomas Hood,&n; * Brian Gerst and Adam Belay.&n; */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/ctype.h&gt;
macro_line|#ifdef CONFIG_PNP_DEBUG
DECL|macro|DEBUG
mdefine_line|#define DEBUG
macro_line|#else
DECL|macro|DEBUG
macro_line|#undef DEBUG
macro_line|#endif
macro_line|#include &lt;linux/pnp.h&gt;
macro_line|#include &quot;base.h&quot;
DECL|macro|SMALL_TAG_PNPVERNO
mdefine_line|#define SMALL_TAG_PNPVERNO&t;&t;0x01
DECL|macro|SMALL_TAG_LOGDEVID
mdefine_line|#define SMALL_TAG_LOGDEVID&t;&t;0x02
DECL|macro|SMALL_TAG_COMPATDEVID
mdefine_line|#define SMALL_TAG_COMPATDEVID&t;&t;0x03
DECL|macro|SMALL_TAG_IRQ
mdefine_line|#define SMALL_TAG_IRQ&t;&t;&t;0x04
DECL|macro|SMALL_TAG_DMA
mdefine_line|#define SMALL_TAG_DMA&t;&t;&t;0x05
DECL|macro|SMALL_TAG_STARTDEP
mdefine_line|#define SMALL_TAG_STARTDEP&t;&t;0x06
DECL|macro|SMALL_TAG_ENDDEP
mdefine_line|#define SMALL_TAG_ENDDEP&t;&t;0x07
DECL|macro|SMALL_TAG_PORT
mdefine_line|#define SMALL_TAG_PORT&t;&t;&t;0x08
DECL|macro|SMALL_TAG_FIXEDPORT
mdefine_line|#define SMALL_TAG_FIXEDPORT&t;&t;0x09
DECL|macro|SMALL_TAG_VENDOR
mdefine_line|#define SMALL_TAG_VENDOR&t;&t;0x0e
DECL|macro|SMALL_TAG_END
mdefine_line|#define SMALL_TAG_END&t;&t;&t;0x0f
DECL|macro|LARGE_TAG
mdefine_line|#define LARGE_TAG&t;&t;&t;0x80
DECL|macro|LARGE_TAG_MEM
mdefine_line|#define LARGE_TAG_MEM&t;&t;&t;0x01
DECL|macro|LARGE_TAG_ANSISTR
mdefine_line|#define LARGE_TAG_ANSISTR&t;&t;0x02
DECL|macro|LARGE_TAG_UNICODESTR
mdefine_line|#define LARGE_TAG_UNICODESTR&t;&t;0x03
DECL|macro|LARGE_TAG_VENDOR
mdefine_line|#define LARGE_TAG_VENDOR&t;&t;0x04
DECL|macro|LARGE_TAG_MEM32
mdefine_line|#define LARGE_TAG_MEM32&t;&t;&t;0x05
DECL|macro|LARGE_TAG_FIXEDMEM32
mdefine_line|#define LARGE_TAG_FIXEDMEM32&t;&t;0x06
multiline_comment|/**&n; * pnp_is_active - Determines if a device is active based on its current resources&n; * @dev: pointer to the desired PnP device&n; *&n; */
DECL|function|pnp_is_active
r_int
id|pnp_is_active
c_func
(paren
r_struct
id|pnp_dev
op_star
id|dev
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|pnp_port_start
c_func
(paren
id|dev
comma
l_int|0
)paren
op_logical_and
id|pnp_port_len
c_func
(paren
id|dev
comma
l_int|0
)paren
op_le
l_int|1
op_logical_and
op_logical_neg
id|pnp_mem_start
c_func
(paren
id|dev
comma
l_int|0
)paren
op_logical_and
id|pnp_mem_len
c_func
(paren
id|dev
comma
l_int|0
)paren
op_le
l_int|1
op_logical_and
id|pnp_irq
c_func
(paren
id|dev
comma
l_int|0
)paren
op_eq
op_minus
l_int|1
op_logical_and
id|pnp_dma
c_func
(paren
id|dev
comma
l_int|0
)paren
op_eq
op_minus
l_int|1
)paren
r_return
l_int|0
suffix:semicolon
r_else
r_return
l_int|1
suffix:semicolon
)brace
multiline_comment|/*&n; * Current resource reading functions *&n; */
DECL|function|current_irqresource
r_static
r_void
id|current_irqresource
c_func
(paren
r_struct
id|pnp_resource_table
op_star
id|res
comma
r_int
id|irq
)paren
(brace
r_int
id|i
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
(paren
id|res-&gt;irq_resource
(braket
id|i
)braket
dot
id|flags
op_amp
id|IORESOURCE_IRQ
)paren
op_logical_and
id|i
OL
id|PNP_MAX_IRQ
)paren
id|i
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|i
OL
id|PNP_MAX_IRQ
)paren
(brace
id|res-&gt;irq_resource
(braket
id|i
)braket
dot
id|start
op_assign
id|res-&gt;irq_resource
(braket
id|i
)braket
dot
id|end
op_assign
(paren
r_int
r_int
)paren
id|irq
suffix:semicolon
id|res-&gt;irq_resource
(braket
id|i
)braket
dot
id|flags
op_assign
id|IORESOURCE_IRQ
suffix:semicolon
singleline_comment|// Also clears _UNSET flag
)brace
)brace
DECL|function|current_dmaresource
r_static
r_void
id|current_dmaresource
c_func
(paren
r_struct
id|pnp_resource_table
op_star
id|res
comma
r_int
id|dma
)paren
(brace
r_int
id|i
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
(paren
id|res-&gt;dma_resource
(braket
id|i
)braket
dot
id|flags
op_amp
id|IORESOURCE_DMA
)paren
op_logical_and
id|i
OL
id|PNP_MAX_DMA
)paren
id|i
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|i
OL
id|PNP_MAX_DMA
)paren
(brace
id|res-&gt;dma_resource
(braket
id|i
)braket
dot
id|start
op_assign
id|res-&gt;dma_resource
(braket
id|i
)braket
dot
id|end
op_assign
(paren
r_int
r_int
)paren
id|dma
suffix:semicolon
id|res-&gt;dma_resource
(braket
id|i
)braket
dot
id|flags
op_assign
id|IORESOURCE_DMA
suffix:semicolon
singleline_comment|// Also clears _UNSET flag
)brace
)brace
DECL|function|current_ioresource
r_static
r_void
id|current_ioresource
c_func
(paren
r_struct
id|pnp_resource_table
op_star
id|res
comma
r_int
id|io
comma
r_int
id|len
)paren
(brace
r_int
id|i
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
(paren
id|res-&gt;port_resource
(braket
id|i
)braket
dot
id|flags
op_amp
id|IORESOURCE_IO
)paren
op_logical_and
id|i
OL
id|PNP_MAX_PORT
)paren
id|i
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|i
OL
id|PNP_MAX_PORT
)paren
(brace
id|res-&gt;port_resource
(braket
id|i
)braket
dot
id|start
op_assign
(paren
r_int
r_int
)paren
id|io
suffix:semicolon
id|res-&gt;port_resource
(braket
id|i
)braket
dot
id|end
op_assign
(paren
r_int
r_int
)paren
(paren
id|io
op_plus
id|len
op_minus
l_int|1
)paren
suffix:semicolon
id|res-&gt;port_resource
(braket
id|i
)braket
dot
id|flags
op_assign
id|IORESOURCE_IO
suffix:semicolon
singleline_comment|// Also clears _UNSET flag
)brace
)brace
DECL|function|current_memresource
r_static
r_void
id|current_memresource
c_func
(paren
r_struct
id|pnp_resource_table
op_star
id|res
comma
r_int
id|mem
comma
r_int
id|len
)paren
(brace
r_int
id|i
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
(paren
id|res-&gt;mem_resource
(braket
id|i
)braket
dot
id|flags
op_amp
id|IORESOURCE_MEM
)paren
op_logical_and
id|i
OL
id|PNP_MAX_MEM
)paren
id|i
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|i
OL
id|PNP_MAX_MEM
)paren
(brace
id|res-&gt;mem_resource
(braket
id|i
)braket
dot
id|start
op_assign
(paren
r_int
r_int
)paren
id|mem
suffix:semicolon
id|res-&gt;mem_resource
(braket
id|i
)braket
dot
id|end
op_assign
(paren
r_int
r_int
)paren
(paren
id|mem
op_plus
id|len
op_minus
l_int|1
)paren
suffix:semicolon
id|res-&gt;mem_resource
(braket
id|i
)braket
dot
id|flags
op_assign
id|IORESOURCE_MEM
suffix:semicolon
singleline_comment|// Also clears _UNSET flag
)brace
)brace
multiline_comment|/**&n; * pnp_parse_current_resources - Extracts current resource information from a raw PnP resource structure&n; * @p: pointer to the start of the structure&n; * @end: pointer to the end of the structure&n; * @res: pointer to the resource table to record to&n; *&n; */
DECL|function|pnp_parse_current_resources
r_int
r_char
op_star
id|pnp_parse_current_resources
c_func
(paren
r_int
r_char
op_star
id|p
comma
r_int
r_char
op_star
id|end
comma
r_struct
id|pnp_resource_table
op_star
id|res
)paren
(brace
r_int
id|len
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|p
)paren
r_return
l_int|NULL
suffix:semicolon
multiline_comment|/* Blank the resource table values */
id|pnp_init_resource_table
c_func
(paren
id|res
)paren
suffix:semicolon
r_while
c_loop
(paren
(paren
r_char
op_star
)paren
id|p
OL
(paren
r_char
op_star
)paren
id|end
)paren
(brace
r_if
c_cond
(paren
id|p
(braket
l_int|0
)braket
op_amp
id|LARGE_TAG
)paren
(brace
multiline_comment|/* large tag */
id|len
op_assign
(paren
id|p
(braket
l_int|2
)braket
op_lshift
l_int|8
)paren
op_or
id|p
(braket
l_int|1
)braket
suffix:semicolon
r_switch
c_cond
(paren
id|p
(braket
l_int|0
)braket
op_amp
l_int|0x7f
)paren
(brace
r_case
id|LARGE_TAG_MEM
suffix:colon
(brace
r_int
id|io
op_assign
op_star
(paren
r_int
op_star
)paren
op_amp
id|p
(braket
l_int|4
)braket
suffix:semicolon
r_int
id|size
op_assign
op_star
(paren
r_int
op_star
)paren
op_amp
id|p
(braket
l_int|10
)braket
suffix:semicolon
r_if
c_cond
(paren
id|len
op_ne
l_int|9
)paren
r_goto
id|lrg_err
suffix:semicolon
id|current_memresource
c_func
(paren
id|res
comma
id|io
comma
id|size
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|LARGE_TAG_ANSISTR
suffix:colon
(brace
multiline_comment|/* ignore this for now */
r_break
suffix:semicolon
)brace
r_case
id|LARGE_TAG_VENDOR
suffix:colon
(brace
multiline_comment|/* do nothing */
r_break
suffix:semicolon
)brace
r_case
id|LARGE_TAG_MEM32
suffix:colon
(brace
r_int
id|io
op_assign
op_star
(paren
r_int
op_star
)paren
op_amp
id|p
(braket
l_int|4
)braket
suffix:semicolon
r_int
id|size
op_assign
op_star
(paren
r_int
op_star
)paren
op_amp
id|p
(braket
l_int|16
)braket
suffix:semicolon
r_if
c_cond
(paren
id|len
op_ne
l_int|17
)paren
r_goto
id|lrg_err
suffix:semicolon
id|current_memresource
c_func
(paren
id|res
comma
id|io
comma
id|size
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|LARGE_TAG_FIXEDMEM32
suffix:colon
(brace
r_int
id|io
op_assign
op_star
(paren
r_int
op_star
)paren
op_amp
id|p
(braket
l_int|4
)braket
suffix:semicolon
r_int
id|size
op_assign
op_star
(paren
r_int
op_star
)paren
op_amp
id|p
(braket
l_int|8
)braket
suffix:semicolon
r_if
c_cond
(paren
id|len
op_ne
l_int|9
)paren
r_goto
id|lrg_err
suffix:semicolon
id|current_memresource
c_func
(paren
id|res
comma
id|io
comma
id|size
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_default
suffix:colon
(brace
)brace
multiline_comment|/* an unkown tag */
(brace
id|lrg_err
suffix:colon
id|pnp_warn
c_func
(paren
l_string|&quot;parser: Unknown large tag &squot;0x%x&squot;.&quot;
comma
id|p
(braket
l_int|0
)braket
op_amp
l_int|0x7f
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
multiline_comment|/* switch */
id|p
op_add_assign
id|len
op_plus
l_int|3
suffix:semicolon
r_continue
suffix:semicolon
)brace
multiline_comment|/* end large tag */
multiline_comment|/* small tag */
id|len
op_assign
id|p
(braket
l_int|0
)braket
op_amp
l_int|0x07
suffix:semicolon
r_switch
c_cond
(paren
(paren
id|p
(braket
l_int|0
)braket
op_rshift
l_int|3
)paren
op_amp
l_int|0x0f
)paren
(brace
r_case
id|SMALL_TAG_IRQ
suffix:colon
(brace
r_int
id|i
comma
id|mask
comma
id|irq
op_assign
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|len
template_param
l_int|3
)paren
r_goto
id|sm_err
suffix:semicolon
id|mask
op_assign
id|p
(braket
l_int|1
)braket
op_plus
id|p
(braket
l_int|2
)braket
op_star
l_int|256
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|16
suffix:semicolon
id|i
op_increment
comma
id|mask
op_assign
id|mask
op_rshift
l_int|1
)paren
r_if
c_cond
(paren
id|mask
op_amp
l_int|0x01
)paren
(brace
id|irq
op_assign
id|i
suffix:semicolon
)brace
id|current_irqresource
c_func
(paren
id|res
comma
id|irq
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|SMALL_TAG_DMA
suffix:colon
(brace
r_int
id|i
comma
id|mask
comma
id|dma
op_assign
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|len
op_ne
l_int|2
)paren
r_goto
id|sm_err
suffix:semicolon
id|mask
op_assign
id|p
(braket
l_int|1
)braket
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|8
suffix:semicolon
id|i
op_increment
comma
id|mask
op_assign
id|mask
op_rshift
l_int|1
)paren
r_if
c_cond
(paren
id|mask
op_amp
l_int|0x01
)paren
(brace
id|dma
op_assign
id|i
suffix:semicolon
)brace
id|current_dmaresource
c_func
(paren
id|res
comma
id|dma
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|SMALL_TAG_PORT
suffix:colon
(brace
r_int
id|io
op_assign
id|p
(braket
l_int|2
)braket
op_plus
id|p
(braket
l_int|3
)braket
op_star
l_int|256
suffix:semicolon
r_int
id|size
op_assign
id|p
(braket
l_int|7
)braket
suffix:semicolon
r_if
c_cond
(paren
id|len
op_ne
l_int|7
)paren
r_goto
id|sm_err
suffix:semicolon
id|current_ioresource
c_func
(paren
id|res
comma
id|io
comma
id|size
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|SMALL_TAG_VENDOR
suffix:colon
(brace
multiline_comment|/* do nothing */
r_break
suffix:semicolon
)brace
r_case
id|SMALL_TAG_FIXEDPORT
suffix:colon
(brace
r_int
id|io
op_assign
id|p
(braket
l_int|1
)braket
op_plus
id|p
(braket
l_int|2
)braket
op_star
l_int|256
suffix:semicolon
r_int
id|size
op_assign
id|p
(braket
l_int|3
)braket
suffix:semicolon
r_if
c_cond
(paren
id|len
op_ne
l_int|3
)paren
r_goto
id|sm_err
suffix:semicolon
id|current_ioresource
c_func
(paren
id|res
comma
id|io
comma
id|size
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|SMALL_TAG_END
suffix:colon
(brace
id|p
op_assign
id|p
op_plus
l_int|2
suffix:semicolon
r_return
(paren
r_int
r_char
op_star
)paren
id|p
suffix:semicolon
r_break
suffix:semicolon
)brace
r_default
suffix:colon
(brace
)brace
multiline_comment|/* an unkown tag */
(brace
id|sm_err
suffix:colon
id|pnp_warn
c_func
(paren
l_string|&quot;parser: Unknown small tag &squot;0x%x&squot;.&quot;
comma
id|p
(braket
l_int|0
)braket
op_rshift
l_int|3
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
id|p
op_add_assign
id|len
op_plus
l_int|1
suffix:semicolon
)brace
id|pnp_err
c_func
(paren
l_string|&quot;parser: Resource structure does not contain an end tag.&quot;
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
multiline_comment|/*&n; * Possible resource reading functions *&n; */
DECL|function|possible_mem
r_static
r_void
id|possible_mem
c_func
(paren
r_int
r_char
op_star
id|p
comma
r_int
id|size
comma
r_struct
id|pnp_option
op_star
id|option
)paren
(brace
r_struct
id|pnp_mem
op_star
id|mem
suffix:semicolon
id|mem
op_assign
id|pnp_alloc
c_func
(paren
r_sizeof
(paren
r_struct
id|pnp_mem
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|mem
)paren
r_return
suffix:semicolon
id|mem-&gt;min
op_assign
(paren
(paren
id|p
(braket
l_int|5
)braket
op_lshift
l_int|8
)paren
op_or
id|p
(braket
l_int|4
)braket
)paren
op_lshift
l_int|8
suffix:semicolon
id|mem-&gt;max
op_assign
(paren
(paren
id|p
(braket
l_int|7
)braket
op_lshift
l_int|8
)paren
op_or
id|p
(braket
l_int|6
)braket
)paren
op_lshift
l_int|8
suffix:semicolon
id|mem-&gt;align
op_assign
(paren
id|p
(braket
l_int|9
)braket
op_lshift
l_int|8
)paren
op_or
id|p
(braket
l_int|8
)braket
suffix:semicolon
id|mem-&gt;size
op_assign
(paren
(paren
id|p
(braket
l_int|11
)braket
op_lshift
l_int|8
)paren
op_or
id|p
(braket
l_int|10
)braket
)paren
op_lshift
l_int|8
suffix:semicolon
id|mem-&gt;flags
op_assign
id|p
(braket
l_int|3
)braket
suffix:semicolon
id|pnp_register_mem_resource
c_func
(paren
id|option
comma
id|mem
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
DECL|function|possible_mem32
r_static
r_void
id|possible_mem32
c_func
(paren
r_int
r_char
op_star
id|p
comma
r_int
id|size
comma
r_struct
id|pnp_option
op_star
id|option
)paren
(brace
r_struct
id|pnp_mem
op_star
id|mem
suffix:semicolon
id|mem
op_assign
id|pnp_alloc
c_func
(paren
r_sizeof
(paren
r_struct
id|pnp_mem
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|mem
)paren
r_return
suffix:semicolon
id|mem-&gt;min
op_assign
(paren
id|p
(braket
l_int|7
)braket
op_lshift
l_int|24
)paren
op_or
(paren
id|p
(braket
l_int|6
)braket
op_lshift
l_int|16
)paren
op_or
(paren
id|p
(braket
l_int|5
)braket
op_lshift
l_int|8
)paren
op_or
id|p
(braket
l_int|4
)braket
suffix:semicolon
id|mem-&gt;max
op_assign
(paren
id|p
(braket
l_int|11
)braket
op_lshift
l_int|24
)paren
op_or
(paren
id|p
(braket
l_int|10
)braket
op_lshift
l_int|16
)paren
op_or
(paren
id|p
(braket
l_int|9
)braket
op_lshift
l_int|8
)paren
op_or
id|p
(braket
l_int|8
)braket
suffix:semicolon
id|mem-&gt;align
op_assign
(paren
id|p
(braket
l_int|15
)braket
op_lshift
l_int|24
)paren
op_or
(paren
id|p
(braket
l_int|14
)braket
op_lshift
l_int|16
)paren
op_or
(paren
id|p
(braket
l_int|13
)braket
op_lshift
l_int|8
)paren
op_or
id|p
(braket
l_int|12
)braket
suffix:semicolon
id|mem-&gt;size
op_assign
(paren
id|p
(braket
l_int|19
)braket
op_lshift
l_int|24
)paren
op_or
(paren
id|p
(braket
l_int|18
)braket
op_lshift
l_int|16
)paren
op_or
(paren
id|p
(braket
l_int|17
)braket
op_lshift
l_int|8
)paren
op_or
id|p
(braket
l_int|16
)braket
suffix:semicolon
id|mem-&gt;flags
op_assign
id|p
(braket
l_int|3
)braket
suffix:semicolon
id|pnp_register_mem_resource
c_func
(paren
id|option
comma
id|mem
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
DECL|function|possible_fixed_mem32
r_static
r_void
id|possible_fixed_mem32
c_func
(paren
r_int
r_char
op_star
id|p
comma
r_int
id|size
comma
r_struct
id|pnp_option
op_star
id|option
)paren
(brace
r_struct
id|pnp_mem
op_star
id|mem
suffix:semicolon
id|mem
op_assign
id|pnp_alloc
c_func
(paren
r_sizeof
(paren
r_struct
id|pnp_mem
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|mem
)paren
r_return
suffix:semicolon
id|mem-&gt;min
op_assign
id|mem-&gt;max
op_assign
(paren
id|p
(braket
l_int|7
)braket
op_lshift
l_int|24
)paren
op_or
(paren
id|p
(braket
l_int|6
)braket
op_lshift
l_int|16
)paren
op_or
(paren
id|p
(braket
l_int|5
)braket
op_lshift
l_int|8
)paren
op_or
id|p
(braket
l_int|4
)braket
suffix:semicolon
id|mem-&gt;size
op_assign
(paren
id|p
(braket
l_int|11
)braket
op_lshift
l_int|24
)paren
op_or
(paren
id|p
(braket
l_int|10
)braket
op_lshift
l_int|16
)paren
op_or
(paren
id|p
(braket
l_int|9
)braket
op_lshift
l_int|8
)paren
op_or
id|p
(braket
l_int|8
)braket
suffix:semicolon
id|mem-&gt;align
op_assign
l_int|0
suffix:semicolon
id|mem-&gt;flags
op_assign
id|p
(braket
l_int|3
)braket
suffix:semicolon
id|pnp_register_mem_resource
c_func
(paren
id|option
comma
id|mem
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
DECL|function|possible_irq
r_static
r_void
id|possible_irq
c_func
(paren
r_int
r_char
op_star
id|p
comma
r_int
id|size
comma
r_struct
id|pnp_option
op_star
id|option
)paren
(brace
r_struct
id|pnp_irq
op_star
id|irq
suffix:semicolon
id|irq
op_assign
id|pnp_alloc
c_func
(paren
r_sizeof
(paren
r_struct
id|pnp_irq
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|irq
)paren
r_return
suffix:semicolon
id|irq-&gt;map
op_assign
(paren
id|p
(braket
l_int|2
)braket
op_lshift
l_int|8
)paren
op_or
id|p
(braket
l_int|1
)braket
suffix:semicolon
r_if
c_cond
(paren
id|size
OG
l_int|2
)paren
id|irq-&gt;flags
op_assign
id|p
(braket
l_int|3
)braket
suffix:semicolon
r_else
id|irq-&gt;flags
op_assign
id|IORESOURCE_IRQ_HIGHEDGE
suffix:semicolon
id|pnp_register_irq_resource
c_func
(paren
id|option
comma
id|irq
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
DECL|function|possible_dma
r_static
r_void
id|possible_dma
c_func
(paren
r_int
r_char
op_star
id|p
comma
r_int
id|size
comma
r_struct
id|pnp_option
op_star
id|option
)paren
(brace
r_struct
id|pnp_dma
op_star
id|dma
suffix:semicolon
id|dma
op_assign
id|pnp_alloc
c_func
(paren
r_sizeof
(paren
r_struct
id|pnp_dma
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dma
)paren
r_return
suffix:semicolon
id|dma-&gt;map
op_assign
id|p
(braket
l_int|1
)braket
suffix:semicolon
id|dma-&gt;flags
op_assign
id|p
(braket
l_int|2
)braket
suffix:semicolon
id|pnp_register_dma_resource
c_func
(paren
id|option
comma
id|dma
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
DECL|function|possible_port
r_static
r_void
id|possible_port
c_func
(paren
r_int
r_char
op_star
id|p
comma
r_int
id|size
comma
r_struct
id|pnp_option
op_star
id|option
)paren
(brace
r_struct
id|pnp_port
op_star
id|port
suffix:semicolon
id|port
op_assign
id|pnp_alloc
c_func
(paren
r_sizeof
(paren
r_struct
id|pnp_port
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|port
)paren
r_return
suffix:semicolon
id|port-&gt;min
op_assign
(paren
id|p
(braket
l_int|3
)braket
op_lshift
l_int|8
)paren
op_or
id|p
(braket
l_int|2
)braket
suffix:semicolon
id|port-&gt;max
op_assign
(paren
id|p
(braket
l_int|5
)braket
op_lshift
l_int|8
)paren
op_or
id|p
(braket
l_int|4
)braket
suffix:semicolon
id|port-&gt;align
op_assign
id|p
(braket
l_int|6
)braket
suffix:semicolon
id|port-&gt;size
op_assign
id|p
(braket
l_int|7
)braket
suffix:semicolon
id|port-&gt;flags
op_assign
id|p
(braket
l_int|1
)braket
ques
c_cond
id|PNP_PORT_FLAG_16BITADDR
suffix:colon
l_int|0
suffix:semicolon
id|pnp_register_port_resource
c_func
(paren
id|option
comma
id|port
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
DECL|function|possible_fixed_port
r_static
r_void
id|possible_fixed_port
c_func
(paren
r_int
r_char
op_star
id|p
comma
r_int
id|size
comma
r_struct
id|pnp_option
op_star
id|option
)paren
(brace
r_struct
id|pnp_port
op_star
id|port
suffix:semicolon
id|port
op_assign
id|pnp_alloc
c_func
(paren
r_sizeof
(paren
r_struct
id|pnp_port
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|port
)paren
r_return
suffix:semicolon
id|port-&gt;min
op_assign
id|port-&gt;max
op_assign
(paren
id|p
(braket
l_int|2
)braket
op_lshift
l_int|8
)paren
op_or
id|p
(braket
l_int|1
)braket
suffix:semicolon
id|port-&gt;size
op_assign
id|p
(braket
l_int|3
)braket
suffix:semicolon
id|port-&gt;align
op_assign
l_int|0
suffix:semicolon
id|port-&gt;flags
op_assign
id|PNP_PORT_FLAG_FIXED
suffix:semicolon
id|pnp_register_port_resource
c_func
(paren
id|option
comma
id|port
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
multiline_comment|/**&n; * pnp_parse_possible_resources - Extracts possible resource information from a raw PnP resource structure&n; * @p: pointer to the start of the structure&n; * @end: pointer to the end of the structure&n; * @dev: pointer to the desired PnP device&n; *&n; */
DECL|function|pnp_parse_possible_resources
r_int
r_char
op_star
id|pnp_parse_possible_resources
c_func
(paren
r_int
r_char
op_star
id|p
comma
r_int
r_char
op_star
id|end
comma
r_struct
id|pnp_dev
op_star
id|dev
)paren
(brace
r_int
id|len
comma
id|priority
op_assign
l_int|0
suffix:semicolon
r_struct
id|pnp_option
op_star
id|option
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|p
)paren
r_return
l_int|NULL
suffix:semicolon
id|option
op_assign
id|pnp_register_independent_option
c_func
(paren
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|option
)paren
r_return
l_int|NULL
suffix:semicolon
r_while
c_loop
(paren
(paren
r_char
op_star
)paren
id|p
OL
(paren
r_char
op_star
)paren
id|end
)paren
(brace
r_if
c_cond
(paren
id|p
(braket
l_int|0
)braket
op_amp
id|LARGE_TAG
)paren
(brace
multiline_comment|/* large tag */
id|len
op_assign
(paren
id|p
(braket
l_int|2
)braket
op_lshift
l_int|8
)paren
op_or
id|p
(braket
l_int|1
)braket
suffix:semicolon
r_switch
c_cond
(paren
id|p
(braket
l_int|0
)braket
op_amp
l_int|0x7f
)paren
(brace
r_case
id|LARGE_TAG_MEM
suffix:colon
(brace
r_if
c_cond
(paren
id|len
op_ne
l_int|9
)paren
r_goto
id|lrg_err
suffix:semicolon
id|possible_mem
c_func
(paren
id|p
comma
id|len
comma
id|option
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|LARGE_TAG_MEM32
suffix:colon
(brace
r_if
c_cond
(paren
id|len
op_ne
l_int|17
)paren
r_goto
id|lrg_err
suffix:semicolon
id|possible_mem32
c_func
(paren
id|p
comma
id|len
comma
id|option
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|LARGE_TAG_FIXEDMEM32
suffix:colon
(brace
r_if
c_cond
(paren
id|len
op_ne
l_int|9
)paren
r_goto
id|lrg_err
suffix:semicolon
id|possible_fixed_mem32
c_func
(paren
id|p
comma
id|len
comma
id|option
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_default
suffix:colon
(brace
)brace
multiline_comment|/* an unkown tag */
(brace
id|lrg_err
suffix:colon
id|pnp_warn
c_func
(paren
l_string|&quot;parser: Unknown large tag &squot;0x%x&squot;.&quot;
comma
id|p
(braket
l_int|0
)braket
op_amp
l_int|0x7f
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
multiline_comment|/* switch */
id|p
op_add_assign
id|len
op_plus
l_int|3
suffix:semicolon
r_continue
suffix:semicolon
)brace
multiline_comment|/* end large tag */
multiline_comment|/* small tag */
id|len
op_assign
id|p
(braket
l_int|0
)braket
op_amp
l_int|0x07
suffix:semicolon
r_switch
c_cond
(paren
(paren
id|p
(braket
l_int|0
)braket
op_rshift
l_int|3
)paren
op_amp
l_int|0x0f
)paren
(brace
r_case
id|SMALL_TAG_IRQ
suffix:colon
(brace
r_if
c_cond
(paren
id|len
template_param
l_int|3
)paren
r_goto
id|sm_err
suffix:semicolon
id|possible_irq
c_func
(paren
id|p
comma
id|len
comma
id|option
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|SMALL_TAG_DMA
suffix:colon
(brace
r_if
c_cond
(paren
id|len
op_ne
l_int|2
)paren
r_goto
id|sm_err
suffix:semicolon
id|possible_dma
c_func
(paren
id|p
comma
id|len
comma
id|option
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|SMALL_TAG_STARTDEP
suffix:colon
(brace
r_if
c_cond
(paren
id|len
OG
l_int|1
)paren
r_goto
id|sm_err
suffix:semicolon
id|priority
op_assign
l_int|0x100
op_or
id|PNP_RES_PRIORITY_ACCEPTABLE
suffix:semicolon
r_if
c_cond
(paren
id|len
OG
l_int|0
)paren
id|priority
op_assign
l_int|0x100
op_or
id|p
(braket
l_int|1
)braket
suffix:semicolon
id|option
op_assign
id|pnp_register_dependent_option
c_func
(paren
id|dev
comma
id|priority
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|option
)paren
r_return
l_int|NULL
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|SMALL_TAG_ENDDEP
suffix:colon
(brace
r_if
c_cond
(paren
id|len
op_ne
l_int|0
)paren
r_goto
id|sm_err
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|SMALL_TAG_PORT
suffix:colon
(brace
r_if
c_cond
(paren
id|len
op_ne
l_int|7
)paren
r_goto
id|sm_err
suffix:semicolon
id|possible_port
c_func
(paren
id|p
comma
id|len
comma
id|option
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|SMALL_TAG_FIXEDPORT
suffix:colon
(brace
r_if
c_cond
(paren
id|len
op_ne
l_int|3
)paren
r_goto
id|sm_err
suffix:semicolon
id|possible_fixed_port
c_func
(paren
id|p
comma
id|len
comma
id|option
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|SMALL_TAG_END
suffix:colon
(brace
id|p
op_assign
id|p
op_plus
l_int|2
suffix:semicolon
r_return
(paren
r_int
r_char
op_star
)paren
id|p
suffix:semicolon
r_break
suffix:semicolon
)brace
r_default
suffix:colon
(brace
)brace
multiline_comment|/* an unkown tag */
(brace
id|sm_err
suffix:colon
id|pnp_warn
c_func
(paren
l_string|&quot;parser: Unknown small tag &squot;0x%x&squot;.&quot;
comma
id|p
(braket
l_int|0
)braket
op_rshift
l_int|3
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
id|p
op_add_assign
id|len
op_plus
l_int|1
suffix:semicolon
)brace
id|pnp_err
c_func
(paren
l_string|&quot;parser: Resource structure does not contain an end tag.&quot;
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
multiline_comment|/*&n; * Resource Writing functions&n; */
DECL|function|write_mem
r_static
r_void
id|write_mem
c_func
(paren
r_int
r_char
op_star
id|p
comma
r_struct
id|resource
op_star
id|res
)paren
(brace
r_int
r_int
id|base
op_assign
id|res-&gt;start
suffix:semicolon
r_int
r_int
id|len
op_assign
id|res-&gt;end
op_minus
id|res-&gt;start
op_plus
l_int|1
suffix:semicolon
id|p
(braket
l_int|4
)braket
op_assign
(paren
id|base
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
suffix:semicolon
id|p
(braket
l_int|5
)braket
op_assign
(paren
(paren
id|base
op_rshift
l_int|8
)paren
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
suffix:semicolon
id|p
(braket
l_int|6
)braket
op_assign
(paren
id|base
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
suffix:semicolon
id|p
(braket
l_int|7
)braket
op_assign
(paren
(paren
id|base
op_rshift
l_int|8
)paren
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
suffix:semicolon
id|p
(braket
l_int|10
)braket
op_assign
(paren
id|len
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
suffix:semicolon
id|p
(braket
l_int|11
)braket
op_assign
(paren
(paren
id|len
op_rshift
l_int|8
)paren
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
suffix:semicolon
r_return
suffix:semicolon
)brace
DECL|function|write_mem32
r_static
r_void
id|write_mem32
c_func
(paren
r_int
r_char
op_star
id|p
comma
r_struct
id|resource
op_star
id|res
)paren
(brace
r_int
r_int
id|base
op_assign
id|res-&gt;start
suffix:semicolon
r_int
r_int
id|len
op_assign
id|res-&gt;end
op_minus
id|res-&gt;start
op_plus
l_int|1
suffix:semicolon
id|p
(braket
l_int|4
)braket
op_assign
id|base
op_amp
l_int|0xff
suffix:semicolon
id|p
(braket
l_int|5
)braket
op_assign
(paren
id|base
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
suffix:semicolon
id|p
(braket
l_int|6
)braket
op_assign
(paren
id|base
op_rshift
l_int|16
)paren
op_amp
l_int|0xff
suffix:semicolon
id|p
(braket
l_int|7
)braket
op_assign
(paren
id|base
op_rshift
l_int|24
)paren
op_amp
l_int|0xff
suffix:semicolon
id|p
(braket
l_int|8
)braket
op_assign
id|base
op_amp
l_int|0xff
suffix:semicolon
id|p
(braket
l_int|9
)braket
op_assign
(paren
id|base
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
suffix:semicolon
id|p
(braket
l_int|10
)braket
op_assign
(paren
id|base
op_rshift
l_int|16
)paren
op_amp
l_int|0xff
suffix:semicolon
id|p
(braket
l_int|11
)braket
op_assign
(paren
id|base
op_rshift
l_int|24
)paren
op_amp
l_int|0xff
suffix:semicolon
id|p
(braket
l_int|16
)braket
op_assign
id|len
op_amp
l_int|0xff
suffix:semicolon
id|p
(braket
l_int|17
)braket
op_assign
(paren
id|len
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
suffix:semicolon
id|p
(braket
l_int|18
)braket
op_assign
(paren
id|len
op_rshift
l_int|16
)paren
op_amp
l_int|0xff
suffix:semicolon
id|p
(braket
l_int|19
)braket
op_assign
(paren
id|len
op_rshift
l_int|24
)paren
op_amp
l_int|0xff
suffix:semicolon
r_return
suffix:semicolon
)brace
DECL|function|write_fixed_mem32
r_static
r_void
id|write_fixed_mem32
c_func
(paren
r_int
r_char
op_star
id|p
comma
r_struct
id|resource
op_star
id|res
)paren
(brace
r_int
r_int
id|base
op_assign
id|res-&gt;start
suffix:semicolon
r_int
r_int
id|len
op_assign
id|res-&gt;end
op_minus
id|res-&gt;start
op_plus
l_int|1
suffix:semicolon
id|p
(braket
l_int|4
)braket
op_assign
id|base
op_amp
l_int|0xff
suffix:semicolon
id|p
(braket
l_int|5
)braket
op_assign
(paren
id|base
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
suffix:semicolon
id|p
(braket
l_int|6
)braket
op_assign
(paren
id|base
op_rshift
l_int|16
)paren
op_amp
l_int|0xff
suffix:semicolon
id|p
(braket
l_int|7
)braket
op_assign
(paren
id|base
op_rshift
l_int|24
)paren
op_amp
l_int|0xff
suffix:semicolon
id|p
(braket
l_int|8
)braket
op_assign
id|len
op_amp
l_int|0xff
suffix:semicolon
id|p
(braket
l_int|9
)braket
op_assign
(paren
id|len
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
suffix:semicolon
id|p
(braket
l_int|10
)braket
op_assign
(paren
id|len
op_rshift
l_int|16
)paren
op_amp
l_int|0xff
suffix:semicolon
id|p
(braket
l_int|11
)braket
op_assign
(paren
id|len
op_rshift
l_int|24
)paren
op_amp
l_int|0xff
suffix:semicolon
r_return
suffix:semicolon
)brace
DECL|function|write_irq
r_static
r_void
id|write_irq
c_func
(paren
r_int
r_char
op_star
id|p
comma
r_struct
id|resource
op_star
id|res
)paren
(brace
r_int
r_int
id|map
op_assign
l_int|0
suffix:semicolon
id|map
op_assign
l_int|1
op_lshift
id|res-&gt;start
suffix:semicolon
id|p
(braket
l_int|1
)braket
op_assign
id|map
op_amp
l_int|0xff
suffix:semicolon
id|p
(braket
l_int|2
)braket
op_assign
(paren
id|map
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
suffix:semicolon
r_return
suffix:semicolon
)brace
DECL|function|write_dma
r_static
r_void
id|write_dma
c_func
(paren
r_int
r_char
op_star
id|p
comma
r_struct
id|resource
op_star
id|res
)paren
(brace
r_int
r_int
id|map
op_assign
l_int|0
suffix:semicolon
id|map
op_assign
l_int|1
op_lshift
id|res-&gt;start
suffix:semicolon
id|p
(braket
l_int|1
)braket
op_assign
id|map
op_amp
l_int|0xff
suffix:semicolon
r_return
suffix:semicolon
)brace
DECL|function|write_port
r_static
r_void
id|write_port
c_func
(paren
r_int
r_char
op_star
id|p
comma
r_struct
id|resource
op_star
id|res
)paren
(brace
r_int
r_int
id|base
op_assign
id|res-&gt;start
suffix:semicolon
r_int
r_int
id|len
op_assign
id|res-&gt;end
op_minus
id|res-&gt;start
op_plus
l_int|1
suffix:semicolon
id|p
(braket
l_int|2
)braket
op_assign
id|base
op_amp
l_int|0xff
suffix:semicolon
id|p
(braket
l_int|3
)braket
op_assign
(paren
id|base
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
suffix:semicolon
id|p
(braket
l_int|4
)braket
op_assign
id|base
op_amp
l_int|0xff
suffix:semicolon
id|p
(braket
l_int|5
)braket
op_assign
(paren
id|base
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
suffix:semicolon
id|p
(braket
l_int|7
)braket
op_assign
id|len
op_amp
l_int|0xff
suffix:semicolon
r_return
suffix:semicolon
)brace
DECL|function|write_fixed_port
r_static
r_void
id|write_fixed_port
c_func
(paren
r_int
r_char
op_star
id|p
comma
r_struct
id|resource
op_star
id|res
)paren
(brace
r_int
r_int
id|base
op_assign
id|res-&gt;start
suffix:semicolon
r_int
r_int
id|len
op_assign
id|res-&gt;end
op_minus
id|res-&gt;start
op_plus
l_int|1
suffix:semicolon
id|p
(braket
l_int|1
)braket
op_assign
id|base
op_amp
l_int|0xff
suffix:semicolon
id|p
(braket
l_int|2
)braket
op_assign
(paren
id|base
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
suffix:semicolon
id|p
(braket
l_int|3
)braket
op_assign
id|len
op_amp
l_int|0xff
suffix:semicolon
r_return
suffix:semicolon
)brace
multiline_comment|/**&n; * pnp_write_resources - Writes resource information to a raw PnP resource structure&n; * @p: pointer to the start of the structure&n; * @end: pointer to the end of the structure&n; * @res: pointer to a resource table containing the resources to set&n; *&n; */
DECL|function|pnp_write_resources
r_int
r_char
op_star
id|pnp_write_resources
c_func
(paren
r_int
r_char
op_star
id|p
comma
r_int
r_char
op_star
id|end
comma
r_struct
id|pnp_resource_table
op_star
id|res
)paren
(brace
r_int
id|len
comma
id|port
op_assign
l_int|0
comma
id|irq
op_assign
l_int|0
comma
id|dma
op_assign
l_int|0
comma
id|mem
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|p
)paren
r_return
l_int|NULL
suffix:semicolon
r_while
c_loop
(paren
(paren
r_char
op_star
)paren
id|p
OL
(paren
r_char
op_star
)paren
id|end
)paren
(brace
r_if
c_cond
(paren
id|p
(braket
l_int|0
)braket
op_amp
id|LARGE_TAG
)paren
(brace
multiline_comment|/* large tag */
id|len
op_assign
(paren
id|p
(braket
l_int|2
)braket
op_lshift
l_int|8
)paren
op_or
id|p
(braket
l_int|1
)braket
suffix:semicolon
r_switch
c_cond
(paren
id|p
(braket
l_int|0
)braket
op_amp
l_int|0x7f
)paren
(brace
r_case
id|LARGE_TAG_MEM
suffix:colon
(brace
r_if
c_cond
(paren
id|len
op_ne
l_int|9
)paren
r_goto
id|lrg_err
suffix:semicolon
id|write_mem
c_func
(paren
id|p
comma
op_amp
id|res-&gt;mem_resource
(braket
id|mem
)braket
)paren
suffix:semicolon
id|mem
op_increment
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|LARGE_TAG_MEM32
suffix:colon
(brace
r_if
c_cond
(paren
id|len
op_ne
l_int|17
)paren
r_goto
id|lrg_err
suffix:semicolon
id|write_mem32
c_func
(paren
id|p
comma
op_amp
id|res-&gt;mem_resource
(braket
id|mem
)braket
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|LARGE_TAG_FIXEDMEM32
suffix:colon
(brace
r_if
c_cond
(paren
id|len
op_ne
l_int|9
)paren
r_goto
id|lrg_err
suffix:semicolon
id|write_fixed_mem32
c_func
(paren
id|p
comma
op_amp
id|res-&gt;mem_resource
(braket
id|mem
)braket
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_default
suffix:colon
(brace
)brace
multiline_comment|/* an unkown tag */
(brace
id|lrg_err
suffix:colon
id|pnp_warn
c_func
(paren
l_string|&quot;parser: Unknown large tag &squot;0x%x&squot;.&quot;
comma
id|p
(braket
l_int|0
)braket
op_amp
l_int|0x7f
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
multiline_comment|/* switch */
id|p
op_add_assign
id|len
op_plus
l_int|3
suffix:semicolon
r_continue
suffix:semicolon
)brace
multiline_comment|/* end large tag */
multiline_comment|/* small tag */
id|len
op_assign
id|p
(braket
l_int|0
)braket
op_amp
l_int|0x07
suffix:semicolon
r_switch
c_cond
(paren
(paren
id|p
(braket
l_int|0
)braket
op_rshift
l_int|3
)paren
op_amp
l_int|0x0f
)paren
(brace
r_case
id|SMALL_TAG_IRQ
suffix:colon
(brace
r_if
c_cond
(paren
id|len
template_param
l_int|3
)paren
r_goto
id|sm_err
suffix:semicolon
id|write_irq
c_func
(paren
id|p
comma
op_amp
id|res-&gt;irq_resource
(braket
id|irq
)braket
)paren
suffix:semicolon
id|irq
op_increment
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|SMALL_TAG_DMA
suffix:colon
(brace
r_if
c_cond
(paren
id|len
op_ne
l_int|2
)paren
r_goto
id|sm_err
suffix:semicolon
id|write_dma
c_func
(paren
id|p
comma
op_amp
id|res-&gt;dma_resource
(braket
id|dma
)braket
)paren
suffix:semicolon
id|dma
op_increment
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|SMALL_TAG_PORT
suffix:colon
(brace
r_if
c_cond
(paren
id|len
op_ne
l_int|7
)paren
r_goto
id|sm_err
suffix:semicolon
id|write_port
c_func
(paren
id|p
comma
op_amp
id|res-&gt;port_resource
(braket
id|port
)braket
)paren
suffix:semicolon
id|port
op_increment
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|SMALL_TAG_FIXEDPORT
suffix:colon
(brace
r_if
c_cond
(paren
id|len
op_ne
l_int|3
)paren
r_goto
id|sm_err
suffix:semicolon
id|write_fixed_port
c_func
(paren
id|p
comma
op_amp
id|res-&gt;port_resource
(braket
id|port
)braket
)paren
suffix:semicolon
id|port
op_increment
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|SMALL_TAG_END
suffix:colon
(brace
id|p
op_assign
id|p
op_plus
l_int|2
suffix:semicolon
r_return
(paren
r_int
r_char
op_star
)paren
id|p
suffix:semicolon
r_break
suffix:semicolon
)brace
r_default
suffix:colon
(brace
)brace
multiline_comment|/* an unkown tag */
(brace
id|sm_err
suffix:colon
id|pnp_warn
c_func
(paren
l_string|&quot;parser: Unknown small tag &squot;0x%x&squot;.&quot;
comma
id|p
(braket
l_int|0
)braket
op_rshift
l_int|3
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
id|p
op_add_assign
id|len
op_plus
l_int|1
suffix:semicolon
)brace
id|pnp_err
c_func
(paren
l_string|&quot;parser: Resource structure does not contain an end tag.&quot;
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
DECL|variable|pnp_is_active
id|EXPORT_SYMBOL
c_func
(paren
id|pnp_is_active
)paren
suffix:semicolon
DECL|variable|pnp_parse_current_resources
id|EXPORT_SYMBOL
c_func
(paren
id|pnp_parse_current_resources
)paren
suffix:semicolon
DECL|variable|pnp_parse_possible_resources
id|EXPORT_SYMBOL
c_func
(paren
id|pnp_parse_possible_resources
)paren
suffix:semicolon
DECL|variable|pnp_write_resources
id|EXPORT_SYMBOL
c_func
(paren
id|pnp_write_resources
)paren
suffix:semicolon
eof
