macro_line|#ifndef __NET_PKT_CLS_H
DECL|macro|__NET_PKT_CLS_H
mdefine_line|#define __NET_PKT_CLS_H
macro_line|#include &lt;linux/pkt_cls.h&gt;
r_struct
id|rtattr
suffix:semicolon
r_struct
id|tcmsg
suffix:semicolon
multiline_comment|/* Basic packet classifier frontend definitions. */
DECL|struct|tcf_result
r_struct
id|tcf_result
(brace
DECL|member|class
r_int
r_int
r_class
suffix:semicolon
DECL|member|classid
id|u32
id|classid
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|tcf_proto
r_struct
id|tcf_proto
(brace
multiline_comment|/* Fast access part */
DECL|member|next
r_struct
id|tcf_proto
op_star
id|next
suffix:semicolon
DECL|member|root
r_void
op_star
id|root
suffix:semicolon
DECL|member|classify
r_int
(paren
op_star
id|classify
)paren
(paren
r_struct
id|sk_buff
op_star
comma
r_struct
id|tcf_proto
op_star
comma
r_struct
id|tcf_result
op_star
)paren
suffix:semicolon
DECL|member|protocol
id|u32
id|protocol
suffix:semicolon
multiline_comment|/* All the rest */
DECL|member|prio
id|u32
id|prio
suffix:semicolon
DECL|member|classid
id|u32
id|classid
suffix:semicolon
DECL|member|q
r_struct
id|Qdisc
op_star
id|q
suffix:semicolon
DECL|member|data
r_void
op_star
id|data
suffix:semicolon
DECL|member|ops
r_struct
id|tcf_proto_ops
op_star
id|ops
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|tcf_walker
r_struct
id|tcf_walker
(brace
DECL|member|stop
r_int
id|stop
suffix:semicolon
DECL|member|skip
r_int
id|skip
suffix:semicolon
DECL|member|count
r_int
id|count
suffix:semicolon
DECL|member|fn
r_int
(paren
op_star
id|fn
)paren
(paren
r_struct
id|tcf_proto
op_star
comma
r_int
r_int
id|node
comma
r_struct
id|tcf_walker
op_star
)paren
suffix:semicolon
)brace
suffix:semicolon
r_struct
id|module
suffix:semicolon
DECL|struct|tcf_proto_ops
r_struct
id|tcf_proto_ops
(brace
DECL|member|next
r_struct
id|tcf_proto_ops
op_star
id|next
suffix:semicolon
DECL|member|kind
r_char
id|kind
(braket
id|IFNAMSIZ
)braket
suffix:semicolon
DECL|member|classify
r_int
(paren
op_star
id|classify
)paren
(paren
r_struct
id|sk_buff
op_star
comma
r_struct
id|tcf_proto
op_star
comma
r_struct
id|tcf_result
op_star
)paren
suffix:semicolon
DECL|member|init
r_int
(paren
op_star
id|init
)paren
(paren
r_struct
id|tcf_proto
op_star
)paren
suffix:semicolon
DECL|member|destroy
r_void
(paren
op_star
id|destroy
)paren
(paren
r_struct
id|tcf_proto
op_star
)paren
suffix:semicolon
DECL|member|get
r_int
r_int
(paren
op_star
id|get
)paren
(paren
r_struct
id|tcf_proto
op_star
comma
id|u32
id|handle
)paren
suffix:semicolon
DECL|member|put
r_void
(paren
op_star
id|put
)paren
(paren
r_struct
id|tcf_proto
op_star
comma
r_int
r_int
)paren
suffix:semicolon
DECL|member|change
r_int
(paren
op_star
id|change
)paren
(paren
r_struct
id|tcf_proto
op_star
comma
r_int
r_int
comma
id|u32
id|handle
comma
r_struct
id|rtattr
op_star
op_star
comma
r_int
r_int
op_star
)paren
suffix:semicolon
DECL|member|delete
r_int
(paren
op_star
r_delete
)paren
(paren
r_struct
id|tcf_proto
op_star
comma
r_int
r_int
)paren
suffix:semicolon
DECL|member|walk
r_void
(paren
op_star
id|walk
)paren
(paren
r_struct
id|tcf_proto
op_star
comma
r_struct
id|tcf_walker
op_star
id|arg
)paren
suffix:semicolon
multiline_comment|/* rtnetlink specific */
DECL|member|dump
r_int
(paren
op_star
id|dump
)paren
(paren
r_struct
id|tcf_proto
op_star
comma
r_int
r_int
comma
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|tcmsg
op_star
)paren
suffix:semicolon
DECL|member|owner
r_struct
id|module
op_star
id|owner
suffix:semicolon
)brace
suffix:semicolon
multiline_comment|/* Main classifier routine: scans classifier chain attached&n;   to this qdisc, (optionally) tests for protocol and asks&n;   specific classifiers.&n; */
DECL|function|tc_classify
r_static
r_inline
r_int
id|tc_classify
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|tcf_proto
op_star
id|tp
comma
r_struct
id|tcf_result
op_star
id|res
)paren
(brace
r_int
id|err
op_assign
l_int|0
suffix:semicolon
id|u32
id|protocol
op_assign
id|skb-&gt;protocol
suffix:semicolon
macro_line|#ifdef CONFIG_NET_CLS_ACT
r_struct
id|tcf_proto
op_star
id|otp
op_assign
id|tp
suffix:semicolon
id|reclassify
suffix:colon
macro_line|#endif
id|protocol
op_assign
id|skb-&gt;protocol
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
id|tp
suffix:semicolon
id|tp
op_assign
id|tp-&gt;next
)paren
(brace
r_if
c_cond
(paren
(paren
id|tp-&gt;protocol
op_eq
id|protocol
op_logical_or
id|tp-&gt;protocol
op_eq
id|__constant_htons
c_func
(paren
id|ETH_P_ALL
)paren
)paren
op_logical_and
(paren
id|err
op_assign
id|tp
op_member_access_from_pointer
id|classify
c_func
(paren
id|skb
comma
id|tp
comma
id|res
)paren
)paren
op_ge
l_int|0
)paren
(brace
macro_line|#ifdef CONFIG_NET_CLS_ACT
r_if
c_cond
(paren
id|TC_ACT_RECLASSIFY
op_eq
id|err
)paren
(brace
id|__u32
id|verd
op_assign
(paren
id|__u32
)paren
id|G_TC_VERD
c_func
(paren
id|skb-&gt;tc_verd
)paren
suffix:semicolon
id|tp
op_assign
id|otp
suffix:semicolon
r_if
c_cond
(paren
id|MAX_REC_LOOP
OL
id|verd
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;rule prio %d protocol %02x reclassify is buggy packet dropped&bslash;n&quot;
comma
id|tp-&gt;prio
op_amp
l_int|0xffff
comma
id|ntohs
c_func
(paren
id|tp-&gt;protocol
)paren
)paren
suffix:semicolon
r_return
id|TC_ACT_SHOT
suffix:semicolon
)brace
id|skb-&gt;tc_verd
op_assign
id|SET_TC_VERD
c_func
(paren
id|skb-&gt;tc_verd
comma
id|verd
)paren
suffix:semicolon
r_goto
id|reclassify
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|skb-&gt;tc_verd
)paren
id|skb-&gt;tc_verd
op_assign
id|SET_TC_VERD
c_func
(paren
id|skb-&gt;tc_verd
comma
l_int|0
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
macro_line|#else
r_return
id|err
suffix:semicolon
macro_line|#endif
)brace
)brace
r_return
op_minus
l_int|1
suffix:semicolon
)brace
DECL|function|tcf_destroy
r_static
r_inline
r_void
id|tcf_destroy
c_func
(paren
r_struct
id|tcf_proto
op_star
id|tp
)paren
(brace
id|tp-&gt;ops
op_member_access_from_pointer
id|destroy
c_func
(paren
id|tp
)paren
suffix:semicolon
id|module_put
c_func
(paren
id|tp-&gt;ops-&gt;owner
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|tp
)paren
suffix:semicolon
)brace
r_extern
r_int
id|register_tcf_proto_ops
c_func
(paren
r_struct
id|tcf_proto_ops
op_star
id|ops
)paren
suffix:semicolon
r_extern
r_int
id|unregister_tcf_proto_ops
c_func
(paren
r_struct
id|tcf_proto_ops
op_star
id|ops
)paren
suffix:semicolon
r_extern
r_int
id|ing_filter
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
)paren
suffix:semicolon
macro_line|#endif
eof
