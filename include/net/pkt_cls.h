macro_line|#ifndef __NET_PKT_CLS_H
DECL|macro|__NET_PKT_CLS_H
mdefine_line|#define __NET_PKT_CLS_H
macro_line|#include &lt;linux/pkt_cls.h&gt;
macro_line|#include &lt;net/sch_generic.h&gt;
multiline_comment|/* Basic packet classifier frontend definitions. */
DECL|struct|tcf_walker
r_struct
id|tcf_walker
(brace
DECL|member|stop
r_int
id|stop
suffix:semicolon
DECL|member|skip
r_int
id|skip
suffix:semicolon
DECL|member|count
r_int
id|count
suffix:semicolon
DECL|member|fn
r_int
(paren
op_star
id|fn
)paren
(paren
r_struct
id|tcf_proto
op_star
comma
r_int
r_int
id|node
comma
r_struct
id|tcf_walker
op_star
)paren
suffix:semicolon
)brace
suffix:semicolon
multiline_comment|/* Main classifier routine: scans classifier chain attached&n;   to this qdisc, (optionally) tests for protocol and asks&n;   specific classifiers.&n; */
DECL|function|tc_classify
r_static
r_inline
r_int
id|tc_classify
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|tcf_proto
op_star
id|tp
comma
r_struct
id|tcf_result
op_star
id|res
)paren
(brace
r_int
id|err
op_assign
l_int|0
suffix:semicolon
id|u32
id|protocol
op_assign
id|skb-&gt;protocol
suffix:semicolon
macro_line|#ifdef CONFIG_NET_CLS_ACT
r_struct
id|tcf_proto
op_star
id|otp
op_assign
id|tp
suffix:semicolon
id|reclassify
suffix:colon
macro_line|#endif
id|protocol
op_assign
id|skb-&gt;protocol
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
id|tp
suffix:semicolon
id|tp
op_assign
id|tp-&gt;next
)paren
(brace
r_if
c_cond
(paren
(paren
id|tp-&gt;protocol
op_eq
id|protocol
op_logical_or
id|tp-&gt;protocol
op_eq
id|__constant_htons
c_func
(paren
id|ETH_P_ALL
)paren
)paren
op_logical_and
(paren
id|err
op_assign
id|tp
op_member_access_from_pointer
id|classify
c_func
(paren
id|skb
comma
id|tp
comma
id|res
)paren
)paren
op_ge
l_int|0
)paren
(brace
macro_line|#ifdef CONFIG_NET_CLS_ACT
r_if
c_cond
(paren
id|TC_ACT_RECLASSIFY
op_eq
id|err
)paren
(brace
id|__u32
id|verd
op_assign
(paren
id|__u32
)paren
id|G_TC_VERD
c_func
(paren
id|skb-&gt;tc_verd
)paren
suffix:semicolon
id|tp
op_assign
id|otp
suffix:semicolon
r_if
c_cond
(paren
id|MAX_REC_LOOP
OL
id|verd
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;rule prio %d protocol %02x reclassify is buggy packet dropped&bslash;n&quot;
comma
id|tp-&gt;prio
op_amp
l_int|0xffff
comma
id|ntohs
c_func
(paren
id|tp-&gt;protocol
)paren
)paren
suffix:semicolon
r_return
id|TC_ACT_SHOT
suffix:semicolon
)brace
id|skb-&gt;tc_verd
op_assign
id|SET_TC_VERD
c_func
(paren
id|skb-&gt;tc_verd
comma
id|verd
)paren
suffix:semicolon
r_goto
id|reclassify
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|skb-&gt;tc_verd
)paren
id|skb-&gt;tc_verd
op_assign
id|SET_TC_VERD
c_func
(paren
id|skb-&gt;tc_verd
comma
l_int|0
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
macro_line|#else
r_return
id|err
suffix:semicolon
macro_line|#endif
)brace
)brace
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_extern
r_int
id|register_tcf_proto_ops
c_func
(paren
r_struct
id|tcf_proto_ops
op_star
id|ops
)paren
suffix:semicolon
r_extern
r_int
id|unregister_tcf_proto_ops
c_func
(paren
r_struct
id|tcf_proto_ops
op_star
id|ops
)paren
suffix:semicolon
r_extern
r_int
id|ing_filter
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
)paren
suffix:semicolon
macro_line|#endif
eof
