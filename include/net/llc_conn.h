macro_line|#ifndef LLC_CONN_H
DECL|macro|LLC_CONN_H
mdefine_line|#define LLC_CONN_H
multiline_comment|/*&n; * Copyright (c) 1997 by Procom Technology, Inc.&n; * &t;&t; 2001, 2002 by Arnaldo Carvalho de Melo &lt;acme@conectiva.com.br&gt;&n; *&n; * This program can be redistributed or modified under the terms of the&n; * GNU General Public License as published by the Free Software Foundation.&n; * This program is distributed without any warranty or implied warranty&n; * of merchantability or fitness for a particular purpose.&n; *&n; * See the GNU General Public License for more details.&n; */
macro_line|#include &lt;linux/timer.h&gt;
macro_line|#include &lt;net/llc_if.h&gt;
macro_line|#include &lt;linux/llc.h&gt;
DECL|macro|LLC_EVENT
mdefine_line|#define LLC_EVENT                1
DECL|macro|LLC_PACKET
mdefine_line|#define LLC_PACKET               2
DECL|macro|LLC_P_TIME
mdefine_line|#define LLC_P_TIME               2
DECL|macro|LLC_ACK_TIME
mdefine_line|#define LLC_ACK_TIME             1
DECL|macro|LLC_REJ_TIME
mdefine_line|#define LLC_REJ_TIME             3
DECL|macro|LLC_BUSY_TIME
mdefine_line|#define LLC_BUSY_TIME            3
DECL|struct|llc_timer
r_struct
id|llc_timer
(brace
DECL|member|timer
r_struct
id|timer_list
id|timer
suffix:semicolon
DECL|member|expire
id|u16
id|expire
suffix:semicolon
multiline_comment|/* timer expire time */
)brace
suffix:semicolon
DECL|struct|llc_opt
r_struct
id|llc_opt
(brace
DECL|member|sk
r_struct
id|sock
op_star
id|sk
suffix:semicolon
multiline_comment|/* sock that has this llc_opt */
DECL|member|addr
r_struct
id|sockaddr_llc
id|addr
suffix:semicolon
multiline_comment|/* address sock is bound to */
DECL|member|state
id|u8
id|state
suffix:semicolon
multiline_comment|/* state of connection */
DECL|member|sap
r_struct
id|llc_sap
op_star
id|sap
suffix:semicolon
multiline_comment|/* pointer to parent SAP */
DECL|member|laddr
r_struct
id|llc_addr
id|laddr
suffix:semicolon
multiline_comment|/* lsap/mac pair */
DECL|member|daddr
r_struct
id|llc_addr
id|daddr
suffix:semicolon
multiline_comment|/* dsap/mac pair */
DECL|member|dev
r_struct
id|net_device
op_star
id|dev
suffix:semicolon
multiline_comment|/* device to send to remote */
DECL|member|retry_count
id|u8
id|retry_count
suffix:semicolon
multiline_comment|/* number of retries */
DECL|member|ack_must_be_send
id|u8
id|ack_must_be_send
suffix:semicolon
DECL|member|first_pdu_Ns
id|u8
id|first_pdu_Ns
suffix:semicolon
DECL|member|npta
id|u8
id|npta
suffix:semicolon
DECL|member|ack_timer
r_struct
id|llc_timer
id|ack_timer
suffix:semicolon
DECL|member|pf_cycle_timer
r_struct
id|llc_timer
id|pf_cycle_timer
suffix:semicolon
DECL|member|rej_sent_timer
r_struct
id|llc_timer
id|rej_sent_timer
suffix:semicolon
DECL|member|busy_state_timer
r_struct
id|llc_timer
id|busy_state_timer
suffix:semicolon
multiline_comment|/* ind busy clr at remote LLC */
DECL|member|vS
id|u8
id|vS
suffix:semicolon
multiline_comment|/* seq# next in-seq I-PDU tx&squot;d*/
DECL|member|vR
id|u8
id|vR
suffix:semicolon
multiline_comment|/* seq# next in-seq I-PDU rx&squot;d*/
DECL|member|n2
id|u32
id|n2
suffix:semicolon
multiline_comment|/* max nbr re-tx&squot;s for timeout*/
DECL|member|n1
id|u32
id|n1
suffix:semicolon
multiline_comment|/* max nbr octets in I PDU */
DECL|member|k
id|u8
id|k
suffix:semicolon
multiline_comment|/* tx window size; max = 127 */
DECL|member|rw
id|u8
id|rw
suffix:semicolon
multiline_comment|/* rx window size; max = 127 */
DECL|member|p_flag
id|u8
id|p_flag
suffix:semicolon
multiline_comment|/* state flags */
DECL|member|f_flag
id|u8
id|f_flag
suffix:semicolon
DECL|member|s_flag
id|u8
id|s_flag
suffix:semicolon
DECL|member|data_flag
id|u8
id|data_flag
suffix:semicolon
DECL|member|remote_busy_flag
id|u8
id|remote_busy_flag
suffix:semicolon
DECL|member|cause_flag
id|u8
id|cause_flag
suffix:semicolon
DECL|member|pdu_unack_q
r_struct
id|sk_buff_head
id|pdu_unack_q
suffix:semicolon
multiline_comment|/* PUDs sent/waiting ack */
DECL|member|link
id|u16
id|link
suffix:semicolon
multiline_comment|/* network layer link number */
DECL|member|X
id|u8
id|X
suffix:semicolon
multiline_comment|/* a temporary variable */
DECL|member|ack_pf
id|u8
id|ack_pf
suffix:semicolon
multiline_comment|/* this flag indicates what is&n;&t;&t;&t;&t;&t;&t;   the P-bit of acknowledge */
DECL|member|failed_data_req
id|u8
id|failed_data_req
suffix:semicolon
multiline_comment|/* recognize that already exist a&n;&t;&t;&t;&t;&t;&t;failed llc_data_req_handler&n;&t;&t;&t;&t;&t;&t;(tx_buffer_full or unacceptable&n;&t;&t;&t;&t;&t;&t;state */
DECL|member|dec_step
id|u8
id|dec_step
suffix:semicolon
DECL|member|inc_cntr
id|u8
id|inc_cntr
suffix:semicolon
DECL|member|dec_cntr
id|u8
id|dec_cntr
suffix:semicolon
DECL|member|connect_step
id|u8
id|connect_step
suffix:semicolon
DECL|member|last_nr
id|u8
id|last_nr
suffix:semicolon
multiline_comment|/* NR of last pdu received */
DECL|member|rx_pdu_hdr
id|u32
id|rx_pdu_hdr
suffix:semicolon
multiline_comment|/* used for saving header of last pdu&n;&t;&t;&t;&t;&t;      received and caused sending FRMR.&n;&t;&t;&t;&t;&t;      Used for resending FRMR */
)brace
suffix:semicolon
DECL|macro|llc_sk
mdefine_line|#define llc_sk(__sk) ((struct llc_opt *)(__sk)-&gt;sk_protinfo)
DECL|function|llc_set_backlog_type
r_static
id|__inline__
r_void
id|llc_set_backlog_type
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_char
id|type
)paren
(brace
id|skb-&gt;cb
(braket
r_sizeof
(paren
id|skb-&gt;cb
)paren
op_minus
l_int|1
)braket
op_assign
id|type
suffix:semicolon
)brace
DECL|function|llc_backlog_type
r_static
id|__inline__
r_char
id|llc_backlog_type
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
)paren
(brace
r_return
id|skb-&gt;cb
(braket
r_sizeof
(paren
id|skb-&gt;cb
)paren
op_minus
l_int|1
)braket
suffix:semicolon
)brace
r_extern
r_struct
id|sock
op_star
id|llc_sk_alloc
c_func
(paren
r_int
id|family
comma
r_int
id|priority
)paren
suffix:semicolon
r_extern
r_void
id|llc_sk_free
c_func
(paren
r_struct
id|sock
op_star
id|sk
)paren
suffix:semicolon
r_extern
r_void
id|llc_sk_reset
c_func
(paren
r_struct
id|sock
op_star
id|sk
)paren
suffix:semicolon
multiline_comment|/* Access to a connection */
r_extern
r_int
id|llc_conn_state_process
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|sk_buff
op_star
id|skb
)paren
suffix:semicolon
r_extern
r_void
id|llc_conn_send_pdu
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|sk_buff
op_star
id|skb
)paren
suffix:semicolon
r_extern
r_void
id|llc_conn_rtn_pdu
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|sk_buff
op_star
id|skb
)paren
suffix:semicolon
r_extern
r_void
id|llc_conn_resend_i_pdu_as_cmd
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
id|u8
id|nr
comma
id|u8
id|first_p_bit
)paren
suffix:semicolon
r_extern
r_void
id|llc_conn_resend_i_pdu_as_rsp
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
id|u8
id|nr
comma
id|u8
id|first_f_bit
)paren
suffix:semicolon
r_extern
r_int
id|llc_conn_remove_acked_pdus
c_func
(paren
r_struct
id|sock
op_star
id|conn
comma
id|u8
id|nr
comma
id|u16
op_star
id|how_many_unacked
)paren
suffix:semicolon
r_extern
r_struct
id|sock
op_star
id|llc_lookup_established
c_func
(paren
r_struct
id|llc_sap
op_star
id|sap
comma
r_struct
id|llc_addr
op_star
id|daddr
comma
r_struct
id|llc_addr
op_star
id|laddr
)paren
suffix:semicolon
r_extern
r_void
id|llc_sap_add_socket
c_func
(paren
r_struct
id|llc_sap
op_star
id|sap
comma
r_struct
id|sock
op_star
id|sk
)paren
suffix:semicolon
r_extern
r_void
id|llc_sap_remove_socket
c_func
(paren
r_struct
id|llc_sap
op_star
id|sap
comma
r_struct
id|sock
op_star
id|sk
)paren
suffix:semicolon
r_extern
id|u8
id|llc_data_accept_state
c_func
(paren
id|u8
id|state
)paren
suffix:semicolon
r_extern
r_void
id|llc_build_offset_table
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|llc_release_sockets
c_func
(paren
r_struct
id|llc_sap
op_star
id|sap
)paren
suffix:semicolon
macro_line|#endif /* LLC_CONN_H */
eof
