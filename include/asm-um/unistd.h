multiline_comment|/* &n; * Copyright (C) 2000, 2001  Jeff Dike (jdike@karaya.com)&n; * Licensed under the GPL&n; */
macro_line|#ifndef _UM_UNISTD_H_
DECL|macro|_UM_UNISTD_H_
mdefine_line|#define _UM_UNISTD_H_
macro_line|#include &quot;linux/resource.h&quot;
macro_line|#include &quot;asm/uaccess.h&quot;
r_extern
r_int
id|sys_open
c_func
(paren
r_const
r_char
op_star
id|filename
comma
r_int
id|flags
comma
r_int
id|mode
)paren
suffix:semicolon
r_extern
r_int
id|sys_dup
c_func
(paren
r_int
r_int
id|fildes
)paren
suffix:semicolon
r_extern
r_int
id|sys_close
c_func
(paren
r_int
r_int
id|fd
)paren
suffix:semicolon
r_extern
r_int
id|um_execve
c_func
(paren
r_const
r_char
op_star
id|file
comma
r_char
op_star
r_const
id|argv
(braket
)braket
comma
r_char
op_star
r_const
id|env
(braket
)braket
)paren
suffix:semicolon
r_extern
r_int
id|sys_setsid
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|sys_waitpid
c_func
(paren
id|pid_t
id|pid
comma
r_int
r_int
op_star
id|stat_addr
comma
r_int
id|options
)paren
suffix:semicolon
r_extern
r_int
id|sys_wait4
c_func
(paren
id|pid_t
id|pid
comma
r_int
r_int
op_star
id|stat_addr
comma
r_int
id|options
comma
r_struct
id|rusage
op_star
id|ru
)paren
suffix:semicolon
r_extern
r_int
id|sys_mount
c_func
(paren
r_char
op_star
id|dev_name
comma
r_char
op_star
id|dir_name
comma
r_char
op_star
id|type
comma
r_int
r_int
id|flags
comma
r_void
op_star
id|data
)paren
suffix:semicolon
r_extern
r_int
id|sys_select
c_func
(paren
r_int
id|n
comma
id|fd_set
op_star
id|inp
comma
id|fd_set
op_star
id|outp
comma
id|fd_set
op_star
id|exp
comma
r_struct
id|timeval
op_star
id|tvp
)paren
suffix:semicolon
r_extern
r_int
id|sys_lseek
c_func
(paren
r_int
r_int
id|fildes
comma
r_int
r_int
id|offset
comma
r_int
id|whence
)paren
suffix:semicolon
r_extern
r_int
id|sys_read
c_func
(paren
r_int
r_int
id|fildes
comma
r_char
op_star
id|buf
comma
r_int
id|len
)paren
suffix:semicolon
r_extern
r_int
id|sys_write
c_func
(paren
r_int
r_int
id|fildes
comma
r_char
op_star
id|buf
comma
r_int
id|len
)paren
suffix:semicolon
macro_line|#ifdef __KERNEL_SYSCALLS__
DECL|macro|KERNEL_CALL
mdefine_line|#define KERNEL_CALL(ret_t, sys, args...)&t;&bslash;&n;&t;mm_segment_t fs = get_fs();&t;&t;&bslash;&n;&t;ret_t ret;&t;&t;&t;&t;&bslash;&n;&t;set_fs(KERNEL_DS);&t;&t;&t;&bslash;&n;&t;ret = sys(args);&t;&t;&t;&bslash;&n;&t;set_fs(fs);&t;&t;&t;&t;&bslash;&n;&t;return ret;
DECL|function|open
r_static
r_inline
r_int
id|open
c_func
(paren
r_const
r_char
op_star
id|pathname
comma
r_int
id|flags
comma
r_int
id|mode
)paren
(brace
id|KERNEL_CALL
c_func
(paren
r_int
comma
id|sys_open
comma
id|pathname
comma
id|flags
comma
id|mode
)paren
)brace
DECL|function|dup
r_static
r_inline
r_int
id|dup
c_func
(paren
r_int
r_int
id|fd
)paren
(brace
id|KERNEL_CALL
c_func
(paren
r_int
comma
id|sys_dup
comma
id|fd
)paren
suffix:semicolon
)brace
DECL|function|close
r_static
r_inline
r_int
id|close
c_func
(paren
r_int
r_int
id|fd
)paren
(brace
id|KERNEL_CALL
c_func
(paren
r_int
comma
id|sys_close
comma
id|fd
)paren
suffix:semicolon
)brace
DECL|function|execve
r_static
r_inline
r_int
id|execve
c_func
(paren
r_const
r_char
op_star
id|filename
comma
r_char
op_star
r_const
id|argv
(braket
)braket
comma
r_char
op_star
r_const
id|envp
(braket
)braket
)paren
(brace
id|KERNEL_CALL
c_func
(paren
r_int
comma
id|um_execve
comma
id|filename
comma
id|argv
comma
id|envp
)paren
suffix:semicolon
)brace
DECL|function|waitpid
r_static
r_inline
r_int
id|waitpid
c_func
(paren
id|pid_t
id|pid
comma
r_int
r_int
op_star
id|status
comma
r_int
id|options
)paren
(brace
id|KERNEL_CALL
c_func
(paren
id|pid_t
comma
id|sys_wait4
comma
id|pid
comma
id|status
comma
id|options
comma
l_int|NULL
)paren
)brace
DECL|function|setsid
r_static
r_inline
id|pid_t
id|setsid
c_func
(paren
r_void
)paren
(brace
id|KERNEL_CALL
c_func
(paren
id|pid_t
comma
id|sys_setsid
)paren
)brace
DECL|function|lseek
r_static
r_inline
r_int
id|lseek
c_func
(paren
r_int
r_int
id|fd
comma
id|off_t
id|offset
comma
r_int
r_int
id|whence
)paren
(brace
id|KERNEL_CALL
c_func
(paren
r_int
comma
id|sys_lseek
comma
id|fd
comma
id|offset
comma
id|whence
)paren
)brace
DECL|function|read
r_static
r_inline
r_int
id|read
c_func
(paren
r_int
r_int
id|fd
comma
r_char
op_star
id|buf
comma
r_int
id|len
)paren
(brace
id|KERNEL_CALL
c_func
(paren
r_int
comma
id|sys_read
comma
id|fd
comma
id|buf
comma
id|len
)paren
)brace
DECL|function|write
r_static
r_inline
r_int
id|write
c_func
(paren
r_int
r_int
id|fd
comma
r_char
op_star
id|buf
comma
r_int
id|len
)paren
(brace
id|KERNEL_CALL
c_func
(paren
r_int
comma
id|sys_write
comma
id|fd
comma
id|buf
comma
id|len
)paren
)brace
macro_line|#endif
multiline_comment|/* Save the value of __KERNEL_SYSCALLS__, undefine it, include the underlying&n; * arch&squot;s unistd.h for the system call numbers, and restore the old &n; * __KERNEL_SYSCALLS__.&n; */
macro_line|#ifdef __KERNEL_SYSCALLS__
DECL|macro|__SAVE_KERNEL_SYSCALLS__
mdefine_line|#define __SAVE_KERNEL_SYSCALLS__ __KERNEL_SYSCALLS__
macro_line|#endif
DECL|macro|__KERNEL_SYSCALLS__
macro_line|#undef __KERNEL_SYSCALLS__
macro_line|#include &quot;asm/arch/unistd.h&quot;
macro_line|#ifdef __KERNEL_SYSCALLS__
DECL|macro|__KERNEL_SYSCALLS__
mdefine_line|#define __KERNEL_SYSCALLS__ __SAVE_KERNEL_SYSCALLS__
macro_line|#endif
macro_line|#endif
multiline_comment|/*&n; * Overrides for Emacs so that we follow Linus&squot;s tabbing style.&n; * Emacs will notice this stuff at the end of the file and automatically&n; * adjust the settings for this buffer only.  This must remain at the end&n; * of the file.&n; * ---------------------------------------------------------------------------&n; * Local variables:&n; * c-file-style: &quot;linux&quot;&n; * End:&n; */
eof
