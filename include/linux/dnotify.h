multiline_comment|/*&n; * Directory notification for Linux&n; *&n; * Copyright 2000 (C) Stephen Rothwell&n; */
macro_line|#include &lt;linux/fs.h&gt;
DECL|struct|dnotify_struct
r_struct
id|dnotify_struct
(brace
DECL|member|dn_next
r_struct
id|dnotify_struct
op_star
id|dn_next
suffix:semicolon
DECL|member|dn_magic
r_int
id|dn_magic
suffix:semicolon
DECL|member|dn_mask
r_int
r_int
id|dn_mask
suffix:semicolon
multiline_comment|/* Events to be notified&n;&t;&t;&t;&t;&t;&t;   see linux/fcntl.h */
DECL|member|dn_fd
r_int
id|dn_fd
suffix:semicolon
DECL|member|dn_filp
r_struct
id|file
op_star
id|dn_filp
suffix:semicolon
)brace
suffix:semicolon
DECL|macro|DNOTIFY_MAGIC
mdefine_line|#define DNOTIFY_MAGIC&t;0x444E4F54
r_extern
r_void
id|__inode_dir_notify
c_func
(paren
r_struct
id|inode
op_star
comma
r_int
r_int
)paren
suffix:semicolon
r_extern
r_int
id|fcntl_dirnotify
c_func
(paren
r_int
comma
r_struct
id|file
op_star
comma
r_int
r_int
)paren
suffix:semicolon
DECL|function|inode_dir_notify
r_static
r_inline
r_void
id|inode_dir_notify
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_int
r_int
id|event
)paren
(brace
r_if
c_cond
(paren
(paren
id|inode
)paren
op_member_access_from_pointer
id|i_dnotify_mask
op_amp
(paren
id|event
)paren
)paren
id|__inode_dir_notify
c_func
(paren
id|inode
comma
id|event
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * This is hopelessly wrong, but unfixable without API changes.  At&n; * least it doesn&squot;t oops the kernel...&n; */
DECL|function|dnotify_parent
r_static
r_inline
r_void
id|dnotify_parent
c_func
(paren
r_struct
id|dentry
op_star
id|dentry
comma
r_int
r_int
id|event
)paren
(brace
r_struct
id|dentry
op_star
id|parent
suffix:semicolon
id|read_lock
c_func
(paren
op_amp
id|dparent_lock
)paren
suffix:semicolon
id|parent
op_assign
id|dentry-&gt;d_parent
suffix:semicolon
r_if
c_cond
(paren
id|parent-&gt;d_inode-&gt;i_dnotify_mask
op_amp
id|event
)paren
(brace
id|dget
c_func
(paren
id|parent
)paren
suffix:semicolon
id|read_unlock
c_func
(paren
op_amp
id|dparent_lock
)paren
suffix:semicolon
id|__inode_dir_notify
c_func
(paren
id|parent-&gt;d_inode
comma
id|event
)paren
suffix:semicolon
id|dput
c_func
(paren
id|parent
)paren
suffix:semicolon
)brace
r_else
id|read_unlock
c_func
(paren
op_amp
id|dparent_lock
)paren
suffix:semicolon
)brace
eof
