multiline_comment|/*&n; *  linux/include/linux/sunrpc/gss_spkm3.h&n; *&n; *  Copyright (c) 2000 The Regents of the University of Michigan.&n; *  All rights reserved.&n; *&n; *  Andy Adamson   &lt;andros@umich.edu&gt;&n; */
macro_line|#include &lt;linux/sunrpc/auth_gss.h&gt;
macro_line|#include &lt;linux/sunrpc/gss_err.h&gt;
macro_line|#include &lt;linux/sunrpc/gss_asn1.h&gt;
DECL|struct|spkm3_ctx
r_struct
id|spkm3_ctx
(brace
DECL|member|ctx_id
r_struct
id|xdr_netobj
id|ctx_id
suffix:semicolon
multiline_comment|/* per message context id */
DECL|member|qop
r_int
id|qop
suffix:semicolon
multiline_comment|/* negotiated qop */
DECL|member|mech_used
r_struct
id|xdr_netobj
id|mech_used
suffix:semicolon
DECL|member|ret_flags
r_int
r_int
id|ret_flags
suffix:semicolon
DECL|member|req_flags
r_int
r_int
id|req_flags
suffix:semicolon
DECL|member|share_key
r_struct
id|xdr_netobj
id|share_key
suffix:semicolon
DECL|member|conf_alg
r_int
id|conf_alg
suffix:semicolon
DECL|member|derived_conf_key
r_struct
id|crypto_tfm
op_star
id|derived_conf_key
suffix:semicolon
DECL|member|intg_alg
r_int
id|intg_alg
suffix:semicolon
DECL|member|derived_integ_key
r_struct
id|crypto_tfm
op_star
id|derived_integ_key
suffix:semicolon
DECL|member|keyestb_alg
r_int
id|keyestb_alg
suffix:semicolon
multiline_comment|/* alg used to get share_key */
DECL|member|owf_alg
r_int
id|owf_alg
suffix:semicolon
multiline_comment|/* one way function */
)brace
suffix:semicolon
multiline_comment|/* from openssl/objects.h */
multiline_comment|/* XXX need SEAL_ALG_NONE */
DECL|macro|NID_md5
mdefine_line|#define NID_md5&t;&t;4
DECL|macro|NID_dhKeyAgreement
mdefine_line|#define NID_dhKeyAgreement&t;28 
DECL|macro|NID_des_cbc
mdefine_line|#define NID_des_cbc&t;&t;31 
DECL|macro|NID_sha1
mdefine_line|#define NID_sha1&t;&t;64
DECL|macro|NID_cast5_cbc
mdefine_line|#define NID_cast5_cbc&t;&t;108
multiline_comment|/* SPKM InnerContext Token types */
DECL|macro|SPKM_ERROR_TOK
mdefine_line|#define SPKM_ERROR_TOK&t;3
DECL|macro|SPKM_MIC_TOK
mdefine_line|#define SPKM_MIC_TOK&t;4
DECL|macro|SPKM_WRAP_TOK
mdefine_line|#define SPKM_WRAP_TOK&t;5
DECL|macro|SPKM_DEL_TOK
mdefine_line|#define SPKM_DEL_TOK&t;6
id|u32
id|spkm3_make_token
c_func
(paren
r_struct
id|spkm3_ctx
op_star
id|ctx
comma
r_int
id|qop_req
comma
r_struct
id|xdr_buf
op_star
id|text
comma
r_struct
id|xdr_netobj
op_star
id|token
comma
r_int
id|toktype
)paren
suffix:semicolon
id|u32
id|spkm3_read_token
c_func
(paren
r_struct
id|spkm3_ctx
op_star
id|ctx
comma
r_struct
id|xdr_netobj
op_star
id|read_token
comma
r_struct
id|xdr_buf
op_star
id|message_buffer
comma
r_int
op_star
id|qop_state
comma
r_int
id|toktype
)paren
suffix:semicolon
DECL|macro|CKSUMTYPE_RSA_MD5
mdefine_line|#define CKSUMTYPE_RSA_MD5            0x0007
id|s32
id|make_checksum
c_func
(paren
id|s32
id|cksumtype
comma
r_char
op_star
id|header
comma
r_int
id|hdrlen
comma
r_struct
id|xdr_buf
op_star
id|body
comma
r_struct
id|xdr_netobj
op_star
id|cksum
)paren
suffix:semicolon
r_void
id|asn1_bitstring_len
c_func
(paren
r_struct
id|xdr_netobj
op_star
id|in
comma
r_int
op_star
id|enclen
comma
r_int
op_star
id|zerobits
)paren
suffix:semicolon
r_int
id|decode_asn1_bitstring
c_func
(paren
r_struct
id|xdr_netobj
op_star
id|out
comma
r_char
op_star
id|in
comma
r_int
id|enclen
comma
r_int
id|explen
)paren
suffix:semicolon
r_void
id|spkm3_mic_header
c_func
(paren
r_int
r_char
op_star
op_star
id|hdrbuf
comma
r_int
r_int
op_star
id|hdrlen
comma
r_int
r_char
op_star
id|ctxhdr
comma
r_int
id|elen
comma
r_int
id|zbit
)paren
suffix:semicolon
r_void
id|spkm3_make_mic_token
c_func
(paren
r_int
r_char
op_star
op_star
id|tokp
comma
r_int
id|toklen
comma
r_struct
id|xdr_netobj
op_star
id|mic_hdr
comma
r_struct
id|xdr_netobj
op_star
id|md5cksum
comma
r_int
id|md5elen
comma
r_int
id|md5zbit
)paren
suffix:semicolon
id|u32
id|spkm3_verify_mic_token
c_func
(paren
r_int
r_char
op_star
op_star
id|tokp
comma
r_int
op_star
id|mic_hdrlen
comma
r_int
r_char
op_star
op_star
id|cksum
)paren
suffix:semicolon
eof
