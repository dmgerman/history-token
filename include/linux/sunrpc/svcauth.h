multiline_comment|/*&n; * linux/include/linux/sunrpc/svcauth.h&n; *&n; * RPC server-side authentication stuff.&n; *&n; * Copyright (C) 1995, 1996 Olaf Kirch &lt;okir@monad.swb.de&gt;&n; */
macro_line|#ifndef _LINUX_SUNRPC_SVCAUTH_H_
DECL|macro|_LINUX_SUNRPC_SVCAUTH_H_
mdefine_line|#define _LINUX_SUNRPC_SVCAUTH_H_
macro_line|#ifdef __KERNEL__
macro_line|#include &lt;linux/sunrpc/msg_prot.h&gt;
DECL|struct|svc_cred
r_struct
id|svc_cred
(brace
DECL|member|cr_uid
id|uid_t
id|cr_uid
suffix:semicolon
DECL|member|cr_gid
id|gid_t
id|cr_gid
suffix:semicolon
DECL|member|cr_groups
id|gid_t
id|cr_groups
(braket
id|NGROUPS
)braket
suffix:semicolon
)brace
suffix:semicolon
r_struct
id|svc_rqst
suffix:semicolon
multiline_comment|/* forward decl */
multiline_comment|/*&n; * Each authentication flavour registers an auth_ops&n; * structure.&n; * name is simply the name.&n; * flavour gives the auth flavour. It determines where the flavour is registered&n; * accept() is given a request and should verify it.&n; *   It should inspect the authenticator and verifier, and possibly the data.&n; *    If there is a problem with the authentication *authp should be set.&n; *    The return value of accept() can indicate:&n; *      OK - authorised. client and credential are set in rqstp.&n; *           reqbuf points to arguments&n; *           resbuf points to good place for results.  verfier&n; *             is (probably) already in place.  Certainly space is&n; *&t;       reserved for it.&n; *      DROP - simply drop the request. It may have been deferred&n; *      GARBAGE - rpc garbage_args error&n; *      SYSERR - rpc system_err error&n; *      DENIED - authp holds reason for denial.&n; *&n; *   accept is passed the proc number so that it can accept NULL rpc requests&n; *   even if it cannot authenticate the client (as is sometimes appropriate).&n; *&n; * release() is given a request after the procedure has been run.&n; *  It should sign/encrypt the results if needed&n; * It should return:&n; *    OK - the resbuf is ready to be sent&n; *    DROP - the reply should be quitely dropped&n; *    DENIED - authp holds a reason for MSG_DENIED&n; *    SYSERR - rpc system_err&n; */
DECL|struct|auth_ops
r_struct
id|auth_ops
(brace
DECL|member|name
r_char
op_star
id|name
suffix:semicolon
DECL|member|flavour
r_int
id|flavour
suffix:semicolon
DECL|member|accept
r_int
(paren
op_star
id|accept
)paren
(paren
r_struct
id|svc_rqst
op_star
id|rq
comma
id|u32
op_star
id|authp
comma
r_int
id|proc
)paren
suffix:semicolon
DECL|member|release
r_int
(paren
op_star
id|release
)paren
(paren
r_struct
id|svc_rqst
op_star
id|rq
)paren
suffix:semicolon
)brace
suffix:semicolon
r_extern
r_struct
id|auth_ops
op_star
id|authtab
(braket
id|RPC_AUTH_MAXFLAVOR
)braket
suffix:semicolon
DECL|macro|SVC_GARBAGE
mdefine_line|#define&t;SVC_GARBAGE&t;1
DECL|macro|SVC_SYSERR
mdefine_line|#define&t;SVC_SYSERR&t;2
DECL|macro|SVC_VALID
mdefine_line|#define&t;SVC_VALID&t;3
DECL|macro|SVC_NEGATIVE
mdefine_line|#define&t;SVC_NEGATIVE&t;4
DECL|macro|SVC_OK
mdefine_line|#define&t;SVC_OK&t;&t;5
DECL|macro|SVC_DROP
mdefine_line|#define&t;SVC_DROP&t;6
DECL|macro|SVC_DENIED
mdefine_line|#define&t;SVC_DENIED&t;7
DECL|macro|SVC_PENDING
mdefine_line|#define&t;SVC_PENDING&t;8
r_extern
r_int
id|svc_authenticate
c_func
(paren
r_struct
id|svc_rqst
op_star
id|rqstp
comma
id|u32
op_star
id|statp
comma
id|u32
op_star
id|authp
comma
r_int
id|proc
)paren
suffix:semicolon
r_extern
r_int
id|svc_authorise
c_func
(paren
r_struct
id|svc_rqst
op_star
id|rqstp
)paren
suffix:semicolon
r_extern
r_int
id|svc_auth_register
c_func
(paren
id|rpc_authflavor_t
id|flavor
comma
r_struct
id|auth_ops
op_star
id|aops
)paren
suffix:semicolon
r_extern
r_void
id|svc_auth_unregister
c_func
(paren
id|rpc_authflavor_t
id|flavor
)paren
suffix:semicolon
macro_line|#endif /* __KERNEL__ */
macro_line|#endif /* _LINUX_SUNRPC_SVCAUTH_H_ */
eof
