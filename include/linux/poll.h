macro_line|#ifndef _LINUX_POLL_H
DECL|macro|_LINUX_POLL_H
mdefine_line|#define _LINUX_POLL_H
macro_line|#include &lt;asm/poll.h&gt;
macro_line|#ifdef __KERNEL__
macro_line|#include &lt;linux/wait.h&gt;
macro_line|#include &lt;linux/string.h&gt;
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;asm/uaccess.h&gt;
DECL|macro|POLL_INLINE_BYTES
mdefine_line|#define POLL_INLINE_BYTES 256
DECL|macro|FAST_SELECT_MAX
mdefine_line|#define FAST_SELECT_MAX  128
DECL|macro|FAST_POLL_MAX
mdefine_line|#define FAST_POLL_MAX    128
DECL|macro|POLL_INLINE_ENTRIES
mdefine_line|#define POLL_INLINE_ENTRIES (1+(POLL_INLINE_BYTES / sizeof(struct poll_table_entry)))
DECL|struct|poll_table_entry
r_struct
id|poll_table_entry
(brace
DECL|member|filp
r_struct
id|file
op_star
id|filp
suffix:semicolon
DECL|member|wait
id|wait_queue_t
id|wait
suffix:semicolon
DECL|member|wait_address
id|wait_queue_head_t
op_star
id|wait_address
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|poll_table_page
r_struct
id|poll_table_page
(brace
DECL|member|next
r_struct
id|poll_table_page
op_star
id|next
suffix:semicolon
DECL|member|entry
r_struct
id|poll_table_entry
op_star
id|entry
suffix:semicolon
DECL|member|entries
r_struct
id|poll_table_entry
id|entries
(braket
l_int|0
)braket
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|poll_table_struct
r_typedef
r_struct
id|poll_table_struct
(brace
DECL|member|error
r_int
id|error
suffix:semicolon
DECL|member|table
r_struct
id|poll_table_page
op_star
id|table
suffix:semicolon
DECL|member|inline_page
r_struct
id|poll_table_page
id|inline_page
suffix:semicolon
DECL|member|inline_table
r_struct
id|poll_table_entry
id|inline_table
(braket
id|POLL_INLINE_ENTRIES
)braket
suffix:semicolon
DECL|typedef|poll_table
)brace
id|poll_table
suffix:semicolon
DECL|macro|POLL_INLINE_TABLE_LEN
mdefine_line|#define POLL_INLINE_TABLE_LEN (sizeof(poll_table) - offsetof(poll_table, inline_page))
r_extern
r_void
id|__pollwait
c_func
(paren
r_struct
id|file
op_star
id|filp
comma
id|wait_queue_head_t
op_star
id|wait_address
comma
id|poll_table
op_star
id|p
)paren
suffix:semicolon
DECL|function|poll_wait
r_static
r_inline
r_void
id|poll_wait
c_func
(paren
r_struct
id|file
op_star
id|filp
comma
id|wait_queue_head_t
op_star
id|wait_address
comma
id|poll_table
op_star
id|p
)paren
(brace
r_if
c_cond
(paren
id|p
op_logical_and
id|wait_address
)paren
id|__pollwait
c_func
(paren
id|filp
comma
id|wait_address
comma
id|p
)paren
suffix:semicolon
)brace
DECL|function|poll_initwait
r_static
r_inline
r_void
id|poll_initwait
c_func
(paren
id|poll_table
op_star
id|pt
)paren
(brace
id|pt-&gt;error
op_assign
l_int|0
suffix:semicolon
id|pt-&gt;table
op_assign
l_int|NULL
suffix:semicolon
)brace
r_extern
r_void
id|poll_freewait
c_func
(paren
id|poll_table
op_star
id|pt
)paren
suffix:semicolon
multiline_comment|/*&n; * Scaleable version of the fd_set.&n; */
r_typedef
r_struct
(brace
DECL|member|in
DECL|member|out
DECL|member|ex
r_int
r_int
op_star
id|in
comma
op_star
id|out
comma
op_star
id|ex
suffix:semicolon
DECL|member|res_in
DECL|member|res_out
DECL|member|res_ex
r_int
r_int
op_star
id|res_in
comma
op_star
id|res_out
comma
op_star
id|res_ex
suffix:semicolon
DECL|typedef|fd_set_bits
)brace
id|fd_set_bits
suffix:semicolon
multiline_comment|/*&n; * How many longwords for &quot;nr&quot; bits?&n; */
DECL|macro|FDS_BITPERLONG
mdefine_line|#define FDS_BITPERLONG&t;(8*sizeof(long))
DECL|macro|FDS_LONGS
mdefine_line|#define FDS_LONGS(nr)&t;(((nr)+FDS_BITPERLONG-1)/FDS_BITPERLONG)
DECL|macro|FDS_BYTES
mdefine_line|#define FDS_BYTES(nr)&t;(FDS_LONGS(nr)*sizeof(long))
r_static
r_inline
DECL|function|set_fd_set
r_void
id|set_fd_set
c_func
(paren
r_int
r_int
id|nr
comma
r_void
op_star
id|ufdset
comma
r_int
r_int
op_star
id|fdset
)paren
(brace
r_if
c_cond
(paren
id|ufdset
)paren
id|__copy_to_user
c_func
(paren
id|ufdset
comma
id|fdset
comma
id|FDS_BYTES
c_func
(paren
id|nr
)paren
)paren
suffix:semicolon
)brace
r_extern
r_int
id|do_select
c_func
(paren
r_int
id|n
comma
id|fd_set_bits
op_star
id|fds
comma
r_int
op_star
id|timeout
)paren
suffix:semicolon
macro_line|#endif /* KERNEL */
macro_line|#endif /* _LINUX_POLL_H */
eof
