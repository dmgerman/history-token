multiline_comment|/* two abstractions specific to kernel/smpboot.c, mainly to cater to visws&n; * which needs to alter them. */
DECL|function|smpboot_clear_io_apic_irqs
r_static
r_inline
r_void
id|smpboot_clear_io_apic_irqs
c_func
(paren
r_void
)paren
(brace
id|io_apic_irqs
op_assign
l_int|0
suffix:semicolon
)brace
DECL|function|smpboot_setup_warm_reset_vector
r_static
r_inline
r_void
id|smpboot_setup_warm_reset_vector
c_func
(paren
r_int
r_int
id|start_eip
)paren
(brace
multiline_comment|/* reset code is stored in 8255 on PC-9800. */
id|outb
c_func
(paren
l_int|0x0e
comma
l_int|0x37
)paren
suffix:semicolon
multiline_comment|/* SHUT0 = 0 */
id|local_flush_tlb
c_func
(paren
)paren
suffix:semicolon
id|Dprintk
c_func
(paren
l_string|&quot;1.&bslash;n&quot;
)paren
suffix:semicolon
op_star
(paren
(paren
r_volatile
r_int
r_int
op_star
)paren
id|TRAMPOLINE_HIGH
)paren
op_assign
id|start_eip
op_rshift
l_int|4
suffix:semicolon
id|Dprintk
c_func
(paren
l_string|&quot;2.&bslash;n&quot;
)paren
suffix:semicolon
op_star
(paren
(paren
r_volatile
r_int
r_int
op_star
)paren
id|TRAMPOLINE_LOW
)paren
op_assign
id|start_eip
op_amp
l_int|0xf
suffix:semicolon
id|Dprintk
c_func
(paren
l_string|&quot;3.&bslash;n&quot;
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * On PC-9800, continuation on warm reset is done by loading&n;&t; * %ss:%sp from 0x0000:0404 and executing &squot;lret&squot;, so:&n;&t; */
multiline_comment|/* 0x3f0 is on unused interrupt vector and should be safe... */
op_star
(paren
(paren
r_volatile
r_int
r_int
op_star
)paren
id|phys_to_virt
c_func
(paren
l_int|0x404
)paren
)paren
op_assign
l_int|0x000003f0
suffix:semicolon
id|Dprintk
c_func
(paren
l_string|&quot;4.&bslash;n&quot;
)paren
suffix:semicolon
)brace
DECL|function|smpboot_restore_warm_reset_vector
r_static
r_inline
r_void
id|smpboot_restore_warm_reset_vector
c_func
(paren
r_void
)paren
(brace
multiline_comment|/*&n;&t; * Install writable page 0 entry to set BIOS data area.&n;&t; */
id|local_flush_tlb
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * Paranoid:  Set warm reset code and vector here back&n;&t; * to default values.&n;&t; */
id|outb
c_func
(paren
l_int|0x0f
comma
l_int|0x37
)paren
suffix:semicolon
multiline_comment|/* SHUT0 = 1 */
op_star
(paren
(paren
r_volatile
r_int
op_star
)paren
id|phys_to_virt
c_func
(paren
l_int|0x404
)paren
)paren
op_assign
l_int|0
suffix:semicolon
)brace
DECL|function|smpboot_setup_io_apic
r_static
r_inline
r_void
id|smpboot_setup_io_apic
c_func
(paren
r_void
)paren
(brace
multiline_comment|/*&n;&t; * Here we can be sure that there is an IO-APIC in the system. Let&squot;s&n;&t; * go and set it up:&n;&t; */
r_if
c_cond
(paren
op_logical_neg
id|skip_ioapic_setup
op_logical_and
id|nr_ioapics
)paren
id|setup_IO_APIC
c_func
(paren
)paren
suffix:semicolon
)brace
eof
