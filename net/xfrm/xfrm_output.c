multiline_comment|/* &n; * generic xfrm output routines&n; *&n; * Copyright (c) 2003 James Morris &lt;jmorris@intercode.com.au&gt;&n; *&n; * This program is free software; you can redistribute it and/or modify it&n; * under the terms of the GNU General Public License as published by the Free&n; * Software Foundation; either version 2 of the License, or (at your option) &n; * any later version.&n; */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/skbuff.h&gt;
macro_line|#include &lt;net/xfrm.h&gt;
DECL|function|xfrm_check_output
r_int
id|xfrm_check_output
c_func
(paren
r_struct
id|xfrm_state
op_star
id|x
comma
r_struct
id|sk_buff
op_star
id|skb
comma
r_int
r_int
id|family
)paren
(brace
r_int
id|err
suffix:semicolon
id|err
op_assign
id|xfrm_state_check_expire
c_func
(paren
id|x
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_goto
id|out
suffix:semicolon
r_if
c_cond
(paren
id|x-&gt;props.mode
)paren
(brace
r_switch
c_cond
(paren
id|family
)paren
(brace
r_case
id|AF_INET
suffix:colon
id|err
op_assign
id|xfrm4_tunnel_check_size
c_func
(paren
id|skb
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|AF_INET6
suffix:colon
id|err
op_assign
id|xfrm6_tunnel_check_size
c_func
(paren
id|skb
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|err
op_assign
op_minus
id|EINVAL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|err
)paren
r_goto
id|out
suffix:semicolon
)brace
id|err
op_assign
id|xfrm_state_check_space
c_func
(paren
id|x
comma
id|skb
)paren
suffix:semicolon
id|out
suffix:colon
r_return
id|err
suffix:semicolon
)brace
eof
