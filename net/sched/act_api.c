multiline_comment|/*&n; * net/sched/act_api.c&t;Packet action API.&n; *&n; *&t;&t;This program is free software; you can redistribute it and/or&n; *&t;&t;modify it under the terms of the GNU General Public License&n; *&t;&t;as published by the Free Software Foundation; either version&n; *&t;&t;2 of the License, or (at your option) any later version.&n; *&n; * Author:&t;Jamal Hadi Salim&n; *&n; *&n; */
macro_line|#include &lt;asm/uaccess.h&gt;
macro_line|#include &lt;asm/system.h&gt;
macro_line|#include &lt;linux/bitops.h&gt;
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/types.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/string.h&gt;
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;linux/socket.h&gt;
macro_line|#include &lt;linux/sockios.h&gt;
macro_line|#include &lt;linux/in.h&gt;
macro_line|#include &lt;linux/errno.h&gt;
macro_line|#include &lt;linux/interrupt.h&gt;
macro_line|#include &lt;linux/netdevice.h&gt;
macro_line|#include &lt;linux/skbuff.h&gt;
macro_line|#include &lt;linux/rtnetlink.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/kmod.h&gt;
macro_line|#include &lt;net/sock.h&gt;
macro_line|#include &lt;net/sch_generic.h&gt;
macro_line|#include &lt;net/act_api.h&gt;
macro_line|#if 1 /* control */
DECL|macro|DPRINTK
mdefine_line|#define DPRINTK(format,args...) printk(KERN_DEBUG format,##args)
macro_line|#else
DECL|macro|DPRINTK
mdefine_line|#define DPRINTK(format,args...)
macro_line|#endif
macro_line|#if 0 /* data */
mdefine_line|#define D2PRINTK(format,args...) printk(KERN_DEBUG format,##args)
macro_line|#else
DECL|macro|D2PRINTK
mdefine_line|#define D2PRINTK(format,args...)
macro_line|#endif
DECL|variable|act_base
r_static
r_struct
id|tc_action_ops
op_star
id|act_base
op_assign
l_int|NULL
suffix:semicolon
DECL|variable|act_mod_lock
r_static
id|rwlock_t
id|act_mod_lock
op_assign
id|RW_LOCK_UNLOCKED
suffix:semicolon
DECL|function|tcf_register_action
r_int
id|tcf_register_action
c_func
(paren
r_struct
id|tc_action_ops
op_star
id|act
)paren
(brace
r_struct
id|tc_action_ops
op_star
id|a
comma
op_star
op_star
id|ap
suffix:semicolon
id|write_lock
c_func
(paren
op_amp
id|act_mod_lock
)paren
suffix:semicolon
r_for
c_loop
(paren
id|ap
op_assign
op_amp
id|act_base
suffix:semicolon
(paren
id|a
op_assign
op_star
id|ap
)paren
op_ne
l_int|NULL
suffix:semicolon
id|ap
op_assign
op_amp
id|a-&gt;next
)paren
(brace
r_if
c_cond
(paren
id|act-&gt;type
op_eq
id|a-&gt;type
op_logical_or
(paren
id|strcmp
c_func
(paren
id|act-&gt;kind
comma
id|a-&gt;kind
)paren
op_eq
l_int|0
)paren
)paren
(brace
id|write_unlock
c_func
(paren
op_amp
id|act_mod_lock
)paren
suffix:semicolon
r_return
op_minus
id|EEXIST
suffix:semicolon
)brace
)brace
id|act-&gt;next
op_assign
l_int|NULL
suffix:semicolon
op_star
id|ap
op_assign
id|act
suffix:semicolon
id|write_unlock
c_func
(paren
op_amp
id|act_mod_lock
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|tcf_unregister_action
r_int
id|tcf_unregister_action
c_func
(paren
r_struct
id|tc_action_ops
op_star
id|act
)paren
(brace
r_struct
id|tc_action_ops
op_star
id|a
comma
op_star
op_star
id|ap
suffix:semicolon
r_int
id|err
op_assign
op_minus
id|ENOENT
suffix:semicolon
id|write_lock
c_func
(paren
op_amp
id|act_mod_lock
)paren
suffix:semicolon
r_for
c_loop
(paren
id|ap
op_assign
op_amp
id|act_base
suffix:semicolon
(paren
id|a
op_assign
op_star
id|ap
)paren
op_ne
l_int|NULL
suffix:semicolon
id|ap
op_assign
op_amp
id|a-&gt;next
)paren
r_if
c_cond
(paren
id|a
op_eq
id|act
)paren
(brace
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|a
)paren
(brace
op_star
id|ap
op_assign
id|a-&gt;next
suffix:semicolon
id|a-&gt;next
op_assign
l_int|NULL
suffix:semicolon
id|err
op_assign
l_int|0
suffix:semicolon
)brace
id|write_unlock
c_func
(paren
op_amp
id|act_mod_lock
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
multiline_comment|/* lookup by name */
DECL|function|tc_lookup_action_n
r_static
r_struct
id|tc_action_ops
op_star
id|tc_lookup_action_n
c_func
(paren
r_char
op_star
id|kind
)paren
(brace
r_struct
id|tc_action_ops
op_star
id|a
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
id|kind
)paren
(brace
id|read_lock
c_func
(paren
op_amp
id|act_mod_lock
)paren
suffix:semicolon
r_for
c_loop
(paren
id|a
op_assign
id|act_base
suffix:semicolon
id|a
suffix:semicolon
id|a
op_assign
id|a-&gt;next
)paren
(brace
r_if
c_cond
(paren
id|strcmp
c_func
(paren
id|kind
comma
id|a-&gt;kind
)paren
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|try_module_get
c_func
(paren
id|a-&gt;owner
)paren
)paren
(brace
id|read_unlock
c_func
(paren
op_amp
id|act_mod_lock
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
r_break
suffix:semicolon
)brace
)brace
id|read_unlock
c_func
(paren
op_amp
id|act_mod_lock
)paren
suffix:semicolon
)brace
r_return
id|a
suffix:semicolon
)brace
multiline_comment|/* lookup by rtattr */
DECL|function|tc_lookup_action
r_static
r_struct
id|tc_action_ops
op_star
id|tc_lookup_action
c_func
(paren
r_struct
id|rtattr
op_star
id|kind
)paren
(brace
r_struct
id|tc_action_ops
op_star
id|a
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
id|kind
)paren
(brace
id|read_lock
c_func
(paren
op_amp
id|act_mod_lock
)paren
suffix:semicolon
r_for
c_loop
(paren
id|a
op_assign
id|act_base
suffix:semicolon
id|a
suffix:semicolon
id|a
op_assign
id|a-&gt;next
)paren
(brace
r_if
c_cond
(paren
id|strcmp
c_func
(paren
(paren
r_char
op_star
)paren
id|RTA_DATA
c_func
(paren
id|kind
)paren
comma
id|a-&gt;kind
)paren
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|try_module_get
c_func
(paren
id|a-&gt;owner
)paren
)paren
(brace
id|read_unlock
c_func
(paren
op_amp
id|act_mod_lock
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
r_break
suffix:semicolon
)brace
)brace
id|read_unlock
c_func
(paren
op_amp
id|act_mod_lock
)paren
suffix:semicolon
)brace
r_return
id|a
suffix:semicolon
)brace
macro_line|#if 0
multiline_comment|/* lookup by id */
r_static
r_struct
id|tc_action_ops
op_star
id|tc_lookup_action_id
c_func
(paren
id|u32
id|type
)paren
(brace
r_struct
id|tc_action_ops
op_star
id|a
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
id|type
)paren
(brace
id|read_lock
c_func
(paren
op_amp
id|act_mod_lock
)paren
suffix:semicolon
r_for
c_loop
(paren
id|a
op_assign
id|act_base
suffix:semicolon
id|a
suffix:semicolon
id|a
op_assign
id|a-&gt;next
)paren
(brace
r_if
c_cond
(paren
id|a-&gt;type
op_eq
id|type
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|try_module_get
c_func
(paren
id|a-&gt;owner
)paren
)paren
(brace
id|read_unlock
c_func
(paren
op_amp
id|act_mod_lock
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
r_break
suffix:semicolon
)brace
)brace
id|read_unlock
c_func
(paren
op_amp
id|act_mod_lock
)paren
suffix:semicolon
)brace
r_return
id|a
suffix:semicolon
)brace
macro_line|#endif
DECL|function|tcf_action_exec
r_int
id|tcf_action_exec
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|tc_action
op_star
id|act
comma
r_struct
id|tcf_result
op_star
id|res
)paren
(brace
r_struct
id|tc_action
op_star
id|a
suffix:semicolon
r_int
id|ret
op_assign
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|skb-&gt;tc_verd
op_amp
id|TC_NCLS
)paren
(brace
id|skb-&gt;tc_verd
op_assign
id|CLR_TC_NCLS
c_func
(paren
id|skb-&gt;tc_verd
)paren
suffix:semicolon
id|D2PRINTK
c_func
(paren
l_string|&quot;(%p)tcf_action_exec: cleared TC_NCLS in %s out %s&bslash;n&quot;
comma
id|skb
comma
id|skb-&gt;input_dev
ques
c_cond
id|skb-&gt;input_dev-&gt;name
suffix:colon
l_string|&quot;xxx&quot;
comma
id|skb-&gt;dev-&gt;name
)paren
suffix:semicolon
id|ret
op_assign
id|TC_ACT_OK
suffix:semicolon
r_goto
id|exec_done
suffix:semicolon
)brace
r_while
c_loop
(paren
(paren
id|a
op_assign
id|act
)paren
op_ne
l_int|NULL
)paren
(brace
id|repeat
suffix:colon
r_if
c_cond
(paren
id|a-&gt;ops
op_logical_and
id|a-&gt;ops-&gt;act
)paren
(brace
id|ret
op_assign
id|a-&gt;ops
op_member_access_from_pointer
id|act
c_func
(paren
op_amp
id|skb
comma
id|a
)paren
suffix:semicolon
r_if
c_cond
(paren
id|TC_MUNGED
op_amp
id|skb-&gt;tc_verd
)paren
(brace
multiline_comment|/* copied already, allow trampling */
id|skb-&gt;tc_verd
op_assign
id|SET_TC_OK2MUNGE
c_func
(paren
id|skb-&gt;tc_verd
)paren
suffix:semicolon
id|skb-&gt;tc_verd
op_assign
id|CLR_TC_MUNGED
c_func
(paren
id|skb-&gt;tc_verd
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ret
op_ne
id|TC_ACT_PIPE
)paren
r_goto
id|exec_done
suffix:semicolon
r_if
c_cond
(paren
id|ret
op_eq
id|TC_ACT_REPEAT
)paren
r_goto
id|repeat
suffix:semicolon
multiline_comment|/* we need a ttl - JHS */
)brace
id|act
op_assign
id|a-&gt;next
suffix:semicolon
)brace
id|exec_done
suffix:colon
r_if
c_cond
(paren
id|skb-&gt;tc_classid
OG
l_int|0
)paren
(brace
id|res-&gt;classid
op_assign
id|skb-&gt;tc_classid
suffix:semicolon
id|res
op_member_access_from_pointer
r_class
op_assign
l_int|0
suffix:semicolon
id|skb-&gt;tc_classid
op_assign
l_int|0
suffix:semicolon
)brace
r_return
id|ret
suffix:semicolon
)brace
DECL|function|tcf_action_destroy
r_void
id|tcf_action_destroy
c_func
(paren
r_struct
id|tc_action
op_star
id|act
comma
r_int
id|bind
)paren
(brace
r_struct
id|tc_action
op_star
id|a
suffix:semicolon
r_for
c_loop
(paren
id|a
op_assign
id|act
suffix:semicolon
id|act
suffix:semicolon
id|a
op_assign
id|act
)paren
(brace
r_if
c_cond
(paren
id|a
op_logical_and
id|a-&gt;ops
op_logical_and
id|a-&gt;ops-&gt;cleanup
)paren
(brace
id|DPRINTK
c_func
(paren
l_string|&quot;tcf_action_destroy destroying %p next %p&bslash;n&quot;
comma
id|a
comma
id|a-&gt;next
ques
c_cond
id|a-&gt;next
suffix:colon
l_int|NULL
)paren
suffix:semicolon
id|act
op_assign
id|act-&gt;next
suffix:semicolon
r_if
c_cond
(paren
id|ACT_P_DELETED
op_eq
id|a-&gt;ops
op_member_access_from_pointer
id|cleanup
c_func
(paren
id|a
comma
id|bind
)paren
)paren
(brace
id|module_put
c_func
(paren
id|a-&gt;ops-&gt;owner
)paren
suffix:semicolon
)brace
id|a-&gt;ops
op_assign
l_int|NULL
suffix:semicolon
id|kfree
c_func
(paren
id|a
)paren
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/*FIXME: Remove later - catch insertion bugs*/
id|printk
c_func
(paren
l_string|&quot;tcf_action_destroy: BUG? destroying NULL ops &bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|a
)paren
(brace
id|act
op_assign
id|act-&gt;next
suffix:semicolon
id|kfree
c_func
(paren
id|a
)paren
suffix:semicolon
)brace
r_else
(brace
id|printk
c_func
(paren
l_string|&quot;tcf_action_destroy: BUG? destroying NULL action! &bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
)brace
)brace
DECL|function|tcf_action_dump_old
r_int
id|tcf_action_dump_old
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|tc_action
op_star
id|a
comma
r_int
id|bind
comma
r_int
id|ref
)paren
(brace
r_int
id|err
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
(paren
l_int|NULL
op_eq
id|a
)paren
op_logical_or
(paren
l_int|NULL
op_eq
id|a-&gt;ops
)paren
op_logical_or
(paren
l_int|NULL
op_eq
id|a-&gt;ops-&gt;dump
)paren
)paren
r_return
id|err
suffix:semicolon
r_return
id|a-&gt;ops
op_member_access_from_pointer
id|dump
c_func
(paren
id|skb
comma
id|a
comma
id|bind
comma
id|ref
)paren
suffix:semicolon
)brace
DECL|function|tcf_action_dump_1
r_int
id|tcf_action_dump_1
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|tc_action
op_star
id|a
comma
r_int
id|bind
comma
r_int
id|ref
)paren
(brace
r_int
id|err
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_int
r_char
op_star
id|b
op_assign
id|skb-&gt;tail
suffix:semicolon
r_struct
id|rtattr
op_star
id|r
suffix:semicolon
r_if
c_cond
(paren
(paren
l_int|NULL
op_eq
id|a
)paren
op_logical_or
(paren
l_int|NULL
op_eq
id|a-&gt;ops
)paren
op_logical_or
(paren
l_int|NULL
op_eq
id|a-&gt;ops-&gt;dump
)paren
op_logical_or
(paren
l_int|NULL
op_eq
id|a-&gt;ops-&gt;kind
)paren
)paren
r_return
id|err
suffix:semicolon
id|RTA_PUT
c_func
(paren
id|skb
comma
id|TCA_KIND
comma
id|IFNAMSIZ
comma
id|a-&gt;ops-&gt;kind
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tcf_action_copy_stats
c_func
(paren
id|skb
comma
id|a
)paren
)paren
r_goto
id|rtattr_failure
suffix:semicolon
id|r
op_assign
(paren
r_struct
id|rtattr
op_star
)paren
id|skb-&gt;tail
suffix:semicolon
id|RTA_PUT
c_func
(paren
id|skb
comma
id|TCA_OPTIONS
comma
l_int|0
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|tcf_action_dump_old
c_func
(paren
id|skb
comma
id|a
comma
id|bind
comma
id|ref
)paren
)paren
OG
l_int|0
)paren
(brace
id|r-&gt;rta_len
op_assign
id|skb-&gt;tail
op_minus
(paren
id|u8
op_star
)paren
id|r
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
id|rtattr_failure
suffix:colon
id|skb_trim
c_func
(paren
id|skb
comma
id|b
op_minus
id|skb-&gt;data
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
DECL|function|tcf_action_dump
r_int
id|tcf_action_dump
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|tc_action
op_star
id|act
comma
r_int
id|bind
comma
r_int
id|ref
)paren
(brace
r_struct
id|tc_action
op_star
id|a
suffix:semicolon
r_int
id|err
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_int
r_char
op_star
id|b
op_assign
id|skb-&gt;tail
suffix:semicolon
r_struct
id|rtattr
op_star
id|r
suffix:semicolon
r_while
c_loop
(paren
(paren
id|a
op_assign
id|act
)paren
op_ne
l_int|NULL
)paren
(brace
id|r
op_assign
(paren
r_struct
id|rtattr
op_star
)paren
id|skb-&gt;tail
suffix:semicolon
id|act
op_assign
id|a-&gt;next
suffix:semicolon
id|RTA_PUT
c_func
(paren
id|skb
comma
id|a-&gt;order
comma
l_int|0
comma
l_int|NULL
)paren
suffix:semicolon
id|err
op_assign
id|tcf_action_dump_1
c_func
(paren
id|skb
comma
id|a
comma
id|bind
comma
id|ref
)paren
suffix:semicolon
r_if
c_cond
(paren
l_int|0
OG
id|err
)paren
r_goto
id|rtattr_failure
suffix:semicolon
id|r-&gt;rta_len
op_assign
id|skb-&gt;tail
op_minus
(paren
id|u8
op_star
)paren
id|r
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
id|rtattr_failure
suffix:colon
id|skb_trim
c_func
(paren
id|skb
comma
id|b
op_minus
id|skb-&gt;data
)paren
suffix:semicolon
r_return
op_minus
id|err
suffix:semicolon
)brace
DECL|function|tcf_action_init_1
r_int
id|tcf_action_init_1
c_func
(paren
r_struct
id|rtattr
op_star
id|rta
comma
r_struct
id|rtattr
op_star
id|est
comma
r_struct
id|tc_action
op_star
id|a
comma
r_char
op_star
id|name
comma
r_int
id|ovr
comma
r_int
id|bind
)paren
(brace
r_struct
id|tc_action_ops
op_star
id|a_o
suffix:semicolon
r_char
id|act_name
(braket
l_int|4
op_plus
id|IFNAMSIZ
op_plus
l_int|1
)braket
suffix:semicolon
r_struct
id|rtattr
op_star
id|tb
(braket
id|TCA_ACT_MAX
op_plus
l_int|1
)braket
suffix:semicolon
r_struct
id|rtattr
op_star
id|kind
op_assign
l_int|NULL
suffix:semicolon
r_int
id|err
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
l_int|NULL
op_eq
id|name
)paren
(brace
r_if
c_cond
(paren
id|rtattr_parse
c_func
(paren
id|tb
comma
id|TCA_ACT_MAX
comma
id|RTA_DATA
c_func
(paren
id|rta
)paren
comma
id|RTA_PAYLOAD
c_func
(paren
id|rta
)paren
)paren
OL
l_int|0
)paren
r_goto
id|err_out
suffix:semicolon
id|kind
op_assign
id|tb
(braket
id|TCA_ACT_KIND
op_minus
l_int|1
)braket
suffix:semicolon
r_if
c_cond
(paren
l_int|NULL
op_ne
id|kind
)paren
(brace
id|sprintf
c_func
(paren
id|act_name
comma
l_string|&quot;%s&quot;
comma
(paren
r_char
op_star
)paren
id|RTA_DATA
c_func
(paren
id|kind
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|RTA_PAYLOAD
c_func
(paren
id|kind
)paren
op_ge
id|IFNAMSIZ
)paren
(brace
id|printk
c_func
(paren
l_string|&quot; Action %s bad&bslash;n&quot;
comma
(paren
r_char
op_star
)paren
id|RTA_DATA
c_func
(paren
id|kind
)paren
)paren
suffix:semicolon
r_goto
id|err_out
suffix:semicolon
)brace
)brace
r_else
(brace
id|printk
c_func
(paren
l_string|&quot;Action bad kind&bslash;n&quot;
)paren
suffix:semicolon
r_goto
id|err_out
suffix:semicolon
)brace
id|a_o
op_assign
id|tc_lookup_action
c_func
(paren
id|kind
)paren
suffix:semicolon
)brace
r_else
(brace
id|sprintf
c_func
(paren
id|act_name
comma
l_string|&quot;%s&quot;
comma
id|name
)paren
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;tcf_action_init_1: finding  %s&bslash;n&quot;
comma
id|act_name
)paren
suffix:semicolon
id|a_o
op_assign
id|tc_lookup_action_n
c_func
(paren
id|name
)paren
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_KMOD
r_if
c_cond
(paren
l_int|NULL
op_eq
id|a_o
)paren
(brace
id|DPRINTK
c_func
(paren
l_string|&quot;tcf_action_init_1: trying to load module %s&bslash;n&quot;
comma
id|act_name
)paren
suffix:semicolon
id|request_module
(paren
id|act_name
)paren
suffix:semicolon
id|a_o
op_assign
id|tc_lookup_action_n
c_func
(paren
id|act_name
)paren
suffix:semicolon
)brace
macro_line|#endif
r_if
c_cond
(paren
l_int|NULL
op_eq
id|a_o
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;failed to find %s&bslash;n&quot;
comma
id|act_name
)paren
suffix:semicolon
r_goto
id|err_out
suffix:semicolon
)brace
r_if
c_cond
(paren
l_int|NULL
op_eq
id|a
)paren
(brace
r_goto
id|err_mod
suffix:semicolon
)brace
multiline_comment|/* backward compatibility for policer */
r_if
c_cond
(paren
l_int|NULL
op_eq
id|name
)paren
(brace
id|err
op_assign
id|a_o
op_member_access_from_pointer
id|init
c_func
(paren
id|tb
(braket
id|TCA_ACT_OPTIONS
op_minus
l_int|1
)braket
comma
id|est
comma
id|a
comma
id|ovr
comma
id|bind
)paren
suffix:semicolon
r_if
c_cond
(paren
l_int|0
OG
id|err
)paren
(brace
id|err
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_goto
id|err_mod
suffix:semicolon
)brace
)brace
r_else
(brace
id|err
op_assign
id|a_o
op_member_access_from_pointer
id|init
c_func
(paren
id|rta
comma
id|est
comma
id|a
comma
id|ovr
comma
id|bind
)paren
suffix:semicolon
r_if
c_cond
(paren
l_int|0
OG
id|err
)paren
(brace
id|err
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_goto
id|err_mod
suffix:semicolon
)brace
)brace
multiline_comment|/* module count goes up only when brand new policy is created&n;&t;   if it exists and is only bound to in a_o-&gt;init() then&n;           ACT_P_CREATED is not returned (a zero is).&n;        */
r_if
c_cond
(paren
id|ACT_P_CREATED
op_ne
id|err
)paren
(brace
id|module_put
c_func
(paren
id|a_o-&gt;owner
)paren
suffix:semicolon
)brace
id|a-&gt;ops
op_assign
id|a_o
suffix:semicolon
id|DPRINTK
c_func
(paren
l_string|&quot;tcf_action_init_1: successfull %s &bslash;n&quot;
comma
id|act_name
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
id|err_mod
suffix:colon
id|module_put
c_func
(paren
id|a_o-&gt;owner
)paren
suffix:semicolon
id|err_out
suffix:colon
r_return
id|err
suffix:semicolon
)brace
DECL|function|tcf_action_init
r_int
id|tcf_action_init
c_func
(paren
r_struct
id|rtattr
op_star
id|rta
comma
r_struct
id|rtattr
op_star
id|est
comma
r_struct
id|tc_action
op_star
id|a
comma
r_char
op_star
id|name
comma
r_int
id|ovr
comma
r_int
id|bind
)paren
(brace
r_struct
id|rtattr
op_star
id|tb
(braket
id|TCA_ACT_MAX_PRIO
op_plus
l_int|1
)braket
suffix:semicolon
r_int
id|i
suffix:semicolon
r_struct
id|tc_action
op_star
id|act
op_assign
id|a
comma
op_star
id|a_s
op_assign
id|a
suffix:semicolon
r_int
id|err
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|rtattr_parse
c_func
(paren
id|tb
comma
id|TCA_ACT_MAX_PRIO
comma
id|RTA_DATA
c_func
(paren
id|rta
)paren
comma
id|RTA_PAYLOAD
c_func
(paren
id|rta
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|TCA_ACT_MAX_PRIO
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|tb
(braket
id|i
)braket
)paren
(brace
r_if
c_cond
(paren
l_int|NULL
op_eq
id|act
)paren
(brace
id|act
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
op_star
id|act
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
l_int|NULL
op_eq
id|act
)paren
(brace
id|err
op_assign
op_minus
id|ENOMEM
suffix:semicolon
r_goto
id|bad_ret
suffix:semicolon
)brace
id|memset
c_func
(paren
id|act
comma
l_int|0
comma
r_sizeof
(paren
op_star
id|act
)paren
)paren
suffix:semicolon
)brace
id|act-&gt;next
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
l_int|0
OG
id|tcf_action_init_1
c_func
(paren
id|tb
(braket
id|i
)braket
comma
id|est
comma
id|act
comma
id|name
comma
id|ovr
comma
id|bind
)paren
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;Error processing action order %d&bslash;n&quot;
comma
id|i
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
id|act-&gt;order
op_assign
id|i
op_plus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|a_s
op_ne
id|act
)paren
(brace
id|a_s-&gt;next
op_assign
id|act
suffix:semicolon
id|a_s
op_assign
id|act
suffix:semicolon
)brace
id|act
op_assign
l_int|NULL
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
id|bad_ret
suffix:colon
id|tcf_action_destroy
c_func
(paren
id|a
comma
id|bind
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|function|tcf_action_copy_stats
r_int
id|tcf_action_copy_stats
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|tc_action
op_star
id|a
)paren
(brace
r_struct
id|gnet_dump
id|d
suffix:semicolon
r_struct
id|tcf_act_hdr
op_star
id|h
op_assign
id|a-&gt;priv
suffix:semicolon
macro_line|#ifdef CONFIG_KMOD
multiline_comment|/* place holder */
macro_line|#endif
r_if
c_cond
(paren
l_int|NULL
op_eq
id|h
)paren
r_goto
id|errout
suffix:semicolon
r_if
c_cond
(paren
id|gnet_stats_start_copy
c_func
(paren
id|skb
comma
id|TCA_ACT_STATS
comma
id|h-&gt;stats_lock
comma
op_amp
id|d
)paren
OL
l_int|0
)paren
r_goto
id|errout
suffix:semicolon
r_if
c_cond
(paren
l_int|NULL
op_ne
id|a-&gt;ops
op_logical_and
l_int|NULL
op_ne
id|a-&gt;ops-&gt;get_stats
)paren
r_if
c_cond
(paren
id|a-&gt;ops
op_member_access_from_pointer
id|get_stats
c_func
(paren
id|skb
comma
id|a
)paren
OL
l_int|0
)paren
r_goto
id|errout
suffix:semicolon
r_if
c_cond
(paren
id|gnet_stats_copy_basic
c_func
(paren
op_amp
id|d
comma
op_amp
id|h-&gt;bstats
)paren
OL
l_int|0
op_logical_or
macro_line|#ifdef CONFIG_NET_ESTIMATOR
id|gnet_stats_copy_rate_est
c_func
(paren
op_amp
id|d
comma
op_amp
id|h-&gt;rate_est
)paren
OL
l_int|0
op_logical_or
macro_line|#endif
id|gnet_stats_copy_queue
c_func
(paren
op_amp
id|d
comma
op_amp
id|h-&gt;qstats
)paren
OL
l_int|0
)paren
r_goto
id|errout
suffix:semicolon
r_if
c_cond
(paren
id|gnet_stats_finish_copy
c_func
(paren
op_amp
id|d
)paren
OL
l_int|0
)paren
r_goto
id|errout
suffix:semicolon
r_return
l_int|0
suffix:semicolon
id|errout
suffix:colon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_static
r_int
DECL|function|tca_get_fill
id|tca_get_fill
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|tc_action
op_star
id|a
comma
id|u32
id|pid
comma
id|u32
id|seq
comma
r_int
id|flags
comma
r_int
id|event
comma
r_int
id|bind
comma
r_int
id|ref
)paren
(brace
r_struct
id|tcamsg
op_star
id|t
suffix:semicolon
r_struct
id|nlmsghdr
op_star
id|nlh
suffix:semicolon
r_int
r_char
op_star
id|b
op_assign
id|skb-&gt;tail
suffix:semicolon
r_struct
id|rtattr
op_star
id|x
suffix:semicolon
id|nlh
op_assign
id|NLMSG_PUT
c_func
(paren
id|skb
comma
id|pid
comma
id|seq
comma
id|event
comma
r_sizeof
(paren
op_star
id|t
)paren
)paren
suffix:semicolon
id|nlh-&gt;nlmsg_flags
op_assign
id|flags
suffix:semicolon
id|t
op_assign
id|NLMSG_DATA
c_func
(paren
id|nlh
)paren
suffix:semicolon
id|t-&gt;tca_family
op_assign
id|AF_UNSPEC
suffix:semicolon
id|x
op_assign
(paren
r_struct
id|rtattr
op_star
)paren
id|skb-&gt;tail
suffix:semicolon
id|RTA_PUT
c_func
(paren
id|skb
comma
id|TCA_ACT_TAB
comma
l_int|0
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
l_int|0
OG
id|tcf_action_dump
c_func
(paren
id|skb
comma
id|a
comma
id|bind
comma
id|ref
)paren
)paren
(brace
r_goto
id|rtattr_failure
suffix:semicolon
)brace
id|x-&gt;rta_len
op_assign
id|skb-&gt;tail
op_minus
(paren
id|u8
op_star
)paren
id|x
suffix:semicolon
id|nlh-&gt;nlmsg_len
op_assign
id|skb-&gt;tail
op_minus
id|b
suffix:semicolon
r_return
id|skb-&gt;len
suffix:semicolon
id|rtattr_failure
suffix:colon
id|nlmsg_failure
suffix:colon
id|skb_trim
c_func
(paren
id|skb
comma
id|b
op_minus
id|skb-&gt;data
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
DECL|function|act_get_notify
r_static
r_int
id|act_get_notify
c_func
(paren
id|u32
id|pid
comma
r_struct
id|nlmsghdr
op_star
id|n
comma
r_struct
id|tc_action
op_star
id|a
comma
r_int
id|event
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
r_int
id|err
op_assign
l_int|0
suffix:semicolon
id|skb
op_assign
id|alloc_skb
c_func
(paren
id|NLMSG_GOODSIZE
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|skb
)paren
r_return
op_minus
id|ENOBUFS
suffix:semicolon
r_if
c_cond
(paren
id|tca_get_fill
c_func
(paren
id|skb
comma
id|a
comma
id|pid
comma
id|n-&gt;nlmsg_seq
comma
l_int|0
comma
id|event
comma
l_int|0
comma
l_int|0
)paren
op_le
l_int|0
)paren
(brace
id|kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|err
op_assign
id|netlink_unicast
c_func
(paren
id|rtnl
comma
id|skb
comma
id|pid
comma
id|MSG_DONTWAIT
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OG
l_int|0
)paren
id|err
op_assign
l_int|0
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|function|tcf_action_get_1
r_static
r_int
id|tcf_action_get_1
c_func
(paren
r_struct
id|rtattr
op_star
id|rta
comma
r_struct
id|tc_action
op_star
id|a
comma
r_struct
id|nlmsghdr
op_star
id|n
comma
id|u32
id|pid
)paren
(brace
r_struct
id|tc_action_ops
op_star
id|a_o
suffix:semicolon
r_char
id|act_name
(braket
l_int|4
op_plus
id|IFNAMSIZ
op_plus
l_int|1
)braket
suffix:semicolon
r_struct
id|rtattr
op_star
id|tb
(braket
id|TCA_ACT_MAX
op_plus
l_int|1
)braket
suffix:semicolon
r_struct
id|rtattr
op_star
id|kind
op_assign
l_int|NULL
suffix:semicolon
r_int
id|index
suffix:semicolon
r_int
id|err
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|rtattr_parse
c_func
(paren
id|tb
comma
id|TCA_ACT_MAX
comma
id|RTA_DATA
c_func
(paren
id|rta
)paren
comma
id|RTA_PAYLOAD
c_func
(paren
id|rta
)paren
)paren
OL
l_int|0
)paren
r_goto
id|err_out
suffix:semicolon
id|kind
op_assign
id|tb
(braket
id|TCA_ACT_KIND
op_minus
l_int|1
)braket
suffix:semicolon
r_if
c_cond
(paren
l_int|NULL
op_ne
id|kind
)paren
(brace
id|sprintf
c_func
(paren
id|act_name
comma
l_string|&quot;%s&quot;
comma
(paren
r_char
op_star
)paren
id|RTA_DATA
c_func
(paren
id|kind
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|RTA_PAYLOAD
c_func
(paren
id|kind
)paren
op_ge
id|IFNAMSIZ
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;tcf_action_get_1: action %s bad&bslash;n&quot;
comma
(paren
r_char
op_star
)paren
id|RTA_DATA
c_func
(paren
id|kind
)paren
)paren
suffix:semicolon
r_goto
id|err_out
suffix:semicolon
)brace
)brace
r_else
(brace
id|printk
c_func
(paren
l_string|&quot;tcf_action_get_1: action bad kind&bslash;n&quot;
)paren
suffix:semicolon
r_goto
id|err_out
suffix:semicolon
)brace
r_if
c_cond
(paren
id|tb
(braket
id|TCA_ACT_INDEX
op_minus
l_int|1
)braket
)paren
(brace
id|index
op_assign
op_star
(paren
r_int
op_star
)paren
id|RTA_DATA
c_func
(paren
id|tb
(braket
id|TCA_ACT_INDEX
op_minus
l_int|1
)braket
)paren
suffix:semicolon
)brace
r_else
(brace
id|printk
c_func
(paren
l_string|&quot;tcf_action_get_1: index not received&bslash;n&quot;
)paren
suffix:semicolon
r_goto
id|err_out
suffix:semicolon
)brace
id|a_o
op_assign
id|tc_lookup_action
c_func
(paren
id|kind
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_KMOD
r_if
c_cond
(paren
l_int|NULL
op_eq
id|a_o
)paren
(brace
id|request_module
(paren
id|act_name
)paren
suffix:semicolon
id|a_o
op_assign
id|tc_lookup_action_n
c_func
(paren
id|act_name
)paren
suffix:semicolon
)brace
macro_line|#endif
r_if
c_cond
(paren
l_int|NULL
op_eq
id|a_o
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;failed to find %s&bslash;n&quot;
comma
id|act_name
)paren
suffix:semicolon
r_goto
id|err_out
suffix:semicolon
)brace
r_if
c_cond
(paren
l_int|NULL
op_eq
id|a
)paren
(brace
r_goto
id|err_mod
suffix:semicolon
)brace
id|a-&gt;ops
op_assign
id|a_o
suffix:semicolon
r_if
c_cond
(paren
l_int|NULL
op_eq
id|a_o-&gt;lookup
op_logical_or
l_int|0
op_eq
id|a_o
op_member_access_from_pointer
id|lookup
c_func
(paren
id|a
comma
id|index
)paren
)paren
(brace
id|a-&gt;ops
op_assign
l_int|NULL
suffix:semicolon
id|err
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_goto
id|err_mod
suffix:semicolon
)brace
id|module_put
c_func
(paren
id|a_o-&gt;owner
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
id|err_mod
suffix:colon
id|module_put
c_func
(paren
id|a_o-&gt;owner
)paren
suffix:semicolon
id|err_out
suffix:colon
r_return
id|err
suffix:semicolon
)brace
DECL|function|cleanup_a
r_static
r_void
id|cleanup_a
(paren
r_struct
id|tc_action
op_star
id|act
)paren
(brace
r_struct
id|tc_action
op_star
id|a
suffix:semicolon
r_for
c_loop
(paren
id|a
op_assign
id|act
suffix:semicolon
id|act
suffix:semicolon
id|a
op_assign
id|act
)paren
(brace
r_if
c_cond
(paren
id|a
)paren
(brace
id|act
op_assign
id|act-&gt;next
suffix:semicolon
id|a-&gt;ops
op_assign
l_int|NULL
suffix:semicolon
id|a-&gt;priv
op_assign
l_int|NULL
suffix:semicolon
id|kfree
c_func
(paren
id|a
)paren
suffix:semicolon
)brace
r_else
(brace
id|printk
c_func
(paren
l_string|&quot;cleanup_a: BUG? empty action&bslash;n&quot;
)paren
suffix:semicolon
)brace
)brace
)brace
DECL|function|get_ao
r_static
r_struct
id|tc_action_ops
op_star
id|get_ao
c_func
(paren
r_struct
id|rtattr
op_star
id|kind
comma
r_struct
id|tc_action
op_star
id|a
)paren
(brace
r_char
id|act_name
(braket
l_int|4
op_plus
id|IFNAMSIZ
op_plus
l_int|1
)braket
suffix:semicolon
r_struct
id|tc_action_ops
op_star
id|a_o
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
l_int|NULL
op_ne
id|kind
)paren
(brace
id|sprintf
c_func
(paren
id|act_name
comma
l_string|&quot;%s&quot;
comma
(paren
r_char
op_star
)paren
id|RTA_DATA
c_func
(paren
id|kind
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|RTA_PAYLOAD
c_func
(paren
id|kind
)paren
op_ge
id|IFNAMSIZ
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;get_ao: action %s bad&bslash;n&quot;
comma
(paren
r_char
op_star
)paren
id|RTA_DATA
c_func
(paren
id|kind
)paren
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
)brace
r_else
(brace
id|printk
c_func
(paren
l_string|&quot;get_ao: action bad kind&bslash;n&quot;
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
id|a_o
op_assign
id|tc_lookup_action
c_func
(paren
id|kind
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_KMOD
r_if
c_cond
(paren
l_int|NULL
op_eq
id|a_o
)paren
(brace
id|DPRINTK
c_func
(paren
l_string|&quot;get_ao: trying to load module %s&bslash;n&quot;
comma
id|act_name
)paren
suffix:semicolon
id|request_module
(paren
id|act_name
)paren
suffix:semicolon
id|a_o
op_assign
id|tc_lookup_action_n
c_func
(paren
id|act_name
)paren
suffix:semicolon
)brace
macro_line|#endif
r_if
c_cond
(paren
l_int|NULL
op_eq
id|a_o
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;get_ao: failed to find %s&bslash;n&quot;
comma
id|act_name
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
id|a-&gt;ops
op_assign
id|a_o
suffix:semicolon
r_return
id|a_o
suffix:semicolon
)brace
DECL|function|create_a
r_static
r_struct
id|tc_action
op_star
id|create_a
c_func
(paren
r_int
id|i
)paren
(brace
r_struct
id|tc_action
op_star
id|act
op_assign
l_int|NULL
suffix:semicolon
id|act
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
op_star
id|act
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
l_int|NULL
op_eq
id|act
)paren
(brace
multiline_comment|/* grrr .. */
id|printk
c_func
(paren
l_string|&quot;create_a: failed to alloc! &bslash;n&quot;
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
id|memset
c_func
(paren
id|act
comma
l_int|0
comma
r_sizeof
(paren
op_star
id|act
)paren
)paren
suffix:semicolon
id|act-&gt;order
op_assign
id|i
suffix:semicolon
r_return
id|act
suffix:semicolon
)brace
DECL|function|tca_action_flush
r_static
r_int
id|tca_action_flush
c_func
(paren
r_struct
id|rtattr
op_star
id|rta
comma
r_struct
id|nlmsghdr
op_star
id|n
comma
id|u32
id|pid
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
r_int
r_char
op_star
id|b
suffix:semicolon
r_struct
id|nlmsghdr
op_star
id|nlh
suffix:semicolon
r_struct
id|tcamsg
op_star
id|t
suffix:semicolon
r_struct
id|netlink_callback
id|dcb
suffix:semicolon
r_struct
id|rtattr
op_star
id|x
suffix:semicolon
r_struct
id|rtattr
op_star
id|tb
(braket
id|TCA_ACT_MAX
op_plus
l_int|1
)braket
suffix:semicolon
r_struct
id|rtattr
op_star
id|kind
op_assign
l_int|NULL
suffix:semicolon
r_struct
id|tc_action
op_star
id|a
op_assign
id|create_a
c_func
(paren
l_int|0
)paren
suffix:semicolon
r_int
id|err
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
l_int|NULL
op_eq
id|a
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;tca_action_flush: couldnt create tc_action&bslash;n&quot;
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
id|skb
op_assign
id|alloc_skb
c_func
(paren
id|NLMSG_GOODSIZE
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|skb
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;tca_action_flush: failed skb alloc&bslash;n&quot;
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|a
)paren
suffix:semicolon
r_return
op_minus
id|ENOBUFS
suffix:semicolon
)brace
id|b
op_assign
(paren
r_int
r_char
op_star
)paren
id|skb-&gt;tail
suffix:semicolon
r_if
c_cond
(paren
id|rtattr_parse
c_func
(paren
id|tb
comma
id|TCA_ACT_MAX
comma
id|RTA_DATA
c_func
(paren
id|rta
)paren
comma
id|RTA_PAYLOAD
c_func
(paren
id|rta
)paren
)paren
OL
l_int|0
)paren
(brace
r_goto
id|err_out
suffix:semicolon
)brace
id|kind
op_assign
id|tb
(braket
id|TCA_ACT_KIND
op_minus
l_int|1
)braket
suffix:semicolon
r_if
c_cond
(paren
l_int|NULL
op_eq
id|get_ao
c_func
(paren
id|kind
comma
id|a
)paren
)paren
(brace
r_goto
id|err_out
suffix:semicolon
)brace
id|nlh
op_assign
id|NLMSG_PUT
c_func
(paren
id|skb
comma
id|pid
comma
id|n-&gt;nlmsg_seq
comma
id|RTM_DELACTION
comma
r_sizeof
(paren
op_star
id|t
)paren
)paren
suffix:semicolon
id|t
op_assign
id|NLMSG_DATA
c_func
(paren
id|nlh
)paren
suffix:semicolon
id|t-&gt;tca_family
op_assign
id|AF_UNSPEC
suffix:semicolon
id|x
op_assign
(paren
r_struct
id|rtattr
op_star
)paren
id|skb-&gt;tail
suffix:semicolon
id|RTA_PUT
c_func
(paren
id|skb
comma
id|TCA_ACT_TAB
comma
l_int|0
comma
l_int|NULL
)paren
suffix:semicolon
id|err
op_assign
id|a-&gt;ops
op_member_access_from_pointer
id|walk
c_func
(paren
id|skb
comma
op_amp
id|dcb
comma
id|RTM_DELACTION
comma
id|a
)paren
suffix:semicolon
r_if
c_cond
(paren
l_int|0
OG
id|err
)paren
(brace
r_goto
id|rtattr_failure
suffix:semicolon
)brace
id|x-&gt;rta_len
op_assign
id|skb-&gt;tail
op_minus
(paren
id|u8
op_star
)paren
id|x
suffix:semicolon
id|nlh-&gt;nlmsg_len
op_assign
id|skb-&gt;tail
op_minus
id|b
suffix:semicolon
id|nlh-&gt;nlmsg_flags
op_or_assign
id|NLM_F_ROOT
suffix:semicolon
id|module_put
c_func
(paren
id|a-&gt;ops-&gt;owner
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|a
)paren
suffix:semicolon
id|err
op_assign
id|rtnetlink_send
c_func
(paren
id|skb
comma
id|pid
comma
id|RTMGRP_TC
comma
id|n-&gt;nlmsg_flags
op_amp
id|NLM_F_ECHO
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OG
l_int|0
)paren
r_return
l_int|0
suffix:semicolon
r_return
id|err
suffix:semicolon
id|rtattr_failure
suffix:colon
id|module_put
c_func
(paren
id|a-&gt;ops-&gt;owner
)paren
suffix:semicolon
id|nlmsg_failure
suffix:colon
id|err_out
suffix:colon
id|kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|a
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|function|tca_action_gd
r_static
r_int
id|tca_action_gd
c_func
(paren
r_struct
id|rtattr
op_star
id|rta
comma
r_struct
id|nlmsghdr
op_star
id|n
comma
id|u32
id|pid
comma
r_int
id|event
)paren
(brace
r_int
id|s
op_assign
l_int|0
suffix:semicolon
r_int
id|i
comma
id|ret
op_assign
l_int|0
suffix:semicolon
r_struct
id|tc_action
op_star
id|act
op_assign
l_int|NULL
suffix:semicolon
r_struct
id|rtattr
op_star
id|tb
(braket
id|TCA_ACT_MAX_PRIO
op_plus
l_int|1
)braket
suffix:semicolon
r_struct
id|tc_action
op_star
id|a
op_assign
l_int|NULL
comma
op_star
id|a_s
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
id|event
op_ne
id|RTM_GETACTION
op_logical_and
id|event
op_ne
id|RTM_DELACTION
)paren
id|ret
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|rtattr_parse
c_func
(paren
id|tb
comma
id|TCA_ACT_MAX_PRIO
comma
id|RTA_DATA
c_func
(paren
id|rta
)paren
comma
id|RTA_PAYLOAD
c_func
(paren
id|rta
)paren
)paren
OL
l_int|0
)paren
(brace
id|ret
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_goto
id|nlmsg_failure
suffix:semicolon
)brace
r_if
c_cond
(paren
id|event
op_eq
id|RTM_DELACTION
op_logical_and
id|n-&gt;nlmsg_flags
op_amp
id|NLM_F_ROOT
)paren
(brace
r_if
c_cond
(paren
l_int|NULL
op_ne
id|tb
(braket
l_int|0
)braket
op_logical_and
l_int|NULL
op_eq
id|tb
(braket
l_int|1
)braket
)paren
(brace
r_return
id|tca_action_flush
c_func
(paren
id|tb
(braket
l_int|0
)braket
comma
id|n
comma
id|pid
)paren
suffix:semicolon
)brace
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|TCA_ACT_MAX_PRIO
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
l_int|NULL
op_eq
id|tb
(braket
id|i
)braket
)paren
r_break
suffix:semicolon
id|act
op_assign
id|create_a
c_func
(paren
id|i
op_plus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
l_int|NULL
op_ne
id|a
op_logical_and
id|a
op_ne
id|act
)paren
(brace
id|a-&gt;next
op_assign
id|act
suffix:semicolon
id|a
op_assign
id|act
suffix:semicolon
)brace
r_else
(brace
id|a
op_assign
id|act
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|s
)paren
(brace
id|s
op_assign
l_int|1
suffix:semicolon
id|a_s
op_assign
id|a
suffix:semicolon
)brace
id|ret
op_assign
id|tcf_action_get_1
c_func
(paren
id|tb
(braket
id|i
)braket
comma
id|act
comma
id|n
comma
id|pid
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
OL
l_int|0
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;tcf_action_get: failed to get! &bslash;n&quot;
)paren
suffix:semicolon
id|ret
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_goto
id|rtattr_failure
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|RTM_GETACTION
op_eq
id|event
)paren
(brace
id|ret
op_assign
id|act_get_notify
c_func
(paren
id|pid
comma
id|n
comma
id|a_s
comma
id|event
)paren
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* delete */
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|skb
op_assign
id|alloc_skb
c_func
(paren
id|NLMSG_GOODSIZE
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|skb
)paren
(brace
id|ret
op_assign
op_minus
id|ENOBUFS
suffix:semicolon
r_goto
id|nlmsg_failure
suffix:semicolon
)brace
r_if
c_cond
(paren
id|tca_get_fill
c_func
(paren
id|skb
comma
id|a_s
comma
id|pid
comma
id|n-&gt;nlmsg_seq
comma
l_int|0
comma
id|event
comma
l_int|0
comma
l_int|1
)paren
op_le
l_int|0
)paren
(brace
id|kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
id|ret
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_goto
id|nlmsg_failure
suffix:semicolon
)brace
multiline_comment|/* now do the delete */
id|tcf_action_destroy
c_func
(paren
id|a_s
comma
l_int|0
)paren
suffix:semicolon
id|ret
op_assign
id|rtnetlink_send
c_func
(paren
id|skb
comma
id|pid
comma
id|RTMGRP_TC
comma
id|n-&gt;nlmsg_flags
op_amp
id|NLM_F_ECHO
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
OG
l_int|0
)paren
r_return
l_int|0
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
id|rtattr_failure
suffix:colon
id|nlmsg_failure
suffix:colon
id|cleanup_a
c_func
(paren
id|a_s
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
DECL|function|tcf_add_notify
r_static
r_int
id|tcf_add_notify
c_func
(paren
r_struct
id|tc_action
op_star
id|a
comma
id|u32
id|pid
comma
id|u32
id|seq
comma
r_int
id|event
comma
r_int
id|flags
)paren
(brace
r_struct
id|tcamsg
op_star
id|t
suffix:semicolon
r_struct
id|nlmsghdr
op_star
id|nlh
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
r_struct
id|rtattr
op_star
id|x
suffix:semicolon
r_int
r_char
op_star
id|b
suffix:semicolon
r_int
id|err
op_assign
l_int|0
suffix:semicolon
id|skb
op_assign
id|alloc_skb
c_func
(paren
id|NLMSG_GOODSIZE
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|skb
)paren
r_return
op_minus
id|ENOBUFS
suffix:semicolon
id|b
op_assign
(paren
r_int
r_char
op_star
)paren
id|skb-&gt;tail
suffix:semicolon
id|nlh
op_assign
id|NLMSG_PUT
c_func
(paren
id|skb
comma
id|pid
comma
id|seq
comma
id|event
comma
r_sizeof
(paren
op_star
id|t
)paren
)paren
suffix:semicolon
id|nlh-&gt;nlmsg_flags
op_assign
id|flags
suffix:semicolon
id|t
op_assign
id|NLMSG_DATA
c_func
(paren
id|nlh
)paren
suffix:semicolon
id|t-&gt;tca_family
op_assign
id|AF_UNSPEC
suffix:semicolon
id|x
op_assign
(paren
r_struct
id|rtattr
op_star
)paren
id|skb-&gt;tail
suffix:semicolon
id|RTA_PUT
c_func
(paren
id|skb
comma
id|TCA_ACT_TAB
comma
l_int|0
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
l_int|0
OG
id|tcf_action_dump
c_func
(paren
id|skb
comma
id|a
comma
l_int|0
comma
l_int|0
)paren
)paren
(brace
r_goto
id|rtattr_failure
suffix:semicolon
)brace
id|x-&gt;rta_len
op_assign
id|skb-&gt;tail
op_minus
(paren
id|u8
op_star
)paren
id|x
suffix:semicolon
id|nlh-&gt;nlmsg_len
op_assign
id|skb-&gt;tail
op_minus
id|b
suffix:semicolon
id|NETLINK_CB
c_func
(paren
id|skb
)paren
dot
id|dst_groups
op_assign
id|RTMGRP_TC
suffix:semicolon
id|err
op_assign
id|rtnetlink_send
c_func
(paren
id|skb
comma
id|pid
comma
id|RTMGRP_TC
comma
id|flags
op_amp
id|NLM_F_ECHO
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
OG
l_int|0
)paren
id|err
op_assign
l_int|0
suffix:semicolon
r_return
id|err
suffix:semicolon
id|rtattr_failure
suffix:colon
id|nlmsg_failure
suffix:colon
id|skb_trim
c_func
(paren
id|skb
comma
id|b
op_minus
id|skb-&gt;data
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
DECL|function|tcf_action_add
r_static
r_int
id|tcf_action_add
c_func
(paren
r_struct
id|rtattr
op_star
id|rta
comma
r_struct
id|nlmsghdr
op_star
id|n
comma
id|u32
id|pid
comma
r_int
id|ovr
)paren
(brace
r_int
id|ret
op_assign
l_int|0
suffix:semicolon
r_struct
id|tc_action
op_star
id|act
op_assign
l_int|NULL
suffix:semicolon
r_struct
id|tc_action
op_star
id|a
op_assign
l_int|NULL
suffix:semicolon
id|u32
id|seq
op_assign
id|n-&gt;nlmsg_seq
suffix:semicolon
id|act
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
op_star
id|act
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
l_int|NULL
op_eq
id|act
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|memset
c_func
(paren
id|act
comma
l_int|0
comma
r_sizeof
(paren
op_star
id|act
)paren
)paren
suffix:semicolon
id|ret
op_assign
id|tcf_action_init
c_func
(paren
id|rta
comma
l_int|NULL
comma
id|act
comma
l_int|NULL
comma
id|ovr
comma
l_int|0
)paren
suffix:semicolon
multiline_comment|/* NOTE: We have an all-or-none model&n;&t; * This means that of any of the actions fail&n;&t; * to update then all are undone.&n;&t; * */
r_if
c_cond
(paren
l_int|0
OG
id|ret
)paren
(brace
id|tcf_action_destroy
c_func
(paren
id|act
comma
l_int|0
)paren
suffix:semicolon
r_goto
id|done
suffix:semicolon
)brace
multiline_comment|/* dump then free all the actions after update; inserted policy&n;&t; * stays intact&n;&t; * */
id|ret
op_assign
id|tcf_add_notify
c_func
(paren
id|act
comma
id|pid
comma
id|seq
comma
id|RTM_NEWACTION
comma
id|n-&gt;nlmsg_flags
)paren
suffix:semicolon
r_for
c_loop
(paren
id|a
op_assign
id|act
suffix:semicolon
id|act
suffix:semicolon
id|a
op_assign
id|act
)paren
(brace
r_if
c_cond
(paren
id|a
)paren
(brace
id|act
op_assign
id|act-&gt;next
suffix:semicolon
id|a-&gt;ops
op_assign
l_int|NULL
suffix:semicolon
id|a-&gt;priv
op_assign
l_int|NULL
suffix:semicolon
id|kfree
c_func
(paren
id|a
)paren
suffix:semicolon
)brace
r_else
(brace
id|printk
c_func
(paren
l_string|&quot;tcf_action_add: BUG? empty action&bslash;n&quot;
)paren
suffix:semicolon
)brace
)brace
id|done
suffix:colon
r_return
id|ret
suffix:semicolon
)brace
DECL|function|tc_ctl_action
r_static
r_int
id|tc_ctl_action
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|nlmsghdr
op_star
id|n
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|rtattr
op_star
op_star
id|tca
op_assign
id|arg
suffix:semicolon
id|u32
id|pid
op_assign
id|skb
ques
c_cond
id|NETLINK_CB
c_func
(paren
id|skb
)paren
dot
id|pid
suffix:colon
l_int|0
suffix:semicolon
r_int
id|ret
op_assign
l_int|0
comma
id|ovr
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
l_int|NULL
op_eq
id|tca
(braket
id|TCA_ACT_TAB
op_minus
l_int|1
)braket
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;tc_ctl_action: received NO action attribs&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
multiline_comment|/* n-&gt;nlmsg_flags&amp;NLM_F_CREATE&n;&t; * */
r_switch
c_cond
(paren
id|n-&gt;nlmsg_type
)paren
(brace
r_case
id|RTM_NEWACTION
suffix:colon
multiline_comment|/* we are going to assume all other flags&n;&t;&t; * imply create only if it doesnt exist&n;&t;&t; * Note that CREATE | EXCL implies that&n;&t;&t; * but since we want avoid ambiguity (eg when flags&n;&t;&t; * is zero) then just set this&n;&t;&t; */
r_if
c_cond
(paren
id|n-&gt;nlmsg_flags
op_amp
id|NLM_F_REPLACE
)paren
(brace
id|ovr
op_assign
l_int|1
suffix:semicolon
)brace
id|ret
op_assign
id|tcf_action_add
c_func
(paren
id|tca
(braket
id|TCA_ACT_TAB
op_minus
l_int|1
)braket
comma
id|n
comma
id|pid
comma
id|ovr
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|RTM_DELACTION
suffix:colon
id|ret
op_assign
id|tca_action_gd
c_func
(paren
id|tca
(braket
id|TCA_ACT_TAB
op_minus
l_int|1
)braket
comma
id|n
comma
id|pid
comma
id|RTM_DELACTION
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|RTM_GETACTION
suffix:colon
id|ret
op_assign
id|tca_action_gd
c_func
(paren
id|tca
(braket
id|TCA_ACT_TAB
op_minus
l_int|1
)braket
comma
id|n
comma
id|pid
comma
id|RTM_GETACTION
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|printk
c_func
(paren
l_string|&quot; Unknown cmd was detected&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_return
id|ret
suffix:semicolon
)brace
r_static
r_char
op_star
DECL|function|find_dump_kind
id|find_dump_kind
c_func
(paren
r_struct
id|nlmsghdr
op_star
id|n
)paren
(brace
r_struct
id|rtattr
op_star
id|tb1
comma
op_star
id|tb2
(braket
id|TCA_ACT_MAX
op_plus
l_int|1
)braket
suffix:semicolon
r_struct
id|rtattr
op_star
id|tb
(braket
id|TCA_ACT_MAX_PRIO
op_plus
l_int|1
)braket
suffix:semicolon
r_struct
id|rtattr
op_star
id|rta
(braket
id|TCAA_MAX
op_plus
l_int|1
)braket
suffix:semicolon
r_struct
id|rtattr
op_star
id|kind
op_assign
l_int|NULL
suffix:semicolon
r_int
id|min_len
op_assign
id|NLMSG_LENGTH
c_func
(paren
r_sizeof
(paren
r_struct
id|tcamsg
)paren
)paren
suffix:semicolon
r_int
id|attrlen
op_assign
id|n-&gt;nlmsg_len
op_minus
id|NLMSG_ALIGN
c_func
(paren
id|min_len
)paren
suffix:semicolon
r_struct
id|rtattr
op_star
id|attr
op_assign
(paren
r_void
op_star
)paren
id|n
op_plus
id|NLMSG_ALIGN
c_func
(paren
id|min_len
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rtattr_parse
c_func
(paren
id|rta
comma
id|TCAA_MAX
comma
id|attr
comma
id|attrlen
)paren
OL
l_int|0
)paren
r_return
l_int|NULL
suffix:semicolon
id|tb1
op_assign
id|rta
(braket
id|TCA_ACT_TAB
op_minus
l_int|1
)braket
suffix:semicolon
r_if
c_cond
(paren
l_int|NULL
op_eq
id|tb1
)paren
(brace
r_return
l_int|NULL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|rtattr_parse
c_func
(paren
id|tb
comma
id|TCA_ACT_MAX_PRIO
comma
id|RTA_DATA
c_func
(paren
id|tb1
)paren
comma
id|NLMSG_ALIGN
c_func
(paren
id|RTA_PAYLOAD
c_func
(paren
id|tb1
)paren
)paren
)paren
OL
l_int|0
)paren
r_return
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
l_int|NULL
op_eq
id|tb
(braket
l_int|0
)braket
)paren
r_return
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
id|rtattr_parse
c_func
(paren
id|tb2
comma
id|TCA_ACT_MAX
comma
id|RTA_DATA
c_func
(paren
id|tb
(braket
l_int|0
)braket
)paren
comma
id|RTA_PAYLOAD
c_func
(paren
id|tb
(braket
l_int|0
)braket
)paren
)paren
OL
l_int|0
)paren
r_return
l_int|NULL
suffix:semicolon
id|kind
op_assign
id|tb2
(braket
id|TCA_ACT_KIND
op_minus
l_int|1
)braket
suffix:semicolon
r_return
(paren
r_char
op_star
)paren
id|RTA_DATA
c_func
(paren
id|kind
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|tc_dump_action
id|tc_dump_action
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|netlink_callback
op_star
id|cb
)paren
(brace
r_struct
id|nlmsghdr
op_star
id|nlh
suffix:semicolon
r_int
r_char
op_star
id|b
op_assign
id|skb-&gt;tail
suffix:semicolon
r_struct
id|rtattr
op_star
id|x
suffix:semicolon
r_struct
id|tc_action_ops
op_star
id|a_o
suffix:semicolon
r_struct
id|tc_action
id|a
suffix:semicolon
r_int
id|ret
op_assign
l_int|0
suffix:semicolon
r_struct
id|tcamsg
op_star
id|t
op_assign
(paren
r_struct
id|tcamsg
op_star
)paren
id|NLMSG_DATA
c_func
(paren
id|cb-&gt;nlh
)paren
suffix:semicolon
r_char
op_star
id|kind
op_assign
id|find_dump_kind
c_func
(paren
id|cb-&gt;nlh
)paren
suffix:semicolon
r_if
c_cond
(paren
l_int|NULL
op_eq
id|kind
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;tc_dump_action: action bad kind&bslash;n&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|a_o
op_assign
id|tc_lookup_action_n
c_func
(paren
id|kind
)paren
suffix:semicolon
r_if
c_cond
(paren
l_int|NULL
op_eq
id|a_o
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;failed to find %s&bslash;n&quot;
comma
id|kind
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|memset
c_func
(paren
op_amp
id|a
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|tc_action
)paren
)paren
suffix:semicolon
id|a.ops
op_assign
id|a_o
suffix:semicolon
r_if
c_cond
(paren
l_int|NULL
op_eq
id|a_o-&gt;walk
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;tc_dump_action: %s !capable of dumping table&bslash;n&quot;
comma
id|kind
)paren
suffix:semicolon
r_goto
id|rtattr_failure
suffix:semicolon
)brace
id|nlh
op_assign
id|NLMSG_PUT
c_func
(paren
id|skb
comma
id|NETLINK_CB
c_func
(paren
id|cb-&gt;skb
)paren
dot
id|pid
comma
id|cb-&gt;nlh-&gt;nlmsg_seq
comma
id|cb-&gt;nlh-&gt;nlmsg_type
comma
r_sizeof
(paren
op_star
id|t
)paren
)paren
suffix:semicolon
id|t
op_assign
id|NLMSG_DATA
c_func
(paren
id|nlh
)paren
suffix:semicolon
id|t-&gt;tca_family
op_assign
id|AF_UNSPEC
suffix:semicolon
id|x
op_assign
(paren
r_struct
id|rtattr
op_star
)paren
id|skb-&gt;tail
suffix:semicolon
id|RTA_PUT
c_func
(paren
id|skb
comma
id|TCA_ACT_TAB
comma
l_int|0
comma
l_int|NULL
)paren
suffix:semicolon
id|ret
op_assign
id|a_o
op_member_access_from_pointer
id|walk
c_func
(paren
id|skb
comma
id|cb
comma
id|RTM_GETACTION
comma
op_amp
id|a
)paren
suffix:semicolon
r_if
c_cond
(paren
l_int|0
OG
id|ret
)paren
(brace
r_goto
id|rtattr_failure
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ret
OG
l_int|0
)paren
(brace
id|x-&gt;rta_len
op_assign
id|skb-&gt;tail
op_minus
(paren
id|u8
op_star
)paren
id|x
suffix:semicolon
id|ret
op_assign
id|skb-&gt;len
suffix:semicolon
)brace
r_else
(brace
id|skb_trim
c_func
(paren
id|skb
comma
(paren
id|u8
op_star
)paren
id|x
op_minus
id|skb-&gt;data
)paren
suffix:semicolon
)brace
id|nlh-&gt;nlmsg_len
op_assign
id|skb-&gt;tail
op_minus
id|b
suffix:semicolon
r_if
c_cond
(paren
id|NETLINK_CB
c_func
(paren
id|cb-&gt;skb
)paren
dot
id|pid
op_logical_and
id|ret
)paren
id|nlh-&gt;nlmsg_flags
op_or_assign
id|NLM_F_MULTI
suffix:semicolon
id|module_put
c_func
(paren
id|a_o-&gt;owner
)paren
suffix:semicolon
r_return
id|skb-&gt;len
suffix:semicolon
id|rtattr_failure
suffix:colon
id|nlmsg_failure
suffix:colon
id|module_put
c_func
(paren
id|a_o-&gt;owner
)paren
suffix:semicolon
id|skb_trim
c_func
(paren
id|skb
comma
id|b
op_minus
id|skb-&gt;data
)paren
suffix:semicolon
r_return
id|skb-&gt;len
suffix:semicolon
)brace
DECL|function|tc_action_init
r_static
r_int
id|__init
id|tc_action_init
c_func
(paren
r_void
)paren
(brace
r_struct
id|rtnetlink_link
op_star
id|link_p
op_assign
id|rtnetlink_links
(braket
id|PF_UNSPEC
)braket
suffix:semicolon
r_if
c_cond
(paren
id|link_p
)paren
(brace
id|link_p
(braket
id|RTM_NEWACTION
op_minus
id|RTM_BASE
)braket
dot
id|doit
op_assign
id|tc_ctl_action
suffix:semicolon
id|link_p
(braket
id|RTM_DELACTION
op_minus
id|RTM_BASE
)braket
dot
id|doit
op_assign
id|tc_ctl_action
suffix:semicolon
id|link_p
(braket
id|RTM_GETACTION
op_minus
id|RTM_BASE
)braket
dot
id|doit
op_assign
id|tc_ctl_action
suffix:semicolon
id|link_p
(braket
id|RTM_GETACTION
op_minus
id|RTM_BASE
)braket
dot
id|dumpit
op_assign
id|tc_dump_action
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;TC classifier action (bugs to netdev@oss.sgi.com cc hadi@cyberus.ca)&bslash;n&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|tc_action_init
id|subsys_initcall
c_func
(paren
id|tc_action_init
)paren
suffix:semicolon
DECL|variable|tcf_register_action
id|EXPORT_SYMBOL
c_func
(paren
id|tcf_register_action
)paren
suffix:semicolon
DECL|variable|tcf_unregister_action
id|EXPORT_SYMBOL
c_func
(paren
id|tcf_unregister_action
)paren
suffix:semicolon
DECL|variable|tcf_action_init_1
id|EXPORT_SYMBOL
c_func
(paren
id|tcf_action_init_1
)paren
suffix:semicolon
DECL|variable|tcf_action_init
id|EXPORT_SYMBOL
c_func
(paren
id|tcf_action_init
)paren
suffix:semicolon
DECL|variable|tcf_action_destroy
id|EXPORT_SYMBOL
c_func
(paren
id|tcf_action_destroy
)paren
suffix:semicolon
DECL|variable|tcf_action_exec
id|EXPORT_SYMBOL
c_func
(paren
id|tcf_action_exec
)paren
suffix:semicolon
DECL|variable|tcf_action_copy_stats
id|EXPORT_SYMBOL
c_func
(paren
id|tcf_action_copy_stats
)paren
suffix:semicolon
DECL|variable|tcf_action_dump
id|EXPORT_SYMBOL
c_func
(paren
id|tcf_action_dump
)paren
suffix:semicolon
DECL|variable|tcf_action_dump_1
id|EXPORT_SYMBOL
c_func
(paren
id|tcf_action_dump_1
)paren
suffix:semicolon
DECL|variable|tcf_action_dump_old
id|EXPORT_SYMBOL
c_func
(paren
id|tcf_action_dump_old
)paren
suffix:semicolon
eof
