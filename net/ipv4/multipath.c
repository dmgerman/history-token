multiline_comment|/* multipath.c: IPV4 multipath algorithm support.&n; *&n; * Copyright (C) 2004, 2005 Einar Lueck &lt;elueck@de.ibm.com&gt;&n; * Copyright (C) 2005 David S. Miller &lt;davem@davemloft.net&gt;&n; */
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/errno.h&gt;
macro_line|#include &lt;linux/netdevice.h&gt;
macro_line|#include &lt;linux/spinlock.h&gt;
macro_line|#include &lt;net/ip_mp_alg.h&gt;
r_static
id|DEFINE_SPINLOCK
c_func
(paren
id|alg_table_lock
)paren
suffix:semicolon
DECL|variable|ip_mp_alg_table
r_struct
id|ip_mp_alg_ops
op_star
id|ip_mp_alg_table
(braket
id|IP_MP_ALG_MAX
op_plus
l_int|1
)braket
suffix:semicolon
DECL|function|multipath_alg_register
r_int
id|multipath_alg_register
c_func
(paren
r_struct
id|ip_mp_alg_ops
op_star
id|ops
comma
r_enum
id|ip_mp_alg
id|n
)paren
(brace
r_struct
id|ip_mp_alg_ops
op_star
op_star
id|slot
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
id|n
template_param
id|IP_MP_ALG_MAX
op_logical_or
op_logical_neg
id|ops-&gt;mp_alg_select_route
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|alg_table_lock
)paren
suffix:semicolon
id|slot
op_assign
op_amp
id|ip_mp_alg_table
(braket
id|n
)braket
suffix:semicolon
r_if
c_cond
(paren
op_star
id|slot
op_ne
l_int|NULL
)paren
(brace
id|err
op_assign
op_minus
id|EBUSY
suffix:semicolon
)brace
r_else
(brace
op_star
id|slot
op_assign
id|ops
suffix:semicolon
id|err
op_assign
l_int|0
suffix:semicolon
)brace
id|spin_unlock
c_func
(paren
op_amp
id|alg_table_lock
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|variable|multipath_alg_register
id|EXPORT_SYMBOL
c_func
(paren
id|multipath_alg_register
)paren
suffix:semicolon
DECL|function|multipath_alg_unregister
r_void
id|multipath_alg_unregister
c_func
(paren
r_struct
id|ip_mp_alg_ops
op_star
id|ops
comma
r_enum
id|ip_mp_alg
id|n
)paren
(brace
r_struct
id|ip_mp_alg_ops
op_star
op_star
id|slot
suffix:semicolon
r_if
c_cond
(paren
id|n
template_param
id|IP_MP_ALG_MAX
)paren
r_return
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|alg_table_lock
)paren
suffix:semicolon
id|slot
op_assign
op_amp
id|ip_mp_alg_table
(braket
id|n
)braket
suffix:semicolon
r_if
c_cond
(paren
op_star
id|slot
op_eq
id|ops
)paren
op_star
id|slot
op_assign
l_int|NULL
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|alg_table_lock
)paren
suffix:semicolon
id|synchronize_net
c_func
(paren
)paren
suffix:semicolon
)brace
DECL|variable|multipath_alg_unregister
id|EXPORT_SYMBOL
c_func
(paren
id|multipath_alg_unregister
)paren
suffix:semicolon
eof
