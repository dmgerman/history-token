multiline_comment|/* &n; * xfrm algorithm interface&n; *&n; * Copyright (c) 2002 James Morris &lt;jmorris@intercode.com.au&gt;&n; *&n; * This program is free software; you can redistribute it and/or modify it&n; * under the terms of the GNU General Public License as published by the Free&n; * Software Foundation; either version 2 of the License, or (at your option) &n; * any later version.&n; */
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/pfkeyv2.h&gt;
macro_line|#include &lt;net/xfrm.h&gt;
multiline_comment|/*&n; * Algorithms supported by IPsec.  These entries contain properties which&n; * are used in key negotiation and xfrm processing, and are used to verify&n; * that instantiated crypto transforms have correct parameters for IPsec&n; * purposes.&n; */
DECL|variable|aalg_list
r_static
r_struct
id|xfrm_algo_desc
id|aalg_list
(braket
)braket
op_assign
(brace
(brace
dot
id|name
op_assign
l_string|&quot;digest_null&quot;
comma
dot
id|uinfo
op_assign
(brace
dot
id|auth
op_assign
(brace
dot
id|icv_truncbits
op_assign
l_int|0
comma
dot
id|icv_fullbits
op_assign
l_int|0
comma
)brace
)brace
comma
dot
id|desc
op_assign
(brace
dot
id|sadb_alg_id
op_assign
id|SADB_X_AALG_NULL
comma
dot
id|sadb_alg_ivlen
op_assign
l_int|0
comma
dot
id|sadb_alg_minbits
op_assign
l_int|0
comma
dot
id|sadb_alg_maxbits
op_assign
l_int|0
)brace
)brace
comma
(brace
dot
id|name
op_assign
l_string|&quot;md5&quot;
comma
dot
id|uinfo
op_assign
(brace
dot
id|auth
op_assign
(brace
dot
id|icv_truncbits
op_assign
l_int|96
comma
dot
id|icv_fullbits
op_assign
l_int|128
comma
)brace
)brace
comma
dot
id|desc
op_assign
(brace
dot
id|sadb_alg_id
op_assign
id|SADB_AALG_MD5HMAC
comma
dot
id|sadb_alg_ivlen
op_assign
l_int|0
comma
dot
id|sadb_alg_minbits
op_assign
l_int|128
comma
dot
id|sadb_alg_maxbits
op_assign
l_int|128
)brace
)brace
comma
(brace
dot
id|name
op_assign
l_string|&quot;sha1&quot;
comma
dot
id|uinfo
op_assign
(brace
dot
id|auth
op_assign
(brace
dot
id|icv_truncbits
op_assign
l_int|96
comma
dot
id|icv_fullbits
op_assign
l_int|160
comma
)brace
)brace
comma
dot
id|desc
op_assign
(brace
dot
id|sadb_alg_id
op_assign
id|SADB_AALG_SHA1HMAC
comma
dot
id|sadb_alg_ivlen
op_assign
l_int|0
comma
dot
id|sadb_alg_minbits
op_assign
l_int|160
comma
dot
id|sadb_alg_maxbits
op_assign
l_int|160
)brace
)brace
comma
(brace
dot
id|name
op_assign
l_string|&quot;sha256&quot;
comma
dot
id|uinfo
op_assign
(brace
dot
id|auth
op_assign
(brace
dot
id|icv_truncbits
op_assign
l_int|128
comma
dot
id|icv_fullbits
op_assign
l_int|256
comma
)brace
)brace
comma
dot
id|desc
op_assign
(brace
dot
id|sadb_alg_id
op_assign
id|SADB_X_AALG_SHA2_256HMAC
comma
dot
id|sadb_alg_ivlen
op_assign
l_int|0
comma
dot
id|sadb_alg_minbits
op_assign
l_int|256
comma
dot
id|sadb_alg_maxbits
op_assign
l_int|256
)brace
)brace
comma
(brace
dot
id|name
op_assign
l_string|&quot;ripemd160&quot;
comma
dot
id|uinfo
op_assign
(brace
dot
id|auth
op_assign
(brace
dot
id|icv_truncbits
op_assign
l_int|96
comma
dot
id|icv_fullbits
op_assign
l_int|160
comma
)brace
)brace
comma
dot
id|desc
op_assign
(brace
dot
id|sadb_alg_id
op_assign
id|SADB_X_AALG_RIPEMD160HMAC
comma
dot
id|sadb_alg_ivlen
op_assign
l_int|0
comma
dot
id|sadb_alg_minbits
op_assign
l_int|160
comma
dot
id|sadb_alg_maxbits
op_assign
l_int|160
)brace
)brace
comma
)brace
suffix:semicolon
DECL|variable|ealg_list
r_static
r_struct
id|xfrm_algo_desc
id|ealg_list
(braket
)braket
op_assign
(brace
(brace
dot
id|name
op_assign
l_string|&quot;cipher_null&quot;
comma
dot
id|uinfo
op_assign
(brace
dot
id|encr
op_assign
(brace
dot
id|blockbits
op_assign
l_int|8
comma
dot
id|defkeybits
op_assign
l_int|0
comma
)brace
)brace
comma
dot
id|desc
op_assign
(brace
dot
id|sadb_alg_id
op_assign
id|SADB_EALG_NULL
comma
dot
id|sadb_alg_ivlen
op_assign
l_int|0
comma
dot
id|sadb_alg_minbits
op_assign
l_int|0
comma
dot
id|sadb_alg_maxbits
op_assign
l_int|0
)brace
)brace
comma
(brace
dot
id|name
op_assign
l_string|&quot;des&quot;
comma
dot
id|uinfo
op_assign
(brace
dot
id|encr
op_assign
(brace
dot
id|blockbits
op_assign
l_int|64
comma
dot
id|defkeybits
op_assign
l_int|64
comma
)brace
)brace
comma
dot
id|desc
op_assign
(brace
dot
id|sadb_alg_id
op_assign
id|SADB_EALG_DESCBC
comma
dot
id|sadb_alg_ivlen
op_assign
l_int|8
comma
dot
id|sadb_alg_minbits
op_assign
l_int|64
comma
dot
id|sadb_alg_maxbits
op_assign
l_int|64
)brace
)brace
comma
(brace
dot
id|name
op_assign
l_string|&quot;des3_ede&quot;
comma
dot
id|uinfo
op_assign
(brace
dot
id|encr
op_assign
(brace
dot
id|blockbits
op_assign
l_int|64
comma
dot
id|defkeybits
op_assign
l_int|192
comma
)brace
)brace
comma
dot
id|desc
op_assign
(brace
dot
id|sadb_alg_id
op_assign
id|SADB_EALG_3DESCBC
comma
dot
id|sadb_alg_ivlen
op_assign
l_int|8
comma
dot
id|sadb_alg_minbits
op_assign
l_int|192
comma
dot
id|sadb_alg_maxbits
op_assign
l_int|192
)brace
)brace
comma
(brace
dot
id|name
op_assign
l_string|&quot;cast128&quot;
comma
dot
id|uinfo
op_assign
(brace
dot
id|encr
op_assign
(brace
dot
id|blockbits
op_assign
l_int|64
comma
dot
id|defkeybits
op_assign
l_int|128
comma
)brace
)brace
comma
dot
id|desc
op_assign
(brace
dot
id|sadb_alg_id
op_assign
id|SADB_X_EALG_CASTCBC
comma
dot
id|sadb_alg_ivlen
op_assign
l_int|8
comma
dot
id|sadb_alg_minbits
op_assign
l_int|40
comma
dot
id|sadb_alg_maxbits
op_assign
l_int|128
)brace
)brace
comma
(brace
dot
id|name
op_assign
l_string|&quot;blowfish&quot;
comma
dot
id|uinfo
op_assign
(brace
dot
id|encr
op_assign
(brace
dot
id|blockbits
op_assign
l_int|64
comma
dot
id|defkeybits
op_assign
l_int|128
comma
)brace
)brace
comma
dot
id|desc
op_assign
(brace
dot
id|sadb_alg_id
op_assign
id|SADB_X_EALG_BLOWFISHCBC
comma
dot
id|sadb_alg_ivlen
op_assign
l_int|8
comma
dot
id|sadb_alg_minbits
op_assign
l_int|40
comma
dot
id|sadb_alg_maxbits
op_assign
l_int|448
)brace
)brace
comma
(brace
dot
id|name
op_assign
l_string|&quot;aes&quot;
comma
dot
id|uinfo
op_assign
(brace
dot
id|encr
op_assign
(brace
dot
id|blockbits
op_assign
l_int|128
comma
dot
id|defkeybits
op_assign
l_int|128
comma
)brace
)brace
comma
dot
id|desc
op_assign
(brace
dot
id|sadb_alg_id
op_assign
id|SADB_X_EALG_AESCBC
comma
dot
id|sadb_alg_ivlen
op_assign
l_int|8
comma
dot
id|sadb_alg_minbits
op_assign
l_int|128
comma
dot
id|sadb_alg_maxbits
op_assign
l_int|256
)brace
)brace
comma
)brace
suffix:semicolon
DECL|function|aalg_entries
r_static
r_inline
r_int
id|aalg_entries
c_func
(paren
r_void
)paren
(brace
r_return
r_sizeof
(paren
id|aalg_list
)paren
op_div
r_sizeof
(paren
id|aalg_list
(braket
l_int|0
)braket
)paren
suffix:semicolon
)brace
DECL|function|ealg_entries
r_static
r_inline
r_int
id|ealg_entries
c_func
(paren
r_void
)paren
(brace
r_return
r_sizeof
(paren
id|ealg_list
)paren
op_div
r_sizeof
(paren
id|ealg_list
(braket
l_int|0
)braket
)paren
suffix:semicolon
)brace
DECL|function|xfrm_aalg_get_byid
r_struct
id|xfrm_algo_desc
op_star
id|xfrm_aalg_get_byid
c_func
(paren
r_int
id|alg_id
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|aalg_entries
c_func
(paren
)paren
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|aalg_list
(braket
id|i
)braket
dot
id|desc.sadb_alg_id
op_eq
id|alg_id
)paren
(brace
r_if
c_cond
(paren
id|aalg_list
(braket
id|i
)braket
dot
id|available
)paren
r_return
op_amp
id|aalg_list
(braket
id|i
)braket
suffix:semicolon
r_else
r_break
suffix:semicolon
)brace
)brace
r_return
l_int|NULL
suffix:semicolon
)brace
DECL|function|xfrm_ealg_get_byid
r_struct
id|xfrm_algo_desc
op_star
id|xfrm_ealg_get_byid
c_func
(paren
r_int
id|alg_id
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|ealg_entries
c_func
(paren
)paren
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|ealg_list
(braket
id|i
)braket
dot
id|desc.sadb_alg_id
op_eq
id|alg_id
)paren
(brace
r_if
c_cond
(paren
id|ealg_list
(braket
id|i
)braket
dot
id|available
)paren
r_return
op_amp
id|ealg_list
(braket
id|i
)braket
suffix:semicolon
r_else
r_break
suffix:semicolon
)brace
)brace
r_return
l_int|NULL
suffix:semicolon
)brace
DECL|function|xfrm_aalg_get_byname
r_struct
id|xfrm_algo_desc
op_star
id|xfrm_aalg_get_byname
c_func
(paren
r_char
op_star
id|name
)paren
(brace
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|name
)paren
r_return
l_int|NULL
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|aalg_entries
c_func
(paren
)paren
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|strcmp
c_func
(paren
id|name
comma
id|aalg_list
(braket
id|i
)braket
dot
id|name
)paren
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|aalg_list
(braket
id|i
)braket
dot
id|available
)paren
r_return
op_amp
id|aalg_list
(braket
id|i
)braket
suffix:semicolon
r_else
r_break
suffix:semicolon
)brace
)brace
r_return
l_int|NULL
suffix:semicolon
)brace
DECL|function|xfrm_ealg_get_byname
r_struct
id|xfrm_algo_desc
op_star
id|xfrm_ealg_get_byname
c_func
(paren
r_char
op_star
id|name
)paren
(brace
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|name
)paren
r_return
l_int|NULL
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|ealg_entries
c_func
(paren
)paren
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|strcmp
c_func
(paren
id|name
comma
id|ealg_list
(braket
id|i
)braket
dot
id|name
)paren
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|ealg_list
(braket
id|i
)braket
dot
id|available
)paren
r_return
op_amp
id|ealg_list
(braket
id|i
)braket
suffix:semicolon
r_else
r_break
suffix:semicolon
)brace
)brace
r_return
l_int|NULL
suffix:semicolon
)brace
DECL|function|xfrm_aalg_get_byidx
r_struct
id|xfrm_algo_desc
op_star
id|xfrm_aalg_get_byidx
c_func
(paren
r_int
r_int
id|idx
)paren
(brace
r_if
c_cond
(paren
id|idx
op_ge
id|aalg_entries
c_func
(paren
)paren
)paren
r_return
l_int|NULL
suffix:semicolon
r_return
op_amp
id|aalg_list
(braket
id|idx
)braket
suffix:semicolon
)brace
DECL|function|xfrm_ealg_get_byidx
r_struct
id|xfrm_algo_desc
op_star
id|xfrm_ealg_get_byidx
c_func
(paren
r_int
r_int
id|idx
)paren
(brace
r_if
c_cond
(paren
id|idx
op_ge
id|ealg_entries
c_func
(paren
)paren
)paren
r_return
l_int|NULL
suffix:semicolon
r_return
op_amp
id|ealg_list
(braket
id|idx
)braket
suffix:semicolon
)brace
multiline_comment|/*&n; * Probe for the availability of crypto algorithms, and set the available&n; * flag for any algorithms found on the system.  This is typically called by&n; * pfkey during userspace SA add, update or register.&n; */
DECL|function|xfrm_probe_algs
r_void
id|xfrm_probe_algs
c_func
(paren
r_void
)paren
(brace
r_int
id|i
comma
id|status
suffix:semicolon
id|BUG_ON
c_func
(paren
id|in_softirq
c_func
(paren
)paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|aalg_entries
c_func
(paren
)paren
suffix:semicolon
id|i
op_increment
)paren
(brace
id|status
op_assign
id|crypto_alg_available
c_func
(paren
id|aalg_list
(braket
id|i
)braket
dot
id|name
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|aalg_list
(braket
id|i
)braket
dot
id|available
op_ne
id|status
)paren
id|aalg_list
(braket
id|i
)braket
dot
id|available
op_assign
id|status
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|ealg_entries
c_func
(paren
)paren
suffix:semicolon
id|i
op_increment
)paren
(brace
id|status
op_assign
id|crypto_alg_available
c_func
(paren
id|ealg_list
(braket
id|i
)braket
dot
id|name
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ealg_list
(braket
id|i
)braket
dot
id|available
op_ne
id|status
)paren
id|ealg_list
(braket
id|i
)braket
dot
id|available
op_assign
id|status
suffix:semicolon
)brace
)brace
DECL|function|xfrm_count_auth_supported
r_int
id|xfrm_count_auth_supported
c_func
(paren
r_void
)paren
(brace
r_int
id|i
comma
id|n
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
comma
id|n
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|aalg_entries
c_func
(paren
)paren
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|aalg_list
(braket
id|i
)braket
dot
id|available
)paren
id|n
op_increment
suffix:semicolon
r_return
id|n
suffix:semicolon
)brace
DECL|function|xfrm_count_enc_supported
r_int
id|xfrm_count_enc_supported
c_func
(paren
r_void
)paren
(brace
r_int
id|i
comma
id|n
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
comma
id|n
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|ealg_entries
c_func
(paren
)paren
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|ealg_list
(braket
id|i
)braket
dot
id|available
)paren
id|n
op_increment
suffix:semicolon
r_return
id|n
suffix:semicolon
)brace
eof
