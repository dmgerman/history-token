multiline_comment|/*&n; * ip_nat_snmp_basic.c&n; *&n; * Basic SNMP Application Layer Gateway&n; *&n; * This IP NAT module is intended for use with SNMP network &n; * discovery and monitoring applications where target networks use &n; * conflicting private address realms.&n; *&n; * Static NAT is used to remap the networks from the view of the network &n; * management system at the IP layer, and this module remaps some application&n; * layer addresses to match.&n; *&n; * The simplest form of ALG is performed, where only tagged IP addresses&n; * are modified.  The module does not need to be MIB aware and only scans&n; * messages at the ASN.1/BER level.&n; *&n; * Currently, only SNMPv1 and SNMPv2 are supported.&n; *&n; * More information on ALG and associated issues can be found in&n; * RFC 2962&n; *&n; * The ASB.1/BER parsing code is derived from the gxsnmp package by Gregory &n; * McLean &amp; Jochen Friedrich, stripped down for use in the kernel.&n; *&n; * Copyright (c) 2000 RP Internet (www.rpi.net.au).&n; *&n; * This program is free software; you can redistribute it and/or modify&n; * it under the terms of the GNU General Public License as published by&n; * the Free Software Foundation; either version 2 of the License, or&n; * (at your option) any later version.&n; * This program is distributed in the hope that it will be useful,&n; * but WITHOUT ANY WARRANTY; without even the implied warranty of&n; * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; * GNU General Public License for more details.&n; * You should have received a copy of the GNU General Public License&n; * along with this program; if not, write to the Free Software&n; * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA&n; *&n; * Author: James Morris &lt;jmorris@intercode.com.au&gt;&n; *&n; * Updates:&n; * 2000-08-06: Convert to new helper API (Harald Welte).&n; *&n; */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/types.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/netfilter_ipv4.h&gt;
macro_line|#include &lt;linux/netfilter_ipv4/ip_nat.h&gt;
macro_line|#include &lt;linux/netfilter_ipv4/ip_nat_helper.h&gt;
macro_line|#include &lt;linux/brlock.h&gt;
macro_line|#include &lt;linux/types.h&gt;
macro_line|#include &lt;linux/ip.h&gt;
macro_line|#include &lt;net/udp.h&gt;
macro_line|#include &lt;asm/uaccess.h&gt;
macro_line|#include &lt;asm/checksum.h&gt;
DECL|macro|SNMP_PORT
mdefine_line|#define SNMP_PORT 161
DECL|macro|SNMP_TRAP_PORT
mdefine_line|#define SNMP_TRAP_PORT 162
DECL|macro|NOCT1
mdefine_line|#define NOCT1(n) (u_int8_t )((n) &amp; 0xff)
DECL|variable|debug
r_static
r_int
id|debug
op_assign
l_int|0
suffix:semicolon
DECL|variable|snmp_lock
r_static
id|spinlock_t
id|snmp_lock
op_assign
id|SPIN_LOCK_UNLOCKED
suffix:semicolon
multiline_comment|/* &n; * Application layer address mapping mimics the NAT mapping, but &n; * only for the first octet in this case (a more flexible system&n; * can be implemented if needed).&n; */
DECL|struct|oct1_map
r_struct
id|oct1_map
(brace
DECL|member|from
id|u_int8_t
id|from
suffix:semicolon
DECL|member|to
id|u_int8_t
id|to
suffix:semicolon
)brace
suffix:semicolon
multiline_comment|/*****************************************************************************&n; *&n; * Basic ASN.1 decoding routines (gxsnmp author Dirk Wisse)&n; *&n; *****************************************************************************/
multiline_comment|/* Class */
DECL|macro|ASN1_UNI
mdefine_line|#define ASN1_UNI&t;0&t;/* Universal */
DECL|macro|ASN1_APL
mdefine_line|#define ASN1_APL&t;1&t;/* Application */
DECL|macro|ASN1_CTX
mdefine_line|#define ASN1_CTX&t;2&t;/* Context */
DECL|macro|ASN1_PRV
mdefine_line|#define ASN1_PRV&t;3&t;/* Private */
multiline_comment|/* Tag */
DECL|macro|ASN1_EOC
mdefine_line|#define ASN1_EOC&t;0&t;/* End Of Contents */
DECL|macro|ASN1_BOL
mdefine_line|#define ASN1_BOL&t;1&t;/* Boolean */
DECL|macro|ASN1_INT
mdefine_line|#define ASN1_INT&t;2&t;/* Integer */
DECL|macro|ASN1_BTS
mdefine_line|#define ASN1_BTS&t;3&t;/* Bit String */
DECL|macro|ASN1_OTS
mdefine_line|#define ASN1_OTS&t;4&t;/* Octet String */
DECL|macro|ASN1_NUL
mdefine_line|#define ASN1_NUL&t;5&t;/* Null */
DECL|macro|ASN1_OJI
mdefine_line|#define ASN1_OJI&t;6&t;/* Object Identifier  */
DECL|macro|ASN1_OJD
mdefine_line|#define ASN1_OJD&t;7&t;/* Object Description */
DECL|macro|ASN1_EXT
mdefine_line|#define ASN1_EXT&t;8&t;/* External */
DECL|macro|ASN1_SEQ
mdefine_line|#define ASN1_SEQ&t;16&t;/* Sequence */
DECL|macro|ASN1_SET
mdefine_line|#define ASN1_SET&t;17&t;/* Set */
DECL|macro|ASN1_NUMSTR
mdefine_line|#define ASN1_NUMSTR&t;18&t;/* Numerical String */
DECL|macro|ASN1_PRNSTR
mdefine_line|#define ASN1_PRNSTR&t;19&t;/* Printable String */
DECL|macro|ASN1_TEXSTR
mdefine_line|#define ASN1_TEXSTR&t;20&t;/* Teletext String */
DECL|macro|ASN1_VIDSTR
mdefine_line|#define ASN1_VIDSTR&t;21&t;/* Video String */
DECL|macro|ASN1_IA5STR
mdefine_line|#define ASN1_IA5STR&t;22&t;/* IA5 String */
DECL|macro|ASN1_UNITIM
mdefine_line|#define ASN1_UNITIM&t;23&t;/* Universal Time */
DECL|macro|ASN1_GENTIM
mdefine_line|#define ASN1_GENTIM&t;24&t;/* General Time */
DECL|macro|ASN1_GRASTR
mdefine_line|#define ASN1_GRASTR&t;25&t;/* Graphical String */
DECL|macro|ASN1_VISSTR
mdefine_line|#define ASN1_VISSTR&t;26&t;/* Visible String */
DECL|macro|ASN1_GENSTR
mdefine_line|#define ASN1_GENSTR&t;27&t;/* General String */
multiline_comment|/* Primitive / Constructed methods*/
DECL|macro|ASN1_PRI
mdefine_line|#define ASN1_PRI&t;0&t;/* Primitive */
DECL|macro|ASN1_CON
mdefine_line|#define ASN1_CON&t;1&t;/* Constructed */
multiline_comment|/*&n; * Error codes.&n; */
DECL|macro|ASN1_ERR_NOERROR
mdefine_line|#define ASN1_ERR_NOERROR&t;&t;0
DECL|macro|ASN1_ERR_DEC_EMPTY
mdefine_line|#define ASN1_ERR_DEC_EMPTY&t;&t;2
DECL|macro|ASN1_ERR_DEC_EOC_MISMATCH
mdefine_line|#define ASN1_ERR_DEC_EOC_MISMATCH&t;3
DECL|macro|ASN1_ERR_DEC_LENGTH_MISMATCH
mdefine_line|#define ASN1_ERR_DEC_LENGTH_MISMATCH&t;4
DECL|macro|ASN1_ERR_DEC_BADVALUE
mdefine_line|#define ASN1_ERR_DEC_BADVALUE&t;&t;5
multiline_comment|/* &n; * ASN.1 context.&n; */
DECL|struct|asn1_ctx
r_struct
id|asn1_ctx
(brace
DECL|member|error
r_int
id|error
suffix:semicolon
multiline_comment|/* Error condition */
DECL|member|pointer
r_int
r_char
op_star
id|pointer
suffix:semicolon
multiline_comment|/* Octet just to be decoded */
DECL|member|begin
r_int
r_char
op_star
id|begin
suffix:semicolon
multiline_comment|/* First octet */
DECL|member|end
r_int
r_char
op_star
id|end
suffix:semicolon
multiline_comment|/* Octet after last octet */
)brace
suffix:semicolon
multiline_comment|/*&n; * Octet string (not null terminated)&n; */
DECL|struct|asn1_octstr
r_struct
id|asn1_octstr
(brace
DECL|member|data
r_int
r_char
op_star
id|data
suffix:semicolon
DECL|member|len
r_int
r_int
id|len
suffix:semicolon
)brace
suffix:semicolon
DECL|function|asn1_open
r_static
r_void
id|asn1_open
c_func
(paren
r_struct
id|asn1_ctx
op_star
id|ctx
comma
r_int
r_char
op_star
id|buf
comma
r_int
r_int
id|len
)paren
(brace
id|ctx-&gt;begin
op_assign
id|buf
suffix:semicolon
id|ctx-&gt;end
op_assign
id|buf
op_plus
id|len
suffix:semicolon
id|ctx-&gt;pointer
op_assign
id|buf
suffix:semicolon
id|ctx-&gt;error
op_assign
id|ASN1_ERR_NOERROR
suffix:semicolon
)brace
DECL|function|asn1_octet_decode
r_static
r_int
r_char
id|asn1_octet_decode
c_func
(paren
r_struct
id|asn1_ctx
op_star
id|ctx
comma
r_int
r_char
op_star
id|ch
)paren
(brace
r_if
c_cond
(paren
id|ctx-&gt;pointer
op_ge
id|ctx-&gt;end
)paren
(brace
id|ctx-&gt;error
op_assign
id|ASN1_ERR_DEC_EMPTY
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
op_star
id|ch
op_assign
op_star
(paren
id|ctx-&gt;pointer
)paren
op_increment
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|asn1_tag_decode
r_static
r_int
r_char
id|asn1_tag_decode
c_func
(paren
r_struct
id|asn1_ctx
op_star
id|ctx
comma
r_int
r_int
op_star
id|tag
)paren
(brace
r_int
r_char
id|ch
suffix:semicolon
op_star
id|tag
op_assign
l_int|0
suffix:semicolon
r_do
(brace
r_if
c_cond
(paren
op_logical_neg
id|asn1_octet_decode
c_func
(paren
id|ctx
comma
op_amp
id|ch
)paren
)paren
r_return
l_int|0
suffix:semicolon
op_star
id|tag
op_lshift_assign
l_int|7
suffix:semicolon
op_star
id|tag
op_or_assign
id|ch
op_amp
l_int|0x7F
suffix:semicolon
)brace
r_while
c_loop
(paren
(paren
id|ch
op_amp
l_int|0x80
)paren
op_eq
l_int|0x80
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|asn1_id_decode
r_static
r_int
r_char
id|asn1_id_decode
c_func
(paren
r_struct
id|asn1_ctx
op_star
id|ctx
comma
r_int
r_int
op_star
id|cls
comma
r_int
r_int
op_star
id|con
comma
r_int
r_int
op_star
id|tag
)paren
(brace
r_int
r_char
id|ch
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|asn1_octet_decode
c_func
(paren
id|ctx
comma
op_amp
id|ch
)paren
)paren
r_return
l_int|0
suffix:semicolon
op_star
id|cls
op_assign
(paren
id|ch
op_amp
l_int|0xC0
)paren
op_rshift
l_int|6
suffix:semicolon
op_star
id|con
op_assign
(paren
id|ch
op_amp
l_int|0x20
)paren
op_rshift
l_int|5
suffix:semicolon
op_star
id|tag
op_assign
(paren
id|ch
op_amp
l_int|0x1F
)paren
suffix:semicolon
r_if
c_cond
(paren
op_star
id|tag
op_eq
l_int|0x1F
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|asn1_tag_decode
c_func
(paren
id|ctx
comma
id|tag
)paren
)paren
r_return
l_int|0
suffix:semicolon
)brace
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|asn1_length_decode
r_static
r_int
r_char
id|asn1_length_decode
c_func
(paren
r_struct
id|asn1_ctx
op_star
id|ctx
comma
r_int
r_int
op_star
id|def
comma
r_int
r_int
op_star
id|len
)paren
(brace
r_int
r_char
id|ch
comma
id|cnt
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|asn1_octet_decode
c_func
(paren
id|ctx
comma
op_amp
id|ch
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|ch
op_eq
l_int|0x80
)paren
op_star
id|def
op_assign
l_int|0
suffix:semicolon
r_else
(brace
op_star
id|def
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|ch
OL
l_int|0x80
)paren
op_star
id|len
op_assign
id|ch
suffix:semicolon
r_else
(brace
id|cnt
op_assign
(paren
r_int
r_char
)paren
(paren
id|ch
op_amp
l_int|0x7F
)paren
suffix:semicolon
op_star
id|len
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
id|cnt
OG
l_int|0
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|asn1_octet_decode
c_func
(paren
id|ctx
comma
op_amp
id|ch
)paren
)paren
r_return
l_int|0
suffix:semicolon
op_star
id|len
op_lshift_assign
l_int|8
suffix:semicolon
op_star
id|len
op_or_assign
id|ch
suffix:semicolon
id|cnt
op_decrement
suffix:semicolon
)brace
)brace
)brace
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|asn1_header_decode
r_static
r_int
r_char
id|asn1_header_decode
c_func
(paren
r_struct
id|asn1_ctx
op_star
id|ctx
comma
r_int
r_char
op_star
op_star
id|eoc
comma
r_int
r_int
op_star
id|cls
comma
r_int
r_int
op_star
id|con
comma
r_int
r_int
op_star
id|tag
)paren
(brace
r_int
r_int
id|def
comma
id|len
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|asn1_id_decode
c_func
(paren
id|ctx
comma
id|cls
comma
id|con
comma
id|tag
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|asn1_length_decode
c_func
(paren
id|ctx
comma
op_amp
id|def
comma
op_amp
id|len
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|def
)paren
op_star
id|eoc
op_assign
id|ctx-&gt;pointer
op_plus
id|len
suffix:semicolon
r_else
op_star
id|eoc
op_assign
l_int|0
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|asn1_eoc_decode
r_static
r_int
r_char
id|asn1_eoc_decode
c_func
(paren
r_struct
id|asn1_ctx
op_star
id|ctx
comma
r_int
r_char
op_star
id|eoc
)paren
(brace
r_int
r_char
id|ch
suffix:semicolon
r_if
c_cond
(paren
id|eoc
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|asn1_octet_decode
c_func
(paren
id|ctx
comma
op_amp
id|ch
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|ch
op_ne
l_int|0x00
)paren
(brace
id|ctx-&gt;error
op_assign
id|ASN1_ERR_DEC_EOC_MISMATCH
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|asn1_octet_decode
c_func
(paren
id|ctx
comma
op_amp
id|ch
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|ch
op_ne
l_int|0x00
)paren
(brace
id|ctx-&gt;error
op_assign
id|ASN1_ERR_DEC_EOC_MISMATCH
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_return
l_int|1
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|ctx-&gt;pointer
op_ne
id|eoc
)paren
(brace
id|ctx-&gt;error
op_assign
id|ASN1_ERR_DEC_LENGTH_MISMATCH
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_return
l_int|1
suffix:semicolon
)brace
)brace
DECL|function|asn1_null_decode
r_static
r_int
r_char
id|asn1_null_decode
c_func
(paren
r_struct
id|asn1_ctx
op_star
id|ctx
comma
r_int
r_char
op_star
id|eoc
)paren
(brace
id|ctx-&gt;pointer
op_assign
id|eoc
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|asn1_long_decode
r_static
r_int
r_char
id|asn1_long_decode
c_func
(paren
r_struct
id|asn1_ctx
op_star
id|ctx
comma
r_int
r_char
op_star
id|eoc
comma
r_int
op_star
id|integer
)paren
(brace
r_int
r_char
id|ch
suffix:semicolon
r_int
r_int
id|len
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|asn1_octet_decode
c_func
(paren
id|ctx
comma
op_amp
id|ch
)paren
)paren
r_return
l_int|0
suffix:semicolon
op_star
id|integer
op_assign
(paren
r_int
r_char
)paren
id|ch
suffix:semicolon
id|len
op_assign
l_int|1
suffix:semicolon
r_while
c_loop
(paren
id|ctx-&gt;pointer
OL
id|eoc
)paren
(brace
r_if
c_cond
(paren
op_increment
id|len
OG
r_sizeof
(paren
r_int
)paren
)paren
(brace
id|ctx-&gt;error
op_assign
id|ASN1_ERR_DEC_BADVALUE
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|asn1_octet_decode
c_func
(paren
id|ctx
comma
op_amp
id|ch
)paren
)paren
r_return
l_int|0
suffix:semicolon
op_star
id|integer
op_lshift_assign
l_int|8
suffix:semicolon
op_star
id|integer
op_or_assign
id|ch
suffix:semicolon
)brace
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|asn1_uint_decode
r_static
r_int
r_char
id|asn1_uint_decode
c_func
(paren
r_struct
id|asn1_ctx
op_star
id|ctx
comma
r_int
r_char
op_star
id|eoc
comma
r_int
r_int
op_star
id|integer
)paren
(brace
r_int
r_char
id|ch
suffix:semicolon
r_int
r_int
id|len
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|asn1_octet_decode
c_func
(paren
id|ctx
comma
op_amp
id|ch
)paren
)paren
r_return
l_int|0
suffix:semicolon
op_star
id|integer
op_assign
id|ch
suffix:semicolon
r_if
c_cond
(paren
id|ch
op_eq
l_int|0
)paren
id|len
op_assign
l_int|0
suffix:semicolon
r_else
id|len
op_assign
l_int|1
suffix:semicolon
r_while
c_loop
(paren
id|ctx-&gt;pointer
OL
id|eoc
)paren
(brace
r_if
c_cond
(paren
op_increment
id|len
OG
r_sizeof
(paren
r_int
r_int
)paren
)paren
(brace
id|ctx-&gt;error
op_assign
id|ASN1_ERR_DEC_BADVALUE
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|asn1_octet_decode
c_func
(paren
id|ctx
comma
op_amp
id|ch
)paren
)paren
r_return
l_int|0
suffix:semicolon
op_star
id|integer
op_lshift_assign
l_int|8
suffix:semicolon
op_star
id|integer
op_or_assign
id|ch
suffix:semicolon
)brace
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|asn1_ulong_decode
r_static
r_int
r_char
id|asn1_ulong_decode
c_func
(paren
r_struct
id|asn1_ctx
op_star
id|ctx
comma
r_int
r_char
op_star
id|eoc
comma
r_int
r_int
op_star
id|integer
)paren
(brace
r_int
r_char
id|ch
suffix:semicolon
r_int
r_int
id|len
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|asn1_octet_decode
c_func
(paren
id|ctx
comma
op_amp
id|ch
)paren
)paren
r_return
l_int|0
suffix:semicolon
op_star
id|integer
op_assign
id|ch
suffix:semicolon
r_if
c_cond
(paren
id|ch
op_eq
l_int|0
)paren
id|len
op_assign
l_int|0
suffix:semicolon
r_else
id|len
op_assign
l_int|1
suffix:semicolon
r_while
c_loop
(paren
id|ctx-&gt;pointer
OL
id|eoc
)paren
(brace
r_if
c_cond
(paren
op_increment
id|len
OG
r_sizeof
(paren
r_int
r_int
)paren
)paren
(brace
id|ctx-&gt;error
op_assign
id|ASN1_ERR_DEC_BADVALUE
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|asn1_octet_decode
c_func
(paren
id|ctx
comma
op_amp
id|ch
)paren
)paren
r_return
l_int|0
suffix:semicolon
op_star
id|integer
op_lshift_assign
l_int|8
suffix:semicolon
op_star
id|integer
op_or_assign
id|ch
suffix:semicolon
)brace
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|asn1_octets_decode
r_static
r_int
r_char
id|asn1_octets_decode
c_func
(paren
r_struct
id|asn1_ctx
op_star
id|ctx
comma
r_int
r_char
op_star
id|eoc
comma
r_int
r_char
op_star
op_star
id|octets
comma
r_int
r_int
op_star
id|len
)paren
(brace
r_int
r_char
op_star
id|ptr
suffix:semicolon
op_star
id|len
op_assign
l_int|0
suffix:semicolon
op_star
id|octets
op_assign
id|kmalloc
c_func
(paren
id|eoc
op_minus
id|ctx-&gt;pointer
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
r_if
c_cond
(paren
op_star
id|octets
op_eq
l_int|NULL
)paren
(brace
r_if
c_cond
(paren
id|net_ratelimit
c_func
(paren
)paren
)paren
id|printk
c_func
(paren
l_string|&quot;OOM in bsalg (%d)&bslash;n&quot;
comma
id|__LINE__
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|ptr
op_assign
op_star
id|octets
suffix:semicolon
r_while
c_loop
(paren
id|ctx-&gt;pointer
OL
id|eoc
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|asn1_octet_decode
c_func
(paren
id|ctx
comma
(paren
r_int
r_char
op_star
)paren
id|ptr
op_increment
)paren
)paren
(brace
id|kfree
c_func
(paren
op_star
id|octets
)paren
suffix:semicolon
op_star
id|octets
op_assign
l_int|NULL
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
(paren
op_star
id|len
)paren
op_increment
suffix:semicolon
)brace
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|asn1_subid_decode
r_static
r_int
r_char
id|asn1_subid_decode
c_func
(paren
r_struct
id|asn1_ctx
op_star
id|ctx
comma
r_int
r_int
op_star
id|subid
)paren
(brace
r_int
r_char
id|ch
suffix:semicolon
op_star
id|subid
op_assign
l_int|0
suffix:semicolon
r_do
(brace
r_if
c_cond
(paren
op_logical_neg
id|asn1_octet_decode
c_func
(paren
id|ctx
comma
op_amp
id|ch
)paren
)paren
r_return
l_int|0
suffix:semicolon
op_star
id|subid
op_lshift_assign
l_int|7
suffix:semicolon
op_star
id|subid
op_or_assign
id|ch
op_amp
l_int|0x7F
suffix:semicolon
)brace
r_while
c_loop
(paren
(paren
id|ch
op_amp
l_int|0x80
)paren
op_eq
l_int|0x80
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|asn1_oid_decode
r_static
r_int
r_char
id|asn1_oid_decode
c_func
(paren
r_struct
id|asn1_ctx
op_star
id|ctx
comma
r_int
r_char
op_star
id|eoc
comma
r_int
r_int
op_star
op_star
id|oid
comma
r_int
r_int
op_star
id|len
)paren
(brace
r_int
r_int
id|subid
suffix:semicolon
r_int
r_int
id|size
suffix:semicolon
r_int
r_int
op_star
id|optr
suffix:semicolon
id|size
op_assign
id|eoc
op_minus
id|ctx-&gt;pointer
op_plus
l_int|1
suffix:semicolon
op_star
id|oid
op_assign
id|kmalloc
c_func
(paren
id|size
op_star
r_sizeof
(paren
r_int
r_int
)paren
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
r_if
c_cond
(paren
op_star
id|oid
op_eq
l_int|NULL
)paren
(brace
r_if
c_cond
(paren
id|net_ratelimit
c_func
(paren
)paren
)paren
id|printk
c_func
(paren
l_string|&quot;OOM in bsalg (%d)&bslash;n&quot;
comma
id|__LINE__
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|optr
op_assign
op_star
id|oid
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|asn1_subid_decode
c_func
(paren
id|ctx
comma
op_amp
id|subid
)paren
)paren
(brace
id|kfree
c_func
(paren
op_star
id|oid
)paren
suffix:semicolon
op_star
id|oid
op_assign
l_int|NULL
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|subid
OL
l_int|40
)paren
(brace
id|optr
(braket
l_int|0
)braket
op_assign
l_int|0
suffix:semicolon
id|optr
(braket
l_int|1
)braket
op_assign
id|subid
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|subid
OL
l_int|80
)paren
(brace
id|optr
(braket
l_int|0
)braket
op_assign
l_int|1
suffix:semicolon
id|optr
(braket
l_int|1
)braket
op_assign
id|subid
op_minus
l_int|40
suffix:semicolon
)brace
r_else
(brace
id|optr
(braket
l_int|0
)braket
op_assign
l_int|2
suffix:semicolon
id|optr
(braket
l_int|1
)braket
op_assign
id|subid
op_minus
l_int|80
suffix:semicolon
)brace
op_star
id|len
op_assign
l_int|2
suffix:semicolon
id|optr
op_add_assign
l_int|2
suffix:semicolon
r_while
c_loop
(paren
id|ctx-&gt;pointer
OL
id|eoc
)paren
(brace
r_if
c_cond
(paren
op_increment
(paren
op_star
id|len
)paren
OG
id|size
)paren
(brace
id|ctx-&gt;error
op_assign
id|ASN1_ERR_DEC_BADVALUE
suffix:semicolon
id|kfree
c_func
(paren
op_star
id|oid
)paren
suffix:semicolon
op_star
id|oid
op_assign
l_int|NULL
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|asn1_subid_decode
c_func
(paren
id|ctx
comma
id|optr
op_increment
)paren
)paren
(brace
id|kfree
c_func
(paren
op_star
id|oid
)paren
suffix:semicolon
op_star
id|oid
op_assign
l_int|NULL
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
)brace
r_return
l_int|1
suffix:semicolon
)brace
multiline_comment|/*****************************************************************************&n; *&n; * SNMP decoding routines (gxsnmp author Dirk Wisse)&n; *&n; *****************************************************************************/
multiline_comment|/* SNMP Versions */
DECL|macro|SNMP_V1
mdefine_line|#define SNMP_V1&t;&t;&t;&t;0
DECL|macro|SNMP_V2C
mdefine_line|#define SNMP_V2C&t;&t;&t;1
DECL|macro|SNMP_V2
mdefine_line|#define SNMP_V2&t;&t;&t;&t;2
DECL|macro|SNMP_V3
mdefine_line|#define SNMP_V3&t;&t;&t;&t;3
multiline_comment|/* Default Sizes */
DECL|macro|SNMP_SIZE_COMM
mdefine_line|#define SNMP_SIZE_COMM&t;&t;&t;256
DECL|macro|SNMP_SIZE_OBJECTID
mdefine_line|#define SNMP_SIZE_OBJECTID&t;&t;128
DECL|macro|SNMP_SIZE_BUFCHR
mdefine_line|#define SNMP_SIZE_BUFCHR&t;&t;256
DECL|macro|SNMP_SIZE_BUFINT
mdefine_line|#define SNMP_SIZE_BUFINT&t;&t;128
DECL|macro|SNMP_SIZE_SMALLOBJECTID
mdefine_line|#define SNMP_SIZE_SMALLOBJECTID&t;&t;16
multiline_comment|/* Requests */
DECL|macro|SNMP_PDU_GET
mdefine_line|#define SNMP_PDU_GET&t;&t;&t;0
DECL|macro|SNMP_PDU_NEXT
mdefine_line|#define SNMP_PDU_NEXT&t;&t;&t;1
DECL|macro|SNMP_PDU_RESPONSE
mdefine_line|#define SNMP_PDU_RESPONSE&t;&t;2
DECL|macro|SNMP_PDU_SET
mdefine_line|#define SNMP_PDU_SET&t;&t;&t;3
DECL|macro|SNMP_PDU_TRAP1
mdefine_line|#define SNMP_PDU_TRAP1&t;&t;&t;4
DECL|macro|SNMP_PDU_BULK
mdefine_line|#define SNMP_PDU_BULK&t;&t;&t;5
DECL|macro|SNMP_PDU_INFORM
mdefine_line|#define SNMP_PDU_INFORM&t;&t;&t;6
DECL|macro|SNMP_PDU_TRAP2
mdefine_line|#define SNMP_PDU_TRAP2&t;&t;&t;7
multiline_comment|/* Errors */
DECL|macro|SNMP_NOERROR
mdefine_line|#define SNMP_NOERROR&t;&t;&t;0
DECL|macro|SNMP_TOOBIG
mdefine_line|#define SNMP_TOOBIG&t;&t;&t;1
DECL|macro|SNMP_NOSUCHNAME
mdefine_line|#define SNMP_NOSUCHNAME&t;&t;&t;2
DECL|macro|SNMP_BADVALUE
mdefine_line|#define SNMP_BADVALUE&t;&t;&t;3
DECL|macro|SNMP_READONLY
mdefine_line|#define SNMP_READONLY&t;&t;&t;4
DECL|macro|SNMP_GENERROR
mdefine_line|#define SNMP_GENERROR&t;&t;&t;5
DECL|macro|SNMP_NOACCESS
mdefine_line|#define SNMP_NOACCESS&t;&t;&t;6
DECL|macro|SNMP_WRONGTYPE
mdefine_line|#define SNMP_WRONGTYPE&t;&t;&t;7
DECL|macro|SNMP_WRONGLENGTH
mdefine_line|#define SNMP_WRONGLENGTH&t;&t;8
DECL|macro|SNMP_WRONGENCODING
mdefine_line|#define SNMP_WRONGENCODING&t;&t;9
DECL|macro|SNMP_WRONGVALUE
mdefine_line|#define SNMP_WRONGVALUE&t;&t;&t;10
DECL|macro|SNMP_NOCREATION
mdefine_line|#define SNMP_NOCREATION&t;&t;&t;11
DECL|macro|SNMP_INCONSISTENTVALUE
mdefine_line|#define SNMP_INCONSISTENTVALUE&t;&t;12
DECL|macro|SNMP_RESOURCEUNAVAILABLE
mdefine_line|#define SNMP_RESOURCEUNAVAILABLE&t;13
DECL|macro|SNMP_COMMITFAILED
mdefine_line|#define SNMP_COMMITFAILED&t;&t;14
DECL|macro|SNMP_UNDOFAILED
mdefine_line|#define SNMP_UNDOFAILED&t;&t;&t;15
DECL|macro|SNMP_AUTHORIZATIONERROR
mdefine_line|#define SNMP_AUTHORIZATIONERROR&t;&t;16
DECL|macro|SNMP_NOTWRITABLE
mdefine_line|#define SNMP_NOTWRITABLE&t;&t;17
DECL|macro|SNMP_INCONSISTENTNAME
mdefine_line|#define SNMP_INCONSISTENTNAME&t;&t;18
multiline_comment|/* General SNMP V1 Traps */
DECL|macro|SNMP_TRAP_COLDSTART
mdefine_line|#define SNMP_TRAP_COLDSTART&t;&t;0
DECL|macro|SNMP_TRAP_WARMSTART
mdefine_line|#define SNMP_TRAP_WARMSTART&t;&t;1
DECL|macro|SNMP_TRAP_LINKDOWN
mdefine_line|#define SNMP_TRAP_LINKDOWN&t;&t;2
DECL|macro|SNMP_TRAP_LINKUP
mdefine_line|#define SNMP_TRAP_LINKUP&t;&t;3
DECL|macro|SNMP_TRAP_AUTFAILURE
mdefine_line|#define SNMP_TRAP_AUTFAILURE&t;&t;4
DECL|macro|SNMP_TRAP_EQPNEIGHBORLOSS
mdefine_line|#define SNMP_TRAP_EQPNEIGHBORLOSS&t;5
DECL|macro|SNMP_TRAP_ENTSPECIFIC
mdefine_line|#define SNMP_TRAP_ENTSPECIFIC&t;&t;6
multiline_comment|/* SNMPv1 Types */
DECL|macro|SNMP_NULL
mdefine_line|#define SNMP_NULL                0
DECL|macro|SNMP_INTEGER
mdefine_line|#define SNMP_INTEGER             1    /* l  */
DECL|macro|SNMP_OCTETSTR
mdefine_line|#define SNMP_OCTETSTR            2    /* c  */
DECL|macro|SNMP_DISPLAYSTR
mdefine_line|#define SNMP_DISPLAYSTR          2    /* c  */
DECL|macro|SNMP_OBJECTID
mdefine_line|#define SNMP_OBJECTID            3    /* ul */
DECL|macro|SNMP_IPADDR
mdefine_line|#define SNMP_IPADDR              4    /* uc */
DECL|macro|SNMP_COUNTER
mdefine_line|#define SNMP_COUNTER             5    /* ul */
DECL|macro|SNMP_GAUGE
mdefine_line|#define SNMP_GAUGE               6    /* ul */
DECL|macro|SNMP_TIMETICKS
mdefine_line|#define SNMP_TIMETICKS           7    /* ul */
DECL|macro|SNMP_OPAQUE
mdefine_line|#define SNMP_OPAQUE              8    /* c  */
multiline_comment|/* Additional SNMPv2 Types */
DECL|macro|SNMP_UINTEGER
mdefine_line|#define SNMP_UINTEGER            5    /* ul */
DECL|macro|SNMP_BITSTR
mdefine_line|#define SNMP_BITSTR              9    /* uc */
DECL|macro|SNMP_NSAP
mdefine_line|#define SNMP_NSAP               10    /* uc */
DECL|macro|SNMP_COUNTER64
mdefine_line|#define SNMP_COUNTER64          11    /* ul */
DECL|macro|SNMP_NOSUCHOBJECT
mdefine_line|#define SNMP_NOSUCHOBJECT       12
DECL|macro|SNMP_NOSUCHINSTANCE
mdefine_line|#define SNMP_NOSUCHINSTANCE     13
DECL|macro|SNMP_ENDOFMIBVIEW
mdefine_line|#define SNMP_ENDOFMIBVIEW       14
DECL|union|snmp_syntax
r_union
id|snmp_syntax
(brace
DECL|member|uc
r_int
r_char
id|uc
(braket
l_int|0
)braket
suffix:semicolon
multiline_comment|/* 8 bit unsigned */
DECL|member|c
r_char
id|c
(braket
l_int|0
)braket
suffix:semicolon
multiline_comment|/* 8 bit signed */
DECL|member|ul
r_int
r_int
id|ul
(braket
l_int|0
)braket
suffix:semicolon
multiline_comment|/* 32 bit unsigned */
DECL|member|l
r_int
id|l
(braket
l_int|0
)braket
suffix:semicolon
multiline_comment|/* 32 bit signed */
)brace
suffix:semicolon
DECL|struct|snmp_object
r_struct
id|snmp_object
(brace
DECL|member|id
r_int
r_int
op_star
id|id
suffix:semicolon
DECL|member|id_len
r_int
r_int
id|id_len
suffix:semicolon
DECL|member|type
r_int
r_int
id|type
suffix:semicolon
DECL|member|syntax_len
r_int
r_int
id|syntax_len
suffix:semicolon
DECL|member|syntax
r_union
id|snmp_syntax
id|syntax
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|snmp_request
r_struct
id|snmp_request
(brace
DECL|member|id
r_int
r_int
id|id
suffix:semicolon
DECL|member|error_status
r_int
r_int
id|error_status
suffix:semicolon
DECL|member|error_index
r_int
r_int
id|error_index
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|snmp_v1_trap
r_struct
id|snmp_v1_trap
(brace
DECL|member|id
r_int
r_int
op_star
id|id
suffix:semicolon
DECL|member|id_len
r_int
r_int
id|id_len
suffix:semicolon
DECL|member|ip_address
r_int
r_int
id|ip_address
suffix:semicolon
multiline_comment|/* pointer  */
DECL|member|general
r_int
r_int
id|general
suffix:semicolon
DECL|member|specific
r_int
r_int
id|specific
suffix:semicolon
DECL|member|time
r_int
r_int
id|time
suffix:semicolon
)brace
suffix:semicolon
multiline_comment|/* SNMP types */
DECL|macro|SNMP_IPA
mdefine_line|#define SNMP_IPA    0
DECL|macro|SNMP_CNT
mdefine_line|#define SNMP_CNT    1
DECL|macro|SNMP_GGE
mdefine_line|#define SNMP_GGE    2
DECL|macro|SNMP_TIT
mdefine_line|#define SNMP_TIT    3
DECL|macro|SNMP_OPQ
mdefine_line|#define SNMP_OPQ    4
DECL|macro|SNMP_C64
mdefine_line|#define SNMP_C64    6
multiline_comment|/* SNMP errors */
DECL|macro|SERR_NSO
mdefine_line|#define SERR_NSO    0
DECL|macro|SERR_NSI
mdefine_line|#define SERR_NSI    1
DECL|macro|SERR_EOM
mdefine_line|#define SERR_EOM    2
r_static
r_void
r_inline
id|mangle_address
c_func
(paren
r_int
r_char
op_star
id|begin
comma
r_int
r_char
op_star
id|addr
comma
r_const
r_struct
id|oct1_map
op_star
id|map
comma
id|u_int16_t
op_star
id|check
)paren
suffix:semicolon
DECL|struct|snmp_cnv
r_struct
id|snmp_cnv
(brace
DECL|member|class
r_int
r_int
r_class
suffix:semicolon
DECL|member|tag
r_int
r_int
id|tag
suffix:semicolon
DECL|member|syntax
r_int
id|syntax
suffix:semicolon
)brace
suffix:semicolon
DECL|variable|snmp_conv
r_static
r_struct
id|snmp_cnv
id|snmp_conv
(braket
)braket
op_assign
(brace
(brace
id|ASN1_UNI
comma
id|ASN1_NUL
comma
id|SNMP_NULL
)brace
comma
(brace
id|ASN1_UNI
comma
id|ASN1_INT
comma
id|SNMP_INTEGER
)brace
comma
(brace
id|ASN1_UNI
comma
id|ASN1_OTS
comma
id|SNMP_OCTETSTR
)brace
comma
(brace
id|ASN1_UNI
comma
id|ASN1_OTS
comma
id|SNMP_DISPLAYSTR
)brace
comma
(brace
id|ASN1_UNI
comma
id|ASN1_OJI
comma
id|SNMP_OBJECTID
)brace
comma
(brace
id|ASN1_APL
comma
id|SNMP_IPA
comma
id|SNMP_IPADDR
)brace
comma
(brace
id|ASN1_APL
comma
id|SNMP_CNT
comma
id|SNMP_COUNTER
)brace
comma
multiline_comment|/* Counter32 */
(brace
id|ASN1_APL
comma
id|SNMP_GGE
comma
id|SNMP_GAUGE
)brace
comma
multiline_comment|/* Gauge32 == Unsigned32  */
(brace
id|ASN1_APL
comma
id|SNMP_TIT
comma
id|SNMP_TIMETICKS
)brace
comma
(brace
id|ASN1_APL
comma
id|SNMP_OPQ
comma
id|SNMP_OPAQUE
)brace
comma
multiline_comment|/* SNMPv2 data types and errors */
(brace
id|ASN1_UNI
comma
id|ASN1_BTS
comma
id|SNMP_BITSTR
)brace
comma
(brace
id|ASN1_APL
comma
id|SNMP_C64
comma
id|SNMP_COUNTER64
)brace
comma
(brace
id|ASN1_CTX
comma
id|SERR_NSO
comma
id|SNMP_NOSUCHOBJECT
)brace
comma
(brace
id|ASN1_CTX
comma
id|SERR_NSI
comma
id|SNMP_NOSUCHINSTANCE
)brace
comma
(brace
id|ASN1_CTX
comma
id|SERR_EOM
comma
id|SNMP_ENDOFMIBVIEW
)brace
comma
(brace
l_int|0
comma
l_int|0
comma
op_minus
l_int|1
)brace
)brace
suffix:semicolon
DECL|function|snmp_tag_cls2syntax
r_static
r_int
r_char
id|snmp_tag_cls2syntax
c_func
(paren
r_int
r_int
id|tag
comma
r_int
r_int
id|cls
comma
r_int
r_int
op_star
id|syntax
)paren
(brace
r_struct
id|snmp_cnv
op_star
id|cnv
suffix:semicolon
id|cnv
op_assign
id|snmp_conv
suffix:semicolon
r_while
c_loop
(paren
id|cnv-&gt;syntax
op_ne
op_minus
l_int|1
)paren
(brace
r_if
c_cond
(paren
id|cnv-&gt;tag
op_eq
id|tag
op_logical_and
id|cnv
op_member_access_from_pointer
r_class
op_eq
id|cls
)paren
(brace
op_star
id|syntax
op_assign
id|cnv-&gt;syntax
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
id|cnv
op_increment
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|snmp_object_decode
r_static
r_int
r_char
id|snmp_object_decode
c_func
(paren
r_struct
id|asn1_ctx
op_star
id|ctx
comma
r_struct
id|snmp_object
op_star
op_star
id|obj
)paren
(brace
r_int
r_int
id|cls
comma
id|con
comma
id|tag
comma
id|len
comma
id|idlen
suffix:semicolon
r_int
r_int
id|type
suffix:semicolon
r_int
r_char
op_star
id|eoc
comma
op_star
id|end
comma
op_star
id|p
suffix:semicolon
r_int
r_int
op_star
id|lp
comma
op_star
id|id
suffix:semicolon
r_int
r_int
id|ul
suffix:semicolon
r_int
id|l
suffix:semicolon
op_star
id|obj
op_assign
l_int|NULL
suffix:semicolon
id|id
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|asn1_header_decode
c_func
(paren
id|ctx
comma
op_amp
id|eoc
comma
op_amp
id|cls
comma
op_amp
id|con
comma
op_amp
id|tag
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|cls
op_ne
id|ASN1_UNI
op_logical_or
id|con
op_ne
id|ASN1_CON
op_logical_or
id|tag
op_ne
id|ASN1_SEQ
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|asn1_header_decode
c_func
(paren
id|ctx
comma
op_amp
id|end
comma
op_amp
id|cls
comma
op_amp
id|con
comma
op_amp
id|tag
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|cls
op_ne
id|ASN1_UNI
op_logical_or
id|con
op_ne
id|ASN1_PRI
op_logical_or
id|tag
op_ne
id|ASN1_OJI
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|asn1_oid_decode
c_func
(paren
id|ctx
comma
id|end
comma
op_amp
id|id
comma
op_amp
id|idlen
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|asn1_header_decode
c_func
(paren
id|ctx
comma
op_amp
id|end
comma
op_amp
id|cls
comma
op_amp
id|con
comma
op_amp
id|tag
)paren
)paren
(brace
id|kfree
c_func
(paren
id|id
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|con
op_ne
id|ASN1_PRI
)paren
(brace
id|kfree
c_func
(paren
id|id
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|snmp_tag_cls2syntax
c_func
(paren
id|tag
comma
id|cls
comma
op_amp
id|type
)paren
)paren
(brace
id|kfree
c_func
(paren
id|id
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|type
)paren
(brace
r_case
id|SNMP_INTEGER
suffix:colon
id|len
op_assign
r_sizeof
(paren
r_int
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|asn1_long_decode
c_func
(paren
id|ctx
comma
id|end
comma
op_amp
id|l
)paren
)paren
(brace
id|kfree
c_func
(paren
id|id
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
op_star
id|obj
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|snmp_object
)paren
op_plus
id|len
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
r_if
c_cond
(paren
op_star
id|obj
op_eq
l_int|NULL
)paren
(brace
id|kfree
c_func
(paren
id|id
)paren
suffix:semicolon
r_if
c_cond
(paren
id|net_ratelimit
c_func
(paren
)paren
)paren
id|printk
c_func
(paren
l_string|&quot;OOM in bsalg (%d)&bslash;n&quot;
comma
id|__LINE__
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
(paren
op_star
id|obj
)paren
op_member_access_from_pointer
id|syntax.l
(braket
l_int|0
)braket
op_assign
id|l
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNMP_OCTETSTR
suffix:colon
r_case
id|SNMP_OPAQUE
suffix:colon
r_if
c_cond
(paren
op_logical_neg
id|asn1_octets_decode
c_func
(paren
id|ctx
comma
id|end
comma
op_amp
id|p
comma
op_amp
id|len
)paren
)paren
(brace
id|kfree
c_func
(paren
id|id
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
op_star
id|obj
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|snmp_object
)paren
op_plus
id|len
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
r_if
c_cond
(paren
op_star
id|obj
op_eq
l_int|NULL
)paren
(brace
id|kfree
c_func
(paren
id|id
)paren
suffix:semicolon
r_if
c_cond
(paren
id|net_ratelimit
c_func
(paren
)paren
)paren
id|printk
c_func
(paren
l_string|&quot;OOM in bsalg (%d)&bslash;n&quot;
comma
id|__LINE__
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|memcpy
c_func
(paren
(paren
op_star
id|obj
)paren
op_member_access_from_pointer
id|syntax.c
comma
id|p
comma
id|len
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|p
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNMP_NULL
suffix:colon
r_case
id|SNMP_NOSUCHOBJECT
suffix:colon
r_case
id|SNMP_NOSUCHINSTANCE
suffix:colon
r_case
id|SNMP_ENDOFMIBVIEW
suffix:colon
id|len
op_assign
l_int|0
suffix:semicolon
op_star
id|obj
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|snmp_object
)paren
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
r_if
c_cond
(paren
op_star
id|obj
op_eq
l_int|NULL
)paren
(brace
id|kfree
c_func
(paren
id|id
)paren
suffix:semicolon
r_if
c_cond
(paren
id|net_ratelimit
c_func
(paren
)paren
)paren
id|printk
c_func
(paren
l_string|&quot;OOM in bsalg (%d)&bslash;n&quot;
comma
id|__LINE__
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|asn1_null_decode
c_func
(paren
id|ctx
comma
id|end
)paren
)paren
(brace
id|kfree
c_func
(paren
id|id
)paren
suffix:semicolon
id|kfree
c_func
(paren
op_star
id|obj
)paren
suffix:semicolon
op_star
id|obj
op_assign
l_int|NULL
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|SNMP_OBJECTID
suffix:colon
r_if
c_cond
(paren
op_logical_neg
id|asn1_oid_decode
c_func
(paren
id|ctx
comma
id|end
comma
(paren
r_int
r_int
op_star
op_star
)paren
op_amp
id|lp
comma
op_amp
id|len
)paren
)paren
(brace
id|kfree
c_func
(paren
id|id
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|len
op_mul_assign
r_sizeof
(paren
r_int
r_int
)paren
suffix:semicolon
op_star
id|obj
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|snmp_object
)paren
op_plus
id|len
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
r_if
c_cond
(paren
op_star
id|obj
op_eq
l_int|NULL
)paren
(brace
id|kfree
c_func
(paren
id|id
)paren
suffix:semicolon
r_if
c_cond
(paren
id|net_ratelimit
c_func
(paren
)paren
)paren
id|printk
c_func
(paren
l_string|&quot;OOM in bsalg (%d)&bslash;n&quot;
comma
id|__LINE__
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|memcpy
c_func
(paren
(paren
op_star
id|obj
)paren
op_member_access_from_pointer
id|syntax.ul
comma
id|lp
comma
id|len
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|lp
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNMP_IPADDR
suffix:colon
r_if
c_cond
(paren
op_logical_neg
id|asn1_octets_decode
c_func
(paren
id|ctx
comma
id|end
comma
op_amp
id|p
comma
op_amp
id|len
)paren
)paren
(brace
id|kfree
c_func
(paren
id|id
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|len
op_ne
l_int|4
)paren
(brace
id|kfree
c_func
(paren
id|p
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|id
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
op_star
id|obj
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|snmp_object
)paren
op_plus
id|len
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
r_if
c_cond
(paren
op_star
id|obj
op_eq
l_int|NULL
)paren
(brace
id|kfree
c_func
(paren
id|p
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|id
)paren
suffix:semicolon
r_if
c_cond
(paren
id|net_ratelimit
c_func
(paren
)paren
)paren
id|printk
c_func
(paren
l_string|&quot;OOM in bsalg (%d)&bslash;n&quot;
comma
id|__LINE__
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|memcpy
c_func
(paren
(paren
op_star
id|obj
)paren
op_member_access_from_pointer
id|syntax.uc
comma
id|p
comma
id|len
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|p
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SNMP_COUNTER
suffix:colon
r_case
id|SNMP_GAUGE
suffix:colon
r_case
id|SNMP_TIMETICKS
suffix:colon
id|len
op_assign
r_sizeof
(paren
r_int
r_int
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|asn1_ulong_decode
c_func
(paren
id|ctx
comma
id|end
comma
op_amp
id|ul
)paren
)paren
(brace
id|kfree
c_func
(paren
id|id
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
op_star
id|obj
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|snmp_object
)paren
op_plus
id|len
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
r_if
c_cond
(paren
op_star
id|obj
op_eq
l_int|NULL
)paren
(brace
id|kfree
c_func
(paren
id|id
)paren
suffix:semicolon
r_if
c_cond
(paren
id|net_ratelimit
c_func
(paren
)paren
)paren
id|printk
c_func
(paren
l_string|&quot;OOM in bsalg (%d)&bslash;n&quot;
comma
id|__LINE__
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
(paren
op_star
id|obj
)paren
op_member_access_from_pointer
id|syntax.ul
(braket
l_int|0
)braket
op_assign
id|ul
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|kfree
c_func
(paren
id|id
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
(paren
op_star
id|obj
)paren
op_member_access_from_pointer
id|syntax_len
op_assign
id|len
suffix:semicolon
(paren
op_star
id|obj
)paren
op_member_access_from_pointer
id|type
op_assign
id|type
suffix:semicolon
(paren
op_star
id|obj
)paren
op_member_access_from_pointer
id|id
op_assign
id|id
suffix:semicolon
(paren
op_star
id|obj
)paren
op_member_access_from_pointer
id|id_len
op_assign
id|idlen
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|asn1_eoc_decode
c_func
(paren
id|ctx
comma
id|eoc
)paren
)paren
(brace
id|kfree
c_func
(paren
id|id
)paren
suffix:semicolon
id|kfree
c_func
(paren
op_star
id|obj
)paren
suffix:semicolon
op_star
id|obj
op_assign
l_int|NULL
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|snmp_request_decode
r_static
r_int
r_char
id|snmp_request_decode
c_func
(paren
r_struct
id|asn1_ctx
op_star
id|ctx
comma
r_struct
id|snmp_request
op_star
id|request
)paren
(brace
r_int
r_int
id|cls
comma
id|con
comma
id|tag
suffix:semicolon
r_int
r_char
op_star
id|end
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|asn1_header_decode
c_func
(paren
id|ctx
comma
op_amp
id|end
comma
op_amp
id|cls
comma
op_amp
id|con
comma
op_amp
id|tag
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|cls
op_ne
id|ASN1_UNI
op_logical_or
id|con
op_ne
id|ASN1_PRI
op_logical_or
id|tag
op_ne
id|ASN1_INT
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|asn1_ulong_decode
c_func
(paren
id|ctx
comma
id|end
comma
op_amp
id|request-&gt;id
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|asn1_header_decode
c_func
(paren
id|ctx
comma
op_amp
id|end
comma
op_amp
id|cls
comma
op_amp
id|con
comma
op_amp
id|tag
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|cls
op_ne
id|ASN1_UNI
op_logical_or
id|con
op_ne
id|ASN1_PRI
op_logical_or
id|tag
op_ne
id|ASN1_INT
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|asn1_uint_decode
c_func
(paren
id|ctx
comma
id|end
comma
op_amp
id|request-&gt;error_status
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|asn1_header_decode
c_func
(paren
id|ctx
comma
op_amp
id|end
comma
op_amp
id|cls
comma
op_amp
id|con
comma
op_amp
id|tag
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|cls
op_ne
id|ASN1_UNI
op_logical_or
id|con
op_ne
id|ASN1_PRI
op_logical_or
id|tag
op_ne
id|ASN1_INT
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|asn1_uint_decode
c_func
(paren
id|ctx
comma
id|end
comma
op_amp
id|request-&gt;error_index
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|snmp_trap_decode
r_static
r_int
r_char
id|snmp_trap_decode
c_func
(paren
r_struct
id|asn1_ctx
op_star
id|ctx
comma
r_struct
id|snmp_v1_trap
op_star
id|trap
comma
r_const
r_struct
id|oct1_map
op_star
id|map
comma
id|u_int16_t
op_star
id|check
)paren
(brace
r_int
r_int
id|cls
comma
id|con
comma
id|tag
comma
id|len
suffix:semicolon
r_int
r_char
op_star
id|end
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|asn1_header_decode
c_func
(paren
id|ctx
comma
op_amp
id|end
comma
op_amp
id|cls
comma
op_amp
id|con
comma
op_amp
id|tag
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|cls
op_ne
id|ASN1_UNI
op_logical_or
id|con
op_ne
id|ASN1_PRI
op_logical_or
id|tag
op_ne
id|ASN1_OJI
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|asn1_oid_decode
c_func
(paren
id|ctx
comma
id|end
comma
op_amp
id|trap-&gt;id
comma
op_amp
id|trap-&gt;id_len
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|asn1_header_decode
c_func
(paren
id|ctx
comma
op_amp
id|end
comma
op_amp
id|cls
comma
op_amp
id|con
comma
op_amp
id|tag
)paren
)paren
r_goto
id|err_id_free
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
(paren
id|cls
op_eq
id|ASN1_APL
op_logical_and
id|con
op_eq
id|ASN1_PRI
op_logical_and
id|tag
op_eq
id|SNMP_IPA
)paren
op_logical_or
(paren
id|cls
op_eq
id|ASN1_UNI
op_logical_and
id|con
op_eq
id|ASN1_PRI
op_logical_and
id|tag
op_eq
id|ASN1_OTS
)paren
)paren
)paren
r_goto
id|err_id_free
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|asn1_octets_decode
c_func
(paren
id|ctx
comma
id|end
comma
(paren
r_int
r_char
op_star
op_star
)paren
op_amp
id|trap-&gt;ip_address
comma
op_amp
id|len
)paren
)paren
r_goto
id|err_id_free
suffix:semicolon
multiline_comment|/* IPv4 only */
r_if
c_cond
(paren
id|len
op_ne
l_int|4
)paren
r_goto
id|err_addr_free
suffix:semicolon
id|mangle_address
c_func
(paren
id|ctx-&gt;begin
comma
id|ctx-&gt;pointer
op_minus
l_int|4
comma
id|map
comma
id|check
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|asn1_header_decode
c_func
(paren
id|ctx
comma
op_amp
id|end
comma
op_amp
id|cls
comma
op_amp
id|con
comma
op_amp
id|tag
)paren
)paren
r_goto
id|err_addr_free
suffix:semicolon
r_if
c_cond
(paren
id|cls
op_ne
id|ASN1_UNI
op_logical_or
id|con
op_ne
id|ASN1_PRI
op_logical_or
id|tag
op_ne
id|ASN1_INT
)paren
r_goto
id|err_addr_free
suffix:semicolon
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|asn1_uint_decode
c_func
(paren
id|ctx
comma
id|end
comma
op_amp
id|trap-&gt;general
)paren
)paren
r_goto
id|err_addr_free
suffix:semicolon
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|asn1_header_decode
c_func
(paren
id|ctx
comma
op_amp
id|end
comma
op_amp
id|cls
comma
op_amp
id|con
comma
op_amp
id|tag
)paren
)paren
r_goto
id|err_addr_free
suffix:semicolon
r_if
c_cond
(paren
id|cls
op_ne
id|ASN1_UNI
op_logical_or
id|con
op_ne
id|ASN1_PRI
op_logical_or
id|tag
op_ne
id|ASN1_INT
)paren
r_goto
id|err_addr_free
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|asn1_uint_decode
c_func
(paren
id|ctx
comma
id|end
comma
op_amp
id|trap-&gt;specific
)paren
)paren
r_goto
id|err_addr_free
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|asn1_header_decode
c_func
(paren
id|ctx
comma
op_amp
id|end
comma
op_amp
id|cls
comma
op_amp
id|con
comma
op_amp
id|tag
)paren
)paren
r_goto
id|err_addr_free
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
(paren
id|cls
op_eq
id|ASN1_APL
op_logical_and
id|con
op_eq
id|ASN1_PRI
op_logical_and
id|tag
op_eq
id|SNMP_TIT
)paren
op_logical_or
(paren
id|cls
op_eq
id|ASN1_UNI
op_logical_and
id|con
op_eq
id|ASN1_PRI
op_logical_and
id|tag
op_eq
id|ASN1_INT
)paren
)paren
)paren
r_goto
id|err_addr_free
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|asn1_ulong_decode
c_func
(paren
id|ctx
comma
id|end
comma
op_amp
id|trap-&gt;time
)paren
)paren
r_goto
id|err_addr_free
suffix:semicolon
r_return
l_int|1
suffix:semicolon
id|err_id_free
suffix:colon
id|kfree
c_func
(paren
id|trap-&gt;id
)paren
suffix:semicolon
id|err_addr_free
suffix:colon
id|kfree
c_func
(paren
(paren
r_int
r_int
op_star
)paren
id|trap-&gt;ip_address
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*****************************************************************************&n; *&n; * Misc. routines&n; *&n; *****************************************************************************/
DECL|function|hex_dump
r_static
r_void
id|hex_dump
c_func
(paren
r_int
r_char
op_star
id|buf
comma
r_int
id|len
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|len
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|i
op_logical_and
op_logical_neg
(paren
id|i
op_mod
l_int|16
)paren
)paren
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%02x &quot;
comma
op_star
(paren
id|buf
op_plus
id|i
)paren
)paren
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
)brace
multiline_comment|/* &n; * Fast checksum update for possibly oddly-aligned UDP byte, from the&n; * code example in the draft.&n; */
DECL|function|fast_csum
r_static
r_void
id|fast_csum
c_func
(paren
r_int
r_char
op_star
id|csum
comma
r_const
r_int
r_char
op_star
id|optr
comma
r_const
r_int
r_char
op_star
id|nptr
comma
r_int
id|odd
)paren
(brace
r_int
id|x
comma
id|old
comma
r_new
suffix:semicolon
id|x
op_assign
id|csum
(braket
l_int|0
)braket
op_star
l_int|256
op_plus
id|csum
(braket
l_int|1
)braket
suffix:semicolon
id|x
op_assign
op_complement
id|x
op_amp
l_int|0xFFFF
suffix:semicolon
r_if
c_cond
(paren
id|odd
)paren
id|old
op_assign
id|optr
(braket
l_int|0
)braket
op_star
l_int|256
suffix:semicolon
r_else
id|old
op_assign
id|optr
(braket
l_int|0
)braket
suffix:semicolon
id|x
op_sub_assign
id|old
op_amp
l_int|0xFFFF
suffix:semicolon
r_if
c_cond
(paren
id|x
op_le
l_int|0
)paren
(brace
id|x
op_decrement
suffix:semicolon
id|x
op_and_assign
l_int|0xFFFF
suffix:semicolon
)brace
r_if
c_cond
(paren
id|odd
)paren
r_new
op_assign
id|nptr
(braket
l_int|0
)braket
op_star
l_int|256
suffix:semicolon
r_else
r_new
op_assign
id|nptr
(braket
l_int|0
)braket
suffix:semicolon
id|x
op_add_assign
r_new
op_amp
l_int|0xFFFF
suffix:semicolon
r_if
c_cond
(paren
id|x
op_amp
l_int|0x10000
)paren
(brace
id|x
op_increment
suffix:semicolon
id|x
op_and_assign
l_int|0xFFFF
suffix:semicolon
)brace
id|x
op_assign
op_complement
id|x
op_amp
l_int|0xFFFF
suffix:semicolon
id|csum
(braket
l_int|0
)braket
op_assign
id|x
op_div
l_int|256
suffix:semicolon
id|csum
(braket
l_int|1
)braket
op_assign
id|x
op_amp
l_int|0xFF
suffix:semicolon
)brace
multiline_comment|/* &n; * Mangle IP address.&n; * &t;- begin points to the start of the snmp messgae&n; *      - addr points to the start of the address&n; */
DECL|function|mangle_address
r_static
r_void
r_inline
id|mangle_address
c_func
(paren
r_int
r_char
op_star
id|begin
comma
r_int
r_char
op_star
id|addr
comma
r_const
r_struct
id|oct1_map
op_star
id|map
comma
id|u_int16_t
op_star
id|check
)paren
(brace
r_if
c_cond
(paren
id|map-&gt;from
op_eq
id|NOCT1
c_func
(paren
op_star
id|addr
)paren
)paren
(brace
id|u_int32_t
id|old
suffix:semicolon
r_if
c_cond
(paren
id|debug
)paren
id|memcpy
c_func
(paren
op_amp
id|old
comma
(paren
r_int
r_char
op_star
)paren
id|addr
comma
r_sizeof
(paren
id|old
)paren
)paren
suffix:semicolon
op_star
id|addr
op_assign
id|map-&gt;to
suffix:semicolon
multiline_comment|/* Update UDP checksum if being used */
r_if
c_cond
(paren
op_star
id|check
)paren
(brace
r_int
r_char
id|odd
op_assign
op_logical_neg
(paren
(paren
id|addr
op_minus
id|begin
)paren
op_mod
l_int|2
)paren
suffix:semicolon
id|fast_csum
c_func
(paren
(paren
r_int
r_char
op_star
)paren
id|check
comma
op_amp
id|map-&gt;from
comma
op_amp
id|map-&gt;to
comma
id|odd
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|debug
)paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;bsalg: mapped %u.%u.%u.%u to &quot;
l_string|&quot;%u.%u.%u.%u&bslash;n&quot;
comma
id|NIPQUAD
c_func
(paren
id|old
)paren
comma
id|NIPQUAD
c_func
(paren
op_star
id|addr
)paren
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/*&n; * Parse and mangle SNMP message according to mapping.&n; * (And this is the fucking &squot;basic&squot; method).&n; */
DECL|function|snmp_parse_mangle
r_static
r_int
id|snmp_parse_mangle
c_func
(paren
r_int
r_char
op_star
id|msg
comma
id|u_int16_t
id|len
comma
r_const
r_struct
id|oct1_map
op_star
id|map
comma
id|u_int16_t
op_star
id|check
)paren
(brace
r_int
r_char
op_star
id|eoc
comma
op_star
id|end
suffix:semicolon
r_int
r_int
id|cls
comma
id|con
comma
id|tag
comma
id|vers
comma
id|pdutype
suffix:semicolon
r_struct
id|asn1_ctx
id|ctx
suffix:semicolon
r_struct
id|asn1_octstr
id|comm
suffix:semicolon
r_struct
id|snmp_object
op_star
op_star
id|obj
suffix:semicolon
r_if
c_cond
(paren
id|debug
OG
l_int|1
)paren
id|hex_dump
c_func
(paren
id|msg
comma
id|len
)paren
suffix:semicolon
id|asn1_open
c_func
(paren
op_amp
id|ctx
comma
id|msg
comma
id|len
)paren
suffix:semicolon
multiline_comment|/* &n;&t; * Start of SNMP message.&n;&t; */
r_if
c_cond
(paren
op_logical_neg
id|asn1_header_decode
c_func
(paren
op_amp
id|ctx
comma
op_amp
id|eoc
comma
op_amp
id|cls
comma
op_amp
id|con
comma
op_amp
id|tag
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|cls
op_ne
id|ASN1_UNI
op_logical_or
id|con
op_ne
id|ASN1_CON
op_logical_or
id|tag
op_ne
id|ASN1_SEQ
)paren
r_return
l_int|0
suffix:semicolon
multiline_comment|/* &n;&t; * Version 1 or 2 handled.&n;&t; */
r_if
c_cond
(paren
op_logical_neg
id|asn1_header_decode
c_func
(paren
op_amp
id|ctx
comma
op_amp
id|end
comma
op_amp
id|cls
comma
op_amp
id|con
comma
op_amp
id|tag
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|cls
op_ne
id|ASN1_UNI
op_logical_or
id|con
op_ne
id|ASN1_PRI
op_logical_or
id|tag
op_ne
id|ASN1_INT
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|asn1_uint_decode
(paren
op_amp
id|ctx
comma
id|end
comma
op_amp
id|vers
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|debug
OG
l_int|1
)paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;bsalg: snmp version: %u&bslash;n&quot;
comma
id|vers
op_plus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|vers
OG
l_int|1
)paren
r_return
l_int|1
suffix:semicolon
multiline_comment|/*&n;&t; * Community.&n;&t; */
r_if
c_cond
(paren
op_logical_neg
id|asn1_header_decode
(paren
op_amp
id|ctx
comma
op_amp
id|end
comma
op_amp
id|cls
comma
op_amp
id|con
comma
op_amp
id|tag
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|cls
op_ne
id|ASN1_UNI
op_logical_or
id|con
op_ne
id|ASN1_PRI
op_logical_or
id|tag
op_ne
id|ASN1_OTS
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|asn1_octets_decode
c_func
(paren
op_amp
id|ctx
comma
id|end
comma
op_amp
id|comm.data
comma
op_amp
id|comm.len
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|debug
OG
l_int|1
)paren
(brace
r_int
r_int
id|i
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;bsalg: community: &quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|comm.len
suffix:semicolon
id|i
op_increment
)paren
id|printk
c_func
(paren
l_string|&quot;%c&quot;
comma
id|comm.data
(braket
id|i
)braket
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
)brace
id|kfree
c_func
(paren
id|comm.data
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * PDU type&n;&t; */
r_if
c_cond
(paren
op_logical_neg
id|asn1_header_decode
c_func
(paren
op_amp
id|ctx
comma
op_amp
id|eoc
comma
op_amp
id|cls
comma
op_amp
id|con
comma
op_amp
id|pdutype
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|cls
op_ne
id|ASN1_CTX
op_logical_or
id|con
op_ne
id|ASN1_CON
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|debug
OG
l_int|1
)paren
(brace
r_int
r_char
op_star
id|pdus
(braket
)braket
op_assign
(brace
(braket
id|SNMP_PDU_GET
)braket
op_assign
l_string|&quot;get&quot;
comma
(braket
id|SNMP_PDU_NEXT
)braket
op_assign
l_string|&quot;get-next&quot;
comma
(braket
id|SNMP_PDU_RESPONSE
)braket
op_assign
l_string|&quot;response&quot;
comma
(braket
id|SNMP_PDU_SET
)braket
op_assign
l_string|&quot;set&quot;
comma
(braket
id|SNMP_PDU_TRAP1
)braket
op_assign
l_string|&quot;trapv1&quot;
comma
(braket
id|SNMP_PDU_BULK
)braket
op_assign
l_string|&quot;bulk&quot;
comma
(braket
id|SNMP_PDU_INFORM
)braket
op_assign
l_string|&quot;inform&quot;
comma
(braket
id|SNMP_PDU_TRAP2
)braket
op_assign
l_string|&quot;trapv2&quot;
)brace
suffix:semicolon
r_if
c_cond
(paren
id|pdutype
OG
id|SNMP_PDU_TRAP2
)paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;bsalg: bad pdu type %u&bslash;n&quot;
comma
id|pdutype
)paren
suffix:semicolon
r_else
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;bsalg: pdu: %s&bslash;n&quot;
comma
id|pdus
(braket
id|pdutype
)braket
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|pdutype
op_ne
id|SNMP_PDU_RESPONSE
op_logical_and
id|pdutype
op_ne
id|SNMP_PDU_TRAP1
op_logical_and
id|pdutype
op_ne
id|SNMP_PDU_TRAP2
)paren
r_return
l_int|1
suffix:semicolon
multiline_comment|/*&n;&t; * Request header or v1 trap&n;&t; */
r_if
c_cond
(paren
id|pdutype
op_eq
id|SNMP_PDU_TRAP1
)paren
(brace
r_struct
id|snmp_v1_trap
id|trap
suffix:semicolon
r_int
r_char
id|ret
op_assign
id|snmp_trap_decode
c_func
(paren
op_amp
id|ctx
comma
op_amp
id|trap
comma
id|map
comma
id|check
)paren
suffix:semicolon
multiline_comment|/* Discard trap allocations regardless */
id|kfree
c_func
(paren
id|trap.id
)paren
suffix:semicolon
id|kfree
c_func
(paren
(paren
r_int
r_int
op_star
)paren
id|trap.ip_address
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ret
)paren
r_return
id|ret
suffix:semicolon
)brace
r_else
(brace
r_struct
id|snmp_request
id|req
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snmp_request_decode
c_func
(paren
op_amp
id|ctx
comma
op_amp
id|req
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|debug
OG
l_int|1
)paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;bsalg: request: id=0x%lx error_status=%u &quot;
l_string|&quot;error_index=%u&bslash;n&quot;
comma
id|req.id
comma
id|req.error_status
comma
id|req.error_index
)paren
suffix:semicolon
)brace
multiline_comment|/*&n;&t; * Loop through objects, look for IP addresses to mangle.&n;&t; */
r_if
c_cond
(paren
op_logical_neg
id|asn1_header_decode
c_func
(paren
op_amp
id|ctx
comma
op_amp
id|eoc
comma
op_amp
id|cls
comma
op_amp
id|con
comma
op_amp
id|tag
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|cls
op_ne
id|ASN1_UNI
op_logical_or
id|con
op_ne
id|ASN1_CON
op_logical_or
id|tag
op_ne
id|ASN1_SEQ
)paren
r_return
l_int|0
suffix:semicolon
id|obj
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|snmp_object
)paren
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
r_if
c_cond
(paren
id|obj
op_eq
l_int|NULL
)paren
(brace
r_if
c_cond
(paren
id|net_ratelimit
c_func
(paren
)paren
)paren
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;OOM in bsalg(%d)&bslash;n&quot;
comma
id|__LINE__
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_while
c_loop
(paren
op_logical_neg
id|asn1_eoc_decode
c_func
(paren
op_amp
id|ctx
comma
id|eoc
)paren
)paren
(brace
r_int
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snmp_object_decode
c_func
(paren
op_amp
id|ctx
comma
id|obj
)paren
)paren
(brace
r_if
c_cond
(paren
op_star
id|obj
)paren
(brace
r_if
c_cond
(paren
(paren
op_star
id|obj
)paren
op_member_access_from_pointer
id|id
)paren
id|kfree
c_func
(paren
(paren
op_star
id|obj
)paren
op_member_access_from_pointer
id|id
)paren
suffix:semicolon
id|kfree
c_func
(paren
op_star
id|obj
)paren
suffix:semicolon
)brace
id|kfree
c_func
(paren
id|obj
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|debug
OG
l_int|1
)paren
(brace
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;bsalg: object: &quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
(paren
op_star
id|obj
)paren
op_member_access_from_pointer
id|id_len
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|i
OG
l_int|0
)paren
id|printk
c_func
(paren
l_string|&quot;.&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%lu&quot;
comma
(paren
op_star
id|obj
)paren
op_member_access_from_pointer
id|id
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;: type=%u&bslash;n&quot;
comma
(paren
op_star
id|obj
)paren
op_member_access_from_pointer
id|type
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
op_star
id|obj
)paren
op_member_access_from_pointer
id|type
op_eq
id|SNMP_IPADDR
)paren
id|mangle_address
c_func
(paren
id|ctx.begin
comma
id|ctx.pointer
op_minus
l_int|4
comma
id|map
comma
id|check
)paren
suffix:semicolon
id|kfree
c_func
(paren
(paren
op_star
id|obj
)paren
op_member_access_from_pointer
id|id
)paren
suffix:semicolon
id|kfree
c_func
(paren
op_star
id|obj
)paren
suffix:semicolon
)brace
id|kfree
c_func
(paren
id|obj
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|asn1_eoc_decode
c_func
(paren
op_amp
id|ctx
comma
id|eoc
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
multiline_comment|/*****************************************************************************&n; *&n; * NAT routines.&n; *&n; *****************************************************************************/
multiline_comment|/* &n; * SNMP translation routine.&n; */
DECL|function|snmp_translate
r_static
r_int
id|snmp_translate
c_func
(paren
r_struct
id|ip_conntrack
op_star
id|ct
comma
r_struct
id|ip_nat_info
op_star
id|info
comma
r_enum
id|ip_conntrack_info
id|ctinfo
comma
r_int
r_int
id|hooknum
comma
r_struct
id|sk_buff
op_star
op_star
id|pskb
)paren
(brace
r_struct
id|iphdr
op_star
id|iph
op_assign
(paren
op_star
id|pskb
)paren
op_member_access_from_pointer
id|nh.iph
suffix:semicolon
r_struct
id|udphdr
op_star
id|udph
op_assign
(paren
r_struct
id|udphdr
op_star
)paren
(paren
(paren
id|u_int32_t
op_star
)paren
id|iph
op_plus
id|iph-&gt;ihl
)paren
suffix:semicolon
id|u_int16_t
id|udplen
op_assign
id|ntohs
c_func
(paren
id|udph-&gt;len
)paren
suffix:semicolon
id|u_int16_t
id|paylen
op_assign
id|udplen
op_minus
r_sizeof
(paren
r_struct
id|udphdr
)paren
suffix:semicolon
r_int
id|dir
op_assign
id|CTINFO2DIR
c_func
(paren
id|ctinfo
)paren
suffix:semicolon
r_struct
id|oct1_map
id|map
suffix:semicolon
multiline_comment|/*&n;&t; * Determine mappping for application layer addresses based&n;&t; * on NAT manipulations for the packet.&n;&t; */
r_if
c_cond
(paren
id|dir
op_eq
id|IP_CT_DIR_ORIGINAL
)paren
(brace
multiline_comment|/* SNAT traps */
id|map.from
op_assign
id|NOCT1
c_func
(paren
id|ct-&gt;tuplehash
(braket
id|IP_CT_DIR_ORIGINAL
)braket
dot
id|tuple.src.ip
)paren
suffix:semicolon
id|map.to
op_assign
id|NOCT1
c_func
(paren
id|ct-&gt;tuplehash
(braket
id|IP_CT_DIR_REPLY
)braket
dot
id|tuple.dst.ip
)paren
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* DNAT replies */
id|map.from
op_assign
id|NOCT1
c_func
(paren
id|ct-&gt;tuplehash
(braket
id|IP_CT_DIR_REPLY
)braket
dot
id|tuple.src.ip
)paren
suffix:semicolon
id|map.to
op_assign
id|NOCT1
c_func
(paren
id|ct-&gt;tuplehash
(braket
id|IP_CT_DIR_ORIGINAL
)braket
dot
id|tuple.dst.ip
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|map.from
op_eq
id|map.to
)paren
r_return
id|NF_ACCEPT
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|snmp_parse_mangle
c_func
(paren
(paren
r_int
r_char
op_star
)paren
id|udph
op_plus
r_sizeof
(paren
r_struct
id|udphdr
)paren
comma
id|paylen
comma
op_amp
id|map
comma
op_amp
id|udph-&gt;check
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;bsalg: parser failed&bslash;n&quot;
)paren
suffix:semicolon
r_return
id|NF_DROP
suffix:semicolon
)brace
r_return
id|NF_ACCEPT
suffix:semicolon
)brace
multiline_comment|/* &n; * NAT helper function, packets arrive here from NAT code.&n; */
DECL|function|nat_help
r_static
r_int
r_int
id|nat_help
c_func
(paren
r_struct
id|ip_conntrack
op_star
id|ct
comma
r_struct
id|ip_nat_info
op_star
id|info
comma
r_enum
id|ip_conntrack_info
id|ctinfo
comma
r_int
r_int
id|hooknum
comma
r_struct
id|sk_buff
op_star
op_star
id|pskb
)paren
(brace
r_int
id|dir
op_assign
id|CTINFO2DIR
c_func
(paren
id|ctinfo
)paren
suffix:semicolon
r_struct
id|iphdr
op_star
id|iph
op_assign
(paren
op_star
id|pskb
)paren
op_member_access_from_pointer
id|nh.iph
suffix:semicolon
r_struct
id|udphdr
op_star
id|udph
op_assign
(paren
r_struct
id|udphdr
op_star
)paren
(paren
(paren
id|u_int32_t
op_star
)paren
id|iph
op_plus
id|iph-&gt;ihl
)paren
suffix:semicolon
id|spin_lock_bh
c_func
(paren
op_amp
id|snmp_lock
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * Translate snmp replies on pre-routing (DNAT) and snmp traps&n;&t; * on post routing (SNAT).&n;&t; */
r_if
c_cond
(paren
op_logical_neg
(paren
(paren
id|dir
op_eq
id|IP_CT_DIR_REPLY
op_logical_and
id|hooknum
op_eq
id|NF_IP_PRE_ROUTING
op_logical_and
id|udph-&gt;source
op_eq
id|__constant_ntohs
c_func
(paren
id|SNMP_PORT
)paren
)paren
op_logical_or
(paren
id|dir
op_eq
id|IP_CT_DIR_ORIGINAL
op_logical_and
id|hooknum
op_eq
id|NF_IP_POST_ROUTING
op_logical_and
id|udph-&gt;dest
op_eq
id|__constant_ntohs
c_func
(paren
id|SNMP_TRAP_PORT
)paren
)paren
)paren
)paren
(brace
id|spin_unlock_bh
c_func
(paren
op_amp
id|snmp_lock
)paren
suffix:semicolon
r_return
id|NF_ACCEPT
suffix:semicolon
)brace
r_if
c_cond
(paren
id|debug
OG
l_int|1
)paren
(brace
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;bsalg: dir=%s hook=%d manip=%s len=%d &quot;
l_string|&quot;src=%u.%u.%u.%u:%u dst=%u.%u.%u.%u:%u &quot;
l_string|&quot;osrc=%u.%u.%u.%u odst=%u.%u.%u.%u &quot;
l_string|&quot;rsrc=%u.%u.%u.%u rdst=%u.%u.%u.%u &quot;
l_string|&quot;&bslash;n&quot;
comma
id|dir
op_eq
id|IP_CT_DIR_REPLY
ques
c_cond
l_string|&quot;reply&quot;
suffix:colon
l_string|&quot;orig&quot;
comma
id|hooknum
comma
id|HOOK2MANIP
c_func
(paren
id|hooknum
)paren
op_eq
id|IP_NAT_MANIP_SRC
ques
c_cond
l_string|&quot;snat&quot;
suffix:colon
l_string|&quot;dnat&quot;
comma
(paren
op_star
id|pskb
)paren
op_member_access_from_pointer
id|len
comma
id|NIPQUAD
c_func
(paren
id|iph-&gt;saddr
)paren
comma
id|ntohs
c_func
(paren
id|udph-&gt;source
)paren
comma
id|NIPQUAD
c_func
(paren
id|iph-&gt;daddr
)paren
comma
id|ntohs
c_func
(paren
id|udph-&gt;dest
)paren
comma
id|NIPQUAD
c_func
(paren
id|ct-&gt;tuplehash
(braket
id|IP_CT_DIR_ORIGINAL
)braket
dot
id|tuple.src.ip
)paren
comma
id|NIPQUAD
c_func
(paren
id|ct-&gt;tuplehash
(braket
id|IP_CT_DIR_ORIGINAL
)braket
dot
id|tuple.dst.ip
)paren
comma
id|NIPQUAD
c_func
(paren
id|ct-&gt;tuplehash
(braket
id|IP_CT_DIR_REPLY
)braket
dot
id|tuple.src.ip
)paren
comma
id|NIPQUAD
c_func
(paren
id|ct-&gt;tuplehash
(braket
id|IP_CT_DIR_REPLY
)braket
dot
id|tuple.dst.ip
)paren
)paren
suffix:semicolon
)brace
multiline_comment|/* &n;&t; * Make sure the packet length is ok.  So far, we were only guaranteed&n;&t; * to have a valid length IP header plus 8 bytes, which means we have&n;&t; * enough room for a UDP header.  Just verify the UDP length field so we&n;&t; * can mess around with the payload.&n;&t; */
r_if
c_cond
(paren
id|ntohs
c_func
(paren
id|udph-&gt;len
)paren
op_eq
(paren
op_star
id|pskb
)paren
op_member_access_from_pointer
id|len
op_minus
(paren
id|iph-&gt;ihl
op_lshift
l_int|2
)paren
)paren
(brace
r_int
id|ret
op_assign
id|snmp_translate
c_func
(paren
id|ct
comma
id|info
comma
id|ctinfo
comma
id|hooknum
comma
id|pskb
)paren
suffix:semicolon
id|spin_unlock_bh
c_func
(paren
op_amp
id|snmp_lock
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
r_if
c_cond
(paren
id|net_ratelimit
c_func
(paren
)paren
)paren
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;bsalg: dropping malformed packet &quot;
l_string|&quot;src=%u.%u.%u.%u dst=%u.%u.%u.%u&bslash;n&quot;
comma
id|NIPQUAD
c_func
(paren
id|iph-&gt;saddr
)paren
comma
id|NIPQUAD
c_func
(paren
id|iph-&gt;daddr
)paren
)paren
suffix:semicolon
id|spin_unlock_bh
c_func
(paren
op_amp
id|snmp_lock
)paren
suffix:semicolon
r_return
id|NF_DROP
suffix:semicolon
)brace
DECL|variable|snmp
r_static
r_struct
id|ip_nat_helper
id|snmp
op_assign
(brace
(brace
l_int|NULL
comma
l_int|NULL
)brace
comma
(brace
(brace
l_int|0
comma
(brace
id|__constant_htons
c_func
(paren
id|SNMP_PORT
)paren
)brace
)brace
comma
(brace
l_int|0
comma
(brace
l_int|0
)brace
comma
id|IPPROTO_UDP
)brace
)brace
comma
(brace
(brace
l_int|0
comma
(brace
l_int|0xFFFF
)brace
)brace
comma
(brace
l_int|0
comma
(brace
l_int|0
)brace
comma
l_int|0xFFFF
)brace
)brace
comma
id|nat_help
comma
l_string|&quot;snmp&quot;
)brace
suffix:semicolon
DECL|variable|snmp_trap
r_static
r_struct
id|ip_nat_helper
id|snmp_trap
op_assign
(brace
(brace
l_int|NULL
comma
l_int|NULL
)brace
comma
(brace
(brace
l_int|0
comma
(brace
id|__constant_htons
c_func
(paren
id|SNMP_TRAP_PORT
)paren
)brace
)brace
comma
(brace
l_int|0
comma
(brace
l_int|0
)brace
comma
id|IPPROTO_UDP
)brace
)brace
comma
(brace
(brace
l_int|0
comma
(brace
l_int|0xFFFF
)brace
)brace
comma
(brace
l_int|0
comma
(brace
l_int|0
)brace
comma
l_int|0xFFFF
)brace
)brace
comma
id|nat_help
comma
l_string|&quot;snmp_trap&quot;
)brace
suffix:semicolon
multiline_comment|/*****************************************************************************&n; *&n; * Module stuff.&n; *&n; *****************************************************************************/
DECL|function|init
r_static
r_int
id|__init
id|init
c_func
(paren
r_void
)paren
(brace
r_int
id|ret
op_assign
l_int|0
suffix:semicolon
id|ret
op_assign
id|ip_nat_helper_register
c_func
(paren
op_amp
id|snmp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
OL
l_int|0
)paren
r_return
id|ret
suffix:semicolon
id|ret
op_assign
id|ip_nat_helper_register
c_func
(paren
op_amp
id|snmp_trap
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
OL
l_int|0
)paren
(brace
id|ip_nat_helper_unregister
c_func
(paren
op_amp
id|snmp
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
r_return
id|ret
suffix:semicolon
)brace
DECL|function|fini
r_static
r_void
id|__exit
id|fini
c_func
(paren
r_void
)paren
(brace
id|ip_nat_helper_unregister
c_func
(paren
op_amp
id|snmp
)paren
suffix:semicolon
id|ip_nat_helper_unregister
c_func
(paren
op_amp
id|snmp_trap
)paren
suffix:semicolon
id|br_write_lock_bh
c_func
(paren
id|BR_NETPROTO_LOCK
)paren
suffix:semicolon
id|br_write_unlock_bh
c_func
(paren
id|BR_NETPROTO_LOCK
)paren
suffix:semicolon
)brace
DECL|variable|init
id|module_init
c_func
(paren
id|init
)paren
suffix:semicolon
DECL|variable|fini
id|module_exit
c_func
(paren
id|fini
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|debug
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_DESCRIPTION
c_func
(paren
l_string|&quot;Basic SNMP Application Layer Gateway&quot;
)paren
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
eof
