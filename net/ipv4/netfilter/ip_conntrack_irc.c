multiline_comment|/* IRC extension for IP connection tracking, Version 1.21&n; * (C) 2000-2002 by Harald Welte &lt;laforge@gnumonks.org&gt;&n; * based on RR&squot;s ip_conntrack_ftp.c&t;&n; *&n; * ip_conntrack_irc.c,v 1.21 2002/02/05 14:49:26 laforge Exp&n; *&n; *      This program is free software; you can redistribute it and/or&n; *      modify it under the terms of the GNU General Public License&n; *      as published by the Free Software Foundation; either version&n; *      2 of the License, or (at your option) any later version.&n; **&n; *&t;Module load syntax:&n; * &t;insmod ip_conntrack_irc.o ports=port1,port2,...port&lt;MAX_PORTS&gt;&n; *&t;&t;&t;    max_dcc_channels=n dcc_timeout=secs&n; *&t;&n; * &t;please give the ports of all IRC servers You wish to connect to.&n; *&t;If You don&squot;t specify ports, the default will be port 6667.&n; *&t;With max_dcc_channels you can define the maximum number of not&n; *&t;yet answered DCC channels per IRC session (default 8).&n; *&t;With dcc_timeout you can specify how long the system waits for &n; *&t;an expected DCC channel (default 300 seconds).&n; *&n; */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/netfilter.h&gt;
macro_line|#include &lt;linux/ip.h&gt;
macro_line|#include &lt;net/checksum.h&gt;
macro_line|#include &lt;net/tcp.h&gt;
macro_line|#include &lt;linux/netfilter_ipv4/lockhelp.h&gt;
macro_line|#include &lt;linux/netfilter_ipv4/ip_conntrack_helper.h&gt;
macro_line|#include &lt;linux/netfilter_ipv4/ip_conntrack_irc.h&gt;
macro_line|#include &lt;linux/moduleparam.h&gt;
DECL|macro|MAX_PORTS
mdefine_line|#define MAX_PORTS 8
DECL|variable|ports
r_static
r_int
id|ports
(braket
id|MAX_PORTS
)braket
suffix:semicolon
DECL|variable|ports_c
r_static
r_int
id|ports_c
suffix:semicolon
DECL|variable|max_dcc_channels
r_static
r_int
id|max_dcc_channels
op_assign
l_int|8
suffix:semicolon
DECL|variable|dcc_timeout
r_static
r_int
r_int
id|dcc_timeout
op_assign
l_int|300
suffix:semicolon
multiline_comment|/* This is slow, but it&squot;s simple. --RR */
DECL|variable|irc_buffer
r_static
r_char
id|irc_buffer
(braket
l_int|65536
)braket
suffix:semicolon
r_static
id|DECLARE_LOCK
c_func
(paren
id|irc_buffer_lock
)paren
suffix:semicolon
id|MODULE_AUTHOR
c_func
(paren
l_string|&quot;Harald Welte &lt;laforge@netfilter.org&gt;&quot;
)paren
suffix:semicolon
id|MODULE_DESCRIPTION
c_func
(paren
l_string|&quot;IRC (DCC) connection tracking helper&quot;
)paren
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
id|module_param_array
c_func
(paren
id|ports
comma
r_int
comma
id|ports_c
comma
l_int|0400
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|ports
comma
l_string|&quot;port numbers of IRC servers&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|max_dcc_channels
comma
r_int
comma
l_int|0400
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|max_dcc_channels
comma
l_string|&quot;max number of expected DCC channels per IRC session&quot;
)paren
suffix:semicolon
id|module_param
c_func
(paren
id|dcc_timeout
comma
r_int
comma
l_int|0400
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|dcc_timeout
comma
l_string|&quot;timeout on for unestablished DCC channels&quot;
)paren
suffix:semicolon
DECL|variable|dccprotos
r_static
r_char
op_star
id|dccprotos
(braket
)braket
op_assign
(brace
l_string|&quot;SEND &quot;
comma
l_string|&quot;CHAT &quot;
comma
l_string|&quot;MOVE &quot;
comma
l_string|&quot;TSEND &quot;
comma
l_string|&quot;SCHAT &quot;
)brace
suffix:semicolon
DECL|macro|MINMATCHLEN
mdefine_line|#define MINMATCHLEN&t;5
DECL|variable|ip_conntrack_irc
r_struct
id|module
op_star
id|ip_conntrack_irc
op_assign
id|THIS_MODULE
suffix:semicolon
macro_line|#if 0
mdefine_line|#define DEBUGP(format, args...) printk(KERN_DEBUG &quot;%s:%s:&quot; format, &bslash;&n;                                       __FILE__, __FUNCTION__ , ## args)
macro_line|#else
DECL|macro|DEBUGP
mdefine_line|#define DEBUGP(format, args...)
macro_line|#endif
DECL|function|parse_dcc
r_int
id|parse_dcc
c_func
(paren
r_char
op_star
id|data
comma
r_char
op_star
id|data_end
comma
id|u_int32_t
op_star
id|ip
comma
id|u_int16_t
op_star
id|port
comma
r_char
op_star
op_star
id|ad_beg_p
comma
r_char
op_star
op_star
id|ad_end_p
)paren
multiline_comment|/* tries to get the ip_addr and port out of a dcc command&n;   return value: -1 on failure, 0 on success &n;&t;data&t;&t;pointer to first byte of DCC command data&n;&t;data_end&t;pointer to last byte of dcc command data&n;&t;ip&t;&t;returns parsed ip of dcc command&n;&t;port&t;&t;returns parsed port of dcc command&n;&t;ad_beg_p&t;returns pointer to first byte of addr data&n;&t;ad_end_p&t;returns pointer to last byte of addr data */
(brace
multiline_comment|/* at least 12: &quot;AAAAAAAA P&bslash;1&bslash;n&quot; */
r_while
c_loop
(paren
op_star
id|data
op_increment
op_ne
l_char|&squot; &squot;
)paren
r_if
c_cond
(paren
id|data
OG
id|data_end
op_minus
l_int|12
)paren
r_return
op_minus
l_int|1
suffix:semicolon
op_star
id|ad_beg_p
op_assign
id|data
suffix:semicolon
op_star
id|ip
op_assign
id|simple_strtoul
c_func
(paren
id|data
comma
op_amp
id|data
comma
l_int|10
)paren
suffix:semicolon
multiline_comment|/* skip blanks between ip and port */
r_while
c_loop
(paren
op_star
id|data
op_eq
l_char|&squot; &squot;
)paren
(brace
r_if
c_cond
(paren
id|data
op_ge
id|data_end
)paren
r_return
op_minus
l_int|1
suffix:semicolon
id|data
op_increment
suffix:semicolon
)brace
op_star
id|port
op_assign
id|simple_strtoul
c_func
(paren
id|data
comma
op_amp
id|data
comma
l_int|10
)paren
suffix:semicolon
op_star
id|ad_end_p
op_assign
id|data
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|help
r_static
r_int
id|help
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|ip_conntrack
op_star
id|ct
comma
r_enum
id|ip_conntrack_info
id|ctinfo
)paren
(brace
r_int
r_int
id|dataoff
suffix:semicolon
r_struct
id|tcphdr
id|_tcph
comma
op_star
id|th
suffix:semicolon
r_char
op_star
id|data
comma
op_star
id|data_limit
comma
op_star
id|ib_ptr
suffix:semicolon
r_int
id|dir
op_assign
id|CTINFO2DIR
c_func
(paren
id|ctinfo
)paren
suffix:semicolon
r_struct
id|ip_conntrack_expect
op_star
id|exp
suffix:semicolon
r_struct
id|ip_ct_irc_expect
op_star
id|exp_irc_info
op_assign
l_int|NULL
suffix:semicolon
id|u_int32_t
id|dcc_ip
suffix:semicolon
id|u_int16_t
id|dcc_port
suffix:semicolon
r_int
id|i
suffix:semicolon
r_char
op_star
id|addr_beg_p
comma
op_star
id|addr_end_p
suffix:semicolon
id|DEBUGP
c_func
(paren
l_string|&quot;entered&bslash;n&quot;
)paren
suffix:semicolon
multiline_comment|/* If packet is coming from IRC server */
r_if
c_cond
(paren
id|dir
op_eq
id|IP_CT_DIR_REPLY
)paren
r_return
id|NF_ACCEPT
suffix:semicolon
multiline_comment|/* Until there&squot;s been traffic both ways, don&squot;t look in packets. */
r_if
c_cond
(paren
id|ctinfo
op_ne
id|IP_CT_ESTABLISHED
op_logical_and
id|ctinfo
op_ne
id|IP_CT_ESTABLISHED
op_plus
id|IP_CT_IS_REPLY
)paren
(brace
id|DEBUGP
c_func
(paren
l_string|&quot;Conntrackinfo = %u&bslash;n&quot;
comma
id|ctinfo
)paren
suffix:semicolon
r_return
id|NF_ACCEPT
suffix:semicolon
)brace
multiline_comment|/* Not a full tcp header? */
id|th
op_assign
id|skb_header_pointer
c_func
(paren
id|skb
comma
id|skb-&gt;nh.iph-&gt;ihl
op_star
l_int|4
comma
r_sizeof
(paren
id|_tcph
)paren
comma
op_amp
id|_tcph
)paren
suffix:semicolon
r_if
c_cond
(paren
id|th
op_eq
l_int|NULL
)paren
r_return
id|NF_ACCEPT
suffix:semicolon
multiline_comment|/* No data? */
id|dataoff
op_assign
id|skb-&gt;nh.iph-&gt;ihl
op_star
l_int|4
op_plus
id|th-&gt;doff
op_star
l_int|4
suffix:semicolon
r_if
c_cond
(paren
id|dataoff
op_ge
id|skb-&gt;len
)paren
r_return
id|NF_ACCEPT
suffix:semicolon
id|LOCK_BH
c_func
(paren
op_amp
id|irc_buffer_lock
)paren
suffix:semicolon
id|ib_ptr
op_assign
id|skb_header_pointer
c_func
(paren
id|skb
comma
id|dataoff
comma
id|skb-&gt;len
op_minus
id|dataoff
comma
id|irc_buffer
)paren
suffix:semicolon
id|BUG_ON
c_func
(paren
id|ib_ptr
op_eq
l_int|NULL
)paren
suffix:semicolon
id|data
op_assign
id|ib_ptr
suffix:semicolon
id|data_limit
op_assign
id|ib_ptr
op_plus
id|skb-&gt;len
op_minus
id|dataoff
suffix:semicolon
multiline_comment|/* strlen(&quot;&bslash;1DCC SENT t AAAAAAAA P&bslash;1&bslash;n&quot;)=24&n;&t; * 5+MINMATCHLEN+strlen(&quot;t AAAAAAAA P&bslash;1&bslash;n&quot;)=14 */
r_while
c_loop
(paren
id|data
OL
(paren
id|data_limit
op_minus
(paren
l_int|19
op_plus
id|MINMATCHLEN
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
id|memcmp
c_func
(paren
id|data
comma
l_string|&quot;&bslash;1DCC &quot;
comma
l_int|5
)paren
)paren
(brace
id|data
op_increment
suffix:semicolon
r_continue
suffix:semicolon
)brace
id|data
op_add_assign
l_int|5
suffix:semicolon
multiline_comment|/* we have at least (19+MINMATCHLEN)-5 bytes valid data left */
id|DEBUGP
c_func
(paren
l_string|&quot;DCC found in master %u.%u.%u.%u:%u %u.%u.%u.%u:%u...&bslash;n&quot;
comma
id|NIPQUAD
c_func
(paren
id|iph-&gt;saddr
)paren
comma
id|ntohs
c_func
(paren
id|th-&gt;source
)paren
comma
id|NIPQUAD
c_func
(paren
id|iph-&gt;daddr
)paren
comma
id|ntohs
c_func
(paren
id|th-&gt;dest
)paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|ARRAY_SIZE
c_func
(paren
id|dccprotos
)paren
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|memcmp
c_func
(paren
id|data
comma
id|dccprotos
(braket
id|i
)braket
comma
id|strlen
c_func
(paren
id|dccprotos
(braket
id|i
)braket
)paren
)paren
)paren
(brace
multiline_comment|/* no match */
r_continue
suffix:semicolon
)brace
id|DEBUGP
c_func
(paren
l_string|&quot;DCC %s detected&bslash;n&quot;
comma
id|dccprotos
(braket
id|i
)braket
)paren
suffix:semicolon
id|data
op_add_assign
id|strlen
c_func
(paren
id|dccprotos
(braket
id|i
)braket
)paren
suffix:semicolon
multiline_comment|/* we have at least &n;&t;&t;&t; * (19+MINMATCHLEN)-5-dccprotos[i].matchlen bytes valid&n;&t;&t;&t; * data left (== 14/13 bytes) */
r_if
c_cond
(paren
id|parse_dcc
c_func
(paren
(paren
r_char
op_star
)paren
id|data
comma
id|data_limit
comma
op_amp
id|dcc_ip
comma
op_amp
id|dcc_port
comma
op_amp
id|addr_beg_p
comma
op_amp
id|addr_end_p
)paren
)paren
(brace
multiline_comment|/* unable to parse */
id|DEBUGP
c_func
(paren
l_string|&quot;unable to parse dcc command&bslash;n&quot;
)paren
suffix:semicolon
r_continue
suffix:semicolon
)brace
id|DEBUGP
c_func
(paren
l_string|&quot;DCC bound ip/port: %u.%u.%u.%u:%u&bslash;n&quot;
comma
id|HIPQUAD
c_func
(paren
id|dcc_ip
)paren
comma
id|dcc_port
)paren
suffix:semicolon
multiline_comment|/* dcc_ip can be the internal OR external (NAT&squot;ed) IP&n;&t;&t;&t; * Tiago Sousa &lt;mirage@kaotik.org&gt; */
r_if
c_cond
(paren
id|ct-&gt;tuplehash
(braket
id|dir
)braket
dot
id|tuple.src.ip
op_ne
id|htonl
c_func
(paren
id|dcc_ip
)paren
op_logical_and
id|ct-&gt;tuplehash
(braket
id|IP_CT_DIR_REPLY
)braket
dot
id|tuple.dst.ip
op_ne
id|htonl
c_func
(paren
id|dcc_ip
)paren
)paren
(brace
r_if
c_cond
(paren
id|net_ratelimit
c_func
(paren
)paren
)paren
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;Forged DCC command from &quot;
l_string|&quot;%u.%u.%u.%u: %u.%u.%u.%u:%u&bslash;n&quot;
comma
id|NIPQUAD
c_func
(paren
id|ct-&gt;tuplehash
(braket
id|dir
)braket
dot
id|tuple.src.ip
)paren
comma
id|HIPQUAD
c_func
(paren
id|dcc_ip
)paren
comma
id|dcc_port
)paren
suffix:semicolon
r_continue
suffix:semicolon
)brace
id|exp
op_assign
id|ip_conntrack_expect_alloc
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|exp
op_eq
l_int|NULL
)paren
r_goto
id|out
suffix:semicolon
id|exp_irc_info
op_assign
op_amp
id|exp-&gt;help.exp_irc_info
suffix:semicolon
multiline_comment|/* save position of address in dcc string,&n;&t;&t;&t; * necessary for NAT */
id|DEBUGP
c_func
(paren
l_string|&quot;tcph-&gt;seq = %u&bslash;n&quot;
comma
id|th-&gt;seq
)paren
suffix:semicolon
id|exp-&gt;seq
op_assign
id|ntohl
c_func
(paren
id|th-&gt;seq
)paren
op_plus
(paren
id|addr_beg_p
op_minus
id|ib_ptr
)paren
suffix:semicolon
id|exp_irc_info-&gt;len
op_assign
(paren
id|addr_end_p
op_minus
id|addr_beg_p
)paren
suffix:semicolon
id|exp_irc_info-&gt;port
op_assign
id|dcc_port
suffix:semicolon
id|DEBUGP
c_func
(paren
l_string|&quot;wrote info seq=%u (ofs=%u), len=%d&bslash;n&quot;
comma
id|exp-&gt;seq
comma
(paren
id|addr_end_p
op_minus
id|_data
)paren
comma
id|exp_irc_info-&gt;len
)paren
suffix:semicolon
id|exp-&gt;tuple
op_assign
(paren
(paren
r_struct
id|ip_conntrack_tuple
)paren
(brace
(brace
l_int|0
comma
(brace
l_int|0
)brace
)brace
comma
(brace
id|ct-&gt;tuplehash
(braket
id|dir
)braket
dot
id|tuple.src.ip
comma
(brace
dot
id|tcp
op_assign
(brace
id|htons
c_func
(paren
id|dcc_port
)paren
)brace
)brace
comma
id|IPPROTO_TCP
)brace
)brace
)paren
suffix:semicolon
id|exp-&gt;mask
op_assign
(paren
(paren
r_struct
id|ip_conntrack_tuple
)paren
(brace
(brace
l_int|0
comma
(brace
l_int|0
)brace
)brace
comma
(brace
l_int|0xFFFFFFFF
comma
(brace
dot
id|tcp
op_assign
(brace
l_int|0xFFFF
)brace
)brace
comma
l_int|0xFFFF
)brace
)brace
)paren
suffix:semicolon
id|exp-&gt;expectfn
op_assign
l_int|NULL
suffix:semicolon
id|DEBUGP
c_func
(paren
l_string|&quot;expect_related %u.%u.%u.%u:%u-%u.%u.%u.%u:%u&bslash;n&quot;
comma
id|NIPQUAD
c_func
(paren
id|exp-&gt;tuple.src.ip
)paren
comma
id|ntohs
c_func
(paren
id|exp-&gt;tuple.src.u.tcp.port
)paren
comma
id|NIPQUAD
c_func
(paren
id|exp-&gt;tuple.dst.ip
)paren
comma
id|ntohs
c_func
(paren
id|exp-&gt;tuple.dst.u.tcp.port
)paren
)paren
suffix:semicolon
id|ip_conntrack_expect_related
c_func
(paren
id|exp
comma
id|ct
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
multiline_comment|/* for .. NUM_DCCPROTO */
)brace
multiline_comment|/* while data &lt; ... */
id|out
suffix:colon
id|UNLOCK_BH
c_func
(paren
op_amp
id|irc_buffer_lock
)paren
suffix:semicolon
r_return
id|NF_ACCEPT
suffix:semicolon
)brace
DECL|variable|irc_helpers
r_static
r_struct
id|ip_conntrack_helper
id|irc_helpers
(braket
id|MAX_PORTS
)braket
suffix:semicolon
DECL|variable|irc_names
r_static
r_char
id|irc_names
(braket
id|MAX_PORTS
)braket
(braket
l_int|10
)braket
suffix:semicolon
r_static
r_void
id|fini
c_func
(paren
r_void
)paren
suffix:semicolon
DECL|function|init
r_static
r_int
id|__init
id|init
c_func
(paren
r_void
)paren
(brace
r_int
id|i
comma
id|ret
suffix:semicolon
r_struct
id|ip_conntrack_helper
op_star
id|hlpr
suffix:semicolon
r_char
op_star
id|tmpname
suffix:semicolon
r_if
c_cond
(paren
id|max_dcc_channels
OL
l_int|1
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;ip_conntrack_irc: max_dcc_channels must be a positive integer&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
r_if
c_cond
(paren
id|dcc_timeout
OL
l_int|0
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;ip_conntrack_irc: dcc_timeout must be a positive integer&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
multiline_comment|/* If no port given, default to standard irc port */
r_if
c_cond
(paren
id|ports_c
op_eq
l_int|0
)paren
id|ports
(braket
id|ports_c
op_increment
)braket
op_assign
id|IRC_PORT
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|ports_c
suffix:semicolon
id|i
op_increment
)paren
(brace
id|hlpr
op_assign
op_amp
id|irc_helpers
(braket
id|i
)braket
suffix:semicolon
id|hlpr-&gt;tuple.src.u.tcp.port
op_assign
id|htons
c_func
(paren
id|ports
(braket
id|i
)braket
)paren
suffix:semicolon
id|hlpr-&gt;tuple.dst.protonum
op_assign
id|IPPROTO_TCP
suffix:semicolon
id|hlpr-&gt;mask.src.u.tcp.port
op_assign
l_int|0xFFFF
suffix:semicolon
id|hlpr-&gt;mask.dst.protonum
op_assign
l_int|0xFFFF
suffix:semicolon
id|hlpr-&gt;max_expected
op_assign
id|max_dcc_channels
suffix:semicolon
id|hlpr-&gt;timeout
op_assign
id|dcc_timeout
suffix:semicolon
id|hlpr-&gt;flags
op_assign
id|IP_CT_HELPER_F_REUSE_EXPECT
suffix:semicolon
id|hlpr-&gt;me
op_assign
id|ip_conntrack_irc
suffix:semicolon
id|hlpr-&gt;help
op_assign
id|help
suffix:semicolon
id|tmpname
op_assign
op_amp
id|irc_names
(braket
id|i
)braket
(braket
l_int|0
)braket
suffix:semicolon
r_if
c_cond
(paren
id|ports
(braket
id|i
)braket
op_eq
id|IRC_PORT
)paren
id|sprintf
c_func
(paren
id|tmpname
comma
l_string|&quot;irc&quot;
)paren
suffix:semicolon
r_else
id|sprintf
c_func
(paren
id|tmpname
comma
l_string|&quot;irc-%d&quot;
comma
id|i
)paren
suffix:semicolon
id|hlpr-&gt;name
op_assign
id|tmpname
suffix:semicolon
id|DEBUGP
c_func
(paren
l_string|&quot;port #%d: %d&bslash;n&quot;
comma
id|i
comma
id|ports
(braket
id|i
)braket
)paren
suffix:semicolon
id|ret
op_assign
id|ip_conntrack_helper_register
c_func
(paren
id|hlpr
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;ip_conntrack_irc: ERROR registering port %d&bslash;n&quot;
comma
id|ports
(braket
id|i
)braket
)paren
suffix:semicolon
id|fini
c_func
(paren
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* This function is intentionally _NOT_ defined as __exit, because &n; * it is needed by the init function */
DECL|function|fini
r_static
r_void
id|fini
c_func
(paren
r_void
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|ports_c
suffix:semicolon
id|i
op_increment
)paren
(brace
id|DEBUGP
c_func
(paren
l_string|&quot;unregistering port %d&bslash;n&quot;
comma
id|ports
(braket
id|i
)braket
)paren
suffix:semicolon
id|ip_conntrack_helper_unregister
c_func
(paren
op_amp
id|irc_helpers
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
)brace
DECL|variable|irc
id|PROVIDES_CONNTRACK
c_func
(paren
id|irc
)paren
suffix:semicolon
DECL|variable|init
id|module_init
c_func
(paren
id|init
)paren
suffix:semicolon
DECL|variable|fini
id|module_exit
c_func
(paren
id|fini
)paren
suffix:semicolon
eof
