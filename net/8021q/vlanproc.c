multiline_comment|/******************************************************************************&n; * vlanproc.c&t;VLAN Module. /proc filesystem interface.&n; *&n; *&t;&t;This module is completely hardware-independent and provides&n; *&t;&t;access to the router using Linux /proc filesystem.&n; *&n; * Author:&t;Ben Greear, &lt;greearb@candelatech.com&gt; coppied from wanproc.c&n; *               by: Gene Kozin&t;&lt;genek@compuserve.com&gt;&n; *&n; * Copyright:&t;(c) 1998 Ben Greear&n; *&n; *&t;&t;This program is free software; you can redistribute it and/or&n; *&t;&t;modify it under the terms of the GNU General Public License&n; *&t;&t;as published by the Free Software Foundation; either version&n; *&t;&t;2 of the License, or (at your option) any later version.&n; * ============================================================================&n; * Jan 20, 1998        Ben Greear     Initial Version&n; *****************************************************************************/
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/stddef.h&gt;&t;/* offsetof(), etc. */
macro_line|#include &lt;linux/errno.h&gt;&t;/* return codes */
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/slab.h&gt;&t;&t;/* kmalloc(), kfree() */
macro_line|#include &lt;linux/mm.h&gt;&t;&t;/* verify_area(), etc. */
macro_line|#include &lt;linux/string.h&gt;&t;/* inline mem*, str* functions */
macro_line|#include &lt;linux/init.h&gt;&t;&t;/* __initfunc et al. */
macro_line|#include &lt;asm/byteorder.h&gt;&t;/* htons(), etc. */
macro_line|#include &lt;asm/uaccess.h&gt;&t;/* copy_to_user */
macro_line|#include &lt;asm/io.h&gt;
macro_line|#include &lt;linux/proc_fs.h&gt;
macro_line|#include &lt;linux/seq_file.h&gt;
macro_line|#include &lt;linux/fs.h&gt;
macro_line|#include &lt;linux/netdevice.h&gt;
macro_line|#include &lt;linux/if_vlan.h&gt;
macro_line|#include &quot;vlanproc.h&quot;
macro_line|#include &quot;vlan.h&quot;
multiline_comment|/****** Function Prototypes *************************************************/
multiline_comment|/* Methods for preparing data for reading proc entries */
r_static
r_int
id|vlan_seq_show
c_func
(paren
r_struct
id|seq_file
op_star
id|seq
comma
r_void
op_star
id|v
)paren
suffix:semicolon
r_static
r_void
op_star
id|vlan_seq_start
c_func
(paren
r_struct
id|seq_file
op_star
id|seq
comma
id|loff_t
op_star
id|pos
)paren
suffix:semicolon
r_static
r_void
op_star
id|vlan_seq_next
c_func
(paren
r_struct
id|seq_file
op_star
id|seq
comma
r_void
op_star
id|v
comma
id|loff_t
op_star
id|pos
)paren
suffix:semicolon
r_static
r_void
id|vlan_seq_stop
c_func
(paren
r_struct
id|seq_file
op_star
id|seq
comma
r_void
op_star
)paren
suffix:semicolon
r_static
r_int
id|vlandev_seq_show
c_func
(paren
r_struct
id|seq_file
op_star
id|seq
comma
r_void
op_star
id|v
)paren
suffix:semicolon
multiline_comment|/*&n; *&t;Global Data&n; */
multiline_comment|/*&n; *&t;Names of the proc directory entries &n; */
DECL|variable|name_root
r_static
r_const
r_char
id|name_root
(braket
)braket
op_assign
l_string|&quot;vlan&quot;
suffix:semicolon
DECL|variable|name_conf
r_static
r_const
r_char
id|name_conf
(braket
)braket
op_assign
l_string|&quot;config&quot;
suffix:semicolon
multiline_comment|/*&n; *&t;Structures for interfacing with the /proc filesystem.&n; *&t;VLAN creates its own directory /proc/net/vlan with the folowing&n; *&t;entries:&n; *&t;config&t;&t;device status/configuration&n; *&t;&lt;device&gt;&t;entry for each  device&n; */
multiline_comment|/*&n; *&t;Generic /proc/net/vlan/&lt;file&gt; file and inode operations &n; */
DECL|variable|vlan_seq_ops
r_static
r_struct
id|seq_operations
id|vlan_seq_ops
op_assign
(brace
dot
id|start
op_assign
id|vlan_seq_start
comma
dot
id|next
op_assign
id|vlan_seq_next
comma
dot
id|stop
op_assign
id|vlan_seq_stop
comma
dot
id|show
op_assign
id|vlan_seq_show
comma
)brace
suffix:semicolon
DECL|function|vlan_seq_open
r_static
r_int
id|vlan_seq_open
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_return
id|seq_open
c_func
(paren
id|file
comma
op_amp
id|vlan_seq_ops
)paren
suffix:semicolon
)brace
DECL|variable|vlan_fops
r_static
r_struct
id|file_operations
id|vlan_fops
op_assign
(brace
dot
id|owner
op_assign
id|THIS_MODULE
comma
dot
id|open
op_assign
id|vlan_seq_open
comma
dot
id|read
op_assign
id|seq_read
comma
dot
id|llseek
op_assign
id|seq_lseek
comma
dot
id|release
op_assign
id|seq_release
comma
)brace
suffix:semicolon
multiline_comment|/*&n; *&t;/proc/net/vlan/&lt;device&gt; file and inode operations&n; */
DECL|function|vlandev_seq_open
r_static
r_int
id|vlandev_seq_open
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_return
id|single_open
c_func
(paren
id|file
comma
id|vlandev_seq_show
comma
id|PDE
c_func
(paren
id|inode
)paren
op_member_access_from_pointer
id|data
)paren
suffix:semicolon
)brace
DECL|variable|vlandev_fops
r_static
r_struct
id|file_operations
id|vlandev_fops
op_assign
(brace
dot
id|owner
op_assign
id|THIS_MODULE
comma
dot
id|open
op_assign
id|vlandev_seq_open
comma
dot
id|read
op_assign
id|seq_read
comma
dot
id|llseek
op_assign
id|seq_lseek
comma
dot
id|release
op_assign
id|single_release
comma
)brace
suffix:semicolon
multiline_comment|/*&n; * Proc filesystem derectory entries.&n; */
multiline_comment|/*&n; *&t;/proc/net/vlan &n; */
DECL|variable|proc_vlan_dir
r_static
r_struct
id|proc_dir_entry
op_star
id|proc_vlan_dir
suffix:semicolon
multiline_comment|/*&n; *&t;/proc/net/vlan/config &n; */
DECL|variable|proc_vlan_conf
r_static
r_struct
id|proc_dir_entry
op_star
id|proc_vlan_conf
suffix:semicolon
multiline_comment|/* Strings */
DECL|variable|vlan_name_type_str
r_static
r_const
r_char
op_star
id|vlan_name_type_str
(braket
id|VLAN_NAME_TYPE_HIGHEST
)braket
op_assign
(brace
(braket
id|VLAN_NAME_TYPE_RAW_PLUS_VID
)braket
op_assign
l_string|&quot;VLAN_NAME_TYPE_RAW_PLUS_VID&quot;
comma
(braket
id|VLAN_NAME_TYPE_PLUS_VID_NO_PAD
)braket
op_assign
l_string|&quot;VLAN_NAME_TYPE_PLUS_VID_NO_PAD&quot;
comma
(braket
id|VLAN_NAME_TYPE_RAW_PLUS_VID_NO_PAD
)braket
op_assign
l_string|&quot;VLAN_NAME_TYPE_RAW_PLUS_VID_NO_PAD&quot;
comma
(braket
id|VLAN_NAME_TYPE_PLUS_VID
)braket
op_assign
l_string|&quot;VLAN_NAME_TYPE_PLUS_VID&quot;
comma
)brace
suffix:semicolon
multiline_comment|/*&n; *&t;Interface functions&n; */
multiline_comment|/*&n; *&t;Clean up /proc/net/vlan entries&n; */
DECL|function|vlan_proc_cleanup
r_void
id|vlan_proc_cleanup
c_func
(paren
r_void
)paren
(brace
r_if
c_cond
(paren
id|proc_vlan_conf
)paren
id|remove_proc_entry
c_func
(paren
id|name_conf
comma
id|proc_vlan_dir
)paren
suffix:semicolon
r_if
c_cond
(paren
id|proc_vlan_dir
)paren
id|proc_net_remove
c_func
(paren
id|name_root
)paren
suffix:semicolon
multiline_comment|/* Dynamically added entries should be cleaned up as their vlan_device&n;&t; * is removed, so we should not have to take care of it here...&n;&t; */
)brace
multiline_comment|/*&n; *&t;Create /proc/net/vlan entries&n; */
DECL|function|vlan_proc_init
r_int
id|__init
id|vlan_proc_init
c_func
(paren
r_void
)paren
(brace
id|proc_vlan_dir
op_assign
id|proc_mkdir
c_func
(paren
id|name_root
comma
id|proc_net
)paren
suffix:semicolon
r_if
c_cond
(paren
id|proc_vlan_dir
)paren
(brace
id|proc_vlan_conf
op_assign
id|create_proc_entry
c_func
(paren
id|name_conf
comma
id|S_IFREG
op_or
id|S_IRUSR
op_or
id|S_IWUSR
comma
id|proc_vlan_dir
)paren
suffix:semicolon
r_if
c_cond
(paren
id|proc_vlan_conf
)paren
(brace
id|proc_vlan_conf-&gt;proc_fops
op_assign
op_amp
id|vlan_fops
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
)brace
id|vlan_proc_cleanup
c_func
(paren
)paren
suffix:semicolon
r_return
op_minus
id|ENOBUFS
suffix:semicolon
)brace
multiline_comment|/*&n; *&t;Add directory entry for VLAN device.&n; */
DECL|function|vlan_proc_add_dev
r_int
id|vlan_proc_add_dev
(paren
r_struct
id|net_device
op_star
id|vlandev
)paren
(brace
r_struct
id|vlan_dev_info
op_star
id|dev_info
op_assign
id|VLAN_DEV_INFO
c_func
(paren
id|vlandev
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|vlandev-&gt;priv_flags
op_amp
id|IFF_802_1Q_VLAN
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;ERROR:&t;vlan_proc_add, device -:%s:- is NOT a VLAN&bslash;n&quot;
comma
id|vlandev-&gt;name
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|dev_info-&gt;dent
op_assign
id|create_proc_entry
c_func
(paren
id|vlandev-&gt;name
comma
id|S_IFREG
op_or
id|S_IRUSR
op_or
id|S_IWUSR
comma
id|proc_vlan_dir
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dev_info-&gt;dent
)paren
r_return
op_minus
id|ENOBUFS
suffix:semicolon
id|dev_info-&gt;dent-&gt;proc_fops
op_assign
op_amp
id|vlandev_fops
suffix:semicolon
id|dev_info-&gt;dent-&gt;data
op_assign
id|vlandev
suffix:semicolon
macro_line|#ifdef VLAN_DEBUG
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;vlan_proc_add, device -:%s:- being added.&bslash;n&quot;
comma
id|vlandev-&gt;name
)paren
suffix:semicolon
macro_line|#endif
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; *&t;Delete directory entry for VLAN device.&n; */
DECL|function|vlan_proc_rem_dev
r_int
id|vlan_proc_rem_dev
c_func
(paren
r_struct
id|net_device
op_star
id|vlandev
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|vlandev
)paren
(brace
id|printk
c_func
(paren
id|VLAN_ERR
l_string|&quot;%s: invalid argument: %p&bslash;n&quot;
comma
id|__FUNCTION__
comma
id|vlandev
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|vlandev-&gt;priv_flags
op_amp
id|IFF_802_1Q_VLAN
)paren
)paren
(brace
id|printk
c_func
(paren
id|VLAN_DBG
l_string|&quot;%s: invalid argument, device: %s is not a VLAN device, priv_flags: 0x%4hX.&bslash;n&quot;
comma
id|__FUNCTION__
comma
id|vlandev-&gt;name
comma
id|vlandev-&gt;priv_flags
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
macro_line|#ifdef VLAN_DEBUG
id|printk
c_func
(paren
id|VLAN_DBG
l_string|&quot;%s: dev: %p&bslash;n&quot;
comma
id|__FUNCTION__
comma
id|vlandev
)paren
suffix:semicolon
macro_line|#endif
multiline_comment|/** NOTE:  This will consume the memory pointed to by dent, it seems. */
r_if
c_cond
(paren
id|VLAN_DEV_INFO
c_func
(paren
id|vlandev
)paren
op_member_access_from_pointer
id|dent
)paren
(brace
id|remove_proc_entry
c_func
(paren
id|VLAN_DEV_INFO
c_func
(paren
id|vlandev
)paren
op_member_access_from_pointer
id|dent-&gt;name
comma
id|proc_vlan_dir
)paren
suffix:semicolon
id|VLAN_DEV_INFO
c_func
(paren
id|vlandev
)paren
op_member_access_from_pointer
id|dent
op_assign
l_int|NULL
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/****** Proc filesystem entry points ****************************************/
multiline_comment|/*&n; * The following few functions build the content of /proc/net/vlan/config&n; */
multiline_comment|/* starting at dev, find a VLAN device */
DECL|function|vlan_skip
r_static
r_struct
id|net_device
op_star
id|vlan_skip
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_while
c_loop
(paren
id|dev
op_logical_and
op_logical_neg
(paren
id|dev-&gt;priv_flags
op_amp
id|IFF_802_1Q_VLAN
)paren
)paren
id|dev
op_assign
id|dev-&gt;next
suffix:semicolon
r_return
id|dev
suffix:semicolon
)brace
multiline_comment|/* start read of /proc/net/vlan/config */
DECL|function|vlan_seq_start
r_static
r_void
op_star
id|vlan_seq_start
c_func
(paren
r_struct
id|seq_file
op_star
id|seq
comma
id|loff_t
op_star
id|pos
)paren
(brace
r_struct
id|net_device
op_star
id|dev
suffix:semicolon
id|loff_t
id|i
op_assign
l_int|1
suffix:semicolon
id|read_lock
c_func
(paren
op_amp
id|dev_base_lock
)paren
suffix:semicolon
r_if
c_cond
(paren
op_star
id|pos
op_eq
l_int|0
)paren
r_return
id|SEQ_START_TOKEN
suffix:semicolon
r_for
c_loop
(paren
id|dev
op_assign
id|vlan_skip
c_func
(paren
id|dev_base
)paren
suffix:semicolon
id|dev
op_logical_and
id|i
OL
op_star
id|pos
suffix:semicolon
id|dev
op_assign
id|vlan_skip
c_func
(paren
id|dev-&gt;next
)paren
comma
op_increment
id|i
)paren
suffix:semicolon
r_return
(paren
id|i
op_eq
op_star
id|pos
)paren
ques
c_cond
id|dev
suffix:colon
l_int|NULL
suffix:semicolon
)brace
DECL|function|vlan_seq_next
r_static
r_void
op_star
id|vlan_seq_next
c_func
(paren
r_struct
id|seq_file
op_star
id|seq
comma
r_void
op_star
id|v
comma
id|loff_t
op_star
id|pos
)paren
(brace
op_increment
op_star
id|pos
suffix:semicolon
r_return
id|vlan_skip
c_func
(paren
(paren
id|v
op_eq
id|SEQ_START_TOKEN
)paren
ques
c_cond
id|dev_base
suffix:colon
(paren
(paren
r_struct
id|net_device
op_star
)paren
id|v
)paren
op_member_access_from_pointer
id|next
)paren
suffix:semicolon
)brace
DECL|function|vlan_seq_stop
r_static
r_void
id|vlan_seq_stop
c_func
(paren
r_struct
id|seq_file
op_star
id|seq
comma
r_void
op_star
id|v
)paren
(brace
id|read_unlock
c_func
(paren
op_amp
id|dev_base_lock
)paren
suffix:semicolon
)brace
DECL|function|vlan_seq_show
r_static
r_int
id|vlan_seq_show
c_func
(paren
r_struct
id|seq_file
op_star
id|seq
comma
r_void
op_star
id|v
)paren
(brace
r_if
c_cond
(paren
id|v
op_eq
id|SEQ_START_TOKEN
)paren
(brace
r_const
r_char
op_star
id|nmtype
op_assign
l_int|NULL
suffix:semicolon
id|seq_puts
c_func
(paren
id|seq
comma
l_string|&quot;VLAN Dev name&t; | VLAN ID&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|vlan_name_type
OL
id|ARRAY_SIZE
c_func
(paren
id|vlan_name_type_str
)paren
)paren
id|nmtype
op_assign
id|vlan_name_type_str
(braket
id|vlan_name_type
)braket
suffix:semicolon
id|seq_printf
c_func
(paren
id|seq
comma
l_string|&quot;Name-Type: %s&bslash;n&quot;
comma
id|nmtype
ques
c_cond
id|nmtype
suffix:colon
l_string|&quot;UNKNOWN&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
r_const
r_struct
id|net_device
op_star
id|vlandev
op_assign
id|v
suffix:semicolon
r_const
r_struct
id|vlan_dev_info
op_star
id|dev_info
op_assign
id|VLAN_DEV_INFO
c_func
(paren
id|vlandev
)paren
suffix:semicolon
id|seq_printf
c_func
(paren
id|seq
comma
l_string|&quot;%-15s| %d  | %s&bslash;n&quot;
comma
id|vlandev-&gt;name
comma
id|dev_info-&gt;vlan_id
comma
id|dev_info-&gt;real_dev-&gt;name
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|vlandev_seq_show
r_static
r_int
id|vlandev_seq_show
c_func
(paren
r_struct
id|seq_file
op_star
id|seq
comma
r_void
op_star
id|offset
)paren
(brace
r_struct
id|net_device
op_star
id|vlandev
op_assign
(paren
r_struct
id|net_device
op_star
)paren
id|seq
op_member_access_from_pointer
r_private
suffix:semicolon
r_const
r_struct
id|vlan_dev_info
op_star
id|dev_info
op_assign
id|VLAN_DEV_INFO
c_func
(paren
id|vlandev
)paren
suffix:semicolon
r_struct
id|net_device_stats
op_star
id|stats
suffix:semicolon
r_static
r_const
r_char
id|fmt
(braket
)braket
op_assign
l_string|&quot;%30s %12lu&bslash;n&quot;
suffix:semicolon
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
(paren
id|vlandev
op_eq
l_int|NULL
)paren
op_logical_or
(paren
op_logical_neg
(paren
id|vlandev-&gt;priv_flags
op_amp
id|IFF_802_1Q_VLAN
)paren
)paren
)paren
r_return
l_int|0
suffix:semicolon
id|seq_printf
c_func
(paren
id|seq
comma
l_string|&quot;%s  VID: %d&t; REORDER_HDR: %i  dev-&gt;priv_flags: %hx&bslash;n&quot;
comma
id|vlandev-&gt;name
comma
id|dev_info-&gt;vlan_id
comma
(paren
r_int
)paren
(paren
id|dev_info-&gt;flags
op_amp
l_int|1
)paren
comma
id|vlandev-&gt;priv_flags
)paren
suffix:semicolon
id|stats
op_assign
id|vlan_dev_get_stats
c_func
(paren
id|vlandev
)paren
suffix:semicolon
id|seq_printf
c_func
(paren
id|seq
comma
id|fmt
comma
l_string|&quot;total frames received&quot;
comma
id|stats-&gt;rx_packets
)paren
suffix:semicolon
id|seq_printf
c_func
(paren
id|seq
comma
id|fmt
comma
l_string|&quot;total bytes received&quot;
comma
id|stats-&gt;rx_bytes
)paren
suffix:semicolon
id|seq_printf
c_func
(paren
id|seq
comma
id|fmt
comma
l_string|&quot;Broadcast/Multicast Rcvd&quot;
comma
id|stats-&gt;multicast
)paren
suffix:semicolon
id|seq_puts
c_func
(paren
id|seq
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|seq_printf
c_func
(paren
id|seq
comma
id|fmt
comma
l_string|&quot;total frames transmitted&quot;
comma
id|stats-&gt;tx_packets
)paren
suffix:semicolon
id|seq_printf
c_func
(paren
id|seq
comma
id|fmt
comma
l_string|&quot;total bytes transmitted&quot;
comma
id|stats-&gt;tx_bytes
)paren
suffix:semicolon
id|seq_printf
c_func
(paren
id|seq
comma
id|fmt
comma
l_string|&quot;total headroom inc&quot;
comma
id|dev_info-&gt;cnt_inc_headroom_on_tx
)paren
suffix:semicolon
id|seq_printf
c_func
(paren
id|seq
comma
id|fmt
comma
l_string|&quot;total encap on xmit&quot;
comma
id|dev_info-&gt;cnt_encap_on_xmit
)paren
suffix:semicolon
id|seq_printf
c_func
(paren
id|seq
comma
l_string|&quot;Device: %s&quot;
comma
id|dev_info-&gt;real_dev-&gt;name
)paren
suffix:semicolon
multiline_comment|/* now show all PRIORITY mappings relating to this VLAN */
id|seq_printf
c_func
(paren
id|seq
comma
l_string|&quot;&bslash;nINGRESS priority mappings: 0:%lu  1:%lu  2:%lu  3:%lu  4:%lu  5:%lu  6:%lu 7:%lu&bslash;n&quot;
comma
id|dev_info-&gt;ingress_priority_map
(braket
l_int|0
)braket
comma
id|dev_info-&gt;ingress_priority_map
(braket
l_int|1
)braket
comma
id|dev_info-&gt;ingress_priority_map
(braket
l_int|2
)braket
comma
id|dev_info-&gt;ingress_priority_map
(braket
l_int|3
)braket
comma
id|dev_info-&gt;ingress_priority_map
(braket
l_int|4
)braket
comma
id|dev_info-&gt;ingress_priority_map
(braket
l_int|5
)braket
comma
id|dev_info-&gt;ingress_priority_map
(braket
l_int|6
)braket
comma
id|dev_info-&gt;ingress_priority_map
(braket
l_int|7
)braket
)paren
suffix:semicolon
id|seq_printf
c_func
(paren
id|seq
comma
l_string|&quot;EGRESSS priority Mappings: &quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|16
suffix:semicolon
id|i
op_increment
)paren
(brace
r_const
r_struct
id|vlan_priority_tci_mapping
op_star
id|mp
op_assign
id|dev_info-&gt;egress_priority_map
(braket
id|i
)braket
suffix:semicolon
r_while
c_loop
(paren
id|mp
)paren
(brace
id|seq_printf
c_func
(paren
id|seq
comma
l_string|&quot;%lu:%hu &quot;
comma
id|mp-&gt;priority
comma
(paren
(paren
id|mp-&gt;vlan_qos
op_rshift
l_int|13
)paren
op_amp
l_int|0x7
)paren
)paren
suffix:semicolon
id|mp
op_assign
id|mp-&gt;next
suffix:semicolon
)brace
)brace
id|seq_puts
c_func
(paren
id|seq
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
eof
