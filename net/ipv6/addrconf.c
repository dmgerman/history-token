multiline_comment|/*&n; *&t;IPv6 Address [auto]configuration&n; *&t;Linux INET6 implementation&n; *&n; *&t;Authors:&n; *&t;Pedro Roque&t;&t;&lt;roque@di.fc.ul.pt&gt;&t;&n; *&t;Alexey Kuznetsov&t;&lt;kuznet@ms2.inr.ac.ru&gt;&n; *&n; *&t;$Id: addrconf.c,v 1.69 2001/10/31 21:55:54 davem Exp $&n; *&n; *&t;This program is free software; you can redistribute it and/or&n; *      modify it under the terms of the GNU General Public License&n; *      as published by the Free Software Foundation; either version&n; *      2 of the License, or (at your option) any later version.&n; */
multiline_comment|/*&n; *&t;Changes:&n; *&n; *&t;Janos Farkas&t;&t;&t;:&t;delete timer on ifdown&n; *&t;&lt;chexum@bankinf.banki.hu&gt;&n; *&t;Andi Kleen&t;&t;&t;:&t;kill double kfree on module&n; *&t;&t;&t;&t;&t;&t;unload.&n; *&t;Maciej W. Rozycki&t;&t;:&t;FDDI support&n; *&t;sekiya@USAGI&t;&t;&t;:&t;Don&squot;t send too many RS&n; *&t;&t;&t;&t;&t;&t;packets.&n; *&t;yoshfuji@USAGI&t;&t;&t;:       Fixed interval between DAD&n; *&t;&t;&t;&t;&t;&t;packets.&n; *&t;YOSHIFUJI Hideaki @USAGI&t;:&t;improved accuracy of&n; *&t;&t;&t;&t;&t;&t;address validation timer.&n; *&t;YOSHIFUJI Hideaki @USAGI&t;:&t;Privacy Extensions (RFC3041)&n; *&t;&t;&t;&t;&t;&t;support.&n; *&t;Yuji SEKIYA @USAGI&t;&t;:&t;Don&squot;t assign a same IPv6&n; *&t;&t;&t;&t;&t;&t;address on a same interface.&n; *&t;YOSHIFUJI Hideaki @USAGI&t;:&t;ARCnet support&n; *&t;YOSHIFUJI Hideaki @USAGI&t;:&t;convert /proc/net/if_inet6 to&n; *&t;&t;&t;&t;&t;&t;seq_file.&n; */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/errno.h&gt;
macro_line|#include &lt;linux/types.h&gt;
macro_line|#include &lt;linux/socket.h&gt;
macro_line|#include &lt;linux/sockios.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/net.h&gt;
macro_line|#include &lt;linux/in6.h&gt;
macro_line|#include &lt;linux/netdevice.h&gt;
macro_line|#include &lt;linux/if_arp.h&gt;
macro_line|#include &lt;linux/if_arcnet.h&gt;
macro_line|#include &lt;linux/route.h&gt;
macro_line|#include &lt;linux/inetdevice.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#ifdef CONFIG_SYSCTL
macro_line|#include &lt;linux/sysctl.h&gt;
macro_line|#endif
macro_line|#include &lt;linux/delay.h&gt;
macro_line|#include &lt;linux/notifier.h&gt;
macro_line|#include &lt;net/sock.h&gt;
macro_line|#include &lt;net/snmp.h&gt;
macro_line|#include &lt;net/ipv6.h&gt;
macro_line|#include &lt;net/protocol.h&gt;
macro_line|#include &lt;net/ndisc.h&gt;
macro_line|#include &lt;net/ip6_route.h&gt;
macro_line|#include &lt;net/addrconf.h&gt;
macro_line|#include &lt;net/tcp.h&gt;
macro_line|#include &lt;net/ip.h&gt;
macro_line|#include &lt;linux/if_tunnel.h&gt;
macro_line|#include &lt;linux/rtnetlink.h&gt;
macro_line|#ifdef CONFIG_IPV6_PRIVACY
macro_line|#include &lt;linux/random.h&gt;
macro_line|#include &lt;linux/crypto.h&gt;
macro_line|#include &lt;asm/scatterlist.h&gt;
macro_line|#endif
macro_line|#include &lt;asm/uaccess.h&gt;
macro_line|#include &lt;linux/proc_fs.h&gt;
macro_line|#include &lt;linux/seq_file.h&gt;
multiline_comment|/* Set to 3 to get tracing... */
DECL|macro|ACONF_DEBUG
mdefine_line|#define ACONF_DEBUG 2
macro_line|#if ACONF_DEBUG &gt;= 3
DECL|macro|ADBG
mdefine_line|#define ADBG(x) printk x
macro_line|#else
DECL|macro|ADBG
mdefine_line|#define ADBG(x)
macro_line|#endif
DECL|macro|INFINITY_LIFE_TIME
mdefine_line|#define&t;INFINITY_LIFE_TIME&t;0xFFFFFFFF
DECL|macro|TIME_DELTA
mdefine_line|#define TIME_DELTA(a,b) ((unsigned long)((long)(a) - (long)(b)))
macro_line|#ifdef CONFIG_SYSCTL
r_static
r_void
id|addrconf_sysctl_register
c_func
(paren
r_struct
id|inet6_dev
op_star
id|idev
comma
r_struct
id|ipv6_devconf
op_star
id|p
)paren
suffix:semicolon
r_static
r_void
id|addrconf_sysctl_unregister
c_func
(paren
r_struct
id|ipv6_devconf
op_star
id|p
)paren
suffix:semicolon
macro_line|#endif
DECL|variable|inet6_dev_count
r_int
id|inet6_dev_count
suffix:semicolon
DECL|variable|inet6_ifa_count
r_int
id|inet6_ifa_count
suffix:semicolon
macro_line|#ifdef CONFIG_IPV6_PRIVACY
r_static
r_int
id|__ipv6_regen_rndid
c_func
(paren
r_struct
id|inet6_dev
op_star
id|idev
)paren
suffix:semicolon
r_static
r_int
id|__ipv6_try_regen_rndid
c_func
(paren
r_struct
id|inet6_dev
op_star
id|idev
comma
r_struct
id|in6_addr
op_star
id|tmpaddr
)paren
suffix:semicolon
r_static
r_void
id|ipv6_regen_rndid
c_func
(paren
r_int
r_int
id|data
)paren
suffix:semicolon
DECL|variable|desync_factor
r_static
r_int
id|desync_factor
op_assign
id|MAX_DESYNC_FACTOR
op_star
id|HZ
suffix:semicolon
DECL|variable|md5_tfm
r_static
r_struct
id|crypto_tfm
op_star
id|md5_tfm
suffix:semicolon
DECL|variable|md5_tfm_lock
r_static
id|spinlock_t
id|md5_tfm_lock
op_assign
id|SPIN_LOCK_UNLOCKED
suffix:semicolon
macro_line|#endif
r_static
r_int
id|ipv6_count_addresses
c_func
(paren
r_struct
id|inet6_dev
op_star
id|idev
)paren
suffix:semicolon
multiline_comment|/*&n; *&t;Configured unicast address hash table&n; */
DECL|variable|inet6_addr_lst
r_static
r_struct
id|inet6_ifaddr
op_star
id|inet6_addr_lst
(braket
id|IN6_ADDR_HSIZE
)braket
suffix:semicolon
DECL|variable|addrconf_hash_lock
r_static
id|rwlock_t
id|addrconf_hash_lock
op_assign
id|RW_LOCK_UNLOCKED
suffix:semicolon
multiline_comment|/* Protects inet6 devices */
DECL|variable|addrconf_lock
id|rwlock_t
id|addrconf_lock
op_assign
id|RW_LOCK_UNLOCKED
suffix:semicolon
r_static
r_void
id|addrconf_verify
c_func
(paren
r_int
r_int
)paren
suffix:semicolon
DECL|variable|addr_chk_timer
r_static
r_struct
id|timer_list
id|addr_chk_timer
op_assign
id|TIMER_INITIALIZER
c_func
(paren
id|addrconf_verify
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
DECL|variable|addrconf_verify_lock
r_static
id|spinlock_t
id|addrconf_verify_lock
op_assign
id|SPIN_LOCK_UNLOCKED
suffix:semicolon
r_static
r_int
id|addrconf_ifdown
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_int
id|how
)paren
suffix:semicolon
r_static
r_void
id|addrconf_dad_start
c_func
(paren
r_struct
id|inet6_ifaddr
op_star
id|ifp
comma
r_int
id|flags
)paren
suffix:semicolon
r_static
r_void
id|addrconf_dad_timer
c_func
(paren
r_int
r_int
id|data
)paren
suffix:semicolon
r_static
r_void
id|addrconf_dad_completed
c_func
(paren
r_struct
id|inet6_ifaddr
op_star
id|ifp
)paren
suffix:semicolon
r_static
r_void
id|addrconf_rs_timer
c_func
(paren
r_int
r_int
id|data
)paren
suffix:semicolon
r_static
r_void
id|ipv6_ifa_notify
c_func
(paren
r_int
id|event
comma
r_struct
id|inet6_ifaddr
op_star
id|ifa
)paren
suffix:semicolon
r_static
r_void
id|inet6_prefix_notify
c_func
(paren
r_int
id|event
comma
r_struct
id|inet6_dev
op_star
id|idev
comma
r_struct
id|prefix_info
op_star
id|pinfo
)paren
suffix:semicolon
r_static
r_int
id|ipv6_chk_same_addr
c_func
(paren
r_const
r_struct
id|in6_addr
op_star
id|addr
comma
r_struct
id|net_device
op_star
id|dev
)paren
suffix:semicolon
DECL|variable|inet6addr_chain
r_static
r_struct
id|notifier_block
op_star
id|inet6addr_chain
suffix:semicolon
DECL|variable|ipv6_devconf
r_struct
id|ipv6_devconf
id|ipv6_devconf
op_assign
(brace
dot
id|forwarding
op_assign
l_int|0
comma
dot
id|hop_limit
op_assign
id|IPV6_DEFAULT_HOPLIMIT
comma
dot
id|mtu6
op_assign
id|IPV6_MIN_MTU
comma
dot
id|accept_ra
op_assign
l_int|1
comma
dot
id|accept_redirects
op_assign
l_int|1
comma
dot
id|autoconf
op_assign
l_int|1
comma
dot
id|force_mld_version
op_assign
l_int|0
comma
dot
id|dad_transmits
op_assign
l_int|1
comma
dot
id|rtr_solicits
op_assign
id|MAX_RTR_SOLICITATIONS
comma
dot
id|rtr_solicit_interval
op_assign
id|RTR_SOLICITATION_INTERVAL
comma
dot
id|rtr_solicit_delay
op_assign
id|MAX_RTR_SOLICITATION_DELAY
comma
macro_line|#ifdef CONFIG_IPV6_PRIVACY
dot
id|use_tempaddr
op_assign
l_int|0
comma
dot
id|temp_valid_lft
op_assign
id|TEMP_VALID_LIFETIME
comma
dot
id|temp_prefered_lft
op_assign
id|TEMP_PREFERRED_LIFETIME
comma
dot
id|regen_max_retry
op_assign
id|REGEN_MAX_RETRY
comma
dot
id|max_desync_factor
op_assign
id|MAX_DESYNC_FACTOR
comma
macro_line|#endif
dot
id|max_addresses
op_assign
id|IPV6_MAX_ADDRESSES
comma
)brace
suffix:semicolon
DECL|variable|ipv6_devconf_dflt
r_static
r_struct
id|ipv6_devconf
id|ipv6_devconf_dflt
op_assign
(brace
dot
id|forwarding
op_assign
l_int|0
comma
dot
id|hop_limit
op_assign
id|IPV6_DEFAULT_HOPLIMIT
comma
dot
id|mtu6
op_assign
id|IPV6_MIN_MTU
comma
dot
id|accept_ra
op_assign
l_int|1
comma
dot
id|accept_redirects
op_assign
l_int|1
comma
dot
id|autoconf
op_assign
l_int|1
comma
dot
id|dad_transmits
op_assign
l_int|1
comma
dot
id|rtr_solicits
op_assign
id|MAX_RTR_SOLICITATIONS
comma
dot
id|rtr_solicit_interval
op_assign
id|RTR_SOLICITATION_INTERVAL
comma
dot
id|rtr_solicit_delay
op_assign
id|MAX_RTR_SOLICITATION_DELAY
comma
macro_line|#ifdef CONFIG_IPV6_PRIVACY
dot
id|use_tempaddr
op_assign
l_int|0
comma
dot
id|temp_valid_lft
op_assign
id|TEMP_VALID_LIFETIME
comma
dot
id|temp_prefered_lft
op_assign
id|TEMP_PREFERRED_LIFETIME
comma
dot
id|regen_max_retry
op_assign
id|REGEN_MAX_RETRY
comma
dot
id|max_desync_factor
op_assign
id|MAX_DESYNC_FACTOR
comma
macro_line|#endif
dot
id|max_addresses
op_assign
id|IPV6_MAX_ADDRESSES
comma
)brace
suffix:semicolon
multiline_comment|/* IPv6 Wildcard Address and Loopback Address defined by RFC2553 */
DECL|variable|in6addr_any
r_const
r_struct
id|in6_addr
id|in6addr_any
op_assign
id|IN6ADDR_ANY_INIT
suffix:semicolon
DECL|variable|in6addr_loopback
r_const
r_struct
id|in6_addr
id|in6addr_loopback
op_assign
id|IN6ADDR_LOOPBACK_INIT
suffix:semicolon
DECL|function|ipv6_addr_type
r_int
id|ipv6_addr_type
c_func
(paren
r_const
r_struct
id|in6_addr
op_star
id|addr
)paren
(brace
r_int
id|type
suffix:semicolon
id|u32
id|st
suffix:semicolon
id|st
op_assign
id|addr-&gt;s6_addr32
(braket
l_int|0
)braket
suffix:semicolon
r_if
c_cond
(paren
(paren
id|st
op_amp
id|htonl
c_func
(paren
l_int|0xFF000000
)paren
)paren
op_eq
id|htonl
c_func
(paren
l_int|0xFF000000
)paren
)paren
(brace
id|type
op_assign
id|IPV6_ADDR_MULTICAST
suffix:semicolon
r_switch
c_cond
(paren
(paren
id|st
op_amp
id|htonl
c_func
(paren
l_int|0x00FF0000
)paren
)paren
)paren
(brace
r_case
id|__constant_htonl
c_func
(paren
l_int|0x00010000
)paren
suffix:colon
id|type
op_or_assign
id|IPV6_ADDR_LOOPBACK
suffix:semicolon
r_break
suffix:semicolon
r_case
id|__constant_htonl
c_func
(paren
l_int|0x00020000
)paren
suffix:colon
id|type
op_or_assign
id|IPV6_ADDR_LINKLOCAL
suffix:semicolon
r_break
suffix:semicolon
r_case
id|__constant_htonl
c_func
(paren
l_int|0x00050000
)paren
suffix:colon
id|type
op_or_assign
id|IPV6_ADDR_SITELOCAL
suffix:semicolon
r_break
suffix:semicolon
)brace
suffix:semicolon
r_return
id|type
suffix:semicolon
)brace
id|type
op_assign
id|IPV6_ADDR_UNICAST
suffix:semicolon
multiline_comment|/* Consider all addresses with the first three bits different of&n;&t;   000 and 111 as finished.&n;&t; */
r_if
c_cond
(paren
(paren
id|st
op_amp
id|htonl
c_func
(paren
l_int|0xE0000000
)paren
)paren
op_ne
id|htonl
c_func
(paren
l_int|0x00000000
)paren
op_logical_and
(paren
id|st
op_amp
id|htonl
c_func
(paren
l_int|0xE0000000
)paren
)paren
op_ne
id|htonl
c_func
(paren
l_int|0xE0000000
)paren
)paren
r_return
id|type
suffix:semicolon
r_if
c_cond
(paren
(paren
id|st
op_amp
id|htonl
c_func
(paren
l_int|0xFFC00000
)paren
)paren
op_eq
id|htonl
c_func
(paren
l_int|0xFE800000
)paren
)paren
r_return
(paren
id|IPV6_ADDR_LINKLOCAL
op_or
id|type
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|st
op_amp
id|htonl
c_func
(paren
l_int|0xFFC00000
)paren
)paren
op_eq
id|htonl
c_func
(paren
l_int|0xFEC00000
)paren
)paren
r_return
(paren
id|IPV6_ADDR_SITELOCAL
op_or
id|type
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|addr-&gt;s6_addr32
(braket
l_int|0
)braket
op_or
id|addr-&gt;s6_addr32
(braket
l_int|1
)braket
)paren
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|addr-&gt;s6_addr32
(braket
l_int|2
)braket
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|addr-&gt;s6_addr32
(braket
l_int|3
)braket
op_eq
l_int|0
)paren
r_return
id|IPV6_ADDR_ANY
suffix:semicolon
r_if
c_cond
(paren
id|addr-&gt;s6_addr32
(braket
l_int|3
)braket
op_eq
id|htonl
c_func
(paren
l_int|0x00000001
)paren
)paren
r_return
(paren
id|IPV6_ADDR_LOOPBACK
op_or
id|type
)paren
suffix:semicolon
r_return
(paren
id|IPV6_ADDR_COMPATv4
op_or
id|type
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|addr-&gt;s6_addr32
(braket
l_int|2
)braket
op_eq
id|htonl
c_func
(paren
l_int|0x0000ffff
)paren
)paren
r_return
id|IPV6_ADDR_MAPPED
suffix:semicolon
)brace
id|st
op_and_assign
id|htonl
c_func
(paren
l_int|0xFF000000
)paren
suffix:semicolon
r_if
c_cond
(paren
id|st
op_eq
l_int|0
)paren
r_return
id|IPV6_ADDR_RESERVED
suffix:semicolon
id|st
op_and_assign
id|htonl
c_func
(paren
l_int|0xFE000000
)paren
suffix:semicolon
r_if
c_cond
(paren
id|st
op_eq
id|htonl
c_func
(paren
l_int|0x02000000
)paren
)paren
r_return
id|IPV6_ADDR_RESERVED
suffix:semicolon
multiline_comment|/* for NSAP */
r_if
c_cond
(paren
id|st
op_eq
id|htonl
c_func
(paren
l_int|0x04000000
)paren
)paren
r_return
id|IPV6_ADDR_RESERVED
suffix:semicolon
multiline_comment|/* for IPX */
r_return
id|type
suffix:semicolon
)brace
DECL|function|addrconf_del_timer
r_static
r_void
id|addrconf_del_timer
c_func
(paren
r_struct
id|inet6_ifaddr
op_star
id|ifp
)paren
(brace
r_if
c_cond
(paren
id|del_timer
c_func
(paren
op_amp
id|ifp-&gt;timer
)paren
)paren
id|__in6_ifa_put
c_func
(paren
id|ifp
)paren
suffix:semicolon
)brace
DECL|enum|addrconf_timer_t
r_enum
id|addrconf_timer_t
(brace
DECL|enumerator|AC_NONE
id|AC_NONE
comma
DECL|enumerator|AC_DAD
id|AC_DAD
comma
DECL|enumerator|AC_RS
id|AC_RS
comma
)brace
suffix:semicolon
DECL|function|addrconf_mod_timer
r_static
r_void
id|addrconf_mod_timer
c_func
(paren
r_struct
id|inet6_ifaddr
op_star
id|ifp
comma
r_enum
id|addrconf_timer_t
id|what
comma
r_int
r_int
id|when
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|del_timer
c_func
(paren
op_amp
id|ifp-&gt;timer
)paren
)paren
id|in6_ifa_hold
c_func
(paren
id|ifp
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|what
)paren
(brace
r_case
id|AC_DAD
suffix:colon
id|ifp-&gt;timer.function
op_assign
id|addrconf_dad_timer
suffix:semicolon
r_break
suffix:semicolon
r_case
id|AC_RS
suffix:colon
id|ifp-&gt;timer.function
op_assign
id|addrconf_rs_timer
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
suffix:semicolon
)brace
id|ifp-&gt;timer.expires
op_assign
id|jiffies
op_plus
id|when
suffix:semicolon
id|add_timer
c_func
(paren
op_amp
id|ifp-&gt;timer
)paren
suffix:semicolon
)brace
multiline_comment|/* Nobody refers to this device, we may destroy it. */
DECL|function|in6_dev_finish_destroy
r_void
id|in6_dev_finish_destroy
c_func
(paren
r_struct
id|inet6_dev
op_star
id|idev
)paren
(brace
r_struct
id|net_device
op_star
id|dev
op_assign
id|idev-&gt;dev
suffix:semicolon
id|BUG_TRAP
c_func
(paren
id|idev-&gt;addr_list
op_eq
l_int|NULL
)paren
suffix:semicolon
id|BUG_TRAP
c_func
(paren
id|idev-&gt;mc_list
op_eq
l_int|NULL
)paren
suffix:semicolon
macro_line|#ifdef NET_REFCNT_DEBUG
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;in6_dev_finish_destroy: %s&bslash;n&quot;
comma
id|dev
ques
c_cond
id|dev-&gt;name
suffix:colon
l_string|&quot;NIL&quot;
)paren
suffix:semicolon
macro_line|#endif
id|dev_put
c_func
(paren
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|idev-&gt;dead
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;Freeing alive inet6 device %p&bslash;n&quot;
comma
id|idev
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|snmp6_unregister_dev
c_func
(paren
id|idev
)paren
suffix:semicolon
id|inet6_dev_count
op_decrement
suffix:semicolon
id|kfree
c_func
(paren
id|idev
)paren
suffix:semicolon
)brace
DECL|function|ipv6_add_dev
r_static
r_struct
id|inet6_dev
op_star
id|ipv6_add_dev
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|inet6_dev
op_star
id|ndev
suffix:semicolon
id|ASSERT_RTNL
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dev-&gt;mtu
OL
id|IPV6_MIN_MTU
)paren
r_return
l_int|NULL
suffix:semicolon
id|ndev
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|inet6_dev
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ndev
)paren
(brace
id|memset
c_func
(paren
id|ndev
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|inet6_dev
)paren
)paren
suffix:semicolon
id|ndev-&gt;lock
op_assign
id|RW_LOCK_UNLOCKED
suffix:semicolon
id|ndev-&gt;dev
op_assign
id|dev
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|ndev-&gt;cnf
comma
op_amp
id|ipv6_devconf_dflt
comma
r_sizeof
(paren
id|ndev-&gt;cnf
)paren
)paren
suffix:semicolon
id|ndev-&gt;cnf.mtu6
op_assign
id|dev-&gt;mtu
suffix:semicolon
id|ndev-&gt;cnf.sysctl
op_assign
l_int|NULL
suffix:semicolon
id|ndev-&gt;nd_parms
op_assign
id|neigh_parms_alloc
c_func
(paren
id|dev
comma
op_amp
id|nd_tbl
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ndev-&gt;nd_parms
op_eq
l_int|NULL
)paren
(brace
id|kfree
c_func
(paren
id|ndev
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
id|inet6_dev_count
op_increment
suffix:semicolon
multiline_comment|/* We refer to the device */
id|dev_hold
c_func
(paren
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|snmp6_register_dev
c_func
(paren
id|ndev
)paren
OL
l_int|0
)paren
(brace
id|ADBG
c_func
(paren
(paren
id|KERN_WARNING
l_string|&quot;%s(): cannot create /proc/net/dev_snmp6/%s&bslash;n&quot;
comma
id|__FUNCTION__
comma
id|dev-&gt;name
)paren
)paren
suffix:semicolon
id|neigh_parms_release
c_func
(paren
op_amp
id|nd_tbl
comma
id|ndev-&gt;nd_parms
)paren
suffix:semicolon
id|ndev-&gt;dead
op_assign
l_int|1
suffix:semicolon
id|in6_dev_finish_destroy
c_func
(paren
id|ndev
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
multiline_comment|/* One reference from device.  We must do this before&n;&t;&t; * we invoke __ipv6_regen_rndid().&n;&t;&t; */
id|in6_dev_hold
c_func
(paren
id|ndev
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_IPV6_PRIVACY
id|get_random_bytes
c_func
(paren
id|ndev-&gt;rndid
comma
r_sizeof
(paren
id|ndev-&gt;rndid
)paren
)paren
suffix:semicolon
id|get_random_bytes
c_func
(paren
id|ndev-&gt;entropy
comma
r_sizeof
(paren
id|ndev-&gt;entropy
)paren
)paren
suffix:semicolon
id|init_timer
c_func
(paren
op_amp
id|ndev-&gt;regen_timer
)paren
suffix:semicolon
id|ndev-&gt;regen_timer.function
op_assign
id|ipv6_regen_rndid
suffix:semicolon
id|ndev-&gt;regen_timer.data
op_assign
(paren
r_int
r_int
)paren
id|ndev
suffix:semicolon
r_if
c_cond
(paren
(paren
id|dev-&gt;flags
op_amp
id|IFF_LOOPBACK
)paren
op_logical_or
id|dev-&gt;type
op_eq
id|ARPHRD_TUNNEL
op_logical_or
id|dev-&gt;type
op_eq
id|ARPHRD_SIT
)paren
(brace
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;Disabled Privacy Extensions on device %p(%s)&bslash;n&quot;
comma
id|dev
comma
id|dev-&gt;name
)paren
suffix:semicolon
id|ndev-&gt;cnf.use_tempaddr
op_assign
op_minus
l_int|1
suffix:semicolon
)brace
r_else
(brace
id|in6_dev_hold
c_func
(paren
id|ndev
)paren
suffix:semicolon
id|ipv6_regen_rndid
c_func
(paren
(paren
r_int
r_int
)paren
id|ndev
)paren
suffix:semicolon
)brace
macro_line|#endif
id|write_lock_bh
c_func
(paren
op_amp
id|addrconf_lock
)paren
suffix:semicolon
id|dev-&gt;ip6_ptr
op_assign
id|ndev
suffix:semicolon
id|write_unlock_bh
c_func
(paren
op_amp
id|addrconf_lock
)paren
suffix:semicolon
id|ipv6_mc_init_dev
c_func
(paren
id|ndev
)paren
suffix:semicolon
id|ndev-&gt;tstamp
op_assign
id|jiffies
suffix:semicolon
macro_line|#ifdef CONFIG_SYSCTL
id|neigh_sysctl_register
c_func
(paren
id|dev
comma
id|ndev-&gt;nd_parms
comma
id|NET_IPV6
comma
id|NET_IPV6_NEIGH
comma
l_string|&quot;ipv6&quot;
comma
op_amp
id|ndisc_ifinfo_sysctl_change
)paren
suffix:semicolon
id|addrconf_sysctl_register
c_func
(paren
id|ndev
comma
op_amp
id|ndev-&gt;cnf
)paren
suffix:semicolon
macro_line|#endif
)brace
r_return
id|ndev
suffix:semicolon
)brace
DECL|function|ipv6_find_idev
r_static
r_struct
id|inet6_dev
op_star
id|ipv6_find_idev
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|inet6_dev
op_star
id|idev
suffix:semicolon
id|ASSERT_RTNL
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|idev
op_assign
id|__in6_dev_get
c_func
(paren
id|dev
)paren
)paren
op_eq
l_int|NULL
)paren
(brace
r_if
c_cond
(paren
(paren
id|idev
op_assign
id|ipv6_add_dev
c_func
(paren
id|dev
)paren
)paren
op_eq
l_int|NULL
)paren
r_return
l_int|NULL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|dev-&gt;flags
op_amp
id|IFF_UP
)paren
id|ipv6_mc_up
c_func
(paren
id|idev
)paren
suffix:semicolon
r_return
id|idev
suffix:semicolon
)brace
DECL|function|dev_forward_change
r_static
r_void
id|dev_forward_change
c_func
(paren
r_struct
id|inet6_dev
op_star
id|idev
)paren
(brace
r_struct
id|net_device
op_star
id|dev
suffix:semicolon
r_struct
id|inet6_ifaddr
op_star
id|ifa
suffix:semicolon
r_struct
id|in6_addr
id|addr
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|idev
)paren
r_return
suffix:semicolon
id|dev
op_assign
id|idev-&gt;dev
suffix:semicolon
r_if
c_cond
(paren
id|dev
op_logical_and
(paren
id|dev-&gt;flags
op_amp
id|IFF_MULTICAST
)paren
)paren
(brace
id|ipv6_addr_all_routers
c_func
(paren
op_amp
id|addr
)paren
suffix:semicolon
r_if
c_cond
(paren
id|idev-&gt;cnf.forwarding
)paren
id|ipv6_dev_mc_inc
c_func
(paren
id|dev
comma
op_amp
id|addr
)paren
suffix:semicolon
r_else
id|ipv6_dev_mc_dec
c_func
(paren
id|dev
comma
op_amp
id|addr
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|ifa
op_assign
id|idev-&gt;addr_list
suffix:semicolon
id|ifa
suffix:semicolon
id|ifa
op_assign
id|ifa-&gt;if_next
)paren
(brace
id|ipv6_addr_prefix
c_func
(paren
op_amp
id|addr
comma
op_amp
id|ifa-&gt;addr
comma
id|ifa-&gt;prefix_len
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ipv6_addr_any
c_func
(paren
op_amp
id|addr
)paren
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|idev-&gt;cnf.forwarding
)paren
id|ipv6_dev_ac_inc
c_func
(paren
id|idev-&gt;dev
comma
op_amp
id|addr
)paren
suffix:semicolon
r_else
id|ipv6_dev_ac_dec
c_func
(paren
id|idev-&gt;dev
comma
op_amp
id|addr
)paren
suffix:semicolon
)brace
)brace
DECL|function|addrconf_forward_change
r_static
r_void
id|addrconf_forward_change
c_func
(paren
r_struct
id|inet6_dev
op_star
id|idev
)paren
(brace
r_struct
id|net_device
op_star
id|dev
suffix:semicolon
r_if
c_cond
(paren
id|idev
)paren
(brace
id|dev_forward_change
c_func
(paren
id|idev
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|read_lock
c_func
(paren
op_amp
id|dev_base_lock
)paren
suffix:semicolon
r_for
c_loop
(paren
id|dev
op_assign
id|dev_base
suffix:semicolon
id|dev
suffix:semicolon
id|dev
op_assign
id|dev-&gt;next
)paren
(brace
id|read_lock
c_func
(paren
op_amp
id|addrconf_lock
)paren
suffix:semicolon
id|idev
op_assign
id|__in6_dev_get
c_func
(paren
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|idev
)paren
(brace
id|idev-&gt;cnf.forwarding
op_assign
id|ipv6_devconf.forwarding
suffix:semicolon
id|dev_forward_change
c_func
(paren
id|idev
)paren
suffix:semicolon
)brace
id|read_unlock
c_func
(paren
op_amp
id|addrconf_lock
)paren
suffix:semicolon
)brace
id|read_unlock
c_func
(paren
op_amp
id|dev_base_lock
)paren
suffix:semicolon
)brace
multiline_comment|/* Nobody refers to this ifaddr, destroy it */
DECL|function|inet6_ifa_finish_destroy
r_void
id|inet6_ifa_finish_destroy
c_func
(paren
r_struct
id|inet6_ifaddr
op_star
id|ifp
)paren
(brace
id|BUG_TRAP
c_func
(paren
id|ifp-&gt;if_next
op_eq
l_int|NULL
)paren
suffix:semicolon
id|BUG_TRAP
c_func
(paren
id|ifp-&gt;lst_next
op_eq
l_int|NULL
)paren
suffix:semicolon
macro_line|#ifdef NET_REFCNT_DEBUG
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;inet6_ifa_finish_destroy&bslash;n&quot;
)paren
suffix:semicolon
macro_line|#endif
id|in6_dev_put
c_func
(paren
id|ifp-&gt;idev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|del_timer
c_func
(paren
op_amp
id|ifp-&gt;timer
)paren
)paren
id|printk
c_func
(paren
l_string|&quot;Timer is still running, when freeing ifa=%p&bslash;n&quot;
comma
id|ifp
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ifp-&gt;dead
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;Freeing alive inet6 address %p&bslash;n&quot;
comma
id|ifp
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|inet6_ifa_count
op_decrement
suffix:semicolon
id|kfree
c_func
(paren
id|ifp
)paren
suffix:semicolon
)brace
multiline_comment|/* On success it returns ifp with increased reference count */
r_static
r_struct
id|inet6_ifaddr
op_star
DECL|function|ipv6_add_addr
id|ipv6_add_addr
c_func
(paren
r_struct
id|inet6_dev
op_star
id|idev
comma
r_const
r_struct
id|in6_addr
op_star
id|addr
comma
r_int
id|pfxlen
comma
r_int
id|scope
comma
r_int
id|flags
)paren
(brace
r_struct
id|inet6_ifaddr
op_star
id|ifa
suffix:semicolon
r_int
id|hash
suffix:semicolon
r_static
id|spinlock_t
id|lock
op_assign
id|SPIN_LOCK_UNLOCKED
suffix:semicolon
id|spin_lock_bh
c_func
(paren
op_amp
id|lock
)paren
suffix:semicolon
multiline_comment|/* Ignore adding duplicate addresses on an interface */
r_if
c_cond
(paren
id|ipv6_chk_same_addr
c_func
(paren
id|addr
comma
id|idev-&gt;dev
)paren
)paren
(brace
id|spin_unlock_bh
c_func
(paren
op_amp
id|lock
)paren
suffix:semicolon
id|ADBG
c_func
(paren
(paren
l_string|&quot;ipv6_add_addr: already assigned&bslash;n&quot;
)paren
)paren
suffix:semicolon
r_return
id|ERR_PTR
c_func
(paren
op_minus
id|EEXIST
)paren
suffix:semicolon
)brace
id|ifa
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|inet6_ifaddr
)paren
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ifa
op_eq
l_int|NULL
)paren
(brace
id|spin_unlock_bh
c_func
(paren
op_amp
id|lock
)paren
suffix:semicolon
id|ADBG
c_func
(paren
(paren
l_string|&quot;ipv6_add_addr: malloc failed&bslash;n&quot;
)paren
)paren
suffix:semicolon
r_return
id|ERR_PTR
c_func
(paren
op_minus
id|ENOBUFS
)paren
suffix:semicolon
)brace
id|memset
c_func
(paren
id|ifa
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|inet6_ifaddr
)paren
)paren
suffix:semicolon
id|ipv6_addr_copy
c_func
(paren
op_amp
id|ifa-&gt;addr
comma
id|addr
)paren
suffix:semicolon
id|spin_lock_init
c_func
(paren
op_amp
id|ifa-&gt;lock
)paren
suffix:semicolon
id|init_timer
c_func
(paren
op_amp
id|ifa-&gt;timer
)paren
suffix:semicolon
id|ifa-&gt;timer.data
op_assign
(paren
r_int
r_int
)paren
id|ifa
suffix:semicolon
id|ifa-&gt;scope
op_assign
id|scope
suffix:semicolon
id|ifa-&gt;prefix_len
op_assign
id|pfxlen
suffix:semicolon
id|ifa-&gt;flags
op_assign
id|flags
op_or
id|IFA_F_TENTATIVE
suffix:semicolon
id|ifa-&gt;cstamp
op_assign
id|ifa-&gt;tstamp
op_assign
id|jiffies
suffix:semicolon
id|read_lock
c_func
(paren
op_amp
id|addrconf_lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|idev-&gt;dead
)paren
(brace
id|read_unlock
c_func
(paren
op_amp
id|addrconf_lock
)paren
suffix:semicolon
id|spin_unlock_bh
c_func
(paren
op_amp
id|lock
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|ifa
)paren
suffix:semicolon
r_return
id|ERR_PTR
c_func
(paren
op_minus
id|ENODEV
)paren
suffix:semicolon
multiline_comment|/*XXX*/
)brace
id|inet6_ifa_count
op_increment
suffix:semicolon
id|ifa-&gt;idev
op_assign
id|idev
suffix:semicolon
id|in6_dev_hold
c_func
(paren
id|idev
)paren
suffix:semicolon
multiline_comment|/* For caller */
id|in6_ifa_hold
c_func
(paren
id|ifa
)paren
suffix:semicolon
multiline_comment|/* Add to big hash table */
id|hash
op_assign
id|ipv6_addr_hash
c_func
(paren
id|addr
)paren
suffix:semicolon
id|write_lock_bh
c_func
(paren
op_amp
id|addrconf_hash_lock
)paren
suffix:semicolon
id|ifa-&gt;lst_next
op_assign
id|inet6_addr_lst
(braket
id|hash
)braket
suffix:semicolon
id|inet6_addr_lst
(braket
id|hash
)braket
op_assign
id|ifa
suffix:semicolon
id|in6_ifa_hold
c_func
(paren
id|ifa
)paren
suffix:semicolon
id|write_unlock_bh
c_func
(paren
op_amp
id|addrconf_hash_lock
)paren
suffix:semicolon
id|write_lock_bh
c_func
(paren
op_amp
id|idev-&gt;lock
)paren
suffix:semicolon
multiline_comment|/* Add to inet6_dev unicast addr list. */
id|ifa-&gt;if_next
op_assign
id|idev-&gt;addr_list
suffix:semicolon
id|idev-&gt;addr_list
op_assign
id|ifa
suffix:semicolon
macro_line|#ifdef CONFIG_IPV6_PRIVACY
id|ifa-&gt;regen_count
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|ifa-&gt;flags
op_amp
id|IFA_F_TEMPORARY
)paren
(brace
id|ifa-&gt;tmp_next
op_assign
id|idev-&gt;tempaddr_list
suffix:semicolon
id|idev-&gt;tempaddr_list
op_assign
id|ifa
suffix:semicolon
id|in6_ifa_hold
c_func
(paren
id|ifa
)paren
suffix:semicolon
)brace
r_else
(brace
id|ifa-&gt;tmp_next
op_assign
l_int|NULL
suffix:semicolon
)brace
macro_line|#endif
id|in6_ifa_hold
c_func
(paren
id|ifa
)paren
suffix:semicolon
id|write_unlock_bh
c_func
(paren
op_amp
id|idev-&gt;lock
)paren
suffix:semicolon
id|read_unlock
c_func
(paren
op_amp
id|addrconf_lock
)paren
suffix:semicolon
id|spin_unlock_bh
c_func
(paren
op_amp
id|lock
)paren
suffix:semicolon
id|notifier_call_chain
c_func
(paren
op_amp
id|inet6addr_chain
comma
id|NETDEV_UP
comma
id|ifa
)paren
suffix:semicolon
r_return
id|ifa
suffix:semicolon
)brace
multiline_comment|/* This function wants to get referenced ifp and releases it before return */
DECL|function|ipv6_del_addr
r_static
r_void
id|ipv6_del_addr
c_func
(paren
r_struct
id|inet6_ifaddr
op_star
id|ifp
)paren
(brace
r_struct
id|inet6_ifaddr
op_star
id|ifa
comma
op_star
op_star
id|ifap
suffix:semicolon
r_struct
id|inet6_dev
op_star
id|idev
op_assign
id|ifp-&gt;idev
suffix:semicolon
r_int
id|hash
suffix:semicolon
id|hash
op_assign
id|ipv6_addr_hash
c_func
(paren
op_amp
id|ifp-&gt;addr
)paren
suffix:semicolon
id|ifp-&gt;dead
op_assign
l_int|1
suffix:semicolon
id|write_lock_bh
c_func
(paren
op_amp
id|addrconf_hash_lock
)paren
suffix:semicolon
r_for
c_loop
(paren
id|ifap
op_assign
op_amp
id|inet6_addr_lst
(braket
id|hash
)braket
suffix:semicolon
(paren
id|ifa
op_assign
op_star
id|ifap
)paren
op_ne
l_int|NULL
suffix:semicolon
id|ifap
op_assign
op_amp
id|ifa-&gt;lst_next
)paren
(brace
r_if
c_cond
(paren
id|ifa
op_eq
id|ifp
)paren
(brace
op_star
id|ifap
op_assign
id|ifa-&gt;lst_next
suffix:semicolon
id|__in6_ifa_put
c_func
(paren
id|ifp
)paren
suffix:semicolon
id|ifa-&gt;lst_next
op_assign
l_int|NULL
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
id|write_unlock_bh
c_func
(paren
op_amp
id|addrconf_hash_lock
)paren
suffix:semicolon
id|write_lock_bh
c_func
(paren
op_amp
id|idev-&gt;lock
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_IPV6_PRIVACY
r_if
c_cond
(paren
id|ifp-&gt;flags
op_amp
id|IFA_F_TEMPORARY
)paren
(brace
r_for
c_loop
(paren
id|ifap
op_assign
op_amp
id|idev-&gt;tempaddr_list
suffix:semicolon
(paren
id|ifa
op_assign
op_star
id|ifap
)paren
op_ne
l_int|NULL
suffix:semicolon
id|ifap
op_assign
op_amp
id|ifa-&gt;tmp_next
)paren
(brace
r_if
c_cond
(paren
id|ifa
op_eq
id|ifp
)paren
(brace
op_star
id|ifap
op_assign
id|ifa-&gt;tmp_next
suffix:semicolon
r_if
c_cond
(paren
id|ifp-&gt;ifpub
)paren
(brace
id|in6_ifa_put
c_func
(paren
id|ifp-&gt;ifpub
)paren
suffix:semicolon
id|ifp-&gt;ifpub
op_assign
l_int|NULL
suffix:semicolon
)brace
id|__in6_ifa_put
c_func
(paren
id|ifp
)paren
suffix:semicolon
id|ifa-&gt;tmp_next
op_assign
l_int|NULL
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
)brace
macro_line|#endif
r_for
c_loop
(paren
id|ifap
op_assign
op_amp
id|idev-&gt;addr_list
suffix:semicolon
(paren
id|ifa
op_assign
op_star
id|ifap
)paren
op_ne
l_int|NULL
suffix:semicolon
id|ifap
op_assign
op_amp
id|ifa-&gt;if_next
)paren
(brace
r_if
c_cond
(paren
id|ifa
op_eq
id|ifp
)paren
(brace
op_star
id|ifap
op_assign
id|ifa-&gt;if_next
suffix:semicolon
id|__in6_ifa_put
c_func
(paren
id|ifp
)paren
suffix:semicolon
id|ifa-&gt;if_next
op_assign
l_int|NULL
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
id|write_unlock_bh
c_func
(paren
op_amp
id|idev-&gt;lock
)paren
suffix:semicolon
id|ipv6_ifa_notify
c_func
(paren
id|RTM_DELADDR
comma
id|ifp
)paren
suffix:semicolon
id|notifier_call_chain
c_func
(paren
op_amp
id|inet6addr_chain
comma
id|NETDEV_DOWN
comma
id|ifp
)paren
suffix:semicolon
id|addrconf_del_timer
c_func
(paren
id|ifp
)paren
suffix:semicolon
id|in6_ifa_put
c_func
(paren
id|ifp
)paren
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_IPV6_PRIVACY
DECL|function|ipv6_create_tempaddr
r_static
r_int
id|ipv6_create_tempaddr
c_func
(paren
r_struct
id|inet6_ifaddr
op_star
id|ifp
comma
r_struct
id|inet6_ifaddr
op_star
id|ift
)paren
(brace
r_struct
id|inet6_dev
op_star
id|idev
suffix:semicolon
r_struct
id|in6_addr
id|addr
comma
op_star
id|tmpaddr
suffix:semicolon
r_int
r_int
id|tmp_prefered_lft
comma
id|tmp_valid_lft
suffix:semicolon
r_int
id|tmp_plen
suffix:semicolon
r_int
id|ret
op_assign
l_int|0
suffix:semicolon
r_int
id|max_addresses
suffix:semicolon
r_if
c_cond
(paren
id|ift
)paren
(brace
id|spin_lock_bh
c_func
(paren
op_amp
id|ift-&gt;lock
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|addr.s6_addr
(braket
l_int|8
)braket
comma
op_amp
id|ift-&gt;addr.s6_addr
(braket
l_int|8
)braket
comma
l_int|8
)paren
suffix:semicolon
id|spin_unlock_bh
c_func
(paren
op_amp
id|ift-&gt;lock
)paren
suffix:semicolon
id|tmpaddr
op_assign
op_amp
id|addr
suffix:semicolon
)brace
r_else
(brace
id|tmpaddr
op_assign
l_int|NULL
suffix:semicolon
)brace
id|retry
suffix:colon
id|spin_lock_bh
c_func
(paren
op_amp
id|ifp-&gt;lock
)paren
suffix:semicolon
id|in6_ifa_hold
c_func
(paren
id|ifp
)paren
suffix:semicolon
id|idev
op_assign
id|ifp-&gt;idev
suffix:semicolon
id|in6_dev_hold
c_func
(paren
id|idev
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|addr.s6_addr
comma
id|ifp-&gt;addr.s6_addr
comma
l_int|8
)paren
suffix:semicolon
id|write_lock
c_func
(paren
op_amp
id|idev-&gt;lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|idev-&gt;cnf.use_tempaddr
op_le
l_int|0
)paren
(brace
id|write_unlock
c_func
(paren
op_amp
id|idev-&gt;lock
)paren
suffix:semicolon
id|spin_unlock_bh
c_func
(paren
op_amp
id|ifp-&gt;lock
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;ipv6_create_tempaddr(): use_tempaddr is disabled.&bslash;n&quot;
)paren
suffix:semicolon
id|in6_dev_put
c_func
(paren
id|idev
)paren
suffix:semicolon
id|in6_ifa_put
c_func
(paren
id|ifp
)paren
suffix:semicolon
id|ret
op_assign
op_minus
l_int|1
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ifp-&gt;regen_count
op_increment
op_ge
id|idev-&gt;cnf.regen_max_retry
)paren
(brace
id|idev-&gt;cnf.use_tempaddr
op_assign
op_minus
l_int|1
suffix:semicolon
multiline_comment|/*XXX*/
id|write_unlock
c_func
(paren
op_amp
id|idev-&gt;lock
)paren
suffix:semicolon
id|spin_unlock_bh
c_func
(paren
op_amp
id|ifp-&gt;lock
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;ipv6_create_tempaddr(): regeneration time exceeded. disabled temporary address support.&bslash;n&quot;
)paren
suffix:semicolon
id|in6_dev_put
c_func
(paren
id|idev
)paren
suffix:semicolon
id|in6_ifa_put
c_func
(paren
id|ifp
)paren
suffix:semicolon
id|ret
op_assign
op_minus
l_int|1
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
r_if
c_cond
(paren
id|__ipv6_try_regen_rndid
c_func
(paren
id|idev
comma
id|tmpaddr
)paren
OL
l_int|0
)paren
(brace
id|write_unlock
c_func
(paren
op_amp
id|idev-&gt;lock
)paren
suffix:semicolon
id|spin_unlock_bh
c_func
(paren
op_amp
id|ifp-&gt;lock
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;ipv6_create_tempaddr(): regeneration of randomized interface id failed.&bslash;n&quot;
)paren
suffix:semicolon
id|in6_dev_put
c_func
(paren
id|idev
)paren
suffix:semicolon
id|in6_ifa_put
c_func
(paren
id|ifp
)paren
suffix:semicolon
id|ret
op_assign
op_minus
l_int|1
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|memcpy
c_func
(paren
op_amp
id|addr.s6_addr
(braket
l_int|8
)braket
comma
id|idev-&gt;rndid
comma
l_int|8
)paren
suffix:semicolon
id|tmp_valid_lft
op_assign
id|min_t
c_func
(paren
id|__u32
comma
id|ifp-&gt;valid_lft
comma
id|idev-&gt;cnf.temp_valid_lft
)paren
suffix:semicolon
id|tmp_prefered_lft
op_assign
id|min_t
c_func
(paren
id|__u32
comma
id|ifp-&gt;prefered_lft
comma
id|idev-&gt;cnf.temp_prefered_lft
op_minus
id|desync_factor
op_div
id|HZ
)paren
suffix:semicolon
id|tmp_plen
op_assign
id|ifp-&gt;prefix_len
suffix:semicolon
id|max_addresses
op_assign
id|idev-&gt;cnf.max_addresses
suffix:semicolon
id|write_unlock
c_func
(paren
op_amp
id|idev-&gt;lock
)paren
suffix:semicolon
id|spin_unlock_bh
c_func
(paren
op_amp
id|ifp-&gt;lock
)paren
suffix:semicolon
id|ift
op_assign
op_logical_neg
id|max_addresses
op_logical_or
id|ipv6_count_addresses
c_func
(paren
id|idev
)paren
OL
id|max_addresses
ques
c_cond
id|ipv6_add_addr
c_func
(paren
id|idev
comma
op_amp
id|addr
comma
id|tmp_plen
comma
id|ipv6_addr_type
c_func
(paren
op_amp
id|addr
)paren
op_amp
id|IPV6_ADDR_SCOPE_MASK
comma
id|IFA_F_TEMPORARY
)paren
suffix:colon
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ift
op_logical_or
id|IS_ERR
c_func
(paren
id|ift
)paren
)paren
(brace
id|in6_dev_put
c_func
(paren
id|idev
)paren
suffix:semicolon
id|in6_ifa_put
c_func
(paren
id|ifp
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;ipv6_create_tempaddr(): retry temporary address regeneration.&bslash;n&quot;
)paren
suffix:semicolon
id|tmpaddr
op_assign
op_amp
id|addr
suffix:semicolon
r_goto
id|retry
suffix:semicolon
)brace
id|spin_lock_bh
c_func
(paren
op_amp
id|ift-&gt;lock
)paren
suffix:semicolon
id|ift-&gt;ifpub
op_assign
id|ifp
suffix:semicolon
id|ift-&gt;valid_lft
op_assign
id|tmp_valid_lft
suffix:semicolon
id|ift-&gt;prefered_lft
op_assign
id|tmp_prefered_lft
suffix:semicolon
id|ift-&gt;cstamp
op_assign
id|ifp-&gt;cstamp
suffix:semicolon
id|ift-&gt;tstamp
op_assign
id|ifp-&gt;tstamp
suffix:semicolon
id|spin_unlock_bh
c_func
(paren
op_amp
id|ift-&gt;lock
)paren
suffix:semicolon
id|addrconf_dad_start
c_func
(paren
id|ift
comma
l_int|0
)paren
suffix:semicolon
id|in6_ifa_put
c_func
(paren
id|ift
)paren
suffix:semicolon
id|in6_dev_put
c_func
(paren
id|idev
)paren
suffix:semicolon
id|out
suffix:colon
r_return
id|ret
suffix:semicolon
)brace
macro_line|#endif
multiline_comment|/*&n; *&t;Choose an appropriate source address&n; *&t;should do:&n; *&t;i)&t;get an address with an appropriate scope&n; *&t;ii)&t;see if there is a specific route for the destination and use&n; *&t;&t;an address of the attached interface &n; *&t;iii)&t;don&squot;t use deprecated addresses&n; */
DECL|function|ipv6_saddr_pref
r_static
r_int
r_inline
id|ipv6_saddr_pref
c_func
(paren
r_const
r_struct
id|inet6_ifaddr
op_star
id|ifp
comma
id|u8
id|invpref
)paren
(brace
r_int
id|pref
suffix:semicolon
id|pref
op_assign
id|ifp-&gt;flags
op_amp
id|IFA_F_DEPRECATED
ques
c_cond
l_int|0
suffix:colon
l_int|2
suffix:semicolon
macro_line|#ifdef CONFIG_IPV6_PRIVACY
id|pref
op_or_assign
(paren
id|ifp-&gt;flags
op_xor
id|invpref
)paren
op_amp
id|IFA_F_TEMPORARY
ques
c_cond
l_int|0
suffix:colon
l_int|1
suffix:semicolon
macro_line|#endif
r_return
id|pref
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_IPV6_PRIVACY
DECL|macro|IPV6_GET_SADDR_MAXSCORE
mdefine_line|#define IPV6_GET_SADDR_MAXSCORE(score)&t;((score) == 3)
macro_line|#else
DECL|macro|IPV6_GET_SADDR_MAXSCORE
mdefine_line|#define IPV6_GET_SADDR_MAXSCORE(score)&t;(score)
macro_line|#endif
DECL|function|ipv6_dev_get_saddr
r_int
id|ipv6_dev_get_saddr
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|in6_addr
op_star
id|daddr
comma
r_struct
id|in6_addr
op_star
id|saddr
comma
r_int
id|onlink
)paren
(brace
r_struct
id|inet6_ifaddr
op_star
id|ifp
op_assign
l_int|NULL
suffix:semicolon
r_struct
id|inet6_ifaddr
op_star
id|match
op_assign
l_int|NULL
suffix:semicolon
r_struct
id|inet6_dev
op_star
id|idev
suffix:semicolon
r_int
id|scope
suffix:semicolon
r_int
id|err
suffix:semicolon
r_int
id|hiscore
op_assign
op_minus
l_int|1
comma
id|score
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|onlink
)paren
id|scope
op_assign
id|ipv6_addr_scope
c_func
(paren
id|daddr
)paren
suffix:semicolon
r_else
id|scope
op_assign
id|IFA_LINK
suffix:semicolon
multiline_comment|/*&n;&t; *&t;known dev&n;&t; *&t;search dev and walk through dev addresses&n;&t; */
r_if
c_cond
(paren
id|dev
)paren
(brace
r_if
c_cond
(paren
id|dev-&gt;flags
op_amp
id|IFF_LOOPBACK
)paren
id|scope
op_assign
id|IFA_HOST
suffix:semicolon
id|read_lock
c_func
(paren
op_amp
id|addrconf_lock
)paren
suffix:semicolon
id|idev
op_assign
id|__in6_dev_get
c_func
(paren
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|idev
)paren
(brace
id|read_lock_bh
c_func
(paren
op_amp
id|idev-&gt;lock
)paren
suffix:semicolon
r_for
c_loop
(paren
id|ifp
op_assign
id|idev-&gt;addr_list
suffix:semicolon
id|ifp
suffix:semicolon
id|ifp
op_assign
id|ifp-&gt;if_next
)paren
(brace
r_if
c_cond
(paren
id|ifp-&gt;scope
op_eq
id|scope
)paren
(brace
r_if
c_cond
(paren
id|ifp-&gt;flags
op_amp
id|IFA_F_TENTATIVE
)paren
r_continue
suffix:semicolon
macro_line|#ifdef CONFIG_IPV6_PRIVACY
id|score
op_assign
id|ipv6_saddr_pref
c_func
(paren
id|ifp
comma
id|idev-&gt;cnf.use_tempaddr
OG
l_int|1
ques
c_cond
id|IFA_F_TEMPORARY
suffix:colon
l_int|0
)paren
suffix:semicolon
macro_line|#else
id|score
op_assign
id|ipv6_saddr_pref
c_func
(paren
id|ifp
comma
l_int|0
)paren
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
id|score
op_le
id|hiscore
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|match
)paren
id|in6_ifa_put
c_func
(paren
id|match
)paren
suffix:semicolon
id|match
op_assign
id|ifp
suffix:semicolon
id|hiscore
op_assign
id|score
suffix:semicolon
id|in6_ifa_hold
c_func
(paren
id|ifp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|IPV6_GET_SADDR_MAXSCORE
c_func
(paren
id|score
)paren
)paren
(brace
id|read_unlock_bh
c_func
(paren
op_amp
id|idev-&gt;lock
)paren
suffix:semicolon
id|read_unlock
c_func
(paren
op_amp
id|addrconf_lock
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
)brace
)brace
id|read_unlock_bh
c_func
(paren
op_amp
id|idev-&gt;lock
)paren
suffix:semicolon
)brace
id|read_unlock
c_func
(paren
op_amp
id|addrconf_lock
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|scope
op_eq
id|IFA_LINK
)paren
r_goto
id|out
suffix:semicolon
multiline_comment|/*&n;&t; *&t;dev == NULL or search failed for specified dev&n;&t; */
id|read_lock
c_func
(paren
op_amp
id|dev_base_lock
)paren
suffix:semicolon
id|read_lock
c_func
(paren
op_amp
id|addrconf_lock
)paren
suffix:semicolon
r_for
c_loop
(paren
id|dev
op_assign
id|dev_base
suffix:semicolon
id|dev
suffix:semicolon
id|dev
op_assign
id|dev-&gt;next
)paren
(brace
id|idev
op_assign
id|__in6_dev_get
c_func
(paren
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|idev
)paren
(brace
id|read_lock_bh
c_func
(paren
op_amp
id|idev-&gt;lock
)paren
suffix:semicolon
r_for
c_loop
(paren
id|ifp
op_assign
id|idev-&gt;addr_list
suffix:semicolon
id|ifp
suffix:semicolon
id|ifp
op_assign
id|ifp-&gt;if_next
)paren
(brace
r_if
c_cond
(paren
id|ifp-&gt;scope
op_eq
id|scope
)paren
(brace
r_if
c_cond
(paren
id|ifp-&gt;flags
op_amp
id|IFA_F_TENTATIVE
)paren
r_continue
suffix:semicolon
macro_line|#ifdef CONFIG_IPV6_PRIVACY
id|score
op_assign
id|ipv6_saddr_pref
c_func
(paren
id|ifp
comma
id|idev-&gt;cnf.use_tempaddr
OG
l_int|1
ques
c_cond
id|IFA_F_TEMPORARY
suffix:colon
l_int|0
)paren
suffix:semicolon
macro_line|#else
id|score
op_assign
id|ipv6_saddr_pref
c_func
(paren
id|ifp
comma
l_int|0
)paren
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
id|score
op_le
id|hiscore
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|match
)paren
id|in6_ifa_put
c_func
(paren
id|match
)paren
suffix:semicolon
id|match
op_assign
id|ifp
suffix:semicolon
id|hiscore
op_assign
id|score
suffix:semicolon
id|in6_ifa_hold
c_func
(paren
id|ifp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|IPV6_GET_SADDR_MAXSCORE
c_func
(paren
id|score
)paren
)paren
(brace
id|read_unlock_bh
c_func
(paren
op_amp
id|idev-&gt;lock
)paren
suffix:semicolon
r_goto
id|out_unlock_base
suffix:semicolon
)brace
)brace
)brace
id|read_unlock_bh
c_func
(paren
op_amp
id|idev-&gt;lock
)paren
suffix:semicolon
)brace
)brace
id|out_unlock_base
suffix:colon
id|read_unlock
c_func
(paren
op_amp
id|addrconf_lock
)paren
suffix:semicolon
id|read_unlock
c_func
(paren
op_amp
id|dev_base_lock
)paren
suffix:semicolon
id|out
suffix:colon
id|err
op_assign
op_minus
id|EADDRNOTAVAIL
suffix:semicolon
r_if
c_cond
(paren
id|match
)paren
(brace
id|ipv6_addr_copy
c_func
(paren
id|saddr
comma
op_amp
id|match-&gt;addr
)paren
suffix:semicolon
id|err
op_assign
l_int|0
suffix:semicolon
id|in6_ifa_put
c_func
(paren
id|match
)paren
suffix:semicolon
)brace
r_return
id|err
suffix:semicolon
)brace
DECL|function|ipv6_get_saddr
r_int
id|ipv6_get_saddr
c_func
(paren
r_struct
id|dst_entry
op_star
id|dst
comma
r_struct
id|in6_addr
op_star
id|daddr
comma
r_struct
id|in6_addr
op_star
id|saddr
)paren
(brace
r_struct
id|rt6_info
op_star
id|rt
suffix:semicolon
r_struct
id|net_device
op_star
id|dev
op_assign
l_int|NULL
suffix:semicolon
r_int
id|onlink
suffix:semicolon
id|rt
op_assign
(paren
r_struct
id|rt6_info
op_star
)paren
id|dst
suffix:semicolon
r_if
c_cond
(paren
id|rt
)paren
id|dev
op_assign
id|rt-&gt;rt6i_dev
suffix:semicolon
id|onlink
op_assign
(paren
id|rt
op_logical_and
(paren
id|rt-&gt;rt6i_flags
op_amp
id|RTF_ALLONLINK
)paren
)paren
suffix:semicolon
r_return
id|ipv6_dev_get_saddr
c_func
(paren
id|dev
comma
id|daddr
comma
id|saddr
comma
id|onlink
)paren
suffix:semicolon
)brace
DECL|function|ipv6_get_lladdr
r_int
id|ipv6_get_lladdr
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|in6_addr
op_star
id|addr
)paren
(brace
r_struct
id|inet6_dev
op_star
id|idev
suffix:semicolon
r_int
id|err
op_assign
op_minus
id|EADDRNOTAVAIL
suffix:semicolon
id|read_lock
c_func
(paren
op_amp
id|addrconf_lock
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|idev
op_assign
id|__in6_dev_get
c_func
(paren
id|dev
)paren
)paren
op_ne
l_int|NULL
)paren
(brace
r_struct
id|inet6_ifaddr
op_star
id|ifp
suffix:semicolon
id|read_lock_bh
c_func
(paren
op_amp
id|idev-&gt;lock
)paren
suffix:semicolon
r_for
c_loop
(paren
id|ifp
op_assign
id|idev-&gt;addr_list
suffix:semicolon
id|ifp
suffix:semicolon
id|ifp
op_assign
id|ifp-&gt;if_next
)paren
(brace
r_if
c_cond
(paren
id|ifp-&gt;scope
op_eq
id|IFA_LINK
op_logical_and
op_logical_neg
(paren
id|ifp-&gt;flags
op_amp
id|IFA_F_TENTATIVE
)paren
)paren
(brace
id|ipv6_addr_copy
c_func
(paren
id|addr
comma
op_amp
id|ifp-&gt;addr
)paren
suffix:semicolon
id|err
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
id|read_unlock_bh
c_func
(paren
op_amp
id|idev-&gt;lock
)paren
suffix:semicolon
)brace
id|read_unlock
c_func
(paren
op_amp
id|addrconf_lock
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|function|ipv6_count_addresses
r_static
r_int
id|ipv6_count_addresses
c_func
(paren
r_struct
id|inet6_dev
op_star
id|idev
)paren
(brace
r_int
id|cnt
op_assign
l_int|0
suffix:semicolon
r_struct
id|inet6_ifaddr
op_star
id|ifp
suffix:semicolon
id|read_lock_bh
c_func
(paren
op_amp
id|idev-&gt;lock
)paren
suffix:semicolon
r_for
c_loop
(paren
id|ifp
op_assign
id|idev-&gt;addr_list
suffix:semicolon
id|ifp
suffix:semicolon
id|ifp
op_assign
id|ifp-&gt;if_next
)paren
id|cnt
op_increment
suffix:semicolon
id|read_unlock_bh
c_func
(paren
op_amp
id|idev-&gt;lock
)paren
suffix:semicolon
r_return
id|cnt
suffix:semicolon
)brace
DECL|function|ipv6_chk_addr
r_int
id|ipv6_chk_addr
c_func
(paren
r_struct
id|in6_addr
op_star
id|addr
comma
r_struct
id|net_device
op_star
id|dev
comma
r_int
id|strict
)paren
(brace
r_struct
id|inet6_ifaddr
op_star
id|ifp
suffix:semicolon
id|u8
id|hash
op_assign
id|ipv6_addr_hash
c_func
(paren
id|addr
)paren
suffix:semicolon
id|read_lock_bh
c_func
(paren
op_amp
id|addrconf_hash_lock
)paren
suffix:semicolon
r_for
c_loop
(paren
id|ifp
op_assign
id|inet6_addr_lst
(braket
id|hash
)braket
suffix:semicolon
id|ifp
suffix:semicolon
id|ifp
op_assign
id|ifp-&gt;lst_next
)paren
(brace
r_if
c_cond
(paren
id|ipv6_addr_cmp
c_func
(paren
op_amp
id|ifp-&gt;addr
comma
id|addr
)paren
op_eq
l_int|0
op_logical_and
op_logical_neg
(paren
id|ifp-&gt;flags
op_amp
id|IFA_F_TENTATIVE
)paren
)paren
(brace
r_if
c_cond
(paren
id|dev
op_eq
l_int|NULL
op_logical_or
id|ifp-&gt;idev-&gt;dev
op_eq
id|dev
op_logical_or
op_logical_neg
(paren
id|ifp-&gt;scope
op_amp
(paren
id|IFA_LINK
op_or
id|IFA_HOST
)paren
op_logical_or
id|strict
)paren
)paren
r_break
suffix:semicolon
)brace
)brace
id|read_unlock_bh
c_func
(paren
op_amp
id|addrconf_hash_lock
)paren
suffix:semicolon
r_return
id|ifp
op_ne
l_int|NULL
suffix:semicolon
)brace
r_static
DECL|function|ipv6_chk_same_addr
r_int
id|ipv6_chk_same_addr
c_func
(paren
r_const
r_struct
id|in6_addr
op_star
id|addr
comma
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|inet6_ifaddr
op_star
id|ifp
suffix:semicolon
id|u8
id|hash
op_assign
id|ipv6_addr_hash
c_func
(paren
id|addr
)paren
suffix:semicolon
id|read_lock_bh
c_func
(paren
op_amp
id|addrconf_hash_lock
)paren
suffix:semicolon
r_for
c_loop
(paren
id|ifp
op_assign
id|inet6_addr_lst
(braket
id|hash
)braket
suffix:semicolon
id|ifp
suffix:semicolon
id|ifp
op_assign
id|ifp-&gt;lst_next
)paren
(brace
r_if
c_cond
(paren
id|ipv6_addr_cmp
c_func
(paren
op_amp
id|ifp-&gt;addr
comma
id|addr
)paren
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|dev
op_eq
l_int|NULL
op_logical_or
id|ifp-&gt;idev-&gt;dev
op_eq
id|dev
)paren
r_break
suffix:semicolon
)brace
)brace
id|read_unlock_bh
c_func
(paren
op_amp
id|addrconf_hash_lock
)paren
suffix:semicolon
r_return
id|ifp
op_ne
l_int|NULL
suffix:semicolon
)brace
DECL|function|ipv6_get_ifaddr
r_struct
id|inet6_ifaddr
op_star
id|ipv6_get_ifaddr
c_func
(paren
r_struct
id|in6_addr
op_star
id|addr
comma
r_struct
id|net_device
op_star
id|dev
comma
r_int
id|strict
)paren
(brace
r_struct
id|inet6_ifaddr
op_star
id|ifp
suffix:semicolon
id|u8
id|hash
op_assign
id|ipv6_addr_hash
c_func
(paren
id|addr
)paren
suffix:semicolon
id|read_lock_bh
c_func
(paren
op_amp
id|addrconf_hash_lock
)paren
suffix:semicolon
r_for
c_loop
(paren
id|ifp
op_assign
id|inet6_addr_lst
(braket
id|hash
)braket
suffix:semicolon
id|ifp
suffix:semicolon
id|ifp
op_assign
id|ifp-&gt;lst_next
)paren
(brace
r_if
c_cond
(paren
id|ipv6_addr_cmp
c_func
(paren
op_amp
id|ifp-&gt;addr
comma
id|addr
)paren
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|dev
op_eq
l_int|NULL
op_logical_or
id|ifp-&gt;idev-&gt;dev
op_eq
id|dev
op_logical_or
op_logical_neg
(paren
id|ifp-&gt;scope
op_amp
(paren
id|IFA_LINK
op_or
id|IFA_HOST
)paren
op_logical_or
id|strict
)paren
)paren
(brace
id|in6_ifa_hold
c_func
(paren
id|ifp
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
)brace
id|read_unlock_bh
c_func
(paren
op_amp
id|addrconf_hash_lock
)paren
suffix:semicolon
r_return
id|ifp
suffix:semicolon
)brace
DECL|function|ipv6_rcv_saddr_equal
r_int
id|ipv6_rcv_saddr_equal
c_func
(paren
r_const
r_struct
id|sock
op_star
id|sk
comma
r_const
r_struct
id|sock
op_star
id|sk2
)paren
(brace
r_const
r_struct
id|in6_addr
op_star
id|sk_rcv_saddr6
op_assign
op_amp
id|inet6_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|rcv_saddr
suffix:semicolon
r_const
r_struct
id|in6_addr
op_star
id|sk2_rcv_saddr6
op_assign
id|tcp_v6_rcv_saddr
c_func
(paren
id|sk2
)paren
suffix:semicolon
id|u32
id|sk_rcv_saddr
op_assign
id|inet_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|rcv_saddr
suffix:semicolon
id|u32
id|sk2_rcv_saddr
op_assign
id|tcp_v4_rcv_saddr
c_func
(paren
id|sk2
)paren
suffix:semicolon
r_int
id|sk_ipv6only
op_assign
id|ipv6_only_sock
c_func
(paren
id|sk
)paren
suffix:semicolon
r_int
id|sk2_ipv6only
op_assign
id|tcp_v6_ipv6only
c_func
(paren
id|sk2
)paren
suffix:semicolon
r_int
id|addr_type
op_assign
id|ipv6_addr_type
c_func
(paren
id|sk_rcv_saddr6
)paren
suffix:semicolon
r_int
id|addr_type2
op_assign
id|sk2_rcv_saddr6
ques
c_cond
id|ipv6_addr_type
c_func
(paren
id|sk2_rcv_saddr6
)paren
suffix:colon
id|IPV6_ADDR_MAPPED
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|sk2_rcv_saddr
op_logical_and
op_logical_neg
id|sk_ipv6only
)paren
r_return
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|addr_type2
op_eq
id|IPV6_ADDR_ANY
op_logical_and
op_logical_neg
(paren
id|sk2_ipv6only
op_logical_and
id|addr_type
op_eq
id|IPV6_ADDR_MAPPED
)paren
)paren
r_return
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|addr_type
op_eq
id|IPV6_ADDR_ANY
op_logical_and
op_logical_neg
(paren
id|sk_ipv6only
op_logical_and
id|addr_type2
op_eq
id|IPV6_ADDR_MAPPED
)paren
)paren
r_return
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|sk2_rcv_saddr6
op_logical_and
op_logical_neg
id|ipv6_addr_cmp
c_func
(paren
id|sk_rcv_saddr6
comma
id|sk2_rcv_saddr6
)paren
)paren
r_return
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|addr_type
op_eq
id|IPV6_ADDR_MAPPED
op_logical_and
op_logical_neg
id|sk2_ipv6only
op_logical_and
(paren
op_logical_neg
id|sk2_rcv_saddr
op_logical_or
op_logical_neg
id|sk_rcv_saddr
op_logical_or
id|sk_rcv_saddr
op_eq
id|sk2_rcv_saddr
)paren
)paren
r_return
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* Gets referenced address, destroys ifaddr */
DECL|function|addrconf_dad_failure
r_void
id|addrconf_dad_failure
c_func
(paren
r_struct
id|inet6_ifaddr
op_star
id|ifp
)paren
(brace
r_if
c_cond
(paren
id|net_ratelimit
c_func
(paren
)paren
)paren
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;%s: duplicate address detected!&bslash;n&quot;
comma
id|ifp-&gt;idev-&gt;dev-&gt;name
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ifp-&gt;flags
op_amp
id|IFA_F_PERMANENT
)paren
(brace
id|spin_lock_bh
c_func
(paren
op_amp
id|ifp-&gt;lock
)paren
suffix:semicolon
id|addrconf_del_timer
c_func
(paren
id|ifp
)paren
suffix:semicolon
id|ifp-&gt;flags
op_or_assign
id|IFA_F_TENTATIVE
suffix:semicolon
id|spin_unlock_bh
c_func
(paren
op_amp
id|ifp-&gt;lock
)paren
suffix:semicolon
id|in6_ifa_put
c_func
(paren
id|ifp
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_IPV6_PRIVACY
)brace
r_else
r_if
c_cond
(paren
id|ifp-&gt;flags
op_amp
id|IFA_F_TEMPORARY
)paren
(brace
r_struct
id|inet6_ifaddr
op_star
id|ifpub
suffix:semicolon
id|spin_lock_bh
c_func
(paren
op_amp
id|ifp-&gt;lock
)paren
suffix:semicolon
id|ifpub
op_assign
id|ifp-&gt;ifpub
suffix:semicolon
r_if
c_cond
(paren
id|ifpub
)paren
(brace
id|in6_ifa_hold
c_func
(paren
id|ifpub
)paren
suffix:semicolon
id|spin_unlock_bh
c_func
(paren
op_amp
id|ifp-&gt;lock
)paren
suffix:semicolon
id|ipv6_create_tempaddr
c_func
(paren
id|ifpub
comma
id|ifp
)paren
suffix:semicolon
id|in6_ifa_put
c_func
(paren
id|ifpub
)paren
suffix:semicolon
)brace
r_else
(brace
id|spin_unlock_bh
c_func
(paren
op_amp
id|ifp-&gt;lock
)paren
suffix:semicolon
)brace
id|ipv6_del_addr
c_func
(paren
id|ifp
)paren
suffix:semicolon
macro_line|#endif
)brace
r_else
id|ipv6_del_addr
c_func
(paren
id|ifp
)paren
suffix:semicolon
)brace
multiline_comment|/* Join to solicited addr multicast group. */
DECL|function|addrconf_join_solict
r_void
id|addrconf_join_solict
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|in6_addr
op_star
id|addr
)paren
(brace
r_struct
id|in6_addr
id|maddr
suffix:semicolon
r_if
c_cond
(paren
id|dev-&gt;flags
op_amp
(paren
id|IFF_LOOPBACK
op_or
id|IFF_NOARP
)paren
)paren
r_return
suffix:semicolon
id|addrconf_addr_solict_mult
c_func
(paren
id|addr
comma
op_amp
id|maddr
)paren
suffix:semicolon
id|ipv6_dev_mc_inc
c_func
(paren
id|dev
comma
op_amp
id|maddr
)paren
suffix:semicolon
)brace
DECL|function|addrconf_leave_solict
r_void
id|addrconf_leave_solict
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|in6_addr
op_star
id|addr
)paren
(brace
r_struct
id|in6_addr
id|maddr
suffix:semicolon
r_if
c_cond
(paren
id|dev-&gt;flags
op_amp
(paren
id|IFF_LOOPBACK
op_or
id|IFF_NOARP
)paren
)paren
r_return
suffix:semicolon
id|addrconf_addr_solict_mult
c_func
(paren
id|addr
comma
op_amp
id|maddr
)paren
suffix:semicolon
id|ipv6_dev_mc_dec
c_func
(paren
id|dev
comma
op_amp
id|maddr
)paren
suffix:semicolon
)brace
DECL|function|ipv6_generate_eui64
r_static
r_int
id|ipv6_generate_eui64
c_func
(paren
id|u8
op_star
id|eui
comma
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_switch
c_cond
(paren
id|dev-&gt;type
)paren
(brace
r_case
id|ARPHRD_ETHER
suffix:colon
r_case
id|ARPHRD_FDDI
suffix:colon
r_case
id|ARPHRD_IEEE802_TR
suffix:colon
r_if
c_cond
(paren
id|dev-&gt;addr_len
op_ne
id|ETH_ALEN
)paren
r_return
op_minus
l_int|1
suffix:semicolon
id|memcpy
c_func
(paren
id|eui
comma
id|dev-&gt;dev_addr
comma
l_int|3
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|eui
op_plus
l_int|5
comma
id|dev-&gt;dev_addr
op_plus
l_int|3
comma
l_int|3
)paren
suffix:semicolon
id|eui
(braket
l_int|3
)braket
op_assign
l_int|0xFF
suffix:semicolon
id|eui
(braket
l_int|4
)braket
op_assign
l_int|0xFE
suffix:semicolon
id|eui
(braket
l_int|0
)braket
op_xor_assign
l_int|2
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_case
id|ARPHRD_ARCNET
suffix:colon
multiline_comment|/* XXX: inherit EUI-64 from other interface -- yoshfuji */
r_if
c_cond
(paren
id|dev-&gt;addr_len
op_ne
id|ARCNET_ALEN
)paren
r_return
op_minus
l_int|1
suffix:semicolon
id|memset
c_func
(paren
id|eui
comma
l_int|0
comma
l_int|7
)paren
suffix:semicolon
id|eui
(braket
l_int|7
)braket
op_assign
op_star
(paren
id|u8
op_star
)paren
id|dev-&gt;dev_addr
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_return
op_minus
l_int|1
suffix:semicolon
)brace
DECL|function|ipv6_inherit_eui64
r_static
r_int
id|ipv6_inherit_eui64
c_func
(paren
id|u8
op_star
id|eui
comma
r_struct
id|inet6_dev
op_star
id|idev
)paren
(brace
r_int
id|err
op_assign
op_minus
l_int|1
suffix:semicolon
r_struct
id|inet6_ifaddr
op_star
id|ifp
suffix:semicolon
id|read_lock_bh
c_func
(paren
op_amp
id|idev-&gt;lock
)paren
suffix:semicolon
r_for
c_loop
(paren
id|ifp
op_assign
id|idev-&gt;addr_list
suffix:semicolon
id|ifp
suffix:semicolon
id|ifp
op_assign
id|ifp-&gt;if_next
)paren
(brace
r_if
c_cond
(paren
id|ifp-&gt;scope
op_eq
id|IFA_LINK
op_logical_and
op_logical_neg
(paren
id|ifp-&gt;flags
op_amp
id|IFA_F_TENTATIVE
)paren
)paren
(brace
id|memcpy
c_func
(paren
id|eui
comma
id|ifp-&gt;addr.s6_addr
op_plus
l_int|8
comma
l_int|8
)paren
suffix:semicolon
id|err
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
id|read_unlock_bh
c_func
(paren
op_amp
id|idev-&gt;lock
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_IPV6_PRIVACY
multiline_comment|/* (re)generation of randomized interface identifier (RFC 3041 3.2, 3.5) */
DECL|function|__ipv6_regen_rndid
r_static
r_int
id|__ipv6_regen_rndid
c_func
(paren
r_struct
id|inet6_dev
op_star
id|idev
)paren
(brace
r_struct
id|net_device
op_star
id|dev
suffix:semicolon
r_struct
id|scatterlist
id|sg
(braket
l_int|2
)braket
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|idev-&gt;entropy
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
id|offset_in_page
c_func
(paren
id|idev-&gt;entropy
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
l_int|8
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|idev-&gt;work_eui64
)paren
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|offset
op_assign
id|offset_in_page
c_func
(paren
id|idev-&gt;work_eui64
)paren
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|length
op_assign
l_int|8
suffix:semicolon
id|dev
op_assign
id|idev-&gt;dev
suffix:semicolon
r_if
c_cond
(paren
id|ipv6_generate_eui64
c_func
(paren
id|idev-&gt;work_eui64
comma
id|dev
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;__ipv6_regen_rndid(idev=%p): cannot get EUI64 identifier; use random bytes.&bslash;n&quot;
comma
id|idev
)paren
suffix:semicolon
id|get_random_bytes
c_func
(paren
id|idev-&gt;work_eui64
comma
r_sizeof
(paren
id|idev-&gt;work_eui64
)paren
)paren
suffix:semicolon
)brace
id|regen
suffix:colon
id|spin_lock
c_func
(paren
op_amp
id|md5_tfm_lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|unlikely
c_func
(paren
id|md5_tfm
op_eq
l_int|NULL
)paren
)paren
(brace
id|spin_unlock
c_func
(paren
op_amp
id|md5_tfm_lock
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
id|crypto_digest_init
c_func
(paren
id|md5_tfm
)paren
suffix:semicolon
id|crypto_digest_update
c_func
(paren
id|md5_tfm
comma
id|sg
comma
l_int|2
)paren
suffix:semicolon
id|crypto_digest_final
c_func
(paren
id|md5_tfm
comma
id|idev-&gt;work_digest
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|md5_tfm_lock
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|idev-&gt;rndid
comma
op_amp
id|idev-&gt;work_digest
(braket
l_int|0
)braket
comma
l_int|8
)paren
suffix:semicolon
id|idev-&gt;rndid
(braket
l_int|0
)braket
op_and_assign
op_complement
l_int|0x02
suffix:semicolon
id|memcpy
c_func
(paren
id|idev-&gt;entropy
comma
op_amp
id|idev-&gt;work_digest
(braket
l_int|8
)braket
comma
l_int|8
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * &lt;draft-ietf-ipngwg-temp-addresses-v2-00.txt&gt;:&n;&t; * check if generated address is not inappropriate&n;&t; *&n;&t; *  - Reserved subnet anycast (RFC 2526)&n;&t; *&t;11111101 11....11 1xxxxxxx&n;&t; *  - ISATAP (draft-ietf-ngtrans-isatap-13.txt) 5.1&n;&t; *&t;00-00-5E-FE-xx-xx-xx-xx&n;&t; *  - value 0&n;&t; *  - XXX: already assigned to an address on the device&n;&t; */
r_if
c_cond
(paren
id|idev-&gt;rndid
(braket
l_int|0
)braket
op_eq
l_int|0xfd
op_logical_and
(paren
id|idev-&gt;rndid
(braket
l_int|1
)braket
op_amp
id|idev-&gt;rndid
(braket
l_int|2
)braket
op_amp
id|idev-&gt;rndid
(braket
l_int|3
)braket
op_amp
id|idev-&gt;rndid
(braket
l_int|4
)braket
op_amp
id|idev-&gt;rndid
(braket
l_int|5
)braket
op_amp
id|idev-&gt;rndid
(braket
l_int|6
)braket
)paren
op_eq
l_int|0xff
op_logical_and
(paren
id|idev-&gt;rndid
(braket
l_int|7
)braket
op_amp
l_int|0x80
)paren
)paren
r_goto
id|regen
suffix:semicolon
r_if
c_cond
(paren
(paren
id|idev-&gt;rndid
(braket
l_int|0
)braket
op_or
id|idev-&gt;rndid
(braket
l_int|1
)braket
)paren
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|idev-&gt;rndid
(braket
l_int|2
)braket
op_eq
l_int|0x5e
op_logical_and
id|idev-&gt;rndid
(braket
l_int|3
)braket
op_eq
l_int|0xfe
)paren
r_goto
id|regen
suffix:semicolon
r_if
c_cond
(paren
(paren
id|idev-&gt;rndid
(braket
l_int|2
)braket
op_or
id|idev-&gt;rndid
(braket
l_int|3
)braket
op_or
id|idev-&gt;rndid
(braket
l_int|4
)braket
op_or
id|idev-&gt;rndid
(braket
l_int|5
)braket
op_or
id|idev-&gt;rndid
(braket
l_int|6
)braket
op_or
id|idev-&gt;rndid
(braket
l_int|7
)braket
)paren
op_eq
l_int|0x00
)paren
r_goto
id|regen
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|ipv6_regen_rndid
r_static
r_void
id|ipv6_regen_rndid
c_func
(paren
r_int
r_int
id|data
)paren
(brace
r_struct
id|inet6_dev
op_star
id|idev
op_assign
(paren
r_struct
id|inet6_dev
op_star
)paren
id|data
suffix:semicolon
r_int
r_int
id|expires
suffix:semicolon
id|read_lock_bh
c_func
(paren
op_amp
id|addrconf_lock
)paren
suffix:semicolon
id|write_lock_bh
c_func
(paren
op_amp
id|idev-&gt;lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|idev-&gt;dead
)paren
r_goto
id|out
suffix:semicolon
r_if
c_cond
(paren
id|__ipv6_regen_rndid
c_func
(paren
id|idev
)paren
OL
l_int|0
)paren
r_goto
id|out
suffix:semicolon
id|expires
op_assign
id|jiffies
op_plus
id|idev-&gt;cnf.temp_prefered_lft
op_star
id|HZ
op_minus
id|idev-&gt;cnf.regen_max_retry
op_star
id|idev-&gt;cnf.dad_transmits
op_star
id|idev-&gt;nd_parms-&gt;retrans_time
op_minus
id|desync_factor
suffix:semicolon
r_if
c_cond
(paren
id|time_before
c_func
(paren
id|expires
comma
id|jiffies
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;ipv6_regen_rndid(): too short regeneration interval; timer disabled for %s.&bslash;n&quot;
comma
id|idev-&gt;dev-&gt;name
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|mod_timer
c_func
(paren
op_amp
id|idev-&gt;regen_timer
comma
id|expires
)paren
)paren
id|in6_dev_hold
c_func
(paren
id|idev
)paren
suffix:semicolon
id|out
suffix:colon
id|write_unlock_bh
c_func
(paren
op_amp
id|idev-&gt;lock
)paren
suffix:semicolon
id|read_unlock_bh
c_func
(paren
op_amp
id|addrconf_lock
)paren
suffix:semicolon
id|in6_dev_put
c_func
(paren
id|idev
)paren
suffix:semicolon
)brace
DECL|function|__ipv6_try_regen_rndid
r_static
r_int
id|__ipv6_try_regen_rndid
c_func
(paren
r_struct
id|inet6_dev
op_star
id|idev
comma
r_struct
id|in6_addr
op_star
id|tmpaddr
)paren
(brace
r_int
id|ret
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|tmpaddr
op_logical_and
id|memcmp
c_func
(paren
id|idev-&gt;rndid
comma
op_amp
id|tmpaddr-&gt;s6_addr
(braket
l_int|8
)braket
comma
l_int|8
)paren
op_eq
l_int|0
)paren
id|ret
op_assign
id|__ipv6_regen_rndid
c_func
(paren
id|idev
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
macro_line|#endif
multiline_comment|/*&n; *&t;Add prefix route.&n; */
r_static
r_void
DECL|function|addrconf_prefix_route
id|addrconf_prefix_route
c_func
(paren
r_struct
id|in6_addr
op_star
id|pfx
comma
r_int
id|plen
comma
r_struct
id|net_device
op_star
id|dev
comma
r_int
r_int
id|expires
comma
r_int
id|flags
)paren
(brace
r_struct
id|in6_rtmsg
id|rtmsg
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|rtmsg
comma
l_int|0
comma
r_sizeof
(paren
id|rtmsg
)paren
)paren
suffix:semicolon
id|ipv6_addr_copy
c_func
(paren
op_amp
id|rtmsg.rtmsg_dst
comma
id|pfx
)paren
suffix:semicolon
id|rtmsg.rtmsg_dst_len
op_assign
id|plen
suffix:semicolon
id|rtmsg.rtmsg_metric
op_assign
id|IP6_RT_PRIO_ADDRCONF
suffix:semicolon
id|rtmsg.rtmsg_ifindex
op_assign
id|dev-&gt;ifindex
suffix:semicolon
id|rtmsg.rtmsg_info
op_assign
id|expires
suffix:semicolon
id|rtmsg.rtmsg_flags
op_assign
id|RTF_UP
op_or
id|flags
suffix:semicolon
id|rtmsg.rtmsg_type
op_assign
id|RTMSG_NEWROUTE
suffix:semicolon
multiline_comment|/* Prevent useless cloning on PtP SIT.&n;&t;   This thing is done here expecting that the whole&n;&t;   class of non-broadcast devices need not cloning.&n;&t; */
r_if
c_cond
(paren
id|dev-&gt;type
op_eq
id|ARPHRD_SIT
op_logical_and
(paren
id|dev-&gt;flags
op_amp
id|IFF_POINTOPOINT
)paren
)paren
id|rtmsg.rtmsg_flags
op_or_assign
id|RTF_NONEXTHOP
suffix:semicolon
id|ip6_route_add
c_func
(paren
op_amp
id|rtmsg
comma
l_int|NULL
comma
l_int|NULL
)paren
suffix:semicolon
)brace
multiline_comment|/* Create &quot;default&quot; multicast route to the interface */
DECL|function|addrconf_add_mroute
r_static
r_void
id|addrconf_add_mroute
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|in6_rtmsg
id|rtmsg
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|rtmsg
comma
l_int|0
comma
r_sizeof
(paren
id|rtmsg
)paren
)paren
suffix:semicolon
id|ipv6_addr_set
c_func
(paren
op_amp
id|rtmsg.rtmsg_dst
comma
id|htonl
c_func
(paren
l_int|0xFF000000
)paren
comma
l_int|0
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
id|rtmsg.rtmsg_dst_len
op_assign
l_int|8
suffix:semicolon
id|rtmsg.rtmsg_metric
op_assign
id|IP6_RT_PRIO_ADDRCONF
suffix:semicolon
id|rtmsg.rtmsg_ifindex
op_assign
id|dev-&gt;ifindex
suffix:semicolon
id|rtmsg.rtmsg_flags
op_assign
id|RTF_UP
suffix:semicolon
id|rtmsg.rtmsg_type
op_assign
id|RTMSG_NEWROUTE
suffix:semicolon
id|ip6_route_add
c_func
(paren
op_amp
id|rtmsg
comma
l_int|NULL
comma
l_int|NULL
)paren
suffix:semicolon
)brace
DECL|function|sit_route_add
r_static
r_void
id|sit_route_add
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|in6_rtmsg
id|rtmsg
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|rtmsg
comma
l_int|0
comma
r_sizeof
(paren
id|rtmsg
)paren
)paren
suffix:semicolon
id|rtmsg.rtmsg_type
op_assign
id|RTMSG_NEWROUTE
suffix:semicolon
id|rtmsg.rtmsg_metric
op_assign
id|IP6_RT_PRIO_ADDRCONF
suffix:semicolon
multiline_comment|/* prefix length - 96 bits &quot;::d.d.d.d&quot; */
id|rtmsg.rtmsg_dst_len
op_assign
l_int|96
suffix:semicolon
id|rtmsg.rtmsg_flags
op_assign
id|RTF_UP
op_or
id|RTF_NONEXTHOP
suffix:semicolon
id|rtmsg.rtmsg_ifindex
op_assign
id|dev-&gt;ifindex
suffix:semicolon
id|ip6_route_add
c_func
(paren
op_amp
id|rtmsg
comma
l_int|NULL
comma
l_int|NULL
)paren
suffix:semicolon
)brace
DECL|function|addrconf_add_lroute
r_static
r_void
id|addrconf_add_lroute
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|in6_addr
id|addr
suffix:semicolon
id|ipv6_addr_set
c_func
(paren
op_amp
id|addr
comma
id|htonl
c_func
(paren
l_int|0xFE800000
)paren
comma
l_int|0
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
id|addrconf_prefix_route
c_func
(paren
op_amp
id|addr
comma
l_int|64
comma
id|dev
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
)brace
DECL|function|addrconf_add_dev
r_static
r_struct
id|inet6_dev
op_star
id|addrconf_add_dev
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|inet6_dev
op_star
id|idev
suffix:semicolon
id|ASSERT_RTNL
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|idev
op_assign
id|ipv6_find_idev
c_func
(paren
id|dev
)paren
)paren
op_eq
l_int|NULL
)paren
r_return
l_int|NULL
suffix:semicolon
multiline_comment|/* Add default multicast route */
id|addrconf_add_mroute
c_func
(paren
id|dev
)paren
suffix:semicolon
multiline_comment|/* Add link local route */
id|addrconf_add_lroute
c_func
(paren
id|dev
)paren
suffix:semicolon
r_return
id|idev
suffix:semicolon
)brace
DECL|function|addrconf_prefix_rcv
r_void
id|addrconf_prefix_rcv
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
id|u8
op_star
id|opt
comma
r_int
id|len
)paren
(brace
r_struct
id|prefix_info
op_star
id|pinfo
suffix:semicolon
id|__u32
id|valid_lft
suffix:semicolon
id|__u32
id|prefered_lft
suffix:semicolon
r_int
id|addr_type
suffix:semicolon
r_int
r_int
id|rt_expires
suffix:semicolon
r_struct
id|inet6_dev
op_star
id|in6_dev
suffix:semicolon
id|pinfo
op_assign
(paren
r_struct
id|prefix_info
op_star
)paren
id|opt
suffix:semicolon
r_if
c_cond
(paren
id|len
OL
r_sizeof
(paren
r_struct
id|prefix_info
)paren
)paren
(brace
id|ADBG
c_func
(paren
(paren
l_string|&quot;addrconf: prefix option too short&bslash;n&quot;
)paren
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
multiline_comment|/*&n;&t; *&t;Validation checks ([ADDRCONF], page 19)&n;&t; */
id|addr_type
op_assign
id|ipv6_addr_type
c_func
(paren
op_amp
id|pinfo-&gt;prefix
)paren
suffix:semicolon
r_if
c_cond
(paren
id|addr_type
op_amp
(paren
id|IPV6_ADDR_MULTICAST
op_or
id|IPV6_ADDR_LINKLOCAL
)paren
)paren
r_return
suffix:semicolon
id|valid_lft
op_assign
id|ntohl
c_func
(paren
id|pinfo-&gt;valid
)paren
suffix:semicolon
id|prefered_lft
op_assign
id|ntohl
c_func
(paren
id|pinfo-&gt;prefered
)paren
suffix:semicolon
r_if
c_cond
(paren
id|prefered_lft
OG
id|valid_lft
)paren
(brace
r_if
c_cond
(paren
id|net_ratelimit
c_func
(paren
)paren
)paren
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;addrconf: prefix option has invalid lifetime&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|in6_dev
op_assign
id|in6_dev_get
c_func
(paren
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|in6_dev
op_eq
l_int|NULL
)paren
(brace
r_if
c_cond
(paren
id|net_ratelimit
c_func
(paren
)paren
)paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;addrconf: device %s not configured&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
multiline_comment|/*&n;&t; *&t;Two things going on here:&n;&t; *&t;1) Add routes for on-link prefixes&n;&t; *&t;2) Configure prefixes with the auto flag set&n;&t; */
multiline_comment|/* Avoid arithmetic overflow. Really, we could&n;&t;   save rt_expires in seconds, likely valid_lft,&n;&t;   but it would require division in fib gc, that it&n;&t;   not good.&n;&t; */
r_if
c_cond
(paren
id|valid_lft
op_ge
l_int|0x7FFFFFFF
op_div
id|HZ
)paren
id|rt_expires
op_assign
l_int|0
suffix:semicolon
r_else
id|rt_expires
op_assign
id|jiffies
op_plus
id|valid_lft
op_star
id|HZ
suffix:semicolon
r_if
c_cond
(paren
id|pinfo-&gt;onlink
)paren
(brace
r_struct
id|rt6_info
op_star
id|rt
suffix:semicolon
id|rt
op_assign
id|rt6_lookup
c_func
(paren
op_amp
id|pinfo-&gt;prefix
comma
l_int|NULL
comma
id|dev-&gt;ifindex
comma
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rt
op_logical_and
(paren
(paren
id|rt-&gt;rt6i_flags
op_amp
(paren
id|RTF_GATEWAY
op_or
id|RTF_DEFAULT
)paren
)paren
op_eq
l_int|0
)paren
)paren
(brace
r_if
c_cond
(paren
id|rt-&gt;rt6i_flags
op_amp
id|RTF_EXPIRES
)paren
(brace
r_if
c_cond
(paren
id|valid_lft
op_eq
l_int|0
)paren
(brace
id|ip6_del_rt
c_func
(paren
id|rt
comma
l_int|NULL
comma
l_int|NULL
)paren
suffix:semicolon
id|rt
op_assign
l_int|NULL
suffix:semicolon
)brace
r_else
(brace
id|rt-&gt;rt6i_expires
op_assign
id|rt_expires
suffix:semicolon
)brace
)brace
)brace
r_else
r_if
c_cond
(paren
id|valid_lft
)paren
(brace
id|addrconf_prefix_route
c_func
(paren
op_amp
id|pinfo-&gt;prefix
comma
id|pinfo-&gt;prefix_len
comma
id|dev
comma
id|rt_expires
comma
id|RTF_ADDRCONF
op_or
id|RTF_EXPIRES
op_or
id|RTF_PREFIX_RT
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|rt
)paren
id|dst_release
c_func
(paren
op_amp
id|rt-&gt;u.dst
)paren
suffix:semicolon
)brace
multiline_comment|/* Try to figure out our local address for this prefix */
r_if
c_cond
(paren
id|pinfo-&gt;autoconf
op_logical_and
id|in6_dev-&gt;cnf.autoconf
)paren
(brace
r_struct
id|inet6_ifaddr
op_star
id|ifp
suffix:semicolon
r_struct
id|in6_addr
id|addr
suffix:semicolon
r_int
id|create
op_assign
l_int|0
comma
id|update_lft
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|pinfo-&gt;prefix_len
op_eq
l_int|64
)paren
(brace
id|memcpy
c_func
(paren
op_amp
id|addr
comma
op_amp
id|pinfo-&gt;prefix
comma
l_int|8
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ipv6_generate_eui64
c_func
(paren
id|addr.s6_addr
op_plus
l_int|8
comma
id|dev
)paren
op_logical_and
id|ipv6_inherit_eui64
c_func
(paren
id|addr.s6_addr
op_plus
l_int|8
comma
id|in6_dev
)paren
)paren
(brace
id|in6_dev_put
c_func
(paren
id|in6_dev
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_goto
id|ok
suffix:semicolon
)brace
r_if
c_cond
(paren
id|net_ratelimit
c_func
(paren
)paren
)paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;IPv6 addrconf: prefix with wrong length %d&bslash;n&quot;
comma
id|pinfo-&gt;prefix_len
)paren
suffix:semicolon
id|in6_dev_put
c_func
(paren
id|in6_dev
)paren
suffix:semicolon
r_return
suffix:semicolon
id|ok
suffix:colon
id|ifp
op_assign
id|ipv6_get_ifaddr
c_func
(paren
op_amp
id|addr
comma
id|dev
comma
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ifp
op_eq
l_int|NULL
op_logical_and
id|valid_lft
)paren
(brace
r_int
id|max_addresses
op_assign
id|in6_dev-&gt;cnf.max_addresses
suffix:semicolon
multiline_comment|/* Do not allow to create too much of autoconfigured&n;&t;&t;&t; * addresses; this would be too easy way to crash kernel.&n;&t;&t;&t; */
r_if
c_cond
(paren
op_logical_neg
id|max_addresses
op_logical_or
id|ipv6_count_addresses
c_func
(paren
id|in6_dev
)paren
OL
id|max_addresses
)paren
id|ifp
op_assign
id|ipv6_add_addr
c_func
(paren
id|in6_dev
comma
op_amp
id|addr
comma
id|pinfo-&gt;prefix_len
comma
id|addr_type
op_amp
id|IPV6_ADDR_SCOPE_MASK
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ifp
op_logical_or
id|IS_ERR
c_func
(paren
id|ifp
)paren
)paren
(brace
id|in6_dev_put
c_func
(paren
id|in6_dev
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|update_lft
op_assign
id|create
op_assign
l_int|1
suffix:semicolon
id|ifp-&gt;cstamp
op_assign
id|jiffies
suffix:semicolon
id|addrconf_dad_start
c_func
(paren
id|ifp
comma
id|RTF_ADDRCONF
op_or
id|RTF_PREFIX_RT
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ifp
)paren
(brace
r_int
id|flags
suffix:semicolon
r_int
r_int
id|now
suffix:semicolon
macro_line|#ifdef CONFIG_IPV6_PRIVACY
r_struct
id|inet6_ifaddr
op_star
id|ift
suffix:semicolon
macro_line|#endif
id|u32
id|stored_lft
suffix:semicolon
multiline_comment|/* update lifetime (RFC2462 5.5.3 e) */
id|spin_lock
c_func
(paren
op_amp
id|ifp-&gt;lock
)paren
suffix:semicolon
id|now
op_assign
id|jiffies
suffix:semicolon
r_if
c_cond
(paren
id|ifp-&gt;valid_lft
OG
(paren
id|now
op_minus
id|ifp-&gt;tstamp
)paren
op_div
id|HZ
)paren
id|stored_lft
op_assign
id|ifp-&gt;valid_lft
op_minus
(paren
id|now
op_minus
id|ifp-&gt;tstamp
)paren
op_div
id|HZ
suffix:semicolon
r_else
id|stored_lft
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|update_lft
op_logical_and
id|stored_lft
)paren
(brace
r_if
c_cond
(paren
id|valid_lft
OG
id|MIN_VALID_LIFETIME
op_logical_or
id|valid_lft
OG
id|stored_lft
)paren
id|update_lft
op_assign
l_int|1
suffix:semicolon
r_else
r_if
c_cond
(paren
id|stored_lft
op_le
id|MIN_VALID_LIFETIME
)paren
(brace
multiline_comment|/* valid_lft &lt;= stored_lft is always true */
multiline_comment|/* XXX: IPsec */
id|update_lft
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|valid_lft
op_assign
id|MIN_VALID_LIFETIME
suffix:semicolon
r_if
c_cond
(paren
id|valid_lft
OL
id|prefered_lft
)paren
id|prefered_lft
op_assign
id|valid_lft
suffix:semicolon
id|update_lft
op_assign
l_int|1
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|update_lft
)paren
(brace
id|ifp-&gt;valid_lft
op_assign
id|valid_lft
suffix:semicolon
id|ifp-&gt;prefered_lft
op_assign
id|prefered_lft
suffix:semicolon
id|ifp-&gt;tstamp
op_assign
id|now
suffix:semicolon
id|flags
op_assign
id|ifp-&gt;flags
suffix:semicolon
id|ifp-&gt;flags
op_and_assign
op_complement
id|IFA_F_DEPRECATED
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|ifp-&gt;lock
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|flags
op_amp
id|IFA_F_TENTATIVE
)paren
)paren
id|ipv6_ifa_notify
c_func
(paren
(paren
id|flags
op_amp
id|IFA_F_DEPRECATED
)paren
ques
c_cond
l_int|0
suffix:colon
id|RTM_NEWADDR
comma
id|ifp
)paren
suffix:semicolon
)brace
r_else
id|spin_unlock
c_func
(paren
op_amp
id|ifp-&gt;lock
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_IPV6_PRIVACY
id|read_lock_bh
c_func
(paren
op_amp
id|in6_dev-&gt;lock
)paren
suffix:semicolon
multiline_comment|/* update all temporary addresses in the list */
r_for
c_loop
(paren
id|ift
op_assign
id|in6_dev-&gt;tempaddr_list
suffix:semicolon
id|ift
suffix:semicolon
id|ift
op_assign
id|ift-&gt;tmp_next
)paren
(brace
multiline_comment|/*&n;&t;&t;&t;&t; * When adjusting the lifetimes of an existing&n;&t;&t;&t;&t; * temporary address, only lower the lifetimes.&n;&t;&t;&t;&t; * Implementations must not increase the&n;&t;&t;&t;&t; * lifetimes of an existing temporary address&n;&t;&t;&t;&t; * when processing a Prefix Information Option.&n;&t;&t;&t;&t; */
id|spin_lock
c_func
(paren
op_amp
id|ift-&gt;lock
)paren
suffix:semicolon
id|flags
op_assign
id|ift-&gt;flags
suffix:semicolon
r_if
c_cond
(paren
id|ift-&gt;valid_lft
OG
id|valid_lft
op_logical_and
id|ift-&gt;valid_lft
op_minus
id|valid_lft
OG
(paren
id|jiffies
op_minus
id|ift-&gt;tstamp
)paren
op_div
id|HZ
)paren
id|ift-&gt;valid_lft
op_assign
id|valid_lft
op_plus
(paren
id|jiffies
op_minus
id|ift-&gt;tstamp
)paren
op_div
id|HZ
suffix:semicolon
r_if
c_cond
(paren
id|ift-&gt;prefered_lft
OG
id|prefered_lft
op_logical_and
id|ift-&gt;prefered_lft
op_minus
id|prefered_lft
OG
(paren
id|jiffies
op_minus
id|ift-&gt;tstamp
)paren
op_div
id|HZ
)paren
id|ift-&gt;prefered_lft
op_assign
id|prefered_lft
op_plus
(paren
id|jiffies
op_minus
id|ift-&gt;tstamp
)paren
op_div
id|HZ
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|ift-&gt;lock
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|flags
op_amp
id|IFA_F_TENTATIVE
)paren
)paren
id|ipv6_ifa_notify
c_func
(paren
l_int|0
comma
id|ift
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|create
op_logical_and
id|in6_dev-&gt;cnf.use_tempaddr
OG
l_int|0
)paren
(brace
multiline_comment|/*&n;&t;&t;&t;&t; * When a new public address is created as described in [ADDRCONF],&n;&t;&t;&t;&t; * also create a new temporary address.&n;&t;&t;&t;&t; */
id|read_unlock_bh
c_func
(paren
op_amp
id|in6_dev-&gt;lock
)paren
suffix:semicolon
id|ipv6_create_tempaddr
c_func
(paren
id|ifp
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_else
(brace
id|read_unlock_bh
c_func
(paren
op_amp
id|in6_dev-&gt;lock
)paren
suffix:semicolon
)brace
macro_line|#endif
id|in6_ifa_put
c_func
(paren
id|ifp
)paren
suffix:semicolon
id|addrconf_verify
c_func
(paren
l_int|0
)paren
suffix:semicolon
)brace
)brace
id|inet6_prefix_notify
c_func
(paren
id|RTM_NEWPREFIX
comma
id|in6_dev
comma
id|pinfo
)paren
suffix:semicolon
id|in6_dev_put
c_func
(paren
id|in6_dev
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; *&t;Set destination address.&n; *&t;Special case for SIT interfaces where we create a new &quot;virtual&quot;&n; *&t;device.&n; */
DECL|function|addrconf_set_dstaddr
r_int
id|addrconf_set_dstaddr
c_func
(paren
r_void
op_star
id|arg
)paren
(brace
r_struct
id|in6_ifreq
id|ireq
suffix:semicolon
r_struct
id|net_device
op_star
id|dev
suffix:semicolon
r_int
id|err
op_assign
op_minus
id|EINVAL
suffix:semicolon
id|rtnl_lock
c_func
(paren
)paren
suffix:semicolon
id|err
op_assign
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|ireq
comma
id|arg
comma
r_sizeof
(paren
r_struct
id|in6_ifreq
)paren
)paren
)paren
r_goto
id|err_exit
suffix:semicolon
id|dev
op_assign
id|__dev_get_by_index
c_func
(paren
id|ireq.ifr6_ifindex
)paren
suffix:semicolon
id|err
op_assign
op_minus
id|ENODEV
suffix:semicolon
r_if
c_cond
(paren
id|dev
op_eq
l_int|NULL
)paren
r_goto
id|err_exit
suffix:semicolon
r_if
c_cond
(paren
id|dev-&gt;type
op_eq
id|ARPHRD_SIT
)paren
(brace
r_struct
id|ifreq
id|ifr
suffix:semicolon
id|mm_segment_t
id|oldfs
suffix:semicolon
r_struct
id|ip_tunnel_parm
id|p
suffix:semicolon
id|err
op_assign
op_minus
id|EADDRNOTAVAIL
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|ipv6_addr_type
c_func
(paren
op_amp
id|ireq.ifr6_addr
)paren
op_amp
id|IPV6_ADDR_COMPATv4
)paren
)paren
r_goto
id|err_exit
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|p
comma
l_int|0
comma
r_sizeof
(paren
id|p
)paren
)paren
suffix:semicolon
id|p.iph.daddr
op_assign
id|ireq.ifr6_addr.s6_addr32
(braket
l_int|3
)braket
suffix:semicolon
id|p.iph.saddr
op_assign
l_int|0
suffix:semicolon
id|p.iph.version
op_assign
l_int|4
suffix:semicolon
id|p.iph.ihl
op_assign
l_int|5
suffix:semicolon
id|p.iph.protocol
op_assign
id|IPPROTO_IPV6
suffix:semicolon
id|p.iph.ttl
op_assign
l_int|64
suffix:semicolon
id|ifr.ifr_ifru.ifru_data
op_assign
(paren
r_void
op_star
)paren
op_amp
id|p
suffix:semicolon
id|oldfs
op_assign
id|get_fs
c_func
(paren
)paren
suffix:semicolon
id|set_fs
c_func
(paren
id|KERNEL_DS
)paren
suffix:semicolon
id|err
op_assign
id|dev
op_member_access_from_pointer
id|do_ioctl
c_func
(paren
id|dev
comma
op_amp
id|ifr
comma
id|SIOCADDTUNNEL
)paren
suffix:semicolon
id|set_fs
c_func
(paren
id|oldfs
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
op_eq
l_int|0
)paren
(brace
id|err
op_assign
op_minus
id|ENOBUFS
suffix:semicolon
r_if
c_cond
(paren
(paren
id|dev
op_assign
id|__dev_get_by_name
c_func
(paren
id|p.name
)paren
)paren
op_eq
l_int|NULL
)paren
r_goto
id|err_exit
suffix:semicolon
id|err
op_assign
id|dev_open
c_func
(paren
id|dev
)paren
suffix:semicolon
)brace
)brace
id|err_exit
suffix:colon
id|rtnl_unlock
c_func
(paren
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
multiline_comment|/*&n; *&t;Manual configuration of address on an interface&n; */
DECL|function|inet6_addr_add
r_static
r_int
id|inet6_addr_add
c_func
(paren
r_int
id|ifindex
comma
r_struct
id|in6_addr
op_star
id|pfx
comma
r_int
id|plen
)paren
(brace
r_struct
id|inet6_ifaddr
op_star
id|ifp
suffix:semicolon
r_struct
id|inet6_dev
op_star
id|idev
suffix:semicolon
r_struct
id|net_device
op_star
id|dev
suffix:semicolon
r_int
id|scope
suffix:semicolon
id|ASSERT_RTNL
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|dev
op_assign
id|__dev_get_by_index
c_func
(paren
id|ifindex
)paren
)paren
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENODEV
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|dev-&gt;flags
op_amp
id|IFF_UP
)paren
)paren
r_return
op_minus
id|ENETDOWN
suffix:semicolon
r_if
c_cond
(paren
(paren
id|idev
op_assign
id|addrconf_add_dev
c_func
(paren
id|dev
)paren
)paren
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOBUFS
suffix:semicolon
id|scope
op_assign
id|ipv6_addr_scope
c_func
(paren
id|pfx
)paren
suffix:semicolon
id|ifp
op_assign
id|ipv6_add_addr
c_func
(paren
id|idev
comma
id|pfx
comma
id|plen
comma
id|scope
comma
id|IFA_F_PERMANENT
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|IS_ERR
c_func
(paren
id|ifp
)paren
)paren
(brace
id|addrconf_dad_start
c_func
(paren
id|ifp
comma
l_int|0
)paren
suffix:semicolon
id|in6_ifa_put
c_func
(paren
id|ifp
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_return
id|PTR_ERR
c_func
(paren
id|ifp
)paren
suffix:semicolon
)brace
DECL|function|inet6_addr_del
r_static
r_int
id|inet6_addr_del
c_func
(paren
r_int
id|ifindex
comma
r_struct
id|in6_addr
op_star
id|pfx
comma
r_int
id|plen
)paren
(brace
r_struct
id|inet6_ifaddr
op_star
id|ifp
suffix:semicolon
r_struct
id|inet6_dev
op_star
id|idev
suffix:semicolon
r_struct
id|net_device
op_star
id|dev
suffix:semicolon
r_if
c_cond
(paren
(paren
id|dev
op_assign
id|__dev_get_by_index
c_func
(paren
id|ifindex
)paren
)paren
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENODEV
suffix:semicolon
r_if
c_cond
(paren
(paren
id|idev
op_assign
id|__in6_dev_get
c_func
(paren
id|dev
)paren
)paren
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENXIO
suffix:semicolon
id|read_lock_bh
c_func
(paren
op_amp
id|idev-&gt;lock
)paren
suffix:semicolon
r_for
c_loop
(paren
id|ifp
op_assign
id|idev-&gt;addr_list
suffix:semicolon
id|ifp
suffix:semicolon
id|ifp
op_assign
id|ifp-&gt;if_next
)paren
(brace
r_if
c_cond
(paren
id|ifp-&gt;prefix_len
op_eq
id|plen
op_logical_and
(paren
op_logical_neg
id|memcmp
c_func
(paren
id|pfx
comma
op_amp
id|ifp-&gt;addr
comma
r_sizeof
(paren
r_struct
id|in6_addr
)paren
)paren
)paren
)paren
(brace
id|in6_ifa_hold
c_func
(paren
id|ifp
)paren
suffix:semicolon
id|read_unlock_bh
c_func
(paren
op_amp
id|idev-&gt;lock
)paren
suffix:semicolon
id|ipv6_del_addr
c_func
(paren
id|ifp
)paren
suffix:semicolon
multiline_comment|/* If the last address is deleted administratively,&n;&t;&t;&t;   disable IPv6 on this interface.&n;&t;&t;&t; */
r_if
c_cond
(paren
id|idev-&gt;addr_list
op_eq
l_int|NULL
)paren
id|addrconf_ifdown
c_func
(paren
id|idev-&gt;dev
comma
l_int|1
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
)brace
id|read_unlock_bh
c_func
(paren
op_amp
id|idev-&gt;lock
)paren
suffix:semicolon
r_return
op_minus
id|EADDRNOTAVAIL
suffix:semicolon
)brace
DECL|function|addrconf_add_ifaddr
r_int
id|addrconf_add_ifaddr
c_func
(paren
r_void
op_star
id|arg
)paren
(brace
r_struct
id|in6_ifreq
id|ireq
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|capable
c_func
(paren
id|CAP_NET_ADMIN
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|ireq
comma
id|arg
comma
r_sizeof
(paren
r_struct
id|in6_ifreq
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|rtnl_lock
c_func
(paren
)paren
suffix:semicolon
id|err
op_assign
id|inet6_addr_add
c_func
(paren
id|ireq.ifr6_ifindex
comma
op_amp
id|ireq.ifr6_addr
comma
id|ireq.ifr6_prefixlen
)paren
suffix:semicolon
id|rtnl_unlock
c_func
(paren
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|function|addrconf_del_ifaddr
r_int
id|addrconf_del_ifaddr
c_func
(paren
r_void
op_star
id|arg
)paren
(brace
r_struct
id|in6_ifreq
id|ireq
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|capable
c_func
(paren
id|CAP_NET_ADMIN
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|ireq
comma
id|arg
comma
r_sizeof
(paren
r_struct
id|in6_ifreq
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|rtnl_lock
c_func
(paren
)paren
suffix:semicolon
id|err
op_assign
id|inet6_addr_del
c_func
(paren
id|ireq.ifr6_ifindex
comma
op_amp
id|ireq.ifr6_addr
comma
id|ireq.ifr6_prefixlen
)paren
suffix:semicolon
id|rtnl_unlock
c_func
(paren
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|function|sit_add_v4_addrs
r_static
r_void
id|sit_add_v4_addrs
c_func
(paren
r_struct
id|inet6_dev
op_star
id|idev
)paren
(brace
r_struct
id|inet6_ifaddr
op_star
id|ifp
suffix:semicolon
r_struct
id|in6_addr
id|addr
suffix:semicolon
r_struct
id|net_device
op_star
id|dev
suffix:semicolon
r_int
id|scope
suffix:semicolon
id|ASSERT_RTNL
c_func
(paren
)paren
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|addr
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|in6_addr
)paren
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|addr.s6_addr32
(braket
l_int|3
)braket
comma
id|idev-&gt;dev-&gt;dev_addr
comma
l_int|4
)paren
suffix:semicolon
r_if
c_cond
(paren
id|idev-&gt;dev-&gt;flags
op_amp
id|IFF_POINTOPOINT
)paren
(brace
id|addr.s6_addr32
(braket
l_int|0
)braket
op_assign
id|htonl
c_func
(paren
l_int|0xfe800000
)paren
suffix:semicolon
id|scope
op_assign
id|IFA_LINK
suffix:semicolon
)brace
r_else
(brace
id|scope
op_assign
id|IPV6_ADDR_COMPATv4
suffix:semicolon
)brace
r_if
c_cond
(paren
id|addr.s6_addr32
(braket
l_int|3
)braket
)paren
(brace
id|ifp
op_assign
id|ipv6_add_addr
c_func
(paren
id|idev
comma
op_amp
id|addr
comma
l_int|128
comma
id|scope
comma
id|IFA_F_PERMANENT
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|IS_ERR
c_func
(paren
id|ifp
)paren
)paren
(brace
id|spin_lock_bh
c_func
(paren
op_amp
id|ifp-&gt;lock
)paren
suffix:semicolon
id|ifp-&gt;flags
op_and_assign
op_complement
id|IFA_F_TENTATIVE
suffix:semicolon
id|spin_unlock_bh
c_func
(paren
op_amp
id|ifp-&gt;lock
)paren
suffix:semicolon
id|ipv6_ifa_notify
c_func
(paren
id|RTM_NEWADDR
comma
id|ifp
)paren
suffix:semicolon
id|in6_ifa_put
c_func
(paren
id|ifp
)paren
suffix:semicolon
)brace
r_return
suffix:semicolon
)brace
r_for
c_loop
(paren
id|dev
op_assign
id|dev_base
suffix:semicolon
id|dev
op_ne
l_int|NULL
suffix:semicolon
id|dev
op_assign
id|dev-&gt;next
)paren
(brace
r_struct
id|in_device
op_star
id|in_dev
op_assign
id|__in_dev_get
c_func
(paren
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|in_dev
op_logical_and
(paren
id|dev-&gt;flags
op_amp
id|IFF_UP
)paren
)paren
(brace
r_struct
id|in_ifaddr
op_star
id|ifa
suffix:semicolon
r_int
id|flag
op_assign
id|scope
suffix:semicolon
r_for
c_loop
(paren
id|ifa
op_assign
id|in_dev-&gt;ifa_list
suffix:semicolon
id|ifa
suffix:semicolon
id|ifa
op_assign
id|ifa-&gt;ifa_next
)paren
(brace
r_int
id|plen
suffix:semicolon
id|addr.s6_addr32
(braket
l_int|3
)braket
op_assign
id|ifa-&gt;ifa_local
suffix:semicolon
r_if
c_cond
(paren
id|ifa-&gt;ifa_scope
op_eq
id|RT_SCOPE_LINK
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|ifa-&gt;ifa_scope
op_ge
id|RT_SCOPE_HOST
)paren
(brace
r_if
c_cond
(paren
id|idev-&gt;dev-&gt;flags
op_amp
id|IFF_POINTOPOINT
)paren
r_continue
suffix:semicolon
id|flag
op_or_assign
id|IFA_HOST
suffix:semicolon
)brace
r_if
c_cond
(paren
id|idev-&gt;dev-&gt;flags
op_amp
id|IFF_POINTOPOINT
)paren
id|plen
op_assign
l_int|64
suffix:semicolon
r_else
id|plen
op_assign
l_int|96
suffix:semicolon
id|ifp
op_assign
id|ipv6_add_addr
c_func
(paren
id|idev
comma
op_amp
id|addr
comma
id|plen
comma
id|flag
comma
id|IFA_F_PERMANENT
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|IS_ERR
c_func
(paren
id|ifp
)paren
)paren
(brace
id|spin_lock_bh
c_func
(paren
op_amp
id|ifp-&gt;lock
)paren
suffix:semicolon
id|ifp-&gt;flags
op_and_assign
op_complement
id|IFA_F_TENTATIVE
suffix:semicolon
id|spin_unlock_bh
c_func
(paren
op_amp
id|ifp-&gt;lock
)paren
suffix:semicolon
id|ipv6_ifa_notify
c_func
(paren
id|RTM_NEWADDR
comma
id|ifp
)paren
suffix:semicolon
id|in6_ifa_put
c_func
(paren
id|ifp
)paren
suffix:semicolon
)brace
)brace
)brace
)brace
)brace
DECL|function|init_loopback
r_static
r_void
id|init_loopback
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|inet6_dev
op_star
id|idev
suffix:semicolon
r_struct
id|inet6_ifaddr
op_star
id|ifp
suffix:semicolon
multiline_comment|/* ::1 */
id|ASSERT_RTNL
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|idev
op_assign
id|ipv6_find_idev
c_func
(paren
id|dev
)paren
)paren
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;init loopback: add_dev failed&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|ifp
op_assign
id|ipv6_add_addr
c_func
(paren
id|idev
comma
op_amp
id|in6addr_loopback
comma
l_int|128
comma
id|IFA_HOST
comma
id|IFA_F_PERMANENT
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|IS_ERR
c_func
(paren
id|ifp
)paren
)paren
(brace
id|spin_lock_bh
c_func
(paren
op_amp
id|ifp-&gt;lock
)paren
suffix:semicolon
id|ifp-&gt;flags
op_and_assign
op_complement
id|IFA_F_TENTATIVE
suffix:semicolon
id|spin_unlock_bh
c_func
(paren
op_amp
id|ifp-&gt;lock
)paren
suffix:semicolon
id|ipv6_ifa_notify
c_func
(paren
id|RTM_NEWADDR
comma
id|ifp
)paren
suffix:semicolon
id|in6_ifa_put
c_func
(paren
id|ifp
)paren
suffix:semicolon
)brace
)brace
DECL|function|addrconf_add_linklocal
r_static
r_void
id|addrconf_add_linklocal
c_func
(paren
r_struct
id|inet6_dev
op_star
id|idev
comma
r_struct
id|in6_addr
op_star
id|addr
)paren
(brace
r_struct
id|inet6_ifaddr
op_star
id|ifp
suffix:semicolon
id|ifp
op_assign
id|ipv6_add_addr
c_func
(paren
id|idev
comma
id|addr
comma
l_int|64
comma
id|IFA_LINK
comma
id|IFA_F_PERMANENT
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|IS_ERR
c_func
(paren
id|ifp
)paren
)paren
(brace
id|addrconf_dad_start
c_func
(paren
id|ifp
comma
l_int|0
)paren
suffix:semicolon
id|in6_ifa_put
c_func
(paren
id|ifp
)paren
suffix:semicolon
)brace
)brace
DECL|function|addrconf_dev_config
r_static
r_void
id|addrconf_dev_config
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|in6_addr
id|addr
suffix:semicolon
r_struct
id|inet6_dev
op_star
id|idev
suffix:semicolon
id|ASSERT_RTNL
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|dev-&gt;type
op_ne
id|ARPHRD_ETHER
)paren
op_logical_and
(paren
id|dev-&gt;type
op_ne
id|ARPHRD_FDDI
)paren
op_logical_and
(paren
id|dev-&gt;type
op_ne
id|ARPHRD_IEEE802_TR
)paren
op_logical_and
(paren
id|dev-&gt;type
op_ne
id|ARPHRD_ARCNET
)paren
)paren
(brace
multiline_comment|/* Alas, we support only Ethernet autoconfiguration. */
r_return
suffix:semicolon
)brace
id|idev
op_assign
id|addrconf_add_dev
c_func
(paren
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|idev
op_eq
l_int|NULL
)paren
r_return
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|addr
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|in6_addr
)paren
)paren
suffix:semicolon
id|addr.s6_addr32
(braket
l_int|0
)braket
op_assign
id|htonl
c_func
(paren
l_int|0xFE800000
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ipv6_generate_eui64
c_func
(paren
id|addr.s6_addr
op_plus
l_int|8
comma
id|dev
)paren
op_eq
l_int|0
)paren
id|addrconf_add_linklocal
c_func
(paren
id|idev
comma
op_amp
id|addr
)paren
suffix:semicolon
)brace
DECL|function|addrconf_sit_config
r_static
r_void
id|addrconf_sit_config
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|inet6_dev
op_star
id|idev
suffix:semicolon
id|ASSERT_RTNL
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/* &n;&t; * Configure the tunnel with one of our IPv4 &n;&t; * addresses... we should configure all of &n;&t; * our v4 addrs in the tunnel&n;&t; */
r_if
c_cond
(paren
(paren
id|idev
op_assign
id|ipv6_find_idev
c_func
(paren
id|dev
)paren
)paren
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;init sit: add_dev failed&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|sit_add_v4_addrs
c_func
(paren
id|idev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dev-&gt;flags
op_amp
id|IFF_POINTOPOINT
)paren
(brace
id|addrconf_add_mroute
c_func
(paren
id|dev
)paren
suffix:semicolon
id|addrconf_add_lroute
c_func
(paren
id|dev
)paren
suffix:semicolon
)brace
r_else
id|sit_route_add
c_func
(paren
id|dev
)paren
suffix:semicolon
)brace
r_static
r_inline
r_int
DECL|function|ipv6_inherit_linklocal
id|ipv6_inherit_linklocal
c_func
(paren
r_struct
id|inet6_dev
op_star
id|idev
comma
r_struct
id|net_device
op_star
id|link_dev
)paren
(brace
r_struct
id|in6_addr
id|lladdr
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ipv6_get_lladdr
c_func
(paren
id|link_dev
comma
op_amp
id|lladdr
)paren
)paren
(brace
id|addrconf_add_linklocal
c_func
(paren
id|idev
comma
op_amp
id|lladdr
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_return
op_minus
l_int|1
suffix:semicolon
)brace
DECL|function|ip6_tnl_add_linklocal
r_static
r_void
id|ip6_tnl_add_linklocal
c_func
(paren
r_struct
id|inet6_dev
op_star
id|idev
)paren
(brace
r_struct
id|net_device
op_star
id|link_dev
suffix:semicolon
multiline_comment|/* first try to inherit the link-local address from the link device */
r_if
c_cond
(paren
id|idev-&gt;dev-&gt;iflink
op_logical_and
(paren
id|link_dev
op_assign
id|__dev_get_by_index
c_func
(paren
id|idev-&gt;dev-&gt;iflink
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|ipv6_inherit_linklocal
c_func
(paren
id|idev
comma
id|link_dev
)paren
)paren
r_return
suffix:semicolon
)brace
multiline_comment|/* then try to inherit it from any device */
r_for
c_loop
(paren
id|link_dev
op_assign
id|dev_base
suffix:semicolon
id|link_dev
suffix:semicolon
id|link_dev
op_assign
id|link_dev-&gt;next
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|ipv6_inherit_linklocal
c_func
(paren
id|idev
comma
id|link_dev
)paren
)paren
r_return
suffix:semicolon
)brace
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;init ip6-ip6: add_linklocal failed&bslash;n&quot;
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Autoconfigure tunnel with a link-local address so routing protocols,&n; * DHCPv6, MLD etc. can be run over the virtual link&n; */
DECL|function|addrconf_ip6_tnl_config
r_static
r_void
id|addrconf_ip6_tnl_config
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|inet6_dev
op_star
id|idev
suffix:semicolon
id|ASSERT_RTNL
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|idev
op_assign
id|addrconf_add_dev
c_func
(paren
id|dev
)paren
)paren
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;init ip6-ip6: add_dev failed&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|ip6_tnl_add_linklocal
c_func
(paren
id|idev
)paren
suffix:semicolon
id|addrconf_add_mroute
c_func
(paren
id|dev
)paren
suffix:semicolon
)brace
DECL|function|addrconf_notify
r_static
r_int
id|addrconf_notify
c_func
(paren
r_struct
id|notifier_block
op_star
id|this
comma
r_int
r_int
id|event
comma
r_void
op_star
id|data
)paren
(brace
r_struct
id|net_device
op_star
id|dev
op_assign
(paren
r_struct
id|net_device
op_star
)paren
id|data
suffix:semicolon
r_struct
id|inet6_dev
op_star
id|idev
op_assign
id|__in6_dev_get
c_func
(paren
id|dev
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|event
)paren
(brace
r_case
id|NETDEV_UP
suffix:colon
r_switch
c_cond
(paren
id|dev-&gt;type
)paren
(brace
r_case
id|ARPHRD_SIT
suffix:colon
id|addrconf_sit_config
c_func
(paren
id|dev
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ARPHRD_TUNNEL6
suffix:colon
id|addrconf_ip6_tnl_config
c_func
(paren
id|dev
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ARPHRD_LOOPBACK
suffix:colon
id|init_loopback
c_func
(paren
id|dev
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|addrconf_dev_config
c_func
(paren
id|dev
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
suffix:semicolon
r_if
c_cond
(paren
id|idev
)paren
(brace
multiline_comment|/* If the MTU changed during the interface down, when the&n;&t;&t;&t;   interface up, the changed MTU must be reflected in the&n;&t;&t;&t;   idev as well as routers.&n;&t;&t;&t; */
r_if
c_cond
(paren
id|idev-&gt;cnf.mtu6
op_ne
id|dev-&gt;mtu
op_logical_and
id|dev-&gt;mtu
op_ge
id|IPV6_MIN_MTU
)paren
(brace
id|rt6_mtu_change
c_func
(paren
id|dev
comma
id|dev-&gt;mtu
)paren
suffix:semicolon
id|idev-&gt;cnf.mtu6
op_assign
id|dev-&gt;mtu
suffix:semicolon
)brace
id|idev-&gt;tstamp
op_assign
id|jiffies
suffix:semicolon
id|inet6_ifinfo_notify
c_func
(paren
id|RTM_NEWLINK
comma
id|idev
)paren
suffix:semicolon
multiline_comment|/* If the changed mtu during down is lower than IPV6_MIN_MTU&n;&t;&t;&t;   stop IPv6 on this interface.&n;&t;&t;&t; */
r_if
c_cond
(paren
id|dev-&gt;mtu
OL
id|IPV6_MIN_MTU
)paren
id|addrconf_ifdown
c_func
(paren
id|dev
comma
id|event
op_ne
id|NETDEV_DOWN
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|NETDEV_CHANGEMTU
suffix:colon
r_if
c_cond
(paren
id|idev
op_logical_and
id|dev-&gt;mtu
op_ge
id|IPV6_MIN_MTU
)paren
(brace
id|rt6_mtu_change
c_func
(paren
id|dev
comma
id|dev-&gt;mtu
)paren
suffix:semicolon
id|idev-&gt;cnf.mtu6
op_assign
id|dev-&gt;mtu
suffix:semicolon
r_break
suffix:semicolon
)brace
multiline_comment|/* MTU falled under IPV6_MIN_MTU. Stop IPv6 on this interface. */
r_case
id|NETDEV_DOWN
suffix:colon
r_case
id|NETDEV_UNREGISTER
suffix:colon
multiline_comment|/*&n;&t;&t; *&t;Remove all addresses from this interface.&n;&t;&t; */
id|addrconf_ifdown
c_func
(paren
id|dev
comma
id|event
op_ne
id|NETDEV_DOWN
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|NETDEV_CHANGE
suffix:colon
r_break
suffix:semicolon
r_case
id|NETDEV_CHANGENAME
suffix:colon
macro_line|#ifdef CONFIG_SYSCTL
r_if
c_cond
(paren
id|idev
)paren
(brace
id|addrconf_sysctl_unregister
c_func
(paren
op_amp
id|idev-&gt;cnf
)paren
suffix:semicolon
id|neigh_sysctl_unregister
c_func
(paren
id|idev-&gt;nd_parms
)paren
suffix:semicolon
id|neigh_sysctl_register
c_func
(paren
id|dev
comma
id|idev-&gt;nd_parms
comma
id|NET_IPV6
comma
id|NET_IPV6_NEIGH
comma
l_string|&quot;ipv6&quot;
comma
op_amp
id|ndisc_ifinfo_sysctl_change
)paren
suffix:semicolon
id|addrconf_sysctl_register
c_func
(paren
id|idev
comma
op_amp
id|idev-&gt;cnf
)paren
suffix:semicolon
)brace
macro_line|#endif
r_break
suffix:semicolon
)brace
suffix:semicolon
r_return
id|NOTIFY_OK
suffix:semicolon
)brace
multiline_comment|/*&n; *&t;addrconf module should be notified of a device going up&n; */
DECL|variable|ipv6_dev_notf
r_static
r_struct
id|notifier_block
id|ipv6_dev_notf
op_assign
(brace
dot
id|notifier_call
op_assign
id|addrconf_notify
comma
dot
id|priority
op_assign
l_int|0
)brace
suffix:semicolon
DECL|function|addrconf_ifdown
r_static
r_int
id|addrconf_ifdown
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_int
id|how
)paren
(brace
r_struct
id|inet6_dev
op_star
id|idev
suffix:semicolon
r_struct
id|inet6_ifaddr
op_star
id|ifa
comma
op_star
op_star
id|bifa
suffix:semicolon
r_int
id|i
suffix:semicolon
id|ASSERT_RTNL
c_func
(paren
)paren
suffix:semicolon
id|rt6_ifdown
c_func
(paren
id|dev
)paren
suffix:semicolon
id|neigh_ifdown
c_func
(paren
op_amp
id|nd_tbl
comma
id|dev
)paren
suffix:semicolon
id|idev
op_assign
id|__in6_dev_get
c_func
(paren
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|idev
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENODEV
suffix:semicolon
multiline_comment|/* Step 1: remove reference to ipv6 device from parent device.&n;&t;           Do not dev_put!&n;&t; */
r_if
c_cond
(paren
id|how
op_eq
l_int|1
)paren
(brace
id|write_lock_bh
c_func
(paren
op_amp
id|addrconf_lock
)paren
suffix:semicolon
id|dev-&gt;ip6_ptr
op_assign
l_int|NULL
suffix:semicolon
id|idev-&gt;dead
op_assign
l_int|1
suffix:semicolon
id|write_unlock_bh
c_func
(paren
op_amp
id|addrconf_lock
)paren
suffix:semicolon
)brace
multiline_comment|/* Step 2: clear hash table */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|IN6_ADDR_HSIZE
suffix:semicolon
id|i
op_increment
)paren
(brace
id|bifa
op_assign
op_amp
id|inet6_addr_lst
(braket
id|i
)braket
suffix:semicolon
id|write_lock_bh
c_func
(paren
op_amp
id|addrconf_hash_lock
)paren
suffix:semicolon
r_while
c_loop
(paren
(paren
id|ifa
op_assign
op_star
id|bifa
)paren
op_ne
l_int|NULL
)paren
(brace
r_if
c_cond
(paren
id|ifa-&gt;idev
op_eq
id|idev
)paren
(brace
op_star
id|bifa
op_assign
id|ifa-&gt;lst_next
suffix:semicolon
id|ifa-&gt;lst_next
op_assign
l_int|NULL
suffix:semicolon
id|addrconf_del_timer
c_func
(paren
id|ifa
)paren
suffix:semicolon
id|in6_ifa_put
c_func
(paren
id|ifa
)paren
suffix:semicolon
r_continue
suffix:semicolon
)brace
id|bifa
op_assign
op_amp
id|ifa-&gt;lst_next
suffix:semicolon
)brace
id|write_unlock_bh
c_func
(paren
op_amp
id|addrconf_hash_lock
)paren
suffix:semicolon
)brace
id|write_lock_bh
c_func
(paren
op_amp
id|idev-&gt;lock
)paren
suffix:semicolon
multiline_comment|/* Step 3: clear flags for stateless addrconf */
r_if
c_cond
(paren
id|how
op_ne
l_int|1
)paren
id|idev-&gt;if_flags
op_and_assign
op_complement
(paren
id|IF_RS_SENT
op_or
id|IF_RA_RCVD
)paren
suffix:semicolon
multiline_comment|/* Step 4: clear address list */
macro_line|#ifdef CONFIG_IPV6_PRIVACY
r_if
c_cond
(paren
id|how
op_eq
l_int|1
op_logical_and
id|del_timer
c_func
(paren
op_amp
id|idev-&gt;regen_timer
)paren
)paren
id|in6_dev_put
c_func
(paren
id|idev
)paren
suffix:semicolon
multiline_comment|/* clear tempaddr list */
r_while
c_loop
(paren
(paren
id|ifa
op_assign
id|idev-&gt;tempaddr_list
)paren
op_ne
l_int|NULL
)paren
(brace
id|idev-&gt;tempaddr_list
op_assign
id|ifa-&gt;tmp_next
suffix:semicolon
id|ifa-&gt;tmp_next
op_assign
l_int|NULL
suffix:semicolon
id|ifa-&gt;dead
op_assign
l_int|1
suffix:semicolon
id|write_unlock_bh
c_func
(paren
op_amp
id|idev-&gt;lock
)paren
suffix:semicolon
id|spin_lock_bh
c_func
(paren
op_amp
id|ifa-&gt;lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ifa-&gt;ifpub
)paren
(brace
id|in6_ifa_put
c_func
(paren
id|ifa-&gt;ifpub
)paren
suffix:semicolon
id|ifa-&gt;ifpub
op_assign
l_int|NULL
suffix:semicolon
)brace
id|spin_unlock_bh
c_func
(paren
op_amp
id|ifa-&gt;lock
)paren
suffix:semicolon
id|in6_ifa_put
c_func
(paren
id|ifa
)paren
suffix:semicolon
id|write_lock_bh
c_func
(paren
op_amp
id|idev-&gt;lock
)paren
suffix:semicolon
)brace
macro_line|#endif
r_while
c_loop
(paren
(paren
id|ifa
op_assign
id|idev-&gt;addr_list
)paren
op_ne
l_int|NULL
)paren
(brace
id|idev-&gt;addr_list
op_assign
id|ifa-&gt;if_next
suffix:semicolon
id|ifa-&gt;if_next
op_assign
l_int|NULL
suffix:semicolon
id|ifa-&gt;dead
op_assign
l_int|1
suffix:semicolon
id|addrconf_del_timer
c_func
(paren
id|ifa
)paren
suffix:semicolon
id|write_unlock_bh
c_func
(paren
op_amp
id|idev-&gt;lock
)paren
suffix:semicolon
id|ipv6_ifa_notify
c_func
(paren
id|RTM_DELADDR
comma
id|ifa
)paren
suffix:semicolon
id|in6_ifa_put
c_func
(paren
id|ifa
)paren
suffix:semicolon
id|write_lock_bh
c_func
(paren
op_amp
id|idev-&gt;lock
)paren
suffix:semicolon
)brace
id|write_unlock_bh
c_func
(paren
op_amp
id|idev-&gt;lock
)paren
suffix:semicolon
multiline_comment|/* Step 5: Discard multicast list */
r_if
c_cond
(paren
id|how
op_eq
l_int|1
)paren
id|ipv6_mc_destroy_dev
c_func
(paren
id|idev
)paren
suffix:semicolon
r_else
id|ipv6_mc_down
c_func
(paren
id|idev
)paren
suffix:semicolon
multiline_comment|/* Step 5: netlink notification of this interface */
id|idev-&gt;tstamp
op_assign
id|jiffies
suffix:semicolon
id|inet6_ifinfo_notify
c_func
(paren
id|RTM_NEWLINK
comma
id|idev
)paren
suffix:semicolon
multiline_comment|/* Shot the device (if unregistered) */
r_if
c_cond
(paren
id|how
op_eq
l_int|1
)paren
(brace
macro_line|#ifdef CONFIG_SYSCTL
id|addrconf_sysctl_unregister
c_func
(paren
op_amp
id|idev-&gt;cnf
)paren
suffix:semicolon
id|neigh_sysctl_unregister
c_func
(paren
id|idev-&gt;nd_parms
)paren
suffix:semicolon
macro_line|#endif
id|neigh_parms_release
c_func
(paren
op_amp
id|nd_tbl
comma
id|idev-&gt;nd_parms
)paren
suffix:semicolon
id|in6_dev_put
c_func
(paren
id|idev
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|addrconf_rs_timer
r_static
r_void
id|addrconf_rs_timer
c_func
(paren
r_int
r_int
id|data
)paren
(brace
r_struct
id|inet6_ifaddr
op_star
id|ifp
op_assign
(paren
r_struct
id|inet6_ifaddr
op_star
)paren
id|data
suffix:semicolon
r_if
c_cond
(paren
id|ifp-&gt;idev-&gt;cnf.forwarding
)paren
r_goto
id|out
suffix:semicolon
r_if
c_cond
(paren
id|ifp-&gt;idev-&gt;if_flags
op_amp
id|IF_RA_RCVD
)paren
(brace
multiline_comment|/*&n;&t;&t; *&t;Announcement received after solicitation&n;&t;&t; *&t;was sent&n;&t;&t; */
r_goto
id|out
suffix:semicolon
)brace
id|spin_lock
c_func
(paren
op_amp
id|ifp-&gt;lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ifp-&gt;probes
op_increment
OL
id|ifp-&gt;idev-&gt;cnf.rtr_solicits
)paren
(brace
r_struct
id|in6_addr
id|all_routers
suffix:semicolon
multiline_comment|/* The wait after the last probe can be shorter */
id|addrconf_mod_timer
c_func
(paren
id|ifp
comma
id|AC_RS
comma
(paren
id|ifp-&gt;probes
op_eq
id|ifp-&gt;idev-&gt;cnf.rtr_solicits
)paren
ques
c_cond
id|ifp-&gt;idev-&gt;cnf.rtr_solicit_delay
suffix:colon
id|ifp-&gt;idev-&gt;cnf.rtr_solicit_interval
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|ifp-&gt;lock
)paren
suffix:semicolon
id|ipv6_addr_all_routers
c_func
(paren
op_amp
id|all_routers
)paren
suffix:semicolon
id|ndisc_send_rs
c_func
(paren
id|ifp-&gt;idev-&gt;dev
comma
op_amp
id|ifp-&gt;addr
comma
op_amp
id|all_routers
)paren
suffix:semicolon
)brace
r_else
(brace
r_struct
id|in6_rtmsg
id|rtmsg
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|ifp-&gt;lock
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;%s: no IPv6 routers present&bslash;n&quot;
comma
id|ifp-&gt;idev-&gt;dev-&gt;name
)paren
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|rtmsg
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|in6_rtmsg
)paren
)paren
suffix:semicolon
id|rtmsg.rtmsg_type
op_assign
id|RTMSG_NEWROUTE
suffix:semicolon
id|rtmsg.rtmsg_metric
op_assign
id|IP6_RT_PRIO_ADDRCONF
suffix:semicolon
id|rtmsg.rtmsg_flags
op_assign
(paren
id|RTF_ALLONLINK
op_or
id|RTF_DEFAULT
op_or
id|RTF_UP
)paren
suffix:semicolon
id|rtmsg.rtmsg_ifindex
op_assign
id|ifp-&gt;idev-&gt;dev-&gt;ifindex
suffix:semicolon
id|ip6_route_add
c_func
(paren
op_amp
id|rtmsg
comma
l_int|NULL
comma
l_int|NULL
)paren
suffix:semicolon
)brace
id|out
suffix:colon
id|in6_ifa_put
c_func
(paren
id|ifp
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; *&t;Duplicate Address Detection&n; */
DECL|function|addrconf_dad_start
r_static
r_void
id|addrconf_dad_start
c_func
(paren
r_struct
id|inet6_ifaddr
op_star
id|ifp
comma
r_int
id|flags
)paren
(brace
r_struct
id|net_device
op_star
id|dev
suffix:semicolon
r_int
r_int
id|rand_num
suffix:semicolon
id|dev
op_assign
id|ifp-&gt;idev-&gt;dev
suffix:semicolon
id|addrconf_join_solict
c_func
(paren
id|dev
comma
op_amp
id|ifp-&gt;addr
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ifp-&gt;prefix_len
op_ne
l_int|128
op_logical_and
(paren
id|ifp-&gt;flags
op_amp
id|IFA_F_PERMANENT
)paren
)paren
id|addrconf_prefix_route
c_func
(paren
op_amp
id|ifp-&gt;addr
comma
id|ifp-&gt;prefix_len
comma
id|dev
comma
l_int|0
comma
id|flags
)paren
suffix:semicolon
id|net_srandom
c_func
(paren
id|ifp-&gt;addr.s6_addr32
(braket
l_int|3
)braket
)paren
suffix:semicolon
id|rand_num
op_assign
id|net_random
c_func
(paren
)paren
op_mod
(paren
id|ifp-&gt;idev-&gt;cnf.rtr_solicit_delay
ques
c_cond
suffix:colon
l_int|1
)paren
suffix:semicolon
id|spin_lock_bh
c_func
(paren
op_amp
id|ifp-&gt;lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dev-&gt;flags
op_amp
(paren
id|IFF_NOARP
op_or
id|IFF_LOOPBACK
)paren
op_logical_or
op_logical_neg
(paren
id|ifp-&gt;flags
op_amp
id|IFA_F_TENTATIVE
)paren
)paren
(brace
id|ifp-&gt;flags
op_and_assign
op_complement
id|IFA_F_TENTATIVE
suffix:semicolon
id|spin_unlock_bh
c_func
(paren
op_amp
id|ifp-&gt;lock
)paren
suffix:semicolon
id|addrconf_dad_completed
c_func
(paren
id|ifp
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|ifp-&gt;probes
op_assign
id|ifp-&gt;idev-&gt;cnf.dad_transmits
suffix:semicolon
id|addrconf_mod_timer
c_func
(paren
id|ifp
comma
id|AC_DAD
comma
id|rand_num
)paren
suffix:semicolon
id|spin_unlock_bh
c_func
(paren
op_amp
id|ifp-&gt;lock
)paren
suffix:semicolon
)brace
DECL|function|addrconf_dad_timer
r_static
r_void
id|addrconf_dad_timer
c_func
(paren
r_int
r_int
id|data
)paren
(brace
r_struct
id|inet6_ifaddr
op_star
id|ifp
op_assign
(paren
r_struct
id|inet6_ifaddr
op_star
)paren
id|data
suffix:semicolon
r_struct
id|in6_addr
id|unspec
suffix:semicolon
r_struct
id|in6_addr
id|mcaddr
suffix:semicolon
id|spin_lock_bh
c_func
(paren
op_amp
id|ifp-&gt;lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ifp-&gt;probes
op_eq
l_int|0
)paren
(brace
multiline_comment|/*&n;&t;&t; * DAD was successful&n;&t;&t; */
id|ifp-&gt;flags
op_and_assign
op_complement
id|IFA_F_TENTATIVE
suffix:semicolon
id|spin_unlock_bh
c_func
(paren
op_amp
id|ifp-&gt;lock
)paren
suffix:semicolon
id|addrconf_dad_completed
c_func
(paren
id|ifp
)paren
suffix:semicolon
id|in6_ifa_put
c_func
(paren
id|ifp
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|ifp-&gt;probes
op_decrement
suffix:semicolon
id|addrconf_mod_timer
c_func
(paren
id|ifp
comma
id|AC_DAD
comma
id|ifp-&gt;idev-&gt;nd_parms-&gt;retrans_time
)paren
suffix:semicolon
id|spin_unlock_bh
c_func
(paren
op_amp
id|ifp-&gt;lock
)paren
suffix:semicolon
multiline_comment|/* send a neighbour solicitation for our addr */
id|memset
c_func
(paren
op_amp
id|unspec
comma
l_int|0
comma
r_sizeof
(paren
id|unspec
)paren
)paren
suffix:semicolon
id|addrconf_addr_solict_mult
c_func
(paren
op_amp
id|ifp-&gt;addr
comma
op_amp
id|mcaddr
)paren
suffix:semicolon
id|ndisc_send_ns
c_func
(paren
id|ifp-&gt;idev-&gt;dev
comma
l_int|NULL
comma
op_amp
id|ifp-&gt;addr
comma
op_amp
id|mcaddr
comma
op_amp
id|unspec
)paren
suffix:semicolon
id|in6_ifa_put
c_func
(paren
id|ifp
)paren
suffix:semicolon
)brace
DECL|function|addrconf_dad_completed
r_static
r_void
id|addrconf_dad_completed
c_func
(paren
r_struct
id|inet6_ifaddr
op_star
id|ifp
)paren
(brace
r_struct
id|net_device
op_star
id|dev
op_assign
id|ifp-&gt;idev-&gt;dev
suffix:semicolon
multiline_comment|/*&n;&t; *&t;Configure the address for reception. Now it is valid.&n;&t; */
id|ipv6_ifa_notify
c_func
(paren
id|RTM_NEWADDR
comma
id|ifp
)paren
suffix:semicolon
multiline_comment|/* If added prefix is link local and forwarding is off,&n;&t;   start sending router solicitations.&n;&t; */
r_if
c_cond
(paren
id|ifp-&gt;idev-&gt;cnf.forwarding
op_eq
l_int|0
op_logical_and
id|ifp-&gt;idev-&gt;cnf.rtr_solicits
OG
l_int|0
op_logical_and
(paren
id|dev-&gt;flags
op_amp
id|IFF_LOOPBACK
)paren
op_eq
l_int|0
op_logical_and
(paren
id|ipv6_addr_type
c_func
(paren
op_amp
id|ifp-&gt;addr
)paren
op_amp
id|IPV6_ADDR_LINKLOCAL
)paren
)paren
(brace
r_struct
id|in6_addr
id|all_routers
suffix:semicolon
id|ipv6_addr_all_routers
c_func
(paren
op_amp
id|all_routers
)paren
suffix:semicolon
multiline_comment|/*&n;&t;&t; *&t;If a host as already performed a random delay&n;&t;&t; *&t;[...] as part of DAD [...] there is no need&n;&t;&t; *&t;to delay again before sending the first RS&n;&t;&t; */
id|ndisc_send_rs
c_func
(paren
id|ifp-&gt;idev-&gt;dev
comma
op_amp
id|ifp-&gt;addr
comma
op_amp
id|all_routers
)paren
suffix:semicolon
id|spin_lock_bh
c_func
(paren
op_amp
id|ifp-&gt;lock
)paren
suffix:semicolon
id|ifp-&gt;probes
op_assign
l_int|1
suffix:semicolon
id|ifp-&gt;idev-&gt;if_flags
op_or_assign
id|IF_RS_SENT
suffix:semicolon
id|addrconf_mod_timer
c_func
(paren
id|ifp
comma
id|AC_RS
comma
id|ifp-&gt;idev-&gt;cnf.rtr_solicit_interval
)paren
suffix:semicolon
id|spin_unlock_bh
c_func
(paren
op_amp
id|ifp-&gt;lock
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ifp-&gt;idev-&gt;cnf.forwarding
)paren
(brace
r_struct
id|in6_addr
id|addr
suffix:semicolon
id|ipv6_addr_prefix
c_func
(paren
op_amp
id|addr
comma
op_amp
id|ifp-&gt;addr
comma
id|ifp-&gt;prefix_len
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ipv6_addr_any
c_func
(paren
op_amp
id|addr
)paren
)paren
id|ipv6_dev_ac_inc
c_func
(paren
id|ifp-&gt;idev-&gt;dev
comma
op_amp
id|addr
)paren
suffix:semicolon
)brace
)brace
macro_line|#ifdef CONFIG_PROC_FS
DECL|struct|if6_iter_state
r_struct
id|if6_iter_state
(brace
DECL|member|bucket
r_int
id|bucket
suffix:semicolon
)brace
suffix:semicolon
DECL|function|if6_get_first
r_static
r_struct
id|inet6_ifaddr
op_star
id|if6_get_first
c_func
(paren
r_struct
id|seq_file
op_star
id|seq
)paren
(brace
r_struct
id|inet6_ifaddr
op_star
id|ifa
op_assign
l_int|NULL
suffix:semicolon
r_struct
id|if6_iter_state
op_star
id|state
op_assign
id|seq
op_member_access_from_pointer
r_private
suffix:semicolon
r_for
c_loop
(paren
id|state-&gt;bucket
op_assign
l_int|0
suffix:semicolon
id|state-&gt;bucket
OL
id|IN6_ADDR_HSIZE
suffix:semicolon
op_increment
id|state-&gt;bucket
)paren
(brace
id|ifa
op_assign
id|inet6_addr_lst
(braket
id|state-&gt;bucket
)braket
suffix:semicolon
r_if
c_cond
(paren
id|ifa
)paren
r_break
suffix:semicolon
)brace
r_return
id|ifa
suffix:semicolon
)brace
DECL|function|if6_get_next
r_static
r_struct
id|inet6_ifaddr
op_star
id|if6_get_next
c_func
(paren
r_struct
id|seq_file
op_star
id|seq
comma
r_struct
id|inet6_ifaddr
op_star
id|ifa
)paren
(brace
r_struct
id|if6_iter_state
op_star
id|state
op_assign
id|seq
op_member_access_from_pointer
r_private
suffix:semicolon
id|ifa
op_assign
id|ifa-&gt;lst_next
suffix:semicolon
id|try_again
suffix:colon
r_if
c_cond
(paren
op_logical_neg
id|ifa
op_logical_and
op_increment
id|state-&gt;bucket
OL
id|IN6_ADDR_HSIZE
)paren
(brace
id|ifa
op_assign
id|inet6_addr_lst
(braket
id|state-&gt;bucket
)braket
suffix:semicolon
r_goto
id|try_again
suffix:semicolon
)brace
r_return
id|ifa
suffix:semicolon
)brace
DECL|function|if6_get_idx
r_static
r_struct
id|inet6_ifaddr
op_star
id|if6_get_idx
c_func
(paren
r_struct
id|seq_file
op_star
id|seq
comma
id|loff_t
id|pos
)paren
(brace
r_struct
id|inet6_ifaddr
op_star
id|ifa
op_assign
id|if6_get_first
c_func
(paren
id|seq
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ifa
)paren
r_while
c_loop
(paren
id|pos
op_logical_and
(paren
id|ifa
op_assign
id|if6_get_next
c_func
(paren
id|seq
comma
id|ifa
)paren
)paren
op_ne
l_int|NULL
)paren
(brace
op_decrement
id|pos
suffix:semicolon
)brace
r_return
id|pos
ques
c_cond
l_int|NULL
suffix:colon
id|ifa
suffix:semicolon
)brace
DECL|function|if6_seq_start
r_static
r_void
op_star
id|if6_seq_start
c_func
(paren
r_struct
id|seq_file
op_star
id|seq
comma
id|loff_t
op_star
id|pos
)paren
(brace
id|read_lock_bh
c_func
(paren
op_amp
id|addrconf_hash_lock
)paren
suffix:semicolon
r_return
id|if6_get_idx
c_func
(paren
id|seq
comma
op_star
id|pos
)paren
suffix:semicolon
)brace
DECL|function|if6_seq_next
r_static
r_void
op_star
id|if6_seq_next
c_func
(paren
r_struct
id|seq_file
op_star
id|seq
comma
r_void
op_star
id|v
comma
id|loff_t
op_star
id|pos
)paren
(brace
r_struct
id|inet6_ifaddr
op_star
id|ifa
suffix:semicolon
id|ifa
op_assign
id|if6_get_next
c_func
(paren
id|seq
comma
id|v
)paren
suffix:semicolon
op_increment
op_star
id|pos
suffix:semicolon
r_return
id|ifa
suffix:semicolon
)brace
DECL|function|if6_seq_stop
r_static
r_void
id|if6_seq_stop
c_func
(paren
r_struct
id|seq_file
op_star
id|seq
comma
r_void
op_star
id|v
)paren
(brace
id|read_unlock_bh
c_func
(paren
op_amp
id|addrconf_hash_lock
)paren
suffix:semicolon
)brace
DECL|function|if6_seq_show
r_static
r_int
id|if6_seq_show
c_func
(paren
r_struct
id|seq_file
op_star
id|seq
comma
r_void
op_star
id|v
)paren
(brace
r_struct
id|inet6_ifaddr
op_star
id|ifp
op_assign
(paren
r_struct
id|inet6_ifaddr
op_star
)paren
id|v
suffix:semicolon
id|seq_printf
c_func
(paren
id|seq
comma
l_string|&quot;%04x%04x%04x%04x%04x%04x%04x%04x %02x %02x %02x %02x %8s&bslash;n&quot;
comma
id|NIP6
c_func
(paren
id|ifp-&gt;addr
)paren
comma
id|ifp-&gt;idev-&gt;dev-&gt;ifindex
comma
id|ifp-&gt;prefix_len
comma
id|ifp-&gt;scope
comma
id|ifp-&gt;flags
comma
id|ifp-&gt;idev-&gt;dev-&gt;name
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|if6_seq_ops
r_static
r_struct
id|seq_operations
id|if6_seq_ops
op_assign
(brace
dot
id|start
op_assign
id|if6_seq_start
comma
dot
id|next
op_assign
id|if6_seq_next
comma
dot
id|show
op_assign
id|if6_seq_show
comma
dot
id|stop
op_assign
id|if6_seq_stop
comma
)brace
suffix:semicolon
DECL|function|if6_seq_open
r_static
r_int
id|if6_seq_open
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_struct
id|seq_file
op_star
id|seq
suffix:semicolon
r_int
id|rc
op_assign
op_minus
id|ENOMEM
suffix:semicolon
r_struct
id|if6_iter_state
op_star
id|s
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
op_star
id|s
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|s
)paren
r_goto
id|out
suffix:semicolon
id|memset
c_func
(paren
id|s
comma
l_int|0
comma
r_sizeof
(paren
op_star
id|s
)paren
)paren
suffix:semicolon
id|rc
op_assign
id|seq_open
c_func
(paren
id|file
comma
op_amp
id|if6_seq_ops
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rc
)paren
r_goto
id|out_kfree
suffix:semicolon
id|seq
op_assign
id|file-&gt;private_data
suffix:semicolon
id|seq
op_member_access_from_pointer
r_private
op_assign
id|s
suffix:semicolon
id|out
suffix:colon
r_return
id|rc
suffix:semicolon
id|out_kfree
suffix:colon
id|kfree
c_func
(paren
id|s
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
DECL|variable|if6_fops
r_static
r_struct
id|file_operations
id|if6_fops
op_assign
(brace
dot
id|owner
op_assign
id|THIS_MODULE
comma
dot
id|open
op_assign
id|if6_seq_open
comma
dot
id|read
op_assign
id|seq_read
comma
dot
id|llseek
op_assign
id|seq_lseek
comma
dot
id|release
op_assign
id|seq_release_private
comma
)brace
suffix:semicolon
DECL|function|if6_proc_init
r_int
id|__init
id|if6_proc_init
c_func
(paren
r_void
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|proc_net_fops_create
c_func
(paren
l_string|&quot;if_inet6&quot;
comma
id|S_IRUGO
comma
op_amp
id|if6_fops
)paren
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|if6_proc_exit
r_void
id|if6_proc_exit
c_func
(paren
r_void
)paren
(brace
id|proc_net_remove
c_func
(paren
l_string|&quot;if_inet6&quot;
)paren
suffix:semicolon
)brace
macro_line|#endif&t;/* CONFIG_PROC_FS */
multiline_comment|/*&n; *&t;Periodic address status verification&n; */
DECL|function|addrconf_verify
r_static
r_void
id|addrconf_verify
c_func
(paren
r_int
r_int
id|foo
)paren
(brace
r_struct
id|inet6_ifaddr
op_star
id|ifp
suffix:semicolon
r_int
r_int
id|now
comma
id|next
suffix:semicolon
r_int
id|i
suffix:semicolon
id|spin_lock_bh
c_func
(paren
op_amp
id|addrconf_verify_lock
)paren
suffix:semicolon
id|now
op_assign
id|jiffies
suffix:semicolon
id|next
op_assign
id|now
op_plus
id|ADDR_CHECK_FREQUENCY
suffix:semicolon
id|del_timer
c_func
(paren
op_amp
id|addr_chk_timer
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|IN6_ADDR_HSIZE
suffix:semicolon
id|i
op_increment
)paren
(brace
id|restart
suffix:colon
id|write_lock
c_func
(paren
op_amp
id|addrconf_hash_lock
)paren
suffix:semicolon
r_for
c_loop
(paren
id|ifp
op_assign
id|inet6_addr_lst
(braket
id|i
)braket
suffix:semicolon
id|ifp
suffix:semicolon
id|ifp
op_assign
id|ifp-&gt;lst_next
)paren
(brace
r_int
r_int
id|age
suffix:semicolon
macro_line|#ifdef CONFIG_IPV6_PRIVACY
r_int
r_int
id|regen_advance
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
id|ifp-&gt;flags
op_amp
id|IFA_F_PERMANENT
)paren
r_continue
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|ifp-&gt;lock
)paren
suffix:semicolon
id|age
op_assign
(paren
id|now
op_minus
id|ifp-&gt;tstamp
)paren
op_div
id|HZ
suffix:semicolon
macro_line|#ifdef CONFIG_IPV6_PRIVACY
id|regen_advance
op_assign
id|ifp-&gt;idev-&gt;cnf.regen_max_retry
op_star
id|ifp-&gt;idev-&gt;cnf.dad_transmits
op_star
id|ifp-&gt;idev-&gt;nd_parms-&gt;retrans_time
op_div
id|HZ
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
id|age
op_ge
id|ifp-&gt;valid_lft
)paren
(brace
id|spin_unlock
c_func
(paren
op_amp
id|ifp-&gt;lock
)paren
suffix:semicolon
id|in6_ifa_hold
c_func
(paren
id|ifp
)paren
suffix:semicolon
id|write_unlock
c_func
(paren
op_amp
id|addrconf_hash_lock
)paren
suffix:semicolon
id|ipv6_del_addr
c_func
(paren
id|ifp
)paren
suffix:semicolon
r_goto
id|restart
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|age
op_ge
id|ifp-&gt;prefered_lft
)paren
(brace
multiline_comment|/* jiffies - ifp-&gt;tsamp &gt; age &gt;= ifp-&gt;prefered_lft */
r_int
id|deprecate
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|ifp-&gt;flags
op_amp
id|IFA_F_DEPRECATED
)paren
)paren
(brace
id|deprecate
op_assign
l_int|1
suffix:semicolon
id|ifp-&gt;flags
op_or_assign
id|IFA_F_DEPRECATED
suffix:semicolon
)brace
r_if
c_cond
(paren
id|time_before
c_func
(paren
id|ifp-&gt;tstamp
op_plus
id|ifp-&gt;valid_lft
op_star
id|HZ
comma
id|next
)paren
)paren
id|next
op_assign
id|ifp-&gt;tstamp
op_plus
id|ifp-&gt;valid_lft
op_star
id|HZ
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|ifp-&gt;lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|deprecate
)paren
(brace
id|in6_ifa_hold
c_func
(paren
id|ifp
)paren
suffix:semicolon
id|write_unlock
c_func
(paren
op_amp
id|addrconf_hash_lock
)paren
suffix:semicolon
id|ipv6_ifa_notify
c_func
(paren
l_int|0
comma
id|ifp
)paren
suffix:semicolon
id|in6_ifa_put
c_func
(paren
id|ifp
)paren
suffix:semicolon
r_goto
id|restart
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_IPV6_PRIVACY
)brace
r_else
r_if
c_cond
(paren
(paren
id|ifp-&gt;flags
op_amp
id|IFA_F_TEMPORARY
)paren
op_logical_and
op_logical_neg
(paren
id|ifp-&gt;flags
op_amp
id|IFA_F_TENTATIVE
)paren
)paren
(brace
r_if
c_cond
(paren
id|age
op_ge
id|ifp-&gt;prefered_lft
op_minus
id|regen_advance
)paren
(brace
r_struct
id|inet6_ifaddr
op_star
id|ifpub
op_assign
id|ifp-&gt;ifpub
suffix:semicolon
r_if
c_cond
(paren
id|time_before
c_func
(paren
id|ifp-&gt;tstamp
op_plus
id|ifp-&gt;prefered_lft
op_star
id|HZ
comma
id|next
)paren
)paren
id|next
op_assign
id|ifp-&gt;tstamp
op_plus
id|ifp-&gt;prefered_lft
op_star
id|HZ
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ifp-&gt;regen_count
op_logical_and
id|ifpub
)paren
(brace
id|ifp-&gt;regen_count
op_increment
suffix:semicolon
id|in6_ifa_hold
c_func
(paren
id|ifp
)paren
suffix:semicolon
id|in6_ifa_hold
c_func
(paren
id|ifpub
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|ifp-&gt;lock
)paren
suffix:semicolon
id|write_unlock
c_func
(paren
op_amp
id|addrconf_hash_lock
)paren
suffix:semicolon
id|ipv6_create_tempaddr
c_func
(paren
id|ifpub
comma
id|ifp
)paren
suffix:semicolon
id|in6_ifa_put
c_func
(paren
id|ifpub
)paren
suffix:semicolon
id|in6_ifa_put
c_func
(paren
id|ifp
)paren
suffix:semicolon
r_goto
id|restart
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|time_before
c_func
(paren
id|ifp-&gt;tstamp
op_plus
id|ifp-&gt;prefered_lft
op_star
id|HZ
op_minus
id|regen_advance
op_star
id|HZ
comma
id|next
)paren
)paren
id|next
op_assign
id|ifp-&gt;tstamp
op_plus
id|ifp-&gt;prefered_lft
op_star
id|HZ
op_minus
id|regen_advance
op_star
id|HZ
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|ifp-&gt;lock
)paren
suffix:semicolon
macro_line|#endif
)brace
r_else
(brace
multiline_comment|/* ifp-&gt;prefered_lft &lt;= ifp-&gt;valid_lft */
r_if
c_cond
(paren
id|time_before
c_func
(paren
id|ifp-&gt;tstamp
op_plus
id|ifp-&gt;prefered_lft
op_star
id|HZ
comma
id|next
)paren
)paren
id|next
op_assign
id|ifp-&gt;tstamp
op_plus
id|ifp-&gt;prefered_lft
op_star
id|HZ
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|ifp-&gt;lock
)paren
suffix:semicolon
)brace
)brace
id|write_unlock
c_func
(paren
op_amp
id|addrconf_hash_lock
)paren
suffix:semicolon
)brace
id|addr_chk_timer.expires
op_assign
id|time_before
c_func
(paren
id|next
comma
id|jiffies
op_plus
id|HZ
)paren
ques
c_cond
id|jiffies
op_plus
id|HZ
suffix:colon
id|next
suffix:semicolon
id|add_timer
c_func
(paren
op_amp
id|addr_chk_timer
)paren
suffix:semicolon
id|spin_unlock_bh
c_func
(paren
op_amp
id|addrconf_verify_lock
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|inet6_rtm_deladdr
id|inet6_rtm_deladdr
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|nlmsghdr
op_star
id|nlh
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|rtattr
op_star
op_star
id|rta
op_assign
id|arg
suffix:semicolon
r_struct
id|ifaddrmsg
op_star
id|ifm
op_assign
id|NLMSG_DATA
c_func
(paren
id|nlh
)paren
suffix:semicolon
r_struct
id|in6_addr
op_star
id|pfx
suffix:semicolon
id|pfx
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
id|rta
(braket
id|IFA_ADDRESS
op_minus
l_int|1
)braket
)paren
(brace
r_if
c_cond
(paren
id|RTA_PAYLOAD
c_func
(paren
id|rta
(braket
id|IFA_ADDRESS
op_minus
l_int|1
)braket
)paren
OL
r_sizeof
(paren
op_star
id|pfx
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|pfx
op_assign
id|RTA_DATA
c_func
(paren
id|rta
(braket
id|IFA_ADDRESS
op_minus
l_int|1
)braket
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|rta
(braket
id|IFA_LOCAL
op_minus
l_int|1
)braket
)paren
(brace
r_if
c_cond
(paren
id|pfx
op_logical_and
id|memcmp
c_func
(paren
id|pfx
comma
id|RTA_DATA
c_func
(paren
id|rta
(braket
id|IFA_LOCAL
op_minus
l_int|1
)braket
)paren
comma
r_sizeof
(paren
op_star
id|pfx
)paren
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|pfx
op_assign
id|RTA_DATA
c_func
(paren
id|rta
(braket
id|IFA_LOCAL
op_minus
l_int|1
)braket
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|pfx
op_eq
l_int|NULL
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|inet6_addr_del
c_func
(paren
id|ifm-&gt;ifa_index
comma
id|pfx
comma
id|ifm-&gt;ifa_prefixlen
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|inet6_rtm_newaddr
id|inet6_rtm_newaddr
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|nlmsghdr
op_star
id|nlh
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|rtattr
op_star
op_star
id|rta
op_assign
id|arg
suffix:semicolon
r_struct
id|ifaddrmsg
op_star
id|ifm
op_assign
id|NLMSG_DATA
c_func
(paren
id|nlh
)paren
suffix:semicolon
r_struct
id|in6_addr
op_star
id|pfx
suffix:semicolon
id|pfx
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
id|rta
(braket
id|IFA_ADDRESS
op_minus
l_int|1
)braket
)paren
(brace
r_if
c_cond
(paren
id|RTA_PAYLOAD
c_func
(paren
id|rta
(braket
id|IFA_ADDRESS
op_minus
l_int|1
)braket
)paren
OL
r_sizeof
(paren
op_star
id|pfx
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|pfx
op_assign
id|RTA_DATA
c_func
(paren
id|rta
(braket
id|IFA_ADDRESS
op_minus
l_int|1
)braket
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|rta
(braket
id|IFA_LOCAL
op_minus
l_int|1
)braket
)paren
(brace
r_if
c_cond
(paren
id|pfx
op_logical_and
id|memcmp
c_func
(paren
id|pfx
comma
id|RTA_DATA
c_func
(paren
id|rta
(braket
id|IFA_LOCAL
op_minus
l_int|1
)braket
)paren
comma
r_sizeof
(paren
op_star
id|pfx
)paren
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|pfx
op_assign
id|RTA_DATA
c_func
(paren
id|rta
(braket
id|IFA_LOCAL
op_minus
l_int|1
)braket
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|pfx
op_eq
l_int|NULL
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|inet6_addr_add
c_func
(paren
id|ifm-&gt;ifa_index
comma
id|pfx
comma
id|ifm-&gt;ifa_prefixlen
)paren
suffix:semicolon
)brace
DECL|function|inet6_fill_ifaddr
r_static
r_int
id|inet6_fill_ifaddr
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|inet6_ifaddr
op_star
id|ifa
comma
id|u32
id|pid
comma
id|u32
id|seq
comma
r_int
id|event
)paren
(brace
r_struct
id|ifaddrmsg
op_star
id|ifm
suffix:semicolon
r_struct
id|nlmsghdr
op_star
id|nlh
suffix:semicolon
r_struct
id|ifa_cacheinfo
id|ci
suffix:semicolon
r_int
r_char
op_star
id|b
op_assign
id|skb-&gt;tail
suffix:semicolon
id|nlh
op_assign
id|NLMSG_PUT
c_func
(paren
id|skb
comma
id|pid
comma
id|seq
comma
id|event
comma
r_sizeof
(paren
op_star
id|ifm
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pid
)paren
id|nlh-&gt;nlmsg_flags
op_or_assign
id|NLM_F_MULTI
suffix:semicolon
id|ifm
op_assign
id|NLMSG_DATA
c_func
(paren
id|nlh
)paren
suffix:semicolon
id|ifm-&gt;ifa_family
op_assign
id|AF_INET6
suffix:semicolon
id|ifm-&gt;ifa_prefixlen
op_assign
id|ifa-&gt;prefix_len
suffix:semicolon
id|ifm-&gt;ifa_flags
op_assign
id|ifa-&gt;flags
suffix:semicolon
id|ifm-&gt;ifa_scope
op_assign
id|RT_SCOPE_UNIVERSE
suffix:semicolon
r_if
c_cond
(paren
id|ifa-&gt;scope
op_amp
id|IFA_HOST
)paren
id|ifm-&gt;ifa_scope
op_assign
id|RT_SCOPE_HOST
suffix:semicolon
r_else
r_if
c_cond
(paren
id|ifa-&gt;scope
op_amp
id|IFA_LINK
)paren
id|ifm-&gt;ifa_scope
op_assign
id|RT_SCOPE_LINK
suffix:semicolon
r_else
r_if
c_cond
(paren
id|ifa-&gt;scope
op_amp
id|IFA_SITE
)paren
id|ifm-&gt;ifa_scope
op_assign
id|RT_SCOPE_SITE
suffix:semicolon
id|ifm-&gt;ifa_index
op_assign
id|ifa-&gt;idev-&gt;dev-&gt;ifindex
suffix:semicolon
id|RTA_PUT
c_func
(paren
id|skb
comma
id|IFA_ADDRESS
comma
l_int|16
comma
op_amp
id|ifa-&gt;addr
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|ifa-&gt;flags
op_amp
id|IFA_F_PERMANENT
)paren
)paren
(brace
id|ci.ifa_prefered
op_assign
id|ifa-&gt;prefered_lft
suffix:semicolon
id|ci.ifa_valid
op_assign
id|ifa-&gt;valid_lft
suffix:semicolon
r_if
c_cond
(paren
id|ci.ifa_prefered
op_ne
id|INFINITY_LIFE_TIME
)paren
(brace
r_int
id|tval
op_assign
(paren
id|jiffies
op_minus
id|ifa-&gt;tstamp
)paren
op_div
id|HZ
suffix:semicolon
id|ci.ifa_prefered
op_sub_assign
id|tval
suffix:semicolon
r_if
c_cond
(paren
id|ci.ifa_valid
op_ne
id|INFINITY_LIFE_TIME
)paren
id|ci.ifa_valid
op_sub_assign
id|tval
suffix:semicolon
)brace
)brace
r_else
(brace
id|ci.ifa_prefered
op_assign
id|INFINITY_LIFE_TIME
suffix:semicolon
id|ci.ifa_valid
op_assign
id|INFINITY_LIFE_TIME
suffix:semicolon
)brace
id|ci.cstamp
op_assign
(paren
id|__u32
)paren
(paren
id|TIME_DELTA
c_func
(paren
id|ifa-&gt;cstamp
comma
id|INITIAL_JIFFIES
)paren
op_div
id|HZ
op_star
l_int|100
op_plus
id|TIME_DELTA
c_func
(paren
id|ifa-&gt;cstamp
comma
id|INITIAL_JIFFIES
)paren
op_mod
id|HZ
op_star
l_int|100
op_div
id|HZ
)paren
suffix:semicolon
id|ci.tstamp
op_assign
(paren
id|__u32
)paren
(paren
id|TIME_DELTA
c_func
(paren
id|ifa-&gt;tstamp
comma
id|INITIAL_JIFFIES
)paren
op_div
id|HZ
op_star
l_int|100
op_plus
id|TIME_DELTA
c_func
(paren
id|ifa-&gt;tstamp
comma
id|INITIAL_JIFFIES
)paren
op_mod
id|HZ
op_star
l_int|100
op_div
id|HZ
)paren
suffix:semicolon
id|RTA_PUT
c_func
(paren
id|skb
comma
id|IFA_CACHEINFO
comma
r_sizeof
(paren
id|ci
)paren
comma
op_amp
id|ci
)paren
suffix:semicolon
id|nlh-&gt;nlmsg_len
op_assign
id|skb-&gt;tail
op_minus
id|b
suffix:semicolon
r_return
id|skb-&gt;len
suffix:semicolon
id|nlmsg_failure
suffix:colon
id|rtattr_failure
suffix:colon
id|skb_trim
c_func
(paren
id|skb
comma
id|b
op_minus
id|skb-&gt;data
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
DECL|function|inet6_fill_ifmcaddr
r_static
r_int
id|inet6_fill_ifmcaddr
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|ifmcaddr6
op_star
id|ifmca
comma
id|u32
id|pid
comma
id|u32
id|seq
comma
r_int
id|event
)paren
(brace
r_struct
id|ifaddrmsg
op_star
id|ifm
suffix:semicolon
r_struct
id|nlmsghdr
op_star
id|nlh
suffix:semicolon
r_struct
id|ifa_cacheinfo
id|ci
suffix:semicolon
r_int
r_char
op_star
id|b
op_assign
id|skb-&gt;tail
suffix:semicolon
id|nlh
op_assign
id|NLMSG_PUT
c_func
(paren
id|skb
comma
id|pid
comma
id|seq
comma
id|event
comma
r_sizeof
(paren
op_star
id|ifm
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pid
)paren
id|nlh-&gt;nlmsg_flags
op_or_assign
id|NLM_F_MULTI
suffix:semicolon
id|ifm
op_assign
id|NLMSG_DATA
c_func
(paren
id|nlh
)paren
suffix:semicolon
id|ifm-&gt;ifa_family
op_assign
id|AF_INET6
suffix:semicolon
id|ifm-&gt;ifa_prefixlen
op_assign
l_int|128
suffix:semicolon
id|ifm-&gt;ifa_flags
op_assign
id|IFA_F_PERMANENT
suffix:semicolon
id|ifm-&gt;ifa_scope
op_assign
id|RT_SCOPE_UNIVERSE
suffix:semicolon
r_if
c_cond
(paren
id|ipv6_addr_scope
c_func
(paren
op_amp
id|ifmca-&gt;mca_addr
)paren
op_amp
id|IFA_SITE
)paren
id|ifm-&gt;ifa_scope
op_assign
id|RT_SCOPE_SITE
suffix:semicolon
id|ifm-&gt;ifa_index
op_assign
id|ifmca-&gt;idev-&gt;dev-&gt;ifindex
suffix:semicolon
id|RTA_PUT
c_func
(paren
id|skb
comma
id|IFA_ADDRESS
comma
l_int|16
comma
op_amp
id|ifmca-&gt;mca_addr
)paren
suffix:semicolon
id|ci.cstamp
op_assign
(paren
id|__u32
)paren
(paren
id|TIME_DELTA
c_func
(paren
id|ifmca-&gt;mca_cstamp
comma
id|INITIAL_JIFFIES
)paren
op_div
id|HZ
op_star
l_int|100
op_plus
id|TIME_DELTA
c_func
(paren
id|ifmca-&gt;mca_cstamp
comma
id|INITIAL_JIFFIES
)paren
op_mod
id|HZ
op_star
l_int|100
op_div
id|HZ
)paren
suffix:semicolon
id|ci.tstamp
op_assign
(paren
id|__u32
)paren
(paren
id|TIME_DELTA
c_func
(paren
id|ifmca-&gt;mca_tstamp
comma
id|INITIAL_JIFFIES
)paren
op_div
id|HZ
op_star
l_int|100
op_plus
id|TIME_DELTA
c_func
(paren
id|ifmca-&gt;mca_tstamp
comma
id|INITIAL_JIFFIES
)paren
op_mod
id|HZ
op_star
l_int|100
op_div
id|HZ
)paren
suffix:semicolon
id|ci.ifa_prefered
op_assign
id|INFINITY_LIFE_TIME
suffix:semicolon
id|ci.ifa_valid
op_assign
id|INFINITY_LIFE_TIME
suffix:semicolon
id|RTA_PUT
c_func
(paren
id|skb
comma
id|IFA_CACHEINFO
comma
r_sizeof
(paren
id|ci
)paren
comma
op_amp
id|ci
)paren
suffix:semicolon
id|nlh-&gt;nlmsg_len
op_assign
id|skb-&gt;tail
op_minus
id|b
suffix:semicolon
r_return
id|skb-&gt;len
suffix:semicolon
id|nlmsg_failure
suffix:colon
id|rtattr_failure
suffix:colon
id|skb_trim
c_func
(paren
id|skb
comma
id|b
op_minus
id|skb-&gt;data
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
DECL|function|inet6_fill_ifacaddr
r_static
r_int
id|inet6_fill_ifacaddr
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|ifacaddr6
op_star
id|ifaca
comma
id|u32
id|pid
comma
id|u32
id|seq
comma
r_int
id|event
)paren
(brace
r_struct
id|ifaddrmsg
op_star
id|ifm
suffix:semicolon
r_struct
id|nlmsghdr
op_star
id|nlh
suffix:semicolon
r_struct
id|ifa_cacheinfo
id|ci
suffix:semicolon
r_int
r_char
op_star
id|b
op_assign
id|skb-&gt;tail
suffix:semicolon
id|nlh
op_assign
id|NLMSG_PUT
c_func
(paren
id|skb
comma
id|pid
comma
id|seq
comma
id|event
comma
r_sizeof
(paren
op_star
id|ifm
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pid
)paren
id|nlh-&gt;nlmsg_flags
op_or_assign
id|NLM_F_MULTI
suffix:semicolon
id|ifm
op_assign
id|NLMSG_DATA
c_func
(paren
id|nlh
)paren
suffix:semicolon
id|ifm-&gt;ifa_family
op_assign
id|AF_INET6
suffix:semicolon
id|ifm-&gt;ifa_prefixlen
op_assign
l_int|128
suffix:semicolon
id|ifm-&gt;ifa_flags
op_assign
id|IFA_F_PERMANENT
suffix:semicolon
id|ifm-&gt;ifa_scope
op_assign
id|RT_SCOPE_UNIVERSE
suffix:semicolon
r_if
c_cond
(paren
id|ipv6_addr_scope
c_func
(paren
op_amp
id|ifaca-&gt;aca_addr
)paren
op_amp
id|IFA_SITE
)paren
id|ifm-&gt;ifa_scope
op_assign
id|RT_SCOPE_SITE
suffix:semicolon
id|ifm-&gt;ifa_index
op_assign
id|ifaca-&gt;aca_idev-&gt;dev-&gt;ifindex
suffix:semicolon
id|RTA_PUT
c_func
(paren
id|skb
comma
id|IFA_ADDRESS
comma
l_int|16
comma
op_amp
id|ifaca-&gt;aca_addr
)paren
suffix:semicolon
id|ci.cstamp
op_assign
(paren
id|__u32
)paren
(paren
id|TIME_DELTA
c_func
(paren
id|ifaca-&gt;aca_cstamp
comma
id|INITIAL_JIFFIES
)paren
op_div
id|HZ
op_star
l_int|100
op_plus
id|TIME_DELTA
c_func
(paren
id|ifaca-&gt;aca_cstamp
comma
id|INITIAL_JIFFIES
)paren
op_mod
id|HZ
op_star
l_int|100
op_div
id|HZ
)paren
suffix:semicolon
id|ci.tstamp
op_assign
(paren
id|__u32
)paren
(paren
id|TIME_DELTA
c_func
(paren
id|ifaca-&gt;aca_tstamp
comma
id|INITIAL_JIFFIES
)paren
op_div
id|HZ
op_star
l_int|100
op_plus
id|TIME_DELTA
c_func
(paren
id|ifaca-&gt;aca_tstamp
comma
id|INITIAL_JIFFIES
)paren
op_mod
id|HZ
op_star
l_int|100
op_div
id|HZ
)paren
suffix:semicolon
id|ci.ifa_prefered
op_assign
id|INFINITY_LIFE_TIME
suffix:semicolon
id|ci.ifa_valid
op_assign
id|INFINITY_LIFE_TIME
suffix:semicolon
id|RTA_PUT
c_func
(paren
id|skb
comma
id|IFA_CACHEINFO
comma
r_sizeof
(paren
id|ci
)paren
comma
op_amp
id|ci
)paren
suffix:semicolon
id|nlh-&gt;nlmsg_len
op_assign
id|skb-&gt;tail
op_minus
id|b
suffix:semicolon
r_return
id|skb-&gt;len
suffix:semicolon
id|nlmsg_failure
suffix:colon
id|rtattr_failure
suffix:colon
id|skb_trim
c_func
(paren
id|skb
comma
id|b
op_minus
id|skb-&gt;data
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
DECL|function|inet6_dump_ifaddr
r_static
r_int
id|inet6_dump_ifaddr
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|netlink_callback
op_star
id|cb
)paren
(brace
r_int
id|idx
comma
id|ip_idx
suffix:semicolon
r_int
id|s_idx
comma
id|s_ip_idx
suffix:semicolon
r_int
id|err
op_assign
l_int|1
suffix:semicolon
r_struct
id|net_device
op_star
id|dev
suffix:semicolon
r_struct
id|inet6_dev
op_star
id|idev
op_assign
l_int|NULL
suffix:semicolon
r_struct
id|inet6_ifaddr
op_star
id|ifa
suffix:semicolon
r_struct
id|ifmcaddr6
op_star
id|ifmca
suffix:semicolon
r_struct
id|ifacaddr6
op_star
id|ifaca
suffix:semicolon
id|s_idx
op_assign
id|cb-&gt;args
(braket
l_int|0
)braket
suffix:semicolon
id|s_ip_idx
op_assign
id|ip_idx
op_assign
id|cb-&gt;args
(braket
l_int|1
)braket
suffix:semicolon
id|read_lock
c_func
(paren
op_amp
id|dev_base_lock
)paren
suffix:semicolon
r_for
c_loop
(paren
id|dev
op_assign
id|dev_base
comma
id|idx
op_assign
l_int|0
suffix:semicolon
id|dev
suffix:semicolon
id|dev
op_assign
id|dev-&gt;next
comma
id|idx
op_increment
)paren
(brace
r_if
c_cond
(paren
id|idx
OL
id|s_idx
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|idx
OG
id|s_idx
)paren
id|s_ip_idx
op_assign
l_int|0
suffix:semicolon
id|ip_idx
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
(paren
id|idev
op_assign
id|in6_dev_get
c_func
(paren
id|dev
)paren
)paren
op_eq
l_int|NULL
)paren
r_continue
suffix:semicolon
id|read_lock_bh
c_func
(paren
op_amp
id|idev-&gt;lock
)paren
suffix:semicolon
multiline_comment|/* unicast address */
r_for
c_loop
(paren
id|ifa
op_assign
id|idev-&gt;addr_list
suffix:semicolon
id|ifa
suffix:semicolon
id|ifa
op_assign
id|ifa-&gt;if_next
comma
id|ip_idx
op_increment
)paren
(brace
r_if
c_cond
(paren
id|ip_idx
OL
id|s_ip_idx
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|inet6_fill_ifaddr
c_func
(paren
id|skb
comma
id|ifa
comma
id|NETLINK_CB
c_func
(paren
id|cb-&gt;skb
)paren
dot
id|pid
comma
id|cb-&gt;nlh-&gt;nlmsg_seq
comma
id|RTM_NEWADDR
)paren
)paren
op_le
l_int|0
)paren
r_goto
id|done
suffix:semicolon
)brace
multiline_comment|/* temp addr */
macro_line|#ifdef CONFIG_IPV6_PRIVACY
r_for
c_loop
(paren
id|ifa
op_assign
id|idev-&gt;tempaddr_list
suffix:semicolon
id|ifa
suffix:semicolon
id|ifa
op_assign
id|ifa-&gt;tmp_next
comma
id|ip_idx
op_increment
)paren
(brace
r_if
c_cond
(paren
id|ip_idx
OL
id|s_ip_idx
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|inet6_fill_ifaddr
c_func
(paren
id|skb
comma
id|ifa
comma
id|NETLINK_CB
c_func
(paren
id|cb-&gt;skb
)paren
dot
id|pid
comma
id|cb-&gt;nlh-&gt;nlmsg_seq
comma
id|RTM_NEWADDR
)paren
)paren
op_le
l_int|0
)paren
r_goto
id|done
suffix:semicolon
)brace
macro_line|#endif
id|read_unlock_bh
c_func
(paren
op_amp
id|idev-&gt;lock
)paren
suffix:semicolon
id|in6_dev_put
c_func
(paren
id|idev
)paren
suffix:semicolon
)brace
id|done
suffix:colon
r_if
c_cond
(paren
id|err
op_le
l_int|0
)paren
(brace
id|read_unlock_bh
c_func
(paren
op_amp
id|idev-&gt;lock
)paren
suffix:semicolon
id|in6_dev_put
c_func
(paren
id|idev
)paren
suffix:semicolon
)brace
id|read_unlock
c_func
(paren
op_amp
id|dev_base_lock
)paren
suffix:semicolon
id|cb-&gt;args
(braket
l_int|0
)braket
op_assign
id|idx
suffix:semicolon
id|cb-&gt;args
(braket
l_int|1
)braket
op_assign
id|ip_idx
suffix:semicolon
r_return
id|skb-&gt;len
suffix:semicolon
)brace
DECL|function|inet6_ifa_notify
r_static
r_void
id|inet6_ifa_notify
c_func
(paren
r_int
id|event
comma
r_struct
id|inet6_ifaddr
op_star
id|ifa
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
r_int
id|size
op_assign
id|NLMSG_SPACE
c_func
(paren
r_sizeof
(paren
r_struct
id|ifaddrmsg
)paren
op_plus
l_int|128
)paren
suffix:semicolon
id|skb
op_assign
id|alloc_skb
c_func
(paren
id|size
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|skb
)paren
(brace
id|netlink_set_err
c_func
(paren
id|rtnl
comma
l_int|0
comma
id|RTMGRP_IPV6_IFADDR
comma
id|ENOBUFS
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|inet6_fill_ifaddr
c_func
(paren
id|skb
comma
id|ifa
comma
l_int|0
comma
l_int|0
comma
id|event
)paren
OL
l_int|0
)paren
(brace
id|kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
id|netlink_set_err
c_func
(paren
id|rtnl
comma
l_int|0
comma
id|RTMGRP_IPV6_IFADDR
comma
id|EINVAL
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|NETLINK_CB
c_func
(paren
id|skb
)paren
dot
id|dst_groups
op_assign
id|RTMGRP_IPV6_IFADDR
suffix:semicolon
id|netlink_broadcast
c_func
(paren
id|rtnl
comma
id|skb
comma
l_int|0
comma
id|RTMGRP_IPV6_IFADDR
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
)brace
DECL|function|ipv6_store_devconf
r_static
r_void
r_inline
id|ipv6_store_devconf
c_func
(paren
r_struct
id|ipv6_devconf
op_star
id|cnf
comma
id|__s32
op_star
id|array
comma
r_int
id|bytes
)paren
(brace
id|memset
c_func
(paren
id|array
comma
l_int|0
comma
id|bytes
)paren
suffix:semicolon
id|array
(braket
id|DEVCONF_FORWARDING
)braket
op_assign
id|cnf-&gt;forwarding
suffix:semicolon
id|array
(braket
id|DEVCONF_HOPLIMIT
)braket
op_assign
id|cnf-&gt;hop_limit
suffix:semicolon
id|array
(braket
id|DEVCONF_MTU6
)braket
op_assign
id|cnf-&gt;mtu6
suffix:semicolon
id|array
(braket
id|DEVCONF_ACCEPT_RA
)braket
op_assign
id|cnf-&gt;accept_ra
suffix:semicolon
id|array
(braket
id|DEVCONF_ACCEPT_REDIRECTS
)braket
op_assign
id|cnf-&gt;accept_redirects
suffix:semicolon
id|array
(braket
id|DEVCONF_AUTOCONF
)braket
op_assign
id|cnf-&gt;autoconf
suffix:semicolon
id|array
(braket
id|DEVCONF_DAD_TRANSMITS
)braket
op_assign
id|cnf-&gt;dad_transmits
suffix:semicolon
id|array
(braket
id|DEVCONF_RTR_SOLICITS
)braket
op_assign
id|cnf-&gt;rtr_solicits
suffix:semicolon
id|array
(braket
id|DEVCONF_RTR_SOLICIT_INTERVAL
)braket
op_assign
id|cnf-&gt;rtr_solicit_interval
suffix:semicolon
id|array
(braket
id|DEVCONF_RTR_SOLICIT_DELAY
)braket
op_assign
id|cnf-&gt;rtr_solicit_delay
suffix:semicolon
id|array
(braket
id|DEVCONF_FORCE_MLD_VERSION
)braket
op_assign
id|cnf-&gt;force_mld_version
suffix:semicolon
macro_line|#ifdef CONFIG_IPV6_PRIVACY
id|array
(braket
id|DEVCONF_USE_TEMPADDR
)braket
op_assign
id|cnf-&gt;use_tempaddr
suffix:semicolon
id|array
(braket
id|DEVCONF_TEMP_VALID_LFT
)braket
op_assign
id|cnf-&gt;temp_valid_lft
suffix:semicolon
id|array
(braket
id|DEVCONF_TEMP_PREFERED_LFT
)braket
op_assign
id|cnf-&gt;temp_prefered_lft
suffix:semicolon
id|array
(braket
id|DEVCONF_REGEN_MAX_RETRY
)braket
op_assign
id|cnf-&gt;regen_max_retry
suffix:semicolon
id|array
(braket
id|DEVCONF_MAX_DESYNC_FACTOR
)braket
op_assign
id|cnf-&gt;max_desync_factor
suffix:semicolon
macro_line|#endif
id|array
(braket
id|DEVCONF_MAX_ADDRESSES
)braket
op_assign
id|cnf-&gt;max_addresses
suffix:semicolon
)brace
DECL|function|inet6_fill_ifinfo
r_static
r_int
id|inet6_fill_ifinfo
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|inet6_dev
op_star
id|idev
comma
id|u32
id|pid
comma
id|u32
id|seq
comma
r_int
id|event
)paren
(brace
r_struct
id|net_device
op_star
id|dev
op_assign
id|idev-&gt;dev
suffix:semicolon
id|__s32
op_star
id|array
op_assign
l_int|NULL
suffix:semicolon
r_struct
id|ifinfomsg
op_star
id|r
suffix:semicolon
r_struct
id|nlmsghdr
op_star
id|nlh
suffix:semicolon
r_int
r_char
op_star
id|b
op_assign
id|skb-&gt;tail
suffix:semicolon
r_struct
id|rtattr
op_star
id|subattr
suffix:semicolon
id|__u32
id|mtu
op_assign
id|dev-&gt;mtu
suffix:semicolon
r_struct
id|ifla_cacheinfo
id|ci
suffix:semicolon
id|nlh
op_assign
id|NLMSG_PUT
c_func
(paren
id|skb
comma
id|pid
comma
id|seq
comma
id|event
comma
r_sizeof
(paren
op_star
id|r
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pid
)paren
id|nlh-&gt;nlmsg_flags
op_or_assign
id|NLM_F_MULTI
suffix:semicolon
id|r
op_assign
id|NLMSG_DATA
c_func
(paren
id|nlh
)paren
suffix:semicolon
id|r-&gt;ifi_family
op_assign
id|AF_INET6
suffix:semicolon
id|r-&gt;ifi_type
op_assign
id|dev-&gt;type
suffix:semicolon
id|r-&gt;ifi_index
op_assign
id|dev-&gt;ifindex
suffix:semicolon
id|r-&gt;ifi_flags
op_assign
id|dev-&gt;flags
suffix:semicolon
id|r-&gt;ifi_change
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|netif_running
c_func
(paren
id|dev
)paren
op_logical_or
op_logical_neg
id|netif_carrier_ok
c_func
(paren
id|dev
)paren
)paren
id|r-&gt;ifi_flags
op_and_assign
op_complement
id|IFF_RUNNING
suffix:semicolon
r_else
id|r-&gt;ifi_flags
op_or_assign
id|IFF_RUNNING
suffix:semicolon
id|RTA_PUT
c_func
(paren
id|skb
comma
id|IFLA_IFNAME
comma
id|strlen
c_func
(paren
id|dev-&gt;name
)paren
op_plus
l_int|1
comma
id|dev-&gt;name
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dev-&gt;addr_len
)paren
id|RTA_PUT
c_func
(paren
id|skb
comma
id|IFLA_ADDRESS
comma
id|dev-&gt;addr_len
comma
id|dev-&gt;dev_addr
)paren
suffix:semicolon
id|RTA_PUT
c_func
(paren
id|skb
comma
id|IFLA_MTU
comma
r_sizeof
(paren
id|mtu
)paren
comma
op_amp
id|mtu
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dev-&gt;ifindex
op_ne
id|dev-&gt;iflink
)paren
id|RTA_PUT
c_func
(paren
id|skb
comma
id|IFLA_LINK
comma
r_sizeof
(paren
r_int
)paren
comma
op_amp
id|dev-&gt;iflink
)paren
suffix:semicolon
id|subattr
op_assign
(paren
r_struct
id|rtattr
op_star
)paren
id|skb-&gt;tail
suffix:semicolon
id|RTA_PUT
c_func
(paren
id|skb
comma
id|IFLA_PROTINFO
comma
l_int|0
comma
l_int|NULL
)paren
suffix:semicolon
multiline_comment|/* return the device flags */
id|RTA_PUT
c_func
(paren
id|skb
comma
id|IFLA_INET6_FLAGS
comma
r_sizeof
(paren
id|__u32
)paren
comma
op_amp
id|idev-&gt;if_flags
)paren
suffix:semicolon
multiline_comment|/* return interface cacheinfo */
id|ci.max_reasm_len
op_assign
id|IPV6_MAXPLEN
suffix:semicolon
id|ci.tstamp
op_assign
(paren
id|__u32
)paren
(paren
id|TIME_DELTA
c_func
(paren
id|idev-&gt;tstamp
comma
id|INITIAL_JIFFIES
)paren
op_div
id|HZ
op_star
l_int|100
op_plus
id|TIME_DELTA
c_func
(paren
id|idev-&gt;tstamp
comma
id|INITIAL_JIFFIES
)paren
op_mod
id|HZ
op_star
l_int|100
op_div
id|HZ
)paren
suffix:semicolon
id|ci.reachable_time
op_assign
id|idev-&gt;nd_parms-&gt;reachable_time
suffix:semicolon
id|ci.retrans_time
op_assign
id|idev-&gt;nd_parms-&gt;retrans_time
suffix:semicolon
id|RTA_PUT
c_func
(paren
id|skb
comma
id|IFLA_INET6_CACHEINFO
comma
r_sizeof
(paren
id|ci
)paren
comma
op_amp
id|ci
)paren
suffix:semicolon
multiline_comment|/* return the device sysctl params */
r_if
c_cond
(paren
(paren
id|array
op_assign
id|kmalloc
c_func
(paren
id|DEVCONF_MAX
op_star
r_sizeof
(paren
op_star
id|array
)paren
comma
id|GFP_ATOMIC
)paren
)paren
op_eq
l_int|NULL
)paren
r_goto
id|rtattr_failure
suffix:semicolon
id|ipv6_store_devconf
c_func
(paren
op_amp
id|idev-&gt;cnf
comma
id|array
comma
id|DEVCONF_MAX
op_star
r_sizeof
(paren
op_star
id|array
)paren
)paren
suffix:semicolon
id|RTA_PUT
c_func
(paren
id|skb
comma
id|IFLA_INET6_CONF
comma
id|DEVCONF_MAX
op_star
r_sizeof
(paren
op_star
id|array
)paren
comma
id|array
)paren
suffix:semicolon
multiline_comment|/* XXX - Statistics/MC not implemented */
id|subattr-&gt;rta_len
op_assign
id|skb-&gt;tail
op_minus
(paren
id|u8
op_star
)paren
id|subattr
suffix:semicolon
id|nlh-&gt;nlmsg_len
op_assign
id|skb-&gt;tail
op_minus
id|b
suffix:semicolon
id|kfree
c_func
(paren
id|array
)paren
suffix:semicolon
r_return
id|skb-&gt;len
suffix:semicolon
id|nlmsg_failure
suffix:colon
id|rtattr_failure
suffix:colon
r_if
c_cond
(paren
id|array
)paren
id|kfree
c_func
(paren
id|array
)paren
suffix:semicolon
id|skb_trim
c_func
(paren
id|skb
comma
id|b
op_minus
id|skb-&gt;data
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
DECL|function|inet6_dump_ifinfo
r_static
r_int
id|inet6_dump_ifinfo
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|netlink_callback
op_star
id|cb
)paren
(brace
r_int
id|idx
comma
id|err
suffix:semicolon
r_int
id|s_idx
op_assign
id|cb-&gt;args
(braket
l_int|0
)braket
suffix:semicolon
r_struct
id|net_device
op_star
id|dev
suffix:semicolon
r_struct
id|inet6_dev
op_star
id|idev
suffix:semicolon
id|read_lock
c_func
(paren
op_amp
id|dev_base_lock
)paren
suffix:semicolon
r_for
c_loop
(paren
id|dev
op_assign
id|dev_base
comma
id|idx
op_assign
l_int|0
suffix:semicolon
id|dev
suffix:semicolon
id|dev
op_assign
id|dev-&gt;next
comma
id|idx
op_increment
)paren
(brace
r_if
c_cond
(paren
id|idx
OL
id|s_idx
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
(paren
id|idev
op_assign
id|in6_dev_get
c_func
(paren
id|dev
)paren
)paren
op_eq
l_int|NULL
)paren
r_continue
suffix:semicolon
id|err
op_assign
id|inet6_fill_ifinfo
c_func
(paren
id|skb
comma
id|idev
comma
id|NETLINK_CB
c_func
(paren
id|cb-&gt;skb
)paren
dot
id|pid
comma
id|cb-&gt;nlh-&gt;nlmsg_seq
comma
id|RTM_NEWLINK
)paren
suffix:semicolon
id|in6_dev_put
c_func
(paren
id|idev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
op_le
l_int|0
)paren
r_break
suffix:semicolon
)brace
id|read_unlock
c_func
(paren
op_amp
id|dev_base_lock
)paren
suffix:semicolon
id|cb-&gt;args
(braket
l_int|0
)braket
op_assign
id|idx
suffix:semicolon
r_return
id|skb-&gt;len
suffix:semicolon
)brace
DECL|function|inet6_ifinfo_notify
r_void
id|inet6_ifinfo_notify
c_func
(paren
r_int
id|event
comma
r_struct
id|inet6_dev
op_star
id|idev
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
multiline_comment|/* 128 bytes ?? */
r_int
id|size
op_assign
id|NLMSG_SPACE
c_func
(paren
r_sizeof
(paren
r_struct
id|ifinfomsg
)paren
op_plus
l_int|128
)paren
suffix:semicolon
id|skb
op_assign
id|alloc_skb
c_func
(paren
id|size
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|skb
)paren
(brace
id|netlink_set_err
c_func
(paren
id|rtnl
comma
l_int|0
comma
id|RTMGRP_IPV6_IFINFO
comma
id|ENOBUFS
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|inet6_fill_ifinfo
c_func
(paren
id|skb
comma
id|idev
comma
l_int|0
comma
l_int|0
comma
id|event
)paren
OL
l_int|0
)paren
(brace
id|kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
id|netlink_set_err
c_func
(paren
id|rtnl
comma
l_int|0
comma
id|RTMGRP_IPV6_IFINFO
comma
id|EINVAL
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|NETLINK_CB
c_func
(paren
id|skb
)paren
dot
id|dst_groups
op_assign
id|RTMGRP_IPV6_IFINFO
suffix:semicolon
id|netlink_broadcast
c_func
(paren
id|rtnl
comma
id|skb
comma
l_int|0
comma
id|RTMGRP_IPV6_IFINFO
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
)brace
DECL|function|inet6_fill_prefix
r_static
r_int
id|inet6_fill_prefix
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|inet6_dev
op_star
id|idev
comma
r_struct
id|prefix_info
op_star
id|pinfo
comma
id|u32
id|pid
comma
id|u32
id|seq
comma
r_int
id|event
)paren
(brace
r_struct
id|prefixmsg
op_star
id|pmsg
suffix:semicolon
r_struct
id|nlmsghdr
op_star
id|nlh
suffix:semicolon
r_int
r_char
op_star
id|b
op_assign
id|skb-&gt;tail
suffix:semicolon
r_struct
id|prefix_cacheinfo
id|ci
suffix:semicolon
id|nlh
op_assign
id|NLMSG_PUT
c_func
(paren
id|skb
comma
id|pid
comma
id|seq
comma
id|event
comma
r_sizeof
(paren
op_star
id|pmsg
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pid
)paren
id|nlh-&gt;nlmsg_flags
op_or_assign
id|NLM_F_MULTI
suffix:semicolon
id|pmsg
op_assign
id|NLMSG_DATA
c_func
(paren
id|nlh
)paren
suffix:semicolon
id|pmsg-&gt;prefix_family
op_assign
id|AF_INET6
suffix:semicolon
id|pmsg-&gt;prefix_ifindex
op_assign
id|idev-&gt;dev-&gt;ifindex
suffix:semicolon
id|pmsg-&gt;prefix_len
op_assign
id|pinfo-&gt;prefix_len
suffix:semicolon
id|pmsg-&gt;prefix_type
op_assign
id|pinfo-&gt;type
suffix:semicolon
id|pmsg-&gt;prefix_flags
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|pinfo-&gt;onlink
)paren
id|pmsg-&gt;prefix_flags
op_or_assign
id|IF_PREFIX_ONLINK
suffix:semicolon
r_if
c_cond
(paren
id|pinfo-&gt;autoconf
)paren
id|pmsg-&gt;prefix_flags
op_or_assign
id|IF_PREFIX_AUTOCONF
suffix:semicolon
id|RTA_PUT
c_func
(paren
id|skb
comma
id|PREFIX_ADDRESS
comma
r_sizeof
(paren
id|pinfo-&gt;prefix
)paren
comma
op_amp
id|pinfo-&gt;prefix
)paren
suffix:semicolon
id|ci.preferred_time
op_assign
id|ntohl
c_func
(paren
id|pinfo-&gt;prefered
)paren
suffix:semicolon
id|ci.valid_time
op_assign
id|ntohl
c_func
(paren
id|pinfo-&gt;valid
)paren
suffix:semicolon
id|RTA_PUT
c_func
(paren
id|skb
comma
id|PREFIX_CACHEINFO
comma
r_sizeof
(paren
id|ci
)paren
comma
op_amp
id|ci
)paren
suffix:semicolon
id|nlh-&gt;nlmsg_len
op_assign
id|skb-&gt;tail
op_minus
id|b
suffix:semicolon
r_return
id|skb-&gt;len
suffix:semicolon
id|nlmsg_failure
suffix:colon
id|rtattr_failure
suffix:colon
id|skb_trim
c_func
(paren
id|skb
comma
id|b
op_minus
id|skb-&gt;data
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
DECL|function|inet6_prefix_notify
r_static
r_void
id|inet6_prefix_notify
c_func
(paren
r_int
id|event
comma
r_struct
id|inet6_dev
op_star
id|idev
comma
r_struct
id|prefix_info
op_star
id|pinfo
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
r_int
id|size
op_assign
id|NLMSG_SPACE
c_func
(paren
r_sizeof
(paren
r_struct
id|prefixmsg
)paren
op_plus
l_int|128
)paren
suffix:semicolon
id|skb
op_assign
id|alloc_skb
c_func
(paren
id|size
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|skb
)paren
(brace
id|netlink_set_err
c_func
(paren
id|rtnl
comma
l_int|0
comma
id|RTMGRP_IPV6_PREFIX
comma
id|ENOBUFS
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|inet6_fill_prefix
c_func
(paren
id|skb
comma
id|idev
comma
id|pinfo
comma
l_int|0
comma
l_int|0
comma
id|event
)paren
OL
l_int|0
)paren
(brace
id|kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
id|netlink_set_err
c_func
(paren
id|rtnl
comma
l_int|0
comma
id|RTMGRP_IPV6_PREFIX
comma
id|EINVAL
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|NETLINK_CB
c_func
(paren
id|skb
)paren
dot
id|dst_groups
op_assign
id|RTMGRP_IPV6_PREFIX
suffix:semicolon
id|netlink_broadcast
c_func
(paren
id|rtnl
comma
id|skb
comma
l_int|0
comma
id|RTMGRP_IPV6_PREFIX
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
)brace
DECL|variable|inet6_rtnetlink_table
r_static
r_struct
id|rtnetlink_link
id|inet6_rtnetlink_table
(braket
id|RTM_MAX
op_minus
id|RTM_BASE
op_plus
l_int|1
)braket
op_assign
(brace
(braket
id|RTM_GETLINK
op_minus
id|RTM_BASE
)braket
op_assign
(brace
dot
id|dumpit
op_assign
id|inet6_dump_ifinfo
comma
)brace
comma
(braket
id|RTM_NEWADDR
op_minus
id|RTM_BASE
)braket
op_assign
(brace
dot
id|doit
op_assign
id|inet6_rtm_newaddr
comma
)brace
comma
(braket
id|RTM_DELADDR
op_minus
id|RTM_BASE
)braket
op_assign
(brace
dot
id|doit
op_assign
id|inet6_rtm_deladdr
comma
)brace
comma
(braket
id|RTM_GETADDR
op_minus
id|RTM_BASE
)braket
op_assign
(brace
dot
id|dumpit
op_assign
id|inet6_dump_ifaddr
comma
)brace
comma
(braket
id|RTM_NEWROUTE
op_minus
id|RTM_BASE
)braket
op_assign
(brace
dot
id|doit
op_assign
id|inet6_rtm_newroute
comma
)brace
comma
(braket
id|RTM_DELROUTE
op_minus
id|RTM_BASE
)braket
op_assign
(brace
dot
id|doit
op_assign
id|inet6_rtm_delroute
comma
)brace
comma
(braket
id|RTM_GETROUTE
op_minus
id|RTM_BASE
)braket
op_assign
(brace
dot
id|doit
op_assign
id|inet6_rtm_getroute
comma
dot
id|dumpit
op_assign
id|inet6_dump_fib
comma
)brace
comma
)brace
suffix:semicolon
DECL|function|ipv6_ifa_notify
r_static
r_void
id|ipv6_ifa_notify
c_func
(paren
r_int
id|event
comma
r_struct
id|inet6_ifaddr
op_star
id|ifp
)paren
(brace
id|inet6_ifa_notify
c_func
(paren
id|event
ques
c_cond
suffix:colon
id|RTM_NEWADDR
comma
id|ifp
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|event
)paren
(brace
r_case
id|RTM_NEWADDR
suffix:colon
id|ip6_rt_addr_add
c_func
(paren
op_amp
id|ifp-&gt;addr
comma
id|ifp-&gt;idev-&gt;dev
comma
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|RTM_DELADDR
suffix:colon
id|addrconf_leave_solict
c_func
(paren
id|ifp-&gt;idev-&gt;dev
comma
op_amp
id|ifp-&gt;addr
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ifp-&gt;idev-&gt;cnf.forwarding
)paren
(brace
r_struct
id|in6_addr
id|addr
suffix:semicolon
id|ipv6_addr_prefix
c_func
(paren
op_amp
id|addr
comma
op_amp
id|ifp-&gt;addr
comma
id|ifp-&gt;prefix_len
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ipv6_addr_any
c_func
(paren
op_amp
id|addr
)paren
)paren
id|ipv6_dev_ac_dec
c_func
(paren
id|ifp-&gt;idev-&gt;dev
comma
op_amp
id|addr
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|ipv6_chk_addr
c_func
(paren
op_amp
id|ifp-&gt;addr
comma
id|ifp-&gt;idev-&gt;dev
comma
l_int|1
)paren
)paren
id|ip6_rt_addr_del
c_func
(paren
op_amp
id|ifp-&gt;addr
comma
id|ifp-&gt;idev-&gt;dev
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
macro_line|#ifdef CONFIG_SYSCTL
r_static
DECL|function|addrconf_sysctl_forward
r_int
id|addrconf_sysctl_forward
c_func
(paren
id|ctl_table
op_star
id|ctl
comma
r_int
id|write
comma
r_struct
id|file
op_star
id|filp
comma
r_void
op_star
id|buffer
comma
r_int
op_star
id|lenp
)paren
(brace
r_int
op_star
id|valp
op_assign
id|ctl-&gt;data
suffix:semicolon
r_int
id|val
op_assign
op_star
id|valp
suffix:semicolon
r_int
id|ret
suffix:semicolon
id|ret
op_assign
id|proc_dointvec
c_func
(paren
id|ctl
comma
id|write
comma
id|filp
comma
id|buffer
comma
id|lenp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|write
op_logical_and
op_star
id|valp
op_ne
id|val
op_logical_and
id|valp
op_ne
op_amp
id|ipv6_devconf_dflt.forwarding
)paren
(brace
r_struct
id|inet6_dev
op_star
id|idev
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
id|valp
op_ne
op_amp
id|ipv6_devconf.forwarding
)paren
(brace
id|idev
op_assign
(paren
r_struct
id|inet6_dev
op_star
)paren
id|ctl-&gt;extra1
suffix:semicolon
r_if
c_cond
(paren
id|idev
op_eq
l_int|NULL
)paren
r_return
id|ret
suffix:semicolon
)brace
r_else
id|ipv6_devconf_dflt.forwarding
op_assign
id|ipv6_devconf.forwarding
suffix:semicolon
id|addrconf_forward_change
c_func
(paren
id|idev
)paren
suffix:semicolon
r_if
c_cond
(paren
op_star
id|valp
)paren
id|rt6_purge_dflt_routers
c_func
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_return
id|ret
suffix:semicolon
)brace
DECL|function|addrconf_sysctl_forward_strategy
r_static
r_int
id|addrconf_sysctl_forward_strategy
c_func
(paren
id|ctl_table
op_star
id|table
comma
r_int
op_star
id|name
comma
r_int
id|nlen
comma
r_void
op_star
id|oldval
comma
r_int
op_star
id|oldlenp
comma
r_void
op_star
id|newval
comma
r_int
id|newlen
comma
r_void
op_star
op_star
id|context
)paren
(brace
r_int
op_star
id|valp
op_assign
id|table-&gt;data
suffix:semicolon
r_int
r_new
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|newval
op_logical_or
op_logical_neg
id|newlen
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|newlen
op_ne
r_sizeof
(paren
r_int
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|get_user
c_func
(paren
r_new
comma
(paren
r_int
op_star
)paren
id|newval
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
r_new
op_eq
op_star
id|valp
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|oldval
op_logical_and
id|oldlenp
)paren
(brace
r_int
id|len
suffix:semicolon
r_if
c_cond
(paren
id|get_user
c_func
(paren
id|len
comma
id|oldlenp
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
id|len
)paren
(brace
r_if
c_cond
(paren
id|len
OG
id|table-&gt;maxlen
)paren
id|len
op_assign
id|table-&gt;maxlen
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|oldval
comma
id|valp
comma
id|len
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
id|put_user
c_func
(paren
id|len
comma
id|oldlenp
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|valp
op_ne
op_amp
id|ipv6_devconf_dflt.forwarding
)paren
(brace
r_struct
id|inet6_dev
op_star
id|idev
suffix:semicolon
r_if
c_cond
(paren
id|valp
op_ne
op_amp
id|ipv6_devconf.forwarding
)paren
(brace
id|idev
op_assign
(paren
r_struct
id|inet6_dev
op_star
)paren
id|table-&gt;extra1
suffix:semicolon
r_if
c_cond
(paren
id|unlikely
c_func
(paren
id|idev
op_eq
l_int|NULL
)paren
)paren
r_return
op_minus
id|ENODEV
suffix:semicolon
)brace
r_else
id|idev
op_assign
l_int|NULL
suffix:semicolon
op_star
id|valp
op_assign
r_new
suffix:semicolon
id|addrconf_forward_change
c_func
(paren
id|idev
)paren
suffix:semicolon
r_if
c_cond
(paren
op_star
id|valp
)paren
id|rt6_purge_dflt_routers
c_func
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_else
op_star
id|valp
op_assign
r_new
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
DECL|struct|addrconf_sysctl_table
r_static
r_struct
id|addrconf_sysctl_table
(brace
DECL|member|sysctl_header
r_struct
id|ctl_table_header
op_star
id|sysctl_header
suffix:semicolon
DECL|member|addrconf_vars
id|ctl_table
id|addrconf_vars
(braket
l_int|18
)braket
suffix:semicolon
DECL|member|addrconf_dev
id|ctl_table
id|addrconf_dev
(braket
l_int|2
)braket
suffix:semicolon
DECL|member|addrconf_conf_dir
id|ctl_table
id|addrconf_conf_dir
(braket
l_int|2
)braket
suffix:semicolon
DECL|member|addrconf_proto_dir
id|ctl_table
id|addrconf_proto_dir
(braket
l_int|2
)braket
suffix:semicolon
DECL|member|addrconf_root_dir
id|ctl_table
id|addrconf_root_dir
(braket
l_int|2
)braket
suffix:semicolon
DECL|variable|addrconf_sysctl
)brace
id|addrconf_sysctl
op_assign
(brace
dot
id|sysctl_header
op_assign
l_int|NULL
comma
dot
id|addrconf_vars
op_assign
(brace
(brace
dot
id|ctl_name
op_assign
id|NET_IPV6_FORWARDING
comma
dot
id|procname
op_assign
l_string|&quot;forwarding&quot;
comma
dot
id|data
op_assign
op_amp
id|ipv6_devconf.forwarding
comma
dot
id|maxlen
op_assign
r_sizeof
(paren
r_int
)paren
comma
dot
id|mode
op_assign
l_int|0644
comma
dot
id|proc_handler
op_assign
op_amp
id|addrconf_sysctl_forward
comma
dot
id|strategy
op_assign
op_amp
id|addrconf_sysctl_forward_strategy
comma
)brace
comma
(brace
dot
id|ctl_name
op_assign
id|NET_IPV6_HOP_LIMIT
comma
dot
id|procname
op_assign
l_string|&quot;hop_limit&quot;
comma
dot
id|data
op_assign
op_amp
id|ipv6_devconf.hop_limit
comma
dot
id|maxlen
op_assign
r_sizeof
(paren
r_int
)paren
comma
dot
id|mode
op_assign
l_int|0644
comma
dot
id|proc_handler
op_assign
id|proc_dointvec
comma
)brace
comma
(brace
dot
id|ctl_name
op_assign
id|NET_IPV6_MTU
comma
dot
id|procname
op_assign
l_string|&quot;mtu&quot;
comma
dot
id|data
op_assign
op_amp
id|ipv6_devconf.mtu6
comma
dot
id|maxlen
op_assign
r_sizeof
(paren
r_int
)paren
comma
dot
id|mode
op_assign
l_int|0644
comma
dot
id|proc_handler
op_assign
op_amp
id|proc_dointvec
comma
)brace
comma
(brace
dot
id|ctl_name
op_assign
id|NET_IPV6_ACCEPT_RA
comma
dot
id|procname
op_assign
l_string|&quot;accept_ra&quot;
comma
dot
id|data
op_assign
op_amp
id|ipv6_devconf.accept_ra
comma
dot
id|maxlen
op_assign
r_sizeof
(paren
r_int
)paren
comma
dot
id|mode
op_assign
l_int|0644
comma
dot
id|proc_handler
op_assign
op_amp
id|proc_dointvec
comma
)brace
comma
(brace
dot
id|ctl_name
op_assign
id|NET_IPV6_ACCEPT_REDIRECTS
comma
dot
id|procname
op_assign
l_string|&quot;accept_redirects&quot;
comma
dot
id|data
op_assign
op_amp
id|ipv6_devconf.accept_redirects
comma
dot
id|maxlen
op_assign
r_sizeof
(paren
r_int
)paren
comma
dot
id|mode
op_assign
l_int|0644
comma
dot
id|proc_handler
op_assign
op_amp
id|proc_dointvec
comma
)brace
comma
(brace
dot
id|ctl_name
op_assign
id|NET_IPV6_AUTOCONF
comma
dot
id|procname
op_assign
l_string|&quot;autoconf&quot;
comma
dot
id|data
op_assign
op_amp
id|ipv6_devconf.autoconf
comma
dot
id|maxlen
op_assign
r_sizeof
(paren
r_int
)paren
comma
dot
id|mode
op_assign
l_int|0644
comma
dot
id|proc_handler
op_assign
op_amp
id|proc_dointvec
comma
)brace
comma
(brace
dot
id|ctl_name
op_assign
id|NET_IPV6_DAD_TRANSMITS
comma
dot
id|procname
op_assign
l_string|&quot;dad_transmits&quot;
comma
dot
id|data
op_assign
op_amp
id|ipv6_devconf.dad_transmits
comma
dot
id|maxlen
op_assign
r_sizeof
(paren
r_int
)paren
comma
dot
id|mode
op_assign
l_int|0644
comma
dot
id|proc_handler
op_assign
op_amp
id|proc_dointvec
comma
)brace
comma
(brace
dot
id|ctl_name
op_assign
id|NET_IPV6_RTR_SOLICITS
comma
dot
id|procname
op_assign
l_string|&quot;router_solicitations&quot;
comma
dot
id|data
op_assign
op_amp
id|ipv6_devconf.rtr_solicits
comma
dot
id|maxlen
op_assign
r_sizeof
(paren
r_int
)paren
comma
dot
id|mode
op_assign
l_int|0644
comma
dot
id|proc_handler
op_assign
op_amp
id|proc_dointvec
comma
)brace
comma
(brace
dot
id|ctl_name
op_assign
id|NET_IPV6_RTR_SOLICIT_INTERVAL
comma
dot
id|procname
op_assign
l_string|&quot;router_solicitation_interval&quot;
comma
dot
id|data
op_assign
op_amp
id|ipv6_devconf.rtr_solicit_interval
comma
dot
id|maxlen
op_assign
r_sizeof
(paren
r_int
)paren
comma
dot
id|mode
op_assign
l_int|0644
comma
dot
id|proc_handler
op_assign
op_amp
id|proc_dointvec_jiffies
comma
dot
id|strategy
op_assign
op_amp
id|sysctl_jiffies
comma
)brace
comma
(brace
dot
id|ctl_name
op_assign
id|NET_IPV6_RTR_SOLICIT_DELAY
comma
dot
id|procname
op_assign
l_string|&quot;router_solicitation_delay&quot;
comma
dot
id|data
op_assign
op_amp
id|ipv6_devconf.rtr_solicit_delay
comma
dot
id|maxlen
op_assign
r_sizeof
(paren
r_int
)paren
comma
dot
id|mode
op_assign
l_int|0644
comma
dot
id|proc_handler
op_assign
op_amp
id|proc_dointvec_jiffies
comma
dot
id|strategy
op_assign
op_amp
id|sysctl_jiffies
comma
)brace
comma
(brace
dot
id|ctl_name
op_assign
id|NET_IPV6_FORCE_MLD_VERSION
comma
dot
id|procname
op_assign
l_string|&quot;force_mld_version&quot;
comma
dot
id|data
op_assign
op_amp
id|ipv6_devconf.force_mld_version
comma
dot
id|maxlen
op_assign
r_sizeof
(paren
r_int
)paren
comma
dot
id|mode
op_assign
l_int|0644
comma
dot
id|proc_handler
op_assign
op_amp
id|proc_dointvec
comma
)brace
comma
macro_line|#ifdef CONFIG_IPV6_PRIVACY
(brace
dot
id|ctl_name
op_assign
id|NET_IPV6_USE_TEMPADDR
comma
dot
id|procname
op_assign
l_string|&quot;use_tempaddr&quot;
comma
dot
id|data
op_assign
op_amp
id|ipv6_devconf.use_tempaddr
comma
dot
id|maxlen
op_assign
r_sizeof
(paren
r_int
)paren
comma
dot
id|mode
op_assign
l_int|0644
comma
dot
id|proc_handler
op_assign
op_amp
id|proc_dointvec
comma
)brace
comma
(brace
dot
id|ctl_name
op_assign
id|NET_IPV6_TEMP_VALID_LFT
comma
dot
id|procname
op_assign
l_string|&quot;temp_valid_lft&quot;
comma
dot
id|data
op_assign
op_amp
id|ipv6_devconf.temp_valid_lft
comma
dot
id|maxlen
op_assign
r_sizeof
(paren
r_int
)paren
comma
dot
id|mode
op_assign
l_int|0644
comma
dot
id|proc_handler
op_assign
op_amp
id|proc_dointvec
comma
)brace
comma
(brace
dot
id|ctl_name
op_assign
id|NET_IPV6_TEMP_PREFERED_LFT
comma
dot
id|procname
op_assign
l_string|&quot;temp_prefered_lft&quot;
comma
dot
id|data
op_assign
op_amp
id|ipv6_devconf.temp_prefered_lft
comma
dot
id|maxlen
op_assign
r_sizeof
(paren
r_int
)paren
comma
dot
id|mode
op_assign
l_int|0644
comma
dot
id|proc_handler
op_assign
op_amp
id|proc_dointvec
comma
)brace
comma
(brace
dot
id|ctl_name
op_assign
id|NET_IPV6_REGEN_MAX_RETRY
comma
dot
id|procname
op_assign
l_string|&quot;regen_max_retry&quot;
comma
dot
id|data
op_assign
op_amp
id|ipv6_devconf.regen_max_retry
comma
dot
id|maxlen
op_assign
r_sizeof
(paren
r_int
)paren
comma
dot
id|mode
op_assign
l_int|0644
comma
dot
id|proc_handler
op_assign
op_amp
id|proc_dointvec
comma
)brace
comma
(brace
dot
id|ctl_name
op_assign
id|NET_IPV6_MAX_DESYNC_FACTOR
comma
dot
id|procname
op_assign
l_string|&quot;max_desync_factor&quot;
comma
dot
id|data
op_assign
op_amp
id|ipv6_devconf.max_desync_factor
comma
dot
id|maxlen
op_assign
r_sizeof
(paren
r_int
)paren
comma
dot
id|mode
op_assign
l_int|0644
comma
dot
id|proc_handler
op_assign
op_amp
id|proc_dointvec
comma
)brace
comma
macro_line|#endif
(brace
dot
id|ctl_name
op_assign
id|NET_IPV6_MAX_ADDRESSES
comma
dot
id|procname
op_assign
l_string|&quot;max_addresses&quot;
comma
dot
id|data
op_assign
op_amp
id|ipv6_devconf.max_addresses
comma
dot
id|maxlen
op_assign
r_sizeof
(paren
r_int
)paren
comma
dot
id|mode
op_assign
l_int|0644
comma
dot
id|proc_handler
op_assign
op_amp
id|proc_dointvec
comma
)brace
comma
(brace
dot
id|ctl_name
op_assign
l_int|0
comma
multiline_comment|/* sentinel */
)brace
)brace
comma
dot
id|addrconf_dev
op_assign
(brace
(brace
dot
id|ctl_name
op_assign
id|NET_PROTO_CONF_ALL
comma
dot
id|procname
op_assign
l_string|&quot;all&quot;
comma
dot
id|mode
op_assign
l_int|0555
comma
dot
id|child
op_assign
id|addrconf_sysctl.addrconf_vars
comma
)brace
comma
(brace
dot
id|ctl_name
op_assign
l_int|0
comma
multiline_comment|/* sentinel */
)brace
)brace
comma
dot
id|addrconf_conf_dir
op_assign
(brace
(brace
dot
id|ctl_name
op_assign
id|NET_IPV6_CONF
comma
dot
id|procname
op_assign
l_string|&quot;conf&quot;
comma
dot
id|mode
op_assign
l_int|0555
comma
dot
id|child
op_assign
id|addrconf_sysctl.addrconf_dev
comma
)brace
comma
(brace
dot
id|ctl_name
op_assign
l_int|0
comma
multiline_comment|/* sentinel */
)brace
)brace
comma
dot
id|addrconf_proto_dir
op_assign
(brace
(brace
dot
id|ctl_name
op_assign
id|NET_IPV6
comma
dot
id|procname
op_assign
l_string|&quot;ipv6&quot;
comma
dot
id|mode
op_assign
l_int|0555
comma
dot
id|child
op_assign
id|addrconf_sysctl.addrconf_conf_dir
comma
)brace
comma
(brace
dot
id|ctl_name
op_assign
l_int|0
comma
multiline_comment|/* sentinel */
)brace
)brace
comma
dot
id|addrconf_root_dir
op_assign
(brace
(brace
dot
id|ctl_name
op_assign
id|CTL_NET
comma
dot
id|procname
op_assign
l_string|&quot;net&quot;
comma
dot
id|mode
op_assign
l_int|0555
comma
dot
id|child
op_assign
id|addrconf_sysctl.addrconf_proto_dir
comma
)brace
comma
(brace
dot
id|ctl_name
op_assign
l_int|0
comma
multiline_comment|/* sentinel */
)brace
)brace
comma
)brace
suffix:semicolon
DECL|function|addrconf_sysctl_register
r_static
r_void
id|addrconf_sysctl_register
c_func
(paren
r_struct
id|inet6_dev
op_star
id|idev
comma
r_struct
id|ipv6_devconf
op_star
id|p
)paren
(brace
r_int
id|i
suffix:semicolon
r_struct
id|net_device
op_star
id|dev
op_assign
id|idev
ques
c_cond
id|idev-&gt;dev
suffix:colon
l_int|NULL
suffix:semicolon
r_struct
id|addrconf_sysctl_table
op_star
id|t
suffix:semicolon
r_char
op_star
id|dev_name
op_assign
l_int|NULL
suffix:semicolon
id|t
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
op_star
id|t
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|t
op_eq
l_int|NULL
)paren
r_return
suffix:semicolon
id|memcpy
c_func
(paren
id|t
comma
op_amp
id|addrconf_sysctl
comma
r_sizeof
(paren
op_star
id|t
)paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|t-&gt;addrconf_vars
(braket
id|i
)braket
dot
id|data
suffix:semicolon
id|i
op_increment
)paren
(brace
id|t-&gt;addrconf_vars
(braket
id|i
)braket
dot
id|data
op_add_assign
(paren
r_char
op_star
)paren
id|p
op_minus
(paren
r_char
op_star
)paren
op_amp
id|ipv6_devconf
suffix:semicolon
id|t-&gt;addrconf_vars
(braket
id|i
)braket
dot
id|de
op_assign
l_int|NULL
suffix:semicolon
id|t-&gt;addrconf_vars
(braket
id|i
)braket
dot
id|extra1
op_assign
id|idev
suffix:semicolon
multiline_comment|/* embedded; no ref */
)brace
r_if
c_cond
(paren
id|dev
)paren
(brace
id|dev_name
op_assign
id|dev-&gt;name
suffix:semicolon
id|t-&gt;addrconf_dev
(braket
l_int|0
)braket
dot
id|ctl_name
op_assign
id|dev-&gt;ifindex
suffix:semicolon
)brace
r_else
(brace
id|dev_name
op_assign
l_string|&quot;default&quot;
suffix:semicolon
id|t-&gt;addrconf_dev
(braket
l_int|0
)braket
dot
id|ctl_name
op_assign
id|NET_PROTO_CONF_DEFAULT
suffix:semicolon
)brace
multiline_comment|/* &n;&t; * Make a copy of dev_name, because &squot;.procname&squot; is regarded as const &n;&t; * by sysctl and we wouldn&squot;t want anyone to change it under our feet&n;&t; * (see SIOCSIFNAME).&n;&t; */
id|dev_name
op_assign
id|net_sysctl_strdup
c_func
(paren
id|dev_name
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dev_name
)paren
r_goto
id|free
suffix:semicolon
id|t-&gt;addrconf_dev
(braket
l_int|0
)braket
dot
id|procname
op_assign
id|dev_name
suffix:semicolon
id|t-&gt;addrconf_dev
(braket
l_int|0
)braket
dot
id|child
op_assign
id|t-&gt;addrconf_vars
suffix:semicolon
id|t-&gt;addrconf_dev
(braket
l_int|0
)braket
dot
id|de
op_assign
l_int|NULL
suffix:semicolon
id|t-&gt;addrconf_conf_dir
(braket
l_int|0
)braket
dot
id|child
op_assign
id|t-&gt;addrconf_dev
suffix:semicolon
id|t-&gt;addrconf_conf_dir
(braket
l_int|0
)braket
dot
id|de
op_assign
l_int|NULL
suffix:semicolon
id|t-&gt;addrconf_proto_dir
(braket
l_int|0
)braket
dot
id|child
op_assign
id|t-&gt;addrconf_conf_dir
suffix:semicolon
id|t-&gt;addrconf_proto_dir
(braket
l_int|0
)braket
dot
id|de
op_assign
l_int|NULL
suffix:semicolon
id|t-&gt;addrconf_root_dir
(braket
l_int|0
)braket
dot
id|child
op_assign
id|t-&gt;addrconf_proto_dir
suffix:semicolon
id|t-&gt;addrconf_root_dir
(braket
l_int|0
)braket
dot
id|de
op_assign
l_int|NULL
suffix:semicolon
id|t-&gt;sysctl_header
op_assign
id|register_sysctl_table
c_func
(paren
id|t-&gt;addrconf_root_dir
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|t-&gt;sysctl_header
op_eq
l_int|NULL
)paren
r_goto
id|free_procname
suffix:semicolon
r_else
id|p-&gt;sysctl
op_assign
id|t
suffix:semicolon
r_return
suffix:semicolon
multiline_comment|/* error path */
id|free_procname
suffix:colon
id|kfree
c_func
(paren
id|dev_name
)paren
suffix:semicolon
id|free
suffix:colon
id|kfree
c_func
(paren
id|t
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
DECL|function|addrconf_sysctl_unregister
r_static
r_void
id|addrconf_sysctl_unregister
c_func
(paren
r_struct
id|ipv6_devconf
op_star
id|p
)paren
(brace
r_if
c_cond
(paren
id|p-&gt;sysctl
)paren
(brace
r_struct
id|addrconf_sysctl_table
op_star
id|t
op_assign
id|p-&gt;sysctl
suffix:semicolon
id|p-&gt;sysctl
op_assign
l_int|NULL
suffix:semicolon
id|unregister_sysctl_table
c_func
(paren
id|t-&gt;sysctl_header
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|t-&gt;addrconf_dev
(braket
l_int|0
)braket
dot
id|procname
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|t
)paren
suffix:semicolon
)brace
)brace
macro_line|#endif
multiline_comment|/*&n; *      Device notifier&n; */
DECL|function|register_inet6addr_notifier
r_int
id|register_inet6addr_notifier
c_func
(paren
r_struct
id|notifier_block
op_star
id|nb
)paren
(brace
r_return
id|notifier_chain_register
c_func
(paren
op_amp
id|inet6addr_chain
comma
id|nb
)paren
suffix:semicolon
)brace
DECL|function|unregister_inet6addr_notifier
r_int
id|unregister_inet6addr_notifier
c_func
(paren
r_struct
id|notifier_block
op_star
id|nb
)paren
(brace
r_return
id|notifier_chain_unregister
c_func
(paren
op_amp
id|inet6addr_chain
comma
id|nb
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; *&t;Init / cleanup code&n; */
DECL|function|addrconf_init
r_void
id|__init
id|addrconf_init
c_func
(paren
r_void
)paren
(brace
id|register_netdevice_notifier
c_func
(paren
op_amp
id|ipv6_dev_notf
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_IPV6_PRIVACY
id|md5_tfm
op_assign
id|crypto_alloc_tfm
c_func
(paren
l_string|&quot;md5&quot;
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|unlikely
c_func
(paren
id|md5_tfm
op_eq
l_int|NULL
)paren
)paren
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;failed to load transform for md5&bslash;n&quot;
)paren
suffix:semicolon
macro_line|#endif
id|addrconf_verify
c_func
(paren
l_int|0
)paren
suffix:semicolon
id|rtnetlink_links
(braket
id|PF_INET6
)braket
op_assign
id|inet6_rtnetlink_table
suffix:semicolon
macro_line|#ifdef CONFIG_SYSCTL
id|addrconf_sysctl.sysctl_header
op_assign
id|register_sysctl_table
c_func
(paren
id|addrconf_sysctl.addrconf_root_dir
comma
l_int|0
)paren
suffix:semicolon
id|addrconf_sysctl_register
c_func
(paren
l_int|NULL
comma
op_amp
id|ipv6_devconf_dflt
)paren
suffix:semicolon
macro_line|#endif
)brace
DECL|function|addrconf_cleanup
r_void
id|__exit
id|addrconf_cleanup
c_func
(paren
r_void
)paren
(brace
r_struct
id|net_device
op_star
id|dev
suffix:semicolon
r_struct
id|inet6_dev
op_star
id|idev
suffix:semicolon
r_struct
id|inet6_ifaddr
op_star
id|ifa
suffix:semicolon
r_int
id|i
suffix:semicolon
id|unregister_netdevice_notifier
c_func
(paren
op_amp
id|ipv6_dev_notf
)paren
suffix:semicolon
id|rtnetlink_links
(braket
id|PF_INET6
)braket
op_assign
l_int|NULL
suffix:semicolon
macro_line|#ifdef CONFIG_SYSCTL
id|addrconf_sysctl_unregister
c_func
(paren
op_amp
id|ipv6_devconf_dflt
)paren
suffix:semicolon
id|addrconf_sysctl_unregister
c_func
(paren
op_amp
id|ipv6_devconf
)paren
suffix:semicolon
macro_line|#endif
id|rtnl_lock
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/*&n;&t; *&t;clean dev list.&n;&t; */
r_for
c_loop
(paren
id|dev
op_assign
id|dev_base
suffix:semicolon
id|dev
suffix:semicolon
id|dev
op_assign
id|dev-&gt;next
)paren
(brace
r_if
c_cond
(paren
(paren
id|idev
op_assign
id|__in6_dev_get
c_func
(paren
id|dev
)paren
)paren
op_eq
l_int|NULL
)paren
r_continue
suffix:semicolon
id|addrconf_ifdown
c_func
(paren
id|dev
comma
l_int|1
)paren
suffix:semicolon
)brace
multiline_comment|/*&n;&t; *&t;Check hash table.&n;&t; */
id|write_lock_bh
c_func
(paren
op_amp
id|addrconf_hash_lock
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|IN6_ADDR_HSIZE
suffix:semicolon
id|i
op_increment
)paren
(brace
r_for
c_loop
(paren
id|ifa
op_assign
id|inet6_addr_lst
(braket
id|i
)braket
suffix:semicolon
id|ifa
suffix:semicolon
)paren
(brace
r_struct
id|inet6_ifaddr
op_star
id|bifa
suffix:semicolon
id|bifa
op_assign
id|ifa
suffix:semicolon
id|ifa
op_assign
id|ifa-&gt;lst_next
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;bug: IPv6 address leakage detected: ifa=%p&bslash;n&quot;
comma
id|bifa
)paren
suffix:semicolon
multiline_comment|/* Do not free it; something is wrong.&n;&t;&t;&t;   Now we can investigate it with debugger.&n;&t;&t;&t; */
)brace
)brace
id|write_unlock_bh
c_func
(paren
op_amp
id|addrconf_hash_lock
)paren
suffix:semicolon
id|del_timer
c_func
(paren
op_amp
id|addr_chk_timer
)paren
suffix:semicolon
id|rtnl_unlock
c_func
(paren
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_IPV6_PRIVACY
r_if
c_cond
(paren
id|likely
c_func
(paren
id|md5_tfm
op_ne
l_int|NULL
)paren
)paren
(brace
id|crypto_free_tfm
c_func
(paren
id|md5_tfm
)paren
suffix:semicolon
id|md5_tfm
op_assign
l_int|NULL
suffix:semicolon
)brace
macro_line|#endif
macro_line|#ifdef CONFIG_PROC_FS
id|proc_net_remove
c_func
(paren
l_string|&quot;if_inet6&quot;
)paren
suffix:semicolon
macro_line|#endif
)brace
eof
