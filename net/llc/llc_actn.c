multiline_comment|/*&n; * llc_actn.c - Implementation of actions of station component of LLC&n; *&n; * Description :&n; *   Functions in this module are implementation of station component actions.&n; *   Details of actions can be found in IEEE-802.2 standard document.&n; *   All functions have one station and one event as input argument. All of&n; *   them return 0 On success and 1 otherwise.&n; *&n; * Copyright (c) 1997 by Procom Technology, Inc.&n; * &t;&t; 2001 by Arnaldo Carvalho de Melo &lt;acme@conectiva.com.br&gt;&n; *&n; * This program can be redistributed or modified under the terms of the&n; * GNU General Public License as published by the Free Software Foundation.&n; * This program is distributed without any warranty or implied warranty&n; * of merchantability or fitness for a particular purpose.&n; *&n; * See the GNU General Public License for more details.&n; */
macro_line|#include &lt;linux/netdevice.h&gt;
macro_line|#include &lt;net/llc_if.h&gt;
macro_line|#include &lt;net/llc_main.h&gt;
macro_line|#include &lt;net/llc_evnt.h&gt;
macro_line|#include &lt;net/llc_pdu.h&gt;
macro_line|#include &lt;net/llc_mac.h&gt;
r_static
r_void
id|llc_station_ack_tmr_callback
c_func
(paren
r_int
r_int
id|timeout_data
)paren
suffix:semicolon
DECL|function|llc_station_ac_start_ack_timer
r_int
id|llc_station_ac_start_ack_timer
c_func
(paren
r_struct
id|llc_station
op_star
id|station
comma
r_struct
id|llc_station_state_ev
op_star
id|ev
)paren
(brace
id|del_timer
c_func
(paren
op_amp
id|station-&gt;ack_timer
)paren
suffix:semicolon
id|station-&gt;ack_timer.expires
op_assign
id|jiffies
op_plus
id|LLC_ACK_TIME
op_star
id|HZ
suffix:semicolon
id|station-&gt;ack_timer.data
op_assign
(paren
r_int
r_int
)paren
id|station
suffix:semicolon
id|station-&gt;ack_timer.function
op_assign
id|llc_station_ack_tmr_callback
suffix:semicolon
id|add_timer
c_func
(paren
op_amp
id|station-&gt;ack_timer
)paren
suffix:semicolon
id|station-&gt;ack_tmr_running
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_station_ac_set_retry_cnt_0
r_int
id|llc_station_ac_set_retry_cnt_0
c_func
(paren
r_struct
id|llc_station
op_star
id|station
comma
r_struct
id|llc_station_state_ev
op_star
id|ev
)paren
(brace
id|station-&gt;retry_count
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_station_ac_inc_retry_cnt_by_1
r_int
id|llc_station_ac_inc_retry_cnt_by_1
c_func
(paren
r_struct
id|llc_station
op_star
id|station
comma
r_struct
id|llc_station_state_ev
op_star
id|ev
)paren
(brace
id|station-&gt;retry_count
op_increment
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_station_ac_set_xid_r_cnt_0
r_int
id|llc_station_ac_set_xid_r_cnt_0
c_func
(paren
r_struct
id|llc_station
op_star
id|station
comma
r_struct
id|llc_station_state_ev
op_star
id|ev
)paren
(brace
id|station-&gt;xid_r_count
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_station_ac_inc_xid_r_cnt_by_1
r_int
id|llc_station_ac_inc_xid_r_cnt_by_1
c_func
(paren
r_struct
id|llc_station
op_star
id|station
comma
r_struct
id|llc_station_state_ev
op_star
id|ev
)paren
(brace
id|station-&gt;xid_r_count
op_increment
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_station_ac_send_null_dsap_xid_c
r_int
id|llc_station_ac_send_null_dsap_xid_c
c_func
(paren
r_struct
id|llc_station
op_star
id|station
comma
r_struct
id|llc_station_state_ev
op_star
id|ev
)paren
(brace
r_int
id|rc
op_assign
l_int|1
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|llc_alloc_frame
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|skb
)paren
r_goto
id|out
suffix:semicolon
id|rc
op_assign
l_int|0
suffix:semicolon
id|llc_pdu_header_init
c_func
(paren
id|skb
comma
id|LLC_PDU_TYPE_U
comma
l_int|0
comma
l_int|0
comma
id|LLC_PDU_CMD
)paren
suffix:semicolon
id|llc_pdu_init_as_xid_cmd
c_func
(paren
id|skb
comma
id|LLC_XID_NULL_CLASS_2
comma
l_int|127
)paren
suffix:semicolon
id|lan_hdrs_init
c_func
(paren
id|skb
comma
id|station-&gt;mac_sa
comma
id|station-&gt;mac_sa
)paren
suffix:semicolon
id|llc_station_send_pdu
c_func
(paren
id|station
comma
id|skb
)paren
suffix:semicolon
id|out
suffix:colon
r_return
id|rc
suffix:semicolon
)brace
DECL|function|llc_station_ac_send_xid_r
r_int
id|llc_station_ac_send_xid_r
c_func
(paren
r_struct
id|llc_station
op_star
id|station
comma
r_struct
id|llc_station_state_ev
op_star
id|ev
)paren
(brace
id|u8
id|mac_da
(braket
id|ETH_ALEN
)braket
comma
id|dsap
suffix:semicolon
r_int
id|rc
op_assign
l_int|1
suffix:semicolon
r_struct
id|sk_buff
op_star
id|ev_skb
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|llc_alloc_frame
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|skb
)paren
r_goto
id|out
suffix:semicolon
id|rc
op_assign
l_int|0
suffix:semicolon
id|ev_skb
op_assign
id|ev-&gt;data.pdu.skb
suffix:semicolon
id|skb-&gt;dev
op_assign
id|ev_skb-&gt;dev
suffix:semicolon
id|llc_pdu_decode_sa
c_func
(paren
id|ev_skb
comma
id|mac_da
)paren
suffix:semicolon
id|llc_pdu_decode_ssap
c_func
(paren
id|ev_skb
comma
op_amp
id|dsap
)paren
suffix:semicolon
id|llc_pdu_header_init
c_func
(paren
id|skb
comma
id|LLC_PDU_TYPE_U
comma
l_int|0
comma
id|dsap
comma
id|LLC_PDU_RSP
)paren
suffix:semicolon
id|llc_pdu_init_as_xid_rsp
c_func
(paren
id|skb
comma
id|LLC_XID_NULL_CLASS_2
comma
l_int|127
)paren
suffix:semicolon
id|lan_hdrs_init
c_func
(paren
id|skb
comma
id|station-&gt;mac_sa
comma
id|mac_da
)paren
suffix:semicolon
id|llc_station_send_pdu
c_func
(paren
id|station
comma
id|skb
)paren
suffix:semicolon
id|out
suffix:colon
r_return
id|rc
suffix:semicolon
)brace
DECL|function|llc_station_ac_send_test_r
r_int
id|llc_station_ac_send_test_r
c_func
(paren
r_struct
id|llc_station
op_star
id|station
comma
r_struct
id|llc_station_state_ev
op_star
id|ev
)paren
(brace
id|u8
id|mac_da
(braket
id|ETH_ALEN
)braket
comma
id|dsap
suffix:semicolon
r_int
id|rc
op_assign
l_int|1
suffix:semicolon
r_struct
id|sk_buff
op_star
id|ev_skb
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|llc_alloc_frame
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|skb
)paren
r_goto
id|out
suffix:semicolon
id|rc
op_assign
l_int|0
suffix:semicolon
id|ev_skb
op_assign
id|ev-&gt;data.pdu.skb
suffix:semicolon
id|skb-&gt;dev
op_assign
id|ev_skb-&gt;dev
suffix:semicolon
id|llc_pdu_decode_sa
c_func
(paren
id|ev_skb
comma
id|mac_da
)paren
suffix:semicolon
id|llc_pdu_decode_ssap
c_func
(paren
id|ev_skb
comma
op_amp
id|dsap
)paren
suffix:semicolon
id|llc_pdu_header_init
c_func
(paren
id|skb
comma
id|LLC_PDU_TYPE_U
comma
l_int|0
comma
id|dsap
comma
id|LLC_PDU_RSP
)paren
suffix:semicolon
id|llc_pdu_init_as_test_rsp
c_func
(paren
id|skb
comma
id|ev_skb
)paren
suffix:semicolon
id|lan_hdrs_init
c_func
(paren
id|skb
comma
id|station-&gt;mac_sa
comma
id|mac_da
)paren
suffix:semicolon
id|llc_station_send_pdu
c_func
(paren
id|station
comma
id|skb
)paren
suffix:semicolon
id|out
suffix:colon
r_return
id|rc
suffix:semicolon
)brace
DECL|function|llc_station_ac_report_status
r_int
id|llc_station_ac_report_status
c_func
(paren
r_struct
id|llc_station
op_star
id|station
comma
r_struct
id|llc_station_state_ev
op_star
id|ev
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_station_ack_tmr_callback
r_static
r_void
id|llc_station_ack_tmr_callback
c_func
(paren
r_int
r_int
id|timeout_data
)paren
(brace
r_struct
id|llc_station
op_star
id|station
op_assign
(paren
r_struct
id|llc_station
op_star
)paren
id|timeout_data
suffix:semicolon
r_struct
id|llc_station_state_ev
op_star
id|ev
suffix:semicolon
id|station-&gt;ack_tmr_running
op_assign
l_int|0
suffix:semicolon
id|ev
op_assign
id|llc_station_alloc_ev
c_func
(paren
id|station
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ev
)paren
(brace
id|ev-&gt;type
op_assign
id|LLC_STATION_EV_TYPE_ACK_TMR
suffix:semicolon
id|ev-&gt;data.tmr.timer_specific
op_assign
l_int|NULL
suffix:semicolon
id|llc_station_send_ev
c_func
(paren
id|station
comma
id|ev
)paren
suffix:semicolon
)brace
)brace
eof
