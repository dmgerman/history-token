multiline_comment|/*&n; * llc_evnt.c - LLC station component event match functions&n; * Description :&n; *   Functions in this module are implementation of station component events.&n; *   Details of events can be found in IEEE-802.2 standard document.&n; *   All functions have one station and one event as input argument. All of&n; *   them return 0 On success and 1 otherwise.&n; *&n; * Copyright (c) 1997 by Procom Technology, Inc.&n; * &t;&t; 2001 by Arnaldo Carvalho de Melo &lt;acme@conectiva.com.br&gt;&n; *&n; * This program can be redistributed or modified under the terms of the&n; * GNU General Public License as published by the Free Software Foundation.&n; * This program is distributed without any warranty or implied warranty&n; * of merchantability or fitness for a particular purpose.&n; *&n; * See the GNU General Public License for more details.&n; */
macro_line|#include &lt;linux/socket.h&gt;
macro_line|#include &lt;net/sock.h&gt;
macro_line|#include &lt;net/llc_if.h&gt;
macro_line|#include &lt;net/llc_main.h&gt;
macro_line|#include &lt;net/llc_evnt.h&gt;
macro_line|#include &lt;net/llc_pdu.h&gt;
DECL|function|llc_stat_ev_enable_with_dup_addr_check
r_int
id|llc_stat_ev_enable_with_dup_addr_check
c_func
(paren
r_struct
id|llc_station
op_star
id|station
comma
r_struct
id|llc_station_state_ev
op_star
id|ev
)paren
(brace
r_return
id|ev-&gt;type
op_eq
id|LLC_STATION_EV_TYPE_SIMPLE
op_logical_and
id|ev-&gt;data.a.ev
op_eq
id|LLC_STATION_EV_ENABLE_WITH_DUP_ADDR_CHECK
ques
c_cond
l_int|0
suffix:colon
l_int|1
suffix:semicolon
)brace
DECL|function|llc_stat_ev_enable_without_dup_addr_check
r_int
id|llc_stat_ev_enable_without_dup_addr_check
c_func
(paren
r_struct
id|llc_station
op_star
id|station
comma
r_struct
id|llc_station_state_ev
op_star
id|ev
)paren
(brace
r_return
id|ev-&gt;type
op_eq
id|LLC_STATION_EV_TYPE_SIMPLE
op_logical_and
id|ev-&gt;data.a.ev
op_eq
id|LLC_STATION_EV_ENABLE_WITHOUT_DUP_ADDR_CHECK
ques
c_cond
l_int|0
suffix:colon
l_int|1
suffix:semicolon
)brace
DECL|function|llc_stat_ev_ack_tmr_exp_lt_retry_cnt_max_retry
r_int
id|llc_stat_ev_ack_tmr_exp_lt_retry_cnt_max_retry
c_func
(paren
r_struct
id|llc_station
op_star
id|station
comma
r_struct
id|llc_station_state_ev
op_star
id|ev
)paren
(brace
r_return
id|ev-&gt;type
op_eq
id|LLC_STATION_EV_TYPE_ACK_TMR
op_logical_and
id|station-&gt;retry_count
OL
id|station-&gt;maximum_retry
ques
c_cond
l_int|0
suffix:colon
l_int|1
suffix:semicolon
)brace
DECL|function|llc_stat_ev_ack_tmr_exp_eq_retry_cnt_max_retry
r_int
id|llc_stat_ev_ack_tmr_exp_eq_retry_cnt_max_retry
c_func
(paren
r_struct
id|llc_station
op_star
id|station
comma
r_struct
id|llc_station_state_ev
op_star
id|ev
)paren
(brace
r_return
id|ev-&gt;type
op_eq
id|LLC_STATION_EV_TYPE_ACK_TMR
op_logical_and
id|station-&gt;retry_count
op_eq
id|station-&gt;maximum_retry
ques
c_cond
l_int|0
suffix:colon
l_int|1
suffix:semicolon
)brace
DECL|function|llc_stat_ev_rx_null_dsap_xid_c
r_int
id|llc_stat_ev_rx_null_dsap_xid_c
c_func
(paren
r_struct
id|llc_station
op_star
id|station
comma
r_struct
id|llc_station_state_ev
op_star
id|ev
)paren
(brace
id|llc_pdu_un_t
op_star
id|pdu
op_assign
(paren
id|llc_pdu_un_t
op_star
)paren
id|ev-&gt;data.pdu.skb-&gt;nh.raw
suffix:semicolon
r_return
id|ev-&gt;type
op_eq
id|LLC_STATION_EV_TYPE_PDU
op_logical_and
op_logical_neg
id|LLC_PDU_IS_CMD
c_func
(paren
id|pdu
)paren
op_logical_and
multiline_comment|/* command PDU */
op_logical_neg
id|LLC_PDU_TYPE_IS_U
c_func
(paren
id|pdu
)paren
op_logical_and
multiline_comment|/* U type PDU */
id|LLC_U_PDU_CMD
c_func
(paren
id|pdu
)paren
op_eq
id|LLC_1_PDU_CMD_XID
op_logical_and
op_logical_neg
id|pdu-&gt;dsap
ques
c_cond
l_int|0
suffix:colon
l_int|1
suffix:semicolon
multiline_comment|/* NULL DSAP value */
)brace
DECL|function|llc_stat_ev_rx_null_dsap_0_xid_r_xid_r_cnt_eq
r_int
id|llc_stat_ev_rx_null_dsap_0_xid_r_xid_r_cnt_eq
c_func
(paren
r_struct
id|llc_station
op_star
id|station
comma
r_struct
id|llc_station_state_ev
op_star
id|ev
)paren
(brace
id|llc_pdu_un_t
op_star
id|pdu
op_assign
(paren
id|llc_pdu_un_t
op_star
)paren
id|ev-&gt;data.pdu.skb-&gt;nh.raw
suffix:semicolon
r_return
id|ev-&gt;type
op_eq
id|LLC_STATION_EV_TYPE_PDU
op_logical_and
op_logical_neg
id|LLC_PDU_IS_RSP
c_func
(paren
id|pdu
)paren
op_logical_and
multiline_comment|/* response PDU */
op_logical_neg
id|LLC_PDU_TYPE_IS_U
c_func
(paren
id|pdu
)paren
op_logical_and
multiline_comment|/* U type PDU */
id|LLC_U_PDU_RSP
c_func
(paren
id|pdu
)paren
op_eq
id|LLC_1_PDU_CMD_XID
op_logical_and
op_logical_neg
id|pdu-&gt;dsap
op_logical_and
multiline_comment|/* NULL DSAP value */
op_logical_neg
id|station-&gt;xid_r_count
ques
c_cond
l_int|0
suffix:colon
l_int|1
suffix:semicolon
)brace
DECL|function|llc_stat_ev_rx_null_dsap_1_xid_r_xid_r_cnt_eq
r_int
id|llc_stat_ev_rx_null_dsap_1_xid_r_xid_r_cnt_eq
c_func
(paren
r_struct
id|llc_station
op_star
id|station
comma
r_struct
id|llc_station_state_ev
op_star
id|ev
)paren
(brace
id|llc_pdu_un_t
op_star
id|pdu
op_assign
(paren
id|llc_pdu_un_t
op_star
)paren
id|ev-&gt;data.pdu.skb-&gt;nh.raw
suffix:semicolon
r_return
id|ev-&gt;type
op_eq
id|LLC_STATION_EV_TYPE_PDU
op_logical_and
op_logical_neg
id|LLC_PDU_IS_RSP
c_func
(paren
id|pdu
)paren
op_logical_and
multiline_comment|/* response PDU */
op_logical_neg
id|LLC_PDU_TYPE_IS_U
c_func
(paren
id|pdu
)paren
op_logical_and
multiline_comment|/* U type PDU */
id|LLC_U_PDU_RSP
c_func
(paren
id|pdu
)paren
op_eq
id|LLC_1_PDU_CMD_XID
op_logical_and
op_logical_neg
id|pdu-&gt;dsap
op_logical_and
multiline_comment|/* NULL DSAP value */
id|station-&gt;xid_r_count
op_eq
l_int|1
ques
c_cond
l_int|0
suffix:colon
l_int|1
suffix:semicolon
)brace
DECL|function|llc_stat_ev_rx_null_dsap_test_c
r_int
id|llc_stat_ev_rx_null_dsap_test_c
c_func
(paren
r_struct
id|llc_station
op_star
id|station
comma
r_struct
id|llc_station_state_ev
op_star
id|ev
)paren
(brace
id|llc_pdu_un_t
op_star
id|pdu
op_assign
(paren
id|llc_pdu_un_t
op_star
)paren
id|ev-&gt;data.pdu.skb-&gt;nh.raw
suffix:semicolon
r_return
id|ev-&gt;type
op_eq
id|LLC_STATION_EV_TYPE_PDU
op_logical_and
op_logical_neg
id|LLC_PDU_IS_CMD
c_func
(paren
id|pdu
)paren
op_logical_and
multiline_comment|/* command PDU */
op_logical_neg
id|LLC_PDU_TYPE_IS_U
c_func
(paren
id|pdu
)paren
op_logical_and
multiline_comment|/* U type PDU */
id|LLC_U_PDU_CMD
c_func
(paren
id|pdu
)paren
op_eq
id|LLC_1_PDU_CMD_TEST
op_logical_and
op_logical_neg
id|pdu-&gt;dsap
ques
c_cond
l_int|0
suffix:colon
l_int|1
suffix:semicolon
multiline_comment|/* NULL DSAP */
)brace
DECL|function|llc_stat_ev_disable_req
r_int
id|llc_stat_ev_disable_req
c_func
(paren
r_struct
id|llc_station
op_star
id|station
comma
r_struct
id|llc_station_state_ev
op_star
id|ev
)paren
(brace
r_return
id|ev-&gt;type
op_eq
id|LLC_STATION_EV_TYPE_PRIM
op_logical_and
id|ev-&gt;data.prim.prim
op_eq
id|LLC_DISABLE_PRIM
op_logical_and
id|ev-&gt;data.prim.type
op_eq
id|LLC_PRIM_TYPE_REQ
ques
c_cond
l_int|0
suffix:colon
l_int|1
suffix:semicolon
)brace
eof
