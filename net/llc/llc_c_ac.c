multiline_comment|/*&n; * llc_c_ac.c - actions performed during connection state transition.&n; *&n; * Description:&n; *   Functions in this module are implementation of connection component actions&n; *   Details of actions can be found in IEEE-802.2 standard document.&n; *   All functions have one connection and one event as input argument. All of&n; *   them return 0 On success and 1 otherwise.&n; *&n; * Copyright (c) 1997 by Procom Technology, Inc.&n; * &t;&t; 2001 by Arnaldo Carvalho de Melo &lt;acme@conectiva.com.br&gt;&n; *&n; * This program can be redistributed or modified under the terms of the&n; * GNU General Public License as published by the Free Software Foundation.&n; * This program is distributed without any warranty or implied warranty&n; * of merchantability or fitness for a particular purpose.&n; *&n; * See the GNU General Public License for more details.&n; */
macro_line|#include &lt;linux/netdevice.h&gt;
macro_line|#include &lt;net/llc_conn.h&gt;
macro_line|#include &lt;net/llc_sap.h&gt;
macro_line|#include &lt;net/sock.h&gt;
macro_line|#include &lt;net/llc_main.h&gt;
macro_line|#include &lt;net/llc_c_ev.h&gt;
macro_line|#include &lt;net/llc_c_ac.h&gt;
macro_line|#include &lt;net/llc_c_st.h&gt;
macro_line|#include &lt;net/llc_pdu.h&gt;
macro_line|#include &lt;net/llc_mac.h&gt;
r_static
r_void
id|llc_conn_pf_cycle_tmr_cb
c_func
(paren
r_int
r_int
id|timeout_data
)paren
suffix:semicolon
r_static
r_void
id|llc_conn_ack_tmr_cb
c_func
(paren
r_int
r_int
id|timeout_data
)paren
suffix:semicolon
r_static
r_void
id|llc_conn_rej_tmr_cb
c_func
(paren
r_int
r_int
id|timeout_data
)paren
suffix:semicolon
r_static
r_void
id|llc_conn_busy_tmr_cb
c_func
(paren
r_int
r_int
id|timeout_data
)paren
suffix:semicolon
r_static
r_int
id|llc_conn_ac_inc_vs_by_1
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
suffix:semicolon
r_static
r_void
id|llc_process_tmr_ev
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
suffix:semicolon
r_static
r_int
id|llc_conn_ac_data_confirm
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
suffix:semicolon
DECL|macro|INCORRECT
mdefine_line|#define INCORRECT 0
DECL|function|llc_conn_ac_clear_remote_busy
r_int
id|llc_conn_ac_clear_remote_busy
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
r_if
c_cond
(paren
id|llc-&gt;remote_busy_flag
)paren
(brace
id|u8
id|nr
suffix:semicolon
id|llc_pdu_sn_t
op_star
id|rx_pdu
op_assign
(paren
id|llc_pdu_sn_t
op_star
)paren
id|ev-&gt;data.pdu.skb-&gt;nh.raw
suffix:semicolon
id|llc-&gt;remote_busy_flag
op_assign
l_int|0
suffix:semicolon
id|del_timer
c_func
(paren
op_amp
id|llc-&gt;busy_state_timer.timer
)paren
suffix:semicolon
id|llc-&gt;busy_state_timer.running
op_assign
l_int|0
suffix:semicolon
id|nr
op_assign
id|LLC_I_GET_NR
c_func
(paren
id|rx_pdu
)paren
suffix:semicolon
id|llc_conn_resend_i_pdu_as_cmd
c_func
(paren
id|sk
comma
id|nr
comma
l_int|0
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_conn_ind
r_int
id|llc_conn_ac_conn_ind
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_int
id|rc
op_assign
l_int|1
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|ev-&gt;data.pdu.skb
suffix:semicolon
r_union
id|llc_u_prim_data
op_star
id|prim_data
op_assign
id|llc_ind_prim.data
suffix:semicolon
r_struct
id|llc_prim_if_block
op_star
id|prim
op_assign
op_amp
id|llc_ind_prim
suffix:semicolon
r_struct
id|llc_sap
op_star
id|sap
suffix:semicolon
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
id|llc_pdu_decode_dsap
c_func
(paren
id|skb
comma
op_amp
id|prim_data-&gt;conn.daddr.lsap
)paren
suffix:semicolon
id|sap
op_assign
id|llc_sap_find
c_func
(paren
id|prim_data-&gt;conn.daddr.lsap
)paren
suffix:semicolon
r_if
c_cond
(paren
id|sap
)paren
(brace
id|llc_pdu_decode_sa
c_func
(paren
id|skb
comma
id|llc-&gt;daddr.mac
)paren
suffix:semicolon
id|llc_pdu_decode_da
c_func
(paren
id|skb
comma
id|llc-&gt;laddr.mac
)paren
suffix:semicolon
id|llc-&gt;dev
op_assign
id|skb-&gt;dev
suffix:semicolon
id|prim_data-&gt;conn.pri
op_assign
l_int|0
suffix:semicolon
id|prim_data-&gt;conn.sk
op_assign
id|sk
suffix:semicolon
id|prim_data-&gt;conn.dev
op_assign
id|skb-&gt;dev
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|prim_data-&gt;conn.daddr
comma
op_amp
id|llc-&gt;laddr
comma
r_sizeof
(paren
id|llc-&gt;laddr
)paren
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|prim_data-&gt;conn.saddr
comma
op_amp
id|llc-&gt;daddr
comma
r_sizeof
(paren
id|llc-&gt;daddr
)paren
)paren
suffix:semicolon
id|prim-&gt;data
op_assign
id|prim_data
suffix:semicolon
id|prim-&gt;prim
op_assign
id|LLC_CONN_PRIM
suffix:semicolon
id|prim-&gt;sap
op_assign
id|llc-&gt;sap
suffix:semicolon
id|ev-&gt;flag
op_assign
l_int|1
suffix:semicolon
id|ev-&gt;ind_prim
op_assign
id|prim
suffix:semicolon
id|rc
op_assign
l_int|0
suffix:semicolon
)brace
r_return
id|rc
suffix:semicolon
)brace
DECL|function|llc_conn_ac_conn_confirm
r_int
id|llc_conn_ac_conn_confirm
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_union
id|llc_u_prim_data
op_star
id|prim_data
op_assign
id|llc_cfm_prim.data
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|ev-&gt;data.pdu.skb
suffix:semicolon
multiline_comment|/* FIXME: wtf, this is global, so the whole thing is really&n;&t; *&t;  non reentrant...&n;&t; */
r_struct
id|llc_prim_if_block
op_star
id|prim
op_assign
op_amp
id|llc_cfm_prim
suffix:semicolon
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
r_struct
id|llc_sap
op_star
id|sap
op_assign
id|llc-&gt;sap
suffix:semicolon
id|prim_data-&gt;conn.sk
op_assign
id|sk
suffix:semicolon
id|prim_data-&gt;conn.pri
op_assign
l_int|0
suffix:semicolon
id|prim_data-&gt;conn.status
op_assign
id|ev-&gt;status
suffix:semicolon
id|prim_data-&gt;conn.link
op_assign
id|llc-&gt;link
suffix:semicolon
r_if
c_cond
(paren
id|skb
)paren
id|prim_data-&gt;conn.dev
op_assign
id|skb-&gt;dev
suffix:semicolon
r_else
id|printk
c_func
(paren
id|KERN_ERR
id|__FUNCTION__
l_string|&quot;ev-&gt;data.pdu.skb == NULL&bslash;n&quot;
)paren
suffix:semicolon
id|prim-&gt;data
op_assign
id|prim_data
suffix:semicolon
id|prim-&gt;prim
op_assign
id|LLC_CONN_PRIM
suffix:semicolon
id|prim-&gt;sap
op_assign
id|sap
suffix:semicolon
id|ev-&gt;flag
op_assign
l_int|1
suffix:semicolon
id|ev-&gt;cfm_prim
op_assign
id|prim
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_data_confirm
r_static
r_int
id|llc_conn_ac_data_confirm
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_struct
id|llc_prim_if_block
op_star
id|prim
op_assign
op_amp
id|llc_cfm_prim
suffix:semicolon
r_union
id|llc_u_prim_data
op_star
id|prim_data
op_assign
id|llc_cfm_prim.data
suffix:semicolon
id|prim_data-&gt;data.sk
op_assign
id|sk
suffix:semicolon
id|prim_data-&gt;data.pri
op_assign
l_int|0
suffix:semicolon
id|prim_data-&gt;data.link
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|link
suffix:semicolon
id|prim_data-&gt;data.status
op_assign
id|LLC_STATUS_RECEIVED
suffix:semicolon
id|prim_data-&gt;data.skb
op_assign
l_int|NULL
suffix:semicolon
id|prim-&gt;data
op_assign
id|prim_data
suffix:semicolon
id|prim-&gt;prim
op_assign
id|LLC_DATA_PRIM
suffix:semicolon
id|prim-&gt;sap
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|sap
suffix:semicolon
id|ev-&gt;flag
op_assign
l_int|1
suffix:semicolon
id|ev-&gt;cfm_prim
op_assign
id|prim
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_data_ind
r_int
id|llc_conn_ac_data_ind
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|llc_conn_rtn_pdu
c_func
(paren
id|sk
comma
id|ev-&gt;data.pdu.skb
comma
id|ev
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_disc_ind
r_int
id|llc_conn_ac_disc_ind
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|u8
id|reason
op_assign
l_int|0
suffix:semicolon
r_int
id|rc
op_assign
l_int|1
suffix:semicolon
r_union
id|llc_u_prim_data
op_star
id|prim_data
op_assign
id|llc_ind_prim.data
suffix:semicolon
r_struct
id|llc_prim_if_block
op_star
id|prim
op_assign
op_amp
id|llc_ind_prim
suffix:semicolon
r_if
c_cond
(paren
id|ev-&gt;type
op_eq
id|LLC_CONN_EV_TYPE_PDU
)paren
(brace
id|llc_pdu_un_t
op_star
id|rx_pdu
op_assign
(paren
id|llc_pdu_un_t
op_star
)paren
id|ev-&gt;data.pdu.skb-&gt;nh.raw
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|LLC_PDU_IS_RSP
c_func
(paren
id|rx_pdu
)paren
op_logical_and
op_logical_neg
id|LLC_PDU_TYPE_IS_U
c_func
(paren
id|rx_pdu
)paren
op_logical_and
id|LLC_U_PDU_RSP
c_func
(paren
id|rx_pdu
)paren
op_eq
id|LLC_2_PDU_RSP_DM
)paren
(brace
id|reason
op_assign
id|LLC_DISC_REASON_RX_DM_RSP_PDU
suffix:semicolon
id|rc
op_assign
l_int|0
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|LLC_PDU_IS_CMD
c_func
(paren
id|rx_pdu
)paren
op_logical_and
op_logical_neg
id|LLC_PDU_TYPE_IS_U
c_func
(paren
id|rx_pdu
)paren
op_logical_and
id|LLC_U_PDU_CMD
c_func
(paren
id|rx_pdu
)paren
op_eq
id|LLC_2_PDU_CMD_DISC
)paren
(brace
id|reason
op_assign
id|LLC_DISC_REASON_RX_DISC_CMD_PDU
suffix:semicolon
id|rc
op_assign
l_int|0
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|ev-&gt;type
op_eq
id|LLC_CONN_EV_TYPE_ACK_TMR
)paren
(brace
id|reason
op_assign
id|LLC_DISC_REASON_ACK_TMR_EXP
suffix:semicolon
id|rc
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|reason
op_assign
l_int|0
suffix:semicolon
id|rc
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|rc
)paren
(brace
id|prim_data-&gt;disc.sk
op_assign
id|sk
suffix:semicolon
id|prim_data-&gt;disc.reason
op_assign
id|reason
suffix:semicolon
id|prim_data-&gt;disc.link
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|link
suffix:semicolon
id|prim-&gt;data
op_assign
id|prim_data
suffix:semicolon
id|prim-&gt;prim
op_assign
id|LLC_DISC_PRIM
suffix:semicolon
id|prim-&gt;sap
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|sap
suffix:semicolon
id|ev-&gt;flag
op_assign
l_int|1
suffix:semicolon
id|ev-&gt;ind_prim
op_assign
id|prim
suffix:semicolon
)brace
r_return
id|rc
suffix:semicolon
)brace
DECL|function|llc_conn_ac_disc_confirm
r_int
id|llc_conn_ac_disc_confirm
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_union
id|llc_u_prim_data
op_star
id|prim_data
op_assign
id|llc_cfm_prim.data
suffix:semicolon
r_struct
id|llc_prim_if_block
op_star
id|prim
op_assign
op_amp
id|llc_cfm_prim
suffix:semicolon
id|prim_data-&gt;disc.sk
op_assign
id|sk
suffix:semicolon
id|prim_data-&gt;disc.reason
op_assign
id|ev-&gt;status
suffix:semicolon
id|prim_data-&gt;disc.link
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|link
suffix:semicolon
id|prim-&gt;data
op_assign
id|prim_data
suffix:semicolon
id|prim-&gt;prim
op_assign
id|LLC_DISC_PRIM
suffix:semicolon
id|prim-&gt;sap
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|sap
suffix:semicolon
id|ev-&gt;flag
op_assign
l_int|1
suffix:semicolon
id|ev-&gt;cfm_prim
op_assign
id|prim
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_rst_ind
r_int
id|llc_conn_ac_rst_ind
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|u8
id|reason
op_assign
l_int|0
suffix:semicolon
r_int
id|rc
op_assign
l_int|1
suffix:semicolon
id|llc_pdu_un_t
op_star
id|rx_pdu
op_assign
(paren
id|llc_pdu_un_t
op_star
)paren
id|ev-&gt;data.pdu.skb-&gt;nh.raw
suffix:semicolon
r_union
id|llc_u_prim_data
op_star
id|prim_data
op_assign
id|llc_ind_prim.data
suffix:semicolon
r_struct
id|llc_prim_if_block
op_star
id|prim
op_assign
op_amp
id|llc_ind_prim
suffix:semicolon
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|ev-&gt;type
)paren
(brace
r_case
id|LLC_CONN_EV_TYPE_PDU
suffix:colon
r_if
c_cond
(paren
op_logical_neg
id|LLC_PDU_IS_RSP
c_func
(paren
id|rx_pdu
)paren
op_logical_and
op_logical_neg
id|LLC_PDU_TYPE_IS_U
c_func
(paren
id|rx_pdu
)paren
op_logical_and
id|LLC_U_PDU_RSP
c_func
(paren
id|rx_pdu
)paren
op_eq
id|LLC_2_PDU_RSP_FRMR
)paren
(brace
id|reason
op_assign
id|LLC_RESET_REASON_LOCAL
suffix:semicolon
id|rc
op_assign
l_int|0
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|LLC_PDU_IS_CMD
c_func
(paren
id|rx_pdu
)paren
op_logical_and
op_logical_neg
id|LLC_PDU_TYPE_IS_U
c_func
(paren
id|rx_pdu
)paren
op_logical_and
id|LLC_U_PDU_CMD
c_func
(paren
id|rx_pdu
)paren
op_eq
id|LLC_2_PDU_CMD_SABME
)paren
(brace
id|reason
op_assign
id|LLC_RESET_REASON_REMOTE
suffix:semicolon
id|rc
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|reason
op_assign
l_int|0
suffix:semicolon
id|rc
op_assign
l_int|1
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|LLC_CONN_EV_TYPE_ACK_TMR
suffix:colon
r_case
id|LLC_CONN_EV_TYPE_P_TMR
suffix:colon
r_case
id|LLC_CONN_EV_TYPE_REJ_TMR
suffix:colon
r_case
id|LLC_CONN_EV_TYPE_BUSY_TMR
suffix:colon
r_if
c_cond
(paren
id|llc-&gt;retry_count
OG
id|llc-&gt;n2
)paren
(brace
id|reason
op_assign
id|LLC_RESET_REASON_LOCAL
suffix:semicolon
id|rc
op_assign
l_int|0
suffix:semicolon
)brace
r_else
id|rc
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|rc
)paren
(brace
id|prim_data-&gt;res.sk
op_assign
id|sk
suffix:semicolon
id|prim_data-&gt;res.reason
op_assign
id|reason
suffix:semicolon
id|prim_data-&gt;res.link
op_assign
id|llc-&gt;link
suffix:semicolon
id|prim-&gt;data
op_assign
id|prim_data
suffix:semicolon
id|prim-&gt;prim
op_assign
id|LLC_RESET_PRIM
suffix:semicolon
id|prim-&gt;sap
op_assign
id|llc-&gt;sap
suffix:semicolon
id|ev-&gt;flag
op_assign
l_int|1
suffix:semicolon
id|ev-&gt;ind_prim
op_assign
id|prim
suffix:semicolon
)brace
r_return
id|rc
suffix:semicolon
)brace
DECL|function|llc_conn_ac_rst_confirm
r_int
id|llc_conn_ac_rst_confirm
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_union
id|llc_u_prim_data
op_star
id|prim_data
op_assign
id|llc_cfm_prim.data
suffix:semicolon
r_struct
id|llc_prim_if_block
op_star
id|prim
op_assign
op_amp
id|llc_cfm_prim
suffix:semicolon
id|prim_data-&gt;res.sk
op_assign
id|sk
suffix:semicolon
id|prim_data-&gt;res.link
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|link
suffix:semicolon
id|prim-&gt;data
op_assign
id|prim_data
suffix:semicolon
id|prim-&gt;prim
op_assign
id|LLC_RESET_PRIM
suffix:semicolon
id|prim-&gt;sap
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|sap
suffix:semicolon
id|ev-&gt;flag
op_assign
l_int|1
suffix:semicolon
id|ev-&gt;cfm_prim
op_assign
id|prim
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_report_status
r_int
id|llc_conn_ac_report_status
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_clear_remote_busy_if_f_eq_1
r_int
id|llc_conn_ac_clear_remote_busy_if_f_eq_1
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|llc_pdu_sn_t
op_star
id|rx_pdu
op_assign
(paren
id|llc_pdu_sn_t
op_star
)paren
id|ev-&gt;data.pdu.skb-&gt;nh.raw
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|LLC_PDU_IS_RSP
c_func
(paren
id|rx_pdu
)paren
op_logical_and
op_logical_neg
id|LLC_PDU_TYPE_IS_I
c_func
(paren
id|rx_pdu
)paren
op_logical_and
op_logical_neg
id|LLC_I_PF_IS_1
c_func
(paren
id|rx_pdu
)paren
op_logical_and
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|ack_pf
)paren
id|llc_conn_ac_clear_remote_busy
c_func
(paren
id|sk
comma
id|ev
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_stop_rej_tmr_if_data_flag_eq_2
r_int
id|llc_conn_ac_stop_rej_tmr_if_data_flag_eq_2
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_if
c_cond
(paren
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|data_flag
op_eq
l_int|2
)paren
(brace
id|del_timer
c_func
(paren
op_amp
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|rej_sent_timer.timer
)paren
suffix:semicolon
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|rej_sent_timer.running
op_assign
l_int|0
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_send_disc_cmd_p_set_x
r_int
id|llc_conn_ac_send_disc_cmd_p_set_x
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_int
id|rc
op_assign
l_int|1
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|llc_alloc_frame
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb
)paren
(brace
id|u8
id|p_bit
op_assign
l_int|1
suffix:semicolon
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
r_struct
id|llc_sap
op_star
id|sap
op_assign
id|llc-&gt;sap
suffix:semicolon
id|skb-&gt;dev
op_assign
id|llc-&gt;dev
suffix:semicolon
id|llc_pdu_header_init
c_func
(paren
id|skb
comma
id|LLC_PDU_TYPE_U
comma
id|sap-&gt;laddr.lsap
comma
id|llc-&gt;daddr.lsap
comma
id|LLC_PDU_CMD
)paren
suffix:semicolon
id|llc_pdu_init_as_disc_cmd
c_func
(paren
id|skb
comma
id|p_bit
)paren
suffix:semicolon
id|lan_hdrs_init
c_func
(paren
id|skb
comma
id|llc-&gt;dev-&gt;dev_addr
comma
id|llc-&gt;daddr.mac
)paren
suffix:semicolon
id|rc
op_assign
l_int|0
suffix:semicolon
id|llc_conn_send_pdu
c_func
(paren
id|sk
comma
id|skb
)paren
suffix:semicolon
)brace
id|llc_conn_ac_set_p_flag_1
c_func
(paren
id|sk
comma
id|ev
)paren
suffix:semicolon
r_return
id|rc
suffix:semicolon
)brace
DECL|function|llc_conn_ac_send_dm_rsp_f_set_p
r_int
id|llc_conn_ac_send_dm_rsp_f_set_p
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_int
id|rc
op_assign
l_int|1
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|llc_alloc_frame
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb
)paren
(brace
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
r_struct
id|llc_sap
op_star
id|sap
op_assign
id|llc-&gt;sap
suffix:semicolon
r_struct
id|sk_buff
op_star
id|rx_skb
op_assign
id|ev-&gt;data.pdu.skb
suffix:semicolon
id|u8
id|f_bit
suffix:semicolon
id|skb-&gt;dev
op_assign
id|llc-&gt;dev
suffix:semicolon
id|llc_pdu_decode_pf_bit
c_func
(paren
id|rx_skb
comma
op_amp
id|f_bit
)paren
suffix:semicolon
id|llc_pdu_header_init
c_func
(paren
id|skb
comma
id|LLC_PDU_TYPE_U
comma
id|sap-&gt;laddr.lsap
comma
id|llc-&gt;daddr.lsap
comma
id|LLC_PDU_RSP
)paren
suffix:semicolon
id|llc_pdu_init_as_dm_rsp
c_func
(paren
id|skb
comma
id|f_bit
)paren
suffix:semicolon
id|lan_hdrs_init
c_func
(paren
id|skb
comma
id|llc-&gt;dev-&gt;dev_addr
comma
id|llc-&gt;daddr.mac
)paren
suffix:semicolon
id|rc
op_assign
l_int|0
suffix:semicolon
id|llc_conn_send_pdu
c_func
(paren
id|sk
comma
id|skb
)paren
suffix:semicolon
)brace
r_return
id|rc
suffix:semicolon
)brace
DECL|function|llc_conn_ac_send_dm_rsp_f_set_1
r_int
id|llc_conn_ac_send_dm_rsp_f_set_1
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_int
id|rc
op_assign
l_int|1
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|llc_alloc_frame
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb
)paren
(brace
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
r_struct
id|llc_sap
op_star
id|sap
op_assign
id|llc-&gt;sap
suffix:semicolon
id|u8
id|f_bit
op_assign
l_int|1
suffix:semicolon
id|skb-&gt;dev
op_assign
id|llc-&gt;dev
suffix:semicolon
id|llc_pdu_header_init
c_func
(paren
id|skb
comma
id|LLC_PDU_TYPE_U
comma
id|sap-&gt;laddr.lsap
comma
id|llc-&gt;daddr.lsap
comma
id|LLC_PDU_RSP
)paren
suffix:semicolon
id|llc_pdu_init_as_dm_rsp
c_func
(paren
id|skb
comma
id|f_bit
)paren
suffix:semicolon
id|lan_hdrs_init
c_func
(paren
id|skb
comma
id|llc-&gt;dev-&gt;dev_addr
comma
id|llc-&gt;daddr.mac
)paren
suffix:semicolon
id|rc
op_assign
l_int|0
suffix:semicolon
id|llc_conn_send_pdu
c_func
(paren
id|sk
comma
id|skb
)paren
suffix:semicolon
)brace
r_return
id|rc
suffix:semicolon
)brace
DECL|function|llc_conn_ac_send_dm_rsp_f_set_f_flag
r_int
id|llc_conn_ac_send_dm_rsp_f_set_f_flag
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_int
id|rc
op_assign
l_int|1
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|llc_alloc_frame
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb
)paren
(brace
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
r_struct
id|llc_sap
op_star
id|sap
op_assign
id|llc-&gt;sap
suffix:semicolon
id|u8
id|f_bit
op_assign
id|llc-&gt;f_flag
suffix:semicolon
id|skb-&gt;dev
op_assign
id|llc-&gt;dev
suffix:semicolon
id|llc_pdu_header_init
c_func
(paren
id|skb
comma
id|LLC_PDU_TYPE_U
comma
id|sap-&gt;laddr.lsap
comma
id|llc-&gt;daddr.lsap
comma
id|LLC_PDU_RSP
)paren
suffix:semicolon
id|llc_pdu_init_as_dm_rsp
c_func
(paren
id|skb
comma
id|f_bit
)paren
suffix:semicolon
id|lan_hdrs_init
c_func
(paren
id|skb
comma
id|llc-&gt;dev-&gt;dev_addr
comma
id|llc-&gt;daddr.mac
)paren
suffix:semicolon
id|rc
op_assign
l_int|0
suffix:semicolon
id|llc_conn_send_pdu
c_func
(paren
id|sk
comma
id|skb
)paren
suffix:semicolon
)brace
r_return
id|rc
suffix:semicolon
)brace
DECL|function|llc_conn_ac_send_frmr_rsp_f_set_x
r_int
id|llc_conn_ac_send_frmr_rsp_f_set_x
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|u8
id|f_bit
suffix:semicolon
r_int
id|rc
op_assign
l_int|1
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
comma
op_star
id|ev_skb
op_assign
id|ev-&gt;data.pdu.skb
suffix:semicolon
id|llc_pdu_sn_t
op_star
id|rx_pdu
op_assign
(paren
id|llc_pdu_sn_t
op_star
)paren
id|ev_skb-&gt;nh.raw
suffix:semicolon
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
id|llc-&gt;rx_pdu_hdr
op_assign
(paren
id|u32
)paren
op_star
(paren
(paren
id|u32
op_star
)paren
id|rx_pdu
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|LLC_PDU_IS_CMD
c_func
(paren
id|rx_pdu
)paren
)paren
id|llc_pdu_decode_pf_bit
c_func
(paren
id|ev_skb
comma
op_amp
id|f_bit
)paren
suffix:semicolon
r_else
id|f_bit
op_assign
l_int|0
suffix:semicolon
id|skb
op_assign
id|llc_alloc_frame
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb
)paren
(brace
r_struct
id|llc_sap
op_star
id|sap
op_assign
id|llc-&gt;sap
suffix:semicolon
id|skb-&gt;dev
op_assign
id|llc-&gt;dev
suffix:semicolon
id|llc_pdu_header_init
c_func
(paren
id|skb
comma
id|LLC_PDU_TYPE_U
comma
id|sap-&gt;laddr.lsap
comma
id|llc-&gt;daddr.lsap
comma
id|LLC_PDU_RSP
)paren
suffix:semicolon
id|llc_pdu_init_as_frmr_rsp
c_func
(paren
id|skb
comma
id|rx_pdu
comma
id|f_bit
comma
id|llc-&gt;vS
comma
id|llc-&gt;vR
comma
id|INCORRECT
)paren
suffix:semicolon
id|lan_hdrs_init
c_func
(paren
id|skb
comma
id|llc-&gt;dev-&gt;dev_addr
comma
id|llc-&gt;daddr.mac
)paren
suffix:semicolon
id|rc
op_assign
l_int|0
suffix:semicolon
id|llc_conn_send_pdu
c_func
(paren
id|sk
comma
id|skb
)paren
suffix:semicolon
)brace
r_return
id|rc
suffix:semicolon
)brace
DECL|function|llc_conn_ac_resend_frmr_rsp_f_set_0
r_int
id|llc_conn_ac_resend_frmr_rsp_f_set_0
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_int
id|rc
op_assign
l_int|1
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|llc_alloc_frame
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb
)paren
(brace
id|u8
id|f_bit
op_assign
l_int|0
suffix:semicolon
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
r_struct
id|llc_sap
op_star
id|sap
op_assign
id|llc-&gt;sap
suffix:semicolon
id|llc_pdu_sn_t
op_star
id|rx_pdu
op_assign
(paren
id|llc_pdu_sn_t
op_star
)paren
op_amp
id|llc-&gt;rx_pdu_hdr
suffix:semicolon
id|skb-&gt;dev
op_assign
id|llc-&gt;dev
suffix:semicolon
id|llc_pdu_header_init
c_func
(paren
id|skb
comma
id|LLC_PDU_TYPE_U
comma
id|sap-&gt;laddr.lsap
comma
id|llc-&gt;daddr.lsap
comma
id|LLC_PDU_RSP
)paren
suffix:semicolon
id|llc_pdu_init_as_frmr_rsp
c_func
(paren
id|skb
comma
id|rx_pdu
comma
id|f_bit
comma
id|llc-&gt;vS
comma
id|llc-&gt;vR
comma
id|INCORRECT
)paren
suffix:semicolon
id|lan_hdrs_init
c_func
(paren
id|skb
comma
id|llc-&gt;dev-&gt;dev_addr
comma
id|llc-&gt;daddr.mac
)paren
suffix:semicolon
id|rc
op_assign
l_int|0
suffix:semicolon
id|llc_conn_send_pdu
c_func
(paren
id|sk
comma
id|skb
)paren
suffix:semicolon
)brace
r_return
id|rc
suffix:semicolon
)brace
DECL|function|llc_conn_ac_resend_frmr_rsp_f_set_p
r_int
id|llc_conn_ac_resend_frmr_rsp_f_set_p
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|u8
id|f_bit
suffix:semicolon
r_int
id|rc
op_assign
l_int|1
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|llc_pdu_decode_pf_bit
c_func
(paren
id|ev-&gt;data.pdu.skb
comma
op_amp
id|f_bit
)paren
suffix:semicolon
id|skb
op_assign
id|llc_alloc_frame
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb
)paren
(brace
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
r_struct
id|llc_sap
op_star
id|sap
op_assign
id|llc-&gt;sap
suffix:semicolon
id|llc_pdu_sn_t
op_star
id|rx_pdu
op_assign
(paren
id|llc_pdu_sn_t
op_star
)paren
id|ev-&gt;data.pdu.skb-&gt;nh.raw
suffix:semicolon
id|skb-&gt;dev
op_assign
id|llc-&gt;dev
suffix:semicolon
id|llc_pdu_header_init
c_func
(paren
id|skb
comma
id|LLC_PDU_TYPE_U
comma
id|sap-&gt;laddr.lsap
comma
id|llc-&gt;daddr.lsap
comma
id|LLC_PDU_RSP
)paren
suffix:semicolon
id|llc_pdu_init_as_frmr_rsp
c_func
(paren
id|skb
comma
id|rx_pdu
comma
id|f_bit
comma
id|llc-&gt;vS
comma
id|llc-&gt;vR
comma
id|INCORRECT
)paren
suffix:semicolon
id|lan_hdrs_init
c_func
(paren
id|skb
comma
id|llc-&gt;dev-&gt;dev_addr
comma
id|llc-&gt;daddr.mac
)paren
suffix:semicolon
id|rc
op_assign
l_int|0
suffix:semicolon
id|llc_conn_send_pdu
c_func
(paren
id|sk
comma
id|skb
)paren
suffix:semicolon
)brace
r_return
id|rc
suffix:semicolon
)brace
DECL|function|llc_conn_ac_send_i_cmd_p_set_1
r_int
id|llc_conn_ac_send_i_cmd_p_set_1
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|u8
id|p_bit
op_assign
l_int|1
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|ev-&gt;data.prim.data-&gt;data-&gt;data.skb
suffix:semicolon
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
r_struct
id|llc_sap
op_star
id|sap
op_assign
id|llc-&gt;sap
suffix:semicolon
id|llc_pdu_header_init
c_func
(paren
id|skb
comma
id|LLC_PDU_TYPE_I
comma
id|sap-&gt;laddr.lsap
comma
id|llc-&gt;daddr.lsap
comma
id|LLC_PDU_CMD
)paren
suffix:semicolon
id|llc_pdu_init_as_i_cmd
c_func
(paren
id|skb
comma
id|p_bit
comma
id|llc-&gt;vS
comma
id|llc-&gt;vR
)paren
suffix:semicolon
id|lan_hdrs_init
c_func
(paren
id|skb
comma
id|llc-&gt;dev-&gt;dev_addr
comma
id|llc-&gt;daddr.mac
)paren
suffix:semicolon
id|llc_conn_send_pdu
c_func
(paren
id|sk
comma
id|skb
)paren
suffix:semicolon
id|llc_conn_ac_inc_vs_by_1
c_func
(paren
id|sk
comma
id|ev
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_send_i_cmd_p_set_0
r_int
id|llc_conn_ac_send_i_cmd_p_set_0
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|u8
id|p_bit
op_assign
l_int|0
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|ev-&gt;data.prim.data-&gt;data-&gt;data.skb
suffix:semicolon
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
r_struct
id|llc_sap
op_star
id|sap
op_assign
id|llc-&gt;sap
suffix:semicolon
id|llc_pdu_header_init
c_func
(paren
id|skb
comma
id|LLC_PDU_TYPE_I
comma
id|sap-&gt;laddr.lsap
comma
id|llc-&gt;daddr.lsap
comma
id|LLC_PDU_CMD
)paren
suffix:semicolon
id|llc_pdu_init_as_i_cmd
c_func
(paren
id|skb
comma
id|p_bit
comma
id|llc-&gt;vS
comma
id|llc-&gt;vR
)paren
suffix:semicolon
id|lan_hdrs_init
c_func
(paren
id|skb
comma
id|llc-&gt;dev-&gt;dev_addr
comma
id|llc-&gt;daddr.mac
)paren
suffix:semicolon
id|llc_conn_send_pdu
c_func
(paren
id|sk
comma
id|skb
)paren
suffix:semicolon
id|llc_conn_ac_inc_vs_by_1
c_func
(paren
id|sk
comma
id|ev
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_resend_i_cmd_p_set_1
r_int
id|llc_conn_ac_resend_i_cmd_p_set_1
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|llc_pdu_sn_t
op_star
id|rx_pdu
op_assign
(paren
id|llc_pdu_sn_t
op_star
)paren
id|ev-&gt;data.pdu.skb-&gt;nh.raw
suffix:semicolon
id|u8
id|nr
op_assign
id|LLC_I_GET_NR
c_func
(paren
id|rx_pdu
)paren
suffix:semicolon
id|llc_conn_resend_i_pdu_as_cmd
c_func
(paren
id|sk
comma
id|nr
comma
l_int|1
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_resend_i_cmd_p_set_1_or_send_rr
r_int
id|llc_conn_ac_resend_i_cmd_p_set_1_or_send_rr
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|llc_pdu_sn_t
op_star
id|rx_pdu
op_assign
(paren
id|llc_pdu_sn_t
op_star
)paren
id|ev-&gt;data.pdu.skb-&gt;nh.raw
suffix:semicolon
id|u8
id|nr
op_assign
id|LLC_I_GET_NR
c_func
(paren
id|rx_pdu
)paren
suffix:semicolon
r_int
id|rc
op_assign
id|llc_conn_ac_send_rr_cmd_p_set_1
c_func
(paren
id|sk
comma
id|ev
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|rc
)paren
id|llc_conn_resend_i_pdu_as_cmd
c_func
(paren
id|sk
comma
id|nr
comma
l_int|0
)paren
suffix:semicolon
r_return
id|rc
suffix:semicolon
)brace
DECL|function|llc_conn_ac_send_i_xxx_x_set_0
r_int
id|llc_conn_ac_send_i_xxx_x_set_0
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|u8
id|p_bit
op_assign
l_int|0
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|ev-&gt;data.prim.data-&gt;data-&gt;data.skb
suffix:semicolon
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
r_struct
id|llc_sap
op_star
id|sap
op_assign
id|llc-&gt;sap
suffix:semicolon
id|llc_pdu_header_init
c_func
(paren
id|skb
comma
id|LLC_PDU_TYPE_I
comma
id|sap-&gt;laddr.lsap
comma
id|llc-&gt;daddr.lsap
comma
id|LLC_PDU_CMD
)paren
suffix:semicolon
id|llc_pdu_init_as_i_cmd
c_func
(paren
id|skb
comma
id|p_bit
comma
id|llc-&gt;vS
comma
id|llc-&gt;vR
)paren
suffix:semicolon
id|lan_hdrs_init
c_func
(paren
id|skb
comma
id|llc-&gt;dev-&gt;dev_addr
comma
id|llc-&gt;daddr.mac
)paren
suffix:semicolon
id|llc_conn_send_pdu
c_func
(paren
id|sk
comma
id|skb
)paren
suffix:semicolon
id|llc_conn_ac_inc_vs_by_1
c_func
(paren
id|sk
comma
id|ev
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_resend_i_xxx_x_set_0
r_int
id|llc_conn_ac_resend_i_xxx_x_set_0
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|llc_pdu_sn_t
op_star
id|rx_pdu
op_assign
(paren
id|llc_pdu_sn_t
op_star
)paren
id|ev-&gt;data.pdu.skb-&gt;nh.raw
suffix:semicolon
id|u8
id|nr
op_assign
id|LLC_I_GET_NR
c_func
(paren
id|rx_pdu
)paren
suffix:semicolon
id|llc_conn_resend_i_pdu_as_cmd
c_func
(paren
id|sk
comma
id|nr
comma
l_int|0
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_resend_i_xxx_x_set_0_or_send_rr
r_int
id|llc_conn_ac_resend_i_xxx_x_set_0_or_send_rr
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|u8
id|nr
suffix:semicolon
id|u8
id|f_bit
op_assign
l_int|0
suffix:semicolon
id|llc_pdu_sn_t
op_star
id|rx_pdu
op_assign
(paren
id|llc_pdu_sn_t
op_star
)paren
id|ev-&gt;data.pdu.skb-&gt;nh.raw
suffix:semicolon
r_int
id|rc
op_assign
l_int|1
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|llc_alloc_frame
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb
)paren
(brace
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
r_struct
id|llc_sap
op_star
id|sap
op_assign
id|llc-&gt;sap
suffix:semicolon
id|skb-&gt;dev
op_assign
id|llc-&gt;dev
suffix:semicolon
id|llc_pdu_header_init
c_func
(paren
id|skb
comma
id|LLC_PDU_TYPE_U
comma
id|sap-&gt;laddr.lsap
comma
id|llc-&gt;daddr.lsap
comma
id|LLC_PDU_RSP
)paren
suffix:semicolon
id|llc_pdu_init_as_rr_rsp
c_func
(paren
id|skb
comma
id|f_bit
comma
id|llc-&gt;vR
)paren
suffix:semicolon
id|lan_hdrs_init
c_func
(paren
id|skb
comma
id|llc-&gt;dev-&gt;dev_addr
comma
id|llc-&gt;daddr.mac
)paren
suffix:semicolon
id|rc
op_assign
l_int|0
suffix:semicolon
id|llc_conn_send_pdu
c_func
(paren
id|sk
comma
id|skb
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|rc
)paren
(brace
id|nr
op_assign
id|LLC_I_GET_NR
c_func
(paren
id|rx_pdu
)paren
suffix:semicolon
id|rc
op_assign
l_int|0
suffix:semicolon
id|llc_conn_resend_i_pdu_as_cmd
c_func
(paren
id|sk
comma
id|nr
comma
id|f_bit
)paren
suffix:semicolon
)brace
r_return
id|rc
suffix:semicolon
)brace
DECL|function|llc_conn_ac_resend_i_rsp_f_set_1
r_int
id|llc_conn_ac_resend_i_rsp_f_set_1
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|llc_pdu_sn_t
op_star
id|rx_pdu
op_assign
(paren
id|llc_pdu_sn_t
op_star
)paren
id|ev-&gt;data.pdu.skb-&gt;nh.raw
suffix:semicolon
id|u8
id|nr
op_assign
id|LLC_I_GET_NR
c_func
(paren
id|rx_pdu
)paren
suffix:semicolon
id|llc_conn_resend_i_pdu_as_rsp
c_func
(paren
id|sk
comma
id|nr
comma
l_int|1
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_send_rej_cmd_p_set_1
r_int
id|llc_conn_ac_send_rej_cmd_p_set_1
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_int
id|rc
op_assign
l_int|1
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|llc_alloc_frame
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb
)paren
(brace
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
r_struct
id|llc_sap
op_star
id|sap
op_assign
id|llc-&gt;sap
suffix:semicolon
id|u8
id|p_bit
op_assign
l_int|1
suffix:semicolon
id|skb-&gt;dev
op_assign
id|llc-&gt;dev
suffix:semicolon
id|llc_pdu_header_init
c_func
(paren
id|skb
comma
id|LLC_PDU_TYPE_S
comma
id|sap-&gt;laddr.lsap
comma
id|llc-&gt;daddr.lsap
comma
id|LLC_PDU_CMD
)paren
suffix:semicolon
id|llc_pdu_init_as_rej_cmd
c_func
(paren
id|skb
comma
id|p_bit
comma
id|llc-&gt;vR
)paren
suffix:semicolon
id|lan_hdrs_init
c_func
(paren
id|skb
comma
id|llc-&gt;dev-&gt;dev_addr
comma
id|llc-&gt;daddr.mac
)paren
suffix:semicolon
id|rc
op_assign
l_int|0
suffix:semicolon
id|llc_conn_send_pdu
c_func
(paren
id|sk
comma
id|skb
)paren
suffix:semicolon
)brace
r_return
id|rc
suffix:semicolon
)brace
DECL|function|llc_conn_ac_send_rej_rsp_f_set_1
r_int
id|llc_conn_ac_send_rej_rsp_f_set_1
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_int
id|rc
op_assign
l_int|1
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|llc_alloc_frame
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb
)paren
(brace
id|u8
id|f_bit
op_assign
l_int|1
suffix:semicolon
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
r_struct
id|llc_sap
op_star
id|sap
op_assign
id|llc-&gt;sap
suffix:semicolon
id|skb-&gt;dev
op_assign
id|llc-&gt;dev
suffix:semicolon
id|llc_pdu_header_init
c_func
(paren
id|skb
comma
id|LLC_PDU_TYPE_S
comma
id|sap-&gt;laddr.lsap
comma
id|llc-&gt;daddr.lsap
comma
id|LLC_PDU_RSP
)paren
suffix:semicolon
id|llc_pdu_init_as_rej_rsp
c_func
(paren
id|skb
comma
id|f_bit
comma
id|llc-&gt;vR
)paren
suffix:semicolon
id|lan_hdrs_init
c_func
(paren
id|skb
comma
id|llc-&gt;dev-&gt;dev_addr
comma
id|llc-&gt;daddr.mac
)paren
suffix:semicolon
id|rc
op_assign
l_int|0
suffix:semicolon
id|llc_conn_send_pdu
c_func
(paren
id|sk
comma
id|skb
)paren
suffix:semicolon
)brace
r_return
id|rc
suffix:semicolon
)brace
DECL|function|llc_conn_ac_send_rej_xxx_x_set_0
r_int
id|llc_conn_ac_send_rej_xxx_x_set_0
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_int
id|rc
op_assign
l_int|1
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|llc_alloc_frame
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb
)paren
(brace
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
r_struct
id|llc_sap
op_star
id|sap
op_assign
id|llc-&gt;sap
suffix:semicolon
id|u8
id|f_bit
op_assign
l_int|0
suffix:semicolon
id|skb-&gt;dev
op_assign
id|llc-&gt;dev
suffix:semicolon
id|llc_pdu_header_init
c_func
(paren
id|skb
comma
id|LLC_PDU_TYPE_S
comma
id|sap-&gt;laddr.lsap
comma
id|llc-&gt;daddr.lsap
comma
id|LLC_PDU_RSP
)paren
suffix:semicolon
id|llc_pdu_init_as_rej_rsp
c_func
(paren
id|skb
comma
id|f_bit
comma
id|llc-&gt;vR
)paren
suffix:semicolon
id|lan_hdrs_init
c_func
(paren
id|skb
comma
id|llc-&gt;dev-&gt;dev_addr
comma
id|llc-&gt;daddr.mac
)paren
suffix:semicolon
id|rc
op_assign
l_int|0
suffix:semicolon
id|llc_conn_send_pdu
c_func
(paren
id|sk
comma
id|skb
)paren
suffix:semicolon
)brace
r_return
id|rc
suffix:semicolon
)brace
DECL|function|llc_conn_ac_send_rnr_cmd_p_set_1
r_int
id|llc_conn_ac_send_rnr_cmd_p_set_1
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_int
id|rc
op_assign
l_int|1
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|llc_alloc_frame
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb
)paren
(brace
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
r_struct
id|llc_sap
op_star
id|sap
op_assign
id|llc-&gt;sap
suffix:semicolon
id|u8
id|p_bit
op_assign
l_int|1
suffix:semicolon
id|skb-&gt;dev
op_assign
id|llc-&gt;dev
suffix:semicolon
id|llc_pdu_header_init
c_func
(paren
id|skb
comma
id|LLC_PDU_TYPE_S
comma
id|sap-&gt;laddr.lsap
comma
id|llc-&gt;daddr.lsap
comma
id|LLC_PDU_CMD
)paren
suffix:semicolon
id|llc_pdu_init_as_rnr_cmd
c_func
(paren
id|skb
comma
id|p_bit
comma
id|llc-&gt;vR
)paren
suffix:semicolon
id|lan_hdrs_init
c_func
(paren
id|skb
comma
id|llc-&gt;dev-&gt;dev_addr
comma
id|llc-&gt;daddr.mac
)paren
suffix:semicolon
id|rc
op_assign
l_int|0
suffix:semicolon
id|llc_conn_send_pdu
c_func
(paren
id|sk
comma
id|skb
)paren
suffix:semicolon
)brace
r_return
id|rc
suffix:semicolon
)brace
DECL|function|llc_conn_ac_send_rnr_rsp_f_set_1
r_int
id|llc_conn_ac_send_rnr_rsp_f_set_1
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_int
id|rc
op_assign
l_int|1
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|llc_alloc_frame
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb
)paren
(brace
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
r_struct
id|llc_sap
op_star
id|sap
op_assign
id|llc-&gt;sap
suffix:semicolon
id|u8
id|f_bit
op_assign
l_int|1
suffix:semicolon
id|skb-&gt;dev
op_assign
id|llc-&gt;dev
suffix:semicolon
id|llc_pdu_header_init
c_func
(paren
id|skb
comma
id|LLC_PDU_TYPE_S
comma
id|sap-&gt;laddr.lsap
comma
id|llc-&gt;daddr.lsap
comma
id|LLC_PDU_RSP
)paren
suffix:semicolon
id|llc_pdu_init_as_rnr_rsp
c_func
(paren
id|skb
comma
id|f_bit
comma
id|llc-&gt;vR
)paren
suffix:semicolon
id|lan_hdrs_init
c_func
(paren
id|skb
comma
id|llc-&gt;dev-&gt;dev_addr
comma
id|llc-&gt;daddr.mac
)paren
suffix:semicolon
id|rc
op_assign
l_int|0
suffix:semicolon
id|llc_conn_send_pdu
c_func
(paren
id|sk
comma
id|skb
)paren
suffix:semicolon
)brace
r_return
id|rc
suffix:semicolon
)brace
DECL|function|llc_conn_ac_send_rnr_xxx_x_set_0
r_int
id|llc_conn_ac_send_rnr_xxx_x_set_0
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_int
id|rc
op_assign
l_int|1
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|llc_alloc_frame
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb
)paren
(brace
id|u8
id|f_bit
op_assign
l_int|0
suffix:semicolon
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
r_struct
id|llc_sap
op_star
id|sap
op_assign
id|llc-&gt;sap
suffix:semicolon
id|skb-&gt;dev
op_assign
id|llc-&gt;dev
suffix:semicolon
id|llc_pdu_header_init
c_func
(paren
id|skb
comma
id|LLC_PDU_TYPE_S
comma
id|sap-&gt;laddr.lsap
comma
id|llc-&gt;daddr.lsap
comma
id|LLC_PDU_RSP
)paren
suffix:semicolon
id|llc_pdu_init_as_rnr_rsp
c_func
(paren
id|skb
comma
id|f_bit
comma
id|llc-&gt;vR
)paren
suffix:semicolon
id|lan_hdrs_init
c_func
(paren
id|skb
comma
id|llc-&gt;dev-&gt;dev_addr
comma
id|llc-&gt;daddr.mac
)paren
suffix:semicolon
id|rc
op_assign
l_int|0
suffix:semicolon
id|llc_conn_send_pdu
c_func
(paren
id|sk
comma
id|skb
)paren
suffix:semicolon
)brace
r_return
id|rc
suffix:semicolon
)brace
DECL|function|llc_conn_ac_set_remote_busy
r_int
id|llc_conn_ac_set_remote_busy
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|llc-&gt;remote_busy_flag
)paren
(brace
id|llc-&gt;remote_busy_flag
op_assign
l_int|1
suffix:semicolon
id|llc-&gt;busy_state_timer.timer.expires
op_assign
id|jiffies
op_plus
id|llc-&gt;busy_state_timer.expire
op_star
id|HZ
suffix:semicolon
id|llc-&gt;busy_state_timer.timer.data
op_assign
(paren
r_int
r_int
)paren
id|sk
suffix:semicolon
id|llc-&gt;busy_state_timer.timer.function
op_assign
id|llc_conn_busy_tmr_cb
suffix:semicolon
id|add_timer
c_func
(paren
op_amp
id|llc-&gt;busy_state_timer.timer
)paren
suffix:semicolon
id|llc-&gt;busy_state_timer.running
op_assign
l_int|1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_opt_send_rnr_xxx_x_set_0
r_int
id|llc_conn_ac_opt_send_rnr_xxx_x_set_0
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_int
id|rc
op_assign
l_int|1
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|llc_alloc_frame
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb
)paren
(brace
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
r_struct
id|llc_sap
op_star
id|sap
op_assign
id|llc-&gt;sap
suffix:semicolon
id|u8
id|f_bit
op_assign
l_int|0
suffix:semicolon
id|skb-&gt;dev
op_assign
id|llc-&gt;dev
suffix:semicolon
id|llc_pdu_header_init
c_func
(paren
id|skb
comma
id|LLC_PDU_TYPE_S
comma
id|sap-&gt;laddr.lsap
comma
id|llc-&gt;daddr.lsap
comma
id|LLC_PDU_RSP
)paren
suffix:semicolon
id|llc_pdu_init_as_rnr_rsp
c_func
(paren
id|skb
comma
id|f_bit
comma
id|llc-&gt;vR
)paren
suffix:semicolon
id|lan_hdrs_init
c_func
(paren
id|skb
comma
id|llc-&gt;dev-&gt;dev_addr
comma
id|llc-&gt;daddr.mac
)paren
suffix:semicolon
id|rc
op_assign
l_int|0
suffix:semicolon
id|llc_conn_send_pdu
c_func
(paren
id|sk
comma
id|skb
)paren
suffix:semicolon
)brace
r_return
id|rc
suffix:semicolon
)brace
DECL|function|llc_conn_ac_send_rr_cmd_p_set_1
r_int
id|llc_conn_ac_send_rr_cmd_p_set_1
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_int
id|rc
op_assign
l_int|1
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|llc_alloc_frame
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb
)paren
(brace
id|u8
id|p_bit
op_assign
l_int|1
suffix:semicolon
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
r_struct
id|llc_sap
op_star
id|sap
op_assign
id|llc-&gt;sap
suffix:semicolon
id|skb-&gt;dev
op_assign
id|llc-&gt;dev
suffix:semicolon
id|llc_pdu_header_init
c_func
(paren
id|skb
comma
id|LLC_PDU_TYPE_S
comma
id|sap-&gt;laddr.lsap
comma
id|llc-&gt;daddr.lsap
comma
id|LLC_PDU_CMD
)paren
suffix:semicolon
id|llc_pdu_init_as_rr_cmd
c_func
(paren
id|skb
comma
id|p_bit
comma
id|llc-&gt;vR
)paren
suffix:semicolon
id|lan_hdrs_init
c_func
(paren
id|skb
comma
id|llc-&gt;dev-&gt;dev_addr
comma
id|llc-&gt;daddr.mac
)paren
suffix:semicolon
id|rc
op_assign
l_int|0
suffix:semicolon
id|llc_conn_send_pdu
c_func
(paren
id|sk
comma
id|skb
)paren
suffix:semicolon
)brace
r_return
id|rc
suffix:semicolon
)brace
DECL|function|llc_conn_ac_send_ack_cmd_p_set_1
r_int
id|llc_conn_ac_send_ack_cmd_p_set_1
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_int
id|rc
op_assign
l_int|1
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|llc_alloc_frame
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb
)paren
(brace
id|u8
id|p_bit
op_assign
l_int|1
suffix:semicolon
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
r_struct
id|llc_sap
op_star
id|sap
op_assign
id|llc-&gt;sap
suffix:semicolon
id|skb-&gt;dev
op_assign
id|llc-&gt;dev
suffix:semicolon
id|llc_pdu_header_init
c_func
(paren
id|skb
comma
id|LLC_PDU_TYPE_S
comma
id|sap-&gt;laddr.lsap
comma
id|llc-&gt;daddr.lsap
comma
id|LLC_PDU_CMD
)paren
suffix:semicolon
id|llc_pdu_init_as_rr_cmd
c_func
(paren
id|skb
comma
id|p_bit
comma
id|llc-&gt;vR
)paren
suffix:semicolon
id|lan_hdrs_init
c_func
(paren
id|skb
comma
id|llc-&gt;dev-&gt;dev_addr
comma
id|llc-&gt;daddr.mac
)paren
suffix:semicolon
id|rc
op_assign
l_int|0
suffix:semicolon
id|llc_conn_send_pdu
c_func
(paren
id|sk
comma
id|skb
)paren
suffix:semicolon
)brace
r_return
id|rc
suffix:semicolon
)brace
DECL|function|llc_conn_ac_send_rr_rsp_f_set_1
r_int
id|llc_conn_ac_send_rr_rsp_f_set_1
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_int
id|rc
op_assign
l_int|1
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|llc_alloc_frame
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb
)paren
(brace
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
r_struct
id|llc_sap
op_star
id|sap
op_assign
id|llc-&gt;sap
suffix:semicolon
id|u8
id|f_bit
op_assign
l_int|1
suffix:semicolon
id|skb-&gt;dev
op_assign
id|llc-&gt;dev
suffix:semicolon
id|llc_pdu_header_init
c_func
(paren
id|skb
comma
id|LLC_PDU_TYPE_S
comma
id|sap-&gt;laddr.lsap
comma
id|llc-&gt;daddr.lsap
comma
id|LLC_PDU_RSP
)paren
suffix:semicolon
id|llc_pdu_init_as_rr_rsp
c_func
(paren
id|skb
comma
id|f_bit
comma
id|llc-&gt;vR
)paren
suffix:semicolon
id|lan_hdrs_init
c_func
(paren
id|skb
comma
id|llc-&gt;dev-&gt;dev_addr
comma
id|llc-&gt;daddr.mac
)paren
suffix:semicolon
id|rc
op_assign
l_int|0
suffix:semicolon
id|llc_conn_send_pdu
c_func
(paren
id|sk
comma
id|skb
)paren
suffix:semicolon
)brace
r_return
id|rc
suffix:semicolon
)brace
DECL|function|llc_conn_ac_send_ack_rsp_f_set_1
r_int
id|llc_conn_ac_send_ack_rsp_f_set_1
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_int
id|rc
op_assign
l_int|1
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|llc_alloc_frame
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb
)paren
(brace
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
r_struct
id|llc_sap
op_star
id|sap
op_assign
id|llc-&gt;sap
suffix:semicolon
id|u8
id|f_bit
op_assign
l_int|1
suffix:semicolon
id|skb-&gt;dev
op_assign
id|llc-&gt;dev
suffix:semicolon
id|llc_pdu_header_init
c_func
(paren
id|skb
comma
id|LLC_PDU_TYPE_S
comma
id|sap-&gt;laddr.lsap
comma
id|llc-&gt;daddr.lsap
comma
id|LLC_PDU_RSP
)paren
suffix:semicolon
id|llc_pdu_init_as_rr_rsp
c_func
(paren
id|skb
comma
id|f_bit
comma
id|llc-&gt;vR
)paren
suffix:semicolon
id|lan_hdrs_init
c_func
(paren
id|skb
comma
id|llc-&gt;dev-&gt;dev_addr
comma
id|llc-&gt;daddr.mac
)paren
suffix:semicolon
id|rc
op_assign
l_int|0
suffix:semicolon
id|llc_conn_send_pdu
c_func
(paren
id|sk
comma
id|skb
)paren
suffix:semicolon
)brace
r_return
id|rc
suffix:semicolon
)brace
DECL|function|llc_conn_ac_send_rr_xxx_x_set_0
r_int
id|llc_conn_ac_send_rr_xxx_x_set_0
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_int
id|rc
op_assign
l_int|1
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|llc_alloc_frame
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb
)paren
(brace
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
r_struct
id|llc_sap
op_star
id|sap
op_assign
id|llc-&gt;sap
suffix:semicolon
id|u8
id|f_bit
op_assign
l_int|0
suffix:semicolon
id|skb-&gt;dev
op_assign
id|llc-&gt;dev
suffix:semicolon
id|llc_pdu_header_init
c_func
(paren
id|skb
comma
id|LLC_PDU_TYPE_S
comma
id|sap-&gt;laddr.lsap
comma
id|llc-&gt;daddr.lsap
comma
id|LLC_PDU_RSP
)paren
suffix:semicolon
id|llc_pdu_init_as_rr_rsp
c_func
(paren
id|skb
comma
id|f_bit
comma
id|llc-&gt;vR
)paren
suffix:semicolon
id|lan_hdrs_init
c_func
(paren
id|skb
comma
id|llc-&gt;dev-&gt;dev_addr
comma
id|llc-&gt;daddr.mac
)paren
suffix:semicolon
id|rc
op_assign
l_int|0
suffix:semicolon
id|llc_conn_send_pdu
c_func
(paren
id|sk
comma
id|skb
)paren
suffix:semicolon
)brace
r_return
id|rc
suffix:semicolon
)brace
DECL|function|llc_conn_ac_send_ack_xxx_x_set_0
r_int
id|llc_conn_ac_send_ack_xxx_x_set_0
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_int
id|rc
op_assign
l_int|1
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|llc_alloc_frame
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb
)paren
(brace
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
r_struct
id|llc_sap
op_star
id|sap
op_assign
id|llc-&gt;sap
suffix:semicolon
id|u8
id|f_bit
op_assign
l_int|0
suffix:semicolon
id|skb-&gt;dev
op_assign
id|llc-&gt;dev
suffix:semicolon
id|llc_pdu_header_init
c_func
(paren
id|skb
comma
id|LLC_PDU_TYPE_S
comma
id|sap-&gt;laddr.lsap
comma
id|llc-&gt;daddr.lsap
comma
id|LLC_PDU_RSP
)paren
suffix:semicolon
id|llc_pdu_init_as_rr_rsp
c_func
(paren
id|skb
comma
id|f_bit
comma
id|llc-&gt;vR
)paren
suffix:semicolon
id|lan_hdrs_init
c_func
(paren
id|skb
comma
id|llc-&gt;dev-&gt;dev_addr
comma
id|llc-&gt;daddr.mac
)paren
suffix:semicolon
id|rc
op_assign
l_int|0
suffix:semicolon
id|llc_conn_send_pdu
c_func
(paren
id|sk
comma
id|skb
)paren
suffix:semicolon
)brace
r_return
id|rc
suffix:semicolon
)brace
DECL|function|llc_conn_ac_send_sabme_cmd_p_set_x
r_int
id|llc_conn_ac_send_sabme_cmd_p_set_x
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_int
id|rc
op_assign
l_int|1
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|llc_alloc_frame
c_func
(paren
)paren
suffix:semicolon
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
id|u8
id|p_bit
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|skb
)paren
(brace
r_struct
id|llc_sap
op_star
id|sap
op_assign
id|llc-&gt;sap
suffix:semicolon
id|u8
op_star
id|dmac
op_assign
id|llc-&gt;daddr.mac
suffix:semicolon
r_if
c_cond
(paren
id|llc-&gt;dev-&gt;flags
op_amp
id|IFF_LOOPBACK
)paren
id|dmac
op_assign
id|llc-&gt;dev-&gt;dev_addr
suffix:semicolon
id|skb-&gt;dev
op_assign
id|llc-&gt;dev
suffix:semicolon
id|llc_pdu_header_init
c_func
(paren
id|skb
comma
id|LLC_PDU_TYPE_U
comma
id|sap-&gt;laddr.lsap
comma
id|llc-&gt;daddr.lsap
comma
id|LLC_PDU_CMD
)paren
suffix:semicolon
id|llc_pdu_init_as_sabme_cmd
c_func
(paren
id|skb
comma
id|p_bit
)paren
suffix:semicolon
id|lan_hdrs_init
c_func
(paren
id|skb
comma
id|llc-&gt;dev-&gt;dev_addr
comma
id|dmac
)paren
suffix:semicolon
id|rc
op_assign
l_int|0
suffix:semicolon
id|llc_conn_send_pdu
c_func
(paren
id|sk
comma
id|skb
)paren
suffix:semicolon
)brace
id|llc-&gt;p_flag
op_assign
id|p_bit
suffix:semicolon
r_return
id|rc
suffix:semicolon
)brace
DECL|function|llc_conn_ac_send_ua_rsp_f_set_f_flag
r_int
id|llc_conn_ac_send_ua_rsp_f_set_f_flag
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_int
id|rc
op_assign
l_int|1
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|llc_alloc_frame
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb
)paren
(brace
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
r_struct
id|llc_sap
op_star
id|sap
op_assign
id|llc-&gt;sap
suffix:semicolon
id|u8
id|f_bit
op_assign
id|llc-&gt;f_flag
suffix:semicolon
id|skb-&gt;dev
op_assign
id|llc-&gt;dev
suffix:semicolon
id|llc_pdu_header_init
c_func
(paren
id|skb
comma
id|LLC_PDU_TYPE_U
comma
id|sap-&gt;laddr.lsap
comma
id|llc-&gt;daddr.lsap
comma
id|LLC_PDU_RSP
)paren
suffix:semicolon
id|llc_pdu_init_as_ua_rsp
c_func
(paren
id|skb
comma
id|f_bit
)paren
suffix:semicolon
id|lan_hdrs_init
c_func
(paren
id|skb
comma
id|llc-&gt;dev-&gt;dev_addr
comma
id|llc-&gt;daddr.mac
)paren
suffix:semicolon
id|rc
op_assign
l_int|0
suffix:semicolon
id|llc_conn_send_pdu
c_func
(paren
id|sk
comma
id|skb
)paren
suffix:semicolon
)brace
r_return
id|rc
suffix:semicolon
)brace
DECL|function|llc_conn_ac_send_ua_rsp_f_set_p
r_int
id|llc_conn_ac_send_ua_rsp_f_set_p
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|u8
id|f_bit
suffix:semicolon
r_int
id|rc
op_assign
l_int|1
suffix:semicolon
r_struct
id|sk_buff
op_star
id|rx_skb
op_assign
id|ev-&gt;data.pdu.skb
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|llc_pdu_decode_pf_bit
c_func
(paren
id|rx_skb
comma
op_amp
id|f_bit
)paren
suffix:semicolon
id|skb
op_assign
id|llc_alloc_frame
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb
)paren
(brace
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
r_struct
id|llc_sap
op_star
id|sap
op_assign
id|llc-&gt;sap
suffix:semicolon
id|skb-&gt;dev
op_assign
id|llc-&gt;dev
suffix:semicolon
id|llc_pdu_header_init
c_func
(paren
id|skb
comma
id|LLC_PDU_TYPE_U
comma
id|sap-&gt;laddr.lsap
comma
id|llc-&gt;daddr.lsap
comma
id|LLC_PDU_RSP
)paren
suffix:semicolon
id|llc_pdu_init_as_ua_rsp
c_func
(paren
id|skb
comma
id|f_bit
)paren
suffix:semicolon
id|lan_hdrs_init
c_func
(paren
id|skb
comma
id|llc-&gt;dev-&gt;dev_addr
comma
id|llc-&gt;daddr.mac
)paren
suffix:semicolon
id|rc
op_assign
l_int|0
suffix:semicolon
id|llc_conn_send_pdu
c_func
(paren
id|sk
comma
id|skb
)paren
suffix:semicolon
)brace
r_return
id|rc
suffix:semicolon
)brace
DECL|function|llc_conn_ac_set_s_flag_0
r_int
id|llc_conn_ac_set_s_flag_0
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|s_flag
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_set_s_flag_1
r_int
id|llc_conn_ac_set_s_flag_1
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|s_flag
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_start_p_timer
r_int
id|llc_conn_ac_start_p_timer
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
id|llc-&gt;p_flag
op_assign
l_int|1
suffix:semicolon
id|del_timer
c_func
(paren
op_amp
id|llc-&gt;pf_cycle_timer.timer
)paren
suffix:semicolon
id|llc-&gt;pf_cycle_timer.timer.expires
op_assign
id|jiffies
op_plus
id|llc-&gt;pf_cycle_timer.expire
op_star
id|HZ
suffix:semicolon
id|llc-&gt;pf_cycle_timer.timer.data
op_assign
(paren
r_int
r_int
)paren
id|sk
suffix:semicolon
id|llc-&gt;pf_cycle_timer.timer.function
op_assign
id|llc_conn_pf_cycle_tmr_cb
suffix:semicolon
id|add_timer
c_func
(paren
op_amp
id|llc-&gt;pf_cycle_timer.timer
)paren
suffix:semicolon
id|llc-&gt;pf_cycle_timer.running
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;llc_conn_ac_send_ack_if_needed - check if ack is needed&n; *&t;@sk: current connection structure&n; *&t;@ev: current event&n; *&n; *&t;Checks number of received PDUs which have not been acknowledged, yet,&n; *&t;If number of them reaches to &quot;npta&quot;(Number of PDUs To Acknowledge) then&n; *&t;sends an RR response as acknowledgement for them.  Returns 0 for&n; *&t;success, 1 otherwise.&n; */
DECL|function|llc_conn_ac_send_ack_if_needed
r_int
id|llc_conn_ac_send_ack_if_needed
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|u8
id|pf_bit
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|ev-&gt;data.pdu.skb
suffix:semicolon
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
id|llc_pdu_decode_pf_bit
c_func
(paren
id|skb
comma
op_amp
id|pf_bit
)paren
suffix:semicolon
id|llc-&gt;ack_pf
op_or_assign
id|pf_bit
op_amp
l_int|1
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|llc-&gt;ack_must_be_send
)paren
(brace
id|llc-&gt;first_pdu_Ns
op_assign
id|llc-&gt;vR
suffix:semicolon
id|llc-&gt;ack_must_be_send
op_assign
l_int|1
suffix:semicolon
id|llc-&gt;ack_pf
op_assign
id|pf_bit
op_amp
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
(paren
id|llc-&gt;vR
op_minus
id|llc-&gt;first_pdu_Ns
op_plus
l_int|129
)paren
op_mod
l_int|128
)paren
op_ge
id|llc-&gt;npta
)paren
(brace
id|llc_conn_ac_send_rr_rsp_f_set_ackpf
c_func
(paren
id|sk
comma
id|ev
)paren
suffix:semicolon
id|llc-&gt;ack_must_be_send
op_assign
l_int|0
suffix:semicolon
id|llc-&gt;ack_pf
op_assign
l_int|0
suffix:semicolon
id|llc_conn_ac_inc_npta_value
c_func
(paren
id|sk
comma
id|ev
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;llc_conn_ac_rst_sendack_flag - resets ack_must_be_send flag&n; *&t;@sk: current connection structure&n; *&t;@ev: current event&n; *&n; *&t;This action resets ack_must_be_send flag of given connection, this flag&n; *&t;indicates if there is any PDU which has not been acknowledged yet.&n; *&t;Returns 0 for success, 1 otherwise.&n; */
DECL|function|llc_conn_ac_rst_sendack_flag
r_int
id|llc_conn_ac_rst_sendack_flag
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|ack_must_be_send
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|ack_pf
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;llc_conn_ac_send_i_rsp_f_set_ackpf - acknowledge received PDUs&n; *&t;@sk: current connection structure&n; *&t;@ev: current event&n; *&n; *&t;Sends an I response PDU with f-bit set to ack_pf flag as acknowledge to&n; *&t;all received PDUs which have not been acknowledged, yet. ack_pf flag is&n; *&t;set to one if one PDU with p-bit set to one is received.  Returns 0 for&n; *&t;success, 1 otherwise.&n; */
DECL|function|llc_conn_ac_send_i_rsp_f_set_ackpf
r_int
id|llc_conn_ac_send_i_rsp_f_set_ackpf
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|ev-&gt;data.prim.data-&gt;data-&gt;data.skb
suffix:semicolon
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
id|u8
id|p_bit
op_assign
id|llc-&gt;ack_pf
suffix:semicolon
r_struct
id|llc_sap
op_star
id|sap
op_assign
id|llc-&gt;sap
suffix:semicolon
id|llc_pdu_header_init
c_func
(paren
id|skb
comma
id|LLC_PDU_TYPE_I
comma
id|sap-&gt;laddr.lsap
comma
id|llc-&gt;daddr.lsap
comma
id|LLC_PDU_RSP
)paren
suffix:semicolon
id|llc_pdu_init_as_i_cmd
c_func
(paren
id|skb
comma
id|p_bit
comma
id|llc-&gt;vS
comma
id|llc-&gt;vR
)paren
suffix:semicolon
id|lan_hdrs_init
c_func
(paren
id|skb
comma
id|llc-&gt;dev-&gt;dev_addr
comma
id|llc-&gt;daddr.mac
)paren
suffix:semicolon
id|llc_conn_send_pdu
c_func
(paren
id|sk
comma
id|skb
)paren
suffix:semicolon
id|llc_conn_ac_inc_vs_by_1
c_func
(paren
id|sk
comma
id|ev
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;llc_conn_ac_send_i_as_ack - sends an I-format PDU to acknowledge rx PDUs&n; *&t;@sk: current connection structure.&n; *&t;@ev: current event.&n; *&n; *&t;This action sends an I-format PDU as acknowledge to received PDUs which&n; *&t;have not been acknowledged, yet, if there is any. By using of this&n; *&t;action number of acknowledgements decreases, this technic is called&n; *&t;piggy backing. Returns 0 for success, 1 otherwise.&n; */
DECL|function|llc_conn_ac_send_i_as_ack
r_int
id|llc_conn_ac_send_i_as_ack
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
r_if
c_cond
(paren
id|llc-&gt;ack_must_be_send
)paren
(brace
id|llc_conn_ac_send_i_rsp_f_set_ackpf
c_func
(paren
id|sk
comma
id|ev
)paren
suffix:semicolon
id|llc-&gt;ack_must_be_send
op_assign
l_int|0
suffix:semicolon
id|llc-&gt;ack_pf
op_assign
l_int|0
suffix:semicolon
)brace
r_else
id|llc_conn_ac_send_i_cmd_p_set_0
c_func
(paren
id|sk
comma
id|ev
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;llc_conn_ac_send_rr_rsp_f_set_ackpf - ack all rx PDUs not yet acked&n; *&t;@sk: current connection structure.&n; *&t;@ev: current event.&n; *&n; *&t;This action sends an RR response with f-bit set to ack_pf flag as&n; *&t;acknowledge to all received PDUs which have not been acknowledged, yet,&n; *&t;if there is any. ack_pf flag indicates if a PDU has been received with&n; *&t;p-bit set to one. Returns 0 for success, 1 otherwise.&n; */
DECL|function|llc_conn_ac_send_rr_rsp_f_set_ackpf
r_int
id|llc_conn_ac_send_rr_rsp_f_set_ackpf
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_int
id|rc
op_assign
l_int|1
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|llc_alloc_frame
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb
)paren
(brace
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
r_struct
id|llc_sap
op_star
id|sap
op_assign
id|llc-&gt;sap
suffix:semicolon
id|u8
id|f_bit
op_assign
id|llc-&gt;ack_pf
suffix:semicolon
id|skb-&gt;dev
op_assign
id|llc-&gt;dev
suffix:semicolon
id|llc_pdu_header_init
c_func
(paren
id|skb
comma
id|LLC_PDU_TYPE_S
comma
id|sap-&gt;laddr.lsap
comma
id|llc-&gt;daddr.lsap
comma
id|LLC_PDU_RSP
)paren
suffix:semicolon
id|llc_pdu_init_as_rr_rsp
c_func
(paren
id|skb
comma
id|f_bit
comma
id|llc-&gt;vR
)paren
suffix:semicolon
id|lan_hdrs_init
c_func
(paren
id|skb
comma
id|llc-&gt;dev-&gt;dev_addr
comma
id|llc-&gt;daddr.mac
)paren
suffix:semicolon
id|rc
op_assign
l_int|0
suffix:semicolon
id|llc_conn_send_pdu
c_func
(paren
id|sk
comma
id|skb
)paren
suffix:semicolon
)brace
r_return
id|rc
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;llc_conn_ac_inc_npta_value - tries to make value of npta greater&n; *&t;@sk: current connection structure.&n; *&t;@ev: current event.&n; *&n; *&t;After &quot;inc_cntr&quot; times calling of this action, &quot;npta&quot; increase by one.&n; *&t;this action tries to make vale of &quot;npta&quot; greater as possible; number of&n; *&t;acknowledgements decreases by increasing of &quot;npta&quot;. Returns 0 for&n; *&t;success, 1 otherwise.&n; */
DECL|function|llc_conn_ac_inc_npta_value
r_int
id|llc_conn_ac_inc_npta_value
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|llc-&gt;inc_cntr
)paren
(brace
id|llc-&gt;dec_step
op_assign
l_int|0
suffix:semicolon
id|llc-&gt;dec_cntr
op_assign
id|llc-&gt;inc_cntr
op_assign
l_int|2
suffix:semicolon
op_increment
id|llc-&gt;npta
suffix:semicolon
r_if
c_cond
(paren
id|llc-&gt;npta
OG
l_int|127
)paren
id|llc-&gt;npta
op_assign
l_int|127
suffix:semicolon
)brace
r_else
op_decrement
id|llc-&gt;inc_cntr
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;llc_conn_ac_adjust_npta_by_rr - decreases &quot;npta&quot; by one&n; *&t;@sk: current connection structure.&n; *&t;@ev: current event.&n; *&n; *&t;After receiving &quot;dec_cntr&quot; times RR command, this action decreases&n; *&t;&quot;npta&quot; by one. Returns 0 for success, 1 otherwise.&n; */
DECL|function|llc_conn_ac_adjust_npta_by_rr
r_int
id|llc_conn_ac_adjust_npta_by_rr
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|llc-&gt;connect_step
op_logical_and
op_logical_neg
id|llc-&gt;remote_busy_flag
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|llc-&gt;dec_step
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|llc-&gt;dec_cntr
)paren
(brace
id|llc-&gt;inc_cntr
op_assign
id|llc-&gt;dec_cntr
op_assign
l_int|2
suffix:semicolon
r_if
c_cond
(paren
id|llc-&gt;npta
OG
l_int|0
)paren
id|llc-&gt;npta
op_assign
id|llc-&gt;npta
op_minus
l_int|1
suffix:semicolon
)brace
r_else
id|llc-&gt;dec_cntr
op_sub_assign
l_int|1
suffix:semicolon
)brace
)brace
r_else
id|llc-&gt;connect_step
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;llc_conn_ac_adjust_npta_by_rnr - decreases &quot;npta&quot; by one&n; *&t;@sk: current connection structure.&n; *&t;@ev: current event.&n; *&n; *&t;After receiving &quot;dec_cntr&quot; times RNR command, this action decreases&n; *&t;&quot;npta&quot; by one. Returns 0 for success, 1 otherwise.&n; */
DECL|function|llc_conn_ac_adjust_npta_by_rnr
r_int
id|llc_conn_ac_adjust_npta_by_rnr
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
r_if
c_cond
(paren
id|llc-&gt;remote_busy_flag
)paren
r_if
c_cond
(paren
op_logical_neg
id|llc-&gt;dec_step
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|llc-&gt;dec_cntr
)paren
(brace
id|llc-&gt;inc_cntr
op_assign
id|llc-&gt;dec_cntr
op_assign
l_int|2
suffix:semicolon
r_if
c_cond
(paren
id|llc-&gt;npta
OG
l_int|0
)paren
op_decrement
id|llc-&gt;npta
suffix:semicolon
)brace
r_else
op_decrement
id|llc-&gt;dec_cntr
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;llc_conn_ac_dec_tx_win_size - decreases tx window size&n; *&t;@sk: current connection structure.&n; *&t;@ev: current event.&n; *&n; *&t;After receiving of a REJ command or response, transmit window size is&n; *&t;decreased by number of PDUs which are outstanding yet. Returns 0 for&n; *&t;success, 1 otherwise.&n; */
DECL|function|llc_conn_ac_dec_tx_win_size
r_int
id|llc_conn_ac_dec_tx_win_size
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
id|u8
id|unacked_pdu
op_assign
id|skb_queue_len
c_func
(paren
op_amp
id|llc-&gt;pdu_unack_q
)paren
suffix:semicolon
id|llc-&gt;k
op_sub_assign
id|unacked_pdu
suffix:semicolon
r_if
c_cond
(paren
id|llc-&gt;k
OL
l_int|2
)paren
id|llc-&gt;k
op_assign
l_int|2
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;llc_conn_ac_inc_tx_win_size - tx window size is inc by 1&n; *&t;@sk: current connection structure.&n; *&t;@ev: current event.&n; *&n; *&t;After receiving an RR response with f-bit set to one, transmit window&n; *&t;size is increased by one. Returns 0 for success, 1 otherwise.&n; */
DECL|function|llc_conn_ac_inc_tx_win_size
r_int
id|llc_conn_ac_inc_tx_win_size
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
id|llc-&gt;k
op_add_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|llc-&gt;k
OG
l_int|128
)paren
id|llc-&gt;k
op_assign
l_int|128
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_stop_all_timers
r_int
id|llc_conn_ac_stop_all_timers
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
id|del_timer
c_func
(paren
op_amp
id|llc-&gt;pf_cycle_timer.timer
)paren
suffix:semicolon
id|llc-&gt;pf_cycle_timer.running
op_assign
l_int|0
suffix:semicolon
id|del_timer
c_func
(paren
op_amp
id|llc-&gt;ack_timer.timer
)paren
suffix:semicolon
id|llc-&gt;ack_timer.running
op_assign
l_int|0
suffix:semicolon
id|del_timer
c_func
(paren
op_amp
id|llc-&gt;rej_sent_timer.timer
)paren
suffix:semicolon
id|llc-&gt;rej_sent_timer.running
op_assign
l_int|0
suffix:semicolon
id|del_timer
c_func
(paren
op_amp
id|llc-&gt;busy_state_timer.timer
)paren
suffix:semicolon
id|llc-&gt;busy_state_timer.running
op_assign
l_int|0
suffix:semicolon
id|llc-&gt;ack_must_be_send
op_assign
l_int|0
suffix:semicolon
id|llc-&gt;ack_pf
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_stop_other_timers
r_int
id|llc_conn_ac_stop_other_timers
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
id|del_timer
c_func
(paren
op_amp
id|llc-&gt;rej_sent_timer.timer
)paren
suffix:semicolon
id|llc-&gt;rej_sent_timer.running
op_assign
l_int|0
suffix:semicolon
id|del_timer
c_func
(paren
op_amp
id|llc-&gt;pf_cycle_timer.timer
)paren
suffix:semicolon
id|llc-&gt;pf_cycle_timer.running
op_assign
l_int|0
suffix:semicolon
id|del_timer
c_func
(paren
op_amp
id|llc-&gt;busy_state_timer.timer
)paren
suffix:semicolon
id|llc-&gt;busy_state_timer.running
op_assign
l_int|0
suffix:semicolon
id|llc-&gt;ack_must_be_send
op_assign
l_int|0
suffix:semicolon
id|llc-&gt;ack_pf
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_start_ack_timer
r_int
id|llc_conn_ac_start_ack_timer
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
id|del_timer
c_func
(paren
op_amp
id|llc-&gt;ack_timer.timer
)paren
suffix:semicolon
id|llc-&gt;ack_timer.timer.expires
op_assign
id|jiffies
op_plus
id|llc-&gt;ack_timer.expire
op_star
id|HZ
suffix:semicolon
id|llc-&gt;ack_timer.timer.data
op_assign
(paren
r_int
r_int
)paren
id|sk
suffix:semicolon
id|llc-&gt;ack_timer.timer.function
op_assign
id|llc_conn_ack_tmr_cb
suffix:semicolon
id|add_timer
c_func
(paren
op_amp
id|llc-&gt;ack_timer.timer
)paren
suffix:semicolon
id|llc-&gt;ack_timer.running
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_start_rej_timer
r_int
id|llc_conn_ac_start_rej_timer
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
id|del_timer
c_func
(paren
op_amp
id|llc-&gt;rej_sent_timer.timer
)paren
suffix:semicolon
id|llc-&gt;rej_sent_timer.timer.expires
op_assign
id|jiffies
op_plus
id|llc-&gt;rej_sent_timer.expire
op_star
id|HZ
suffix:semicolon
id|llc-&gt;rej_sent_timer.timer.data
op_assign
(paren
r_int
r_int
)paren
id|sk
suffix:semicolon
id|llc-&gt;rej_sent_timer.timer.function
op_assign
id|llc_conn_rej_tmr_cb
suffix:semicolon
id|add_timer
c_func
(paren
op_amp
id|llc-&gt;rej_sent_timer.timer
)paren
suffix:semicolon
id|llc-&gt;rej_sent_timer.running
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_start_ack_tmr_if_not_running
r_int
id|llc_conn_ac_start_ack_tmr_if_not_running
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|llc-&gt;ack_timer.running
)paren
(brace
id|llc-&gt;ack_timer.timer.expires
op_assign
id|jiffies
op_plus
id|llc-&gt;ack_timer.expire
op_star
id|HZ
suffix:semicolon
id|llc-&gt;ack_timer.timer.data
op_assign
(paren
r_int
r_int
)paren
id|sk
suffix:semicolon
id|llc-&gt;ack_timer.timer.function
op_assign
id|llc_conn_ack_tmr_cb
suffix:semicolon
id|add_timer
c_func
(paren
op_amp
id|llc-&gt;ack_timer.timer
)paren
suffix:semicolon
id|llc-&gt;ack_timer.running
op_assign
l_int|1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_stop_ack_timer
r_int
id|llc_conn_ac_stop_ack_timer
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|del_timer
c_func
(paren
op_amp
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|ack_timer.timer
)paren
suffix:semicolon
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|ack_timer.running
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_stop_p_timer
r_int
id|llc_conn_ac_stop_p_timer
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
id|del_timer
c_func
(paren
op_amp
id|llc-&gt;pf_cycle_timer.timer
)paren
suffix:semicolon
id|llc-&gt;pf_cycle_timer.running
op_assign
l_int|0
suffix:semicolon
id|llc-&gt;p_flag
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_stop_rej_timer
r_int
id|llc_conn_ac_stop_rej_timer
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|del_timer
c_func
(paren
op_amp
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|rej_sent_timer.timer
)paren
suffix:semicolon
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|rej_sent_timer.running
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_upd_nr_received
r_int
id|llc_conn_ac_upd_nr_received
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_int
id|acked
suffix:semicolon
id|u16
id|unacked
op_assign
l_int|0
suffix:semicolon
id|u8
id|fbit
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|ev-&gt;data.pdu.skb
suffix:semicolon
id|llc_pdu_sn_t
op_star
id|rx_pdu
op_assign
(paren
id|llc_pdu_sn_t
op_star
)paren
id|skb-&gt;nh.raw
suffix:semicolon
r_struct
id|llc_opt
op_star
id|llc
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
suffix:semicolon
id|llc-&gt;last_nr
op_assign
id|PDU_SUPV_GET_Nr
c_func
(paren
id|rx_pdu
)paren
suffix:semicolon
id|acked
op_assign
id|llc_conn_remove_acked_pdus
c_func
(paren
id|sk
comma
id|llc-&gt;last_nr
comma
op_amp
id|unacked
)paren
suffix:semicolon
multiline_comment|/* On loopback we don&squot;t queue I frames in unack_pdu_q queue. */
r_if
c_cond
(paren
id|acked
OG
l_int|0
op_logical_or
(paren
id|llc-&gt;dev-&gt;flags
op_amp
id|IFF_LOOPBACK
)paren
)paren
(brace
id|llc-&gt;retry_count
op_assign
l_int|0
suffix:semicolon
id|del_timer
c_func
(paren
op_amp
id|llc-&gt;ack_timer.timer
)paren
suffix:semicolon
id|llc-&gt;ack_timer.running
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|llc-&gt;failed_data_req
)paren
(brace
multiline_comment|/* already, we did not accept data from upper layer&n;&t;&t;&t; * (tx_window full or unacceptable state). Now, we&n;&t;&t;&t; * can send data and must inform to upper layer.&n;&t;&t;&t; */
id|llc-&gt;failed_data_req
op_assign
l_int|0
suffix:semicolon
id|llc_conn_ac_data_confirm
c_func
(paren
id|sk
comma
id|ev
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|unacked
)paren
(brace
id|llc-&gt;ack_timer.timer.expires
op_assign
id|jiffies
op_plus
id|llc-&gt;ack_timer.expire
op_star
id|HZ
suffix:semicolon
id|llc-&gt;ack_timer.timer.data
op_assign
(paren
r_int
r_int
)paren
id|sk
suffix:semicolon
id|llc-&gt;ack_timer.timer.function
op_assign
id|llc_conn_ack_tmr_cb
suffix:semicolon
id|add_timer
c_func
(paren
op_amp
id|llc-&gt;ack_timer.timer
)paren
suffix:semicolon
id|llc-&gt;ack_timer.running
op_assign
l_int|1
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|llc-&gt;failed_data_req
)paren
(brace
id|llc_pdu_decode_pf_bit
c_func
(paren
id|skb
comma
op_amp
id|fbit
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fbit
op_eq
l_int|1
)paren
(brace
id|llc-&gt;failed_data_req
op_assign
l_int|0
suffix:semicolon
id|llc_conn_ac_data_confirm
c_func
(paren
id|sk
comma
id|ev
)paren
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_upd_p_flag
r_int
id|llc_conn_ac_upd_p_flag
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|ev-&gt;data.pdu.skb
suffix:semicolon
id|llc_pdu_sn_t
op_star
id|rx_pdu
op_assign
(paren
id|llc_pdu_sn_t
op_star
)paren
id|skb-&gt;nh.raw
suffix:semicolon
id|u8
id|f_bit
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|LLC_PDU_IS_RSP
c_func
(paren
id|rx_pdu
)paren
op_logical_and
op_logical_neg
id|llc_pdu_decode_pf_bit
c_func
(paren
id|skb
comma
op_amp
id|f_bit
)paren
op_logical_and
id|f_bit
)paren
(brace
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|p_flag
op_assign
l_int|0
suffix:semicolon
id|llc_conn_ac_stop_p_timer
c_func
(paren
id|sk
comma
id|ev
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_set_data_flag_2
r_int
id|llc_conn_ac_set_data_flag_2
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|data_flag
op_assign
l_int|2
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_set_data_flag_0
r_int
id|llc_conn_ac_set_data_flag_0
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|data_flag
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_set_data_flag_1
r_int
id|llc_conn_ac_set_data_flag_1
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|data_flag
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_set_data_flag_1_if_data_flag_eq_0
r_int
id|llc_conn_ac_set_data_flag_1_if_data_flag_eq_0
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|data_flag
)paren
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|data_flag
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_set_p_flag_0
r_int
id|llc_conn_ac_set_p_flag_0
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|p_flag
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_set_p_flag_1
r_int
id|llc_conn_ac_set_p_flag_1
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|p_flag
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_set_remote_busy_0
r_int
id|llc_conn_ac_set_remote_busy_0
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|remote_busy_flag
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_set_cause_flag_0
r_int
id|llc_conn_ac_set_cause_flag_0
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|cause_flag
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_set_cause_flag_1
r_int
id|llc_conn_ac_set_cause_flag_1
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|cause_flag
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_set_retry_cnt_0
r_int
id|llc_conn_ac_set_retry_cnt_0
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|retry_count
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_inc_retry_cnt_by_1
r_int
id|llc_conn_ac_inc_retry_cnt_by_1
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|retry_count
op_increment
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_set_vr_0
r_int
id|llc_conn_ac_set_vr_0
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|vR
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_inc_vr_by_1
r_int
id|llc_conn_ac_inc_vr_by_1
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|vR
op_assign
id|PDU_GET_NEXT_Vr
c_func
(paren
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|vR
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_set_vs_0
r_int
id|llc_conn_ac_set_vs_0
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|vS
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_set_vs_nr
r_int
id|llc_conn_ac_set_vs_nr
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|vS
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|last_nr
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_inc_vs_by_1
r_int
id|llc_conn_ac_inc_vs_by_1
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|vS
op_assign
(paren
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|vS
op_plus
l_int|1
)paren
op_mod
l_int|128
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_set_f_flag_p
r_int
id|llc_conn_ac_set_f_flag_p
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|llc_pdu_decode_pf_bit
c_func
(paren
id|ev-&gt;data.pdu.skb
comma
op_amp
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|f_flag
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_pf_cycle_tmr_cb
r_void
id|llc_conn_pf_cycle_tmr_cb
c_func
(paren
r_int
r_int
id|timeout_data
)paren
(brace
r_struct
id|sock
op_star
id|sk
op_assign
(paren
r_struct
id|sock
op_star
)paren
id|timeout_data
suffix:semicolon
r_struct
id|llc_conn_state_ev
op_star
id|ev
suffix:semicolon
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|pf_cycle_timer.running
op_assign
l_int|0
suffix:semicolon
id|ev
op_assign
id|llc_conn_alloc_ev
c_func
(paren
id|sk
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ev
)paren
(brace
id|ev-&gt;type
op_assign
id|LLC_CONN_EV_TYPE_P_TMR
suffix:semicolon
id|ev-&gt;data.tmr.timer_specific
op_assign
l_int|NULL
suffix:semicolon
id|llc_process_tmr_ev
c_func
(paren
id|sk
comma
id|ev
)paren
suffix:semicolon
)brace
)brace
DECL|function|llc_conn_busy_tmr_cb
r_static
r_void
id|llc_conn_busy_tmr_cb
c_func
(paren
r_int
r_int
id|timeout_data
)paren
(brace
r_struct
id|sock
op_star
id|sk
op_assign
(paren
r_struct
id|sock
op_star
)paren
id|timeout_data
suffix:semicolon
r_struct
id|llc_conn_state_ev
op_star
id|ev
suffix:semicolon
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|busy_state_timer.running
op_assign
l_int|0
suffix:semicolon
id|ev
op_assign
id|llc_conn_alloc_ev
c_func
(paren
id|sk
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ev
)paren
(brace
id|ev-&gt;type
op_assign
id|LLC_CONN_EV_TYPE_BUSY_TMR
suffix:semicolon
id|ev-&gt;data.tmr.timer_specific
op_assign
l_int|NULL
suffix:semicolon
id|llc_process_tmr_ev
c_func
(paren
id|sk
comma
id|ev
)paren
suffix:semicolon
)brace
)brace
DECL|function|llc_conn_ack_tmr_cb
r_void
id|llc_conn_ack_tmr_cb
c_func
(paren
r_int
r_int
id|timeout_data
)paren
(brace
r_struct
id|sock
op_star
id|sk
op_assign
(paren
r_struct
id|sock
op_star
)paren
id|timeout_data
suffix:semicolon
r_struct
id|llc_conn_state_ev
op_star
id|ev
suffix:semicolon
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|ack_timer.running
op_assign
l_int|0
suffix:semicolon
id|ev
op_assign
id|llc_conn_alloc_ev
c_func
(paren
id|sk
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ev
)paren
(brace
id|ev-&gt;type
op_assign
id|LLC_CONN_EV_TYPE_ACK_TMR
suffix:semicolon
id|ev-&gt;data.tmr.timer_specific
op_assign
l_int|NULL
suffix:semicolon
id|llc_process_tmr_ev
c_func
(paren
id|sk
comma
id|ev
)paren
suffix:semicolon
)brace
)brace
DECL|function|llc_conn_rej_tmr_cb
r_static
r_void
id|llc_conn_rej_tmr_cb
c_func
(paren
r_int
r_int
id|timeout_data
)paren
(brace
r_struct
id|sock
op_star
id|sk
op_assign
(paren
r_struct
id|sock
op_star
)paren
id|timeout_data
suffix:semicolon
r_struct
id|llc_conn_state_ev
op_star
id|ev
suffix:semicolon
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|rej_sent_timer.running
op_assign
l_int|0
suffix:semicolon
id|ev
op_assign
id|llc_conn_alloc_ev
c_func
(paren
id|sk
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ev
)paren
(brace
id|ev-&gt;type
op_assign
id|LLC_CONN_EV_TYPE_REJ_TMR
suffix:semicolon
id|ev-&gt;data.tmr.timer_specific
op_assign
l_int|NULL
suffix:semicolon
id|llc_process_tmr_ev
c_func
(paren
id|sk
comma
id|ev
)paren
suffix:semicolon
)brace
)brace
DECL|function|llc_conn_ac_rst_vs
r_int
id|llc_conn_ac_rst_vs
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|X
op_assign
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|vS
suffix:semicolon
id|llc_conn_ac_set_vs_nr
c_func
(paren
id|sk
comma
id|ev
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_conn_ac_upd_vs
r_int
id|llc_conn_ac_upd_vs
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|llc_pdu_sn_t
op_star
id|rx_pdu
op_assign
(paren
id|llc_pdu_sn_t
op_star
)paren
id|ev-&gt;data.pdu.skb-&gt;nh.raw
suffix:semicolon
id|u8
id|nr
op_assign
id|PDU_SUPV_GET_Nr
c_func
(paren
id|rx_pdu
)paren
suffix:semicolon
r_if
c_cond
(paren
id|llc_circular_between
c_func
(paren
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|vS
comma
id|nr
comma
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|X
)paren
)paren
id|llc_conn_ac_set_vs_nr
c_func
(paren
id|sk
comma
id|ev
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * Non-standard actions; these not contained in IEEE specification; for&n; * our own usage&n; */
multiline_comment|/**&n; *&t;llc_conn_disc - removes connection from SAP list and frees it&n; *&t;@sk: closed connection&n; *&t;@ev: occurred event&n; *&n; *&t;Returns 2, to indicate the state machine that the connection was freed.&n; */
DECL|function|llc_conn_disc
r_int
id|llc_conn_disc
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|llc_sap_unassign_sock
c_func
(paren
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|sap
comma
id|sk
)paren
suffix:semicolon
id|llc_sock_free
c_func
(paren
id|sk
)paren
suffix:semicolon
r_return
l_int|2
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;llc_conn_reset - resets connection&n; *&t;@sk : reseting connection.&n; *&t;@ev: occurred event.&n; *&n; *&t;Stop all timers, empty all queues and reset all flags.&n; */
DECL|function|llc_conn_reset
r_int
id|llc_conn_reset
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|llc_sock_reset
c_func
(paren
id|sk
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;llc_circular_between - designates that b is between a and c or not&n; *&t;@a: lower bound&n; *&t;@b: element to see if is between a and b&n; *&t;@c: upper bound&n; *&n; *&t;This function designates that b is between a and c or not (for example,&n; *&t;0 is between 127 and 1). Returns 1 if b is between a and c, 0&n; *&t;otherwise.&n; */
DECL|function|llc_circular_between
id|u8
id|llc_circular_between
c_func
(paren
id|u8
id|a
comma
id|u8
id|b
comma
id|u8
id|c
)paren
(brace
id|b
op_assign
id|b
op_minus
id|a
suffix:semicolon
id|c
op_assign
id|c
op_minus
id|a
suffix:semicolon
r_return
id|b
op_le
id|c
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;llc_process_tmr_ev - timer backend&n; *&t;@sk: active connection&n; *&t;@ev: occurred event&n; *&n; *&t;This function is called from timer callback functions. When connection&n; *&t;is busy (during sending a data frame) timer expiration event must be&n; *&t;queued. Otherwise this event can be sent to connection state machine.&n; *&t;Queued events will process by process_rxframes_events function after&n; *&t;sending data frame. Returns 0 for success, 1 otherwise.&n; */
DECL|function|llc_process_tmr_ev
r_static
r_void
id|llc_process_tmr_ev
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|llc_conn_state_ev
op_star
id|ev
)paren
(brace
id|bh_lock_sock
c_func
(paren
id|sk
)paren
suffix:semicolon
r_if
c_cond
(paren
id|llc_sk
c_func
(paren
id|sk
)paren
op_member_access_from_pointer
id|state
op_eq
id|LLC_CONN_OUT_OF_SVC
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;timer called on closed connection&bslash;n&quot;
)paren
suffix:semicolon
id|llc_conn_free_ev
c_func
(paren
id|ev
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|sk-&gt;lock.users
)paren
id|llc_conn_send_ev
c_func
(paren
id|sk
comma
id|ev
)paren
suffix:semicolon
r_else
(brace
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|alloc_skb
c_func
(paren
l_int|1
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb
)paren
(brace
id|skb-&gt;cb
(braket
l_int|0
)braket
op_assign
id|LLC_EVENT
suffix:semicolon
id|skb-&gt;data
op_assign
(paren
r_void
op_star
)paren
id|ev
suffix:semicolon
id|sk_add_backlog
c_func
(paren
id|sk
comma
id|skb
)paren
suffix:semicolon
)brace
r_else
id|llc_conn_free_ev
c_func
(paren
id|ev
)paren
suffix:semicolon
)brace
id|out
suffix:colon
id|bh_unlock_sock
c_func
(paren
id|sk
)paren
suffix:semicolon
)brace
eof
