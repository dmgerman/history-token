multiline_comment|/*&n; * llc_pdu.c - access to PDU internals&n; *&n; * Copyright (c) 1997 by Procom Technology, Inc.&n; *&t;&t; 2001 by Arnaldo Carvalho de Melo &lt;acme@conectiva.com.br&gt;&n; *&n; * This program can be redistributed or modified under the terms of the&n; * GNU General Public License as published by the Free Software Foundation.&n; * This program is distributed without any warranty or implied warranty&n; * of merchantability or fitness for a particular purpose.&n; *&n; * See the GNU General Public License for more details.&n; */
macro_line|#include &lt;linux/netdevice.h&gt;
macro_line|#include &lt;linux/if_tr.h&gt;
macro_line|#include &lt;net/llc_pdu.h&gt;
macro_line|#include &lt;net/llc_if.h&gt;
macro_line|#include &lt;net/llc_mac.h&gt;
macro_line|#include &lt;net/llc_main.h&gt;
r_static
r_int
id|llc_pdu_decode_pdu_type
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
id|u8
op_star
id|type
)paren
suffix:semicolon
r_static
r_int
id|llc_get_llc_hdr_length
c_func
(paren
id|u8
id|pdu_type
)paren
suffix:semicolon
r_static
id|u8
id|llc_pdu_get_pf_bit
c_func
(paren
id|llc_pdu_sn_t
op_star
id|pdu
)paren
suffix:semicolon
multiline_comment|/**&n; *&t;llc_pdu_header_init - initializes pdu header&n; *&t;@skb: input skb that header must be set into it.&n; *&t;@pdu_type: type of PDU (U, I or S).&n; *&t;@ssap: source sap.&n; *&t;@dsap: destination sap.&n; *&t;@cr: command/response bit (0 or 1).&n; *&n; *&t;This function sets DSAP, SSAP and command/Response bit in LLC header.&n; */
DECL|function|llc_pdu_header_init
r_void
id|llc_pdu_header_init
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
id|u8
id|pdu_type
comma
id|u8
id|ssap
comma
id|u8
id|dsap
comma
id|u8
id|cr
)paren
(brace
id|llc_pdu_un_t
op_star
id|p
suffix:semicolon
id|skb-&gt;nh.raw
op_assign
id|skb_push
c_func
(paren
id|skb
comma
id|llc_get_llc_hdr_length
c_func
(paren
id|pdu_type
)paren
)paren
suffix:semicolon
id|p
op_assign
(paren
id|llc_pdu_un_t
op_star
)paren
id|skb-&gt;nh.raw
suffix:semicolon
id|p-&gt;dsap
op_assign
id|dsap
suffix:semicolon
id|p-&gt;ssap
op_assign
id|ssap
suffix:semicolon
id|p-&gt;ssap
op_or_assign
id|cr
suffix:semicolon
)brace
DECL|function|llc_pdu_set_cmd_rsp
r_void
id|llc_pdu_set_cmd_rsp
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
id|u8
id|pdu_type
)paren
(brace
(paren
(paren
id|llc_pdu_un_t
op_star
)paren
id|skb-&gt;nh.raw
)paren
op_member_access_from_pointer
id|ssap
op_or_assign
id|pdu_type
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;pdu_set_pf_bit - sets poll/final bit in LLC header&n; *&t;@pdu_frame: input frame that p/f bit must be set into it.&n; *&t;@bit_value: poll/final bit (0 or 1).&n; *&n; *&t;This function sets poll/final bit in LLC header (based on type of PDU).&n; *&t;in I or S pdus, p/f bit is right bit of fourth byte in header. in U&n; *&t;pdus p/f bit is fifth bit of third byte.&n; */
DECL|function|llc_pdu_set_pf_bit
r_void
id|llc_pdu_set_pf_bit
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
id|u8
id|bit_value
)paren
(brace
id|u8
id|pdu_type
suffix:semicolon
r_if
c_cond
(paren
id|llc_pdu_decode_pdu_type
c_func
(paren
id|skb
comma
op_amp
id|pdu_type
)paren
)paren
r_goto
id|out
suffix:semicolon
r_switch
c_cond
(paren
id|pdu_type
)paren
(brace
r_case
id|LLC_PDU_TYPE_I
suffix:colon
r_case
id|LLC_PDU_TYPE_S
suffix:colon
(paren
(paren
id|llc_pdu_sn_t
op_star
)paren
id|skb-&gt;nh.raw
)paren
op_member_access_from_pointer
id|ctrl_2
op_assign
(paren
(paren
(paren
id|llc_pdu_sn_t
op_star
)paren
id|skb-&gt;nh.raw
)paren
op_member_access_from_pointer
id|ctrl_2
op_amp
l_int|0xFE
)paren
op_or
id|bit_value
suffix:semicolon
r_break
suffix:semicolon
r_case
id|LLC_PDU_TYPE_U
suffix:colon
(paren
(paren
id|llc_pdu_un_t
op_star
)paren
id|skb-&gt;nh.raw
)paren
op_member_access_from_pointer
id|ctrl_1
op_or_assign
(paren
(paren
(paren
id|llc_pdu_un_t
op_star
)paren
id|skb-&gt;nh.raw
)paren
op_member_access_from_pointer
id|ctrl_1
op_amp
l_int|0xEF
)paren
op_or
(paren
id|bit_value
op_lshift
l_int|4
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|out
suffix:colon
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;llc_pdu_decode_pf_bit - extracs poll/final bit from LLC header&n; *&t;@skb: input skb that p/f bit must be extracted from it&n; *&t;@pf_bit: poll/final bit (0 or 1)&n; *&n; *&t;This function extracts poll/final bit from LLC header (based on type of&n; *&t;PDU). In I or S pdus, p/f bit is right bit of fourth byte in header. In&n; *&t;U pdus p/f bit is fifth bit of third byte.&n; */
DECL|function|llc_pdu_decode_pf_bit
r_int
id|llc_pdu_decode_pf_bit
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
id|u8
op_star
id|pf_bit
)paren
(brace
id|u8
id|pdu_type
suffix:semicolon
r_int
id|rc
op_assign
id|llc_pdu_decode_pdu_type
c_func
(paren
id|skb
comma
op_amp
id|pdu_type
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rc
)paren
r_goto
id|out
suffix:semicolon
r_switch
c_cond
(paren
id|pdu_type
)paren
(brace
r_case
id|LLC_PDU_TYPE_I
suffix:colon
r_case
id|LLC_PDU_TYPE_S
suffix:colon
op_star
id|pf_bit
op_assign
(paren
(paren
id|llc_pdu_sn_t
op_star
)paren
id|skb-&gt;nh.raw
)paren
op_member_access_from_pointer
id|ctrl_2
op_amp
id|LLC_S_PF_BIT_MASK
suffix:semicolon
r_break
suffix:semicolon
r_case
id|LLC_PDU_TYPE_U
suffix:colon
op_star
id|pf_bit
op_assign
(paren
(paren
(paren
id|llc_pdu_un_t
op_star
)paren
id|skb-&gt;nh.raw
)paren
op_member_access_from_pointer
id|ctrl_1
op_amp
id|LLC_U_PF_BIT_MASK
)paren
op_rshift
l_int|4
suffix:semicolon
r_break
suffix:semicolon
)brace
id|out
suffix:colon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;llc_pdu_decode_cr_bit - extracs command response bit from LLC header&n; *&t;@skb: input skb that c/r bit must be extracted from it.&n; *&t;@cr_bit: command/response bit (0 or 1).&n; *&n; *&t;This function extracts command/response bit from LLC header. this bit&n; *&t;is right bit of source SAP.&n; */
DECL|function|llc_pdu_decode_cr_bit
r_int
id|llc_pdu_decode_cr_bit
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
id|u8
op_star
id|cr_bit
)paren
(brace
op_star
id|cr_bit
op_assign
(paren
(paren
id|llc_pdu_un_t
op_star
)paren
id|skb-&gt;nh.raw
)paren
op_member_access_from_pointer
id|ssap
op_amp
id|LLC_PDU_CMD_RSP_MASK
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;llc_pdu_decode_sa - extracs source address (MAC) of input frame&n; *&t;@skb: input skb that source address must be extracted from it.&n; *&t;@sa: pointer to source address (6 byte array).&n; *&n; *&t;This function extracts source address(MAC) of input frame.&n; */
DECL|function|llc_pdu_decode_sa
r_int
id|llc_pdu_decode_sa
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
id|u8
op_star
id|sa
)paren
(brace
r_if
c_cond
(paren
id|skb-&gt;protocol
op_eq
id|ntohs
c_func
(paren
id|ETH_P_802_2
)paren
)paren
id|memcpy
c_func
(paren
id|sa
comma
(paren
(paren
r_struct
id|ethhdr
op_star
)paren
id|skb-&gt;mac.raw
)paren
op_member_access_from_pointer
id|h_source
comma
id|ETH_ALEN
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|skb-&gt;protocol
op_eq
id|ntohs
c_func
(paren
id|ETH_P_TR_802_2
)paren
)paren
id|memcpy
c_func
(paren
id|sa
comma
(paren
(paren
r_struct
id|trh_hdr
op_star
)paren
id|skb-&gt;mac.raw
)paren
op_member_access_from_pointer
id|saddr
comma
id|ETH_ALEN
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;llc_pdu_decode_da - extracts dest address of input frame&n; *&t;@skb: input skb that destination address must be extracted from it&n; *&t;@sa: pointer to destination address (6 byte array).&n; *&n; *&t;This function extracts destination address(MAC) of input frame.&n; */
DECL|function|llc_pdu_decode_da
r_int
id|llc_pdu_decode_da
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
id|u8
op_star
id|da
)paren
(brace
r_if
c_cond
(paren
id|skb-&gt;protocol
op_eq
id|ntohs
c_func
(paren
id|ETH_P_802_2
)paren
)paren
id|memcpy
c_func
(paren
id|da
comma
(paren
(paren
r_struct
id|ethhdr
op_star
)paren
id|skb-&gt;mac.raw
)paren
op_member_access_from_pointer
id|h_dest
comma
id|ETH_ALEN
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|skb-&gt;protocol
op_eq
id|ntohs
c_func
(paren
id|ETH_P_TR_802_2
)paren
)paren
id|memcpy
c_func
(paren
id|da
comma
(paren
(paren
r_struct
id|trh_hdr
op_star
)paren
id|skb-&gt;mac.raw
)paren
op_member_access_from_pointer
id|daddr
comma
id|ETH_ALEN
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;llc_pdu_decode_dsap - extracts dest SAP of input frame&n; *&t;@skb: input skb that destination SAP must be extracted from it.&n; *&t;@dsap: destination SAP (output argument).&n; *&n; *&t;This function extracts destination SAP of input frame. right bit of&n; *&t;DSAP designates individual/group SAP.&n; */
DECL|function|llc_pdu_decode_dsap
r_int
id|llc_pdu_decode_dsap
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
id|u8
op_star
id|dsap
)paren
(brace
op_star
id|dsap
op_assign
(paren
(paren
id|llc_pdu_un_t
op_star
)paren
id|skb-&gt;nh.raw
)paren
op_member_access_from_pointer
id|dsap
op_amp
l_int|0xFE
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;llc_pdu_decode_ssap - extracts source SAP of input frame&n; *&t;@skb: input skb that source SAP must be extracted from it.&n; *&t;@ssap: source SAP (output argument).&n; *&n; *&t;This function extracts source SAP of input frame. right bit of SSAP is&n; *&t;command/response bit.&n; */
DECL|function|llc_pdu_decode_ssap
r_int
id|llc_pdu_decode_ssap
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
id|u8
op_star
id|ssap
)paren
(brace
op_star
id|ssap
op_assign
(paren
(paren
id|llc_pdu_un_t
op_star
)paren
id|skb-&gt;nh.raw
)paren
op_member_access_from_pointer
id|ssap
op_amp
l_int|0xFE
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;llc_pdu_init_as_ui_cmd - sets LLC header as UI PDU&n; *&t;@skb: input skb that header must be set into it.&n; *&n; *&t;This function sets third byte of LLC header as a UI PDU.&n; */
DECL|function|llc_pdu_init_as_ui_cmd
r_int
id|llc_pdu_init_as_ui_cmd
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
)paren
(brace
id|llc_pdu_un_t
op_star
id|pdu
op_assign
(paren
id|llc_pdu_un_t
op_star
)paren
id|skb-&gt;nh.raw
suffix:semicolon
id|pdu-&gt;ctrl_1
op_assign
id|LLC_PDU_TYPE_U
suffix:semicolon
id|pdu-&gt;ctrl_1
op_or_assign
id|LLC_1_PDU_CMD_UI
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;llc_pdu_init_as_xid_cmd - sets bytes 3, 4 &amp; 5 of LLC header as XID&n; *&t;@skb: input skb that header must be set into it.&n; *&n; *&t;This function sets third,fourth,fifth and sixth bytes of LLC header as&n; *&t;a XID PDU.&n; */
DECL|function|llc_pdu_init_as_xid_cmd
r_int
id|llc_pdu_init_as_xid_cmd
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
id|u8
id|svcs_supported
comma
id|u8
id|rx_window
)paren
(brace
id|llc_xid_info_t
op_star
id|xid_info
suffix:semicolon
id|llc_pdu_un_t
op_star
id|pdu
op_assign
(paren
id|llc_pdu_un_t
op_star
)paren
id|skb-&gt;nh.raw
suffix:semicolon
id|pdu-&gt;ctrl_1
op_assign
id|LLC_PDU_TYPE_U
suffix:semicolon
id|pdu-&gt;ctrl_1
op_or_assign
id|LLC_1_PDU_CMD_XID
suffix:semicolon
id|pdu-&gt;ctrl_1
op_or_assign
id|LLC_U_PF_BIT_MASK
suffix:semicolon
id|xid_info
op_assign
(paren
id|llc_xid_info_t
op_star
)paren
(paren
(paren
(paren
id|u8
op_star
)paren
op_amp
id|pdu-&gt;ctrl_1
)paren
op_plus
l_int|1
)paren
suffix:semicolon
id|xid_info-&gt;fmt_id
op_assign
id|LLC_XID_FMT_ID
suffix:semicolon
multiline_comment|/* 0x81 */
id|xid_info-&gt;type
op_assign
id|svcs_supported
suffix:semicolon
id|xid_info-&gt;rw
op_assign
id|rx_window
op_lshift
l_int|1
suffix:semicolon
multiline_comment|/* size of recieve window */
id|skb_put
c_func
(paren
id|skb
comma
l_int|3
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;llc_pdu_init_as_test_cmd - sets PDU as TEST&n; *&t;@skb - Address of the skb to build&n; *&n; * &t;Sets a PDU as TEST&n; */
DECL|function|llc_pdu_init_as_test_cmd
r_int
id|llc_pdu_init_as_test_cmd
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
)paren
(brace
id|llc_pdu_un_t
op_star
id|pdu
op_assign
(paren
id|llc_pdu_un_t
op_star
)paren
id|skb-&gt;nh.raw
suffix:semicolon
id|pdu-&gt;ctrl_1
op_assign
id|LLC_PDU_TYPE_U
suffix:semicolon
id|pdu-&gt;ctrl_1
op_or_assign
id|LLC_1_PDU_CMD_TEST
suffix:semicolon
id|pdu-&gt;ctrl_1
op_or_assign
id|LLC_U_PF_BIT_MASK
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;llc_pdu_init_as_disc_cmd - Builds DISC PDU&n; *&t;@skb: Address of the skb to build&n; *&t;@p_bit: The P bit to set in the PDU&n; *&n; *&t;Builds a pdu frame as a DISC command.&n; */
DECL|function|llc_pdu_init_as_disc_cmd
r_int
id|llc_pdu_init_as_disc_cmd
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
id|u8
id|p_bit
)paren
(brace
id|llc_pdu_un_t
op_star
id|pdu
op_assign
(paren
id|llc_pdu_un_t
op_star
)paren
id|skb-&gt;nh.raw
suffix:semicolon
id|pdu-&gt;ctrl_1
op_assign
id|LLC_PDU_TYPE_U
suffix:semicolon
id|pdu-&gt;ctrl_1
op_or_assign
id|LLC_2_PDU_CMD_DISC
suffix:semicolon
id|pdu-&gt;ctrl_1
op_or_assign
(paren
(paren
id|p_bit
op_amp
l_int|1
)paren
op_lshift
l_int|4
)paren
op_amp
id|LLC_U_PF_BIT_MASK
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;pdu_init_as_i_cmd - builds I pdu&n; *&t;@skb: Address of the skb to build&n; *&t;@p_bit: The P bit to set in the PDU&n; *&t;@ns: The sequence number of the data PDU&n; *&t;@nr: The seq. number of the expected I PDU from the remote&n; *&n; *&t;Builds a pdu frame as an I command.&n; */
DECL|function|llc_pdu_init_as_i_cmd
r_int
id|llc_pdu_init_as_i_cmd
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
id|u8
id|p_bit
comma
id|u8
id|ns
comma
id|u8
id|nr
)paren
(brace
id|llc_pdu_sn_t
op_star
id|pdu
op_assign
(paren
id|llc_pdu_sn_t
op_star
)paren
id|skb-&gt;nh.raw
suffix:semicolon
id|pdu-&gt;ctrl_1
op_assign
id|LLC_PDU_TYPE_I
suffix:semicolon
id|pdu-&gt;ctrl_2
op_assign
l_int|0
suffix:semicolon
id|pdu-&gt;ctrl_2
op_or_assign
(paren
id|p_bit
op_amp
id|LLC_I_PF_BIT_MASK
)paren
suffix:semicolon
multiline_comment|/* p/f bit */
id|pdu-&gt;ctrl_1
op_or_assign
(paren
id|ns
op_lshift
l_int|1
)paren
op_amp
l_int|0xFE
suffix:semicolon
multiline_comment|/* set N(S) in bits 2..8 */
id|pdu-&gt;ctrl_2
op_or_assign
(paren
id|nr
op_lshift
l_int|1
)paren
op_amp
l_int|0xFE
suffix:semicolon
multiline_comment|/* set N(R) in bits 10..16 */
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;pdu_init_as_rej_cmd - builds REJ PDU&n; *&t;@skb: Address of the skb to build&n; *&t;@p_bit: The P bit to set in the PDU&n; *&t;@nr: The seq. number of the expected I PDU from the remote&n; *&n; *&t;Builds a pdu frame as a REJ command.&n; */
DECL|function|llc_pdu_init_as_rej_cmd
r_int
id|llc_pdu_init_as_rej_cmd
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
id|u8
id|p_bit
comma
id|u8
id|nr
)paren
(brace
id|llc_pdu_sn_t
op_star
id|pdu
op_assign
(paren
id|llc_pdu_sn_t
op_star
)paren
id|skb-&gt;nh.raw
suffix:semicolon
id|pdu-&gt;ctrl_1
op_assign
id|LLC_PDU_TYPE_S
suffix:semicolon
id|pdu-&gt;ctrl_1
op_or_assign
id|LLC_2_PDU_CMD_REJ
suffix:semicolon
id|pdu-&gt;ctrl_2
op_assign
l_int|0
suffix:semicolon
id|pdu-&gt;ctrl_2
op_or_assign
id|p_bit
op_amp
id|LLC_S_PF_BIT_MASK
suffix:semicolon
id|pdu-&gt;ctrl_1
op_and_assign
l_int|0x0F
suffix:semicolon
multiline_comment|/* setting bits 5..8 to zero(reserved) */
id|pdu-&gt;ctrl_2
op_or_assign
(paren
id|nr
op_lshift
l_int|1
)paren
op_amp
l_int|0xFE
suffix:semicolon
multiline_comment|/* set N(R) in bits 10..16 */
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;pdu_init_as_rnr_cmd - builds RNR pdu&n; *&t;@skb: Address of the skb to build&n; *&t;@p_bit: The P bit to set in the PDU&n; *&t;@nr: The seq. number of the expected I PDU from the remote&n; *&n; *&t;Builds a pdu frame as an RNR command.&n; */
DECL|function|llc_pdu_init_as_rnr_cmd
r_int
id|llc_pdu_init_as_rnr_cmd
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
id|u8
id|p_bit
comma
id|u8
id|nr
)paren
(brace
id|llc_pdu_sn_t
op_star
id|pdu
op_assign
(paren
id|llc_pdu_sn_t
op_star
)paren
id|skb-&gt;nh.raw
suffix:semicolon
id|pdu-&gt;ctrl_1
op_assign
id|LLC_PDU_TYPE_S
suffix:semicolon
id|pdu-&gt;ctrl_1
op_or_assign
id|LLC_2_PDU_CMD_RNR
suffix:semicolon
id|pdu-&gt;ctrl_2
op_assign
l_int|0
suffix:semicolon
id|pdu-&gt;ctrl_2
op_or_assign
id|p_bit
op_amp
id|LLC_S_PF_BIT_MASK
suffix:semicolon
id|pdu-&gt;ctrl_1
op_and_assign
l_int|0x0F
suffix:semicolon
multiline_comment|/* setting bits 5..8 to zero(reserved) */
id|pdu-&gt;ctrl_2
op_or_assign
(paren
id|nr
op_lshift
l_int|1
)paren
op_amp
l_int|0xFE
suffix:semicolon
multiline_comment|/* set N(R) in bits 10..16 */
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;pdu_init_as_rr_cmd - Builds RR pdu&n; *&t;@skb: Address of the skb to build&n; *&t;@p_bit: The P bit to set in the PDU&n; *&t;@nr: The seq. number of the expected I PDU from the remote&n; *&n; *&t;Builds a pdu frame as an RR command.&n; */
DECL|function|llc_pdu_init_as_rr_cmd
r_int
id|llc_pdu_init_as_rr_cmd
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
id|u8
id|p_bit
comma
id|u8
id|nr
)paren
(brace
id|llc_pdu_sn_t
op_star
id|pdu
op_assign
(paren
id|llc_pdu_sn_t
op_star
)paren
id|skb-&gt;nh.raw
suffix:semicolon
id|pdu-&gt;ctrl_1
op_assign
id|LLC_PDU_TYPE_S
suffix:semicolon
id|pdu-&gt;ctrl_1
op_or_assign
id|LLC_2_PDU_CMD_RR
suffix:semicolon
id|pdu-&gt;ctrl_2
op_assign
id|p_bit
op_amp
id|LLC_S_PF_BIT_MASK
suffix:semicolon
id|pdu-&gt;ctrl_1
op_and_assign
l_int|0x0F
suffix:semicolon
multiline_comment|/* setting bits 5..8 to zero(reserved) */
id|pdu-&gt;ctrl_2
op_or_assign
(paren
id|nr
op_lshift
l_int|1
)paren
op_amp
l_int|0xFE
suffix:semicolon
multiline_comment|/* set N(R) in bits 10..16 */
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;pdu_init_as_sabme_cmd - builds SABME pdu&n; *&t;@skb: Address of the skb to build&n; *&t;@p_bit: The P bit to set in the PDU&n; *&n; *&t;Builds a pdu frame as an SABME command.&n; */
DECL|function|llc_pdu_init_as_sabme_cmd
r_int
id|llc_pdu_init_as_sabme_cmd
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
id|u8
id|p_bit
)paren
(brace
id|llc_pdu_un_t
op_star
id|pdu
op_assign
(paren
id|llc_pdu_un_t
op_star
)paren
id|skb-&gt;nh.raw
suffix:semicolon
id|pdu-&gt;ctrl_1
op_assign
id|LLC_PDU_TYPE_U
suffix:semicolon
id|pdu-&gt;ctrl_1
op_or_assign
id|LLC_2_PDU_CMD_SABME
suffix:semicolon
id|pdu-&gt;ctrl_1
op_or_assign
(paren
(paren
id|p_bit
op_amp
l_int|1
)paren
op_lshift
l_int|4
)paren
op_amp
id|LLC_U_PF_BIT_MASK
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;pdu_init_as_dm_rsp - builds DM response pdu&n; *&t;@skb: Address of the skb to build&n; *&t;@f_bit: The F bit to set in the PDU&n; *&n; *&t;Builds a pdu frame as a DM response.&n; */
DECL|function|llc_pdu_init_as_dm_rsp
r_int
id|llc_pdu_init_as_dm_rsp
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
id|u8
id|f_bit
)paren
(brace
id|llc_pdu_un_t
op_star
id|pdu
op_assign
(paren
id|llc_pdu_un_t
op_star
)paren
id|skb-&gt;nh.raw
suffix:semicolon
id|pdu-&gt;ctrl_1
op_assign
id|LLC_PDU_TYPE_U
suffix:semicolon
id|pdu-&gt;ctrl_1
op_or_assign
id|LLC_2_PDU_RSP_DM
suffix:semicolon
id|pdu-&gt;ctrl_1
op_or_assign
(paren
(paren
id|f_bit
op_amp
l_int|1
)paren
op_lshift
l_int|4
)paren
op_amp
id|LLC_U_PF_BIT_MASK
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;pdu_init_as_xid_rsp - builds XID response PDU&n; *&t;@skb: Address of the skb to build&n; *&t;@svcs_supported: The class of the LLC (I or II)&n; *&t;@rx_window: The size of the receive window of the LLC&n; *&n; *&t;Builds a pdu frame as an XID response.&n; */
DECL|function|llc_pdu_init_as_xid_rsp
r_int
id|llc_pdu_init_as_xid_rsp
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
id|u8
id|svcs_supported
comma
id|u8
id|rx_window
)paren
(brace
id|llc_xid_info_t
op_star
id|xid_info
suffix:semicolon
id|llc_pdu_un_t
op_star
id|pdu
op_assign
(paren
id|llc_pdu_un_t
op_star
)paren
id|skb-&gt;nh.raw
suffix:semicolon
id|pdu-&gt;ctrl_1
op_assign
id|LLC_PDU_TYPE_U
suffix:semicolon
id|pdu-&gt;ctrl_1
op_or_assign
id|LLC_1_PDU_CMD_XID
suffix:semicolon
id|pdu-&gt;ctrl_1
op_or_assign
id|LLC_U_PF_BIT_MASK
suffix:semicolon
id|xid_info
op_assign
(paren
id|llc_xid_info_t
op_star
)paren
(paren
(paren
(paren
id|u8
op_star
)paren
op_amp
id|pdu-&gt;ctrl_1
)paren
op_plus
l_int|1
)paren
suffix:semicolon
id|xid_info-&gt;fmt_id
op_assign
id|LLC_XID_FMT_ID
suffix:semicolon
id|xid_info-&gt;type
op_assign
id|svcs_supported
suffix:semicolon
id|xid_info-&gt;rw
op_assign
id|rx_window
op_lshift
l_int|1
suffix:semicolon
id|skb_put
c_func
(paren
id|skb
comma
l_int|3
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;pdu_init_as_test_rsp - build TEST response PDU&n; *&t;@skb: Address of the skb to build&n; *&t;@ev_skb: The received TEST command PDU frame&n; *&n; *&t;Builds a pdu frame as a TEST response.&n; */
DECL|function|llc_pdu_init_as_test_rsp
r_int
id|llc_pdu_init_as_test_rsp
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|sk_buff
op_star
id|ev_skb
)paren
(brace
r_int
id|dsize
suffix:semicolon
id|llc_pdu_un_t
op_star
id|pdu
op_assign
(paren
id|llc_pdu_un_t
op_star
)paren
id|skb-&gt;nh.raw
suffix:semicolon
id|pdu-&gt;ctrl_1
op_assign
id|LLC_PDU_TYPE_U
suffix:semicolon
id|pdu-&gt;ctrl_1
op_or_assign
id|LLC_1_PDU_CMD_TEST
suffix:semicolon
id|pdu-&gt;ctrl_1
op_or_assign
id|LLC_U_PF_BIT_MASK
suffix:semicolon
r_if
c_cond
(paren
id|ev_skb-&gt;protocol
op_eq
id|ntohs
c_func
(paren
id|ETH_P_802_2
)paren
)paren
(brace
id|dsize
op_assign
id|ntohs
c_func
(paren
(paren
(paren
r_struct
id|ethhdr
op_star
)paren
id|ev_skb-&gt;mac.raw
)paren
op_member_access_from_pointer
id|h_proto
)paren
op_minus
l_int|3
suffix:semicolon
id|memcpy
c_func
(paren
(paren
(paren
id|u8
op_star
)paren
id|skb-&gt;nh.raw
)paren
op_plus
l_int|3
comma
(paren
(paren
id|u8
op_star
)paren
id|ev_skb-&gt;nh.raw
)paren
op_plus
l_int|3
comma
id|dsize
)paren
suffix:semicolon
id|skb_put
c_func
(paren
id|skb
comma
id|dsize
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;pdu_init_as_frmr_rsp - builds FRMR response PDU&n; *&t;@pdu_frame: Address of the frame to build&n; *&t;@prev_pdu: The rejected PDU frame&n; *&t;@f_bit: The F bit to set in the PDU&n; *&t;@vs: tx state vari value for the data link conn at the rejecting LLC&n; *&t;@vr: rx state var value for the data link conn at the rejecting LLC&n; *&t;@vzyxw: completely described in the IEEE Std 802.2 document (Pg 55)&n; *&n; *&t;Builds a pdu frame as a FRMR response.&n; */
DECL|function|llc_pdu_init_as_frmr_rsp
r_int
id|llc_pdu_init_as_frmr_rsp
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
id|llc_pdu_sn_t
op_star
id|prev_pdu
comma
id|u8
id|f_bit
comma
id|u8
id|vs
comma
id|u8
id|vr
comma
id|u8
id|vzyxw
)paren
(brace
id|llc_frmr_info_t
op_star
id|frmr_info
suffix:semicolon
id|u8
id|prev_pf
op_assign
l_int|0
suffix:semicolon
id|u8
op_star
id|ctrl
suffix:semicolon
id|llc_pdu_sn_t
op_star
id|pdu
op_assign
(paren
id|llc_pdu_sn_t
op_star
)paren
id|skb-&gt;nh.raw
suffix:semicolon
id|pdu-&gt;ctrl_1
op_assign
id|LLC_PDU_TYPE_U
suffix:semicolon
id|pdu-&gt;ctrl_1
op_or_assign
id|LLC_2_PDU_RSP_FRMR
suffix:semicolon
id|pdu-&gt;ctrl_1
op_or_assign
(paren
(paren
id|f_bit
op_amp
l_int|1
)paren
op_lshift
l_int|4
)paren
op_amp
id|LLC_U_PF_BIT_MASK
suffix:semicolon
id|frmr_info
op_assign
(paren
id|llc_frmr_info_t
op_star
)paren
op_amp
id|pdu-&gt;ctrl_2
suffix:semicolon
id|ctrl
op_assign
(paren
id|u8
op_star
)paren
op_amp
id|prev_pdu-&gt;ctrl_1
suffix:semicolon
id|FRMR_INFO_SET_REJ_CNTRL
c_func
(paren
id|frmr_info
comma
id|ctrl
)paren
suffix:semicolon
id|FRMR_INFO_SET_Vs
c_func
(paren
id|frmr_info
comma
id|vs
)paren
suffix:semicolon
id|FRMR_INFO_SET_Vr
c_func
(paren
id|frmr_info
comma
id|vr
)paren
suffix:semicolon
id|prev_pf
op_assign
id|llc_pdu_get_pf_bit
c_func
(paren
id|prev_pdu
)paren
suffix:semicolon
id|FRMR_INFO_SET_C_R_BIT
c_func
(paren
id|frmr_info
comma
id|prev_pf
)paren
suffix:semicolon
id|FRMR_INFO_SET_INVALID_PDU_CTRL_IND
c_func
(paren
id|frmr_info
comma
id|vzyxw
)paren
suffix:semicolon
id|FRMR_INFO_SET_INVALID_PDU_INFO_IND
c_func
(paren
id|frmr_info
comma
id|vzyxw
)paren
suffix:semicolon
id|FRMR_INFO_SET_PDU_INFO_2LONG_IND
c_func
(paren
id|frmr_info
comma
id|vzyxw
)paren
suffix:semicolon
id|FRMR_INFO_SET_PDU_INVALID_Nr_IND
c_func
(paren
id|frmr_info
comma
id|vzyxw
)paren
suffix:semicolon
id|FRMR_INFO_SET_PDU_INVALID_Ns_IND
c_func
(paren
id|frmr_info
comma
id|vzyxw
)paren
suffix:semicolon
id|skb_put
c_func
(paren
id|skb
comma
l_int|5
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;pdu_init_as_rr_rsp - builds RR response pdu&n; *&t;@skb: Address of the skb to build&n; *&t;@f_bit: The F bit to set in the PDU&n; *&t;@nr: The seq. number of the expected data PDU from the remote&n; *&n; *&t;Builds a pdu frame as an RR response.&n; */
DECL|function|llc_pdu_init_as_rr_rsp
r_int
id|llc_pdu_init_as_rr_rsp
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
id|u8
id|f_bit
comma
id|u8
id|nr
)paren
(brace
id|llc_pdu_sn_t
op_star
id|pdu
op_assign
(paren
id|llc_pdu_sn_t
op_star
)paren
id|skb-&gt;nh.raw
suffix:semicolon
id|pdu-&gt;ctrl_1
op_assign
id|LLC_PDU_TYPE_S
suffix:semicolon
id|pdu-&gt;ctrl_1
op_or_assign
id|LLC_2_PDU_RSP_RR
suffix:semicolon
id|pdu-&gt;ctrl_2
op_assign
l_int|0
suffix:semicolon
id|pdu-&gt;ctrl_2
op_or_assign
id|f_bit
op_amp
id|LLC_S_PF_BIT_MASK
suffix:semicolon
id|pdu-&gt;ctrl_1
op_and_assign
l_int|0x0F
suffix:semicolon
multiline_comment|/* setting bits 5..8 to zero(reserved) */
id|pdu-&gt;ctrl_2
op_or_assign
(paren
id|nr
op_lshift
l_int|1
)paren
op_amp
l_int|0xFE
suffix:semicolon
multiline_comment|/* set N(R) in bits 10..16 */
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;pdu_init_as_rej_rsp - builds REJ response pdu&n; *&t;@skb: Address of the skb to build&n; *&t;@f_bit: The F bit to set in the PDU&n; *&t;@nr: The seq. number of the expected data PDU from the remote&n; *&n; *&t;Builds a pdu frame as a REJ response.&n; */
DECL|function|llc_pdu_init_as_rej_rsp
r_int
id|llc_pdu_init_as_rej_rsp
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
id|u8
id|f_bit
comma
id|u8
id|nr
)paren
(brace
id|llc_pdu_sn_t
op_star
id|pdu
op_assign
(paren
id|llc_pdu_sn_t
op_star
)paren
id|skb-&gt;nh.raw
suffix:semicolon
id|pdu-&gt;ctrl_1
op_assign
id|LLC_PDU_TYPE_S
suffix:semicolon
id|pdu-&gt;ctrl_1
op_or_assign
id|LLC_2_PDU_RSP_REJ
suffix:semicolon
id|pdu-&gt;ctrl_2
op_assign
l_int|0
suffix:semicolon
id|pdu-&gt;ctrl_2
op_or_assign
id|f_bit
op_amp
id|LLC_S_PF_BIT_MASK
suffix:semicolon
id|pdu-&gt;ctrl_1
op_and_assign
l_int|0x0F
suffix:semicolon
multiline_comment|/* setting bits 5..8 to zero(reserved) */
id|pdu-&gt;ctrl_2
op_or_assign
(paren
id|nr
op_lshift
l_int|1
)paren
op_amp
l_int|0xFE
suffix:semicolon
multiline_comment|/* set N(R) in bits 10..16 */
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;pdu_init_as_rnr_rsp - builds RNR response pdu&n; *&t;@pdu_frame: Address of the frame to build&n; *&t;@f_bit: The F bit to set in the PDU&n; *&t;@nr: The seq. number of the expected data PDU from the remote&n; *&n; *&t;Builds a pdu frame as an RNR response.&n; */
DECL|function|llc_pdu_init_as_rnr_rsp
r_int
id|llc_pdu_init_as_rnr_rsp
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
id|u8
id|f_bit
comma
id|u8
id|nr
)paren
(brace
id|llc_pdu_sn_t
op_star
id|pdu
op_assign
(paren
id|llc_pdu_sn_t
op_star
)paren
id|skb-&gt;nh.raw
suffix:semicolon
id|pdu-&gt;ctrl_1
op_assign
id|LLC_PDU_TYPE_S
suffix:semicolon
id|pdu-&gt;ctrl_1
op_or_assign
id|LLC_2_PDU_RSP_RNR
suffix:semicolon
id|pdu-&gt;ctrl_2
op_assign
l_int|0
suffix:semicolon
id|pdu-&gt;ctrl_2
op_or_assign
id|f_bit
op_amp
id|LLC_S_PF_BIT_MASK
suffix:semicolon
id|pdu-&gt;ctrl_1
op_and_assign
l_int|0x0F
suffix:semicolon
multiline_comment|/* setting bits 5..8 to zero(reserved) */
id|pdu-&gt;ctrl_2
op_or_assign
(paren
id|nr
op_lshift
l_int|1
)paren
op_amp
l_int|0xFE
suffix:semicolon
multiline_comment|/* set N(R) in bits 10..16 */
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;pdu_init_as_ua_rsp - builds UA response pdu&n; *&t;@skb: Address of the frame to build&n; *&t;@f_bit: The F bit to set in the PDU&n; *&n; *&t;Builds a pdu frame as a UA response.&n; */
DECL|function|llc_pdu_init_as_ua_rsp
r_int
id|llc_pdu_init_as_ua_rsp
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
id|u8
id|f_bit
)paren
(brace
id|llc_pdu_un_t
op_star
id|pdu
op_assign
(paren
id|llc_pdu_un_t
op_star
)paren
id|skb-&gt;nh.raw
suffix:semicolon
id|pdu-&gt;ctrl_1
op_assign
id|LLC_PDU_TYPE_U
suffix:semicolon
id|pdu-&gt;ctrl_1
op_or_assign
id|LLC_2_PDU_RSP_UA
suffix:semicolon
id|pdu-&gt;ctrl_1
op_or_assign
(paren
(paren
id|f_bit
op_amp
l_int|1
)paren
op_lshift
l_int|4
)paren
op_amp
id|LLC_U_PF_BIT_MASK
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;llc_pdu_decode_pdu_type - designates PDU type&n; *&t;@skb: input skb that type of it must be designated.&n; *&t;@type: type of PDU (output argument).&n; *&n; *&t;This function designates type of PDU (I,S or U).&n; */
DECL|function|llc_pdu_decode_pdu_type
r_static
r_int
id|llc_pdu_decode_pdu_type
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
id|u8
op_star
id|type
)paren
(brace
id|llc_pdu_un_t
op_star
id|pdu
op_assign
(paren
id|llc_pdu_un_t
op_star
)paren
id|skb-&gt;nh.raw
suffix:semicolon
r_if
c_cond
(paren
id|pdu-&gt;ctrl_1
op_amp
l_int|1
)paren
(brace
r_if
c_cond
(paren
(paren
id|pdu-&gt;ctrl_1
op_amp
id|LLC_PDU_TYPE_U
)paren
op_eq
id|LLC_PDU_TYPE_U
)paren
op_star
id|type
op_assign
id|LLC_PDU_TYPE_U
suffix:semicolon
r_else
op_star
id|type
op_assign
id|LLC_PDU_TYPE_S
suffix:semicolon
)brace
r_else
op_star
id|type
op_assign
id|LLC_PDU_TYPE_I
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;llc_decode_pdu_type - designates component LLC must handle for PDU&n; *&t;@skb: input skb&n; *&t;@dest: destination component&n; *&n; *&t;This function designates which component of LLC must handle this PDU.&n; */
DECL|function|llc_decode_pdu_type
r_int
id|llc_decode_pdu_type
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
id|u8
op_star
id|dest
)paren
(brace
id|u8
id|type
op_assign
id|LLC_DEST_CONN
suffix:semicolon
multiline_comment|/* I-PDU or S-PDU type */
id|llc_pdu_sn_t
op_star
id|pdu
op_assign
(paren
id|llc_pdu_sn_t
op_star
)paren
id|skb-&gt;nh.raw
suffix:semicolon
r_if
c_cond
(paren
(paren
id|pdu-&gt;ctrl_1
op_amp
id|LLC_PDU_TYPE_MASK
)paren
op_ne
id|LLC_PDU_TYPE_U
)paren
r_goto
id|out
suffix:semicolon
r_switch
c_cond
(paren
id|LLC_U_PDU_CMD
c_func
(paren
id|pdu
)paren
)paren
(brace
r_case
id|LLC_1_PDU_CMD_XID
suffix:colon
r_case
id|LLC_1_PDU_CMD_UI
suffix:colon
r_case
id|LLC_1_PDU_CMD_TEST
suffix:colon
id|type
op_assign
id|LLC_DEST_SAP
suffix:semicolon
r_break
suffix:semicolon
r_case
id|LLC_2_PDU_CMD_SABME
suffix:colon
r_case
id|LLC_2_PDU_CMD_DISC
suffix:colon
r_case
id|LLC_2_PDU_RSP_UA
suffix:colon
r_case
id|LLC_2_PDU_RSP_DM
suffix:colon
r_case
id|LLC_2_PDU_RSP_FRMR
suffix:colon
r_break
suffix:semicolon
r_default
suffix:colon
id|type
op_assign
id|LLC_DEST_INVALID
suffix:semicolon
r_break
suffix:semicolon
)brace
id|out
suffix:colon
op_star
id|dest
op_assign
id|type
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;get_llc_hdr_len - designates LLC header length&n; *&t;@pdu_type: type of PDU.&n; *&n; *&t;This function designates LLC header length of PDU. header length for I&n; *&t;and S PDU is 4 and for U is 3 bytes. Returns the length of header.&n; */
DECL|function|llc_get_llc_hdr_length
r_static
r_int
id|llc_get_llc_hdr_length
c_func
(paren
id|u8
id|pdu_type
)paren
(brace
r_int
id|rtn_val
op_assign
l_int|0
suffix:semicolon
r_switch
c_cond
(paren
id|pdu_type
)paren
(brace
r_case
id|LLC_PDU_TYPE_I
suffix:colon
r_case
id|LLC_PDU_TYPE_S
suffix:colon
id|rtn_val
op_assign
l_int|4
suffix:semicolon
r_break
suffix:semicolon
r_case
id|LLC_PDU_TYPE_U
suffix:colon
id|rtn_val
op_assign
l_int|3
suffix:semicolon
r_break
suffix:semicolon
)brace
r_return
id|rtn_val
suffix:semicolon
)brace
multiline_comment|/**&n; *&t;llc_pdu_get_pf_bit - extracts p/f bit of input PDU&n; *&t;@pdu: pointer to LLC header.&n; *&n; *&t;This function extracts p/f bit of input PDU. at first examines type of&n; *&t;PDU and then extracts p/f bit. Returns the p/f bit.&n; */
DECL|function|llc_pdu_get_pf_bit
r_static
id|u8
id|llc_pdu_get_pf_bit
c_func
(paren
id|llc_pdu_sn_t
op_star
id|pdu
)paren
(brace
id|u8
id|pdu_type
suffix:semicolon
id|u8
id|pf_bit
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|pdu-&gt;ctrl_1
op_amp
l_int|1
)paren
(brace
r_if
c_cond
(paren
(paren
id|pdu-&gt;ctrl_1
op_amp
id|LLC_PDU_TYPE_U
)paren
op_eq
id|LLC_PDU_TYPE_U
)paren
id|pdu_type
op_assign
id|LLC_PDU_TYPE_U
suffix:semicolon
r_else
id|pdu_type
op_assign
id|LLC_PDU_TYPE_S
suffix:semicolon
)brace
r_else
id|pdu_type
op_assign
id|LLC_PDU_TYPE_I
suffix:semicolon
r_switch
c_cond
(paren
id|pdu_type
)paren
(brace
r_case
id|LLC_PDU_TYPE_I
suffix:colon
r_case
id|LLC_PDU_TYPE_S
suffix:colon
id|pf_bit
op_assign
id|pdu-&gt;ctrl_2
op_amp
id|LLC_S_PF_BIT_MASK
suffix:semicolon
r_break
suffix:semicolon
r_case
id|LLC_PDU_TYPE_U
suffix:colon
id|pf_bit
op_assign
(paren
id|pdu-&gt;ctrl_1
op_amp
id|LLC_U_PF_BIT_MASK
)paren
op_rshift
l_int|4
suffix:semicolon
r_break
suffix:semicolon
)brace
r_return
id|pf_bit
suffix:semicolon
)brace
eof
