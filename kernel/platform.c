multiline_comment|/*&n; * platform driver support &n; */
macro_line|#include &lt;linux/platform.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/errno.h&gt;
DECL|variable|default_platform
r_static
r_struct
id|platform_t
id|default_platform
suffix:semicolon
DECL|variable|platform
r_struct
id|platform_t
op_star
id|platform
op_assign
op_amp
id|default_platform
suffix:semicolon
DECL|variable|platform_lock
r_static
id|spinlock_t
id|platform_lock
op_assign
id|SPIN_LOCK_UNLOCKED
suffix:semicolon
DECL|function|default_reboot
r_void
id|default_reboot
c_func
(paren
r_char
op_star
id|cmd
)paren
(brace
multiline_comment|/* nothing */
)brace
DECL|function|default_halt
r_void
id|default_halt
c_func
(paren
r_void
)paren
(brace
multiline_comment|/* nothing */
)brace
DECL|function|default_suspend
r_int
id|default_suspend
c_func
(paren
r_int
id|state
comma
r_int
id|flags
)paren
(brace
r_return
op_minus
id|ENOSYS
suffix:semicolon
)brace
DECL|variable|default_platform
r_static
r_struct
id|platform_t
id|default_platform
op_assign
(brace
id|name
suffix:colon
l_string|&quot;Default Platform&quot;
comma
id|suspend_states
suffix:colon
l_int|0
comma
id|reboot
suffix:colon
id|default_reboot
comma
id|halt
suffix:colon
id|default_halt
comma
id|power_off
suffix:colon
id|default_halt
comma
id|suspend
suffix:colon
id|default_suspend
comma
id|idle
suffix:colon
id|default_idle
comma
)brace
suffix:semicolon
multiline_comment|/**&n; * set_platform_driver - set the platform driver.&n; * @pf:&t;driver to set it to&n; *&n; * Return -EEXIST if someone else already owns it.&n; */
DECL|function|set_platform_driver
r_int
id|set_platform_driver
c_func
(paren
r_struct
id|platform_t
op_star
id|pf
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|pf
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|platform_lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|platform
op_ne
op_amp
id|default_platform
)paren
(brace
id|spin_unlock
c_func
(paren
op_amp
id|platform_lock
)paren
suffix:semicolon
r_return
op_minus
id|EEXIST
suffix:semicolon
)brace
id|platform
op_assign
id|pf
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|platform_lock
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|remove_platform_driver
r_void
id|remove_platform_driver
c_func
(paren
r_struct
id|platform_t
op_star
id|pf
)paren
(brace
id|spin_lock
c_func
(paren
op_amp
id|platform_lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|platform
op_eq
id|pf
)paren
id|platform
op_assign
op_amp
id|default_platform
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|platform_lock
)paren
suffix:semicolon
)brace
DECL|variable|default_reboot
id|EXPORT_SYMBOL
c_func
(paren
id|default_reboot
)paren
suffix:semicolon
DECL|variable|default_halt
id|EXPORT_SYMBOL
c_func
(paren
id|default_halt
)paren
suffix:semicolon
DECL|variable|default_suspend
id|EXPORT_SYMBOL
c_func
(paren
id|default_suspend
)paren
suffix:semicolon
DECL|variable|platform
id|EXPORT_SYMBOL
c_func
(paren
id|platform
)paren
suffix:semicolon
DECL|variable|set_platform_driver
id|EXPORT_SYMBOL
c_func
(paren
id|set_platform_driver
)paren
suffix:semicolon
DECL|variable|remove_platform_driver
id|EXPORT_SYMBOL
c_func
(paren
id|remove_platform_driver
)paren
suffix:semicolon
eof
