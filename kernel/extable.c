multiline_comment|/* Rewritten by Rusty Russell, on the backs of many others...&n;   Copyright (C) 2001 Rusty Russell, 2002 Rusty Russell IBM.&n;&n;    This program is free software; you can redistribute it and/or modify&n;    it under the terms of the GNU General Public License as published by&n;    the Free Software Foundation; either version 2 of the License, or&n;    (at your option) any later version.&n;&n;    This program is distributed in the hope that it will be useful,&n;    but WITHOUT ANY WARRANTY; without even the implied warranty of&n;    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n;    GNU General Public License for more details.&n;&n;    You should have received a copy of the GNU General Public License&n;    along with this program; if not, write to the Free Software&n;    Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA&n;*/
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;asm/semaphore.h&gt;
r_extern
r_const
r_struct
id|exception_table_entry
id|__start___ex_table
(braket
)braket
suffix:semicolon
r_extern
r_const
r_struct
id|exception_table_entry
id|__stop___ex_table
(braket
)braket
suffix:semicolon
r_extern
r_const
r_struct
id|kernel_symbol
id|__start___ksymtab
(braket
)braket
suffix:semicolon
r_extern
r_const
r_struct
id|kernel_symbol
id|__stop___ksymtab
(braket
)braket
suffix:semicolon
r_extern
r_const
r_struct
id|kernel_symbol
id|__start___gpl_ksymtab
(braket
)braket
suffix:semicolon
r_extern
r_const
r_struct
id|kernel_symbol
id|__stop___gpl_ksymtab
(braket
)braket
suffix:semicolon
multiline_comment|/* Protects extables and symbol tables */
DECL|variable|modlist_lock
id|spinlock_t
id|modlist_lock
op_assign
id|SPIN_LOCK_UNLOCKED
suffix:semicolon
multiline_comment|/* The exception and symbol tables: start with kernel only. */
DECL|variable|extables
id|LIST_HEAD
c_func
(paren
id|extables
)paren
suffix:semicolon
DECL|variable|symbols
id|LIST_HEAD
c_func
(paren
id|symbols
)paren
suffix:semicolon
DECL|variable|kernel_extable
r_static
r_struct
id|exception_table
id|kernel_extable
suffix:semicolon
DECL|variable|kernel_symbols
r_static
r_struct
id|kernel_symbol_group
id|kernel_symbols
suffix:semicolon
DECL|variable|kernel_gpl_symbols
r_static
r_struct
id|kernel_symbol_group
id|kernel_gpl_symbols
suffix:semicolon
DECL|function|extable_init
r_void
id|__init
id|extable_init
c_func
(paren
r_void
)paren
(brace
multiline_comment|/* Add kernel symbols to symbol table */
id|kernel_symbols.num_syms
op_assign
(paren
id|__stop___ksymtab
op_minus
id|__start___ksymtab
)paren
suffix:semicolon
id|kernel_symbols.syms
op_assign
id|__start___ksymtab
suffix:semicolon
id|kernel_symbols.gplonly
op_assign
l_int|0
suffix:semicolon
id|list_add
c_func
(paren
op_amp
id|kernel_symbols.list
comma
op_amp
id|symbols
)paren
suffix:semicolon
id|kernel_gpl_symbols.num_syms
op_assign
(paren
id|__stop___gpl_ksymtab
op_minus
id|__start___gpl_ksymtab
)paren
suffix:semicolon
id|kernel_gpl_symbols.syms
op_assign
id|__start___gpl_ksymtab
suffix:semicolon
id|kernel_gpl_symbols.gplonly
op_assign
l_int|1
suffix:semicolon
id|list_add
c_func
(paren
op_amp
id|kernel_gpl_symbols.list
comma
op_amp
id|symbols
)paren
suffix:semicolon
multiline_comment|/* Add kernel exception table to exception tables */
id|kernel_extable.num_entries
op_assign
(paren
id|__stop___ex_table
op_minus
id|__start___ex_table
)paren
suffix:semicolon
id|kernel_extable.entry
op_assign
id|__start___ex_table
suffix:semicolon
id|list_add
c_func
(paren
op_amp
id|kernel_extable.list
comma
op_amp
id|extables
)paren
suffix:semicolon
)brace
eof
