multiline_comment|/*&n; * Cryptographic API.&n; *&n; * Algorithm autoloader.&n; *&n; * Copyright (c) 2002 James Morris &lt;jmorris@intercode.com.au&gt;&n; *&n; * This program is free software; you can redistribute it and/or modify it&n; * under the terms of the GNU General Public License as published by the Free&n; * Software Foundation; either version 2 of the License, or (at your option) &n; * any later version.&n; *&n; */
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/types.h&gt;
macro_line|#include &lt;linux/list.h&gt;
macro_line|#include &lt;linux/string.h&gt;
macro_line|#include &lt;linux/kmod.h&gt;
macro_line|#include &lt;linux/crypto.h&gt;
macro_line|#include &quot;internal.h&quot;
r_static
r_struct
(brace
DECL|member|algid
id|u32
id|algid
suffix:semicolon
DECL|member|name
r_char
op_star
id|name
suffix:semicolon
DECL|variable|alg_modmap
)brace
id|alg_modmap
(braket
)braket
op_assign
(brace
(brace
id|CRYPTO_ALG_DES
comma
l_string|&quot;des&quot;
)brace
comma
(brace
id|CRYPTO_ALG_DES3_EDE
comma
l_string|&quot;des&quot;
)brace
comma
(brace
id|CRYPTO_ALG_MD4
comma
l_string|&quot;md4&quot;
)brace
comma
(brace
id|CRYPTO_ALG_MD5
comma
l_string|&quot;md5&quot;
)brace
comma
(brace
id|CRYPTO_ALG_SHA1
comma
l_string|&quot;sha1&quot;
)brace
comma
)brace
suffix:semicolon
DECL|macro|ALG_MAX_MODMAP
mdefine_line|#define ALG_MAX_MODMAP 5
DECL|function|crypto_alg_autoload
r_void
id|crypto_alg_autoload
c_func
(paren
id|u32
id|algid
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|ALG_MAX_MODMAP
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
(paren
id|alg_modmap
(braket
id|i
)braket
dot
id|algid
op_amp
id|CRYPTO_ALG_MASK
)paren
op_eq
id|algid
)paren
(brace
id|request_module
c_func
(paren
id|alg_modmap
(braket
id|i
)braket
dot
id|name
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_return
suffix:semicolon
)brace
eof
