multiline_comment|/*&n; * Cryptographic API.&n; *&n; * SHA1 Secure Hash Algorithm.&n; *&n; * Derived from cryptoapi implementation, adapted for in-place&n; * scatterlist interface.  Originally based on the public domain&n; * implementation written by Steve Raid.&n; *&n; * Copyright (c) Alan Smithee.&n; * Copyright (c) McDonald &lt;andrew@mcdonald.org.uk&gt;&n; * Copyright (c) Jean-Francois Dive &lt;jef@linuxbe.org&gt;&n; *&n; * This program is free software; you can redistribute it and/or modify it&n; * under the terms of the GNU General Public License as published by the Free&n; * Software Foundation; either version 2 of the License, or (at your option) &n; * any later version.&n; *&n; */
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;linux/crypto.h&gt;
macro_line|#include &lt;asm/scatterlist.h&gt;
macro_line|#include &lt;asm/byteorder.h&gt;
DECL|macro|SHA1_DIGEST_SIZE
mdefine_line|#define SHA1_DIGEST_SIZE&t;20
DECL|macro|SHA1_HMAC_BLOCK_SIZE
mdefine_line|#define SHA1_HMAC_BLOCK_SIZE&t;64
DECL|function|rol
r_static
r_inline
id|u32
id|rol
c_func
(paren
id|u32
id|value
comma
id|u32
id|bits
)paren
(brace
r_return
(paren
(paren
(paren
id|value
)paren
op_lshift
(paren
id|bits
)paren
)paren
op_or
(paren
(paren
id|value
)paren
op_rshift
(paren
l_int|32
op_minus
(paren
id|bits
)paren
)paren
)paren
)paren
suffix:semicolon
)brace
multiline_comment|/* blk0() and blk() perform the initial expand. */
multiline_comment|/* I got the idea of expanding during the round function from SSLeay */
DECL|macro|blk0
macro_line|# define blk0(i) block32[i]
DECL|macro|blk
mdefine_line|#define blk(i) (block32[i&amp;15] = rol(block32[(i+13)&amp;15]^block32[(i+8)&amp;15] &bslash;&n;    ^block32[(i+2)&amp;15]^block32[i&amp;15],1))
multiline_comment|/* (R0+R1), R2, R3, R4 are the different operations used in SHA1 */
DECL|macro|R0
mdefine_line|#define R0(v,w,x,y,z,i) z+=((w&amp;(x^y))^y)+blk0(i)+0x5A827999+rol(v,5); &bslash;&n;                        w=rol(w,30);
DECL|macro|R1
mdefine_line|#define R1(v,w,x,y,z,i) z+=((w&amp;(x^y))^y)+blk(i)+0x5A827999+rol(v,5); &bslash;&n;                        w=rol(w,30);
DECL|macro|R2
mdefine_line|#define R2(v,w,x,y,z,i) z+=(w^x^y)+blk(i)+0x6ED9EBA1+rol(v,5);w=rol(w,30);
DECL|macro|R3
mdefine_line|#define R3(v,w,x,y,z,i) z+=(((w|x)&amp;y)|(w&amp;x))+blk(i)+0x8F1BBCDC+rol(v,5); &bslash;&n;                        w=rol(w,30);
DECL|macro|R4
mdefine_line|#define R4(v,w,x,y,z,i) z+=(w^x^y)+blk(i)+0xCA62C1D6+rol(v,5);w=rol(w,30);
DECL|struct|sha1_ctx
r_struct
id|sha1_ctx
(brace
DECL|member|count
id|u64
id|count
suffix:semicolon
DECL|member|state
id|u32
id|state
(braket
l_int|5
)braket
suffix:semicolon
DECL|member|buffer
id|u8
id|buffer
(braket
l_int|64
)braket
suffix:semicolon
)brace
suffix:semicolon
multiline_comment|/* Hash a single 512-bit block. This is the core of the algorithm. */
DECL|function|sha1_transform
r_static
r_void
id|sha1_transform
c_func
(paren
id|u32
op_star
id|state
comma
r_const
id|u8
op_star
id|in
)paren
(brace
id|u32
id|a
comma
id|b
comma
id|c
comma
id|d
comma
id|e
suffix:semicolon
id|u32
id|block32
(braket
l_int|16
)braket
suffix:semicolon
multiline_comment|/* convert/copy data to workspace */
r_for
c_loop
(paren
id|a
op_assign
l_int|0
suffix:semicolon
id|a
OL
r_sizeof
(paren
id|block32
)paren
op_div
r_sizeof
(paren
id|u32
)paren
suffix:semicolon
id|a
op_increment
)paren
id|block32
(braket
id|a
)braket
op_assign
id|be32_to_cpu
(paren
(paren
(paren
r_const
id|u32
op_star
)paren
id|in
)paren
(braket
id|a
)braket
)paren
suffix:semicolon
multiline_comment|/* Copy context-&gt;state[] to working vars */
id|a
op_assign
id|state
(braket
l_int|0
)braket
suffix:semicolon
id|b
op_assign
id|state
(braket
l_int|1
)braket
suffix:semicolon
id|c
op_assign
id|state
(braket
l_int|2
)braket
suffix:semicolon
id|d
op_assign
id|state
(braket
l_int|3
)braket
suffix:semicolon
id|e
op_assign
id|state
(braket
l_int|4
)braket
suffix:semicolon
multiline_comment|/* 4 rounds of 20 operations each. Loop unrolled. */
id|R0
c_func
(paren
id|a
comma
id|b
comma
id|c
comma
id|d
comma
id|e
comma
l_int|0
)paren
suffix:semicolon
id|R0
c_func
(paren
id|e
comma
id|a
comma
id|b
comma
id|c
comma
id|d
comma
l_int|1
)paren
suffix:semicolon
id|R0
c_func
(paren
id|d
comma
id|e
comma
id|a
comma
id|b
comma
id|c
comma
l_int|2
)paren
suffix:semicolon
id|R0
c_func
(paren
id|c
comma
id|d
comma
id|e
comma
id|a
comma
id|b
comma
l_int|3
)paren
suffix:semicolon
id|R0
c_func
(paren
id|b
comma
id|c
comma
id|d
comma
id|e
comma
id|a
comma
l_int|4
)paren
suffix:semicolon
id|R0
c_func
(paren
id|a
comma
id|b
comma
id|c
comma
id|d
comma
id|e
comma
l_int|5
)paren
suffix:semicolon
id|R0
c_func
(paren
id|e
comma
id|a
comma
id|b
comma
id|c
comma
id|d
comma
l_int|6
)paren
suffix:semicolon
id|R0
c_func
(paren
id|d
comma
id|e
comma
id|a
comma
id|b
comma
id|c
comma
l_int|7
)paren
suffix:semicolon
id|R0
c_func
(paren
id|c
comma
id|d
comma
id|e
comma
id|a
comma
id|b
comma
l_int|8
)paren
suffix:semicolon
id|R0
c_func
(paren
id|b
comma
id|c
comma
id|d
comma
id|e
comma
id|a
comma
l_int|9
)paren
suffix:semicolon
id|R0
c_func
(paren
id|a
comma
id|b
comma
id|c
comma
id|d
comma
id|e
comma
l_int|10
)paren
suffix:semicolon
id|R0
c_func
(paren
id|e
comma
id|a
comma
id|b
comma
id|c
comma
id|d
comma
l_int|11
)paren
suffix:semicolon
id|R0
c_func
(paren
id|d
comma
id|e
comma
id|a
comma
id|b
comma
id|c
comma
l_int|12
)paren
suffix:semicolon
id|R0
c_func
(paren
id|c
comma
id|d
comma
id|e
comma
id|a
comma
id|b
comma
l_int|13
)paren
suffix:semicolon
id|R0
c_func
(paren
id|b
comma
id|c
comma
id|d
comma
id|e
comma
id|a
comma
l_int|14
)paren
suffix:semicolon
id|R0
c_func
(paren
id|a
comma
id|b
comma
id|c
comma
id|d
comma
id|e
comma
l_int|15
)paren
suffix:semicolon
id|R1
c_func
(paren
id|e
comma
id|a
comma
id|b
comma
id|c
comma
id|d
comma
l_int|16
)paren
suffix:semicolon
id|R1
c_func
(paren
id|d
comma
id|e
comma
id|a
comma
id|b
comma
id|c
comma
l_int|17
)paren
suffix:semicolon
id|R1
c_func
(paren
id|c
comma
id|d
comma
id|e
comma
id|a
comma
id|b
comma
l_int|18
)paren
suffix:semicolon
id|R1
c_func
(paren
id|b
comma
id|c
comma
id|d
comma
id|e
comma
id|a
comma
l_int|19
)paren
suffix:semicolon
id|R2
c_func
(paren
id|a
comma
id|b
comma
id|c
comma
id|d
comma
id|e
comma
l_int|20
)paren
suffix:semicolon
id|R2
c_func
(paren
id|e
comma
id|a
comma
id|b
comma
id|c
comma
id|d
comma
l_int|21
)paren
suffix:semicolon
id|R2
c_func
(paren
id|d
comma
id|e
comma
id|a
comma
id|b
comma
id|c
comma
l_int|22
)paren
suffix:semicolon
id|R2
c_func
(paren
id|c
comma
id|d
comma
id|e
comma
id|a
comma
id|b
comma
l_int|23
)paren
suffix:semicolon
id|R2
c_func
(paren
id|b
comma
id|c
comma
id|d
comma
id|e
comma
id|a
comma
l_int|24
)paren
suffix:semicolon
id|R2
c_func
(paren
id|a
comma
id|b
comma
id|c
comma
id|d
comma
id|e
comma
l_int|25
)paren
suffix:semicolon
id|R2
c_func
(paren
id|e
comma
id|a
comma
id|b
comma
id|c
comma
id|d
comma
l_int|26
)paren
suffix:semicolon
id|R2
c_func
(paren
id|d
comma
id|e
comma
id|a
comma
id|b
comma
id|c
comma
l_int|27
)paren
suffix:semicolon
id|R2
c_func
(paren
id|c
comma
id|d
comma
id|e
comma
id|a
comma
id|b
comma
l_int|28
)paren
suffix:semicolon
id|R2
c_func
(paren
id|b
comma
id|c
comma
id|d
comma
id|e
comma
id|a
comma
l_int|29
)paren
suffix:semicolon
id|R2
c_func
(paren
id|a
comma
id|b
comma
id|c
comma
id|d
comma
id|e
comma
l_int|30
)paren
suffix:semicolon
id|R2
c_func
(paren
id|e
comma
id|a
comma
id|b
comma
id|c
comma
id|d
comma
l_int|31
)paren
suffix:semicolon
id|R2
c_func
(paren
id|d
comma
id|e
comma
id|a
comma
id|b
comma
id|c
comma
l_int|32
)paren
suffix:semicolon
id|R2
c_func
(paren
id|c
comma
id|d
comma
id|e
comma
id|a
comma
id|b
comma
l_int|33
)paren
suffix:semicolon
id|R2
c_func
(paren
id|b
comma
id|c
comma
id|d
comma
id|e
comma
id|a
comma
l_int|34
)paren
suffix:semicolon
id|R2
c_func
(paren
id|a
comma
id|b
comma
id|c
comma
id|d
comma
id|e
comma
l_int|35
)paren
suffix:semicolon
id|R2
c_func
(paren
id|e
comma
id|a
comma
id|b
comma
id|c
comma
id|d
comma
l_int|36
)paren
suffix:semicolon
id|R2
c_func
(paren
id|d
comma
id|e
comma
id|a
comma
id|b
comma
id|c
comma
l_int|37
)paren
suffix:semicolon
id|R2
c_func
(paren
id|c
comma
id|d
comma
id|e
comma
id|a
comma
id|b
comma
l_int|38
)paren
suffix:semicolon
id|R2
c_func
(paren
id|b
comma
id|c
comma
id|d
comma
id|e
comma
id|a
comma
l_int|39
)paren
suffix:semicolon
id|R3
c_func
(paren
id|a
comma
id|b
comma
id|c
comma
id|d
comma
id|e
comma
l_int|40
)paren
suffix:semicolon
id|R3
c_func
(paren
id|e
comma
id|a
comma
id|b
comma
id|c
comma
id|d
comma
l_int|41
)paren
suffix:semicolon
id|R3
c_func
(paren
id|d
comma
id|e
comma
id|a
comma
id|b
comma
id|c
comma
l_int|42
)paren
suffix:semicolon
id|R3
c_func
(paren
id|c
comma
id|d
comma
id|e
comma
id|a
comma
id|b
comma
l_int|43
)paren
suffix:semicolon
id|R3
c_func
(paren
id|b
comma
id|c
comma
id|d
comma
id|e
comma
id|a
comma
l_int|44
)paren
suffix:semicolon
id|R3
c_func
(paren
id|a
comma
id|b
comma
id|c
comma
id|d
comma
id|e
comma
l_int|45
)paren
suffix:semicolon
id|R3
c_func
(paren
id|e
comma
id|a
comma
id|b
comma
id|c
comma
id|d
comma
l_int|46
)paren
suffix:semicolon
id|R3
c_func
(paren
id|d
comma
id|e
comma
id|a
comma
id|b
comma
id|c
comma
l_int|47
)paren
suffix:semicolon
id|R3
c_func
(paren
id|c
comma
id|d
comma
id|e
comma
id|a
comma
id|b
comma
l_int|48
)paren
suffix:semicolon
id|R3
c_func
(paren
id|b
comma
id|c
comma
id|d
comma
id|e
comma
id|a
comma
l_int|49
)paren
suffix:semicolon
id|R3
c_func
(paren
id|a
comma
id|b
comma
id|c
comma
id|d
comma
id|e
comma
l_int|50
)paren
suffix:semicolon
id|R3
c_func
(paren
id|e
comma
id|a
comma
id|b
comma
id|c
comma
id|d
comma
l_int|51
)paren
suffix:semicolon
id|R3
c_func
(paren
id|d
comma
id|e
comma
id|a
comma
id|b
comma
id|c
comma
l_int|52
)paren
suffix:semicolon
id|R3
c_func
(paren
id|c
comma
id|d
comma
id|e
comma
id|a
comma
id|b
comma
l_int|53
)paren
suffix:semicolon
id|R3
c_func
(paren
id|b
comma
id|c
comma
id|d
comma
id|e
comma
id|a
comma
l_int|54
)paren
suffix:semicolon
id|R3
c_func
(paren
id|a
comma
id|b
comma
id|c
comma
id|d
comma
id|e
comma
l_int|55
)paren
suffix:semicolon
id|R3
c_func
(paren
id|e
comma
id|a
comma
id|b
comma
id|c
comma
id|d
comma
l_int|56
)paren
suffix:semicolon
id|R3
c_func
(paren
id|d
comma
id|e
comma
id|a
comma
id|b
comma
id|c
comma
l_int|57
)paren
suffix:semicolon
id|R3
c_func
(paren
id|c
comma
id|d
comma
id|e
comma
id|a
comma
id|b
comma
l_int|58
)paren
suffix:semicolon
id|R3
c_func
(paren
id|b
comma
id|c
comma
id|d
comma
id|e
comma
id|a
comma
l_int|59
)paren
suffix:semicolon
id|R4
c_func
(paren
id|a
comma
id|b
comma
id|c
comma
id|d
comma
id|e
comma
l_int|60
)paren
suffix:semicolon
id|R4
c_func
(paren
id|e
comma
id|a
comma
id|b
comma
id|c
comma
id|d
comma
l_int|61
)paren
suffix:semicolon
id|R4
c_func
(paren
id|d
comma
id|e
comma
id|a
comma
id|b
comma
id|c
comma
l_int|62
)paren
suffix:semicolon
id|R4
c_func
(paren
id|c
comma
id|d
comma
id|e
comma
id|a
comma
id|b
comma
l_int|63
)paren
suffix:semicolon
id|R4
c_func
(paren
id|b
comma
id|c
comma
id|d
comma
id|e
comma
id|a
comma
l_int|64
)paren
suffix:semicolon
id|R4
c_func
(paren
id|a
comma
id|b
comma
id|c
comma
id|d
comma
id|e
comma
l_int|65
)paren
suffix:semicolon
id|R4
c_func
(paren
id|e
comma
id|a
comma
id|b
comma
id|c
comma
id|d
comma
l_int|66
)paren
suffix:semicolon
id|R4
c_func
(paren
id|d
comma
id|e
comma
id|a
comma
id|b
comma
id|c
comma
l_int|67
)paren
suffix:semicolon
id|R4
c_func
(paren
id|c
comma
id|d
comma
id|e
comma
id|a
comma
id|b
comma
l_int|68
)paren
suffix:semicolon
id|R4
c_func
(paren
id|b
comma
id|c
comma
id|d
comma
id|e
comma
id|a
comma
l_int|69
)paren
suffix:semicolon
id|R4
c_func
(paren
id|a
comma
id|b
comma
id|c
comma
id|d
comma
id|e
comma
l_int|70
)paren
suffix:semicolon
id|R4
c_func
(paren
id|e
comma
id|a
comma
id|b
comma
id|c
comma
id|d
comma
l_int|71
)paren
suffix:semicolon
id|R4
c_func
(paren
id|d
comma
id|e
comma
id|a
comma
id|b
comma
id|c
comma
l_int|72
)paren
suffix:semicolon
id|R4
c_func
(paren
id|c
comma
id|d
comma
id|e
comma
id|a
comma
id|b
comma
l_int|73
)paren
suffix:semicolon
id|R4
c_func
(paren
id|b
comma
id|c
comma
id|d
comma
id|e
comma
id|a
comma
l_int|74
)paren
suffix:semicolon
id|R4
c_func
(paren
id|a
comma
id|b
comma
id|c
comma
id|d
comma
id|e
comma
l_int|75
)paren
suffix:semicolon
id|R4
c_func
(paren
id|e
comma
id|a
comma
id|b
comma
id|c
comma
id|d
comma
l_int|76
)paren
suffix:semicolon
id|R4
c_func
(paren
id|d
comma
id|e
comma
id|a
comma
id|b
comma
id|c
comma
l_int|77
)paren
suffix:semicolon
id|R4
c_func
(paren
id|c
comma
id|d
comma
id|e
comma
id|a
comma
id|b
comma
l_int|78
)paren
suffix:semicolon
id|R4
c_func
(paren
id|b
comma
id|c
comma
id|d
comma
id|e
comma
id|a
comma
l_int|79
)paren
suffix:semicolon
multiline_comment|/* Add the working vars back into context.state[] */
id|state
(braket
l_int|0
)braket
op_add_assign
id|a
suffix:semicolon
id|state
(braket
l_int|1
)braket
op_add_assign
id|b
suffix:semicolon
id|state
(braket
l_int|2
)braket
op_add_assign
id|c
suffix:semicolon
id|state
(braket
l_int|3
)braket
op_add_assign
id|d
suffix:semicolon
id|state
(braket
l_int|4
)braket
op_add_assign
id|e
suffix:semicolon
multiline_comment|/* Wipe variables */
id|a
op_assign
id|b
op_assign
id|c
op_assign
id|d
op_assign
id|e
op_assign
l_int|0
suffix:semicolon
id|memset
(paren
id|block32
comma
l_int|0x00
comma
r_sizeof
id|block32
)paren
suffix:semicolon
)brace
DECL|function|sha1_init
r_static
r_void
id|sha1_init
c_func
(paren
r_void
op_star
id|ctx
)paren
(brace
r_struct
id|sha1_ctx
op_star
id|sctx
op_assign
id|ctx
suffix:semicolon
r_const
r_static
r_struct
id|sha1_ctx
id|initstate
op_assign
(brace
l_int|0
comma
(brace
l_int|0x67452301
comma
l_int|0xEFCDAB89
comma
l_int|0x98BADCFE
comma
l_int|0x10325476
comma
l_int|0xC3D2E1F0
)brace
comma
(brace
l_int|0
comma
)brace
)brace
suffix:semicolon
op_star
id|sctx
op_assign
id|initstate
suffix:semicolon
)brace
DECL|function|sha1_update
r_static
r_void
id|sha1_update
c_func
(paren
r_void
op_star
id|ctx
comma
r_const
id|u8
op_star
id|data
comma
r_int
id|len
)paren
(brace
r_struct
id|sha1_ctx
op_star
id|sctx
op_assign
id|ctx
suffix:semicolon
r_int
id|i
comma
id|j
suffix:semicolon
id|j
op_assign
(paren
id|sctx-&gt;count
op_rshift
l_int|3
)paren
op_amp
l_int|0x3f
suffix:semicolon
id|sctx-&gt;count
op_add_assign
id|len
op_lshift
l_int|3
suffix:semicolon
r_if
c_cond
(paren
(paren
id|j
op_plus
id|len
)paren
OG
l_int|63
)paren
(brace
id|memcpy
c_func
(paren
op_amp
id|sctx-&gt;buffer
(braket
id|j
)braket
comma
id|data
comma
(paren
id|i
op_assign
l_int|64
op_minus
id|j
)paren
)paren
suffix:semicolon
id|sha1_transform
c_func
(paren
id|sctx-&gt;state
comma
id|sctx-&gt;buffer
)paren
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
id|i
op_plus
l_int|63
OL
id|len
suffix:semicolon
id|i
op_add_assign
l_int|64
)paren
(brace
id|sha1_transform
c_func
(paren
id|sctx-&gt;state
comma
op_amp
id|data
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
id|j
op_assign
l_int|0
suffix:semicolon
)brace
r_else
id|i
op_assign
l_int|0
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|sctx-&gt;buffer
(braket
id|j
)braket
comma
op_amp
id|data
(braket
id|i
)braket
comma
id|len
op_minus
id|i
)paren
suffix:semicolon
)brace
multiline_comment|/* Add padding and return the message digest. */
DECL|function|sha1_final
r_static
r_void
id|sha1_final
c_func
(paren
r_void
op_star
id|ctx
comma
id|u8
op_star
id|out
)paren
(brace
r_struct
id|sha1_ctx
op_star
id|sctx
op_assign
id|ctx
suffix:semicolon
id|u32
id|i
comma
id|j
comma
id|index
comma
id|padlen
suffix:semicolon
id|u64
id|t
suffix:semicolon
id|u8
id|bits
(braket
l_int|8
)braket
op_assign
(brace
l_int|0
comma
)brace
suffix:semicolon
r_const
r_static
id|u8
id|padding
(braket
l_int|64
)braket
op_assign
(brace
l_int|0x80
comma
)brace
suffix:semicolon
id|t
op_assign
id|sctx-&gt;count
suffix:semicolon
id|bits
(braket
l_int|7
)braket
op_assign
l_int|0xff
op_amp
id|t
suffix:semicolon
id|t
op_rshift_assign
l_int|8
suffix:semicolon
id|bits
(braket
l_int|6
)braket
op_assign
l_int|0xff
op_amp
id|t
suffix:semicolon
id|t
op_rshift_assign
l_int|8
suffix:semicolon
id|bits
(braket
l_int|5
)braket
op_assign
l_int|0xff
op_amp
id|t
suffix:semicolon
id|t
op_rshift_assign
l_int|8
suffix:semicolon
id|bits
(braket
l_int|4
)braket
op_assign
l_int|0xff
op_amp
id|t
suffix:semicolon
id|t
op_rshift_assign
l_int|8
suffix:semicolon
id|bits
(braket
l_int|3
)braket
op_assign
l_int|0xff
op_amp
id|t
suffix:semicolon
id|t
op_rshift_assign
l_int|8
suffix:semicolon
id|bits
(braket
l_int|2
)braket
op_assign
l_int|0xff
op_amp
id|t
suffix:semicolon
id|t
op_rshift_assign
l_int|8
suffix:semicolon
id|bits
(braket
l_int|1
)braket
op_assign
l_int|0xff
op_amp
id|t
suffix:semicolon
id|t
op_rshift_assign
l_int|8
suffix:semicolon
id|bits
(braket
l_int|0
)braket
op_assign
l_int|0xff
op_amp
id|t
suffix:semicolon
multiline_comment|/* Pad out to 56 mod 64 */
id|index
op_assign
(paren
id|sctx-&gt;count
op_rshift
l_int|3
)paren
op_amp
l_int|0x3f
suffix:semicolon
id|padlen
op_assign
(paren
id|index
OL
l_int|56
)paren
ques
c_cond
(paren
l_int|56
op_minus
id|index
)paren
suffix:colon
(paren
(paren
l_int|64
op_plus
l_int|56
)paren
op_minus
id|index
)paren
suffix:semicolon
id|sha1_update
c_func
(paren
id|sctx
comma
id|padding
comma
id|padlen
)paren
suffix:semicolon
multiline_comment|/* Append length */
id|sha1_update
c_func
(paren
id|sctx
comma
id|bits
comma
r_sizeof
id|bits
)paren
suffix:semicolon
multiline_comment|/* Store state in digest */
r_for
c_loop
(paren
id|i
op_assign
id|j
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|5
suffix:semicolon
id|i
op_increment
comma
id|j
op_add_assign
l_int|4
)paren
(brace
id|u32
id|t2
op_assign
id|sctx-&gt;state
(braket
id|i
)braket
suffix:semicolon
id|out
(braket
id|j
op_plus
l_int|3
)braket
op_assign
id|t2
op_amp
l_int|0xff
suffix:semicolon
id|t2
op_rshift_assign
l_int|8
suffix:semicolon
id|out
(braket
id|j
op_plus
l_int|2
)braket
op_assign
id|t2
op_amp
l_int|0xff
suffix:semicolon
id|t2
op_rshift_assign
l_int|8
suffix:semicolon
id|out
(braket
id|j
op_plus
l_int|1
)braket
op_assign
id|t2
op_amp
l_int|0xff
suffix:semicolon
id|t2
op_rshift_assign
l_int|8
suffix:semicolon
id|out
(braket
id|j
)braket
op_assign
id|t2
op_amp
l_int|0xff
suffix:semicolon
)brace
multiline_comment|/* Wipe context */
id|memset
c_func
(paren
id|sctx
comma
l_int|0
comma
r_sizeof
op_star
id|sctx
)paren
suffix:semicolon
)brace
DECL|variable|alg
r_static
r_struct
id|crypto_alg
id|alg
op_assign
(brace
dot
id|cra_id
op_assign
id|CRYPTO_ALG_SHA1
comma
dot
id|cra_name
op_assign
l_string|&quot;sha1&quot;
comma
dot
id|cra_blocksize
op_assign
id|SHA1_HMAC_BLOCK_SIZE
comma
dot
id|cra_ctxsize
op_assign
r_sizeof
(paren
r_struct
id|sha1_ctx
)paren
comma
dot
id|cra_u
op_assign
(brace
dot
id|digest
op_assign
(brace
dot
id|dia_digestsize
op_assign
id|SHA1_DIGEST_SIZE
comma
dot
id|dia_init
op_assign
id|sha1_init
comma
dot
id|dia_update
op_assign
id|sha1_update
comma
dot
id|dia_final
op_assign
id|sha1_final
)brace
)brace
)brace
suffix:semicolon
DECL|function|init
r_static
r_int
id|__init
id|init
c_func
(paren
r_void
)paren
(brace
id|INIT_LIST_HEAD
c_func
(paren
op_amp
id|alg.cra_list
)paren
suffix:semicolon
r_return
id|crypto_register_alg
c_func
(paren
op_amp
id|alg
)paren
suffix:semicolon
)brace
DECL|function|fini
r_static
r_void
id|__exit
id|fini
c_func
(paren
r_void
)paren
(brace
id|crypto_unregister_alg
c_func
(paren
op_amp
id|alg
)paren
suffix:semicolon
)brace
DECL|variable|init
id|module_init
c_func
(paren
id|init
)paren
suffix:semicolon
DECL|variable|fini
id|module_exit
c_func
(paren
id|fini
)paren
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
id|MODULE_DESCRIPTION
c_func
(paren
l_string|&quot;SHA1 Secure Hash Algorithm&quot;
)paren
suffix:semicolon
eof
