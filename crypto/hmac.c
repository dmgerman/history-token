multiline_comment|/*&n; * Cryptographic API.&n; *&n; * HMAC: Keyed-Hashing for Message Authentication (RFC2104).&n; *&n; * Copyright (c) 2002 James Morris &lt;jmorris@intercode.com.au&gt;&n; *&n; * The HMAC implementation is derived from USAGI.&n; * Copyright (c) 2002 Kazunori Miyazawa &lt;miyazawa@linux-ipv6.org&gt; / USAGI&n; *&n; * This program is free software; you can redistribute it and/or modify it&n; * under the terms of the GNU General Public License as published by the Free&n; * Software Foundation; either version 2 of the License, or (at your option) &n; * any later version.&n; *&n; */
macro_line|#include &lt;linux/crypto.h&gt;
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;linux/highmem.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;asm/scatterlist.h&gt;
macro_line|#include &quot;internal.h&quot;
DECL|function|hash_key
r_static
r_void
id|hash_key
c_func
(paren
r_struct
id|crypto_tfm
op_star
id|tfm
comma
id|u8
op_star
id|key
comma
r_int
r_int
id|keylen
)paren
(brace
r_struct
id|scatterlist
id|tmp
suffix:semicolon
id|tmp.page
op_assign
id|virt_to_page
c_func
(paren
id|key
)paren
suffix:semicolon
id|tmp.offset
op_assign
id|offset_in_page
c_func
(paren
id|key
)paren
suffix:semicolon
id|tmp.length
op_assign
id|keylen
suffix:semicolon
id|crypto_digest_digest
c_func
(paren
id|tfm
comma
op_amp
id|tmp
comma
l_int|1
comma
id|key
)paren
suffix:semicolon
)brace
DECL|function|crypto_alloc_hmac_block
r_int
id|crypto_alloc_hmac_block
c_func
(paren
r_struct
id|crypto_tfm
op_star
id|tfm
)paren
(brace
r_int
id|ret
op_assign
l_int|0
suffix:semicolon
id|BUG_ON
c_func
(paren
op_logical_neg
id|crypto_tfm_alg_blocksize
c_func
(paren
id|tfm
)paren
)paren
suffix:semicolon
id|tfm-&gt;crt_digest.dit_hmac_block
op_assign
id|kmalloc
c_func
(paren
id|crypto_tfm_alg_blocksize
c_func
(paren
id|tfm
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tfm-&gt;crt_digest.dit_hmac_block
op_eq
l_int|NULL
)paren
id|ret
op_assign
op_minus
id|ENOMEM
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
DECL|function|crypto_free_hmac_block
r_void
id|crypto_free_hmac_block
c_func
(paren
r_struct
id|crypto_tfm
op_star
id|tfm
)paren
(brace
r_if
c_cond
(paren
id|tfm-&gt;crt_digest.dit_hmac_block
)paren
id|kfree
c_func
(paren
id|tfm-&gt;crt_digest.dit_hmac_block
)paren
suffix:semicolon
)brace
DECL|function|crypto_hmac_init
r_void
id|crypto_hmac_init
c_func
(paren
r_struct
id|crypto_tfm
op_star
id|tfm
comma
id|u8
op_star
id|key
comma
r_int
r_int
op_star
id|keylen
)paren
(brace
r_int
r_int
id|i
suffix:semicolon
r_struct
id|scatterlist
id|tmp
suffix:semicolon
r_char
op_star
id|ipad
op_assign
id|tfm-&gt;crt_digest.dit_hmac_block
suffix:semicolon
r_if
c_cond
(paren
op_star
id|keylen
OG
id|crypto_tfm_alg_blocksize
c_func
(paren
id|tfm
)paren
)paren
(brace
id|hash_key
c_func
(paren
id|tfm
comma
id|key
comma
op_star
id|keylen
)paren
suffix:semicolon
op_star
id|keylen
op_assign
id|crypto_tfm_alg_digestsize
c_func
(paren
id|tfm
)paren
suffix:semicolon
)brace
id|memset
c_func
(paren
id|ipad
comma
l_int|0
comma
id|crypto_tfm_alg_blocksize
c_func
(paren
id|tfm
)paren
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|ipad
comma
id|key
comma
op_star
id|keylen
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|crypto_tfm_alg_blocksize
c_func
(paren
id|tfm
)paren
suffix:semicolon
id|i
op_increment
)paren
id|ipad
(braket
id|i
)braket
op_xor_assign
l_int|0x36
suffix:semicolon
id|tmp.page
op_assign
id|virt_to_page
c_func
(paren
id|ipad
)paren
suffix:semicolon
id|tmp.offset
op_assign
id|offset_in_page
c_func
(paren
id|ipad
)paren
suffix:semicolon
id|tmp.length
op_assign
id|crypto_tfm_alg_blocksize
c_func
(paren
id|tfm
)paren
suffix:semicolon
id|crypto_digest_init
c_func
(paren
id|tfm
)paren
suffix:semicolon
id|crypto_digest_update
c_func
(paren
id|tfm
comma
op_amp
id|tmp
comma
l_int|1
)paren
suffix:semicolon
)brace
DECL|function|crypto_hmac_update
r_void
id|crypto_hmac_update
c_func
(paren
r_struct
id|crypto_tfm
op_star
id|tfm
comma
r_struct
id|scatterlist
op_star
id|sg
comma
r_int
r_int
id|nsg
)paren
(brace
id|crypto_digest_update
c_func
(paren
id|tfm
comma
id|sg
comma
id|nsg
)paren
suffix:semicolon
)brace
DECL|function|crypto_hmac_final
r_void
id|crypto_hmac_final
c_func
(paren
r_struct
id|crypto_tfm
op_star
id|tfm
comma
id|u8
op_star
id|key
comma
r_int
r_int
op_star
id|keylen
comma
id|u8
op_star
id|out
)paren
(brace
r_int
r_int
id|i
suffix:semicolon
r_struct
id|scatterlist
id|tmp
suffix:semicolon
r_char
op_star
id|opad
op_assign
id|tfm-&gt;crt_digest.dit_hmac_block
suffix:semicolon
r_if
c_cond
(paren
op_star
id|keylen
OG
id|crypto_tfm_alg_blocksize
c_func
(paren
id|tfm
)paren
)paren
(brace
id|hash_key
c_func
(paren
id|tfm
comma
id|key
comma
op_star
id|keylen
)paren
suffix:semicolon
op_star
id|keylen
op_assign
id|crypto_tfm_alg_digestsize
c_func
(paren
id|tfm
)paren
suffix:semicolon
)brace
id|crypto_digest_final
c_func
(paren
id|tfm
comma
id|out
)paren
suffix:semicolon
id|memset
c_func
(paren
id|opad
comma
l_int|0
comma
id|crypto_tfm_alg_blocksize
c_func
(paren
id|tfm
)paren
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|opad
comma
id|key
comma
op_star
id|keylen
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|crypto_tfm_alg_blocksize
c_func
(paren
id|tfm
)paren
suffix:semicolon
id|i
op_increment
)paren
id|opad
(braket
id|i
)braket
op_xor_assign
l_int|0x5c
suffix:semicolon
id|tmp.page
op_assign
id|virt_to_page
c_func
(paren
id|opad
)paren
suffix:semicolon
id|tmp.offset
op_assign
id|offset_in_page
c_func
(paren
id|opad
)paren
suffix:semicolon
id|tmp.length
op_assign
id|crypto_tfm_alg_blocksize
c_func
(paren
id|tfm
)paren
suffix:semicolon
id|crypto_digest_init
c_func
(paren
id|tfm
)paren
suffix:semicolon
id|crypto_digest_update
c_func
(paren
id|tfm
comma
op_amp
id|tmp
comma
l_int|1
)paren
suffix:semicolon
id|tmp.page
op_assign
id|virt_to_page
c_func
(paren
id|out
)paren
suffix:semicolon
id|tmp.offset
op_assign
id|offset_in_page
c_func
(paren
id|out
)paren
suffix:semicolon
id|tmp.length
op_assign
id|crypto_tfm_alg_digestsize
c_func
(paren
id|tfm
)paren
suffix:semicolon
id|crypto_digest_update
c_func
(paren
id|tfm
comma
op_amp
id|tmp
comma
l_int|1
)paren
suffix:semicolon
id|crypto_digest_final
c_func
(paren
id|tfm
comma
id|out
)paren
suffix:semicolon
)brace
DECL|function|crypto_hmac
r_void
id|crypto_hmac
c_func
(paren
r_struct
id|crypto_tfm
op_star
id|tfm
comma
id|u8
op_star
id|key
comma
r_int
r_int
op_star
id|keylen
comma
r_struct
id|scatterlist
op_star
id|sg
comma
r_int
r_int
id|nsg
comma
id|u8
op_star
id|out
)paren
(brace
id|crypto_hmac_init
c_func
(paren
id|tfm
comma
id|key
comma
id|keylen
)paren
suffix:semicolon
id|crypto_hmac_update
c_func
(paren
id|tfm
comma
id|sg
comma
id|nsg
)paren
suffix:semicolon
id|crypto_hmac_final
c_func
(paren
id|tfm
comma
id|key
comma
id|keylen
comma
id|out
)paren
suffix:semicolon
)brace
DECL|variable|crypto_hmac_init
id|EXPORT_SYMBOL_GPL
c_func
(paren
id|crypto_hmac_init
)paren
suffix:semicolon
DECL|variable|crypto_hmac_update
id|EXPORT_SYMBOL_GPL
c_func
(paren
id|crypto_hmac_update
)paren
suffix:semicolon
DECL|variable|crypto_hmac_final
id|EXPORT_SYMBOL_GPL
c_func
(paren
id|crypto_hmac_final
)paren
suffix:semicolon
DECL|variable|crypto_hmac
id|EXPORT_SYMBOL_GPL
c_func
(paren
id|crypto_hmac
)paren
suffix:semicolon
eof
