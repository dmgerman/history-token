multiline_comment|/*&n; * Cryptographic API.&n; *&n; * Digest operations.&n; *&n; * Copyright (c) 2002 James Morris &lt;jmorris@intercode.com.au&gt;&n; *&n; * This program is free software; you can redistribute it and/or modify it&n; * under the terms of the GNU General Public License as published by the Free&n; * Software Foundation; either version 2 of the License, or (at your option) &n; * any later version.&n; *&n; */
macro_line|#include &lt;linux/crypto.h&gt;
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;linux/errno.h&gt;
macro_line|#include &lt;linux/highmem.h&gt;
macro_line|#include &lt;asm/scatterlist.h&gt;
macro_line|#include &quot;internal.h&quot;
DECL|function|init
r_static
r_void
id|init
c_func
(paren
r_struct
id|crypto_tfm
op_star
id|tfm
)paren
(brace
id|tfm-&gt;__crt_alg-&gt;cra_digest
dot
id|dia_init
c_func
(paren
id|crypto_tfm_ctx
c_func
(paren
id|tfm
)paren
)paren
suffix:semicolon
)brace
DECL|function|update
r_static
r_void
id|update
c_func
(paren
r_struct
id|crypto_tfm
op_star
id|tfm
comma
r_struct
id|scatterlist
op_star
id|sg
comma
r_int
r_int
id|nsg
)paren
(brace
r_int
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|nsg
suffix:semicolon
id|i
op_increment
)paren
(brace
r_struct
id|page
op_star
id|pg
op_assign
id|sg
(braket
id|i
)braket
dot
id|page
suffix:semicolon
r_int
r_int
id|offset
op_assign
id|sg
(braket
id|i
)braket
dot
id|offset
suffix:semicolon
r_int
r_int
id|l
op_assign
id|sg
(braket
id|i
)braket
dot
id|length
suffix:semicolon
r_do
(brace
r_int
r_int
id|bytes_from_page
op_assign
id|min
c_func
(paren
id|l
comma
(paren
(paren
r_int
r_int
)paren
(paren
id|PAGE_SIZE
)paren
)paren
op_minus
id|offset
)paren
suffix:semicolon
r_char
op_star
id|p
op_assign
id|crypto_kmap
c_func
(paren
id|pg
comma
l_int|0
)paren
op_plus
id|offset
suffix:semicolon
id|tfm-&gt;__crt_alg-&gt;cra_digest.dia_update
(paren
id|crypto_tfm_ctx
c_func
(paren
id|tfm
)paren
comma
id|p
comma
id|bytes_from_page
)paren
suffix:semicolon
id|crypto_kunmap
c_func
(paren
id|p
comma
l_int|0
)paren
suffix:semicolon
id|crypto_yield
c_func
(paren
id|tfm
)paren
suffix:semicolon
id|offset
op_assign
l_int|0
suffix:semicolon
id|pg
op_increment
suffix:semicolon
id|l
op_sub_assign
id|bytes_from_page
suffix:semicolon
)brace
r_while
c_loop
(paren
id|l
OG
l_int|0
)paren
suffix:semicolon
)brace
)brace
DECL|function|final
r_static
r_void
id|final
c_func
(paren
r_struct
id|crypto_tfm
op_star
id|tfm
comma
id|u8
op_star
id|out
)paren
(brace
id|tfm-&gt;__crt_alg-&gt;cra_digest
dot
id|dia_final
c_func
(paren
id|crypto_tfm_ctx
c_func
(paren
id|tfm
)paren
comma
id|out
)paren
suffix:semicolon
)brace
DECL|function|setkey
r_static
r_int
id|setkey
c_func
(paren
r_struct
id|crypto_tfm
op_star
id|tfm
comma
r_const
id|u8
op_star
id|key
comma
r_int
r_int
id|keylen
)paren
(brace
id|u32
id|flags
suffix:semicolon
r_if
c_cond
(paren
id|tfm-&gt;__crt_alg-&gt;cra_digest.dia_setkey
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOSYS
suffix:semicolon
r_return
id|tfm-&gt;__crt_alg-&gt;cra_digest
dot
id|dia_setkey
c_func
(paren
id|crypto_tfm_ctx
c_func
(paren
id|tfm
)paren
comma
id|key
comma
id|keylen
comma
op_amp
id|flags
)paren
suffix:semicolon
)brace
DECL|function|digest
r_static
r_void
id|digest
c_func
(paren
r_struct
id|crypto_tfm
op_star
id|tfm
comma
r_struct
id|scatterlist
op_star
id|sg
comma
r_int
r_int
id|nsg
comma
id|u8
op_star
id|out
)paren
(brace
r_int
r_int
id|i
suffix:semicolon
id|tfm-&gt;crt_digest
dot
id|dit_init
c_func
(paren
id|tfm
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|nsg
suffix:semicolon
id|i
op_increment
)paren
(brace
r_char
op_star
id|p
op_assign
id|crypto_kmap
c_func
(paren
id|sg
(braket
id|i
)braket
dot
id|page
comma
l_int|0
)paren
op_plus
id|sg
(braket
id|i
)braket
dot
id|offset
suffix:semicolon
id|tfm-&gt;__crt_alg-&gt;cra_digest
dot
id|dia_update
c_func
(paren
id|crypto_tfm_ctx
c_func
(paren
id|tfm
)paren
comma
id|p
comma
id|sg
(braket
id|i
)braket
dot
id|length
)paren
suffix:semicolon
id|crypto_kunmap
c_func
(paren
id|p
comma
l_int|0
)paren
suffix:semicolon
id|crypto_yield
c_func
(paren
id|tfm
)paren
suffix:semicolon
)brace
id|crypto_digest_final
c_func
(paren
id|tfm
comma
id|out
)paren
suffix:semicolon
)brace
DECL|function|crypto_init_digest_flags
r_int
id|crypto_init_digest_flags
c_func
(paren
r_struct
id|crypto_tfm
op_star
id|tfm
comma
id|u32
id|flags
)paren
(brace
r_return
id|flags
ques
c_cond
op_minus
id|EINVAL
suffix:colon
l_int|0
suffix:semicolon
)brace
DECL|function|crypto_init_digest_ops
r_int
id|crypto_init_digest_ops
c_func
(paren
r_struct
id|crypto_tfm
op_star
id|tfm
)paren
(brace
r_struct
id|digest_tfm
op_star
id|ops
op_assign
op_amp
id|tfm-&gt;crt_digest
suffix:semicolon
id|ops-&gt;dit_init
op_assign
id|init
suffix:semicolon
id|ops-&gt;dit_update
op_assign
id|update
suffix:semicolon
id|ops-&gt;dit_final
op_assign
id|final
suffix:semicolon
id|ops-&gt;dit_digest
op_assign
id|digest
suffix:semicolon
id|ops-&gt;dit_setkey
op_assign
id|setkey
suffix:semicolon
r_return
id|crypto_alloc_hmac_block
c_func
(paren
id|tfm
)paren
suffix:semicolon
)brace
DECL|function|crypto_exit_digest_ops
r_void
id|crypto_exit_digest_ops
c_func
(paren
r_struct
id|crypto_tfm
op_star
id|tfm
)paren
(brace
id|crypto_free_hmac_block
c_func
(paren
id|tfm
)paren
suffix:semicolon
)brace
eof
