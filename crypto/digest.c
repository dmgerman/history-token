multiline_comment|/*&n; * Cryptographic API.&n; *&n; * Digest operations.&n; *&n; * Copyright (c) 2002 James Morris &lt;jmorris@intercode.com.au&gt;&n; *&n; * The HMAC implementation is derived from USAGI.&n; * Copyright (c) 2002 USAGI/WIDE Project&n; *&n; * This program is free software; you can redistribute it and/or modify it&n; * under the terms of the GNU General Public License as published by the Free&n; * Software Foundation; either version 2 of the License, or (at your option) &n; * any later version.&n; *&n; */
macro_line|#include &lt;linux/types.h&gt;
macro_line|#include &lt;linux/list.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;linux/highmem.h&gt;
macro_line|#include &lt;asm/scatterlist.h&gt;
macro_line|#include &lt;linux/crypto.h&gt;
macro_line|#include &quot;internal.h&quot;
DECL|function|init
r_static
r_void
id|init
c_func
(paren
r_struct
id|crypto_tfm
op_star
id|tfm
)paren
(brace
id|tfm-&gt;__crt_alg-&gt;cra_digest
dot
id|dia_init
c_func
(paren
id|tfm-&gt;crt_ctx
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
DECL|function|update
r_static
r_void
id|update
c_func
(paren
r_struct
id|crypto_tfm
op_star
id|tfm
comma
r_struct
id|scatterlist
op_star
id|sg
comma
r_int
id|nsg
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|nsg
suffix:semicolon
id|i
op_increment
)paren
(brace
r_char
op_star
id|p
op_assign
id|crypto_kmap
c_func
(paren
id|tfm
comma
id|sg
(braket
id|i
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
id|i
)braket
dot
id|offset
suffix:semicolon
id|tfm-&gt;__crt_alg-&gt;cra_digest
dot
id|dia_update
c_func
(paren
id|tfm-&gt;crt_ctx
comma
id|p
comma
id|sg
(braket
id|i
)braket
dot
id|length
)paren
suffix:semicolon
id|crypto_kunmap
c_func
(paren
id|tfm
comma
id|p
)paren
suffix:semicolon
id|crypto_yield
c_func
(paren
id|tfm
)paren
suffix:semicolon
)brace
r_return
suffix:semicolon
)brace
DECL|function|final
r_static
r_void
id|final
c_func
(paren
r_struct
id|crypto_tfm
op_star
id|tfm
comma
id|u8
op_star
id|out
)paren
(brace
id|tfm-&gt;__crt_alg-&gt;cra_digest
dot
id|dia_final
c_func
(paren
id|tfm-&gt;crt_ctx
comma
id|out
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
DECL|function|digest
r_static
r_void
id|digest
c_func
(paren
r_struct
id|crypto_tfm
op_star
id|tfm
comma
r_struct
id|scatterlist
op_star
id|sg
comma
r_int
id|nsg
comma
id|u8
op_star
id|out
)paren
(brace
r_int
id|i
suffix:semicolon
id|tfm-&gt;crt_digest
dot
id|dit_init
c_func
(paren
id|tfm
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|nsg
suffix:semicolon
id|i
op_increment
)paren
(brace
r_char
op_star
id|p
op_assign
id|crypto_kmap
c_func
(paren
id|tfm
comma
id|sg
(braket
id|i
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
id|i
)braket
dot
id|offset
suffix:semicolon
id|tfm-&gt;__crt_alg-&gt;cra_digest
dot
id|dia_update
c_func
(paren
id|tfm-&gt;crt_ctx
comma
id|p
comma
id|sg
(braket
id|i
)braket
dot
id|length
)paren
suffix:semicolon
id|crypto_kunmap
c_func
(paren
id|tfm
comma
id|p
)paren
suffix:semicolon
id|crypto_yield
c_func
(paren
id|tfm
)paren
suffix:semicolon
)brace
id|crypto_digest_final
c_func
(paren
id|tfm
comma
id|out
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
DECL|function|hmac
r_static
r_void
id|hmac
c_func
(paren
r_struct
id|crypto_tfm
op_star
id|tfm
comma
id|u8
op_star
id|key
comma
r_int
id|keylen
comma
r_struct
id|scatterlist
op_star
id|sg
comma
r_int
id|nsg
comma
id|u8
op_star
id|out
)paren
(brace
r_int
id|i
suffix:semicolon
r_struct
id|scatterlist
id|tmp
suffix:semicolon
r_char
id|ipad
(braket
id|crypto_tfm_alg_blocksize
c_func
(paren
id|tfm
)paren
op_plus
l_int|1
)braket
suffix:semicolon
r_char
id|opad
(braket
id|crypto_tfm_alg_blocksize
c_func
(paren
id|tfm
)paren
op_plus
l_int|1
)braket
suffix:semicolon
r_if
c_cond
(paren
id|keylen
OG
id|crypto_tfm_alg_blocksize
c_func
(paren
id|tfm
)paren
)paren
(brace
id|tmp.page
op_assign
id|virt_to_page
c_func
(paren
id|key
)paren
suffix:semicolon
id|tmp.offset
op_assign
(paren
(paren
r_int
)paren
id|key
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|tmp.length
op_assign
id|keylen
suffix:semicolon
id|crypto_digest_digest
c_func
(paren
id|tfm
comma
op_amp
id|tmp
comma
l_int|1
comma
id|key
)paren
suffix:semicolon
id|keylen
op_assign
id|crypto_tfm_alg_digestsize
c_func
(paren
id|tfm
)paren
suffix:semicolon
)brace
id|memset
c_func
(paren
id|ipad
comma
l_int|0
comma
r_sizeof
(paren
id|ipad
)paren
)paren
suffix:semicolon
id|memset
c_func
(paren
id|opad
comma
l_int|0
comma
r_sizeof
(paren
id|opad
)paren
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|ipad
comma
id|key
comma
id|keylen
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|opad
comma
id|key
comma
id|keylen
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|crypto_tfm_alg_blocksize
c_func
(paren
id|tfm
)paren
suffix:semicolon
id|i
op_increment
)paren
(brace
id|ipad
(braket
id|i
)braket
op_xor_assign
l_int|0x36
suffix:semicolon
id|opad
(braket
id|i
)braket
op_xor_assign
l_int|0x5c
suffix:semicolon
)brace
id|tmp.page
op_assign
id|virt_to_page
c_func
(paren
id|ipad
)paren
suffix:semicolon
id|tmp.offset
op_assign
(paren
(paren
r_int
)paren
id|ipad
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|tmp.length
op_assign
id|crypto_tfm_alg_blocksize
c_func
(paren
id|tfm
)paren
suffix:semicolon
id|crypto_digest_init
c_func
(paren
id|tfm
)paren
suffix:semicolon
id|crypto_digest_update
c_func
(paren
id|tfm
comma
op_amp
id|tmp
comma
l_int|1
)paren
suffix:semicolon
id|crypto_digest_update
c_func
(paren
id|tfm
comma
id|sg
comma
id|nsg
)paren
suffix:semicolon
id|crypto_digest_final
c_func
(paren
id|tfm
comma
id|out
)paren
suffix:semicolon
id|tmp.page
op_assign
id|virt_to_page
c_func
(paren
id|opad
)paren
suffix:semicolon
id|tmp.offset
op_assign
(paren
(paren
r_int
)paren
id|opad
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|tmp.length
op_assign
id|crypto_tfm_alg_blocksize
c_func
(paren
id|tfm
)paren
suffix:semicolon
id|crypto_digest_init
c_func
(paren
id|tfm
)paren
suffix:semicolon
id|crypto_digest_update
c_func
(paren
id|tfm
comma
op_amp
id|tmp
comma
l_int|1
)paren
suffix:semicolon
id|tmp.page
op_assign
id|virt_to_page
c_func
(paren
id|out
)paren
suffix:semicolon
id|tmp.offset
op_assign
(paren
(paren
r_int
)paren
id|out
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|tmp.length
op_assign
id|crypto_tfm_alg_digestsize
c_func
(paren
id|tfm
)paren
suffix:semicolon
id|crypto_digest_update
c_func
(paren
id|tfm
comma
op_amp
id|tmp
comma
l_int|1
)paren
suffix:semicolon
id|crypto_digest_final
c_func
(paren
id|tfm
comma
id|out
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
DECL|function|crypto_init_digest_flags
r_int
id|crypto_init_digest_flags
c_func
(paren
r_struct
id|crypto_tfm
op_star
id|tfm
comma
id|u32
id|flags
)paren
(brace
r_return
id|crypto_cipher_flags
c_func
(paren
id|flags
)paren
ques
c_cond
op_minus
id|EINVAL
suffix:colon
l_int|0
suffix:semicolon
)brace
DECL|function|crypto_init_digest_ops
r_void
id|crypto_init_digest_ops
c_func
(paren
r_struct
id|crypto_tfm
op_star
id|tfm
)paren
(brace
r_struct
id|digest_tfm
op_star
id|ops
op_assign
op_amp
id|tfm-&gt;crt_digest
suffix:semicolon
id|ops-&gt;dit_init
op_assign
id|init
suffix:semicolon
id|ops-&gt;dit_update
op_assign
id|update
suffix:semicolon
id|ops-&gt;dit_final
op_assign
id|final
suffix:semicolon
id|ops-&gt;dit_digest
op_assign
id|digest
suffix:semicolon
id|ops-&gt;dit_hmac
op_assign
id|hmac
suffix:semicolon
)brace
eof
