multiline_comment|/*&n; * Cryptographic API.&n; *&n; * Digest operations.&n; *&n; * Copyright (c) 2002 James Morris &lt;jmorris@intercode.com.au&gt;&n; *&n; * This program is free software; you can redistribute it and/or modify it&n; * under the terms of the GNU General Public License as published by the Free&n; * Software Foundation; either version 2 of the License, or (at your option) &n; * any later version.&n; *&n; */
macro_line|#include &lt;linux/crypto.h&gt;
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;linux/highmem.h&gt;
macro_line|#include &lt;asm/scatterlist.h&gt;
macro_line|#include &quot;internal.h&quot;
DECL|function|init
r_static
r_void
id|init
c_func
(paren
r_struct
id|crypto_tfm
op_star
id|tfm
)paren
(brace
id|tfm-&gt;__crt_alg-&gt;cra_digest
dot
id|dia_init
c_func
(paren
id|tfm-&gt;crt_ctx
)paren
suffix:semicolon
)brace
DECL|function|update
r_static
r_void
id|update
c_func
(paren
r_struct
id|crypto_tfm
op_star
id|tfm
comma
r_struct
id|scatterlist
op_star
id|sg
comma
r_int
r_int
id|nsg
)paren
(brace
r_int
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|nsg
suffix:semicolon
id|i
op_increment
)paren
(brace
r_char
op_star
id|p
op_assign
id|crypto_kmap
c_func
(paren
id|sg
(braket
id|i
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
id|i
)braket
dot
id|offset
suffix:semicolon
id|tfm-&gt;__crt_alg-&gt;cra_digest
dot
id|dia_update
c_func
(paren
id|tfm-&gt;crt_ctx
comma
id|p
comma
id|sg
(braket
id|i
)braket
dot
id|length
)paren
suffix:semicolon
id|crypto_kunmap
c_func
(paren
id|p
)paren
suffix:semicolon
id|crypto_yield
c_func
(paren
id|tfm
)paren
suffix:semicolon
)brace
)brace
DECL|function|final
r_static
r_void
id|final
c_func
(paren
r_struct
id|crypto_tfm
op_star
id|tfm
comma
id|u8
op_star
id|out
)paren
(brace
id|tfm-&gt;__crt_alg-&gt;cra_digest
dot
id|dia_final
c_func
(paren
id|tfm-&gt;crt_ctx
comma
id|out
)paren
suffix:semicolon
)brace
DECL|function|digest
r_static
r_void
id|digest
c_func
(paren
r_struct
id|crypto_tfm
op_star
id|tfm
comma
r_struct
id|scatterlist
op_star
id|sg
comma
r_int
r_int
id|nsg
comma
id|u8
op_star
id|out
)paren
(brace
r_int
r_int
id|i
suffix:semicolon
id|tfm-&gt;crt_digest
dot
id|dit_init
c_func
(paren
id|tfm
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|nsg
suffix:semicolon
id|i
op_increment
)paren
(brace
r_char
op_star
id|p
op_assign
id|crypto_kmap
c_func
(paren
id|sg
(braket
id|i
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
id|i
)braket
dot
id|offset
suffix:semicolon
id|tfm-&gt;__crt_alg-&gt;cra_digest
dot
id|dia_update
c_func
(paren
id|tfm-&gt;crt_ctx
comma
id|p
comma
id|sg
(braket
id|i
)braket
dot
id|length
)paren
suffix:semicolon
id|crypto_kunmap
c_func
(paren
id|p
)paren
suffix:semicolon
id|crypto_yield
c_func
(paren
id|tfm
)paren
suffix:semicolon
)brace
id|crypto_digest_final
c_func
(paren
id|tfm
comma
id|out
)paren
suffix:semicolon
)brace
DECL|function|crypto_init_digest_flags
r_int
id|crypto_init_digest_flags
c_func
(paren
r_struct
id|crypto_tfm
op_star
id|tfm
comma
id|u32
id|flags
)paren
(brace
r_return
id|crypto_cipher_flags
c_func
(paren
id|flags
)paren
ques
c_cond
op_minus
id|EINVAL
suffix:colon
l_int|0
suffix:semicolon
)brace
DECL|function|crypto_init_digest_ops
r_void
id|crypto_init_digest_ops
c_func
(paren
r_struct
id|crypto_tfm
op_star
id|tfm
)paren
(brace
r_struct
id|digest_tfm
op_star
id|ops
op_assign
op_amp
id|tfm-&gt;crt_digest
suffix:semicolon
id|ops-&gt;dit_init
op_assign
id|init
suffix:semicolon
id|ops-&gt;dit_update
op_assign
id|update
suffix:semicolon
id|ops-&gt;dit_final
op_assign
id|final
suffix:semicolon
id|ops-&gt;dit_digest
op_assign
id|digest
suffix:semicolon
)brace
eof
