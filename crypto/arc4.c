multiline_comment|/* &n; * Cryptographic API&n; *&n; * ARC4 Cipher Algorithm&n; *&n; * Jon Oberheide &lt;jon@focalhost.com&gt;&n; *&n; * This program is free software; you can redistribute it and/or modify&n; * it under the terms of the GNU General Public License as published by&n; * the Free Software Foundation; either version 2 of the License, or&n; * (at your option) any later version.&n; *&n; */
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/crypto.h&gt;
DECL|macro|ARC4_MIN_KEY_SIZE
mdefine_line|#define ARC4_MIN_KEY_SIZE&t;1
DECL|macro|ARC4_MAX_KEY_SIZE
mdefine_line|#define ARC4_MAX_KEY_SIZE&t;256
DECL|macro|ARC4_BLOCK_SIZE
mdefine_line|#define ARC4_BLOCK_SIZE&t;&t;1
DECL|struct|arc4_ctx
r_struct
id|arc4_ctx
(brace
DECL|member|S
id|u8
id|S
(braket
l_int|256
)braket
suffix:semicolon
DECL|member|x
DECL|member|y
id|u8
id|x
comma
id|y
suffix:semicolon
)brace
suffix:semicolon
DECL|function|arc4_set_key
r_static
r_int
id|arc4_set_key
c_func
(paren
r_void
op_star
id|ctx_arg
comma
r_const
id|u8
op_star
id|in_key
comma
r_int
r_int
id|key_len
comma
id|u32
op_star
id|flags
)paren
(brace
r_struct
id|arc4_ctx
op_star
id|ctx
op_assign
id|ctx_arg
suffix:semicolon
r_int
id|i
comma
id|j
op_assign
l_int|0
comma
id|k
op_assign
l_int|0
suffix:semicolon
id|ctx-&gt;x
op_assign
l_int|1
suffix:semicolon
id|ctx-&gt;y
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|256
suffix:semicolon
id|i
op_increment
)paren
(brace
id|ctx-&gt;S
(braket
id|i
)braket
op_assign
id|i
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|256
suffix:semicolon
id|i
op_increment
)paren
(brace
id|u8
id|a
op_assign
id|ctx-&gt;S
(braket
id|i
)braket
suffix:semicolon
id|j
op_assign
(paren
id|j
op_plus
id|in_key
(braket
id|k
)braket
op_plus
id|a
)paren
op_amp
l_int|0xff
suffix:semicolon
id|ctx-&gt;S
(braket
id|i
)braket
op_assign
id|ctx-&gt;S
(braket
id|j
)braket
suffix:semicolon
id|ctx-&gt;S
(braket
id|j
)braket
op_assign
id|a
suffix:semicolon
r_if
c_cond
(paren
op_increment
id|k
op_ge
id|key_len
)paren
(brace
id|k
op_assign
l_int|0
suffix:semicolon
)brace
)brace
multiline_comment|/* TODO: dump the first 768 bytes generated as recommended&n;&t;   by Ilya Mironov (http://eprint.iacr.org/2002/067/) to &n;&t;   increase the statistical strength of the state table */
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|arc4_crypt
r_static
r_void
id|arc4_crypt
c_func
(paren
r_void
op_star
id|ctx_arg
comma
id|u8
op_star
id|out
comma
r_const
id|u8
op_star
id|in
)paren
(brace
r_struct
id|arc4_ctx
op_star
id|ctx
op_assign
id|ctx_arg
suffix:semicolon
id|u8
op_star
r_const
id|S
op_assign
id|ctx-&gt;S
suffix:semicolon
id|u8
id|x
op_assign
id|ctx-&gt;x
suffix:semicolon
id|u8
id|y
op_assign
id|ctx-&gt;y
suffix:semicolon
id|u8
id|a
comma
id|b
suffix:semicolon
id|a
op_assign
id|S
(braket
id|x
)braket
suffix:semicolon
id|y
op_assign
(paren
id|y
op_plus
id|a
)paren
op_amp
l_int|0xff
suffix:semicolon
id|b
op_assign
id|S
(braket
id|y
)braket
suffix:semicolon
id|S
(braket
id|x
)braket
op_assign
id|b
suffix:semicolon
id|S
(braket
id|y
)braket
op_assign
id|a
suffix:semicolon
id|x
op_assign
(paren
id|x
op_plus
l_int|1
)paren
op_amp
l_int|0xff
suffix:semicolon
op_star
id|out
op_increment
op_assign
op_star
id|in
op_xor
id|S
(braket
(paren
id|a
op_plus
id|b
)paren
op_amp
l_int|0xff
)braket
suffix:semicolon
id|ctx-&gt;x
op_assign
id|x
suffix:semicolon
id|ctx-&gt;y
op_assign
id|y
suffix:semicolon
)brace
DECL|variable|arc4_alg
r_static
r_struct
id|crypto_alg
id|arc4_alg
op_assign
(brace
dot
id|cra_name
op_assign
l_string|&quot;arc4&quot;
comma
dot
id|cra_flags
op_assign
id|CRYPTO_ALG_TYPE_CIPHER
comma
dot
id|cra_blocksize
op_assign
id|ARC4_BLOCK_SIZE
comma
dot
id|cra_ctxsize
op_assign
r_sizeof
(paren
r_struct
id|arc4_ctx
)paren
comma
dot
id|cra_module
op_assign
id|THIS_MODULE
comma
dot
id|cra_list
op_assign
id|LIST_HEAD_INIT
c_func
(paren
id|arc4_alg.cra_list
)paren
comma
dot
id|cra_u
op_assign
(brace
dot
id|cipher
op_assign
(brace
dot
id|cia_min_keysize
op_assign
id|ARC4_MIN_KEY_SIZE
comma
dot
id|cia_max_keysize
op_assign
id|ARC4_MAX_KEY_SIZE
comma
dot
id|cia_setkey
op_assign
id|arc4_set_key
comma
dot
id|cia_encrypt
op_assign
id|arc4_crypt
comma
dot
id|cia_decrypt
op_assign
id|arc4_crypt
)brace
)brace
)brace
suffix:semicolon
DECL|function|arc4_init
r_static
r_int
id|__init
id|arc4_init
c_func
(paren
r_void
)paren
(brace
r_return
id|crypto_register_alg
c_func
(paren
op_amp
id|arc4_alg
)paren
suffix:semicolon
)brace
DECL|function|arc4_exit
r_static
r_void
id|__exit
id|arc4_exit
c_func
(paren
r_void
)paren
(brace
id|crypto_unregister_alg
c_func
(paren
op_amp
id|arc4_alg
)paren
suffix:semicolon
)brace
DECL|variable|arc4_init
id|module_init
c_func
(paren
id|arc4_init
)paren
suffix:semicolon
DECL|variable|arc4_exit
id|module_exit
c_func
(paren
id|arc4_exit
)paren
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
id|MODULE_DESCRIPTION
c_func
(paren
l_string|&quot;ARC4 Cipher Algorithm&quot;
)paren
suffix:semicolon
id|MODULE_AUTHOR
c_func
(paren
l_string|&quot;Jon Oberheide &lt;jon@focalhost.com&gt;&quot;
)paren
suffix:semicolon
eof
