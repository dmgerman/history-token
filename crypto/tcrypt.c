multiline_comment|/* &n; * Quick &amp; dirty crypto testing module.&n; *&n; * This will only exist until we have a better testing mechanism&n; * (e.g. a char device).&n; *&n; * Copyright (c) 2002 James Morris &lt;jmorris@intercode.com.au&gt;&n; * Copyright (c) 2002 Jean-Francois Dive &lt;jef@linuxbe.org&gt;&n; *&n; * This program is free software; you can redistribute it and/or modify it&n; * under the terms of the GNU General Public License as published by the Free&n; * Software Foundation; either version 2 of the License, or (at your option) &n; * any later version.&n; *&n; * 14 - 09 - 2003 &n; *&t;Rewritten by Kartikey Mahendra Bhatt&n; */
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;asm/scatterlist.h&gt;
macro_line|#include &lt;linux/string.h&gt;
macro_line|#include &lt;linux/crypto.h&gt;
macro_line|#include &lt;linux/highmem.h&gt;
macro_line|#include &quot;tcrypt.h&quot;
multiline_comment|/*&n; * Need to kmalloc() memory for testing kmap().&n; */
DECL|macro|TVMEMSIZE
mdefine_line|#define TVMEMSIZE&t;4096
DECL|macro|XBUFSIZE
mdefine_line|#define XBUFSIZE&t;32768
multiline_comment|/*&n; * Indexes into the xbuf to simulate cross-page access.&n; */
DECL|macro|IDX1
mdefine_line|#define IDX1&t;&t;37
DECL|macro|IDX2
mdefine_line|#define IDX2&t;&t;32400
DECL|macro|IDX3
mdefine_line|#define IDX3&t;&t;1
DECL|macro|IDX4
mdefine_line|#define IDX4&t;&t;8193
DECL|macro|IDX5
mdefine_line|#define IDX5&t;&t;22222
DECL|macro|IDX6
mdefine_line|#define IDX6&t;&t;17101
DECL|macro|IDX7
mdefine_line|#define IDX7&t;&t;27333
DECL|macro|IDX8
mdefine_line|#define IDX8&t;&t;3000
multiline_comment|/*&n;* Used by test_cipher()&n;*/
DECL|macro|ENCRYPT
mdefine_line|#define ENCRYPT 1
DECL|macro|DECRYPT
mdefine_line|#define DECRYPT 0
DECL|macro|MODE_ECB
mdefine_line|#define MODE_ECB 1
DECL|macro|MODE_CBC
mdefine_line|#define MODE_CBC 0
DECL|variable|IDX
r_static
r_int
r_int
id|IDX
(braket
l_int|8
)braket
op_assign
(brace
id|IDX1
comma
id|IDX2
comma
id|IDX3
comma
id|IDX4
comma
id|IDX5
comma
id|IDX6
comma
id|IDX7
comma
id|IDX8
)brace
suffix:semicolon
DECL|variable|mode
r_static
r_int
id|mode
suffix:semicolon
DECL|variable|xbuf
r_static
r_char
op_star
id|xbuf
suffix:semicolon
DECL|variable|tvmem
r_static
r_char
op_star
id|tvmem
suffix:semicolon
DECL|variable|check
r_static
r_char
op_star
id|check
(braket
)braket
op_assign
(brace
l_string|&quot;des&quot;
comma
l_string|&quot;md5&quot;
comma
l_string|&quot;des3_ede&quot;
comma
l_string|&quot;rot13&quot;
comma
l_string|&quot;sha1&quot;
comma
l_string|&quot;sha256&quot;
comma
l_string|&quot;blowfish&quot;
comma
l_string|&quot;twofish&quot;
comma
l_string|&quot;serpent&quot;
comma
l_string|&quot;sha384&quot;
comma
l_string|&quot;sha512&quot;
comma
l_string|&quot;md4&quot;
comma
l_string|&quot;aes&quot;
comma
l_string|&quot;cast6&quot;
comma
l_string|&quot;arc4&quot;
comma
l_string|&quot;deflate&quot;
comma
l_int|NULL
)brace
suffix:semicolon
r_static
r_void
DECL|function|hexdump
id|hexdump
c_func
(paren
r_int
r_char
op_star
id|buf
comma
r_int
r_int
id|len
)paren
(brace
r_while
c_loop
(paren
id|len
op_decrement
)paren
id|printk
c_func
(paren
l_string|&quot;%02x&quot;
comma
op_star
id|buf
op_increment
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|test_hash
id|test_hash
(paren
r_char
op_star
id|algo
comma
r_struct
id|hash_testvec
op_star
r_template
comma
r_int
r_int
id|tcount
)paren
(brace
r_char
op_star
id|p
suffix:semicolon
r_int
r_int
id|i
comma
id|j
comma
id|k
comma
id|temp
suffix:semicolon
r_struct
id|scatterlist
id|sg
(braket
l_int|8
)braket
suffix:semicolon
r_char
id|result
(braket
l_int|64
)braket
suffix:semicolon
r_struct
id|crypto_tfm
op_star
id|tfm
suffix:semicolon
r_struct
id|hash_testvec
op_star
id|hash_tv
suffix:semicolon
r_int
r_int
id|tsize
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting %s&bslash;n&quot;
comma
id|algo
)paren
suffix:semicolon
id|tsize
op_assign
r_sizeof
(paren
r_struct
id|hash_testvec
)paren
suffix:semicolon
id|tsize
op_mul_assign
id|tcount
suffix:semicolon
r_if
c_cond
(paren
id|tsize
OG
id|TVMEMSIZE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;template (%u) too big for tvmem (%u)&bslash;n&quot;
comma
id|tsize
comma
id|TVMEMSIZE
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|tvmem
comma
r_template
comma
id|tsize
)paren
suffix:semicolon
id|hash_tv
op_assign
(paren
r_void
op_star
)paren
id|tvmem
suffix:semicolon
id|tfm
op_assign
id|crypto_alloc_tfm
c_func
(paren
id|algo
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tfm
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;failed to load transform for %s&bslash;n&quot;
comma
id|algo
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|tcount
suffix:semicolon
id|i
op_increment
)paren
(brace
id|printk
(paren
l_string|&quot;test %u:&bslash;n&quot;
comma
id|i
op_plus
l_int|1
)paren
suffix:semicolon
id|memset
(paren
id|result
comma
l_int|0
comma
l_int|64
)paren
suffix:semicolon
id|p
op_assign
id|hash_tv
(braket
id|i
)braket
dot
id|plaintext
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
id|offset_in_page
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
id|hash_tv
(braket
id|i
)braket
dot
id|psize
suffix:semicolon
id|crypto_digest_init
(paren
id|tfm
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tfm-&gt;crt_u.digest.dit_setkey
)paren
(brace
id|crypto_digest_setkey
(paren
id|tfm
comma
id|hash_tv
(braket
id|i
)braket
dot
id|key
comma
id|hash_tv
(braket
id|i
)braket
dot
id|ksize
)paren
suffix:semicolon
)brace
id|crypto_digest_update
(paren
id|tfm
comma
id|sg
comma
l_int|1
)paren
suffix:semicolon
id|crypto_digest_final
(paren
id|tfm
comma
id|result
)paren
suffix:semicolon
id|hexdump
(paren
id|result
comma
id|crypto_tfm_alg_digestsize
(paren
id|tfm
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|result
comma
id|hash_tv
(braket
id|i
)braket
dot
id|digest
comma
id|crypto_tfm_alg_digestsize
c_func
(paren
id|tfm
)paren
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
)brace
id|printk
(paren
l_string|&quot;testing %s across pages&bslash;n&quot;
comma
id|algo
)paren
suffix:semicolon
multiline_comment|/* setup the dummy buffer first */
id|memset
c_func
(paren
id|xbuf
comma
l_int|0
comma
id|XBUFSIZE
)paren
suffix:semicolon
id|j
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|tcount
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|hash_tv
(braket
id|i
)braket
dot
id|np
)paren
(brace
id|j
op_increment
suffix:semicolon
id|printk
(paren
l_string|&quot;test %u:&bslash;n&quot;
comma
id|j
)paren
suffix:semicolon
id|memset
(paren
id|result
comma
l_int|0
comma
l_int|64
)paren
suffix:semicolon
id|temp
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|k
op_assign
l_int|0
suffix:semicolon
id|k
OL
id|hash_tv
(braket
id|i
)braket
dot
id|np
suffix:semicolon
id|k
op_increment
)paren
(brace
id|memcpy
(paren
op_amp
id|xbuf
(braket
id|IDX
(braket
id|k
)braket
)braket
comma
id|hash_tv
(braket
id|i
)braket
dot
id|plaintext
op_plus
id|temp
comma
id|hash_tv
(braket
id|i
)braket
dot
id|tap
(braket
id|k
)braket
)paren
suffix:semicolon
id|temp
op_add_assign
id|hash_tv
(braket
id|i
)braket
dot
id|tap
(braket
id|k
)braket
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX
(braket
id|k
)braket
)braket
suffix:semicolon
id|sg
(braket
id|k
)braket
dot
id|page
op_assign
id|virt_to_page
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
id|k
)braket
dot
id|offset
op_assign
id|offset_in_page
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
id|k
)braket
dot
id|length
op_assign
id|hash_tv
(braket
id|i
)braket
dot
id|tap
(braket
id|k
)braket
suffix:semicolon
)brace
id|crypto_digest_digest
(paren
id|tfm
comma
id|sg
comma
id|hash_tv
(braket
id|i
)braket
dot
id|np
comma
id|result
)paren
suffix:semicolon
id|hexdump
(paren
id|result
comma
id|crypto_tfm_alg_digestsize
(paren
id|tfm
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|result
comma
id|hash_tv
(braket
id|i
)braket
dot
id|digest
comma
id|crypto_tfm_alg_digestsize
c_func
(paren
id|tfm
)paren
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
)brace
)brace
id|crypto_free_tfm
(paren
id|tfm
)paren
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_CRYPTO_HMAC
r_static
r_void
DECL|function|test_hmac
id|test_hmac
c_func
(paren
r_char
op_star
id|algo
comma
r_struct
id|hmac_testvec
op_star
r_template
comma
r_int
r_int
id|tcount
)paren
(brace
r_char
op_star
id|p
suffix:semicolon
r_int
r_int
id|i
comma
id|j
comma
id|k
comma
id|temp
suffix:semicolon
r_struct
id|scatterlist
id|sg
(braket
l_int|8
)braket
suffix:semicolon
r_char
id|result
(braket
l_int|64
)braket
suffix:semicolon
r_struct
id|crypto_tfm
op_star
id|tfm
suffix:semicolon
r_struct
id|hmac_testvec
op_star
id|hmac_tv
suffix:semicolon
r_int
r_int
id|tsize
comma
id|klen
suffix:semicolon
id|tfm
op_assign
id|crypto_alloc_tfm
c_func
(paren
id|algo
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tfm
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;failed to load transform for %s&bslash;n&quot;
comma
id|algo
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting hmac_%s&bslash;n&quot;
comma
id|algo
)paren
suffix:semicolon
id|tsize
op_assign
r_sizeof
(paren
r_struct
id|hmac_testvec
)paren
suffix:semicolon
id|tsize
op_mul_assign
id|tcount
suffix:semicolon
r_if
c_cond
(paren
id|tsize
OG
id|TVMEMSIZE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;template (%u) too big for tvmem (%u)&bslash;n&quot;
comma
id|tsize
comma
id|TVMEMSIZE
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|tvmem
comma
r_template
comma
id|tsize
)paren
suffix:semicolon
id|hmac_tv
op_assign
(paren
r_void
op_star
)paren
id|tvmem
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|tcount
suffix:semicolon
id|i
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;test %u:&bslash;n&quot;
comma
id|i
op_plus
l_int|1
)paren
suffix:semicolon
id|memset
c_func
(paren
id|result
comma
l_int|0
comma
r_sizeof
(paren
id|result
)paren
)paren
suffix:semicolon
id|p
op_assign
id|hmac_tv
(braket
id|i
)braket
dot
id|plaintext
suffix:semicolon
id|klen
op_assign
id|hmac_tv
(braket
id|i
)braket
dot
id|ksize
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
id|offset_in_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
id|hmac_tv
(braket
id|i
)braket
dot
id|psize
suffix:semicolon
id|crypto_hmac
c_func
(paren
id|tfm
comma
id|hmac_tv
(braket
id|i
)braket
dot
id|key
comma
op_amp
id|klen
comma
id|sg
comma
l_int|1
comma
id|result
)paren
suffix:semicolon
id|hexdump
c_func
(paren
id|result
comma
id|crypto_tfm_alg_digestsize
c_func
(paren
id|tfm
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|result
comma
id|hmac_tv
(braket
id|i
)braket
dot
id|digest
comma
id|crypto_tfm_alg_digestsize
c_func
(paren
id|tfm
)paren
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting hmac_%s across pages&bslash;n&quot;
comma
id|algo
)paren
suffix:semicolon
id|memset
c_func
(paren
id|xbuf
comma
l_int|0
comma
id|XBUFSIZE
)paren
suffix:semicolon
id|j
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|tcount
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|hmac_tv
(braket
id|i
)braket
dot
id|np
)paren
(brace
id|j
op_increment
suffix:semicolon
id|printk
(paren
l_string|&quot;test %u:&bslash;n&quot;
comma
id|j
)paren
suffix:semicolon
id|memset
(paren
id|result
comma
l_int|0
comma
l_int|64
)paren
suffix:semicolon
id|temp
op_assign
l_int|0
suffix:semicolon
id|klen
op_assign
id|hmac_tv
(braket
id|i
)braket
dot
id|ksize
suffix:semicolon
r_for
c_loop
(paren
id|k
op_assign
l_int|0
suffix:semicolon
id|k
OL
id|hmac_tv
(braket
id|i
)braket
dot
id|np
suffix:semicolon
id|k
op_increment
)paren
(brace
id|memcpy
(paren
op_amp
id|xbuf
(braket
id|IDX
(braket
id|k
)braket
)braket
comma
id|hmac_tv
(braket
id|i
)braket
dot
id|plaintext
op_plus
id|temp
comma
id|hmac_tv
(braket
id|i
)braket
dot
id|tap
(braket
id|k
)braket
)paren
suffix:semicolon
id|temp
op_add_assign
id|hmac_tv
(braket
id|i
)braket
dot
id|tap
(braket
id|k
)braket
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX
(braket
id|k
)braket
)braket
suffix:semicolon
id|sg
(braket
id|k
)braket
dot
id|page
op_assign
id|virt_to_page
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
id|k
)braket
dot
id|offset
op_assign
id|offset_in_page
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
id|k
)braket
dot
id|length
op_assign
id|hmac_tv
(braket
id|i
)braket
dot
id|tap
(braket
id|k
)braket
suffix:semicolon
)brace
id|crypto_hmac
c_func
(paren
id|tfm
comma
id|hmac_tv
(braket
id|i
)braket
dot
id|key
comma
op_amp
id|klen
comma
id|sg
comma
id|hmac_tv
(braket
id|i
)braket
dot
id|np
comma
id|result
)paren
suffix:semicolon
id|hexdump
c_func
(paren
id|result
comma
id|crypto_tfm_alg_digestsize
c_func
(paren
id|tfm
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|result
comma
id|hmac_tv
(braket
id|i
)braket
dot
id|digest
comma
id|crypto_tfm_alg_digestsize
c_func
(paren
id|tfm
)paren
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
)brace
)brace
id|out
suffix:colon
id|crypto_free_tfm
c_func
(paren
id|tfm
)paren
suffix:semicolon
)brace
macro_line|#endif&t;/* CONFIG_CRYPTO_HMAC */
r_void
DECL|function|test_cipher
id|test_cipher
c_func
(paren
r_char
op_star
id|algo
comma
r_int
id|mode
comma
r_int
id|enc
comma
r_struct
id|cipher_testvec
op_star
r_template
comma
r_int
r_int
id|tcount
)paren
(brace
r_int
r_int
id|ret
comma
id|i
comma
id|j
comma
id|k
comma
id|temp
suffix:semicolon
r_int
r_int
id|tsize
suffix:semicolon
r_char
op_star
id|p
comma
op_star
id|q
suffix:semicolon
r_struct
id|crypto_tfm
op_star
id|tfm
suffix:semicolon
r_char
op_star
id|key
suffix:semicolon
r_struct
id|cipher_testvec
op_star
id|cipher_tv
suffix:semicolon
r_struct
id|scatterlist
id|sg
(braket
l_int|8
)braket
suffix:semicolon
r_char
id|e
(braket
l_int|11
)braket
comma
id|m
(braket
l_int|4
)braket
suffix:semicolon
r_if
c_cond
(paren
id|enc
op_eq
id|ENCRYPT
)paren
id|strncpy
c_func
(paren
id|e
comma
l_string|&quot;encryption&quot;
comma
l_int|11
)paren
suffix:semicolon
r_else
id|strncpy
c_func
(paren
id|e
comma
l_string|&quot;decryption&quot;
comma
l_int|11
)paren
suffix:semicolon
r_if
c_cond
(paren
id|mode
op_eq
id|MODE_ECB
)paren
id|strncpy
c_func
(paren
id|m
comma
l_string|&quot;ECB&quot;
comma
l_int|4
)paren
suffix:semicolon
r_else
id|strncpy
c_func
(paren
id|m
comma
l_string|&quot;CBC&quot;
comma
l_int|4
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting %s %s %s &bslash;n&quot;
comma
id|algo
comma
id|m
comma
id|e
)paren
suffix:semicolon
id|tsize
op_assign
r_sizeof
(paren
r_struct
id|cipher_testvec
)paren
suffix:semicolon
id|tsize
op_mul_assign
id|tcount
suffix:semicolon
r_if
c_cond
(paren
id|tsize
OG
id|TVMEMSIZE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;template (%u) too big for tvmem (%u)&bslash;n&quot;
comma
id|tsize
comma
id|TVMEMSIZE
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|tvmem
comma
r_template
comma
id|tsize
)paren
suffix:semicolon
id|cipher_tv
op_assign
(paren
r_void
op_star
)paren
id|tvmem
suffix:semicolon
r_if
c_cond
(paren
id|mode
)paren
id|tfm
op_assign
id|crypto_alloc_tfm
(paren
id|algo
comma
l_int|0
)paren
suffix:semicolon
r_else
id|tfm
op_assign
id|crypto_alloc_tfm
(paren
id|algo
comma
id|CRYPTO_TFM_MODE_CBC
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tfm
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;failed to load transform for %s %s&bslash;n&quot;
comma
id|algo
comma
id|m
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|j
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|tcount
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|cipher_tv
(braket
id|i
)braket
dot
id|np
)paren
)paren
(brace
id|j
op_increment
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;test %u (%d bit key):&bslash;n&quot;
comma
id|j
comma
id|cipher_tv
(braket
id|i
)braket
dot
id|klen
op_star
l_int|8
)paren
suffix:semicolon
id|tfm-&gt;crt_flags
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|cipher_tv
(braket
id|i
)braket
dot
id|wk
)paren
id|tfm-&gt;crt_flags
op_or_assign
id|CRYPTO_TFM_REQ_WEAK_KEY
suffix:semicolon
id|key
op_assign
id|cipher_tv
(braket
id|i
)braket
dot
id|key
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_setkey
c_func
(paren
id|tfm
comma
id|key
comma
id|cipher_tv
(braket
id|i
)braket
dot
id|klen
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;setkey() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|cipher_tv
(braket
id|i
)braket
dot
id|fail
)paren
r_goto
id|out
suffix:semicolon
)brace
id|p
op_assign
id|cipher_tv
(braket
id|i
)braket
dot
id|input
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
id|offset_in_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
id|cipher_tv
(braket
id|i
)braket
dot
id|ilen
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|mode
)paren
(brace
id|crypto_cipher_set_iv
c_func
(paren
id|tfm
comma
id|cipher_tv
(braket
id|i
)braket
dot
id|iv
comma
id|crypto_tfm_alg_ivsize
(paren
id|tfm
)paren
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|enc
)paren
id|ret
op_assign
id|crypto_cipher_encrypt
c_func
(paren
id|tfm
comma
id|sg
comma
id|sg
comma
id|cipher_tv
(braket
id|i
)braket
dot
id|ilen
)paren
suffix:semicolon
r_else
id|ret
op_assign
id|crypto_cipher_decrypt
c_func
(paren
id|tfm
comma
id|sg
comma
id|sg
comma
id|cipher_tv
(braket
id|i
)braket
dot
id|ilen
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s () failed flags=%x&bslash;n&quot;
comma
id|e
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|0
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|0
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
id|cipher_tv
(braket
id|i
)braket
dot
id|rlen
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|cipher_tv
(braket
id|i
)braket
dot
id|result
comma
id|cipher_tv
(braket
id|i
)braket
dot
id|rlen
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
)brace
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting %s %s %s across pages (chunking) &bslash;n&quot;
comma
id|algo
comma
id|m
comma
id|e
)paren
suffix:semicolon
id|memset
c_func
(paren
id|xbuf
comma
l_int|0
comma
id|XBUFSIZE
)paren
suffix:semicolon
id|j
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|tcount
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|cipher_tv
(braket
id|i
)braket
dot
id|np
)paren
(brace
id|j
op_increment
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;test %u (%d bit key):&bslash;n&quot;
comma
id|j
comma
id|cipher_tv
(braket
id|i
)braket
dot
id|klen
op_star
l_int|8
)paren
suffix:semicolon
id|tfm-&gt;crt_flags
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|cipher_tv
(braket
id|i
)braket
dot
id|wk
)paren
id|tfm-&gt;crt_flags
op_or_assign
id|CRYPTO_TFM_REQ_WEAK_KEY
suffix:semicolon
id|key
op_assign
id|cipher_tv
(braket
id|i
)braket
dot
id|key
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_setkey
c_func
(paren
id|tfm
comma
id|key
comma
id|cipher_tv
(braket
id|i
)braket
dot
id|klen
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;setkey() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|cipher_tv
(braket
id|i
)braket
dot
id|fail
)paren
r_goto
id|out
suffix:semicolon
)brace
id|temp
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|k
op_assign
l_int|0
suffix:semicolon
id|k
OL
id|cipher_tv
(braket
id|i
)braket
dot
id|np
suffix:semicolon
id|k
op_increment
)paren
(brace
id|memcpy
(paren
op_amp
id|xbuf
(braket
id|IDX
(braket
id|k
)braket
)braket
comma
id|cipher_tv
(braket
id|i
)braket
dot
id|input
op_plus
id|temp
comma
id|cipher_tv
(braket
id|i
)braket
dot
id|tap
(braket
id|k
)braket
)paren
suffix:semicolon
id|temp
op_add_assign
id|cipher_tv
(braket
id|i
)braket
dot
id|tap
(braket
id|k
)braket
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX
(braket
id|k
)braket
)braket
suffix:semicolon
id|sg
(braket
id|k
)braket
dot
id|page
op_assign
id|virt_to_page
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
id|k
)braket
dot
id|offset
op_assign
id|offset_in_page
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
id|k
)braket
dot
id|length
op_assign
id|cipher_tv
(braket
id|i
)braket
dot
id|tap
(braket
id|k
)braket
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|mode
)paren
(brace
id|crypto_cipher_set_iv
c_func
(paren
id|tfm
comma
id|cipher_tv
(braket
id|i
)braket
dot
id|iv
comma
id|crypto_tfm_alg_ivsize
(paren
id|tfm
)paren
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|enc
)paren
id|ret
op_assign
id|crypto_cipher_encrypt
c_func
(paren
id|tfm
comma
id|sg
comma
id|sg
comma
id|cipher_tv
(braket
id|i
)braket
dot
id|ilen
)paren
suffix:semicolon
r_else
id|ret
op_assign
id|crypto_cipher_decrypt
c_func
(paren
id|tfm
comma
id|sg
comma
id|sg
comma
id|cipher_tv
(braket
id|i
)braket
dot
id|ilen
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s () failed flags=%x&bslash;n&quot;
comma
id|e
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|temp
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|k
op_assign
l_int|0
suffix:semicolon
id|k
OL
id|cipher_tv
(braket
id|i
)braket
dot
id|np
suffix:semicolon
id|k
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;page %u&bslash;n&quot;
comma
id|k
)paren
suffix:semicolon
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
id|k
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
id|k
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
id|cipher_tv
(braket
id|i
)braket
dot
id|tap
(braket
id|k
)braket
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|cipher_tv
(braket
id|i
)braket
dot
id|result
op_plus
id|temp
comma
id|cipher_tv
(braket
id|i
)braket
dot
id|tap
(braket
id|k
)braket
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
id|temp
op_add_assign
id|cipher_tv
(braket
id|i
)braket
dot
id|tap
(braket
id|k
)braket
suffix:semicolon
)brace
)brace
)brace
id|out
suffix:colon
id|crypto_free_tfm
c_func
(paren
id|tfm
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|test_deflate
id|test_deflate
c_func
(paren
r_void
)paren
(brace
r_int
r_int
id|i
suffix:semicolon
r_char
id|result
(braket
id|COMP_BUF_SIZE
)braket
suffix:semicolon
r_struct
id|crypto_tfm
op_star
id|tfm
suffix:semicolon
r_struct
id|comp_testvec
op_star
id|tv
suffix:semicolon
r_int
r_int
id|tsize
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting deflate compression&bslash;n&quot;
)paren
suffix:semicolon
id|tsize
op_assign
r_sizeof
(paren
id|deflate_comp_tv_template
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tsize
OG
id|TVMEMSIZE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;template (%u) too big for tvmem (%u)&bslash;n&quot;
comma
id|tsize
comma
id|TVMEMSIZE
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|tvmem
comma
id|deflate_comp_tv_template
comma
id|tsize
)paren
suffix:semicolon
id|tv
op_assign
(paren
r_void
op_star
)paren
id|tvmem
suffix:semicolon
id|tfm
op_assign
id|crypto_alloc_tfm
c_func
(paren
l_string|&quot;deflate&quot;
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tfm
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;failed to load transform for deflate&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|DEFLATE_COMP_TEST_VECTORS
suffix:semicolon
id|i
op_increment
)paren
(brace
r_int
id|ilen
comma
id|ret
comma
id|dlen
op_assign
id|COMP_BUF_SIZE
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;test %u:&bslash;n&quot;
comma
id|i
op_plus
l_int|1
)paren
suffix:semicolon
id|memset
c_func
(paren
id|result
comma
l_int|0
comma
r_sizeof
(paren
id|result
)paren
)paren
suffix:semicolon
id|ilen
op_assign
id|tv
(braket
id|i
)braket
dot
id|inlen
suffix:semicolon
id|ret
op_assign
id|crypto_comp_compress
c_func
(paren
id|tfm
comma
id|tv
(braket
id|i
)braket
dot
id|input
comma
id|ilen
comma
id|result
comma
op_amp
id|dlen
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;fail: ret=%d&bslash;n&quot;
comma
id|ret
)paren
suffix:semicolon
r_continue
suffix:semicolon
)brace
id|hexdump
c_func
(paren
id|result
comma
id|dlen
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s (ratio %d:%d)&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|result
comma
id|tv
(braket
id|i
)braket
dot
id|output
comma
id|dlen
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
comma
id|ilen
comma
id|dlen
)paren
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting deflate decompression&bslash;n&quot;
)paren
suffix:semicolon
id|tsize
op_assign
r_sizeof
(paren
id|deflate_decomp_tv_template
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tsize
OG
id|TVMEMSIZE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;template (%u) too big for tvmem (%u)&bslash;n&quot;
comma
id|tsize
comma
id|TVMEMSIZE
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|tvmem
comma
id|deflate_decomp_tv_template
comma
id|tsize
)paren
suffix:semicolon
id|tv
op_assign
(paren
r_void
op_star
)paren
id|tvmem
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|DEFLATE_DECOMP_TEST_VECTORS
suffix:semicolon
id|i
op_increment
)paren
(brace
r_int
id|ilen
comma
id|ret
comma
id|dlen
op_assign
id|COMP_BUF_SIZE
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;test %u:&bslash;n&quot;
comma
id|i
op_plus
l_int|1
)paren
suffix:semicolon
id|memset
c_func
(paren
id|result
comma
l_int|0
comma
r_sizeof
(paren
id|result
)paren
)paren
suffix:semicolon
id|ilen
op_assign
id|tv
(braket
id|i
)braket
dot
id|inlen
suffix:semicolon
id|ret
op_assign
id|crypto_comp_decompress
c_func
(paren
id|tfm
comma
id|tv
(braket
id|i
)braket
dot
id|input
comma
id|ilen
comma
id|result
comma
op_amp
id|dlen
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;fail: ret=%d&bslash;n&quot;
comma
id|ret
)paren
suffix:semicolon
r_continue
suffix:semicolon
)brace
id|hexdump
c_func
(paren
id|result
comma
id|dlen
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s (ratio %d:%d)&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|result
comma
id|tv
(braket
id|i
)braket
dot
id|output
comma
id|dlen
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
comma
id|ilen
comma
id|dlen
)paren
suffix:semicolon
)brace
id|out
suffix:colon
id|crypto_free_tfm
c_func
(paren
id|tfm
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|test_available
id|test_available
c_func
(paren
r_void
)paren
(brace
r_char
op_star
op_star
id|name
op_assign
id|check
suffix:semicolon
r_while
c_loop
(paren
op_star
id|name
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;alg %s &quot;
comma
op_star
id|name
)paren
suffix:semicolon
id|printk
c_func
(paren
(paren
id|crypto_alg_available
c_func
(paren
op_star
id|name
comma
l_int|0
)paren
)paren
ques
c_cond
l_string|&quot;found&bslash;n&quot;
suffix:colon
l_string|&quot;not found&bslash;n&quot;
)paren
suffix:semicolon
id|name
op_increment
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|do_test
id|do_test
c_func
(paren
r_void
)paren
(brace
r_switch
c_cond
(paren
id|mode
)paren
(brace
r_case
l_int|0
suffix:colon
id|test_hash
c_func
(paren
l_string|&quot;md5&quot;
comma
id|md5_tv_template
comma
id|MD5_TEST_VECTORS
)paren
suffix:semicolon
id|test_hash
c_func
(paren
l_string|&quot;sha1&quot;
comma
id|sha1_tv_template
comma
id|SHA1_TEST_VECTORS
)paren
suffix:semicolon
singleline_comment|//DES
id|test_cipher
(paren
l_string|&quot;des&quot;
comma
id|MODE_ECB
comma
id|ENCRYPT
comma
id|des_enc_tv_template
comma
id|DES_ENC_TEST_VECTORS
)paren
suffix:semicolon
id|test_cipher
(paren
l_string|&quot;des&quot;
comma
id|MODE_ECB
comma
id|DECRYPT
comma
id|des_dec_tv_template
comma
id|DES_DEC_TEST_VECTORS
)paren
suffix:semicolon
id|test_cipher
(paren
l_string|&quot;des&quot;
comma
id|MODE_CBC
comma
id|ENCRYPT
comma
id|des_cbc_enc_tv_template
comma
id|DES_CBC_ENC_TEST_VECTORS
)paren
suffix:semicolon
id|test_cipher
(paren
l_string|&quot;des&quot;
comma
id|MODE_CBC
comma
id|DECRYPT
comma
id|des_cbc_dec_tv_template
comma
id|DES_CBC_DEC_TEST_VECTORS
)paren
suffix:semicolon
singleline_comment|//DES3_EDE
id|test_cipher
(paren
l_string|&quot;des3_ede&quot;
comma
id|MODE_ECB
comma
id|ENCRYPT
comma
id|des3_ede_enc_tv_template
comma
id|DES3_EDE_ENC_TEST_VECTORS
)paren
suffix:semicolon
id|test_cipher
(paren
l_string|&quot;des3_ede&quot;
comma
id|MODE_ECB
comma
id|DECRYPT
comma
id|des3_ede_dec_tv_template
comma
id|DES3_EDE_DEC_TEST_VECTORS
)paren
suffix:semicolon
id|test_hash
c_func
(paren
l_string|&quot;md4&quot;
comma
id|md4_tv_template
comma
id|MD4_TEST_VECTORS
)paren
suffix:semicolon
id|test_hash
c_func
(paren
l_string|&quot;sha256&quot;
comma
id|sha256_tv_template
comma
id|SHA256_TEST_VECTORS
)paren
suffix:semicolon
singleline_comment|//BLOWFISH
id|test_cipher
(paren
l_string|&quot;blowfish&quot;
comma
id|MODE_ECB
comma
id|ENCRYPT
comma
id|bf_enc_tv_template
comma
id|BF_ENC_TEST_VECTORS
)paren
suffix:semicolon
id|test_cipher
(paren
l_string|&quot;blowfish&quot;
comma
id|MODE_ECB
comma
id|DECRYPT
comma
id|bf_dec_tv_template
comma
id|BF_DEC_TEST_VECTORS
)paren
suffix:semicolon
id|test_cipher
(paren
l_string|&quot;blowfish&quot;
comma
id|MODE_CBC
comma
id|ENCRYPT
comma
id|bf_cbc_enc_tv_template
comma
id|BF_CBC_ENC_TEST_VECTORS
)paren
suffix:semicolon
id|test_cipher
(paren
l_string|&quot;blowfish&quot;
comma
id|MODE_CBC
comma
id|DECRYPT
comma
id|bf_cbc_dec_tv_template
comma
id|BF_CBC_DEC_TEST_VECTORS
)paren
suffix:semicolon
singleline_comment|//TWOFISH
id|test_cipher
(paren
l_string|&quot;twofish&quot;
comma
id|MODE_ECB
comma
id|ENCRYPT
comma
id|tf_enc_tv_template
comma
id|TF_ENC_TEST_VECTORS
)paren
suffix:semicolon
id|test_cipher
(paren
l_string|&quot;twofish&quot;
comma
id|MODE_ECB
comma
id|DECRYPT
comma
id|tf_dec_tv_template
comma
id|TF_DEC_TEST_VECTORS
)paren
suffix:semicolon
id|test_cipher
(paren
l_string|&quot;twofish&quot;
comma
id|MODE_CBC
comma
id|ENCRYPT
comma
id|tf_cbc_enc_tv_template
comma
id|TF_CBC_ENC_TEST_VECTORS
)paren
suffix:semicolon
id|test_cipher
(paren
l_string|&quot;twofish&quot;
comma
id|MODE_CBC
comma
id|DECRYPT
comma
id|tf_cbc_dec_tv_template
comma
id|TF_CBC_DEC_TEST_VECTORS
)paren
suffix:semicolon
singleline_comment|//SERPENT
id|test_cipher
(paren
l_string|&quot;serpent&quot;
comma
id|MODE_ECB
comma
id|ENCRYPT
comma
id|serpent_enc_tv_template
comma
id|SERPENT_ENC_TEST_VECTORS
)paren
suffix:semicolon
id|test_cipher
(paren
l_string|&quot;serpent&quot;
comma
id|MODE_ECB
comma
id|DECRYPT
comma
id|serpent_dec_tv_template
comma
id|SERPENT_DEC_TEST_VECTORS
)paren
suffix:semicolon
singleline_comment|//AES
id|test_cipher
(paren
l_string|&quot;aes&quot;
comma
id|MODE_ECB
comma
id|ENCRYPT
comma
id|aes_enc_tv_template
comma
id|AES_ENC_TEST_VECTORS
)paren
suffix:semicolon
id|test_cipher
(paren
l_string|&quot;aes&quot;
comma
id|MODE_ECB
comma
id|DECRYPT
comma
id|aes_dec_tv_template
comma
id|AES_DEC_TEST_VECTORS
)paren
suffix:semicolon
singleline_comment|//CAST5
id|test_cipher
(paren
l_string|&quot;cast5&quot;
comma
id|MODE_ECB
comma
id|ENCRYPT
comma
id|cast5_enc_tv_template
comma
id|CAST5_ENC_TEST_VECTORS
)paren
suffix:semicolon
id|test_cipher
(paren
l_string|&quot;cast5&quot;
comma
id|MODE_ECB
comma
id|DECRYPT
comma
id|cast5_dec_tv_template
comma
id|CAST5_DEC_TEST_VECTORS
)paren
suffix:semicolon
singleline_comment|//CAST6
id|test_cipher
(paren
l_string|&quot;cast6&quot;
comma
id|MODE_ECB
comma
id|ENCRYPT
comma
id|cast6_enc_tv_template
comma
id|CAST6_ENC_TEST_VECTORS
)paren
suffix:semicolon
id|test_cipher
(paren
l_string|&quot;cast6&quot;
comma
id|MODE_ECB
comma
id|DECRYPT
comma
id|cast6_dec_tv_template
comma
id|CAST6_DEC_TEST_VECTORS
)paren
suffix:semicolon
singleline_comment|//ARC4
id|test_cipher
(paren
l_string|&quot;arc4&quot;
comma
id|MODE_ECB
comma
id|ENCRYPT
comma
id|arc4_enc_tv_template
comma
id|ARC4_ENC_TEST_VECTORS
)paren
suffix:semicolon
id|test_cipher
(paren
l_string|&quot;arc4&quot;
comma
id|MODE_ECB
comma
id|DECRYPT
comma
id|arc4_dec_tv_template
comma
id|ARC4_DEC_TEST_VECTORS
)paren
suffix:semicolon
id|test_hash
c_func
(paren
l_string|&quot;sha384&quot;
comma
id|sha384_tv_template
comma
id|SHA384_TEST_VECTORS
)paren
suffix:semicolon
id|test_hash
c_func
(paren
l_string|&quot;sha512&quot;
comma
id|sha512_tv_template
comma
id|SHA512_TEST_VECTORS
)paren
suffix:semicolon
id|test_deflate
c_func
(paren
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_CRYPTO_HMAC
id|test_hmac
c_func
(paren
l_string|&quot;md5&quot;
comma
id|hmac_md5_tv_template
comma
id|HMAC_MD5_TEST_VECTORS
)paren
suffix:semicolon
id|test_hmac
c_func
(paren
l_string|&quot;sha1&quot;
comma
id|hmac_sha1_tv_template
comma
id|HMAC_SHA1_TEST_VECTORS
)paren
suffix:semicolon
id|test_hmac
c_func
(paren
l_string|&quot;sha256&quot;
comma
id|hmac_sha256_tv_template
comma
id|HMAC_SHA256_TEST_VECTORS
)paren
suffix:semicolon
macro_line|#endif&t;&t;
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|test_hash
c_func
(paren
l_string|&quot;md5&quot;
comma
id|md5_tv_template
comma
id|MD5_TEST_VECTORS
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|test_hash
c_func
(paren
l_string|&quot;sha1&quot;
comma
id|sha1_tv_template
comma
id|SHA1_TEST_VECTORS
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
id|test_cipher
(paren
l_string|&quot;des&quot;
comma
id|MODE_ECB
comma
id|ENCRYPT
comma
id|des_enc_tv_template
comma
id|DES_ENC_TEST_VECTORS
)paren
suffix:semicolon
id|test_cipher
(paren
l_string|&quot;des&quot;
comma
id|MODE_ECB
comma
id|DECRYPT
comma
id|des_dec_tv_template
comma
id|DES_DEC_TEST_VECTORS
)paren
suffix:semicolon
id|test_cipher
(paren
l_string|&quot;des&quot;
comma
id|MODE_CBC
comma
id|ENCRYPT
comma
id|des_cbc_enc_tv_template
comma
id|DES_CBC_ENC_TEST_VECTORS
)paren
suffix:semicolon
id|test_cipher
(paren
l_string|&quot;des&quot;
comma
id|MODE_CBC
comma
id|DECRYPT
comma
id|des_cbc_dec_tv_template
comma
id|DES_CBC_DEC_TEST_VECTORS
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|4
suffix:colon
id|test_cipher
(paren
l_string|&quot;des3_ede&quot;
comma
id|MODE_ECB
comma
id|ENCRYPT
comma
id|des3_ede_enc_tv_template
comma
id|DES3_EDE_ENC_TEST_VECTORS
)paren
suffix:semicolon
id|test_cipher
(paren
l_string|&quot;des3_ede&quot;
comma
id|MODE_ECB
comma
id|DECRYPT
comma
id|des3_ede_dec_tv_template
comma
id|DES3_EDE_DEC_TEST_VECTORS
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|5
suffix:colon
id|test_hash
c_func
(paren
l_string|&quot;md4&quot;
comma
id|md4_tv_template
comma
id|MD4_TEST_VECTORS
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|6
suffix:colon
id|test_hash
c_func
(paren
l_string|&quot;sha256&quot;
comma
id|sha256_tv_template
comma
id|SHA256_TEST_VECTORS
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|7
suffix:colon
id|test_cipher
(paren
l_string|&quot;blowfish&quot;
comma
id|MODE_ECB
comma
id|ENCRYPT
comma
id|bf_enc_tv_template
comma
id|BF_ENC_TEST_VECTORS
)paren
suffix:semicolon
id|test_cipher
(paren
l_string|&quot;blowfish&quot;
comma
id|MODE_ECB
comma
id|DECRYPT
comma
id|bf_dec_tv_template
comma
id|BF_DEC_TEST_VECTORS
)paren
suffix:semicolon
id|test_cipher
(paren
l_string|&quot;blowfish&quot;
comma
id|MODE_CBC
comma
id|ENCRYPT
comma
id|bf_cbc_enc_tv_template
comma
id|BF_CBC_ENC_TEST_VECTORS
)paren
suffix:semicolon
id|test_cipher
(paren
l_string|&quot;blowfish&quot;
comma
id|MODE_CBC
comma
id|DECRYPT
comma
id|bf_cbc_dec_tv_template
comma
id|BF_CBC_DEC_TEST_VECTORS
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|8
suffix:colon
id|test_cipher
(paren
l_string|&quot;twofish&quot;
comma
id|MODE_ECB
comma
id|ENCRYPT
comma
id|tf_enc_tv_template
comma
id|TF_ENC_TEST_VECTORS
)paren
suffix:semicolon
id|test_cipher
(paren
l_string|&quot;twofish&quot;
comma
id|MODE_ECB
comma
id|DECRYPT
comma
id|tf_dec_tv_template
comma
id|TF_DEC_TEST_VECTORS
)paren
suffix:semicolon
id|test_cipher
(paren
l_string|&quot;twofish&quot;
comma
id|MODE_CBC
comma
id|ENCRYPT
comma
id|tf_cbc_enc_tv_template
comma
id|TF_CBC_ENC_TEST_VECTORS
)paren
suffix:semicolon
id|test_cipher
(paren
l_string|&quot;twofish&quot;
comma
id|MODE_CBC
comma
id|DECRYPT
comma
id|tf_cbc_dec_tv_template
comma
id|TF_CBC_DEC_TEST_VECTORS
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|9
suffix:colon
r_break
suffix:semicolon
r_case
l_int|10
suffix:colon
id|test_cipher
(paren
l_string|&quot;aes&quot;
comma
id|MODE_ECB
comma
id|ENCRYPT
comma
id|aes_enc_tv_template
comma
id|AES_ENC_TEST_VECTORS
)paren
suffix:semicolon
id|test_cipher
(paren
l_string|&quot;aes&quot;
comma
id|MODE_ECB
comma
id|DECRYPT
comma
id|aes_dec_tv_template
comma
id|AES_DEC_TEST_VECTORS
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|11
suffix:colon
id|test_hash
c_func
(paren
l_string|&quot;sha384&quot;
comma
id|sha384_tv_template
comma
id|SHA384_TEST_VECTORS
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|12
suffix:colon
id|test_hash
c_func
(paren
l_string|&quot;sha512&quot;
comma
id|sha512_tv_template
comma
id|SHA512_TEST_VECTORS
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|13
suffix:colon
id|test_deflate
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|14
suffix:colon
id|test_cipher
(paren
l_string|&quot;cast5&quot;
comma
id|MODE_ECB
comma
id|ENCRYPT
comma
id|cast5_enc_tv_template
comma
id|CAST5_ENC_TEST_VECTORS
)paren
suffix:semicolon
id|test_cipher
(paren
l_string|&quot;cast5&quot;
comma
id|MODE_ECB
comma
id|DECRYPT
comma
id|cast5_dec_tv_template
comma
id|CAST5_DEC_TEST_VECTORS
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|15
suffix:colon
id|test_cipher
(paren
l_string|&quot;cast6&quot;
comma
id|MODE_ECB
comma
id|ENCRYPT
comma
id|cast6_enc_tv_template
comma
id|CAST6_ENC_TEST_VECTORS
)paren
suffix:semicolon
id|test_cipher
(paren
l_string|&quot;cast6&quot;
comma
id|MODE_ECB
comma
id|DECRYPT
comma
id|cast6_dec_tv_template
comma
id|CAST6_DEC_TEST_VECTORS
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|16
suffix:colon
id|test_cipher
(paren
l_string|&quot;arc4&quot;
comma
id|MODE_ECB
comma
id|ENCRYPT
comma
id|arc4_enc_tv_template
comma
id|ARC4_ENC_TEST_VECTORS
)paren
suffix:semicolon
id|test_cipher
(paren
l_string|&quot;arc4&quot;
comma
id|MODE_ECB
comma
id|DECRYPT
comma
id|arc4_dec_tv_template
comma
id|ARC4_DEC_TEST_VECTORS
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#ifdef CONFIG_CRYPTO_HMAC
r_case
l_int|100
suffix:colon
id|test_hmac
c_func
(paren
l_string|&quot;md5&quot;
comma
id|hmac_md5_tv_template
comma
id|HMAC_MD5_TEST_VECTORS
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|101
suffix:colon
id|test_hmac
c_func
(paren
l_string|&quot;sha1&quot;
comma
id|hmac_sha1_tv_template
comma
id|HMAC_SHA1_TEST_VECTORS
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|102
suffix:colon
id|test_hmac
c_func
(paren
l_string|&quot;sha256&quot;
comma
id|hmac_sha256_tv_template
comma
id|HMAC_SHA256_TEST_VECTORS
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
r_case
l_int|1000
suffix:colon
id|test_available
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
multiline_comment|/* useful for debugging */
id|printk
c_func
(paren
l_string|&quot;not testing anything&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_static
r_int
id|__init
DECL|function|init
id|init
c_func
(paren
r_void
)paren
(brace
id|tvmem
op_assign
id|kmalloc
c_func
(paren
id|TVMEMSIZE
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tvmem
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|xbuf
op_assign
id|kmalloc
c_func
(paren
id|XBUFSIZE
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|xbuf
op_eq
l_int|NULL
)paren
(brace
id|kfree
c_func
(paren
id|tvmem
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|do_test
c_func
(paren
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|xbuf
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|tvmem
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * If an init function is provided, an exit function must also be provided&n; * to allow module unload.&n; */
DECL|function|fini
r_static
r_void
id|__exit
id|fini
c_func
(paren
r_void
)paren
(brace
)brace
DECL|variable|init
id|module_init
c_func
(paren
id|init
)paren
suffix:semicolon
DECL|variable|fini
id|module_exit
c_func
(paren
id|fini
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|mode
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
id|MODULE_DESCRIPTION
c_func
(paren
l_string|&quot;Quick &amp; dirty crypto testing module&quot;
)paren
suffix:semicolon
id|MODULE_AUTHOR
c_func
(paren
l_string|&quot;James Morris &lt;jmorris@intercode.com.au&gt;&quot;
)paren
suffix:semicolon
eof
