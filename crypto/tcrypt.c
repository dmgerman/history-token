multiline_comment|/* &n; * Quick &amp; dirty crypto testing module.&n; *&n; * This will only exist until we have a better testing mechanism&n; * (e.g. a char device).&n; *&n; * Copyright (c) 2002 James Morris &lt;jmorris@intercode.com.au&gt;&n; * Copyright (c) 2002 Jean-Francois Dive &lt;jef@linuxbe.org&gt;&n; * &n; * This program is free software; you can redistribute it and/or modify it&n; * under the terms of the GNU General Public License as published by the Free&n; * Software Foundation; either version 2 of the License, or (at your option) &n; * any later version.&n; *&n; */
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/string.h&gt;
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;asm/scatterlist.h&gt;
macro_line|#include &lt;linux/string.h&gt;
macro_line|#include &lt;linux/crypto.h&gt;
macro_line|#include &lt;linux/highmem.h&gt;
macro_line|#include &quot;tcrypt.h&quot;
multiline_comment|/*&n; * Need to kmalloc() memory for testing kmap().&n; */
DECL|macro|TVMEMSIZE
mdefine_line|#define TVMEMSIZE&t;4096
DECL|macro|XBUFSIZE
mdefine_line|#define XBUFSIZE&t;32768
multiline_comment|/*&n; * Indexes into the xbuf to simulate cross-page access.&n; */
DECL|macro|IDX1
mdefine_line|#define IDX1&t;&t;37
DECL|macro|IDX2
mdefine_line|#define IDX2&t;&t;32400
DECL|macro|IDX3
mdefine_line|#define IDX3&t;&t;1
DECL|macro|IDX4
mdefine_line|#define IDX4&t;&t;8193
DECL|macro|IDX5
mdefine_line|#define IDX5&t;&t;22222
DECL|macro|IDX6
mdefine_line|#define IDX6&t;&t;17101
DECL|macro|IDX7
mdefine_line|#define IDX7&t;&t;27333
DECL|macro|IDX8
mdefine_line|#define IDX8&t;&t;3000
DECL|variable|mode
r_static
r_int
id|mode
suffix:semicolon
DECL|variable|xbuf
r_static
r_char
op_star
id|xbuf
suffix:semicolon
DECL|variable|tvmem
r_static
r_char
op_star
id|tvmem
suffix:semicolon
DECL|variable|check
r_static
r_char
op_star
id|check
(braket
)braket
op_assign
(brace
l_string|&quot;des&quot;
comma
l_string|&quot;md5&quot;
comma
l_string|&quot;des3_ede&quot;
comma
l_string|&quot;rot13&quot;
comma
l_string|&quot;sha1&quot;
comma
l_string|&quot;sha256&quot;
comma
l_string|&quot;blowfish&quot;
comma
l_string|&quot;twofish&quot;
comma
l_string|&quot;serpent&quot;
comma
l_string|&quot;sha384&quot;
comma
l_string|&quot;sha512&quot;
comma
l_string|&quot;md4&quot;
comma
l_string|&quot;aes&quot;
comma
l_string|&quot;deflate&quot;
comma
l_int|NULL
)brace
suffix:semicolon
r_static
r_void
DECL|function|hexdump
id|hexdump
c_func
(paren
r_int
r_char
op_star
id|buf
comma
r_int
r_int
id|len
)paren
(brace
r_while
c_loop
(paren
id|len
op_decrement
)paren
id|printk
c_func
(paren
l_string|&quot;%02x&quot;
comma
op_star
id|buf
op_increment
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|test_md5
id|test_md5
c_func
(paren
r_void
)paren
(brace
r_char
op_star
id|p
suffix:semicolon
r_int
r_int
id|i
suffix:semicolon
r_struct
id|scatterlist
id|sg
(braket
l_int|2
)braket
suffix:semicolon
r_char
id|result
(braket
l_int|128
)braket
suffix:semicolon
r_struct
id|crypto_tfm
op_star
id|tfm
suffix:semicolon
r_struct
id|md5_testvec
op_star
id|md5_tv
suffix:semicolon
r_int
r_int
id|tsize
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting md5&bslash;n&quot;
)paren
suffix:semicolon
id|tsize
op_assign
r_sizeof
(paren
id|md5_tv_template
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tsize
OG
id|TVMEMSIZE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;template (%u) too big for tvmem (%u)&bslash;n&quot;
comma
id|tsize
comma
id|TVMEMSIZE
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|tvmem
comma
id|md5_tv_template
comma
id|tsize
)paren
suffix:semicolon
id|md5_tv
op_assign
(paren
r_void
op_star
)paren
id|tvmem
suffix:semicolon
id|tfm
op_assign
id|crypto_alloc_tfm
c_func
(paren
l_string|&quot;md5&quot;
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tfm
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;failed to load transform for md5&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|MD5_TEST_VECTORS
suffix:semicolon
id|i
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;test %u:&bslash;n&quot;
comma
id|i
op_plus
l_int|1
)paren
suffix:semicolon
id|memset
c_func
(paren
id|result
comma
l_int|0
comma
r_sizeof
(paren
id|result
)paren
)paren
suffix:semicolon
id|p
op_assign
id|md5_tv
(braket
id|i
)braket
dot
id|plaintext
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
id|strlen
c_func
(paren
id|md5_tv
(braket
id|i
)braket
dot
id|plaintext
)paren
suffix:semicolon
id|crypto_digest_init
c_func
(paren
id|tfm
)paren
suffix:semicolon
id|crypto_digest_update
c_func
(paren
id|tfm
comma
id|sg
comma
l_int|1
)paren
suffix:semicolon
id|crypto_digest_final
c_func
(paren
id|tfm
comma
id|result
)paren
suffix:semicolon
id|hexdump
c_func
(paren
id|result
comma
id|crypto_tfm_alg_digestsize
c_func
(paren
id|tfm
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|result
comma
id|md5_tv
(braket
id|i
)braket
dot
id|digest
comma
id|crypto_tfm_alg_digestsize
c_func
(paren
id|tfm
)paren
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting md5 across pages&bslash;n&quot;
)paren
suffix:semicolon
multiline_comment|/* setup the dummy buffer first */
id|memset
c_func
(paren
id|xbuf
comma
l_int|0
comma
id|XBUFSIZE
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|xbuf
(braket
id|IDX1
)braket
comma
l_string|&quot;abcdefghijklm&quot;
comma
l_int|13
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|xbuf
(braket
id|IDX2
)braket
comma
l_string|&quot;nopqrstuvwxyz&quot;
comma
l_int|13
)paren
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX1
)braket
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
l_int|13
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX2
)braket
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|length
op_assign
l_int|13
suffix:semicolon
id|memset
c_func
(paren
id|result
comma
l_int|0
comma
r_sizeof
(paren
id|result
)paren
)paren
suffix:semicolon
id|crypto_digest_digest
c_func
(paren
id|tfm
comma
id|sg
comma
l_int|2
comma
id|result
)paren
suffix:semicolon
id|hexdump
c_func
(paren
id|result
comma
id|crypto_tfm_alg_digestsize
c_func
(paren
id|tfm
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|result
comma
id|md5_tv
(braket
l_int|4
)braket
dot
id|digest
comma
id|crypto_tfm_alg_digestsize
c_func
(paren
id|tfm
)paren
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
id|crypto_free_tfm
c_func
(paren
id|tfm
)paren
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_CRYPTO_HMAC
r_static
r_void
DECL|function|test_hmac_md5
id|test_hmac_md5
c_func
(paren
r_void
)paren
(brace
r_char
op_star
id|p
suffix:semicolon
r_int
r_int
id|i
comma
id|klen
suffix:semicolon
r_struct
id|scatterlist
id|sg
(braket
l_int|2
)braket
suffix:semicolon
r_char
id|result
(braket
l_int|128
)braket
suffix:semicolon
r_struct
id|crypto_tfm
op_star
id|tfm
suffix:semicolon
r_struct
id|hmac_md5_testvec
op_star
id|hmac_md5_tv
suffix:semicolon
r_int
r_int
id|tsize
suffix:semicolon
id|tfm
op_assign
id|crypto_alloc_tfm
c_func
(paren
l_string|&quot;md5&quot;
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tfm
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;failed to load transform for md5&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting hmac_md5&bslash;n&quot;
)paren
suffix:semicolon
id|tsize
op_assign
r_sizeof
(paren
id|hmac_md5_tv_template
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tsize
OG
id|TVMEMSIZE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;template (%u) too big for tvmem (%u)&bslash;n&quot;
comma
id|tsize
comma
id|TVMEMSIZE
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|tvmem
comma
id|hmac_md5_tv_template
comma
id|tsize
)paren
suffix:semicolon
id|hmac_md5_tv
op_assign
(paren
r_void
op_star
)paren
id|tvmem
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|HMAC_MD5_TEST_VECTORS
suffix:semicolon
id|i
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;test %u:&bslash;n&quot;
comma
id|i
op_plus
l_int|1
)paren
suffix:semicolon
id|memset
c_func
(paren
id|result
comma
l_int|0
comma
r_sizeof
(paren
id|result
)paren
)paren
suffix:semicolon
id|p
op_assign
id|hmac_md5_tv
(braket
id|i
)braket
dot
id|plaintext
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
id|strlen
c_func
(paren
id|hmac_md5_tv
(braket
id|i
)braket
dot
id|plaintext
)paren
suffix:semicolon
id|klen
op_assign
id|strlen
c_func
(paren
id|hmac_md5_tv
(braket
id|i
)braket
dot
id|key
)paren
suffix:semicolon
id|crypto_hmac
c_func
(paren
id|tfm
comma
id|hmac_md5_tv
(braket
id|i
)braket
dot
id|key
comma
op_amp
id|klen
comma
id|sg
comma
l_int|1
comma
id|result
)paren
suffix:semicolon
id|hexdump
c_func
(paren
id|result
comma
id|crypto_tfm_alg_digestsize
c_func
(paren
id|tfm
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|result
comma
id|hmac_md5_tv
(braket
id|i
)braket
dot
id|digest
comma
id|crypto_tfm_alg_digestsize
c_func
(paren
id|tfm
)paren
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting hmac_md5 across pages&bslash;n&quot;
)paren
suffix:semicolon
id|memset
c_func
(paren
id|xbuf
comma
l_int|0
comma
id|XBUFSIZE
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|xbuf
(braket
id|IDX1
)braket
comma
l_string|&quot;what do ya want &quot;
comma
l_int|16
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|xbuf
(braket
id|IDX2
)braket
comma
l_string|&quot;for nothing?&quot;
comma
l_int|12
)paren
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX1
)braket
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
l_int|16
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX2
)braket
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|length
op_assign
l_int|12
suffix:semicolon
id|memset
c_func
(paren
id|result
comma
l_int|0
comma
r_sizeof
(paren
id|result
)paren
)paren
suffix:semicolon
id|klen
op_assign
id|strlen
c_func
(paren
id|hmac_md5_tv
(braket
l_int|7
)braket
dot
id|key
)paren
suffix:semicolon
id|crypto_hmac
c_func
(paren
id|tfm
comma
id|hmac_md5_tv
(braket
l_int|7
)braket
dot
id|key
comma
op_amp
id|klen
comma
id|sg
comma
l_int|2
comma
id|result
)paren
suffix:semicolon
id|hexdump
c_func
(paren
id|result
comma
id|crypto_tfm_alg_digestsize
c_func
(paren
id|tfm
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|result
comma
id|hmac_md5_tv
(braket
l_int|7
)braket
dot
id|digest
comma
id|crypto_tfm_alg_digestsize
c_func
(paren
id|tfm
)paren
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
id|out
suffix:colon
id|crypto_free_tfm
c_func
(paren
id|tfm
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|test_hmac_sha1
id|test_hmac_sha1
c_func
(paren
r_void
)paren
(brace
r_char
op_star
id|p
suffix:semicolon
r_int
r_int
id|i
comma
id|klen
suffix:semicolon
r_struct
id|crypto_tfm
op_star
id|tfm
suffix:semicolon
r_struct
id|hmac_sha1_testvec
op_star
id|hmac_sha1_tv
suffix:semicolon
r_struct
id|scatterlist
id|sg
(braket
l_int|2
)braket
suffix:semicolon
r_int
r_int
id|tsize
suffix:semicolon
r_char
id|result
(braket
id|SHA1_DIGEST_SIZE
)braket
suffix:semicolon
id|tfm
op_assign
id|crypto_alloc_tfm
c_func
(paren
l_string|&quot;sha1&quot;
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tfm
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;failed to load transform for sha1&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting hmac_sha1&bslash;n&quot;
)paren
suffix:semicolon
id|tsize
op_assign
r_sizeof
(paren
id|hmac_sha1_tv_template
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tsize
OG
id|TVMEMSIZE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;template (%u) too big for tvmem (%u)&bslash;n&quot;
comma
id|tsize
comma
id|TVMEMSIZE
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|tvmem
comma
id|hmac_sha1_tv_template
comma
id|tsize
)paren
suffix:semicolon
id|hmac_sha1_tv
op_assign
(paren
r_void
op_star
)paren
id|tvmem
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|HMAC_SHA1_TEST_VECTORS
suffix:semicolon
id|i
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;test %u:&bslash;n&quot;
comma
id|i
op_plus
l_int|1
)paren
suffix:semicolon
id|memset
c_func
(paren
id|result
comma
l_int|0
comma
r_sizeof
(paren
id|result
)paren
)paren
suffix:semicolon
id|p
op_assign
id|hmac_sha1_tv
(braket
id|i
)braket
dot
id|plaintext
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
id|strlen
c_func
(paren
id|hmac_sha1_tv
(braket
id|i
)braket
dot
id|plaintext
)paren
suffix:semicolon
id|klen
op_assign
id|strlen
c_func
(paren
id|hmac_sha1_tv
(braket
id|i
)braket
dot
id|key
)paren
suffix:semicolon
id|crypto_hmac
c_func
(paren
id|tfm
comma
id|hmac_sha1_tv
(braket
id|i
)braket
dot
id|key
comma
op_amp
id|klen
comma
id|sg
comma
l_int|1
comma
id|result
)paren
suffix:semicolon
id|hexdump
c_func
(paren
id|result
comma
r_sizeof
(paren
id|result
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|result
comma
id|hmac_sha1_tv
(braket
id|i
)braket
dot
id|digest
comma
id|crypto_tfm_alg_digestsize
c_func
(paren
id|tfm
)paren
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting hmac_sha1 across pages&bslash;n&quot;
)paren
suffix:semicolon
multiline_comment|/* setup the dummy buffer first */
id|memset
c_func
(paren
id|xbuf
comma
l_int|0
comma
id|XBUFSIZE
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|xbuf
(braket
id|IDX1
)braket
comma
l_string|&quot;what do ya want &quot;
comma
l_int|16
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|xbuf
(braket
id|IDX2
)braket
comma
l_string|&quot;for nothing?&quot;
comma
l_int|12
)paren
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX1
)braket
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
l_int|16
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX2
)braket
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|length
op_assign
l_int|12
suffix:semicolon
id|memset
c_func
(paren
id|result
comma
l_int|0
comma
r_sizeof
(paren
id|result
)paren
)paren
suffix:semicolon
id|klen
op_assign
id|strlen
c_func
(paren
id|hmac_sha1_tv
(braket
l_int|7
)braket
dot
id|key
)paren
suffix:semicolon
id|crypto_hmac
c_func
(paren
id|tfm
comma
id|hmac_sha1_tv
(braket
l_int|7
)braket
dot
id|key
comma
op_amp
id|klen
comma
id|sg
comma
l_int|2
comma
id|result
)paren
suffix:semicolon
id|hexdump
c_func
(paren
id|result
comma
id|crypto_tfm_alg_digestsize
c_func
(paren
id|tfm
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|result
comma
id|hmac_sha1_tv
(braket
l_int|7
)braket
dot
id|digest
comma
id|crypto_tfm_alg_digestsize
c_func
(paren
id|tfm
)paren
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
id|out
suffix:colon
id|crypto_free_tfm
c_func
(paren
id|tfm
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|test_hmac_sha256
id|test_hmac_sha256
c_func
(paren
r_void
)paren
(brace
r_char
op_star
id|p
suffix:semicolon
r_int
r_int
id|i
comma
id|klen
suffix:semicolon
r_struct
id|crypto_tfm
op_star
id|tfm
suffix:semicolon
r_struct
id|hmac_sha256_testvec
op_star
id|hmac_sha256_tv
suffix:semicolon
r_struct
id|scatterlist
id|sg
(braket
l_int|2
)braket
suffix:semicolon
r_int
r_int
id|tsize
suffix:semicolon
r_char
id|result
(braket
id|SHA256_DIGEST_SIZE
)braket
suffix:semicolon
id|tfm
op_assign
id|crypto_alloc_tfm
c_func
(paren
l_string|&quot;sha256&quot;
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tfm
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;failed to load transform for sha256&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting hmac_sha256&bslash;n&quot;
)paren
suffix:semicolon
id|tsize
op_assign
r_sizeof
(paren
id|hmac_sha256_tv_template
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tsize
OG
id|TVMEMSIZE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;template (%u) too big for tvmem (%u)&bslash;n&quot;
comma
id|tsize
comma
id|TVMEMSIZE
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|tvmem
comma
id|hmac_sha256_tv_template
comma
id|tsize
)paren
suffix:semicolon
id|hmac_sha256_tv
op_assign
(paren
r_void
op_star
)paren
id|tvmem
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|HMAC_SHA256_TEST_VECTORS
suffix:semicolon
id|i
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;test %u:&bslash;n&quot;
comma
id|i
op_plus
l_int|1
)paren
suffix:semicolon
id|memset
c_func
(paren
id|result
comma
l_int|0
comma
r_sizeof
(paren
id|result
)paren
)paren
suffix:semicolon
id|p
op_assign
id|hmac_sha256_tv
(braket
id|i
)braket
dot
id|plaintext
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
id|strlen
c_func
(paren
id|hmac_sha256_tv
(braket
id|i
)braket
dot
id|plaintext
)paren
suffix:semicolon
id|klen
op_assign
id|strlen
c_func
(paren
id|hmac_sha256_tv
(braket
id|i
)braket
dot
id|key
)paren
suffix:semicolon
id|hexdump
c_func
(paren
id|hmac_sha256_tv
(braket
id|i
)braket
dot
id|key
comma
id|strlen
c_func
(paren
id|hmac_sha256_tv
(braket
id|i
)braket
dot
id|key
)paren
)paren
suffix:semicolon
id|crypto_hmac
c_func
(paren
id|tfm
comma
id|hmac_sha256_tv
(braket
id|i
)braket
dot
id|key
comma
op_amp
id|klen
comma
id|sg
comma
l_int|1
comma
id|result
)paren
suffix:semicolon
id|hexdump
c_func
(paren
id|result
comma
id|crypto_tfm_alg_digestsize
c_func
(paren
id|tfm
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|result
comma
id|hmac_sha256_tv
(braket
id|i
)braket
dot
id|digest
comma
id|crypto_tfm_alg_digestsize
c_func
(paren
id|tfm
)paren
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
)brace
id|out
suffix:colon
id|crypto_free_tfm
c_func
(paren
id|tfm
)paren
suffix:semicolon
)brace
macro_line|#endif&t;/* CONFIG_CRYPTO_HMAC */
r_static
r_void
DECL|function|test_md4
id|test_md4
c_func
(paren
r_void
)paren
(brace
r_char
op_star
id|p
suffix:semicolon
r_int
r_int
id|i
suffix:semicolon
r_struct
id|scatterlist
id|sg
(braket
l_int|1
)braket
suffix:semicolon
r_char
id|result
(braket
l_int|128
)braket
suffix:semicolon
r_struct
id|crypto_tfm
op_star
id|tfm
suffix:semicolon
r_struct
id|md4_testvec
op_star
id|md4_tv
suffix:semicolon
r_int
r_int
id|tsize
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting md4&bslash;n&quot;
)paren
suffix:semicolon
id|tsize
op_assign
r_sizeof
(paren
id|md4_tv_template
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tsize
OG
id|TVMEMSIZE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;template (%u) too big for tvmem (%u)&bslash;n&quot;
comma
id|tsize
comma
id|TVMEMSIZE
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|tvmem
comma
id|md4_tv_template
comma
id|tsize
)paren
suffix:semicolon
id|md4_tv
op_assign
(paren
r_void
op_star
)paren
id|tvmem
suffix:semicolon
id|tfm
op_assign
id|crypto_alloc_tfm
c_func
(paren
l_string|&quot;md4&quot;
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tfm
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;failed to load transform for md4&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|MD4_TEST_VECTORS
suffix:semicolon
id|i
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;test %u:&bslash;n&quot;
comma
id|i
op_plus
l_int|1
)paren
suffix:semicolon
id|memset
c_func
(paren
id|result
comma
l_int|0
comma
r_sizeof
(paren
id|result
)paren
)paren
suffix:semicolon
id|p
op_assign
id|md4_tv
(braket
id|i
)braket
dot
id|plaintext
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
id|strlen
c_func
(paren
id|md4_tv
(braket
id|i
)braket
dot
id|plaintext
)paren
suffix:semicolon
id|crypto_digest_digest
c_func
(paren
id|tfm
comma
id|sg
comma
l_int|1
comma
id|result
)paren
suffix:semicolon
id|hexdump
c_func
(paren
id|result
comma
id|crypto_tfm_alg_digestsize
c_func
(paren
id|tfm
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|result
comma
id|md4_tv
(braket
id|i
)braket
dot
id|digest
comma
id|crypto_tfm_alg_digestsize
c_func
(paren
id|tfm
)paren
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
)brace
id|crypto_free_tfm
c_func
(paren
id|tfm
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|test_sha1
id|test_sha1
c_func
(paren
r_void
)paren
(brace
r_char
op_star
id|p
suffix:semicolon
r_int
r_int
id|i
suffix:semicolon
r_struct
id|crypto_tfm
op_star
id|tfm
suffix:semicolon
r_struct
id|sha1_testvec
op_star
id|sha1_tv
suffix:semicolon
r_struct
id|scatterlist
id|sg
(braket
l_int|2
)braket
suffix:semicolon
r_int
r_int
id|tsize
suffix:semicolon
r_char
id|result
(braket
id|SHA1_DIGEST_SIZE
)braket
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting sha1&bslash;n&quot;
)paren
suffix:semicolon
id|tsize
op_assign
r_sizeof
(paren
id|sha1_tv_template
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tsize
OG
id|TVMEMSIZE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;template (%u) too big for tvmem (%u)&bslash;n&quot;
comma
id|tsize
comma
id|TVMEMSIZE
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|tvmem
comma
id|sha1_tv_template
comma
id|tsize
)paren
suffix:semicolon
id|sha1_tv
op_assign
(paren
r_void
op_star
)paren
id|tvmem
suffix:semicolon
id|tfm
op_assign
id|crypto_alloc_tfm
c_func
(paren
l_string|&quot;sha1&quot;
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tfm
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;failed to load transform for sha1&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|SHA1_TEST_VECTORS
suffix:semicolon
id|i
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;test %u:&bslash;n&quot;
comma
id|i
op_plus
l_int|1
)paren
suffix:semicolon
id|memset
c_func
(paren
id|result
comma
l_int|0
comma
r_sizeof
(paren
id|result
)paren
)paren
suffix:semicolon
id|p
op_assign
id|sha1_tv
(braket
id|i
)braket
dot
id|plaintext
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
id|strlen
c_func
(paren
id|sha1_tv
(braket
id|i
)braket
dot
id|plaintext
)paren
suffix:semicolon
id|crypto_digest_init
c_func
(paren
id|tfm
)paren
suffix:semicolon
id|crypto_digest_update
c_func
(paren
id|tfm
comma
id|sg
comma
l_int|1
)paren
suffix:semicolon
id|crypto_digest_final
c_func
(paren
id|tfm
comma
id|result
)paren
suffix:semicolon
id|hexdump
c_func
(paren
id|result
comma
id|crypto_tfm_alg_digestsize
c_func
(paren
id|tfm
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|result
comma
id|sha1_tv
(braket
id|i
)braket
dot
id|digest
comma
id|crypto_tfm_alg_digestsize
c_func
(paren
id|tfm
)paren
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting sha1 across pages&bslash;n&quot;
)paren
suffix:semicolon
multiline_comment|/* setup the dummy buffer first */
id|memset
c_func
(paren
id|xbuf
comma
l_int|0
comma
id|XBUFSIZE
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|xbuf
(braket
id|IDX1
)braket
comma
l_string|&quot;abcdbcdecdefdefgefghfghighij&quot;
comma
l_int|28
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|xbuf
(braket
id|IDX2
)braket
comma
l_string|&quot;hijkijkljklmklmnlmnomnopnopq&quot;
comma
l_int|28
)paren
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX1
)braket
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
l_int|28
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX2
)braket
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|length
op_assign
l_int|28
suffix:semicolon
id|memset
c_func
(paren
id|result
comma
l_int|0
comma
r_sizeof
(paren
id|result
)paren
)paren
suffix:semicolon
id|crypto_digest_digest
c_func
(paren
id|tfm
comma
id|sg
comma
l_int|2
comma
id|result
)paren
suffix:semicolon
id|hexdump
c_func
(paren
id|result
comma
id|crypto_tfm_alg_digestsize
c_func
(paren
id|tfm
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|result
comma
id|sha1_tv
(braket
l_int|1
)braket
dot
id|digest
comma
id|crypto_tfm_alg_digestsize
c_func
(paren
id|tfm
)paren
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
id|crypto_free_tfm
c_func
(paren
id|tfm
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|test_sha256
id|test_sha256
c_func
(paren
r_void
)paren
(brace
r_char
op_star
id|p
suffix:semicolon
r_int
r_int
id|i
suffix:semicolon
r_struct
id|crypto_tfm
op_star
id|tfm
suffix:semicolon
r_struct
id|sha256_testvec
op_star
id|sha256_tv
suffix:semicolon
r_struct
id|scatterlist
id|sg
(braket
l_int|2
)braket
suffix:semicolon
r_int
r_int
id|tsize
suffix:semicolon
r_char
id|result
(braket
id|SHA256_DIGEST_SIZE
)braket
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting sha256&bslash;n&quot;
)paren
suffix:semicolon
id|tsize
op_assign
r_sizeof
(paren
id|sha256_tv_template
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tsize
OG
id|TVMEMSIZE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;template (%u) too big for tvmem (%u)&bslash;n&quot;
comma
id|tsize
comma
id|TVMEMSIZE
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|tvmem
comma
id|sha256_tv_template
comma
id|tsize
)paren
suffix:semicolon
id|sha256_tv
op_assign
(paren
r_void
op_star
)paren
id|tvmem
suffix:semicolon
id|tfm
op_assign
id|crypto_alloc_tfm
c_func
(paren
l_string|&quot;sha256&quot;
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tfm
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;failed to load transform for sha256&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|SHA256_TEST_VECTORS
suffix:semicolon
id|i
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;test %u:&bslash;n&quot;
comma
id|i
op_plus
l_int|1
)paren
suffix:semicolon
id|memset
c_func
(paren
id|result
comma
l_int|0
comma
r_sizeof
(paren
id|result
)paren
)paren
suffix:semicolon
id|p
op_assign
id|sha256_tv
(braket
id|i
)braket
dot
id|plaintext
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
id|strlen
c_func
(paren
id|sha256_tv
(braket
id|i
)braket
dot
id|plaintext
)paren
suffix:semicolon
id|crypto_digest_init
c_func
(paren
id|tfm
)paren
suffix:semicolon
id|crypto_digest_update
c_func
(paren
id|tfm
comma
id|sg
comma
l_int|1
)paren
suffix:semicolon
id|crypto_digest_final
c_func
(paren
id|tfm
comma
id|result
)paren
suffix:semicolon
id|hexdump
c_func
(paren
id|result
comma
id|crypto_tfm_alg_digestsize
c_func
(paren
id|tfm
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|result
comma
id|sha256_tv
(braket
id|i
)braket
dot
id|digest
comma
id|crypto_tfm_alg_digestsize
c_func
(paren
id|tfm
)paren
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting sha256 across pages&bslash;n&quot;
)paren
suffix:semicolon
multiline_comment|/* setup the dummy buffer first */
id|memset
c_func
(paren
id|xbuf
comma
l_int|0
comma
id|XBUFSIZE
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|xbuf
(braket
id|IDX1
)braket
comma
l_string|&quot;abcdbcdecdefdefgefghfghighij&quot;
comma
l_int|28
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|xbuf
(braket
id|IDX2
)braket
comma
l_string|&quot;hijkijkljklmklmnlmnomnopnopq&quot;
comma
l_int|28
)paren
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX1
)braket
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
l_int|28
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX2
)braket
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|length
op_assign
l_int|28
suffix:semicolon
id|memset
c_func
(paren
id|result
comma
l_int|0
comma
r_sizeof
(paren
id|result
)paren
)paren
suffix:semicolon
id|crypto_digest_digest
c_func
(paren
id|tfm
comma
id|sg
comma
l_int|2
comma
id|result
)paren
suffix:semicolon
id|hexdump
c_func
(paren
id|result
comma
id|crypto_tfm_alg_digestsize
c_func
(paren
id|tfm
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|result
comma
id|sha256_tv
(braket
l_int|1
)braket
dot
id|digest
comma
id|crypto_tfm_alg_digestsize
c_func
(paren
id|tfm
)paren
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
id|crypto_free_tfm
c_func
(paren
id|tfm
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|test_sha384
id|test_sha384
c_func
(paren
r_void
)paren
(brace
r_char
op_star
id|p
suffix:semicolon
r_int
r_int
id|i
suffix:semicolon
r_struct
id|crypto_tfm
op_star
id|tfm
suffix:semicolon
r_struct
id|sha384_testvec
op_star
id|sha384_tv
suffix:semicolon
r_struct
id|scatterlist
id|sg
(braket
l_int|2
)braket
suffix:semicolon
r_int
r_int
id|tsize
suffix:semicolon
r_char
id|result
(braket
id|SHA384_DIGEST_SIZE
)braket
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting sha384&bslash;n&quot;
)paren
suffix:semicolon
id|tsize
op_assign
r_sizeof
(paren
id|sha384_tv_template
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tsize
OG
id|TVMEMSIZE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;template (%u) too big for tvmem (%u)&bslash;n&quot;
comma
id|tsize
comma
id|TVMEMSIZE
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|tvmem
comma
id|sha384_tv_template
comma
id|tsize
)paren
suffix:semicolon
id|sha384_tv
op_assign
(paren
r_void
op_star
)paren
id|tvmem
suffix:semicolon
id|tfm
op_assign
id|crypto_alloc_tfm
c_func
(paren
l_string|&quot;sha384&quot;
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tfm
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;failed to load transform for sha384&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|SHA384_TEST_VECTORS
suffix:semicolon
id|i
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;test %u:&bslash;n&quot;
comma
id|i
op_plus
l_int|1
)paren
suffix:semicolon
id|memset
c_func
(paren
id|result
comma
l_int|0
comma
r_sizeof
(paren
id|result
)paren
)paren
suffix:semicolon
id|p
op_assign
id|sha384_tv
(braket
id|i
)braket
dot
id|plaintext
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
id|strlen
c_func
(paren
id|sha384_tv
(braket
id|i
)braket
dot
id|plaintext
)paren
suffix:semicolon
id|crypto_digest_init
c_func
(paren
id|tfm
)paren
suffix:semicolon
id|crypto_digest_update
c_func
(paren
id|tfm
comma
id|sg
comma
l_int|1
)paren
suffix:semicolon
id|crypto_digest_final
c_func
(paren
id|tfm
comma
id|result
)paren
suffix:semicolon
id|hexdump
c_func
(paren
id|result
comma
id|crypto_tfm_alg_digestsize
c_func
(paren
id|tfm
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|result
comma
id|sha384_tv
(braket
id|i
)braket
dot
id|digest
comma
id|crypto_tfm_alg_digestsize
c_func
(paren
id|tfm
)paren
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
)brace
id|crypto_free_tfm
c_func
(paren
id|tfm
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|test_sha512
id|test_sha512
c_func
(paren
r_void
)paren
(brace
r_char
op_star
id|p
suffix:semicolon
r_int
r_int
id|i
suffix:semicolon
r_struct
id|crypto_tfm
op_star
id|tfm
suffix:semicolon
r_struct
id|sha512_testvec
op_star
id|sha512_tv
suffix:semicolon
r_struct
id|scatterlist
id|sg
(braket
l_int|2
)braket
suffix:semicolon
r_int
r_int
id|tsize
suffix:semicolon
r_char
id|result
(braket
id|SHA512_DIGEST_SIZE
)braket
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting sha512&bslash;n&quot;
)paren
suffix:semicolon
id|tsize
op_assign
r_sizeof
(paren
id|sha512_tv_template
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tsize
OG
id|TVMEMSIZE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;template (%u) too big for tvmem (%u)&bslash;n&quot;
comma
id|tsize
comma
id|TVMEMSIZE
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|tvmem
comma
id|sha512_tv_template
comma
id|tsize
)paren
suffix:semicolon
id|sha512_tv
op_assign
(paren
r_void
op_star
)paren
id|tvmem
suffix:semicolon
id|tfm
op_assign
id|crypto_alloc_tfm
c_func
(paren
l_string|&quot;sha512&quot;
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tfm
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;failed to load transform for sha512&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|SHA512_TEST_VECTORS
suffix:semicolon
id|i
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;test %u:&bslash;n&quot;
comma
id|i
op_plus
l_int|1
)paren
suffix:semicolon
id|memset
c_func
(paren
id|result
comma
l_int|0
comma
r_sizeof
(paren
id|result
)paren
)paren
suffix:semicolon
id|p
op_assign
id|sha512_tv
(braket
id|i
)braket
dot
id|plaintext
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
id|strlen
c_func
(paren
id|sha512_tv
(braket
id|i
)braket
dot
id|plaintext
)paren
suffix:semicolon
id|crypto_digest_init
c_func
(paren
id|tfm
)paren
suffix:semicolon
id|crypto_digest_update
c_func
(paren
id|tfm
comma
id|sg
comma
l_int|1
)paren
suffix:semicolon
id|crypto_digest_final
c_func
(paren
id|tfm
comma
id|result
)paren
suffix:semicolon
id|hexdump
c_func
(paren
id|result
comma
id|crypto_tfm_alg_digestsize
c_func
(paren
id|tfm
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|result
comma
id|sha512_tv
(braket
id|i
)braket
dot
id|digest
comma
id|crypto_tfm_alg_digestsize
c_func
(paren
id|tfm
)paren
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
)brace
id|crypto_free_tfm
c_func
(paren
id|tfm
)paren
suffix:semicolon
)brace
r_void
DECL|function|test_des
id|test_des
c_func
(paren
r_void
)paren
(brace
r_int
r_int
id|ret
comma
id|i
comma
id|len
suffix:semicolon
r_int
r_int
id|tsize
suffix:semicolon
r_char
op_star
id|p
comma
op_star
id|q
suffix:semicolon
r_struct
id|crypto_tfm
op_star
id|tfm
suffix:semicolon
r_char
op_star
id|key
suffix:semicolon
r_char
id|res
(braket
l_int|8
)braket
suffix:semicolon
r_struct
id|des_tv
op_star
id|des_tv
suffix:semicolon
r_struct
id|scatterlist
id|sg
(braket
l_int|8
)braket
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting des encryption&bslash;n&quot;
)paren
suffix:semicolon
id|tsize
op_assign
r_sizeof
(paren
id|des_enc_tv_template
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tsize
OG
id|TVMEMSIZE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;template (%u) too big for tvmem (%u)&bslash;n&quot;
comma
id|tsize
comma
id|TVMEMSIZE
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|tvmem
comma
id|des_enc_tv_template
comma
id|tsize
)paren
suffix:semicolon
id|des_tv
op_assign
(paren
r_void
op_star
)paren
id|tvmem
suffix:semicolon
id|tfm
op_assign
id|crypto_alloc_tfm
c_func
(paren
l_string|&quot;des&quot;
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tfm
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;failed to load transform for des (default ecb)&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|DES_ENC_TEST_VECTORS
suffix:semicolon
id|i
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;test %u:&bslash;n&quot;
comma
id|i
op_plus
l_int|1
)paren
suffix:semicolon
id|key
op_assign
id|des_tv
(braket
id|i
)braket
dot
id|key
suffix:semicolon
id|tfm-&gt;crt_flags
op_or_assign
id|CRYPTO_TFM_REQ_WEAK_KEY
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_setkey
c_func
(paren
id|tfm
comma
id|key
comma
l_int|8
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;setkey() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|des_tv
(braket
id|i
)braket
dot
id|fail
)paren
r_goto
id|out
suffix:semicolon
)brace
id|len
op_assign
id|des_tv
(braket
id|i
)braket
dot
id|len
suffix:semicolon
id|p
op_assign
id|des_tv
(braket
id|i
)braket
dot
id|plaintext
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
id|len
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_encrypt
c_func
(paren
id|tfm
comma
id|sg
comma
id|sg
comma
id|len
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;encrypt() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|0
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|0
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
id|len
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|des_tv
(braket
id|i
)braket
dot
id|result
comma
id|len
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting des ecb encryption across pages&bslash;n&quot;
)paren
suffix:semicolon
id|i
op_assign
l_int|5
suffix:semicolon
id|key
op_assign
id|des_tv
(braket
id|i
)braket
dot
id|key
suffix:semicolon
id|tfm-&gt;crt_flags
op_assign
l_int|0
suffix:semicolon
id|hexdump
c_func
(paren
id|key
comma
l_int|8
)paren
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_setkey
c_func
(paren
id|tfm
comma
id|key
comma
l_int|8
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;setkey() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
multiline_comment|/* setup the dummy buffer first */
id|memset
c_func
(paren
id|xbuf
comma
l_int|0
comma
r_sizeof
(paren
id|xbuf
)paren
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|xbuf
(braket
id|IDX1
)braket
comma
id|des_tv
(braket
id|i
)braket
dot
id|plaintext
comma
l_int|8
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|xbuf
(braket
id|IDX2
)braket
comma
id|des_tv
(braket
id|i
)braket
dot
id|plaintext
op_plus
l_int|8
comma
l_int|8
)paren
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX1
)braket
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
l_int|8
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX2
)braket
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|length
op_assign
l_int|8
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_encrypt
c_func
(paren
id|tfm
comma
id|sg
comma
id|sg
comma
l_int|16
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;encrypt() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;page 1&bslash;n&quot;
)paren
suffix:semicolon
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|0
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|0
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
l_int|8
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|des_tv
(braket
id|i
)braket
dot
id|result
comma
l_int|8
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;page 2&bslash;n&quot;
)paren
suffix:semicolon
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|1
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|1
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
l_int|8
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|des_tv
(braket
id|i
)braket
dot
id|result
op_plus
l_int|8
comma
l_int|8
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting des ecb encryption chunking scenario A&bslash;n&quot;
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * Scenario A:&n;&t; * &n;&t; *  F1       F2      F3&n;&t; *  [8 + 6]  [2 + 8] [8]&n;&t; *       ^^^^^^   ^&n;&t; *       a    b   c&n;&t; *&n;&t; * Chunking should begin at a, then end with b, and&n;&t; * continue encrypting at an offset of 2 until c.&n;&t; *&n;&t; */
id|i
op_assign
l_int|7
suffix:semicolon
id|key
op_assign
id|des_tv
(braket
id|i
)braket
dot
id|key
suffix:semicolon
id|tfm-&gt;crt_flags
op_assign
l_int|0
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_setkey
c_func
(paren
id|tfm
comma
id|key
comma
l_int|8
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;setkey() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
multiline_comment|/* setup the dummy buffer first */
id|memset
c_func
(paren
id|xbuf
comma
l_int|0
comma
r_sizeof
(paren
id|xbuf
)paren
)paren
suffix:semicolon
multiline_comment|/* Frag 1: 8 + 6 */
id|memcpy
c_func
(paren
op_amp
id|xbuf
(braket
id|IDX3
)braket
comma
id|des_tv
(braket
id|i
)braket
dot
id|plaintext
comma
l_int|14
)paren
suffix:semicolon
multiline_comment|/* Frag 2: 2 + 8 */
id|memcpy
c_func
(paren
op_amp
id|xbuf
(braket
id|IDX4
)braket
comma
id|des_tv
(braket
id|i
)braket
dot
id|plaintext
op_plus
l_int|14
comma
l_int|10
)paren
suffix:semicolon
multiline_comment|/* Frag 3: 8 */
id|memcpy
c_func
(paren
op_amp
id|xbuf
(braket
id|IDX5
)braket
comma
id|des_tv
(braket
id|i
)braket
dot
id|plaintext
op_plus
l_int|24
comma
l_int|8
)paren
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX3
)braket
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
l_int|14
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX4
)braket
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|length
op_assign
l_int|10
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX5
)braket
suffix:semicolon
id|sg
(braket
l_int|2
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|2
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|2
)braket
dot
id|length
op_assign
l_int|8
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_encrypt
c_func
(paren
id|tfm
comma
id|sg
comma
id|sg
comma
l_int|32
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;decrypt() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;page 1&bslash;n&quot;
)paren
suffix:semicolon
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|0
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|0
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
l_int|14
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|des_tv
(braket
id|i
)braket
dot
id|result
comma
l_int|14
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;page 2&bslash;n&quot;
)paren
suffix:semicolon
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|1
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|1
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
l_int|10
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|des_tv
(braket
id|i
)braket
dot
id|result
op_plus
l_int|14
comma
l_int|10
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;page 3&bslash;n&quot;
)paren
suffix:semicolon
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|2
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|2
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
l_int|8
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|des_tv
(braket
id|i
)braket
dot
id|result
op_plus
l_int|24
comma
l_int|8
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting des ecb encryption chunking scenario B&bslash;n&quot;
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * Scenario B:&n;&t; * &n;&t; *  F1  F2  F3  F4&n;&t; *  [2] [1] [3] [2 + 8 + 8]&n;&t; */
id|i
op_assign
l_int|7
suffix:semicolon
id|key
op_assign
id|des_tv
(braket
id|i
)braket
dot
id|key
suffix:semicolon
id|tfm-&gt;crt_flags
op_assign
l_int|0
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_setkey
c_func
(paren
id|tfm
comma
id|key
comma
l_int|8
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;setkey() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
multiline_comment|/* setup the dummy buffer first */
id|memset
c_func
(paren
id|xbuf
comma
l_int|0
comma
r_sizeof
(paren
id|xbuf
)paren
)paren
suffix:semicolon
multiline_comment|/* Frag 1: 2 */
id|memcpy
c_func
(paren
op_amp
id|xbuf
(braket
id|IDX3
)braket
comma
id|des_tv
(braket
id|i
)braket
dot
id|plaintext
comma
l_int|2
)paren
suffix:semicolon
multiline_comment|/* Frag 2: 1 */
id|memcpy
c_func
(paren
op_amp
id|xbuf
(braket
id|IDX4
)braket
comma
id|des_tv
(braket
id|i
)braket
dot
id|plaintext
op_plus
l_int|2
comma
l_int|1
)paren
suffix:semicolon
multiline_comment|/* Frag 3: 3 */
id|memcpy
c_func
(paren
op_amp
id|xbuf
(braket
id|IDX5
)braket
comma
id|des_tv
(braket
id|i
)braket
dot
id|plaintext
op_plus
l_int|3
comma
l_int|3
)paren
suffix:semicolon
multiline_comment|/* Frag 4: 2 + 8 + 8 */
id|memcpy
c_func
(paren
op_amp
id|xbuf
(braket
id|IDX6
)braket
comma
id|des_tv
(braket
id|i
)braket
dot
id|plaintext
op_plus
l_int|6
comma
l_int|18
)paren
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX3
)braket
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
l_int|2
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX4
)braket
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|length
op_assign
l_int|1
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX5
)braket
suffix:semicolon
id|sg
(braket
l_int|2
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|2
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|2
)braket
dot
id|length
op_assign
l_int|3
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX6
)braket
suffix:semicolon
id|sg
(braket
l_int|3
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|3
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|3
)braket
dot
id|length
op_assign
l_int|18
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_encrypt
c_func
(paren
id|tfm
comma
id|sg
comma
id|sg
comma
l_int|24
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;encrypt() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;page 1&bslash;n&quot;
)paren
suffix:semicolon
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|0
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|0
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
l_int|2
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|des_tv
(braket
id|i
)braket
dot
id|result
comma
l_int|2
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;page 2&bslash;n&quot;
)paren
suffix:semicolon
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|1
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|1
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
l_int|1
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|des_tv
(braket
id|i
)braket
dot
id|result
op_plus
l_int|2
comma
l_int|1
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;page 3&bslash;n&quot;
)paren
suffix:semicolon
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|2
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|2
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
l_int|3
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|des_tv
(braket
id|i
)braket
dot
id|result
op_plus
l_int|3
comma
l_int|3
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;page 4&bslash;n&quot;
)paren
suffix:semicolon
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|3
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|3
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
l_int|18
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|des_tv
(braket
id|i
)braket
dot
id|result
op_plus
l_int|6
comma
l_int|18
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting des ecb encryption chunking scenario C&bslash;n&quot;
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * Scenario B:&n;&t; * &n;&t; *  F1  F2  F3  F4  F5&n;&t; *  [2] [2] [2] [2] [8]&n;&t; */
id|i
op_assign
l_int|7
suffix:semicolon
id|key
op_assign
id|des_tv
(braket
id|i
)braket
dot
id|key
suffix:semicolon
id|tfm-&gt;crt_flags
op_assign
l_int|0
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_setkey
c_func
(paren
id|tfm
comma
id|key
comma
l_int|8
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;setkey() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
multiline_comment|/* setup the dummy buffer first */
id|memset
c_func
(paren
id|xbuf
comma
l_int|0
comma
r_sizeof
(paren
id|xbuf
)paren
)paren
suffix:semicolon
multiline_comment|/* Frag 1: 2 */
id|memcpy
c_func
(paren
op_amp
id|xbuf
(braket
id|IDX3
)braket
comma
id|des_tv
(braket
id|i
)braket
dot
id|plaintext
comma
l_int|2
)paren
suffix:semicolon
multiline_comment|/* Frag 2: 2 */
id|memcpy
c_func
(paren
op_amp
id|xbuf
(braket
id|IDX4
)braket
comma
id|des_tv
(braket
id|i
)braket
dot
id|plaintext
op_plus
l_int|2
comma
l_int|2
)paren
suffix:semicolon
multiline_comment|/* Frag 3: 2 */
id|memcpy
c_func
(paren
op_amp
id|xbuf
(braket
id|IDX5
)braket
comma
id|des_tv
(braket
id|i
)braket
dot
id|plaintext
op_plus
l_int|4
comma
l_int|2
)paren
suffix:semicolon
multiline_comment|/* Frag 4: 2 */
id|memcpy
c_func
(paren
op_amp
id|xbuf
(braket
id|IDX6
)braket
comma
id|des_tv
(braket
id|i
)braket
dot
id|plaintext
op_plus
l_int|6
comma
l_int|2
)paren
suffix:semicolon
multiline_comment|/* Frag 5: 8 */
id|memcpy
c_func
(paren
op_amp
id|xbuf
(braket
id|IDX7
)braket
comma
id|des_tv
(braket
id|i
)braket
dot
id|plaintext
op_plus
l_int|8
comma
l_int|8
)paren
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX3
)braket
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
l_int|2
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX4
)braket
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|length
op_assign
l_int|2
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX5
)braket
suffix:semicolon
id|sg
(braket
l_int|2
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|2
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|2
)braket
dot
id|length
op_assign
l_int|2
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX6
)braket
suffix:semicolon
id|sg
(braket
l_int|3
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|3
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|3
)braket
dot
id|length
op_assign
l_int|2
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX7
)braket
suffix:semicolon
id|sg
(braket
l_int|4
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|4
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|4
)braket
dot
id|length
op_assign
l_int|8
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_encrypt
c_func
(paren
id|tfm
comma
id|sg
comma
id|sg
comma
l_int|16
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;encrypt() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;page 1&bslash;n&quot;
)paren
suffix:semicolon
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|0
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|0
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
l_int|2
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|des_tv
(braket
id|i
)braket
dot
id|result
comma
l_int|2
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;page 2&bslash;n&quot;
)paren
suffix:semicolon
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|1
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|1
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
l_int|2
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|des_tv
(braket
id|i
)braket
dot
id|result
op_plus
l_int|2
comma
l_int|2
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;page 3&bslash;n&quot;
)paren
suffix:semicolon
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|2
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|2
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
l_int|2
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|des_tv
(braket
id|i
)braket
dot
id|result
op_plus
l_int|4
comma
l_int|2
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;page 4&bslash;n&quot;
)paren
suffix:semicolon
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|3
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|3
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
l_int|2
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|des_tv
(braket
id|i
)braket
dot
id|result
op_plus
l_int|6
comma
l_int|2
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;page 5&bslash;n&quot;
)paren
suffix:semicolon
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|4
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|4
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
l_int|8
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|des_tv
(braket
id|i
)braket
dot
id|result
op_plus
l_int|8
comma
l_int|8
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting des ecb encryption chunking scenario D&bslash;n&quot;
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * Scenario D, torture test, one byte per frag.&n;&t; */
id|i
op_assign
l_int|7
suffix:semicolon
id|key
op_assign
id|des_tv
(braket
id|i
)braket
dot
id|key
suffix:semicolon
id|tfm-&gt;crt_flags
op_assign
l_int|0
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_setkey
c_func
(paren
id|tfm
comma
id|key
comma
l_int|8
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;setkey() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
multiline_comment|/* setup the dummy buffer first */
id|memset
c_func
(paren
id|xbuf
comma
l_int|0
comma
id|XBUFSIZE
)paren
suffix:semicolon
id|xbuf
(braket
id|IDX1
)braket
op_assign
id|des_tv
(braket
id|i
)braket
dot
id|plaintext
(braket
l_int|0
)braket
suffix:semicolon
id|xbuf
(braket
id|IDX2
)braket
op_assign
id|des_tv
(braket
id|i
)braket
dot
id|plaintext
(braket
l_int|1
)braket
suffix:semicolon
id|xbuf
(braket
id|IDX3
)braket
op_assign
id|des_tv
(braket
id|i
)braket
dot
id|plaintext
(braket
l_int|2
)braket
suffix:semicolon
id|xbuf
(braket
id|IDX4
)braket
op_assign
id|des_tv
(braket
id|i
)braket
dot
id|plaintext
(braket
l_int|3
)braket
suffix:semicolon
id|xbuf
(braket
id|IDX5
)braket
op_assign
id|des_tv
(braket
id|i
)braket
dot
id|plaintext
(braket
l_int|4
)braket
suffix:semicolon
id|xbuf
(braket
id|IDX6
)braket
op_assign
id|des_tv
(braket
id|i
)braket
dot
id|plaintext
(braket
l_int|5
)braket
suffix:semicolon
id|xbuf
(braket
id|IDX7
)braket
op_assign
id|des_tv
(braket
id|i
)braket
dot
id|plaintext
(braket
l_int|6
)braket
suffix:semicolon
id|xbuf
(braket
id|IDX8
)braket
op_assign
id|des_tv
(braket
id|i
)braket
dot
id|plaintext
(braket
l_int|7
)braket
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX1
)braket
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
l_int|1
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX2
)braket
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|length
op_assign
l_int|1
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX3
)braket
suffix:semicolon
id|sg
(braket
l_int|2
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|2
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|2
)braket
dot
id|length
op_assign
l_int|1
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX4
)braket
suffix:semicolon
id|sg
(braket
l_int|3
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|3
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|3
)braket
dot
id|length
op_assign
l_int|1
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX5
)braket
suffix:semicolon
id|sg
(braket
l_int|4
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|4
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|4
)braket
dot
id|length
op_assign
l_int|1
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX6
)braket
suffix:semicolon
id|sg
(braket
l_int|5
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|5
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|5
)braket
dot
id|length
op_assign
l_int|1
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX7
)braket
suffix:semicolon
id|sg
(braket
l_int|6
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|6
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|6
)braket
dot
id|length
op_assign
l_int|1
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX8
)braket
suffix:semicolon
id|sg
(braket
l_int|7
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|7
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|7
)braket
dot
id|length
op_assign
l_int|1
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_encrypt
c_func
(paren
id|tfm
comma
id|sg
comma
id|sg
comma
l_int|8
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;encrypt() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|8
suffix:semicolon
id|i
op_increment
)paren
id|res
(braket
id|i
)braket
op_assign
op_star
(paren
r_char
op_star
)paren
(paren
id|kmap
c_func
(paren
id|sg
(braket
id|i
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
id|i
)braket
dot
id|offset
)paren
suffix:semicolon
id|hexdump
c_func
(paren
id|res
comma
l_int|8
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|res
comma
id|des_tv
(braket
l_int|7
)braket
dot
id|result
comma
l_int|8
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting des decryption&bslash;n&quot;
)paren
suffix:semicolon
id|tsize
op_assign
r_sizeof
(paren
id|des_dec_tv_template
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tsize
OG
id|TVMEMSIZE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;template (%u) too big for tvmem (%u)&bslash;n&quot;
comma
id|tsize
comma
id|TVMEMSIZE
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|tvmem
comma
id|des_dec_tv_template
comma
id|tsize
)paren
suffix:semicolon
id|des_tv
op_assign
(paren
r_void
op_star
)paren
id|tvmem
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|DES_DEC_TEST_VECTORS
suffix:semicolon
id|i
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;test %u:&bslash;n&quot;
comma
id|i
op_plus
l_int|1
)paren
suffix:semicolon
id|key
op_assign
id|des_tv
(braket
id|i
)braket
dot
id|key
suffix:semicolon
id|tfm-&gt;crt_flags
op_assign
l_int|0
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_setkey
c_func
(paren
id|tfm
comma
id|key
comma
l_int|8
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;setkey() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|len
op_assign
id|des_tv
(braket
id|i
)braket
dot
id|len
suffix:semicolon
id|p
op_assign
id|des_tv
(braket
id|i
)braket
dot
id|plaintext
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
id|len
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_decrypt
c_func
(paren
id|tfm
comma
id|sg
comma
id|sg
comma
id|sg
(braket
l_int|0
)braket
dot
id|length
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;des_decrypt() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|0
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|0
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
id|len
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|des_tv
(braket
id|i
)braket
dot
id|result
comma
id|len
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting des ecb decryption across pages&bslash;n&quot;
)paren
suffix:semicolon
id|i
op_assign
l_int|6
suffix:semicolon
id|key
op_assign
id|des_tv
(braket
id|i
)braket
dot
id|key
suffix:semicolon
id|tfm-&gt;crt_flags
op_assign
l_int|0
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_setkey
c_func
(paren
id|tfm
comma
id|key
comma
l_int|8
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;setkey() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
multiline_comment|/* setup the dummy buffer first */
id|memset
c_func
(paren
id|xbuf
comma
l_int|0
comma
r_sizeof
(paren
id|xbuf
)paren
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|xbuf
(braket
id|IDX1
)braket
comma
id|des_tv
(braket
id|i
)braket
dot
id|plaintext
comma
l_int|8
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|xbuf
(braket
id|IDX2
)braket
comma
id|des_tv
(braket
id|i
)braket
dot
id|plaintext
op_plus
l_int|8
comma
l_int|8
)paren
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX1
)braket
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
l_int|8
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX2
)braket
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|length
op_assign
l_int|8
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_decrypt
c_func
(paren
id|tfm
comma
id|sg
comma
id|sg
comma
l_int|16
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;decrypt() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;page 1&bslash;n&quot;
)paren
suffix:semicolon
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|0
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|0
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
l_int|8
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|des_tv
(braket
id|i
)braket
dot
id|result
comma
l_int|8
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;page 2&bslash;n&quot;
)paren
suffix:semicolon
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|1
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|1
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
l_int|8
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|des_tv
(braket
id|i
)braket
dot
id|result
op_plus
l_int|8
comma
l_int|8
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * Scenario E:&n;&t; * &n;&t; *  F1   F2      F3&n;&t; *  [3]  [5 + 7] [1]&n;&t; *&n;&t; */
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting des ecb decryption chunking scenario E&bslash;n&quot;
)paren
suffix:semicolon
id|i
op_assign
l_int|2
suffix:semicolon
id|key
op_assign
id|des_tv
(braket
id|i
)braket
dot
id|key
suffix:semicolon
id|tfm-&gt;crt_flags
op_assign
l_int|0
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_setkey
c_func
(paren
id|tfm
comma
id|key
comma
l_int|8
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;setkey() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
multiline_comment|/* setup the dummy buffer first */
id|memset
c_func
(paren
id|xbuf
comma
l_int|0
comma
r_sizeof
(paren
id|xbuf
)paren
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|xbuf
(braket
id|IDX1
)braket
comma
id|des_tv
(braket
id|i
)braket
dot
id|plaintext
comma
l_int|3
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|xbuf
(braket
id|IDX2
)braket
comma
id|des_tv
(braket
id|i
)braket
dot
id|plaintext
op_plus
l_int|3
comma
l_int|12
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|xbuf
(braket
id|IDX3
)braket
comma
id|des_tv
(braket
id|i
)braket
dot
id|plaintext
op_plus
l_int|15
comma
l_int|1
)paren
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX1
)braket
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
l_int|3
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX2
)braket
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|length
op_assign
l_int|12
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX3
)braket
suffix:semicolon
id|sg
(braket
l_int|2
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|2
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|2
)braket
dot
id|length
op_assign
l_int|1
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_decrypt
c_func
(paren
id|tfm
comma
id|sg
comma
id|sg
comma
l_int|16
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;decrypt() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;page 1&bslash;n&quot;
)paren
suffix:semicolon
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|0
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|0
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
l_int|3
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|des_tv
(braket
id|i
)braket
dot
id|result
comma
l_int|3
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;page 2&bslash;n&quot;
)paren
suffix:semicolon
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|1
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|1
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
l_int|12
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|des_tv
(braket
id|i
)braket
dot
id|result
op_plus
l_int|3
comma
l_int|12
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;page 3&bslash;n&quot;
)paren
suffix:semicolon
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|2
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|2
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
l_int|1
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|des_tv
(braket
id|i
)braket
dot
id|result
op_plus
l_int|15
comma
l_int|1
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
id|crypto_free_tfm
c_func
(paren
id|tfm
)paren
suffix:semicolon
id|tfm
op_assign
id|crypto_alloc_tfm
c_func
(paren
l_string|&quot;des&quot;
comma
id|CRYPTO_TFM_MODE_CBC
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tfm
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;failed to load transform for des cbc&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting des cbc encryption&bslash;n&quot;
)paren
suffix:semicolon
id|tsize
op_assign
r_sizeof
(paren
id|des_cbc_enc_tv_template
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tsize
OG
id|TVMEMSIZE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;template (%u) too big for tvmem (%u)&bslash;n&quot;
comma
id|tsize
comma
id|TVMEMSIZE
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|tvmem
comma
id|des_cbc_enc_tv_template
comma
id|tsize
)paren
suffix:semicolon
id|des_tv
op_assign
(paren
r_void
op_star
)paren
id|tvmem
suffix:semicolon
id|crypto_cipher_set_iv
c_func
(paren
id|tfm
comma
id|des_tv
(braket
id|i
)braket
dot
id|iv
comma
id|crypto_tfm_alg_ivsize
c_func
(paren
id|tfm
)paren
)paren
suffix:semicolon
id|crypto_cipher_get_iv
c_func
(paren
id|tfm
comma
id|res
comma
id|crypto_tfm_alg_ivsize
c_func
(paren
id|tfm
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|memcmp
c_func
(paren
id|res
comma
id|des_tv
(braket
id|i
)braket
dot
id|iv
comma
r_sizeof
(paren
id|res
)paren
)paren
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;crypto_cipher_[set|get]_iv() failed&bslash;n&quot;
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|DES_CBC_ENC_TEST_VECTORS
suffix:semicolon
id|i
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;test %u:&bslash;n&quot;
comma
id|i
op_plus
l_int|1
)paren
suffix:semicolon
id|key
op_assign
id|des_tv
(braket
id|i
)braket
dot
id|key
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_setkey
c_func
(paren
id|tfm
comma
id|key
comma
l_int|8
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;setkey() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|len
op_assign
id|des_tv
(braket
id|i
)braket
dot
id|len
suffix:semicolon
id|p
op_assign
id|des_tv
(braket
id|i
)braket
dot
id|plaintext
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
id|len
suffix:semicolon
id|crypto_cipher_set_iv
c_func
(paren
id|tfm
comma
id|des_tv
(braket
id|i
)braket
dot
id|iv
comma
id|crypto_tfm_alg_ivsize
c_func
(paren
id|tfm
)paren
)paren
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_encrypt
c_func
(paren
id|tfm
comma
id|sg
comma
id|sg
comma
id|len
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;des_cbc_encrypt() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|0
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|0
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
id|len
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|des_tv
(braket
id|i
)braket
dot
id|result
comma
id|len
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
)brace
id|crypto_free_tfm
c_func
(paren
id|tfm
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * Scenario F:&n;&t; * &n;&t; *  F1       F2      &n;&t; *  [8 + 5]  [3 + 8]&n;&t; *&n;&t; */
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting des cbc encryption chunking scenario F&bslash;n&quot;
)paren
suffix:semicolon
id|i
op_assign
l_int|4
suffix:semicolon
id|tfm
op_assign
id|crypto_alloc_tfm
c_func
(paren
l_string|&quot;des&quot;
comma
id|CRYPTO_TFM_MODE_CBC
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tfm
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;failed to load transform for CRYPTO_ALG_DES_CCB&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|tfm-&gt;crt_flags
op_assign
l_int|0
suffix:semicolon
id|key
op_assign
id|des_tv
(braket
id|i
)braket
dot
id|key
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_setkey
c_func
(paren
id|tfm
comma
id|key
comma
l_int|8
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;setkey() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
multiline_comment|/* setup the dummy buffer first */
id|memset
c_func
(paren
id|xbuf
comma
l_int|0
comma
r_sizeof
(paren
id|xbuf
)paren
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|xbuf
(braket
id|IDX1
)braket
comma
id|des_tv
(braket
id|i
)braket
dot
id|plaintext
comma
l_int|13
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|xbuf
(braket
id|IDX2
)braket
comma
id|des_tv
(braket
id|i
)braket
dot
id|plaintext
op_plus
l_int|13
comma
l_int|11
)paren
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX1
)braket
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
l_int|13
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX2
)braket
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|length
op_assign
l_int|11
suffix:semicolon
id|crypto_cipher_set_iv
c_func
(paren
id|tfm
comma
id|des_tv
(braket
id|i
)braket
dot
id|iv
comma
id|crypto_tfm_alg_ivsize
c_func
(paren
id|tfm
)paren
)paren
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_encrypt
c_func
(paren
id|tfm
comma
id|sg
comma
id|sg
comma
l_int|24
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;des_cbc_decrypt() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;page 1&bslash;n&quot;
)paren
suffix:semicolon
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|0
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|0
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
l_int|13
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|des_tv
(braket
id|i
)braket
dot
id|result
comma
l_int|13
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;page 2&bslash;n&quot;
)paren
suffix:semicolon
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|1
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|1
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
l_int|11
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|des_tv
(braket
id|i
)braket
dot
id|result
op_plus
l_int|13
comma
l_int|11
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
id|tsize
op_assign
r_sizeof
(paren
id|des_cbc_dec_tv_template
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tsize
OG
id|TVMEMSIZE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;template (%u) too big for tvmem (%u)&bslash;n&quot;
comma
id|tsize
comma
id|TVMEMSIZE
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|tvmem
comma
id|des_cbc_dec_tv_template
comma
id|tsize
)paren
suffix:semicolon
id|des_tv
op_assign
(paren
r_void
op_star
)paren
id|tvmem
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting des cbc decryption&bslash;n&quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|DES_CBC_DEC_TEST_VECTORS
suffix:semicolon
id|i
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;test %u:&bslash;n&quot;
comma
id|i
op_plus
l_int|1
)paren
suffix:semicolon
id|tfm-&gt;crt_flags
op_assign
l_int|0
suffix:semicolon
id|key
op_assign
id|des_tv
(braket
id|i
)braket
dot
id|key
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_setkey
c_func
(paren
id|tfm
comma
id|key
comma
l_int|8
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;setkey() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|len
op_assign
id|des_tv
(braket
id|i
)braket
dot
id|len
suffix:semicolon
id|p
op_assign
id|des_tv
(braket
id|i
)braket
dot
id|plaintext
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
id|len
suffix:semicolon
id|crypto_cipher_set_iv
c_func
(paren
id|tfm
comma
id|des_tv
(braket
id|i
)braket
dot
id|iv
comma
id|crypto_tfm_alg_blocksize
c_func
(paren
id|tfm
)paren
)paren
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_decrypt
c_func
(paren
id|tfm
comma
id|sg
comma
id|sg
comma
id|len
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;des_cbc_decrypt() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|hexdump
c_func
(paren
id|tfm-&gt;crt_cipher.cit_iv
comma
l_int|8
)paren
suffix:semicolon
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|0
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|0
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
id|len
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|des_tv
(braket
id|i
)braket
dot
id|result
comma
id|len
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
)brace
multiline_comment|/*&n;&t; * Scenario G:&n;&t; * &n;&t; *  F1   F2      &n;&t; *  [4]  [4]&n;&t; *&n;&t; */
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting des cbc decryption chunking scenario G&bslash;n&quot;
)paren
suffix:semicolon
id|i
op_assign
l_int|3
suffix:semicolon
id|tfm-&gt;crt_flags
op_assign
l_int|0
suffix:semicolon
id|key
op_assign
id|des_tv
(braket
id|i
)braket
dot
id|key
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_setkey
c_func
(paren
id|tfm
comma
id|key
comma
l_int|8
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;setkey() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
multiline_comment|/* setup the dummy buffer first */
id|memset
c_func
(paren
id|xbuf
comma
l_int|0
comma
r_sizeof
(paren
id|xbuf
)paren
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|xbuf
(braket
id|IDX1
)braket
comma
id|des_tv
(braket
id|i
)braket
dot
id|plaintext
comma
l_int|4
)paren
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|xbuf
(braket
id|IDX2
)braket
comma
id|des_tv
(braket
id|i
)braket
dot
id|plaintext
op_plus
l_int|4
comma
l_int|4
)paren
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX1
)braket
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
l_int|4
suffix:semicolon
id|p
op_assign
op_amp
id|xbuf
(braket
id|IDX2
)braket
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|1
)braket
dot
id|length
op_assign
l_int|4
suffix:semicolon
id|crypto_cipher_set_iv
c_func
(paren
id|tfm
comma
id|des_tv
(braket
id|i
)braket
dot
id|iv
comma
id|crypto_tfm_alg_ivsize
c_func
(paren
id|tfm
)paren
)paren
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_decrypt
c_func
(paren
id|tfm
comma
id|sg
comma
id|sg
comma
l_int|8
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;des_cbc_decrypt() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;page 1&bslash;n&quot;
)paren
suffix:semicolon
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|0
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|0
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
l_int|4
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|des_tv
(braket
id|i
)braket
dot
id|result
comma
l_int|4
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;page 2&bslash;n&quot;
)paren
suffix:semicolon
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|1
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|1
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
l_int|4
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|des_tv
(braket
id|i
)braket
dot
id|result
op_plus
l_int|4
comma
l_int|4
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
id|out
suffix:colon
id|crypto_free_tfm
c_func
(paren
id|tfm
)paren
suffix:semicolon
)brace
r_void
DECL|function|test_des3_ede
id|test_des3_ede
c_func
(paren
r_void
)paren
(brace
r_int
r_int
id|ret
comma
id|i
comma
id|len
suffix:semicolon
r_int
r_int
id|tsize
suffix:semicolon
r_char
op_star
id|p
comma
op_star
id|q
suffix:semicolon
r_struct
id|crypto_tfm
op_star
id|tfm
suffix:semicolon
r_char
op_star
id|key
suffix:semicolon
multiline_comment|/*char res[8]; */
r_struct
id|des_tv
op_star
id|des_tv
suffix:semicolon
r_struct
id|scatterlist
id|sg
(braket
l_int|8
)braket
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting des3 ede encryption&bslash;n&quot;
)paren
suffix:semicolon
id|tsize
op_assign
r_sizeof
(paren
id|des3_ede_enc_tv_template
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tsize
OG
id|TVMEMSIZE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;template (%u) too big for tvmem (%u)&bslash;n&quot;
comma
id|tsize
comma
id|TVMEMSIZE
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|tvmem
comma
id|des3_ede_enc_tv_template
comma
id|tsize
)paren
suffix:semicolon
id|des_tv
op_assign
(paren
r_void
op_star
)paren
id|tvmem
suffix:semicolon
id|tfm
op_assign
id|crypto_alloc_tfm
c_func
(paren
l_string|&quot;des3_ede&quot;
comma
id|CRYPTO_TFM_MODE_ECB
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tfm
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;failed to load transform for 3des ecb&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|DES3_EDE_ENC_TEST_VECTORS
suffix:semicolon
id|i
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;test %u:&bslash;n&quot;
comma
id|i
op_plus
l_int|1
)paren
suffix:semicolon
id|key
op_assign
id|des_tv
(braket
id|i
)braket
dot
id|key
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_setkey
c_func
(paren
id|tfm
comma
id|key
comma
l_int|24
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;setkey() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|des_tv
(braket
id|i
)braket
dot
id|fail
)paren
r_goto
id|out
suffix:semicolon
)brace
id|len
op_assign
id|des_tv
(braket
id|i
)braket
dot
id|len
suffix:semicolon
id|p
op_assign
id|des_tv
(braket
id|i
)braket
dot
id|plaintext
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
id|len
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_encrypt
c_func
(paren
id|tfm
comma
id|sg
comma
id|sg
comma
id|len
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;encrypt() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|0
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|0
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
id|len
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|des_tv
(braket
id|i
)braket
dot
id|result
comma
id|len
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting des3 ede decryption&bslash;n&quot;
)paren
suffix:semicolon
id|tsize
op_assign
r_sizeof
(paren
id|des3_ede_dec_tv_template
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tsize
OG
id|TVMEMSIZE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;template (%u) too big for tvmem (%u)&bslash;n&quot;
comma
id|tsize
comma
id|TVMEMSIZE
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|tvmem
comma
id|des3_ede_dec_tv_template
comma
id|tsize
)paren
suffix:semicolon
id|des_tv
op_assign
(paren
r_void
op_star
)paren
id|tvmem
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|DES3_EDE_DEC_TEST_VECTORS
suffix:semicolon
id|i
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;test %u:&bslash;n&quot;
comma
id|i
op_plus
l_int|1
)paren
suffix:semicolon
id|key
op_assign
id|des_tv
(braket
id|i
)braket
dot
id|key
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_setkey
c_func
(paren
id|tfm
comma
id|key
comma
l_int|24
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;setkey() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|des_tv
(braket
id|i
)braket
dot
id|fail
)paren
r_goto
id|out
suffix:semicolon
)brace
id|len
op_assign
id|des_tv
(braket
id|i
)braket
dot
id|len
suffix:semicolon
id|p
op_assign
id|des_tv
(braket
id|i
)braket
dot
id|plaintext
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
id|len
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_decrypt
c_func
(paren
id|tfm
comma
id|sg
comma
id|sg
comma
id|len
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;decrypt() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|0
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|0
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
id|len
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|des_tv
(braket
id|i
)braket
dot
id|result
comma
id|len
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
)brace
id|out
suffix:colon
id|crypto_free_tfm
c_func
(paren
id|tfm
)paren
suffix:semicolon
)brace
r_void
DECL|function|test_blowfish
id|test_blowfish
c_func
(paren
r_void
)paren
(brace
r_int
r_int
id|ret
comma
id|i
suffix:semicolon
r_int
r_int
id|tsize
suffix:semicolon
r_char
op_star
id|p
comma
op_star
id|q
suffix:semicolon
r_struct
id|crypto_tfm
op_star
id|tfm
suffix:semicolon
r_char
op_star
id|key
suffix:semicolon
r_struct
id|bf_tv
op_star
id|bf_tv
suffix:semicolon
r_struct
id|scatterlist
id|sg
(braket
l_int|1
)braket
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting blowfish encryption&bslash;n&quot;
)paren
suffix:semicolon
id|tsize
op_assign
r_sizeof
(paren
id|bf_enc_tv_template
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tsize
OG
id|TVMEMSIZE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;template (%u) too big for tvmem (%u)&bslash;n&quot;
comma
id|tsize
comma
id|TVMEMSIZE
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|tvmem
comma
id|bf_enc_tv_template
comma
id|tsize
)paren
suffix:semicolon
id|bf_tv
op_assign
(paren
r_void
op_star
)paren
id|tvmem
suffix:semicolon
id|tfm
op_assign
id|crypto_alloc_tfm
c_func
(paren
l_string|&quot;blowfish&quot;
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tfm
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;failed to load transform for blowfish (default ecb)&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|BF_ENC_TEST_VECTORS
suffix:semicolon
id|i
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;test %u (%d bit key):&bslash;n&quot;
comma
id|i
op_plus
l_int|1
comma
id|bf_tv
(braket
id|i
)braket
dot
id|keylen
op_star
l_int|8
)paren
suffix:semicolon
id|key
op_assign
id|bf_tv
(braket
id|i
)braket
dot
id|key
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_setkey
c_func
(paren
id|tfm
comma
id|key
comma
id|bf_tv
(braket
id|i
)braket
dot
id|keylen
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;setkey() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|bf_tv
(braket
id|i
)braket
dot
id|fail
)paren
r_goto
id|out
suffix:semicolon
)brace
id|p
op_assign
id|bf_tv
(braket
id|i
)braket
dot
id|plaintext
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
id|bf_tv
(braket
id|i
)braket
dot
id|plen
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_encrypt
c_func
(paren
id|tfm
comma
id|sg
comma
id|sg
comma
id|sg
(braket
l_int|0
)braket
dot
id|length
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;encrypt() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|0
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|0
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
id|bf_tv
(braket
id|i
)braket
dot
id|rlen
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|bf_tv
(braket
id|i
)braket
dot
id|result
comma
id|bf_tv
(braket
id|i
)braket
dot
id|rlen
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting blowfish decryption&bslash;n&quot;
)paren
suffix:semicolon
id|tsize
op_assign
r_sizeof
(paren
id|bf_dec_tv_template
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tsize
OG
id|TVMEMSIZE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;template (%u) too big for tvmem (%u)&bslash;n&quot;
comma
id|tsize
comma
id|TVMEMSIZE
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|tvmem
comma
id|bf_dec_tv_template
comma
id|tsize
)paren
suffix:semicolon
id|bf_tv
op_assign
(paren
r_void
op_star
)paren
id|tvmem
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|BF_DEC_TEST_VECTORS
suffix:semicolon
id|i
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;test %u (%d bit key):&bslash;n&quot;
comma
id|i
op_plus
l_int|1
comma
id|bf_tv
(braket
id|i
)braket
dot
id|keylen
op_star
l_int|8
)paren
suffix:semicolon
id|key
op_assign
id|bf_tv
(braket
id|i
)braket
dot
id|key
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_setkey
c_func
(paren
id|tfm
comma
id|key
comma
id|bf_tv
(braket
id|i
)braket
dot
id|keylen
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;setkey() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|bf_tv
(braket
id|i
)braket
dot
id|fail
)paren
r_goto
id|out
suffix:semicolon
)brace
id|p
op_assign
id|bf_tv
(braket
id|i
)braket
dot
id|plaintext
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
id|bf_tv
(braket
id|i
)braket
dot
id|plen
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_decrypt
c_func
(paren
id|tfm
comma
id|sg
comma
id|sg
comma
id|sg
(braket
l_int|0
)braket
dot
id|length
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;decrypt() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|0
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|0
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
id|bf_tv
(braket
id|i
)braket
dot
id|rlen
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|bf_tv
(braket
id|i
)braket
dot
id|result
comma
id|bf_tv
(braket
id|i
)braket
dot
id|rlen
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
)brace
id|crypto_free_tfm
c_func
(paren
id|tfm
)paren
suffix:semicolon
id|tfm
op_assign
id|crypto_alloc_tfm
c_func
(paren
l_string|&quot;blowfish&quot;
comma
id|CRYPTO_TFM_MODE_CBC
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tfm
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;failed to load transform for blowfish cbc&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting blowfish cbc encryption&bslash;n&quot;
)paren
suffix:semicolon
id|tsize
op_assign
r_sizeof
(paren
id|bf_cbc_enc_tv_template
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tsize
OG
id|TVMEMSIZE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;template (%u) too big for tvmem (%u)&bslash;n&quot;
comma
id|tsize
comma
id|TVMEMSIZE
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|tvmem
comma
id|bf_cbc_enc_tv_template
comma
id|tsize
)paren
suffix:semicolon
id|bf_tv
op_assign
(paren
r_void
op_star
)paren
id|tvmem
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|BF_CBC_ENC_TEST_VECTORS
suffix:semicolon
id|i
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;test %u (%d bit key):&bslash;n&quot;
comma
id|i
op_plus
l_int|1
comma
id|bf_tv
(braket
id|i
)braket
dot
id|keylen
op_star
l_int|8
)paren
suffix:semicolon
id|key
op_assign
id|bf_tv
(braket
id|i
)braket
dot
id|key
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_setkey
c_func
(paren
id|tfm
comma
id|key
comma
id|bf_tv
(braket
id|i
)braket
dot
id|keylen
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;setkey() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|p
op_assign
id|bf_tv
(braket
id|i
)braket
dot
id|plaintext
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
id|bf_tv
(braket
id|i
)braket
dot
id|plen
suffix:semicolon
id|crypto_cipher_set_iv
c_func
(paren
id|tfm
comma
id|bf_tv
(braket
id|i
)braket
dot
id|iv
comma
id|crypto_tfm_alg_ivsize
c_func
(paren
id|tfm
)paren
)paren
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_encrypt
c_func
(paren
id|tfm
comma
id|sg
comma
id|sg
comma
id|sg
(braket
l_int|0
)braket
dot
id|length
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;blowfish_cbc_encrypt() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|0
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|0
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
id|bf_tv
(braket
id|i
)braket
dot
id|rlen
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|bf_tv
(braket
id|i
)braket
dot
id|result
comma
id|bf_tv
(braket
id|i
)braket
dot
id|rlen
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting blowfish cbc decryption&bslash;n&quot;
)paren
suffix:semicolon
id|tsize
op_assign
r_sizeof
(paren
id|bf_cbc_dec_tv_template
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tsize
OG
id|TVMEMSIZE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;template (%u) too big for tvmem (%u)&bslash;n&quot;
comma
id|tsize
comma
id|TVMEMSIZE
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|tvmem
comma
id|bf_cbc_dec_tv_template
comma
id|tsize
)paren
suffix:semicolon
id|bf_tv
op_assign
(paren
r_void
op_star
)paren
id|tvmem
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|BF_CBC_ENC_TEST_VECTORS
suffix:semicolon
id|i
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;test %u (%d bit key):&bslash;n&quot;
comma
id|i
op_plus
l_int|1
comma
id|bf_tv
(braket
id|i
)braket
dot
id|keylen
op_star
l_int|8
)paren
suffix:semicolon
id|key
op_assign
id|bf_tv
(braket
id|i
)braket
dot
id|key
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_setkey
c_func
(paren
id|tfm
comma
id|key
comma
id|bf_tv
(braket
id|i
)braket
dot
id|keylen
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;setkey() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|p
op_assign
id|bf_tv
(braket
id|i
)braket
dot
id|plaintext
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
id|bf_tv
(braket
id|i
)braket
dot
id|plen
suffix:semicolon
id|crypto_cipher_set_iv
c_func
(paren
id|tfm
comma
id|bf_tv
(braket
id|i
)braket
dot
id|iv
comma
id|crypto_tfm_alg_ivsize
c_func
(paren
id|tfm
)paren
)paren
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_decrypt
c_func
(paren
id|tfm
comma
id|sg
comma
id|sg
comma
id|sg
(braket
l_int|0
)braket
dot
id|length
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;blowfish_cbc_decrypt() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|0
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|0
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
id|bf_tv
(braket
id|i
)braket
dot
id|rlen
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|bf_tv
(braket
id|i
)braket
dot
id|result
comma
id|bf_tv
(braket
id|i
)braket
dot
id|rlen
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
)brace
id|out
suffix:colon
id|crypto_free_tfm
c_func
(paren
id|tfm
)paren
suffix:semicolon
)brace
r_void
DECL|function|test_twofish
id|test_twofish
c_func
(paren
r_void
)paren
(brace
r_int
r_int
id|ret
comma
id|i
suffix:semicolon
r_int
r_int
id|tsize
suffix:semicolon
r_char
op_star
id|p
comma
op_star
id|q
suffix:semicolon
r_struct
id|crypto_tfm
op_star
id|tfm
suffix:semicolon
r_char
op_star
id|key
suffix:semicolon
r_struct
id|tf_tv
op_star
id|tf_tv
suffix:semicolon
r_struct
id|scatterlist
id|sg
(braket
l_int|1
)braket
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting twofish encryption&bslash;n&quot;
)paren
suffix:semicolon
id|tsize
op_assign
r_sizeof
(paren
id|tf_enc_tv_template
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tsize
OG
id|TVMEMSIZE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;template (%u) too big for tvmem (%u)&bslash;n&quot;
comma
id|tsize
comma
id|TVMEMSIZE
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|tvmem
comma
id|tf_enc_tv_template
comma
id|tsize
)paren
suffix:semicolon
id|tf_tv
op_assign
(paren
r_void
op_star
)paren
id|tvmem
suffix:semicolon
id|tfm
op_assign
id|crypto_alloc_tfm
c_func
(paren
l_string|&quot;twofish&quot;
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tfm
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;failed to load transform for blowfish (default ecb)&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|TF_ENC_TEST_VECTORS
suffix:semicolon
id|i
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;test %u (%d bit key):&bslash;n&quot;
comma
id|i
op_plus
l_int|1
comma
id|tf_tv
(braket
id|i
)braket
dot
id|keylen
op_star
l_int|8
)paren
suffix:semicolon
id|key
op_assign
id|tf_tv
(braket
id|i
)braket
dot
id|key
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_setkey
c_func
(paren
id|tfm
comma
id|key
comma
id|tf_tv
(braket
id|i
)braket
dot
id|keylen
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;setkey() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|tf_tv
(braket
id|i
)braket
dot
id|fail
)paren
r_goto
id|out
suffix:semicolon
)brace
id|p
op_assign
id|tf_tv
(braket
id|i
)braket
dot
id|plaintext
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
id|tf_tv
(braket
id|i
)braket
dot
id|plen
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_encrypt
c_func
(paren
id|tfm
comma
id|sg
comma
id|sg
comma
id|sg
(braket
l_int|0
)braket
dot
id|length
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;encrypt() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|0
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|0
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
id|tf_tv
(braket
id|i
)braket
dot
id|rlen
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|tf_tv
(braket
id|i
)braket
dot
id|result
comma
id|tf_tv
(braket
id|i
)braket
dot
id|rlen
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting twofish decryption&bslash;n&quot;
)paren
suffix:semicolon
id|tsize
op_assign
r_sizeof
(paren
id|tf_dec_tv_template
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tsize
OG
id|TVMEMSIZE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;template (%u) too big for tvmem (%u)&bslash;n&quot;
comma
id|tsize
comma
id|TVMEMSIZE
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|tvmem
comma
id|tf_dec_tv_template
comma
id|tsize
)paren
suffix:semicolon
id|tf_tv
op_assign
(paren
r_void
op_star
)paren
id|tvmem
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|TF_DEC_TEST_VECTORS
suffix:semicolon
id|i
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;test %u (%d bit key):&bslash;n&quot;
comma
id|i
op_plus
l_int|1
comma
id|tf_tv
(braket
id|i
)braket
dot
id|keylen
op_star
l_int|8
)paren
suffix:semicolon
id|key
op_assign
id|tf_tv
(braket
id|i
)braket
dot
id|key
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_setkey
c_func
(paren
id|tfm
comma
id|key
comma
id|tf_tv
(braket
id|i
)braket
dot
id|keylen
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;setkey() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|tf_tv
(braket
id|i
)braket
dot
id|fail
)paren
r_goto
id|out
suffix:semicolon
)brace
id|p
op_assign
id|tf_tv
(braket
id|i
)braket
dot
id|plaintext
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
id|tf_tv
(braket
id|i
)braket
dot
id|plen
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_decrypt
c_func
(paren
id|tfm
comma
id|sg
comma
id|sg
comma
id|sg
(braket
l_int|0
)braket
dot
id|length
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;decrypt() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|0
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|0
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
id|tf_tv
(braket
id|i
)braket
dot
id|rlen
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|tf_tv
(braket
id|i
)braket
dot
id|result
comma
id|tf_tv
(braket
id|i
)braket
dot
id|rlen
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
)brace
id|crypto_free_tfm
c_func
(paren
id|tfm
)paren
suffix:semicolon
id|tfm
op_assign
id|crypto_alloc_tfm
c_func
(paren
l_string|&quot;twofish&quot;
comma
id|CRYPTO_TFM_MODE_CBC
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tfm
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;failed to load transform for twofish cbc&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting twofish cbc encryption&bslash;n&quot;
)paren
suffix:semicolon
id|tsize
op_assign
r_sizeof
(paren
id|tf_cbc_enc_tv_template
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tsize
OG
id|TVMEMSIZE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;template (%u) too big for tvmem (%u)&bslash;n&quot;
comma
id|tsize
comma
id|TVMEMSIZE
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|tvmem
comma
id|tf_cbc_enc_tv_template
comma
id|tsize
)paren
suffix:semicolon
id|tf_tv
op_assign
(paren
r_void
op_star
)paren
id|tvmem
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|TF_CBC_ENC_TEST_VECTORS
suffix:semicolon
id|i
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;test %u (%d bit key):&bslash;n&quot;
comma
id|i
op_plus
l_int|1
comma
id|tf_tv
(braket
id|i
)braket
dot
id|keylen
op_star
l_int|8
)paren
suffix:semicolon
id|key
op_assign
id|tf_tv
(braket
id|i
)braket
dot
id|key
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_setkey
c_func
(paren
id|tfm
comma
id|key
comma
id|tf_tv
(braket
id|i
)braket
dot
id|keylen
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;setkey() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|p
op_assign
id|tf_tv
(braket
id|i
)braket
dot
id|plaintext
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
id|tf_tv
(braket
id|i
)braket
dot
id|plen
suffix:semicolon
id|crypto_cipher_set_iv
c_func
(paren
id|tfm
comma
id|tf_tv
(braket
id|i
)braket
dot
id|iv
comma
id|crypto_tfm_alg_ivsize
c_func
(paren
id|tfm
)paren
)paren
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_encrypt
c_func
(paren
id|tfm
comma
id|sg
comma
id|sg
comma
id|sg
(braket
l_int|0
)braket
dot
id|length
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;blowfish_cbc_encrypt() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|0
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|0
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
id|tf_tv
(braket
id|i
)braket
dot
id|rlen
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|tf_tv
(braket
id|i
)braket
dot
id|result
comma
id|tf_tv
(braket
id|i
)braket
dot
id|rlen
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting twofish cbc decryption&bslash;n&quot;
)paren
suffix:semicolon
id|tsize
op_assign
r_sizeof
(paren
id|tf_cbc_dec_tv_template
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tsize
OG
id|TVMEMSIZE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;template (%u) too big for tvmem (%u)&bslash;n&quot;
comma
id|tsize
comma
id|TVMEMSIZE
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|tvmem
comma
id|tf_cbc_dec_tv_template
comma
id|tsize
)paren
suffix:semicolon
id|tf_tv
op_assign
(paren
r_void
op_star
)paren
id|tvmem
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|TF_CBC_DEC_TEST_VECTORS
suffix:semicolon
id|i
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;test %u (%d bit key):&bslash;n&quot;
comma
id|i
op_plus
l_int|1
comma
id|tf_tv
(braket
id|i
)braket
dot
id|keylen
op_star
l_int|8
)paren
suffix:semicolon
id|key
op_assign
id|tf_tv
(braket
id|i
)braket
dot
id|key
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_setkey
c_func
(paren
id|tfm
comma
id|key
comma
id|tf_tv
(braket
id|i
)braket
dot
id|keylen
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;setkey() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|p
op_assign
id|tf_tv
(braket
id|i
)braket
dot
id|plaintext
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
id|tf_tv
(braket
id|i
)braket
dot
id|plen
suffix:semicolon
id|crypto_cipher_set_iv
c_func
(paren
id|tfm
comma
id|tf_tv
(braket
id|i
)braket
dot
id|iv
comma
id|crypto_tfm_alg_ivsize
c_func
(paren
id|tfm
)paren
)paren
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_decrypt
c_func
(paren
id|tfm
comma
id|sg
comma
id|sg
comma
id|sg
(braket
l_int|0
)braket
dot
id|length
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;blowfish_cbc_decrypt() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|0
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|0
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
id|tf_tv
(braket
id|i
)braket
dot
id|rlen
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|tf_tv
(braket
id|i
)braket
dot
id|result
comma
id|tf_tv
(braket
id|i
)braket
dot
id|rlen
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
)brace
id|out
suffix:colon
id|crypto_free_tfm
c_func
(paren
id|tfm
)paren
suffix:semicolon
)brace
r_void
DECL|function|test_serpent
id|test_serpent
c_func
(paren
r_void
)paren
(brace
r_int
r_int
id|ret
comma
id|i
comma
id|tsize
suffix:semicolon
id|u8
op_star
id|p
comma
op_star
id|q
comma
op_star
id|key
suffix:semicolon
r_struct
id|crypto_tfm
op_star
id|tfm
suffix:semicolon
r_struct
id|serpent_tv
op_star
id|serp_tv
suffix:semicolon
r_struct
id|scatterlist
id|sg
(braket
l_int|1
)braket
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting serpent encryption&bslash;n&quot;
)paren
suffix:semicolon
id|tfm
op_assign
id|crypto_alloc_tfm
c_func
(paren
l_string|&quot;serpent&quot;
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tfm
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;failed to load transform for serpent (default ecb)&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|tsize
op_assign
r_sizeof
(paren
id|serpent_enc_tv_template
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tsize
OG
id|TVMEMSIZE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;template (%u) too big for tvmem (%u)&bslash;n&quot;
comma
id|tsize
comma
id|TVMEMSIZE
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|tvmem
comma
id|serpent_enc_tv_template
comma
id|tsize
)paren
suffix:semicolon
id|serp_tv
op_assign
(paren
r_void
op_star
)paren
id|tvmem
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|SERPENT_ENC_TEST_VECTORS
suffix:semicolon
id|i
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;test %u (%d bit key):&bslash;n&quot;
comma
id|i
op_plus
l_int|1
comma
id|serp_tv
(braket
id|i
)braket
dot
id|keylen
op_star
l_int|8
)paren
suffix:semicolon
id|key
op_assign
id|serp_tv
(braket
id|i
)braket
dot
id|key
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_setkey
c_func
(paren
id|tfm
comma
id|key
comma
id|serp_tv
(braket
id|i
)braket
dot
id|keylen
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;setkey() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|serp_tv
(braket
id|i
)braket
dot
id|fail
)paren
r_goto
id|out
suffix:semicolon
)brace
id|p
op_assign
id|serp_tv
(braket
id|i
)braket
dot
id|plaintext
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
r_sizeof
(paren
id|serp_tv
(braket
id|i
)braket
dot
id|plaintext
)paren
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_encrypt
c_func
(paren
id|tfm
comma
id|sg
comma
id|sg
comma
id|sg
(braket
l_int|0
)braket
dot
id|length
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;encrypt() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|0
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|0
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
r_sizeof
(paren
id|serp_tv
(braket
id|i
)braket
dot
id|result
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|serp_tv
(braket
id|i
)braket
dot
id|result
comma
r_sizeof
(paren
id|serp_tv
(braket
id|i
)braket
dot
id|result
)paren
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting serpent decryption&bslash;n&quot;
)paren
suffix:semicolon
id|tsize
op_assign
r_sizeof
(paren
id|serpent_dec_tv_template
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tsize
OG
id|TVMEMSIZE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;template (%u) too big for tvmem (%u)&bslash;n&quot;
comma
id|tsize
comma
id|TVMEMSIZE
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|tvmem
comma
id|serpent_dec_tv_template
comma
id|tsize
)paren
suffix:semicolon
id|serp_tv
op_assign
(paren
r_void
op_star
)paren
id|tvmem
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|SERPENT_DEC_TEST_VECTORS
suffix:semicolon
id|i
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;test %u (%d bit key):&bslash;n&quot;
comma
id|i
op_plus
l_int|1
comma
id|serp_tv
(braket
id|i
)braket
dot
id|keylen
op_star
l_int|8
)paren
suffix:semicolon
id|key
op_assign
id|serp_tv
(braket
id|i
)braket
dot
id|key
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_setkey
c_func
(paren
id|tfm
comma
id|key
comma
id|serp_tv
(braket
id|i
)braket
dot
id|keylen
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;setkey() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|serp_tv
(braket
id|i
)braket
dot
id|fail
)paren
r_goto
id|out
suffix:semicolon
)brace
id|p
op_assign
id|serp_tv
(braket
id|i
)braket
dot
id|plaintext
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
r_sizeof
(paren
id|serp_tv
(braket
id|i
)braket
dot
id|plaintext
)paren
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_decrypt
c_func
(paren
id|tfm
comma
id|sg
comma
id|sg
comma
id|sg
(braket
l_int|0
)braket
dot
id|length
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;decrypt() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|0
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|0
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
r_sizeof
(paren
id|serp_tv
(braket
id|i
)braket
dot
id|result
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|serp_tv
(braket
id|i
)braket
dot
id|result
comma
r_sizeof
(paren
id|serp_tv
(braket
id|i
)braket
dot
id|result
)paren
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
)brace
id|out
suffix:colon
id|crypto_free_tfm
c_func
(paren
id|tfm
)paren
suffix:semicolon
)brace
r_void
DECL|function|test_aes
id|test_aes
c_func
(paren
r_void
)paren
(brace
r_int
r_int
id|ret
comma
id|i
suffix:semicolon
r_int
r_int
id|tsize
suffix:semicolon
r_char
op_star
id|p
comma
op_star
id|q
suffix:semicolon
r_struct
id|crypto_tfm
op_star
id|tfm
suffix:semicolon
r_char
op_star
id|key
suffix:semicolon
r_struct
id|aes_tv
op_star
id|aes_tv
suffix:semicolon
r_struct
id|scatterlist
id|sg
(braket
l_int|1
)braket
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting aes encryption&bslash;n&quot;
)paren
suffix:semicolon
id|tsize
op_assign
r_sizeof
(paren
id|aes_enc_tv_template
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tsize
OG
id|TVMEMSIZE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;template (%u) too big for tvmem (%u)&bslash;n&quot;
comma
id|tsize
comma
id|TVMEMSIZE
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|tvmem
comma
id|aes_enc_tv_template
comma
id|tsize
)paren
suffix:semicolon
id|aes_tv
op_assign
(paren
r_void
op_star
)paren
id|tvmem
suffix:semicolon
id|tfm
op_assign
id|crypto_alloc_tfm
c_func
(paren
l_string|&quot;aes&quot;
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tfm
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;failed to load transform for aes (default ecb)&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|AES_ENC_TEST_VECTORS
suffix:semicolon
id|i
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;test %u (%d bit key):&bslash;n&quot;
comma
id|i
op_plus
l_int|1
comma
id|aes_tv
(braket
id|i
)braket
dot
id|keylen
op_star
l_int|8
)paren
suffix:semicolon
id|key
op_assign
id|aes_tv
(braket
id|i
)braket
dot
id|key
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_setkey
c_func
(paren
id|tfm
comma
id|key
comma
id|aes_tv
(braket
id|i
)braket
dot
id|keylen
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;setkey() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|aes_tv
(braket
id|i
)braket
dot
id|fail
)paren
r_goto
id|out
suffix:semicolon
)brace
id|p
op_assign
id|aes_tv
(braket
id|i
)braket
dot
id|plaintext
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
id|aes_tv
(braket
id|i
)braket
dot
id|plen
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_encrypt
c_func
(paren
id|tfm
comma
id|sg
comma
id|sg
comma
id|sg
(braket
l_int|0
)braket
dot
id|length
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;encrypt() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|0
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|0
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
id|aes_tv
(braket
id|i
)braket
dot
id|rlen
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|aes_tv
(braket
id|i
)braket
dot
id|result
comma
id|aes_tv
(braket
id|i
)braket
dot
id|rlen
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting aes decryption&bslash;n&quot;
)paren
suffix:semicolon
id|tsize
op_assign
r_sizeof
(paren
id|aes_dec_tv_template
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tsize
OG
id|TVMEMSIZE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;template (%u) too big for tvmem (%u)&bslash;n&quot;
comma
id|tsize
comma
id|TVMEMSIZE
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|tvmem
comma
id|aes_dec_tv_template
comma
id|tsize
)paren
suffix:semicolon
id|aes_tv
op_assign
(paren
r_void
op_star
)paren
id|tvmem
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|AES_DEC_TEST_VECTORS
suffix:semicolon
id|i
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;test %u (%d bit key):&bslash;n&quot;
comma
id|i
op_plus
l_int|1
comma
id|aes_tv
(braket
id|i
)braket
dot
id|keylen
op_star
l_int|8
)paren
suffix:semicolon
id|key
op_assign
id|aes_tv
(braket
id|i
)braket
dot
id|key
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_setkey
c_func
(paren
id|tfm
comma
id|key
comma
id|aes_tv
(braket
id|i
)braket
dot
id|keylen
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;setkey() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|aes_tv
(braket
id|i
)braket
dot
id|fail
)paren
r_goto
id|out
suffix:semicolon
)brace
id|p
op_assign
id|aes_tv
(braket
id|i
)braket
dot
id|plaintext
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
id|aes_tv
(braket
id|i
)braket
dot
id|plen
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_decrypt
c_func
(paren
id|tfm
comma
id|sg
comma
id|sg
comma
id|sg
(braket
l_int|0
)braket
dot
id|length
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;decrypt() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|0
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|0
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
id|aes_tv
(braket
id|i
)braket
dot
id|rlen
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|aes_tv
(braket
id|i
)braket
dot
id|result
comma
id|aes_tv
(braket
id|i
)braket
dot
id|rlen
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
)brace
id|out
suffix:colon
id|crypto_free_tfm
c_func
(paren
id|tfm
)paren
suffix:semicolon
)brace
r_void
DECL|function|test_cast5
id|test_cast5
c_func
(paren
r_void
)paren
(brace
r_int
r_int
id|ret
comma
id|i
comma
id|tsize
suffix:semicolon
id|u8
op_star
id|p
comma
op_star
id|q
comma
op_star
id|key
suffix:semicolon
r_struct
id|crypto_tfm
op_star
id|tfm
suffix:semicolon
r_struct
id|cast5_tv
op_star
id|c5_tv
suffix:semicolon
r_struct
id|scatterlist
id|sg
(braket
l_int|1
)braket
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting cast5 encryption&bslash;n&quot;
)paren
suffix:semicolon
id|tfm
op_assign
id|crypto_alloc_tfm
c_func
(paren
l_string|&quot;cast5&quot;
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tfm
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;failed to load transform for cast5 (default ecb)&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|tsize
op_assign
r_sizeof
(paren
id|cast5_enc_tv_template
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tsize
OG
id|TVMEMSIZE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;template (%u) too big for tvmem (%u)&bslash;n&quot;
comma
id|tsize
comma
id|TVMEMSIZE
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|tvmem
comma
id|cast5_enc_tv_template
comma
id|tsize
)paren
suffix:semicolon
id|c5_tv
op_assign
(paren
r_void
op_star
)paren
id|tvmem
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|CAST5_ENC_TEST_VECTORS
suffix:semicolon
id|i
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;test %u (%d bit key):&bslash;n&quot;
comma
id|i
op_plus
l_int|1
comma
id|c5_tv
(braket
id|i
)braket
dot
id|keylen
op_star
l_int|8
)paren
suffix:semicolon
id|key
op_assign
id|c5_tv
(braket
id|i
)braket
dot
id|key
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_setkey
c_func
(paren
id|tfm
comma
id|key
comma
id|c5_tv
(braket
id|i
)braket
dot
id|keylen
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;setkey() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|c5_tv
(braket
id|i
)braket
dot
id|fail
)paren
r_goto
id|out
suffix:semicolon
)brace
id|p
op_assign
id|c5_tv
(braket
id|i
)braket
dot
id|plaintext
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
r_sizeof
(paren
id|c5_tv
(braket
id|i
)braket
dot
id|plaintext
)paren
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_encrypt
c_func
(paren
id|tfm
comma
id|sg
comma
id|sg
comma
id|sg
(braket
l_int|0
)braket
dot
id|length
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;encrypt() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|0
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|0
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
r_sizeof
(paren
id|c5_tv
(braket
id|i
)braket
dot
id|ciphertext
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|c5_tv
(braket
id|i
)braket
dot
id|ciphertext
comma
r_sizeof
(paren
id|c5_tv
(braket
id|i
)braket
dot
id|ciphertext
)paren
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
)brace
id|tsize
op_assign
r_sizeof
(paren
id|cast5_dec_tv_template
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tsize
OG
id|TVMEMSIZE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;template (%u) too big for tvmem (%u)&bslash;n&quot;
comma
id|tsize
comma
id|TVMEMSIZE
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|tvmem
comma
id|cast5_dec_tv_template
comma
id|tsize
)paren
suffix:semicolon
id|c5_tv
op_assign
(paren
r_void
op_star
)paren
id|tvmem
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|CAST5_DEC_TEST_VECTORS
suffix:semicolon
id|i
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;test %u (%d bit key):&bslash;n&quot;
comma
id|i
op_plus
l_int|1
comma
id|c5_tv
(braket
id|i
)braket
dot
id|keylen
op_star
l_int|8
)paren
suffix:semicolon
id|key
op_assign
id|c5_tv
(braket
id|i
)braket
dot
id|key
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_setkey
c_func
(paren
id|tfm
comma
id|key
comma
id|c5_tv
(braket
id|i
)braket
dot
id|keylen
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;setkey() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|c5_tv
(braket
id|i
)braket
dot
id|fail
)paren
r_goto
id|out
suffix:semicolon
)brace
id|p
op_assign
id|c5_tv
(braket
id|i
)braket
dot
id|plaintext
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|page
op_assign
id|virt_to_page
c_func
(paren
id|p
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|offset
op_assign
(paren
(paren
r_int
)paren
id|p
op_amp
op_complement
id|PAGE_MASK
)paren
suffix:semicolon
id|sg
(braket
l_int|0
)braket
dot
id|length
op_assign
r_sizeof
(paren
id|c5_tv
(braket
id|i
)braket
dot
id|plaintext
)paren
suffix:semicolon
id|ret
op_assign
id|crypto_cipher_decrypt
c_func
(paren
id|tfm
comma
id|sg
comma
id|sg
comma
id|sg
(braket
l_int|0
)braket
dot
id|length
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;decrypt() failed flags=%x&bslash;n&quot;
comma
id|tfm-&gt;crt_flags
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|q
op_assign
id|kmap
c_func
(paren
id|sg
(braket
l_int|0
)braket
dot
id|page
)paren
op_plus
id|sg
(braket
l_int|0
)braket
dot
id|offset
suffix:semicolon
id|hexdump
c_func
(paren
id|q
comma
r_sizeof
(paren
id|c5_tv
(braket
id|i
)braket
dot
id|ciphertext
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|q
comma
id|c5_tv
(braket
id|i
)braket
dot
id|ciphertext
comma
r_sizeof
(paren
id|c5_tv
(braket
id|i
)braket
dot
id|ciphertext
)paren
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
)paren
suffix:semicolon
)brace
id|out
suffix:colon
id|crypto_free_tfm
(paren
id|tfm
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|test_deflate
id|test_deflate
c_func
(paren
r_void
)paren
(brace
r_int
r_int
id|i
suffix:semicolon
r_char
id|result
(braket
id|COMP_BUF_SIZE
)braket
suffix:semicolon
r_struct
id|crypto_tfm
op_star
id|tfm
suffix:semicolon
r_struct
id|comp_testvec
op_star
id|tv
suffix:semicolon
r_int
r_int
id|tsize
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting deflate compression&bslash;n&quot;
)paren
suffix:semicolon
id|tsize
op_assign
r_sizeof
(paren
id|deflate_comp_tv_template
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tsize
OG
id|TVMEMSIZE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;template (%u) too big for tvmem (%u)&bslash;n&quot;
comma
id|tsize
comma
id|TVMEMSIZE
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|tvmem
comma
id|deflate_comp_tv_template
comma
id|tsize
)paren
suffix:semicolon
id|tv
op_assign
(paren
r_void
op_star
)paren
id|tvmem
suffix:semicolon
id|tfm
op_assign
id|crypto_alloc_tfm
c_func
(paren
l_string|&quot;deflate&quot;
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tfm
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;failed to load transform for deflate&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|DEFLATE_COMP_TEST_VECTORS
suffix:semicolon
id|i
op_increment
)paren
(brace
r_int
id|ilen
comma
id|ret
comma
id|dlen
op_assign
id|COMP_BUF_SIZE
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;test %u:&bslash;n&quot;
comma
id|i
op_plus
l_int|1
)paren
suffix:semicolon
id|memset
c_func
(paren
id|result
comma
l_int|0
comma
r_sizeof
(paren
id|result
)paren
)paren
suffix:semicolon
id|ilen
op_assign
id|tv
(braket
id|i
)braket
dot
id|inlen
suffix:semicolon
id|ret
op_assign
id|crypto_comp_compress
c_func
(paren
id|tfm
comma
id|tv
(braket
id|i
)braket
dot
id|input
comma
id|ilen
comma
id|result
comma
op_amp
id|dlen
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;fail: ret=%d&bslash;n&quot;
comma
id|ret
)paren
suffix:semicolon
r_continue
suffix:semicolon
)brace
id|hexdump
c_func
(paren
id|result
comma
id|dlen
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s (ratio %d:%d)&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|result
comma
id|tv
(braket
id|i
)braket
dot
id|output
comma
id|dlen
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
comma
id|ilen
comma
id|dlen
)paren
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;ntesting deflate decompression&bslash;n&quot;
)paren
suffix:semicolon
id|tsize
op_assign
r_sizeof
(paren
id|deflate_decomp_tv_template
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tsize
OG
id|TVMEMSIZE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;template (%u) too big for tvmem (%u)&bslash;n&quot;
comma
id|tsize
comma
id|TVMEMSIZE
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|tvmem
comma
id|deflate_decomp_tv_template
comma
id|tsize
)paren
suffix:semicolon
id|tv
op_assign
(paren
r_void
op_star
)paren
id|tvmem
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|DEFLATE_DECOMP_TEST_VECTORS
suffix:semicolon
id|i
op_increment
)paren
(brace
r_int
id|ilen
comma
id|ret
comma
id|dlen
op_assign
id|COMP_BUF_SIZE
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;test %u:&bslash;n&quot;
comma
id|i
op_plus
l_int|1
)paren
suffix:semicolon
id|memset
c_func
(paren
id|result
comma
l_int|0
comma
r_sizeof
(paren
id|result
)paren
)paren
suffix:semicolon
id|ilen
op_assign
id|tv
(braket
id|i
)braket
dot
id|inlen
suffix:semicolon
id|ret
op_assign
id|crypto_comp_decompress
c_func
(paren
id|tfm
comma
id|tv
(braket
id|i
)braket
dot
id|input
comma
id|ilen
comma
id|result
comma
op_amp
id|dlen
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;fail: ret=%d&bslash;n&quot;
comma
id|ret
)paren
suffix:semicolon
r_continue
suffix:semicolon
)brace
id|hexdump
c_func
(paren
id|result
comma
id|dlen
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s (ratio %d:%d)&bslash;n&quot;
comma
id|memcmp
c_func
(paren
id|result
comma
id|tv
(braket
id|i
)braket
dot
id|output
comma
id|dlen
)paren
ques
c_cond
l_string|&quot;fail&quot;
suffix:colon
l_string|&quot;pass&quot;
comma
id|ilen
comma
id|dlen
)paren
suffix:semicolon
)brace
id|out
suffix:colon
id|crypto_free_tfm
c_func
(paren
id|tfm
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|test_available
id|test_available
c_func
(paren
r_void
)paren
(brace
r_char
op_star
op_star
id|name
op_assign
id|check
suffix:semicolon
r_while
c_loop
(paren
op_star
id|name
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;alg %s &quot;
comma
op_star
id|name
)paren
suffix:semicolon
id|printk
c_func
(paren
(paren
id|crypto_alg_available
c_func
(paren
op_star
id|name
comma
l_int|0
)paren
)paren
ques
c_cond
l_string|&quot;found&bslash;n&quot;
suffix:colon
l_string|&quot;not found&bslash;n&quot;
)paren
suffix:semicolon
id|name
op_increment
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|do_test
id|do_test
c_func
(paren
r_void
)paren
(brace
r_switch
c_cond
(paren
id|mode
)paren
(brace
r_case
l_int|0
suffix:colon
id|test_md5
c_func
(paren
)paren
suffix:semicolon
id|test_sha1
c_func
(paren
)paren
suffix:semicolon
id|test_des
c_func
(paren
)paren
suffix:semicolon
id|test_des3_ede
c_func
(paren
)paren
suffix:semicolon
id|test_md4
c_func
(paren
)paren
suffix:semicolon
id|test_sha256
c_func
(paren
)paren
suffix:semicolon
id|test_blowfish
c_func
(paren
)paren
suffix:semicolon
id|test_twofish
c_func
(paren
)paren
suffix:semicolon
id|test_serpent
c_func
(paren
)paren
suffix:semicolon
id|test_aes
c_func
(paren
)paren
suffix:semicolon
id|test_sha384
c_func
(paren
)paren
suffix:semicolon
id|test_sha512
c_func
(paren
)paren
suffix:semicolon
id|test_deflate
c_func
(paren
)paren
suffix:semicolon
id|test_cast5
c_func
(paren
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_CRYPTO_HMAC
id|test_hmac_md5
c_func
(paren
)paren
suffix:semicolon
id|test_hmac_sha1
c_func
(paren
)paren
suffix:semicolon
id|test_hmac_sha256
c_func
(paren
)paren
suffix:semicolon
macro_line|#endif&t;&t;
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|test_md5
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|test_sha1
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
id|test_des
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|4
suffix:colon
id|test_des3_ede
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|5
suffix:colon
id|test_md4
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|6
suffix:colon
id|test_sha256
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|7
suffix:colon
id|test_blowfish
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|8
suffix:colon
id|test_twofish
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|9
suffix:colon
id|test_serpent
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|10
suffix:colon
id|test_aes
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|11
suffix:colon
id|test_sha384
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|12
suffix:colon
id|test_sha512
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|13
suffix:colon
id|test_deflate
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|14
suffix:colon
id|test_cast5
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#ifdef CONFIG_CRYPTO_HMAC
r_case
l_int|100
suffix:colon
id|test_hmac_md5
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|101
suffix:colon
id|test_hmac_sha1
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|102
suffix:colon
id|test_hmac_sha256
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
r_case
l_int|1000
suffix:colon
id|test_available
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
multiline_comment|/* useful for debugging */
id|printk
c_func
(paren
l_string|&quot;not testing anything&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_static
r_int
id|__init
DECL|function|init
id|init
c_func
(paren
r_void
)paren
(brace
id|tvmem
op_assign
id|kmalloc
c_func
(paren
id|TVMEMSIZE
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tvmem
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|xbuf
op_assign
id|kmalloc
c_func
(paren
id|XBUFSIZE
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|xbuf
op_eq
l_int|NULL
)paren
(brace
id|kfree
c_func
(paren
id|tvmem
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|do_test
c_func
(paren
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|xbuf
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|tvmem
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|init
id|module_init
c_func
(paren
id|init
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|mode
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
id|MODULE_DESCRIPTION
c_func
(paren
l_string|&quot;Quick &amp; dirty crypto testing module&quot;
)paren
suffix:semicolon
id|MODULE_AUTHOR
c_func
(paren
l_string|&quot;James Morris &lt;jmorris@intercode.com.au&gt;&quot;
)paren
suffix:semicolon
eof
