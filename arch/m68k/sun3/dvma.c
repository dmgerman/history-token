multiline_comment|/* dvma support routines */
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;linux/bootmem.h&gt;
macro_line|#include &lt;linux/list.h&gt;
macro_line|#include &lt;asm/page.h&gt;
macro_line|#include &lt;asm/pgtable.h&gt;
macro_line|#include &lt;asm/sun3mmu.h&gt;
macro_line|#include &lt;asm/dvma.h&gt;
DECL|variable|ptelist
r_static
r_int
r_int
id|ptelist
(braket
l_int|120
)braket
suffix:semicolon
DECL|function|dvma_page
r_inline
r_int
r_int
id|dvma_page
c_func
(paren
r_int
r_int
id|kaddr
comma
r_int
r_int
id|vaddr
)paren
(brace
r_int
r_int
id|pte
suffix:semicolon
r_int
r_int
id|j
suffix:semicolon
id|pte_t
id|ptep
suffix:semicolon
id|j
op_assign
op_star
(paren
r_volatile
r_int
r_int
op_star
)paren
id|kaddr
suffix:semicolon
op_star
(paren
r_volatile
r_int
r_int
op_star
)paren
id|kaddr
op_assign
id|j
suffix:semicolon
id|ptep
op_assign
id|__mk_pte
c_func
(paren
id|kaddr
comma
id|PAGE_KERNEL
)paren
suffix:semicolon
id|pte
op_assign
id|pte_val
c_func
(paren
id|ptep
)paren
suffix:semicolon
singleline_comment|//&t;&t;printk(&quot;dvma_remap: addr %lx -&gt; %lx pte %08lx len %x&bslash;n&quot;, 
singleline_comment|//&t;&t;       kaddr, vaddr, pte, len);
r_if
c_cond
(paren
id|ptelist
(braket
(paren
id|vaddr
op_amp
l_int|0xff000
)paren
op_rshift
id|PAGE_SHIFT
)braket
op_ne
id|pte
)paren
(brace
id|sun3_put_pte
c_func
(paren
id|vaddr
comma
id|pte
)paren
suffix:semicolon
id|ptelist
(braket
(paren
id|vaddr
op_amp
l_int|0xff000
)paren
op_rshift
id|PAGE_SHIFT
)braket
op_assign
id|pte
suffix:semicolon
)brace
r_return
(paren
id|vaddr
op_plus
(paren
id|kaddr
op_amp
op_complement
id|PAGE_MASK
)paren
)paren
suffix:semicolon
)brace
DECL|function|dvma_map_iommu
r_int
id|dvma_map_iommu
c_func
(paren
r_int
r_int
id|kaddr
comma
r_int
r_int
id|baddr
comma
r_int
id|len
)paren
(brace
r_int
r_int
id|end
suffix:semicolon
r_int
r_int
id|vaddr
suffix:semicolon
id|vaddr
op_assign
id|dvma_btov
c_func
(paren
id|baddr
)paren
suffix:semicolon
id|end
op_assign
id|vaddr
op_plus
id|len
suffix:semicolon
r_while
c_loop
(paren
id|vaddr
OL
id|end
)paren
(brace
id|dvma_page
c_func
(paren
id|kaddr
comma
id|vaddr
)paren
suffix:semicolon
id|kaddr
op_add_assign
id|PAGE_SIZE
suffix:semicolon
id|vaddr
op_add_assign
id|PAGE_SIZE
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|sun3_dvma_init
r_void
id|sun3_dvma_init
c_func
(paren
r_void
)paren
(brace
id|memset
c_func
(paren
id|ptelist
comma
l_int|0
comma
r_sizeof
(paren
id|ptelist
)paren
)paren
suffix:semicolon
)brace
eof
