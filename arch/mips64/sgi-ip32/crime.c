multiline_comment|/*&n; * This file is subject to the terms and conditions of the GNU General Public&n; * License.  See the file &quot;COPYING&quot; in the main directory of this archive&n; * for more details.&n; *&n; * Copyright (C) 2001 Keith M Wesolowski&n; */
macro_line|#include &lt;linux/types.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;asm/ip32/crime.h&gt;
macro_line|#include &lt;asm/ptrace.h&gt;
macro_line|#include &lt;asm/promlib.h&gt;
DECL|function|crime_init
r_void
id|__init
id|crime_init
(paren
r_void
)paren
(brace
id|u64
id|id
op_assign
id|crime_read_64
(paren
id|CRIME_ID
)paren
suffix:semicolon
id|u64
id|rev
op_assign
id|id
op_amp
id|CRIME_ID_REV
suffix:semicolon
id|id
op_assign
(paren
id|id
op_amp
id|CRIME_ID_IDBITS
)paren
op_rshift
l_int|4
suffix:semicolon
id|printk
(paren
l_string|&quot;CRIME id %1lx rev %ld detected at %016lx&bslash;n&quot;
comma
id|id
comma
id|rev
comma
(paren
r_int
r_int
)paren
id|CRIME_BASE
)paren
suffix:semicolon
)brace
multiline_comment|/* XXX Like on Sun, these give us various useful information to printk. */
DECL|function|crime_memerr_intr
r_void
id|crime_memerr_intr
(paren
r_int
r_int
id|irq
comma
r_void
op_star
id|dev_id
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|u64
id|memerr
op_assign
id|crime_read_64
(paren
id|CRIME_MEM_ERROR_STAT
)paren
suffix:semicolon
id|u64
id|addr
op_assign
id|crime_read_64
(paren
id|CRIME_MEM_ERROR_ADDR
)paren
suffix:semicolon
id|memerr
op_and_assign
id|CRIME_MEM_ERROR_STAT_MASK
suffix:semicolon
id|printk
(paren
l_string|&quot;CRIME memory error at physaddr 0x%08lx status %08lx&bslash;n&quot;
comma
id|addr
op_lshift
l_int|2
comma
id|memerr
)paren
suffix:semicolon
id|crime_write_64
(paren
id|CRIME_MEM_ERROR_STAT
comma
l_int|0
)paren
suffix:semicolon
)brace
DECL|function|crime_cpuerr_intr
r_void
id|crime_cpuerr_intr
(paren
r_int
r_int
id|irq
comma
r_void
op_star
id|dev_id
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|u64
id|cpuerr
op_assign
id|crime_read_64
(paren
id|CRIME_CPU_ERROR_STAT
)paren
suffix:semicolon
id|u64
id|addr
op_assign
id|crime_read_64
(paren
id|CRIME_CPU_ERROR_ADDR
)paren
suffix:semicolon
id|cpuerr
op_and_assign
id|CRIME_CPU_ERROR_MASK
suffix:semicolon
id|addr
op_lshift_assign
l_int|2UL
suffix:semicolon
id|printk
(paren
l_string|&quot;CRIME CPU interface error detected at %09lx status %08lx&bslash;n&quot;
comma
id|addr
comma
id|cpuerr
)paren
suffix:semicolon
id|crime_write_64
(paren
id|CRIME_CPU_ERROR_STAT
comma
l_int|0
)paren
suffix:semicolon
)brace
eof
