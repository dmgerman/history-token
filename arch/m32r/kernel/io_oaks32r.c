multiline_comment|/*&n; *  linux/arch/m32r/kernel/io_oaks32r.c&n; *&n; *  Typical I/O routines for OAKS32R board.&n; *&n; *  Copyright (c) 2001-2004  Hiroyuki Kondo, Hirokazu Takata,&n; *                           Hitoshi Yamamoto, Mamoru Sakugawa&n; */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;asm/m32r.h&gt;
macro_line|#include &lt;asm/page.h&gt;
macro_line|#include &lt;asm/io.h&gt;
DECL|macro|PORT2ADDR
mdefine_line|#define PORT2ADDR(port)  _port2addr(port)
DECL|function|_port2addr
r_static
r_inline
r_void
op_star
id|_port2addr
c_func
(paren
r_int
r_int
id|port
)paren
(brace
r_return
(paren
r_void
op_star
)paren
(paren
id|port
op_plus
id|NONCACHE_OFFSET
)paren
suffix:semicolon
)brace
DECL|function|_port2addr_ne
r_static
r_inline
r_void
op_star
id|_port2addr_ne
c_func
(paren
r_int
r_int
id|port
)paren
(brace
r_return
(paren
r_void
op_star
)paren
(paren
(paren
id|port
op_lshift
l_int|1
)paren
op_plus
id|NONCACHE_OFFSET
op_plus
l_int|0x02000000
)paren
suffix:semicolon
)brace
DECL|function|delay
r_static
r_inline
r_void
id|delay
c_func
(paren
r_void
)paren
(brace
id|__asm__
id|__volatile__
(paren
l_string|&quot;push r0; &bslash;n&bslash;t pop r0;&quot;
suffix:colon
suffix:colon
suffix:colon
l_string|&quot;memory&quot;
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * NIC I/O function&n; */
DECL|macro|PORT2ADDR_NE
mdefine_line|#define PORT2ADDR_NE(port)  _port2addr_ne(port)
DECL|function|_ne_inb
r_static
r_inline
r_int
r_char
id|_ne_inb
c_func
(paren
r_void
op_star
id|portp
)paren
(brace
r_return
op_star
(paren
r_volatile
r_int
r_char
op_star
)paren
(paren
id|portp
op_plus
l_int|1
)paren
suffix:semicolon
)brace
DECL|function|_ne_inw
r_static
r_inline
r_int
r_int
id|_ne_inw
c_func
(paren
r_void
op_star
id|portp
)paren
(brace
r_int
r_int
id|tmp
suffix:semicolon
id|tmp
op_assign
op_star
(paren
r_int
r_int
op_star
)paren
(paren
id|portp
)paren
op_amp
l_int|0xff
suffix:semicolon
id|tmp
op_or_assign
op_star
(paren
r_int
r_int
op_star
)paren
(paren
id|portp
op_plus
l_int|2
)paren
op_lshift
l_int|8
suffix:semicolon
r_return
id|tmp
suffix:semicolon
)brace
DECL|function|_ne_insb
r_static
r_inline
r_void
id|_ne_insb
c_func
(paren
r_void
op_star
id|portp
comma
r_void
op_star
id|addr
comma
r_int
r_int
id|count
)paren
(brace
r_int
r_char
op_star
id|buf
op_assign
id|addr
suffix:semicolon
r_while
c_loop
(paren
id|count
op_decrement
)paren
op_star
id|buf
op_increment
op_assign
op_star
(paren
r_volatile
r_int
r_char
op_star
)paren
(paren
id|portp
op_plus
l_int|1
)paren
suffix:semicolon
)brace
DECL|function|_ne_outb
r_static
r_inline
r_void
id|_ne_outb
c_func
(paren
r_int
r_char
id|b
comma
r_void
op_star
id|portp
)paren
(brace
op_star
(paren
r_volatile
r_int
r_char
op_star
)paren
(paren
id|portp
op_plus
l_int|1
)paren
op_assign
id|b
suffix:semicolon
)brace
DECL|function|_ne_outw
r_static
r_inline
r_void
id|_ne_outw
c_func
(paren
r_int
r_int
id|w
comma
r_void
op_star
id|portp
)paren
(brace
op_star
(paren
r_volatile
r_int
r_int
op_star
)paren
id|portp
op_assign
(paren
id|w
op_rshift
l_int|8
)paren
suffix:semicolon
op_star
(paren
r_volatile
r_int
r_int
op_star
)paren
(paren
id|portp
op_plus
l_int|2
)paren
op_assign
(paren
id|w
op_amp
l_int|0xff
)paren
suffix:semicolon
)brace
DECL|function|_inb
r_int
r_char
id|_inb
c_func
(paren
r_int
r_int
id|port
)paren
(brace
r_if
c_cond
(paren
id|port
op_ge
l_int|0x300
op_logical_and
id|port
OL
l_int|0x320
)paren
r_return
id|_ne_inb
c_func
(paren
id|PORT2ADDR_NE
c_func
(paren
id|port
)paren
)paren
suffix:semicolon
r_return
op_star
(paren
r_volatile
r_int
r_char
op_star
)paren
id|PORT2ADDR
c_func
(paren
id|port
)paren
suffix:semicolon
)brace
DECL|function|_inw
r_int
r_int
id|_inw
c_func
(paren
r_int
r_int
id|port
)paren
(brace
r_if
c_cond
(paren
id|port
op_ge
l_int|0x300
op_logical_and
id|port
OL
l_int|0x320
)paren
r_return
id|_ne_inw
c_func
(paren
id|PORT2ADDR_NE
c_func
(paren
id|port
)paren
)paren
suffix:semicolon
r_return
op_star
(paren
r_volatile
r_int
r_int
op_star
)paren
id|PORT2ADDR
c_func
(paren
id|port
)paren
suffix:semicolon
)brace
DECL|function|_inl
r_int
r_int
id|_inl
c_func
(paren
r_int
r_int
id|port
)paren
(brace
r_return
op_star
(paren
r_volatile
r_int
r_int
op_star
)paren
id|PORT2ADDR
c_func
(paren
id|port
)paren
suffix:semicolon
)brace
DECL|function|_inb_p
r_int
r_char
id|_inb_p
c_func
(paren
r_int
r_int
id|port
)paren
(brace
r_int
r_char
id|v
suffix:semicolon
r_if
c_cond
(paren
id|port
op_ge
l_int|0x300
op_logical_and
id|port
OL
l_int|0x320
)paren
id|v
op_assign
id|_ne_inb
c_func
(paren
id|PORT2ADDR_NE
c_func
(paren
id|port
)paren
)paren
suffix:semicolon
r_else
id|v
op_assign
op_star
(paren
r_volatile
r_int
r_char
op_star
)paren
id|PORT2ADDR
c_func
(paren
id|port
)paren
suffix:semicolon
id|delay
c_func
(paren
)paren
suffix:semicolon
r_return
(paren
id|v
)paren
suffix:semicolon
)brace
DECL|function|_inw_p
r_int
r_int
id|_inw_p
c_func
(paren
r_int
r_int
id|port
)paren
(brace
r_int
r_int
id|v
suffix:semicolon
r_if
c_cond
(paren
id|port
op_ge
l_int|0x300
op_logical_and
id|port
OL
l_int|0x320
)paren
id|v
op_assign
id|_ne_inw
c_func
(paren
id|PORT2ADDR_NE
c_func
(paren
id|port
)paren
)paren
suffix:semicolon
r_else
id|v
op_assign
op_star
(paren
r_volatile
r_int
r_int
op_star
)paren
id|PORT2ADDR
c_func
(paren
id|port
)paren
suffix:semicolon
id|delay
c_func
(paren
)paren
suffix:semicolon
r_return
(paren
id|v
)paren
suffix:semicolon
)brace
DECL|function|_inl_p
r_int
r_int
id|_inl_p
c_func
(paren
r_int
r_int
id|port
)paren
(brace
r_int
r_int
id|v
suffix:semicolon
id|v
op_assign
op_star
(paren
r_volatile
r_int
r_int
op_star
)paren
id|PORT2ADDR
c_func
(paren
id|port
)paren
suffix:semicolon
id|delay
c_func
(paren
)paren
suffix:semicolon
r_return
(paren
id|v
)paren
suffix:semicolon
)brace
DECL|function|_outb
r_void
id|_outb
c_func
(paren
r_int
r_char
id|b
comma
r_int
r_int
id|port
)paren
(brace
r_if
c_cond
(paren
id|port
op_ge
l_int|0x300
op_logical_and
id|port
OL
l_int|0x320
)paren
id|_ne_outb
c_func
(paren
id|b
comma
id|PORT2ADDR_NE
c_func
(paren
id|port
)paren
)paren
suffix:semicolon
r_else
op_star
(paren
r_volatile
r_int
r_char
op_star
)paren
id|PORT2ADDR
c_func
(paren
id|port
)paren
op_assign
id|b
suffix:semicolon
)brace
DECL|function|_outw
r_void
id|_outw
c_func
(paren
r_int
r_int
id|w
comma
r_int
r_int
id|port
)paren
(brace
r_if
c_cond
(paren
id|port
op_ge
l_int|0x300
op_logical_and
id|port
OL
l_int|0x320
)paren
id|_ne_outw
c_func
(paren
id|w
comma
id|PORT2ADDR_NE
c_func
(paren
id|port
)paren
)paren
suffix:semicolon
r_else
op_star
(paren
r_volatile
r_int
r_int
op_star
)paren
id|PORT2ADDR
c_func
(paren
id|port
)paren
op_assign
id|w
suffix:semicolon
)brace
DECL|function|_outl
r_void
id|_outl
c_func
(paren
r_int
r_int
id|l
comma
r_int
r_int
id|port
)paren
(brace
op_star
(paren
r_volatile
r_int
r_int
op_star
)paren
id|PORT2ADDR
c_func
(paren
id|port
)paren
op_assign
id|l
suffix:semicolon
)brace
DECL|function|_outb_p
r_void
id|_outb_p
c_func
(paren
r_int
r_char
id|b
comma
r_int
r_int
id|port
)paren
(brace
r_if
c_cond
(paren
id|port
op_ge
l_int|0x300
op_logical_and
id|port
OL
l_int|0x320
)paren
id|_ne_outb
c_func
(paren
id|b
comma
id|PORT2ADDR_NE
c_func
(paren
id|port
)paren
)paren
suffix:semicolon
r_else
op_star
(paren
r_volatile
r_int
r_char
op_star
)paren
id|PORT2ADDR
c_func
(paren
id|port
)paren
op_assign
id|b
suffix:semicolon
id|delay
c_func
(paren
)paren
suffix:semicolon
)brace
DECL|function|_outw_p
r_void
id|_outw_p
c_func
(paren
r_int
r_int
id|w
comma
r_int
r_int
id|port
)paren
(brace
r_if
c_cond
(paren
id|port
op_ge
l_int|0x300
op_logical_and
id|port
OL
l_int|0x320
)paren
id|_ne_outw
c_func
(paren
id|w
comma
id|PORT2ADDR_NE
c_func
(paren
id|port
)paren
)paren
suffix:semicolon
r_else
op_star
(paren
r_volatile
r_int
r_int
op_star
)paren
id|PORT2ADDR
c_func
(paren
id|port
)paren
op_assign
id|w
suffix:semicolon
id|delay
c_func
(paren
)paren
suffix:semicolon
)brace
DECL|function|_outl_p
r_void
id|_outl_p
c_func
(paren
r_int
r_int
id|l
comma
r_int
r_int
id|port
)paren
(brace
op_star
(paren
r_volatile
r_int
r_int
op_star
)paren
id|PORT2ADDR
c_func
(paren
id|port
)paren
op_assign
id|l
suffix:semicolon
id|delay
c_func
(paren
)paren
suffix:semicolon
)brace
DECL|function|_insb
r_void
id|_insb
c_func
(paren
r_int
r_int
id|port
comma
r_void
op_star
id|addr
comma
r_int
r_int
id|count
)paren
(brace
r_if
c_cond
(paren
id|port
op_ge
l_int|0x300
op_logical_and
id|port
OL
l_int|0x320
)paren
id|_ne_insb
c_func
(paren
id|PORT2ADDR_NE
c_func
(paren
id|port
)paren
comma
id|addr
comma
id|count
)paren
suffix:semicolon
r_else
(brace
r_int
r_char
op_star
id|buf
op_assign
id|addr
suffix:semicolon
r_int
r_char
op_star
id|portp
op_assign
id|PORT2ADDR
c_func
(paren
id|port
)paren
suffix:semicolon
r_while
c_loop
(paren
id|count
op_decrement
)paren
op_star
id|buf
op_increment
op_assign
op_star
(paren
r_volatile
r_int
r_char
op_star
)paren
id|portp
suffix:semicolon
)brace
)brace
DECL|function|_insw
r_void
id|_insw
c_func
(paren
r_int
r_int
id|port
comma
r_void
op_star
id|addr
comma
r_int
r_int
id|count
)paren
(brace
r_int
r_int
op_star
id|buf
op_assign
id|addr
suffix:semicolon
r_int
r_int
op_star
id|portp
suffix:semicolon
r_if
c_cond
(paren
id|port
op_ge
l_int|0x300
op_logical_and
id|port
OL
l_int|0x320
)paren
(brace
id|portp
op_assign
id|PORT2ADDR_NE
c_func
(paren
id|port
)paren
suffix:semicolon
r_while
c_loop
(paren
id|count
op_decrement
)paren
op_star
id|buf
op_increment
op_assign
id|_ne_inw
c_func
(paren
id|portp
)paren
suffix:semicolon
)brace
r_else
(brace
id|portp
op_assign
id|PORT2ADDR
c_func
(paren
id|port
)paren
suffix:semicolon
r_while
c_loop
(paren
id|count
op_decrement
)paren
op_star
id|buf
op_increment
op_assign
op_star
(paren
r_volatile
r_int
r_int
op_star
)paren
id|portp
suffix:semicolon
)brace
)brace
DECL|function|_insl
r_void
id|_insl
c_func
(paren
r_int
r_int
id|port
comma
r_void
op_star
id|addr
comma
r_int
r_int
id|count
)paren
(brace
r_int
r_int
op_star
id|buf
op_assign
id|addr
suffix:semicolon
r_int
r_int
op_star
id|portp
suffix:semicolon
id|portp
op_assign
id|PORT2ADDR
c_func
(paren
id|port
)paren
suffix:semicolon
r_while
c_loop
(paren
id|count
op_decrement
)paren
op_star
id|buf
op_increment
op_assign
op_star
(paren
r_volatile
r_int
r_int
op_star
)paren
id|portp
suffix:semicolon
)brace
DECL|function|_outsb
r_void
id|_outsb
c_func
(paren
r_int
r_int
id|port
comma
r_const
r_void
op_star
id|addr
comma
r_int
r_int
id|count
)paren
(brace
r_const
r_int
r_char
op_star
id|buf
op_assign
id|addr
suffix:semicolon
r_int
r_char
op_star
id|portp
suffix:semicolon
r_if
c_cond
(paren
id|port
op_ge
l_int|0x300
op_logical_and
id|port
OL
l_int|0x320
)paren
(brace
id|portp
op_assign
id|PORT2ADDR_NE
c_func
(paren
id|port
)paren
suffix:semicolon
r_while
c_loop
(paren
id|count
op_decrement
)paren
id|_ne_outb
c_func
(paren
op_star
id|buf
op_increment
comma
id|portp
)paren
suffix:semicolon
)brace
r_else
(brace
id|portp
op_assign
id|PORT2ADDR
c_func
(paren
id|port
)paren
suffix:semicolon
r_while
c_loop
(paren
id|count
op_decrement
)paren
op_star
(paren
r_volatile
r_int
r_char
op_star
)paren
id|portp
op_assign
op_star
id|buf
op_increment
suffix:semicolon
)brace
)brace
DECL|function|_outsw
r_void
id|_outsw
c_func
(paren
r_int
r_int
id|port
comma
r_const
r_void
op_star
id|addr
comma
r_int
r_int
id|count
)paren
(brace
r_const
r_int
r_int
op_star
id|buf
op_assign
id|addr
suffix:semicolon
r_int
r_int
op_star
id|portp
suffix:semicolon
r_if
c_cond
(paren
id|port
op_ge
l_int|0x300
op_logical_and
id|port
OL
l_int|0x320
)paren
(brace
id|portp
op_assign
id|PORT2ADDR_NE
c_func
(paren
id|port
)paren
suffix:semicolon
r_while
c_loop
(paren
id|count
op_decrement
)paren
id|_ne_outw
c_func
(paren
op_star
id|buf
op_increment
comma
id|portp
)paren
suffix:semicolon
)brace
r_else
(brace
id|portp
op_assign
id|PORT2ADDR
c_func
(paren
id|port
)paren
suffix:semicolon
r_while
c_loop
(paren
id|count
op_decrement
)paren
op_star
(paren
r_volatile
r_int
r_int
op_star
)paren
id|portp
op_assign
op_star
id|buf
op_increment
suffix:semicolon
)brace
)brace
DECL|function|_outsl
r_void
id|_outsl
c_func
(paren
r_int
r_int
id|port
comma
r_const
r_void
op_star
id|addr
comma
r_int
r_int
id|count
)paren
(brace
r_const
r_int
r_int
op_star
id|buf
op_assign
id|addr
suffix:semicolon
r_int
r_char
op_star
id|portp
suffix:semicolon
id|portp
op_assign
id|PORT2ADDR
c_func
(paren
id|port
)paren
suffix:semicolon
r_while
c_loop
(paren
id|count
op_decrement
)paren
op_star
(paren
r_volatile
r_int
r_int
op_star
)paren
id|portp
op_assign
op_star
id|buf
op_increment
suffix:semicolon
)brace
eof
