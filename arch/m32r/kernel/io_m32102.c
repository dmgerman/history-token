multiline_comment|/*&n; * Mitsubishi M32R 32102 group&n; * Typical I/O routines.&n; *&n; * Copyright (c) 2001 Hitoshi Yamamoto&n; */
multiline_comment|/* $Id$ */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;asm/page.h&gt;
macro_line|#if defined(CONFIG_PCMCIA) &amp;&amp; defined(CONFIG_M32RPCC)
macro_line|#include &lt;linux/types.h&gt;
DECL|macro|M32R_PCC_IOMAP_SIZE
mdefine_line|#define M32R_PCC_IOMAP_SIZE 0x1000
DECL|macro|M32R_PCC_IOSTART0
mdefine_line|#define M32R_PCC_IOSTART0 0x1000
DECL|macro|M32R_PCC_IOEND0
mdefine_line|#define M32R_PCC_IOEND0   (M32R_PCC_IOSTART0 + M32R_PCC_IOMAP_SIZE - 1)
DECL|macro|M32R_PCC_IOSTART1
mdefine_line|#define M32R_PCC_IOSTART1 0x2000
DECL|macro|M32R_PCC_IOEND1
mdefine_line|#define M32R_PCC_IOEND1   (M32R_PCC_IOSTART1 + M32R_PCC_IOMAP_SIZE - 1)
r_extern
r_void
id|pcc_ioread
c_func
(paren
r_int
comma
r_int
r_int
comma
r_void
op_star
comma
r_int
comma
r_int
comma
r_int
)paren
suffix:semicolon
r_extern
r_void
id|pcc_iowrite
c_func
(paren
r_int
comma
r_int
r_int
comma
r_void
op_star
comma
r_int
comma
r_int
comma
r_int
)paren
suffix:semicolon
macro_line|#endif /* CONFIG_PCMCIA &amp;&amp; CONFIG_M32RPCC */
multiline_comment|/*&n; * Function prototypes&n; */
r_int
r_char
id|ne_inb
c_func
(paren
r_int
r_int
)paren
suffix:semicolon
r_void
id|ne_outb
c_func
(paren
r_int
r_char
comma
r_int
r_int
)paren
suffix:semicolon
r_void
id|ne_insb
c_func
(paren
r_int
r_int
comma
r_void
op_star
comma
r_int
r_int
)paren
suffix:semicolon
r_void
id|ne_insw
c_func
(paren
r_int
r_int
comma
r_void
op_star
comma
r_int
r_int
)paren
suffix:semicolon
r_void
id|ne_outsb
c_func
(paren
r_int
r_int
comma
r_const
r_void
op_star
comma
r_int
r_int
)paren
suffix:semicolon
r_void
id|ne_outsw
c_func
(paren
r_int
r_int
comma
r_const
r_void
op_star
comma
r_int
r_int
)paren
suffix:semicolon
DECL|macro|PORT2ADDR
mdefine_line|#define PORT2ADDR(port)  m32102_port2addr(port)
r_static
id|__inline__
r_int
r_int
DECL|function|m32102_port2addr
id|m32102_port2addr
c_func
(paren
r_int
r_int
id|port
)paren
(brace
r_int
r_int
id|ul
suffix:semicolon
id|ul
op_assign
id|port
op_plus
id|PAGE_OFFSET
op_plus
l_int|0x20000000
suffix:semicolon
r_return
(paren
id|ul
)paren
suffix:semicolon
)brace
r_int
r_char
DECL|function|m32102_inb
id|m32102_inb
c_func
(paren
r_int
r_int
id|port
)paren
(brace
macro_line|#ifdef CONFIG_PLAT_MAPPI
r_if
c_cond
(paren
id|port
op_ge
l_int|0x300
op_logical_and
id|port
OL
l_int|0x320
)paren
(brace
r_return
id|ne_inb
c_func
(paren
id|port
)paren
suffix:semicolon
)brace
r_else
macro_line|#if defined(CONFIG_PCMCIA) &amp;&amp; defined(CONFIG_M32RPCC)
r_if
c_cond
(paren
id|port
op_ge
id|M32R_PCC_IOSTART0
op_logical_and
id|port
op_le
id|M32R_PCC_IOEND0
)paren
(brace
r_int
r_char
id|b
suffix:semicolon
id|pcc_ioread
c_func
(paren
l_int|0
comma
id|port
comma
op_amp
id|b
comma
r_sizeof
(paren
id|b
)paren
comma
l_int|1
comma
l_int|0
)paren
suffix:semicolon
r_return
id|b
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|port
op_ge
id|M32R_PCC_IOSTART1
op_logical_and
id|port
op_le
id|M32R_PCC_IOEND1
)paren
(brace
r_int
r_char
id|b
suffix:semicolon
id|pcc_ioread
c_func
(paren
l_int|1
comma
id|port
comma
op_amp
id|b
comma
r_sizeof
(paren
id|b
)paren
comma
l_int|1
comma
l_int|0
)paren
suffix:semicolon
r_return
id|b
suffix:semicolon
)brace
r_else
macro_line|#endif
macro_line|#endif /*  CONFIG_PLAT_MAPPI  */
r_return
op_star
(paren
r_int
r_char
op_star
)paren
id|PORT2ADDR
c_func
(paren
id|port
)paren
suffix:semicolon
)brace
r_int
r_int
DECL|function|m32102_inw
id|m32102_inw
c_func
(paren
r_int
r_int
id|port
)paren
(brace
macro_line|#if defined(CONFIG_PCMCIA) &amp;&amp; defined(CONFIG_M32RPCC)
r_if
c_cond
(paren
id|port
op_ge
id|M32R_PCC_IOSTART0
op_logical_and
id|port
op_le
id|M32R_PCC_IOEND0
)paren
(brace
r_int
r_int
id|w
suffix:semicolon
id|pcc_ioread
c_func
(paren
l_int|0
comma
id|port
comma
op_amp
id|w
comma
r_sizeof
(paren
id|w
)paren
comma
l_int|1
comma
l_int|0
)paren
suffix:semicolon
r_return
id|w
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|port
op_ge
id|M32R_PCC_IOSTART1
op_logical_and
id|port
op_le
id|M32R_PCC_IOEND1
)paren
(brace
r_int
r_int
id|w
suffix:semicolon
id|pcc_ioread
c_func
(paren
l_int|1
comma
id|port
comma
op_amp
id|w
comma
r_sizeof
(paren
id|w
)paren
comma
l_int|1
comma
l_int|0
)paren
suffix:semicolon
r_return
id|w
suffix:semicolon
)brace
r_else
macro_line|#endif
r_return
op_star
(paren
r_int
r_int
op_star
)paren
id|PORT2ADDR
c_func
(paren
id|port
)paren
suffix:semicolon
)brace
r_int
r_int
DECL|function|m32102_inl
id|m32102_inl
c_func
(paren
r_int
r_int
id|port
)paren
(brace
macro_line|#if defined(CONFIG_PCMCIA) &amp;&amp; defined(CONFIG_M32RPCC)
r_if
c_cond
(paren
id|port
op_ge
id|M32R_PCC_IOSTART0
op_logical_and
id|port
op_le
id|M32R_PCC_IOEND0
)paren
(brace
r_int
r_int
id|l
suffix:semicolon
id|pcc_ioread
c_func
(paren
l_int|0
comma
id|port
comma
op_amp
id|l
comma
r_sizeof
(paren
id|l
)paren
comma
l_int|1
comma
l_int|0
)paren
suffix:semicolon
r_return
id|l
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|port
op_ge
id|M32R_PCC_IOSTART1
op_logical_and
id|port
op_le
id|M32R_PCC_IOEND1
)paren
(brace
r_int
r_int
id|l
suffix:semicolon
id|pcc_ioread
c_func
(paren
l_int|1
comma
id|port
comma
op_amp
id|l
comma
r_sizeof
(paren
id|l
)paren
comma
l_int|1
comma
l_int|0
)paren
suffix:semicolon
r_return
id|l
suffix:semicolon
)brace
r_else
macro_line|#endif
r_return
op_star
(paren
r_int
r_int
op_star
)paren
id|PORT2ADDR
c_func
(paren
id|port
)paren
suffix:semicolon
)brace
r_void
DECL|function|m32102_outb
id|m32102_outb
c_func
(paren
r_int
r_char
id|b
comma
r_int
r_int
id|port
)paren
(brace
macro_line|#ifdef CONFIG_PLAT_MAPPI
r_if
c_cond
(paren
id|port
op_ge
l_int|0x300
op_logical_and
id|port
OL
l_int|0x320
)paren
(brace
id|ne_outb
c_func
(paren
id|b
comma
id|port
)paren
suffix:semicolon
)brace
r_else
macro_line|#if defined(CONFIG_PCMCIA) &amp;&amp; defined(CONFIG_M32RPCC)
r_if
c_cond
(paren
id|port
op_ge
id|M32R_PCC_IOSTART0
op_logical_and
id|port
op_le
id|M32R_PCC_IOEND0
)paren
(brace
id|pcc_iowrite
c_func
(paren
l_int|0
comma
id|port
comma
op_amp
id|b
comma
r_sizeof
(paren
id|b
)paren
comma
l_int|1
comma
l_int|0
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|port
op_ge
id|M32R_PCC_IOSTART1
op_logical_and
id|port
op_le
id|M32R_PCC_IOEND1
)paren
(brace
id|pcc_iowrite
c_func
(paren
l_int|1
comma
id|port
comma
op_amp
id|b
comma
r_sizeof
(paren
id|b
)paren
comma
l_int|1
comma
l_int|0
)paren
suffix:semicolon
)brace
r_else
macro_line|#endif
macro_line|#endif /*  CONFIG_PLAT_MAPPI  */
op_star
(paren
r_int
r_volatile
r_char
op_star
)paren
id|PORT2ADDR
c_func
(paren
id|port
)paren
op_assign
id|b
suffix:semicolon
)brace
r_void
DECL|function|m32102_outw
id|m32102_outw
c_func
(paren
r_int
r_int
id|w
comma
r_int
r_int
id|port
)paren
(brace
macro_line|#if defined(CONFIG_PCMCIA) &amp;&amp; defined(CONFIG_M32RPCC)
r_if
c_cond
(paren
id|port
op_ge
id|M32R_PCC_IOSTART0
op_logical_and
id|port
op_le
id|M32R_PCC_IOEND0
)paren
(brace
id|pcc_iowrite
c_func
(paren
l_int|0
comma
id|port
comma
op_amp
id|w
comma
r_sizeof
(paren
id|w
)paren
comma
l_int|1
comma
l_int|0
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|port
op_ge
id|M32R_PCC_IOSTART1
op_logical_and
id|port
op_le
id|M32R_PCC_IOEND1
)paren
(brace
id|pcc_iowrite
c_func
(paren
l_int|1
comma
id|port
comma
op_amp
id|w
comma
r_sizeof
(paren
id|w
)paren
comma
l_int|1
comma
l_int|0
)paren
suffix:semicolon
)brace
r_else
macro_line|#endif
op_star
(paren
r_int
r_volatile
r_int
op_star
)paren
id|PORT2ADDR
c_func
(paren
id|port
)paren
op_assign
id|w
suffix:semicolon
)brace
r_void
DECL|function|m32102_outl
id|m32102_outl
c_func
(paren
r_int
r_int
id|l
comma
r_int
r_int
id|port
)paren
(brace
macro_line|#if defined(CONFIG_PCMCIA) &amp;&amp; defined(CONFIG_M32RPCC)
r_if
c_cond
(paren
id|port
op_ge
id|M32R_PCC_IOSTART0
op_logical_and
id|port
op_le
id|M32R_PCC_IOEND0
)paren
(brace
id|pcc_iowrite
c_func
(paren
l_int|0
comma
id|port
comma
op_amp
id|l
comma
r_sizeof
(paren
id|l
)paren
comma
l_int|1
comma
l_int|0
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|port
op_ge
id|M32R_PCC_IOSTART1
op_logical_and
id|port
op_le
id|M32R_PCC_IOEND1
)paren
(brace
id|pcc_iowrite
c_func
(paren
l_int|1
comma
id|port
comma
op_amp
id|l
comma
r_sizeof
(paren
id|l
)paren
comma
l_int|1
comma
l_int|0
)paren
suffix:semicolon
)brace
r_else
macro_line|#endif
op_star
(paren
r_int
r_volatile
r_int
op_star
)paren
id|PORT2ADDR
c_func
(paren
id|port
)paren
op_assign
id|l
suffix:semicolon
)brace
r_void
DECL|function|m32102_insb
id|m32102_insb
c_func
(paren
r_int
r_int
id|port
comma
r_void
op_star
id|addr
comma
r_int
r_int
id|count
)paren
(brace
macro_line|#if defined(CONFIG_PCMCIA) &amp;&amp; defined(CONFIG_M32RPCC)
r_if
c_cond
(paren
id|port
op_ge
id|M32R_PCC_IOSTART0
op_logical_and
id|port
op_le
id|M32R_PCC_IOEND0
)paren
(brace
id|pcc_ioread
c_func
(paren
l_int|0
comma
id|port
comma
(paren
r_void
op_star
)paren
id|addr
comma
r_sizeof
(paren
r_int
r_char
)paren
comma
id|count
comma
l_int|1
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|port
op_ge
id|M32R_PCC_IOSTART1
op_logical_and
id|port
op_le
id|M32R_PCC_IOEND1
)paren
(brace
id|pcc_ioread
c_func
(paren
l_int|1
comma
id|port
comma
(paren
r_void
op_star
)paren
id|addr
comma
r_sizeof
(paren
r_int
r_char
)paren
comma
id|count
comma
l_int|1
)paren
suffix:semicolon
)brace
r_else
macro_line|#endif
r_while
c_loop
(paren
id|count
op_decrement
)paren
(brace
op_star
(paren
r_int
r_char
op_star
)paren
id|addr
op_assign
op_star
(paren
r_int
r_volatile
r_char
op_star
)paren
id|PORT2ADDR
c_func
(paren
id|port
)paren
suffix:semicolon
id|addr
op_add_assign
l_int|1
suffix:semicolon
)brace
)brace
r_void
DECL|function|m32102_insw
id|m32102_insw
c_func
(paren
r_int
r_int
id|port
comma
r_void
op_star
id|addr
comma
r_int
r_int
id|count
)paren
(brace
macro_line|#if defined(CONFIG_PCMCIA) &amp;&amp; defined(CONFIG_M32RPCC)
r_if
c_cond
(paren
id|port
op_ge
id|M32R_PCC_IOSTART0
op_logical_and
id|port
op_le
id|M32R_PCC_IOEND0
)paren
(brace
id|pcc_ioread
c_func
(paren
l_int|0
comma
id|port
comma
(paren
r_void
op_star
)paren
id|addr
comma
r_sizeof
(paren
r_int
r_int
)paren
comma
id|count
comma
l_int|1
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|port
op_ge
id|M32R_PCC_IOSTART1
op_logical_and
id|port
op_le
id|M32R_PCC_IOEND1
)paren
(brace
id|pcc_ioread
c_func
(paren
l_int|1
comma
id|port
comma
(paren
r_void
op_star
)paren
id|addr
comma
r_sizeof
(paren
r_int
r_int
)paren
comma
id|count
comma
l_int|1
)paren
suffix:semicolon
)brace
r_else
macro_line|#endif
r_while
c_loop
(paren
id|count
op_decrement
)paren
(brace
op_star
(paren
r_int
r_int
op_star
)paren
id|addr
op_assign
op_star
(paren
r_int
r_volatile
r_int
op_star
)paren
id|PORT2ADDR
c_func
(paren
id|port
)paren
suffix:semicolon
id|addr
op_add_assign
l_int|2
suffix:semicolon
)brace
)brace
r_void
DECL|function|m32102_outsb
id|m32102_outsb
c_func
(paren
r_int
r_int
id|port
comma
r_const
r_void
op_star
id|addr
comma
r_int
r_int
id|count
)paren
(brace
macro_line|#if defined(CONFIG_PCMCIA) &amp;&amp; defined(CONFIG_M32RPCC)
r_if
c_cond
(paren
id|port
op_ge
id|M32R_PCC_IOSTART0
op_logical_and
id|port
op_le
id|M32R_PCC_IOEND0
)paren
(brace
id|pcc_iowrite
c_func
(paren
l_int|0
comma
id|port
comma
(paren
r_void
op_star
)paren
id|addr
comma
r_sizeof
(paren
r_int
r_char
)paren
comma
id|count
comma
l_int|1
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|port
op_ge
id|M32R_PCC_IOSTART1
op_logical_and
id|port
op_le
id|M32R_PCC_IOEND1
)paren
(brace
id|pcc_iowrite
c_func
(paren
l_int|1
comma
id|port
comma
(paren
r_void
op_star
)paren
id|addr
comma
r_sizeof
(paren
r_int
r_char
)paren
comma
id|count
comma
l_int|1
)paren
suffix:semicolon
)brace
r_else
macro_line|#endif
r_while
c_loop
(paren
id|count
op_decrement
)paren
(brace
op_star
(paren
r_int
r_volatile
r_char
op_star
)paren
id|PORT2ADDR
c_func
(paren
id|port
)paren
op_assign
op_star
(paren
r_int
r_char
op_star
)paren
id|addr
suffix:semicolon
id|addr
op_add_assign
l_int|1
suffix:semicolon
)brace
)brace
r_void
DECL|function|m32102_outsw
id|m32102_outsw
c_func
(paren
r_int
r_int
id|port
comma
r_const
r_void
op_star
id|addr
comma
r_int
r_int
id|count
)paren
(brace
macro_line|#if defined(CONFIG_PCMCIA) &amp;&amp; defined(CONFIG_M32RPCC)
r_if
c_cond
(paren
id|port
op_ge
id|M32R_PCC_IOSTART0
op_logical_and
id|port
op_le
id|M32R_PCC_IOEND0
)paren
(brace
id|pcc_iowrite
c_func
(paren
l_int|0
comma
id|port
comma
(paren
r_void
op_star
)paren
id|addr
comma
r_sizeof
(paren
r_int
r_int
)paren
comma
id|count
comma
l_int|1
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|port
op_ge
id|M32R_PCC_IOSTART1
op_logical_and
id|port
op_le
id|M32R_PCC_IOEND1
)paren
(brace
id|pcc_iowrite
c_func
(paren
l_int|1
comma
id|port
comma
(paren
r_void
op_star
)paren
id|addr
comma
r_sizeof
(paren
r_int
r_int
)paren
comma
id|count
comma
l_int|1
)paren
suffix:semicolon
)brace
r_else
macro_line|#endif
r_while
c_loop
(paren
id|count
op_decrement
)paren
(brace
op_star
(paren
r_int
r_volatile
r_int
op_star
)paren
id|PORT2ADDR
c_func
(paren
id|port
)paren
op_assign
op_star
(paren
r_int
r_int
op_star
)paren
id|addr
suffix:semicolon
id|addr
op_add_assign
l_int|2
suffix:semicolon
)brace
)brace
macro_line|#ifdef CONFIG_PLAT_MAPPI
r_int
r_char
DECL|function|ne_inb
id|ne_inb
c_func
(paren
r_int
r_int
id|port
)paren
(brace
r_int
r_int
id|tmp
suffix:semicolon
id|port
op_lshift_assign
l_int|1
suffix:semicolon
id|port
op_add_assign
id|PAGE_OFFSET
op_plus
l_int|0x20000000
op_plus
l_int|0x0c000000
suffix:semicolon
id|tmp
op_assign
op_star
(paren
r_int
r_int
op_star
)paren
id|port
suffix:semicolon
r_return
(paren
r_int
r_char
)paren
id|tmp
suffix:semicolon
)brace
r_void
DECL|function|ne_outb
id|ne_outb
c_func
(paren
r_int
r_char
id|b
comma
r_int
r_int
id|port
)paren
(brace
id|port
op_lshift_assign
l_int|1
suffix:semicolon
id|port
op_add_assign
id|PAGE_OFFSET
op_plus
l_int|0x20000000
op_plus
l_int|0x0c000000
suffix:semicolon
op_star
(paren
r_int
r_volatile
r_int
op_star
)paren
id|port
op_assign
(paren
r_int
r_int
)paren
id|b
suffix:semicolon
)brace
r_void
DECL|function|ne_insb
id|ne_insb
c_func
(paren
r_int
r_int
id|port
comma
r_void
op_star
id|addr
comma
r_int
r_int
id|count
)paren
(brace
r_int
r_int
id|tmp
suffix:semicolon
id|port
op_lshift_assign
l_int|1
suffix:semicolon
id|port
op_add_assign
id|PAGE_OFFSET
op_plus
l_int|0x20000000
op_plus
l_int|0x0c000000
suffix:semicolon
id|tmp
op_assign
op_star
(paren
r_int
r_int
op_star
)paren
id|port
suffix:semicolon
r_while
c_loop
(paren
id|count
op_decrement
)paren
(brace
op_star
(paren
r_int
r_char
op_star
)paren
id|addr
op_assign
op_star
(paren
r_int
r_volatile
r_char
op_star
)paren
id|port
suffix:semicolon
id|addr
op_add_assign
l_int|1
suffix:semicolon
)brace
)brace
r_void
DECL|function|ne_insw
id|ne_insw
c_func
(paren
r_int
r_int
id|port
comma
r_void
op_star
id|addr
comma
r_int
r_int
id|count
)paren
(brace
r_int
r_int
id|tmp
suffix:semicolon
id|port
op_lshift_assign
l_int|1
suffix:semicolon
id|port
op_add_assign
id|PAGE_OFFSET
op_plus
l_int|0x20000000
op_plus
l_int|0x0c000000
suffix:semicolon
r_while
c_loop
(paren
id|count
op_decrement
)paren
(brace
id|tmp
op_assign
op_star
(paren
r_int
r_volatile
r_int
op_star
)paren
id|port
suffix:semicolon
op_star
(paren
r_int
r_int
op_star
)paren
id|addr
op_assign
(paren
id|tmp
op_rshift
l_int|8
)paren
op_or
(paren
id|tmp
op_lshift
l_int|8
)paren
suffix:semicolon
id|addr
op_add_assign
l_int|2
suffix:semicolon
)brace
)brace
r_void
DECL|function|ne_outsb
id|ne_outsb
c_func
(paren
r_int
r_int
id|port
comma
r_const
r_void
op_star
id|addr
comma
r_int
r_int
id|count
)paren
(brace
id|port
op_lshift_assign
l_int|1
suffix:semicolon
id|port
op_add_assign
id|PAGE_OFFSET
op_plus
l_int|0x20000000
op_plus
l_int|0x0c000000
suffix:semicolon
r_while
c_loop
(paren
id|count
op_decrement
)paren
(brace
op_star
(paren
r_int
r_volatile
r_int
op_star
)paren
id|port
op_assign
op_star
(paren
r_int
r_char
op_star
)paren
id|addr
suffix:semicolon
id|addr
op_add_assign
l_int|1
suffix:semicolon
)brace
)brace
r_void
DECL|function|ne_outsw
id|ne_outsw
c_func
(paren
r_int
r_int
id|port
comma
r_const
r_void
op_star
id|addr
comma
r_int
r_int
id|count
)paren
(brace
r_int
r_int
id|tmp
suffix:semicolon
id|port
op_lshift_assign
l_int|1
suffix:semicolon
id|port
op_add_assign
id|PAGE_OFFSET
op_plus
l_int|0x20000000
op_plus
l_int|0x0c000000
suffix:semicolon
r_while
c_loop
(paren
id|count
op_decrement
)paren
(brace
id|tmp
op_assign
op_star
(paren
r_int
r_int
op_star
)paren
id|addr
suffix:semicolon
op_star
(paren
r_int
r_volatile
r_int
op_star
)paren
id|port
op_assign
(paren
id|tmp
op_rshift
l_int|8
)paren
op_or
(paren
id|tmp
op_lshift
l_int|8
)paren
suffix:semicolon
id|addr
op_add_assign
l_int|2
suffix:semicolon
)brace
)brace
macro_line|#endif /*  CONFIG_PLAT_MAPPI  */
eof
