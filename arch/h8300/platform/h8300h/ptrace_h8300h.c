multiline_comment|/*&n; *  linux/arch/h8300/platform/h8300h/ptrace_h8300h.c&n; *    ptrace cpu depend helper functions&n; *&n; *  Yoshinori Sato &lt;ysato@users.sourceforge.jp&gt;&n; *&n; * This file is subject to the terms and conditions of the GNU General&n; * Public License.  See the file COPYING in the main directory of&n; * this archive for more details.&n; */
macro_line|#include &lt;linux/linkage.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;asm/ptrace.h&gt;
DECL|macro|CCR_MASK
mdefine_line|#define CCR_MASK 0x6f    /* mode/imask not set */
DECL|macro|BREAKINST
mdefine_line|#define BREAKINST 0x5730 /* trapa #3 */
multiline_comment|/* Mapping from PT_xxx to the stack offset at which the register is&n;   saved.  Notice that usp has no stack-slot and needs to be treated&n;   specially (see get_reg/put_reg below). */
DECL|variable|h8300_register_offset
r_static
r_const
r_int
id|h8300_register_offset
(braket
)braket
op_assign
(brace
id|PT_REG
c_func
(paren
id|er1
)paren
comma
id|PT_REG
c_func
(paren
id|er2
)paren
comma
id|PT_REG
c_func
(paren
id|er3
)paren
comma
id|PT_REG
c_func
(paren
id|er4
)paren
comma
id|PT_REG
c_func
(paren
id|er5
)paren
comma
id|PT_REG
c_func
(paren
id|er6
)paren
comma
id|PT_REG
c_func
(paren
id|er0
)paren
comma
id|PT_REG
c_func
(paren
id|orig_er0
)paren
comma
id|PT_REG
c_func
(paren
id|ccr
)paren
comma
id|PT_REG
c_func
(paren
id|pc
)paren
)brace
suffix:semicolon
multiline_comment|/* read register */
DECL|function|h8300_get_reg
r_int
id|h8300_get_reg
c_func
(paren
r_struct
id|task_struct
op_star
id|task
comma
r_int
id|regno
)paren
(brace
r_switch
c_cond
(paren
id|regno
)paren
(brace
r_case
id|PT_USP
suffix:colon
r_return
id|task-&gt;thread.usp
op_plus
r_sizeof
(paren
r_int
)paren
op_star
l_int|2
suffix:semicolon
r_case
id|PT_CCR
suffix:colon
r_return
op_star
(paren
r_int
r_int
op_star
)paren
(paren
id|task-&gt;thread.esp0
op_plus
id|h8300_register_offset
(braket
id|regno
)braket
)paren
suffix:semicolon
r_default
suffix:colon
r_return
op_star
(paren
r_int
r_int
op_star
)paren
(paren
id|task-&gt;thread.esp0
op_plus
id|h8300_register_offset
(braket
id|regno
)braket
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/* write register */
DECL|function|h8300_put_reg
r_int
id|h8300_put_reg
c_func
(paren
r_struct
id|task_struct
op_star
id|task
comma
r_int
id|regno
comma
r_int
r_int
id|data
)paren
(brace
r_int
r_int
id|oldccr
suffix:semicolon
r_switch
c_cond
(paren
id|regno
)paren
(brace
r_case
id|PT_USP
suffix:colon
id|task-&gt;thread.usp
op_assign
id|data
op_minus
r_sizeof
(paren
r_int
)paren
op_star
l_int|2
suffix:semicolon
r_case
id|PT_CCR
suffix:colon
id|oldccr
op_assign
op_star
(paren
r_int
r_int
op_star
)paren
(paren
id|task-&gt;thread.esp0
op_plus
id|h8300_register_offset
(braket
id|regno
)braket
)paren
suffix:semicolon
id|oldccr
op_and_assign
op_complement
id|CCR_MASK
suffix:semicolon
id|data
op_and_assign
id|CCR_MASK
suffix:semicolon
id|data
op_or_assign
id|oldccr
suffix:semicolon
op_star
(paren
r_int
r_int
op_star
)paren
(paren
id|task-&gt;thread.esp0
op_plus
id|h8300_register_offset
(braket
id|regno
)braket
)paren
op_assign
id|data
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
op_star
(paren
r_int
r_int
op_star
)paren
(paren
id|task-&gt;thread.esp0
op_plus
id|h8300_register_offset
(braket
id|regno
)braket
)paren
op_assign
id|data
suffix:semicolon
r_break
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* disable singlestep */
DECL|function|h8300_disable_trace
r_void
id|h8300_disable_trace
c_func
(paren
r_struct
id|task_struct
op_star
id|child
)paren
(brace
r_if
c_cond
(paren
(paren
r_int
)paren
id|child-&gt;thread.breakinfo.addr
op_ne
op_minus
l_int|1L
)paren
(brace
op_star
id|child-&gt;thread.breakinfo.addr
op_assign
id|child-&gt;thread.breakinfo.inst
suffix:semicolon
id|child-&gt;thread.breakinfo.addr
op_assign
(paren
r_int
r_int
op_star
)paren
op_minus
l_int|1L
suffix:semicolon
)brace
)brace
multiline_comment|/* calculate next pc */
DECL|enum|jump_type
DECL|enumerator|none
r_enum
id|jump_type
(brace
id|none
comma
multiline_comment|/* normal instruction */
DECL|enumerator|jabs
id|jabs
comma
multiline_comment|/* absolute address jump */
DECL|enumerator|ind
id|ind
comma
multiline_comment|/* indirect address jump */
DECL|enumerator|ret
id|ret
comma
multiline_comment|/* return to subrutine */
DECL|enumerator|reg
id|reg
comma
multiline_comment|/* register indexed jump */
DECL|enumerator|relb
id|relb
comma
multiline_comment|/* pc relative jump (byte offset) */
DECL|enumerator|relw
id|relw
comma
multiline_comment|/* pc relative jump (word offset) */
)brace
suffix:semicolon
multiline_comment|/* opcode decode table define&n;   ptn: opcode pattern&n;   msk: opcode bitmask&n;   len: instruction length (&lt;0 next table index)&n;   jmp: jump operation mode */
DECL|struct|optable
r_struct
id|optable
(brace
DECL|member|bitpattern
r_int
r_char
id|bitpattern
suffix:semicolon
DECL|member|bitmask
r_int
r_char
id|bitmask
suffix:semicolon
DECL|member|length
r_int
r_char
id|length
suffix:semicolon
DECL|member|type
r_int
r_char
id|type
suffix:semicolon
)brace
id|__attribute__
c_func
(paren
(paren
id|aligned
c_func
(paren
l_int|1
)paren
comma
id|packed
)paren
)paren
suffix:semicolon
DECL|macro|OPTABLE
mdefine_line|#define OPTABLE(ptn,msk,len,jmp)   &bslash;&n;        {                          &bslash;&n;&t;&t;.bitpattern = ptn, &bslash;&n;&t;&t;.bitmask    = msk, &bslash;&n;&t;&t;.length&t;    = len, &bslash;&n;&t;&t;.type       = jmp, &bslash;&n;&t;}
DECL|variable|optable_0
r_const
r_static
r_struct
id|optable
id|optable_0
(braket
)braket
op_assign
(brace
id|OPTABLE
c_func
(paren
l_int|0x00
comma
l_int|0xff
comma
l_int|1
comma
id|none
)paren
comma
multiline_comment|/* 0x00 */
id|OPTABLE
c_func
(paren
l_int|0x01
comma
l_int|0xff
comma
op_minus
l_int|1
comma
id|none
)paren
comma
multiline_comment|/* 0x01 */
id|OPTABLE
c_func
(paren
l_int|0x02
comma
l_int|0xfe
comma
l_int|1
comma
id|none
)paren
comma
multiline_comment|/* 0x02-0x03 */
id|OPTABLE
c_func
(paren
l_int|0x04
comma
l_int|0xee
comma
l_int|1
comma
id|none
)paren
comma
multiline_comment|/* 0x04-0x05/0x14-0x15 */
id|OPTABLE
c_func
(paren
l_int|0x06
comma
l_int|0xfe
comma
l_int|1
comma
id|none
)paren
comma
multiline_comment|/* 0x06-0x07 */
id|OPTABLE
c_func
(paren
l_int|0x08
comma
l_int|0xea
comma
l_int|1
comma
id|none
)paren
comma
multiline_comment|/* 0x08-0x09/0x0c-0x0d/0x18-0x19/0x1c-0x1d */
id|OPTABLE
c_func
(paren
l_int|0x0a
comma
l_int|0xee
comma
l_int|1
comma
id|none
)paren
comma
multiline_comment|/* 0x0a-0x0b/0x1a-0x1b */
id|OPTABLE
c_func
(paren
l_int|0x0e
comma
l_int|0xee
comma
l_int|1
comma
id|none
)paren
comma
multiline_comment|/* 0x0e-0x0f/0x1e-0x1f */
id|OPTABLE
c_func
(paren
l_int|0x10
comma
l_int|0xfc
comma
l_int|1
comma
id|none
)paren
comma
multiline_comment|/* 0x10-0x13 */
id|OPTABLE
c_func
(paren
l_int|0x16
comma
l_int|0xfe
comma
l_int|1
comma
id|none
)paren
comma
multiline_comment|/* 0x16-0x17 */
id|OPTABLE
c_func
(paren
l_int|0x20
comma
l_int|0xe0
comma
l_int|1
comma
id|none
)paren
comma
multiline_comment|/* 0x20-0x3f */
id|OPTABLE
c_func
(paren
l_int|0x40
comma
l_int|0xf0
comma
l_int|1
comma
id|relb
)paren
comma
multiline_comment|/* 0x40-0x4f */
id|OPTABLE
c_func
(paren
l_int|0x50
comma
l_int|0xfc
comma
l_int|1
comma
id|none
)paren
comma
multiline_comment|/* 0x50-0x53 */
id|OPTABLE
c_func
(paren
l_int|0x54
comma
l_int|0xfd
comma
l_int|1
comma
id|ret
)paren
comma
multiline_comment|/* 0x54/0x56 */
id|OPTABLE
c_func
(paren
l_int|0x55
comma
l_int|0xff
comma
l_int|1
comma
id|relb
)paren
comma
multiline_comment|/* 0x55 */
id|OPTABLE
c_func
(paren
l_int|0x57
comma
l_int|0xff
comma
l_int|1
comma
id|none
)paren
comma
multiline_comment|/* 0x57 */
id|OPTABLE
c_func
(paren
l_int|0x58
comma
l_int|0xfb
comma
l_int|2
comma
id|relw
)paren
comma
multiline_comment|/* 0x58/0x5c */
id|OPTABLE
c_func
(paren
l_int|0x59
comma
l_int|0xfb
comma
l_int|1
comma
id|reg
)paren
comma
multiline_comment|/* 0x59/0x5b */
id|OPTABLE
c_func
(paren
l_int|0x5a
comma
l_int|0xfb
comma
l_int|2
comma
id|jabs
)paren
comma
multiline_comment|/* 0x5a/0x5e */
id|OPTABLE
c_func
(paren
l_int|0x5b
comma
l_int|0xfb
comma
l_int|2
comma
id|ind
)paren
comma
multiline_comment|/* 0x5b/0x5f */
id|OPTABLE
c_func
(paren
l_int|0x60
comma
l_int|0xe8
comma
l_int|1
comma
id|none
)paren
comma
multiline_comment|/* 0x60-0x67/0x70-0x77 */
id|OPTABLE
c_func
(paren
l_int|0x68
comma
l_int|0xfa
comma
l_int|1
comma
id|none
)paren
comma
multiline_comment|/* 0x68-0x69/0x6c-0x6d */
id|OPTABLE
c_func
(paren
l_int|0x6a
comma
l_int|0xfe
comma
op_minus
l_int|2
comma
id|none
)paren
comma
multiline_comment|/* 0x6a-0x6b */
id|OPTABLE
c_func
(paren
l_int|0x6e
comma
l_int|0xfe
comma
l_int|2
comma
id|none
)paren
comma
multiline_comment|/* 0x6e-0x6f */
id|OPTABLE
c_func
(paren
l_int|0x78
comma
l_int|0xff
comma
l_int|4
comma
id|none
)paren
comma
multiline_comment|/* 0x78 */
id|OPTABLE
c_func
(paren
l_int|0x79
comma
l_int|0xff
comma
l_int|2
comma
id|none
)paren
comma
multiline_comment|/* 0x79 */
id|OPTABLE
c_func
(paren
l_int|0x7a
comma
l_int|0xff
comma
l_int|3
comma
id|none
)paren
comma
multiline_comment|/* 0x7a */
id|OPTABLE
c_func
(paren
l_int|0x7b
comma
l_int|0xff
comma
l_int|2
comma
id|none
)paren
comma
multiline_comment|/* 0x7b */
id|OPTABLE
c_func
(paren
l_int|0x7c
comma
l_int|0xfc
comma
l_int|2
comma
id|none
)paren
comma
multiline_comment|/* 0x7c-0x7f */
id|OPTABLE
c_func
(paren
l_int|0x80
comma
l_int|0x80
comma
l_int|1
comma
id|none
)paren
comma
multiline_comment|/* 0x80-0xff */
)brace
suffix:semicolon
DECL|variable|optable_1
r_const
r_static
r_struct
id|optable
id|optable_1
(braket
)braket
op_assign
(brace
id|OPTABLE
c_func
(paren
l_int|0x00
comma
l_int|0xff
comma
op_minus
l_int|3
comma
id|none
)paren
comma
multiline_comment|/* 0x0100 */
id|OPTABLE
c_func
(paren
l_int|0x40
comma
l_int|0xf0
comma
op_minus
l_int|3
comma
id|none
)paren
comma
multiline_comment|/* 0x0140-0x14f */
id|OPTABLE
c_func
(paren
l_int|0x80
comma
l_int|0xf0
comma
l_int|1
comma
id|none
)paren
comma
multiline_comment|/* 0x0180-0x018f */
id|OPTABLE
c_func
(paren
l_int|0xc0
comma
l_int|0xc0
comma
l_int|2
comma
id|none
)paren
comma
multiline_comment|/* 0x01c0-0x01ff */
)brace
suffix:semicolon
DECL|variable|optable_2
r_const
r_static
r_struct
id|optable
id|optable_2
(braket
)braket
op_assign
(brace
id|OPTABLE
c_func
(paren
l_int|0x00
comma
l_int|0x20
comma
l_int|2
comma
id|none
)paren
comma
multiline_comment|/* 0x6a0?/0x6a8?/0x6b0?/0x6b8? */
id|OPTABLE
c_func
(paren
l_int|0x20
comma
l_int|0x20
comma
l_int|3
comma
id|none
)paren
comma
multiline_comment|/* 0x6a2?/0x6aa?/0x6b2?/0x6ba? */
)brace
suffix:semicolon
DECL|variable|optable_3
r_const
r_static
r_struct
id|optable
id|optable_3
(braket
)braket
op_assign
(brace
id|OPTABLE
c_func
(paren
l_int|0x69
comma
l_int|0xfb
comma
l_int|2
comma
id|none
)paren
comma
multiline_comment|/* 0x010069/0x01006d/014069/0x01406d */
id|OPTABLE
c_func
(paren
l_int|0x6b
comma
l_int|0xff
comma
op_minus
l_int|4
comma
id|none
)paren
comma
multiline_comment|/* 0x01006b/0x01406b */
id|OPTABLE
c_func
(paren
l_int|0x6f
comma
l_int|0xff
comma
l_int|3
comma
id|none
)paren
comma
multiline_comment|/* 0x01006f/0x01406f */
id|OPTABLE
c_func
(paren
l_int|0x78
comma
l_int|0xff
comma
l_int|5
comma
id|none
)paren
comma
multiline_comment|/* 0x010078/0x014078 */
)brace
suffix:semicolon
DECL|variable|optable_4
r_const
r_static
r_struct
id|optable
id|optable_4
(braket
)braket
op_assign
(brace
id|OPTABLE
c_func
(paren
l_int|0x00
comma
l_int|0x78
comma
l_int|3
comma
id|none
)paren
comma
multiline_comment|/* 0x0100690?/0x01006d0?/0140690/0x01406d0?/0x0100698?/0x01006d8?/0140698?/0x01406d8? */
id|OPTABLE
c_func
(paren
l_int|0x20
comma
l_int|0x78
comma
l_int|4
comma
id|none
)paren
comma
multiline_comment|/* 0x0100692?/0x01006d2?/0140692/0x01406d2?/0x010069a?/0x01006da?/014069a?/0x01406da? */
)brace
suffix:semicolon
DECL|struct|optables_list
r_const
r_static
r_struct
id|optables_list
(brace
DECL|member|ptr
r_const
r_struct
id|optable
op_star
id|ptr
suffix:semicolon
DECL|member|size
r_int
id|size
suffix:semicolon
DECL|variable|optables
)brace
id|optables
(braket
)braket
op_assign
(brace
DECL|macro|OPTABLES
mdefine_line|#define OPTABLES(no)                                                   &bslash;&n;        {                                                              &bslash;&n;&t;&t;.ptr  = optable_##no,                                  &bslash;&n;&t;&t;.size = sizeof(optable_##no) / sizeof(struct optable), &bslash;&n;&t;}
id|OPTABLES
c_func
(paren
l_int|0
)paren
comma
id|OPTABLES
c_func
(paren
l_int|1
)paren
comma
id|OPTABLES
c_func
(paren
l_int|2
)paren
comma
id|OPTABLES
c_func
(paren
l_int|3
)paren
comma
id|OPTABLES
c_func
(paren
l_int|4
)paren
comma
)brace
suffix:semicolon
DECL|variable|condmask
r_const
r_int
r_char
id|condmask
(braket
)braket
op_assign
(brace
l_int|0x00
comma
l_int|0x40
comma
l_int|0x01
comma
l_int|0x04
comma
l_int|0x02
comma
l_int|0x08
comma
l_int|0x10
comma
l_int|0x20
)brace
suffix:semicolon
DECL|function|isbranch
r_static
r_int
id|isbranch
c_func
(paren
r_struct
id|task_struct
op_star
id|task
comma
r_int
id|reson
)paren
(brace
r_int
r_char
id|cond
op_assign
id|h8300_get_reg
c_func
(paren
id|task
comma
id|PT_CCR
)paren
suffix:semicolon
multiline_comment|/* encode complex conditions */
multiline_comment|/* B4: N^V&n;&t;   B5: Z|(N^V)&n;&t;   B6: C|Z */
id|__asm__
c_func
(paren
l_string|&quot;bld #3,%w0&bslash;n&bslash;t&quot;
l_string|&quot;bxor #1,%w0&bslash;n&bslash;t&quot;
l_string|&quot;bst #4,%w0&bslash;n&bslash;t&quot;
l_string|&quot;bor #2,%w0&bslash;n&bslash;t&quot;
l_string|&quot;bst #5,%w0&bslash;n&bslash;t&quot;
l_string|&quot;bld #2,%w0&bslash;n&bslash;t&quot;
l_string|&quot;bor #0,%w0&bslash;n&bslash;t&quot;
l_string|&quot;bst #6,%w0&bslash;n&bslash;t&quot;
suffix:colon
l_string|&quot;=&amp;r&quot;
(paren
id|cond
)paren
op_scope_resolution
l_string|&quot;cc&quot;
)paren
suffix:semicolon
id|cond
op_and_assign
id|condmask
(braket
id|reson
op_rshift
l_int|1
)braket
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|reson
op_amp
l_int|1
)paren
)paren
r_return
id|cond
op_eq
l_int|0
suffix:semicolon
r_else
r_return
id|cond
op_ne
l_int|0
suffix:semicolon
)brace
DECL|function|getnextpc
r_static
r_int
r_int
op_star
id|getnextpc
c_func
(paren
r_struct
id|task_struct
op_star
id|child
comma
r_int
r_int
op_star
id|pc
)paren
(brace
r_const
r_struct
id|optable
op_star
id|op
suffix:semicolon
r_int
r_char
op_star
id|fetch_p
suffix:semicolon
r_int
r_char
id|inst
suffix:semicolon
r_int
r_int
id|addr
suffix:semicolon
r_int
r_int
op_star
id|sp
suffix:semicolon
r_int
id|op_len
comma
id|regno
suffix:semicolon
id|op
op_assign
id|optables
(braket
l_int|0
)braket
dot
id|ptr
suffix:semicolon
id|op_len
op_assign
id|optables
(braket
l_int|0
)braket
dot
id|size
suffix:semicolon
id|fetch_p
op_assign
(paren
r_int
r_char
op_star
)paren
id|pc
suffix:semicolon
id|inst
op_assign
op_star
id|fetch_p
op_increment
suffix:semicolon
r_do
(brace
r_if
c_cond
(paren
(paren
id|inst
op_amp
id|op-&gt;bitmask
)paren
op_eq
id|op-&gt;bitpattern
)paren
(brace
r_if
c_cond
(paren
id|op-&gt;length
OL
l_int|0
)paren
(brace
id|op
op_assign
id|optables
(braket
op_minus
id|op-&gt;length
)braket
dot
id|ptr
suffix:semicolon
id|op_len
op_assign
id|optables
(braket
op_minus
id|op-&gt;length
)braket
dot
id|size
op_plus
l_int|1
suffix:semicolon
id|inst
op_assign
op_star
id|fetch_p
op_increment
suffix:semicolon
)brace
r_else
(brace
r_switch
c_cond
(paren
id|op-&gt;type
)paren
(brace
r_case
id|none
suffix:colon
r_return
id|pc
op_plus
id|op-&gt;length
suffix:semicolon
r_case
id|jabs
suffix:colon
id|addr
op_assign
op_star
(paren
r_int
r_int
op_star
)paren
id|pc
suffix:semicolon
r_return
(paren
r_int
r_int
op_star
)paren
(paren
id|addr
op_amp
l_int|0x00ffffff
)paren
suffix:semicolon
r_case
id|ind
suffix:colon
id|addr
op_assign
op_star
id|pc
op_amp
l_int|0xff
suffix:semicolon
r_return
(paren
r_int
r_int
op_star
)paren
(paren
op_star
(paren
r_int
r_int
op_star
)paren
id|addr
)paren
suffix:semicolon
r_case
id|ret
suffix:colon
id|sp
op_assign
(paren
r_int
r_int
op_star
)paren
id|h8300_get_reg
c_func
(paren
id|child
comma
id|PT_USP
)paren
suffix:semicolon
multiline_comment|/* user stack frames&n;&t;&t;&t;&t;&t;   |   er0  | temporary saved&n;&t;&t;&t;&t;&t;   +--------+&n;&t;&t;&t;&t;&t;   |   exp  | exception stack frames&n;&t;&t;&t;&t;&t;   +--------+&n;&t;&t;&t;&t;&t;   | ret pc | userspace return address&n;&t;&t;&t;&t;&t;*/
r_return
(paren
r_int
r_int
op_star
)paren
(paren
op_star
(paren
id|sp
op_plus
l_int|2
)paren
op_amp
l_int|0x00ffffff
)paren
suffix:semicolon
r_case
id|reg
suffix:colon
id|regno
op_assign
(paren
op_star
id|pc
op_rshift
l_int|4
)paren
op_amp
l_int|0x07
suffix:semicolon
r_if
c_cond
(paren
id|regno
op_eq
l_int|0
)paren
id|addr
op_assign
id|h8300_get_reg
c_func
(paren
id|child
comma
id|PT_ER0
)paren
suffix:semicolon
r_else
id|addr
op_assign
id|h8300_get_reg
c_func
(paren
id|child
comma
id|regno
op_minus
l_int|1
op_plus
id|PT_ER1
)paren
suffix:semicolon
r_return
(paren
r_int
r_int
op_star
)paren
id|addr
suffix:semicolon
r_case
id|relb
suffix:colon
r_if
c_cond
(paren
(paren
id|inst
op_assign
l_int|0x55
)paren
op_logical_or
id|isbranch
c_func
(paren
id|child
comma
id|inst
op_amp
l_int|0x0f
)paren
)paren
id|pc
op_assign
(paren
r_int
r_int
op_star
)paren
(paren
(paren
r_int
r_int
)paren
id|pc
op_plus
(paren
(paren
r_int
r_char
)paren
(paren
op_star
id|fetch_p
)paren
)paren
)paren
suffix:semicolon
r_return
id|pc
op_plus
l_int|1
suffix:semicolon
multiline_comment|/* skip myself */
r_case
id|relw
suffix:colon
r_if
c_cond
(paren
(paren
id|inst
op_assign
l_int|0x5c
)paren
op_logical_or
id|isbranch
c_func
(paren
id|child
comma
(paren
op_star
id|fetch_p
op_amp
l_int|0xf0
)paren
op_rshift
l_int|4
)paren
)paren
id|pc
op_assign
(paren
r_int
r_int
op_star
)paren
(paren
(paren
r_int
r_int
)paren
id|pc
op_plus
(paren
(paren
r_int
r_int
)paren
(paren
op_star
(paren
id|pc
op_plus
l_int|1
)paren
)paren
)paren
)paren
suffix:semicolon
r_return
id|pc
op_plus
l_int|2
suffix:semicolon
multiline_comment|/* skip myself */
)brace
)brace
)brace
r_else
id|op
op_increment
suffix:semicolon
)brace
r_while
c_loop
(paren
op_decrement
id|op_len
OG
l_int|0
)paren
(brace
suffix:semicolon
)brace
r_return
l_int|NULL
suffix:semicolon
)brace
multiline_comment|/* Set breakpoint(s) to simulate a single step from the current PC.  */
DECL|function|h8300_enable_trace
r_void
id|h8300_enable_trace
c_func
(paren
r_struct
id|task_struct
op_star
id|child
)paren
(brace
r_int
r_int
op_star
id|nextpc
suffix:semicolon
id|nextpc
op_assign
id|getnextpc
c_func
(paren
id|child
comma
(paren
r_int
r_int
op_star
)paren
id|h8300_get_reg
c_func
(paren
id|child
comma
id|PT_PC
)paren
)paren
suffix:semicolon
id|child-&gt;thread.breakinfo.addr
op_assign
id|nextpc
suffix:semicolon
id|child-&gt;thread.breakinfo.inst
op_assign
op_star
id|nextpc
suffix:semicolon
op_star
id|nextpc
op_assign
id|BREAKINST
suffix:semicolon
)brace
DECL|function|trace_trap
id|asmlinkage
r_void
id|trace_trap
c_func
(paren
r_int
r_int
id|bp
)paren
(brace
r_if
c_cond
(paren
(paren
r_int
r_int
)paren
id|current-&gt;thread.breakinfo.addr
op_eq
id|bp
)paren
(brace
id|h8300_disable_trace
c_func
(paren
id|current
)paren
suffix:semicolon
id|force_sig
c_func
(paren
id|SIGTRAP
comma
id|current
)paren
suffix:semicolon
)brace
r_else
id|force_sig
c_func
(paren
id|SIGILL
comma
id|current
)paren
suffix:semicolon
)brace
eof
