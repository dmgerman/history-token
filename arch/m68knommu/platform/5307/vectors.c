multiline_comment|/***************************************************************************/
multiline_comment|/*&n; *&t;linux/arch/m68knommu/platform/5307/vectors.c&n; *&n; *&t;Copyright (C) 1999-2003, Greg Ungerer &lt;gerg@snapgear.com&gt;&n; */
multiline_comment|/***************************************************************************/
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/param.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/unistd.h&gt;
macro_line|#include &lt;asm/irq.h&gt;
macro_line|#include &lt;asm/dma.h&gt;
macro_line|#include &lt;asm/traps.h&gt;
macro_line|#include &lt;asm/machdep.h&gt;
macro_line|#include &lt;asm/coldfire.h&gt;
macro_line|#include &lt;asm/mcftimer.h&gt;
macro_line|#include &lt;asm/mcfsim.h&gt;
macro_line|#include &lt;asm/mcfdma.h&gt;
macro_line|#include &lt;asm/delay.h&gt;
macro_line|#include &lt;asm/mcfwdebug.h&gt;
multiline_comment|/***************************************************************************/
macro_line|#ifdef TRAP_DBG_INTERRUPT
DECL|function|dbginterrupt_c
id|asmlinkage
r_void
id|dbginterrupt_c
c_func
(paren
r_struct
id|frame
op_star
id|fp
)paren
(brace
r_extern
r_void
id|dump
c_func
(paren
r_struct
id|pt_regs
op_star
id|fp
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;%s(%d): BUS ERROR TRAP&bslash;n&quot;
comma
id|__FILE__
comma
id|__LINE__
)paren
suffix:semicolon
id|dump
c_func
(paren
(paren
r_struct
id|pt_regs
op_star
)paren
id|fp
)paren
suffix:semicolon
id|asm
c_func
(paren
l_string|&quot;halt&quot;
)paren
suffix:semicolon
)brace
macro_line|#endif
multiline_comment|/***************************************************************************/
r_extern
id|e_vector
op_star
id|_ramvec
suffix:semicolon
DECL|function|set_evector
r_void
id|set_evector
c_func
(paren
r_int
id|vecnum
comma
r_void
(paren
op_star
id|handler
)paren
(paren
r_void
)paren
)paren
(brace
r_if
c_cond
(paren
id|vecnum
op_ge
l_int|0
op_logical_and
id|vecnum
op_le
l_int|255
)paren
id|_ramvec
(braket
id|vecnum
)braket
op_assign
id|handler
suffix:semicolon
)brace
multiline_comment|/***************************************************************************/
multiline_comment|/* Assembler routines */
id|asmlinkage
r_void
id|buserr
c_func
(paren
r_void
)paren
suffix:semicolon
id|asmlinkage
r_void
id|trap
c_func
(paren
r_void
)paren
suffix:semicolon
id|asmlinkage
r_void
id|system_call
c_func
(paren
r_void
)paren
suffix:semicolon
id|asmlinkage
r_void
id|inthandler
c_func
(paren
r_void
)paren
suffix:semicolon
DECL|function|coldfire_trap_init
r_void
id|__init
id|coldfire_trap_init
c_func
(paren
r_void
)paren
(brace
r_int
id|i
suffix:semicolon
multiline_comment|/*&n;&t; *&t;There is a common trap handler and common interrupt&n;&t; *&t;handler that handle almost every vector. We treat&n;&t; *&t;the system call and bus error special, they get their&n;&t; *&t;own first level handlers.&n;&t; */
r_for
c_loop
(paren
id|i
op_assign
l_int|3
suffix:semicolon
(paren
id|i
op_le
l_int|23
)paren
suffix:semicolon
id|i
op_increment
)paren
id|_ramvec
(braket
id|i
)braket
op_assign
id|trap
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|33
suffix:semicolon
(paren
id|i
op_le
l_int|63
)paren
suffix:semicolon
id|i
op_increment
)paren
id|_ramvec
(braket
id|i
)braket
op_assign
id|trap
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|24
suffix:semicolon
(paren
id|i
op_le
l_int|31
)paren
suffix:semicolon
id|i
op_increment
)paren
id|_ramvec
(braket
id|i
)braket
op_assign
id|inthandler
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|64
suffix:semicolon
(paren
id|i
OL
l_int|255
)paren
suffix:semicolon
id|i
op_increment
)paren
id|_ramvec
(braket
id|i
)braket
op_assign
id|inthandler
suffix:semicolon
id|_ramvec
(braket
l_int|255
)braket
op_assign
l_int|0
suffix:semicolon
id|_ramvec
(braket
l_int|2
)braket
op_assign
id|buserr
suffix:semicolon
id|_ramvec
(braket
l_int|32
)braket
op_assign
id|system_call
suffix:semicolon
macro_line|#ifdef TRAP_DBG_INTERRUPT
id|_ramvec
(braket
l_int|12
)braket
op_assign
id|dbginterrupt
suffix:semicolon
macro_line|#endif
)brace
multiline_comment|/***************************************************************************/
DECL|function|coldfire_reset
r_void
id|coldfire_reset
c_func
(paren
r_void
)paren
(brace
id|HARD_RESET_NOW
c_func
(paren
)paren
suffix:semicolon
)brace
multiline_comment|/***************************************************************************/
eof
