multiline_comment|/*&n; * This program is used to generate definitions needed by&n; * assembly language modules.&n; *&n; * We use the technique used in the OSF Mach kernel code:&n; * generate asm statements containing #defines,&n; * compile this file to assembler, and then extract the&n; * #defines from the assembly-language output.&n; */
macro_line|#include &lt;linux/stddef.h&gt;
macro_line|#include &lt;linux/types.h&gt;
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;asm/thread_info.h&gt;
DECL|macro|DEFINE
mdefine_line|#define DEFINE(sym, val) &bslash;&n;        asm volatile(&quot;&bslash;n-&gt;&quot; #sym &quot; %0 &quot; #val : : &quot;i&quot; (val))
DECL|macro|BLANK
mdefine_line|#define BLANK() asm volatile(&quot;&bslash;n-&gt;&quot; : : )
DECL|function|main
r_int
id|main
c_func
(paren
r_void
)paren
(brace
multiline_comment|/* offsets into the thread_info struct */
id|DEFINE
c_func
(paren
id|TI_TASK
comma
m_offsetof
(paren
r_struct
id|thread_info
comma
id|task
)paren
)paren
suffix:semicolon
id|DEFINE
c_func
(paren
id|TI_EXEC_DOMAIN
comma
m_offsetof
(paren
r_struct
id|thread_info
comma
id|exec_domain
)paren
)paren
suffix:semicolon
id|DEFINE
c_func
(paren
id|TI_FLAGS
comma
m_offsetof
(paren
r_struct
id|thread_info
comma
id|flags
)paren
)paren
suffix:semicolon
id|DEFINE
c_func
(paren
id|TI_PRE_COUNT
comma
m_offsetof
(paren
r_struct
id|thread_info
comma
id|preempt_count
)paren
)paren
suffix:semicolon
id|DEFINE
c_func
(paren
id|TI_CPU
comma
m_offsetof
(paren
r_struct
id|thread_info
comma
id|cpu
)paren
)paren
suffix:semicolon
id|DEFINE
c_func
(paren
id|TI_ADDR_LIMIT
comma
m_offsetof
(paren
r_struct
id|thread_info
comma
id|addr_limit
)paren
)paren
suffix:semicolon
id|DEFINE
c_func
(paren
id|TI_RESTART_BLOCK
comma
m_offsetof
(paren
r_struct
id|thread_info
comma
id|restart_block
)paren
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
eof
