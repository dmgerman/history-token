multiline_comment|/*&n; *&t;linux/arch/alpha/kernel/err_titan.c&n; *&n; *&t;Copyright (C) 2000 Jeff Wiedemeier (Compaq Computer Corporation)&n; *&n; *&t;Error handling code supporting TITAN systems&n; */
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/pci.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;asm/io.h&gt;
macro_line|#include &lt;asm/core_titan.h&gt;
macro_line|#include &lt;asm/hwrpb.h&gt;
macro_line|#include &lt;asm/smp.h&gt;
macro_line|#include &lt;asm/err_common.h&gt;
macro_line|#include &lt;asm/err_ev6.h&gt;
macro_line|#include &quot;err_impl.h&quot;
macro_line|#include &quot;proto.h&quot;
r_static
r_int
DECL|function|titan_parse_c_misc
id|titan_parse_c_misc
c_func
(paren
id|u64
id|c_misc
comma
r_int
id|print
)paren
(brace
macro_line|#ifdef CONFIG_VERBOSE_MCHECK
r_char
op_star
id|src
suffix:semicolon
r_int
id|nxs
op_assign
l_int|0
suffix:semicolon
macro_line|#endif
r_int
id|status
op_assign
id|MCHK_DISPOSITION_REPORT
suffix:semicolon
DECL|macro|TITAN__CCHIP_MISC__NXM
mdefine_line|#define TITAN__CCHIP_MISC__NXM&t;&t;(1UL &lt;&lt; 28)
DECL|macro|TITAN__CCHIP_MISC__NXS__S
mdefine_line|#define TITAN__CCHIP_MISC__NXS__S&t;(29)
DECL|macro|TITAN__CCHIP_MISC__NXS__M
mdefine_line|#define TITAN__CCHIP_MISC__NXS__M&t;(0x7)
r_if
c_cond
(paren
op_logical_neg
(paren
id|c_misc
op_amp
id|TITAN__CCHIP_MISC__NXM
)paren
)paren
r_return
id|MCHK_DISPOSITION_UNKNOWN_ERROR
suffix:semicolon
macro_line|#ifdef CONFIG_VERBOSE_MCHECK
r_if
c_cond
(paren
op_logical_neg
id|print
)paren
r_return
id|status
suffix:semicolon
id|nxs
op_assign
id|EXTRACT
c_func
(paren
id|c_misc
comma
id|TITAN__CCHIP_MISC__NXS
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|nxs
)paren
(brace
r_case
l_int|0
suffix:colon
multiline_comment|/* CPU 0 */
r_case
l_int|1
suffix:colon
multiline_comment|/* CPU 1 */
r_case
l_int|2
suffix:colon
multiline_comment|/* CPU 2 */
r_case
l_int|3
suffix:colon
multiline_comment|/* CPU 3 */
id|src
op_assign
l_string|&quot;CPU&quot;
suffix:semicolon
multiline_comment|/* num is already the CPU number */
r_break
suffix:semicolon
r_case
l_int|4
suffix:colon
multiline_comment|/* Pchip 0 */
r_case
l_int|5
suffix:colon
multiline_comment|/* Pchip 1 */
id|src
op_assign
l_string|&quot;Pchip&quot;
suffix:semicolon
id|nxs
op_sub_assign
l_int|4
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
multiline_comment|/* reserved */
id|src
op_assign
l_string|&quot;Unknown, NXS =&quot;
suffix:semicolon
multiline_comment|/* leave num untouched */
r_break
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;%s    Non-existent memory access from: %s %d&bslash;n&quot;
comma
id|err_print_prefix
comma
id|src
comma
id|nxs
)paren
suffix:semicolon
macro_line|#endif /* CONFIG_VERBOSE_MCHECK */
r_return
id|status
suffix:semicolon
)brace
r_static
r_int
DECL|function|titan_parse_p_serror
id|titan_parse_p_serror
c_func
(paren
r_int
id|which
comma
id|u64
id|serror
comma
r_int
id|print
)paren
(brace
r_int
id|status
op_assign
id|MCHK_DISPOSITION_REPORT
suffix:semicolon
macro_line|#ifdef CONFIG_VERBOSE_MCHECK
r_char
op_star
id|serror_src
(braket
)braket
op_assign
(brace
l_string|&quot;GPCI&quot;
comma
l_string|&quot;APCI&quot;
comma
l_string|&quot;AGP HP&quot;
comma
l_string|&quot;AGP LP&quot;
)brace
suffix:semicolon
r_char
op_star
id|serror_cmd
(braket
)braket
op_assign
(brace
l_string|&quot;DMA Read&quot;
comma
l_string|&quot;DMA RMW&quot;
comma
l_string|&quot;SGTE Read&quot;
comma
l_string|&quot;Reserved&quot;
)brace
suffix:semicolon
macro_line|#endif /* CONFIG_VERBOSE_MCHECK */
DECL|macro|TITAN__PCHIP_SERROR__LOST_UECC
mdefine_line|#define TITAN__PCHIP_SERROR__LOST_UECC&t;(1UL &lt;&lt; 0)
DECL|macro|TITAN__PCHIP_SERROR__UECC
mdefine_line|#define TITAN__PCHIP_SERROR__UECC&t;(1UL &lt;&lt; 1)
DECL|macro|TITAN__PCHIP_SERROR__CRE
mdefine_line|#define TITAN__PCHIP_SERROR__CRE&t;(1UL &lt;&lt; 2)
DECL|macro|TITAN__PCHIP_SERROR__NXIO
mdefine_line|#define TITAN__PCHIP_SERROR__NXIO&t;(1UL &lt;&lt; 3)
DECL|macro|TITAN__PCHIP_SERROR__LOST_CRE
mdefine_line|#define TITAN__PCHIP_SERROR__LOST_CRE&t;(1UL &lt;&lt; 4)
DECL|macro|TITAN__PCHIP_SERROR__ECCMASK
mdefine_line|#define TITAN__PCHIP_SERROR__ECCMASK&t;(TITAN__PCHIP_SERROR__UECC |&t;  &bslash;&n;&t;&t;&t;&t;&t; TITAN__PCHIP_SERROR__CRE)
DECL|macro|TITAN__PCHIP_SERROR__ERRMASK
mdefine_line|#define TITAN__PCHIP_SERROR__ERRMASK&t;(TITAN__PCHIP_SERROR__LOST_UECC | &bslash;&n;&t;&t;&t;&t;&t; TITAN__PCHIP_SERROR__UECC |&t;  &bslash;&n;&t;&t;&t;&t;&t; TITAN__PCHIP_SERROR__CRE |&t;  &bslash;&n;&t;&t;&t;&t;&t; TITAN__PCHIP_SERROR__NXIO |&t;  &bslash;&n;&t;&t;&t;&t;&t; TITAN__PCHIP_SERROR__LOST_CRE)
DECL|macro|TITAN__PCHIP_SERROR__SRC__S
mdefine_line|#define TITAN__PCHIP_SERROR__SRC__S&t;(52)
DECL|macro|TITAN__PCHIP_SERROR__SRC__M
mdefine_line|#define TITAN__PCHIP_SERROR__SRC__M&t;(0x3)
DECL|macro|TITAN__PCHIP_SERROR__CMD__S
mdefine_line|#define TITAN__PCHIP_SERROR__CMD__S&t;(54)
DECL|macro|TITAN__PCHIP_SERROR__CMD__M
mdefine_line|#define TITAN__PCHIP_SERROR__CMD__M&t;(0x3)
DECL|macro|TITAN__PCHIP_SERROR__SYN__S
mdefine_line|#define TITAN__PCHIP_SERROR__SYN__S&t;(56)
DECL|macro|TITAN__PCHIP_SERROR__SYN__M
mdefine_line|#define TITAN__PCHIP_SERROR__SYN__M&t;(0xff)
DECL|macro|TITAN__PCHIP_SERROR__ADDR__S
mdefine_line|#define TITAN__PCHIP_SERROR__ADDR__S&t;(15)
DECL|macro|TITAN__PCHIP_SERROR__ADDR__M
mdefine_line|#define TITAN__PCHIP_SERROR__ADDR__M&t;(0xffffffffUL)
r_if
c_cond
(paren
op_logical_neg
(paren
id|serror
op_amp
id|TITAN__PCHIP_SERROR__ERRMASK
)paren
)paren
r_return
id|MCHK_DISPOSITION_UNKNOWN_ERROR
suffix:semicolon
macro_line|#ifdef CONFIG_VERBOSE_MCHECK
r_if
c_cond
(paren
op_logical_neg
id|print
)paren
r_return
id|status
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s  PChip %d SERROR: %016lx&bslash;n&quot;
comma
id|err_print_prefix
comma
id|which
comma
id|serror
)paren
suffix:semicolon
r_if
c_cond
(paren
id|serror
op_amp
id|TITAN__PCHIP_SERROR__ECCMASK
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s    %sorrectable ECC Error:&bslash;n&quot;
l_string|&quot;      Source: %-6s  Command: %-8s  Syndrome: 0x%08x&bslash;n&quot;
l_string|&quot;      Address: 0x%lx&bslash;n&quot;
comma
id|err_print_prefix
comma
(paren
id|serror
op_amp
id|TITAN__PCHIP_SERROR__UECC
)paren
ques
c_cond
l_string|&quot;Unc&quot;
suffix:colon
l_string|&quot;C&quot;
comma
id|serror_src
(braket
id|EXTRACT
c_func
(paren
id|serror
comma
id|TITAN__PCHIP_SERROR__SRC
)paren
)braket
comma
id|serror_cmd
(braket
id|EXTRACT
c_func
(paren
id|serror
comma
id|TITAN__PCHIP_SERROR__CMD
)paren
)braket
comma
(paren
r_int
)paren
id|EXTRACT
c_func
(paren
id|serror
comma
id|TITAN__PCHIP_SERROR__SYN
)paren
comma
id|EXTRACT
c_func
(paren
id|serror
comma
id|TITAN__PCHIP_SERROR__ADDR
)paren
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|serror
op_amp
id|TITAN__PCHIP_SERROR__NXIO
)paren
id|printk
c_func
(paren
l_string|&quot;%s    Non Existent I/O Error&bslash;n&quot;
comma
id|err_print_prefix
)paren
suffix:semicolon
r_if
c_cond
(paren
id|serror
op_amp
id|TITAN__PCHIP_SERROR__LOST_UECC
)paren
id|printk
c_func
(paren
l_string|&quot;%s    Lost Uncorrectable ECC Error&bslash;n&quot;
comma
id|err_print_prefix
)paren
suffix:semicolon
r_if
c_cond
(paren
id|serror
op_amp
id|TITAN__PCHIP_SERROR__LOST_CRE
)paren
id|printk
c_func
(paren
l_string|&quot;%s    Lost Correctable ECC Error&bslash;n&quot;
comma
id|err_print_prefix
)paren
suffix:semicolon
macro_line|#endif /* CONFIG_VERBOSE_MCHECK */
r_return
id|status
suffix:semicolon
)brace
r_static
r_int
DECL|function|titan_parse_p_perror
id|titan_parse_p_perror
c_func
(paren
r_int
id|which
comma
r_int
id|port
comma
id|u64
id|perror
comma
r_int
id|print
)paren
(brace
r_int
id|cmd
suffix:semicolon
r_int
r_int
id|addr
suffix:semicolon
r_int
id|status
op_assign
id|MCHK_DISPOSITION_REPORT
suffix:semicolon
macro_line|#ifdef CONFIG_VERBOSE_MCHECK
r_char
op_star
id|perror_cmd
(braket
)braket
op_assign
(brace
l_string|&quot;Interrupt Acknowledge&quot;
comma
l_string|&quot;Special Cycle&quot;
comma
l_string|&quot;I/O Read&quot;
comma
l_string|&quot;I/O Write&quot;
comma
l_string|&quot;Reserved&quot;
comma
l_string|&quot;Reserved&quot;
comma
l_string|&quot;Memory Read&quot;
comma
l_string|&quot;Memory Write&quot;
comma
l_string|&quot;Reserved&quot;
comma
l_string|&quot;Reserved&quot;
comma
l_string|&quot;Configuration Read&quot;
comma
l_string|&quot;Configuration Write&quot;
comma
l_string|&quot;Memory Read Multiple&quot;
comma
l_string|&quot;Dual Address Cycle&quot;
comma
l_string|&quot;Memory Read Line&quot;
comma
l_string|&quot;Memory Write and Invalidate&quot;
)brace
suffix:semicolon
macro_line|#endif /* CONFIG_VERBOSE_MCHECK */
DECL|macro|TITAN__PCHIP_PERROR__LOST
mdefine_line|#define TITAN__PCHIP_PERROR__LOST&t;(1UL &lt;&lt; 0)
DECL|macro|TITAN__PCHIP_PERROR__SERR
mdefine_line|#define TITAN__PCHIP_PERROR__SERR&t;(1UL &lt;&lt; 1)
DECL|macro|TITAN__PCHIP_PERROR__PERR
mdefine_line|#define TITAN__PCHIP_PERROR__PERR&t;(1UL &lt;&lt; 2)
DECL|macro|TITAN__PCHIP_PERROR__DCRTO
mdefine_line|#define TITAN__PCHIP_PERROR__DCRTO&t;(1UL &lt;&lt; 3)
DECL|macro|TITAN__PCHIP_PERROR__SGE
mdefine_line|#define TITAN__PCHIP_PERROR__SGE&t;(1UL &lt;&lt; 4)
DECL|macro|TITAN__PCHIP_PERROR__APE
mdefine_line|#define TITAN__PCHIP_PERROR__APE&t;(1UL &lt;&lt; 5)
DECL|macro|TITAN__PCHIP_PERROR__TA
mdefine_line|#define TITAN__PCHIP_PERROR__TA&t;&t;(1UL &lt;&lt; 6)
DECL|macro|TITAN__PCHIP_PERROR__DPE
mdefine_line|#define TITAN__PCHIP_PERROR__DPE&t;(1UL &lt;&lt; 7)
DECL|macro|TITAN__PCHIP_PERROR__NDS
mdefine_line|#define TITAN__PCHIP_PERROR__NDS&t;(1UL &lt;&lt; 8)
DECL|macro|TITAN__PCHIP_PERROR__IPTPR
mdefine_line|#define TITAN__PCHIP_PERROR__IPTPR&t;(1UL &lt;&lt; 9)
DECL|macro|TITAN__PCHIP_PERROR__IPTPW
mdefine_line|#define TITAN__PCHIP_PERROR__IPTPW&t;(1UL &lt;&lt; 10)
DECL|macro|TITAN__PCHIP_PERROR__ERRMASK
mdefine_line|#define TITAN__PCHIP_PERROR__ERRMASK&t;(TITAN__PCHIP_PERROR__LOST |&t;&bslash;&n;&t;&t;&t;&t;&t; TITAN__PCHIP_PERROR__SERR |&t;&bslash;&n;&t;&t;&t;&t;&t; TITAN__PCHIP_PERROR__PERR |&t;&bslash;&n;&t;&t;&t;&t;&t; TITAN__PCHIP_PERROR__DCRTO |&t;&bslash;&n;&t;&t;&t;&t;&t; TITAN__PCHIP_PERROR__SGE |&t;&bslash;&n;&t;&t;&t;&t;&t; TITAN__PCHIP_PERROR__APE |&t;&bslash;&n;&t;&t;&t;&t;&t; TITAN__PCHIP_PERROR__TA |&t;&bslash;&n;&t;&t;&t;&t;&t; TITAN__PCHIP_PERROR__DPE |&t;&bslash;&n;&t;&t;&t;&t;&t; TITAN__PCHIP_PERROR__NDS |&t;&bslash;&n;&t;&t;&t;&t;&t; TITAN__PCHIP_PERROR__IPTPR |&t;&bslash;&n;&t;&t;&t;&t;&t; TITAN__PCHIP_PERROR__IPTPW)
DECL|macro|TITAN__PCHIP_PERROR__DAC
mdefine_line|#define TITAN__PCHIP_PERROR__DAC&t;(1UL &lt;&lt; 47)
DECL|macro|TITAN__PCHIP_PERROR__MWIN
mdefine_line|#define TITAN__PCHIP_PERROR__MWIN&t;(1UL &lt;&lt; 48)
DECL|macro|TITAN__PCHIP_PERROR__CMD__S
mdefine_line|#define TITAN__PCHIP_PERROR__CMD__S&t;(52)
DECL|macro|TITAN__PCHIP_PERROR__CMD__M
mdefine_line|#define TITAN__PCHIP_PERROR__CMD__M&t;(0x0f)
DECL|macro|TITAN__PCHIP_PERROR__ADDR__S
mdefine_line|#define TITAN__PCHIP_PERROR__ADDR__S&t;(14)
DECL|macro|TITAN__PCHIP_PERROR__ADDR__M
mdefine_line|#define TITAN__PCHIP_PERROR__ADDR__M&t;(0x1ffffffff)
r_if
c_cond
(paren
op_logical_neg
(paren
id|perror
op_amp
id|TITAN__PCHIP_PERROR__ERRMASK
)paren
)paren
r_return
id|MCHK_DISPOSITION_UNKNOWN_ERROR
suffix:semicolon
id|cmd
op_assign
id|EXTRACT
c_func
(paren
id|perror
comma
id|TITAN__PCHIP_PERROR__CMD
)paren
suffix:semicolon
id|addr
op_assign
id|EXTRACT
c_func
(paren
id|perror
comma
id|TITAN__PCHIP_PERROR__ADDR
)paren
op_lshift
l_int|2
suffix:semicolon
multiline_comment|/*&n;&t; * Initializing the BIOS on a video card on a bus without&n;&t; * a south bridge (subtractive decode agent) can result in &n;&t; * master aborts as the BIOS probes the capabilities of the&n;&t; * card. XFree86 does such initialization. If the error&n;&t; * is a master abort (No DevSel as PCI Master) and the command&n;&t; * is an I/O read or write below the address where we start&n;&t; * assigning PCI I/O spaces (SRM uses 0x1000), then mark the&n;&t; * error as dismissable so starting XFree86 doesn&squot;t result&n;&t; * in a series of uncorrectable errors being reported. Also&n;&t; * dismiss master aborts to VGA frame buffer space&n;&t; * (0xA0000 - 0xC0000) and legacy BIOS space (0xC0000 - 0x100000)&n;&t; * for the same reason.&n;&t; *&n;&t; * Also mark the error dismissible if it looks like the right&n;&t; * error but only the Lost bit is set. Since the BIOS initialization&n;&t; * can cause multiple master aborts and the error interrupt can&n;&t; * be handled on a different CPU than the BIOS code is run on,&n;&t; * it is possible for a second master abort to occur between the&n;&t; * time the PALcode reads PERROR and the time it writes PERROR&n;&t; * to acknowledge the error. If this timing happens, a second&n;&t; * error will be signalled after the first, and if no additional&n;&t; * errors occur, will look like a Lost error with no additional &n;&t; * errors on the same transaction as the previous error.&n;&t; */
r_if
c_cond
(paren
(paren
(paren
id|perror
op_amp
id|TITAN__PCHIP_PERROR__NDS
)paren
op_logical_or
(paren
(paren
id|perror
op_amp
id|TITAN__PCHIP_PERROR__ERRMASK
)paren
op_eq
id|TITAN__PCHIP_PERROR__LOST
)paren
)paren
op_logical_and
(paren
(paren
(paren
(paren
id|cmd
op_amp
l_int|0xE
)paren
op_eq
l_int|2
)paren
op_logical_and
(paren
id|addr
OL
l_int|0x1000
)paren
)paren
op_logical_or
(paren
(paren
(paren
id|cmd
op_amp
l_int|0xE
)paren
op_eq
l_int|6
)paren
op_logical_and
(paren
id|addr
op_ge
l_int|0xA0000
)paren
op_logical_and
(paren
id|addr
OL
l_int|0x100000
)paren
)paren
)paren
)paren
(brace
id|status
op_assign
id|MCHK_DISPOSITION_DISMISS
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_VERBOSE_MCHECK
r_if
c_cond
(paren
op_logical_neg
id|print
)paren
r_return
id|status
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s  PChip %d %cPERROR: %016lx&bslash;n&quot;
comma
id|err_print_prefix
comma
id|which
comma
id|port
ques
c_cond
l_char|&squot;A&squot;
suffix:colon
l_char|&squot;G&squot;
comma
id|perror
)paren
suffix:semicolon
r_if
c_cond
(paren
id|perror
op_amp
id|TITAN__PCHIP_PERROR__IPTPW
)paren
id|printk
c_func
(paren
l_string|&quot;%s    Invalid Peer-to-Peer Write&bslash;n&quot;
comma
id|err_print_prefix
)paren
suffix:semicolon
r_if
c_cond
(paren
id|perror
op_amp
id|TITAN__PCHIP_PERROR__IPTPR
)paren
id|printk
c_func
(paren
l_string|&quot;%s    Invalid Peer-to-Peer Read&bslash;n&quot;
comma
id|err_print_prefix
)paren
suffix:semicolon
r_if
c_cond
(paren
id|perror
op_amp
id|TITAN__PCHIP_PERROR__NDS
)paren
id|printk
c_func
(paren
l_string|&quot;%s    No DEVSEL as PCI Master [Master Abort]&bslash;n&quot;
comma
id|err_print_prefix
)paren
suffix:semicolon
r_if
c_cond
(paren
id|perror
op_amp
id|TITAN__PCHIP_PERROR__DPE
)paren
id|printk
c_func
(paren
l_string|&quot;%s    Data Parity Error&bslash;n&quot;
comma
id|err_print_prefix
)paren
suffix:semicolon
r_if
c_cond
(paren
id|perror
op_amp
id|TITAN__PCHIP_PERROR__TA
)paren
id|printk
c_func
(paren
l_string|&quot;%s    Target Abort&bslash;n&quot;
comma
id|err_print_prefix
)paren
suffix:semicolon
r_if
c_cond
(paren
id|perror
op_amp
id|TITAN__PCHIP_PERROR__APE
)paren
id|printk
c_func
(paren
l_string|&quot;%s    Address Parity Error&bslash;n&quot;
comma
id|err_print_prefix
)paren
suffix:semicolon
r_if
c_cond
(paren
id|perror
op_amp
id|TITAN__PCHIP_PERROR__SGE
)paren
id|printk
c_func
(paren
l_string|&quot;%s    Scatter-Gather Error, Invalid PTE&bslash;n&quot;
comma
id|err_print_prefix
)paren
suffix:semicolon
r_if
c_cond
(paren
id|perror
op_amp
id|TITAN__PCHIP_PERROR__DCRTO
)paren
id|printk
c_func
(paren
l_string|&quot;%s    Delayed-Completion Retry Timeout&bslash;n&quot;
comma
id|err_print_prefix
)paren
suffix:semicolon
r_if
c_cond
(paren
id|perror
op_amp
id|TITAN__PCHIP_PERROR__PERR
)paren
id|printk
c_func
(paren
l_string|&quot;%s    PERR Asserted&bslash;n&quot;
comma
id|err_print_prefix
)paren
suffix:semicolon
r_if
c_cond
(paren
id|perror
op_amp
id|TITAN__PCHIP_PERROR__SERR
)paren
id|printk
c_func
(paren
l_string|&quot;%s    SERR Asserted&bslash;n&quot;
comma
id|err_print_prefix
)paren
suffix:semicolon
r_if
c_cond
(paren
id|perror
op_amp
id|TITAN__PCHIP_PERROR__LOST
)paren
id|printk
c_func
(paren
l_string|&quot;%s    Lost Error&bslash;n&quot;
comma
id|err_print_prefix
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s      Command: 0x%x - %s&bslash;n&quot;
l_string|&quot;      Address: 0x%lx&bslash;n&quot;
comma
id|err_print_prefix
comma
id|cmd
comma
id|perror_cmd
(braket
id|cmd
)braket
comma
id|addr
)paren
suffix:semicolon
r_if
c_cond
(paren
id|perror
op_amp
id|TITAN__PCHIP_PERROR__DAC
)paren
id|printk
c_func
(paren
l_string|&quot;%s      Dual Address Cycle&bslash;n&quot;
comma
id|err_print_prefix
)paren
suffix:semicolon
r_if
c_cond
(paren
id|perror
op_amp
id|TITAN__PCHIP_PERROR__MWIN
)paren
id|printk
c_func
(paren
l_string|&quot;%s      Hit in Monster Window&bslash;n&quot;
comma
id|err_print_prefix
)paren
suffix:semicolon
macro_line|#endif /* CONFIG_VERBOSE_MCHECK */
r_return
id|status
suffix:semicolon
)brace
r_static
r_int
DECL|function|titan_parse_p_agperror
id|titan_parse_p_agperror
c_func
(paren
r_int
id|which
comma
id|u64
id|agperror
comma
r_int
id|print
)paren
(brace
r_int
id|status
op_assign
id|MCHK_DISPOSITION_REPORT
suffix:semicolon
macro_line|#ifdef CONFIG_VERBOSE_MCHECK
r_int
id|cmd
comma
id|len
suffix:semicolon
r_int
r_int
id|addr
suffix:semicolon
r_char
op_star
id|agperror_cmd
(braket
)braket
op_assign
(brace
l_string|&quot;Read (low-priority)&quot;
comma
l_string|&quot;Read (high-priority)&quot;
comma
l_string|&quot;Write (low-priority)&quot;
comma
l_string|&quot;Write (high-priority)&quot;
comma
l_string|&quot;Reserved&quot;
comma
l_string|&quot;Reserved&quot;
comma
l_string|&quot;Flush&quot;
comma
l_string|&quot;Fence&quot;
)brace
suffix:semicolon
macro_line|#endif /* CONFIG_VERBOSE_MCHECK */
DECL|macro|TITAN__PCHIP_AGPERROR__LOST
mdefine_line|#define TITAN__PCHIP_AGPERROR__LOST&t;(1UL &lt;&lt; 0)
DECL|macro|TITAN__PCHIP_AGPERROR__LPQFULL
mdefine_line|#define TITAN__PCHIP_AGPERROR__LPQFULL&t;(1UL &lt;&lt; 1)
DECL|macro|TITAN__PCHIP_AGPERROR__HPQFULL
mdefine_line|#define TITAN__PCHIP_AGPERROR__HPQFULL&t;(1UL &lt;&lt; 2)
DECL|macro|TITAN__PCHIP_AGPERROR__RESCMD
mdefine_line|#define TITAN__PCHIP_AGPERROR__RESCMD&t;(1UL &lt;&lt; 3)
DECL|macro|TITAN__PCHIP_AGPERROR__IPTE
mdefine_line|#define TITAN__PCHIP_AGPERROR__IPTE&t;(1UL &lt;&lt; 4)
DECL|macro|TITAN__PCHIP_AGPERROR__PTP
mdefine_line|#define TITAN__PCHIP_AGPERROR__PTP&t;(1UL &lt;&lt; 5)
DECL|macro|TITAN__PCHIP_AGPERROR__NOWINDOW
mdefine_line|#define TITAN__PCHIP_AGPERROR__NOWINDOW&t;(1UL &lt;&lt; 6)
DECL|macro|TITAN__PCHIP_AGPERROR__ERRMASK
mdefine_line|#define TITAN__PCHIP_AGPERROR__ERRMASK&t;(TITAN__PCHIP_AGPERROR__LOST |    &bslash;&n;&t;&t;&t;&t;&t; TITAN__PCHIP_AGPERROR__LPQFULL | &bslash;&n;&t;&t;&t;&t;&t; TITAN__PCHIP_AGPERROR__HPQFULL | &bslash;&n;&t;&t;&t;&t;&t; TITAN__PCHIP_AGPERROR__RESCMD |  &bslash;&n;&t;&t;&t;&t;&t; TITAN__PCHIP_AGPERROR__IPTE |    &bslash;&n;&t;&t;&t;&t;&t; TITAN__PCHIP_AGPERROR__PTP |     &bslash;&n;&t;&t;&t;&t;&t; TITAN__PCHIP_AGPERROR__NOWINDOW)
DECL|macro|TITAN__PCHIP_AGPERROR__DAC
mdefine_line|#define TITAN__PCHIP_AGPERROR__DAC&t;(1UL &lt;&lt; 48)
DECL|macro|TITAN__PCHIP_AGPERROR__MWIN
mdefine_line|#define TITAN__PCHIP_AGPERROR__MWIN&t;(1UL &lt;&lt; 49)
DECL|macro|TITAN__PCHIP_AGPERROR__FENCE
mdefine_line|#define TITAN__PCHIP_AGPERROR__FENCE&t;(1UL &lt;&lt; 59)
DECL|macro|TITAN__PCHIP_AGPERROR__CMD__S
mdefine_line|#define TITAN__PCHIP_AGPERROR__CMD__S&t;(50)
DECL|macro|TITAN__PCHIP_AGPERROR__CMD__M
mdefine_line|#define TITAN__PCHIP_AGPERROR__CMD__M&t;(0x07)
DECL|macro|TITAN__PCHIP_AGPERROR__ADDR__S
mdefine_line|#define TITAN__PCHIP_AGPERROR__ADDR__S&t;(15)
DECL|macro|TITAN__PCHIP_AGPERROR__ADDR__M
mdefine_line|#define TITAN__PCHIP_AGPERROR__ADDR__M  (0xffffffffUL)
DECL|macro|TITAN__PCHIP_AGPERROR__LEN__S
mdefine_line|#define TITAN__PCHIP_AGPERROR__LEN__S&t;(53)
DECL|macro|TITAN__PCHIP_AGPERROR__LEN__M
mdefine_line|#define TITAN__PCHIP_AGPERROR__LEN__M&t;(0x3f)
r_if
c_cond
(paren
op_logical_neg
(paren
id|agperror
op_amp
id|TITAN__PCHIP_AGPERROR__ERRMASK
)paren
)paren
r_return
id|MCHK_DISPOSITION_UNKNOWN_ERROR
suffix:semicolon
macro_line|#ifdef CONFIG_VERBOSE_MCHECK
r_if
c_cond
(paren
op_logical_neg
id|print
)paren
r_return
id|status
suffix:semicolon
id|cmd
op_assign
id|EXTRACT
c_func
(paren
id|agperror
comma
id|TITAN__PCHIP_AGPERROR__CMD
)paren
suffix:semicolon
id|addr
op_assign
id|EXTRACT
c_func
(paren
id|agperror
comma
id|TITAN__PCHIP_AGPERROR__ADDR
)paren
op_lshift
l_int|3
suffix:semicolon
id|len
op_assign
id|EXTRACT
c_func
(paren
id|agperror
comma
id|TITAN__PCHIP_AGPERROR__LEN
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s  PChip %d AGPERROR: %016lx&bslash;n&quot;
comma
id|err_print_prefix
comma
id|which
comma
id|agperror
)paren
suffix:semicolon
r_if
c_cond
(paren
id|agperror
op_amp
id|TITAN__PCHIP_AGPERROR__NOWINDOW
)paren
id|printk
c_func
(paren
l_string|&quot;%s    No Window&bslash;n&quot;
comma
id|err_print_prefix
)paren
suffix:semicolon
r_if
c_cond
(paren
id|agperror
op_amp
id|TITAN__PCHIP_AGPERROR__PTP
)paren
id|printk
c_func
(paren
l_string|&quot;%s    Peer-to-Peer set&bslash;n&quot;
comma
id|err_print_prefix
)paren
suffix:semicolon
r_if
c_cond
(paren
id|agperror
op_amp
id|TITAN__PCHIP_AGPERROR__IPTE
)paren
id|printk
c_func
(paren
l_string|&quot;%s    Invalid PTE&bslash;n&quot;
comma
id|err_print_prefix
)paren
suffix:semicolon
r_if
c_cond
(paren
id|agperror
op_amp
id|TITAN__PCHIP_AGPERROR__RESCMD
)paren
id|printk
c_func
(paren
l_string|&quot;%s    Reserved Command&bslash;n&quot;
comma
id|err_print_prefix
)paren
suffix:semicolon
r_if
c_cond
(paren
id|agperror
op_amp
id|TITAN__PCHIP_AGPERROR__HPQFULL
)paren
id|printk
c_func
(paren
l_string|&quot;%s    HP Transaction Received while Queue Full&bslash;n&quot;
comma
id|err_print_prefix
)paren
suffix:semicolon
r_if
c_cond
(paren
id|agperror
op_amp
id|TITAN__PCHIP_AGPERROR__LPQFULL
)paren
id|printk
c_func
(paren
l_string|&quot;%s    LP Transaction Received while Queue Full&bslash;n&quot;
comma
id|err_print_prefix
)paren
suffix:semicolon
r_if
c_cond
(paren
id|agperror
op_amp
id|TITAN__PCHIP_AGPERROR__LOST
)paren
id|printk
c_func
(paren
l_string|&quot;%s    Lost Error&bslash;n&quot;
comma
id|err_print_prefix
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s      Command: 0x%x - %s, %d Quadwords%s&bslash;n&quot;
l_string|&quot;      Address: 0x%lx&bslash;n&quot;
comma
id|err_print_prefix
comma
id|cmd
comma
id|agperror_cmd
(braket
id|cmd
)braket
comma
id|len
comma
(paren
id|agperror
op_amp
id|TITAN__PCHIP_AGPERROR__FENCE
)paren
ques
c_cond
l_string|&quot;, FENCE&quot;
suffix:colon
l_string|&quot;&quot;
comma
id|addr
)paren
suffix:semicolon
r_if
c_cond
(paren
id|agperror
op_amp
id|TITAN__PCHIP_AGPERROR__DAC
)paren
id|printk
c_func
(paren
l_string|&quot;%s      Dual Address Cycle&bslash;n&quot;
comma
id|err_print_prefix
)paren
suffix:semicolon
r_if
c_cond
(paren
id|agperror
op_amp
id|TITAN__PCHIP_AGPERROR__MWIN
)paren
id|printk
c_func
(paren
l_string|&quot;%s      Hit in Monster Window&bslash;n&quot;
comma
id|err_print_prefix
)paren
suffix:semicolon
macro_line|#endif /* CONFIG_VERBOSE_MCHECK */
r_return
id|status
suffix:semicolon
)brace
r_static
r_int
DECL|function|titan_parse_p_chip
id|titan_parse_p_chip
c_func
(paren
r_int
id|which
comma
id|u64
id|serror
comma
id|u64
id|gperror
comma
id|u64
id|aperror
comma
id|u64
id|agperror
comma
r_int
id|print
)paren
(brace
r_int
id|status
op_assign
id|MCHK_DISPOSITION_UNKNOWN_ERROR
suffix:semicolon
id|status
op_or_assign
id|titan_parse_p_serror
c_func
(paren
id|which
comma
id|serror
comma
id|print
)paren
suffix:semicolon
id|status
op_or_assign
id|titan_parse_p_perror
c_func
(paren
id|which
comma
l_int|0
comma
id|gperror
comma
id|print
)paren
suffix:semicolon
id|status
op_or_assign
id|titan_parse_p_perror
c_func
(paren
id|which
comma
l_int|1
comma
id|aperror
comma
id|print
)paren
suffix:semicolon
id|status
op_or_assign
id|titan_parse_p_agperror
c_func
(paren
id|which
comma
id|agperror
comma
id|print
)paren
suffix:semicolon
r_return
id|status
suffix:semicolon
)brace
r_int
DECL|function|titan_process_logout_frame
id|titan_process_logout_frame
c_func
(paren
r_struct
id|el_common
op_star
id|mchk_header
comma
r_int
id|print
)paren
(brace
r_struct
id|el_TITAN_sysdata_mcheck
op_star
id|tmchk
op_assign
(paren
r_struct
id|el_TITAN_sysdata_mcheck
op_star
)paren
(paren
(paren
r_int
r_int
)paren
id|mchk_header
op_plus
id|mchk_header-&gt;sys_offset
)paren
suffix:semicolon
r_int
id|status
op_assign
id|MCHK_DISPOSITION_UNKNOWN_ERROR
suffix:semicolon
id|status
op_or_assign
id|titan_parse_c_misc
c_func
(paren
id|tmchk-&gt;c_misc
comma
id|print
)paren
suffix:semicolon
id|status
op_or_assign
id|titan_parse_p_chip
c_func
(paren
l_int|0
comma
id|tmchk-&gt;p0_serror
comma
id|tmchk-&gt;p0_gperror
comma
id|tmchk-&gt;p0_aperror
comma
id|tmchk-&gt;p0_agperror
comma
id|print
)paren
suffix:semicolon
id|status
op_or_assign
id|titan_parse_p_chip
c_func
(paren
l_int|1
comma
id|tmchk-&gt;p1_serror
comma
id|tmchk-&gt;p1_gperror
comma
id|tmchk-&gt;p1_aperror
comma
id|tmchk-&gt;p1_agperror
comma
id|print
)paren
suffix:semicolon
r_return
id|status
suffix:semicolon
)brace
r_void
DECL|function|titan_machine_check
id|titan_machine_check
c_func
(paren
id|u64
id|vector
comma
id|u64
id|la_ptr
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
r_struct
id|el_common
op_star
id|mchk_header
op_assign
(paren
r_struct
id|el_common
op_star
)paren
id|la_ptr
suffix:semicolon
r_struct
id|el_TITAN_sysdata_mcheck
op_star
id|tmchk
op_assign
(paren
r_struct
id|el_TITAN_sysdata_mcheck
op_star
)paren
(paren
(paren
r_int
r_int
)paren
id|mchk_header
op_plus
id|mchk_header-&gt;sys_offset
)paren
suffix:semicolon
id|u64
id|irqmask
suffix:semicolon
multiline_comment|/*&n;&t; * Mask of Titan interrupt sources which are reported as machine checks&n;&t; *&n;&t; * 63 - CChip Error&n;&t; * 62 - PChip 0 H_Error&n;&t; * 61 - PChip 1 H_Error&n;&t; * 60 - PChip 0 C_Error&n;&t; * 59 - PChip 1 C_Error&n;&t; */
DECL|macro|TITAN_MCHECK_INTERRUPT_MASK
mdefine_line|#define TITAN_MCHECK_INTERRUPT_MASK&t;0xF800000000000000UL
multiline_comment|/*&n;&t; * Sync the processor&n;&t; */
id|mb
c_func
(paren
)paren
suffix:semicolon
id|draina
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * Only handle system errors here &n;&t; */
r_if
c_cond
(paren
(paren
id|vector
op_ne
id|SCB_Q_SYSMCHK
)paren
op_logical_and
(paren
id|vector
op_ne
id|SCB_Q_SYSERR
)paren
)paren
r_return
id|ev6_machine_check
c_func
(paren
id|vector
comma
id|la_ptr
comma
id|regs
)paren
suffix:semicolon
multiline_comment|/* &n;&t; * It&squot;s a system error, handle it here&n;&t; *&n;&t; * The PALcode has already cleared the error, so just parse it&n;&t; */
multiline_comment|/* &n;&t; * Parse the logout frame without printing first. If the only error(s)&n;&t; * found are classified as &quot;dismissable&quot;, then just dismiss them and&n;&t; * don&squot;t print any message&n;&t; */
r_if
c_cond
(paren
id|titan_process_logout_frame
c_func
(paren
id|mchk_header
comma
l_int|0
)paren
op_ne
id|MCHK_DISPOSITION_DISMISS
)paren
(brace
r_char
op_star
id|saved_err_prefix
op_assign
id|err_print_prefix
suffix:semicolon
id|err_print_prefix
op_assign
id|KERN_CRIT
suffix:semicolon
multiline_comment|/*&n;&t;&t; * Either a nondismissable error was detected or no&n;&t;&t; * recognized error was detected  in the logout frame &n;&t;&t; * -- report the error in either case&n;&t;&t; */
id|printk
c_func
(paren
l_string|&quot;%s&quot;
l_string|&quot;*System %s Error (Vector 0x%x) reported on CPU %d:&bslash;n&quot;
comma
id|err_print_prefix
comma
(paren
id|vector
op_eq
id|SCB_Q_SYSERR
)paren
ques
c_cond
l_string|&quot;Correctable&quot;
suffix:colon
l_string|&quot;Uncorrectable&quot;
comma
(paren
r_int
r_int
)paren
id|vector
comma
(paren
r_int
)paren
id|smp_processor_id
c_func
(paren
)paren
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_VERBOSE_MCHECK
id|titan_process_logout_frame
c_func
(paren
id|mchk_header
comma
id|alpha_verbose_mcheck
)paren
suffix:semicolon
r_if
c_cond
(paren
id|alpha_verbose_mcheck
)paren
id|dik_show_regs
c_func
(paren
id|regs
comma
l_int|NULL
)paren
suffix:semicolon
macro_line|#endif /* CONFIG_VERBOSE_MCHECK */
id|err_print_prefix
op_assign
id|saved_err_prefix
suffix:semicolon
multiline_comment|/*&n;&t;&t; * Convert any pending interrupts which report as system&n;&t;&t; * machine checks to interrupts&n;&t;&t; */
id|irqmask
op_assign
id|tmchk-&gt;c_dirx
op_amp
id|TITAN_MCHECK_INTERRUPT_MASK
suffix:semicolon
id|titan_dispatch_irqs
c_func
(paren
id|irqmask
comma
id|regs
)paren
suffix:semicolon
)brace
multiline_comment|/* &n;&t; * Release the logout frame &n;&t; */
id|wrmces
c_func
(paren
l_int|0x7
)paren
suffix:semicolon
id|mb
c_func
(paren
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Subpacket Annotations&n; */
DECL|variable|el_titan_pchip0_extended_annotation
r_static
r_char
op_star
id|el_titan_pchip0_extended_annotation
(braket
)braket
op_assign
(brace
l_string|&quot;Subpacket Header&quot;
comma
l_string|&quot;P0_SCTL&quot;
comma
l_string|&quot;P0_SERREN&quot;
comma
l_string|&quot;P0_APCTL&quot;
comma
l_string|&quot;P0_APERREN&quot;
comma
l_string|&quot;P0_AGPERREN&quot;
comma
l_string|&quot;P0_ASPRST&quot;
comma
l_string|&quot;P0_AWSBA0&quot;
comma
l_string|&quot;P0_AWSBA1&quot;
comma
l_string|&quot;P0_AWSBA2&quot;
comma
l_string|&quot;P0_AWSBA3&quot;
comma
l_string|&quot;P0_AWSM0&quot;
comma
l_string|&quot;P0_AWSM1&quot;
comma
l_string|&quot;P0_AWSM2&quot;
comma
l_string|&quot;P0_AWSM3&quot;
comma
l_string|&quot;P0_ATBA0&quot;
comma
l_string|&quot;P0_ATBA1&quot;
comma
l_string|&quot;P0_ATBA2&quot;
comma
l_string|&quot;P0_ATBA3&quot;
comma
l_string|&quot;P0_GPCTL&quot;
comma
l_string|&quot;P0_GPERREN&quot;
comma
l_string|&quot;P0_GSPRST&quot;
comma
l_string|&quot;P0_GWSBA0&quot;
comma
l_string|&quot;P0_GWSBA1&quot;
comma
l_string|&quot;P0_GWSBA2&quot;
comma
l_string|&quot;P0_GWSBA3&quot;
comma
l_string|&quot;P0_GWSM0&quot;
comma
l_string|&quot;P0_GWSM1&quot;
comma
l_string|&quot;P0_GWSM2&quot;
comma
l_string|&quot;P0_GWSM3&quot;
comma
l_string|&quot;P0_GTBA0&quot;
comma
l_string|&quot;P0_GTBA1&quot;
comma
l_string|&quot;P0_GTBA2&quot;
comma
l_string|&quot;P0_GTBA3&quot;
comma
l_int|NULL
)brace
suffix:semicolon
DECL|variable|el_titan_pchip1_extended_annotation
r_static
r_char
op_star
id|el_titan_pchip1_extended_annotation
(braket
)braket
op_assign
(brace
l_string|&quot;Subpacket Header&quot;
comma
l_string|&quot;P1_SCTL&quot;
comma
l_string|&quot;P1_SERREN&quot;
comma
l_string|&quot;P1_APCTL&quot;
comma
l_string|&quot;P1_APERREN&quot;
comma
l_string|&quot;P1_AGPERREN&quot;
comma
l_string|&quot;P1_ASPRST&quot;
comma
l_string|&quot;P1_AWSBA0&quot;
comma
l_string|&quot;P1_AWSBA1&quot;
comma
l_string|&quot;P1_AWSBA2&quot;
comma
l_string|&quot;P1_AWSBA3&quot;
comma
l_string|&quot;P1_AWSM0&quot;
comma
l_string|&quot;P1_AWSM1&quot;
comma
l_string|&quot;P1_AWSM2&quot;
comma
l_string|&quot;P1_AWSM3&quot;
comma
l_string|&quot;P1_ATBA0&quot;
comma
l_string|&quot;P1_ATBA1&quot;
comma
l_string|&quot;P1_ATBA2&quot;
comma
l_string|&quot;P1_ATBA3&quot;
comma
l_string|&quot;P1_GPCTL&quot;
comma
l_string|&quot;P1_GPERREN&quot;
comma
l_string|&quot;P1_GSPRST&quot;
comma
l_string|&quot;P1_GWSBA0&quot;
comma
l_string|&quot;P1_GWSBA1&quot;
comma
l_string|&quot;P1_GWSBA2&quot;
comma
l_string|&quot;P1_GWSBA3&quot;
comma
l_string|&quot;P1_GWSM0&quot;
comma
l_string|&quot;P1_GWSM1&quot;
comma
l_string|&quot;P1_GWSM2&quot;
comma
l_string|&quot;P1_GWSM3&quot;
comma
l_string|&quot;P1_GTBA0&quot;
comma
l_string|&quot;P1_GTBA1&quot;
comma
l_string|&quot;P1_GTBA2&quot;
comma
l_string|&quot;P1_GTBA3&quot;
comma
l_int|NULL
)brace
suffix:semicolon
DECL|variable|el_titan_memory_extended_annotation
r_static
r_char
op_star
id|el_titan_memory_extended_annotation
(braket
)braket
op_assign
(brace
l_string|&quot;Subpacket Header&quot;
comma
l_string|&quot;AAR0&quot;
comma
l_string|&quot;AAR1&quot;
comma
l_string|&quot;AAR2&quot;
comma
l_string|&quot;AAR3&quot;
comma
l_string|&quot;P0_SCTL&quot;
comma
l_string|&quot;P0_GPCTL&quot;
comma
l_string|&quot;P0_APCTL&quot;
comma
l_string|&quot;P1_SCTL&quot;
comma
l_string|&quot;P1_GPCTL&quot;
comma
l_string|&quot;P1_SCTL&quot;
comma
l_int|NULL
)brace
suffix:semicolon
DECL|variable|el_titan_annotations
r_static
r_struct
id|el_subpacket_annotation
id|el_titan_annotations
(braket
)braket
op_assign
(brace
id|SUBPACKET_ANNOTATION
c_func
(paren
id|EL_CLASS__REGATTA_FAMILY
comma
id|EL_TYPE__REGATTA__TITAN_PCHIP0_EXTENDED
comma
l_int|1
comma
l_string|&quot;Titan PChip 0 Extended Frame&quot;
comma
id|el_titan_pchip0_extended_annotation
)paren
comma
id|SUBPACKET_ANNOTATION
c_func
(paren
id|EL_CLASS__REGATTA_FAMILY
comma
id|EL_TYPE__REGATTA__TITAN_PCHIP1_EXTENDED
comma
l_int|1
comma
l_string|&quot;Titan PChip 1 Extended Frame&quot;
comma
id|el_titan_pchip1_extended_annotation
)paren
comma
id|SUBPACKET_ANNOTATION
c_func
(paren
id|EL_CLASS__REGATTA_FAMILY
comma
id|EL_TYPE__REGATTA__TITAN_MEMORY_EXTENDED
comma
l_int|1
comma
l_string|&quot;Titan Memory Extended Frame&quot;
comma
id|el_titan_memory_extended_annotation
)paren
comma
id|SUBPACKET_ANNOTATION
c_func
(paren
id|EL_CLASS__REGATTA_FAMILY
comma
id|EL_TYPE__TERMINATION__TERMINATION
comma
l_int|1
comma
l_string|&quot;Termination Subpacket&quot;
comma
l_int|NULL
)paren
)brace
suffix:semicolon
r_static
r_struct
id|el_subpacket
op_star
DECL|function|el_process_regatta_subpacket
id|el_process_regatta_subpacket
c_func
(paren
r_struct
id|el_subpacket
op_star
id|header
)paren
(brace
r_int
id|status
suffix:semicolon
r_if
c_cond
(paren
id|header
op_member_access_from_pointer
r_class
op_ne
id|EL_CLASS__REGATTA_FAMILY
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s  ** Unexpected header CLASS %d TYPE %d, aborting&bslash;n&quot;
comma
id|err_print_prefix
comma
id|header
op_member_access_from_pointer
r_class
comma
id|header-&gt;type
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|header-&gt;type
)paren
(brace
r_case
id|EL_TYPE__REGATTA__PROCESSOR_ERROR_FRAME
suffix:colon
r_case
id|EL_TYPE__REGATTA__SYSTEM_ERROR_FRAME
suffix:colon
r_case
id|EL_TYPE__REGATTA__ENVIRONMENTAL_FRAME
suffix:colon
r_case
id|EL_TYPE__REGATTA__PROCESSOR_DBL_ERROR_HALT
suffix:colon
r_case
id|EL_TYPE__REGATTA__SYSTEM_DBL_ERROR_HALT
suffix:colon
id|printk
c_func
(paren
l_string|&quot;%s  ** Occurred on CPU %d:&bslash;n&quot;
comma
id|err_print_prefix
comma
(paren
r_int
)paren
id|header-&gt;by_type.regatta_frame.cpuid
)paren
suffix:semicolon
id|status
op_assign
id|privateer_process_logout_frame
c_func
(paren
(paren
r_struct
id|el_common
op_star
)paren
id|header-&gt;by_type.regatta_frame.data_start
comma
l_int|1
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|printk
c_func
(paren
l_string|&quot;%s  ** REGATTA TYPE %d SUBPACKET&bslash;n&quot;
comma
id|err_print_prefix
comma
id|header-&gt;type
)paren
suffix:semicolon
id|el_annotate_subpacket
c_func
(paren
id|header
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_return
(paren
r_struct
id|el_subpacket
op_star
)paren
(paren
(paren
r_int
r_int
)paren
id|header
op_plus
id|header-&gt;length
)paren
suffix:semicolon
)brace
DECL|variable|titan_subpacket_handler
r_static
r_struct
id|el_subpacket_handler
id|titan_subpacket_handler
op_assign
id|SUBPACKET_HANDLER_INIT
c_func
(paren
id|EL_CLASS__REGATTA_FAMILY
comma
id|el_process_regatta_subpacket
)paren
suffix:semicolon
r_void
DECL|function|titan_register_error_handlers
id|titan_register_error_handlers
c_func
(paren
r_void
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|ARRAY_SIZE
(paren
id|el_titan_annotations
)paren
suffix:semicolon
id|i
op_increment
)paren
id|cdl_register_subpacket_annotation
c_func
(paren
op_amp
id|el_titan_annotations
(braket
id|i
)braket
)paren
suffix:semicolon
id|cdl_register_subpacket_handler
c_func
(paren
op_amp
id|titan_subpacket_handler
)paren
suffix:semicolon
id|ev6_register_error_handlers
c_func
(paren
)paren
suffix:semicolon
)brace
"&f;"
multiline_comment|/*&n; * Privateer&n; */
r_static
r_int
DECL|function|privateer_process_680_frame
id|privateer_process_680_frame
c_func
(paren
r_struct
id|el_common
op_star
id|mchk_header
comma
r_int
id|print
)paren
(brace
r_int
id|status
op_assign
id|MCHK_DISPOSITION_UNKNOWN_ERROR
suffix:semicolon
macro_line|#ifdef CONFIG_VERBOSE_MCHECK
r_struct
id|el_PRIVATEER_envdata_mcheck
op_star
id|emchk
op_assign
(paren
r_struct
id|el_PRIVATEER_envdata_mcheck
op_star
)paren
(paren
(paren
r_int
r_int
)paren
id|mchk_header
op_plus
id|mchk_header-&gt;sys_offset
)paren
suffix:semicolon
multiline_comment|/* TODO - catagorize errors, for now, no error */
r_if
c_cond
(paren
op_logical_neg
id|print
)paren
r_return
id|status
suffix:semicolon
multiline_comment|/* TODO - decode instead of just dumping... */
id|printk
c_func
(paren
l_string|&quot;%s  Summary Flags:         %016lx&bslash;n&quot;
l_string|&quot;  CChip DIRx:            %016lx&bslash;n&quot;
l_string|&quot;  System Management IR:  %016lx&bslash;n&quot;
l_string|&quot;  CPU IR:                %016lx&bslash;n&quot;
l_string|&quot;  Power Supply IR:       %016lx&bslash;n&quot;
l_string|&quot;  LM78 Fault Status:     %016lx&bslash;n&quot;
l_string|&quot;  System Doors:          %016lx&bslash;n&quot;
l_string|&quot;  Temperature Warning:   %016lx&bslash;n&quot;
l_string|&quot;  Fan Control:           %016lx&bslash;n&quot;
l_string|&quot;  Fatal Power Down Code: %016lx&bslash;n&quot;
comma
id|err_print_prefix
comma
id|emchk-&gt;summary
comma
id|emchk-&gt;c_dirx
comma
id|emchk-&gt;smir
comma
id|emchk-&gt;cpuir
comma
id|emchk-&gt;psir
comma
id|emchk-&gt;fault
comma
id|emchk-&gt;sys_doors
comma
id|emchk-&gt;temp_warn
comma
id|emchk-&gt;fan_ctrl
comma
id|emchk-&gt;code
)paren
suffix:semicolon
macro_line|#endif /* CONFIG_VERBOSE_MCHECK */
r_return
id|status
suffix:semicolon
)brace
r_int
DECL|function|privateer_process_logout_frame
id|privateer_process_logout_frame
c_func
(paren
r_struct
id|el_common
op_star
id|mchk_header
comma
r_int
id|print
)paren
(brace
r_struct
id|el_common_EV6_mcheck
op_star
id|ev6mchk
op_assign
(paren
r_struct
id|el_common_EV6_mcheck
op_star
)paren
id|mchk_header
suffix:semicolon
r_int
id|status
op_assign
id|MCHK_DISPOSITION_UNKNOWN_ERROR
suffix:semicolon
multiline_comment|/*&n;&t; * Machine check codes&n;&t; */
DECL|macro|PRIVATEER_MCHK__CORR_ECC
mdefine_line|#define PRIVATEER_MCHK__CORR_ECC&t;&t;0x86&t;/* 630 */
DECL|macro|PRIVATEER_MCHK__DC_TAG_PERR
mdefine_line|#define PRIVATEER_MCHK__DC_TAG_PERR&t;&t;0x9E&t;/* 630 */
DECL|macro|PRIVATEER_MCHK__PAL_BUGCHECK
mdefine_line|#define PRIVATEER_MCHK__PAL_BUGCHECK&t;&t;0x8E&t;/* 670 */
DECL|macro|PRIVATEER_MCHK__OS_BUGCHECK
mdefine_line|#define PRIVATEER_MCHK__OS_BUGCHECK&t;&t;0x90&t;/* 670 */
DECL|macro|PRIVATEER_MCHK__PROC_HRD_ERR
mdefine_line|#define PRIVATEER_MCHK__PROC_HRD_ERR&t;&t;0x98&t;/* 670 */
DECL|macro|PRIVATEER_MCHK__ISTREAM_CMOV_PRX
mdefine_line|#define PRIVATEER_MCHK__ISTREAM_CMOV_PRX&t;0xA0&t;/* 670 */
DECL|macro|PRIVATEER_MCHK__ISTREAM_CMOV_FLT
mdefine_line|#define PRIVATEER_MCHK__ISTREAM_CMOV_FLT&t;0xA2&t;/* 670 */
DECL|macro|PRIVATEER_MCHK__SYS_HRD_ERR
mdefine_line|#define PRIVATEER_MCHK__SYS_HRD_ERR&t;&t;0x202&t;/* 660 */
DECL|macro|PRIVATEER_MCHK__SYS_CORR_ERR
mdefine_line|#define PRIVATEER_MCHK__SYS_CORR_ERR&t;&t;0x204&t;/* 620 */
DECL|macro|PRIVATEER_MCHK__SYS_ENVIRON
mdefine_line|#define PRIVATEER_MCHK__SYS_ENVIRON&t;&t;0x206&t;/* 680 */
r_switch
c_cond
(paren
id|ev6mchk-&gt;MCHK_Code
)paren
(brace
multiline_comment|/*&n;&t; * Vector 630 - Processor, Correctable&n;&t; */
r_case
id|PRIVATEER_MCHK__CORR_ECC
suffix:colon
r_case
id|PRIVATEER_MCHK__DC_TAG_PERR
suffix:colon
multiline_comment|/*&n;&t;&t; * Fall through to vector 670 for processing...&n;&t;&t; */
multiline_comment|/*&n;&t; * Vector 670 - Processor, Uncorrectable&n;&t; */
r_case
id|PRIVATEER_MCHK__PAL_BUGCHECK
suffix:colon
r_case
id|PRIVATEER_MCHK__OS_BUGCHECK
suffix:colon
r_case
id|PRIVATEER_MCHK__PROC_HRD_ERR
suffix:colon
r_case
id|PRIVATEER_MCHK__ISTREAM_CMOV_PRX
suffix:colon
r_case
id|PRIVATEER_MCHK__ISTREAM_CMOV_FLT
suffix:colon
id|status
op_or_assign
id|ev6_process_logout_frame
c_func
(paren
id|mchk_header
comma
id|print
)paren
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/*&n;&t; * Vector 620 - System, Correctable&n;&t; */
r_case
id|PRIVATEER_MCHK__SYS_CORR_ERR
suffix:colon
multiline_comment|/*&n;&t;&t; * Fall through to vector 660 for processing...&n;&t;&t; */
multiline_comment|/*&n;&t; * Vector 660 - System, Uncorrectable&n;&t; */
r_case
id|PRIVATEER_MCHK__SYS_HRD_ERR
suffix:colon
id|status
op_or_assign
id|titan_process_logout_frame
c_func
(paren
id|mchk_header
comma
id|print
)paren
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* &n;&t; * Vector 680 - System, Environmental&n;&t; */
r_case
id|PRIVATEER_MCHK__SYS_ENVIRON
suffix:colon
multiline_comment|/* System, Environmental */
id|status
op_or_assign
id|privateer_process_680_frame
c_func
(paren
id|mchk_header
comma
id|print
)paren
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* &n;&t; * Unknown&n;&t; */
r_default
suffix:colon
id|status
op_or_assign
id|MCHK_DISPOSITION_REPORT
suffix:semicolon
r_if
c_cond
(paren
id|print
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s** Unknown Error, frame follows&bslash;n&quot;
comma
id|err_print_prefix
)paren
suffix:semicolon
id|mchk_dump_logout_frame
c_func
(paren
id|mchk_header
)paren
suffix:semicolon
)brace
)brace
r_return
id|status
suffix:semicolon
)brace
r_void
DECL|function|privateer_machine_check
id|privateer_machine_check
c_func
(paren
id|u64
id|vector
comma
id|u64
id|la_ptr
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
r_struct
id|el_common
op_star
id|mchk_header
op_assign
(paren
r_struct
id|el_common
op_star
)paren
id|la_ptr
suffix:semicolon
r_struct
id|el_TITAN_sysdata_mcheck
op_star
id|tmchk
op_assign
(paren
r_struct
id|el_TITAN_sysdata_mcheck
op_star
)paren
(paren
id|la_ptr
op_plus
id|mchk_header-&gt;sys_offset
)paren
suffix:semicolon
id|u64
id|irqmask
suffix:semicolon
r_char
op_star
id|saved_err_prefix
op_assign
id|err_print_prefix
suffix:semicolon
DECL|macro|PRIVATEER_680_INTERRUPT_MASK
mdefine_line|#define PRIVATEER_680_INTERRUPT_MASK&t;&t;(0xE00UL)
DECL|macro|PRIVATEER_HOTPLUG_INTERRUPT_MASK
mdefine_line|#define PRIVATEER_HOTPLUG_INTERRUPT_MASK&t;(0xE00UL)
multiline_comment|/*&n;&t; * Sync the processor.&n;&t; */
id|mb
c_func
(paren
)paren
suffix:semicolon
id|draina
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/* &n;&t; * Only handle system events here.&n;&t; */
r_if
c_cond
(paren
id|vector
op_ne
id|SCB_Q_SYSEVENT
)paren
r_return
id|titan_machine_check
c_func
(paren
id|vector
comma
id|la_ptr
comma
id|regs
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * Report the event - System Events should be reported even if no&n;&t; * error is indicated since the event could indicate the return&n;&t; * to normal status.&n;&t; */
id|err_print_prefix
op_assign
id|KERN_CRIT
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s*System Event (Vector 0x%x) reported on CPU %d:&bslash;n&quot;
comma
id|err_print_prefix
comma
(paren
r_int
r_int
)paren
id|vector
comma
(paren
r_int
)paren
id|smp_processor_id
c_func
(paren
)paren
)paren
suffix:semicolon
id|privateer_process_680_frame
c_func
(paren
id|mchk_header
comma
l_int|1
)paren
suffix:semicolon
id|err_print_prefix
op_assign
id|saved_err_prefix
suffix:semicolon
multiline_comment|/* &n;&t; * Convert any pending interrupts which report as 680 machine&n;&t; * checks to interrupts.&n;&t; */
id|irqmask
op_assign
id|tmchk-&gt;c_dirx
op_amp
id|PRIVATEER_680_INTERRUPT_MASK
suffix:semicolon
multiline_comment|/*&n;&t; * Dispatch the interrupt(s).&n;&t; */
id|titan_dispatch_irqs
c_func
(paren
id|irqmask
comma
id|regs
)paren
suffix:semicolon
multiline_comment|/* &n;&t; * Release the logout frame.&n;&t; */
id|wrmces
c_func
(paren
l_int|0x7
)paren
suffix:semicolon
id|mb
c_func
(paren
)paren
suffix:semicolon
)brace
eof
