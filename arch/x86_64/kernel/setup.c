multiline_comment|/*&n; *  linux/arch/x86-64/kernel/setup.c&n; *&n; *  Copyright (C) 1995  Linus Torvalds&n; *&n; *  Nov 2001 Dave Jones &lt;davej@suse.de&gt;&n; *  Forked from i386 setup code.&n; *&n; *  $Id$&n; */
multiline_comment|/*&n; * This file handles the architecture-dependent parts of initialization&n; */
macro_line|#include &lt;linux/errno.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;linux/stddef.h&gt;
macro_line|#include &lt;linux/unistd.h&gt;
macro_line|#include &lt;linux/ptrace.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;linux/user.h&gt;
macro_line|#include &lt;linux/a.out.h&gt;
macro_line|#include &lt;linux/tty.h&gt;
macro_line|#include &lt;linux/ioport.h&gt;
macro_line|#include &lt;linux/delay.h&gt;
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/initrd.h&gt;
macro_line|#include &lt;linux/highmem.h&gt;
macro_line|#include &lt;linux/bootmem.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;asm/processor.h&gt;
macro_line|#include &lt;linux/console.h&gt;
macro_line|#include &lt;linux/seq_file.h&gt;
macro_line|#include &lt;linux/root_dev.h&gt;
macro_line|#include &lt;linux/pci.h&gt;
macro_line|#include &lt;linux/acpi.h&gt;
macro_line|#include &lt;linux/kallsyms.h&gt;
macro_line|#include &lt;linux/edd.h&gt;
macro_line|#include &lt;asm/mtrr.h&gt;
macro_line|#include &lt;asm/uaccess.h&gt;
macro_line|#include &lt;asm/system.h&gt;
macro_line|#include &lt;asm/io.h&gt;
macro_line|#include &lt;asm/smp.h&gt;
macro_line|#include &lt;asm/msr.h&gt;
macro_line|#include &lt;asm/desc.h&gt;
macro_line|#include &lt;video/edid.h&gt;
macro_line|#include &lt;asm/e820.h&gt;
macro_line|#include &lt;asm/dma.h&gt;
macro_line|#include &lt;asm/mpspec.h&gt;
macro_line|#include &lt;asm/mmu_context.h&gt;
macro_line|#include &lt;asm/bootsetup.h&gt;
macro_line|#include &lt;asm/smp.h&gt;
macro_line|#include &lt;asm/proto.h&gt;
macro_line|#include &lt;asm/setup.h&gt;
multiline_comment|/*&n; * Machine setup..&n; */
DECL|variable|boot_cpu_data
r_struct
id|cpuinfo_x86
id|boot_cpu_data
suffix:semicolon
DECL|variable|mmu_cr4_features
r_int
r_int
id|mmu_cr4_features
suffix:semicolon
DECL|variable|mmu_cr4_features
id|EXPORT_SYMBOL_GPL
c_func
(paren
id|mmu_cr4_features
)paren
suffix:semicolon
DECL|variable|acpi_disabled
r_int
id|acpi_disabled
suffix:semicolon
DECL|variable|acpi_disabled
id|EXPORT_SYMBOL
c_func
(paren
id|acpi_disabled
)paren
suffix:semicolon
macro_line|#ifdef&t;CONFIG_ACPI_BOOT
r_extern
r_int
id|__initdata
id|acpi_ht
suffix:semicolon
r_extern
id|acpi_interrupt_flags
id|acpi_sci_flags
suffix:semicolon
DECL|variable|acpi_force
r_int
id|__initdata
id|acpi_force
op_assign
l_int|0
suffix:semicolon
macro_line|#endif
multiline_comment|/* For PCI or other memory-mapped resources */
DECL|variable|pci_mem_start
r_int
r_int
id|pci_mem_start
op_assign
l_int|0x10000000
suffix:semicolon
DECL|variable|saved_video_mode
r_int
r_int
id|saved_video_mode
suffix:semicolon
macro_line|#ifdef CONFIG_SWIOTLB
DECL|variable|swiotlb
r_int
id|swiotlb
suffix:semicolon
DECL|variable|swiotlb
id|EXPORT_SYMBOL
c_func
(paren
id|swiotlb
)paren
suffix:semicolon
macro_line|#endif
multiline_comment|/*&n; * Setup options&n; */
DECL|struct|drive_info_struct
DECL|member|dummy
DECL|variable|drive_info
r_struct
id|drive_info_struct
(brace
r_char
id|dummy
(braket
l_int|32
)braket
suffix:semicolon
)brace
id|drive_info
suffix:semicolon
DECL|variable|screen_info
r_struct
id|screen_info
id|screen_info
suffix:semicolon
DECL|struct|sys_desc_table_struct
r_struct
id|sys_desc_table_struct
(brace
DECL|member|length
r_int
r_int
id|length
suffix:semicolon
DECL|member|table
r_int
r_char
id|table
(braket
l_int|0
)braket
suffix:semicolon
)brace
suffix:semicolon
DECL|variable|edid_info
r_struct
id|edid_info
id|edid_info
suffix:semicolon
DECL|variable|e820
r_struct
id|e820map
id|e820
suffix:semicolon
DECL|variable|aux_device_present
r_int
r_char
id|aux_device_present
suffix:semicolon
r_extern
r_int
id|root_mountflags
suffix:semicolon
r_extern
r_char
id|_text
comma
id|_etext
comma
id|_edata
comma
id|_end
suffix:semicolon
DECL|variable|command_line
r_char
id|command_line
(braket
id|COMMAND_LINE_SIZE
)braket
suffix:semicolon
DECL|variable|standard_io_resources
r_struct
id|resource
id|standard_io_resources
(braket
)braket
op_assign
(brace
(brace
l_string|&quot;dma1&quot;
comma
l_int|0x00
comma
l_int|0x1f
comma
id|IORESOURCE_BUSY
op_or
id|IORESOURCE_IO
)brace
comma
(brace
l_string|&quot;pic1&quot;
comma
l_int|0x20
comma
l_int|0x21
comma
id|IORESOURCE_BUSY
op_or
id|IORESOURCE_IO
)brace
comma
(brace
l_string|&quot;timer0&quot;
comma
l_int|0x40
comma
l_int|0x43
comma
id|IORESOURCE_BUSY
op_or
id|IORESOURCE_IO
)brace
comma
(brace
l_string|&quot;timer1&quot;
comma
l_int|0x50
comma
l_int|0x53
comma
id|IORESOURCE_BUSY
op_or
id|IORESOURCE_IO
)brace
comma
(brace
l_string|&quot;keyboard&quot;
comma
l_int|0x60
comma
l_int|0x6f
comma
id|IORESOURCE_BUSY
op_or
id|IORESOURCE_IO
)brace
comma
(brace
l_string|&quot;dma page reg&quot;
comma
l_int|0x80
comma
l_int|0x8f
comma
id|IORESOURCE_BUSY
op_or
id|IORESOURCE_IO
)brace
comma
(brace
l_string|&quot;pic2&quot;
comma
l_int|0xa0
comma
l_int|0xa1
comma
id|IORESOURCE_BUSY
op_or
id|IORESOURCE_IO
)brace
comma
(brace
l_string|&quot;dma2&quot;
comma
l_int|0xc0
comma
l_int|0xdf
comma
id|IORESOURCE_BUSY
op_or
id|IORESOURCE_IO
)brace
comma
(brace
l_string|&quot;fpu&quot;
comma
l_int|0xf0
comma
l_int|0xff
comma
id|IORESOURCE_BUSY
op_or
id|IORESOURCE_IO
)brace
)brace
suffix:semicolon
DECL|macro|STANDARD_IO_RESOURCES
mdefine_line|#define STANDARD_IO_RESOURCES &bslash;&n;&t;(sizeof standard_io_resources / sizeof standard_io_resources[0])
DECL|macro|IORESOURCE_RAM
mdefine_line|#define IORESOURCE_RAM (IORESOURCE_BUSY | IORESOURCE_MEM)
DECL|variable|data_resource
r_struct
id|resource
id|data_resource
op_assign
(brace
l_string|&quot;Kernel data&quot;
comma
l_int|0
comma
l_int|0
comma
id|IORESOURCE_RAM
)brace
suffix:semicolon
DECL|variable|code_resource
r_struct
id|resource
id|code_resource
op_assign
(brace
l_string|&quot;Kernel code&quot;
comma
l_int|0
comma
l_int|0
comma
id|IORESOURCE_RAM
)brace
suffix:semicolon
DECL|macro|IORESOURCE_ROM
mdefine_line|#define IORESOURCE_ROM (IORESOURCE_BUSY | IORESOURCE_READONLY | IORESOURCE_MEM)
DECL|variable|system_rom_resource
r_static
r_struct
id|resource
id|system_rom_resource
op_assign
(brace
l_string|&quot;System ROM&quot;
comma
l_int|0xf0000
comma
l_int|0xfffff
comma
id|IORESOURCE_ROM
)brace
suffix:semicolon
DECL|variable|extension_rom_resource
r_static
r_struct
id|resource
id|extension_rom_resource
op_assign
(brace
l_string|&quot;Extension ROM&quot;
comma
l_int|0xe0000
comma
l_int|0xeffff
comma
id|IORESOURCE_ROM
)brace
suffix:semicolon
DECL|variable|adapter_rom_resources
r_static
r_struct
id|resource
id|adapter_rom_resources
(braket
)braket
op_assign
(brace
(brace
l_string|&quot;Adapter ROM&quot;
comma
l_int|0xc8000
comma
l_int|0
comma
id|IORESOURCE_ROM
)brace
comma
(brace
l_string|&quot;Adapter ROM&quot;
comma
l_int|0
comma
l_int|0
comma
id|IORESOURCE_ROM
)brace
comma
(brace
l_string|&quot;Adapter ROM&quot;
comma
l_int|0
comma
l_int|0
comma
id|IORESOURCE_ROM
)brace
comma
(brace
l_string|&quot;Adapter ROM&quot;
comma
l_int|0
comma
l_int|0
comma
id|IORESOURCE_ROM
)brace
comma
(brace
l_string|&quot;Adapter ROM&quot;
comma
l_int|0
comma
l_int|0
comma
id|IORESOURCE_ROM
)brace
comma
(brace
l_string|&quot;Adapter ROM&quot;
comma
l_int|0
comma
l_int|0
comma
id|IORESOURCE_ROM
)brace
)brace
suffix:semicolon
DECL|macro|ADAPTER_ROM_RESOURCES
mdefine_line|#define ADAPTER_ROM_RESOURCES &bslash;&n;&t;(sizeof adapter_rom_resources / sizeof adapter_rom_resources[0])
DECL|variable|video_rom_resource
r_static
r_struct
id|resource
id|video_rom_resource
op_assign
(brace
l_string|&quot;Video ROM&quot;
comma
l_int|0xc0000
comma
l_int|0xc7fff
comma
id|IORESOURCE_ROM
)brace
suffix:semicolon
DECL|variable|video_ram_resource
r_static
r_struct
id|resource
id|video_ram_resource
op_assign
(brace
l_string|&quot;Video RAM area&quot;
comma
l_int|0xa0000
comma
l_int|0xbffff
comma
id|IORESOURCE_RAM
)brace
suffix:semicolon
DECL|macro|romsignature
mdefine_line|#define romsignature(x) (*(unsigned short *)(x) == 0xaa55)
DECL|function|romchecksum
r_static
r_int
id|__init
id|romchecksum
c_func
(paren
r_int
r_char
op_star
id|rom
comma
r_int
r_int
id|length
)paren
(brace
r_int
r_char
op_star
id|p
comma
id|sum
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|p
op_assign
id|rom
suffix:semicolon
id|p
OL
id|rom
op_plus
id|length
suffix:semicolon
id|p
op_increment
)paren
id|sum
op_add_assign
op_star
id|p
suffix:semicolon
r_return
id|sum
op_eq
l_int|0
suffix:semicolon
)brace
DECL|function|probe_roms
r_static
r_void
id|__init
id|probe_roms
c_func
(paren
r_void
)paren
(brace
r_int
r_int
id|start
comma
id|length
comma
id|upper
suffix:semicolon
r_int
r_char
op_star
id|rom
suffix:semicolon
r_int
id|i
suffix:semicolon
multiline_comment|/* video rom */
id|upper
op_assign
id|adapter_rom_resources
(braket
l_int|0
)braket
dot
id|start
suffix:semicolon
r_for
c_loop
(paren
id|start
op_assign
id|video_rom_resource.start
suffix:semicolon
id|start
OL
id|upper
suffix:semicolon
id|start
op_add_assign
l_int|2048
)paren
(brace
id|rom
op_assign
id|isa_bus_to_virt
c_func
(paren
id|start
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|romsignature
c_func
(paren
id|rom
)paren
)paren
r_continue
suffix:semicolon
id|video_rom_resource.start
op_assign
id|start
suffix:semicolon
multiline_comment|/* 0 &lt; length &lt;= 0x7f * 512, historically */
id|length
op_assign
id|rom
(braket
l_int|2
)braket
op_star
l_int|512
suffix:semicolon
multiline_comment|/* if checksum okay, trust length byte */
r_if
c_cond
(paren
id|length
op_logical_and
id|romchecksum
c_func
(paren
id|rom
comma
id|length
)paren
)paren
id|video_rom_resource.end
op_assign
id|start
op_plus
id|length
op_minus
l_int|1
suffix:semicolon
id|request_resource
c_func
(paren
op_amp
id|iomem_resource
comma
op_amp
id|video_rom_resource
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|start
op_assign
(paren
id|video_rom_resource.end
op_plus
l_int|1
op_plus
l_int|2047
)paren
op_amp
op_complement
l_int|2047UL
suffix:semicolon
r_if
c_cond
(paren
id|start
OL
id|upper
)paren
id|start
op_assign
id|upper
suffix:semicolon
multiline_comment|/* system rom */
id|request_resource
c_func
(paren
op_amp
id|iomem_resource
comma
op_amp
id|system_rom_resource
)paren
suffix:semicolon
id|upper
op_assign
id|system_rom_resource.start
suffix:semicolon
multiline_comment|/* check for extension rom (ignore length byte!) */
id|rom
op_assign
id|isa_bus_to_virt
c_func
(paren
id|extension_rom_resource.start
)paren
suffix:semicolon
r_if
c_cond
(paren
id|romsignature
c_func
(paren
id|rom
)paren
)paren
(brace
id|length
op_assign
id|extension_rom_resource.end
op_minus
id|extension_rom_resource.start
op_plus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|romchecksum
c_func
(paren
id|rom
comma
id|length
)paren
)paren
(brace
id|request_resource
c_func
(paren
op_amp
id|iomem_resource
comma
op_amp
id|extension_rom_resource
)paren
suffix:semicolon
id|upper
op_assign
id|extension_rom_resource.start
suffix:semicolon
)brace
)brace
multiline_comment|/* check for adapter roms on 2k boundaries */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|ADAPTER_ROM_RESOURCES
op_logical_and
id|start
OL
id|upper
suffix:semicolon
id|start
op_add_assign
l_int|2048
)paren
(brace
id|rom
op_assign
id|isa_bus_to_virt
c_func
(paren
id|start
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|romsignature
c_func
(paren
id|rom
)paren
)paren
r_continue
suffix:semicolon
multiline_comment|/* 0 &lt; length &lt;= 0x7f * 512, historically */
id|length
op_assign
id|rom
(braket
l_int|2
)braket
op_star
l_int|512
suffix:semicolon
multiline_comment|/* but accept any length that fits if checksum okay */
r_if
c_cond
(paren
op_logical_neg
id|length
op_logical_or
id|start
op_plus
id|length
OG
id|upper
op_logical_or
op_logical_neg
id|romchecksum
c_func
(paren
id|rom
comma
id|length
)paren
)paren
r_continue
suffix:semicolon
id|adapter_rom_resources
(braket
id|i
)braket
dot
id|start
op_assign
id|start
suffix:semicolon
id|adapter_rom_resources
(braket
id|i
)braket
dot
id|end
op_assign
id|start
op_plus
id|length
op_minus
l_int|1
suffix:semicolon
id|request_resource
c_func
(paren
op_amp
id|iomem_resource
comma
op_amp
id|adapter_rom_resources
(braket
id|i
)braket
)paren
suffix:semicolon
id|start
op_assign
id|adapter_rom_resources
(braket
id|i
op_increment
)braket
dot
id|end
op_amp
op_complement
l_int|2047UL
suffix:semicolon
)brace
)brace
DECL|function|parse_cmdline_early
r_static
id|__init
r_void
id|parse_cmdline_early
(paren
r_char
op_star
op_star
id|cmdline_p
)paren
(brace
r_char
id|c
op_assign
l_char|&squot; &squot;
comma
op_star
id|to
op_assign
id|command_line
comma
op_star
id|from
op_assign
id|COMMAND_LINE
suffix:semicolon
r_int
id|len
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* Save unparsed command line copy for /proc/cmdline */
id|memcpy
c_func
(paren
id|saved_command_line
comma
id|COMMAND_LINE
comma
id|COMMAND_LINE_SIZE
)paren
suffix:semicolon
id|saved_command_line
(braket
id|COMMAND_LINE_SIZE
op_minus
l_int|1
)braket
op_assign
l_char|&squot;&bslash;0&squot;
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
suffix:semicolon
)paren
(brace
r_if
c_cond
(paren
id|c
op_ne
l_char|&squot; &squot;
)paren
r_goto
id|next_char
suffix:semicolon
macro_line|#ifdef  CONFIG_SMP
multiline_comment|/*&n;&t;&t; * If the BIOS enumerates physical processors before logical,&n;&t;&t; * maxcpus=N at enumeration-time can be used to disable HT.&n;&t;&t; */
r_else
r_if
c_cond
(paren
op_logical_neg
id|memcmp
c_func
(paren
id|from
comma
l_string|&quot;maxcpus=&quot;
comma
l_int|8
)paren
)paren
(brace
r_extern
r_int
r_int
id|maxcpus
suffix:semicolon
id|maxcpus
op_assign
id|simple_strtoul
c_func
(paren
id|from
op_plus
l_int|8
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
)brace
macro_line|#endif
macro_line|#ifdef CONFIG_ACPI_BOOT
multiline_comment|/* &quot;acpi=off&quot; disables both ACPI table parsing and interpreter init */
r_if
c_cond
(paren
op_logical_neg
id|memcmp
c_func
(paren
id|from
comma
l_string|&quot;acpi=off&quot;
comma
l_int|8
)paren
)paren
id|disable_acpi
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|memcmp
c_func
(paren
id|from
comma
l_string|&quot;acpi=force&quot;
comma
l_int|10
)paren
)paren
(brace
multiline_comment|/* add later when we do DMI horrors: */
id|acpi_force
op_assign
l_int|1
suffix:semicolon
id|acpi_disabled
op_assign
l_int|0
suffix:semicolon
)brace
multiline_comment|/* acpi=ht just means: do ACPI MADT parsing &n;&t;&t;   at bootup, but don&squot;t enable the full ACPI interpreter */
r_if
c_cond
(paren
op_logical_neg
id|memcmp
c_func
(paren
id|from
comma
l_string|&quot;acpi=ht&quot;
comma
l_int|7
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|acpi_force
)paren
id|disable_acpi
c_func
(paren
)paren
suffix:semicolon
id|acpi_ht
op_assign
l_int|1
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|memcmp
c_func
(paren
id|from
comma
l_string|&quot;pci=noacpi&quot;
comma
l_int|10
)paren
)paren
id|acpi_disable_pci
c_func
(paren
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|memcmp
c_func
(paren
id|from
comma
l_string|&quot;acpi=noirq&quot;
comma
l_int|10
)paren
)paren
id|acpi_noirq_set
c_func
(paren
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|memcmp
c_func
(paren
id|from
comma
l_string|&quot;acpi_sci=edge&quot;
comma
l_int|13
)paren
)paren
id|acpi_sci_flags.trigger
op_assign
l_int|1
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|memcmp
c_func
(paren
id|from
comma
l_string|&quot;acpi_sci=level&quot;
comma
l_int|14
)paren
)paren
id|acpi_sci_flags.trigger
op_assign
l_int|3
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|memcmp
c_func
(paren
id|from
comma
l_string|&quot;acpi_sci=high&quot;
comma
l_int|13
)paren
)paren
id|acpi_sci_flags.polarity
op_assign
l_int|1
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|memcmp
c_func
(paren
id|from
comma
l_string|&quot;acpi_sci=low&quot;
comma
l_int|12
)paren
)paren
id|acpi_sci_flags.polarity
op_assign
l_int|3
suffix:semicolon
multiline_comment|/* acpi=strict disables out-of-spec workarounds */
r_else
r_if
c_cond
(paren
op_logical_neg
id|memcmp
c_func
(paren
id|from
comma
l_string|&quot;acpi=strict&quot;
comma
l_int|11
)paren
)paren
(brace
id|acpi_strict
op_assign
l_int|1
suffix:semicolon
)brace
macro_line|#endif
r_if
c_cond
(paren
op_logical_neg
id|memcmp
c_func
(paren
id|from
comma
l_string|&quot;nolapic&quot;
comma
l_int|7
)paren
op_logical_or
op_logical_neg
id|memcmp
c_func
(paren
id|from
comma
l_string|&quot;disableapic&quot;
comma
l_int|11
)paren
)paren
id|disable_apic
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|memcmp
c_func
(paren
id|from
comma
l_string|&quot;noapic&quot;
comma
l_int|6
)paren
)paren
id|skip_ioapic_setup
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|memcmp
c_func
(paren
id|from
comma
l_string|&quot;apic&quot;
comma
l_int|4
)paren
)paren
(brace
id|skip_ioapic_setup
op_assign
l_int|0
suffix:semicolon
id|ioapic_force
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|memcmp
c_func
(paren
id|from
comma
l_string|&quot;mem=&quot;
comma
l_int|4
)paren
)paren
id|parse_memopt
c_func
(paren
id|from
op_plus
l_int|4
comma
op_amp
id|from
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_DISCONTIGMEM
r_if
c_cond
(paren
op_logical_neg
id|memcmp
c_func
(paren
id|from
comma
l_string|&quot;numa=&quot;
comma
l_int|5
)paren
)paren
id|numa_setup
c_func
(paren
id|from
op_plus
l_int|5
)paren
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_GART_IOMMU 
r_if
c_cond
(paren
op_logical_neg
id|memcmp
c_func
(paren
id|from
comma
l_string|&quot;iommu=&quot;
comma
l_int|6
)paren
)paren
(brace
id|iommu_setup
c_func
(paren
id|from
op_plus
l_int|6
)paren
suffix:semicolon
)brace
macro_line|#endif
r_if
c_cond
(paren
op_logical_neg
id|memcmp
c_func
(paren
id|from
comma
l_string|&quot;oops=panic&quot;
comma
l_int|10
)paren
)paren
id|panic_on_oops
op_assign
l_int|1
suffix:semicolon
id|next_char
suffix:colon
id|c
op_assign
op_star
(paren
id|from
op_increment
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|c
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
id|COMMAND_LINE_SIZE
op_le
op_increment
id|len
)paren
r_break
suffix:semicolon
op_star
(paren
id|to
op_increment
)paren
op_assign
id|c
suffix:semicolon
)brace
op_star
id|to
op_assign
l_char|&squot;&bslash;0&squot;
suffix:semicolon
op_star
id|cmdline_p
op_assign
id|command_line
suffix:semicolon
)brace
macro_line|#ifndef CONFIG_DISCONTIGMEM
DECL|function|contig_initmem_init
r_static
r_void
id|__init
id|contig_initmem_init
c_func
(paren
r_void
)paren
(brace
r_int
r_int
id|bootmap_size
comma
id|bootmap
suffix:semicolon
id|bootmap_size
op_assign
id|bootmem_bootmap_pages
c_func
(paren
id|end_pfn
)paren
op_lshift
id|PAGE_SHIFT
suffix:semicolon
id|bootmap
op_assign
id|find_e820_area
c_func
(paren
l_int|0
comma
id|end_pfn
op_lshift
id|PAGE_SHIFT
comma
id|bootmap_size
)paren
suffix:semicolon
r_if
c_cond
(paren
id|bootmap
op_eq
op_minus
l_int|1L
)paren
id|panic
c_func
(paren
l_string|&quot;Cannot find bootmem map of size %ld&bslash;n&quot;
comma
id|bootmap_size
)paren
suffix:semicolon
id|bootmap_size
op_assign
id|init_bootmem
c_func
(paren
id|bootmap
op_rshift
id|PAGE_SHIFT
comma
id|end_pfn
)paren
suffix:semicolon
id|e820_bootmem_free
c_func
(paren
op_amp
id|contig_page_data
comma
l_int|0
comma
id|end_pfn
op_lshift
id|PAGE_SHIFT
)paren
suffix:semicolon
id|reserve_bootmem
c_func
(paren
id|bootmap
comma
id|bootmap_size
)paren
suffix:semicolon
)brace
macro_line|#endif
multiline_comment|/* Use inline assembly to define this because the nops are defined &n;   as inline assembly strings in the include files and we cannot &n;   get them easily into strings. */
id|asm
c_func
(paren
l_string|&quot;&bslash;t.data&bslash;nk8nops: &quot;
id|K8_NOP1
id|K8_NOP2
id|K8_NOP3
id|K8_NOP4
id|K8_NOP5
id|K8_NOP6
id|K8_NOP7
id|K8_NOP8
)paren
suffix:semicolon
r_extern
r_int
r_char
id|k8nops
(braket
)braket
suffix:semicolon
DECL|variable|k8_nops
r_static
r_int
r_char
op_star
id|k8_nops
(braket
id|ASM_NOP_MAX
op_plus
l_int|1
)braket
op_assign
(brace
l_int|NULL
comma
id|k8nops
comma
id|k8nops
op_plus
l_int|1
comma
id|k8nops
op_plus
l_int|1
op_plus
l_int|2
comma
id|k8nops
op_plus
l_int|1
op_plus
l_int|2
op_plus
l_int|3
comma
id|k8nops
op_plus
l_int|1
op_plus
l_int|2
op_plus
l_int|3
op_plus
l_int|4
comma
id|k8nops
op_plus
l_int|1
op_plus
l_int|2
op_plus
l_int|3
op_plus
l_int|4
op_plus
l_int|5
comma
id|k8nops
op_plus
l_int|1
op_plus
l_int|2
op_plus
l_int|3
op_plus
l_int|4
op_plus
l_int|5
op_plus
l_int|6
comma
id|k8nops
op_plus
l_int|1
op_plus
l_int|2
op_plus
l_int|3
op_plus
l_int|4
op_plus
l_int|5
op_plus
l_int|6
op_plus
l_int|7
comma
)brace
suffix:semicolon
multiline_comment|/* Replace instructions with better alternatives for this CPU type.&n;&n;   This runs before SMP is initialized to avoid SMP problems with&n;   self modifying code. This implies that assymetric systems where&n;   APs have less capabilities than the boot processor are not handled. &n;   In this case boot with &quot;noreplacement&quot;. */
DECL|function|apply_alternatives
r_void
id|apply_alternatives
c_func
(paren
r_void
op_star
id|start
comma
r_void
op_star
id|end
)paren
(brace
r_struct
id|alt_instr
op_star
id|a
suffix:semicolon
r_int
id|diff
comma
id|i
comma
id|k
suffix:semicolon
r_for
c_loop
(paren
id|a
op_assign
id|start
suffix:semicolon
(paren
r_void
op_star
)paren
id|a
OL
id|end
suffix:semicolon
id|a
op_increment
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|boot_cpu_has
c_func
(paren
id|a-&gt;cpuid
)paren
)paren
r_continue
suffix:semicolon
id|BUG_ON
c_func
(paren
id|a-&gt;replacementlen
OG
id|a-&gt;instrlen
)paren
suffix:semicolon
id|__inline_memcpy
c_func
(paren
id|a-&gt;instr
comma
id|a-&gt;replacement
comma
id|a-&gt;replacementlen
)paren
suffix:semicolon
id|diff
op_assign
id|a-&gt;instrlen
op_minus
id|a-&gt;replacementlen
suffix:semicolon
multiline_comment|/* Pad the rest with nops */
r_for
c_loop
(paren
id|i
op_assign
id|a-&gt;replacementlen
suffix:semicolon
id|diff
OG
l_int|0
suffix:semicolon
id|diff
op_sub_assign
id|k
comma
id|i
op_add_assign
id|k
)paren
(brace
id|k
op_assign
id|diff
suffix:semicolon
r_if
c_cond
(paren
id|k
OG
id|ASM_NOP_MAX
)paren
id|k
op_assign
id|ASM_NOP_MAX
suffix:semicolon
id|__inline_memcpy
c_func
(paren
id|a-&gt;instr
op_plus
id|i
comma
id|k8_nops
(braket
id|k
)braket
comma
id|k
)paren
suffix:semicolon
)brace
)brace
)brace
DECL|variable|__initdata
r_static
r_int
id|no_replacement
id|__initdata
op_assign
l_int|0
suffix:semicolon
DECL|function|alternative_instructions
r_void
id|__init
id|alternative_instructions
c_func
(paren
r_void
)paren
(brace
r_extern
r_struct
id|alt_instr
id|__alt_instructions
(braket
)braket
comma
id|__alt_instructions_end
(braket
)braket
suffix:semicolon
r_if
c_cond
(paren
id|no_replacement
)paren
r_return
suffix:semicolon
id|apply_alternatives
c_func
(paren
id|__alt_instructions
comma
id|__alt_instructions_end
)paren
suffix:semicolon
)brace
DECL|function|noreplacement_setup
r_static
r_int
id|__init
id|noreplacement_setup
c_func
(paren
r_char
op_star
id|s
)paren
(brace
id|no_replacement
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|__setup
c_func
(paren
l_string|&quot;noreplacement&quot;
comma
id|noreplacement_setup
)paren
suffix:semicolon
macro_line|#if defined(CONFIG_EDD) || defined(CONFIG_EDD_MODULE)
DECL|variable|edd
r_struct
id|edd
id|edd
suffix:semicolon
macro_line|#ifdef CONFIG_EDD_MODULE
DECL|variable|edd
id|EXPORT_SYMBOL
c_func
(paren
id|edd
)paren
suffix:semicolon
macro_line|#endif
multiline_comment|/**&n; * copy_edd() - Copy the BIOS EDD information&n; *              from boot_params into a safe place.&n; *&n; */
DECL|function|copy_edd
r_static
r_inline
r_void
id|copy_edd
c_func
(paren
r_void
)paren
(brace
id|memcpy
c_func
(paren
id|edd.mbr_signature
comma
id|EDD_MBR_SIGNATURE
comma
r_sizeof
(paren
id|edd.mbr_signature
)paren
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|edd.edd_info
comma
id|EDD_BUF
comma
r_sizeof
(paren
id|edd.edd_info
)paren
)paren
suffix:semicolon
id|edd.mbr_signature_nr
op_assign
id|EDD_MBR_SIG_NR
suffix:semicolon
id|edd.edd_info_nr
op_assign
id|EDD_NR
suffix:semicolon
)brace
macro_line|#else
DECL|function|copy_edd
r_static
r_inline
r_void
id|copy_edd
c_func
(paren
r_void
)paren
(brace
)brace
macro_line|#endif
DECL|macro|EBDA_ADDR_POINTER
mdefine_line|#define EBDA_ADDR_POINTER 0x40E
DECL|function|reserve_ebda_region
r_static
r_void
id|__init
id|reserve_ebda_region
c_func
(paren
r_void
)paren
(brace
r_int
r_int
id|addr
suffix:semicolon
multiline_comment|/** &n;&t; * there is a real-mode segmented pointer pointing to the &n;&t; * 4K EBDA area at 0x40E&n;&t; */
id|addr
op_assign
op_star
(paren
r_int
r_int
op_star
)paren
id|phys_to_virt
c_func
(paren
id|EBDA_ADDR_POINTER
)paren
suffix:semicolon
id|addr
op_lshift_assign
l_int|4
suffix:semicolon
r_if
c_cond
(paren
id|addr
)paren
id|reserve_bootmem_generic
c_func
(paren
id|addr
comma
id|PAGE_SIZE
)paren
suffix:semicolon
)brace
DECL|function|setup_arch
r_void
id|__init
id|setup_arch
c_func
(paren
r_char
op_star
op_star
id|cmdline_p
)paren
(brace
r_int
r_int
id|low_mem_size
suffix:semicolon
r_int
r_int
id|kernel_end
suffix:semicolon
id|ROOT_DEV
op_assign
id|old_decode_dev
c_func
(paren
id|ORIG_ROOT_DEV
)paren
suffix:semicolon
id|drive_info
op_assign
id|DRIVE_INFO
suffix:semicolon
id|screen_info
op_assign
id|SCREEN_INFO
suffix:semicolon
id|edid_info
op_assign
id|EDID_INFO
suffix:semicolon
id|aux_device_present
op_assign
id|AUX_DEVICE_INFO
suffix:semicolon
id|saved_video_mode
op_assign
id|SAVED_VIDEO_MODE
suffix:semicolon
macro_line|#ifdef CONFIG_BLK_DEV_RAM
id|rd_image_start
op_assign
id|RAMDISK_FLAGS
op_amp
id|RAMDISK_IMAGE_START_MASK
suffix:semicolon
id|rd_prompt
op_assign
(paren
(paren
id|RAMDISK_FLAGS
op_amp
id|RAMDISK_PROMPT_FLAG
)paren
op_ne
l_int|0
)paren
suffix:semicolon
id|rd_doload
op_assign
(paren
(paren
id|RAMDISK_FLAGS
op_amp
id|RAMDISK_LOAD_FLAG
)paren
op_ne
l_int|0
)paren
suffix:semicolon
macro_line|#endif
id|setup_memory_region
c_func
(paren
)paren
suffix:semicolon
id|copy_edd
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|MOUNT_ROOT_RDONLY
)paren
id|root_mountflags
op_and_assign
op_complement
id|MS_RDONLY
suffix:semicolon
id|init_mm.start_code
op_assign
(paren
r_int
r_int
)paren
op_amp
id|_text
suffix:semicolon
id|init_mm.end_code
op_assign
(paren
r_int
r_int
)paren
op_amp
id|_etext
suffix:semicolon
id|init_mm.end_data
op_assign
(paren
r_int
r_int
)paren
op_amp
id|_edata
suffix:semicolon
id|init_mm.brk
op_assign
(paren
r_int
r_int
)paren
op_amp
id|_end
suffix:semicolon
id|code_resource.start
op_assign
id|virt_to_phys
c_func
(paren
op_amp
id|_text
)paren
suffix:semicolon
id|code_resource.end
op_assign
id|virt_to_phys
c_func
(paren
op_amp
id|_etext
)paren
op_minus
l_int|1
suffix:semicolon
id|data_resource.start
op_assign
id|virt_to_phys
c_func
(paren
op_amp
id|_etext
)paren
suffix:semicolon
id|data_resource.end
op_assign
id|virt_to_phys
c_func
(paren
op_amp
id|_edata
)paren
op_minus
l_int|1
suffix:semicolon
id|parse_cmdline_early
c_func
(paren
id|cmdline_p
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * partially used pages are not usable - thus&n;&t; * we are rounding upwards:&n;&t; */
id|end_pfn
op_assign
id|e820_end_of_ram
c_func
(paren
)paren
suffix:semicolon
id|check_efer
c_func
(paren
)paren
suffix:semicolon
id|init_memory_mapping
c_func
(paren
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_DISCONTIGMEM
id|numa_initmem_init
c_func
(paren
l_int|0
comma
id|end_pfn
)paren
suffix:semicolon
macro_line|#else
id|contig_initmem_init
c_func
(paren
)paren
suffix:semicolon
macro_line|#endif
multiline_comment|/* Reserve direct mapping */
id|reserve_bootmem_generic
c_func
(paren
id|table_start
op_lshift
id|PAGE_SHIFT
comma
(paren
id|table_end
op_minus
id|table_start
)paren
op_lshift
id|PAGE_SHIFT
)paren
suffix:semicolon
multiline_comment|/* reserve kernel */
id|kernel_end
op_assign
id|round_up
c_func
(paren
id|__pa_symbol
c_func
(paren
op_amp
id|_end
)paren
comma
id|PAGE_SIZE
)paren
suffix:semicolon
id|reserve_bootmem_generic
c_func
(paren
id|HIGH_MEMORY
comma
id|kernel_end
op_minus
id|HIGH_MEMORY
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * reserve physical page 0 - it&squot;s a special BIOS page on many boxes,&n;&t; * enabling clean reboots, SMP operation, laptop functions.&n;&t; */
id|reserve_bootmem_generic
c_func
(paren
l_int|0
comma
id|PAGE_SIZE
)paren
suffix:semicolon
multiline_comment|/* reserve ebda region */
id|reserve_ebda_region
c_func
(paren
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_SMP
multiline_comment|/*&n;&t; * But first pinch a few for the stack/trampoline stuff&n;&t; * FIXME: Don&squot;t need the extra page at 4K, but need to fix&n;&t; * trampoline before removing it. (see the GDT stuff)&n;&t; */
id|reserve_bootmem_generic
c_func
(paren
id|PAGE_SIZE
comma
id|PAGE_SIZE
)paren
suffix:semicolon
multiline_comment|/* Reserve SMP trampoline */
id|reserve_bootmem_generic
c_func
(paren
id|SMP_TRAMPOLINE_BASE
comma
id|PAGE_SIZE
)paren
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_ACPI_SLEEP
multiline_comment|/*&n;        * Reserve low memory region for sleep support.&n;        */
id|acpi_reserve_bootmem
c_func
(paren
)paren
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_X86_LOCAL_APIC
multiline_comment|/*&n;&t; * Find and reserve possible boot-time SMP configuration:&n;&t; */
id|find_smp_config
c_func
(paren
)paren
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_BLK_DEV_INITRD
r_if
c_cond
(paren
id|LOADER_TYPE
op_logical_and
id|INITRD_START
)paren
(brace
r_if
c_cond
(paren
id|INITRD_START
op_plus
id|INITRD_SIZE
op_le
(paren
id|end_pfn
op_lshift
id|PAGE_SHIFT
)paren
)paren
(brace
id|reserve_bootmem_generic
c_func
(paren
id|INITRD_START
comma
id|INITRD_SIZE
)paren
suffix:semicolon
id|initrd_start
op_assign
id|INITRD_START
ques
c_cond
id|INITRD_START
op_plus
id|PAGE_OFFSET
suffix:colon
l_int|0
suffix:semicolon
id|initrd_end
op_assign
id|initrd_start
op_plus
id|INITRD_SIZE
suffix:semicolon
)brace
r_else
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;initrd extends beyond end of memory &quot;
l_string|&quot;(0x%08lx &gt; 0x%08lx)&bslash;ndisabling initrd&bslash;n&quot;
comma
(paren
r_int
r_int
)paren
(paren
id|INITRD_START
op_plus
id|INITRD_SIZE
)paren
comma
(paren
r_int
r_int
)paren
(paren
id|end_pfn
op_lshift
id|PAGE_SHIFT
)paren
)paren
suffix:semicolon
id|initrd_start
op_assign
l_int|0
suffix:semicolon
)brace
)brace
macro_line|#endif
id|paging_init
c_func
(paren
)paren
suffix:semicolon
id|check_ioapic
c_func
(paren
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_ACPI_BOOT
multiline_comment|/*&n;        * Initialize the ACPI boot-time table parser (gets the RSDP and SDT).&n;        * Must do this after paging_init (due to reliance on fixmap, and thus&n;        * the bootmem allocator) but before get_smp_config (to allow parsing&n;        * of MADT).&n;        */
id|acpi_boot_init
c_func
(paren
)paren
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_X86_LOCAL_APIC
multiline_comment|/*&n;&t; * get boot-time SMP configuration:&n;&t; */
r_if
c_cond
(paren
id|smp_found_config
)paren
id|get_smp_config
c_func
(paren
)paren
suffix:semicolon
id|init_apic_mappings
c_func
(paren
)paren
suffix:semicolon
macro_line|#endif
multiline_comment|/*&n;&t; * Request address space for all standard RAM and ROM resources&n;&t; * and also for regions reported as reserved by the e820.&n;&t; */
id|probe_roms
c_func
(paren
)paren
suffix:semicolon
id|e820_reserve_resources
c_func
(paren
)paren
suffix:semicolon
id|request_resource
c_func
(paren
op_amp
id|iomem_resource
comma
op_amp
id|video_ram_resource
)paren
suffix:semicolon
(brace
r_int
id|i
suffix:semicolon
multiline_comment|/* request I/O space for devices used on all i[345]86 PCs */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|STANDARD_IO_RESOURCES
suffix:semicolon
id|i
op_increment
)paren
id|request_resource
c_func
(paren
op_amp
id|ioport_resource
comma
op_amp
id|standard_io_resources
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
multiline_comment|/* Will likely break when you have unassigned resources with more&n;&t;   than 4GB memory and bridges that don&squot;t support more than 4GB. &n;&t;   Doing it properly would require to use pci_alloc_consistent&n;&t;   in this case. */
id|low_mem_size
op_assign
(paren
(paren
id|end_pfn
op_lshift
id|PAGE_SHIFT
)paren
op_plus
l_int|0xfffff
)paren
op_amp
op_complement
l_int|0xfffff
suffix:semicolon
r_if
c_cond
(paren
id|low_mem_size
OG
id|pci_mem_start
)paren
id|pci_mem_start
op_assign
id|low_mem_size
suffix:semicolon
macro_line|#ifdef CONFIG_GART_IOMMU
id|iommu_hole_init
c_func
(paren
)paren
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_VT
macro_line|#if defined(CONFIG_VGA_CONSOLE)
id|conswitchp
op_assign
op_amp
id|vga_con
suffix:semicolon
macro_line|#elif defined(CONFIG_DUMMY_CONSOLE)
id|conswitchp
op_assign
op_amp
id|dummy_con
suffix:semicolon
macro_line|#endif
macro_line|#endif
)brace
DECL|function|get_model_name
r_static
r_int
id|__init
id|get_model_name
c_func
(paren
r_struct
id|cpuinfo_x86
op_star
id|c
)paren
(brace
r_int
r_int
op_star
id|v
suffix:semicolon
r_if
c_cond
(paren
id|cpuid_eax
c_func
(paren
l_int|0x80000000
)paren
OL
l_int|0x80000004
)paren
r_return
l_int|0
suffix:semicolon
id|v
op_assign
(paren
r_int
r_int
op_star
)paren
id|c-&gt;x86_model_id
suffix:semicolon
id|cpuid
c_func
(paren
l_int|0x80000002
comma
op_amp
id|v
(braket
l_int|0
)braket
comma
op_amp
id|v
(braket
l_int|1
)braket
comma
op_amp
id|v
(braket
l_int|2
)braket
comma
op_amp
id|v
(braket
l_int|3
)braket
)paren
suffix:semicolon
id|cpuid
c_func
(paren
l_int|0x80000003
comma
op_amp
id|v
(braket
l_int|4
)braket
comma
op_amp
id|v
(braket
l_int|5
)braket
comma
op_amp
id|v
(braket
l_int|6
)braket
comma
op_amp
id|v
(braket
l_int|7
)braket
)paren
suffix:semicolon
id|cpuid
c_func
(paren
l_int|0x80000004
comma
op_amp
id|v
(braket
l_int|8
)braket
comma
op_amp
id|v
(braket
l_int|9
)braket
comma
op_amp
id|v
(braket
l_int|10
)braket
comma
op_amp
id|v
(braket
l_int|11
)braket
)paren
suffix:semicolon
id|c-&gt;x86_model_id
(braket
l_int|48
)braket
op_assign
l_int|0
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|display_cacheinfo
r_static
r_void
id|__init
id|display_cacheinfo
c_func
(paren
r_struct
id|cpuinfo_x86
op_star
id|c
)paren
(brace
r_int
r_int
id|n
comma
id|dummy
comma
id|eax
comma
id|ebx
comma
id|ecx
comma
id|edx
suffix:semicolon
id|n
op_assign
id|cpuid_eax
c_func
(paren
l_int|0x80000000
)paren
suffix:semicolon
r_if
c_cond
(paren
id|n
op_ge
l_int|0x80000005
)paren
(brace
id|cpuid
c_func
(paren
l_int|0x80000005
comma
op_amp
id|dummy
comma
op_amp
id|ebx
comma
op_amp
id|ecx
comma
op_amp
id|edx
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;CPU: L1 I Cache: %dK (%d bytes/line), D cache %dK (%d bytes/line)&bslash;n&quot;
comma
id|edx
op_rshift
l_int|24
comma
id|edx
op_amp
l_int|0xFF
comma
id|ecx
op_rshift
l_int|24
comma
id|ecx
op_amp
l_int|0xFF
)paren
suffix:semicolon
id|c-&gt;x86_cache_size
op_assign
(paren
id|ecx
op_rshift
l_int|24
)paren
op_plus
(paren
id|edx
op_rshift
l_int|24
)paren
suffix:semicolon
multiline_comment|/* DTLB and ITLB together, but only 4K */
id|c-&gt;x86_tlbsize
op_assign
(paren
(paren
id|ebx
op_rshift
l_int|16
)paren
op_amp
l_int|0xff
)paren
op_plus
(paren
id|ebx
op_amp
l_int|0xff
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|n
op_ge
l_int|0x80000006
)paren
(brace
id|cpuid
c_func
(paren
l_int|0x80000006
comma
op_amp
id|dummy
comma
op_amp
id|ebx
comma
op_amp
id|ecx
comma
op_amp
id|edx
)paren
suffix:semicolon
id|ecx
op_assign
id|cpuid_ecx
c_func
(paren
l_int|0x80000006
)paren
suffix:semicolon
id|c-&gt;x86_cache_size
op_assign
id|ecx
op_rshift
l_int|16
suffix:semicolon
id|c-&gt;x86_tlbsize
op_add_assign
(paren
(paren
id|ebx
op_rshift
l_int|16
)paren
op_amp
l_int|0xfff
)paren
op_plus
(paren
id|ebx
op_amp
l_int|0xfff
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;CPU: L2 Cache: %dK (%d bytes/line)&bslash;n&quot;
comma
id|c-&gt;x86_cache_size
comma
id|ecx
op_amp
l_int|0xFF
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|n
op_ge
l_int|0x80000007
)paren
id|cpuid
c_func
(paren
l_int|0x80000007
comma
op_amp
id|dummy
comma
op_amp
id|dummy
comma
op_amp
id|dummy
comma
op_amp
id|c-&gt;x86_power
)paren
suffix:semicolon
r_if
c_cond
(paren
id|n
op_ge
l_int|0x80000008
)paren
(brace
id|cpuid
c_func
(paren
l_int|0x80000008
comma
op_amp
id|eax
comma
op_amp
id|dummy
comma
op_amp
id|dummy
comma
op_amp
id|dummy
)paren
suffix:semicolon
id|c-&gt;x86_virt_bits
op_assign
(paren
id|eax
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
suffix:semicolon
id|c-&gt;x86_phys_bits
op_assign
id|eax
op_amp
l_int|0xff
suffix:semicolon
)brace
)brace
DECL|function|init_amd
r_static
r_int
id|__init
id|init_amd
c_func
(paren
r_struct
id|cpuinfo_x86
op_star
id|c
)paren
(brace
r_int
id|r
suffix:semicolon
r_int
id|level
suffix:semicolon
multiline_comment|/* Bit 31 in normal CPUID used for nonstandard 3DNow ID;&n;&t;   3DNow is IDd by bit 31 in extended CPUID (1*32+31) anyway */
id|clear_bit
c_func
(paren
l_int|0
op_star
l_int|32
op_plus
l_int|31
comma
op_amp
id|c-&gt;x86_capability
)paren
suffix:semicolon
multiline_comment|/* C-stepping K8? */
id|level
op_assign
id|cpuid_eax
c_func
(paren
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|level
op_ge
l_int|0x0f48
op_logical_and
id|level
OL
l_int|0x0f50
)paren
op_logical_or
id|level
op_ge
l_int|0x0f58
)paren
id|set_bit
c_func
(paren
id|X86_FEATURE_K8_C
comma
op_amp
id|c-&gt;x86_capability
)paren
suffix:semicolon
id|r
op_assign
id|get_model_name
c_func
(paren
id|c
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|r
)paren
(brace
r_switch
c_cond
(paren
id|c-&gt;x86
)paren
(brace
r_case
l_int|15
suffix:colon
multiline_comment|/* Should distinguish Models here, but this is only&n;&t;&t;&t;   a fallback anyways. */
id|strcpy
c_func
(paren
id|c-&gt;x86_model_id
comma
l_string|&quot;Hammer&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
id|display_cacheinfo
c_func
(paren
id|c
)paren
suffix:semicolon
r_if
c_cond
(paren
id|c-&gt;cpuid_level
op_ge
l_int|0x80000008
)paren
(brace
id|c-&gt;x86_num_cores
op_assign
(paren
id|cpuid_ecx
c_func
(paren
l_int|0x80000008
)paren
op_amp
l_int|0xff
)paren
op_plus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|c-&gt;x86_num_cores
op_amp
(paren
id|c-&gt;x86_num_cores
op_minus
l_int|1
)paren
)paren
id|c-&gt;x86_num_cores
op_assign
l_int|1
suffix:semicolon
macro_line|#ifdef CONFIG_NUMA
multiline_comment|/* On a dual core setup the lower bits of apic id&n;&t;&t;   distingush the cores. Fix up the CPU&lt;-&gt;node mappings&n;&t;&t;   here based on that.&n;&t;&t;   Assumes number of cores is a power of two. */
r_if
c_cond
(paren
id|c-&gt;x86_num_cores
OG
l_int|1
)paren
(brace
r_int
id|cpu
op_assign
id|c-&gt;x86_apicid
suffix:semicolon
id|cpu_to_node
(braket
id|cpu
)braket
op_assign
id|cpu
op_rshift
id|hweight32
c_func
(paren
id|c-&gt;x86_num_cores
op_minus
l_int|1
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;CPU %d -&gt; Node %d&bslash;n&quot;
comma
id|cpu
comma
id|cpu_to_node
(braket
id|cpu
)braket
)paren
suffix:semicolon
)brace
macro_line|#endif
)brace
r_return
id|r
suffix:semicolon
)brace
DECL|function|detect_ht
r_static
r_void
id|__init
id|detect_ht
c_func
(paren
r_struct
id|cpuinfo_x86
op_star
id|c
)paren
(brace
macro_line|#ifdef CONFIG_SMP
id|u32
id|eax
comma
id|ebx
comma
id|ecx
comma
id|edx
suffix:semicolon
r_int
id|index_lsb
comma
id|index_msb
comma
id|tmp
suffix:semicolon
r_int
id|initial_apic_id
suffix:semicolon
r_int
id|cpu
op_assign
id|smp_processor_id
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|cpu_has
c_func
(paren
id|c
comma
id|X86_FEATURE_HT
)paren
)paren
r_return
suffix:semicolon
id|cpuid
c_func
(paren
l_int|1
comma
op_amp
id|eax
comma
op_amp
id|ebx
comma
op_amp
id|ecx
comma
op_amp
id|edx
)paren
suffix:semicolon
id|smp_num_siblings
op_assign
(paren
id|ebx
op_amp
l_int|0xff0000
)paren
op_rshift
l_int|16
suffix:semicolon
r_if
c_cond
(paren
id|smp_num_siblings
op_eq
l_int|1
)paren
(brace
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;CPU: Hyper-Threading is disabled&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|smp_num_siblings
OG
l_int|1
)paren
(brace
id|index_lsb
op_assign
l_int|0
suffix:semicolon
id|index_msb
op_assign
l_int|31
suffix:semicolon
multiline_comment|/*&n;&t;&t; * At this point we only support two siblings per&n;&t;&t; * processor package.&n;&t;&t; */
r_if
c_cond
(paren
id|smp_num_siblings
OG
id|NR_CPUS
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;CPU: Unsupported number of the siblings %d&quot;
comma
id|smp_num_siblings
)paren
suffix:semicolon
id|smp_num_siblings
op_assign
l_int|1
suffix:semicolon
r_return
suffix:semicolon
)brace
id|tmp
op_assign
id|smp_num_siblings
suffix:semicolon
r_while
c_loop
(paren
(paren
id|tmp
op_amp
l_int|1
)paren
op_eq
l_int|0
)paren
(brace
id|tmp
op_rshift_assign
l_int|1
suffix:semicolon
id|index_lsb
op_increment
suffix:semicolon
)brace
id|tmp
op_assign
id|smp_num_siblings
suffix:semicolon
r_while
c_loop
(paren
(paren
id|tmp
op_amp
l_int|0x80000000
)paren
op_eq
l_int|0
)paren
(brace
id|tmp
op_lshift_assign
l_int|1
suffix:semicolon
id|index_msb
op_decrement
suffix:semicolon
)brace
r_if
c_cond
(paren
id|index_lsb
op_ne
id|index_msb
)paren
id|index_msb
op_increment
suffix:semicolon
id|initial_apic_id
op_assign
id|hard_smp_processor_id
c_func
(paren
)paren
suffix:semicolon
id|phys_proc_id
(braket
id|cpu
)braket
op_assign
id|initial_apic_id
op_rshift
id|index_msb
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;CPU: Physical Processor ID: %d&bslash;n&quot;
comma
id|phys_proc_id
(braket
id|cpu
)braket
)paren
suffix:semicolon
)brace
macro_line|#endif
)brace
DECL|macro|LVL_1_INST
mdefine_line|#define LVL_1_INST&t;1
DECL|macro|LVL_1_DATA
mdefine_line|#define LVL_1_DATA&t;2
DECL|macro|LVL_2
mdefine_line|#define LVL_2&t;&t;3
DECL|macro|LVL_3
mdefine_line|#define LVL_3&t;&t;4
DECL|macro|LVL_TRACE
mdefine_line|#define LVL_TRACE&t;5
DECL|struct|_cache_table
r_struct
id|_cache_table
(brace
DECL|member|descriptor
r_int
r_char
id|descriptor
suffix:semicolon
DECL|member|cache_type
r_char
id|cache_type
suffix:semicolon
DECL|member|size
r_int
id|size
suffix:semicolon
)brace
suffix:semicolon
multiline_comment|/* all the cache descriptor types we care about (no TLB or trace cache entries) */
DECL|variable|__initdata
r_static
r_struct
id|_cache_table
id|cache_table
(braket
)braket
id|__initdata
op_assign
(brace
(brace
l_int|0x06
comma
id|LVL_1_INST
comma
l_int|8
)brace
comma
(brace
l_int|0x08
comma
id|LVL_1_INST
comma
l_int|16
)brace
comma
(brace
l_int|0x0a
comma
id|LVL_1_DATA
comma
l_int|8
)brace
comma
(brace
l_int|0x0c
comma
id|LVL_1_DATA
comma
l_int|16
)brace
comma
(brace
l_int|0x22
comma
id|LVL_3
comma
l_int|512
)brace
comma
(brace
l_int|0x23
comma
id|LVL_3
comma
l_int|1024
)brace
comma
(brace
l_int|0x25
comma
id|LVL_3
comma
l_int|2048
)brace
comma
(brace
l_int|0x29
comma
id|LVL_3
comma
l_int|4096
)brace
comma
(brace
l_int|0x2c
comma
id|LVL_1_DATA
comma
l_int|32
)brace
comma
(brace
l_int|0x30
comma
id|LVL_1_INST
comma
l_int|32
)brace
comma
(brace
l_int|0x39
comma
id|LVL_2
comma
l_int|128
)brace
comma
(brace
l_int|0x3b
comma
id|LVL_2
comma
l_int|128
)brace
comma
(brace
l_int|0x3c
comma
id|LVL_2
comma
l_int|256
)brace
comma
(brace
l_int|0x41
comma
id|LVL_2
comma
l_int|128
)brace
comma
(brace
l_int|0x42
comma
id|LVL_2
comma
l_int|256
)brace
comma
(brace
l_int|0x43
comma
id|LVL_2
comma
l_int|512
)brace
comma
(brace
l_int|0x44
comma
id|LVL_2
comma
l_int|1024
)brace
comma
(brace
l_int|0x45
comma
id|LVL_2
comma
l_int|2048
)brace
comma
(brace
l_int|0x60
comma
id|LVL_1_DATA
comma
l_int|16
)brace
comma
(brace
l_int|0x66
comma
id|LVL_1_DATA
comma
l_int|8
)brace
comma
(brace
l_int|0x67
comma
id|LVL_1_DATA
comma
l_int|16
)brace
comma
(brace
l_int|0x68
comma
id|LVL_1_DATA
comma
l_int|32
)brace
comma
(brace
l_int|0x70
comma
id|LVL_TRACE
comma
l_int|12
)brace
comma
(brace
l_int|0x71
comma
id|LVL_TRACE
comma
l_int|16
)brace
comma
(brace
l_int|0x72
comma
id|LVL_TRACE
comma
l_int|32
)brace
comma
(brace
l_int|0x79
comma
id|LVL_2
comma
l_int|128
)brace
comma
(brace
l_int|0x7a
comma
id|LVL_2
comma
l_int|256
)brace
comma
(brace
l_int|0x7b
comma
id|LVL_2
comma
l_int|512
)brace
comma
(brace
l_int|0x7c
comma
id|LVL_2
comma
l_int|1024
)brace
comma
(brace
l_int|0x82
comma
id|LVL_2
comma
l_int|256
)brace
comma
(brace
l_int|0x83
comma
id|LVL_2
comma
l_int|512
)brace
comma
(brace
l_int|0x84
comma
id|LVL_2
comma
l_int|1024
)brace
comma
(brace
l_int|0x85
comma
id|LVL_2
comma
l_int|2048
)brace
comma
(brace
l_int|0x86
comma
id|LVL_2
comma
l_int|512
)brace
comma
(brace
l_int|0x87
comma
id|LVL_2
comma
l_int|1024
)brace
comma
(brace
l_int|0x00
comma
l_int|0
comma
l_int|0
)brace
)brace
suffix:semicolon
DECL|function|init_intel
r_static
r_void
id|__init
id|init_intel
c_func
(paren
r_struct
id|cpuinfo_x86
op_star
id|c
)paren
(brace
multiline_comment|/* Cache sizes */
r_int
r_int
id|trace
op_assign
l_int|0
comma
id|l1i
op_assign
l_int|0
comma
id|l1d
op_assign
l_int|0
comma
id|l2
op_assign
l_int|0
comma
id|l3
op_assign
l_int|0
suffix:semicolon
r_int
id|n
suffix:semicolon
r_if
c_cond
(paren
id|c-&gt;cpuid_level
OG
l_int|1
)paren
(brace
multiline_comment|/* supports eax=2  call */
r_int
id|i
comma
id|j
comma
id|n
suffix:semicolon
r_int
id|regs
(braket
l_int|4
)braket
suffix:semicolon
r_int
r_char
op_star
id|dp
op_assign
(paren
r_int
r_char
op_star
)paren
id|regs
suffix:semicolon
multiline_comment|/* Number of times to iterate */
id|n
op_assign
id|cpuid_eax
c_func
(paren
l_int|2
)paren
op_amp
l_int|0xFF
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|n
suffix:semicolon
id|i
op_increment
)paren
(brace
id|cpuid
c_func
(paren
l_int|2
comma
op_amp
id|regs
(braket
l_int|0
)braket
comma
op_amp
id|regs
(braket
l_int|1
)braket
comma
op_amp
id|regs
(braket
l_int|2
)braket
comma
op_amp
id|regs
(braket
l_int|3
)braket
)paren
suffix:semicolon
multiline_comment|/* If bit 31 is set, this is an unknown format */
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
l_int|3
suffix:semicolon
id|j
op_increment
)paren
(brace
r_if
c_cond
(paren
id|regs
(braket
id|j
)braket
OL
l_int|0
)paren
id|regs
(braket
id|j
)braket
op_assign
l_int|0
suffix:semicolon
)brace
multiline_comment|/* Byte 0 is level count, not a descriptor */
r_for
c_loop
(paren
id|j
op_assign
l_int|1
suffix:semicolon
id|j
OL
l_int|16
suffix:semicolon
id|j
op_increment
)paren
(brace
r_int
r_char
id|des
op_assign
id|dp
(braket
id|j
)braket
suffix:semicolon
r_int
r_char
id|k
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* look up this descriptor in the table */
r_while
c_loop
(paren
id|cache_table
(braket
id|k
)braket
dot
id|descriptor
op_ne
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|cache_table
(braket
id|k
)braket
dot
id|descriptor
op_eq
id|des
)paren
(brace
r_switch
c_cond
(paren
id|cache_table
(braket
id|k
)braket
dot
id|cache_type
)paren
(brace
r_case
id|LVL_1_INST
suffix:colon
id|l1i
op_add_assign
id|cache_table
(braket
id|k
)braket
dot
id|size
suffix:semicolon
r_break
suffix:semicolon
r_case
id|LVL_1_DATA
suffix:colon
id|l1d
op_add_assign
id|cache_table
(braket
id|k
)braket
dot
id|size
suffix:semicolon
r_break
suffix:semicolon
r_case
id|LVL_2
suffix:colon
id|l2
op_add_assign
id|cache_table
(braket
id|k
)braket
dot
id|size
suffix:semicolon
r_break
suffix:semicolon
r_case
id|LVL_3
suffix:colon
id|l3
op_add_assign
id|cache_table
(braket
id|k
)braket
dot
id|size
suffix:semicolon
r_break
suffix:semicolon
r_case
id|LVL_TRACE
suffix:colon
id|trace
op_add_assign
id|cache_table
(braket
id|k
)braket
dot
id|size
suffix:semicolon
r_break
suffix:semicolon
)brace
r_break
suffix:semicolon
)brace
id|k
op_increment
suffix:semicolon
)brace
)brace
)brace
r_if
c_cond
(paren
id|trace
)paren
id|printk
(paren
id|KERN_INFO
l_string|&quot;CPU: Trace cache: %dK uops&quot;
comma
id|trace
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|l1i
)paren
id|printk
(paren
id|KERN_INFO
l_string|&quot;CPU: L1 I cache: %dK&quot;
comma
id|l1i
)paren
suffix:semicolon
r_if
c_cond
(paren
id|l1d
)paren
id|printk
c_func
(paren
l_string|&quot;, L1 D cache: %dK&bslash;n&quot;
comma
id|l1d
)paren
suffix:semicolon
r_else
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|l2
)paren
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;CPU: L2 cache: %dK&bslash;n&quot;
comma
id|l2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|l3
)paren
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;CPU: L3 cache: %dK&bslash;n&quot;
comma
id|l3
)paren
suffix:semicolon
id|c-&gt;x86_cache_size
op_assign
id|l2
ques
c_cond
id|l2
suffix:colon
(paren
id|l1i
op_plus
id|l1d
)paren
suffix:semicolon
)brace
id|n
op_assign
id|cpuid_eax
c_func
(paren
l_int|0x80000000
)paren
suffix:semicolon
r_if
c_cond
(paren
id|n
op_ge
l_int|0x80000008
)paren
(brace
r_int
id|eax
op_assign
id|cpuid_eax
c_func
(paren
l_int|0x80000008
)paren
suffix:semicolon
id|c-&gt;x86_virt_bits
op_assign
(paren
id|eax
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
suffix:semicolon
id|c-&gt;x86_phys_bits
op_assign
id|eax
op_amp
l_int|0xff
suffix:semicolon
)brace
r_if
c_cond
(paren
id|c-&gt;x86
op_eq
l_int|15
)paren
id|c-&gt;x86_cache_alignment
op_assign
id|c-&gt;x86_clflush_size
op_star
l_int|2
suffix:semicolon
)brace
DECL|function|get_cpu_vendor
r_void
id|__init
id|get_cpu_vendor
c_func
(paren
r_struct
id|cpuinfo_x86
op_star
id|c
)paren
(brace
r_char
op_star
id|v
op_assign
id|c-&gt;x86_vendor_id
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|v
comma
l_string|&quot;AuthenticAMD&quot;
)paren
)paren
id|c-&gt;x86_vendor
op_assign
id|X86_VENDOR_AMD
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|v
comma
l_string|&quot;GenuineIntel&quot;
)paren
)paren
id|c-&gt;x86_vendor
op_assign
id|X86_VENDOR_INTEL
suffix:semicolon
r_else
id|c-&gt;x86_vendor
op_assign
id|X86_VENDOR_UNKNOWN
suffix:semicolon
)brace
DECL|struct|cpu_model_info
r_struct
id|cpu_model_info
(brace
DECL|member|vendor
r_int
id|vendor
suffix:semicolon
DECL|member|family
r_int
id|family
suffix:semicolon
DECL|member|model_names
r_char
op_star
id|model_names
(braket
l_int|16
)braket
suffix:semicolon
)brace
suffix:semicolon
multiline_comment|/* Do some early cpuid on the boot CPU to get some parameter that are&n;   needed before check_bugs. Everything advanced is in identify_cpu&n;   below. */
DECL|function|early_identify_cpu
r_void
id|__init
id|early_identify_cpu
c_func
(paren
r_struct
id|cpuinfo_x86
op_star
id|c
)paren
(brace
id|u32
id|tfms
suffix:semicolon
id|c-&gt;loops_per_jiffy
op_assign
id|loops_per_jiffy
suffix:semicolon
id|c-&gt;x86_cache_size
op_assign
op_minus
l_int|1
suffix:semicolon
id|c-&gt;x86_vendor
op_assign
id|X86_VENDOR_UNKNOWN
suffix:semicolon
id|c-&gt;x86_model
op_assign
id|c-&gt;x86_mask
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* So far unknown... */
id|c-&gt;x86_vendor_id
(braket
l_int|0
)braket
op_assign
l_char|&squot;&bslash;0&squot;
suffix:semicolon
multiline_comment|/* Unset */
id|c-&gt;x86_model_id
(braket
l_int|0
)braket
op_assign
l_char|&squot;&bslash;0&squot;
suffix:semicolon
multiline_comment|/* Unset */
id|c-&gt;x86_clflush_size
op_assign
l_int|64
suffix:semicolon
id|c-&gt;x86_cache_alignment
op_assign
id|c-&gt;x86_clflush_size
suffix:semicolon
id|c-&gt;x86_num_cores
op_assign
l_int|1
suffix:semicolon
id|c-&gt;x86_apicid
op_assign
id|c
op_eq
op_amp
id|boot_cpu_data
ques
c_cond
l_int|0
suffix:colon
id|c
op_minus
id|cpu_data
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|c-&gt;x86_capability
comma
l_int|0
comma
r_sizeof
id|c-&gt;x86_capability
)paren
suffix:semicolon
multiline_comment|/* Get vendor name */
id|cpuid
c_func
(paren
l_int|0x00000000
comma
op_amp
id|c-&gt;cpuid_level
comma
(paren
r_int
op_star
)paren
op_amp
id|c-&gt;x86_vendor_id
(braket
l_int|0
)braket
comma
(paren
r_int
op_star
)paren
op_amp
id|c-&gt;x86_vendor_id
(braket
l_int|8
)braket
comma
(paren
r_int
op_star
)paren
op_amp
id|c-&gt;x86_vendor_id
(braket
l_int|4
)braket
)paren
suffix:semicolon
id|get_cpu_vendor
c_func
(paren
id|c
)paren
suffix:semicolon
multiline_comment|/* Initialize the standard set of capabilities */
multiline_comment|/* Note that the vendor-specific code below might override */
multiline_comment|/* Intel-defined flags: level 0x00000001 */
r_if
c_cond
(paren
id|c-&gt;cpuid_level
op_ge
l_int|0x00000001
)paren
(brace
id|__u32
id|misc
suffix:semicolon
id|cpuid
c_func
(paren
l_int|0x00000001
comma
op_amp
id|tfms
comma
op_amp
id|misc
comma
op_amp
id|c-&gt;x86_capability
(braket
l_int|4
)braket
comma
op_amp
id|c-&gt;x86_capability
(braket
l_int|0
)braket
)paren
suffix:semicolon
id|c-&gt;x86
op_assign
(paren
id|tfms
op_rshift
l_int|8
)paren
op_amp
l_int|0xf
suffix:semicolon
id|c-&gt;x86_model
op_assign
(paren
id|tfms
op_rshift
l_int|4
)paren
op_amp
l_int|0xf
suffix:semicolon
id|c-&gt;x86_mask
op_assign
id|tfms
op_amp
l_int|0xf
suffix:semicolon
r_if
c_cond
(paren
id|c-&gt;x86
op_eq
l_int|0xf
)paren
(brace
id|c-&gt;x86
op_add_assign
(paren
id|tfms
op_rshift
l_int|20
)paren
op_amp
l_int|0xff
suffix:semicolon
id|c-&gt;x86_model
op_add_assign
(paren
(paren
id|tfms
op_rshift
l_int|16
)paren
op_amp
l_int|0xF
)paren
op_lshift
l_int|4
suffix:semicolon
)brace
r_if
c_cond
(paren
id|c-&gt;x86_capability
(braket
l_int|0
)braket
op_amp
(paren
l_int|1
op_lshift
l_int|19
)paren
)paren
id|c-&gt;x86_clflush_size
op_assign
(paren
(paren
id|misc
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
)paren
op_star
l_int|8
suffix:semicolon
id|c-&gt;x86_apicid
op_assign
id|misc
op_rshift
l_int|24
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* Have CPUID level 0 only - unheard of */
id|c-&gt;x86
op_assign
l_int|4
suffix:semicolon
)brace
)brace
multiline_comment|/*&n; * This does the hard work of actually picking apart the CPU stuff...&n; */
DECL|function|identify_cpu
r_void
id|__init
id|identify_cpu
c_func
(paren
r_struct
id|cpuinfo_x86
op_star
id|c
)paren
(brace
r_int
id|i
suffix:semicolon
id|u32
id|xlvl
suffix:semicolon
id|early_identify_cpu
c_func
(paren
id|c
)paren
suffix:semicolon
multiline_comment|/* AMD-defined flags: level 0x80000001 */
id|xlvl
op_assign
id|cpuid_eax
c_func
(paren
l_int|0x80000000
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|xlvl
op_amp
l_int|0xffff0000
)paren
op_eq
l_int|0x80000000
)paren
(brace
r_if
c_cond
(paren
id|xlvl
op_ge
l_int|0x80000001
)paren
(brace
id|c-&gt;x86_capability
(braket
l_int|1
)braket
op_assign
id|cpuid_edx
c_func
(paren
l_int|0x80000001
)paren
suffix:semicolon
id|c-&gt;x86_capability
(braket
l_int|5
)braket
op_assign
id|cpuid_ecx
c_func
(paren
l_int|0x80000001
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|xlvl
op_ge
l_int|0x80000004
)paren
id|get_model_name
c_func
(paren
id|c
)paren
suffix:semicolon
multiline_comment|/* Default name */
)brace
multiline_comment|/* Transmeta-defined flags: level 0x80860001 */
id|xlvl
op_assign
id|cpuid_eax
c_func
(paren
l_int|0x80860000
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|xlvl
op_amp
l_int|0xffff0000
)paren
op_eq
l_int|0x80860000
)paren
(brace
r_if
c_cond
(paren
id|xlvl
op_ge
l_int|0x80860001
)paren
id|c-&gt;x86_capability
(braket
l_int|2
)braket
op_assign
id|cpuid_edx
c_func
(paren
l_int|0x80860001
)paren
suffix:semicolon
)brace
multiline_comment|/*&n;&t; * Vendor-specific initialization.  In this section we&n;&t; * canonicalize the feature flags, meaning if there are&n;&t; * features a certain CPU supports which CPUID doesn&squot;t&n;&t; * tell us, CPUID claiming incorrect flags, or other bugs,&n;&t; * we handle them here.&n;&t; *&n;&t; * At the end of this section, c-&gt;x86_capability better&n;&t; * indicate the features this CPU genuinely supports!&n;&t; */
r_switch
c_cond
(paren
id|c-&gt;x86_vendor
)paren
(brace
r_case
id|X86_VENDOR_AMD
suffix:colon
id|init_amd
c_func
(paren
id|c
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|X86_VENDOR_INTEL
suffix:colon
id|init_intel
c_func
(paren
id|c
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|X86_VENDOR_UNKNOWN
suffix:colon
r_default
suffix:colon
id|display_cacheinfo
c_func
(paren
id|c
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|select_idle_routine
c_func
(paren
id|c
)paren
suffix:semicolon
id|detect_ht
c_func
(paren
id|c
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * On SMP, boot_cpu_data holds the common feature set between&n;&t; * all CPUs; so make sure that we indicate which features are&n;&t; * common between the CPUs.  The first time this routine gets&n;&t; * executed, c == &amp;boot_cpu_data.&n;&t; */
r_if
c_cond
(paren
id|c
op_ne
op_amp
id|boot_cpu_data
)paren
(brace
multiline_comment|/* AND the already accumulated flags with these */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|NCAPINTS
suffix:semicolon
id|i
op_increment
)paren
id|boot_cpu_data.x86_capability
(braket
id|i
)braket
op_and_assign
id|c-&gt;x86_capability
(braket
id|i
)braket
suffix:semicolon
)brace
id|mcheck_init
c_func
(paren
id|c
)paren
suffix:semicolon
)brace
DECL|function|print_cpu_info
r_void
id|__init
id|print_cpu_info
c_func
(paren
r_struct
id|cpuinfo_x86
op_star
id|c
)paren
(brace
r_if
c_cond
(paren
id|c-&gt;x86_model_id
(braket
l_int|0
)braket
)paren
id|printk
c_func
(paren
l_string|&quot;%s&quot;
comma
id|c-&gt;x86_model_id
)paren
suffix:semicolon
r_if
c_cond
(paren
id|c-&gt;x86_mask
op_logical_or
id|c-&gt;cpuid_level
op_ge
l_int|0
)paren
id|printk
c_func
(paren
l_string|&quot; stepping %02x&bslash;n&quot;
comma
id|c-&gt;x86_mask
)paren
suffix:semicolon
r_else
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; *&t;Get CPU information for use by the procfs.&n; */
DECL|function|show_cpuinfo
r_static
r_int
id|show_cpuinfo
c_func
(paren
r_struct
id|seq_file
op_star
id|m
comma
r_void
op_star
id|v
)paren
(brace
r_struct
id|cpuinfo_x86
op_star
id|c
op_assign
id|v
suffix:semicolon
multiline_comment|/* &n;&t; * These flag bits must match the definitions in &lt;asm/cpufeature.h&gt;.&n;&t; * NULL means this bit is undefined or reserved; either way it doesn&squot;t&n;&t; * have meaning as far as Linux is concerned.  Note that it&squot;s important&n;&t; * to realize there is a difference between this table and CPUID -- if&n;&t; * applications want to get the raw CPUID data, they should access&n;&t; * /dev/cpu/&lt;cpu_nr&gt;/cpuid instead.&n;&t; */
r_static
r_char
op_star
id|x86_cap_flags
(braket
)braket
op_assign
(brace
multiline_comment|/* Intel-defined */
l_string|&quot;fpu&quot;
comma
l_string|&quot;vme&quot;
comma
l_string|&quot;de&quot;
comma
l_string|&quot;pse&quot;
comma
l_string|&quot;tsc&quot;
comma
l_string|&quot;msr&quot;
comma
l_string|&quot;pae&quot;
comma
l_string|&quot;mce&quot;
comma
l_string|&quot;cx8&quot;
comma
l_string|&quot;apic&quot;
comma
l_int|NULL
comma
l_string|&quot;sep&quot;
comma
l_string|&quot;mtrr&quot;
comma
l_string|&quot;pge&quot;
comma
l_string|&quot;mca&quot;
comma
l_string|&quot;cmov&quot;
comma
l_string|&quot;pat&quot;
comma
l_string|&quot;pse36&quot;
comma
l_string|&quot;pn&quot;
comma
l_string|&quot;clflush&quot;
comma
l_int|NULL
comma
l_string|&quot;dts&quot;
comma
l_string|&quot;acpi&quot;
comma
l_string|&quot;mmx&quot;
comma
l_string|&quot;fxsr&quot;
comma
l_string|&quot;sse&quot;
comma
l_string|&quot;sse2&quot;
comma
l_string|&quot;ss&quot;
comma
l_string|&quot;ht&quot;
comma
l_string|&quot;tm&quot;
comma
l_string|&quot;ia64&quot;
comma
l_int|NULL
comma
multiline_comment|/* AMD-defined */
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_string|&quot;syscall&quot;
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_string|&quot;nx&quot;
comma
l_int|NULL
comma
l_string|&quot;mmxext&quot;
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_string|&quot;lm&quot;
comma
l_string|&quot;3dnowext&quot;
comma
l_string|&quot;3dnow&quot;
comma
multiline_comment|/* Transmeta-defined */
l_string|&quot;recovery&quot;
comma
l_string|&quot;longrun&quot;
comma
l_int|NULL
comma
l_string|&quot;lrti&quot;
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
multiline_comment|/* Other (Linux-defined) */
l_string|&quot;cxmmx&quot;
comma
l_string|&quot;k6_mtrr&quot;
comma
l_string|&quot;cyrix_arr&quot;
comma
l_string|&quot;centaur_mcr&quot;
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
multiline_comment|/* Intel-defined (#2) */
l_string|&quot;pni&quot;
comma
l_int|NULL
comma
l_int|NULL
comma
l_string|&quot;monitor&quot;
comma
l_string|&quot;ds_cpl&quot;
comma
l_int|NULL
comma
l_int|NULL
comma
l_string|&quot;est&quot;
comma
l_string|&quot;tm2&quot;
comma
l_int|NULL
comma
l_string|&quot;cid&quot;
comma
l_int|NULL
comma
l_int|NULL
comma
l_string|&quot;cx16&quot;
comma
l_string|&quot;xtpr&quot;
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
)brace
suffix:semicolon
r_static
r_char
op_star
id|x86_power_flags
(braket
)braket
op_assign
(brace
l_string|&quot;ts&quot;
comma
multiline_comment|/* temperature sensor */
l_string|&quot;fid&quot;
comma
multiline_comment|/* frequency id control */
l_string|&quot;vid&quot;
comma
multiline_comment|/* voltage id control */
l_string|&quot;ttp&quot;
comma
multiline_comment|/* thermal trip */
)brace
suffix:semicolon
macro_line|#ifdef CONFIG_SMP
r_if
c_cond
(paren
op_logical_neg
id|cpu_online
c_func
(paren
id|c
op_minus
id|cpu_data
)paren
)paren
r_return
l_int|0
suffix:semicolon
macro_line|#endif
id|seq_printf
c_func
(paren
id|m
comma
l_string|&quot;processor&bslash;t: %u&bslash;n&quot;
l_string|&quot;vendor_id&bslash;t: %s&bslash;n&quot;
l_string|&quot;cpu family&bslash;t: %d&bslash;n&quot;
l_string|&quot;model&bslash;t&bslash;t: %d&bslash;n&quot;
l_string|&quot;model name&bslash;t: %s&bslash;n&quot;
comma
(paren
r_int
)paren
(paren
id|c
op_minus
id|cpu_data
)paren
comma
id|c-&gt;x86_vendor_id
(braket
l_int|0
)braket
ques
c_cond
id|c-&gt;x86_vendor_id
suffix:colon
l_string|&quot;unknown&quot;
comma
id|c-&gt;x86
comma
(paren
r_int
)paren
id|c-&gt;x86_model
comma
id|c-&gt;x86_model_id
(braket
l_int|0
)braket
ques
c_cond
id|c-&gt;x86_model_id
suffix:colon
l_string|&quot;unknown&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|c-&gt;x86_mask
op_logical_or
id|c-&gt;cpuid_level
op_ge
l_int|0
)paren
id|seq_printf
c_func
(paren
id|m
comma
l_string|&quot;stepping&bslash;t: %d&bslash;n&quot;
comma
id|c-&gt;x86_mask
)paren
suffix:semicolon
r_else
id|seq_printf
c_func
(paren
id|m
comma
l_string|&quot;stepping&bslash;t: unknown&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|cpu_has
c_func
(paren
id|c
comma
id|X86_FEATURE_TSC
)paren
)paren
(brace
id|seq_printf
c_func
(paren
id|m
comma
l_string|&quot;cpu MHz&bslash;t&bslash;t: %u.%03u&bslash;n&quot;
comma
id|cpu_khz
op_div
l_int|1000
comma
(paren
id|cpu_khz
op_mod
l_int|1000
)paren
)paren
suffix:semicolon
)brace
multiline_comment|/* Cache size */
r_if
c_cond
(paren
id|c-&gt;x86_cache_size
op_ge
l_int|0
)paren
id|seq_printf
c_func
(paren
id|m
comma
l_string|&quot;cache size&bslash;t: %d KB&bslash;n&quot;
comma
id|c-&gt;x86_cache_size
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_X86_HT
r_if
c_cond
(paren
id|cpu_has_ht
)paren
(brace
id|seq_printf
c_func
(paren
id|m
comma
l_string|&quot;physical id&bslash;t: %d&bslash;n&quot;
comma
id|phys_proc_id
(braket
id|c
op_minus
id|cpu_data
)braket
)paren
suffix:semicolon
id|seq_printf
c_func
(paren
id|m
comma
l_string|&quot;siblings&bslash;t: %d&bslash;n&quot;
comma
id|smp_num_siblings
)paren
suffix:semicolon
)brace
macro_line|#endif&t;
id|seq_printf
c_func
(paren
id|m
comma
l_string|&quot;fpu&bslash;t&bslash;t: yes&bslash;n&quot;
l_string|&quot;fpu_exception&bslash;t: yes&bslash;n&quot;
l_string|&quot;cpuid level&bslash;t: %d&bslash;n&quot;
l_string|&quot;wp&bslash;t&bslash;t: yes&bslash;n&quot;
l_string|&quot;flags&bslash;t&bslash;t:&quot;
comma
id|c-&gt;cpuid_level
)paren
suffix:semicolon
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|32
op_star
id|NCAPINTS
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|i
comma
op_amp
id|c-&gt;x86_capability
)paren
op_logical_and
id|x86_cap_flags
(braket
id|i
)braket
op_ne
l_int|NULL
)paren
id|seq_printf
c_func
(paren
id|m
comma
l_string|&quot; %s&quot;
comma
id|x86_cap_flags
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
id|seq_printf
c_func
(paren
id|m
comma
l_string|&quot;&bslash;nbogomips&bslash;t: %lu.%02lu&bslash;n&quot;
comma
id|c-&gt;loops_per_jiffy
op_div
(paren
l_int|500000
op_div
id|HZ
)paren
comma
(paren
id|c-&gt;loops_per_jiffy
op_div
(paren
l_int|5000
op_div
id|HZ
)paren
)paren
op_mod
l_int|100
)paren
suffix:semicolon
r_if
c_cond
(paren
id|c-&gt;x86_tlbsize
OG
l_int|0
)paren
id|seq_printf
c_func
(paren
id|m
comma
l_string|&quot;TLB size&bslash;t: %d 4K pages&bslash;n&quot;
comma
id|c-&gt;x86_tlbsize
)paren
suffix:semicolon
id|seq_printf
c_func
(paren
id|m
comma
l_string|&quot;clflush size&bslash;t: %d&bslash;n&quot;
comma
id|c-&gt;x86_clflush_size
)paren
suffix:semicolon
id|seq_printf
c_func
(paren
id|m
comma
l_string|&quot;cache_alignment&bslash;t: %d&bslash;n&quot;
comma
id|c-&gt;x86_cache_alignment
)paren
suffix:semicolon
id|seq_printf
c_func
(paren
id|m
comma
l_string|&quot;address sizes&bslash;t: %u bits physical, %u bits virtual&bslash;n&quot;
comma
id|c-&gt;x86_phys_bits
comma
id|c-&gt;x86_virt_bits
)paren
suffix:semicolon
id|seq_printf
c_func
(paren
id|m
comma
l_string|&quot;power management:&quot;
)paren
suffix:semicolon
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|32
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|c-&gt;x86_power
op_amp
(paren
l_int|1
op_lshift
id|i
)paren
)paren
(brace
r_if
c_cond
(paren
id|i
OL
id|ARRAY_SIZE
c_func
(paren
id|x86_power_flags
)paren
)paren
id|seq_printf
c_func
(paren
id|m
comma
l_string|&quot; %s&quot;
comma
id|x86_power_flags
(braket
id|i
)braket
)paren
suffix:semicolon
r_else
id|seq_printf
c_func
(paren
id|m
comma
l_string|&quot; [%d]&quot;
comma
id|i
)paren
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|c-&gt;x86_num_cores
OG
l_int|1
)paren
id|seq_printf
c_func
(paren
id|m
comma
l_string|&quot;cpu cores&bslash;t: %d&bslash;n&quot;
comma
id|c-&gt;x86_num_cores
)paren
suffix:semicolon
id|seq_printf
c_func
(paren
id|m
comma
l_string|&quot;&bslash;n&bslash;n&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|c_start
r_static
r_void
op_star
id|c_start
c_func
(paren
r_struct
id|seq_file
op_star
id|m
comma
id|loff_t
op_star
id|pos
)paren
(brace
r_return
op_star
id|pos
OL
id|NR_CPUS
ques
c_cond
id|cpu_data
op_plus
op_star
id|pos
suffix:colon
l_int|NULL
suffix:semicolon
)brace
DECL|function|c_next
r_static
r_void
op_star
id|c_next
c_func
(paren
r_struct
id|seq_file
op_star
id|m
comma
r_void
op_star
id|v
comma
id|loff_t
op_star
id|pos
)paren
(brace
op_increment
op_star
id|pos
suffix:semicolon
r_return
id|c_start
c_func
(paren
id|m
comma
id|pos
)paren
suffix:semicolon
)brace
DECL|function|c_stop
r_static
r_void
id|c_stop
c_func
(paren
r_struct
id|seq_file
op_star
id|m
comma
r_void
op_star
id|v
)paren
(brace
)brace
DECL|variable|cpuinfo_op
r_struct
id|seq_operations
id|cpuinfo_op
op_assign
(brace
dot
id|start
op_assign
id|c_start
comma
dot
id|next
op_assign
id|c_next
comma
dot
id|stop
op_assign
id|c_stop
comma
dot
id|show
op_assign
id|show_cpuinfo
comma
)brace
suffix:semicolon
eof
