multiline_comment|/*&n; *  linux/arch/arm/kernel/setup.c&n; *&n; *  Copyright (C) 1995-2001 Russell King&n; *&n; * This program is free software; you can redistribute it and/or modify&n; * it under the terms of the GNU General Public License version 2 as&n; * published by the Free Software Foundation.&n; */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/stddef.h&gt;
macro_line|#include &lt;linux/ioport.h&gt;
macro_line|#include &lt;linux/delay.h&gt;
macro_line|#include &lt;linux/utsname.h&gt;
macro_line|#include &lt;linux/blk.h&gt;
macro_line|#include &lt;linux/console.h&gt;
macro_line|#include &lt;linux/bootmem.h&gt;
macro_line|#include &lt;linux/seq_file.h&gt;
macro_line|#include &lt;linux/tty.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/root_dev.h&gt;
macro_line|#include &lt;asm/elf.h&gt;
macro_line|#include &lt;asm/hardware.h&gt;
macro_line|#include &lt;asm/io.h&gt;
macro_line|#include &lt;asm/procinfo.h&gt;
macro_line|#include &lt;asm/setup.h&gt;
macro_line|#include &lt;asm/mach-types.h&gt;
macro_line|#include &lt;asm/tlbflush.h&gt;
macro_line|#include &lt;asm/mach/arch.h&gt;
macro_line|#include &lt;asm/mach/irq.h&gt;
macro_line|#ifndef MEM_SIZE
DECL|macro|MEM_SIZE
mdefine_line|#define MEM_SIZE&t;(16*1024*1024)
macro_line|#endif
macro_line|#ifdef CONFIG_PREEMPT
DECL|variable|__cacheline_aligned_in_smp
id|spinlock_t
id|kernel_flag
id|__cacheline_aligned_in_smp
op_assign
id|SPIN_LOCK_UNLOCKED
suffix:semicolon
macro_line|#endif
macro_line|#if defined(CONFIG_FPE_NWFPE) || defined(CONFIG_FPE_FASTFPE)
DECL|variable|fpe_type
r_char
id|fpe_type
(braket
l_int|8
)braket
suffix:semicolon
DECL|function|fpe_setup
r_static
r_int
id|__init
id|fpe_setup
c_func
(paren
r_char
op_star
id|line
)paren
(brace
id|memcpy
c_func
(paren
id|fpe_type
comma
id|line
comma
l_int|8
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
id|__setup
c_func
(paren
l_string|&quot;fpe=&quot;
comma
id|fpe_setup
)paren
suffix:semicolon
macro_line|#endif
r_extern
r_int
r_int
id|mem_fclk_21285
suffix:semicolon
r_extern
r_void
id|paging_init
c_func
(paren
r_struct
id|meminfo
op_star
comma
r_struct
id|machine_desc
op_star
id|desc
)paren
suffix:semicolon
r_extern
r_void
id|convert_to_tag_list
c_func
(paren
r_struct
id|tag
op_star
id|tags
)paren
suffix:semicolon
r_extern
r_void
id|squash_mem_tags
c_func
(paren
r_struct
id|tag
op_star
id|tag
)paren
suffix:semicolon
r_extern
r_void
id|bootmem_init
c_func
(paren
r_struct
id|meminfo
op_star
)paren
suffix:semicolon
r_extern
r_void
id|reboot_setup
c_func
(paren
r_char
op_star
id|str
)paren
suffix:semicolon
r_extern
r_int
id|root_mountflags
suffix:semicolon
r_extern
r_int
id|_stext
comma
id|_text
comma
id|_etext
comma
id|_edata
comma
id|_end
suffix:semicolon
DECL|variable|processor_id
r_int
r_int
id|processor_id
suffix:semicolon
DECL|variable|__machine_arch_type
r_int
r_int
id|__machine_arch_type
suffix:semicolon
DECL|variable|system_rev
r_int
r_int
id|system_rev
suffix:semicolon
DECL|variable|system_serial_low
r_int
r_int
id|system_serial_low
suffix:semicolon
DECL|variable|system_serial_high
r_int
r_int
id|system_serial_high
suffix:semicolon
DECL|variable|elf_hwcap
r_int
r_int
id|elf_hwcap
suffix:semicolon
macro_line|#ifdef MULTI_CPU
DECL|variable|processor
r_struct
id|processor
id|processor
suffix:semicolon
macro_line|#endif
macro_line|#ifdef MULTI_TLB
DECL|variable|cpu_tlb
r_struct
id|cpu_tlb_fns
id|cpu_tlb
suffix:semicolon
macro_line|#endif
macro_line|#ifdef MULTI_USER
DECL|variable|cpu_user
r_struct
id|cpu_user_fns
id|cpu_user
suffix:semicolon
macro_line|#endif
DECL|variable|aux_device_present
r_int
r_char
id|aux_device_present
suffix:semicolon
DECL|variable|elf_platform
r_char
id|elf_platform
(braket
id|ELF_PLATFORM_SIZE
)braket
suffix:semicolon
DECL|variable|saved_command_line
r_char
id|saved_command_line
(braket
id|COMMAND_LINE_SIZE
)braket
suffix:semicolon
DECL|variable|__initdata
r_int
r_int
id|phys_initrd_start
id|__initdata
op_assign
l_int|0
suffix:semicolon
DECL|variable|__initdata
r_int
r_int
id|phys_initrd_size
id|__initdata
op_assign
l_int|0
suffix:semicolon
DECL|variable|__initdata
r_static
r_struct
id|meminfo
id|meminfo
id|__initdata
op_assign
(brace
l_int|0
comma
)brace
suffix:semicolon
DECL|variable|proc_info
r_static
r_struct
id|proc_info_item
id|proc_info
suffix:semicolon
DECL|variable|machine_name
r_static
r_const
r_char
op_star
id|machine_name
suffix:semicolon
DECL|variable|command_line
r_static
r_char
id|command_line
(braket
id|COMMAND_LINE_SIZE
)braket
suffix:semicolon
DECL|variable|__initdata
r_static
r_char
id|default_command_line
(braket
id|COMMAND_LINE_SIZE
)braket
id|__initdata
op_assign
id|CONFIG_CMDLINE
suffix:semicolon
DECL|member|c
DECL|member|l
DECL|variable|__initdata
r_static
r_union
(brace
r_char
id|c
(braket
l_int|4
)braket
suffix:semicolon
r_int
r_int
id|l
suffix:semicolon
)brace
id|endian_test
id|__initdata
op_assign
(brace
(brace
l_char|&squot;l&squot;
comma
l_char|&squot;?&squot;
comma
l_char|&squot;?&squot;
comma
l_char|&squot;b&squot;
)brace
)brace
suffix:semicolon
DECL|macro|ENDIANNESS
mdefine_line|#define ENDIANNESS ((char)endian_test.l)
multiline_comment|/*&n; * Standard memory resources&n; */
DECL|variable|mem_res
r_static
r_struct
id|resource
id|mem_res
(braket
)braket
op_assign
(brace
(brace
l_string|&quot;Video RAM&quot;
comma
l_int|0
comma
l_int|0
comma
id|IORESOURCE_MEM
)brace
comma
(brace
l_string|&quot;Kernel code&quot;
comma
l_int|0
comma
l_int|0
comma
id|IORESOURCE_MEM
)brace
comma
(brace
l_string|&quot;Kernel data&quot;
comma
l_int|0
comma
l_int|0
comma
id|IORESOURCE_MEM
)brace
)brace
suffix:semicolon
DECL|macro|video_ram
mdefine_line|#define video_ram   mem_res[0]
DECL|macro|kernel_code
mdefine_line|#define kernel_code mem_res[1]
DECL|macro|kernel_data
mdefine_line|#define kernel_data mem_res[2]
DECL|variable|io_res
r_static
r_struct
id|resource
id|io_res
(braket
)braket
op_assign
(brace
(brace
l_string|&quot;reserved&quot;
comma
l_int|0x3bc
comma
l_int|0x3be
comma
id|IORESOURCE_IO
op_or
id|IORESOURCE_BUSY
)brace
comma
(brace
l_string|&quot;reserved&quot;
comma
l_int|0x378
comma
l_int|0x37f
comma
id|IORESOURCE_IO
op_or
id|IORESOURCE_BUSY
)brace
comma
(brace
l_string|&quot;reserved&quot;
comma
l_int|0x278
comma
l_int|0x27f
comma
id|IORESOURCE_IO
op_or
id|IORESOURCE_BUSY
)brace
)brace
suffix:semicolon
DECL|macro|lp0
mdefine_line|#define lp0 io_res[0]
DECL|macro|lp1
mdefine_line|#define lp1 io_res[1]
DECL|macro|lp2
mdefine_line|#define lp2 io_res[2]
macro_line|#ifdef CONFIG_CPU_32
DECL|variable|cache_types
r_static
r_const
r_char
op_star
id|cache_types
(braket
l_int|16
)braket
op_assign
(brace
l_string|&quot;write-through&quot;
comma
l_string|&quot;write-back&quot;
comma
l_string|&quot;write-back&quot;
comma
l_string|&quot;undefined 3&quot;
comma
l_string|&quot;undefined 4&quot;
comma
l_string|&quot;undefined 5&quot;
comma
l_string|&quot;write-back&quot;
comma
l_string|&quot;write-back&quot;
comma
l_string|&quot;undefined 8&quot;
comma
l_string|&quot;undefined 9&quot;
comma
l_string|&quot;undefined 10&quot;
comma
l_string|&quot;undefined 11&quot;
comma
l_string|&quot;undefined 12&quot;
comma
l_string|&quot;undefined 13&quot;
comma
l_string|&quot;undefined 14&quot;
comma
l_string|&quot;undefined 15&quot;
comma
)brace
suffix:semicolon
DECL|variable|cache_clean
r_static
r_const
r_char
op_star
id|cache_clean
(braket
l_int|16
)braket
op_assign
(brace
l_string|&quot;not required&quot;
comma
l_string|&quot;read-block&quot;
comma
l_string|&quot;cp15 c7 ops&quot;
comma
l_string|&quot;undefined 3&quot;
comma
l_string|&quot;undefined 4&quot;
comma
l_string|&quot;undefined 5&quot;
comma
l_string|&quot;cp15 c7 ops&quot;
comma
l_string|&quot;cp15 c7 ops&quot;
comma
l_string|&quot;undefined 8&quot;
comma
l_string|&quot;undefined 9&quot;
comma
l_string|&quot;undefined 10&quot;
comma
l_string|&quot;undefined 11&quot;
comma
l_string|&quot;undefined 12&quot;
comma
l_string|&quot;undefined 13&quot;
comma
l_string|&quot;undefined 14&quot;
comma
l_string|&quot;undefined 15&quot;
comma
)brace
suffix:semicolon
DECL|variable|cache_lockdown
r_static
r_const
r_char
op_star
id|cache_lockdown
(braket
l_int|16
)braket
op_assign
(brace
l_string|&quot;not supported&quot;
comma
l_string|&quot;not supported&quot;
comma
l_string|&quot;not supported&quot;
comma
l_string|&quot;undefined 3&quot;
comma
l_string|&quot;undefined 4&quot;
comma
l_string|&quot;undefined 5&quot;
comma
l_string|&quot;format A&quot;
comma
l_string|&quot;format B&quot;
comma
l_string|&quot;undefined 8&quot;
comma
l_string|&quot;undefined 9&quot;
comma
l_string|&quot;undefined 10&quot;
comma
l_string|&quot;undefined 11&quot;
comma
l_string|&quot;undefined 12&quot;
comma
l_string|&quot;undefined 13&quot;
comma
l_string|&quot;undefined 14&quot;
comma
l_string|&quot;undefined 15&quot;
comma
)brace
suffix:semicolon
DECL|macro|CACHE_TYPE
mdefine_line|#define CACHE_TYPE(x)&t;(((x) &gt;&gt; 25) &amp; 15)
DECL|macro|CACHE_S
mdefine_line|#define CACHE_S(x)&t;((x) &amp; (1 &lt;&lt; 24))
DECL|macro|CACHE_DSIZE
mdefine_line|#define CACHE_DSIZE(x)&t;(((x) &gt;&gt; 12) &amp; 4095)&t;/* only if S=1 */
DECL|macro|CACHE_ISIZE
mdefine_line|#define CACHE_ISIZE(x)&t;((x) &amp; 4095)
DECL|macro|CACHE_SIZE
mdefine_line|#define CACHE_SIZE(y)&t;(((y) &gt;&gt; 6) &amp; 7)
DECL|macro|CACHE_ASSOC
mdefine_line|#define CACHE_ASSOC(y)&t;(((y) &gt;&gt; 3) &amp; 7)
DECL|macro|CACHE_M
mdefine_line|#define CACHE_M(y)&t;((y) &amp; (1 &lt;&lt; 2))
DECL|macro|CACHE_LINE
mdefine_line|#define CACHE_LINE(y)&t;((y) &amp; 3)
DECL|function|dump_cache
r_static
r_inline
r_void
id|dump_cache
c_func
(paren
r_const
r_char
op_star
id|prefix
comma
r_int
r_int
id|cache
)paren
(brace
r_int
r_int
id|mult
op_assign
l_int|2
op_plus
(paren
id|CACHE_M
c_func
(paren
id|cache
)paren
ques
c_cond
l_int|1
suffix:colon
l_int|0
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s: %d bytes, associativity %d, %d byte lines, %d sets&bslash;n&quot;
comma
id|prefix
comma
id|mult
op_lshift
(paren
l_int|8
op_plus
id|CACHE_SIZE
c_func
(paren
id|cache
)paren
)paren
comma
(paren
id|mult
op_lshift
id|CACHE_ASSOC
c_func
(paren
id|cache
)paren
)paren
op_rshift
l_int|1
comma
l_int|8
op_lshift
id|CACHE_LINE
c_func
(paren
id|cache
)paren
comma
l_int|1
op_lshift
(paren
l_int|6
op_plus
id|CACHE_SIZE
c_func
(paren
id|cache
)paren
op_minus
id|CACHE_ASSOC
c_func
(paren
id|cache
)paren
op_minus
id|CACHE_LINE
c_func
(paren
id|cache
)paren
)paren
)paren
suffix:semicolon
)brace
DECL|function|dump_cpu_cache_id
r_static
r_inline
r_void
id|dump_cpu_cache_id
c_func
(paren
r_void
)paren
(brace
r_int
r_int
id|cache_info
suffix:semicolon
id|asm
c_func
(paren
l_string|&quot;mrc p15, 0, %0, c0, c0, 1&quot;
suffix:colon
l_string|&quot;=r&quot;
(paren
id|cache_info
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|cache_info
op_eq
id|processor_id
)paren
r_return
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;CPU: D %s cache&bslash;n&quot;
comma
id|cache_types
(braket
id|CACHE_TYPE
c_func
(paren
id|cache_info
)paren
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
id|CACHE_S
c_func
(paren
id|cache_info
)paren
)paren
(brace
id|dump_cache
c_func
(paren
l_string|&quot;CPU: I cache&quot;
comma
id|CACHE_ISIZE
c_func
(paren
id|cache_info
)paren
)paren
suffix:semicolon
id|dump_cache
c_func
(paren
l_string|&quot;CPU: D cache&quot;
comma
id|CACHE_DSIZE
c_func
(paren
id|cache_info
)paren
)paren
suffix:semicolon
)brace
r_else
(brace
id|dump_cache
c_func
(paren
l_string|&quot;CPU: cache&quot;
comma
id|CACHE_ISIZE
c_func
(paren
id|cache_info
)paren
)paren
suffix:semicolon
)brace
)brace
macro_line|#else
DECL|macro|dump_cpu_cache_id
mdefine_line|#define dump_cpu_cache_id() do { } while (0)
macro_line|#endif
DECL|function|setup_processor
r_static
r_void
id|__init
id|setup_processor
c_func
(paren
r_void
)paren
(brace
r_extern
r_struct
id|proc_info_list
id|__proc_info_begin
comma
id|__proc_info_end
suffix:semicolon
r_struct
id|proc_info_list
op_star
id|list
suffix:semicolon
multiline_comment|/*&n;&t; * locate processor in the list of supported processor&n;&t; * types.  The linker builds this table for us from the&n;&t; * entries in arch/arm/mm/proc-*.S&n;&t; */
r_for
c_loop
(paren
id|list
op_assign
op_amp
id|__proc_info_begin
suffix:semicolon
id|list
OL
op_amp
id|__proc_info_end
suffix:semicolon
id|list
op_increment
)paren
r_if
c_cond
(paren
(paren
id|processor_id
op_amp
id|list-&gt;cpu_mask
)paren
op_eq
id|list-&gt;cpu_val
)paren
r_break
suffix:semicolon
multiline_comment|/*&n;&t; * If processor type is unrecognised, then we&n;&t; * can do nothing...&n;&t; */
r_if
c_cond
(paren
id|list
op_ge
op_amp
id|__proc_info_end
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;CPU configuration botched (ID %08x), unable &quot;
l_string|&quot;to continue.&bslash;n&quot;
comma
id|processor_id
)paren
suffix:semicolon
r_while
c_loop
(paren
l_int|1
)paren
suffix:semicolon
)brace
id|proc_info
op_assign
op_star
id|list-&gt;info
suffix:semicolon
macro_line|#ifdef MULTI_CPU
id|processor
op_assign
op_star
id|list-&gt;proc
suffix:semicolon
macro_line|#endif
macro_line|#ifdef MULTI_TLB
id|cpu_tlb
op_assign
op_star
id|list-&gt;tlb
suffix:semicolon
macro_line|#endif
macro_line|#ifdef MULTI_USER
id|cpu_user
op_assign
op_star
id|list-&gt;user
suffix:semicolon
macro_line|#endif
id|printk
c_func
(paren
l_string|&quot;CPU: %s %s revision %d&bslash;n&quot;
comma
id|proc_info.manufacturer
comma
id|proc_info.cpu_name
comma
(paren
r_int
)paren
id|processor_id
op_amp
l_int|15
)paren
suffix:semicolon
id|dump_cpu_cache_id
c_func
(paren
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|system_utsname.machine
comma
l_string|&quot;%s%c&quot;
comma
id|list-&gt;arch_name
comma
id|ENDIANNESS
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|elf_platform
comma
l_string|&quot;%s%c&quot;
comma
id|list-&gt;elf_name
comma
id|ENDIANNESS
)paren
suffix:semicolon
id|elf_hwcap
op_assign
id|list-&gt;elf_hwcap
suffix:semicolon
id|cpu_proc_init
c_func
(paren
)paren
suffix:semicolon
)brace
DECL|function|setup_machine
r_static
r_struct
id|machine_desc
op_star
id|__init
id|setup_machine
c_func
(paren
r_int
r_int
id|nr
)paren
(brace
r_extern
r_struct
id|machine_desc
id|__arch_info_begin
comma
id|__arch_info_end
suffix:semicolon
r_struct
id|machine_desc
op_star
id|list
suffix:semicolon
multiline_comment|/*&n;&t; * locate architecture in the list of supported architectures.&n;&t; */
r_for
c_loop
(paren
id|list
op_assign
op_amp
id|__arch_info_begin
suffix:semicolon
id|list
OL
op_amp
id|__arch_info_end
suffix:semicolon
id|list
op_increment
)paren
r_if
c_cond
(paren
id|list-&gt;nr
op_eq
id|nr
)paren
r_break
suffix:semicolon
multiline_comment|/*&n;&t; * If the architecture type is not recognised, then we&n;&t; * can co nothing...&n;&t; */
r_if
c_cond
(paren
id|list
op_ge
op_amp
id|__arch_info_end
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;Architecture configuration botched (nr %d), unable &quot;
l_string|&quot;to continue.&bslash;n&quot;
comma
id|nr
)paren
suffix:semicolon
r_while
c_loop
(paren
l_int|1
)paren
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;Machine: %s&bslash;n&quot;
comma
id|list-&gt;name
)paren
suffix:semicolon
r_return
id|list
suffix:semicolon
)brace
multiline_comment|/*&n; * Initial parsing of the command line.  We need to pick out the&n; * memory size.  We look for mem=size@start, where start and size&n; * are &quot;size[KkMm]&quot;&n; */
r_static
r_void
id|__init
DECL|function|parse_cmdline
id|parse_cmdline
c_func
(paren
r_struct
id|meminfo
op_star
id|mi
comma
r_char
op_star
op_star
id|cmdline_p
comma
r_char
op_star
id|from
)paren
(brace
r_char
id|c
op_assign
l_char|&squot; &squot;
comma
op_star
id|to
op_assign
id|command_line
suffix:semicolon
r_int
id|usermem
op_assign
l_int|0
comma
id|len
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
suffix:semicolon
)paren
(brace
r_if
c_cond
(paren
id|c
op_eq
l_char|&squot; &squot;
op_logical_and
op_logical_neg
id|memcmp
c_func
(paren
id|from
comma
l_string|&quot;mem=&quot;
comma
l_int|4
)paren
)paren
(brace
r_int
r_int
id|size
comma
id|start
suffix:semicolon
r_if
c_cond
(paren
id|to
op_ne
id|command_line
)paren
id|to
op_sub_assign
l_int|1
suffix:semicolon
multiline_comment|/*&n;&t;&t;&t; * If the user specifies memory size, we&n;&t;&t;&t; * blow away any automatically generated&n;&t;&t;&t; * size.&n;&t;&t;&t; */
r_if
c_cond
(paren
id|usermem
op_eq
l_int|0
)paren
(brace
id|usermem
op_assign
l_int|1
suffix:semicolon
id|mi-&gt;nr_banks
op_assign
l_int|0
suffix:semicolon
)brace
id|start
op_assign
id|PHYS_OFFSET
suffix:semicolon
id|size
op_assign
id|memparse
c_func
(paren
id|from
op_plus
l_int|4
comma
op_amp
id|from
)paren
suffix:semicolon
r_if
c_cond
(paren
op_star
id|from
op_eq
l_char|&squot;@&squot;
)paren
id|start
op_assign
id|memparse
c_func
(paren
id|from
op_plus
l_int|1
comma
op_amp
id|from
)paren
suffix:semicolon
id|mi-&gt;bank
(braket
id|mi-&gt;nr_banks
)braket
dot
id|start
op_assign
id|start
suffix:semicolon
id|mi-&gt;bank
(braket
id|mi-&gt;nr_banks
)braket
dot
id|size
op_assign
id|size
suffix:semicolon
id|mi-&gt;bank
(braket
id|mi-&gt;nr_banks
)braket
dot
id|node
op_assign
id|PHYS_TO_NID
c_func
(paren
id|start
)paren
suffix:semicolon
id|mi-&gt;nr_banks
op_add_assign
l_int|1
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|c
op_eq
l_char|&squot; &squot;
op_logical_and
op_logical_neg
id|memcmp
c_func
(paren
id|from
comma
l_string|&quot;initrd=&quot;
comma
l_int|7
)paren
)paren
(brace
r_int
r_int
id|start
comma
id|size
suffix:semicolon
multiline_comment|/*&n;&t;&t;&t; * Remove space character&n;&t;&t;&t; */
r_if
c_cond
(paren
id|to
op_ne
id|command_line
)paren
id|to
op_sub_assign
l_int|1
suffix:semicolon
id|start
op_assign
id|memparse
c_func
(paren
id|from
op_plus
l_int|7
comma
op_amp
id|from
)paren
suffix:semicolon
r_if
c_cond
(paren
op_star
id|from
op_eq
l_char|&squot;,&squot;
)paren
(brace
id|size
op_assign
id|memparse
c_func
(paren
id|from
op_plus
l_int|1
comma
op_amp
id|from
)paren
suffix:semicolon
id|phys_initrd_start
op_assign
id|start
suffix:semicolon
id|phys_initrd_size
op_assign
id|size
suffix:semicolon
)brace
)brace
id|c
op_assign
op_star
id|from
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|c
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
id|COMMAND_LINE_SIZE
op_le
op_increment
id|len
)paren
r_break
suffix:semicolon
op_star
id|to
op_increment
op_assign
id|c
suffix:semicolon
)brace
op_star
id|to
op_assign
l_char|&squot;&bslash;0&squot;
suffix:semicolon
op_star
id|cmdline_p
op_assign
id|command_line
suffix:semicolon
)brace
r_static
r_void
id|__init
DECL|function|setup_ramdisk
id|setup_ramdisk
c_func
(paren
r_int
id|doload
comma
r_int
id|prompt
comma
r_int
id|image_start
comma
r_int
r_int
id|rd_sz
)paren
(brace
macro_line|#ifdef CONFIG_BLK_DEV_RAM
r_extern
r_int
id|rd_size
comma
id|rd_image_start
comma
id|rd_prompt
comma
id|rd_doload
suffix:semicolon
id|rd_image_start
op_assign
id|image_start
suffix:semicolon
id|rd_prompt
op_assign
id|prompt
suffix:semicolon
id|rd_doload
op_assign
id|doload
suffix:semicolon
r_if
c_cond
(paren
id|rd_sz
)paren
id|rd_size
op_assign
id|rd_sz
suffix:semicolon
macro_line|#endif
)brace
r_static
r_void
id|__init
DECL|function|request_standard_resources
id|request_standard_resources
c_func
(paren
r_struct
id|meminfo
op_star
id|mi
comma
r_struct
id|machine_desc
op_star
id|mdesc
)paren
(brace
r_struct
id|resource
op_star
id|res
suffix:semicolon
r_int
id|i
suffix:semicolon
id|kernel_code.start
op_assign
id|__virt_to_phys
c_func
(paren
id|init_mm.start_code
)paren
suffix:semicolon
id|kernel_code.end
op_assign
id|__virt_to_phys
c_func
(paren
id|init_mm.end_code
op_minus
l_int|1
)paren
suffix:semicolon
id|kernel_data.start
op_assign
id|__virt_to_phys
c_func
(paren
id|init_mm.end_code
)paren
suffix:semicolon
id|kernel_data.end
op_assign
id|__virt_to_phys
c_func
(paren
id|init_mm.brk
op_minus
l_int|1
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|mi-&gt;nr_banks
suffix:semicolon
id|i
op_increment
)paren
(brace
r_int
r_int
id|virt_start
comma
id|virt_end
suffix:semicolon
r_if
c_cond
(paren
id|mi-&gt;bank
(braket
id|i
)braket
dot
id|size
op_eq
l_int|0
)paren
r_continue
suffix:semicolon
id|virt_start
op_assign
id|__phys_to_virt
c_func
(paren
id|mi-&gt;bank
(braket
id|i
)braket
dot
id|start
)paren
suffix:semicolon
id|virt_end
op_assign
id|virt_start
op_plus
id|mi-&gt;bank
(braket
id|i
)braket
dot
id|size
op_minus
l_int|1
suffix:semicolon
id|res
op_assign
id|alloc_bootmem_low
c_func
(paren
r_sizeof
(paren
op_star
id|res
)paren
)paren
suffix:semicolon
id|res-&gt;name
op_assign
l_string|&quot;System RAM&quot;
suffix:semicolon
id|res-&gt;start
op_assign
id|__virt_to_phys
c_func
(paren
id|virt_start
)paren
suffix:semicolon
id|res-&gt;end
op_assign
id|__virt_to_phys
c_func
(paren
id|virt_end
)paren
suffix:semicolon
id|res-&gt;flags
op_assign
id|IORESOURCE_MEM
op_or
id|IORESOURCE_BUSY
suffix:semicolon
id|request_resource
c_func
(paren
op_amp
id|iomem_resource
comma
id|res
)paren
suffix:semicolon
r_if
c_cond
(paren
id|kernel_code.start
op_ge
id|res-&gt;start
op_logical_and
id|kernel_code.end
op_le
id|res-&gt;end
)paren
id|request_resource
c_func
(paren
id|res
comma
op_amp
id|kernel_code
)paren
suffix:semicolon
r_if
c_cond
(paren
id|kernel_data.start
op_ge
id|res-&gt;start
op_logical_and
id|kernel_data.end
op_le
id|res-&gt;end
)paren
id|request_resource
c_func
(paren
id|res
comma
op_amp
id|kernel_data
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|mdesc-&gt;video_start
)paren
(brace
id|video_ram.start
op_assign
id|mdesc-&gt;video_start
suffix:semicolon
id|video_ram.end
op_assign
id|mdesc-&gt;video_end
suffix:semicolon
id|request_resource
c_func
(paren
op_amp
id|iomem_resource
comma
op_amp
id|video_ram
)paren
suffix:semicolon
)brace
multiline_comment|/*&n;&t; * Some machines don&squot;t have the possibility of ever&n;&t; * possessing lp0, lp1 or lp2&n;&t; */
r_if
c_cond
(paren
id|mdesc-&gt;reserve_lp0
)paren
id|request_resource
c_func
(paren
op_amp
id|ioport_resource
comma
op_amp
id|lp0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|mdesc-&gt;reserve_lp1
)paren
id|request_resource
c_func
(paren
op_amp
id|ioport_resource
comma
op_amp
id|lp1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|mdesc-&gt;reserve_lp2
)paren
id|request_resource
c_func
(paren
op_amp
id|ioport_resource
comma
op_amp
id|lp2
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; *  Tag parsing.&n; *&n; * This is the new way of passing data to the kernel at boot time.  Rather&n; * than passing a fixed inflexible structure to the kernel, we pass a list&n; * of variable-sized tags to the kernel.  The first tag must be a ATAG_CORE&n; * tag for the list to be recognised (to distinguish the tagged list from&n; * a param_struct).  The list is terminated with a zero-length tag (this tag&n; * is not parsed in any way).&n; */
DECL|function|parse_tag_core
r_static
r_int
id|__init
id|parse_tag_core
c_func
(paren
r_const
r_struct
id|tag
op_star
id|tag
)paren
(brace
r_if
c_cond
(paren
id|tag-&gt;hdr.size
OG
l_int|2
)paren
(brace
r_if
c_cond
(paren
(paren
id|tag-&gt;u.core.flags
op_amp
l_int|1
)paren
op_eq
l_int|0
)paren
id|root_mountflags
op_and_assign
op_complement
id|MS_RDONLY
suffix:semicolon
id|ROOT_DEV
op_assign
id|tag-&gt;u.core.rootdev
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
id|__tagtable
c_func
(paren
id|ATAG_CORE
comma
id|parse_tag_core
)paren
suffix:semicolon
DECL|function|parse_tag_mem32
r_static
r_int
id|__init
id|parse_tag_mem32
c_func
(paren
r_const
r_struct
id|tag
op_star
id|tag
)paren
(brace
r_if
c_cond
(paren
id|meminfo.nr_banks
op_ge
id|NR_BANKS
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;Ignoring memory bank 0x%08x size %dKB&bslash;n&quot;
comma
id|tag-&gt;u.mem.start
comma
id|tag-&gt;u.mem.size
op_div
l_int|1024
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|meminfo.bank
(braket
id|meminfo.nr_banks
)braket
dot
id|start
op_assign
id|tag-&gt;u.mem.start
suffix:semicolon
id|meminfo.bank
(braket
id|meminfo.nr_banks
)braket
dot
id|size
op_assign
id|tag-&gt;u.mem.size
suffix:semicolon
id|meminfo.bank
(braket
id|meminfo.nr_banks
)braket
dot
id|node
op_assign
id|PHYS_TO_NID
c_func
(paren
id|tag-&gt;u.mem.start
)paren
suffix:semicolon
id|meminfo.nr_banks
op_add_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|__tagtable
c_func
(paren
id|ATAG_MEM
comma
id|parse_tag_mem32
)paren
suffix:semicolon
macro_line|#if defined(CONFIG_VGA_CONSOLE) || defined(CONFIG_DUMMY_CONSOLE)
DECL|variable|screen_info
r_struct
id|screen_info
id|screen_info
op_assign
(brace
id|orig_video_lines
suffix:colon
l_int|30
comma
id|orig_video_cols
suffix:colon
l_int|80
comma
id|orig_video_mode
suffix:colon
l_int|0
comma
id|orig_video_ega_bx
suffix:colon
l_int|0
comma
id|orig_video_isVGA
suffix:colon
l_int|1
comma
id|orig_video_points
suffix:colon
l_int|8
)brace
suffix:semicolon
DECL|function|parse_tag_videotext
r_static
r_int
id|__init
id|parse_tag_videotext
c_func
(paren
r_const
r_struct
id|tag
op_star
id|tag
)paren
(brace
id|screen_info.orig_x
op_assign
id|tag-&gt;u.videotext.x
suffix:semicolon
id|screen_info.orig_y
op_assign
id|tag-&gt;u.videotext.y
suffix:semicolon
id|screen_info.orig_video_page
op_assign
id|tag-&gt;u.videotext.video_page
suffix:semicolon
id|screen_info.orig_video_mode
op_assign
id|tag-&gt;u.videotext.video_mode
suffix:semicolon
id|screen_info.orig_video_cols
op_assign
id|tag-&gt;u.videotext.video_cols
suffix:semicolon
id|screen_info.orig_video_ega_bx
op_assign
id|tag-&gt;u.videotext.video_ega_bx
suffix:semicolon
id|screen_info.orig_video_lines
op_assign
id|tag-&gt;u.videotext.video_lines
suffix:semicolon
id|screen_info.orig_video_isVGA
op_assign
id|tag-&gt;u.videotext.video_isvga
suffix:semicolon
id|screen_info.orig_video_points
op_assign
id|tag-&gt;u.videotext.video_points
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|__tagtable
c_func
(paren
id|ATAG_VIDEOTEXT
comma
id|parse_tag_videotext
)paren
suffix:semicolon
macro_line|#endif
DECL|function|parse_tag_ramdisk
r_static
r_int
id|__init
id|parse_tag_ramdisk
c_func
(paren
r_const
r_struct
id|tag
op_star
id|tag
)paren
(brace
id|setup_ramdisk
c_func
(paren
(paren
id|tag-&gt;u.ramdisk.flags
op_amp
l_int|1
)paren
op_eq
l_int|0
comma
(paren
id|tag-&gt;u.ramdisk.flags
op_amp
l_int|2
)paren
op_eq
l_int|0
comma
id|tag-&gt;u.ramdisk.start
comma
id|tag-&gt;u.ramdisk.size
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|__tagtable
c_func
(paren
id|ATAG_RAMDISK
comma
id|parse_tag_ramdisk
)paren
suffix:semicolon
DECL|function|parse_tag_initrd
r_static
r_int
id|__init
id|parse_tag_initrd
c_func
(paren
r_const
r_struct
id|tag
op_star
id|tag
)paren
(brace
id|phys_initrd_start
op_assign
id|__virt_to_phys
c_func
(paren
id|tag-&gt;u.initrd.start
)paren
suffix:semicolon
id|phys_initrd_size
op_assign
id|tag-&gt;u.initrd.size
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|__tagtable
c_func
(paren
id|ATAG_INITRD
comma
id|parse_tag_initrd
)paren
suffix:semicolon
DECL|function|parse_tag_initrd2
r_static
r_int
id|__init
id|parse_tag_initrd2
c_func
(paren
r_const
r_struct
id|tag
op_star
id|tag
)paren
(brace
id|phys_initrd_start
op_assign
id|tag-&gt;u.initrd.start
suffix:semicolon
id|phys_initrd_size
op_assign
id|tag-&gt;u.initrd.size
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|__tagtable
c_func
(paren
id|ATAG_INITRD2
comma
id|parse_tag_initrd2
)paren
suffix:semicolon
DECL|function|parse_tag_serialnr
r_static
r_int
id|__init
id|parse_tag_serialnr
c_func
(paren
r_const
r_struct
id|tag
op_star
id|tag
)paren
(brace
id|system_serial_low
op_assign
id|tag-&gt;u.serialnr.low
suffix:semicolon
id|system_serial_high
op_assign
id|tag-&gt;u.serialnr.high
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|__tagtable
c_func
(paren
id|ATAG_SERIAL
comma
id|parse_tag_serialnr
)paren
suffix:semicolon
DECL|function|parse_tag_revision
r_static
r_int
id|__init
id|parse_tag_revision
c_func
(paren
r_const
r_struct
id|tag
op_star
id|tag
)paren
(brace
id|system_rev
op_assign
id|tag-&gt;u.revision.rev
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|__tagtable
c_func
(paren
id|ATAG_REVISION
comma
id|parse_tag_revision
)paren
suffix:semicolon
DECL|function|parse_tag_cmdline
r_static
r_int
id|__init
id|parse_tag_cmdline
c_func
(paren
r_const
r_struct
id|tag
op_star
id|tag
)paren
(brace
id|strncpy
c_func
(paren
id|default_command_line
comma
id|tag-&gt;u.cmdline.cmdline
comma
id|COMMAND_LINE_SIZE
)paren
suffix:semicolon
id|default_command_line
(braket
id|COMMAND_LINE_SIZE
op_minus
l_int|1
)braket
op_assign
l_char|&squot;&bslash;0&squot;
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|__tagtable
c_func
(paren
id|ATAG_CMDLINE
comma
id|parse_tag_cmdline
)paren
suffix:semicolon
multiline_comment|/*&n; * Scan the tag table for this tag, and call its parse function.&n; * The tag table is built by the linker from all the __tagtable&n; * declarations.&n; */
DECL|function|parse_tag
r_static
r_int
id|__init
id|parse_tag
c_func
(paren
r_const
r_struct
id|tag
op_star
id|tag
)paren
(brace
r_extern
r_struct
id|tagtable
id|__tagtable_begin
comma
id|__tagtable_end
suffix:semicolon
r_struct
id|tagtable
op_star
id|t
suffix:semicolon
r_for
c_loop
(paren
id|t
op_assign
op_amp
id|__tagtable_begin
suffix:semicolon
id|t
OL
op_amp
id|__tagtable_end
suffix:semicolon
id|t
op_increment
)paren
r_if
c_cond
(paren
id|tag-&gt;hdr.tag
op_eq
id|t-&gt;tag
)paren
(brace
id|t
op_member_access_from_pointer
id|parse
c_func
(paren
id|tag
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_return
id|t
OL
op_amp
id|__tagtable_end
suffix:semicolon
)brace
multiline_comment|/*&n; * Parse all tags in the list, checking both the global and architecture&n; * specific tag tables.&n; */
DECL|function|parse_tags
r_static
r_void
id|__init
id|parse_tags
c_func
(paren
r_const
r_struct
id|tag
op_star
id|t
)paren
(brace
r_for
c_loop
(paren
suffix:semicolon
id|t-&gt;hdr.size
suffix:semicolon
id|t
op_assign
id|tag_next
c_func
(paren
id|t
)paren
)paren
r_if
c_cond
(paren
op_logical_neg
id|parse_tag
c_func
(paren
id|t
)paren
)paren
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;Ignoring unrecognised tag 0x%08x&bslash;n&quot;
comma
id|t-&gt;hdr.tag
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * This holds our defaults.&n; */
DECL|struct|init_tags
r_static
r_struct
id|init_tags
(brace
DECL|member|hdr1
r_struct
id|tag_header
id|hdr1
suffix:semicolon
DECL|member|core
r_struct
id|tag_core
id|core
suffix:semicolon
DECL|member|hdr2
r_struct
id|tag_header
id|hdr2
suffix:semicolon
DECL|member|mem
r_struct
id|tag_mem32
id|mem
suffix:semicolon
DECL|member|hdr3
r_struct
id|tag_header
id|hdr3
suffix:semicolon
DECL|variable|__initdata
)brace
id|init_tags
id|__initdata
op_assign
(brace
(brace
id|tag_size
c_func
(paren
id|tag_core
)paren
comma
id|ATAG_CORE
)brace
comma
(brace
l_int|1
comma
id|PAGE_SIZE
comma
l_int|0xff
)brace
comma
(brace
id|tag_size
c_func
(paren
id|tag_mem32
)paren
comma
id|ATAG_MEM
)brace
comma
(brace
id|MEM_SIZE
comma
id|PHYS_OFFSET
)brace
comma
(brace
l_int|0
comma
id|ATAG_NONE
)brace
)brace
suffix:semicolon
DECL|function|setup_arch
r_void
id|__init
id|setup_arch
c_func
(paren
r_char
op_star
op_star
id|cmdline_p
)paren
(brace
r_struct
id|tag
op_star
id|tags
op_assign
(paren
r_struct
id|tag
op_star
)paren
op_amp
id|init_tags
suffix:semicolon
r_struct
id|machine_desc
op_star
id|mdesc
suffix:semicolon
r_char
op_star
id|from
op_assign
id|default_command_line
suffix:semicolon
id|setup_processor
c_func
(paren
)paren
suffix:semicolon
id|mdesc
op_assign
id|setup_machine
c_func
(paren
id|machine_arch_type
)paren
suffix:semicolon
id|machine_name
op_assign
id|mdesc-&gt;name
suffix:semicolon
r_if
c_cond
(paren
id|mdesc-&gt;soft_reboot
)paren
id|reboot_setup
c_func
(paren
l_string|&quot;s&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|mdesc-&gt;param_offset
)paren
id|tags
op_assign
id|phys_to_virt
c_func
(paren
id|mdesc-&gt;param_offset
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * If we have the old style parameters, convert them to&n;&t; * a tag list.&n;&t; */
r_if
c_cond
(paren
id|tags-&gt;hdr.tag
op_ne
id|ATAG_CORE
)paren
id|convert_to_tag_list
c_func
(paren
id|tags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tags-&gt;hdr.tag
op_ne
id|ATAG_CORE
)paren
id|tags
op_assign
(paren
r_struct
id|tag
op_star
)paren
op_amp
id|init_tags
suffix:semicolon
r_if
c_cond
(paren
id|mdesc-&gt;fixup
)paren
id|mdesc
op_member_access_from_pointer
id|fixup
c_func
(paren
id|mdesc
comma
id|tags
comma
op_amp
id|from
comma
op_amp
id|meminfo
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tags-&gt;hdr.tag
op_eq
id|ATAG_CORE
)paren
(brace
r_if
c_cond
(paren
id|meminfo.nr_banks
op_ne
l_int|0
)paren
id|squash_mem_tags
c_func
(paren
id|tags
)paren
suffix:semicolon
id|parse_tags
c_func
(paren
id|tags
)paren
suffix:semicolon
)brace
id|init_mm.start_code
op_assign
(paren
r_int
r_int
)paren
op_amp
id|_text
suffix:semicolon
id|init_mm.end_code
op_assign
(paren
r_int
r_int
)paren
op_amp
id|_etext
suffix:semicolon
id|init_mm.end_data
op_assign
(paren
r_int
r_int
)paren
op_amp
id|_edata
suffix:semicolon
id|init_mm.brk
op_assign
(paren
r_int
r_int
)paren
op_amp
id|_end
suffix:semicolon
id|memcpy
c_func
(paren
id|saved_command_line
comma
id|from
comma
id|COMMAND_LINE_SIZE
)paren
suffix:semicolon
id|saved_command_line
(braket
id|COMMAND_LINE_SIZE
op_minus
l_int|1
)braket
op_assign
l_char|&squot;&bslash;0&squot;
suffix:semicolon
id|parse_cmdline
c_func
(paren
op_amp
id|meminfo
comma
id|cmdline_p
comma
id|from
)paren
suffix:semicolon
id|bootmem_init
c_func
(paren
op_amp
id|meminfo
)paren
suffix:semicolon
id|paging_init
c_func
(paren
op_amp
id|meminfo
comma
id|mdesc
)paren
suffix:semicolon
id|request_standard_resources
c_func
(paren
op_amp
id|meminfo
comma
id|mdesc
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * Set up various architecture-specific pointers&n;&t; */
id|init_arch_irq
op_assign
id|mdesc-&gt;init_irq
suffix:semicolon
macro_line|#ifdef CONFIG_VT
macro_line|#if defined(CONFIG_VGA_CONSOLE)
id|conswitchp
op_assign
op_amp
id|vga_con
suffix:semicolon
macro_line|#elif defined(CONFIG_DUMMY_CONSOLE)
id|conswitchp
op_assign
op_amp
id|dummy_con
suffix:semicolon
macro_line|#endif
macro_line|#endif
)brace
DECL|variable|hwcap_str
r_static
r_const
r_char
op_star
id|hwcap_str
(braket
)braket
op_assign
(brace
l_string|&quot;swp&quot;
comma
l_string|&quot;half&quot;
comma
l_string|&quot;thumb&quot;
comma
l_string|&quot;26bit&quot;
comma
l_string|&quot;fastmult&quot;
comma
l_string|&quot;fpa&quot;
comma
l_string|&quot;vfp&quot;
comma
l_string|&quot;edsp&quot;
comma
l_int|NULL
)brace
suffix:semicolon
DECL|variable|proc_arch
r_static
r_const
r_char
op_star
id|proc_arch
(braket
l_int|16
)braket
op_assign
(brace
l_string|&quot;undefined 0&quot;
comma
l_string|&quot;4&quot;
comma
l_string|&quot;4T&quot;
comma
l_string|&quot;5&quot;
comma
l_string|&quot;5T&quot;
comma
l_string|&quot;5TE&quot;
comma
l_string|&quot;undefined 6&quot;
comma
l_string|&quot;undefined 7&quot;
comma
l_string|&quot;undefined 8&quot;
comma
l_string|&quot;undefined 9&quot;
comma
l_string|&quot;undefined 10&quot;
comma
l_string|&quot;undefined 11&quot;
comma
l_string|&quot;undefined 12&quot;
comma
l_string|&quot;undefined 13&quot;
comma
l_string|&quot;undefined 14&quot;
comma
l_string|&quot;undefined 15&quot;
)brace
suffix:semicolon
r_static
r_void
DECL|function|c_show_cache
id|c_show_cache
c_func
(paren
r_struct
id|seq_file
op_star
id|m
comma
r_const
r_char
op_star
id|type
comma
r_int
r_int
id|cache
)paren
(brace
r_int
r_int
id|mult
op_assign
l_int|2
op_plus
(paren
id|CACHE_M
c_func
(paren
id|cache
)paren
ques
c_cond
l_int|1
suffix:colon
l_int|0
)paren
suffix:semicolon
id|seq_printf
c_func
(paren
id|m
comma
l_string|&quot;%s size&bslash;t&bslash;t: %d&bslash;n&quot;
l_string|&quot;%s assoc&bslash;t&bslash;t: %d&bslash;n&quot;
l_string|&quot;%s line length&bslash;t: %d&bslash;n&quot;
l_string|&quot;%s sets&bslash;t&bslash;t: %d&bslash;n&quot;
comma
id|type
comma
id|mult
op_lshift
(paren
l_int|8
op_plus
id|CACHE_SIZE
c_func
(paren
id|cache
)paren
)paren
comma
id|type
comma
(paren
id|mult
op_lshift
id|CACHE_ASSOC
c_func
(paren
id|cache
)paren
)paren
op_rshift
l_int|1
comma
id|type
comma
l_int|8
op_lshift
id|CACHE_LINE
c_func
(paren
id|cache
)paren
comma
id|type
comma
l_int|1
op_lshift
(paren
l_int|6
op_plus
id|CACHE_SIZE
c_func
(paren
id|cache
)paren
op_minus
id|CACHE_ASSOC
c_func
(paren
id|cache
)paren
op_minus
id|CACHE_LINE
c_func
(paren
id|cache
)paren
)paren
)paren
suffix:semicolon
)brace
DECL|function|c_show
r_static
r_int
id|c_show
c_func
(paren
r_struct
id|seq_file
op_star
id|m
comma
r_void
op_star
id|v
)paren
(brace
r_int
id|i
suffix:semicolon
id|seq_printf
c_func
(paren
id|m
comma
l_string|&quot;Processor&bslash;t: %s %s rev %d (%s)&bslash;n&quot;
comma
id|proc_info.manufacturer
comma
id|proc_info.cpu_name
comma
(paren
r_int
)paren
id|processor_id
op_amp
l_int|15
comma
id|elf_platform
)paren
suffix:semicolon
id|seq_printf
c_func
(paren
id|m
comma
l_string|&quot;BogoMIPS&bslash;t: %lu.%02lu&bslash;n&quot;
comma
id|loops_per_jiffy
op_div
(paren
l_int|500000
op_div
id|HZ
)paren
comma
(paren
id|loops_per_jiffy
op_div
(paren
l_int|5000
op_div
id|HZ
)paren
)paren
op_mod
l_int|100
)paren
suffix:semicolon
multiline_comment|/* dump out the processor features */
id|seq_puts
c_func
(paren
id|m
comma
l_string|&quot;Features&bslash;t: &quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|hwcap_str
(braket
id|i
)braket
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|elf_hwcap
op_amp
(paren
l_int|1
op_lshift
id|i
)paren
)paren
id|seq_printf
c_func
(paren
id|m
comma
l_string|&quot;%s &quot;
comma
id|hwcap_str
(braket
id|i
)braket
)paren
suffix:semicolon
id|seq_puts
c_func
(paren
id|m
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|processor_id
op_amp
l_int|0x0000f000
)paren
op_eq
l_int|0x00000000
)paren
(brace
multiline_comment|/* pre-ARM7 */
id|seq_printf
c_func
(paren
id|m
comma
l_string|&quot;CPU part&bslash;t&bslash;t: %07x&bslash;n&quot;
comma
id|processor_id
op_rshift
l_int|4
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
(paren
id|processor_id
op_amp
l_int|0x0000f000
)paren
op_eq
l_int|0x00007000
)paren
(brace
multiline_comment|/* ARM7 */
id|seq_printf
c_func
(paren
id|m
comma
l_string|&quot;CPU implementor&bslash;t: 0x%02x&bslash;n&quot;
l_string|&quot;CPU architecture: %s&bslash;n&quot;
l_string|&quot;CPU variant&bslash;t: 0x%02x&bslash;n&quot;
l_string|&quot;CPU part&bslash;t: 0x%03x&bslash;n&quot;
comma
id|processor_id
op_rshift
l_int|24
comma
id|processor_id
op_amp
(paren
l_int|1
op_lshift
l_int|23
)paren
ques
c_cond
l_string|&quot;4T&quot;
suffix:colon
l_string|&quot;3&quot;
comma
(paren
id|processor_id
op_rshift
l_int|16
)paren
op_amp
l_int|127
comma
(paren
id|processor_id
op_rshift
l_int|4
)paren
op_amp
l_int|0xfff
)paren
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* post-ARM7 */
id|seq_printf
c_func
(paren
id|m
comma
l_string|&quot;CPU implementor&bslash;t: 0x%02x&bslash;n&quot;
l_string|&quot;CPU architecture: %s&bslash;n&quot;
l_string|&quot;CPU variant&bslash;t: 0x%x&bslash;n&quot;
l_string|&quot;CPU part&bslash;t: 0x%03x&bslash;n&quot;
comma
id|processor_id
op_rshift
l_int|24
comma
id|proc_arch
(braket
(paren
id|processor_id
op_rshift
l_int|16
)paren
op_amp
l_int|15
)braket
comma
(paren
id|processor_id
op_rshift
l_int|20
)paren
op_amp
l_int|15
comma
(paren
id|processor_id
op_rshift
l_int|4
)paren
op_amp
l_int|0xfff
)paren
suffix:semicolon
)brace
id|seq_printf
c_func
(paren
id|m
comma
l_string|&quot;CPU revision&bslash;t: %d&bslash;n&quot;
comma
id|processor_id
op_amp
l_int|15
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_CPU_32
(brace
r_int
r_int
id|cache_info
suffix:semicolon
id|asm
c_func
(paren
l_string|&quot;mrc p15, 0, %0, c0, c0, 1&quot;
suffix:colon
l_string|&quot;=r&quot;
(paren
id|cache_info
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|cache_info
op_ne
id|processor_id
)paren
(brace
id|seq_printf
c_func
(paren
id|m
comma
l_string|&quot;Cache type&bslash;t: %s&bslash;n&quot;
l_string|&quot;Cache clean&bslash;t: %s&bslash;n&quot;
l_string|&quot;Cache lockdown&bslash;t: %s&bslash;n&quot;
l_string|&quot;Cache unified&bslash;t: %s&bslash;n&quot;
comma
id|cache_types
(braket
id|CACHE_TYPE
c_func
(paren
id|cache_info
)paren
)braket
comma
id|cache_clean
(braket
id|CACHE_TYPE
c_func
(paren
id|cache_info
)paren
)braket
comma
id|cache_lockdown
(braket
id|CACHE_TYPE
c_func
(paren
id|cache_info
)paren
)braket
comma
id|CACHE_S
c_func
(paren
id|cache_info
)paren
ques
c_cond
l_string|&quot;Harvard&quot;
suffix:colon
l_string|&quot;Unified&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|CACHE_S
c_func
(paren
id|cache_info
)paren
)paren
(brace
id|c_show_cache
c_func
(paren
id|m
comma
l_string|&quot;I&quot;
comma
id|CACHE_ISIZE
c_func
(paren
id|cache_info
)paren
)paren
suffix:semicolon
id|c_show_cache
c_func
(paren
id|m
comma
l_string|&quot;D&quot;
comma
id|CACHE_DSIZE
c_func
(paren
id|cache_info
)paren
)paren
suffix:semicolon
)brace
r_else
(brace
id|c_show_cache
c_func
(paren
id|m
comma
l_string|&quot;Cache&quot;
comma
id|CACHE_ISIZE
c_func
(paren
id|cache_info
)paren
)paren
suffix:semicolon
)brace
)brace
)brace
macro_line|#endif
id|seq_puts
c_func
(paren
id|m
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|seq_printf
c_func
(paren
id|m
comma
l_string|&quot;Hardware&bslash;t: %s&bslash;n&quot;
comma
id|machine_name
)paren
suffix:semicolon
id|seq_printf
c_func
(paren
id|m
comma
l_string|&quot;Revision&bslash;t: %04x&bslash;n&quot;
comma
id|system_rev
)paren
suffix:semicolon
id|seq_printf
c_func
(paren
id|m
comma
l_string|&quot;Serial&bslash;t&bslash;t: %08x%08x&bslash;n&quot;
comma
id|system_serial_high
comma
id|system_serial_low
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|c_start
r_static
r_void
op_star
id|c_start
c_func
(paren
r_struct
id|seq_file
op_star
id|m
comma
id|loff_t
op_star
id|pos
)paren
(brace
r_return
op_star
id|pos
OL
l_int|1
ques
c_cond
(paren
r_void
op_star
)paren
l_int|1
suffix:colon
l_int|NULL
suffix:semicolon
)brace
DECL|function|c_next
r_static
r_void
op_star
id|c_next
c_func
(paren
r_struct
id|seq_file
op_star
id|m
comma
r_void
op_star
id|v
comma
id|loff_t
op_star
id|pos
)paren
(brace
op_increment
op_star
id|pos
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
DECL|function|c_stop
r_static
r_void
id|c_stop
c_func
(paren
r_struct
id|seq_file
op_star
id|m
comma
r_void
op_star
id|v
)paren
(brace
)brace
DECL|variable|cpuinfo_op
r_struct
id|seq_operations
id|cpuinfo_op
op_assign
(brace
dot
id|start
op_assign
id|c_start
comma
dot
id|next
op_assign
id|c_next
comma
dot
id|stop
op_assign
id|c_stop
comma
dot
id|show
op_assign
id|c_show
)brace
suffix:semicolon
eof
