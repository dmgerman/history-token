multiline_comment|/* arch/arm/mach-lh7a40x/irq-lh7a400.c&n; *&n; *  Copyright (C) 2004 Coastal Environmental Systems&n; *&n; *  This program is free software; you can redistribute it and/or&n; *  modify it under the terms of the GNU General Public License&n; *  version 2 as published by the Free Software Foundation.&n; *&n; */
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/interrupt.h&gt;
macro_line|#include &lt;linux/ptrace.h&gt;
macro_line|#include &lt;asm/hardware.h&gt;
macro_line|#include &lt;asm/irq.h&gt;
macro_line|#include &lt;asm/mach/irq.h&gt;
macro_line|#include &lt;asm/arch/irq.h&gt;
macro_line|#include &lt;asm/arch/irqs.h&gt;
multiline_comment|/* CPU IRQ handling */
DECL|function|lh7a400_mask_irq
r_static
r_void
id|lh7a400_mask_irq
(paren
id|u32
id|irq
)paren
(brace
id|INTC_INTENC
op_assign
(paren
l_int|1
op_lshift
id|irq
)paren
suffix:semicolon
)brace
DECL|function|lh7a400_unmask_irq
r_static
r_void
id|lh7a400_unmask_irq
(paren
id|u32
id|irq
)paren
(brace
id|INTC_INTENS
op_assign
(paren
l_int|1
op_lshift
id|irq
)paren
suffix:semicolon
)brace
DECL|function|lh7a400_ack_gpio_irq
r_static
r_void
id|lh7a400_ack_gpio_irq
(paren
id|u32
id|irq
)paren
(brace
id|GPIO_GPIOFEOI
op_assign
(paren
l_int|1
op_lshift
id|IRQ_TO_GPIO
(paren
id|irq
)paren
)paren
suffix:semicolon
id|INTC_INTENC
op_assign
(paren
l_int|1
op_lshift
id|irq
)paren
suffix:semicolon
)brace
DECL|variable|lh7a400_internal_chip
r_static
r_struct
id|irqchip
id|lh7a400_internal_chip
op_assign
(brace
dot
id|ack
op_assign
id|lh7a400_mask_irq
comma
multiline_comment|/* Level triggering -&gt; mask is ack */
dot
id|mask
op_assign
id|lh7a400_mask_irq
comma
dot
id|unmask
op_assign
id|lh7a400_unmask_irq
comma
)brace
suffix:semicolon
DECL|variable|lh7a400_gpio_chip
r_static
r_struct
id|irqchip
id|lh7a400_gpio_chip
op_assign
(brace
dot
id|ack
op_assign
id|lh7a400_ack_gpio_irq
comma
dot
id|mask
op_assign
id|lh7a400_mask_irq
comma
dot
id|unmask
op_assign
id|lh7a400_unmask_irq
comma
)brace
suffix:semicolon
multiline_comment|/* IRQ initialization */
DECL|function|lh7a400_init_irq
r_void
id|__init
id|lh7a400_init_irq
(paren
r_void
)paren
(brace
r_int
id|irq
suffix:semicolon
id|INTC_INTENC
op_assign
l_int|0xffffffff
suffix:semicolon
multiline_comment|/* Disable all interrupts */
id|GPIO_GPIOFINTEN
op_assign
l_int|0x00
suffix:semicolon
multiline_comment|/* Disable all GPIOF interrupts */
id|barrier
(paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|irq
op_assign
l_int|0
suffix:semicolon
id|irq
OL
id|NR_IRQS
suffix:semicolon
op_increment
id|irq
)paren
(brace
r_switch
c_cond
(paren
id|irq
)paren
(brace
r_case
id|IRQ_GPIO0INTR
suffix:colon
r_case
id|IRQ_GPIO1INTR
suffix:colon
r_case
id|IRQ_GPIO2INTR
suffix:colon
r_case
id|IRQ_GPIO3INTR
suffix:colon
r_case
id|IRQ_GPIO4INTR
suffix:colon
r_case
id|IRQ_GPIO5INTR
suffix:colon
r_case
id|IRQ_GPIO6INTR
suffix:colon
r_case
id|IRQ_GPIO7INTR
suffix:colon
id|set_irq_chip
(paren
id|irq
comma
op_amp
id|lh7a400_gpio_chip
)paren
suffix:semicolon
id|set_irq_handler
(paren
id|irq
comma
id|do_level_IRQ
)paren
suffix:semicolon
multiline_comment|/* OK default */
r_break
suffix:semicolon
r_default
suffix:colon
id|set_irq_chip
(paren
id|irq
comma
op_amp
id|lh7a400_internal_chip
)paren
suffix:semicolon
id|set_irq_handler
(paren
id|irq
comma
id|do_level_IRQ
)paren
suffix:semicolon
)brace
id|set_irq_flags
(paren
id|irq
comma
id|IRQF_VALID
)paren
suffix:semicolon
)brace
id|lh7a40x_init_board_irq
(paren
)paren
suffix:semicolon
multiline_comment|/* *** FIXME: the LH7a400 does use FIQ interrupts in some cases.  For&n;   the time being, these are not initialized. */
multiline_comment|/*&t;init_FIQ(); */
)brace
eof
