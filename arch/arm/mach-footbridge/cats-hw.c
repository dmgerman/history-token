multiline_comment|/*&n; * linux/arch/arm/mach-footbridge/cats-hw.c&n; *&n; * CATS machine fixup&n; *&n; * Copyright (C) 1998, 1999 Russell King, Phil Blundell&n; */
macro_line|#include &lt;linux/ioport.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;asm/hardware/dec21285.h&gt;
macro_line|#include &lt;asm/io.h&gt;
macro_line|#include &lt;asm/mach-types.h&gt;
macro_line|#include &lt;asm/setup.h&gt;
macro_line|#include &lt;asm/mach/arch.h&gt;
macro_line|#include &quot;common.h&quot;
DECL|macro|CFG_PORT
mdefine_line|#define CFG_PORT&t;0x370
DECL|macro|INDEX_PORT
mdefine_line|#define INDEX_PORT&t;(CFG_PORT)
DECL|macro|DATA_PORT
mdefine_line|#define DATA_PORT&t;(CFG_PORT + 1)
DECL|function|cats_hw_init
r_static
r_int
id|__init
id|cats_hw_init
c_func
(paren
r_void
)paren
(brace
r_if
c_cond
(paren
id|machine_is_cats
c_func
(paren
)paren
)paren
(brace
multiline_comment|/* Set Aladdin to CONFIGURE mode */
id|outb
c_func
(paren
l_int|0x51
comma
id|CFG_PORT
)paren
suffix:semicolon
id|outb
c_func
(paren
l_int|0x23
comma
id|CFG_PORT
)paren
suffix:semicolon
multiline_comment|/* Select logical device 3 */
id|outb
c_func
(paren
l_int|0x07
comma
id|INDEX_PORT
)paren
suffix:semicolon
id|outb
c_func
(paren
l_int|0x03
comma
id|DATA_PORT
)paren
suffix:semicolon
multiline_comment|/* Set parallel port to DMA channel 3, ECP+EPP1.9, &n;&t;&t;   enable EPP timeout */
id|outb
c_func
(paren
l_int|0x74
comma
id|INDEX_PORT
)paren
suffix:semicolon
id|outb
c_func
(paren
l_int|0x03
comma
id|DATA_PORT
)paren
suffix:semicolon
id|outb
c_func
(paren
l_int|0xf0
comma
id|INDEX_PORT
)paren
suffix:semicolon
id|outb
c_func
(paren
l_int|0x0f
comma
id|DATA_PORT
)paren
suffix:semicolon
id|outb
c_func
(paren
l_int|0xf1
comma
id|INDEX_PORT
)paren
suffix:semicolon
id|outb
c_func
(paren
l_int|0x07
comma
id|DATA_PORT
)paren
suffix:semicolon
multiline_comment|/* Select logical device 4 */
id|outb
c_func
(paren
l_int|0x07
comma
id|INDEX_PORT
)paren
suffix:semicolon
id|outb
c_func
(paren
l_int|0x04
comma
id|DATA_PORT
)paren
suffix:semicolon
multiline_comment|/* UART1 high speed mode */
id|outb
c_func
(paren
l_int|0xf0
comma
id|INDEX_PORT
)paren
suffix:semicolon
id|outb
c_func
(paren
l_int|0x02
comma
id|DATA_PORT
)paren
suffix:semicolon
multiline_comment|/* Select logical device 5 */
id|outb
c_func
(paren
l_int|0x07
comma
id|INDEX_PORT
)paren
suffix:semicolon
id|outb
c_func
(paren
l_int|0x05
comma
id|DATA_PORT
)paren
suffix:semicolon
multiline_comment|/* UART2 high speed mode */
id|outb
c_func
(paren
l_int|0xf0
comma
id|INDEX_PORT
)paren
suffix:semicolon
id|outb
c_func
(paren
l_int|0x02
comma
id|DATA_PORT
)paren
suffix:semicolon
multiline_comment|/* Set Aladdin to RUN mode */
id|outb
c_func
(paren
l_int|0xbb
comma
id|CFG_PORT
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|cats_hw_init
id|__initcall
c_func
(paren
id|cats_hw_init
)paren
suffix:semicolon
multiline_comment|/*&n; * CATS uses soft-reboot by default, since&n; * hard reboots fail on early boards.&n; */
r_static
r_void
id|__init
DECL|function|fixup_cats
id|fixup_cats
c_func
(paren
r_struct
id|machine_desc
op_star
id|desc
comma
r_struct
id|tag
op_star
id|tags
comma
r_char
op_star
op_star
id|cmdline
comma
r_struct
id|meminfo
op_star
id|mi
)paren
(brace
id|ORIG_VIDEO_LINES
op_assign
l_int|25
suffix:semicolon
id|ORIG_VIDEO_POINTS
op_assign
l_int|16
suffix:semicolon
id|ORIG_Y
op_assign
l_int|24
suffix:semicolon
)brace
id|MACHINE_START
c_func
(paren
id|CATS
comma
l_string|&quot;Chalice-CATS&quot;
)paren
id|MAINTAINER
c_func
(paren
l_string|&quot;Philip Blundell&quot;
)paren
id|BOOT_MEM
c_func
(paren
l_int|0x00000000
comma
id|DC21285_ARMCSR_BASE
comma
l_int|0xfe000000
)paren
id|BOOT_PARAMS
c_func
(paren
l_int|0x00000100
)paren
id|SOFT_REBOOT
id|FIXUP
c_func
(paren
id|fixup_cats
)paren
id|MAPIO
c_func
(paren
id|footbridge_map_io
)paren
id|INITIRQ
c_func
(paren
id|footbridge_init_irq
)paren
dot
id|timer
op_assign
op_amp
id|isa_timer
comma
id|MACHINE_END
eof
