multiline_comment|/*&n; * arch/arm/mach-ixp4xx/prpmc1100-pci.c &n; *&n; * PrPMC1100 PCI initialization&n; *&n; * Copyright (C) 2003-2004 MontaVista Sofwtare, Inc. &n; * Based on IXDP425 code originally (C) Intel Corporation&n; *&n; * Author: Deepak Saxena &lt;dsaxena@plexity.net&gt;&n; *&n; * PrPMC1100 PCI init code.  GPIO usage is similar to that on &n; * IXDP425, but the IRQ routing is completely different and&n; * depends on what carrier you are using. This code is written&n; * to work on the Motorola PrPMC800 ATX carrier board.&n; *&n; * This program is free software; you can redistribute it and/or modify&n; * it under the terms of the GNU General Public License version 2 as&n; * published by the Free Software Foundation.&n; *&n; */
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/pci.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;asm/mach-types.h&gt;
macro_line|#include &lt;asm/irq.h&gt;
macro_line|#include &lt;asm/hardware.h&gt;
macro_line|#include &lt;asm/mach/pci.h&gt;
DECL|function|prpmc1100_pci_preinit
r_void
id|__init
id|prpmc1100_pci_preinit
c_func
(paren
r_void
)paren
(brace
id|gpio_line_config
c_func
(paren
id|PRPMC1100_PCI_INTA_PIN
comma
id|IXP4XX_GPIO_IN
op_or
id|IXP4XX_GPIO_ACTIVE_LOW
)paren
suffix:semicolon
id|gpio_line_config
c_func
(paren
id|PRPMC1100_PCI_INTB_PIN
comma
id|IXP4XX_GPIO_IN
op_or
id|IXP4XX_GPIO_ACTIVE_LOW
)paren
suffix:semicolon
id|gpio_line_config
c_func
(paren
id|PRPMC1100_PCI_INTC_PIN
comma
id|IXP4XX_GPIO_IN
op_or
id|IXP4XX_GPIO_ACTIVE_LOW
)paren
suffix:semicolon
id|gpio_line_config
c_func
(paren
id|PRPMC1100_PCI_INTD_PIN
comma
id|IXP4XX_GPIO_IN
op_or
id|IXP4XX_GPIO_ACTIVE_LOW
)paren
suffix:semicolon
id|gpio_line_isr_clear
c_func
(paren
id|PRPMC1100_PCI_INTA_PIN
)paren
suffix:semicolon
id|gpio_line_isr_clear
c_func
(paren
id|PRPMC1100_PCI_INTB_PIN
)paren
suffix:semicolon
id|gpio_line_isr_clear
c_func
(paren
id|PRPMC1100_PCI_INTC_PIN
)paren
suffix:semicolon
id|gpio_line_isr_clear
c_func
(paren
id|PRPMC1100_PCI_INTD_PIN
)paren
suffix:semicolon
id|ixp4xx_pci_preinit
c_func
(paren
)paren
suffix:semicolon
)brace
DECL|function|prpmc1100_map_irq
r_static
r_int
id|__init
id|prpmc1100_map_irq
c_func
(paren
r_struct
id|pci_dev
op_star
id|dev
comma
id|u8
id|slot
comma
id|u8
id|pin
)paren
(brace
r_int
id|irq
op_assign
op_minus
l_int|1
suffix:semicolon
r_static
r_int
id|pci_irq_table
(braket
)braket
(braket
l_int|4
)braket
op_assign
(brace
(brace
multiline_comment|/* IDSEL 16 - PMC A1 */
id|IRQ_PRPMC1100_PCI_INTD
comma
id|IRQ_PRPMC1100_PCI_INTA
comma
id|IRQ_PRPMC1100_PCI_INTB
comma
id|IRQ_PRPMC1100_PCI_INTC
)brace
comma
(brace
multiline_comment|/* IDSEL 17 - PRPMC-A-B */
id|IRQ_PRPMC1100_PCI_INTD
comma
id|IRQ_PRPMC1100_PCI_INTA
comma
id|IRQ_PRPMC1100_PCI_INTB
comma
id|IRQ_PRPMC1100_PCI_INTC
)brace
comma
(brace
multiline_comment|/* IDSEL 18 - PMC A1-B */
id|IRQ_PRPMC1100_PCI_INTA
comma
id|IRQ_PRPMC1100_PCI_INTB
comma
id|IRQ_PRPMC1100_PCI_INTC
comma
id|IRQ_PRPMC1100_PCI_INTD
)brace
comma
(brace
multiline_comment|/* IDSEL 19 - Unused */
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
(brace
multiline_comment|/* IDSEL 20 - P2P Bridge */
id|IRQ_PRPMC1100_PCI_INTA
comma
id|IRQ_PRPMC1100_PCI_INTB
comma
id|IRQ_PRPMC1100_PCI_INTC
comma
id|IRQ_PRPMC1100_PCI_INTD
)brace
comma
(brace
multiline_comment|/* IDSEL 21 - PMC A2 */
id|IRQ_PRPMC1100_PCI_INTC
comma
id|IRQ_PRPMC1100_PCI_INTD
comma
id|IRQ_PRPMC1100_PCI_INTA
comma
id|IRQ_PRPMC1100_PCI_INTB
)brace
comma
(brace
multiline_comment|/* IDSEL 22 - PMC A2-B */
id|IRQ_PRPMC1100_PCI_INTD
comma
id|IRQ_PRPMC1100_PCI_INTA
comma
id|IRQ_PRPMC1100_PCI_INTB
comma
id|IRQ_PRPMC1100_PCI_INTC
)brace
comma
)brace
suffix:semicolon
r_if
c_cond
(paren
id|slot
op_ge
id|PRPMC1100_PCI_MIN_DEVID
op_logical_and
id|slot
op_le
id|PRPMC1100_PCI_MAX_DEVID
op_logical_and
id|pin
op_ge
l_int|1
op_logical_and
id|pin
op_le
id|PRPMC1100_PCI_IRQ_LINES
)paren
(brace
id|irq
op_assign
id|pci_irq_table
(braket
id|slot
op_minus
id|PRPMC1100_PCI_MIN_DEVID
)braket
(braket
id|pin
op_minus
l_int|1
)braket
suffix:semicolon
)brace
r_return
id|irq
suffix:semicolon
)brace
DECL|variable|__initdata
r_struct
id|hw_pci
id|prpmc1100_pci
id|__initdata
op_assign
(brace
dot
id|nr_controllers
op_assign
l_int|1
comma
dot
id|preinit
op_assign
id|prpmc1100_pci_preinit
comma
dot
id|swizzle
op_assign
id|pci_std_swizzle
comma
dot
id|setup
op_assign
id|ixp4xx_setup
comma
dot
id|scan
op_assign
id|ixp4xx_scan_bus
comma
dot
id|map_irq
op_assign
id|prpmc1100_map_irq
comma
)brace
suffix:semicolon
DECL|function|prpmc1100_pci_init
r_int
id|__init
id|prpmc1100_pci_init
c_func
(paren
r_void
)paren
(brace
r_if
c_cond
(paren
id|machine_is_prpmc1100
c_func
(paren
)paren
)paren
id|pci_common_init
c_func
(paren
op_amp
id|prpmc1100_pci
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|prpmc1100_pci_init
id|subsys_initcall
c_func
(paren
id|prpmc1100_pci_init
)paren
suffix:semicolon
eof
