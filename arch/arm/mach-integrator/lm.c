multiline_comment|/*&n; *  linux/arch/arm/mach-integrator/lm.c&n; *&n; *  Copyright (C) 2003 Deep Blue Solutions Ltd, All Rights Reserved.&n; *&n; * This program is free software; you can redistribute it and/or modify&n; * it under the terms of the GNU General Public License version 2 as&n; * published by the Free Software Foundation.&n; */
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/device.h&gt;
macro_line|#include &lt;asm/arch/lm.h&gt;
DECL|macro|to_lm_device
mdefine_line|#define to_lm_device(d)&t;container_of(d, struct lm_device, dev)
DECL|macro|to_lm_driver
mdefine_line|#define to_lm_driver(d)&t;container_of(d, struct lm_driver, drv)
DECL|function|lm_match
r_static
r_int
id|lm_match
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_struct
id|device_driver
op_star
id|drv
)paren
(brace
r_return
l_int|1
suffix:semicolon
)brace
DECL|variable|lm_bustype
r_static
r_struct
id|bus_type
id|lm_bustype
op_assign
(brace
dot
id|name
op_assign
l_string|&quot;logicmodule&quot;
comma
dot
id|match
op_assign
id|lm_match
comma
singleline_comment|//&t;.suspend&t;= lm_suspend,
singleline_comment|//&t;.resume&t;&t;= lm_resume,
)brace
suffix:semicolon
DECL|function|lm_init
r_static
r_int
id|__init
id|lm_init
c_func
(paren
r_void
)paren
(brace
r_return
id|bus_register
c_func
(paren
op_amp
id|lm_bustype
)paren
suffix:semicolon
)brace
DECL|variable|lm_init
id|postcore_initcall
c_func
(paren
id|lm_init
)paren
suffix:semicolon
DECL|function|lm_bus_probe
r_static
r_int
id|lm_bus_probe
c_func
(paren
r_struct
id|device
op_star
id|dev
)paren
(brace
r_struct
id|lm_device
op_star
id|lmdev
op_assign
id|to_lm_device
c_func
(paren
id|dev
)paren
suffix:semicolon
r_struct
id|lm_driver
op_star
id|lmdrv
op_assign
id|to_lm_driver
c_func
(paren
id|dev-&gt;driver
)paren
suffix:semicolon
r_return
id|lmdrv
op_member_access_from_pointer
id|probe
c_func
(paren
id|lmdev
)paren
suffix:semicolon
)brace
DECL|function|lm_bus_remove
r_static
r_int
id|lm_bus_remove
c_func
(paren
r_struct
id|device
op_star
id|dev
)paren
(brace
r_struct
id|lm_device
op_star
id|lmdev
op_assign
id|to_lm_device
c_func
(paren
id|dev
)paren
suffix:semicolon
r_struct
id|lm_driver
op_star
id|lmdrv
op_assign
id|to_lm_driver
c_func
(paren
id|dev-&gt;driver
)paren
suffix:semicolon
id|lmdrv
op_member_access_from_pointer
id|remove
c_func
(paren
id|lmdev
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|lm_driver_register
r_int
id|lm_driver_register
c_func
(paren
r_struct
id|lm_driver
op_star
id|drv
)paren
(brace
id|drv-&gt;drv.bus
op_assign
op_amp
id|lm_bustype
suffix:semicolon
id|drv-&gt;drv.probe
op_assign
id|lm_bus_probe
suffix:semicolon
id|drv-&gt;drv.remove
op_assign
id|lm_bus_remove
suffix:semicolon
r_return
id|driver_register
c_func
(paren
op_amp
id|drv-&gt;drv
)paren
suffix:semicolon
)brace
DECL|function|lm_driver_unregister
r_void
id|lm_driver_unregister
c_func
(paren
r_struct
id|lm_driver
op_star
id|drv
)paren
(brace
id|driver_unregister
c_func
(paren
op_amp
id|drv-&gt;drv
)paren
suffix:semicolon
)brace
DECL|function|lm_device_release
r_static
r_void
id|lm_device_release
c_func
(paren
r_struct
id|device
op_star
id|dev
)paren
(brace
r_struct
id|lm_device
op_star
id|d
op_assign
id|to_lm_device
c_func
(paren
id|dev
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|d
)paren
suffix:semicolon
)brace
DECL|function|lm_device_register
r_int
id|lm_device_register
c_func
(paren
r_struct
id|lm_device
op_star
id|dev
)paren
(brace
r_int
id|ret
suffix:semicolon
id|dev-&gt;dev.release
op_assign
id|lm_device_release
suffix:semicolon
id|dev-&gt;dev.bus
op_assign
op_amp
id|lm_bustype
suffix:semicolon
id|snprintf
c_func
(paren
id|dev-&gt;dev.bus_id
comma
r_sizeof
(paren
id|dev-&gt;dev.bus_id
)paren
comma
l_string|&quot;lm%d&quot;
comma
id|dev-&gt;id
)paren
suffix:semicolon
id|dev-&gt;resource.name
op_assign
id|dev-&gt;dev.bus_id
suffix:semicolon
id|ret
op_assign
id|request_resource
c_func
(paren
op_amp
id|iomem_resource
comma
op_amp
id|dev-&gt;resource
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
op_eq
l_int|0
)paren
(brace
id|ret
op_assign
id|device_register
c_func
(paren
op_amp
id|dev-&gt;dev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
id|release_resource
c_func
(paren
op_amp
id|dev-&gt;resource
)paren
suffix:semicolon
)brace
r_return
id|ret
suffix:semicolon
)brace
eof
