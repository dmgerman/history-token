multiline_comment|/*&n; * IRQ vector handles&n; *&n; * This file is subject to the terms and conditions of the GNU General Public&n; * License.  See the file &quot;COPYING&quot; in the main directory of this archive&n; * for more details.&n; *&n; * Copyright (C) 1995, 1996, 1997, 2003 by Ralf Baechle&n; */
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/irq.h&gt;
macro_line|#include &lt;asm/i8259.h&gt;
macro_line|#include &lt;asm/irq_cpu.h&gt;
macro_line|#include &lt;asm/gt64120.h&gt;
macro_line|#include &lt;asm/ptrace.h&gt;
macro_line|#include &lt;asm/cobalt/cobalt.h&gt;
r_extern
r_void
id|cobalt_handle_int
c_func
(paren
r_void
)paren
suffix:semicolon
multiline_comment|/*&n; * We have two types of interrupts that we handle, ones that come in through&n; * the CPU interrupt lines, and ones that come in on the via chip. The CPU&n; * mappings are:&n; *&n; *    16,  - Software interrupt 0 (unused)&t;IE_SW0&n; *    17   - Software interrupt 1 (unused)&t;IE_SW0&n; *    18   - Galileo chip (timer)&t;&t;IE_IRQ0&n; *    19   - Tulip 0 + NCR SCSI&t;&t;&t;IE_IRQ1&n; *    20   - Tulip 1&t;&t;&t;&t;IE_IRQ2&n; *    21   - 16550 UART&t;&t;&t;&t;IE_IRQ3&n; *    22   - VIA southbridge PIC&t;&t;IE_IRQ4&n; *    23   - unused&t;&t;&t;&t;IE_IRQ5&n; *&n; * The VIA chip is a master/slave 8259 setup and has the following interrupts:&n; *&n; *     8  - RTC&n; *     9  - PCI&n; *    14  - IDE0&n; *    15  - IDE1&n; */
DECL|function|cobalt_irq
id|asmlinkage
r_void
id|cobalt_irq
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
r_int
r_int
id|pending
op_assign
id|read_c0_status
c_func
(paren
)paren
op_amp
id|read_c0_cause
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pending
op_amp
id|CAUSEF_IP2
)paren
(brace
multiline_comment|/* int 18 */
r_int
r_int
id|irq_src
op_assign
id|GALILEO_INL
c_func
(paren
id|GT_INTRCAUSE_OFS
)paren
suffix:semicolon
multiline_comment|/* Check for timer irq ... */
r_if
c_cond
(paren
id|irq_src
op_amp
id|GALILEO_T0EXP
)paren
(brace
multiline_comment|/* Clear the int line */
id|GALILEO_OUTL
c_func
(paren
l_int|0
comma
id|GT_INTRCAUSE_OFS
)paren
suffix:semicolon
id|do_IRQ
c_func
(paren
id|COBALT_TIMER_IRQ
comma
id|regs
)paren
suffix:semicolon
)brace
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|pending
op_amp
id|CAUSEF_IP6
)paren
(brace
multiline_comment|/* int 22 */
r_int
id|irq
op_assign
id|i8259_irq
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|irq
op_ge
l_int|0
)paren
id|do_IRQ
c_func
(paren
id|irq
comma
id|regs
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|pending
op_amp
id|CAUSEF_IP3
)paren
(brace
multiline_comment|/* int 19 */
id|do_IRQ
c_func
(paren
id|COBALT_ETH0_IRQ
comma
id|regs
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|pending
op_amp
id|CAUSEF_IP4
)paren
(brace
multiline_comment|/* int 20 */
id|do_IRQ
c_func
(paren
id|COBALT_ETH1_IRQ
comma
id|regs
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|pending
op_amp
id|CAUSEF_IP5
)paren
(brace
multiline_comment|/* int 21 */
id|do_IRQ
c_func
(paren
id|COBALT_SERIAL_IRQ
comma
id|regs
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|pending
op_amp
id|CAUSEF_IP7
)paren
(brace
multiline_comment|/* int 23 */
id|do_IRQ
c_func
(paren
id|COBALT_QUBE_SLOT_IRQ
comma
id|regs
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
)brace
DECL|function|arch_init_irq
r_void
id|__init
id|arch_init_irq
c_func
(paren
r_void
)paren
(brace
id|set_except_vector
c_func
(paren
l_int|0
comma
id|cobalt_handle_int
)paren
suffix:semicolon
id|init_i8259_irqs
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/*  0 ... 15 */
id|mips_cpu_irq_init
c_func
(paren
l_int|16
)paren
suffix:semicolon
multiline_comment|/* 16 ... 23 */
multiline_comment|/*&n;&t; * Mask all cpu interrupts&n;&t; *  (except IE4, we already masked those at VIA level)&n;&t; */
id|change_c0_status
c_func
(paren
id|ST0_IM
comma
id|IE_IRQ4
)paren
suffix:semicolon
)brace
eof
