multiline_comment|/*&n; *  linux/arch/mips/philips/nino/setup.c&n; *&n; *  Copyright (C) 2001 Steven J. Hill (sjhill@realitydiluted.com)&n; *&n; * This program is free software; you can redistribute it and/or modify&n; * it under the terms of the GNU General Public License version 2 as&n; * published by the Free Software Foundation.&n; *&n; *  Interrupt and exception initialization for Philips Nino.&n; */
macro_line|#include &lt;linux/console.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/interrupt.h&gt;
macro_line|#include &lt;linux/mc146818rtc.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;asm/addrspace.h&gt;
macro_line|#include &lt;asm/gdb-stub.h&gt;
macro_line|#include &lt;asm/irq.h&gt;
macro_line|#include &lt;asm/wbflush.h&gt;
macro_line|#include &lt;asm/tx3912.h&gt;
r_extern
r_struct
id|rtc_ops
id|nino_rtc_ops
suffix:semicolon
r_extern
r_void
id|nino_wait
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_void
id|setup_nino_reset_vectors
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
id|asmlinkage
r_void
id|nino_handle_int
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|setup_nino_irq
c_func
(paren
r_int
comma
r_struct
id|irqaction
op_star
)paren
suffix:semicolon
DECL|variable|board_time_init
r_void
(paren
op_star
id|board_time_init
)paren
(paren
r_struct
id|irqaction
op_star
id|irq
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_REMOTE_DEBUG
r_extern
r_void
id|set_debug_traps
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_void
id|breakpoint
c_func
(paren
r_void
)paren
suffix:semicolon
DECL|variable|remote_debug
r_static
r_int
id|remote_debug
op_assign
l_int|0
suffix:semicolon
macro_line|#endif
DECL|function|nino_irq_setup
r_static
r_void
id|__init
id|nino_irq_setup
c_func
(paren
r_void
)paren
(brace
r_int
r_int
id|tmp
suffix:semicolon
multiline_comment|/* Turn all interrupts off */
id|IntEnable1
op_assign
l_int|0
suffix:semicolon
id|IntEnable2
op_assign
l_int|0
suffix:semicolon
id|IntEnable3
op_assign
l_int|0
suffix:semicolon
id|IntEnable4
op_assign
l_int|0
suffix:semicolon
id|IntEnable5
op_assign
l_int|0
suffix:semicolon
id|IntEnable6
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* Clear all interrupts */
id|IntClear1
op_assign
l_int|0xffffffff
suffix:semicolon
id|IntClear2
op_assign
l_int|0xffffffff
suffix:semicolon
id|IntClear3
op_assign
l_int|0xffffffff
suffix:semicolon
id|IntClear4
op_assign
l_int|0xffffffff
suffix:semicolon
id|IntClear5
op_assign
l_int|0xffffffff
suffix:semicolon
id|IntClear6
op_assign
l_int|0xffffffff
suffix:semicolon
multiline_comment|/*&n;&t; * Enable only the interrupts for the UART and negative&n;&t; * edge (1-to-0) triggered multi-function I/O pins.&n;&t; */
id|change_cp0_status
c_func
(paren
id|ST0_BEV
comma
l_int|0
)paren
suffix:semicolon
id|tmp
op_assign
id|read_32bit_cp0_register
c_func
(paren
id|CP0_STATUS
)paren
suffix:semicolon
id|change_cp0_status
c_func
(paren
id|ST0_IM
comma
id|tmp
op_or
id|IE_IRQ2
op_or
id|IE_IRQ4
)paren
suffix:semicolon
multiline_comment|/* Register the global interrupt handler */
id|set_except_vector
c_func
(paren
l_int|0
comma
id|nino_handle_int
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_REMOTE_DEBUG
r_if
c_cond
(paren
id|remote_debug
)paren
(brace
id|set_debug_traps
c_func
(paren
)paren
suffix:semicolon
id|breakpoint
c_func
(paren
)paren
suffix:semicolon
)brace
macro_line|#endif
)brace
DECL|function|nino_time_init
r_static
id|__init
r_void
id|nino_time_init
c_func
(paren
r_struct
id|irqaction
op_star
id|irq
)paren
(brace
r_int
r_int
id|scratch
op_assign
l_int|0
suffix:semicolon
multiline_comment|/*&n;&t; * Enable periodic interrupts&n;&t; */
id|setup_nino_irq
c_func
(paren
l_int|0
comma
id|irq
)paren
suffix:semicolon
id|RTCperiodTimer
op_assign
id|PER_TIMER_COUNT
suffix:semicolon
id|RTCtimerControl
op_assign
id|TIM_ENPERTIMER
suffix:semicolon
id|IntEnable5
op_or_assign
id|INT5_PERIODICINT
suffix:semicolon
id|scratch
op_assign
id|inl
c_func
(paren
id|TX3912_CLK_CTRL_BASE
)paren
suffix:semicolon
id|scratch
op_or_assign
id|TX3912_CLK_CTRL_ENTIMERCLK
suffix:semicolon
id|outl
c_func
(paren
id|scratch
comma
id|TX3912_CLK_CTRL_BASE
)paren
suffix:semicolon
multiline_comment|/* Enable all interrupts */
id|IntEnable6
op_or_assign
id|INT6_GLOBALEN
op_or
id|INT6_PERIODICINT
suffix:semicolon
)brace
DECL|function|nino_setup
r_void
id|__init
id|nino_setup
c_func
(paren
r_void
)paren
(brace
id|irq_setup
op_assign
id|nino_irq_setup
suffix:semicolon
id|board_time_init
op_assign
id|nino_time_init
suffix:semicolon
multiline_comment|/* Base address to use for PC type I/O accesses */
id|mips_io_port_base
op_assign
id|KSEG1ADDR
c_func
(paren
l_int|0xB0C00000
)paren
suffix:semicolon
id|setup_nino_reset_vectors
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/* Function called during process idle (cpu_idle) */
id|cpu_wait
op_assign
id|nino_wait
suffix:semicolon
macro_line|#ifdef CONFIG_FB
id|conswitchp
op_assign
op_amp
id|dummy_con
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_REMOTE_DEBUG
id|remote_debug
op_assign
l_int|1
suffix:semicolon
macro_line|#endif
id|rtc_ops
op_assign
op_amp
id|nino_rtc_ops
suffix:semicolon
)brace
eof
