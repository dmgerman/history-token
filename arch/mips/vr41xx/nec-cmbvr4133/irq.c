multiline_comment|/*&n; * arch/mips/vr41xx/nec-cmbvr4133/irq.c&n; *&n; * Interrupt routines for the NEC CMB-VR4133 board.&n; *&n; * Author: Yoichi Yuasa &lt;yyuasa@mvista.com, or source@mvista.com&gt; and&n; *         Alex Sapkov &lt;asapkov@ru.mvista.com&gt;&n; *&n; * 2003-2004 (c) MontaVista, Software, Inc. This file is licensed under&n; * the terms of the GNU General Public License version 2. This program&n; * is licensed &quot;as is&quot; without any warranty of any kind, whether express&n; * or implied.&n; *&n; * Support for NEC-CMBVR4133 in 2.6&n; * Manish Lachwani (mlachwani@mvista.com)&n; */
macro_line|#include &lt;linux/bitops.h&gt;
macro_line|#include &lt;linux/errno.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/ioport.h&gt;
macro_line|#include &lt;linux/interrupt.h&gt;
macro_line|#include &lt;asm/io.h&gt;
macro_line|#include &lt;asm/vr41xx/cmbvr4133.h&gt;
r_extern
r_void
id|enable_8259A_irq
c_func
(paren
r_int
r_int
id|irq
)paren
suffix:semicolon
r_extern
r_void
id|disable_8259A_irq
c_func
(paren
r_int
r_int
id|irq
)paren
suffix:semicolon
r_extern
r_void
id|mask_and_ack_8259A
c_func
(paren
r_int
r_int
id|irq
)paren
suffix:semicolon
r_extern
r_void
id|init_8259A
c_func
(paren
r_int
id|hoge
)paren
suffix:semicolon
r_extern
r_int
id|vr4133_rockhopper
suffix:semicolon
DECL|function|startup_i8259_irq
r_static
r_int
r_int
id|startup_i8259_irq
c_func
(paren
r_int
r_int
id|irq
)paren
(brace
id|enable_8259A_irq
c_func
(paren
id|irq
op_minus
id|I8259_IRQ_BASE
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|shutdown_i8259_irq
r_static
r_void
id|shutdown_i8259_irq
c_func
(paren
r_int
r_int
id|irq
)paren
(brace
id|disable_8259A_irq
c_func
(paren
id|irq
op_minus
id|I8259_IRQ_BASE
)paren
suffix:semicolon
)brace
DECL|function|enable_i8259_irq
r_static
r_void
id|enable_i8259_irq
c_func
(paren
r_int
r_int
id|irq
)paren
(brace
id|enable_8259A_irq
c_func
(paren
id|irq
op_minus
id|I8259_IRQ_BASE
)paren
suffix:semicolon
)brace
DECL|function|disable_i8259_irq
r_static
r_void
id|disable_i8259_irq
c_func
(paren
r_int
r_int
id|irq
)paren
(brace
id|disable_8259A_irq
c_func
(paren
id|irq
op_minus
id|I8259_IRQ_BASE
)paren
suffix:semicolon
)brace
DECL|function|ack_i8259_irq
r_static
r_void
id|ack_i8259_irq
c_func
(paren
r_int
r_int
id|irq
)paren
(brace
id|mask_and_ack_8259A
c_func
(paren
id|irq
op_minus
id|I8259_IRQ_BASE
)paren
suffix:semicolon
)brace
DECL|function|end_i8259_irq
r_static
r_void
id|end_i8259_irq
c_func
(paren
r_int
r_int
id|irq
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|irq_desc
(braket
id|irq
)braket
dot
id|status
op_amp
(paren
id|IRQ_DISABLED
op_or
id|IRQ_INPROGRESS
)paren
)paren
)paren
id|enable_8259A_irq
c_func
(paren
id|irq
op_minus
id|I8259_IRQ_BASE
)paren
suffix:semicolon
)brace
DECL|variable|i8259_irq_type
r_static
r_struct
id|hw_interrupt_type
id|i8259_irq_type
op_assign
(brace
dot
r_typename
op_assign
l_string|&quot;XT-PIC&quot;
comma
dot
id|startup
op_assign
id|startup_i8259_irq
comma
dot
id|shutdown
op_assign
id|shutdown_i8259_irq
comma
dot
id|enable
op_assign
id|enable_i8259_irq
comma
dot
id|disable
op_assign
id|disable_i8259_irq
comma
dot
id|ack
op_assign
id|ack_i8259_irq
comma
dot
id|end
op_assign
id|end_i8259_irq
comma
)brace
suffix:semicolon
DECL|function|i8259_get_irq_number
r_static
r_int
id|i8259_get_irq_number
c_func
(paren
r_int
id|irq
)paren
(brace
r_int
r_int
id|isr
suffix:semicolon
id|isr
op_assign
id|inb
c_func
(paren
l_int|0x20
)paren
suffix:semicolon
id|irq
op_assign
id|ffz
c_func
(paren
op_complement
id|isr
)paren
suffix:semicolon
r_if
c_cond
(paren
id|irq
op_eq
l_int|2
)paren
(brace
id|isr
op_assign
id|inb
c_func
(paren
l_int|0xa0
)paren
suffix:semicolon
id|irq
op_assign
l_int|8
op_plus
id|ffz
c_func
(paren
op_complement
id|isr
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|irq
template_param
l_int|15
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
id|I8259_IRQ_BASE
op_plus
id|irq
suffix:semicolon
)brace
DECL|variable|i8259_slave_cascade
r_static
r_struct
id|irqaction
id|i8259_slave_cascade
op_assign
(brace
dot
id|handler
op_assign
op_amp
id|no_action
comma
dot
id|name
op_assign
l_string|&quot;cascade&quot;
comma
)brace
suffix:semicolon
DECL|function|rockhopper_init_irq
r_void
id|__init
id|rockhopper_init_irq
c_func
(paren
r_void
)paren
(brace
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|vr4133_rockhopper
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;Not a Rockhopper Board &bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
id|I8259_IRQ_BASE
suffix:semicolon
id|i
op_le
id|I8259_IRQ_LAST
suffix:semicolon
id|i
op_increment
)paren
id|irq_desc
(braket
id|i
)braket
dot
id|handler
op_assign
op_amp
id|i8259_irq_type
suffix:semicolon
id|setup_irq
c_func
(paren
id|I8259_SLAVE_IRQ
comma
op_amp
id|i8259_slave_cascade
)paren
suffix:semicolon
id|vr41xx_set_irq_trigger
c_func
(paren
id|CMBVR41XX_INTC_PIN
comma
id|TRIGGER_LEVEL
comma
id|SIGNAL_THROUGH
)paren
suffix:semicolon
id|vr41xx_set_irq_level
c_func
(paren
id|CMBVR41XX_INTC_PIN
comma
id|LEVEL_HIGH
)paren
suffix:semicolon
id|vr41xx_cascade_irq
c_func
(paren
id|CMBVR41XX_INTC_IRQ
comma
id|i8259_get_irq_number
)paren
suffix:semicolon
)brace
eof
