multiline_comment|/*&n; * This file is subject to the terms and conditions of the GNU General Public&n; * License.  See the file &quot;COPYING&quot; in the main directory of this archive&n; * for more details.&n; *&n; * Copyright (C) 1995  Linus Torvalds&n; * Copyright (C) 1995, 1996, 1997, 1998, 1999, 2000  Ralf Baechle&n; * Copyright (C) 1996  Stoned Elipot&n; * Copyright (C) 2000  Maciej W. Rozycki&n; */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/errno.h&gt;
macro_line|#include &lt;linux/hdreg.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/ioport.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;linux/stddef.h&gt;
macro_line|#include &lt;linux/string.h&gt;
macro_line|#include &lt;linux/unistd.h&gt;
macro_line|#include &lt;linux/ptrace.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;linux/user.h&gt;
macro_line|#include &lt;linux/utsname.h&gt;
macro_line|#include &lt;linux/a.out.h&gt;
macro_line|#include &lt;linux/tty.h&gt;
macro_line|#include &lt;linux/bootmem.h&gt;
macro_line|#include &lt;linux/blk.h&gt;
macro_line|#include &lt;linux/ide.h&gt;
macro_line|#include &lt;linux/timex.h&gt;
macro_line|#include &lt;linux/root_dev.h&gt;
macro_line|#include &lt;asm/asm.h&gt;
macro_line|#include &lt;asm/bootinfo.h&gt;
macro_line|#include &lt;asm/cachectl.h&gt;
macro_line|#include &lt;asm/cpu.h&gt;
macro_line|#include &lt;asm/io.h&gt;
macro_line|#include &lt;asm/stackframe.h&gt;
macro_line|#include &lt;asm/system.h&gt;
macro_line|#ifdef CONFIG_SGI_IP22
macro_line|#include &lt;asm/sgialib.h&gt;
macro_line|#endif
DECL|variable|boot_cpu_data
r_struct
id|mips_cpuinfo
id|boot_cpu_data
op_assign
(brace
l_int|0
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|0
)brace
suffix:semicolon
multiline_comment|/*&n; * Not all of the MIPS CPUs have the &quot;wait&quot; instruction available. Moreover,&n; * the implementation of the &quot;wait&quot; feature differs between CPU families. This&n; * points to the function that implements CPU specific wait. &n; * The wait instruction stops the pipeline and reduces the power consumption of&n; * the CPU very much.&n; */
DECL|variable|cpu_wait
r_void
(paren
op_star
id|cpu_wait
)paren
(paren
r_void
)paren
op_assign
l_int|NULL
suffix:semicolon
multiline_comment|/*&n; * There are several bus types available for MIPS machines.  &quot;RISC PC&quot;&n; * type machines have ISA, EISA, VLB or PCI available, DECstations&n; * have Turbochannel or Q-Bus, SGI has GIO, there are lots of VME&n; * boxes ...&n; * This flag is set if a EISA slots are available.&n; */
DECL|variable|EISA_bus
r_int
id|EISA_bus
op_assign
l_int|0
suffix:semicolon
DECL|variable|screen_info
r_struct
id|screen_info
id|screen_info
suffix:semicolon
r_extern
r_struct
id|fd_ops
id|no_fd_ops
suffix:semicolon
DECL|variable|fd_ops
r_struct
id|fd_ops
op_star
id|fd_ops
suffix:semicolon
macro_line|#if defined(CONFIG_BLK_DEV_IDE) || defined(CONFIG_BLK_DEV_IDE_MODULE)
r_extern
r_struct
id|ide_ops
id|no_ide_ops
suffix:semicolon
DECL|variable|ide_ops
r_struct
id|ide_ops
op_star
id|ide_ops
suffix:semicolon
macro_line|#endif
r_extern
r_void
op_star
id|__rd_start
comma
op_star
id|__rd_end
suffix:semicolon
r_extern
r_struct
id|rtc_ops
id|no_rtc_ops
suffix:semicolon
DECL|variable|rtc_ops
r_struct
id|rtc_ops
op_star
id|rtc_ops
suffix:semicolon
macro_line|#ifdef CONFIG_PC_KEYB
r_extern
r_struct
id|kbd_ops
id|no_kbd_ops
suffix:semicolon
DECL|variable|kbd_ops
r_struct
id|kbd_ops
op_star
id|kbd_ops
suffix:semicolon
macro_line|#endif
multiline_comment|/*&n; * Setup information&n; *&n; * These are initialized so they are in the .data section&n; */
DECL|variable|mips_machtype
r_int
r_int
id|mips_machtype
op_assign
id|MACH_UNKNOWN
suffix:semicolon
DECL|variable|mips_machgroup
r_int
r_int
id|mips_machgroup
op_assign
id|MACH_GROUP_UNKNOWN
suffix:semicolon
DECL|variable|boot_mem_map
r_struct
id|boot_mem_map
id|boot_mem_map
suffix:semicolon
DECL|variable|aux_device_present
r_int
r_char
id|aux_device_present
suffix:semicolon
r_extern
r_char
id|_ftext
comma
id|_etext
comma
id|_fdata
comma
id|_edata
comma
id|_end
suffix:semicolon
DECL|variable|command_line
r_static
r_char
id|command_line
(braket
id|COMMAND_LINE_SIZE
)braket
suffix:semicolon
DECL|variable|saved_command_line
r_char
id|saved_command_line
(braket
id|COMMAND_LINE_SIZE
)braket
suffix:semicolon
r_extern
r_char
id|arcs_cmdline
(braket
id|COMMAND_LINE_SIZE
)braket
suffix:semicolon
multiline_comment|/*&n; * mips_io_port_base is the begin of the address space to which x86 style&n; * I/O ports are mapped.&n; */
DECL|variable|mips_io_port_base
r_int
r_int
id|mips_io_port_base
suffix:semicolon
multiline_comment|/*&n; * isa_slot_offset is the address where E(ISA) busaddress 0 is is mapped&n; * for the processor.&n; */
DECL|variable|isa_slot_offset
r_int
r_int
id|isa_slot_offset
suffix:semicolon
r_extern
r_void
id|sgi_sysinit
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_void
id|SetUpBootInfo
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_void
id|loadmmu
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
id|asmlinkage
r_void
id|start_kernel
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_void
id|prom_init
c_func
(paren
r_int
comma
r_char
op_star
op_star
comma
r_char
op_star
op_star
comma
r_int
op_star
)paren
suffix:semicolon
DECL|variable|code_resource
r_static
r_struct
id|resource
id|code_resource
op_assign
(brace
l_string|&quot;Kernel code&quot;
)brace
suffix:semicolon
DECL|variable|data_resource
r_static
r_struct
id|resource
id|data_resource
op_assign
(brace
l_string|&quot;Kernel data&quot;
)brace
suffix:semicolon
multiline_comment|/*&n; * Probe whether cpu has config register by trying to play with&n; * alternate cache bit and see whether it matters.&n; * It&squot;s used by cpu_probe to distinguish between R3000A and R3081.&n; */
DECL|function|cpu_has_confreg
r_static
r_inline
r_int
id|cpu_has_confreg
c_func
(paren
r_void
)paren
(brace
macro_line|#ifdef CONFIG_CPU_R3000
r_extern
r_int
r_int
id|r3k_cache_size
c_func
(paren
r_int
r_int
)paren
suffix:semicolon
r_int
r_int
id|size1
comma
id|size2
suffix:semicolon
r_int
r_int
id|cfg
op_assign
id|read_32bit_cp0_register
c_func
(paren
id|CP0_CONF
)paren
suffix:semicolon
id|size1
op_assign
id|r3k_cache_size
c_func
(paren
id|ST0_ISC
)paren
suffix:semicolon
id|write_32bit_cp0_register
c_func
(paren
id|CP0_CONF
comma
id|cfg
op_xor
id|CONF_AC
)paren
suffix:semicolon
id|size2
op_assign
id|r3k_cache_size
c_func
(paren
id|ST0_ISC
)paren
suffix:semicolon
id|write_32bit_cp0_register
c_func
(paren
id|CP0_CONF
comma
id|cfg
)paren
suffix:semicolon
r_return
id|size1
op_ne
id|size2
suffix:semicolon
macro_line|#else
r_return
l_int|0
suffix:semicolon
macro_line|#endif
)brace
multiline_comment|/* declaration of the global struct */
DECL|variable|mips_cpu
r_struct
id|mips_cpu
id|mips_cpu
op_assign
(brace
id|PRID_IMP_UNKNOWN
comma
id|CPU_UNKNOWN
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
)brace
suffix:semicolon
multiline_comment|/* Shortcut for assembler access to mips_cpu.options */
DECL|variable|cpuoptions
r_int
op_star
id|cpuoptions
op_assign
op_amp
id|mips_cpu.options
suffix:semicolon
DECL|macro|R4K_OPTS
mdefine_line|#define R4K_OPTS (MIPS_CPU_TLB | MIPS_CPU_4KEX | MIPS_CPU_4KTLB &bslash;&n;&t;&t;| MIPS_CPU_COUNTER | MIPS_CPU_CACHE_CDEX)
DECL|function|cpu_probe
r_static
r_inline
r_void
id|cpu_probe
c_func
(paren
r_void
)paren
(brace
macro_line|#ifdef CONFIG_CPU_MIPS32
r_int
r_int
id|config1
suffix:semicolon
macro_line|#endif
id|mips_cpu.processor_id
op_assign
id|read_32bit_cp0_register
c_func
(paren
id|CP0_PRID
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|mips_cpu.processor_id
op_amp
l_int|0xff0000
)paren
(brace
r_case
id|PRID_COMP_LEGACY
suffix:colon
r_switch
c_cond
(paren
id|mips_cpu.processor_id
op_amp
l_int|0xff00
)paren
(brace
r_case
id|PRID_IMP_R2000
suffix:colon
id|mips_cpu.cputype
op_assign
id|CPU_R2000
suffix:semicolon
id|mips_cpu.isa_level
op_assign
id|MIPS_CPU_ISA_I
suffix:semicolon
id|mips_cpu.options
op_assign
id|MIPS_CPU_TLB
suffix:semicolon
id|mips_cpu.tlbsize
op_assign
l_int|64
suffix:semicolon
r_break
suffix:semicolon
r_case
id|PRID_IMP_R3000
suffix:colon
r_if
c_cond
(paren
(paren
id|mips_cpu.processor_id
op_amp
l_int|0xff
)paren
op_eq
id|PRID_REV_R3000A
)paren
r_if
c_cond
(paren
id|cpu_has_confreg
c_func
(paren
)paren
)paren
id|mips_cpu.cputype
op_assign
id|CPU_R3081E
suffix:semicolon
r_else
id|mips_cpu.cputype
op_assign
id|CPU_R3000A
suffix:semicolon
r_else
id|mips_cpu.cputype
op_assign
id|CPU_R3000
suffix:semicolon
id|mips_cpu.isa_level
op_assign
id|MIPS_CPU_ISA_I
suffix:semicolon
id|mips_cpu.options
op_assign
id|MIPS_CPU_TLB
suffix:semicolon
id|mips_cpu.tlbsize
op_assign
l_int|64
suffix:semicolon
r_break
suffix:semicolon
r_case
id|PRID_IMP_R4000
suffix:colon
r_if
c_cond
(paren
(paren
id|mips_cpu.processor_id
op_amp
l_int|0xff
)paren
op_eq
id|PRID_REV_R4400
)paren
id|mips_cpu.cputype
op_assign
id|CPU_R4400SC
suffix:semicolon
r_else
id|mips_cpu.cputype
op_assign
id|CPU_R4000SC
suffix:semicolon
id|mips_cpu.isa_level
op_assign
id|MIPS_CPU_ISA_III
suffix:semicolon
id|mips_cpu.options
op_assign
id|R4K_OPTS
op_or
id|MIPS_CPU_FPU
op_or
id|MIPS_CPU_32FPR
op_or
id|MIPS_CPU_WATCH
op_or
id|MIPS_CPU_VCE
suffix:semicolon
id|mips_cpu.tlbsize
op_assign
l_int|48
suffix:semicolon
r_break
suffix:semicolon
r_case
id|PRID_IMP_VR41XX
suffix:colon
id|mips_cpu.cputype
op_assign
id|CPU_VR41XX
suffix:semicolon
id|mips_cpu.isa_level
op_assign
id|MIPS_CPU_ISA_III
suffix:semicolon
id|mips_cpu.options
op_assign
id|R4K_OPTS
suffix:semicolon
id|mips_cpu.tlbsize
op_assign
l_int|32
suffix:semicolon
r_break
suffix:semicolon
r_case
id|PRID_IMP_R4600
suffix:colon
id|mips_cpu.cputype
op_assign
id|CPU_R4600
suffix:semicolon
id|mips_cpu.isa_level
op_assign
id|MIPS_CPU_ISA_III
suffix:semicolon
id|mips_cpu.options
op_assign
id|R4K_OPTS
op_or
id|MIPS_CPU_FPU
suffix:semicolon
id|mips_cpu.tlbsize
op_assign
l_int|48
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/*&n; * This processor doesn&squot;t have an MMU, so it&squot;s not &quot;real easy&quot; to&n; * run Linux on it. It is left purely for documentation.&n; *&t;&t;case PRID_IMP_R4650:&n;&t; &t;&t;mips_cpu.cputype = CPU_R4650;&n;&t;&t; &t;mips_cpu.isa_level = MIPS_CPU_ISA_III;&n;&t;&t;&t;mips_cpu.options = R4K_OPTS | MIPS_CPU_FPU;&n;&t;&t;        mips_cpu.tlbsize = 48;&n;&t;&t;&t;break;&n;*/
r_case
id|PRID_IMP_TX39
suffix:colon
id|mips_cpu.isa_level
op_assign
id|MIPS_CPU_ISA_I
suffix:semicolon
id|mips_cpu.options
op_assign
id|MIPS_CPU_TLB
suffix:semicolon
r_switch
c_cond
(paren
id|mips_cpu.processor_id
op_amp
l_int|0xff
)paren
(brace
r_case
id|PRID_REV_TX3912
suffix:colon
id|mips_cpu.cputype
op_assign
id|CPU_TX3912
suffix:semicolon
id|mips_cpu.tlbsize
op_assign
l_int|32
suffix:semicolon
r_break
suffix:semicolon
r_case
id|PRID_REV_TX3922
suffix:colon
id|mips_cpu.cputype
op_assign
id|CPU_TX3922
suffix:semicolon
id|mips_cpu.tlbsize
op_assign
l_int|64
suffix:semicolon
r_break
suffix:semicolon
r_case
id|PRID_REV_TX3927
suffix:colon
id|mips_cpu.cputype
op_assign
id|CPU_TX3927
suffix:semicolon
id|mips_cpu.tlbsize
op_assign
l_int|64
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|mips_cpu.cputype
op_assign
id|CPU_UNKNOWN
suffix:semicolon
r_break
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|PRID_IMP_R4700
suffix:colon
id|mips_cpu.cputype
op_assign
id|CPU_R4700
suffix:semicolon
id|mips_cpu.isa_level
op_assign
id|MIPS_CPU_ISA_III
suffix:semicolon
id|mips_cpu.options
op_assign
id|R4K_OPTS
op_or
id|MIPS_CPU_FPU
op_or
id|MIPS_CPU_32FPR
suffix:semicolon
id|mips_cpu.tlbsize
op_assign
l_int|48
suffix:semicolon
r_break
suffix:semicolon
r_case
id|PRID_IMP_R5000
suffix:colon
id|mips_cpu.cputype
op_assign
id|CPU_R5000
suffix:semicolon
id|mips_cpu.isa_level
op_assign
id|MIPS_CPU_ISA_IV
suffix:semicolon
id|mips_cpu.options
op_assign
id|R4K_OPTS
op_or
id|MIPS_CPU_FPU
op_or
id|MIPS_CPU_32FPR
suffix:semicolon
id|mips_cpu.tlbsize
op_assign
l_int|48
suffix:semicolon
r_break
suffix:semicolon
r_case
id|PRID_IMP_R5432
suffix:colon
id|mips_cpu.cputype
op_assign
id|CPU_R5432
suffix:semicolon
id|mips_cpu.isa_level
op_assign
id|MIPS_CPU_ISA_IV
suffix:semicolon
id|mips_cpu.options
op_assign
id|R4K_OPTS
op_or
id|MIPS_CPU_FPU
op_or
id|MIPS_CPU_32FPR
suffix:semicolon
id|mips_cpu.tlbsize
op_assign
l_int|48
suffix:semicolon
r_break
suffix:semicolon
r_case
id|PRID_IMP_NEVADA
suffix:colon
id|mips_cpu.cputype
op_assign
id|CPU_NEVADA
suffix:semicolon
id|mips_cpu.isa_level
op_assign
id|MIPS_CPU_ISA_IV
suffix:semicolon
id|mips_cpu.options
op_assign
id|R4K_OPTS
op_or
id|MIPS_CPU_FPU
op_or
id|MIPS_CPU_32FPR
op_or
id|MIPS_CPU_DIVEC
suffix:semicolon
id|mips_cpu.tlbsize
op_assign
l_int|48
suffix:semicolon
id|mips_cpu.icache.ways
op_assign
l_int|2
suffix:semicolon
id|mips_cpu.dcache.ways
op_assign
l_int|2
suffix:semicolon
r_break
suffix:semicolon
r_case
id|PRID_IMP_R6000
suffix:colon
id|mips_cpu.cputype
op_assign
id|CPU_R6000
suffix:semicolon
id|mips_cpu.isa_level
op_assign
id|MIPS_CPU_ISA_II
suffix:semicolon
id|mips_cpu.options
op_assign
id|MIPS_CPU_TLB
op_or
id|MIPS_CPU_FPU
suffix:semicolon
id|mips_cpu.tlbsize
op_assign
l_int|32
suffix:semicolon
r_break
suffix:semicolon
r_case
id|PRID_IMP_R6000A
suffix:colon
id|mips_cpu.cputype
op_assign
id|CPU_R6000A
suffix:semicolon
id|mips_cpu.isa_level
op_assign
id|MIPS_CPU_ISA_II
suffix:semicolon
id|mips_cpu.options
op_assign
id|MIPS_CPU_TLB
op_or
id|MIPS_CPU_FPU
suffix:semicolon
id|mips_cpu.tlbsize
op_assign
l_int|32
suffix:semicolon
r_break
suffix:semicolon
r_case
id|PRID_IMP_RM7000
suffix:colon
id|mips_cpu.cputype
op_assign
id|CPU_RM7000
suffix:semicolon
id|mips_cpu.isa_level
op_assign
id|MIPS_CPU_ISA_IV
suffix:semicolon
id|mips_cpu.options
op_assign
id|R4K_OPTS
op_or
id|MIPS_CPU_FPU
op_or
id|MIPS_CPU_32FPR
suffix:semicolon
r_break
suffix:semicolon
r_case
id|PRID_IMP_R8000
suffix:colon
id|mips_cpu.cputype
op_assign
id|CPU_R8000
suffix:semicolon
id|mips_cpu.isa_level
op_assign
id|MIPS_CPU_ISA_IV
suffix:semicolon
id|mips_cpu.options
op_assign
id|MIPS_CPU_TLB
op_or
id|MIPS_CPU_4KEX
op_or
id|MIPS_CPU_FPU
op_or
id|MIPS_CPU_32FPR
suffix:semicolon
id|mips_cpu.tlbsize
op_assign
l_int|384
suffix:semicolon
multiline_comment|/* has wierd TLB: 3-way x 128 */
r_break
suffix:semicolon
r_case
id|PRID_IMP_R10000
suffix:colon
id|mips_cpu.cputype
op_assign
id|CPU_R10000
suffix:semicolon
id|mips_cpu.isa_level
op_assign
id|MIPS_CPU_ISA_IV
suffix:semicolon
id|mips_cpu.options
op_assign
id|MIPS_CPU_TLB
op_or
id|MIPS_CPU_4KEX
op_or
id|MIPS_CPU_FPU
op_or
id|MIPS_CPU_32FPR
op_or
id|MIPS_CPU_COUNTER
op_or
id|MIPS_CPU_WATCH
suffix:semicolon
id|mips_cpu.tlbsize
op_assign
l_int|64
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|mips_cpu.cputype
op_assign
id|CPU_UNKNOWN
suffix:semicolon
r_break
suffix:semicolon
)brace
r_break
suffix:semicolon
macro_line|#ifdef CONFIG_CPU_MIPS32
r_case
id|PRID_COMP_MIPS
suffix:colon
r_switch
c_cond
(paren
id|mips_cpu.processor_id
op_amp
l_int|0xff00
)paren
(brace
r_case
id|PRID_IMP_4KC
suffix:colon
id|mips_cpu.cputype
op_assign
id|CPU_4KC
suffix:semicolon
r_goto
id|cpu_4kc
suffix:semicolon
r_case
id|PRID_IMP_4KEC
suffix:colon
id|mips_cpu.cputype
op_assign
id|CPU_4KEC
suffix:semicolon
r_goto
id|cpu_4kc
suffix:semicolon
r_case
id|PRID_IMP_4KSC
suffix:colon
id|mips_cpu.cputype
op_assign
id|CPU_4KSC
suffix:semicolon
id|cpu_4kc
suffix:colon
multiline_comment|/* Why do we set all these options by default, THEN query them?? */
id|mips_cpu.cputype
op_assign
id|MIPS_CPU_ISA_M32
suffix:semicolon
id|mips_cpu.options
op_assign
id|MIPS_CPU_TLB
op_or
id|MIPS_CPU_4KEX
op_or
id|MIPS_CPU_4KTLB
op_or
id|MIPS_CPU_COUNTER
op_or
id|MIPS_CPU_DIVEC
op_or
id|MIPS_CPU_WATCH
suffix:semicolon
id|config1
op_assign
id|read_mips32_cp0_config1
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|config1
op_amp
(paren
l_int|1
op_lshift
l_int|3
)paren
)paren
id|mips_cpu.options
op_or_assign
id|MIPS_CPU_WATCH
suffix:semicolon
r_if
c_cond
(paren
id|config1
op_amp
(paren
l_int|1
op_lshift
l_int|2
)paren
)paren
id|mips_cpu.options
op_or_assign
id|MIPS_CPU_MIPS16
suffix:semicolon
r_if
c_cond
(paren
id|config1
op_amp
l_int|1
)paren
id|mips_cpu.options
op_or_assign
id|MIPS_CPU_FPU
suffix:semicolon
id|mips_cpu.scache.flags
op_assign
id|MIPS_CACHE_NOT_PRESENT
suffix:semicolon
r_break
suffix:semicolon
r_case
id|PRID_IMP_5KC
suffix:colon
id|mips_cpu.cputype
op_assign
id|CPU_5KC
suffix:semicolon
id|mips_cpu.cputype
op_assign
id|MIPS_CPU_ISA_M64
suffix:semicolon
multiline_comment|/* See comment above about querying options */
id|mips_cpu.options
op_assign
id|MIPS_CPU_TLB
op_or
id|MIPS_CPU_4KEX
op_or
id|MIPS_CPU_4KTLB
op_or
id|MIPS_CPU_COUNTER
op_or
id|MIPS_CPU_DIVEC
op_or
id|MIPS_CPU_WATCH
suffix:semicolon
id|config1
op_assign
id|read_mips32_cp0_config1
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|config1
op_amp
(paren
l_int|1
op_lshift
l_int|3
)paren
)paren
id|mips_cpu.options
op_or_assign
id|MIPS_CPU_WATCH
suffix:semicolon
r_if
c_cond
(paren
id|config1
op_amp
(paren
l_int|1
op_lshift
l_int|2
)paren
)paren
id|mips_cpu.options
op_or_assign
id|MIPS_CPU_MIPS16
suffix:semicolon
r_if
c_cond
(paren
id|config1
op_amp
l_int|1
)paren
id|mips_cpu.options
op_or_assign
id|MIPS_CPU_FPU
suffix:semicolon
r_break
suffix:semicolon
id|mips_cpu.scache.flags
op_assign
id|MIPS_CACHE_NOT_PRESENT
suffix:semicolon
r_default
suffix:colon
id|mips_cpu.cputype
op_assign
id|CPU_UNKNOWN
suffix:semicolon
r_break
suffix:semicolon
)brace
r_break
suffix:semicolon
macro_line|#endif
r_case
id|PRID_COMP_ALCHEMY
suffix:colon
r_switch
c_cond
(paren
id|mips_cpu.processor_id
op_amp
l_int|0xff00
)paren
(brace
macro_line|#ifdef CONFIG_CPU_MIPS32
r_case
id|PRID_IMP_AU1000
suffix:colon
id|mips_cpu.cputype
op_assign
id|CPU_AU1000
suffix:semicolon
id|mips_cpu.isa_level
op_assign
id|MIPS_CPU_ISA_M32
suffix:semicolon
id|mips_cpu.options
op_assign
id|MIPS_CPU_TLB
op_or
id|MIPS_CPU_4KEX
op_or
id|MIPS_CPU_4KTLB
op_or
id|MIPS_CPU_COUNTER
op_or
id|MIPS_CPU_DIVEC
op_or
id|MIPS_CPU_WATCH
suffix:semicolon
id|config1
op_assign
id|read_mips32_cp0_config1
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|config1
op_amp
(paren
l_int|1
op_lshift
l_int|3
)paren
)paren
id|mips_cpu.options
op_or_assign
id|MIPS_CPU_WATCH
suffix:semicolon
r_if
c_cond
(paren
id|config1
op_amp
(paren
l_int|1
op_lshift
l_int|2
)paren
)paren
id|mips_cpu.options
op_or_assign
id|MIPS_CPU_MIPS16
suffix:semicolon
r_if
c_cond
(paren
id|config1
op_amp
l_int|1
)paren
id|mips_cpu.options
op_or_assign
id|MIPS_CPU_FPU
suffix:semicolon
id|mips_cpu.scache.flags
op_assign
id|MIPS_CACHE_NOT_PRESENT
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
r_default
suffix:colon
id|mips_cpu.cputype
op_assign
id|CPU_UNKNOWN
suffix:semicolon
r_break
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|PRID_COMP_SIBYTE
suffix:colon
r_switch
c_cond
(paren
id|mips_cpu.processor_id
op_amp
l_int|0xff00
)paren
(brace
r_case
id|PRID_IMP_SB1
suffix:colon
id|mips_cpu.cputype
op_assign
id|CPU_SB1
suffix:semicolon
id|mips_cpu.options
op_assign
id|MIPS_CPU_TLB
op_or
id|MIPS_CPU_4KEX
op_or
id|MIPS_CPU_COUNTER
op_or
id|MIPS_CPU_DIVEC
op_or
id|MIPS_CPU_FPU
op_or
id|MIPS_CPU_VCE
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|mips_cpu.cputype
op_assign
id|CPU_UNKNOWN
suffix:semicolon
r_break
suffix:semicolon
)brace
r_break
suffix:semicolon
r_default
suffix:colon
id|mips_cpu.cputype
op_assign
id|CPU_UNKNOWN
suffix:semicolon
)brace
)brace
id|asmlinkage
r_void
id|__init
DECL|function|init_arch
id|init_arch
c_func
(paren
r_int
id|argc
comma
r_char
op_star
op_star
id|argv
comma
r_char
op_star
op_star
id|envp
comma
r_int
op_star
id|prom_vec
)paren
(brace
r_int
r_int
id|s
suffix:semicolon
multiline_comment|/* Determine which MIPS variant we are running on. */
id|cpu_probe
c_func
(paren
)paren
suffix:semicolon
id|prom_init
c_func
(paren
id|argc
comma
id|argv
comma
id|envp
comma
id|prom_vec
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_SGI_IP22
id|sgi_sysinit
c_func
(paren
)paren
suffix:semicolon
macro_line|#endif
multiline_comment|/*&n;&t; * Determine the mmu/cache attached to this machine,&n;&t; * then flush the tlb and caches.  On the r4xx0&n;&t; * variants this also sets CP0_WIRED to zero.&n;&t; */
id|loadmmu
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/* Disable coprocessors and set FPU for 16 FPRs */
id|s
op_assign
id|read_32bit_cp0_register
c_func
(paren
id|CP0_STATUS
)paren
suffix:semicolon
id|s
op_and_assign
op_complement
(paren
id|ST0_CU1
op_or
id|ST0_CU2
op_or
id|ST0_CU3
op_or
id|ST0_KX
op_or
id|ST0_SX
op_or
id|ST0_FR
)paren
suffix:semicolon
id|s
op_or_assign
id|ST0_CU0
suffix:semicolon
id|write_32bit_cp0_register
c_func
(paren
id|CP0_STATUS
comma
id|s
)paren
suffix:semicolon
id|start_kernel
c_func
(paren
)paren
suffix:semicolon
)brace
DECL|function|add_memory_region
r_void
id|__init
id|add_memory_region
c_func
(paren
r_int
r_int
id|start
comma
r_int
r_int
id|size
comma
r_int
id|type
)paren
(brace
r_int
id|x
op_assign
id|boot_mem_map.nr_map
suffix:semicolon
r_if
c_cond
(paren
id|x
op_eq
id|BOOT_MEM_MAP_MAX
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;Ooops! Too many entries in the memory map!&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|boot_mem_map.map
(braket
id|x
)braket
dot
id|addr
op_assign
id|start
suffix:semicolon
id|boot_mem_map.map
(braket
id|x
)braket
dot
id|size
op_assign
id|size
suffix:semicolon
id|boot_mem_map.map
(braket
id|x
)braket
dot
id|type
op_assign
id|type
suffix:semicolon
id|boot_mem_map.nr_map
op_increment
suffix:semicolon
)brace
DECL|function|print_memory_map
r_static
r_void
id|__init
id|print_memory_map
c_func
(paren
r_void
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|boot_mem_map.nr_map
suffix:semicolon
id|i
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot; memory: %08lx @ %08lx &quot;
comma
id|boot_mem_map.map
(braket
id|i
)braket
dot
id|size
comma
id|boot_mem_map.map
(braket
id|i
)braket
dot
id|addr
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|boot_mem_map.map
(braket
id|i
)braket
dot
id|type
)paren
(brace
r_case
id|BOOT_MEM_RAM
suffix:colon
id|printk
c_func
(paren
l_string|&quot;(usable)&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|BOOT_MEM_ROM_DATA
suffix:colon
id|printk
c_func
(paren
l_string|&quot;(ROM data)&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|BOOT_MEM_RESERVED
suffix:colon
id|printk
c_func
(paren
l_string|&quot;(reserved)&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|printk
c_func
(paren
l_string|&quot;type %lu&bslash;n&quot;
comma
id|boot_mem_map.map
(braket
id|i
)braket
dot
id|type
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
)brace
DECL|function|parse_mem_cmdline
r_static
r_inline
r_void
id|parse_mem_cmdline
c_func
(paren
r_void
)paren
(brace
r_char
id|c
op_assign
l_char|&squot; &squot;
comma
op_star
id|to
op_assign
id|command_line
comma
op_star
id|from
op_assign
id|saved_command_line
suffix:semicolon
r_int
r_int
id|start_at
comma
id|mem_size
suffix:semicolon
r_int
id|len
op_assign
l_int|0
suffix:semicolon
r_int
id|usermem
op_assign
l_int|0
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;Determined physical RAM map:&bslash;n&quot;
)paren
suffix:semicolon
id|print_memory_map
c_func
(paren
)paren
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
suffix:semicolon
)paren
(brace
multiline_comment|/*&n;&t;&t; * &quot;mem=XXX[kKmM]&quot; defines a memory region from&n;&t;&t; * 0 to &lt;XXX&gt;, overriding the determined size.&n;&t;&t; * &quot;mem=XXX[KkmM]@YYY[KkmM]&quot; defines a memory region from&n;&t;&t; * &lt;YYY&gt; to &lt;YYY&gt;+&lt;XXX&gt;, overriding the determined size.&n;&t;&t; */
r_if
c_cond
(paren
id|c
op_eq
l_char|&squot; &squot;
op_logical_and
op_logical_neg
id|memcmp
c_func
(paren
id|from
comma
l_string|&quot;mem=&quot;
comma
l_int|4
)paren
)paren
(brace
r_if
c_cond
(paren
id|to
op_ne
id|command_line
)paren
id|to
op_decrement
suffix:semicolon
multiline_comment|/*&n;&t;&t;&t; * If a user specifies memory size, we&n;&t;&t;&t; * blow away any automatically generated&n;&t;&t;&t; * size.&n;&t;&t;&t; */
r_if
c_cond
(paren
id|usermem
op_eq
l_int|0
)paren
(brace
id|boot_mem_map.nr_map
op_assign
l_int|0
suffix:semicolon
id|usermem
op_assign
l_int|1
suffix:semicolon
)brace
id|mem_size
op_assign
id|memparse
c_func
(paren
id|from
op_plus
l_int|4
comma
op_amp
id|from
)paren
suffix:semicolon
r_if
c_cond
(paren
op_star
id|from
op_eq
l_char|&squot;@&squot;
)paren
id|start_at
op_assign
id|memparse
c_func
(paren
id|from
op_plus
l_int|1
comma
op_amp
id|from
)paren
suffix:semicolon
r_else
id|start_at
op_assign
l_int|0
suffix:semicolon
id|add_memory_region
c_func
(paren
id|start_at
comma
id|mem_size
comma
id|BOOT_MEM_RAM
)paren
suffix:semicolon
)brace
id|c
op_assign
op_star
(paren
id|from
op_increment
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|c
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
id|COMMAND_LINE_SIZE
op_le
op_increment
id|len
)paren
r_break
suffix:semicolon
op_star
(paren
id|to
op_increment
)paren
op_assign
id|c
suffix:semicolon
)brace
op_star
id|to
op_assign
l_char|&squot;&bslash;0&squot;
suffix:semicolon
r_if
c_cond
(paren
id|usermem
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;User-defined physical RAM map:&bslash;n&quot;
)paren
suffix:semicolon
id|print_memory_map
c_func
(paren
)paren
suffix:semicolon
)brace
)brace
DECL|function|setup_arch
r_void
id|__init
id|setup_arch
c_func
(paren
r_char
op_star
op_star
id|cmdline_p
)paren
(brace
r_void
id|atlas_setup
c_func
(paren
r_void
)paren
suffix:semicolon
r_void
id|baget_setup
c_func
(paren
r_void
)paren
suffix:semicolon
r_void
id|ddb_setup
c_func
(paren
r_void
)paren
suffix:semicolon
r_void
id|decstation_setup
c_func
(paren
r_void
)paren
suffix:semicolon
r_void
id|deskstation_setup
c_func
(paren
r_void
)paren
suffix:semicolon
r_void
id|jazz_setup
c_func
(paren
r_void
)paren
suffix:semicolon
r_void
id|sni_rm200_pci_setup
c_func
(paren
r_void
)paren
suffix:semicolon
r_void
id|sgi_setup
c_func
(paren
r_void
)paren
suffix:semicolon
r_void
id|ev96100_setup
c_func
(paren
r_void
)paren
suffix:semicolon
r_void
id|malta_setup
c_func
(paren
r_void
)paren
suffix:semicolon
r_void
id|momenco_ocelot_setup
c_func
(paren
r_void
)paren
suffix:semicolon
r_void
id|nino_setup
c_func
(paren
r_void
)paren
suffix:semicolon
r_int
r_int
id|bootmap_size
suffix:semicolon
r_int
r_int
id|start_pfn
comma
id|max_pfn
comma
id|first_usable_pfn
suffix:semicolon
r_int
id|i
suffix:semicolon
macro_line|#ifdef CONFIG_BLK_DEV_FD
id|fd_ops
op_assign
op_amp
id|no_fd_ops
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_BLK_DEV_IDE
id|ide_ops
op_assign
op_amp
id|no_ide_ops
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_PC_KEYB
id|kbd_ops
op_assign
op_amp
id|no_kbd_ops
suffix:semicolon
macro_line|#endif
id|rtc_ops
op_assign
op_amp
id|no_rtc_ops
suffix:semicolon
r_switch
c_cond
(paren
id|mips_machgroup
)paren
(brace
macro_line|#ifdef CONFIG_BAGET_MIPS
r_case
id|MACH_GROUP_BAGET
suffix:colon
id|baget_setup
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_DECSTATION
r_case
id|MACH_GROUP_DEC
suffix:colon
id|decstation_setup
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_MIPS_ATLAS
r_case
id|MACH_GROUP_UNKNOWN
suffix:colon
id|atlas_setup
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_MIPS_JAZZ
r_case
id|MACH_GROUP_JAZZ
suffix:colon
id|jazz_setup
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_MIPS_MALTA
r_case
id|MACH_GROUP_UNKNOWN
suffix:colon
id|malta_setup
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_MOMENCO_OCELOT
r_case
id|MACH_GROUP_MOMENCO
suffix:colon
id|momenco_ocelot_setup
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_SGI_IP22
multiline_comment|/* As of now this is only IP22.  */
r_case
id|MACH_GROUP_SGI
suffix:colon
id|sgi_setup
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_SNI_RM200_PCI
r_case
id|MACH_GROUP_SNI_RM
suffix:colon
id|sni_rm200_pci_setup
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_DDB5074
r_case
id|MACH_GROUP_NEC_DDB
suffix:colon
id|ddb_setup
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_DDB5476
r_case
id|MACH_GROUP_NEC_DDB
suffix:colon
id|ddb_setup
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_DDB5477
r_case
id|MACH_GROUP_NEC_DDB
suffix:colon
id|ddb_setup
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_MIPS_EV96100
r_case
id|MACH_GROUP_GALILEO
suffix:colon
id|ev96100_setup
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_MIPS_EV64120
r_case
id|MACH_GROUP_GALILEO
suffix:colon
id|ev64120_setup
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#if defined(CONFIG_MIPS_IVR) || defined(CONFIG_MIPS_ITE8172)
r_case
id|MACH_GROUP_ITE
suffix:colon
r_case
id|MACH_GROUP_GLOBESPAN
suffix:colon
id|it8172_setup
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif  
macro_line|#ifdef CONFIG_NINO
r_case
id|MACH_GROUP_PHILIPS
suffix:colon
id|nino_setup
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_MIPS_PB1000
r_case
id|MACH_GROUP_ALCHEMY
suffix:colon
id|au1000_setup
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
r_default
suffix:colon
id|panic
c_func
(paren
l_string|&quot;Unsupported architecture&quot;
)paren
suffix:semicolon
)brace
id|strncpy
c_func
(paren
id|command_line
comma
id|arcs_cmdline
comma
r_sizeof
id|command_line
)paren
suffix:semicolon
id|command_line
(braket
r_sizeof
id|command_line
op_minus
l_int|1
)braket
op_assign
l_int|0
suffix:semicolon
id|strcpy
c_func
(paren
id|saved_command_line
comma
id|command_line
)paren
suffix:semicolon
op_star
id|cmdline_p
op_assign
id|command_line
suffix:semicolon
id|parse_mem_cmdline
c_func
(paren
)paren
suffix:semicolon
DECL|macro|PFN_UP
mdefine_line|#define PFN_UP(x)&t;(((x) + PAGE_SIZE - 1) &gt;&gt; PAGE_SHIFT)
DECL|macro|PFN_DOWN
mdefine_line|#define PFN_DOWN(x)&t;((x) &gt;&gt; PAGE_SHIFT)
DECL|macro|PFN_PHYS
mdefine_line|#define PFN_PHYS(x)&t;((x) &lt;&lt; PAGE_SHIFT)
multiline_comment|/*&n;&t; * Partially used pages are not usable - thus&n;&t; * we are rounding upwards.&n;&t; */
id|start_pfn
op_assign
id|PFN_UP
c_func
(paren
id|__pa
c_func
(paren
op_amp
id|_end
)paren
)paren
suffix:semicolon
multiline_comment|/* Find the highest page frame number we have available.  */
id|max_pfn
op_assign
l_int|0
suffix:semicolon
id|first_usable_pfn
op_assign
op_minus
l_int|1UL
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|boot_mem_map.nr_map
suffix:semicolon
id|i
op_increment
)paren
(brace
r_int
r_int
id|start
comma
id|end
suffix:semicolon
r_if
c_cond
(paren
id|boot_mem_map.map
(braket
id|i
)braket
dot
id|type
op_ne
id|BOOT_MEM_RAM
)paren
r_continue
suffix:semicolon
id|start
op_assign
id|PFN_UP
c_func
(paren
id|boot_mem_map.map
(braket
id|i
)braket
dot
id|addr
)paren
suffix:semicolon
id|end
op_assign
id|PFN_DOWN
c_func
(paren
id|boot_mem_map.map
(braket
id|i
)braket
dot
id|addr
op_plus
id|boot_mem_map.map
(braket
id|i
)braket
dot
id|size
)paren
suffix:semicolon
r_if
c_cond
(paren
id|start
op_ge
id|end
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|end
OG
id|max_pfn
)paren
id|max_pfn
op_assign
id|end
suffix:semicolon
r_if
c_cond
(paren
id|start
OL
id|first_usable_pfn
)paren
(brace
r_if
c_cond
(paren
id|start
OG
id|start_pfn
)paren
(brace
id|first_usable_pfn
op_assign
id|start
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|end
OG
id|start_pfn
)paren
(brace
id|first_usable_pfn
op_assign
id|start_pfn
suffix:semicolon
)brace
)brace
)brace
multiline_comment|/* Initialize the boot-time allocator.  */
id|bootmap_size
op_assign
id|init_bootmem
c_func
(paren
id|first_usable_pfn
comma
id|max_pfn
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * Register fully available low RAM pages with the bootmem allocator.&n;&t; */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|boot_mem_map.nr_map
suffix:semicolon
id|i
op_increment
)paren
(brace
r_int
r_int
id|curr_pfn
comma
id|last_pfn
comma
id|size
suffix:semicolon
multiline_comment|/*&n;&t;&t; * Reserve usable memory.&n;&t;&t; */
r_if
c_cond
(paren
id|boot_mem_map.map
(braket
id|i
)braket
dot
id|type
op_ne
id|BOOT_MEM_RAM
)paren
r_continue
suffix:semicolon
multiline_comment|/*&n;&t;&t; * We are rounding up the start address of usable memory:&n;&t;&t; */
id|curr_pfn
op_assign
id|PFN_UP
c_func
(paren
id|boot_mem_map.map
(braket
id|i
)braket
dot
id|addr
)paren
suffix:semicolon
r_if
c_cond
(paren
id|curr_pfn
op_ge
id|max_pfn
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|curr_pfn
OL
id|start_pfn
)paren
id|curr_pfn
op_assign
id|start_pfn
suffix:semicolon
multiline_comment|/*&n;&t;&t; * ... and at the end of the usable range downwards:&n;&t;&t; */
id|last_pfn
op_assign
id|PFN_DOWN
c_func
(paren
id|boot_mem_map.map
(braket
id|i
)braket
dot
id|addr
op_plus
id|boot_mem_map.map
(braket
id|i
)braket
dot
id|size
)paren
suffix:semicolon
r_if
c_cond
(paren
id|last_pfn
OG
id|max_pfn
)paren
id|last_pfn
op_assign
id|max_pfn
suffix:semicolon
multiline_comment|/*&n;&t;&t; * ... finally, did all the rounding and playing&n;&t;&t; * around just make the area go away?&n;&t;&t; */
r_if
c_cond
(paren
id|last_pfn
op_le
id|curr_pfn
)paren
r_continue
suffix:semicolon
id|size
op_assign
id|last_pfn
op_minus
id|curr_pfn
suffix:semicolon
id|free_bootmem
c_func
(paren
id|PFN_PHYS
c_func
(paren
id|curr_pfn
)paren
comma
id|PFN_PHYS
c_func
(paren
id|size
)paren
)paren
suffix:semicolon
)brace
multiline_comment|/* Reserve the bootmap memory.  */
id|reserve_bootmem
c_func
(paren
id|PFN_PHYS
c_func
(paren
id|first_usable_pfn
)paren
comma
id|bootmap_size
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_BLK_DEV_INITRD
multiline_comment|/* Board specific code should have set up initrd_start and initrd_end */
id|ROOT_DEV
op_assign
id|Root_RAM0
suffix:semicolon
r_if
c_cond
(paren
id|__rd_start
op_ne
id|__rd_end
)paren
(brace
id|initrd_start
op_assign
(paren
r_int
r_int
)paren
op_amp
id|__rd_start
suffix:semicolon
id|initrd_end
op_assign
(paren
r_int
r_int
)paren
op_amp
id|__rd_end
suffix:semicolon
)brace
id|initrd_below_start_ok
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|initrd_start
)paren
(brace
r_int
r_int
id|initrd_size
op_assign
(paren
(paren
r_int
r_char
op_star
)paren
id|initrd_end
)paren
op_minus
(paren
(paren
r_int
r_char
op_star
)paren
id|initrd_start
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;Initial ramdisk at: 0x%p (%lu bytes)&bslash;n&quot;
comma
(paren
r_void
op_star
)paren
id|initrd_start
comma
id|initrd_size
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
r_void
op_star
)paren
id|initrd_end
OG
id|phys_to_virt
c_func
(paren
id|PFN_PHYS
c_func
(paren
id|max_low_pfn
)paren
)paren
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;initrd extends beyond end of memory &quot;
l_string|&quot;(0x%lx &gt; 0x%p)&bslash;ndisabling initrd&bslash;n&quot;
comma
id|initrd_end
comma
id|phys_to_virt
c_func
(paren
id|PFN_PHYS
c_func
(paren
id|max_low_pfn
)paren
)paren
)paren
suffix:semicolon
id|initrd_start
op_assign
id|initrd_end
op_assign
l_int|0
suffix:semicolon
)brace
)brace
macro_line|#endif /* CONFIG_BLK_DEV_INITRD  */
id|paging_init
c_func
(paren
)paren
suffix:semicolon
id|code_resource.start
op_assign
id|virt_to_bus
c_func
(paren
op_amp
id|_ftext
)paren
suffix:semicolon
id|code_resource.end
op_assign
id|virt_to_bus
c_func
(paren
op_amp
id|_etext
)paren
op_minus
l_int|1
suffix:semicolon
id|data_resource.start
op_assign
id|virt_to_bus
c_func
(paren
op_amp
id|_fdata
)paren
suffix:semicolon
id|data_resource.end
op_assign
id|virt_to_bus
c_func
(paren
op_amp
id|_edata
)paren
op_minus
l_int|1
suffix:semicolon
multiline_comment|/*&n;&t; * Request address space for all standard RAM.&n;&t; */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|boot_mem_map.nr_map
suffix:semicolon
id|i
op_increment
)paren
(brace
r_struct
id|resource
op_star
id|res
suffix:semicolon
id|res
op_assign
id|alloc_bootmem
c_func
(paren
r_sizeof
(paren
r_struct
id|resource
)paren
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|boot_mem_map.map
(braket
id|i
)braket
dot
id|type
)paren
(brace
r_case
id|BOOT_MEM_RAM
suffix:colon
r_case
id|BOOT_MEM_ROM_DATA
suffix:colon
id|res-&gt;name
op_assign
l_string|&quot;System RAM&quot;
suffix:semicolon
r_break
suffix:semicolon
r_case
id|BOOT_MEM_RESERVED
suffix:colon
r_default
suffix:colon
id|res-&gt;name
op_assign
l_string|&quot;reserved&quot;
suffix:semicolon
)brace
id|res-&gt;start
op_assign
id|boot_mem_map.map
(braket
id|i
)braket
dot
id|addr
suffix:semicolon
id|res-&gt;end
op_assign
id|res-&gt;start
op_plus
id|boot_mem_map.map
(braket
id|i
)braket
dot
id|size
op_minus
l_int|1
suffix:semicolon
id|res-&gt;flags
op_assign
id|IORESOURCE_MEM
op_or
id|IORESOURCE_BUSY
suffix:semicolon
id|request_resource
c_func
(paren
op_amp
id|iomem_resource
comma
id|res
)paren
suffix:semicolon
multiline_comment|/*&n;&t;&t; *  We dont&squot;t know which RAM region contains kernel data,&n;&t;&t; *  so we try it repeatedly and let the resource manager&n;&t;&t; *  test it.&n;&t;&t; */
id|request_resource
c_func
(paren
id|res
comma
op_amp
id|code_resource
)paren
suffix:semicolon
id|request_resource
c_func
(paren
id|res
comma
op_amp
id|data_resource
)paren
suffix:semicolon
)brace
)brace
DECL|function|r3081_wait
r_void
id|r3081_wait
c_func
(paren
r_void
)paren
(brace
r_int
r_int
id|cfg
op_assign
id|read_32bit_cp0_register
c_func
(paren
id|CP0_CONF
)paren
suffix:semicolon
id|write_32bit_cp0_register
c_func
(paren
id|CP0_CONF
comma
id|cfg
op_or
id|CONF_HALT
)paren
suffix:semicolon
)brace
DECL|function|r4k_wait
r_void
id|r4k_wait
c_func
(paren
r_void
)paren
(brace
id|__asm__
c_func
(paren
l_string|&quot;.set&bslash;tmips3&bslash;n&bslash;t&quot;
l_string|&quot;wait&bslash;n&bslash;t&quot;
l_string|&quot;.set&bslash;tmips0&quot;
)paren
suffix:semicolon
)brace
eof
