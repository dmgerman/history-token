multiline_comment|/*&n; * This file is subject to the terms and conditions of the GNU General Public&n; * License.  See the file &quot;COPYING&quot; in the main directory of this archive&n; * for more details.&n; *&n; * Copyright (C) 2000  Ani Joshi &lt;ajoshi@unixbox.com&gt;&n; * Copyright (C) 2000, 2001  Ralf Baechle &lt;ralf@gnu.org&gt;&n; * swiped from i386, and cloned for MIPS by Geert, polished by Ralf.&n; */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/types.h&gt;
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/string.h&gt;
macro_line|#include &lt;linux/pci.h&gt;
macro_line|#include &lt;asm/io.h&gt;
macro_line|#ifndef UNCAC_BASE&t;/* Hack ... */
DECL|macro|UNCAC_BASE
mdefine_line|#define UNCAC_BASE&t;0x9000000000000000UL
macro_line|#endif
DECL|function|dma_alloc_coherent
r_void
op_star
id|dma_alloc_coherent
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_int
id|size
comma
id|dma_addr_t
op_star
id|dma_handle
comma
r_int
id|gfp
)paren
(brace
r_void
op_star
id|ret
suffix:semicolon
multiline_comment|/* ignore region specifiers */
id|gfp
op_and_assign
op_complement
(paren
id|__GFP_DMA
op_or
id|__GFP_HIGHMEM
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dev
op_eq
l_int|NULL
op_logical_or
(paren
op_star
id|dev-&gt;dma_mask
OL
l_int|0xffffffff
)paren
)paren
id|gfp
op_or_assign
id|GFP_DMA
suffix:semicolon
id|ret
op_assign
(paren
r_void
op_star
)paren
id|__get_free_pages
c_func
(paren
id|gfp
comma
id|get_order
c_func
(paren
id|size
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
op_ne
l_int|NULL
)paren
(brace
id|memset
c_func
(paren
id|ret
comma
l_int|0
comma
id|size
)paren
suffix:semicolon
macro_line|#if 0&t;/* Broken support for some platforms ...  */
r_if
c_cond
(paren
id|hwdev
)paren
id|bus
op_assign
id|hwdev-&gt;bus
suffix:semicolon
op_star
id|dma_handle
op_assign
id|bus_to_baddr
c_func
(paren
id|bus
comma
id|__pa
c_func
(paren
id|ret
)paren
)paren
suffix:semicolon
macro_line|#else
op_star
id|dma_handle
op_assign
id|virt_to_phys
c_func
(paren
id|ret
)paren
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_NONCOHERENT_IO
id|dma_cache_wback_inv
c_func
(paren
(paren
r_int
r_int
)paren
id|ret
comma
id|size
)paren
suffix:semicolon
id|ret
op_assign
id|UNCAC_ADDR
c_func
(paren
id|ret
)paren
suffix:semicolon
macro_line|#endif
)brace
r_return
id|ret
suffix:semicolon
)brace
DECL|function|dma_free_coherent
r_void
id|dma_free_coherent
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_int
id|size
comma
r_void
op_star
id|vaddr
comma
id|dma_addr_t
id|dma_handle
)paren
(brace
r_int
r_int
id|addr
op_assign
(paren
r_int
r_int
)paren
id|vaddr
suffix:semicolon
macro_line|#ifdef CONFIG_NONCOHERENT_IO
id|addr
op_assign
id|CAC_ADDR
c_func
(paren
id|addr
)paren
suffix:semicolon
macro_line|#endif
id|free_pages
c_func
(paren
id|addr
comma
id|get_order
c_func
(paren
id|size
)paren
)paren
suffix:semicolon
)brace
DECL|variable|pci_alloc_consistent
id|EXPORT_SYMBOL
c_func
(paren
id|pci_alloc_consistent
)paren
suffix:semicolon
DECL|variable|pci_free_consistent
id|EXPORT_SYMBOL
c_func
(paren
id|pci_free_consistent
)paren
suffix:semicolon
eof
