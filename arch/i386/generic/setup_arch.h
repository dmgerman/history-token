macro_line|#ifndef SETUP_POST
DECL|macro|ARCH_SETUP
mdefine_line|#define ARCH_SETUP
macro_line|#else
DECL|function|machine_specific_memory_setup
r_static
r_inline
r_char
op_star
id|__init
id|machine_specific_memory_setup
c_func
(paren
r_void
)paren
(brace
r_char
op_star
id|who
suffix:semicolon
id|who
op_assign
l_string|&quot;BIOS-e820&quot;
suffix:semicolon
multiline_comment|/*&n;&t; * Try to copy the BIOS-supplied E820-map.&n;&t; *&n;&t; * Otherwise fake a memory map; one section from 0k-&gt;640k,&n;&t; * the next section from 1mb-&gt;appropriate_mem_k&n;&t; */
id|sanitize_e820_map
c_func
(paren
id|E820_MAP
comma
op_amp
id|E820_MAP_NR
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_e820_map
c_func
(paren
id|E820_MAP
comma
id|E820_MAP_NR
)paren
OL
l_int|0
)paren
(brace
r_int
r_int
id|mem_size
suffix:semicolon
multiline_comment|/* compare results from other methods and take the greater */
r_if
c_cond
(paren
id|ALT_MEM_K
OL
id|EXT_MEM_K
)paren
(brace
id|mem_size
op_assign
id|EXT_MEM_K
suffix:semicolon
id|who
op_assign
l_string|&quot;BIOS-88&quot;
suffix:semicolon
)brace
r_else
(brace
id|mem_size
op_assign
id|ALT_MEM_K
suffix:semicolon
id|who
op_assign
l_string|&quot;BIOS-e801&quot;
suffix:semicolon
)brace
id|e820.nr_map
op_assign
l_int|0
suffix:semicolon
id|add_memory_region
c_func
(paren
l_int|0
comma
id|LOWMEMSIZE
c_func
(paren
)paren
comma
id|E820_RAM
)paren
suffix:semicolon
id|add_memory_region
c_func
(paren
id|HIGH_MEMORY
comma
id|mem_size
op_lshift
l_int|10
comma
id|E820_RAM
)paren
suffix:semicolon
)brace
r_return
id|who
suffix:semicolon
)brace
macro_line|#endif
eof
