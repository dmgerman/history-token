multiline_comment|/*&n; *  Machine specific resource allocation for PC-9800.&n; *  Written by Osamu Tomita &lt;tomita@cinet.co.jp&gt;&n; */
macro_line|#include &lt;linux/ioport.h&gt;
macro_line|#include &lt;asm/io.h&gt;
macro_line|#include &lt;asm/std_resources.h&gt;
DECL|variable|str_pic1
r_static
r_char
id|str_pic1
(braket
)braket
op_assign
l_string|&quot;pic1&quot;
suffix:semicolon
DECL|variable|str_dma
r_static
r_char
id|str_dma
(braket
)braket
op_assign
l_string|&quot;dma&quot;
suffix:semicolon
DECL|variable|str_pic2
r_static
r_char
id|str_pic2
(braket
)braket
op_assign
l_string|&quot;pic2&quot;
suffix:semicolon
DECL|variable|str_calender_clock
r_static
r_char
id|str_calender_clock
(braket
)braket
op_assign
l_string|&quot;calender clock&quot;
suffix:semicolon
DECL|variable|str_system
r_static
r_char
id|str_system
(braket
)braket
op_assign
l_string|&quot;system&quot;
suffix:semicolon
DECL|variable|str_nmi_control
r_static
r_char
id|str_nmi_control
(braket
)braket
op_assign
l_string|&quot;nmi control&quot;
suffix:semicolon
DECL|variable|str_kanji_rom
r_static
r_char
id|str_kanji_rom
(braket
)braket
op_assign
l_string|&quot;kanji rom&quot;
suffix:semicolon
DECL|variable|str_keyboard
r_static
r_char
id|str_keyboard
(braket
)braket
op_assign
l_string|&quot;keyboard&quot;
suffix:semicolon
DECL|variable|str_text_gdc
r_static
r_char
id|str_text_gdc
(braket
)braket
op_assign
l_string|&quot;text gdc&quot;
suffix:semicolon
DECL|variable|str_crtc
r_static
r_char
id|str_crtc
(braket
)braket
op_assign
l_string|&quot;crtc&quot;
suffix:semicolon
DECL|variable|str_timer
r_static
r_char
id|str_timer
(braket
)braket
op_assign
l_string|&quot;timer&quot;
suffix:semicolon
DECL|variable|str_graphic_gdc
r_static
r_char
id|str_graphic_gdc
(braket
)braket
op_assign
l_string|&quot;graphic gdc&quot;
suffix:semicolon
DECL|variable|str_dma_ex_bank
r_static
r_char
id|str_dma_ex_bank
(braket
)braket
op_assign
l_string|&quot;dma ex. bank&quot;
suffix:semicolon
DECL|variable|str_beep_freq
r_static
r_char
id|str_beep_freq
(braket
)braket
op_assign
l_string|&quot;beep freq.&quot;
suffix:semicolon
DECL|variable|str_mouse_pio
r_static
r_char
id|str_mouse_pio
(braket
)braket
op_assign
l_string|&quot;mouse pio&quot;
suffix:semicolon
DECL|variable|standard_io_resources
r_struct
id|resource
id|standard_io_resources
(braket
)braket
op_assign
(brace
(brace
id|str_pic1
comma
l_int|0x00
comma
l_int|0x00
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_dma
comma
l_int|0x01
comma
l_int|0x01
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_pic1
comma
l_int|0x02
comma
l_int|0x02
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_dma
comma
l_int|0x03
comma
l_int|0x03
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_dma
comma
l_int|0x05
comma
l_int|0x05
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_dma
comma
l_int|0x07
comma
l_int|0x07
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_pic2
comma
l_int|0x08
comma
l_int|0x08
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_dma
comma
l_int|0x09
comma
l_int|0x09
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_pic2
comma
l_int|0x0a
comma
l_int|0x0a
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_dma
comma
l_int|0x0b
comma
l_int|0x0b
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_dma
comma
l_int|0x0d
comma
l_int|0x0d
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_dma
comma
l_int|0x0f
comma
l_int|0x0f
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_dma
comma
l_int|0x11
comma
l_int|0x11
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_dma
comma
l_int|0x13
comma
l_int|0x13
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_dma
comma
l_int|0x15
comma
l_int|0x15
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_dma
comma
l_int|0x17
comma
l_int|0x17
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_dma
comma
l_int|0x19
comma
l_int|0x19
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_dma
comma
l_int|0x1b
comma
l_int|0x1b
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_dma
comma
l_int|0x1d
comma
l_int|0x1d
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_dma
comma
l_int|0x1f
comma
l_int|0x1f
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_calender_clock
comma
l_int|0x20
comma
l_int|0x20
comma
l_int|0
)brace
comma
(brace
id|str_dma
comma
l_int|0x21
comma
l_int|0x21
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_calender_clock
comma
l_int|0x22
comma
l_int|0x22
comma
l_int|0
)brace
comma
(brace
id|str_dma
comma
l_int|0x23
comma
l_int|0x23
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_dma
comma
l_int|0x25
comma
l_int|0x25
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_dma
comma
l_int|0x27
comma
l_int|0x27
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_dma
comma
l_int|0x29
comma
l_int|0x29
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_dma
comma
l_int|0x2b
comma
l_int|0x2b
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_dma
comma
l_int|0x2d
comma
l_int|0x2d
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_system
comma
l_int|0x31
comma
l_int|0x31
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_system
comma
l_int|0x33
comma
l_int|0x33
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_system
comma
l_int|0x35
comma
l_int|0x35
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_system
comma
l_int|0x37
comma
l_int|0x37
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_nmi_control
comma
l_int|0x50
comma
l_int|0x50
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_nmi_control
comma
l_int|0x52
comma
l_int|0x52
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
l_string|&quot;time stamp&quot;
comma
l_int|0x5c
comma
l_int|0x5f
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_kanji_rom
comma
l_int|0xa1
comma
l_int|0xa1
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_kanji_rom
comma
l_int|0xa3
comma
l_int|0xa3
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_kanji_rom
comma
l_int|0xa5
comma
l_int|0xa5
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_kanji_rom
comma
l_int|0xa7
comma
l_int|0xa7
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_kanji_rom
comma
l_int|0xa9
comma
l_int|0xa9
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_keyboard
comma
l_int|0x41
comma
l_int|0x41
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_keyboard
comma
l_int|0x43
comma
l_int|0x43
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_text_gdc
comma
l_int|0x60
comma
l_int|0x60
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_text_gdc
comma
l_int|0x62
comma
l_int|0x62
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_text_gdc
comma
l_int|0x64
comma
l_int|0x64
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_text_gdc
comma
l_int|0x66
comma
l_int|0x66
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_text_gdc
comma
l_int|0x68
comma
l_int|0x68
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_text_gdc
comma
l_int|0x6a
comma
l_int|0x6a
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_text_gdc
comma
l_int|0x6c
comma
l_int|0x6c
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_text_gdc
comma
l_int|0x6e
comma
l_int|0x6e
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_crtc
comma
l_int|0x70
comma
l_int|0x70
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_crtc
comma
l_int|0x72
comma
l_int|0x72
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_crtc
comma
l_int|0x74
comma
l_int|0x74
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_crtc
comma
l_int|0x74
comma
l_int|0x74
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_crtc
comma
l_int|0x76
comma
l_int|0x76
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_crtc
comma
l_int|0x78
comma
l_int|0x78
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_crtc
comma
l_int|0x7a
comma
l_int|0x7a
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_timer
comma
l_int|0x71
comma
l_int|0x71
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_timer
comma
l_int|0x73
comma
l_int|0x73
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_timer
comma
l_int|0x75
comma
l_int|0x75
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_timer
comma
l_int|0x77
comma
l_int|0x77
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_graphic_gdc
comma
l_int|0xa0
comma
l_int|0xa0
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_graphic_gdc
comma
l_int|0xa2
comma
l_int|0xa2
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_graphic_gdc
comma
l_int|0xa4
comma
l_int|0xa4
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_graphic_gdc
comma
l_int|0xa6
comma
l_int|0xa6
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
l_string|&quot;cpu&quot;
comma
l_int|0xf0
comma
l_int|0xf7
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
l_string|&quot;fpu&quot;
comma
l_int|0xf8
comma
l_int|0xff
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_dma_ex_bank
comma
l_int|0x0e05
comma
l_int|0x0e05
comma
l_int|0
)brace
comma
(brace
id|str_dma_ex_bank
comma
l_int|0x0e07
comma
l_int|0x0e07
comma
l_int|0
)brace
comma
(brace
id|str_dma_ex_bank
comma
l_int|0x0e09
comma
l_int|0x0e09
comma
l_int|0
)brace
comma
(brace
id|str_dma_ex_bank
comma
l_int|0x0e0b
comma
l_int|0x0e0b
comma
l_int|0
)brace
comma
(brace
id|str_beep_freq
comma
l_int|0x3fd9
comma
l_int|0x3fd9
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_beep_freq
comma
l_int|0x3fdb
comma
l_int|0x3fdb
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_beep_freq
comma
l_int|0x3fdd
comma
l_int|0x3fdd
comma
id|IORESOURCE_BUSY
)brace
comma
(brace
id|str_beep_freq
comma
l_int|0x3fdf
comma
l_int|0x3fdf
comma
id|IORESOURCE_BUSY
)brace
comma
multiline_comment|/* All PC-9800 have (exactly) one mouse interface.  */
(brace
id|str_mouse_pio
comma
l_int|0x7fd9
comma
l_int|0x7fd9
comma
l_int|0
)brace
comma
(brace
id|str_mouse_pio
comma
l_int|0x7fdb
comma
l_int|0x7fdb
comma
l_int|0
)brace
comma
(brace
id|str_mouse_pio
comma
l_int|0x7fdd
comma
l_int|0x7fdd
comma
l_int|0
)brace
comma
(brace
id|str_mouse_pio
comma
l_int|0x7fdf
comma
l_int|0x7fdf
comma
l_int|0
)brace
comma
(brace
l_string|&quot;mouse timer&quot;
comma
l_int|0xbfdb
comma
l_int|0xbfdb
comma
l_int|0
)brace
comma
(brace
l_string|&quot;mouse irq&quot;
comma
l_int|0x98d7
comma
l_int|0x98d7
comma
l_int|0
)brace
comma
)brace
suffix:semicolon
DECL|macro|STANDARD_IO_RESOURCES
mdefine_line|#define STANDARD_IO_RESOURCES (sizeof(standard_io_resources)/sizeof(struct resource))
DECL|variable|tvram_resource
r_static
r_struct
id|resource
id|tvram_resource
op_assign
(brace
l_string|&quot;Text VRAM/CG window&quot;
comma
l_int|0xa0000
comma
l_int|0xa4fff
comma
id|IORESOURCE_BUSY
)brace
suffix:semicolon
DECL|variable|gvram_brg_resource
r_static
r_struct
id|resource
id|gvram_brg_resource
op_assign
(brace
l_string|&quot;Graphic VRAM (B/R/G)&quot;
comma
l_int|0xa8000
comma
l_int|0xbffff
comma
id|IORESOURCE_BUSY
)brace
suffix:semicolon
DECL|variable|gvram_e_resource
r_static
r_struct
id|resource
id|gvram_e_resource
op_assign
(brace
l_string|&quot;Graphic VRAM (E)&quot;
comma
l_int|0xe0000
comma
l_int|0xe7fff
comma
id|IORESOURCE_BUSY
)brace
suffix:semicolon
multiline_comment|/* System ROM resources */
DECL|macro|MAXROMS
mdefine_line|#define MAXROMS 6
DECL|variable|rom_resources
r_static
r_struct
id|resource
id|rom_resources
(braket
id|MAXROMS
)braket
op_assign
(brace
(brace
l_string|&quot;System ROM&quot;
comma
l_int|0xe8000
comma
l_int|0xfffff
comma
id|IORESOURCE_BUSY
)brace
)brace
suffix:semicolon
DECL|function|probe_roms
r_void
id|__init
id|probe_roms
c_func
(paren
r_void
)paren
(brace
r_int
id|i
suffix:semicolon
id|__u8
op_star
id|xrom_id
suffix:semicolon
r_int
id|roms
op_assign
l_int|1
suffix:semicolon
id|request_resource
c_func
(paren
op_amp
id|iomem_resource
comma
id|rom_resources
op_plus
l_int|0
)paren
suffix:semicolon
id|xrom_id
op_assign
(paren
id|__u8
op_star
)paren
id|isa_bus_to_virt
c_func
(paren
id|PC9800SCA_XROM_ID
op_plus
l_int|0x10
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|16
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|xrom_id
(braket
id|i
)braket
op_amp
l_int|0x80
)paren
(brace
r_int
id|j
suffix:semicolon
r_for
c_loop
(paren
id|j
op_assign
id|i
op_plus
l_int|1
suffix:semicolon
id|j
OL
l_int|16
op_logical_and
(paren
id|xrom_id
(braket
id|j
)braket
op_amp
l_int|0x80
)paren
suffix:semicolon
id|j
op_increment
)paren
suffix:semicolon
id|rom_resources
(braket
id|roms
)braket
dot
id|start
op_assign
l_int|0x0d0000
op_plus
id|i
op_star
l_int|0x001000
suffix:semicolon
id|rom_resources
(braket
id|roms
)braket
dot
id|end
op_assign
l_int|0x0d0000
op_plus
id|j
op_star
l_int|0x001000
op_minus
l_int|1
suffix:semicolon
id|rom_resources
(braket
id|roms
)braket
dot
id|name
op_assign
l_string|&quot;Extension ROM&quot;
suffix:semicolon
id|rom_resources
(braket
id|roms
)braket
dot
id|flags
op_assign
id|IORESOURCE_BUSY
suffix:semicolon
id|request_resource
c_func
(paren
op_amp
id|iomem_resource
comma
id|rom_resources
op_plus
id|roms
)paren
suffix:semicolon
r_if
c_cond
(paren
op_increment
id|roms
op_ge
id|MAXROMS
)paren
r_return
suffix:semicolon
)brace
)brace
)brace
DECL|function|request_graphics_resource
r_void
id|__init
id|request_graphics_resource
c_func
(paren
r_void
)paren
(brace
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
id|PC9800_HIGHRESO_P
c_func
(paren
)paren
)paren
(brace
id|tvram_resource.start
op_assign
l_int|0xe0000
suffix:semicolon
id|tvram_resource.end
op_assign
l_int|0xe4fff
suffix:semicolon
id|gvram_brg_resource.name
op_assign
l_string|&quot;Graphic VRAM&quot;
suffix:semicolon
id|gvram_brg_resource.start
op_assign
l_int|0xc0000
suffix:semicolon
id|gvram_brg_resource.end
op_assign
l_int|0xdffff
suffix:semicolon
)brace
id|request_resource
c_func
(paren
op_amp
id|iomem_resource
comma
op_amp
id|tvram_resource
)paren
suffix:semicolon
id|request_resource
c_func
(paren
op_amp
id|iomem_resource
comma
op_amp
id|gvram_brg_resource
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|PC9800_HIGHRESO_P
c_func
(paren
)paren
)paren
id|request_resource
c_func
(paren
op_amp
id|iomem_resource
comma
op_amp
id|gvram_e_resource
)paren
suffix:semicolon
r_if
c_cond
(paren
id|PC9800_HIGHRESO_P
c_func
(paren
)paren
op_logical_or
id|PC9800_9821_P
c_func
(paren
)paren
)paren
(brace
r_static
r_char
id|graphics
(braket
)braket
op_assign
l_string|&quot;graphics&quot;
suffix:semicolon
r_static
r_struct
id|resource
id|graphics_resources
(braket
)braket
op_assign
(brace
(brace
id|graphics
comma
l_int|0x9a0
comma
l_int|0x9a0
comma
l_int|0
)brace
comma
(brace
id|graphics
comma
l_int|0x9a2
comma
l_int|0x9a2
comma
l_int|0
)brace
comma
(brace
id|graphics
comma
l_int|0x9a4
comma
l_int|0x9a4
comma
l_int|0
)brace
comma
(brace
id|graphics
comma
l_int|0x9a6
comma
l_int|0x9a6
comma
l_int|0
)brace
comma
(brace
id|graphics
comma
l_int|0x9a8
comma
l_int|0x9a8
comma
l_int|0
)brace
comma
(brace
id|graphics
comma
l_int|0x9aa
comma
l_int|0x9aa
comma
l_int|0
)brace
comma
(brace
id|graphics
comma
l_int|0x9ac
comma
l_int|0x9ac
comma
l_int|0
)brace
comma
(brace
id|graphics
comma
l_int|0x9ae
comma
l_int|0x9ae
comma
l_int|0
)brace
comma
)brace
suffix:semicolon
DECL|macro|GRAPHICS_RESOURCES
mdefine_line|#define GRAPHICS_RESOURCES (sizeof(graphics_resources)/sizeof(struct resource))
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|GRAPHICS_RESOURCES
suffix:semicolon
id|i
op_increment
)paren
id|request_resource
c_func
(paren
op_amp
id|ioport_resource
comma
id|graphics_resources
op_plus
id|i
)paren
suffix:semicolon
)brace
)brace
DECL|function|request_standard_io_resources
r_void
id|__init
id|request_standard_io_resources
c_func
(paren
r_void
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|STANDARD_IO_RESOURCES
suffix:semicolon
id|i
op_increment
)paren
id|request_resource
c_func
(paren
op_amp
id|ioport_resource
comma
id|standard_io_resources
op_plus
id|i
)paren
suffix:semicolon
)brace
eof
