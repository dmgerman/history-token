macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;asm/processor.h&gt;
macro_line|#include &lt;asm/msr.h&gt;
macro_line|#include &quot;cpu.h&quot;
DECL|function|init_transmeta
r_static
r_void
id|__init
id|init_transmeta
c_func
(paren
r_struct
id|cpuinfo_x86
op_star
id|c
)paren
(brace
r_int
r_int
id|cap_mask
comma
id|uk
comma
id|max
comma
id|dummy
suffix:semicolon
r_int
r_int
id|cms_rev1
comma
id|cms_rev2
suffix:semicolon
r_int
r_int
id|cpu_rev
comma
id|cpu_freq
comma
id|cpu_flags
suffix:semicolon
r_char
id|cpu_info
(braket
l_int|65
)braket
suffix:semicolon
id|get_model_name
c_func
(paren
id|c
)paren
suffix:semicolon
multiline_comment|/* Same as AMD/Cyrix */
id|display_cacheinfo
c_func
(paren
id|c
)paren
suffix:semicolon
multiline_comment|/* Print CMS and CPU revision */
id|max
op_assign
id|cpuid_eax
c_func
(paren
l_int|0x80860000
)paren
suffix:semicolon
r_if
c_cond
(paren
id|max
op_ge
l_int|0x80860001
)paren
(brace
id|cpuid
c_func
(paren
l_int|0x80860001
comma
op_amp
id|dummy
comma
op_amp
id|cpu_rev
comma
op_amp
id|cpu_freq
comma
op_amp
id|cpu_flags
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;CPU: Processor revision %u.%u.%u.%u, %u MHz&bslash;n&quot;
comma
(paren
id|cpu_rev
op_rshift
l_int|24
)paren
op_amp
l_int|0xff
comma
(paren
id|cpu_rev
op_rshift
l_int|16
)paren
op_amp
l_int|0xff
comma
(paren
id|cpu_rev
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
comma
id|cpu_rev
op_amp
l_int|0xff
comma
id|cpu_freq
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|max
op_ge
l_int|0x80860002
)paren
(brace
id|cpuid
c_func
(paren
l_int|0x80860002
comma
op_amp
id|dummy
comma
op_amp
id|cms_rev1
comma
op_amp
id|cms_rev2
comma
op_amp
id|dummy
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;CPU: Code Morphing Software revision %u.%u.%u-%u-%u&bslash;n&quot;
comma
(paren
id|cms_rev1
op_rshift
l_int|24
)paren
op_amp
l_int|0xff
comma
(paren
id|cms_rev1
op_rshift
l_int|16
)paren
op_amp
l_int|0xff
comma
(paren
id|cms_rev1
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
comma
id|cms_rev1
op_amp
l_int|0xff
comma
id|cms_rev2
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|max
op_ge
l_int|0x80860006
)paren
(brace
id|cpuid
c_func
(paren
l_int|0x80860003
comma
(paren
r_void
op_star
)paren
op_amp
id|cpu_info
(braket
l_int|0
)braket
comma
(paren
r_void
op_star
)paren
op_amp
id|cpu_info
(braket
l_int|4
)braket
comma
(paren
r_void
op_star
)paren
op_amp
id|cpu_info
(braket
l_int|8
)braket
comma
(paren
r_void
op_star
)paren
op_amp
id|cpu_info
(braket
l_int|12
)braket
)paren
suffix:semicolon
id|cpuid
c_func
(paren
l_int|0x80860004
comma
(paren
r_void
op_star
)paren
op_amp
id|cpu_info
(braket
l_int|16
)braket
comma
(paren
r_void
op_star
)paren
op_amp
id|cpu_info
(braket
l_int|20
)braket
comma
(paren
r_void
op_star
)paren
op_amp
id|cpu_info
(braket
l_int|24
)braket
comma
(paren
r_void
op_star
)paren
op_amp
id|cpu_info
(braket
l_int|28
)braket
)paren
suffix:semicolon
id|cpuid
c_func
(paren
l_int|0x80860005
comma
(paren
r_void
op_star
)paren
op_amp
id|cpu_info
(braket
l_int|32
)braket
comma
(paren
r_void
op_star
)paren
op_amp
id|cpu_info
(braket
l_int|36
)braket
comma
(paren
r_void
op_star
)paren
op_amp
id|cpu_info
(braket
l_int|40
)braket
comma
(paren
r_void
op_star
)paren
op_amp
id|cpu_info
(braket
l_int|44
)braket
)paren
suffix:semicolon
id|cpuid
c_func
(paren
l_int|0x80860006
comma
(paren
r_void
op_star
)paren
op_amp
id|cpu_info
(braket
l_int|48
)braket
comma
(paren
r_void
op_star
)paren
op_amp
id|cpu_info
(braket
l_int|52
)braket
comma
(paren
r_void
op_star
)paren
op_amp
id|cpu_info
(braket
l_int|56
)braket
comma
(paren
r_void
op_star
)paren
op_amp
id|cpu_info
(braket
l_int|60
)braket
)paren
suffix:semicolon
id|cpu_info
(braket
l_int|64
)braket
op_assign
l_char|&squot;&bslash;0&squot;
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;CPU: %s&bslash;n&quot;
comma
id|cpu_info
)paren
suffix:semicolon
)brace
multiline_comment|/* Unhide possibly hidden capability flags */
id|rdmsr
c_func
(paren
l_int|0x80860004
comma
id|cap_mask
comma
id|uk
)paren
suffix:semicolon
id|wrmsr
c_func
(paren
l_int|0x80860004
comma
op_complement
l_int|0
comma
id|uk
)paren
suffix:semicolon
id|c-&gt;x86_capability
(braket
l_int|0
)braket
op_assign
id|cpuid_edx
c_func
(paren
l_int|0x00000001
)paren
suffix:semicolon
id|wrmsr
c_func
(paren
l_int|0x80860004
comma
id|cap_mask
comma
id|uk
)paren
suffix:semicolon
)brace
DECL|function|transmeta_identify
r_static
r_void
id|transmeta_identify
c_func
(paren
r_struct
id|cpuinfo_x86
op_star
id|c
)paren
(brace
id|u32
id|xlvl
suffix:semicolon
id|generic_identify
c_func
(paren
id|c
)paren
suffix:semicolon
multiline_comment|/* Transmeta-defined flags: level 0x80860001 */
id|xlvl
op_assign
id|cpuid_eax
c_func
(paren
l_int|0x80860000
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|xlvl
op_amp
l_int|0xffff0000
)paren
op_eq
l_int|0x80860000
)paren
(brace
r_if
c_cond
(paren
id|xlvl
op_ge
l_int|0x80860001
)paren
id|c-&gt;x86_capability
(braket
l_int|2
)braket
op_assign
id|cpuid_edx
c_func
(paren
l_int|0x80860001
)paren
suffix:semicolon
)brace
)brace
DECL|variable|__initdata
r_static
r_struct
id|cpu_dev
id|transmeta_cpu_dev
id|__initdata
op_assign
(brace
id|c_vendor
suffix:colon
l_string|&quot;Transmeta&quot;
comma
id|c_ident
suffix:colon
(brace
l_string|&quot;GenuineTMx86&quot;
comma
l_string|&quot;TransmetaCPU&quot;
)brace
comma
id|c_init
suffix:colon
id|init_transmeta
comma
id|c_identify
suffix:colon
id|transmeta_identify
comma
)brace
suffix:semicolon
DECL|function|transmeta_init_cpu
r_int
id|__init
id|transmeta_init_cpu
c_func
(paren
r_void
)paren
(brace
id|cpu_devs
(braket
id|X86_VENDOR_TRANSMETA
)braket
op_assign
op_amp
id|transmeta_cpu_dev
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
singleline_comment|//early_arch_initcall(transmeta_init_cpu);
eof
