macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/string.h&gt;
macro_line|#include &lt;linux/bitops.h&gt;
macro_line|#include &lt;linux/smp.h&gt;
macro_line|#include &lt;linux/thread_info.h&gt;
macro_line|#include &lt;asm/processor.h&gt;
macro_line|#include &lt;asm/msr.h&gt;
macro_line|#include &lt;asm/uaccess.h&gt;
macro_line|#include &quot;cpu.h&quot;
macro_line|#ifdef CONFIG_X86_LOCAL_APIC
macro_line|#include &lt;asm/mpspec.h&gt;
macro_line|#include &lt;asm/apic.h&gt;
macro_line|#include &lt;mach_apic.h&gt;
macro_line|#endif
r_extern
r_int
id|trap_init_f00f_bug
c_func
(paren
r_void
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_X86_INTEL_USERCOPY
multiline_comment|/*&n; * Alignment at which movsl is preferred for bulk memory copies.&n; */
DECL|variable|movsl_mask
r_struct
id|movsl_mask
id|movsl_mask
suffix:semicolon
macro_line|#endif
DECL|function|early_intel_workaround
r_void
id|__init
id|early_intel_workaround
c_func
(paren
r_struct
id|cpuinfo_x86
op_star
id|c
)paren
(brace
r_if
c_cond
(paren
id|c-&gt;x86_vendor
op_ne
id|X86_VENDOR_INTEL
)paren
r_return
suffix:semicolon
multiline_comment|/* Netburst reports 64 bytes clflush size, but does IO in 128 bytes */
r_if
c_cond
(paren
id|c-&gt;x86
op_eq
l_int|15
op_logical_and
id|c-&gt;x86_cache_alignment
op_eq
l_int|64
)paren
id|c-&gt;x86_cache_alignment
op_assign
l_int|128
suffix:semicolon
)brace
multiline_comment|/*&n; *&t;Early probe support logic for ppro memory erratum #50&n; *&n; *&t;This is called before we do cpu ident work&n; */
DECL|function|ppro_with_ram_bug
r_int
id|__init
id|ppro_with_ram_bug
c_func
(paren
r_void
)paren
(brace
multiline_comment|/* Uses data from early_cpu_detect now */
r_if
c_cond
(paren
id|boot_cpu_data.x86_vendor
op_eq
id|X86_VENDOR_INTEL
op_logical_and
id|boot_cpu_data.x86
op_eq
l_int|6
op_logical_and
id|boot_cpu_data.x86_model
op_eq
l_int|1
op_logical_and
id|boot_cpu_data.x86_mask
OL
l_int|8
)paren
(brace
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;Pentium Pro with Errata#50 detected. Taking evasive action.&bslash;n&quot;
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * P4 Xeon errata 037 workaround.&n; * Hardware prefetcher may cause stale data to be loaded into the cache.&n; */
DECL|function|Intel_errata_workarounds
r_static
r_void
id|__init
id|Intel_errata_workarounds
c_func
(paren
r_struct
id|cpuinfo_x86
op_star
id|c
)paren
(brace
r_int
r_int
id|lo
comma
id|hi
suffix:semicolon
r_if
c_cond
(paren
(paren
id|c-&gt;x86
op_eq
l_int|15
)paren
op_logical_and
(paren
id|c-&gt;x86_model
op_eq
l_int|1
)paren
op_logical_and
(paren
id|c-&gt;x86_mask
op_eq
l_int|1
)paren
)paren
(brace
id|rdmsr
(paren
id|MSR_IA32_MISC_ENABLE
comma
id|lo
comma
id|hi
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|lo
op_amp
(paren
l_int|1
op_lshift
l_int|9
)paren
)paren
op_eq
l_int|0
)paren
(brace
id|printk
(paren
id|KERN_INFO
l_string|&quot;CPU: C0 stepping P4 Xeon detected.&bslash;n&quot;
)paren
suffix:semicolon
id|printk
(paren
id|KERN_INFO
l_string|&quot;CPU: Disabling hardware prefetching (Errata 037)&bslash;n&quot;
)paren
suffix:semicolon
id|lo
op_or_assign
(paren
l_int|1
op_lshift
l_int|9
)paren
suffix:semicolon
multiline_comment|/* Disable hw prefetching */
id|wrmsr
(paren
id|MSR_IA32_MISC_ENABLE
comma
id|lo
comma
id|hi
)paren
suffix:semicolon
)brace
)brace
)brace
DECL|function|init_intel
r_static
r_void
id|__init
id|init_intel
c_func
(paren
r_struct
id|cpuinfo_x86
op_star
id|c
)paren
(brace
r_int
r_int
id|l2
op_assign
l_int|0
suffix:semicolon
r_char
op_star
id|p
op_assign
l_int|NULL
suffix:semicolon
macro_line|#ifdef CONFIG_X86_F00F_BUG
multiline_comment|/*&n;&t; * All current models of Pentium and Pentium with MMX technology CPUs&n;&t; * have the F0 0F bug, which lets nonprivileged users lock up the system.&n;&t; * Note that the workaround only should be initialized once...&n;&t; */
id|c-&gt;f00f_bug
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|c-&gt;x86
op_eq
l_int|5
)paren
(brace
r_static
r_int
id|f00f_workaround_enabled
op_assign
l_int|0
suffix:semicolon
id|c-&gt;f00f_bug
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|f00f_workaround_enabled
)paren
(brace
id|trap_init_f00f_bug
c_func
(paren
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_NOTICE
l_string|&quot;Intel Pentium with F0 0F bug - workaround enabled.&bslash;n&quot;
)paren
suffix:semicolon
id|f00f_workaround_enabled
op_assign
l_int|1
suffix:semicolon
)brace
)brace
macro_line|#endif
id|select_idle_routine
c_func
(paren
id|c
)paren
suffix:semicolon
id|l2
op_assign
id|init_intel_cacheinfo
c_func
(paren
id|c
)paren
suffix:semicolon
multiline_comment|/* SEP CPUID bug: Pentium Pro reports SEP but doesn&squot;t have it until model 3 mask 3 */
r_if
c_cond
(paren
(paren
id|c-&gt;x86
op_lshift
l_int|8
op_or
id|c-&gt;x86_model
op_lshift
l_int|4
op_or
id|c-&gt;x86_mask
)paren
OL
l_int|0x633
)paren
id|clear_bit
c_func
(paren
id|X86_FEATURE_SEP
comma
id|c-&gt;x86_capability
)paren
suffix:semicolon
multiline_comment|/* Names for the Pentium II/Celeron processors &n;&t;   detectable only by also checking the cache size.&n;&t;   Dixon is NOT a Celeron. */
r_if
c_cond
(paren
id|c-&gt;x86
op_eq
l_int|6
)paren
(brace
r_switch
c_cond
(paren
id|c-&gt;x86_model
)paren
(brace
r_case
l_int|5
suffix:colon
r_if
c_cond
(paren
id|c-&gt;x86_mask
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|l2
op_eq
l_int|0
)paren
id|p
op_assign
l_string|&quot;Celeron (Covington)&quot;
suffix:semicolon
r_else
r_if
c_cond
(paren
id|l2
op_eq
l_int|256
)paren
id|p
op_assign
l_string|&quot;Mobile Pentium II (Dixon)&quot;
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
l_int|6
suffix:colon
r_if
c_cond
(paren
id|l2
op_eq
l_int|128
)paren
id|p
op_assign
l_string|&quot;Celeron (Mendocino)&quot;
suffix:semicolon
r_else
r_if
c_cond
(paren
id|c-&gt;x86_mask
op_eq
l_int|0
op_logical_or
id|c-&gt;x86_mask
op_eq
l_int|5
)paren
id|p
op_assign
l_string|&quot;Celeron-A&quot;
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|8
suffix:colon
r_if
c_cond
(paren
id|l2
op_eq
l_int|128
)paren
id|p
op_assign
l_string|&quot;Celeron (Coppermine)&quot;
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|p
)paren
id|strcpy
c_func
(paren
id|c-&gt;x86_model_id
comma
id|p
)paren
suffix:semicolon
id|detect_ht
c_func
(paren
id|c
)paren
suffix:semicolon
multiline_comment|/* Work around errata */
id|Intel_errata_workarounds
c_func
(paren
id|c
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_X86_INTEL_USERCOPY
multiline_comment|/*&n;&t; * Set up the preferred alignment for movsl bulk memory moves&n;&t; */
r_switch
c_cond
(paren
id|c-&gt;x86
)paren
(brace
r_case
l_int|4
suffix:colon
multiline_comment|/* 486: untested */
r_break
suffix:semicolon
r_case
l_int|5
suffix:colon
multiline_comment|/* Old Pentia: untested */
r_break
suffix:semicolon
r_case
l_int|6
suffix:colon
multiline_comment|/* PII/PIII only like movsl with 8-byte alignment */
id|movsl_mask.mask
op_assign
l_int|7
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|15
suffix:colon
multiline_comment|/* P4 is OK down to 8-byte alignment */
id|movsl_mask.mask
op_assign
l_int|7
suffix:semicolon
r_break
suffix:semicolon
)brace
macro_line|#endif
r_if
c_cond
(paren
id|c-&gt;x86
op_eq
l_int|15
)paren
id|set_bit
c_func
(paren
id|X86_FEATURE_P4
comma
id|c-&gt;x86_capability
)paren
suffix:semicolon
r_if
c_cond
(paren
id|c-&gt;x86
op_eq
l_int|6
)paren
id|set_bit
c_func
(paren
id|X86_FEATURE_P3
comma
id|c-&gt;x86_capability
)paren
suffix:semicolon
)brace
DECL|function|intel_size_cache
r_static
r_int
r_int
id|intel_size_cache
c_func
(paren
r_struct
id|cpuinfo_x86
op_star
id|c
comma
r_int
r_int
id|size
)paren
(brace
multiline_comment|/* Intel PIII Tualatin. This comes in two flavours.&n;&t; * One has 256kb of cache, the other 512. We have no way&n;&t; * to determine which, so we use a boottime override&n;&t; * for the 512kb model, and assume 256 otherwise.&n;&t; */
r_if
c_cond
(paren
(paren
id|c-&gt;x86
op_eq
l_int|6
)paren
op_logical_and
(paren
id|c-&gt;x86_model
op_eq
l_int|11
)paren
op_logical_and
(paren
id|size
op_eq
l_int|0
)paren
)paren
id|size
op_assign
l_int|256
suffix:semicolon
r_return
id|size
suffix:semicolon
)brace
DECL|variable|__initdata
r_static
r_struct
id|cpu_dev
id|intel_cpu_dev
id|__initdata
op_assign
(brace
dot
id|c_vendor
op_assign
l_string|&quot;Intel&quot;
comma
dot
id|c_ident
op_assign
(brace
l_string|&quot;GenuineIntel&quot;
)brace
comma
dot
id|c_models
op_assign
(brace
(brace
dot
id|vendor
op_assign
id|X86_VENDOR_INTEL
comma
dot
id|family
op_assign
l_int|4
comma
dot
id|model_names
op_assign
(brace
(braket
l_int|0
)braket
op_assign
l_string|&quot;486 DX-25/33&quot;
comma
(braket
l_int|1
)braket
op_assign
l_string|&quot;486 DX-50&quot;
comma
(braket
l_int|2
)braket
op_assign
l_string|&quot;486 SX&quot;
comma
(braket
l_int|3
)braket
op_assign
l_string|&quot;486 DX/2&quot;
comma
(braket
l_int|4
)braket
op_assign
l_string|&quot;486 SL&quot;
comma
(braket
l_int|5
)braket
op_assign
l_string|&quot;486 SX/2&quot;
comma
(braket
l_int|7
)braket
op_assign
l_string|&quot;486 DX/2-WB&quot;
comma
(braket
l_int|8
)braket
op_assign
l_string|&quot;486 DX/4&quot;
comma
(braket
l_int|9
)braket
op_assign
l_string|&quot;486 DX/4-WB&quot;
)brace
)brace
comma
(brace
dot
id|vendor
op_assign
id|X86_VENDOR_INTEL
comma
dot
id|family
op_assign
l_int|5
comma
dot
id|model_names
op_assign
(brace
(braket
l_int|0
)braket
op_assign
l_string|&quot;Pentium 60/66 A-step&quot;
comma
(braket
l_int|1
)braket
op_assign
l_string|&quot;Pentium 60/66&quot;
comma
(braket
l_int|2
)braket
op_assign
l_string|&quot;Pentium 75 - 200&quot;
comma
(braket
l_int|3
)braket
op_assign
l_string|&quot;OverDrive PODP5V83&quot;
comma
(braket
l_int|4
)braket
op_assign
l_string|&quot;Pentium MMX&quot;
comma
(braket
l_int|7
)braket
op_assign
l_string|&quot;Mobile Pentium 75 - 200&quot;
comma
(braket
l_int|8
)braket
op_assign
l_string|&quot;Mobile Pentium MMX&quot;
)brace
)brace
comma
(brace
dot
id|vendor
op_assign
id|X86_VENDOR_INTEL
comma
dot
id|family
op_assign
l_int|6
comma
dot
id|model_names
op_assign
(brace
(braket
l_int|0
)braket
op_assign
l_string|&quot;Pentium Pro A-step&quot;
comma
(braket
l_int|1
)braket
op_assign
l_string|&quot;Pentium Pro&quot;
comma
(braket
l_int|3
)braket
op_assign
l_string|&quot;Pentium II (Klamath)&quot;
comma
(braket
l_int|4
)braket
op_assign
l_string|&quot;Pentium II (Deschutes)&quot;
comma
(braket
l_int|5
)braket
op_assign
l_string|&quot;Pentium II (Deschutes)&quot;
comma
(braket
l_int|6
)braket
op_assign
l_string|&quot;Mobile Pentium II&quot;
comma
(braket
l_int|7
)braket
op_assign
l_string|&quot;Pentium III (Katmai)&quot;
comma
(braket
l_int|8
)braket
op_assign
l_string|&quot;Pentium III (Coppermine)&quot;
comma
(braket
l_int|10
)braket
op_assign
l_string|&quot;Pentium III (Cascades)&quot;
comma
(braket
l_int|11
)braket
op_assign
l_string|&quot;Pentium III (Tualatin)&quot;
comma
)brace
)brace
comma
(brace
dot
id|vendor
op_assign
id|X86_VENDOR_INTEL
comma
dot
id|family
op_assign
l_int|15
comma
dot
id|model_names
op_assign
(brace
(braket
l_int|0
)braket
op_assign
l_string|&quot;Pentium 4 (Unknown)&quot;
comma
(braket
l_int|1
)braket
op_assign
l_string|&quot;Pentium 4 (Willamette)&quot;
comma
(braket
l_int|2
)braket
op_assign
l_string|&quot;Pentium 4 (Northwood)&quot;
comma
(braket
l_int|4
)braket
op_assign
l_string|&quot;Pentium 4 (Foster)&quot;
comma
(braket
l_int|5
)braket
op_assign
l_string|&quot;Pentium 4 (Foster)&quot;
comma
)brace
)brace
comma
)brace
comma
dot
id|c_init
op_assign
id|init_intel
comma
dot
id|c_identify
op_assign
id|generic_identify
comma
dot
id|c_size_cache
op_assign
id|intel_size_cache
comma
)brace
suffix:semicolon
DECL|function|intel_cpu_init
id|__init
r_int
id|intel_cpu_init
c_func
(paren
r_void
)paren
(brace
id|cpu_devs
(braket
id|X86_VENDOR_INTEL
)braket
op_assign
op_amp
id|intel_cpu_dev
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
singleline_comment|// arch_initcall(intel_cpu_init);
eof
