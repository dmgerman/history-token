multiline_comment|/*&n; * iomap.c - Implement iomap interface for PA-RISC&n; * Copyright (c) 2004 Matthew Wilcox&n; */
macro_line|#include &lt;linux/ioport.h&gt;
macro_line|#include &lt;linux/pci.h&gt;
macro_line|#include &lt;asm/io.h&gt;
multiline_comment|/*&n; * The iomap space on 32-bit PA-RISC is intended to look like this:&n; * 00000000-7fffffff virtual mapped IO&n; * 80000000-8fffffff ISA/EISA port space that can&squot;t be virtually mapped&n; * 90000000-9fffffff Dino port space&n; * a0000000-afffffff Astro port space&n; * b0000000-bfffffff PAT port space&n; * c0000000-cfffffff non-swapped memory IO&n; * f0000000-ffffffff legacy IO memory pointers&n; *&n; * For the moment, here&squot;s what it looks like:&n; * 80000000-8fffffff All ISA/EISA port space&n; * f0000000-ffffffff legacy IO memory pointers&n; *&n; * On 64-bit, everything is extended, so:&n; * 8000000000000000-8fffffffffffffff All ISA/EISA port space&n; * f000000000000000-ffffffffffffffff legacy IO memory pointers&n; */
multiline_comment|/*&n; * Technically, this should be &squot;if (VMALLOC_START &lt; addr &lt; VMALLOC_END),&n; * but that&squot;s slow and we know it&squot;ll be within the first 2GB.&n; */
macro_line|#ifdef CONFIG_64BIT
DECL|macro|INDIRECT_ADDR
mdefine_line|#define INDIRECT_ADDR(addr)&t;(((unsigned long)(addr) &amp; 1UL&lt;&lt;63) != 0)
DECL|macro|ADDR_TO_REGION
mdefine_line|#define ADDR_TO_REGION(addr)    (((unsigned long)addr &gt;&gt; 60) &amp; 7)
DECL|macro|IOPORT_MAP_BASE
mdefine_line|#define IOPORT_MAP_BASE&t;&t;(8UL &lt;&lt; 60)
macro_line|#else
DECL|macro|INDIRECT_ADDR
mdefine_line|#define INDIRECT_ADDR(addr)     (((unsigned long)(addr) &amp; 1UL&lt;&lt;31) != 0)
DECL|macro|ADDR_TO_REGION
mdefine_line|#define ADDR_TO_REGION(addr)    (((unsigned long)addr &gt;&gt; 28) &amp; 7)
DECL|macro|IOPORT_MAP_BASE
mdefine_line|#define IOPORT_MAP_BASE&t;&t;(8UL &lt;&lt; 28)
macro_line|#endif
DECL|struct|iomap_ops
r_struct
id|iomap_ops
(brace
DECL|member|read8
r_int
r_int
(paren
op_star
id|read8
)paren
(paren
r_void
id|__iomem
op_star
)paren
suffix:semicolon
DECL|member|read16
r_int
r_int
(paren
op_star
id|read16
)paren
(paren
r_void
id|__iomem
op_star
)paren
suffix:semicolon
DECL|member|read32
r_int
r_int
(paren
op_star
id|read32
)paren
(paren
r_void
id|__iomem
op_star
)paren
suffix:semicolon
DECL|member|write8
r_void
(paren
op_star
id|write8
)paren
(paren
id|u8
comma
r_void
id|__iomem
op_star
)paren
suffix:semicolon
DECL|member|write16
r_void
(paren
op_star
id|write16
)paren
(paren
id|u16
comma
r_void
id|__iomem
op_star
)paren
suffix:semicolon
DECL|member|write32
r_void
(paren
op_star
id|write32
)paren
(paren
id|u32
comma
r_void
id|__iomem
op_star
)paren
suffix:semicolon
DECL|member|read8r
r_void
(paren
op_star
id|read8r
)paren
(paren
r_void
id|__iomem
op_star
comma
r_void
op_star
comma
r_int
r_int
)paren
suffix:semicolon
DECL|member|read16r
r_void
(paren
op_star
id|read16r
)paren
(paren
r_void
id|__iomem
op_star
comma
r_void
op_star
comma
r_int
r_int
)paren
suffix:semicolon
DECL|member|read32r
r_void
(paren
op_star
id|read32r
)paren
(paren
r_void
id|__iomem
op_star
comma
r_void
op_star
comma
r_int
r_int
)paren
suffix:semicolon
DECL|member|write8r
r_void
(paren
op_star
id|write8r
)paren
(paren
r_void
id|__iomem
op_star
comma
r_const
r_void
op_star
comma
r_int
r_int
)paren
suffix:semicolon
DECL|member|write16r
r_void
(paren
op_star
id|write16r
)paren
(paren
r_void
id|__iomem
op_star
comma
r_const
r_void
op_star
comma
r_int
r_int
)paren
suffix:semicolon
DECL|member|write32r
r_void
(paren
op_star
id|write32r
)paren
(paren
r_void
id|__iomem
op_star
comma
r_const
r_void
op_star
comma
r_int
r_int
)paren
suffix:semicolon
)brace
suffix:semicolon
multiline_comment|/* Generic ioport ops.  To be replaced later by specific dino/elroy/wax code */
DECL|macro|ADDR2PORT
mdefine_line|#define ADDR2PORT(addr) ((unsigned long __force)(addr) &amp; 0xffffff)
DECL|function|ioport_read8
r_static
r_int
r_int
id|ioport_read8
c_func
(paren
r_void
id|__iomem
op_star
id|addr
)paren
(brace
r_return
id|inb
c_func
(paren
id|ADDR2PORT
c_func
(paren
id|addr
)paren
)paren
suffix:semicolon
)brace
DECL|function|ioport_read16
r_static
r_int
r_int
id|ioport_read16
c_func
(paren
r_void
id|__iomem
op_star
id|addr
)paren
(brace
r_return
id|inw
c_func
(paren
id|ADDR2PORT
c_func
(paren
id|addr
)paren
)paren
suffix:semicolon
)brace
DECL|function|ioport_read32
r_static
r_int
r_int
id|ioport_read32
c_func
(paren
r_void
id|__iomem
op_star
id|addr
)paren
(brace
r_return
id|inl
c_func
(paren
id|ADDR2PORT
c_func
(paren
id|addr
)paren
)paren
suffix:semicolon
)brace
DECL|function|ioport_write8
r_static
r_void
id|ioport_write8
c_func
(paren
id|u8
id|datum
comma
r_void
id|__iomem
op_star
id|addr
)paren
(brace
id|outb
c_func
(paren
id|datum
comma
id|ADDR2PORT
c_func
(paren
id|addr
)paren
)paren
suffix:semicolon
)brace
DECL|function|ioport_write16
r_static
r_void
id|ioport_write16
c_func
(paren
id|u16
id|datum
comma
r_void
id|__iomem
op_star
id|addr
)paren
(brace
id|outw
c_func
(paren
id|datum
comma
id|ADDR2PORT
c_func
(paren
id|addr
)paren
)paren
suffix:semicolon
)brace
DECL|function|ioport_write32
r_static
r_void
id|ioport_write32
c_func
(paren
id|u32
id|datum
comma
r_void
id|__iomem
op_star
id|addr
)paren
(brace
id|outl
c_func
(paren
id|datum
comma
id|ADDR2PORT
c_func
(paren
id|addr
)paren
)paren
suffix:semicolon
)brace
DECL|function|ioport_read8r
r_static
r_void
id|ioport_read8r
c_func
(paren
r_void
id|__iomem
op_star
id|addr
comma
r_void
op_star
id|dst
comma
r_int
r_int
id|count
)paren
(brace
id|insb
c_func
(paren
id|ADDR2PORT
c_func
(paren
id|addr
)paren
comma
id|dst
comma
id|count
)paren
suffix:semicolon
)brace
DECL|function|ioport_read16r
r_static
r_void
id|ioport_read16r
c_func
(paren
r_void
id|__iomem
op_star
id|addr
comma
r_void
op_star
id|dst
comma
r_int
r_int
id|count
)paren
(brace
id|insw
c_func
(paren
id|ADDR2PORT
c_func
(paren
id|addr
)paren
comma
id|dst
comma
id|count
)paren
suffix:semicolon
)brace
DECL|function|ioport_read32r
r_static
r_void
id|ioport_read32r
c_func
(paren
r_void
id|__iomem
op_star
id|addr
comma
r_void
op_star
id|dst
comma
r_int
r_int
id|count
)paren
(brace
id|insl
c_func
(paren
id|ADDR2PORT
c_func
(paren
id|addr
)paren
comma
id|dst
comma
id|count
)paren
suffix:semicolon
)brace
DECL|function|ioport_write8r
r_static
r_void
id|ioport_write8r
c_func
(paren
r_void
id|__iomem
op_star
id|addr
comma
r_const
r_void
op_star
id|s
comma
r_int
r_int
id|n
)paren
(brace
id|outsb
c_func
(paren
id|ADDR2PORT
c_func
(paren
id|addr
)paren
comma
id|s
comma
id|n
)paren
suffix:semicolon
)brace
DECL|function|ioport_write16r
r_static
r_void
id|ioport_write16r
c_func
(paren
r_void
id|__iomem
op_star
id|addr
comma
r_const
r_void
op_star
id|s
comma
r_int
r_int
id|n
)paren
(brace
id|outsw
c_func
(paren
id|ADDR2PORT
c_func
(paren
id|addr
)paren
comma
id|s
comma
id|n
)paren
suffix:semicolon
)brace
DECL|function|ioport_write32r
r_static
r_void
id|ioport_write32r
c_func
(paren
r_void
id|__iomem
op_star
id|addr
comma
r_const
r_void
op_star
id|s
comma
r_int
r_int
id|n
)paren
(brace
id|outsl
c_func
(paren
id|ADDR2PORT
c_func
(paren
id|addr
)paren
comma
id|s
comma
id|n
)paren
suffix:semicolon
)brace
DECL|variable|ioport_ops
r_static
r_const
r_struct
id|iomap_ops
id|ioport_ops
op_assign
(brace
id|ioport_read8
comma
id|ioport_read16
comma
id|ioport_read32
comma
id|ioport_write8
comma
id|ioport_write16
comma
id|ioport_write32
comma
id|ioport_read8r
comma
id|ioport_read16r
comma
id|ioport_read32r
comma
id|ioport_write8r
comma
id|ioport_write16r
comma
id|ioport_write32r
comma
)brace
suffix:semicolon
multiline_comment|/* Legacy I/O memory ops */
DECL|function|iomem_read8
r_static
r_int
r_int
id|iomem_read8
c_func
(paren
r_void
id|__iomem
op_star
id|addr
)paren
(brace
r_return
id|readb
c_func
(paren
id|addr
)paren
suffix:semicolon
)brace
DECL|function|iomem_read16
r_static
r_int
r_int
id|iomem_read16
c_func
(paren
r_void
id|__iomem
op_star
id|addr
)paren
(brace
r_return
id|readw
c_func
(paren
id|addr
)paren
suffix:semicolon
)brace
DECL|function|iomem_read32
r_static
r_int
r_int
id|iomem_read32
c_func
(paren
r_void
id|__iomem
op_star
id|addr
)paren
(brace
r_return
id|readl
c_func
(paren
id|addr
)paren
suffix:semicolon
)brace
DECL|function|iomem_write8
r_static
r_void
id|iomem_write8
c_func
(paren
id|u8
id|datum
comma
r_void
id|__iomem
op_star
id|addr
)paren
(brace
id|writeb
c_func
(paren
id|datum
comma
id|addr
)paren
suffix:semicolon
)brace
DECL|function|iomem_write16
r_static
r_void
id|iomem_write16
c_func
(paren
id|u16
id|datum
comma
r_void
id|__iomem
op_star
id|addr
)paren
(brace
id|writew
c_func
(paren
id|datum
comma
id|addr
)paren
suffix:semicolon
)brace
DECL|function|iomem_write32
r_static
r_void
id|iomem_write32
c_func
(paren
id|u32
id|datum
comma
r_void
id|__iomem
op_star
id|addr
)paren
(brace
id|writel
c_func
(paren
id|datum
comma
id|addr
)paren
suffix:semicolon
)brace
DECL|function|iomem_read8r
r_static
r_void
id|iomem_read8r
c_func
(paren
r_void
id|__iomem
op_star
id|addr
comma
r_void
op_star
id|dst
comma
r_int
r_int
id|count
)paren
(brace
r_while
c_loop
(paren
id|count
op_decrement
)paren
(brace
op_star
(paren
id|u8
op_star
)paren
id|dst
op_assign
id|__raw_readb
c_func
(paren
id|addr
)paren
suffix:semicolon
id|dst
op_increment
suffix:semicolon
)brace
)brace
DECL|function|iomem_read16r
r_static
r_void
id|iomem_read16r
c_func
(paren
r_void
id|__iomem
op_star
id|addr
comma
r_void
op_star
id|dst
comma
r_int
r_int
id|count
)paren
(brace
r_while
c_loop
(paren
id|count
op_decrement
)paren
(brace
op_star
(paren
id|u16
op_star
)paren
id|dst
op_assign
id|__raw_readw
c_func
(paren
id|addr
)paren
suffix:semicolon
id|dst
op_add_assign
l_int|2
suffix:semicolon
)brace
)brace
DECL|function|iomem_read32r
r_static
r_void
id|iomem_read32r
c_func
(paren
r_void
id|__iomem
op_star
id|addr
comma
r_void
op_star
id|dst
comma
r_int
r_int
id|count
)paren
(brace
r_while
c_loop
(paren
id|count
op_decrement
)paren
(brace
op_star
(paren
id|u32
op_star
)paren
id|dst
op_assign
id|__raw_readl
c_func
(paren
id|addr
)paren
suffix:semicolon
id|dst
op_add_assign
l_int|4
suffix:semicolon
)brace
)brace
DECL|function|iomem_write8r
r_static
r_void
id|iomem_write8r
c_func
(paren
r_void
id|__iomem
op_star
id|addr
comma
r_const
r_void
op_star
id|s
comma
r_int
r_int
id|n
)paren
(brace
r_while
c_loop
(paren
id|n
op_decrement
)paren
(brace
id|__raw_writeb
c_func
(paren
op_star
(paren
id|u8
op_star
)paren
id|s
comma
id|addr
)paren
suffix:semicolon
id|s
op_increment
suffix:semicolon
)brace
)brace
DECL|function|iomem_write16r
r_static
r_void
id|iomem_write16r
c_func
(paren
r_void
id|__iomem
op_star
id|addr
comma
r_const
r_void
op_star
id|s
comma
r_int
r_int
id|n
)paren
(brace
r_while
c_loop
(paren
id|n
op_decrement
)paren
(brace
id|__raw_writew
c_func
(paren
op_star
(paren
id|u16
op_star
)paren
id|s
comma
id|addr
)paren
suffix:semicolon
id|s
op_add_assign
l_int|2
suffix:semicolon
)brace
)brace
DECL|function|iomem_write32r
r_static
r_void
id|iomem_write32r
c_func
(paren
r_void
id|__iomem
op_star
id|addr
comma
r_const
r_void
op_star
id|s
comma
r_int
r_int
id|n
)paren
(brace
r_while
c_loop
(paren
id|n
op_decrement
)paren
(brace
id|__raw_writel
c_func
(paren
op_star
(paren
id|u32
op_star
)paren
id|s
comma
id|addr
)paren
suffix:semicolon
id|s
op_add_assign
l_int|4
suffix:semicolon
)brace
)brace
DECL|variable|iomem_ops
r_static
r_const
r_struct
id|iomap_ops
id|iomem_ops
op_assign
(brace
id|iomem_read8
comma
id|iomem_read16
comma
id|iomem_read32
comma
id|iomem_write8
comma
id|iomem_write16
comma
id|iomem_write32
comma
id|iomem_read8r
comma
id|iomem_read16r
comma
id|iomem_read32r
comma
id|iomem_write8r
comma
id|iomem_write16r
comma
id|iomem_write32r
comma
)brace
suffix:semicolon
DECL|variable|iomap_ops
r_const
r_struct
id|iomap_ops
op_star
id|iomap_ops
(braket
l_int|8
)braket
op_assign
(brace
(braket
l_int|0
)braket
op_assign
op_amp
id|ioport_ops
comma
macro_line|#ifdef CONFIG_DEBUG_IOREMAP
(braket
l_int|6
)braket
op_assign
op_amp
id|iomem_ops
comma
macro_line|#else
(braket
l_int|7
)braket
op_assign
op_amp
id|iomem_ops
macro_line|#endif
)brace
suffix:semicolon
DECL|function|ioread8
r_int
r_int
id|ioread8
c_func
(paren
r_void
id|__iomem
op_star
id|addr
)paren
(brace
r_if
c_cond
(paren
id|unlikely
c_func
(paren
id|INDIRECT_ADDR
c_func
(paren
id|addr
)paren
)paren
)paren
r_return
id|iomap_ops
(braket
id|ADDR_TO_REGION
c_func
(paren
id|addr
)paren
)braket
op_member_access_from_pointer
id|read8
c_func
(paren
id|addr
)paren
suffix:semicolon
r_return
op_star
(paren
(paren
id|u8
op_star
)paren
id|addr
)paren
suffix:semicolon
)brace
DECL|function|ioread16
r_int
r_int
id|ioread16
c_func
(paren
r_void
id|__iomem
op_star
id|addr
)paren
(brace
r_if
c_cond
(paren
id|unlikely
c_func
(paren
id|INDIRECT_ADDR
c_func
(paren
id|addr
)paren
)paren
)paren
r_return
id|iomap_ops
(braket
id|ADDR_TO_REGION
c_func
(paren
id|addr
)paren
)braket
op_member_access_from_pointer
id|read16
c_func
(paren
id|addr
)paren
suffix:semicolon
r_return
id|le16_to_cpup
c_func
(paren
(paren
id|u16
op_star
)paren
id|addr
)paren
suffix:semicolon
)brace
DECL|function|ioread32
r_int
r_int
id|ioread32
c_func
(paren
r_void
id|__iomem
op_star
id|addr
)paren
(brace
r_if
c_cond
(paren
id|unlikely
c_func
(paren
id|INDIRECT_ADDR
c_func
(paren
id|addr
)paren
)paren
)paren
r_return
id|iomap_ops
(braket
id|ADDR_TO_REGION
c_func
(paren
id|addr
)paren
)braket
op_member_access_from_pointer
id|read32
c_func
(paren
id|addr
)paren
suffix:semicolon
r_return
id|le32_to_cpup
c_func
(paren
(paren
id|u32
op_star
)paren
id|addr
)paren
suffix:semicolon
)brace
DECL|function|iowrite8
r_void
id|iowrite8
c_func
(paren
id|u8
id|datum
comma
r_void
id|__iomem
op_star
id|addr
)paren
(brace
r_if
c_cond
(paren
id|unlikely
c_func
(paren
id|INDIRECT_ADDR
c_func
(paren
id|addr
)paren
)paren
)paren
(brace
id|iomap_ops
(braket
id|ADDR_TO_REGION
c_func
(paren
id|addr
)paren
)braket
op_member_access_from_pointer
id|write8
c_func
(paren
id|datum
comma
id|addr
)paren
suffix:semicolon
)brace
r_else
(brace
op_star
(paren
(paren
id|u8
op_star
)paren
id|addr
)paren
op_assign
id|datum
suffix:semicolon
)brace
)brace
DECL|function|iowrite16
r_void
id|iowrite16
c_func
(paren
id|u16
id|datum
comma
r_void
id|__iomem
op_star
id|addr
)paren
(brace
r_if
c_cond
(paren
id|unlikely
c_func
(paren
id|INDIRECT_ADDR
c_func
(paren
id|addr
)paren
)paren
)paren
(brace
id|iomap_ops
(braket
id|ADDR_TO_REGION
c_func
(paren
id|addr
)paren
)braket
op_member_access_from_pointer
id|write16
c_func
(paren
id|datum
comma
id|addr
)paren
suffix:semicolon
)brace
r_else
(brace
op_star
(paren
(paren
id|u16
op_star
)paren
id|addr
)paren
op_assign
id|cpu_to_le16
c_func
(paren
id|datum
)paren
suffix:semicolon
)brace
)brace
DECL|function|iowrite32
r_void
id|iowrite32
c_func
(paren
id|u32
id|datum
comma
r_void
id|__iomem
op_star
id|addr
)paren
(brace
r_if
c_cond
(paren
id|unlikely
c_func
(paren
id|INDIRECT_ADDR
c_func
(paren
id|addr
)paren
)paren
)paren
(brace
id|iomap_ops
(braket
id|ADDR_TO_REGION
c_func
(paren
id|addr
)paren
)braket
op_member_access_from_pointer
id|write32
c_func
(paren
id|datum
comma
id|addr
)paren
suffix:semicolon
)brace
r_else
(brace
op_star
(paren
(paren
id|u32
op_star
)paren
id|addr
)paren
op_assign
id|cpu_to_le32
c_func
(paren
id|datum
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/* Repeating interfaces */
DECL|function|ioread8_rep
r_void
id|ioread8_rep
c_func
(paren
r_void
id|__iomem
op_star
id|addr
comma
r_void
op_star
id|dst
comma
r_int
r_int
id|count
)paren
(brace
r_if
c_cond
(paren
id|unlikely
c_func
(paren
id|INDIRECT_ADDR
c_func
(paren
id|addr
)paren
)paren
)paren
(brace
id|iomap_ops
(braket
id|ADDR_TO_REGION
c_func
(paren
id|addr
)paren
)braket
op_member_access_from_pointer
id|read8r
c_func
(paren
id|addr
comma
id|dst
comma
id|count
)paren
suffix:semicolon
)brace
r_else
(brace
r_while
c_loop
(paren
id|count
op_decrement
)paren
(brace
op_star
(paren
id|u8
op_star
)paren
id|dst
op_assign
op_star
(paren
id|u8
op_star
)paren
id|addr
suffix:semicolon
id|dst
op_increment
suffix:semicolon
)brace
)brace
)brace
DECL|function|ioread16_rep
r_void
id|ioread16_rep
c_func
(paren
r_void
id|__iomem
op_star
id|addr
comma
r_void
op_star
id|dst
comma
r_int
r_int
id|count
)paren
(brace
r_if
c_cond
(paren
id|unlikely
c_func
(paren
id|INDIRECT_ADDR
c_func
(paren
id|addr
)paren
)paren
)paren
(brace
id|iomap_ops
(braket
id|ADDR_TO_REGION
c_func
(paren
id|addr
)paren
)braket
op_member_access_from_pointer
id|read16r
c_func
(paren
id|addr
comma
id|dst
comma
id|count
)paren
suffix:semicolon
)brace
r_else
(brace
r_while
c_loop
(paren
id|count
op_decrement
)paren
(brace
op_star
(paren
id|u16
op_star
)paren
id|dst
op_assign
op_star
(paren
id|u16
op_star
)paren
id|addr
suffix:semicolon
id|dst
op_add_assign
l_int|2
suffix:semicolon
)brace
)brace
)brace
DECL|function|ioread32_rep
r_void
id|ioread32_rep
c_func
(paren
r_void
id|__iomem
op_star
id|addr
comma
r_void
op_star
id|dst
comma
r_int
r_int
id|count
)paren
(brace
r_if
c_cond
(paren
id|unlikely
c_func
(paren
id|INDIRECT_ADDR
c_func
(paren
id|addr
)paren
)paren
)paren
(brace
id|iomap_ops
(braket
id|ADDR_TO_REGION
c_func
(paren
id|addr
)paren
)braket
op_member_access_from_pointer
id|read32r
c_func
(paren
id|addr
comma
id|dst
comma
id|count
)paren
suffix:semicolon
)brace
r_else
(brace
r_while
c_loop
(paren
id|count
op_decrement
)paren
(brace
op_star
(paren
id|u32
op_star
)paren
id|dst
op_assign
op_star
(paren
id|u32
op_star
)paren
id|addr
suffix:semicolon
id|dst
op_add_assign
l_int|4
suffix:semicolon
)brace
)brace
)brace
DECL|function|iowrite8_rep
r_void
id|iowrite8_rep
c_func
(paren
r_void
id|__iomem
op_star
id|addr
comma
r_const
r_void
op_star
id|src
comma
r_int
r_int
id|count
)paren
(brace
r_if
c_cond
(paren
id|unlikely
c_func
(paren
id|INDIRECT_ADDR
c_func
(paren
id|addr
)paren
)paren
)paren
(brace
id|iomap_ops
(braket
id|ADDR_TO_REGION
c_func
(paren
id|addr
)paren
)braket
op_member_access_from_pointer
id|write8r
c_func
(paren
id|addr
comma
id|src
comma
id|count
)paren
suffix:semicolon
)brace
r_else
(brace
r_while
c_loop
(paren
id|count
op_decrement
)paren
(brace
op_star
(paren
id|u8
op_star
)paren
id|addr
op_assign
op_star
(paren
id|u8
op_star
)paren
id|src
suffix:semicolon
id|src
op_increment
suffix:semicolon
)brace
)brace
)brace
DECL|function|iowrite16_rep
r_void
id|iowrite16_rep
c_func
(paren
r_void
id|__iomem
op_star
id|addr
comma
r_const
r_void
op_star
id|src
comma
r_int
r_int
id|count
)paren
(brace
r_if
c_cond
(paren
id|unlikely
c_func
(paren
id|INDIRECT_ADDR
c_func
(paren
id|addr
)paren
)paren
)paren
(brace
id|iomap_ops
(braket
id|ADDR_TO_REGION
c_func
(paren
id|addr
)paren
)braket
op_member_access_from_pointer
id|write16r
c_func
(paren
id|addr
comma
id|src
comma
id|count
)paren
suffix:semicolon
)brace
r_else
(brace
r_while
c_loop
(paren
id|count
op_decrement
)paren
(brace
op_star
(paren
id|u16
op_star
)paren
id|addr
op_assign
op_star
(paren
id|u16
op_star
)paren
id|src
suffix:semicolon
id|src
op_add_assign
l_int|2
suffix:semicolon
)brace
)brace
)brace
DECL|function|iowrite32_rep
r_void
id|iowrite32_rep
c_func
(paren
r_void
id|__iomem
op_star
id|addr
comma
r_const
r_void
op_star
id|src
comma
r_int
r_int
id|count
)paren
(brace
r_if
c_cond
(paren
id|unlikely
c_func
(paren
id|INDIRECT_ADDR
c_func
(paren
id|addr
)paren
)paren
)paren
(brace
id|iomap_ops
(braket
id|ADDR_TO_REGION
c_func
(paren
id|addr
)paren
)braket
op_member_access_from_pointer
id|write32r
c_func
(paren
id|addr
comma
id|src
comma
id|count
)paren
suffix:semicolon
)brace
r_else
(brace
r_while
c_loop
(paren
id|count
op_decrement
)paren
(brace
op_star
(paren
id|u32
op_star
)paren
id|addr
op_assign
op_star
(paren
id|u32
op_star
)paren
id|src
suffix:semicolon
id|src
op_add_assign
l_int|4
suffix:semicolon
)brace
)brace
)brace
multiline_comment|/* Mapping interfaces */
DECL|function|ioport_map
r_void
id|__iomem
op_star
id|ioport_map
c_func
(paren
r_int
r_int
id|port
comma
r_int
r_int
id|nr
)paren
(brace
r_return
(paren
r_void
id|__iomem
op_star
)paren
(paren
id|IOPORT_MAP_BASE
op_or
id|port
)paren
suffix:semicolon
)brace
DECL|function|ioport_unmap
r_void
id|ioport_unmap
c_func
(paren
r_void
id|__iomem
op_star
id|addr
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|INDIRECT_ADDR
c_func
(paren
id|addr
)paren
)paren
(brace
id|iounmap
c_func
(paren
id|addr
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/* Create a virtual mapping cookie for a PCI BAR (memory or IO) */
DECL|function|pci_iomap
r_void
id|__iomem
op_star
id|pci_iomap
c_func
(paren
r_struct
id|pci_dev
op_star
id|dev
comma
r_int
id|bar
comma
r_int
r_int
id|maxlen
)paren
(brace
r_int
r_int
id|start
op_assign
id|pci_resource_start
c_func
(paren
id|dev
comma
id|bar
)paren
suffix:semicolon
r_int
r_int
id|len
op_assign
id|pci_resource_len
c_func
(paren
id|dev
comma
id|bar
)paren
suffix:semicolon
r_int
r_int
id|flags
op_assign
id|pci_resource_flags
c_func
(paren
id|dev
comma
id|bar
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|len
op_logical_or
op_logical_neg
id|start
)paren
r_return
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
id|maxlen
op_logical_and
id|len
OG
id|maxlen
)paren
id|len
op_assign
id|maxlen
suffix:semicolon
r_if
c_cond
(paren
id|flags
op_amp
id|IORESOURCE_IO
)paren
r_return
id|ioport_map
c_func
(paren
id|start
comma
id|len
)paren
suffix:semicolon
r_if
c_cond
(paren
id|flags
op_amp
id|IORESOURCE_MEM
)paren
(brace
r_if
c_cond
(paren
id|flags
op_amp
id|IORESOURCE_CACHEABLE
)paren
r_return
id|ioremap
c_func
(paren
id|start
comma
id|len
)paren
suffix:semicolon
r_return
id|ioremap_nocache
c_func
(paren
id|start
comma
id|len
)paren
suffix:semicolon
)brace
multiline_comment|/* What? */
r_return
l_int|NULL
suffix:semicolon
)brace
DECL|function|pci_iounmap
r_void
id|pci_iounmap
c_func
(paren
r_struct
id|pci_dev
op_star
id|dev
comma
r_void
id|__iomem
op_star
id|addr
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|INDIRECT_ADDR
c_func
(paren
id|addr
)paren
)paren
(brace
id|iounmap
c_func
(paren
id|addr
)paren
suffix:semicolon
)brace
)brace
DECL|variable|ioread8
id|EXPORT_SYMBOL
c_func
(paren
id|ioread8
)paren
suffix:semicolon
DECL|variable|ioread16
id|EXPORT_SYMBOL
c_func
(paren
id|ioread16
)paren
suffix:semicolon
DECL|variable|ioread32
id|EXPORT_SYMBOL
c_func
(paren
id|ioread32
)paren
suffix:semicolon
DECL|variable|iowrite8
id|EXPORT_SYMBOL
c_func
(paren
id|iowrite8
)paren
suffix:semicolon
DECL|variable|iowrite16
id|EXPORT_SYMBOL
c_func
(paren
id|iowrite16
)paren
suffix:semicolon
DECL|variable|iowrite32
id|EXPORT_SYMBOL
c_func
(paren
id|iowrite32
)paren
suffix:semicolon
DECL|variable|ioread8_rep
id|EXPORT_SYMBOL
c_func
(paren
id|ioread8_rep
)paren
suffix:semicolon
DECL|variable|ioread16_rep
id|EXPORT_SYMBOL
c_func
(paren
id|ioread16_rep
)paren
suffix:semicolon
DECL|variable|ioread32_rep
id|EXPORT_SYMBOL
c_func
(paren
id|ioread32_rep
)paren
suffix:semicolon
DECL|variable|iowrite8_rep
id|EXPORT_SYMBOL
c_func
(paren
id|iowrite8_rep
)paren
suffix:semicolon
DECL|variable|iowrite16_rep
id|EXPORT_SYMBOL
c_func
(paren
id|iowrite16_rep
)paren
suffix:semicolon
DECL|variable|iowrite32_rep
id|EXPORT_SYMBOL
c_func
(paren
id|iowrite32_rep
)paren
suffix:semicolon
DECL|variable|ioport_map
id|EXPORT_SYMBOL
c_func
(paren
id|ioport_map
)paren
suffix:semicolon
DECL|variable|ioport_unmap
id|EXPORT_SYMBOL
c_func
(paren
id|ioport_unmap
)paren
suffix:semicolon
DECL|variable|pci_iomap
id|EXPORT_SYMBOL
c_func
(paren
id|pci_iomap
)paren
suffix:semicolon
DECL|variable|pci_iounmap
id|EXPORT_SYMBOL
c_func
(paren
id|pci_iounmap
)paren
suffix:semicolon
eof
