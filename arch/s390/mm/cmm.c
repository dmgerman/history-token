multiline_comment|/*&n; *  arch/s390/mm/cmm.c&n; *&n; *  S390 version&n; *    Copyright (C) 2003 IBM Deutschland Entwicklung GmbH, IBM Corporation&n; *    Author(s): Martin Schwidefsky (schwidefsky@de.ibm.com)&n; *&n; *  Collaborative memory management interface.&n; */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/errno.h&gt;
macro_line|#include &lt;linux/fs.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/sysctl.h&gt;
macro_line|#include &lt;linux/ctype.h&gt;
macro_line|#include &lt;asm/pgalloc.h&gt;
macro_line|#include &lt;asm/uaccess.h&gt;
macro_line|#include &lt;asm/smp.h&gt;
macro_line|#include &quot;../../../drivers/s390/net/smsgiucv.h&quot;
DECL|macro|CMM_NR_PAGES
mdefine_line|#define CMM_NR_PAGES ((PAGE_SIZE / sizeof(unsigned long)) - 2)
DECL|struct|cmm_page_array
r_struct
id|cmm_page_array
(brace
DECL|member|next
r_struct
id|cmm_page_array
op_star
id|next
suffix:semicolon
DECL|member|index
r_int
r_int
id|index
suffix:semicolon
DECL|member|pages
r_int
r_int
id|pages
(braket
id|CMM_NR_PAGES
)braket
suffix:semicolon
)brace
suffix:semicolon
DECL|variable|cmm_pages
r_static
r_int
id|cmm_pages
op_assign
l_int|0
suffix:semicolon
DECL|variable|cmm_timed_pages
r_static
r_int
id|cmm_timed_pages
op_assign
l_int|0
suffix:semicolon
DECL|variable|cmm_pages_target
r_static
r_volatile
r_int
id|cmm_pages_target
op_assign
l_int|0
suffix:semicolon
DECL|variable|cmm_timed_pages_target
r_static
r_volatile
r_int
id|cmm_timed_pages_target
op_assign
l_int|0
suffix:semicolon
DECL|variable|cmm_timeout_pages
r_static
r_int
id|cmm_timeout_pages
op_assign
l_int|0
suffix:semicolon
DECL|variable|cmm_timeout_seconds
r_static
r_int
id|cmm_timeout_seconds
op_assign
l_int|0
suffix:semicolon
DECL|variable|cmm_page_list
r_static
r_struct
id|cmm_page_array
op_star
id|cmm_page_list
op_assign
l_int|0
suffix:semicolon
DECL|variable|cmm_timed_page_list
r_static
r_struct
id|cmm_page_array
op_star
id|cmm_timed_page_list
op_assign
l_int|0
suffix:semicolon
DECL|variable|cmm_thread_active
r_static
r_int
r_int
id|cmm_thread_active
op_assign
l_int|0
suffix:semicolon
DECL|variable|cmm_thread_starter
r_static
r_struct
id|work_struct
id|cmm_thread_starter
suffix:semicolon
DECL|variable|cmm_thread_wait
r_static
id|wait_queue_head_t
id|cmm_thread_wait
suffix:semicolon
DECL|variable|cmm_timer
r_static
r_struct
id|timer_list
id|cmm_timer
suffix:semicolon
r_static
r_void
id|cmm_timer_fn
c_func
(paren
r_int
r_int
)paren
suffix:semicolon
r_static
r_void
id|cmm_set_timer
c_func
(paren
r_void
)paren
suffix:semicolon
r_static
r_int
DECL|function|cmm_strtoul
id|cmm_strtoul
c_func
(paren
r_const
r_char
op_star
id|cp
comma
r_char
op_star
op_star
id|endp
)paren
(brace
r_int
r_int
id|base
op_assign
l_int|10
suffix:semicolon
r_if
c_cond
(paren
op_star
id|cp
op_eq
l_char|&squot;0&squot;
)paren
(brace
id|base
op_assign
l_int|8
suffix:semicolon
id|cp
op_increment
suffix:semicolon
r_if
c_cond
(paren
(paren
op_star
id|cp
op_eq
l_char|&squot;x&squot;
op_logical_or
op_star
id|cp
op_eq
l_char|&squot;X&squot;
)paren
op_logical_and
id|isxdigit
c_func
(paren
id|cp
(braket
l_int|1
)braket
)paren
)paren
(brace
id|base
op_assign
l_int|16
suffix:semicolon
id|cp
op_increment
suffix:semicolon
)brace
)brace
r_return
id|simple_strtoul
c_func
(paren
id|cp
comma
id|endp
comma
id|base
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|cmm_alloc_pages
id|cmm_alloc_pages
c_func
(paren
r_int
id|pages
comma
r_int
op_star
id|counter
comma
r_struct
id|cmm_page_array
op_star
op_star
id|list
)paren
(brace
r_struct
id|cmm_page_array
op_star
id|pa
suffix:semicolon
r_int
r_int
id|page
suffix:semicolon
id|pa
op_assign
op_star
id|list
suffix:semicolon
r_while
c_loop
(paren
id|pages
)paren
(brace
id|page
op_assign
id|__get_free_page
c_func
(paren
id|GFP_NOIO
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|page
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|pa
op_logical_or
id|pa-&gt;index
op_ge
id|CMM_NR_PAGES
)paren
(brace
multiline_comment|/* Need a new page for the page list. */
id|pa
op_assign
(paren
r_struct
id|cmm_page_array
op_star
)paren
id|__get_free_page
c_func
(paren
id|GFP_NOIO
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|pa
)paren
(brace
id|free_page
c_func
(paren
id|page
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|pa-&gt;next
op_assign
op_star
id|list
suffix:semicolon
id|pa-&gt;index
op_assign
l_int|0
suffix:semicolon
op_star
id|list
op_assign
id|pa
suffix:semicolon
)brace
id|diag10
c_func
(paren
id|page
)paren
suffix:semicolon
id|pa-&gt;pages
(braket
id|pa-&gt;index
op_increment
)braket
op_assign
id|page
suffix:semicolon
(paren
op_star
id|counter
)paren
op_increment
suffix:semicolon
id|pages
op_decrement
suffix:semicolon
)brace
r_return
id|pages
suffix:semicolon
)brace
r_static
r_void
DECL|function|cmm_free_pages
id|cmm_free_pages
c_func
(paren
r_int
id|pages
comma
r_int
op_star
id|counter
comma
r_struct
id|cmm_page_array
op_star
op_star
id|list
)paren
(brace
r_struct
id|cmm_page_array
op_star
id|pa
suffix:semicolon
r_int
r_int
id|page
suffix:semicolon
id|pa
op_assign
op_star
id|list
suffix:semicolon
r_while
c_loop
(paren
id|pages
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|pa
op_logical_or
id|pa-&gt;index
op_le
l_int|0
)paren
r_break
suffix:semicolon
id|page
op_assign
id|pa-&gt;pages
(braket
op_decrement
id|pa-&gt;index
)braket
suffix:semicolon
r_if
c_cond
(paren
id|pa-&gt;index
op_eq
l_int|0
)paren
(brace
id|pa
op_assign
id|pa-&gt;next
suffix:semicolon
id|free_page
c_func
(paren
(paren
r_int
r_int
)paren
op_star
id|list
)paren
suffix:semicolon
op_star
id|list
op_assign
id|pa
suffix:semicolon
)brace
id|free_page
c_func
(paren
id|page
)paren
suffix:semicolon
(paren
op_star
id|counter
)paren
op_decrement
suffix:semicolon
id|pages
op_decrement
suffix:semicolon
)brace
)brace
r_static
r_int
DECL|function|cmm_thread
id|cmm_thread
c_func
(paren
r_void
op_star
id|dummy
)paren
(brace
r_int
id|rc
suffix:semicolon
id|daemonize
c_func
(paren
l_string|&quot;cmmthread&quot;
)paren
suffix:semicolon
r_while
c_loop
(paren
l_int|1
)paren
(brace
id|rc
op_assign
id|wait_event_interruptible
c_func
(paren
id|cmm_thread_wait
comma
(paren
id|cmm_pages
op_ne
id|cmm_pages_target
op_logical_or
id|cmm_timed_pages
op_ne
id|cmm_timed_pages_target
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rc
op_eq
op_minus
id|ERESTARTSYS
)paren
(brace
multiline_comment|/* Got kill signal. End thread. */
id|clear_bit
c_func
(paren
l_int|0
comma
op_amp
id|cmm_thread_active
)paren
suffix:semicolon
id|cmm_pages_target
op_assign
id|cmm_pages
suffix:semicolon
id|cmm_timed_pages_target
op_assign
id|cmm_timed_pages
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|cmm_pages_target
OG
id|cmm_pages
)paren
(brace
r_if
c_cond
(paren
id|cmm_alloc_pages
c_func
(paren
l_int|1
comma
op_amp
id|cmm_pages
comma
op_amp
id|cmm_page_list
)paren
)paren
id|cmm_pages_target
op_assign
id|cmm_pages
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|cmm_pages_target
OL
id|cmm_pages
)paren
(brace
id|cmm_free_pages
c_func
(paren
l_int|1
comma
op_amp
id|cmm_pages
comma
op_amp
id|cmm_page_list
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|cmm_timed_pages_target
OG
id|cmm_timed_pages
)paren
(brace
r_if
c_cond
(paren
id|cmm_alloc_pages
c_func
(paren
l_int|1
comma
op_amp
id|cmm_timed_pages
comma
op_amp
id|cmm_timed_page_list
)paren
)paren
id|cmm_timed_pages_target
op_assign
id|cmm_timed_pages
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|cmm_timed_pages_target
OL
id|cmm_timed_pages
)paren
(brace
id|cmm_free_pages
c_func
(paren
l_int|1
comma
op_amp
id|cmm_timed_pages
comma
op_amp
id|cmm_timed_page_list
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|cmm_timed_pages
OG
l_int|0
op_logical_and
op_logical_neg
id|timer_pending
c_func
(paren
op_amp
id|cmm_timer
)paren
)paren
id|cmm_set_timer
c_func
(paren
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_void
DECL|function|cmm_start_thread
id|cmm_start_thread
c_func
(paren
r_void
)paren
(brace
id|kernel_thread
c_func
(paren
id|cmm_thread
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|cmm_kick_thread
id|cmm_kick_thread
c_func
(paren
r_void
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|test_and_set_bit
c_func
(paren
l_int|0
comma
op_amp
id|cmm_thread_active
)paren
)paren
id|schedule_work
c_func
(paren
op_amp
id|cmm_thread_starter
)paren
suffix:semicolon
id|wake_up
c_func
(paren
op_amp
id|cmm_thread_wait
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|cmm_set_timer
id|cmm_set_timer
c_func
(paren
r_void
)paren
(brace
r_if
c_cond
(paren
id|cmm_timed_pages_target
op_le
l_int|0
op_logical_or
id|cmm_timeout_seconds
op_le
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|timer_pending
c_func
(paren
op_amp
id|cmm_timer
)paren
)paren
id|del_timer
c_func
(paren
op_amp
id|cmm_timer
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|timer_pending
c_func
(paren
op_amp
id|cmm_timer
)paren
)paren
(brace
r_if
c_cond
(paren
id|mod_timer
c_func
(paren
op_amp
id|cmm_timer
comma
id|jiffies
op_plus
id|cmm_timeout_seconds
op_star
id|HZ
)paren
)paren
r_return
suffix:semicolon
)brace
id|cmm_timer.function
op_assign
id|cmm_timer_fn
suffix:semicolon
id|cmm_timer.data
op_assign
l_int|0
suffix:semicolon
id|cmm_timer.expires
op_assign
id|jiffies
op_plus
id|cmm_timeout_seconds
op_star
id|HZ
suffix:semicolon
id|add_timer
c_func
(paren
op_amp
id|cmm_timer
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|cmm_timer_fn
id|cmm_timer_fn
c_func
(paren
r_int
r_int
id|ignored
)paren
(brace
r_int
id|pages
suffix:semicolon
id|pages
op_assign
id|cmm_timed_pages_target
op_minus
id|cmm_timeout_pages
suffix:semicolon
r_if
c_cond
(paren
id|pages
OL
l_int|0
)paren
id|cmm_timed_pages_target
op_assign
l_int|0
suffix:semicolon
r_else
id|cmm_timed_pages_target
op_assign
id|pages
suffix:semicolon
id|cmm_kick_thread
c_func
(paren
)paren
suffix:semicolon
id|cmm_set_timer
c_func
(paren
)paren
suffix:semicolon
)brace
r_void
DECL|function|cmm_set_pages
id|cmm_set_pages
c_func
(paren
r_int
id|pages
)paren
(brace
id|cmm_pages_target
op_assign
id|pages
suffix:semicolon
id|cmm_kick_thread
c_func
(paren
)paren
suffix:semicolon
)brace
r_int
DECL|function|cmm_get_pages
id|cmm_get_pages
c_func
(paren
r_void
)paren
(brace
r_return
id|cmm_pages
suffix:semicolon
)brace
r_void
DECL|function|cmm_add_timed_pages
id|cmm_add_timed_pages
c_func
(paren
r_int
id|pages
)paren
(brace
id|cmm_timed_pages_target
op_add_assign
id|pages
suffix:semicolon
id|cmm_kick_thread
c_func
(paren
)paren
suffix:semicolon
)brace
r_int
DECL|function|cmm_get_timed_pages
id|cmm_get_timed_pages
c_func
(paren
r_void
)paren
(brace
r_return
id|cmm_timed_pages
suffix:semicolon
)brace
r_void
DECL|function|cmm_set_timeout
id|cmm_set_timeout
c_func
(paren
r_int
id|pages
comma
r_int
id|seconds
)paren
(brace
id|cmm_timeout_pages
op_assign
id|pages
suffix:semicolon
id|cmm_timeout_seconds
op_assign
id|seconds
suffix:semicolon
id|cmm_set_timer
c_func
(paren
)paren
suffix:semicolon
)brace
r_static
r_inline
r_int
DECL|function|cmm_skip_blanks
id|cmm_skip_blanks
c_func
(paren
r_char
op_star
id|cp
comma
r_char
op_star
op_star
id|endp
)paren
(brace
r_char
op_star
id|str
suffix:semicolon
r_for
c_loop
(paren
id|str
op_assign
id|cp
suffix:semicolon
op_star
id|str
op_eq
l_char|&squot; &squot;
op_logical_or
op_star
id|str
op_eq
l_char|&squot;&bslash;t&squot;
suffix:semicolon
id|str
op_increment
)paren
suffix:semicolon
op_star
id|endp
op_assign
id|str
suffix:semicolon
r_return
id|str
op_ne
id|cp
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_CMM_PROC
multiline_comment|/* These will someday get removed. */
DECL|macro|VM_CMM_PAGES
mdefine_line|#define VM_CMM_PAGES&t;&t;1111
DECL|macro|VM_CMM_TIMED_PAGES
mdefine_line|#define VM_CMM_TIMED_PAGES&t;1112
DECL|macro|VM_CMM_TIMEOUT
mdefine_line|#define VM_CMM_TIMEOUT&t;&t;1113
DECL|variable|cmm_table
r_static
r_struct
id|ctl_table
id|cmm_table
(braket
)braket
suffix:semicolon
r_static
r_int
DECL|function|cmm_pages_handler
id|cmm_pages_handler
c_func
(paren
id|ctl_table
op_star
id|ctl
comma
r_int
id|write
comma
r_struct
id|file
op_star
id|filp
comma
r_void
op_star
id|buffer
comma
r_int
op_star
id|lenp
comma
id|loff_t
op_star
id|ppos
)paren
(brace
r_char
id|buf
(braket
l_int|16
)braket
comma
op_star
id|p
suffix:semicolon
r_int
id|pages
suffix:semicolon
r_int
id|len
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
op_star
id|lenp
op_logical_or
(paren
op_star
id|ppos
op_logical_and
op_logical_neg
id|write
)paren
)paren
(brace
op_star
id|lenp
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|write
)paren
(brace
id|len
op_assign
op_star
id|lenp
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
id|buf
comma
id|buffer
comma
id|len
OG
r_sizeof
(paren
id|buf
)paren
ques
c_cond
r_sizeof
(paren
id|buf
)paren
suffix:colon
id|len
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|buf
(braket
r_sizeof
(paren
id|buf
)paren
op_minus
l_int|1
)braket
op_assign
l_char|&squot;&bslash;0&squot;
suffix:semicolon
id|cmm_skip_blanks
c_func
(paren
id|buf
comma
op_amp
id|p
)paren
suffix:semicolon
id|pages
op_assign
id|cmm_strtoul
c_func
(paren
id|p
comma
op_amp
id|p
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ctl
op_eq
op_amp
id|cmm_table
(braket
l_int|0
)braket
)paren
id|cmm_set_pages
c_func
(paren
id|pages
)paren
suffix:semicolon
r_else
id|cmm_add_timed_pages
c_func
(paren
id|pages
)paren
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|ctl
op_eq
op_amp
id|cmm_table
(braket
l_int|0
)braket
)paren
id|pages
op_assign
id|cmm_get_pages
c_func
(paren
)paren
suffix:semicolon
r_else
id|pages
op_assign
id|cmm_get_timed_pages
c_func
(paren
)paren
suffix:semicolon
id|len
op_assign
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%ld&bslash;n&quot;
comma
id|pages
)paren
suffix:semicolon
r_if
c_cond
(paren
id|len
OG
op_star
id|lenp
)paren
id|len
op_assign
op_star
id|lenp
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|buffer
comma
id|buf
comma
id|len
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
op_star
id|lenp
op_assign
id|len
suffix:semicolon
op_star
id|ppos
op_add_assign
id|len
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|cmm_timeout_handler
id|cmm_timeout_handler
c_func
(paren
id|ctl_table
op_star
id|ctl
comma
r_int
id|write
comma
r_struct
id|file
op_star
id|filp
comma
r_void
op_star
id|buffer
comma
r_int
op_star
id|lenp
comma
id|loff_t
op_star
id|ppos
)paren
(brace
r_char
id|buf
(braket
l_int|64
)braket
comma
op_star
id|p
suffix:semicolon
r_int
id|pages
comma
id|seconds
suffix:semicolon
r_int
id|len
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
op_star
id|lenp
op_logical_or
(paren
op_star
id|ppos
op_logical_and
op_logical_neg
id|write
)paren
)paren
(brace
op_star
id|lenp
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|write
)paren
(brace
id|len
op_assign
op_star
id|lenp
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
id|buf
comma
id|buffer
comma
id|len
OG
r_sizeof
(paren
id|buf
)paren
ques
c_cond
r_sizeof
(paren
id|buf
)paren
suffix:colon
id|len
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|buf
(braket
r_sizeof
(paren
id|buf
)paren
op_minus
l_int|1
)braket
op_assign
l_char|&squot;&bslash;0&squot;
suffix:semicolon
id|cmm_skip_blanks
c_func
(paren
id|buf
comma
op_amp
id|p
)paren
suffix:semicolon
id|pages
op_assign
id|cmm_strtoul
c_func
(paren
id|p
comma
op_amp
id|p
)paren
suffix:semicolon
id|cmm_skip_blanks
c_func
(paren
id|p
comma
op_amp
id|p
)paren
suffix:semicolon
id|seconds
op_assign
id|cmm_strtoul
c_func
(paren
id|p
comma
op_amp
id|p
)paren
suffix:semicolon
id|cmm_set_timeout
c_func
(paren
id|pages
comma
id|seconds
)paren
suffix:semicolon
)brace
r_else
(brace
id|len
op_assign
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%ld %ld&bslash;n&quot;
comma
id|cmm_timeout_pages
comma
id|cmm_timeout_seconds
)paren
suffix:semicolon
r_if
c_cond
(paren
id|len
OG
op_star
id|lenp
)paren
id|len
op_assign
op_star
id|lenp
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|buffer
comma
id|buf
comma
id|len
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
op_star
id|lenp
op_assign
id|len
suffix:semicolon
op_star
id|ppos
op_add_assign
id|len
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|cmm_table
r_static
r_struct
id|ctl_table
id|cmm_table
(braket
)braket
op_assign
(brace
(brace
dot
id|ctl_name
op_assign
id|VM_CMM_PAGES
comma
dot
id|procname
op_assign
l_string|&quot;cmm_pages&quot;
comma
dot
id|mode
op_assign
l_int|0600
comma
dot
id|proc_handler
op_assign
op_amp
id|cmm_pages_handler
comma
)brace
comma
(brace
dot
id|ctl_name
op_assign
id|VM_CMM_TIMED_PAGES
comma
dot
id|procname
op_assign
l_string|&quot;cmm_timed_pages&quot;
comma
dot
id|mode
op_assign
l_int|0600
comma
dot
id|proc_handler
op_assign
op_amp
id|cmm_pages_handler
comma
)brace
comma
(brace
dot
id|ctl_name
op_assign
id|VM_CMM_TIMEOUT
comma
dot
id|procname
op_assign
l_string|&quot;cmm_timeout&quot;
comma
dot
id|mode
op_assign
l_int|0600
comma
dot
id|proc_handler
op_assign
op_amp
id|cmm_timeout_handler
comma
)brace
comma
(brace
dot
id|ctl_name
op_assign
l_int|0
)brace
)brace
suffix:semicolon
DECL|variable|cmm_dir_table
r_static
r_struct
id|ctl_table
id|cmm_dir_table
(braket
)braket
op_assign
(brace
(brace
dot
id|ctl_name
op_assign
id|CTL_VM
comma
dot
id|procname
op_assign
l_string|&quot;vm&quot;
comma
dot
id|maxlen
op_assign
l_int|0
comma
dot
id|mode
op_assign
l_int|0555
comma
dot
id|child
op_assign
id|cmm_table
comma
)brace
comma
(brace
dot
id|ctl_name
op_assign
l_int|0
)brace
)brace
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_CMM_IUCV
DECL|macro|SMSG_PREFIX
mdefine_line|#define SMSG_PREFIX &quot;CMM&quot;
r_static
r_void
DECL|function|cmm_smsg_target
id|cmm_smsg_target
c_func
(paren
r_char
op_star
id|msg
)paren
(brace
r_int
id|pages
comma
id|seconds
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|cmm_skip_blanks
c_func
(paren
id|msg
op_plus
id|strlen
c_func
(paren
id|SMSG_PREFIX
)paren
comma
op_amp
id|msg
)paren
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|strncmp
c_func
(paren
id|msg
comma
l_string|&quot;SHRINK&quot;
comma
l_int|6
)paren
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|cmm_skip_blanks
c_func
(paren
id|msg
op_plus
l_int|6
comma
op_amp
id|msg
)paren
)paren
r_return
suffix:semicolon
id|pages
op_assign
id|cmm_strtoul
c_func
(paren
id|msg
comma
op_amp
id|msg
)paren
suffix:semicolon
id|cmm_skip_blanks
c_func
(paren
id|msg
comma
op_amp
id|msg
)paren
suffix:semicolon
r_if
c_cond
(paren
op_star
id|msg
op_eq
l_char|&squot;&bslash;0&squot;
)paren
id|cmm_set_pages
c_func
(paren
id|pages
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|strncmp
c_func
(paren
id|msg
comma
l_string|&quot;RELEASE&quot;
comma
l_int|7
)paren
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|cmm_skip_blanks
c_func
(paren
id|msg
op_plus
l_int|7
comma
op_amp
id|msg
)paren
)paren
r_return
suffix:semicolon
id|pages
op_assign
id|cmm_strtoul
c_func
(paren
id|msg
comma
op_amp
id|msg
)paren
suffix:semicolon
id|cmm_skip_blanks
c_func
(paren
id|msg
comma
op_amp
id|msg
)paren
suffix:semicolon
r_if
c_cond
(paren
op_star
id|msg
op_eq
l_char|&squot;&bslash;0&squot;
)paren
id|cmm_add_timed_pages
c_func
(paren
id|pages
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|strncmp
c_func
(paren
id|msg
comma
l_string|&quot;REUSE&quot;
comma
l_int|5
)paren
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|cmm_skip_blanks
c_func
(paren
id|msg
op_plus
l_int|5
comma
op_amp
id|msg
)paren
)paren
r_return
suffix:semicolon
id|pages
op_assign
id|cmm_strtoul
c_func
(paren
id|msg
comma
op_amp
id|msg
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|cmm_skip_blanks
c_func
(paren
id|msg
comma
op_amp
id|msg
)paren
)paren
r_return
suffix:semicolon
id|seconds
op_assign
id|cmm_strtoul
c_func
(paren
id|msg
comma
op_amp
id|msg
)paren
suffix:semicolon
id|cmm_skip_blanks
c_func
(paren
id|msg
comma
op_amp
id|msg
)paren
suffix:semicolon
r_if
c_cond
(paren
op_star
id|msg
op_eq
l_char|&squot;&bslash;0&squot;
)paren
id|cmm_set_timeout
c_func
(paren
id|pages
comma
id|seconds
)paren
suffix:semicolon
)brace
)brace
macro_line|#endif
DECL|variable|cmm_sysctl_header
r_struct
id|ctl_table_header
op_star
id|cmm_sysctl_header
suffix:semicolon
r_static
r_int
DECL|function|cmm_init
id|cmm_init
(paren
r_void
)paren
(brace
macro_line|#ifdef CONFIG_CMM_PROC
id|cmm_sysctl_header
op_assign
id|register_sysctl_table
c_func
(paren
id|cmm_dir_table
comma
l_int|1
)paren
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_CMM_IUCV
id|smsg_register_callback
c_func
(paren
id|SMSG_PREFIX
comma
id|cmm_smsg_target
)paren
suffix:semicolon
macro_line|#endif
id|INIT_WORK
c_func
(paren
op_amp
id|cmm_thread_starter
comma
(paren
r_void
op_star
)paren
id|cmm_start_thread
comma
l_int|0
)paren
suffix:semicolon
id|init_waitqueue_head
c_func
(paren
op_amp
id|cmm_thread_wait
)paren
suffix:semicolon
id|init_timer
c_func
(paren
op_amp
id|cmm_timer
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_void
DECL|function|cmm_exit
id|cmm_exit
c_func
(paren
r_void
)paren
(brace
id|cmm_free_pages
c_func
(paren
id|cmm_pages
comma
op_amp
id|cmm_pages
comma
op_amp
id|cmm_page_list
)paren
suffix:semicolon
id|cmm_free_pages
c_func
(paren
id|cmm_timed_pages
comma
op_amp
id|cmm_timed_pages
comma
op_amp
id|cmm_timed_page_list
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_CMM_PROC
id|unregister_sysctl_table
c_func
(paren
id|cmm_sysctl_header
)paren
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_CMM_IUCV
id|smsg_unregister_callback
c_func
(paren
id|SMSG_PREFIX
comma
id|cmm_smsg_target
)paren
suffix:semicolon
macro_line|#endif
)brace
DECL|variable|cmm_init
id|module_init
c_func
(paren
id|cmm_init
)paren
suffix:semicolon
DECL|variable|cmm_exit
id|module_exit
c_func
(paren
id|cmm_exit
)paren
suffix:semicolon
DECL|variable|cmm_set_pages
id|EXPORT_SYMBOL
c_func
(paren
id|cmm_set_pages
)paren
suffix:semicolon
DECL|variable|cmm_get_pages
id|EXPORT_SYMBOL
c_func
(paren
id|cmm_get_pages
)paren
suffix:semicolon
DECL|variable|cmm_add_timed_pages
id|EXPORT_SYMBOL
c_func
(paren
id|cmm_add_timed_pages
)paren
suffix:semicolon
DECL|variable|cmm_get_timed_pages
id|EXPORT_SYMBOL
c_func
(paren
id|cmm_get_timed_pages
)paren
suffix:semicolon
DECL|variable|cmm_set_timeout
id|EXPORT_SYMBOL
c_func
(paren
id|cmm_set_timeout
)paren
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
eof
