multiline_comment|/*&n; * Cryptographic API.&n; *&n; * Function for checking keys for the DES and Tripple DES Encryption&n; * algorithms.&n; *&n; * Originally released as descore by Dana L. How &lt;how@isl.stanford.edu&gt;.&n; * Modified by Raimar Falke &lt;rf13@inf.tu-dresden.de&gt; for the Linux-Kernel.&n; * Derived from Cryptoapi and Nettle implementations, adapted for in-place&n; * scatterlist interface.  Changed LGPL to GPL per section 3 of the LGPL.&n; *&n; * s390 Version:&n; *   Copyright (C) 2003 IBM Deutschland GmbH, IBM Corporation&n; *   Author(s): Thomas Spatzier (tspat@de.ibm.com)&n; *&n; * Derived from &quot;crypto/des.c&quot;&n; *   Copyright (c) 1992 Dana L. How.&n; *   Copyright (c) Raimar Falke &lt;rf13@inf.tu-dresden.de&gt;&n; *   Copyright (c) Gisle Sflensminde &lt;gisle@ii.uib.no&gt;&n; *   Copyright (C) 2001 Niels Mvller.&n; *   Copyright (c) 2002 James Morris &lt;jmorris@intercode.com.au&gt;&n; *&n; * This program is free software; you can redistribute it and/or modify&n; * it under the terms of the GNU General Public License as published by&n; * the Free Software Foundation; either version 2 of the License, or&n; * (at your option) any later version.&n; *&n; */
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/errno.h&gt;
macro_line|#include &lt;linux/crypto.h&gt;
DECL|macro|ROR
mdefine_line|#define ROR(d,c,o)&t;((d) = (d) &gt;&gt; (c) | (d) &lt;&lt; (o))
DECL|variable|parity
r_static
r_const
id|u8
id|parity
(braket
)braket
op_assign
(brace
l_int|8
comma
l_int|1
comma
l_int|0
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|0
comma
l_int|2
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|0
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|0
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|3
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|0
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|0
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|0
comma
l_int|0
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|0
comma
l_int|0
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|0
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|0
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|0
comma
l_int|0
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|0
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|0
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|0
comma
l_int|0
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|0
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|0
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|0
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|0
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|0
comma
l_int|0
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|0
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|0
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|0
comma
l_int|0
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|0
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|0
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|0
comma
l_int|0
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|0
comma
l_int|0
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|0
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|0
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|4
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|0
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|0
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|5
comma
l_int|0
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|0
comma
l_int|8
comma
l_int|8
comma
l_int|0
comma
l_int|8
comma
l_int|0
comma
l_int|6
comma
l_int|8
comma
)brace
suffix:semicolon
multiline_comment|/*&n; * RFC2451: Weak key checks SHOULD be performed.&n; */
r_int
DECL|function|crypto_des_check_key
id|crypto_des_check_key
c_func
(paren
r_const
id|u8
op_star
id|key
comma
r_int
r_int
id|keylen
comma
id|u32
op_star
id|flags
)paren
(brace
id|u32
id|n
comma
id|w
suffix:semicolon
id|n
op_assign
id|parity
(braket
id|key
(braket
l_int|0
)braket
)braket
suffix:semicolon
id|n
op_lshift_assign
l_int|4
suffix:semicolon
id|n
op_or_assign
id|parity
(braket
id|key
(braket
l_int|1
)braket
)braket
suffix:semicolon
id|n
op_lshift_assign
l_int|4
suffix:semicolon
id|n
op_or_assign
id|parity
(braket
id|key
(braket
l_int|2
)braket
)braket
suffix:semicolon
id|n
op_lshift_assign
l_int|4
suffix:semicolon
id|n
op_or_assign
id|parity
(braket
id|key
(braket
l_int|3
)braket
)braket
suffix:semicolon
id|n
op_lshift_assign
l_int|4
suffix:semicolon
id|n
op_or_assign
id|parity
(braket
id|key
(braket
l_int|4
)braket
)braket
suffix:semicolon
id|n
op_lshift_assign
l_int|4
suffix:semicolon
id|n
op_or_assign
id|parity
(braket
id|key
(braket
l_int|5
)braket
)braket
suffix:semicolon
id|n
op_lshift_assign
l_int|4
suffix:semicolon
id|n
op_or_assign
id|parity
(braket
id|key
(braket
l_int|6
)braket
)braket
suffix:semicolon
id|n
op_lshift_assign
l_int|4
suffix:semicolon
id|n
op_or_assign
id|parity
(braket
id|key
(braket
l_int|7
)braket
)braket
suffix:semicolon
id|w
op_assign
l_int|0x88888888L
suffix:semicolon
r_if
c_cond
(paren
(paren
op_star
id|flags
op_amp
id|CRYPTO_TFM_REQ_WEAK_KEY
)paren
op_logical_and
op_logical_neg
(paren
(paren
id|n
op_minus
(paren
id|w
op_rshift
l_int|3
)paren
)paren
op_amp
id|w
)paren
)paren
(brace
multiline_comment|/* 1 in 10^10 keys passes this test */
r_if
c_cond
(paren
id|n
OL
l_int|0x41415151
)paren
(brace
r_if
c_cond
(paren
id|n
OL
l_int|0x31312121
)paren
(brace
r_if
c_cond
(paren
id|n
OL
l_int|0x14141515
)paren
(brace
multiline_comment|/* 01 01 01 01 01 01 01 01 */
r_if
c_cond
(paren
id|n
op_eq
l_int|0x11111111
)paren
r_goto
id|weak
suffix:semicolon
multiline_comment|/* 01 1F 01 1F 01 0E 01 0E */
r_if
c_cond
(paren
id|n
op_eq
l_int|0x13131212
)paren
r_goto
id|weak
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* 01 E0 01 E0 01 F1 01 F1 */
r_if
c_cond
(paren
id|n
op_eq
l_int|0x14141515
)paren
r_goto
id|weak
suffix:semicolon
multiline_comment|/* 01 FE 01 FE 01 FE 01 FE */
r_if
c_cond
(paren
id|n
op_eq
l_int|0x16161616
)paren
r_goto
id|weak
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|n
OL
l_int|0x34342525
)paren
(brace
multiline_comment|/* 1F 01 1F 01 0E 01 0E 01 */
r_if
c_cond
(paren
id|n
op_eq
l_int|0x31312121
)paren
r_goto
id|weak
suffix:semicolon
multiline_comment|/* 1F 1F 1F 1F 0E 0E 0E 0E (?) */
r_if
c_cond
(paren
id|n
op_eq
l_int|0x33332222
)paren
r_goto
id|weak
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* 1F E0 1F E0 0E F1 0E F1 */
r_if
c_cond
(paren
id|n
op_eq
l_int|0x34342525
)paren
r_goto
id|weak
suffix:semicolon
multiline_comment|/* 1F FE 1F FE 0E FE 0E FE */
r_if
c_cond
(paren
id|n
op_eq
l_int|0x36362626
)paren
r_goto
id|weak
suffix:semicolon
)brace
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|n
OL
l_int|0x61616161
)paren
(brace
r_if
c_cond
(paren
id|n
OL
l_int|0x44445555
)paren
(brace
multiline_comment|/* E0 01 E0 01 F1 01 F1 01 */
r_if
c_cond
(paren
id|n
op_eq
l_int|0x41415151
)paren
r_goto
id|weak
suffix:semicolon
multiline_comment|/* E0 1F E0 1F F1 0E F1 0E */
r_if
c_cond
(paren
id|n
op_eq
l_int|0x43435252
)paren
r_goto
id|weak
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* E0 E0 E0 E0 F1 F1 F1 F1 (?) */
r_if
c_cond
(paren
id|n
op_eq
l_int|0x44445555
)paren
r_goto
id|weak
suffix:semicolon
multiline_comment|/* E0 FE E0 FE F1 FE F1 FE */
r_if
c_cond
(paren
id|n
op_eq
l_int|0x46465656
)paren
r_goto
id|weak
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|n
OL
l_int|0x64646565
)paren
(brace
multiline_comment|/* FE 01 FE 01 FE 01 FE 01 */
r_if
c_cond
(paren
id|n
op_eq
l_int|0x61616161
)paren
r_goto
id|weak
suffix:semicolon
multiline_comment|/* FE 1F FE 1F FE 0E FE 0E */
r_if
c_cond
(paren
id|n
op_eq
l_int|0x63636262
)paren
r_goto
id|weak
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* FE E0 FE E0 FE F1 FE F1 */
r_if
c_cond
(paren
id|n
op_eq
l_int|0x64646565
)paren
r_goto
id|weak
suffix:semicolon
multiline_comment|/* FE FE FE FE FE FE FE FE */
r_if
c_cond
(paren
id|n
op_eq
l_int|0x66666666
)paren
r_goto
id|weak
suffix:semicolon
)brace
)brace
)brace
)brace
r_return
l_int|0
suffix:semicolon
id|weak
suffix:colon
op_star
id|flags
op_or_assign
id|CRYPTO_TFM_RES_WEAK_KEY
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
DECL|variable|crypto_des_check_key
id|EXPORT_SYMBOL
c_func
(paren
id|crypto_des_check_key
)paren
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
id|MODULE_DESCRIPTION
c_func
(paren
l_string|&quot;Key Check function for DES &amp;  DES3 Cipher Algorithms&quot;
)paren
suffix:semicolon
eof
