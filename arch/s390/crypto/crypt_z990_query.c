multiline_comment|/*&n; * Cryptographic API.&n; *&n; * Support for z990 cryptographic instructions.&n; * Testing module for querying processor crypto capabilities.&n; *&n; * Copyright (c) 2003 IBM Deutschland Entwicklung GmbH, IBM Corporation&n; * Author(s): Thomas Spatzier (tspat@de.ibm.com)&n; *&n; * This program is free software; you can redistribute it and/or modify it&n; * under the terms of the GNU General Public License as published by the Free&n; * Software Foundation; either version 2 of the License, or (at your option)&n; * any later version.&n; *&n; */
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;asm/errno.h&gt;
macro_line|#include &quot;crypt_z990.h&quot;
r_static
r_void
DECL|function|query_available_functions
id|query_available_functions
c_func
(paren
r_void
)paren
(brace
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;#####################&bslash;n&quot;
)paren
suffix:semicolon
singleline_comment|//query available KM functions
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;KM_QUERY: %d&bslash;n&quot;
comma
id|crypt_z990_func_available
c_func
(paren
id|KM_QUERY
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;KM_DEA: %d&bslash;n&quot;
comma
id|crypt_z990_func_available
c_func
(paren
id|KM_DEA_ENCRYPT
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;KM_TDEA_128: %d&bslash;n&quot;
comma
id|crypt_z990_func_available
c_func
(paren
id|KM_TDEA_128_ENCRYPT
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;KM_TDEA_192: %d&bslash;n&quot;
comma
id|crypt_z990_func_available
c_func
(paren
id|KM_TDEA_192_ENCRYPT
)paren
)paren
suffix:semicolon
singleline_comment|//query available KMC functions
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;KMC_QUERY: %d&bslash;n&quot;
comma
id|crypt_z990_func_available
c_func
(paren
id|KMC_QUERY
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;KMC_DEA: %d&bslash;n&quot;
comma
id|crypt_z990_func_available
c_func
(paren
id|KMC_DEA_ENCRYPT
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;KMC_TDEA_128: %d&bslash;n&quot;
comma
id|crypt_z990_func_available
c_func
(paren
id|KMC_TDEA_128_ENCRYPT
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;KMC_TDEA_192: %d&bslash;n&quot;
comma
id|crypt_z990_func_available
c_func
(paren
id|KMC_TDEA_192_ENCRYPT
)paren
)paren
suffix:semicolon
singleline_comment|//query available KIMD fucntions
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;KIMD_QUERY: %d&bslash;n&quot;
comma
id|crypt_z990_func_available
c_func
(paren
id|KIMD_QUERY
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;KIMD_SHA_1: %d&bslash;n&quot;
comma
id|crypt_z990_func_available
c_func
(paren
id|KIMD_SHA_1
)paren
)paren
suffix:semicolon
singleline_comment|//query available KLMD functions
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;KLMD_QUERY: %d&bslash;n&quot;
comma
id|crypt_z990_func_available
c_func
(paren
id|KLMD_QUERY
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;KLMD_SHA_1: %d&bslash;n&quot;
comma
id|crypt_z990_func_available
c_func
(paren
id|KLMD_SHA_1
)paren
)paren
suffix:semicolon
singleline_comment|//query available KMAC functions
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;KMAC_QUERY: %d&bslash;n&quot;
comma
id|crypt_z990_func_available
c_func
(paren
id|KMAC_QUERY
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;KMAC_DEA: %d&bslash;n&quot;
comma
id|crypt_z990_func_available
c_func
(paren
id|KMAC_DEA
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;KMAC_TDEA_128: %d&bslash;n&quot;
comma
id|crypt_z990_func_available
c_func
(paren
id|KMAC_TDEA_128
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;KMAC_TDEA_192: %d&bslash;n&quot;
comma
id|crypt_z990_func_available
c_func
(paren
id|KMAC_TDEA_192
)paren
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|init
id|init
c_func
(paren
r_void
)paren
(brace
r_struct
id|crypt_z990_query_status
id|status
op_assign
(brace
dot
id|high
op_assign
l_int|0
comma
dot
id|low
op_assign
l_int|0
)brace
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;crypt_z990: querying available crypto functions&bslash;n&quot;
)paren
suffix:semicolon
id|crypt_z990_km
c_func
(paren
id|KM_QUERY
comma
op_amp
id|status
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;KM: %016llx %016llx&bslash;n&quot;
comma
(paren
r_int
r_int
r_int
)paren
id|status.high
comma
(paren
r_int
r_int
r_int
)paren
id|status.low
)paren
suffix:semicolon
id|status.high
op_assign
id|status.low
op_assign
l_int|0
suffix:semicolon
id|crypt_z990_kmc
c_func
(paren
id|KMC_QUERY
comma
op_amp
id|status
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;KMC: %016llx %016llx&bslash;n&quot;
comma
(paren
r_int
r_int
r_int
)paren
id|status.high
comma
(paren
r_int
r_int
r_int
)paren
id|status.low
)paren
suffix:semicolon
id|status.high
op_assign
id|status.low
op_assign
l_int|0
suffix:semicolon
id|crypt_z990_kimd
c_func
(paren
id|KIMD_QUERY
comma
op_amp
id|status
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;KIMD: %016llx %016llx&bslash;n&quot;
comma
(paren
r_int
r_int
r_int
)paren
id|status.high
comma
(paren
r_int
r_int
r_int
)paren
id|status.low
)paren
suffix:semicolon
id|status.high
op_assign
id|status.low
op_assign
l_int|0
suffix:semicolon
id|crypt_z990_klmd
c_func
(paren
id|KLMD_QUERY
comma
op_amp
id|status
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;KLMD: %016llx %016llx&bslash;n&quot;
comma
(paren
r_int
r_int
r_int
)paren
id|status.high
comma
(paren
r_int
r_int
r_int
)paren
id|status.low
)paren
suffix:semicolon
id|status.high
op_assign
id|status.low
op_assign
l_int|0
suffix:semicolon
id|crypt_z990_kmac
c_func
(paren
id|KMAC_QUERY
comma
op_amp
id|status
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;KMAC: %016llx %016llx&bslash;n&quot;
comma
(paren
r_int
r_int
r_int
)paren
id|status.high
comma
(paren
r_int
r_int
r_int
)paren
id|status.low
)paren
suffix:semicolon
id|query_available_functions
c_func
(paren
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_static
r_void
id|__exit
DECL|function|cleanup
id|cleanup
c_func
(paren
r_void
)paren
(brace
)brace
DECL|variable|init
id|module_init
c_func
(paren
id|init
)paren
suffix:semicolon
DECL|variable|cleanup
id|module_exit
c_func
(paren
id|cleanup
)paren
suffix:semicolon
id|MODULE_LICENSE
c_func
(paren
l_string|&quot;GPL&quot;
)paren
suffix:semicolon
eof
