multiline_comment|/*&n; *  arch/s390/kernel/traps.c&n; *&n; *  S390 version&n; *    Copyright (C) 1999,2000 IBM Deutschland Entwicklung GmbH, IBM Corporation&n; *    Author(s): Martin Schwidefsky (schwidefsky@de.ibm.com),&n; *               Denis Joseph Barrow (djbarrow@de.ibm.com,barrow_dj@yahoo.com),&n; *&n; *  Derived from &quot;arch/i386/kernel/traps.c&quot;&n; *    Copyright (C) 1991, 1992 Linus Torvalds&n; */
multiline_comment|/*&n; * &squot;Traps.c&squot; handles hardware traps and faults after we have saved some&n; * state in &squot;asm.s&squot;.&n; */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/string.h&gt;
macro_line|#include &lt;linux/errno.h&gt;
macro_line|#include &lt;linux/ptrace.h&gt;
macro_line|#include &lt;linux/timer.h&gt;
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;linux/smp.h&gt;
macro_line|#include &lt;linux/smp_lock.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/interrupt.h&gt;
macro_line|#include &lt;linux/delay.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/kallsyms.h&gt;
macro_line|#include &lt;asm/system.h&gt;
macro_line|#include &lt;asm/uaccess.h&gt;
macro_line|#include &lt;asm/io.h&gt;
macro_line|#include &lt;asm/atomic.h&gt;
macro_line|#include &lt;asm/mathemu.h&gt;
macro_line|#include &lt;asm/cpcmd.h&gt;
macro_line|#include &lt;asm/s390_ext.h&gt;
macro_line|#include &lt;asm/lowcore.h&gt;
macro_line|#include &lt;asm/debug.h&gt;
multiline_comment|/* Called from entry.S only */
r_extern
r_void
id|handle_per_exception
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
suffix:semicolon
DECL|typedef|pgm_check_handler_t
r_typedef
r_void
id|pgm_check_handler_t
c_func
(paren
r_struct
id|pt_regs
op_star
comma
r_int
)paren
suffix:semicolon
DECL|variable|pgm_check_table
id|pgm_check_handler_t
op_star
id|pgm_check_table
(braket
l_int|128
)braket
suffix:semicolon
macro_line|#ifdef CONFIG_SYSCTL
macro_line|#ifdef CONFIG_PROCESS_DEBUG
DECL|variable|sysctl_userprocess_debug
r_int
id|sysctl_userprocess_debug
op_assign
l_int|1
suffix:semicolon
macro_line|#else
DECL|variable|sysctl_userprocess_debug
r_int
id|sysctl_userprocess_debug
op_assign
l_int|0
suffix:semicolon
macro_line|#endif
macro_line|#endif
r_extern
id|pgm_check_handler_t
id|do_protection_exception
suffix:semicolon
r_extern
id|pgm_check_handler_t
id|do_dat_exception
suffix:semicolon
r_extern
id|pgm_check_handler_t
id|do_pseudo_page_fault
suffix:semicolon
macro_line|#ifdef CONFIG_PFAULT
r_extern
r_int
id|pfault_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_void
id|pfault_fini
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_void
id|pfault_interrupt
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
comma
id|__u16
id|error_code
)paren
suffix:semicolon
DECL|variable|ext_int_pfault
r_static
id|ext_int_info_t
id|ext_int_pfault
suffix:semicolon
macro_line|#endif
r_extern
id|pgm_check_handler_t
id|do_monitor_call
suffix:semicolon
DECL|macro|stack_pointer
mdefine_line|#define stack_pointer ({ void **sp; asm(&quot;la %0,0(15)&quot; : &quot;=&amp;d&quot; (sp)); sp; })
macro_line|#ifndef CONFIG_ARCH_S390X
DECL|macro|FOURLONG
mdefine_line|#define FOURLONG &quot;%08lx %08lx %08lx %08lx&bslash;n&quot;
DECL|variable|kstack_depth_to_print
r_static
r_int
id|kstack_depth_to_print
op_assign
l_int|12
suffix:semicolon
macro_line|#else /* CONFIG_ARCH_S390X */
DECL|macro|FOURLONG
mdefine_line|#define FOURLONG &quot;%016lx %016lx %016lx %016lx&bslash;n&quot;
DECL|variable|kstack_depth_to_print
r_static
r_int
id|kstack_depth_to_print
op_assign
l_int|20
suffix:semicolon
macro_line|#endif /* CONFIG_ARCH_S390X */
multiline_comment|/*&n; * For show_trace we have tree different stack to consider:&n; *   - the panic stack which is used if the kernel stack has overflown&n; *   - the asynchronous interrupt stack (cpu related)&n; *   - the synchronous kernel stack (process related)&n; * The stack trace can start at any of the three stack and can potentially&n; * touch all of them. The order is: panic stack, async stack, sync stack.&n; */
r_static
r_int
r_int
DECL|function|__show_trace
id|__show_trace
c_func
(paren
r_int
r_int
id|sp
comma
r_int
r_int
id|low
comma
r_int
r_int
id|high
)paren
(brace
r_struct
id|stack_frame
op_star
id|sf
suffix:semicolon
r_struct
id|pt_regs
op_star
id|regs
suffix:semicolon
r_while
c_loop
(paren
l_int|1
)paren
(brace
id|sp
op_assign
id|sp
op_amp
id|PSW_ADDR_INSN
suffix:semicolon
r_if
c_cond
(paren
id|sp
template_param
id|high
op_minus
r_sizeof
(paren
op_star
id|sf
)paren
)paren
r_return
id|sp
suffix:semicolon
id|sf
op_assign
(paren
r_struct
id|stack_frame
op_star
)paren
id|sp
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;([&lt;%016lx&gt;] &quot;
comma
id|sf-&gt;gprs
(braket
l_int|8
)braket
op_amp
id|PSW_ADDR_INSN
)paren
suffix:semicolon
id|print_symbol
c_func
(paren
l_string|&quot;%s)&bslash;n&quot;
comma
id|sf-&gt;gprs
(braket
l_int|8
)braket
op_amp
id|PSW_ADDR_INSN
)paren
suffix:semicolon
multiline_comment|/* Follow the backchain. */
r_while
c_loop
(paren
l_int|1
)paren
(brace
id|low
op_assign
id|sp
suffix:semicolon
id|sp
op_assign
id|sf-&gt;back_chain
op_amp
id|PSW_ADDR_INSN
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|sp
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
id|sp
op_le
id|low
op_logical_or
id|sp
OG
id|high
op_minus
r_sizeof
(paren
op_star
id|sf
)paren
)paren
r_return
id|sp
suffix:semicolon
id|sf
op_assign
(paren
r_struct
id|stack_frame
op_star
)paren
id|sp
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot; [&lt;%016lx&gt;] &quot;
comma
id|sf-&gt;gprs
(braket
l_int|8
)braket
op_amp
id|PSW_ADDR_INSN
)paren
suffix:semicolon
id|print_symbol
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|sf-&gt;gprs
(braket
l_int|8
)braket
op_amp
id|PSW_ADDR_INSN
)paren
suffix:semicolon
)brace
multiline_comment|/* Zero backchain detected, check for interrupt frame. */
id|sp
op_assign
(paren
r_int
r_int
)paren
(paren
id|sf
op_plus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|sp
op_le
id|low
op_logical_or
id|sp
OG
id|high
op_minus
r_sizeof
(paren
op_star
id|regs
)paren
)paren
r_return
id|sp
suffix:semicolon
id|regs
op_assign
(paren
r_struct
id|pt_regs
op_star
)paren
id|sp
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot; [&lt;%016lx&gt;] &quot;
comma
id|regs-&gt;psw.addr
op_amp
id|PSW_ADDR_INSN
)paren
suffix:semicolon
id|print_symbol
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|regs-&gt;psw.addr
op_amp
id|PSW_ADDR_INSN
)paren
suffix:semicolon
id|low
op_assign
id|sp
suffix:semicolon
id|sp
op_assign
id|regs-&gt;gprs
(braket
l_int|15
)braket
suffix:semicolon
)brace
)brace
DECL|function|show_trace
r_void
id|show_trace
c_func
(paren
r_struct
id|task_struct
op_star
id|task
comma
r_int
r_int
op_star
id|stack
)paren
(brace
r_register
r_int
r_int
id|__r15
id|asm
(paren
l_string|&quot;15&quot;
)paren
suffix:semicolon
r_int
r_int
id|sp
suffix:semicolon
id|sp
op_assign
(paren
r_int
r_int
)paren
id|stack
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|sp
)paren
id|sp
op_assign
id|task
ques
c_cond
id|task-&gt;thread.ksp
suffix:colon
id|__r15
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;Call Trace:&bslash;n&quot;
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_CHECK_STACK
id|sp
op_assign
id|__show_trace
c_func
(paren
id|sp
comma
id|S390_lowcore.panic_stack
op_minus
l_int|4096
comma
id|S390_lowcore.panic_stack
)paren
suffix:semicolon
macro_line|#endif
id|sp
op_assign
id|__show_trace
c_func
(paren
id|sp
comma
id|S390_lowcore.async_stack
op_minus
id|ASYNC_SIZE
comma
id|S390_lowcore.async_stack
)paren
suffix:semicolon
r_if
c_cond
(paren
id|task
)paren
id|__show_trace
c_func
(paren
id|sp
comma
(paren
r_int
r_int
)paren
id|task-&gt;thread_info
comma
(paren
r_int
r_int
)paren
id|task-&gt;thread_info
op_plus
id|THREAD_SIZE
)paren
suffix:semicolon
r_else
id|__show_trace
c_func
(paren
id|sp
comma
id|S390_lowcore.thread_info
comma
id|S390_lowcore.thread_info
op_plus
id|THREAD_SIZE
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
)brace
DECL|function|show_stack
r_void
id|show_stack
c_func
(paren
r_struct
id|task_struct
op_star
id|task
comma
r_int
r_int
op_star
id|sp
)paren
(brace
r_register
r_int
r_int
op_star
id|__r15
id|asm
(paren
l_string|&quot;15&quot;
)paren
suffix:semicolon
r_int
r_int
op_star
id|stack
suffix:semicolon
r_int
id|i
suffix:semicolon
singleline_comment|// debugging aid: &quot;show_stack(NULL);&quot; prints the
singleline_comment|// back trace for this cpu.
r_if
c_cond
(paren
op_logical_neg
id|sp
)paren
id|sp
op_assign
id|task
ques
c_cond
(paren
r_int
r_int
op_star
)paren
id|task-&gt;thread.ksp
suffix:colon
id|__r15
suffix:semicolon
id|stack
op_assign
id|sp
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|kstack_depth_to_print
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
(paren
(paren
id|addr_t
)paren
id|stack
op_amp
(paren
id|THREAD_SIZE
op_minus
l_int|1
)paren
)paren
op_eq
l_int|0
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
id|i
op_logical_and
(paren
(paren
id|i
op_star
r_sizeof
(paren
r_int
)paren
op_mod
l_int|32
)paren
op_eq
l_int|0
)paren
)paren
id|printk
c_func
(paren
l_string|&quot;&bslash;n       &quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%p &quot;
comma
(paren
r_void
op_star
)paren
op_star
id|stack
op_increment
)paren
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|show_trace
c_func
(paren
id|task
comma
id|sp
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * The architecture-independent dump_stack generator&n; */
DECL|function|dump_stack
r_void
id|dump_stack
c_func
(paren
r_void
)paren
(brace
id|show_stack
c_func
(paren
l_int|0
comma
l_int|0
)paren
suffix:semicolon
)brace
DECL|variable|dump_stack
id|EXPORT_SYMBOL
c_func
(paren
id|dump_stack
)paren
suffix:semicolon
DECL|function|show_registers
r_void
id|show_registers
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|mm_segment_t
id|old_fs
suffix:semicolon
r_char
op_star
id|mode
suffix:semicolon
r_int
id|i
suffix:semicolon
id|mode
op_assign
(paren
id|regs-&gt;psw.mask
op_amp
id|PSW_MASK_PSTATE
)paren
ques
c_cond
l_string|&quot;User&quot;
suffix:colon
l_string|&quot;Krnl&quot;
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s PSW : %p %p&quot;
comma
id|mode
comma
(paren
r_void
op_star
)paren
id|regs-&gt;psw.mask
comma
(paren
r_void
op_star
)paren
id|regs-&gt;psw.addr
)paren
suffix:semicolon
id|print_symbol
c_func
(paren
l_string|&quot; (%s)&bslash;n&quot;
comma
id|regs-&gt;psw.addr
op_amp
id|PSW_ADDR_INSN
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s GPRS: &quot;
id|FOURLONG
comma
id|mode
comma
id|regs-&gt;gprs
(braket
l_int|0
)braket
comma
id|regs-&gt;gprs
(braket
l_int|1
)braket
comma
id|regs-&gt;gprs
(braket
l_int|2
)braket
comma
id|regs-&gt;gprs
(braket
l_int|3
)braket
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;           &quot;
id|FOURLONG
comma
id|regs-&gt;gprs
(braket
l_int|4
)braket
comma
id|regs-&gt;gprs
(braket
l_int|5
)braket
comma
id|regs-&gt;gprs
(braket
l_int|6
)braket
comma
id|regs-&gt;gprs
(braket
l_int|7
)braket
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;           &quot;
id|FOURLONG
comma
id|regs-&gt;gprs
(braket
l_int|8
)braket
comma
id|regs-&gt;gprs
(braket
l_int|9
)braket
comma
id|regs-&gt;gprs
(braket
l_int|10
)braket
comma
id|regs-&gt;gprs
(braket
l_int|11
)braket
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;           &quot;
id|FOURLONG
comma
id|regs-&gt;gprs
(braket
l_int|12
)braket
comma
id|regs-&gt;gprs
(braket
l_int|13
)braket
comma
id|regs-&gt;gprs
(braket
l_int|14
)braket
comma
id|regs-&gt;gprs
(braket
l_int|15
)braket
)paren
suffix:semicolon
macro_line|#if 0
multiline_comment|/* FIXME: this isn&squot;t needed any more but it changes the ksymoops&n;&t; * input. To remove or not to remove ... */
id|save_access_regs
c_func
(paren
id|regs-&gt;acrs
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s ACRS: %08x %08x %08x %08x&bslash;n&quot;
comma
id|mode
comma
id|regs-&gt;acrs
(braket
l_int|0
)braket
comma
id|regs-&gt;acrs
(braket
l_int|1
)braket
comma
id|regs-&gt;acrs
(braket
l_int|2
)braket
comma
id|regs-&gt;acrs
(braket
l_int|3
)braket
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;           %08x %08x %08x %08x&bslash;n&quot;
comma
id|regs-&gt;acrs
(braket
l_int|4
)braket
comma
id|regs-&gt;acrs
(braket
l_int|5
)braket
comma
id|regs-&gt;acrs
(braket
l_int|6
)braket
comma
id|regs-&gt;acrs
(braket
l_int|7
)braket
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;           %08x %08x %08x %08x&bslash;n&quot;
comma
id|regs-&gt;acrs
(braket
l_int|8
)braket
comma
id|regs-&gt;acrs
(braket
l_int|9
)braket
comma
id|regs-&gt;acrs
(braket
l_int|10
)braket
comma
id|regs-&gt;acrs
(braket
l_int|11
)braket
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;           %08x %08x %08x %08x&bslash;n&quot;
comma
id|regs-&gt;acrs
(braket
l_int|12
)braket
comma
id|regs-&gt;acrs
(braket
l_int|13
)braket
comma
id|regs-&gt;acrs
(braket
l_int|14
)braket
comma
id|regs-&gt;acrs
(braket
l_int|15
)braket
)paren
suffix:semicolon
macro_line|#endif
multiline_comment|/*&n;&t; * Print the first 20 byte of the instruction stream at the&n;&t; * time of the fault.&n;&t; */
id|old_fs
op_assign
id|get_fs
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|regs-&gt;psw.mask
op_amp
id|PSW_MASK_PSTATE
)paren
id|set_fs
c_func
(paren
id|USER_DS
)paren
suffix:semicolon
r_else
id|set_fs
c_func
(paren
id|KERNEL_DS
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s Code: &quot;
comma
id|mode
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|20
suffix:semicolon
id|i
op_increment
)paren
(brace
r_int
r_char
id|c
suffix:semicolon
r_if
c_cond
(paren
id|__get_user
c_func
(paren
id|c
comma
(paren
r_char
id|__user
op_star
)paren
(paren
id|regs-&gt;psw.addr
op_plus
id|i
)paren
)paren
)paren
(brace
id|printk
c_func
(paren
l_string|&quot; Bad PSW.&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;%02x &quot;
comma
id|c
)paren
suffix:semicolon
)brace
id|set_fs
c_func
(paren
id|old_fs
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
)brace
multiline_comment|/* This is called from fs/proc/array.c */
DECL|function|task_show_regs
r_char
op_star
id|task_show_regs
c_func
(paren
r_struct
id|task_struct
op_star
id|task
comma
r_char
op_star
id|buffer
)paren
(brace
r_struct
id|pt_regs
op_star
id|regs
suffix:semicolon
id|regs
op_assign
id|__KSTK_PTREGS
c_func
(paren
id|task
)paren
suffix:semicolon
id|buffer
op_add_assign
id|sprintf
c_func
(paren
id|buffer
comma
l_string|&quot;task: %p, ksp: %p&bslash;n&quot;
comma
id|task
comma
(paren
r_void
op_star
)paren
id|task-&gt;thread.ksp
)paren
suffix:semicolon
id|buffer
op_add_assign
id|sprintf
c_func
(paren
id|buffer
comma
l_string|&quot;User PSW : %p %p&bslash;n&quot;
comma
(paren
r_void
op_star
)paren
id|regs-&gt;psw.mask
comma
(paren
r_void
op_star
)paren
id|regs-&gt;psw.addr
)paren
suffix:semicolon
id|buffer
op_add_assign
id|sprintf
c_func
(paren
id|buffer
comma
l_string|&quot;User GPRS: &quot;
id|FOURLONG
comma
id|regs-&gt;gprs
(braket
l_int|0
)braket
comma
id|regs-&gt;gprs
(braket
l_int|1
)braket
comma
id|regs-&gt;gprs
(braket
l_int|2
)braket
comma
id|regs-&gt;gprs
(braket
l_int|3
)braket
)paren
suffix:semicolon
id|buffer
op_add_assign
id|sprintf
c_func
(paren
id|buffer
comma
l_string|&quot;           &quot;
id|FOURLONG
comma
id|regs-&gt;gprs
(braket
l_int|4
)braket
comma
id|regs-&gt;gprs
(braket
l_int|5
)braket
comma
id|regs-&gt;gprs
(braket
l_int|6
)braket
comma
id|regs-&gt;gprs
(braket
l_int|7
)braket
)paren
suffix:semicolon
id|buffer
op_add_assign
id|sprintf
c_func
(paren
id|buffer
comma
l_string|&quot;           &quot;
id|FOURLONG
comma
id|regs-&gt;gprs
(braket
l_int|8
)braket
comma
id|regs-&gt;gprs
(braket
l_int|9
)braket
comma
id|regs-&gt;gprs
(braket
l_int|10
)braket
comma
id|regs-&gt;gprs
(braket
l_int|11
)braket
)paren
suffix:semicolon
id|buffer
op_add_assign
id|sprintf
c_func
(paren
id|buffer
comma
l_string|&quot;           &quot;
id|FOURLONG
comma
id|regs-&gt;gprs
(braket
l_int|12
)braket
comma
id|regs-&gt;gprs
(braket
l_int|13
)braket
comma
id|regs-&gt;gprs
(braket
l_int|14
)braket
comma
id|regs-&gt;gprs
(braket
l_int|15
)braket
)paren
suffix:semicolon
id|buffer
op_add_assign
id|sprintf
c_func
(paren
id|buffer
comma
l_string|&quot;User ACRS: %08x %08x %08x %08x&bslash;n&quot;
comma
id|task-&gt;thread.acrs
(braket
l_int|0
)braket
comma
id|task-&gt;thread.acrs
(braket
l_int|1
)braket
comma
id|task-&gt;thread.acrs
(braket
l_int|2
)braket
comma
id|task-&gt;thread.acrs
(braket
l_int|3
)braket
)paren
suffix:semicolon
id|buffer
op_add_assign
id|sprintf
c_func
(paren
id|buffer
comma
l_string|&quot;           %08x %08x %08x %08x&bslash;n&quot;
comma
id|task-&gt;thread.acrs
(braket
l_int|4
)braket
comma
id|task-&gt;thread.acrs
(braket
l_int|5
)braket
comma
id|task-&gt;thread.acrs
(braket
l_int|6
)braket
comma
id|task-&gt;thread.acrs
(braket
l_int|7
)braket
)paren
suffix:semicolon
id|buffer
op_add_assign
id|sprintf
c_func
(paren
id|buffer
comma
l_string|&quot;           %08x %08x %08x %08x&bslash;n&quot;
comma
id|task-&gt;thread.acrs
(braket
l_int|8
)braket
comma
id|task-&gt;thread.acrs
(braket
l_int|9
)braket
comma
id|task-&gt;thread.acrs
(braket
l_int|10
)braket
comma
id|task-&gt;thread.acrs
(braket
l_int|11
)braket
)paren
suffix:semicolon
id|buffer
op_add_assign
id|sprintf
c_func
(paren
id|buffer
comma
l_string|&quot;           %08x %08x %08x %08x&bslash;n&quot;
comma
id|task-&gt;thread.acrs
(braket
l_int|12
)braket
comma
id|task-&gt;thread.acrs
(braket
l_int|13
)braket
comma
id|task-&gt;thread.acrs
(braket
l_int|14
)braket
comma
id|task-&gt;thread.acrs
(braket
l_int|15
)braket
)paren
suffix:semicolon
r_return
id|buffer
suffix:semicolon
)brace
DECL|variable|die_lock
id|spinlock_t
id|die_lock
op_assign
id|SPIN_LOCK_UNLOCKED
suffix:semicolon
DECL|function|die
r_void
id|die
c_func
(paren
r_const
r_char
op_star
id|str
comma
r_struct
id|pt_regs
op_star
id|regs
comma
r_int
id|err
)paren
(brace
r_static
r_int
id|die_counter
suffix:semicolon
id|debug_stop_all
c_func
(paren
)paren
suffix:semicolon
id|console_verbose
c_func
(paren
)paren
suffix:semicolon
id|spin_lock_irq
c_func
(paren
op_amp
id|die_lock
)paren
suffix:semicolon
id|bust_spinlocks
c_func
(paren
l_int|1
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s: %04lx [#%d]&bslash;n&quot;
comma
id|str
comma
id|err
op_amp
l_int|0xffff
comma
op_increment
id|die_counter
)paren
suffix:semicolon
id|show_regs
c_func
(paren
id|regs
)paren
suffix:semicolon
id|bust_spinlocks
c_func
(paren
l_int|0
)paren
suffix:semicolon
id|spin_unlock_irq
c_func
(paren
op_amp
id|die_lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|in_interrupt
c_func
(paren
)paren
)paren
id|panic
c_func
(paren
l_string|&quot;Fatal exception in interrupt&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|panic_on_oops
)paren
id|panic
c_func
(paren
l_string|&quot;Fatal exception: panic_on_oops&quot;
)paren
suffix:semicolon
id|do_exit
c_func
(paren
id|SIGSEGV
)paren
suffix:semicolon
)brace
r_static
r_void
r_inline
DECL|function|report_user_fault
id|report_user_fault
c_func
(paren
r_int
id|interruption_code
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
macro_line|#if defined(CONFIG_SYSCTL)
r_if
c_cond
(paren
op_logical_neg
id|sysctl_userprocess_debug
)paren
r_return
suffix:semicolon
macro_line|#endif
macro_line|#if defined(CONFIG_SYSCTL) || defined(CONFIG_PROCESS_DEBUG)
id|printk
c_func
(paren
l_string|&quot;User process fault: interruption code 0x%lX&bslash;n&quot;
comma
id|interruption_code
)paren
suffix:semicolon
id|show_regs
c_func
(paren
id|regs
)paren
suffix:semicolon
macro_line|#endif
)brace
DECL|function|do_trap
r_static
r_void
r_inline
id|do_trap
c_func
(paren
r_int
id|interruption_code
comma
r_int
id|signr
comma
r_char
op_star
id|str
comma
r_struct
id|pt_regs
op_star
id|regs
comma
id|siginfo_t
op_star
id|info
)paren
(brace
multiline_comment|/*&n;&t; * We got all needed information from the lowcore and can&n;&t; * now safely switch on interrupts.&n;&t; */
r_if
c_cond
(paren
id|regs-&gt;psw.mask
op_amp
id|PSW_MASK_PSTATE
)paren
id|local_irq_enable
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|regs-&gt;psw.mask
op_amp
id|PSW_MASK_PSTATE
)paren
(brace
r_struct
id|task_struct
op_star
id|tsk
op_assign
id|current
suffix:semicolon
id|tsk-&gt;thread.trap_no
op_assign
id|interruption_code
op_amp
l_int|0xffff
suffix:semicolon
id|force_sig_info
c_func
(paren
id|signr
comma
id|info
comma
id|tsk
)paren
suffix:semicolon
id|report_user_fault
c_func
(paren
id|interruption_code
comma
id|regs
)paren
suffix:semicolon
)brace
r_else
(brace
r_const
r_struct
id|exception_table_entry
op_star
id|fixup
suffix:semicolon
id|fixup
op_assign
id|search_exception_tables
c_func
(paren
id|regs-&gt;psw.addr
op_amp
id|PSW_ADDR_INSN
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fixup
)paren
id|regs-&gt;psw.addr
op_assign
id|fixup-&gt;fixup
op_or
id|PSW_ADDR_AMODE
suffix:semicolon
r_else
id|die
c_func
(paren
id|str
comma
id|regs
comma
id|interruption_code
)paren
suffix:semicolon
)brace
)brace
DECL|function|get_check_address
r_static
r_inline
r_void
op_star
id|get_check_address
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
r_return
(paren
r_void
op_star
)paren
(paren
(paren
id|regs-&gt;psw.addr
op_minus
id|S390_lowcore.pgm_ilc
)paren
op_amp
id|PSW_ADDR_INSN
)paren
suffix:semicolon
)brace
DECL|function|do_single_step
r_void
id|do_single_step
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
r_if
c_cond
(paren
(paren
id|current-&gt;ptrace
op_amp
id|PT_PTRACED
)paren
op_ne
l_int|0
)paren
id|force_sig
c_func
(paren
id|SIGTRAP
comma
id|current
)paren
suffix:semicolon
)brace
id|asmlinkage
r_void
DECL|function|default_trap_handler
id|default_trap_handler
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
comma
r_int
id|interruption_code
)paren
(brace
r_if
c_cond
(paren
id|regs-&gt;psw.mask
op_amp
id|PSW_MASK_PSTATE
)paren
(brace
id|local_irq_enable
c_func
(paren
)paren
suffix:semicolon
id|do_exit
c_func
(paren
id|SIGSEGV
)paren
suffix:semicolon
id|report_user_fault
c_func
(paren
id|interruption_code
comma
id|regs
)paren
suffix:semicolon
)brace
r_else
id|die
c_func
(paren
l_string|&quot;Unknown program exception&quot;
comma
id|regs
comma
id|interruption_code
)paren
suffix:semicolon
)brace
DECL|macro|DO_ERROR_INFO
mdefine_line|#define DO_ERROR_INFO(signr, str, name, sicode, siaddr) &bslash;&n;asmlinkage void name(struct pt_regs * regs, long interruption_code) &bslash;&n;{ &bslash;&n;        siginfo_t info; &bslash;&n;        info.si_signo = signr; &bslash;&n;        info.si_errno = 0; &bslash;&n;        info.si_code = sicode; &bslash;&n;        info.si_addr = (void *)siaddr; &bslash;&n;        do_trap(interruption_code, signr, str, regs, &amp;info); &bslash;&n;}
id|DO_ERROR_INFO
c_func
(paren
id|SIGILL
comma
l_string|&quot;addressing exception&quot;
comma
id|addressing_exception
comma
id|ILL_ILLADR
comma
id|get_check_address
c_func
(paren
id|regs
)paren
)paren
id|DO_ERROR_INFO
c_func
(paren
id|SIGILL
comma
l_string|&quot;execute exception&quot;
comma
id|execute_exception
comma
id|ILL_ILLOPN
comma
id|get_check_address
c_func
(paren
id|regs
)paren
)paren
id|DO_ERROR_INFO
c_func
(paren
id|SIGFPE
comma
l_string|&quot;fixpoint divide exception&quot;
comma
id|divide_exception
comma
id|FPE_INTDIV
comma
id|get_check_address
c_func
(paren
id|regs
)paren
)paren
id|DO_ERROR_INFO
c_func
(paren
id|SIGFPE
comma
l_string|&quot;fixpoint overflow exception&quot;
comma
id|overflow_exception
comma
id|FPE_INTOVF
comma
id|get_check_address
c_func
(paren
id|regs
)paren
)paren
id|DO_ERROR_INFO
c_func
(paren
id|SIGFPE
comma
l_string|&quot;HFP overflow exception&quot;
comma
id|hfp_overflow_exception
comma
id|FPE_FLTOVF
comma
id|get_check_address
c_func
(paren
id|regs
)paren
)paren
id|DO_ERROR_INFO
c_func
(paren
id|SIGFPE
comma
l_string|&quot;HFP underflow exception&quot;
comma
id|hfp_underflow_exception
comma
id|FPE_FLTUND
comma
id|get_check_address
c_func
(paren
id|regs
)paren
)paren
id|DO_ERROR_INFO
c_func
(paren
id|SIGFPE
comma
l_string|&quot;HFP significance exception&quot;
comma
id|hfp_significance_exception
comma
id|FPE_FLTRES
comma
id|get_check_address
c_func
(paren
id|regs
)paren
)paren
id|DO_ERROR_INFO
c_func
(paren
id|SIGFPE
comma
l_string|&quot;HFP divide exception&quot;
comma
id|hfp_divide_exception
comma
id|FPE_FLTDIV
comma
id|get_check_address
c_func
(paren
id|regs
)paren
)paren
id|DO_ERROR_INFO
c_func
(paren
id|SIGFPE
comma
l_string|&quot;HFP square root exception&quot;
comma
id|hfp_sqrt_exception
comma
id|FPE_FLTINV
comma
id|get_check_address
c_func
(paren
id|regs
)paren
)paren
id|DO_ERROR_INFO
c_func
(paren
id|SIGILL
comma
l_string|&quot;operand exception&quot;
comma
id|operand_exception
comma
id|ILL_ILLOPN
comma
id|get_check_address
c_func
(paren
id|regs
)paren
)paren
id|DO_ERROR_INFO
c_func
(paren
id|SIGILL
comma
l_string|&quot;privileged operation&quot;
comma
id|privileged_op
comma
id|ILL_PRVOPC
comma
id|get_check_address
c_func
(paren
id|regs
)paren
)paren
id|DO_ERROR_INFO
c_func
(paren
id|SIGILL
comma
l_string|&quot;special operation exception&quot;
comma
id|special_op_exception
comma
id|ILL_ILLOPN
comma
id|get_check_address
c_func
(paren
id|regs
)paren
)paren
id|DO_ERROR_INFO
c_func
(paren
id|SIGILL
comma
l_string|&quot;translation exception&quot;
comma
id|translation_exception
comma
id|ILL_ILLOPN
comma
id|get_check_address
c_func
(paren
id|regs
)paren
)paren
r_static
r_inline
r_void
DECL|function|do_fp_trap
id|do_fp_trap
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
comma
r_void
op_star
id|location
comma
r_int
id|fpc
comma
r_int
id|interruption_code
)paren
(brace
id|siginfo_t
id|si
suffix:semicolon
id|si.si_signo
op_assign
id|SIGFPE
suffix:semicolon
id|si.si_errno
op_assign
l_int|0
suffix:semicolon
id|si.si_addr
op_assign
id|location
suffix:semicolon
id|si.si_code
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* FPC[2] is Data Exception Code */
r_if
c_cond
(paren
(paren
id|fpc
op_amp
l_int|0x00000300
)paren
op_eq
l_int|0
)paren
(brace
multiline_comment|/* bits 6 and 7 of DXC are 0 iff IEEE exception */
r_if
c_cond
(paren
id|fpc
op_amp
l_int|0x8000
)paren
multiline_comment|/* invalid fp operation */
id|si.si_code
op_assign
id|FPE_FLTINV
suffix:semicolon
r_else
r_if
c_cond
(paren
id|fpc
op_amp
l_int|0x4000
)paren
multiline_comment|/* div by 0 */
id|si.si_code
op_assign
id|FPE_FLTDIV
suffix:semicolon
r_else
r_if
c_cond
(paren
id|fpc
op_amp
l_int|0x2000
)paren
multiline_comment|/* overflow */
id|si.si_code
op_assign
id|FPE_FLTOVF
suffix:semicolon
r_else
r_if
c_cond
(paren
id|fpc
op_amp
l_int|0x1000
)paren
multiline_comment|/* underflow */
id|si.si_code
op_assign
id|FPE_FLTUND
suffix:semicolon
r_else
r_if
c_cond
(paren
id|fpc
op_amp
l_int|0x0800
)paren
multiline_comment|/* inexact */
id|si.si_code
op_assign
id|FPE_FLTRES
suffix:semicolon
)brace
id|current-&gt;thread.ieee_instruction_pointer
op_assign
(paren
id|addr_t
)paren
id|location
suffix:semicolon
id|do_trap
c_func
(paren
id|interruption_code
comma
id|SIGFPE
comma
l_string|&quot;floating point exception&quot;
comma
id|regs
comma
op_amp
id|si
)paren
suffix:semicolon
)brace
DECL|function|illegal_op
id|asmlinkage
r_void
id|illegal_op
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
comma
r_int
id|interruption_code
)paren
(brace
id|siginfo_t
id|info
suffix:semicolon
id|__u8
id|opcode
(braket
l_int|6
)braket
suffix:semicolon
id|__u16
op_star
id|location
suffix:semicolon
r_int
id|signal
op_assign
l_int|0
suffix:semicolon
id|location
op_assign
(paren
id|__u16
op_star
)paren
id|get_check_address
c_func
(paren
id|regs
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * We got all needed information from the lowcore and can&n;&t; * now safely switch on interrupts.&n;&t; */
r_if
c_cond
(paren
id|regs-&gt;psw.mask
op_amp
id|PSW_MASK_PSTATE
)paren
id|local_irq_enable
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|regs-&gt;psw.mask
op_amp
id|PSW_MASK_PSTATE
)paren
(brace
id|get_user
c_func
(paren
op_star
(paren
(paren
id|__u16
op_star
)paren
id|opcode
)paren
comma
(paren
id|__u16
id|__user
op_star
)paren
id|location
)paren
suffix:semicolon
r_if
c_cond
(paren
op_star
(paren
(paren
id|__u16
op_star
)paren
id|opcode
)paren
op_eq
id|S390_BREAKPOINT_U16
)paren
(brace
r_if
c_cond
(paren
id|current-&gt;ptrace
op_amp
id|PT_PTRACED
)paren
id|force_sig
c_func
(paren
id|SIGTRAP
comma
id|current
)paren
suffix:semicolon
r_else
id|signal
op_assign
id|SIGILL
suffix:semicolon
macro_line|#ifdef CONFIG_MATHEMU
)brace
r_else
r_if
c_cond
(paren
id|opcode
(braket
l_int|0
)braket
op_eq
l_int|0xb3
)paren
(brace
id|get_user
c_func
(paren
op_star
(paren
(paren
id|__u16
op_star
)paren
(paren
id|opcode
op_plus
l_int|2
)paren
)paren
comma
id|location
op_plus
l_int|1
)paren
suffix:semicolon
id|signal
op_assign
id|math_emu_b3
c_func
(paren
id|opcode
comma
id|regs
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|opcode
(braket
l_int|0
)braket
op_eq
l_int|0xed
)paren
(brace
id|get_user
c_func
(paren
op_star
(paren
(paren
id|__u32
op_star
)paren
(paren
id|opcode
op_plus
l_int|2
)paren
)paren
comma
(paren
id|__u32
op_star
)paren
(paren
id|location
op_plus
l_int|1
)paren
)paren
suffix:semicolon
id|signal
op_assign
id|math_emu_ed
c_func
(paren
id|opcode
comma
id|regs
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_star
(paren
(paren
id|__u16
op_star
)paren
id|opcode
)paren
op_eq
l_int|0xb299
)paren
(brace
id|get_user
c_func
(paren
op_star
(paren
(paren
id|__u16
op_star
)paren
(paren
id|opcode
op_plus
l_int|2
)paren
)paren
comma
id|location
op_plus
l_int|1
)paren
suffix:semicolon
id|signal
op_assign
id|math_emu_srnm
c_func
(paren
id|opcode
comma
id|regs
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_star
(paren
(paren
id|__u16
op_star
)paren
id|opcode
)paren
op_eq
l_int|0xb29c
)paren
(brace
id|get_user
c_func
(paren
op_star
(paren
(paren
id|__u16
op_star
)paren
(paren
id|opcode
op_plus
l_int|2
)paren
)paren
comma
id|location
op_plus
l_int|1
)paren
suffix:semicolon
id|signal
op_assign
id|math_emu_stfpc
c_func
(paren
id|opcode
comma
id|regs
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_star
(paren
(paren
id|__u16
op_star
)paren
id|opcode
)paren
op_eq
l_int|0xb29d
)paren
(brace
id|get_user
c_func
(paren
op_star
(paren
(paren
id|__u16
op_star
)paren
(paren
id|opcode
op_plus
l_int|2
)paren
)paren
comma
id|location
op_plus
l_int|1
)paren
suffix:semicolon
id|signal
op_assign
id|math_emu_lfpc
c_func
(paren
id|opcode
comma
id|regs
)paren
suffix:semicolon
macro_line|#endif
)brace
r_else
id|signal
op_assign
id|SIGILL
suffix:semicolon
)brace
r_else
id|signal
op_assign
id|SIGILL
suffix:semicolon
macro_line|#ifdef CONFIG_MATHEMU
r_if
c_cond
(paren
id|signal
op_eq
id|SIGFPE
)paren
id|do_fp_trap
c_func
(paren
id|regs
comma
id|location
comma
id|current-&gt;thread.fp_regs.fpc
comma
id|interruption_code
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|signal
op_eq
id|SIGSEGV
)paren
(brace
id|info.si_signo
op_assign
id|signal
suffix:semicolon
id|info.si_errno
op_assign
l_int|0
suffix:semicolon
id|info.si_code
op_assign
id|SEGV_MAPERR
suffix:semicolon
id|info.si_addr
op_assign
(paren
r_void
op_star
)paren
id|location
suffix:semicolon
id|do_trap
c_func
(paren
id|interruption_code
comma
id|signal
comma
l_string|&quot;user address fault&quot;
comma
id|regs
comma
op_amp
id|info
)paren
suffix:semicolon
)brace
r_else
macro_line|#endif
r_if
c_cond
(paren
id|signal
)paren
(brace
id|info.si_signo
op_assign
id|signal
suffix:semicolon
id|info.si_errno
op_assign
l_int|0
suffix:semicolon
id|info.si_code
op_assign
id|ILL_ILLOPC
suffix:semicolon
id|info.si_addr
op_assign
(paren
r_void
op_star
)paren
id|location
suffix:semicolon
id|do_trap
c_func
(paren
id|interruption_code
comma
id|signal
comma
l_string|&quot;illegal operation&quot;
comma
id|regs
comma
op_amp
id|info
)paren
suffix:semicolon
)brace
)brace
macro_line|#ifdef CONFIG_MATHEMU
id|asmlinkage
r_void
DECL|function|specification_exception
id|specification_exception
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
comma
r_int
id|interruption_code
)paren
(brace
id|__u8
id|opcode
(braket
l_int|6
)braket
suffix:semicolon
id|__u16
op_star
id|location
op_assign
l_int|NULL
suffix:semicolon
r_int
id|signal
op_assign
l_int|0
suffix:semicolon
id|location
op_assign
(paren
id|__u16
op_star
)paren
id|get_check_address
c_func
(paren
id|regs
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * We got all needed information from the lowcore and can&n;&t; * now safely switch on interrupts.&n;&t; */
r_if
c_cond
(paren
id|regs-&gt;psw.mask
op_amp
id|PSW_MASK_PSTATE
)paren
id|local_irq_enable
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|regs-&gt;psw.mask
op_amp
id|PSW_MASK_PSTATE
)paren
(brace
id|get_user
c_func
(paren
op_star
(paren
(paren
id|__u16
op_star
)paren
id|opcode
)paren
comma
id|location
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|opcode
(braket
l_int|0
)braket
)paren
(brace
r_case
l_int|0x28
suffix:colon
multiline_comment|/* LDR Rx,Ry   */
id|signal
op_assign
id|math_emu_ldr
c_func
(paren
id|opcode
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x38
suffix:colon
multiline_comment|/* LER Rx,Ry   */
id|signal
op_assign
id|math_emu_ler
c_func
(paren
id|opcode
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x60
suffix:colon
multiline_comment|/* STD R,D(X,B) */
id|get_user
c_func
(paren
op_star
(paren
(paren
id|__u16
op_star
)paren
(paren
id|opcode
op_plus
l_int|2
)paren
)paren
comma
id|location
op_plus
l_int|1
)paren
suffix:semicolon
id|signal
op_assign
id|math_emu_std
c_func
(paren
id|opcode
comma
id|regs
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x68
suffix:colon
multiline_comment|/* LD R,D(X,B) */
id|get_user
c_func
(paren
op_star
(paren
(paren
id|__u16
op_star
)paren
(paren
id|opcode
op_plus
l_int|2
)paren
)paren
comma
id|location
op_plus
l_int|1
)paren
suffix:semicolon
id|signal
op_assign
id|math_emu_ld
c_func
(paren
id|opcode
comma
id|regs
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x70
suffix:colon
multiline_comment|/* STE R,D(X,B) */
id|get_user
c_func
(paren
op_star
(paren
(paren
id|__u16
op_star
)paren
(paren
id|opcode
op_plus
l_int|2
)paren
)paren
comma
id|location
op_plus
l_int|1
)paren
suffix:semicolon
id|signal
op_assign
id|math_emu_ste
c_func
(paren
id|opcode
comma
id|regs
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x78
suffix:colon
multiline_comment|/* LE R,D(X,B) */
id|get_user
c_func
(paren
op_star
(paren
(paren
id|__u16
op_star
)paren
(paren
id|opcode
op_plus
l_int|2
)paren
)paren
comma
id|location
op_plus
l_int|1
)paren
suffix:semicolon
id|signal
op_assign
id|math_emu_le
c_func
(paren
id|opcode
comma
id|regs
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|signal
op_assign
id|SIGILL
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_else
id|signal
op_assign
id|SIGILL
suffix:semicolon
r_if
c_cond
(paren
id|signal
op_eq
id|SIGFPE
)paren
id|do_fp_trap
c_func
(paren
id|regs
comma
id|location
comma
id|current-&gt;thread.fp_regs.fpc
comma
id|interruption_code
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|signal
)paren
(brace
id|siginfo_t
id|info
suffix:semicolon
id|info.si_signo
op_assign
id|signal
suffix:semicolon
id|info.si_errno
op_assign
l_int|0
suffix:semicolon
id|info.si_code
op_assign
id|ILL_ILLOPN
suffix:semicolon
id|info.si_addr
op_assign
id|location
suffix:semicolon
id|do_trap
c_func
(paren
id|interruption_code
comma
id|signal
comma
l_string|&quot;specification exception&quot;
comma
id|regs
comma
op_amp
id|info
)paren
suffix:semicolon
)brace
)brace
macro_line|#else
id|DO_ERROR_INFO
c_func
(paren
id|SIGILL
comma
l_string|&quot;specification exception&quot;
comma
id|specification_exception
comma
id|ILL_ILLOPN
comma
id|get_check_address
c_func
(paren
id|regs
)paren
)paren
suffix:semicolon
macro_line|#endif
DECL|function|data_exception
id|asmlinkage
r_void
id|data_exception
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
comma
r_int
id|interruption_code
)paren
(brace
id|__u16
op_star
id|location
suffix:semicolon
r_int
id|signal
op_assign
l_int|0
suffix:semicolon
id|location
op_assign
(paren
id|__u16
op_star
)paren
id|get_check_address
c_func
(paren
id|regs
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * We got all needed information from the lowcore and can&n;&t; * now safely switch on interrupts.&n;&t; */
r_if
c_cond
(paren
id|regs-&gt;psw.mask
op_amp
id|PSW_MASK_PSTATE
)paren
id|local_irq_enable
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|MACHINE_HAS_IEEE
)paren
id|__asm__
r_volatile
(paren
l_string|&quot;stfpc %0&bslash;n&bslash;t&quot;
suffix:colon
l_string|&quot;=m&quot;
(paren
id|current-&gt;thread.fp_regs.fpc
)paren
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_MATHEMU
r_else
r_if
c_cond
(paren
id|regs-&gt;psw.mask
op_amp
id|PSW_MASK_PSTATE
)paren
(brace
id|__u8
id|opcode
(braket
l_int|6
)braket
suffix:semicolon
id|get_user
c_func
(paren
op_star
(paren
(paren
id|__u16
op_star
)paren
id|opcode
)paren
comma
id|location
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|opcode
(braket
l_int|0
)braket
)paren
(brace
r_case
l_int|0x28
suffix:colon
multiline_comment|/* LDR Rx,Ry   */
id|signal
op_assign
id|math_emu_ldr
c_func
(paren
id|opcode
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x38
suffix:colon
multiline_comment|/* LER Rx,Ry   */
id|signal
op_assign
id|math_emu_ler
c_func
(paren
id|opcode
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x60
suffix:colon
multiline_comment|/* STD R,D(X,B) */
id|get_user
c_func
(paren
op_star
(paren
(paren
id|__u16
op_star
)paren
(paren
id|opcode
op_plus
l_int|2
)paren
)paren
comma
id|location
op_plus
l_int|1
)paren
suffix:semicolon
id|signal
op_assign
id|math_emu_std
c_func
(paren
id|opcode
comma
id|regs
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x68
suffix:colon
multiline_comment|/* LD R,D(X,B) */
id|get_user
c_func
(paren
op_star
(paren
(paren
id|__u16
op_star
)paren
(paren
id|opcode
op_plus
l_int|2
)paren
)paren
comma
id|location
op_plus
l_int|1
)paren
suffix:semicolon
id|signal
op_assign
id|math_emu_ld
c_func
(paren
id|opcode
comma
id|regs
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x70
suffix:colon
multiline_comment|/* STE R,D(X,B) */
id|get_user
c_func
(paren
op_star
(paren
(paren
id|__u16
op_star
)paren
(paren
id|opcode
op_plus
l_int|2
)paren
)paren
comma
id|location
op_plus
l_int|1
)paren
suffix:semicolon
id|signal
op_assign
id|math_emu_ste
c_func
(paren
id|opcode
comma
id|regs
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x78
suffix:colon
multiline_comment|/* LE R,D(X,B) */
id|get_user
c_func
(paren
op_star
(paren
(paren
id|__u16
op_star
)paren
(paren
id|opcode
op_plus
l_int|2
)paren
)paren
comma
id|location
op_plus
l_int|1
)paren
suffix:semicolon
id|signal
op_assign
id|math_emu_le
c_func
(paren
id|opcode
comma
id|regs
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0xb3
suffix:colon
id|get_user
c_func
(paren
op_star
(paren
(paren
id|__u16
op_star
)paren
(paren
id|opcode
op_plus
l_int|2
)paren
)paren
comma
id|location
op_plus
l_int|1
)paren
suffix:semicolon
id|signal
op_assign
id|math_emu_b3
c_func
(paren
id|opcode
comma
id|regs
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0xed
suffix:colon
id|get_user
c_func
(paren
op_star
(paren
(paren
id|__u32
op_star
)paren
(paren
id|opcode
op_plus
l_int|2
)paren
)paren
comma
(paren
id|__u32
op_star
)paren
(paren
id|location
op_plus
l_int|1
)paren
)paren
suffix:semicolon
id|signal
op_assign
id|math_emu_ed
c_func
(paren
id|opcode
comma
id|regs
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0xb2
suffix:colon
r_if
c_cond
(paren
id|opcode
(braket
l_int|1
)braket
op_eq
l_int|0x99
)paren
(brace
id|get_user
c_func
(paren
op_star
(paren
(paren
id|__u16
op_star
)paren
(paren
id|opcode
op_plus
l_int|2
)paren
)paren
comma
id|location
op_plus
l_int|1
)paren
suffix:semicolon
id|signal
op_assign
id|math_emu_srnm
c_func
(paren
id|opcode
comma
id|regs
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|opcode
(braket
l_int|1
)braket
op_eq
l_int|0x9c
)paren
(brace
id|get_user
c_func
(paren
op_star
(paren
(paren
id|__u16
op_star
)paren
(paren
id|opcode
op_plus
l_int|2
)paren
)paren
comma
id|location
op_plus
l_int|1
)paren
suffix:semicolon
id|signal
op_assign
id|math_emu_stfpc
c_func
(paren
id|opcode
comma
id|regs
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|opcode
(braket
l_int|1
)braket
op_eq
l_int|0x9d
)paren
(brace
id|get_user
c_func
(paren
op_star
(paren
(paren
id|__u16
op_star
)paren
(paren
id|opcode
op_plus
l_int|2
)paren
)paren
comma
id|location
op_plus
l_int|1
)paren
suffix:semicolon
id|signal
op_assign
id|math_emu_lfpc
c_func
(paren
id|opcode
comma
id|regs
)paren
suffix:semicolon
)brace
r_else
id|signal
op_assign
id|SIGILL
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|signal
op_assign
id|SIGILL
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
macro_line|#endif 
r_if
c_cond
(paren
id|current-&gt;thread.fp_regs.fpc
op_amp
id|FPC_DXC_MASK
)paren
id|signal
op_assign
id|SIGFPE
suffix:semicolon
r_else
id|signal
op_assign
id|SIGILL
suffix:semicolon
r_if
c_cond
(paren
id|signal
op_eq
id|SIGFPE
)paren
id|do_fp_trap
c_func
(paren
id|regs
comma
id|location
comma
id|current-&gt;thread.fp_regs.fpc
comma
id|interruption_code
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|signal
)paren
(brace
id|siginfo_t
id|info
suffix:semicolon
id|info.si_signo
op_assign
id|signal
suffix:semicolon
id|info.si_errno
op_assign
l_int|0
suffix:semicolon
id|info.si_code
op_assign
id|ILL_ILLOPN
suffix:semicolon
id|info.si_addr
op_assign
id|location
suffix:semicolon
id|do_trap
c_func
(paren
id|interruption_code
comma
id|signal
comma
l_string|&quot;data exception&quot;
comma
id|regs
comma
op_amp
id|info
)paren
suffix:semicolon
)brace
)brace
DECL|function|space_switch_exception
id|asmlinkage
r_void
id|space_switch_exception
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
comma
r_int
id|int_code
)paren
(brace
id|siginfo_t
id|info
suffix:semicolon
multiline_comment|/* Set user psw back to home space mode. */
r_if
c_cond
(paren
id|regs-&gt;psw.mask
op_amp
id|PSW_MASK_PSTATE
)paren
id|regs-&gt;psw.mask
op_or_assign
id|PSW_ASC_HOME
suffix:semicolon
multiline_comment|/* Send SIGILL. */
id|info.si_signo
op_assign
id|SIGILL
suffix:semicolon
id|info.si_errno
op_assign
l_int|0
suffix:semicolon
id|info.si_code
op_assign
id|ILL_PRVOPC
suffix:semicolon
id|info.si_addr
op_assign
id|get_check_address
c_func
(paren
id|regs
)paren
suffix:semicolon
id|do_trap
c_func
(paren
id|int_code
comma
id|SIGILL
comma
l_string|&quot;space switch event&quot;
comma
id|regs
comma
op_amp
id|info
)paren
suffix:semicolon
)brace
DECL|function|kernel_stack_overflow
id|asmlinkage
r_void
id|kernel_stack_overflow
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|die
c_func
(paren
l_string|&quot;Kernel stack overflow&quot;
comma
id|regs
comma
l_int|0
)paren
suffix:semicolon
id|panic
c_func
(paren
l_string|&quot;Corrupt kernel stack, can&squot;t continue.&quot;
)paren
suffix:semicolon
)brace
multiline_comment|/* init is done in lowcore.S and head.S */
DECL|function|trap_init
r_void
id|__init
id|trap_init
c_func
(paren
r_void
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|128
suffix:semicolon
id|i
op_increment
)paren
id|pgm_check_table
(braket
id|i
)braket
op_assign
op_amp
id|default_trap_handler
suffix:semicolon
id|pgm_check_table
(braket
l_int|1
)braket
op_assign
op_amp
id|illegal_op
suffix:semicolon
id|pgm_check_table
(braket
l_int|2
)braket
op_assign
op_amp
id|privileged_op
suffix:semicolon
id|pgm_check_table
(braket
l_int|3
)braket
op_assign
op_amp
id|execute_exception
suffix:semicolon
id|pgm_check_table
(braket
l_int|4
)braket
op_assign
op_amp
id|do_protection_exception
suffix:semicolon
id|pgm_check_table
(braket
l_int|5
)braket
op_assign
op_amp
id|addressing_exception
suffix:semicolon
id|pgm_check_table
(braket
l_int|6
)braket
op_assign
op_amp
id|specification_exception
suffix:semicolon
id|pgm_check_table
(braket
l_int|7
)braket
op_assign
op_amp
id|data_exception
suffix:semicolon
id|pgm_check_table
(braket
l_int|8
)braket
op_assign
op_amp
id|overflow_exception
suffix:semicolon
id|pgm_check_table
(braket
l_int|9
)braket
op_assign
op_amp
id|divide_exception
suffix:semicolon
id|pgm_check_table
(braket
l_int|0x0A
)braket
op_assign
op_amp
id|overflow_exception
suffix:semicolon
id|pgm_check_table
(braket
l_int|0x0B
)braket
op_assign
op_amp
id|divide_exception
suffix:semicolon
id|pgm_check_table
(braket
l_int|0x0C
)braket
op_assign
op_amp
id|hfp_overflow_exception
suffix:semicolon
id|pgm_check_table
(braket
l_int|0x0D
)braket
op_assign
op_amp
id|hfp_underflow_exception
suffix:semicolon
id|pgm_check_table
(braket
l_int|0x0E
)braket
op_assign
op_amp
id|hfp_significance_exception
suffix:semicolon
id|pgm_check_table
(braket
l_int|0x0F
)braket
op_assign
op_amp
id|hfp_divide_exception
suffix:semicolon
id|pgm_check_table
(braket
l_int|0x10
)braket
op_assign
op_amp
id|do_dat_exception
suffix:semicolon
id|pgm_check_table
(braket
l_int|0x11
)braket
op_assign
op_amp
id|do_dat_exception
suffix:semicolon
id|pgm_check_table
(braket
l_int|0x12
)braket
op_assign
op_amp
id|translation_exception
suffix:semicolon
id|pgm_check_table
(braket
l_int|0x13
)braket
op_assign
op_amp
id|special_op_exception
suffix:semicolon
macro_line|#ifndef CONFIG_ARCH_S390X
id|pgm_check_table
(braket
l_int|0x14
)braket
op_assign
op_amp
id|do_pseudo_page_fault
suffix:semicolon
macro_line|#else /* CONFIG_ARCH_S390X */
id|pgm_check_table
(braket
l_int|0x38
)braket
op_assign
op_amp
id|do_dat_exception
suffix:semicolon
id|pgm_check_table
(braket
l_int|0x39
)braket
op_assign
op_amp
id|do_dat_exception
suffix:semicolon
id|pgm_check_table
(braket
l_int|0x3A
)braket
op_assign
op_amp
id|do_dat_exception
suffix:semicolon
id|pgm_check_table
(braket
l_int|0x3B
)braket
op_assign
op_amp
id|do_dat_exception
suffix:semicolon
macro_line|#endif /* CONFIG_ARCH_S390X */
id|pgm_check_table
(braket
l_int|0x15
)braket
op_assign
op_amp
id|operand_exception
suffix:semicolon
id|pgm_check_table
(braket
l_int|0x1C
)braket
op_assign
op_amp
id|space_switch_exception
suffix:semicolon
id|pgm_check_table
(braket
l_int|0x1D
)braket
op_assign
op_amp
id|hfp_sqrt_exception
suffix:semicolon
id|pgm_check_table
(braket
l_int|0x40
)braket
op_assign
op_amp
id|do_monitor_call
suffix:semicolon
r_if
c_cond
(paren
id|MACHINE_IS_VM
)paren
(brace
multiline_comment|/*&n;&t;&t; * First try to get pfault pseudo page faults going.&n;&t;&t; * If this isn&squot;t available turn on pagex page faults.&n;&t;&t; */
macro_line|#ifdef CONFIG_PFAULT
multiline_comment|/* request the 0x2603 external interrupt */
r_if
c_cond
(paren
id|register_early_external_interrupt
c_func
(paren
l_int|0x2603
comma
id|pfault_interrupt
comma
op_amp
id|ext_int_pfault
)paren
op_ne
l_int|0
)paren
id|panic
c_func
(paren
l_string|&quot;Couldn&squot;t request external interrupt 0x2603&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pfault_init
c_func
(paren
)paren
op_eq
l_int|0
)paren
r_return
suffix:semicolon
multiline_comment|/* Tough luck, no pfault. */
id|unregister_early_external_interrupt
c_func
(paren
l_int|0x2603
comma
id|pfault_interrupt
comma
op_amp
id|ext_int_pfault
)paren
suffix:semicolon
macro_line|#endif
macro_line|#ifndef CONFIG_ARCH_S390X
id|cpcmd
c_func
(paren
l_string|&quot;SET PAGEX ON&quot;
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
macro_line|#endif
)brace
)brace
eof
