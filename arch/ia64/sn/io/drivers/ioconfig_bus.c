multiline_comment|/*&n; * This file is subject to the terms and conditions of the GNU General Public&n; * License.  See the file &quot;COPYING&quot; in the main directory of this archive&n; * for more details.&n; *&n; *  ioconfig_bus - SGI&squot;s Persistent PCI Bus Numbering.&n; *&n; * Copyright (C) 1992-1997, 2000-2003 Silicon Graphics, Inc.  All rights reserved.&n; */
macro_line|#include &lt;linux/types.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;linux/ctype.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/pci.h&gt;
macro_line|#include &lt;asm/sn/sgi.h&gt;
macro_line|#include &lt;linux/devfs_fs.h&gt;
macro_line|#include &lt;linux/devfs_fs_kernel.h&gt;
macro_line|#include &lt;asm/io.h&gt;
macro_line|#include &lt;asm/sn/iograph.h&gt;
macro_line|#include &lt;asm/sn/invent.h&gt;
macro_line|#include &lt;asm/sn/hcl.h&gt;
macro_line|#include &lt;asm/sn/labelcl.h&gt;
macro_line|#include &lt;asm
singleline_comment|//sn/sn_sal.h&gt;
macro_line|#include &lt;asm/sn/addrs.h&gt;
macro_line|#include &lt;asm/sn/ioconfig_bus.h&gt;
DECL|macro|SGI_IOCONFIG_BUS
mdefine_line|#define SGI_IOCONFIG_BUS &quot;SGI-PERSISTENT PCI BUS NUMBERING&quot;
DECL|macro|SGI_IOCONFIG_BUS_VERSION
mdefine_line|#define SGI_IOCONFIG_BUS_VERSION &quot;1.0&quot;
multiline_comment|/*&n; * Some Global definitions.&n; */
DECL|variable|ioconfig_bus_handle
r_static
id|vertex_hdl_t
id|ioconfig_bus_handle
suffix:semicolon
DECL|variable|ioconfig_bus_debug
r_static
r_int
r_int
id|ioconfig_bus_debug
suffix:semicolon
macro_line|#ifdef IOCONFIG_BUS_DEBUG
DECL|macro|DBG
mdefine_line|#define DBG(x...)&t;printk(x)
macro_line|#else
DECL|macro|DBG
mdefine_line|#define DBG(x...)
macro_line|#endif
DECL|variable|ioconfig_file
r_static
id|u64
id|ioconfig_file
suffix:semicolon
DECL|variable|ioconfig_file_size
r_static
id|u64
id|ioconfig_file_size
suffix:semicolon
DECL|variable|ioconfig_activated
r_static
id|u64
id|ioconfig_activated
suffix:semicolon
DECL|variable|ioconfig_kernopts
r_static
r_char
id|ioconfig_kernopts
(braket
l_int|128
)braket
suffix:semicolon
multiline_comment|/*&n; * For debugging purpose .. hardcode a table ..&n; */
DECL|variable|ioconfig_bus_table
r_struct
id|ascii_moduleid
op_star
id|ioconfig_bus_table
suffix:semicolon
DECL|variable|ioconfig_bus_table_size
id|u64
id|ioconfig_bus_table_size
suffix:semicolon
DECL|variable|free_entry
r_static
r_int
id|free_entry
suffix:semicolon
DECL|variable|new_entry
r_static
r_int
id|new_entry
suffix:semicolon
DECL|variable|next_basebus_number
r_int
id|next_basebus_number
suffix:semicolon
r_void
DECL|function|ioconfig_get_busnum
id|ioconfig_get_busnum
c_func
(paren
r_char
op_star
id|io_moduleid
comma
r_int
op_star
id|bus_num
)paren
(brace
r_struct
id|ascii_moduleid
op_star
id|temp
suffix:semicolon
r_int
id|index
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;ioconfig_get_busnum io_moduleid %s&bslash;n&quot;
comma
id|io_moduleid
)paren
suffix:semicolon
op_star
id|bus_num
op_assign
op_minus
l_int|1
suffix:semicolon
id|temp
op_assign
id|ioconfig_bus_table
suffix:semicolon
r_for
c_loop
(paren
id|index
op_assign
l_int|0
suffix:semicolon
id|index
OL
id|free_entry
suffix:semicolon
id|temp
op_increment
comma
id|index
op_increment
)paren
(brace
r_if
c_cond
(paren
(paren
id|io_moduleid
(braket
l_int|0
)braket
op_eq
id|temp-&gt;io_moduleid
(braket
l_int|0
)braket
)paren
op_logical_and
(paren
id|io_moduleid
(braket
l_int|1
)braket
op_eq
id|temp-&gt;io_moduleid
(braket
l_int|1
)braket
)paren
op_logical_and
(paren
id|io_moduleid
(braket
l_int|2
)braket
op_eq
id|temp-&gt;io_moduleid
(braket
l_int|2
)braket
)paren
op_logical_and
(paren
id|io_moduleid
(braket
l_int|4
)braket
op_eq
id|temp-&gt;io_moduleid
(braket
l_int|4
)braket
)paren
op_logical_and
(paren
id|io_moduleid
(braket
l_int|5
)braket
op_eq
id|temp-&gt;io_moduleid
(braket
l_int|5
)braket
)paren
)paren
(brace
op_star
id|bus_num
op_assign
id|index
op_star
l_int|0x10
suffix:semicolon
r_return
suffix:semicolon
)brace
)brace
multiline_comment|/*&n;&t; * New IO Brick encountered.&n;&t; */
r_if
c_cond
(paren
(paren
(paren
r_int
)paren
id|io_moduleid
(braket
l_int|0
)braket
)paren
op_eq
l_int|0
)paren
(brace
id|DBG
c_func
(paren
l_string|&quot;ioconfig_get_busnum: Invalid Module Id given %s&bslash;n&quot;
comma
id|io_moduleid
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|io_moduleid
(braket
l_int|3
)braket
op_assign
l_char|&squot;#&squot;
suffix:semicolon
id|strcpy
c_func
(paren
(paren
r_char
op_star
)paren
op_amp
(paren
id|ioconfig_bus_table
(braket
id|free_entry
)braket
dot
id|io_moduleid
)paren
comma
id|io_moduleid
)paren
suffix:semicolon
op_star
id|bus_num
op_assign
id|free_entry
op_star
l_int|0x10
suffix:semicolon
id|free_entry
op_increment
suffix:semicolon
)brace
r_static
r_void
DECL|function|dump_ioconfig_table
id|dump_ioconfig_table
c_func
(paren
r_void
)paren
(brace
r_int
id|index
op_assign
l_int|0
suffix:semicolon
r_struct
id|ascii_moduleid
op_star
id|temp
suffix:semicolon
id|temp
op_assign
id|ioconfig_bus_table
suffix:semicolon
r_while
c_loop
(paren
id|index
OL
id|free_entry
)paren
(brace
id|DBG
c_func
(paren
l_string|&quot;ASSCI Module ID %s&bslash;n&quot;
comma
id|temp-&gt;io_moduleid
)paren
suffix:semicolon
id|temp
op_increment
suffix:semicolon
id|index
op_increment
suffix:semicolon
)brace
)brace
multiline_comment|/*&n; * nextline&n; *&t;This routine returns the nextline in the buffer.&n; */
DECL|function|nextline
r_int
id|nextline
c_func
(paren
r_char
op_star
id|buffer
comma
r_char
op_star
op_star
id|next
comma
r_char
op_star
id|line
)paren
(brace
r_char
op_star
id|temp
suffix:semicolon
r_if
c_cond
(paren
id|buffer
(braket
l_int|0
)braket
op_eq
l_int|0x0
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
id|temp
op_assign
id|buffer
suffix:semicolon
r_while
c_loop
(paren
op_star
id|temp
op_ne
l_int|0
)paren
(brace
op_star
id|line
op_assign
op_star
id|temp
suffix:semicolon
r_if
c_cond
(paren
op_star
id|temp
op_ne
l_char|&squot;&bslash;n&squot;
)paren
(brace
op_star
id|line
op_assign
op_star
id|temp
suffix:semicolon
id|temp
op_increment
suffix:semicolon
id|line
op_increment
suffix:semicolon
)brace
r_else
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
op_star
id|temp
op_eq
l_int|0
)paren
op_star
id|next
op_assign
id|temp
suffix:semicolon
r_else
op_star
id|next
op_assign
op_increment
id|temp
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
multiline_comment|/*&n; * build_pcibus_name&n; *&t;This routine parses the ioconfig contents read into&n; *&t;memory by ioconfig command in EFI and builds the&n; *&t;persistent pci bus naming table.&n; */
r_void
DECL|function|build_moduleid_table
id|build_moduleid_table
c_func
(paren
r_char
op_star
id|file_contents
comma
r_struct
id|ascii_moduleid
op_star
id|table
)paren
(brace
multiline_comment|/*&n;&t; * Read the whole file into memory.&n;&t; */
r_int
id|rc
suffix:semicolon
r_char
op_star
id|name
suffix:semicolon
r_char
op_star
id|temp
suffix:semicolon
r_char
op_star
id|next
suffix:semicolon
r_char
op_star
id|current
suffix:semicolon
r_char
op_star
id|line
suffix:semicolon
r_struct
id|ascii_moduleid
op_star
id|moduleid
suffix:semicolon
id|line
op_assign
id|kmalloc
c_func
(paren
l_int|256
comma
id|GFP_KERNEL
)paren
suffix:semicolon
id|memset
c_func
(paren
id|line
comma
l_int|0
comma
l_int|256
)paren
suffix:semicolon
id|name
op_assign
id|kmalloc
c_func
(paren
l_int|125
comma
id|GFP_KERNEL
)paren
suffix:semicolon
id|memset
c_func
(paren
id|name
comma
l_int|0
comma
l_int|125
)paren
suffix:semicolon
id|moduleid
op_assign
id|table
suffix:semicolon
id|current
op_assign
id|file_contents
suffix:semicolon
r_while
c_loop
(paren
id|nextline
c_func
(paren
id|current
comma
op_amp
id|next
comma
id|line
)paren
)paren
(brace
id|DBG
c_func
(paren
l_string|&quot;current 0x%lx next 0x%lx&bslash;n&quot;
comma
id|current
comma
id|next
)paren
suffix:semicolon
id|temp
op_assign
id|line
suffix:semicolon
multiline_comment|/*&n;&t;&t; * Skip all leading Blank lines ..&n;&t;&t; */
r_while
c_loop
(paren
id|isspace
c_func
(paren
op_star
id|temp
)paren
)paren
r_if
c_cond
(paren
op_star
id|temp
op_ne
l_char|&squot;&bslash;n&squot;
)paren
id|temp
op_increment
suffix:semicolon
r_else
r_break
suffix:semicolon
r_if
c_cond
(paren
op_star
id|temp
op_eq
l_char|&squot;&bslash;n&squot;
)paren
(brace
id|current
op_assign
id|next
suffix:semicolon
id|memset
c_func
(paren
id|line
comma
l_int|0
comma
l_int|256
)paren
suffix:semicolon
r_continue
suffix:semicolon
)brace
multiline_comment|/*&n;&t;&t; * Skip comment lines&n;&t;&t; */
r_if
c_cond
(paren
op_star
id|temp
op_eq
l_char|&squot;#&squot;
)paren
(brace
id|current
op_assign
id|next
suffix:semicolon
id|memset
c_func
(paren
id|line
comma
l_int|0
comma
l_int|256
)paren
suffix:semicolon
r_continue
suffix:semicolon
)brace
multiline_comment|/*&n;&t;&t; * Get the next free entry in the table.&n;&t;&t; */
id|rc
op_assign
id|sscanf
c_func
(paren
id|temp
comma
l_string|&quot;%s&quot;
comma
id|name
)paren
suffix:semicolon
id|strcpy
c_func
(paren
op_amp
id|moduleid-&gt;io_moduleid
(braket
l_int|0
)braket
comma
id|name
)paren
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;Found %s&bslash;n&quot;
comma
id|name
)paren
suffix:semicolon
id|moduleid
op_increment
suffix:semicolon
id|free_entry
op_increment
suffix:semicolon
id|current
op_assign
id|next
suffix:semicolon
id|memset
c_func
(paren
id|line
comma
l_int|0
comma
l_int|256
)paren
suffix:semicolon
)brace
id|new_entry
op_assign
id|free_entry
suffix:semicolon
id|kfree
c_func
(paren
id|line
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|name
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_void
DECL|function|ioconfig_bus_init
id|ioconfig_bus_init
c_func
(paren
r_void
)paren
(brace
r_struct
id|ia64_sal_retval
id|ret_stuff
suffix:semicolon
id|u64
op_star
id|temp
suffix:semicolon
r_int
id|cnode
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;ioconfig_bus_init called.&bslash;n&quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|cnode
op_assign
l_int|0
suffix:semicolon
id|cnode
OL
id|numnodes
suffix:semicolon
id|cnode
op_increment
)paren
(brace
id|nasid_t
id|nasid
suffix:semicolon
multiline_comment|/*&n;&t; &t; * Make SAL call to get the address of the bus configuration table.&n;&t; &t; */
id|ret_stuff.status
op_assign
(paren
r_uint64
)paren
l_int|0
suffix:semicolon
id|ret_stuff.v0
op_assign
(paren
r_uint64
)paren
l_int|0
suffix:semicolon
id|ret_stuff.v1
op_assign
(paren
r_uint64
)paren
l_int|0
suffix:semicolon
id|ret_stuff.v2
op_assign
(paren
r_uint64
)paren
l_int|0
suffix:semicolon
id|nasid
op_assign
id|COMPACT_TO_NASID_NODEID
c_func
(paren
id|cnode
)paren
suffix:semicolon
id|SAL_CALL
c_func
(paren
id|ret_stuff
comma
id|SN_SAL_BUS_CONFIG
comma
l_int|0
comma
id|nasid
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
id|temp
op_assign
(paren
id|u64
op_star
)paren
id|TO_NODE_CAC
c_func
(paren
id|nasid
comma
id|ret_stuff.v0
)paren
suffix:semicolon
id|ioconfig_file
op_assign
op_star
id|temp
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;ioconfig_bus_init: Nasid %d ret_stuff.v0 0x%lx&bslash;n&quot;
comma
id|nasid
comma
id|ret_stuff.v0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ioconfig_file
)paren
(brace
id|ioconfig_file_size
op_assign
id|ret_stuff.v1
suffix:semicolon
id|ioconfig_file
op_assign
(paren
id|ioconfig_file
op_or
id|CACHEABLE_MEM_SPACE
)paren
suffix:semicolon
id|ioconfig_activated
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
id|DBG
c_func
(paren
l_string|&quot;ioconfig_bus_init: ret_stuff.v0 %p ioconfig_file %p %d&bslash;n&quot;
comma
id|ret_stuff.v0
comma
(paren
r_void
op_star
)paren
id|ioconfig_file
comma
(paren
r_int
)paren
id|ioconfig_file_size
)paren
suffix:semicolon
id|ioconfig_bus_table
op_assign
id|kmalloc
c_func
(paren
l_int|512
comma
id|GFP_KERNEL
)paren
suffix:semicolon
id|memset
c_func
(paren
id|ioconfig_bus_table
comma
l_int|0
comma
l_int|512
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * If ioconfig options are given on the bootline .. take it.&n;&t; */
r_if
c_cond
(paren
op_star
id|ioconfig_kernopts
op_ne
l_char|&squot;&bslash;0&squot;
)paren
(brace
multiline_comment|/*&n;&t;&t; * ioconfig=&quot;...&quot; kernel options given.&n;&t;&t; */
id|DBG
c_func
(paren
l_string|&quot;ioconfig_bus_init: Kernel Options given.&bslash;n&quot;
)paren
suffix:semicolon
(paren
r_void
)paren
id|build_moduleid_table
c_func
(paren
(paren
r_char
op_star
)paren
id|ioconfig_kernopts
comma
id|ioconfig_bus_table
)paren
suffix:semicolon
(paren
r_void
)paren
id|dump_ioconfig_table
c_func
(paren
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ioconfig_activated
)paren
(brace
id|DBG
c_func
(paren
l_string|&quot;ioconfig_bus_init: ioconfig file given.&bslash;n&quot;
)paren
suffix:semicolon
(paren
r_void
)paren
id|build_moduleid_table
c_func
(paren
(paren
r_char
op_star
)paren
id|ioconfig_file
comma
id|ioconfig_bus_table
)paren
suffix:semicolon
(paren
r_void
)paren
id|dump_ioconfig_table
c_func
(paren
)paren
suffix:semicolon
)brace
r_else
(brace
id|DBG
c_func
(paren
l_string|&quot;ioconfig_bus_init: ioconfig command not executed in prom&bslash;n&quot;
)paren
suffix:semicolon
)brace
)brace
r_void
DECL|function|ioconfig_bus_new_entries
id|ioconfig_bus_new_entries
c_func
(paren
r_void
)paren
(brace
r_int
id|index
op_assign
l_int|0
suffix:semicolon
r_struct
id|ascii_moduleid
op_star
id|temp
suffix:semicolon
r_if
c_cond
(paren
(paren
id|ioconfig_activated
)paren
op_logical_and
(paren
id|free_entry
OG
id|new_entry
)paren
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;### Please add the following new IO Bricks Module ID &bslash;n&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;### to your Persistent Bus Numbering Config File&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_else
r_return
suffix:semicolon
id|index
op_assign
id|new_entry
suffix:semicolon
id|temp
op_assign
op_amp
id|ioconfig_bus_table
(braket
id|index
)braket
suffix:semicolon
r_while
c_loop
(paren
id|index
OL
id|free_entry
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
(paren
r_char
op_star
)paren
id|temp
)paren
suffix:semicolon
id|temp
op_increment
suffix:semicolon
id|index
op_increment
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;### End&bslash;n&quot;
)paren
suffix:semicolon
)brace
DECL|function|ioconfig_bus_ioctl
r_static
r_int
id|ioconfig_bus_ioctl
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
comma
r_int
r_int
id|cmd
comma
r_int
r_int
id|arg
)paren
(brace
r_struct
id|ioconfig_parm
id|parm
suffix:semicolon
multiline_comment|/*&n;&t; * Copy in the parameters.&n;&t; */
id|copy_from_user
c_func
(paren
op_amp
id|parm
comma
(paren
r_char
op_star
)paren
id|arg
comma
r_sizeof
(paren
r_struct
id|ioconfig_parm
)paren
)paren
suffix:semicolon
id|parm.number
op_assign
id|free_entry
op_minus
id|new_entry
suffix:semicolon
id|parm.ioconfig_activated
op_assign
id|ioconfig_activated
suffix:semicolon
id|copy_to_user
c_func
(paren
(paren
r_char
op_star
)paren
id|arg
comma
op_amp
id|parm
comma
r_sizeof
(paren
r_struct
id|ioconfig_parm
)paren
)paren
suffix:semicolon
id|copy_to_user
c_func
(paren
(paren
r_char
op_star
)paren
id|parm.buffer
comma
op_amp
id|ioconfig_bus_table
(braket
id|new_entry
)braket
comma
r_sizeof
(paren
r_struct
id|ascii_moduleid
)paren
op_star
(paren
id|free_entry
op_minus
id|new_entry
)paren
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * ioconfig_bus_open - Opens the special device node &quot;/dev/hw/.ioconfig_bus&quot;.&n; */
DECL|function|ioconfig_bus_open
r_static
r_int
id|ioconfig_bus_open
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|filp
)paren
(brace
r_if
c_cond
(paren
id|ioconfig_bus_debug
)paren
(brace
id|DBG
c_func
(paren
l_string|&quot;ioconfig_bus_open called.&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * ioconfig_bus_close - Closes the special device node &quot;/dev/hw/.ioconfig_bus&quot;.&n; */
DECL|function|ioconfig_bus_close
r_static
r_int
id|ioconfig_bus_close
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|filp
)paren
(brace
r_if
c_cond
(paren
id|ioconfig_bus_debug
)paren
(brace
id|DBG
c_func
(paren
l_string|&quot;ioconfig_bus_close called.&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|ioconfig_bus_fops
r_struct
id|file_operations
id|ioconfig_bus_fops
op_assign
(brace
dot
id|ioctl
op_assign
id|ioconfig_bus_ioctl
comma
dot
id|open
op_assign
id|ioconfig_bus_open
comma
multiline_comment|/* open */
dot
id|release
op_assign
id|ioconfig_bus_close
multiline_comment|/* release */
)brace
suffix:semicolon
multiline_comment|/*&n; * init_ifconfig_bus() - Boot time initialization.  Ensure that it is called &n; *&t;after devfs has been initialized.&n; *&n; */
DECL|function|init_ioconfig_bus
r_int
id|init_ioconfig_bus
c_func
(paren
r_void
)paren
(brace
id|ioconfig_bus_handle
op_assign
l_int|NULL
suffix:semicolon
id|ioconfig_bus_handle
op_assign
id|hwgraph_register
c_func
(paren
id|hwgraph_root
comma
l_string|&quot;.ioconfig_bus&quot;
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
id|S_IFCHR
op_or
id|S_IRUSR
op_or
id|S_IWUSR
op_or
id|S_IRGRP
comma
l_int|0
comma
l_int|0
comma
op_amp
id|ioconfig_bus_fops
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ioconfig_bus_handle
op_eq
l_int|NULL
)paren
(brace
id|panic
c_func
(paren
l_string|&quot;Unable to create SGI PERSISTENT BUS NUMBERING Driver.&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|ioconfig_bus_setup
r_static
r_int
id|__init
id|ioconfig_bus_setup
(paren
r_char
op_star
id|str
)paren
(brace
r_char
op_star
id|temp
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;ioconfig_bus_setup: Kernel Options %s&bslash;n&quot;
comma
id|str
)paren
suffix:semicolon
id|temp
op_assign
(paren
r_char
op_star
)paren
id|ioconfig_kernopts
suffix:semicolon
id|memset
c_func
(paren
id|temp
comma
l_int|0
comma
l_int|128
)paren
suffix:semicolon
r_while
c_loop
(paren
(paren
op_star
id|str
op_ne
l_char|&squot;&bslash;0&squot;
)paren
op_logical_and
op_logical_neg
id|isspace
(paren
op_star
id|str
)paren
)paren
(brace
r_if
c_cond
(paren
op_star
id|str
op_eq
l_char|&squot;,&squot;
)paren
(brace
op_star
id|temp
op_assign
l_char|&squot;&bslash;n&squot;
suffix:semicolon
id|temp
op_increment
suffix:semicolon
id|str
op_increment
suffix:semicolon
r_continue
suffix:semicolon
)brace
op_star
id|temp
op_assign
op_star
id|str
suffix:semicolon
id|temp
op_increment
suffix:semicolon
id|str
op_increment
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
id|__setup
c_func
(paren
l_string|&quot;ioconfig=&quot;
comma
id|ioconfig_bus_setup
)paren
suffix:semicolon
eof
