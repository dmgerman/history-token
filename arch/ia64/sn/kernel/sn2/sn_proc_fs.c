multiline_comment|/*&n; * This file is subject to the terms and conditions of the GNU General Public&n; * License.  See the file &quot;COPYING&quot; in the main directory of this archive&n; * for more details.&n; *&n; * Copyright (C) 2000-2004 Silicon Graphics, Inc. All rights reserved.&n; */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;asm/uaccess.h&gt;
macro_line|#ifdef CONFIG_PROC_FS
macro_line|#include &lt;linux/proc_fs.h&gt;
macro_line|#include &lt;linux/seq_file.h&gt;
macro_line|#include &lt;asm/sn/sn_sal.h&gt;
DECL|function|partition_id_show
r_static
r_int
id|partition_id_show
c_func
(paren
r_struct
id|seq_file
op_star
id|s
comma
r_void
op_star
id|p
)paren
(brace
id|seq_printf
c_func
(paren
id|s
comma
l_string|&quot;%d&bslash;n&quot;
comma
id|sn_local_partid
c_func
(paren
)paren
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|partition_id_open
r_static
r_int
id|partition_id_open
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_return
id|single_open
c_func
(paren
id|file
comma
id|partition_id_show
comma
l_int|NULL
)paren
suffix:semicolon
)brace
DECL|function|system_serial_number_show
r_static
r_int
id|system_serial_number_show
c_func
(paren
r_struct
id|seq_file
op_star
id|s
comma
r_void
op_star
id|p
)paren
(brace
id|seq_printf
c_func
(paren
id|s
comma
l_string|&quot;%s&bslash;n&quot;
comma
id|sn_system_serial_number
c_func
(paren
)paren
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|system_serial_number_open
r_static
r_int
id|system_serial_number_open
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_return
id|single_open
c_func
(paren
id|file
comma
id|system_serial_number_show
comma
l_int|NULL
)paren
suffix:semicolon
)brace
DECL|function|licenseID_show
r_static
r_int
id|licenseID_show
c_func
(paren
r_struct
id|seq_file
op_star
id|s
comma
r_void
op_star
id|p
)paren
(brace
id|seq_printf
c_func
(paren
id|s
comma
l_string|&quot;0x%lx&bslash;n&quot;
comma
id|sn_partition_serial_number_val
c_func
(paren
)paren
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|licenseID_open
r_static
r_int
id|licenseID_open
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_return
id|single_open
c_func
(paren
id|file
comma
id|licenseID_show
comma
l_int|NULL
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Enable forced interrupt by default.&n; * When set, the sn interrupt handler writes the force interrupt register on&n; * the bridge chip.  The hardware will then send an interrupt message if the&n; * interrupt line is active.  This mimics a level sensitive interrupt.&n; */
DECL|variable|sn_force_interrupt_flag
r_int
id|sn_force_interrupt_flag
op_assign
l_int|1
suffix:semicolon
DECL|function|sn_force_interrupt_show
r_static
r_int
id|sn_force_interrupt_show
c_func
(paren
r_struct
id|seq_file
op_star
id|s
comma
r_void
op_star
id|p
)paren
(brace
id|seq_printf
c_func
(paren
id|s
comma
l_string|&quot;Force interrupt is %s&bslash;n&quot;
comma
id|sn_force_interrupt_flag
ques
c_cond
l_string|&quot;enabled&quot;
suffix:colon
l_string|&quot;disabled&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|sn_force_interrupt_write_proc
r_static
id|ssize_t
id|sn_force_interrupt_write_proc
c_func
(paren
r_struct
id|file
op_star
id|file
comma
r_const
r_char
id|__user
op_star
id|buffer
comma
r_int
id|count
comma
id|loff_t
op_star
id|data
)paren
(brace
r_char
id|val
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|val
comma
id|buffer
comma
l_int|1
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|sn_force_interrupt_flag
op_assign
(paren
id|val
op_eq
l_char|&squot;0&squot;
)paren
ques
c_cond
l_int|0
suffix:colon
l_int|1
suffix:semicolon
r_return
id|count
suffix:semicolon
)brace
DECL|function|sn_force_interrupt_open
r_static
r_int
id|sn_force_interrupt_open
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_return
id|single_open
c_func
(paren
id|file
comma
id|sn_force_interrupt_show
comma
l_int|NULL
)paren
suffix:semicolon
)brace
DECL|function|coherence_id_show
r_static
r_int
id|coherence_id_show
c_func
(paren
r_struct
id|seq_file
op_star
id|s
comma
r_void
op_star
id|p
)paren
(brace
id|seq_printf
c_func
(paren
id|s
comma
l_string|&quot;%d&bslash;n&quot;
comma
id|cpuid_to_coherence_id
c_func
(paren
id|smp_processor_id
c_func
(paren
)paren
)paren
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|coherence_id_open
r_static
r_int
id|coherence_id_open
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_return
id|single_open
c_func
(paren
id|file
comma
id|coherence_id_show
comma
l_int|NULL
)paren
suffix:semicolon
)brace
DECL|function|sn_procfs_create_entry
r_static
r_struct
id|proc_dir_entry
op_star
id|sn_procfs_create_entry
c_func
(paren
r_const
r_char
op_star
id|name
comma
r_struct
id|proc_dir_entry
op_star
id|parent
comma
r_int
(paren
op_star
id|openfunc
)paren
(paren
r_struct
id|inode
op_star
comma
r_struct
id|file
op_star
)paren
comma
r_int
(paren
op_star
id|releasefunc
)paren
(paren
r_struct
id|inode
op_star
comma
r_struct
id|file
op_star
)paren
)paren
(brace
r_struct
id|proc_dir_entry
op_star
id|e
op_assign
id|create_proc_entry
c_func
(paren
id|name
comma
l_int|0444
comma
id|parent
)paren
suffix:semicolon
r_if
c_cond
(paren
id|e
)paren
(brace
id|e-&gt;proc_fops
op_assign
(paren
r_struct
id|file_operations
op_star
)paren
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|file_operations
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|e-&gt;proc_fops
)paren
(brace
id|memset
c_func
(paren
id|e-&gt;proc_fops
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|file_operations
)paren
)paren
suffix:semicolon
id|e-&gt;proc_fops-&gt;open
op_assign
id|openfunc
suffix:semicolon
id|e-&gt;proc_fops-&gt;read
op_assign
id|seq_read
suffix:semicolon
id|e-&gt;proc_fops-&gt;llseek
op_assign
id|seq_lseek
suffix:semicolon
id|e-&gt;proc_fops-&gt;release
op_assign
id|releasefunc
suffix:semicolon
)brace
)brace
r_return
id|e
suffix:semicolon
)brace
multiline_comment|/* /proc/sgi_sn/sn_topology uses seq_file, see sn_hwperf.c */
r_extern
r_int
id|sn_topology_open
c_func
(paren
r_struct
id|inode
op_star
comma
r_struct
id|file
op_star
)paren
suffix:semicolon
r_extern
r_int
id|sn_topology_release
c_func
(paren
r_struct
id|inode
op_star
comma
r_struct
id|file
op_star
)paren
suffix:semicolon
DECL|function|register_sn_procfs
r_void
id|register_sn_procfs
c_func
(paren
r_void
)paren
(brace
r_static
r_struct
id|proc_dir_entry
op_star
id|sgi_proc_dir
op_assign
l_int|NULL
suffix:semicolon
r_struct
id|proc_dir_entry
op_star
id|e
suffix:semicolon
id|BUG_ON
c_func
(paren
id|sgi_proc_dir
op_ne
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|sgi_proc_dir
op_assign
id|proc_mkdir
c_func
(paren
l_string|&quot;sgi_sn&quot;
comma
l_int|NULL
)paren
)paren
)paren
r_return
suffix:semicolon
id|sn_procfs_create_entry
c_func
(paren
l_string|&quot;partition_id&quot;
comma
id|sgi_proc_dir
comma
id|partition_id_open
comma
id|single_release
)paren
suffix:semicolon
id|sn_procfs_create_entry
c_func
(paren
l_string|&quot;system_serial_number&quot;
comma
id|sgi_proc_dir
comma
id|system_serial_number_open
comma
id|single_release
)paren
suffix:semicolon
id|sn_procfs_create_entry
c_func
(paren
l_string|&quot;licenseID&quot;
comma
id|sgi_proc_dir
comma
id|licenseID_open
comma
id|single_release
)paren
suffix:semicolon
id|e
op_assign
id|sn_procfs_create_entry
c_func
(paren
l_string|&quot;sn_force_interrupt&quot;
comma
id|sgi_proc_dir
comma
id|sn_force_interrupt_open
comma
id|single_release
)paren
suffix:semicolon
r_if
c_cond
(paren
id|e
)paren
id|e-&gt;proc_fops-&gt;write
op_assign
id|sn_force_interrupt_write_proc
suffix:semicolon
id|sn_procfs_create_entry
c_func
(paren
l_string|&quot;coherence_id&quot;
comma
id|sgi_proc_dir
comma
id|coherence_id_open
comma
id|single_release
)paren
suffix:semicolon
id|sn_procfs_create_entry
c_func
(paren
l_string|&quot;sn_topology&quot;
comma
id|sgi_proc_dir
comma
id|sn_topology_open
comma
id|sn_topology_release
)paren
suffix:semicolon
)brace
macro_line|#endif /* CONFIG_PROC_FS */
eof
