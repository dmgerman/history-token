multiline_comment|/* &n; *&n; * This file is subject to the terms and conditions of the GNU General Public&n; * License.  See the file &quot;COPYING&quot; in the main directory of this archive&n; * for more details.&n; *&n; * Copyright (C) 2000-2001 Silicon Graphics, Inc. All rights reserved.&n; */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/interrupt.h&gt;
macro_line|#include &lt;linux/smp.h&gt;
macro_line|#include &lt;linux/kernel_stat.h&gt;
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;linux/delay.h&gt;
macro_line|#include &lt;linux/string.h&gt;
macro_line|#include &lt;asm/efi.h&gt;
macro_line|#include &lt;asm/page.h&gt;
macro_line|#include &lt;linux/threads.h&gt;
macro_line|#include &lt;asm/sn/simulator.h&gt;
macro_line|#include &lt;asm/sn/leds.h&gt;
macro_line|#include &quot;llsc4.h&quot;
macro_line|#ifdef STANDALONE
macro_line|#include &quot;lock.h&quot;
macro_line|#endif
macro_line|#ifdef INTTEST
DECL|variable|inttest
r_static
r_int
id|inttest
op_assign
l_int|0
suffix:semicolon
macro_line|#endif
macro_line|#ifdef IA64_SEMFIX_INSN
DECL|macro|IA64_SEMFIX_INSN
macro_line|#undef IA64_SEMFIX_INSN
macro_line|#endif
macro_line|#ifdef IA64_SEMFIX
DECL|macro|IA64_SEMFIX
macro_line|#undef IA64_SEMFIX
macro_line|#endif
DECL|macro|IA64_SEMFIX_INSN
macro_line|# define IA64_SEMFIX_INSN
DECL|macro|IA64_SEMFIX
macro_line|# define IA64_SEMFIX    &quot;&quot;
DECL|macro|NOLOCK
mdefine_line|#define NOLOCK&t;&t;0xdead
DECL|macro|BGUARD
mdefine_line|#define BGUARD(linei)&t;(0xbbbb0000 | (linei));
DECL|macro|EGUARD
mdefine_line|#define EGUARD(linei)&t;(0xeeee0000 | (linei));
DECL|macro|GUARDLINE
mdefine_line|#define GUARDLINE(v)&t;((v)&amp;0xffff)
multiline_comment|/*&n; * Test parameter table for AUTOTEST&n; */
r_typedef
r_struct
(brace
DECL|member|passes
r_int
id|passes
suffix:semicolon
DECL|member|linecount
r_int
id|linecount
suffix:semicolon
DECL|member|linepad
r_int
id|linepad
suffix:semicolon
DECL|typedef|autotest_table_t
)brace
id|autotest_table_t
suffix:semicolon
DECL|variable|autotest_table
id|autotest_table_t
id|autotest_table
(braket
)braket
op_assign
(brace
(brace
l_int|50000000
comma
l_int|2
comma
l_int|0x2b4
)brace
comma
(brace
l_int|50000000
comma
l_int|16
comma
l_int|0
comma
)brace
comma
(brace
l_int|50000000
comma
l_int|16
comma
l_int|4
comma
)brace
comma
(brace
l_int|50000000
comma
l_int|128
comma
l_int|0x44
)brace
comma
(brace
l_int|50000000
comma
l_int|128
comma
l_int|0x84
)brace
comma
(brace
l_int|50000000
comma
l_int|128
comma
l_int|0x200
)brace
comma
(brace
l_int|50000000
comma
l_int|128
comma
l_int|0x204
)brace
comma
(brace
l_int|50000000
comma
l_int|128
comma
l_int|0x2b4
)brace
comma
(brace
l_int|50000000
comma
l_int|2
comma
l_int|8
op_star
id|MB
op_plus
l_int|0x2b4
)brace
comma
(brace
l_int|50000000
comma
l_int|16
comma
l_int|8
op_star
id|MB
op_plus
l_int|0
)brace
comma
(brace
l_int|50000000
comma
l_int|16
comma
l_int|8
op_star
id|MB
op_plus
l_int|4
)brace
comma
(brace
l_int|50000000
comma
l_int|128
comma
l_int|8
op_star
id|MB
op_plus
l_int|0x44
)brace
comma
(brace
l_int|50000000
comma
l_int|128
comma
l_int|8
op_star
id|MB
op_plus
l_int|0x84
)brace
comma
(brace
l_int|50000000
comma
l_int|128
comma
l_int|8
op_star
id|MB
op_plus
l_int|0x200
)brace
comma
(brace
l_int|50000000
comma
l_int|128
comma
l_int|8
op_star
id|MB
op_plus
l_int|0x204
)brace
comma
(brace
l_int|50000000
comma
l_int|128
comma
l_int|8
op_star
id|MB
op_plus
l_int|0x2b4
)brace
comma
(brace
l_int|0
)brace
)brace
suffix:semicolon
multiline_comment|/*&n; * Array of virtual addresses available for test purposes.&n; */
r_typedef
r_struct
(brace
DECL|member|vstart
r_int
id|vstart
suffix:semicolon
DECL|member|vend
r_int
id|vend
suffix:semicolon
DECL|member|nextaddr
r_int
id|nextaddr
suffix:semicolon
DECL|member|nextinit
r_int
id|nextinit
suffix:semicolon
DECL|member|wrapcount
r_int
id|wrapcount
suffix:semicolon
DECL|typedef|memmap_t
)brace
id|memmap_t
suffix:semicolon
DECL|macro|MAPCHUNKS
mdefine_line|#define MAPCHUNKS&t;&t;128
DECL|variable|memmap
id|memmap_t
id|memmap
(braket
id|MAPCHUNKS
)braket
suffix:semicolon
DECL|variable|memmapx
r_int
id|memmapx
op_assign
l_int|0
suffix:semicolon
r_typedef
r_struct
(brace
DECL|member|addr
r_void
op_star
id|addr
suffix:semicolon
DECL|member|data
r_int
id|data
(braket
l_int|16
)braket
suffix:semicolon
DECL|member|data_fc
r_int
id|data_fc
(braket
l_int|16
)braket
suffix:semicolon
DECL|typedef|capture_line_t
)brace
id|capture_line_t
suffix:semicolon
r_typedef
r_struct
(brace
DECL|member|size
r_int
id|size
suffix:semicolon
DECL|member|blockaddr
r_void
op_star
id|blockaddr
suffix:semicolon
DECL|member|shadaddr
r_void
op_star
id|shadaddr
suffix:semicolon
DECL|member|blockdata
r_int
id|blockdata
(braket
l_int|48
)braket
suffix:semicolon
DECL|member|shaddata
r_int
id|shaddata
(braket
l_int|48
)braket
suffix:semicolon
DECL|member|blockdata_fc
r_int
id|blockdata_fc
(braket
l_int|48
)braket
suffix:semicolon
DECL|member|shaddata_fc
r_int
id|shaddata_fc
(braket
l_int|48
)braket
suffix:semicolon
DECL|member|synerr
r_int
id|synerr
suffix:semicolon
DECL|typedef|capture_t
)brace
id|capture_t
suffix:semicolon
multiline_comment|/*&n; * PORTING NOTE: revisit this statement. On hardware we put mbase at 0 and&n; * the rest of the tables have to start at 1MB to skip PROM tables.&n; */
DECL|macro|THREADPRIVATE
mdefine_line|#define THREADPRIVATE(t)&t;((threadprivate_t*)(((long)mbase)+1024*1024+t*((sizeof(threadprivate_t)+511)/512*512)))
DECL|macro|k_capture
mdefine_line|#define k_capture&t;&t;mbase-&gt;sk_capture
DECL|macro|k_go
mdefine_line|#define k_go&t;&t;&t;mbase-&gt;sk_go
DECL|macro|k_linecount
mdefine_line|#define k_linecount&t;&t;mbase-&gt;sk_linecount
DECL|macro|k_passes
mdefine_line|#define k_passes&t;&t;mbase-&gt;sk_passes
DECL|macro|k_napticks
mdefine_line|#define k_napticks&t;&t;mbase-&gt;sk_napticks
DECL|macro|k_stop_on_error
mdefine_line|#define k_stop_on_error&t;&t;mbase-&gt;sk_stop_on_error
DECL|macro|k_verbose
mdefine_line|#define k_verbose&t;&t;mbase-&gt;sk_verbose
DECL|macro|k_threadprivate
mdefine_line|#define k_threadprivate&t;&t;mbase-&gt;sk_threadprivate
DECL|macro|k_blocks
mdefine_line|#define k_blocks&t;&t;mbase-&gt;sk_blocks
DECL|macro|k_iter_msg
mdefine_line|#define k_iter_msg&t;&t;mbase-&gt;sk_iter_msg
DECL|macro|k_vv
mdefine_line|#define k_vv&t;&t;&t;mbase-&gt;sk_vv
DECL|macro|k_linepad
mdefine_line|#define k_linepad&t;&t;mbase-&gt;sk_linepad
DECL|macro|k_options
mdefine_line|#define k_options&t;&t;mbase-&gt;sk_options
DECL|macro|k_testnumber
mdefine_line|#define k_testnumber&t;&t;mbase-&gt;sk_testnumber
DECL|macro|k_currentpass
mdefine_line|#define k_currentpass&t;&t;mbase-&gt;sk_currentpass
DECL|variable|blocks
r_static
r_int
id|blocks
(braket
id|MAX_LINECOUNT
)braket
suffix:semicolon
multiline_comment|/* addresses of data blocks */
DECL|variable|mbase
r_static
id|control_t
op_star
id|mbase
suffix:semicolon
DECL|variable|initialized
r_static
id|vint
id|initialized
op_assign
l_int|0
suffix:semicolon
r_static
r_int
r_int
id|ran_conf_llsc
c_func
(paren
r_int
)paren
suffix:semicolon
r_static
r_int
id|rerr
c_func
(paren
id|capture_t
op_star
comma
r_char
op_star
comma
r_void
op_star
comma
r_void
op_star
comma
r_int
comma
r_int
comma
r_int
comma
r_int
comma
r_int
comma
r_int
)paren
suffix:semicolon
r_static
r_void
id|dumpline
c_func
(paren
r_void
op_star
comma
r_char
op_star
comma
r_char
op_star
comma
r_void
op_star
comma
r_void
op_star
comma
r_int
)paren
suffix:semicolon
r_static
r_int
id|checkstop
c_func
(paren
r_int
comma
r_int
comma
id|uint
)paren
suffix:semicolon
r_static
r_void
id|spin
c_func
(paren
r_int
)paren
suffix:semicolon
r_static
r_void
id|capturedata
c_func
(paren
id|capture_t
op_star
comma
id|uint
comma
r_void
op_star
comma
r_void
op_star
comma
r_int
)paren
suffix:semicolon
r_static
r_int
id|randn
c_func
(paren
id|uint
id|max
comma
id|uint
op_star
id|seed
)paren
suffix:semicolon
r_static
id|uint
id|zrandom
(paren
id|uint
op_star
id|zranseed
)paren
suffix:semicolon
r_static
r_int
id|set_lock
c_func
(paren
id|uint
op_star
comma
id|uint
)paren
suffix:semicolon
r_static
r_int
id|clr_lock
c_func
(paren
id|uint
op_star
comma
id|uint
)paren
suffix:semicolon
r_static
r_void
id|Speedo
c_func
(paren
r_void
)paren
suffix:semicolon
DECL|variable|autotest_enabled
r_int
id|autotest_enabled
op_assign
l_int|0
suffix:semicolon
DECL|variable|llsctest_number
r_static
r_int
id|llsctest_number
op_assign
op_minus
l_int|1
suffix:semicolon
DECL|variable|errstop_enabled
r_static
r_int
id|errstop_enabled
op_assign
l_int|0
suffix:semicolon
DECL|variable|fail_enabled
r_static
r_int
id|fail_enabled
op_assign
l_int|0
suffix:semicolon
DECL|variable|l4_opt
r_static
r_int
id|l4_opt
op_assign
l_int|0
suffix:semicolon
DECL|variable|selective_trigger
r_static
r_int
id|selective_trigger
op_assign
l_int|0
suffix:semicolon
DECL|variable|dump_block_addrs_opt
r_static
r_int
id|dump_block_addrs_opt
op_assign
l_int|0
suffix:semicolon
DECL|variable|errlock
r_static
id|lock_t
id|errlock
op_assign
id|NOLOCK
suffix:semicolon
DECL|variable|init_private
r_static
id|private_t
id|init_private
(braket
id|LLSC_MAXCPUS
)braket
suffix:semicolon
DECL|function|autotest_enable
r_static
r_int
id|__init
id|autotest_enable
c_func
(paren
r_char
op_star
id|str
)paren
(brace
id|autotest_enabled
op_assign
l_int|1
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|set_llscblkadr
r_static
r_int
id|__init
id|set_llscblkadr
c_func
(paren
r_char
op_star
id|str
)paren
(brace
id|dump_block_addrs_opt
op_assign
l_int|1
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|set_llscselt
r_static
r_int
id|__init
id|set_llscselt
c_func
(paren
r_char
op_star
id|str
)paren
(brace
id|selective_trigger
op_assign
l_int|1
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|set_llsctest
r_static
r_int
id|__init
id|set_llsctest
c_func
(paren
r_char
op_star
id|str
)paren
(brace
id|llsctest_number
op_assign
id|simple_strtol
c_func
(paren
id|str
comma
op_amp
id|str
comma
l_int|10
)paren
suffix:semicolon
r_if
c_cond
(paren
id|llsctest_number
template_param
l_int|15
)paren
id|llsctest_number
op_assign
op_minus
l_int|1
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|set_llscerrstop
r_static
r_int
id|__init
id|set_llscerrstop
c_func
(paren
r_char
op_star
id|str
)paren
(brace
id|errstop_enabled
op_assign
l_int|1
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|set_llscfail
r_static
r_int
id|__init
id|set_llscfail
c_func
(paren
r_char
op_star
id|str
)paren
(brace
id|fail_enabled
op_assign
l_int|8
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|set_llscl4
r_static
r_int
id|__init
id|set_llscl4
c_func
(paren
r_char
op_star
id|str
)paren
(brace
id|l4_opt
op_assign
l_int|1
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|print_params
r_static
r_void
id|print_params
c_func
(paren
r_void
)paren
(brace
id|printk
(paren
l_string|&quot;********* Enter AUTOTEST facility on master cpu *************&bslash;n&quot;
)paren
suffix:semicolon
id|printk
(paren
l_string|&quot;  Test options:&bslash;n&quot;
)paren
suffix:semicolon
id|printk
(paren
l_string|&quot;     llsctest=&lt;n&gt;&bslash;t%d&bslash;tTest number to run (all = -1)&bslash;n&quot;
comma
id|llsctest_number
)paren
suffix:semicolon
id|printk
(paren
l_string|&quot;     llscerrstop &bslash;t%s&bslash;tStop on error&bslash;n&quot;
comma
id|errstop_enabled
ques
c_cond
l_string|&quot;on&quot;
suffix:colon
l_string|&quot;off&quot;
)paren
suffix:semicolon
id|printk
(paren
l_string|&quot;     llscfail    &bslash;t%s&bslash;tForce a failure to test the trigger &amp; error messages&bslash;n&quot;
comma
id|fail_enabled
ques
c_cond
l_string|&quot;on&quot;
suffix:colon
l_string|&quot;off&quot;
)paren
suffix:semicolon
id|printk
(paren
l_string|&quot;     llscselt    &bslash;t%s&bslash;tSelective triger on failures&bslash;n&quot;
comma
id|selective_trigger
ques
c_cond
l_string|&quot;on&quot;
suffix:colon
l_string|&quot;off&quot;
)paren
suffix:semicolon
id|printk
(paren
l_string|&quot;     llscblkadr  &bslash;t%s&bslash;tDump data block addresses&bslash;n&quot;
comma
id|dump_block_addrs_opt
ques
c_cond
l_string|&quot;on&quot;
suffix:colon
l_string|&quot;off&quot;
)paren
suffix:semicolon
id|printk
(paren
l_string|&quot;     llscl4      &bslash;t%s&bslash;tRun only tests that evict from L4&bslash;n&quot;
comma
id|l4_opt
ques
c_cond
l_string|&quot;on&quot;
suffix:colon
l_string|&quot;off&quot;
)paren
suffix:semicolon
id|printk
(paren
l_string|&quot;  SEMFIX: %s&bslash;n&quot;
comma
id|IA64_SEMFIX
)paren
suffix:semicolon
id|printk
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
)brace
id|__setup
c_func
(paren
l_string|&quot;autotest&quot;
comma
id|autotest_enable
)paren
suffix:semicolon
id|__setup
c_func
(paren
l_string|&quot;llsctest=&quot;
comma
id|set_llsctest
)paren
suffix:semicolon
id|__setup
c_func
(paren
l_string|&quot;llscerrstop&quot;
comma
id|set_llscerrstop
)paren
suffix:semicolon
id|__setup
c_func
(paren
l_string|&quot;llscfail&quot;
comma
id|set_llscfail
)paren
suffix:semicolon
id|__setup
c_func
(paren
l_string|&quot;llscselt&quot;
comma
id|set_llscselt
)paren
suffix:semicolon
id|__setup
c_func
(paren
l_string|&quot;llscblkadr&quot;
comma
id|set_llscblkadr
)paren
suffix:semicolon
id|__setup
c_func
(paren
l_string|&quot;llscl4&quot;
comma
id|set_llscl4
)paren
suffix:semicolon
r_static
r_inline
r_int
DECL|function|set_lock
id|set_lock
c_func
(paren
id|uint
op_star
id|lock
comma
id|uint
id|id
)paren
(brace
id|uint
id|old
suffix:semicolon
id|old
op_assign
id|cmpxchg_acq
c_func
(paren
id|lock
comma
id|NOLOCK
comma
id|id
)paren
suffix:semicolon
r_return
(paren
id|old
op_eq
id|NOLOCK
)paren
suffix:semicolon
)brace
r_static
r_inline
r_int
DECL|function|clr_lock
id|clr_lock
c_func
(paren
id|uint
op_star
id|lock
comma
id|uint
id|id
)paren
(brace
id|uint
id|old
suffix:semicolon
id|old
op_assign
id|cmpxchg_rel
c_func
(paren
id|lock
comma
id|id
comma
id|NOLOCK
)paren
suffix:semicolon
r_return
(paren
id|old
op_eq
id|id
)paren
suffix:semicolon
)brace
r_static
r_inline
r_void
DECL|function|init_lock
id|init_lock
c_func
(paren
id|uint
op_star
id|lock
)paren
(brace
op_star
id|lock
op_assign
id|NOLOCK
suffix:semicolon
)brace
multiline_comment|/*------------------------------------------------------------------------+&n;| Routine  :  ran_conf_llsc - ll/sc shared data test                      |&n;| Description: This test checks the coherency of shared data              |&n;+------------------------------------------------------------------------*/
r_static
r_int
r_int
DECL|function|ran_conf_llsc
id|ran_conf_llsc
c_func
(paren
r_int
id|thread
)paren
(brace
id|private_t
id|pval
suffix:semicolon
id|share_t
id|sval
comma
id|sval2
suffix:semicolon
id|uint
id|vv
comma
id|linei
comma
id|slinei
comma
id|sharei
comma
id|pass
suffix:semicolon
r_int
id|t
suffix:semicolon
id|lock_t
id|lockpat
suffix:semicolon
id|share_t
op_star
id|sharecopy
suffix:semicolon
r_int
id|verbose
comma
id|napticks
comma
id|passes
comma
id|linecount
comma
id|lcount
suffix:semicolon
id|dataline_t
op_star
id|linep
comma
op_star
id|slinep
suffix:semicolon
r_int
id|s
comma
id|seed
suffix:semicolon
id|threadprivate_t
op_star
id|tp
suffix:semicolon
id|uint
id|iter_msg
comma
id|iter_msg_i
op_assign
l_int|0
suffix:semicolon
r_int
id|vv_mask
suffix:semicolon
r_int
id|correct_errors
suffix:semicolon
r_int
id|errs
op_assign
l_int|0
suffix:semicolon
r_int
id|stillbad
suffix:semicolon
id|capture_t
id|capdata
suffix:semicolon
id|private_t
op_star
id|privp
suffix:semicolon
id|share_t
op_star
id|sharep
suffix:semicolon
id|linecount
op_assign
id|k_linecount
suffix:semicolon
id|napticks
op_assign
id|k_napticks
suffix:semicolon
id|verbose
op_assign
id|k_verbose
suffix:semicolon
id|passes
op_assign
id|k_passes
suffix:semicolon
id|iter_msg
op_assign
id|k_iter_msg
suffix:semicolon
id|seed
op_assign
(paren
id|thread
op_plus
l_int|1
)paren
op_star
l_int|647
suffix:semicolon
id|tp
op_assign
id|THREADPRIVATE
c_func
(paren
id|thread
)paren
suffix:semicolon
id|vv_mask
op_assign
(paren
id|k_vv
op_rshift
(paren
(paren
id|thread
op_mod
l_int|16
)paren
op_star
l_int|4
)paren
)paren
op_amp
l_int|0xf
suffix:semicolon
id|correct_errors
op_assign
id|k_options
op_amp
l_int|0xff
suffix:semicolon
id|memset
(paren
op_amp
id|capdata
comma
l_int|0
comma
r_sizeof
(paren
id|capdata
)paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|linei
op_assign
l_int|0
suffix:semicolon
id|linei
OL
id|linecount
suffix:semicolon
id|linei
op_increment
)paren
id|tp
op_member_access_from_pointer
r_private
(braket
id|linei
)braket
op_assign
id|thread
suffix:semicolon
r_for
c_loop
(paren
id|pass
op_assign
l_int|1
suffix:semicolon
id|passes
op_eq
l_int|0
op_logical_or
id|pass
OL
id|passes
suffix:semicolon
id|pass
op_increment
)paren
(brace
id|lockpat
op_assign
(paren
id|pass
op_amp
l_int|0x0fffffff
)paren
op_plus
(paren
id|thread
op_lshift
l_int|28
)paren
suffix:semicolon
r_if
c_cond
(paren
id|lockpat
op_eq
id|NOLOCK
)paren
r_continue
suffix:semicolon
id|tp-&gt;threadpasses
op_assign
id|pass
suffix:semicolon
r_if
c_cond
(paren
id|checkstop
c_func
(paren
id|thread
comma
id|pass
comma
id|lockpat
)paren
)paren
r_return
l_int|0
suffix:semicolon
id|iter_msg_i
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|iter_msg
op_logical_and
id|iter_msg_i
OG
id|iter_msg
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;Thread %d, Pass %d&bslash;n&quot;
comma
id|thread
comma
id|pass
)paren
suffix:semicolon
id|iter_msg_i
op_assign
l_int|0
suffix:semicolon
)brace
id|lcount
op_assign
l_int|0
suffix:semicolon
multiline_comment|/*&n;&t;&t; * Select line to perform operations on.&n;&t;&t; */
id|linei
op_assign
id|randn
c_func
(paren
id|linecount
comma
op_amp
id|seed
)paren
suffix:semicolon
id|sharei
op_assign
id|randn
c_func
(paren
l_int|2
comma
op_amp
id|seed
)paren
suffix:semicolon
id|slinei
op_assign
(paren
id|linei
op_plus
(paren
id|linecount
op_div
l_int|2
)paren
)paren
op_mod
id|linecount
suffix:semicolon
multiline_comment|/* I dont like this - fix later */
id|linep
op_assign
(paren
id|dataline_t
op_star
)paren
id|blocks
(braket
id|linei
)braket
suffix:semicolon
id|slinep
op_assign
(paren
id|dataline_t
op_star
)paren
id|blocks
(braket
id|slinei
)braket
suffix:semicolon
r_if
c_cond
(paren
id|sharei
op_eq
l_int|0
)paren
id|sharecopy
op_assign
op_amp
id|slinep-&gt;share0
suffix:semicolon
r_else
id|sharecopy
op_assign
op_amp
id|slinep-&gt;share1
suffix:semicolon
id|vv
op_assign
id|randn
c_func
(paren
l_int|4
comma
op_amp
id|seed
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|vv_mask
op_amp
(paren
l_int|1
op_lshift
id|vv
)paren
)paren
op_eq
l_int|0
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|napticks
)paren
(brace
id|t
op_assign
id|randn
c_func
(paren
id|napticks
comma
op_amp
id|seed
)paren
suffix:semicolon
id|udelay
c_func
(paren
id|t
)paren
suffix:semicolon
)brace
id|privp
op_assign
op_amp
id|linep
op_member_access_from_pointer
r_private
(braket
id|thread
)braket
suffix:semicolon
id|sharep
op_assign
op_amp
id|linep-&gt;share
(braket
id|sharei
)braket
suffix:semicolon
r_switch
c_cond
(paren
id|vv
)paren
(brace
r_case
l_int|0
suffix:colon
multiline_comment|/* Read and verify private count on line. */
id|pval
op_assign
op_star
id|privp
suffix:semicolon
r_if
c_cond
(paren
id|verbose
)paren
id|printk
c_func
(paren
l_string|&quot;Line:%3d, Thread:%d:%d. Val: %x&bslash;n&quot;
comma
id|linei
comma
id|thread
comma
id|vv
comma
id|tp
op_member_access_from_pointer
r_private
(braket
id|linei
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pval
op_ne
id|tp
op_member_access_from_pointer
r_private
(braket
id|linei
)braket
)paren
(brace
id|capturedata
c_func
(paren
op_amp
id|capdata
comma
id|pass
comma
id|privp
comma
l_int|NULL
comma
r_sizeof
(paren
op_star
id|privp
)paren
)paren
suffix:semicolon
id|stillbad
op_assign
(paren
op_star
id|privp
op_ne
id|tp
op_member_access_from_pointer
r_private
(braket
id|linei
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rerr
c_func
(paren
op_amp
id|capdata
comma
l_string|&quot;Private count&quot;
comma
id|linep
comma
id|slinep
comma
id|thread
comma
id|pass
comma
id|linei
comma
id|tp
op_member_access_from_pointer
r_private
(braket
id|linei
)braket
comma
id|pval
comma
id|stillbad
)paren
)paren
(brace
r_return
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|correct_errors
)paren
(brace
id|tp
op_member_access_from_pointer
r_private
(braket
id|linei
)braket
op_assign
op_star
id|privp
suffix:semicolon
)brace
id|errs
op_increment
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
multiline_comment|/* Read, verify, and increment private count on line. */
id|pval
op_assign
op_star
id|privp
suffix:semicolon
r_if
c_cond
(paren
id|verbose
)paren
id|printk
c_func
(paren
l_string|&quot;Line:%3d, Thread:%d:%d. Val: %x&bslash;n&quot;
comma
id|linei
comma
id|thread
comma
id|vv
comma
id|tp
op_member_access_from_pointer
r_private
(braket
id|linei
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pval
op_ne
id|tp
op_member_access_from_pointer
r_private
(braket
id|linei
)braket
)paren
(brace
id|capturedata
c_func
(paren
op_amp
id|capdata
comma
id|pass
comma
id|privp
comma
l_int|NULL
comma
r_sizeof
(paren
op_star
id|privp
)paren
)paren
suffix:semicolon
id|stillbad
op_assign
(paren
op_star
id|privp
op_ne
id|tp
op_member_access_from_pointer
r_private
(braket
id|linei
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rerr
c_func
(paren
op_amp
id|capdata
comma
l_string|&quot;Private count &amp; inc&quot;
comma
id|linep
comma
id|slinep
comma
id|thread
comma
id|pass
comma
id|linei
comma
id|tp
op_member_access_from_pointer
r_private
(braket
id|linei
)braket
comma
id|pval
comma
id|stillbad
)paren
)paren
(brace
r_return
l_int|1
suffix:semicolon
)brace
id|errs
op_increment
suffix:semicolon
)brace
id|pval
op_assign
(paren
id|pval
op_eq
l_int|255
)paren
ques
c_cond
l_int|0
suffix:colon
id|pval
op_plus
l_int|1
suffix:semicolon
op_star
id|privp
op_assign
id|pval
suffix:semicolon
id|tp
op_member_access_from_pointer
r_private
(braket
id|linei
)braket
op_assign
id|pval
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
multiline_comment|/* Lock line, read and verify shared data. */
r_if
c_cond
(paren
id|verbose
)paren
id|printk
c_func
(paren
l_string|&quot;Line:%3d, Thread:%d:%d. Val: %x&bslash;n&quot;
comma
id|linei
comma
id|thread
comma
id|vv
comma
op_star
id|sharecopy
)paren
suffix:semicolon
id|lcount
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
id|LOCK
c_func
(paren
id|sharei
)paren
op_ne
l_int|1
)paren
(brace
r_if
c_cond
(paren
id|checkstop
c_func
(paren
id|thread
comma
id|pass
comma
id|lockpat
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|lcount
op_increment
OG
l_int|1000000
)paren
(brace
id|capturedata
c_func
(paren
op_amp
id|capdata
comma
id|pass
comma
id|LOCKADDR
c_func
(paren
id|sharei
)paren
comma
l_int|NULL
comma
r_sizeof
(paren
id|lock_t
)paren
)paren
suffix:semicolon
id|stillbad
op_assign
(paren
id|GETLOCK
c_func
(paren
id|sharei
)paren
op_ne
l_int|0
)paren
suffix:semicolon
id|rerr
c_func
(paren
op_amp
id|capdata
comma
l_string|&quot;Shared data lock&quot;
comma
id|linep
comma
id|slinep
comma
id|thread
comma
id|pass
comma
id|linei
comma
l_int|0
comma
id|GETLOCK
c_func
(paren
id|sharei
)paren
comma
id|stillbad
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|lcount
op_amp
l_int|0x3fff
)paren
op_eq
l_int|0
)paren
id|udelay
c_func
(paren
l_int|1000
)paren
suffix:semicolon
)brace
id|sval
op_assign
op_star
id|sharep
suffix:semicolon
id|sval2
op_assign
op_star
id|sharecopy
suffix:semicolon
r_if
c_cond
(paren
id|pass
OG
l_int|12
op_logical_and
id|thread
op_eq
l_int|0
op_logical_and
id|fail_enabled
op_eq
l_int|1
)paren
id|sval
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|sval
op_ne
id|sval2
)paren
(brace
id|capturedata
c_func
(paren
op_amp
id|capdata
comma
id|pass
comma
id|sharep
comma
id|sharecopy
comma
r_sizeof
(paren
op_star
id|sharecopy
)paren
)paren
suffix:semicolon
id|stillbad
op_assign
(paren
op_star
id|sharep
op_ne
op_star
id|sharecopy
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|stillbad
op_logical_and
op_star
id|sharep
op_ne
id|sval
op_logical_and
op_star
id|sharecopy
op_eq
id|sval2
)paren
id|stillbad
op_assign
l_int|2
suffix:semicolon
r_if
c_cond
(paren
id|rerr
c_func
(paren
op_amp
id|capdata
comma
l_string|&quot;Shared data&quot;
comma
id|linep
comma
id|slinep
comma
id|thread
comma
id|pass
comma
id|linei
comma
id|sval2
comma
id|sval
comma
id|stillbad
)paren
)paren
(brace
r_return
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|correct_errors
)paren
op_star
id|sharep
op_assign
op_star
id|sharecopy
suffix:semicolon
id|errs
op_increment
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|s
op_assign
id|UNLOCK
c_func
(paren
id|sharei
)paren
)paren
op_ne
l_int|1
)paren
(brace
id|capturedata
c_func
(paren
op_amp
id|capdata
comma
id|pass
comma
id|LOCKADDR
c_func
(paren
id|sharei
)paren
comma
l_int|NULL
comma
l_int|4
)paren
suffix:semicolon
id|stillbad
op_assign
(paren
id|GETLOCK
c_func
(paren
id|sharei
)paren
op_ne
id|lockpat
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rerr
c_func
(paren
op_amp
id|capdata
comma
l_string|&quot;Shared data unlock&quot;
comma
id|linep
comma
id|slinep
comma
id|thread
comma
id|pass
comma
id|linei
comma
id|lockpat
comma
id|GETLOCK
c_func
(paren
id|sharei
)paren
comma
id|stillbad
)paren
)paren
r_return
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|correct_errors
)paren
id|ZEROLOCK
c_func
(paren
id|sharei
)paren
suffix:semicolon
id|errs
op_increment
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
multiline_comment|/* Lock line, read and verify shared data, modify shared data. */
r_if
c_cond
(paren
id|verbose
)paren
id|printk
c_func
(paren
l_string|&quot;Line:%3d, Thread:%d:%d. Val: %x&bslash;n&quot;
comma
id|linei
comma
id|thread
comma
id|vv
comma
op_star
id|sharecopy
)paren
suffix:semicolon
id|lcount
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
id|LOCK
c_func
(paren
id|sharei
)paren
op_ne
l_int|1
)paren
(brace
r_if
c_cond
(paren
id|checkstop
c_func
(paren
id|thread
comma
id|pass
comma
id|lockpat
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|lcount
op_increment
OG
l_int|1000000
)paren
(brace
id|capturedata
c_func
(paren
op_amp
id|capdata
comma
id|pass
comma
id|LOCKADDR
c_func
(paren
id|sharei
)paren
comma
l_int|NULL
comma
r_sizeof
(paren
id|lock_t
)paren
)paren
suffix:semicolon
id|stillbad
op_assign
(paren
id|GETLOCK
c_func
(paren
id|sharei
)paren
op_ne
l_int|0
)paren
suffix:semicolon
id|rerr
c_func
(paren
op_amp
id|capdata
comma
l_string|&quot;Shared data lock &amp; inc&quot;
comma
id|linep
comma
id|slinep
comma
id|thread
comma
id|pass
comma
id|linei
comma
l_int|0
comma
id|GETLOCK
c_func
(paren
id|sharei
)paren
comma
id|stillbad
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|lcount
op_amp
l_int|0x3fff
)paren
op_eq
l_int|0
)paren
id|udelay
c_func
(paren
l_int|1000
)paren
suffix:semicolon
)brace
id|sval
op_assign
op_star
id|sharep
suffix:semicolon
id|sval2
op_assign
op_star
id|sharecopy
suffix:semicolon
r_if
c_cond
(paren
id|sval
op_ne
id|sval2
)paren
(brace
id|capturedata
c_func
(paren
op_amp
id|capdata
comma
id|pass
comma
id|sharep
comma
id|sharecopy
comma
r_sizeof
(paren
op_star
id|sharecopy
)paren
)paren
suffix:semicolon
id|stillbad
op_assign
(paren
op_star
id|sharep
op_ne
op_star
id|sharecopy
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|stillbad
op_logical_and
op_star
id|sharep
op_ne
id|sval
op_logical_and
op_star
id|sharecopy
op_eq
id|sval2
)paren
id|stillbad
op_assign
l_int|2
suffix:semicolon
r_if
c_cond
(paren
id|rerr
c_func
(paren
op_amp
id|capdata
comma
l_string|&quot;Shared data &amp; inc&quot;
comma
id|linep
comma
id|slinep
comma
id|thread
comma
id|pass
comma
id|linei
comma
id|sval2
comma
id|sval
comma
id|stillbad
)paren
)paren
(brace
r_return
l_int|1
suffix:semicolon
)brace
id|errs
op_increment
suffix:semicolon
)brace
op_star
id|sharep
op_assign
id|lockpat
suffix:semicolon
op_star
id|sharecopy
op_assign
id|lockpat
suffix:semicolon
r_if
c_cond
(paren
(paren
id|s
op_assign
id|UNLOCK
c_func
(paren
id|sharei
)paren
)paren
op_ne
l_int|1
)paren
(brace
id|capturedata
c_func
(paren
op_amp
id|capdata
comma
id|pass
comma
id|LOCKADDR
c_func
(paren
id|sharei
)paren
comma
l_int|NULL
comma
l_int|4
)paren
suffix:semicolon
id|stillbad
op_assign
(paren
id|GETLOCK
c_func
(paren
id|sharei
)paren
op_ne
id|lockpat
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rerr
c_func
(paren
op_amp
id|capdata
comma
l_string|&quot;Shared data &amp; inc unlock&quot;
comma
id|linep
comma
id|slinep
comma
id|thread
comma
id|pass
comma
id|linei
comma
id|thread
comma
id|GETLOCK
c_func
(paren
id|sharei
)paren
comma
id|stillbad
)paren
)paren
r_return
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|correct_errors
)paren
id|ZEROLOCK
c_func
(paren
id|sharei
)paren
suffix:semicolon
id|errs
op_increment
suffix:semicolon
)brace
r_break
suffix:semicolon
)brace
)brace
r_return
(paren
id|errs
OG
l_int|0
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|trigger_la
id|trigger_la
c_func
(paren
r_int
id|val
)paren
(brace
r_int
op_star
id|p
suffix:semicolon
id|p
op_assign
(paren
r_int
op_star
)paren
l_int|0xc0000a0001000020L
suffix:semicolon
multiline_comment|/* PI_CPU_NUM */
op_star
id|p
op_assign
id|val
suffix:semicolon
)brace
r_static
r_int
DECL|function|getsynerr
id|getsynerr
c_func
(paren
r_void
)paren
(brace
r_int
id|err
comma
op_star
id|errp
suffix:semicolon
id|errp
op_assign
(paren
r_int
op_star
)paren
l_int|0xc0000e0000000340L
suffix:semicolon
multiline_comment|/* SYN_ERR */
id|err
op_assign
op_star
id|errp
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
op_star
id|errp
op_assign
op_minus
l_int|1L
suffix:semicolon
r_return
(paren
id|err
op_amp
op_complement
l_int|0x60
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|rerr
id|rerr
c_func
(paren
id|capture_t
op_star
id|cap
comma
r_char
op_star
id|msg
comma
r_void
op_star
id|lp
comma
r_void
op_star
id|slp
comma
r_int
id|thread
comma
r_int
id|pass
comma
r_int
id|badlinei
comma
r_int
id|exp
comma
r_int
id|found
comma
r_int
id|stillbad
)paren
(brace
r_int
id|cpu
comma
id|i
comma
id|linei
suffix:semicolon
r_int
id|synerr
suffix:semicolon
r_int
id|selt
suffix:semicolon
id|selt
op_assign
id|selective_trigger
op_logical_and
id|stillbad
OG
l_int|1
op_logical_and
id|memcmp
c_func
(paren
id|cap-&gt;blockdata
comma
id|cap-&gt;blockdata_fc
comma
l_int|128
)paren
op_ne
l_int|0
op_logical_and
id|memcmp
c_func
(paren
id|cap-&gt;shaddata
comma
id|cap-&gt;shaddata_fc
comma
l_int|128
)paren
op_eq
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|selt
)paren
(brace
id|trigger_la
c_func
(paren
id|pass
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|selective_trigger
)paren
(brace
id|k_go
op_assign
id|ST_STOP
suffix:semicolon
r_return
id|k_stop_on_error
suffix:semicolon
suffix:semicolon
)brace
id|spin
c_func
(paren
l_int|1
)paren
suffix:semicolon
id|i
op_assign
l_int|100
suffix:semicolon
r_while
c_loop
(paren
id|i
op_logical_and
id|set_lock
c_func
(paren
op_amp
id|errlock
comma
l_int|1
)paren
op_ne
l_int|1
)paren
(brace
id|spin
c_func
(paren
l_int|1
)paren
suffix:semicolon
id|i
op_decrement
suffix:semicolon
)brace
id|printk
(paren
l_string|&quot;&bslash;nDataError!: %-20s, test %ld, thread %d, line:%d, pass %d (0x%x), time %ld expected:%x, found:%x&bslash;n&quot;
comma
id|msg
comma
id|k_testnumber
comma
id|thread
comma
id|badlinei
comma
id|pass
comma
id|pass
comma
id|jiffies
comma
id|exp
comma
id|found
)paren
suffix:semicolon
id|dumpline
(paren
id|lp
comma
l_string|&quot;Corrupted data&quot;
comma
l_string|&quot;D &quot;
comma
id|cap-&gt;blockaddr
comma
id|cap-&gt;blockdata
comma
id|cap-&gt;size
)paren
suffix:semicolon
macro_line|#ifdef ZZZ
r_if
c_cond
(paren
id|memcmp
c_func
(paren
id|cap-&gt;blockdata
comma
id|cap-&gt;blockdata_fc
comma
l_int|128
)paren
)paren
id|dumpline
(paren
id|lp
comma
l_string|&quot;Corrupted data&quot;
comma
l_string|&quot;DF&quot;
comma
id|cap-&gt;blockaddr
comma
id|cap-&gt;blockdata_fc
comma
id|cap-&gt;size
)paren
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
id|cap-&gt;shadaddr
)paren
(brace
id|dumpline
(paren
id|slp
comma
l_string|&quot;Shadow    data&quot;
comma
l_string|&quot;S &quot;
comma
id|cap-&gt;shadaddr
comma
id|cap-&gt;shaddata
comma
id|cap-&gt;size
)paren
suffix:semicolon
macro_line|#ifdef ZZZ
r_if
c_cond
(paren
id|memcmp
c_func
(paren
id|cap-&gt;shaddata
comma
id|cap-&gt;shaddata_fc
comma
l_int|128
)paren
)paren
id|dumpline
(paren
id|slp
comma
l_string|&quot;Shadow    data&quot;
comma
l_string|&quot;SF&quot;
comma
id|cap-&gt;shadaddr
comma
id|cap-&gt;shaddata_fc
comma
id|cap-&gt;size
)paren
suffix:semicolon
macro_line|#endif
)brace
id|printk
c_func
(paren
l_string|&quot;Threadpasses: &quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|cpu
op_assign
l_int|0
comma
id|i
op_assign
l_int|0
suffix:semicolon
id|cpu
OL
id|LLSC_MAXCPUS
suffix:semicolon
id|cpu
op_increment
)paren
r_if
c_cond
(paren
id|k_threadprivate
(braket
id|cpu
)braket
op_member_access_from_pointer
id|threadpasses
)paren
(brace
r_if
c_cond
(paren
id|i
op_logical_and
(paren
id|i
op_mod
l_int|8
)paren
op_eq
l_int|0
)paren
id|printk
c_func
(paren
l_string|&quot;&bslash;n            : &quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;  %d:0x%x&quot;
comma
id|cpu
comma
id|k_threadprivate
(braket
id|cpu
)braket
op_member_access_from_pointer
id|threadpasses
)paren
suffix:semicolon
id|i
op_increment
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|linei
op_assign
l_int|0
suffix:semicolon
id|linei
OL
id|k_linecount
suffix:semicolon
id|linei
op_increment
)paren
(brace
r_int
id|slinei
comma
id|g1linei
comma
id|g2linei
comma
id|g1err
comma
id|g2err
comma
id|sh0err
comma
id|sh1err
suffix:semicolon
id|dataline_t
op_star
id|linep
comma
op_star
id|slinep
suffix:semicolon
id|slinei
op_assign
(paren
id|linei
op_plus
(paren
id|k_linecount
op_div
l_int|2
)paren
)paren
op_mod
id|k_linecount
suffix:semicolon
id|linep
op_assign
(paren
id|dataline_t
op_star
)paren
id|blocks
(braket
id|linei
)braket
suffix:semicolon
id|slinep
op_assign
(paren
id|dataline_t
op_star
)paren
id|blocks
(braket
id|slinei
)braket
suffix:semicolon
id|g1linei
op_assign
id|GUARDLINE
c_func
(paren
id|linep-&gt;guard1
)paren
suffix:semicolon
id|g2linei
op_assign
id|GUARDLINE
c_func
(paren
id|linep-&gt;guard2
)paren
suffix:semicolon
id|g1err
op_assign
(paren
id|g1linei
op_ne
id|linei
)paren
suffix:semicolon
id|g2err
op_assign
(paren
id|g2linei
op_ne
id|linei
)paren
suffix:semicolon
id|sh0err
op_assign
(paren
id|linep-&gt;share
(braket
l_int|0
)braket
op_ne
id|slinep-&gt;share0
)paren
suffix:semicolon
id|sh1err
op_assign
(paren
id|linep-&gt;share
(braket
l_int|1
)braket
op_ne
id|slinep-&gt;share1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|g1err
op_logical_or
id|g2err
op_logical_or
id|sh0err
op_logical_or
id|sh1err
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;Line 0x%lx (%03d), %sG1 0x%lx (%03d), %sG2 0x%lx (%03d), %sSH0 %08x (%08x), %sSH1 %08x (%08x)&bslash;n&quot;
comma
id|blocks
(braket
id|linei
)braket
comma
id|linei
comma
id|g1err
ques
c_cond
l_string|&quot;*&quot;
suffix:colon
l_string|&quot; &quot;
comma
id|blocks
(braket
id|g1linei
)braket
comma
id|g1linei
comma
id|g2err
ques
c_cond
l_string|&quot;*&quot;
suffix:colon
l_string|&quot; &quot;
comma
id|blocks
(braket
id|g2linei
)braket
comma
id|g2linei
comma
id|sh0err
ques
c_cond
l_string|&quot;*&quot;
suffix:colon
l_string|&quot; &quot;
comma
id|linep-&gt;share
(braket
l_int|0
)braket
comma
id|slinep-&gt;share0
comma
id|sh1err
ques
c_cond
l_string|&quot;*&quot;
suffix:colon
l_string|&quot; &quot;
comma
id|linep-&gt;share
(braket
l_int|1
)braket
comma
id|slinep-&gt;share1
)paren
suffix:semicolon
)brace
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;nData was %sfixed by flushcache&bslash;n&quot;
comma
(paren
id|stillbad
op_eq
l_int|1
ques
c_cond
l_string|&quot;**** NOT **** &quot;
suffix:colon
l_string|&quot; &quot;
)paren
)paren
suffix:semicolon
id|synerr
op_assign
id|getsynerr
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|synerr
)paren
id|printk
c_func
(paren
l_string|&quot;SYNERR: Thread %d, Synerr: 0x%lx&bslash;n&quot;
comma
id|thread
comma
id|synerr
)paren
suffix:semicolon
id|spin
c_func
(paren
l_int|2
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;n&bslash;n&quot;
)paren
suffix:semicolon
id|clr_lock
c_func
(paren
op_amp
id|errlock
comma
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|errstop_enabled
)paren
(brace
id|local_irq_disable
c_func
(paren
)paren
suffix:semicolon
r_while
c_loop
(paren
l_int|1
)paren
(brace
suffix:semicolon
)brace
)brace
r_return
id|k_stop_on_error
suffix:semicolon
)brace
r_static
r_void
DECL|function|dumpline
id|dumpline
c_func
(paren
r_void
op_star
id|lp
comma
r_char
op_star
id|str1
comma
r_char
op_star
id|str2
comma
r_void
op_star
id|addr
comma
r_void
op_star
id|data
comma
r_int
id|size
)paren
(brace
r_int
op_star
id|p
suffix:semicolon
r_int
id|i
comma
id|off
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s at 0x%lx, size %d, block starts at 0x%lx&bslash;n&quot;
comma
id|str1
comma
(paren
r_int
)paren
id|addr
comma
id|size
comma
(paren
r_int
)paren
id|lp
)paren
suffix:semicolon
id|p
op_assign
(paren
r_int
op_star
)paren
id|data
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|48
suffix:semicolon
id|i
op_increment
comma
id|p
op_increment
)paren
(brace
r_if
c_cond
(paren
id|i
op_mod
l_int|8
op_eq
l_int|0
)paren
id|printk
c_func
(paren
l_string|&quot;%2s&quot;
comma
id|i
op_eq
l_int|16
ques
c_cond
id|str2
suffix:colon
l_string|&quot;  &quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot; %016lx&quot;
comma
op_star
id|p
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|i
op_amp
l_int|7
)paren
op_eq
l_int|7
)paren
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;   &quot;
)paren
suffix:semicolon
id|off
op_assign
(paren
(paren
(paren
r_int
)paren
id|addr
)paren
op_xor
id|size
)paren
op_amp
l_int|63L
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|off
op_plus
id|size
suffix:semicolon
id|i
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s&quot;
comma
(paren
id|i
op_ge
id|off
)paren
ques
c_cond
l_string|&quot;--&quot;
suffix:colon
l_string|&quot;  &quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|i
op_mod
l_int|8
)paren
op_eq
l_int|7
)paren
id|printk
c_func
(paren
l_string|&quot; &quot;
)paren
suffix:semicolon
)brace
id|off
op_assign
(paren
(paren
r_int
)paren
id|addr
)paren
op_amp
l_int|127
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot; (line %d)&bslash;n&quot;
comma
l_int|2
op_plus
id|off
op_div
l_int|64
op_plus
l_int|1
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|randn
id|randn
c_func
(paren
id|uint
id|max
comma
id|uint
op_star
id|seedp
)paren
(brace
r_if
c_cond
(paren
id|max
op_eq
l_int|1
)paren
r_return
l_int|0
suffix:semicolon
r_else
r_return
(paren
r_int
)paren
(paren
id|zrandom
c_func
(paren
id|seedp
)paren
op_rshift
l_int|10
)paren
op_mod
id|max
suffix:semicolon
)brace
r_static
r_int
DECL|function|checkstop
id|checkstop
c_func
(paren
r_int
id|thread
comma
r_int
id|pass
comma
id|uint
id|lockpat
)paren
(brace
r_int
id|synerr
suffix:semicolon
r_if
c_cond
(paren
id|k_go
op_eq
id|ST_RUN
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|k_go
op_eq
id|ST_STOP
)paren
r_return
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|errstop_enabled
)paren
(brace
id|local_irq_disable
c_func
(paren
)paren
suffix:semicolon
r_while
c_loop
(paren
l_int|1
)paren
(brace
suffix:semicolon
)brace
)brace
id|synerr
op_assign
id|getsynerr
c_func
(paren
)paren
suffix:semicolon
id|spin
c_func
(paren
l_int|2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|k_go
op_eq
id|ST_STOP
)paren
r_return
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|synerr
)paren
id|printk
c_func
(paren
l_string|&quot;SYNERR: Thread %d, Synerr: 0x%lx&bslash;n&quot;
comma
id|thread
comma
id|synerr
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
r_static
r_void
DECL|function|spin
id|spin
c_func
(paren
r_int
id|j
)paren
(brace
id|udelay
c_func
(paren
id|j
op_star
l_int|500000
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|capturedata
id|capturedata
c_func
(paren
id|capture_t
op_star
id|cap
comma
id|uint
id|pass
comma
r_void
op_star
id|blockaddr
comma
r_void
op_star
id|shadaddr
comma
r_int
id|size
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|selective_trigger
)paren
id|trigger_la
(paren
id|pass
)paren
suffix:semicolon
id|memcpy
(paren
id|cap-&gt;blockdata
comma
id|CACHEALIGN
c_func
(paren
id|blockaddr
)paren
op_minus
l_int|128
comma
l_int|3
op_star
l_int|128
)paren
suffix:semicolon
r_if
c_cond
(paren
id|shadaddr
)paren
id|memcpy
(paren
id|cap-&gt;shaddata
comma
id|CACHEALIGN
c_func
(paren
id|shadaddr
)paren
op_minus
l_int|128
comma
l_int|3
op_star
l_int|128
)paren
suffix:semicolon
r_if
c_cond
(paren
id|k_stop_on_error
)paren
(brace
id|k_go
op_assign
id|ST_ERRSTOP
suffix:semicolon
)brace
id|cap-&gt;size
op_assign
id|size
suffix:semicolon
id|cap-&gt;blockaddr
op_assign
id|blockaddr
suffix:semicolon
id|cap-&gt;shadaddr
op_assign
id|shadaddr
suffix:semicolon
id|asm
r_volatile
(paren
l_string|&quot;fc %0&quot;
op_scope_resolution
l_string|&quot;r&quot;
(paren
id|blockaddr
)paren
suffix:colon
l_string|&quot;memory&quot;
)paren
suffix:semicolon
id|ia64_sync_i
c_func
(paren
)paren
suffix:semicolon
id|ia64_srlz_d
c_func
(paren
)paren
suffix:semicolon
id|memcpy
(paren
id|cap-&gt;blockdata_fc
comma
id|CACHEALIGN
c_func
(paren
id|blockaddr
)paren
op_minus
l_int|128
comma
l_int|3
op_star
l_int|128
)paren
suffix:semicolon
r_if
c_cond
(paren
id|shadaddr
)paren
(brace
id|asm
r_volatile
(paren
l_string|&quot;fc %0&quot;
op_scope_resolution
l_string|&quot;r&quot;
(paren
id|shadaddr
)paren
suffix:colon
l_string|&quot;memory&quot;
)paren
suffix:semicolon
id|ia64_sync_i
c_func
(paren
)paren
suffix:semicolon
id|ia64_srlz_d
c_func
(paren
)paren
suffix:semicolon
id|memcpy
(paren
id|cap-&gt;shaddata_fc
comma
id|CACHEALIGN
c_func
(paren
id|shadaddr
)paren
op_minus
l_int|128
comma
l_int|3
op_star
l_int|128
)paren
suffix:semicolon
)brace
)brace
DECL|variable|zranmult
r_int
id|zranmult
op_assign
l_int|0x48c27395
suffix:semicolon
r_static
id|uint
DECL|function|zrandom
id|zrandom
(paren
id|uint
op_star
id|seedp
)paren
(brace
op_star
id|seedp
op_assign
(paren
op_star
id|seedp
op_star
id|zranmult
)paren
op_amp
l_int|0x7fffffff
suffix:semicolon
r_return
(paren
op_star
id|seedp
)paren
suffix:semicolon
)brace
r_void
DECL|function|set_autotest_params
id|set_autotest_params
c_func
(paren
r_void
)paren
(brace
r_static
r_int
id|testnumber
op_assign
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|llsctest_number
op_ge
l_int|0
)paren
(brace
id|testnumber
op_assign
id|llsctest_number
suffix:semicolon
)brace
r_else
(brace
id|testnumber
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|autotest_table
(braket
id|testnumber
)braket
dot
id|passes
op_eq
l_int|0
)paren
(brace
id|testnumber
op_assign
l_int|0
suffix:semicolon
id|dump_block_addrs_opt
op_assign
l_int|0
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|testnumber
op_eq
l_int|0
op_logical_and
id|l4_opt
)paren
id|testnumber
op_assign
l_int|9
suffix:semicolon
id|k_passes
op_assign
id|autotest_table
(braket
id|testnumber
)braket
dot
id|passes
suffix:semicolon
id|k_linepad
op_assign
id|autotest_table
(braket
id|testnumber
)braket
dot
id|linepad
suffix:semicolon
id|k_linecount
op_assign
id|autotest_table
(braket
id|testnumber
)braket
dot
id|linecount
suffix:semicolon
id|k_testnumber
op_assign
id|testnumber
suffix:semicolon
r_if
c_cond
(paren
id|IS_RUNNING_ON_SIMULATOR
c_func
(paren
)paren
)paren
(brace
id|printk
(paren
l_string|&quot;llsc start test %ld&bslash;n&quot;
comma
id|k_testnumber
)paren
suffix:semicolon
id|k_passes
op_assign
l_int|1000
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|set_leds
id|set_leds
c_func
(paren
r_int
id|errs
)paren
(brace
r_int
r_char
id|leds
op_assign
l_int|0
suffix:semicolon
multiline_comment|/*&n;&t; * Leds are:&n;&t; * &t;ppppeee-  &n;&t; *   where&n;&t; *      pppp = test number&n;&t; *       eee = error count but top bit is stick&n;&t; */
id|leds
op_assign
(paren
(paren
id|errs
op_amp
l_int|7
)paren
op_lshift
l_int|1
)paren
op_or
(paren
(paren
id|k_testnumber
op_amp
l_int|15
)paren
op_lshift
l_int|4
)paren
op_or
(paren
id|errs
ques
c_cond
l_int|0x08
suffix:colon
l_int|0
)paren
suffix:semicolon
id|set_led_bits
c_func
(paren
id|leds
comma
id|LED_MASK_AUTOTEST
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|setup_block_addresses
id|setup_block_addresses
c_func
(paren
r_void
)paren
(brace
r_int
id|i
comma
id|stride
comma
id|memmapi
suffix:semicolon
id|dataline_t
op_star
id|dp
suffix:semicolon
r_int
op_star
id|ip
comma
op_star
id|ipe
suffix:semicolon
id|stride
op_assign
id|k_linepad
op_plus
r_sizeof
(paren
id|dataline_t
)paren
suffix:semicolon
id|memmapi
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|memmapx
suffix:semicolon
id|i
op_increment
)paren
(brace
id|memmap
(braket
id|i
)braket
dot
id|nextaddr
op_assign
id|memmap
(braket
id|i
)braket
dot
id|vstart
suffix:semicolon
id|memmap
(braket
id|i
)braket
dot
id|nextinit
op_assign
id|memmap
(braket
id|i
)braket
dot
id|vstart
suffix:semicolon
id|memmap
(braket
id|i
)braket
dot
id|wrapcount
op_assign
l_int|0
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|k_linecount
suffix:semicolon
id|i
op_increment
)paren
(brace
id|blocks
(braket
id|i
)braket
op_assign
id|memmap
(braket
id|memmapi
)braket
dot
id|nextaddr
suffix:semicolon
id|dp
op_assign
(paren
id|dataline_t
op_star
)paren
id|blocks
(braket
id|i
)braket
suffix:semicolon
id|memmap
(braket
id|memmapi
)braket
dot
id|nextaddr
op_add_assign
(paren
id|stride
op_amp
l_int|0xffff
)paren
suffix:semicolon
r_if
c_cond
(paren
id|memmap
(braket
id|memmapi
)braket
dot
id|nextaddr
op_plus
r_sizeof
(paren
id|dataline_t
)paren
op_ge
id|memmap
(braket
id|memmapi
)braket
dot
id|vend
)paren
(brace
id|memmap
(braket
id|memmapi
)braket
dot
id|wrapcount
op_increment
suffix:semicolon
id|memmap
(braket
id|memmapi
)braket
dot
id|nextaddr
op_assign
id|memmap
(braket
id|memmapi
)braket
dot
id|vstart
op_plus
id|memmap
(braket
id|memmapi
)braket
dot
id|wrapcount
op_star
r_sizeof
(paren
id|dataline_t
)paren
suffix:semicolon
)brace
id|ip
op_assign
(paren
r_int
op_star
)paren
(paren
(paren
id|memmap
(braket
id|memmapi
)braket
dot
id|nextinit
op_plus
l_int|7
)paren
op_amp
op_complement
l_int|7
)paren
suffix:semicolon
id|ipe
op_assign
(paren
r_int
op_star
)paren
(paren
id|memmap
(braket
id|memmapi
)braket
dot
id|nextaddr
op_plus
l_int|2
op_star
r_sizeof
(paren
id|dataline_t
)paren
op_plus
l_int|8
)paren
suffix:semicolon
r_while
c_loop
(paren
id|ip
op_le
id|ipe
op_logical_and
id|ip
OL
(paren
(paren
r_int
op_star
)paren
id|memmap
(braket
id|memmapi
)braket
dot
id|vend
op_minus
l_int|8
)paren
)paren
(brace
op_star
id|ip
op_increment
op_assign
(paren
r_int
)paren
id|ip
suffix:semicolon
)brace
id|memmap
(braket
id|memmapi
)braket
dot
id|nextinit
op_assign
(paren
r_int
)paren
id|ipe
suffix:semicolon
id|dp-&gt;guard1
op_assign
id|BGUARD
c_func
(paren
id|i
)paren
suffix:semicolon
id|dp-&gt;guard2
op_assign
id|EGUARD
c_func
(paren
id|i
)paren
suffix:semicolon
id|dp-&gt;lock
(braket
l_int|0
)braket
op_assign
id|dp-&gt;lock
(braket
l_int|1
)braket
op_assign
id|NOLOCK
suffix:semicolon
id|dp-&gt;share
(braket
l_int|0
)braket
op_assign
id|dp-&gt;share0
op_assign
l_int|0x1111
suffix:semicolon
id|dp-&gt;share
(braket
l_int|1
)braket
op_assign
id|dp-&gt;share1
op_assign
l_int|0x2222
suffix:semicolon
id|memcpy
c_func
(paren
id|dp
op_member_access_from_pointer
r_private
comma
id|init_private
comma
id|LLSC_MAXCPUS
op_star
r_sizeof
(paren
id|private_t
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|stride
OG
l_int|16384
)paren
(brace
id|memmapi
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|memmapi
op_eq
id|memmapx
)paren
id|memmapi
op_assign
l_int|0
suffix:semicolon
)brace
)brace
)brace
r_static
r_void
DECL|function|dump_block_addrs
id|dump_block_addrs
c_func
(paren
r_void
)paren
(brace
r_int
id|i
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;LLSC TestNumber %ld&bslash;n&quot;
comma
id|k_testnumber
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|k_linecount
suffix:semicolon
id|i
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;  %lx&quot;
comma
id|blocks
(braket
id|i
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
id|i
op_mod
l_int|4
op_eq
l_int|3
)paren
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|set_thread_state
id|set_thread_state
c_func
(paren
r_int
id|cpuid
comma
r_int
id|state
)paren
(brace
r_if
c_cond
(paren
id|k_threadprivate
(braket
id|cpuid
)braket
op_member_access_from_pointer
id|threadstate
op_eq
id|TS_KILLED
)paren
(brace
id|set_led_bits
c_func
(paren
id|LED_MASK_AUTOTEST
comma
id|LED_MASK_AUTOTEST
)paren
suffix:semicolon
r_while
c_loop
(paren
l_int|1
)paren
(brace
suffix:semicolon
)brace
)brace
id|k_threadprivate
(braket
id|cpuid
)braket
op_member_access_from_pointer
id|threadstate
op_assign
id|state
suffix:semicolon
)brace
r_static
r_int
DECL|function|build_mem_map
id|build_mem_map
c_func
(paren
r_int
r_int
id|start
comma
r_int
r_int
id|end
comma
r_void
op_star
id|arg
)paren
(brace
r_int
id|lstart
suffix:semicolon
r_int
id|align
op_assign
l_int|8
op_star
id|MB
suffix:semicolon
multiline_comment|/*&n;&t; * HACK - skip the kernel on the first node &n;&t; */
id|printk
(paren
l_string|&quot;LLSC memmap: start 0x%lx, end 0x%lx, (0x%lx - 0x%lx)&bslash;n&quot;
comma
id|start
comma
id|end
comma
(paren
r_int
)paren
id|virt_to_page
c_func
(paren
id|start
)paren
comma
(paren
r_int
)paren
id|virt_to_page
c_func
(paren
id|end
op_minus
id|PAGE_SIZE
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|memmapx
op_ge
id|MAPCHUNKS
)paren
r_return
l_int|0
suffix:semicolon
r_while
c_loop
(paren
id|end
OG
id|start
op_logical_and
(paren
id|PageReserved
c_func
(paren
id|virt_to_page
c_func
(paren
id|end
op_minus
id|PAGE_SIZE
)paren
)paren
op_logical_or
id|virt_to_page
c_func
(paren
id|end
op_minus
id|PAGE_SIZE
)paren
op_member_access_from_pointer
id|count.counter
OG
l_int|0
)paren
)paren
id|end
op_sub_assign
id|PAGE_SIZE
suffix:semicolon
id|lstart
op_assign
id|end
suffix:semicolon
r_while
c_loop
(paren
id|lstart
OG
id|start
op_logical_and
(paren
op_logical_neg
id|PageReserved
c_func
(paren
id|virt_to_page
c_func
(paren
id|lstart
op_minus
id|PAGE_SIZE
)paren
)paren
op_logical_and
id|virt_to_page
c_func
(paren
id|lstart
op_minus
id|PAGE_SIZE
)paren
op_member_access_from_pointer
id|count.counter
op_eq
l_int|0
)paren
)paren
id|lstart
op_sub_assign
id|PAGE_SIZE
suffix:semicolon
id|lstart
op_assign
(paren
id|lstart
op_plus
id|align
op_minus
l_int|1
)paren
op_div
id|align
op_star
id|align
suffix:semicolon
id|end
op_assign
id|end
op_div
id|align
op_star
id|align
suffix:semicolon
r_if
c_cond
(paren
id|lstart
op_ge
id|end
)paren
r_return
l_int|0
suffix:semicolon
id|printk
(paren
l_string|&quot;     memmap: start 0x%lx, end 0x%lx&bslash;n&quot;
comma
id|lstart
comma
id|end
)paren
suffix:semicolon
id|memmap
(braket
id|memmapx
)braket
dot
id|vstart
op_assign
id|lstart
suffix:semicolon
id|memmap
(braket
id|memmapx
)braket
dot
id|vend
op_assign
id|end
suffix:semicolon
id|memmapx
op_increment
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_void
id|int_test
c_func
(paren
r_void
)paren
suffix:semicolon
r_int
DECL|function|llsc_main
id|llsc_main
(paren
r_int
id|cpuid
comma
r_int
id|mbasex
)paren
(brace
r_int
id|i
comma
id|cpu
comma
id|is_master
comma
id|repeatcnt
op_assign
l_int|0
suffix:semicolon
r_int
r_int
id|preverr
op_assign
l_int|0
comma
id|errs
op_assign
l_int|0
comma
id|pass
op_assign
l_int|0
suffix:semicolon
r_int
id|automode
op_assign
l_int|0
suffix:semicolon
macro_line|#ifdef INTTEST
r_if
c_cond
(paren
id|inttest
)paren
id|int_test
c_func
(paren
)paren
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
op_logical_neg
id|autotest_enabled
)paren
r_return
l_int|0
suffix:semicolon
macro_line|#ifdef CONFIG_SMP
id|is_master
op_assign
op_logical_neg
id|smp_processor_id
c_func
(paren
)paren
suffix:semicolon
macro_line|#else
id|is_master
op_assign
l_int|1
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
id|is_master
)paren
(brace
id|print_params
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|IS_RUNNING_ON_SIMULATOR
c_func
(paren
)paren
)paren
(brace
id|spin
c_func
(paren
l_int|10
)paren
suffix:semicolon
)brace
id|mbase
op_assign
(paren
id|control_t
op_star
)paren
id|mbasex
suffix:semicolon
id|k_currentpass
op_assign
l_int|0
suffix:semicolon
id|k_go
op_assign
id|ST_IDLE
suffix:semicolon
id|k_passes
op_assign
id|DEF_PASSES
suffix:semicolon
id|k_napticks
op_assign
id|DEF_NAPTICKS
suffix:semicolon
id|k_stop_on_error
op_assign
id|DEF_STOP_ON_ERROR
suffix:semicolon
id|k_verbose
op_assign
id|DEF_VERBOSE
suffix:semicolon
id|k_linecount
op_assign
id|DEF_LINECOUNT
suffix:semicolon
id|k_iter_msg
op_assign
id|DEF_ITER_MSG
suffix:semicolon
id|k_vv
op_assign
id|DEF_VV
suffix:semicolon
id|k_linepad
op_assign
id|DEF_LINEPAD
suffix:semicolon
id|k_blocks
op_assign
(paren
r_void
op_star
)paren
id|blocks
suffix:semicolon
id|efi_memmap_walk
c_func
(paren
id|build_mem_map
comma
l_int|0
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_IA64_SGI_AUTOTEST
id|automode
op_assign
l_int|1
suffix:semicolon
macro_line|#endif
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|LLSC_MAXCPUS
suffix:semicolon
id|i
op_increment
)paren
(brace
id|k_threadprivate
(braket
id|i
)braket
op_assign
id|THREADPRIVATE
c_func
(paren
id|i
)paren
suffix:semicolon
id|memset
c_func
(paren
id|k_threadprivate
(braket
id|i
)braket
comma
l_int|0
comma
r_sizeof
(paren
op_star
id|k_threadprivate
(braket
id|i
)braket
)paren
)paren
suffix:semicolon
id|init_private
(braket
id|i
)braket
op_assign
id|i
suffix:semicolon
)brace
id|initialized
op_assign
l_int|1
suffix:semicolon
)brace
r_else
(brace
r_while
c_loop
(paren
id|initialized
op_eq
l_int|0
)paren
id|udelay
c_func
(paren
l_int|100
)paren
suffix:semicolon
)brace
id|loop
suffix:colon
r_if
c_cond
(paren
id|is_master
)paren
(brace
r_if
c_cond
(paren
id|automode
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|preverr
op_logical_or
id|repeatcnt
op_increment
OG
l_int|5
)paren
(brace
id|set_autotest_params
c_func
(paren
)paren
suffix:semicolon
id|repeatcnt
op_assign
l_int|0
suffix:semicolon
)brace
)brace
r_else
(brace
r_while
c_loop
(paren
id|k_go
op_eq
id|ST_IDLE
)paren
suffix:semicolon
)brace
id|k_go
op_assign
id|ST_INIT
suffix:semicolon
r_if
c_cond
(paren
id|k_linecount
OG
id|MAX_LINECOUNT
)paren
id|k_linecount
op_assign
id|MAX_LINECOUNT
suffix:semicolon
id|k_linecount
op_assign
id|k_linecount
op_amp
op_complement
l_int|1
suffix:semicolon
id|setup_block_addresses
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|preverr
op_logical_and
id|dump_block_addrs_opt
)paren
id|dump_block_addrs
c_func
(paren
)paren
suffix:semicolon
id|k_currentpass
op_assign
id|pass
op_increment
suffix:semicolon
id|k_go
op_assign
id|ST_RUN
suffix:semicolon
r_if
c_cond
(paren
id|fail_enabled
)paren
id|fail_enabled
op_decrement
suffix:semicolon
)brace
r_else
(brace
r_while
c_loop
(paren
id|k_go
op_ne
id|ST_RUN
op_logical_or
id|k_currentpass
op_ne
id|pass
)paren
suffix:semicolon
id|pass
op_increment
suffix:semicolon
)brace
id|set_leds
c_func
(paren
id|errs
)paren
suffix:semicolon
id|set_thread_state
c_func
(paren
id|cpuid
comma
id|TS_RUNNING
)paren
suffix:semicolon
id|errs
op_add_assign
id|ran_conf_llsc
c_func
(paren
id|cpuid
)paren
suffix:semicolon
id|preverr
op_assign
(paren
id|k_go
op_eq
id|ST_ERRSTOP
)paren
suffix:semicolon
id|set_leds
c_func
(paren
id|errs
)paren
suffix:semicolon
id|set_thread_state
c_func
(paren
id|cpuid
comma
id|TS_STOPPED
)paren
suffix:semicolon
r_if
c_cond
(paren
id|is_master
)paren
(brace
id|Speedo
c_func
(paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
comma
id|cpu
op_assign
l_int|0
suffix:semicolon
id|cpu
OL
id|LLSC_MAXCPUS
suffix:semicolon
id|cpu
op_increment
)paren
(brace
r_while
c_loop
(paren
id|k_threadprivate
(braket
id|cpu
)braket
op_member_access_from_pointer
id|threadstate
op_eq
id|TS_RUNNING
)paren
(brace
id|i
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|i
op_eq
l_int|10000
)paren
(brace
id|k_go
op_assign
id|ST_STOP
suffix:semicolon
id|printk
(paren
l_string|&quot;  llsc master stopping test number %ld&bslash;n&quot;
comma
id|k_testnumber
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|i
OG
l_int|100000
)paren
(brace
id|k_threadprivate
(braket
id|cpu
)braket
op_member_access_from_pointer
id|threadstate
op_assign
id|TS_KILLED
suffix:semicolon
id|printk
(paren
l_string|&quot;  llsc: master killing cpuid %d, running test number %ld&bslash;n&quot;
comma
id|cpu
comma
id|k_testnumber
)paren
suffix:semicolon
)brace
id|udelay
c_func
(paren
l_int|1000
)paren
suffix:semicolon
)brace
)brace
)brace
r_goto
id|loop
suffix:semicolon
)brace
r_static
r_void
DECL|function|Speedo
id|Speedo
c_func
(paren
r_void
)paren
(brace
r_static
r_int
id|i
op_assign
l_int|0
suffix:semicolon
r_switch
c_cond
(paren
op_increment
id|i
op_mod
l_int|4
)paren
(brace
r_case
l_int|0
suffix:colon
id|printk
c_func
(paren
l_string|&quot;|&bslash;b&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|printk
c_func
(paren
l_string|&quot;&bslash;&bslash;&bslash;b&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|printk
c_func
(paren
l_string|&quot;-&bslash;b&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
id|printk
c_func
(paren
l_string|&quot;/&bslash;b&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
macro_line|#ifdef INTTEST
multiline_comment|/* ======================================================================================================== &n; *&n; * Some test code to verify that interrupts work&n; *&n; * Add the following to the arch/ia64/kernel/smp.c after the comment &quot;Reschedule callback&quot;&n; * &t;&t;if (zzzprint_resched) printk(&quot;  cpu %d got interrupt&bslash;n&quot;, smp_processor_id());&n; *&n; * Enable the code in arch/ia64/sn/sn1/smp.c to print sending IPIs.&n; *&n; */
DECL|function|set_inttest
r_static
r_int
id|__init
id|set_inttest
c_func
(paren
r_char
op_star
id|str
)paren
(brace
id|inttest
op_assign
l_int|1
suffix:semicolon
id|autotest_enabled
op_assign
l_int|1
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
id|__setup
c_func
(paren
l_string|&quot;inttest=&quot;
comma
id|set_inttest
)paren
suffix:semicolon
DECL|variable|zzzprint_resched
r_int
id|zzzprint_resched
op_assign
l_int|0
suffix:semicolon
r_void
DECL|function|int_test
id|int_test
c_func
(paren
)paren
(brace
r_int
id|mycpu
comma
id|cpu
suffix:semicolon
r_static
r_volatile
r_int
id|control_cpu
op_assign
l_int|0
suffix:semicolon
id|mycpu
op_assign
id|smp_processor_id
c_func
(paren
)paren
suffix:semicolon
id|zzzprint_resched
op_assign
l_int|2
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;Testing cross interrupts&bslash;n&quot;
)paren
suffix:semicolon
r_while
c_loop
(paren
id|control_cpu
op_ne
id|smp_num_cpus
)paren
(brace
r_if
c_cond
(paren
id|mycpu
op_eq
id|cpu_logical_map
c_func
(paren
id|control_cpu
)paren
)paren
(brace
r_for
c_loop
(paren
id|cpu
op_assign
l_int|0
suffix:semicolon
id|cpu
OL
id|smp_num_cpus
suffix:semicolon
id|cpu
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;Sending interrupt from %d to %d&bslash;n&quot;
comma
id|mycpu
comma
id|cpu_logical_map
c_func
(paren
id|cpu
)paren
)paren
suffix:semicolon
id|udelay
c_func
(paren
id|IS_RUNNING_ON_SIMULATOR
ques
c_cond
l_int|10000
suffix:colon
l_int|400000
)paren
suffix:semicolon
id|smp_send_reschedule
c_func
(paren
id|cpu_logical_map
c_func
(paren
id|cpu
)paren
)paren
suffix:semicolon
id|udelay
c_func
(paren
id|IS_RUNNING_ON_SIMULATOR
ques
c_cond
l_int|10000
suffix:colon
l_int|400000
)paren
suffix:semicolon
id|smp_send_reschedule
c_func
(paren
id|cpu_logical_map
c_func
(paren
id|cpu
)paren
)paren
suffix:semicolon
id|udelay
c_func
(paren
id|IS_RUNNING_ON_SIMULATOR
ques
c_cond
l_int|10000
suffix:colon
l_int|400000
)paren
suffix:semicolon
)brace
id|control_cpu
op_increment
suffix:semicolon
)brace
)brace
id|zzzprint_resched
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|mycpu
op_eq
id|cpu_logical_map
c_func
(paren
id|smp_num_cpus
op_minus
l_int|1
)paren
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;&bslash;nTight loop of cpu %d sending ints to cpu 0 (every 100 us)&bslash;n&quot;
comma
id|mycpu
)paren
suffix:semicolon
id|udelay
c_func
(paren
id|IS_RUNNING_ON_SIMULATOR
ques
c_cond
l_int|1000
suffix:colon
l_int|1000000
)paren
suffix:semicolon
id|__cli
c_func
(paren
)paren
suffix:semicolon
r_while
c_loop
(paren
l_int|1
)paren
(brace
id|smp_send_reschedule
c_func
(paren
l_int|0
)paren
suffix:semicolon
id|udelay
c_func
(paren
l_int|100
)paren
suffix:semicolon
)brace
)brace
r_while
c_loop
(paren
l_int|1
)paren
(brace
suffix:semicolon
)brace
)brace
macro_line|#endif
eof
