multiline_comment|/*&n; * arch/sh/boards/saturn/irq.c&n; *&n; * Copyright (C) 2002 Paul Mundt&n; *&n; * Released under the terms of the GNU GPL v2.0.&n; */
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;asm/saturn/saturn.h&gt;
macro_line|#include &lt;asm/saturn/irq.h&gt;
macro_line|#include &lt;asm/irq.h&gt;
macro_line|#include &lt;asm/io.h&gt;
multiline_comment|/*&n; * Interrupts map out as follows:&n; *&n; *  Vector&t;Name&t;&t;Mask&n; *&n; * &t;64&t;VBLANKIN&t;0x0001&n; * &t;65&t;VBLANKOUT&t;0x0002&n; *&t;66&t;HBLANKIN&t;0x0004&n; *&t;67&t;TIMER0&t;&t;0x0008&n; *&t;68&t;TIMER1&t;&t;0x0010&n; *&t;69&t;DSPEND&t;&t;0x0020&n; *&t;70&t;SOUNDREQUEST&t;0x0040&n; *&t;71&t;SYSTEMMANAGER&t;0x0080&n; *&t;72&t;PAD&t;&t;0x0100&n; *&t;73&t;LEVEL2DMAEND&t;0x0200&n; *&t;74&t;LEVEL1DMAEND&t;0x0400&n; *&t;75&t;LEVEL0DMAEND&t;0x0800&n; *&t;76&t;DMAILLEGAL&t;0x1000&n; *&t;77&t;SRITEDRAWEND&t;0x2000&n; *&t;78&t;ABUS&t;&t;0x8000&n; *&n; */
DECL|macro|SATURN_IRQ_MIN
mdefine_line|#define SATURN_IRQ_MIN&t;&t;64&t;/* VBLANKIN */
DECL|macro|SATURN_IRQ_MAX
mdefine_line|#define SATURN_IRQ_MAX&t;&t;78&t;/* ABUS */
DECL|macro|SATURN_IRQ_MASK
mdefine_line|#define SATURN_IRQ_MASK&t;&t;0xbfff
DECL|function|saturn_irq_mask
r_static
r_inline
id|u32
id|saturn_irq_mask
c_func
(paren
r_int
r_int
id|irq_nr
)paren
(brace
id|u32
id|mask
suffix:semicolon
id|mask
op_assign
(paren
l_int|1
op_lshift
(paren
id|irq_nr
op_minus
id|SATURN_IRQ_MIN
)paren
)paren
suffix:semicolon
id|mask
op_lshift_assign
(paren
id|irq_nr
op_eq
id|SATURN_IRQ_MAX
)paren
suffix:semicolon
id|mask
op_and_assign
id|SATURN_IRQ_MASK
suffix:semicolon
r_return
id|mask
suffix:semicolon
)brace
DECL|function|mask_saturn_irq
r_static
r_inline
r_void
id|mask_saturn_irq
c_func
(paren
r_int
r_int
id|irq_nr
)paren
(brace
id|u32
id|mask
suffix:semicolon
id|mask
op_assign
id|ctrl_inl
c_func
(paren
id|SATURN_IMR
)paren
suffix:semicolon
id|mask
op_or_assign
id|saturn_irq_mask
c_func
(paren
id|irq_nr
)paren
suffix:semicolon
id|ctrl_outl
c_func
(paren
id|mask
comma
id|SATURN_IMR
)paren
suffix:semicolon
)brace
DECL|function|unmask_saturn_irq
r_static
r_inline
r_void
id|unmask_saturn_irq
c_func
(paren
r_int
r_int
id|irq_nr
)paren
(brace
id|u32
id|mask
suffix:semicolon
id|mask
op_assign
id|ctrl_inl
c_func
(paren
id|SATURN_IMR
)paren
suffix:semicolon
id|mask
op_and_assign
op_complement
id|saturn_irq_mask
c_func
(paren
id|irq_nr
)paren
suffix:semicolon
id|ctrl_outl
c_func
(paren
id|SATURN_IMR
)paren
suffix:semicolon
)brace
DECL|function|disable_saturn_irq
r_static
r_void
id|disable_saturn_irq
c_func
(paren
r_int
r_int
id|irq_nr
)paren
(brace
id|mask_saturn_irq
c_func
(paren
id|irq_nr
)paren
suffix:semicolon
)brace
DECL|function|enable_saturn_irq
r_static
r_void
id|enable_saturn_irq
c_func
(paren
r_int
r_int
id|irq_nr
)paren
(brace
id|unmask_saturn_irq
c_func
(paren
id|irq_nr
)paren
suffix:semicolon
)brace
DECL|function|mask_and_ack_saturn_irq
r_static
r_void
id|mask_and_ack_saturn_irq
c_func
(paren
r_int
r_int
id|irq_nr
)paren
(brace
id|mask_saturn_irq
c_func
(paren
id|irq_nr
)paren
suffix:semicolon
)brace
DECL|function|end_saturn_irq
r_static
r_void
id|end_saturn_irq
c_func
(paren
r_int
r_int
id|irq_nr
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|irq_desc
(braket
id|irq
)braket
dot
id|status
op_amp
(paren
id|IRQ_DISABLED
op_or
id|IRQ_INPROGRESS
)paren
)paren
)paren
id|unmask_saturn_irq
c_func
(paren
id|irq_nr
)paren
suffix:semicolon
)brace
DECL|function|startup_saturn_irq
r_static
r_int
r_int
id|startup_saturn_irq
c_func
(paren
r_int
r_int
id|irq_nr
)paren
(brace
id|unmask_saturn_irq
c_func
(paren
id|irq_nr
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|shutdown_saturn_irq
r_static
r_void
id|shutdown_saturn_irq
c_func
(paren
r_int
r_int
id|irq_nr
)paren
(brace
id|mask_saturn_irq
c_func
(paren
id|irq_nr
)paren
suffix:semicolon
)brace
DECL|variable|saturn_int
r_static
r_struct
id|hw_interrupt_type
id|saturn_int
op_assign
(brace
r_typename
suffix:colon
l_string|&quot;Saturn&quot;
comma
id|enable
suffix:colon
id|enable_saturn_irq
comma
id|disable
suffix:colon
id|disable_saturn_irq
comma
id|ack
suffix:colon
id|mask_and_ack_saturn_irq
comma
id|end
suffix:colon
id|end_saturn_irq
comma
id|startup
suffix:colon
id|startup_saturn_irq
comma
id|shutdown
suffix:colon
id|shutdown_saturn_irq
comma
)brace
suffix:semicolon
DECL|function|saturn_irq_demux
r_int
id|saturn_irq_demux
c_func
(paren
r_int
id|irq_nr
)paren
(brace
multiline_comment|/* FIXME */
r_return
id|irq_nr
suffix:semicolon
)brace
eof
