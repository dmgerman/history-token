multiline_comment|/*&n; * linux/arch/sh/kernel/io_ec3104.c&n; *  EC3104 companion chip support&n; *&n; * Copyright (C) 2000 Philipp Rumpf &lt;prumpf@tux.org&gt;&n; *&n; */
multiline_comment|/* EC3104 note:&n; * This code was written without any documentation about the EC3104 chip.  While&n; * I hope I got most of the basic functionality right, the register names I use&n; * are most likely completely different from those in the chip documentation.&n; *&n; * If you have any further information about the EC3104, please tell me&n; * (prumpf@tux.org).&n; */
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/types.h&gt;
macro_line|#include &lt;asm/io.h&gt;
macro_line|#include &lt;asm/page.h&gt;
macro_line|#include &lt;asm/ec3104.h&gt;
multiline_comment|/*&n; * EC3104 has a real ISA bus which we redirect low port accesses to (the&n; * actual device on mine is a ESS 1868, and I don&squot;t want to hack the driver&n; * more than strictly necessary).  I am not going to duplicate the&n; * hard coding of PC addresses (for the 16550s aso) here though;  it&squot;s just&n; * too ugly.&n; */
DECL|macro|low_port
mdefine_line|#define low_port(port) ((port) &lt; 0x10000)
DECL|function|port2addr
r_static
r_inline
r_int
r_int
id|port2addr
c_func
(paren
r_int
r_int
id|port
)paren
(brace
r_switch
c_cond
(paren
id|port
op_rshift
l_int|16
)paren
(brace
r_case
l_int|0
suffix:colon
r_return
id|EC3104_ISA_BASE
op_plus
id|port
op_star
l_int|2
suffix:semicolon
multiline_comment|/* XXX hack. it&squot;s unclear what to do about the serial ports */
r_case
l_int|1
suffix:colon
r_return
id|EC3104_BASE
op_plus
(paren
id|port
op_amp
l_int|0xffff
)paren
op_star
l_int|4
suffix:semicolon
r_default
suffix:colon
multiline_comment|/* XXX PCMCIA */
r_return
l_int|0
suffix:semicolon
)brace
)brace
DECL|function|ec3104_inb
r_int
r_char
id|ec3104_inb
c_func
(paren
r_int
r_int
id|port
)paren
(brace
id|u8
id|ret
suffix:semicolon
id|ret
op_assign
op_star
(paren
r_volatile
id|u8
op_star
)paren
id|port2addr
c_func
(paren
id|port
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
DECL|function|ec3104_inw
r_int
r_int
id|ec3104_inw
c_func
(paren
r_int
r_int
id|port
)paren
(brace
id|BUG
c_func
(paren
)paren
suffix:semicolon
)brace
DECL|function|ec3104_inl
r_int
r_int
id|ec3104_inl
c_func
(paren
r_int
r_int
id|port
)paren
(brace
id|BUG
c_func
(paren
)paren
suffix:semicolon
)brace
DECL|function|ec3104_outb
r_void
id|ec3104_outb
c_func
(paren
r_int
r_char
id|data
comma
r_int
r_int
id|port
)paren
(brace
op_star
(paren
r_volatile
id|u8
op_star
)paren
id|port2addr
c_func
(paren
id|port
)paren
op_assign
id|data
suffix:semicolon
)brace
DECL|function|ec3104_outw
r_void
id|ec3104_outw
c_func
(paren
r_int
r_int
id|data
comma
r_int
r_int
id|port
)paren
(brace
id|BUG
c_func
(paren
)paren
suffix:semicolon
)brace
DECL|function|ec3104_outl
r_void
id|ec3104_outl
c_func
(paren
r_int
r_int
id|data
comma
r_int
r_int
id|port
)paren
(brace
id|BUG
c_func
(paren
)paren
suffix:semicolon
)brace
eof
