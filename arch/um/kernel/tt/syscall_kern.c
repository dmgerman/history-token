multiline_comment|/* &n; * Copyright (C) 2000 - 2003 Jeff Dike (jdike@addtoit.com)&n; * Licensed under the GPL&n; */
macro_line|#include &quot;linux/types.h&quot;
macro_line|#include &quot;linux/utime.h&quot;
macro_line|#include &quot;linux/sys.h&quot;
macro_line|#include &quot;linux/ptrace.h&quot;
macro_line|#include &quot;asm/unistd.h&quot;
macro_line|#include &quot;asm/ptrace.h&quot;
macro_line|#include &quot;asm/uaccess.h&quot;
macro_line|#include &quot;asm/stat.h&quot;
macro_line|#include &quot;sysdep/syscalls.h&quot;
macro_line|#include &quot;kern_util.h&quot;
DECL|function|check_area
r_static
r_inline
r_int
id|check_area
c_func
(paren
r_void
op_star
id|ptr
comma
r_int
id|size
)paren
(brace
r_return
id|verify_area
c_func
(paren
id|VERIFY_WRITE
comma
id|ptr
comma
id|size
)paren
suffix:semicolon
)brace
DECL|function|check_readlink
r_static
r_int
id|check_readlink
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
r_return
id|check_area
c_func
(paren
(paren
r_void
op_star
)paren
id|UPT_SYSCALL_ARG1
c_func
(paren
op_amp
id|regs-&gt;regs
)paren
comma
id|UPT_SYSCALL_ARG2
c_func
(paren
op_amp
id|regs-&gt;regs
)paren
)paren
suffix:semicolon
)brace
DECL|function|check_utime
r_static
r_int
id|check_utime
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
r_return
id|check_area
c_func
(paren
(paren
r_void
op_star
)paren
id|UPT_SYSCALL_ARG1
c_func
(paren
op_amp
id|regs-&gt;regs
)paren
comma
r_sizeof
(paren
r_struct
id|utimbuf
)paren
)paren
suffix:semicolon
)brace
DECL|function|check_oldstat
r_static
r_int
id|check_oldstat
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
r_return
id|check_area
c_func
(paren
(paren
r_void
op_star
)paren
id|UPT_SYSCALL_ARG1
c_func
(paren
op_amp
id|regs-&gt;regs
)paren
comma
r_sizeof
(paren
r_struct
id|__old_kernel_stat
)paren
)paren
suffix:semicolon
)brace
DECL|function|check_stat
r_static
r_int
id|check_stat
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
r_return
id|check_area
c_func
(paren
(paren
r_void
op_star
)paren
id|UPT_SYSCALL_ARG1
c_func
(paren
op_amp
id|regs-&gt;regs
)paren
comma
r_sizeof
(paren
r_struct
id|stat
)paren
)paren
suffix:semicolon
)brace
DECL|function|check_stat64
r_static
r_int
id|check_stat64
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
r_return
id|check_area
c_func
(paren
(paren
r_void
op_star
)paren
id|UPT_SYSCALL_ARG1
c_func
(paren
op_amp
id|regs-&gt;regs
)paren
comma
r_sizeof
(paren
r_struct
id|stat64
)paren
)paren
suffix:semicolon
)brace
DECL|struct|bogus
r_struct
id|bogus
(brace
DECL|member|kernel_ds
r_int
id|kernel_ds
suffix:semicolon
DECL|member|check_params
r_int
(paren
op_star
id|check_params
)paren
(paren
r_struct
id|pt_regs
op_star
)paren
suffix:semicolon
)brace
suffix:semicolon
DECL|variable|this_is_bogus
r_struct
id|bogus
id|this_is_bogus
(braket
l_int|256
)braket
op_assign
(brace
(braket
id|__NR_mknod
)braket
op_assign
(brace
l_int|1
comma
l_int|NULL
)brace
comma
(braket
id|__NR_mkdir
)braket
op_assign
(brace
l_int|1
comma
l_int|NULL
)brace
comma
(braket
id|__NR_rmdir
)braket
op_assign
(brace
l_int|1
comma
l_int|NULL
)brace
comma
(braket
id|__NR_unlink
)braket
op_assign
(brace
l_int|1
comma
l_int|NULL
)brace
comma
(braket
id|__NR_symlink
)braket
op_assign
(brace
l_int|1
comma
l_int|NULL
)brace
comma
(braket
id|__NR_link
)braket
op_assign
(brace
l_int|1
comma
l_int|NULL
)brace
comma
(braket
id|__NR_rename
)braket
op_assign
(brace
l_int|1
comma
l_int|NULL
)brace
comma
(braket
id|__NR_umount
)braket
op_assign
(brace
l_int|1
comma
l_int|NULL
)brace
comma
(braket
id|__NR_mount
)braket
op_assign
(brace
l_int|1
comma
l_int|NULL
)brace
comma
(braket
id|__NR_pivot_root
)braket
op_assign
(brace
l_int|1
comma
l_int|NULL
)brace
comma
(braket
id|__NR_chdir
)braket
op_assign
(brace
l_int|1
comma
l_int|NULL
)brace
comma
(braket
id|__NR_chroot
)braket
op_assign
(brace
l_int|1
comma
l_int|NULL
)brace
comma
(braket
id|__NR_open
)braket
op_assign
(brace
l_int|1
comma
l_int|NULL
)brace
comma
(braket
id|__NR_quotactl
)braket
op_assign
(brace
l_int|1
comma
l_int|NULL
)brace
comma
(braket
id|__NR_sysfs
)braket
op_assign
(brace
l_int|1
comma
l_int|NULL
)brace
comma
(braket
id|__NR_readlink
)braket
op_assign
(brace
l_int|1
comma
id|check_readlink
)brace
comma
(braket
id|__NR_acct
)braket
op_assign
(brace
l_int|1
comma
l_int|NULL
)brace
comma
(braket
id|__NR_execve
)braket
op_assign
(brace
l_int|1
comma
l_int|NULL
)brace
comma
(braket
id|__NR_uselib
)braket
op_assign
(brace
l_int|1
comma
l_int|NULL
)brace
comma
(braket
id|__NR_statfs
)braket
op_assign
(brace
l_int|1
comma
l_int|NULL
)brace
comma
(braket
id|__NR_truncate
)braket
op_assign
(brace
l_int|1
comma
l_int|NULL
)brace
comma
(braket
id|__NR_access
)braket
op_assign
(brace
l_int|1
comma
l_int|NULL
)brace
comma
(braket
id|__NR_chmod
)braket
op_assign
(brace
l_int|1
comma
l_int|NULL
)brace
comma
(braket
id|__NR_chown
)braket
op_assign
(brace
l_int|1
comma
l_int|NULL
)brace
comma
(braket
id|__NR_lchown
)braket
op_assign
(brace
l_int|1
comma
l_int|NULL
)brace
comma
(braket
id|__NR_utime
)braket
op_assign
(brace
l_int|1
comma
id|check_utime
)brace
comma
(braket
id|__NR_oldlstat
)braket
op_assign
(brace
l_int|1
comma
id|check_oldstat
)brace
comma
(braket
id|__NR_oldstat
)braket
op_assign
(brace
l_int|1
comma
id|check_oldstat
)brace
comma
(braket
id|__NR_stat
)braket
op_assign
(brace
l_int|1
comma
id|check_stat
)brace
comma
(braket
id|__NR_lstat
)braket
op_assign
(brace
l_int|1
comma
id|check_stat
)brace
comma
(braket
id|__NR_stat64
)braket
op_assign
(brace
l_int|1
comma
id|check_stat64
)brace
comma
(braket
id|__NR_lstat64
)braket
op_assign
(brace
l_int|1
comma
id|check_stat64
)brace
comma
(braket
id|__NR_chown32
)braket
op_assign
(brace
l_int|1
comma
l_int|NULL
)brace
comma
)brace
suffix:semicolon
multiline_comment|/* sys_utimes */
DECL|function|check_bogosity
r_static
r_int
id|check_bogosity
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
r_struct
id|bogus
op_star
id|bogon
op_assign
op_amp
id|this_is_bogus
(braket
id|UPT_SYSCALL_NR
c_func
(paren
op_amp
id|regs-&gt;regs
)paren
)braket
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|bogon-&gt;kernel_ds
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|bogon-&gt;check_params
op_logical_and
(paren
op_star
id|bogon-&gt;check_params
)paren
(paren
id|regs
)paren
)paren
(brace
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
id|set_fs
c_func
(paren
id|KERNEL_DS
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_extern
id|syscall_handler_t
op_star
id|sys_call_table
(braket
)braket
suffix:semicolon
DECL|function|execute_syscall_tt
r_int
id|execute_syscall_tt
c_func
(paren
r_void
op_star
id|r
)paren
(brace
r_struct
id|pt_regs
op_star
id|regs
op_assign
id|r
suffix:semicolon
r_int
id|res
suffix:semicolon
r_int
id|syscall
suffix:semicolon
id|current-&gt;thread.nsyscalls
op_increment
suffix:semicolon
id|nsyscalls
op_increment
suffix:semicolon
id|syscall
op_assign
id|UPT_SYSCALL_NR
c_func
(paren
op_amp
id|regs-&gt;regs
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|syscall
op_ge
id|NR_syscalls
)paren
op_logical_or
(paren
id|syscall
OL
l_int|0
)paren
)paren
(brace
id|res
op_assign
op_minus
id|ENOSYS
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|honeypot
op_logical_and
id|check_bogosity
c_func
(paren
id|regs
)paren
)paren
(brace
id|res
op_assign
op_minus
id|EFAULT
suffix:semicolon
)brace
r_else
id|res
op_assign
id|EXECUTE_SYSCALL
c_func
(paren
id|syscall
comma
id|regs
)paren
suffix:semicolon
id|set_fs
c_func
(paren
id|USER_DS
)paren
suffix:semicolon
r_return
id|res
suffix:semicolon
)brace
multiline_comment|/*&n; * Overrides for Emacs so that we follow Linus&squot;s tabbing style.&n; * Emacs will notice this stuff at the end of the file and automatically&n; * adjust the settings for this buffer only.  This must remain at the end&n; * of the file.&n; * ---------------------------------------------------------------------------&n; * Local variables:&n; * c-file-style: &quot;linux&quot;&n; * End:&n; */
eof
