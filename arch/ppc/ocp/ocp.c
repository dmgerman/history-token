multiline_comment|/*&n; * ocp.c&n; *&n; *&t;The is drived from pci.c&n; *&n; * &t;Current Maintainer&n; *      Armin Kuster akuster@dslextreme.com&n; *      Jan, 2002&n; *&n; *&n; *&n; * This program is free software; you can redistribute  it and/or modify it&n; *  under  the terms of  the GNU General  Public License as published by the&n; *  Free Software Foundation;  either version 2 of the  License, or (at your&n; *  option) any later version.&n; *&n; *  THIS  SOFTWARE  IS PROVIDED   ``AS  IS&squot;&squot; AND   ANY  EXPRESS OR   IMPLIED&n; *  WARRANTIES,   INCLUDING, BUT NOT  LIMITED  TO, THE IMPLIED WARRANTIES OF&n; *  MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.  IN&n; *  NO  EVENT  SHALL   THE AUTHOR  BE    LIABLE FOR ANY   DIRECT,  INDIRECT,&n; *  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT&n; *  NOT LIMITED   TO, PROCUREMENT OF  SUBSTITUTE GOODS  OR SERVICES; LOSS OF&n; *  USE, DATA,  OR PROFITS; OR  BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON&n; *  ANY THEORY OF LIABILITY, WHETHER IN  CONTRACT, STRICT LIABILITY, OR TORT&n; *  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF&n; *  THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.&n; *&n; *  You should have received a copy of the  GNU General Public License along&n; *  with this program; if not, write  to the Free Software Foundation, Inc.,&n; *  675 Mass Ave, Cambridge, MA 02139, USA.&n; */
macro_line|#include &lt;linux/list.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/stddef.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;linux/types.h&gt;
macro_line|#include &lt;asm/io.h&gt;
macro_line|#include &lt;asm/ocp.h&gt;
macro_line|#include &lt;asm/errno.h&gt;
multiline_comment|/**&n; * ocp_get_num - This determines how many OCP devices of a given&n; * device are registered&n; * @device: OCP device such as HOST, PCI, GPT, UART, OPB, IIC, GPIO, EMAC, ZMII,&n; *&n; * The routine returns the number that devices which is registered&n; */
DECL|function|ocp_get_num
r_int
r_int
id|ocp_get_num
c_func
(paren
r_int
r_int
id|device
)paren
(brace
r_int
r_int
id|count
op_assign
l_int|0
suffix:semicolon
r_struct
id|ocp_device
op_star
id|ocp
suffix:semicolon
r_struct
id|list_head
op_star
id|ocp_l
suffix:semicolon
id|list_for_each
c_func
(paren
id|ocp_l
comma
op_amp
id|ocp_devices
)paren
(brace
id|ocp
op_assign
id|list_entry
c_func
(paren
id|ocp_l
comma
r_struct
id|ocp_device
comma
id|global_list
)paren
suffix:semicolon
r_if
c_cond
(paren
id|device
op_eq
id|ocp-&gt;device
)paren
id|count
op_increment
suffix:semicolon
)brace
r_return
id|count
suffix:semicolon
)brace
multiline_comment|/**&n; * ocp_get_dev - get ocp driver pointer for ocp device and instance of it&n; * @device: OCP device such as PCI, GPT, UART, OPB, IIC, GPIO, EMAC, ZMII&n; * @dev_num: ocp device number whos paddr you want&n; *&n; * The routine returns ocp device pointer&n; * in list based on device and instance of that device&n; *&n; */
r_struct
id|ocp_device
op_star
DECL|function|ocp_get_dev
id|ocp_get_dev
c_func
(paren
r_int
r_int
id|device
comma
r_int
id|dev_num
)paren
(brace
r_struct
id|ocp_device
op_star
id|ocp
suffix:semicolon
r_struct
id|list_head
op_star
id|ocp_l
suffix:semicolon
r_int
id|count
op_assign
l_int|0
suffix:semicolon
id|list_for_each
c_func
(paren
id|ocp_l
comma
op_amp
id|ocp_devices
)paren
(brace
id|ocp
op_assign
id|list_entry
c_func
(paren
id|ocp_l
comma
r_struct
id|ocp_device
comma
id|global_list
)paren
suffix:semicolon
r_if
c_cond
(paren
id|device
op_eq
id|ocp-&gt;device
)paren
(brace
r_if
c_cond
(paren
id|dev_num
op_eq
id|count
)paren
r_return
id|ocp
suffix:semicolon
id|count
op_increment
suffix:semicolon
)brace
)brace
r_return
l_int|NULL
suffix:semicolon
)brace
DECL|variable|ocp_get_dev
id|EXPORT_SYMBOL
c_func
(paren
id|ocp_get_dev
)paren
suffix:semicolon
DECL|variable|ocp_get_num
id|EXPORT_SYMBOL
c_func
(paren
id|ocp_get_num
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_PM
DECL|function|ocp_generic_suspend
r_int
id|ocp_generic_suspend
c_func
(paren
r_struct
id|ocp_device
op_star
id|pdev
comma
id|u32
id|state
)paren
(brace
id|ocp_force_power_off
c_func
(paren
id|pdev
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|ocp_generic_resume
r_int
id|ocp_generic_resume
c_func
(paren
r_struct
id|ocp_device
op_star
id|pdev
)paren
(brace
id|ocp_force_power_on
c_func
(paren
id|pdev
)paren
suffix:semicolon
)brace
DECL|variable|ocp_generic_suspend
id|EXPORT_SYMBOL
c_func
(paren
id|ocp_generic_suspend
)paren
suffix:semicolon
DECL|variable|ocp_generic_resume
id|EXPORT_SYMBOL
c_func
(paren
id|ocp_generic_resume
)paren
suffix:semicolon
macro_line|#endif /* CONFIG_PM */
eof
