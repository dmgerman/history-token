multiline_comment|/*&n; * arch/ppc/syslib/ibm440sp_common.c&n; *&n; * PPC440SP system library&n; *&n; * Matt Porter &lt;mporter@kernel.crashing.org&gt;&n; * Copyright 2002-2005 MontaVista Software Inc.&n; *&n; * Eugene Surovegin &lt;eugene.surovegin@zultys.com&gt; or &lt;ebs@ebshome.net&gt;&n; * Copyright (c) 2003, 2004 Zultys Technologies&n; *&n; * This program is free software; you can redistribute  it and/or modify it&n; * under  the terms of  the GNU General  Public License as published by the&n; * Free Software Foundation;  either version 2 of the  License, or (at your&n; * option) any later version.&n; *&n; */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/types.h&gt;
macro_line|#include &lt;linux/serial.h&gt;
macro_line|#include &lt;asm/param.h&gt;
macro_line|#include &lt;asm/ibm44x.h&gt;
macro_line|#include &lt;asm/mmu.h&gt;
macro_line|#include &lt;asm/machdep.h&gt;
macro_line|#include &lt;asm/time.h&gt;
macro_line|#include &lt;asm/ppc4xx_pic.h&gt;
multiline_comment|/*&n; * Read the 440SP memory controller to get size of system memory.&n; */
DECL|function|ibm440sp_find_end_of_memory
r_int
r_int
id|__init
id|ibm440sp_find_end_of_memory
c_func
(paren
r_void
)paren
(brace
id|u32
id|i
suffix:semicolon
id|u32
id|mem_size
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* Read two bank sizes and sum */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|2
suffix:semicolon
id|i
op_increment
)paren
r_switch
c_cond
(paren
id|mfdcr
c_func
(paren
id|DCRN_MQ0_BS0BAS
op_plus
id|i
)paren
op_amp
id|MQ0_CONFIG_SIZE_MASK
)paren
(brace
r_case
id|MQ0_CONFIG_SIZE_8M
suffix:colon
id|mem_size
op_add_assign
id|PPC44x_MEM_SIZE_8M
suffix:semicolon
r_break
suffix:semicolon
r_case
id|MQ0_CONFIG_SIZE_16M
suffix:colon
id|mem_size
op_add_assign
id|PPC44x_MEM_SIZE_16M
suffix:semicolon
r_break
suffix:semicolon
r_case
id|MQ0_CONFIG_SIZE_32M
suffix:colon
id|mem_size
op_add_assign
id|PPC44x_MEM_SIZE_32M
suffix:semicolon
r_break
suffix:semicolon
r_case
id|MQ0_CONFIG_SIZE_64M
suffix:colon
id|mem_size
op_add_assign
id|PPC44x_MEM_SIZE_64M
suffix:semicolon
r_break
suffix:semicolon
r_case
id|MQ0_CONFIG_SIZE_128M
suffix:colon
id|mem_size
op_add_assign
id|PPC44x_MEM_SIZE_128M
suffix:semicolon
r_break
suffix:semicolon
r_case
id|MQ0_CONFIG_SIZE_256M
suffix:colon
id|mem_size
op_add_assign
id|PPC44x_MEM_SIZE_256M
suffix:semicolon
r_break
suffix:semicolon
r_case
id|MQ0_CONFIG_SIZE_512M
suffix:colon
id|mem_size
op_add_assign
id|PPC44x_MEM_SIZE_512M
suffix:semicolon
r_break
suffix:semicolon
r_case
id|MQ0_CONFIG_SIZE_1G
suffix:colon
id|mem_size
op_add_assign
id|PPC44x_MEM_SIZE_1G
suffix:semicolon
r_break
suffix:semicolon
r_case
id|MQ0_CONFIG_SIZE_2G
suffix:colon
id|mem_size
op_add_assign
id|PPC44x_MEM_SIZE_2G
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_break
suffix:semicolon
)brace
r_return
id|mem_size
suffix:semicolon
)brace
eof
