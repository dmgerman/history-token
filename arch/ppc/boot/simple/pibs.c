multiline_comment|/*&n; * 2004 (c) MontaVista, Software, Inc.  This file is licensed under&n; * the terms of the GNU General Public License version 2.  This program&n; * is licensed &quot;as is&quot; without any warranty of any kind, whether express&n; * or implied.&n; */
macro_line|#include &lt;linux/types.h&gt;
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/string.h&gt;
macro_line|#include &lt;linux/ctype.h&gt;
macro_line|#include &lt;asm/ppcboot.h&gt;
macro_line|#include &lt;platforms/4xx/ocotea.h&gt;
r_extern
r_int
r_int
id|decompress_kernel
c_func
(paren
r_int
r_int
id|load_addr
comma
r_int
id|num_words
comma
r_int
r_int
id|cksum
)paren
suffix:semicolon
multiline_comment|/* We need to make sure that this is before the images to ensure&n; * that it&squot;s in a mapped location. - Tom */
DECL|variable|hold_resid_buf
id|bd_t
id|hold_resid_buf
id|__attribute__
(paren
(paren
id|__section__
(paren
l_string|&quot;.data.boot&quot;
)paren
)paren
)paren
suffix:semicolon
DECL|variable|hold_residual
id|bd_t
op_star
id|hold_residual
op_assign
op_amp
id|hold_resid_buf
suffix:semicolon
multiline_comment|/* String functions lifted from lib/vsprintf.c and lib/ctype.c */
DECL|variable|_ctype
r_int
r_char
id|_ctype
(braket
)braket
op_assign
(brace
id|_C
comma
id|_C
comma
id|_C
comma
id|_C
comma
id|_C
comma
id|_C
comma
id|_C
comma
id|_C
comma
multiline_comment|/* 0-7 */
id|_C
comma
id|_C
op_or
id|_S
comma
id|_C
op_or
id|_S
comma
id|_C
op_or
id|_S
comma
id|_C
op_or
id|_S
comma
id|_C
op_or
id|_S
comma
id|_C
comma
id|_C
comma
multiline_comment|/* 8-15 */
id|_C
comma
id|_C
comma
id|_C
comma
id|_C
comma
id|_C
comma
id|_C
comma
id|_C
comma
id|_C
comma
multiline_comment|/* 16-23 */
id|_C
comma
id|_C
comma
id|_C
comma
id|_C
comma
id|_C
comma
id|_C
comma
id|_C
comma
id|_C
comma
multiline_comment|/* 24-31 */
id|_S
op_or
id|_SP
comma
id|_P
comma
id|_P
comma
id|_P
comma
id|_P
comma
id|_P
comma
id|_P
comma
id|_P
comma
multiline_comment|/* 32-39 */
id|_P
comma
id|_P
comma
id|_P
comma
id|_P
comma
id|_P
comma
id|_P
comma
id|_P
comma
id|_P
comma
multiline_comment|/* 40-47 */
id|_D
comma
id|_D
comma
id|_D
comma
id|_D
comma
id|_D
comma
id|_D
comma
id|_D
comma
id|_D
comma
multiline_comment|/* 48-55 */
id|_D
comma
id|_D
comma
id|_P
comma
id|_P
comma
id|_P
comma
id|_P
comma
id|_P
comma
id|_P
comma
multiline_comment|/* 56-63 */
id|_P
comma
id|_U
op_or
id|_X
comma
id|_U
op_or
id|_X
comma
id|_U
op_or
id|_X
comma
id|_U
op_or
id|_X
comma
id|_U
op_or
id|_X
comma
id|_U
op_or
id|_X
comma
id|_U
comma
multiline_comment|/* 64-71 */
id|_U
comma
id|_U
comma
id|_U
comma
id|_U
comma
id|_U
comma
id|_U
comma
id|_U
comma
id|_U
comma
multiline_comment|/* 72-79 */
id|_U
comma
id|_U
comma
id|_U
comma
id|_U
comma
id|_U
comma
id|_U
comma
id|_U
comma
id|_U
comma
multiline_comment|/* 80-87 */
id|_U
comma
id|_U
comma
id|_U
comma
id|_P
comma
id|_P
comma
id|_P
comma
id|_P
comma
id|_P
comma
multiline_comment|/* 88-95 */
id|_P
comma
id|_L
op_or
id|_X
comma
id|_L
op_or
id|_X
comma
id|_L
op_or
id|_X
comma
id|_L
op_or
id|_X
comma
id|_L
op_or
id|_X
comma
id|_L
op_or
id|_X
comma
id|_L
comma
multiline_comment|/* 96-103 */
id|_L
comma
id|_L
comma
id|_L
comma
id|_L
comma
id|_L
comma
id|_L
comma
id|_L
comma
id|_L
comma
multiline_comment|/* 104-111 */
id|_L
comma
id|_L
comma
id|_L
comma
id|_L
comma
id|_L
comma
id|_L
comma
id|_L
comma
id|_L
comma
multiline_comment|/* 112-119 */
id|_L
comma
id|_L
comma
id|_L
comma
id|_P
comma
id|_P
comma
id|_P
comma
id|_P
comma
id|_C
comma
multiline_comment|/* 120-127 */
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
multiline_comment|/* 128-143 */
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
multiline_comment|/* 144-159 */
id|_S
op_or
id|_SP
comma
id|_P
comma
id|_P
comma
id|_P
comma
id|_P
comma
id|_P
comma
id|_P
comma
id|_P
comma
id|_P
comma
id|_P
comma
id|_P
comma
id|_P
comma
id|_P
comma
id|_P
comma
id|_P
comma
id|_P
comma
multiline_comment|/* 160-175 */
id|_P
comma
id|_P
comma
id|_P
comma
id|_P
comma
id|_P
comma
id|_P
comma
id|_P
comma
id|_P
comma
id|_P
comma
id|_P
comma
id|_P
comma
id|_P
comma
id|_P
comma
id|_P
comma
id|_P
comma
id|_P
comma
multiline_comment|/* 176-191 */
id|_U
comma
id|_U
comma
id|_U
comma
id|_U
comma
id|_U
comma
id|_U
comma
id|_U
comma
id|_U
comma
id|_U
comma
id|_U
comma
id|_U
comma
id|_U
comma
id|_U
comma
id|_U
comma
id|_U
comma
id|_U
comma
multiline_comment|/* 192-207 */
id|_U
comma
id|_U
comma
id|_U
comma
id|_U
comma
id|_U
comma
id|_U
comma
id|_U
comma
id|_P
comma
id|_U
comma
id|_U
comma
id|_U
comma
id|_U
comma
id|_U
comma
id|_U
comma
id|_U
comma
id|_L
comma
multiline_comment|/* 208-223 */
id|_L
comma
id|_L
comma
id|_L
comma
id|_L
comma
id|_L
comma
id|_L
comma
id|_L
comma
id|_L
comma
id|_L
comma
id|_L
comma
id|_L
comma
id|_L
comma
id|_L
comma
id|_L
comma
id|_L
comma
id|_L
comma
multiline_comment|/* 224-239 */
id|_L
comma
id|_L
comma
id|_L
comma
id|_L
comma
id|_L
comma
id|_L
comma
id|_L
comma
id|_P
comma
id|_L
comma
id|_L
comma
id|_L
comma
id|_L
comma
id|_L
comma
id|_L
comma
id|_L
comma
id|_L
)brace
suffix:semicolon
multiline_comment|/* 240-255 */
multiline_comment|/**&n; * simple_strtoull - convert a string to an unsigned long long&n; * @cp: The start of the string&n; * @endp: A pointer to the end of the parsed string will be placed here&n; * @base: The number base to use&n; */
DECL|function|simple_strtoull
r_int
r_int
r_int
id|simple_strtoull
c_func
(paren
r_const
r_char
op_star
id|cp
comma
r_char
op_star
op_star
id|endp
comma
r_int
r_int
id|base
)paren
(brace
r_int
r_int
r_int
id|result
op_assign
l_int|0
comma
id|value
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|base
)paren
(brace
id|base
op_assign
l_int|10
suffix:semicolon
r_if
c_cond
(paren
op_star
id|cp
op_eq
l_char|&squot;0&squot;
)paren
(brace
id|base
op_assign
l_int|8
suffix:semicolon
id|cp
op_increment
suffix:semicolon
r_if
c_cond
(paren
(paren
id|toupper
c_func
(paren
op_star
id|cp
)paren
op_eq
l_char|&squot;X&squot;
)paren
op_logical_and
id|isxdigit
c_func
(paren
id|cp
(braket
l_int|1
)braket
)paren
)paren
(brace
id|cp
op_increment
suffix:semicolon
id|base
op_assign
l_int|16
suffix:semicolon
)brace
)brace
)brace
r_else
r_if
c_cond
(paren
id|base
op_eq
l_int|16
)paren
(brace
r_if
c_cond
(paren
id|cp
(braket
l_int|0
)braket
op_eq
l_char|&squot;0&squot;
op_logical_and
id|toupper
c_func
(paren
id|cp
(braket
l_int|1
)braket
)paren
op_eq
l_char|&squot;X&squot;
)paren
id|cp
op_add_assign
l_int|2
suffix:semicolon
)brace
r_while
c_loop
(paren
id|isxdigit
c_func
(paren
op_star
id|cp
)paren
op_logical_and
(paren
id|value
op_assign
id|isdigit
c_func
(paren
op_star
id|cp
)paren
ques
c_cond
op_star
id|cp
op_minus
l_char|&squot;0&squot;
suffix:colon
(paren
id|islower
c_func
(paren
op_star
id|cp
)paren
ques
c_cond
id|toupper
c_func
(paren
op_star
id|cp
)paren
suffix:colon
op_star
id|cp
)paren
op_minus
l_char|&squot;A&squot;
op_plus
l_int|10
)paren
OL
id|base
)paren
(brace
id|result
op_assign
id|result
op_star
id|base
op_plus
id|value
suffix:semicolon
id|cp
op_increment
suffix:semicolon
)brace
r_if
c_cond
(paren
id|endp
)paren
op_star
id|endp
op_assign
(paren
r_char
op_star
)paren
id|cp
suffix:semicolon
r_return
id|result
suffix:semicolon
)brace
r_void
op_star
DECL|function|load_kernel
id|load_kernel
c_func
(paren
r_int
r_int
id|load_addr
comma
r_int
id|num_words
comma
r_int
r_int
id|cksum
comma
r_void
op_star
id|ign1
comma
r_void
op_star
id|ign2
)paren
(brace
r_int
r_int
r_int
id|mac64
suffix:semicolon
id|decompress_kernel
c_func
(paren
id|load_addr
comma
id|num_words
comma
id|cksum
)paren
suffix:semicolon
id|mac64
op_assign
id|simple_strtoull
c_func
(paren
(paren
r_char
op_star
)paren
id|OCOTEA_PIBS_MAC_BASE
comma
l_int|0
comma
l_int|16
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|hold_residual-&gt;bi_enetaddr
comma
(paren
r_char
op_star
)paren
op_amp
id|mac64
op_plus
l_int|2
comma
l_int|6
)paren
suffix:semicolon
id|mac64
op_assign
id|simple_strtoull
c_func
(paren
(paren
r_char
op_star
)paren
(paren
id|OCOTEA_PIBS_MAC_BASE
op_plus
id|OCOTEA_PIBS_MAC_OFFSET
)paren
comma
l_int|0
comma
l_int|16
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|hold_residual-&gt;bi_enet1addr
comma
(paren
r_char
op_star
)paren
op_amp
id|mac64
op_plus
l_int|2
comma
l_int|6
)paren
suffix:semicolon
id|mac64
op_assign
id|simple_strtoull
c_func
(paren
(paren
r_char
op_star
)paren
(paren
id|OCOTEA_PIBS_MAC_BASE
op_plus
id|OCOTEA_PIBS_MAC_OFFSET
op_star
l_int|2
)paren
comma
l_int|0
comma
l_int|16
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|hold_residual-&gt;bi_enet2addr
comma
(paren
r_char
op_star
)paren
op_amp
id|mac64
op_plus
l_int|2
comma
l_int|6
)paren
suffix:semicolon
id|mac64
op_assign
id|simple_strtoull
c_func
(paren
(paren
r_char
op_star
)paren
(paren
id|OCOTEA_PIBS_MAC_BASE
op_plus
id|OCOTEA_PIBS_MAC_OFFSET
op_star
l_int|3
)paren
comma
l_int|0
comma
l_int|16
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|hold_residual-&gt;bi_enet3addr
comma
(paren
r_char
op_star
)paren
op_amp
id|mac64
op_plus
l_int|2
comma
l_int|6
)paren
suffix:semicolon
r_return
(paren
r_void
op_star
)paren
id|hold_residual
suffix:semicolon
)brace
eof
