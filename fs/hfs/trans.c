multiline_comment|/*&n; *  linux/fs/hfs/trans.c&n; *&n; * Copyright (C) 1995-1997  Paul H. Hargrove&n; * This file may be distributed under the terms of the GNU General Public License.&n; *&n; * This file contains routines for converting between the Macintosh&n; * character set and various other encodings.  This includes dealing&n; * with &squot;:&squot; vs. &squot;/&squot; as the path-element separator.&n; */
macro_line|#include &quot;hfs_fs.h&quot;
multiline_comment|/*================ Global functions ================*/
multiline_comment|/*&n; * hfs_mac2triv()&n; *&n; * Given a &squot;Pascal String&squot; (a string preceded by a length byte) in&n; * the Macintosh character set produce the corresponding filename using&n; * the &squot;trivial&squot; name-mangling scheme, returning the length of the&n; * mangled filename.  Note that the output string is not NULL&n; * terminated.&n; *&n; * The name-mangling works as follows:&n; * The character &squot;/&squot;, which is illegal in Linux filenames is replaced&n; * by &squot;:&squot; which never appears in HFS filenames.&t; All other characters&n; * are passed unchanged from input to output.&n; */
DECL|function|hfs_mac2triv
r_int
id|hfs_mac2triv
c_func
(paren
r_char
op_star
id|out
comma
r_const
r_struct
id|hfs_name
op_star
id|in
)paren
(brace
r_const
r_char
op_star
id|p
suffix:semicolon
r_char
id|c
suffix:semicolon
r_int
id|i
comma
id|len
suffix:semicolon
id|len
op_assign
id|in-&gt;len
suffix:semicolon
id|p
op_assign
id|in-&gt;name
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|len
suffix:semicolon
id|i
op_increment
)paren
(brace
id|c
op_assign
op_star
id|p
op_increment
suffix:semicolon
op_star
id|out
op_increment
op_assign
id|c
op_eq
l_char|&squot;/&squot;
ques
c_cond
l_char|&squot;:&squot;
suffix:colon
id|c
suffix:semicolon
)brace
r_return
id|i
suffix:semicolon
)brace
multiline_comment|/*&n; * hfs_triv2mac()&n; *&n; * Given an ASCII string (not null-terminated) and its length,&n; * generate the corresponding filename in the Macintosh character set&n; * using the &squot;trivial&squot; name-mangling scheme, returning the length of&n; * the mangled filename.  Note that the output string is not NULL&n; * terminated.&n; *&n; * This routine is a inverse to hfs_mac2triv().&n; * A &squot;:&squot; is replaced by a &squot;/&squot;.&n; */
DECL|function|hfs_triv2mac
r_void
id|hfs_triv2mac
c_func
(paren
r_struct
id|hfs_name
op_star
id|out
comma
r_struct
id|qstr
op_star
id|in
)paren
(brace
r_const
r_char
op_star
id|src
suffix:semicolon
r_char
op_star
id|dst
comma
id|c
suffix:semicolon
r_int
id|i
comma
id|len
suffix:semicolon
id|out-&gt;len
op_assign
id|len
op_assign
id|min
c_func
(paren
(paren
r_int
r_int
)paren
id|HFS_NAMELEN
comma
id|in-&gt;len
)paren
suffix:semicolon
id|src
op_assign
id|in-&gt;name
suffix:semicolon
id|dst
op_assign
id|out-&gt;name
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|len
suffix:semicolon
id|i
op_increment
)paren
(brace
id|c
op_assign
op_star
id|src
op_increment
suffix:semicolon
op_star
id|dst
op_increment
op_assign
id|c
op_eq
l_char|&squot;:&squot;
ques
c_cond
l_char|&squot;/&squot;
suffix:colon
id|c
suffix:semicolon
)brace
r_for
c_loop
(paren
suffix:semicolon
id|i
OL
id|HFS_NAMELEN
suffix:semicolon
id|i
op_increment
)paren
op_star
id|dst
op_increment
op_assign
l_int|0
suffix:semicolon
)brace
eof
