multiline_comment|/*&n; *  linux/fs/proc/proc_misc.c&n; *&n; *  linux/fs/proc/array.c&n; *  Copyright (C) 1992  by Linus Torvalds&n; *  based on ideas by Darren Senn&n; *&n; *  This used to be the part of array.c. See the rest of history and credits&n; *  there. I took this into a separate file and switched the thing to generic&n; *  proc_file_inode_operations, leaving in array.c only per-process stuff.&n; *  Inumbers allocation made dynamic (via create_proc_entry()).  AV, May 1999.&n; *&n; * Changes:&n; * Fulton Green      :  Encapsulated position metric calculations.&n; *&t;&t;&t;&lt;kernel@FultonGreen.com&gt;&n; */
macro_line|#include &lt;linux/types.h&gt;
macro_line|#include &lt;linux/errno.h&gt;
macro_line|#include &lt;linux/time.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/kernel_stat.h&gt;
macro_line|#include &lt;linux/tty.h&gt;
macro_line|#include &lt;linux/string.h&gt;
macro_line|#include &lt;linux/mman.h&gt;
macro_line|#include &lt;linux/proc_fs.h&gt;
macro_line|#include &lt;linux/ioport.h&gt;
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;linux/mmzone.h&gt;
macro_line|#include &lt;linux/pagemap.h&gt;
macro_line|#include &lt;linux/swap.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;linux/smp.h&gt;
macro_line|#include &lt;linux/signal.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/smp_lock.h&gt;
macro_line|#include &lt;linux/seq_file.h&gt;
macro_line|#include &lt;linux/times.h&gt;
macro_line|#include &lt;linux/profile.h&gt;
macro_line|#include &lt;linux/blkdev.h&gt;
macro_line|#include &lt;linux/hugetlb.h&gt;
macro_line|#include &lt;linux/jiffies.h&gt;
macro_line|#include &lt;linux/sysrq.h&gt;
macro_line|#include &lt;linux/vmalloc.h&gt;
macro_line|#include &lt;asm/uaccess.h&gt;
macro_line|#include &lt;asm/pgtable.h&gt;
macro_line|#include &lt;asm/io.h&gt;
macro_line|#include &lt;asm/tlb.h&gt;
macro_line|#include &lt;asm/div64.h&gt;
macro_line|#include &quot;internal.h&quot;
DECL|macro|LOAD_INT
mdefine_line|#define LOAD_INT(x) ((x) &gt;&gt; FSHIFT)
DECL|macro|LOAD_FRAC
mdefine_line|#define LOAD_FRAC(x) LOAD_INT(((x) &amp; (FIXED_1-1)) * 100)
multiline_comment|/*&n; * Warning: stuff below (imported functions) assumes that its output will fit&n; * into one page. For some of those functions it may be wrong. Moreover, we&n; * have a way to deal with that gracefully. Right now I used straightforward&n; * wrappers, but this needs further analysis wrt potential overflows.&n; */
r_extern
r_int
id|get_hardware_list
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|get_stram_list
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|get_chrdev_list
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|get_filesystem_list
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|get_exec_domain_list
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|get_dma_list
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
id|get_locks_status
(paren
r_char
op_star
comma
r_char
op_star
op_star
comma
id|off_t
comma
r_int
)paren
suffix:semicolon
DECL|function|proc_calc_metrics
r_static
r_int
id|proc_calc_metrics
c_func
(paren
r_char
op_star
id|page
comma
r_char
op_star
op_star
id|start
comma
id|off_t
id|off
comma
r_int
id|count
comma
r_int
op_star
id|eof
comma
r_int
id|len
)paren
(brace
r_if
c_cond
(paren
id|len
op_le
id|off
op_plus
id|count
)paren
op_star
id|eof
op_assign
l_int|1
suffix:semicolon
op_star
id|start
op_assign
id|page
op_plus
id|off
suffix:semicolon
id|len
op_sub_assign
id|off
suffix:semicolon
r_if
c_cond
(paren
id|len
OG
id|count
)paren
id|len
op_assign
id|count
suffix:semicolon
r_if
c_cond
(paren
id|len
OL
l_int|0
)paren
id|len
op_assign
l_int|0
suffix:semicolon
r_return
id|len
suffix:semicolon
)brace
DECL|function|loadavg_read_proc
r_static
r_int
id|loadavg_read_proc
c_func
(paren
r_char
op_star
id|page
comma
r_char
op_star
op_star
id|start
comma
id|off_t
id|off
comma
r_int
id|count
comma
r_int
op_star
id|eof
comma
r_void
op_star
id|data
)paren
(brace
r_int
id|a
comma
id|b
comma
id|c
suffix:semicolon
r_int
id|len
suffix:semicolon
id|a
op_assign
id|avenrun
(braket
l_int|0
)braket
op_plus
(paren
id|FIXED_1
op_div
l_int|200
)paren
suffix:semicolon
id|b
op_assign
id|avenrun
(braket
l_int|1
)braket
op_plus
(paren
id|FIXED_1
op_div
l_int|200
)paren
suffix:semicolon
id|c
op_assign
id|avenrun
(braket
l_int|2
)braket
op_plus
(paren
id|FIXED_1
op_div
l_int|200
)paren
suffix:semicolon
id|len
op_assign
id|sprintf
c_func
(paren
id|page
comma
l_string|&quot;%d.%02d %d.%02d %d.%02d %ld/%d %d&bslash;n&quot;
comma
id|LOAD_INT
c_func
(paren
id|a
)paren
comma
id|LOAD_FRAC
c_func
(paren
id|a
)paren
comma
id|LOAD_INT
c_func
(paren
id|b
)paren
comma
id|LOAD_FRAC
c_func
(paren
id|b
)paren
comma
id|LOAD_INT
c_func
(paren
id|c
)paren
comma
id|LOAD_FRAC
c_func
(paren
id|c
)paren
comma
id|nr_running
c_func
(paren
)paren
comma
id|nr_threads
comma
id|last_pid
)paren
suffix:semicolon
r_return
id|proc_calc_metrics
c_func
(paren
id|page
comma
id|start
comma
id|off
comma
id|count
comma
id|eof
comma
id|len
)paren
suffix:semicolon
)brace
DECL|function|uptime_read_proc
r_static
r_int
id|uptime_read_proc
c_func
(paren
r_char
op_star
id|page
comma
r_char
op_star
op_star
id|start
comma
id|off_t
id|off
comma
r_int
id|count
comma
r_int
op_star
id|eof
comma
r_void
op_star
id|data
)paren
(brace
r_struct
id|timespec
id|uptime
suffix:semicolon
r_struct
id|timespec
id|idle
suffix:semicolon
r_int
id|len
suffix:semicolon
id|u64
id|idle_jiffies
op_assign
id|init_task.utime
op_plus
id|init_task.stime
suffix:semicolon
id|do_posix_clock_monotonic_gettime
c_func
(paren
op_amp
id|uptime
)paren
suffix:semicolon
id|jiffies_to_timespec
c_func
(paren
id|idle_jiffies
comma
op_amp
id|idle
)paren
suffix:semicolon
id|len
op_assign
id|sprintf
c_func
(paren
id|page
comma
l_string|&quot;%lu.%02lu %lu.%02lu&bslash;n&quot;
comma
(paren
r_int
r_int
)paren
id|uptime.tv_sec
comma
(paren
id|uptime.tv_nsec
op_div
(paren
id|NSEC_PER_SEC
op_div
l_int|100
)paren
)paren
comma
(paren
r_int
r_int
)paren
id|idle.tv_sec
comma
(paren
id|idle.tv_nsec
op_div
(paren
id|NSEC_PER_SEC
op_div
l_int|100
)paren
)paren
)paren
suffix:semicolon
r_return
id|proc_calc_metrics
c_func
(paren
id|page
comma
id|start
comma
id|off
comma
id|count
comma
id|eof
comma
id|len
)paren
suffix:semicolon
)brace
DECL|function|meminfo_read_proc
r_static
r_int
id|meminfo_read_proc
c_func
(paren
r_char
op_star
id|page
comma
r_char
op_star
op_star
id|start
comma
id|off_t
id|off
comma
r_int
id|count
comma
r_int
op_star
id|eof
comma
r_void
op_star
id|data
)paren
(brace
r_struct
id|sysinfo
id|i
suffix:semicolon
r_int
id|len
suffix:semicolon
r_struct
id|page_state
id|ps
suffix:semicolon
r_int
r_int
id|inactive
suffix:semicolon
r_int
r_int
id|active
suffix:semicolon
r_int
r_int
id|free
suffix:semicolon
r_int
r_int
id|committed
suffix:semicolon
r_int
r_int
id|allowed
suffix:semicolon
r_struct
id|vmalloc_info
id|vmi
suffix:semicolon
id|get_page_state
c_func
(paren
op_amp
id|ps
)paren
suffix:semicolon
id|get_zone_counts
c_func
(paren
op_amp
id|active
comma
op_amp
id|inactive
comma
op_amp
id|free
)paren
suffix:semicolon
multiline_comment|/*&n; * display in kilobytes.&n; */
DECL|macro|K
mdefine_line|#define K(x) ((x) &lt;&lt; (PAGE_SHIFT - 10))
id|si_meminfo
c_func
(paren
op_amp
id|i
)paren
suffix:semicolon
id|si_swapinfo
c_func
(paren
op_amp
id|i
)paren
suffix:semicolon
id|committed
op_assign
id|atomic_read
c_func
(paren
op_amp
id|vm_committed_space
)paren
suffix:semicolon
id|allowed
op_assign
(paren
(paren
id|totalram_pages
op_minus
id|hugetlb_total_pages
c_func
(paren
)paren
)paren
op_star
id|sysctl_overcommit_ratio
op_div
l_int|100
)paren
op_plus
id|total_swap_pages
suffix:semicolon
id|get_vmalloc_info
c_func
(paren
op_amp
id|vmi
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * Tagged format, for easy grepping and expansion.&n;&t; */
id|len
op_assign
id|sprintf
c_func
(paren
id|page
comma
l_string|&quot;MemTotal:     %8lu kB&bslash;n&quot;
l_string|&quot;MemFree:      %8lu kB&bslash;n&quot;
l_string|&quot;Buffers:      %8lu kB&bslash;n&quot;
l_string|&quot;Cached:       %8lu kB&bslash;n&quot;
l_string|&quot;SwapCached:   %8lu kB&bslash;n&quot;
l_string|&quot;Active:       %8lu kB&bslash;n&quot;
l_string|&quot;Inactive:     %8lu kB&bslash;n&quot;
l_string|&quot;HighTotal:    %8lu kB&bslash;n&quot;
l_string|&quot;HighFree:     %8lu kB&bslash;n&quot;
l_string|&quot;LowTotal:     %8lu kB&bslash;n&quot;
l_string|&quot;LowFree:      %8lu kB&bslash;n&quot;
l_string|&quot;SwapTotal:    %8lu kB&bslash;n&quot;
l_string|&quot;SwapFree:     %8lu kB&bslash;n&quot;
l_string|&quot;Dirty:        %8lu kB&bslash;n&quot;
l_string|&quot;Writeback:    %8lu kB&bslash;n&quot;
l_string|&quot;Mapped:       %8lu kB&bslash;n&quot;
l_string|&quot;Slab:         %8lu kB&bslash;n&quot;
l_string|&quot;CommitLimit:  %8lu kB&bslash;n&quot;
l_string|&quot;Committed_AS: %8lu kB&bslash;n&quot;
l_string|&quot;PageTables:   %8lu kB&bslash;n&quot;
l_string|&quot;VmallocTotal: %8lu kB&bslash;n&quot;
l_string|&quot;VmallocUsed:  %8lu kB&bslash;n&quot;
l_string|&quot;VmallocChunk: %8lu kB&bslash;n&quot;
comma
id|K
c_func
(paren
id|i.totalram
)paren
comma
id|K
c_func
(paren
id|i.freeram
)paren
comma
id|K
c_func
(paren
id|i.bufferram
)paren
comma
id|K
c_func
(paren
id|get_page_cache_size
c_func
(paren
)paren
op_minus
id|total_swapcache_pages
op_minus
id|i.bufferram
)paren
comma
id|K
c_func
(paren
id|total_swapcache_pages
)paren
comma
id|K
c_func
(paren
id|active
)paren
comma
id|K
c_func
(paren
id|inactive
)paren
comma
id|K
c_func
(paren
id|i.totalhigh
)paren
comma
id|K
c_func
(paren
id|i.freehigh
)paren
comma
id|K
c_func
(paren
id|i.totalram
op_minus
id|i.totalhigh
)paren
comma
id|K
c_func
(paren
id|i.freeram
op_minus
id|i.freehigh
)paren
comma
id|K
c_func
(paren
id|i.totalswap
)paren
comma
id|K
c_func
(paren
id|i.freeswap
)paren
comma
id|K
c_func
(paren
id|ps.nr_dirty
)paren
comma
id|K
c_func
(paren
id|ps.nr_writeback
)paren
comma
id|K
c_func
(paren
id|ps.nr_mapped
)paren
comma
id|K
c_func
(paren
id|ps.nr_slab
)paren
comma
id|K
c_func
(paren
id|allowed
)paren
comma
id|K
c_func
(paren
id|committed
)paren
comma
id|K
c_func
(paren
id|ps.nr_page_table_pages
)paren
comma
id|VMALLOC_TOTAL
op_rshift
l_int|10
comma
id|vmi.used
op_rshift
l_int|10
comma
id|vmi.largest_chunk
op_rshift
l_int|10
)paren
suffix:semicolon
id|len
op_add_assign
id|hugetlb_report_meminfo
c_func
(paren
id|page
op_plus
id|len
)paren
suffix:semicolon
r_return
id|proc_calc_metrics
c_func
(paren
id|page
comma
id|start
comma
id|off
comma
id|count
comma
id|eof
comma
id|len
)paren
suffix:semicolon
DECL|macro|K
macro_line|#undef K
)brace
r_extern
r_struct
id|seq_operations
id|fragmentation_op
suffix:semicolon
DECL|function|fragmentation_open
r_static
r_int
id|fragmentation_open
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
(paren
r_void
)paren
id|inode
suffix:semicolon
r_return
id|seq_open
c_func
(paren
id|file
comma
op_amp
id|fragmentation_op
)paren
suffix:semicolon
)brace
DECL|variable|fragmentation_file_operations
r_static
r_struct
id|file_operations
id|fragmentation_file_operations
op_assign
(brace
dot
id|open
op_assign
id|fragmentation_open
comma
dot
id|read
op_assign
id|seq_read
comma
dot
id|llseek
op_assign
id|seq_lseek
comma
dot
id|release
op_assign
id|seq_release
comma
)brace
suffix:semicolon
DECL|function|version_read_proc
r_static
r_int
id|version_read_proc
c_func
(paren
r_char
op_star
id|page
comma
r_char
op_star
op_star
id|start
comma
id|off_t
id|off
comma
r_int
id|count
comma
r_int
op_star
id|eof
comma
r_void
op_star
id|data
)paren
(brace
r_int
id|len
suffix:semicolon
id|strcpy
c_func
(paren
id|page
comma
id|linux_banner
)paren
suffix:semicolon
id|len
op_assign
id|strlen
c_func
(paren
id|page
)paren
suffix:semicolon
r_return
id|proc_calc_metrics
c_func
(paren
id|page
comma
id|start
comma
id|off
comma
id|count
comma
id|eof
comma
id|len
)paren
suffix:semicolon
)brace
r_extern
r_struct
id|seq_operations
id|cpuinfo_op
suffix:semicolon
DECL|function|cpuinfo_open
r_static
r_int
id|cpuinfo_open
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_return
id|seq_open
c_func
(paren
id|file
comma
op_amp
id|cpuinfo_op
)paren
suffix:semicolon
)brace
DECL|variable|proc_cpuinfo_operations
r_static
r_struct
id|file_operations
id|proc_cpuinfo_operations
op_assign
(brace
dot
id|open
op_assign
id|cpuinfo_open
comma
dot
id|read
op_assign
id|seq_read
comma
dot
id|llseek
op_assign
id|seq_lseek
comma
dot
id|release
op_assign
id|seq_release
comma
)brace
suffix:semicolon
r_extern
r_struct
id|seq_operations
id|vmstat_op
suffix:semicolon
DECL|function|vmstat_open
r_static
r_int
id|vmstat_open
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_return
id|seq_open
c_func
(paren
id|file
comma
op_amp
id|vmstat_op
)paren
suffix:semicolon
)brace
DECL|variable|proc_vmstat_file_operations
r_static
r_struct
id|file_operations
id|proc_vmstat_file_operations
op_assign
(brace
dot
id|open
op_assign
id|vmstat_open
comma
dot
id|read
op_assign
id|seq_read
comma
dot
id|llseek
op_assign
id|seq_lseek
comma
dot
id|release
op_assign
id|seq_release
comma
)brace
suffix:semicolon
macro_line|#ifdef CONFIG_PROC_HARDWARE
DECL|function|hardware_read_proc
r_static
r_int
id|hardware_read_proc
c_func
(paren
r_char
op_star
id|page
comma
r_char
op_star
op_star
id|start
comma
id|off_t
id|off
comma
r_int
id|count
comma
r_int
op_star
id|eof
comma
r_void
op_star
id|data
)paren
(brace
r_int
id|len
op_assign
id|get_hardware_list
c_func
(paren
id|page
)paren
suffix:semicolon
r_return
id|proc_calc_metrics
c_func
(paren
id|page
comma
id|start
comma
id|off
comma
id|count
comma
id|eof
comma
id|len
)paren
suffix:semicolon
)brace
macro_line|#endif
macro_line|#ifdef CONFIG_STRAM_PROC
DECL|function|stram_read_proc
r_static
r_int
id|stram_read_proc
c_func
(paren
r_char
op_star
id|page
comma
r_char
op_star
op_star
id|start
comma
id|off_t
id|off
comma
r_int
id|count
comma
r_int
op_star
id|eof
comma
r_void
op_star
id|data
)paren
(brace
r_int
id|len
op_assign
id|get_stram_list
c_func
(paren
id|page
)paren
suffix:semicolon
r_return
id|proc_calc_metrics
c_func
(paren
id|page
comma
id|start
comma
id|off
comma
id|count
comma
id|eof
comma
id|len
)paren
suffix:semicolon
)brace
macro_line|#endif
r_extern
r_struct
id|seq_operations
id|partitions_op
suffix:semicolon
DECL|function|partitions_open
r_static
r_int
id|partitions_open
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_return
id|seq_open
c_func
(paren
id|file
comma
op_amp
id|partitions_op
)paren
suffix:semicolon
)brace
DECL|variable|proc_partitions_operations
r_static
r_struct
id|file_operations
id|proc_partitions_operations
op_assign
(brace
dot
id|open
op_assign
id|partitions_open
comma
dot
id|read
op_assign
id|seq_read
comma
dot
id|llseek
op_assign
id|seq_lseek
comma
dot
id|release
op_assign
id|seq_release
comma
)brace
suffix:semicolon
r_extern
r_struct
id|seq_operations
id|diskstats_op
suffix:semicolon
DECL|function|diskstats_open
r_static
r_int
id|diskstats_open
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_return
id|seq_open
c_func
(paren
id|file
comma
op_amp
id|diskstats_op
)paren
suffix:semicolon
)brace
DECL|variable|proc_diskstats_operations
r_static
r_struct
id|file_operations
id|proc_diskstats_operations
op_assign
(brace
dot
id|open
op_assign
id|diskstats_open
comma
dot
id|read
op_assign
id|seq_read
comma
dot
id|llseek
op_assign
id|seq_lseek
comma
dot
id|release
op_assign
id|seq_release
comma
)brace
suffix:semicolon
macro_line|#ifdef CONFIG_MODULES
r_extern
r_struct
id|seq_operations
id|modules_op
suffix:semicolon
DECL|function|modules_open
r_static
r_int
id|modules_open
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_return
id|seq_open
c_func
(paren
id|file
comma
op_amp
id|modules_op
)paren
suffix:semicolon
)brace
DECL|variable|proc_modules_operations
r_static
r_struct
id|file_operations
id|proc_modules_operations
op_assign
(brace
dot
id|open
op_assign
id|modules_open
comma
dot
id|read
op_assign
id|seq_read
comma
dot
id|llseek
op_assign
id|seq_lseek
comma
dot
id|release
op_assign
id|seq_release
comma
)brace
suffix:semicolon
macro_line|#endif
r_extern
r_struct
id|seq_operations
id|slabinfo_op
suffix:semicolon
r_extern
id|ssize_t
id|slabinfo_write
c_func
(paren
r_struct
id|file
op_star
comma
r_const
r_char
id|__user
op_star
comma
r_int
comma
id|loff_t
op_star
)paren
suffix:semicolon
DECL|function|slabinfo_open
r_static
r_int
id|slabinfo_open
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_return
id|seq_open
c_func
(paren
id|file
comma
op_amp
id|slabinfo_op
)paren
suffix:semicolon
)brace
DECL|variable|proc_slabinfo_operations
r_static
r_struct
id|file_operations
id|proc_slabinfo_operations
op_assign
(brace
dot
id|open
op_assign
id|slabinfo_open
comma
dot
id|read
op_assign
id|seq_read
comma
dot
id|write
op_assign
id|slabinfo_write
comma
dot
id|llseek
op_assign
id|seq_lseek
comma
dot
id|release
op_assign
id|seq_release
comma
)brace
suffix:semicolon
DECL|function|show_stat
r_static
r_int
id|show_stat
c_func
(paren
r_struct
id|seq_file
op_star
id|p
comma
r_void
op_star
id|v
)paren
(brace
r_int
id|i
suffix:semicolon
r_int
r_int
id|jif
suffix:semicolon
id|u64
id|sum
op_assign
l_int|0
comma
id|user
op_assign
l_int|0
comma
id|nice
op_assign
l_int|0
comma
id|system
op_assign
l_int|0
comma
id|idle
op_assign
l_int|0
comma
id|iowait
op_assign
l_int|0
comma
id|irq
op_assign
l_int|0
comma
id|softirq
op_assign
l_int|0
suffix:semicolon
id|jif
op_assign
op_minus
id|wall_to_monotonic.tv_sec
suffix:semicolon
r_if
c_cond
(paren
id|wall_to_monotonic.tv_nsec
)paren
op_decrement
id|jif
suffix:semicolon
id|for_each_cpu
c_func
(paren
id|i
)paren
(brace
r_int
id|j
suffix:semicolon
id|user
op_add_assign
id|kstat_cpu
c_func
(paren
id|i
)paren
dot
id|cpustat.user
suffix:semicolon
id|nice
op_add_assign
id|kstat_cpu
c_func
(paren
id|i
)paren
dot
id|cpustat.nice
suffix:semicolon
id|system
op_add_assign
id|kstat_cpu
c_func
(paren
id|i
)paren
dot
id|cpustat.system
suffix:semicolon
id|idle
op_add_assign
id|kstat_cpu
c_func
(paren
id|i
)paren
dot
id|cpustat.idle
suffix:semicolon
id|iowait
op_add_assign
id|kstat_cpu
c_func
(paren
id|i
)paren
dot
id|cpustat.iowait
suffix:semicolon
id|irq
op_add_assign
id|kstat_cpu
c_func
(paren
id|i
)paren
dot
id|cpustat.irq
suffix:semicolon
id|softirq
op_add_assign
id|kstat_cpu
c_func
(paren
id|i
)paren
dot
id|cpustat.softirq
suffix:semicolon
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
id|NR_IRQS
suffix:semicolon
id|j
op_increment
)paren
id|sum
op_add_assign
id|kstat_cpu
c_func
(paren
id|i
)paren
dot
id|irqs
(braket
id|j
)braket
suffix:semicolon
)brace
id|seq_printf
c_func
(paren
id|p
comma
l_string|&quot;cpu  %llu %llu %llu %llu %llu %llu %llu&bslash;n&quot;
comma
(paren
r_int
r_int
r_int
)paren
id|jiffies_64_to_clock_t
c_func
(paren
id|user
)paren
comma
(paren
r_int
r_int
r_int
)paren
id|jiffies_64_to_clock_t
c_func
(paren
id|nice
)paren
comma
(paren
r_int
r_int
r_int
)paren
id|jiffies_64_to_clock_t
c_func
(paren
id|system
)paren
comma
(paren
r_int
r_int
r_int
)paren
id|jiffies_64_to_clock_t
c_func
(paren
id|idle
)paren
comma
(paren
r_int
r_int
r_int
)paren
id|jiffies_64_to_clock_t
c_func
(paren
id|iowait
)paren
comma
(paren
r_int
r_int
r_int
)paren
id|jiffies_64_to_clock_t
c_func
(paren
id|irq
)paren
comma
(paren
r_int
r_int
r_int
)paren
id|jiffies_64_to_clock_t
c_func
(paren
id|softirq
)paren
)paren
suffix:semicolon
id|for_each_online_cpu
c_func
(paren
id|i
)paren
(brace
multiline_comment|/* Copy values here to work around gcc-2.95.3, gcc-2.96 */
id|user
op_assign
id|kstat_cpu
c_func
(paren
id|i
)paren
dot
id|cpustat.user
suffix:semicolon
id|nice
op_assign
id|kstat_cpu
c_func
(paren
id|i
)paren
dot
id|cpustat.nice
suffix:semicolon
id|system
op_assign
id|kstat_cpu
c_func
(paren
id|i
)paren
dot
id|cpustat.system
suffix:semicolon
id|idle
op_assign
id|kstat_cpu
c_func
(paren
id|i
)paren
dot
id|cpustat.idle
suffix:semicolon
id|iowait
op_assign
id|kstat_cpu
c_func
(paren
id|i
)paren
dot
id|cpustat.iowait
suffix:semicolon
id|irq
op_assign
id|kstat_cpu
c_func
(paren
id|i
)paren
dot
id|cpustat.irq
suffix:semicolon
id|softirq
op_assign
id|kstat_cpu
c_func
(paren
id|i
)paren
dot
id|cpustat.softirq
suffix:semicolon
id|seq_printf
c_func
(paren
id|p
comma
l_string|&quot;cpu%d %llu %llu %llu %llu %llu %llu %llu&bslash;n&quot;
comma
id|i
comma
(paren
r_int
r_int
r_int
)paren
id|jiffies_64_to_clock_t
c_func
(paren
id|user
)paren
comma
(paren
r_int
r_int
r_int
)paren
id|jiffies_64_to_clock_t
c_func
(paren
id|nice
)paren
comma
(paren
r_int
r_int
r_int
)paren
id|jiffies_64_to_clock_t
c_func
(paren
id|system
)paren
comma
(paren
r_int
r_int
r_int
)paren
id|jiffies_64_to_clock_t
c_func
(paren
id|idle
)paren
comma
(paren
r_int
r_int
r_int
)paren
id|jiffies_64_to_clock_t
c_func
(paren
id|iowait
)paren
comma
(paren
r_int
r_int
r_int
)paren
id|jiffies_64_to_clock_t
c_func
(paren
id|irq
)paren
comma
(paren
r_int
r_int
r_int
)paren
id|jiffies_64_to_clock_t
c_func
(paren
id|softirq
)paren
)paren
suffix:semicolon
)brace
id|seq_printf
c_func
(paren
id|p
comma
l_string|&quot;intr %llu&quot;
comma
(paren
r_int
r_int
r_int
)paren
id|sum
)paren
suffix:semicolon
macro_line|#if !defined(CONFIG_PPC64) &amp;&amp; !defined(CONFIG_ALPHA)
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|NR_IRQS
suffix:semicolon
id|i
op_increment
)paren
id|seq_printf
c_func
(paren
id|p
comma
l_string|&quot; %u&quot;
comma
id|kstat_irqs
c_func
(paren
id|i
)paren
)paren
suffix:semicolon
macro_line|#endif
id|seq_printf
c_func
(paren
id|p
comma
l_string|&quot;&bslash;nctxt %llu&bslash;n&quot;
l_string|&quot;btime %lu&bslash;n&quot;
l_string|&quot;processes %lu&bslash;n&quot;
l_string|&quot;procs_running %lu&bslash;n&quot;
l_string|&quot;procs_blocked %lu&bslash;n&quot;
comma
id|nr_context_switches
c_func
(paren
)paren
comma
(paren
r_int
r_int
)paren
id|jif
comma
id|total_forks
comma
id|nr_running
c_func
(paren
)paren
comma
id|nr_iowait
c_func
(paren
)paren
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|stat_open
r_static
r_int
id|stat_open
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_int
id|size
op_assign
l_int|4096
op_star
(paren
l_int|1
op_plus
id|num_possible_cpus
c_func
(paren
)paren
op_div
l_int|32
)paren
suffix:semicolon
r_char
op_star
id|buf
suffix:semicolon
r_struct
id|seq_file
op_star
id|m
suffix:semicolon
r_int
id|res
suffix:semicolon
multiline_comment|/* don&squot;t ask for more than the kmalloc() max size, currently 128 KB */
r_if
c_cond
(paren
id|size
OG
l_int|128
op_star
l_int|1024
)paren
id|size
op_assign
l_int|128
op_star
l_int|1024
suffix:semicolon
id|buf
op_assign
id|kmalloc
c_func
(paren
id|size
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|buf
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|res
op_assign
id|single_open
c_func
(paren
id|file
comma
id|show_stat
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|res
)paren
(brace
id|m
op_assign
id|file-&gt;private_data
suffix:semicolon
id|m-&gt;buf
op_assign
id|buf
suffix:semicolon
id|m-&gt;size
op_assign
id|size
suffix:semicolon
)brace
r_else
id|kfree
c_func
(paren
id|buf
)paren
suffix:semicolon
r_return
id|res
suffix:semicolon
)brace
DECL|variable|proc_stat_operations
r_static
r_struct
id|file_operations
id|proc_stat_operations
op_assign
(brace
dot
id|open
op_assign
id|stat_open
comma
dot
id|read
op_assign
id|seq_read
comma
dot
id|llseek
op_assign
id|seq_lseek
comma
dot
id|release
op_assign
id|single_release
comma
)brace
suffix:semicolon
DECL|function|devices_read_proc
r_static
r_int
id|devices_read_proc
c_func
(paren
r_char
op_star
id|page
comma
r_char
op_star
op_star
id|start
comma
id|off_t
id|off
comma
r_int
id|count
comma
r_int
op_star
id|eof
comma
r_void
op_star
id|data
)paren
(brace
r_int
id|len
op_assign
id|get_chrdev_list
c_func
(paren
id|page
)paren
suffix:semicolon
id|len
op_add_assign
id|get_blkdev_list
c_func
(paren
id|page
op_plus
id|len
)paren
suffix:semicolon
r_return
id|proc_calc_metrics
c_func
(paren
id|page
comma
id|start
comma
id|off
comma
id|count
comma
id|eof
comma
id|len
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * /proc/interrupts&n; */
DECL|function|int_seq_start
r_static
r_void
op_star
id|int_seq_start
c_func
(paren
r_struct
id|seq_file
op_star
id|f
comma
id|loff_t
op_star
id|pos
)paren
(brace
r_return
(paren
op_star
id|pos
op_le
id|NR_IRQS
)paren
ques
c_cond
id|pos
suffix:colon
l_int|NULL
suffix:semicolon
)brace
DECL|function|int_seq_next
r_static
r_void
op_star
id|int_seq_next
c_func
(paren
r_struct
id|seq_file
op_star
id|f
comma
r_void
op_star
id|v
comma
id|loff_t
op_star
id|pos
)paren
(brace
(paren
op_star
id|pos
)paren
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_star
id|pos
OG
id|NR_IRQS
)paren
r_return
l_int|NULL
suffix:semicolon
r_return
id|pos
suffix:semicolon
)brace
DECL|function|int_seq_stop
r_static
r_void
id|int_seq_stop
c_func
(paren
r_struct
id|seq_file
op_star
id|f
comma
r_void
op_star
id|v
)paren
(brace
multiline_comment|/* Nothing to do */
)brace
r_extern
r_int
id|show_interrupts
c_func
(paren
r_struct
id|seq_file
op_star
id|f
comma
r_void
op_star
id|v
)paren
suffix:semicolon
multiline_comment|/* In arch code */
DECL|variable|int_seq_ops
r_static
r_struct
id|seq_operations
id|int_seq_ops
op_assign
(brace
dot
id|start
op_assign
id|int_seq_start
comma
dot
id|next
op_assign
id|int_seq_next
comma
dot
id|stop
op_assign
id|int_seq_stop
comma
dot
id|show
op_assign
id|show_interrupts
)brace
suffix:semicolon
DECL|function|interrupts_open
r_static
r_int
id|interrupts_open
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|filp
)paren
(brace
r_return
id|seq_open
c_func
(paren
id|filp
comma
op_amp
id|int_seq_ops
)paren
suffix:semicolon
)brace
DECL|variable|proc_interrupts_operations
r_static
r_struct
id|file_operations
id|proc_interrupts_operations
op_assign
(brace
dot
id|open
op_assign
id|interrupts_open
comma
dot
id|read
op_assign
id|seq_read
comma
dot
id|llseek
op_assign
id|seq_lseek
comma
dot
id|release
op_assign
id|seq_release
comma
)brace
suffix:semicolon
DECL|function|filesystems_read_proc
r_static
r_int
id|filesystems_read_proc
c_func
(paren
r_char
op_star
id|page
comma
r_char
op_star
op_star
id|start
comma
id|off_t
id|off
comma
r_int
id|count
comma
r_int
op_star
id|eof
comma
r_void
op_star
id|data
)paren
(brace
r_int
id|len
op_assign
id|get_filesystem_list
c_func
(paren
id|page
)paren
suffix:semicolon
r_return
id|proc_calc_metrics
c_func
(paren
id|page
comma
id|start
comma
id|off
comma
id|count
comma
id|eof
comma
id|len
)paren
suffix:semicolon
)brace
DECL|function|cmdline_read_proc
r_static
r_int
id|cmdline_read_proc
c_func
(paren
r_char
op_star
id|page
comma
r_char
op_star
op_star
id|start
comma
id|off_t
id|off
comma
r_int
id|count
comma
r_int
op_star
id|eof
comma
r_void
op_star
id|data
)paren
(brace
r_int
id|len
suffix:semicolon
id|len
op_assign
id|sprintf
c_func
(paren
id|page
comma
l_string|&quot;%s&bslash;n&quot;
comma
id|saved_command_line
)paren
suffix:semicolon
r_return
id|proc_calc_metrics
c_func
(paren
id|page
comma
id|start
comma
id|off
comma
id|count
comma
id|eof
comma
id|len
)paren
suffix:semicolon
)brace
DECL|function|locks_read_proc
r_static
r_int
id|locks_read_proc
c_func
(paren
r_char
op_star
id|page
comma
r_char
op_star
op_star
id|start
comma
id|off_t
id|off
comma
r_int
id|count
comma
r_int
op_star
id|eof
comma
r_void
op_star
id|data
)paren
(brace
r_int
id|len
op_assign
id|get_locks_status
c_func
(paren
id|page
comma
id|start
comma
id|off
comma
id|count
)paren
suffix:semicolon
r_if
c_cond
(paren
id|len
OL
id|count
)paren
op_star
id|eof
op_assign
l_int|1
suffix:semicolon
r_return
id|len
suffix:semicolon
)brace
DECL|function|execdomains_read_proc
r_static
r_int
id|execdomains_read_proc
c_func
(paren
r_char
op_star
id|page
comma
r_char
op_star
op_star
id|start
comma
id|off_t
id|off
comma
r_int
id|count
comma
r_int
op_star
id|eof
comma
r_void
op_star
id|data
)paren
(brace
r_int
id|len
op_assign
id|get_exec_domain_list
c_func
(paren
id|page
)paren
suffix:semicolon
r_return
id|proc_calc_metrics
c_func
(paren
id|page
comma
id|start
comma
id|off
comma
id|count
comma
id|eof
comma
id|len
)paren
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_MAGIC_SYSRQ
multiline_comment|/*&n; * writing &squot;C&squot; to /proc/sysrq-trigger is like sysrq-C&n; */
DECL|function|write_sysrq_trigger
r_static
id|ssize_t
id|write_sysrq_trigger
c_func
(paren
r_struct
id|file
op_star
id|file
comma
r_const
r_char
id|__user
op_star
id|buf
comma
r_int
id|count
comma
id|loff_t
op_star
id|ppos
)paren
(brace
r_if
c_cond
(paren
id|count
)paren
(brace
r_char
id|c
suffix:semicolon
r_if
c_cond
(paren
id|get_user
c_func
(paren
id|c
comma
id|buf
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|__handle_sysrq
c_func
(paren
id|c
comma
l_int|NULL
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_return
id|count
suffix:semicolon
)brace
DECL|variable|proc_sysrq_trigger_operations
r_static
r_struct
id|file_operations
id|proc_sysrq_trigger_operations
op_assign
(brace
dot
id|write
op_assign
id|write_sysrq_trigger
comma
)brace
suffix:semicolon
macro_line|#endif
DECL|variable|proc_root_kcore
r_struct
id|proc_dir_entry
op_star
id|proc_root_kcore
suffix:semicolon
DECL|function|create_seq_entry
r_void
id|create_seq_entry
c_func
(paren
r_char
op_star
id|name
comma
id|mode_t
id|mode
comma
r_struct
id|file_operations
op_star
id|f
)paren
(brace
r_struct
id|proc_dir_entry
op_star
id|entry
suffix:semicolon
id|entry
op_assign
id|create_proc_entry
c_func
(paren
id|name
comma
id|mode
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|entry
)paren
id|entry-&gt;proc_fops
op_assign
id|f
suffix:semicolon
)brace
DECL|function|proc_misc_init
r_void
id|__init
id|proc_misc_init
c_func
(paren
r_void
)paren
(brace
r_struct
id|proc_dir_entry
op_star
id|entry
suffix:semicolon
r_static
r_struct
(brace
r_char
op_star
id|name
suffix:semicolon
r_int
(paren
op_star
id|read_proc
)paren
(paren
r_char
op_star
comma
r_char
op_star
op_star
comma
id|off_t
comma
r_int
comma
r_int
op_star
comma
r_void
op_star
)paren
suffix:semicolon
)brace
op_star
id|p
comma
id|simple_ones
(braket
)braket
op_assign
(brace
(brace
l_string|&quot;loadavg&quot;
comma
id|loadavg_read_proc
)brace
comma
(brace
l_string|&quot;uptime&quot;
comma
id|uptime_read_proc
)brace
comma
(brace
l_string|&quot;meminfo&quot;
comma
id|meminfo_read_proc
)brace
comma
(brace
l_string|&quot;version&quot;
comma
id|version_read_proc
)brace
comma
macro_line|#ifdef CONFIG_PROC_HARDWARE
(brace
l_string|&quot;hardware&quot;
comma
id|hardware_read_proc
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_STRAM_PROC
(brace
l_string|&quot;stram&quot;
comma
id|stram_read_proc
)brace
comma
macro_line|#endif
(brace
l_string|&quot;devices&quot;
comma
id|devices_read_proc
)brace
comma
(brace
l_string|&quot;filesystems&quot;
comma
id|filesystems_read_proc
)brace
comma
(brace
l_string|&quot;cmdline&quot;
comma
id|cmdline_read_proc
)brace
comma
(brace
l_string|&quot;locks&quot;
comma
id|locks_read_proc
)brace
comma
(brace
l_string|&quot;execdomains&quot;
comma
id|execdomains_read_proc
)brace
comma
(brace
l_int|NULL
comma
)brace
)brace
suffix:semicolon
r_for
c_loop
(paren
id|p
op_assign
id|simple_ones
suffix:semicolon
id|p-&gt;name
suffix:semicolon
id|p
op_increment
)paren
id|create_proc_read_entry
c_func
(paren
id|p-&gt;name
comma
l_int|0
comma
l_int|NULL
comma
id|p-&gt;read_proc
comma
l_int|NULL
)paren
suffix:semicolon
id|proc_symlink
c_func
(paren
l_string|&quot;mounts&quot;
comma
l_int|NULL
comma
l_string|&quot;self/mounts&quot;
)paren
suffix:semicolon
multiline_comment|/* And now for trickier ones */
id|entry
op_assign
id|create_proc_entry
c_func
(paren
l_string|&quot;kmsg&quot;
comma
id|S_IRUSR
comma
op_amp
id|proc_root
)paren
suffix:semicolon
r_if
c_cond
(paren
id|entry
)paren
id|entry-&gt;proc_fops
op_assign
op_amp
id|proc_kmsg_operations
suffix:semicolon
id|create_seq_entry
c_func
(paren
l_string|&quot;cpuinfo&quot;
comma
l_int|0
comma
op_amp
id|proc_cpuinfo_operations
)paren
suffix:semicolon
id|create_seq_entry
c_func
(paren
l_string|&quot;partitions&quot;
comma
l_int|0
comma
op_amp
id|proc_partitions_operations
)paren
suffix:semicolon
id|create_seq_entry
c_func
(paren
l_string|&quot;stat&quot;
comma
l_int|0
comma
op_amp
id|proc_stat_operations
)paren
suffix:semicolon
id|create_seq_entry
c_func
(paren
l_string|&quot;interrupts&quot;
comma
l_int|0
comma
op_amp
id|proc_interrupts_operations
)paren
suffix:semicolon
id|create_seq_entry
c_func
(paren
l_string|&quot;slabinfo&quot;
comma
id|S_IWUSR
op_or
id|S_IRUGO
comma
op_amp
id|proc_slabinfo_operations
)paren
suffix:semicolon
id|create_seq_entry
c_func
(paren
l_string|&quot;buddyinfo&quot;
comma
id|S_IRUGO
comma
op_amp
id|fragmentation_file_operations
)paren
suffix:semicolon
id|create_seq_entry
c_func
(paren
l_string|&quot;vmstat&quot;
comma
id|S_IRUGO
comma
op_amp
id|proc_vmstat_file_operations
)paren
suffix:semicolon
id|create_seq_entry
c_func
(paren
l_string|&quot;diskstats&quot;
comma
l_int|0
comma
op_amp
id|proc_diskstats_operations
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_MODULES
id|create_seq_entry
c_func
(paren
l_string|&quot;modules&quot;
comma
l_int|0
comma
op_amp
id|proc_modules_operations
)paren
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_SCHEDSTATS
id|create_seq_entry
c_func
(paren
l_string|&quot;schedstat&quot;
comma
l_int|0
comma
op_amp
id|proc_schedstat_operations
)paren
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_PROC_KCORE
id|proc_root_kcore
op_assign
id|create_proc_entry
c_func
(paren
l_string|&quot;kcore&quot;
comma
id|S_IRUSR
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|proc_root_kcore
)paren
(brace
id|proc_root_kcore-&gt;proc_fops
op_assign
op_amp
id|proc_kcore_operations
suffix:semicolon
id|proc_root_kcore-&gt;size
op_assign
(paren
r_int
)paren
id|high_memory
op_minus
id|PAGE_OFFSET
op_plus
id|PAGE_SIZE
suffix:semicolon
)brace
macro_line|#endif
macro_line|#ifdef CONFIG_MAGIC_SYSRQ
id|entry
op_assign
id|create_proc_entry
c_func
(paren
l_string|&quot;sysrq-trigger&quot;
comma
id|S_IWUSR
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|entry
)paren
id|entry-&gt;proc_fops
op_assign
op_amp
id|proc_sysrq_trigger_operations
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_PPC32
(brace
r_extern
r_struct
id|file_operations
id|ppc_htab_operations
suffix:semicolon
id|entry
op_assign
id|create_proc_entry
c_func
(paren
l_string|&quot;ppc_htab&quot;
comma
id|S_IRUGO
op_or
id|S_IWUSR
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|entry
)paren
id|entry-&gt;proc_fops
op_assign
op_amp
id|ppc_htab_operations
suffix:semicolon
)brace
macro_line|#endif
)brace
eof
