multiline_comment|/*&n; * linux/fs/fat/buffer.c&n; *&n; *&n; */
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;linux/string.h&gt;
macro_line|#include &lt;linux/fs.h&gt;
macro_line|#include &lt;linux/blkdev.h&gt;
macro_line|#include &lt;linux/msdos_fs.h&gt;
macro_line|#include &lt;linux/fat_cvf.h&gt;
macro_line|#if 0
macro_line|#  define PRINTK(x) printk x
macro_line|#else
DECL|macro|PRINTK
macro_line|#  define PRINTK(x)
macro_line|#endif
DECL|function|fat_bread
r_struct
id|buffer_head
op_star
id|fat_bread
c_func
(paren
r_struct
id|super_block
op_star
id|sb
comma
r_int
id|block
)paren
(brace
r_return
id|MSDOS_SB
c_func
(paren
id|sb
)paren
op_member_access_from_pointer
id|cvf_format
op_member_access_from_pointer
id|cvf_bread
c_func
(paren
id|sb
comma
id|block
)paren
suffix:semicolon
)brace
DECL|function|fat_getblk
r_struct
id|buffer_head
op_star
id|fat_getblk
c_func
(paren
r_struct
id|super_block
op_star
id|sb
comma
r_int
id|block
)paren
(brace
r_return
id|MSDOS_SB
c_func
(paren
id|sb
)paren
op_member_access_from_pointer
id|cvf_format
op_member_access_from_pointer
id|cvf_getblk
c_func
(paren
id|sb
comma
id|block
)paren
suffix:semicolon
)brace
DECL|function|fat_brelse
r_void
id|fat_brelse
(paren
r_struct
id|super_block
op_star
id|sb
comma
r_struct
id|buffer_head
op_star
id|bh
)paren
(brace
r_if
c_cond
(paren
id|bh
)paren
id|MSDOS_SB
c_func
(paren
id|sb
)paren
op_member_access_from_pointer
id|cvf_format
op_member_access_from_pointer
id|cvf_brelse
c_func
(paren
id|sb
comma
id|bh
)paren
suffix:semicolon
)brace
DECL|function|fat_mark_buffer_dirty
r_void
id|fat_mark_buffer_dirty
(paren
r_struct
id|super_block
op_star
id|sb
comma
r_struct
id|buffer_head
op_star
id|bh
)paren
(brace
id|MSDOS_SB
c_func
(paren
id|sb
)paren
op_member_access_from_pointer
id|cvf_format
op_member_access_from_pointer
id|cvf_mark_buffer_dirty
c_func
(paren
id|sb
comma
id|bh
)paren
suffix:semicolon
)brace
DECL|function|fat_set_uptodate
r_void
id|fat_set_uptodate
(paren
r_struct
id|super_block
op_star
id|sb
comma
r_struct
id|buffer_head
op_star
id|bh
comma
r_int
id|val
)paren
(brace
id|MSDOS_SB
c_func
(paren
id|sb
)paren
op_member_access_from_pointer
id|cvf_format
op_member_access_from_pointer
id|cvf_set_uptodate
c_func
(paren
id|sb
comma
id|bh
comma
id|val
)paren
suffix:semicolon
)brace
DECL|function|fat_is_uptodate
r_int
id|fat_is_uptodate
c_func
(paren
r_struct
id|super_block
op_star
id|sb
comma
r_struct
id|buffer_head
op_star
id|bh
)paren
(brace
r_return
id|MSDOS_SB
c_func
(paren
id|sb
)paren
op_member_access_from_pointer
id|cvf_format
op_member_access_from_pointer
id|cvf_is_uptodate
c_func
(paren
id|sb
comma
id|bh
)paren
suffix:semicolon
)brace
DECL|function|fat_ll_rw_block
r_void
id|fat_ll_rw_block
(paren
r_struct
id|super_block
op_star
id|sb
comma
r_int
id|opr
comma
r_int
id|nbreq
comma
r_struct
id|buffer_head
op_star
id|bh
(braket
l_int|32
)braket
)paren
(brace
id|MSDOS_SB
c_func
(paren
id|sb
)paren
op_member_access_from_pointer
id|cvf_format
op_member_access_from_pointer
id|cvf_ll_rw_block
c_func
(paren
id|sb
comma
id|opr
comma
id|nbreq
comma
id|bh
)paren
suffix:semicolon
)brace
DECL|function|default_fat_bread
r_struct
id|buffer_head
op_star
id|default_fat_bread
c_func
(paren
r_struct
id|super_block
op_star
id|sb
comma
r_int
id|block
)paren
(brace
r_return
id|bread
(paren
id|sb-&gt;s_dev
comma
id|block
comma
id|sb-&gt;s_blocksize
)paren
suffix:semicolon
)brace
DECL|function|default_fat_getblk
r_struct
id|buffer_head
op_star
id|default_fat_getblk
c_func
(paren
r_struct
id|super_block
op_star
id|sb
comma
r_int
id|block
)paren
(brace
r_return
id|getblk
(paren
id|sb-&gt;s_dev
comma
id|block
comma
id|sb-&gt;s_blocksize
)paren
suffix:semicolon
)brace
DECL|function|default_fat_brelse
r_void
id|default_fat_brelse
c_func
(paren
r_struct
id|super_block
op_star
id|sb
comma
r_struct
id|buffer_head
op_star
id|bh
)paren
(brace
id|brelse
(paren
id|bh
)paren
suffix:semicolon
)brace
DECL|function|default_fat_mark_buffer_dirty
r_void
id|default_fat_mark_buffer_dirty
(paren
r_struct
id|super_block
op_star
id|sb
comma
r_struct
id|buffer_head
op_star
id|bh
)paren
(brace
id|mark_buffer_dirty
(paren
id|bh
)paren
suffix:semicolon
)brace
DECL|function|default_fat_set_uptodate
r_void
id|default_fat_set_uptodate
(paren
r_struct
id|super_block
op_star
id|sb
comma
r_struct
id|buffer_head
op_star
id|bh
comma
r_int
id|val
)paren
(brace
id|mark_buffer_uptodate
c_func
(paren
id|bh
comma
id|val
)paren
suffix:semicolon
)brace
DECL|function|default_fat_is_uptodate
r_int
id|default_fat_is_uptodate
(paren
r_struct
id|super_block
op_star
id|sb
comma
r_struct
id|buffer_head
op_star
id|bh
)paren
(brace
r_return
id|buffer_uptodate
c_func
(paren
id|bh
)paren
suffix:semicolon
)brace
DECL|function|default_fat_ll_rw_block
r_void
id|default_fat_ll_rw_block
(paren
r_struct
id|super_block
op_star
id|sb
comma
r_int
id|opr
comma
r_int
id|nbreq
comma
r_struct
id|buffer_head
op_star
id|bh
(braket
l_int|32
)braket
)paren
(brace
id|ll_rw_block
c_func
(paren
id|opr
comma
id|nbreq
comma
id|bh
)paren
suffix:semicolon
)brace
DECL|function|bigblock_fat_bread
r_struct
id|buffer_head
op_star
id|bigblock_fat_bread
c_func
(paren
r_struct
id|super_block
op_star
id|sb
comma
r_int
id|block
)paren
(brace
r_int
r_int
id|hardsect
op_assign
id|get_hardsect_size
c_func
(paren
id|sb-&gt;s_dev
)paren
suffix:semicolon
r_int
id|rblock
comma
id|roffset
suffix:semicolon
r_struct
id|buffer_head
op_star
id|real
comma
op_star
id|dummy
suffix:semicolon
r_if
c_cond
(paren
id|hardsect
op_le
id|sb-&gt;s_blocksize
)paren
id|BUG
c_func
(paren
)paren
suffix:semicolon
id|dummy
op_assign
l_int|NULL
suffix:semicolon
id|rblock
op_assign
id|block
op_div
(paren
id|hardsect
op_div
id|sb-&gt;s_blocksize
)paren
suffix:semicolon
id|roffset
op_assign
(paren
id|block
op_mod
(paren
id|hardsect
op_div
id|sb-&gt;s_blocksize
)paren
)paren
op_star
id|sb-&gt;s_blocksize
suffix:semicolon
id|real
op_assign
id|bread
c_func
(paren
id|sb-&gt;s_dev
comma
id|rblock
comma
id|hardsect
)paren
suffix:semicolon
r_if
c_cond
(paren
id|real
op_ne
l_int|NULL
)paren
(brace
id|dummy
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|buffer_head
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dummy
op_ne
l_int|NULL
)paren
(brace
id|memset
c_func
(paren
id|dummy
comma
l_int|0
comma
r_sizeof
(paren
op_star
id|dummy
)paren
)paren
suffix:semicolon
id|dummy-&gt;b_data
op_assign
id|real-&gt;b_data
op_plus
id|roffset
suffix:semicolon
id|dummy-&gt;b_next
op_assign
id|real
suffix:semicolon
)brace
r_else
id|brelse
c_func
(paren
id|real
)paren
suffix:semicolon
)brace
r_return
id|dummy
suffix:semicolon
)brace
DECL|function|bigblock_fat_brelse
r_void
id|bigblock_fat_brelse
c_func
(paren
r_struct
id|super_block
op_star
id|sb
comma
r_struct
id|buffer_head
op_star
id|bh
)paren
(brace
id|brelse
c_func
(paren
id|bh-&gt;b_next
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|bh
)paren
suffix:semicolon
)brace
DECL|function|bigblock_fat_mark_buffer_dirty
r_void
id|bigblock_fat_mark_buffer_dirty
c_func
(paren
r_struct
id|super_block
op_star
id|sb
comma
r_struct
id|buffer_head
op_star
id|bh
)paren
(brace
id|mark_buffer_dirty
c_func
(paren
id|bh-&gt;b_next
)paren
suffix:semicolon
)brace
DECL|function|bigblock_fat_set_uptodate
r_void
id|bigblock_fat_set_uptodate
c_func
(paren
r_struct
id|super_block
op_star
id|sb
comma
r_struct
id|buffer_head
op_star
id|bh
comma
r_int
id|val
)paren
(brace
id|mark_buffer_uptodate
c_func
(paren
id|bh-&gt;b_next
comma
id|val
)paren
suffix:semicolon
)brace
DECL|function|bigblock_fat_is_uptodate
r_int
id|bigblock_fat_is_uptodate
c_func
(paren
r_struct
id|super_block
op_star
id|sb
comma
r_struct
id|buffer_head
op_star
id|bh
)paren
(brace
r_return
id|buffer_uptodate
c_func
(paren
id|bh-&gt;b_next
)paren
suffix:semicolon
)brace
DECL|function|bigblock_fat_ll_rw_block
r_void
id|bigblock_fat_ll_rw_block
(paren
r_struct
id|super_block
op_star
id|sb
comma
r_int
id|opr
comma
r_int
id|nbreq
comma
r_struct
id|buffer_head
op_star
id|bh
(braket
l_int|32
)braket
)paren
(brace
r_struct
id|buffer_head
op_star
id|tmp
(braket
l_int|32
)braket
suffix:semicolon
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|nbreq
suffix:semicolon
id|i
op_increment
)paren
id|tmp
(braket
id|i
)braket
op_assign
id|bh
(braket
id|i
)braket
op_member_access_from_pointer
id|b_next
suffix:semicolon
id|ll_rw_block
c_func
(paren
id|opr
comma
id|nbreq
comma
id|tmp
)paren
suffix:semicolon
)brace
eof
