macro_line|#include &lt;linux/types.h&gt;
macro_line|#include &lt;linux/wait.h&gt;
macro_line|#include &lt;linux/list.h&gt;
DECL|struct|smb_request
r_struct
id|smb_request
(brace
DECL|member|rq_queue
r_struct
id|list_head
id|rq_queue
suffix:semicolon
multiline_comment|/* recvq or xmitq for the server */
DECL|member|rq_count
id|atomic_t
id|rq_count
suffix:semicolon
DECL|member|rq_wait
id|wait_queue_head_t
id|rq_wait
suffix:semicolon
DECL|member|rq_flags
r_int
id|rq_flags
suffix:semicolon
DECL|member|rq_mid
r_int
id|rq_mid
suffix:semicolon
multiline_comment|/* multiplex ID, set by request.c */
DECL|member|rq_server
r_struct
id|smb_sb_info
op_star
id|rq_server
suffix:semicolon
multiline_comment|/* header + word count + parameter words + byte count */
DECL|member|rq_header
r_int
r_char
id|rq_header
(braket
id|SMB_HEADER_LEN
op_plus
l_int|20
op_star
l_int|2
op_plus
l_int|2
)braket
suffix:semicolon
DECL|member|rq_bufsize
r_int
id|rq_bufsize
suffix:semicolon
DECL|member|rq_buffer
r_int
r_char
op_star
id|rq_buffer
suffix:semicolon
multiline_comment|/* FIXME: this is not good enough for merging IO requests. */
DECL|member|rq_page
r_int
r_char
op_star
id|rq_page
suffix:semicolon
DECL|member|rq_rsize
r_int
id|rq_rsize
suffix:semicolon
DECL|member|rq_resp_wct
r_int
id|rq_resp_wct
suffix:semicolon
DECL|member|rq_resp_bcc
r_int
id|rq_resp_bcc
suffix:semicolon
DECL|member|rq_rlen
r_int
id|rq_rlen
suffix:semicolon
DECL|member|rq_bytes_recvd
r_int
id|rq_bytes_recvd
suffix:semicolon
DECL|member|rq_slen
r_int
id|rq_slen
suffix:semicolon
DECL|member|rq_bytes_sent
r_int
id|rq_bytes_sent
suffix:semicolon
DECL|member|rq_iovlen
r_int
id|rq_iovlen
suffix:semicolon
DECL|member|rq_iov
r_struct
id|iovec
id|rq_iov
(braket
l_int|4
)braket
suffix:semicolon
DECL|member|rq_setup_read
r_int
(paren
op_star
id|rq_setup_read
)paren
(paren
r_struct
id|smb_request
op_star
)paren
suffix:semicolon
DECL|member|rq_callback
r_void
(paren
op_star
id|rq_callback
)paren
(paren
r_struct
id|smb_request
op_star
)paren
suffix:semicolon
multiline_comment|/* ------ trans2 stuff ------ */
DECL|member|rq_trans2_command
id|u16
id|rq_trans2_command
suffix:semicolon
multiline_comment|/* 0 if not a trans2 request */
DECL|member|rq_ldata
r_int
r_int
id|rq_ldata
suffix:semicolon
DECL|member|rq_data
r_int
r_char
op_star
id|rq_data
suffix:semicolon
DECL|member|rq_lparm
r_int
r_int
id|rq_lparm
suffix:semicolon
DECL|member|rq_parm
r_int
r_char
op_star
id|rq_parm
suffix:semicolon
DECL|member|rq_fragment
r_int
id|rq_fragment
suffix:semicolon
DECL|member|rq_total_data
id|u32
id|rq_total_data
suffix:semicolon
DECL|member|rq_total_parm
id|u32
id|rq_total_parm
suffix:semicolon
DECL|member|rq_trans2bufsize
r_int
id|rq_trans2bufsize
suffix:semicolon
DECL|member|rq_trans2buffer
r_int
r_char
op_star
id|rq_trans2buffer
suffix:semicolon
multiline_comment|/* ------ response ------ */
DECL|member|rq_rcls
r_int
r_int
id|rq_rcls
suffix:semicolon
DECL|member|rq_err
r_int
r_int
id|rq_err
suffix:semicolon
DECL|member|rq_errno
r_int
id|rq_errno
suffix:semicolon
)brace
suffix:semicolon
DECL|macro|SMB_REQ_STATIC
mdefine_line|#define SMB_REQ_STATIC&t;&t;0x0001&t;/* rq_buffer is static */
DECL|macro|SMB_REQ_NORETRY
mdefine_line|#define SMB_REQ_NORETRY&t;&t;0x0002&t;/* request is invalid after retry */
DECL|macro|SMB_REQ_TRANSMITTED
mdefine_line|#define SMB_REQ_TRANSMITTED&t;0x4000&t;/* all data has been sent */
DECL|macro|SMB_REQ_RECEIVED
mdefine_line|#define SMB_REQ_RECEIVED&t;0x8000&t;/* reply received, smbiod is done */
DECL|macro|xSMB_REQ_NOREPLY
mdefine_line|#define xSMB_REQ_NOREPLY&t;0x0004&t;/* we don&squot;t want the reply (if any) */
DECL|macro|xSMB_REQ_NORECEIVER
mdefine_line|#define xSMB_REQ_NORECEIVER&t;0x0008&t;/* caller doesn&squot;t wait for response */
eof
