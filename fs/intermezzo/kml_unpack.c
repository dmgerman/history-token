multiline_comment|/* -*- mode: c; c-basic-offset: 8; indent-tabs-mode: nil; -*-&n; * vim:expandtab:shiftwidth=8:tabstop=8:&n; *&n; *  Copyright (C) 2001 Cluster File Systems, Inc. &lt;braam@clusterfs.com&gt;&n; *&n; *   This file is part of InterMezzo, http://www.inter-mezzo.org.&n; *&n; *   InterMezzo is free software; you can redistribute it and/or&n; *   modify it under the terms of version 2 of the GNU General Public&n; *   License as published by the Free Software Foundation.&n; *&n; *   InterMezzo is distributed in the hope that it will be useful,&n; *   but WITHOUT ANY WARRANTY; without even the implied warranty of&n; *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; *   GNU General Public License for more details.&n; *&n; *   You should have received a copy of the GNU General Public License&n; *   along with InterMezzo; if not, write to the Free Software&n; *   Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.&n; *&n; * Unpacking of KML records&n; *&n; */
macro_line|#ifdef __KERNEL__
macro_line|#  include &lt;linux/module.h&gt;
macro_line|#  include &lt;linux/errno.h&gt;
macro_line|#  include &lt;linux/kernel.h&gt;
macro_line|#  include &lt;linux/major.h&gt;
macro_line|#  include &lt;linux/sched.h&gt;
macro_line|#  include &lt;linux/lp.h&gt;
macro_line|#  include &lt;linux/slab.h&gt;
macro_line|#  include &lt;linux/ioport.h&gt;
macro_line|#  include &lt;linux/fcntl.h&gt;
macro_line|#  include &lt;linux/delay.h&gt;
macro_line|#  include &lt;linux/skbuff.h&gt;
macro_line|#  include &lt;linux/proc_fs.h&gt;
macro_line|#  include &lt;linux/vmalloc.h&gt;
macro_line|#  include &lt;linux/fs.h&gt;
macro_line|#  include &lt;linux/poll.h&gt;
macro_line|#  include &lt;linux/init.h&gt;
macro_line|#  include &lt;linux/list.h&gt;
macro_line|#  include &lt;linux/stat.h&gt;
macro_line|#  include &lt;asm/io.h&gt;
macro_line|#  include &lt;asm/segment.h&gt;
macro_line|#  include &lt;asm/system.h&gt;
macro_line|#  include &lt;asm/poll.h&gt;
macro_line|#  include &lt;asm/uaccess.h&gt;
macro_line|#else
macro_line|#  include &lt;time.h&gt;
macro_line|#  include &lt;stdio.h&gt;
macro_line|#  include &lt;string.h&gt;
macro_line|#  include &lt;stdlib.h&gt;
macro_line|#  include &lt;errno.h&gt;
macro_line|#  include &lt;sys/stat.h&gt;
macro_line|#  include &lt;glib.h&gt;
macro_line|#endif
macro_line|#include &lt;linux/intermezzo_lib.h&gt;
macro_line|#include &lt;linux/intermezzo_idl.h&gt;
macro_line|#include &lt;linux/intermezzo_fs.h&gt;
DECL|function|kml_unpack_version
r_int
id|kml_unpack_version
c_func
(paren
r_struct
id|presto_version
op_star
op_star
id|ver
comma
r_char
op_star
op_star
id|buf
comma
r_char
op_star
id|end
)paren
(brace
r_char
op_star
id|ptr
op_assign
op_star
id|buf
suffix:semicolon
r_struct
id|presto_version
op_star
id|pv
suffix:semicolon
id|UNLOGP
c_func
(paren
op_star
id|ver
comma
r_struct
id|presto_version
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|pv
op_assign
op_star
id|ver
suffix:semicolon
id|pv-&gt;pv_mtime
op_assign
id|NTOH__u64
c_func
(paren
id|pv-&gt;pv_mtime
)paren
suffix:semicolon
id|pv-&gt;pv_ctime
op_assign
id|NTOH__u64
c_func
(paren
id|pv-&gt;pv_ctime
)paren
suffix:semicolon
id|pv-&gt;pv_size
op_assign
id|NTOH__u64
c_func
(paren
id|pv-&gt;pv_size
)paren
suffix:semicolon
op_star
id|buf
op_assign
id|ptr
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|kml_unpack_noop
r_static
r_int
id|kml_unpack_noop
c_func
(paren
r_struct
id|kml_rec
op_star
id|rec
comma
r_char
op_star
op_star
id|buf
comma
r_char
op_star
id|end
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|kml_unpack_get_fileid
r_static
r_int
id|kml_unpack_get_fileid
c_func
(paren
r_struct
id|kml_rec
op_star
id|rec
comma
r_char
op_star
op_star
id|buf
comma
r_char
op_star
id|end
)paren
(brace
r_char
op_star
id|ptr
op_assign
op_star
id|buf
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;pathlen
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|UNLOGL
c_func
(paren
id|rec-&gt;path
comma
r_char
comma
id|rec-&gt;pathlen
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
op_star
id|buf
op_assign
id|ptr
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|kml_unpack_create
r_static
r_int
id|kml_unpack_create
c_func
(paren
r_struct
id|kml_rec
op_star
id|rec
comma
r_char
op_star
op_star
id|buf
comma
r_char
op_star
id|end
)paren
(brace
r_char
op_star
id|ptr
op_assign
op_star
id|buf
suffix:semicolon
id|kml_unpack_version
c_func
(paren
op_amp
id|rec-&gt;old_parentv
comma
op_amp
id|ptr
comma
id|end
)paren
suffix:semicolon
id|kml_unpack_version
c_func
(paren
op_amp
id|rec-&gt;new_parentv
comma
op_amp
id|ptr
comma
id|end
)paren
suffix:semicolon
id|kml_unpack_version
c_func
(paren
op_amp
id|rec-&gt;new_objectv
comma
op_amp
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;mode
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;uid
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;gid
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;pathlen
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|UNLOGL
c_func
(paren
id|rec-&gt;path
comma
r_char
comma
id|rec-&gt;pathlen
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
op_star
id|buf
op_assign
id|ptr
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|kml_unpack_mkdir
r_static
r_int
id|kml_unpack_mkdir
c_func
(paren
r_struct
id|kml_rec
op_star
id|rec
comma
r_char
op_star
op_star
id|buf
comma
r_char
op_star
id|end
)paren
(brace
r_char
op_star
id|ptr
op_assign
op_star
id|buf
suffix:semicolon
id|kml_unpack_version
c_func
(paren
op_amp
id|rec-&gt;old_parentv
comma
op_amp
id|ptr
comma
id|end
)paren
suffix:semicolon
id|kml_unpack_version
c_func
(paren
op_amp
id|rec-&gt;new_parentv
comma
op_amp
id|ptr
comma
id|end
)paren
suffix:semicolon
id|kml_unpack_version
c_func
(paren
op_amp
id|rec-&gt;new_objectv
comma
op_amp
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;mode
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;uid
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;gid
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;pathlen
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|UNLOGL
c_func
(paren
id|rec-&gt;path
comma
r_char
comma
id|rec-&gt;pathlen
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
op_star
id|buf
op_assign
id|ptr
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|kml_unpack_unlink
r_static
r_int
id|kml_unpack_unlink
c_func
(paren
r_struct
id|kml_rec
op_star
id|rec
comma
r_char
op_star
op_star
id|buf
comma
r_char
op_star
id|end
)paren
(brace
r_char
op_star
id|ptr
op_assign
op_star
id|buf
suffix:semicolon
id|kml_unpack_version
c_func
(paren
op_amp
id|rec-&gt;old_parentv
comma
op_amp
id|ptr
comma
id|end
)paren
suffix:semicolon
id|kml_unpack_version
c_func
(paren
op_amp
id|rec-&gt;new_parentv
comma
op_amp
id|ptr
comma
id|end
)paren
suffix:semicolon
id|kml_unpack_version
c_func
(paren
op_amp
id|rec-&gt;old_objectv
comma
op_amp
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;old_mode
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;old_rdev
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;old_uid
comma
id|__u64
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;old_gid
comma
id|__u64
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;pathlen
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;targetlen
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;old_targetlen
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|UNLOGL
c_func
(paren
id|rec-&gt;path
comma
r_char
comma
id|rec-&gt;pathlen
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|UNLOGL
c_func
(paren
id|rec-&gt;target
comma
r_char
comma
id|rec-&gt;targetlen
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|UNLOGL
c_func
(paren
id|rec-&gt;old_target
comma
r_char
comma
id|rec-&gt;old_targetlen
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
op_star
id|buf
op_assign
id|ptr
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|kml_unpack_rmdir
r_static
r_int
id|kml_unpack_rmdir
c_func
(paren
r_struct
id|kml_rec
op_star
id|rec
comma
r_char
op_star
op_star
id|buf
comma
r_char
op_star
id|end
)paren
(brace
r_char
op_star
id|ptr
op_assign
op_star
id|buf
suffix:semicolon
id|kml_unpack_version
c_func
(paren
op_amp
id|rec-&gt;old_parentv
comma
op_amp
id|ptr
comma
id|end
)paren
suffix:semicolon
id|kml_unpack_version
c_func
(paren
op_amp
id|rec-&gt;new_parentv
comma
op_amp
id|ptr
comma
id|end
)paren
suffix:semicolon
id|kml_unpack_version
c_func
(paren
op_amp
id|rec-&gt;old_objectv
comma
op_amp
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;old_mode
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;old_rdev
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;old_uid
comma
id|__u64
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;old_gid
comma
id|__u64
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;pathlen
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;targetlen
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|UNLOGL
c_func
(paren
id|rec-&gt;path
comma
r_char
comma
id|rec-&gt;pathlen
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|UNLOGL
c_func
(paren
id|rec-&gt;target
comma
r_char
comma
id|rec-&gt;targetlen
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
op_star
id|buf
op_assign
id|ptr
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|kml_unpack_close
r_static
r_int
id|kml_unpack_close
c_func
(paren
r_struct
id|kml_rec
op_star
id|rec
comma
r_char
op_star
op_star
id|buf
comma
r_char
op_star
id|end
)paren
(brace
r_char
op_star
id|ptr
op_assign
op_star
id|buf
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;mode
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
singleline_comment|// used for open_mode
id|LUNLOGV
c_func
(paren
id|rec-&gt;uid
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
singleline_comment|// used for open_uid
id|LUNLOGV
c_func
(paren
id|rec-&gt;gid
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
singleline_comment|// used for open_gid
id|kml_unpack_version
c_func
(paren
op_amp
id|rec-&gt;old_objectv
comma
op_amp
id|ptr
comma
id|end
)paren
suffix:semicolon
id|kml_unpack_version
c_func
(paren
op_amp
id|rec-&gt;new_objectv
comma
op_amp
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;ino
comma
id|__u64
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;generation
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;pathlen
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|UNLOGL
c_func
(paren
id|rec-&gt;path
comma
r_char
comma
id|rec-&gt;pathlen
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
op_star
id|buf
op_assign
id|ptr
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|kml_unpack_symlink
r_static
r_int
id|kml_unpack_symlink
c_func
(paren
r_struct
id|kml_rec
op_star
id|rec
comma
r_char
op_star
op_star
id|buf
comma
r_char
op_star
id|end
)paren
(brace
r_char
op_star
id|ptr
op_assign
op_star
id|buf
suffix:semicolon
id|kml_unpack_version
c_func
(paren
op_amp
id|rec-&gt;old_parentv
comma
op_amp
id|ptr
comma
id|end
)paren
suffix:semicolon
id|kml_unpack_version
c_func
(paren
op_amp
id|rec-&gt;new_parentv
comma
op_amp
id|ptr
comma
id|end
)paren
suffix:semicolon
id|kml_unpack_version
c_func
(paren
op_amp
id|rec-&gt;new_objectv
comma
op_amp
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;uid
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;gid
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;pathlen
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;targetlen
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|UNLOGL
c_func
(paren
id|rec-&gt;path
comma
r_char
comma
id|rec-&gt;pathlen
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|UNLOGL
c_func
(paren
id|rec-&gt;target
comma
r_char
comma
id|rec-&gt;targetlen
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
op_star
id|buf
op_assign
id|ptr
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|kml_unpack_rename
r_static
r_int
id|kml_unpack_rename
c_func
(paren
r_struct
id|kml_rec
op_star
id|rec
comma
r_char
op_star
op_star
id|buf
comma
r_char
op_star
id|end
)paren
(brace
r_char
op_star
id|ptr
op_assign
op_star
id|buf
suffix:semicolon
id|kml_unpack_version
c_func
(paren
op_amp
id|rec-&gt;old_objectv
comma
op_amp
id|ptr
comma
id|end
)paren
suffix:semicolon
id|kml_unpack_version
c_func
(paren
op_amp
id|rec-&gt;new_objectv
comma
op_amp
id|ptr
comma
id|end
)paren
suffix:semicolon
id|kml_unpack_version
c_func
(paren
op_amp
id|rec-&gt;old_parentv
comma
op_amp
id|ptr
comma
id|end
)paren
suffix:semicolon
id|kml_unpack_version
c_func
(paren
op_amp
id|rec-&gt;new_parentv
comma
op_amp
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;pathlen
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;targetlen
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|UNLOGL
c_func
(paren
id|rec-&gt;path
comma
r_char
comma
id|rec-&gt;pathlen
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|UNLOGL
c_func
(paren
id|rec-&gt;target
comma
r_char
comma
id|rec-&gt;targetlen
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
op_star
id|buf
op_assign
id|ptr
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|kml_unpack_setattr
r_static
r_int
id|kml_unpack_setattr
c_func
(paren
r_struct
id|kml_rec
op_star
id|rec
comma
r_char
op_star
op_star
id|buf
comma
r_char
op_star
id|end
)paren
(brace
r_char
op_star
id|ptr
op_assign
op_star
id|buf
suffix:semicolon
id|kml_unpack_version
c_func
(paren
op_amp
id|rec-&gt;old_objectv
comma
op_amp
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;valid
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;mode
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;uid
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;gid
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;size
comma
id|__u64
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;mtime
comma
id|__u64
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;ctime
comma
id|__u64
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;flags
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;old_mode
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;old_rdev
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;old_uid
comma
id|__u64
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;old_gid
comma
id|__u64
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;pathlen
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|UNLOGL
c_func
(paren
id|rec-&gt;path
comma
r_char
comma
id|rec-&gt;pathlen
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
op_star
id|buf
op_assign
id|ptr
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|kml_unpack_link
r_static
r_int
id|kml_unpack_link
c_func
(paren
r_struct
id|kml_rec
op_star
id|rec
comma
r_char
op_star
op_star
id|buf
comma
r_char
op_star
id|end
)paren
(brace
r_char
op_star
id|ptr
op_assign
op_star
id|buf
suffix:semicolon
id|kml_unpack_version
c_func
(paren
op_amp
id|rec-&gt;old_parentv
comma
op_amp
id|ptr
comma
id|end
)paren
suffix:semicolon
id|kml_unpack_version
c_func
(paren
op_amp
id|rec-&gt;new_parentv
comma
op_amp
id|ptr
comma
id|end
)paren
suffix:semicolon
id|kml_unpack_version
c_func
(paren
op_amp
id|rec-&gt;new_objectv
comma
op_amp
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;pathlen
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;targetlen
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|UNLOGL
c_func
(paren
id|rec-&gt;path
comma
r_char
comma
id|rec-&gt;pathlen
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|UNLOGL
c_func
(paren
id|rec-&gt;target
comma
r_char
comma
id|rec-&gt;targetlen
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
op_star
id|buf
op_assign
id|ptr
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|kml_unpack_mknod
r_static
r_int
id|kml_unpack_mknod
c_func
(paren
r_struct
id|kml_rec
op_star
id|rec
comma
r_char
op_star
op_star
id|buf
comma
r_char
op_star
id|end
)paren
(brace
r_char
op_star
id|ptr
op_assign
op_star
id|buf
suffix:semicolon
id|kml_unpack_version
c_func
(paren
op_amp
id|rec-&gt;old_parentv
comma
op_amp
id|ptr
comma
id|end
)paren
suffix:semicolon
id|kml_unpack_version
c_func
(paren
op_amp
id|rec-&gt;new_parentv
comma
op_amp
id|ptr
comma
id|end
)paren
suffix:semicolon
id|kml_unpack_version
c_func
(paren
op_amp
id|rec-&gt;new_objectv
comma
op_amp
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;mode
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;uid
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;gid
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;major
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;minor
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;pathlen
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|UNLOGL
c_func
(paren
id|rec-&gt;path
comma
r_char
comma
id|rec-&gt;pathlen
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
op_star
id|buf
op_assign
id|ptr
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|kml_unpack_write
r_static
r_int
id|kml_unpack_write
c_func
(paren
r_struct
id|kml_rec
op_star
id|rec
comma
r_char
op_star
op_star
id|buf
comma
r_char
op_star
id|end
)paren
(brace
id|printf
c_func
(paren
l_string|&quot;NOT IMPLEMENTED&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|kml_unpack_release
r_static
r_int
id|kml_unpack_release
c_func
(paren
r_struct
id|kml_rec
op_star
id|rec
comma
r_char
op_star
op_star
id|buf
comma
r_char
op_star
id|end
)paren
(brace
id|printf
c_func
(paren
l_string|&quot;NOT IMPLEMENTED&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|kml_unpack_trunc
r_static
r_int
id|kml_unpack_trunc
c_func
(paren
r_struct
id|kml_rec
op_star
id|rec
comma
r_char
op_star
op_star
id|buf
comma
r_char
op_star
id|end
)paren
(brace
id|printf
c_func
(paren
l_string|&quot;NOT IMPLEMENTED&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|kml_unpack_setextattr
r_static
r_int
id|kml_unpack_setextattr
c_func
(paren
r_struct
id|kml_rec
op_star
id|rec
comma
r_char
op_star
op_star
id|buf
comma
r_char
op_star
id|end
)paren
(brace
r_char
op_star
id|ptr
op_assign
op_star
id|buf
suffix:semicolon
id|kml_unpack_version
c_func
(paren
op_amp
id|rec-&gt;old_objectv
comma
op_amp
id|ptr
comma
id|end
)paren
suffix:semicolon
id|kml_unpack_version
c_func
(paren
op_amp
id|rec-&gt;new_objectv
comma
op_amp
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;flags
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;mode
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;pathlen
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;namelen
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;targetlen
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|UNLOGL
c_func
(paren
id|rec-&gt;path
comma
r_char
comma
id|rec-&gt;pathlen
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|UNLOGL
c_func
(paren
id|rec-&gt;name
comma
r_char
comma
id|rec-&gt;namelen
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|UNLOGL
c_func
(paren
id|rec-&gt;target
comma
r_char
comma
id|rec-&gt;targetlen
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
op_star
id|buf
op_assign
id|ptr
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|kml_unpack_delextattr
r_static
r_int
id|kml_unpack_delextattr
c_func
(paren
r_struct
id|kml_rec
op_star
id|rec
comma
r_char
op_star
op_star
id|buf
comma
r_char
op_star
id|end
)paren
(brace
r_char
op_star
id|ptr
op_assign
op_star
id|buf
suffix:semicolon
id|kml_unpack_version
c_func
(paren
op_amp
id|rec-&gt;old_objectv
comma
op_amp
id|ptr
comma
id|end
)paren
suffix:semicolon
id|kml_unpack_version
c_func
(paren
op_amp
id|rec-&gt;new_objectv
comma
op_amp
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;flags
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;mode
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;pathlen
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;namelen
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|LUNLOGV
c_func
(paren
id|rec-&gt;targetlen
comma
id|__u32
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|UNLOGL
c_func
(paren
id|rec-&gt;path
comma
r_char
comma
id|rec-&gt;pathlen
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|UNLOGL
c_func
(paren
id|rec-&gt;name
comma
r_char
comma
id|rec-&gt;namelen
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
op_star
id|buf
op_assign
id|ptr
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|kml_unpack_open
r_static
r_int
id|kml_unpack_open
c_func
(paren
r_struct
id|kml_rec
op_star
id|rec
comma
r_char
op_star
op_star
id|buf
comma
r_char
op_star
id|end
)paren
(brace
id|printf
c_func
(paren
l_string|&quot;NOT IMPLEMENTED&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|kml_unpack_kml_trunc
r_static
r_int
id|kml_unpack_kml_trunc
c_func
(paren
r_struct
id|kml_rec
op_star
id|rec
comma
r_char
op_star
op_star
id|buf
comma
r_char
op_star
id|end
)paren
(brace
id|printf
c_func
(paren
l_string|&quot;NOT IMPLEMENTED&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|typedef|unpacker
r_typedef
r_int
(paren
op_star
id|unpacker
)paren
(paren
r_struct
id|kml_rec
op_star
id|rec
comma
r_char
op_star
op_star
id|buf
comma
r_char
op_star
id|end
)paren
suffix:semicolon
DECL|variable|unpackers
r_static
id|unpacker
id|unpackers
(braket
id|KML_OPCODE_NUM
)braket
op_assign
(brace
(braket
id|KML_OPCODE_NOOP
)braket
op_assign
id|kml_unpack_noop
comma
(braket
id|KML_OPCODE_CREATE
)braket
op_assign
id|kml_unpack_create
comma
(braket
id|KML_OPCODE_MKDIR
)braket
op_assign
id|kml_unpack_mkdir
comma
(braket
id|KML_OPCODE_UNLINK
)braket
op_assign
id|kml_unpack_unlink
comma
(braket
id|KML_OPCODE_RMDIR
)braket
op_assign
id|kml_unpack_rmdir
comma
(braket
id|KML_OPCODE_CLOSE
)braket
op_assign
id|kml_unpack_close
comma
(braket
id|KML_OPCODE_SYMLINK
)braket
op_assign
id|kml_unpack_symlink
comma
(braket
id|KML_OPCODE_RENAME
)braket
op_assign
id|kml_unpack_rename
comma
(braket
id|KML_OPCODE_SETATTR
)braket
op_assign
id|kml_unpack_setattr
comma
(braket
id|KML_OPCODE_LINK
)braket
op_assign
id|kml_unpack_link
comma
(braket
id|KML_OPCODE_OPEN
)braket
op_assign
id|kml_unpack_open
comma
(braket
id|KML_OPCODE_MKNOD
)braket
op_assign
id|kml_unpack_mknod
comma
(braket
id|KML_OPCODE_WRITE
)braket
op_assign
id|kml_unpack_write
comma
(braket
id|KML_OPCODE_RELEASE
)braket
op_assign
id|kml_unpack_release
comma
(braket
id|KML_OPCODE_TRUNC
)braket
op_assign
id|kml_unpack_trunc
comma
(braket
id|KML_OPCODE_SETEXTATTR
)braket
op_assign
id|kml_unpack_setextattr
comma
(braket
id|KML_OPCODE_DELEXTATTR
)braket
op_assign
id|kml_unpack_delextattr
comma
(braket
id|KML_OPCODE_KML_TRUNC
)braket
op_assign
id|kml_unpack_kml_trunc
comma
(braket
id|KML_OPCODE_GET_FILEID
)braket
op_assign
id|kml_unpack_get_fileid
)brace
suffix:semicolon
DECL|function|kml_unpack_prefix
r_int
id|kml_unpack_prefix
c_func
(paren
r_struct
id|kml_rec
op_star
id|rec
comma
r_char
op_star
op_star
id|buf
comma
r_char
op_star
id|end
)paren
(brace
r_char
op_star
id|ptr
op_assign
op_star
id|buf
suffix:semicolon
r_int
id|n
suffix:semicolon
id|UNLOGP
c_func
(paren
id|rec-&gt;prefix.hdr
comma
r_struct
id|kml_prefix_hdr
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|rec-&gt;prefix.hdr-&gt;len
op_assign
id|NTOH__u32
c_func
(paren
id|rec-&gt;prefix.hdr-&gt;len
)paren
suffix:semicolon
id|rec-&gt;prefix.hdr-&gt;version
op_assign
id|NTOH__u32
c_func
(paren
id|rec-&gt;prefix.hdr-&gt;version
)paren
suffix:semicolon
id|rec-&gt;prefix.hdr-&gt;pid
op_assign
id|NTOH__u32
c_func
(paren
id|rec-&gt;prefix.hdr-&gt;pid
)paren
suffix:semicolon
id|rec-&gt;prefix.hdr-&gt;auid
op_assign
id|NTOH__u32
c_func
(paren
id|rec-&gt;prefix.hdr-&gt;auid
)paren
suffix:semicolon
id|rec-&gt;prefix.hdr-&gt;fsuid
op_assign
id|NTOH__u32
c_func
(paren
id|rec-&gt;prefix.hdr-&gt;fsuid
)paren
suffix:semicolon
id|rec-&gt;prefix.hdr-&gt;fsgid
op_assign
id|NTOH__u32
c_func
(paren
id|rec-&gt;prefix.hdr-&gt;fsgid
)paren
suffix:semicolon
id|rec-&gt;prefix.hdr-&gt;opcode
op_assign
id|NTOH__u32
c_func
(paren
id|rec-&gt;prefix.hdr-&gt;opcode
)paren
suffix:semicolon
id|rec-&gt;prefix.hdr-&gt;ngroups
op_assign
id|NTOH__u32
c_func
(paren
id|rec-&gt;prefix.hdr-&gt;ngroups
)paren
suffix:semicolon
id|UNLOGL
c_func
(paren
id|rec-&gt;prefix.groups
comma
id|__u32
comma
id|rec-&gt;prefix.hdr-&gt;ngroups
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
r_for
c_loop
(paren
id|n
op_assign
l_int|0
suffix:semicolon
id|n
OL
id|rec-&gt;prefix.hdr-&gt;ngroups
suffix:semicolon
id|n
op_increment
)paren
(brace
id|rec-&gt;prefix.groups
(braket
id|n
)braket
op_assign
id|NTOH__u32
c_func
(paren
id|rec-&gt;prefix.groups
(braket
id|n
)braket
)paren
suffix:semicolon
)brace
op_star
id|buf
op_assign
id|ptr
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|kml_unpack_suffix
r_int
id|kml_unpack_suffix
c_func
(paren
r_struct
id|kml_rec
op_star
id|rec
comma
r_char
op_star
op_star
id|buf
comma
r_char
op_star
id|end
)paren
(brace
r_char
op_star
id|ptr
op_assign
op_star
id|buf
suffix:semicolon
id|UNLOGP
c_func
(paren
id|rec-&gt;suffix
comma
r_struct
id|kml_suffix
comma
id|ptr
comma
id|end
)paren
suffix:semicolon
id|rec-&gt;suffix-&gt;prevrec
op_assign
id|NTOH__u32
c_func
(paren
id|rec-&gt;suffix-&gt;prevrec
)paren
suffix:semicolon
id|rec-&gt;suffix-&gt;recno
op_assign
id|NTOH__u32
c_func
(paren
id|rec-&gt;suffix-&gt;recno
)paren
suffix:semicolon
id|rec-&gt;suffix-&gt;time
op_assign
id|NTOH__u32
c_func
(paren
id|rec-&gt;suffix-&gt;time
)paren
suffix:semicolon
id|rec-&gt;suffix-&gt;len
op_assign
id|NTOH__u32
c_func
(paren
id|rec-&gt;suffix-&gt;len
)paren
suffix:semicolon
op_star
id|buf
op_assign
id|ptr
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|kml_unpack
r_int
id|kml_unpack
c_func
(paren
r_struct
id|kml_rec
op_star
id|rec
comma
r_char
op_star
op_star
id|buf
comma
r_char
op_star
id|end
)paren
(brace
r_char
op_star
id|ptr
op_assign
op_star
id|buf
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
(paren
(paren
r_int
r_int
)paren
id|ptr
op_mod
l_int|4
)paren
op_ne
l_int|0
)paren
(brace
id|printf
c_func
(paren
l_string|&quot;InterMezzo: %s: record misaligned.&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_while
c_loop
(paren
id|ptr
OL
id|end
)paren
(brace
id|__u32
op_star
id|i
op_assign
(paren
id|__u32
op_star
)paren
id|ptr
suffix:semicolon
r_if
c_cond
(paren
op_star
id|i
)paren
r_break
suffix:semicolon
id|ptr
op_add_assign
r_sizeof
(paren
op_star
id|i
)paren
suffix:semicolon
)brace
op_star
id|buf
op_assign
id|ptr
suffix:semicolon
id|memset
c_func
(paren
id|rec
comma
l_int|0
comma
r_sizeof
(paren
op_star
id|rec
)paren
)paren
suffix:semicolon
id|err
op_assign
id|kml_unpack_prefix
c_func
(paren
id|rec
comma
op_amp
id|ptr
comma
id|end
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
(brace
id|printf
c_func
(paren
l_string|&quot;InterMezzo: %s: unpack_prefix failed: %d&bslash;n&quot;
comma
id|__FUNCTION__
comma
id|err
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
r_if
c_cond
(paren
id|rec-&gt;prefix.hdr-&gt;opcode
OL
l_int|0
op_logical_or
id|rec-&gt;prefix.hdr-&gt;opcode
op_ge
id|KML_OPCODE_NUM
)paren
(brace
id|printf
c_func
(paren
l_string|&quot;InterMezzo: %s: invalid opcode (%d)&bslash;n&quot;
comma
id|__FUNCTION__
comma
id|rec-&gt;prefix.hdr-&gt;opcode
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|err
op_assign
id|unpackers
(braket
id|rec-&gt;prefix.hdr-&gt;opcode
)braket
(paren
id|rec
comma
op_amp
id|ptr
comma
id|end
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
(brace
id|printf
c_func
(paren
l_string|&quot;InterMezzo: %s: unpacker failed: %d&bslash;n&quot;
comma
id|__FUNCTION__
comma
id|err
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
id|err
op_assign
id|kml_unpack_suffix
c_func
(paren
id|rec
comma
op_amp
id|ptr
comma
id|end
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
(brace
id|printf
c_func
(paren
l_string|&quot;InterMezzo: %s: unpack_suffix failed: %d&bslash;n&quot;
comma
id|__FUNCTION__
comma
id|err
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
r_if
c_cond
(paren
id|rec-&gt;prefix.hdr-&gt;len
op_ne
id|rec-&gt;suffix-&gt;len
)paren
(brace
id|printf
c_func
(paren
l_string|&quot;InterMezzo: %s: lengths don&squot;t match&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|rec-&gt;prefix.hdr-&gt;len
op_mod
l_int|4
)paren
op_ne
l_int|0
)paren
(brace
id|printf
c_func
(paren
l_string|&quot;InterMezzo: %s: record length not a &quot;
l_string|&quot;multiple of 4.&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ptr
op_minus
op_star
id|buf
op_ne
id|rec-&gt;prefix.hdr-&gt;len
)paren
(brace
id|printf
c_func
(paren
l_string|&quot;InterMezzo: %s: unpacking error&bslash;n&quot;
comma
id|__FUNCTION__
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_while
c_loop
(paren
id|ptr
OL
id|end
)paren
(brace
id|__u32
op_star
id|i
op_assign
(paren
id|__u32
op_star
)paren
id|ptr
suffix:semicolon
r_if
c_cond
(paren
op_star
id|i
)paren
r_break
suffix:semicolon
id|ptr
op_add_assign
r_sizeof
(paren
op_star
id|i
)paren
suffix:semicolon
)brace
op_star
id|buf
op_assign
id|ptr
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#ifndef __KERNEL__
DECL|macro|STR
mdefine_line|#define STR(ptr) ((ptr))? (ptr) : &quot;&quot;
DECL|macro|OPNAME
mdefine_line|#define OPNAME(n) [KML_OPCODE_##n] = #n
DECL|variable|opnames
r_static
r_char
op_star
id|opnames
(braket
id|KML_OPCODE_NUM
)braket
op_assign
(brace
id|OPNAME
c_func
(paren
id|NOOP
)paren
comma
id|OPNAME
c_func
(paren
id|CREATE
)paren
comma
id|OPNAME
c_func
(paren
id|MKDIR
)paren
comma
id|OPNAME
c_func
(paren
id|UNLINK
)paren
comma
id|OPNAME
c_func
(paren
id|RMDIR
)paren
comma
id|OPNAME
c_func
(paren
id|CLOSE
)paren
comma
id|OPNAME
c_func
(paren
id|SYMLINK
)paren
comma
id|OPNAME
c_func
(paren
id|RENAME
)paren
comma
id|OPNAME
c_func
(paren
id|SETATTR
)paren
comma
id|OPNAME
c_func
(paren
id|LINK
)paren
comma
id|OPNAME
c_func
(paren
id|OPEN
)paren
comma
id|OPNAME
c_func
(paren
id|MKNOD
)paren
comma
id|OPNAME
c_func
(paren
id|WRITE
)paren
comma
id|OPNAME
c_func
(paren
id|RELEASE
)paren
comma
id|OPNAME
c_func
(paren
id|TRUNC
)paren
comma
id|OPNAME
c_func
(paren
id|SETEXTATTR
)paren
comma
id|OPNAME
c_func
(paren
id|DELEXTATTR
)paren
comma
id|OPNAME
c_func
(paren
id|KML_TRUNC
)paren
comma
id|OPNAME
c_func
(paren
id|GET_FILEID
)paren
)brace
suffix:semicolon
DECL|macro|OPNAME
macro_line|#undef OPNAME
DECL|function|print_opname
r_static
r_char
op_star
id|print_opname
c_func
(paren
r_int
id|op
)paren
(brace
r_if
c_cond
(paren
id|op
OL
l_int|0
op_logical_or
id|op
op_ge
r_sizeof
(paren
id|opnames
)paren
op_div
r_sizeof
(paren
op_star
id|opnames
)paren
)paren
r_return
l_int|NULL
suffix:semicolon
r_return
id|opnames
(braket
id|op
)braket
suffix:semicolon
)brace
DECL|function|print_time
r_static
r_char
op_star
id|print_time
c_func
(paren
id|__u64
id|i
)paren
(brace
r_char
id|buf
(braket
l_int|128
)braket
suffix:semicolon
id|memset
c_func
(paren
id|buf
comma
l_int|0
comma
l_int|128
)paren
suffix:semicolon
macro_line|#ifndef __KERNEL__
id|strftime
c_func
(paren
id|buf
comma
l_int|128
comma
l_string|&quot;%Y/%m/%d %H:%M:%S&quot;
comma
id|gmtime
c_func
(paren
(paren
id|time_t
op_star
)paren
op_amp
id|i
)paren
)paren
suffix:semicolon
macro_line|#else
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%Ld&bslash;n&quot;
comma
id|i
)paren
suffix:semicolon
macro_line|#endif
r_return
id|strdup
c_func
(paren
id|buf
)paren
suffix:semicolon
)brace
DECL|function|print_version
r_static
r_char
op_star
id|print_version
c_func
(paren
r_struct
id|presto_version
op_star
id|ver
)paren
(brace
r_char
id|ver_buf
(braket
l_int|128
)braket
suffix:semicolon
r_char
op_star
id|mtime
suffix:semicolon
r_char
op_star
id|ctime
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ver
op_logical_or
id|ver-&gt;pv_ctime
op_eq
l_int|0
)paren
(brace
r_return
id|strdup
c_func
(paren
l_string|&quot;&quot;
)paren
suffix:semicolon
)brace
id|mtime
op_assign
id|print_time
c_func
(paren
id|ver-&gt;pv_mtime
)paren
suffix:semicolon
id|ctime
op_assign
id|print_time
c_func
(paren
id|ver-&gt;pv_ctime
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|ver_buf
comma
l_string|&quot;mtime %s, ctime %s, len %lld&quot;
comma
id|mtime
comma
id|ctime
comma
id|ver-&gt;pv_size
)paren
suffix:semicolon
id|free
c_func
(paren
id|mtime
)paren
suffix:semicolon
id|free
c_func
(paren
id|ctime
)paren
suffix:semicolon
r_return
id|strdup
c_func
(paren
id|ver_buf
)paren
suffix:semicolon
)brace
DECL|function|kml_print_rec
r_char
op_star
id|kml_print_rec
c_func
(paren
r_struct
id|kml_rec
op_star
id|rec
comma
r_int
id|brief
)paren
(brace
r_char
op_star
id|str
suffix:semicolon
r_char
op_star
id|nov
comma
op_star
id|oov
comma
op_star
id|ntv
comma
op_star
id|otv
comma
op_star
id|npv
comma
op_star
id|opv
suffix:semicolon
r_char
op_star
id|rectime
comma
op_star
id|mtime
comma
op_star
id|ctime
suffix:semicolon
r_if
c_cond
(paren
id|brief
)paren
(brace
id|str
op_assign
id|g_strdup_printf
c_func
(paren
l_string|&quot; %08d %7s %*s %*s&quot;
comma
id|rec-&gt;suffix-&gt;recno
comma
id|print_opname
(paren
id|rec-&gt;prefix.hdr-&gt;opcode
)paren
comma
id|rec-&gt;pathlen
comma
id|STR
c_func
(paren
id|rec-&gt;path
)paren
comma
id|rec-&gt;targetlen
comma
id|STR
c_func
(paren
id|rec-&gt;target
)paren
)paren
suffix:semicolon
r_return
id|str
suffix:semicolon
)brace
id|rectime
op_assign
id|print_time
c_func
(paren
id|rec-&gt;suffix-&gt;time
)paren
suffix:semicolon
id|mtime
op_assign
id|print_time
c_func
(paren
id|rec-&gt;mtime
)paren
suffix:semicolon
id|ctime
op_assign
id|print_time
c_func
(paren
id|rec-&gt;ctime
)paren
suffix:semicolon
id|nov
op_assign
id|print_version
c_func
(paren
id|rec-&gt;new_objectv
)paren
suffix:semicolon
id|oov
op_assign
id|print_version
c_func
(paren
id|rec-&gt;old_objectv
)paren
suffix:semicolon
id|ntv
op_assign
id|print_version
c_func
(paren
id|rec-&gt;new_targetv
)paren
suffix:semicolon
id|otv
op_assign
id|print_version
c_func
(paren
id|rec-&gt;old_targetv
)paren
suffix:semicolon
id|npv
op_assign
id|print_version
c_func
(paren
id|rec-&gt;new_parentv
)paren
suffix:semicolon
id|opv
op_assign
id|print_version
c_func
(paren
id|rec-&gt;old_parentv
)paren
suffix:semicolon
id|str
op_assign
id|g_strdup_printf
c_func
(paren
l_string|&quot;&bslash;n -- Record:&bslash;n&quot;
l_string|&quot;    Recno     %d&bslash;n&quot;
l_string|&quot;    KML off   %lld&bslash;n&quot;
l_string|&quot;    Version   %d&bslash;n&quot;
l_string|&quot;    Len       %d&bslash;n&quot;
l_string|&quot;    Suf len   %d&bslash;n&quot;
l_string|&quot;    Time      %s&bslash;n&quot;
l_string|&quot;    Opcode    %d&bslash;n&quot;
l_string|&quot;    Op        %s&bslash;n&quot;
l_string|&quot;    Pid       %d&bslash;n&quot;
l_string|&quot;    AUid      %d&bslash;n&quot;
l_string|&quot;    Fsuid     %d&bslash;n&quot;
l_string|&quot;    Fsgid     %d&bslash;n&quot;
l_string|&quot;    Prevrec   %d&bslash;n&quot;
l_string|&quot;    Ngroups   %d&bslash;n&quot;
singleline_comment|//&quot;    Groups    @{$self-&gt;{groups}}&bslash;n&quot; 
l_string|&quot; -- Path:&bslash;n&quot;
l_string|&quot;    Inode     %d&bslash;n&quot;
l_string|&quot;    Gen num   %u&bslash;n&quot;
l_string|&quot;    Old mode  %o&bslash;n&quot;
l_string|&quot;    Old rdev  %x&bslash;n&quot;
l_string|&quot;    Old uid   %llu&bslash;n&quot;
l_string|&quot;    Old gid   %llu&bslash;n&quot;
l_string|&quot;    Path      %*s&bslash;n&quot;
singleline_comment|//&quot;    Open_mode %o&bslash;n&quot;,
l_string|&quot;    Pathlen   %d&bslash;n&quot;
l_string|&quot;    Tgt       %*s&bslash;n&quot;
l_string|&quot;    Tgtlen    %d&bslash;n&quot;
l_string|&quot;    Old Tgt   %*s&bslash;n&quot;
l_string|&quot;    Old Tgtln %d&bslash;n&quot;
l_string|&quot; -- Attr:&bslash;n&quot;
l_string|&quot;    Valid     %x&bslash;n&quot;
l_string|&quot;    mode %o, uid %d, gid %d, size %lld, mtime %s, ctime %s rdev %x (%d:%d)&bslash;n&quot;
l_string|&quot; -- Versions:&bslash;n&quot;
l_string|&quot;    New object %s&bslash;n&quot;
l_string|&quot;    Old object %s&bslash;n&quot;
l_string|&quot;    New target %s&bslash;n&quot;
l_string|&quot;    Old target %s&bslash;n&quot;
l_string|&quot;    New parent %s&bslash;n&quot;
l_string|&quot;    Old parent %s&bslash;n&quot;
comma
id|rec-&gt;suffix-&gt;recno
comma
id|rec-&gt;offset
comma
id|rec-&gt;prefix.hdr-&gt;version
comma
id|rec-&gt;prefix.hdr-&gt;len
comma
id|rec-&gt;suffix-&gt;len
comma
id|rectime
comma
id|rec-&gt;prefix.hdr-&gt;opcode
comma
id|print_opname
(paren
id|rec-&gt;prefix.hdr-&gt;opcode
)paren
comma
id|rec-&gt;prefix.hdr-&gt;pid
comma
id|rec-&gt;prefix.hdr-&gt;auid
comma
id|rec-&gt;prefix.hdr-&gt;fsuid
comma
id|rec-&gt;prefix.hdr-&gt;fsgid
comma
id|rec-&gt;suffix-&gt;prevrec
comma
id|rec-&gt;prefix.hdr-&gt;ngroups
comma
id|rec-&gt;ino
comma
id|rec-&gt;generation
comma
id|rec-&gt;old_mode
comma
id|rec-&gt;old_rdev
comma
id|rec-&gt;old_uid
comma
id|rec-&gt;old_gid
comma
id|rec-&gt;pathlen
comma
id|STR
c_func
(paren
id|rec-&gt;path
)paren
comma
id|rec-&gt;pathlen
comma
id|rec-&gt;targetlen
comma
id|STR
c_func
(paren
id|rec-&gt;target
)paren
comma
id|rec-&gt;targetlen
comma
id|rec-&gt;old_targetlen
comma
id|STR
c_func
(paren
id|rec-&gt;old_target
)paren
comma
id|rec-&gt;old_targetlen
comma
id|rec-&gt;valid
comma
id|rec-&gt;mode
comma
id|rec-&gt;uid
comma
id|rec-&gt;gid
comma
id|rec-&gt;size
comma
id|mtime
comma
id|ctime
comma
id|rec-&gt;rdev
comma
id|rec-&gt;major
comma
id|rec-&gt;minor
comma
id|nov
comma
id|oov
comma
id|ntv
comma
id|otv
comma
id|npv
comma
id|opv
)paren
suffix:semicolon
id|free
c_func
(paren
id|nov
)paren
suffix:semicolon
id|free
c_func
(paren
id|oov
)paren
suffix:semicolon
id|free
c_func
(paren
id|ntv
)paren
suffix:semicolon
id|free
c_func
(paren
id|otv
)paren
suffix:semicolon
id|free
c_func
(paren
id|npv
)paren
suffix:semicolon
id|free
c_func
(paren
id|opv
)paren
suffix:semicolon
id|free
c_func
(paren
id|rectime
)paren
suffix:semicolon
id|free
c_func
(paren
id|ctime
)paren
suffix:semicolon
id|free
c_func
(paren
id|mtime
)paren
suffix:semicolon
r_return
id|str
suffix:semicolon
)brace
macro_line|#endif
eof
