multiline_comment|/* This contains the cookie-cutter code for ELF handling (32 v 64).&n;   Return true if anything output. */
DECL|function|analyse_file
r_static
r_void
id|analyse_file
c_func
(paren
id|Elf_Ehdr
op_star
id|hdr
comma
r_int
r_int
id|size
comma
r_const
r_char
op_star
id|filename
)paren
(brace
r_int
r_int
id|i
comma
id|num_syms
op_assign
l_int|0
suffix:semicolon
id|Elf_Shdr
op_star
id|sechdrs
suffix:semicolon
id|Elf_Sym
op_star
id|syms
op_assign
l_int|NULL
suffix:semicolon
r_char
op_star
id|secstrings
comma
op_star
id|strtab
op_assign
l_int|NULL
suffix:semicolon
r_int
id|first
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|size
OL
r_sizeof
(paren
op_star
id|hdr
)paren
)paren
r_goto
id|truncated
suffix:semicolon
id|sechdrs
op_assign
(paren
r_void
op_star
)paren
id|hdr
op_plus
id|TO_NATIVE
c_func
(paren
id|hdr-&gt;e_shoff
)paren
suffix:semicolon
r_if
c_cond
(paren
id|switch_endian
)paren
(brace
id|hdr-&gt;e_shoff
op_assign
id|TO_NATIVE
c_func
(paren
id|hdr-&gt;e_shoff
)paren
suffix:semicolon
id|hdr-&gt;e_shstrndx
op_assign
id|TO_NATIVE
c_func
(paren
id|hdr-&gt;e_shstrndx
)paren
suffix:semicolon
id|hdr-&gt;e_shnum
op_assign
id|TO_NATIVE
c_func
(paren
id|hdr-&gt;e_shnum
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|hdr-&gt;e_shnum
suffix:semicolon
id|i
op_increment
)paren
(brace
id|sechdrs
(braket
id|i
)braket
dot
id|sh_type
op_assign
id|TO_NATIVE
c_func
(paren
id|sechdrs
(braket
id|i
)braket
dot
id|sh_type
)paren
suffix:semicolon
id|sechdrs
(braket
id|i
)braket
dot
id|sh_offset
op_assign
id|TO_NATIVE
c_func
(paren
id|sechdrs
(braket
id|i
)braket
dot
id|sh_offset
)paren
suffix:semicolon
id|sechdrs
(braket
id|i
)braket
dot
id|sh_size
op_assign
id|TO_NATIVE
c_func
(paren
id|sechdrs
(braket
id|i
)braket
dot
id|sh_size
)paren
suffix:semicolon
id|sechdrs
(braket
id|i
)braket
dot
id|sh_link
op_assign
id|TO_NATIVE
c_func
(paren
id|sechdrs
(braket
id|i
)braket
dot
id|sh_link
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/* Find symbol table. */
id|secstrings
op_assign
(paren
r_void
op_star
)paren
id|hdr
op_plus
id|sechdrs
(braket
id|hdr-&gt;e_shstrndx
)braket
dot
id|sh_offset
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|1
suffix:semicolon
id|i
OL
id|hdr-&gt;e_shnum
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|sechdrs
(braket
id|i
)braket
dot
id|sh_offset
OG
id|size
)paren
r_goto
id|truncated
suffix:semicolon
r_if
c_cond
(paren
id|sechdrs
(braket
id|i
)braket
dot
id|sh_type
op_eq
id|SHT_SYMTAB
)paren
(brace
id|syms
op_assign
(paren
r_void
op_star
)paren
id|hdr
op_plus
id|sechdrs
(braket
id|i
)braket
dot
id|sh_offset
suffix:semicolon
id|num_syms
op_assign
id|sechdrs
(braket
id|i
)braket
dot
id|sh_size
op_div
r_sizeof
(paren
id|syms
(braket
l_int|0
)braket
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|sechdrs
(braket
id|i
)braket
dot
id|sh_type
op_eq
id|SHT_STRTAB
)paren
id|strtab
op_assign
(paren
r_void
op_star
)paren
id|hdr
op_plus
id|sechdrs
(braket
id|i
)braket
dot
id|sh_offset
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|strtab
op_logical_or
op_logical_neg
id|syms
)paren
(brace
id|fprintf
c_func
(paren
id|stderr
comma
l_string|&quot;table2alias: %s no symtab?&bslash;n&quot;
comma
id|filename
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|num_syms
suffix:semicolon
id|i
op_increment
)paren
(brace
r_const
r_char
op_star
id|symname
suffix:semicolon
r_void
op_star
id|symval
suffix:semicolon
r_if
c_cond
(paren
id|switch_endian
)paren
(brace
id|syms
(braket
id|i
)braket
dot
id|st_shndx
op_assign
id|TO_NATIVE
c_func
(paren
id|syms
(braket
id|i
)braket
dot
id|st_shndx
)paren
suffix:semicolon
id|syms
(braket
id|i
)braket
dot
id|st_name
op_assign
id|TO_NATIVE
c_func
(paren
id|syms
(braket
id|i
)braket
dot
id|st_name
)paren
suffix:semicolon
id|syms
(braket
id|i
)braket
dot
id|st_value
op_assign
id|TO_NATIVE
c_func
(paren
id|syms
(braket
id|i
)braket
dot
id|st_value
)paren
suffix:semicolon
id|syms
(braket
id|i
)braket
dot
id|st_size
op_assign
id|TO_NATIVE
c_func
(paren
id|syms
(braket
id|i
)braket
dot
id|st_size
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|syms
(braket
id|i
)braket
dot
id|st_shndx
op_logical_or
id|syms
(braket
id|i
)braket
dot
id|st_shndx
op_ge
id|hdr-&gt;e_shnum
)paren
r_continue
suffix:semicolon
id|symname
op_assign
id|strtab
op_plus
id|syms
(braket
id|i
)braket
dot
id|st_name
suffix:semicolon
id|symval
op_assign
(paren
r_void
op_star
)paren
id|hdr
op_plus
id|sechdrs
(braket
id|syms
(braket
id|i
)braket
dot
id|st_shndx
)braket
dot
id|sh_offset
op_plus
id|syms
(braket
id|i
)braket
dot
id|st_value
suffix:semicolon
r_if
c_cond
(paren
id|sym_is
c_func
(paren
id|symname
comma
l_string|&quot;__mod_pci_device_table&quot;
)paren
)paren
id|do_table
c_func
(paren
id|symval
comma
id|syms
(braket
id|i
)braket
dot
id|st_size
comma
r_sizeof
(paren
r_struct
id|pci_device_id
)paren
op_plus
id|EXTRA_SIZE
op_star
l_int|1
comma
id|do_pci_entry
comma
id|filename
comma
op_amp
id|first
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|sym_is
c_func
(paren
id|symname
comma
l_string|&quot;__mod_usb_device_table&quot;
)paren
)paren
id|do_table
c_func
(paren
id|symval
comma
id|syms
(braket
id|i
)braket
dot
id|st_size
comma
r_sizeof
(paren
r_struct
id|usb_device_id
)paren
op_plus
id|EXTRA_SIZE
op_star
l_int|1
comma
id|do_usb_entry
comma
id|filename
comma
op_amp
id|first
)paren
suffix:semicolon
)brace
r_return
suffix:semicolon
id|truncated
suffix:colon
id|fprintf
c_func
(paren
id|stderr
comma
l_string|&quot;table2alias: %s is truncated.&bslash;n&quot;
comma
id|filename
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
eof
